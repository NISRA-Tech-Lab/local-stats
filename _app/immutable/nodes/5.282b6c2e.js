import{g as i_,c as yd,a as gd,s as n_,b as a_,d as o_,S as s_}from"../chunks/navigation.821050b4.js";import{g as Zn,a as wh,m as ts,b as ah,c as l_,d as $i,e as _d}from"../chunks/config.25b459c1.js";import{S as mn,i as yn,s as gn,k as je,l as Ge,m as Ve,h as ae,n as ne,R as ju,b as Be,T as Gu,g as tt,v as En,d as ut,f as Tn,P as iy,o as ny,K as Ru,M as Bu,N as Ou,O as Fu,w as Nu,e as ur,E as Zu,U as u_,Q as Zt,V as Tr,p as Je,W as Kn,X as Hn,C as Ae,D as pi,Y as ln,Z as rs,q as Vt,r as Ut,u as Mr,y as ir,z as nr,A as ar,B as or,a as bt,c as xt,_ as Ah,G as vd,I as c_,F as Cp,$ as Ll,a0 as Rl,L as h_,a1 as p_,a2 as f_,a3 as yh,a4 as gh,a5 as _h}from"../chunks/index.baf6a862.js";import{b as ha}from"../chunks/paths.9f0b5b8d.js";import{S as d_}from"../chunks/Section.6106804d.js";/* empty css                                                              */import{w as Ir,h as Ri}from"../chunks/singletons.cdb4b093.js";async function bd(u,h){return await(await h(wh.app_json_data+u+".json")).json()}async function m_({params:u,fetch:h}){let d=u.code,p=await i_(wh.search_data,h),y={};p.forEach(T=>y[T.code]=T.name),p.forEach(T=>{T.typepl=Zn[T.type].pl,T.typenm=Zn[T.type].name,T.typestr=y[T.parent]&&T.parent==T.code?`View:  ${y[T.parent]}
        ${Zn[T.parent_type].name}  `:y[T.parent]&&T.parent!=T.code?`${Zn[T.type].name} `:""});let _=p.sort((T,D)=>T.name.localeCompare(D.name)),a=await bd("N92000002",h),I=await bd(d,h);return{search_data:_,place:I,ni:a}}const nb=Object.freeze(Object.defineProperty({__proto__:null,load:m_},Symbol.toStringTag,{value:"Module"}));var y_=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function g_(u){return u&&u.__esModule&&Object.prototype.hasOwnProperty.call(u,"default")?u.default:u}var __={rgb2hsl:Ku,rgb2hsv:zh,rgb2hwb:Hu,rgb2cmyk:Xu,rgb2keyword:Wu,rgb2xyz:Np,rgb2lab:Vp,rgb2lch:v_,hsl2rgb:Ph,hsl2hsv:b_,hsl2hwb:x_,hsl2cmyk:w_,hsl2keyword:S_,hsv2rgb:Ch,hsv2hsl:k_,hsv2hwb:E_,hsv2cmyk:T_,hsv2keyword:I_,hwb2rgb:Yu,hwb2hsl:A_,hwb2hsv:z_,hwb2cmyk:P_,hwb2keyword:C_,cmyk2rgb:Ju,cmyk2hsl:M_,cmyk2hsv:D_,cmyk2hwb:L_,cmyk2keyword:R_,keyword2rgb:Rs,keyword2hsl:N_,keyword2hsv:V_,keyword2hwb:U_,keyword2cmyk:q_,keyword2lab:j_,keyword2xyz:G_,xyz2rgb:ay,xyz2lab:oy,xyz2lch:B_,lab2xyz:Up,lab2rgb:sy,lab2lch:qp,lch2lab:jp,lch2xyz:O_,lch2rgb:F_};function Ku(u){var h=u[0]/255,d=u[1]/255,p=u[2]/255,y=Math.min(h,d,p),_=Math.max(h,d,p),a=_-y,I,T,D;return _==y?I=0:h==_?I=(d-p)/a:d==_?I=2+(p-h)/a:p==_&&(I=4+(h-d)/a),I=Math.min(I*60,360),I<0&&(I+=360),D=(y+_)/2,_==y?T=0:D<=.5?T=a/(_+y):T=a/(2-_-y),[I,T*100,D*100]}function zh(u){var h=u[0],d=u[1],p=u[2],y=Math.min(h,d,p),_=Math.max(h,d,p),a=_-y,I,T,D;return _==0?T=0:T=a/_*1e3/10,_==y?I=0:h==_?I=(d-p)/a:d==_?I=2+(p-h)/a:p==_&&(I=4+(h-d)/a),I=Math.min(I*60,360),I<0&&(I+=360),D=_/255*1e3/10,[I,T,D]}function Hu(u){var h=u[0],d=u[1],_=u[2],p=Ku(u)[0],y=1/255*Math.min(h,Math.min(d,_)),_=1-1/255*Math.max(h,Math.max(d,_));return[p,y*100,_*100]}function Xu(u){var h=u[0]/255,d=u[1]/255,p=u[2]/255,y,_,a,I;return I=Math.min(1-h,1-d,1-p),y=(1-h-I)/(1-I)||0,_=(1-d-I)/(1-I)||0,a=(1-p-I)/(1-I)||0,[y*100,_*100,a*100,I*100]}function Wu(u){return ly[JSON.stringify(u)]}function Np(u){var h=u[0]/255,d=u[1]/255,p=u[2]/255;h=h>.04045?Math.pow((h+.055)/1.055,2.4):h/12.92,d=d>.04045?Math.pow((d+.055)/1.055,2.4):d/12.92,p=p>.04045?Math.pow((p+.055)/1.055,2.4):p/12.92;var y=h*.4124+d*.3576+p*.1805,_=h*.2126+d*.7152+p*.0722,a=h*.0193+d*.1192+p*.9505;return[y*100,_*100,a*100]}function Vp(u){var h=Np(u),d=h[0],p=h[1],y=h[2],_,a,I;return d/=95.047,p/=100,y/=108.883,d=d>.008856?Math.pow(d,1/3):7.787*d+16/116,p=p>.008856?Math.pow(p,1/3):7.787*p+16/116,y=y>.008856?Math.pow(y,1/3):7.787*y+16/116,_=116*p-16,a=500*(d-p),I=200*(p-y),[_,a,I]}function v_(u){return qp(Vp(u))}function Ph(u){var h=u[0]/360,d=u[1]/100,p=u[2]/100,y,_,a,I,T;if(d==0)return T=p*255,[T,T,T];p<.5?_=p*(1+d):_=p+d-p*d,y=2*p-_,I=[0,0,0];for(var D=0;D<3;D++)a=h+1/3*-(D-1),a<0&&a++,a>1&&a--,6*a<1?T=y+(_-y)*6*a:2*a<1?T=_:3*a<2?T=y+(_-y)*(2/3-a)*6:T=y,I[D]=T*255;return I}function b_(u){var h=u[0],d=u[1]/100,p=u[2]/100,y,_;return p===0?[0,0,0]:(p*=2,d*=p<=1?p:2-p,_=(p+d)/2,y=2*d/(p+d),[h,y*100,_*100])}function x_(u){return Hu(Ph(u))}function w_(u){return Xu(Ph(u))}function S_(u){return Wu(Ph(u))}function Ch(u){var h=u[0]/60,d=u[1]/100,T=u[2]/100,p=Math.floor(h)%6,y=h-Math.floor(h),_=255*T*(1-d),a=255*T*(1-d*y),I=255*T*(1-d*(1-y)),T=255*T;switch(p){case 0:return[T,I,_];case 1:return[a,T,_];case 2:return[_,T,I];case 3:return[_,a,T];case 4:return[I,_,T];case 5:return[T,_,a]}}function k_(u){var h=u[0],d=u[1]/100,p=u[2]/100,y,_;return _=(2-d)*p,y=d*p,y/=_<=1?_:2-_,y=y||0,_/=2,[h,y*100,_*100]}function E_(u){return Hu(Ch(u))}function T_(u){return Xu(Ch(u))}function I_(u){return Wu(Ch(u))}function Yu(u){var h=u[0]/360,d=u[1]/100,p=u[2]/100,y=d+p,_,a,I,T;switch(y>1&&(d/=y,p/=y),_=Math.floor(6*h),a=1-p,I=6*h-_,_&1&&(I=1-I),T=d+I*(a-d),_){default:case 6:case 0:r=a,g=T,b=d;break;case 1:r=T,g=a,b=d;break;case 2:r=d,g=a,b=T;break;case 3:r=d,g=T,b=a;break;case 4:r=T,g=d,b=a;break;case 5:r=a,g=d,b=T;break}return[r*255,g*255,b*255]}function A_(u){return Ku(Yu(u))}function z_(u){return zh(Yu(u))}function P_(u){return Xu(Yu(u))}function C_(u){return Wu(Yu(u))}function Ju(u){var h=u[0]/100,d=u[1]/100,p=u[2]/100,y=u[3]/100,_,a,I;return _=1-Math.min(1,h*(1-y)+y),a=1-Math.min(1,d*(1-y)+y),I=1-Math.min(1,p*(1-y)+y),[_*255,a*255,I*255]}function M_(u){return Ku(Ju(u))}function D_(u){return zh(Ju(u))}function L_(u){return Hu(Ju(u))}function R_(u){return Wu(Ju(u))}function ay(u){var h=u[0]/100,d=u[1]/100,p=u[2]/100,y,_,a;return y=h*3.2406+d*-1.5372+p*-.4986,_=h*-.9689+d*1.8758+p*.0415,a=h*.0557+d*-.204+p*1.057,y=y>.0031308?1.055*Math.pow(y,1/2.4)-.055:y=y*12.92,_=_>.0031308?1.055*Math.pow(_,1/2.4)-.055:_=_*12.92,a=a>.0031308?1.055*Math.pow(a,1/2.4)-.055:a=a*12.92,y=Math.min(Math.max(0,y),1),_=Math.min(Math.max(0,_),1),a=Math.min(Math.max(0,a),1),[y*255,_*255,a*255]}function oy(u){var h=u[0],d=u[1],p=u[2],y,_,a;return h/=95.047,d/=100,p/=108.883,h=h>.008856?Math.pow(h,1/3):7.787*h+16/116,d=d>.008856?Math.pow(d,1/3):7.787*d+16/116,p=p>.008856?Math.pow(p,1/3):7.787*p+16/116,y=116*d-16,_=500*(h-d),a=200*(d-p),[y,_,a]}function B_(u){return qp(oy(u))}function Up(u){var h=u[0],d=u[1],p=u[2],y,_,a,I;return h<=8?(_=h*100/903.3,I=7.787*(_/100)+16/116):(_=100*Math.pow((h+16)/116,3),I=Math.pow(_/100,1/3)),y=y/95.047<=.008856?y=95.047*(d/500+I-16/116)/7.787:95.047*Math.pow(d/500+I,3),a=a/108.883<=.008859?a=108.883*(I-p/200-16/116)/7.787:108.883*Math.pow(I-p/200,3),[y,_,a]}function qp(u){var h=u[0],d=u[1],p=u[2],y,_,a;return y=Math.atan2(p,d),_=y*360/2/Math.PI,_<0&&(_+=360),a=Math.sqrt(d*d+p*p),[h,a,_]}function sy(u){return ay(Up(u))}function jp(u){var h=u[0],d=u[1],p=u[2],y,_,a;return a=p/360*2*Math.PI,y=d*Math.cos(a),_=d*Math.sin(a),[h,y,_]}function O_(u){return Up(jp(u))}function F_(u){return sy(jp(u))}function Rs(u){return Mp[u]}function N_(u){return Ku(Rs(u))}function V_(u){return zh(Rs(u))}function U_(u){return Hu(Rs(u))}function q_(u){return Xu(Rs(u))}function j_(u){return Vp(Rs(u))}function G_(u){return Np(Rs(u))}var Mp={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,134,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,250,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,221],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[112,128,144],slategrey:[112,128,144],snow:[255,250,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,50]},ly={};for(var xd in Mp)ly[JSON.stringify(Mp[xd])]=xd;var Ep=__,Cl=function(){return new Qu};for(var Mu in Ep){Cl[Mu+"Raw"]=function(u){return function(h){return typeof h=="number"&&(h=Array.prototype.slice.call(arguments)),Ep[u](h)}}(Mu);var wd=/(\w+)2(\w+)/.exec(Mu),Tp=wd[1],Z_=wd[2];Cl[Tp]=Cl[Tp]||{},Cl[Tp][Z_]=Cl[Mu]=function(u){return function(h){typeof h=="number"&&(h=Array.prototype.slice.call(arguments));var d=Ep[u](h);if(typeof d=="string"||d===void 0)return d;for(var p=0;p<d.length;p++)d[p]=Math.round(d[p]);return d}}(Mu)}var Qu=function(){this.convs={}};Qu.prototype.routeSpace=function(u,h){var d=h[0];return d===void 0?this.getValues(u):(typeof d=="number"&&(d=Array.prototype.slice.call(h)),this.setValues(u,d))};Qu.prototype.setValues=function(u,h){return this.space=u,this.convs={},this.convs[u]=h,this};Qu.prototype.getValues=function(u){var h=this.convs[u];if(!h){var d=this.space,p=this.convs[d];h=Cl[d][u](p),this.convs[u]=h}return h};["rgb","hsl","hsv","cmyk","keyword"].forEach(function(u){Qu.prototype[u]=function(h){return this.routeSpace(u,arguments)}});var uy={exports:{}};(function(u,h){(function(d,p){u.exports=p()})(y_,function(){var d,p,y;function _(a,I){if(!d)d=I;else if(!p)p=I;else{var T="var sharedChunk = {}; ("+d+")(sharedChunk); ("+p+")(sharedChunk);",D={};d(D),y=I(D),typeof window<"u"&&(y.workerUrl=window.URL.createObjectURL(new Blob([T],{type:"text/javascript"})))}}return _(["exports"],function(a){function I(e,t){return e(t={exports:{}},t.exports),t.exports}var T=D;function D(e,t,i,l){this.cx=3*e,this.bx=3*(i-e)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*t,this.by=3*(l-t)-this.cy,this.ay=1-this.cy-this.by,this.p1x=e,this.p1y=l,this.p2x=i,this.p2y=l}D.prototype.sampleCurveX=function(e){return((this.ax*e+this.bx)*e+this.cx)*e},D.prototype.sampleCurveY=function(e){return((this.ay*e+this.by)*e+this.cy)*e},D.prototype.sampleCurveDerivativeX=function(e){return(3*this.ax*e+2*this.bx)*e+this.cx},D.prototype.solveCurveX=function(e,t){var i,l,f,m,x;for(t===void 0&&(t=1e-6),f=e,x=0;x<8;x++){if(m=this.sampleCurveX(f)-e,Math.abs(m)<t)return f;var k=this.sampleCurveDerivativeX(f);if(Math.abs(k)<1e-6)break;f-=m/k}if((f=e)<(i=0))return i;if(f>(l=1))return l;for(;i<l;){if(m=this.sampleCurveX(f),Math.abs(m-e)<t)return f;e>m?i=f:l=f,f=.5*(l-i)+i}return f},D.prototype.solve=function(e,t){return this.sampleCurveY(this.solveCurveX(e,t))};var F=M;function M(e,t){this.x=e,this.y=t}M.prototype={clone:function(){return new M(this.x,this.y)},add:function(e){return this.clone()._add(e)},sub:function(e){return this.clone()._sub(e)},multByPoint:function(e){return this.clone()._multByPoint(e)},divByPoint:function(e){return this.clone()._divByPoint(e)},mult:function(e){return this.clone()._mult(e)},div:function(e){return this.clone()._div(e)},rotate:function(e){return this.clone()._rotate(e)},rotateAround:function(e,t){return this.clone()._rotateAround(e,t)},matMult:function(e){return this.clone()._matMult(e)},unit:function(){return this.clone()._unit()},perp:function(){return this.clone()._perp()},round:function(){return this.clone()._round()},mag:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals:function(e){return this.x===e.x&&this.y===e.y},dist:function(e){return Math.sqrt(this.distSqr(e))},distSqr:function(e){var t=e.x-this.x,i=e.y-this.y;return t*t+i*i},angle:function(){return Math.atan2(this.y,this.x)},angleTo:function(e){return Math.atan2(this.y-e.y,this.x-e.x)},angleWith:function(e){return this.angleWithSep(e.x,e.y)},angleWithSep:function(e,t){return Math.atan2(this.x*t-this.y*e,this.x*e+this.y*t)},_matMult:function(e){var t=e[2]*this.x+e[3]*this.y;return this.x=e[0]*this.x+e[1]*this.y,this.y=t,this},_add:function(e){return this.x+=e.x,this.y+=e.y,this},_sub:function(e){return this.x-=e.x,this.y-=e.y,this},_mult:function(e){return this.x*=e,this.y*=e,this},_div:function(e){return this.x/=e,this.y/=e,this},_multByPoint:function(e){return this.x*=e.x,this.y*=e.y,this},_divByPoint:function(e){return this.x/=e.x,this.y/=e.y,this},_unit:function(){return this._div(this.mag()),this},_perp:function(){var e=this.y;return this.y=this.x,this.x=-e,this},_rotate:function(e){var t=Math.cos(e),i=Math.sin(e),l=i*this.x+t*this.y;return this.x=t*this.x-i*this.y,this.y=l,this},_rotateAround:function(e,t){var i=Math.cos(e),l=Math.sin(e),f=t.y+l*(this.x-t.x)+i*(this.y-t.y);return this.x=t.x+i*(this.x-t.x)-l*(this.y-t.y),this.y=f,this},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}},M.convert=function(e){return e instanceof M?e:Array.isArray(e)?new M(e[0],e[1]):e};var L=typeof self<"u"?self:{},X=Math.pow(2,53)-1;function oe(e,t,i,l){var f=new T(e,t,i,l);return function(m){return f.solve(m)}}var se=oe(.25,.1,.25,1);function pe(e,t,i){return Math.min(i,Math.max(t,e))}function xe(e,t,i){var l=i-t,f=((e-t)%l+l)%l+t;return f===t?i:f}function be(e){for(var t=[],i=arguments.length-1;i-- >0;)t[i]=arguments[i+1];for(var l=0,f=t;l<f.length;l+=1){var m=f[l];for(var x in m)e[x]=m[x]}return e}var ct=1;function We(){return ct++}function De(){return function e(t){return t?(t^16*Math.random()>>t/4).toString(16):([1e7]+-[1e3]+-4e3+-8e3+-1e11).replace(/[018]/g,e)}()}function Ze(e){return!!e&&/^[0-9a-f]{8}-[0-9a-f]{4}-[4][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i.test(e)}function Dt(e,t){e.forEach(function(i){t[i]&&(t[i]=t[i].bind(t))})}function zt(e,t){return e.indexOf(t,e.length-t.length)!==-1}function Ue(e,t,i){var l={};for(var f in e)l[f]=t.call(i||this,e[f],f,e);return l}function Ke(e,t,i){var l={};for(var f in e)t.call(i||this,e[f],f,e)&&(l[f]=e[f]);return l}function vt(e){return Array.isArray(e)?e.map(vt):typeof e=="object"&&e?Ue(e,vt):e}var cr={};function Ne(e){cr[e]||(typeof console<"u"&&console.warn(e),cr[e]=!0)}function Rt(e,t,i){return(i.y-e.y)*(t.x-e.x)>(t.y-e.y)*(i.x-e.x)}function Me(e){for(var t=0,i=0,l=e.length,f=l-1,m=void 0,x=void 0;i<l;f=i++)t+=((x=e[f]).x-(m=e[i]).x)*(m.y+x.y);return t}function $e(){return typeof WorkerGlobalScope<"u"&&typeof self<"u"&&self instanceof WorkerGlobalScope}function mt(e){var t={};if(e.replace(/(?:^|(?:\s*\,\s*))([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)(?:\=(?:([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)|(?:\"((?:[^"\\]|\\.)*)\")))?/g,function(l,f,m,x){var k=m||x;return t[f]=!k||k.toLowerCase(),""}),t["max-age"]){var i=parseInt(t["max-age"],10);isNaN(i)?delete t["max-age"]:t["max-age"]=i}return t}var qt=null;function Bt(e){if(qt==null){var t=e.navigator?e.navigator.userAgent:null;qt=!!e.safari||!(!t||!(/\b(iPad|iPhone|iPod)\b/.test(t)||t.match("Safari")&&!t.match("Chrome")))}return qt}function St(e){try{var t=L[e];return t.setItem("_mapbox_test_",1),t.removeItem("_mapbox_test_"),!0}catch{return!1}}var Oe,ot,Dr,Kr,vi=L.performance&&L.performance.now?L.performance.now.bind(L.performance):Date.now.bind(Date),xr=L.requestAnimationFrame||L.mozRequestAnimationFrame||L.webkitRequestAnimationFrame||L.msRequestAnimationFrame,er=L.cancelAnimationFrame||L.mozCancelAnimationFrame||L.webkitCancelAnimationFrame||L.msCancelAnimationFrame,Hr={now:vi,frame:function(e){var t=xr(e);return{cancel:function(){return er(t)}}},getImageData:function(e,t){t===void 0&&(t=0);var i=L.document.createElement("canvas"),l=i.getContext("2d");if(!l)throw new Error("failed to create canvas 2d context");return i.width=e.width,i.height=e.height,l.drawImage(e,0,0,e.width,e.height),l.getImageData(-t,-t,e.width+2*t,e.height+2*t)},resolveURL:function(e){return Oe||(Oe=L.document.createElement("a")),Oe.href=e,Oe.href},hardwareConcurrency:L.navigator&&L.navigator.hardwareConcurrency||4,get devicePixelRatio(){return L.devicePixelRatio},get prefersReducedMotion(){return!!L.matchMedia&&(ot==null&&(ot=L.matchMedia("(prefers-reduced-motion: reduce)")),ot.matches)}},Jt={API_URL:"https://api.mapbox.com",get EVENTS_URL(){return this.API_URL?this.API_URL.indexOf("https://api.mapbox.cn")===0?"https://events.mapbox.cn/events/v2":this.API_URL.indexOf("https://api.mapbox.com")===0?"https://events.mapbox.com/events/v2":null:null},FEEDBACK_URL:"https://apps.mapbox.com/feedback",REQUIRE_ACCESS_TOKEN:!0,ACCESS_TOKEN:null,MAX_PARALLEL_IMAGE_REQUESTS:16},ai={supported:!1,testSupport:function(e){!qi&&Kr&&(en?Kt(e):Dr=e)}},qi=!1,en=!1;function Kt(e){var t=e.createTexture();e.bindTexture(e.TEXTURE_2D,t);try{if(e.texImage2D(e.TEXTURE_2D,0,e.RGBA,e.RGBA,e.UNSIGNED_BYTE,Kr),e.isContextLost())return;ai.supported=!0}catch{}e.deleteTexture(t),qi=!0}L.document&&((Kr=L.document.createElement("img")).onload=function(){Dr&&Kt(Dr),Dr=null,en=!0},Kr.onerror=function(){qi=!0,Dr=null},Kr.src="data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAQAAAAfQ//73v/+BiOh/AAA=");var ji="01",fi=function(e,t){this._transformRequestFn=e,this._customAccessToken=t,this._createSkuToken()};function $r(e){return e.indexOf("mapbox:")===0}fi.prototype._createSkuToken=function(){var e=function(){for(var t="",i=0;i<10;i++)t+="0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ"[Math.floor(62*Math.random())];return{token:["1",ji,t].join(""),tokenExpiresAt:Date.now()+432e5}}();this._skuToken=e.token,this._skuTokenExpiresAt=e.tokenExpiresAt},fi.prototype._isSkuTokenExpired=function(){return Date.now()>this._skuTokenExpiresAt},fi.prototype.transformRequest=function(e,t){return this._transformRequestFn&&this._transformRequestFn(e,t)||{url:e}},fi.prototype.normalizeStyleURL=function(e,t){if(!$r(e))return e;var i=Ur(e);return i.path="/styles/v1"+i.path,this._makeAPIURL(i,this._customAccessToken||t)},fi.prototype.normalizeGlyphsURL=function(e,t){if(!$r(e))return e;var i=Ur(e);return i.path="/fonts/v1"+i.path,this._makeAPIURL(i,this._customAccessToken||t)},fi.prototype.normalizeSourceURL=function(e,t){if(!$r(e))return e;var i=Ur(e);return i.path="/v4/"+i.authority+".json",i.params.push("secure"),this._makeAPIURL(i,this._customAccessToken||t)},fi.prototype.normalizeSpriteURL=function(e,t,i,l){var f=Ur(e);return $r(e)?(f.path="/styles/v1"+f.path+"/sprite"+t+i,this._makeAPIURL(f,this._customAccessToken||l)):(f.path+=""+t+i,tn(f))},fi.prototype.normalizeTileURL=function(e,t){if(this._isSkuTokenExpired()&&this._createSkuToken(),e&&!$r(e))return e;var i=Ur(e);i.path=i.path.replace(/(\.(png|jpg)\d*)(?=$)/,(Hr.devicePixelRatio>=2||t===512?"@2x":"")+(ai.supported?".webp":"$1")),i.path=i.path.replace(/^.+\/v4\//,"/"),i.path="/v4"+i.path;var l=this._customAccessToken||function(f){for(var m=0,x=f;m<x.length;m+=1){var k=x[m].match(/^access_token=(.*)$/);if(k)return k[1]}return null}(i.params)||Jt.ACCESS_TOKEN;return Jt.REQUIRE_ACCESS_TOKEN&&l&&this._skuToken&&i.params.push("sku="+this._skuToken),this._makeAPIURL(i,l)},fi.prototype.canonicalizeTileURL=function(e,t){var i=Ur(e);if(!i.path.match(/(^\/v4\/)/)||!i.path.match(/\.[\w]+$/))return e;var l="mapbox://tiles/";l+=i.path.replace("/v4/","");var f=i.params;return t&&(f=f.filter(function(m){return!m.match(/^access_token=/)})),f.length&&(l+="?"+f.join("&")),l},fi.prototype.canonicalizeTileset=function(e,t){for(var i=!!t&&$r(t),l=[],f=0,m=e.tiles||[];f<m.length;f+=1){var x=m[f];Ei(x)?l.push(this.canonicalizeTileURL(x,i)):l.push(x)}return l},fi.prototype._makeAPIURL=function(e,t){var i="See https://www.mapbox.com/api-documentation/#access-tokens-and-token-scopes",l=Ur(Jt.API_URL);if(e.protocol=l.protocol,e.authority=l.authority,e.protocol==="http"){var f=e.params.indexOf("secure");f>=0&&e.params.splice(f,1)}if(l.path!=="/"&&(e.path=""+l.path+e.path),!Jt.REQUIRE_ACCESS_TOKEN)return tn(e);if(!(t=t||Jt.ACCESS_TOKEN))throw new Error("An API access token is required to use Mapbox GL. "+i);if(t[0]==="s")throw new Error("Use a public access token (pk.*) with Mapbox GL, not a secret access token (sk.*). "+i);return e.params=e.params.filter(function(m){return m.indexOf("access_token")===-1}),e.params.push("access_token="+t),tn(e)};var Xn=/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/|\?|$)/i;function Ei(e){return Xn.test(e)}var Lr=/^(\w+):\/\/([^/?]*)(\/[^?]+)?\??(.+)?/;function Ur(e){var t=e.match(Lr);if(!t)throw new Error("Unable to parse URL object");return{protocol:t[1],authority:t[2],path:t[3]||"/",params:t[4]?t[4].split("&"):[]}}function tn(e){var t=e.params.length?"?"+e.params.join("&"):"";return e.protocol+"://"+e.authority+e.path+t}function bi(e){if(!e)return null;var t=e.split(".");if(!t||t.length!==3)return null;try{return JSON.parse(decodeURIComponent(L.atob(t[1]).split("").map(function(i){return"%"+("00"+i.charCodeAt(0).toString(16)).slice(-2)}).join("")))}catch{return null}}var di=function(e){this.type=e,this.anonId=null,this.eventData={},this.queue=[],this.pendingRequest=null};di.prototype.getStorageKey=function(e){var t,i=bi(Jt.ACCESS_TOKEN);return t=i&&i.u?L.btoa(encodeURIComponent(i.u).replace(/%([0-9A-F]{2})/g,function(l,f){return String.fromCharCode(+("0x"+f))})):Jt.ACCESS_TOKEN||"",e?"mapbox.eventData."+e+":"+t:"mapbox.eventData:"+t},di.prototype.fetchEventData=function(){var e=St("localStorage"),t=this.getStorageKey(),i=this.getStorageKey("uuid");if(e)try{var l=L.localStorage.getItem(t);l&&(this.eventData=JSON.parse(l));var f=L.localStorage.getItem(i);f&&(this.anonId=f)}catch{Ne("Unable to read from LocalStorage")}},di.prototype.saveEventData=function(){var e=St("localStorage"),t=this.getStorageKey(),i=this.getStorageKey("uuid");if(e)try{L.localStorage.setItem(i,this.anonId),Object.keys(this.eventData).length>=1&&L.localStorage.setItem(t,JSON.stringify(this.eventData))}catch{Ne("Unable to write to LocalStorage")}},di.prototype.processRequests=function(e){},di.prototype.postEvent=function(e,t,i,l){var f=this;if(Jt.EVENTS_URL){var m=Ur(Jt.EVENTS_URL);m.params.push("access_token="+(l||Jt.ACCESS_TOKEN||""));var x={event:this.type,created:new Date(e).toISOString(),sdkIdentifier:"mapbox-gl-js",sdkVersion:"1.13.2",skuId:ji,userId:this.anonId},k=t?be(x,t):x,A={url:tn(m),headers:{"Content-Type":"text/plain"},body:JSON.stringify([k])};this.pendingRequest=pr(A,function(z){f.pendingRequest=null,i(z),f.saveEventData(),f.processRequests(l)})}},di.prototype.queueRequest=function(e,t){this.queue.push(e),this.processRequests(t)};var qr,rn,Xr=function(e){function t(){e.call(this,"map.load"),this.success={},this.skuToken=""}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.postMapLoadEvent=function(i,l,f,m){this.skuToken=f,(Jt.EVENTS_URL&&m||Jt.ACCESS_TOKEN&&Array.isArray(i)&&i.some(function(x){return $r(x)||Ei(x)}))&&this.queueRequest({id:l,timestamp:Date.now()},m)},t.prototype.processRequests=function(i){var l=this;if(!this.pendingRequest&&this.queue.length!==0){var f=this.queue.shift(),m=f.id,x=f.timestamp;m&&this.success[m]||(this.anonId||this.fetchEventData(),Ze(this.anonId)||(this.anonId=De()),this.postEvent(x,{skuToken:this.skuToken},function(k){k||m&&(l.success[m]=!0)},i))}},t}(di),In=new(function(e){function t(i){e.call(this,"appUserTurnstile"),this._customAccessToken=i}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.postTurnstileEvent=function(i,l){Jt.EVENTS_URL&&Jt.ACCESS_TOKEN&&Array.isArray(i)&&i.some(function(f){return $r(f)||Ei(f)})&&this.queueRequest(Date.now(),l)},t.prototype.processRequests=function(i){var l=this;if(!this.pendingRequest&&this.queue.length!==0){this.anonId&&this.eventData.lastSuccess&&this.eventData.tokenU||this.fetchEventData();var f=bi(Jt.ACCESS_TOKEN),m=f?f.u:Jt.ACCESS_TOKEN,x=m!==this.eventData.tokenU;Ze(this.anonId)||(this.anonId=De(),x=!0);var k=this.queue.shift();if(this.eventData.lastSuccess){var A=new Date(this.eventData.lastSuccess),z=new Date(k),C=(k-this.eventData.lastSuccess)/864e5;x=x||C>=1||C<-1||A.getDate()!==z.getDate()}else x=!0;if(!x)return this.processRequests();this.postEvent(k,{"enabled.telemetry":!1},function(B){B||(l.eventData.lastSuccess=k,l.eventData.tokenU=m)},i)}},t}(di)),nn=In.postTurnstileEvent.bind(In),Dn=new Xr,Gi=Dn.postMapLoadEvent.bind(Dn),Bi=500,ei=50;function Ln(){L.caches&&!qr&&(qr=L.caches.open("mapbox-tiles"))}function An(e){var t=e.indexOf("?");return t<0?e:e.slice(0,t)}var oi,ta=1/0;function Wn(){return oi==null&&(oi=L.OffscreenCanvas&&new L.OffscreenCanvas(1,1).getContext("2d")&&typeof L.createImageBitmap=="function"),oi}var ti={Unknown:"Unknown",Style:"Style",Source:"Source",Tile:"Tile",Glyphs:"Glyphs",SpriteImage:"SpriteImage",SpriteJSON:"SpriteJSON",Image:"Image"};typeof Object.freeze=="function"&&Object.freeze(ti);var ra=function(e){function t(i,l,f){l===401&&Ei(f)&&(i+=": you may have provided an invalid Mapbox access token. See https://www.mapbox.com/api-documentation/#access-tokens-and-token-scopes"),e.call(this,i),this.status=l,this.url=f,this.name=this.constructor.name,this.message=i}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.toString=function(){return this.name+": "+this.message+" ("+this.status+"): "+this.url},t}(Error),un=$e()?function(){return self.worker&&self.worker.referrer}:function(){return(L.location.protocol==="blob:"?L.parent:L).location.href},ri,re,yt=function(e,t){if(!(/^file:/.test(i=e.url)||/^file:/.test(un())&&!/^\w+:/.test(i))){if(L.fetch&&L.Request&&L.AbortController&&L.Request.prototype.hasOwnProperty("signal"))return function(l,f){var m,x=new L.AbortController,k=new L.Request(l.url,{method:l.method||"GET",body:l.body,credentials:l.credentials,headers:l.headers,referrer:un(),signal:x.signal}),A=!1,z=!1,C=(m=k.url).indexOf("sku=")>0&&Ei(m);l.type==="json"&&k.headers.set("Accept","application/json");var B=function(j,J,$){if(!z){if(j&&j.message!=="SecurityError"&&Ne(j),J&&$)return V(J);var he=Date.now();L.fetch(k).then(function(ie){if(ie.ok){var me=C?ie.clone():null;return V(ie,me,he)}return f(new ra(ie.statusText,ie.status,l.url))}).catch(function(ie){ie.code!==20&&f(new Error(ie.message))})}},V=function(j,J,$){(l.type==="arrayBuffer"?j.arrayBuffer():l.type==="json"?j.json():j.text()).then(function(he){z||(J&&$&&function(ie,me,ve){if(Ln(),qr){var we={status:me.status,statusText:me.statusText,headers:new L.Headers};me.headers.forEach(function(Pe,qe){return we.headers.set(qe,Pe)});var ke=mt(me.headers.get("Cache-Control")||"");ke["no-store"]||(ke["max-age"]&&we.headers.set("Expires",new Date(ve+1e3*ke["max-age"]).toUTCString()),new Date(we.headers.get("Expires")).getTime()-ve<42e4||function(Pe,qe){if(rn===void 0)try{new Response(new ReadableStream),rn=!0}catch{rn=!1}rn?qe(Pe.body):Pe.blob().then(qe)}(me,function(Pe){var qe=new L.Response(Pe,we);Ln(),qr&&qr.then(function(et){return et.put(An(ie.url),qe)}).catch(function(et){return Ne(et.message)})}))}}(k,J,$),A=!0,f(null,he,j.headers.get("Cache-Control"),j.headers.get("Expires")))}).catch(function(he){z||f(new Error(he.message))})};return C?function(j,J){if(Ln(),!qr)return J(null);var $=An(j.url);qr.then(function(he){he.match($).then(function(ie){var me=function(ve){if(!ve)return!1;var we=new Date(ve.headers.get("Expires")||0),ke=mt(ve.headers.get("Cache-Control")||"");return we>Date.now()&&!ke["no-cache"]}(ie);he.delete($),me&&he.put($,ie.clone()),J(null,ie,me)}).catch(J)}).catch(J)}(k,B):B(null,null),{cancel:function(){z=!0,A||x.abort()}}}(e,t);if($e()&&self.worker&&self.worker.actor)return self.worker.actor.send("getResource",e,t,void 0,!0)}var i;return function(l,f){var m=new L.XMLHttpRequest;for(var x in m.open(l.method||"GET",l.url,!0),l.type==="arrayBuffer"&&(m.responseType="arraybuffer"),l.headers)m.setRequestHeader(x,l.headers[x]);return l.type==="json"&&(m.responseType="text",m.setRequestHeader("Accept","application/json")),m.withCredentials=l.credentials==="include",m.onerror=function(){f(new Error(m.statusText))},m.onload=function(){if((m.status>=200&&m.status<300||m.status===0)&&m.response!==null){var k=m.response;if(l.type==="json")try{k=JSON.parse(m.response)}catch(A){return f(A)}f(null,k,m.getResponseHeader("Cache-Control"),m.getResponseHeader("Expires"))}else f(new ra(m.statusText,m.status,l.url))},m.send(l.body),{cancel:function(){return m.abort()}}}(e,t)},Ti=function(e,t){return yt(be(e,{type:"arrayBuffer"}),t)},pr=function(e,t){return yt(be(e,{method:"POST"}),t)},R="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAC0lEQVQYV2NgAAIAAAUAAarVyFEAAAAASUVORK5CYII=";ri=[],re=0;var N=function(e,t){if(ai.supported&&(e.headers||(e.headers={}),e.headers.accept="image/webp,*/*"),re>=Jt.MAX_PARALLEL_IMAGE_REQUESTS){var i={requestParameters:e,callback:t,cancelled:!1,cancel:function(){this.cancelled=!0}};return ri.push(i),i}re++;var l=!1,f=function(){if(!l)for(l=!0,re--;ri.length&&re<Jt.MAX_PARALLEL_IMAGE_REQUESTS;){var x=ri.shift();x.cancelled||(x.cancel=N(x.requestParameters,x.callback).cancel)}},m=Ti(e,function(x,k,A,z){f(),x?t(x):k&&(Wn()?function(C,B){var V=new L.Blob([new Uint8Array(C)],{type:"image/png"});L.createImageBitmap(V).then(function(j){B(null,j)}).catch(function(j){B(new Error("Could not load image because of "+j.message+". Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."))})}(k,t):function(C,B,V,j){var J=new L.Image,$=L.URL;J.onload=function(){B(null,J),$.revokeObjectURL(J.src),J.onload=null,L.requestAnimationFrame(function(){J.src=R})},J.onerror=function(){return B(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."))};var he=new L.Blob([new Uint8Array(C)],{type:"image/png"});J.cacheControl=V,J.expires=j,J.src=C.byteLength?$.createObjectURL(he):R}(k,t,A,z))});return{cancel:function(){m.cancel(),f()}}};function q(e,t,i){i[e]&&i[e].indexOf(t)!==-1||(i[e]=i[e]||[],i[e].push(t))}function K(e,t,i){if(i&&i[e]){var l=i[e].indexOf(t);l!==-1&&i[e].splice(l,1)}}var W=function(e,t){t===void 0&&(t={}),be(this,t),this.type=e},ue=function(e){function t(i,l){l===void 0&&(l={}),e.call(this,"error",be({error:i},l))}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t}(W),fe=function(){};fe.prototype.on=function(e,t){return this._listeners=this._listeners||{},q(e,t,this._listeners),this},fe.prototype.off=function(e,t){return K(e,t,this._listeners),K(e,t,this._oneTimeListeners),this},fe.prototype.once=function(e,t){return this._oneTimeListeners=this._oneTimeListeners||{},q(e,t,this._oneTimeListeners),this},fe.prototype.fire=function(e,t){typeof e=="string"&&(e=new W(e,t||{}));var i=e.type;if(this.listens(i)){e.target=this;for(var l=0,f=this._listeners&&this._listeners[i]?this._listeners[i].slice():[];l<f.length;l+=1)f[l].call(this,e);for(var m=0,x=this._oneTimeListeners&&this._oneTimeListeners[i]?this._oneTimeListeners[i].slice():[];m<x.length;m+=1){var k=x[m];K(i,k,this._oneTimeListeners),k.call(this,e)}var A=this._eventedParent;A&&(be(e,typeof this._eventedParentData=="function"?this._eventedParentData():this._eventedParentData),A.fire(e))}else e instanceof ue&&console.error(e.error);return this},fe.prototype.listens=function(e){return this._listeners&&this._listeners[e]&&this._listeners[e].length>0||this._oneTimeListeners&&this._oneTimeListeners[e]&&this._oneTimeListeners[e].length>0||this._eventedParent&&this._eventedParent.listens(e)},fe.prototype.setEventedParent=function(e,t){return this._eventedParent=e,this._eventedParentData=t,this};var U={$version:8,$root:{version:{required:!0,type:"enum",values:[8]},name:{type:"string"},metadata:{type:"*"},center:{type:"array",value:"number"},zoom:{type:"number"},bearing:{type:"number",default:0,period:360,units:"degrees"},pitch:{type:"number",default:0,units:"degrees"},light:{type:"light"},sources:{required:!0,type:"sources"},sprite:{type:"string"},glyphs:{type:"string"},transition:{type:"transition"},layers:{required:!0,type:"array",value:"layer"}},sources:{"*":{type:"source"}},source:["source_vector","source_raster","source_raster_dem","source_geojson","source_video","source_image"],source_vector:{type:{required:!0,type:"enum",values:{vector:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},attribution:{type:"string"},promoteId:{type:"promoteId"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_raster:{type:{required:!0,type:"enum",values:{raster:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},attribution:{type:"string"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_raster_dem:{type:{required:!0,type:"enum",values:{"raster-dem":{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},attribution:{type:"string"},encoding:{type:"enum",values:{terrarium:{},mapbox:{}},default:"mapbox"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_geojson:{type:{required:!0,type:"enum",values:{geojson:{}}},data:{type:"*"},maxzoom:{type:"number",default:18},attribution:{type:"string"},buffer:{type:"number",default:128,maximum:512,minimum:0},filter:{type:"*"},tolerance:{type:"number",default:.375},cluster:{type:"boolean",default:!1},clusterRadius:{type:"number",default:50,minimum:0},clusterMaxZoom:{type:"number"},clusterMinPoints:{type:"number"},clusterProperties:{type:"*"},lineMetrics:{type:"boolean",default:!1},generateId:{type:"boolean",default:!1},promoteId:{type:"promoteId"}},source_video:{type:{required:!0,type:"enum",values:{video:{}}},urls:{required:!0,type:"array",value:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},source_image:{type:{required:!0,type:"enum",values:{image:{}}},url:{required:!0,type:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},layer:{id:{type:"string",required:!0},type:{type:"enum",values:{fill:{},line:{},symbol:{},circle:{},heatmap:{},"fill-extrusion":{},raster:{},hillshade:{},background:{}},required:!0},metadata:{type:"*"},source:{type:"string"},"source-layer":{type:"string"},minzoom:{type:"number",minimum:0,maximum:24},maxzoom:{type:"number",minimum:0,maximum:24},filter:{type:"filter"},layout:{type:"layout"},paint:{type:"paint"}},layout:["layout_fill","layout_line","layout_circle","layout_heatmap","layout_fill-extrusion","layout_symbol","layout_raster","layout_hillshade","layout_background"],layout_background:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_fill:{"fill-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_circle:{"circle-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_heatmap:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},"layout_fill-extrusion":{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_line:{"line-cap":{type:"enum",values:{butt:{},round:{},square:{}},default:"butt",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-join":{type:"enum",values:{bevel:{},round:{},miter:{}},default:"miter",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"line-miter-limit":{type:"number",default:2,requires:[{"line-join":"miter"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-round-limit":{type:"number",default:1.05,requires:[{"line-join":"round"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_symbol:{"symbol-placement":{type:"enum",values:{point:{},line:{},"line-center":{}},default:"point",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-spacing":{type:"number",default:250,minimum:1,units:"pixels",requires:[{"symbol-placement":"line"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"symbol-avoid-edges":{type:"boolean",default:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"symbol-z-order":{type:"enum",values:{auto:{},"viewport-y":{},source:{}},default:"auto",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-allow-overlap":{type:"boolean",default:!1,requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-ignore-placement":{type:"boolean",default:!1,requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-optional":{type:"boolean",default:!1,requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-rotation-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-size":{type:"number",default:1,minimum:0,units:"factor of the original icon size",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-text-fit":{type:"enum",values:{none:{},width:{},height:{},both:{}},default:"none",requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-text-fit-padding":{type:"array",value:"number",length:4,default:[0,0,0,0],units:"pixels",requires:["icon-image","text-field",{"icon-text-fit":["both","width","height"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-image":{type:"resolvedImage",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-padding":{type:"number",default:2,minimum:0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-keep-upright":{type:"boolean",default:!1,requires:["icon-image",{"icon-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-offset":{type:"array",value:"number",length:2,default:[0,0],requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotation-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-field":{type:"formatted",default:"",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-font":{type:"array",value:"string",default:["Open Sans Regular","Arial Unicode MS Regular"],requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-size":{type:"number",default:16,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-width":{type:"number",default:10,minimum:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-line-height":{type:"number",default:1.2,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-letter-spacing":{type:"number",default:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-justify":{type:"enum",values:{auto:{},left:{},center:{},right:{}},default:"center",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-radial-offset":{type:"number",units:"ems",default:0,requires:["text-field"],"property-type":"data-driven",expression:{interpolated:!0,parameters:["zoom","feature"]}},"text-variable-anchor":{type:"array",value:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["text-field",{"!":"text-variable-anchor"}],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-angle":{type:"number",default:45,units:"degrees",requires:["text-field",{"symbol-placement":["line","line-center"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-writing-mode":{type:"array",value:"enum",values:{horizontal:{},vertical:{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-padding":{type:"number",default:2,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-keep-upright":{type:"boolean",default:!0,requires:["text-field",{"text-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-transform":{type:"enum",values:{none:{},uppercase:{},lowercase:{}},default:"none",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-offset":{type:"array",value:"number",units:"ems",length:2,default:[0,0],requires:["text-field",{"!":"text-radial-offset"}],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-allow-overlap":{type:"boolean",default:!1,requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-ignore-placement":{type:"boolean",default:!1,requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-optional":{type:"boolean",default:!1,requires:["text-field","icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_raster:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_hillshade:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},filter:{type:"array",value:"*"},filter_operator:{type:"enum",values:{"==":{},"!=":{},">":{},">=":{},"<":{},"<=":{},in:{},"!in":{},all:{},any:{},none:{},has:{},"!has":{},within:{}}},geometry_type:{type:"enum",values:{Point:{},LineString:{},Polygon:{}}},function:{expression:{type:"expression"},stops:{type:"array",value:"function_stop"},base:{type:"number",default:1,minimum:0},property:{type:"string",default:"$zoom"},type:{type:"enum",values:{identity:{},exponential:{},interval:{},categorical:{}},default:"exponential"},colorSpace:{type:"enum",values:{rgb:{},lab:{},hcl:{}},default:"rgb"},default:{type:"*",required:!1}},function_stop:{type:"array",minimum:0,maximum:24,value:["number","color"],length:2},expression:{type:"array",value:"*",minimum:1},light:{anchor:{type:"enum",default:"viewport",values:{map:{},viewport:{}},"property-type":"data-constant",transition:!1,expression:{interpolated:!1,parameters:["zoom"]}},position:{type:"array",default:[1.15,210,30],length:3,value:"number","property-type":"data-constant",transition:!0,expression:{interpolated:!0,parameters:["zoom"]}},color:{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},intensity:{type:"number","property-type":"data-constant",default:.5,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0}},paint:["paint_fill","paint_line","paint_circle","paint_heatmap","paint_fill-extrusion","paint_symbol","paint_raster","paint_hillshade","paint_background"],paint_fill:{"fill-antialias":{type:"boolean",default:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-outline-color":{type:"color",transition:!0,requires:[{"!":"fill-pattern"},{"fill-antialias":!0}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"}},"paint_fill-extrusion":{"fill-extrusion-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-extrusion-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-extrusion-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"fill-extrusion-height":{type:"number",default:0,minimum:0,units:"meters",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-base":{type:"number",default:0,minimum:0,units:"meters",transition:!0,requires:["fill-extrusion-height"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-vertical-gradient":{type:"boolean",default:!0,transition:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_line:{"line-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"line-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["line-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-width":{type:"number",default:1,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-gap-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-offset":{type:"number",default:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-dasharray":{type:"array",value:"number",minimum:0,transition:!0,units:"line widths",requires:[{"!":"line-pattern"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"line-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"line-gradient":{type:"color",transition:!1,requires:[{"!":"line-dasharray"},{"!":"line-pattern"},{source:"geojson",has:{lineMetrics:!0}}],expression:{interpolated:!0,parameters:["line-progress"]},"property-type":"color-ramp"}},paint_circle:{"circle-radius":{type:"number",default:5,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-blur":{type:"number",default:0,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"circle-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["circle-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-scale":{type:"enum",values:{map:{},viewport:{}},default:"map",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-alignment":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-stroke-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"}},paint_heatmap:{"heatmap-radius":{type:"number",default:30,minimum:1,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-weight":{type:"number",default:1,minimum:0,transition:!1,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-intensity":{type:"number",default:1,minimum:0,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"heatmap-color":{type:"color",default:["interpolate",["linear"],["heatmap-density"],0,"rgba(0, 0, 255, 0)",.1,"royalblue",.3,"cyan",.5,"lime",.7,"yellow",1,"red"],transition:!1,expression:{interpolated:!0,parameters:["heatmap-density"]},"property-type":"color-ramp"},"heatmap-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_symbol:{"icon-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-color":{type:"color",default:"#000000",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["icon-image","icon-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-color":{type:"color",default:"#000000",transition:!0,overridable:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["text-field","text-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_raster:{"raster-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-hue-rotate":{type:"number",default:0,period:360,transition:!0,units:"degrees",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-min":{type:"number",default:0,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-max":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-saturation":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-contrast":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-resampling":{type:"enum",values:{linear:{},nearest:{}},default:"linear",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"raster-fade-duration":{type:"number",default:300,minimum:0,transition:!1,units:"milliseconds",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_hillshade:{"hillshade-illumination-direction":{type:"number",default:335,minimum:0,maximum:359,transition:!1,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-illumination-anchor":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-exaggeration":{type:"number",default:.5,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-shadow-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-highlight-color":{type:"color",default:"#FFFFFF",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-accent-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_background:{"background-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"background-pattern"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"background-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"background-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},transition:{duration:{type:"number",default:300,minimum:0,units:"milliseconds"},delay:{type:"number",default:0,minimum:0,units:"milliseconds"}},"property-type":{"data-driven":{type:"property-type"},"cross-faded":{type:"property-type"},"cross-faded-data-driven":{type:"property-type"},"color-ramp":{type:"property-type"},"data-constant":{type:"property-type"},constant:{type:"property-type"}},promoteId:{"*":{type:"string"}}},Q=function(e,t,i,l){this.message=(e?e+": ":"")+i,l&&(this.identifier=l),t!=null&&t.__line__&&(this.line=t.__line__)};function ge(e){var t=e.value;return t?[new Q(e.key,t,"constants have been deprecated as of v8")]:[]}function Ce(e){for(var t=[],i=arguments.length-1;i-- >0;)t[i]=arguments[i+1];for(var l=0,f=t;l<f.length;l+=1){var m=f[l];for(var x in m)e[x]=m[x]}return e}function Le(e){return e instanceof Number||e instanceof String||e instanceof Boolean?e.valueOf():e}function Ee(e){if(Array.isArray(e))return e.map(Ee);if(e instanceof Object&&!(e instanceof Number||e instanceof String||e instanceof Boolean)){var t={};for(var i in e)t[i]=Ee(e[i]);return t}return Le(e)}var Re=function(e){function t(i,l){e.call(this,l),this.message=l,this.key=i}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t}(Error),ht=function(e,t){t===void 0&&(t=[]),this.parent=e,this.bindings={};for(var i=0,l=t;i<l.length;i+=1){var f=l[i];this.bindings[f[0]]=f[1]}};ht.prototype.concat=function(e){return new ht(this,e)},ht.prototype.get=function(e){if(this.bindings[e])return this.bindings[e];if(this.parent)return this.parent.get(e);throw new Error(e+" not found in scope.")},ht.prototype.has=function(e){return!!this.bindings[e]||!!this.parent&&this.parent.has(e)};var at={kind:"null"},Te={kind:"number"},He={kind:"string"},Qe={kind:"boolean"},rt={kind:"color"},jt={kind:"object"},nt={kind:"value"},tr={kind:"collator"},wr={kind:"formatted"},Ht={kind:"resolvedImage"};function fr(e,t){return{kind:"array",itemType:e,N:t}}function rr(e){if(e.kind==="array"){var t=rr(e.itemType);return typeof e.N=="number"?"array<"+t+", "+e.N+">":e.itemType.kind==="value"?"array":"array<"+t+">"}return e.kind}var xi=[at,Te,He,Qe,rt,wr,jt,fr(nt),Ht];function yr(e,t){if(t.kind==="error")return null;if(e.kind==="array"){if(t.kind==="array"&&(t.N===0&&t.itemType.kind==="value"||!yr(e.itemType,t.itemType))&&(typeof e.N!="number"||e.N===t.N))return null}else{if(e.kind===t.kind)return null;if(e.kind==="value"){for(var i=0,l=xi;i<l.length;i+=1)if(!yr(l[i],t))return null}}return"Expected "+rr(e)+" but found "+rr(t)+" instead."}function Or(e,t){return t.some(function(i){return i.kind===e.kind})}function br(e,t){return t.some(function(i){return i==="null"?e===null:i==="array"?Array.isArray(e):i==="object"?e&&!Array.isArray(e)&&typeof e=="object":i===typeof e})}var Qt=I(function(e,t){var i={transparent:[0,0,0,0],aliceblue:[240,248,255,1],antiquewhite:[250,235,215,1],aqua:[0,255,255,1],aquamarine:[127,255,212,1],azure:[240,255,255,1],beige:[245,245,220,1],bisque:[255,228,196,1],black:[0,0,0,1],blanchedalmond:[255,235,205,1],blue:[0,0,255,1],blueviolet:[138,43,226,1],brown:[165,42,42,1],burlywood:[222,184,135,1],cadetblue:[95,158,160,1],chartreuse:[127,255,0,1],chocolate:[210,105,30,1],coral:[255,127,80,1],cornflowerblue:[100,149,237,1],cornsilk:[255,248,220,1],crimson:[220,20,60,1],cyan:[0,255,255,1],darkblue:[0,0,139,1],darkcyan:[0,139,139,1],darkgoldenrod:[184,134,11,1],darkgray:[169,169,169,1],darkgreen:[0,100,0,1],darkgrey:[169,169,169,1],darkkhaki:[189,183,107,1],darkmagenta:[139,0,139,1],darkolivegreen:[85,107,47,1],darkorange:[255,140,0,1],darkorchid:[153,50,204,1],darkred:[139,0,0,1],darksalmon:[233,150,122,1],darkseagreen:[143,188,143,1],darkslateblue:[72,61,139,1],darkslategray:[47,79,79,1],darkslategrey:[47,79,79,1],darkturquoise:[0,206,209,1],darkviolet:[148,0,211,1],deeppink:[255,20,147,1],deepskyblue:[0,191,255,1],dimgray:[105,105,105,1],dimgrey:[105,105,105,1],dodgerblue:[30,144,255,1],firebrick:[178,34,34,1],floralwhite:[255,250,240,1],forestgreen:[34,139,34,1],fuchsia:[255,0,255,1],gainsboro:[220,220,220,1],ghostwhite:[248,248,255,1],gold:[255,215,0,1],goldenrod:[218,165,32,1],gray:[128,128,128,1],green:[0,128,0,1],greenyellow:[173,255,47,1],grey:[128,128,128,1],honeydew:[240,255,240,1],hotpink:[255,105,180,1],indianred:[205,92,92,1],indigo:[75,0,130,1],ivory:[255,255,240,1],khaki:[240,230,140,1],lavender:[230,230,250,1],lavenderblush:[255,240,245,1],lawngreen:[124,252,0,1],lemonchiffon:[255,250,205,1],lightblue:[173,216,230,1],lightcoral:[240,128,128,1],lightcyan:[224,255,255,1],lightgoldenrodyellow:[250,250,210,1],lightgray:[211,211,211,1],lightgreen:[144,238,144,1],lightgrey:[211,211,211,1],lightpink:[255,182,193,1],lightsalmon:[255,160,122,1],lightseagreen:[32,178,170,1],lightskyblue:[135,206,250,1],lightslategray:[119,136,153,1],lightslategrey:[119,136,153,1],lightsteelblue:[176,196,222,1],lightyellow:[255,255,224,1],lime:[0,255,0,1],limegreen:[50,205,50,1],linen:[250,240,230,1],magenta:[255,0,255,1],maroon:[128,0,0,1],mediumaquamarine:[102,205,170,1],mediumblue:[0,0,205,1],mediumorchid:[186,85,211,1],mediumpurple:[147,112,219,1],mediumseagreen:[60,179,113,1],mediumslateblue:[123,104,238,1],mediumspringgreen:[0,250,154,1],mediumturquoise:[72,209,204,1],mediumvioletred:[199,21,133,1],midnightblue:[25,25,112,1],mintcream:[245,255,250,1],mistyrose:[255,228,225,1],moccasin:[255,228,181,1],navajowhite:[255,222,173,1],navy:[0,0,128,1],oldlace:[253,245,230,1],olive:[128,128,0,1],olivedrab:[107,142,35,1],orange:[255,165,0,1],orangered:[255,69,0,1],orchid:[218,112,214,1],palegoldenrod:[238,232,170,1],palegreen:[152,251,152,1],paleturquoise:[175,238,238,1],palevioletred:[219,112,147,1],papayawhip:[255,239,213,1],peachpuff:[255,218,185,1],peru:[205,133,63,1],pink:[255,192,203,1],plum:[221,160,221,1],powderblue:[176,224,230,1],purple:[128,0,128,1],rebeccapurple:[102,51,153,1],red:[255,0,0,1],rosybrown:[188,143,143,1],royalblue:[65,105,225,1],saddlebrown:[139,69,19,1],salmon:[250,128,114,1],sandybrown:[244,164,96,1],seagreen:[46,139,87,1],seashell:[255,245,238,1],sienna:[160,82,45,1],silver:[192,192,192,1],skyblue:[135,206,235,1],slateblue:[106,90,205,1],slategray:[112,128,144,1],slategrey:[112,128,144,1],snow:[255,250,250,1],springgreen:[0,255,127,1],steelblue:[70,130,180,1],tan:[210,180,140,1],teal:[0,128,128,1],thistle:[216,191,216,1],tomato:[255,99,71,1],turquoise:[64,224,208,1],violet:[238,130,238,1],wheat:[245,222,179,1],white:[255,255,255,1],whitesmoke:[245,245,245,1],yellow:[255,255,0,1],yellowgreen:[154,205,50,1]};function l(k){return(k=Math.round(k))<0?0:k>255?255:k}function f(k){return l(k[k.length-1]==="%"?parseFloat(k)/100*255:parseInt(k))}function m(k){return(A=k[k.length-1]==="%"?parseFloat(k)/100:parseFloat(k))<0?0:A>1?1:A;var A}function x(k,A,z){return z<0?z+=1:z>1&&(z-=1),6*z<1?k+(A-k)*z*6:2*z<1?A:3*z<2?k+(A-k)*(2/3-z)*6:k}try{t.parseCSSColor=function(k){var A,z=k.replace(/ /g,"").toLowerCase();if(z in i)return i[z].slice();if(z[0]==="#")return z.length===4?(A=parseInt(z.substr(1),16))>=0&&A<=4095?[(3840&A)>>4|(3840&A)>>8,240&A|(240&A)>>4,15&A|(15&A)<<4,1]:null:z.length===7&&(A=parseInt(z.substr(1),16))>=0&&A<=16777215?[(16711680&A)>>16,(65280&A)>>8,255&A,1]:null;var C=z.indexOf("("),B=z.indexOf(")");if(C!==-1&&B+1===z.length){var V=z.substr(0,C),j=z.substr(C+1,B-(C+1)).split(","),J=1;switch(V){case"rgba":if(j.length!==4)return null;J=m(j.pop());case"rgb":return j.length!==3?null:[f(j[0]),f(j[1]),f(j[2]),J];case"hsla":if(j.length!==4)return null;J=m(j.pop());case"hsl":if(j.length!==3)return null;var $=(parseFloat(j[0])%360+360)%360/360,he=m(j[1]),ie=m(j[2]),me=ie<=.5?ie*(he+1):ie+he-ie*he,ve=2*ie-me;return[l(255*x(ve,me,$+1/3)),l(255*x(ve,me,$)),l(255*x(ve,me,$-1/3)),J];default:return null}}return null}}catch{}}).parseCSSColor,dr=function(e,t,i,l){l===void 0&&(l=1),this.r=e,this.g=t,this.b=i,this.a=l};dr.parse=function(e){if(e){if(e instanceof dr)return e;if(typeof e=="string"){var t=Qt(e);if(t)return new dr(t[0]/255*t[3],t[1]/255*t[3],t[2]/255*t[3],t[3])}}},dr.prototype.toString=function(){var e=this.toArray(),t=e[1],i=e[2],l=e[3];return"rgba("+Math.round(e[0])+","+Math.round(t)+","+Math.round(i)+","+l+")"},dr.prototype.toArray=function(){var e=this.a;return e===0?[0,0,0,0]:[255*this.r/e,255*this.g/e,255*this.b/e,e]},dr.black=new dr(0,0,0,1),dr.white=new dr(1,1,1,1),dr.transparent=new dr(0,0,0,0),dr.red=new dr(1,0,0,1);var Ii=function(e,t,i){this.sensitivity=e?t?"variant":"case":t?"accent":"base",this.locale=i,this.collator=new Intl.Collator(this.locale?this.locale:[],{sensitivity:this.sensitivity,usage:"search"})};Ii.prototype.compare=function(e,t){return this.collator.compare(e,t)},Ii.prototype.resolvedLocale=function(){return new Intl.Collator(this.locale?this.locale:[]).resolvedOptions().locale};var pa=function(e,t,i,l,f){this.text=e,this.image=t,this.scale=i,this.fontStack=l,this.textColor=f},si=function(e){this.sections=e};si.fromString=function(e){return new si([new pa(e,null,null,null,null)])},si.prototype.isEmpty=function(){return this.sections.length===0||!this.sections.some(function(e){return e.text.length!==0||e.image&&e.image.name.length!==0})},si.factory=function(e){return e instanceof si?e:si.fromString(e)},si.prototype.toString=function(){return this.sections.length===0?"":this.sections.map(function(e){return e.text}).join("")},si.prototype.serialize=function(){for(var e=["format"],t=0,i=this.sections;t<i.length;t+=1){var l=i[t];if(l.image)e.push(["image",l.image.name]);else{e.push(l.text);var f={};l.fontStack&&(f["text-font"]=["literal",l.fontStack.split(",")]),l.scale&&(f["font-scale"]=l.scale),l.textColor&&(f["text-color"]=["rgba"].concat(l.textColor.toArray())),e.push(f)}}return e};var Oi=function(e){this.name=e.name,this.available=e.available};function Na(e,t,i,l){return typeof e=="number"&&e>=0&&e<=255&&typeof t=="number"&&t>=0&&t<=255&&typeof i=="number"&&i>=0&&i<=255?l===void 0||typeof l=="number"&&l>=0&&l<=1?null:"Invalid rgba value ["+[e,t,i,l].join(", ")+"]: 'a' must be between 0 and 1.":"Invalid rgba value ["+(typeof l=="number"?[e,t,i,l]:[e,t,i]).join(", ")+"]: 'r', 'g', and 'b' must be between 0 and 255."}function va(e){if(e===null||typeof e=="string"||typeof e=="boolean"||typeof e=="number"||e instanceof dr||e instanceof Ii||e instanceof si||e instanceof Oi)return!0;if(Array.isArray(e)){for(var t=0,i=e;t<i.length;t+=1)if(!va(i[t]))return!1;return!0}if(typeof e=="object"){for(var l in e)if(!va(e[l]))return!1;return!0}return!1}function jr(e){if(e===null)return at;if(typeof e=="string")return He;if(typeof e=="boolean")return Qe;if(typeof e=="number")return Te;if(e instanceof dr)return rt;if(e instanceof Ii)return tr;if(e instanceof si)return wr;if(e instanceof Oi)return Ht;if(Array.isArray(e)){for(var t,i=e.length,l=0,f=e;l<f.length;l+=1){var m=jr(f[l]);if(t){if(t===m)continue;t=nt;break}t=m}return fr(t||nt,i)}return jt}function ba(e){var t=typeof e;return e===null?"":t==="string"||t==="number"||t==="boolean"?String(e):e instanceof dr||e instanceof si||e instanceof Oi?e.toString():JSON.stringify(e)}Oi.prototype.toString=function(){return this.name},Oi.fromString=function(e){return e?new Oi({name:e,available:!1}):null},Oi.prototype.serialize=function(){return["image",this.name]};var Ai=function(e,t){this.type=e,this.value=t};Ai.parse=function(e,t){if(e.length!==2)return t.error("'literal' expression requires exactly one argument, but found "+(e.length-1)+" instead.");if(!va(e[1]))return t.error("invalid value");var i=e[1],l=jr(i),f=t.expectedType;return l.kind!=="array"||l.N!==0||!f||f.kind!=="array"||typeof f.N=="number"&&f.N!==0||(l=f),new Ai(l,i)},Ai.prototype.evaluate=function(){return this.value},Ai.prototype.eachChild=function(){},Ai.prototype.outputDefined=function(){return!0},Ai.prototype.serialize=function(){return this.type.kind==="array"||this.type.kind==="object"?["literal",this.value]:this.value instanceof dr?["rgba"].concat(this.value.toArray()):this.value instanceof si?this.value.serialize():this.value};var li=function(e){this.name="ExpressionEvaluationError",this.message=e};li.prototype.toJSON=function(){return this.message};var cn={string:He,number:Te,boolean:Qe,object:jt},Pr=function(e,t){this.type=e,this.args=t};Pr.parse=function(e,t){if(e.length<2)return t.error("Expected at least one argument.");var i,l=1,f=e[0];if(f==="array"){var m,x;if(e.length>2){var k=e[1];if(typeof k!="string"||!(k in cn)||k==="object")return t.error('The item type argument of "array" must be one of string, number, boolean',1);m=cn[k],l++}else m=nt;if(e.length>3){if(e[2]!==null&&(typeof e[2]!="number"||e[2]<0||e[2]!==Math.floor(e[2])))return t.error('The length argument to "array" must be a positive integer literal',2);x=e[2],l++}i=fr(m,x)}else i=cn[f];for(var A=[];l<e.length;l++){var z=t.parse(e[l],l,nt);if(!z)return null;A.push(z)}return new Pr(i,A)},Pr.prototype.evaluate=function(e){for(var t=0;t<this.args.length;t++){var i=this.args[t].evaluate(e);if(!yr(this.type,jr(i)))return i;if(t===this.args.length-1)throw new li("Expected value to be of type "+rr(this.type)+", but found "+rr(jr(i))+" instead.")}return null},Pr.prototype.eachChild=function(e){this.args.forEach(e)},Pr.prototype.outputDefined=function(){return this.args.every(function(e){return e.outputDefined()})},Pr.prototype.serialize=function(){var e=this.type,t=[e.kind];if(e.kind==="array"){var i=e.itemType;if(i.kind==="string"||i.kind==="number"||i.kind==="boolean"){t.push(i.kind);var l=e.N;(typeof l=="number"||this.args.length>1)&&t.push(l)}}return t.concat(this.args.map(function(f){return f.serialize()}))};var Rn=function(e){this.type=wr,this.sections=e};Rn.parse=function(e,t){if(e.length<2)return t.error("Expected at least one argument.");var i=e[1];if(!Array.isArray(i)&&typeof i=="object")return t.error("First argument must be an image or text section.");for(var l=[],f=!1,m=1;m<=e.length-1;++m){var x=e[m];if(f&&typeof x=="object"&&!Array.isArray(x)){f=!1;var k=null;if(x["font-scale"]&&!(k=t.parse(x["font-scale"],1,Te)))return null;var A=null;if(x["text-font"]&&!(A=t.parse(x["text-font"],1,fr(He))))return null;var z=null;if(x["text-color"]&&!(z=t.parse(x["text-color"],1,rt)))return null;var C=l[l.length-1];C.scale=k,C.font=A,C.textColor=z}else{var B=t.parse(e[m],1,nt);if(!B)return null;var V=B.type.kind;if(V!=="string"&&V!=="value"&&V!=="null"&&V!=="resolvedImage")return t.error("Formatted text type must be 'string', 'value', 'image' or 'null'.");f=!0,l.push({content:B,scale:null,font:null,textColor:null})}}return new Rn(l)},Rn.prototype.evaluate=function(e){return new si(this.sections.map(function(t){var i=t.content.evaluate(e);return jr(i)===Ht?new pa("",i,null,null,null):new pa(ba(i),null,t.scale?t.scale.evaluate(e):null,t.font?t.font.evaluate(e).join(","):null,t.textColor?t.textColor.evaluate(e):null)}))},Rn.prototype.eachChild=function(e){for(var t=0,i=this.sections;t<i.length;t+=1){var l=i[t];e(l.content),l.scale&&e(l.scale),l.font&&e(l.font),l.textColor&&e(l.textColor)}},Rn.prototype.outputDefined=function(){return!1},Rn.prototype.serialize=function(){for(var e=["format"],t=0,i=this.sections;t<i.length;t+=1){var l=i[t];e.push(l.content.serialize());var f={};l.scale&&(f["font-scale"]=l.scale.serialize()),l.font&&(f["text-font"]=l.font.serialize()),l.textColor&&(f["text-color"]=l.textColor.serialize()),e.push(f)}return e};var _n=function(e){this.type=Ht,this.input=e};_n.parse=function(e,t){if(e.length!==2)return t.error("Expected two arguments.");var i=t.parse(e[1],1,He);return i?new _n(i):t.error("No image name provided.")},_n.prototype.evaluate=function(e){var t=this.input.evaluate(e),i=Oi.fromString(t);return i&&e.availableImages&&(i.available=e.availableImages.indexOf(t)>-1),i},_n.prototype.eachChild=function(e){e(this.input)},_n.prototype.outputDefined=function(){return!1},_n.prototype.serialize=function(){return["image",this.input.serialize()]};var is={"to-boolean":Qe,"to-color":rt,"to-number":Te,"to-string":He},zi=function(e,t){this.type=e,this.args=t};zi.parse=function(e,t){if(e.length<2)return t.error("Expected at least one argument.");var i=e[0];if((i==="to-boolean"||i==="to-string")&&e.length!==2)return t.error("Expected one argument.");for(var l=is[i],f=[],m=1;m<e.length;m++){var x=t.parse(e[m],m,nt);if(!x)return null;f.push(x)}return new zi(l,f)},zi.prototype.evaluate=function(e){if(this.type.kind==="boolean")return!!this.args[0].evaluate(e);if(this.type.kind==="color"){for(var t,i,l=0,f=this.args;l<f.length;l+=1){if(i=null,(t=f[l].evaluate(e))instanceof dr)return t;if(typeof t=="string"){var m=e.parseColor(t);if(m)return m}else if(Array.isArray(t)&&!(i=t.length<3||t.length>4?"Invalid rbga value "+JSON.stringify(t)+": expected an array containing either three or four numeric values.":Na(t[0],t[1],t[2],t[3])))return new dr(t[0]/255,t[1]/255,t[2]/255,t[3])}throw new li(i||"Could not parse color from value '"+(typeof t=="string"?t:String(JSON.stringify(t)))+"'")}if(this.type.kind==="number"){for(var x=null,k=0,A=this.args;k<A.length;k+=1){if((x=A[k].evaluate(e))===null)return 0;var z=Number(x);if(!isNaN(z))return z}throw new li("Could not convert "+JSON.stringify(x)+" to number.")}return this.type.kind==="formatted"?si.fromString(ba(this.args[0].evaluate(e))):this.type.kind==="resolvedImage"?Oi.fromString(ba(this.args[0].evaluate(e))):ba(this.args[0].evaluate(e))},zi.prototype.eachChild=function(e){this.args.forEach(e)},zi.prototype.outputDefined=function(){return this.args.every(function(e){return e.outputDefined()})},zi.prototype.serialize=function(){if(this.type.kind==="formatted")return new Rn([{content:this.args[0],scale:null,font:null,textColor:null}]).serialize();if(this.type.kind==="resolvedImage")return new _n(this.args[0]).serialize();var e=["to-"+this.type.kind];return this.eachChild(function(t){e.push(t.serialize())}),e};var xa=["Unknown","Point","LineString","Polygon"],Zi=function(){this.globals=null,this.feature=null,this.featureState=null,this.formattedSection=null,this._parseColorCache={},this.availableImages=null,this.canonical=null};Zi.prototype.id=function(){return this.feature&&"id"in this.feature?this.feature.id:null},Zi.prototype.geometryType=function(){return this.feature?typeof this.feature.type=="number"?xa[this.feature.type]:this.feature.type:null},Zi.prototype.geometry=function(){return this.feature&&"geometry"in this.feature?this.feature.geometry:null},Zi.prototype.canonicalID=function(){return this.canonical},Zi.prototype.properties=function(){return this.feature&&this.feature.properties||{}},Zi.prototype.parseColor=function(e){var t=this._parseColorCache[e];return t||(t=this._parseColorCache[e]=dr.parse(e)),t};var Pi=function(e,t,i,l){this.name=e,this.type=t,this._evaluate=i,this.args=l};Pi.prototype.evaluate=function(e){return this._evaluate(e,this.args)},Pi.prototype.eachChild=function(e){this.args.forEach(e)},Pi.prototype.outputDefined=function(){return!1},Pi.prototype.serialize=function(){return[this.name].concat(this.args.map(function(e){return e.serialize()}))},Pi.parse=function(e,t){var i,l=e[0],f=Pi.definitions[l];if(!f)return t.error('Unknown expression "'+l+'". If you wanted a literal array, use ["literal", [...]].',0);for(var m=Array.isArray(f)?f[0]:f.type,x=Array.isArray(f)?[[f[1],f[2]]]:f.overloads,k=x.filter(function(Tt){var lt=Tt[0];return!Array.isArray(lt)||lt.length===e.length-1}),A=null,z=0,C=k;z<C.length;z+=1){var B=C[z],V=B[0],j=B[1];A=new Gr(t.registry,t.path,null,t.scope);for(var J=[],$=!1,he=1;he<e.length;he++){var ie=e[he],me=Array.isArray(V)?V[he-1]:V.type,ve=A.parse(ie,1+J.length,me);if(!ve){$=!0;break}J.push(ve)}if(!$)if(Array.isArray(V)&&V.length!==J.length)A.error("Expected "+V.length+" arguments, but found "+J.length+" instead.");else{for(var we=0;we<J.length;we++){var ke=Array.isArray(V)?V[we]:V.type,Pe=J[we];A.concat(we+1).checkSubtype(ke,Pe.type)}if(A.errors.length===0)return new Pi(l,m,j,J)}}if(k.length===1)(i=t.errors).push.apply(i,A.errors);else{for(var qe=(k.length?k:x).map(function(Tt){var lt;return lt=Tt[0],Array.isArray(lt)?"("+lt.map(rr).join(", ")+")":"("+rr(lt.type)+"...)"}).join(" | "),et=[],wt=1;wt<e.length;wt++){var st=t.parse(e[wt],1+et.length);if(!st)return null;et.push(rr(st.type))}t.error("Expected arguments of type "+qe+", but found ("+et.join(", ")+") instead.")}return null},Pi.register=function(e,t){for(var i in Pi.definitions=t,t)e[i]=Pi};var Yn=function(e,t,i){this.type=tr,this.locale=i,this.caseSensitive=e,this.diacriticSensitive=t};function Ki(e,t){e[0]=Math.min(e[0],t[0]),e[1]=Math.min(e[1],t[1]),e[2]=Math.max(e[2],t[0]),e[3]=Math.max(e[3],t[1])}function wa(e,t){return!(e[0]<=t[0]||e[2]>=t[2]||e[1]<=t[1]||e[3]>=t[3])}function ns(e,t){var i=(180+e[0])/360,l=(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+e[1]*Math.PI/360)))/360,f=Math.pow(2,t.z);return[Math.round(i*f*8192),Math.round(l*f*8192)]}function Bl(e,t,i){return t[1]>e[1]!=i[1]>e[1]&&e[0]<(i[0]-t[0])*(e[1]-t[1])/(i[1]-t[1])+t[0]}function uo(e,t){for(var i,l,f,m,x,k,A,z=!1,C=0,B=t.length;C<B;C++)for(var V=t[C],j=0,J=V.length;j<J-1;j++){if((m=(i=e)[0]-(l=V[j])[0])*(A=i[1]-(f=V[j+1])[1])-(k=i[0]-f[0])*(x=i[1]-l[1])==0&&m*k<=0&&x*A<=0)return!1;Bl(e,V[j],V[j+1])&&(z=!z)}return z}function Ol(e,t){for(var i=0;i<t.length;i++)if(uo(e,t[i]))return!0;return!1}function Ro(e,t,i,l){var f=l[0]-i[0],m=l[1]-i[1],x=(e[0]-i[0])*m-f*(e[1]-i[1]),k=(t[0]-i[0])*m-f*(t[1]-i[1]);return x>0&&k<0||x<0&&k>0}function Fl(e,t,i){for(var l=0,f=i;l<f.length;l+=1)for(var m=f[l],x=0;x<m.length-1;++x)if((B=[(C=m[x+1])[0]-(z=m[x])[0],C[1]-z[1]])[0]*(V=[(A=t)[0]-(k=e)[0],A[1]-k[1]])[1]-B[1]*V[0]!=0&&Ro(k,A,z,C)&&Ro(z,C,k,A))return!0;var k,A,z,C,B,V;return!1}function Bo(e,t){for(var i=0;i<e.length;++i)if(!uo(e[i],t))return!1;for(var l=0;l<e.length-1;++l)if(Fl(e[l],e[l+1],t))return!1;return!0}function Bs(e,t){for(var i=0;i<t.length;i++)if(Bo(e,t[i]))return!0;return!1}function Va(e,t,i){for(var l=[],f=0;f<e.length;f++){for(var m=[],x=0;x<e[f].length;x++){var k=ns(e[f][x],i);Ki(t,k),m.push(k)}l.push(m)}return l}function as(e,t,i){for(var l=[],f=0;f<e.length;f++){var m=Va(e[f],t,i);l.push(m)}return l}function co(e,t,i,l){if(e[0]<i[0]||e[0]>i[2]){var f=.5*l,m=e[0]-i[0]>f?-l:i[0]-e[0]>f?l:0;m===0&&(m=e[0]-i[2]>f?-l:i[2]-e[0]>f?l:0),e[0]+=m}Ki(t,e)}function Os(e,t,i,l){for(var f=8192*Math.pow(2,l.z),m=[8192*l.x,8192*l.y],x=[],k=0,A=e;k<A.length;k+=1)for(var z=0,C=A[k];z<C.length;z+=1){var B=C[z],V=[B.x+m[0],B.y+m[1]];co(V,t,i,f),x.push(V)}return x}function Ua(e,t,i,l){for(var f,m=8192*Math.pow(2,l.z),x=[8192*l.x,8192*l.y],k=[],A=0,z=e;A<z.length;A+=1){for(var C=[],B=0,V=z[A];B<V.length;B+=1){var j=V[B],J=[j.x+x[0],j.y+x[1]];Ki(t,J),C.push(J)}k.push(C)}if(t[2]-t[0]<=m/2){(f=t)[0]=f[1]=1/0,f[2]=f[3]=-1/0;for(var $=0,he=k;$<he.length;$+=1)for(var ie=0,me=he[$];ie<me.length;ie+=1)co(me[ie],t,i,m)}return k}Yn.parse=function(e,t){if(e.length!==2)return t.error("Expected one argument.");var i=e[1];if(typeof i!="object"||Array.isArray(i))return t.error("Collator options argument must be an object.");var l=t.parse(i["case-sensitive"]!==void 0&&i["case-sensitive"],1,Qe);if(!l)return null;var f=t.parse(i["diacritic-sensitive"]!==void 0&&i["diacritic-sensitive"],1,Qe);if(!f)return null;var m=null;return i.locale&&!(m=t.parse(i.locale,1,He))?null:new Yn(l,f,m)},Yn.prototype.evaluate=function(e){return new Ii(this.caseSensitive.evaluate(e),this.diacriticSensitive.evaluate(e),this.locale?this.locale.evaluate(e):null)},Yn.prototype.eachChild=function(e){e(this.caseSensitive),e(this.diacriticSensitive),this.locale&&e(this.locale)},Yn.prototype.outputDefined=function(){return!1},Yn.prototype.serialize=function(){var e={};return e["case-sensitive"]=this.caseSensitive.serialize(),e["diacritic-sensitive"]=this.diacriticSensitive.serialize(),this.locale&&(e.locale=this.locale.serialize()),["collator",e]};var Bn=function(e,t){this.type=Qe,this.geojson=e,this.geometries=t};function Sa(e){if(e instanceof Pi&&(e.name==="get"&&e.args.length===1||e.name==="feature-state"||e.name==="has"&&e.args.length===1||e.name==="properties"||e.name==="geometry-type"||e.name==="id"||/^filter-/.test(e.name))||e instanceof Bn)return!1;var t=!0;return e.eachChild(function(i){t&&!Sa(i)&&(t=!1)}),t}function ye(e){if(e instanceof Pi&&e.name==="feature-state")return!1;var t=!0;return e.eachChild(function(i){t&&!ye(i)&&(t=!1)}),t}function hn(e,t){if(e instanceof Pi&&t.indexOf(e.name)>=0)return!1;var i=!0;return e.eachChild(function(l){i&&!hn(l,t)&&(i=!1)}),i}Bn.parse=function(e,t){if(e.length!==2)return t.error("'within' expression requires exactly one argument, but found "+(e.length-1)+" instead.");if(va(e[1])){var i=e[1];if(i.type==="FeatureCollection")for(var l=0;l<i.features.length;++l){var f=i.features[l].geometry.type;if(f==="Polygon"||f==="MultiPolygon")return new Bn(i,i.features[l].geometry)}else if(i.type==="Feature"){var m=i.geometry.type;if(m==="Polygon"||m==="MultiPolygon")return new Bn(i,i.geometry)}else if(i.type==="Polygon"||i.type==="MultiPolygon")return new Bn(i,i)}return t.error("'within' expression requires valid geojson object that contains polygon geometry type.")},Bn.prototype.evaluate=function(e){if(e.geometry()!=null&&e.canonicalID()!=null){if(e.geometryType()==="Point")return function(t,i){var l=[1/0,1/0,-1/0,-1/0],f=[1/0,1/0,-1/0,-1/0],m=t.canonicalID();if(i.type==="Polygon"){var x=Va(i.coordinates,f,m),k=Os(t.geometry(),l,f,m);if(!wa(l,f))return!1;for(var A=0,z=k;A<z.length;A+=1)if(!uo(z[A],x))return!1}if(i.type==="MultiPolygon"){var C=as(i.coordinates,f,m),B=Os(t.geometry(),l,f,m);if(!wa(l,f))return!1;for(var V=0,j=B;V<j.length;V+=1)if(!Ol(j[V],C))return!1}return!0}(e,this.geometries);if(e.geometryType()==="LineString")return function(t,i){var l=[1/0,1/0,-1/0,-1/0],f=[1/0,1/0,-1/0,-1/0],m=t.canonicalID();if(i.type==="Polygon"){var x=Va(i.coordinates,f,m),k=Ua(t.geometry(),l,f,m);if(!wa(l,f))return!1;for(var A=0,z=k;A<z.length;A+=1)if(!Bo(z[A],x))return!1}if(i.type==="MultiPolygon"){var C=as(i.coordinates,f,m),B=Ua(t.geometry(),l,f,m);if(!wa(l,f))return!1;for(var V=0,j=B;V<j.length;V+=1)if(!Bs(j[V],C))return!1}return!0}(e,this.geometries)}return!1},Bn.prototype.eachChild=function(){},Bn.prototype.outputDefined=function(){return!0},Bn.prototype.serialize=function(){return["within",this.geojson]};var Hi=function(e,t){this.type=t.type,this.name=e,this.boundExpression=t};Hi.parse=function(e,t){if(e.length!==2||typeof e[1]!="string")return t.error("'var' expression requires exactly one string literal argument.");var i=e[1];return t.scope.has(i)?new Hi(i,t.scope.get(i)):t.error('Unknown variable "'+i+'". Make sure "'+i+'" has been bound in an enclosing "let" expression before using it.',1)},Hi.prototype.evaluate=function(e){return this.boundExpression.evaluate(e)},Hi.prototype.eachChild=function(){},Hi.prototype.outputDefined=function(){return!1},Hi.prototype.serialize=function(){return["var",this.name]};var Gr=function(e,t,i,l,f){t===void 0&&(t=[]),l===void 0&&(l=new ht),f===void 0&&(f=[]),this.registry=e,this.path=t,this.key=t.map(function(m){return"["+m+"]"}).join(""),this.scope=l,this.errors=f,this.expectedType=i};function ka(e,t){for(var i,l=e.length-1,f=0,m=l,x=0;f<=m;)if((i=e[x=Math.floor((f+m)/2)])<=t){if(x===l||t<e[x+1])return x;f=x+1}else{if(!(i>t))throw new li("Input is not a number.");m=x-1}return 0}Gr.prototype.parse=function(e,t,i,l,f){return f===void 0&&(f={}),t?this.concat(t,i,l)._parse(e,f):this._parse(e,f)},Gr.prototype._parse=function(e,t){function i(z,C,B){return B==="assert"?new Pr(C,[z]):B==="coerce"?new zi(C,[z]):z}if(e!==null&&typeof e!="string"&&typeof e!="boolean"&&typeof e!="number"||(e=["literal",e]),Array.isArray(e)){if(e.length===0)return this.error('Expected an array with at least one element. If you wanted a literal array, use ["literal", []].');var l=e[0];if(typeof l!="string")return this.error("Expression name must be a string, but found "+typeof l+' instead. If you wanted a literal array, use ["literal", [...]].',0),null;var f=this.registry[l];if(f){var m=f.parse(e,this);if(!m)return null;if(this.expectedType){var x=this.expectedType,k=m.type;if(x.kind!=="string"&&x.kind!=="number"&&x.kind!=="boolean"&&x.kind!=="object"&&x.kind!=="array"||k.kind!=="value")if(x.kind!=="color"&&x.kind!=="formatted"&&x.kind!=="resolvedImage"||k.kind!=="value"&&k.kind!=="string"){if(this.checkSubtype(x,k))return null}else m=i(m,x,t.typeAnnotation||"coerce");else m=i(m,x,t.typeAnnotation||"assert")}if(!(m instanceof Ai)&&m.type.kind!=="resolvedImage"&&function z(C){if(C instanceof Hi)return z(C.boundExpression);if(C instanceof Pi&&C.name==="error"||C instanceof Yn||C instanceof Bn)return!1;var B=C instanceof zi||C instanceof Pr,V=!0;return C.eachChild(function(j){V=B?V&&z(j):V&&j instanceof Ai}),!!V&&Sa(C)&&hn(C,["zoom","heatmap-density","line-progress","accumulated","is-supported-script"])}(m)){var A=new Zi;try{m=new Ai(m.type,m.evaluate(A))}catch(z){return this.error(z.message),null}}return m}return this.error('Unknown expression "'+l+'". If you wanted a literal array, use ["literal", [...]].',0)}return this.error(e===void 0?"'undefined' value invalid. Use null instead.":typeof e=="object"?'Bare objects invalid. Use ["literal", {...}] instead.':"Expected an array, but found "+typeof e+" instead.")},Gr.prototype.concat=function(e,t,i){var l=typeof e=="number"?this.path.concat(e):this.path,f=i?this.scope.concat(i):this.scope;return new Gr(this.registry,l,t||null,f,this.errors)},Gr.prototype.error=function(e){for(var t=[],i=arguments.length-1;i-- >0;)t[i]=arguments[i+1];var l=""+this.key+t.map(function(f){return"["+f+"]"}).join("");this.errors.push(new Re(l,e))},Gr.prototype.checkSubtype=function(e,t){var i=yr(e,t);return i&&this.error(i),i};var On=function(e,t,i){this.type=e,this.input=t,this.labels=[],this.outputs=[];for(var l=0,f=i;l<f.length;l+=1){var m=f[l],x=m[1];this.labels.push(m[0]),this.outputs.push(x)}};function wi(e,t,i){return e*(1-i)+t*i}On.parse=function(e,t){if(e.length-1<4)return t.error("Expected at least 4 arguments, but found only "+(e.length-1)+".");if((e.length-1)%2!=0)return t.error("Expected an even number of arguments.");var i=t.parse(e[1],1,Te);if(!i)return null;var l=[],f=null;t.expectedType&&t.expectedType.kind!=="value"&&(f=t.expectedType);for(var m=1;m<e.length;m+=2){var x=m===1?-1/0:e[m],k=e[m+1],A=m,z=m+1;if(typeof x!="number")return t.error('Input/output pairs for "step" expressions must be defined using literal numeric values (not computed expressions) for the input values.',A);if(l.length&&l[l.length-1][0]>=x)return t.error('Input/output pairs for "step" expressions must be arranged with input values in strictly ascending order.',A);var C=t.parse(k,z,f);if(!C)return null;f=f||C.type,l.push([x,C])}return new On(f,i,l)},On.prototype.evaluate=function(e){var t=this.labels,i=this.outputs;if(t.length===1)return i[0].evaluate(e);var l=this.input.evaluate(e);if(l<=t[0])return i[0].evaluate(e);var f=t.length;return l>=t[f-1]?i[f-1].evaluate(e):i[ka(t,l)].evaluate(e)},On.prototype.eachChild=function(e){e(this.input);for(var t=0,i=this.outputs;t<i.length;t+=1)e(i[t])},On.prototype.outputDefined=function(){return this.outputs.every(function(e){return e.outputDefined()})},On.prototype.serialize=function(){for(var e=["step",this.input.serialize()],t=0;t<this.labels.length;t++)t>0&&e.push(this.labels[t]),e.push(this.outputs[t].serialize());return e};var Oo=Object.freeze({__proto__:null,number:wi,color:function(e,t,i){return new dr(wi(e.r,t.r,i),wi(e.g,t.g,i),wi(e.b,t.b,i),wi(e.a,t.a,i))},array:function(e,t,i){return e.map(function(l,f){return wi(l,t[f],i)})}}),ec=6/29*3*(6/29),Fh=Math.PI/180,Nh=180/Math.PI;function Nl(e){return e>.008856451679035631?Math.pow(e,1/3):e/ec+4/29}function Vl(e){return e>6/29?e*e*e:ec*(e-4/29)}function Ul(e){return 255*(e<=.0031308?12.92*e:1.055*Math.pow(e,1/2.4)-.055)}function ql(e){return(e/=255)<=.04045?e/12.92:Math.pow((e+.055)/1.055,2.4)}function tc(e){var t=ql(e.r),i=ql(e.g),l=ql(e.b),f=Nl((.4124564*t+.3575761*i+.1804375*l)/.95047),m=Nl((.2126729*t+.7151522*i+.072175*l)/1);return{l:116*m-16,a:500*(f-m),b:200*(m-Nl((.0193339*t+.119192*i+.9503041*l)/1.08883)),alpha:e.a}}function rc(e){var t=(e.l+16)/116,i=isNaN(e.a)?t:t+e.a/500,l=isNaN(e.b)?t:t-e.b/200;return t=1*Vl(t),i=.95047*Vl(i),l=1.08883*Vl(l),new dr(Ul(3.2404542*i-1.5371385*t-.4985314*l),Ul(-.969266*i+1.8760108*t+.041556*l),Ul(.0556434*i-.2040259*t+1.0572252*l),e.alpha)}function Vh(e,t,i){var l=t-e;return e+i*(l>180||l<-180?l-360*Math.round(l/360):l)}var os={forward:tc,reverse:rc,interpolate:function(e,t,i){return{l:wi(e.l,t.l,i),a:wi(e.a,t.a,i),b:wi(e.b,t.b,i),alpha:wi(e.alpha,t.alpha,i)}}},ss={forward:function(e){var t=tc(e),i=t.l,l=t.a,f=t.b,m=Math.atan2(f,l)*Nh;return{h:m<0?m+360:m,c:Math.sqrt(l*l+f*f),l:i,alpha:e.a}},reverse:function(e){var t=e.h*Fh,i=e.c;return rc({l:e.l,a:Math.cos(t)*i,b:Math.sin(t)*i,alpha:e.alpha})},interpolate:function(e,t,i){return{h:Vh(e.h,t.h,i),c:wi(e.c,t.c,i),l:wi(e.l,t.l,i),alpha:wi(e.alpha,t.alpha,i)}}},ic=Object.freeze({__proto__:null,lab:os,hcl:ss}),an=function(e,t,i,l,f){this.type=e,this.operator=t,this.interpolation=i,this.input=l,this.labels=[],this.outputs=[];for(var m=0,x=f;m<x.length;m+=1){var k=x[m],A=k[1];this.labels.push(k[0]),this.outputs.push(A)}};function jl(e,t,i,l){var f=l-i,m=e-i;return f===0?0:t===1?m/f:(Math.pow(t,m)-1)/(Math.pow(t,f)-1)}an.interpolationFactor=function(e,t,i,l){var f=0;if(e.name==="exponential")f=jl(t,e.base,i,l);else if(e.name==="linear")f=jl(t,1,i,l);else if(e.name==="cubic-bezier"){var m=e.controlPoints;f=new T(m[0],m[1],m[2],m[3]).solve(jl(t,1,i,l))}return f},an.parse=function(e,t){var i=e[0],l=e[1],f=e[2],m=e.slice(3);if(!Array.isArray(l)||l.length===0)return t.error("Expected an interpolation type expression.",1);if(l[0]==="linear")l={name:"linear"};else if(l[0]==="exponential"){var x=l[1];if(typeof x!="number")return t.error("Exponential interpolation requires a numeric base.",1,1);l={name:"exponential",base:x}}else{if(l[0]!=="cubic-bezier")return t.error("Unknown interpolation type "+String(l[0]),1,0);var k=l.slice(1);if(k.length!==4||k.some(function(he){return typeof he!="number"||he<0||he>1}))return t.error("Cubic bezier interpolation requires four numeric arguments with values between 0 and 1.",1);l={name:"cubic-bezier",controlPoints:k}}if(e.length-1<4)return t.error("Expected at least 4 arguments, but found only "+(e.length-1)+".");if((e.length-1)%2!=0)return t.error("Expected an even number of arguments.");if(!(f=t.parse(f,2,Te)))return null;var A=[],z=null;i==="interpolate-hcl"||i==="interpolate-lab"?z=rt:t.expectedType&&t.expectedType.kind!=="value"&&(z=t.expectedType);for(var C=0;C<m.length;C+=2){var B=m[C],V=m[C+1],j=C+3,J=C+4;if(typeof B!="number")return t.error('Input/output pairs for "interpolate" expressions must be defined using literal numeric values (not computed expressions) for the input values.',j);if(A.length&&A[A.length-1][0]>=B)return t.error('Input/output pairs for "interpolate" expressions must be arranged with input values in strictly ascending order.',j);var $=t.parse(V,J,z);if(!$)return null;z=z||$.type,A.push([B,$])}return z.kind==="number"||z.kind==="color"||z.kind==="array"&&z.itemType.kind==="number"&&typeof z.N=="number"?new an(z,i,l,f,A):t.error("Type "+rr(z)+" is not interpolatable.")},an.prototype.evaluate=function(e){var t=this.labels,i=this.outputs;if(t.length===1)return i[0].evaluate(e);var l=this.input.evaluate(e);if(l<=t[0])return i[0].evaluate(e);var f=t.length;if(l>=t[f-1])return i[f-1].evaluate(e);var m=ka(t,l),x=an.interpolationFactor(this.interpolation,l,t[m],t[m+1]),k=i[m].evaluate(e),A=i[m+1].evaluate(e);return this.operator==="interpolate"?Oo[this.type.kind.toLowerCase()](k,A,x):this.operator==="interpolate-hcl"?ss.reverse(ss.interpolate(ss.forward(k),ss.forward(A),x)):os.reverse(os.interpolate(os.forward(k),os.forward(A),x))},an.prototype.eachChild=function(e){e(this.input);for(var t=0,i=this.outputs;t<i.length;t+=1)e(i[t])},an.prototype.outputDefined=function(){return this.outputs.every(function(e){return e.outputDefined()})},an.prototype.serialize=function(){var e;e=this.interpolation.name==="linear"?["linear"]:this.interpolation.name==="exponential"?this.interpolation.base===1?["linear"]:["exponential",this.interpolation.base]:["cubic-bezier"].concat(this.interpolation.controlPoints);for(var t=[this.operator,e,this.input.serialize()],i=0;i<this.labels.length;i++)t.push(this.labels[i],this.outputs[i].serialize());return t};var qa=function(e,t){this.type=e,this.args=t};qa.parse=function(e,t){if(e.length<2)return t.error("Expectected at least one argument.");var i=null,l=t.expectedType;l&&l.kind!=="value"&&(i=l);for(var f=[],m=0,x=e.slice(1);m<x.length;m+=1){var k=t.parse(x[m],1+f.length,i,void 0,{typeAnnotation:"omit"});if(!k)return null;i=i||k.type,f.push(k)}var A=l&&f.some(function(z){return yr(l,z.type)});return new qa(A?nt:i,f)},qa.prototype.evaluate=function(e){for(var t,i=null,l=0,f=0,m=this.args;f<m.length&&(l++,(i=m[f].evaluate(e))&&i instanceof Oi&&!i.available&&(t||(t=i.name),i=null,l===this.args.length&&(i=t)),i===null);f+=1);return i},qa.prototype.eachChild=function(e){this.args.forEach(e)},qa.prototype.outputDefined=function(){return this.args.every(function(e){return e.outputDefined()})},qa.prototype.serialize=function(){var e=["coalesce"];return this.eachChild(function(t){e.push(t.serialize())}),e};var ja=function(e,t){this.type=t.type,this.bindings=[].concat(e),this.result=t};ja.prototype.evaluate=function(e){return this.result.evaluate(e)},ja.prototype.eachChild=function(e){for(var t=0,i=this.bindings;t<i.length;t+=1)e(i[t][1]);e(this.result)},ja.parse=function(e,t){if(e.length<4)return t.error("Expected at least 3 arguments, but found "+(e.length-1)+" instead.");for(var i=[],l=1;l<e.length-1;l+=2){var f=e[l];if(typeof f!="string")return t.error("Expected string, but found "+typeof f+" instead.",l);if(/[^a-zA-Z0-9_]/.test(f))return t.error("Variable names must contain only alphanumeric characters or '_'.",l);var m=t.parse(e[l+1],l+1);if(!m)return null;i.push([f,m])}var x=t.parse(e[e.length-1],e.length-1,t.expectedType,i);return x?new ja(i,x):null},ja.prototype.outputDefined=function(){return this.result.outputDefined()},ja.prototype.serialize=function(){for(var e=["let"],t=0,i=this.bindings;t<i.length;t+=1){var l=i[t];e.push(l[0],l[1].serialize())}return e.push(this.result.serialize()),e};var ho=function(e,t,i){this.type=e,this.index=t,this.input=i};ho.parse=function(e,t){if(e.length!==3)return t.error("Expected 2 arguments, but found "+(e.length-1)+" instead.");var i=t.parse(e[1],1,Te),l=t.parse(e[2],2,fr(t.expectedType||nt));return i&&l?new ho(l.type.itemType,i,l):null},ho.prototype.evaluate=function(e){var t=this.index.evaluate(e),i=this.input.evaluate(e);if(t<0)throw new li("Array index out of bounds: "+t+" < 0.");if(t>=i.length)throw new li("Array index out of bounds: "+t+" > "+(i.length-1)+".");if(t!==Math.floor(t))throw new li("Array index must be an integer, but found "+t+" instead.");return i[t]},ho.prototype.eachChild=function(e){e(this.index),e(this.input)},ho.prototype.outputDefined=function(){return!1},ho.prototype.serialize=function(){return["at",this.index.serialize(),this.input.serialize()]};var po=function(e,t){this.type=Qe,this.needle=e,this.haystack=t};po.parse=function(e,t){if(e.length!==3)return t.error("Expected 2 arguments, but found "+(e.length-1)+" instead.");var i=t.parse(e[1],1,nt),l=t.parse(e[2],2,nt);return i&&l?Or(i.type,[Qe,He,Te,at,nt])?new po(i,l):t.error("Expected first argument to be of type boolean, string, number or null, but found "+rr(i.type)+" instead"):null},po.prototype.evaluate=function(e){var t=this.needle.evaluate(e),i=this.haystack.evaluate(e);if(!i)return!1;if(!br(t,["boolean","string","number","null"]))throw new li("Expected first argument to be of type boolean, string, number or null, but found "+rr(jr(t))+" instead.");if(!br(i,["string","array"]))throw new li("Expected second argument to be of type array or string, but found "+rr(jr(i))+" instead.");return i.indexOf(t)>=0},po.prototype.eachChild=function(e){e(this.needle),e(this.haystack)},po.prototype.outputDefined=function(){return!0},po.prototype.serialize=function(){return["in",this.needle.serialize(),this.haystack.serialize()]};var Ga=function(e,t,i){this.type=Te,this.needle=e,this.haystack=t,this.fromIndex=i};Ga.parse=function(e,t){if(e.length<=2||e.length>=5)return t.error("Expected 3 or 4 arguments, but found "+(e.length-1)+" instead.");var i=t.parse(e[1],1,nt),l=t.parse(e[2],2,nt);if(!i||!l)return null;if(!Or(i.type,[Qe,He,Te,at,nt]))return t.error("Expected first argument to be of type boolean, string, number or null, but found "+rr(i.type)+" instead");if(e.length===4){var f=t.parse(e[3],3,Te);return f?new Ga(i,l,f):null}return new Ga(i,l)},Ga.prototype.evaluate=function(e){var t=this.needle.evaluate(e),i=this.haystack.evaluate(e);if(!br(t,["boolean","string","number","null"]))throw new li("Expected first argument to be of type boolean, string, number or null, but found "+rr(jr(t))+" instead.");if(!br(i,["string","array"]))throw new li("Expected second argument to be of type array or string, but found "+rr(jr(i))+" instead.");if(this.fromIndex){var l=this.fromIndex.evaluate(e);return i.indexOf(t,l)}return i.indexOf(t)},Ga.prototype.eachChild=function(e){e(this.needle),e(this.haystack),this.fromIndex&&e(this.fromIndex)},Ga.prototype.outputDefined=function(){return!1},Ga.prototype.serialize=function(){if(this.fromIndex!=null&&this.fromIndex!==void 0){var e=this.fromIndex.serialize();return["index-of",this.needle.serialize(),this.haystack.serialize(),e]}return["index-of",this.needle.serialize(),this.haystack.serialize()]};var fo=function(e,t,i,l,f,m){this.inputType=e,this.type=t,this.input=i,this.cases=l,this.outputs=f,this.otherwise=m};fo.parse=function(e,t){if(e.length<5)return t.error("Expected at least 4 arguments, but found only "+(e.length-1)+".");if(e.length%2!=1)return t.error("Expected an even number of arguments.");var i,l;t.expectedType&&t.expectedType.kind!=="value"&&(l=t.expectedType);for(var f={},m=[],x=2;x<e.length-1;x+=2){var k=e[x],A=e[x+1];Array.isArray(k)||(k=[k]);var z=t.concat(x);if(k.length===0)return z.error("Expected at least one branch label.");for(var C=0,B=k;C<B.length;C+=1){var V=B[C];if(typeof V!="number"&&typeof V!="string")return z.error("Branch labels must be numbers or strings.");if(typeof V=="number"&&Math.abs(V)>Number.MAX_SAFE_INTEGER)return z.error("Branch labels must be integers no larger than "+Number.MAX_SAFE_INTEGER+".");if(typeof V=="number"&&Math.floor(V)!==V)return z.error("Numeric branch labels must be integer values.");if(i){if(z.checkSubtype(i,jr(V)))return null}else i=jr(V);if(f[String(V)]!==void 0)return z.error("Branch labels must be unique.");f[String(V)]=m.length}var j=t.parse(A,x,l);if(!j)return null;l=l||j.type,m.push(j)}var J=t.parse(e[1],1,nt);if(!J)return null;var $=t.parse(e[e.length-1],e.length-1,l);return $?J.type.kind!=="value"&&t.concat(1).checkSubtype(i,J.type)?null:new fo(i,l,J,f,m,$):null},fo.prototype.evaluate=function(e){var t=this.input.evaluate(e);return(jr(t)===this.inputType&&this.outputs[this.cases[t]]||this.otherwise).evaluate(e)},fo.prototype.eachChild=function(e){e(this.input),this.outputs.forEach(e),e(this.otherwise)},fo.prototype.outputDefined=function(){return this.outputs.every(function(e){return e.outputDefined()})&&this.otherwise.outputDefined()},fo.prototype.serialize=function(){for(var e=this,t=["match",this.input.serialize()],i=[],l={},f=0,m=Object.keys(this.cases).sort();f<m.length;f+=1){var x=m[f];(B=l[this.cases[x]])===void 0?(l[this.cases[x]]=i.length,i.push([this.cases[x],[x]])):i[B][1].push(x)}for(var k=function(j){return e.inputType.kind==="number"?Number(j):j},A=0,z=i;A<z.length;A+=1){var C=z[A],B=C[0],V=C[1];t.push(V.length===1?k(V[0]):V.map(k)),t.push(this.outputs[outputIndex$1].serialize())}return t.push(this.otherwise.serialize()),t};var mo=function(e,t,i){this.type=e,this.branches=t,this.otherwise=i};mo.parse=function(e,t){if(e.length<4)return t.error("Expected at least 3 arguments, but found only "+(e.length-1)+".");if(e.length%2!=0)return t.error("Expected an odd number of arguments.");var i;t.expectedType&&t.expectedType.kind!=="value"&&(i=t.expectedType);for(var l=[],f=1;f<e.length-1;f+=2){var m=t.parse(e[f],f,Qe);if(!m)return null;var x=t.parse(e[f+1],f+1,i);if(!x)return null;l.push([m,x]),i=i||x.type}var k=t.parse(e[e.length-1],e.length-1,i);return k?new mo(i,l,k):null},mo.prototype.evaluate=function(e){for(var t=0,i=this.branches;t<i.length;t+=1){var l=i[t],f=l[1];if(l[0].evaluate(e))return f.evaluate(e)}return this.otherwise.evaluate(e)},mo.prototype.eachChild=function(e){for(var t=0,i=this.branches;t<i.length;t+=1){var l=i[t],f=l[1];e(l[0]),e(f)}e(this.otherwise)},mo.prototype.outputDefined=function(){return this.branches.every(function(e){return e[1].outputDefined()})&&this.otherwise.outputDefined()},mo.prototype.serialize=function(){var e=["case"];return this.eachChild(function(t){e.push(t.serialize())}),e};var Za=function(e,t,i,l){this.type=e,this.input=t,this.beginIndex=i,this.endIndex=l};function nc(e,t){return e==="=="||e==="!="?t.kind==="boolean"||t.kind==="string"||t.kind==="number"||t.kind==="null"||t.kind==="value":t.kind==="string"||t.kind==="number"||t.kind==="value"}function ac(e,t,i,l){return l.compare(t,i)===0}function Rr(e,t,i){var l=e!=="=="&&e!=="!=";return function(){function f(m,x,k){this.type=Qe,this.lhs=m,this.rhs=x,this.collator=k,this.hasUntypedArgument=m.type.kind==="value"||x.type.kind==="value"}return f.parse=function(m,x){if(m.length!==3&&m.length!==4)return x.error("Expected two or three arguments.");var k=m[0],A=x.parse(m[1],1,nt);if(!A)return null;if(!nc(k,A.type))return x.concat(1).error('"'+k+`" comparisons are not supported for type '`+rr(A.type)+"'.");var z=x.parse(m[2],2,nt);if(!z)return null;if(!nc(k,z.type))return x.concat(2).error('"'+k+`" comparisons are not supported for type '`+rr(z.type)+"'.");if(A.type.kind!==z.type.kind&&A.type.kind!=="value"&&z.type.kind!=="value")return x.error("Cannot compare types '"+rr(A.type)+"' and '"+rr(z.type)+"'.");l&&(A.type.kind==="value"&&z.type.kind!=="value"?A=new Pr(z.type,[A]):A.type.kind!=="value"&&z.type.kind==="value"&&(z=new Pr(A.type,[z])));var C=null;if(m.length===4){if(A.type.kind!=="string"&&z.type.kind!=="string"&&A.type.kind!=="value"&&z.type.kind!=="value")return x.error("Cannot use collator to compare non-string types.");if(!(C=x.parse(m[3],3,tr)))return null}return new f(A,z,C)},f.prototype.evaluate=function(m){var x=this.lhs.evaluate(m),k=this.rhs.evaluate(m);if(l&&this.hasUntypedArgument){var A=jr(x),z=jr(k);if(A.kind!==z.kind||A.kind!=="string"&&A.kind!=="number")throw new li('Expected arguments for "'+e+'" to be (string, string) or (number, number), but found ('+A.kind+", "+z.kind+") instead.")}if(this.collator&&!l&&this.hasUntypedArgument){var C=jr(x),B=jr(k);if(C.kind!=="string"||B.kind!=="string")return t(m,x,k)}return this.collator?i(m,x,k,this.collator.evaluate(m)):t(m,x,k)},f.prototype.eachChild=function(m){m(this.lhs),m(this.rhs),this.collator&&m(this.collator)},f.prototype.outputDefined=function(){return!0},f.prototype.serialize=function(){var m=[e];return this.eachChild(function(x){m.push(x.serialize())}),m},f}()}Za.parse=function(e,t){if(e.length<=2||e.length>=5)return t.error("Expected 3 or 4 arguments, but found "+(e.length-1)+" instead.");var i=t.parse(e[1],1,nt),l=t.parse(e[2],2,Te);if(!i||!l)return null;if(!Or(i.type,[fr(nt),He,nt]))return t.error("Expected first argument to be of type array or string, but found "+rr(i.type)+" instead");if(e.length===4){var f=t.parse(e[3],3,Te);return f?new Za(i.type,i,l,f):null}return new Za(i.type,i,l)},Za.prototype.evaluate=function(e){var t=this.input.evaluate(e),i=this.beginIndex.evaluate(e);if(!br(t,["string","array"]))throw new li("Expected first argument to be of type array or string, but found "+rr(jr(t))+" instead.");if(this.endIndex){var l=this.endIndex.evaluate(e);return t.slice(i,l)}return t.slice(i)},Za.prototype.eachChild=function(e){e(this.input),e(this.beginIndex),this.endIndex&&e(this.endIndex)},Za.prototype.outputDefined=function(){return!1},Za.prototype.serialize=function(){if(this.endIndex!=null&&this.endIndex!==void 0){var e=this.endIndex.serialize();return["slice",this.input.serialize(),this.beginIndex.serialize(),e]}return["slice",this.input.serialize(),this.beginIndex.serialize()]};var Uh=Rr("==",function(e,t,i){return t===i},ac),Fs=Rr("!=",function(e,t,i){return t!==i},function(e,t,i,l){return!ac(0,t,i,l)}),oc=Rr("<",function(e,t,i){return t<i},function(e,t,i,l){return l.compare(t,i)<0}),sc=Rr(">",function(e,t,i){return t>i},function(e,t,i,l){return l.compare(t,i)>0}),lc=Rr("<=",function(e,t,i){return t<=i},function(e,t,i,l){return l.compare(t,i)<=0}),uc=Rr(">=",function(e,t,i){return t>=i},function(e,t,i,l){return l.compare(t,i)>=0}),yo=function(e,t,i,l,f){this.type=He,this.number=e,this.locale=t,this.currency=i,this.minFractionDigits=l,this.maxFractionDigits=f};yo.parse=function(e,t){if(e.length!==3)return t.error("Expected two arguments.");var i=t.parse(e[1],1,Te);if(!i)return null;var l=e[2];if(typeof l!="object"||Array.isArray(l))return t.error("NumberFormat options argument must be an object.");var f=null;if(l.locale&&!(f=t.parse(l.locale,1,He)))return null;var m=null;if(l.currency&&!(m=t.parse(l.currency,1,He)))return null;var x=null;if(l["min-fraction-digits"]&&!(x=t.parse(l["min-fraction-digits"],1,Te)))return null;var k=null;return l["max-fraction-digits"]&&!(k=t.parse(l["max-fraction-digits"],1,Te))?null:new yo(i,f,m,x,k)},yo.prototype.evaluate=function(e){return new Intl.NumberFormat(this.locale?this.locale.evaluate(e):[],{style:this.currency?"currency":"decimal",currency:this.currency?this.currency.evaluate(e):void 0,minimumFractionDigits:this.minFractionDigits?this.minFractionDigits.evaluate(e):void 0,maximumFractionDigits:this.maxFractionDigits?this.maxFractionDigits.evaluate(e):void 0}).format(this.number.evaluate(e))},yo.prototype.eachChild=function(e){e(this.number),this.locale&&e(this.locale),this.currency&&e(this.currency),this.minFractionDigits&&e(this.minFractionDigits),this.maxFractionDigits&&e(this.maxFractionDigits)},yo.prototype.outputDefined=function(){return!1},yo.prototype.serialize=function(){var e={};return this.locale&&(e.locale=this.locale.serialize()),this.currency&&(e.currency=this.currency.serialize()),this.minFractionDigits&&(e["min-fraction-digits"]=this.minFractionDigits.serialize()),this.maxFractionDigits&&(e["max-fraction-digits"]=this.maxFractionDigits.serialize()),["number-format",this.number.serialize(),e]};var Ka=function(e){this.type=Te,this.input=e};Ka.parse=function(e,t){if(e.length!==2)return t.error("Expected 1 argument, but found "+(e.length-1)+" instead.");var i=t.parse(e[1],1);return i?i.type.kind!=="array"&&i.type.kind!=="string"&&i.type.kind!=="value"?t.error("Expected argument of type string or array, but found "+rr(i.type)+" instead."):new Ka(i):null},Ka.prototype.evaluate=function(e){var t=this.input.evaluate(e);if(typeof t=="string"||Array.isArray(t))return t.length;throw new li("Expected value to be of type string or array, but found "+rr(jr(t))+" instead.")},Ka.prototype.eachChild=function(e){e(this.input)},Ka.prototype.outputDefined=function(){return!1},Ka.prototype.serialize=function(){var e=["length"];return this.eachChild(function(t){e.push(t.serialize())}),e};var go={"==":Uh,"!=":Fs,">":sc,"<":oc,">=":uc,"<=":lc,array:Pr,at:ho,boolean:Pr,case:mo,coalesce:qa,collator:Yn,format:Rn,image:_n,in:po,"index-of":Ga,interpolate:an,"interpolate-hcl":an,"interpolate-lab":an,length:Ka,let:ja,literal:Ai,match:fo,number:Pr,"number-format":yo,object:Pr,slice:Za,step:On,string:Pr,"to-boolean":zi,"to-color":zi,"to-number":zi,"to-string":zi,var:Hi,within:Bn};function cc(e,t){var i=t[0],l=t[1],f=t[2],m=t[3];i=i.evaluate(e),l=l.evaluate(e),f=f.evaluate(e);var x=m?m.evaluate(e):1,k=Na(i,l,f,x);if(k)throw new li(k);return new dr(i/255*x,l/255*x,f/255*x,x)}function hc(e,t){return e in t}function Gl(e,t){var i=t[e];return i===void 0?null:i}function _o(e){return{type:e}}function pc(e){return{result:"success",value:e}}function vo(e){return{result:"error",value:e}}function bo(e){return e["property-type"]==="data-driven"||e["property-type"]==="cross-faded-data-driven"}function fc(e){return!!e.expression&&e.expression.parameters.indexOf("zoom")>-1}function ls(e){return!!e.expression&&e.expression.interpolated}function Fr(e){return e instanceof Number?"number":e instanceof String?"string":e instanceof Boolean?"boolean":Array.isArray(e)?"array":e===null?"null":typeof e}function Ns(e){return typeof e=="object"&&e!==null&&!Array.isArray(e)}function qh(e){return e}function Fo(e,t,i){return e!==void 0?e:t!==void 0?t:i!==void 0?i:void 0}function dc(e,t,i,l,f){return Fo(typeof i===f?l[i]:void 0,e.default,t.default)}function jh(e,t,i){if(Fr(i)!=="number")return Fo(e.default,t.default);var l=e.stops.length;if(l===1||i<=e.stops[0][0])return e.stops[0][1];if(i>=e.stops[l-1][0])return e.stops[l-1][1];var f=ka(e.stops.map(function(m){return m[0]}),i);return e.stops[f][1]}function mc(e,t,i){var l=e.base!==void 0?e.base:1;if(Fr(i)!=="number")return Fo(e.default,t.default);var f=e.stops.length;if(f===1||i<=e.stops[0][0])return e.stops[0][1];if(i>=e.stops[f-1][0])return e.stops[f-1][1];var m=ka(e.stops.map(function(B){return B[0]}),i),x=function(B,V,j,J){var $=J-j,he=B-j;return $===0?0:V===1?he/$:(Math.pow(V,he)-1)/(Math.pow(V,$)-1)}(i,l,e.stops[m][0],e.stops[m+1][0]),k=e.stops[m][1],A=e.stops[m+1][1],z=Oo[t.type]||qh;if(e.colorSpace&&e.colorSpace!=="rgb"){var C=ic[e.colorSpace];z=function(B,V){return C.reverse(C.interpolate(C.forward(B),C.forward(V),x))}}return typeof k.evaluate=="function"?{evaluate:function(){for(var B=[],V=arguments.length;V--;)B[V]=arguments[V];var j=k.evaluate.apply(void 0,B),J=A.evaluate.apply(void 0,B);if(j!==void 0&&J!==void 0)return z(j,J,x)}}:z(k,A,x)}function Vs(e,t,i){return t.type==="color"?i=dr.parse(i):t.type==="formatted"?i=si.fromString(i.toString()):t.type==="resolvedImage"?i=Oi.fromString(i.toString()):Fr(i)===t.type||t.type==="enum"&&t.values[i]||(i=void 0),Fo(i,e.default,t.default)}Pi.register(go,{error:[{kind:"error"},[He],function(e,t){throw new li(t[0].evaluate(e))}],typeof:[He,[nt],function(e,t){return rr(jr(t[0].evaluate(e)))}],"to-rgba":[fr(Te,4),[rt],function(e,t){return t[0].evaluate(e).toArray()}],rgb:[rt,[Te,Te,Te],cc],rgba:[rt,[Te,Te,Te,Te],cc],has:{type:Qe,overloads:[[[He],function(e,t){return hc(t[0].evaluate(e),e.properties())}],[[He,jt],function(e,t){var i=t[1];return hc(t[0].evaluate(e),i.evaluate(e))}]]},get:{type:nt,overloads:[[[He],function(e,t){return Gl(t[0].evaluate(e),e.properties())}],[[He,jt],function(e,t){var i=t[1];return Gl(t[0].evaluate(e),i.evaluate(e))}]]},"feature-state":[nt,[He],function(e,t){return Gl(t[0].evaluate(e),e.featureState||{})}],properties:[jt,[],function(e){return e.properties()}],"geometry-type":[He,[],function(e){return e.geometryType()}],id:[nt,[],function(e){return e.id()}],zoom:[Te,[],function(e){return e.globals.zoom}],"heatmap-density":[Te,[],function(e){return e.globals.heatmapDensity||0}],"line-progress":[Te,[],function(e){return e.globals.lineProgress||0}],accumulated:[nt,[],function(e){return e.globals.accumulated===void 0?null:e.globals.accumulated}],"+":[Te,_o(Te),function(e,t){for(var i=0,l=0,f=t;l<f.length;l+=1)i+=f[l].evaluate(e);return i}],"*":[Te,_o(Te),function(e,t){for(var i=1,l=0,f=t;l<f.length;l+=1)i*=f[l].evaluate(e);return i}],"-":{type:Te,overloads:[[[Te,Te],function(e,t){var i=t[1];return t[0].evaluate(e)-i.evaluate(e)}],[[Te],function(e,t){return-t[0].evaluate(e)}]]},"/":[Te,[Te,Te],function(e,t){var i=t[1];return t[0].evaluate(e)/i.evaluate(e)}],"%":[Te,[Te,Te],function(e,t){var i=t[1];return t[0].evaluate(e)%i.evaluate(e)}],ln2:[Te,[],function(){return Math.LN2}],pi:[Te,[],function(){return Math.PI}],e:[Te,[],function(){return Math.E}],"^":[Te,[Te,Te],function(e,t){var i=t[1];return Math.pow(t[0].evaluate(e),i.evaluate(e))}],sqrt:[Te,[Te],function(e,t){return Math.sqrt(t[0].evaluate(e))}],log10:[Te,[Te],function(e,t){return Math.log(t[0].evaluate(e))/Math.LN10}],ln:[Te,[Te],function(e,t){return Math.log(t[0].evaluate(e))}],log2:[Te,[Te],function(e,t){return Math.log(t[0].evaluate(e))/Math.LN2}],sin:[Te,[Te],function(e,t){return Math.sin(t[0].evaluate(e))}],cos:[Te,[Te],function(e,t){return Math.cos(t[0].evaluate(e))}],tan:[Te,[Te],function(e,t){return Math.tan(t[0].evaluate(e))}],asin:[Te,[Te],function(e,t){return Math.asin(t[0].evaluate(e))}],acos:[Te,[Te],function(e,t){return Math.acos(t[0].evaluate(e))}],atan:[Te,[Te],function(e,t){return Math.atan(t[0].evaluate(e))}],min:[Te,_o(Te),function(e,t){return Math.min.apply(Math,t.map(function(i){return i.evaluate(e)}))}],max:[Te,_o(Te),function(e,t){return Math.max.apply(Math,t.map(function(i){return i.evaluate(e)}))}],abs:[Te,[Te],function(e,t){return Math.abs(t[0].evaluate(e))}],round:[Te,[Te],function(e,t){var i=t[0].evaluate(e);return i<0?-Math.round(-i):Math.round(i)}],floor:[Te,[Te],function(e,t){return Math.floor(t[0].evaluate(e))}],ceil:[Te,[Te],function(e,t){return Math.ceil(t[0].evaluate(e))}],"filter-==":[Qe,[He,nt],function(e,t){var i=t[0],l=t[1];return e.properties()[i.value]===l.value}],"filter-id-==":[Qe,[nt],function(e,t){var i=t[0];return e.id()===i.value}],"filter-type-==":[Qe,[He],function(e,t){var i=t[0];return e.geometryType()===i.value}],"filter-<":[Qe,[He,nt],function(e,t){var i=t[0],l=t[1],f=e.properties()[i.value],m=l.value;return typeof f==typeof m&&f<m}],"filter-id-<":[Qe,[nt],function(e,t){var i=t[0],l=e.id(),f=i.value;return typeof l==typeof f&&l<f}],"filter->":[Qe,[He,nt],function(e,t){var i=t[0],l=t[1],f=e.properties()[i.value],m=l.value;return typeof f==typeof m&&f>m}],"filter-id->":[Qe,[nt],function(e,t){var i=t[0],l=e.id(),f=i.value;return typeof l==typeof f&&l>f}],"filter-<=":[Qe,[He,nt],function(e,t){var i=t[0],l=t[1],f=e.properties()[i.value],m=l.value;return typeof f==typeof m&&f<=m}],"filter-id-<=":[Qe,[nt],function(e,t){var i=t[0],l=e.id(),f=i.value;return typeof l==typeof f&&l<=f}],"filter->=":[Qe,[He,nt],function(e,t){var i=t[0],l=t[1],f=e.properties()[i.value],m=l.value;return typeof f==typeof m&&f>=m}],"filter-id->=":[Qe,[nt],function(e,t){var i=t[0],l=e.id(),f=i.value;return typeof l==typeof f&&l>=f}],"filter-has":[Qe,[nt],function(e,t){return t[0].value in e.properties()}],"filter-has-id":[Qe,[],function(e){return e.id()!==null&&e.id()!==void 0}],"filter-type-in":[Qe,[fr(He)],function(e,t){return t[0].value.indexOf(e.geometryType())>=0}],"filter-id-in":[Qe,[fr(nt)],function(e,t){return t[0].value.indexOf(e.id())>=0}],"filter-in-small":[Qe,[He,fr(nt)],function(e,t){var i=t[0];return t[1].value.indexOf(e.properties()[i.value])>=0}],"filter-in-large":[Qe,[He,fr(nt)],function(e,t){var i=t[0],l=t[1];return function(f,m,x,k){for(;x<=k;){var A=x+k>>1;if(m[A]===f)return!0;m[A]>f?k=A-1:x=A+1}return!1}(e.properties()[i.value],l.value,0,l.value.length-1)}],all:{type:Qe,overloads:[[[Qe,Qe],function(e,t){var i=t[1];return t[0].evaluate(e)&&i.evaluate(e)}],[_o(Qe),function(e,t){for(var i=0,l=t;i<l.length;i+=1)if(!l[i].evaluate(e))return!1;return!0}]]},any:{type:Qe,overloads:[[[Qe,Qe],function(e,t){var i=t[1];return t[0].evaluate(e)||i.evaluate(e)}],[_o(Qe),function(e,t){for(var i=0,l=t;i<l.length;i+=1)if(l[i].evaluate(e))return!0;return!1}]]},"!":[Qe,[Qe],function(e,t){return!t[0].evaluate(e)}],"is-supported-script":[Qe,[He],function(e,t){var i=e.globals&&e.globals.isSupportedScript;return!i||i(t[0].evaluate(e))}],upcase:[He,[He],function(e,t){return t[0].evaluate(e).toUpperCase()}],downcase:[He,[He],function(e,t){return t[0].evaluate(e).toLowerCase()}],concat:[He,_o(nt),function(e,t){return t.map(function(i){return ba(i.evaluate(e))}).join("")}],"resolved-locale":[He,[tr],function(e,t){return t[0].evaluate(e).resolvedLocale()}]});var No=function(e,t){this.expression=e,this._warningHistory={},this._evaluator=new Zi,this._defaultValue=t?function(i){return i.type==="color"&&Ns(i.default)?new dr(0,0,0,0):i.type==="color"?dr.parse(i.default)||null:i.default===void 0?null:i.default}(t):null,this._enumValues=t&&t.type==="enum"?t.values:null};function us(e){return Array.isArray(e)&&e.length>0&&typeof e[0]=="string"&&e[0]in go}function Us(e,t){var i=new Gr(go,[],t?function(f){var m={color:rt,string:He,number:Te,enum:He,boolean:Qe,formatted:wr,resolvedImage:Ht};return f.type==="array"?fr(m[f.value]||nt,f.length):m[f.type]}(t):void 0),l=i.parse(e,void 0,void 0,void 0,t&&t.type==="string"?{typeAnnotation:"coerce"}:void 0);return l?pc(new No(l,t)):vo(i.errors)}No.prototype.evaluateWithoutErrorHandling=function(e,t,i,l,f,m){return this._evaluator.globals=e,this._evaluator.feature=t,this._evaluator.featureState=i,this._evaluator.canonical=l,this._evaluator.availableImages=f||null,this._evaluator.formattedSection=m,this.expression.evaluate(this._evaluator)},No.prototype.evaluate=function(e,t,i,l,f,m){this._evaluator.globals=e,this._evaluator.feature=t||null,this._evaluator.featureState=i||null,this._evaluator.canonical=l,this._evaluator.availableImages=f||null,this._evaluator.formattedSection=m||null;try{var x=this.expression.evaluate(this._evaluator);if(x==null||typeof x=="number"&&x!=x)return this._defaultValue;if(this._enumValues&&!(x in this._enumValues))throw new li("Expected value to be one of "+Object.keys(this._enumValues).map(function(k){return JSON.stringify(k)}).join(", ")+", but found "+JSON.stringify(x)+" instead.");return x}catch(k){return this._warningHistory[k.message]||(this._warningHistory[k.message]=!0,typeof console<"u"&&console.warn(k.message)),this._defaultValue}};var cs=function(e,t){this.kind=e,this._styleExpression=t,this.isStateDependent=e!=="constant"&&!ye(t.expression)};cs.prototype.evaluateWithoutErrorHandling=function(e,t,i,l,f,m){return this._styleExpression.evaluateWithoutErrorHandling(e,t,i,l,f,m)},cs.prototype.evaluate=function(e,t,i,l,f,m){return this._styleExpression.evaluate(e,t,i,l,f,m)};var Vo=function(e,t,i,l){this.kind=e,this.zoomStops=i,this._styleExpression=t,this.isStateDependent=e!=="camera"&&!ye(t.expression),this.interpolationType=l};function yc(e,t){if((e=Us(e,t)).result==="error")return e;var i=e.value.expression,l=Sa(i);if(!l&&!bo(t))return vo([new Re("","data expressions not supported")]);var f=hn(i,["zoom"]);if(!f&&!fc(t))return vo([new Re("","zoom expressions not supported")]);var m=function x(k){var A=null;if(k instanceof ja)A=x(k.result);else if(k instanceof qa)for(var z=0,C=k.args;z<C.length&&!(A=x(C[z]));z+=1);else(k instanceof On||k instanceof an)&&k.input instanceof Pi&&k.input.name==="zoom"&&(A=k);return A instanceof Re||k.eachChild(function(B){var V=x(B);V instanceof Re?A=V:!A&&V?A=new Re("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.'):A&&V&&A!==V&&(A=new Re("",'Only one zoom-based "step" or "interpolate" subexpression may be used in an expression.'))}),A}(i);return m||f?m instanceof Re?vo([m]):m instanceof an&&!ls(t)?vo([new Re("",'"interpolate" expressions cannot be used with this property')]):pc(m?new Vo(l?"camera":"composite",e.value,m.labels,m instanceof an?m.interpolation:void 0):new cs(l?"constant":"source",e.value)):vo([new Re("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.')])}Vo.prototype.evaluateWithoutErrorHandling=function(e,t,i,l,f,m){return this._styleExpression.evaluateWithoutErrorHandling(e,t,i,l,f,m)},Vo.prototype.evaluate=function(e,t,i,l,f,m){return this._styleExpression.evaluate(e,t,i,l,f,m)},Vo.prototype.interpolationFactor=function(e,t,i){return this.interpolationType?an.interpolationFactor(this.interpolationType,e,t,i):0};var Uo=function(e,t){this._parameters=e,this._specification=t,Ce(this,function i(l,f){var m,x,k,A=f.type==="color",z=l.stops&&typeof l.stops[0][0]=="object",C=z||!(z||l.property!==void 0),B=l.type||(ls(f)?"exponential":"interval");if(A&&((l=Ce({},l)).stops&&(l.stops=l.stops.map(function(st){return[st[0],dr.parse(st[1])]})),l.default=dr.parse(l.default?l.default:f.default)),l.colorSpace&&l.colorSpace!=="rgb"&&!ic[l.colorSpace])throw new Error("Unknown color space: "+l.colorSpace);if(B==="exponential")m=mc;else if(B==="interval")m=jh;else if(B==="categorical"){m=dc,x=Object.create(null);for(var V=0,j=l.stops;V<j.length;V+=1){var J=j[V];x[J[0]]=J[1]}k=typeof l.stops[0][0]}else{if(B!=="identity")throw new Error('Unknown function type "'+B+'"');m=Vs}if(z){for(var $={},he=[],ie=0;ie<l.stops.length;ie++){var me=l.stops[ie],ve=me[0].zoom;$[ve]===void 0&&($[ve]={zoom:ve,type:l.type,property:l.property,default:l.default,stops:[]},he.push(ve)),$[ve].stops.push([me[0].value,me[1]])}for(var we=[],ke=0,Pe=he;ke<Pe.length;ke+=1){var qe=Pe[ke];we.push([$[qe].zoom,i($[qe],f)])}var et={name:"linear"};return{kind:"composite",interpolationType:et,interpolationFactor:an.interpolationFactor.bind(void 0,et),zoomStops:we.map(function(st){return st[0]}),evaluate:function(st,Tt){var lt=st.zoom;return mc({stops:we,base:l.base},f,lt).evaluate(lt,Tt)}}}if(C){var wt=B==="exponential"?{name:"exponential",base:l.base!==void 0?l.base:1}:null;return{kind:"camera",interpolationType:wt,interpolationFactor:an.interpolationFactor.bind(void 0,wt),zoomStops:l.stops.map(function(st){return st[0]}),evaluate:function(st){return m(l,f,st.zoom,x,k)}}}return{kind:"source",evaluate:function(st,Tt){var lt=Tt&&Tt.properties?Tt.properties[l.property]:void 0;return lt===void 0?Fo(l.default,f.default):m(l,f,lt,x,k)}}}(this._parameters,this._specification))};function fa(e){var t=e.key,i=e.value,l=e.valueSpec||{},f=e.objectElementValidators||{},m=e.style,x=e.styleSpec,k=[],A=Fr(i);if(A!=="object")return[new Q(t,i,"object expected, "+A+" found")];for(var z in i){var C=z.split(".")[0],B=l[C]||l["*"],V=void 0;if(f[C])V=f[C];else if(l[C])V=mr;else if(f["*"])V=f["*"];else{if(!l["*"]){k.push(new Q(t,i[z],'unknown property "'+z+'"'));continue}V=mr}k=k.concat(V({key:(t&&t+".")+z,value:i[z],valueSpec:B,style:m,styleSpec:x,object:i,objectKey:z},i))}for(var j in l)f[j]||l[j].required&&l[j].default===void 0&&i[j]===void 0&&k.push(new Q(t,i,'missing required property "'+j+'"'));return k}function gc(e){var t=e.value,i=e.valueSpec,l=e.style,f=e.styleSpec,m=e.key,x=e.arrayElementValidator||mr;if(Fr(t)!=="array")return[new Q(m,t,"array expected, "+Fr(t)+" found")];if(i.length&&t.length!==i.length)return[new Q(m,t,"array length "+i.length+" expected, length "+t.length+" found")];if(i["min-length"]&&t.length<i["min-length"])return[new Q(m,t,"array length at least "+i["min-length"]+" expected, length "+t.length+" found")];var k={type:i.value,values:i.values};f.$version<7&&(k.function=i.function),Fr(i.value)==="object"&&(k=i.value);for(var A=[],z=0;z<t.length;z++)A=A.concat(x({array:t,arrayIndex:z,value:t[z],valueSpec:k,style:l,styleSpec:f,key:m+"["+z+"]"}));return A}function _c(e){var t=e.key,i=e.value,l=e.valueSpec,f=Fr(i);return f==="number"&&i!=i&&(f="NaN"),f!=="number"?[new Q(t,i,"number expected, "+f+" found")]:"minimum"in l&&i<l.minimum?[new Q(t,i,i+" is less than the minimum value "+l.minimum)]:"maximum"in l&&i>l.maximum?[new Q(t,i,i+" is greater than the maximum value "+l.maximum)]:[]}function vc(e){var t,i,l,f=e.valueSpec,m=Le(e.value.type),x={},k=m!=="categorical"&&e.value.property===void 0,A=!k,z=Fr(e.value.stops)==="array"&&Fr(e.value.stops[0])==="array"&&Fr(e.value.stops[0][0])==="object",C=fa({key:e.key,value:e.value,valueSpec:e.styleSpec.function,style:e.style,styleSpec:e.styleSpec,objectElementValidators:{stops:function(j){if(m==="identity")return[new Q(j.key,j.value,'identity function may not have a "stops" property')];var J=[],$=j.value;return J=J.concat(gc({key:j.key,value:$,valueSpec:j.valueSpec,style:j.style,styleSpec:j.styleSpec,arrayElementValidator:B})),Fr($)==="array"&&$.length===0&&J.push(new Q(j.key,$,"array must have at least one stop")),J},default:function(j){return mr({key:j.key,value:j.value,valueSpec:f,style:j.style,styleSpec:j.styleSpec})}}});return m==="identity"&&k&&C.push(new Q(e.key,e.value,'missing required property "property"')),m==="identity"||e.value.stops||C.push(new Q(e.key,e.value,'missing required property "stops"')),m==="exponential"&&e.valueSpec.expression&&!ls(e.valueSpec)&&C.push(new Q(e.key,e.value,"exponential functions not supported")),e.styleSpec.$version>=8&&(A&&!bo(e.valueSpec)?C.push(new Q(e.key,e.value,"property functions not supported")):k&&!fc(e.valueSpec)&&C.push(new Q(e.key,e.value,"zoom functions not supported"))),m!=="categorical"&&!z||e.value.property!==void 0||C.push(new Q(e.key,e.value,'"property" property is required')),C;function B(j){var J=[],$=j.value,he=j.key;if(Fr($)!=="array")return[new Q(he,$,"array expected, "+Fr($)+" found")];if($.length!==2)return[new Q(he,$,"array length 2 expected, length "+$.length+" found")];if(z){if(Fr($[0])!=="object")return[new Q(he,$,"object expected, "+Fr($[0])+" found")];if($[0].zoom===void 0)return[new Q(he,$,"object stop key must have zoom")];if($[0].value===void 0)return[new Q(he,$,"object stop key must have value")];if(l&&l>Le($[0].zoom))return[new Q(he,$[0].zoom,"stop zoom values must appear in ascending order")];Le($[0].zoom)!==l&&(l=Le($[0].zoom),i=void 0,x={}),J=J.concat(fa({key:he+"[0]",value:$[0],valueSpec:{zoom:{}},style:j.style,styleSpec:j.styleSpec,objectElementValidators:{zoom:_c,value:V}}))}else J=J.concat(V({key:he+"[0]",value:$[0],valueSpec:{},style:j.style,styleSpec:j.styleSpec},$));return us(Ee($[1]))?J.concat([new Q(he+"[1]",$[1],"expressions are not allowed in function stops.")]):J.concat(mr({key:he+"[1]",value:$[1],valueSpec:f,style:j.style,styleSpec:j.styleSpec}))}function V(j,J){var $=Fr(j.value),he=Le(j.value),ie=j.value!==null?j.value:J;if(t){if($!==t)return[new Q(j.key,ie,$+" stop domain type must match previous stop domain type "+t)]}else t=$;if($!=="number"&&$!=="string"&&$!=="boolean")return[new Q(j.key,ie,"stop domain value must be a number, string, or boolean")];if($!=="number"&&m!=="categorical"){var me="number expected, "+$+" found";return bo(f)&&m===void 0&&(me+='\nIf you intended to use a categorical function, specify `"type": "categorical"`.'),[new Q(j.key,ie,me)]}return m!=="categorical"||$!=="number"||isFinite(he)&&Math.floor(he)===he?m!=="categorical"&&$==="number"&&i!==void 0&&he<i?[new Q(j.key,ie,"stop domain values must appear in ascending order")]:(i=he,m==="categorical"&&he in x?[new Q(j.key,ie,"stop domain values must be unique")]:(x[he]=!0,[])):[new Q(j.key,ie,"integer expected, found "+he)]}}function xo(e){var t=(e.expressionContext==="property"?yc:Us)(Ee(e.value),e.valueSpec);if(t.result==="error")return t.value.map(function(l){return new Q(""+e.key+l.key,e.value,l.message)});var i=t.value.expression||t.value._styleExpression.expression;if(e.expressionContext==="property"&&e.propertyKey==="text-font"&&!i.outputDefined())return[new Q(e.key,e.value,'Invalid data expression for "'+e.propertyKey+'". Output values must be contained as literals within the expression.')];if(e.expressionContext==="property"&&e.propertyType==="layout"&&!ye(i))return[new Q(e.key,e.value,'"feature-state" data expressions are not supported with layout properties.')];if(e.expressionContext==="filter"&&!ye(i))return[new Q(e.key,e.value,'"feature-state" data expressions are not supported with filters.')];if(e.expressionContext&&e.expressionContext.indexOf("cluster")===0){if(!hn(i,["zoom","feature-state"]))return[new Q(e.key,e.value,'"zoom" and "feature-state" expressions are not supported with cluster properties.')];if(e.expressionContext==="cluster-initial"&&!Sa(i))return[new Q(e.key,e.value,"Feature data expressions are not supported with initial expression part of cluster properties.")]}return[]}function hs(e){var t=e.key,i=e.value,l=e.valueSpec,f=[];return Array.isArray(l.values)?l.values.indexOf(Le(i))===-1&&f.push(new Q(t,i,"expected one of ["+l.values.join(", ")+"], "+JSON.stringify(i)+" found")):Object.keys(l.values).indexOf(Le(i))===-1&&f.push(new Q(t,i,"expected one of ["+Object.keys(l.values).join(", ")+"], "+JSON.stringify(i)+" found")),f}function qs(e){if(e===!0||e===!1)return!0;if(!Array.isArray(e)||e.length===0)return!1;switch(e[0]){case"has":return e.length>=2&&e[1]!=="$id"&&e[1]!=="$type";case"in":return e.length>=3&&(typeof e[1]!="string"||Array.isArray(e[2]));case"!in":case"!has":case"none":return!1;case"==":case"!=":case">":case">=":case"<":case"<=":return e.length!==3||Array.isArray(e[1])||Array.isArray(e[2]);case"any":case"all":for(var t=0,i=e.slice(1);t<i.length;t+=1){var l=i[t];if(!qs(l)&&typeof l!="boolean")return!1}return!0;default:return!0}}Uo.deserialize=function(e){return new Uo(e._parameters,e._specification)},Uo.serialize=function(e){return{_parameters:e._parameters,_specification:e._specification}};var Zl={type:"boolean",default:!1,transition:!1,"property-type":"data-driven",expression:{interpolated:!1,parameters:["zoom","feature"]}};function js(e){if(e==null)return{filter:function(){return!0},needGeometry:!1};qs(e)||(e=Gs(e));var t=Us(e,Zl);if(t.result==="error")throw new Error(t.value.map(function(i){return i.key+": "+i.message}).join(", "));return{filter:function(i,l,f){return t.value.evaluate(i,l,{},f)},needGeometry:function i(l){if(!Array.isArray(l))return!1;if(l[0]==="within")return!0;for(var f=1;f<l.length;f++)if(i(l[f]))return!0;return!1}(e)}}function Gh(e,t){return e<t?-1:e>t?1:0}function Gs(e){if(!e)return!0;var t,i=e[0];return e.length<=1?i!=="any":i==="=="?Kl(e[1],e[2],"=="):i==="!="?Zs(Kl(e[1],e[2],"==")):i==="<"||i===">"||i==="<="||i===">="?Kl(e[1],e[2],i):i==="any"?(t=e.slice(1),["any"].concat(t.map(Gs))):i==="all"?["all"].concat(e.slice(1).map(Gs)):i==="none"?["all"].concat(e.slice(1).map(Gs).map(Zs)):i==="in"?bc(e[1],e.slice(2)):i==="!in"?Zs(bc(e[1],e.slice(2))):i==="has"?xc(e[1]):i==="!has"?Zs(xc(e[1])):i!=="within"||e}function Kl(e,t,i){switch(e){case"$type":return["filter-type-"+i,t];case"$id":return["filter-id-"+i,t];default:return["filter-"+i,e,t]}}function bc(e,t){if(t.length===0)return!1;switch(e){case"$type":return["filter-type-in",["literal",t]];case"$id":return["filter-id-in",["literal",t]];default:return t.length>200&&!t.some(function(i){return typeof i!=typeof t[0]})?["filter-in-large",e,["literal",t.sort(Gh)]]:["filter-in-small",e,["literal",t]]}}function xc(e){switch(e){case"$type":return!0;case"$id":return["filter-has-id"];default:return["filter-has",e]}}function Zs(e){return["!",e]}function Hl(e){return qs(Ee(e.value))?xo(Ce({},e,{expressionContext:"filter",valueSpec:{value:"boolean"}})):function t(i){var l=i.value,f=i.key;if(Fr(l)!=="array")return[new Q(f,l,"array expected, "+Fr(l)+" found")];var m,x=i.styleSpec,k=[];if(l.length<1)return[new Q(f,l,"filter array must have at least 1 element")];switch(k=k.concat(hs({key:f+"[0]",value:l[0],valueSpec:x.filter_operator,style:i.style,styleSpec:i.styleSpec})),Le(l[0])){case"<":case"<=":case">":case">=":l.length>=2&&Le(l[1])==="$type"&&k.push(new Q(f,l,'"$type" cannot be use with operator "'+l[0]+'"'));case"==":case"!=":l.length!==3&&k.push(new Q(f,l,'filter array for operator "'+l[0]+'" must have 3 elements'));case"in":case"!in":l.length>=2&&(m=Fr(l[1]))!=="string"&&k.push(new Q(f+"[1]",l[1],"string expected, "+m+" found"));for(var A=2;A<l.length;A++)m=Fr(l[A]),Le(l[1])==="$type"?k=k.concat(hs({key:f+"["+A+"]",value:l[A],valueSpec:x.geometry_type,style:i.style,styleSpec:i.styleSpec})):m!=="string"&&m!=="number"&&m!=="boolean"&&k.push(new Q(f+"["+A+"]",l[A],"string, number, or boolean expected, "+m+" found"));break;case"any":case"all":case"none":for(var z=1;z<l.length;z++)k=k.concat(t({key:f+"["+z+"]",value:l[z],style:i.style,styleSpec:i.styleSpec}));break;case"has":case"!has":m=Fr(l[1]),l.length!==2?k.push(new Q(f,l,'filter array for "'+l[0]+'" operator must have 2 elements')):m!=="string"&&k.push(new Q(f+"[1]",l[1],"string expected, "+m+" found"));break;case"within":m=Fr(l[1]),l.length!==2?k.push(new Q(f,l,'filter array for "'+l[0]+'" operator must have 2 elements')):m!=="object"&&k.push(new Q(f+"[1]",l[1],"object expected, "+m+" found"))}return k}(e)}function Xl(e,t){var i=e.key,l=e.style,f=e.styleSpec,m=e.value,x=e.objectKey,k=f[t+"_"+e.layerType];if(!k)return[];var A=x.match(/^(.*)-transition$/);if(t==="paint"&&A&&k[A[1]]&&k[A[1]].transition)return mr({key:i,value:m,valueSpec:f.transition,style:l,styleSpec:f});var z,C=e.valueSpec||k[x];if(!C)return[new Q(i,m,'unknown property "'+x+'"')];if(Fr(m)==="string"&&bo(C)&&!C.tokens&&(z=/^{([^}]+)}$/.exec(m)))return[new Q(i,m,'"'+x+'" does not support interpolation syntax\nUse an identity property function instead: `{ "type": "identity", "property": '+JSON.stringify(z[1])+" }`.")];var B=[];return e.layerType==="symbol"&&(x==="text-field"&&l&&!l.glyphs&&B.push(new Q(i,m,'use of "text-field" requires a style "glyphs" property')),x==="text-font"&&Ns(Ee(m))&&Le(m.type)==="identity"&&B.push(new Q(i,m,'"text-font" does not support identity functions'))),B.concat(mr({key:e.key,value:m,valueSpec:C,style:l,styleSpec:f,expressionContext:"property",propertyType:t,propertyKey:x}))}function Wl(e){return Xl(e,"paint")}function ps(e){return Xl(e,"layout")}function wc(e){var t=[],i=e.value,l=e.key,f=e.style,m=e.styleSpec;i.type||i.ref||t.push(new Q(l,i,'either "type" or "ref" is required'));var x,k=Le(i.type),A=Le(i.ref);if(i.id)for(var z=Le(i.id),C=0;C<e.arrayIndex;C++){var B=f.layers[C];Le(B.id)===z&&t.push(new Q(l,i.id,'duplicate layer id "'+i.id+'", previously used at line '+B.id.__line__))}if("ref"in i)["type","source","source-layer","filter","layout"].forEach(function(J){J in i&&t.push(new Q(l,i[J],'"'+J+'" is prohibited for ref layers'))}),f.layers.forEach(function(J){Le(J.id)===A&&(x=J)}),x?x.ref?t.push(new Q(l,i.ref,"ref cannot reference another ref layer")):k=Le(x.type):t.push(new Q(l,i.ref,'ref layer "'+A+'" not found'));else if(k!=="background")if(i.source){var V=f.sources&&f.sources[i.source],j=V&&Le(V.type);V?j==="vector"&&k==="raster"?t.push(new Q(l,i.source,'layer "'+i.id+'" requires a raster source')):j==="raster"&&k!=="raster"?t.push(new Q(l,i.source,'layer "'+i.id+'" requires a vector source')):j!=="vector"||i["source-layer"]?j==="raster-dem"&&k!=="hillshade"?t.push(new Q(l,i.source,"raster-dem source can only be used with layer type 'hillshade'.")):k!=="line"||!i.paint||!i.paint["line-gradient"]||j==="geojson"&&V.lineMetrics||t.push(new Q(l,i,'layer "'+i.id+'" specifies a line-gradient, which requires a GeoJSON source with `lineMetrics` enabled.')):t.push(new Q(l,i,'layer "'+i.id+'" must specify a "source-layer"')):t.push(new Q(l,i.source,'source "'+i.source+'" not found'))}else t.push(new Q(l,i,'missing required property "source"'));return t=t.concat(fa({key:l,value:i,valueSpec:m.layer,style:e.style,styleSpec:e.styleSpec,objectElementValidators:{"*":function(){return[]},type:function(){return mr({key:l+".type",value:i.type,valueSpec:m.layer.type,style:e.style,styleSpec:e.styleSpec,object:i,objectKey:"type"})},filter:Hl,layout:function(J){return fa({layer:i,key:J.key,value:J.value,style:J.style,styleSpec:J.styleSpec,objectElementValidators:{"*":function($){return ps(Ce({layerType:k},$))}}})},paint:function(J){return fa({layer:i,key:J.key,value:J.value,style:J.style,styleSpec:J.styleSpec,objectElementValidators:{"*":function($){return Wl(Ce({layerType:k},$))}}})}}}))}function wo(e){var t=e.value,i=e.key,l=Fr(t);return l!=="string"?[new Q(i,t,"string expected, "+l+" found")]:[]}var Wr={promoteId:function(e){var t=e.key,i=e.value;if(Fr(i)==="string")return wo({key:t,value:i});var l=[];for(var f in i)l.push.apply(l,wo({key:t+"."+f,value:i[f]}));return l}};function Ks(e){var t=e.value,i=e.key,l=e.styleSpec,f=e.style;if(!t.type)return[new Q(i,t,'"type" is required')];var m,x=Le(t.type);switch(x){case"vector":case"raster":case"raster-dem":return fa({key:i,value:t,valueSpec:l["source_"+x.replace("-","_")],style:e.style,styleSpec:l,objectElementValidators:Wr});case"geojson":if(m=fa({key:i,value:t,valueSpec:l.source_geojson,style:f,styleSpec:l,objectElementValidators:Wr}),t.cluster)for(var k in t.clusterProperties){var A=t.clusterProperties[k],z=A[0],C=typeof z=="string"?[z,["accumulated"],["get",k]]:z;m.push.apply(m,xo({key:i+"."+k+".map",value:A[1],expressionContext:"cluster-map"})),m.push.apply(m,xo({key:i+"."+k+".reduce",value:C,expressionContext:"cluster-reduce"}))}return m;case"video":return fa({key:i,value:t,valueSpec:l.source_video,style:f,styleSpec:l});case"image":return fa({key:i,value:t,valueSpec:l.source_image,style:f,styleSpec:l});case"canvas":return[new Q(i,null,"Please use runtime APIs to add canvas sources, rather than including them in stylesheets.","source.canvas")];default:return hs({key:i+".type",value:t.type,valueSpec:{values:["vector","raster","raster-dem","geojson","video","image"]},style:f,styleSpec:l})}}function So(e){var t=e.value,i=e.styleSpec,l=i.light,f=e.style,m=[],x=Fr(t);if(t===void 0)return m;if(x!=="object")return m.concat([new Q("light",t,"object expected, "+x+" found")]);for(var k in t){var A=k.match(/^(.*)-transition$/);m=m.concat(A&&l[A[1]]&&l[A[1]].transition?mr({key:k,value:t[k],valueSpec:i.transition,style:f,styleSpec:i}):l[k]?mr({key:k,value:t[k],valueSpec:l[k],style:f,styleSpec:i}):[new Q(k,t[k],'unknown property "'+k+'"')])}return m}var Ha={"*":function(){return[]},array:gc,boolean:function(e){var t=e.value,i=e.key,l=Fr(t);return l!=="boolean"?[new Q(i,t,"boolean expected, "+l+" found")]:[]},number:_c,color:function(e){var t=e.key,i=e.value,l=Fr(i);return l!=="string"?[new Q(t,i,"color expected, "+l+" found")]:Qt(i)===null?[new Q(t,i,'color expected, "'+i+'" found')]:[]},constants:ge,enum:hs,filter:Hl,function:vc,layer:wc,object:fa,source:Ks,light:So,string:wo,formatted:function(e){return wo(e).length===0?[]:xo(e)},resolvedImage:function(e){return wo(e).length===0?[]:xo(e)}};function mr(e){var t=e.value,i=e.valueSpec,l=e.styleSpec;return i.expression&&Ns(Le(t))?vc(e):i.expression&&us(Ee(t))?xo(e):i.type&&Ha[i.type]?Ha[i.type](e):fa(Ce({},e,{valueSpec:i.type?l[i.type]:i}))}function Nr(e){var t=e.value,i=e.key,l=wo(e);return l.length||(t.indexOf("{fontstack}")===-1&&l.push(new Q(i,t,'"glyphs" url must include a "{fontstack}" token')),t.indexOf("{range}")===-1&&l.push(new Q(i,t,'"glyphs" url must include a "{range}" token'))),l}function Jn(e,t){t===void 0&&(t=U);var i=[];return i=i.concat(mr({key:"",value:e,valueSpec:t.$root,styleSpec:t,style:e,objectElementValidators:{glyphs:Nr,"*":function(){return[]}}})),e.constants&&(i=i.concat(ge({key:"constants",value:e.constants,style:e,styleSpec:t}))),fs(i)}function fs(e){return[].concat(e).sort(function(t,i){return t.line-i.line})}function qo(e){return function(){for(var t=[],i=arguments.length;i--;)t[i]=arguments[i];return fs(e.apply(this,t))}}Jn.source=qo(Ks),Jn.light=qo(So),Jn.layer=qo(wc),Jn.filter=qo(Hl),Jn.paintProperty=qo(Wl),Jn.layoutProperty=qo(ps);var ds=Jn,Zh=ds.light,Kh=ds.paintProperty,ms=ds.layoutProperty;function ys(e,t){var i=!1;if(t&&t.length)for(var l=0,f=t;l<f.length;l+=1)e.fire(new ue(new Error(f[l].message))),i=!0;return i}var Ca=Ci;function Ci(e,t,i){var l=this.cells=[];if(e instanceof ArrayBuffer){this.arrayBuffer=e;var f=new Int32Array(this.arrayBuffer);e=f[0],this.d=(t=f[1])+2*(i=f[2]);for(var m=0;m<this.d*this.d;m++){var x=f[3+m],k=f[3+m+1];l.push(x===k?null:f.subarray(x,k))}var A=f[3+l.length+1];this.keys=f.subarray(f[3+l.length],A),this.bboxes=f.subarray(A),this.insert=this._insertReadonly}else{this.d=t+2*i;for(var z=0;z<this.d*this.d;z++)l.push([]);this.keys=[],this.bboxes=[]}this.n=t,this.extent=e,this.padding=i,this.scale=t/e,this.uid=0;var C=i/t*e;this.min=-C,this.max=e+C}Ci.prototype.insert=function(e,t,i,l,f){this._forEachCell(t,i,l,f,this._insertCell,this.uid++),this.keys.push(e),this.bboxes.push(t),this.bboxes.push(i),this.bboxes.push(l),this.bboxes.push(f)},Ci.prototype._insertReadonly=function(){throw"Cannot insert into a GridIndex created from an ArrayBuffer."},Ci.prototype._insertCell=function(e,t,i,l,f,m){this.cells[f].push(m)},Ci.prototype.query=function(e,t,i,l,f){var m=this.min,x=this.max;if(e<=m&&t<=m&&x<=i&&x<=l&&!f)return Array.prototype.slice.call(this.keys);var k=[];return this._forEachCell(e,t,i,l,this._queryCell,k,{},f),k},Ci.prototype._queryCell=function(e,t,i,l,f,m,x,k){var A=this.cells[f];if(A!==null)for(var z=this.keys,C=this.bboxes,B=0;B<A.length;B++){var V=A[B];if(x[V]===void 0){var j=4*V;(k?k(C[j+0],C[j+1],C[j+2],C[j+3]):e<=C[j+2]&&t<=C[j+3]&&i>=C[j+0]&&l>=C[j+1])?(x[V]=!0,m.push(z[V])):x[V]=!1}}},Ci.prototype._forEachCell=function(e,t,i,l,f,m,x,k){for(var A=this._convertToCellCoord(e),z=this._convertToCellCoord(t),C=this._convertToCellCoord(i),B=this._convertToCellCoord(l),V=A;V<=C;V++)for(var j=z;j<=B;j++){var J=this.d*j+V;if((!k||k(this._convertFromCellCoord(V),this._convertFromCellCoord(j),this._convertFromCellCoord(V+1),this._convertFromCellCoord(j+1)))&&f.call(this,e,t,i,l,J,m,x,k))return}},Ci.prototype._convertFromCellCoord=function(e){return(e-this.padding)/this.scale},Ci.prototype._convertToCellCoord=function(e){return Math.max(0,Math.min(this.d-1,Math.floor(e*this.scale)+this.padding))},Ci.prototype.toArrayBuffer=function(){if(this.arrayBuffer)return this.arrayBuffer;for(var e=this.cells,t=3+this.cells.length+1+1,i=0,l=0;l<this.cells.length;l++)i+=this.cells[l].length;var f=new Int32Array(t+i+this.keys.length+this.bboxes.length);f[0]=this.extent,f[1]=this.n,f[2]=this.padding;for(var m=t,x=0;x<e.length;x++){var k=e[x];f[3+x]=m,f.set(k,m),m+=k.length}return f[3+e.length]=m,f.set(this.keys,m),f[3+e.length+1]=m+=this.keys.length,f.set(this.bboxes,m),m+=this.bboxes.length,f.buffer};var gs=L.ImageData,Sc=L.ImageBitmap,Si={};function dt(e,t,i){i===void 0&&(i={}),Object.defineProperty(t,"_classRegistryKey",{value:e,writeable:!1}),Si[e]={klass:t,omit:i.omit||[],shallow:i.shallow||[]}}for(var Fn in dt("Object",Object),Ca.serialize=function(e,t){var i=e.toArrayBuffer();return t&&t.push(i),{buffer:i}},Ca.deserialize=function(e){return new Ca(e.buffer)},dt("Grid",Ca),dt("Color",dr),dt("Error",Error),dt("ResolvedImage",Oi),dt("StylePropertyFunction",Uo),dt("StyleExpression",No,{omit:["_evaluator"]}),dt("ZoomDependentExpression",Vo),dt("ZoomConstantExpression",cs),dt("CompoundExpression",Pi,{omit:["_evaluate"]}),go)go[Fn]._classRegistryKey||dt("Expression_"+Fn,go[Fn]);function Hs(e){return e&&typeof ArrayBuffer<"u"&&(e instanceof ArrayBuffer||e.constructor&&e.constructor.name==="ArrayBuffer")}function jo(e){return Sc&&e instanceof Sc}function da(e,t){if(e==null||typeof e=="boolean"||typeof e=="number"||typeof e=="string"||e instanceof Boolean||e instanceof Number||e instanceof String||e instanceof Date||e instanceof RegExp)return e;if(Hs(e)||jo(e))return t&&t.push(e),e;if(ArrayBuffer.isView(e)){var i=e;return t&&t.push(i.buffer),i}if(e instanceof gs)return t&&t.push(e.data.buffer),e;if(Array.isArray(e)){for(var l=[],f=0,m=e;f<m.length;f+=1)l.push(da(m[f],t));return l}if(typeof e=="object"){var x=e.constructor,k=x._classRegistryKey;if(!k)throw new Error("can't serialize object of unregistered class");var A=x.serialize?x.serialize(e,t):{};if(!x.serialize){for(var z in e)if(e.hasOwnProperty(z)&&!(Si[k].omit.indexOf(z)>=0)){var C=e[z];A[z]=Si[k].shallow.indexOf(z)>=0?C:da(C,t)}e instanceof Error&&(A.message=e.message)}if(A.$name)throw new Error("$name property is reserved for worker serialization logic.");return k!=="Object"&&(A.$name=k),A}throw new Error("can't serialize object of type "+typeof e)}function Nn(e){if(e==null||typeof e=="boolean"||typeof e=="number"||typeof e=="string"||e instanceof Boolean||e instanceof Number||e instanceof String||e instanceof Date||e instanceof RegExp||Hs(e)||jo(e)||ArrayBuffer.isView(e)||e instanceof gs)return e;if(Array.isArray(e))return e.map(Nn);if(typeof e=="object"){var t=e.$name||"Object",i=Si[t].klass;if(!i)throw new Error("can't deserialize unregistered class "+t);if(i.deserialize)return i.deserialize(e);for(var l=Object.create(i.prototype),f=0,m=Object.keys(e);f<m.length;f+=1){var x=m[f];if(x!=="$name"){var k=e[x];l[x]=Si[t].shallow.indexOf(x)>=0?k:Nn(k)}}return l}throw new Error("can't deserialize object of type "+typeof e)}var Yl=function(){this.first=!0};Yl.prototype.update=function(e,t){var i=Math.floor(e);return this.first?(this.first=!1,this.lastIntegerZoom=i,this.lastIntegerZoomTime=0,this.lastZoom=e,this.lastFloorZoom=i,!0):(this.lastFloorZoom>i?(this.lastIntegerZoom=i+1,this.lastIntegerZoomTime=t):this.lastFloorZoom<i&&(this.lastIntegerZoom=i,this.lastIntegerZoomTime=t),e!==this.lastZoom&&(this.lastZoom=e,this.lastFloorZoom=i,!0))};var it={"Latin-1 Supplement":function(e){return e>=128&&e<=255},Arabic:function(e){return e>=1536&&e<=1791},"Arabic Supplement":function(e){return e>=1872&&e<=1919},"Arabic Extended-A":function(e){return e>=2208&&e<=2303},"Hangul Jamo":function(e){return e>=4352&&e<=4607},"Unified Canadian Aboriginal Syllabics":function(e){return e>=5120&&e<=5759},Khmer:function(e){return e>=6016&&e<=6143},"Unified Canadian Aboriginal Syllabics Extended":function(e){return e>=6320&&e<=6399},"General Punctuation":function(e){return e>=8192&&e<=8303},"Letterlike Symbols":function(e){return e>=8448&&e<=8527},"Number Forms":function(e){return e>=8528&&e<=8591},"Miscellaneous Technical":function(e){return e>=8960&&e<=9215},"Control Pictures":function(e){return e>=9216&&e<=9279},"Optical Character Recognition":function(e){return e>=9280&&e<=9311},"Enclosed Alphanumerics":function(e){return e>=9312&&e<=9471},"Geometric Shapes":function(e){return e>=9632&&e<=9727},"Miscellaneous Symbols":function(e){return e>=9728&&e<=9983},"Miscellaneous Symbols and Arrows":function(e){return e>=11008&&e<=11263},"CJK Radicals Supplement":function(e){return e>=11904&&e<=12031},"Kangxi Radicals":function(e){return e>=12032&&e<=12255},"Ideographic Description Characters":function(e){return e>=12272&&e<=12287},"CJK Symbols and Punctuation":function(e){return e>=12288&&e<=12351},Hiragana:function(e){return e>=12352&&e<=12447},Katakana:function(e){return e>=12448&&e<=12543},Bopomofo:function(e){return e>=12544&&e<=12591},"Hangul Compatibility Jamo":function(e){return e>=12592&&e<=12687},Kanbun:function(e){return e>=12688&&e<=12703},"Bopomofo Extended":function(e){return e>=12704&&e<=12735},"CJK Strokes":function(e){return e>=12736&&e<=12783},"Katakana Phonetic Extensions":function(e){return e>=12784&&e<=12799},"Enclosed CJK Letters and Months":function(e){return e>=12800&&e<=13055},"CJK Compatibility":function(e){return e>=13056&&e<=13311},"CJK Unified Ideographs Extension A":function(e){return e>=13312&&e<=19903},"Yijing Hexagram Symbols":function(e){return e>=19904&&e<=19967},"CJK Unified Ideographs":function(e){return e>=19968&&e<=40959},"Yi Syllables":function(e){return e>=40960&&e<=42127},"Yi Radicals":function(e){return e>=42128&&e<=42191},"Hangul Jamo Extended-A":function(e){return e>=43360&&e<=43391},"Hangul Syllables":function(e){return e>=44032&&e<=55215},"Hangul Jamo Extended-B":function(e){return e>=55216&&e<=55295},"Private Use Area":function(e){return e>=57344&&e<=63743},"CJK Compatibility Ideographs":function(e){return e>=63744&&e<=64255},"Arabic Presentation Forms-A":function(e){return e>=64336&&e<=65023},"Vertical Forms":function(e){return e>=65040&&e<=65055},"CJK Compatibility Forms":function(e){return e>=65072&&e<=65103},"Small Form Variants":function(e){return e>=65104&&e<=65135},"Arabic Presentation Forms-B":function(e){return e>=65136&&e<=65279},"Halfwidth and Fullwidth Forms":function(e){return e>=65280&&e<=65519}};function Jl(e){for(var t=0,i=e;t<i.length;t+=1)if(Xs(i[t].charCodeAt(0)))return!0;return!1}function Xs(e){return!(e!==746&&e!==747&&(e<4352||!(it["Bopomofo Extended"](e)||it.Bopomofo(e)||it["CJK Compatibility Forms"](e)&&!(e>=65097&&e<=65103)||it["CJK Compatibility Ideographs"](e)||it["CJK Compatibility"](e)||it["CJK Radicals Supplement"](e)||it["CJK Strokes"](e)||!(!it["CJK Symbols and Punctuation"](e)||e>=12296&&e<=12305||e>=12308&&e<=12319||e===12336)||it["CJK Unified Ideographs Extension A"](e)||it["CJK Unified Ideographs"](e)||it["Enclosed CJK Letters and Months"](e)||it["Hangul Compatibility Jamo"](e)||it["Hangul Jamo Extended-A"](e)||it["Hangul Jamo Extended-B"](e)||it["Hangul Jamo"](e)||it["Hangul Syllables"](e)||it.Hiragana(e)||it["Ideographic Description Characters"](e)||it.Kanbun(e)||it["Kangxi Radicals"](e)||it["Katakana Phonetic Extensions"](e)||it.Katakana(e)&&e!==12540||!(!it["Halfwidth and Fullwidth Forms"](e)||e===65288||e===65289||e===65293||e>=65306&&e<=65310||e===65339||e===65341||e===65343||e>=65371&&e<=65503||e===65507||e>=65512&&e<=65519)||!(!it["Small Form Variants"](e)||e>=65112&&e<=65118||e>=65123&&e<=65126)||it["Unified Canadian Aboriginal Syllabics"](e)||it["Unified Canadian Aboriginal Syllabics Extended"](e)||it["Vertical Forms"](e)||it["Yijing Hexagram Symbols"](e)||it["Yi Syllables"](e)||it["Yi Radicals"](e))))}function Ql(e){return!(Xs(e)||function(t){return!!(it["Latin-1 Supplement"](t)&&(t===167||t===169||t===174||t===177||t===188||t===189||t===190||t===215||t===247)||it["General Punctuation"](t)&&(t===8214||t===8224||t===8225||t===8240||t===8241||t===8251||t===8252||t===8258||t===8263||t===8264||t===8265||t===8273)||it["Letterlike Symbols"](t)||it["Number Forms"](t)||it["Miscellaneous Technical"](t)&&(t>=8960&&t<=8967||t>=8972&&t<=8991||t>=8996&&t<=9e3||t===9003||t>=9085&&t<=9114||t>=9150&&t<=9165||t===9167||t>=9169&&t<=9179||t>=9186&&t<=9215)||it["Control Pictures"](t)&&t!==9251||it["Optical Character Recognition"](t)||it["Enclosed Alphanumerics"](t)||it["Geometric Shapes"](t)||it["Miscellaneous Symbols"](t)&&!(t>=9754&&t<=9759)||it["Miscellaneous Symbols and Arrows"](t)&&(t>=11026&&t<=11055||t>=11088&&t<=11097||t>=11192&&t<=11243)||it["CJK Symbols and Punctuation"](t)||it.Katakana(t)||it["Private Use Area"](t)||it["CJK Compatibility Forms"](t)||it["Small Form Variants"](t)||it["Halfwidth and Fullwidth Forms"](t)||t===8734||t===8756||t===8757||t>=9984&&t<=10087||t>=10102&&t<=10131||t===65532||t===65533)}(e))}function ia(e){return e>=1424&&e<=2303||it["Arabic Presentation Forms-A"](e)||it["Arabic Presentation Forms-B"](e)}function Vn(e,t){return!(!t&&ia(e)||e>=2304&&e<=3583||e>=3840&&e<=4255||it.Khmer(e))}function Ws(e){for(var t=0,i=e;t<i.length;t+=1)if(ia(i[t].charCodeAt(0)))return!0;return!1}var Ys=null,Un="unavailable",Ma=null,kc=function(e){e&&typeof e=="string"&&e.indexOf("NetworkError")>-1&&(Un="error"),Ys&&Ys(e)};function _s(){$l.fire(new W("pluginStateChange",{pluginStatus:Un,pluginURL:Ma}))}var $l=new fe,eu=function(){return Un},ma=function(){if(Un!=="deferred"||!Ma)throw new Error("rtl-text-plugin cannot be downloaded unless a pluginURL is specified");Un="loading",_s(),Ma&&Ti({url:Ma},function(e){e?kc(e):(Un="loaded",_s())})},Qn={applyArabicShaping:null,processBidirectionalText:null,processStyledBidirectionalText:null,isLoaded:function(){return Un==="loaded"||Qn.applyArabicShaping!=null},isLoading:function(){return Un==="loading"},setState:function(e){Un=e.pluginStatus,Ma=e.pluginURL},isParsed:function(){return Qn.applyArabicShaping!=null&&Qn.processBidirectionalText!=null&&Qn.processStyledBidirectionalText!=null},getPluginURL:function(){return Ma}},lr=function(e,t){this.zoom=e,t?(this.now=t.now,this.fadeDuration=t.fadeDuration,this.zoomHistory=t.zoomHistory,this.transition=t.transition):(this.now=0,this.fadeDuration=0,this.zoomHistory=new Yl,this.transition={})};lr.prototype.isSupportedScript=function(e){return function(t,i){for(var l=0,f=t;l<f.length;l+=1)if(!Vn(f[l].charCodeAt(0),i))return!1;return!0}(e,Qn.isLoaded())},lr.prototype.crossFadingFactor=function(){return this.fadeDuration===0?1:Math.min((this.now-this.zoomHistory.lastIntegerZoomTime)/this.fadeDuration,1)},lr.prototype.getCrossfadeParameters=function(){var e=this.zoom,t=e-Math.floor(e),i=this.crossFadingFactor();return e>this.zoomHistory.lastIntegerZoom?{fromScale:2,toScale:1,t:t+(1-t)*i}:{fromScale:.5,toScale:1,t:1-(1-i)*t}};var Ea=function(e,t){this.property=e,this.value=t,this.expression=function(i,l){if(Ns(i))return new Uo(i,l);if(us(i)){var f=yc(i,l);if(f.result==="error")throw new Error(f.value.map(function(x){return x.key+": "+x.message}).join(", "));return f.value}var m=i;return typeof i=="string"&&l.type==="color"&&(m=dr.parse(i)),{kind:"constant",evaluate:function(){return m}}}(t===void 0?e.specification.default:t,e.specification)};Ea.prototype.isDataDriven=function(){return this.expression.kind==="source"||this.expression.kind==="composite"},Ea.prototype.possiblyEvaluate=function(e,t,i){return this.property.possiblyEvaluate(this,e,t,i)};var na=function(e){this.property=e,this.value=new Ea(e,void 0)};na.prototype.transitioned=function(e,t){return new ko(this.property,this.value,t,be({},e.transition,this.transition),e.now)},na.prototype.untransitioned=function(){return new ko(this.property,this.value,null,{},0)};var on=function(e){this._properties=e,this._values=Object.create(e.defaultTransitionablePropertyValues)};on.prototype.getValue=function(e){return vt(this._values[e].value.value)},on.prototype.setValue=function(e,t){this._values.hasOwnProperty(e)||(this._values[e]=new na(this._values[e].property)),this._values[e].value=new Ea(this._values[e].property,t===null?void 0:vt(t))},on.prototype.getTransition=function(e){return vt(this._values[e].transition)},on.prototype.setTransition=function(e,t){this._values.hasOwnProperty(e)||(this._values[e]=new na(this._values[e].property)),this._values[e].transition=vt(t)||void 0},on.prototype.serialize=function(){for(var e={},t=0,i=Object.keys(this._values);t<i.length;t+=1){var l=i[t],f=this.getValue(l);f!==void 0&&(e[l]=f);var m=this.getTransition(l);m!==void 0&&(e[l+"-transition"]=m)}return e},on.prototype.transitioned=function(e,t){for(var i=new Xa(this._properties),l=0,f=Object.keys(this._values);l<f.length;l+=1){var m=f[l];i._values[m]=this._values[m].transitioned(e,t._values[m])}return i},on.prototype.untransitioned=function(){for(var e=new Xa(this._properties),t=0,i=Object.keys(this._values);t<i.length;t+=1){var l=i[t];e._values[l]=this._values[l].untransitioned()}return e};var ko=function(e,t,i,l,f){this.property=e,this.value=t,this.begin=f+l.delay||0,this.end=this.begin+l.duration||0,e.specification.transition&&(l.delay||l.duration)&&(this.prior=i)};ko.prototype.possiblyEvaluate=function(e,t,i){var l=e.now||0,f=this.value.possiblyEvaluate(e,t,i),m=this.prior;if(m){if(l>this.end)return this.prior=null,f;if(this.value.isDataDriven())return this.prior=null,f;if(l<this.begin)return m.possiblyEvaluate(e,t,i);var x=(l-this.begin)/(this.end-this.begin);return this.property.interpolate(m.possiblyEvaluate(e,t,i),f,function(k){if(k<=0)return 0;if(k>=1)return 1;var A=k*k,z=A*k;return 4*(k<.5?z:3*(k-A)+z-.75)}(x))}return f};var Xa=function(e){this._properties=e,this._values=Object.create(e.defaultTransitioningPropertyValues)};Xa.prototype.possiblyEvaluate=function(e,t,i){for(var l=new vs(this._properties),f=0,m=Object.keys(this._values);f<m.length;f+=1){var x=m[f];l._values[x]=this._values[x].possiblyEvaluate(e,t,i)}return l},Xa.prototype.hasTransition=function(){for(var e=0,t=Object.keys(this._values);e<t.length;e+=1)if(this._values[t[e]].prior)return!0;return!1};var ya=function(e){this._properties=e,this._values=Object.create(e.defaultPropertyValues)};ya.prototype.getValue=function(e){return vt(this._values[e].value)},ya.prototype.setValue=function(e,t){this._values[e]=new Ea(this._values[e].property,t===null?void 0:vt(t))},ya.prototype.serialize=function(){for(var e={},t=0,i=Object.keys(this._values);t<i.length;t+=1){var l=i[t],f=this.getValue(l);f!==void 0&&(e[l]=f)}return e},ya.prototype.possiblyEvaluate=function(e,t,i){for(var l=new vs(this._properties),f=0,m=Object.keys(this._values);f<m.length;f+=1){var x=m[f];l._values[x]=this._values[x].possiblyEvaluate(e,t,i)}return l};var vn=function(e,t,i){this.property=e,this.value=t,this.parameters=i};vn.prototype.isConstant=function(){return this.value.kind==="constant"},vn.prototype.constantOr=function(e){return this.value.kind==="constant"?this.value.value:e},vn.prototype.evaluate=function(e,t,i,l){return this.property.evaluate(this.value,this.parameters,e,t,i,l)};var vs=function(e){this._properties=e,this._values=Object.create(e.defaultPossiblyEvaluatedValues)};vs.prototype.get=function(e){return this._values[e]};var kt=function(e){this.specification=e};kt.prototype.possiblyEvaluate=function(e,t){return e.expression.evaluate(t)},kt.prototype.interpolate=function(e,t,i){var l=Oo[this.specification.type];return l?l(e,t,i):e};var gt=function(e,t){this.specification=e,this.overrides=t};gt.prototype.possiblyEvaluate=function(e,t,i,l){return new vn(this,e.expression.kind==="constant"||e.expression.kind==="camera"?{kind:"constant",value:e.expression.evaluate(t,null,{},i,l)}:e.expression,t)},gt.prototype.interpolate=function(e,t,i){if(e.value.kind!=="constant"||t.value.kind!=="constant")return e;if(e.value.value===void 0||t.value.value===void 0)return new vn(this,{kind:"constant",value:void 0},e.parameters);var l=Oo[this.specification.type];return l?new vn(this,{kind:"constant",value:l(e.value.value,t.value.value,i)},e.parameters):e},gt.prototype.evaluate=function(e,t,i,l,f,m){return e.kind==="constant"?e.value:e.evaluate(t,i,l,f,m)};var Js=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.possiblyEvaluate=function(i,l,f,m){if(i.value===void 0)return new vn(this,{kind:"constant",value:void 0},l);if(i.expression.kind==="constant"){var x=i.expression.evaluate(l,null,{},f,m),k=i.property.specification.type==="resolvedImage"&&typeof x!="string"?x.name:x,A=this._calculate(k,k,k,l);return new vn(this,{kind:"constant",value:A},l)}if(i.expression.kind==="camera"){var z=this._calculate(i.expression.evaluate({zoom:l.zoom-1}),i.expression.evaluate({zoom:l.zoom}),i.expression.evaluate({zoom:l.zoom+1}),l);return new vn(this,{kind:"constant",value:z},l)}return new vn(this,i.expression,l)},t.prototype.evaluate=function(i,l,f,m,x,k){if(i.kind==="source"){var A=i.evaluate(l,f,m,x,k);return this._calculate(A,A,A,l)}return i.kind==="composite"?this._calculate(i.evaluate({zoom:Math.floor(l.zoom)-1},f,m),i.evaluate({zoom:Math.floor(l.zoom)},f,m),i.evaluate({zoom:Math.floor(l.zoom)+1},f,m),l):i.value},t.prototype._calculate=function(i,l,f,m){return m.zoom>m.zoomHistory.lastIntegerZoom?{from:i,to:l}:{from:f,to:l}},t.prototype.interpolate=function(i){return i},t}(gt),bn=function(e){this.specification=e};bn.prototype.possiblyEvaluate=function(e,t,i,l){if(e.value!==void 0){if(e.expression.kind==="constant"){var f=e.expression.evaluate(t,null,{},i,l);return this._calculate(f,f,f,t)}return this._calculate(e.expression.evaluate(new lr(Math.floor(t.zoom-1),t)),e.expression.evaluate(new lr(Math.floor(t.zoom),t)),e.expression.evaluate(new lr(Math.floor(t.zoom+1),t)),t)}},bn.prototype._calculate=function(e,t,i,l){return l.zoom>l.zoomHistory.lastIntegerZoom?{from:e,to:t}:{from:i,to:t}},bn.prototype.interpolate=function(e){return e};var ga=function(e){this.specification=e};ga.prototype.possiblyEvaluate=function(e,t,i,l){return!!e.expression.evaluate(t,null,{},i,l)},ga.prototype.interpolate=function(){return!1};var sn=function(e){for(var t in this.properties=e,this.defaultPropertyValues={},this.defaultTransitionablePropertyValues={},this.defaultTransitioningPropertyValues={},this.defaultPossiblyEvaluatedValues={},this.overridableProperties=[],e){var i=e[t];i.specification.overridable&&this.overridableProperties.push(t);var l=this.defaultPropertyValues[t]=new Ea(i,void 0),f=this.defaultTransitionablePropertyValues[t]=new na(i);this.defaultTransitioningPropertyValues[t]=f.untransitioned(),this.defaultPossiblyEvaluatedValues[t]=l.possiblyEvaluate({})}};dt("DataDrivenProperty",gt),dt("DataConstantProperty",kt),dt("CrossFadedDataDrivenProperty",Js),dt("CrossFadedProperty",bn),dt("ColorRampProperty",ga);var Ta=function(e){function t(i,l){if(e.call(this),this.id=i.id,this.type=i.type,this._featureFilter={filter:function(){return!0},needGeometry:!1},i.type!=="custom"&&(this.metadata=(i=i).metadata,this.minzoom=i.minzoom,this.maxzoom=i.maxzoom,i.type!=="background"&&(this.source=i.source,this.sourceLayer=i["source-layer"],this.filter=i.filter),l.layout&&(this._unevaluatedLayout=new ya(l.layout)),l.paint)){for(var f in this._transitionablePaint=new on(l.paint),i.paint)this.setPaintProperty(f,i.paint[f],{validate:!1});for(var m in i.layout)this.setLayoutProperty(m,i.layout[m],{validate:!1});this._transitioningPaint=this._transitionablePaint.untransitioned(),this.paint=new vs(l.paint)}}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.getCrossfadeParameters=function(){return this._crossfadeParameters},t.prototype.getLayoutProperty=function(i){return i==="visibility"?this.visibility:this._unevaluatedLayout.getValue(i)},t.prototype.setLayoutProperty=function(i,l,f){f===void 0&&(f={}),l!=null&&this._validate(ms,"layers."+this.id+".layout."+i,i,l,f)||(i!=="visibility"?this._unevaluatedLayout.setValue(i,l):this.visibility=l)},t.prototype.getPaintProperty=function(i){return zt(i,"-transition")?this._transitionablePaint.getTransition(i.slice(0,-11)):this._transitionablePaint.getValue(i)},t.prototype.setPaintProperty=function(i,l,f){if(f===void 0&&(f={}),l!=null&&this._validate(Kh,"layers."+this.id+".paint."+i,i,l,f))return!1;if(zt(i,"-transition"))return this._transitionablePaint.setTransition(i.slice(0,-11),l||void 0),!1;var m=this._transitionablePaint._values[i],x=m.property.specification["property-type"]==="cross-faded-data-driven",k=m.value.isDataDriven(),A=m.value;this._transitionablePaint.setValue(i,l),this._handleSpecialPaintPropertyUpdate(i);var z=this._transitionablePaint._values[i].value;return z.isDataDriven()||k||x||this._handleOverridablePaintPropertyUpdate(i,A,z)},t.prototype._handleSpecialPaintPropertyUpdate=function(i){},t.prototype._handleOverridablePaintPropertyUpdate=function(i,l,f){return!1},t.prototype.isHidden=function(i){return!!(this.minzoom&&i<this.minzoom)||!!(this.maxzoom&&i>=this.maxzoom)||this.visibility==="none"},t.prototype.updateTransitions=function(i){this._transitioningPaint=this._transitionablePaint.transitioned(i,this._transitioningPaint)},t.prototype.hasTransition=function(){return this._transitioningPaint.hasTransition()},t.prototype.recalculate=function(i,l){i.getCrossfadeParameters&&(this._crossfadeParameters=i.getCrossfadeParameters()),this._unevaluatedLayout&&(this.layout=this._unevaluatedLayout.possiblyEvaluate(i,void 0,l)),this.paint=this._transitioningPaint.possiblyEvaluate(i,void 0,l)},t.prototype.serialize=function(){var i={id:this.id,type:this.type,source:this.source,"source-layer":this.sourceLayer,metadata:this.metadata,minzoom:this.minzoom,maxzoom:this.maxzoom,filter:this.filter,layout:this._unevaluatedLayout&&this._unevaluatedLayout.serialize(),paint:this._transitionablePaint&&this._transitionablePaint.serialize()};return this.visibility&&(i.layout=i.layout||{},i.layout.visibility=this.visibility),Ke(i,function(l,f){return!(l===void 0||f==="layout"&&!Object.keys(l).length||f==="paint"&&!Object.keys(l).length)})},t.prototype._validate=function(i,l,f,m,x){return x===void 0&&(x={}),(!x||x.validate!==!1)&&ys(this,i.call(ds,{key:l,layerType:this.type,objectKey:f,value:m,styleSpec:U,style:{glyphs:!0,sprite:!0}}))},t.prototype.is3D=function(){return!1},t.prototype.isTileClipped=function(){return!1},t.prototype.hasOffscreenPass=function(){return!1},t.prototype.resize=function(){},t.prototype.isStateDependent=function(){for(var i in this.paint._values){var l=this.paint.get(i);if(l instanceof vn&&bo(l.property.specification)&&(l.value.kind==="source"||l.value.kind==="composite")&&l.value.isStateDependent)return!0}return!1},t}(fe),tu={Int8:Int8Array,Uint8:Uint8Array,Int16:Int16Array,Uint16:Uint16Array,Int32:Int32Array,Uint32:Uint32Array,Float32:Float32Array},Qs=function(e,t){this._structArray=e,this._pos1=t*this.size,this._pos2=this._pos1/2,this._pos4=this._pos1/4,this._pos8=this._pos1/8},Ar=function(){this.isTransferred=!1,this.capacity=-1,this.resize(0)};function Xi(e,t){t===void 0&&(t=1);var i=0,l=0;return{members:e.map(function(f){var m=tu[f.type].BYTES_PER_ELEMENT,x=i=Ec(i,Math.max(t,m)),k=f.components||1;return l=Math.max(l,m),i+=m*k,{name:f.name,type:f.type,components:k,offset:x}}),size:Ec(i,Math.max(l,t)),alignment:t}}function Ec(e,t){return Math.ceil(e/t)*t}Ar.serialize=function(e,t){return e._trim(),t&&(e.isTransferred=!0,t.push(e.arrayBuffer)),{length:e.length,arrayBuffer:e.arrayBuffer}},Ar.deserialize=function(e){var t=Object.create(this.prototype);return t.arrayBuffer=e.arrayBuffer,t.length=e.length,t.capacity=e.arrayBuffer.byteLength/t.bytesPerElement,t._refreshViews(),t},Ar.prototype._trim=function(){this.length!==this.capacity&&(this.capacity=this.length,this.arrayBuffer=this.arrayBuffer.slice(0,this.length*this.bytesPerElement),this._refreshViews())},Ar.prototype.clear=function(){this.length=0},Ar.prototype.resize=function(e){this.reserve(e),this.length=e},Ar.prototype.reserve=function(e){if(e>this.capacity){this.capacity=Math.max(e,Math.floor(5*this.capacity),128),this.arrayBuffer=new ArrayBuffer(this.capacity*this.bytesPerElement);var t=this.uint8;this._refreshViews(),t&&this.uint8.set(t)}},Ar.prototype._refreshViews=function(){throw new Error("_refreshViews() must be implemented by each concrete StructArray layout")};var Eo=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},t.prototype.emplaceBack=function(i,l){var f=this.length;return this.resize(f+1),this.emplace(f,i,l)},t.prototype.emplace=function(i,l,f){var m=2*i;return this.int16[m+0]=l,this.int16[m+1]=f,i},t}(Ar);Eo.prototype.bytesPerElement=4,dt("StructArrayLayout2i4",Eo);var ru=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},t.prototype.emplaceBack=function(i,l,f,m){var x=this.length;return this.resize(x+1),this.emplace(x,i,l,f,m)},t.prototype.emplace=function(i,l,f,m,x){var k=4*i;return this.int16[k+0]=l,this.int16[k+1]=f,this.int16[k+2]=m,this.int16[k+3]=x,i},t}(Ar);ru.prototype.bytesPerElement=8,dt("StructArrayLayout4i8",ru);var Da=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},t.prototype.emplaceBack=function(i,l,f,m,x,k){var A=this.length;return this.resize(A+1),this.emplace(A,i,l,f,m,x,k)},t.prototype.emplace=function(i,l,f,m,x,k,A){var z=6*i;return this.int16[z+0]=l,this.int16[z+1]=f,this.int16[z+2]=m,this.int16[z+3]=x,this.int16[z+4]=k,this.int16[z+5]=A,i},t}(Ar);Da.prototype.bytesPerElement=12,dt("StructArrayLayout2i4i12",Da);var qn=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},t.prototype.emplaceBack=function(i,l,f,m,x,k){var A=this.length;return this.resize(A+1),this.emplace(A,i,l,f,m,x,k)},t.prototype.emplace=function(i,l,f,m,x,k,A){var z=4*i,C=8*i;return this.int16[z+0]=l,this.int16[z+1]=f,this.uint8[C+4]=m,this.uint8[C+5]=x,this.uint8[C+6]=k,this.uint8[C+7]=A,i},t}(Ar);qn.prototype.bytesPerElement=8,dt("StructArrayLayout2i4ub8",qn);var Go=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},t.prototype.emplaceBack=function(i,l){var f=this.length;return this.resize(f+1),this.emplace(f,i,l)},t.prototype.emplace=function(i,l,f){var m=2*i;return this.float32[m+0]=l,this.float32[m+1]=f,i},t}(Ar);Go.prototype.bytesPerElement=8,dt("StructArrayLayout2f8",Go);var Ia=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},t.prototype.emplaceBack=function(i,l,f,m,x,k,A,z,C,B){var V=this.length;return this.resize(V+1),this.emplace(V,i,l,f,m,x,k,A,z,C,B)},t.prototype.emplace=function(i,l,f,m,x,k,A,z,C,B,V){var j=10*i;return this.uint16[j+0]=l,this.uint16[j+1]=f,this.uint16[j+2]=m,this.uint16[j+3]=x,this.uint16[j+4]=k,this.uint16[j+5]=A,this.uint16[j+6]=z,this.uint16[j+7]=C,this.uint16[j+8]=B,this.uint16[j+9]=V,i},t}(Ar);Ia.prototype.bytesPerElement=20,dt("StructArrayLayout10ui20",Ia);var $s=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},t.prototype.emplaceBack=function(i,l,f,m,x,k,A,z,C,B,V,j){var J=this.length;return this.resize(J+1),this.emplace(J,i,l,f,m,x,k,A,z,C,B,V,j)},t.prototype.emplace=function(i,l,f,m,x,k,A,z,C,B,V,j,J){var $=12*i;return this.int16[$+0]=l,this.int16[$+1]=f,this.int16[$+2]=m,this.int16[$+3]=x,this.uint16[$+4]=k,this.uint16[$+5]=A,this.uint16[$+6]=z,this.uint16[$+7]=C,this.int16[$+8]=B,this.int16[$+9]=V,this.int16[$+10]=j,this.int16[$+11]=J,i},t}(Ar);$s.prototype.bytesPerElement=24,dt("StructArrayLayout4i4ui4i24",$s);var Zo=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},t.prototype.emplaceBack=function(i,l,f){var m=this.length;return this.resize(m+1),this.emplace(m,i,l,f)},t.prototype.emplace=function(i,l,f,m){var x=3*i;return this.float32[x+0]=l,this.float32[x+1]=f,this.float32[x+2]=m,i},t}(Ar);Zo.prototype.bytesPerElement=12,dt("StructArrayLayout3f12",Zo);var bs=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)},t.prototype.emplaceBack=function(i){var l=this.length;return this.resize(l+1),this.emplace(l,i)},t.prototype.emplace=function(i,l){return this.uint32[1*i+0]=l,i},t}(Ar);bs.prototype.bytesPerElement=4,dt("StructArrayLayout1ul4",bs);var iu=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},t.prototype.emplaceBack=function(i,l,f,m,x,k,A,z,C){var B=this.length;return this.resize(B+1),this.emplace(B,i,l,f,m,x,k,A,z,C)},t.prototype.emplace=function(i,l,f,m,x,k,A,z,C,B){var V=10*i,j=5*i;return this.int16[V+0]=l,this.int16[V+1]=f,this.int16[V+2]=m,this.int16[V+3]=x,this.int16[V+4]=k,this.int16[V+5]=A,this.uint32[j+3]=z,this.uint16[V+8]=C,this.uint16[V+9]=B,i},t}(Ar);iu.prototype.bytesPerElement=20,dt("StructArrayLayout6i1ul2ui20",iu);var Ko=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},t.prototype.emplaceBack=function(i,l,f,m,x,k){var A=this.length;return this.resize(A+1),this.emplace(A,i,l,f,m,x,k)},t.prototype.emplace=function(i,l,f,m,x,k,A){var z=6*i;return this.int16[z+0]=l,this.int16[z+1]=f,this.int16[z+2]=m,this.int16[z+3]=x,this.int16[z+4]=k,this.int16[z+5]=A,i},t}(Ar);Ko.prototype.bytesPerElement=12,dt("StructArrayLayout2i2i2i12",Ko);var To=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},t.prototype.emplaceBack=function(i,l,f,m,x){var k=this.length;return this.resize(k+1),this.emplace(k,i,l,f,m,x)},t.prototype.emplace=function(i,l,f,m,x,k){var A=4*i,z=8*i;return this.float32[A+0]=l,this.float32[A+1]=f,this.float32[A+2]=m,this.int16[z+6]=x,this.int16[z+7]=k,i},t}(Ar);To.prototype.bytesPerElement=16,dt("StructArrayLayout2f1f2i16",To);var nu=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},t.prototype.emplaceBack=function(i,l,f,m){var x=this.length;return this.resize(x+1),this.emplace(x,i,l,f,m)},t.prototype.emplace=function(i,l,f,m,x){var k=12*i,A=3*i;return this.uint8[k+0]=l,this.uint8[k+1]=f,this.float32[A+1]=m,this.float32[A+2]=x,i},t}(Ar);nu.prototype.bytesPerElement=12,dt("StructArrayLayout2ub2f12",nu);var Wa=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},t.prototype.emplaceBack=function(i,l,f){var m=this.length;return this.resize(m+1),this.emplace(m,i,l,f)},t.prototype.emplace=function(i,l,f,m){var x=3*i;return this.uint16[x+0]=l,this.uint16[x+1]=f,this.uint16[x+2]=m,i},t}(Ar);Wa.prototype.bytesPerElement=6,dt("StructArrayLayout3ui6",Wa);var Ya=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},t.prototype.emplaceBack=function(i,l,f,m,x,k,A,z,C,B,V,j,J,$,he,ie,me){var ve=this.length;return this.resize(ve+1),this.emplace(ve,i,l,f,m,x,k,A,z,C,B,V,j,J,$,he,ie,me)},t.prototype.emplace=function(i,l,f,m,x,k,A,z,C,B,V,j,J,$,he,ie,me,ve){var we=24*i,ke=12*i,Pe=48*i;return this.int16[we+0]=l,this.int16[we+1]=f,this.uint16[we+2]=m,this.uint16[we+3]=x,this.uint32[ke+2]=k,this.uint32[ke+3]=A,this.uint32[ke+4]=z,this.uint16[we+10]=C,this.uint16[we+11]=B,this.uint16[we+12]=V,this.float32[ke+7]=j,this.float32[ke+8]=J,this.uint8[Pe+36]=$,this.uint8[Pe+37]=he,this.uint8[Pe+38]=ie,this.uint32[ke+10]=me,this.int16[we+22]=ve,i},t}(Ar);Ya.prototype.bytesPerElement=48,dt("StructArrayLayout2i2ui3ul3ui2f3ub1ul1i48",Ya);var el=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},t.prototype.emplaceBack=function(i,l,f,m,x,k,A,z,C,B,V,j,J,$,he,ie,me,ve,we,ke,Pe,qe,et,wt,st,Tt,lt,$t){var Mt=this.length;return this.resize(Mt+1),this.emplace(Mt,i,l,f,m,x,k,A,z,C,B,V,j,J,$,he,ie,me,ve,we,ke,Pe,qe,et,wt,st,Tt,lt,$t)},t.prototype.emplace=function(i,l,f,m,x,k,A,z,C,B,V,j,J,$,he,ie,me,ve,we,ke,Pe,qe,et,wt,st,Tt,lt,$t,Mt){var _t=34*i,sr=17*i;return this.int16[_t+0]=l,this.int16[_t+1]=f,this.int16[_t+2]=m,this.int16[_t+3]=x,this.int16[_t+4]=k,this.int16[_t+5]=A,this.int16[_t+6]=z,this.int16[_t+7]=C,this.uint16[_t+8]=B,this.uint16[_t+9]=V,this.uint16[_t+10]=j,this.uint16[_t+11]=J,this.uint16[_t+12]=$,this.uint16[_t+13]=he,this.uint16[_t+14]=ie,this.uint16[_t+15]=me,this.uint16[_t+16]=ve,this.uint16[_t+17]=we,this.uint16[_t+18]=ke,this.uint16[_t+19]=Pe,this.uint16[_t+20]=qe,this.uint16[_t+21]=et,this.uint16[_t+22]=wt,this.uint32[sr+12]=st,this.float32[sr+13]=Tt,this.float32[sr+14]=lt,this.float32[sr+15]=$t,this.float32[sr+16]=Mt,i},t}(Ar);el.prototype.bytesPerElement=68,dt("StructArrayLayout8i15ui1ul4f68",el);var Ja=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},t.prototype.emplaceBack=function(i){var l=this.length;return this.resize(l+1),this.emplace(l,i)},t.prototype.emplace=function(i,l){return this.float32[1*i+0]=l,i},t}(Ar);Ja.prototype.bytesPerElement=4,dt("StructArrayLayout1f4",Ja);var aa=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},t.prototype.emplaceBack=function(i,l,f){var m=this.length;return this.resize(m+1),this.emplace(m,i,l,f)},t.prototype.emplace=function(i,l,f,m){var x=3*i;return this.int16[x+0]=l,this.int16[x+1]=f,this.int16[x+2]=m,i},t}(Ar);aa.prototype.bytesPerElement=6,dt("StructArrayLayout3i6",aa);var au=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},t.prototype.emplaceBack=function(i,l,f){var m=this.length;return this.resize(m+1),this.emplace(m,i,l,f)},t.prototype.emplace=function(i,l,f,m){var x=4*i;return this.uint32[2*i+0]=l,this.uint16[x+2]=f,this.uint16[x+3]=m,i},t}(Ar);au.prototype.bytesPerElement=8,dt("StructArrayLayout1ul2ui8",au);var xs=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},t.prototype.emplaceBack=function(i,l){var f=this.length;return this.resize(f+1),this.emplace(f,i,l)},t.prototype.emplace=function(i,l,f){var m=2*i;return this.uint16[m+0]=l,this.uint16[m+1]=f,i},t}(Ar);xs.prototype.bytesPerElement=4,dt("StructArrayLayout2ui4",xs);var ou=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},t.prototype.emplaceBack=function(i){var l=this.length;return this.resize(l+1),this.emplace(l,i)},t.prototype.emplace=function(i,l){return this.uint16[1*i+0]=l,i},t}(Ar);ou.prototype.bytesPerElement=2,dt("StructArrayLayout1ui2",ou);var tl=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},t.prototype.emplaceBack=function(i,l,f,m){var x=this.length;return this.resize(x+1),this.emplace(x,i,l,f,m)},t.prototype.emplace=function(i,l,f,m,x){var k=4*i;return this.float32[k+0]=l,this.float32[k+1]=f,this.float32[k+2]=m,this.float32[k+3]=x,i},t}(Ar);tl.prototype.bytesPerElement=16,dt("StructArrayLayout4f16",tl);var n=function(e){function t(){e.apply(this,arguments)}e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t;var i={anchorPointX:{configurable:!0},anchorPointY:{configurable:!0},x1:{configurable:!0},y1:{configurable:!0},x2:{configurable:!0},y2:{configurable:!0},featureIndex:{configurable:!0},sourceLayerIndex:{configurable:!0},bucketIndex:{configurable:!0},anchorPoint:{configurable:!0}};return i.anchorPointX.get=function(){return this._structArray.int16[this._pos2+0]},i.anchorPointY.get=function(){return this._structArray.int16[this._pos2+1]},i.x1.get=function(){return this._structArray.int16[this._pos2+2]},i.y1.get=function(){return this._structArray.int16[this._pos2+3]},i.x2.get=function(){return this._structArray.int16[this._pos2+4]},i.y2.get=function(){return this._structArray.int16[this._pos2+5]},i.featureIndex.get=function(){return this._structArray.uint32[this._pos4+3]},i.sourceLayerIndex.get=function(){return this._structArray.uint16[this._pos2+8]},i.bucketIndex.get=function(){return this._structArray.uint16[this._pos2+9]},i.anchorPoint.get=function(){return new F(this.anchorPointX,this.anchorPointY)},Object.defineProperties(t.prototype,i),t}(Qs);n.prototype.size=20;var s=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.get=function(i){return new n(this,i)},t}(iu);dt("CollisionBoxArray",s);var o=function(e){function t(){e.apply(this,arguments)}e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t;var i={anchorX:{configurable:!0},anchorY:{configurable:!0},glyphStartIndex:{configurable:!0},numGlyphs:{configurable:!0},vertexStartIndex:{configurable:!0},lineStartIndex:{configurable:!0},lineLength:{configurable:!0},segment:{configurable:!0},lowerSize:{configurable:!0},upperSize:{configurable:!0},lineOffsetX:{configurable:!0},lineOffsetY:{configurable:!0},writingMode:{configurable:!0},placedOrientation:{configurable:!0},hidden:{configurable:!0},crossTileID:{configurable:!0},associatedIconIndex:{configurable:!0}};return i.anchorX.get=function(){return this._structArray.int16[this._pos2+0]},i.anchorY.get=function(){return this._structArray.int16[this._pos2+1]},i.glyphStartIndex.get=function(){return this._structArray.uint16[this._pos2+2]},i.numGlyphs.get=function(){return this._structArray.uint16[this._pos2+3]},i.vertexStartIndex.get=function(){return this._structArray.uint32[this._pos4+2]},i.lineStartIndex.get=function(){return this._structArray.uint32[this._pos4+3]},i.lineLength.get=function(){return this._structArray.uint32[this._pos4+4]},i.segment.get=function(){return this._structArray.uint16[this._pos2+10]},i.lowerSize.get=function(){return this._structArray.uint16[this._pos2+11]},i.upperSize.get=function(){return this._structArray.uint16[this._pos2+12]},i.lineOffsetX.get=function(){return this._structArray.float32[this._pos4+7]},i.lineOffsetY.get=function(){return this._structArray.float32[this._pos4+8]},i.writingMode.get=function(){return this._structArray.uint8[this._pos1+36]},i.placedOrientation.get=function(){return this._structArray.uint8[this._pos1+37]},i.placedOrientation.set=function(l){this._structArray.uint8[this._pos1+37]=l},i.hidden.get=function(){return this._structArray.uint8[this._pos1+38]},i.hidden.set=function(l){this._structArray.uint8[this._pos1+38]=l},i.crossTileID.get=function(){return this._structArray.uint32[this._pos4+10]},i.crossTileID.set=function(l){this._structArray.uint32[this._pos4+10]=l},i.associatedIconIndex.get=function(){return this._structArray.int16[this._pos2+22]},Object.defineProperties(t.prototype,i),t}(Qs);o.prototype.size=48;var c=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.get=function(i){return new o(this,i)},t}(Ya);dt("PlacedSymbolArray",c);var v=function(e){function t(){e.apply(this,arguments)}e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t;var i={anchorX:{configurable:!0},anchorY:{configurable:!0},rightJustifiedTextSymbolIndex:{configurable:!0},centerJustifiedTextSymbolIndex:{configurable:!0},leftJustifiedTextSymbolIndex:{configurable:!0},verticalPlacedTextSymbolIndex:{configurable:!0},placedIconSymbolIndex:{configurable:!0},verticalPlacedIconSymbolIndex:{configurable:!0},key:{configurable:!0},textBoxStartIndex:{configurable:!0},textBoxEndIndex:{configurable:!0},verticalTextBoxStartIndex:{configurable:!0},verticalTextBoxEndIndex:{configurable:!0},iconBoxStartIndex:{configurable:!0},iconBoxEndIndex:{configurable:!0},verticalIconBoxStartIndex:{configurable:!0},verticalIconBoxEndIndex:{configurable:!0},featureIndex:{configurable:!0},numHorizontalGlyphVertices:{configurable:!0},numVerticalGlyphVertices:{configurable:!0},numIconVertices:{configurable:!0},numVerticalIconVertices:{configurable:!0},useRuntimeCollisionCircles:{configurable:!0},crossTileID:{configurable:!0},textBoxScale:{configurable:!0},textOffset0:{configurable:!0},textOffset1:{configurable:!0},collisionCircleDiameter:{configurable:!0}};return i.anchorX.get=function(){return this._structArray.int16[this._pos2+0]},i.anchorY.get=function(){return this._structArray.int16[this._pos2+1]},i.rightJustifiedTextSymbolIndex.get=function(){return this._structArray.int16[this._pos2+2]},i.centerJustifiedTextSymbolIndex.get=function(){return this._structArray.int16[this._pos2+3]},i.leftJustifiedTextSymbolIndex.get=function(){return this._structArray.int16[this._pos2+4]},i.verticalPlacedTextSymbolIndex.get=function(){return this._structArray.int16[this._pos2+5]},i.placedIconSymbolIndex.get=function(){return this._structArray.int16[this._pos2+6]},i.verticalPlacedIconSymbolIndex.get=function(){return this._structArray.int16[this._pos2+7]},i.key.get=function(){return this._structArray.uint16[this._pos2+8]},i.textBoxStartIndex.get=function(){return this._structArray.uint16[this._pos2+9]},i.textBoxEndIndex.get=function(){return this._structArray.uint16[this._pos2+10]},i.verticalTextBoxStartIndex.get=function(){return this._structArray.uint16[this._pos2+11]},i.verticalTextBoxEndIndex.get=function(){return this._structArray.uint16[this._pos2+12]},i.iconBoxStartIndex.get=function(){return this._structArray.uint16[this._pos2+13]},i.iconBoxEndIndex.get=function(){return this._structArray.uint16[this._pos2+14]},i.verticalIconBoxStartIndex.get=function(){return this._structArray.uint16[this._pos2+15]},i.verticalIconBoxEndIndex.get=function(){return this._structArray.uint16[this._pos2+16]},i.featureIndex.get=function(){return this._structArray.uint16[this._pos2+17]},i.numHorizontalGlyphVertices.get=function(){return this._structArray.uint16[this._pos2+18]},i.numVerticalGlyphVertices.get=function(){return this._structArray.uint16[this._pos2+19]},i.numIconVertices.get=function(){return this._structArray.uint16[this._pos2+20]},i.numVerticalIconVertices.get=function(){return this._structArray.uint16[this._pos2+21]},i.useRuntimeCollisionCircles.get=function(){return this._structArray.uint16[this._pos2+22]},i.crossTileID.get=function(){return this._structArray.uint32[this._pos4+12]},i.crossTileID.set=function(l){this._structArray.uint32[this._pos4+12]=l},i.textBoxScale.get=function(){return this._structArray.float32[this._pos4+13]},i.textOffset0.get=function(){return this._structArray.float32[this._pos4+14]},i.textOffset1.get=function(){return this._structArray.float32[this._pos4+15]},i.collisionCircleDiameter.get=function(){return this._structArray.float32[this._pos4+16]},Object.defineProperties(t.prototype,i),t}(Qs);v.prototype.size=68;var w=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.get=function(i){return new v(this,i)},t}(el);dt("SymbolInstanceArray",w);var S=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.getoffsetX=function(i){return this.float32[1*i+0]},t}(Ja);dt("GlyphOffsetArray",S);var E=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.getx=function(i){return this.int16[3*i+0]},t.prototype.gety=function(i){return this.int16[3*i+1]},t.prototype.gettileUnitDistanceFromAnchor=function(i){return this.int16[3*i+2]},t}(aa);dt("SymbolLineVertexArray",E);var P=function(e){function t(){e.apply(this,arguments)}e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t;var i={featureIndex:{configurable:!0},sourceLayerIndex:{configurable:!0},bucketIndex:{configurable:!0}};return i.featureIndex.get=function(){return this._structArray.uint32[this._pos4+0]},i.sourceLayerIndex.get=function(){return this._structArray.uint16[this._pos2+2]},i.bucketIndex.get=function(){return this._structArray.uint16[this._pos2+3]},Object.defineProperties(t.prototype,i),t}(Qs);P.prototype.size=8;var O=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.get=function(i){return new P(this,i)},t}(au);dt("FeatureIndexArray",O);var G=Xi([{name:"a_pos",components:2,type:"Int16"}],4).members,Z=function(e){e===void 0&&(e=[]),this.segments=e};function H(e,t){return 256*(e=pe(Math.floor(e),0,255))+pe(Math.floor(t),0,255)}Z.prototype.prepareSegment=function(e,t,i,l){var f=this.segments[this.segments.length-1];return e>Z.MAX_VERTEX_ARRAY_LENGTH&&Ne("Max vertices per segment is "+Z.MAX_VERTEX_ARRAY_LENGTH+": bucket requested "+e),(!f||f.vertexLength+e>Z.MAX_VERTEX_ARRAY_LENGTH||f.sortKey!==l)&&(f={vertexOffset:t.length,primitiveOffset:i.length,vertexLength:0,primitiveLength:0},l!==void 0&&(f.sortKey=l),this.segments.push(f)),f},Z.prototype.get=function(){return this.segments},Z.prototype.destroy=function(){for(var e=0,t=this.segments;e<t.length;e+=1){var i=t[e];for(var l in i.vaos)i.vaos[l].destroy()}},Z.simpleSegment=function(e,t,i,l){return new Z([{vertexOffset:e,primitiveOffset:t,vertexLength:i,primitiveLength:l,vaos:{},sortKey:0}])},Z.MAX_VERTEX_ARRAY_LENGTH=Math.pow(2,16)-1,dt("SegmentVector",Z);var te=Xi([{name:"a_pattern_from",components:4,type:"Uint16"},{name:"a_pattern_to",components:4,type:"Uint16"},{name:"a_pixel_ratio_from",components:1,type:"Uint16"},{name:"a_pixel_ratio_to",components:1,type:"Uint16"}]),ee=I(function(e){e.exports=function(t,i){var l,f,m,x,k,A,z,C;for(f=t.length-(l=3&t.length),m=i,k=3432918353,A=461845907,C=0;C<f;)z=255&t.charCodeAt(C)|(255&t.charCodeAt(++C))<<8|(255&t.charCodeAt(++C))<<16|(255&t.charCodeAt(++C))<<24,++C,m=27492+(65535&(x=5*(65535&(m=(m^=z=(65535&(z=(z=(65535&z)*k+(((z>>>16)*k&65535)<<16)&4294967295)<<15|z>>>17))*A+(((z>>>16)*A&65535)<<16)&4294967295)<<13|m>>>19))+((5*(m>>>16)&65535)<<16)&4294967295))+((58964+(x>>>16)&65535)<<16);switch(z=0,l){case 3:z^=(255&t.charCodeAt(C+2))<<16;case 2:z^=(255&t.charCodeAt(C+1))<<8;case 1:m^=z=(65535&(z=(z=(65535&(z^=255&t.charCodeAt(C)))*k+(((z>>>16)*k&65535)<<16)&4294967295)<<15|z>>>17))*A+(((z>>>16)*A&65535)<<16)&4294967295}return m^=t.length,m=2246822507*(65535&(m^=m>>>16))+((2246822507*(m>>>16)&65535)<<16)&4294967295,m=3266489909*(65535&(m^=m>>>13))+((3266489909*(m>>>16)&65535)<<16)&4294967295,(m^=m>>>16)>>>0}}),ce=I(function(e){e.exports=function(t,i){for(var l,f=t.length,m=i^f,x=0;f>=4;)l=1540483477*(65535&(l=255&t.charCodeAt(x)|(255&t.charCodeAt(++x))<<8|(255&t.charCodeAt(++x))<<16|(255&t.charCodeAt(++x))<<24))+((1540483477*(l>>>16)&65535)<<16),m=1540483477*(65535&m)+((1540483477*(m>>>16)&65535)<<16)^(l=1540483477*(65535&(l^=l>>>24))+((1540483477*(l>>>16)&65535)<<16)),f-=4,++x;switch(f){case 3:m^=(255&t.charCodeAt(x+2))<<16;case 2:m^=(255&t.charCodeAt(x+1))<<8;case 1:m=1540483477*(65535&(m^=255&t.charCodeAt(x)))+((1540483477*(m>>>16)&65535)<<16)}return m=1540483477*(65535&(m^=m>>>13))+((1540483477*(m>>>16)&65535)<<16),(m^=m>>>15)>>>0}}),Y=ee,le=ce;Y.murmur3=ee,Y.murmur2=le;var de=function(){this.ids=[],this.positions=[],this.indexed=!1};de.prototype.add=function(e,t,i,l){this.ids.push(Ie(e)),this.positions.push(t,i,l)},de.prototype.getPositions=function(e){for(var t=Ie(e),i=0,l=this.ids.length-1;i<l;){var f=i+l>>1;this.ids[f]>=t?l=f:i=f+1}for(var m=[];this.ids[i]===t;)m.push({index:this.positions[3*i],start:this.positions[3*i+1],end:this.positions[3*i+2]}),i++;return m},de.serialize=function(e,t){var i=new Float64Array(e.ids),l=new Uint32Array(e.positions);return function f(m,x,k,A){for(;k<A;){for(var z=m[k+A>>1],C=k-1,B=A+1;;){do C++;while(m[C]<z);do B--;while(m[B]>z);if(C>=B)break;Se(m,C,B),Se(x,3*C,3*B),Se(x,3*C+1,3*B+1),Se(x,3*C+2,3*B+2)}B-k<A-B?(f(m,x,k,B),k=B+1):(f(m,x,B+1,A),A=B)}}(i,l,0,i.length-1),t&&t.push(i.buffer,l.buffer),{ids:i,positions:l}},de.deserialize=function(e){var t=new de;return t.ids=e.ids,t.positions=e.positions,t.indexed=!0,t};var _e=Math.pow(2,53)-1;function Ie(e){var t=+e;return!isNaN(t)&&t<=_e?t:Y(String(e))}function Se(e,t,i){var l=e[t];e[t]=e[i],e[i]=l}dt("FeaturePositionMap",de);var ze=function(e,t){this.gl=e.gl,this.location=t},Fe=function(e){function t(i,l){e.call(this,i,l),this.current=0}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.set=function(i){this.current!==i&&(this.current=i,this.gl.uniform1i(this.location,i))},t}(ze),Ye=function(e){function t(i,l){e.call(this,i,l),this.current=0}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.set=function(i){this.current!==i&&(this.current=i,this.gl.uniform1f(this.location,i))},t}(ze),Xe=function(e){function t(i,l){e.call(this,i,l),this.current=[0,0]}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.set=function(i){i[0]===this.current[0]&&i[1]===this.current[1]||(this.current=i,this.gl.uniform2f(this.location,i[0],i[1]))},t}(ze),pt=function(e){function t(i,l){e.call(this,i,l),this.current=[0,0,0]}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.set=function(i){i[0]===this.current[0]&&i[1]===this.current[1]&&i[2]===this.current[2]||(this.current=i,this.gl.uniform3f(this.location,i[0],i[1],i[2]))},t}(ze),Et=function(e){function t(i,l){e.call(this,i,l),this.current=[0,0,0,0]}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.set=function(i){i[0]===this.current[0]&&i[1]===this.current[1]&&i[2]===this.current[2]&&i[3]===this.current[3]||(this.current=i,this.gl.uniform4f(this.location,i[0],i[1],i[2],i[3]))},t}(ze),Pt=function(e){function t(i,l){e.call(this,i,l),this.current=dr.transparent}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.set=function(i){i.r===this.current.r&&i.g===this.current.g&&i.b===this.current.b&&i.a===this.current.a||(this.current=i,this.gl.uniform4f(this.location,i.r,i.g,i.b,i.a))},t}(ze),At=new Float32Array(16),_r=function(e){function t(i,l){e.call(this,i,l),this.current=At}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.set=function(i){if(i[12]!==this.current[12]||i[0]!==this.current[0])return this.current=i,void this.gl.uniformMatrix4fv(this.location,!1,i);for(var l=1;l<16;l++)if(i[l]!==this.current[l]){this.current=i,this.gl.uniformMatrix4fv(this.location,!1,i);break}},t}(ze);function ft(e){return[H(255*e.r,255*e.g),H(255*e.b,255*e.a)]}var Nt=function(e,t,i){this.value=e,this.uniformNames=t.map(function(l){return"u_"+l}),this.type=i};Nt.prototype.setUniform=function(e,t,i){e.set(i.constantOr(this.value))},Nt.prototype.getBinding=function(e,t,i){return this.type==="color"?new Pt(e,t):new Ye(e,t)};var Yt=function(e,t){this.uniformNames=t.map(function(i){return"u_"+i}),this.patternFrom=null,this.patternTo=null,this.pixelRatioFrom=1,this.pixelRatioTo=1};Yt.prototype.setConstantPatternPositions=function(e,t){this.pixelRatioFrom=t.pixelRatio,this.pixelRatioTo=e.pixelRatio,this.patternFrom=t.tlbr,this.patternTo=e.tlbr},Yt.prototype.setUniform=function(e,t,i,l){var f=l==="u_pattern_to"?this.patternTo:l==="u_pattern_from"?this.patternFrom:l==="u_pixel_ratio_to"?this.pixelRatioTo:l==="u_pixel_ratio_from"?this.pixelRatioFrom:null;f&&e.set(f)},Yt.prototype.getBinding=function(e,t,i){return i.substr(0,9)==="u_pattern"?new Et(e,t):new Ye(e,t)};var Ft=function(e,t,i,l){this.expression=e,this.type=i,this.maxValue=0,this.paintVertexAttributes=t.map(function(f){return{name:"a_"+f,type:"Float32",components:i==="color"?2:1,offset:0}}),this.paintVertexArray=new l};Ft.prototype.populatePaintArray=function(e,t,i,l,f){var m=this.paintVertexArray.length,x=this.expression.evaluate(new lr(0),t,{},l,[],f);this.paintVertexArray.resize(e),this._setPaintValue(m,e,x)},Ft.prototype.updatePaintArray=function(e,t,i,l){var f=this.expression.evaluate({zoom:0},i,l);this._setPaintValue(e,t,f)},Ft.prototype._setPaintValue=function(e,t,i){if(this.type==="color")for(var l=ft(i),f=e;f<t;f++)this.paintVertexArray.emplace(f,l[0],l[1]);else{for(var m=e;m<t;m++)this.paintVertexArray.emplace(m,i);this.maxValue=Math.max(this.maxValue,Math.abs(i))}},Ft.prototype.upload=function(e){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=e.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))},Ft.prototype.destroy=function(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()};var Ot=function(e,t,i,l,f,m){this.expression=e,this.uniformNames=t.map(function(x){return"u_"+x+"_t"}),this.type=i,this.useIntegerZoom=l,this.zoom=f,this.maxValue=0,this.paintVertexAttributes=t.map(function(x){return{name:"a_"+x,type:"Float32",components:i==="color"?4:2,offset:0}}),this.paintVertexArray=new m};Ot.prototype.populatePaintArray=function(e,t,i,l,f){var m=this.expression.evaluate(new lr(this.zoom),t,{},l,[],f),x=this.expression.evaluate(new lr(this.zoom+1),t,{},l,[],f),k=this.paintVertexArray.length;this.paintVertexArray.resize(e),this._setPaintValue(k,e,m,x)},Ot.prototype.updatePaintArray=function(e,t,i,l){var f=this.expression.evaluate({zoom:this.zoom},i,l),m=this.expression.evaluate({zoom:this.zoom+1},i,l);this._setPaintValue(e,t,f,m)},Ot.prototype._setPaintValue=function(e,t,i,l){if(this.type==="color")for(var f=ft(i),m=ft(l),x=e;x<t;x++)this.paintVertexArray.emplace(x,f[0],f[1],m[0],m[1]);else{for(var k=e;k<t;k++)this.paintVertexArray.emplace(k,i,l);this.maxValue=Math.max(this.maxValue,Math.abs(i),Math.abs(l))}},Ot.prototype.upload=function(e){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=e.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))},Ot.prototype.destroy=function(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()},Ot.prototype.setUniform=function(e,t){var i=this.useIntegerZoom?Math.floor(t.zoom):t.zoom,l=pe(this.expression.interpolationFactor(i,this.zoom,this.zoom+1),0,1);e.set(l)},Ot.prototype.getBinding=function(e,t,i){return new Ye(e,t)};var Xt=function(e,t,i,l,f,m){this.expression=e,this.type=t,this.useIntegerZoom=i,this.zoom=l,this.layerId=m,this.zoomInPaintVertexArray=new f,this.zoomOutPaintVertexArray=new f};Xt.prototype.populatePaintArray=function(e,t,i){var l=this.zoomInPaintVertexArray.length;this.zoomInPaintVertexArray.resize(e),this.zoomOutPaintVertexArray.resize(e),this._setPaintValues(l,e,t.patterns&&t.patterns[this.layerId],i)},Xt.prototype.updatePaintArray=function(e,t,i,l,f){this._setPaintValues(e,t,i.patterns&&i.patterns[this.layerId],f)},Xt.prototype._setPaintValues=function(e,t,i,l){if(l&&i){var f=l[i.min],m=l[i.mid],x=l[i.max];if(f&&m&&x)for(var k=e;k<t;k++)this.zoomInPaintVertexArray.emplace(k,m.tl[0],m.tl[1],m.br[0],m.br[1],f.tl[0],f.tl[1],f.br[0],f.br[1],m.pixelRatio,f.pixelRatio),this.zoomOutPaintVertexArray.emplace(k,m.tl[0],m.tl[1],m.br[0],m.br[1],x.tl[0],x.tl[1],x.br[0],x.br[1],m.pixelRatio,x.pixelRatio)}},Xt.prototype.upload=function(e){this.zoomInPaintVertexArray&&this.zoomInPaintVertexArray.arrayBuffer&&this.zoomOutPaintVertexArray&&this.zoomOutPaintVertexArray.arrayBuffer&&(this.zoomInPaintVertexBuffer=e.createVertexBuffer(this.zoomInPaintVertexArray,te.members,this.expression.isStateDependent),this.zoomOutPaintVertexBuffer=e.createVertexBuffer(this.zoomOutPaintVertexArray,te.members,this.expression.isStateDependent))},Xt.prototype.destroy=function(){this.zoomOutPaintVertexBuffer&&this.zoomOutPaintVertexBuffer.destroy(),this.zoomInPaintVertexBuffer&&this.zoomInPaintVertexBuffer.destroy()};var Lt=function(e,t,i){this.binders={},this._buffers=[];var l=[];for(var f in e.paint._values)if(i(f)){var m=e.paint.get(f);if(m instanceof vn&&bo(m.property.specification)){var x=Fi(f,e.type),k=m.value,A=m.property.specification.type,z=m.property.useIntegerZoom,C=m.property.specification["property-type"],B=C==="cross-faded"||C==="cross-faded-data-driven";if(k.kind==="constant")this.binders[f]=B?new Yt(k.value,x):new Nt(k.value,x,A),l.push("/u_"+f);else if(k.kind==="source"||B){var V=ui(f,A,"source");this.binders[f]=B?new Xt(k,A,z,t,V,e.id):new Ft(k,x,A,V),l.push("/a_"+f)}else{var j=ui(f,A,"composite");this.binders[f]=new Ot(k,x,A,z,t,j),l.push("/z_"+f)}}}this.cacheKey=l.sort().join("")};Lt.prototype.getMaxValue=function(e){var t=this.binders[e];return t instanceof Ft||t instanceof Ot?t.maxValue:0},Lt.prototype.populatePaintArrays=function(e,t,i,l,f){for(var m in this.binders){var x=this.binders[m];(x instanceof Ft||x instanceof Ot||x instanceof Xt)&&x.populatePaintArray(e,t,i,l,f)}},Lt.prototype.setConstantPatternPositions=function(e,t){for(var i in this.binders){var l=this.binders[i];l instanceof Yt&&l.setConstantPatternPositions(e,t)}},Lt.prototype.updatePaintArrays=function(e,t,i,l,f){var m=!1;for(var x in e)for(var k=0,A=t.getPositions(x);k<A.length;k+=1){var z=A[k],C=i.feature(z.index);for(var B in this.binders){var V=this.binders[B];if((V instanceof Ft||V instanceof Ot||V instanceof Xt)&&V.expression.isStateDependent===!0){var j=l.paint.get(B);V.expression=j.value,V.updatePaintArray(z.start,z.end,C,e[x],f),m=!0}}}return m},Lt.prototype.defines=function(){var e=[];for(var t in this.binders){var i=this.binders[t];(i instanceof Nt||i instanceof Yt)&&e.push.apply(e,i.uniformNames.map(function(l){return"#define HAS_UNIFORM_"+l}))}return e},Lt.prototype.getBinderAttributes=function(){var e=[];for(var t in this.binders){var i=this.binders[t];if(i instanceof Ft||i instanceof Ot)for(var l=0;l<i.paintVertexAttributes.length;l++)e.push(i.paintVertexAttributes[l].name);else if(i instanceof Xt)for(var f=0;f<te.members.length;f++)e.push(te.members[f].name)}return e},Lt.prototype.getBinderUniforms=function(){var e=[];for(var t in this.binders){var i=this.binders[t];if(i instanceof Nt||i instanceof Yt||i instanceof Ot)for(var l=0,f=i.uniformNames;l<f.length;l+=1)e.push(f[l])}return e},Lt.prototype.getPaintVertexBuffers=function(){return this._buffers},Lt.prototype.getUniforms=function(e,t){var i=[];for(var l in this.binders){var f=this.binders[l];if(f instanceof Nt||f instanceof Yt||f instanceof Ot)for(var m=0,x=f.uniformNames;m<x.length;m+=1){var k=x[m];if(t[k]){var A=f.getBinding(e,t[k],k);i.push({name:k,property:l,binding:A})}}}return i},Lt.prototype.setUniforms=function(e,t,i,l){for(var f=0,m=t;f<m.length;f+=1){var x=m[f],k=x.name,A=x.property;this.binders[A].setUniform(x.binding,l,i.get(A),k)}},Lt.prototype.updatePaintBuffers=function(e){for(var t in this._buffers=[],this.binders){var i=this.binders[t];if(e&&i instanceof Xt){var l=e.fromScale===2?i.zoomInPaintVertexBuffer:i.zoomOutPaintVertexBuffer;l&&this._buffers.push(l)}else(i instanceof Ft||i instanceof Ot)&&i.paintVertexBuffer&&this._buffers.push(i.paintVertexBuffer)}},Lt.prototype.upload=function(e){for(var t in this.binders){var i=this.binders[t];(i instanceof Ft||i instanceof Ot||i instanceof Xt)&&i.upload(e)}this.updatePaintBuffers()},Lt.prototype.destroy=function(){for(var e in this.binders){var t=this.binders[e];(t instanceof Ft||t instanceof Ot||t instanceof Xt)&&t.destroy()}};var Ct=function(e,t,i){i===void 0&&(i=function(){return!0}),this.programConfigurations={};for(var l=0,f=e;l<f.length;l+=1){var m=f[l];this.programConfigurations[m.id]=new Lt(m,t,i)}this.needsUpload=!1,this._featureMap=new de,this._bufferOffset=0};function Fi(e,t){return{"text-opacity":["opacity"],"icon-opacity":["opacity"],"text-color":["fill_color"],"icon-color":["fill_color"],"text-halo-color":["halo_color"],"icon-halo-color":["halo_color"],"text-halo-blur":["halo_blur"],"icon-halo-blur":["halo_blur"],"text-halo-width":["halo_width"],"icon-halo-width":["halo_width"],"line-gap-width":["gapwidth"],"line-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-extrusion-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"]}[e]||[e.replace(t+"-","").replace(/-/g,"_")]}function ui(e,t,i){var l={color:{source:Go,composite:tl},number:{source:Ja,composite:Go}},f=function(m){return{"line-pattern":{source:Ia,composite:Ia},"fill-pattern":{source:Ia,composite:Ia},"fill-extrusion-pattern":{source:Ia,composite:Ia}}[m]}(e);return f&&f[i]||l[t][i]}Ct.prototype.populatePaintArrays=function(e,t,i,l,f,m){for(var x in this.programConfigurations)this.programConfigurations[x].populatePaintArrays(e,t,l,f,m);t.id!==void 0&&this._featureMap.add(t.id,i,this._bufferOffset,e),this._bufferOffset=e,this.needsUpload=!0},Ct.prototype.updatePaintArrays=function(e,t,i,l){for(var f=0,m=i;f<m.length;f+=1){var x=m[f];this.needsUpload=this.programConfigurations[x.id].updatePaintArrays(e,this._featureMap,t,x,l)||this.needsUpload}},Ct.prototype.get=function(e){return this.programConfigurations[e]},Ct.prototype.upload=function(e){if(this.needsUpload){for(var t in this.programConfigurations)this.programConfigurations[t].upload(e);this.needsUpload=!1}},Ct.prototype.destroy=function(){for(var e in this.programConfigurations)this.programConfigurations[e].destroy()},dt("ConstantBinder",Nt),dt("CrossFadedConstantBinder",Yt),dt("SourceExpressionBinder",Ft),dt("CrossFadedCompositeBinder",Xt),dt("CompositeExpressionBinder",Ot),dt("ProgramConfiguration",Lt,{omit:["_buffers"]}),dt("ProgramConfigurationSet",Ct);var pn=Math.pow(2,14)-1,Wi=-pn-1;function ii(e){for(var t=8192/e.extent,i=e.loadGeometry(),l=0;l<i.length;l++)for(var f=i[l],m=0;m<f.length;m++){var x=f[m],k=Math.round(x.x*t),A=Math.round(x.y*t);x.x=pe(k,Wi,pn),x.y=pe(A,Wi,pn),(k<x.x||k>x.x+1||A<x.y||A>x.y+1)&&Ne("Geometry exceeds allowed extent, reduce your vector tile buffer size")}return i}function mi(e,t){return{type:e.type,id:e.id,properties:e.properties,geometry:t?ii(e):[]}}function jn(e,t,i,l,f){e.emplaceBack(2*t+(l+1)/2,2*i+(f+1)/2)}var xn=function(e){this.zoom=e.zoom,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map(function(t){return t.id}),this.index=e.index,this.hasPattern=!1,this.layoutVertexArray=new Eo,this.indexArray=new Wa,this.segments=new Z,this.programConfigurations=new Ct(e.layers,e.zoom),this.stateDependentLayerIds=this.layers.filter(function(t){return t.isStateDependent()}).map(function(t){return t.id})};function Qa(e,t){for(var i=0;i<e.length;i++)if(Aa(t,e[i]))return!0;for(var l=0;l<t.length;l++)if(Aa(e,t[l]))return!0;return!!ws(e,t)}function zn(e,t,i){return!!Aa(e,t)||!!$a(t,e,i)}function _a(e,t){if(e.length===1)return Ss(t,e[0]);for(var i=0;i<t.length;i++)for(var l=t[i],f=0;f<l.length;f++)if(Aa(e,l[f]))return!0;for(var m=0;m<e.length;m++)if(Ss(t,e[m]))return!0;for(var x=0;x<t.length;x++)if(ws(e,t[x]))return!0;return!1}function oa(e,t,i){if(e.length>1){if(ws(e,t))return!0;for(var l=0;l<t.length;l++)if($a(t[l],e,i))return!0}for(var f=0;f<e.length;f++)if($a(e[f],t,i))return!0;return!1}function ws(e,t){if(e.length===0||t.length===0)return!1;for(var i=0;i<e.length-1;i++)for(var l=e[i],f=e[i+1],m=0;m<t.length-1;m++)if(Ho(l,f,t[m],t[m+1]))return!0;return!1}function Ho(e,t,i,l){return Rt(e,i,l)!==Rt(t,i,l)&&Rt(e,t,i)!==Rt(e,t,l)}function $a(e,t,i){var l=i*i;if(t.length===1)return e.distSqr(t[0])<l;for(var f=1;f<t.length;f++)if(Xo(e,t[f-1],t[f])<l)return!0;return!1}function Xo(e,t,i){var l=t.distSqr(i);if(l===0)return e.distSqr(t);var f=((e.x-t.x)*(i.x-t.x)+(e.y-t.y)*(i.y-t.y))/l;return e.distSqr(f<0?t:f>1?i:i.sub(t)._mult(f)._add(t))}function Ss(e,t){for(var i,l,f,m=!1,x=0;x<e.length;x++)for(var k=0,A=(i=e[x]).length-1;k<i.length;A=k++)(l=i[k]).y>t.y!=(f=i[A]).y>t.y&&t.x<(f.x-l.x)*(t.y-l.y)/(f.y-l.y)+l.x&&(m=!m);return m}function Aa(e,t){for(var i=!1,l=0,f=e.length-1;l<e.length;f=l++){var m=e[l],x=e[f];m.y>t.y!=x.y>t.y&&t.x<(x.x-m.x)*(t.y-m.y)/(x.y-m.y)+m.x&&(i=!i)}return i}function ks(e,t,i){var l=i[0],f=i[2];if(e.x<l.x&&t.x<l.x||e.x>f.x&&t.x>f.x||e.y<l.y&&t.y<l.y||e.y>f.y&&t.y>f.y)return!1;var m=Rt(e,t,i[0]);return m!==Rt(e,t,i[1])||m!==Rt(e,t,i[2])||m!==Rt(e,t,i[3])}function za(e,t,i){var l=t.paint.get(e).value;return l.kind==="constant"?l.value:i.programConfigurations.get(t.id).getMaxValue(e)}function Ni(e){return Math.sqrt(e[0]*e[0]+e[1]*e[1])}function La(e,t,i,l,f){if(!t[0]&&!t[1])return e;var m=F.convert(t)._mult(f);i==="viewport"&&m._rotate(-l);for(var x=[],k=0;k<e.length;k++)x.push(e[k].sub(m));return x}xn.prototype.populate=function(e,t,i){var l=this.layers[0],f=[],m=null;l.type==="circle"&&(m=l.layout.get("circle-sort-key"));for(var x=0,k=e;x<k.length;x+=1){var A=k[x],z=A.feature,C=A.id,B=A.index,V=A.sourceLayerIndex,j=this.layers[0]._featureFilter.needGeometry,J=mi(z,j);if(this.layers[0]._featureFilter.filter(new lr(this.zoom),J,i)){var $=m?m.evaluate(J,{},i):void 0,he={id:C,properties:z.properties,type:z.type,sourceLayerIndex:V,index:B,geometry:j?J.geometry:ii(z),patterns:{},sortKey:$};f.push(he)}}m&&f.sort(function(et,wt){return et.sortKey-wt.sortKey});for(var ie=0,me=f;ie<me.length;ie+=1){var ve=me[ie],we=ve.geometry,ke=ve.index,Pe=ve.sourceLayerIndex,qe=e[ke].feature;this.addFeature(ve,we,ke,i),t.featureIndex.insert(qe,we,ke,Pe,this.index)}},xn.prototype.update=function(e,t,i){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(e,t,this.stateDependentLayers,i)},xn.prototype.isEmpty=function(){return this.layoutVertexArray.length===0},xn.prototype.uploadPending=function(){return!this.uploaded||this.programConfigurations.needsUpload},xn.prototype.upload=function(e){this.uploaded||(this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,G),this.indexBuffer=e.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(e),this.uploaded=!0},xn.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())},xn.prototype.addFeature=function(e,t,i,l){for(var f=0,m=t;f<m.length;f+=1)for(var x=0,k=m[f];x<k.length;x+=1){var A=k[x],z=A.x,C=A.y;if(!(z<0||z>=8192||C<0||C>=8192)){var B=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray,e.sortKey),V=B.vertexLength;jn(this.layoutVertexArray,z,C,-1,-1),jn(this.layoutVertexArray,z,C,1,-1),jn(this.layoutVertexArray,z,C,1,1),jn(this.layoutVertexArray,z,C,-1,1),this.indexArray.emplaceBack(V,V+1,V+2),this.indexArray.emplaceBack(V,V+3,V+2),B.vertexLength+=4,B.primitiveLength+=2}}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,e,i,{},l)},dt("CircleBucket",xn,{omit:["layers"]});var eo=new sn({"circle-sort-key":new gt(U.layout_circle["circle-sort-key"])}),Io={paint:new sn({"circle-radius":new gt(U.paint_circle["circle-radius"]),"circle-color":new gt(U.paint_circle["circle-color"]),"circle-blur":new gt(U.paint_circle["circle-blur"]),"circle-opacity":new gt(U.paint_circle["circle-opacity"]),"circle-translate":new kt(U.paint_circle["circle-translate"]),"circle-translate-anchor":new kt(U.paint_circle["circle-translate-anchor"]),"circle-pitch-scale":new kt(U.paint_circle["circle-pitch-scale"]),"circle-pitch-alignment":new kt(U.paint_circle["circle-pitch-alignment"]),"circle-stroke-width":new gt(U.paint_circle["circle-stroke-width"]),"circle-stroke-color":new gt(U.paint_circle["circle-stroke-color"]),"circle-stroke-opacity":new gt(U.paint_circle["circle-stroke-opacity"])}),layout:eo},Er=typeof Float32Array<"u"?Float32Array:Array;function $n(e){return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}function Pn(e,t,i){var l=t[0],f=t[1],m=t[2],x=t[3],k=t[4],A=t[5],z=t[6],C=t[7],B=t[8],V=t[9],j=t[10],J=t[11],$=t[12],he=t[13],ie=t[14],me=t[15],ve=i[0],we=i[1],ke=i[2],Pe=i[3];return e[0]=ve*l+we*k+ke*B+Pe*$,e[1]=ve*f+we*A+ke*V+Pe*he,e[2]=ve*m+we*z+ke*j+Pe*ie,e[3]=ve*x+we*C+ke*J+Pe*me,e[4]=(ve=i[4])*l+(we=i[5])*k+(ke=i[6])*B+(Pe=i[7])*$,e[5]=ve*f+we*A+ke*V+Pe*he,e[6]=ve*m+we*z+ke*j+Pe*ie,e[7]=ve*x+we*C+ke*J+Pe*me,e[8]=(ve=i[8])*l+(we=i[9])*k+(ke=i[10])*B+(Pe=i[11])*$,e[9]=ve*f+we*A+ke*V+Pe*he,e[10]=ve*m+we*z+ke*j+Pe*ie,e[11]=ve*x+we*C+ke*J+Pe*me,e[12]=(ve=i[12])*l+(we=i[13])*k+(ke=i[14])*B+(Pe=i[15])*$,e[13]=ve*f+we*A+ke*V+Pe*he,e[14]=ve*m+we*z+ke*j+Pe*ie,e[15]=ve*x+we*C+ke*J+Pe*me,e}Math.hypot||(Math.hypot=function(){for(var e=arguments,t=0,i=arguments.length;i--;)t+=e[i]*e[i];return Math.sqrt(t)});var Ao,Hh=Pn;function rl(e,t,i){var l=t[0],f=t[1],m=t[2],x=t[3];return e[0]=i[0]*l+i[4]*f+i[8]*m+i[12]*x,e[1]=i[1]*l+i[5]*f+i[9]*m+i[13]*x,e[2]=i[2]*l+i[6]*f+i[10]*m+i[14]*x,e[3]=i[3]*l+i[7]*f+i[11]*m+i[15]*x,e}Ao=new Er(3),Er!=Float32Array&&(Ao[0]=0,Ao[1]=0,Ao[2]=0),function(){var e=new Er(4);Er!=Float32Array&&(e[0]=0,e[1]=0,e[2]=0,e[3]=0)}();var Xh=(function(){var e=new Er(2);Er!=Float32Array&&(e[0]=0,e[1]=0)}(),function(e){function t(i){e.call(this,i,Io)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.createBucket=function(i){return new xn(i)},t.prototype.queryRadius=function(i){var l=i;return za("circle-radius",this,l)+za("circle-stroke-width",this,l)+Ni(this.paint.get("circle-translate"))},t.prototype.queryIntersectsFeature=function(i,l,f,m,x,k,A,z){for(var C=La(i,this.paint.get("circle-translate"),this.paint.get("circle-translate-anchor"),k.angle,A),B=this.paint.get("circle-radius").evaluate(l,f)+this.paint.get("circle-stroke-width").evaluate(l,f),V=this.paint.get("circle-pitch-alignment")==="map",j=V?C:function(qe,et){return qe.map(function(wt){return Es(wt,et)})}(C,z),J=V?B*A:B,$=0,he=m;$<he.length;$+=1)for(var ie=0,me=he[$];ie<me.length;ie+=1){var ve=me[ie],we=V?ve:Es(ve,z),ke=J,Pe=rl([],[ve.x,ve.y,0,1],z);if(this.paint.get("circle-pitch-scale")==="viewport"&&this.paint.get("circle-pitch-alignment")==="map"?ke*=Pe[3]/k.cameraToCenterDistance:this.paint.get("circle-pitch-scale")==="map"&&this.paint.get("circle-pitch-alignment")==="viewport"&&(ke*=k.cameraToCenterDistance/Pe[3]),zn(j,we,ke))return!0}return!1},t}(Ta));function Es(e,t){var i=rl([],[e.x,e.y,0,1],t);return new F(i[0]/i[3],i[1]/i[3])}var Tc=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t}(xn);function Wo(e,t,i,l){var f=t.width,m=t.height;if(l){if(l instanceof Uint8ClampedArray)l=new Uint8Array(l.buffer);else if(l.length!==f*m*i)throw new RangeError("mismatched image size")}else l=new Uint8Array(f*m*i);return e.width=f,e.height=m,e.data=l,e}function il(e,t,i){var l=t.width,f=t.height;if(l!==e.width||f!==e.height){var m=Wo({},{width:l,height:f},i);Wh(e,m,{x:0,y:0},{x:0,y:0},{width:Math.min(e.width,l),height:Math.min(e.height,f)},i),e.width=l,e.height=f,e.data=m.data}}function Wh(e,t,i,l,f,m){if(f.width===0||f.height===0)return t;if(f.width>e.width||f.height>e.height||i.x>e.width-f.width||i.y>e.height-f.height)throw new RangeError("out of range source coordinates for image copy");if(f.width>t.width||f.height>t.height||l.x>t.width-f.width||l.y>t.height-f.height)throw new RangeError("out of range destination coordinates for image copy");for(var x=e.data,k=t.data,A=0;A<f.height;A++)for(var z=((i.y+A)*e.width+i.x)*m,C=((l.y+A)*t.width+l.x)*m,B=0;B<f.width*m;B++)k[C+B]=x[z+B];return t}dt("HeatmapBucket",Tc,{omit:["layers"]});var Ts=function(e,t){Wo(this,e,1,t)};Ts.prototype.resize=function(e){il(this,e,1)},Ts.prototype.clone=function(){return new Ts({width:this.width,height:this.height},new Uint8Array(this.data))},Ts.copy=function(e,t,i,l,f){Wh(e,t,i,l,f,1)};var Gn=function(e,t){Wo(this,e,4,t)};Gn.prototype.resize=function(e){il(this,e,4)},Gn.prototype.replace=function(e,t){t?this.data.set(e):this.data=e instanceof Uint8ClampedArray?new Uint8Array(e.buffer):e},Gn.prototype.clone=function(){return new Gn({width:this.width,height:this.height},new Uint8Array(this.data))},Gn.copy=function(e,t,i,l,f){Wh(e,t,i,l,f,4)},dt("AlphaImage",Ts),dt("RGBAImage",Gn);var Ey={paint:new sn({"heatmap-radius":new gt(U.paint_heatmap["heatmap-radius"]),"heatmap-weight":new gt(U.paint_heatmap["heatmap-weight"]),"heatmap-intensity":new kt(U.paint_heatmap["heatmap-intensity"]),"heatmap-color":new ga(U.paint_heatmap["heatmap-color"]),"heatmap-opacity":new kt(U.paint_heatmap["heatmap-opacity"])})};function Wp(e){var t={},i=e.resolution||256,l=e.clips?e.clips.length:1,f=e.image||new Gn({width:i,height:l}),m=function(J,$,he){t[e.evaluationKey]=he;var ie=e.expression.evaluate(t);f.data[J+$+0]=Math.floor(255*ie.r/ie.a),f.data[J+$+1]=Math.floor(255*ie.g/ie.a),f.data[J+$+2]=Math.floor(255*ie.b/ie.a),f.data[J+$+3]=Math.floor(255*ie.a)};if(e.clips)for(var x=0,k=0;x<l;++x,k+=4*i)for(var A=0,z=0;A<i;A++,z+=4){var C=A/(i-1),B=e.clips[x];m(k,z,B.start*(1-C)+B.end*C)}else for(var V=0,j=0;V<i;V++,j+=4)m(0,j,V/(i-1));return f}var Ty=function(e){function t(i){e.call(this,i,Ey),this._updateColorRamp()}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.createBucket=function(i){return new Tc(i)},t.prototype._handleSpecialPaintPropertyUpdate=function(i){i==="heatmap-color"&&this._updateColorRamp()},t.prototype._updateColorRamp=function(){this.colorRamp=Wp({expression:this._transitionablePaint._values["heatmap-color"].value.expression,evaluationKey:"heatmapDensity",image:this.colorRamp}),this.colorRampTexture=null},t.prototype.resize=function(){this.heatmapFbo&&(this.heatmapFbo.destroy(),this.heatmapFbo=null)},t.prototype.queryRadius=function(){return 0},t.prototype.queryIntersectsFeature=function(){return!1},t.prototype.hasOffscreenPass=function(){return this.paint.get("heatmap-opacity")!==0&&this.visibility!=="none"},t}(Ta),Iy={paint:new sn({"hillshade-illumination-direction":new kt(U.paint_hillshade["hillshade-illumination-direction"]),"hillshade-illumination-anchor":new kt(U.paint_hillshade["hillshade-illumination-anchor"]),"hillshade-exaggeration":new kt(U.paint_hillshade["hillshade-exaggeration"]),"hillshade-shadow-color":new kt(U.paint_hillshade["hillshade-shadow-color"]),"hillshade-highlight-color":new kt(U.paint_hillshade["hillshade-highlight-color"]),"hillshade-accent-color":new kt(U.paint_hillshade["hillshade-accent-color"])})},Ay=function(e){function t(i){e.call(this,i,Iy)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.hasOffscreenPass=function(){return this.paint.get("hillshade-exaggeration")!==0&&this.visibility!=="none"},t}(Ta),zy=Xi([{name:"a_pos",components:2,type:"Int16"}],4).members,Yh=Ic,Py=Ic;function Ic(e,t,i){i=i||2;var l,f,m,x,k,A,z,C=t&&t.length,B=C?t[0]*i:e.length,V=Yp(e,0,B,i,!0),j=[];if(!V||V.next===V.prev)return j;if(C&&(V=function($,he,ie,me){var ve,we,ke,Pe=[];for(ve=0,we=he.length;ve<we;ve++)(ke=Yp($,he[ve]*me,ve<we-1?he[ve+1]*me:$.length,me,!1))===ke.next&&(ke.steiner=!0),Pe.push(Fy(ke));for(Pe.sort(Ry),ve=0;ve<Pe.length;ve++)By(Pe[ve],ie),ie=Yo(ie,ie.next);return ie}(e,t,V,i)),e.length>80*i){l=m=e[0],f=x=e[1];for(var J=i;J<B;J+=i)(k=e[J])<l&&(l=k),(A=e[J+1])<f&&(f=A),k>m&&(m=k),A>x&&(x=A);z=(z=Math.max(m-l,x-f))!==0?1/z:0}return su(V,j,i,l,f,z),j}function Yp(e,t,i,l,f){var m,x;if(f===$h(e,t,i,l)>0)for(m=t;m<i;m+=l)x=$p(m,e[m],e[m+1],x);else for(m=i-l;m>=t;m-=l)x=$p(m,e[m],e[m+1],x);return x&&Ac(x,x.next)&&(uu(x),x=x.next),x}function Yo(e,t){if(!e)return e;t||(t=e);var i,l=e;do if(i=!1,l.steiner||!Ac(l,l.next)&&Mi(l.prev,l,l.next)!==0)l=l.next;else{if(uu(l),(l=t=l.prev)===l.next)break;i=!0}while(i||l!==t);return t}function su(e,t,i,l,f,m,x){if(e){!x&&m&&function(C,B,V,j){var J=C;do J.z===null&&(J.z=Jh(J.x,J.y,B,V,j)),J.prevZ=J.prev,J.nextZ=J.next,J=J.next;while(J!==C);J.prevZ.nextZ=null,J.prevZ=null,function($){var he,ie,me,ve,we,ke,Pe,qe,et=1;do{for(ie=$,$=null,we=null,ke=0;ie;){for(ke++,me=ie,Pe=0,he=0;he<et&&(Pe++,me=me.nextZ);he++);for(qe=et;Pe>0||qe>0&&me;)Pe!==0&&(qe===0||!me||ie.z<=me.z)?(ve=ie,ie=ie.nextZ,Pe--):(ve=me,me=me.nextZ,qe--),we?we.nextZ=ve:$=ve,ve.prevZ=we,we=ve;ie=me}we.nextZ=null,et*=2}while(ke>1)}(J)}(e,l,f,m);for(var k,A,z=e;e.prev!==e.next;)if(k=e.prev,A=e.next,m?My(e,l,f,m):Cy(e))t.push(k.i/i),t.push(e.i/i),t.push(A.i/i),uu(e),e=A.next,z=A.next;else if((e=A)===z){x?x===1?su(e=Dy(Yo(e),t,i),t,i,l,f,m,2):x===2&&Ly(e,t,i,l,f,m):su(Yo(e),t,i,l,f,m,1);break}}}function Cy(e){var t=e.prev,i=e,l=e.next;if(Mi(t,i,l)>=0)return!1;for(var f=e.next.next;f!==e.prev;){if(nl(t.x,t.y,i.x,i.y,l.x,l.y,f.x,f.y)&&Mi(f.prev,f,f.next)>=0)return!1;f=f.next}return!0}function My(e,t,i,l){var f=e.prev,m=e,x=e.next;if(Mi(f,m,x)>=0)return!1;for(var k=f.x>m.x?f.x>x.x?f.x:x.x:m.x>x.x?m.x:x.x,A=f.y>m.y?f.y>x.y?f.y:x.y:m.y>x.y?m.y:x.y,z=Jh(f.x<m.x?f.x<x.x?f.x:x.x:m.x<x.x?m.x:x.x,f.y<m.y?f.y<x.y?f.y:x.y:m.y<x.y?m.y:x.y,t,i,l),C=Jh(k,A,t,i,l),B=e.prevZ,V=e.nextZ;B&&B.z>=z&&V&&V.z<=C;){if(B!==e.prev&&B!==e.next&&nl(f.x,f.y,m.x,m.y,x.x,x.y,B.x,B.y)&&Mi(B.prev,B,B.next)>=0||(B=B.prevZ,V!==e.prev&&V!==e.next&&nl(f.x,f.y,m.x,m.y,x.x,x.y,V.x,V.y)&&Mi(V.prev,V,V.next)>=0))return!1;V=V.nextZ}for(;B&&B.z>=z;){if(B!==e.prev&&B!==e.next&&nl(f.x,f.y,m.x,m.y,x.x,x.y,B.x,B.y)&&Mi(B.prev,B,B.next)>=0)return!1;B=B.prevZ}for(;V&&V.z<=C;){if(V!==e.prev&&V!==e.next&&nl(f.x,f.y,m.x,m.y,x.x,x.y,V.x,V.y)&&Mi(V.prev,V,V.next)>=0)return!1;V=V.nextZ}return!0}function Dy(e,t,i){var l=e;do{var f=l.prev,m=l.next.next;!Ac(f,m)&&Jp(f,l,l.next,m)&&lu(f,m)&&lu(m,f)&&(t.push(f.i/i),t.push(l.i/i),t.push(m.i/i),uu(l),uu(l.next),l=e=m),l=l.next}while(l!==e);return Yo(l)}function Ly(e,t,i,l,f,m){var x=e;do{for(var k=x.next.next;k!==x.prev;){if(x.i!==k.i&&Ny(x,k)){var A=Qp(x,k);return x=Yo(x,x.next),A=Yo(A,A.next),su(x,t,i,l,f,m),void su(A,t,i,l,f,m)}k=k.next}x=x.next}while(x!==e)}function Ry(e,t){return e.x-t.x}function By(e,t){if(t=function(l,f){var m,x=f,k=l.x,A=l.y,z=-1/0;do{if(A<=x.y&&A>=x.next.y&&x.next.y!==x.y){var C=x.x+(A-x.y)*(x.next.x-x.x)/(x.next.y-x.y);if(C<=k&&C>z){if(z=C,C===k){if(A===x.y)return x;if(A===x.next.y)return x.next}m=x.x<x.next.x?x:x.next}}x=x.next}while(x!==f);if(!m)return null;if(k===z)return m;var B,V=m,j=m.x,J=m.y,$=1/0;x=m;do k>=x.x&&x.x>=j&&k!==x.x&&nl(A<J?k:z,A,j,J,A<J?z:k,A,x.x,x.y)&&(B=Math.abs(A-x.y)/(k-x.x),lu(x,l)&&(B<$||B===$&&(x.x>m.x||x.x===m.x&&Oy(m,x)))&&(m=x,$=B)),x=x.next;while(x!==V);return m}(e,t)){var i=Qp(t,e);Yo(t,t.next),Yo(i,i.next)}}function Oy(e,t){return Mi(e.prev,e,t.prev)<0&&Mi(t.next,e,e.next)<0}function Jh(e,t,i,l,f){return(e=1431655765&((e=858993459&((e=252645135&((e=16711935&((e=32767*(e-i)*f)|e<<8))|e<<4))|e<<2))|e<<1))|(t=1431655765&((t=858993459&((t=252645135&((t=16711935&((t=32767*(t-l)*f)|t<<8))|t<<4))|t<<2))|t<<1))<<1}function Fy(e){var t=e,i=e;do(t.x<i.x||t.x===i.x&&t.y<i.y)&&(i=t),t=t.next;while(t!==e);return i}function nl(e,t,i,l,f,m,x,k){return(f-x)*(t-k)-(e-x)*(m-k)>=0&&(e-x)*(l-k)-(i-x)*(t-k)>=0&&(i-x)*(m-k)-(f-x)*(l-k)>=0}function Ny(e,t){return e.next.i!==t.i&&e.prev.i!==t.i&&!function(i,l){var f=i;do{if(f.i!==i.i&&f.next.i!==i.i&&f.i!==l.i&&f.next.i!==l.i&&Jp(f,f.next,i,l))return!0;f=f.next}while(f!==i);return!1}(e,t)&&(lu(e,t)&&lu(t,e)&&function(i,l){var f=i,m=!1,x=(i.x+l.x)/2,k=(i.y+l.y)/2;do f.y>k!=f.next.y>k&&f.next.y!==f.y&&x<(f.next.x-f.x)*(k-f.y)/(f.next.y-f.y)+f.x&&(m=!m),f=f.next;while(f!==i);return m}(e,t)&&(Mi(e.prev,e,t.prev)||Mi(e,t.prev,t))||Ac(e,t)&&Mi(e.prev,e,e.next)>0&&Mi(t.prev,t,t.next)>0)}function Mi(e,t,i){return(t.y-e.y)*(i.x-t.x)-(t.x-e.x)*(i.y-t.y)}function Ac(e,t){return e.x===t.x&&e.y===t.y}function Jp(e,t,i,l){var f=Pc(Mi(e,t,i)),m=Pc(Mi(e,t,l)),x=Pc(Mi(i,l,e)),k=Pc(Mi(i,l,t));return f!==m&&x!==k||!(f!==0||!zc(e,i,t))||!(m!==0||!zc(e,l,t))||!(x!==0||!zc(i,e,l))||!(k!==0||!zc(i,t,l))}function zc(e,t,i){return t.x<=Math.max(e.x,i.x)&&t.x>=Math.min(e.x,i.x)&&t.y<=Math.max(e.y,i.y)&&t.y>=Math.min(e.y,i.y)}function Pc(e){return e>0?1:e<0?-1:0}function lu(e,t){return Mi(e.prev,e,e.next)<0?Mi(e,t,e.next)>=0&&Mi(e,e.prev,t)>=0:Mi(e,t,e.prev)<0||Mi(e,e.next,t)<0}function Qp(e,t){var i=new Qh(e.i,e.x,e.y),l=new Qh(t.i,t.x,t.y),f=e.next,m=t.prev;return e.next=t,t.prev=e,i.next=f,f.prev=i,l.next=i,i.prev=l,m.next=l,l.prev=m,l}function $p(e,t,i,l){var f=new Qh(e,t,i);return l?(f.next=l.next,f.prev=l,l.next.prev=f,l.next=f):(f.prev=f,f.next=f),f}function uu(e){e.next.prev=e.prev,e.prev.next=e.next,e.prevZ&&(e.prevZ.nextZ=e.nextZ),e.nextZ&&(e.nextZ.prevZ=e.prevZ)}function Qh(e,t,i){this.i=e,this.x=t,this.y=i,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}function $h(e,t,i,l){for(var f=0,m=t,x=i-l;m<i;m+=l)f+=(e[x]-e[m])*(e[m+1]+e[x+1]),x=m;return f}function Vy(e,t,i,l,f){(function m(x,k,A,z,C){for(;z>A;){if(z-A>600){var B=z-A+1,V=k-A+1,j=Math.log(B),J=.5*Math.exp(2*j/3),$=.5*Math.sqrt(j*J*(B-J)/B)*(V-B/2<0?-1:1);m(x,k,Math.max(A,Math.floor(k-V*J/B+$)),Math.min(z,Math.floor(k+(B-V)*J/B+$)),C)}var he=x[k],ie=A,me=z;for(cu(x,A,k),C(x[z],he)>0&&cu(x,A,z);ie<me;){for(cu(x,ie,me),ie++,me--;C(x[ie],he)<0;)ie++;for(;C(x[me],he)>0;)me--}C(x[A],he)===0?cu(x,A,me):cu(x,++me,z),me<=k&&(A=me+1),k<=me&&(z=me-1)}})(e,t,i||0,l||e.length-1,f||Uy)}function cu(e,t,i){var l=e[t];e[t]=e[i],e[i]=l}function Uy(e,t){return e<t?-1:e>t?1:0}function ep(e,t){var i=e.length;if(i<=1)return[e];for(var l,f,m=[],x=0;x<i;x++){var k=Me(e[x]);k!==0&&(e[x].area=Math.abs(k),f===void 0&&(f=k<0),f===k<0?(l&&m.push(l),l=[e[x]]):l.push(e[x]))}if(l&&m.push(l),t>1)for(var A=0;A<m.length;A++)m[A].length<=t||(Vy(m[A],t,1,m[A].length-1,qy),m[A]=m[A].slice(0,t));return m}function qy(e,t){return t.area-e.area}function tp(e,t,i){for(var l=i.patternDependencies,f=!1,m=0,x=t;m<x.length;m+=1){var k=x[m].paint.get(e+"-pattern");k.isConstant()||(f=!0);var A=k.constantOr(null);A&&(f=!0,l[A.to]=!0,l[A.from]=!0)}return f}function rp(e,t,i,l,f){for(var m=f.patternDependencies,x=0,k=t;x<k.length;x+=1){var A=k[x],z=A.paint.get(e+"-pattern").value;if(z.kind!=="constant"){var C=z.evaluate({zoom:l-1},i,{},f.availableImages),B=z.evaluate({zoom:l},i,{},f.availableImages),V=z.evaluate({zoom:l+1},i,{},f.availableImages);B=B&&B.name?B.name:B,V=V&&V.name?V.name:V,m[C=C&&C.name?C.name:C]=!0,m[B]=!0,m[V]=!0,i.patterns[A.id]={min:C,mid:B,max:V}}}return i}Ic.deviation=function(e,t,i,l){var f=t&&t.length,m=Math.abs($h(e,0,f?t[0]*i:e.length,i));if(f)for(var x=0,k=t.length;x<k;x++)m-=Math.abs($h(e,t[x]*i,x<k-1?t[x+1]*i:e.length,i));var A=0;for(x=0;x<l.length;x+=3){var z=l[x]*i,C=l[x+1]*i,B=l[x+2]*i;A+=Math.abs((e[z]-e[B])*(e[C+1]-e[z+1])-(e[z]-e[C])*(e[B+1]-e[z+1]))}return m===0&&A===0?0:Math.abs((A-m)/m)},Ic.flatten=function(e){for(var t=e[0][0].length,i={vertices:[],holes:[],dimensions:t},l=0,f=0;f<e.length;f++){for(var m=0;m<e[f].length;m++)for(var x=0;x<t;x++)i.vertices.push(e[f][m][x]);f>0&&i.holes.push(l+=e[f-1].length)}return i},Yh.default=Py;var Ra=function(e){this.zoom=e.zoom,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map(function(t){return t.id}),this.index=e.index,this.hasPattern=!1,this.patternFeatures=[],this.layoutVertexArray=new Eo,this.indexArray=new Wa,this.indexArray2=new xs,this.programConfigurations=new Ct(e.layers,e.zoom),this.segments=new Z,this.segments2=new Z,this.stateDependentLayerIds=this.layers.filter(function(t){return t.isStateDependent()}).map(function(t){return t.id})};Ra.prototype.populate=function(e,t,i){this.hasPattern=tp("fill",this.layers,t);for(var l=this.layers[0].layout.get("fill-sort-key"),f=[],m=0,x=e;m<x.length;m+=1){var k=x[m],A=k.feature,z=k.id,C=k.index,B=k.sourceLayerIndex,V=this.layers[0]._featureFilter.needGeometry,j=mi(A,V);if(this.layers[0]._featureFilter.filter(new lr(this.zoom),j,i)){var J=l?l.evaluate(j,{},i,t.availableImages):void 0,$={id:z,properties:A.properties,type:A.type,sourceLayerIndex:B,index:C,geometry:V?j.geometry:ii(A),patterns:{},sortKey:J};f.push($)}}l&&f.sort(function(qe,et){return qe.sortKey-et.sortKey});for(var he=0,ie=f;he<ie.length;he+=1){var me=ie[he],ve=me.geometry,we=me.index,ke=me.sourceLayerIndex;if(this.hasPattern){var Pe=rp("fill",this.layers,me,this.zoom,t);this.patternFeatures.push(Pe)}else this.addFeature(me,ve,we,i,{});t.featureIndex.insert(e[we].feature,ve,we,ke,this.index)}},Ra.prototype.update=function(e,t,i){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(e,t,this.stateDependentLayers,i)},Ra.prototype.addFeatures=function(e,t,i){for(var l=0,f=this.patternFeatures;l<f.length;l+=1){var m=f[l];this.addFeature(m,m.geometry,m.index,t,i)}},Ra.prototype.isEmpty=function(){return this.layoutVertexArray.length===0},Ra.prototype.uploadPending=function(){return!this.uploaded||this.programConfigurations.needsUpload},Ra.prototype.upload=function(e){this.uploaded||(this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,zy),this.indexBuffer=e.createIndexBuffer(this.indexArray),this.indexBuffer2=e.createIndexBuffer(this.indexArray2)),this.programConfigurations.upload(e),this.uploaded=!0},Ra.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.indexBuffer2.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.segments2.destroy())},Ra.prototype.addFeature=function(e,t,i,l,f){for(var m=0,x=ep(t,500);m<x.length;m+=1){for(var k=x[m],A=0,z=0,C=k;z<C.length;z+=1)A+=C[z].length;for(var B=this.segments.prepareSegment(A,this.layoutVertexArray,this.indexArray),V=B.vertexLength,j=[],J=[],$=0,he=k;$<he.length;$+=1){var ie=he[$];if(ie.length!==0){ie!==k[0]&&J.push(j.length/2);var me=this.segments2.prepareSegment(ie.length,this.layoutVertexArray,this.indexArray2),ve=me.vertexLength;this.layoutVertexArray.emplaceBack(ie[0].x,ie[0].y),this.indexArray2.emplaceBack(ve+ie.length-1,ve),j.push(ie[0].x),j.push(ie[0].y);for(var we=1;we<ie.length;we++)this.layoutVertexArray.emplaceBack(ie[we].x,ie[we].y),this.indexArray2.emplaceBack(ve+we-1,ve+we),j.push(ie[we].x),j.push(ie[we].y);me.vertexLength+=ie.length,me.primitiveLength+=ie.length}}for(var ke=Yh(j,J),Pe=0;Pe<ke.length;Pe+=3)this.indexArray.emplaceBack(V+ke[Pe],V+ke[Pe+1],V+ke[Pe+2]);B.vertexLength+=A,B.primitiveLength+=ke.length/3}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,e,i,f,l)},dt("FillBucket",Ra,{omit:["layers","patternFeatures"]});var jy=new sn({"fill-sort-key":new gt(U.layout_fill["fill-sort-key"])}),Gy={paint:new sn({"fill-antialias":new kt(U.paint_fill["fill-antialias"]),"fill-opacity":new gt(U.paint_fill["fill-opacity"]),"fill-color":new gt(U.paint_fill["fill-color"]),"fill-outline-color":new gt(U.paint_fill["fill-outline-color"]),"fill-translate":new kt(U.paint_fill["fill-translate"]),"fill-translate-anchor":new kt(U.paint_fill["fill-translate-anchor"]),"fill-pattern":new Js(U.paint_fill["fill-pattern"])}),layout:jy},Zy=function(e){function t(i){e.call(this,i,Gy)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.recalculate=function(i,l){e.prototype.recalculate.call(this,i,l);var f=this.paint._values["fill-outline-color"];f.value.kind==="constant"&&f.value.value===void 0&&(this.paint._values["fill-outline-color"]=this.paint._values["fill-color"])},t.prototype.createBucket=function(i){return new Ra(i)},t.prototype.queryRadius=function(){return Ni(this.paint.get("fill-translate"))},t.prototype.queryIntersectsFeature=function(i,l,f,m,x,k,A){return _a(La(i,this.paint.get("fill-translate"),this.paint.get("fill-translate-anchor"),k.angle,A),m)},t.prototype.isTileClipped=function(){return!0},t}(Ta),Ky=Xi([{name:"a_pos",components:2,type:"Int16"},{name:"a_normal_ed",components:4,type:"Int16"}],4).members,ef=al;function al(e,t,i,l,f){this.properties={},this.extent=i,this.type=0,this._pbf=e,this._geometry=-1,this._keys=l,this._values=f,e.readFields(Hy,this,t)}function Hy(e,t,i){e==1?t.id=i.readVarint():e==2?function(l,f){for(var m=l.readVarint()+l.pos;l.pos<m;){var x=f._keys[l.readVarint()],k=f._values[l.readVarint()];f.properties[x]=k}}(i,t):e==3?t.type=i.readVarint():e==4&&(t._geometry=i.pos)}function Xy(e){for(var t,i,l=0,f=0,m=e.length,x=m-1;f<m;x=f++)l+=((i=e[x]).x-(t=e[f]).x)*(t.y+i.y);return l}al.types=["Unknown","Point","LineString","Polygon"],al.prototype.loadGeometry=function(){var e=this._pbf;e.pos=this._geometry;for(var t,i=e.readVarint()+e.pos,l=1,f=0,m=0,x=0,k=[];e.pos<i;){if(f<=0){var A=e.readVarint();l=7&A,f=A>>3}if(f--,l===1||l===2)m+=e.readSVarint(),x+=e.readSVarint(),l===1&&(t&&k.push(t),t=[]),t.push(new F(m,x));else{if(l!==7)throw new Error("unknown command "+l);t&&t.push(t[0].clone())}}return t&&k.push(t),k},al.prototype.bbox=function(){var e=this._pbf;e.pos=this._geometry;for(var t=e.readVarint()+e.pos,i=1,l=0,f=0,m=0,x=1/0,k=-1/0,A=1/0,z=-1/0;e.pos<t;){if(l<=0){var C=e.readVarint();i=7&C,l=C>>3}if(l--,i===1||i===2)(f+=e.readSVarint())<x&&(x=f),f>k&&(k=f),(m+=e.readSVarint())<A&&(A=m),m>z&&(z=m);else if(i!==7)throw new Error("unknown command "+i)}return[x,A,k,z]},al.prototype.toGeoJSON=function(e,t,i){var l,f,m=this.extent*Math.pow(2,i),x=this.extent*e,k=this.extent*t,A=this.loadGeometry(),z=al.types[this.type];function C(j){for(var J=0;J<j.length;J++){var $=j[J];j[J]=[360*($.x+x)/m-180,360/Math.PI*Math.atan(Math.exp((180-360*($.y+k)/m)*Math.PI/180))-90]}}switch(this.type){case 1:var B=[];for(l=0;l<A.length;l++)B[l]=A[l][0];C(A=B);break;case 2:for(l=0;l<A.length;l++)C(A[l]);break;case 3:for(A=function(j){var J=j.length;if(J<=1)return[j];for(var $,he,ie=[],me=0;me<J;me++){var ve=Xy(j[me]);ve!==0&&(he===void 0&&(he=ve<0),he===ve<0?($&&ie.push($),$=[j[me]]):$.push(j[me]))}return $&&ie.push($),ie}(A),l=0;l<A.length;l++)for(f=0;f<A[l].length;f++)C(A[l][f])}A.length===1?A=A[0]:z="Multi"+z;var V={type:"Feature",geometry:{type:z,coordinates:A},properties:this.properties};return"id"in this&&(V.id=this.id),V};var tf=rf;function rf(e,t){this.version=1,this.name=null,this.extent=4096,this.length=0,this._pbf=e,this._keys=[],this._values=[],this._features=[],e.readFields(Wy,this,t),this.length=this._features.length}function Wy(e,t,i){e===15?t.version=i.readVarint():e===1?t.name=i.readString():e===5?t.extent=i.readVarint():e===2?t._features.push(i.pos):e===3?t._keys.push(i.readString()):e===4&&t._values.push(function(l){for(var f=null,m=l.readVarint()+l.pos;l.pos<m;){var x=l.readVarint()>>3;f=x===1?l.readString():x===2?l.readFloat():x===3?l.readDouble():x===4?l.readVarint64():x===5?l.readVarint():x===6?l.readSVarint():x===7?l.readBoolean():null}return f}(i))}function Yy(e,t,i){if(e===3){var l=new tf(i,i.readVarint()+i.pos);l.length&&(t[l.name]=l)}}rf.prototype.feature=function(e){if(e<0||e>=this._features.length)throw new Error("feature index out of bounds");this._pbf.pos=this._features[e];var t=this._pbf.readVarint()+this._pbf.pos;return new ef(this._pbf,t,this.extent,this._keys,this._values)};var ol={VectorTile:function(e,t){this.layers=e.readFields(Yy,{},t)},VectorTileFeature:ef,VectorTileLayer:tf},Jy=ol.VectorTileFeature.types,ip=Math.pow(2,13);function hu(e,t,i,l,f,m,x,k){e.emplaceBack(t,i,2*Math.floor(l*ip)+x,f*ip*2,m*ip*2,Math.round(k))}var Ba=function(e){this.zoom=e.zoom,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map(function(t){return t.id}),this.index=e.index,this.hasPattern=!1,this.layoutVertexArray=new Da,this.indexArray=new Wa,this.programConfigurations=new Ct(e.layers,e.zoom),this.segments=new Z,this.stateDependentLayerIds=this.layers.filter(function(t){return t.isStateDependent()}).map(function(t){return t.id})};function Qy(e,t){return e.x===t.x&&(e.x<0||e.x>8192)||e.y===t.y&&(e.y<0||e.y>8192)}Ba.prototype.populate=function(e,t,i){this.features=[],this.hasPattern=tp("fill-extrusion",this.layers,t);for(var l=0,f=e;l<f.length;l+=1){var m=f[l],x=m.feature,k=m.id,A=m.index,z=m.sourceLayerIndex,C=this.layers[0]._featureFilter.needGeometry,B=mi(x,C);if(this.layers[0]._featureFilter.filter(new lr(this.zoom),B,i)){var V={id:k,sourceLayerIndex:z,index:A,geometry:C?B.geometry:ii(x),properties:x.properties,type:x.type,patterns:{}};this.hasPattern?this.features.push(rp("fill-extrusion",this.layers,V,this.zoom,t)):this.addFeature(V,V.geometry,A,i,{}),t.featureIndex.insert(x,V.geometry,A,z,this.index,!0)}}},Ba.prototype.addFeatures=function(e,t,i){for(var l=0,f=this.features;l<f.length;l+=1){var m=f[l];this.addFeature(m,m.geometry,m.index,t,i)}},Ba.prototype.update=function(e,t,i){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(e,t,this.stateDependentLayers,i)},Ba.prototype.isEmpty=function(){return this.layoutVertexArray.length===0},Ba.prototype.uploadPending=function(){return!this.uploaded||this.programConfigurations.needsUpload},Ba.prototype.upload=function(e){this.uploaded||(this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,Ky),this.indexBuffer=e.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(e),this.uploaded=!0},Ba.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())},Ba.prototype.addFeature=function(e,t,i,l,f){for(var m=0,x=ep(t,500);m<x.length;m+=1){for(var k=x[m],A=0,z=0,C=k;z<C.length;z+=1)A+=C[z].length;for(var B=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray),V=0,j=k;V<j.length;V+=1){var J=j[V];if(J.length!==0&&!((sr=J).every(function(Gt){return Gt.x<0})||sr.every(function(Gt){return Gt.x>8192})||sr.every(function(Gt){return Gt.y<0})||sr.every(function(Gt){return Gt.y>8192})))for(var $=0,he=0;he<J.length;he++){var ie=J[he];if(he>=1){var me=J[he-1];if(!Qy(ie,me)){B.vertexLength+4>Z.MAX_VERTEX_ARRAY_LENGTH&&(B=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray));var ve=ie.sub(me)._perp()._unit(),we=me.dist(ie);$+we>32768&&($=0),hu(this.layoutVertexArray,ie.x,ie.y,ve.x,ve.y,0,0,$),hu(this.layoutVertexArray,ie.x,ie.y,ve.x,ve.y,0,1,$),hu(this.layoutVertexArray,me.x,me.y,ve.x,ve.y,0,0,$+=we),hu(this.layoutVertexArray,me.x,me.y,ve.x,ve.y,0,1,$);var ke=B.vertexLength;this.indexArray.emplaceBack(ke,ke+2,ke+1),this.indexArray.emplaceBack(ke+1,ke+2,ke+3),B.vertexLength+=4,B.primitiveLength+=2}}}}if(B.vertexLength+A>Z.MAX_VERTEX_ARRAY_LENGTH&&(B=this.segments.prepareSegment(A,this.layoutVertexArray,this.indexArray)),Jy[e.type]==="Polygon"){for(var Pe=[],qe=[],et=B.vertexLength,wt=0,st=k;wt<st.length;wt+=1){var Tt=st[wt];if(Tt.length!==0){Tt!==k[0]&&qe.push(Pe.length/2);for(var lt=0;lt<Tt.length;lt++){var $t=Tt[lt];hu(this.layoutVertexArray,$t.x,$t.y,0,0,1,1,0),Pe.push($t.x),Pe.push($t.y)}}}for(var Mt=Yh(Pe,qe),_t=0;_t<Mt.length;_t+=3)this.indexArray.emplaceBack(et+Mt[_t],et+Mt[_t+2],et+Mt[_t+1]);B.primitiveLength+=Mt.length/3,B.vertexLength+=A}}var sr;this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,e,i,f,l)},dt("FillExtrusionBucket",Ba,{omit:["layers","features"]});var $y={paint:new sn({"fill-extrusion-opacity":new kt(U["paint_fill-extrusion"]["fill-extrusion-opacity"]),"fill-extrusion-color":new gt(U["paint_fill-extrusion"]["fill-extrusion-color"]),"fill-extrusion-translate":new kt(U["paint_fill-extrusion"]["fill-extrusion-translate"]),"fill-extrusion-translate-anchor":new kt(U["paint_fill-extrusion"]["fill-extrusion-translate-anchor"]),"fill-extrusion-pattern":new Js(U["paint_fill-extrusion"]["fill-extrusion-pattern"]),"fill-extrusion-height":new gt(U["paint_fill-extrusion"]["fill-extrusion-height"]),"fill-extrusion-base":new gt(U["paint_fill-extrusion"]["fill-extrusion-base"]),"fill-extrusion-vertical-gradient":new kt(U["paint_fill-extrusion"]["fill-extrusion-vertical-gradient"])})},eg=function(e){function t(i){e.call(this,i,$y)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.createBucket=function(i){return new Ba(i)},t.prototype.queryRadius=function(){return Ni(this.paint.get("fill-extrusion-translate"))},t.prototype.is3D=function(){return!0},t.prototype.queryIntersectsFeature=function(i,l,f,m,x,k,A,z){var C=La(i,this.paint.get("fill-extrusion-translate"),this.paint.get("fill-extrusion-translate-anchor"),k.angle,A),B=this.paint.get("fill-extrusion-height").evaluate(l,f),V=this.paint.get("fill-extrusion-base").evaluate(l,f),j=function($,he,ie,me){for(var ve=[],we=0,ke=$;we<ke.length;we+=1){var Pe=ke[we],qe=[Pe.x,Pe.y,0,1];rl(qe,qe,he),ve.push(new F(qe[0]/qe[3],qe[1]/qe[3]))}return ve}(C,z),J=function($,he,ie,me){for(var ve=[],we=[],ke=me[8]*he,Pe=me[9]*he,qe=me[10]*he,et=me[11]*he,wt=me[8]*ie,st=me[9]*ie,Tt=me[10]*ie,lt=me[11]*ie,$t=0,Mt=$;$t<Mt.length;$t+=1){for(var _t=[],sr=[],Gt=0,gr=Mt[$t];Gt<gr.length;Gt+=1){var It=gr[Gt],Sr=It.x,Jr=It.y,ci=me[0]*Sr+me[4]*Jr+me[12],ni=me[1]*Sr+me[5]*Jr+me[13],Qr=me[2]*Sr+me[6]*Jr+me[14],hi=me[3]*Sr+me[7]*Jr+me[15],Vi=Qr+qe,Ui=hi+et,Sn=ci+wt,Ji=ni+st,kn=Qr+Tt,yi=hi+lt,Qi=new F((ci+ke)/Ui,(ni+Pe)/Ui);Qi.z=Vi/Ui,_t.push(Qi);var hr=new F(Sn/yi,Ji/yi);hr.z=kn/yi,sr.push(hr)}ve.push(_t),we.push(sr)}return[ve,we]}(m,V,B,z);return function($,he,ie){var me=1/0;_a(ie,he)&&(me=nf(ie,he[0]));for(var ve=0;ve<he.length;ve++)for(var we=he[ve],ke=$[ve],Pe=0;Pe<we.length-1;Pe++){var qe=we[Pe],et=[qe,we[Pe+1],ke[Pe+1],ke[Pe],qe];Qa(ie,et)&&(me=Math.min(me,nf(ie,et)))}return me!==1/0&&me}(J[0],J[1],j)},t}(Ta);function pu(e,t){return e.x*t.x+e.y*t.y}function nf(e,t){if(e.length===1){for(var i,l=0,f=t[l++];!i||f.equals(i);)if(!(i=t[l++]))return 1/0;for(;l<t.length;l++){var m=t[l],x=e[0],k=i.sub(f),A=m.sub(f),z=x.sub(f),C=pu(k,k),B=pu(k,A),V=pu(A,A),j=pu(z,k),J=pu(z,A),$=C*V-B*B,he=(V*j-B*J)/$,ie=(C*J-B*j)/$,me=f.z*(1-he-ie)+i.z*he+m.z*ie;if(isFinite(me))return me}return 1/0}for(var ve=1/0,we=0,ke=t;we<ke.length;we+=1)ve=Math.min(ve,ke[we].z);return ve}var tg=Xi([{name:"a_pos_normal",components:2,type:"Int16"},{name:"a_data",components:4,type:"Uint8"}],4).members,rg=Xi([{name:"a_uv_x",components:1,type:"Float32"},{name:"a_split_index",components:1,type:"Float32"}]).members,ig=ol.VectorTileFeature.types,ng=Math.cos(Math.PI/180*37.5),af=Math.pow(2,14)/.5,Cn=function(e){var t=this;this.zoom=e.zoom,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map(function(i){return i.id}),this.index=e.index,this.hasPattern=!1,this.patternFeatures=[],this.lineClipsArray=[],this.gradients={},this.layers.forEach(function(i){t.gradients[i.id]={}}),this.layoutVertexArray=new qn,this.layoutVertexArray2=new Go,this.indexArray=new Wa,this.programConfigurations=new Ct(e.layers,e.zoom),this.segments=new Z,this.maxLineLength=0,this.stateDependentLayerIds=this.layers.filter(function(i){return i.isStateDependent()}).map(function(i){return i.id})};Cn.prototype.populate=function(e,t,i){this.hasPattern=tp("line",this.layers,t);for(var l=this.layers[0].layout.get("line-sort-key"),f=[],m=0,x=e;m<x.length;m+=1){var k=x[m],A=k.feature,z=k.id,C=k.index,B=k.sourceLayerIndex,V=this.layers[0]._featureFilter.needGeometry,j=mi(A,V);if(this.layers[0]._featureFilter.filter(new lr(this.zoom),j,i)){var J=l?l.evaluate(j,{},i):void 0,$={id:z,properties:A.properties,type:A.type,sourceLayerIndex:B,index:C,geometry:V?j.geometry:ii(A),patterns:{},sortKey:J};f.push($)}}l&&f.sort(function(qe,et){return qe.sortKey-et.sortKey});for(var he=0,ie=f;he<ie.length;he+=1){var me=ie[he],ve=me.geometry,we=me.index,ke=me.sourceLayerIndex;if(this.hasPattern){var Pe=rp("line",this.layers,me,this.zoom,t);this.patternFeatures.push(Pe)}else this.addFeature(me,ve,we,i,{});t.featureIndex.insert(e[we].feature,ve,we,ke,this.index)}},Cn.prototype.update=function(e,t,i){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(e,t,this.stateDependentLayers,i)},Cn.prototype.addFeatures=function(e,t,i){for(var l=0,f=this.patternFeatures;l<f.length;l+=1){var m=f[l];this.addFeature(m,m.geometry,m.index,t,i)}},Cn.prototype.isEmpty=function(){return this.layoutVertexArray.length===0},Cn.prototype.uploadPending=function(){return!this.uploaded||this.programConfigurations.needsUpload},Cn.prototype.upload=function(e){this.uploaded||(this.layoutVertexArray2.length!==0&&(this.layoutVertexBuffer2=e.createVertexBuffer(this.layoutVertexArray2,rg)),this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,tg),this.indexBuffer=e.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(e),this.uploaded=!0},Cn.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())},Cn.prototype.lineFeatureClips=function(e){if(e.properties&&e.properties.hasOwnProperty("mapbox_clip_start")&&e.properties.hasOwnProperty("mapbox_clip_end"))return{start:+e.properties.mapbox_clip_start,end:+e.properties.mapbox_clip_end}},Cn.prototype.addFeature=function(e,t,i,l,f){var m=this.layers[0].layout,x=m.get("line-join").evaluate(e,{}),k=m.get("line-cap"),A=m.get("line-miter-limit"),z=m.get("line-round-limit");this.lineClips=this.lineFeatureClips(e);for(var C=0,B=t;C<B.length;C+=1)this.addLine(B[C],e,x,k,A,z);this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,e,i,f,l)},Cn.prototype.addLine=function(e,t,i,l,f,m){if(this.distance=0,this.scaledDistance=0,this.totalDistance=0,this.lineClips){this.lineClipsArray.push(this.lineClips);for(var x=0;x<e.length-1;x++)this.totalDistance+=e[x].dist(e[x+1]);this.updateScaledDistance(),this.maxLineLength=Math.max(this.maxLineLength,this.totalDistance)}for(var k=ig[t.type]==="Polygon",A=e.length;A>=2&&e[A-1].equals(e[A-2]);)A--;for(var z=0;z<A-1&&e[z].equals(e[z+1]);)z++;if(!(A<(k?3:2))){i==="bevel"&&(f=1.05);var C,B=this.overscaling<=16?122880/(512*this.overscaling):0,V=this.segments.prepareSegment(10*A,this.layoutVertexArray,this.indexArray),j=void 0,J=void 0,$=void 0,he=void 0;this.e1=this.e2=-1,k&&(he=e[z].sub(C=e[A-2])._unit()._perp());for(var ie=z;ie<A;ie++)if(!(J=ie===A-1?k?e[z+1]:void 0:e[ie+1])||!e[ie].equals(J)){he&&($=he),C&&(j=C),C=e[ie],he=J?J.sub(C)._unit()._perp():$;var me=($=$||he).add(he);me.x===0&&me.y===0||me._unit();var ve=$.x*he.x+$.y*he.y,we=me.x*he.x+me.y*he.y,ke=we!==0?1/we:1/0,Pe=2*Math.sqrt(2-2*we),qe=we<ng&&j&&J,et=$.x*he.y-$.y*he.x>0;if(qe&&ie>z){var wt=C.dist(j);if(wt>2*B){var st=C.sub(C.sub(j)._mult(B/wt)._round());this.updateDistance(j,st),this.addCurrentVertex(st,$,0,0,V),j=st}}var Tt=j&&J,lt=Tt?i:k?"butt":l;if(Tt&&lt==="round"&&(ke<m?lt="miter":ke<=2&&(lt="fakeround")),lt==="miter"&&ke>f&&(lt="bevel"),lt==="bevel"&&(ke>2&&(lt="flipbevel"),ke<f&&(lt="miter")),j&&this.updateDistance(j,C),lt==="miter")me._mult(ke),this.addCurrentVertex(C,me,0,0,V);else if(lt==="flipbevel"){if(ke>100)me=he.mult(-1);else{var $t=ke*$.add(he).mag()/$.sub(he).mag();me._perp()._mult($t*(et?-1:1))}this.addCurrentVertex(C,me,0,0,V),this.addCurrentVertex(C,me.mult(-1),0,0,V)}else if(lt==="bevel"||lt==="fakeround"){var Mt=-Math.sqrt(ke*ke-1),_t=et?Mt:0,sr=et?0:Mt;if(j&&this.addCurrentVertex(C,$,_t,sr,V),lt==="fakeround")for(var Gt=Math.round(180*Pe/Math.PI/20),gr=1;gr<Gt;gr++){var It=gr/Gt;if(It!==.5){var Sr=It-.5;It+=It*Sr*(It-1)*((1.0904+ve*(ve*(3.55645-1.43519*ve)-3.2452))*Sr*Sr+(.848013+ve*(.215638*ve-1.06021)))}var Jr=he.sub($)._mult(It)._add($)._unit()._mult(et?-1:1);this.addHalfVertex(C,Jr.x,Jr.y,!1,et,0,V)}J&&this.addCurrentVertex(C,he,-_t,-sr,V)}else if(lt==="butt")this.addCurrentVertex(C,me,0,0,V);else if(lt==="square"){var ci=j?1:-1;this.addCurrentVertex(C,me,ci,ci,V)}else lt==="round"&&(j&&(this.addCurrentVertex(C,$,0,0,V),this.addCurrentVertex(C,$,1,1,V,!0)),J&&(this.addCurrentVertex(C,he,-1,-1,V,!0),this.addCurrentVertex(C,he,0,0,V)));if(qe&&ie<A-1){var ni=C.dist(J);if(ni>2*B){var Qr=C.add(J.sub(C)._mult(B/ni)._round());this.updateDistance(C,Qr),this.addCurrentVertex(Qr,he,0,0,V),C=Qr}}}}},Cn.prototype.addCurrentVertex=function(e,t,i,l,f,m){m===void 0&&(m=!1);var x=t.y*l-t.x,k=-t.y-t.x*l;this.addHalfVertex(e,t.x+t.y*i,t.y-t.x*i,m,!1,i,f),this.addHalfVertex(e,x,k,m,!0,-l,f),this.distance>af/2&&this.totalDistance===0&&(this.distance=0,this.addCurrentVertex(e,t,i,l,f,m))},Cn.prototype.addHalfVertex=function(e,t,i,l,f,m,x){var k=.5*(this.lineClips?this.scaledDistance*(af-1):this.scaledDistance);this.layoutVertexArray.emplaceBack((e.x<<1)+(l?1:0),(e.y<<1)+(f?1:0),Math.round(63*t)+128,Math.round(63*i)+128,1+(m===0?0:m<0?-1:1)|(63&k)<<2,k>>6),this.lineClips&&this.layoutVertexArray2.emplaceBack((this.scaledDistance-this.lineClips.start)/(this.lineClips.end-this.lineClips.start),this.lineClipsArray.length);var A=x.vertexLength++;this.e1>=0&&this.e2>=0&&(this.indexArray.emplaceBack(this.e1,this.e2,A),x.primitiveLength++),f?this.e2=A:this.e1=A},Cn.prototype.updateScaledDistance=function(){this.scaledDistance=this.lineClips?this.lineClips.start+(this.lineClips.end-this.lineClips.start)*this.distance/this.totalDistance:this.distance},Cn.prototype.updateDistance=function(e,t){this.distance+=e.dist(t),this.updateScaledDistance()},dt("LineBucket",Cn,{omit:["layers","patternFeatures"]});var ag=new sn({"line-cap":new kt(U.layout_line["line-cap"]),"line-join":new gt(U.layout_line["line-join"]),"line-miter-limit":new kt(U.layout_line["line-miter-limit"]),"line-round-limit":new kt(U.layout_line["line-round-limit"]),"line-sort-key":new gt(U.layout_line["line-sort-key"])}),of={paint:new sn({"line-opacity":new gt(U.paint_line["line-opacity"]),"line-color":new gt(U.paint_line["line-color"]),"line-translate":new kt(U.paint_line["line-translate"]),"line-translate-anchor":new kt(U.paint_line["line-translate-anchor"]),"line-width":new gt(U.paint_line["line-width"]),"line-gap-width":new gt(U.paint_line["line-gap-width"]),"line-offset":new gt(U.paint_line["line-offset"]),"line-blur":new gt(U.paint_line["line-blur"]),"line-dasharray":new bn(U.paint_line["line-dasharray"]),"line-pattern":new Js(U.paint_line["line-pattern"]),"line-gradient":new ga(U.paint_line["line-gradient"])}),layout:ag},sf=new(function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.possiblyEvaluate=function(i,l){return l=new lr(Math.floor(l.zoom),{now:l.now,fadeDuration:l.fadeDuration,zoomHistory:l.zoomHistory,transition:l.transition}),e.prototype.possiblyEvaluate.call(this,i,l)},t.prototype.evaluate=function(i,l,f,m){return l=be({},l,{zoom:Math.floor(l.zoom)}),e.prototype.evaluate.call(this,i,l,f,m)},t}(gt))(of.paint.properties["line-width"].specification);sf.useIntegerZoom=!0;var og=function(e){function t(i){e.call(this,i,of),this.gradientVersion=0}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._handleSpecialPaintPropertyUpdate=function(i){i==="line-gradient"&&(this.stepInterpolant=this._transitionablePaint._values["line-gradient"].value.expression._styleExpression.expression instanceof On,this.gradientVersion=(this.gradientVersion+1)%X)},t.prototype.gradientExpression=function(){return this._transitionablePaint._values["line-gradient"].value.expression},t.prototype.recalculate=function(i,l){e.prototype.recalculate.call(this,i,l),this.paint._values["line-floorwidth"]=sf.possiblyEvaluate(this._transitioningPaint._values["line-width"].value,i)},t.prototype.createBucket=function(i){return new Cn(i)},t.prototype.queryRadius=function(i){var l=i,f=lf(za("line-width",this,l),za("line-gap-width",this,l)),m=za("line-offset",this,l);return f/2+Math.abs(m)+Ni(this.paint.get("line-translate"))},t.prototype.queryIntersectsFeature=function(i,l,f,m,x,k,A){var z=La(i,this.paint.get("line-translate"),this.paint.get("line-translate-anchor"),k.angle,A),C=A/2*lf(this.paint.get("line-width").evaluate(l,f),this.paint.get("line-gap-width").evaluate(l,f)),B=this.paint.get("line-offset").evaluate(l,f);return B&&(m=function(V,j){for(var J=[],$=new F(0,0),he=0;he<V.length;he++){for(var ie=V[he],me=[],ve=0;ve<ie.length;ve++){var we=ie[ve],ke=ie[ve+1],Pe=ve===0?$:we.sub(ie[ve-1])._unit()._perp(),qe=ve===ie.length-1?$:ke.sub(we)._unit()._perp(),et=Pe._add(qe)._unit();et._mult(1/(et.x*qe.x+et.y*qe.y)),me.push(et._mult(j)._add(we))}J.push(me)}return J}(m,B*A)),function(V,j,J){for(var $=0;$<j.length;$++){var he=j[$];if(V.length>=3){for(var ie=0;ie<he.length;ie++)if(Aa(V,he[ie]))return!0}if(oa(V,he,J))return!0}return!1}(z,m,C)},t.prototype.isTileClipped=function(){return!0},t}(Ta);function lf(e,t){return t>0?t+2*e:e}var sg=Xi([{name:"a_pos_offset",components:4,type:"Int16"},{name:"a_data",components:4,type:"Uint16"},{name:"a_pixeloffset",components:4,type:"Int16"}],4),lg=Xi([{name:"a_projected_pos",components:3,type:"Float32"}],4),ug=(Xi([{name:"a_fade_opacity",components:1,type:"Uint32"}],4),Xi([{name:"a_placed",components:2,type:"Uint8"},{name:"a_shift",components:2,type:"Float32"}])),uf=(Xi([{type:"Int16",name:"anchorPointX"},{type:"Int16",name:"anchorPointY"},{type:"Int16",name:"x1"},{type:"Int16",name:"y1"},{type:"Int16",name:"x2"},{type:"Int16",name:"y2"},{type:"Uint32",name:"featureIndex"},{type:"Uint16",name:"sourceLayerIndex"},{type:"Uint16",name:"bucketIndex"}]),Xi([{name:"a_pos",components:2,type:"Int16"},{name:"a_anchor_pos",components:2,type:"Int16"},{name:"a_extrude",components:2,type:"Int16"}],4)),cg=Xi([{name:"a_pos",components:2,type:"Float32"},{name:"a_radius",components:1,type:"Float32"},{name:"a_flags",components:2,type:"Int16"}],4);function hg(e,t,i){return e.sections.forEach(function(l){l.text=function(f,m,x){var k=m.layout.get("text-transform").evaluate(x,{});return k==="uppercase"?f=f.toLocaleUpperCase():k==="lowercase"&&(f=f.toLocaleLowerCase()),Qn.applyArabicShaping&&(f=Qn.applyArabicShaping(f)),f}(l.text,t,i)}),e}Xi([{name:"triangle",components:3,type:"Uint16"}]),Xi([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Uint16",name:"glyphStartIndex"},{type:"Uint16",name:"numGlyphs"},{type:"Uint32",name:"vertexStartIndex"},{type:"Uint32",name:"lineStartIndex"},{type:"Uint32",name:"lineLength"},{type:"Uint16",name:"segment"},{type:"Uint16",name:"lowerSize"},{type:"Uint16",name:"upperSize"},{type:"Float32",name:"lineOffsetX"},{type:"Float32",name:"lineOffsetY"},{type:"Uint8",name:"writingMode"},{type:"Uint8",name:"placedOrientation"},{type:"Uint8",name:"hidden"},{type:"Uint32",name:"crossTileID"},{type:"Int16",name:"associatedIconIndex"}]),Xi([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Int16",name:"rightJustifiedTextSymbolIndex"},{type:"Int16",name:"centerJustifiedTextSymbolIndex"},{type:"Int16",name:"leftJustifiedTextSymbolIndex"},{type:"Int16",name:"verticalPlacedTextSymbolIndex"},{type:"Int16",name:"placedIconSymbolIndex"},{type:"Int16",name:"verticalPlacedIconSymbolIndex"},{type:"Uint16",name:"key"},{type:"Uint16",name:"textBoxStartIndex"},{type:"Uint16",name:"textBoxEndIndex"},{type:"Uint16",name:"verticalTextBoxStartIndex"},{type:"Uint16",name:"verticalTextBoxEndIndex"},{type:"Uint16",name:"iconBoxStartIndex"},{type:"Uint16",name:"iconBoxEndIndex"},{type:"Uint16",name:"verticalIconBoxStartIndex"},{type:"Uint16",name:"verticalIconBoxEndIndex"},{type:"Uint16",name:"featureIndex"},{type:"Uint16",name:"numHorizontalGlyphVertices"},{type:"Uint16",name:"numVerticalGlyphVertices"},{type:"Uint16",name:"numIconVertices"},{type:"Uint16",name:"numVerticalIconVertices"},{type:"Uint16",name:"useRuntimeCollisionCircles"},{type:"Uint32",name:"crossTileID"},{type:"Float32",name:"textBoxScale"},{type:"Float32",components:2,name:"textOffset"},{type:"Float32",name:"collisionCircleDiameter"}]),Xi([{type:"Float32",name:"offsetX"}]),Xi([{type:"Int16",name:"x"},{type:"Int16",name:"y"},{type:"Int16",name:"tileUnitDistanceFromAnchor"}]);var fu={"!":"︕","#":"＃",$:"＄","%":"％","&":"＆","(":"︵",")":"︶","*":"＊","+":"＋",",":"︐","-":"︲",".":"・","/":"／",":":"︓",";":"︔","<":"︿","=":"＝",">":"﹀","?":"︖","@":"＠","[":"﹇","\\":"＼","]":"﹈","^":"＾",_:"︳","`":"｀","{":"︷","|":"―","}":"︸","~":"～","¢":"￠","£":"￡","¥":"￥","¦":"￤","¬":"￢","¯":"￣","–":"︲","—":"︱","‘":"﹃","’":"﹄","“":"﹁","”":"﹂","…":"︙","‧":"・","₩":"￦","、":"︑","。":"︒","〈":"︿","〉":"﹀","《":"︽","》":"︾","「":"﹁","」":"﹂","『":"﹃","』":"﹄","【":"︻","】":"︼","〔":"︹","〕":"︺","〖":"︗","〗":"︘","！":"︕","（":"︵","）":"︶","，":"︐","－":"︲","．":"・","：":"︓","；":"︔","＜":"︿","＞":"﹀","？":"︖","［":"﹇","］":"﹈","＿":"︳","｛":"︷","｜":"―","｝":"︸","｟":"︵","｠":"︶","｡":"︒","｢":"﹁","｣":"﹂"},cf=function(e,t,i,l,f){var m,x,k=8*f-l-1,A=(1<<k)-1,z=A>>1,C=-7,B=i?f-1:0,V=i?-1:1,j=e[t+B];for(B+=V,m=j&(1<<-C)-1,j>>=-C,C+=k;C>0;m=256*m+e[t+B],B+=V,C-=8);for(x=m&(1<<-C)-1,m>>=-C,C+=l;C>0;x=256*x+e[t+B],B+=V,C-=8);if(m===0)m=1-z;else{if(m===A)return x?NaN:1/0*(j?-1:1);x+=Math.pow(2,l),m-=z}return(j?-1:1)*x*Math.pow(2,m-l)},hf=function(e,t,i,l,f,m){var x,k,A,z=8*m-f-1,C=(1<<z)-1,B=C>>1,V=f===23?Math.pow(2,-24)-Math.pow(2,-77):0,j=l?0:m-1,J=l?1:-1,$=t<0||t===0&&1/t<0?1:0;for(t=Math.abs(t),isNaN(t)||t===1/0?(k=isNaN(t)?1:0,x=C):(x=Math.floor(Math.log(t)/Math.LN2),t*(A=Math.pow(2,-x))<1&&(x--,A*=2),(t+=x+B>=1?V/A:V*Math.pow(2,1-B))*A>=2&&(x++,A/=2),x+B>=C?(k=0,x=C):x+B>=1?(k=(t*A-1)*Math.pow(2,f),x+=B):(k=t*Math.pow(2,B-1)*Math.pow(2,f),x=0));f>=8;e[i+j]=255&k,j+=J,k/=256,f-=8);for(x=x<<f|k,z+=f;z>0;e[i+j]=255&x,j+=J,x/=256,z-=8);e[i+j-J]|=128*$},Cc=Vr;function Vr(e){this.buf=ArrayBuffer.isView&&ArrayBuffer.isView(e)?e:new Uint8Array(e||0),this.pos=0,this.type=0,this.length=this.buf.length}Vr.Varint=0,Vr.Fixed64=1,Vr.Bytes=2,Vr.Fixed32=5;var pf=typeof TextDecoder>"u"?null:new TextDecoder("utf8");function zo(e){return e.type===Vr.Bytes?e.readVarint()+e.pos:e.pos+1}function sl(e,t,i){return i?4294967296*t+(e>>>0):4294967296*(t>>>0)+(e>>>0)}function ff(e,t,i){var l=t<=16383?1:t<=2097151?2:t<=268435455?3:Math.floor(Math.log(t)/(7*Math.LN2));i.realloc(l);for(var f=i.pos-1;f>=e;f--)i.buf[f+l]=i.buf[f]}function pg(e,t){for(var i=0;i<e.length;i++)t.writeVarint(e[i])}function fg(e,t){for(var i=0;i<e.length;i++)t.writeSVarint(e[i])}function dg(e,t){for(var i=0;i<e.length;i++)t.writeFloat(e[i])}function mg(e,t){for(var i=0;i<e.length;i++)t.writeDouble(e[i])}function yg(e,t){for(var i=0;i<e.length;i++)t.writeBoolean(e[i])}function gg(e,t){for(var i=0;i<e.length;i++)t.writeFixed32(e[i])}function _g(e,t){for(var i=0;i<e.length;i++)t.writeSFixed32(e[i])}function vg(e,t){for(var i=0;i<e.length;i++)t.writeFixed64(e[i])}function bg(e,t){for(var i=0;i<e.length;i++)t.writeSFixed64(e[i])}function Mc(e,t){return(e[t]|e[t+1]<<8|e[t+2]<<16)+16777216*e[t+3]}function ll(e,t,i){e[i]=t,e[i+1]=t>>>8,e[i+2]=t>>>16,e[i+3]=t>>>24}function df(e,t){return(e[t]|e[t+1]<<8|e[t+2]<<16)+(e[t+3]<<24)}function xg(e,t,i){e===1&&i.readMessage(wg,t)}function wg(e,t,i){if(e===3){var l=i.readMessage(Sg,{}),f=l.width,m=l.height,x=l.left,k=l.top,A=l.advance;t.push({id:l.id,bitmap:new Ts({width:f+6,height:m+6},l.bitmap),metrics:{width:f,height:m,left:x,top:k,advance:A}})}}function Sg(e,t,i){e===1?t.id=i.readVarint():e===2?t.bitmap=i.readBytes():e===3?t.width=i.readVarint():e===4?t.height=i.readVarint():e===5?t.left=i.readSVarint():e===6?t.top=i.readSVarint():e===7&&(t.advance=i.readVarint())}function mf(e){for(var t=0,i=0,l=0,f=e;l<f.length;l+=1){var m=f[l];t+=m.w*m.h,i=Math.max(i,m.w)}e.sort(function($,he){return he.h-$.h});for(var x=[{x:0,y:0,w:Math.max(Math.ceil(Math.sqrt(t/.95)),i),h:1/0}],k=0,A=0,z=0,C=e;z<C.length;z+=1)for(var B=C[z],V=x.length-1;V>=0;V--){var j=x[V];if(!(B.w>j.w||B.h>j.h)){if(B.x=j.x,B.y=j.y,A=Math.max(A,B.y+B.h),k=Math.max(k,B.x+B.w),B.w===j.w&&B.h===j.h){var J=x.pop();V<x.length&&(x[V]=J)}else B.h===j.h?(j.x+=B.w,j.w-=B.w):B.w===j.w?(j.y+=B.h,j.h-=B.h):(x.push({x:j.x+B.w,y:j.y,w:j.w-B.w,h:B.h}),j.y+=B.h,j.h-=B.h);break}}return{w:k,h:A,fill:t/(k*A)||0}}Vr.prototype={destroy:function(){this.buf=null},readFields:function(e,t,i){for(i=i||this.length;this.pos<i;){var l=this.readVarint(),f=l>>3,m=this.pos;this.type=7&l,e(f,t,this),this.pos===m&&this.skip(l)}return t},readMessage:function(e,t){return this.readFields(e,t,this.readVarint()+this.pos)},readFixed32:function(){var e=Mc(this.buf,this.pos);return this.pos+=4,e},readSFixed32:function(){var e=df(this.buf,this.pos);return this.pos+=4,e},readFixed64:function(){var e=Mc(this.buf,this.pos)+4294967296*Mc(this.buf,this.pos+4);return this.pos+=8,e},readSFixed64:function(){var e=Mc(this.buf,this.pos)+4294967296*df(this.buf,this.pos+4);return this.pos+=8,e},readFloat:function(){var e=cf(this.buf,this.pos,!0,23,4);return this.pos+=4,e},readDouble:function(){var e=cf(this.buf,this.pos,!0,52,8);return this.pos+=8,e},readVarint:function(e){var t,i,l=this.buf;return t=127&(i=l[this.pos++]),i<128?t:(t|=(127&(i=l[this.pos++]))<<7,i<128?t:(t|=(127&(i=l[this.pos++]))<<14,i<128?t:(t|=(127&(i=l[this.pos++]))<<21,i<128?t:function(f,m,x){var k,A,z=x.buf;if(k=(112&(A=z[x.pos++]))>>4,A<128||(k|=(127&(A=z[x.pos++]))<<3,A<128)||(k|=(127&(A=z[x.pos++]))<<10,A<128)||(k|=(127&(A=z[x.pos++]))<<17,A<128)||(k|=(127&(A=z[x.pos++]))<<24,A<128)||(k|=(1&(A=z[x.pos++]))<<31,A<128))return sl(f,k,m);throw new Error("Expected varint not more than 10 bytes")}(t|=(15&(i=l[this.pos]))<<28,e,this))))},readVarint64:function(){return this.readVarint(!0)},readSVarint:function(){var e=this.readVarint();return e%2==1?(e+1)/-2:e/2},readBoolean:function(){return!!this.readVarint()},readString:function(){var e=this.readVarint()+this.pos,t=this.pos;return this.pos=e,e-t>=12&&pf?function(i,l,f){return pf.decode(i.subarray(l,f))}(this.buf,t,e):function(i,l,f){for(var m="",x=l;x<f;){var k,A,z,C=i[x],B=null,V=C>239?4:C>223?3:C>191?2:1;if(x+V>f)break;V===1?C<128&&(B=C):V===2?(192&(k=i[x+1]))==128&&(B=(31&C)<<6|63&k)<=127&&(B=null):V===3?(A=i[x+2],(192&(k=i[x+1]))==128&&(192&A)==128&&((B=(15&C)<<12|(63&k)<<6|63&A)<=2047||B>=55296&&B<=57343)&&(B=null)):V===4&&(A=i[x+2],z=i[x+3],(192&(k=i[x+1]))==128&&(192&A)==128&&(192&z)==128&&((B=(15&C)<<18|(63&k)<<12|(63&A)<<6|63&z)<=65535||B>=1114112)&&(B=null)),B===null?(B=65533,V=1):B>65535&&(B-=65536,m+=String.fromCharCode(B>>>10&1023|55296),B=56320|1023&B),m+=String.fromCharCode(B),x+=V}return m}(this.buf,t,e)},readBytes:function(){var e=this.readVarint()+this.pos,t=this.buf.subarray(this.pos,e);return this.pos=e,t},readPackedVarint:function(e,t){if(this.type!==Vr.Bytes)return e.push(this.readVarint(t));var i=zo(this);for(e=e||[];this.pos<i;)e.push(this.readVarint(t));return e},readPackedSVarint:function(e){if(this.type!==Vr.Bytes)return e.push(this.readSVarint());var t=zo(this);for(e=e||[];this.pos<t;)e.push(this.readSVarint());return e},readPackedBoolean:function(e){if(this.type!==Vr.Bytes)return e.push(this.readBoolean());var t=zo(this);for(e=e||[];this.pos<t;)e.push(this.readBoolean());return e},readPackedFloat:function(e){if(this.type!==Vr.Bytes)return e.push(this.readFloat());var t=zo(this);for(e=e||[];this.pos<t;)e.push(this.readFloat());return e},readPackedDouble:function(e){if(this.type!==Vr.Bytes)return e.push(this.readDouble());var t=zo(this);for(e=e||[];this.pos<t;)e.push(this.readDouble());return e},readPackedFixed32:function(e){if(this.type!==Vr.Bytes)return e.push(this.readFixed32());var t=zo(this);for(e=e||[];this.pos<t;)e.push(this.readFixed32());return e},readPackedSFixed32:function(e){if(this.type!==Vr.Bytes)return e.push(this.readSFixed32());var t=zo(this);for(e=e||[];this.pos<t;)e.push(this.readSFixed32());return e},readPackedFixed64:function(e){if(this.type!==Vr.Bytes)return e.push(this.readFixed64());var t=zo(this);for(e=e||[];this.pos<t;)e.push(this.readFixed64());return e},readPackedSFixed64:function(e){if(this.type!==Vr.Bytes)return e.push(this.readSFixed64());var t=zo(this);for(e=e||[];this.pos<t;)e.push(this.readSFixed64());return e},skip:function(e){var t=7&e;if(t===Vr.Varint)for(;this.buf[this.pos++]>127;);else if(t===Vr.Bytes)this.pos=this.readVarint()+this.pos;else if(t===Vr.Fixed32)this.pos+=4;else{if(t!==Vr.Fixed64)throw new Error("Unimplemented type: "+t);this.pos+=8}},writeTag:function(e,t){this.writeVarint(e<<3|t)},realloc:function(e){for(var t=this.length||16;t<this.pos+e;)t*=2;if(t!==this.length){var i=new Uint8Array(t);i.set(this.buf),this.buf=i,this.length=t}},finish:function(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)},writeFixed32:function(e){this.realloc(4),ll(this.buf,e,this.pos),this.pos+=4},writeSFixed32:function(e){this.realloc(4),ll(this.buf,e,this.pos),this.pos+=4},writeFixed64:function(e){this.realloc(8),ll(this.buf,-1&e,this.pos),ll(this.buf,Math.floor(e*(1/4294967296)),this.pos+4),this.pos+=8},writeSFixed64:function(e){this.realloc(8),ll(this.buf,-1&e,this.pos),ll(this.buf,Math.floor(e*(1/4294967296)),this.pos+4),this.pos+=8},writeVarint:function(e){(e=+e||0)>268435455||e<0?function(t,i){var l,f;if(t>=0?(l=t%4294967296|0,f=t/4294967296|0):(f=~(-t/4294967296),4294967295^(l=~(-t%4294967296))?l=l+1|0:(l=0,f=f+1|0)),t>=18446744073709552e3||t<-18446744073709552e3)throw new Error("Given varint doesn't fit into 10 bytes");i.realloc(10),function(m,x,k){k.buf[k.pos++]=127&m|128,m>>>=7,k.buf[k.pos++]=127&m|128,m>>>=7,k.buf[k.pos++]=127&m|128,m>>>=7,k.buf[k.pos++]=127&m|128,k.buf[k.pos]=127&(m>>>=7)}(l,0,i),function(m,x){var k=(7&m)<<4;x.buf[x.pos++]|=k|((m>>>=3)?128:0),m&&(x.buf[x.pos++]=127&m|((m>>>=7)?128:0),m&&(x.buf[x.pos++]=127&m|((m>>>=7)?128:0),m&&(x.buf[x.pos++]=127&m|((m>>>=7)?128:0),m&&(x.buf[x.pos++]=127&m|((m>>>=7)?128:0),m&&(x.buf[x.pos++]=127&m)))))}(f,i)}(e,this):(this.realloc(4),this.buf[this.pos++]=127&e|(e>127?128:0),e<=127||(this.buf[this.pos++]=127&(e>>>=7)|(e>127?128:0),e<=127||(this.buf[this.pos++]=127&(e>>>=7)|(e>127?128:0),e<=127||(this.buf[this.pos++]=e>>>7&127))))},writeSVarint:function(e){this.writeVarint(e<0?2*-e-1:2*e)},writeBoolean:function(e){this.writeVarint(!!e)},writeString:function(e){e=String(e),this.realloc(4*e.length),this.pos++;var t=this.pos;this.pos=function(l,f,m){for(var x,k,A=0;A<f.length;A++){if((x=f.charCodeAt(A))>55295&&x<57344){if(!k){x>56319||A+1===f.length?(l[m++]=239,l[m++]=191,l[m++]=189):k=x;continue}if(x<56320){l[m++]=239,l[m++]=191,l[m++]=189,k=x;continue}x=k-55296<<10|x-56320|65536,k=null}else k&&(l[m++]=239,l[m++]=191,l[m++]=189,k=null);x<128?l[m++]=x:(x<2048?l[m++]=x>>6|192:(x<65536?l[m++]=x>>12|224:(l[m++]=x>>18|240,l[m++]=x>>12&63|128),l[m++]=x>>6&63|128),l[m++]=63&x|128)}return m}(this.buf,e,this.pos);var i=this.pos-t;i>=128&&ff(t,i,this),this.pos=t-1,this.writeVarint(i),this.pos+=i},writeFloat:function(e){this.realloc(4),hf(this.buf,e,this.pos,!0,23,4),this.pos+=4},writeDouble:function(e){this.realloc(8),hf(this.buf,e,this.pos,!0,52,8),this.pos+=8},writeBytes:function(e){var t=e.length;this.writeVarint(t),this.realloc(t);for(var i=0;i<t;i++)this.buf[this.pos++]=e[i]},writeRawMessage:function(e,t){this.pos++;var i=this.pos;e(t,this);var l=this.pos-i;l>=128&&ff(i,l,this),this.pos=i-1,this.writeVarint(l),this.pos+=l},writeMessage:function(e,t,i){this.writeTag(e,Vr.Bytes),this.writeRawMessage(t,i)},writePackedVarint:function(e,t){t.length&&this.writeMessage(e,pg,t)},writePackedSVarint:function(e,t){t.length&&this.writeMessage(e,fg,t)},writePackedBoolean:function(e,t){t.length&&this.writeMessage(e,yg,t)},writePackedFloat:function(e,t){t.length&&this.writeMessage(e,dg,t)},writePackedDouble:function(e,t){t.length&&this.writeMessage(e,mg,t)},writePackedFixed32:function(e,t){t.length&&this.writeMessage(e,gg,t)},writePackedSFixed32:function(e,t){t.length&&this.writeMessage(e,_g,t)},writePackedFixed64:function(e,t){t.length&&this.writeMessage(e,vg,t)},writePackedSFixed64:function(e,t){t.length&&this.writeMessage(e,bg,t)},writeBytesField:function(e,t){this.writeTag(e,Vr.Bytes),this.writeBytes(t)},writeFixed32Field:function(e,t){this.writeTag(e,Vr.Fixed32),this.writeFixed32(t)},writeSFixed32Field:function(e,t){this.writeTag(e,Vr.Fixed32),this.writeSFixed32(t)},writeFixed64Field:function(e,t){this.writeTag(e,Vr.Fixed64),this.writeFixed64(t)},writeSFixed64Field:function(e,t){this.writeTag(e,Vr.Fixed64),this.writeSFixed64(t)},writeVarintField:function(e,t){this.writeTag(e,Vr.Varint),this.writeVarint(t)},writeSVarintField:function(e,t){this.writeTag(e,Vr.Varint),this.writeSVarint(t)},writeStringField:function(e,t){this.writeTag(e,Vr.Bytes),this.writeString(t)},writeFloatField:function(e,t){this.writeTag(e,Vr.Fixed32),this.writeFloat(t)},writeDoubleField:function(e,t){this.writeTag(e,Vr.Fixed64),this.writeDouble(t)},writeBooleanField:function(e,t){this.writeVarintField(e,!!t)}};var Dc=function(e,t){var i=t.pixelRatio,l=t.version,f=t.stretchX,m=t.stretchY,x=t.content;this.paddedRect=e,this.pixelRatio=i,this.stretchX=f,this.stretchY=m,this.content=x,this.version=l},du={tl:{configurable:!0},br:{configurable:!0},tlbr:{configurable:!0},displaySize:{configurable:!0}};du.tl.get=function(){return[this.paddedRect.x+1,this.paddedRect.y+1]},du.br.get=function(){return[this.paddedRect.x+this.paddedRect.w-1,this.paddedRect.y+this.paddedRect.h-1]},du.tlbr.get=function(){return this.tl.concat(this.br)},du.displaySize.get=function(){return[(this.paddedRect.w-2)/this.pixelRatio,(this.paddedRect.h-2)/this.pixelRatio]},Object.defineProperties(Dc.prototype,du);var mu=function(e,t){var i={},l={};this.haveRenderCallbacks=[];var f=[];this.addImages(e,i,f),this.addImages(t,l,f);var m=mf(f),x=new Gn({width:m.w||1,height:m.h||1});for(var k in e){var A=e[k],z=i[k].paddedRect;Gn.copy(A.data,x,{x:0,y:0},{x:z.x+1,y:z.y+1},A.data)}for(var C in t){var B=t[C],V=l[C].paddedRect,j=V.x+1,J=V.y+1,$=B.data.width,he=B.data.height;Gn.copy(B.data,x,{x:0,y:0},{x:j,y:J},B.data),Gn.copy(B.data,x,{x:0,y:he-1},{x:j,y:J-1},{width:$,height:1}),Gn.copy(B.data,x,{x:0,y:0},{x:j,y:J+he},{width:$,height:1}),Gn.copy(B.data,x,{x:$-1,y:0},{x:j-1,y:J},{width:1,height:he}),Gn.copy(B.data,x,{x:0,y:0},{x:j+$,y:J},{width:1,height:he})}this.image=x,this.iconPositions=i,this.patternPositions=l};mu.prototype.addImages=function(e,t,i){for(var l in e){var f=e[l],m={x:0,y:0,w:f.data.width+2,h:f.data.height+2};i.push(m),t[l]=new Dc(m,f),f.hasRenderCallback&&this.haveRenderCallbacks.push(l)}},mu.prototype.patchUpdatedImages=function(e,t){for(var i in e.dispatchRenderCallbacks(this.haveRenderCallbacks),e.updatedImages)this.patchUpdatedImage(this.iconPositions[i],e.getImage(i),t),this.patchUpdatedImage(this.patternPositions[i],e.getImage(i),t)},mu.prototype.patchUpdatedImage=function(e,t,i){if(e&&t&&e.version!==t.version){e.version=t.version;var l=e.tl;i.update(t.data,void 0,{x:l[0],y:l[1]})}},dt("ImagePosition",Dc),dt("ImageAtlas",mu);var sa={horizontal:1,vertical:2,horizontalOnly:3},ul=function(){this.scale=1,this.fontStack="",this.imageName=null};ul.forText=function(e,t){var i=new ul;return i.scale=e||1,i.fontStack=t,i},ul.forImage=function(e){var t=new ul;return t.imageName=e,t};var wn=function(){this.text="",this.sectionIndex=[],this.sections=[],this.imageSectionID=null};function Lc(e,t,i,l,f,m,x,k,A,z,C,B,V,j,J,$){var he,ie=wn.fromFeature(e,f);B===sa.vertical&&ie.verticalizePunctuation();var me=Qn.processBidirectionalText,ve=Qn.processStyledBidirectionalText;if(me&&ie.sections.length===1){he=[];for(var we=0,ke=me(ie.toString(),np(ie,z,m,t,l,j,J));we<ke.length;we+=1){var Pe=ke[we],qe=new wn;qe.text=Pe,qe.sections=ie.sections;for(var et=0;et<Pe.length;et++)qe.sectionIndex.push(0);he.push(qe)}}else if(ve){he=[];for(var wt=0,st=ve(ie.text,ie.sectionIndex,np(ie,z,m,t,l,j,J));wt<st.length;wt+=1){var Tt=st[wt],lt=new wn;lt.text=Tt[0],lt.sectionIndex=Tt[1],lt.sections=ie.sections,he.push(lt)}}else he=function(_t,sr){for(var Gt=[],gr=_t.text,It=0,Sr=0,Jr=sr;Sr<Jr.length;Sr+=1){var ci=Jr[Sr];Gt.push(_t.substring(It,ci)),It=ci}return It<gr.length&&Gt.push(_t.substring(It,gr.length)),Gt}(ie,np(ie,z,m,t,l,j,J));var $t=[],Mt={positionedLines:$t,text:ie.toString(),top:C[1],bottom:C[1],left:C[0],right:C[0],writingMode:B,iconsInText:!1,verticalizable:!1};return function(_t,sr,Gt,gr,It,Sr,Jr,ci,ni,Qr,hi,Vi){for(var Ui=0,Sn=-17,Ji=0,kn=0,yi=ci==="right"?1:ci==="left"?0:.5,Qi=0,hr=0,Br=It;hr<Br.length;hr+=1){var zr=Br[hr];zr.trim();var vr=zr.getMaxScale(),Mn=24*(vr-1),fn={positionedGlyphs:[],lineOffset:0};_t.positionedLines[Qi]=fn;var Zr=fn.positionedGlyphs,ki=0;if(zr.length()){for(var dn=0;dn<zr.length();dn++){var kr=zr.getSection(dn),to=zr.getSectionIndex(dn),la=zr.getCharCode(dn),ro=0,gi=null,io=null,Pa=null,gl=24,Ps=!(ni===sa.horizontal||!hi&&!Xs(la)||hi&&(Rc[la]||(Do=la,it.Arabic(Do)||it["Arabic Supplement"](Do)||it["Arabic Extended-A"](Do)||it["Arabic Presentation Forms-A"](Do)||it["Arabic Presentation Forms-B"](Do))));if(kr.imageName){var _l=gr[kr.imageName];if(!_l)continue;Pa=kr.imageName,_t.iconsInText=_t.iconsInText||!0,io=_l.paddedRect;var Mo=_l.displaySize;kr.scale=24*kr.scale/Vi,ro=Mn+(24-Mo[1]*kr.scale),gl=(gi={width:Mo[0],height:Mo[1],left:1,top:-3,advance:Ps?Mo[1]:Mo[0]}).advance;var vl=Ps?Mo[0]*kr.scale-24*vr:Mo[1]*kr.scale-24*vr;vl>0&&vl>ki&&(ki=vl)}else{var Gc=Gt[kr.fontStack],bl=Gc&&Gc[la];if(bl&&bl.rect)io=bl.rect,gi=bl.metrics;else{var _u=sr[kr.fontStack],Zc=_u&&_u[la];if(!Zc)continue;gi=Zc.metrics}ro=24*(vr-kr.scale)}Ps?(_t.verticalizable=!0,Zr.push({glyph:la,imageName:Pa,x:Ui,y:Sn+ro,vertical:Ps,scale:kr.scale,fontStack:kr.fontStack,sectionIndex:to,metrics:gi,rect:io}),Ui+=gl*kr.scale+Qr):(Zr.push({glyph:la,imageName:Pa,x:Ui,y:Sn+ro,vertical:Ps,scale:kr.scale,fontStack:kr.fontStack,sectionIndex:to,metrics:gi,rect:io}),Ui+=gi.advance*kr.scale+Qr)}Zr.length!==0&&(Ji=Math.max(Ui-Qr,Ji),Eg(Zr,0,Zr.length-1,yi,ki)),Ui=0;var Kc=Sr*vr+ki;fn.lineOffset=Math.max(ki,Mn),Sn+=Kc,kn=Math.max(Kc,kn),++Qi}else Sn+=Sr,++Qi}var Do,vu=Sn- -17,xl=ap(Jr),Qo=xl.horizontalAlign,wl=xl.verticalAlign;(function(Hc,Xc,bu,xu,Wc,wu,Su,ku,Yc){var Sl,Jc=(Xc-bu)*Wc;Sl=wu!==Su?-ku*xu- -17:(-xu*Yc+.5)*Su;for(var kl=0,Eu=Hc;kl<Eu.length;kl+=1)for(var Cs=0,Tu=Eu[kl].positionedGlyphs;Cs<Tu.length;Cs+=1){var El=Tu[Cs];El.x+=Jc,El.y+=Sl}})(_t.positionedLines,yi,Qo,wl,Ji,kn,Sr,vu,It.length),_t.top+=-wl*vu,_t.bottom=_t.top+vu,_t.left+=-Qo*Ji,_t.right=_t.left+Ji}(Mt,t,i,l,he,x,k,A,B,z,V,$),!function(_t){for(var sr=0,Gt=_t;sr<Gt.length;sr+=1)if(Gt[sr].positionedGlyphs.length!==0)return!1;return!0}($t)&&Mt}wn.fromFeature=function(e,t){for(var i=new wn,l=0;l<e.sections.length;l++){var f=e.sections[l];f.image?i.addImageSection(f):i.addTextSection(f,t)}return i},wn.prototype.length=function(){return this.text.length},wn.prototype.getSection=function(e){return this.sections[this.sectionIndex[e]]},wn.prototype.getSectionIndex=function(e){return this.sectionIndex[e]},wn.prototype.getCharCode=function(e){return this.text.charCodeAt(e)},wn.prototype.verticalizePunctuation=function(){this.text=function(e){for(var t="",i=0;i<e.length;i++){var l=e.charCodeAt(i+1)||null,f=e.charCodeAt(i-1)||null;t+=l&&Ql(l)&&!fu[e[i+1]]||f&&Ql(f)&&!fu[e[i-1]]||!fu[e[i]]?e[i]:fu[e[i]]}return t}(this.text)},wn.prototype.trim=function(){for(var e=0,t=0;t<this.text.length&&Rc[this.text.charCodeAt(t)];t++)e++;for(var i=this.text.length,l=this.text.length-1;l>=0&&l>=e&&Rc[this.text.charCodeAt(l)];l--)i--;this.text=this.text.substring(e,i),this.sectionIndex=this.sectionIndex.slice(e,i)},wn.prototype.substring=function(e,t){var i=new wn;return i.text=this.text.substring(e,t),i.sectionIndex=this.sectionIndex.slice(e,t),i.sections=this.sections,i},wn.prototype.toString=function(){return this.text},wn.prototype.getMaxScale=function(){var e=this;return this.sectionIndex.reduce(function(t,i){return Math.max(t,e.sections[i].scale)},0)},wn.prototype.addTextSection=function(e,t){this.text+=e.text,this.sections.push(ul.forText(e.scale,e.fontStack||t));for(var i=this.sections.length-1,l=0;l<e.text.length;++l)this.sectionIndex.push(i)},wn.prototype.addImageSection=function(e){var t=e.image?e.image.name:"";if(t.length!==0){var i=this.getNextImageSectionCharCode();i?(this.text+=String.fromCharCode(i),this.sections.push(ul.forImage(t)),this.sectionIndex.push(this.sections.length-1)):Ne("Reached maximum number of images 6401")}else Ne("Can't add FormattedSection with an empty image.")},wn.prototype.getNextImageSectionCharCode=function(){return this.imageSectionID?this.imageSectionID>=63743?null:++this.imageSectionID:(this.imageSectionID=57344,this.imageSectionID)};var Rc={9:!0,10:!0,11:!0,12:!0,13:!0,32:!0},ea={};function yf(e,t,i,l,f,m){if(t.imageName){var x=l[t.imageName];return x?x.displaySize[0]*t.scale*24/m+f:0}var k=i[t.fontStack],A=k&&k[e];return A?A.metrics.advance*t.scale+f:0}function gf(e,t,i,l){var f=Math.pow(e-t,2);return l?e<t?f/2:2*f:f+Math.abs(i)*i}function kg(e,t,i){var l=0;return e===10&&(l-=1e4),i&&(l+=150),e!==40&&e!==65288||(l+=50),t!==41&&t!==65289||(l+=50),l}function _f(e,t,i,l,f,m){for(var x=null,k=gf(t,i,f,m),A=0,z=l;A<z.length;A+=1){var C=z[A],B=gf(t-C.x,i,f,m)+C.badness;B<=k&&(x=C,k=B)}return{index:e,x:t,priorBreak:x,badness:k}}function np(e,t,i,l,f,m,x){if(m!=="point")return[];if(!e)return[];for(var k,A=[],z=function(he,ie,me,ve,we,ke){for(var Pe=0,qe=0;qe<he.length();qe++){var et=he.getSection(qe);Pe+=yf(he.getCharCode(qe),et,ve,we,ie,ke)}return Pe/Math.max(1,Math.ceil(Pe/me))}(e,t,i,l,f,x),C=e.text.indexOf("​")>=0,B=0,V=0;V<e.length();V++){var j=e.getSection(V),J=e.getCharCode(V);if(Rc[J]||(B+=yf(J,j,l,f,t,x)),V<e.length()-1){var $=!((k=J)<11904||!(it["Bopomofo Extended"](k)||it.Bopomofo(k)||it["CJK Compatibility Forms"](k)||it["CJK Compatibility Ideographs"](k)||it["CJK Compatibility"](k)||it["CJK Radicals Supplement"](k)||it["CJK Strokes"](k)||it["CJK Symbols and Punctuation"](k)||it["CJK Unified Ideographs Extension A"](k)||it["CJK Unified Ideographs"](k)||it["Enclosed CJK Letters and Months"](k)||it["Halfwidth and Fullwidth Forms"](k)||it.Hiragana(k)||it["Ideographic Description Characters"](k)||it["Kangxi Radicals"](k)||it["Katakana Phonetic Extensions"](k)||it.Katakana(k)||it["Vertical Forms"](k)||it["Yi Radicals"](k)||it["Yi Syllables"](k)));(ea[J]||$||j.imageName)&&A.push(_f(V+1,B,z,A,kg(J,e.getCharCode(V+1),$&&C),!1))}}return function he(ie){return ie?he(ie.priorBreak).concat(ie.index):[]}(_f(e.length(),B,z,A,0,!0))}function ap(e){var t=.5,i=.5;switch(e){case"right":case"top-right":case"bottom-right":t=1;break;case"left":case"top-left":case"bottom-left":t=0}switch(e){case"bottom":case"bottom-right":case"bottom-left":i=1;break;case"top":case"top-right":case"top-left":i=0}return{horizontalAlign:t,verticalAlign:i}}function Eg(e,t,i,l,f){if(l||f)for(var m=e[i],x=(e[i].x+m.metrics.advance*m.scale)*l,k=t;k<=i;k++)e[k].x-=x,e[k].y+=f}function vf(e,t,i,l,f,m){var x,k=e.image;if(k.content){var A=k.content,z=k.pixelRatio||1;x=[A[0]/z,A[1]/z,k.displaySize[0]-A[2]/z,k.displaySize[1]-A[3]/z]}var C,B,V,j,J=t.left*m,$=t.right*m;i==="width"||i==="both"?(j=f[0]+J-l[3],B=f[0]+$+l[1]):B=(j=f[0]+(J+$-k.displaySize[0])/2)+k.displaySize[0];var he=t.top*m,ie=t.bottom*m;return i==="height"||i==="both"?(C=f[1]+he-l[0],V=f[1]+ie+l[2]):V=(C=f[1]+(he+ie-k.displaySize[1])/2)+k.displaySize[1],{image:k,top:C,right:B,bottom:V,left:j,collisionPadding:x}}ea[10]=!0,ea[32]=!0,ea[38]=!0,ea[40]=!0,ea[41]=!0,ea[43]=!0,ea[45]=!0,ea[47]=!0,ea[173]=!0,ea[183]=!0,ea[8203]=!0,ea[8208]=!0,ea[8211]=!0,ea[8231]=!0;var cl=function(e){function t(i,l,f,m){e.call(this,i,l),this.angle=f,m!==void 0&&(this.segment=m)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.clone=function(){return new t(this.x,this.y,this.angle,this.segment)},t}(F);function op(e,t){var i=t.expression;if(i.kind==="constant")return{kind:"constant",layoutSize:i.evaluate(new lr(e+1))};if(i.kind==="source")return{kind:"source"};for(var l=i.zoomStops,f=i.interpolationType,m=0;m<l.length&&l[m]<=e;)m++;for(var x=m=Math.max(0,m-1);x<l.length&&l[x]<e+1;)x++;x=Math.min(l.length-1,x);var k=l[m],A=l[x];return i.kind==="composite"?{kind:"composite",minZoom:k,maxZoom:A,interpolationType:f}:{kind:"camera",minZoom:k,maxZoom:A,minSize:i.evaluate(new lr(k)),maxSize:i.evaluate(new lr(A)),interpolationType:f}}function bf(e,t,i){var l=t.uSize,f=i.lowerSize;return e.kind==="source"?f/128:e.kind==="composite"?wi(f/128,i.upperSize/128,t.uSizeT):l}function xf(e,t){var i=0,l=0;if(e.kind==="constant")l=e.layoutSize;else if(e.kind!=="source"){var f=e.interpolationType,m=f?pe(an.interpolationFactor(f,t,e.minZoom,e.maxZoom),0,1):0;e.kind==="camera"?l=wi(e.minSize,e.maxSize,m):i=m}return{uSizeT:i,uSize:l}}dt("Anchor",cl);var Tg=Object.freeze({__proto__:null,getSizeData:op,evaluateSizeForFeature:bf,evaluateSizeForZoom:xf,SIZE_PACK_FACTOR:128});function wf(e,t,i,l,f){if(t.segment===void 0)return!0;for(var m=t,x=t.segment+1,k=0;k>-i/2;){if(--x<0)return!1;k-=e[x].dist(m),m=e[x]}k+=e[x].dist(e[x+1]),x++;for(var A=[],z=0;k<i/2;){var C=e[x],B=e[x+1];if(!B)return!1;var V=e[x-1].angleTo(C)-C.angleTo(B);for(V=Math.abs((V+3*Math.PI)%(2*Math.PI)-Math.PI),A.push({distance:k,angleDelta:V}),z+=V;k-A[0].distance>l;)z-=A.shift().angleDelta;if(z>f)return!1;x++,k+=C.dist(B)}return!0}function Sf(e){for(var t=0,i=0;i<e.length-1;i++)t+=e[i].dist(e[i+1]);return t}function kf(e,t,i){return e?.6*t*i:0}function Ef(e,t){return Math.max(e?e.right-e.left:0,t?t.right-t.left:0)}function Ig(e,t,i,l,f,m){for(var x=kf(i,f,m),k=Ef(i,l)*m,A=0,z=Sf(e)/2,C=0;C<e.length-1;C++){var B=e[C],V=e[C+1],j=B.dist(V);if(A+j>z){var J=(z-A)/j,$=wi(B.x,V.x,J),he=wi(B.y,V.y,J),ie=new cl($,he,V.angleTo(B),C);return ie._round(),!x||wf(e,ie,k,x,t)?ie:void 0}A+=j}}function Ag(e,t,i,l,f,m,x,k,A){var z=kf(l,m,x),C=Ef(l,f),B=C*x,V=e[0].x===0||e[0].x===A||e[0].y===0||e[0].y===A;return t-B<t/4&&(t=B+t/4),function j(J,$,he,ie,me,ve,we,ke,Pe){for(var qe=ve/2,et=Sf(J),wt=0,st=$-he,Tt=[],lt=0;lt<J.length-1;lt++){for(var $t=J[lt],Mt=J[lt+1],_t=$t.dist(Mt),sr=Mt.angleTo($t);st+he<wt+_t;){var Gt=((st+=he)-wt)/_t,gr=wi($t.x,Mt.x,Gt),It=wi($t.y,Mt.y,Gt);if(gr>=0&&gr<Pe&&It>=0&&It<Pe&&st-qe>=0&&st+qe<=et){var Sr=new cl(gr,It,sr,lt);Sr._round(),ie&&!wf(J,Sr,ve,ie,me)||Tt.push(Sr)}}wt+=_t}return ke||Tt.length||we||(Tt=j(J,wt/2,he,ie,me,ve,we,!0,Pe)),Tt}(e,V?t/2*k%t:(C/2+2*m)*x*k%t,t,z,i,B,V,!1,A)}function Tf(e,t,i,l,f){for(var m=[],x=0;x<e.length;x++)for(var k=e[x],A=void 0,z=0;z<k.length-1;z++){var C=k[z],B=k[z+1];C.x<t&&B.x<t||(C.x<t?C=new F(t,C.y+(t-C.x)/(B.x-C.x)*(B.y-C.y))._round():B.x<t&&(B=new F(t,C.y+(t-C.x)/(B.x-C.x)*(B.y-C.y))._round()),C.y<i&&B.y<i||(C.y<i?C=new F(C.x+(i-C.y)/(B.y-C.y)*(B.x-C.x),i)._round():B.y<i&&(B=new F(C.x+(i-C.y)/(B.y-C.y)*(B.x-C.x),i)._round()),C.x>=l&&B.x>=l||(C.x>=l?C=new F(l,C.y+(l-C.x)/(B.x-C.x)*(B.y-C.y))._round():B.x>=l&&(B=new F(l,C.y+(l-C.x)/(B.x-C.x)*(B.y-C.y))._round()),C.y>=f&&B.y>=f||(C.y>=f?C=new F(C.x+(f-C.y)/(B.y-C.y)*(B.x-C.x),f)._round():B.y>=f&&(B=new F(C.x+(f-C.y)/(B.y-C.y)*(B.x-C.x),f)._round()),A&&C.equals(A[A.length-1])||m.push(A=[C]),A.push(B)))))}return m}function If(e,t,i,l){var f=[],m=e.image,x=m.pixelRatio,k=m.paddedRect.w-2,A=m.paddedRect.h-2,z=e.right-e.left,C=e.bottom-e.top,B=m.stretchX||[[0,k]],V=m.stretchY||[[0,A]],j=function(gr,It){return gr+It[1]-It[0]},J=B.reduce(j,0),$=V.reduce(j,0),he=k-J,ie=A-$,me=0,ve=J,we=0,ke=$,Pe=0,qe=he,et=0,wt=ie;if(m.content&&l){var st=m.content;me=Bc(B,0,st[0]),we=Bc(V,0,st[1]),ve=Bc(B,st[0],st[2]),ke=Bc(V,st[1],st[3]),Pe=st[0]-me,et=st[1]-we,qe=st[2]-st[0]-ve,wt=st[3]-st[1]-ke}var Tt=function(gr,It,Sr,Jr){var ci=Oc(gr.stretch-me,ve,z,e.left),ni=Fc(gr.fixed-Pe,qe,gr.stretch,J),Qr=Oc(It.stretch-we,ke,C,e.top),hi=Fc(It.fixed-et,wt,It.stretch,$),Vi=Oc(Sr.stretch-me,ve,z,e.left),Ui=Fc(Sr.fixed-Pe,qe,Sr.stretch,J),Sn=Oc(Jr.stretch-we,ke,C,e.top),Ji=Fc(Jr.fixed-et,wt,Jr.stretch,$),kn=new F(ci,Qr),yi=new F(Vi,Qr),Qi=new F(Vi,Sn),hr=new F(ci,Sn),Br=new F(ni/x,hi/x),zr=new F(Ui/x,Ji/x),vr=t*Math.PI/180;if(vr){var Mn=Math.sin(vr),fn=Math.cos(vr),Zr=[fn,-Mn,Mn,fn];kn._matMult(Zr),yi._matMult(Zr),hr._matMult(Zr),Qi._matMult(Zr)}var ki=gr.stretch+gr.fixed,dn=It.stretch+It.fixed;return{tl:kn,tr:yi,bl:hr,br:Qi,tex:{x:m.paddedRect.x+1+ki,y:m.paddedRect.y+1+dn,w:Sr.stretch+Sr.fixed-ki,h:Jr.stretch+Jr.fixed-dn},writingMode:void 0,glyphOffset:[0,0],sectionIndex:0,pixelOffsetTL:Br,pixelOffsetBR:zr,minFontScaleX:qe/x/z,minFontScaleY:wt/x/C,isSDF:i}};if(l&&(m.stretchX||m.stretchY))for(var lt=Af(B,he,J),$t=Af(V,ie,$),Mt=0;Mt<lt.length-1;Mt++)for(var _t=lt[Mt],sr=lt[Mt+1],Gt=0;Gt<$t.length-1;Gt++)f.push(Tt(_t,$t[Gt],sr,$t[Gt+1]));else f.push(Tt({fixed:0,stretch:-1},{fixed:0,stretch:-1},{fixed:0,stretch:k+1},{fixed:0,stretch:A+1}));return f}function Bc(e,t,i){for(var l=0,f=0,m=e;f<m.length;f+=1){var x=m[f];l+=Math.max(t,Math.min(i,x[1]))-Math.max(t,Math.min(i,x[0]))}return l}function Af(e,t,i){for(var l=[{fixed:-1,stretch:0}],f=0,m=e;f<m.length;f+=1){var x=m[f],k=x[0],A=x[1],z=l[l.length-1];l.push({fixed:k-z.stretch,stretch:z.stretch}),l.push({fixed:k-z.stretch,stretch:z.stretch+(A-k)})}return l.push({fixed:t+1,stretch:i}),l}function Oc(e,t,i,l){return e/t*i+l}function Fc(e,t,i,l){return e-t*i/l}var Nc=function(e,t,i,l,f,m,x,k,A,z){if(this.boxStartIndex=e.length,A){var C=m.top,B=m.bottom,V=m.collisionPadding;V&&(C-=V[1],B+=V[3]);var j=B-C;j>0&&(j=Math.max(10,j),this.circleDiameter=j)}else{var J=m.top*x-k,$=m.bottom*x+k,he=m.left*x-k,ie=m.right*x+k,me=m.collisionPadding;if(me&&(he-=me[0]*x,J-=me[1]*x,ie+=me[2]*x,$+=me[3]*x),z){var ve=new F(he,J),we=new F(ie,J),ke=new F(he,$),Pe=new F(ie,$),qe=z*Math.PI/180;ve._rotate(qe),we._rotate(qe),ke._rotate(qe),Pe._rotate(qe),he=Math.min(ve.x,we.x,ke.x,Pe.x),ie=Math.max(ve.x,we.x,ke.x,Pe.x),J=Math.min(ve.y,we.y,ke.y,Pe.y),$=Math.max(ve.y,we.y,ke.y,Pe.y)}e.emplaceBack(t.x,t.y,he,J,ie,$,i,l,f)}this.boxEndIndex=e.length},hl=function(e,t){if(e===void 0&&(e=[]),t===void 0&&(t=zg),this.data=e,this.length=this.data.length,this.compare=t,this.length>0)for(var i=(this.length>>1)-1;i>=0;i--)this._down(i)};function zg(e,t){return e<t?-1:e>t?1:0}function Pg(e,t,i){t===void 0&&(t=1),i===void 0&&(i=!1);for(var l=1/0,f=1/0,m=-1/0,x=-1/0,k=e[0],A=0;A<k.length;A++){var z=k[A];(!A||z.x<l)&&(l=z.x),(!A||z.y<f)&&(f=z.y),(!A||z.x>m)&&(m=z.x),(!A||z.y>x)&&(x=z.y)}var C=Math.min(m-l,x-f),B=C/2,V=new hl([],Cg);if(C===0)return new F(l,f);for(var j=l;j<m;j+=C)for(var J=f;J<x;J+=C)V.push(new pl(j+B,J+B,B,e));for(var $=function(me){for(var ve=0,we=0,ke=0,Pe=me[0],qe=0,et=Pe.length,wt=et-1;qe<et;wt=qe++){var st=Pe[qe],Tt=Pe[wt],lt=st.x*Tt.y-Tt.x*st.y;we+=(st.x+Tt.x)*lt,ke+=(st.y+Tt.y)*lt,ve+=3*lt}return new pl(we/ve,ke/ve,0,me)}(e),he=V.length;V.length;){var ie=V.pop();(ie.d>$.d||!$.d)&&($=ie,i&&console.log("found best %d after %d probes",Math.round(1e4*ie.d)/1e4,he)),ie.max-$.d<=t||(V.push(new pl(ie.p.x-(B=ie.h/2),ie.p.y-B,B,e)),V.push(new pl(ie.p.x+B,ie.p.y-B,B,e)),V.push(new pl(ie.p.x-B,ie.p.y+B,B,e)),V.push(new pl(ie.p.x+B,ie.p.y+B,B,e)),he+=4)}return i&&(console.log("num probes: "+he),console.log("best distance: "+$.d)),$.p}function Cg(e,t){return t.max-e.max}function pl(e,t,i,l){this.p=new F(e,t),this.h=i,this.d=function(f,m){for(var x=!1,k=1/0,A=0;A<m.length;A++)for(var z=m[A],C=0,B=z.length,V=B-1;C<B;V=C++){var j=z[C],J=z[V];j.y>f.y!=J.y>f.y&&f.x<(J.x-j.x)*(f.y-j.y)/(J.y-j.y)+j.x&&(x=!x),k=Math.min(k,Xo(f,j,J))}return(x?1:-1)*Math.sqrt(k)}(this.p,l),this.max=this.d+this.h*Math.SQRT2}hl.prototype.push=function(e){this.data.push(e),this.length++,this._up(this.length-1)},hl.prototype.pop=function(){if(this.length!==0){var e=this.data[0],t=this.data.pop();return this.length--,this.length>0&&(this.data[0]=t,this._down(0)),e}},hl.prototype.peek=function(){return this.data[0]},hl.prototype._up=function(e){for(var t=this.data,i=this.compare,l=t[e];e>0;){var f=e-1>>1,m=t[f];if(i(l,m)>=0)break;t[e]=m,e=f}t[e]=l},hl.prototype._down=function(e){for(var t=this.data,i=this.compare,l=this.length>>1,f=t[e];e<l;){var m=1+(e<<1),x=t[m],k=m+1;if(k<this.length&&i(t[k],x)<0&&(m=k,x=t[k]),i(x,f)>=0)break;t[e]=x,e=m}t[e]=f};var sp=Number.POSITIVE_INFINITY;function zf(e,t){return t[1]!==sp?function(i,l,f){var m=0,x=0;switch(l=Math.abs(l),f=Math.abs(f),i){case"top-right":case"top-left":case"top":x=f-7;break;case"bottom-right":case"bottom-left":case"bottom":x=7-f}switch(i){case"top-right":case"bottom-right":case"right":m=-l;break;case"top-left":case"bottom-left":case"left":m=l}return[m,x]}(e,t[0],t[1]):function(i,l){var f=0,m=0;l<0&&(l=0);var x=l/Math.sqrt(2);switch(i){case"top-right":case"top-left":m=x-7;break;case"bottom-right":case"bottom-left":m=7-x;break;case"bottom":m=7-l;break;case"top":m=l-7}switch(i){case"top-right":case"bottom-right":f=-x;break;case"top-left":case"bottom-left":f=x;break;case"left":f=l;break;case"right":f=-l}return[f,m]}(e,t[0])}function lp(e){switch(e){case"right":case"top-right":case"bottom-right":return"right";case"left":case"top-left":case"bottom-left":return"left"}return"center"}function Pf(e,t,i,l,f,m,x,k,A,z,C,B,V,j,J){var $=function(we,ke,Pe,qe,et,wt,st,Tt){for(var lt=qe.layout.get("text-rotate").evaluate(wt,{})*Math.PI/180,$t=[],Mt=0,_t=ke.positionedLines;Mt<_t.length;Mt+=1)for(var sr=_t[Mt],Gt=0,gr=sr.positionedGlyphs;Gt<gr.length;Gt+=1){var It=gr[Gt];if(It.rect){var Sr=It.rect||{},Jr=4,ci=!0,ni=1,Qr=0,hi=(et||Tt)&&It.vertical,Vi=It.metrics.advance*It.scale/2;if(Tt&&ke.verticalizable&&(Qr=sr.lineOffset/2-(It.imageName?-(24-It.metrics.width*It.scale)/2:24*(It.scale-1))),It.imageName){var Ui=st[It.imageName];ci=Ui.sdf,Jr=1/(ni=Ui.pixelRatio)}var Sn=et?[It.x+Vi,It.y]:[0,0],Ji=et?[0,0]:[It.x+Vi+Pe[0],It.y+Pe[1]-Qr],kn=[0,0];hi&&(kn=Ji,Ji=[0,0]);var yi=(It.metrics.left-Jr)*It.scale-Vi+Ji[0],Qi=(-It.metrics.top-Jr)*It.scale+Ji[1],hr=yi+Sr.w*It.scale/ni,Br=Qi+Sr.h*It.scale/ni,zr=new F(yi,Qi),vr=new F(hr,Qi),Mn=new F(yi,Br),fn=new F(hr,Br);if(hi){var Zr=new F(-Vi,Vi- -17),ki=-Math.PI/2,dn=12-Vi,kr=new F(22-dn,-(It.imageName?dn:0)),to=new(Function.prototype.bind.apply(F,[null].concat(kn)));zr._rotateAround(ki,Zr)._add(kr)._add(to),vr._rotateAround(ki,Zr)._add(kr)._add(to),Mn._rotateAround(ki,Zr)._add(kr)._add(to),fn._rotateAround(ki,Zr)._add(kr)._add(to)}if(lt){var la=Math.sin(lt),ro=Math.cos(lt),gi=[ro,-la,la,ro];zr._matMult(gi),vr._matMult(gi),Mn._matMult(gi),fn._matMult(gi)}var io=new F(0,0),Pa=new F(0,0);$t.push({tl:zr,tr:vr,bl:Mn,br:fn,tex:Sr,writingMode:ke.writingMode,glyphOffset:Sn,sectionIndex:It.sectionIndex,isSDF:ci,pixelOffsetTL:io,pixelOffsetBR:Pa,minFontScaleX:0,minFontScaleY:0})}}return $t}(0,i,k,f,m,x,l,e.allowVerticalPlacement),he=e.textSizeData,ie=null;he.kind==="source"?(ie=[128*f.layout.get("text-size").evaluate(x,{})])[0]>32640&&Ne(e.layerIds[0]+': Value for "text-size" is >= 255. Reduce your "text-size".'):he.kind==="composite"&&((ie=[128*j.compositeTextSizes[0].evaluate(x,{},J),128*j.compositeTextSizes[1].evaluate(x,{},J)])[0]>32640||ie[1]>32640)&&Ne(e.layerIds[0]+': Value for "text-size" is >= 255. Reduce your "text-size".'),e.addSymbols(e.text,$,ie,k,m,x,z,t,A.lineStartIndex,A.lineLength,V,J);for(var me=0,ve=C;me<ve.length;me+=1)B[ve[me]]=e.text.placedSymbolArray.length-1;return 4*$.length}function Cf(e){for(var t in e)return e[t];return null}function Mg(e,t,i,l){var f=e.compareText;if(t in f){for(var m=f[t],x=m.length-1;x>=0;x--)if(l.dist(m[x])<i)return!0}else f[t]=[];return f[t].push(l),!1}var Dg=ol.VectorTileFeature.types,Lg=[{name:"a_fade_opacity",components:1,type:"Uint8",offset:0}];function Vc(e,t,i,l,f,m,x,k,A,z,C,B,V){var j=k?Math.min(32640,Math.round(k[0])):0,J=k?Math.min(32640,Math.round(k[1])):0;e.emplaceBack(t,i,Math.round(32*l),Math.round(32*f),m,x,(j<<1)+(A?1:0),J,16*z,16*C,256*B,256*V)}function up(e,t,i){e.emplaceBack(t.x,t.y,i),e.emplaceBack(t.x,t.y,i),e.emplaceBack(t.x,t.y,i),e.emplaceBack(t.x,t.y,i)}function Rg(e){for(var t=0,i=e.sections;t<i.length;t+=1)if(Ws(i[t].text))return!0;return!1}var fl=function(e){this.layoutVertexArray=new $s,this.indexArray=new Wa,this.programConfigurations=e,this.segments=new Z,this.dynamicLayoutVertexArray=new Zo,this.opacityVertexArray=new bs,this.placedSymbolArray=new c};fl.prototype.isEmpty=function(){return this.layoutVertexArray.length===0&&this.indexArray.length===0&&this.dynamicLayoutVertexArray.length===0&&this.opacityVertexArray.length===0},fl.prototype.upload=function(e,t,i,l){this.isEmpty()||(i&&(this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,sg.members),this.indexBuffer=e.createIndexBuffer(this.indexArray,t),this.dynamicLayoutVertexBuffer=e.createVertexBuffer(this.dynamicLayoutVertexArray,lg.members,!0),this.opacityVertexBuffer=e.createVertexBuffer(this.opacityVertexArray,Lg,!0),this.opacityVertexBuffer.itemSize=1),(i||l)&&this.programConfigurations.upload(e))},fl.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.dynamicLayoutVertexBuffer.destroy(),this.opacityVertexBuffer.destroy())},dt("SymbolBuffers",fl);var yu=function(e,t,i){this.layoutVertexArray=new e,this.layoutAttributes=t,this.indexArray=new i,this.segments=new Z,this.collisionVertexArray=new nu};yu.prototype.upload=function(e){this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,this.layoutAttributes),this.indexBuffer=e.createIndexBuffer(this.indexArray),this.collisionVertexBuffer=e.createVertexBuffer(this.collisionVertexArray,ug.members,!0)},yu.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.collisionVertexBuffer.destroy())},dt("CollisionBuffers",yu);var Cr=function(e){this.collisionBoxArray=e.collisionBoxArray,this.zoom=e.zoom,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map(function(m){return m.id}),this.index=e.index,this.pixelRatio=e.pixelRatio,this.sourceLayerIndex=e.sourceLayerIndex,this.hasPattern=!1,this.hasRTLText=!1,this.sortKeyRanges=[],this.collisionCircleArray=[],this.placementInvProjMatrix=$n([]),this.placementViewportMatrix=$n([]);var t=this.layers[0]._unevaluatedLayout._values;this.textSizeData=op(this.zoom,t["text-size"]),this.iconSizeData=op(this.zoom,t["icon-size"]);var i=this.layers[0].layout,l=i.get("symbol-sort-key"),f=i.get("symbol-z-order");this.canOverlap=i.get("text-allow-overlap")||i.get("icon-allow-overlap")||i.get("text-ignore-placement")||i.get("icon-ignore-placement"),this.sortFeaturesByKey=f!=="viewport-y"&&l.constantOr(1)!==void 0,this.sortFeaturesByY=(f==="viewport-y"||f==="auto"&&!this.sortFeaturesByKey)&&this.canOverlap,i.get("symbol-placement")==="point"&&(this.writingModes=i.get("text-writing-mode").map(function(m){return sa[m]})),this.stateDependentLayerIds=this.layers.filter(function(m){return m.isStateDependent()}).map(function(m){return m.id}),this.sourceID=e.sourceID};Cr.prototype.createArrays=function(){this.text=new fl(new Ct(this.layers,this.zoom,function(e){return/^text/.test(e)})),this.icon=new fl(new Ct(this.layers,this.zoom,function(e){return/^icon/.test(e)})),this.glyphOffsetArray=new S,this.lineVertexArray=new E,this.symbolInstances=new w},Cr.prototype.calculateGlyphDependencies=function(e,t,i,l,f){for(var m=0;m<e.length;m++)if(t[e.charCodeAt(m)]=!0,(i||l)&&f){var x=fu[e.charAt(m)];x&&(t[x.charCodeAt(0)]=!0)}},Cr.prototype.populate=function(e,t,i){var l=this.layers[0],f=l.layout,m=f.get("text-font"),x=f.get("text-field"),k=f.get("icon-image"),A=(x.value.kind!=="constant"||x.value.value instanceof si&&!x.value.value.isEmpty()||x.value.value.toString().length>0)&&(m.value.kind!=="constant"||m.value.value.length>0),z=k.value.kind!=="constant"||!!k.value.value||Object.keys(k.parameters).length>0,C=f.get("symbol-sort-key");if(this.features=[],A||z){for(var B=t.iconDependencies,V=t.glyphDependencies,j=t.availableImages,J=new lr(this.zoom),$=0,he=e;$<he.length;$+=1){var ie=he[$],me=ie.feature,ve=ie.id,we=ie.index,ke=ie.sourceLayerIndex,Pe=l._featureFilter.needGeometry,qe=mi(me,Pe);if(l._featureFilter.filter(J,qe,i)){Pe||(qe.geometry=ii(me));var et=void 0;if(A){var wt=l.getValueAndResolveTokens("text-field",qe,i,j),st=si.factory(wt);Rg(st)&&(this.hasRTLText=!0),(!this.hasRTLText||eu()==="unavailable"||this.hasRTLText&&Qn.isParsed())&&(et=hg(st,l,qe))}var Tt=void 0;if(z){var lt=l.getValueAndResolveTokens("icon-image",qe,i,j);Tt=lt instanceof Oi?lt:Oi.fromString(lt)}if(et||Tt){var $t=this.sortFeaturesByKey?C.evaluate(qe,{},i):void 0;if(this.features.push({id:ve,text:et,icon:Tt,index:we,sourceLayerIndex:ke,geometry:qe.geometry,properties:me.properties,type:Dg[me.type],sortKey:$t}),Tt&&(B[Tt.name]=!0),et){var Mt=m.evaluate(qe,{},i).join(","),_t=f.get("text-rotation-alignment")==="map"&&f.get("symbol-placement")!=="point";this.allowVerticalPlacement=this.writingModes&&this.writingModes.indexOf(sa.vertical)>=0;for(var sr=0,Gt=et.sections;sr<Gt.length;sr+=1){var gr=Gt[sr];if(gr.image)B[gr.image.name]=!0;else{var It=Jl(et.toString()),Sr=gr.fontStack||Mt,Jr=V[Sr]=V[Sr]||{};this.calculateGlyphDependencies(gr.text,Jr,_t,this.allowVerticalPlacement,It)}}}}}}f.get("symbol-placement")==="line"&&(this.features=function(ci){var ni={},Qr={},hi=[],Vi=0;function Ui(Zr){hi.push(ci[Zr]),Vi++}function Sn(Zr,ki,dn){var kr=Qr[Zr];return delete Qr[Zr],Qr[ki]=kr,hi[kr].geometry[0].pop(),hi[kr].geometry[0]=hi[kr].geometry[0].concat(dn[0]),kr}function Ji(Zr,ki,dn){var kr=ni[ki];return delete ni[ki],ni[Zr]=kr,hi[kr].geometry[0].shift(),hi[kr].geometry[0]=dn[0].concat(hi[kr].geometry[0]),kr}function kn(Zr,ki,dn){var kr=dn?ki[0][ki[0].length-1]:ki[0][0];return Zr+":"+kr.x+":"+kr.y}for(var yi=0;yi<ci.length;yi++){var Qi=ci[yi],hr=Qi.geometry,Br=Qi.text?Qi.text.toString():null;if(Br){var zr=kn(Br,hr),vr=kn(Br,hr,!0);if(zr in Qr&&vr in ni&&Qr[zr]!==ni[vr]){var Mn=Ji(zr,vr,hr),fn=Sn(zr,vr,hi[Mn].geometry);delete ni[zr],delete Qr[vr],Qr[kn(Br,hi[fn].geometry,!0)]=fn,hi[Mn].geometry=null}else zr in Qr?Sn(zr,vr,hr):vr in ni?Ji(zr,vr,hr):(Ui(yi),ni[zr]=Vi-1,Qr[vr]=Vi-1)}else Ui(yi)}return hi.filter(function(Zr){return Zr.geometry})}(this.features)),this.sortFeaturesByKey&&this.features.sort(function(ci,ni){return ci.sortKey-ni.sortKey})}},Cr.prototype.update=function(e,t,i){this.stateDependentLayers.length&&(this.text.programConfigurations.updatePaintArrays(e,t,this.layers,i),this.icon.programConfigurations.updatePaintArrays(e,t,this.layers,i))},Cr.prototype.isEmpty=function(){return this.symbolInstances.length===0&&!this.hasRTLText},Cr.prototype.uploadPending=function(){return!this.uploaded||this.text.programConfigurations.needsUpload||this.icon.programConfigurations.needsUpload},Cr.prototype.upload=function(e){!this.uploaded&&this.hasDebugData()&&(this.textCollisionBox.upload(e),this.iconCollisionBox.upload(e)),this.text.upload(e,this.sortFeaturesByY,!this.uploaded,this.text.programConfigurations.needsUpload),this.icon.upload(e,this.sortFeaturesByY,!this.uploaded,this.icon.programConfigurations.needsUpload),this.uploaded=!0},Cr.prototype.destroyDebugData=function(){this.textCollisionBox.destroy(),this.iconCollisionBox.destroy()},Cr.prototype.destroy=function(){this.text.destroy(),this.icon.destroy(),this.hasDebugData()&&this.destroyDebugData()},Cr.prototype.addToLineVertexArray=function(e,t){var i=this.lineVertexArray.length;if(e.segment!==void 0){for(var l=e.dist(t[e.segment+1]),f=e.dist(t[e.segment]),m={},x=e.segment+1;x<t.length;x++)m[x]={x:t[x].x,y:t[x].y,tileUnitDistanceFromAnchor:l},x<t.length-1&&(l+=t[x+1].dist(t[x]));for(var k=e.segment||0;k>=0;k--)m[k]={x:t[k].x,y:t[k].y,tileUnitDistanceFromAnchor:f},k>0&&(f+=t[k-1].dist(t[k]));for(var A=0;A<t.length;A++){var z=m[A];this.lineVertexArray.emplaceBack(z.x,z.y,z.tileUnitDistanceFromAnchor)}}return{lineStartIndex:i,lineLength:this.lineVertexArray.length-i}},Cr.prototype.addSymbols=function(e,t,i,l,f,m,x,k,A,z,C,B){for(var V=e.indexArray,j=e.layoutVertexArray,J=e.segments.prepareSegment(4*t.length,j,V,this.canOverlap?m.sortKey:void 0),$=this.glyphOffsetArray.length,he=J.vertexLength,ie=this.allowVerticalPlacement&&x===sa.vertical?Math.PI/2:0,me=m.text&&m.text.sections,ve=0;ve<t.length;ve++){var we=t[ve],ke=we.tl,Pe=we.tr,qe=we.bl,et=we.br,wt=we.tex,st=we.pixelOffsetTL,Tt=we.pixelOffsetBR,lt=we.minFontScaleX,$t=we.minFontScaleY,Mt=we.glyphOffset,_t=we.isSDF,sr=we.sectionIndex,Gt=J.vertexLength,gr=Mt[1];Vc(j,k.x,k.y,ke.x,gr+ke.y,wt.x,wt.y,i,_t,st.x,st.y,lt,$t),Vc(j,k.x,k.y,Pe.x,gr+Pe.y,wt.x+wt.w,wt.y,i,_t,Tt.x,st.y,lt,$t),Vc(j,k.x,k.y,qe.x,gr+qe.y,wt.x,wt.y+wt.h,i,_t,st.x,Tt.y,lt,$t),Vc(j,k.x,k.y,et.x,gr+et.y,wt.x+wt.w,wt.y+wt.h,i,_t,Tt.x,Tt.y,lt,$t),up(e.dynamicLayoutVertexArray,k,ie),V.emplaceBack(Gt,Gt+1,Gt+2),V.emplaceBack(Gt+1,Gt+2,Gt+3),J.vertexLength+=4,J.primitiveLength+=2,this.glyphOffsetArray.emplaceBack(Mt[0]),ve!==t.length-1&&sr===t[ve+1].sectionIndex||e.programConfigurations.populatePaintArrays(j.length,m,m.index,{},B,me&&me[sr])}e.placedSymbolArray.emplaceBack(k.x,k.y,$,this.glyphOffsetArray.length-$,he,A,z,k.segment,i?i[0]:0,i?i[1]:0,l[0],l[1],x,0,!1,0,C)},Cr.prototype._addCollisionDebugVertex=function(e,t,i,l,f,m){return t.emplaceBack(0,0),e.emplaceBack(i.x,i.y,l,f,Math.round(m.x),Math.round(m.y))},Cr.prototype.addCollisionDebugVertices=function(e,t,i,l,f,m,x){var k=f.segments.prepareSegment(4,f.layoutVertexArray,f.indexArray),A=k.vertexLength,z=f.layoutVertexArray,C=f.collisionVertexArray,B=x.anchorX,V=x.anchorY;this._addCollisionDebugVertex(z,C,m,B,V,new F(e,t)),this._addCollisionDebugVertex(z,C,m,B,V,new F(i,t)),this._addCollisionDebugVertex(z,C,m,B,V,new F(i,l)),this._addCollisionDebugVertex(z,C,m,B,V,new F(e,l)),k.vertexLength+=4;var j=f.indexArray;j.emplaceBack(A,A+1),j.emplaceBack(A+1,A+2),j.emplaceBack(A+2,A+3),j.emplaceBack(A+3,A),k.primitiveLength+=4},Cr.prototype.addDebugCollisionBoxes=function(e,t,i,l){for(var f=e;f<t;f++){var m=this.collisionBoxArray.get(f);this.addCollisionDebugVertices(m.x1,m.y1,m.x2,m.y2,l?this.textCollisionBox:this.iconCollisionBox,m.anchorPoint,i)}},Cr.prototype.generateCollisionDebugBuffers=function(){this.hasDebugData()&&this.destroyDebugData(),this.textCollisionBox=new yu(Ko,uf.members,xs),this.iconCollisionBox=new yu(Ko,uf.members,xs);for(var e=0;e<this.symbolInstances.length;e++){var t=this.symbolInstances.get(e);this.addDebugCollisionBoxes(t.textBoxStartIndex,t.textBoxEndIndex,t,!0),this.addDebugCollisionBoxes(t.verticalTextBoxStartIndex,t.verticalTextBoxEndIndex,t,!0),this.addDebugCollisionBoxes(t.iconBoxStartIndex,t.iconBoxEndIndex,t,!1),this.addDebugCollisionBoxes(t.verticalIconBoxStartIndex,t.verticalIconBoxEndIndex,t,!1)}},Cr.prototype._deserializeCollisionBoxesForSymbol=function(e,t,i,l,f,m,x,k,A){for(var z={},C=t;C<i;C++){var B=e.get(C);z.textBox={x1:B.x1,y1:B.y1,x2:B.x2,y2:B.y2,anchorPointX:B.anchorPointX,anchorPointY:B.anchorPointY},z.textFeatureIndex=B.featureIndex;break}for(var V=l;V<f;V++){var j=e.get(V);z.verticalTextBox={x1:j.x1,y1:j.y1,x2:j.x2,y2:j.y2,anchorPointX:j.anchorPointX,anchorPointY:j.anchorPointY},z.verticalTextFeatureIndex=j.featureIndex;break}for(var J=m;J<x;J++){var $=e.get(J);z.iconBox={x1:$.x1,y1:$.y1,x2:$.x2,y2:$.y2,anchorPointX:$.anchorPointX,anchorPointY:$.anchorPointY},z.iconFeatureIndex=$.featureIndex;break}for(var he=k;he<A;he++){var ie=e.get(he);z.verticalIconBox={x1:ie.x1,y1:ie.y1,x2:ie.x2,y2:ie.y2,anchorPointX:ie.anchorPointX,anchorPointY:ie.anchorPointY},z.verticalIconFeatureIndex=ie.featureIndex;break}return z},Cr.prototype.deserializeCollisionBoxes=function(e){this.collisionArrays=[];for(var t=0;t<this.symbolInstances.length;t++){var i=this.symbolInstances.get(t);this.collisionArrays.push(this._deserializeCollisionBoxesForSymbol(e,i.textBoxStartIndex,i.textBoxEndIndex,i.verticalTextBoxStartIndex,i.verticalTextBoxEndIndex,i.iconBoxStartIndex,i.iconBoxEndIndex,i.verticalIconBoxStartIndex,i.verticalIconBoxEndIndex))}},Cr.prototype.hasTextData=function(){return this.text.segments.get().length>0},Cr.prototype.hasIconData=function(){return this.icon.segments.get().length>0},Cr.prototype.hasDebugData=function(){return this.textCollisionBox&&this.iconCollisionBox},Cr.prototype.hasTextCollisionBoxData=function(){return this.hasDebugData()&&this.textCollisionBox.segments.get().length>0},Cr.prototype.hasIconCollisionBoxData=function(){return this.hasDebugData()&&this.iconCollisionBox.segments.get().length>0},Cr.prototype.addIndicesForPlacedSymbol=function(e,t){for(var i=e.placedSymbolArray.get(t),l=i.vertexStartIndex+4*i.numGlyphs,f=i.vertexStartIndex;f<l;f+=4)e.indexArray.emplaceBack(f,f+1,f+2),e.indexArray.emplaceBack(f+1,f+2,f+3)},Cr.prototype.getSortedSymbolIndexes=function(e){if(this.sortedAngle===e&&this.symbolInstanceIndexes!==void 0)return this.symbolInstanceIndexes;for(var t=Math.sin(e),i=Math.cos(e),l=[],f=[],m=[],x=0;x<this.symbolInstances.length;++x){m.push(x);var k=this.symbolInstances.get(x);l.push(0|Math.round(t*k.anchorX+i*k.anchorY)),f.push(k.featureIndex)}return m.sort(function(A,z){return l[A]-l[z]||f[z]-f[A]}),m},Cr.prototype.addToSortKeyRanges=function(e,t){var i=this.sortKeyRanges[this.sortKeyRanges.length-1];i&&i.sortKey===t?i.symbolInstanceEnd=e+1:this.sortKeyRanges.push({sortKey:t,symbolInstanceStart:e,symbolInstanceEnd:e+1})},Cr.prototype.sortFeatures=function(e){var t=this;if(this.sortFeaturesByY&&this.sortedAngle!==e&&!(this.text.segments.get().length>1||this.icon.segments.get().length>1)){this.symbolInstanceIndexes=this.getSortedSymbolIndexes(e),this.sortedAngle=e,this.text.indexArray.clear(),this.icon.indexArray.clear(),this.featureSortOrder=[];for(var i=0,l=this.symbolInstanceIndexes;i<l.length;i+=1){var f=this.symbolInstances.get(l[i]);this.featureSortOrder.push(f.featureIndex),[f.rightJustifiedTextSymbolIndex,f.centerJustifiedTextSymbolIndex,f.leftJustifiedTextSymbolIndex].forEach(function(m,x,k){m>=0&&k.indexOf(m)===x&&t.addIndicesForPlacedSymbol(t.text,m)}),f.verticalPlacedTextSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.text,f.verticalPlacedTextSymbolIndex),f.placedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,f.placedIconSymbolIndex),f.verticalPlacedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,f.verticalPlacedIconSymbolIndex)}this.text.indexBuffer&&this.text.indexBuffer.updateData(this.text.indexArray),this.icon.indexBuffer&&this.icon.indexBuffer.updateData(this.icon.indexArray)}},dt("SymbolBucket",Cr,{omit:["layers","collisionBoxArray","features","compareText"]}),Cr.MAX_GLYPHS=65535,Cr.addDynamicAttributes=up;var Bg=new sn({"symbol-placement":new kt(U.layout_symbol["symbol-placement"]),"symbol-spacing":new kt(U.layout_symbol["symbol-spacing"]),"symbol-avoid-edges":new kt(U.layout_symbol["symbol-avoid-edges"]),"symbol-sort-key":new gt(U.layout_symbol["symbol-sort-key"]),"symbol-z-order":new kt(U.layout_symbol["symbol-z-order"]),"icon-allow-overlap":new kt(U.layout_symbol["icon-allow-overlap"]),"icon-ignore-placement":new kt(U.layout_symbol["icon-ignore-placement"]),"icon-optional":new kt(U.layout_symbol["icon-optional"]),"icon-rotation-alignment":new kt(U.layout_symbol["icon-rotation-alignment"]),"icon-size":new gt(U.layout_symbol["icon-size"]),"icon-text-fit":new kt(U.layout_symbol["icon-text-fit"]),"icon-text-fit-padding":new kt(U.layout_symbol["icon-text-fit-padding"]),"icon-image":new gt(U.layout_symbol["icon-image"]),"icon-rotate":new gt(U.layout_symbol["icon-rotate"]),"icon-padding":new kt(U.layout_symbol["icon-padding"]),"icon-keep-upright":new kt(U.layout_symbol["icon-keep-upright"]),"icon-offset":new gt(U.layout_symbol["icon-offset"]),"icon-anchor":new gt(U.layout_symbol["icon-anchor"]),"icon-pitch-alignment":new kt(U.layout_symbol["icon-pitch-alignment"]),"text-pitch-alignment":new kt(U.layout_symbol["text-pitch-alignment"]),"text-rotation-alignment":new kt(U.layout_symbol["text-rotation-alignment"]),"text-field":new gt(U.layout_symbol["text-field"]),"text-font":new gt(U.layout_symbol["text-font"]),"text-size":new gt(U.layout_symbol["text-size"]),"text-max-width":new gt(U.layout_symbol["text-max-width"]),"text-line-height":new kt(U.layout_symbol["text-line-height"]),"text-letter-spacing":new gt(U.layout_symbol["text-letter-spacing"]),"text-justify":new gt(U.layout_symbol["text-justify"]),"text-radial-offset":new gt(U.layout_symbol["text-radial-offset"]),"text-variable-anchor":new kt(U.layout_symbol["text-variable-anchor"]),"text-anchor":new gt(U.layout_symbol["text-anchor"]),"text-max-angle":new kt(U.layout_symbol["text-max-angle"]),"text-writing-mode":new kt(U.layout_symbol["text-writing-mode"]),"text-rotate":new gt(U.layout_symbol["text-rotate"]),"text-padding":new kt(U.layout_symbol["text-padding"]),"text-keep-upright":new kt(U.layout_symbol["text-keep-upright"]),"text-transform":new gt(U.layout_symbol["text-transform"]),"text-offset":new gt(U.layout_symbol["text-offset"]),"text-allow-overlap":new kt(U.layout_symbol["text-allow-overlap"]),"text-ignore-placement":new kt(U.layout_symbol["text-ignore-placement"]),"text-optional":new kt(U.layout_symbol["text-optional"])}),cp={paint:new sn({"icon-opacity":new gt(U.paint_symbol["icon-opacity"]),"icon-color":new gt(U.paint_symbol["icon-color"]),"icon-halo-color":new gt(U.paint_symbol["icon-halo-color"]),"icon-halo-width":new gt(U.paint_symbol["icon-halo-width"]),"icon-halo-blur":new gt(U.paint_symbol["icon-halo-blur"]),"icon-translate":new kt(U.paint_symbol["icon-translate"]),"icon-translate-anchor":new kt(U.paint_symbol["icon-translate-anchor"]),"text-opacity":new gt(U.paint_symbol["text-opacity"]),"text-color":new gt(U.paint_symbol["text-color"],{runtimeType:rt,getOverride:function(e){return e.textColor},hasOverride:function(e){return!!e.textColor}}),"text-halo-color":new gt(U.paint_symbol["text-halo-color"]),"text-halo-width":new gt(U.paint_symbol["text-halo-width"]),"text-halo-blur":new gt(U.paint_symbol["text-halo-blur"]),"text-translate":new kt(U.paint_symbol["text-translate"]),"text-translate-anchor":new kt(U.paint_symbol["text-translate-anchor"])}),layout:Bg},dl=function(e){this.type=e.property.overrides?e.property.overrides.runtimeType:at,this.defaultValue=e};dl.prototype.evaluate=function(e){if(e.formattedSection){var t=this.defaultValue.property.overrides;if(t&&t.hasOverride(e.formattedSection))return t.getOverride(e.formattedSection)}return e.feature&&e.featureState?this.defaultValue.evaluate(e.feature,e.featureState):this.defaultValue.property.specification.default},dl.prototype.eachChild=function(e){this.defaultValue.isConstant()||e(this.defaultValue.value._styleExpression.expression)},dl.prototype.outputDefined=function(){return!1},dl.prototype.serialize=function(){return null},dt("FormatSectionOverride",dl,{omit:["defaultValue"]});var Og=function(e){function t(i){e.call(this,i,cp)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.recalculate=function(i,l){if(e.prototype.recalculate.call(this,i,l),this.layout.get("icon-rotation-alignment")==="auto"&&(this.layout._values["icon-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-rotation-alignment")==="auto"&&(this.layout._values["text-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-pitch-alignment")==="auto"&&(this.layout._values["text-pitch-alignment"]=this.layout.get("text-rotation-alignment")),this.layout.get("icon-pitch-alignment")==="auto"&&(this.layout._values["icon-pitch-alignment"]=this.layout.get("icon-rotation-alignment")),this.layout.get("symbol-placement")==="point"){var f=this.layout.get("text-writing-mode");if(f){for(var m=[],x=0,k=f;x<k.length;x+=1){var A=k[x];m.indexOf(A)<0&&m.push(A)}this.layout._values["text-writing-mode"]=m}else this.layout._values["text-writing-mode"]=["horizontal"]}this._setPaintOverrides()},t.prototype.getValueAndResolveTokens=function(i,l,f,m){var x=this.layout.get(i).evaluate(l,{},f,m),k=this._unevaluatedLayout._values[i];return k.isDataDriven()||us(k.value)||!x?x:function(A,z){return z.replace(/{([^{}]+)}/g,function(C,B){return B in A?String(A[B]):""})}(l.properties,x)},t.prototype.createBucket=function(i){return new Cr(i)},t.prototype.queryRadius=function(){return 0},t.prototype.queryIntersectsFeature=function(){return!1},t.prototype._setPaintOverrides=function(){for(var i=0,l=cp.paint.overridableProperties;i<l.length;i+=1){var f=l[i];if(t.hasPaintOverride(this.layout,f)){var m,x=this.paint.get(f),k=new dl(x),A=new No(k,x.property.specification);m=x.value.kind==="constant"||x.value.kind==="source"?new cs("source",A):new Vo("composite",A,x.value.zoomStops,x.value._interpolationType),this.paint._values[f]=new vn(x.property,m,x.parameters)}}},t.prototype._handleOverridablePaintPropertyUpdate=function(i,l,f){return!(!this.layout||l.isDataDriven()||f.isDataDriven())&&t.hasPaintOverride(this.layout,i)},t.hasPaintOverride=function(i,l){var f=i.get("text-field"),m=cp.paint.properties[l],x=!1,k=function(C){for(var B=0,V=C;B<V.length;B+=1)if(m.overrides&&m.overrides.hasOverride(V[B]))return void(x=!0)};if(f.value.kind==="constant"&&f.value.value instanceof si)k(f.value.value.sections);else if(f.value.kind==="source"){var A=function(C){x||(C instanceof Ai&&jr(C.value)===wr?k(C.value.sections):C instanceof Rn?k(C.sections):C.eachChild(A))},z=f.value;z._styleExpression&&A(z._styleExpression.expression)}return x},t}(Ta),Fg={paint:new sn({"background-color":new kt(U.paint_background["background-color"]),"background-pattern":new bn(U.paint_background["background-pattern"]),"background-opacity":new kt(U.paint_background["background-opacity"])})},Ng=function(e){function t(i){e.call(this,i,Fg)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t}(Ta),Vg={paint:new sn({"raster-opacity":new kt(U.paint_raster["raster-opacity"]),"raster-hue-rotate":new kt(U.paint_raster["raster-hue-rotate"]),"raster-brightness-min":new kt(U.paint_raster["raster-brightness-min"]),"raster-brightness-max":new kt(U.paint_raster["raster-brightness-max"]),"raster-saturation":new kt(U.paint_raster["raster-saturation"]),"raster-contrast":new kt(U.paint_raster["raster-contrast"]),"raster-resampling":new kt(U.paint_raster["raster-resampling"]),"raster-fade-duration":new kt(U.paint_raster["raster-fade-duration"])})},Ug=function(e){function t(i){e.call(this,i,Vg)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t}(Ta),qg=function(e){function t(i){e.call(this,i,{}),this.implementation=i}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.is3D=function(){return this.implementation.renderingMode==="3d"},t.prototype.hasOffscreenPass=function(){return this.implementation.prerender!==void 0},t.prototype.recalculate=function(){},t.prototype.updateTransitions=function(){},t.prototype.hasTransition=function(){},t.prototype.serialize=function(){},t.prototype.onAdd=function(i){this.implementation.onAdd&&this.implementation.onAdd(i,i.painter.context.gl)},t.prototype.onRemove=function(i){this.implementation.onRemove&&this.implementation.onRemove(i,i.painter.context.gl)},t}(Ta),jg={circle:Xh,heatmap:Ty,hillshade:Ay,fill:Zy,"fill-extrusion":eg,line:og,symbol:Og,background:Ng,raster:Ug},Mf=L.HTMLImageElement,Df=L.HTMLCanvasElement,Lf=L.HTMLVideoElement,Rf=L.ImageData,Uc=L.ImageBitmap,Is=function(e,t,i,l){this.context=e,this.format=i,this.texture=e.gl.createTexture(),this.update(t,l)};Is.prototype.update=function(e,t,i){var l=e.width,f=e.height,m=!(this.size&&this.size[0]===l&&this.size[1]===f||i),x=this.context,k=x.gl;if(this.useMipmap=!!(t&&t.useMipmap),k.bindTexture(k.TEXTURE_2D,this.texture),x.pixelStoreUnpackFlipY.set(!1),x.pixelStoreUnpack.set(1),x.pixelStoreUnpackPremultiplyAlpha.set(this.format===k.RGBA&&(!t||t.premultiply!==!1)),m)this.size=[l,f],e instanceof Mf||e instanceof Df||e instanceof Lf||e instanceof Rf||Uc&&e instanceof Uc?k.texImage2D(k.TEXTURE_2D,0,this.format,this.format,k.UNSIGNED_BYTE,e):k.texImage2D(k.TEXTURE_2D,0,this.format,l,f,0,this.format,k.UNSIGNED_BYTE,e.data);else{var A=i||{x:0,y:0},z=A.x,C=A.y;e instanceof Mf||e instanceof Df||e instanceof Lf||e instanceof Rf||Uc&&e instanceof Uc?k.texSubImage2D(k.TEXTURE_2D,0,z,C,k.RGBA,k.UNSIGNED_BYTE,e):k.texSubImage2D(k.TEXTURE_2D,0,z,C,l,f,k.RGBA,k.UNSIGNED_BYTE,e.data)}this.useMipmap&&this.isSizePowerOfTwo()&&k.generateMipmap(k.TEXTURE_2D)},Is.prototype.bind=function(e,t,i){var l=this.context.gl;l.bindTexture(l.TEXTURE_2D,this.texture),i!==l.LINEAR_MIPMAP_NEAREST||this.isSizePowerOfTwo()||(i=l.LINEAR),e!==this.filter&&(l.texParameteri(l.TEXTURE_2D,l.TEXTURE_MAG_FILTER,e),l.texParameteri(l.TEXTURE_2D,l.TEXTURE_MIN_FILTER,i||e),this.filter=e),t!==this.wrap&&(l.texParameteri(l.TEXTURE_2D,l.TEXTURE_WRAP_S,t),l.texParameteri(l.TEXTURE_2D,l.TEXTURE_WRAP_T,t),this.wrap=t)},Is.prototype.isSizePowerOfTwo=function(){return this.size[0]===this.size[1]&&Math.log(this.size[0])/Math.LN2%1==0},Is.prototype.destroy=function(){this.context.gl.deleteTexture(this.texture),this.texture=null};var hp=function(e){var t=this;this._callback=e,this._triggered=!1,typeof MessageChannel<"u"&&(this._channel=new MessageChannel,this._channel.port2.onmessage=function(){t._triggered=!1,t._callback()})};hp.prototype.trigger=function(){var e=this;this._triggered||(this._triggered=!0,this._channel?this._channel.port1.postMessage(!0):setTimeout(function(){e._triggered=!1,e._callback()},0))},hp.prototype.remove=function(){delete this._channel,this._callback=function(){}};var ml=function(e,t,i){this.target=e,this.parent=t,this.mapId=i,this.callbacks={},this.tasks={},this.taskQueue=[],this.cancelCallbacks={},Dt(["receive","process"],this),this.invoker=new hp(this.process),this.target.addEventListener("message",this.receive,!1),this.globalScope=$e()?e:L};function Bf(e,t,i){var l=2*Math.PI*6378137/256/Math.pow(2,i);return[e*l-2*Math.PI*6378137/2,t*l-2*Math.PI*6378137/2]}ml.prototype.send=function(e,t,i,l,f){var m=this;f===void 0&&(f=!1);var x=Math.round(1e18*Math.random()).toString(36).substring(0,10);i&&(this.callbacks[x]=i);var k=Bt(this.globalScope)?void 0:[];return this.target.postMessage({id:x,type:e,hasCallback:!!i,targetMapId:l,mustQueue:f,sourceMapId:this.mapId,data:da(t,k)},k),{cancel:function(){i&&delete m.callbacks[x],m.target.postMessage({id:x,type:"<cancel>",targetMapId:l,sourceMapId:m.mapId})}}},ml.prototype.receive=function(e){var t=e.data,i=t.id;if(i&&(!t.targetMapId||this.mapId===t.targetMapId))if(t.type==="<cancel>"){delete this.tasks[i];var l=this.cancelCallbacks[i];delete this.cancelCallbacks[i],l&&l()}else $e()||t.mustQueue?(this.tasks[i]=t,this.taskQueue.push(i),this.invoker.trigger()):this.processTask(i,t)},ml.prototype.process=function(){if(this.taskQueue.length){var e=this.taskQueue.shift(),t=this.tasks[e];delete this.tasks[e],this.taskQueue.length&&this.invoker.trigger(),t&&this.processTask(e,t)}},ml.prototype.processTask=function(e,t){var i=this;if(t.type==="<response>"){var l=this.callbacks[e];delete this.callbacks[e],l&&(t.error?l(Nn(t.error)):l(null,Nn(t.data)))}else{var f=!1,m=Bt(this.globalScope)?void 0:[],x=t.hasCallback?function(C,B){f=!0,delete i.cancelCallbacks[e],i.target.postMessage({id:e,type:"<response>",sourceMapId:i.mapId,error:C?da(C):null,data:da(B,m)},m)}:function(C){f=!0},k=null,A=Nn(t.data);if(this.parent[t.type])k=this.parent[t.type](t.sourceMapId,A,x);else if(this.parent.getWorkerSource){var z=t.type.split(".");k=this.parent.getWorkerSource(t.sourceMapId,z[0],A.source)[z[1]](A,x)}else x(new Error("Could not find function "+t.type));!f&&k&&k.cancel&&(this.cancelCallbacks[e]=k.cancel)}},ml.prototype.remove=function(){this.invoker.remove(),this.target.removeEventListener("message",this.receive,!1)};var Di=function(e,t){e&&(t?this.setSouthWest(e).setNorthEast(t):e.length===4?this.setSouthWest([e[0],e[1]]).setNorthEast([e[2],e[3]]):this.setSouthWest(e[0]).setNorthEast(e[1]))};Di.prototype.setNorthEast=function(e){return this._ne=e instanceof Yr?new Yr(e.lng,e.lat):Yr.convert(e),this},Di.prototype.setSouthWest=function(e){return this._sw=e instanceof Yr?new Yr(e.lng,e.lat):Yr.convert(e),this},Di.prototype.extend=function(e){var t,i,l=this._sw,f=this._ne;if(e instanceof Yr)t=e,i=e;else{if(!(e instanceof Di))return Array.isArray(e)?e.length===4||e.every(Array.isArray)?this.extend(Di.convert(e)):this.extend(Yr.convert(e)):this;if(i=e._ne,!(t=e._sw)||!i)return this}return l||f?(l.lng=Math.min(t.lng,l.lng),l.lat=Math.min(t.lat,l.lat),f.lng=Math.max(i.lng,f.lng),f.lat=Math.max(i.lat,f.lat)):(this._sw=new Yr(t.lng,t.lat),this._ne=new Yr(i.lng,i.lat)),this},Di.prototype.getCenter=function(){return new Yr((this._sw.lng+this._ne.lng)/2,(this._sw.lat+this._ne.lat)/2)},Di.prototype.getSouthWest=function(){return this._sw},Di.prototype.getNorthEast=function(){return this._ne},Di.prototype.getNorthWest=function(){return new Yr(this.getWest(),this.getNorth())},Di.prototype.getSouthEast=function(){return new Yr(this.getEast(),this.getSouth())},Di.prototype.getWest=function(){return this._sw.lng},Di.prototype.getSouth=function(){return this._sw.lat},Di.prototype.getEast=function(){return this._ne.lng},Di.prototype.getNorth=function(){return this._ne.lat},Di.prototype.toArray=function(){return[this._sw.toArray(),this._ne.toArray()]},Di.prototype.toString=function(){return"LngLatBounds("+this._sw.toString()+", "+this._ne.toString()+")"},Di.prototype.isEmpty=function(){return!(this._sw&&this._ne)},Di.prototype.contains=function(e){var t=Yr.convert(e),i=t.lng,l=t.lat,f=this._sw.lng<=i&&i<=this._ne.lng;return this._sw.lng>this._ne.lng&&(f=this._sw.lng>=i&&i>=this._ne.lng),this._sw.lat<=l&&l<=this._ne.lat&&f},Di.convert=function(e){return!e||e instanceof Di?e:new Di(e)};var Yr=function(e,t){if(isNaN(e)||isNaN(t))throw new Error("Invalid LngLat object: ("+e+", "+t+")");if(this.lng=+e,this.lat=+t,this.lat>90||this.lat<-90)throw new Error("Invalid LngLat latitude value: must be between -90 and 90")};Yr.prototype.wrap=function(){return new Yr(xe(this.lng,-180,180),this.lat)},Yr.prototype.toArray=function(){return[this.lng,this.lat]},Yr.prototype.toString=function(){return"LngLat("+this.lng+", "+this.lat+")"},Yr.prototype.distanceTo=function(e){var t=Math.PI/180,i=this.lat*t,l=e.lat*t,f=Math.sin(i)*Math.sin(l)+Math.cos(i)*Math.cos(l)*Math.cos((e.lng-this.lng)*t);return 63710088e-1*Math.acos(Math.min(f,1))},Yr.prototype.toBounds=function(e){e===void 0&&(e=0);var t=360*e/40075017,i=t/Math.cos(Math.PI/180*this.lat);return new Di(new Yr(this.lng-i,this.lat-t),new Yr(this.lng+i,this.lat+t))},Yr.convert=function(e){if(e instanceof Yr)return e;if(Array.isArray(e)&&(e.length===2||e.length===3))return new Yr(Number(e[0]),Number(e[1]));if(!Array.isArray(e)&&typeof e=="object"&&e!==null)return new Yr(Number("lng"in e?e.lng:e.lon),Number(e.lat));throw new Error("`LngLatLike` argument must be specified as a LngLat instance, an object {lng: <lng>, lat: <lat>}, an object {lon: <lng>, lat: <lat>}, or an array of [<lng>, <lat>]")};var Of=2*Math.PI*63710088e-1;function Ff(e){return Of*Math.cos(e*Math.PI/180)}function Nf(e){return(180+e)/360}function Vf(e){return(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+e*Math.PI/360)))/360}function Uf(e,t){return e/Ff(t)}function pp(e){return 360/Math.PI*Math.atan(Math.exp((180-360*e)*Math.PI/180))-90}var As=function(e,t,i){i===void 0&&(i=0),this.x=+e,this.y=+t,this.z=+i};As.fromLngLat=function(e,t){t===void 0&&(t=0);var i=Yr.convert(e);return new As(Nf(i.lng),Vf(i.lat),Uf(t,i.lat))},As.prototype.toLngLat=function(){return new Yr(360*this.x-180,pp(this.y))},As.prototype.toAltitude=function(){return this.z*Ff(pp(this.y))},As.prototype.meterInMercatorCoordinateUnits=function(){return 1/Of*(e=pp(this.y),1/Math.cos(e*Math.PI/180));var e};var zs=function(e,t,i){this.z=e,this.x=t,this.y=i,this.key=gu(0,e,e,t,i)};zs.prototype.equals=function(e){return this.z===e.z&&this.x===e.x&&this.y===e.y},zs.prototype.url=function(e,t){var i,l,f,m,x,k=(l=this.y,f=this.z,m=Bf(256*(i=this.x),256*(l=Math.pow(2,f)-l-1),f),x=Bf(256*(i+1),256*(l+1),f),m[0]+","+m[1]+","+x[0]+","+x[1]),A=function(z,C,B){for(var V,j="",J=z;J>0;J--)j+=(C&(V=1<<J-1)?1:0)+(B&V?2:0);return j}(this.z,this.x,this.y);return e[(this.x+this.y)%e.length].replace("{prefix}",(this.x%16).toString(16)+(this.y%16).toString(16)).replace("{z}",String(this.z)).replace("{x}",String(this.x)).replace("{y}",String(t==="tms"?Math.pow(2,this.z)-this.y-1:this.y)).replace("{quadkey}",A).replace("{bbox-epsg-3857}",k)},zs.prototype.getTilePoint=function(e){var t=Math.pow(2,this.z);return new F(8192*(e.x*t-this.x),8192*(e.y*t-this.y))},zs.prototype.toString=function(){return this.z+"/"+this.x+"/"+this.y};var qf=function(e,t){this.wrap=e,this.canonical=t,this.key=gu(e,t.z,t.z,t.x,t.y)},Li=function(e,t,i,l,f){this.overscaledZ=e,this.wrap=t,this.canonical=new zs(i,+l,+f),this.key=gu(t,e,i,l,f)};function gu(e,t,i,l,f){(e*=2)<0&&(e=-1*e-1);var m=1<<i;return(m*m*e+m*f+l).toString(36)+i.toString(36)+t.toString(36)}Li.prototype.equals=function(e){return this.overscaledZ===e.overscaledZ&&this.wrap===e.wrap&&this.canonical.equals(e.canonical)},Li.prototype.scaledTo=function(e){var t=this.canonical.z-e;return e>this.canonical.z?new Li(e,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y):new Li(e,this.wrap,e,this.canonical.x>>t,this.canonical.y>>t)},Li.prototype.calculateScaledKey=function(e,t){var i=this.canonical.z-e;return e>this.canonical.z?gu(this.wrap*+t,e,this.canonical.z,this.canonical.x,this.canonical.y):gu(this.wrap*+t,e,e,this.canonical.x>>i,this.canonical.y>>i)},Li.prototype.isChildOf=function(e){if(e.wrap!==this.wrap)return!1;var t=this.canonical.z-e.canonical.z;return e.overscaledZ===0||e.overscaledZ<this.overscaledZ&&e.canonical.x===this.canonical.x>>t&&e.canonical.y===this.canonical.y>>t},Li.prototype.children=function(e){if(this.overscaledZ>=e)return[new Li(this.overscaledZ+1,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)];var t=this.canonical.z+1,i=2*this.canonical.x,l=2*this.canonical.y;return[new Li(t,this.wrap,t,i,l),new Li(t,this.wrap,t,i+1,l),new Li(t,this.wrap,t,i,l+1),new Li(t,this.wrap,t,i+1,l+1)]},Li.prototype.isLessThan=function(e){return this.wrap<e.wrap||!(this.wrap>e.wrap)&&(this.overscaledZ<e.overscaledZ||!(this.overscaledZ>e.overscaledZ)&&(this.canonical.x<e.canonical.x||!(this.canonical.x>e.canonical.x)&&this.canonical.y<e.canonical.y))},Li.prototype.wrapped=function(){return new Li(this.overscaledZ,0,this.canonical.z,this.canonical.x,this.canonical.y)},Li.prototype.unwrapTo=function(e){return new Li(this.overscaledZ,e,this.canonical.z,this.canonical.x,this.canonical.y)},Li.prototype.overscaleFactor=function(){return Math.pow(2,this.overscaledZ-this.canonical.z)},Li.prototype.toUnwrapped=function(){return new qf(this.wrap,this.canonical)},Li.prototype.toString=function(){return this.overscaledZ+"/"+this.canonical.x+"/"+this.canonical.y},Li.prototype.getTilePoint=function(e){return this.canonical.getTilePoint(new As(e.x-this.wrap,e.y))},dt("CanonicalTileID",zs),dt("OverscaledTileID",Li,{omit:["posMatrix"]});var Po=function(e,t,i){if(this.uid=e,t.height!==t.width)throw new RangeError("DEM tiles must be square");if(i&&i!=="mapbox"&&i!=="terrarium")return Ne('"'+i+'" is not a valid encoding type. Valid types include "mapbox" and "terrarium".');this.stride=t.height;var l=this.dim=t.height-2;this.data=new Uint32Array(t.data.buffer),this.encoding=i||"mapbox";for(var f=0;f<l;f++)this.data[this._idx(-1,f)]=this.data[this._idx(0,f)],this.data[this._idx(l,f)]=this.data[this._idx(l-1,f)],this.data[this._idx(f,-1)]=this.data[this._idx(f,0)],this.data[this._idx(f,l)]=this.data[this._idx(f,l-1)];this.data[this._idx(-1,-1)]=this.data[this._idx(0,0)],this.data[this._idx(l,-1)]=this.data[this._idx(l-1,0)],this.data[this._idx(-1,l)]=this.data[this._idx(0,l-1)],this.data[this._idx(l,l)]=this.data[this._idx(l-1,l-1)]};Po.prototype.get=function(e,t){var i=new Uint8Array(this.data.buffer),l=4*this._idx(e,t);return(this.encoding==="terrarium"?this._unpackTerrarium:this._unpackMapbox)(i[l],i[l+1],i[l+2])},Po.prototype.getUnpackVector=function(){return this.encoding==="terrarium"?[256,1,1/256,32768]:[6553.6,25.6,.1,1e4]},Po.prototype._idx=function(e,t){if(e<-1||e>=this.dim+1||t<-1||t>=this.dim+1)throw new RangeError("out of range source coordinates for DEM data");return(t+1)*this.stride+(e+1)},Po.prototype._unpackMapbox=function(e,t,i){return(256*e*256+256*t+i)/10-1e4},Po.prototype._unpackTerrarium=function(e,t,i){return 256*e+t+i/256-32768},Po.prototype.getPixels=function(){return new Gn({width:this.stride,height:this.stride},new Uint8Array(this.data.buffer))},Po.prototype.backfillBorder=function(e,t,i){if(this.dim!==e.dim)throw new Error("dem dimension mismatch");var l=t*this.dim,f=t*this.dim+this.dim,m=i*this.dim,x=i*this.dim+this.dim;switch(t){case-1:l=f-1;break;case 1:f=l+1}switch(i){case-1:m=x-1;break;case 1:x=m+1}for(var k=-t*this.dim,A=-i*this.dim,z=m;z<x;z++)for(var C=l;C<f;C++)this.data[this._idx(C,z)]=e.data[this._idx(C+k,z+A)]},dt("DEMData",Po);var qc=function(e){this._stringToNumber={},this._numberToString=[];for(var t=0;t<e.length;t++){var i=e[t];this._stringToNumber[i]=t,this._numberToString[t]=i}};qc.prototype.encode=function(e){return this._stringToNumber[e]},qc.prototype.decode=function(e){return this._numberToString[e]};var jc=function(e,t,i,l,f){this.type="Feature",this._vectorTileFeature=e,e._z=t,e._x=i,e._y=l,this.properties=e.properties,this.id=f},fp={geometry:{configurable:!0}};fp.geometry.get=function(){return this._geometry===void 0&&(this._geometry=this._vectorTileFeature.toGeoJSON(this._vectorTileFeature._x,this._vectorTileFeature._y,this._vectorTileFeature._z).geometry),this._geometry},fp.geometry.set=function(e){this._geometry=e},jc.prototype.toJSON=function(){var e={geometry:this.geometry};for(var t in this)t!=="_geometry"&&t!=="_vectorTileFeature"&&(e[t]=this[t]);return e},Object.defineProperties(jc.prototype,fp);var yl=function(){this.state={},this.stateChanges={},this.deletedStates={}};yl.prototype.updateState=function(e,t,i){var l=String(t);if(this.stateChanges[e]=this.stateChanges[e]||{},this.stateChanges[e][l]=this.stateChanges[e][l]||{},be(this.stateChanges[e][l],i),this.deletedStates[e]===null)for(var f in this.deletedStates[e]={},this.state[e])f!==l&&(this.deletedStates[e][f]=null);else if(this.deletedStates[e]&&this.deletedStates[e][l]===null)for(var m in this.deletedStates[e][l]={},this.state[e][l])i[m]||(this.deletedStates[e][l][m]=null);else for(var x in i)this.deletedStates[e]&&this.deletedStates[e][l]&&this.deletedStates[e][l][x]===null&&delete this.deletedStates[e][l][x]},yl.prototype.removeFeatureState=function(e,t,i){if(this.deletedStates[e]!==null){var l=String(t);if(this.deletedStates[e]=this.deletedStates[e]||{},i&&t!==void 0)this.deletedStates[e][l]!==null&&(this.deletedStates[e][l]=this.deletedStates[e][l]||{},this.deletedStates[e][l][i]=null);else if(t!==void 0)if(this.stateChanges[e]&&this.stateChanges[e][l])for(i in this.deletedStates[e][l]={},this.stateChanges[e][l])this.deletedStates[e][l][i]=null;else this.deletedStates[e][l]=null;else this.deletedStates[e]=null}},yl.prototype.getState=function(e,t){var i=String(t),l=be({},(this.state[e]||{})[i],(this.stateChanges[e]||{})[i]);if(this.deletedStates[e]===null)return{};if(this.deletedStates[e]){var f=this.deletedStates[e][t];if(f===null)return{};for(var m in f)delete l[m]}return l},yl.prototype.initializeTileState=function(e,t){e.setFeatureState(this.state,t)},yl.prototype.coalesceChanges=function(e,t){var i={};for(var l in this.stateChanges){this.state[l]=this.state[l]||{};var f={};for(var m in this.stateChanges[l])this.state[l][m]||(this.state[l][m]={}),be(this.state[l][m],this.stateChanges[l][m]),f[m]=this.state[l][m];i[l]=f}for(var x in this.deletedStates){this.state[x]=this.state[x]||{};var k={};if(this.deletedStates[x]===null)for(var A in this.state[x])k[A]={},this.state[x][A]={};else for(var z in this.deletedStates[x]){if(this.deletedStates[x][z]===null)this.state[x][z]={};else for(var C=0,B=Object.keys(this.deletedStates[x][z]);C<B.length;C+=1)delete this.state[x][z][B[C]];k[z]=this.state[x][z]}i[x]=i[x]||{},be(i[x],k)}if(this.stateChanges={},this.deletedStates={},Object.keys(i).length!==0)for(var V in e)e[V].setFeatureState(i,t)};var Co=function(e,t){this.tileID=e,this.x=e.canonical.x,this.y=e.canonical.y,this.z=e.canonical.z,this.grid=new Ca(8192,16,0),this.grid3D=new Ca(8192,16,0),this.featureIndexArray=new O,this.promoteId=t};function jf(e,t,i,l,f){return Ue(e,function(m,x){var k=t instanceof vs?t.get(x):null;return k&&k.evaluate?k.evaluate(i,l,f):k})}function Gf(e){for(var t=1/0,i=1/0,l=-1/0,f=-1/0,m=0,x=e;m<x.length;m+=1){var k=x[m];t=Math.min(t,k.x),i=Math.min(i,k.y),l=Math.max(l,k.x),f=Math.max(f,k.y)}return{minX:t,minY:i,maxX:l,maxY:f}}function Gg(e,t){return t-e}Co.prototype.insert=function(e,t,i,l,f,m){var x=this.featureIndexArray.length;this.featureIndexArray.emplaceBack(i,l,f);for(var k=m?this.grid3D:this.grid,A=0;A<t.length;A++){for(var z=t[A],C=[1/0,1/0,-1/0,-1/0],B=0;B<z.length;B++){var V=z[B];C[0]=Math.min(C[0],V.x),C[1]=Math.min(C[1],V.y),C[2]=Math.max(C[2],V.x),C[3]=Math.max(C[3],V.y)}C[0]<8192&&C[1]<8192&&C[2]>=0&&C[3]>=0&&k.insert(x,C[0],C[1],C[2],C[3])}},Co.prototype.loadVTLayers=function(){return this.vtLayers||(this.vtLayers=new ol.VectorTile(new Cc(this.rawTileData)).layers,this.sourceLayerCoder=new qc(this.vtLayers?Object.keys(this.vtLayers).sort():["_geojsonTileLayer"])),this.vtLayers},Co.prototype.query=function(e,t,i,l){var f=this;this.loadVTLayers();for(var m=e.params||{},x=8192/e.tileSize/e.scale,k=js(m.filter),A=e.queryGeometry,z=e.queryPadding*x,C=Gf(A),B=this.grid.query(C.minX-z,C.minY-z,C.maxX+z,C.maxY+z),V=Gf(e.cameraQueryGeometry),j=this.grid3D.query(V.minX-z,V.minY-z,V.maxX+z,V.maxY+z,function(we,ke,Pe,qe){return function(et,wt,st,Tt,lt){for(var $t=0,Mt=et;$t<Mt.length;$t+=1){var _t=Mt[$t];if(wt<=_t.x&&st<=_t.y&&Tt>=_t.x&&lt>=_t.y)return!0}var sr=[new F(wt,st),new F(wt,lt),new F(Tt,lt),new F(Tt,st)];if(et.length>2){for(var Gt=0,gr=sr;Gt<gr.length;Gt+=1)if(Aa(et,gr[Gt]))return!0}for(var It=0;It<et.length-1;It++)if(ks(et[It],et[It+1],sr))return!0;return!1}(e.cameraQueryGeometry,we-z,ke-z,Pe+z,qe+z)}),J=0,$=j;J<$.length;J+=1)B.push($[J]);B.sort(Gg);for(var he,ie={},me=function(we){var ke=B[we];if(ke!==he){he=ke;var Pe=f.featureIndexArray.get(ke),qe=null;f.loadMatchingFeature(ie,Pe.bucketIndex,Pe.sourceLayerIndex,Pe.featureIndex,k,m.layers,m.availableImages,t,i,l,function(et,wt,st){return qe||(qe=ii(et)),wt.queryIntersectsFeature(A,et,st,qe,f.z,e.transform,x,e.pixelPosMatrix)})}},ve=0;ve<B.length;ve++)me(ve);return ie},Co.prototype.loadMatchingFeature=function(e,t,i,l,f,m,x,k,A,z,C){var B=this.bucketLayerIDs[t];if(!m||function(et,wt){for(var st=0;st<et.length;st++)if(wt.indexOf(et[st])>=0)return!0;return!1}(m,B)){var V=this.sourceLayerCoder.decode(i),j=this.vtLayers[V].feature(l);if(f.needGeometry){var J=mi(j,!0);if(!f.filter(new lr(this.tileID.overscaledZ),J,this.tileID.canonical))return}else if(!f.filter(new lr(this.tileID.overscaledZ),j))return;for(var $=this.getId(j,V),he=0;he<B.length;he++){var ie=B[he];if(!(m&&m.indexOf(ie)<0)){var me=k[ie];if(me){var ve={};$!==void 0&&z&&(ve=z.getState(me.sourceLayer||"_geojsonTileLayer",$));var we=be({},A[ie]);we.paint=jf(we.paint,me.paint,j,ve,x),we.layout=jf(we.layout,me.layout,j,ve,x);var ke=!C||C(j,me,ve);if(ke){var Pe=new jc(j,this.z,this.x,this.y,$);Pe.layer=we;var qe=e[ie];qe===void 0&&(qe=e[ie]=[]),qe.push({featureIndex:l,feature:Pe,intersectionZ:ke})}}}}}},Co.prototype.lookupSymbolFeatures=function(e,t,i,l,f,m,x,k){var A={};this.loadVTLayers();for(var z=js(f),C=0,B=e;C<B.length;C+=1)this.loadMatchingFeature(A,i,l,B[C],z,m,x,k,t);return A},Co.prototype.hasLayer=function(e){for(var t=0,i=this.bucketLayerIDs;t<i.length;t+=1)for(var l=0,f=i[t];l<f.length;l+=1)if(e===f[l])return!0;return!1},Co.prototype.getId=function(e,t){var i=e.id;return this.promoteId&&typeof(i=e.properties[typeof this.promoteId=="string"?this.promoteId:this.promoteId[t]])=="boolean"&&(i=Number(i)),i},dt("FeatureIndex",Co,{omit:["rawTileData","sourceLayerCoder"]});var Yi=function(e,t){this.tileID=e,this.uid=We(),this.uses=0,this.tileSize=t,this.buckets={},this.expirationTime=null,this.queryPadding=0,this.hasSymbolBuckets=!1,this.hasRTLText=!1,this.dependencies={},this.expiredRequestCount=0,this.state="loading"};Yi.prototype.registerFadeDuration=function(e){var t=e+this.timeAdded;t<Hr.now()||this.fadeEndTime&&t<this.fadeEndTime||(this.fadeEndTime=t)},Yi.prototype.wasRequested=function(){return this.state==="errored"||this.state==="loaded"||this.state==="reloading"},Yi.prototype.loadVectorData=function(e,t,i){if(this.hasData()&&this.unloadVectorData(),this.state="loaded",e){for(var l in e.featureIndex&&(this.latestFeatureIndex=e.featureIndex,e.rawTileData?(this.latestRawTileData=e.rawTileData,this.latestFeatureIndex.rawTileData=e.rawTileData):this.latestRawTileData&&(this.latestFeatureIndex.rawTileData=this.latestRawTileData)),this.collisionBoxArray=e.collisionBoxArray,this.buckets=function(z,C){var B={};if(!C)return B;for(var V=function(){var $=J[j],he=$.layerIds.map(function(ve){return C.getLayer(ve)}).filter(Boolean);if(he.length!==0){$.layers=he,$.stateDependentLayerIds&&($.stateDependentLayers=$.stateDependentLayerIds.map(function(ve){return he.filter(function(we){return we.id===ve})[0]}));for(var ie=0,me=he;ie<me.length;ie+=1)B[me[ie].id]=$}},j=0,J=z;j<J.length;j+=1)V();return B}(e.buckets,t.style),this.hasSymbolBuckets=!1,this.buckets){var f=this.buckets[l];if(f instanceof Cr){if(this.hasSymbolBuckets=!0,!i)break;f.justReloaded=!0}}if(this.hasRTLText=!1,this.hasSymbolBuckets)for(var m in this.buckets){var x=this.buckets[m];if(x instanceof Cr&&x.hasRTLText){this.hasRTLText=!0,Qn.isLoading()||Qn.isLoaded()||eu()!=="deferred"||ma();break}}for(var k in this.queryPadding=0,this.buckets){var A=this.buckets[k];this.queryPadding=Math.max(this.queryPadding,t.style.getLayer(k).queryRadius(A))}e.imageAtlas&&(this.imageAtlas=e.imageAtlas),e.glyphAtlasImage&&(this.glyphAtlasImage=e.glyphAtlasImage)}else this.collisionBoxArray=new s},Yi.prototype.unloadVectorData=function(){for(var e in this.buckets)this.buckets[e].destroy();this.buckets={},this.imageAtlasTexture&&this.imageAtlasTexture.destroy(),this.imageAtlas&&(this.imageAtlas=null),this.glyphAtlasTexture&&this.glyphAtlasTexture.destroy(),this.latestFeatureIndex=null,this.state="unloaded"},Yi.prototype.getBucket=function(e){return this.buckets[e.id]},Yi.prototype.upload=function(e){for(var t in this.buckets){var i=this.buckets[t];i.uploadPending()&&i.upload(e)}var l=e.gl;this.imageAtlas&&!this.imageAtlas.uploaded&&(this.imageAtlasTexture=new Is(e,this.imageAtlas.image,l.RGBA),this.imageAtlas.uploaded=!0),this.glyphAtlasImage&&(this.glyphAtlasTexture=new Is(e,this.glyphAtlasImage,l.ALPHA),this.glyphAtlasImage=null)},Yi.prototype.prepare=function(e){this.imageAtlas&&this.imageAtlas.patchUpdatedImages(e,this.imageAtlasTexture)},Yi.prototype.queryRenderedFeatures=function(e,t,i,l,f,m,x,k,A,z){return this.latestFeatureIndex&&this.latestFeatureIndex.rawTileData?this.latestFeatureIndex.query({queryGeometry:l,cameraQueryGeometry:f,scale:m,tileSize:this.tileSize,pixelPosMatrix:z,transform:k,params:x,queryPadding:this.queryPadding*A},e,t,i):{}},Yi.prototype.querySourceFeatures=function(e,t){var i=this.latestFeatureIndex;if(i&&i.rawTileData){var l=i.loadVTLayers(),f=t?t.sourceLayer:"",m=l._geojsonTileLayer||l[f];if(m)for(var x=js(t&&t.filter),k=this.tileID.canonical,A=k.z,z=k.x,C=k.y,B={z:A,x:z,y:C},V=0;V<m.length;V++){var j=m.feature(V);if(x.needGeometry){var J=mi(j,!0);if(!x.filter(new lr(this.tileID.overscaledZ),J,this.tileID.canonical))continue}else if(!x.filter(new lr(this.tileID.overscaledZ),j))continue;var $=i.getId(j,f),he=new jc(j,A,z,C,$);he.tile=B,e.push(he)}}},Yi.prototype.hasData=function(){return this.state==="loaded"||this.state==="reloading"||this.state==="expired"},Yi.prototype.patternsLoaded=function(){return this.imageAtlas&&!!Object.keys(this.imageAtlas.patternPositions).length},Yi.prototype.setExpiryData=function(e){var t=this.expirationTime;if(e.cacheControl){var i=mt(e.cacheControl);i["max-age"]&&(this.expirationTime=Date.now()+1e3*i["max-age"])}else e.expires&&(this.expirationTime=new Date(e.expires).getTime());if(this.expirationTime){var l=Date.now(),f=!1;if(this.expirationTime>l)f=!1;else if(t)if(this.expirationTime<t)f=!0;else{var m=this.expirationTime-t;m?this.expirationTime=l+Math.max(m,3e4):f=!0}else f=!0;f?(this.expiredRequestCount++,this.state="expired"):this.expiredRequestCount=0}},Yi.prototype.getExpiryTimeout=function(){if(this.expirationTime)return this.expiredRequestCount?1e3*(1<<Math.min(this.expiredRequestCount-1,31)):Math.min(this.expirationTime-new Date().getTime(),Math.pow(2,31)-1)},Yi.prototype.setFeatureState=function(e,t){if(this.latestFeatureIndex&&this.latestFeatureIndex.rawTileData&&Object.keys(e).length!==0){var i=this.latestFeatureIndex.loadVTLayers();for(var l in this.buckets)if(t.style.hasLayer(l)){var f=this.buckets[l],m=f.layers[0].sourceLayer||"_geojsonTileLayer",x=i[m],k=e[m];if(x&&k&&Object.keys(k).length!==0){f.update(k,x,this.imageAtlas&&this.imageAtlas.patternPositions||{});var A=t&&t.style&&t.style.getLayer(l);A&&(this.queryPadding=Math.max(this.queryPadding,A.queryRadius(f)))}}}},Yi.prototype.holdingForFade=function(){return this.symbolFadeHoldUntil!==void 0},Yi.prototype.symbolFadeFinished=function(){return!this.symbolFadeHoldUntil||this.symbolFadeHoldUntil<Hr.now()},Yi.prototype.clearFadeHold=function(){this.symbolFadeHoldUntil=void 0},Yi.prototype.setHoldDuration=function(e){this.symbolFadeHoldUntil=Hr.now()+e},Yi.prototype.setDependencies=function(e,t){for(var i={},l=0,f=t;l<f.length;l+=1)i[f[l]]=!0;this.dependencies[e]=i},Yi.prototype.hasDependency=function(e,t){for(var i=0,l=e;i<l.length;i+=1){var f=this.dependencies[l[i]];if(f){for(var m=0,x=t;m<x.length;m+=1)if(f[x[m]])return!0}}return!1};var Jo=L.performance,Zf=function(e){this._marks={start:[e.url,"start"].join("#"),end:[e.url,"end"].join("#"),measure:e.url.toString()},Jo.mark(this._marks.start)};Zf.prototype.finish=function(){Jo.mark(this._marks.end);var e=Jo.getEntriesByName(this._marks.measure);return e.length===0&&(Jo.measure(this._marks.measure,this._marks.start,this._marks.end),e=Jo.getEntriesByName(this._marks.measure),Jo.clearMarks(this._marks.start),Jo.clearMarks(this._marks.end),Jo.clearMeasures(this._marks.measure)),e},a.Actor=ml,a.AlphaImage=Ts,a.CanonicalTileID=zs,a.CollisionBoxArray=s,a.Color=dr,a.DEMData=Po,a.DataConstantProperty=kt,a.DictionaryCoder=qc,a.EXTENT=8192,a.ErrorEvent=ue,a.EvaluationParameters=lr,a.Event=W,a.Evented=fe,a.FeatureIndex=Co,a.FillBucket=Ra,a.FillExtrusionBucket=Ba,a.ImageAtlas=mu,a.ImagePosition=Dc,a.LineBucket=Cn,a.LngLat=Yr,a.LngLatBounds=Di,a.MercatorCoordinate=As,a.ONE_EM=24,a.OverscaledTileID=Li,a.Point=F,a.Point$1=F,a.Properties=sn,a.Protobuf=Cc,a.RGBAImage=Gn,a.RequestManager=fi,a.RequestPerformance=Zf,a.ResourceType=ti,a.SegmentVector=Z,a.SourceFeatureState=yl,a.StructArrayLayout1ui2=ou,a.StructArrayLayout2f1f2i16=To,a.StructArrayLayout2i4=Eo,a.StructArrayLayout3ui6=Wa,a.StructArrayLayout4i8=ru,a.SymbolBucket=Cr,a.Texture=Is,a.Tile=Yi,a.Transitionable=on,a.Uniform1f=Ye,a.Uniform1i=Fe,a.Uniform2f=Xe,a.Uniform3f=pt,a.Uniform4f=Et,a.UniformColor=Pt,a.UniformMatrix4f=_r,a.UnwrappedTileID=qf,a.ValidationError=Q,a.WritingMode=sa,a.ZoomHistory=Yl,a.add=function(e,t,i){return e[0]=t[0]+i[0],e[1]=t[1]+i[1],e[2]=t[2]+i[2],e},a.addDynamicAttributes=up,a.asyncAll=function(e,t,i){if(!e.length)return i(null,[]);var l=e.length,f=new Array(e.length),m=null;e.forEach(function(x,k){t(x,function(A,z){A&&(m=A),f[k]=z,--l==0&&i(m,f)})})},a.bezier=oe,a.bindAll=Dt,a.browser=Hr,a.cacheEntryPossiblyAdded=function(e){++ta>ei&&(e.getActor().send("enforceCacheSizeLimit",Bi),ta=0)},a.clamp=pe,a.clearTileCache=function(e){var t=L.caches.delete("mapbox-tiles");e&&t.catch(e).then(function(){return e()})},a.clipLine=Tf,a.clone=function(e){var t=new Er(16);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t},a.clone$1=vt,a.clone$2=function(e){var t=new Er(3);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t},a.collisionCircleLayout=cg,a.config=Jt,a.create=function(){var e=new Er(16);return Er!=Float32Array&&(e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[11]=0,e[12]=0,e[13]=0,e[14]=0),e[0]=1,e[5]=1,e[10]=1,e[15]=1,e},a.create$1=function(){var e=new Er(9);return Er!=Float32Array&&(e[1]=0,e[2]=0,e[3]=0,e[5]=0,e[6]=0,e[7]=0),e[0]=1,e[4]=1,e[8]=1,e},a.create$2=function(){var e=new Er(4);return Er!=Float32Array&&(e[1]=0,e[2]=0),e[0]=1,e[3]=1,e},a.createCommonjsModule=I,a.createExpression=Us,a.createLayout=Xi,a.createStyleLayer=function(e){return e.type==="custom"?new qg(e):new jg[e.type](e)},a.cross=function(e,t,i){var l=t[0],f=t[1],m=t[2],x=i[0],k=i[1],A=i[2];return e[0]=f*A-m*k,e[1]=m*x-l*A,e[2]=l*k-f*x,e},a.deepEqual=function e(t,i){if(Array.isArray(t)){if(!Array.isArray(i)||t.length!==i.length)return!1;for(var l=0;l<t.length;l++)if(!e(t[l],i[l]))return!1;return!0}if(typeof t=="object"&&t!==null&&i!==null){if(typeof i!="object"||Object.keys(t).length!==Object.keys(i).length)return!1;for(var f in t)if(!e(t[f],i[f]))return!1;return!0}return t===i},a.dot=function(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]},a.dot$1=function(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]+e[3]*t[3]},a.ease=se,a.emitValidationErrors=ys,a.endsWith=zt,a.enforceCacheSizeLimit=function(e){Ln(),qr&&qr.then(function(t){t.keys().then(function(i){for(var l=0;l<i.length-e;l++)t.delete(i[l])})})},a.evaluateSizeForFeature=bf,a.evaluateSizeForZoom=xf,a.evaluateVariableOffset=zf,a.evented=$l,a.extend=be,a.featureFilter=js,a.filterObject=Ke,a.fromRotation=function(e,t){var i=Math.sin(t),l=Math.cos(t);return e[0]=l,e[1]=i,e[2]=0,e[3]=-i,e[4]=l,e[5]=0,e[6]=0,e[7]=0,e[8]=1,e},a.getAnchorAlignment=ap,a.getAnchorJustification=lp,a.getArrayBuffer=Ti,a.getImage=N,a.getJSON=function(e,t){return yt(be(e,{type:"json"}),t)},a.getRTLTextPluginStatus=eu,a.getReferrer=un,a.getVideo=function(e,t){var i,l,f=L.document.createElement("video");f.muted=!0,f.onloadstart=function(){t(null,f)};for(var m=0;m<e.length;m++){var x=L.document.createElement("source");i=e[m],l=void 0,(l=L.document.createElement("a")).href=i,(l.protocol!==L.document.location.protocol||l.host!==L.document.location.host)&&(f.crossOrigin="Anonymous"),x.src=e[m],f.appendChild(x)}return{cancel:function(){}}},a.identity=$n,a.invert=function(e,t){var i=t[0],l=t[1],f=t[2],m=t[3],x=t[4],k=t[5],A=t[6],z=t[7],C=t[8],B=t[9],V=t[10],j=t[11],J=t[12],$=t[13],he=t[14],ie=t[15],me=i*k-l*x,ve=i*A-f*x,we=i*z-m*x,ke=l*A-f*k,Pe=l*z-m*k,qe=f*z-m*A,et=C*$-B*J,wt=C*he-V*J,st=C*ie-j*J,Tt=B*he-V*$,lt=B*ie-j*$,$t=V*ie-j*he,Mt=me*$t-ve*lt+we*Tt+ke*st-Pe*wt+qe*et;return Mt?(e[0]=(k*$t-A*lt+z*Tt)*(Mt=1/Mt),e[1]=(f*lt-l*$t-m*Tt)*Mt,e[2]=($*qe-he*Pe+ie*ke)*Mt,e[3]=(V*Pe-B*qe-j*ke)*Mt,e[4]=(A*st-x*$t-z*wt)*Mt,e[5]=(i*$t-f*st+m*wt)*Mt,e[6]=(he*we-J*qe-ie*ve)*Mt,e[7]=(C*qe-V*we+j*ve)*Mt,e[8]=(x*lt-k*st+z*et)*Mt,e[9]=(l*st-i*lt-m*et)*Mt,e[10]=(J*Pe-$*we+ie*me)*Mt,e[11]=(B*we-C*Pe-j*me)*Mt,e[12]=(k*wt-x*Tt-A*et)*Mt,e[13]=(i*Tt-l*wt+f*et)*Mt,e[14]=($*ve-J*ke-he*me)*Mt,e[15]=(C*ke-B*ve+V*me)*Mt,e):null},a.isChar=it,a.isMapboxURL=$r,a.keysDifference=function(e,t){var i=[];for(var l in e)l in t||i.push(l);return i},a.makeRequest=yt,a.mapObject=Ue,a.mercatorXfromLng=Nf,a.mercatorYfromLat=Vf,a.mercatorZfromAltitude=Uf,a.mul=Hh,a.multiply=Pn,a.mvt=ol,a.nextPowerOfTwo=function(e){return e<=1?1:Math.pow(2,Math.ceil(Math.log(e)/Math.LN2))},a.normalize=function(e,t){var i=t[0],l=t[1],f=t[2],m=i*i+l*l+f*f;return m>0&&(m=1/Math.sqrt(m)),e[0]=t[0]*m,e[1]=t[1]*m,e[2]=t[2]*m,e},a.number=wi,a.offscreenCanvasSupported=Wn,a.ortho=function(e,t,i,l,f,m,x){var k=1/(t-i),A=1/(l-f),z=1/(m-x);return e[0]=-2*k,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=-2*A,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=2*z,e[11]=0,e[12]=(t+i)*k,e[13]=(f+l)*A,e[14]=(x+m)*z,e[15]=1,e},a.parseGlyphPBF=function(e){return new Cc(e).readFields(xg,[])},a.pbf=Cc,a.performSymbolLayout=function(e,t,i,l,f,m,x){e.createArrays(),e.tilePixelRatio=8192/(512*e.overscaling),e.compareText={},e.iconsNeedLinear=!1;var k=e.layers[0].layout,A=e.layers[0]._unevaluatedLayout._values,z={};if(e.textSizeData.kind==="composite"){var C=e.textSizeData,B=C.maxZoom;z.compositeTextSizes=[A["text-size"].possiblyEvaluate(new lr(C.minZoom),x),A["text-size"].possiblyEvaluate(new lr(B),x)]}if(e.iconSizeData.kind==="composite"){var V=e.iconSizeData,j=V.maxZoom;z.compositeIconSizes=[A["icon-size"].possiblyEvaluate(new lr(V.minZoom),x),A["icon-size"].possiblyEvaluate(new lr(j),x)]}z.layoutTextSize=A["text-size"].possiblyEvaluate(new lr(e.zoom+1),x),z.layoutIconSize=A["icon-size"].possiblyEvaluate(new lr(e.zoom+1),x),z.textMaxSize=A["text-size"].possiblyEvaluate(new lr(18));for(var J=24*k.get("text-line-height"),$=k.get("text-rotation-alignment")==="map"&&k.get("symbol-placement")!=="point",he=k.get("text-keep-upright"),ie=k.get("text-size"),me=function(){var ke=we[ve],Pe=k.get("text-font").evaluate(ke,{},x).join(","),qe=ie.evaluate(ke,{},x),et=z.layoutTextSize.evaluate(ke,{},x),wt=z.layoutIconSize.evaluate(ke,{},x),st={horizontal:{},vertical:void 0},Tt=ke.text,lt=[0,0];if(Tt){var $t=Tt.toString(),Mt=24*k.get("text-letter-spacing").evaluate(ke,{},x),_t=function(hr){for(var Br=0,zr=hr;Br<zr.length;Br+=1)if(vr=zr[Br].charCodeAt(0),it.Arabic(vr)||it["Arabic Supplement"](vr)||it["Arabic Extended-A"](vr)||it["Arabic Presentation Forms-A"](vr)||it["Arabic Presentation Forms-B"](vr))return!1;var vr;return!0}($t)?Mt:0,sr=k.get("text-anchor").evaluate(ke,{},x),Gt=k.get("text-variable-anchor");if(!Gt){var gr=k.get("text-radial-offset").evaluate(ke,{},x);lt=gr?zf(sr,[24*gr,sp]):k.get("text-offset").evaluate(ke,{},x).map(function(hr){return 24*hr})}var It=$?"center":k.get("text-justify").evaluate(ke,{},x),Sr=k.get("symbol-placement"),Jr=Sr==="point"?24*k.get("text-max-width").evaluate(ke,{},x):0,ci=function(){e.allowVerticalPlacement&&Jl($t)&&(st.vertical=Lc(Tt,t,i,f,Pe,Jr,J,sr,"left",_t,lt,sa.vertical,!0,Sr,et,qe))};if(!$&&Gt){for(var ni=It==="auto"?Gt.map(function(hr){return lp(hr)}):[It],Qr=!1,hi=0;hi<ni.length;hi++){var Vi=ni[hi];if(!st.horizontal[Vi])if(Qr)st.horizontal[Vi]=st.horizontal[0];else{var Ui=Lc(Tt,t,i,f,Pe,Jr,J,"center",Vi,_t,lt,sa.horizontal,!1,Sr,et,qe);Ui&&(st.horizontal[Vi]=Ui,Qr=Ui.positionedLines.length===1)}}ci()}else{It==="auto"&&(It=lp(sr));var Sn=Lc(Tt,t,i,f,Pe,Jr,J,sr,It,_t,lt,sa.horizontal,!1,Sr,et,qe);Sn&&(st.horizontal[It]=Sn),ci(),Jl($t)&&$&&he&&(st.vertical=Lc(Tt,t,i,f,Pe,Jr,J,sr,It,_t,lt,sa.vertical,!1,Sr,et,qe))}}var Ji=void 0,kn=!1;if(ke.icon&&ke.icon.name){var yi=l[ke.icon.name];yi&&(Ji=function(hr,Br,zr){var vr=ap(zr),Mn=Br[0]-hr.displaySize[0]*vr.horizontalAlign,fn=Br[1]-hr.displaySize[1]*vr.verticalAlign;return{image:hr,top:fn,bottom:fn+hr.displaySize[1],left:Mn,right:Mn+hr.displaySize[0]}}(f[ke.icon.name],k.get("icon-offset").evaluate(ke,{},x),k.get("icon-anchor").evaluate(ke,{},x)),kn=yi.sdf,e.sdfIcons===void 0?e.sdfIcons=yi.sdf:e.sdfIcons!==yi.sdf&&Ne("Style sheet warning: Cannot mix SDF and non-SDF icons in one buffer"),(yi.pixelRatio!==e.pixelRatio||k.get("icon-rotate").constantOr(1)!==0)&&(e.iconsNeedLinear=!0))}var Qi=Cf(st.horizontal)||st.vertical;e.iconsInText=!!Qi&&Qi.iconsInText,(Qi||Ji)&&function(hr,Br,zr,vr,Mn,fn,Zr,ki,dn,kr,to){var la=fn.textMaxSize.evaluate(Br,{});la===void 0&&(la=Zr);var ro,gi=hr.layers[0].layout,io=gi.get("icon-offset").evaluate(Br,{},to),Pa=Cf(zr.horizontal),gl=Zr/24,Ps=hr.tilePixelRatio*gl,_l=hr.tilePixelRatio*la/24,Mo=hr.tilePixelRatio*ki,vl=hr.tilePixelRatio*gi.get("symbol-spacing"),Gc=gi.get("text-padding")*hr.tilePixelRatio,bl=gi.get("icon-padding")*hr.tilePixelRatio,_u=gi.get("text-max-angle")/180*Math.PI,Zc=gi.get("text-rotation-alignment")==="map"&&gi.get("symbol-placement")!=="point",Kc=gi.get("icon-rotation-alignment")==="map"&&gi.get("symbol-placement")!=="point",Do=gi.get("symbol-placement"),vu=vl/2,xl=gi.get("icon-text-fit");vr&&xl!=="none"&&(hr.allowVerticalPlacement&&zr.vertical&&(ro=vf(vr,zr.vertical,xl,gi.get("icon-text-fit-padding"),io,gl)),Pa&&(vr=vf(vr,Pa,xl,gi.get("icon-text-fit-padding"),io,gl)));var Qo=function(Zg,Iu){Iu.x<0||Iu.x>=8192||Iu.y<0||Iu.y>=8192||function(_i,Oa,Kg,$o,gp,Xf,Qc,no,$c,Au,eh,th,_p,Wf,zu,Yf,Jf,Qf,$f,ed,ua,rh,td,ao,Hg){var rd,Ms,Tl,Il,Al,zl=_i.addToLineVertexArray(Oa,Kg),id=0,nd=0,ad=0,od=0,vp=-1,bp=-1,Lo={},sd=Y(""),xp=0,wp=0;if(no._unevaluatedLayout.getValue("text-radial-offset")===void 0?(xp=(rd=no.layout.get("text-offset").evaluate(ua,{},ao).map(function(Cu){return 24*Cu}))[0],wp=rd[1]):(xp=24*no.layout.get("text-radial-offset").evaluate(ua,{},ao),wp=sp),_i.allowVerticalPlacement&&$o.vertical){var ld=no.layout.get("text-rotate").evaluate(ua,{},ao)+90;Il=new Nc($c,Oa,Au,eh,th,$o.vertical,_p,Wf,zu,ld),Qc&&(Al=new Nc($c,Oa,Au,eh,th,Qc,Jf,Qf,zu,ld))}if(gp){var Sp=no.layout.get("icon-rotate").evaluate(ua,{}),ud=no.layout.get("icon-text-fit")!=="none",cd=If(gp,Sp,td,ud),kp=Qc?If(Qc,Sp,td,ud):void 0;Tl=new Nc($c,Oa,Au,eh,th,gp,Jf,Qf,!1,Sp),id=4*cd.length;var hd=_i.iconSizeData,Pu=null;hd.kind==="source"?(Pu=[128*no.layout.get("icon-size").evaluate(ua,{})])[0]>32640&&Ne(_i.layerIds[0]+': Value for "icon-size" is >= 255. Reduce your "icon-size".'):hd.kind==="composite"&&((Pu=[128*rh.compositeIconSizes[0].evaluate(ua,{},ao),128*rh.compositeIconSizes[1].evaluate(ua,{},ao)])[0]>32640||Pu[1]>32640)&&Ne(_i.layerIds[0]+': Value for "icon-size" is >= 255. Reduce your "icon-size".'),_i.addSymbols(_i.icon,cd,Pu,ed,$f,ua,!1,Oa,zl.lineStartIndex,zl.lineLength,-1,ao),vp=_i.icon.placedSymbolArray.length-1,kp&&(nd=4*kp.length,_i.addSymbols(_i.icon,kp,Pu,ed,$f,ua,sa.vertical,Oa,zl.lineStartIndex,zl.lineLength,-1,ao),bp=_i.icon.placedSymbolArray.length-1)}for(var pd in $o.horizontal){var ih=$o.horizontal[pd];if(!Ms){sd=Y(ih.text);var Xg=no.layout.get("text-rotate").evaluate(ua,{},ao);Ms=new Nc($c,Oa,Au,eh,th,ih,_p,Wf,zu,Xg)}var fd=ih.positionedLines.length===1;if(ad+=Pf(_i,Oa,ih,Xf,no,zu,ua,Yf,zl,$o.vertical?sa.horizontal:sa.horizontalOnly,fd?Object.keys($o.horizontal):[pd],Lo,vp,rh,ao),fd)break}$o.vertical&&(od+=Pf(_i,Oa,$o.vertical,Xf,no,zu,ua,Yf,zl,sa.vertical,["vertical"],Lo,bp,rh,ao));var Wg=Ms?Ms.boxStartIndex:_i.collisionBoxArray.length,Yg=Ms?Ms.boxEndIndex:_i.collisionBoxArray.length,Jg=Il?Il.boxStartIndex:_i.collisionBoxArray.length,Qg=Il?Il.boxEndIndex:_i.collisionBoxArray.length,$g=Tl?Tl.boxStartIndex:_i.collisionBoxArray.length,e_=Tl?Tl.boxEndIndex:_i.collisionBoxArray.length,t_=Al?Al.boxStartIndex:_i.collisionBoxArray.length,r_=Al?Al.boxEndIndex:_i.collisionBoxArray.length,oo=-1,nh=function(Cu,md){return Cu&&Cu.circleDiameter?Math.max(Cu.circleDiameter,md):md};oo=nh(Ms,oo),oo=nh(Il,oo),oo=nh(Tl,oo);var dd=(oo=nh(Al,oo))>-1?1:0;dd&&(oo*=Hg/24),_i.glyphOffsetArray.length>=Cr.MAX_GLYPHS&&Ne("Too many glyphs being rendered in a tile. See https://github.com/mapbox/mapbox-gl-js/issues/2907"),ua.sortKey!==void 0&&_i.addToSortKeyRanges(_i.symbolInstances.length,ua.sortKey),_i.symbolInstances.emplaceBack(Oa.x,Oa.y,Lo.right>=0?Lo.right:-1,Lo.center>=0?Lo.center:-1,Lo.left>=0?Lo.left:-1,Lo.vertical||-1,vp,bp,sd,Wg,Yg,Jg,Qg,$g,e_,t_,r_,Au,ad,od,id,nd,dd,0,_p,xp,wp,oo)}(hr,Iu,Zg,zr,vr,Mn,ro,hr.layers[0],hr.collisionBoxArray,Br.index,Br.sourceLayerIndex,hr.index,Ps,Gc,Zc,dn,Mo,bl,Kc,io,Br,fn,kr,to,Zr)};if(Do==="line")for(var wl=0,Hc=Tf(Br.geometry,0,0,8192,8192);wl<Hc.length;wl+=1)for(var Xc=Hc[wl],bu=0,xu=Ag(Xc,vl,_u,zr.vertical||Pa,vr,24,_l,hr.overscaling,8192);bu<xu.length;bu+=1){var Wc=xu[bu];Pa&&Mg(hr,Pa.text,vu,Wc)||Qo(Xc,Wc)}else if(Do==="line-center")for(var wu=0,Su=Br.geometry;wu<Su.length;wu+=1){var ku=Su[wu];if(ku.length>1){var Yc=Ig(ku,_u,zr.vertical||Pa,vr,24,_l);Yc&&Qo(ku,Yc)}}else if(Br.type==="Polygon")for(var Sl=0,Jc=ep(Br.geometry,0);Sl<Jc.length;Sl+=1){var kl=Jc[Sl],Eu=Pg(kl,16);Qo(kl[0],new cl(Eu.x,Eu.y,0))}else if(Br.type==="LineString")for(var Cs=0,Tu=Br.geometry;Cs<Tu.length;Cs+=1){var El=Tu[Cs];Qo(El,new cl(El[0].x,El[0].y,0))}else if(Br.type==="Point")for(var dp=0,Kf=Br.geometry;dp<Kf.length;dp+=1)for(var mp=0,Hf=Kf[dp];mp<Hf.length;mp+=1){var yp=Hf[mp];Qo([yp],new cl(yp.x,yp.y,0))}}(e,ke,st,Ji,l,z,et,wt,lt,kn,x)},ve=0,we=e.features;ve<we.length;ve+=1)me();m&&e.generateCollisionDebugBuffers()},a.perspective=function(e,t,i,l,f){var m,x=1/Math.tan(t/2);return e[0]=x/i,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=x,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[11]=-1,e[12]=0,e[13]=0,e[15]=0,f!=null&&f!==1/0?(e[10]=(f+l)*(m=1/(l-f)),e[14]=2*f*l*m):(e[10]=-1,e[14]=-2*l),e},a.pick=function(e,t){for(var i={},l=0;l<t.length;l++){var f=t[l];f in e&&(i[f]=e[f])}return i},a.plugin=Qn,a.polygonIntersectsPolygon=Qa,a.postMapLoadEvent=Gi,a.postTurnstileEvent=nn,a.potpack=mf,a.refProperties=["type","source","source-layer","minzoom","maxzoom","filter","layout"],a.register=dt,a.registerForPluginStateChange=function(e){return e({pluginStatus:Un,pluginURL:Ma}),$l.on("pluginStateChange",e),e},a.renderColorRamp=Wp,a.rotate=function(e,t,i){var l=t[0],f=t[1],m=t[2],x=t[3],k=Math.sin(i),A=Math.cos(i);return e[0]=l*A+m*k,e[1]=f*A+x*k,e[2]=l*-k+m*A,e[3]=f*-k+x*A,e},a.rotateX=function(e,t,i){var l=Math.sin(i),f=Math.cos(i),m=t[4],x=t[5],k=t[6],A=t[7],z=t[8],C=t[9],B=t[10],V=t[11];return t!==e&&(e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e[4]=m*f+z*l,e[5]=x*f+C*l,e[6]=k*f+B*l,e[7]=A*f+V*l,e[8]=z*f-m*l,e[9]=C*f-x*l,e[10]=B*f-k*l,e[11]=V*f-A*l,e},a.rotateZ=function(e,t,i){var l=Math.sin(i),f=Math.cos(i),m=t[0],x=t[1],k=t[2],A=t[3],z=t[4],C=t[5],B=t[6],V=t[7];return t!==e&&(e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e[0]=m*f+z*l,e[1]=x*f+C*l,e[2]=k*f+B*l,e[3]=A*f+V*l,e[4]=z*f-m*l,e[5]=C*f-x*l,e[6]=B*f-k*l,e[7]=V*f-A*l,e},a.scale=function(e,t,i){var l=i[0],f=i[1],m=i[2];return e[0]=t[0]*l,e[1]=t[1]*l,e[2]=t[2]*l,e[3]=t[3]*l,e[4]=t[4]*f,e[5]=t[5]*f,e[6]=t[6]*f,e[7]=t[7]*f,e[8]=t[8]*m,e[9]=t[9]*m,e[10]=t[10]*m,e[11]=t[11]*m,e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15],e},a.scale$1=function(e,t,i){return e[0]=t[0]*i,e[1]=t[1]*i,e[2]=t[2]*i,e[3]=t[3]*i,e},a.scale$2=function(e,t,i){return e[0]=t[0]*i,e[1]=t[1]*i,e[2]=t[2]*i,e},a.setCacheLimits=function(e,t){Bi=e,ei=t},a.setRTLTextPlugin=function(e,t,i){if(i===void 0&&(i=!1),Un==="deferred"||Un==="loading"||Un==="loaded")throw new Error("setRTLTextPlugin cannot be called multiple times.");Ma=Hr.resolveURL(e),Un="deferred",Ys=t,_s(),i||ma()},a.sphericalToCartesian=function(e){var t=e[0],i=e[1],l=e[2];return i+=90,i*=Math.PI/180,l*=Math.PI/180,{x:t*Math.cos(i)*Math.sin(l),y:t*Math.sin(i)*Math.sin(l),z:t*Math.cos(l)}},a.sqrLen=function(e){var t=e[0],i=e[1];return t*t+i*i},a.styleSpec=U,a.sub=function(e,t,i){return e[0]=t[0]-i[0],e[1]=t[1]-i[1],e[2]=t[2]-i[2],e},a.symbolSize=Tg,a.transformMat3=function(e,t,i){var l=t[0],f=t[1],m=t[2];return e[0]=l*i[0]+f*i[3]+m*i[6],e[1]=l*i[1]+f*i[4]+m*i[7],e[2]=l*i[2]+f*i[5]+m*i[8],e},a.transformMat4=rl,a.translate=function(e,t,i){var l,f,m,x,k,A,z,C,B,V,j,J,$=i[0],he=i[1],ie=i[2];return t===e?(e[12]=t[0]*$+t[4]*he+t[8]*ie+t[12],e[13]=t[1]*$+t[5]*he+t[9]*ie+t[13],e[14]=t[2]*$+t[6]*he+t[10]*ie+t[14],e[15]=t[3]*$+t[7]*he+t[11]*ie+t[15]):(f=t[1],m=t[2],x=t[3],k=t[4],A=t[5],z=t[6],C=t[7],B=t[8],V=t[9],j=t[10],J=t[11],e[0]=l=t[0],e[1]=f,e[2]=m,e[3]=x,e[4]=k,e[5]=A,e[6]=z,e[7]=C,e[8]=B,e[9]=V,e[10]=j,e[11]=J,e[12]=l*$+k*he+B*ie+t[12],e[13]=f*$+A*he+V*ie+t[13],e[14]=m*$+z*he+j*ie+t[14],e[15]=x*$+C*he+J*ie+t[15]),e},a.triggerPluginCompletionEvent=kc,a.uniqueId=We,a.validateCustomStyleLayer=function(e){var t=[],i=e.id;return i===void 0&&t.push({message:"layers."+i+': missing required property "id"'}),e.render===void 0&&t.push({message:"layers."+i+': missing required method "render"'}),e.renderingMode&&e.renderingMode!=="2d"&&e.renderingMode!=="3d"&&t.push({message:"layers."+i+': property "renderingMode" must be either "2d" or "3d"'}),t},a.validateLight=Zh,a.validateStyle=ds,a.values=function(e){var t=[];for(var i in e)t.push(e[i]);return t},a.vectorTile=ol,a.version="1.13.2",a.warnOnce=Ne,a.webpSupported=ai,a.window=L,a.wrap=xe}),_(["./shared"],function(a){function I(R){var N=typeof R;if(N==="number"||N==="boolean"||N==="string"||R==null)return JSON.stringify(R);if(Array.isArray(R)){for(var q="[",K=0,W=R;K<W.length;K+=1)q+=I(W[K])+",";return q+"]"}for(var ue=Object.keys(R).sort(),fe="{",U=0;U<ue.length;U++)fe+=JSON.stringify(ue[U])+":"+I(R[ue[U]])+",";return fe+"}"}function T(R){for(var N="",q=0,K=a.refProperties;q<K.length;q+=1)N+="/"+I(R[K[q]]);return N}var D=function(R){this.keyCache={},R&&this.replace(R)};D.prototype.replace=function(R){this._layerConfigs={},this._layers={},this.update(R,[])},D.prototype.update=function(R,N){for(var q=this,K=0,W=R;K<W.length;K+=1){var ue=W[K];this._layerConfigs[ue.id]=ue;var fe=this._layers[ue.id]=a.createStyleLayer(ue);fe._featureFilter=a.featureFilter(fe.filter),this.keyCache[ue.id]&&delete this.keyCache[ue.id]}for(var U=0,Q=N;U<Q.length;U+=1){var ge=Q[U];delete this.keyCache[ge],delete this._layerConfigs[ge],delete this._layers[ge]}this.familiesBySource={};for(var Ce=0,Le=function(Qe,rt){for(var jt={},nt=0;nt<Qe.length;nt++){var tr=rt&&rt[Qe[nt].id]||T(Qe[nt]);rt&&(rt[Qe[nt].id]=tr);var wr=jt[tr];wr||(wr=jt[tr]=[]),wr.push(Qe[nt])}var Ht=[];for(var fr in jt)Ht.push(jt[fr]);return Ht}(a.values(this._layerConfigs),this.keyCache);Ce<Le.length;Ce+=1){var Ee=Le[Ce].map(function(Qe){return q._layers[Qe.id]}),Re=Ee[0];if(Re.visibility!=="none"){var ht=Re.source||"",at=this.familiesBySource[ht];at||(at=this.familiesBySource[ht]={});var Te=Re.sourceLayer||"_geojsonTileLayer",He=at[Te];He||(He=at[Te]=[]),He.push(Ee)}}};var F=function(R){var N={},q=[];for(var K in R){var W=R[K],ue=N[K]={};for(var fe in W){var U=W[+fe];if(U&&U.bitmap.width!==0&&U.bitmap.height!==0){var Q={x:0,y:0,w:U.bitmap.width+2,h:U.bitmap.height+2};q.push(Q),ue[fe]={rect:Q,metrics:U.metrics}}}}var ge=a.potpack(q),Ce=new a.AlphaImage({width:ge.w||1,height:ge.h||1});for(var Le in R){var Ee=R[Le];for(var Re in Ee){var ht=Ee[+Re];if(ht&&ht.bitmap.width!==0&&ht.bitmap.height!==0){var at=N[Le][Re].rect;a.AlphaImage.copy(ht.bitmap,Ce,{x:0,y:0},{x:at.x+1,y:at.y+1},ht.bitmap)}}}this.image=Ce,this.positions=N};a.register("GlyphAtlas",F);var M=function(R){this.tileID=new a.OverscaledTileID(R.tileID.overscaledZ,R.tileID.wrap,R.tileID.canonical.z,R.tileID.canonical.x,R.tileID.canonical.y),this.uid=R.uid,this.zoom=R.zoom,this.pixelRatio=R.pixelRatio,this.tileSize=R.tileSize,this.source=R.source,this.overscaling=this.tileID.overscaleFactor(),this.showCollisionBoxes=R.showCollisionBoxes,this.collectResourceTiming=!!R.collectResourceTiming,this.returnDependencies=!!R.returnDependencies,this.promoteId=R.promoteId};function L(R,N,q){for(var K=new a.EvaluationParameters(N),W=0,ue=R;W<ue.length;W+=1)ue[W].recalculate(K,q)}function X(R,N){var q=a.getArrayBuffer(R.request,function(K,W,ue,fe){K?N(K):W&&N(null,{vectorTile:new a.vectorTile.VectorTile(new a.pbf(W)),rawData:W,cacheControl:ue,expires:fe})});return function(){q.cancel(),N()}}M.prototype.parse=function(R,N,q,K,W){var ue=this;this.status="parsing",this.data=R,this.collisionBoxArray=new a.CollisionBoxArray;var fe=new a.DictionaryCoder(Object.keys(R.layers).sort()),U=new a.FeatureIndex(this.tileID,this.promoteId);U.bucketLayerIDs=[];var Q,ge,Ce,Le,Ee={},Re={featureIndex:U,iconDependencies:{},patternDependencies:{},glyphDependencies:{},availableImages:q},ht=N.familiesBySource[this.source];for(var at in ht){var Te=R.layers[at];if(Te){Te.version===1&&a.warnOnce('Vector tile source "'+this.source+'" layer "'+at+'" does not use vector tile spec v2 and therefore may have some rendering errors.');for(var He=fe.encode(at),Qe=[],rt=0;rt<Te.length;rt++){var jt=Te.feature(rt),nt=U.getId(jt,at);Qe.push({feature:jt,id:nt,index:rt,sourceLayerIndex:He})}for(var tr=0,wr=ht[at];tr<wr.length;tr+=1){var Ht=wr[tr],fr=Ht[0];fr.minzoom&&this.zoom<Math.floor(fr.minzoom)||fr.maxzoom&&this.zoom>=fr.maxzoom||fr.visibility!=="none"&&(L(Ht,this.zoom,q),(Ee[fr.id]=fr.createBucket({index:U.bucketLayerIDs.length,layers:Ht,zoom:this.zoom,pixelRatio:this.pixelRatio,overscaling:this.overscaling,collisionBoxArray:this.collisionBoxArray,sourceLayerIndex:He,sourceID:this.source})).populate(Qe,Re,this.tileID.canonical),U.bucketLayerIDs.push(Ht.map(function(br){return br.id})))}}}var rr=a.mapObject(Re.glyphDependencies,function(br){return Object.keys(br).map(Number)});Object.keys(rr).length?K.send("getGlyphs",{uid:this.uid,stacks:rr},function(br,Qt){Q||(Q=br,ge=Qt,Or.call(ue))}):ge={};var xi=Object.keys(Re.iconDependencies);xi.length?K.send("getImages",{icons:xi,source:this.source,tileID:this.tileID,type:"icons"},function(br,Qt){Q||(Q=br,Ce=Qt,Or.call(ue))}):Ce={};var yr=Object.keys(Re.patternDependencies);function Or(){if(Q)return W(Q);if(ge&&Ce&&Le){var br=new F(ge),Qt=new a.ImageAtlas(Ce,Le);for(var dr in Ee){var Ii=Ee[dr];Ii instanceof a.SymbolBucket?(L(Ii.layers,this.zoom,q),a.performSymbolLayout(Ii,ge,br.positions,Ce,Qt.iconPositions,this.showCollisionBoxes,this.tileID.canonical)):Ii.hasPattern&&(Ii instanceof a.LineBucket||Ii instanceof a.FillBucket||Ii instanceof a.FillExtrusionBucket)&&(L(Ii.layers,this.zoom,q),Ii.addFeatures(Re,this.tileID.canonical,Qt.patternPositions))}this.status="done",W(null,{buckets:a.values(Ee).filter(function(pa){return!pa.isEmpty()}),featureIndex:U,collisionBoxArray:this.collisionBoxArray,glyphAtlasImage:br.image,imageAtlas:Qt,glyphMap:this.returnDependencies?ge:null,iconMap:this.returnDependencies?Ce:null,glyphPositions:this.returnDependencies?br.positions:null})}}yr.length?K.send("getImages",{icons:yr,source:this.source,tileID:this.tileID,type:"patterns"},function(br,Qt){Q||(Q=br,Le=Qt,Or.call(ue))}):Le={},Or.call(this)};var oe=function(R,N,q,K){this.actor=R,this.layerIndex=N,this.availableImages=q,this.loadVectorData=K||X,this.loading={},this.loaded={}};oe.prototype.loadTile=function(R,N){var q=this,K=R.uid;this.loading||(this.loading={});var W=!!(R&&R.request&&R.request.collectResourceTiming)&&new a.RequestPerformance(R.request),ue=this.loading[K]=new M(R);ue.abort=this.loadVectorData(R,function(fe,U){if(delete q.loading[K],fe||!U)return ue.status="done",q.loaded[K]=ue,N(fe);var Q=U.rawData,ge={};U.expires&&(ge.expires=U.expires),U.cacheControl&&(ge.cacheControl=U.cacheControl);var Ce={};if(W){var Le=W.finish();Le&&(Ce.resourceTiming=JSON.parse(JSON.stringify(Le)))}ue.vectorTile=U.vectorTile,ue.parse(U.vectorTile,q.layerIndex,q.availableImages,q.actor,function(Ee,Re){if(Ee||!Re)return N(Ee);N(null,a.extend({rawTileData:Q.slice(0)},Re,ge,Ce))}),q.loaded=q.loaded||{},q.loaded[K]=ue})},oe.prototype.reloadTile=function(R,N){var q=this,K=this.loaded,W=R.uid,ue=this;if(K&&K[W]){var fe=K[W];fe.showCollisionBoxes=R.showCollisionBoxes;var U=function(Q,ge){var Ce=fe.reloadCallback;Ce&&(delete fe.reloadCallback,fe.parse(fe.vectorTile,ue.layerIndex,q.availableImages,ue.actor,Ce)),N(Q,ge)};fe.status==="parsing"?fe.reloadCallback=U:fe.status==="done"&&(fe.vectorTile?fe.parse(fe.vectorTile,this.layerIndex,this.availableImages,this.actor,U):U())}},oe.prototype.abortTile=function(R,N){var q=this.loading,K=R.uid;q&&q[K]&&q[K].abort&&(q[K].abort(),delete q[K]),N()},oe.prototype.removeTile=function(R,N){var q=this.loaded,K=R.uid;q&&q[K]&&delete q[K],N()};var se=a.window.ImageBitmap,pe=function(){this.loaded={}};function xe(R,N){if(R.length!==0){be(R[0],N);for(var q=1;q<R.length;q++)be(R[q],!N)}}function be(R,N){for(var q=0,K=0,W=R.length,ue=W-1;K<W;ue=K++)q+=(R[K][0]-R[ue][0])*(R[ue][1]+R[K][1]);q>=0!=!!N&&R.reverse()}pe.prototype.loadTile=function(R,N){var q=R.uid,K=R.encoding,W=R.rawImageData,ue=se&&W instanceof se?this.getImageData(W):W,fe=new a.DEMData(q,ue,K);this.loaded=this.loaded||{},this.loaded[q]=fe,N(null,fe)},pe.prototype.getImageData=function(R){this.offscreenCanvas&&this.offscreenCanvasContext||(this.offscreenCanvas=new OffscreenCanvas(R.width,R.height),this.offscreenCanvasContext=this.offscreenCanvas.getContext("2d")),this.offscreenCanvas.width=R.width,this.offscreenCanvas.height=R.height,this.offscreenCanvasContext.drawImage(R,0,0,R.width,R.height);var N=this.offscreenCanvasContext.getImageData(-1,-1,R.width+2,R.height+2);return this.offscreenCanvasContext.clearRect(0,0,this.offscreenCanvas.width,this.offscreenCanvas.height),new a.RGBAImage({width:N.width,height:N.height},N.data)},pe.prototype.removeTile=function(R){var N=this.loaded,q=R.uid;N&&N[q]&&delete N[q]};var ct=a.vectorTile.VectorTileFeature.prototype.toGeoJSON,We=function(R){this._feature=R,this.extent=a.EXTENT,this.type=R.type,this.properties=R.tags,"id"in R&&!isNaN(R.id)&&(this.id=parseInt(R.id,10))};We.prototype.loadGeometry=function(){if(this._feature.type===1){for(var R=[],N=0,q=this._feature.geometry;N<q.length;N+=1){var K=q[N];R.push([new a.Point$1(K[0],K[1])])}return R}for(var W=[],ue=0,fe=this._feature.geometry;ue<fe.length;ue+=1){for(var U=[],Q=0,ge=fe[ue];Q<ge.length;Q+=1){var Ce=ge[Q];U.push(new a.Point$1(Ce[0],Ce[1]))}W.push(U)}return W},We.prototype.toGeoJSON=function(R,N,q){return ct.call(this,R,N,q)};var De=function(R){this.layers={_geojsonTileLayer:this},this.name="_geojsonTileLayer",this.extent=a.EXTENT,this.length=R.length,this._features=R};De.prototype.feature=function(R){return new We(this._features[R])};var Ze=a.vectorTile.VectorTileFeature,Dt=zt;function zt(R,N){this.options=N||{},this.features=R,this.length=R.length}function Ue(R,N){this.id=typeof R.id=="number"?R.id:void 0,this.type=R.type,this.rawGeometry=R.type===1?[R.geometry]:R.geometry,this.properties=R.tags,this.extent=N||4096}zt.prototype.feature=function(R){return new Ue(this.features[R],this.options.extent)},Ue.prototype.loadGeometry=function(){var R=this.rawGeometry;this.geometry=[];for(var N=0;N<R.length;N++){for(var q=R[N],K=[],W=0;W<q.length;W++)K.push(new a.Point$1(q[W][0],q[W][1]));this.geometry.push(K)}return this.geometry},Ue.prototype.bbox=function(){this.geometry||this.loadGeometry();for(var R=this.geometry,N=1/0,q=-1/0,K=1/0,W=-1/0,ue=0;ue<R.length;ue++)for(var fe=R[ue],U=0;U<fe.length;U++){var Q=fe[U];N=Math.min(N,Q.x),q=Math.max(q,Q.x),K=Math.min(K,Q.y),W=Math.max(W,Q.y)}return[N,K,q,W]},Ue.prototype.toGeoJSON=Ze.prototype.toGeoJSON;var Ke=cr,vt=Dt;function cr(R){var N=new a.pbf;return function(q,K){for(var W in q.layers)K.writeMessage(3,Ne,q.layers[W])}(R,N),N.finish()}function Ne(R,N){var q;N.writeVarintField(15,R.version||1),N.writeStringField(1,R.name||""),N.writeVarintField(5,R.extent||4096);var K={keys:[],values:[],keycache:{},valuecache:{}};for(q=0;q<R.length;q++)K.feature=R.feature(q),N.writeMessage(2,Rt,K);var W=K.keys;for(q=0;q<W.length;q++)N.writeStringField(3,W[q]);var ue=K.values;for(q=0;q<ue.length;q++)N.writeMessage(4,Bt,ue[q])}function Rt(R,N){var q=R.feature;q.id!==void 0&&N.writeVarintField(1,q.id),N.writeMessage(2,Me,R),N.writeVarintField(3,q.type),N.writeMessage(4,qt,q)}function Me(R,N){var q=R.feature,K=R.keys,W=R.values,ue=R.keycache,fe=R.valuecache;for(var U in q.properties){var Q=ue[U];Q===void 0&&(K.push(U),ue[U]=Q=K.length-1),N.writeVarint(Q);var ge=q.properties[U],Ce=typeof ge;Ce!=="string"&&Ce!=="boolean"&&Ce!=="number"&&(ge=JSON.stringify(ge));var Le=Ce+":"+ge,Ee=fe[Le];Ee===void 0&&(W.push(ge),fe[Le]=Ee=W.length-1),N.writeVarint(Ee)}}function $e(R,N){return(N<<3)+(7&R)}function mt(R){return R<<1^R>>31}function qt(R,N){for(var q=R.loadGeometry(),K=R.type,W=0,ue=0,fe=q.length,U=0;U<fe;U++){var Q=q[U],ge=1;K===1&&(ge=Q.length),N.writeVarint($e(1,ge));for(var Ce=K===3?Q.length-1:Q.length,Le=0;Le<Ce;Le++){Le===1&&K!==1&&N.writeVarint($e(2,Ce-1));var Ee=Q[Le].x-W,Re=Q[Le].y-ue;N.writeVarint(mt(Ee)),N.writeVarint(mt(Re)),W+=Ee,ue+=Re}K===3&&N.writeVarint($e(7,1))}}function Bt(R,N){var q=typeof R;q==="string"?N.writeStringField(1,R):q==="boolean"?N.writeBooleanField(7,R):q==="number"&&(R%1!=0?N.writeDoubleField(3,R):R<0?N.writeSVarintField(6,R):N.writeVarintField(5,R))}function St(R,N,q,K){Oe(R,q,K),Oe(N,2*q,2*K),Oe(N,2*q+1,2*K+1)}function Oe(R,N,q){var K=R[N];R[N]=R[q],R[q]=K}function ot(R,N,q,K){var W=R-q,ue=N-K;return W*W+ue*ue}Ke.fromVectorTileJs=cr,Ke.fromGeojsonVt=function(R,N){N=N||{};var q={};for(var K in R)q[K]=new Dt(R[K].features,N),q[K].name=K,q[K].version=N.version,q[K].extent=N.extent;return cr({layers:q})},Ke.GeoJSONWrapper=vt;var Dr=function(R){return R[0]},Kr=function(R){return R[1]},vi=function(R,N,q,K,W){N===void 0&&(N=Dr),q===void 0&&(q=Kr),K===void 0&&(K=64),W===void 0&&(W=Float64Array),this.nodeSize=K,this.points=R;for(var ue=R.length<65536?Uint16Array:Uint32Array,fe=this.ids=new ue(R.length),U=this.coords=new W(2*R.length),Q=0;Q<R.length;Q++)fe[Q]=Q,U[2*Q]=N(R[Q]),U[2*Q+1]=q(R[Q]);(function ge(Ce,Le,Ee,Re,ht,at){if(!(ht-Re<=Ee)){var Te=Re+ht>>1;(function He(Qe,rt,jt,nt,tr,wr){for(;tr>nt;){if(tr-nt>600){var Ht=tr-nt+1,fr=jt-nt+1,rr=Math.log(Ht),xi=.5*Math.exp(2*rr/3),yr=.5*Math.sqrt(rr*xi*(Ht-xi)/Ht)*(fr-Ht/2<0?-1:1);He(Qe,rt,jt,Math.max(nt,Math.floor(jt-fr*xi/Ht+yr)),Math.min(tr,Math.floor(jt+(Ht-fr)*xi/Ht+yr)),wr)}var Or=rt[2*jt+wr],br=nt,Qt=tr;for(St(Qe,rt,nt,jt),rt[2*tr+wr]>Or&&St(Qe,rt,nt,tr);br<Qt;){for(St(Qe,rt,br,Qt),br++,Qt--;rt[2*br+wr]<Or;)br++;for(;rt[2*Qt+wr]>Or;)Qt--}rt[2*nt+wr]===Or?St(Qe,rt,nt,Qt):St(Qe,rt,++Qt,tr),Qt<=jt&&(nt=Qt+1),jt<=Qt&&(tr=Qt-1)}})(Ce,Le,Te,Re,ht,at%2),ge(Ce,Le,Ee,Re,Te-1,at+1),ge(Ce,Le,Ee,Te+1,ht,at+1)}})(fe,U,K,0,fe.length-1,0)};vi.prototype.range=function(R,N,q,K){return function(W,ue,fe,U,Q,ge,Ce){for(var Le,Ee,Re=[0,W.length-1,0],ht=[];Re.length;){var at=Re.pop(),Te=Re.pop(),He=Re.pop();if(Te-He<=Ce)for(var Qe=He;Qe<=Te;Qe++)Ee=ue[2*Qe+1],(Le=ue[2*Qe])>=fe&&Le<=Q&&Ee>=U&&Ee<=ge&&ht.push(W[Qe]);else{var rt=Math.floor((He+Te)/2);Ee=ue[2*rt+1],(Le=ue[2*rt])>=fe&&Le<=Q&&Ee>=U&&Ee<=ge&&ht.push(W[rt]);var jt=(at+1)%2;(at===0?fe<=Le:U<=Ee)&&(Re.push(He),Re.push(rt-1),Re.push(jt)),(at===0?Q>=Le:ge>=Ee)&&(Re.push(rt+1),Re.push(Te),Re.push(jt))}}return ht}(this.ids,this.coords,R,N,q,K,this.nodeSize)},vi.prototype.within=function(R,N,q){return function(K,W,ue,fe,U,Q){for(var ge=[0,K.length-1,0],Ce=[],Le=U*U;ge.length;){var Ee=ge.pop(),Re=ge.pop(),ht=ge.pop();if(Re-ht<=Q)for(var at=ht;at<=Re;at++)ot(W[2*at],W[2*at+1],ue,fe)<=Le&&Ce.push(K[at]);else{var Te=Math.floor((ht+Re)/2),He=W[2*Te],Qe=W[2*Te+1];ot(He,Qe,ue,fe)<=Le&&Ce.push(K[Te]);var rt=(Ee+1)%2;(Ee===0?ue-U<=He:fe-U<=Qe)&&(ge.push(ht),ge.push(Te-1),ge.push(rt)),(Ee===0?ue+U>=He:fe+U>=Qe)&&(ge.push(Te+1),ge.push(Re),ge.push(rt))}}return Ce}(this.ids,this.coords,R,N,q,this.nodeSize)};var xr={minZoom:0,maxZoom:16,minPoints:2,radius:40,extent:512,nodeSize:64,log:!1,generateId:!1,reduce:null,map:function(R){return R}},er=function(R){this.options=ji(Object.create(xr),R),this.trees=new Array(this.options.maxZoom+1)};function Hr(R,N,q,K,W){return{x:R,y:N,zoom:1/0,id:q,parentId:-1,numPoints:K,properties:W}}function Jt(R,N){var q=R.geometry.coordinates,K=q[1];return{x:en(q[0]),y:Kt(K),zoom:1/0,index:N,parentId:-1}}function ai(R){return{type:"Feature",id:R.id,properties:qi(R),geometry:{type:"Point",coordinates:[(K=R.x,360*(K-.5)),(N=R.y,q=(180-360*N)*Math.PI/180,360*Math.atan(Math.exp(q))/Math.PI-90)]}};var N,q,K}function qi(R){var N=R.numPoints,q=N>=1e4?Math.round(N/1e3)+"k":N>=1e3?Math.round(N/100)/10+"k":N;return ji(ji({},R.properties),{cluster:!0,cluster_id:R.id,point_count:N,point_count_abbreviated:q})}function en(R){return R/360+.5}function Kt(R){var N=Math.sin(R*Math.PI/180),q=.5-.25*Math.log((1+N)/(1-N))/Math.PI;return q<0?0:q>1?1:q}function ji(R,N){for(var q in N)R[q]=N[q];return R}function fi(R){return R.x}function $r(R){return R.y}function Xn(R,N,q,K,W,ue){var fe=W-q,U=ue-K;if(fe!==0||U!==0){var Q=((R-q)*fe+(N-K)*U)/(fe*fe+U*U);Q>1?(q=W,K=ue):Q>0&&(q+=fe*Q,K+=U*Q)}return(fe=R-q)*fe+(U=N-K)*U}function Ei(R,N,q,K){var W={id:R===void 0?null:R,type:N,geometry:q,tags:K,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0};return function(ue){var fe=ue.geometry,U=ue.type;if(U==="Point"||U==="MultiPoint"||U==="LineString")Lr(ue,fe);else if(U==="Polygon"||U==="MultiLineString")for(var Q=0;Q<fe.length;Q++)Lr(ue,fe[Q]);else if(U==="MultiPolygon")for(Q=0;Q<fe.length;Q++)for(var ge=0;ge<fe[Q].length;ge++)Lr(ue,fe[Q][ge])}(W),W}function Lr(R,N){for(var q=0;q<N.length;q+=3)R.minX=Math.min(R.minX,N[q]),R.minY=Math.min(R.minY,N[q+1]),R.maxX=Math.max(R.maxX,N[q]),R.maxY=Math.max(R.maxY,N[q+1])}function Ur(R,N,q,K){if(N.geometry){var W=N.geometry.coordinates,ue=N.geometry.type,fe=Math.pow(q.tolerance/((1<<q.maxZoom)*q.extent),2),U=[],Q=N.id;if(q.promoteId?Q=N.properties[q.promoteId]:q.generateId&&(Q=K||0),ue==="Point")tn(W,U);else if(ue==="MultiPoint")for(var ge=0;ge<W.length;ge++)tn(W[ge],U);else if(ue==="LineString")bi(W,U,fe,!1);else if(ue==="MultiLineString"){if(q.lineMetrics){for(ge=0;ge<W.length;ge++)bi(W[ge],U=[],fe,!1),R.push(Ei(Q,"LineString",U,N.properties));return}di(W,U,fe,!1)}else if(ue==="Polygon")di(W,U,fe,!0);else{if(ue!=="MultiPolygon"){if(ue==="GeometryCollection"){for(ge=0;ge<N.geometry.geometries.length;ge++)Ur(R,{id:Q,geometry:N.geometry.geometries[ge],properties:N.properties},q,K);return}throw new Error("Input data is not a valid GeoJSON object.")}for(ge=0;ge<W.length;ge++){var Ce=[];di(W[ge],Ce,fe,!0),U.push(Ce)}}R.push(Ei(Q,ue,U,N.properties))}}function tn(R,N){N.push(qr(R[0])),N.push(rn(R[1])),N.push(0)}function bi(R,N,q,K){for(var W,ue,fe=0,U=0;U<R.length;U++){var Q=qr(R[U][0]),ge=rn(R[U][1]);N.push(Q),N.push(ge),N.push(0),U>0&&(fe+=K?(W*ge-Q*ue)/2:Math.sqrt(Math.pow(Q-W,2)+Math.pow(ge-ue,2))),W=Q,ue=ge}var Ce=N.length-3;N[2]=1,function Le(Ee,Re,ht,at){for(var Te,He=at,Qe=ht-Re>>1,rt=ht-Re,jt=Ee[Re],nt=Ee[Re+1],tr=Ee[ht],wr=Ee[ht+1],Ht=Re+3;Ht<ht;Ht+=3){var fr=Xn(Ee[Ht],Ee[Ht+1],jt,nt,tr,wr);if(fr>He)Te=Ht,He=fr;else if(fr===He){var rr=Math.abs(Ht-Qe);rr<rt&&(Te=Ht,rt=rr)}}He>at&&(Te-Re>3&&Le(Ee,Re,Te,at),Ee[Te+2]=He,ht-Te>3&&Le(Ee,Te,ht,at))}(N,0,Ce,q),N[Ce+2]=1,N.size=Math.abs(fe),N.start=0,N.end=N.size}function di(R,N,q,K){for(var W=0;W<R.length;W++){var ue=[];bi(R[W],ue,q,K),N.push(ue)}}function qr(R){return R/360+.5}function rn(R){var N=Math.sin(R*Math.PI/180),q=.5-.25*Math.log((1+N)/(1-N))/Math.PI;return q<0?0:q>1?1:q}function Xr(R,N,q,K,W,ue,fe,U){if(K/=N,ue>=(q/=N)&&fe<K)return R;if(fe<q||ue>=K)return null;for(var Q=[],ge=0;ge<R.length;ge++){var Ce=R[ge],Le=Ce.geometry,Ee=Ce.type,Re=W===0?Ce.minX:Ce.minY,ht=W===0?Ce.maxX:Ce.maxY;if(Re>=q&&ht<K)Q.push(Ce);else if(!(ht<q||Re>=K)){var at=[];if(Ee==="Point"||Ee==="MultiPoint")In(Le,at,q,K,W);else if(Ee==="LineString")nn(Le,at,q,K,W,!1,U.lineMetrics);else if(Ee==="MultiLineString")Gi(Le,at,q,K,W,!1);else if(Ee==="Polygon")Gi(Le,at,q,K,W,!0);else if(Ee==="MultiPolygon")for(var Te=0;Te<Le.length;Te++){var He=[];Gi(Le[Te],He,q,K,W,!0),He.length&&at.push(He)}if(at.length){if(U.lineMetrics&&Ee==="LineString"){for(Te=0;Te<at.length;Te++)Q.push(Ei(Ce.id,Ee,at[Te],Ce.tags));continue}Ee!=="LineString"&&Ee!=="MultiLineString"||(at.length===1?(Ee="LineString",at=at[0]):Ee="MultiLineString"),Ee!=="Point"&&Ee!=="MultiPoint"||(Ee=at.length===3?"Point":"MultiPoint"),Q.push(Ei(Ce.id,Ee,at,Ce.tags))}}}return Q.length?Q:null}function In(R,N,q,K,W){for(var ue=0;ue<R.length;ue+=3){var fe=R[ue+W];fe>=q&&fe<=K&&(N.push(R[ue]),N.push(R[ue+1]),N.push(R[ue+2]))}}function nn(R,N,q,K,W,ue,fe){for(var U,Q,ge=Dn(R),Ce=W===0?ei:Ln,Le=R.start,Ee=0;Ee<R.length-3;Ee+=3){var Re=R[Ee],ht=R[Ee+1],at=R[Ee+2],Te=R[Ee+3],He=R[Ee+4],Qe=W===0?Re:ht,rt=W===0?Te:He,jt=!1;fe&&(U=Math.sqrt(Math.pow(Re-Te,2)+Math.pow(ht-He,2))),Qe<q?rt>q&&(Q=Ce(ge,Re,ht,Te,He,q),fe&&(ge.start=Le+U*Q)):Qe>K?rt<K&&(Q=Ce(ge,Re,ht,Te,He,K),fe&&(ge.start=Le+U*Q)):Bi(ge,Re,ht,at),rt<q&&Qe>=q&&(Q=Ce(ge,Re,ht,Te,He,q),jt=!0),rt>K&&Qe<=K&&(Q=Ce(ge,Re,ht,Te,He,K),jt=!0),!ue&&jt&&(fe&&(ge.end=Le+U*Q),N.push(ge),ge=Dn(R)),fe&&(Le+=U)}var nt=R.length-3;Re=R[nt],ht=R[nt+1],at=R[nt+2],(Qe=W===0?Re:ht)>=q&&Qe<=K&&Bi(ge,Re,ht,at),nt=ge.length-3,ue&&nt>=3&&(ge[nt]!==ge[0]||ge[nt+1]!==ge[1])&&Bi(ge,ge[0],ge[1],ge[2]),ge.length&&N.push(ge)}function Dn(R){var N=[];return N.size=R.size,N.start=R.start,N.end=R.end,N}function Gi(R,N,q,K,W,ue){for(var fe=0;fe<R.length;fe++)nn(R[fe],N,q,K,W,ue,!1)}function Bi(R,N,q,K){R.push(N),R.push(q),R.push(K)}function ei(R,N,q,K,W,ue){var fe=(ue-N)/(K-N);return R.push(ue),R.push(q+(W-q)*fe),R.push(1),fe}function Ln(R,N,q,K,W,ue){var fe=(ue-q)/(W-q);return R.push(N+(K-N)*fe),R.push(ue),R.push(1),fe}function An(R,N){for(var q=[],K=0;K<R.length;K++){var W,ue=R[K],fe=ue.type;if(fe==="Point"||fe==="MultiPoint"||fe==="LineString")W=oi(ue.geometry,N);else if(fe==="MultiLineString"||fe==="Polygon"){W=[];for(var U=0;U<ue.geometry.length;U++)W.push(oi(ue.geometry[U],N))}else if(fe==="MultiPolygon")for(W=[],U=0;U<ue.geometry.length;U++){for(var Q=[],ge=0;ge<ue.geometry[U].length;ge++)Q.push(oi(ue.geometry[U][ge],N));W.push(Q)}q.push(Ei(ue.id,fe,W,ue.tags))}return q}function oi(R,N){var q=[];q.size=R.size,R.start!==void 0&&(q.start=R.start,q.end=R.end);for(var K=0;K<R.length;K+=3)q.push(R[K]+N,R[K+1],R[K+2]);return q}function ta(R,N){if(R.transformed)return R;var q,K,W,ue=1<<R.z,fe=R.x,U=R.y;for(q=0;q<R.features.length;q++){var Q=R.features[q],ge=Q.geometry,Ce=Q.type;if(Q.geometry=[],Ce===1)for(K=0;K<ge.length;K+=2)Q.geometry.push(Wn(ge[K],ge[K+1],N,ue,fe,U));else for(K=0;K<ge.length;K++){var Le=[];for(W=0;W<ge[K].length;W+=2)Le.push(Wn(ge[K][W],ge[K][W+1],N,ue,fe,U));Q.geometry.push(Le)}}return R.transformed=!0,R}function Wn(R,N,q,K,W,ue){return[Math.round(q*(R*K-W)),Math.round(q*(N*K-ue))]}function ti(R,N,q,K,W){for(var ue=N===W.maxZoom?0:W.tolerance/((1<<N)*W.extent),fe={features:[],numPoints:0,numSimplified:0,numFeatures:0,source:null,x:q,y:K,z:N,transformed:!1,minX:2,minY:1,maxX:-1,maxY:0},U=0;U<R.length;U++){fe.numFeatures++,ra(fe,R[U],ue,W);var Q=R[U].minX,ge=R[U].minY,Ce=R[U].maxX,Le=R[U].maxY;Q<fe.minX&&(fe.minX=Q),ge<fe.minY&&(fe.minY=ge),Ce>fe.maxX&&(fe.maxX=Ce),Le>fe.maxY&&(fe.maxY=Le)}return fe}function ra(R,N,q,K){var W=N.geometry,ue=N.type,fe=[];if(ue==="Point"||ue==="MultiPoint")for(var U=0;U<W.length;U+=3)fe.push(W[U]),fe.push(W[U+1]),R.numPoints++,R.numSimplified++;else if(ue==="LineString")un(fe,W,R,q,!1,!1);else if(ue==="MultiLineString"||ue==="Polygon")for(U=0;U<W.length;U++)un(fe,W[U],R,q,ue==="Polygon",U===0);else if(ue==="MultiPolygon")for(var Q=0;Q<W.length;Q++){var ge=W[Q];for(U=0;U<ge.length;U++)un(fe,ge[U],R,q,!0,U===0)}if(fe.length){var Ce=N.tags||null;if(ue==="LineString"&&K.lineMetrics){for(var Le in Ce={},N.tags)Ce[Le]=N.tags[Le];Ce.mapbox_clip_start=W.start/W.size,Ce.mapbox_clip_end=W.end/W.size}var Ee={geometry:fe,type:ue==="Polygon"||ue==="MultiPolygon"?3:ue==="LineString"||ue==="MultiLineString"?2:1,tags:Ce};N.id!==null&&(Ee.id=N.id),R.features.push(Ee)}}function un(R,N,q,K,W,ue){var fe=K*K;if(K>0&&N.size<(W?fe:K))q.numPoints+=N.length/3;else{for(var U=[],Q=0;Q<N.length;Q+=3)(K===0||N[Q+2]>fe)&&(q.numSimplified++,U.push(N[Q]),U.push(N[Q+1])),q.numPoints++;W&&function(ge,Ce){for(var Le=0,Ee=0,Re=ge.length,ht=Re-2;Ee<Re;ht=Ee,Ee+=2)Le+=(ge[Ee]-ge[ht])*(ge[Ee+1]+ge[ht+1]);if(Le>0===Ce)for(Ee=0,Re=ge.length;Ee<Re/2;Ee+=2){var at=ge[Ee],Te=ge[Ee+1];ge[Ee]=ge[Re-2-Ee],ge[Ee+1]=ge[Re-1-Ee],ge[Re-2-Ee]=at,ge[Re-1-Ee]=Te}}(U,ue),R.push(U)}}function ri(R,N){var q=(N=this.options=function(W,ue){for(var fe in ue)W[fe]=ue[fe];return W}(Object.create(this.options),N)).debug;if(q&&console.time("preprocess data"),N.maxZoom<0||N.maxZoom>24)throw new Error("maxZoom should be in the 0-24 range");if(N.promoteId&&N.generateId)throw new Error("promoteId and generateId cannot be used together.");var K=function(W,ue){var fe=[];if(W.type==="FeatureCollection")for(var U=0;U<W.features.length;U++)Ur(fe,W.features[U],ue,U);else Ur(fe,W.type==="Feature"?W:{geometry:W},ue);return fe}(R,N);this.tiles={},this.tileCoords=[],q&&(console.timeEnd("preprocess data"),console.log("index: maxZoom: %d, maxPoints: %d",N.indexMaxZoom,N.indexMaxPoints),console.time("generate tiles"),this.stats={},this.total=0),(K=function(W,ue){var fe=ue.buffer/ue.extent,U=W,Q=Xr(W,1,-1-fe,fe,0,-1,2,ue),ge=Xr(W,1,1-fe,2+fe,0,-1,2,ue);return(Q||ge)&&(U=Xr(W,1,-fe,1+fe,0,-1,2,ue)||[],Q&&(U=An(Q,1).concat(U)),ge&&(U=U.concat(An(ge,-1)))),U}(K,N)).length&&this.splitTile(K,0,0,0),q&&(K.length&&console.log("features: %d, points: %d",this.tiles[0].numFeatures,this.tiles[0].numPoints),console.timeEnd("generate tiles"),console.log("tiles generated:",this.total,JSON.stringify(this.stats)))}function re(R,N,q){return 32*((1<<R)*q+N)+R}function yt(R,N){var q=R.tileID.canonical;if(!this._geoJSONIndex)return N(null,null);var K=this._geoJSONIndex.getTile(q.z,q.x,q.y);if(!K)return N(null,null);var W=new De(K.features),ue=Ke(W);ue.byteOffset===0&&ue.byteLength===ue.buffer.byteLength||(ue=new Uint8Array(ue)),N(null,{vectorTile:W,rawData:ue.buffer})}er.prototype.load=function(R){var N=this.options,q=N.log,K=N.minZoom,W=N.maxZoom,ue=N.nodeSize;q&&console.time("total time");var fe="prepare "+R.length+" points";q&&console.time(fe),this.points=R;for(var U=[],Q=0;Q<R.length;Q++)R[Q].geometry&&U.push(Jt(R[Q],Q));this.trees[W+1]=new vi(U,fi,$r,ue,Float32Array),q&&console.timeEnd(fe);for(var ge=W;ge>=K;ge--){var Ce=+Date.now();U=this._cluster(U,ge),this.trees[ge]=new vi(U,fi,$r,ue,Float32Array),q&&console.log("z%d: %d clusters in %dms",ge,U.length,+Date.now()-Ce)}return q&&console.timeEnd("total time"),this},er.prototype.getClusters=function(R,N){var q=((R[0]+180)%360+360)%360-180,K=Math.max(-90,Math.min(90,R[1])),W=R[2]===180?180:((R[2]+180)%360+360)%360-180,ue=Math.max(-90,Math.min(90,R[3]));if(R[2]-R[0]>=360)q=-180,W=180;else if(q>W){var fe=this.getClusters([q,K,180,ue],N),U=this.getClusters([-180,K,W,ue],N);return fe.concat(U)}for(var Q=this.trees[this._limitZoom(N)],ge=[],Ce=0,Le=Q.range(en(q),Kt(ue),en(W),Kt(K));Ce<Le.length;Ce+=1){var Ee=Q.points[Le[Ce]];ge.push(Ee.numPoints?ai(Ee):this.points[Ee.index])}return ge},er.prototype.getChildren=function(R){var N=this._getOriginId(R),q=this._getOriginZoom(R),K="No cluster with the specified id.",W=this.trees[q];if(!W)throw new Error(K);var ue=W.points[N];if(!ue)throw new Error(K);for(var fe=this.options.radius/(this.options.extent*Math.pow(2,q-1)),U=[],Q=0,ge=W.within(ue.x,ue.y,fe);Q<ge.length;Q+=1){var Ce=W.points[ge[Q]];Ce.parentId===R&&U.push(Ce.numPoints?ai(Ce):this.points[Ce.index])}if(U.length===0)throw new Error(K);return U},er.prototype.getLeaves=function(R,N,q){var K=[];return this._appendLeaves(K,R,N=N||10,q=q||0,0),K},er.prototype.getTile=function(R,N,q){var K=this.trees[this._limitZoom(R)],W=Math.pow(2,R),ue=this.options,fe=ue.radius/ue.extent,U=(q-fe)/W,Q=(q+1+fe)/W,ge={features:[]};return this._addTileFeatures(K.range((N-fe)/W,U,(N+1+fe)/W,Q),K.points,N,q,W,ge),N===0&&this._addTileFeatures(K.range(1-fe/W,U,1,Q),K.points,W,q,W,ge),N===W-1&&this._addTileFeatures(K.range(0,U,fe/W,Q),K.points,-1,q,W,ge),ge.features.length?ge:null},er.prototype.getClusterExpansionZoom=function(R){for(var N=this._getOriginZoom(R)-1;N<=this.options.maxZoom;){var q=this.getChildren(R);if(N++,q.length!==1)break;R=q[0].properties.cluster_id}return N},er.prototype._appendLeaves=function(R,N,q,K,W){for(var ue=0,fe=this.getChildren(N);ue<fe.length;ue+=1){var U=fe[ue],Q=U.properties;if(Q&&Q.cluster?W+Q.point_count<=K?W+=Q.point_count:W=this._appendLeaves(R,Q.cluster_id,q,K,W):W<K?W++:R.push(U),R.length===q)break}return W},er.prototype._addTileFeatures=function(R,N,q,K,W,ue){for(var fe=0,U=R;fe<U.length;fe+=1){var Q=N[U[fe]],ge=Q.numPoints,Ce={type:1,geometry:[[Math.round(this.options.extent*(Q.x*W-q)),Math.round(this.options.extent*(Q.y*W-K))]],tags:ge?qi(Q):this.points[Q.index].properties},Le=void 0;ge?Le=Q.id:this.options.generateId?Le=Q.index:this.points[Q.index].id&&(Le=this.points[Q.index].id),Le!==void 0&&(Ce.id=Le),ue.features.push(Ce)}},er.prototype._limitZoom=function(R){return Math.max(this.options.minZoom,Math.min(+R,this.options.maxZoom+1))},er.prototype._cluster=function(R,N){for(var q=[],K=this.options,W=K.reduce,ue=K.minPoints,fe=K.radius/(K.extent*Math.pow(2,N)),U=0;U<R.length;U++){var Q=R[U];if(!(Q.zoom<=N)){Q.zoom=N;for(var ge=this.trees[N+1],Ce=ge.within(Q.x,Q.y,fe),Le=Q.numPoints||1,Ee=Le,Re=0,ht=Ce;Re<ht.length;Re+=1){var at=ge.points[ht[Re]];at.zoom>N&&(Ee+=at.numPoints||1)}if(Ee>=ue){for(var Te=Q.x*Le,He=Q.y*Le,Qe=W&&Le>1?this._map(Q,!0):null,rt=(U<<5)+(N+1)+this.points.length,jt=0,nt=Ce;jt<nt.length;jt+=1){var tr=ge.points[nt[jt]];if(!(tr.zoom<=N)){tr.zoom=N;var wr=tr.numPoints||1;Te+=tr.x*wr,He+=tr.y*wr,tr.parentId=rt,W&&(Qe||(Qe=this._map(Q,!0)),W(Qe,this._map(tr)))}}Q.parentId=rt,q.push(Hr(Te/Ee,He/Ee,rt,Ee,Qe))}else if(q.push(Q),Ee>1)for(var Ht=0,fr=Ce;Ht<fr.length;Ht+=1){var rr=ge.points[fr[Ht]];rr.zoom<=N||(rr.zoom=N,q.push(rr))}}}return q},er.prototype._getOriginId=function(R){return R-this.points.length>>5},er.prototype._getOriginZoom=function(R){return(R-this.points.length)%32},er.prototype._map=function(R,N){if(R.numPoints)return N?ji({},R.properties):R.properties;var q=this.points[R.index].properties,K=this.options.map(q);return N&&K===q?ji({},K):K},ri.prototype.options={maxZoom:14,indexMaxZoom:5,indexMaxPoints:1e5,tolerance:3,extent:4096,buffer:64,lineMetrics:!1,promoteId:null,generateId:!1,debug:0},ri.prototype.splitTile=function(R,N,q,K,W,ue,fe){for(var U=[R,N,q,K],Q=this.options,ge=Q.debug;U.length;){K=U.pop(),q=U.pop(),N=U.pop(),R=U.pop();var Ce=1<<N,Le=re(N,q,K),Ee=this.tiles[Le];if(!Ee&&(ge>1&&console.time("creation"),Ee=this.tiles[Le]=ti(R,N,q,K,Q),this.tileCoords.push({z:N,x:q,y:K}),ge)){ge>1&&(console.log("tile z%d-%d-%d (features: %d, points: %d, simplified: %d)",N,q,K,Ee.numFeatures,Ee.numPoints,Ee.numSimplified),console.timeEnd("creation"));var Re="z"+N;this.stats[Re]=(this.stats[Re]||0)+1,this.total++}if(Ee.source=R,W){if(N===Q.maxZoom||N===W)continue;var ht=1<<W-N;if(q!==Math.floor(ue/ht)||K!==Math.floor(fe/ht))continue}else if(N===Q.indexMaxZoom||Ee.numPoints<=Q.indexMaxPoints)continue;if(Ee.source=null,R.length!==0){ge>1&&console.time("clipping");var at,Te,He,Qe,rt,jt,nt=.5*Q.buffer/Q.extent,tr=.5-nt,wr=.5+nt,Ht=1+nt;at=Te=He=Qe=null,rt=Xr(R,Ce,q-nt,q+wr,0,Ee.minX,Ee.maxX,Q),jt=Xr(R,Ce,q+tr,q+Ht,0,Ee.minX,Ee.maxX,Q),R=null,rt&&(at=Xr(rt,Ce,K-nt,K+wr,1,Ee.minY,Ee.maxY,Q),Te=Xr(rt,Ce,K+tr,K+Ht,1,Ee.minY,Ee.maxY,Q),rt=null),jt&&(He=Xr(jt,Ce,K-nt,K+wr,1,Ee.minY,Ee.maxY,Q),Qe=Xr(jt,Ce,K+tr,K+Ht,1,Ee.minY,Ee.maxY,Q),jt=null),ge>1&&console.timeEnd("clipping"),U.push(at||[],N+1,2*q,2*K),U.push(Te||[],N+1,2*q,2*K+1),U.push(He||[],N+1,2*q+1,2*K),U.push(Qe||[],N+1,2*q+1,2*K+1)}}},ri.prototype.getTile=function(R,N,q){var K=this.options,W=K.extent,ue=K.debug;if(R<0||R>24)return null;var fe=1<<R,U=re(R,N=(N%fe+fe)%fe,q);if(this.tiles[U])return ta(this.tiles[U],W);ue>1&&console.log("drilling down to z%d-%d-%d",R,N,q);for(var Q,ge=R,Ce=N,Le=q;!Q&&ge>0;)ge--,Ce=Math.floor(Ce/2),Le=Math.floor(Le/2),Q=this.tiles[re(ge,Ce,Le)];return Q&&Q.source?(ue>1&&console.log("found parent tile z%d-%d-%d",ge,Ce,Le),ue>1&&console.time("drilling down"),this.splitTile(Q.source,ge,Ce,Le,R,N,q),ue>1&&console.timeEnd("drilling down"),this.tiles[U]?ta(this.tiles[U],W):null):null};var Ti=function(R){function N(q,K,W,ue){R.call(this,q,K,W,yt),ue&&(this.loadGeoJSON=ue)}return R&&(N.__proto__=R),(N.prototype=Object.create(R&&R.prototype)).constructor=N,N.prototype.loadData=function(q,K){this._pendingCallback&&this._pendingCallback(null,{abandoned:!0}),this._pendingCallback=K,this._pendingLoadDataParams=q,this._state&&this._state!=="Idle"?this._state="NeedsLoadData":(this._state="Coalescing",this._loadData())},N.prototype._loadData=function(){var q=this;if(this._pendingCallback&&this._pendingLoadDataParams){var K=this._pendingCallback,W=this._pendingLoadDataParams;delete this._pendingCallback,delete this._pendingLoadDataParams;var ue=!!(W&&W.request&&W.request.collectResourceTiming)&&new a.RequestPerformance(W.request);this.loadGeoJSON(W,function(fe,U){if(fe||!U)return K(fe);if(typeof U!="object")return K(new Error("Input data given to '"+W.source+"' is not a valid GeoJSON object."));(function Ee(Re,ht){var at,Te=Re&&Re.type;if(Te==="FeatureCollection")for(at=0;at<Re.features.length;at++)Ee(Re.features[at],ht);else if(Te==="GeometryCollection")for(at=0;at<Re.geometries.length;at++)Ee(Re.geometries[at],ht);else if(Te==="Feature")Ee(Re.geometry,ht);else if(Te==="Polygon")xe(Re.coordinates,ht);else if(Te==="MultiPolygon")for(at=0;at<Re.coordinates.length;at++)xe(Re.coordinates[at],ht);return Re})(U,!0);try{if(W.filter){var Q=a.createExpression(W.filter,{type:"boolean","property-type":"data-driven",overridable:!1,transition:!1});if(Q.result==="error")throw new Error(Q.value.map(function(Ee){return Ee.key+": "+Ee.message}).join(", "));var ge=U.features.filter(function(Ee){return Q.value.evaluate({zoom:0},Ee)});U={type:"FeatureCollection",features:ge}}q._geoJSONIndex=W.cluster?new er(function(Ee){var Re=Ee.superclusterOptions,ht=Ee.clusterProperties;if(!ht||!Re)return Re;for(var at={},Te={},He={accumulated:null,zoom:0},Qe={properties:null},rt=Object.keys(ht),jt=0,nt=rt;jt<nt.length;jt+=1){var tr=nt[jt],wr=ht[tr],Ht=wr[0],fr=a.createExpression(wr[1]),rr=a.createExpression(typeof Ht=="string"?[Ht,["accumulated"],["get",tr]]:Ht);at[tr]=fr.value,Te[tr]=rr.value}return Re.map=function(xi){Qe.properties=xi;for(var yr={},Or=0,br=rt;Or<br.length;Or+=1){var Qt=br[Or];yr[Qt]=at[Qt].evaluate(He,Qe)}return yr},Re.reduce=function(xi,yr){Qe.properties=yr;for(var Or=0,br=rt;Or<br.length;Or+=1){var Qt=br[Or];He.accumulated=xi[Qt],xi[Qt]=Te[Qt].evaluate(He,Qe)}},Re}(W)).load(U.features):function(Ee,Re){return new ri(Ee,Re)}(U,W.geojsonVtOptions)}catch(Ee){return K(Ee)}q.loaded={};var Ce={};if(ue){var Le=ue.finish();Le&&(Ce.resourceTiming={},Ce.resourceTiming[W.source]=JSON.parse(JSON.stringify(Le)))}K(null,Ce)})}},N.prototype.coalesce=function(){this._state==="Coalescing"?this._state="Idle":this._state==="NeedsLoadData"&&(this._state="Coalescing",this._loadData())},N.prototype.reloadTile=function(q,K){var W=this.loaded;return W&&W[q.uid]?R.prototype.reloadTile.call(this,q,K):this.loadTile(q,K)},N.prototype.loadGeoJSON=function(q,K){if(q.request)a.getJSON(q.request,K);else{if(typeof q.data!="string")return K(new Error("Input data given to '"+q.source+"' is not a valid GeoJSON object."));try{return K(null,JSON.parse(q.data))}catch{return K(new Error("Input data given to '"+q.source+"' is not a valid GeoJSON object."))}}},N.prototype.removeSource=function(q,K){this._pendingCallback&&this._pendingCallback(null,{abandoned:!0}),K()},N.prototype.getClusterExpansionZoom=function(q,K){try{K(null,this._geoJSONIndex.getClusterExpansionZoom(q.clusterId))}catch(W){K(W)}},N.prototype.getClusterChildren=function(q,K){try{K(null,this._geoJSONIndex.getChildren(q.clusterId))}catch(W){K(W)}},N.prototype.getClusterLeaves=function(q,K){try{K(null,this._geoJSONIndex.getLeaves(q.clusterId,q.limit,q.offset))}catch(W){K(W)}},N}(oe),pr=function(R){var N=this;this.self=R,this.actor=new a.Actor(R,this),this.layerIndexes={},this.availableImages={},this.workerSourceTypes={vector:oe,geojson:Ti},this.workerSources={},this.demWorkerSources={},this.self.registerWorkerSource=function(q,K){if(N.workerSourceTypes[q])throw new Error('Worker source with name "'+q+'" already registered.');N.workerSourceTypes[q]=K},this.self.registerRTLTextPlugin=function(q){if(a.plugin.isParsed())throw new Error("RTL text plugin already registered.");a.plugin.applyArabicShaping=q.applyArabicShaping,a.plugin.processBidirectionalText=q.processBidirectionalText,a.plugin.processStyledBidirectionalText=q.processStyledBidirectionalText}};return pr.prototype.setReferrer=function(R,N){this.referrer=N},pr.prototype.setImages=function(R,N,q){for(var K in this.availableImages[R]=N,this.workerSources[R]){var W=this.workerSources[R][K];for(var ue in W)W[ue].availableImages=N}q()},pr.prototype.setLayers=function(R,N,q){this.getLayerIndex(R).replace(N),q()},pr.prototype.updateLayers=function(R,N,q){this.getLayerIndex(R).update(N.layers,N.removedIds),q()},pr.prototype.loadTile=function(R,N,q){this.getWorkerSource(R,N.type,N.source).loadTile(N,q)},pr.prototype.loadDEMTile=function(R,N,q){this.getDEMWorkerSource(R,N.source).loadTile(N,q)},pr.prototype.reloadTile=function(R,N,q){this.getWorkerSource(R,N.type,N.source).reloadTile(N,q)},pr.prototype.abortTile=function(R,N,q){this.getWorkerSource(R,N.type,N.source).abortTile(N,q)},pr.prototype.removeTile=function(R,N,q){this.getWorkerSource(R,N.type,N.source).removeTile(N,q)},pr.prototype.removeDEMTile=function(R,N){this.getDEMWorkerSource(R,N.source).removeTile(N)},pr.prototype.removeSource=function(R,N,q){if(this.workerSources[R]&&this.workerSources[R][N.type]&&this.workerSources[R][N.type][N.source]){var K=this.workerSources[R][N.type][N.source];delete this.workerSources[R][N.type][N.source],K.removeSource!==void 0?K.removeSource(N,q):q()}},pr.prototype.loadWorkerSource=function(R,N,q){try{this.self.importScripts(N.url),q()}catch(K){q(K.toString())}},pr.prototype.syncRTLPluginState=function(R,N,q){try{a.plugin.setState(N);var K=a.plugin.getPluginURL();if(a.plugin.isLoaded()&&!a.plugin.isParsed()&&K!=null){this.self.importScripts(K);var W=a.plugin.isParsed();q(W?void 0:new Error("RTL Text Plugin failed to import scripts from "+K),W)}}catch(ue){q(ue.toString())}},pr.prototype.getAvailableImages=function(R){var N=this.availableImages[R];return N||(N=[]),N},pr.prototype.getLayerIndex=function(R){var N=this.layerIndexes[R];return N||(N=this.layerIndexes[R]=new D),N},pr.prototype.getWorkerSource=function(R,N,q){var K=this;return this.workerSources[R]||(this.workerSources[R]={}),this.workerSources[R][N]||(this.workerSources[R][N]={}),this.workerSources[R][N][q]||(this.workerSources[R][N][q]=new this.workerSourceTypes[N]({send:function(W,ue,fe){K.actor.send(W,ue,fe,R)}},this.getLayerIndex(R),this.getAvailableImages(R))),this.workerSources[R][N][q]},pr.prototype.getDEMWorkerSource=function(R,N){return this.demWorkerSources[R]||(this.demWorkerSources[R]={}),this.demWorkerSources[R][N]||(this.demWorkerSources[R][N]=new pe),this.demWorkerSources[R][N]},pr.prototype.enforceCacheSizeLimit=function(R,N){a.enforceCacheSizeLimit(N)},typeof WorkerGlobalScope<"u"&&typeof self<"u"&&self instanceof WorkerGlobalScope&&(self.worker=new pr(self)),pr}),_(["./shared"],function(a){var I=a.createCommonjsModule(function(n){function s(v){return!o(v)}function o(v){return typeof window>"u"||typeof document>"u"?"not a browser":Array.prototype&&Array.prototype.every&&Array.prototype.filter&&Array.prototype.forEach&&Array.prototype.indexOf&&Array.prototype.lastIndexOf&&Array.prototype.map&&Array.prototype.some&&Array.prototype.reduce&&Array.prototype.reduceRight&&Array.isArray?Function.prototype&&Function.prototype.bind?Object.keys&&Object.create&&Object.getPrototypeOf&&Object.getOwnPropertyNames&&Object.isSealed&&Object.isFrozen&&Object.isExtensible&&Object.getOwnPropertyDescriptor&&Object.defineProperty&&Object.defineProperties&&Object.seal&&Object.freeze&&Object.preventExtensions?"JSON"in window&&"parse"in JSON&&"stringify"in JSON?function(){if(!("Worker"in window&&"Blob"in window&&"URL"in window))return!1;var S,E,P=new Blob([""],{type:"text/javascript"}),O=URL.createObjectURL(P);try{E=new Worker(O),S=!0}catch{S=!1}return E&&E.terminate(),URL.revokeObjectURL(O),S}()?"Uint8ClampedArray"in window?ArrayBuffer.isView?function(){var S=document.createElement("canvas");S.width=S.height=1;var E=S.getContext("2d");if(!E)return!1;var P=E.getImageData(0,0,1,1);return P&&P.width===S.width}()?(c[w=v&&v.failIfMajorPerformanceCaveat]===void 0&&(c[w]=function(S){var E=function(O){var G=document.createElement("canvas"),Z=Object.create(s.webGLContextAttributes);return Z.failIfMajorPerformanceCaveat=O,G.probablySupportsContext?G.probablySupportsContext("webgl",Z)||G.probablySupportsContext("experimental-webgl",Z):G.supportsContext?G.supportsContext("webgl",Z)||G.supportsContext("experimental-webgl",Z):G.getContext("webgl",Z)||G.getContext("experimental-webgl",Z)}(S);if(!E)return!1;var P=E.createShader(E.VERTEX_SHADER);return!(!P||E.isContextLost())&&(E.shaderSource(P,"void main() {}"),E.compileShader(P),E.getShaderParameter(P,E.COMPILE_STATUS)===!0)}(w)),c[w]?void 0:"insufficient WebGL support"):"insufficient Canvas/getImageData support":"insufficient ArrayBuffer support":"insufficient Uint8ClampedArray support":"insufficient worker support":"insufficient JSON support":"insufficient Object support":"insufficient Function support":"insufficent Array support";var w}n.exports?n.exports=s:window&&(window.mapboxgl=window.mapboxgl||{},window.mapboxgl.supported=s,window.mapboxgl.notSupportedReason=o);var c={};s.webGLContextAttributes={antialias:!1,alpha:!0,stencil:!0,depth:!0}}),T={create:function(n,s,o){var c=a.window.document.createElement(n);return s!==void 0&&(c.className=s),o&&o.appendChild(c),c},createNS:function(n,s){return a.window.document.createElementNS(n,s)}},D=a.window.document&&a.window.document.documentElement.style;function F(n){if(!D)return n[0];for(var s=0;s<n.length;s++)if(n[s]in D)return n[s];return n[0]}var M,L=F(["userSelect","MozUserSelect","WebkitUserSelect","msUserSelect"]);T.disableDrag=function(){D&&L&&(M=D[L],D[L]="none")},T.enableDrag=function(){D&&L&&(D[L]=M)};var X=F(["transform","WebkitTransform"]);T.setTransform=function(n,s){n.style[X]=s};var oe=!1;try{var se=Object.defineProperty({},"passive",{get:function(){oe=!0}});a.window.addEventListener("test",se,se),a.window.removeEventListener("test",se,se)}catch{oe=!1}T.addEventListener=function(n,s,o,c){c===void 0&&(c={}),n.addEventListener(s,o,"passive"in c&&oe?c:c.capture)},T.removeEventListener=function(n,s,o,c){c===void 0&&(c={}),n.removeEventListener(s,o,"passive"in c&&oe?c:c.capture)};var pe=function(n){n.preventDefault(),n.stopPropagation(),a.window.removeEventListener("click",pe,!0)};function xe(n){var s=n.userImage;return!!(s&&s.render&&s.render())&&(n.data.replace(new Uint8Array(s.data.buffer)),!0)}T.suppressClick=function(){a.window.addEventListener("click",pe,!0),a.window.setTimeout(function(){a.window.removeEventListener("click",pe,!0)},0)},T.mousePos=function(n,s){var o=n.getBoundingClientRect();return new a.Point(s.clientX-o.left-n.clientLeft,s.clientY-o.top-n.clientTop)},T.touchPos=function(n,s){for(var o=n.getBoundingClientRect(),c=[],v=0;v<s.length;v++)c.push(new a.Point(s[v].clientX-o.left-n.clientLeft,s[v].clientY-o.top-n.clientTop));return c},T.mouseButton=function(n){return a.window.InstallTrigger!==void 0&&n.button===2&&n.ctrlKey&&a.window.navigator.platform.toUpperCase().indexOf("MAC")>=0?0:n.button},T.remove=function(n){n.parentNode&&n.parentNode.removeChild(n)};var be=function(n){function s(){n.call(this),this.images={},this.updatedImages={},this.callbackDispatchedThisFrame={},this.loaded=!1,this.requestors=[],this.patterns={},this.atlasImage=new a.RGBAImage({width:1,height:1}),this.dirty=!0}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype.isLoaded=function(){return this.loaded},s.prototype.setLoaded=function(o){if(this.loaded!==o&&(this.loaded=o,o)){for(var c=0,v=this.requestors;c<v.length;c+=1){var w=v[c];this._notify(w.ids,w.callback)}this.requestors=[]}},s.prototype.getImage=function(o){return this.images[o]},s.prototype.addImage=function(o,c){this._validate(o,c)&&(this.images[o]=c)},s.prototype._validate=function(o,c){var v=!0;return this._validateStretch(c.stretchX,c.data&&c.data.width)||(this.fire(new a.ErrorEvent(new Error('Image "'+o+'" has invalid "stretchX" value'))),v=!1),this._validateStretch(c.stretchY,c.data&&c.data.height)||(this.fire(new a.ErrorEvent(new Error('Image "'+o+'" has invalid "stretchY" value'))),v=!1),this._validateContent(c.content,c)||(this.fire(new a.ErrorEvent(new Error('Image "'+o+'" has invalid "content" value'))),v=!1),v},s.prototype._validateStretch=function(o,c){if(!o)return!0;for(var v=0,w=0,S=o;w<S.length;w+=1){var E=S[w];if(E[0]<v||E[1]<E[0]||c<E[1])return!1;v=E[1]}return!0},s.prototype._validateContent=function(o,c){return!(o&&(o.length!==4||o[0]<0||c.data.width<o[0]||o[1]<0||c.data.height<o[1]||o[2]<0||c.data.width<o[2]||o[3]<0||c.data.height<o[3]||o[2]<o[0]||o[3]<o[1]))},s.prototype.updateImage=function(o,c){c.version=this.images[o].version+1,this.images[o]=c,this.updatedImages[o]=!0},s.prototype.removeImage=function(o){var c=this.images[o];delete this.images[o],delete this.patterns[o],c.userImage&&c.userImage.onRemove&&c.userImage.onRemove()},s.prototype.listImages=function(){return Object.keys(this.images)},s.prototype.getImages=function(o,c){var v=!0;if(!this.isLoaded())for(var w=0,S=o;w<S.length;w+=1)this.images[S[w]]||(v=!1);this.isLoaded()||v?this._notify(o,c):this.requestors.push({ids:o,callback:c})},s.prototype._notify=function(o,c){for(var v={},w=0,S=o;w<S.length;w+=1){var E=S[w];this.images[E]||this.fire(new a.Event("styleimagemissing",{id:E}));var P=this.images[E];P?v[E]={data:P.data.clone(),pixelRatio:P.pixelRatio,sdf:P.sdf,version:P.version,stretchX:P.stretchX,stretchY:P.stretchY,content:P.content,hasRenderCallback:!!(P.userImage&&P.userImage.render)}:a.warnOnce('Image "'+E+'" could not be loaded. Please make sure you have added the image with map.addImage() or a "sprite" property in your style. You can provide missing images by listening for the "styleimagemissing" map event.')}c(null,v)},s.prototype.getPixelSize=function(){var o=this.atlasImage;return{width:o.width,height:o.height}},s.prototype.getPattern=function(o){var c=this.patterns[o],v=this.getImage(o);if(!v)return null;if(c&&c.position.version===v.version)return c.position;if(c)c.position.version=v.version;else{var w={w:v.data.width+2,h:v.data.height+2,x:0,y:0},S=new a.ImagePosition(w,v);this.patterns[o]={bin:w,position:S}}return this._updatePatternAtlas(),this.patterns[o].position},s.prototype.bind=function(o){var c=o.gl;this.atlasTexture?this.dirty&&(this.atlasTexture.update(this.atlasImage),this.dirty=!1):this.atlasTexture=new a.Texture(o,this.atlasImage,c.RGBA),this.atlasTexture.bind(c.LINEAR,c.CLAMP_TO_EDGE)},s.prototype._updatePatternAtlas=function(){var o=[];for(var c in this.patterns)o.push(this.patterns[c].bin);var v=a.potpack(o),w=v.w,S=v.h,E=this.atlasImage;for(var P in E.resize({width:w||1,height:S||1}),this.patterns){var O=this.patterns[P].bin,G=O.x+1,Z=O.y+1,H=this.images[P].data,te=H.width,ee=H.height;a.RGBAImage.copy(H,E,{x:0,y:0},{x:G,y:Z},{width:te,height:ee}),a.RGBAImage.copy(H,E,{x:0,y:ee-1},{x:G,y:Z-1},{width:te,height:1}),a.RGBAImage.copy(H,E,{x:0,y:0},{x:G,y:Z+ee},{width:te,height:1}),a.RGBAImage.copy(H,E,{x:te-1,y:0},{x:G-1,y:Z},{width:1,height:ee}),a.RGBAImage.copy(H,E,{x:0,y:0},{x:G+te,y:Z},{width:1,height:ee})}this.dirty=!0},s.prototype.beginFrame=function(){this.callbackDispatchedThisFrame={}},s.prototype.dispatchRenderCallbacks=function(o){for(var c=0,v=o;c<v.length;c+=1){var w=v[c];if(!this.callbackDispatchedThisFrame[w]){this.callbackDispatchedThisFrame[w]=!0;var S=this.images[w];xe(S)&&this.updateImage(w,S)}}},s}(a.Evented),ct=Ze,We=Ze,De=1e20;function Ze(n,s,o,c,v,w){this.fontSize=n||24,this.buffer=s===void 0?3:s,this.cutoff=c||.25,this.fontFamily=v||"sans-serif",this.fontWeight=w||"normal",this.radius=o||8;var S=this.size=this.fontSize+2*this.buffer;this.canvas=document.createElement("canvas"),this.canvas.width=this.canvas.height=S,this.ctx=this.canvas.getContext("2d"),this.ctx.font=this.fontWeight+" "+this.fontSize+"px "+this.fontFamily,this.ctx.textBaseline="middle",this.ctx.fillStyle="black",this.gridOuter=new Float64Array(S*S),this.gridInner=new Float64Array(S*S),this.f=new Float64Array(S),this.d=new Float64Array(S),this.z=new Float64Array(S+1),this.v=new Int16Array(S),this.middle=Math.round(S/2*(navigator.userAgent.indexOf("Gecko/")>=0?1.2:1))}function Dt(n,s,o,c,v,w,S){for(var E=0;E<s;E++){for(var P=0;P<o;P++)c[P]=n[P*s+E];for(zt(c,v,w,S,o),P=0;P<o;P++)n[P*s+E]=v[P]}for(P=0;P<o;P++){for(E=0;E<s;E++)c[E]=n[P*s+E];for(zt(c,v,w,S,s),E=0;E<s;E++)n[P*s+E]=Math.sqrt(v[E])}}function zt(n,s,o,c,v){o[0]=0,c[0]=-De,c[1]=+De;for(var w=1,S=0;w<v;w++){for(var E=(n[w]+w*w-(n[o[S]]+o[S]*o[S]))/(2*w-2*o[S]);E<=c[S];)S--,E=(n[w]+w*w-(n[o[S]]+o[S]*o[S]))/(2*w-2*o[S]);o[++S]=w,c[S]=E,c[S+1]=+De}for(w=0,S=0;w<v;w++){for(;c[S+1]<w;)S++;s[w]=(w-o[S])*(w-o[S])+n[o[S]]}}Ze.prototype.draw=function(n){this.ctx.clearRect(0,0,this.size,this.size),this.ctx.fillText(n,this.buffer,this.middle);for(var s=this.ctx.getImageData(0,0,this.size,this.size),o=new Uint8ClampedArray(this.size*this.size),c=0;c<this.size*this.size;c++){var v=s.data[4*c+3]/255;this.gridOuter[c]=v===1?0:v===0?De:Math.pow(Math.max(0,.5-v),2),this.gridInner[c]=v===1?De:v===0?0:Math.pow(Math.max(0,v-.5),2)}for(Dt(this.gridOuter,this.size,this.size,this.f,this.d,this.v,this.z),Dt(this.gridInner,this.size,this.size,this.f,this.d,this.v,this.z),c=0;c<this.size*this.size;c++)o[c]=Math.max(0,Math.min(255,Math.round(255-255*((this.gridOuter[c]-this.gridInner[c])/this.radius+this.cutoff))));return o},ct.default=We;var Ue=function(n,s){this.requestManager=n,this.localIdeographFontFamily=s,this.entries={}};Ue.prototype.setURL=function(n){this.url=n},Ue.prototype.getGlyphs=function(n,s){var o=this,c=[];for(var v in n)for(var w=0,S=n[v];w<S.length;w+=1)c.push({stack:v,id:S[w]});a.asyncAll(c,function(E,P){var O=E.stack,G=E.id,Z=o.entries[O];Z||(Z=o.entries[O]={glyphs:{},requests:{},ranges:{}});var H=Z.glyphs[G];if(H===void 0){if(H=o._tinySDF(Z,O,G))return Z.glyphs[G]=H,void P(null,{stack:O,id:G,glyph:H});var te=Math.floor(G/256);if(256*te>65535)P(new Error("glyphs > 65535 not supported"));else if(Z.ranges[te])P(null,{stack:O,id:G,glyph:H});else{var ee=Z.requests[te];ee||(ee=Z.requests[te]=[],Ue.loadGlyphRange(O,te,o.url,o.requestManager,function(ce,Y){if(Y){for(var le in Y)o._doesCharSupportLocalGlyph(+le)||(Z.glyphs[+le]=Y[+le]);Z.ranges[te]=!0}for(var de=0,_e=ee;de<_e.length;de+=1)(0,_e[de])(ce,Y);delete Z.requests[te]})),ee.push(function(ce,Y){ce?P(ce):Y&&P(null,{stack:O,id:G,glyph:Y[G]||null})})}}else P(null,{stack:O,id:G,glyph:H})},function(E,P){if(E)s(E);else if(P){for(var O={},G=0,Z=P;G<Z.length;G+=1){var H=Z[G],te=H.stack,ee=H.id,ce=H.glyph;(O[te]||(O[te]={}))[ee]=ce&&{id:ce.id,bitmap:ce.bitmap.clone(),metrics:ce.metrics}}s(null,O)}})},Ue.prototype._doesCharSupportLocalGlyph=function(n){return!!this.localIdeographFontFamily&&(a.isChar["CJK Unified Ideographs"](n)||a.isChar["Hangul Syllables"](n)||a.isChar.Hiragana(n)||a.isChar.Katakana(n))},Ue.prototype._tinySDF=function(n,s,o){var c=this.localIdeographFontFamily;if(c&&this._doesCharSupportLocalGlyph(o)){var v=n.tinySDF;if(!v){var w="400";/bold/i.test(s)?w="900":/medium/i.test(s)?w="500":/light/i.test(s)&&(w="200"),v=n.tinySDF=new Ue.TinySDF(24,3,8,.25,c,w)}return{id:o,bitmap:new a.AlphaImage({width:30,height:30},v.draw(String.fromCharCode(o))),metrics:{width:24,height:24,left:0,top:-8,advance:24}}}},Ue.loadGlyphRange=function(n,s,o,c,v){var w=256*s,S=w+255,E=c.transformRequest(c.normalizeGlyphsURL(o).replace("{fontstack}",n).replace("{range}",w+"-"+S),a.ResourceType.Glyphs);a.getArrayBuffer(E,function(P,O){if(P)v(P);else if(O){for(var G={},Z=0,H=a.parseGlyphPBF(O);Z<H.length;Z+=1){var te=H[Z];G[te.id]=te}v(null,G)}})},Ue.TinySDF=ct;var Ke=function(){this.specification=a.styleSpec.light.position};Ke.prototype.possiblyEvaluate=function(n,s){return a.sphericalToCartesian(n.expression.evaluate(s))},Ke.prototype.interpolate=function(n,s,o){return{x:a.number(n.x,s.x,o),y:a.number(n.y,s.y,o),z:a.number(n.z,s.z,o)}};var vt=new a.Properties({anchor:new a.DataConstantProperty(a.styleSpec.light.anchor),position:new Ke,color:new a.DataConstantProperty(a.styleSpec.light.color),intensity:new a.DataConstantProperty(a.styleSpec.light.intensity)}),cr=function(n){function s(o){n.call(this),this._transitionable=new a.Transitionable(vt),this.setLight(o),this._transitioning=this._transitionable.untransitioned()}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype.getLight=function(){return this._transitionable.serialize()},s.prototype.setLight=function(o,c){if(c===void 0&&(c={}),!this._validate(a.validateLight,o,c))for(var v in o){var w=o[v];a.endsWith(v,"-transition")?this._transitionable.setTransition(v.slice(0,-11),w):this._transitionable.setValue(v,w)}},s.prototype.updateTransitions=function(o){this._transitioning=this._transitionable.transitioned(o,this._transitioning)},s.prototype.hasTransition=function(){return this._transitioning.hasTransition()},s.prototype.recalculate=function(o){this.properties=this._transitioning.possiblyEvaluate(o)},s.prototype._validate=function(o,c,v){return(!v||v.validate!==!1)&&a.emitValidationErrors(this,o.call(a.validateStyle,a.extend({value:c,style:{glyphs:!0,sprite:!0},styleSpec:a.styleSpec})))},s}(a.Evented),Ne=function(n,s){this.width=n,this.height=s,this.nextRow=0,this.data=new Uint8Array(this.width*this.height),this.dashEntry={}};Ne.prototype.getDash=function(n,s){var o=n.join(",")+String(s);return this.dashEntry[o]||(this.dashEntry[o]=this.addDash(n,s)),this.dashEntry[o]},Ne.prototype.getDashRanges=function(n,s,o){var c=[],v=n.length%2==1?-n[n.length-1]*o:0,w=n[0]*o,S=!0;c.push({left:v,right:w,isDash:S,zeroLength:n[0]===0});for(var E=n[0],P=1;P<n.length;P++){var O=n[P];c.push({left:v=E*o,right:w=(E+=O)*o,isDash:S=!S,zeroLength:O===0})}return c},Ne.prototype.addRoundDash=function(n,s,o){for(var c=s/2,v=-o;v<=o;v++)for(var w=this.width*(this.nextRow+o+v),S=0,E=n[S],P=0;P<this.width;P++){P/E.right>1&&(E=n[++S]);var O=Math.abs(P-E.left),G=Math.abs(P-E.right),Z=Math.min(O,G),H=void 0,te=v/o*(c+1);if(E.isDash){var ee=c-Math.abs(te);H=Math.sqrt(Z*Z+ee*ee)}else H=c-Math.sqrt(Z*Z+te*te);this.data[w+P]=Math.max(0,Math.min(255,H+128))}},Ne.prototype.addRegularDash=function(n){for(var s=n.length-1;s>=0;--s){var o=n[s],c=n[s+1];o.zeroLength?n.splice(s,1):c&&c.isDash===o.isDash&&(c.left=o.left,n.splice(s,1))}var v=n[0],w=n[n.length-1];v.isDash===w.isDash&&(v.left=w.left-this.width,w.right=v.right+this.width);for(var S=this.width*this.nextRow,E=0,P=n[E],O=0;O<this.width;O++){O/P.right>1&&(P=n[++E]);var G=Math.abs(O-P.left),Z=Math.abs(O-P.right),H=Math.min(G,Z);this.data[S+O]=Math.max(0,Math.min(255,(P.isDash?H:-H)+128))}},Ne.prototype.addDash=function(n,s){var o=s?7:0,c=2*o+1;if(this.nextRow+c>this.height)return a.warnOnce("LineAtlas out of space"),null;for(var v=0,w=0;w<n.length;w++)v+=n[w];if(v!==0){var S=this.width/v,E=this.getDashRanges(n,this.width,S);s?this.addRoundDash(E,S,o):this.addRegularDash(E)}var P={y:(this.nextRow+o+.5)/this.height,height:2*o/this.height,width:v};return this.nextRow+=c,this.dirty=!0,P},Ne.prototype.bind=function(n){var s=n.gl;this.texture?(s.bindTexture(s.TEXTURE_2D,this.texture),this.dirty&&(this.dirty=!1,s.texSubImage2D(s.TEXTURE_2D,0,0,0,this.width,this.height,s.ALPHA,s.UNSIGNED_BYTE,this.data))):(this.texture=s.createTexture(),s.bindTexture(s.TEXTURE_2D,this.texture),s.texParameteri(s.TEXTURE_2D,s.TEXTURE_WRAP_S,s.REPEAT),s.texParameteri(s.TEXTURE_2D,s.TEXTURE_WRAP_T,s.REPEAT),s.texParameteri(s.TEXTURE_2D,s.TEXTURE_MIN_FILTER,s.LINEAR),s.texParameteri(s.TEXTURE_2D,s.TEXTURE_MAG_FILTER,s.LINEAR),s.texImage2D(s.TEXTURE_2D,0,s.ALPHA,this.width,this.height,0,s.ALPHA,s.UNSIGNED_BYTE,this.data))};var Rt=function n(s,o){this.workerPool=s,this.actors=[],this.currentActor=0,this.id=a.uniqueId();for(var c=this.workerPool.acquire(this.id),v=0;v<c.length;v++){var w=new n.Actor(c[v],o,this.id);w.name="Worker "+v,this.actors.push(w)}};function Me(n,s,o){var c=function(v,w){if(v)return o(v);if(w){var S=a.pick(a.extend(w,n),["tiles","minzoom","maxzoom","attribution","mapbox_logo","bounds","scheme","tileSize","encoding"]);w.vector_layers&&(S.vectorLayers=w.vector_layers,S.vectorLayerIds=S.vectorLayers.map(function(E){return E.id})),S.tiles=s.canonicalizeTileset(S,n.url),o(null,S)}};return n.url?a.getJSON(s.transformRequest(s.normalizeSourceURL(n.url),a.ResourceType.Source),c):a.browser.frame(function(){return c(null,n)})}Rt.prototype.broadcast=function(n,s,o){a.asyncAll(this.actors,function(c,v){c.send(n,s,v)},o=o||function(){})},Rt.prototype.getActor=function(){return this.currentActor=(this.currentActor+1)%this.actors.length,this.actors[this.currentActor]},Rt.prototype.remove=function(){this.actors.forEach(function(n){n.remove()}),this.actors=[],this.workerPool.release(this.id)},Rt.Actor=a.Actor;var $e=function(n,s,o){this.bounds=a.LngLatBounds.convert(this.validateBounds(n)),this.minzoom=s||0,this.maxzoom=o||24};$e.prototype.validateBounds=function(n){return Array.isArray(n)&&n.length===4?[Math.max(-180,n[0]),Math.max(-90,n[1]),Math.min(180,n[2]),Math.min(90,n[3])]:[-180,-90,180,90]},$e.prototype.contains=function(n){var s=Math.pow(2,n.z),o=Math.floor(a.mercatorXfromLng(this.bounds.getWest())*s),c=Math.floor(a.mercatorYfromLat(this.bounds.getNorth())*s),v=Math.ceil(a.mercatorXfromLng(this.bounds.getEast())*s),w=Math.ceil(a.mercatorYfromLat(this.bounds.getSouth())*s);return n.x>=o&&n.x<v&&n.y>=c&&n.y<w};var mt=function(n){function s(o,c,v,w){if(n.call(this),this.id=o,this.dispatcher=v,this.type="vector",this.minzoom=0,this.maxzoom=22,this.scheme="xyz",this.tileSize=512,this.reparseOverscaled=!0,this.isTileClipped=!0,this._loaded=!1,a.extend(this,a.pick(c,["url","scheme","tileSize","promoteId"])),this._options=a.extend({type:"vector"},c),this._collectResourceTiming=c.collectResourceTiming,this.tileSize!==512)throw new Error("vector tile sources must have a tileSize of 512");this.setEventedParent(w)}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype.load=function(){var o=this;this._loaded=!1,this.fire(new a.Event("dataloading",{dataType:"source"})),this._tileJSONRequest=Me(this._options,this.map._requestManager,function(c,v){o._tileJSONRequest=null,o._loaded=!0,c?o.fire(new a.ErrorEvent(c)):v&&(a.extend(o,v),v.bounds&&(o.tileBounds=new $e(v.bounds,o.minzoom,o.maxzoom)),a.postTurnstileEvent(v.tiles,o.map._requestManager._customAccessToken),a.postMapLoadEvent(v.tiles,o.map._getMapId(),o.map._requestManager._skuToken,o.map._requestManager._customAccessToken),o.fire(new a.Event("data",{dataType:"source",sourceDataType:"metadata"})),o.fire(new a.Event("data",{dataType:"source",sourceDataType:"content"})))})},s.prototype.loaded=function(){return this._loaded},s.prototype.hasTile=function(o){return!this.tileBounds||this.tileBounds.contains(o.canonical)},s.prototype.onAdd=function(o){this.map=o,this.load()},s.prototype.setSourceProperty=function(o){this._tileJSONRequest&&this._tileJSONRequest.cancel(),o(),this.map.style.sourceCaches[this.id].clearTiles(),this.load()},s.prototype.setTiles=function(o){var c=this;return this.setSourceProperty(function(){c._options.tiles=o}),this},s.prototype.setUrl=function(o){var c=this;return this.setSourceProperty(function(){c.url=o,c._options.url=o}),this},s.prototype.onRemove=function(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)},s.prototype.serialize=function(){return a.extend({},this._options)},s.prototype.loadTile=function(o,c){var v=this.map._requestManager.normalizeTileURL(o.tileID.canonical.url(this.tiles,this.scheme)),w={request:this.map._requestManager.transformRequest(v,a.ResourceType.Tile),uid:o.uid,tileID:o.tileID,zoom:o.tileID.overscaledZ,tileSize:this.tileSize*o.tileID.overscaleFactor(),type:this.type,source:this.id,pixelRatio:a.browser.devicePixelRatio,showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId};function S(E,P){return delete o.request,o.aborted?c(null):E&&E.status!==404?c(E):(P&&P.resourceTiming&&(o.resourceTiming=P.resourceTiming),this.map._refreshExpiredTiles&&P&&o.setExpiryData(P),o.loadVectorData(P,this.map.painter),a.cacheEntryPossiblyAdded(this.dispatcher),c(null),void(o.reloadCallback&&(this.loadTile(o,o.reloadCallback),o.reloadCallback=null)))}w.request.collectResourceTiming=this._collectResourceTiming,o.actor&&o.state!=="expired"?o.state==="loading"?o.reloadCallback=c:o.request=o.actor.send("reloadTile",w,S.bind(this)):(o.actor=this.dispatcher.getActor(),o.request=o.actor.send("loadTile",w,S.bind(this)))},s.prototype.abortTile=function(o){o.request&&(o.request.cancel(),delete o.request),o.actor&&o.actor.send("abortTile",{uid:o.uid,type:this.type,source:this.id},void 0)},s.prototype.unloadTile=function(o){o.unloadVectorData(),o.actor&&o.actor.send("removeTile",{uid:o.uid,type:this.type,source:this.id},void 0)},s.prototype.hasTransition=function(){return!1},s}(a.Evented),qt=function(n){function s(o,c,v,w){n.call(this),this.id=o,this.dispatcher=v,this.setEventedParent(w),this.type="raster",this.minzoom=0,this.maxzoom=22,this.roundZoom=!0,this.scheme="xyz",this.tileSize=512,this._loaded=!1,this._options=a.extend({type:"raster"},c),a.extend(this,a.pick(c,["url","scheme","tileSize"]))}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype.load=function(){var o=this;this._loaded=!1,this.fire(new a.Event("dataloading",{dataType:"source"})),this._tileJSONRequest=Me(this._options,this.map._requestManager,function(c,v){o._tileJSONRequest=null,o._loaded=!0,c?o.fire(new a.ErrorEvent(c)):v&&(a.extend(o,v),v.bounds&&(o.tileBounds=new $e(v.bounds,o.minzoom,o.maxzoom)),a.postTurnstileEvent(v.tiles),a.postMapLoadEvent(v.tiles,o.map._getMapId(),o.map._requestManager._skuToken),o.fire(new a.Event("data",{dataType:"source",sourceDataType:"metadata"})),o.fire(new a.Event("data",{dataType:"source",sourceDataType:"content"})))})},s.prototype.loaded=function(){return this._loaded},s.prototype.onAdd=function(o){this.map=o,this.load()},s.prototype.onRemove=function(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)},s.prototype.serialize=function(){return a.extend({},this._options)},s.prototype.hasTile=function(o){return!this.tileBounds||this.tileBounds.contains(o.canonical)},s.prototype.loadTile=function(o,c){var v=this,w=this.map._requestManager.normalizeTileURL(o.tileID.canonical.url(this.tiles,this.scheme),this.tileSize);o.request=a.getImage(this.map._requestManager.transformRequest(w,a.ResourceType.Tile),function(S,E){if(delete o.request,o.aborted)o.state="unloaded",c(null);else if(S)o.state="errored",c(S);else if(E){v.map._refreshExpiredTiles&&o.setExpiryData(E),delete E.cacheControl,delete E.expires;var P=v.map.painter.context,O=P.gl;o.texture=v.map.painter.getTileTexture(E.width),o.texture?o.texture.update(E,{useMipmap:!0}):(o.texture=new a.Texture(P,E,O.RGBA,{useMipmap:!0}),o.texture.bind(O.LINEAR,O.CLAMP_TO_EDGE,O.LINEAR_MIPMAP_NEAREST),P.extTextureFilterAnisotropic&&O.texParameterf(O.TEXTURE_2D,P.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,P.extTextureFilterAnisotropicMax)),o.state="loaded",a.cacheEntryPossiblyAdded(v.dispatcher),c(null)}})},s.prototype.abortTile=function(o,c){o.request&&(o.request.cancel(),delete o.request),c()},s.prototype.unloadTile=function(o,c){o.texture&&this.map.painter.saveTileTexture(o.texture),c()},s.prototype.hasTransition=function(){return!1},s}(a.Evented),Bt=function(n){function s(o,c,v,w){n.call(this,o,c,v,w),this.type="raster-dem",this.maxzoom=22,this._options=a.extend({type:"raster-dem"},c),this.encoding=c.encoding||"mapbox"}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype.serialize=function(){return{type:"raster-dem",url:this.url,tileSize:this.tileSize,tiles:this.tiles,bounds:this.bounds,encoding:this.encoding}},s.prototype.loadTile=function(o,c){var v=this.map._requestManager.normalizeTileURL(o.tileID.canonical.url(this.tiles,this.scheme),this.tileSize);function w(S,E){S&&(o.state="errored",c(S)),E&&(o.dem=E,o.needsHillshadePrepare=!0,o.state="loaded",c(null))}o.request=a.getImage(this.map._requestManager.transformRequest(v,a.ResourceType.Tile),(function(S,E){if(delete o.request,o.aborted)o.state="unloaded",c(null);else if(S)o.state="errored",c(S);else if(E){this.map._refreshExpiredTiles&&o.setExpiryData(E),delete E.cacheControl,delete E.expires;var P=a.window.ImageBitmap&&E instanceof a.window.ImageBitmap&&a.offscreenCanvasSupported()?E:a.browser.getImageData(E,1),O={uid:o.uid,coord:o.tileID,source:this.id,rawImageData:P,encoding:this.encoding};o.actor&&o.state!=="expired"||(o.actor=this.dispatcher.getActor(),o.actor.send("loadDEMTile",O,w.bind(this)))}}).bind(this)),o.neighboringTiles=this._getNeighboringTiles(o.tileID)},s.prototype._getNeighboringTiles=function(o){var c=o.canonical,v=Math.pow(2,c.z),w=(c.x-1+v)%v,S=c.x===0?o.wrap-1:o.wrap,E=(c.x+1+v)%v,P=c.x+1===v?o.wrap+1:o.wrap,O={};return O[new a.OverscaledTileID(o.overscaledZ,S,c.z,w,c.y).key]={backfilled:!1},O[new a.OverscaledTileID(o.overscaledZ,P,c.z,E,c.y).key]={backfilled:!1},c.y>0&&(O[new a.OverscaledTileID(o.overscaledZ,S,c.z,w,c.y-1).key]={backfilled:!1},O[new a.OverscaledTileID(o.overscaledZ,o.wrap,c.z,c.x,c.y-1).key]={backfilled:!1},O[new a.OverscaledTileID(o.overscaledZ,P,c.z,E,c.y-1).key]={backfilled:!1}),c.y+1<v&&(O[new a.OverscaledTileID(o.overscaledZ,S,c.z,w,c.y+1).key]={backfilled:!1},O[new a.OverscaledTileID(o.overscaledZ,o.wrap,c.z,c.x,c.y+1).key]={backfilled:!1},O[new a.OverscaledTileID(o.overscaledZ,P,c.z,E,c.y+1).key]={backfilled:!1}),O},s.prototype.unloadTile=function(o){o.demTexture&&this.map.painter.saveTileTexture(o.demTexture),o.fbo&&(o.fbo.destroy(),delete o.fbo),o.dem&&delete o.dem,delete o.neighboringTiles,o.state="unloaded",o.actor&&o.actor.send("removeDEMTile",{uid:o.uid,source:this.id})},s}(qt),St=function(n){function s(o,c,v,w){n.call(this),this.id=o,this.type="geojson",this.minzoom=0,this.maxzoom=18,this.tileSize=512,this.isTileClipped=!0,this.reparseOverscaled=!0,this._removed=!1,this._loaded=!1,this.actor=v.getActor(),this.setEventedParent(w),this._data=c.data,this._options=a.extend({},c),this._collectResourceTiming=c.collectResourceTiming,this._resourceTiming=[],c.maxzoom!==void 0&&(this.maxzoom=c.maxzoom),c.type&&(this.type=c.type),c.attribution&&(this.attribution=c.attribution),this.promoteId=c.promoteId;var S=a.EXTENT/this.tileSize;this.workerOptions=a.extend({source:this.id,cluster:c.cluster||!1,geojsonVtOptions:{buffer:(c.buffer!==void 0?c.buffer:128)*S,tolerance:(c.tolerance!==void 0?c.tolerance:.375)*S,extent:a.EXTENT,maxZoom:this.maxzoom,lineMetrics:c.lineMetrics||!1,generateId:c.generateId||!1},superclusterOptions:{maxZoom:c.clusterMaxZoom!==void 0?Math.min(c.clusterMaxZoom,this.maxzoom-1):this.maxzoom-1,minPoints:Math.max(2,c.clusterMinPoints||2),extent:a.EXTENT,radius:(c.clusterRadius||50)*S,log:!1,generateId:c.generateId||!1},clusterProperties:c.clusterProperties,filter:c.filter},c.workerOptions)}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype.load=function(){var o=this;this.fire(new a.Event("dataloading",{dataType:"source"})),this._updateWorkerData(function(c){if(c)o.fire(new a.ErrorEvent(c));else{var v={dataType:"source",sourceDataType:"metadata"};o._collectResourceTiming&&o._resourceTiming&&o._resourceTiming.length>0&&(v.resourceTiming=o._resourceTiming,o._resourceTiming=[]),o.fire(new a.Event("data",v))}})},s.prototype.onAdd=function(o){this.map=o,this.load()},s.prototype.setData=function(o){var c=this;return this._data=o,this.fire(new a.Event("dataloading",{dataType:"source"})),this._updateWorkerData(function(v){if(v)c.fire(new a.ErrorEvent(v));else{var w={dataType:"source",sourceDataType:"content"};c._collectResourceTiming&&c._resourceTiming&&c._resourceTiming.length>0&&(w.resourceTiming=c._resourceTiming,c._resourceTiming=[]),c.fire(new a.Event("data",w))}}),this},s.prototype.getClusterExpansionZoom=function(o,c){return this.actor.send("geojson.getClusterExpansionZoom",{clusterId:o,source:this.id},c),this},s.prototype.getClusterChildren=function(o,c){return this.actor.send("geojson.getClusterChildren",{clusterId:o,source:this.id},c),this},s.prototype.getClusterLeaves=function(o,c,v,w){return this.actor.send("geojson.getClusterLeaves",{source:this.id,clusterId:o,limit:c,offset:v},w),this},s.prototype._updateWorkerData=function(o){var c=this;this._loaded=!1;var v=a.extend({},this.workerOptions),w=this._data;typeof w=="string"?(v.request=this.map._requestManager.transformRequest(a.browser.resolveURL(w),a.ResourceType.Source),v.request.collectResourceTiming=this._collectResourceTiming):v.data=JSON.stringify(w),this.actor.send(this.type+".loadData",v,function(S,E){c._removed||E&&E.abandoned||(c._loaded=!0,E&&E.resourceTiming&&E.resourceTiming[c.id]&&(c._resourceTiming=E.resourceTiming[c.id].slice(0)),c.actor.send(c.type+".coalesce",{source:v.source},null),o(S))})},s.prototype.loaded=function(){return this._loaded},s.prototype.loadTile=function(o,c){var v=this,w=o.actor?"reloadTile":"loadTile";o.actor=this.actor,o.request=this.actor.send(w,{type:this.type,uid:o.uid,tileID:o.tileID,zoom:o.tileID.overscaledZ,maxZoom:this.maxzoom,tileSize:this.tileSize,source:this.id,pixelRatio:a.browser.devicePixelRatio,showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId},function(S,E){return delete o.request,o.unloadVectorData(),o.aborted?c(null):S?c(S):(o.loadVectorData(E,v.map.painter,w==="reloadTile"),c(null))})},s.prototype.abortTile=function(o){o.request&&(o.request.cancel(),delete o.request),o.aborted=!0},s.prototype.unloadTile=function(o){o.unloadVectorData(),this.actor.send("removeTile",{uid:o.uid,type:this.type,source:this.id})},s.prototype.onRemove=function(){this._removed=!0,this.actor.send("removeSource",{type:this.type,source:this.id})},s.prototype.serialize=function(){return a.extend({},this._options,{type:this.type,data:this._data})},s.prototype.hasTransition=function(){return!1},s}(a.Evented),Oe=a.createLayout([{name:"a_pos",type:"Int16",components:2},{name:"a_texture_pos",type:"Int16",components:2}]),ot=function(n){function s(o,c,v,w){n.call(this),this.id=o,this.dispatcher=v,this.coordinates=c.coordinates,this.type="image",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this.tiles={},this._loaded=!1,this.setEventedParent(w),this.options=c}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype.load=function(o,c){var v=this;this._loaded=!1,this.fire(new a.Event("dataloading",{dataType:"source"})),this.url=this.options.url,a.getImage(this.map._requestManager.transformRequest(this.url,a.ResourceType.Image),function(w,S){v._loaded=!0,w?v.fire(new a.ErrorEvent(w)):S&&(v.image=S,o&&(v.coordinates=o),c&&c(),v._finishLoading())})},s.prototype.loaded=function(){return this._loaded},s.prototype.updateImage=function(o){var c=this;return this.image&&o.url?(this.options.url=o.url,this.load(o.coordinates,function(){c.texture=null}),this):this},s.prototype._finishLoading=function(){this.map&&(this.setCoordinates(this.coordinates),this.fire(new a.Event("data",{dataType:"source",sourceDataType:"metadata"})))},s.prototype.onAdd=function(o){this.map=o,this.load()},s.prototype.setCoordinates=function(o){var c=this;this.coordinates=o;var v=o.map(a.MercatorCoordinate.fromLngLat);this.tileID=function(S){for(var E=1/0,P=1/0,O=-1/0,G=-1/0,Z=0,H=S;Z<H.length;Z+=1){var te=H[Z];E=Math.min(E,te.x),P=Math.min(P,te.y),O=Math.max(O,te.x),G=Math.max(G,te.y)}var ee=Math.max(O-E,G-P),ce=Math.max(0,Math.floor(-Math.log(ee)/Math.LN2)),Y=Math.pow(2,ce);return new a.CanonicalTileID(ce,Math.floor((E+O)/2*Y),Math.floor((P+G)/2*Y))}(v),this.minzoom=this.maxzoom=this.tileID.z;var w=v.map(function(S){return c.tileID.getTilePoint(S)._round()});return this._boundsArray=new a.StructArrayLayout4i8,this._boundsArray.emplaceBack(w[0].x,w[0].y,0,0),this._boundsArray.emplaceBack(w[1].x,w[1].y,a.EXTENT,0),this._boundsArray.emplaceBack(w[3].x,w[3].y,0,a.EXTENT),this._boundsArray.emplaceBack(w[2].x,w[2].y,a.EXTENT,a.EXTENT),this.boundsBuffer&&(this.boundsBuffer.destroy(),delete this.boundsBuffer),this.fire(new a.Event("data",{dataType:"source",sourceDataType:"content"})),this},s.prototype.prepare=function(){if(Object.keys(this.tiles).length!==0&&this.image){var o=this.map.painter.context,c=o.gl;for(var v in this.boundsBuffer||(this.boundsBuffer=o.createVertexBuffer(this._boundsArray,Oe.members)),this.boundsSegments||(this.boundsSegments=a.SegmentVector.simpleSegment(0,0,4,2)),this.texture||(this.texture=new a.Texture(o,this.image,c.RGBA),this.texture.bind(c.LINEAR,c.CLAMP_TO_EDGE)),this.tiles){var w=this.tiles[v];w.state!=="loaded"&&(w.state="loaded",w.texture=this.texture)}}},s.prototype.loadTile=function(o,c){this.tileID&&this.tileID.equals(o.tileID.canonical)?(this.tiles[String(o.tileID.wrap)]=o,o.buckets={},c(null)):(o.state="errored",c(null))},s.prototype.serialize=function(){return{type:"image",url:this.options.url,coordinates:this.coordinates}},s.prototype.hasTransition=function(){return!1},s}(a.Evented),Dr=function(n){function s(o,c,v,w){n.call(this,o,c,v,w),this.roundZoom=!0,this.type="video",this.options=c}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype.load=function(){var o=this;this._loaded=!1;var c=this.options;this.urls=[];for(var v=0,w=c.urls;v<w.length;v+=1)this.urls.push(this.map._requestManager.transformRequest(w[v],a.ResourceType.Source).url);a.getVideo(this.urls,function(S,E){o._loaded=!0,S?o.fire(new a.ErrorEvent(S)):E&&(o.video=E,o.video.loop=!0,o.video.addEventListener("playing",function(){o.map.triggerRepaint()}),o.map&&o.video.play(),o._finishLoading())})},s.prototype.pause=function(){this.video&&this.video.pause()},s.prototype.play=function(){this.video&&this.video.play()},s.prototype.seek=function(o){if(this.video){var c=this.video.seekable;o<c.start(0)||o>c.end(0)?this.fire(new a.ErrorEvent(new a.ValidationError("sources."+this.id,null,"Playback for this video can be set only between the "+c.start(0)+" and "+c.end(0)+"-second mark."))):this.video.currentTime=o}},s.prototype.getVideo=function(){return this.video},s.prototype.onAdd=function(o){this.map||(this.map=o,this.load(),this.video&&(this.video.play(),this.setCoordinates(this.coordinates)))},s.prototype.prepare=function(){if(!(Object.keys(this.tiles).length===0||this.video.readyState<2)){var o=this.map.painter.context,c=o.gl;for(var v in this.boundsBuffer||(this.boundsBuffer=o.createVertexBuffer(this._boundsArray,Oe.members)),this.boundsSegments||(this.boundsSegments=a.SegmentVector.simpleSegment(0,0,4,2)),this.texture?this.video.paused||(this.texture.bind(c.LINEAR,c.CLAMP_TO_EDGE),c.texSubImage2D(c.TEXTURE_2D,0,0,0,c.RGBA,c.UNSIGNED_BYTE,this.video)):(this.texture=new a.Texture(o,this.video,c.RGBA),this.texture.bind(c.LINEAR,c.CLAMP_TO_EDGE)),this.tiles){var w=this.tiles[v];w.state!=="loaded"&&(w.state="loaded",w.texture=this.texture)}}},s.prototype.serialize=function(){return{type:"video",urls:this.urls,coordinates:this.coordinates}},s.prototype.hasTransition=function(){return this.video&&!this.video.paused},s}(ot),Kr=function(n){function s(o,c,v,w){n.call(this,o,c,v,w),c.coordinates?Array.isArray(c.coordinates)&&c.coordinates.length===4&&!c.coordinates.some(function(S){return!Array.isArray(S)||S.length!==2||S.some(function(E){return typeof E!="number"})})||this.fire(new a.ErrorEvent(new a.ValidationError("sources."+o,null,'"coordinates" property must be an array of 4 longitude/latitude array pairs'))):this.fire(new a.ErrorEvent(new a.ValidationError("sources."+o,null,'missing required property "coordinates"'))),c.animate&&typeof c.animate!="boolean"&&this.fire(new a.ErrorEvent(new a.ValidationError("sources."+o,null,'optional "animate" property must be a boolean value'))),c.canvas?typeof c.canvas=="string"||c.canvas instanceof a.window.HTMLCanvasElement||this.fire(new a.ErrorEvent(new a.ValidationError("sources."+o,null,'"canvas" must be either a string representing the ID of the canvas element from which to read, or an HTMLCanvasElement instance'))):this.fire(new a.ErrorEvent(new a.ValidationError("sources."+o,null,'missing required property "canvas"'))),this.options=c,this.animate=c.animate===void 0||c.animate}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype.load=function(){this._loaded=!0,this.canvas||(this.canvas=this.options.canvas instanceof a.window.HTMLCanvasElement?this.options.canvas:a.window.document.getElementById(this.options.canvas)),this.width=this.canvas.width,this.height=this.canvas.height,this._hasInvalidDimensions()?this.fire(new a.ErrorEvent(new Error("Canvas dimensions cannot be less than or equal to zero."))):(this.play=function(){this._playing=!0,this.map.triggerRepaint()},this.pause=function(){this._playing&&(this.prepare(),this._playing=!1)},this._finishLoading())},s.prototype.getCanvas=function(){return this.canvas},s.prototype.onAdd=function(o){this.map=o,this.load(),this.canvas&&this.animate&&this.play()},s.prototype.onRemove=function(){this.pause()},s.prototype.prepare=function(){var o=!1;if(this.canvas.width!==this.width&&(this.width=this.canvas.width,o=!0),this.canvas.height!==this.height&&(this.height=this.canvas.height,o=!0),!this._hasInvalidDimensions()&&Object.keys(this.tiles).length!==0){var c=this.map.painter.context,v=c.gl;for(var w in this.boundsBuffer||(this.boundsBuffer=c.createVertexBuffer(this._boundsArray,Oe.members)),this.boundsSegments||(this.boundsSegments=a.SegmentVector.simpleSegment(0,0,4,2)),this.texture?(o||this._playing)&&this.texture.update(this.canvas,{premultiply:!0}):this.texture=new a.Texture(c,this.canvas,v.RGBA,{premultiply:!0}),this.tiles){var S=this.tiles[w];S.state!=="loaded"&&(S.state="loaded",S.texture=this.texture)}}},s.prototype.serialize=function(){return{type:"canvas",coordinates:this.coordinates}},s.prototype.hasTransition=function(){return this._playing},s.prototype._hasInvalidDimensions=function(){for(var o=0,c=[this.canvas.width,this.canvas.height];o<c.length;o+=1){var v=c[o];if(isNaN(v)||v<=0)return!0}return!1},s}(ot),vi={vector:mt,raster:qt,"raster-dem":Bt,geojson:St,video:Dr,image:ot,canvas:Kr};function xr(n,s){var o=a.identity([]);return a.translate(o,o,[1,1,0]),a.scale(o,o,[.5*n.width,.5*n.height,1]),a.multiply(o,o,n.calculatePosMatrix(s.toUnwrapped()))}function er(n,s,o,c,v,w){var S=function(ce,Y,le){if(ce)for(var de=0,_e=ce;de<_e.length;de+=1){var Ie=Y[_e[de]];if(Ie&&Ie.source===le&&Ie.type==="fill-extrusion")return!0}else for(var Se in Y){var ze=Y[Se];if(ze.source===le&&ze.type==="fill-extrusion")return!0}return!1}(v&&v.layers,s,n.id),E=w.maxPitchScaleFactor(),P=n.tilesIn(c,E,S);P.sort(Hr);for(var O=[],G=0,Z=P;G<Z.length;G+=1){var H=Z[G];O.push({wrappedTileID:H.tileID.wrapped().key,queryResults:H.tile.queryRenderedFeatures(s,o,n._state,H.queryGeometry,H.cameraQueryGeometry,H.scale,v,w,E,xr(n.transform,H.tileID))})}var te=function(ce){for(var Y={},le={},de=0,_e=ce;de<_e.length;de+=1){var Ie=_e[de],Se=Ie.queryResults,ze=Ie.wrappedTileID,Fe=le[ze]=le[ze]||{};for(var Ye in Se)for(var Xe=Se[Ye],pt=Fe[Ye]=Fe[Ye]||{},Et=Y[Ye]=Y[Ye]||[],Pt=0,At=Xe;Pt<At.length;Pt+=1){var _r=At[Pt];pt[_r.featureIndex]||(pt[_r.featureIndex]=!0,Et.push(_r))}}return Y}(O);for(var ee in te)te[ee].forEach(function(ce){var Y=ce.feature,le=n.getFeatureState(Y.layer["source-layer"],Y.id);Y.source=Y.layer.source,Y.layer["source-layer"]&&(Y.sourceLayer=Y.layer["source-layer"]),Y.state=le});return te}function Hr(n,s){var o=n.tileID,c=s.tileID;return o.overscaledZ-c.overscaledZ||o.canonical.y-c.canonical.y||o.wrap-c.wrap||o.canonical.x-c.canonical.x}var Jt=function(n,s){this.max=n,this.onRemove=s,this.reset()};Jt.prototype.reset=function(){for(var n in this.data)for(var s=0,o=this.data[n];s<o.length;s+=1){var c=o[s];c.timeout&&clearTimeout(c.timeout),this.onRemove(c.value)}return this.data={},this.order=[],this},Jt.prototype.add=function(n,s,o){var c=this,v=n.wrapped().key;this.data[v]===void 0&&(this.data[v]=[]);var w={value:s,timeout:void 0};if(o!==void 0&&(w.timeout=setTimeout(function(){c.remove(n,w)},o)),this.data[v].push(w),this.order.push(v),this.order.length>this.max){var S=this._getAndRemoveByKey(this.order[0]);S&&this.onRemove(S)}return this},Jt.prototype.has=function(n){return n.wrapped().key in this.data},Jt.prototype.getAndRemove=function(n){return this.has(n)?this._getAndRemoveByKey(n.wrapped().key):null},Jt.prototype._getAndRemoveByKey=function(n){var s=this.data[n].shift();return s.timeout&&clearTimeout(s.timeout),this.data[n].length===0&&delete this.data[n],this.order.splice(this.order.indexOf(n),1),s.value},Jt.prototype.getByKey=function(n){var s=this.data[n];return s?s[0].value:null},Jt.prototype.get=function(n){return this.has(n)?this.data[n.wrapped().key][0].value:null},Jt.prototype.remove=function(n,s){if(!this.has(n))return this;var o=n.wrapped().key,c=s===void 0?0:this.data[o].indexOf(s),v=this.data[o][c];return this.data[o].splice(c,1),v.timeout&&clearTimeout(v.timeout),this.data[o].length===0&&delete this.data[o],this.onRemove(v.value),this.order.splice(this.order.indexOf(o),1),this},Jt.prototype.setMaxSize=function(n){for(this.max=n;this.order.length>this.max;){var s=this._getAndRemoveByKey(this.order[0]);s&&this.onRemove(s)}return this},Jt.prototype.filter=function(n){var s=[];for(var o in this.data)for(var c=0,v=this.data[o];c<v.length;c+=1){var w=v[c];n(w.value)||s.push(w)}for(var S=0,E=s;S<E.length;S+=1){var P=E[S];this.remove(P.value.tileID,P)}};var ai=function(n,s,o){this.context=n;var c=n.gl;this.buffer=c.createBuffer(),this.dynamicDraw=!!o,this.context.unbindVAO(),n.bindElementBuffer.set(this.buffer),c.bufferData(c.ELEMENT_ARRAY_BUFFER,s.arrayBuffer,this.dynamicDraw?c.DYNAMIC_DRAW:c.STATIC_DRAW),this.dynamicDraw||delete s.arrayBuffer};ai.prototype.bind=function(){this.context.bindElementBuffer.set(this.buffer)},ai.prototype.updateData=function(n){var s=this.context.gl;this.context.unbindVAO(),this.bind(),s.bufferSubData(s.ELEMENT_ARRAY_BUFFER,0,n.arrayBuffer)},ai.prototype.destroy=function(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)};var qi={Int8:"BYTE",Uint8:"UNSIGNED_BYTE",Int16:"SHORT",Uint16:"UNSIGNED_SHORT",Int32:"INT",Uint32:"UNSIGNED_INT",Float32:"FLOAT"},en=function(n,s,o,c){this.length=s.length,this.attributes=o,this.itemSize=s.bytesPerElement,this.dynamicDraw=c,this.context=n;var v=n.gl;this.buffer=v.createBuffer(),n.bindVertexBuffer.set(this.buffer),v.bufferData(v.ARRAY_BUFFER,s.arrayBuffer,this.dynamicDraw?v.DYNAMIC_DRAW:v.STATIC_DRAW),this.dynamicDraw||delete s.arrayBuffer};en.prototype.bind=function(){this.context.bindVertexBuffer.set(this.buffer)},en.prototype.updateData=function(n){var s=this.context.gl;this.bind(),s.bufferSubData(s.ARRAY_BUFFER,0,n.arrayBuffer)},en.prototype.enableAttributes=function(n,s){for(var o=0;o<this.attributes.length;o++){var c=s.attributes[this.attributes[o].name];c!==void 0&&n.enableVertexAttribArray(c)}},en.prototype.setVertexAttribPointers=function(n,s,o){for(var c=0;c<this.attributes.length;c++){var v=this.attributes[c],w=s.attributes[v.name];w!==void 0&&n.vertexAttribPointer(w,v.components,n[qi[v.type]],!1,this.itemSize,v.offset+this.itemSize*(o||0))}},en.prototype.destroy=function(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)};var Kt=function(n){this.gl=n.gl,this.default=this.getDefault(),this.current=this.default,this.dirty=!1};Kt.prototype.get=function(){return this.current},Kt.prototype.set=function(n){},Kt.prototype.getDefault=function(){return this.default},Kt.prototype.setDefault=function(){this.set(this.default)};var ji=function(n){function s(){n.apply(this,arguments)}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype.getDefault=function(){return a.Color.transparent},s.prototype.set=function(o){var c=this.current;(o.r!==c.r||o.g!==c.g||o.b!==c.b||o.a!==c.a||this.dirty)&&(this.gl.clearColor(o.r,o.g,o.b,o.a),this.current=o,this.dirty=!1)},s}(Kt),fi=function(n){function s(){n.apply(this,arguments)}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype.getDefault=function(){return 1},s.prototype.set=function(o){(o!==this.current||this.dirty)&&(this.gl.clearDepth(o),this.current=o,this.dirty=!1)},s}(Kt),$r=function(n){function s(){n.apply(this,arguments)}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype.getDefault=function(){return 0},s.prototype.set=function(o){(o!==this.current||this.dirty)&&(this.gl.clearStencil(o),this.current=o,this.dirty=!1)},s}(Kt),Xn=function(n){function s(){n.apply(this,arguments)}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype.getDefault=function(){return[!0,!0,!0,!0]},s.prototype.set=function(o){var c=this.current;(o[0]!==c[0]||o[1]!==c[1]||o[2]!==c[2]||o[3]!==c[3]||this.dirty)&&(this.gl.colorMask(o[0],o[1],o[2],o[3]),this.current=o,this.dirty=!1)},s}(Kt),Ei=function(n){function s(){n.apply(this,arguments)}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype.getDefault=function(){return!0},s.prototype.set=function(o){(o!==this.current||this.dirty)&&(this.gl.depthMask(o),this.current=o,this.dirty=!1)},s}(Kt),Lr=function(n){function s(){n.apply(this,arguments)}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype.getDefault=function(){return 255},s.prototype.set=function(o){(o!==this.current||this.dirty)&&(this.gl.stencilMask(o),this.current=o,this.dirty=!1)},s}(Kt),Ur=function(n){function s(){n.apply(this,arguments)}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype.getDefault=function(){return{func:this.gl.ALWAYS,ref:0,mask:255}},s.prototype.set=function(o){var c=this.current;(o.func!==c.func||o.ref!==c.ref||o.mask!==c.mask||this.dirty)&&(this.gl.stencilFunc(o.func,o.ref,o.mask),this.current=o,this.dirty=!1)},s}(Kt),tn=function(n){function s(){n.apply(this,arguments)}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype.getDefault=function(){var o=this.gl;return[o.KEEP,o.KEEP,o.KEEP]},s.prototype.set=function(o){var c=this.current;(o[0]!==c[0]||o[1]!==c[1]||o[2]!==c[2]||this.dirty)&&(this.gl.stencilOp(o[0],o[1],o[2]),this.current=o,this.dirty=!1)},s}(Kt),bi=function(n){function s(){n.apply(this,arguments)}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype.getDefault=function(){return!1},s.prototype.set=function(o){if(o!==this.current||this.dirty){var c=this.gl;o?c.enable(c.STENCIL_TEST):c.disable(c.STENCIL_TEST),this.current=o,this.dirty=!1}},s}(Kt),di=function(n){function s(){n.apply(this,arguments)}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype.getDefault=function(){return[0,1]},s.prototype.set=function(o){var c=this.current;(o[0]!==c[0]||o[1]!==c[1]||this.dirty)&&(this.gl.depthRange(o[0],o[1]),this.current=o,this.dirty=!1)},s}(Kt),qr=function(n){function s(){n.apply(this,arguments)}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype.getDefault=function(){return!1},s.prototype.set=function(o){if(o!==this.current||this.dirty){var c=this.gl;o?c.enable(c.DEPTH_TEST):c.disable(c.DEPTH_TEST),this.current=o,this.dirty=!1}},s}(Kt),rn=function(n){function s(){n.apply(this,arguments)}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype.getDefault=function(){return this.gl.LESS},s.prototype.set=function(o){(o!==this.current||this.dirty)&&(this.gl.depthFunc(o),this.current=o,this.dirty=!1)},s}(Kt),Xr=function(n){function s(){n.apply(this,arguments)}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype.getDefault=function(){return!1},s.prototype.set=function(o){if(o!==this.current||this.dirty){var c=this.gl;o?c.enable(c.BLEND):c.disable(c.BLEND),this.current=o,this.dirty=!1}},s}(Kt),In=function(n){function s(){n.apply(this,arguments)}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype.getDefault=function(){var o=this.gl;return[o.ONE,o.ZERO]},s.prototype.set=function(o){var c=this.current;(o[0]!==c[0]||o[1]!==c[1]||this.dirty)&&(this.gl.blendFunc(o[0],o[1]),this.current=o,this.dirty=!1)},s}(Kt),nn=function(n){function s(){n.apply(this,arguments)}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype.getDefault=function(){return a.Color.transparent},s.prototype.set=function(o){var c=this.current;(o.r!==c.r||o.g!==c.g||o.b!==c.b||o.a!==c.a||this.dirty)&&(this.gl.blendColor(o.r,o.g,o.b,o.a),this.current=o,this.dirty=!1)},s}(Kt),Dn=function(n){function s(){n.apply(this,arguments)}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype.getDefault=function(){return this.gl.FUNC_ADD},s.prototype.set=function(o){(o!==this.current||this.dirty)&&(this.gl.blendEquation(o),this.current=o,this.dirty=!1)},s}(Kt),Gi=function(n){function s(){n.apply(this,arguments)}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype.getDefault=function(){return!1},s.prototype.set=function(o){if(o!==this.current||this.dirty){var c=this.gl;o?c.enable(c.CULL_FACE):c.disable(c.CULL_FACE),this.current=o,this.dirty=!1}},s}(Kt),Bi=function(n){function s(){n.apply(this,arguments)}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype.getDefault=function(){return this.gl.BACK},s.prototype.set=function(o){(o!==this.current||this.dirty)&&(this.gl.cullFace(o),this.current=o,this.dirty=!1)},s}(Kt),ei=function(n){function s(){n.apply(this,arguments)}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype.getDefault=function(){return this.gl.CCW},s.prototype.set=function(o){(o!==this.current||this.dirty)&&(this.gl.frontFace(o),this.current=o,this.dirty=!1)},s}(Kt),Ln=function(n){function s(){n.apply(this,arguments)}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype.getDefault=function(){return null},s.prototype.set=function(o){(o!==this.current||this.dirty)&&(this.gl.useProgram(o),this.current=o,this.dirty=!1)},s}(Kt),An=function(n){function s(){n.apply(this,arguments)}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype.getDefault=function(){return this.gl.TEXTURE0},s.prototype.set=function(o){(o!==this.current||this.dirty)&&(this.gl.activeTexture(o),this.current=o,this.dirty=!1)},s}(Kt),oi=function(n){function s(){n.apply(this,arguments)}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype.getDefault=function(){var o=this.gl;return[0,0,o.drawingBufferWidth,o.drawingBufferHeight]},s.prototype.set=function(o){var c=this.current;(o[0]!==c[0]||o[1]!==c[1]||o[2]!==c[2]||o[3]!==c[3]||this.dirty)&&(this.gl.viewport(o[0],o[1],o[2],o[3]),this.current=o,this.dirty=!1)},s}(Kt),ta=function(n){function s(){n.apply(this,arguments)}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype.getDefault=function(){return null},s.prototype.set=function(o){if(o!==this.current||this.dirty){var c=this.gl;c.bindFramebuffer(c.FRAMEBUFFER,o),this.current=o,this.dirty=!1}},s}(Kt),Wn=function(n){function s(){n.apply(this,arguments)}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype.getDefault=function(){return null},s.prototype.set=function(o){if(o!==this.current||this.dirty){var c=this.gl;c.bindRenderbuffer(c.RENDERBUFFER,o),this.current=o,this.dirty=!1}},s}(Kt),ti=function(n){function s(){n.apply(this,arguments)}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype.getDefault=function(){return null},s.prototype.set=function(o){if(o!==this.current||this.dirty){var c=this.gl;c.bindTexture(c.TEXTURE_2D,o),this.current=o,this.dirty=!1}},s}(Kt),ra=function(n){function s(){n.apply(this,arguments)}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype.getDefault=function(){return null},s.prototype.set=function(o){if(o!==this.current||this.dirty){var c=this.gl;c.bindBuffer(c.ARRAY_BUFFER,o),this.current=o,this.dirty=!1}},s}(Kt),un=function(n){function s(){n.apply(this,arguments)}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype.getDefault=function(){return null},s.prototype.set=function(o){var c=this.gl;c.bindBuffer(c.ELEMENT_ARRAY_BUFFER,o),this.current=o,this.dirty=!1},s}(Kt),ri=function(n){function s(o){n.call(this,o),this.vao=o.extVertexArrayObject}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype.getDefault=function(){return null},s.prototype.set=function(o){this.vao&&(o!==this.current||this.dirty)&&(this.vao.bindVertexArrayOES(o),this.current=o,this.dirty=!1)},s}(Kt),re=function(n){function s(){n.apply(this,arguments)}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype.getDefault=function(){return 4},s.prototype.set=function(o){if(o!==this.current||this.dirty){var c=this.gl;c.pixelStorei(c.UNPACK_ALIGNMENT,o),this.current=o,this.dirty=!1}},s}(Kt),yt=function(n){function s(){n.apply(this,arguments)}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype.getDefault=function(){return!1},s.prototype.set=function(o){if(o!==this.current||this.dirty){var c=this.gl;c.pixelStorei(c.UNPACK_PREMULTIPLY_ALPHA_WEBGL,o),this.current=o,this.dirty=!1}},s}(Kt),Ti=function(n){function s(){n.apply(this,arguments)}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype.getDefault=function(){return!1},s.prototype.set=function(o){if(o!==this.current||this.dirty){var c=this.gl;c.pixelStorei(c.UNPACK_FLIP_Y_WEBGL,o),this.current=o,this.dirty=!1}},s}(Kt),pr=function(n){function s(o,c){n.call(this,o),this.context=o,this.parent=c}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype.getDefault=function(){return null},s}(Kt),R=function(n){function s(){n.apply(this,arguments)}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype.setDirty=function(){this.dirty=!0},s.prototype.set=function(o){if(o!==this.current||this.dirty){this.context.bindFramebuffer.set(this.parent);var c=this.gl;c.framebufferTexture2D(c.FRAMEBUFFER,c.COLOR_ATTACHMENT0,c.TEXTURE_2D,o,0),this.current=o,this.dirty=!1}},s}(pr),N=function(n){function s(){n.apply(this,arguments)}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype.set=function(o){if(o!==this.current||this.dirty){this.context.bindFramebuffer.set(this.parent);var c=this.gl;c.framebufferRenderbuffer(c.FRAMEBUFFER,c.DEPTH_ATTACHMENT,c.RENDERBUFFER,o),this.current=o,this.dirty=!1}},s}(pr),q=function(n,s,o,c){this.context=n,this.width=s,this.height=o;var v=this.framebuffer=n.gl.createFramebuffer();this.colorAttachment=new R(n,v),c&&(this.depthAttachment=new N(n,v))};q.prototype.destroy=function(){var n=this.context.gl,s=this.colorAttachment.get();if(s&&n.deleteTexture(s),this.depthAttachment){var o=this.depthAttachment.get();o&&n.deleteRenderbuffer(o)}n.deleteFramebuffer(this.framebuffer)};var K=function(n,s,o){this.func=n,this.mask=s,this.range=o};K.ReadOnly=!1,K.ReadWrite=!0,K.disabled=new K(519,K.ReadOnly,[0,1]);var W=function(n,s,o,c,v,w){this.test=n,this.ref=s,this.mask=o,this.fail=c,this.depthFail=v,this.pass=w};W.disabled=new W({func:519,mask:0},0,0,7680,7680,7680);var ue=function(n,s,o){this.blendFunction=n,this.blendColor=s,this.mask=o};ue.disabled=new ue(ue.Replace=[1,0],a.Color.transparent,[!1,!1,!1,!1]),ue.unblended=new ue(ue.Replace,a.Color.transparent,[!0,!0,!0,!0]),ue.alphaBlended=new ue([1,771],a.Color.transparent,[!0,!0,!0,!0]);var fe=function(n,s,o){this.enable=n,this.mode=s,this.frontFace=o};fe.disabled=new fe(!1,1029,2305),fe.backCCW=new fe(!0,1029,2305);var U=function(n){this.gl=n,this.extVertexArrayObject=this.gl.getExtension("OES_vertex_array_object"),this.clearColor=new ji(this),this.clearDepth=new fi(this),this.clearStencil=new $r(this),this.colorMask=new Xn(this),this.depthMask=new Ei(this),this.stencilMask=new Lr(this),this.stencilFunc=new Ur(this),this.stencilOp=new tn(this),this.stencilTest=new bi(this),this.depthRange=new di(this),this.depthTest=new qr(this),this.depthFunc=new rn(this),this.blend=new Xr(this),this.blendFunc=new In(this),this.blendColor=new nn(this),this.blendEquation=new Dn(this),this.cullFace=new Gi(this),this.cullFaceSide=new Bi(this),this.frontFace=new ei(this),this.program=new Ln(this),this.activeTexture=new An(this),this.viewport=new oi(this),this.bindFramebuffer=new ta(this),this.bindRenderbuffer=new Wn(this),this.bindTexture=new ti(this),this.bindVertexBuffer=new ra(this),this.bindElementBuffer=new un(this),this.bindVertexArrayOES=this.extVertexArrayObject&&new ri(this),this.pixelStoreUnpack=new re(this),this.pixelStoreUnpackPremultiplyAlpha=new yt(this),this.pixelStoreUnpackFlipY=new Ti(this),this.extTextureFilterAnisotropic=n.getExtension("EXT_texture_filter_anisotropic")||n.getExtension("MOZ_EXT_texture_filter_anisotropic")||n.getExtension("WEBKIT_EXT_texture_filter_anisotropic"),this.extTextureFilterAnisotropic&&(this.extTextureFilterAnisotropicMax=n.getParameter(this.extTextureFilterAnisotropic.MAX_TEXTURE_MAX_ANISOTROPY_EXT)),this.extTextureHalfFloat=n.getExtension("OES_texture_half_float"),this.extTextureHalfFloat&&(n.getExtension("OES_texture_half_float_linear"),this.extRenderToTextureHalfFloat=n.getExtension("EXT_color_buffer_half_float")),this.extTimerQuery=n.getExtension("EXT_disjoint_timer_query"),this.maxTextureSize=n.getParameter(n.MAX_TEXTURE_SIZE)};U.prototype.setDefault=function(){this.unbindVAO(),this.clearColor.setDefault(),this.clearDepth.setDefault(),this.clearStencil.setDefault(),this.colorMask.setDefault(),this.depthMask.setDefault(),this.stencilMask.setDefault(),this.stencilFunc.setDefault(),this.stencilOp.setDefault(),this.stencilTest.setDefault(),this.depthRange.setDefault(),this.depthTest.setDefault(),this.depthFunc.setDefault(),this.blend.setDefault(),this.blendFunc.setDefault(),this.blendColor.setDefault(),this.blendEquation.setDefault(),this.cullFace.setDefault(),this.cullFaceSide.setDefault(),this.frontFace.setDefault(),this.program.setDefault(),this.activeTexture.setDefault(),this.bindFramebuffer.setDefault(),this.pixelStoreUnpack.setDefault(),this.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.pixelStoreUnpackFlipY.setDefault()},U.prototype.setDirty=function(){this.clearColor.dirty=!0,this.clearDepth.dirty=!0,this.clearStencil.dirty=!0,this.colorMask.dirty=!0,this.depthMask.dirty=!0,this.stencilMask.dirty=!0,this.stencilFunc.dirty=!0,this.stencilOp.dirty=!0,this.stencilTest.dirty=!0,this.depthRange.dirty=!0,this.depthTest.dirty=!0,this.depthFunc.dirty=!0,this.blend.dirty=!0,this.blendFunc.dirty=!0,this.blendColor.dirty=!0,this.blendEquation.dirty=!0,this.cullFace.dirty=!0,this.cullFaceSide.dirty=!0,this.frontFace.dirty=!0,this.program.dirty=!0,this.activeTexture.dirty=!0,this.viewport.dirty=!0,this.bindFramebuffer.dirty=!0,this.bindRenderbuffer.dirty=!0,this.bindTexture.dirty=!0,this.bindVertexBuffer.dirty=!0,this.bindElementBuffer.dirty=!0,this.extVertexArrayObject&&(this.bindVertexArrayOES.dirty=!0),this.pixelStoreUnpack.dirty=!0,this.pixelStoreUnpackPremultiplyAlpha.dirty=!0,this.pixelStoreUnpackFlipY.dirty=!0},U.prototype.createIndexBuffer=function(n,s){return new ai(this,n,s)},U.prototype.createVertexBuffer=function(n,s,o){return new en(this,n,s,o)},U.prototype.createRenderbuffer=function(n,s,o){var c=this.gl,v=c.createRenderbuffer();return this.bindRenderbuffer.set(v),c.renderbufferStorage(c.RENDERBUFFER,n,s,o),this.bindRenderbuffer.set(null),v},U.prototype.createFramebuffer=function(n,s,o){return new q(this,n,s,o)},U.prototype.clear=function(n){var s=n.color,o=n.depth,c=this.gl,v=0;s&&(v|=c.COLOR_BUFFER_BIT,this.clearColor.set(s),this.colorMask.set([!0,!0,!0,!0])),o!==void 0&&(v|=c.DEPTH_BUFFER_BIT,this.depthRange.set([0,1]),this.clearDepth.set(o),this.depthMask.set(!0)),c.clear(v)},U.prototype.setCullFace=function(n){n.enable===!1?this.cullFace.set(!1):(this.cullFace.set(!0),this.cullFaceSide.set(n.mode),this.frontFace.set(n.frontFace))},U.prototype.setDepthMode=function(n){n.func!==this.gl.ALWAYS||n.mask?(this.depthTest.set(!0),this.depthFunc.set(n.func),this.depthMask.set(n.mask),this.depthRange.set(n.range)):this.depthTest.set(!1)},U.prototype.setStencilMode=function(n){n.test.func!==this.gl.ALWAYS||n.mask?(this.stencilTest.set(!0),this.stencilMask.set(n.mask),this.stencilOp.set([n.fail,n.depthFail,n.pass]),this.stencilFunc.set({func:n.test.func,ref:n.ref,mask:n.test.mask})):this.stencilTest.set(!1)},U.prototype.setColorMode=function(n){a.deepEqual(n.blendFunction,ue.Replace)?this.blend.set(!1):(this.blend.set(!0),this.blendFunc.set(n.blendFunction),this.blendColor.set(n.blendColor)),this.colorMask.set(n.mask)},U.prototype.unbindVAO=function(){this.extVertexArrayObject&&this.bindVertexArrayOES.set(null)};var Q=function(n){function s(o,c,v){var w=this;n.call(this),this.id=o,this.dispatcher=v,this.on("data",function(S){S.dataType==="source"&&S.sourceDataType==="metadata"&&(w._sourceLoaded=!0),w._sourceLoaded&&!w._paused&&S.dataType==="source"&&S.sourceDataType==="content"&&(w.reload(),w.transform&&w.update(w.transform))}),this.on("error",function(){w._sourceErrored=!0}),this._source=function(S,E,P,O){var G=new vi[E.type](S,E,P,O);if(G.id!==S)throw new Error("Expected Source id to be "+S+" instead of "+G.id);return a.bindAll(["load","abort","unload","serialize","prepare"],G),G}(o,c,v,this),this._tiles={},this._cache=new Jt(0,this._unloadTile.bind(this)),this._timers={},this._cacheTimers={},this._maxTileCacheSize=null,this._loadedParentTiles={},this._coveredTiles={},this._state=new a.SourceFeatureState}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype.onAdd=function(o){this.map=o,this._maxTileCacheSize=o?o._maxTileCacheSize:null,this._source&&this._source.onAdd&&this._source.onAdd(o)},s.prototype.onRemove=function(o){this._source&&this._source.onRemove&&this._source.onRemove(o)},s.prototype.loaded=function(){if(this._sourceErrored)return!0;if(!this._sourceLoaded||!this._source.loaded())return!1;for(var o in this._tiles){var c=this._tiles[o];if(c.state!=="loaded"&&c.state!=="errored")return!1}return!0},s.prototype.getSource=function(){return this._source},s.prototype.pause=function(){this._paused=!0},s.prototype.resume=function(){if(this._paused){var o=this._shouldReloadOnResume;this._paused=!1,this._shouldReloadOnResume=!1,o&&this.reload(),this.transform&&this.update(this.transform)}},s.prototype._loadTile=function(o,c){return this._source.loadTile(o,c)},s.prototype._unloadTile=function(o){if(this._source.unloadTile)return this._source.unloadTile(o,function(){})},s.prototype._abortTile=function(o){if(this._source.abortTile)return this._source.abortTile(o,function(){})},s.prototype.serialize=function(){return this._source.serialize()},s.prototype.prepare=function(o){for(var c in this._source.prepare&&this._source.prepare(),this._state.coalesceChanges(this._tiles,this.map?this.map.painter:null),this._tiles){var v=this._tiles[c];v.upload(o),v.prepare(this.map.style.imageManager)}},s.prototype.getIds=function(){return a.values(this._tiles).map(function(o){return o.tileID}).sort(ge).map(function(o){return o.key})},s.prototype.getRenderableIds=function(o){var c=this,v=[];for(var w in this._tiles)this._isIdRenderable(w,o)&&v.push(this._tiles[w]);return o?v.sort(function(S,E){var P=S.tileID,O=E.tileID,G=new a.Point(P.canonical.x,P.canonical.y)._rotate(c.transform.angle),Z=new a.Point(O.canonical.x,O.canonical.y)._rotate(c.transform.angle);return P.overscaledZ-O.overscaledZ||Z.y-G.y||Z.x-G.x}).map(function(S){return S.tileID.key}):v.map(function(S){return S.tileID}).sort(ge).map(function(S){return S.key})},s.prototype.hasRenderableParent=function(o){var c=this.findLoadedParent(o,0);return!!c&&this._isIdRenderable(c.tileID.key)},s.prototype._isIdRenderable=function(o,c){return this._tiles[o]&&this._tiles[o].hasData()&&!this._coveredTiles[o]&&(c||!this._tiles[o].holdingForFade())},s.prototype.reload=function(){if(this._paused)this._shouldReloadOnResume=!0;else for(var o in this._cache.reset(),this._tiles)this._tiles[o].state!=="errored"&&this._reloadTile(o,"reloading")},s.prototype._reloadTile=function(o,c){var v=this._tiles[o];v&&(v.state!=="loading"&&(v.state=c),this._loadTile(v,this._tileLoaded.bind(this,v,o,c)))},s.prototype._tileLoaded=function(o,c,v,w){if(w)return o.state="errored",void(w.status!==404?this._source.fire(new a.ErrorEvent(w,{tile:o})):this.update(this.transform));o.timeAdded=a.browser.now(),v==="expired"&&(o.refreshedUponExpiration=!0),this._setTileReloadTimer(c,o),this.getSource().type==="raster-dem"&&o.dem&&this._backfillDEM(o),this._state.initializeTileState(o,this.map?this.map.painter:null),this._source.fire(new a.Event("data",{dataType:"source",tile:o,coord:o.tileID}))},s.prototype._backfillDEM=function(o){for(var c=this.getRenderableIds(),v=0;v<c.length;v++){var w=c[v];if(o.neighboringTiles&&o.neighboringTiles[w]){var S=this.getTileByID(w);E(o,S),E(S,o)}}function E(P,O){P.needsHillshadePrepare=!0;var G=O.tileID.canonical.x-P.tileID.canonical.x,Z=O.tileID.canonical.y-P.tileID.canonical.y,H=Math.pow(2,P.tileID.canonical.z),te=O.tileID.key;G===0&&Z===0||Math.abs(Z)>1||(Math.abs(G)>1&&(Math.abs(G+H)===1?G+=H:Math.abs(G-H)===1&&(G-=H)),O.dem&&P.dem&&(P.dem.backfillBorder(O.dem,G,Z),P.neighboringTiles&&P.neighboringTiles[te]&&(P.neighboringTiles[te].backfilled=!0)))}},s.prototype.getTile=function(o){return this.getTileByID(o.key)},s.prototype.getTileByID=function(o){return this._tiles[o]},s.prototype._retainLoadedChildren=function(o,c,v,w){for(var S in this._tiles){var E=this._tiles[S];if(!(w[S]||!E.hasData()||E.tileID.overscaledZ<=c||E.tileID.overscaledZ>v)){for(var P=E.tileID;E&&E.tileID.overscaledZ>c+1;){var O=E.tileID.scaledTo(E.tileID.overscaledZ-1);(E=this._tiles[O.key])&&E.hasData()&&(P=O)}for(var G=P;G.overscaledZ>c;)if(o[(G=G.scaledTo(G.overscaledZ-1)).key]){w[P.key]=P;break}}}},s.prototype.findLoadedParent=function(o,c){if(o.key in this._loadedParentTiles){var v=this._loadedParentTiles[o.key];return v&&v.tileID.overscaledZ>=c?v:null}for(var w=o.overscaledZ-1;w>=c;w--){var S=o.scaledTo(w),E=this._getLoadedTile(S);if(E)return E}},s.prototype._getLoadedTile=function(o){var c=this._tiles[o.key];return c&&c.hasData()?c:this._cache.getByKey(o.wrapped().key)},s.prototype.updateCacheSize=function(o){var c=Math.ceil(o.width/this._source.tileSize)+1,v=Math.ceil(o.height/this._source.tileSize)+1,w=Math.floor(c*v*5),S=typeof this._maxTileCacheSize=="number"?Math.min(this._maxTileCacheSize,w):w;this._cache.setMaxSize(S)},s.prototype.handleWrapJump=function(o){var c=Math.round((o-(this._prevLng===void 0?o:this._prevLng))/360);if(this._prevLng=o,c){var v={};for(var w in this._tiles){var S=this._tiles[w];S.tileID=S.tileID.unwrapTo(S.tileID.wrap+c),v[S.tileID.key]=S}for(var E in this._tiles=v,this._timers)clearTimeout(this._timers[E]),delete this._timers[E];for(var P in this._tiles)this._setTileReloadTimer(P,this._tiles[P])}},s.prototype.update=function(o){var c=this;if(this.transform=o,this._sourceLoaded&&!this._paused){var v;this.updateCacheSize(o),this.handleWrapJump(this.transform.center.lng),this._coveredTiles={},this.used?this._source.tileID?v=o.getVisibleUnwrappedCoordinates(this._source.tileID).map(function(Fe){return new a.OverscaledTileID(Fe.canonical.z,Fe.wrap,Fe.canonical.z,Fe.canonical.x,Fe.canonical.y)}):(v=o.coveringTiles({tileSize:this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this._source.roundZoom,reparseOverscaled:this._source.reparseOverscaled}),this._source.hasTile&&(v=v.filter(function(Fe){return c._source.hasTile(Fe)}))):v=[];var w=o.coveringZoomLevel(this._source),S=Math.max(w-s.maxOverzooming,this._source.minzoom),E=Math.max(w+s.maxUnderzooming,this._source.minzoom),P=this._updateRetainedTiles(v,w);if(Ce(this._source.type)){for(var O={},G={},Z=0,H=Object.keys(P);Z<H.length;Z+=1){var te=H[Z],ee=P[te],ce=this._tiles[te];if(ce&&!(ce.fadeEndTime&&ce.fadeEndTime<=a.browser.now())){var Y=this.findLoadedParent(ee,S);Y&&(this._addTile(Y.tileID),O[Y.tileID.key]=Y.tileID),G[te]=ee}}for(var le in this._retainLoadedChildren(G,w,E,P),O)P[le]||(this._coveredTiles[le]=!0,P[le]=O[le])}for(var de in P)this._tiles[de].clearFadeHold();for(var _e=0,Ie=a.keysDifference(this._tiles,P);_e<Ie.length;_e+=1){var Se=Ie[_e],ze=this._tiles[Se];ze.hasSymbolBuckets&&!ze.holdingForFade()?ze.setHoldDuration(this.map._fadeDuration):ze.hasSymbolBuckets&&!ze.symbolFadeFinished()||this._removeTile(Se)}this._updateLoadedParentTileCache()}},s.prototype.releaseSymbolFadeTiles=function(){for(var o in this._tiles)this._tiles[o].holdingForFade()&&this._removeTile(o)},s.prototype._updateRetainedTiles=function(o,c){for(var v={},w={},S=Math.max(c-s.maxOverzooming,this._source.minzoom),E=Math.max(c+s.maxUnderzooming,this._source.minzoom),P={},O=0,G=o;O<G.length;O+=1){var Z=G[O],H=this._addTile(Z);v[Z.key]=Z,H.hasData()||c<this._source.maxzoom&&(P[Z.key]=Z)}this._retainLoadedChildren(P,c,E,v);for(var te=0,ee=o;te<ee.length;te+=1){var ce=ee[te],Y=this._tiles[ce.key];if(!Y.hasData()){if(c+1>this._source.maxzoom){var le=ce.children(this._source.maxzoom)[0],de=this.getTile(le);if(de&&de.hasData()){v[le.key]=le;continue}}else{var _e=ce.children(this._source.maxzoom);if(v[_e[0].key]&&v[_e[1].key]&&v[_e[2].key]&&v[_e[3].key])continue}for(var Ie=Y.wasRequested(),Se=ce.overscaledZ-1;Se>=S;--Se){var ze=ce.scaledTo(Se);if(w[ze.key]||(w[ze.key]=!0,!(Y=this.getTile(ze))&&Ie&&(Y=this._addTile(ze)),Y&&(v[ze.key]=ze,Ie=Y.wasRequested(),Y.hasData())))break}}}return v},s.prototype._updateLoadedParentTileCache=function(){for(var o in this._loadedParentTiles={},this._tiles){for(var c=[],v=void 0,w=this._tiles[o].tileID;w.overscaledZ>0;){if(w.key in this._loadedParentTiles){v=this._loadedParentTiles[w.key];break}c.push(w.key);var S=w.scaledTo(w.overscaledZ-1);if(v=this._getLoadedTile(S))break;w=S}for(var E=0,P=c;E<P.length;E+=1)this._loadedParentTiles[P[E]]=v}},s.prototype._addTile=function(o){var c=this._tiles[o.key];if(c)return c;(c=this._cache.getAndRemove(o))&&(this._setTileReloadTimer(o.key,c),c.tileID=o,this._state.initializeTileState(c,this.map?this.map.painter:null),this._cacheTimers[o.key]&&(clearTimeout(this._cacheTimers[o.key]),delete this._cacheTimers[o.key],this._setTileReloadTimer(o.key,c)));var v=!!c;return v||(c=new a.Tile(o,this._source.tileSize*o.overscaleFactor()),this._loadTile(c,this._tileLoaded.bind(this,c,o.key,c.state))),c?(c.uses++,this._tiles[o.key]=c,v||this._source.fire(new a.Event("dataloading",{tile:c,coord:c.tileID,dataType:"source"})),c):null},s.prototype._setTileReloadTimer=function(o,c){var v=this;o in this._timers&&(clearTimeout(this._timers[o]),delete this._timers[o]);var w=c.getExpiryTimeout();w&&(this._timers[o]=setTimeout(function(){v._reloadTile(o,"expired"),delete v._timers[o]},w))},s.prototype._removeTile=function(o){var c=this._tiles[o];c&&(c.uses--,delete this._tiles[o],this._timers[o]&&(clearTimeout(this._timers[o]),delete this._timers[o]),c.uses>0||(c.hasData()&&c.state!=="reloading"?this._cache.add(c.tileID,c,c.getExpiryTimeout()):(c.aborted=!0,this._abortTile(c),this._unloadTile(c))))},s.prototype.clearTiles=function(){for(var o in this._shouldReloadOnResume=!1,this._paused=!1,this._tiles)this._removeTile(o);this._cache.reset()},s.prototype.tilesIn=function(o,c,v){var w=this,S=[],E=this.transform;if(!E)return S;for(var P=v?E.getCameraQueryGeometry(o):o,O=o.map(function(Se){return E.pointCoordinate(Se)}),G=P.map(function(Se){return E.pointCoordinate(Se)}),Z=this.getIds(),H=1/0,te=1/0,ee=-1/0,ce=-1/0,Y=0,le=G;Y<le.length;Y+=1){var de=le[Y];H=Math.min(H,de.x),te=Math.min(te,de.y),ee=Math.max(ee,de.x),ce=Math.max(ce,de.y)}for(var _e=function(Se){var ze=w._tiles[Z[Se]];if(!ze.holdingForFade()){var Fe=ze.tileID,Ye=Math.pow(2,E.zoom-ze.tileID.overscaledZ),Xe=c*ze.queryPadding*a.EXTENT/ze.tileSize/Ye,pt=[Fe.getTilePoint(new a.MercatorCoordinate(H,te)),Fe.getTilePoint(new a.MercatorCoordinate(ee,ce))];if(pt[0].x-Xe<a.EXTENT&&pt[0].y-Xe<a.EXTENT&&pt[1].x+Xe>=0&&pt[1].y+Xe>=0){var Et=O.map(function(At){return Fe.getTilePoint(At)}),Pt=G.map(function(At){return Fe.getTilePoint(At)});S.push({tile:ze,tileID:Fe,queryGeometry:Et,cameraQueryGeometry:Pt,scale:Ye})}}},Ie=0;Ie<Z.length;Ie++)_e(Ie);return S},s.prototype.getVisibleCoordinates=function(o){for(var c=this,v=this.getRenderableIds(o).map(function(P){return c._tiles[P].tileID}),w=0,S=v;w<S.length;w+=1){var E=S[w];E.posMatrix=this.transform.calculatePosMatrix(E.toUnwrapped())}return v},s.prototype.hasTransition=function(){if(this._source.hasTransition())return!0;if(Ce(this._source.type))for(var o in this._tiles){var c=this._tiles[o];if(c.fadeEndTime!==void 0&&c.fadeEndTime>=a.browser.now())return!0}return!1},s.prototype.setFeatureState=function(o,c,v){this._state.updateState(o=o||"_geojsonTileLayer",c,v)},s.prototype.removeFeatureState=function(o,c,v){this._state.removeFeatureState(o=o||"_geojsonTileLayer",c,v)},s.prototype.getFeatureState=function(o,c){return this._state.getState(o=o||"_geojsonTileLayer",c)},s.prototype.setDependencies=function(o,c,v){var w=this._tiles[o];w&&w.setDependencies(c,v)},s.prototype.reloadTilesForDependencies=function(o,c){for(var v in this._tiles)this._tiles[v].hasDependency(o,c)&&this._reloadTile(v,"reloading");this._cache.filter(function(w){return!w.hasDependency(o,c)})},s}(a.Evented);function ge(n,s){var o=Math.abs(2*n.wrap)-+(n.wrap<0),c=Math.abs(2*s.wrap)-+(s.wrap<0);return n.overscaledZ-s.overscaledZ||c-o||s.canonical.y-n.canonical.y||s.canonical.x-n.canonical.x}function Ce(n){return n==="raster"||n==="image"||n==="video"}function Le(){return new a.window.Worker(tl.workerUrl)}Q.maxOverzooming=10,Q.maxUnderzooming=3;var Ee="mapboxgl_preloaded_worker_pool",Re=function(){this.active={}};Re.prototype.acquire=function(n){if(!this.workers)for(this.workers=[];this.workers.length<Re.workerCount;)this.workers.push(new Le);return this.active[n]=!0,this.workers.slice()},Re.prototype.release=function(n){delete this.active[n],this.numActive()===0&&(this.workers.forEach(function(s){s.terminate()}),this.workers=null)},Re.prototype.isPreloaded=function(){return!!this.active[Ee]},Re.prototype.numActive=function(){return Object.keys(this.active).length};var ht,at=Math.floor(a.browser.hardwareConcurrency/2);function Te(){return ht||(ht=new Re),ht}function He(n,s){var o={};for(var c in n)c!=="ref"&&(o[c]=n[c]);return a.refProperties.forEach(function(v){v in s&&(o[v]=s[v])}),o}function Qe(n){n=n.slice();for(var s=Object.create(null),o=0;o<n.length;o++)s[n[o].id]=n[o];for(var c=0;c<n.length;c++)"ref"in n[c]&&(n[c]=He(n[c],s[n[c].ref]));return n}Re.workerCount=Math.max(Math.min(at,6),1);var rt={setStyle:"setStyle",addLayer:"addLayer",removeLayer:"removeLayer",setPaintProperty:"setPaintProperty",setLayoutProperty:"setLayoutProperty",setFilter:"setFilter",addSource:"addSource",removeSource:"removeSource",setGeoJSONSourceData:"setGeoJSONSourceData",setLayerZoomRange:"setLayerZoomRange",setLayerProperty:"setLayerProperty",setCenter:"setCenter",setZoom:"setZoom",setBearing:"setBearing",setPitch:"setPitch",setSprite:"setSprite",setGlyphs:"setGlyphs",setTransition:"setTransition",setLight:"setLight"};function jt(n,s,o){o.push({command:rt.addSource,args:[n,s[n]]})}function nt(n,s,o){s.push({command:rt.removeSource,args:[n]}),o[n]=!0}function tr(n,s,o,c){nt(n,o,c),jt(n,s,o)}function wr(n,s,o){var c;for(c in n[o])if(n[o].hasOwnProperty(c)&&c!=="data"&&!a.deepEqual(n[o][c],s[o][c]))return!1;for(c in s[o])if(s[o].hasOwnProperty(c)&&c!=="data"&&!a.deepEqual(n[o][c],s[o][c]))return!1;return!0}function Ht(n,s,o,c,v,w){var S;for(S in s=s||{},n=n||{})n.hasOwnProperty(S)&&(a.deepEqual(n[S],s[S])||o.push({command:w,args:[c,S,s[S],v]}));for(S in s)s.hasOwnProperty(S)&&!n.hasOwnProperty(S)&&(a.deepEqual(n[S],s[S])||o.push({command:w,args:[c,S,s[S],v]}))}function fr(n){return n.id}function rr(n,s){return n[s.id]=s,n}var xi=function(n,s){this.reset(n,s)};xi.prototype.reset=function(n,s){this.points=n||[],this._distances=[0];for(var o=1;o<this.points.length;o++)this._distances[o]=this._distances[o-1]+this.points[o].dist(this.points[o-1]);this.length=this._distances[this._distances.length-1],this.padding=Math.min(s||0,.5*this.length),this.paddedLength=this.length-2*this.padding},xi.prototype.lerp=function(n){if(this.points.length===1)return this.points[0];n=a.clamp(n,0,1);for(var s=1,o=this._distances[s],c=n*this.paddedLength+this.padding;o<c&&s<this._distances.length;)o=this._distances[++s];var v=s-1,w=this._distances[v],S=o-w,E=S>0?(c-w)/S:0;return this.points[v].mult(1-E).add(this.points[s].mult(E))};var yr=function(n,s,o){var c=this.boxCells=[],v=this.circleCells=[];this.xCellCount=Math.ceil(n/o),this.yCellCount=Math.ceil(s/o);for(var w=0;w<this.xCellCount*this.yCellCount;w++)c.push([]),v.push([]);this.circleKeys=[],this.boxKeys=[],this.bboxes=[],this.circles=[],this.width=n,this.height=s,this.xScale=this.xCellCount/n,this.yScale=this.yCellCount/s,this.boxUid=0,this.circleUid=0};function Or(n,s,o,c,v){var w=a.create();return s?(a.scale(w,w,[1/v,1/v,1]),o||a.rotateZ(w,w,c.angle)):a.multiply(w,c.labelPlaneMatrix,n),w}function br(n,s,o,c,v){if(s){var w=a.clone(n);return a.scale(w,w,[v,v,1]),o||a.rotateZ(w,w,-c.angle),w}return c.glCoordMatrix}function Qt(n,s){var o=[n.x,n.y,0,1];li(o,o,s);var c=o[3];return{point:new a.Point(o[0]/c,o[1]/c),signedDistanceFromCamera:c}}function dr(n,s){return .5+n/s*.5}function Ii(n,s){var o=n[0]/n[3],c=n[1]/n[3];return o>=-s[0]&&o<=s[0]&&c>=-s[1]&&c<=s[1]}function pa(n,s,o,c,v,w,S,E){var P=c?n.textSizeData:n.iconSizeData,O=a.evaluateSizeForZoom(P,o.transform.zoom),G=[256/o.width*2+1,256/o.height*2+1],Z=c?n.text.dynamicLayoutVertexArray:n.icon.dynamicLayoutVertexArray;Z.clear();for(var H=n.lineVertexArray,te=c?n.text.placedSymbolArray:n.icon.placedSymbolArray,ee=o.transform.width/o.transform.height,ce=!1,Y=0;Y<te.length;Y++){var le=te.get(Y);if(le.hidden||le.writingMode===a.WritingMode.vertical&&!ce)Ai(le.numGlyphs,Z);else{ce=!1;var de=[le.anchorX,le.anchorY,0,1];if(a.transformMat4(de,de,s),Ii(de,G)){var _e=dr(o.transform.cameraToCenterDistance,de[3]),Ie=a.evaluateSizeForFeature(P,O,le),Se=S?Ie/_e:Ie*_e,ze=new a.Point(le.anchorX,le.anchorY),Fe=Qt(ze,v).point,Ye={},Xe=Na(le,Se,!1,E,s,v,w,n.glyphOffsetArray,H,Z,Fe,ze,Ye,ee);ce=Xe.useVertical,(Xe.notEnoughRoom||ce||Xe.needsFlipping&&Na(le,Se,!0,E,s,v,w,n.glyphOffsetArray,H,Z,Fe,ze,Ye,ee).notEnoughRoom)&&Ai(le.numGlyphs,Z)}else Ai(le.numGlyphs,Z)}}c?n.text.dynamicLayoutVertexBuffer.updateData(Z):n.icon.dynamicLayoutVertexBuffer.updateData(Z)}function si(n,s,o,c,v,w,S,E,P,O,G){var Z=E.glyphStartIndex+E.numGlyphs,H=E.lineStartIndex,te=E.lineStartIndex+E.lineLength,ee=s.getoffsetX(E.glyphStartIndex),ce=s.getoffsetX(Z-1),Y=jr(n*ee,o,c,v,w,S,E.segment,H,te,P,O,G);if(!Y)return null;var le=jr(n*ce,o,c,v,w,S,E.segment,H,te,P,O,G);return le?{first:Y,last:le}:null}function Oi(n,s,o,c){return n===a.WritingMode.horizontal&&Math.abs(o.y-s.y)>Math.abs(o.x-s.x)*c?{useVertical:!0}:(n===a.WritingMode.vertical?s.y<o.y:s.x>o.x)?{needsFlipping:!0}:null}function Na(n,s,o,c,v,w,S,E,P,O,G,Z,H,te){var ee,ce=s/24,Y=n.lineOffsetX*ce,le=n.lineOffsetY*ce;if(n.numGlyphs>1){var de=n.glyphStartIndex+n.numGlyphs,_e=n.lineStartIndex,Ie=n.lineStartIndex+n.lineLength,Se=si(ce,E,Y,le,o,G,Z,n,P,w,H);if(!Se)return{notEnoughRoom:!0};var ze=Qt(Se.first.point,S).point,Fe=Qt(Se.last.point,S).point;if(c&&!o){var Ye=Oi(n.writingMode,ze,Fe,te);if(Ye)return Ye}ee=[Se.first];for(var Xe=n.glyphStartIndex+1;Xe<de-1;Xe++)ee.push(jr(ce*E.getoffsetX(Xe),Y,le,o,G,Z,n.segment,_e,Ie,P,w,H));ee.push(Se.last)}else{if(c&&!o){var pt=Qt(Z,v).point,Et=n.lineStartIndex+n.segment+1,Pt=new a.Point(P.getx(Et),P.gety(Et)),At=Qt(Pt,v),_r=At.signedDistanceFromCamera>0?At.point:va(Z,Pt,pt,1,v),ft=Oi(n.writingMode,pt,_r,te);if(ft)return ft}var Nt=jr(ce*E.getoffsetX(n.glyphStartIndex),Y,le,o,G,Z,n.segment,n.lineStartIndex,n.lineStartIndex+n.lineLength,P,w,H);if(!Nt)return{notEnoughRoom:!0};ee=[Nt]}for(var Yt=0,Ft=ee;Yt<Ft.length;Yt+=1){var Ot=Ft[Yt];a.addDynamicAttributes(O,Ot.point,Ot.angle)}return{}}function va(n,s,o,c,v){var w=Qt(n.add(n.sub(s)._unit()),v).point,S=o.sub(w);return o.add(S._mult(c/S.mag()))}function jr(n,s,o,c,v,w,S,E,P,O,G,Z){var H=c?n-s:n+s,te=H>0?1:-1,ee=0;c&&(te*=-1,ee=Math.PI),te<0&&(ee+=Math.PI);for(var ce=te>0?E+S:E+S+1,Y=v,le=v,de=0,_e=0,Ie=Math.abs(H),Se=[];de+_e<=Ie;){if((ce+=te)<E||ce>=P)return null;if(le=Y,Se.push(Y),(Y=Z[ce])===void 0){var ze=new a.Point(O.getx(ce),O.gety(ce)),Fe=Qt(ze,G);if(Fe.signedDistanceFromCamera>0)Y=Z[ce]=Fe.point;else{var Ye=ce-te;Y=va(de===0?w:new a.Point(O.getx(Ye),O.gety(Ye)),ze,le,Ie-de+1,G)}}de+=_e,_e=le.dist(Y)}var Xe=(Ie-de)/_e,pt=Y.sub(le),Et=pt.mult(Xe)._add(le);Et._add(pt._unit()._perp()._mult(o*te));var Pt=ee+Math.atan2(Y.y-le.y,Y.x-le.x);return Se.push(Et),{point:Et,angle:Pt,path:Se}}yr.prototype.keysLength=function(){return this.boxKeys.length+this.circleKeys.length},yr.prototype.insert=function(n,s,o,c,v){this._forEachCell(s,o,c,v,this._insertBoxCell,this.boxUid++),this.boxKeys.push(n),this.bboxes.push(s),this.bboxes.push(o),this.bboxes.push(c),this.bboxes.push(v)},yr.prototype.insertCircle=function(n,s,o,c){this._forEachCell(s-c,o-c,s+c,o+c,this._insertCircleCell,this.circleUid++),this.circleKeys.push(n),this.circles.push(s),this.circles.push(o),this.circles.push(c)},yr.prototype._insertBoxCell=function(n,s,o,c,v,w){this.boxCells[v].push(w)},yr.prototype._insertCircleCell=function(n,s,o,c,v,w){this.circleCells[v].push(w)},yr.prototype._query=function(n,s,o,c,v,w){if(o<0||n>this.width||c<0||s>this.height)return!v&&[];var S=[];if(n<=0&&s<=0&&this.width<=o&&this.height<=c){if(v)return!0;for(var E=0;E<this.boxKeys.length;E++)S.push({key:this.boxKeys[E],x1:this.bboxes[4*E],y1:this.bboxes[4*E+1],x2:this.bboxes[4*E+2],y2:this.bboxes[4*E+3]});for(var P=0;P<this.circleKeys.length;P++){var O=this.circles[3*P],G=this.circles[3*P+1],Z=this.circles[3*P+2];S.push({key:this.circleKeys[P],x1:O-Z,y1:G-Z,x2:O+Z,y2:G+Z})}return w?S.filter(w):S}return this._forEachCell(n,s,o,c,this._queryCell,S,{hitTest:v,seenUids:{box:{},circle:{}}},w),v?S.length>0:S},yr.prototype._queryCircle=function(n,s,o,c,v){var w=n-o,S=n+o,E=s-o,P=s+o;if(S<0||w>this.width||P<0||E>this.height)return!c&&[];var O=[];return this._forEachCell(w,E,S,P,this._queryCellCircle,O,{hitTest:c,circle:{x:n,y:s,radius:o},seenUids:{box:{},circle:{}}},v),c?O.length>0:O},yr.prototype.query=function(n,s,o,c,v){return this._query(n,s,o,c,!1,v)},yr.prototype.hitTest=function(n,s,o,c,v){return this._query(n,s,o,c,!0,v)},yr.prototype.hitTestCircle=function(n,s,o,c){return this._queryCircle(n,s,o,!0,c)},yr.prototype._queryCell=function(n,s,o,c,v,w,S,E){var P=S.seenUids,O=this.boxCells[v];if(O!==null)for(var G=this.bboxes,Z=0,H=O;Z<H.length;Z+=1){var te=H[Z];if(!P.box[te]){P.box[te]=!0;var ee=4*te;if(n<=G[ee+2]&&s<=G[ee+3]&&o>=G[ee+0]&&c>=G[ee+1]&&(!E||E(this.boxKeys[te]))){if(S.hitTest)return w.push(!0),!0;w.push({key:this.boxKeys[te],x1:G[ee],y1:G[ee+1],x2:G[ee+2],y2:G[ee+3]})}}}var ce=this.circleCells[v];if(ce!==null)for(var Y=this.circles,le=0,de=ce;le<de.length;le+=1){var _e=de[le];if(!P.circle[_e]){P.circle[_e]=!0;var Ie=3*_e;if(this._circleAndRectCollide(Y[Ie],Y[Ie+1],Y[Ie+2],n,s,o,c)&&(!E||E(this.circleKeys[_e]))){if(S.hitTest)return w.push(!0),!0;var Se=Y[Ie],ze=Y[Ie+1],Fe=Y[Ie+2];w.push({key:this.circleKeys[_e],x1:Se-Fe,y1:ze-Fe,x2:Se+Fe,y2:ze+Fe})}}}},yr.prototype._queryCellCircle=function(n,s,o,c,v,w,S,E){var P=S.circle,O=S.seenUids,G=this.boxCells[v];if(G!==null)for(var Z=this.bboxes,H=0,te=G;H<te.length;H+=1){var ee=te[H];if(!O.box[ee]){O.box[ee]=!0;var ce=4*ee;if(this._circleAndRectCollide(P.x,P.y,P.radius,Z[ce+0],Z[ce+1],Z[ce+2],Z[ce+3])&&(!E||E(this.boxKeys[ee])))return w.push(!0),!0}}var Y=this.circleCells[v];if(Y!==null)for(var le=this.circles,de=0,_e=Y;de<_e.length;de+=1){var Ie=_e[de];if(!O.circle[Ie]){O.circle[Ie]=!0;var Se=3*Ie;if(this._circlesCollide(le[Se],le[Se+1],le[Se+2],P.x,P.y,P.radius)&&(!E||E(this.circleKeys[Ie])))return w.push(!0),!0}}},yr.prototype._forEachCell=function(n,s,o,c,v,w,S,E){for(var P=this._convertToXCellCoord(n),O=this._convertToYCellCoord(s),G=this._convertToXCellCoord(o),Z=this._convertToYCellCoord(c),H=P;H<=G;H++)for(var te=O;te<=Z;te++)if(v.call(this,n,s,o,c,this.xCellCount*te+H,w,S,E))return},yr.prototype._convertToXCellCoord=function(n){return Math.max(0,Math.min(this.xCellCount-1,Math.floor(n*this.xScale)))},yr.prototype._convertToYCellCoord=function(n){return Math.max(0,Math.min(this.yCellCount-1,Math.floor(n*this.yScale)))},yr.prototype._circlesCollide=function(n,s,o,c,v,w){var S=c-n,E=v-s,P=o+w;return P*P>S*S+E*E},yr.prototype._circleAndRectCollide=function(n,s,o,c,v,w,S){var E=(w-c)/2,P=Math.abs(n-(c+E));if(P>E+o)return!1;var O=(S-v)/2,G=Math.abs(s-(v+O));if(G>O+o)return!1;if(P<=E||G<=O)return!0;var Z=P-E,H=G-O;return Z*Z+H*H<=o*o};var ba=new Float32Array([-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0]);function Ai(n,s){for(var o=0;o<n;o++){var c=s.length;s.resize(c+4),s.float32.set(ba,3*c)}}function li(n,s,o){var c=s[0],v=s[1];return n[0]=o[0]*c+o[4]*v+o[12],n[1]=o[1]*c+o[5]*v+o[13],n[3]=o[3]*c+o[7]*v+o[15],n}var cn=function(n,s,o){s===void 0&&(s=new yr(n.width+200,n.height+200,25)),o===void 0&&(o=new yr(n.width+200,n.height+200,25)),this.transform=n,this.grid=s,this.ignoredGrid=o,this.pitchfactor=Math.cos(n._pitch)*n.cameraToCenterDistance,this.screenRightBoundary=n.width+100,this.screenBottomBoundary=n.height+100,this.gridRightBoundary=n.width+200,this.gridBottomBoundary=n.height+200};function Pr(n,s,o){return s*(a.EXTENT/(n.tileSize*Math.pow(2,o-n.tileID.overscaledZ)))}cn.prototype.placeCollisionBox=function(n,s,o,c,v){var w=this.projectAndGetPerspectiveRatio(c,n.anchorPointX,n.anchorPointY),S=o*w.perspectiveRatio,E=n.x1*S+w.point.x,P=n.y1*S+w.point.y,O=n.x2*S+w.point.x,G=n.y2*S+w.point.y;return!this.isInsideGrid(E,P,O,G)||!s&&this.grid.hitTest(E,P,O,G,v)?{box:[],offscreen:!1}:{box:[E,P,O,G],offscreen:this.isOffscreen(E,P,O,G)}},cn.prototype.placeCollisionCircles=function(n,s,o,c,v,w,S,E,P,O,G,Z,H){var te=[],ee=new a.Point(s.anchorX,s.anchorY),ce=Qt(ee,w),Y=dr(this.transform.cameraToCenterDistance,ce.signedDistanceFromCamera),le=(O?v/Y:v*Y)/a.ONE_EM,de=Qt(ee,S).point,_e=si(le,c,s.lineOffsetX*le,s.lineOffsetY*le,!1,de,ee,s,o,S,{}),Ie=!1,Se=!1,ze=!0;if(_e){for(var Fe=.5*Z*Y+H,Ye=new a.Point(-100,-100),Xe=new a.Point(this.screenRightBoundary,this.screenBottomBoundary),pt=new xi,Et=_e.first,Pt=_e.last,At=[],_r=Et.path.length-1;_r>=1;_r--)At.push(Et.path[_r]);for(var ft=1;ft<Pt.path.length;ft++)At.push(Pt.path[ft]);var Nt=2.5*Fe;if(E){var Yt=At.map(function(oa){return Qt(oa,E)});At=Yt.some(function(oa){return oa.signedDistanceFromCamera<=0})?[]:Yt.map(function(oa){return oa.point})}var Ft=[];if(At.length>0){for(var Ot=At[0].clone(),Xt=At[0].clone(),Lt=1;Lt<At.length;Lt++)Ot.x=Math.min(Ot.x,At[Lt].x),Ot.y=Math.min(Ot.y,At[Lt].y),Xt.x=Math.max(Xt.x,At[Lt].x),Xt.y=Math.max(Xt.y,At[Lt].y);Ft=Ot.x>=Ye.x&&Xt.x<=Xe.x&&Ot.y>=Ye.y&&Xt.y<=Xe.y?[At]:Xt.x<Ye.x||Ot.x>Xe.x||Xt.y<Ye.y||Ot.y>Xe.y?[]:a.clipLine([At],Ye.x,Ye.y,Xe.x,Xe.y)}for(var Ct=0,Fi=Ft;Ct<Fi.length;Ct+=1){var ui;pt.reset(Fi[Ct],.25*Fe),ui=pt.length<=.5*Fe?1:Math.ceil(pt.paddedLength/Nt)+1;for(var pn=0;pn<ui;pn++){var Wi=pn/Math.max(ui-1,1),ii=pt.lerp(Wi),mi=ii.x+100,jn=ii.y+100;te.push(mi,jn,Fe,0);var xn=mi-Fe,Qa=jn-Fe,zn=mi+Fe,_a=jn+Fe;if(ze=ze&&this.isOffscreen(xn,Qa,zn,_a),Se=Se||this.isInsideGrid(xn,Qa,zn,_a),!n&&this.grid.hitTestCircle(mi,jn,Fe,G)&&(Ie=!0,!P))return{circles:[],offscreen:!1,collisionDetected:Ie}}}}return{circles:!P&&Ie||!Se?[]:te,offscreen:ze,collisionDetected:Ie}},cn.prototype.queryRenderedSymbols=function(n){if(n.length===0||this.grid.keysLength()===0&&this.ignoredGrid.keysLength()===0)return{};for(var s=[],o=1/0,c=1/0,v=-1/0,w=-1/0,S=0,E=n;S<E.length;S+=1){var P=E[S],O=new a.Point(P.x+100,P.y+100);o=Math.min(o,O.x),c=Math.min(c,O.y),v=Math.max(v,O.x),w=Math.max(w,O.y),s.push(O)}for(var G={},Z={},H=0,te=this.grid.query(o,c,v,w).concat(this.ignoredGrid.query(o,c,v,w));H<te.length;H+=1){var ee=te[H],ce=ee.key;if(G[ce.bucketInstanceId]===void 0&&(G[ce.bucketInstanceId]={}),!G[ce.bucketInstanceId][ce.featureIndex]){var Y=[new a.Point(ee.x1,ee.y1),new a.Point(ee.x2,ee.y1),new a.Point(ee.x2,ee.y2),new a.Point(ee.x1,ee.y2)];a.polygonIntersectsPolygon(s,Y)&&(G[ce.bucketInstanceId][ce.featureIndex]=!0,Z[ce.bucketInstanceId]===void 0&&(Z[ce.bucketInstanceId]=[]),Z[ce.bucketInstanceId].push(ce.featureIndex))}}return Z},cn.prototype.insertCollisionBox=function(n,s,o,c,v){(s?this.ignoredGrid:this.grid).insert({bucketInstanceId:o,featureIndex:c,collisionGroupID:v},n[0],n[1],n[2],n[3])},cn.prototype.insertCollisionCircles=function(n,s,o,c,v){for(var w=s?this.ignoredGrid:this.grid,S={bucketInstanceId:o,featureIndex:c,collisionGroupID:v},E=0;E<n.length;E+=4)w.insertCircle(S,n[E],n[E+1],n[E+2])},cn.prototype.projectAndGetPerspectiveRatio=function(n,s,o){var c=[s,o,0,1];return li(c,c,n),{point:new a.Point((c[0]/c[3]+1)/2*this.transform.width+100,(-c[1]/c[3]+1)/2*this.transform.height+100),perspectiveRatio:.5+this.transform.cameraToCenterDistance/c[3]*.5}},cn.prototype.isOffscreen=function(n,s,o,c){return o<100||n>=this.screenRightBoundary||c<100||s>this.screenBottomBoundary},cn.prototype.isInsideGrid=function(n,s,o,c){return o>=0&&n<this.gridRightBoundary&&c>=0&&s<this.gridBottomBoundary},cn.prototype.getViewportMatrix=function(){var n=a.identity([]);return a.translate(n,n,[-100,-100,0]),n};var Rn=function(n,s,o,c){this.opacity=n?Math.max(0,Math.min(1,n.opacity+(n.placed?s:-s))):c&&o?1:0,this.placed=o};Rn.prototype.isHidden=function(){return this.opacity===0&&!this.placed};var _n=function(n,s,o,c,v){this.text=new Rn(n?n.text:null,s,o,v),this.icon=new Rn(n?n.icon:null,s,c,v)};_n.prototype.isHidden=function(){return this.text.isHidden()&&this.icon.isHidden()};var is=function(n,s,o){this.text=n,this.icon=s,this.skipFade=o},zi=function(){this.invProjMatrix=a.create(),this.viewportMatrix=a.create(),this.circles=[]},xa=function(n,s,o,c,v){this.bucketInstanceId=n,this.featureIndex=s,this.sourceLayerIndex=o,this.bucketIndex=c,this.tileID=v},Zi=function(n){this.crossSourceCollisions=n,this.maxGroupID=0,this.collisionGroups={}};function Pi(n,s,o,c,v){var w=a.getAnchorAlignment(n),S=-(w.horizontalAlign-.5)*s,E=-(w.verticalAlign-.5)*o,P=a.evaluateVariableOffset(n,c);return new a.Point(S+P[0]*v,E+P[1]*v)}function Yn(n,s,o,c,v,w){var S=n.x1,E=n.x2,P=n.y1,O=n.y2,G=n.anchorPointX,Z=n.anchorPointY,H=new a.Point(s,o);return c&&H._rotate(v?w:-w),{x1:S+H.x,y1:P+H.y,x2:E+H.x,y2:O+H.y,anchorPointX:G,anchorPointY:Z}}Zi.prototype.get=function(n){if(this.crossSourceCollisions)return{ID:0,predicate:null};if(!this.collisionGroups[n]){var s=++this.maxGroupID;this.collisionGroups[n]={ID:s,predicate:function(o){return o.collisionGroupID===s}}}return this.collisionGroups[n]};var Ki=function(n,s,o,c){this.transform=n.clone(),this.collisionIndex=new cn(this.transform),this.placements={},this.opacities={},this.variableOffsets={},this.stale=!1,this.commitTime=0,this.fadeDuration=s,this.retainedQueryData={},this.collisionGroups=new Zi(o),this.collisionCircleArrays={},this.prevPlacement=c,c&&(c.prevPlacement=void 0),this.placedOrientations={}};function wa(n,s,o,c,v){n.emplaceBack(s?1:0,o?1:0,c||0,v||0),n.emplaceBack(s?1:0,o?1:0,c||0,v||0),n.emplaceBack(s?1:0,o?1:0,c||0,v||0),n.emplaceBack(s?1:0,o?1:0,c||0,v||0)}Ki.prototype.getBucketParts=function(n,s,o,c){var v=o.getBucket(s),w=o.latestFeatureIndex;if(v&&w&&s.id===v.layerIds[0]){var S=o.collisionBoxArray,E=v.layers[0].layout,P=Math.pow(2,this.transform.zoom-o.tileID.overscaledZ),O=o.tileSize/a.EXTENT,G=this.transform.calculatePosMatrix(o.tileID.toUnwrapped()),Z=E.get("text-pitch-alignment")==="map",H=E.get("text-rotation-alignment")==="map",te=Pr(o,1,this.transform.zoom),ee=Or(G,Z,H,this.transform,te),ce=null;if(Z){var Y=br(G,Z,H,this.transform,te);ce=a.multiply([],this.transform.labelPlaneMatrix,Y)}this.retainedQueryData[v.bucketInstanceId]=new xa(v.bucketInstanceId,w,v.sourceLayerIndex,v.index,o.tileID);var le={bucket:v,layout:E,posMatrix:G,textLabelPlaneMatrix:ee,labelToScreenMatrix:ce,scale:P,textPixelRatio:O,holdingForFade:o.holdingForFade(),collisionBoxArray:S,partiallyEvaluatedTextSize:a.evaluateSizeForZoom(v.textSizeData,this.transform.zoom),collisionGroup:this.collisionGroups.get(v.sourceID)};if(c)for(var de=0,_e=v.sortKeyRanges;de<_e.length;de+=1){var Ie=_e[de];n.push({sortKey:Ie.sortKey,symbolInstanceStart:Ie.symbolInstanceStart,symbolInstanceEnd:Ie.symbolInstanceEnd,parameters:le})}else n.push({symbolInstanceStart:0,symbolInstanceEnd:v.symbolInstances.length,parameters:le})}},Ki.prototype.attemptAnchorPlacement=function(n,s,o,c,v,w,S,E,P,O,G,Z,H,te,ee){var ce,Y=[Z.textOffset0,Z.textOffset1],le=Pi(n,o,c,Y,v),de=this.collisionIndex.placeCollisionBox(Yn(s,le.x,le.y,w,S,this.transform.angle),G,E,P,O.predicate);if(!ee||this.collisionIndex.placeCollisionBox(Yn(ee,le.x,le.y,w,S,this.transform.angle),G,E,P,O.predicate).box.length!==0)return de.box.length>0?(this.prevPlacement&&this.prevPlacement.variableOffsets[Z.crossTileID]&&this.prevPlacement.placements[Z.crossTileID]&&this.prevPlacement.placements[Z.crossTileID].text&&(ce=this.prevPlacement.variableOffsets[Z.crossTileID].anchor),this.variableOffsets[Z.crossTileID]={textOffset:Y,width:o,height:c,anchor:n,textBoxScale:v,prevAnchor:ce},this.markUsedJustification(H,n,Z,te),H.allowVerticalPlacement&&(this.markUsedOrientation(H,te,Z),this.placedOrientations[Z.crossTileID]=te),{shift:le,placedGlyphBoxes:de}):void 0},Ki.prototype.placeLayerBucketPart=function(n,s,o){var c=this,v=n.parameters,w=v.bucket,S=v.layout,E=v.posMatrix,P=v.textLabelPlaneMatrix,O=v.labelToScreenMatrix,G=v.textPixelRatio,Z=v.holdingForFade,H=v.collisionBoxArray,te=v.partiallyEvaluatedTextSize,ee=v.collisionGroup,ce=S.get("text-optional"),Y=S.get("icon-optional"),le=S.get("text-allow-overlap"),de=S.get("icon-allow-overlap"),_e=S.get("text-rotation-alignment")==="map",Ie=S.get("text-pitch-alignment")==="map",Se=S.get("icon-text-fit")!=="none",ze=S.get("symbol-z-order")==="viewport-y",Fe=le&&(de||!w.hasIconData()||Y),Ye=de&&(le||!w.hasTextData()||ce);!w.collisionArrays&&H&&w.deserializeCollisionBoxes(H);var Xe=function(ft,Nt){if(!s[ft.crossTileID])if(Z)c.placements[ft.crossTileID]=new is(!1,!1,!1);else{var Yt,Ft=!1,Ot=!1,Xt=!0,Lt=null,Ct={box:null,offscreen:null},Fi={box:null,offscreen:null},ui=null,pn=null,Wi=0,ii=0,mi=0;Nt.textFeatureIndex?Wi=Nt.textFeatureIndex:ft.useRuntimeCollisionCircles&&(Wi=ft.featureIndex),Nt.verticalTextFeatureIndex&&(ii=Nt.verticalTextFeatureIndex);var jn=Nt.textBox;if(jn){var xn=function(Er){var $n=a.WritingMode.horizontal;if(w.allowVerticalPlacement&&!Er&&c.prevPlacement){var Pn=c.prevPlacement.placedOrientations[ft.crossTileID];Pn&&(c.placedOrientations[ft.crossTileID]=Pn,c.markUsedOrientation(w,$n=Pn,ft))}return $n},Qa=function(Er,$n){if(w.allowVerticalPlacement&&ft.numVerticalGlyphVertices>0&&Nt.verticalTextBox)for(var Pn=0,Ao=w.writingModes;Pn<Ao.length&&(Ao[Pn]===a.WritingMode.vertical?(Ct=$n(),Fi=Ct):Ct=Er(),!(Ct&&Ct.box&&Ct.box.length));Pn+=1);else Ct=Er()};if(S.get("text-variable-anchor")){var zn=S.get("text-variable-anchor");if(c.prevPlacement&&c.prevPlacement.variableOffsets[ft.crossTileID]){var _a=c.prevPlacement.variableOffsets[ft.crossTileID];zn.indexOf(_a.anchor)>0&&(zn=zn.filter(function(Er){return Er!==_a.anchor})).unshift(_a.anchor)}var oa=function(Er,$n,Pn){for(var Ao=Er.x2-Er.x1,Hh=Er.y2-Er.y1,rl=ft.textBoxScale,Xh=Se&&!de?$n:null,Es={box:[],offscreen:!1},Tc=le?2*zn.length:zn.length,Wo=0;Wo<Tc;++Wo){var il=c.attemptAnchorPlacement(zn[Wo%zn.length],Er,Ao,Hh,rl,_e,Ie,G,E,ee,Wo>=zn.length,ft,w,Pn,Xh);if(il&&(Es=il.placedGlyphBoxes)&&Es.box&&Es.box.length){Ft=!0,Lt=il.shift;break}}return Es};Qa(function(){return oa(jn,Nt.iconBox,a.WritingMode.horizontal)},function(){var Er=Nt.verticalTextBox;return w.allowVerticalPlacement&&!(Ct&&Ct.box&&Ct.box.length)&&ft.numVerticalGlyphVertices>0&&Er?oa(Er,Nt.verticalIconBox,a.WritingMode.vertical):{box:null,offscreen:null}}),Ct&&(Ft=Ct.box,Xt=Ct.offscreen);var ws=xn(Ct&&Ct.box);if(!Ft&&c.prevPlacement){var Ho=c.prevPlacement.variableOffsets[ft.crossTileID];Ho&&(c.variableOffsets[ft.crossTileID]=Ho,c.markUsedJustification(w,Ho.anchor,ft,ws))}}else{var $a=function(Er,$n){var Pn=c.collisionIndex.placeCollisionBox(Er,le,G,E,ee.predicate);return Pn&&Pn.box&&Pn.box.length&&(c.markUsedOrientation(w,$n,ft),c.placedOrientations[ft.crossTileID]=$n),Pn};Qa(function(){return $a(jn,a.WritingMode.horizontal)},function(){var Er=Nt.verticalTextBox;return w.allowVerticalPlacement&&ft.numVerticalGlyphVertices>0&&Er?$a(Er,a.WritingMode.vertical):{box:null,offscreen:null}}),xn(Ct&&Ct.box&&Ct.box.length)}}if(Ft=(Yt=Ct)&&Yt.box&&Yt.box.length>0,Xt=Yt&&Yt.offscreen,ft.useRuntimeCollisionCircles){var Xo=w.text.placedSymbolArray.get(ft.centerJustifiedTextSymbolIndex),Ss=a.evaluateSizeForFeature(w.textSizeData,te,Xo),Aa=S.get("text-padding");ui=c.collisionIndex.placeCollisionCircles(le,Xo,w.lineVertexArray,w.glyphOffsetArray,Ss,E,P,O,o,Ie,ee.predicate,ft.collisionCircleDiameter,Aa),Ft=le||ui.circles.length>0&&!ui.collisionDetected,Xt=Xt&&ui.offscreen}if(Nt.iconFeatureIndex&&(mi=Nt.iconFeatureIndex),Nt.iconBox){var ks=function(Er){var $n=Se&&Lt?Yn(Er,Lt.x,Lt.y,_e,Ie,c.transform.angle):Er;return c.collisionIndex.placeCollisionBox($n,de,G,E,ee.predicate)};Ot=Fi&&Fi.box&&Fi.box.length&&Nt.verticalIconBox?(pn=ks(Nt.verticalIconBox)).box.length>0:(pn=ks(Nt.iconBox)).box.length>0,Xt=Xt&&pn.offscreen}var za=ce||ft.numHorizontalGlyphVertices===0&&ft.numVerticalGlyphVertices===0,Ni=Y||ft.numIconVertices===0;if(za||Ni?Ni?za||(Ot=Ot&&Ft):Ft=Ot&&Ft:Ot=Ft=Ot&&Ft,Ft&&Yt&&Yt.box&&c.collisionIndex.insertCollisionBox(Yt.box,S.get("text-ignore-placement"),w.bucketInstanceId,Fi&&Fi.box&&ii?ii:Wi,ee.ID),Ot&&pn&&c.collisionIndex.insertCollisionBox(pn.box,S.get("icon-ignore-placement"),w.bucketInstanceId,mi,ee.ID),ui&&(Ft&&c.collisionIndex.insertCollisionCircles(ui.circles,S.get("text-ignore-placement"),w.bucketInstanceId,Wi,ee.ID),o)){var La=w.bucketInstanceId,eo=c.collisionCircleArrays[La];eo===void 0&&(eo=c.collisionCircleArrays[La]=new zi);for(var Io=0;Io<ui.circles.length;Io+=4)eo.circles.push(ui.circles[Io+0]),eo.circles.push(ui.circles[Io+1]),eo.circles.push(ui.circles[Io+2]),eo.circles.push(ui.collisionDetected?1:0)}c.placements[ft.crossTileID]=new is(Ft||Fe,Ot||Ye,Xt||w.justReloaded),s[ft.crossTileID]=!0}};if(ze)for(var pt=w.getSortedSymbolIndexes(this.transform.angle),Et=pt.length-1;Et>=0;--Et){var Pt=pt[Et];Xe(w.symbolInstances.get(Pt),w.collisionArrays[Pt])}else for(var At=n.symbolInstanceStart;At<n.symbolInstanceEnd;At++)Xe(w.symbolInstances.get(At),w.collisionArrays[At]);if(o&&w.bucketInstanceId in this.collisionCircleArrays){var _r=this.collisionCircleArrays[w.bucketInstanceId];a.invert(_r.invProjMatrix,E),_r.viewportMatrix=this.collisionIndex.getViewportMatrix()}w.justReloaded=!1},Ki.prototype.markUsedJustification=function(n,s,o,c){var v;v=c===a.WritingMode.vertical?o.verticalPlacedTextSymbolIndex:{left:o.leftJustifiedTextSymbolIndex,center:o.centerJustifiedTextSymbolIndex,right:o.rightJustifiedTextSymbolIndex}[a.getAnchorJustification(s)];for(var w=0,S=[o.leftJustifiedTextSymbolIndex,o.centerJustifiedTextSymbolIndex,o.rightJustifiedTextSymbolIndex,o.verticalPlacedTextSymbolIndex];w<S.length;w+=1){var E=S[w];E>=0&&(n.text.placedSymbolArray.get(E).crossTileID=v>=0&&E!==v?0:o.crossTileID)}},Ki.prototype.markUsedOrientation=function(n,s,o){for(var c=s===a.WritingMode.horizontal||s===a.WritingMode.horizontalOnly?s:0,v=s===a.WritingMode.vertical?s:0,w=0,S=[o.leftJustifiedTextSymbolIndex,o.centerJustifiedTextSymbolIndex,o.rightJustifiedTextSymbolIndex];w<S.length;w+=1)n.text.placedSymbolArray.get(S[w]).placedOrientation=c;o.verticalPlacedTextSymbolIndex&&(n.text.placedSymbolArray.get(o.verticalPlacedTextSymbolIndex).placedOrientation=v)},Ki.prototype.commit=function(n){this.commitTime=n,this.zoomAtLastRecencyCheck=this.transform.zoom;var s=this.prevPlacement,o=!1;this.prevZoomAdjustment=s?s.zoomAdjustment(this.transform.zoom):0;var c=s?s.symbolFadeChange(n):1,v=s?s.opacities:{},w=s?s.variableOffsets:{},S=s?s.placedOrientations:{};for(var E in this.placements){var P=this.placements[E],O=v[E];O?(this.opacities[E]=new _n(O,c,P.text,P.icon),o=o||P.text!==O.text.placed||P.icon!==O.icon.placed):(this.opacities[E]=new _n(null,c,P.text,P.icon,P.skipFade),o=o||P.text||P.icon)}for(var G in v){var Z=v[G];if(!this.opacities[G]){var H=new _n(Z,c,!1,!1);H.isHidden()||(this.opacities[G]=H,o=o||Z.text.placed||Z.icon.placed)}}for(var te in w)this.variableOffsets[te]||!this.opacities[te]||this.opacities[te].isHidden()||(this.variableOffsets[te]=w[te]);for(var ee in S)this.placedOrientations[ee]||!this.opacities[ee]||this.opacities[ee].isHidden()||(this.placedOrientations[ee]=S[ee]);o?this.lastPlacementChangeTime=n:typeof this.lastPlacementChangeTime!="number"&&(this.lastPlacementChangeTime=s?s.lastPlacementChangeTime:n)},Ki.prototype.updateLayerOpacities=function(n,s){for(var o={},c=0,v=s;c<v.length;c+=1){var w=v[c],S=w.getBucket(n);S&&w.latestFeatureIndex&&n.id===S.layerIds[0]&&this.updateBucketOpacities(S,o,w.collisionBoxArray)}},Ki.prototype.updateBucketOpacities=function(n,s,o){var c=this;n.hasTextData()&&n.text.opacityVertexArray.clear(),n.hasIconData()&&n.icon.opacityVertexArray.clear(),n.hasIconCollisionBoxData()&&n.iconCollisionBox.collisionVertexArray.clear(),n.hasTextCollisionBoxData()&&n.textCollisionBox.collisionVertexArray.clear();var v=n.layers[0].layout,w=new _n(null,0,!1,!1,!0),S=v.get("text-allow-overlap"),E=v.get("icon-allow-overlap"),P=v.get("text-variable-anchor"),O=v.get("text-rotation-alignment")==="map",G=v.get("text-pitch-alignment")==="map",Z=v.get("icon-text-fit")!=="none",H=new _n(null,0,S&&(E||!n.hasIconData()||v.get("icon-optional")),E&&(S||!n.hasTextData()||v.get("text-optional")),!0);!n.collisionArrays&&o&&(n.hasIconCollisionBoxData()||n.hasTextCollisionBoxData())&&n.deserializeCollisionBoxes(o);for(var te=function(le,de,_e){for(var Ie=0;Ie<de/4;Ie++)le.opacityVertexArray.emplaceBack(_e)},ee=function(le){var de=n.symbolInstances.get(le),_e=de.numHorizontalGlyphVertices,Ie=de.numVerticalGlyphVertices,Se=de.crossTileID,ze=c.opacities[Se];s[Se]?ze=w:ze||(c.opacities[Se]=ze=H),s[Se]=!0;var Fe=de.numIconVertices>0,Ye=c.placedOrientations[de.crossTileID],Xe=Ye===a.WritingMode.vertical,pt=Ye===a.WritingMode.horizontal||Ye===a.WritingMode.horizontalOnly;if(_e>0||Ie>0){var Et=Bs(ze.text);te(n.text,_e,Xe?Va:Et),te(n.text,Ie,pt?Va:Et);var Pt=ze.text.isHidden();[de.rightJustifiedTextSymbolIndex,de.centerJustifiedTextSymbolIndex,de.leftJustifiedTextSymbolIndex].forEach(function(Ct){Ct>=0&&(n.text.placedSymbolArray.get(Ct).hidden=Pt||Xe?1:0)}),de.verticalPlacedTextSymbolIndex>=0&&(n.text.placedSymbolArray.get(de.verticalPlacedTextSymbolIndex).hidden=Pt||pt?1:0);var At=c.variableOffsets[de.crossTileID];At&&c.markUsedJustification(n,At.anchor,de,Ye);var _r=c.placedOrientations[de.crossTileID];_r&&(c.markUsedJustification(n,"left",de,_r),c.markUsedOrientation(n,_r,de))}if(Fe){var ft=Bs(ze.icon),Nt=!(Z&&de.verticalPlacedIconSymbolIndex&&Xe);de.placedIconSymbolIndex>=0&&(te(n.icon,de.numIconVertices,Nt?ft:Va),n.icon.placedSymbolArray.get(de.placedIconSymbolIndex).hidden=ze.icon.isHidden()),de.verticalPlacedIconSymbolIndex>=0&&(te(n.icon,de.numVerticalIconVertices,Nt?Va:ft),n.icon.placedSymbolArray.get(de.verticalPlacedIconSymbolIndex).hidden=ze.icon.isHidden())}if(n.hasIconCollisionBoxData()||n.hasTextCollisionBoxData()){var Yt=n.collisionArrays[le];if(Yt){var Ft=new a.Point(0,0);if(Yt.textBox||Yt.verticalTextBox){var Ot=!0;if(P){var Xt=c.variableOffsets[Se];Xt?(Ft=Pi(Xt.anchor,Xt.width,Xt.height,Xt.textOffset,Xt.textBoxScale),O&&Ft._rotate(G?c.transform.angle:-c.transform.angle)):Ot=!1}Yt.textBox&&wa(n.textCollisionBox.collisionVertexArray,ze.text.placed,!Ot||Xe,Ft.x,Ft.y),Yt.verticalTextBox&&wa(n.textCollisionBox.collisionVertexArray,ze.text.placed,!Ot||pt,Ft.x,Ft.y)}var Lt=!!(!pt&&Yt.verticalIconBox);Yt.iconBox&&wa(n.iconCollisionBox.collisionVertexArray,ze.icon.placed,Lt,Z?Ft.x:0,Z?Ft.y:0),Yt.verticalIconBox&&wa(n.iconCollisionBox.collisionVertexArray,ze.icon.placed,!Lt,Z?Ft.x:0,Z?Ft.y:0)}}},ce=0;ce<n.symbolInstances.length;ce++)ee(ce);if(n.sortFeatures(this.transform.angle),this.retainedQueryData[n.bucketInstanceId]&&(this.retainedQueryData[n.bucketInstanceId].featureSortOrder=n.featureSortOrder),n.hasTextData()&&n.text.opacityVertexBuffer&&n.text.opacityVertexBuffer.updateData(n.text.opacityVertexArray),n.hasIconData()&&n.icon.opacityVertexBuffer&&n.icon.opacityVertexBuffer.updateData(n.icon.opacityVertexArray),n.hasIconCollisionBoxData()&&n.iconCollisionBox.collisionVertexBuffer&&n.iconCollisionBox.collisionVertexBuffer.updateData(n.iconCollisionBox.collisionVertexArray),n.hasTextCollisionBoxData()&&n.textCollisionBox.collisionVertexBuffer&&n.textCollisionBox.collisionVertexBuffer.updateData(n.textCollisionBox.collisionVertexArray),n.bucketInstanceId in this.collisionCircleArrays){var Y=this.collisionCircleArrays[n.bucketInstanceId];n.placementInvProjMatrix=Y.invProjMatrix,n.placementViewportMatrix=Y.viewportMatrix,n.collisionCircleArray=Y.circles,delete this.collisionCircleArrays[n.bucketInstanceId]}},Ki.prototype.symbolFadeChange=function(n){return this.fadeDuration===0?1:(n-this.commitTime)/this.fadeDuration+this.prevZoomAdjustment},Ki.prototype.zoomAdjustment=function(n){return Math.max(0,(this.transform.zoom-n)/1.5)},Ki.prototype.hasTransitions=function(n){return this.stale||n-this.lastPlacementChangeTime<this.fadeDuration},Ki.prototype.stillRecent=function(n,s){var o=this.zoomAtLastRecencyCheck===s?1-this.zoomAdjustment(s):1;return this.zoomAtLastRecencyCheck=s,this.commitTime+this.fadeDuration*o>n},Ki.prototype.setStale=function(){this.stale=!0};var ns=Math.pow(2,25),Bl=Math.pow(2,24),uo=Math.pow(2,17),Ol=Math.pow(2,16),Ro=Math.pow(2,9),Fl=Math.pow(2,8),Bo=Math.pow(2,1);function Bs(n){if(n.opacity===0&&!n.placed)return 0;if(n.opacity===1&&n.placed)return 4294967295;var s=n.placed?1:0,o=Math.floor(127*n.opacity);return o*ns+s*Bl+o*uo+s*Ol+o*Ro+s*Fl+o*Bo+s}var Va=0,as=function(n){this._sortAcrossTiles=n.layout.get("symbol-z-order")!=="viewport-y"&&n.layout.get("symbol-sort-key").constantOr(1)!==void 0,this._currentTileIndex=0,this._currentPartIndex=0,this._seenCrossTileIDs={},this._bucketParts=[]};as.prototype.continuePlacement=function(n,s,o,c,v){for(var w=this._bucketParts;this._currentTileIndex<n.length;)if(s.getBucketParts(w,c,n[this._currentTileIndex],this._sortAcrossTiles),this._currentTileIndex++,v())return!0;for(this._sortAcrossTiles&&(this._sortAcrossTiles=!1,w.sort(function(S,E){return S.sortKey-E.sortKey}));this._currentPartIndex<w.length;)if(s.placeLayerBucketPart(w[this._currentPartIndex],this._seenCrossTileIDs,o),this._currentPartIndex++,v())return!0;return!1};var co=function(n,s,o,c,v,w,S){this.placement=new Ki(n,v,w,S),this._currentPlacementIndex=s.length-1,this._forceFullPlacement=o,this._showCollisionBoxes=c,this._done=!1};co.prototype.isDone=function(){return this._done},co.prototype.continuePlacement=function(n,s,o){for(var c=this,v=a.browser.now(),w=function(){var P=a.browser.now()-v;return!c._forceFullPlacement&&P>2};this._currentPlacementIndex>=0;){var S=s[n[this._currentPlacementIndex]],E=this.placement.collisionIndex.transform.zoom;if(S.type==="symbol"&&(!S.minzoom||S.minzoom<=E)&&(!S.maxzoom||S.maxzoom>E)){if(this._inProgressLayer||(this._inProgressLayer=new as(S)),this._inProgressLayer.continuePlacement(o[S.source],this.placement,this._showCollisionBoxes,S,w))return;delete this._inProgressLayer}this._currentPlacementIndex--}this._done=!0},co.prototype.commit=function(n){return this.placement.commit(n),this.placement};var Os=512/a.EXTENT/2,Ua=function(n,s,o){this.tileID=n,this.indexedSymbolInstances={},this.bucketInstanceId=o;for(var c=0;c<s.length;c++){var v=s.get(c),w=v.key;this.indexedSymbolInstances[w]||(this.indexedSymbolInstances[w]=[]),this.indexedSymbolInstances[w].push({crossTileID:v.crossTileID,coord:this.getScaledCoordinates(v,n)})}};Ua.prototype.getScaledCoordinates=function(n,s){var o=Os/Math.pow(2,s.canonical.z-this.tileID.canonical.z);return{x:Math.floor((s.canonical.x*a.EXTENT+n.anchorX)*o),y:Math.floor((s.canonical.y*a.EXTENT+n.anchorY)*o)}},Ua.prototype.findMatches=function(n,s,o){for(var c=this.tileID.canonical.z<s.canonical.z?1:Math.pow(2,this.tileID.canonical.z-s.canonical.z),v=0;v<n.length;v++){var w=n.get(v);if(!w.crossTileID){var S=this.indexedSymbolInstances[w.key];if(S)for(var E=this.getScaledCoordinates(w,s),P=0,O=S;P<O.length;P+=1){var G=O[P];if(Math.abs(G.coord.x-E.x)<=c&&Math.abs(G.coord.y-E.y)<=c&&!o[G.crossTileID]){o[G.crossTileID]=!0,w.crossTileID=G.crossTileID;break}}}}};var Bn=function(){this.maxCrossTileID=0};Bn.prototype.generate=function(){return++this.maxCrossTileID};var Sa=function(){this.indexes={},this.usedCrossTileIDs={},this.lng=0};Sa.prototype.handleWrapJump=function(n){var s=Math.round((n-this.lng)/360);if(s!==0)for(var o in this.indexes){var c=this.indexes[o],v={};for(var w in c){var S=c[w];S.tileID=S.tileID.unwrapTo(S.tileID.wrap+s),v[S.tileID.key]=S}this.indexes[o]=v}this.lng=n},Sa.prototype.addBucket=function(n,s,o){if(this.indexes[n.overscaledZ]&&this.indexes[n.overscaledZ][n.key]){if(this.indexes[n.overscaledZ][n.key].bucketInstanceId===s.bucketInstanceId)return!1;this.removeBucketCrossTileIDs(n.overscaledZ,this.indexes[n.overscaledZ][n.key])}for(var c=0;c<s.symbolInstances.length;c++)s.symbolInstances.get(c).crossTileID=0;this.usedCrossTileIDs[n.overscaledZ]||(this.usedCrossTileIDs[n.overscaledZ]={});var v=this.usedCrossTileIDs[n.overscaledZ];for(var w in this.indexes){var S=this.indexes[w];if(Number(w)>n.overscaledZ)for(var E in S){var P=S[E];P.tileID.isChildOf(n)&&P.findMatches(s.symbolInstances,n,v)}else{var O=S[n.scaledTo(Number(w)).key];O&&O.findMatches(s.symbolInstances,n,v)}}for(var G=0;G<s.symbolInstances.length;G++){var Z=s.symbolInstances.get(G);Z.crossTileID||(Z.crossTileID=o.generate(),v[Z.crossTileID]=!0)}return this.indexes[n.overscaledZ]===void 0&&(this.indexes[n.overscaledZ]={}),this.indexes[n.overscaledZ][n.key]=new Ua(n,s.symbolInstances,s.bucketInstanceId),!0},Sa.prototype.removeBucketCrossTileIDs=function(n,s){for(var o in s.indexedSymbolInstances)for(var c=0,v=s.indexedSymbolInstances[o];c<v.length;c+=1)delete this.usedCrossTileIDs[n][v[c].crossTileID]},Sa.prototype.removeStaleBuckets=function(n){var s=!1;for(var o in this.indexes){var c=this.indexes[o];for(var v in c)n[c[v].bucketInstanceId]||(this.removeBucketCrossTileIDs(o,c[v]),delete c[v],s=!0)}return s};var ye=function(){this.layerIndexes={},this.crossTileIDs=new Bn,this.maxBucketInstanceId=0,this.bucketsInCurrentPlacement={}};ye.prototype.addLayer=function(n,s,o){var c=this.layerIndexes[n.id];c===void 0&&(c=this.layerIndexes[n.id]=new Sa);var v=!1,w={};c.handleWrapJump(o);for(var S=0,E=s;S<E.length;S+=1){var P=E[S],O=P.getBucket(n);O&&n.id===O.layerIds[0]&&(O.bucketInstanceId||(O.bucketInstanceId=++this.maxBucketInstanceId),c.addBucket(P.tileID,O,this.crossTileIDs)&&(v=!0),w[O.bucketInstanceId]=!0)}return c.removeStaleBuckets(w)&&(v=!0),v},ye.prototype.pruneUnusedLayers=function(n){var s={};for(var o in n.forEach(function(c){s[c]=!0}),this.layerIndexes)s[o]||delete this.layerIndexes[o]};var hn=function(n,s){return a.emitValidationErrors(n,s&&s.filter(function(o){return o.identifier!=="source.canvas"}))},Hi=a.pick(rt,["addLayer","removeLayer","setPaintProperty","setLayoutProperty","setFilter","addSource","removeSource","setLayerZoomRange","setLight","setTransition","setGeoJSONSourceData"]),Gr=a.pick(rt,["setCenter","setZoom","setBearing","setPitch"]),ka=function(){var n={},s=a.styleSpec.$version;for(var o in a.styleSpec.$root){var c,v=a.styleSpec.$root[o];v.required&&(c=o==="version"?s:v.type==="array"?[]:{})!=null&&(n[o]=c)}return n}(),On=function(n){function s(o,c){var v=this;c===void 0&&(c={}),n.call(this),this.map=o,this.dispatcher=new Rt(Te(),this),this.imageManager=new be,this.imageManager.setEventedParent(this),this.glyphManager=new Ue(o._requestManager,c.localIdeographFontFamily),this.lineAtlas=new Ne(256,512),this.crossTileSymbolIndex=new ye,this._layers={},this._serializedLayers={},this._order=[],this.sourceCaches={},this.zoomHistory=new a.ZoomHistory,this._loaded=!1,this._availableImages=[],this._resetUpdates(),this.dispatcher.broadcast("setReferrer",a.getReferrer());var w=this;this._rtlTextPluginCallback=s.registerForPluginStateChange(function(S){w.dispatcher.broadcast("syncRTLPluginState",{pluginStatus:S.pluginStatus,pluginURL:S.pluginURL},function(E,P){if(a.triggerPluginCompletionEvent(E),P&&P.every(function(G){return G}))for(var O in w.sourceCaches)w.sourceCaches[O].reload()})}),this.on("data",function(S){if(S.dataType==="source"&&S.sourceDataType==="metadata"){var E=v.sourceCaches[S.sourceId];if(E){var P=E.getSource();if(P&&P.vectorLayerIds)for(var O in v._layers){var G=v._layers[O];G.source===P.id&&v._validateLayer(G)}}}})}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype.loadURL=function(o,c){var v=this;c===void 0&&(c={}),this.fire(new a.Event("dataloading",{dataType:"style"}));var w=typeof c.validate=="boolean"?c.validate:!a.isMapboxURL(o);o=this.map._requestManager.normalizeStyleURL(o,c.accessToken);var S=this.map._requestManager.transformRequest(o,a.ResourceType.Style);this._request=a.getJSON(S,function(E,P){v._request=null,E?v.fire(new a.ErrorEvent(E)):P&&v._load(P,w)})},s.prototype.loadJSON=function(o,c){var v=this;c===void 0&&(c={}),this.fire(new a.Event("dataloading",{dataType:"style"})),this._request=a.browser.frame(function(){v._request=null,v._load(o,c.validate!==!1)})},s.prototype.loadEmpty=function(){this.fire(new a.Event("dataloading",{dataType:"style"})),this._load(ka,!1)},s.prototype._load=function(o,c){if(!c||!hn(this,a.validateStyle(o))){for(var v in this._loaded=!0,this.stylesheet=o,o.sources)this.addSource(v,o.sources[v],{validate:!1});o.sprite?this._loadSprite(o.sprite):this.imageManager.setLoaded(!0),this.glyphManager.setURL(o.glyphs);var w=Qe(this.stylesheet.layers);this._order=w.map(function(O){return O.id}),this._layers={},this._serializedLayers={};for(var S=0,E=w;S<E.length;S+=1){var P=E[S];(P=a.createStyleLayer(P)).setEventedParent(this,{layer:{id:P.id}}),this._layers[P.id]=P,this._serializedLayers[P.id]=P.serialize()}this.dispatcher.broadcast("setLayers",this._serializeLayers(this._order)),this.light=new cr(this.stylesheet.light),this.fire(new a.Event("data",{dataType:"style"})),this.fire(new a.Event("style.load"))}},s.prototype._loadSprite=function(o){var c=this;this._spriteRequest=function(v,w,S){var E,P,O,G=a.browser.devicePixelRatio>1?"@2x":"",Z=a.getJSON(w.transformRequest(w.normalizeSpriteURL(v,G,".json"),a.ResourceType.SpriteJSON),function(ee,ce){Z=null,O||(O=ee,E=ce,te())}),H=a.getImage(w.transformRequest(w.normalizeSpriteURL(v,G,".png"),a.ResourceType.SpriteImage),function(ee,ce){H=null,O||(O=ee,P=ce,te())});function te(){if(O)S(O);else if(E&&P){var ee=a.browser.getImageData(P),ce={};for(var Y in E){var le=E[Y],de=le.width,_e=le.height,Ie=le.x,Se=le.y,ze=le.sdf,Fe=le.pixelRatio,Ye=le.stretchX,Xe=le.stretchY,pt=le.content,Et=new a.RGBAImage({width:de,height:_e});a.RGBAImage.copy(ee,Et,{x:Ie,y:Se},{x:0,y:0},{width:de,height:_e}),ce[Y]={data:Et,pixelRatio:Fe,sdf:ze,stretchX:Ye,stretchY:Xe,content:pt}}S(null,ce)}}return{cancel:function(){Z&&(Z.cancel(),Z=null),H&&(H.cancel(),H=null)}}}(o,this.map._requestManager,function(v,w){if(c._spriteRequest=null,v)c.fire(new a.ErrorEvent(v));else if(w)for(var S in w)c.imageManager.addImage(S,w[S]);c.imageManager.setLoaded(!0),c._availableImages=c.imageManager.listImages(),c.dispatcher.broadcast("setImages",c._availableImages),c.fire(new a.Event("data",{dataType:"style"}))})},s.prototype._validateLayer=function(o){var c=this.sourceCaches[o.source];if(c){var v=o.sourceLayer;if(v){var w=c.getSource();(w.type==="geojson"||w.vectorLayerIds&&w.vectorLayerIds.indexOf(v)===-1)&&this.fire(new a.ErrorEvent(new Error('Source layer "'+v+'" does not exist on source "'+w.id+'" as specified by style layer "'+o.id+'"')))}}},s.prototype.loaded=function(){if(!this._loaded||Object.keys(this._updatedSources).length)return!1;for(var o in this.sourceCaches)if(!this.sourceCaches[o].loaded())return!1;return!!this.imageManager.isLoaded()},s.prototype._serializeLayers=function(o){for(var c=[],v=0,w=o;v<w.length;v+=1){var S=this._layers[w[v]];S.type!=="custom"&&c.push(S.serialize())}return c},s.prototype.hasTransitions=function(){if(this.light&&this.light.hasTransition())return!0;for(var o in this.sourceCaches)if(this.sourceCaches[o].hasTransition())return!0;for(var c in this._layers)if(this._layers[c].hasTransition())return!0;return!1},s.prototype._checkLoaded=function(){if(!this._loaded)throw new Error("Style is not done loading")},s.prototype.update=function(o){if(this._loaded){var c=this._changed;if(this._changed){var v=Object.keys(this._updatedLayers),w=Object.keys(this._removedLayers);for(var S in(v.length||w.length)&&this._updateWorkerLayers(v,w),this._updatedSources){var E=this._updatedSources[S];E==="reload"?this._reloadSource(S):E==="clear"&&this._clearSource(S)}for(var P in this._updateTilesForChangedImages(),this._updatedPaintProps)this._layers[P].updateTransitions(o);this.light.updateTransitions(o),this._resetUpdates()}var O={};for(var G in this.sourceCaches){var Z=this.sourceCaches[G];O[G]=Z.used,Z.used=!1}for(var H=0,te=this._order;H<te.length;H+=1){var ee=this._layers[te[H]];ee.recalculate(o,this._availableImages),!ee.isHidden(o.zoom)&&ee.source&&(this.sourceCaches[ee.source].used=!0)}for(var ce in O){var Y=this.sourceCaches[ce];O[ce]!==Y.used&&Y.fire(new a.Event("data",{sourceDataType:"visibility",dataType:"source",sourceId:ce}))}this.light.recalculate(o),this.z=o.zoom,c&&this.fire(new a.Event("data",{dataType:"style"}))}},s.prototype._updateTilesForChangedImages=function(){var o=Object.keys(this._changedImages);if(o.length){for(var c in this.sourceCaches)this.sourceCaches[c].reloadTilesForDependencies(["icons","patterns"],o);this._changedImages={}}},s.prototype._updateWorkerLayers=function(o,c){this.dispatcher.broadcast("updateLayers",{layers:this._serializeLayers(o),removedIds:c})},s.prototype._resetUpdates=function(){this._changed=!1,this._updatedLayers={},this._removedLayers={},this._updatedSources={},this._updatedPaintProps={},this._changedImages={}},s.prototype.setState=function(o){var c=this;if(this._checkLoaded(),hn(this,a.validateStyle(o)))return!1;(o=a.clone$1(o)).layers=Qe(o.layers);var v=function(S,E){if(!S)return[{command:rt.setStyle,args:[E]}];var P=[];try{if(!a.deepEqual(S.version,E.version))return[{command:rt.setStyle,args:[E]}];a.deepEqual(S.center,E.center)||P.push({command:rt.setCenter,args:[E.center]}),a.deepEqual(S.zoom,E.zoom)||P.push({command:rt.setZoom,args:[E.zoom]}),a.deepEqual(S.bearing,E.bearing)||P.push({command:rt.setBearing,args:[E.bearing]}),a.deepEqual(S.pitch,E.pitch)||P.push({command:rt.setPitch,args:[E.pitch]}),a.deepEqual(S.sprite,E.sprite)||P.push({command:rt.setSprite,args:[E.sprite]}),a.deepEqual(S.glyphs,E.glyphs)||P.push({command:rt.setGlyphs,args:[E.glyphs]}),a.deepEqual(S.transition,E.transition)||P.push({command:rt.setTransition,args:[E.transition]}),a.deepEqual(S.light,E.light)||P.push({command:rt.setLight,args:[E.light]});var O={},G=[];(function(H,te,ee,ce){var Y;for(Y in te=te||{},H=H||{})H.hasOwnProperty(Y)&&(te.hasOwnProperty(Y)||nt(Y,ee,ce));for(Y in te)te.hasOwnProperty(Y)&&(H.hasOwnProperty(Y)?a.deepEqual(H[Y],te[Y])||(H[Y].type==="geojson"&&te[Y].type==="geojson"&&wr(H,te,Y)?ee.push({command:rt.setGeoJSONSourceData,args:[Y,te[Y].data]}):tr(Y,te,ee,ce)):jt(Y,te,ee))})(S.sources,E.sources,G,O);var Z=[];S.layers&&S.layers.forEach(function(H){O[H.source]?P.push({command:rt.removeLayer,args:[H.id]}):Z.push(H)}),P=P.concat(G),function(H,te,ee){te=te||[];var ce,Y,le,de,_e,Ie,Se,ze=(H=H||[]).map(fr),Fe=te.map(fr),Ye=H.reduce(rr,{}),Xe=te.reduce(rr,{}),pt=ze.slice(),Et=Object.create(null);for(ce=0,Y=0;ce<ze.length;ce++)Xe.hasOwnProperty(le=ze[ce])?Y++:(ee.push({command:rt.removeLayer,args:[le]}),pt.splice(pt.indexOf(le,Y),1));for(ce=0,Y=0;ce<Fe.length;ce++)pt[pt.length-1-ce]!==(le=Fe[Fe.length-1-ce])&&(Ye.hasOwnProperty(le)?(ee.push({command:rt.removeLayer,args:[le]}),pt.splice(pt.lastIndexOf(le,pt.length-Y),1)):Y++,ee.push({command:rt.addLayer,args:[Xe[le],Ie=pt[pt.length-ce]]}),pt.splice(pt.length-ce,0,le),Et[le]=!0);for(ce=0;ce<Fe.length;ce++)if(de=Ye[le=Fe[ce]],_e=Xe[le],!Et[le]&&!a.deepEqual(de,_e))if(a.deepEqual(de.source,_e.source)&&a.deepEqual(de["source-layer"],_e["source-layer"])&&a.deepEqual(de.type,_e.type)){for(Se in Ht(de.layout,_e.layout,ee,le,null,rt.setLayoutProperty),Ht(de.paint,_e.paint,ee,le,null,rt.setPaintProperty),a.deepEqual(de.filter,_e.filter)||ee.push({command:rt.setFilter,args:[le,_e.filter]}),a.deepEqual(de.minzoom,_e.minzoom)&&a.deepEqual(de.maxzoom,_e.maxzoom)||ee.push({command:rt.setLayerZoomRange,args:[le,_e.minzoom,_e.maxzoom]}),de)de.hasOwnProperty(Se)&&Se!=="layout"&&Se!=="paint"&&Se!=="filter"&&Se!=="metadata"&&Se!=="minzoom"&&Se!=="maxzoom"&&(Se.indexOf("paint.")===0?Ht(de[Se],_e[Se],ee,le,Se.slice(6),rt.setPaintProperty):a.deepEqual(de[Se],_e[Se])||ee.push({command:rt.setLayerProperty,args:[le,Se,_e[Se]]}));for(Se in _e)_e.hasOwnProperty(Se)&&!de.hasOwnProperty(Se)&&Se!=="layout"&&Se!=="paint"&&Se!=="filter"&&Se!=="metadata"&&Se!=="minzoom"&&Se!=="maxzoom"&&(Se.indexOf("paint.")===0?Ht(de[Se],_e[Se],ee,le,Se.slice(6),rt.setPaintProperty):a.deepEqual(de[Se],_e[Se])||ee.push({command:rt.setLayerProperty,args:[le,Se,_e[Se]]}))}else ee.push({command:rt.removeLayer,args:[le]}),Ie=pt[pt.lastIndexOf(le)+1],ee.push({command:rt.addLayer,args:[_e,Ie]})}(Z,E.layers,P)}catch(H){console.warn("Unable to compute style diff:",H),P=[{command:rt.setStyle,args:[E]}]}return P}(this.serialize(),o).filter(function(S){return!(S.command in Gr)});if(v.length===0)return!1;var w=v.filter(function(S){return!(S.command in Hi)});if(w.length>0)throw new Error("Unimplemented: "+w.map(function(S){return S.command}).join(", ")+".");return v.forEach(function(S){S.command!=="setTransition"&&c[S.command].apply(c,S.args)}),this.stylesheet=o,!0},s.prototype.addImage=function(o,c){if(this.getImage(o))return this.fire(new a.ErrorEvent(new Error("An image with this name already exists.")));this.imageManager.addImage(o,c),this._afterImageUpdated(o)},s.prototype.updateImage=function(o,c){this.imageManager.updateImage(o,c)},s.prototype.getImage=function(o){return this.imageManager.getImage(o)},s.prototype.removeImage=function(o){if(!this.getImage(o))return this.fire(new a.ErrorEvent(new Error("No image with this name exists.")));this.imageManager.removeImage(o),this._afterImageUpdated(o)},s.prototype._afterImageUpdated=function(o){this._availableImages=this.imageManager.listImages(),this._changedImages[o]=!0,this._changed=!0,this.dispatcher.broadcast("setImages",this._availableImages),this.fire(new a.Event("data",{dataType:"style"}))},s.prototype.listImages=function(){return this._checkLoaded(),this.imageManager.listImages()},s.prototype.addSource=function(o,c,v){var w=this;if(v===void 0&&(v={}),this._checkLoaded(),this.sourceCaches[o]!==void 0)throw new Error("There is already a source with this ID");if(!c.type)throw new Error("The type property must be defined, but only the following properties were given: "+Object.keys(c).join(", ")+".");if(!(["vector","raster","geojson","video","image"].indexOf(c.type)>=0&&this._validate(a.validateStyle.source,"sources."+o,c,null,v))){this.map&&this.map._collectResourceTiming&&(c.collectResourceTiming=!0);var S=this.sourceCaches[o]=new Q(o,c,this.dispatcher);S.style=this,S.setEventedParent(this,function(){return{isSourceLoaded:w.loaded(),source:S.serialize(),sourceId:o}}),S.onAdd(this.map),this._changed=!0}},s.prototype.removeSource=function(o){if(this._checkLoaded(),this.sourceCaches[o]===void 0)throw new Error("There is no source with this ID");for(var c in this._layers)if(this._layers[c].source===o)return this.fire(new a.ErrorEvent(new Error('Source "'+o+'" cannot be removed while layer "'+c+'" is using it.')));var v=this.sourceCaches[o];delete this.sourceCaches[o],delete this._updatedSources[o],v.fire(new a.Event("data",{sourceDataType:"metadata",dataType:"source",sourceId:o})),v.setEventedParent(null),v.clearTiles(),v.onRemove&&v.onRemove(this.map),this._changed=!0},s.prototype.setGeoJSONSourceData=function(o,c){this._checkLoaded(),this.sourceCaches[o].getSource().setData(c),this._changed=!0},s.prototype.getSource=function(o){return this.sourceCaches[o]&&this.sourceCaches[o].getSource()},s.prototype.addLayer=function(o,c,v){v===void 0&&(v={}),this._checkLoaded();var w=o.id;if(this.getLayer(w))this.fire(new a.ErrorEvent(new Error('Layer with id "'+w+'" already exists on this map')));else{var S;if(o.type==="custom"){if(hn(this,a.validateCustomStyleLayer(o)))return;S=a.createStyleLayer(o)}else{if(typeof o.source=="object"&&(this.addSource(w,o.source),o=a.clone$1(o),o=a.extend(o,{source:w})),this._validate(a.validateStyle.layer,"layers."+w,o,{arrayIndex:-1},v))return;S=a.createStyleLayer(o),this._validateLayer(S),S.setEventedParent(this,{layer:{id:w}}),this._serializedLayers[S.id]=S.serialize()}var E=c?this._order.indexOf(c):this._order.length;if(c&&E===-1)this.fire(new a.ErrorEvent(new Error('Layer with id "'+c+'" does not exist on this map.')));else{if(this._order.splice(E,0,w),this._layerOrderChanged=!0,this._layers[w]=S,this._removedLayers[w]&&S.source&&S.type!=="custom"){var P=this._removedLayers[w];delete this._removedLayers[w],P.type!==S.type?this._updatedSources[S.source]="clear":(this._updatedSources[S.source]="reload",this.sourceCaches[S.source].pause())}this._updateLayer(S),S.onAdd&&S.onAdd(this.map)}}},s.prototype.moveLayer=function(o,c){if(this._checkLoaded(),this._changed=!0,this._layers[o]){if(o!==c){var v=this._order.indexOf(o);this._order.splice(v,1);var w=c?this._order.indexOf(c):this._order.length;c&&w===-1?this.fire(new a.ErrorEvent(new Error('Layer with id "'+c+'" does not exist on this map.'))):(this._order.splice(w,0,o),this._layerOrderChanged=!0)}}else this.fire(new a.ErrorEvent(new Error("The layer '"+o+"' does not exist in the map's style and cannot be moved.")))},s.prototype.removeLayer=function(o){this._checkLoaded();var c=this._layers[o];if(c){c.setEventedParent(null);var v=this._order.indexOf(o);this._order.splice(v,1),this._layerOrderChanged=!0,this._changed=!0,this._removedLayers[o]=c,delete this._layers[o],delete this._serializedLayers[o],delete this._updatedLayers[o],delete this._updatedPaintProps[o],c.onRemove&&c.onRemove(this.map)}else this.fire(new a.ErrorEvent(new Error("The layer '"+o+"' does not exist in the map's style and cannot be removed.")))},s.prototype.getLayer=function(o){return this._layers[o]},s.prototype.hasLayer=function(o){return o in this._layers},s.prototype.setLayerZoomRange=function(o,c,v){this._checkLoaded();var w=this.getLayer(o);w?w.minzoom===c&&w.maxzoom===v||(c!=null&&(w.minzoom=c),v!=null&&(w.maxzoom=v),this._updateLayer(w)):this.fire(new a.ErrorEvent(new Error("The layer '"+o+"' does not exist in the map's style and cannot have zoom extent.")))},s.prototype.setFilter=function(o,c,v){v===void 0&&(v={}),this._checkLoaded();var w=this.getLayer(o);if(w){if(!a.deepEqual(w.filter,c))return c==null?(w.filter=void 0,void this._updateLayer(w)):void(this._validate(a.validateStyle.filter,"layers."+w.id+".filter",c,null,v)||(w.filter=a.clone$1(c),this._updateLayer(w)))}else this.fire(new a.ErrorEvent(new Error("The layer '"+o+"' does not exist in the map's style and cannot be filtered.")))},s.prototype.getFilter=function(o){return a.clone$1(this.getLayer(o).filter)},s.prototype.setLayoutProperty=function(o,c,v,w){w===void 0&&(w={}),this._checkLoaded();var S=this.getLayer(o);S?a.deepEqual(S.getLayoutProperty(c),v)||(S.setLayoutProperty(c,v,w),this._updateLayer(S)):this.fire(new a.ErrorEvent(new Error("The layer '"+o+"' does not exist in the map's style and cannot be styled.")))},s.prototype.getLayoutProperty=function(o,c){var v=this.getLayer(o);if(v)return v.getLayoutProperty(c);this.fire(new a.ErrorEvent(new Error("The layer '"+o+"' does not exist in the map's style.")))},s.prototype.setPaintProperty=function(o,c,v,w){w===void 0&&(w={}),this._checkLoaded();var S=this.getLayer(o);S?a.deepEqual(S.getPaintProperty(c),v)||(S.setPaintProperty(c,v,w)&&this._updateLayer(S),this._changed=!0,this._updatedPaintProps[o]=!0):this.fire(new a.ErrorEvent(new Error("The layer '"+o+"' does not exist in the map's style and cannot be styled.")))},s.prototype.getPaintProperty=function(o,c){return this.getLayer(o).getPaintProperty(c)},s.prototype.setFeatureState=function(o,c){this._checkLoaded();var v=o.source,w=o.sourceLayer,S=this.sourceCaches[v];if(S!==void 0){var E=S.getSource().type;E==="geojson"&&w?this.fire(new a.ErrorEvent(new Error("GeoJSON sources cannot have a sourceLayer parameter."))):E!=="vector"||w?(o.id===void 0&&this.fire(new a.ErrorEvent(new Error("The feature id parameter must be provided."))),S.setFeatureState(w,o.id,c)):this.fire(new a.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")))}else this.fire(new a.ErrorEvent(new Error("The source '"+v+"' does not exist in the map's style.")))},s.prototype.removeFeatureState=function(o,c){this._checkLoaded();var v=o.source,w=this.sourceCaches[v];if(w!==void 0){var S=w.getSource().type,E=S==="vector"?o.sourceLayer:void 0;S!=="vector"||E?c&&typeof o.id!="string"&&typeof o.id!="number"?this.fire(new a.ErrorEvent(new Error("A feature id is required to remove its specific state property."))):w.removeFeatureState(E,o.id,c):this.fire(new a.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")))}else this.fire(new a.ErrorEvent(new Error("The source '"+v+"' does not exist in the map's style.")))},s.prototype.getFeatureState=function(o){this._checkLoaded();var c=o.source,v=o.sourceLayer,w=this.sourceCaches[c];if(w!==void 0){if(w.getSource().type!=="vector"||v)return o.id===void 0&&this.fire(new a.ErrorEvent(new Error("The feature id parameter must be provided."))),w.getFeatureState(v,o.id);this.fire(new a.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")))}else this.fire(new a.ErrorEvent(new Error("The source '"+c+"' does not exist in the map's style.")))},s.prototype.getTransition=function(){return a.extend({duration:300,delay:0},this.stylesheet&&this.stylesheet.transition)},s.prototype.serialize=function(){return a.filterObject({version:this.stylesheet.version,name:this.stylesheet.name,metadata:this.stylesheet.metadata,light:this.stylesheet.light,center:this.stylesheet.center,zoom:this.stylesheet.zoom,bearing:this.stylesheet.bearing,pitch:this.stylesheet.pitch,sprite:this.stylesheet.sprite,glyphs:this.stylesheet.glyphs,transition:this.stylesheet.transition,sources:a.mapObject(this.sourceCaches,function(o){return o.serialize()}),layers:this._serializeLayers(this._order)},function(o){return o!==void 0})},s.prototype._updateLayer=function(o){this._updatedLayers[o.id]=!0,o.source&&!this._updatedSources[o.source]&&this.sourceCaches[o.source].getSource().type!=="raster"&&(this._updatedSources[o.source]="reload",this.sourceCaches[o.source].pause()),this._changed=!0},s.prototype._flattenAndSortRenderedFeatures=function(o){for(var c=this,v=function(Ye){return c._layers[Ye].type==="fill-extrusion"},w={},S=[],E=this._order.length-1;E>=0;E--){var P=this._order[E];if(v(P)){w[P]=E;for(var O=0,G=o;O<G.length;O+=1){var Z=G[O][P];if(Z)for(var H=0,te=Z;H<te.length;H+=1)S.push(te[H])}}}S.sort(function(Ye,Xe){return Xe.intersectionZ-Ye.intersectionZ});for(var ee=[],ce=this._order.length-1;ce>=0;ce--){var Y=this._order[ce];if(v(Y))for(var le=S.length-1;le>=0;le--){var de=S[le].feature;if(w[de.layer.id]<ce)break;ee.push(de),S.pop()}else for(var _e=0,Ie=o;_e<Ie.length;_e+=1){var Se=Ie[_e][Y];if(Se)for(var ze=0,Fe=Se;ze<Fe.length;ze+=1)ee.push(Fe[ze].feature)}}return ee},s.prototype.queryRenderedFeatures=function(o,c,v){c&&c.filter&&this._validate(a.validateStyle.filter,"queryRenderedFeatures.filter",c.filter,null,c);var w={};if(c&&c.layers){if(!Array.isArray(c.layers))return this.fire(new a.ErrorEvent(new Error("parameters.layers must be an Array."))),[];for(var S=0,E=c.layers;S<E.length;S+=1){var P=E[S],O=this._layers[P];if(!O)return this.fire(new a.ErrorEvent(new Error("The layer '"+P+"' does not exist in the map's style and cannot be queried for features."))),[];w[O.source]=!0}}var G=[];for(var Z in c.availableImages=this._availableImages,this.sourceCaches)c.layers&&!w[Z]||G.push(er(this.sourceCaches[Z],this._layers,this._serializedLayers,o,c,v));return this.placement&&G.push(function(H,te,ee,ce,Y,le,de){for(var _e={},Ie=le.queryRenderedSymbols(ce),Se=[],ze=0,Fe=Object.keys(Ie).map(Number);ze<Fe.length;ze+=1)Se.push(de[Fe[ze]]);Se.sort(Hr);for(var Ye=function(){var At=pt[Xe],_r=At.featureIndex.lookupSymbolFeatures(Ie[At.bucketInstanceId],te,At.bucketIndex,At.sourceLayerIndex,Y.filter,Y.layers,Y.availableImages,H);for(var ft in _r){var Nt=_e[ft]=_e[ft]||[],Yt=_r[ft];Yt.sort(function(Xt,Lt){var Ct=At.featureSortOrder;if(Ct){var Fi=Ct.indexOf(Xt.featureIndex);return Ct.indexOf(Lt.featureIndex)-Fi}return Lt.featureIndex-Xt.featureIndex});for(var Ft=0,Ot=Yt;Ft<Ot.length;Ft+=1)Nt.push(Ot[Ft])}},Xe=0,pt=Se;Xe<pt.length;Xe+=1)Ye();var Et=function(At){_e[At].forEach(function(_r){var ft=_r.feature,Nt=ee[H[At].source].getFeatureState(ft.layer["source-layer"],ft.id);ft.source=ft.layer.source,ft.layer["source-layer"]&&(ft.sourceLayer=ft.layer["source-layer"]),ft.state=Nt})};for(var Pt in _e)Et(Pt);return _e}(this._layers,this._serializedLayers,this.sourceCaches,o,c,this.placement.collisionIndex,this.placement.retainedQueryData)),this._flattenAndSortRenderedFeatures(G)},s.prototype.querySourceFeatures=function(o,c){c&&c.filter&&this._validate(a.validateStyle.filter,"querySourceFeatures.filter",c.filter,null,c);var v=this.sourceCaches[o];return v?function(w,S){for(var E=w.getRenderableIds().map(function(te){return w.getTileByID(te)}),P=[],O={},G=0;G<E.length;G++){var Z=E[G],H=Z.tileID.canonical.key;O[H]||(O[H]=!0,Z.querySourceFeatures(P,S))}return P}(v,c):[]},s.prototype.addSourceType=function(o,c,v){return s.getSourceType(o)?v(new Error('A source type called "'+o+'" already exists.')):(s.setSourceType(o,c),c.workerSourceURL?void this.dispatcher.broadcast("loadWorkerSource",{name:o,url:c.workerSourceURL},v):v(null,null))},s.prototype.getLight=function(){return this.light.getLight()},s.prototype.setLight=function(o,c){c===void 0&&(c={}),this._checkLoaded();var v=this.light.getLight(),w=!1;for(var S in o)if(!a.deepEqual(o[S],v[S])){w=!0;break}if(w){var E={now:a.browser.now(),transition:a.extend({duration:300,delay:0},this.stylesheet.transition)};this.light.setLight(o,c),this.light.updateTransitions(E)}},s.prototype._validate=function(o,c,v,w,S){return S===void 0&&(S={}),(!S||S.validate!==!1)&&hn(this,o.call(a.validateStyle,a.extend({key:c,style:this.serialize(),value:v,styleSpec:a.styleSpec},w)))},s.prototype._remove=function(){for(var o in this._request&&(this._request.cancel(),this._request=null),this._spriteRequest&&(this._spriteRequest.cancel(),this._spriteRequest=null),a.evented.off("pluginStateChange",this._rtlTextPluginCallback),this._layers)this._layers[o].setEventedParent(null);for(var c in this.sourceCaches)this.sourceCaches[c].clearTiles(),this.sourceCaches[c].setEventedParent(null);this.imageManager.setEventedParent(null),this.setEventedParent(null),this.dispatcher.remove()},s.prototype._clearSource=function(o){this.sourceCaches[o].clearTiles()},s.prototype._reloadSource=function(o){this.sourceCaches[o].resume(),this.sourceCaches[o].reload()},s.prototype._updateSources=function(o){for(var c in this.sourceCaches)this.sourceCaches[c].update(o)},s.prototype._generateCollisionBoxes=function(){for(var o in this.sourceCaches)this._reloadSource(o)},s.prototype._updatePlacement=function(o,c,v,w,S){S===void 0&&(S=!1);for(var E=!1,P=!1,O={},G=0,Z=this._order;G<Z.length;G+=1){var H=this._layers[Z[G]];if(H.type==="symbol"){if(!O[H.source]){var te=this.sourceCaches[H.source];O[H.source]=te.getRenderableIds(!0).map(function(de){return te.getTileByID(de)}).sort(function(de,_e){return _e.tileID.overscaledZ-de.tileID.overscaledZ||(de.tileID.isLessThan(_e.tileID)?-1:1)})}var ee=this.crossTileSymbolIndex.addLayer(H,O[H.source],o.center.lng);E=E||ee}}if(this.crossTileSymbolIndex.pruneUnusedLayers(this._order),((S=S||this._layerOrderChanged||v===0)||!this.pauseablePlacement||this.pauseablePlacement.isDone()&&!this.placement.stillRecent(a.browser.now(),o.zoom))&&(this.pauseablePlacement=new co(o,this._order,S,c,v,w,this.placement),this._layerOrderChanged=!1),this.pauseablePlacement.isDone()?this.placement.setStale():(this.pauseablePlacement.continuePlacement(this._order,this._layers,O),this.pauseablePlacement.isDone()&&(this.placement=this.pauseablePlacement.commit(a.browser.now()),P=!0),E&&this.pauseablePlacement.placement.setStale()),P||E)for(var ce=0,Y=this._order;ce<Y.length;ce+=1){var le=this._layers[Y[ce]];le.type==="symbol"&&this.placement.updateLayerOpacities(le,O[le.source])}return!this.pauseablePlacement.isDone()||this.placement.hasTransitions(a.browser.now())},s.prototype._releaseSymbolFadeTiles=function(){for(var o in this.sourceCaches)this.sourceCaches[o].releaseSymbolFadeTiles()},s.prototype.getImages=function(o,c,v){this.imageManager.getImages(c.icons,v),this._updateTilesForChangedImages();var w=this.sourceCaches[c.source];w&&w.setDependencies(c.tileID.key,c.type,c.icons)},s.prototype.getGlyphs=function(o,c,v){this.glyphManager.getGlyphs(c.stacks,v)},s.prototype.getResource=function(o,c,v){return a.makeRequest(c,v)},s}(a.Evented);On.getSourceType=function(n){return vi[n]},On.setSourceType=function(n,s){vi[n]=s},On.registerForPluginStateChange=a.registerForPluginStateChange;var wi=a.createLayout([{name:"a_pos",type:"Int16",components:2}]),Oo=Rr(`#ifdef GL_ES
precision mediump float;
#else
#if !defined(lowp)
#define lowp
#endif
#if !defined(mediump)
#define mediump
#endif
#if !defined(highp)
#define highp
#endif
#endif`,`#ifdef GL_ES
precision highp float;
#else
#if !defined(lowp)
#define lowp
#endif
#if !defined(mediump)
#define mediump
#endif
#if !defined(highp)
#define highp
#endif
#endif
vec2 unpack_float(const float packedValue) {int packedIntValue=int(packedValue);int v0=packedIntValue/256;return vec2(v0,packedIntValue-v0*256);}vec2 unpack_opacity(const float packedOpacity) {int intOpacity=int(packedOpacity)/2;return vec2(float(intOpacity)/127.0,mod(packedOpacity,2.0));}vec4 decode_color(const vec2 encodedColor) {return vec4(unpack_float(encodedColor[0])/255.0,unpack_float(encodedColor[1])/255.0
);}float unpack_mix_vec2(const vec2 packedValue,const float t) {return mix(packedValue[0],packedValue[1],t);}vec4 unpack_mix_color(const vec4 packedColors,const float t) {vec4 minColor=decode_color(vec2(packedColors[0],packedColors[1]));vec4 maxColor=decode_color(vec2(packedColors[2],packedColors[3]));return mix(minColor,maxColor,t);}vec2 get_pattern_pos(const vec2 pixel_coord_upper,const vec2 pixel_coord_lower,const vec2 pattern_size,const float tile_units_to_pixels,const vec2 pos) {vec2 offset=mod(mod(mod(pixel_coord_upper,pattern_size)*256.0,pattern_size)*256.0+pixel_coord_lower,pattern_size);return (tile_units_to_pixels*pos+offset)/pattern_size;}`),ec=Rr(`uniform vec4 u_color;uniform float u_opacity;void main() {gl_FragColor=u_color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),Fh=Rr(`uniform vec2 u_pattern_tl_a;uniform vec2 u_pattern_br_a;uniform vec2 u_pattern_tl_b;uniform vec2 u_pattern_br_b;uniform vec2 u_texsize;uniform float u_mix;uniform float u_opacity;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;void main() {vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(u_pattern_tl_a/u_texsize,u_pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(u_pattern_tl_b/u_texsize,u_pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);gl_FragColor=mix(color1,color2,u_mix)*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_pattern_size_a;uniform vec2 u_pattern_size_b;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_scale_a;uniform float u_scale_b;uniform float u_tile_units_to_pixels;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_a*u_pattern_size_a,u_tile_units_to_pixels,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_b*u_pattern_size_b,u_tile_units_to_pixels,a_pos);}"),Nh=Rr(`varying vec3 v_data;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=v_data.xy;float extrude_length=length(extrude);lowp float antialiasblur=v_data.z;float antialiased_blur=-max(blur,antialiasblur);float opacity_t=smoothstep(0.0,antialiased_blur,extrude_length-1.0);float color_t=stroke_width < 0.01 ? 0.0 : smoothstep(antialiased_blur,0.0,extrude_length-radius/(radius+stroke_width));gl_FragColor=opacity_t*mix(color*opacity,stroke_color*stroke_opacity,color_t);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform bool u_scale_with_map;uniform bool u_pitch_with_map;uniform vec2 u_extrude_scale;uniform lowp float u_device_pixel_ratio;uniform highp float u_camera_to_center_distance;attribute vec2 a_pos;varying vec3 v_data;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
void main(void) {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=vec2(mod(a_pos,2.0)*2.0-1.0);vec2 circle_center=floor(a_pos*0.5);if (u_pitch_with_map) {vec2 corner_position=circle_center;if (u_scale_with_map) {corner_position+=extrude*(radius+stroke_width)*u_extrude_scale;} else {vec4 projected_center=u_matrix*vec4(circle_center,0,1);corner_position+=extrude*(radius+stroke_width)*u_extrude_scale*(projected_center.w/u_camera_to_center_distance);}gl_Position=u_matrix*vec4(corner_position,0,1);} else {gl_Position=u_matrix*vec4(circle_center,0,1);if (u_scale_with_map) {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*u_camera_to_center_distance;} else {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*gl_Position.w;}}lowp float antialiasblur=1.0/u_device_pixel_ratio/(radius+stroke_width);v_data=vec3(extrude.x,extrude.y,antialiasblur);}`),Nl=Rr("void main() {gl_FragColor=vec4(1.0);}","attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),Vl=Rr(`uniform highp float u_intensity;varying vec2 v_extrude;
#pragma mapbox: define highp float weight
#define GAUSS_COEF 0.3989422804014327
void main() {
#pragma mapbox: initialize highp float weight
float d=-0.5*3.0*3.0*dot(v_extrude,v_extrude);float val=weight*u_intensity*GAUSS_COEF*exp(d);gl_FragColor=vec4(val,1.0,1.0,1.0);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform float u_extrude_scale;uniform float u_opacity;uniform float u_intensity;attribute vec2 a_pos;varying vec2 v_extrude;
#pragma mapbox: define highp float weight
#pragma mapbox: define mediump float radius
const highp float ZERO=1.0/255.0/16.0;
#define GAUSS_COEF 0.3989422804014327
void main(void) {
#pragma mapbox: initialize highp float weight
#pragma mapbox: initialize mediump float radius
vec2 unscaled_extrude=vec2(mod(a_pos,2.0)*2.0-1.0);float S=sqrt(-2.0*log(ZERO/weight/u_intensity/GAUSS_COEF))/3.0;v_extrude=S*unscaled_extrude;vec2 extrude=v_extrude*radius*u_extrude_scale;vec4 pos=vec4(floor(a_pos*0.5)+extrude,0,1);gl_Position=u_matrix*pos;}`),Ul=Rr(`uniform sampler2D u_image;uniform sampler2D u_color_ramp;uniform float u_opacity;varying vec2 v_pos;void main() {float t=texture2D(u_image,v_pos).r;vec4 color=texture2D(u_color_ramp,vec2(t,0.5));gl_FragColor=color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(0.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_world;attribute vec2 a_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos*u_world,0,1);v_pos.x=a_pos.x;v_pos.y=1.0-a_pos.y;}"),ql=Rr("varying float v_placed;varying float v_notUsed;void main() {float alpha=0.5;gl_FragColor=vec4(1.0,0.0,0.0,1.0)*alpha;if (v_placed > 0.5) {gl_FragColor=vec4(0.0,0.0,1.0,0.5)*alpha;}if (v_notUsed > 0.5) {gl_FragColor*=.1;}}","attribute vec2 a_pos;attribute vec2 a_anchor_pos;attribute vec2 a_extrude;attribute vec2 a_placed;attribute vec2 a_shift;uniform mat4 u_matrix;uniform vec2 u_extrude_scale;uniform float u_camera_to_center_distance;varying float v_placed;varying float v_notUsed;void main() {vec4 projectedPoint=u_matrix*vec4(a_anchor_pos,0,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float collision_perspective_ratio=clamp(0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,4.0);gl_Position=u_matrix*vec4(a_pos,0.0,1.0);gl_Position.xy+=(a_extrude+a_shift)*u_extrude_scale*gl_Position.w*collision_perspective_ratio;v_placed=a_placed.x;v_notUsed=a_placed.y;}"),tc=Rr("varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;void main() {float alpha=0.5*min(v_perspective_ratio,1.0);float stroke_radius=0.9*max(v_perspective_ratio,1.0);float distance_to_center=length(v_extrude);float distance_to_edge=abs(distance_to_center-v_radius);float opacity_t=smoothstep(-stroke_radius,0.0,-distance_to_edge);vec4 color=mix(vec4(0.0,0.0,1.0,0.5),vec4(1.0,0.0,0.0,1.0),v_collision);gl_FragColor=color*alpha*opacity_t;}","attribute vec2 a_pos;attribute float a_radius;attribute vec2 a_flags;uniform mat4 u_matrix;uniform mat4 u_inv_matrix;uniform vec2 u_viewport_size;uniform float u_camera_to_center_distance;varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;vec3 toTilePosition(vec2 screenPos) {vec4 rayStart=u_inv_matrix*vec4(screenPos,-1.0,1.0);vec4 rayEnd  =u_inv_matrix*vec4(screenPos, 1.0,1.0);rayStart.xyz/=rayStart.w;rayEnd.xyz  /=rayEnd.w;highp float t=(0.0-rayStart.z)/(rayEnd.z-rayStart.z);return mix(rayStart.xyz,rayEnd.xyz,t);}void main() {vec2 quadCenterPos=a_pos;float radius=a_radius;float collision=a_flags.x;float vertexIdx=a_flags.y;vec2 quadVertexOffset=vec2(mix(-1.0,1.0,float(vertexIdx >=2.0)),mix(-1.0,1.0,float(vertexIdx >=1.0 && vertexIdx <=2.0)));vec2 quadVertexExtent=quadVertexOffset*radius;vec3 tilePos=toTilePosition(quadCenterPos);vec4 clipPos=u_matrix*vec4(tilePos,1.0);highp float camera_to_anchor_distance=clipPos.w;highp float collision_perspective_ratio=clamp(0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,4.0);float padding_factor=1.2;v_radius=radius;v_extrude=quadVertexExtent*padding_factor;v_perspective_ratio=collision_perspective_ratio;v_collision=collision;gl_Position=vec4(clipPos.xyz/clipPos.w,1.0)+vec4(quadVertexExtent*padding_factor/u_viewport_size*2.0,0.0,0.0);}"),rc=Rr("uniform highp vec4 u_color;uniform sampler2D u_overlay;varying vec2 v_uv;void main() {vec4 overlay_color=texture2D(u_overlay,v_uv);gl_FragColor=mix(u_color,overlay_color,overlay_color.a);}","attribute vec2 a_pos;varying vec2 v_uv;uniform mat4 u_matrix;uniform float u_overlay_scale;void main() {v_uv=a_pos/8192.0;gl_Position=u_matrix*vec4(a_pos*u_overlay_scale,0,1);}"),Vh=Rr(`#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
gl_FragColor=color*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec2 a_pos;uniform mat4 u_matrix;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
gl_Position=u_matrix*vec4(a_pos,0,1);}`),os=Rr(`varying vec2 v_pos;
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);gl_FragColor=outline_color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec2 a_pos;uniform mat4 u_matrix;uniform vec2 u_world;varying vec2 v_pos;
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;}`),ss=Rr(`uniform vec2 u_texsize;uniform sampler2D u_image;uniform float u_fade;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec2 v_pos;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);gl_FragColor=mix(color1,color2,u_fade)*alpha*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_world;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec2 v_pos;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;gl_Position=u_matrix*vec4(a_pos,0,1);vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,a_pos);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;}`),ic=Rr(`uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);gl_FragColor=mix(color1,color2,u_fade)*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;gl_Position=u_matrix*vec4(a_pos,0,1);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileZoomRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileZoomRatio,a_pos);}`),an=Rr(`varying vec4 v_color;void main() {gl_FragColor=v_color;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;uniform float u_vertical_gradient;uniform lowp float u_opacity;attribute vec2 a_pos;attribute vec4 a_normal_ed;varying vec4 v_color;
#pragma mapbox: define highp float base
#pragma mapbox: define highp float height
#pragma mapbox: define highp vec4 color
void main() {
#pragma mapbox: initialize highp float base
#pragma mapbox: initialize highp float height
#pragma mapbox: initialize highp vec4 color
vec3 normal=a_normal_ed.xyz;base=max(0.0,base);height=max(0.0,height);float t=mod(normal.x,2.0);gl_Position=u_matrix*vec4(a_pos,t > 0.0 ? height : base,1);float colorvalue=color.r*0.2126+color.g*0.7152+color.b*0.0722;v_color=vec4(0.0,0.0,0.0,1.0);vec4 ambientlight=vec4(0.03,0.03,0.03,1.0);color+=ambientlight;float directional=clamp(dot(normal/16384.0,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_color.r+=clamp(color.r*directional*u_lightcolor.r,mix(0.0,0.3,1.0-u_lightcolor.r),1.0);v_color.g+=clamp(color.g*directional*u_lightcolor.g,mix(0.0,0.3,1.0-u_lightcolor.g),1.0);v_color.b+=clamp(color.b*directional*u_lightcolor.b,mix(0.0,0.3,1.0-u_lightcolor.b),1.0);v_color*=u_opacity;}`),jl=Rr(`uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec4 v_lighting;
#pragma mapbox: define lowp float base
#pragma mapbox: define lowp float height
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float base
#pragma mapbox: initialize lowp float height
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);vec4 mixedColor=mix(color1,color2,u_fade);gl_FragColor=mixedColor*v_lighting;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_height_factor;uniform vec3 u_scale;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;attribute vec2 a_pos;attribute vec4 a_normal_ed;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec4 v_lighting;
#pragma mapbox: define lowp float base
#pragma mapbox: define lowp float height
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float base
#pragma mapbox: initialize lowp float height
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec3 normal=a_normal_ed.xyz;float edgedistance=a_normal_ed.w;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;base=max(0.0,base);height=max(0.0,height);float t=mod(normal.x,2.0);float z=t > 0.0 ? height : base;gl_Position=u_matrix*vec4(a_pos,z,1);vec2 pos=normal.x==1.0 && normal.y==0.0 && normal.z==16384.0
? a_pos
: vec2(edgedistance,z*u_height_factor);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,pos);v_lighting=vec4(0.0,0.0,0.0,1.0);float directional=clamp(dot(normal/16383.0,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((0.5+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_lighting.rgb+=clamp(directional*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_lighting*=u_opacity;}`),qa=Rr(`#ifdef GL_ES
precision highp float;
#endif
uniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_dimension;uniform float u_zoom;uniform vec4 u_unpack;float getElevation(vec2 coord,float bias) {vec4 data=texture2D(u_image,coord)*255.0;data.a=-1.0;return dot(data,u_unpack)/4.0;}void main() {vec2 epsilon=1.0/u_dimension;float a=getElevation(v_pos+vec2(-epsilon.x,-epsilon.y),0.0);float b=getElevation(v_pos+vec2(0,-epsilon.y),0.0);float c=getElevation(v_pos+vec2(epsilon.x,-epsilon.y),0.0);float d=getElevation(v_pos+vec2(-epsilon.x,0),0.0);float e=getElevation(v_pos,0.0);float f=getElevation(v_pos+vec2(epsilon.x,0),0.0);float g=getElevation(v_pos+vec2(-epsilon.x,epsilon.y),0.0);float h=getElevation(v_pos+vec2(0,epsilon.y),0.0);float i=getElevation(v_pos+vec2(epsilon.x,epsilon.y),0.0);float exaggerationFactor=u_zoom < 2.0 ? 0.4 : u_zoom < 4.5 ? 0.35 : 0.3;float exaggeration=u_zoom < 15.0 ? (u_zoom-15.0)*exaggerationFactor : 0.0;vec2 deriv=vec2((c+f+f+i)-(a+d+d+g),(g+h+h+i)-(a+b+b+c))/pow(2.0,exaggeration+(19.2562-u_zoom));gl_FragColor=clamp(vec4(deriv.x/2.0+0.5,deriv.y/2.0+0.5,1.0,1.0),0.0,1.0);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_dimension;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);highp vec2 epsilon=1.0/u_dimension;float scale=(u_dimension.x-2.0)/u_dimension.x;v_pos=(a_texture_pos/8192.0)*scale+epsilon;}"),ja=Rr(`uniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_latrange;uniform vec2 u_light;uniform vec4 u_shadow;uniform vec4 u_highlight;uniform vec4 u_accent;
#define PI 3.141592653589793
void main() {vec4 pixel=texture2D(u_image,v_pos);vec2 deriv=((pixel.rg*2.0)-1.0);float scaleFactor=cos(radians((u_latrange[0]-u_latrange[1])*(1.0-v_pos.y)+u_latrange[1]));float slope=atan(1.25*length(deriv)/scaleFactor);float aspect=deriv.x !=0.0 ? atan(deriv.y,-deriv.x) : PI/2.0*(deriv.y > 0.0 ? 1.0 :-1.0);float intensity=u_light.x;float azimuth=u_light.y+PI;float base=1.875-intensity*1.75;float maxValue=0.5*PI;float scaledSlope=intensity !=0.5 ? ((pow(base,slope)-1.0)/(pow(base,maxValue)-1.0))*maxValue : slope;float accent=cos(scaledSlope);vec4 accent_color=(1.0-accent)*u_accent*clamp(intensity*2.0,0.0,1.0);float shade=abs(mod((aspect+azimuth)/PI+0.5,2.0)-1.0);vec4 shade_color=mix(u_shadow,u_highlight,shade)*sin(scaledSlope)*clamp(intensity*2.0,0.0,1.0);gl_FragColor=accent_color*(1.0-shade_color.a)+shade_color;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=a_texture_pos/8192.0;}"),ho=Rr(`uniform lowp float u_device_pixel_ratio;varying vec2 v_width2;varying vec2 v_normal;varying float v_gamma_scale;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);gl_FragColor=color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
attribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform vec2 u_units_to_pixels;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_gamma_scale;varying highp float v_linesofar;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;v_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*2.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;v_width2=vec2(outset,inset);}`),po=Rr(`uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;varying vec2 v_width2;varying vec2 v_normal;varying float v_gamma_scale;varying highp vec2 v_uv;
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);vec4 color=texture2D(u_image,v_uv);gl_FragColor=color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
attribute vec2 a_pos_normal;attribute vec4 a_data;attribute float a_uv_x;attribute float a_split_index;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_units_to_pixels;uniform float u_image_height;varying vec2 v_normal;varying vec2 v_width2;varying float v_gamma_scale;varying highp vec2 v_uv;
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;highp float texel_height=1.0/u_image_height;highp float half_texel_height=0.5*texel_height;v_uv=vec2(a_uv_x,a_split_index*texel_height-half_texel_height);vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;v_width2=vec2(outset,inset);}`),Ga=Rr(`uniform lowp float u_device_pixel_ratio;uniform vec2 u_texsize;uniform float u_fade;uniform mediump vec3 u_scale;uniform sampler2D u_image;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;vec2 pattern_size_a=vec2(display_size_a.x*fromScale/tileZoomRatio,display_size_a.y);vec2 pattern_size_b=vec2(display_size_b.x*toScale/tileZoomRatio,display_size_b.y);float aspect_a=display_size_a.y/v_width;float aspect_b=display_size_b.y/v_width;float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float x_a=mod(v_linesofar/pattern_size_a.x*aspect_a,1.0);float x_b=mod(v_linesofar/pattern_size_b.x*aspect_b,1.0);float y=0.5*v_normal.y+0.5;vec2 texel_size=1.0/u_texsize;vec2 pos_a=mix(pattern_tl_a*texel_size-texel_size,pattern_br_a*texel_size+texel_size,vec2(x_a,y));vec2 pos_b=mix(pattern_tl_b*texel_size-texel_size,pattern_br_b*texel_size+texel_size,vec2(x_b,y));vec4 color=mix(texture2D(u_image,pos_a),texture2D(u_image,pos_b),u_fade);gl_FragColor=color*alpha*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
#define LINE_DISTANCE_SCALE 2.0
attribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform vec2 u_units_to_pixels;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;v_linesofar=a_linesofar;v_width2=vec2(outset,inset);v_width=floorwidth;}`),fo=Rr(`uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;uniform float u_sdfgamma;uniform float u_mix;varying vec2 v_normal;varying vec2 v_width2;varying vec2 v_tex_a;varying vec2 v_tex_b;varying float v_gamma_scale;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float sdfdist_a=texture2D(u_image,v_tex_a).a;float sdfdist_b=texture2D(u_image,v_tex_b).a;float sdfdist=mix(sdfdist_a,sdfdist_b,u_mix);alpha*=smoothstep(0.5-u_sdfgamma/floorwidth,0.5+u_sdfgamma/floorwidth,sdfdist);gl_FragColor=color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
#define LINE_DISTANCE_SCALE 2.0
attribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_patternscale_a;uniform float u_tex_y_a;uniform vec2 u_patternscale_b;uniform float u_tex_y_b;uniform vec2 u_units_to_pixels;varying vec2 v_normal;varying vec2 v_width2;varying vec2 v_tex_a;varying vec2 v_tex_b;varying float v_gamma_scale;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;v_tex_a=vec2(a_linesofar*u_patternscale_a.x/floorwidth,normal.y*u_patternscale_a.y+u_tex_y_a);v_tex_b=vec2(a_linesofar*u_patternscale_b.x/floorwidth,normal.y*u_patternscale_b.y+u_tex_y_b);v_width2=vec2(outset,inset);}`),mo=Rr(`uniform float u_fade_t;uniform float u_opacity;uniform sampler2D u_image0;uniform sampler2D u_image1;varying vec2 v_pos0;varying vec2 v_pos1;uniform float u_brightness_low;uniform float u_brightness_high;uniform float u_saturation_factor;uniform float u_contrast_factor;uniform vec3 u_spin_weights;void main() {vec4 color0=texture2D(u_image0,v_pos0);vec4 color1=texture2D(u_image1,v_pos1);if (color0.a > 0.0) {color0.rgb=color0.rgb/color0.a;}if (color1.a > 0.0) {color1.rgb=color1.rgb/color1.a;}vec4 color=mix(color0,color1,u_fade_t);color.a*=u_opacity;vec3 rgb=color.rgb;rgb=vec3(dot(rgb,u_spin_weights.xyz),dot(rgb,u_spin_weights.zxy),dot(rgb,u_spin_weights.yzx));float average=(color.r+color.g+color.b)/3.0;rgb+=(average-rgb)*u_saturation_factor;rgb=(rgb-0.5)*u_contrast_factor+0.5;vec3 u_high_vec=vec3(u_brightness_low,u_brightness_low,u_brightness_low);vec3 u_low_vec=vec3(u_brightness_high,u_brightness_high,u_brightness_high);gl_FragColor=vec4(mix(u_high_vec,u_low_vec,rgb)*color.a,color.a);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_tl_parent;uniform float u_scale_parent;uniform float u_buffer_scale;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos0;varying vec2 v_pos1;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos0=(((a_texture_pos/8192.0)-0.5)/u_buffer_scale )+0.5;v_pos1=(v_pos0*u_scale_parent)+u_tl_parent;}"),Za=Rr(`uniform sampler2D u_texture;varying vec2 v_tex;varying float v_fade_opacity;
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float opacity
lowp float alpha=opacity*v_fade_opacity;gl_FragColor=texture2D(u_texture,v_tex)*alpha;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`const float PI=3.141592653589793;attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec4 a_pixeloffset;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform highp float u_camera_to_center_distance;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform float u_fade_change;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform vec2 u_texsize;varying vec2 v_tex;varying float v_fade_opacity;
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float opacity
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;vec2 a_minFontScale=a_pixeloffset.zw/256.0;highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec4 projectedPoint=u_matrix*vec4(a_pos,0,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),0,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,0.0,1.0);gl_Position=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*max(a_minFontScale,fontScale)+a_pxoffset/16.0),0.0,1.0);v_tex=a_tex/u_texsize;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;v_fade_opacity=max(0.0,min(1.0,fade_opacity[0]+fade_change));}`),nc=Rr(`#define SDF_PX 8.0
uniform bool u_is_halo;uniform sampler2D u_texture;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;uniform bool u_is_text;varying vec2 v_data0;varying vec3 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
float EDGE_GAMMA=0.105/u_device_pixel_ratio;vec2 tex=v_data0.xy;float gamma_scale=v_data1.x;float size=v_data1.y;float fade_opacity=v_data1[2];float fontScale=u_is_text ? size/24.0 : size;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);gl_FragColor=color*(alpha*opacity*fade_opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`const float PI=3.141592653589793;attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec4 a_pixeloffset;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;varying vec2 v_data0;varying vec3 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec4 projectedPoint=u_matrix*vec4(a_pos,0,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),0,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,0.0,1.0);gl_Position=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale+a_pxoffset),0.0,1.0);float gamma_scale=gl_Position.w;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(1.0,fade_opacity[0]+fade_change));v_data0=a_tex/u_texsize;v_data1=vec3(gamma_scale,size,interpolated_fade_opacity);}`),ac=Rr(`#define SDF_PX 8.0
#define SDF 1.0
#define ICON 0.0
uniform bool u_is_halo;uniform sampler2D u_texture;uniform sampler2D u_texture_icon;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;varying vec4 v_data0;varying vec4 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
float fade_opacity=v_data1[2];if (v_data1.w==ICON) {vec2 tex_icon=v_data0.zw;lowp float alpha=opacity*fade_opacity;gl_FragColor=texture2D(u_texture_icon,tex_icon)*alpha;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
return;}vec2 tex=v_data0.xy;float EDGE_GAMMA=0.105/u_device_pixel_ratio;float gamma_scale=v_data1.x;float size=v_data1.y;float fontScale=size/24.0;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);gl_FragColor=color*(alpha*opacity*fade_opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`const float PI=3.141592653589793;attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec2 u_texsize_icon;varying vec4 v_data0;varying vec4 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);float is_sdf=a_size[0]-2.0*a_size_min;highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec4 projectedPoint=u_matrix*vec4(a_pos,0,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=size/24.0;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),0,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,0.0,1.0);gl_Position=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale),0.0,1.0);float gamma_scale=gl_Position.w;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(1.0,fade_opacity[0]+fade_change));v_data0.xy=a_tex/u_texsize;v_data0.zw=a_tex/u_texsize_icon;v_data1=vec4(gamma_scale,size,interpolated_fade_opacity,is_sdf);}`);function Rr(n,s){var o=/#pragma mapbox: ([\w]+) ([\w]+) ([\w]+) ([\w]+)/g,c=s.match(/attribute ([\w]+) ([\w]+)/g),v=n.match(/uniform ([\w]+) ([\w]+)([\s]*)([\w]*)/g),w=s.match(/uniform ([\w]+) ([\w]+)([\s]*)([\w]*)/g),S=w?w.concat(v):v,E={};return{fragmentSource:n=n.replace(o,function(P,O,G,Z,H){return E[H]=!0,O==="define"?`
#ifndef HAS_UNIFORM_u_`+H+`
varying `+G+" "+Z+" "+H+`;
#else
uniform `+G+" "+Z+" u_"+H+`;
#endif
`:`
#ifdef HAS_UNIFORM_u_`+H+`
    `+G+" "+Z+" "+H+" = u_"+H+`;
#endif
`}),vertexSource:s=s.replace(o,function(P,O,G,Z,H){var te=Z==="float"?"vec2":"vec4",ee=H.match(/color/)?"color":te;return E[H]?O==="define"?`
#ifndef HAS_UNIFORM_u_`+H+`
uniform lowp float u_`+H+`_t;
attribute `+G+" "+te+" a_"+H+`;
varying `+G+" "+Z+" "+H+`;
#else
uniform `+G+" "+Z+" u_"+H+`;
#endif
`:ee==="vec4"?`
#ifndef HAS_UNIFORM_u_`+H+`
    `+H+" = a_"+H+`;
#else
    `+G+" "+Z+" "+H+" = u_"+H+`;
#endif
`:`
#ifndef HAS_UNIFORM_u_`+H+`
    `+H+" = unpack_mix_"+ee+"(a_"+H+", u_"+H+`_t);
#else
    `+G+" "+Z+" "+H+" = u_"+H+`;
#endif
`:O==="define"?`
#ifndef HAS_UNIFORM_u_`+H+`
uniform lowp float u_`+H+`_t;
attribute `+G+" "+te+" a_"+H+`;
#else
uniform `+G+" "+Z+" u_"+H+`;
#endif
`:ee==="vec4"?`
#ifndef HAS_UNIFORM_u_`+H+`
    `+G+" "+Z+" "+H+" = a_"+H+`;
#else
    `+G+" "+Z+" "+H+" = u_"+H+`;
#endif
`:`
#ifndef HAS_UNIFORM_u_`+H+`
    `+G+" "+Z+" "+H+" = unpack_mix_"+ee+"(a_"+H+", u_"+H+`_t);
#else
    `+G+" "+Z+" "+H+" = u_"+H+`;
#endif
`}),staticAttributes:c,staticUniforms:S}}var Uh=Object.freeze({__proto__:null,prelude:Oo,background:ec,backgroundPattern:Fh,circle:Nh,clippingMask:Nl,heatmap:Vl,heatmapTexture:Ul,collisionBox:ql,collisionCircle:tc,debug:rc,fill:Vh,fillOutline:os,fillOutlinePattern:ss,fillPattern:ic,fillExtrusion:an,fillExtrusionPattern:jl,hillshadePrepare:qa,hillshade:ja,line:ho,lineGradient:po,linePattern:Ga,lineSDF:fo,raster:mo,symbolIcon:Za,symbolSDF:nc,symbolTextAndIcon:ac}),Fs=function(){this.boundProgram=null,this.boundLayoutVertexBuffer=null,this.boundPaintVertexBuffers=[],this.boundIndexBuffer=null,this.boundVertexOffset=null,this.boundDynamicVertexBuffer=null,this.vao=null};function oc(n){for(var s=[],o=0;o<n.length;o++)if(n[o]!==null){var c=n[o].split(" ");s.push(c.pop())}return s}Fs.prototype.bind=function(n,s,o,c,v,w,S,E){this.context=n;for(var P=this.boundPaintVertexBuffers.length!==c.length,O=0;!P&&O<c.length;O++)this.boundPaintVertexBuffers[O]!==c[O]&&(P=!0);n.extVertexArrayObject&&this.vao&&this.boundProgram===s&&this.boundLayoutVertexBuffer===o&&!P&&this.boundIndexBuffer===v&&this.boundVertexOffset===w&&this.boundDynamicVertexBuffer===S&&this.boundDynamicVertexBuffer2===E?(n.bindVertexArrayOES.set(this.vao),S&&S.bind(),v&&v.dynamicDraw&&v.bind(),E&&E.bind()):this.freshBind(s,o,c,v,w,S,E)},Fs.prototype.freshBind=function(n,s,o,c,v,w,S){var E,P=n.numAttributes,O=this.context,G=O.gl;if(O.extVertexArrayObject)this.vao&&this.destroy(),this.vao=O.extVertexArrayObject.createVertexArrayOES(),O.bindVertexArrayOES.set(this.vao),E=0,this.boundProgram=n,this.boundLayoutVertexBuffer=s,this.boundPaintVertexBuffers=o,this.boundIndexBuffer=c,this.boundVertexOffset=v,this.boundDynamicVertexBuffer=w,this.boundDynamicVertexBuffer2=S;else{E=O.currentNumAttributes||0;for(var Z=P;Z<E;Z++)G.disableVertexAttribArray(Z)}s.enableAttributes(G,n);for(var H=0,te=o;H<te.length;H+=1)te[H].enableAttributes(G,n);w&&w.enableAttributes(G,n),S&&S.enableAttributes(G,n),s.bind(),s.setVertexAttribPointers(G,n,v);for(var ee=0,ce=o;ee<ce.length;ee+=1){var Y=ce[ee];Y.bind(),Y.setVertexAttribPointers(G,n,v)}w&&(w.bind(),w.setVertexAttribPointers(G,n,v)),c&&c.bind(),S&&(S.bind(),S.setVertexAttribPointers(G,n,v)),O.currentNumAttributes=P},Fs.prototype.destroy=function(){this.vao&&(this.context.extVertexArrayObject.deleteVertexArrayOES(this.vao),this.vao=null)};var sc=function(n,s,o,c,v,w){var S=n.gl;this.program=S.createProgram();for(var E=oc(o.staticAttributes),P=c?c.getBinderAttributes():[],O=E.concat(P),G=o.staticUniforms?oc(o.staticUniforms):[],Z=c?c.getBinderUniforms():[],H=[],te=0,ee=G.concat(Z);te<ee.length;te+=1){var ce=ee[te];H.indexOf(ce)<0&&H.push(ce)}var Y=c?c.defines():[];w&&Y.push("#define OVERDRAW_INSPECTOR;");var le=Y.concat(Oo.fragmentSource,o.fragmentSource).join(`
`),de=Y.concat(Oo.vertexSource,o.vertexSource).join(`
`),_e=S.createShader(S.FRAGMENT_SHADER);if(S.isContextLost())this.failedToCreate=!0;else{S.shaderSource(_e,le),S.compileShader(_e),S.attachShader(this.program,_e);var Ie=S.createShader(S.VERTEX_SHADER);if(S.isContextLost())this.failedToCreate=!0;else{S.shaderSource(Ie,de),S.compileShader(Ie),S.attachShader(this.program,Ie),this.attributes={};var Se={};this.numAttributes=O.length;for(var ze=0;ze<this.numAttributes;ze++)O[ze]&&(S.bindAttribLocation(this.program,ze,O[ze]),this.attributes[O[ze]]=ze);S.linkProgram(this.program),S.deleteShader(Ie),S.deleteShader(_e);for(var Fe=0;Fe<H.length;Fe++){var Ye=H[Fe];if(Ye&&!Se[Ye]){var Xe=S.getUniformLocation(this.program,Ye);Xe&&(Se[Ye]=Xe)}}this.fixedUniforms=v(n,Se),this.binderUniforms=c?c.getUniforms(n,Se):[]}}};function lc(n,s,o){var c=1/Pr(o,1,s.transform.tileZoom),v=Math.pow(2,o.tileID.overscaledZ),w=o.tileSize*Math.pow(2,s.transform.tileZoom)/v,S=w*(o.tileID.canonical.x+o.tileID.wrap*v),E=w*o.tileID.canonical.y;return{u_image:0,u_texsize:o.imageAtlasTexture.size,u_scale:[c,n.fromScale,n.toScale],u_fade:n.t,u_pixel_coord_upper:[S>>16,E>>16],u_pixel_coord_lower:[65535&S,65535&E]}}sc.prototype.draw=function(n,s,o,c,v,w,S,E,P,O,G,Z,H,te,ee,ce){var Y,le=n.gl;if(!this.failedToCreate){for(var de in n.program.set(this.program),n.setDepthMode(o),n.setStencilMode(c),n.setColorMode(v),n.setCullFace(w),this.fixedUniforms)this.fixedUniforms[de].set(S[de]);te&&te.setUniforms(n,this.binderUniforms,Z,{zoom:H});for(var _e=(Y={},Y[le.LINES]=2,Y[le.TRIANGLES]=3,Y[le.LINE_STRIP]=1,Y)[s],Ie=0,Se=G.get();Ie<Se.length;Ie+=1){var ze=Se[Ie],Fe=ze.vaos||(ze.vaos={});(Fe[E]||(Fe[E]=new Fs)).bind(n,this,P,te?te.getPaintVertexBuffers():[],O,ze.vertexOffset,ee,ce),le.drawElements(s,ze.primitiveLength*_e,le.UNSIGNED_SHORT,ze.primitiveOffset*_e*2)}}};var uc=function(n,s,o,c){var v=s.style.light,w=v.properties.get("position"),S=[w.x,w.y,w.z],E=a.create$1();v.properties.get("anchor")==="viewport"&&a.fromRotation(E,-s.transform.angle),a.transformMat3(S,S,E);var P=v.properties.get("color");return{u_matrix:n,u_lightpos:S,u_lightintensity:v.properties.get("intensity"),u_lightcolor:[P.r,P.g,P.b],u_vertical_gradient:+o,u_opacity:c}},yo=function(n,s,o,c,v,w,S){return a.extend(uc(n,s,o,c),lc(w,s,S),{u_height_factor:-Math.pow(2,v.overscaledZ)/S.tileSize/8})},Ka=function(n){return{u_matrix:n}},go=function(n,s,o,c){return a.extend(Ka(n),lc(o,s,c))},cc=function(n,s){return{u_matrix:n,u_world:s}},hc=function(n,s,o,c,v){return a.extend(go(n,s,o,c),{u_world:v})},Gl=function(n,s,o,c){var v,w,S=n.transform;if(c.paint.get("circle-pitch-alignment")==="map"){var E=Pr(o,1,S.zoom);v=!0,w=[E,E]}else v=!1,w=S.pixelsToGLUnits;return{u_camera_to_center_distance:S.cameraToCenterDistance,u_scale_with_map:+(c.paint.get("circle-pitch-scale")==="map"),u_matrix:n.translatePosMatrix(s.posMatrix,o,c.paint.get("circle-translate"),c.paint.get("circle-translate-anchor")),u_pitch_with_map:+v,u_device_pixel_ratio:a.browser.devicePixelRatio,u_extrude_scale:w}},_o=function(n,s,o){var c=Pr(o,1,s.zoom),v=Math.pow(2,s.zoom-o.tileID.overscaledZ),w=o.tileID.overscaleFactor();return{u_matrix:n,u_camera_to_center_distance:s.cameraToCenterDistance,u_pixels_to_tile_units:c,u_extrude_scale:[s.pixelsToGLUnits[0]/(c*v),s.pixelsToGLUnits[1]/(c*v)],u_overscale_factor:w}},pc=function(n,s,o){return{u_matrix:n,u_inv_matrix:s,u_camera_to_center_distance:o.cameraToCenterDistance,u_viewport_size:[o.width,o.height]}},vo=function(n,s,o){return o===void 0&&(o=1),{u_matrix:n,u_color:s,u_overlay:0,u_overlay_scale:o}},bo=function(n){return{u_matrix:n}},fc=function(n,s,o,c){return{u_matrix:n,u_extrude_scale:Pr(s,1,o),u_intensity:c}},ls=function(n,s,o){var c=n.transform;return{u_matrix:dc(n,s,o),u_ratio:1/Pr(s,1,c.zoom),u_device_pixel_ratio:a.browser.devicePixelRatio,u_units_to_pixels:[1/c.pixelsToGLUnits[0],1/c.pixelsToGLUnits[1]]}},Fr=function(n,s,o,c){return a.extend(ls(n,s,o),{u_image:0,u_image_height:c})},Ns=function(n,s,o,c){var v=n.transform,w=Fo(s,v);return{u_matrix:dc(n,s,o),u_texsize:s.imageAtlasTexture.size,u_ratio:1/Pr(s,1,v.zoom),u_device_pixel_ratio:a.browser.devicePixelRatio,u_image:0,u_scale:[w,c.fromScale,c.toScale],u_fade:c.t,u_units_to_pixels:[1/v.pixelsToGLUnits[0],1/v.pixelsToGLUnits[1]]}},qh=function(n,s,o,c,v){var w=n.lineAtlas,S=Fo(s,n.transform),E=o.layout.get("line-cap")==="round",P=w.getDash(c.from,E),O=w.getDash(c.to,E),G=P.width*v.fromScale,Z=O.width*v.toScale;return a.extend(ls(n,s,o),{u_patternscale_a:[S/G,-P.height/2],u_patternscale_b:[S/Z,-O.height/2],u_sdfgamma:w.width/(256*Math.min(G,Z)*a.browser.devicePixelRatio)/2,u_image:0,u_tex_y_a:P.y,u_tex_y_b:O.y,u_mix:v.t})};function Fo(n,s){return 1/Pr(n,1,s.tileZoom)}function dc(n,s,o){return n.translatePosMatrix(s.tileID.posMatrix,s,o.paint.get("line-translate"),o.paint.get("line-translate-anchor"))}var jh=function(n,s,o,c,v){return{u_matrix:n,u_tl_parent:s,u_scale_parent:o,u_buffer_scale:1,u_fade_t:c.mix,u_opacity:c.opacity*v.paint.get("raster-opacity"),u_image0:0,u_image1:1,u_brightness_low:v.paint.get("raster-brightness-min"),u_brightness_high:v.paint.get("raster-brightness-max"),u_saturation_factor:(S=v.paint.get("raster-saturation"),S>0?1-1/(1.001-S):-S),u_contrast_factor:(w=v.paint.get("raster-contrast"),w>0?1/(1-w):1+w),u_spin_weights:mc(v.paint.get("raster-hue-rotate"))};var w,S};function mc(n){n*=Math.PI/180;var s=Math.sin(n),o=Math.cos(n);return[(2*o+1)/3,(-Math.sqrt(3)*s-o+1)/3,(Math.sqrt(3)*s-o+1)/3]}var Vs,No=function(n,s,o,c,v,w,S,E,P,O){var G=v.transform;return{u_is_size_zoom_constant:+(n==="constant"||n==="source"),u_is_size_feature_constant:+(n==="constant"||n==="camera"),u_size_t:s?s.uSizeT:0,u_size:s?s.uSize:0,u_camera_to_center_distance:G.cameraToCenterDistance,u_pitch:G.pitch/360*2*Math.PI,u_rotate_symbol:+o,u_aspect_ratio:G.width/G.height,u_fade_change:v.options.fadeDuration?v.symbolFadeChange:1,u_matrix:w,u_label_plane_matrix:S,u_coord_matrix:E,u_is_text:+P,u_pitch_with_map:+c,u_texsize:O,u_texture:0}},us=function(n,s,o,c,v,w,S,E,P,O,G){var Z=v.transform;return a.extend(No(n,s,o,c,v,w,S,E,P,O),{u_gamma_scale:c?Math.cos(Z._pitch)*Z.cameraToCenterDistance:1,u_device_pixel_ratio:a.browser.devicePixelRatio,u_is_halo:+G})},Us=function(n,s,o,c,v,w,S,E,P,O){return a.extend(us(n,s,o,c,v,w,S,E,!0,P,!0),{u_texsize_icon:O,u_texture_icon:1})},cs=function(n,s,o){return{u_matrix:n,u_opacity:s,u_color:o}},Vo=function(n,s,o,c,v,w){return a.extend(function(S,E,P,O){var G=P.imageManager.getPattern(S.from.toString()),Z=P.imageManager.getPattern(S.to.toString()),H=P.imageManager.getPixelSize(),te=H.width,ee=H.height,ce=Math.pow(2,O.tileID.overscaledZ),Y=O.tileSize*Math.pow(2,P.transform.tileZoom)/ce,le=Y*(O.tileID.canonical.x+O.tileID.wrap*ce),de=Y*O.tileID.canonical.y;return{u_image:0,u_pattern_tl_a:G.tl,u_pattern_br_a:G.br,u_pattern_tl_b:Z.tl,u_pattern_br_b:Z.br,u_texsize:[te,ee],u_mix:E.t,u_pattern_size_a:G.displaySize,u_pattern_size_b:Z.displaySize,u_scale_a:E.fromScale,u_scale_b:E.toScale,u_tile_units_to_pixels:1/Pr(O,1,P.transform.tileZoom),u_pixel_coord_upper:[le>>16,de>>16],u_pixel_coord_lower:[65535&le,65535&de]}}(c,w,o,v),{u_matrix:n,u_opacity:s})},yc={fillExtrusion:function(n,s){return{u_matrix:new a.UniformMatrix4f(n,s.u_matrix),u_lightpos:new a.Uniform3f(n,s.u_lightpos),u_lightintensity:new a.Uniform1f(n,s.u_lightintensity),u_lightcolor:new a.Uniform3f(n,s.u_lightcolor),u_vertical_gradient:new a.Uniform1f(n,s.u_vertical_gradient),u_opacity:new a.Uniform1f(n,s.u_opacity)}},fillExtrusionPattern:function(n,s){return{u_matrix:new a.UniformMatrix4f(n,s.u_matrix),u_lightpos:new a.Uniform3f(n,s.u_lightpos),u_lightintensity:new a.Uniform1f(n,s.u_lightintensity),u_lightcolor:new a.Uniform3f(n,s.u_lightcolor),u_vertical_gradient:new a.Uniform1f(n,s.u_vertical_gradient),u_height_factor:new a.Uniform1f(n,s.u_height_factor),u_image:new a.Uniform1i(n,s.u_image),u_texsize:new a.Uniform2f(n,s.u_texsize),u_pixel_coord_upper:new a.Uniform2f(n,s.u_pixel_coord_upper),u_pixel_coord_lower:new a.Uniform2f(n,s.u_pixel_coord_lower),u_scale:new a.Uniform3f(n,s.u_scale),u_fade:new a.Uniform1f(n,s.u_fade),u_opacity:new a.Uniform1f(n,s.u_opacity)}},fill:function(n,s){return{u_matrix:new a.UniformMatrix4f(n,s.u_matrix)}},fillPattern:function(n,s){return{u_matrix:new a.UniformMatrix4f(n,s.u_matrix),u_image:new a.Uniform1i(n,s.u_image),u_texsize:new a.Uniform2f(n,s.u_texsize),u_pixel_coord_upper:new a.Uniform2f(n,s.u_pixel_coord_upper),u_pixel_coord_lower:new a.Uniform2f(n,s.u_pixel_coord_lower),u_scale:new a.Uniform3f(n,s.u_scale),u_fade:new a.Uniform1f(n,s.u_fade)}},fillOutline:function(n,s){return{u_matrix:new a.UniformMatrix4f(n,s.u_matrix),u_world:new a.Uniform2f(n,s.u_world)}},fillOutlinePattern:function(n,s){return{u_matrix:new a.UniformMatrix4f(n,s.u_matrix),u_world:new a.Uniform2f(n,s.u_world),u_image:new a.Uniform1i(n,s.u_image),u_texsize:new a.Uniform2f(n,s.u_texsize),u_pixel_coord_upper:new a.Uniform2f(n,s.u_pixel_coord_upper),u_pixel_coord_lower:new a.Uniform2f(n,s.u_pixel_coord_lower),u_scale:new a.Uniform3f(n,s.u_scale),u_fade:new a.Uniform1f(n,s.u_fade)}},circle:function(n,s){return{u_camera_to_center_distance:new a.Uniform1f(n,s.u_camera_to_center_distance),u_scale_with_map:new a.Uniform1i(n,s.u_scale_with_map),u_pitch_with_map:new a.Uniform1i(n,s.u_pitch_with_map),u_extrude_scale:new a.Uniform2f(n,s.u_extrude_scale),u_device_pixel_ratio:new a.Uniform1f(n,s.u_device_pixel_ratio),u_matrix:new a.UniformMatrix4f(n,s.u_matrix)}},collisionBox:function(n,s){return{u_matrix:new a.UniformMatrix4f(n,s.u_matrix),u_camera_to_center_distance:new a.Uniform1f(n,s.u_camera_to_center_distance),u_pixels_to_tile_units:new a.Uniform1f(n,s.u_pixels_to_tile_units),u_extrude_scale:new a.Uniform2f(n,s.u_extrude_scale),u_overscale_factor:new a.Uniform1f(n,s.u_overscale_factor)}},collisionCircle:function(n,s){return{u_matrix:new a.UniformMatrix4f(n,s.u_matrix),u_inv_matrix:new a.UniformMatrix4f(n,s.u_inv_matrix),u_camera_to_center_distance:new a.Uniform1f(n,s.u_camera_to_center_distance),u_viewport_size:new a.Uniform2f(n,s.u_viewport_size)}},debug:function(n,s){return{u_color:new a.UniformColor(n,s.u_color),u_matrix:new a.UniformMatrix4f(n,s.u_matrix),u_overlay:new a.Uniform1i(n,s.u_overlay),u_overlay_scale:new a.Uniform1f(n,s.u_overlay_scale)}},clippingMask:function(n,s){return{u_matrix:new a.UniformMatrix4f(n,s.u_matrix)}},heatmap:function(n,s){return{u_extrude_scale:new a.Uniform1f(n,s.u_extrude_scale),u_intensity:new a.Uniform1f(n,s.u_intensity),u_matrix:new a.UniformMatrix4f(n,s.u_matrix)}},heatmapTexture:function(n,s){return{u_matrix:new a.UniformMatrix4f(n,s.u_matrix),u_world:new a.Uniform2f(n,s.u_world),u_image:new a.Uniform1i(n,s.u_image),u_color_ramp:new a.Uniform1i(n,s.u_color_ramp),u_opacity:new a.Uniform1f(n,s.u_opacity)}},hillshade:function(n,s){return{u_matrix:new a.UniformMatrix4f(n,s.u_matrix),u_image:new a.Uniform1i(n,s.u_image),u_latrange:new a.Uniform2f(n,s.u_latrange),u_light:new a.Uniform2f(n,s.u_light),u_shadow:new a.UniformColor(n,s.u_shadow),u_highlight:new a.UniformColor(n,s.u_highlight),u_accent:new a.UniformColor(n,s.u_accent)}},hillshadePrepare:function(n,s){return{u_matrix:new a.UniformMatrix4f(n,s.u_matrix),u_image:new a.Uniform1i(n,s.u_image),u_dimension:new a.Uniform2f(n,s.u_dimension),u_zoom:new a.Uniform1f(n,s.u_zoom),u_unpack:new a.Uniform4f(n,s.u_unpack)}},line:function(n,s){return{u_matrix:new a.UniformMatrix4f(n,s.u_matrix),u_ratio:new a.Uniform1f(n,s.u_ratio),u_device_pixel_ratio:new a.Uniform1f(n,s.u_device_pixel_ratio),u_units_to_pixels:new a.Uniform2f(n,s.u_units_to_pixels)}},lineGradient:function(n,s){return{u_matrix:new a.UniformMatrix4f(n,s.u_matrix),u_ratio:new a.Uniform1f(n,s.u_ratio),u_device_pixel_ratio:new a.Uniform1f(n,s.u_device_pixel_ratio),u_units_to_pixels:new a.Uniform2f(n,s.u_units_to_pixels),u_image:new a.Uniform1i(n,s.u_image),u_image_height:new a.Uniform1f(n,s.u_image_height)}},linePattern:function(n,s){return{u_matrix:new a.UniformMatrix4f(n,s.u_matrix),u_texsize:new a.Uniform2f(n,s.u_texsize),u_ratio:new a.Uniform1f(n,s.u_ratio),u_device_pixel_ratio:new a.Uniform1f(n,s.u_device_pixel_ratio),u_image:new a.Uniform1i(n,s.u_image),u_units_to_pixels:new a.Uniform2f(n,s.u_units_to_pixels),u_scale:new a.Uniform3f(n,s.u_scale),u_fade:new a.Uniform1f(n,s.u_fade)}},lineSDF:function(n,s){return{u_matrix:new a.UniformMatrix4f(n,s.u_matrix),u_ratio:new a.Uniform1f(n,s.u_ratio),u_device_pixel_ratio:new a.Uniform1f(n,s.u_device_pixel_ratio),u_units_to_pixels:new a.Uniform2f(n,s.u_units_to_pixels),u_patternscale_a:new a.Uniform2f(n,s.u_patternscale_a),u_patternscale_b:new a.Uniform2f(n,s.u_patternscale_b),u_sdfgamma:new a.Uniform1f(n,s.u_sdfgamma),u_image:new a.Uniform1i(n,s.u_image),u_tex_y_a:new a.Uniform1f(n,s.u_tex_y_a),u_tex_y_b:new a.Uniform1f(n,s.u_tex_y_b),u_mix:new a.Uniform1f(n,s.u_mix)}},raster:function(n,s){return{u_matrix:new a.UniformMatrix4f(n,s.u_matrix),u_tl_parent:new a.Uniform2f(n,s.u_tl_parent),u_scale_parent:new a.Uniform1f(n,s.u_scale_parent),u_buffer_scale:new a.Uniform1f(n,s.u_buffer_scale),u_fade_t:new a.Uniform1f(n,s.u_fade_t),u_opacity:new a.Uniform1f(n,s.u_opacity),u_image0:new a.Uniform1i(n,s.u_image0),u_image1:new a.Uniform1i(n,s.u_image1),u_brightness_low:new a.Uniform1f(n,s.u_brightness_low),u_brightness_high:new a.Uniform1f(n,s.u_brightness_high),u_saturation_factor:new a.Uniform1f(n,s.u_saturation_factor),u_contrast_factor:new a.Uniform1f(n,s.u_contrast_factor),u_spin_weights:new a.Uniform3f(n,s.u_spin_weights)}},symbolIcon:function(n,s){return{u_is_size_zoom_constant:new a.Uniform1i(n,s.u_is_size_zoom_constant),u_is_size_feature_constant:new a.Uniform1i(n,s.u_is_size_feature_constant),u_size_t:new a.Uniform1f(n,s.u_size_t),u_size:new a.Uniform1f(n,s.u_size),u_camera_to_center_distance:new a.Uniform1f(n,s.u_camera_to_center_distance),u_pitch:new a.Uniform1f(n,s.u_pitch),u_rotate_symbol:new a.Uniform1i(n,s.u_rotate_symbol),u_aspect_ratio:new a.Uniform1f(n,s.u_aspect_ratio),u_fade_change:new a.Uniform1f(n,s.u_fade_change),u_matrix:new a.UniformMatrix4f(n,s.u_matrix),u_label_plane_matrix:new a.UniformMatrix4f(n,s.u_label_plane_matrix),u_coord_matrix:new a.UniformMatrix4f(n,s.u_coord_matrix),u_is_text:new a.Uniform1i(n,s.u_is_text),u_pitch_with_map:new a.Uniform1i(n,s.u_pitch_with_map),u_texsize:new a.Uniform2f(n,s.u_texsize),u_texture:new a.Uniform1i(n,s.u_texture)}},symbolSDF:function(n,s){return{u_is_size_zoom_constant:new a.Uniform1i(n,s.u_is_size_zoom_constant),u_is_size_feature_constant:new a.Uniform1i(n,s.u_is_size_feature_constant),u_size_t:new a.Uniform1f(n,s.u_size_t),u_size:new a.Uniform1f(n,s.u_size),u_camera_to_center_distance:new a.Uniform1f(n,s.u_camera_to_center_distance),u_pitch:new a.Uniform1f(n,s.u_pitch),u_rotate_symbol:new a.Uniform1i(n,s.u_rotate_symbol),u_aspect_ratio:new a.Uniform1f(n,s.u_aspect_ratio),u_fade_change:new a.Uniform1f(n,s.u_fade_change),u_matrix:new a.UniformMatrix4f(n,s.u_matrix),u_label_plane_matrix:new a.UniformMatrix4f(n,s.u_label_plane_matrix),u_coord_matrix:new a.UniformMatrix4f(n,s.u_coord_matrix),u_is_text:new a.Uniform1i(n,s.u_is_text),u_pitch_with_map:new a.Uniform1i(n,s.u_pitch_with_map),u_texsize:new a.Uniform2f(n,s.u_texsize),u_texture:new a.Uniform1i(n,s.u_texture),u_gamma_scale:new a.Uniform1f(n,s.u_gamma_scale),u_device_pixel_ratio:new a.Uniform1f(n,s.u_device_pixel_ratio),u_is_halo:new a.Uniform1i(n,s.u_is_halo)}},symbolTextAndIcon:function(n,s){return{u_is_size_zoom_constant:new a.Uniform1i(n,s.u_is_size_zoom_constant),u_is_size_feature_constant:new a.Uniform1i(n,s.u_is_size_feature_constant),u_size_t:new a.Uniform1f(n,s.u_size_t),u_size:new a.Uniform1f(n,s.u_size),u_camera_to_center_distance:new a.Uniform1f(n,s.u_camera_to_center_distance),u_pitch:new a.Uniform1f(n,s.u_pitch),u_rotate_symbol:new a.Uniform1i(n,s.u_rotate_symbol),u_aspect_ratio:new a.Uniform1f(n,s.u_aspect_ratio),u_fade_change:new a.Uniform1f(n,s.u_fade_change),u_matrix:new a.UniformMatrix4f(n,s.u_matrix),u_label_plane_matrix:new a.UniformMatrix4f(n,s.u_label_plane_matrix),u_coord_matrix:new a.UniformMatrix4f(n,s.u_coord_matrix),u_is_text:new a.Uniform1i(n,s.u_is_text),u_pitch_with_map:new a.Uniform1i(n,s.u_pitch_with_map),u_texsize:new a.Uniform2f(n,s.u_texsize),u_texsize_icon:new a.Uniform2f(n,s.u_texsize_icon),u_texture:new a.Uniform1i(n,s.u_texture),u_texture_icon:new a.Uniform1i(n,s.u_texture_icon),u_gamma_scale:new a.Uniform1f(n,s.u_gamma_scale),u_device_pixel_ratio:new a.Uniform1f(n,s.u_device_pixel_ratio),u_is_halo:new a.Uniform1i(n,s.u_is_halo)}},background:function(n,s){return{u_matrix:new a.UniformMatrix4f(n,s.u_matrix),u_opacity:new a.Uniform1f(n,s.u_opacity),u_color:new a.UniformColor(n,s.u_color)}},backgroundPattern:function(n,s){return{u_matrix:new a.UniformMatrix4f(n,s.u_matrix),u_opacity:new a.Uniform1f(n,s.u_opacity),u_image:new a.Uniform1i(n,s.u_image),u_pattern_tl_a:new a.Uniform2f(n,s.u_pattern_tl_a),u_pattern_br_a:new a.Uniform2f(n,s.u_pattern_br_a),u_pattern_tl_b:new a.Uniform2f(n,s.u_pattern_tl_b),u_pattern_br_b:new a.Uniform2f(n,s.u_pattern_br_b),u_texsize:new a.Uniform2f(n,s.u_texsize),u_mix:new a.Uniform1f(n,s.u_mix),u_pattern_size_a:new a.Uniform2f(n,s.u_pattern_size_a),u_pattern_size_b:new a.Uniform2f(n,s.u_pattern_size_b),u_scale_a:new a.Uniform1f(n,s.u_scale_a),u_scale_b:new a.Uniform1f(n,s.u_scale_b),u_pixel_coord_upper:new a.Uniform2f(n,s.u_pixel_coord_upper),u_pixel_coord_lower:new a.Uniform2f(n,s.u_pixel_coord_lower),u_tile_units_to_pixels:new a.Uniform1f(n,s.u_tile_units_to_pixels)}}};function Uo(n,s,o,c,v,w,S){for(var E=n.context,P=E.gl,O=n.useProgram("collisionBox"),G=[],Z=0,H=0,te=0;te<c.length;te++){var ee=c[te],ce=s.getTile(ee),Y=ce.getBucket(o);if(Y){var le=ee.posMatrix;v[0]===0&&v[1]===0||(le=n.translatePosMatrix(ee.posMatrix,ce,v,w));var de=S?Y.textCollisionBox:Y.iconCollisionBox,_e=Y.collisionCircleArray;if(_e.length>0){var Ie=a.create(),Se=le;a.mul(Ie,Y.placementInvProjMatrix,n.transform.glCoordMatrix),a.mul(Ie,Ie,Y.placementViewportMatrix),G.push({circleArray:_e,circleOffset:H,transform:Se,invTransform:Ie}),H=Z+=_e.length/4}de&&O.draw(E,P.LINES,K.disabled,W.disabled,n.colorModeForRenderPass(),fe.disabled,_o(le,n.transform,ce),o.id,de.layoutVertexBuffer,de.indexBuffer,de.segments,null,n.transform.zoom,null,null,de.collisionVertexBuffer)}}if(S&&G.length){var ze=n.useProgram("collisionCircle"),Fe=new a.StructArrayLayout2f1f2i16;Fe.resize(4*Z),Fe._trim();for(var Ye=0,Xe=0,pt=G;Xe<pt.length;Xe+=1)for(var Et=pt[Xe],Pt=0;Pt<Et.circleArray.length/4;Pt++){var At=4*Pt,_r=Et.circleArray[At+0],ft=Et.circleArray[At+1],Nt=Et.circleArray[At+2],Yt=Et.circleArray[At+3];Fe.emplace(Ye++,_r,ft,Nt,Yt,0),Fe.emplace(Ye++,_r,ft,Nt,Yt,1),Fe.emplace(Ye++,_r,ft,Nt,Yt,2),Fe.emplace(Ye++,_r,ft,Nt,Yt,3)}(!Vs||Vs.length<2*Z)&&(Vs=function(ui){var pn=2*ui,Wi=new a.StructArrayLayout3ui6;Wi.resize(pn),Wi._trim();for(var ii=0;ii<pn;ii++){var mi=6*ii;Wi.uint16[mi+0]=4*ii+0,Wi.uint16[mi+1]=4*ii+1,Wi.uint16[mi+2]=4*ii+2,Wi.uint16[mi+3]=4*ii+2,Wi.uint16[mi+4]=4*ii+3,Wi.uint16[mi+5]=4*ii+0}return Wi}(Z));for(var Ft=E.createIndexBuffer(Vs,!0),Ot=E.createVertexBuffer(Fe,a.collisionCircleLayout.members,!0),Xt=0,Lt=G;Xt<Lt.length;Xt+=1){var Ct=Lt[Xt],Fi=pc(Ct.transform,Ct.invTransform,n.transform);ze.draw(E,P.TRIANGLES,K.disabled,W.disabled,n.colorModeForRenderPass(),fe.disabled,Fi,o.id,Ot,Ft,a.SegmentVector.simpleSegment(0,2*Ct.circleOffset,Ct.circleArray.length,Ct.circleArray.length/2),null,n.transform.zoom,null,null,null)}Ot.destroy(),Ft.destroy()}}var fa=a.identity(new Float32Array(16));function gc(n,s,o,c,v,w){var S=a.getAnchorAlignment(n),E=-(S.horizontalAlign-.5)*s,P=-(S.verticalAlign-.5)*o,O=a.evaluateVariableOffset(n,c);return new a.Point((E/v+O[0])*w,(P/v+O[1])*w)}function _c(n,s,o,c,v,w,S,E,P,O,G){var Z=n.text.placedSymbolArray,H=n.text.dynamicLayoutVertexArray,te=n.icon.dynamicLayoutVertexArray,ee={};H.clear();for(var ce=0;ce<Z.length;ce++){var Y=Z.get(ce),le=Y.hidden||!Y.crossTileID||n.allowVerticalPlacement&&!Y.placedOrientation?null:c[Y.crossTileID];if(le){var de=new a.Point(Y.anchorX,Y.anchorY),_e=Qt(de,o?E:S),Ie=dr(w.cameraToCenterDistance,_e.signedDistanceFromCamera),Se=v.evaluateSizeForFeature(n.textSizeData,O,Y)*Ie/a.ONE_EM;o&&(Se*=n.tilePixelRatio/P);for(var ze=gc(le.anchor,le.width,le.height,le.textOffset,le.textBoxScale,Se),Fe=o?Qt(de.add(ze),S).point:_e.point.add(s?ze.rotate(-w.angle):ze),Ye=n.allowVerticalPlacement&&Y.placedOrientation===a.WritingMode.vertical?Math.PI/2:0,Xe=0;Xe<Y.numGlyphs;Xe++)a.addDynamicAttributes(H,Fe,Ye);G&&Y.associatedIconIndex>=0&&(ee[Y.associatedIconIndex]={shiftedAnchor:Fe,angle:Ye})}else Ai(Y.numGlyphs,H)}if(G){te.clear();for(var pt=n.icon.placedSymbolArray,Et=0;Et<pt.length;Et++){var Pt=pt.get(Et);if(Pt.hidden)Ai(Pt.numGlyphs,te);else{var At=ee[Et];if(At)for(var _r=0;_r<Pt.numGlyphs;_r++)a.addDynamicAttributes(te,At.shiftedAnchor,At.angle);else Ai(Pt.numGlyphs,te)}}n.icon.dynamicLayoutVertexBuffer.updateData(te)}n.text.dynamicLayoutVertexBuffer.updateData(H)}function vc(n,s,o){return o.iconsInText&&s?"symbolTextAndIcon":n?"symbolSDF":"symbolIcon"}function xo(n,s,o,c,v,w,S,E,P,O,G,Z){for(var H=n.context,te=H.gl,ee=n.transform,ce=E==="map",Y=P==="map",le=ce&&o.layout.get("symbol-placement")!=="point",de=ce&&!Y&&!le,_e=o.layout.get("symbol-sort-key").constantOr(1)!==void 0,Ie=!1,Se=n.depthModeForSublayer(0,K.ReadOnly),ze=o.layout.get("text-variable-anchor"),Fe=[],Ye=0,Xe=c;Ye<Xe.length;Ye+=1){var pt=Xe[Ye],Et=s.getTile(pt),Pt=Et.getBucket(o);if(Pt){var At=v?Pt.text:Pt.icon;if(At&&At.segments.get().length){var _r=At.programConfigurations.get(o.id),ft=v||Pt.sdfIcons,Nt=v?Pt.textSizeData:Pt.iconSizeData,Yt=Y||ee.pitch!==0,Ft=n.useProgram(vc(ft,v,Pt),_r),Ot=a.evaluateSizeForZoom(Nt,ee.zoom),Xt=void 0,Lt=[0,0],Ct=void 0,Fi=void 0,ui=null,pn=void 0;if(v)Ct=Et.glyphAtlasTexture,Fi=te.LINEAR,Xt=Et.glyphAtlasTexture.size,Pt.iconsInText&&(Lt=Et.imageAtlasTexture.size,ui=Et.imageAtlasTexture,pn=Yt||n.options.rotating||n.options.zooming||Nt.kind==="composite"||Nt.kind==="camera"?te.LINEAR:te.NEAREST);else{var Wi=o.layout.get("icon-size").constantOr(0)!==1||Pt.iconsNeedLinear;Ct=Et.imageAtlasTexture,Fi=ft||n.options.rotating||n.options.zooming||Wi||Yt?te.LINEAR:te.NEAREST,Xt=Et.imageAtlasTexture.size}var ii=Pr(Et,1,n.transform.zoom),mi=Or(pt.posMatrix,Y,ce,n.transform,ii),jn=br(pt.posMatrix,Y,ce,n.transform,ii),xn=ze&&Pt.hasTextData(),Qa=o.layout.get("icon-text-fit")!=="none"&&xn&&Pt.hasIconData();le&&pa(Pt,pt.posMatrix,n,v,mi,jn,Y,O);var zn=n.translatePosMatrix(pt.posMatrix,Et,w,S),_a=le||v&&ze||Qa?fa:mi,oa=n.translatePosMatrix(jn,Et,w,S,!0),ws=ft&&o.paint.get(v?"text-halo-width":"icon-halo-width").constantOr(1)!==0,Ho={program:Ft,buffers:At,uniformValues:ft?Pt.iconsInText?Us(Nt.kind,Ot,de,Y,n,zn,_a,oa,Xt,Lt):us(Nt.kind,Ot,de,Y,n,zn,_a,oa,v,Xt,!0):No(Nt.kind,Ot,de,Y,n,zn,_a,oa,v,Xt),atlasTexture:Ct,atlasTextureIcon:ui,atlasInterpolation:Fi,atlasInterpolationIcon:pn,isSDF:ft,hasHalo:ws};if(_e&&Pt.canOverlap){Ie=!0;for(var $a=0,Xo=At.segments.get();$a<Xo.length;$a+=1){var Ss=Xo[$a];Fe.push({segments:new a.SegmentVector([Ss]),sortKey:Ss.sortKey,state:Ho})}}else Fe.push({segments:At.segments,sortKey:0,state:Ho})}}}Ie&&Fe.sort(function(eo,Io){return eo.sortKey-Io.sortKey});for(var Aa=0,ks=Fe;Aa<ks.length;Aa+=1){var za=ks[Aa],Ni=za.state;if(H.activeTexture.set(te.TEXTURE0),Ni.atlasTexture.bind(Ni.atlasInterpolation,te.CLAMP_TO_EDGE),Ni.atlasTextureIcon&&(H.activeTexture.set(te.TEXTURE1),Ni.atlasTextureIcon&&Ni.atlasTextureIcon.bind(Ni.atlasInterpolationIcon,te.CLAMP_TO_EDGE)),Ni.isSDF){var La=Ni.uniformValues;Ni.hasHalo&&(La.u_is_halo=1,hs(Ni.buffers,za.segments,o,n,Ni.program,Se,G,Z,La)),La.u_is_halo=0}hs(Ni.buffers,za.segments,o,n,Ni.program,Se,G,Z,Ni.uniformValues)}}function hs(n,s,o,c,v,w,S,E,P){var O=c.context;v.draw(O,O.gl.TRIANGLES,w,S,E,fe.disabled,P,o.id,n.layoutVertexBuffer,n.indexBuffer,s,o.paint,c.transform.zoom,n.programConfigurations.get(o.id),n.dynamicLayoutVertexBuffer,n.opacityVertexBuffer)}function qs(n,s,o,c,v,w,S){var E,P,O,G,Z,H=n.context.gl,te=o.paint.get("fill-pattern"),ee=te&&te.constantOr(1),ce=o.getCrossfadeParameters();S?(P=ee&&!o.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline",E=H.LINES):(P=ee?"fillPattern":"fill",E=H.TRIANGLES);for(var Y=0,le=c;Y<le.length;Y+=1){var de=le[Y],_e=s.getTile(de);if(!ee||_e.patternsLoaded()){var Ie=_e.getBucket(o);if(Ie){var Se=Ie.programConfigurations.get(o.id),ze=n.useProgram(P,Se);ee&&(n.context.activeTexture.set(H.TEXTURE0),_e.imageAtlasTexture.bind(H.LINEAR,H.CLAMP_TO_EDGE),Se.updatePaintBuffers(ce));var Fe=te.constantOr(null);if(Fe&&_e.imageAtlas){var Ye=_e.imageAtlas,Xe=Ye.patternPositions[Fe.to.toString()],pt=Ye.patternPositions[Fe.from.toString()];Xe&&pt&&Se.setConstantPatternPositions(Xe,pt)}var Et=n.translatePosMatrix(de.posMatrix,_e,o.paint.get("fill-translate"),o.paint.get("fill-translate-anchor"));if(S){G=Ie.indexBuffer2,Z=Ie.segments2;var Pt=[H.drawingBufferWidth,H.drawingBufferHeight];O=P==="fillOutlinePattern"&&ee?hc(Et,n,ce,_e,Pt):cc(Et,Pt)}else G=Ie.indexBuffer,Z=Ie.segments,O=ee?go(Et,n,ce,_e):Ka(Et);ze.draw(n.context,E,v,n.stencilModeForClipping(de),w,fe.disabled,O,o.id,Ie.layoutVertexBuffer,G,Z,o.paint,n.transform.zoom,Se)}}}}function Zl(n,s,o,c,v,w,S){for(var E=n.context,P=E.gl,O=o.paint.get("fill-extrusion-pattern"),G=O.constantOr(1),Z=o.getCrossfadeParameters(),H=o.paint.get("fill-extrusion-opacity"),te=0,ee=c;te<ee.length;te+=1){var ce=ee[te],Y=s.getTile(ce),le=Y.getBucket(o);if(le){var de=le.programConfigurations.get(o.id),_e=n.useProgram(G?"fillExtrusionPattern":"fillExtrusion",de);G&&(n.context.activeTexture.set(P.TEXTURE0),Y.imageAtlasTexture.bind(P.LINEAR,P.CLAMP_TO_EDGE),de.updatePaintBuffers(Z));var Ie=O.constantOr(null);if(Ie&&Y.imageAtlas){var Se=Y.imageAtlas,ze=Se.patternPositions[Ie.to.toString()],Fe=Se.patternPositions[Ie.from.toString()];ze&&Fe&&de.setConstantPatternPositions(ze,Fe)}var Ye=n.translatePosMatrix(ce.posMatrix,Y,o.paint.get("fill-extrusion-translate"),o.paint.get("fill-extrusion-translate-anchor")),Xe=o.paint.get("fill-extrusion-vertical-gradient"),pt=G?yo(Ye,n,Xe,H,ce,Z,Y):uc(Ye,n,Xe,H);_e.draw(E,E.gl.TRIANGLES,v,w,S,fe.backCCW,pt,o.id,le.layoutVertexBuffer,le.indexBuffer,le.segments,o.paint,n.transform.zoom,de)}}}function js(n,s,o,c,v,w){var S=n.context,E=S.gl,P=s.fbo;if(P){var O=n.useProgram("hillshade");S.activeTexture.set(E.TEXTURE0),E.bindTexture(E.TEXTURE_2D,P.colorAttachment.get());var G=function(Z,H,te){var ee=te.paint.get("hillshade-shadow-color"),ce=te.paint.get("hillshade-highlight-color"),Y=te.paint.get("hillshade-accent-color"),le=te.paint.get("hillshade-illumination-direction")*(Math.PI/180);te.paint.get("hillshade-illumination-anchor")==="viewport"&&(le-=Z.transform.angle);var de,_e,Ie,Se=!Z.options.moving;return{u_matrix:Z.transform.calculatePosMatrix(H.tileID.toUnwrapped(),Se),u_image:0,u_latrange:(de=H.tileID,_e=Math.pow(2,de.canonical.z),Ie=de.canonical.y,[new a.MercatorCoordinate(0,Ie/_e).toLngLat().lat,new a.MercatorCoordinate(0,(Ie+1)/_e).toLngLat().lat]),u_light:[te.paint.get("hillshade-exaggeration"),le],u_shadow:ee,u_highlight:ce,u_accent:Y}}(n,s,o);O.draw(S,E.TRIANGLES,c,v,w,fe.disabled,G,o.id,n.rasterBoundsBuffer,n.quadTriangleIndexBuffer,n.rasterBoundsSegments)}}function Gh(n,s,o,c,v,w){var S=n.context,E=S.gl,P=s.dem;if(P&&P.data){var O=P.dim,G=P.stride,Z=P.getPixels();if(S.activeTexture.set(E.TEXTURE1),S.pixelStoreUnpackPremultiplyAlpha.set(!1),s.demTexture=s.demTexture||n.getTileTexture(G),s.demTexture){var H=s.demTexture;H.update(Z,{premultiply:!1}),H.bind(E.NEAREST,E.CLAMP_TO_EDGE)}else s.demTexture=new a.Texture(S,Z,E.RGBA,{premultiply:!1}),s.demTexture.bind(E.NEAREST,E.CLAMP_TO_EDGE);S.activeTexture.set(E.TEXTURE0);var te=s.fbo;if(!te){var ee=new a.Texture(S,{width:O,height:O,data:null},E.RGBA);ee.bind(E.LINEAR,E.CLAMP_TO_EDGE),(te=s.fbo=S.createFramebuffer(O,O,!0)).colorAttachment.set(ee.texture)}S.bindFramebuffer.set(te.framebuffer),S.viewport.set([0,0,O,O]),n.useProgram("hillshadePrepare").draw(S,E.TRIANGLES,c,v,w,fe.disabled,function(ce,Y){var le=Y.stride,de=a.create();return a.ortho(de,0,a.EXTENT,-a.EXTENT,0,0,1),a.translate(de,de,[0,-a.EXTENT,0]),{u_matrix:de,u_image:1,u_dimension:[le,le],u_zoom:ce.overscaledZ,u_unpack:Y.getUnpackVector()}}(s.tileID,P),o.id,n.rasterBoundsBuffer,n.quadTriangleIndexBuffer,n.rasterBoundsSegments),s.needsHillshadePrepare=!1}}function Gs(n,s,o,c,v){var w=c.paint.get("raster-fade-duration");if(w>0){var S=a.browser.now(),E=(S-n.timeAdded)/w,P=s?(S-s.timeAdded)/w:-1,O=o.getSource(),G=v.coveringZoomLevel({tileSize:O.tileSize,roundZoom:O.roundZoom}),Z=!s||Math.abs(s.tileID.overscaledZ-G)>Math.abs(n.tileID.overscaledZ-G),H=Z&&n.refreshedUponExpiration?1:a.clamp(Z?E:1-P,0,1);return n.refreshedUponExpiration&&E>=1&&(n.refreshedUponExpiration=!1),s?{opacity:1,mix:1-H}:{opacity:H,mix:0}}return{opacity:1,mix:0}}var Kl=new a.Color(1,0,0,1),bc=new a.Color(0,1,0,1),xc=new a.Color(0,0,1,1),Zs=new a.Color(1,0,1,1),Hl=new a.Color(0,1,1,1);function Xl(n,s,o,c){ps(n,0,s+o/2,n.transform.width,o,c)}function Wl(n,s,o,c){ps(n,s-o/2,0,o,n.transform.height,c)}function ps(n,s,o,c,v,w){var S=n.context,E=S.gl;E.enable(E.SCISSOR_TEST),E.scissor(s*a.browser.devicePixelRatio,o*a.browser.devicePixelRatio,c*a.browser.devicePixelRatio,v*a.browser.devicePixelRatio),S.clear({color:w}),E.disable(E.SCISSOR_TEST)}function wc(n,s,o){var c=n.context,v=c.gl,w=o.posMatrix,S=n.useProgram("debug"),E=K.disabled,P=W.disabled,O=n.colorModeForRenderPass();c.activeTexture.set(v.TEXTURE0),n.emptyTexture.bind(v.LINEAR,v.CLAMP_TO_EDGE),S.draw(c,v.LINE_STRIP,E,P,O,fe.disabled,vo(w,a.Color.red),"$debug",n.debugBuffer,n.tileBorderIndexBuffer,n.debugSegments);var G=s.getTileByID(o.key).latestRawTileData,Z=Math.floor((G&&G.byteLength||0)/1024),H=s.getTile(o).tileSize,te=512/Math.min(H,512)*(o.overscaledZ/n.transform.zoom)*.5,ee=o.canonical.toString();o.overscaledZ!==o.canonical.z&&(ee+=" => "+o.overscaledZ),function(ce,Y){ce.initDebugOverlayCanvas();var le=ce.debugOverlayCanvas,de=ce.context.gl,_e=ce.debugOverlayCanvas.getContext("2d");_e.clearRect(0,0,le.width,le.height),_e.shadowColor="white",_e.shadowBlur=2,_e.lineWidth=1.5,_e.strokeStyle="white",_e.textBaseline="top",_e.font="bold 36px Open Sans, sans-serif",_e.fillText(Y,5,5),_e.strokeText(Y,5,5),ce.debugOverlayTexture.update(le),ce.debugOverlayTexture.bind(de.LINEAR,de.CLAMP_TO_EDGE)}(n,ee+" "+Z+"kb"),S.draw(c,v.TRIANGLES,E,P,ue.alphaBlended,fe.disabled,vo(w,a.Color.transparent,te),"$debug",n.debugBuffer,n.quadTriangleIndexBuffer,n.debugSegments)}var wo={symbol:function(n,s,o,c,v){if(n.renderPass==="translucent"){var w=W.disabled,S=n.colorModeForRenderPass();o.layout.get("text-variable-anchor")&&function(E,P,O,G,Z,H,te){for(var ee=P.transform,ce=Z==="map",Y=H==="map",le=0,de=E;le<de.length;le+=1){var _e=de[le],Ie=G.getTile(_e),Se=Ie.getBucket(O);if(Se&&Se.text&&Se.text.segments.get().length){var ze=a.evaluateSizeForZoom(Se.textSizeData,ee.zoom),Fe=Pr(Ie,1,P.transform.zoom),Ye=Or(_e.posMatrix,Y,ce,P.transform,Fe),Xe=O.layout.get("icon-text-fit")!=="none"&&Se.hasIconData();if(ze){var pt=Math.pow(2,ee.zoom-Ie.tileID.overscaledZ);_c(Se,ce,Y,te,a.symbolSize,ee,Ye,_e.posMatrix,pt,ze,Xe)}}}}(c,n,o,s,o.layout.get("text-rotation-alignment"),o.layout.get("text-pitch-alignment"),v),o.paint.get("icon-opacity").constantOr(1)!==0&&xo(n,s,o,c,!1,o.paint.get("icon-translate"),o.paint.get("icon-translate-anchor"),o.layout.get("icon-rotation-alignment"),o.layout.get("icon-pitch-alignment"),o.layout.get("icon-keep-upright"),w,S),o.paint.get("text-opacity").constantOr(1)!==0&&xo(n,s,o,c,!0,o.paint.get("text-translate"),o.paint.get("text-translate-anchor"),o.layout.get("text-rotation-alignment"),o.layout.get("text-pitch-alignment"),o.layout.get("text-keep-upright"),w,S),s.map.showCollisionBoxes&&(Uo(n,s,o,c,o.paint.get("text-translate"),o.paint.get("text-translate-anchor"),!0),Uo(n,s,o,c,o.paint.get("icon-translate"),o.paint.get("icon-translate-anchor"),!1))}},circle:function(n,s,o,c){if(n.renderPass==="translucent"){var v=o.paint.get("circle-opacity"),w=o.paint.get("circle-stroke-width"),S=o.paint.get("circle-stroke-opacity"),E=o.layout.get("circle-sort-key").constantOr(1)!==void 0;if(v.constantOr(1)!==0||w.constantOr(1)!==0&&S.constantOr(1)!==0){for(var P=n.context,O=P.gl,G=n.depthModeForSublayer(0,K.ReadOnly),Z=W.disabled,H=n.colorModeForRenderPass(),te=[],ee=0;ee<c.length;ee++){var ce=c[ee],Y=s.getTile(ce),le=Y.getBucket(o);if(le){var de=le.programConfigurations.get(o.id),_e={programConfiguration:de,program:n.useProgram("circle",de),layoutVertexBuffer:le.layoutVertexBuffer,indexBuffer:le.indexBuffer,uniformValues:Gl(n,ce,Y,o)};if(E)for(var Ie=0,Se=le.segments.get();Ie<Se.length;Ie+=1){var ze=Se[Ie];te.push({segments:new a.SegmentVector([ze]),sortKey:ze.sortKey,state:_e})}else te.push({segments:le.segments,sortKey:0,state:_e})}}E&&te.sort(function(Et,Pt){return Et.sortKey-Pt.sortKey});for(var Fe=0,Ye=te;Fe<Ye.length;Fe+=1){var Xe=Ye[Fe],pt=Xe.state;pt.program.draw(P,O.TRIANGLES,G,Z,H,fe.disabled,pt.uniformValues,o.id,pt.layoutVertexBuffer,pt.indexBuffer,Xe.segments,o.paint,n.transform.zoom,pt.programConfiguration)}}}},heatmap:function(n,s,o,c){if(o.paint.get("heatmap-opacity")!==0)if(n.renderPass==="offscreen"){var v=n.context,w=v.gl,S=W.disabled,E=new ue([w.ONE,w.ONE],a.Color.transparent,[!0,!0,!0,!0]);(function(te,ee,ce){var Y=te.gl;te.activeTexture.set(Y.TEXTURE1),te.viewport.set([0,0,ee.width/4,ee.height/4]);var le=ce.heatmapFbo;if(le)Y.bindTexture(Y.TEXTURE_2D,le.colorAttachment.get()),te.bindFramebuffer.set(le.framebuffer);else{var de=Y.createTexture();Y.bindTexture(Y.TEXTURE_2D,de),Y.texParameteri(Y.TEXTURE_2D,Y.TEXTURE_WRAP_S,Y.CLAMP_TO_EDGE),Y.texParameteri(Y.TEXTURE_2D,Y.TEXTURE_WRAP_T,Y.CLAMP_TO_EDGE),Y.texParameteri(Y.TEXTURE_2D,Y.TEXTURE_MIN_FILTER,Y.LINEAR),Y.texParameteri(Y.TEXTURE_2D,Y.TEXTURE_MAG_FILTER,Y.LINEAR),le=ce.heatmapFbo=te.createFramebuffer(ee.width/4,ee.height/4,!1),function(_e,Ie,Se,ze){var Fe=_e.gl;Fe.texImage2D(Fe.TEXTURE_2D,0,Fe.RGBA,Ie.width/4,Ie.height/4,0,Fe.RGBA,_e.extRenderToTextureHalfFloat?_e.extTextureHalfFloat.HALF_FLOAT_OES:Fe.UNSIGNED_BYTE,null),ze.colorAttachment.set(Se)}(te,ee,de,le)}})(v,n,o),v.clear({color:a.Color.transparent});for(var P=0;P<c.length;P++){var O=c[P];if(!s.hasRenderableParent(O)){var G=s.getTile(O),Z=G.getBucket(o);if(Z){var H=Z.programConfigurations.get(o.id);n.useProgram("heatmap",H).draw(v,w.TRIANGLES,K.disabled,S,E,fe.disabled,fc(O.posMatrix,G,n.transform.zoom,o.paint.get("heatmap-intensity")),o.id,Z.layoutVertexBuffer,Z.indexBuffer,Z.segments,o.paint,n.transform.zoom,H)}}}v.viewport.set([0,0,n.width,n.height])}else n.renderPass==="translucent"&&(n.context.setColorMode(n.colorModeForRenderPass()),function(te,ee){var ce=te.context,Y=ce.gl,le=ee.heatmapFbo;if(le){ce.activeTexture.set(Y.TEXTURE0),Y.bindTexture(Y.TEXTURE_2D,le.colorAttachment.get()),ce.activeTexture.set(Y.TEXTURE1);var de=ee.colorRampTexture;de||(de=ee.colorRampTexture=new a.Texture(ce,ee.colorRamp,Y.RGBA)),de.bind(Y.LINEAR,Y.CLAMP_TO_EDGE),te.useProgram("heatmapTexture").draw(ce,Y.TRIANGLES,K.disabled,W.disabled,te.colorModeForRenderPass(),fe.disabled,function(_e,Ie,Se,ze){var Fe=a.create();a.ortho(Fe,0,_e.width,_e.height,0,0,1);var Ye=_e.context.gl;return{u_matrix:Fe,u_world:[Ye.drawingBufferWidth,Ye.drawingBufferHeight],u_image:0,u_color_ramp:1,u_opacity:Ie.paint.get("heatmap-opacity")}}(te,ee),ee.id,te.viewportBuffer,te.quadTriangleIndexBuffer,te.viewportSegments,ee.paint,te.transform.zoom)}}(n,o))},line:function(n,s,o,c){if(n.renderPass==="translucent"){var v=o.paint.get("line-opacity"),w=o.paint.get("line-width");if(v.constantOr(1)!==0&&w.constantOr(1)!==0)for(var S=n.depthModeForSublayer(0,K.ReadOnly),E=n.colorModeForRenderPass(),P=o.paint.get("line-dasharray"),O=o.paint.get("line-pattern"),G=O.constantOr(1),Z=o.paint.get("line-gradient"),H=o.getCrossfadeParameters(),te=G?"linePattern":P?"lineSDF":Z?"lineGradient":"line",ee=n.context,ce=ee.gl,Y=!0,le=0,de=c;le<de.length;le+=1){var _e=de[le],Ie=s.getTile(_e);if(!G||Ie.patternsLoaded()){var Se=Ie.getBucket(o);if(Se){var ze=Se.programConfigurations.get(o.id),Fe=n.context.program.get(),Ye=n.useProgram(te,ze),Xe=Y||Ye.program!==Fe,pt=O.constantOr(null);if(pt&&Ie.imageAtlas){var Et=Ie.imageAtlas,Pt=Et.patternPositions[pt.to.toString()],At=Et.patternPositions[pt.from.toString()];Pt&&At&&ze.setConstantPatternPositions(Pt,At)}var _r=G?Ns(n,Ie,o,H):P?qh(n,Ie,o,P,H):Z?Fr(n,Ie,o,Se.lineClipsArray.length):ls(n,Ie,o);if(G)ee.activeTexture.set(ce.TEXTURE0),Ie.imageAtlasTexture.bind(ce.LINEAR,ce.CLAMP_TO_EDGE),ze.updatePaintBuffers(H);else if(P&&(Xe||n.lineAtlas.dirty))ee.activeTexture.set(ce.TEXTURE0),n.lineAtlas.bind(ee);else if(Z){var ft=Se.gradients[o.id],Nt=ft.texture;if(o.gradientVersion!==ft.version){var Yt=256;if(o.stepInterpolant){var Ft=s.getSource().maxzoom,Ot=_e.canonical.z===Ft?Math.ceil(1<<n.transform.maxZoom-_e.canonical.z):1;Yt=a.clamp(a.nextPowerOfTwo(Se.maxLineLength/a.EXTENT*1024*Ot),256,ee.maxTextureSize)}ft.gradient=a.renderColorRamp({expression:o.gradientExpression(),evaluationKey:"lineProgress",resolution:Yt,image:ft.gradient||void 0,clips:Se.lineClipsArray}),ft.texture?ft.texture.update(ft.gradient):ft.texture=new a.Texture(ee,ft.gradient,ce.RGBA),ft.version=o.gradientVersion,Nt=ft.texture}ee.activeTexture.set(ce.TEXTURE0),Nt.bind(o.stepInterpolant?ce.NEAREST:ce.LINEAR,ce.CLAMP_TO_EDGE)}Ye.draw(ee,ce.TRIANGLES,S,n.stencilModeForClipping(_e),E,fe.disabled,_r,o.id,Se.layoutVertexBuffer,Se.indexBuffer,Se.segments,o.paint,n.transform.zoom,ze,Se.layoutVertexBuffer2),Y=!1}}}}},fill:function(n,s,o,c){var v=o.paint.get("fill-color"),w=o.paint.get("fill-opacity");if(w.constantOr(1)!==0){var S=n.colorModeForRenderPass(),E=o.paint.get("fill-pattern"),P=n.opaquePassEnabledForLayer()&&!E.constantOr(1)&&v.constantOr(a.Color.transparent).a===1&&w.constantOr(0)===1?"opaque":"translucent";if(n.renderPass===P){var O=n.depthModeForSublayer(1,n.renderPass==="opaque"?K.ReadWrite:K.ReadOnly);qs(n,s,o,c,O,S,!1)}if(n.renderPass==="translucent"&&o.paint.get("fill-antialias")){var G=n.depthModeForSublayer(o.getPaintProperty("fill-outline-color")?2:0,K.ReadOnly);qs(n,s,o,c,G,S,!0)}}},"fill-extrusion":function(n,s,o,c){var v=o.paint.get("fill-extrusion-opacity");if(v!==0&&n.renderPass==="translucent"){var w=new K(n.context.gl.LEQUAL,K.ReadWrite,n.depthRangeFor3D);if(v!==1||o.paint.get("fill-extrusion-pattern").constantOr(1))Zl(n,s,o,c,w,W.disabled,ue.disabled),Zl(n,s,o,c,w,n.stencilModeFor3D(),n.colorModeForRenderPass());else{var S=n.colorModeForRenderPass();Zl(n,s,o,c,w,W.disabled,S)}}},hillshade:function(n,s,o,c){if(n.renderPass==="offscreen"||n.renderPass==="translucent"){for(var v=n.context,w=n.depthModeForSublayer(0,K.ReadOnly),S=n.colorModeForRenderPass(),E=n.renderPass==="translucent"?n.stencilConfigForOverlap(c):[{},c],P=E[0],O=0,G=E[1];O<G.length;O+=1){var Z=G[O],H=s.getTile(Z);H.needsHillshadePrepare&&n.renderPass==="offscreen"?Gh(n,H,o,w,W.disabled,S):n.renderPass==="translucent"&&js(n,H,o,w,P[Z.overscaledZ],S)}v.viewport.set([0,0,n.width,n.height])}},raster:function(n,s,o,c){if(n.renderPass==="translucent"&&o.paint.get("raster-opacity")!==0&&c.length)for(var v=n.context,w=v.gl,S=s.getSource(),E=n.useProgram("raster"),P=n.colorModeForRenderPass(),O=S instanceof ot?[{},c]:n.stencilConfigForOverlap(c),G=O[0],Z=O[1],H=Z[Z.length-1].overscaledZ,te=!n.options.moving,ee=0,ce=Z;ee<ce.length;ee+=1){var Y=ce[ee],le=n.depthModeForSublayer(Y.overscaledZ-H,o.paint.get("raster-opacity")===1?K.ReadWrite:K.ReadOnly,w.LESS),de=s.getTile(Y),_e=n.transform.calculatePosMatrix(Y.toUnwrapped(),te);de.registerFadeDuration(o.paint.get("raster-fade-duration"));var Ie=s.findLoadedParent(Y,0),Se=Gs(de,Ie,s,o,n.transform),ze=void 0,Fe=void 0,Ye=o.paint.get("raster-resampling")==="nearest"?w.NEAREST:w.LINEAR;v.activeTexture.set(w.TEXTURE0),de.texture.bind(Ye,w.CLAMP_TO_EDGE,w.LINEAR_MIPMAP_NEAREST),v.activeTexture.set(w.TEXTURE1),Ie?(Ie.texture.bind(Ye,w.CLAMP_TO_EDGE,w.LINEAR_MIPMAP_NEAREST),ze=Math.pow(2,Ie.tileID.overscaledZ-de.tileID.overscaledZ),Fe=[de.tileID.canonical.x*ze%1,de.tileID.canonical.y*ze%1]):de.texture.bind(Ye,w.CLAMP_TO_EDGE,w.LINEAR_MIPMAP_NEAREST);var Xe=jh(_e,Fe||[0,0],ze||1,Se,o);S instanceof ot?E.draw(v,w.TRIANGLES,le,W.disabled,P,fe.disabled,Xe,o.id,S.boundsBuffer,n.quadTriangleIndexBuffer,S.boundsSegments):E.draw(v,w.TRIANGLES,le,G[Y.overscaledZ],P,fe.disabled,Xe,o.id,n.rasterBoundsBuffer,n.quadTriangleIndexBuffer,n.rasterBoundsSegments)}},background:function(n,s,o){var c=o.paint.get("background-color"),v=o.paint.get("background-opacity");if(v!==0){var w=n.context,S=w.gl,E=n.transform,P=E.tileSize,O=o.paint.get("background-pattern");if(!n.isPatternMissing(O)){var G=!O&&c.a===1&&v===1&&n.opaquePassEnabledForLayer()?"opaque":"translucent";if(n.renderPass===G){var Z=W.disabled,H=n.depthModeForSublayer(0,G==="opaque"?K.ReadWrite:K.ReadOnly),te=n.colorModeForRenderPass(),ee=n.useProgram(O?"backgroundPattern":"background"),ce=E.coveringTiles({tileSize:P});O&&(w.activeTexture.set(S.TEXTURE0),n.imageManager.bind(n.context));for(var Y=o.getCrossfadeParameters(),le=0,de=ce;le<de.length;le+=1){var _e=de[le],Ie=n.transform.calculatePosMatrix(_e.toUnwrapped()),Se=O?Vo(Ie,v,n,O,{tileID:_e,tileSize:P},Y):cs(Ie,v,c);ee.draw(w,S.TRIANGLES,H,Z,te,fe.disabled,Se,o.id,n.tileExtentBuffer,n.quadTriangleIndexBuffer,n.tileExtentSegments)}}}}},debug:function(n,s,o){for(var c=0;c<o.length;c++)wc(n,s,o[c])},custom:function(n,s,o){var c=n.context,v=o.implementation;if(n.renderPass==="offscreen"){var w=v.prerender;w&&(n.setCustomLayerDefaults(),c.setColorMode(n.colorModeForRenderPass()),w.call(v,c.gl,n.transform.customLayerMatrix()),c.setDirty(),n.setBaseState())}else if(n.renderPass==="translucent"){n.setCustomLayerDefaults(),c.setColorMode(n.colorModeForRenderPass()),c.setStencilMode(W.disabled);var S=v.renderingMode==="3d"?new K(n.context.gl.LEQUAL,K.ReadWrite,n.depthRangeFor3D):n.depthModeForSublayer(0,K.ReadOnly);c.setDepthMode(S),v.render(c.gl,n.transform.customLayerMatrix()),c.setDirty(),n.setBaseState(),c.bindFramebuffer.set(null)}}},Wr=function(n,s){this.context=new U(n),this.transform=s,this._tileTextures={},this.setup(),this.numSublayers=Q.maxUnderzooming+Q.maxOverzooming+1,this.depthEpsilon=1/Math.pow(2,16),this.crossTileSymbolIndex=new ye,this.gpuTimers={}};Wr.prototype.resize=function(n,s){if(this.width=n*a.browser.devicePixelRatio,this.height=s*a.browser.devicePixelRatio,this.context.viewport.set([0,0,this.width,this.height]),this.style)for(var o=0,c=this.style._order;o<c.length;o+=1)this.style._layers[c[o]].resize()},Wr.prototype.setup=function(){var n=this.context,s=new a.StructArrayLayout2i4;s.emplaceBack(0,0),s.emplaceBack(a.EXTENT,0),s.emplaceBack(0,a.EXTENT),s.emplaceBack(a.EXTENT,a.EXTENT),this.tileExtentBuffer=n.createVertexBuffer(s,wi.members),this.tileExtentSegments=a.SegmentVector.simpleSegment(0,0,4,2);var o=new a.StructArrayLayout2i4;o.emplaceBack(0,0),o.emplaceBack(a.EXTENT,0),o.emplaceBack(0,a.EXTENT),o.emplaceBack(a.EXTENT,a.EXTENT),this.debugBuffer=n.createVertexBuffer(o,wi.members),this.debugSegments=a.SegmentVector.simpleSegment(0,0,4,5);var c=new a.StructArrayLayout4i8;c.emplaceBack(0,0,0,0),c.emplaceBack(a.EXTENT,0,a.EXTENT,0),c.emplaceBack(0,a.EXTENT,0,a.EXTENT),c.emplaceBack(a.EXTENT,a.EXTENT,a.EXTENT,a.EXTENT),this.rasterBoundsBuffer=n.createVertexBuffer(c,Oe.members),this.rasterBoundsSegments=a.SegmentVector.simpleSegment(0,0,4,2);var v=new a.StructArrayLayout2i4;v.emplaceBack(0,0),v.emplaceBack(1,0),v.emplaceBack(0,1),v.emplaceBack(1,1),this.viewportBuffer=n.createVertexBuffer(v,wi.members),this.viewportSegments=a.SegmentVector.simpleSegment(0,0,4,2);var w=new a.StructArrayLayout1ui2;w.emplaceBack(0),w.emplaceBack(1),w.emplaceBack(3),w.emplaceBack(2),w.emplaceBack(0),this.tileBorderIndexBuffer=n.createIndexBuffer(w);var S=new a.StructArrayLayout3ui6;S.emplaceBack(0,1,2),S.emplaceBack(2,1,3),this.quadTriangleIndexBuffer=n.createIndexBuffer(S),this.emptyTexture=new a.Texture(n,{width:1,height:1,data:new Uint8Array([0,0,0,0])},n.gl.RGBA);var E=this.context.gl;this.stencilClearMode=new W({func:E.ALWAYS,mask:0},0,255,E.ZERO,E.ZERO,E.ZERO)},Wr.prototype.clearStencil=function(){var n=this.context,s=n.gl;this.nextStencilID=1,this.currentStencilSource=void 0;var o=a.create();a.ortho(o,0,this.width,this.height,0,0,1),a.scale(o,o,[s.drawingBufferWidth,s.drawingBufferHeight,0]),this.useProgram("clippingMask").draw(n,s.TRIANGLES,K.disabled,this.stencilClearMode,ue.disabled,fe.disabled,bo(o),"$clipping",this.viewportBuffer,this.quadTriangleIndexBuffer,this.viewportSegments)},Wr.prototype._renderTileClippingMasks=function(n,s){if(this.currentStencilSource!==n.source&&n.isTileClipped()&&s&&s.length){this.currentStencilSource=n.source;var o=this.context,c=o.gl;this.nextStencilID+s.length>256&&this.clearStencil(),o.setColorMode(ue.disabled),o.setDepthMode(K.disabled);var v=this.useProgram("clippingMask");this._tileClippingMaskIDs={};for(var w=0,S=s;w<S.length;w+=1){var E=S[w],P=this._tileClippingMaskIDs[E.key]=this.nextStencilID++;v.draw(o,c.TRIANGLES,K.disabled,new W({func:c.ALWAYS,mask:0},P,255,c.KEEP,c.KEEP,c.REPLACE),ue.disabled,fe.disabled,bo(E.posMatrix),"$clipping",this.tileExtentBuffer,this.quadTriangleIndexBuffer,this.tileExtentSegments)}}},Wr.prototype.stencilModeFor3D=function(){this.currentStencilSource=void 0,this.nextStencilID+1>256&&this.clearStencil();var n=this.nextStencilID++,s=this.context.gl;return new W({func:s.NOTEQUAL,mask:255},n,255,s.KEEP,s.KEEP,s.REPLACE)},Wr.prototype.stencilModeForClipping=function(n){var s=this.context.gl;return new W({func:s.EQUAL,mask:255},this._tileClippingMaskIDs[n.key],0,s.KEEP,s.KEEP,s.REPLACE)},Wr.prototype.stencilConfigForOverlap=function(n){var s,o=this.context.gl,c=n.sort(function(P,O){return O.overscaledZ-P.overscaledZ}),v=c[c.length-1].overscaledZ,w=c[0].overscaledZ-v+1;if(w>1){this.currentStencilSource=void 0,this.nextStencilID+w>256&&this.clearStencil();for(var S={},E=0;E<w;E++)S[E+v]=new W({func:o.GEQUAL,mask:255},E+this.nextStencilID,255,o.KEEP,o.KEEP,o.REPLACE);return this.nextStencilID+=w,[S,c]}return[(s={},s[v]=W.disabled,s),c]},Wr.prototype.colorModeForRenderPass=function(){var n=this.context.gl;return this._showOverdrawInspector?new ue([n.CONSTANT_COLOR,n.ONE],new a.Color(1/8,1/8,1/8,0),[!0,!0,!0,!0]):this.renderPass==="opaque"?ue.unblended:ue.alphaBlended},Wr.prototype.depthModeForSublayer=function(n,s,o){if(!this.opaquePassEnabledForLayer())return K.disabled;var c=1-((1+this.currentLayer)*this.numSublayers+n)*this.depthEpsilon;return new K(o||this.context.gl.LEQUAL,s,[c,c])},Wr.prototype.opaquePassEnabledForLayer=function(){return this.currentLayer<this.opaquePassCutoff},Wr.prototype.render=function(n,s){var o=this;this.style=n,this.options=s,this.lineAtlas=n.lineAtlas,this.imageManager=n.imageManager,this.glyphManager=n.glyphManager,this.symbolFadeChange=n.placement.symbolFadeChange(a.browser.now()),this.imageManager.beginFrame();var c=this.style._order,v=this.style.sourceCaches;for(var w in v){var S=v[w];S.used&&S.prepare(this.context)}var E,P,O={},G={},Z={};for(var H in v){var te=v[H];O[H]=te.getVisibleCoordinates(),G[H]=O[H].slice().reverse(),Z[H]=te.getVisibleCoordinates(!0).reverse()}this.opaquePassCutoff=1/0;for(var ee=0;ee<c.length;ee++)if(this.style._layers[c[ee]].is3D()){this.opaquePassCutoff=ee;break}this.renderPass="offscreen";for(var ce=0,Y=c;ce<Y.length;ce+=1){var le=this.style._layers[Y[ce]];if(le.hasOffscreenPass()&&!le.isHidden(this.transform.zoom)){var de=G[le.source];(le.type==="custom"||de.length)&&this.renderLayer(this,v[le.source],le,de)}}for(this.context.bindFramebuffer.set(null),this.context.clear({color:s.showOverdrawInspector?a.Color.black:a.Color.transparent,depth:1}),this.clearStencil(),this._showOverdrawInspector=s.showOverdrawInspector,this.depthRangeFor3D=[0,1-(n._order.length+2)*this.numSublayers*this.depthEpsilon],this.renderPass="opaque",this.currentLayer=c.length-1;this.currentLayer>=0;this.currentLayer--){var _e=this.style._layers[c[this.currentLayer]],Ie=v[_e.source],Se=O[_e.source];this._renderTileClippingMasks(_e,Se),this.renderLayer(this,Ie,_e,Se)}for(this.renderPass="translucent",this.currentLayer=0;this.currentLayer<c.length;this.currentLayer++){var ze=this.style._layers[c[this.currentLayer]],Fe=v[ze.source],Ye=(ze.type==="symbol"?Z:G)[ze.source];this._renderTileClippingMasks(ze,O[ze.source]),this.renderLayer(this,Fe,ze,Ye)}this.options.showTileBoundaries&&(a.values(this.style._layers).forEach(function(Xe){Xe.source&&!Xe.isHidden(o.transform.zoom)&&(Xe.source!==(P&&P.id)&&(P=o.style.sourceCaches[Xe.source]),(!E||E.getSource().maxzoom<P.getSource().maxzoom)&&(E=P))}),E&&wo.debug(this,E,E.getVisibleCoordinates())),this.options.showPadding&&function(Xe){var pt=Xe.transform.padding;Xl(Xe,Xe.transform.height-(pt.top||0),3,Kl),Xl(Xe,pt.bottom||0,3,bc),Wl(Xe,pt.left||0,3,xc),Wl(Xe,Xe.transform.width-(pt.right||0),3,Zs);var Et=Xe.transform.centerPoint;(function(Pt,At,_r,ft){ps(Pt,At-1,_r-10,2,20,ft),ps(Pt,At-10,_r-1,20,2,ft)})(Xe,Et.x,Xe.transform.height-Et.y,Hl)}(this),this.context.setDefault()},Wr.prototype.renderLayer=function(n,s,o,c){o.isHidden(this.transform.zoom)||(o.type==="background"||o.type==="custom"||c.length)&&(this.id=o.id,this.gpuTimingStart(o),wo[o.type](n,s,o,c,this.style.placement.variableOffsets),this.gpuTimingEnd())},Wr.prototype.gpuTimingStart=function(n){if(this.options.gpuTiming){var s=this.context.extTimerQuery,o=this.gpuTimers[n.id];o||(o=this.gpuTimers[n.id]={calls:0,cpuTime:0,query:s.createQueryEXT()}),o.calls++,s.beginQueryEXT(s.TIME_ELAPSED_EXT,o.query)}},Wr.prototype.gpuTimingEnd=function(){if(this.options.gpuTiming){var n=this.context.extTimerQuery;n.endQueryEXT(n.TIME_ELAPSED_EXT)}},Wr.prototype.collectGpuTimers=function(){var n=this.gpuTimers;return this.gpuTimers={},n},Wr.prototype.queryGpuTimers=function(n){var s={};for(var o in n){var c=n[o],v=this.context.extTimerQuery,w=v.getQueryObjectEXT(c.query,v.QUERY_RESULT_EXT)/1e6;v.deleteQueryEXT(c.query),s[o]=w}return s},Wr.prototype.translatePosMatrix=function(n,s,o,c,v){if(!o[0]&&!o[1])return n;var w=v?c==="map"?this.transform.angle:0:c==="viewport"?-this.transform.angle:0;if(w){var S=Math.sin(w),E=Math.cos(w);o=[o[0]*E-o[1]*S,o[0]*S+o[1]*E]}var P=[v?o[0]:Pr(s,o[0],this.transform.zoom),v?o[1]:Pr(s,o[1],this.transform.zoom),0],O=new Float32Array(16);return a.translate(O,n,P),O},Wr.prototype.saveTileTexture=function(n){var s=this._tileTextures[n.size[0]];s?s.push(n):this._tileTextures[n.size[0]]=[n]},Wr.prototype.getTileTexture=function(n){var s=this._tileTextures[n];return s&&s.length>0?s.pop():null},Wr.prototype.isPatternMissing=function(n){if(!n)return!1;if(!n.from||!n.to)return!0;var s=this.imageManager.getPattern(n.from.toString()),o=this.imageManager.getPattern(n.to.toString());return!s||!o},Wr.prototype.useProgram=function(n,s){this.cache=this.cache||{};var o=""+n+(s?s.cacheKey:"")+(this._showOverdrawInspector?"/overdraw":"");return this.cache[o]||(this.cache[o]=new sc(this.context,n,Uh[n],s,yc[n],this._showOverdrawInspector)),this.cache[o]},Wr.prototype.setCustomLayerDefaults=function(){this.context.unbindVAO(),this.context.cullFace.setDefault(),this.context.activeTexture.setDefault(),this.context.pixelStoreUnpack.setDefault(),this.context.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.context.pixelStoreUnpackFlipY.setDefault()},Wr.prototype.setBaseState=function(){var n=this.context.gl;this.context.cullFace.set(!1),this.context.viewport.set([0,0,this.width,this.height]),this.context.blendEquation.set(n.FUNC_ADD)},Wr.prototype.initDebugOverlayCanvas=function(){this.debugOverlayCanvas==null&&(this.debugOverlayCanvas=a.window.document.createElement("canvas"),this.debugOverlayCanvas.width=512,this.debugOverlayCanvas.height=512,this.debugOverlayTexture=new a.Texture(this.context,this.debugOverlayCanvas,this.context.gl.RGBA))},Wr.prototype.destroy=function(){this.emptyTexture.destroy(),this.debugOverlayTexture&&this.debugOverlayTexture.destroy()};var Ks=function(n,s){this.points=n,this.planes=s};Ks.fromInvProjectionMatrix=function(n,s,o){var c=Math.pow(2,o),v=[[-1,1,-1,1],[1,1,-1,1],[1,-1,-1,1],[-1,-1,-1,1],[-1,1,1,1],[1,1,1,1],[1,-1,1,1],[-1,-1,1,1]].map(function(S){return a.transformMat4([],S,n)}).map(function(S){return a.scale$1([],S,1/S[3]/s*c)}),w=[[0,1,2],[6,5,4],[0,3,7],[2,1,5],[3,2,6],[0,4,5]].map(function(S){var E=a.sub([],v[S[0]],v[S[1]]),P=a.sub([],v[S[2]],v[S[1]]),O=a.normalize([],a.cross([],E,P)),G=-a.dot(O,v[S[1]]);return O.concat(G)});return new Ks(v,w)};var So=function(n,s){this.min=n,this.max=s,this.center=a.scale$2([],a.add([],this.min,this.max),.5)};So.prototype.quadrant=function(n){for(var s=[n%2==0,n<2],o=a.clone$2(this.min),c=a.clone$2(this.max),v=0;v<s.length;v++)o[v]=s[v]?this.min[v]:this.center[v],c[v]=s[v]?this.center[v]:this.max[v];return c[2]=this.max[2],new So(o,c)},So.prototype.distanceX=function(n){return Math.max(Math.min(this.max[0],n[0]),this.min[0])-n[0]},So.prototype.distanceY=function(n){return Math.max(Math.min(this.max[1],n[1]),this.min[1])-n[1]},So.prototype.intersects=function(n){for(var s=[[this.min[0],this.min[1],0,1],[this.max[0],this.min[1],0,1],[this.max[0],this.max[1],0,1],[this.min[0],this.max[1],0,1]],o=!0,c=0;c<n.planes.length;c++){for(var v=n.planes[c],w=0,S=0;S<s.length;S++)w+=a.dot$1(v,s[S])>=0;if(w===0)return 0;w!==s.length&&(o=!1)}if(o)return 2;for(var E=0;E<3;E++){for(var P=Number.MAX_VALUE,O=-Number.MAX_VALUE,G=0;G<n.points.length;G++){var Z=n.points[G][E]-this.min[E];P=Math.min(P,Z),O=Math.max(O,Z)}if(O<0||P>this.max[E]-this.min[E])return 0}return 1};var Ha=function(n,s,o,c){if(n===void 0&&(n=0),s===void 0&&(s=0),o===void 0&&(o=0),c===void 0&&(c=0),isNaN(n)||n<0||isNaN(s)||s<0||isNaN(o)||o<0||isNaN(c)||c<0)throw new Error("Invalid value for edge-insets, top, bottom, left and right must all be numbers");this.top=n,this.bottom=s,this.left=o,this.right=c};Ha.prototype.interpolate=function(n,s,o){return s.top!=null&&n.top!=null&&(this.top=a.number(n.top,s.top,o)),s.bottom!=null&&n.bottom!=null&&(this.bottom=a.number(n.bottom,s.bottom,o)),s.left!=null&&n.left!=null&&(this.left=a.number(n.left,s.left,o)),s.right!=null&&n.right!=null&&(this.right=a.number(n.right,s.right,o)),this},Ha.prototype.getCenter=function(n,s){var o=a.clamp((this.left+n-this.right)/2,0,n),c=a.clamp((this.top+s-this.bottom)/2,0,s);return new a.Point(o,c)},Ha.prototype.equals=function(n){return this.top===n.top&&this.bottom===n.bottom&&this.left===n.left&&this.right===n.right},Ha.prototype.clone=function(){return new Ha(this.top,this.bottom,this.left,this.right)},Ha.prototype.toJSON=function(){return{top:this.top,bottom:this.bottom,left:this.left,right:this.right}};var mr=function(n,s,o,c,v){this.tileSize=512,this.maxValidLatitude=85.051129,this._renderWorldCopies=v===void 0||v,this._minZoom=n||0,this._maxZoom=s||22,this._minPitch=o??0,this._maxPitch=c??60,this.setMaxBounds(),this.width=0,this.height=0,this._center=new a.LngLat(0,0),this.zoom=0,this.angle=0,this._fov=.6435011087932844,this._pitch=0,this._unmodified=!0,this._edgeInsets=new Ha,this._posMatrixCache={},this._alignedPosMatrixCache={}},Nr={minZoom:{configurable:!0},maxZoom:{configurable:!0},minPitch:{configurable:!0},maxPitch:{configurable:!0},renderWorldCopies:{configurable:!0},worldSize:{configurable:!0},centerOffset:{configurable:!0},size:{configurable:!0},bearing:{configurable:!0},pitch:{configurable:!0},fov:{configurable:!0},zoom:{configurable:!0},center:{configurable:!0},padding:{configurable:!0},centerPoint:{configurable:!0},unmodified:{configurable:!0},point:{configurable:!0}};mr.prototype.clone=function(){var n=new mr(this._minZoom,this._maxZoom,this._minPitch,this.maxPitch,this._renderWorldCopies);return n.tileSize=this.tileSize,n.latRange=this.latRange,n.width=this.width,n.height=this.height,n._center=this._center,n.zoom=this.zoom,n.angle=this.angle,n._fov=this._fov,n._pitch=this._pitch,n._unmodified=this._unmodified,n._edgeInsets=this._edgeInsets.clone(),n._calcMatrices(),n},Nr.minZoom.get=function(){return this._minZoom},Nr.minZoom.set=function(n){this._minZoom!==n&&(this._minZoom=n,this.zoom=Math.max(this.zoom,n))},Nr.maxZoom.get=function(){return this._maxZoom},Nr.maxZoom.set=function(n){this._maxZoom!==n&&(this._maxZoom=n,this.zoom=Math.min(this.zoom,n))},Nr.minPitch.get=function(){return this._minPitch},Nr.minPitch.set=function(n){this._minPitch!==n&&(this._minPitch=n,this.pitch=Math.max(this.pitch,n))},Nr.maxPitch.get=function(){return this._maxPitch},Nr.maxPitch.set=function(n){this._maxPitch!==n&&(this._maxPitch=n,this.pitch=Math.min(this.pitch,n))},Nr.renderWorldCopies.get=function(){return this._renderWorldCopies},Nr.renderWorldCopies.set=function(n){n===void 0?n=!0:n===null&&(n=!1),this._renderWorldCopies=n},Nr.worldSize.get=function(){return this.tileSize*this.scale},Nr.centerOffset.get=function(){return this.centerPoint._sub(this.size._div(2))},Nr.size.get=function(){return new a.Point(this.width,this.height)},Nr.bearing.get=function(){return-this.angle/Math.PI*180},Nr.bearing.set=function(n){var s=-a.wrap(n,-180,180)*Math.PI/180;this.angle!==s&&(this._unmodified=!1,this.angle=s,this._calcMatrices(),this.rotationMatrix=a.create$2(),a.rotate(this.rotationMatrix,this.rotationMatrix,this.angle))},Nr.pitch.get=function(){return this._pitch/Math.PI*180},Nr.pitch.set=function(n){var s=a.clamp(n,this.minPitch,this.maxPitch)/180*Math.PI;this._pitch!==s&&(this._unmodified=!1,this._pitch=s,this._calcMatrices())},Nr.fov.get=function(){return this._fov/Math.PI*180},Nr.fov.set=function(n){n=Math.max(.01,Math.min(60,n)),this._fov!==n&&(this._unmodified=!1,this._fov=n/180*Math.PI,this._calcMatrices())},Nr.zoom.get=function(){return this._zoom},Nr.zoom.set=function(n){var s=Math.min(Math.max(n,this.minZoom),this.maxZoom);this._zoom!==s&&(this._unmodified=!1,this._zoom=s,this.scale=this.zoomScale(s),this.tileZoom=Math.floor(s),this.zoomFraction=s-this.tileZoom,this._constrain(),this._calcMatrices())},Nr.center.get=function(){return this._center},Nr.center.set=function(n){n.lat===this._center.lat&&n.lng===this._center.lng||(this._unmodified=!1,this._center=n,this._constrain(),this._calcMatrices())},Nr.padding.get=function(){return this._edgeInsets.toJSON()},Nr.padding.set=function(n){this._edgeInsets.equals(n)||(this._unmodified=!1,this._edgeInsets.interpolate(this._edgeInsets,n,1),this._calcMatrices())},Nr.centerPoint.get=function(){return this._edgeInsets.getCenter(this.width,this.height)},mr.prototype.isPaddingEqual=function(n){return this._edgeInsets.equals(n)},mr.prototype.interpolatePadding=function(n,s,o){this._unmodified=!1,this._edgeInsets.interpolate(n,s,o),this._constrain(),this._calcMatrices()},mr.prototype.coveringZoomLevel=function(n){var s=(n.roundZoom?Math.round:Math.floor)(this.zoom+this.scaleZoom(this.tileSize/n.tileSize));return Math.max(0,s)},mr.prototype.getVisibleUnwrappedCoordinates=function(n){var s=[new a.UnwrappedTileID(0,n)];if(this._renderWorldCopies)for(var o=this.pointCoordinate(new a.Point(0,0)),c=this.pointCoordinate(new a.Point(this.width,0)),v=this.pointCoordinate(new a.Point(this.width,this.height)),w=this.pointCoordinate(new a.Point(0,this.height)),S=Math.floor(Math.min(o.x,c.x,v.x,w.x)),E=Math.floor(Math.max(o.x,c.x,v.x,w.x)),P=S-1;P<=E+1;P++)P!==0&&s.push(new a.UnwrappedTileID(P,n));return s},mr.prototype.coveringTiles=function(n){var s=this.coveringZoomLevel(n),o=s;if(n.minzoom!==void 0&&s<n.minzoom)return[];n.maxzoom!==void 0&&s>n.maxzoom&&(s=n.maxzoom);var c=a.MercatorCoordinate.fromLngLat(this.center),v=Math.pow(2,s),w=[v*c.x,v*c.y,0],S=Ks.fromInvProjectionMatrix(this.invProjMatrix,this.worldSize,s),E=n.minzoom||0;this.pitch<=60&&this._edgeInsets.top<.1&&(E=s);var P=function(Xe){return{aabb:new So([Xe*v,0,0],[(Xe+1)*v,v,0]),zoom:0,x:0,y:0,wrap:Xe,fullyVisible:!1}},O=[],G=[],Z=s,H=n.reparseOverscaled?o:s;if(this._renderWorldCopies)for(var te=1;te<=3;te++)O.push(P(-te)),O.push(P(te));for(O.push(P(0));O.length>0;){var ee=O.pop(),ce=ee.x,Y=ee.y,le=ee.fullyVisible;if(!le){var de=ee.aabb.intersects(S);if(de===0)continue;le=de===2}var _e=ee.aabb.distanceX(w),Ie=ee.aabb.distanceY(w),Se=Math.max(Math.abs(_e),Math.abs(Ie));if(ee.zoom===Z||Se>3+(1<<Z-ee.zoom)-2&&ee.zoom>=E)G.push({tileID:new a.OverscaledTileID(ee.zoom===Z?H:ee.zoom,ee.wrap,ee.zoom,ce,Y),distanceSq:a.sqrLen([w[0]-.5-ce,w[1]-.5-Y])});else for(var ze=0;ze<4;ze++){var Fe=(ce<<1)+ze%2,Ye=(Y<<1)+(ze>>1);O.push({aabb:ee.aabb.quadrant(ze),zoom:ee.zoom+1,x:Fe,y:Ye,wrap:ee.wrap,fullyVisible:le})}}return G.sort(function(Xe,pt){return Xe.distanceSq-pt.distanceSq}).map(function(Xe){return Xe.tileID})},mr.prototype.resize=function(n,s){this.width=n,this.height=s,this.pixelsToGLUnits=[2/n,-2/s],this._constrain(),this._calcMatrices()},Nr.unmodified.get=function(){return this._unmodified},mr.prototype.zoomScale=function(n){return Math.pow(2,n)},mr.prototype.scaleZoom=function(n){return Math.log(n)/Math.LN2},mr.prototype.project=function(n){var s=a.clamp(n.lat,-this.maxValidLatitude,this.maxValidLatitude);return new a.Point(a.mercatorXfromLng(n.lng)*this.worldSize,a.mercatorYfromLat(s)*this.worldSize)},mr.prototype.unproject=function(n){return new a.MercatorCoordinate(n.x/this.worldSize,n.y/this.worldSize).toLngLat()},Nr.point.get=function(){return this.project(this.center)},mr.prototype.setLocationAtPoint=function(n,s){var o=this.pointCoordinate(s),c=this.pointCoordinate(this.centerPoint),v=this.locationCoordinate(n),w=new a.MercatorCoordinate(v.x-(o.x-c.x),v.y-(o.y-c.y));this.center=this.coordinateLocation(w),this._renderWorldCopies&&(this.center=this.center.wrap())},mr.prototype.locationPoint=function(n){return this.coordinatePoint(this.locationCoordinate(n))},mr.prototype.pointLocation=function(n){return this.coordinateLocation(this.pointCoordinate(n))},mr.prototype.locationCoordinate=function(n){return a.MercatorCoordinate.fromLngLat(n)},mr.prototype.coordinateLocation=function(n){return n.toLngLat()},mr.prototype.pointCoordinate=function(n){var s=[n.x,n.y,0,1],o=[n.x,n.y,1,1];a.transformMat4(s,s,this.pixelMatrixInverse),a.transformMat4(o,o,this.pixelMatrixInverse);var c=s[3],v=o[3],w=s[1]/c,S=o[1]/v,E=s[2]/c,P=o[2]/v,O=E===P?0:(0-E)/(P-E);return new a.MercatorCoordinate(a.number(s[0]/c,o[0]/v,O)/this.worldSize,a.number(w,S,O)/this.worldSize)},mr.prototype.coordinatePoint=function(n){var s=[n.x*this.worldSize,n.y*this.worldSize,0,1];return a.transformMat4(s,s,this.pixelMatrix),new a.Point(s[0]/s[3],s[1]/s[3])},mr.prototype.getBounds=function(){return new a.LngLatBounds().extend(this.pointLocation(new a.Point(0,0))).extend(this.pointLocation(new a.Point(this.width,0))).extend(this.pointLocation(new a.Point(this.width,this.height))).extend(this.pointLocation(new a.Point(0,this.height)))},mr.prototype.getMaxBounds=function(){return this.latRange&&this.latRange.length===2&&this.lngRange&&this.lngRange.length===2?new a.LngLatBounds([this.lngRange[0],this.latRange[0]],[this.lngRange[1],this.latRange[1]]):null},mr.prototype.setMaxBounds=function(n){n?(this.lngRange=[n.getWest(),n.getEast()],this.latRange=[n.getSouth(),n.getNorth()],this._constrain()):(this.lngRange=null,this.latRange=[-this.maxValidLatitude,this.maxValidLatitude])},mr.prototype.calculatePosMatrix=function(n,s){s===void 0&&(s=!1);var o=n.key,c=s?this._alignedPosMatrixCache:this._posMatrixCache;if(c[o])return c[o];var v=n.canonical,w=this.worldSize/this.zoomScale(v.z),S=v.x+Math.pow(2,v.z)*n.wrap,E=a.identity(new Float64Array(16));return a.translate(E,E,[S*w,v.y*w,0]),a.scale(E,E,[w/a.EXTENT,w/a.EXTENT,1]),a.multiply(E,s?this.alignedProjMatrix:this.projMatrix,E),c[o]=new Float32Array(E),c[o]},mr.prototype.customLayerMatrix=function(){return this.mercatorMatrix.slice()},mr.prototype._constrain=function(){if(this.center&&this.width&&this.height&&!this._constraining){this._constraining=!0;var n,s,o,c,v=-90,w=90,S=-180,E=180,P=this.size,O=this._unmodified;if(this.latRange){var G=this.latRange;v=a.mercatorYfromLat(G[1])*this.worldSize,n=(w=a.mercatorYfromLat(G[0])*this.worldSize)-v<P.y?P.y/(w-v):0}if(this.lngRange){var Z=this.lngRange;S=a.mercatorXfromLng(Z[0])*this.worldSize,s=(E=a.mercatorXfromLng(Z[1])*this.worldSize)-S<P.x?P.x/(E-S):0}var H=this.point,te=Math.max(s||0,n||0);if(te)return this.center=this.unproject(new a.Point(s?(E+S)/2:H.x,n?(w+v)/2:H.y)),this.zoom+=this.scaleZoom(te),this._unmodified=O,void(this._constraining=!1);if(this.latRange){var ee=H.y,ce=P.y/2;ee-ce<v&&(c=v+ce),ee+ce>w&&(c=w-ce)}if(this.lngRange){var Y=H.x,le=P.x/2;Y-le<S&&(o=S+le),Y+le>E&&(o=E-le)}o===void 0&&c===void 0||(this.center=this.unproject(new a.Point(o!==void 0?o:H.x,c!==void 0?c:H.y))),this._unmodified=O,this._constraining=!1}},mr.prototype._calcMatrices=function(){if(this.height){var n=this.centerOffset;this.cameraToCenterDistance=.5/Math.tan(this._fov/2)*this.height;var s=Math.PI/2+this._pitch,o=this._fov*(.5+n.y/this.height),c=Math.sin(o)*this.cameraToCenterDistance/Math.sin(a.clamp(Math.PI-s-o,.01,Math.PI-.01)),v=this.point,w=v.x,S=v.y,E=1.01*(Math.cos(Math.PI/2-this._pitch)*c+this.cameraToCenterDistance),P=this.height/50,O=new Float64Array(16);a.perspective(O,this._fov,this.width/this.height,P,E),O[8]=2*-n.x/this.width,O[9]=2*n.y/this.height,a.scale(O,O,[1,-1,1]),a.translate(O,O,[0,0,-this.cameraToCenterDistance]),a.rotateX(O,O,this._pitch),a.rotateZ(O,O,this.angle),a.translate(O,O,[-w,-S,0]),this.mercatorMatrix=a.scale([],O,[this.worldSize,this.worldSize,this.worldSize]),a.scale(O,O,[1,1,a.mercatorZfromAltitude(1,this.center.lat)*this.worldSize,1]),this.projMatrix=O,this.invProjMatrix=a.invert([],this.projMatrix);var G=this.width%2/2,Z=this.height%2/2,H=Math.cos(this.angle),te=Math.sin(this.angle),ee=w-Math.round(w)+H*G+te*Z,ce=S-Math.round(S)+H*Z+te*G,Y=new Float64Array(O);if(a.translate(Y,Y,[ee>.5?ee-1:ee,ce>.5?ce-1:ce,0]),this.alignedProjMatrix=Y,O=a.create(),a.scale(O,O,[this.width/2,-this.height/2,1]),a.translate(O,O,[1,-1,0]),this.labelPlaneMatrix=O,O=a.create(),a.scale(O,O,[1,-1,1]),a.translate(O,O,[-1,-1,0]),a.scale(O,O,[2/this.width,2/this.height,1]),this.glCoordMatrix=O,this.pixelMatrix=a.multiply(new Float64Array(16),this.labelPlaneMatrix,this.projMatrix),!(O=a.invert(new Float64Array(16),this.pixelMatrix)))throw new Error("failed to invert matrix");this.pixelMatrixInverse=O,this._posMatrixCache={},this._alignedPosMatrixCache={}}},mr.prototype.maxPitchScaleFactor=function(){if(!this.pixelMatrixInverse)return 1;var n=this.pointCoordinate(new a.Point(0,0)),s=[n.x*this.worldSize,n.y*this.worldSize,0,1];return a.transformMat4(s,s,this.pixelMatrix)[3]/this.cameraToCenterDistance},mr.prototype.getCameraPoint=function(){var n=Math.tan(this._pitch)*(this.cameraToCenterDistance||1);return this.centerPoint.add(new a.Point(0,n))},mr.prototype.getCameraQueryGeometry=function(n){var s=this.getCameraPoint();if(n.length===1)return[n[0],s];for(var o=s.x,c=s.y,v=s.x,w=s.y,S=0,E=n;S<E.length;S+=1){var P=E[S];o=Math.min(o,P.x),c=Math.min(c,P.y),v=Math.max(v,P.x),w=Math.max(w,P.y)}return[new a.Point(o,c),new a.Point(v,c),new a.Point(v,w),new a.Point(o,w),new a.Point(o,c)]},Object.defineProperties(mr.prototype,Nr);var Jn=function(n){var s,o,c,v;this._hashName=n&&encodeURIComponent(n),a.bindAll(["_getCurrentHash","_onHashChange","_updateHash"],this),this._updateHash=(s=this._updateHashUnthrottled.bind(this),o=!1,c=null,v=function(){c=null,o&&(s(),c=setTimeout(v,300),o=!1)},function(){return o=!0,c||v(),c})};Jn.prototype.addTo=function(n){return this._map=n,a.window.addEventListener("hashchange",this._onHashChange,!1),this._map.on("moveend",this._updateHash),this},Jn.prototype.remove=function(){return a.window.removeEventListener("hashchange",this._onHashChange,!1),this._map.off("moveend",this._updateHash),clearTimeout(this._updateHash()),delete this._map,this},Jn.prototype.getHashString=function(n){var s=this._map.getCenter(),o=Math.round(100*this._map.getZoom())/100,c=Math.ceil((o*Math.LN2+Math.log(512/360/.5))/Math.LN10),v=Math.pow(10,c),w=Math.round(s.lng*v)/v,S=Math.round(s.lat*v)/v,E=this._map.getBearing(),P=this._map.getPitch(),O="";if(O+=n?"/"+w+"/"+S+"/"+o:o+"/"+S+"/"+w,(E||P)&&(O+="/"+Math.round(10*E)/10),P&&(O+="/"+Math.round(P)),this._hashName){var G=this._hashName,Z=!1,H=a.window.location.hash.slice(1).split("&").map(function(te){var ee=te.split("=")[0];return ee===G?(Z=!0,ee+"="+O):te}).filter(function(te){return te});return Z||H.push(G+"="+O),"#"+H.join("&")}return"#"+O},Jn.prototype._getCurrentHash=function(){var n,s=this,o=a.window.location.hash.replace("#","");return this._hashName?(o.split("&").map(function(c){return c.split("=")}).forEach(function(c){c[0]===s._hashName&&(n=c)}),(n&&n[1]||"").split("/")):o.split("/")},Jn.prototype._onHashChange=function(){var n=this._getCurrentHash();if(n.length>=3&&!n.some(function(o){return isNaN(o)})){var s=this._map.dragRotate.isEnabled()&&this._map.touchZoomRotate.isEnabled()?+(n[3]||0):this._map.getBearing();return this._map.jumpTo({center:[+n[2],+n[1]],zoom:+n[0],bearing:s,pitch:+(n[4]||0)}),!0}return!1},Jn.prototype._updateHashUnthrottled=function(){var n=a.window.location.href.replace(/(#.+)?$/,this.getHashString());try{a.window.history.replaceState(a.window.history.state,null,n)}catch{}};var fs={linearity:.3,easing:a.bezier(0,0,.3,1)},qo=a.extend({deceleration:2500,maxSpeed:1400},fs),ds=a.extend({deceleration:20,maxSpeed:1400},fs),Zh=a.extend({deceleration:1e3,maxSpeed:360},fs),Kh=a.extend({deceleration:1e3,maxSpeed:90},fs),ms=function(n){this._map=n,this.clear()};function ys(n,s){(!n.duration||n.duration<s.duration)&&(n.duration=s.duration,n.easing=s.easing)}function Ca(n,s,o){var c=o.maxSpeed,v=o.linearity,w=o.deceleration,S=a.clamp(n*v/(s/1e3),-c,c),E=Math.abs(S)/(w*v);return{easing:o.easing,duration:1e3*E,amount:S*(E/2)}}ms.prototype.clear=function(){this._inertiaBuffer=[]},ms.prototype.record=function(n){this._drainInertiaBuffer(),this._inertiaBuffer.push({time:a.browser.now(),settings:n})},ms.prototype._drainInertiaBuffer=function(){for(var n=this._inertiaBuffer,s=a.browser.now();n.length>0&&s-n[0].time>160;)n.shift()},ms.prototype._onMoveEnd=function(n){if(this._drainInertiaBuffer(),!(this._inertiaBuffer.length<2)){for(var s={zoom:0,bearing:0,pitch:0,pan:new a.Point(0,0),pinchAround:void 0,around:void 0},o=0,c=this._inertiaBuffer;o<c.length;o+=1){var v=c[o].settings;s.zoom+=v.zoomDelta||0,s.bearing+=v.bearingDelta||0,s.pitch+=v.pitchDelta||0,v.panDelta&&s.pan._add(v.panDelta),v.around&&(s.around=v.around),v.pinchAround&&(s.pinchAround=v.pinchAround)}var w=this._inertiaBuffer[this._inertiaBuffer.length-1].time-this._inertiaBuffer[0].time,S={};if(s.pan.mag()){var E=Ca(s.pan.mag(),w,a.extend({},qo,n||{}));S.offset=s.pan.mult(E.amount/s.pan.mag()),S.center=this._map.transform.center,ys(S,E)}if(s.zoom){var P=Ca(s.zoom,w,ds);S.zoom=this._map.transform.zoom+P.amount,ys(S,P)}if(s.bearing){var O=Ca(s.bearing,w,Zh);S.bearing=this._map.transform.bearing+a.clamp(O.amount,-179,179),ys(S,O)}if(s.pitch){var G=Ca(s.pitch,w,Kh);S.pitch=this._map.transform.pitch+G.amount,ys(S,G)}if(S.zoom||S.bearing){var Z=s.pinchAround===void 0?s.around:s.pinchAround;S.around=Z?this._map.unproject(Z):this._map.getCenter()}return this.clear(),a.extend(S,{noMoveStart:!0})}};var Ci=function(n){function s(c,v,w,S){S===void 0&&(S={});var E=T.mousePos(v.getCanvasContainer(),w),P=v.unproject(E);n.call(this,c,a.extend({point:E,lngLat:P,originalEvent:w},S)),this._defaultPrevented=!1,this.target=v}n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s;var o={defaultPrevented:{configurable:!0}};return s.prototype.preventDefault=function(){this._defaultPrevented=!0},o.defaultPrevented.get=function(){return this._defaultPrevented},Object.defineProperties(s.prototype,o),s}(a.Event),gs=function(n){function s(c,v,w){var S=c==="touchend"?w.changedTouches:w.touches,E=T.touchPos(v.getCanvasContainer(),S),P=E.map(function(Z){return v.unproject(Z)}),O=E.reduce(function(Z,H,te,ee){return Z.add(H.div(ee.length))},new a.Point(0,0)),G=v.unproject(O);n.call(this,c,{points:E,point:O,lngLats:P,lngLat:G,originalEvent:w}),this._defaultPrevented=!1}n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s;var o={defaultPrevented:{configurable:!0}};return s.prototype.preventDefault=function(){this._defaultPrevented=!0},o.defaultPrevented.get=function(){return this._defaultPrevented},Object.defineProperties(s.prototype,o),s}(a.Event),Sc=function(n){function s(c,v,w){n.call(this,c,{originalEvent:w}),this._defaultPrevented=!1}n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s;var o={defaultPrevented:{configurable:!0}};return s.prototype.preventDefault=function(){this._defaultPrevented=!0},o.defaultPrevented.get=function(){return this._defaultPrevented},Object.defineProperties(s.prototype,o),s}(a.Event),Si=function(n,s){this._map=n,this._clickTolerance=s.clickTolerance};Si.prototype.reset=function(){delete this._mousedownPos},Si.prototype.wheel=function(n){return this._firePreventable(new Sc(n.type,this._map,n))},Si.prototype.mousedown=function(n,s){return this._mousedownPos=s,this._firePreventable(new Ci(n.type,this._map,n))},Si.prototype.mouseup=function(n){this._map.fire(new Ci(n.type,this._map,n))},Si.prototype.click=function(n,s){this._mousedownPos&&this._mousedownPos.dist(s)>=this._clickTolerance||this._map.fire(new Ci(n.type,this._map,n))},Si.prototype.dblclick=function(n){return this._firePreventable(new Ci(n.type,this._map,n))},Si.prototype.mouseover=function(n){this._map.fire(new Ci(n.type,this._map,n))},Si.prototype.mouseout=function(n){this._map.fire(new Ci(n.type,this._map,n))},Si.prototype.touchstart=function(n){return this._firePreventable(new gs(n.type,this._map,n))},Si.prototype.touchmove=function(n){this._map.fire(new gs(n.type,this._map,n))},Si.prototype.touchend=function(n){this._map.fire(new gs(n.type,this._map,n))},Si.prototype.touchcancel=function(n){this._map.fire(new gs(n.type,this._map,n))},Si.prototype._firePreventable=function(n){if(this._map.fire(n),n.defaultPrevented)return{}},Si.prototype.isEnabled=function(){return!0},Si.prototype.isActive=function(){return!1},Si.prototype.enable=function(){},Si.prototype.disable=function(){};var dt=function(n){this._map=n};dt.prototype.reset=function(){this._delayContextMenu=!1,delete this._contextMenuEvent},dt.prototype.mousemove=function(n){this._map.fire(new Ci(n.type,this._map,n))},dt.prototype.mousedown=function(){this._delayContextMenu=!0},dt.prototype.mouseup=function(){this._delayContextMenu=!1,this._contextMenuEvent&&(this._map.fire(new Ci("contextmenu",this._map,this._contextMenuEvent)),delete this._contextMenuEvent)},dt.prototype.contextmenu=function(n){this._delayContextMenu?this._contextMenuEvent=n:this._map.fire(new Ci(n.type,this._map,n)),this._map.listens("contextmenu")&&n.preventDefault()},dt.prototype.isEnabled=function(){return!0},dt.prototype.isActive=function(){return!1},dt.prototype.enable=function(){},dt.prototype.disable=function(){};var Fn=function(n,s){this._map=n,this._el=n.getCanvasContainer(),this._container=n.getContainer(),this._clickTolerance=s.clickTolerance||1};function Hs(n,s){for(var o={},c=0;c<n.length;c++)o[n[c].identifier]=s[c];return o}Fn.prototype.isEnabled=function(){return!!this._enabled},Fn.prototype.isActive=function(){return!!this._active},Fn.prototype.enable=function(){this.isEnabled()||(this._enabled=!0)},Fn.prototype.disable=function(){this.isEnabled()&&(this._enabled=!1)},Fn.prototype.mousedown=function(n,s){this.isEnabled()&&n.shiftKey&&n.button===0&&(T.disableDrag(),this._startPos=this._lastPos=s,this._active=!0)},Fn.prototype.mousemoveWindow=function(n,s){if(this._active){var o=s;if(!(this._lastPos.equals(o)||!this._box&&o.dist(this._startPos)<this._clickTolerance)){var c=this._startPos;this._lastPos=o,this._box||(this._box=T.create("div","mapboxgl-boxzoom",this._container),this._container.classList.add("mapboxgl-crosshair"),this._fireEvent("boxzoomstart",n));var v=Math.min(c.x,o.x),w=Math.max(c.x,o.x),S=Math.min(c.y,o.y),E=Math.max(c.y,o.y);T.setTransform(this._box,"translate("+v+"px,"+S+"px)"),this._box.style.width=w-v+"px",this._box.style.height=E-S+"px"}}},Fn.prototype.mouseupWindow=function(n,s){var o=this;if(this._active&&n.button===0){var c=this._startPos,v=s;if(this.reset(),T.suppressClick(),c.x!==v.x||c.y!==v.y)return this._map.fire(new a.Event("boxzoomend",{originalEvent:n})),{cameraAnimation:function(w){return w.fitScreenCoordinates(c,v,o._map.getBearing(),{linear:!0})}};this._fireEvent("boxzoomcancel",n)}},Fn.prototype.keydown=function(n){this._active&&n.keyCode===27&&(this.reset(),this._fireEvent("boxzoomcancel",n))},Fn.prototype.blur=function(){this.reset()},Fn.prototype.reset=function(){this._active=!1,this._container.classList.remove("mapboxgl-crosshair"),this._box&&(T.remove(this._box),this._box=null),T.enableDrag(),delete this._startPos,delete this._lastPos},Fn.prototype._fireEvent=function(n,s){return this._map.fire(new a.Event(n,{originalEvent:s}))};var jo=function(n){this.reset(),this.numTouches=n.numTouches};jo.prototype.reset=function(){delete this.centroid,delete this.startTime,delete this.touches,this.aborted=!1},jo.prototype.touchstart=function(n,s,o){(this.centroid||o.length>this.numTouches)&&(this.aborted=!0),this.aborted||(this.startTime===void 0&&(this.startTime=n.timeStamp),o.length===this.numTouches&&(this.centroid=function(c){for(var v=new a.Point(0,0),w=0,S=c;w<S.length;w+=1)v._add(S[w]);return v.div(c.length)}(s),this.touches=Hs(o,s)))},jo.prototype.touchmove=function(n,s,o){if(!this.aborted&&this.centroid){var c=Hs(o,s);for(var v in this.touches){var w=c[v];(!w||w.dist(this.touches[v])>30)&&(this.aborted=!0)}}},jo.prototype.touchend=function(n,s,o){if((!this.centroid||n.timeStamp-this.startTime>500)&&(this.aborted=!0),o.length===0){var c=!this.aborted&&this.centroid;if(this.reset(),c)return c}};var da=function(n){this.singleTap=new jo(n),this.numTaps=n.numTaps,this.reset()};da.prototype.reset=function(){this.lastTime=1/0,delete this.lastTap,this.count=0,this.singleTap.reset()},da.prototype.touchstart=function(n,s,o){this.singleTap.touchstart(n,s,o)},da.prototype.touchmove=function(n,s,o){this.singleTap.touchmove(n,s,o)},da.prototype.touchend=function(n,s,o){var c=this.singleTap.touchend(n,s,o);if(c){var v=n.timeStamp-this.lastTime<500,w=!this.lastTap||this.lastTap.dist(c)<30;if(v&&w||this.reset(),this.count++,this.lastTime=n.timeStamp,this.lastTap=c,this.count===this.numTaps)return this.reset(),c}};var Nn=function(){this._zoomIn=new da({numTouches:1,numTaps:2}),this._zoomOut=new da({numTouches:2,numTaps:1}),this.reset()};Nn.prototype.reset=function(){this._active=!1,this._zoomIn.reset(),this._zoomOut.reset()},Nn.prototype.touchstart=function(n,s,o){this._zoomIn.touchstart(n,s,o),this._zoomOut.touchstart(n,s,o)},Nn.prototype.touchmove=function(n,s,o){this._zoomIn.touchmove(n,s,o),this._zoomOut.touchmove(n,s,o)},Nn.prototype.touchend=function(n,s,o){var c=this,v=this._zoomIn.touchend(n,s,o),w=this._zoomOut.touchend(n,s,o);return v?(this._active=!0,n.preventDefault(),setTimeout(function(){return c.reset()},0),{cameraAnimation:function(S){return S.easeTo({duration:300,zoom:S.getZoom()+1,around:S.unproject(v)},{originalEvent:n})}}):w?(this._active=!0,n.preventDefault(),setTimeout(function(){return c.reset()},0),{cameraAnimation:function(S){return S.easeTo({duration:300,zoom:S.getZoom()-1,around:S.unproject(w)},{originalEvent:n})}}):void 0},Nn.prototype.touchcancel=function(){this.reset()},Nn.prototype.enable=function(){this._enabled=!0},Nn.prototype.disable=function(){this._enabled=!1,this.reset()},Nn.prototype.isEnabled=function(){return this._enabled},Nn.prototype.isActive=function(){return this._active};var Yl={0:1,2:2},it=function(n){this.reset(),this._clickTolerance=n.clickTolerance||1};it.prototype.blur=function(){this.reset()},it.prototype.reset=function(){this._active=!1,this._moved=!1,delete this._lastPoint,delete this._eventButton},it.prototype._correctButton=function(n,s){return!1},it.prototype._move=function(n,s){return{}},it.prototype.mousedown=function(n,s){if(!this._lastPoint){var o=T.mouseButton(n);this._correctButton(n,o)&&(this._lastPoint=s,this._eventButton=o)}},it.prototype.mousemoveWindow=function(n,s){var o=this._lastPoint;if(o){if(n.preventDefault(),function(c,v){var w=Yl[v];return c.buttons===void 0||(c.buttons&w)!==w}(n,this._eventButton))this.reset();else if(this._moved||!(s.dist(o)<this._clickTolerance))return this._moved=!0,this._lastPoint=s,this._move(o,s)}},it.prototype.mouseupWindow=function(n){this._lastPoint&&T.mouseButton(n)===this._eventButton&&(this._moved&&T.suppressClick(),this.reset())},it.prototype.enable=function(){this._enabled=!0},it.prototype.disable=function(){this._enabled=!1,this.reset()},it.prototype.isEnabled=function(){return this._enabled},it.prototype.isActive=function(){return this._active};var Jl=function(n){function s(){n.apply(this,arguments)}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype.mousedown=function(o,c){n.prototype.mousedown.call(this,o,c),this._lastPoint&&(this._active=!0)},s.prototype._correctButton=function(o,c){return c===0&&!o.ctrlKey},s.prototype._move=function(o,c){return{around:c,panDelta:c.sub(o)}},s}(it),Xs=function(n){function s(){n.apply(this,arguments)}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype._correctButton=function(o,c){return c===0&&o.ctrlKey||c===2},s.prototype._move=function(o,c){var v=.8*(c.x-o.x);if(v)return this._active=!0,{bearingDelta:v}},s.prototype.contextmenu=function(o){o.preventDefault()},s}(it),Ql=function(n){function s(){n.apply(this,arguments)}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype._correctButton=function(o,c){return c===0&&o.ctrlKey||c===2},s.prototype._move=function(o,c){var v=-.5*(c.y-o.y);if(v)return this._active=!0,{pitchDelta:v}},s.prototype.contextmenu=function(o){o.preventDefault()},s}(it),ia=function(n){this._minTouches=1,this._clickTolerance=n.clickTolerance||1,this.reset()};ia.prototype.reset=function(){this._active=!1,this._touches={},this._sum=new a.Point(0,0)},ia.prototype.touchstart=function(n,s,o){return this._calculateTransform(n,s,o)},ia.prototype.touchmove=function(n,s,o){if(this._active&&!(o.length<this._minTouches))return n.preventDefault(),this._calculateTransform(n,s,o)},ia.prototype.touchend=function(n,s,o){this._calculateTransform(n,s,o),this._active&&o.length<this._minTouches&&this.reset()},ia.prototype.touchcancel=function(){this.reset()},ia.prototype._calculateTransform=function(n,s,o){o.length>0&&(this._active=!0);var c=Hs(o,s),v=new a.Point(0,0),w=new a.Point(0,0),S=0;for(var E in c){var P=c[E],O=this._touches[E];O&&(v._add(P),w._add(P.sub(O)),S++,c[E]=P)}if(this._touches=c,!(S<this._minTouches)&&w.mag()){var G=w.div(S);if(this._sum._add(G),!(this._sum.mag()<this._clickTolerance))return{around:v.div(S),panDelta:G}}},ia.prototype.enable=function(){this._enabled=!0},ia.prototype.disable=function(){this._enabled=!1,this.reset()},ia.prototype.isEnabled=function(){return this._enabled},ia.prototype.isActive=function(){return this._active};var Vn=function(){this.reset()};function Ws(n,s,o){for(var c=0;c<n.length;c++)if(n[c].identifier===o)return s[c]}function Ys(n,s){return Math.log(n/s)/Math.LN2}Vn.prototype.reset=function(){this._active=!1,delete this._firstTwoTouches},Vn.prototype._start=function(n){},Vn.prototype._move=function(n,s,o){return{}},Vn.prototype.touchstart=function(n,s,o){this._firstTwoTouches||o.length<2||(this._firstTwoTouches=[o[0].identifier,o[1].identifier],this._start([s[0],s[1]]))},Vn.prototype.touchmove=function(n,s,o){if(this._firstTwoTouches){n.preventDefault();var c=this._firstTwoTouches,v=c[1],w=Ws(o,s,c[0]),S=Ws(o,s,v);if(w&&S){var E=this._aroundCenter?null:w.add(S).div(2);return this._move([w,S],E,n)}}},Vn.prototype.touchend=function(n,s,o){if(this._firstTwoTouches){var c=this._firstTwoTouches,v=c[1],w=Ws(o,s,c[0]),S=Ws(o,s,v);w&&S||(this._active&&T.suppressClick(),this.reset())}},Vn.prototype.touchcancel=function(){this.reset()},Vn.prototype.enable=function(n){this._enabled=!0,this._aroundCenter=!!n&&n.around==="center"},Vn.prototype.disable=function(){this._enabled=!1,this.reset()},Vn.prototype.isEnabled=function(){return this._enabled},Vn.prototype.isActive=function(){return this._active};var Un=function(n){function s(){n.apply(this,arguments)}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype.reset=function(){n.prototype.reset.call(this),delete this._distance,delete this._startDistance},s.prototype._start=function(o){this._startDistance=this._distance=o[0].dist(o[1])},s.prototype._move=function(o,c){var v=this._distance;if(this._distance=o[0].dist(o[1]),this._active||!(Math.abs(Ys(this._distance,this._startDistance))<.1))return this._active=!0,{zoomDelta:Ys(this._distance,v),pinchAround:c}},s}(Vn);function Ma(n,s){return 180*n.angleWith(s)/Math.PI}var kc=function(n){function s(){n.apply(this,arguments)}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype.reset=function(){n.prototype.reset.call(this),delete this._minDiameter,delete this._startVector,delete this._vector},s.prototype._start=function(o){this._startVector=this._vector=o[0].sub(o[1]),this._minDiameter=o[0].dist(o[1])},s.prototype._move=function(o,c){var v=this._vector;if(this._vector=o[0].sub(o[1]),this._active||!this._isBelowThreshold(this._vector))return this._active=!0,{bearingDelta:Ma(this._vector,v),pinchAround:c}},s.prototype._isBelowThreshold=function(o){this._minDiameter=Math.min(this._minDiameter,o.mag());var c=25/(Math.PI*this._minDiameter)*360,v=Ma(o,this._startVector);return Math.abs(v)<c},s}(Vn);function _s(n){return Math.abs(n.y)>Math.abs(n.x)}var $l=function(n){function s(){n.apply(this,arguments)}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype.reset=function(){n.prototype.reset.call(this),this._valid=void 0,delete this._firstMove,delete this._lastPoints},s.prototype._start=function(o){this._lastPoints=o,_s(o[0].sub(o[1]))&&(this._valid=!1)},s.prototype._move=function(o,c,v){var w=o[0].sub(this._lastPoints[0]),S=o[1].sub(this._lastPoints[1]);if(this._valid=this.gestureBeginsVertically(w,S,v.timeStamp),this._valid)return this._lastPoints=o,this._active=!0,{pitchDelta:(w.y+S.y)/2*-.5}},s.prototype.gestureBeginsVertically=function(o,c,v){if(this._valid!==void 0)return this._valid;var w=o.mag()>=2,S=c.mag()>=2;if(w||S){if(!w||!S)return this._firstMove===void 0&&(this._firstMove=v),v-this._firstMove<100&&void 0;var E=o.y>0==c.y>0;return _s(o)&&_s(c)&&E}},s}(Vn),eu={panStep:100,bearingStep:15,pitchStep:10},ma=function(){var n=eu;this._panStep=n.panStep,this._bearingStep=n.bearingStep,this._pitchStep=n.pitchStep,this._rotationDisabled=!1};function Qn(n){return n*(2-n)}ma.prototype.blur=function(){this.reset()},ma.prototype.reset=function(){this._active=!1},ma.prototype.keydown=function(n){var s=this;if(!(n.altKey||n.ctrlKey||n.metaKey)){var o=0,c=0,v=0,w=0,S=0;switch(n.keyCode){case 61:case 107:case 171:case 187:o=1;break;case 189:case 109:case 173:o=-1;break;case 37:n.shiftKey?c=-1:(n.preventDefault(),w=-1);break;case 39:n.shiftKey?c=1:(n.preventDefault(),w=1);break;case 38:n.shiftKey?v=1:(n.preventDefault(),S=-1);break;case 40:n.shiftKey?v=-1:(n.preventDefault(),S=1);break;default:return}return this._rotationDisabled&&(c=0,v=0),{cameraAnimation:function(E){var P=E.getZoom();E.easeTo({duration:300,easeId:"keyboardHandler",easing:Qn,zoom:o?Math.round(P)+o*(n.shiftKey?2:1):P,bearing:E.getBearing()+c*s._bearingStep,pitch:E.getPitch()+v*s._pitchStep,offset:[-w*s._panStep,-S*s._panStep],center:E.getCenter()},{originalEvent:n})}}}},ma.prototype.enable=function(){this._enabled=!0},ma.prototype.disable=function(){this._enabled=!1,this.reset()},ma.prototype.isEnabled=function(){return this._enabled},ma.prototype.isActive=function(){return this._active},ma.prototype.disableRotation=function(){this._rotationDisabled=!0},ma.prototype.enableRotation=function(){this._rotationDisabled=!1};var lr=function(n,s){this._map=n,this._el=n.getCanvasContainer(),this._handler=s,this._delta=0,this._defaultZoomRate=.01,this._wheelZoomRate=1/450,a.bindAll(["_onTimeout"],this)};lr.prototype.setZoomRate=function(n){this._defaultZoomRate=n},lr.prototype.setWheelZoomRate=function(n){this._wheelZoomRate=n},lr.prototype.isEnabled=function(){return!!this._enabled},lr.prototype.isActive=function(){return!!this._active||this._finishTimeout!==void 0},lr.prototype.isZooming=function(){return!!this._zooming},lr.prototype.enable=function(n){this.isEnabled()||(this._enabled=!0,this._aroundCenter=n&&n.around==="center")},lr.prototype.disable=function(){this.isEnabled()&&(this._enabled=!1)},lr.prototype.wheel=function(n){if(this.isEnabled()){var s=n.deltaMode===a.window.WheelEvent.DOM_DELTA_LINE?40*n.deltaY:n.deltaY,o=a.browser.now(),c=o-(this._lastWheelEventTime||0);this._lastWheelEventTime=o,s!==0&&s%4.000244140625==0?this._type="wheel":s!==0&&Math.abs(s)<4?this._type="trackpad":c>400?(this._type=null,this._lastValue=s,this._timeout=setTimeout(this._onTimeout,40,n)):this._type||(this._type=Math.abs(c*s)<200?"trackpad":"wheel",this._timeout&&(clearTimeout(this._timeout),this._timeout=null,s+=this._lastValue)),n.shiftKey&&s&&(s/=4),this._type&&(this._lastWheelEvent=n,this._delta-=s,this._active||this._start(n)),n.preventDefault()}},lr.prototype._onTimeout=function(n){this._type="wheel",this._delta-=this._lastValue,this._active||this._start(n)},lr.prototype._start=function(n){if(this._delta){this._frameId&&(this._frameId=null),this._active=!0,this.isZooming()||(this._zooming=!0),this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout);var s=T.mousePos(this._el,n);this._around=a.LngLat.convert(this._aroundCenter?this._map.getCenter():this._map.unproject(s)),this._aroundPoint=this._map.transform.locationPoint(this._around),this._frameId||(this._frameId=!0,this._handler._triggerRenderFrame())}},lr.prototype.renderFrame=function(){var n=this;if(this._frameId&&(this._frameId=null,this.isActive())){var s=this._map.transform;if(this._delta!==0){var o=this._type==="wheel"&&Math.abs(this._delta)>4.000244140625?this._wheelZoomRate:this._defaultZoomRate,c=2/(1+Math.exp(-Math.abs(this._delta*o)));this._delta<0&&c!==0&&(c=1/c);var v=typeof this._targetZoom=="number"?s.zoomScale(this._targetZoom):s.scale;this._targetZoom=Math.min(s.maxZoom,Math.max(s.minZoom,s.scaleZoom(v*c))),this._type==="wheel"&&(this._startZoom=s.zoom,this._easing=this._smoothOutEasing(200)),this._delta=0}var w,S=typeof this._targetZoom=="number"?this._targetZoom:s.zoom,E=this._startZoom,P=this._easing,O=!1;if(this._type==="wheel"&&E&&P){var G=Math.min((a.browser.now()-this._lastWheelEventTime)/200,1),Z=P(G);w=a.number(E,S,Z),G<1?this._frameId||(this._frameId=!0):O=!0}else w=S,O=!0;return this._active=!0,O&&(this._active=!1,this._finishTimeout=setTimeout(function(){n._zooming=!1,n._handler._triggerRenderFrame(),delete n._targetZoom,delete n._finishTimeout},200)),{noInertia:!0,needsRenderFrame:!O,zoomDelta:w-s.zoom,around:this._aroundPoint,originalEvent:this._lastWheelEvent}}},lr.prototype._smoothOutEasing=function(n){var s=a.ease;if(this._prevEase){var o=this._prevEase,c=(a.browser.now()-o.start)/o.duration,v=o.easing(c+.01)-o.easing(c),w=.27/Math.sqrt(v*v+1e-4)*.01,S=Math.sqrt(.0729-w*w);s=a.bezier(w,S,.25,1)}return this._prevEase={start:a.browser.now(),duration:n,easing:s},s},lr.prototype.blur=function(){this.reset()},lr.prototype.reset=function(){this._active=!1};var Ea=function(n,s){this._clickZoom=n,this._tapZoom=s};Ea.prototype.enable=function(){this._clickZoom.enable(),this._tapZoom.enable()},Ea.prototype.disable=function(){this._clickZoom.disable(),this._tapZoom.disable()},Ea.prototype.isEnabled=function(){return this._clickZoom.isEnabled()&&this._tapZoom.isEnabled()},Ea.prototype.isActive=function(){return this._clickZoom.isActive()||this._tapZoom.isActive()};var na=function(){this.reset()};na.prototype.reset=function(){this._active=!1},na.prototype.blur=function(){this.reset()},na.prototype.dblclick=function(n,s){return n.preventDefault(),{cameraAnimation:function(o){o.easeTo({duration:300,zoom:o.getZoom()+(n.shiftKey?-1:1),around:o.unproject(s)},{originalEvent:n})}}},na.prototype.enable=function(){this._enabled=!0},na.prototype.disable=function(){this._enabled=!1,this.reset()},na.prototype.isEnabled=function(){return this._enabled},na.prototype.isActive=function(){return this._active};var on=function(){this._tap=new da({numTouches:1,numTaps:1}),this.reset()};on.prototype.reset=function(){this._active=!1,delete this._swipePoint,delete this._swipeTouch,delete this._tapTime,this._tap.reset()},on.prototype.touchstart=function(n,s,o){this._swipePoint||(this._tapTime&&n.timeStamp-this._tapTime>500&&this.reset(),this._tapTime?o.length>0&&(this._swipePoint=s[0],this._swipeTouch=o[0].identifier):this._tap.touchstart(n,s,o))},on.prototype.touchmove=function(n,s,o){if(this._tapTime){if(this._swipePoint){if(o[0].identifier!==this._swipeTouch)return;var c=s[0],v=c.y-this._swipePoint.y;return this._swipePoint=c,n.preventDefault(),this._active=!0,{zoomDelta:v/128}}}else this._tap.touchmove(n,s,o)},on.prototype.touchend=function(n,s,o){this._tapTime?this._swipePoint&&o.length===0&&this.reset():this._tap.touchend(n,s,o)&&(this._tapTime=n.timeStamp)},on.prototype.touchcancel=function(){this.reset()},on.prototype.enable=function(){this._enabled=!0},on.prototype.disable=function(){this._enabled=!1,this.reset()},on.prototype.isEnabled=function(){return this._enabled},on.prototype.isActive=function(){return this._active};var ko=function(n,s,o){this._el=n,this._mousePan=s,this._touchPan=o};ko.prototype.enable=function(n){this._inertiaOptions=n||{},this._mousePan.enable(),this._touchPan.enable(),this._el.classList.add("mapboxgl-touch-drag-pan")},ko.prototype.disable=function(){this._mousePan.disable(),this._touchPan.disable(),this._el.classList.remove("mapboxgl-touch-drag-pan")},ko.prototype.isEnabled=function(){return this._mousePan.isEnabled()&&this._touchPan.isEnabled()},ko.prototype.isActive=function(){return this._mousePan.isActive()||this._touchPan.isActive()};var Xa=function(n,s,o){this._pitchWithRotate=n.pitchWithRotate,this._mouseRotate=s,this._mousePitch=o};Xa.prototype.enable=function(){this._mouseRotate.enable(),this._pitchWithRotate&&this._mousePitch.enable()},Xa.prototype.disable=function(){this._mouseRotate.disable(),this._mousePitch.disable()},Xa.prototype.isEnabled=function(){return this._mouseRotate.isEnabled()&&(!this._pitchWithRotate||this._mousePitch.isEnabled())},Xa.prototype.isActive=function(){return this._mouseRotate.isActive()||this._mousePitch.isActive()};var ya=function(n,s,o,c){this._el=n,this._touchZoom=s,this._touchRotate=o,this._tapDragZoom=c,this._rotationDisabled=!1,this._enabled=!0};ya.prototype.enable=function(n){this._touchZoom.enable(n),this._rotationDisabled||this._touchRotate.enable(n),this._tapDragZoom.enable(),this._el.classList.add("mapboxgl-touch-zoom-rotate")},ya.prototype.disable=function(){this._touchZoom.disable(),this._touchRotate.disable(),this._tapDragZoom.disable(),this._el.classList.remove("mapboxgl-touch-zoom-rotate")},ya.prototype.isEnabled=function(){return this._touchZoom.isEnabled()&&(this._rotationDisabled||this._touchRotate.isEnabled())&&this._tapDragZoom.isEnabled()},ya.prototype.isActive=function(){return this._touchZoom.isActive()||this._touchRotate.isActive()||this._tapDragZoom.isActive()},ya.prototype.disableRotation=function(){this._rotationDisabled=!0,this._touchRotate.disable()},ya.prototype.enableRotation=function(){this._rotationDisabled=!1,this._touchZoom.isEnabled()&&this._touchRotate.enable()};var vn=function(n){return n.zoom||n.drag||n.pitch||n.rotate},vs=function(n){function s(){n.apply(this,arguments)}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s}(a.Event);function kt(n){return n.panDelta&&n.panDelta.mag()||n.zoomDelta||n.bearingDelta||n.pitchDelta}var gt=function(n,s){this._map=n,this._el=this._map.getCanvasContainer(),this._handlers=[],this._handlersById={},this._changes=[],this._inertia=new ms(n),this._bearingSnap=s.bearingSnap,this._previousActiveHandlers={},this._eventsInProgress={},this._addDefaultHandlers(s),a.bindAll(["handleEvent","handleWindowEvent"],this);var o=this._el;this._listeners=[[o,"touchstart",{passive:!0}],[o,"touchmove",{passive:!1}],[o,"touchend",void 0],[o,"touchcancel",void 0],[o,"mousedown",void 0],[o,"mousemove",void 0],[o,"mouseup",void 0],[a.window.document,"mousemove",{capture:!0}],[a.window.document,"mouseup",void 0],[o,"mouseover",void 0],[o,"mouseout",void 0],[o,"dblclick",void 0],[o,"click",void 0],[o,"keydown",{capture:!1}],[o,"keyup",void 0],[o,"wheel",{passive:!1}],[o,"contextmenu",void 0],[a.window,"blur",void 0]];for(var c=0,v=this._listeners;c<v.length;c+=1){var w=v[c],S=w[0];T.addEventListener(S,w[1],S===a.window.document?this.handleWindowEvent:this.handleEvent,w[2])}};gt.prototype.destroy=function(){for(var n=0,s=this._listeners;n<s.length;n+=1){var o=s[n],c=o[0];T.removeEventListener(c,o[1],c===a.window.document?this.handleWindowEvent:this.handleEvent,o[2])}},gt.prototype._addDefaultHandlers=function(n){var s=this._map,o=s.getCanvasContainer();this._add("mapEvent",new Si(s,n));var c=s.boxZoom=new Fn(s,n);this._add("boxZoom",c);var v=new Nn,w=new na;s.doubleClickZoom=new Ea(w,v),this._add("tapZoom",v),this._add("clickZoom",w);var S=new on;this._add("tapDragZoom",S);var E=s.touchPitch=new $l;this._add("touchPitch",E);var P=new Xs(n),O=new Ql(n);s.dragRotate=new Xa(n,P,O),this._add("mouseRotate",P,["mousePitch"]),this._add("mousePitch",O,["mouseRotate"]);var G=new Jl(n),Z=new ia(n);s.dragPan=new ko(o,G,Z),this._add("mousePan",G),this._add("touchPan",Z,["touchZoom","touchRotate"]);var H=new kc,te=new Un;s.touchZoomRotate=new ya(o,te,H,S),this._add("touchRotate",H,["touchPan","touchZoom"]),this._add("touchZoom",te,["touchPan","touchRotate"]);var ee=s.scrollZoom=new lr(s,this);this._add("scrollZoom",ee,["mousePan"]);var ce=s.keyboard=new ma;this._add("keyboard",ce),this._add("blockableMapEvent",new dt(s));for(var Y=0,le=["boxZoom","doubleClickZoom","tapDragZoom","touchPitch","dragRotate","dragPan","touchZoomRotate","scrollZoom","keyboard"];Y<le.length;Y+=1){var de=le[Y];n.interactive&&n[de]&&s[de].enable(n[de])}},gt.prototype._add=function(n,s,o){this._handlers.push({handlerName:n,handler:s,allowed:o}),this._handlersById[n]=s},gt.prototype.stop=function(n){if(!this._updatingCamera){for(var s=0,o=this._handlers;s<o.length;s+=1)o[s].handler.reset();this._inertia.clear(),this._fireEvents({},{},n),this._changes=[]}},gt.prototype.isActive=function(){for(var n=0,s=this._handlers;n<s.length;n+=1)if(s[n].handler.isActive())return!0;return!1},gt.prototype.isZooming=function(){return!!this._eventsInProgress.zoom||this._map.scrollZoom.isZooming()},gt.prototype.isRotating=function(){return!!this._eventsInProgress.rotate},gt.prototype.isMoving=function(){return!!vn(this._eventsInProgress)||this.isZooming()},gt.prototype._blockedByActive=function(n,s,o){for(var c in n)if(c!==o&&(!s||s.indexOf(c)<0))return!0;return!1},gt.prototype.handleWindowEvent=function(n){this.handleEvent(n,n.type+"Window")},gt.prototype._getMapTouches=function(n){for(var s=[],o=0,c=n;o<c.length;o+=1){var v=c[o];this._el.contains(v.target)&&s.push(v)}return s},gt.prototype.handleEvent=function(n,s){this._updatingCamera=!0;for(var o=n.type==="renderFrame"?void 0:n,c={needsRenderFrame:!1},v={},w={},S=n.touches?this._getMapTouches(n.touches):void 0,E=S?T.touchPos(this._el,S):T.mousePos(this._el,n),P=0,O=this._handlers;P<O.length;P+=1){var G=O[P],Z=G.handlerName,H=G.handler,te=G.allowed;if(H.isEnabled()){var ee=void 0;this._blockedByActive(w,te,Z)?H.reset():H[s||n.type]&&(ee=H[s||n.type](n,E,S),this.mergeHandlerResult(c,v,ee,Z,o),ee&&ee.needsRenderFrame&&this._triggerRenderFrame()),(ee||H.isActive())&&(w[Z]=H)}}var ce={};for(var Y in this._previousActiveHandlers)w[Y]||(ce[Y]=o);this._previousActiveHandlers=w,(Object.keys(ce).length||kt(c))&&(this._changes.push([c,v,ce]),this._triggerRenderFrame()),(Object.keys(w).length||kt(c))&&this._map._stop(!0),this._updatingCamera=!1;var le=c.cameraAnimation;le&&(this._inertia.clear(),this._fireEvents({},{},!0),this._changes=[],le(this._map))},gt.prototype.mergeHandlerResult=function(n,s,o,c,v){if(o){a.extend(n,o);var w={handlerName:c,originalEvent:o.originalEvent||v};o.zoomDelta!==void 0&&(s.zoom=w),o.panDelta!==void 0&&(s.drag=w),o.pitchDelta!==void 0&&(s.pitch=w),o.bearingDelta!==void 0&&(s.rotate=w)}},gt.prototype._applyChanges=function(){for(var n={},s={},o={},c=0,v=this._changes;c<v.length;c+=1){var w=v[c],S=w[0],E=w[1],P=w[2];S.panDelta&&(n.panDelta=(n.panDelta||new a.Point(0,0))._add(S.panDelta)),S.zoomDelta&&(n.zoomDelta=(n.zoomDelta||0)+S.zoomDelta),S.bearingDelta&&(n.bearingDelta=(n.bearingDelta||0)+S.bearingDelta),S.pitchDelta&&(n.pitchDelta=(n.pitchDelta||0)+S.pitchDelta),S.around!==void 0&&(n.around=S.around),S.pinchAround!==void 0&&(n.pinchAround=S.pinchAround),S.noInertia&&(n.noInertia=S.noInertia),a.extend(s,E),a.extend(o,P)}this._updateMapTransform(n,s,o),this._changes=[]},gt.prototype._updateMapTransform=function(n,s,o){var c=this._map,v=c.transform;if(!kt(n))return this._fireEvents(s,o,!0);var w=n.panDelta,S=n.zoomDelta,E=n.bearingDelta,P=n.pitchDelta,O=n.around,G=n.pinchAround;G!==void 0&&(O=G),c._stop(!0),O=O||c.transform.centerPoint;var Z=v.pointLocation(w?O.sub(w):O);E&&(v.bearing+=E),P&&(v.pitch+=P),S&&(v.zoom+=S),v.setLocationAtPoint(Z,O),this._map._update(),n.noInertia||this._inertia.record(n),this._fireEvents(s,o,!0)},gt.prototype._fireEvents=function(n,s,o){var c=this,v=vn(this._eventsInProgress),w=vn(n),S={};for(var E in n)this._eventsInProgress[E]||(S[E+"start"]=n[E].originalEvent),this._eventsInProgress[E]=n[E];for(var P in!v&&w&&this._fireEvent("movestart",w.originalEvent),S)this._fireEvent(P,S[P]);for(var O in w&&this._fireEvent("move",w.originalEvent),n)this._fireEvent(O,n[O].originalEvent);var G,Z={};for(var H in this._eventsInProgress){var te=this._eventsInProgress[H],ee=te.handlerName,ce=te.originalEvent;this._handlersById[ee].isActive()||(delete this._eventsInProgress[H],Z[H+"end"]=G=s[ee]||ce)}for(var Y in Z)this._fireEvent(Y,Z[Y]);var le=vn(this._eventsInProgress);if(o&&(v||w)&&!le){this._updatingCamera=!0;var de=this._inertia._onMoveEnd(this._map.dragPan._inertiaOptions),_e=function(Ie){return Ie!==0&&-c._bearingSnap<Ie&&Ie<c._bearingSnap};de?(_e(de.bearing||this._map.getBearing())&&(de.bearing=0),this._map.easeTo(de,{originalEvent:G})):(this._map.fire(new a.Event("moveend",{originalEvent:G})),_e(this._map.getBearing())&&this._map.resetNorth()),this._updatingCamera=!1}},gt.prototype._fireEvent=function(n,s){this._map.fire(new a.Event(n,s?{originalEvent:s}:{}))},gt.prototype._requestFrame=function(){var n=this;return this._map.triggerRepaint(),this._map._renderTaskQueue.add(function(s){delete n._frameId,n.handleEvent(new vs("renderFrame",{timeStamp:s})),n._applyChanges()})},gt.prototype._triggerRenderFrame=function(){this._frameId===void 0&&(this._frameId=this._requestFrame())};var Js=function(n){function s(o,c){n.call(this),this._moving=!1,this._zooming=!1,this.transform=o,this._bearingSnap=c.bearingSnap,a.bindAll(["_renderFrameCallback"],this)}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype.getCenter=function(){return new a.LngLat(this.transform.center.lng,this.transform.center.lat)},s.prototype.setCenter=function(o,c){return this.jumpTo({center:o},c)},s.prototype.panBy=function(o,c,v){return o=a.Point.convert(o).mult(-1),this.panTo(this.transform.center,a.extend({offset:o},c),v)},s.prototype.panTo=function(o,c,v){return this.easeTo(a.extend({center:o},c),v)},s.prototype.getZoom=function(){return this.transform.zoom},s.prototype.setZoom=function(o,c){return this.jumpTo({zoom:o},c),this},s.prototype.zoomTo=function(o,c,v){return this.easeTo(a.extend({zoom:o},c),v)},s.prototype.zoomIn=function(o,c){return this.zoomTo(this.getZoom()+1,o,c),this},s.prototype.zoomOut=function(o,c){return this.zoomTo(this.getZoom()-1,o,c),this},s.prototype.getBearing=function(){return this.transform.bearing},s.prototype.setBearing=function(o,c){return this.jumpTo({bearing:o},c),this},s.prototype.getPadding=function(){return this.transform.padding},s.prototype.setPadding=function(o,c){return this.jumpTo({padding:o},c),this},s.prototype.rotateTo=function(o,c,v){return this.easeTo(a.extend({bearing:o},c),v)},s.prototype.resetNorth=function(o,c){return this.rotateTo(0,a.extend({duration:1e3},o),c),this},s.prototype.resetNorthPitch=function(o,c){return this.easeTo(a.extend({bearing:0,pitch:0,duration:1e3},o),c),this},s.prototype.snapToNorth=function(o,c){return Math.abs(this.getBearing())<this._bearingSnap?this.resetNorth(o,c):this},s.prototype.getPitch=function(){return this.transform.pitch},s.prototype.setPitch=function(o,c){return this.jumpTo({pitch:o},c),this},s.prototype.cameraForBounds=function(o,c){o=a.LngLatBounds.convert(o);var v=c&&c.bearing||0;return this._cameraForBoxAndBearing(o.getNorthWest(),o.getSouthEast(),v,c)},s.prototype._cameraForBoxAndBearing=function(o,c,v,w){var S={top:0,bottom:0,right:0,left:0};if(typeof(w=a.extend({padding:S,offset:[0,0],maxZoom:this.transform.maxZoom},w)).padding=="number"){var E=w.padding;w.padding={top:E,bottom:E,right:E,left:E}}w.padding=a.extend(S,w.padding);var P=this.transform,O=P.padding,G=P.project(a.LngLat.convert(o)),Z=P.project(a.LngLat.convert(c)),H=G.rotate(-v*Math.PI/180),te=Z.rotate(-v*Math.PI/180),ee=new a.Point(Math.max(H.x,te.x),Math.max(H.y,te.y)),ce=new a.Point(Math.min(H.x,te.x),Math.min(H.y,te.y)),Y=ee.sub(ce),le=(P.width-(O.left+O.right+w.padding.left+w.padding.right))/Y.x,de=(P.height-(O.top+O.bottom+w.padding.top+w.padding.bottom))/Y.y;if(!(de<0||le<0)){var _e=Math.min(P.scaleZoom(P.scale*Math.min(le,de)),w.maxZoom),Ie=typeof w.offset.x=="number"?new a.Point(w.offset.x,w.offset.y):a.Point.convert(w.offset),Se=new a.Point((w.padding.left-w.padding.right)/2,(w.padding.top-w.padding.bottom)/2).rotate(v*Math.PI/180),ze=Ie.add(Se).mult(P.scale/P.zoomScale(_e));return{center:P.unproject(G.add(Z).div(2).sub(ze)),zoom:_e,bearing:v}}a.warnOnce("Map cannot fit within canvas with the given bounds, padding, and/or offset.")},s.prototype.fitBounds=function(o,c,v){return this._fitInternal(this.cameraForBounds(o,c),c,v)},s.prototype.fitScreenCoordinates=function(o,c,v,w,S){return this._fitInternal(this._cameraForBoxAndBearing(this.transform.pointLocation(a.Point.convert(o)),this.transform.pointLocation(a.Point.convert(c)),v,w),w,S)},s.prototype._fitInternal=function(o,c,v){return o?(delete(c=a.extend(o,c)).padding,c.linear?this.easeTo(c,v):this.flyTo(c,v)):this},s.prototype.jumpTo=function(o,c){this.stop();var v=this.transform,w=!1,S=!1,E=!1;return"zoom"in o&&v.zoom!==+o.zoom&&(w=!0,v.zoom=+o.zoom),o.center!==void 0&&(v.center=a.LngLat.convert(o.center)),"bearing"in o&&v.bearing!==+o.bearing&&(S=!0,v.bearing=+o.bearing),"pitch"in o&&v.pitch!==+o.pitch&&(E=!0,v.pitch=+o.pitch),o.padding==null||v.isPaddingEqual(o.padding)||(v.padding=o.padding),this.fire(new a.Event("movestart",c)).fire(new a.Event("move",c)),w&&this.fire(new a.Event("zoomstart",c)).fire(new a.Event("zoom",c)).fire(new a.Event("zoomend",c)),S&&this.fire(new a.Event("rotatestart",c)).fire(new a.Event("rotate",c)).fire(new a.Event("rotateend",c)),E&&this.fire(new a.Event("pitchstart",c)).fire(new a.Event("pitch",c)).fire(new a.Event("pitchend",c)),this.fire(new a.Event("moveend",c))},s.prototype.easeTo=function(o,c){var v=this;this._stop(!1,o.easeId),((o=a.extend({offset:[0,0],duration:500,easing:a.ease},o)).animate===!1||!o.essential&&a.browser.prefersReducedMotion)&&(o.duration=0);var w=this.transform,S=this.getZoom(),E=this.getBearing(),P=this.getPitch(),O=this.getPadding(),G="zoom"in o?+o.zoom:S,Z="bearing"in o?this._normalizeBearing(o.bearing,E):E,H="pitch"in o?+o.pitch:P,te="padding"in o?o.padding:w.padding,ee=a.Point.convert(o.offset),ce=w.centerPoint.add(ee),Y=w.pointLocation(ce),le=a.LngLat.convert(o.center||Y);this._normalizeCenter(le);var de,_e,Ie=w.project(Y),Se=w.project(le).sub(Ie),ze=w.zoomScale(G-S);o.around&&(de=a.LngLat.convert(o.around),_e=w.locationPoint(de));var Fe={moving:this._moving,zooming:this._zooming,rotating:this._rotating,pitching:this._pitching};return this._zooming=this._zooming||G!==S,this._rotating=this._rotating||E!==Z,this._pitching=this._pitching||H!==P,this._padding=!w.isPaddingEqual(te),this._easeId=o.easeId,this._prepareEase(c,o.noMoveStart,Fe),this._ease(function(Ye){if(v._zooming&&(w.zoom=a.number(S,G,Ye)),v._rotating&&(w.bearing=a.number(E,Z,Ye)),v._pitching&&(w.pitch=a.number(P,H,Ye)),v._padding&&(w.interpolatePadding(O,te,Ye),ce=w.centerPoint.add(ee)),de)w.setLocationAtPoint(de,_e);else{var Xe=w.zoomScale(w.zoom-S),pt=G>S?Math.min(2,ze):Math.max(.5,ze),Et=Math.pow(pt,1-Ye),Pt=w.unproject(Ie.add(Se.mult(Ye*Et)).mult(Xe));w.setLocationAtPoint(w.renderWorldCopies?Pt.wrap():Pt,ce)}v._fireMoveEvents(c)},function(Ye){v._afterEase(c,Ye)},o),this},s.prototype._prepareEase=function(o,c,v){v===void 0&&(v={}),this._moving=!0,c||v.moving||this.fire(new a.Event("movestart",o)),this._zooming&&!v.zooming&&this.fire(new a.Event("zoomstart",o)),this._rotating&&!v.rotating&&this.fire(new a.Event("rotatestart",o)),this._pitching&&!v.pitching&&this.fire(new a.Event("pitchstart",o))},s.prototype._fireMoveEvents=function(o){this.fire(new a.Event("move",o)),this._zooming&&this.fire(new a.Event("zoom",o)),this._rotating&&this.fire(new a.Event("rotate",o)),this._pitching&&this.fire(new a.Event("pitch",o))},s.prototype._afterEase=function(o,c){if(!this._easeId||!c||this._easeId!==c){delete this._easeId;var v=this._zooming,w=this._rotating,S=this._pitching;this._moving=!1,this._zooming=!1,this._rotating=!1,this._pitching=!1,this._padding=!1,v&&this.fire(new a.Event("zoomend",o)),w&&this.fire(new a.Event("rotateend",o)),S&&this.fire(new a.Event("pitchend",o)),this.fire(new a.Event("moveend",o))}},s.prototype.flyTo=function(o,c){var v=this;if(!o.essential&&a.browser.prefersReducedMotion){var w=a.pick(o,["center","zoom","bearing","pitch","around"]);return this.jumpTo(w,c)}this.stop(),o=a.extend({offset:[0,0],speed:1.2,curve:1.42,easing:a.ease},o);var S=this.transform,E=this.getZoom(),P=this.getBearing(),O=this.getPitch(),G=this.getPadding(),Z="zoom"in o?a.clamp(+o.zoom,S.minZoom,S.maxZoom):E,H="bearing"in o?this._normalizeBearing(o.bearing,P):P,te="pitch"in o?+o.pitch:O,ee="padding"in o?o.padding:S.padding,ce=S.zoomScale(Z-E),Y=a.Point.convert(o.offset),le=S.centerPoint.add(Y),de=S.pointLocation(le),_e=a.LngLat.convert(o.center||de);this._normalizeCenter(_e);var Ie=S.project(de),Se=S.project(_e).sub(Ie),ze=o.curve,Fe=Math.max(S.width,S.height),Ye=Fe/ce,Xe=Se.mag();if("minZoom"in o){var pt=a.clamp(Math.min(o.minZoom,E,Z),S.minZoom,S.maxZoom),Et=Fe/S.zoomScale(pt-E);ze=Math.sqrt(Et/Xe*2)}var Pt=ze*ze;function At(Lt){var Ct=(Ye*Ye-Fe*Fe+(Lt?-1:1)*Pt*Pt*Xe*Xe)/(2*(Lt?Ye:Fe)*Pt*Xe);return Math.log(Math.sqrt(Ct*Ct+1)-Ct)}function _r(Lt){return(Math.exp(Lt)-Math.exp(-Lt))/2}function ft(Lt){return(Math.exp(Lt)+Math.exp(-Lt))/2}var Nt=At(0),Yt=function(Lt){return ft(Nt)/ft(Nt+ze*Lt)},Ft=function(Lt){return Fe*((ft(Nt)*(_r(Ct=Nt+ze*Lt)/ft(Ct))-_r(Nt))/Pt)/Xe;var Ct},Ot=(At(1)-Nt)/ze;if(Math.abs(Xe)<1e-6||!isFinite(Ot)){if(Math.abs(Fe-Ye)<1e-6)return this.easeTo(o,c);var Xt=Ye<Fe?-1:1;Ot=Math.abs(Math.log(Ye/Fe))/ze,Ft=function(){return 0},Yt=function(Lt){return Math.exp(Xt*ze*Lt)}}return o.duration="duration"in o?+o.duration:1e3*Ot/("screenSpeed"in o?+o.screenSpeed/ze:+o.speed),o.maxDuration&&o.duration>o.maxDuration&&(o.duration=0),this._zooming=!0,this._rotating=P!==H,this._pitching=te!==O,this._padding=!S.isPaddingEqual(ee),this._prepareEase(c,!1),this._ease(function(Lt){var Ct=Lt*Ot,Fi=1/Yt(Ct);S.zoom=Lt===1?Z:E+S.scaleZoom(Fi),v._rotating&&(S.bearing=a.number(P,H,Lt)),v._pitching&&(S.pitch=a.number(O,te,Lt)),v._padding&&(S.interpolatePadding(G,ee,Lt),le=S.centerPoint.add(Y));var ui=Lt===1?_e:S.unproject(Ie.add(Se.mult(Ft(Ct))).mult(Fi));S.setLocationAtPoint(S.renderWorldCopies?ui.wrap():ui,le),v._fireMoveEvents(c)},function(){return v._afterEase(c)},o),this},s.prototype.isEasing=function(){return!!this._easeFrameId},s.prototype.stop=function(){return this._stop()},s.prototype._stop=function(o,c){if(this._easeFrameId&&(this._cancelRenderFrame(this._easeFrameId),delete this._easeFrameId,delete this._onEaseFrame),this._onEaseEnd){var v=this._onEaseEnd;delete this._onEaseEnd,v.call(this,c)}if(!o){var w=this.handlers;w&&w.stop(!1)}return this},s.prototype._ease=function(o,c,v){v.animate===!1||v.duration===0?(o(1),c()):(this._easeStart=a.browser.now(),this._easeOptions=v,this._onEaseFrame=o,this._onEaseEnd=c,this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback))},s.prototype._renderFrameCallback=function(){var o=Math.min((a.browser.now()-this._easeStart)/this._easeOptions.duration,1);this._onEaseFrame(this._easeOptions.easing(o)),o<1?this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback):this.stop()},s.prototype._normalizeBearing=function(o,c){o=a.wrap(o,-180,180);var v=Math.abs(o-c);return Math.abs(o-360-c)<v&&(o-=360),Math.abs(o+360-c)<v&&(o+=360),o},s.prototype._normalizeCenter=function(o){var c=this.transform;if(c.renderWorldCopies&&!c.lngRange){var v=o.lng-c.center.lng;o.lng+=v>180?-360:v<-180?360:0}},s}(a.Evented),bn=function(n){n===void 0&&(n={}),this.options=n,a.bindAll(["_toggleAttribution","_updateEditLink","_updateData","_updateCompact"],this)};bn.prototype.getDefaultPosition=function(){return"bottom-right"},bn.prototype.onAdd=function(n){var s=this.options&&this.options.compact;return this._map=n,this._container=T.create("div","mapboxgl-ctrl mapboxgl-ctrl-attrib"),this._compactButton=T.create("button","mapboxgl-ctrl-attrib-button",this._container),this._compactButton.addEventListener("click",this._toggleAttribution),this._setElementTitle(this._compactButton,"ToggleAttribution"),this._innerContainer=T.create("div","mapboxgl-ctrl-attrib-inner",this._container),this._innerContainer.setAttribute("role","list"),s&&this._container.classList.add("mapboxgl-compact"),this._updateAttributions(),this._updateEditLink(),this._map.on("styledata",this._updateData),this._map.on("sourcedata",this._updateData),this._map.on("moveend",this._updateEditLink),s===void 0&&(this._map.on("resize",this._updateCompact),this._updateCompact()),this._container},bn.prototype.onRemove=function(){T.remove(this._container),this._map.off("styledata",this._updateData),this._map.off("sourcedata",this._updateData),this._map.off("moveend",this._updateEditLink),this._map.off("resize",this._updateCompact),this._map=void 0,this._attribHTML=void 0},bn.prototype._setElementTitle=function(n,s){var o=this._map._getUIString("AttributionControl."+s);n.title=o,n.setAttribute("aria-label",o)},bn.prototype._toggleAttribution=function(){this._container.classList.contains("mapboxgl-compact-show")?(this._container.classList.remove("mapboxgl-compact-show"),this._compactButton.setAttribute("aria-pressed","false")):(this._container.classList.add("mapboxgl-compact-show"),this._compactButton.setAttribute("aria-pressed","true"))},bn.prototype._updateEditLink=function(){var n=this._editLink;n||(n=this._editLink=this._container.querySelector(".mapbox-improve-map"));var s=[{key:"owner",value:this.styleOwner},{key:"id",value:this.styleId},{key:"access_token",value:this._map._requestManager._customAccessToken||a.config.ACCESS_TOKEN}];if(n){var o=s.reduce(function(c,v,w){return v.value&&(c+=v.key+"="+v.value+(w<s.length-1?"&":"")),c},"?");n.href=a.config.FEEDBACK_URL+"/"+o+(this._map._hash?this._map._hash.getHashString(!0):""),n.rel="noopener nofollow",this._setElementTitle(n,"MapFeedback")}},bn.prototype._updateData=function(n){!n||n.sourceDataType!=="metadata"&&n.sourceDataType!=="visibility"&&n.dataType!=="style"||(this._updateAttributions(),this._updateEditLink())},bn.prototype._updateAttributions=function(){if(this._map.style){var n=[];if(this.options.customAttribution&&(Array.isArray(this.options.customAttribution)?n=n.concat(this.options.customAttribution.map(function(E){return typeof E!="string"?"":E})):typeof this.options.customAttribution=="string"&&n.push(this.options.customAttribution)),this._map.style.stylesheet){var s=this._map.style.stylesheet;this.styleOwner=s.owner,this.styleId=s.id}var o=this._map.style.sourceCaches;for(var c in o){var v=o[c];if(v.used){var w=v.getSource();w.attribution&&n.indexOf(w.attribution)<0&&n.push(w.attribution)}}n.sort(function(E,P){return E.length-P.length});var S=(n=n.filter(function(E,P){for(var O=P+1;O<n.length;O++)if(n[O].indexOf(E)>=0)return!1;return!0})).join(" | ");S!==this._attribHTML&&(this._attribHTML=S,n.length?(this._innerContainer.innerHTML=S,this._container.classList.remove("mapboxgl-attrib-empty")):this._container.classList.add("mapboxgl-attrib-empty"),this._editLink=null)}},bn.prototype._updateCompact=function(){this._map.getCanvasContainer().offsetWidth<=640?this._container.classList.add("mapboxgl-compact"):this._container.classList.remove("mapboxgl-compact","mapboxgl-compact-show")};var ga=function(){a.bindAll(["_updateLogo"],this),a.bindAll(["_updateCompact"],this)};ga.prototype.onAdd=function(n){this._map=n,this._container=T.create("div","mapboxgl-ctrl");var s=T.create("a","mapboxgl-ctrl-logo");return s.target="_blank",s.rel="noopener nofollow",s.href="https://www.mapbox.com/",s.setAttribute("aria-label",this._map._getUIString("LogoControl.Title")),s.setAttribute("rel","noopener nofollow"),this._container.appendChild(s),this._container.style.display="none",this._map.on("sourcedata",this._updateLogo),this._updateLogo(),this._map.on("resize",this._updateCompact),this._updateCompact(),this._container},ga.prototype.onRemove=function(){T.remove(this._container),this._map.off("sourcedata",this._updateLogo),this._map.off("resize",this._updateCompact)},ga.prototype.getDefaultPosition=function(){return"bottom-left"},ga.prototype._updateLogo=function(n){n&&n.sourceDataType!=="metadata"||(this._container.style.display=this._logoRequired()?"block":"none")},ga.prototype._logoRequired=function(){if(this._map.style){var n=this._map.style.sourceCaches;for(var s in n)if(n[s].getSource().mapbox_logo)return!0;return!1}},ga.prototype._updateCompact=function(){var n=this._container.children;if(n.length){var s=n[0];this._map.getCanvasContainer().offsetWidth<250?s.classList.add("mapboxgl-compact"):s.classList.remove("mapboxgl-compact")}};var sn=function(){this._queue=[],this._id=0,this._cleared=!1,this._currentlyRunning=!1};sn.prototype.add=function(n){var s=++this._id;return this._queue.push({callback:n,id:s,cancelled:!1}),s},sn.prototype.remove=function(n){for(var s=this._currentlyRunning,o=0,c=s?this._queue.concat(s):this._queue;o<c.length;o+=1){var v=c[o];if(v.id===n)return void(v.cancelled=!0)}},sn.prototype.run=function(n){n===void 0&&(n=0);var s=this._currentlyRunning=this._queue;this._queue=[];for(var o=0,c=s;o<c.length;o+=1){var v=c[o];if(!v.cancelled&&(v.callback(n),this._cleared))break}this._cleared=!1,this._currentlyRunning=!1},sn.prototype.clear=function(){this._currentlyRunning&&(this._cleared=!0),this._queue=[]};var Ta={"AttributionControl.ToggleAttribution":"Toggle attribution","AttributionControl.MapFeedback":"Map feedback","FullscreenControl.Enter":"Enter fullscreen","FullscreenControl.Exit":"Exit fullscreen","GeolocateControl.FindMyLocation":"Find my location","GeolocateControl.LocationNotAvailable":"Location not available","LogoControl.Title":"Mapbox logo","NavigationControl.ResetBearing":"Reset bearing to north","NavigationControl.ZoomIn":"Zoom in","NavigationControl.ZoomOut":"Zoom out","ScaleControl.Feet":"ft","ScaleControl.Meters":"m","ScaleControl.Kilometers":"km","ScaleControl.Miles":"mi","ScaleControl.NauticalMiles":"nm"},tu=a.window.HTMLImageElement,Qs=a.window.HTMLElement,Ar=a.window.ImageBitmap,Xi={center:[0,0],zoom:0,bearing:0,pitch:0,minZoom:-2,maxZoom:22,minPitch:0,maxPitch:60,interactive:!0,scrollZoom:!0,boxZoom:!0,dragRotate:!0,dragPan:!0,keyboard:!0,doubleClickZoom:!0,touchZoomRotate:!0,touchPitch:!0,bearingSnap:7,clickTolerance:3,pitchWithRotate:!0,hash:!1,attributionControl:!0,failIfMajorPerformanceCaveat:!1,preserveDrawingBuffer:!1,trackResize:!0,renderWorldCopies:!0,refreshExpiredTiles:!0,maxTileCacheSize:null,localIdeographFontFamily:"sans-serif",transformRequest:null,accessToken:null,fadeDuration:300,crossSourceCollisions:!0},Ec=function(n){function s(c){var v=this;if((c=a.extend({},Xi,c)).minZoom!=null&&c.maxZoom!=null&&c.minZoom>c.maxZoom)throw new Error("maxZoom must be greater than or equal to minZoom");if(c.minPitch!=null&&c.maxPitch!=null&&c.minPitch>c.maxPitch)throw new Error("maxPitch must be greater than or equal to minPitch");if(c.minPitch!=null&&c.minPitch<0)throw new Error("minPitch must be greater than or equal to 0");if(c.maxPitch!=null&&c.maxPitch>60)throw new Error("maxPitch must be less than or equal to 60");var w=new mr(c.minZoom,c.maxZoom,c.minPitch,c.maxPitch,c.renderWorldCopies);if(n.call(this,w,c),this._interactive=c.interactive,this._maxTileCacheSize=c.maxTileCacheSize,this._failIfMajorPerformanceCaveat=c.failIfMajorPerformanceCaveat,this._preserveDrawingBuffer=c.preserveDrawingBuffer,this._antialias=c.antialias,this._trackResize=c.trackResize,this._bearingSnap=c.bearingSnap,this._refreshExpiredTiles=c.refreshExpiredTiles,this._fadeDuration=c.fadeDuration,this._crossSourceCollisions=c.crossSourceCollisions,this._crossFadingFactor=1,this._collectResourceTiming=c.collectResourceTiming,this._renderTaskQueue=new sn,this._controls=[],this._mapId=a.uniqueId(),this._locale=a.extend({},Ta,c.locale),this._clickTolerance=c.clickTolerance,this._requestManager=new a.RequestManager(c.transformRequest,c.accessToken),typeof c.container=="string"){if(this._container=a.window.document.getElementById(c.container),!this._container)throw new Error("Container '"+c.container+"' not found.")}else{if(!(c.container instanceof Qs))throw new Error("Invalid type: 'container' must be a String or HTMLElement.");this._container=c.container}if(c.maxBounds&&this.setMaxBounds(c.maxBounds),a.bindAll(["_onWindowOnline","_onWindowResize","_onMapScroll","_contextLost","_contextRestored"],this),this._setupContainer(),this._setupPainter(),this.painter===void 0)throw new Error("Failed to initialize WebGL.");this.on("move",function(){return v._update(!1)}),this.on("moveend",function(){return v._update(!1)}),this.on("zoom",function(){return v._update(!0)}),a.window!==void 0&&(a.window.addEventListener("online",this._onWindowOnline,!1),a.window.addEventListener("resize",this._onWindowResize,!1),a.window.addEventListener("orientationchange",this._onWindowResize,!1)),this.handlers=new gt(this,c),this._hash=c.hash&&new Jn(typeof c.hash=="string"&&c.hash||void 0).addTo(this),this._hash&&this._hash._onHashChange()||(this.jumpTo({center:c.center,zoom:c.zoom,bearing:c.bearing,pitch:c.pitch}),c.bounds&&(this.resize(),this.fitBounds(c.bounds,a.extend({},c.fitBoundsOptions,{duration:0})))),this.resize(),this._localIdeographFontFamily=c.localIdeographFontFamily,c.style&&this.setStyle(c.style,{localIdeographFontFamily:c.localIdeographFontFamily}),c.attributionControl&&this.addControl(new bn({customAttribution:c.customAttribution})),this.addControl(new ga,c.logoPosition),this.on("style.load",function(){v.transform.unmodified&&v.jumpTo(v.style.stylesheet)}),this.on("data",function(S){v._update(S.dataType==="style"),v.fire(new a.Event(S.dataType+"data",S))}),this.on("dataloading",function(S){v.fire(new a.Event(S.dataType+"dataloading",S))})}n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s;var o={showTileBoundaries:{configurable:!0},showPadding:{configurable:!0},showCollisionBoxes:{configurable:!0},showOverdrawInspector:{configurable:!0},repaint:{configurable:!0},vertices:{configurable:!0},version:{configurable:!0}};return s.prototype._getMapId=function(){return this._mapId},s.prototype.addControl=function(c,v){if(v===void 0&&(v=c.getDefaultPosition?c.getDefaultPosition():"top-right"),!c||!c.onAdd)return this.fire(new a.ErrorEvent(new Error("Invalid argument to map.addControl(). Argument must be a control with onAdd and onRemove methods.")));var w=c.onAdd(this);this._controls.push(c);var S=this._controlPositions[v];return v.indexOf("bottom")!==-1?S.insertBefore(w,S.firstChild):S.appendChild(w),this},s.prototype.removeControl=function(c){if(!c||!c.onRemove)return this.fire(new a.ErrorEvent(new Error("Invalid argument to map.removeControl(). Argument must be a control with onAdd and onRemove methods.")));var v=this._controls.indexOf(c);return v>-1&&this._controls.splice(v,1),c.onRemove(this),this},s.prototype.hasControl=function(c){return this._controls.indexOf(c)>-1},s.prototype.resize=function(c){var v=this._containerDimensions(),w=v[0],S=v[1];if(w===this.transform.width&&S===this.transform.height)return this;this._resizeCanvas(w,S),this.transform.resize(w,S),this.painter.resize(w,S);var E=!this._moving;return E&&this.fire(new a.Event("movestart",c)).fire(new a.Event("move",c)),this.fire(new a.Event("resize",c)),E&&this.fire(new a.Event("moveend",c)),this},s.prototype.getBounds=function(){return this.transform.getBounds()},s.prototype.getMaxBounds=function(){return this.transform.getMaxBounds()},s.prototype.setMaxBounds=function(c){return this.transform.setMaxBounds(a.LngLatBounds.convert(c)),this._update()},s.prototype.setMinZoom=function(c){if((c=c??-2)>=-2&&c<=this.transform.maxZoom)return this.transform.minZoom=c,this._update(),this.getZoom()<c&&this.setZoom(c),this;throw new Error("minZoom must be between -2 and the current maxZoom, inclusive")},s.prototype.getMinZoom=function(){return this.transform.minZoom},s.prototype.setMaxZoom=function(c){if((c=c??22)>=this.transform.minZoom)return this.transform.maxZoom=c,this._update(),this.getZoom()>c&&this.setZoom(c),this;throw new Error("maxZoom must be greater than the current minZoom")},s.prototype.getMaxZoom=function(){return this.transform.maxZoom},s.prototype.setMinPitch=function(c){if((c=c??0)<0)throw new Error("minPitch must be greater than or equal to 0");if(c>=0&&c<=this.transform.maxPitch)return this.transform.minPitch=c,this._update(),this.getPitch()<c&&this.setPitch(c),this;throw new Error("minPitch must be between 0 and the current maxPitch, inclusive")},s.prototype.getMinPitch=function(){return this.transform.minPitch},s.prototype.setMaxPitch=function(c){if((c=c??60)>60)throw new Error("maxPitch must be less than or equal to 60");if(c>=this.transform.minPitch)return this.transform.maxPitch=c,this._update(),this.getPitch()>c&&this.setPitch(c),this;throw new Error("maxPitch must be greater than the current minPitch")},s.prototype.getMaxPitch=function(){return this.transform.maxPitch},s.prototype.getRenderWorldCopies=function(){return this.transform.renderWorldCopies},s.prototype.setRenderWorldCopies=function(c){return this.transform.renderWorldCopies=c,this._update()},s.prototype.project=function(c){return this.transform.locationPoint(a.LngLat.convert(c))},s.prototype.unproject=function(c){return this.transform.pointLocation(a.Point.convert(c))},s.prototype.isMoving=function(){return this._moving||this.handlers.isMoving()},s.prototype.isZooming=function(){return this._zooming||this.handlers.isZooming()},s.prototype.isRotating=function(){return this._rotating||this.handlers.isRotating()},s.prototype._createDelegatedListener=function(c,v,w){var S,E=this;if(c==="mouseenter"||c==="mouseover"){var P=!1;return{layer:v,listener:w,delegates:{mousemove:function(G){var Z=E.getLayer(v)?E.queryRenderedFeatures(G.point,{layers:[v]}):[];Z.length?P||(P=!0,w.call(E,new Ci(c,E,G.originalEvent,{features:Z}))):P=!1},mouseout:function(){P=!1}}}}if(c==="mouseleave"||c==="mouseout"){var O=!1;return{layer:v,listener:w,delegates:{mousemove:function(G){(E.getLayer(v)?E.queryRenderedFeatures(G.point,{layers:[v]}):[]).length?O=!0:O&&(O=!1,w.call(E,new Ci(c,E,G.originalEvent)))},mouseout:function(G){O&&(O=!1,w.call(E,new Ci(c,E,G.originalEvent)))}}}}return{layer:v,listener:w,delegates:(S={},S[c]=function(G){var Z=E.getLayer(v)?E.queryRenderedFeatures(G.point,{layers:[v]}):[];Z.length&&(G.features=Z,w.call(E,G),delete G.features)},S)}},s.prototype.on=function(c,v,w){if(w===void 0)return n.prototype.on.call(this,c,v);var S=this._createDelegatedListener(c,v,w);for(var E in this._delegatedListeners=this._delegatedListeners||{},this._delegatedListeners[c]=this._delegatedListeners[c]||[],this._delegatedListeners[c].push(S),S.delegates)this.on(E,S.delegates[E]);return this},s.prototype.once=function(c,v,w){if(w===void 0)return n.prototype.once.call(this,c,v);var S=this._createDelegatedListener(c,v,w);for(var E in S.delegates)this.once(E,S.delegates[E]);return this},s.prototype.off=function(c,v,w){var S=this;return w===void 0?n.prototype.off.call(this,c,v):(this._delegatedListeners&&this._delegatedListeners[c]&&function(E){for(var P=E[c],O=0;O<P.length;O++){var G=P[O];if(G.layer===v&&G.listener===w){for(var Z in G.delegates)S.off(Z,G.delegates[Z]);return P.splice(O,1),S}}}(this._delegatedListeners),this)},s.prototype.queryRenderedFeatures=function(c,v){if(!this.style)return[];var w;if(v!==void 0||c===void 0||c instanceof a.Point||Array.isArray(c)||(v=c,c=void 0),v=v||{},(c=c||[[0,0],[this.transform.width,this.transform.height]])instanceof a.Point||typeof c[0]=="number")w=[a.Point.convert(c)];else{var S=a.Point.convert(c[0]),E=a.Point.convert(c[1]);w=[S,new a.Point(E.x,S.y),E,new a.Point(S.x,E.y),S]}return this.style.queryRenderedFeatures(w,v,this.transform)},s.prototype.querySourceFeatures=function(c,v){return this.style.querySourceFeatures(c,v)},s.prototype.setStyle=function(c,v){return(v=a.extend({},{localIdeographFontFamily:this._localIdeographFontFamily},v)).diff!==!1&&v.localIdeographFontFamily===this._localIdeographFontFamily&&this.style&&c?(this._diffStyle(c,v),this):(this._localIdeographFontFamily=v.localIdeographFontFamily,this._updateStyle(c,v))},s.prototype._getUIString=function(c){var v=this._locale[c];if(v==null)throw new Error("Missing UI string '"+c+"'");return v},s.prototype._updateStyle=function(c,v){return this.style&&(this.style.setEventedParent(null),this.style._remove()),c?(this.style=new On(this,v||{}),this.style.setEventedParent(this,{style:this.style}),typeof c=="string"?this.style.loadURL(c):this.style.loadJSON(c),this):(delete this.style,this)},s.prototype._lazyInitEmptyStyle=function(){this.style||(this.style=new On(this,{}),this.style.setEventedParent(this,{style:this.style}),this.style.loadEmpty())},s.prototype._diffStyle=function(c,v){var w=this;if(typeof c=="string"){var S=this._requestManager.normalizeStyleURL(c),E=this._requestManager.transformRequest(S,a.ResourceType.Style);a.getJSON(E,function(P,O){P?w.fire(new a.ErrorEvent(P)):O&&w._updateDiff(O,v)})}else typeof c=="object"&&this._updateDiff(c,v)},s.prototype._updateDiff=function(c,v){try{this.style.setState(c)&&this._update(!0)}catch(w){a.warnOnce("Unable to perform style diff: "+(w.message||w.error||w)+".  Rebuilding the style from scratch."),this._updateStyle(c,v)}},s.prototype.getStyle=function(){if(this.style)return this.style.serialize()},s.prototype.isStyleLoaded=function(){return this.style?this.style.loaded():a.warnOnce("There is no style added to the map.")},s.prototype.addSource=function(c,v){return this._lazyInitEmptyStyle(),this.style.addSource(c,v),this._update(!0)},s.prototype.isSourceLoaded=function(c){var v=this.style&&this.style.sourceCaches[c];if(v!==void 0)return v.loaded();this.fire(new a.ErrorEvent(new Error("There is no source with ID '"+c+"'")))},s.prototype.areTilesLoaded=function(){var c=this.style&&this.style.sourceCaches;for(var v in c){var w=c[v]._tiles;for(var S in w){var E=w[S];if(E.state!=="loaded"&&E.state!=="errored")return!1}}return!0},s.prototype.addSourceType=function(c,v,w){return this._lazyInitEmptyStyle(),this.style.addSourceType(c,v,w)},s.prototype.removeSource=function(c){return this.style.removeSource(c),this._update(!0)},s.prototype.getSource=function(c){return this.style.getSource(c)},s.prototype.addImage=function(c,v,w){w===void 0&&(w={});var S=w.pixelRatio;S===void 0&&(S=1);var E=w.sdf;E===void 0&&(E=!1);var P=w.stretchX,O=w.stretchY,G=w.content;if(this._lazyInitEmptyStyle(),v instanceof tu||Ar&&v instanceof Ar){var Z=a.browser.getImageData(v);this.style.addImage(c,{data:new a.RGBAImage({width:Z.width,height:Z.height},Z.data),pixelRatio:S,stretchX:P,stretchY:O,content:G,sdf:E,version:0})}else{if(v.width===void 0||v.height===void 0)return this.fire(new a.ErrorEvent(new Error("Invalid arguments to map.addImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));var H=v;this.style.addImage(c,{data:new a.RGBAImage({width:v.width,height:v.height},new Uint8Array(v.data)),pixelRatio:S,stretchX:P,stretchY:O,content:G,sdf:E,version:0,userImage:H}),H.onAdd&&H.onAdd(this,c)}},s.prototype.updateImage=function(c,v){var w=this.style.getImage(c);if(!w)return this.fire(new a.ErrorEvent(new Error("The map has no image with that id. If you are adding a new image use `map.addImage(...)` instead.")));var S=v instanceof tu||Ar&&v instanceof Ar?a.browser.getImageData(v):v,E=S.width,P=S.height,O=S.data;return E===void 0||P===void 0?this.fire(new a.ErrorEvent(new Error("Invalid arguments to map.updateImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`"))):E!==w.data.width||P!==w.data.height?this.fire(new a.ErrorEvent(new Error("The width and height of the updated image must be that same as the previous version of the image"))):(w.data.replace(O,!(v instanceof tu||Ar&&v instanceof Ar)),void this.style.updateImage(c,w))},s.prototype.hasImage=function(c){return c?!!this.style.getImage(c):(this.fire(new a.ErrorEvent(new Error("Missing required image id"))),!1)},s.prototype.removeImage=function(c){this.style.removeImage(c)},s.prototype.loadImage=function(c,v){a.getImage(this._requestManager.transformRequest(c,a.ResourceType.Image),v)},s.prototype.listImages=function(){return this.style.listImages()},s.prototype.addLayer=function(c,v){return this._lazyInitEmptyStyle(),this.style.addLayer(c,v),this._update(!0)},s.prototype.moveLayer=function(c,v){return this.style.moveLayer(c,v),this._update(!0)},s.prototype.removeLayer=function(c){return this.style.removeLayer(c),this._update(!0)},s.prototype.getLayer=function(c){return this.style.getLayer(c)},s.prototype.setLayerZoomRange=function(c,v,w){return this.style.setLayerZoomRange(c,v,w),this._update(!0)},s.prototype.setFilter=function(c,v,w){return w===void 0&&(w={}),this.style.setFilter(c,v,w),this._update(!0)},s.prototype.getFilter=function(c){return this.style.getFilter(c)},s.prototype.setPaintProperty=function(c,v,w,S){return S===void 0&&(S={}),this.style.setPaintProperty(c,v,w,S),this._update(!0)},s.prototype.getPaintProperty=function(c,v){return this.style.getPaintProperty(c,v)},s.prototype.setLayoutProperty=function(c,v,w,S){return S===void 0&&(S={}),this.style.setLayoutProperty(c,v,w,S),this._update(!0)},s.prototype.getLayoutProperty=function(c,v){return this.style.getLayoutProperty(c,v)},s.prototype.setLight=function(c,v){return v===void 0&&(v={}),this._lazyInitEmptyStyle(),this.style.setLight(c,v),this._update(!0)},s.prototype.getLight=function(){return this.style.getLight()},s.prototype.setFeatureState=function(c,v){return this.style.setFeatureState(c,v),this._update()},s.prototype.removeFeatureState=function(c,v){return this.style.removeFeatureState(c,v),this._update()},s.prototype.getFeatureState=function(c){return this.style.getFeatureState(c)},s.prototype.getContainer=function(){return this._container},s.prototype.getCanvasContainer=function(){return this._canvasContainer},s.prototype.getCanvas=function(){return this._canvas},s.prototype._containerDimensions=function(){var c=0,v=0;return this._container&&(c=this._container.clientWidth||400,v=this._container.clientHeight||300),[c,v]},s.prototype._detectMissingCSS=function(){a.window.getComputedStyle(this._missingCSSCanary).getPropertyValue("background-color")!=="rgb(250, 128, 114)"&&a.warnOnce("This page appears to be missing CSS declarations for Mapbox GL JS, which may cause the map to display incorrectly. Please ensure your page includes mapbox-gl.css, as described in https://www.mapbox.com/mapbox-gl-js/api/.")},s.prototype._setupContainer=function(){var c=this._container;c.classList.add("mapboxgl-map"),(this._missingCSSCanary=T.create("div","mapboxgl-canary",c)).style.visibility="hidden",this._detectMissingCSS();var v=this._canvasContainer=T.create("div","mapboxgl-canvas-container",c);this._interactive&&v.classList.add("mapboxgl-interactive"),this._canvas=T.create("canvas","mapboxgl-canvas",v),this._canvas.addEventListener("webglcontextlost",this._contextLost,!1),this._canvas.addEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.setAttribute("tabindex","0"),this._canvas.setAttribute("aria-label","Map"),this._canvas.setAttribute("role","region");var w=this._containerDimensions();this._resizeCanvas(w[0],w[1]);var S=this._controlContainer=T.create("div","mapboxgl-control-container",c),E=this._controlPositions={};["top-left","top-right","bottom-left","bottom-right"].forEach(function(P){E[P]=T.create("div","mapboxgl-ctrl-"+P,S)}),this._container.addEventListener("scroll",this._onMapScroll,!1)},s.prototype._resizeCanvas=function(c,v){var w=a.browser.devicePixelRatio||1;this._canvas.width=w*c,this._canvas.height=w*v,this._canvas.style.width=c+"px",this._canvas.style.height=v+"px"},s.prototype._setupPainter=function(){var c=a.extend({},I.webGLContextAttributes,{failIfMajorPerformanceCaveat:this._failIfMajorPerformanceCaveat,preserveDrawingBuffer:this._preserveDrawingBuffer,antialias:this._antialias||!1}),v=this._canvas.getContext("webgl",c)||this._canvas.getContext("experimental-webgl",c);v?(this.painter=new Wr(v,this.transform),a.webpSupported.testSupport(v)):this.fire(new a.ErrorEvent(new Error("Failed to initialize WebGL")))},s.prototype._contextLost=function(c){c.preventDefault(),this._frame&&(this._frame.cancel(),this._frame=null),this.fire(new a.Event("webglcontextlost",{originalEvent:c}))},s.prototype._contextRestored=function(c){this._setupPainter(),this.resize(),this._update(),this.fire(new a.Event("webglcontextrestored",{originalEvent:c}))},s.prototype._onMapScroll=function(c){if(c.target===this._container)return this._container.scrollTop=0,this._container.scrollLeft=0,!1},s.prototype.loaded=function(){return!this._styleDirty&&!this._sourcesDirty&&!!this.style&&this.style.loaded()},s.prototype._update=function(c){return this.style?(this._styleDirty=this._styleDirty||c,this._sourcesDirty=!0,this.triggerRepaint(),this):this},s.prototype._requestRenderFrame=function(c){return this._update(),this._renderTaskQueue.add(c)},s.prototype._cancelRenderFrame=function(c){this._renderTaskQueue.remove(c)},s.prototype._render=function(c){var v,w=this,S=0,E=this.painter.context.extTimerQuery;if(this.listens("gpu-timing-frame")&&(v=E.createQueryEXT(),E.beginQueryEXT(E.TIME_ELAPSED_EXT,v),S=a.browser.now()),this.painter.context.setDirty(),this.painter.setBaseState(),this._renderTaskQueue.run(c),!this._removed){var P=!1;if(this.style&&this._styleDirty){this._styleDirty=!1;var O=this.transform.zoom,G=a.browser.now();this.style.zoomHistory.update(O,G);var Z=new a.EvaluationParameters(O,{now:G,fadeDuration:this._fadeDuration,zoomHistory:this.style.zoomHistory,transition:this.style.getTransition()}),H=Z.crossFadingFactor();H===1&&H===this._crossFadingFactor||(P=!0,this._crossFadingFactor=H),this.style.update(Z)}if(this.style&&this._sourcesDirty&&(this._sourcesDirty=!1,this.style._updateSources(this.transform)),this._placementDirty=this.style&&this.style._updatePlacement(this.painter.transform,this.showCollisionBoxes,this._fadeDuration,this._crossSourceCollisions),this.painter.render(this.style,{showTileBoundaries:this.showTileBoundaries,showOverdrawInspector:this._showOverdrawInspector,rotating:this.isRotating(),zooming:this.isZooming(),moving:this.isMoving(),fadeDuration:this._fadeDuration,showPadding:this.showPadding,gpuTiming:!!this.listens("gpu-timing-layer")}),this.fire(new a.Event("render")),this.loaded()&&!this._loaded&&(this._loaded=!0,this.fire(new a.Event("load"))),this.style&&(this.style.hasTransitions()||P)&&(this._styleDirty=!0),this.style&&!this._placementDirty&&this.style._releaseSymbolFadeTiles(),this.listens("gpu-timing-frame")){var te=a.browser.now()-S;E.endQueryEXT(E.TIME_ELAPSED_EXT,v),setTimeout(function(){var Y=E.getQueryObjectEXT(v,E.QUERY_RESULT_EXT)/1e6;E.deleteQueryEXT(v),w.fire(new a.Event("gpu-timing-frame",{cpuTime:te,gpuTime:Y}))},50)}if(this.listens("gpu-timing-layer")){var ee=this.painter.collectGpuTimers();setTimeout(function(){var Y=w.painter.queryGpuTimers(ee);w.fire(new a.Event("gpu-timing-layer",{layerTimes:Y}))},50)}var ce=this._sourcesDirty||this._styleDirty||this._placementDirty;return ce||this._repaint?this.triggerRepaint():!this.isMoving()&&this.loaded()&&this.fire(new a.Event("idle")),!this._loaded||this._fullyLoaded||ce||(this._fullyLoaded=!0),this}},s.prototype.remove=function(){this._hash&&this._hash.remove();for(var c=0,v=this._controls;c<v.length;c+=1)v[c].onRemove(this);this._controls=[],this._frame&&(this._frame.cancel(),this._frame=null),this._renderTaskQueue.clear(),this.painter.destroy(),this.handlers.destroy(),delete this.handlers,this.setStyle(null),a.window!==void 0&&(a.window.removeEventListener("resize",this._onWindowResize,!1),a.window.removeEventListener("orientationchange",this._onWindowResize,!1),a.window.removeEventListener("online",this._onWindowOnline,!1));var w=this.painter.context.gl.getExtension("WEBGL_lose_context");w&&w.loseContext(),Eo(this._canvasContainer),Eo(this._controlContainer),Eo(this._missingCSSCanary),this._container.classList.remove("mapboxgl-map"),this._removed=!0,this.fire(new a.Event("remove"))},s.prototype.triggerRepaint=function(){var c=this;this.style&&!this._frame&&(this._frame=a.browser.frame(function(v){c._frame=null,c._render(v)}))},s.prototype._onWindowOnline=function(){this._update()},s.prototype._onWindowResize=function(c){this._trackResize&&this.resize({originalEvent:c})._update()},o.showTileBoundaries.get=function(){return!!this._showTileBoundaries},o.showTileBoundaries.set=function(c){this._showTileBoundaries!==c&&(this._showTileBoundaries=c,this._update())},o.showPadding.get=function(){return!!this._showPadding},o.showPadding.set=function(c){this._showPadding!==c&&(this._showPadding=c,this._update())},o.showCollisionBoxes.get=function(){return!!this._showCollisionBoxes},o.showCollisionBoxes.set=function(c){this._showCollisionBoxes!==c&&(this._showCollisionBoxes=c,c?this.style._generateCollisionBoxes():this._update())},o.showOverdrawInspector.get=function(){return!!this._showOverdrawInspector},o.showOverdrawInspector.set=function(c){this._showOverdrawInspector!==c&&(this._showOverdrawInspector=c,this._update())},o.repaint.get=function(){return!!this._repaint},o.repaint.set=function(c){this._repaint!==c&&(this._repaint=c,this.triggerRepaint())},o.vertices.get=function(){return!!this._vertices},o.vertices.set=function(c){this._vertices=c,this._update()},s.prototype._setCacheLimits=function(c,v){a.setCacheLimits(c,v)},o.version.get=function(){return a.version},Object.defineProperties(s.prototype,o),s}(Js);function Eo(n){n.parentNode&&n.parentNode.removeChild(n)}var ru={showCompass:!0,showZoom:!0,visualizePitch:!1},Da=function(n){var s=this;this.options=a.extend({},ru,n),this._container=T.create("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._container.addEventListener("contextmenu",function(o){return o.preventDefault()}),this.options.showZoom&&(a.bindAll(["_setButtonTitle","_updateZoomButtons"],this),this._zoomInButton=this._createButton("mapboxgl-ctrl-zoom-in",function(o){return s._map.zoomIn({},{originalEvent:o})}),T.create("span","mapboxgl-ctrl-icon",this._zoomInButton).setAttribute("aria-hidden",!0),this._zoomOutButton=this._createButton("mapboxgl-ctrl-zoom-out",function(o){return s._map.zoomOut({},{originalEvent:o})}),T.create("span","mapboxgl-ctrl-icon",this._zoomOutButton).setAttribute("aria-hidden",!0)),this.options.showCompass&&(a.bindAll(["_rotateCompassArrow"],this),this._compass=this._createButton("mapboxgl-ctrl-compass",function(o){s.options.visualizePitch?s._map.resetNorthPitch({},{originalEvent:o}):s._map.resetNorth({},{originalEvent:o})}),this._compassIcon=T.create("span","mapboxgl-ctrl-icon",this._compass),this._compassIcon.setAttribute("aria-hidden",!0))};Da.prototype._updateZoomButtons=function(){var n=this._map.getZoom(),s=n===this._map.getMaxZoom(),o=n===this._map.getMinZoom();this._zoomInButton.disabled=s,this._zoomOutButton.disabled=o,this._zoomInButton.setAttribute("aria-disabled",s.toString()),this._zoomOutButton.setAttribute("aria-disabled",o.toString())},Da.prototype._rotateCompassArrow=function(){var n=this.options.visualizePitch?"scale("+1/Math.pow(Math.cos(this._map.transform.pitch*(Math.PI/180)),.5)+") rotateX("+this._map.transform.pitch+"deg) rotateZ("+this._map.transform.angle*(180/Math.PI)+"deg)":"rotate("+this._map.transform.angle*(180/Math.PI)+"deg)";this._compassIcon.style.transform=n},Da.prototype.onAdd=function(n){return this._map=n,this.options.showZoom&&(this._setButtonTitle(this._zoomInButton,"ZoomIn"),this._setButtonTitle(this._zoomOutButton,"ZoomOut"),this._map.on("zoom",this._updateZoomButtons),this._updateZoomButtons()),this.options.showCompass&&(this._setButtonTitle(this._compass,"ResetBearing"),this.options.visualizePitch&&this._map.on("pitch",this._rotateCompassArrow),this._map.on("rotate",this._rotateCompassArrow),this._rotateCompassArrow(),this._handler=new qn(this._map,this._compass,this.options.visualizePitch)),this._container},Da.prototype.onRemove=function(){T.remove(this._container),this.options.showZoom&&this._map.off("zoom",this._updateZoomButtons),this.options.showCompass&&(this.options.visualizePitch&&this._map.off("pitch",this._rotateCompassArrow),this._map.off("rotate",this._rotateCompassArrow),this._handler.off(),delete this._handler),delete this._map},Da.prototype._createButton=function(n,s){var o=T.create("button",n,this._container);return o.type="button",o.addEventListener("click",s),o},Da.prototype._setButtonTitle=function(n,s){var o=this._map._getUIString("NavigationControl."+s);n.title=o,n.setAttribute("aria-label",o)};var qn=function(n,s,o){o===void 0&&(o=!1),this._clickTolerance=10,this.element=s,this.mouseRotate=new Xs({clickTolerance:n.dragRotate._mouseRotate._clickTolerance}),this.map=n,o&&(this.mousePitch=new Ql({clickTolerance:n.dragRotate._mousePitch._clickTolerance})),a.bindAll(["mousedown","mousemove","mouseup","touchstart","touchmove","touchend","reset"],this),T.addEventListener(s,"mousedown",this.mousedown),T.addEventListener(s,"touchstart",this.touchstart,{passive:!1}),T.addEventListener(s,"touchmove",this.touchmove),T.addEventListener(s,"touchend",this.touchend),T.addEventListener(s,"touchcancel",this.reset)};function Go(n,s,o){if(n=new a.LngLat(n.lng,n.lat),s){var c=new a.LngLat(n.lng-360,n.lat),v=new a.LngLat(n.lng+360,n.lat),w=o.locationPoint(n).distSqr(s);o.locationPoint(c).distSqr(s)<w?n=c:o.locationPoint(v).distSqr(s)<w&&(n=v)}for(;Math.abs(n.lng-o.center.lng)>180;){var S=o.locationPoint(n);if(S.x>=0&&S.y>=0&&S.x<=o.width&&S.y<=o.height)break;n.lng>o.center.lng?n.lng-=360:n.lng+=360}return n}qn.prototype.down=function(n,s){this.mouseRotate.mousedown(n,s),this.mousePitch&&this.mousePitch.mousedown(n,s),T.disableDrag()},qn.prototype.move=function(n,s){var o=this.map,c=this.mouseRotate.mousemoveWindow(n,s);if(c&&c.bearingDelta&&o.setBearing(o.getBearing()+c.bearingDelta),this.mousePitch){var v=this.mousePitch.mousemoveWindow(n,s);v&&v.pitchDelta&&o.setPitch(o.getPitch()+v.pitchDelta)}},qn.prototype.off=function(){var n=this.element;T.removeEventListener(n,"mousedown",this.mousedown),T.removeEventListener(n,"touchstart",this.touchstart,{passive:!1}),T.removeEventListener(n,"touchmove",this.touchmove),T.removeEventListener(n,"touchend",this.touchend),T.removeEventListener(n,"touchcancel",this.reset),this.offTemp()},qn.prototype.offTemp=function(){T.enableDrag(),T.removeEventListener(a.window,"mousemove",this.mousemove),T.removeEventListener(a.window,"mouseup",this.mouseup)},qn.prototype.mousedown=function(n){this.down(a.extend({},n,{ctrlKey:!0,preventDefault:function(){return n.preventDefault()}}),T.mousePos(this.element,n)),T.addEventListener(a.window,"mousemove",this.mousemove),T.addEventListener(a.window,"mouseup",this.mouseup)},qn.prototype.mousemove=function(n){this.move(n,T.mousePos(this.element,n))},qn.prototype.mouseup=function(n){this.mouseRotate.mouseupWindow(n),this.mousePitch&&this.mousePitch.mouseupWindow(n),this.offTemp()},qn.prototype.touchstart=function(n){n.targetTouches.length!==1?this.reset():(this._startPos=this._lastPos=T.touchPos(this.element,n.targetTouches)[0],this.down({type:"mousedown",button:0,ctrlKey:!0,preventDefault:function(){return n.preventDefault()}},this._startPos))},qn.prototype.touchmove=function(n){n.targetTouches.length!==1?this.reset():(this._lastPos=T.touchPos(this.element,n.targetTouches)[0],this.move({preventDefault:function(){return n.preventDefault()}},this._lastPos))},qn.prototype.touchend=function(n){n.targetTouches.length===0&&this._startPos&&this._lastPos&&this._startPos.dist(this._lastPos)<this._clickTolerance&&this.element.click(),this.reset()},qn.prototype.reset=function(){this.mouseRotate.reset(),this.mousePitch&&this.mousePitch.reset(),delete this._startPos,delete this._lastPos,this.offTemp()};var Ia={center:"translate(-50%,-50%)",top:"translate(-50%,0)","top-left":"translate(0,0)","top-right":"translate(-100%,0)",bottom:"translate(-50%,-100%)","bottom-left":"translate(0,-100%)","bottom-right":"translate(-100%,-100%)",left:"translate(0,-50%)",right:"translate(-100%,-50%)"};function $s(n,s,o){var c=n.classList;for(var v in Ia)c.remove("mapboxgl-"+o+"-anchor-"+v);c.add("mapboxgl-"+o+"-anchor-"+s)}var Zo,bs=function(n){function s(o,c){if(n.call(this),(o instanceof a.window.HTMLElement||c)&&(o=a.extend({element:o},c)),a.bindAll(["_update","_onMove","_onUp","_addDragHandler","_onMapClick","_onKeyPress"],this),this._anchor=o&&o.anchor||"center",this._color=o&&o.color||"#3FB1CE",this._scale=o&&o.scale||1,this._draggable=o&&o.draggable||!1,this._clickTolerance=o&&o.clickTolerance||0,this._isDragging=!1,this._state="inactive",this._rotation=o&&o.rotation||0,this._rotationAlignment=o&&o.rotationAlignment||"auto",this._pitchAlignment=o&&o.pitchAlignment&&o.pitchAlignment!=="auto"?o.pitchAlignment:this._rotationAlignment,o&&o.element)this._element=o.element,this._offset=a.Point.convert(o&&o.offset||[0,0]);else{this._defaultMarker=!0,this._element=T.create("div"),this._element.setAttribute("aria-label","Map marker");var v=T.createNS("http://www.w3.org/2000/svg","svg");v.setAttributeNS(null,"display","block"),v.setAttributeNS(null,"height","41px"),v.setAttributeNS(null,"width","27px"),v.setAttributeNS(null,"viewBox","0 0 27 41");var w=T.createNS("http://www.w3.org/2000/svg","g");w.setAttributeNS(null,"stroke","none"),w.setAttributeNS(null,"stroke-width","1"),w.setAttributeNS(null,"fill","none"),w.setAttributeNS(null,"fill-rule","evenodd");var S=T.createNS("http://www.w3.org/2000/svg","g");S.setAttributeNS(null,"fill-rule","nonzero");var E=T.createNS("http://www.w3.org/2000/svg","g");E.setAttributeNS(null,"transform","translate(3.0, 29.0)"),E.setAttributeNS(null,"fill","#000000");for(var P=0,O=[{rx:"10.5",ry:"5.25002273"},{rx:"10.5",ry:"5.25002273"},{rx:"9.5",ry:"4.77275007"},{rx:"8.5",ry:"4.29549936"},{rx:"7.5",ry:"3.81822308"},{rx:"6.5",ry:"3.34094679"},{rx:"5.5",ry:"2.86367051"},{rx:"4.5",ry:"2.38636864"}];P<O.length;P+=1){var G=O[P],Z=T.createNS("http://www.w3.org/2000/svg","ellipse");Z.setAttributeNS(null,"opacity","0.04"),Z.setAttributeNS(null,"cx","10.5"),Z.setAttributeNS(null,"cy","5.80029008"),Z.setAttributeNS(null,"rx",G.rx),Z.setAttributeNS(null,"ry",G.ry),E.appendChild(Z)}var H=T.createNS("http://www.w3.org/2000/svg","g");H.setAttributeNS(null,"fill",this._color);var te=T.createNS("http://www.w3.org/2000/svg","path");te.setAttributeNS(null,"d","M27,13.5 C27,19.074644 20.250001,27.000002 14.75,34.500002 C14.016665,35.500004 12.983335,35.500004 12.25,34.500002 C6.7499993,27.000002 0,19.222562 0,13.5 C0,6.0441559 6.0441559,0 13.5,0 C20.955844,0 27,6.0441559 27,13.5 Z"),H.appendChild(te);var ee=T.createNS("http://www.w3.org/2000/svg","g");ee.setAttributeNS(null,"opacity","0.25"),ee.setAttributeNS(null,"fill","#000000");var ce=T.createNS("http://www.w3.org/2000/svg","path");ce.setAttributeNS(null,"d","M13.5,0 C6.0441559,0 0,6.0441559 0,13.5 C0,19.222562 6.7499993,27 12.25,34.5 C13,35.522727 14.016664,35.500004 14.75,34.5 C20.250001,27 27,19.074644 27,13.5 C27,6.0441559 20.955844,0 13.5,0 Z M13.5,1 C20.415404,1 26,6.584596 26,13.5 C26,15.898657 24.495584,19.181431 22.220703,22.738281 C19.945823,26.295132 16.705119,30.142167 13.943359,33.908203 C13.743445,34.180814 13.612715,34.322738 13.5,34.441406 C13.387285,34.322738 13.256555,34.180814 13.056641,33.908203 C10.284481,30.127985 7.4148684,26.314159 5.015625,22.773438 C2.6163816,19.232715 1,15.953538 1,13.5 C1,6.584596 6.584596,1 13.5,1 Z"),ee.appendChild(ce);var Y=T.createNS("http://www.w3.org/2000/svg","g");Y.setAttributeNS(null,"transform","translate(6.0, 7.0)"),Y.setAttributeNS(null,"fill","#FFFFFF");var le=T.createNS("http://www.w3.org/2000/svg","g");le.setAttributeNS(null,"transform","translate(8.0, 8.0)");var de=T.createNS("http://www.w3.org/2000/svg","circle");de.setAttributeNS(null,"fill","#000000"),de.setAttributeNS(null,"opacity","0.25"),de.setAttributeNS(null,"cx","5.5"),de.setAttributeNS(null,"cy","5.5"),de.setAttributeNS(null,"r","5.4999962");var _e=T.createNS("http://www.w3.org/2000/svg","circle");_e.setAttributeNS(null,"fill","#FFFFFF"),_e.setAttributeNS(null,"cx","5.5"),_e.setAttributeNS(null,"cy","5.5"),_e.setAttributeNS(null,"r","5.4999962"),le.appendChild(de),le.appendChild(_e),S.appendChild(E),S.appendChild(H),S.appendChild(ee),S.appendChild(Y),S.appendChild(le),v.appendChild(S),v.setAttributeNS(null,"height",41*this._scale+"px"),v.setAttributeNS(null,"width",27*this._scale+"px"),this._element.appendChild(v),this._offset=a.Point.convert(o&&o.offset||[0,-14])}this._element.classList.add("mapboxgl-marker"),this._element.addEventListener("dragstart",function(Ie){Ie.preventDefault()}),this._element.addEventListener("mousedown",function(Ie){Ie.preventDefault()}),$s(this._element,this._anchor,"marker"),this._popup=null}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype.addTo=function(o){return this.remove(),this._map=o,o.getCanvasContainer().appendChild(this._element),o.on("move",this._update),o.on("moveend",this._update),this.setDraggable(this._draggable),this._update(),this._map.on("click",this._onMapClick),this},s.prototype.remove=function(){return this._map&&(this._map.off("click",this._onMapClick),this._map.off("move",this._update),this._map.off("moveend",this._update),this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler),this._map.off("mouseup",this._onUp),this._map.off("touchend",this._onUp),this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),delete this._map),T.remove(this._element),this._popup&&this._popup.remove(),this},s.prototype.getLngLat=function(){return this._lngLat},s.prototype.setLngLat=function(o){return this._lngLat=a.LngLat.convert(o),this._pos=null,this._popup&&this._popup.setLngLat(this._lngLat),this._update(),this},s.prototype.getElement=function(){return this._element},s.prototype.setPopup=function(o){if(this._popup&&(this._popup.remove(),this._popup=null,this._element.removeEventListener("keypress",this._onKeyPress),this._originalTabIndex||this._element.removeAttribute("tabindex")),o){if(!("offset"in o.options)){var c=Math.sqrt(Math.pow(13.5,2)/2);o.options.offset=this._defaultMarker?{top:[0,0],"top-left":[0,0],"top-right":[0,0],bottom:[0,-38.1],"bottom-left":[c,-1*(24.6+c)],"bottom-right":[-c,-1*(24.6+c)],left:[13.5,-24.6],right:[-13.5,-24.6]}:this._offset}this._popup=o,this._lngLat&&this._popup.setLngLat(this._lngLat),this._originalTabIndex=this._element.getAttribute("tabindex"),this._originalTabIndex||this._element.setAttribute("tabindex","0"),this._element.addEventListener("keypress",this._onKeyPress)}return this},s.prototype._onKeyPress=function(o){var c=o.code,v=o.charCode||o.keyCode;c!=="Space"&&c!=="Enter"&&v!==32&&v!==13||this.togglePopup()},s.prototype._onMapClick=function(o){var c=o.originalEvent.target,v=this._element;this._popup&&(c===v||v.contains(c))&&this.togglePopup()},s.prototype.getPopup=function(){return this._popup},s.prototype.togglePopup=function(){var o=this._popup;return o?(o.isOpen()?o.remove():o.addTo(this._map),this):this},s.prototype._update=function(o){if(this._map){this._map.transform.renderWorldCopies&&(this._lngLat=Go(this._lngLat,this._pos,this._map.transform)),this._pos=this._map.project(this._lngLat)._add(this._offset);var c="";this._rotationAlignment==="viewport"||this._rotationAlignment==="auto"?c="rotateZ("+this._rotation+"deg)":this._rotationAlignment==="map"&&(c="rotateZ("+(this._rotation-this._map.getBearing())+"deg)");var v="";this._pitchAlignment==="viewport"||this._pitchAlignment==="auto"?v="rotateX(0deg)":this._pitchAlignment==="map"&&(v="rotateX("+this._map.getPitch()+"deg)"),o&&o.type!=="moveend"||(this._pos=this._pos.round()),T.setTransform(this._element,Ia[this._anchor]+" translate("+this._pos.x+"px, "+this._pos.y+"px) "+v+" "+c)}},s.prototype.getOffset=function(){return this._offset},s.prototype.setOffset=function(o){return this._offset=a.Point.convert(o),this._update(),this},s.prototype._onMove=function(o){if(!this._isDragging){var c=this._clickTolerance||this._map._clickTolerance;this._isDragging=o.point.dist(this._pointerdownPos)>=c}this._isDragging&&(this._pos=o.point.sub(this._positionDelta),this._lngLat=this._map.unproject(this._pos),this.setLngLat(this._lngLat),this._element.style.pointerEvents="none",this._state==="pending"&&(this._state="active",this.fire(new a.Event("dragstart"))),this.fire(new a.Event("drag")))},s.prototype._onUp=function(){this._element.style.pointerEvents="auto",this._positionDelta=null,this._pointerdownPos=null,this._isDragging=!1,this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),this._state==="active"&&this.fire(new a.Event("dragend")),this._state="inactive"},s.prototype._addDragHandler=function(o){this._element.contains(o.originalEvent.target)&&(o.preventDefault(),this._positionDelta=o.point.sub(this._pos).add(this._offset),this._pointerdownPos=o.point,this._state="pending",this._map.on("mousemove",this._onMove),this._map.on("touchmove",this._onMove),this._map.once("mouseup",this._onUp),this._map.once("touchend",this._onUp))},s.prototype.setDraggable=function(o){return this._draggable=!!o,this._map&&(o?(this._map.on("mousedown",this._addDragHandler),this._map.on("touchstart",this._addDragHandler)):(this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler))),this},s.prototype.isDraggable=function(){return this._draggable},s.prototype.setRotation=function(o){return this._rotation=o||0,this._update(),this},s.prototype.getRotation=function(){return this._rotation},s.prototype.setRotationAlignment=function(o){return this._rotationAlignment=o||"auto",this._update(),this},s.prototype.getRotationAlignment=function(){return this._rotationAlignment},s.prototype.setPitchAlignment=function(o){return this._pitchAlignment=o&&o!=="auto"?o:this._rotationAlignment,this._update(),this},s.prototype.getPitchAlignment=function(){return this._pitchAlignment},s}(a.Evented),iu={positionOptions:{enableHighAccuracy:!1,maximumAge:0,timeout:6e3},fitBoundsOptions:{maxZoom:15},trackUserLocation:!1,showAccuracyCircle:!0,showUserLocation:!0},Ko=0,To=!1,nu=function(n){function s(o){n.call(this),this.options=a.extend({},iu,o),a.bindAll(["_onSuccess","_onError","_onZoom","_finish","_setupUI","_updateCamera","_updateMarker"],this)}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype.onAdd=function(o){var c;return this._map=o,this._container=T.create("div","mapboxgl-ctrl mapboxgl-ctrl-group"),c=this._setupUI,Zo!==void 0?c(Zo):a.window.navigator.permissions!==void 0?a.window.navigator.permissions.query({name:"geolocation"}).then(function(v){c(Zo=v.state!=="denied")}):c(Zo=!!a.window.navigator.geolocation),this._container},s.prototype.onRemove=function(){this._geolocationWatchID!==void 0&&(a.window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0),this.options.showUserLocation&&this._userLocationDotMarker&&this._userLocationDotMarker.remove(),this.options.showAccuracyCircle&&this._accuracyCircleMarker&&this._accuracyCircleMarker.remove(),T.remove(this._container),this._map.off("zoom",this._onZoom),this._map=void 0,Ko=0,To=!1},s.prototype._isOutOfMapMaxBounds=function(o){var c=this._map.getMaxBounds(),v=o.coords;return c&&(v.longitude<c.getWest()||v.longitude>c.getEast()||v.latitude<c.getSouth()||v.latitude>c.getNorth())},s.prototype._setErrorState=function(){switch(this._watchState){case"WAITING_ACTIVE":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error");break;case"ACTIVE_LOCK":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting");break;case"BACKGROUND":this._watchState="BACKGROUND_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting")}},s.prototype._onSuccess=function(o){if(this._map){if(this._isOutOfMapMaxBounds(o))return this._setErrorState(),this.fire(new a.Event("outofmaxbounds",o)),this._updateMarker(),void this._finish();if(this.options.trackUserLocation)switch(this._lastKnownPosition=o,this._watchState){case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"BACKGROUND":case"BACKGROUND_ERROR":this._watchState="BACKGROUND",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background")}this.options.showUserLocation&&this._watchState!=="OFF"&&this._updateMarker(o),this.options.trackUserLocation&&this._watchState!=="ACTIVE_LOCK"||this._updateCamera(o),this.options.showUserLocation&&this._dotElement.classList.remove("mapboxgl-user-location-dot-stale"),this.fire(new a.Event("geolocate",o)),this._finish()}},s.prototype._updateCamera=function(o){var c=new a.LngLat(o.coords.longitude,o.coords.latitude),v=o.coords.accuracy,w=this._map.getBearing(),S=a.extend({bearing:w},this.options.fitBoundsOptions);this._map.fitBounds(c.toBounds(v),S,{geolocateSource:!0})},s.prototype._updateMarker=function(o){if(o){var c=new a.LngLat(o.coords.longitude,o.coords.latitude);this._accuracyCircleMarker.setLngLat(c).addTo(this._map),this._userLocationDotMarker.setLngLat(c).addTo(this._map),this._accuracy=o.coords.accuracy,this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}else this._userLocationDotMarker.remove(),this._accuracyCircleMarker.remove()},s.prototype._updateCircleRadius=function(){var o=this._map._container.clientHeight/2,c=this._map.unproject([0,o]),v=this._map.unproject([1,o]),w=c.distanceTo(v),S=Math.ceil(2*this._accuracy/w);this._circleElement.style.width=S+"px",this._circleElement.style.height=S+"px"},s.prototype._onZoom=function(){this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()},s.prototype._onError=function(o){if(this._map){if(this.options.trackUserLocation)if(o.code===1){this._watchState="OFF",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.disabled=!0;var c=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.title=c,this._geolocateButton.setAttribute("aria-label",c),this._geolocationWatchID!==void 0&&this._clearWatch()}else{if(o.code===3&&To)return;this._setErrorState()}this._watchState!=="OFF"&&this.options.showUserLocation&&this._dotElement.classList.add("mapboxgl-user-location-dot-stale"),this.fire(new a.Event("error",o)),this._finish()}},s.prototype._finish=function(){this._timeoutId&&clearTimeout(this._timeoutId),this._timeoutId=void 0},s.prototype._setupUI=function(o){var c=this;if(this._container.addEventListener("contextmenu",function(S){return S.preventDefault()}),this._geolocateButton=T.create("button","mapboxgl-ctrl-geolocate",this._container),T.create("span","mapboxgl-ctrl-icon",this._geolocateButton).setAttribute("aria-hidden",!0),this._geolocateButton.type="button",o===!1){a.warnOnce("Geolocation support is not available so the GeolocateControl will be disabled.");var v=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.disabled=!0,this._geolocateButton.title=v,this._geolocateButton.setAttribute("aria-label",v)}else{var w=this._map._getUIString("GeolocateControl.FindMyLocation");this._geolocateButton.title=w,this._geolocateButton.setAttribute("aria-label",w)}this.options.trackUserLocation&&(this._geolocateButton.setAttribute("aria-pressed","false"),this._watchState="OFF"),this.options.showUserLocation&&(this._dotElement=T.create("div","mapboxgl-user-location-dot"),this._userLocationDotMarker=new bs(this._dotElement),this._circleElement=T.create("div","mapboxgl-user-location-accuracy-circle"),this._accuracyCircleMarker=new bs({element:this._circleElement,pitchAlignment:"map"}),this.options.trackUserLocation&&(this._watchState="OFF"),this._map.on("zoom",this._onZoom)),this._geolocateButton.addEventListener("click",this.trigger.bind(this)),this._setup=!0,this.options.trackUserLocation&&this._map.on("movestart",function(S){S.geolocateSource||c._watchState!=="ACTIVE_LOCK"||S.originalEvent&&S.originalEvent.type==="resize"||(c._watchState="BACKGROUND",c._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background"),c._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),c.fire(new a.Event("trackuserlocationend")))})},s.prototype.trigger=function(){if(!this._setup)return a.warnOnce("Geolocate control triggered before added to a map"),!1;if(this.options.trackUserLocation){switch(this._watchState){case"OFF":this._watchState="WAITING_ACTIVE",this.fire(new a.Event("trackuserlocationstart"));break;case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":case"BACKGROUND_ERROR":Ko--,To=!1,this._watchState="OFF",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this.fire(new a.Event("trackuserlocationend"));break;case"BACKGROUND":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._lastKnownPosition&&this._updateCamera(this._lastKnownPosition),this.fire(new a.Event("trackuserlocationstart"))}switch(this._watchState){case"WAITING_ACTIVE":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"ACTIVE_LOCK":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"ACTIVE_ERROR":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error");break;case"BACKGROUND":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background");break;case"BACKGROUND_ERROR":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background-error")}if(this._watchState==="OFF"&&this._geolocationWatchID!==void 0)this._clearWatch();else if(this._geolocationWatchID===void 0){var o;this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","true"),++Ko>1?(o={maximumAge:6e5,timeout:0},To=!0):(o=this.options.positionOptions,To=!1),this._geolocationWatchID=a.window.navigator.geolocation.watchPosition(this._onSuccess,this._onError,o)}}else a.window.navigator.geolocation.getCurrentPosition(this._onSuccess,this._onError,this.options.positionOptions),this._timeoutId=setTimeout(this._finish,1e4);return!0},s.prototype._clearWatch=function(){a.window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0,this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","false"),this.options.showUserLocation&&this._updateMarker(null)},s}(a.Evented),Wa={maxWidth:100,unit:"metric"},Ya=function(n){this.options=a.extend({},Wa,n),a.bindAll(["_onMove","setUnit"],this)};function el(n,s,o){var c=o&&o.maxWidth||100,v=n._container.clientHeight/2,w=n.unproject([0,v]),S=n.unproject([c,v]),E=w.distanceTo(S);if(o&&o.unit==="imperial"){var P=3.2808*E;P>5280?Ja(s,c,P/5280,n._getUIString("ScaleControl.Miles")):Ja(s,c,P,n._getUIString("ScaleControl.Feet"))}else o&&o.unit==="nautical"?Ja(s,c,E/1852,n._getUIString("ScaleControl.NauticalMiles")):E>=1e3?Ja(s,c,E/1e3,n._getUIString("ScaleControl.Kilometers")):Ja(s,c,E,n._getUIString("ScaleControl.Meters"))}function Ja(n,s,o,c){var v,w,S,E=(v=o,(w=Math.pow(10,(""+Math.floor(v)).length-1))*(S=(S=v/w)>=10?10:S>=5?5:S>=3?3:S>=2?2:S>=1?1:function(P){var O=Math.pow(10,Math.ceil(-Math.log(P)/Math.LN10));return Math.round(P*O)/O}(S)));n.style.width=s*(E/o)+"px",n.innerHTML=E+"&nbsp;"+c}Ya.prototype.getDefaultPosition=function(){return"bottom-left"},Ya.prototype._onMove=function(){el(this._map,this._container,this.options)},Ya.prototype.onAdd=function(n){return this._map=n,this._container=T.create("div","mapboxgl-ctrl mapboxgl-ctrl-scale",n.getContainer()),this._map.on("move",this._onMove),this._onMove(),this._container},Ya.prototype.onRemove=function(){T.remove(this._container),this._map.off("move",this._onMove),this._map=void 0},Ya.prototype.setUnit=function(n){this.options.unit=n,el(this._map,this._container,this.options)};var aa=function(n){this._fullscreen=!1,n&&n.container&&(n.container instanceof a.window.HTMLElement?this._container=n.container:a.warnOnce("Full screen control 'container' must be a DOM element.")),a.bindAll(["_onClickFullscreen","_changeIcon"],this),"onfullscreenchange"in a.window.document?this._fullscreenchange="fullscreenchange":"onmozfullscreenchange"in a.window.document?this._fullscreenchange="mozfullscreenchange":"onwebkitfullscreenchange"in a.window.document?this._fullscreenchange="webkitfullscreenchange":"onmsfullscreenchange"in a.window.document&&(this._fullscreenchange="MSFullscreenChange")};aa.prototype.onAdd=function(n){return this._map=n,this._container||(this._container=this._map.getContainer()),this._controlContainer=T.create("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._checkFullscreenSupport()?this._setupUI():(this._controlContainer.style.display="none",a.warnOnce("This device does not support fullscreen mode.")),this._controlContainer},aa.prototype.onRemove=function(){T.remove(this._controlContainer),this._map=null,a.window.document.removeEventListener(this._fullscreenchange,this._changeIcon)},aa.prototype._checkFullscreenSupport=function(){return!!(a.window.document.fullscreenEnabled||a.window.document.mozFullScreenEnabled||a.window.document.msFullscreenEnabled||a.window.document.webkitFullscreenEnabled)},aa.prototype._setupUI=function(){var n=this._fullscreenButton=T.create("button","mapboxgl-ctrl-fullscreen",this._controlContainer);T.create("span","mapboxgl-ctrl-icon",n).setAttribute("aria-hidden",!0),n.type="button",this._updateTitle(),this._fullscreenButton.addEventListener("click",this._onClickFullscreen),a.window.document.addEventListener(this._fullscreenchange,this._changeIcon)},aa.prototype._updateTitle=function(){var n=this._getTitle();this._fullscreenButton.setAttribute("aria-label",n),this._fullscreenButton.title=n},aa.prototype._getTitle=function(){return this._map._getUIString(this._isFullscreen()?"FullscreenControl.Exit":"FullscreenControl.Enter")},aa.prototype._isFullscreen=function(){return this._fullscreen},aa.prototype._changeIcon=function(){(a.window.document.fullscreenElement||a.window.document.mozFullScreenElement||a.window.document.webkitFullscreenElement||a.window.document.msFullscreenElement)===this._container!==this._fullscreen&&(this._fullscreen=!this._fullscreen,this._fullscreenButton.classList.toggle("mapboxgl-ctrl-shrink"),this._fullscreenButton.classList.toggle("mapboxgl-ctrl-fullscreen"),this._updateTitle())},aa.prototype._onClickFullscreen=function(){this._isFullscreen()?a.window.document.exitFullscreen?a.window.document.exitFullscreen():a.window.document.mozCancelFullScreen?a.window.document.mozCancelFullScreen():a.window.document.msExitFullscreen?a.window.document.msExitFullscreen():a.window.document.webkitCancelFullScreen&&a.window.document.webkitCancelFullScreen():this._container.requestFullscreen?this._container.requestFullscreen():this._container.mozRequestFullScreen?this._container.mozRequestFullScreen():this._container.msRequestFullscreen?this._container.msRequestFullscreen():this._container.webkitRequestFullscreen&&this._container.webkitRequestFullscreen()};var au={closeButton:!0,closeOnClick:!0,focusAfterOpen:!0,className:"",maxWidth:"240px"},xs=["a[href]","[tabindex]:not([tabindex='-1'])","[contenteditable]:not([contenteditable='false'])","button:not([disabled])","input:not([disabled])","select:not([disabled])","textarea:not([disabled])"].join(", "),ou=function(n){function s(o){n.call(this),this.options=a.extend(Object.create(au),o),a.bindAll(["_update","_onClose","remove","_onMouseMove","_onMouseUp","_onDrag"],this)}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype.addTo=function(o){return this._map&&this.remove(),this._map=o,this.options.closeOnClick&&this._map.on("click",this._onClose),this.options.closeOnMove&&this._map.on("move",this._onClose),this._map.on("remove",this.remove),this._update(),this._focusFirstElement(),this._trackPointer?(this._map.on("mousemove",this._onMouseMove),this._map.on("mouseup",this._onMouseUp),this._container&&this._container.classList.add("mapboxgl-popup-track-pointer"),this._map._canvasContainer.classList.add("mapboxgl-track-pointer")):this._map.on("move",this._update),this.fire(new a.Event("open")),this},s.prototype.isOpen=function(){return!!this._map},s.prototype.remove=function(){return this._content&&T.remove(this._content),this._container&&(T.remove(this._container),delete this._container),this._map&&(this._map.off("move",this._update),this._map.off("move",this._onClose),this._map.off("click",this._onClose),this._map.off("remove",this.remove),this._map.off("mousemove",this._onMouseMove),this._map.off("mouseup",this._onMouseUp),this._map.off("drag",this._onDrag),delete this._map),this.fire(new a.Event("close")),this},s.prototype.getLngLat=function(){return this._lngLat},s.prototype.setLngLat=function(o){return this._lngLat=a.LngLat.convert(o),this._pos=null,this._trackPointer=!1,this._update(),this._map&&(this._map.on("move",this._update),this._map.off("mousemove",this._onMouseMove),this._container&&this._container.classList.remove("mapboxgl-popup-track-pointer"),this._map._canvasContainer.classList.remove("mapboxgl-track-pointer")),this},s.prototype.trackPointer=function(){return this._trackPointer=!0,this._pos=null,this._update(),this._map&&(this._map.off("move",this._update),this._map.on("mousemove",this._onMouseMove),this._map.on("drag",this._onDrag),this._container&&this._container.classList.add("mapboxgl-popup-track-pointer"),this._map._canvasContainer.classList.add("mapboxgl-track-pointer")),this},s.prototype.getElement=function(){return this._container},s.prototype.setText=function(o){return this.setDOMContent(a.window.document.createTextNode(o))},s.prototype.setHTML=function(o){var c,v=a.window.document.createDocumentFragment(),w=a.window.document.createElement("body");for(w.innerHTML=o;c=w.firstChild;)v.appendChild(c);return this.setDOMContent(v)},s.prototype.getMaxWidth=function(){return this._container&&this._container.style.maxWidth},s.prototype.setMaxWidth=function(o){return this.options.maxWidth=o,this._update(),this},s.prototype.setDOMContent=function(o){if(this._content)for(;this._content.hasChildNodes();)this._content.firstChild&&this._content.removeChild(this._content.firstChild);else this._content=T.create("div","mapboxgl-popup-content",this._container);return this._content.appendChild(o),this._createCloseButton(),this._update(),this._focusFirstElement(),this},s.prototype.addClassName=function(o){this._container&&this._container.classList.add(o)},s.prototype.removeClassName=function(o){this._container&&this._container.classList.remove(o)},s.prototype.setOffset=function(o){return this.options.offset=o,this._update(),this},s.prototype.toggleClassName=function(o){if(this._container)return this._container.classList.toggle(o)},s.prototype._createCloseButton=function(){this.options.closeButton&&(this._closeButton=T.create("button","mapboxgl-popup-close-button",this._content),this._closeButton.type="button",this._closeButton.setAttribute("aria-label","Close popup"),this._closeButton.innerHTML="&#215;",this._closeButton.addEventListener("click",this._onClose))},s.prototype._onMouseUp=function(o){this._update(o.point)},s.prototype._onMouseMove=function(o){this._update(o.point)},s.prototype._onDrag=function(o){this._update(o.point)},s.prototype._update=function(o){var c=this;if(this._map&&(this._lngLat||this._trackPointer)&&this._content&&(this._container||(this._container=T.create("div","mapboxgl-popup",this._map.getContainer()),this._tip=T.create("div","mapboxgl-popup-tip",this._container),this._container.appendChild(this._content),this.options.className&&this.options.className.split(" ").forEach(function(Z){return c._container.classList.add(Z)}),this._trackPointer&&this._container.classList.add("mapboxgl-popup-track-pointer")),this.options.maxWidth&&this._container.style.maxWidth!==this.options.maxWidth&&(this._container.style.maxWidth=this.options.maxWidth),this._map.transform.renderWorldCopies&&!this._trackPointer&&(this._lngLat=Go(this._lngLat,this._pos,this._map.transform)),!this._trackPointer||o)){var v=this._pos=this._trackPointer&&o?o:this._map.project(this._lngLat),w=this.options.anchor,S=function Z(H){if(H){if(typeof H=="number"){var te=Math.round(Math.sqrt(.5*Math.pow(H,2)));return{center:new a.Point(0,0),top:new a.Point(0,H),"top-left":new a.Point(te,te),"top-right":new a.Point(-te,te),bottom:new a.Point(0,-H),"bottom-left":new a.Point(te,-te),"bottom-right":new a.Point(-te,-te),left:new a.Point(H,0),right:new a.Point(-H,0)}}if(H instanceof a.Point||Array.isArray(H)){var ee=a.Point.convert(H);return{center:ee,top:ee,"top-left":ee,"top-right":ee,bottom:ee,"bottom-left":ee,"bottom-right":ee,left:ee,right:ee}}return{center:a.Point.convert(H.center||[0,0]),top:a.Point.convert(H.top||[0,0]),"top-left":a.Point.convert(H["top-left"]||[0,0]),"top-right":a.Point.convert(H["top-right"]||[0,0]),bottom:a.Point.convert(H.bottom||[0,0]),"bottom-left":a.Point.convert(H["bottom-left"]||[0,0]),"bottom-right":a.Point.convert(H["bottom-right"]||[0,0]),left:a.Point.convert(H.left||[0,0]),right:a.Point.convert(H.right||[0,0])}}return Z(new a.Point(0,0))}(this.options.offset);if(!w){var E,P=this._container.offsetWidth,O=this._container.offsetHeight;E=v.y+S.bottom.y<O?["top"]:v.y>this._map.transform.height-O?["bottom"]:[],v.x<P/2?E.push("left"):v.x>this._map.transform.width-P/2&&E.push("right"),w=E.length===0?"bottom":E.join("-")}var G=v.add(S[w]).round();T.setTransform(this._container,Ia[w]+" translate("+G.x+"px,"+G.y+"px)"),$s(this._container,w,"popup")}},s.prototype._focusFirstElement=function(){if(this.options.focusAfterOpen&&this._container){var o=this._container.querySelector(xs);o&&o.focus()}},s.prototype._onClose=function(){this.remove()},s}(a.Evented),tl={version:a.version,supported:I,setRTLTextPlugin:a.setRTLTextPlugin,getRTLTextPluginStatus:a.getRTLTextPluginStatus,Map:Ec,NavigationControl:Da,GeolocateControl:nu,AttributionControl:bn,ScaleControl:Ya,FullscreenControl:aa,Popup:ou,Marker:bs,Style:On,LngLat:a.LngLat,LngLatBounds:a.LngLatBounds,Point:a.Point,MercatorCoordinate:a.MercatorCoordinate,Evented:a.Evented,config:a.config,prewarm:function(){Te().acquire(Ee)},clearPrewarmedResources:function(){var n=ht;n&&(n.isPreloaded()&&n.numActive()===1?(n.release(Ee),ht=null):console.warn("Could not clear WebWorkers since there are active Map instances that still reference it. The pre-warmed WebWorker pool can only be cleared when all map instances have been removed with map.remove()"))},get accessToken(){return a.config.ACCESS_TOKEN},set accessToken(n){a.config.ACCESS_TOKEN=n},get baseApiUrl(){return a.config.API_URL},set baseApiUrl(n){a.config.API_URL=n},get workerCount(){return Re.workerCount},set workerCount(n){Re.workerCount=n},get maxParallelImageRequests(){return a.config.MAX_PARALLEL_IMAGE_REQUESTS},set maxParallelImageRequests(n){a.config.MAX_PARALLEL_IMAGE_REQUESTS=n},clearStorage:function(n){a.clearTileCache(n)},workerUrl:""};return tl}),y})})(uy);var vh=uy.exports;const K_=g_(vh);function Sd(u){let h;const d=u[15].default,p=Ru(d,u,u[14],null);return{c(){p&&p.c()},l(y){p&&p.l(y)},m(y,_){p&&p.m(y,_),h=!0},p(y,_){p&&p.p&&(!h||_&16384)&&Bu(p,d,y,y[14],h?Fu(d,y[14],_,null):Ou(y[14]),null)},i(y){h||(tt(p,y),h=!0)},o(y){ut(p,y),h=!1},d(y){p&&p.d(y)}}}function H_(u){let h,d,p,y=u[0]&&Sd(u);return{c(){h=je("div"),y&&y.c(),this.h()},l(_){h=Ge(_,"DIV",{class:!0,id:!0});var a=Ve(h);y&&y.l(a),a.forEach(ae),this.h()},h(){ne(h,"class","absolute top-0 bg-grey4 w-full h-full svelte-a65d1y"),ne(h,"id",u[1]),ju(()=>u[16].call(h))},m(_,a){Be(_,h,a),y&&y.m(h,null),d=Gu(h,u[16].bind(h)),u[17](h),p=!0},p(_,[a]){_[0]?y?(y.p(_,a),a&1&&tt(y,1)):(y=Sd(_),y.c(),tt(y,1),y.m(h,null)):y&&(En(),ut(y,1,1,()=>{y=null}),Tn()),(!p||a&2)&&ne(h,"id",_[1])},i(_){p||(tt(y),p=!0)},o(_){ut(y),p=!1},d(_){_&&ae(h),y&&y.d(),d(),u[17](null)}}}function X_(u,h,d){let{$$slots:p={},$$scope:y}=h,{map:_}=h,{id:a="map"}=h,{location:I={bounds:[[-8.1775,54.02275],[-5.43279,55.31298]]}}=h,{style:T="https://raw.githubusercontent.com/NISRA-Tech-Lab/map_tiles/main/basemap_styles/style-omt.json"}=h,{interactive:D=!0}=h,{minzoom:F=0}=h,{maxzoom:M=14}=h,{zoom:L=null}=h,{scrollzoom:X=!0}=h,{geolocate:oe=!0}=h,{zoomcontrol:se=!0}=h,{options:pe={}}=h,xe,be;iy("map",{getMap:()=>_}),I.bounds?pe={...pe,bounds:I.bounds}:I.lon&&I.lat&&(pe={...pe,center:[I.lon,I.lat]},I.zoom&&(pe.zoom=I.zoom)),ny(()=>{const Ze=document.createElement("link");return Ze.rel="stylesheet",Ze.href="https://unpkg.com/mapbox-gl@1.13.0/dist/mapbox-gl.css",Ze.onload=()=>{d(0,_=new vh.Map({container:xe,style:T,minZoom:F,maxZoom:M,maxBounds:[[-9.2,53.58],[-4.53,55.72]],interactive:D,...pe})),se&&_.addControl(new vh.NavigationControl({showCompass:!1})),X||_.scrollZoom.disable(),oe&&_.addControl(new vh.GeolocateControl),_.on("load",()=>{d(4,L=_.getZoom())}),_.on("zoom",()=>{d(4,L=_.getZoom())})},document.head.appendChild(Ze),()=>{_.remove(),Ze.parentNode.removeChild(Ze)}});function ct(){let Ze=document.getElementsByClassName("mapboxgl-canvas");Ze[0]&&(Ze[0].style.width="100%",_.resize())}function We(){be=this.clientWidth,d(2,be)}function De(Ze){Nu[Ze?"unshift":"push"](()=>{xe=Ze,d(3,xe)})}return u.$$set=Ze=>{"map"in Ze&&d(0,_=Ze.map),"id"in Ze&&d(1,a=Ze.id),"location"in Ze&&d(6,I=Ze.location),"style"in Ze&&d(7,T=Ze.style),"interactive"in Ze&&d(8,D=Ze.interactive),"minzoom"in Ze&&d(9,F=Ze.minzoom),"maxzoom"in Ze&&d(10,M=Ze.maxzoom),"zoom"in Ze&&d(4,L=Ze.zoom),"scrollzoom"in Ze&&d(11,X=Ze.scrollzoom),"geolocate"in Ze&&d(12,oe=Ze.geolocate),"zoomcontrol"in Ze&&d(13,se=Ze.zoomcontrol),"options"in Ze&&d(5,pe=Ze.options),"$$scope"in Ze&&d(14,y=Ze.$$scope)},u.$$.update=()=>{u.$$.dirty&4&&be&&ct()},[_,a,be,xe,L,pe,I,T,D,F,M,X,oe,se,y,p,We,De]}class W_ extends mn{constructor(h){super(),yn(this,h,X_,H_,gn,{map:0,id:1,location:6,style:7,interactive:8,minzoom:9,maxzoom:10,zoom:4,scrollzoom:11,geolocate:12,zoomcontrol:13,options:5})}}function kd(u){let h;const d=u[11].default,p=Ru(d,u,u[10],null);return{c(){p&&p.c()},l(y){p&&p.l(y)},m(y,_){p&&p.m(y,_),h=!0},p(y,_){p&&p.p&&(!h||_&1024)&&Bu(p,d,y,y[10],h?Fu(d,y[10],_,null):Ou(y[10]),null)},i(y){h||(tt(p,y),h=!0)},o(y){ut(p,y),h=!1},d(y){p&&p.d(y)}}}function Y_(u){let h,d,p=u[0]&&kd(u);return{c(){p&&p.c(),h=ur()},l(y){p&&p.l(y),h=ur()},m(y,_){p&&p.m(y,_),Be(y,h,_),d=!0},p(y,[_]){y[0]?p?(p.p(y,_),_&1&&tt(p,1)):(p=kd(y),p.c(),tt(p,1),p.m(h.parentNode,h)):p&&(En(),ut(p,1,1,()=>{p=null}),Tn())},i(y){d||(tt(p),d=!0)},o(y){ut(p),d=!1},d(y){p&&p.d(y),y&&ae(h)}}}function J_(u,h,d){let{$$slots:p={},$$scope:y}=h,{id:_}=h,{type:a}=h,{url:I=null}=h,{props:T={}}=h,{data:D=null}=h,{layer:F=null}=h,{promoteId:M=null}=h,{minzoom:L=null}=h,{maxzoom:X=null}=h,oe=!1;const{getMap:se}=Zu("map"),pe=se();pe.getSource(_)&&pe.removeSource(_);function xe(){pe.isSourceLoaded(_)?(d(0,oe=!0),console.log(_+" loaded!")):setTimeout(()=>{console.log("..."),xe()},500)}function be(){pe.isStyleLoaded(_)?(ct(),document.querySelector("#map canvas")&&document.querySelector("#map canvas").tabIndex=="0"&&(document.querySelector("#map canvas").tabIndex="-1")):setTimeout(()=>{console.log("..."),be()},500)}L&&(T.minzoom=L),X&&(T.maxzoom=X),F&&M?(T.promoteId={},T.promoteId[F]=M):M&&(T.promoteId=M);function ct(){console.log(_+" map source loading..."),a=="geojson"?D?(pe.addSource(_,{type:a,data:D,...T}),xe()):I&&(pe.addSource(_,{type:a,data:I,...T}),xe()):a=="vector"&&(pe.addSource(_,{type:a,tiles:[I],...T}),xe())}be();function We(){pe.getSource(_).setData(D)}return u.$$set=De=>{"id"in De&&d(2,_=De.id),"type"in De&&d(3,a=De.type),"url"in De&&d(4,I=De.url),"props"in De&&d(1,T=De.props),"data"in De&&d(5,D=De.data),"layer"in De&&d(6,F=De.layer),"promoteId"in De&&d(7,M=De.promoteId),"minzoom"in De&&d(8,L=De.minzoom),"maxzoom"in De&&d(9,X=De.maxzoom),"$$scope"in De&&d(10,y=De.$$scope)},u.$$.update=()=>{u.$$.dirty&33&&oe&&D&&We()},[oe,T,_,a,I,D,F,M,L,X,y,p]}class Q_ extends mn{constructor(h){super(),yn(this,h,J_,Y_,gn,{id:2,type:3,url:4,props:1,data:5,layer:6,promoteId:7,minzoom:8,maxzoom:9})}}function $_(u,h,d){const{Popup:p}=K_,y=u_(),_=new p({closeButton:!1,closeOnClick:!1});let{id:a}=h,{source:I}=h,{sourceLayer:T=null}=h,{type:D}=h,{filter:F=null}=h,{layout:M={}}=h,{paint:L={}}=h,{data:X=null}=h,{code:oe=null}=h,{name:se="name"}=h,{colorCode:pe=null}=h,{click:xe=!1}=h,{ignoreClick:be=!1}=h,{clickCenter:ct=!1}=h,{selected:We=null}=h,{hover:De=!1}=h,{hovered:Ze=null}=h,{highlight:Dt=!1}=h,{highlightKey:zt="highlighted"}=h,{highlighted:Ue=[]}=h,{order:Ke=null}=h,{maxzoom:vt=null}=h,{minzoom:cr=null}=h,{isChild:Ne=!1}=h;const{getMap:Rt}=Zu("map"),Me=Rt();let $e=null,mt=null,qt=[];Me.getLayer(a)&&Me.removeLayer(a);let Bt={id:a,type:D,source:I,paint:L,layout:M};F&&(Bt.filter=F),T&&(Bt["source-layer"]=T),vt&&(Bt.maxzoom=vt),cr&&(Bt.minzoom=cr),Me.addLayer(Bt,Ke);function St(){console.log("updating colors..."),X.forEach(Oe=>{Me.setFeatureState({source:I,sourceLayer:T,id:Oe[oe]},{color:Oe[pe]})})}return xe&&Me.on("click",a,Oe=>{if(Oe.features.length>0&&!be){let ot=Oe.features[0].id;if(Ne&&Ue.includes(ot)||!Ne&&We!=ot){if(d(0,We=ot),y("select",{code:We}),$e&&Me.setFeatureState({source:I,sourceLayer:T,id:$e},{selected:!1}),Me.setFeatureState({source:I,sourceLayer:T,id:We},{selected:!0}),ct){let Dr=centroid(Oe.features[0].toJSON().geometry);Me.flyTo({center:Dr.geometry.coordinates})}d(24,$e=We)}}}),De&&(Me.on("mousemove",a,Oe=>{if(Oe.features.length>0){let ot=Oe.features[0].id;Ze&&Me.setFeatureState({source:I,sourceLayer:T,id:Ze},{hovered:!1}),Ne&&Ue.includes(ot)||!Ne&&We!=ot?(d(1,Ze=d(25,mt=ot)),Me.setFeatureState({source:I,sourceLayer:T,id:Ze},{hovered:!0}),Me.getCanvas().style.cursor="pointer",_.setLngLat(Oe.lngLat).setHTML(`<strong>${Oe.features[0].properties[se]?Oe.features[0].properties[se]:Oe.features[0].properties[oe]}</strong>`).addTo(Me)):_.remove()}}),Me.on("mouseleave",a,Oe=>{Ze&&Me.setFeatureState({source:I,sourceLayer:T,id:Ze},{hovered:!1}),d(1,Ze=d(25,mt=null)),Me.getCanvas().style.cursor="",_.remove()})),u.$$set=Oe=>{"id"in Oe&&d(2,a=Oe.id),"source"in Oe&&d(3,I=Oe.source),"sourceLayer"in Oe&&d(4,T=Oe.sourceLayer),"type"in Oe&&d(5,D=Oe.type),"filter"in Oe&&d(6,F=Oe.filter),"layout"in Oe&&d(7,M=Oe.layout),"paint"in Oe&&d(8,L=Oe.paint),"data"in Oe&&d(9,X=Oe.data),"code"in Oe&&d(10,oe=Oe.code),"name"in Oe&&d(11,se=Oe.name),"colorCode"in Oe&&d(12,pe=Oe.colorCode),"click"in Oe&&d(13,xe=Oe.click),"ignoreClick"in Oe&&d(14,be=Oe.ignoreClick),"clickCenter"in Oe&&d(15,ct=Oe.clickCenter),"selected"in Oe&&d(0,We=Oe.selected),"hover"in Oe&&d(16,De=Oe.hover),"hovered"in Oe&&d(1,Ze=Oe.hovered),"highlight"in Oe&&d(17,Dt=Oe.highlight),"highlightKey"in Oe&&d(18,zt=Oe.highlightKey),"highlighted"in Oe&&d(19,Ue=Oe.highlighted),"order"in Oe&&d(20,Ke=Oe.order),"maxzoom"in Oe&&d(21,vt=Oe.maxzoom),"minzoom"in Oe&&d(22,cr=Oe.minzoom),"isChild"in Oe&&d(23,Ne=Oe.isChild)},u.$$.update=()=>{u.$$.dirty[0]&4096&&pe&&St(),u.$$.dirty[0]&68026392&&Dt&&Ue!=qt&&(qt[0]&&qt.forEach(Oe=>{let ot={};ot[zt]=!1,Me.setFeatureState({source:I,sourceLayer:T,id:Oe},ot)}),d(26,qt=Ue),Ue[0]&&Ue.forEach(Oe=>{let ot={};ot[zt]=!0,Me.setFeatureState({source:I,sourceLayer:T,id:Oe},ot)})),u.$$.dirty[0]&16777241&&We!=$e&&($e&&Me.setFeatureState({source:I,sourceLayer:T,id:$e},{selected:!1}),We&&Me.setFeatureState({source:I,sourceLayer:T,id:We},{selected:!0}),d(24,$e=We)),u.$$.dirty[0]&33619994&&De&&Ze!=mt&&(mt&&Me.setFeatureState({source:I,sourceLayer:T,id:mt},{hovered:!1}),Ze&&Me.setFeatureState({source:I,sourceLayer:T,id:Ze},{hovered:!0}),d(25,mt=Ze))},[We,Ze,a,I,T,D,F,M,L,X,oe,se,pe,xe,be,ct,De,Dt,zt,Ue,Ke,vt,cr,Ne,$e,mt,qt]}class Ip extends mn{constructor(h){super(),yn(this,h,$_,null,gn,{id:2,source:3,sourceLayer:4,type:5,filter:6,layout:7,paint:8,data:9,code:10,name:11,colorCode:12,click:13,ignoreClick:14,clickCenter:15,selected:0,hover:16,hovered:1,highlight:17,highlightKey:18,highlighted:19,order:20,maxzoom:21,minzoom:22,isChild:23},null,[-1,-1])}}function ev(u){return u===0?!0:u}function es(u){return ev(u)?Array.isArray(u)?h=>u.map(d=>typeof d!="function"?h[d]:d(h)):typeof u!="function"?h=>h[u]:u:null}function tv(u){const h={};for(const d of u){if(Object(d)!==d)throw new TypeError("iterable for fromEntries should yield objects");const{"0":p,"1":y}=d;Object.defineProperty(h,p,{configurable:!0,enumerable:!0,writable:!0,value:y})}return h}function Ap(u,h={}){return tv(Object.entries(u).filter(([d,p])=>p!==void 0&&h[d]===void 0))}function rv(u,h){if(!Array.isArray(u))throw new TypeError(`The first argument of calcExtents() must be an array. You passed in a ${typeof u}. Consider passing a flat array to the \`flatData\` prop. More info: https://layercake.graphics/guide/#flatdata`);if(Array.isArray(h)||h===void 0||h===null)throw new TypeError("The second argument of calcExtents() must be an object with field names as keys as accessor functions as values.");const d={},p=Object.keys(h),y=p.length;let _,a,I,T,D,F,M,L;const X=u.length;for(_=0;_<y;_+=1){for(T=p[_],M=h[T],D=null,F=null,a=0;a<X;a+=1)if(L=M(u[a]),Array.isArray(L)){const oe=L.length;for(I=0;I<oe;I+=1)L[I]!==void 0&&L[I]!==null&&Number.isNaN(L[I])===!1&&((D===null||L[I]<D)&&(D=L[I]),(F===null||L[I]>F)&&(F=L[I]))}else L!=null&&Number.isNaN(L)===!1&&((D===null||L<D)&&(D=L),(F===null||L>F)&&(F=L));d[T]=[D,F]}return d}function cy(u=[],h){return Array.isArray(h)===!0?h.map((d,p)=>d===null?u[p]:d):u}function oh(u){return function([d,p]){return d?cy(d[u],p):p}}function bh(u,h){return u==null||h==null?NaN:u<h?-1:u>h?1:u>=h?0:NaN}function iv(u,h){return u==null||h==null?NaN:h<u?-1:h>u?1:h>=u?0:NaN}function hy(u){let h,d,p;u.length!==2?(h=bh,d=(I,T)=>bh(u(I),T),p=(I,T)=>u(I)-T):(h=u===bh||u===iv?u:nv,d=u,p=u);function y(I,T,D=0,F=I.length){if(D<F){if(h(T,T)!==0)return F;do{const M=D+F>>>1;d(I[M],T)<0?D=M+1:F=M}while(D<F)}return D}function _(I,T,D=0,F=I.length){if(D<F){if(h(T,T)!==0)return F;do{const M=D+F>>>1;d(I[M],T)<=0?D=M+1:F=M}while(D<F)}return D}function a(I,T,D=0,F=I.length){const M=y(I,T,D,F-1);return M>D&&p(I[M-1],T)>-p(I[M],T)?M-1:M}return{left:y,center:a,right:_}}function nv(){return 0}function av(u){return u===null?NaN:+u}const ov=hy(bh),sv=ov.right;hy(av).center;const lv=sv;class Ed extends Map{constructor(h,d=hv){if(super(),Object.defineProperties(this,{_intern:{value:new Map},_key:{value:d}}),h!=null)for(const[p,y]of h)this.set(p,y)}get(h){return super.get(Td(this,h))}has(h){return super.has(Td(this,h))}set(h,d){return super.set(uv(this,h),d)}delete(h){return super.delete(cv(this,h))}}function Td({_intern:u,_key:h},d){const p=h(d);return u.has(p)?u.get(p):d}function uv({_intern:u,_key:h},d){const p=h(d);return u.has(p)?u.get(p):(u.set(p,d),d)}function cv({_intern:u,_key:h},d){const p=h(d);return u.has(p)&&(d=u.get(p),u.delete(p)),d}function hv(u){return u!==null&&typeof u=="object"?u.valueOf():u}var Dp=Math.sqrt(50),Lp=Math.sqrt(10),Rp=Math.sqrt(2);function pv(u,h,d){var p,y=-1,_,a,I;if(h=+h,u=+u,d=+d,u===h&&d>0)return[u];if((p=h<u)&&(_=u,u=h,h=_),(I=py(u,h,d))===0||!isFinite(I))return[];if(I>0){let T=Math.round(u/I),D=Math.round(h/I);for(T*I<u&&++T,D*I>h&&--D,a=new Array(_=D-T+1);++y<_;)a[y]=(T+y)*I}else{I=-I;let T=Math.round(u*I),D=Math.round(h*I);for(T/I<u&&++T,D/I>h&&--D,a=new Array(_=D-T+1);++y<_;)a[y]=(T+y)/I}return p&&a.reverse(),a}function py(u,h,d){var p=(h-u)/Math.max(0,d),y=Math.floor(Math.log(p)/Math.LN10),_=p/Math.pow(10,y);return y>=0?(_>=Dp?10:_>=Lp?5:_>=Rp?2:1)*Math.pow(10,y):-Math.pow(10,-y)/(_>=Dp?10:_>=Lp?5:_>=Rp?2:1)}function fv(u,h,d){var p=Math.abs(h-u)/Math.max(0,d),y=Math.pow(10,Math.floor(Math.log(p)/Math.LN10)),_=p/y;return _>=Dp?y*=10:_>=Lp?y*=5:_>=Rp&&(y*=2),h<u?-y:y}function dv(u,h,d){u=+u,h=+h,d=(y=arguments.length)<2?(h=u,u=0,1):y<3?1:+d;for(var p=-1,y=Math.max(0,Math.ceil((h-u)/d))|0,_=new Array(y);++p<y;)_[p]=u+p*d;return _}function Mh(u,h){switch(arguments.length){case 0:break;case 1:this.range(u);break;default:this.range(h).domain(u);break}return this}const Id=Symbol("implicit");function fy(){var u=new Ed,h=[],d=[],p=Id;function y(_){let a=u.get(_);if(a===void 0){if(p!==Id)return p;u.set(_,a=h.push(_)-1)}return d[a%d.length]}return y.domain=function(_){if(!arguments.length)return h.slice();h=[],u=new Ed;for(const a of _)u.has(a)||u.set(a,h.push(a)-1);return y},y.range=function(_){return arguments.length?(d=Array.from(_),y):d.slice()},y.unknown=function(_){return arguments.length?(p=_,y):p},y.copy=function(){return fy(h,d).unknown(p)},Mh.apply(y,arguments),y}function dy(){var u=fy().unknown(void 0),h=u.domain,d=u.range,p=0,y=1,_,a,I=!1,T=0,D=0,F=.5;delete u.unknown;function M(){var L=h().length,X=y<p,oe=X?y:p,se=X?p:y;_=(se-oe)/Math.max(1,L-T+D*2),I&&(_=Math.floor(_)),oe+=(se-oe-_*(L-T))*F,a=_*(1-T),I&&(oe=Math.round(oe),a=Math.round(a));var pe=dv(L).map(function(xe){return oe+_*xe});return d(X?pe.reverse():pe)}return u.domain=function(L){return arguments.length?(h(L),M()):h()},u.range=function(L){return arguments.length?([p,y]=L,p=+p,y=+y,M()):[p,y]},u.rangeRound=function(L){return[p,y]=L,p=+p,y=+y,I=!0,M()},u.bandwidth=function(){return a},u.step=function(){return _},u.round=function(L){return arguments.length?(I=!!L,M()):I},u.padding=function(L){return arguments.length?(T=Math.min(1,D=+L),M()):T},u.paddingInner=function(L){return arguments.length?(T=Math.min(1,L),M()):T},u.paddingOuter=function(L){return arguments.length?(D=+L,M()):D},u.align=function(L){return arguments.length?(F=Math.max(0,Math.min(1,L)),M()):F},u.copy=function(){return dy(h(),[p,y]).round(I).paddingInner(T).paddingOuter(D).align(F)},Mh.apply(M(),arguments)}function Gp(u,h,d){u.prototype=h.prototype=d,d.constructor=u}function my(u,h){var d=Object.create(u.prototype);for(var p in h)d[p]=h[p];return d}function $u(){}var Vu=.7,Sh=1/Vu,Ml="\\s*([+-]?\\d+)\\s*",Uu="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",lo="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",mv=/^#([0-9a-f]{3,8})$/,yv=new RegExp(`^rgb\\(${Ml},${Ml},${Ml}\\)$`),gv=new RegExp(`^rgb\\(${lo},${lo},${lo}\\)$`),_v=new RegExp(`^rgba\\(${Ml},${Ml},${Ml},${Uu}\\)$`),vv=new RegExp(`^rgba\\(${lo},${lo},${lo},${Uu}\\)$`),bv=new RegExp(`^hsl\\(${Uu},${lo},${lo}\\)$`),xv=new RegExp(`^hsla\\(${Uu},${lo},${lo},${Uu}\\)$`),Ad={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};Gp($u,qu,{copy(u){return Object.assign(new this.constructor,this,u)},displayable(){return this.rgb().displayable()},hex:zd,formatHex:zd,formatHex8:wv,formatHsl:Sv,formatRgb:Pd,toString:Pd});function zd(){return this.rgb().formatHex()}function wv(){return this.rgb().formatHex8()}function Sv(){return yy(this).formatHsl()}function Pd(){return this.rgb().formatRgb()}function qu(u){var h,d;return u=(u+"").trim().toLowerCase(),(h=mv.exec(u))?(d=h[1].length,h=parseInt(h[1],16),d===6?Cd(h):d===3?new ca(h>>8&15|h>>4&240,h>>4&15|h&240,(h&15)<<4|h&15,1):d===8?sh(h>>24&255,h>>16&255,h>>8&255,(h&255)/255):d===4?sh(h>>12&15|h>>8&240,h>>8&15|h>>4&240,h>>4&15|h&240,((h&15)<<4|h&15)/255):null):(h=yv.exec(u))?new ca(h[1],h[2],h[3],1):(h=gv.exec(u))?new ca(h[1]*255/100,h[2]*255/100,h[3]*255/100,1):(h=_v.exec(u))?sh(h[1],h[2],h[3],h[4]):(h=vv.exec(u))?sh(h[1]*255/100,h[2]*255/100,h[3]*255/100,h[4]):(h=bv.exec(u))?Ld(h[1],h[2]/100,h[3]/100,1):(h=xv.exec(u))?Ld(h[1],h[2]/100,h[3]/100,h[4]):Ad.hasOwnProperty(u)?Cd(Ad[u]):u==="transparent"?new ca(NaN,NaN,NaN,0):null}function Cd(u){return new ca(u>>16&255,u>>8&255,u&255,1)}function sh(u,h,d,p){return p<=0&&(u=h=d=NaN),new ca(u,h,d,p)}function kv(u){return u instanceof $u||(u=qu(u)),u?(u=u.rgb(),new ca(u.r,u.g,u.b,u.opacity)):new ca}function Bp(u,h,d,p){return arguments.length===1?kv(u):new ca(u,h,d,p??1)}function ca(u,h,d,p){this.r=+u,this.g=+h,this.b=+d,this.opacity=+p}Gp(ca,Bp,my($u,{brighter(u){return u=u==null?Sh:Math.pow(Sh,u),new ca(this.r*u,this.g*u,this.b*u,this.opacity)},darker(u){return u=u==null?Vu:Math.pow(Vu,u),new ca(this.r*u,this.g*u,this.b*u,this.opacity)},rgb(){return this},clamp(){return new ca(Ls(this.r),Ls(this.g),Ls(this.b),kh(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:Md,formatHex:Md,formatHex8:Ev,formatRgb:Dd,toString:Dd}));function Md(){return`#${Ds(this.r)}${Ds(this.g)}${Ds(this.b)}`}function Ev(){return`#${Ds(this.r)}${Ds(this.g)}${Ds(this.b)}${Ds((isNaN(this.opacity)?1:this.opacity)*255)}`}function Dd(){const u=kh(this.opacity);return`${u===1?"rgb(":"rgba("}${Ls(this.r)}, ${Ls(this.g)}, ${Ls(this.b)}${u===1?")":`, ${u})`}`}function kh(u){return isNaN(u)?1:Math.max(0,Math.min(1,u))}function Ls(u){return Math.max(0,Math.min(255,Math.round(u)||0))}function Ds(u){return u=Ls(u),(u<16?"0":"")+u.toString(16)}function Ld(u,h,d,p){return p<=0?u=h=d=NaN:d<=0||d>=1?u=h=NaN:h<=0&&(u=NaN),new Fa(u,h,d,p)}function yy(u){if(u instanceof Fa)return new Fa(u.h,u.s,u.l,u.opacity);if(u instanceof $u||(u=qu(u)),!u)return new Fa;if(u instanceof Fa)return u;u=u.rgb();var h=u.r/255,d=u.g/255,p=u.b/255,y=Math.min(h,d,p),_=Math.max(h,d,p),a=NaN,I=_-y,T=(_+y)/2;return I?(h===_?a=(d-p)/I+(d<p)*6:d===_?a=(p-h)/I+2:a=(h-d)/I+4,I/=T<.5?_+y:2-_-y,a*=60):I=T>0&&T<1?0:a,new Fa(a,I,T,u.opacity)}function Tv(u,h,d,p){return arguments.length===1?yy(u):new Fa(u,h,d,p??1)}function Fa(u,h,d,p){this.h=+u,this.s=+h,this.l=+d,this.opacity=+p}Gp(Fa,Tv,my($u,{brighter(u){return u=u==null?Sh:Math.pow(Sh,u),new Fa(this.h,this.s,this.l*u,this.opacity)},darker(u){return u=u==null?Vu:Math.pow(Vu,u),new Fa(this.h,this.s,this.l*u,this.opacity)},rgb(){var u=this.h%360+(this.h<0)*360,h=isNaN(u)||isNaN(this.s)?0:this.s,d=this.l,p=d+(d<.5?d:1-d)*h,y=2*d-p;return new ca(zp(u>=240?u-240:u+120,y,p),zp(u,y,p),zp(u<120?u+240:u-120,y,p),this.opacity)},clamp(){return new Fa(Rd(this.h),lh(this.s),lh(this.l),kh(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){const u=kh(this.opacity);return`${u===1?"hsl(":"hsla("}${Rd(this.h)}, ${lh(this.s)*100}%, ${lh(this.l)*100}%${u===1?")":`, ${u})`}`}}));function Rd(u){return u=(u||0)%360,u<0?u+360:u}function lh(u){return Math.max(0,Math.min(1,u||0))}function zp(u,h,d){return(u<60?h+(d-h)*u/60:u<180?d:u<240?h+(d-h)*(240-u)/60:h)*255}const Zp=u=>()=>u;function Iv(u,h){return function(d){return u+d*h}}function Av(u,h,d){return u=Math.pow(u,d),h=Math.pow(h,d)-u,d=1/d,function(p){return Math.pow(u+p*h,d)}}function zv(u){return(u=+u)==1?gy:function(h,d){return d-h?Av(h,d,u):Zp(isNaN(h)?d:h)}}function gy(u,h){var d=h-u;return d?Iv(u,d):Zp(isNaN(u)?h:u)}const Bd=function u(h){var d=zv(h);function p(y,_){var a=d((y=Bp(y)).r,(_=Bp(_)).r),I=d(y.g,_.g),T=d(y.b,_.b),D=gy(y.opacity,_.opacity);return function(F){return y.r=a(F),y.g=I(F),y.b=T(F),y.opacity=D(F),y+""}}return p.gamma=u,p}(1);function Pv(u,h){h||(h=[]);var d=u?Math.min(h.length,u.length):0,p=h.slice(),y;return function(_){for(y=0;y<d;++y)p[y]=u[y]*(1-_)+h[y]*_;return p}}function Cv(u){return ArrayBuffer.isView(u)&&!(u instanceof DataView)}function Mv(u,h){var d=h?h.length:0,p=u?Math.min(d,u.length):0,y=new Array(p),_=new Array(d),a;for(a=0;a<p;++a)y[a]=Kp(u[a],h[a]);for(;a<d;++a)_[a]=h[a];return function(I){for(a=0;a<p;++a)_[a]=y[a](I);return _}}function Dv(u,h){var d=new Date;return u=+u,h=+h,function(p){return d.setTime(u*(1-p)+h*p),d}}function Eh(u,h){return u=+u,h=+h,function(d){return u*(1-d)+h*d}}function Lv(u,h){var d={},p={},y;(u===null||typeof u!="object")&&(u={}),(h===null||typeof h!="object")&&(h={});for(y in h)y in u?d[y]=Kp(u[y],h[y]):p[y]=h[y];return function(_){for(y in d)p[y]=d[y](_);return p}}var Op=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,Pp=new RegExp(Op.source,"g");function Rv(u){return function(){return u}}function Bv(u){return function(h){return u(h)+""}}function Ov(u,h){var d=Op.lastIndex=Pp.lastIndex=0,p,y,_,a=-1,I=[],T=[];for(u=u+"",h=h+"";(p=Op.exec(u))&&(y=Pp.exec(h));)(_=y.index)>d&&(_=h.slice(d,_),I[a]?I[a]+=_:I[++a]=_),(p=p[0])===(y=y[0])?I[a]?I[a]+=y:I[++a]=y:(I[++a]=null,T.push({i:a,x:Eh(p,y)})),d=Pp.lastIndex;return d<h.length&&(_=h.slice(d),I[a]?I[a]+=_:I[++a]=_),I.length<2?T[0]?Bv(T[0].x):Rv(h):(h=T.length,function(D){for(var F=0,M;F<h;++F)I[(M=T[F]).i]=M.x(D);return I.join("")})}function Kp(u,h){var d=typeof h,p;return h==null||d==="boolean"?Zp(h):(d==="number"?Eh:d==="string"?(p=qu(h))?(h=p,Bd):Ov:h instanceof qu?Bd:h instanceof Date?Dv:Cv(h)?Pv:Array.isArray(h)?Mv:typeof h.valueOf!="function"&&typeof h.toString!="function"||isNaN(h)?Lv:Eh)(u,h)}function Fv(u,h){return u=+u,h=+h,function(d){return Math.round(u*(1-d)+h*d)}}function Nv(u){return function(){return u}}function Vv(u){return+u}var Od=[0,1];function so(u){return u}function Fp(u,h){return(h-=u=+u)?function(d){return(d-u)/h}:Nv(isNaN(h)?NaN:.5)}function Uv(u,h){var d;return u>h&&(d=u,u=h,h=d),function(p){return Math.max(u,Math.min(h,p))}}function qv(u,h,d){var p=u[0],y=u[1],_=h[0],a=h[1];return y<p?(p=Fp(y,p),_=d(a,_)):(p=Fp(p,y),_=d(_,a)),function(I){return _(p(I))}}function jv(u,h,d){var p=Math.min(u.length,h.length)-1,y=new Array(p),_=new Array(p),a=-1;for(u[p]<u[0]&&(u=u.slice().reverse(),h=h.slice().reverse());++a<p;)y[a]=Fp(u[a],u[a+1]),_[a]=d(h[a],h[a+1]);return function(I){var T=lv(u,I,1,p)-1;return _[T](y[T](I))}}function _y(u,h){return h.domain(u.domain()).range(u.range()).interpolate(u.interpolate()).clamp(u.clamp()).unknown(u.unknown())}function vy(){var u=Od,h=Od,d=Kp,p,y,_,a=so,I,T,D;function F(){var L=Math.min(u.length,h.length);return a!==so&&(a=Uv(u[0],u[L-1])),I=L>2?jv:qv,T=D=null,M}function M(L){return L==null||isNaN(L=+L)?_:(T||(T=I(u.map(p),h,d)))(p(a(L)))}return M.invert=function(L){return a(y((D||(D=I(h,u.map(p),Eh)))(L)))},M.domain=function(L){return arguments.length?(u=Array.from(L,Vv),F()):u.slice()},M.range=function(L){return arguments.length?(h=Array.from(L),F()):h.slice()},M.rangeRound=function(L){return h=Array.from(L),d=Fv,F()},M.clamp=function(L){return arguments.length?(a=L?!0:so,F()):a!==so},M.interpolate=function(L){return arguments.length?(d=L,F()):d},M.unknown=function(L){return arguments.length?(_=L,M):_},function(L,X){return p=L,y=X,F()}}function Gv(){return vy()(so,so)}function Zv(u){return Math.abs(u=Math.round(u))>=1e21?u.toLocaleString("en").replace(/,/g,""):u.toString(10)}function Th(u,h){if((d=(u=h?u.toExponential(h-1):u.toExponential()).indexOf("e"))<0)return null;var d,p=u.slice(0,d);return[p.length>1?p[0]+p.slice(2):p,+u.slice(d+1)]}function Dl(u){return u=Th(Math.abs(u)),u?u[1]:NaN}function Kv(u,h){return function(d,p){for(var y=d.length,_=[],a=0,I=u[0],T=0;y>0&&I>0&&(T+I+1>p&&(I=Math.max(1,p-T)),_.push(d.substring(y-=I,y+I)),!((T+=I+1)>p));)I=u[a=(a+1)%u.length];return _.reverse().join(h)}}function Hv(u){return function(h){return h.replace(/[0-9]/g,function(d){return u[+d]})}}var Xv=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function Ih(u){if(!(h=Xv.exec(u)))throw new Error("invalid format: "+u);var h;return new Hp({fill:h[1],align:h[2],sign:h[3],symbol:h[4],zero:h[5],width:h[6],comma:h[7],precision:h[8]&&h[8].slice(1),trim:h[9],type:h[10]})}Ih.prototype=Hp.prototype;function Hp(u){this.fill=u.fill===void 0?" ":u.fill+"",this.align=u.align===void 0?">":u.align+"",this.sign=u.sign===void 0?"-":u.sign+"",this.symbol=u.symbol===void 0?"":u.symbol+"",this.zero=!!u.zero,this.width=u.width===void 0?void 0:+u.width,this.comma=!!u.comma,this.precision=u.precision===void 0?void 0:+u.precision,this.trim=!!u.trim,this.type=u.type===void 0?"":u.type+""}Hp.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(this.width===void 0?"":Math.max(1,this.width|0))+(this.comma?",":"")+(this.precision===void 0?"":"."+Math.max(0,this.precision|0))+(this.trim?"~":"")+this.type};function Wv(u){e:for(var h=u.length,d=1,p=-1,y;d<h;++d)switch(u[d]){case".":p=y=d;break;case"0":p===0&&(p=d),y=d;break;default:if(!+u[d])break e;p>0&&(p=0);break}return p>0?u.slice(0,p)+u.slice(y+1):u}var by;function Yv(u,h){var d=Th(u,h);if(!d)return u+"";var p=d[0],y=d[1],_=y-(by=Math.max(-8,Math.min(8,Math.floor(y/3)))*3)+1,a=p.length;return _===a?p:_>a?p+new Array(_-a+1).join("0"):_>0?p.slice(0,_)+"."+p.slice(_):"0."+new Array(1-_).join("0")+Th(u,Math.max(0,h+_-1))[0]}function Fd(u,h){var d=Th(u,h);if(!d)return u+"";var p=d[0],y=d[1];return y<0?"0."+new Array(-y).join("0")+p:p.length>y+1?p.slice(0,y+1)+"."+p.slice(y+1):p+new Array(y-p.length+2).join("0")}const Nd={"%":(u,h)=>(u*100).toFixed(h),b:u=>Math.round(u).toString(2),c:u=>u+"",d:Zv,e:(u,h)=>u.toExponential(h),f:(u,h)=>u.toFixed(h),g:(u,h)=>u.toPrecision(h),o:u=>Math.round(u).toString(8),p:(u,h)=>Fd(u*100,h),r:Fd,s:Yv,X:u=>Math.round(u).toString(16).toUpperCase(),x:u=>Math.round(u).toString(16)};function Vd(u){return u}var Ud=Array.prototype.map,qd=["y","z","a","f","p","n","µ","m","","k","M","G","T","P","E","Z","Y"];function Jv(u){var h=u.grouping===void 0||u.thousands===void 0?Vd:Kv(Ud.call(u.grouping,Number),u.thousands+""),d=u.currency===void 0?"":u.currency[0]+"",p=u.currency===void 0?"":u.currency[1]+"",y=u.decimal===void 0?".":u.decimal+"",_=u.numerals===void 0?Vd:Hv(Ud.call(u.numerals,String)),a=u.percent===void 0?"%":u.percent+"",I=u.minus===void 0?"−":u.minus+"",T=u.nan===void 0?"NaN":u.nan+"";function D(M){M=Ih(M);var L=M.fill,X=M.align,oe=M.sign,se=M.symbol,pe=M.zero,xe=M.width,be=M.comma,ct=M.precision,We=M.trim,De=M.type;De==="n"?(be=!0,De="g"):Nd[De]||(ct===void 0&&(ct=12),We=!0,De="g"),(pe||L==="0"&&X==="=")&&(pe=!0,L="0",X="=");var Ze=se==="$"?d:se==="#"&&/[boxX]/.test(De)?"0"+De.toLowerCase():"",Dt=se==="$"?p:/[%p]/.test(De)?a:"",zt=Nd[De],Ue=/[defgprs%]/.test(De);ct=ct===void 0?6:/[gprs]/.test(De)?Math.max(1,Math.min(21,ct)):Math.max(0,Math.min(20,ct));function Ke(vt){var cr=Ze,Ne=Dt,Rt,Me,$e;if(De==="c")Ne=zt(vt)+Ne,vt="";else{vt=+vt;var mt=vt<0||1/vt<0;if(vt=isNaN(vt)?T:zt(Math.abs(vt),ct),We&&(vt=Wv(vt)),mt&&+vt==0&&oe!=="+"&&(mt=!1),cr=(mt?oe==="("?oe:I:oe==="-"||oe==="("?"":oe)+cr,Ne=(De==="s"?qd[8+by/3]:"")+Ne+(mt&&oe==="("?")":""),Ue){for(Rt=-1,Me=vt.length;++Rt<Me;)if($e=vt.charCodeAt(Rt),48>$e||$e>57){Ne=($e===46?y+vt.slice(Rt+1):vt.slice(Rt))+Ne,vt=vt.slice(0,Rt);break}}}be&&!pe&&(vt=h(vt,1/0));var qt=cr.length+vt.length+Ne.length,Bt=qt<xe?new Array(xe-qt+1).join(L):"";switch(be&&pe&&(vt=h(Bt+vt,Bt.length?xe-Ne.length:1/0),Bt=""),X){case"<":vt=cr+vt+Ne+Bt;break;case"=":vt=cr+Bt+vt+Ne;break;case"^":vt=Bt.slice(0,qt=Bt.length>>1)+cr+vt+Ne+Bt.slice(qt);break;default:vt=Bt+cr+vt+Ne;break}return _(vt)}return Ke.toString=function(){return M+""},Ke}function F(M,L){var X=D((M=Ih(M),M.type="f",M)),oe=Math.max(-8,Math.min(8,Math.floor(Dl(L)/3)))*3,se=Math.pow(10,-oe),pe=qd[8+oe/3];return function(xe){return X(se*xe)+pe}}return{format:D,formatPrefix:F}}var uh,xy,wy;Qv({thousands:",",grouping:[3],currency:["$",""]});function Qv(u){return uh=Jv(u),xy=uh.format,wy=uh.formatPrefix,uh}function $v(u){return Math.max(0,-Dl(Math.abs(u)))}function e0(u,h){return Math.max(0,Math.max(-8,Math.min(8,Math.floor(Dl(h)/3)))*3-Dl(Math.abs(u)))}function t0(u,h){return u=Math.abs(u),h=Math.abs(h)-u,Math.max(0,Dl(h)-Dl(u))+1}function r0(u,h,d,p){var y=fv(u,h,d),_;switch(p=Ih(p??",f"),p.type){case"s":{var a=Math.max(Math.abs(u),Math.abs(h));return p.precision==null&&!isNaN(_=e0(y,a))&&(p.precision=_),wy(p,a)}case"":case"e":case"g":case"p":case"r":{p.precision==null&&!isNaN(_=t0(y,Math.max(Math.abs(u),Math.abs(h))))&&(p.precision=_-(p.type==="e"));break}case"f":case"%":{p.precision==null&&!isNaN(_=$v(y))&&(p.precision=_-(p.type==="%")*2);break}}return xy(p)}function Sy(u){var h=u.domain;return u.ticks=function(d){var p=h();return pv(p[0],p[p.length-1],d??10)},u.tickFormat=function(d,p){var y=h();return r0(y[0],y[y.length-1],d??10,p)},u.nice=function(d){d==null&&(d=10);var p=h(),y=0,_=p.length-1,a=p[y],I=p[_],T,D,F=10;for(I<a&&(D=a,a=I,I=D,D=y,y=_,_=D);F-- >0;){if(D=py(a,I,d),D===T)return p[y]=a,p[_]=I,h(p);if(D>0)a=Math.floor(a/D)*D,I=Math.ceil(I/D)*D;else if(D<0)a=Math.ceil(a*D)/D,I=Math.floor(I*D)/D;else break;T=D}return u},u}function xh(){var u=Gv();return u.copy=function(){return _y(u,xh())},Mh.apply(u,arguments),Sy(u)}function jd(u){return function(h){return h<0?-Math.pow(-h,u):Math.pow(h,u)}}function i0(u){return u<0?-Math.sqrt(-u):Math.sqrt(u)}function n0(u){return u<0?-u*u:u*u}function a0(u){var h=u(so,so),d=1;function p(){return d===1?u(so,so):d===.5?u(i0,n0):u(jd(d),jd(1/d))}return h.exponent=function(y){return arguments.length?(d=+y,p()):d},Sy(h)}function ky(){var u=a0(vy());return u.copy=function(){return _y(u,ky()).exponent(u.exponent())},Mh.apply(u,arguments),u}function o0(){return ky.apply(null,arguments).exponent(.5)}const Du={x:xh,y:xh,z:xh,r:o0};function s0(u){return u.constant?"symlog":u.base?"log":u.exponent?u.exponent()===.5?"sqrt":"pow":"other"}function Gd(u){return u}function l0(u){return h=>Math.log(u*h)}function u0(u){return h=>u*Math.exp(h)}function c0(u){return h=>Math.sign(h)*Math.log1p(Math.abs(h/u))}function h0(u){return h=>Math.sign(h)*Math.expm1(Math.abs(h))*u}function ch(u){return function(d){return d<0?-Math.pow(-d,u):Math.pow(d,u)}}function p0(u){const h=s0(u);if(h==="log"){const d=Math.sign(u.domain()[0]);return{lift:l0(d),ground:u0(d),scaleType:h}}return h==="pow"?{lift:ch(1),ground:ch(1/1),scaleType:h}:h==="sqrt"?{lift:ch(.5),ground:ch(1/.5),scaleType:h}:h==="symlog"?{lift:c0(1),ground:h0(1),scaleType:h}:{lift:Gd,ground:Gd,scaleType:h}}function f0(u,h){if(typeof u.range!="function")throw new Error("Scale method `range` must be a function");if(typeof u.domain!="function")throw new Error("Scale method `domain` must be a function");if(!Array.isArray(h))return u.domain();u.domain().length!==2&&console.warn("[LayerCake] The scale is expected to have a domain of length 2 to use padding. Are you sure you want to use padding? Your scale's domain is:",u.domain()),u.range().length!==2&&console.warn("[LayerCake] The scale is expected to have a range of length 2 to use padding. Are you sure you want to use padding? Your scale's range is:",u.range());const{lift:d,ground:p}=p0(u),y=u.domain()[0],_=Object.prototype.toString.call(y)==="[object Date]",[a,I]=u.domain().map(X=>d(_?X.getTime():X)),[T,D]=u.range(),F=h[0]||0,M=h[1]||0,L=(I-a)/(Math.abs(D-T)-F-M);return[a-F*L,M*L+I].map(X=>p(_?new Date(X):X))}function d0(u,h,d,p,y){let _,a;return y===!0?(_=0,a=100):(_=u==="r"?1:0,a=u==="y"?d:u==="r"?25:h),p===!0?[a,_]:[_,a]}function m0(u,h,d,p,y,_){return y?typeof y=="function"?y({width:h,height:d}):y:d0(u,h,d,p,_)}function hh(u){return function([d,p,y,_,a,I,T,D,F,M]){if(p===null)return null;const L=m0(u,T,D,I,F,M),X=d===Du[u]?d():d.copy();return X.domain(cy(p[u],y)).range(L),_&&X.domain(f0(X,_)),a===!0&&(typeof X.nice=="function"?X.nice():console.error(`[Layer Cake] You set \`${u}Nice: true\` but the ${u}Scale does not have a \`.nice\` method. Ignoring...`)),X}}function ph([u,h]){return d=>{const p=u(d);return Array.isArray(p)?p.map(y=>h(y)):h(p)}}function fh([u]){if(typeof u=="function"){if(typeof u.range=="function")return u.range();console.error("[LayerCake] Your scale doesn't have a `.range` method?")}return null}const dh={x:!1,y:!0,z:!1,r:!1};const y0=u=>({element:u[0]&4,width:u[0]&256,height:u[0]&512,aspectRatio:u[0]&1024,containerWidth:u[0]&128,containerHeight:u[0]&64}),Zd=u=>({element:u[2],width:u[8],height:u[9],aspectRatio:u[10],containerWidth:u[7],containerHeight:u[6]});function Kd(u){let h,d,p;const y=u[90].default,_=Ru(y,u,u[89],Zd);return{c(){h=je("div"),_&&_.c(),this.h()},l(a){h=Ge(a,"DIV",{class:!0});var I=Ve(h);_&&_.l(I),I.forEach(ae),this.h()},h(){ne(h,"class","layercake-container svelte-vhzpsp"),ju(()=>u[92].call(h)),Je(h,"position",u[5]),Je(h,"top",u[5]==="absolute"?"0":null),Je(h,"right",u[5]==="absolute"?"0":null),Je(h,"bottom",u[5]==="absolute"?"0":null),Je(h,"left",u[5]==="absolute"?"0":null),Je(h,"pointer-events",u[4]===!1?"none":null)},m(a,I){Be(a,h,I),_&&_.m(h,null),u[91](h),d=Gu(h,u[92].bind(h)),p=!0},p(a,I){_&&_.p&&(!p||I[0]&1988|I[2]&134217728)&&Bu(_,y,a,a[89],p?Fu(y,a[89],I,y0):Ou(a[89]),Zd),I[0]&32&&Je(h,"position",a[5]),I[0]&32&&Je(h,"top",a[5]==="absolute"?"0":null),I[0]&32&&Je(h,"right",a[5]==="absolute"?"0":null),I[0]&32&&Je(h,"bottom",a[5]==="absolute"?"0":null),I[0]&32&&Je(h,"left",a[5]==="absolute"?"0":null),I[0]&16&&Je(h,"pointer-events",a[4]===!1?"none":null)},i(a){p||(tt(_,a),p=!0)},o(a){ut(_,a),p=!1},d(a){a&&ae(h),_&&_.d(a),u[91](null),d()}}}function g0(u){let h,d,p=(u[3]===!0||typeof window<"u")&&Kd(u);return{c(){p&&p.c(),h=ur()},l(y){p&&p.l(y),h=ur()},m(y,_){p&&p.m(y,_),Be(y,h,_),d=!0},p(y,_){y[3]===!0||typeof window<"u"?p?(p.p(y,_),_[0]&8&&tt(p,1)):(p=Kd(y),p.c(),tt(p,1),p.m(h.parentNode,h)):p&&(En(),ut(p,1,1,()=>{p=null}),Tn())},i(y){d||(tt(p),d=!0)},o(y){ut(p),d=!1},d(y){p&&p.d(y),y&&ae(h)}}}function _0(u,h,d){let p,y,_,a,I,T,D,F,M,L,X,oe,se,pe,xe,be,ct,We,De,Ze,Dt,zt,Ue,Ke,vt,cr,Ne,Rt,Me,$e,mt,qt,Bt,St,Oe,ot,Dr,Kr,vi,xr,er,{$$slots:Hr={},$$scope:Jt}=h,{ssr:ai=!1}=h,{pointerEvents:qi=!0}=h,{position:en="relative"}=h,{percentRange:Kt=!1}=h,{width:ji=void 0}=h,{height:fi=void 0}=h,{containerWidth:$r=ji||100}=h,{containerHeight:Xn=fi||100}=h,{element:Ei=void 0}=h,{x:Lr=void 0}=h,{y:Ur=void 0}=h,{z:tn=void 0}=h,{r:bi=void 0}=h,{data:di=[]}=h,{xDomain:qr=void 0}=h,{yDomain:rn=void 0}=h,{zDomain:Xr=void 0}=h,{rDomain:In=void 0}=h,{xNice:nn=!1}=h,{yNice:Dn=!1}=h,{zNice:Gi=!1}=h,{rNice:Bi=!1}=h,{xReverse:ei=dh.x}=h,{yReverse:Ln=dh.y}=h,{zReverse:An=dh.z}=h,{rReverse:oi=dh.r}=h,{xPadding:ta=void 0}=h,{yPadding:Wn=void 0}=h,{zPadding:ti=void 0}=h,{rPadding:ra=void 0}=h,{xScale:un=Du.x}=h,{yScale:ri=Du.y}=h,{zScale:re=Du.z}=h,{rScale:yt=Du.r}=h,{xRange:Ti=void 0}=h,{yRange:pr=void 0}=h,{zRange:R=void 0}=h,{rRange:N=void 0}=h,{padding:q={}}=h,{extents:K={}}=h,{flatData:W=void 0}=h,{custom:ue={}}=h,fe=!1;ny(()=>{fe=!0});const U={},Q=Ir(Kt);Zt(u,Q,ye=>d(128,Kr=ye));const ge=Ir($r);Zt(u,ge,ye=>d(7,Dr=ye));const Ce=Ir(Xn);Zt(u,Ce,ye=>d(6,ot=ye));const Le=Ir(Ap(K));Zt(u,Le,ye=>d(127,Oe=ye));const Ee=Ir(di);Zt(u,Ee,ye=>d(126,St=ye));const Re=Ir(W||di);Zt(u,Re,ye=>d(125,Bt=ye));const ht=Ir(q);Zt(u,ht,ye=>d(124,qt=ye));const at=Ir(es(Lr));Zt(u,at,ye=>d(123,mt=ye));const Te=Ir(es(Ur));Zt(u,Te,ye=>d(122,$e=ye));const He=Ir(es(tn));Zt(u,He,ye=>d(121,Me=ye));const Qe=Ir(es(bi));Zt(u,Qe,ye=>d(120,Rt=ye));const rt=Ir(qr);Zt(u,rt,ye=>d(119,Ne=ye));const jt=Ir(rn);Zt(u,jt,ye=>d(118,cr=ye));const nt=Ir(Xr);Zt(u,nt,ye=>d(117,vt=ye));const tr=Ir(In);Zt(u,tr,ye=>d(116,Ke=ye));const wr=Ir(nn);Zt(u,wr,ye=>d(115,Ue=ye));const Ht=Ir(Dn);Zt(u,Ht,ye=>d(114,zt=ye));const fr=Ir(Gi);Zt(u,fr,ye=>d(113,Dt=ye));const rr=Ir(Bi);Zt(u,rr,ye=>d(112,Ze=ye));const xi=Ir(ei);Zt(u,xi,ye=>d(111,De=ye));const yr=Ir(Ln);Zt(u,yr,ye=>d(110,We=ye));const Or=Ir(An);Zt(u,Or,ye=>d(109,ct=ye));const br=Ir(oi);Zt(u,br,ye=>d(108,be=ye));const Qt=Ir(ta);Zt(u,Qt,ye=>d(107,xe=ye));const dr=Ir(Wn);Zt(u,dr,ye=>d(106,pe=ye));const Ii=Ir(ti);Zt(u,Ii,ye=>d(105,se=ye));const pa=Ir(ra);Zt(u,pa,ye=>d(104,oe=ye));const si=Ir(Ti);Zt(u,si,ye=>d(103,X=ye));const Oi=Ir(pr);Zt(u,Oi,ye=>d(102,L=ye));const Na=Ir(R);Zt(u,Na,ye=>d(101,M=ye));const va=Ir(N);Zt(u,va,ye=>d(100,F=ye));const jr=Ir(un);Zt(u,jr,ye=>d(99,D=ye));const ba=Ir(ri);Zt(u,ba,ye=>d(98,T=ye));const Ai=Ir(re);Zt(u,Ai,ye=>d(97,I=ye));const li=Ir(yt);Zt(u,li,ye=>d(96,a=ye));const cn=Ir(U);Zt(u,cn,ye=>d(94,y=ye));const Pr=Ir(ue);Zt(u,Pr,ye=>d(95,_=ye));const Rn=Ri([at,Te,He,Qe],([ye,hn,Hi,Gr])=>{const ka={};return ye&&(ka.x=ye),hn&&(ka.y=hn),Hi&&(ka.z=Hi),Gr&&(ka.r=Gr),ka}),_n=Ri([ht,ge,Ce],([ye])=>Object.assign({top:0,right:0,bottom:0,left:0},ye)),is=Ri([ge,Ce,_n],([ye,hn,Hi])=>{const Gr={};return Gr.top=Hi.top,Gr.right=ye-Hi.right,Gr.bottom=hn-Hi.bottom,Gr.left=Hi.left,Gr.width=Gr.right-Gr.left,Gr.height=Gr.bottom-Gr.top,Gr.width<=0&&fe===!0&&console.warn("[LayerCake] Target div has zero or negative width. Did you forget to set an explicit width in CSS on the container?"),Gr.height<=0&&fe===!0&&console.warn("[LayerCake] Target div has zero or negative height. Did you forget to set an explicit height in CSS on the container?"),Gr}),zi=Ri([is],([ye])=>ye.width);Zt(u,zi,ye=>d(8,vi=ye));const xa=Ri([is],([ye])=>ye.height);Zt(u,xa,ye=>d(9,xr=ye));const Zi=Ri([Re,Rn,Le],([ye,hn,Hi])=>{const Gr=Ap(hn,Hi);return Object.keys(Gr).length>0?{...rv(ye,Gr),...Hi}:{}}),Pi=Ri([Zi,rt],oh("x")),Yn=Ri([Zi,jt],oh("y")),Ki=Ri([Zi,nt],oh("z")),wa=Ri([Zi,tr],oh("r")),ns=Ri([jr,Zi,Pi,Qt,wr,xi,zi,xa,si,Q],hh("x")),Bl=Ri([at,ns],ph),uo=Ri([ba,Zi,Yn,dr,Ht,yr,zi,xa,Oi,Q],hh("y")),Ol=Ri([Te,uo],ph),Ro=Ri([Ai,Zi,Ki,Ii,fr,Or,zi,xa,Na,Q],hh("z")),Fl=Ri([He,Ro],ph),Bo=Ri([li,Zi,wa,pa,rr,br,zi,xa,va,Q],hh("r")),Bs=Ri([Qe,Bo],ph),Va=Ri([ns],fh),as=Ri([uo],fh),co=Ri([Ro],fh),Os=Ri([Bo],fh),Ua=Ri([zi,xa],([ye,hn])=>ye/hn);Zt(u,Ua,ye=>d(10,er=ye));function Bn(ye){Nu[ye?"unshift":"push"](()=>{Ei=ye,d(2,Ei)})}function Sa(){$r=this.clientWidth,Xn=this.clientHeight,d(0,$r),d(1,Xn)}return u.$$set=ye=>{"ssr"in ye&&d(3,ai=ye.ssr),"pointerEvents"in ye&&d(4,qi=ye.pointerEvents),"position"in ye&&d(5,en=ye.position),"percentRange"in ye&&d(51,Kt=ye.percentRange),"width"in ye&&d(52,ji=ye.width),"height"in ye&&d(53,fi=ye.height),"containerWidth"in ye&&d(0,$r=ye.containerWidth),"containerHeight"in ye&&d(1,Xn=ye.containerHeight),"element"in ye&&d(2,Ei=ye.element),"x"in ye&&d(54,Lr=ye.x),"y"in ye&&d(55,Ur=ye.y),"z"in ye&&d(56,tn=ye.z),"r"in ye&&d(57,bi=ye.r),"data"in ye&&d(58,di=ye.data),"xDomain"in ye&&d(59,qr=ye.xDomain),"yDomain"in ye&&d(60,rn=ye.yDomain),"zDomain"in ye&&d(61,Xr=ye.zDomain),"rDomain"in ye&&d(62,In=ye.rDomain),"xNice"in ye&&d(63,nn=ye.xNice),"yNice"in ye&&d(64,Dn=ye.yNice),"zNice"in ye&&d(65,Gi=ye.zNice),"rNice"in ye&&d(66,Bi=ye.rNice),"xReverse"in ye&&d(67,ei=ye.xReverse),"yReverse"in ye&&d(68,Ln=ye.yReverse),"zReverse"in ye&&d(69,An=ye.zReverse),"rReverse"in ye&&d(70,oi=ye.rReverse),"xPadding"in ye&&d(71,ta=ye.xPadding),"yPadding"in ye&&d(72,Wn=ye.yPadding),"zPadding"in ye&&d(73,ti=ye.zPadding),"rPadding"in ye&&d(74,ra=ye.rPadding),"xScale"in ye&&d(75,un=ye.xScale),"yScale"in ye&&d(76,ri=ye.yScale),"zScale"in ye&&d(77,re=ye.zScale),"rScale"in ye&&d(78,yt=ye.rScale),"xRange"in ye&&d(79,Ti=ye.xRange),"yRange"in ye&&d(80,pr=ye.yRange),"zRange"in ye&&d(81,R=ye.zRange),"rRange"in ye&&d(82,N=ye.rRange),"padding"in ye&&d(83,q=ye.padding),"extents"in ye&&d(84,K=ye.extents),"flatData"in ye&&d(85,W=ye.flatData),"custom"in ye&&d(86,ue=ye.custom),"$$scope"in ye&&d(89,Jt=ye.$$scope)},u.$$.update=()=>{u.$$.dirty[1]&8388608&&Lr&&d(87,U.x=Lr,U),u.$$.dirty[1]&16777216&&Ur&&d(87,U.y=Ur,U),u.$$.dirty[1]&33554432&&tn&&d(87,U.z=tn,U),u.$$.dirty[1]&67108864&&bi&&d(87,U.r=bi,U),u.$$.dirty[1]&268435456&&qr&&d(87,U.xDomain=qr,U),u.$$.dirty[1]&536870912&&rn&&d(87,U.yDomain=rn,U),u.$$.dirty[1]&1073741824&&Xr&&d(87,U.zDomain=Xr,U),u.$$.dirty[2]&1&&In&&d(87,U.rDomain=In,U),u.$$.dirty[2]&131072&&Ti&&d(87,U.xRange=Ti,U),u.$$.dirty[2]&262144&&pr&&d(87,U.yRange=pr,U),u.$$.dirty[2]&524288&&R&&d(87,U.zRange=R,U),u.$$.dirty[2]&1048576&&N&&d(87,U.rRange=N,U),u.$$.dirty[1]&1048576&&Tr(Q,Kr=Kt,Kr),u.$$.dirty[0]&1&&Tr(ge,Dr=$r,Dr),u.$$.dirty[0]&2&&Tr(Ce,ot=Xn,ot),u.$$.dirty[2]&4194304&&Tr(Le,Oe=Ap(K),Oe),u.$$.dirty[1]&134217728&&Tr(Ee,St=di,St),u.$$.dirty[1]&134217728|u.$$.dirty[2]&8388608&&Tr(Re,Bt=W||di,Bt),u.$$.dirty[2]&2097152&&Tr(ht,qt=q,qt),u.$$.dirty[1]&8388608&&Tr(at,mt=es(Lr),mt),u.$$.dirty[1]&16777216&&Tr(Te,$e=es(Ur),$e),u.$$.dirty[1]&33554432&&Tr(He,Me=es(tn),Me),u.$$.dirty[1]&67108864&&Tr(Qe,Rt=es(bi),Rt),u.$$.dirty[1]&268435456&&Tr(rt,Ne=qr,Ne),u.$$.dirty[1]&536870912&&Tr(jt,cr=rn,cr),u.$$.dirty[1]&1073741824&&Tr(nt,vt=Xr,vt),u.$$.dirty[2]&1&&Tr(tr,Ke=In,Ke),u.$$.dirty[2]&2&&Tr(wr,Ue=nn,Ue),u.$$.dirty[2]&4&&Tr(Ht,zt=Dn,zt),u.$$.dirty[2]&8&&Tr(fr,Dt=Gi,Dt),u.$$.dirty[2]&16&&Tr(rr,Ze=Bi,Ze),u.$$.dirty[2]&32&&Tr(xi,De=ei,De),u.$$.dirty[2]&64&&Tr(yr,We=Ln,We),u.$$.dirty[2]&128&&Tr(Or,ct=An,ct),u.$$.dirty[2]&256&&Tr(br,be=oi,be),u.$$.dirty[2]&512&&Tr(Qt,xe=ta,xe),u.$$.dirty[2]&1024&&Tr(dr,pe=Wn,pe),u.$$.dirty[2]&2048&&Tr(Ii,se=ti,se),u.$$.dirty[2]&4096&&Tr(pa,oe=ra,oe),u.$$.dirty[2]&131072&&Tr(si,X=Ti,X),u.$$.dirty[2]&262144&&Tr(Oi,L=pr,L),u.$$.dirty[2]&524288&&Tr(Na,M=R,M),u.$$.dirty[2]&1048576&&Tr(va,F=N,F),u.$$.dirty[2]&8192&&Tr(jr,D=un,D),u.$$.dirty[2]&16384&&Tr(ba,T=ri,T),u.$$.dirty[2]&32768&&Tr(Ai,I=re,I),u.$$.dirty[2]&65536&&Tr(li,a=yt,a),u.$$.dirty[2]&16777216&&Tr(Pr,_=ue,_),u.$$.dirty[2]&33554432&&Tr(cn,y=U,y),u.$$.dirty[2]&67108864&&iy("LayerCake",p)},d(88,p={activeGetters:Rn,width:zi,height:xa,percentRange:Q,aspectRatio:Ua,containerWidth:ge,containerHeight:Ce,x:at,y:Te,z:He,r:Qe,custom:Pr,data:Ee,xNice:wr,yNice:Ht,zNice:fr,rNice:rr,xReverse:xi,yReverse:yr,zReverse:Or,rReverse:br,xPadding:Qt,yPadding:dr,zPadding:Ii,rPadding:pa,padding:_n,flatData:Re,extents:Zi,xDomain:Pi,yDomain:Yn,zDomain:Ki,rDomain:wa,xRange:Va,yRange:as,zRange:co,rRange:Os,config:cn,xScale:ns,xGet:Bl,yScale:uo,yGet:Ol,zScale:Ro,zGet:Fl,rScale:Bo,rGet:Bs}),[$r,Xn,Ei,ai,qi,en,ot,Dr,vi,xr,er,Q,ge,Ce,Le,Ee,Re,ht,at,Te,He,Qe,rt,jt,nt,tr,wr,Ht,fr,rr,xi,yr,Or,br,Qt,dr,Ii,pa,si,Oi,Na,va,jr,ba,Ai,li,cn,Pr,zi,xa,Ua,Kt,ji,fi,Lr,Ur,tn,bi,di,qr,rn,Xr,In,nn,Dn,Gi,Bi,ei,Ln,An,oi,ta,Wn,ti,ra,un,ri,re,yt,Ti,pr,R,N,q,K,W,ue,U,p,Jt,Hr,Bn,Sa]}class v0 extends mn{constructor(h){super(),yn(this,h,_0,g0,gn,{ssr:3,pointerEvents:4,position:5,percentRange:51,width:52,height:53,containerWidth:0,containerHeight:1,element:2,x:54,y:55,z:56,r:57,data:58,xDomain:59,yDomain:60,zDomain:61,rDomain:62,xNice:63,yNice:64,zNice:65,rNice:66,xReverse:67,yReverse:68,zReverse:69,rReverse:70,xPadding:71,yPadding:72,zPadding:73,rPadding:74,xScale:75,yScale:76,zScale:77,rScale:78,xRange:79,yRange:80,zRange:81,rRange:82,padding:83,extents:84,flatData:85,custom:86},null,[-1,-1,-1,-1,-1])}}const b0=u=>({element:u&1}),Hd=u=>({element:u[0]}),x0=u=>({element:u&1}),Xd=u=>({element:u[0]});function w0(u){let h,d,p,y,_;const a=u[12].defs,I=Ru(a,u,u[11],Xd),T=u[12].default,D=Ru(T,u,u[11],Hd);return{c(){h=Kn("svg"),d=Kn("defs"),I&&I.c(),p=Kn("g"),D&&D.c(),this.h()},l(F){h=Hn(F,"svg",{class:!0,viewBox:!0,width:!0,height:!0});var M=Ve(h);d=Hn(M,"defs",{});var L=Ve(d);I&&I.l(L),L.forEach(ae),p=Hn(M,"g",{class:!0,transform:!0});var X=Ve(p);D&&D.l(X),X.forEach(ae),M.forEach(ae),this.h()},h(){ne(p,"class","layercake-layout-svg_g"),ne(p,"transform",y="translate("+u[7].left+", "+u[7].top+")"),ne(h,"class","layercake-layout-svg svelte-u84d8d"),ne(h,"viewBox",u[4]),ne(h,"width",u[5]),ne(h,"height",u[6]),Je(h,"z-index",u[2]),Je(h,"pointer-events",u[3]===!1?"none":null)},m(F,M){Be(F,h,M),Ae(h,d),I&&I.m(d,null),Ae(h,p),D&&D.m(p,null),u[13](p),u[14](h),_=!0},p(F,[M]){I&&I.p&&(!_||M&2049)&&Bu(I,a,F,F[11],_?Fu(a,F[11],M,x0):Ou(F[11]),Xd),D&&D.p&&(!_||M&2049)&&Bu(D,T,F,F[11],_?Fu(T,F[11],M,b0):Ou(F[11]),Hd),(!_||M&128&&y!==(y="translate("+F[7].left+", "+F[7].top+")"))&&ne(p,"transform",y),(!_||M&16)&&ne(h,"viewBox",F[4]),(!_||M&32)&&ne(h,"width",F[5]),(!_||M&64)&&ne(h,"height",F[6]),M&4&&Je(h,"z-index",F[2]),M&8&&Je(h,"pointer-events",F[3]===!1?"none":null)},i(F){_||(tt(I,F),tt(D,F),_=!0)},o(F){ut(I,F),ut(D,F),_=!1},d(F){F&&ae(h),I&&I.d(F),D&&D.d(F),u[13](null),u[14](null)}}}function S0(u,h,d){let p,y,_,{$$slots:a={},$$scope:I}=h,{element:T=void 0}=h,{innerElement:D=void 0}=h,{zIndex:F=void 0}=h,{pointerEvents:M=void 0}=h,{viewBox:L=void 0}=h;const{containerWidth:X,containerHeight:oe,padding:se}=Zu("LayerCake");Zt(u,X,be=>d(5,p=be)),Zt(u,oe,be=>d(6,y=be)),Zt(u,se,be=>d(7,_=be));function pe(be){Nu[be?"unshift":"push"](()=>{D=be,d(1,D)})}function xe(be){Nu[be?"unshift":"push"](()=>{T=be,d(0,T)})}return u.$$set=be=>{"element"in be&&d(0,T=be.element),"innerElement"in be&&d(1,D=be.innerElement),"zIndex"in be&&d(2,F=be.zIndex),"pointerEvents"in be&&d(3,M=be.pointerEvents),"viewBox"in be&&d(4,L=be.viewBox),"$$scope"in be&&d(11,I=be.$$scope)},[T,D,F,M,L,p,y,_,X,oe,se,I,a,pe,xe]}class k0 extends mn{constructor(h){super(),yn(this,h,S0,w0,gn,{element:0,innerElement:1,zIndex:2,pointerEvents:3,viewBox:4})}}function Wd(u,h,d){const p=u.slice();return p[23]=h[d],p[25]=d,p}function Yd(u){let h,d,p,y;return{c(){h=Kn("rect"),this.h()},l(_){h=Hn(_,"rect",{class:!0,"data-id":!0,x:!0,y:!0,width:!0,height:!0,fill:!0,stroke:!0,"stroke-width":!0}),Ve(h).forEach(ae),this.h()},h(){ne(h,"class","group-rect"),ne(h,"data-id",u[25]),ne(h,"x",d=u[11].bandwidth?u[7](u[23]):u[7](u[23])[0]),ne(h,"y",p=u[13](u[12](u[23]))-1),ne(h,"width",y=u[11].bandwidth?u[11].bandwidth():u[9](u[23])),ne(h,"height","3"),ne(h,"fill","#308182"),ne(h,"stroke",u[0]),ne(h,"stroke-width",u[1])},m(_,a){Be(_,h,a)},p(_,a){a&3200&&d!==(d=_[11].bandwidth?_[7](_[23]):_[7](_[23])[0])&&ne(h,"x",d),a&13312&&p!==(p=_[13](_[12](_[23]))-1)&&ne(h,"y",p),a&3584&&y!==(y=_[11].bandwidth?_[11].bandwidth():_[9](_[23]))&&ne(h,"width",y),a&1&&ne(h,"stroke",_[0]),a&2&&ne(h,"stroke-width",_[1])},d(_){_&&ae(h)}}}function Jd(u){let h,d,p,y,_,a,I,T,D=u[12]&&Yd(u);return{c(){h=Kn("rect"),D&&D.c(),a=Kn("text"),this.h()},l(F){h=Hn(F,"rect",{class:!0,"data-id":!0,x:!0,y:!0,width:!0,height:!0,fill:!0,stroke:!0,"stroke-width":!0}),Ve(h).forEach(ae),D&&D.l(F),a=Hn(F,"text",{x:!0,y:!0,dx:!0,dy:!0,"text-anchor":!0}),Ve(a).forEach(ae),this.h()},h(){ne(h,"class","group-rect"),ne(h,"data-id",u[25]),ne(h,"x",d=u[11].bandwidth?u[7](u[23]):u[7](u[23])[0]),ne(h,"y",p=u[6](u[23])),ne(h,"width",y=u[11].bandwidth?u[11].bandwidth():u[9](u[23])),ne(h,"height",_=u[8](u[23])),ne(h,"fill",u[4]),ne(h,"stroke",u[0]),ne(h,"stroke-width",u[1]),ne(a,"x",I=u[11].bandwidth?u[7](u[23])+u[11].bandwidth()/2:u[7](u[23])[0]),ne(a,"y",T=u[6](u[23])-4),ne(a,"dx",u[2]),ne(a,"dy",u[3]),ne(a,"text-anchor",u[5])},m(F,M){Be(F,h,M),D&&D.m(F,M),Be(F,a,M)},p(F,M){M&3200&&d!==(d=F[11].bandwidth?F[7](F[23]):F[7](F[23])[0])&&ne(h,"x",d),M&1088&&p!==(p=F[6](F[23]))&&ne(h,"y",p),M&3584&&y!==(y=F[11].bandwidth?F[11].bandwidth():F[9](F[23]))&&ne(h,"width",y),M&1280&&_!==(_=F[8](F[23]))&&ne(h,"height",_),M&16&&ne(h,"fill",F[4]),M&1&&ne(h,"stroke",F[0]),M&2&&ne(h,"stroke-width",F[1]),F[12]?D?D.p(F,M):(D=Yd(F),D.c(),D.m(a.parentNode,a)):D&&(D.d(1),D=null),M&3200&&I!==(I=F[11].bandwidth?F[7](F[23])+F[11].bandwidth()/2:F[7](F[23])[0])&&ne(a,"x",I),M&1088&&T!==(T=F[6](F[23])-4)&&ne(a,"y",T),M&4&&ne(a,"dx",F[2]),M&8&&ne(a,"dy",F[3]),M&32&&ne(a,"text-anchor",F[5])},d(F){F&&ae(h),D&&D.d(F),F&&ae(a)}}}function E0(u){let h,d=u[10],p=[];for(let y=0;y<d.length;y+=1)p[y]=Jd(Wd(u,d,y));return{c(){h=Kn("g");for(let y=0;y<p.length;y+=1)p[y].c();this.h()},l(y){h=Hn(y,"g",{class:!0});var _=Ve(h);for(let a=0;a<p.length;a+=1)p[a].l(_);_.forEach(ae),this.h()},h(){ne(h,"class","column-group svelte-wgzwsk")},m(y,_){Be(y,h,_);for(let a=0;a<p.length;a+=1)p[a]&&p[a].m(h,null)},p(y,[_]){if(_&16383){d=y[10];let a;for(a=0;a<d.length;a+=1){const I=Wd(y,d,a);p[a]?p[a].p(I,_):(p[a]=Jd(I),p[a].c(),p[a].m(h,null))}for(;a<p.length;a+=1)p[a].d(1);p.length=d.length}},i:pi,o:pi,d(y){y&&ae(h),ln(p,y)}}}function T0(u,h,d){let p,y,_,a,I,T,D,F,M;const{data:L,xGet:X,yGet:oe,yRange:se,xScale:pe,yScale:xe,y:be,z:ct}=Zu("LayerCake");Zt(u,L,Ke=>d(10,T=Ke)),Zt(u,X,Ke=>d(7,I=Ke)),Zt(u,oe,Ke=>d(6,_=Ke)),Zt(u,se,Ke=>d(21,a=Ke)),Zt(u,pe,Ke=>d(11,D=Ke)),Zt(u,xe,Ke=>d(13,M=Ke)),Zt(u,ct,Ke=>d(12,F=Ke));let{stroke:We=""}=h,{strokeWidth:De=0}=h,{dxTick:Ze=0}=h,{dyTick:Dt=0}=h,{fill:zt="#00205b"}=h,{textAnchor:Ue="middle"}=h;return u.$$set=Ke=>{"stroke"in Ke&&d(0,We=Ke.stroke),"strokeWidth"in Ke&&d(1,De=Ke.strokeWidth),"dxTick"in Ke&&d(2,Ze=Ke.dxTick),"dyTick"in Ke&&d(3,Dt=Ke.dyTick),"fill"in Ke&&d(4,zt=Ke.fill),"textAnchor"in Ke&&d(5,Ue=Ke.textAnchor)},u.$$.update=()=>{u.$$.dirty&128&&d(9,p=Ke=>{const vt=I(Ke);return Math.max(0,vt[1]-vt[0])}),u.$$.dirty&2097216&&d(8,y=Ke=>a[0]-_(Ke))},[We,De,Ze,Dt,zt,Ue,_,I,y,p,T,D,F,M,L,X,oe,se,pe,xe,ct,a]}class I0 extends mn{constructor(h){super(),yn(this,h,T0,E0,gn,{stroke:0,strokeWidth:1,dxTick:2,dyTick:3,fill:4,textAnchor:5})}}function Qd(u,h,d){const p=u.slice();return p[28]=h[d],p[30]=d,p}function $d(u){let h,d,p,y;return{c(){h=Kn("line"),this.h()},l(_){h=Hn(_,"line",{y1:!0,y2:!0,x1:!0,x2:!0,stroke:!0,"stroke-width":!0,class:!0}),Ve(h).forEach(ae),this.h()},h(){ne(h,"y1",d=u[20]*-1),ne(h,"y2",p=u[14]&&u[30]%2==0?u[10]+u[8]+2:u[10]+u[8]-13),ne(h,"x1","0"),ne(h,"x2","0"),ne(h,"stroke",u[11]),ne(h,"stroke-width",y=u[15]&&Array.isArray(u[4])&&u[30]==Math.floor(u[4].length/2)?2:1),ne(h,"class","svelte-fwjh80"),rs(h,"baseline",u[13])},m(_,a){Be(_,h,a)},p(_,a){a&1048576&&d!==(d=_[20]*-1)&&ne(h,"y1",d),a&17664&&p!==(p=_[14]&&_[30]%2==0?_[10]+_[8]+2:_[10]+_[8]-13)&&ne(h,"y2",p),a&2048&&ne(h,"stroke",_[11]),a&32784&&y!==(y=_[15]&&Array.isArray(_[4])&&_[30]==Math.floor(_[4].length/2)?2:1)&&ne(h,"stroke-width",y),a&8192&&rs(h,"baseline",_[13])},d(_){_&&ae(h)}}}function A0(u){let h=u[1](u[28])+"",d;return{c(){d=Vt(h)},l(p){d=Ut(p,h)},m(p,y){Be(p,d,y)},p(p,y){y&262146&&h!==(h=p[1](p[28])+"")&&Mr(d,h)},d(p){p&&ae(d)}}}function z0(u){let h,d=u[1](u[28])+"",p,y;return{c(){h=Vt(u[5]),p=Vt(d),y=Vt(u[6])},l(_){h=Ut(_,u[5]),p=Ut(_,d),y=Ut(_,u[6])},m(_,a){Be(_,h,a),Be(_,p,a),Be(_,y,a)},p(_,a){a&32&&Mr(h,_[5]),a&262146&&d!==(d=_[1](_[28])+"")&&Mr(p,d),a&64&&Mr(y,_[6])},d(_){_&&ae(h),_&&ae(p),_&&ae(y)}}}function em(u){let h,d,p,y,_,a,I,T=u[0]!==!1&&$d(u);function D(L,X){return L[30]==L[18].length-1?z0:A0}let F=D(u),M=F(u);return{c(){h=Kn("g"),T&&T.c(),d=Kn("text"),M.c(),this.h()},l(L){h=Hn(L,"g",{class:!0,transform:!0});var X=Ve(h);T&&T.l(X),d=Hn(X,"text",{x:!0,y:!0,dx:!0,dy:!0,"text-anchor":!0,fill:!0,class:!0});var oe=Ve(d);M.l(oe),oe.forEach(ae),X.forEach(ae),this.h()},h(){ne(d,"x",p=u[7]||u[16]?u[17].bandwidth()/2:0),ne(d,"y",y=u[3]?u[20]*-1-6:u[14]&&u[30]%2==0?u[8]+15:u[8]),ne(d,"dx",_=u[24](u[30])=="start"?u[9]-2:u[24](u[30])=="end"?u[9]+2:u[9]),ne(d,"dy",u[10]),ne(d,"text-anchor",u[24](u[30])),ne(d,"fill",u[12]),ne(d,"class","svelte-fwjh80"),rs(d,"bold",u[15]&&Array.isArray(u[4])&&u[30]==Math.floor(u[4].length/2)),ne(h,"class",a="tick tick-"+u[28]+" svelte-fwjh80"),ne(h,"transform",I="translate("+u[17](u[28])+","+u[19][0]+")")},m(L,X){Be(L,h,X),T&&T.m(h,null),Ae(h,d),M.m(d,null)},p(L,X){L[0]!==!1?T?T.p(L,X):(T=$d(L),T.c(),T.m(h,d)):T&&(T.d(1),T=null),F===(F=D(L))&&M?M.p(L,X):(M.d(1),M=F(L),M&&(M.c(),M.m(d,null))),X&196736&&p!==(p=L[7]||L[16]?L[17].bandwidth()/2:0)&&ne(d,"x",p),X&1065224&&y!==(y=L[3]?L[20]*-1-6:L[14]&&L[30]%2==0?L[8]+15:L[8])&&ne(d,"y",y),X&512&&_!==(_=L[24](L[30])=="start"?L[9]-2:L[24](L[30])=="end"?L[9]+2:L[9])&&ne(d,"dx",_),X&1024&&ne(d,"dy",L[10]),X&4096&&ne(d,"fill",L[12]),X&32784&&rs(d,"bold",L[15]&&Array.isArray(L[4])&&L[30]==Math.floor(L[4].length/2)),X&262144&&a!==(a="tick tick-"+L[28]+" svelte-fwjh80")&&ne(h,"class",a),X&917504&&I!==(I="translate("+L[17](L[28])+","+L[19][0]+")")&&ne(h,"transform",I)},d(L){L&&ae(h),T&&T.d(),M.d()}}}function tm(u){let h,d,p;return{c(){h=Kn("line"),this.h()},l(y){h=Hn(y,"line",{class:!0,y1:!0,y2:!0,x1:!0,x2:!0,stroke:!0}),Ve(h).forEach(ae),this.h()},h(){ne(h,"class","baseline svelte-fwjh80"),ne(h,"y1",u[20]),ne(h,"y2","0"),ne(h,"x1",d=u[17](0)),ne(h,"x2",p=u[17](0)),ne(h,"stroke",u[11])},m(y,_){Be(y,h,_)},p(y,_){_&1048576&&ne(h,"y1",y[20]),_&131072&&d!==(d=y[17](0))&&ne(h,"x1",d),_&131072&&p!==(p=y[17](0))&&ne(h,"x2",p),_&2048&&ne(h,"stroke",y[11])},d(y){y&&ae(h)}}}function P0(u){let h,d,p=u[18],y=[];for(let a=0;a<p.length;a+=1)y[a]=em(Qd(u,p,a));let _=u[2]===!0&&tm(u);return{c(){h=Kn("g");for(let a=0;a<y.length;a+=1)y[a].c();d=ur(),_&&_.c(),this.h()},l(a){h=Hn(a,"g",{class:!0});var I=Ve(h);for(let T=0;T<y.length;T+=1)y[T].l(I);d=ur(),_&&_.l(I),I.forEach(ae),this.h()},h(){ne(h,"class","axis x-axis")},m(a,I){Be(a,h,I);for(let T=0;T<y.length;T+=1)y[T]&&y[T].m(h,null);Ae(h,d),_&&_.m(h,null)},p(a,[I]){if(I&18874363){p=a[18];let T;for(T=0;T<p.length;T+=1){const D=Qd(a,p,T);y[T]?y[T].p(D,I):(y[T]=em(D),y[T].c(),y[T].m(h,d))}for(;T<y.length;T+=1)y[T].d(1);y.length=p.length}a[2]===!0?_?_.p(a,I):(_=tm(a),_.c(),_.m(h,null)):_&&(_.d(1),_=null)},i:pi,o:pi,d(a){a&&ae(h),ln(y,a),_&&_.d()}}}function C0(u,h,d){let p,y,_,a,I;const{width:T,height:D,xScale:F,yScale:M,yRange:L}=Zu("LayerCake");Zt(u,D,Me=>d(20,I=Me)),Zt(u,F,Me=>d(17,_=Me)),Zt(u,L,Me=>d(19,a=Me));let{gridlines:X=!0}=h,{formatTick:oe=Me=>Me}=h,{baseline:se=!1}=h,{flipped:pe=!1}=h,{snapTicks:xe=!1}=h,{ticks:be=void 0}=h,{prefix:ct=""}=h,{suffix:We=""}=h,{xTick:De=void 0}=h,{yTick:Ze=15}=h,{dxTick:Dt=0}=h,{dyTick:zt=0}=h,{lineColor:Ue="#999"}=h,{textColor:Ke="#555"}=h,{solid:vt=!1}=h,{stagger:cr=!1}=h,{median:Ne=!0}=h;function Rt(Me){if(xe===!0){if(Me===0)return"start";if(Me===y.length-1)return"end"}return"middle"}return u.$$set=Me=>{"gridlines"in Me&&d(0,X=Me.gridlines),"formatTick"in Me&&d(1,oe=Me.formatTick),"baseline"in Me&&d(2,se=Me.baseline),"flipped"in Me&&d(3,pe=Me.flipped),"snapTicks"in Me&&d(25,xe=Me.snapTicks),"ticks"in Me&&d(4,be=Me.ticks),"prefix"in Me&&d(5,ct=Me.prefix),"suffix"in Me&&d(6,We=Me.suffix),"xTick"in Me&&d(7,De=Me.xTick),"yTick"in Me&&d(8,Ze=Me.yTick),"dxTick"in Me&&d(9,Dt=Me.dxTick),"dyTick"in Me&&d(10,zt=Me.dyTick),"lineColor"in Me&&d(11,Ue=Me.lineColor),"textColor"in Me&&d(12,Ke=Me.textColor),"solid"in Me&&d(13,vt=Me.solid),"stagger"in Me&&d(14,cr=Me.stagger),"median"in Me&&d(15,Ne=Me.median)},u.$$.update=()=>{u.$$.dirty&131072&&d(16,p=typeof _.bandwidth=="function"),u.$$.dirty&196624&&d(18,y=Array.isArray(be)?be:p?_.domain():_.ticks(be))},[X,oe,se,pe,be,ct,We,De,Ze,Dt,zt,Ue,Ke,vt,cr,Ne,p,_,y,a,I,D,F,L,Rt,xe]}class M0 extends mn{constructor(h){super(),yn(this,h,C0,P0,gn,{gridlines:0,formatTick:1,baseline:2,flipped:3,snapTicks:25,ticks:4,prefix:5,suffix:6,xTick:7,yTick:8,dxTick:9,dyTick:10,lineColor:11,textColor:12,solid:13,stagger:14,median:15})}}function D0(u){let h,d,p,y;return h=new I0({props:{fill:u[1],formatVal:u[5]}}),p=new M0({props:{gridlines:!1}}),{c(){ir(h.$$.fragment),d=bt(),ir(p.$$.fragment)},l(_){nr(h.$$.fragment,_),d=xt(_),nr(p.$$.fragment,_)},m(_,a){ar(h,_,a),Be(_,d,a),ar(p,_,a),y=!0},p(_,a){const I={};a&2&&(I.fill=_[1]),a&32&&(I.formatVal=_[5]),h.$set(I)},i(_){y||(tt(h.$$.fragment,_),tt(p.$$.fragment,_),y=!0)},o(_){ut(h.$$.fragment,_),ut(p.$$.fragment,_),y=!1},d(_){or(h,_),_&&ae(d),or(p,_)}}}function L0(u){let h,d;return h=new k0({props:{$$slots:{default:[D0]},$$scope:{ctx:u}}}),{c(){ir(h.$$.fragment)},l(p){nr(h.$$.fragment,p)},m(p,y){ar(h,p,y),d=!0},p(p,y){const _={};y&1058&&(_.$$scope={dirty:y,ctx:p}),h.$set(_)},i(p){d||(tt(h.$$.fragment,p),d=!0)},o(p){ut(h.$$.fragment,p),d=!1},d(p){or(h,p)}}}function R0(u){let h,d,p;return d=new v0({props:{padding:{top:15,right:0,bottom:20,left:0},x:u[2],y:u[3],z:u[4],xScale:dy().paddingInner([.02]).round(!0),xDomain:u[7],yDomain:u[6],zDomain:u[6],data:u[0],$$slots:{default:[L0]},$$scope:{ctx:u}}}),{c(){h=je("div"),ir(d.$$.fragment),this.h()},l(y){h=Ge(y,"DIV",{class:!0});var _=Ve(h);nr(d.$$.fragment,_),_.forEach(ae),this.h()},h(){ne(h,"class","chart-container svelte-1i1qsul")},m(y,_){Be(y,h,_),ar(d,h,null),p=!0},p(y,[_]){const a={};_&4&&(a.x=y[2]),_&8&&(a.y=y[3]),_&16&&(a.z=y[4]),_&128&&(a.xDomain=y[7]),_&64&&(a.yDomain=y[6]),_&64&&(a.zDomain=y[6]),_&1&&(a.data=y[0]),_&1058&&(a.$$scope={dirty:_,ctx:y}),d.$set(a)},i(y){p||(tt(d.$$.fragment,y),p=!0)},o(y){ut(d.$$.fragment,y),p=!1},d(y){y&&ae(h),or(d)}}}function B0(u,h,d){let p,y,_,{data:a}=h,{suffix:I="%"}=h,{decimals:T=null}=h,{fill:D="#00205B"}=h,{xKey:F="x"}=h,{yKey:M="y"}=h,{zKey:L=null}=h;return u.$$set=X=>{"data"in X&&d(0,a=X.data),"suffix"in X&&d(8,I=X.suffix),"decimals"in X&&d(9,T=X.decimals),"fill"in X&&d(1,D=X.fill),"xKey"in X&&d(2,F=X.xKey),"yKey"in X&&d(3,M=X.yKey),"zKey"in X&&d(4,L=X.zKey)},u.$$.update=()=>{u.$$.dirty&5&&d(7,p=a.map(X=>X[F])),u.$$.dirty&9&&d(6,y=[0,Math.max(...a.map(X=>X[M]))]),u.$$.dirty&768&&d(5,_=X=>X.toFixed(T)+I)},[a,D,F,M,L,_,y,p,I,T]}class Dh extends mn{constructor(h){super(),yn(this,h,B0,R0,gn,{data:0,suffix:8,decimals:9,fill:1,xKey:2,yKey:3,zKey:4})}}function rm(u,h,d){const p=u.slice();return p[6]=h[d],p[8]=d,p}function im(u){let h,d=u[0],p=[];for(let y=0;y<d.length;y+=1)p[y]=nm(rm(u,d,y));return{c(){h=Kn("svg");for(let y=0;y<p.length;y+=1)p[y].c();this.h()},l(y){h=Hn(y,"svg",{class:!0});var _=Ve(h);for(let a=0;a<p.length;a+=1)p[a].l(_);_.forEach(ae),this.h()},h(){ne(h,"class","stack svelte-pzvhwz")},m(y,_){Be(y,h,_);for(let a=0;a<p.length;a+=1)p[a]&&p[a].m(h,null)},p(y,_){if(_&31){d=y[0];let a;for(a=0;a<d.length;a+=1){const I=rm(y,d,a);p[a]?p[a].p(I,_):(p[a]=nm(I),p[a].c(),p[a].m(h,null))}for(;a<p.length;a+=1)p[a].d(1);p.length=d.length}},d(y){y&&ae(h),ln(p,y)}}}function nm(u){let h,d;return{c(){h=Kn("rect"),this.h()},l(p){h=Hn(p,"rect",{class:!0,x:!0,style:!0}),Ve(h).forEach(ae),this.h()},h(){ne(h,"class","cell svelte-pzvhwz"),ne(h,"x",d=u[4][u[8]]/u[3]*100+"%"),Je(h,"width",u[6][u[1]]/u[3]*100+"%"),Je(h,"fill",u[2][u[8]])},m(p,y){Be(p,h,y)},p(p,y){y&24&&d!==(d=p[4][p[8]]/p[3]*100+"%")&&ne(h,"x",d),y&11&&Je(h,"width",p[6][p[1]]/p[3]*100+"%"),y&4&&Je(h,"fill",p[2][p[8]])},d(p){p&&ae(h)}}}function O0(u){let h,d=u[3]&&u[4]&&im(u);return{c(){d&&d.c(),h=ur()},l(p){d&&d.l(p),h=ur()},m(p,y){d&&d.m(p,y),Be(p,h,y)},p(p,[y]){p[3]&&p[4]?d?d.p(p,y):(d=im(p),d.c(),d.m(h.parentNode,h)):d&&(d.d(1),d=null)},i:pi,o:pi,d(p){d&&d.d(p),p&&ae(h)}}}function F0(u,h,d){let{data:p}=h,{yKey:y="y"}=h,{colors:_=["#00205B","#308182","#002417","#BD00BD","lightgrey"]}=h,a,I;function T(){d(3,a=p.map(F=>F[y]).reduce((F,M)=>F+M,0));let D=[0];p.forEach(F=>D.push(D[D.length-1]+F[y])),d(4,I=D)}return u.$$set=D=>{"data"in D&&d(0,p=D.data),"yKey"in D&&d(1,y=D.yKey),"colors"in D&&d(2,_=D.colors)},u.$$.update=()=>{u.$$.dirty&3&&(p||y)&&T()},[p,y,_,a,I]}class Xp extends mn{constructor(h){super(),yn(this,h,F0,O0,gn,{data:0,yKey:1,colors:2})}}function am(u,h,d){const p=u.slice();return p[10]=h[d],p[12]=d,p}function N0(u){let h,d,p=u[6](u[10][u[3]])+"",y,_;return{c(){h=je("span"),d=Vt("(NI "),y=Vt(p),_=Vt(")"),this.h()},l(a){h=Ge(a,"SPAN",{class:!0,style:!0});var I=Ve(h);d=Ut(I,"(NI "),y=Ut(I,p),_=Ut(I,")"),I.forEach(ae),this.h()},h(){ne(h,"class",""),Je(h,"color","#1460aa")},m(a,I){Be(a,h,I),Ae(h,d),Ae(h,y),Ae(h,_)},p(a,I){I&9&&p!==(p=a[6](a[10][a[3]])+"")&&Mr(y,p)},d(a){a&&ae(h)}}}function V0(u){let h;return{c(){h=je("span"),this.h()},l(d){h=Ge(d,"SPAN",{class:!0,style:!0}),Ve(h).forEach(ae),this.h()},h(){ne(h,"class",""),Je(h,"color","#1460aa")},m(d,p){Be(d,h,p)},p:pi,d(d){d&&ae(h)}}}function U0(u){let h,d,p=yd(Math.round(u[10][u[3]]),"%)")+"",y;return{c(){h=je("span"),d=Vt("(2011 "),y=Vt(p),this.h()},l(_){h=Ge(_,"SPAN",{class:!0,style:!0});var a=Ve(h);d=Ut(a,"(2011 "),y=Ut(a,p),a.forEach(ae),this.h()},h(){ne(h,"class",""),Je(h,"color","#1460aa")},m(_,a){Be(_,h,a),Ae(h,d),Ae(h,y)},p(_,a){a&9&&p!==(p=yd(Math.round(_[10][_[3]]),"%)")+"")&&Mr(y,p)},d(_){_&&ae(h)}}}function om(u){let h,d,p,y,_,a=u[10][u[1]]+"",I,T,D,F=u[6](u[10][u[2]])+"",M,L,X;function oe(xe,be){if(xe[3]=="prev"&&xe[4])return U0;if(xe[3]=="prev"&&!xe[4])return V0;if(xe[3])return N0}let se=oe(u),pe=se&&se(u);return{c(){h=je("tr"),d=je("td"),p=Kn("svg"),y=Kn("rect"),_=bt(),I=Vt(a),T=bt(),D=je("td"),M=Vt(F),L=bt(),pe&&pe.c(),X=bt(),this.h()},l(xe){h=Ge(xe,"TR",{});var be=Ve(h);d=Ge(be,"TD",{class:!0});var ct=Ve(d);p=Hn(ct,"svg",{width:!0,height:!0,class:!0});var We=Ve(p);y=Hn(We,"rect",{width:!0,height:!0,style:!0}),Ve(y).forEach(ae),We.forEach(ae),_=xt(ct),I=Ut(ct,a),ct.forEach(ae),T=xt(be),D=Ge(be,"TD",{class:!0,style:!0});var De=Ve(D);M=Ut(De,F),L=xt(De),pe&&pe.l(De),De.forEach(ae),X=xt(be),be.forEach(ae),this.h()},h(){ne(y,"width","20"),ne(y,"height","30"),Je(y,"fill",u[5][u[12]]),ne(p,"width","20"),ne(p,"height","30"),ne(p,"class","bullet svelte-1gvovsq"),ne(d,"class","svelte-1gvovsq"),ne(D,"class","cell-right svelte-1gvovsq"),Je(D,"vertical-align","top")},m(xe,be){Be(xe,h,be),Ae(h,d),Ae(d,p),Ae(p,y),Ae(d,_),Ae(d,I),Ae(h,T),Ae(h,D),Ae(D,M),Ae(D,L),pe&&pe.m(D,null),Ae(h,X)},p(xe,be){be&32&&Je(y,"fill",xe[5][xe[12]]),be&3&&a!==(a=xe[10][xe[1]]+"")&&Mr(I,a),be&5&&F!==(F=xe[6](xe[10][xe[2]])+"")&&Mr(M,F),se===(se=oe(xe))&&pe?pe.p(xe,be):(pe&&pe.d(1),pe=se&&se(xe),pe&&(pe.c(),pe.m(D,null)))},d(xe){xe&&ae(h),pe&&pe.d()}}}function q0(u){let h,d,p=u[0],y=[];for(let _=0;_<p.length;_+=1)y[_]=om(am(u,p,_));return{c(){h=je("table"),d=je("tbody");for(let _=0;_<y.length;_+=1)y[_].c();this.h()},l(_){h=Ge(_,"TABLE",{class:!0});var a=Ve(h);d=Ge(a,"TBODY",{});var I=Ve(d);for(let T=0;T<y.length;T+=1)y[T].l(I);I.forEach(ae),a.forEach(ae),this.h()},h(){ne(h,"class","legend svelte-1gvovsq")},m(_,a){Be(_,h,a),Ae(h,d);for(let I=0;I<y.length;I+=1)y[I]&&y[I].m(d,null)},p(_,[a]){if(a&127){p=_[0];let I;for(I=0;I<p.length;I+=1){const T=am(_,p,I);y[I]?y[I].p(T,a):(y[I]=om(T),y[I].c(),y[I].m(d,null))}for(;I<y.length;I+=1)y[I].d(1);y.length=p.length}},i:pi,o:pi,d(_){_&&ae(h),ln(y,_)}}}function j0(u,h,d){let p,{data:y}=h,{xKey:_="x"}=h,{yKey:a="y"}=h,{zKey:I="ni"}=h,{topic_prev_available:T=!0}=h,{colors:D=["#3878c5","#00205B","#308182","#002417","#BD00BD","lightgrey"]}=h,{decimals:F=null}=h;function M(L){let X;return F?X=(L/p*100).toFixed(F)+"%":L/p*100<1?X="<1%":X=(L/p*100).toFixed(0)+"%",X}return u.$$set=L=>{"data"in L&&d(0,y=L.data),"xKey"in L&&d(1,_=L.xKey),"yKey"in L&&d(2,a=L.yKey),"zKey"in L&&d(3,I=L.zKey),"topic_prev_available"in L&&d(4,T=L.topic_prev_available),"colors"in L&&d(5,D=L.colors),"decimals"in L&&d(7,F=L.decimals)},u.$$.update=()=>{u.$$.dirty&5&&(p=y.map(L=>L[a]).reduce((L,X)=>L+X,0)),u.$$.dirty&9&&y.map(L=>L[I]).reduce((L,X)=>L+X,0)},[y,_,a,I,T,D,M,F]}class G0 extends mn{constructor(h){super(),yn(this,h,j0,q0,gn,{data:0,xKey:1,yKey:2,zKey:3,topic_prev_available:4,colors:5,decimals:7})}}function sm(u){let h,d,p,y;d=new Xp({props:{data:u[0],yKey:u[4],colors:u[6]}});let _=u[8]&&lm(u);return{c(){h=je("div"),ir(d.$$.fragment),p=bt(),_&&_.c(),this.h()},l(a){h=Ge(a,"DIV",{class:!0,style:!0});var I=Ve(h);nr(d.$$.fragment,I),p=xt(I),_&&_.l(I),I.forEach(ae),this.h()},h(){ne(h,"class","chart svelte-1tebgpk"),Je(h,"height",u[1]*.28+"px")},m(a,I){Be(a,h,I),ar(d,h,null),Ae(h,p),_&&_.m(h,null),y=!0},p(a,I){const T={};I&1&&(T.data=a[0]),I&16&&(T.yKey=a[4]),I&64&&(T.colors=a[6]),d.$set(T),a[8]?_?_.p(a,I):(_=lm(a),_.c(),_.m(h,null)):_&&(_.d(1),_=null),(!y||I&2)&&Je(h,"height",a[1]*.28+"px")},i(a){y||(tt(d.$$.fragment,a),y=!0)},o(a){ut(d.$$.fragment,a),y=!1},d(a){a&&ae(h),or(d),_&&_.d()}}}function lm(u){let h,d;return{c(){h=je("div"),d=Vt(u[8]),this.h()},l(p){h=Ge(p,"DIV",{class:!0});var y=Ve(h);d=Ut(y,u[8]),y.forEach(ae),this.h()},h(){ne(h,"class","label svelte-1tebgpk")},m(p,y){Be(p,h,y),Ae(h,d)},p(p,y){y&256&&Mr(d,p[8])},d(p){p&&ae(h)}}}function um(u){let h,d,p,y,_,a;return d=new Xp({props:{data:u[0],yKey:u[4],colors:u[6]}}),{c(){h=je("div"),ir(d.$$.fragment),p=bt(),y=je("div"),_=Vt("2011 comparison not available"),this.h()},l(I){h=Ge(I,"DIV",{class:!0,style:!0});var T=Ve(h);nr(d.$$.fragment,T),p=xt(T),y=Ge(T,"DIV",{class:!0,style:!0});var D=Ve(y);_=Ut(D,"2011 comparison not available"),D.forEach(ae),T.forEach(ae),this.h()},h(){ne(y,"class","label svelte-1tebgpk"),Je(y,"background-color","#d8d8d8 "),Je(y,"color","#000000"),ne(h,"class","chart svelte-1tebgpk"),Je(h,"height",u[1]*.28+"px")},m(I,T){Be(I,h,T),ar(d,h,null),Ae(h,p),Ae(h,y),Ae(y,_),a=!0},p(I,T){const D={};T&1&&(D.data=I[0]),T&16&&(D.yKey=I[4]),T&64&&(D.colors=I[6]),d.$set(D),(!a||T&2)&&Je(h,"height",I[1]*.28+"px")},i(I){a||(tt(d.$$.fragment,I),a=!0)},o(I){ut(d.$$.fragment,I),a=!1},d(I){I&&ae(h),or(d)}}}function Z0(u){let h,d,p,y,_,a,I,T;d=new Xp({props:{data:u[0],yKey:u[3],colors:u[6]}});let D=(u[4]&&u[5]||u[4]=="ni")&&sm(u),F=u[4]=="prev"&&!u[5]&&um(u);return I=new G0({props:{data:u[0],xKey:u[2],yKey:u[3],zKey:u[4],topic_prev_available:u[5],decimals:u[7],colors:u[6]}}),{c(){h=je("div"),ir(d.$$.fragment),p=bt(),D&&D.c(),y=bt(),F&&F.c(),_=bt(),a=je("div"),ir(I.$$.fragment),this.h()},l(M){h=Ge(M,"DIV",{class:!0,style:!0});var L=Ve(h);nr(d.$$.fragment,L),L.forEach(ae),p=xt(M),D&&D.l(M),y=xt(M),F&&F.l(M),_=xt(M),a=Ge(M,"DIV",{class:!0});var X=Ve(a);nr(I.$$.fragment,X),X.forEach(ae),this.h()},h(){ne(h,"class","chart svelte-1tebgpk"),Je(h,"padding-top","3px"),Je(h,"height",(u[4]?u[1]*.72:u[1])+"px"),ne(a,"class","legend svelte-1tebgpk")},m(M,L){Be(M,h,L),ar(d,h,null),Be(M,p,L),D&&D.m(M,L),Be(M,y,L),F&&F.m(M,L),Be(M,_,L),Be(M,a,L),ar(I,a,null),T=!0},p(M,[L]){const X={};L&1&&(X.data=M[0]),L&8&&(X.yKey=M[3]),L&64&&(X.colors=M[6]),d.$set(X),(!T||L&18)&&Je(h,"height",(M[4]?M[1]*.72:M[1])+"px"),M[4]&&M[5]||M[4]=="ni"?D?(D.p(M,L),L&48&&tt(D,1)):(D=sm(M),D.c(),tt(D,1),D.m(y.parentNode,y)):D&&(En(),ut(D,1,1,()=>{D=null}),Tn()),M[4]=="prev"&&!M[5]?F?(F.p(M,L),L&48&&tt(F,1)):(F=um(M),F.c(),tt(F,1),F.m(_.parentNode,_)):F&&(En(),ut(F,1,1,()=>{F=null}),Tn());const oe={};L&1&&(oe.data=M[0]),L&4&&(oe.xKey=M[2]),L&8&&(oe.yKey=M[3]),L&16&&(oe.zKey=M[4]),L&32&&(oe.topic_prev_available=M[5]),L&128&&(oe.decimals=M[7]),L&64&&(oe.colors=M[6]),I.$set(oe)},i(M){T||(tt(d.$$.fragment,M),tt(D),tt(F),tt(I.$$.fragment,M),T=!0)},o(M){ut(d.$$.fragment,M),ut(D),ut(F),ut(I.$$.fragment,M),T=!1},d(M){M&&ae(h),or(d),M&&ae(p),D&&D.d(M),M&&ae(y),F&&F.d(M),M&&ae(_),M&&ae(a),or(I)}}}function K0(u,h,d){let{data:p}=h,{height:y=80}=h,{xKey:_="x"}=h,{yKey:a="y"}=h,{zKey:I="ni"}=h,{topic_prev_available:T=!0}=h,{colors:D=["#8268b6","#00205B","#308182","#3d007a","#3878c5","lightgrey"]}=h,{decimals:F=null}=h,{label:M=null}=h;return u.$$set=L=>{"data"in L&&d(0,p=L.data),"height"in L&&d(1,y=L.height),"xKey"in L&&d(2,_=L.xKey),"yKey"in L&&d(3,a=L.yKey),"zKey"in L&&d(4,I=L.zKey),"topic_prev_available"in L&&d(5,T=L.topic_prev_available),"colors"in L&&d(6,D=L.colors),"decimals"in L&&d(7,F=L.decimals),"label"in L&&d(8,M=L.label)},[p,y,_,a,I,T,D,F,M]}class Lh extends mn{constructor(h){super(),yn(this,h,K0,Z0,gn,{data:0,height:1,xKey:2,yKey:3,zKey:4,topic_prev_available:5,colors:6,decimals:7,label:8})}}function cm(u,h,d){const p=u.slice();return p[15]=h[d],p}function hm(u,h,d){const p=u.slice();return p[18]=h[d],p[19]=h,p[20]=d,p}function pm(u,h,d){const p=u.slice();return p[15]=h[d],p[20]=d,p}function fm(u){let h,d=u[5],p=[];for(let y=0;y<d.length;y+=1)p[y]=dm(pm(u,d,y));return{c(){h=je("ul");for(let y=0;y<p.length;y+=1)p[y].c();this.h()},l(y){h=Ge(y,"UL",{class:!0});var _=Ve(h);for(let a=0;a<p.length;a+=1)p[a].l(_);_.forEach(ae),this.h()},h(){ne(h,"class","legend-block svelte-sk00pb")},m(y,_){Be(y,h,_);for(let a=0;a<p.length;a+=1)p[a]&&p[a].m(h,null)},p(y,_){if(_&32){d=y[5];let a;for(a=0;a<d.length;a+=1){const I=pm(y,d,a);p[a]?p[a].p(I,_):(p[a]=dm(I),p[a].c(),p[a].m(h,null))}for(;a<p.length;a+=1)p[a].d(1);p.length=d.length}},d(y){y&&ae(h),ln(p,y)}}}function dm(u){let h,d,p,y,_=u[15]+"",a,I;return{c(){h=je("li"),d=je("div"),p=bt(),y=je("span"),a=Vt(_),I=bt(),this.h()},l(T){h=Ge(T,"LI",{class:!0});var D=Ve(h);d=Ge(D,"DIV",{class:!0}),Ve(d).forEach(ae),p=xt(D),y=Ge(D,"SPAN",{});var F=Ve(y);a=Ut(F,_),F.forEach(ae),I=xt(D),D.forEach(ae),this.h()},h(){ne(d,"class","legend-vis "+(u[20]==0?"bar":"bar2")+" svelte-sk00pb"),ne(h,"class","svelte-sk00pb")},m(T,D){Be(T,h,D),Ae(h,d),Ae(h,p),Ae(h,y),Ae(y,a),Ae(h,I)},p(T,D){D&32&&_!==(_=T[15]+"")&&Mr(a,_)},d(T){T&&ae(h)}}}function mm(u){let h,d=`${u[4](u[18][u[0]])}%`,p,y,_=gm(u[18][u[0]])+"",a,I,T=`calc(${u[4](u[18][u[0]])}% + 2px)`;function D(){u[12].call(y,u[19],u[20])}return{c(){h=je("div"),p=bt(),y=je("div"),a=Vt(_),this.h()},l(F){h=Ge(F,"DIV",{class:!0}),Ve(h).forEach(ae),p=xt(F),y=Ge(F,"DIV",{class:!0});var M=Ve(y);a=Ut(M,_),M.forEach(ae),this.h()},h(){ne(h,"class",Ah(u[20]==0?"bar":"bar2")+" svelte-sk00pb"),Je(h,"left","0"),Je(h,"width",d),Je(h,"top",u[20]==0?"0":"50%"),Je(h,"height",u[5][1]?"50%":"100%"),ne(y,"class","label svelte-sk00pb"),ju(()=>D.call(y)),Je(y,"left",T),Je(y,"top",u[20]==0?"0":"50%"),Je(y,"height","50%")},m(F,M){Be(F,h,M),Be(F,p,M),Be(F,y,M),Ae(y,a),I=Gu(y,D.bind(y))},p(F,M){u=F,M&25&&d!==(d=`${u[4](u[18][u[0]])}%`)&&Je(h,"width",d),M&32&&Je(h,"height",u[5][1]?"50%":"100%"),M&9&&_!==(_=gm(u[18][u[0]])+"")&&Mr(a,_),M&25&&T!==(T=`calc(${u[4](u[18][u[0]])}% + 2px)`)&&Je(y,"left",T)},d(F){F&&ae(h),F&&ae(p),F&&ae(y),I()}}}function ym(u){let h,d=u[15].label+"",p,y,_,a,I=`${u[5][1]?u[1]*2:u[1]}px`,T=`calc(100% - ${u[2]}px)`,D=u[15].values,F=[];for(let M=0;M<D.length;M+=1)F[M]=mm(hm(u,D,M));return{c(){h=je("div"),p=Vt(d),y=bt(),_=je("div");for(let M=0;M<F.length;M+=1)F[M].c();a=bt(),this.h()},l(M){h=Ge(M,"DIV",{class:!0});var L=Ve(h);p=Ut(L,d),L.forEach(ae),y=xt(M),_=Ge(M,"DIV",{class:!0});var X=Ve(_);for(let oe=0;oe<F.length;oe+=1)F[oe].l(X);a=xt(X),X.forEach(ae),this.h()},h(){ne(h,"class","label-group svelte-sk00pb"),ne(_,"class","bar-group svelte-sk00pb"),Je(_,"height",I),Je(_,"width",T)},m(M,L){Be(M,h,L),Ae(h,p),Be(M,y,L),Be(M,_,L);for(let X=0;X<F.length;X+=1)F[X]&&F[X].m(_,null);Ae(_,a)},p(M,L){if(L&8&&d!==(d=M[15].label+"")&&Mr(p,d),L&57){D=M[15].values;let X;for(X=0;X<D.length;X+=1){const oe=hm(M,D,X);F[X]?F[X].p(oe,L):(F[X]=mm(oe),F[X].c(),F[X].m(_,a))}for(;X<F.length;X+=1)F[X].d(1);F.length=D.length}L&34&&I!==(I=`${M[5][1]?M[1]*2:M[1]}px`)&&Je(_,"height",I),L&4&&T!==(T=`calc(100% - ${M[2]}px)`)&&Je(_,"width",T)},d(M){M&&ae(h),M&&ae(y),M&&ae(_),ln(F,M)}}}function H0(u){let h,d,p=u[5][1]&&fm(u),y=u[3],_=[];for(let a=0;a<y.length;a+=1)_[a]=ym(cm(u,y,a));return{c(){p&&p.c(),h=bt();for(let a=0;a<_.length;a+=1)_[a].c();d=ur()},l(a){p&&p.l(a),h=xt(a);for(let I=0;I<_.length;I+=1)_[I].l(a);d=ur()},m(a,I){p&&p.m(a,I),Be(a,h,I);for(let T=0;T<_.length;T+=1)_[T]&&_[T].m(a,I);Be(a,d,I)},p(a,[I]){if(a[5][1]?p?p.p(a,I):(p=fm(a),p.c(),p.m(h.parentNode,h)):p&&(p.d(1),p=null),I&63){y=a[3];let T;for(T=0;T<y.length;T+=1){const D=cm(a,y,T);_[T]?_[T].p(D,I):(_[T]=ym(D),_[T].c(),_[T].m(d.parentNode,d))}for(;T<_.length;T+=1)_[T].d(1);_.length=y.length}},i:pi,o:pi,d(a){p&&p.d(a),a&&ae(h),ln(_,a),a&&ae(d)}}}function gm(u){let h;return u==null?h="Not available":u<1?h="<1%":h=u.toFixed(0)+"%",h}function X0(u,h,d){let p,y,_,a,{data:I}=h,{xKey:T="perc"}=h,{yKey:D="category"}=h,{zKey:F="ni"}=h,{formatTick:M=xe=>Math.round(xe)}=h,{suffix:L="%"}=h,{barHeight:X=20}=h,{margin:oe=30}=h;function se(xe,be){let ct={};for(const De of xe)ct[De[be]]||(ct[De[be]]={label:De[be],values:[]}),ct[De[be]].values.push(De);let We=[];for(const De in ct)We.push(ct[De]);return We}function pe(xe,be){xe[be].width=this.clientWidth,d(3,a),d(6,I),d(7,D)}return u.$$set=xe=>{"data"in xe&&d(6,I=xe.data),"xKey"in xe&&d(0,T=xe.xKey),"yKey"in xe&&d(7,D=xe.yKey),"zKey"in xe&&d(8,F=xe.zKey),"formatTick"in xe&&d(9,M=xe.formatTick),"suffix"in xe&&d(10,L=xe.suffix),"barHeight"in xe&&d(1,X=xe.barHeight),"margin"in xe&&d(2,oe=xe.margin)},u.$$.update=()=>{u.$$.dirty&65&&d(11,p=[0,Math.max(...I.map(xe=>xe[T]))]),u.$$.dirty&192&&I.map(xe=>xe[D]).filter((xe,be,ct)=>ct.indexOf(xe)===be),u.$$.dirty&320&&d(5,y=I.map(xe=>xe[F]).filter((xe,be,ct)=>ct.indexOf(xe)===be)),u.$$.dirty&2048&&d(4,_=xe=>xe/p[1]*100),u.$$.dirty&192&&d(3,a=se(I,D))},[T,X,oe,a,_,y,I,D,F,M,L,p,pe]}class Rh extends mn{constructor(h){super(),yn(this,h,X0,H0,gn,{data:6,xKey:0,yKey:7,zKey:8,formatTick:9,suffix:10,barHeight:1,margin:2})}}function _m(u,h,d){const p=u.slice();return p[14]=h[d],p}function vm(u,h,d){const p=u.slice();return p[17]=h[d],p[19]=d,p}function bm(u,h,d){const p=u.slice();return p[17]=h[d],p[19]=d,p}function xm(u,h,d){const p=u.slice();return p[14]=h[d],p[19]=d,p}function wm(u){let h,d=u[7],p=[];for(let y=0;y<d.length;y+=1)p[y]=Sm(xm(u,d,y));return{c(){h=je("ul");for(let y=0;y<p.length;y+=1)p[y].c();this.h()},l(y){h=Ge(y,"UL",{class:!0});var _=Ve(h);for(let a=0;a<p.length;a+=1)p[a].l(_);_.forEach(ae),this.h()},h(){ne(h,"class","legend svelte-1hk4284")},m(y,_){Be(y,h,_);for(let a=0;a<p.length;a+=1)p[a]&&p[a].m(h,null)},p(y,_){if(_&144){d=y[7];let a;for(a=0;a<d.length;a+=1){const I=xm(y,d,a);p[a]?p[a].p(I,_):(p[a]=Sm(I),p[a].c(),p[a].m(h,null))}for(;a<p.length;a+=1)p[a].d(1);p.length=d.length}},d(y){y&&ae(h),ln(p,y)}}}function Sm(u){let h,d,p,y,_=u[14]+"",a,I;return{c(){h=je("li"),d=je("div"),p=bt(),y=je("span"),a=Vt(_),I=bt(),this.h()},l(T){h=Ge(T,"LI",{class:!0});var D=Ve(h);d=Ge(D,"DIV",{class:!0}),Ve(d).forEach(ae),p=xt(D),y=Ge(D,"SPAN",{class:!0});var F=Ve(y);a=Ut(F,_),F.forEach(ae),I=xt(D),D.forEach(ae),this.h()},h(){ne(d,"class","legend-vis "+(u[19]==0?"bar":"marker")+" svelte-1hk4284"),Je(d,"height","1rem"),Je(d,"width",u[19]==0?"1rem":u[4]+"px"),ne(y,"class",Ah(u[19]==0?"bold":"brackets")+" svelte-1hk4284"),ne(h,"class","svelte-1hk4284")},m(T,D){Be(T,h,D),Ae(h,d),Ae(h,p),Ae(h,y),Ae(y,a),Ae(h,I)},p(T,D){D&16&&Je(d,"width",T[19]==0?"1rem":T[4]+"px"),D&128&&_!==(_=T[14]+"")&&Mr(a,_)},d(T){T&&ae(h)}}}function km(u){let h,d=u[1](u[17].perc/100)+"",p,y;return{c(){h=je("span"),p=Vt(d),y=Vt(u[2]),this.h()},l(_){h=Ge(_,"SPAN",{class:!0,style:!0});var a=Ve(h);p=Ut(a,d),y=Ut(a,u[2]),a.forEach(ae),this.h()},h(){ne(h,"class",Ah(u[19]==0?"bold":"sml brackets")+" svelte-1hk4284"),Je(h,"color",u[19]==0?"#000000":"#1460aa")},m(_,a){Be(_,h,a),Ae(h,p),Ae(h,y)},p(_,a){a&34&&d!==(d=_[1](_[17].perc/100)+"")&&Mr(p,d),a&4&&Mr(y,_[2])},d(_){_&&ae(h)}}}function W0(u){let h,d=`calc(${u[6](u[17][u[0]])}% - ${u[4]/2}px)`,p=`${u[4]}px`;return{c(){h=je("div"),this.h()},l(y){h=Ge(y,"DIV",{class:!0}),Ve(h).forEach(ae),this.h()},h(){ne(h,"class","marker svelte-1hk4284"),Je(h,"left",d),Je(h,"border-left-width",p)},m(y,_){Be(y,h,_)},p(y,_){_&113&&d!==(d=`calc(${y[6](y[17][y[0]])}% - ${y[4]/2}px)`)&&Je(h,"left",d),_&16&&p!==(p=`${y[4]}px`)&&Je(h,"border-left-width",p)},d(y){y&&ae(h)}}}function Y0(u){let h,d=`${u[6](u[17][u[0]])}%`;return{c(){h=je("div"),this.h()},l(p){h=Ge(p,"DIV",{class:!0}),Ve(h).forEach(ae),this.h()},h(){ne(h,"class","bar svelte-1hk4284"),Je(h,"left","0"),Je(h,"width",d)},m(p,y){Be(p,h,y)},p(p,y){y&97&&d!==(d=`${p[6](p[17][p[0]])}%`)&&Je(h,"width",d)},d(p){p&&ae(h)}}}function Em(u){let h;function d(_,a){return _[19]==0?Y0:W0}let y=d(u)(u);return{c(){y.c(),h=ur()},l(_){y.l(_),h=ur()},m(_,a){y.m(_,a),Be(_,h,a)},p(_,a){y.p(_,a)},d(_){y.d(_),_&&ae(h)}}}function Tm(u){let h,d=u[14].label+"",p,y,_,a,I,T=`${u[3]}px`,D=u[14].values,F=[];for(let X=0;X<D.length;X+=1)F[X]=km(bm(u,D,X));let M=u[14].values,L=[];for(let X=0;X<M.length;X+=1)L[X]=Em(vm(u,M,X));return{c(){h=je("div"),p=Vt(d),y=bt();for(let X=0;X<F.length;X+=1)F[X].c();_=bt(),a=je("div");for(let X=0;X<L.length;X+=1)L[X].c();I=bt(),this.h()},l(X){h=Ge(X,"DIV",{class:!0});var oe=Ve(h);p=Ut(oe,d),y=xt(oe);for(let pe=0;pe<F.length;pe+=1)F[pe].l(oe);oe.forEach(ae),_=xt(X),a=Ge(X,"DIV",{class:!0});var se=Ve(a);for(let pe=0;pe<L.length;pe+=1)L[pe].l(se);I=xt(se),se.forEach(ae),this.h()},h(){ne(h,"class","label-group svelte-1hk4284"),ne(a,"class","bar-group svelte-1hk4284"),Je(a,"height",T)},m(X,oe){Be(X,h,oe),Ae(h,p),Ae(h,y);for(let se=0;se<F.length;se+=1)F[se]&&F[se].m(h,null);Be(X,_,oe),Be(X,a,oe);for(let se=0;se<L.length;se+=1)L[se]&&L[se].m(a,null);Ae(a,I)},p(X,oe){if(oe&32&&d!==(d=X[14].label+"")&&Mr(p,d),oe&38){D=X[14].values;let se;for(se=0;se<D.length;se+=1){const pe=bm(X,D,se);F[se]?F[se].p(pe,oe):(F[se]=km(pe),F[se].c(),F[se].m(h,null))}for(;se<F.length;se+=1)F[se].d(1);F.length=D.length}if(oe&113){M=X[14].values;let se;for(se=0;se<M.length;se+=1){const pe=vm(X,M,se);L[se]?L[se].p(pe,oe):(L[se]=Em(pe),L[se].c(),L[se].m(a,I))}for(;se<L.length;se+=1)L[se].d(1);L.length=M.length}oe&8&&T!==(T=`${X[3]}px`)&&Je(a,"height",T)},d(X){X&&ae(h),ln(F,X),X&&ae(_),X&&ae(a),ln(L,X)}}}function J0(u){let h,d,p=u[7][1]&&wm(u),y=u[5],_=[];for(let a=0;a<y.length;a+=1)_[a]=Tm(_m(u,y,a));return{c(){p&&p.c(),h=bt();for(let a=0;a<_.length;a+=1)_[a].c();d=ur()},l(a){p&&p.l(a),h=xt(a);for(let I=0;I<_.length;I+=1)_[I].l(a);d=ur()},m(a,I){p&&p.m(a,I),Be(a,h,I);for(let T=0;T<_.length;T+=1)_[T]&&_[T].m(a,I);Be(a,d,I)},p(a,[I]){if(a[7][1]?p?p.p(a,I):(p=wm(a),p.c(),p.m(h.parentNode,h)):p&&(p.d(1),p=null),I&127){y=a[5];let T;for(T=0;T<y.length;T+=1){const D=_m(a,y,T);_[T]?_[T].p(D,I):(_[T]=Tm(D),_[T].c(),_[T].m(d.parentNode,d))}for(;T<_.length;T+=1)_[T].d(1);_.length=y.length}},i:pi,o:pi,d(a){p&&p.d(a),a&&ae(h),ln(_,a),a&&ae(d)}}}function Q0(u,h,d){let p,y,_,a,{data:I}=h,{xKey:T="perc"}=h,{yKey:D="category"}=h,{zKey:F="group"}=h,{formatTick:M=pe=>Math.round(100*pe)}=h,{suffix:L="%"}=h,{barHeight:X=25}=h,{markerWidth:oe=3}=h;function se(pe,xe){let be={};for(const We of pe)be[We[xe]]||(be[We[xe]]={label:We[xe],values:[]}),be[We[xe]].values.push(We);let ct=[];for(const We in be)ct.push(be[We]);return ct}return u.$$set=pe=>{"data"in pe&&d(8,I=pe.data),"xKey"in pe&&d(0,T=pe.xKey),"yKey"in pe&&d(9,D=pe.yKey),"zKey"in pe&&d(10,F=pe.zKey),"formatTick"in pe&&d(1,M=pe.formatTick),"suffix"in pe&&d(2,L=pe.suffix),"barHeight"in pe&&d(3,X=pe.barHeight),"markerWidth"in pe&&d(4,oe=pe.markerWidth)},u.$$.update=()=>{u.$$.dirty&257&&d(11,p=[0,Math.max(...I.map(pe=>pe[T]))]),u.$$.dirty&768&&I.map(pe=>pe[D]).filter((pe,xe,be)=>be.indexOf(pe)===xe),u.$$.dirty&1280&&d(7,y=I.map(pe=>pe[F]).filter((pe,xe,be)=>be.indexOf(pe)===xe)),u.$$.dirty&2048&&d(6,_=pe=>pe/p[1]*100),u.$$.dirty&768&&d(5,a=se(I,D))},[T,M,L,X,oe,a,_,y,I,D,F,p]}class Bh extends mn{constructor(h){super(),yn(this,h,Q0,J0,gn,{data:8,xKey:0,yKey:9,zKey:10,formatTick:1,suffix:2,barHeight:3,markerWidth:4})}}function Im(u,h,d){const p=u.slice();return p[12]=h[d],p[14]=d,p}function Am(u,h,d){const p=u.slice();return p[15]=h[d],p[17]=d,p}function zm(u,h,d){const p=u.slice();return p[15]=h[d],p[17]=d,p}function Pm(u,h,d){const p=u.slice();return p[19]=h[d],p[14]=d,p}function Cm(u){let h,d=u[5],p=[];for(let y=0;y<d.length;y+=1)p[y]=Mm(Pm(u,d,y));return{c(){h=je("ul");for(let y=0;y<p.length;y+=1)p[y].c();this.h()},l(y){h=Ge(y,"UL",{class:!0});var _=Ve(h);for(let a=0;a<p.length;a+=1)p[a].l(_);_.forEach(ae),this.h()},h(){ne(h,"class","legend svelte-pmaxst")},m(y,_){Be(y,h,_);for(let a=0;a<p.length;a+=1)p[a]&&p[a].m(h,null)},p(y,_){if(_&36){d=y[5];let a;for(a=0;a<d.length;a+=1){const I=Pm(y,d,a);p[a]?p[a].p(I,_):(p[a]=Mm(I),p[a].c(),p[a].m(h,null))}for(;a<p.length;a+=1)p[a].d(1);p.length=d.length}},d(y){y&&ae(h),ln(p,y)}}}function Mm(u){let h,d,p,y,_=u[19]+"",a,I;return{c(){h=je("li"),d=je("div"),p=bt(),y=je("span"),a=Vt(_),I=bt(),this.h()},l(T){h=Ge(T,"LI",{class:!0});var D=Ve(h);d=Ge(D,"DIV",{class:!0}),Ve(d).forEach(ae),p=xt(D),y=Ge(D,"SPAN",{class:!0});var F=Ve(y);a=Ut(F,_),F.forEach(ae),I=xt(D),D.forEach(ae),this.h()},h(){ne(d,"class","legend-vis "+(u[14]==0?"bar":"markerSmall")+" svelte-pmaxst"),Je(d,"height","1rem"),Je(d,"width",u[14]==0?"1rem":u[2]+"px"),ne(y,"class",Ah(u[14]==0?"bold":"brackets")+" svelte-pmaxst"),ne(h,"class","svelte-pmaxst")},m(T,D){Be(T,h,D),Ae(h,d),Ae(h,p),Ae(h,y),Ae(y,a),Ae(h,I)},p(T,D){D&4&&Je(d,"width",T[14]==0?"1rem":T[2]+"px"),D&32&&_!==(_=T[19]+"")&&Mr(a,_)},d(T){T&&ae(h)}}}function $0(u){let h,d=u[12].values,p=[];for(let y=0;y<d.length;y+=1)p[y]=Dm(Am(u,d,y));return{c(){for(let y=0;y<p.length;y+=1)p[y].c();h=ur()},l(y){for(let _=0;_<p.length;_+=1)p[_].l(y);h=ur()},m(y,_){for(let a=0;a<p.length;a+=1)p[a]&&p[a].m(y,_);Be(y,h,_)},p(y,_){if(_&89){d=y[12].values;let a;for(a=0;a<d.length;a+=1){const I=Am(y,d,a);p[a]?p[a].p(I,_):(p[a]=Dm(I),p[a].c(),p[a].m(h.parentNode,h))}for(;a<p.length;a+=1)p[a].d(1);p.length=d.length}},d(y){ln(p,y),y&&ae(h)}}}function e1(u){let h,d=u[12].values,p=[];for(let y=0;y<d.length;y+=1)p[y]=Lm(zm(u,d,y));return{c(){for(let y=0;y<p.length;y+=1)p[y].c();h=ur()},l(y){for(let _=0;_<p.length;_+=1)p[_].l(y);h=ur()},m(y,_){for(let a=0;a<p.length;a+=1)p[a]&&p[a].m(y,_);Be(y,h,_)},p(y,_){if(_&89){d=y[12].values;let a;for(a=0;a<d.length;a+=1){const I=zm(y,d,a);p[a]?p[a].p(I,_):(p[a]=Lm(I),p[a].c(),p[a].m(h.parentNode,h))}for(;a<p.length;a+=1)p[a].d(1);p.length=d.length}},d(y){ln(p,y),y&&ae(h)}}}function Dm(u){let h,d,p=`calc(100% - ${u[15].offset<0?u[4](u[15][u[0]]-u[15].offset):u[4](u[15][u[0]])}%)`,y=`${u[4](u[15].offset)}%`,_=`${u[17]/u[6].length*100}%`,a=`${1/u[6].length*100}%`;return{c(){h=je("div"),this.h()},l(I){h=Ge(I,"DIV",{class:!0,style:!0}),Ve(h).forEach(ae),this.h()},h(){ne(h,"class","marker svelte-pmaxst"),ne(h,"style",d="border-"+(u[15].offset<0?"top":"bottom")+": none"),Je(h,"top",p),Je(h,"height",y),Je(h,"left",_),Je(h,"width",a)},m(I,T){Be(I,h,T)},p(I,T){T&8&&d!==(d="border-"+(I[15].offset<0?"top":"bottom")+": none")&&ne(h,"style",d);const D=T&8;(D||T&25&&p!==(p=`calc(100% - ${I[15].offset<0?I[4](I[15][I[0]]-I[15].offset):I[4](I[15][I[0]])}%)`))&&Je(h,"top",p),(D||T&24&&y!==(y=`${I[4](I[15].offset)}%`))&&Je(h,"height",y),(D||T&72&&_!==(_=`${I[17]/I[6].length*100}%`))&&Je(h,"left",_),(D||T&72&&a!==(a=`${1/I[6].length*100}%`))&&Je(h,"width",a)},d(I){I&&ae(h)}}}function Lm(u){let h,d=`${100-u[4](u[15][u[0]])}%`,p=`${u[4](u[15][u[0]])}%`,y=`${u[17]/u[6].length*100}%`,_=`calc(${1/u[6].length*100}% - 2px)`;return{c(){h=je("div"),this.h()},l(a){h=Ge(a,"DIV",{class:!0}),Ve(h).forEach(ae),this.h()},h(){ne(h,"class","bar svelte-pmaxst"),Je(h,"top",d),Je(h,"height",p),Je(h,"left",y),Je(h,"width",_)},m(a,I){Be(a,h,I)},p(a,I){I&25&&d!==(d=`${100-a[4](a[15][a[0]])}%`)&&Je(h,"top",d),I&25&&p!==(p=`${a[4](a[15][a[0]])}%`)&&Je(h,"height",p),I&64&&y!==(y=`${a[17]/a[6].length*100}%`)&&Je(h,"left",y),I&64&&_!==(_=`calc(${1/a[6].length*100}% - 2px)`)&&Je(h,"width",_)},d(a){a&&ae(h)}}}function Rm(u){let h;function d(_,a){return _[14]==0?e1:$0}let y=d(u)(u);return{c(){y.c(),h=ur()},l(_){y.l(_),h=ur()},m(_,a){y.m(_,a),Be(_,h,a)},p(_,a){y.p(_,a)},d(_){y.d(_),_&&ae(h)}}}function t1(u){let h,d,p=`${u[1]}px`,y,_,a,I,T,D,F,M,L,X,oe,se,pe,xe,be=u[5][1]&&Cm(u),ct=u[3],We=[];for(let De=0;De<ct.length;De+=1)We[De]=Rm(Im(u,ct,De));return{c(){be&&be.c(),h=bt(),d=je("div");for(let De=0;De<We.length;De+=1)We[De].c();y=bt(),_=je("div"),a=je("div"),I=je("div"),T=Vt("0-14"),D=bt(),F=je("div"),M=Vt("15-39"),L=bt(),X=je("div"),oe=Vt("40-64"),se=bt(),pe=je("div"),xe=Vt("65+"),this.h()},l(De){be&&be.l(De),h=xt(De),d=Ge(De,"DIV",{class:!0});var Ze=Ve(d);for(let Ne=0;Ne<We.length;Ne+=1)We[Ne].l(Ze);Ze.forEach(ae),y=xt(De),_=Ge(De,"DIV",{class:!0});var Dt=Ve(_);a=Ge(Dt,"DIV",{class:!0});var zt=Ve(a);I=Ge(zt,"DIV",{class:!0});var Ue=Ve(I);T=Ut(Ue,"0-14"),Ue.forEach(ae),D=xt(zt),F=Ge(zt,"DIV",{class:!0});var Ke=Ve(F);M=Ut(Ke,"15-39"),Ke.forEach(ae),L=xt(zt),X=Ge(zt,"DIV",{class:!0});var vt=Ve(X);oe=Ut(vt,"40-64"),vt.forEach(ae),se=xt(zt),pe=Ge(zt,"DIV",{class:!0});var cr=Ve(pe);xe=Ut(cr,"65+"),cr.forEach(ae),zt.forEach(ae),Dt.forEach(ae),this.h()},h(){ne(d,"class","bar-group svelte-pmaxst"),Je(d,"height",p),ne(I,"class","column svelte-pmaxst"),ne(F,"class","column svelte-pmaxst"),ne(X,"class","column svelte-pmaxst"),ne(pe,"class","column svelte-pmaxst"),ne(a,"class","row svelte-pmaxst"),Je(a,"width","100%"),ne(_,"class","x-scale svelte-pmaxst")},m(De,Ze){be&&be.m(De,Ze),Be(De,h,Ze),Be(De,d,Ze);for(let Dt=0;Dt<We.length;Dt+=1)We[Dt]&&We[Dt].m(d,null);Be(De,y,Ze),Be(De,_,Ze),Ae(_,a),Ae(a,I),Ae(I,T),Ae(a,D),Ae(a,F),Ae(F,M),Ae(a,L),Ae(a,X),Ae(X,oe),Ae(a,se),Ae(a,pe),Ae(pe,xe)},p(De,[Ze]){if(De[5][1]?be?be.p(De,Ze):(be=Cm(De),be.c(),be.m(h.parentNode,h)):be&&(be.d(1),be=null),Ze&89){ct=De[3];let Dt;for(Dt=0;Dt<ct.length;Dt+=1){const zt=Im(De,ct,Dt);We[Dt]?We[Dt].p(zt,Ze):(We[Dt]=Rm(zt),We[Dt].c(),We[Dt].m(d,null))}for(;Dt<We.length;Dt+=1)We[Dt].d(1);We.length=ct.length}Ze&2&&p!==(p=`${De[1]}px`)&&Je(d,"height",p)},i:pi,o:pi,d(De){be&&be.d(De),De&&ae(h),De&&ae(d),ln(We,De),De&&ae(y),De&&ae(_)}}}function r1(u,h,d){let p,y,_,a,I,{data:T}=h,{xKey:D="category"}=h,{yKey:F="perc"}=h,{zKey:M="group"}=h,{height:L=100}=h,{markerWidth:X=3}=h;function oe(se,pe){let xe={};for(const ct of se){xe[ct[pe]]||(xe[ct[pe]]={label:ct[pe],values:[]});let We=xe[ct[pe]].values.length,De=We==0?0:ct[F]-xe[ct[pe]].values[We-1][F];xe[ct[pe]].values.push({...ct,offset:De})}let be=[];for(const ct in xe)be.push(xe[ct]);return console.log(be),be}return u.$$set=se=>{"data"in se&&d(7,T=se.data),"xKey"in se&&d(8,D=se.xKey),"yKey"in se&&d(0,F=se.yKey),"zKey"in se&&d(9,M=se.zKey),"height"in se&&d(1,L=se.height),"markerWidth"in se&&d(2,X=se.markerWidth)},u.$$.update=()=>{u.$$.dirty&384&&d(6,p=T.map(se=>se[D]).filter((se,pe,xe)=>xe.indexOf(se)===pe)),u.$$.dirty&129&&d(10,y=[0,Math.max(...T.map(se=>se[F]))]),u.$$.dirty&640&&d(5,_=T.map(se=>se[M]).filter((se,pe,xe)=>xe.indexOf(se)===pe)),u.$$.dirty&1024&&d(4,a=se=>Math.abs(se/y[1])*100),u.$$.dirty&640&&d(3,I=oe(T,M))},[F,L,X,I,a,_,p,T,D,M,y]}class Oh extends mn{constructor(h){super(),yn(this,h,r1,t1,gn,{data:7,xKey:8,yKey:0,zKey:9,height:1,markerWidth:2})}}function i1(u){let h,d,p,y;return{c(){h=je("div"),d=Vt("Back to top"),this.h()},l(_){h=Ge(_,"DIV",{class:!0});var a=Ve(h);d=Ut(a,"Back to top"),a.forEach(ae),this.h()},h(){ne(h,"class","back_to_start svelte-11zibd5"),rs(h,"hidden",u[0])},m(_,a){Be(_,h,a),Ae(h,d),p||(y=[vd(window,"scroll",u[2]),vd(h,"click",u[1])],p=!0)},p(_,[a]){a&1&&rs(h,"hidden",_[0])},i:pi,o:pi,d(_){_&&ae(h),p=!1,c_(y)}}}function n1(u,h,d){let{buttonVisibleOnPX:p=200}=h,y=!0;const _=()=>{document.body.scrollIntoView()},a=()=>document.documentElement||document.body,I=()=>{a().scrollTop>p?d(0,y=!1):d(0,y=!0)};return u.$$set=T=>{"buttonVisibleOnPX"in T&&d(3,p=T.buttonVisibleOnPX)},[y,_,I,p]}class a1 extends mn{constructor(h){super(),yn(this,h,n1,i1,gn,{buttonVisibleOnPX:3})}}function o1(u){let h,d,p=u[1][u[0]].title+"",y,_,a,I,T,D,F,M,L,X=u[1][u[0]].info+"",oe;return{c(){h=je("div"),d=je("div"),y=Vt(p),_=bt(),a=je("img"),F=bt(),M=je("div"),L=je("div"),this.h()},l(se){h=Ge(se,"DIV",{class:!0,style:!0,"data-bs-toggle":!0,"data-bs-target":!0,"aria-expanded":!0,"aria-controls":!0});var pe=Ve(h);d=Ge(pe,"DIV",{class:!0,style:!0});var xe=Ve(d);y=Ut(xe,p),_=xt(xe),a=Ge(xe,"IMG",{class:!0,src:!0,alt:!0}),xe.forEach(ae),pe.forEach(ae),F=xt(se),M=Ge(se,"DIV",{class:!0,id:!0});var be=Ve(M);L=Ge(be,"DIV",{class:!0});var ct=Ve(L);ct.forEach(ae),be.forEach(ae),this.h()},h(){ne(a,"class","i-button"),Cp(a.src,I=ha+"\\img\\i-button.svg")||ne(a,"src",I),ne(a,"alt","Information button"),ne(d,"class","blocktitle"),Je(d,"margin","0"),Je(d,"width","100%"),ne(h,"class","row"),Je(h,"display","flex"),Je(h,"cursor","pointer"),ne(h,"data-bs-toggle","collapse"),ne(h,"data-bs-target",T="#"+u[0]+"-info"),ne(h,"aria-expanded","false"),ne(h,"aria-controls",D=u[0]+"-info"),ne(L,"class","card card-body svelte-1qrf6oz"),ne(M,"class","collapse svelte-1qrf6oz"),ne(M,"id",oe=u[0]+"-info")},m(se,pe){Be(se,h,pe),Ae(h,d),Ae(d,y),Ae(d,_),Ae(d,a),Be(se,F,pe),Be(se,M,pe),Ae(M,L),L.innerHTML=X},p(se,[pe]){pe&1&&p!==(p=se[1][se[0]].title+"")&&Mr(y,p),pe&1&&T!==(T="#"+se[0]+"-info")&&ne(h,"data-bs-target",T),pe&1&&D!==(D=se[0]+"-info")&&ne(h,"aria-controls",D),pe&1&&X!==(X=se[1][se[0]].info+"")&&(L.innerHTML=X),pe&1&&oe!==(oe=se[0]+"-info")&&ne(M,"id",oe)},i:pi,o:pi,d(se){se&&ae(h),se&&ae(F),se&&ae(M)}}}function s1(u,h,d){let{id:p}=h,{place:y}=h;function _(I){let D=I.replaceAll("[",".").replaceAll("]","").split("."),F=y.meta_data;for(let M=0;M<D.length;M++)if(F.hasOwnProperty(D[M])&&(F=F[D[M]],D[M]=="last_updated")){let L=F.split("-");F=L[2]+"/"+L[1]+"/"+L[0]}return F}let a={location:{title:"About the area",info:"Information about the area including its geographical hierarchy."},area:{title:"Area",info:"Area is measured in hectares (ha), it is rounded to the nearest whole number."},popden:{title:"Population density",info:"Population density is the number of usual residents per square kilometer. A square kilometer is approximately equivalent to the floor space of 8 Titanics. It is rounded to 1 decimal place. <p class = 'pibutton'>Access data at: <a href='"+_("MYETotal[0].dataset_url")+"'>"+_("MYETotal[0].title")+"</a></p><p class = 'pibutton'>Last updated: "+_("MYETotal[0].last_updated")+"</p> <p class = 'pibutton'><a href='mailto:"+_("MYETotal[0].email")+"'>Email for more information</a> </p>"},pop:{title:"Population",info:"Population is based on the number of usual residents.  <p class = 'pibutton'>Access data at: <a href='"+_("MYETotal[0].dataset_url")+"'>"+_("MYETotal[0].title")+"</a></p><p class = 'pibutton'>Last updated: "+_("MYETotal[0].last_updated")+"</p> <p class = 'pibutton'><a href='mailto:"+_("MYETotal[0].email")+"'>Email for more information</a> </p>"},generalhealth:{title:"General Health",info:"<p>From Census 2021 data - <a href='https://explore.nisra.gov.uk/area-explorer-2021/'><strong>Census Area Explorer</strong></a></p>General health is a self-assessment of a person's general state of health. It is not based over any specified period of time. <a href='https://www.nisra.gov.uk/publications/census-2021-statistical-bulletins'><strong>Statistical bulletins</strong></a>"},wellbeing:{title:"Personal Wellbeing",info:"Average Happiness score out of 10 for people aged 16+</p>Average Life satisfaction score out of 10 for people aged 16+</p><p class = 'pibutton'>Access data at: <a href='"+_("Happy[0].dataset_url")+"'>"+_("Happy[0].title")+"</a></p><p class = 'pibutton'>Last updated: "+_("Happy[0].last_updated")+"</p> <p class = 'pibutton'><a href='mailto:"+_("Happy[0].email")+"'>Email for more information</a> </p>"},lifeexpectancy:{title:"Life Expectancy at birth",info:"<p class = 'pibutton'>Access data at: <a href='"+_("LE[0].dataset_url")+"'>"+_("LE[0].title")+"</a></p><p class = 'pibutton'>Last updated: "+_("LE[0].last_updated")+"</p> <p class = 'pibutton'><a href='mailto:"+_("LE[0].email")+"'>Email for more information</a> </p>"},carers:{title:"Unpaid care giving",info:"<p>From Census 2021 data - <a href='https://explore.nisra.gov.uk/area-explorer-2021/'><strong>Census Area Explorer</strong></a></p>Unpaid care covers looking after giving help or support to anyone because they have long-term physical or mental health conditions or illnesses, or problems related to old age. It does not include any activities as part of paid employment. All unpaid care statistics are restricted to persons aged 5 and over. <a href='https://www.nisra.gov.uk/publications/census-2021-statistical-bulletins'><strong>Statistical bulletins</strong></a>"},hospitalactivity:{title:"Annual admissions to hospital",info:"<p class = 'pibutton'>Access data at: <a href='"+_("Admiss[0].dataset_url")+"'>"+_("Admiss[0].title")+"</a></p><p class = 'pibutton'>Last updated: "+_("Admiss[0].last_updated")+"</p> <p class = 'pibutton'><a href='mailto:"+_("Admiss[0].email")+"'>Email for more information</a> </p>"},primarycare:{title:"Primary care providers",info:"<p class = 'pibutton'>Access data at: <a href='"+_("GP[0].dataset_url")+"'>"+_("GP[0].title")+"</a>, <a href='"+_("DEN[0].dataset_url")+"'>"+_("DEN[0].title")+"</a> and <a href='"+_("DEN_REG[0].dataset_url")+"'>"+_("DEN_REG[0].title")+"</a></p>"},employmentrates:{title:"Work status of adults",info:"<p class = 'pibutton'>Access data at: <a href='"+_("LMS[0].dataset_url")+"'>"+_("LMS[0].title")+"</a></p><p class = 'pibutton'>Last updated: "+_("LMS[0].last_updated")+"</p> <p class = 'pibutton'><a href='mailto:"+_("LMS[0].email")+"'>Email for more information</a> </p><p>Inactive includes students, early retirees, or people looking after a home, who are long-term sick or disabled. </p>"},employed:{title:"Work and wages",info:"<p class = 'pibutton'>Access data on number employed at: <a href='"+_("LMS[0].dataset_url")+"'>"+_("LMS[0].title")+"</a></p><p class = 'pibutton'>Last updated: "+_("LMS[0].last_updated")+"</p><p class = 'pibutton'><a href='mailto:"+_("LMS[0].email")+"'>Email for more information</a> </p><p >Access wages data at: <a href='"+_("ASHE[0].dataset_url")+"'>"+_("ASHE[0].title")+"</a></p><p class = 'pibutton'>Last updated: "+_("ASHE[0].last_updated")+"</p> <p class = 'pibutton'><a href='mailto:"+_("ASHE[0].email")+"'>Email for more information</a> </p><p>Median is the ..... </p>"},wages:{title:"Average annual wage",info:"<p class = 'pibutton'>Access data at: <a href='"+_("ASHE[0].dataset_url")+"'>"+_("ASHE[0].title")+"</a></p><p class = 'pibutton'>Last updated: "+_("ASHE[0].last_updated")+"</p> <p class = 'pibutton'><a href='mailto:"+_("ASHE[0].email")+"'>Email for more information</a> </p><p>Median is the ..... </p>"},bres:{title:"Type of work",info:"<p class = 'pibutton'>Access data at: <a href='"+_("BRES[0].dataset_url")+"'>"+_("BRES[0].title")+"</a></p><p class = 'pibutton'>Last updated: "+_("BRES[0].last_updated")+"</p><p class = 'pibutton'><a href='mailto:"+_("BRES[0].email")+"'>Email for more information</a> </p>"},pensionagebenefits:{title:"Pension Age benefits",info:"Benefits included are: SP and PC<p class = 'pibutton'>Access data at: <a href='"+_("BS[0].dataset_url")+"'>"+_("BS[0].title")+"</a></p><p class = 'pibutton'>Last updated: "+_("BS[0].last_updated")+"</p> <p class = 'pibutton'><a href='mailto:"+_("BS[0].email")+"'>Email for more information</a> </p>"},workingagebenefits:{title:"Working Age benefits",info:"Benefits included are: UC, JSA, IS and ESA<p class = 'pibutton'>Access data at: <a href='"+_("BS[0].dataset_url")+"'>"+_("BS[0].title")+"</a></p><p class = 'pibutton'>Last updated: "+_("BS[0].last_updated")+"</p> <p class = 'pibutton'><a href='mailto:"+_("BS[0].email")+"'>Email for more information</a> </p>"},disabilitybenefits:{title:"Disability and Carer’s benefits",info:"Benefits included are: PIP, CA, AA and DLA<p class = 'pibutton'>Access data at:  <a href='"+_("BS[0].dataset_url")+"'>"+_("BS[0].title")+"</a></p><p class = 'pibutton'>Last updated: "+_("BS[0].last_updated")+"</p> <p class = 'pibutton'><a href='mailto:"+_("BS[0].email")+"'>Email for more information</a> </p>"},enrollments:{title:"People in education",info:"<p class = 'pibutton'>Access data at: <a href='"+_("Primary[0].dataset_url")+"'>"+_("Primary[0].title")+"</a>, <a href='"+_("PostPrimary[0].dataset_url")+"'>"+_("PostPrimary[0].title")+"</a>,  <a href='"+_("FE[0].dataset_url")+"'>"+_("FE[0].title")+"</a> and <a href='"+_("HE[0].dataset_url")+"'>"+_("HE[0].title")+"</a></p>"},fsme:{title:"Pupils entitled to Free School Meals",info:"<p class = 'pibutton'>Access data at: <a href='"+_("Primary[0].dataset_url")+"'>"+_("Primary[0].title")+"</a> and <a href='"+_("PostPrimary[0].dataset_url")+"'>"+_("PostPrimary[0].title")+"</a></p><p class = 'pibutton'>Last updated: "+_("Primary[0].last_updated")+"</p> <p class = 'pibutton'><a href='mailto:"+_("Primary[0].email")+"'>Email for more information</a> </p>"},teachers:{title:"School class size",info:"<p class = 'pibutton'>Access data at: <a href='"+_("ClassSize[0].dataset_url")+"'>"+_("ClassSize[0].title")+"</a></p><p class = 'pibutton'>Last updated: "+_("ClassSize[0].last_updated")+"</p> <p class = 'pibutton'><a href='mailto:"+_("ClassSize[0].email")+"'>Email for more information</a> </p>"},qualifications:{title:"Highest level of qualifications in the population",info:"<p>From Census 2021 data - <a href='https://explore.nisra.gov.uk/area-explorer-2021/'><strong>Census Area Explorer</strong></a></p>Needs tidied up with proper CSS.   The highest level of qualification categories are as follows:No qualifications;Level 1: 1 to 4 GCSEs, O levels, CSEs (any grades); 1 AS Level; NVQ level 1; or equivalent;Level 2: 5 or more GCSEs (A*-C or 9-4), O levels (passes) CSEs (grade 1); 1 A level, 2-3 AS Levels; NVQ level 2, BTEC General, City and Guilds Craft; or equivalent;Apprenticeship; Level 3: 2 or more A Levels, 4 or more AS Levels; NVQ Level 3, BTEC National, OND, ONC, City and Guilds Advanced Craft; or equivalent; Level 4 and above: Degree (BA, BSc), foundation degree, NVQ Level 4 and above, HND, HNC, professional qualifications (teaching or nursing, for example), or equivalent; and Other: Other qualifications, equivalent unknown.Highest level of qualification is derived from the question asking people aged 16 years and over to indicate all qualifications held. For qualifications gained outside Northern Ireland, respondents were directed to select the nearest equivalent."},attainment:{title:"GCSEs for school leavers",info:" <p class = 'pibutton'>Access data at: <a href='"+_("Attainment[0].dataset_url")+"'>"+_("Attainment[0].title")+"</a></p><p class = 'pibutton'>Last updated: "+_("Attainment[0].last_updated")+"</p><p class = 'pibutton'><a href='mailto:"+_("Attainment[0].email")+"'>Email for more information</a> </p>"},empty:{title:"",info:""},destination:{title:"Next steps for school leavers",info:"<p class = 'pibutton'><a href='mailto:"+_("Destination[0].email")+"'>Email for more information</a> </p><p class = 'pibutton'>Last updated: "+_("Destination[0].last_updated")+"</p>  <p class = 'pibutton'>Access data at: <a href='"+_("Destination[0].dataset_url")+"'>"+_("Destination[0].title")+"</a></p>"},popchange:{title:"Population change",info:"<p class = 'pibutton'><a href='mailto:"+_("PopChange[0].email")+"'>Email for more information</a> </p><p class = 'pibutton'>Last updated: "+_("PopChange[0].last_updated")+"</p>  <p class = 'pibutton'>Access data at: <a href='"+_("PopChange[0].dataset_url")+"'>"+_("PopChange[0].title")+"</a></p>"},broadage:{title:"Age",info:"<p class = 'pibutton'><a href='mailto:"+_("BroadAge[0].email")+"'>Email for more information</a> </p><p class = 'pibutton'>Last updated: "+_("BroadAge[0].last_updated")+"</p>  <p class = 'pibutton'>Access data at: <a href='"+_("BroadAge[0].dataset_url")+"'>"+_("BroadAge[0].title")+"</a></p>"},sex:{title:"Sex",info:"words to be added"},hhsize:{title:"Household size",info:"<p>From Census 2021 data - <a href='https://explore.nisra.gov.uk/area-explorer-2021/'><strong>Census Area Explorer</strong></a></p>The number of usual residents in the household.      <a href='https://www.nisra.gov.uk/publications/census-2021-statistical-bulletins'><strong>Statistical bulletins</strong></a>"},religion:{title:"Religion, Religion brought up in",info:"<p>From Census 2021 data - <a href='https://explore.nisra.gov.uk/area-explorer-2021/'><strong>Census Area Explorer</strong></a></p>The religious group the person belongs to or for people with no current religion their religious group of upbringing.People with no current religion and no religion of upbringing are labelled 'None'.<a href='https://www.nisra.gov.uk/publications/census-2021-statistical-bulletins'><strong>Statistical bulletins</strong></a>"},language:{title:"Main language",info:"<p>From Census 2021 data - <a href='https://explore.nisra.gov.uk/area-explorer-2021/'><strong>Census Area Explorer</strong></a></p>Person's main language as declared in the Census.Statistics for all language questions are restrictedto persons aged 3 and over. <ahref='https://www.nisra.gov.uk/publications/census-2021-statistical-bulletins'><strong>Statistical bulletins</strong></a>"},households:{title:"Households - box with numbers",info:"<p>From Census 2021 data - <a href='https://explore.nisra.gov.uk/area-explorer-2021/'><strong>Census Area Explorer</strong></a></p>A household is either one person living alone or a group of people living at the same address who share cooking facilities and share a living room, sitting room or dining area. <a href='https://www.nisra.gov.uk/publications/census-2021-statistical-bulletins'><strong>Statistical bulletins</strong></a>"}};return u.$$set=I=>{"id"in I&&d(0,p=I.id),"place"in I&&d(2,y=I.place)},[p,a,y]}class l1 extends mn{constructor(h){super(),yn(this,h,s1,o1,gn,{id:0,place:2})}}function u1(u){let h;return{c(){h=je("h3"),this.h()},l(d){h=Ge(d,"H3",{style:!0});var p=Ve(h);p.forEach(ae),this.h()},h(){Je(h,"margin","0 0 10px 0")},m(d,p){Be(d,h,p),h.innerHTML=u[9]},p(d,p){p&512&&(h.innerHTML=d[9])},i:pi,o:pi,d(d){d&&ae(h)}}}function c1(u){let h,d;return h=new l1({props:{id:u[0],place:u[2]}}),{c(){ir(h.$$.fragment)},l(p){nr(h.$$.fragment,p)},m(p,y){ar(h,p,y),d=!0},p(p,y){const _={};y&1&&(_.id=p[0]),y&4&&(_.place=p[2]),h.$set(_)},i(p){d||(tt(h.$$.fragment,p),d=!0)},o(p){ut(h.$$.fragment,p),d=!1},d(p){or(h,p)}}}function Bm(u){let h,d;return{c(){h=je("div"),d=Vt(u[12]),this.h()},l(p){h=Ge(p,"DIV",{class:!0});var y=Ve(h);d=Ut(y,u[12]),y.forEach(ae),this.h()},h(){ne(h,"class","text-small")},m(p,y){Be(p,h,y),Ae(h,d)},p(p,y){y&4096&&Mr(d,p[12])},d(p){p&&ae(h)}}}function h1(u){let h,d;return{c(){h=new Ll(!1),d=ur(),this.h()},l(p){h=Rl(p,!1),d=ur(),this.h()},h(){h.a=d},m(p,y){h.m(u[3],p,y),Be(p,d,y)},p(p,y){y&8&&h.p(p[3])},i:pi,o:pi,d(p){p&&ae(d),p&&h.d()}}}function p1(u){let h,d=u[3][u[2].type]+"",p;return{c(){h=new Ll(!1),p=ur(),this.h()},l(y){h=Rl(y,!1),p=ur(),this.h()},h(){h.a=p},m(y,_){h.m(d,y,_),Be(y,p,_)},p(y,_){_&12&&d!==(d=y[3][y[2].type]+"")&&h.p(d)},i:pi,o:pi,d(y){y&&ae(p),y&&h.d()}}}function f1(u){let h,d,p,y,_,a,I;const T=[x1,b1,v1,_1],D=[];function F(M,L){return L&1040&&(h=null),L&1040&&(d=null),L&1040&&(p=null),h==null&&(h=!!(M[4].hasOwnProperty("none")&M[10]==null)),h?0:(d==null&&(d=!!(M[4].hasOwnProperty("prev")&M[10]=="prev")),d?1:(p==null&&(p=!!(M[4].hasOwnProperty("ni")&M[10]=="ni")),p?2:3))}return y=F(u,-1),_=D[y]=T[y](u),{c(){_.c(),a=ur()},l(M){_.l(M),a=ur()},m(M,L){D[y].m(M,L),Be(M,a,L),I=!0},p(M,L){let X=y;y=F(M,L),y===X?D[y].p(M,L):(En(),ut(D[X],1,1,()=>{D[X]=null}),Tn(),_=D[y],_?_.p(M,L):(_=D[y]=T[y](M),_.c()),tt(_,1),_.m(a.parentNode,a))},i(M){I||(tt(_),I=!0)},o(M){ut(_),I=!1},d(M){D[y].d(M),M&&ae(a)}}}function d1(u){let h,d,p,y,_,a,I;const T=[E1,k1,S1,w1],D=[];function F(M,L){return L&1040&&(h=null),L&1040&&(d=null),L&1040&&(p=null),h==null&&(h=!!(M[4].hasOwnProperty("none")&M[10]==null)),h?0:(d==null&&(d=!!(M[4].hasOwnProperty("prev")&M[10]=="prev")),d?1:(p==null&&(p=!!(M[4].hasOwnProperty("ni")&M[10]=="ni")),p?2:3))}return y=F(u,-1),_=D[y]=T[y](u),{c(){_.c(),a=ur()},l(M){_.l(M),a=ur()},m(M,L){D[y].m(M,L),Be(M,a,L),I=!0},p(M,L){let X=y;y=F(M,L),y===X?D[y].p(M,L):(En(),ut(D[X],1,1,()=>{D[X]=null}),Tn(),_=D[y],_?_.p(M,L):(_=D[y]=T[y](M),_.c()),tt(_,1),_.m(a.parentNode,a))},i(M){I||(tt(_),I=!0)},o(M){ut(_),I=!1},d(M){D[y].d(M),M&&ae(a)}}}function m1(u){let h,d,p,y,_,a,I;const T=[z1,A1,I1,T1],D=[];function F(M,L){return L&1040&&(h=null),L&1040&&(d=null),L&1040&&(p=null),h==null&&(h=!!(M[4].hasOwnProperty("none")&M[10]==null)),h?0:(d==null&&(d=!!(M[4].hasOwnProperty("prev")&M[10]=="prev")),d?1:(p==null&&(p=!!(M[4].hasOwnProperty("ni")&M[10]=="ni")),p?2:3))}return y=F(u,-1),_=D[y]=T[y](u),{c(){_.c(),a=ur()},l(M){_.l(M),a=ur()},m(M,L){D[y].m(M,L),Be(M,a,L),I=!0},p(M,L){let X=y;y=F(M,L),y===X?D[y].p(M,L):(En(),ut(D[X],1,1,()=>{D[X]=null}),Tn(),_=D[y],_?_.p(M,L):(_=D[y]=T[y](M),_.c()),tt(_,1),_.m(a.parentNode,a))},i(M){I||(tt(_),I=!0)},o(M){ut(_),I=!1},d(M){D[y].d(M),M&&ae(a)}}}function y1(u){let h,d,p,y,_,a,I;const T=[D1,M1,C1,P1],D=[];function F(M,L){return L&1040&&(h=null),L&1040&&(d=null),L&1040&&(p=null),h==null&&(h=!!(M[4].hasOwnProperty("none")&M[10]==null)),h?0:(d==null&&(d=!!(M[4].hasOwnProperty("prev")&M[10]=="prev")),d?1:(p==null&&(p=!!(M[4].hasOwnProperty("ni")&M[10]=="ni")),p?2:3))}return y=F(u,-1),_=D[y]=T[y](u),{c(){_.c(),a=ur()},l(M){_.l(M),a=ur()},m(M,L){D[y].m(M,L),Be(M,a,L),I=!0},p(M,L){let X=y;y=F(M,L),y===X?D[y].p(M,L):(En(),ut(D[X],1,1,()=>{D[X]=null}),Tn(),_=D[y],_?_.p(M,L):(_=D[y]=T[y](M),_.c()),tt(_,1),_.m(a.parentNode,a))},i(M){I||(tt(_),I=!0)},o(M){ut(_),I=!1},d(M){D[y].d(M),M&&ae(a)}}}function g1(u){let h,d,p,y,_,a,I;const T=[O1,B1,R1,L1],D=[];function F(M,L){return L&1040&&(h=null),L&1040&&(d=null),L&1040&&(p=null),h==null&&(h=!!(M[4].hasOwnProperty("none")&M[10]==null)),h?0:(d==null&&(d=!!(M[4].hasOwnProperty("prev")&M[10]=="prev")),d?1:(p==null&&(p=!!(M[4].hasOwnProperty("ni")&M[10]=="ni")),p?2:3))}return y=F(u,-1),_=D[y]=T[y](u),{c(){_.c(),a=ur()},l(M){_.l(M),a=ur()},m(M,L){D[y].m(M,L),Be(M,a,L),I=!0},p(M,L){let X=y;y=F(M,L),y===X?D[y].p(M,L):(En(),ut(D[X],1,1,()=>{D[X]=null}),Tn(),_=D[y],_?_.p(M,L):(_=D[y]=T[y](M),_.c()),tt(_,1),_.m(a.parentNode,a))},i(M){I||(tt(_),I=!0)},o(M){ut(_),I=!1},d(M){D[y].d(M),M&&ae(a)}}}function _1(u){let h,d;return h=new Dh({props:{data:u[4],zKey:u[5]}}),{c(){ir(h.$$.fragment)},l(p){nr(h.$$.fragment,p)},m(p,y){ar(h,p,y),d=!0},p(p,y){const _={};y&16&&(_.data=p[4]),y&32&&(_.zKey=p[5]),h.$set(_)},i(p){d||(tt(h.$$.fragment,p),d=!0)},o(p){ut(h.$$.fragment,p),d=!1},d(p){or(h,p)}}}function v1(u){let h,d;return h=new Dh({props:{data:u[4].ni,zKey:u[5]}}),{c(){ir(h.$$.fragment)},l(p){nr(h.$$.fragment,p)},m(p,y){ar(h,p,y),d=!0},p(p,y){const _={};y&16&&(_.data=p[4].ni),y&32&&(_.zKey=p[5]),h.$set(_)},i(p){d||(tt(h.$$.fragment,p),d=!0)},o(p){ut(h.$$.fragment,p),d=!1},d(p){or(h,p)}}}function b1(u){let h,d;return h=new Dh({props:{data:u[4].prev,zKey:u[5]}}),{c(){ir(h.$$.fragment)},l(p){nr(h.$$.fragment,p)},m(p,y){ar(h,p,y),d=!0},p(p,y){const _={};y&16&&(_.data=p[4].prev),y&32&&(_.zKey=p[5]),h.$set(_)},i(p){d||(tt(h.$$.fragment,p),d=!0)},o(p){ut(h.$$.fragment,p),d=!1},d(p){or(h,p)}}}function x1(u){let h,d;return h=new Dh({props:{data:u[4].none,zKey:u[5]}}),{c(){ir(h.$$.fragment)},l(p){nr(h.$$.fragment,p)},m(p,y){ar(h,p,y),d=!0},p(p,y){const _={};y&16&&(_.data=p[4].none),y&32&&(_.zKey=p[5]),h.$set(_)},i(p){d||(tt(h.$$.fragment,p),d=!0)},o(p){ut(h.$$.fragment,p),d=!1},d(p){or(h,p)}}}function w1(u){let h,d;return h=new Bh({props:{data:u[4],zKey:u[5],label:u[6]}}),{c(){ir(h.$$.fragment)},l(p){nr(h.$$.fragment,p)},m(p,y){ar(h,p,y),d=!0},p(p,y){const _={};y&16&&(_.data=p[4]),y&32&&(_.zKey=p[5]),y&64&&(_.label=p[6]),h.$set(_)},i(p){d||(tt(h.$$.fragment,p),d=!0)},o(p){ut(h.$$.fragment,p),d=!1},d(p){or(h,p)}}}function S1(u){let h,d;return h=new Bh({props:{data:u[4].ni,zKey:u[5],label:u[6]}}),{c(){ir(h.$$.fragment)},l(p){nr(h.$$.fragment,p)},m(p,y){ar(h,p,y),d=!0},p(p,y){const _={};y&16&&(_.data=p[4].ni),y&32&&(_.zKey=p[5]),y&64&&(_.label=p[6]),h.$set(_)},i(p){d||(tt(h.$$.fragment,p),d=!0)},o(p){ut(h.$$.fragment,p),d=!1},d(p){or(h,p)}}}function k1(u){let h,d;return h=new Bh({props:{data:u[4].prev,zKey:u[5],label:u[6]}}),{c(){ir(h.$$.fragment)},l(p){nr(h.$$.fragment,p)},m(p,y){ar(h,p,y),d=!0},p(p,y){const _={};y&16&&(_.data=p[4].prev),y&32&&(_.zKey=p[5]),y&64&&(_.label=p[6]),h.$set(_)},i(p){d||(tt(h.$$.fragment,p),d=!0)},o(p){ut(h.$$.fragment,p),d=!1},d(p){or(h,p)}}}function E1(u){let h,d;return h=new Bh({props:{data:u[4].none,zKey:u[5],label:u[6]}}),{c(){ir(h.$$.fragment)},l(p){nr(h.$$.fragment,p)},m(p,y){ar(h,p,y),d=!0},p(p,y){const _={};y&16&&(_.data=p[4].none),y&32&&(_.zKey=p[5]),y&64&&(_.label=p[6]),h.$set(_)},i(p){d||(tt(h.$$.fragment,p),d=!0)},o(p){ut(h.$$.fragment,p),d=!1},d(p){or(h,p)}}}function T1(u){let h,d;return h=new Oh({props:{data:u[4],zKey:u[5],label:u[6]}}),{c(){ir(h.$$.fragment)},l(p){nr(h.$$.fragment,p)},m(p,y){ar(h,p,y),d=!0},p(p,y){const _={};y&16&&(_.data=p[4]),y&32&&(_.zKey=p[5]),y&64&&(_.label=p[6]),h.$set(_)},i(p){d||(tt(h.$$.fragment,p),d=!0)},o(p){ut(h.$$.fragment,p),d=!1},d(p){or(h,p)}}}function I1(u){let h,d;return h=new Oh({props:{data:u[4].ni,zKey:u[5],label:u[6]}}),{c(){ir(h.$$.fragment)},l(p){nr(h.$$.fragment,p)},m(p,y){ar(h,p,y),d=!0},p(p,y){const _={};y&16&&(_.data=p[4].ni),y&32&&(_.zKey=p[5]),y&64&&(_.label=p[6]),h.$set(_)},i(p){d||(tt(h.$$.fragment,p),d=!0)},o(p){ut(h.$$.fragment,p),d=!1},d(p){or(h,p)}}}function A1(u){let h,d;return h=new Oh({props:{data:u[4].prev,zKey:u[5],label:u[6]}}),{c(){ir(h.$$.fragment)},l(p){nr(h.$$.fragment,p)},m(p,y){ar(h,p,y),d=!0},p(p,y){const _={};y&16&&(_.data=p[4].prev),y&32&&(_.zKey=p[5]),y&64&&(_.label=p[6]),h.$set(_)},i(p){d||(tt(h.$$.fragment,p),d=!0)},o(p){ut(h.$$.fragment,p),d=!1},d(p){or(h,p)}}}function z1(u){let h,d;return h=new Oh({props:{data:u[4].none,zKey:u[5],label:u[6]}}),{c(){ir(h.$$.fragment)},l(p){nr(h.$$.fragment,p)},m(p,y){ar(h,p,y),d=!0},p(p,y){const _={};y&16&&(_.data=p[4].none),y&32&&(_.zKey=p[5]),y&64&&(_.label=p[6]),h.$set(_)},i(p){d||(tt(h.$$.fragment,p),d=!0)},o(p){ut(h.$$.fragment,p),d=!1},d(p){or(h,p)}}}function P1(u){let h,d;return h=new Rh({props:{data:u[4],zKey:"group"}}),{c(){ir(h.$$.fragment)},l(p){nr(h.$$.fragment,p)},m(p,y){ar(h,p,y),d=!0},p(p,y){const _={};y&16&&(_.data=p[4]),h.$set(_)},i(p){d||(tt(h.$$.fragment,p),d=!0)},o(p){ut(h.$$.fragment,p),d=!1},d(p){or(h,p)}}}function C1(u){let h,d;return h=new Rh({props:{data:u[4].ni,zKey:"group"}}),{c(){ir(h.$$.fragment)},l(p){nr(h.$$.fragment,p)},m(p,y){ar(h,p,y),d=!0},p(p,y){const _={};y&16&&(_.data=p[4].ni),h.$set(_)},i(p){d||(tt(h.$$.fragment,p),d=!0)},o(p){ut(h.$$.fragment,p),d=!1},d(p){or(h,p)}}}function M1(u){let h,d;return h=new Rh({props:{data:u[4].prev,zKey:"group"}}),{c(){ir(h.$$.fragment)},l(p){nr(h.$$.fragment,p)},m(p,y){ar(h,p,y),d=!0},p(p,y){const _={};y&16&&(_.data=p[4].prev),h.$set(_)},i(p){d||(tt(h.$$.fragment,p),d=!0)},o(p){ut(h.$$.fragment,p),d=!1},d(p){or(h,p)}}}function D1(u){let h,d;return h=new Rh({props:{data:u[4].none,zKey:"group"}}),{c(){ir(h.$$.fragment)},l(p){nr(h.$$.fragment,p)},m(p,y){ar(h,p,y),d=!0},p(p,y){const _={};y&16&&(_.data=p[4].none),h.$set(_)},i(p){d||(tt(h.$$.fragment,p),d=!0)},o(p){ut(h.$$.fragment,p),d=!1},d(p){or(h,p)}}}function L1(u){let h,d;return h=new Lh({props:{data:u[4],zKey:u[5],label:u[6],topic_prev_available:u[7]}}),{c(){ir(h.$$.fragment)},l(p){nr(h.$$.fragment,p)},m(p,y){ar(h,p,y),d=!0},p(p,y){const _={};y&16&&(_.data=p[4]),y&32&&(_.zKey=p[5]),y&64&&(_.label=p[6]),y&128&&(_.topic_prev_available=p[7]),h.$set(_)},i(p){d||(tt(h.$$.fragment,p),d=!0)},o(p){ut(h.$$.fragment,p),d=!1},d(p){or(h,p)}}}function R1(u){let h,d;return h=new Lh({props:{data:u[4].ni,zKey:u[5],label:u[6],topic_prev_available:u[7]}}),{c(){ir(h.$$.fragment)},l(p){nr(h.$$.fragment,p)},m(p,y){ar(h,p,y),d=!0},p(p,y){const _={};y&16&&(_.data=p[4].ni),y&32&&(_.zKey=p[5]),y&64&&(_.label=p[6]),y&128&&(_.topic_prev_available=p[7]),h.$set(_)},i(p){d||(tt(h.$$.fragment,p),d=!0)},o(p){ut(h.$$.fragment,p),d=!1},d(p){or(h,p)}}}function B1(u){let h,d;return h=new Lh({props:{data:u[4].prev,zKey:u[5],label:u[6],topic_prev_available:u[7]}}),{c(){ir(h.$$.fragment)},l(p){nr(h.$$.fragment,p)},m(p,y){ar(h,p,y),d=!0},p(p,y){const _={};y&16&&(_.data=p[4].prev),y&32&&(_.zKey=p[5]),y&64&&(_.label=p[6]),y&128&&(_.topic_prev_available=p[7]),h.$set(_)},i(p){d||(tt(h.$$.fragment,p),d=!0)},o(p){ut(h.$$.fragment,p),d=!1},d(p){or(h,p)}}}function O1(u){let h,d;return h=new Lh({props:{data:u[4].none,zKey:u[5],label:u[6],topic_prev_available:u[7]}}),{c(){ir(h.$$.fragment)},l(p){nr(h.$$.fragment,p)},m(p,y){ar(h,p,y),d=!0},p(p,y){const _={};y&16&&(_.data=p[4].none),y&32&&(_.zKey=p[5]),y&64&&(_.label=p[6]),y&128&&(_.topic_prev_available=p[7]),h.$set(_)},i(p){d||(tt(h.$$.fragment,p),d=!0)},o(p){ut(h.$$.fragment,p),d=!1},d(p){or(h,p)}}}function Om(u){let h,d,p,y=u[11][u[2].type]+"";return{c(){h=je("br"),d=bt(),p=je("span"),this.h()},l(_){h=Ge(_,"BR",{}),d=xt(_),p=Ge(_,"SPAN",{class:!0});var a=Ve(p);a.forEach(ae),this.h()},h(){ne(p,"class","text-small")},m(_,a){Be(_,h,a),Be(_,d,a),Be(_,p,a),p.innerHTML=y},p(_,a){a&2052&&y!==(y=_[11][_[2].type]+"")&&(p.innerHTML=y)},d(_){_&&ae(h),_&&ae(d),_&&ae(p)}}}function F1(u){let h,d,p,y,_,a,I,T,D,F,M,L,X,oe,se,pe;const xe=[c1,u1],be=[];function ct(Ue,Ke){return Ue[8]==!0|Ue[8]==null?0:1}d=ct(u),p=be[d]=xe[d](u);let We=u[12]!=null&&Bm(u);const De=[g1,y1,m1,d1,f1,p1,h1],Ze=[];function Dt(Ue,Ke){return Ke&12&&(a=null),Ke&12&&(I=null),Ke&12&&(T=null),Ke&12&&(D=null),Ke&12&&(F=null),Ke&12&&(M=null),a==null&&(a=!!(Ue[3]=="StackedBarChart"|Ue[3].hasOwnProperty(Ue[2].type)&Ue[3][Ue[2].type]=="StackedBarChart")),a?0:(I==null&&(I=!!(Ue[3]=="GroupChart"|Ue[3].hasOwnProperty(Ue[2].type)&Ue[3][Ue[2].type]=="GroupChart")),I?1:(T==null&&(T=!!(Ue[3]=="ProfileChart"|Ue[3].hasOwnProperty(Ue[2].type)&Ue[3][Ue[2].type]=="ProfileChart")),T?2:(D==null&&(D=!!(Ue[3]=="BarChart"|Ue[3].hasOwnProperty(Ue[2].type)&Ue[3][Ue[2].type]=="BarChart")),D?3:(F==null&&(F=!!(Ue[3]=="ColChart"|Ue[3].hasOwnProperty(Ue[2].type)&Ue[3][Ue[2].type]=="ColChart")),F?4:(M==null&&(M=!!Ue[3].hasOwnProperty(Ue[2].type)),M?5:6)))))}L=Dt(u,-1),X=Ze[L]=De[L](u);let zt=u[11]!=null&u[10]!=null&&Om(u);return{c(){h=je("div"),p.c(),y=bt(),We&&We.c(),_=bt(),X.c(),oe=bt(),zt&&zt.c(),this.h()},l(Ue){h=Ge(Ue,"DIV",{class:!0,style:!0});var Ke=Ve(h);p.l(Ke),y=xt(Ke),We&&We.l(Ke),_=xt(Ke),X.l(Ke),oe=xt(Ke),zt&&zt.l(Ke),Ke.forEach(ae),this.h()},h(){ne(h,"class",se=Fm(u[0])),ne(h,"style",u[1])},m(Ue,Ke){Be(Ue,h,Ke),be[d].m(h,null),Ae(h,y),We&&We.m(h,null),Ae(h,_),Ze[L].m(h,null),Ae(h,oe),zt&&zt.m(h,null),pe=!0},p(Ue,[Ke]){let vt=d;d=ct(Ue),d===vt?be[d].p(Ue,Ke):(En(),ut(be[vt],1,1,()=>{be[vt]=null}),Tn(),p=be[d],p?p.p(Ue,Ke):(p=be[d]=xe[d](Ue),p.c()),tt(p,1),p.m(h,y)),Ue[12]!=null?We?We.p(Ue,Ke):(We=Bm(Ue),We.c(),We.m(h,_)):We&&(We.d(1),We=null);let cr=L;L=Dt(Ue,Ke),L===cr?Ze[L].p(Ue,Ke):(En(),ut(Ze[cr],1,1,()=>{Ze[cr]=null}),Tn(),X=Ze[L],X?X.p(Ue,Ke):(X=Ze[L]=De[L](Ue),X.c()),tt(X,1),X.m(h,oe)),Ue[11]!=null&Ue[10]!=null?zt?zt.p(Ue,Ke):(zt=Om(Ue),zt.c(),zt.m(h,null)):zt&&(zt.d(1),zt=null),(!pe||Ke&1&&se!==(se=Fm(Ue[0])))&&ne(h,"class",se),(!pe||Ke&2)&&ne(h,"style",Ue[1])},i(Ue){pe||(tt(p),tt(X),pe=!0)},o(Ue){ut(p),ut(X),pe=!1},d(Ue){Ue&&ae(h),be[d].d(),We&&We.d(),Ze[L].d(),zt&&zt.d()}}}function Fm(u){return u=="empty"?"":"div-grey-box"}function N1(u,h,d){let{id:p}=h,{style:y=""}=h,{place:_}=h,{content:a}=h,{chart_data:I=null}=h,{zKey:T="ni"}=h,{label:D=null}=h,{topic_prev_available:F=!0}=h,{i_button:M=!0}=h,{heading:L=null}=h,{chart_compare_type:X}=h,{compare_content:oe=null}=h,{year:se=null}=h;return u.$$set=pe=>{"id"in pe&&d(0,p=pe.id),"style"in pe&&d(1,y=pe.style),"place"in pe&&d(2,_=pe.place),"content"in pe&&d(3,a=pe.content),"chart_data"in pe&&d(4,I=pe.chart_data),"zKey"in pe&&d(5,T=pe.zKey),"label"in pe&&d(6,D=pe.label),"topic_prev_available"in pe&&d(7,F=pe.topic_prev_available),"i_button"in pe&&d(8,M=pe.i_button),"heading"in pe&&d(9,L=pe.heading),"chart_compare_type"in pe&&d(10,X=pe.chart_compare_type),"compare_content"in pe&&d(11,oe=pe.compare_content),"year"in pe&&d(12,se=pe.year)},[p,y,_,a,I,T,D,F,M,L,X,oe,se]}class Lu extends mn{constructor(h){super(),yn(this,h,N1,F1,gn,{id:0,style:1,place:2,content:3,chart_data:4,zKey:5,label:6,topic_prev_available:7,i_button:8,heading:9,chart_compare_type:10,compare_content:11,year:12})}}function Nm(u,h,d){const p=u.slice();return p[13]=h[d],p[15]=d,p}function Vm(u){let h=u[6][u[10][u[15]]].show.includes(u[3].type),d,p,y=h&&Um(u);return{c(){y&&y.c(),d=ur()},l(_){y&&y.l(_),d=ur()},m(_,a){y&&y.m(_,a),Be(_,d,a),p=!0},p(_,a){a&72&&(h=_[6][_[10][_[15]]].show.includes(_[3].type)),h?y?(y.p(_,a),a&72&&tt(y,1)):(y=Um(_),y.c(),tt(y,1),y.m(d.parentNode,d)):y&&(En(),ut(y,1,1,()=>{y=null}),Tn())},i(_){p||(tt(y),p=!0)},o(_){ut(y),p=!1},d(_){y&&y.d(_),_&&ae(d)}}}function Um(u){let h,d;return h=new Lu({props:{id:u[6][u[10][u[15]]].id,style:u[6][u[10][u[15]]].style,place:u[3],year:u[6][u[10][u[15]]].year,content:u[6][u[10][u[15]]].content,chart_data:u[6][u[10][u[15]]].chart_data,zKey:u[6][u[10][u[15]]].zKey,label:u[6][u[10][u[15]]].label,topic_prev_available:u[6][u[10][u[15]]].topic_prev_available,chart_compare_type:u[8],i_button:u[6][u[10][u[15]]].i_button}}),{c(){ir(h.$$.fragment)},l(p){nr(h.$$.fragment,p)},m(p,y){ar(h,p,y),d=!0},p(p,y){const _={};y&64&&(_.id=p[6][p[10][p[15]]].id),y&64&&(_.style=p[6][p[10][p[15]]].style),y&8&&(_.place=p[3]),y&64&&(_.year=p[6][p[10][p[15]]].year),y&64&&(_.content=p[6][p[10][p[15]]].content),y&64&&(_.chart_data=p[6][p[10][p[15]]].chart_data),y&64&&(_.zKey=p[6][p[10][p[15]]].zKey),y&64&&(_.label=p[6][p[10][p[15]]].label),y&64&&(_.topic_prev_available=p[6][p[10][p[15]]].topic_prev_available),y&256&&(_.chart_compare_type=p[8]),y&64&&(_.i_button=p[6][p[10][p[15]]].i_button),h.$set(_)},i(p){d||(tt(h.$$.fragment,p),d=!0)},o(p){ut(h.$$.fragment,p),d=!1},d(p){or(h,p)}}}function qm(u){let h,d;return h=new Lu({props:{id:u[6][u[10][u[15]]].id,style:u[6][u[10][u[15]]].style,place:u[3],year:u[6][u[10][u[15]]].year,content:u[6][u[10][u[15]]].content,chart_data:u[6][u[10][u[15]]].chart_data,zKey:u[6][u[10][u[15]]].zKey,label:u[6][u[10][u[15]]].label,topic_prev_available:u[6][u[10][u[15]]].topic_prev_available,chart_compare_type:u[8],i_button:u[6][u[10][u[15]]].i_button}}),{c(){ir(h.$$.fragment)},l(p){nr(h.$$.fragment,p)},m(p,y){ar(h,p,y),d=!0},p(p,y){const _={};y&64&&(_.id=p[6][p[10][p[15]]].id),y&64&&(_.style=p[6][p[10][p[15]]].style),y&8&&(_.place=p[3]),y&64&&(_.year=p[6][p[10][p[15]]].year),y&64&&(_.content=p[6][p[10][p[15]]].content),y&64&&(_.chart_data=p[6][p[10][p[15]]].chart_data),y&64&&(_.zKey=p[6][p[10][p[15]]].zKey),y&64&&(_.label=p[6][p[10][p[15]]].label),y&64&&(_.topic_prev_available=p[6][p[10][p[15]]].topic_prev_available),y&256&&(_.chart_compare_type=p[8]),y&64&&(_.i_button=p[6][p[10][p[15]]].i_button),h.$set(_)},i(p){d||(tt(h.$$.fragment,p),d=!0)},o(p){ut(h.$$.fragment,p),d=!1},d(p){or(h,p)}}}function jm(u){let h=u[6][u[10][u[15]]].hasOwnProperty("show"),d,p=!u[6][u[10][u[15]]].hasOwnProperty("show"),y,_,a=h&&Vm(u),I=p&&qm(u);return{c(){a&&a.c(),d=bt(),I&&I.c(),y=ur()},l(T){a&&a.l(T),d=xt(T),I&&I.l(T),y=ur()},m(T,D){a&&a.m(T,D),Be(T,d,D),I&&I.m(T,D),Be(T,y,D),_=!0},p(T,D){D&64&&(h=T[6][T[10][T[15]]].hasOwnProperty("show")),h?a?(a.p(T,D),D&64&&tt(a,1)):(a=Vm(T),a.c(),tt(a,1),a.m(d.parentNode,d)):a&&(En(),ut(a,1,1,()=>{a=null}),Tn()),D&64&&(p=!T[6][T[10][T[15]]].hasOwnProperty("show")),p?I?(I.p(T,D),D&64&&tt(I,1)):(I=qm(T),I.c(),tt(I,1),I.m(y.parentNode,y)):I&&(En(),ut(I,1,1,()=>{I=null}),Tn())},i(T){_||(tt(a),tt(I),_=!0)},o(T){ut(a),ut(I),_=!1},d(T){a&&a.d(T),T&&ae(d),I&&I.d(T),T&&ae(y)}}}function Gm(u){let h,d,p,y;return{c(){h=je("h3"),d=Vt("More Statistics"),p=bt(),y=je("div"),this.h()},l(_){h=Ge(_,"H3",{});var a=Ve(h);d=Ut(a,"More Statistics"),a.forEach(ae),p=xt(_),y=Ge(_,"DIV",{class:!0});var I=Ve(y);I.forEach(ae),this.h()},h(){ne(y,"class","accordion-more svelte-9ol09s")},m(_,a){Be(_,h,a),Ae(h,d),Be(_,p,a),Be(_,y,a),y.innerHTML=u[7]},p(_,a){a&128&&(y.innerHTML=_[7])},d(_){_&&ae(h),_&&ae(p),_&&ae(y)}}}function V1(u){let h,d,p,y,_,a,I,T,D,F,M,L,X,oe,se=u[3].name+"",pe,xe,be=u[3].type.toLocaleUpperCase()+"",ct,We,De,Ze,Dt,zt,Ue,Ke,vt,cr,Ne,Rt,Me,$e={length:u[10].length},mt=[];for(let St=0;St<$e.length;St+=1)mt[St]=jm(Nm(u,$e,St));const qt=St=>ut(mt[St],1,1,()=>{mt[St]=null});let Bt=u[7]!=""&&Gm(u);return{c(){h=je("div"),d=je("h2"),p=je("button"),y=je("span"),_=je("img"),I=bt(),T=Vt(u[2]),L=bt(),X=je("div"),oe=je("div"),pe=Vt(se),xe=bt(),ct=Vt(be),We=Vt(" - "),De=new Ll(!1),Ze=bt(),Dt=je("span"),zt=Vt(u[5]),Ue=bt(),Ke=je("div");for(let St=0;St<mt.length;St+=1)mt[St].c();cr=bt(),Bt&&Bt.c(),this.h()},l(St){h=Ge(St,"DIV",{class:!0});var Oe=Ve(h);d=Ge(Oe,"H2",{class:!0,id:!0});var ot=Ve(d);p=Ge(ot,"BUTTON",{class:!0,type:!0,"data-bs-toggle":!0,"data-bs-target":!0,"aria-expanded":!0,"aria-controls":!0});var Dr=Ve(p);y=Ge(Dr,"SPAN",{class:!0});var Kr=Ve(y);_=Ge(Kr,"IMG",{src:!0,alt:!0,height:!0,class:!0}),I=xt(Kr),T=Ut(Kr,u[2]),Kr.forEach(ae),Dr.forEach(ae),ot.forEach(ae),L=xt(Oe),X=Ge(Oe,"DIV",{id:!0,class:!0,"aria-labelledby":!0});var vi=Ve(X);oe=Ge(vi,"DIV",{class:!0});var xr=Ve(oe);pe=Ut(xr,se),xe=xt(xr),ct=Ut(xr,be),We=Ut(xr," - "),De=Rl(xr,!1),Ze=xt(xr),Dt=Ge(xr,"SPAN",{class:!0});var er=Ve(Dt);zt=Ut(er,u[5]),er.forEach(ae),Ue=xt(xr),Ke=Ge(xr,"DIV",{class:!0});var Hr=Ve(Ke);for(let Jt=0;Jt<mt.length;Jt+=1)mt[Jt].l(Hr);Hr.forEach(ae),cr=xt(xr),Bt&&Bt.l(xr),xr.forEach(ae),vi.forEach(ae),Oe.forEach(ae),this.h()},h(){Cp(_.src,a=ha+"/img/"+u[1])||ne(_,"src",a),ne(_,"alt","logo"),ne(_,"height","40"),ne(_,"class","accordion-dept-logo"),ne(y,"class","accordion-button-title svelte-9ol09s"),ne(p,"class","accordion-button collapsed svelte-9ol09s"),ne(p,"type","button"),ne(p,"data-bs-toggle","collapse"),ne(p,"data-bs-target",D="#panelsStayOpen-collapse"+u[0]),ne(p,"aria-expanded","false"),ne(p,"aria-controls",F="panelsStayOpen-collapse"+u[0]),ne(d,"class","accordion-header svelte-9ol09s"),ne(d,"id",M="panelsStayOpen-heading"+u[0]),De.a=Ze,ne(Dt,"class","accordion-button-title-sub svelte-9ol09s"),ne(Ke,"class","grid mt svelte-9ol09s"),ju(()=>u[11].call(Ke)),ne(oe,"class","accordion-body svelte-9ol09s"),ne(X,"id",Ne="panelsStayOpen-collapse"+u[0]),ne(X,"class","accordion-collapse collapse svelte-9ol09s"),ne(X,"aria-labelledby",Rt="panelsStayOpen-heading"+u[0]),ne(h,"class","accordion-item svelte-9ol09s")},m(St,Oe){Be(St,h,Oe),Ae(h,d),Ae(d,p),Ae(p,y),Ae(y,_),Ae(y,I),Ae(y,T),Ae(h,L),Ae(h,X),Ae(X,oe),Ae(oe,pe),Ae(oe,xe),Ae(oe,ct),Ae(oe,We),De.m(u[4],oe),Ae(oe,Ze),Ae(oe,Dt),Ae(Dt,zt),Ae(oe,Ue),Ae(oe,Ke);for(let ot=0;ot<mt.length;ot+=1)mt[ot]&&mt[ot].m(Ke,null);vt=Gu(Ke,u[11].bind(Ke)),Ae(oe,cr),Bt&&Bt.m(oe,null),Me=!0},p(St,[Oe]){if((!Me||Oe&2&&!Cp(_.src,a=ha+"/img/"+St[1]))&&ne(_,"src",a),(!Me||Oe&4)&&Mr(T,St[2]),(!Me||Oe&1&&D!==(D="#panelsStayOpen-collapse"+St[0]))&&ne(p,"data-bs-target",D),(!Me||Oe&1&&F!==(F="panelsStayOpen-collapse"+St[0]))&&ne(p,"aria-controls",F),(!Me||Oe&1&&M!==(M="panelsStayOpen-heading"+St[0]))&&ne(d,"id",M),(!Me||Oe&8)&&se!==(se=St[3].name+"")&&Mr(pe,se),(!Me||Oe&8)&&be!==(be=St[3].type.toLocaleUpperCase()+"")&&Mr(ct,be),(!Me||Oe&16)&&De.p(St[4]),(!Me||Oe&32)&&Mr(zt,St[5]),Oe&1352){$e={length:St[10].length};let ot;for(ot=0;ot<$e.length;ot+=1){const Dr=Nm(St,$e,ot);mt[ot]?(mt[ot].p(Dr,Oe),tt(mt[ot],1)):(mt[ot]=jm(Dr),mt[ot].c(),tt(mt[ot],1),mt[ot].m(Ke,null))}for(En(),ot=$e.length;ot<mt.length;ot+=1)qt(ot);Tn()}St[7]!=""?Bt?Bt.p(St,Oe):(Bt=Gm(St),Bt.c(),Bt.m(oe,null)):Bt&&(Bt.d(1),Bt=null),(!Me||Oe&1&&Ne!==(Ne="panelsStayOpen-collapse"+St[0]))&&ne(X,"id",Ne),(!Me||Oe&1&&Rt!==(Rt="panelsStayOpen-heading"+St[0]))&&ne(X,"aria-labelledby",Rt)},i(St){if(!Me){for(let Oe=0;Oe<$e.length;Oe+=1)tt(mt[Oe]);Me=!0}},o(St){mt=mt.filter(Boolean);for(let Oe=0;Oe<mt.length;Oe+=1)ut(mt[Oe]);Me=!1},d(St){St&&ae(h),ln(mt,St),vt(),Bt&&Bt.d()}}}function U1(u,h,d){let{id:p}=h,{img:y}=h,{heading:_}=h,{place:a}=h,{sub_heading:I}=h,{description:T}=h,{boxes:D}=h,{more:F}=h,{chart_compare_type:M}=h,L=Object.keys(D),X;function oe(){X=this.clientWidth,d(9,X)}return u.$$set=se=>{"id"in se&&d(0,p=se.id),"img"in se&&d(1,y=se.img),"heading"in se&&d(2,_=se.heading),"place"in se&&d(3,a=se.place),"sub_heading"in se&&d(4,I=se.sub_heading),"description"in se&&d(5,T=se.description),"boxes"in se&&d(6,D=se.boxes),"more"in se&&d(7,F=se.more),"chart_compare_type"in se&&d(8,M=se.chart_compare_type)},[p,y,_,a,I,T,D,F,M,X,L,oe]}class Pl extends mn{constructor(h){super(),yn(this,h,U1,V1,gn,{id:0,img:1,heading:2,place:3,sub_heading:4,description:5,boxes:6,more:7,chart_compare_type:8})}}function Zm(u,h,d){const p=u.slice();return p[29]=h[d],p[31]=d,p}function Km(u,h,d){const p=u.slice();return p[32]=h[d],p[31]=d,p}function Hm(u,h,d){const p=u.slice();return p[34]=h[d],p}function Xm(u,h,d){const p=u.slice();return p[32]=h[d],p[31]=d,p}function Wm(u){let h,d,p,y,_,a,I=" &gt; ",T,D,F,M,L=u[0].place.name+"",X,oe,se,pe,xe,be,ct,We,De,Ze,Dt,zt,Ue,Ke,vt,cr,Ne,Rt,Me,$e,mt,qt,Bt,St,Oe,ot,Dr,Kr,vi,xr,er,Hr,Jt,ai,qi,en,Kt,ji,fi,$r,Xn,Ei,Lr,Ur,tn,bi,di,qr,rn,Xr,In,nn,Dn,Gi,Bi,ei=u[0].place.type!="ni"&&Ym(u);We=new s_({props:{search_data:u[0].search_data,group:"typestr",search:!0}}),We.$on("select",u[11]),St=new Lu({props:{id:"overview",i_button:!1,heading:"About "+u[0].place.name,place:u[0].place,style:"line-height: 1.3;",content:{ni:"Northern Ireland has 11 Local Government Districts (LGDs),  which can be subdivided into District Electoral Areas (DEAs), then further into Super Data Zones and Data Zones. Statistics can be viewed for these smaller areas.",lgd:u[0].place.name+" is one of "+u[0].place.count.toLocaleString()+" "+Zn[u[0].place.type].pl+".  It includes the larger settlements of "+u[0].place.lgd_location_description,dea:u[0].place.name+" is one of "+u[0].place.count.toLocaleString()+" "+Zn[u[0].place.type].pl+" in Northern Ireland.  It is within <a href = '/"+u[0].place.parents[0].code+"/' data-sveltekit-noscroll>"+u[0].place.parents[0].name+" </a> and covers "+u[0].place.dea_location_description+".",sdz:u[0].place.name+" is one of "+u[0].place.count.toLocaleString()+" "+Zn[u[0].place.type].pl+". Super Data Zones are new statistical areas developed for census. They are broadly similar in population size and housing type.",dz:u[0].place.name+" is one of "+u[0].place.count.toLocaleString()+" "+Zn[u[0].place.type].pl+".  Super Data Zones are smaller divisions of Data Zones. There are on average 4 in each Super Data Zone."},chart_compare_type:u[6]}}),ot=new Lu({props:{id:"pop",place:u[0].place,year:Wt("MYETotal",u[0].place),content:'<span class="text-big" style="font-size: 2.8em;">'+u[0].place.data.MYETotal.value.toLocaleString()+"</span>",chart_compare_type:u[6],compare_content:{ni:"",lgd:'<span class = "em" style = "background-color: lightgrey">'+mh(u[0].place.data.population.value[2021].all/u[0].ni.data.population.value[2021].all)+"</span> of Northern Ireland population<br>The "+u[12](u[0].place.data.population.value_rank[2021].all)+" population of 11 Local Government Districts",dea:'<span class = "em" style = "background-color: lightgrey">'+mh(u[0].place.data.population.value[2021].all/u[0].ni.data.population.value[2021].all)+"</span> of Northern Ireland population",sdz:"Data not available for area comparison",dz:" Data not available for area comparison"}}}),Kr=new Lu({props:{id:"popden",place:u[0].place,year:Wt("MYETotal",u[0].place),content:'<div class = "row" style = "display: flex; align-items: center"><div class="text-big" style="font-size: 2.8em;">'+ry(u[0].place)+'</div><div style = "margin-left: 10px; line-height: 1.25em"> people per square kilometer</div></div>',chart_compare_type:u[6],compare_content:{ni:"",lgd:u[18](u[0].place),dea:u[18](u[0].place),sdz:u[18](u[0].place),dz:u[18](u[0].place)}}});function Ln(re,yt){return re[0].place.type!="ni"?j1:q1}let An=Ln(u),oi=An(u);function ta(re){u[20](re)}let Wn={location:{bounds:u[0].place.bounds},options:{fitBoundsOptions:{padding:20}},style:l_,$$slots:{default:[Z1]},$$scope:{ctx:u}};u[3]!==void 0&&(Wn.map=u[3]),qi=new W_({props:Wn}),Nu.push(()=>p_(qi,"map",ta));let ti=u[0].place.type!="ni"&&$m(u);function ra(re,yt){return re[0].place.children[0]?H1:K1}let un=ra(u),ri=un(u);return Ur=new Pl({props:{id:"people",img:"nisra-taxonomy-icon-census.png",heading:"People and Households",place:u[0].place,sub_heading:u[17]("People and Households",u[0].place),description:"",chart_compare_type:u[6],boxes:{box_1:{id:"popchange",content:u[13](u[0].place),show:["ni","lgd"]},box_2:{id:"broadage",year:Wt("BroadAge",u[0].place),content:"GroupChart",chart_data:u[9]("BroadAge"),show:["ni","lgd","dea","sdz"]},box_4:{id:"hhsize",year:u[16]("hh_size"),content:"GroupChart",chart_data:u[9]("hh_size")},box_5:{id:"religion",year:u[16]("religion_or_religion_brought_up_in"),content:"GroupChart",chart_data:u[9]("religion_or_religion_brought_up_in")},box_6:{id:"language",year:u[16]("mainlang"),content:"GroupChart",chart_data:u[9]("mainlang")}},more:`More information on the size of the population is available in the latest <a href='https://www.nisra.gov.uk/publications/2022-mid-year-population-estimates-northern-ireland'>mid-year estimates release</a>, \r
					which includes an <a href='https://www.nisra.gov.uk/system/files/statistics/MYE22-summary.pdf'>infographic</a>, \r
					<a href='https://www.nisra.gov.uk/system/files/statistics/MYE22-Factsheets.pdf'>Fact Sheets</a>, \r
					a <a href='https://www.nisra.gov.uk/system/files/statistics/Statistical%20Bulletin%20-%202022%20Mid-year%20Population%20Estimates%20for%20Northern%20Ireland.pdf'>publication</a> \r
					and statistical tables. Population characteristics are from the census data which can be explored further in the <a href='https://explore.nisra.gov.uk/area-explorer-2021/N92000002/'>Census Area Explorer</a>, \r
					bespoke tables can be created using the <a href='https://build.nisra.gov.uk/en/'>Flexible Table Builder</a> and the NISRA website has \r
					<a href='https://www.nisra.gov.uk/publications/census-2021-statistical-bulletins'>statistical bulletins</a> providing commentary on a range of census population characteristics.`}}),bi=new Pl({props:{id:"health",img:"nisra-taxonomy-icon-health.png",heading:"Health and Social Care",place:u[0].place,sub_heading:u[17]("Health and Social Care",u[0].place),description:" ",chart_compare_type:u[6],boxes:{box_1:{id:"generalhealth",year:u[16]("general_health"),content:"StackedBarChart",chart_data:u[0].place&&u[8](["general_health"],["2011"],["2021"]),zKey:u[6],label:u[7],topic_prev_available:!0},box_2a:{id:"wellbeing",year:Wt("Happy",u[0].place),content:"<p>Happiness</p><span class='text-big'>"+u[14]("Happy.value").toLocaleString()+"</span>/ 10 <p>Life Satisfaction</p><span class='text-big'>"+u[14]("Satisfy.value").toLocaleString()+"</span>/ 10 ",show:["ni"]},box_2b:{id:"wellbeing",year:Wt("Happy",u[0].place),content:"<p>Happiness</p><span class='text-big'>"+u[14]("Happy.value").toLocaleString()+"</span>/ 10 <span style='color: #1460aa'> (NI "+u[0].ni.data.Happy.value+"/10) </span></p><p>Life Satisfaction</p><span class='text-big'>"+u[14]("Satisfy.value").toLocaleString()+"</span>/ 10 <span style='color: #1460aa'> (NI "+u[0].ni.data.Satisfy.value+"/10) </span></p>",show:["lgd"]},box_3a:{id:"lifeexpectancy",year:Wt("LE",u[0].place),content:"<p>Male</p> <span class='text-big'>"+u[14]("LE.value.Males").toLocaleString()+"</span> years<p>Female</p> <span class='text-big'>"+u[14]("LE.value.Females").toLocaleString()+"</span> years",show:["ni"]},box_3b:{id:"lifeexpectancy",year:Wt("LE",u[0].place),content:"<p>Male</p> <span class='text-big'>"+u[14]("LE.value.Males").toLocaleString()+"</span> years<span style='color: #1460aa'> (NI "+u[0].ni.data.LE.value.Males+") </span></p><p>Female</p> <span class='text-big'>"+u[14]("LE.value.Females").toLocaleString()+"</span> years<span style='color: #1460aa'> (NI "+u[0].ni.data.LE.value.Females+") </span></p>",show:["lgd"]},box_4:{id:"carers",content:"GroupChart",year:u[16]("provision_care"),chart_data:u[9]("provision_care")},box_5:{id:"hospitalactivity",year:Wt("Admiss",u[0].place),content:"<p><span class='text-big'>"+u[14]("Admiss.value").toLocaleString()+"</span> hospital patients</p><p>The most frequent reason was for </p><span class='text-bold' >"+u[14]("Admiss.text")+"</span>",show:["ni","dea"]},box_6:{id:"primarycare",year:Wt("GP",u[0].place),content:"<p><span class='text-big'>"+u[14]("GP.value.PRACS").toLocaleString()+"</span> GP practices with an average of <span class='text-big'>"+u[14]("GP.value.PRACLIST").toLocaleString()+"</span> patients per practice</p><p><span class='text-big'>"+u[14]("DEN.value.GDSDSSurgeries").toLocaleString()+"</span> dental surgeries</span> with an average of <span class='text-big'>"+(u[14]("DEN_REG.value.Dental_Registrations")/u[14]("DEN.value.GDSDSSurgeries")).toLocaleString(void 0,{minimumFractionDigits:0,maximumFractionDigits:0})+"</span> patients per surgery</p>",show:["ni"]},box_6a:{id:"primarycare",year:Wt("GP",u[0].place),content:"<p><span class='text-big'>"+u[14]("GP.value.PRACS").toLocaleString()+"</span> GP practices with an average of <span class='text-big'>"+u[14]("GP.value.PRACLIST").toLocaleString()+"</span> patients per practice</p><p>"+u[15]("GP.value.PRACLIST").toLocaleString()+"<span style='color: #1460aa'> (NI "+u[0].ni.data.GP.value.PRACLIST.toLocaleString()+" patients per practice) </span></p><p><span class='text-big'>"+u[14]("DEN.value.GDSDSSurgeries").toLocaleString()+"</span> dental surgeries</span> with an average of <span class='text-big'>"+(u[14]("DEN_REG.value.Dental_Registrations")/u[14]("DEN.value.GDSDSSurgeries")).toLocaleString(void 0,{minimumFractionDigits:0,maximumFractionDigits:0})+"</span> patients per surgery</p>",show:["lgd"]},box_6b:{id:"primarycare",year:Wt("DEN",u[0].place),content:"<p><span class='text-big'>"+u[14]("DEN.value.GDSDSSurgeries").toLocaleString()+"</span> dental surgeries</span> with an average of <span class='text-big'>"+(u[14]("DEN_REG.value.Dental_Registrations")/u[14]("DEN.value.GDSDSSurgeries")).toLocaleString(void 0,{minimumFractionDigits:0,maximumFractionDigits:0})+"</span> patients per surgery</p>",show:["dea"]},box_6c:{id:"empty",i_button:!1,content:"",show:["sdz","dz"]}},more:`<p>Significant volumes of information are prepared by the <a href='https://www.health-ni.gov.uk/topics/doh-statistics-and-research'>Department of Health</a> \r
				and the <a href='https://bso.hscni.net/directorates/operations/family-practitioner-services/directorates-operations-family-practitioner-services-information-unit/general-ophthalmic-services-statistics/'>\r
				Business Services Organisation</a>, including statistics on <a href='https://www.health-ni.gov.uk/topics/dhssps-statistics-and-research/health-inequalities-statistics'>Health inequalities</a>, \r
				Primary care (including <a href='https://bso.hscni.net/directorates/operations/family-practitioner-services/directorates-operations-family-practitioner-services-information-unit/1776-2/'>Medical</a>, \r
				<a href='https://bso.hscni.net/directorates/operations/family-practitioner-services/directorates-operations-family-practitioner-services-information-unit/general-dental-services-statistics/'>Dental</a>, \r
				<a href='https://bso.hscni.net/directorates/operations/family-practitioner-services/directorates-operations-family-practitioner-services-information-unit/general-pharmaceutical-services-and-prescribing-statistics/'>\r
				Pharmaceutical</a> and <a href='https://bso.hscni.net/directorates/operations/family-practitioner-services/directorates-operations-family-practitioner-services-information-unit/general-ophthalmic-services-statistics/'>\r
				Ophthalmic</a>), <a href='https://www.health-ni.gov.uk/topics/dhssps-statistics-and-research/family-health-services-statistics'>\r
				Family health services</a>, <a href='https://www.health-ni.gov.uk/topics/doh-statistics-and-research-mental-health-and-learning-disabilities/mental-health-learning-disability-and-autism-statistics'>\r
				Mental health, learning disability and autism</a>, <a href='https://www.health-ni.gov.uk/topics/dhssps-statistics-and-research-social-services/social-care-statistics'>\r
				Social care</a>, <a href='https://www.health-ni.gov.uk/topics/dhssps-statistics-and-research/workforce-statistics'>Workforce</a>, and <u>COVID-19</u>.\r
				A number of <a href='https://visual.nisra.gov.uk/?body=entity/health'>interactive dashboards</a> are available and a compendium dashboard for <a href='https://visual.nisra.gov.uk/?body=entity/las'>\r
				Making Life Better</a>.\r
				The <a href='https://www.nisra.gov.uk/statistics/census'>2021 census</a> collected data on general health, long-term conditions and carers which can \r
				be explored in the <a href='https://explore.nisra.gov.uk/area-explorer-2021/N92000002/'>Census Area Explorer</a> and the <a href='https://build.nisra.gov.uk/en/'>Flexible Table Builder</a>.</p><p></p>`}}),qr=new Pl({props:{id:"work",img:"nisra-taxonomy-icon-labour-market.png",heading:"Work and Welfare",place:u[0].place,sub_heading:u[17]("Work and Welfare",u[0].place),description:" ",chart_compare_type:u[6],boxes:{box_1:{id:"employmentrates",year:Wt("LMS",u[0].place),content:"GroupChart",chart_data:u[9]("LMS"),show:["ni","lgd"]},box_2a:{id:"employed",year:Wt("LMS",u[0].place),content:"<p>People employed</p> <span class='text-big'>"+u[14]("LMS.value.EMPN").toLocaleString()+'</span> </p><p>Median salary</p> <span class="text-big">£'+u[14]("ASHE.value").toLocaleString()+"</span> ",show:["ni"]},box_2b:{id:"employed",year:Wt("LMS",u[0].place),content:"<p>People employed</p> <span class='text-big'>"+u[14]("LMS.value.EMPN").toLocaleString()+'</span> </p><p>Median salary</p> <span class="text-big">£'+u[14]("ASHE.value").toLocaleString()+"</span> <span style='color: #1460aa'> (NI £"+u[0].ni.data.ASHE.value.toLocaleString()+") </span></p>",show:["lgd"]},box_3b:{id:"bres",year:Wt("BRES",u[0].place),content:"GroupChart",chart_data:u[9]("BRES"),show:["ni","lgd"]},box_4:{id:"disabilitybenefits",year:Wt("BS",u[0].place),content:'<span class="text-big">'+(u[0].place.data.BS.value.PIP+u[0].place.data.BS.value.DLA+u[0].place.data.BS.value.CA+u[0].place.data.BS.value.AA).toLocaleString()+"</span> claimants"},box_5:{id:"workingagebenefits",year:Wt("BS",u[0].place),content:'<span class="text-big">'+(u[0].place.data.BS.value.UC+u[0].place.data.BS.value.JSA+u[0].place.data.BS.value.IS+u[0].place.data.BS.value.ESA).toLocaleString()+"</span> claimants"},box_6:{id:"pensionagebenefits",year:Wt("BS",u[0].place),content:'<span class="text-big">'+(u[0].place.data.BS.value.RP+u[0].place.data.BS.value.PC).toLocaleString()+"</span> claimants"}},more:`<p>The monthly <a href='https://www.nisra.gov.uk/statistics/labour-market-and-social-welfare/labour-market-overview'>Labour Market Report</a>\r
				contains the most up to date labour market statistics. The <a href='https://www.nisra.gov.uk/statistics/labour-market-and-social-welfare/annual-survey-hours-and-earnings'>\r
				Annual Survey of Hours and Earnings</a> provides data on hourly, weekly and annual earnings. The <a href='https://www.nisra.gov.uk/statistics/labour-market-and-social-welfare/quarterly-employment-survey'>\r
				Quarterly Employment Survey</a> provides short-term employee jobs estimates for NI. Further information is available for the \r
				unemployed <a href='https://www.nisra.gov.uk/statistics/labour-market-and-social-welfare/claimant-count'>Claimant Count</a>, \r
				claimant numbers for <a href='https://www.nisra.gov.uk/statistics/labour-market-and-social-welfare/disability-benefits'>Disability Benefits</a>, \r
				and <a href='https://www.nisra.gov.uk/statistics/labour-market-and-social-welfare/work-related-benefits'>Work Related Benefits</a>. \r
				Statistics on <a href='https://www.nisra.gov.uk/statistics/labour-market-and-social-welfare/redundancies'>Redundancies</a> \r
				and <a href='https://www.nisra.gov.uk/statistics/labour-market-and-social-welfare/job-vacancies'>Job Vacancies</a> are also available. \r
				A number of <a href='https://visual.nisra.gov.uk/?body=entity/lm'>interactive dashboards</a> are available. \r
				The <a href='https://www.nisra.gov.uk/statistics/census'>2021 census</a> collected data on occupations, industry and number of hours worked which can be \r
				explored in the <a href='https://explore.nisra.gov.uk/area-explorer-2021/N92000002/'>Census Area Explorer</a> and the <a href='https://build.nisra.gov.uk/en/'>Flexible Table Builder</a>.</p>`}}),Xr=new Pl({props:{id:"education",img:"nisra-taxonomy-icon-child-education-skills.png",heading:"Education",place:u[0].place,sub_heading:u[17]("Schools, colleges and universities",u[0].place),description:"",chart_compare_type:u[6],boxes:{box_1:{id:"enrollments",content:"<p style='margin:0'>Primary school <span class='text-big'>"+u[14]("Primary.value").toLocaleString()+"</span> <p style='margin:0'>Post primary school <span class='text-big'>"+u[14]("PostPrimary.value").toLocaleString()+" </span><p style='margin:0'>Further education <span class='text-big'>"+u[14]("FE.value").toLocaleString()+"</span><p style='margin:0'>Higher education <span class='text-big'>"+u[14]("HE.value").toLocaleString()+" </span>",year:Wt("Primary",u[0].place),show:["ni","lgd","dea"]},box_2a:{id:"fsme",content:"<p style='margin:0'>Primary school <span class='text-big'> "+u[14]("Primary.perc.FSME")+" </span><p style='margin:0'>Post primary school <span class='text-big'>"+u[14]("PostPrimary.perc.FSME")+" </span>",year:Wt("Primary",u[0].place),show:["ni"]},box_2b:{id:"fsme",content:"<p style='margin:0'>Primary school <span class='text-big'> "+u[14]("Primary.perc.FSME")+" </span><span style='color: #1460aa'> (NI "+u[0].ni.data.Primary.perc.FSME.toFixed(0)+"%) </span></p><p style='margin:0'>Post primary school <span class='text-big'>"+u[14]("PostPrimary.perc.FSME")+" </span><span style='color: #1460aa'> (NI "+u[0].ni.data.PostPrimary.perc.FSME.toFixed(0)+"%) </span></p>",year:Wt("Primary",u[0].place),show:["lgd","dea"]},box_3a:{id:"teachers",year:Wt("ClassSize",u[0].place),content:"<p><span class='text-big'>"+u[14]("ClassSize.value").toLocaleString()+"</span> pupils per teacher",show:["ni"]},box_3n:{id:"teachers",year:Wt("ClassSize",u[0].place),content:"<p><span class='text-big'>"+u[14]("ClassSize.value").toLocaleString()+"</span> pupils per teacher<span style='color: #1460aa'> (NI "+u[0].ni.data.ClassSize.value.toLocaleString(void 0,{minimumFractionDigits:1})+") </span></p>",show:["lgd"]},box_4:{id:"qualifications",content:"GroupChart",year:u[16]("highest_level_of_qualifications"),chart_data:u[9]("highest_level_of_qualifications")},box_5a:{id:"attainment",year:Wt("Attainment",u[0].place),content:"<p>Percentage of pupils who left school with 5 or more GCSEs grades A*-C (including Maths and English)</p><p> <span class='text-big'>"+u[14]("Attainment.value").toLocaleString()+"%</span> ",show:["ni"]},box_5b:{id:"attainment",year:Wt("Attainment",u[0].place),content:"<p>Percentage of pupils who left school with 5 or more GCSEs grades A*-C (including Maths and English)</p><p> <span class='text-big'>"+u[14]("Attainment.value").toLocaleString()+"%</span> <span style='color: #1460aa'>(NI "+u[0].ni.data.Attainment.value.toLocaleString(void 0,{minimumFractionDigits:1})+"%) </span></p>"+u[15]("Attainment.value").toLocaleString(),show:["lgd"]},box_6:{id:"destination",year:Wt("Destination",u[0].place),content:"GroupChart",chart_data:u[9]("Destination"),show:["ni","lgd","dea"]},box_6a:{id:"empty",i_button:!1,content:"",show:["sdz","dz"]},box_6b:{id:"empty",i_button:!1,content:"",show:["sdz","dz"]}},more:"<p>The <a href='https://www.nisra.gov.uk/statistics/children-education-and-skills/school-education-statistics'>Department of Education</a> publishes statistics on <a href='https://www.education-ni.gov.uk/articles/school-enrolments-overview'>school enrolments</a>, <a href='https://www.education-ni.gov.uk/articles/school-performance'>school performance</a>, <a href='https://www.education-ni.gov.uk/articles/school-leavers'>school leavers</a>, qualifications and destinations, <a href='https://www.education-ni.gov.uk/articles/pupil-attendance'>pupil attendance</a>, suspensions and expulsions, school meals and <a href='https://www.education-ni.gov.uk/articles/education-workforce'>education workforce</a>. The <a href='https://www.nisra.gov.uk/statistics/children-education-and-skills/higher-and-further-education-and-training-statistics'>Department for the Economy</a> publishes <a href='https://www.economy-ni.gov.uk/topics/statistics-and-economic-research/higher-education-statistics-and-research'>Higher</a> and <a href='https://www.economy-ni.gov.uk/topics/statistics-and-economic-research/further-education-statistics-and-research'>Further</a> education and <a href='https://www.economy-ni.gov.uk/articles/training-success-statistics'>training</a> statistics. The <a href='https://www.nisra.gov.uk/statistics/census'>2021 census</a> collected data on qualifications which can be explored in the <a href='https://explore.nisra.gov.uk/area-explorer-2021/N92000002/'>Census Area Explorer</a> and the <a href='https://build.nisra.gov.uk/en/'>Flexible Table Builder</a>.</p>"}}),nn=new Pl({props:{id:"crime",img:"nisra-taxonomy-icon-crime-justice.png",heading:"Crime and Justice",place:u[0].place,sub_heading:u[17]("Crime and Court Activity",u[0].place),description:" ",chart_compare_type:u[6],boxes:{},more:""}}),Gi=new Pl({props:{id:"travel",img:"nisra-taxonomy-icon-travel-transport.png",heading:"Travel and Transport",place:u[0].place,sub_heading:u[17]("Travel and transport",u[0].place),description:" ",chart_compare_type:u[6],boxes:{},more:""}}),{c(){h=je("div"),d=je("div"),p=je("span"),y=je("a"),_=Vt("Home"),a=new Ll(!1),T=bt(),ei&&ei.c(),D=bt(),F=je("br"),M=je("span"),X=Vt(L),oe=bt(),se=je("div"),pe=je("div"),xe=je("b"),be=Vt("Search for your area:"),ct=bt(),ir(We.$$.fragment),De=bt(),Ze=je("script"),Dt=Vt(`// Share button\r
						// Possible tooltip: https://stackoverflow.com/questions/37798967/tooltip-on-click-of-a-button\r
\r
						function copyToClipboard(text) {\r
							var inputc = document.body.appendChild(\r
								document.createElement("input"),\r
							);\r
							inputc.value = window.location.href;\r
							inputc.select();\r
							document.execCommand("copy");\r
							inputc.parentNode.removeChild(inputc);\r
							alert("URL Copied.");\r
						}\r
\r
						(function (win, doc) {\r
							const testButton = doc.createElement("button");\r
							testButton.setAttribute("type", "share");\r
							if (testButton.type != "share") {\r
								win.addEventListener("click", function (ev) {\r
									ev = ev || win.event;\r
									let target = ev.target;\r
									let button = target.closest(\r
										'button[type="share"]',\r
									);\r
									if (button) {\r
										const title = "Share URL";\r
										const url = win.location.href;\r
										if (navigator.share) {\r
											navigator.share({\r
												title: title,\r
												url: url,\r
											});\r
										} else {\r
											copyToClipboard();\r
										}\r
									}\r
								});\r
							}\r
						})(this, this.document);`),zt=bt(),Ue=je("div"),Ke=je("button"),vt=Vt("About"),cr=bt(),Ne=je("button"),Rt=Vt("Print / PDF"),Me=bt(),$e=je("button"),mt=Vt("Share"),qt=bt(),Bt=je("div"),ir(St.$$.fragment),Oe=bt(),ir(ot.$$.fragment),Dr=bt(),ir(Kr.$$.fragment),vi=bt(),xr=je("div"),er=je("div"),Hr=je("h3"),oi.c(),Jt=bt(),ai=je("div"),ir(qi.$$.fragment),Kt=bt(),ji=je("div"),ti&&ti.c(),fi=bt(),$r=je("div"),ri.c(),Ei=bt(),Lr=je("div"),ir(Ur.$$.fragment),tn=bt(),ir(bi.$$.fragment),di=bt(),ir(qr.$$.fragment),rn=bt(),ir(Xr.$$.fragment),In=bt(),ir(nn.$$.fragment),Dn=bt(),ir(Gi.$$.fragment),this.h()},l(re){h=Ge(re,"DIV",{class:!0});var yt=Ve(h);d=Ge(yt,"DIV",{});var Ti=Ve(d);p=Ge(Ti,"SPAN",{class:!0});var pr=Ve(p);y=Ge(pr,"A",{href:!0,"data-sveltekit-noscroll":!0,class:!0});var R=Ve(y);_=Ut(R,"Home"),R.forEach(ae),a=Rl(pr,!1),T=xt(pr),ei&&ei.l(pr),pr.forEach(ae),D=xt(Ti),F=Ge(Ti,"BR",{}),M=Ge(Ti,"SPAN",{class:!0,style:!0});var N=Ve(M);X=Ut(N,L),N.forEach(ae),Ti.forEach(ae),oe=xt(yt),se=Ge(yt,"DIV",{});var q=Ve(se);pe=Ge(q,"DIV",{style:!0,class:!0});var K=Ve(pe);xe=Ge(K,"B",{});var W=Ve(xe);be=Ut(W,"Search for your area:"),W.forEach(ae),ct=xt(K),nr(We.$$.fragment,K),De=xt(K),Ze=Ge(K,"SCRIPT",{});var ue=Ve(Ze);Dt=Ut(ue,`// Share button\r
						// Possible tooltip: https://stackoverflow.com/questions/37798967/tooltip-on-click-of-a-button\r
\r
						function copyToClipboard(text) {\r
							var inputc = document.body.appendChild(\r
								document.createElement("input"),\r
							);\r
							inputc.value = window.location.href;\r
							inputc.select();\r
							document.execCommand("copy");\r
							inputc.parentNode.removeChild(inputc);\r
							alert("URL Copied.");\r
						}\r
\r
						(function (win, doc) {\r
							const testButton = doc.createElement("button");\r
							testButton.setAttribute("type", "share");\r
							if (testButton.type != "share") {\r
								win.addEventListener("click", function (ev) {\r
									ev = ev || win.event;\r
									let target = ev.target;\r
									let button = target.closest(\r
										'button[type="share"]',\r
									);\r
									if (button) {\r
										const title = "Share URL";\r
										const url = win.location.href;\r
										if (navigator.share) {\r
											navigator.share({\r
												title: title,\r
												url: url,\r
											});\r
										} else {\r
											copyToClipboard();\r
										}\r
									}\r
								});\r
							}\r
						})(this, this.document);`),ue.forEach(ae),zt=xt(K),Ue=Ge(K,"DIV",{width:!0});var fe=Ve(Ue);Ke=Ge(fe,"BUTTON",{class:!0,style:!0,alt:!0,onclick:!0});var U=Ve(Ke);vt=Ut(U,"About"),U.forEach(ae),cr=xt(fe),Ne=Ge(fe,"BUTTON",{class:!0,style:!0,title:!0,onclick:!0});var Q=Ve(Ne);Rt=Ut(Q,"Print / PDF"),Q.forEach(ae),Me=xt(fe),$e=Ge(fe,"BUTTON",{class:!0,style:!0,type:!0,alt:!0});var ge=Ve($e);mt=Ut(ge,"Share"),ge.forEach(ae),fe.forEach(ae),K.forEach(ae),q.forEach(ae),yt.forEach(ae),qt=xt(re),Bt=Ge(re,"DIV",{id:!0,class:!0});var Ce=Ve(Bt);nr(St.$$.fragment,Ce),Oe=xt(Ce),nr(ot.$$.fragment,Ce),Dr=xt(Ce),nr(Kr.$$.fragment,Ce),Ce.forEach(ae),vi=xt(re),xr=Ge(re,"DIV",{class:!0});var Le=Ve(xr);er=Ge(Le,"DIV",{style:!0});var Ee=Ve(er);Hr=Ge(Ee,"H3",{class:!0});var Re=Ve(Hr);oi.l(Re),Re.forEach(ae),Ee.forEach(ae),Jt=xt(Le),ai=Ge(Le,"DIV",{id:!0,style:!0,class:!0});var ht=Ve(ai);nr(qi.$$.fragment,ht),ht.forEach(ae),Kt=xt(Le),ji=Ge(Le,"DIV",{});var at=Ve(ji);ti&&ti.l(at),at.forEach(ae),fi=xt(Le),$r=Ge(Le,"DIV",{});var Te=Ve($r);ri.l(Te),Te.forEach(ae),Le.forEach(ae),Ei=xt(re),Lr=Ge(re,"DIV",{class:!0,id:!0});var He=Ve(Lr);nr(Ur.$$.fragment,He),tn=xt(He),nr(bi.$$.fragment,He),di=xt(He),nr(qr.$$.fragment,He),rn=xt(He),nr(Xr.$$.fragment,He),In=xt(He),nr(nn.$$.fragment,He),Dn=xt(He),nr(Gi.$$.fragment,He),He.forEach(ae),this.h()},h(){ne(y,"href",ha+"/"),ne(y,"data-sveltekit-noscroll",""),ne(y,"class","svelte-hmrro5"),a.a=T,ne(p,"class","text-small"),ne(M,"class","text-big title svelte-hmrro5"),Je(M,"font-size","2.5em"),Je(M,"line-height","1em"),ne(Ke,"class","btn svelte-hmrro5"),Je(Ke,"width","33%"),ne(Ke,"alt","Opens the About page"),ne(Ke,"onclick","window.location.href='"+ha+"/about';"),ne(Ne,"class","btn svelte-hmrro5"),Je(Ne,"width","33%"),ne(Ne,"title","Click to print this page to pdf or printer"),ne(Ne,"onclick","window.print();return false;"),ne($e,"class","btn svelte-hmrro5"),Je($e,"width","30%"),ne($e,"type","share"),ne($e,"alt","Share this page"),ne(Ue,"width","100%"),Je(pe,"width","350px"),Je(pe,"padding-top","5px"),ne(pe,"class","svelte-hmrro5"),rs(pe,"float-right",u[2]>1),ne(h,"class","grid mtl svelte-hmrro5"),ne(Bt,"id","grid"),ne(Bt,"class","grid mt svelte-hmrro5"),ne(Hr,"class","svelte-hmrro5"),Je(er,"grid-column","span "+u[2]),ne(ai,"id","map"),Je(ai,"padding-right","45px"),Je(ai,"grid-column","span "+(u[2]==2?2:u[2]&&u[2]>2?u[2]-1:1)),ne(ai,"class","svelte-hmrro5"),ne(xr,"class","grid mt svelte-hmrro5"),ju(()=>u[21].call(xr)),ne(Lr,"class","accordion"),ne(Lr,"id","accordionPanelsStayOpenExample")},m(re,yt){Be(re,h,yt),Ae(h,d),Ae(d,p),Ae(p,y),Ae(y,_),a.m(I,p),Ae(p,T),ei&&ei.m(p,null),Ae(d,D),Ae(d,F),Ae(d,M),Ae(M,X),Ae(h,oe),Ae(h,se),Ae(se,pe),Ae(pe,xe),Ae(xe,be),Ae(pe,ct),ar(We,pe,null),Ae(pe,De),Ae(pe,Ze),Ae(Ze,Dt),Ae(pe,zt),Ae(pe,Ue),Ae(Ue,Ke),Ae(Ke,vt),Ae(Ue,cr),Ae(Ue,Ne),Ae(Ne,Rt),Ae(Ue,Me),Ae(Ue,$e),Ae($e,mt),Be(re,qt,yt),Be(re,Bt,yt),ar(St,Bt,null),Ae(Bt,Oe),ar(ot,Bt,null),Ae(Bt,Dr),ar(Kr,Bt,null),Be(re,vi,yt),Be(re,xr,yt),Ae(xr,er),Ae(er,Hr),oi.m(Hr,null),Ae(xr,Jt),Ae(xr,ai),ar(qi,ai,null),Ae(xr,Kt),Ae(xr,ji),ti&&ti.m(ji,null),Ae(xr,fi),Ae(xr,$r),ri.m($r,null),Xn=Gu(xr,u[21].bind(xr)),Be(re,Ei,yt),Be(re,Lr,yt),ar(Ur,Lr,null),Ae(Lr,tn),ar(bi,Lr,null),Ae(Lr,di),ar(qr,Lr,null),Ae(Lr,rn),ar(Xr,Lr,null),Ae(Lr,In),ar(nn,Lr,null),Ae(Lr,Dn),ar(Gi,Lr,null),Bi=!0},p(re,yt){re[0].place.type!="ni"?ei?ei.p(re,yt):(ei=Ym(re),ei.c(),ei.m(p,null)):ei&&(ei.d(1),ei=null),(!Bi||yt[0]&1)&&L!==(L=re[0].place.name+"")&&Mr(X,L);const Ti={};yt[0]&1&&(Ti.search_data=re[0].search_data),We.$set(Ti),(!Bi||yt[0]&4)&&rs(pe,"float-right",re[2]>1);const pr={};yt[0]&1&&(pr.heading="About "+re[0].place.name),yt[0]&1&&(pr.place=re[0].place),yt[0]&1&&(pr.content={ni:"Northern Ireland has 11 Local Government Districts (LGDs),  which can be subdivided into District Electoral Areas (DEAs), then further into Super Data Zones and Data Zones. Statistics can be viewed for these smaller areas.",lgd:re[0].place.name+" is one of "+re[0].place.count.toLocaleString()+" "+Zn[re[0].place.type].pl+".  It includes the larger settlements of "+re[0].place.lgd_location_description,dea:re[0].place.name+" is one of "+re[0].place.count.toLocaleString()+" "+Zn[re[0].place.type].pl+" in Northern Ireland.  It is within <a href = '/"+re[0].place.parents[0].code+"/' data-sveltekit-noscroll>"+re[0].place.parents[0].name+" </a> and covers "+re[0].place.dea_location_description+".",sdz:re[0].place.name+" is one of "+re[0].place.count.toLocaleString()+" "+Zn[re[0].place.type].pl+". Super Data Zones are new statistical areas developed for census. They are broadly similar in population size and housing type.",dz:re[0].place.name+" is one of "+re[0].place.count.toLocaleString()+" "+Zn[re[0].place.type].pl+".  Super Data Zones are smaller divisions of Data Zones. There are on average 4 in each Super Data Zone."}),yt[0]&64&&(pr.chart_compare_type=re[6]),St.$set(pr);const R={};yt[0]&1&&(R.place=re[0].place),yt[0]&1&&(R.year=Wt("MYETotal",re[0].place)),yt[0]&1&&(R.content='<span class="text-big" style="font-size: 2.8em;">'+re[0].place.data.MYETotal.value.toLocaleString()+"</span>"),yt[0]&64&&(R.chart_compare_type=re[6]),yt[0]&1&&(R.compare_content={ni:"",lgd:'<span class = "em" style = "background-color: lightgrey">'+mh(re[0].place.data.population.value[2021].all/re[0].ni.data.population.value[2021].all)+"</span> of Northern Ireland population<br>The "+re[12](re[0].place.data.population.value_rank[2021].all)+" population of 11 Local Government Districts",dea:'<span class = "em" style = "background-color: lightgrey">'+mh(re[0].place.data.population.value[2021].all/re[0].ni.data.population.value[2021].all)+"</span> of Northern Ireland population",sdz:"Data not available for area comparison",dz:" Data not available for area comparison"}),ot.$set(R);const N={};yt[0]&1&&(N.place=re[0].place),yt[0]&1&&(N.year=Wt("MYETotal",re[0].place)),yt[0]&1&&(N.content='<div class = "row" style = "display: flex; align-items: center"><div class="text-big" style="font-size: 2.8em;">'+ry(re[0].place)+'</div><div style = "margin-left: 10px; line-height: 1.25em"> people per square kilometer</div></div>'),yt[0]&64&&(N.chart_compare_type=re[6]),yt[0]&1&&(N.compare_content={ni:"",lgd:re[18](re[0].place),dea:re[18](re[0].place),sdz:re[18](re[0].place),dz:re[18](re[0].place)}),Kr.$set(N),An===(An=Ln(re))&&oi?oi.p(re,yt):(oi.d(1),oi=An(re),oi&&(oi.c(),oi.m(Hr,null))),(!Bi||yt[0]&4)&&Je(er,"grid-column","span "+re[2]);const q={};yt[0]&1&&(q.location={bounds:re[0].place.bounds}),yt[0]&48|yt[1]&128&&(q.$$scope={dirty:yt,ctx:re}),!en&&yt[0]&8&&(en=!0,q.map=re[3],f_(()=>en=!1)),qi.$set(q),(!Bi||yt[0]&4)&&Je(ai,"grid-column","span "+(re[2]==2?2:re[2]&&re[2]>2?re[2]-1:1)),re[0].place.type!="ni"?ti?ti.p(re,yt):(ti=$m(re),ti.c(),ti.m(ji,null)):ti&&(ti.d(1),ti=null),un===(un=ra(re))&&ri?ri.p(re,yt):(ri.d(1),ri=un(re),ri&&(ri.c(),ri.m($r,null)));const K={};yt[0]&1&&(K.place=re[0].place),yt[0]&1&&(K.sub_heading=re[17]("People and Households",re[0].place)),yt[0]&64&&(K.chart_compare_type=re[6]),yt[0]&1&&(K.boxes={box_1:{id:"popchange",content:re[13](re[0].place),show:["ni","lgd"]},box_2:{id:"broadage",year:Wt("BroadAge",re[0].place),content:"GroupChart",chart_data:re[9]("BroadAge"),show:["ni","lgd","dea","sdz"]},box_4:{id:"hhsize",year:re[16]("hh_size"),content:"GroupChart",chart_data:re[9]("hh_size")},box_5:{id:"religion",year:re[16]("religion_or_religion_brought_up_in"),content:"GroupChart",chart_data:re[9]("religion_or_religion_brought_up_in")},box_6:{id:"language",year:re[16]("mainlang"),content:"GroupChart",chart_data:re[9]("mainlang")}}),Ur.$set(K);const W={};yt[0]&1&&(W.place=re[0].place),yt[0]&1&&(W.sub_heading=re[17]("Health and Social Care",re[0].place)),yt[0]&64&&(W.chart_compare_type=re[6]),yt[0]&193&&(W.boxes={box_1:{id:"generalhealth",year:re[16]("general_health"),content:"StackedBarChart",chart_data:re[0].place&&re[8](["general_health"],["2011"],["2021"]),zKey:re[6],label:re[7],topic_prev_available:!0},box_2a:{id:"wellbeing",year:Wt("Happy",re[0].place),content:"<p>Happiness</p><span class='text-big'>"+re[14]("Happy.value").toLocaleString()+"</span>/ 10 <p>Life Satisfaction</p><span class='text-big'>"+re[14]("Satisfy.value").toLocaleString()+"</span>/ 10 ",show:["ni"]},box_2b:{id:"wellbeing",year:Wt("Happy",re[0].place),content:"<p>Happiness</p><span class='text-big'>"+re[14]("Happy.value").toLocaleString()+"</span>/ 10 <span style='color: #1460aa'> (NI "+re[0].ni.data.Happy.value+"/10) </span></p><p>Life Satisfaction</p><span class='text-big'>"+re[14]("Satisfy.value").toLocaleString()+"</span>/ 10 <span style='color: #1460aa'> (NI "+re[0].ni.data.Satisfy.value+"/10) </span></p>",show:["lgd"]},box_3a:{id:"lifeexpectancy",year:Wt("LE",re[0].place),content:"<p>Male</p> <span class='text-big'>"+re[14]("LE.value.Males").toLocaleString()+"</span> years<p>Female</p> <span class='text-big'>"+re[14]("LE.value.Females").toLocaleString()+"</span> years",show:["ni"]},box_3b:{id:"lifeexpectancy",year:Wt("LE",re[0].place),content:"<p>Male</p> <span class='text-big'>"+re[14]("LE.value.Males").toLocaleString()+"</span> years<span style='color: #1460aa'> (NI "+re[0].ni.data.LE.value.Males+") </span></p><p>Female</p> <span class='text-big'>"+re[14]("LE.value.Females").toLocaleString()+"</span> years<span style='color: #1460aa'> (NI "+re[0].ni.data.LE.value.Females+") </span></p>",show:["lgd"]},box_4:{id:"carers",content:"GroupChart",year:re[16]("provision_care"),chart_data:re[9]("provision_care")},box_5:{id:"hospitalactivity",year:Wt("Admiss",re[0].place),content:"<p><span class='text-big'>"+re[14]("Admiss.value").toLocaleString()+"</span> hospital patients</p><p>The most frequent reason was for </p><span class='text-bold' >"+re[14]("Admiss.text")+"</span>",show:["ni","dea"]},box_6:{id:"primarycare",year:Wt("GP",re[0].place),content:"<p><span class='text-big'>"+re[14]("GP.value.PRACS").toLocaleString()+"</span> GP practices with an average of <span class='text-big'>"+re[14]("GP.value.PRACLIST").toLocaleString()+"</span> patients per practice</p><p><span class='text-big'>"+re[14]("DEN.value.GDSDSSurgeries").toLocaleString()+"</span> dental surgeries</span> with an average of <span class='text-big'>"+(re[14]("DEN_REG.value.Dental_Registrations")/re[14]("DEN.value.GDSDSSurgeries")).toLocaleString(void 0,{minimumFractionDigits:0,maximumFractionDigits:0})+"</span> patients per surgery</p>",show:["ni"]},box_6a:{id:"primarycare",year:Wt("GP",re[0].place),content:"<p><span class='text-big'>"+re[14]("GP.value.PRACS").toLocaleString()+"</span> GP practices with an average of <span class='text-big'>"+re[14]("GP.value.PRACLIST").toLocaleString()+"</span> patients per practice</p><p>"+re[15]("GP.value.PRACLIST").toLocaleString()+"<span style='color: #1460aa'> (NI "+re[0].ni.data.GP.value.PRACLIST.toLocaleString()+" patients per practice) </span></p><p><span class='text-big'>"+re[14]("DEN.value.GDSDSSurgeries").toLocaleString()+"</span> dental surgeries</span> with an average of <span class='text-big'>"+(re[14]("DEN_REG.value.Dental_Registrations")/re[14]("DEN.value.GDSDSSurgeries")).toLocaleString(void 0,{minimumFractionDigits:0,maximumFractionDigits:0})+"</span> patients per surgery</p>",show:["lgd"]},box_6b:{id:"primarycare",year:Wt("DEN",re[0].place),content:"<p><span class='text-big'>"+re[14]("DEN.value.GDSDSSurgeries").toLocaleString()+"</span> dental surgeries</span> with an average of <span class='text-big'>"+(re[14]("DEN_REG.value.Dental_Registrations")/re[14]("DEN.value.GDSDSSurgeries")).toLocaleString(void 0,{minimumFractionDigits:0,maximumFractionDigits:0})+"</span> patients per surgery</p>",show:["dea"]},box_6c:{id:"empty",i_button:!1,content:"",show:["sdz","dz"]}}),bi.$set(W);const ue={};yt[0]&1&&(ue.place=re[0].place),yt[0]&1&&(ue.sub_heading=re[17]("Work and Welfare",re[0].place)),yt[0]&64&&(ue.chart_compare_type=re[6]),yt[0]&1&&(ue.boxes={box_1:{id:"employmentrates",year:Wt("LMS",re[0].place),content:"GroupChart",chart_data:re[9]("LMS"),show:["ni","lgd"]},box_2a:{id:"employed",year:Wt("LMS",re[0].place),content:"<p>People employed</p> <span class='text-big'>"+re[14]("LMS.value.EMPN").toLocaleString()+'</span> </p><p>Median salary</p> <span class="text-big">£'+re[14]("ASHE.value").toLocaleString()+"</span> ",show:["ni"]},box_2b:{id:"employed",year:Wt("LMS",re[0].place),content:"<p>People employed</p> <span class='text-big'>"+re[14]("LMS.value.EMPN").toLocaleString()+'</span> </p><p>Median salary</p> <span class="text-big">£'+re[14]("ASHE.value").toLocaleString()+"</span> <span style='color: #1460aa'> (NI £"+re[0].ni.data.ASHE.value.toLocaleString()+") </span></p>",show:["lgd"]},box_3b:{id:"bres",year:Wt("BRES",re[0].place),content:"GroupChart",chart_data:re[9]("BRES"),show:["ni","lgd"]},box_4:{id:"disabilitybenefits",year:Wt("BS",re[0].place),content:'<span class="text-big">'+(re[0].place.data.BS.value.PIP+re[0].place.data.BS.value.DLA+re[0].place.data.BS.value.CA+re[0].place.data.BS.value.AA).toLocaleString()+"</span> claimants"},box_5:{id:"workingagebenefits",year:Wt("BS",re[0].place),content:'<span class="text-big">'+(re[0].place.data.BS.value.UC+re[0].place.data.BS.value.JSA+re[0].place.data.BS.value.IS+re[0].place.data.BS.value.ESA).toLocaleString()+"</span> claimants"},box_6:{id:"pensionagebenefits",year:Wt("BS",re[0].place),content:'<span class="text-big">'+(re[0].place.data.BS.value.RP+re[0].place.data.BS.value.PC).toLocaleString()+"</span> claimants"}}),qr.$set(ue);const fe={};yt[0]&1&&(fe.place=re[0].place),yt[0]&1&&(fe.sub_heading=re[17]("Schools, colleges and universities",re[0].place)),yt[0]&64&&(fe.chart_compare_type=re[6]),yt[0]&1&&(fe.boxes={box_1:{id:"enrollments",content:"<p style='margin:0'>Primary school <span class='text-big'>"+re[14]("Primary.value").toLocaleString()+"</span> <p style='margin:0'>Post primary school <span class='text-big'>"+re[14]("PostPrimary.value").toLocaleString()+" </span><p style='margin:0'>Further education <span class='text-big'>"+re[14]("FE.value").toLocaleString()+"</span><p style='margin:0'>Higher education <span class='text-big'>"+re[14]("HE.value").toLocaleString()+" </span>",year:Wt("Primary",re[0].place),show:["ni","lgd","dea"]},box_2a:{id:"fsme",content:"<p style='margin:0'>Primary school <span class='text-big'> "+re[14]("Primary.perc.FSME")+" </span><p style='margin:0'>Post primary school <span class='text-big'>"+re[14]("PostPrimary.perc.FSME")+" </span>",year:Wt("Primary",re[0].place),show:["ni"]},box_2b:{id:"fsme",content:"<p style='margin:0'>Primary school <span class='text-big'> "+re[14]("Primary.perc.FSME")+" </span><span style='color: #1460aa'> (NI "+re[0].ni.data.Primary.perc.FSME.toFixed(0)+"%) </span></p><p style='margin:0'>Post primary school <span class='text-big'>"+re[14]("PostPrimary.perc.FSME")+" </span><span style='color: #1460aa'> (NI "+re[0].ni.data.PostPrimary.perc.FSME.toFixed(0)+"%) </span></p>",year:Wt("Primary",re[0].place),show:["lgd","dea"]},box_3a:{id:"teachers",year:Wt("ClassSize",re[0].place),content:"<p><span class='text-big'>"+re[14]("ClassSize.value").toLocaleString()+"</span> pupils per teacher",show:["ni"]},box_3n:{id:"teachers",year:Wt("ClassSize",re[0].place),content:"<p><span class='text-big'>"+re[14]("ClassSize.value").toLocaleString()+"</span> pupils per teacher<span style='color: #1460aa'> (NI "+re[0].ni.data.ClassSize.value.toLocaleString(void 0,{minimumFractionDigits:1})+") </span></p>",show:["lgd"]},box_4:{id:"qualifications",content:"GroupChart",year:re[16]("highest_level_of_qualifications"),chart_data:re[9]("highest_level_of_qualifications")},box_5a:{id:"attainment",year:Wt("Attainment",re[0].place),content:"<p>Percentage of pupils who left school with 5 or more GCSEs grades A*-C (including Maths and English)</p><p> <span class='text-big'>"+re[14]("Attainment.value").toLocaleString()+"%</span> ",show:["ni"]},box_5b:{id:"attainment",year:Wt("Attainment",re[0].place),content:"<p>Percentage of pupils who left school with 5 or more GCSEs grades A*-C (including Maths and English)</p><p> <span class='text-big'>"+re[14]("Attainment.value").toLocaleString()+"%</span> <span style='color: #1460aa'>(NI "+re[0].ni.data.Attainment.value.toLocaleString(void 0,{minimumFractionDigits:1})+"%) </span></p>"+re[15]("Attainment.value").toLocaleString(),show:["lgd"]},box_6:{id:"destination",year:Wt("Destination",re[0].place),content:"GroupChart",chart_data:re[9]("Destination"),show:["ni","lgd","dea"]},box_6a:{id:"empty",i_button:!1,content:"",show:["sdz","dz"]},box_6b:{id:"empty",i_button:!1,content:"",show:["sdz","dz"]}}),Xr.$set(fe);const U={};yt[0]&1&&(U.place=re[0].place),yt[0]&1&&(U.sub_heading=re[17]("Crime and Court Activity",re[0].place)),yt[0]&64&&(U.chart_compare_type=re[6]),nn.$set(U);const Q={};yt[0]&1&&(Q.place=re[0].place),yt[0]&1&&(Q.sub_heading=re[17]("Travel and transport",re[0].place)),yt[0]&64&&(Q.chart_compare_type=re[6]),Gi.$set(Q)},i(re){Bi||(tt(We.$$.fragment,re),tt(St.$$.fragment,re),tt(ot.$$.fragment,re),tt(Kr.$$.fragment,re),tt(qi.$$.fragment,re),tt(Ur.$$.fragment,re),tt(bi.$$.fragment,re),tt(qr.$$.fragment,re),tt(Xr.$$.fragment,re),tt(nn.$$.fragment,re),tt(Gi.$$.fragment,re),Bi=!0)},o(re){ut(We.$$.fragment,re),ut(St.$$.fragment,re),ut(ot.$$.fragment,re),ut(Kr.$$.fragment,re),ut(qi.$$.fragment,re),ut(Ur.$$.fragment,re),ut(bi.$$.fragment,re),ut(qr.$$.fragment,re),ut(Xr.$$.fragment,re),ut(nn.$$.fragment,re),ut(Gi.$$.fragment,re),Bi=!1},d(re){re&&ae(h),ei&&ei.d(),or(We),re&&ae(qt),re&&ae(Bt),or(St),or(ot),or(Kr),re&&ae(vi),re&&ae(xr),oi.d(),or(qi),ti&&ti.d(),ri.d(),Xn(),re&&ae(Ei),re&&ae(Lr),or(Ur),or(bi),or(qr),or(Xr),or(nn),or(Gi)}}}function Ym(u){let h,d=[...u[0].place.parents].reverse(),p=[];for(let y=0;y<d.length;y+=1)p[y]=Jm(Xm(u,d,y));return{c(){for(let y=0;y<p.length;y+=1)p[y].c();h=ur()},l(y){for(let _=0;_<p.length;_+=1)p[_].l(y);h=ur()},m(y,_){for(let a=0;a<p.length;a+=1)p[a]&&p[a].m(y,_);Be(y,h,_)},p(y,_){if(_[0]&1){d=[...y[0].place.parents].reverse();let a;for(a=0;a<d.length;a+=1){const I=Xm(y,d,a);p[a]?p[a].p(I,_):(p[a]=Jm(I),p[a].c(),p[a].m(h.parentNode,h))}for(;a<p.length;a+=1)p[a].d(1);p.length=d.length}},d(y){ln(p,y),y&&ae(h)}}}function Jm(u){let h,d=u[32].name+"",p,y,_,a=" &gt; ",I;return{c(){h=je("a"),p=Vt(d),_=new Ll(!1),I=ur(),this.h()},l(T){h=Ge(T,"A",{href:!0,"data-sveltekit-noscroll":!0,class:!0});var D=Ve(h);p=Ut(D,d),D.forEach(ae),_=Rl(T,!1),I=ur(),this.h()},h(){ne(h,"href",y=ha+"/"+u[32].code+"/"),ne(h,"data-sveltekit-noscroll",""),ne(h,"class","svelte-hmrro5"),_.a=I},m(T,D){Be(T,h,D),Ae(h,p),_.m(a,T,D),Be(T,I,D)},p(T,D){D[0]&1&&d!==(d=T[32].name+"")&&Mr(p,d),D[0]&1&&y!==(y=ha+"/"+T[32].code+"/")&&ne(h,"href",y)},d(T){T&&ae(h),T&&ae(I),T&&_.d()}}}function q1(u){let h,d;return{c(){h=je("p"),d=Vt("Zoom and click on map to explore other areas"),this.h()},l(p){h=Ge(p,"P",{class:!0});var y=Ve(h);d=Ut(y,"Zoom and click on map to explore other areas"),y.forEach(ae),this.h()},h(){ne(h,"class","text-bold")},m(p,y){Be(p,h,y),Ae(h,d)},p:pi,d(p){p&&ae(h)}}}function j1(u){let h,d,p=u[0].place.name+"",y,_,a,I,T,D,F;return{c(){h=Vt("You are currently viewing "),d=je("span"),y=Vt(p),_=bt(),a=je("span"),I=bt(),T=je("p"),D=je("span"),F=Vt("Zoom and click on map to explore other areas"),this.h()},l(M){h=Ut(M,"You are currently viewing "),d=Ge(M,"SPAN",{style:!0});var L=Ve(d);y=Ut(L,p),L.forEach(ae),_=xt(M),a=Ge(M,"SPAN",{style:!0});var X=Ve(a);X.forEach(ae),I=xt(M),T=Ge(M,"P",{});var oe=Ve(T);D=Ge(oe,"SPAN",{class:!0});var se=Ve(D);F=Ut(se,"Zoom and click on map to explore other areas"),se.forEach(ae),oe.forEach(ae),this.h()},h(){Je(d,"color","#3878c5"),Je(a,"color","#00205b"),ne(D,"class","text-bold")},m(M,L){Be(M,h,L),Be(M,d,L),Ae(d,y),Be(M,_,L),Be(M,a,L),Be(M,I,L),Be(M,T,L),Ae(T,D),Ae(D,F)},p(M,L){L[0]&1&&p!==(p=M[0].place.name+"")&&Mr(y,p)},d(M){M&&ae(h),M&&ae(d),M&&ae(_),M&&ae(a),M&&ae(I),M&&ae(T)}}}function G1(u){let h,d,p,y,_,a,I;const T=[ts[u[34]],{id:u[34]+"-fill"},{type:"fill"},{isChild:u[5][u[34]]},{click:!0},{selected:u[4].selected},{highlight:!0},{highlighted:u[4].highlighted},{hover:!0},{hovered:u[4].hovered},{layout:{visibility:u[4].type==u[34]||u[4].childType==u[34]?"visible":"none"}},{paint:u[4].type==u[34]?$i["fill-self"]:u[4].childType==u[34]?$i["fill-child"]:$i.fill}];let D={};for(let oe=0;oe<T.length;oe+=1)D=yh(D,T[oe]);h=new Ip({props:D}),h.$on("select",u[10]);const F=[ts[u[34]],{id:u[34]+"-bounds"},{type:"line"},{selected:u[4].selected},{highlight:!0},{highlighted:u[4].highlighted},{layout:{visibility:u[4].type==u[34]||u[4].childType==u[34]?"visible":"none"}},{paint:u[4].type==u[34]?$i["line-active"]:u[4].childType==u[34]?$i["line-child"]:$i.line}];let M={};for(let oe=0;oe<F.length;oe+=1)M=yh(M,F[oe]);p=new Ip({props:M});const L=[ts[u[34]],{id:u[34]+"-self"},{type:"line"},{selected:u[4].selected},{layout:{visibility:u[4].type==u[34]?"visible":"none"}},{paint:u[4].type==u[34]?$i["line-self"]:$i.line}];let X={};for(let oe=0;oe<L.length;oe+=1)X=yh(X,L[oe]);return _=new Ip({props:X}),{c(){ir(h.$$.fragment),d=bt(),ir(p.$$.fragment),y=bt(),ir(_.$$.fragment),a=bt()},l(oe){nr(h.$$.fragment,oe),d=xt(oe),nr(p.$$.fragment,oe),y=xt(oe),nr(_.$$.fragment,oe),a=xt(oe)},m(oe,se){ar(h,oe,se),Be(oe,d,se),ar(p,oe,se),Be(oe,y,se),ar(_,oe,se),Be(oe,a,se),I=!0},p(oe,se){const pe=se[0]&48?gh(T,[se&0&&_h(ts[oe[34]]),T[1],T[2],se[0]&32&&{isChild:oe[5][oe[34]]},T[4],se[0]&16&&{selected:oe[4].selected},T[6],se[0]&16&&{highlighted:oe[4].highlighted},T[8],se[0]&16&&{hovered:oe[4].hovered},se[0]&16&&{layout:{visibility:oe[4].type==oe[34]||oe[4].childType==oe[34]?"visible":"none"}},se[0]&16&&{paint:oe[4].type==oe[34]?$i["fill-self"]:oe[4].childType==oe[34]?$i["fill-child"]:$i.fill}]):{};h.$set(pe);const xe=se[0]&16?gh(F,[se&0&&_h(ts[oe[34]]),F[1],F[2],se[0]&16&&{selected:oe[4].selected},F[4],se[0]&16&&{highlighted:oe[4].highlighted},se[0]&16&&{layout:{visibility:oe[4].type==oe[34]||oe[4].childType==oe[34]?"visible":"none"}},se[0]&16&&{paint:oe[4].type==oe[34]?$i["line-active"]:oe[4].childType==oe[34]?$i["line-child"]:$i.line}]):{};p.$set(xe);const be=se[0]&16?gh(L,[se&0&&_h(ts[oe[34]]),L[1],L[2],se[0]&16&&{selected:oe[4].selected},se[0]&16&&{layout:{visibility:oe[4].type==oe[34]?"visible":"none"}},se[0]&16&&{paint:oe[4].type==oe[34]?$i["line-self"]:$i.line}]):{};_.$set(be)},i(oe){I||(tt(h.$$.fragment,oe),tt(p.$$.fragment,oe),tt(_.$$.fragment,oe),I=!0)},o(oe){ut(h.$$.fragment,oe),ut(p.$$.fragment,oe),ut(_.$$.fragment,oe),I=!1},d(oe){or(h,oe),oe&&ae(d),or(p,oe),oe&&ae(y),or(_,oe),oe&&ae(a)}}}function Qm(u){let h,d;const p=[_d[u[34]]];let y={$$slots:{default:[G1]},$$scope:{ctx:u}};for(let _=0;_<p.length;_+=1)y=yh(y,p[_]);return h=new Q_({props:y}),{c(){ir(h.$$.fragment)},l(_){nr(h.$$.fragment,_)},m(_,a){ar(h,_,a),d=!0},p(_,a){const I=a&0?gh(p,[_h(_d[_[34]])]):{};a[0]&48|a[1]&128&&(I.$$scope={dirty:a,ctx:_}),h.$set(I)},i(_){d||(tt(h.$$.fragment,_),d=!0)},o(_){ut(h.$$.fragment,_),d=!1},d(_){or(h,_)}}}function Z1(u){let h,d,p=["dz","sdz","dea","lgd"],y=[];for(let a=0;a<4;a+=1)y[a]=Qm(Hm(u,p,a));const _=a=>ut(y[a],1,1,()=>{y[a]=null});return{c(){for(let a=0;a<4;a+=1)y[a].c();h=ur()},l(a){for(let I=0;I<4;I+=1)y[I].l(a);h=ur()},m(a,I){for(let T=0;T<4;T+=1)y[T]&&y[T].m(a,I);Be(a,h,I),d=!0},p(a,I){if(I[0]&1072){p=["dz","sdz","dea","lgd"];let T;for(T=0;T<4;T+=1){const D=Hm(a,p,T);y[T]?(y[T].p(D,I),tt(y[T],1)):(y[T]=Qm(D),y[T].c(),tt(y[T],1),y[T].m(h.parentNode,h))}for(En(),T=4;T<4;T+=1)_(T);Tn()}},i(a){if(!d){for(let I=0;I<4;I+=1)tt(y[I]);d=!0}},o(a){y=y.filter(Boolean);for(let I=0;I<4;I+=1)ut(y[I]);d=!1},d(a){ln(y,a),a&&ae(h)}}}function $m(u){let h,d,p=u[0].place.name+"",y,_,a,I=[...u[0].place.parents].reverse(),T=[];for(let D=0;D<I.length;D+=1)T[D]=ey(Km(u,I,D));return{c(){h=je("span"),d=Vt("Select a larger area containing "),y=Vt(p),_=bt(),a=je("span");for(let D=0;D<T.length;D+=1)T[D].c();this.h()},l(D){h=Ge(D,"SPAN",{class:!0});var F=Ve(h);d=Ut(F,"Select a larger area containing "),y=Ut(F,p),F.forEach(ae),_=xt(D),a=Ge(D,"SPAN",{class:!0});var M=Ve(a);for(let L=0;L<T.length;L+=1)T[L].l(M);M.forEach(ae),this.h()},h(){ne(h,"class","text-bold"),ne(a,"class","text-small")},m(D,F){Be(D,h,F),Ae(h,d),Ae(h,y),Be(D,_,F),Be(D,a,F);for(let M=0;M<T.length;M+=1)T[M]&&T[M].m(a,null)},p(D,F){if(F[0]&1&&p!==(p=D[0].place.name+"")&&Mr(y,p),F[0]&1){I=[...D[0].place.parents].reverse();let M;for(M=0;M<I.length;M+=1){const L=Km(D,I,M);T[M]?T[M].p(L,F):(T[M]=ey(L),T[M].c(),T[M].m(a,null))}for(;M<T.length;M+=1)T[M].d(1);T.length=I.length}},d(D){D&&ae(h),D&&ae(_),D&&ae(a),ln(T,D)}}}function ey(u){let h,d,p=u[31]>0?"↳ ":"",y,_=u[32].name+"",a,I;return{c(){h=je("span"),d=new Ll(!1),y=je("a"),a=Vt(_),this.h()},l(T){h=Ge(T,"SPAN",{style:!0});var D=Ve(h);d=Rl(D,!1),y=Ge(D,"A",{href:!0,"data-sveltekit-noscroll":!0,class:!0});var F=Ve(y);a=Ut(F,_),F.forEach(ae),D.forEach(ae),this.h()},h(){d.a=y,ne(y,"href",I=ha+"/"+u[32].code),ne(y,"data-sveltekit-noscroll",""),ne(y,"class","svelte-hmrro5"),Je(h,"display","block"),Je(h,"margin-left",(u[31]>0?(u[31]-1)*15:0)+"px")},m(T,D){Be(T,h,D),d.m(p,h),Ae(h,y),Ae(y,a)},p(T,D){D[0]&1&&_!==(_=T[32].name+"")&&Mr(a,_),D[0]&1&&I!==(I=ha+"/"+T[32].code)&&ne(y,"href",I)},d(T){T&&ae(h)}}}function K1(u){let h,d,p=u[0].place.name+"",y,_,a=Zn[u[0].place.type].name+"",I;return{c(){h=je("span"),d=Vt("No areas below "),y=Vt(p),_=bt(),I=Vt(a),this.h()},l(T){h=Ge(T,"SPAN",{class:!0});var D=Ve(h);d=Ut(D,"No areas below "),y=Ut(D,p),_=xt(D),I=Ut(D,a),D.forEach(ae),this.h()},h(){ne(h,"class","muted")},m(T,D){Be(T,h,D),Ae(h,d),Ae(h,y),Ae(h,_),Ae(h,I)},p(T,D){D[0]&1&&p!==(p=T[0].place.name+"")&&Mr(y,p),D[0]&1&&a!==(a=Zn[T[0].place.type].name+"")&&Mr(I,a)},d(T){T&&ae(h)}}}function H1(u){let h,d,p=(u[0].place.children[0]?Zn[u[0].place.children[0].type].name:"Areas")+"",y,_,a=u[0].place.name+"",I,T,D,F,M=u[0].place.children,L=[];for(let X=0;X<M.length;X+=1)L[X]=ty(Zm(u,M,X));return{c(){h=je("span"),d=Vt("Select a "),y=Vt(p),_=Vt(" within "),I=Vt(a),T=je("br"),D=bt(),F=je("span");for(let X=0;X<L.length;X+=1)L[X].c();this.h()},l(X){h=Ge(X,"SPAN",{class:!0});var oe=Ve(h);d=Ut(oe,"Select a "),y=Ut(oe,p),_=Ut(oe," within "),I=Ut(oe,a),oe.forEach(ae),T=Ge(X,"BR",{}),D=xt(X),F=Ge(X,"SPAN",{class:!0});var se=Ve(F);for(let pe=0;pe<L.length;pe+=1)L[pe].l(se);se.forEach(ae),this.h()},h(){ne(h,"class","text-bold"),ne(F,"class","text-small")},m(X,oe){Be(X,h,oe),Ae(h,d),Ae(h,y),Ae(h,_),Ae(h,I),Be(X,T,oe),Be(X,D,oe),Be(X,F,oe);for(let se=0;se<L.length;se+=1)L[se]&&L[se].m(F,null)},p(X,oe){if(oe[0]&1&&p!==(p=(X[0].place.children[0]?Zn[X[0].place.children[0].type].name:"Areas")+"")&&Mr(y,p),oe[0]&1&&a!==(a=X[0].place.name+"")&&Mr(I,a),oe[0]&1){M=X[0].place.children;let se;for(se=0;se<M.length;se+=1){const pe=Zm(X,M,se);L[se]?L[se].p(pe,oe):(L[se]=ty(pe),L[se].c(),L[se].m(F,null))}for(;se<L.length;se+=1)L[se].d(1);L.length=M.length}},d(X){X&&ae(h),X&&ae(T),X&&ae(D),X&&ae(F),ln(L,X)}}}function ty(u){let h,d=u[29].name+"",p,y,_=u[31]<u[0].place.children.length-1?", ":"",a;return{c(){h=je("a"),p=Vt(d),a=Vt(_),this.h()},l(I){h=Ge(I,"A",{href:!0,"data-sveltekit-noscroll":!0,class:!0});var T=Ve(h);p=Ut(T,d),T.forEach(ae),a=Ut(I,_),this.h()},h(){ne(h,"href",y=ha+"/"+u[29].code),ne(h,"data-sveltekit-noscroll",""),ne(h,"class","svelte-hmrro5")},m(I,T){Be(I,h,T),Ae(h,p),Be(I,a,T)},p(I,T){T[0]&1&&d!==(d=I[29].name+"")&&Mr(p,d),T[0]&1&&y!==(y=ha+"/"+I[29].code)&&ne(h,"href",y),T[0]&1&&_!==(_=I[31]<I[0].place.children.length-1?", ":"")&&Mr(a,_)},d(I){I&&ae(h),I&&ae(a)}}}function X1(u){let h,d,p=u[0].place&&u[0].ni&&Wm(u);return{c(){p&&p.c(),h=ur()},l(y){p&&p.l(y),h=ur()},m(y,_){p&&p.m(y,_),Be(y,h,_),d=!0},p(y,_){y[0].place&&y[0].ni?p?(p.p(y,_),_[0]&1&&tt(p,1)):(p=Wm(y),p.c(),tt(p,1),p.m(h.parentNode,h)):p&&(En(),ut(p,1,1,()=>{p=null}),Tn())},i(y){d||(tt(p),d=!0)},o(y){ut(p),d=!1},d(y){p&&p.d(y),y&&ae(h)}}}function W1(u){let h,d,p,y,_,a,I,T,D,F,M,L,X,oe,se,pe;return document.title=h=u[0].place.name+" Local Statistics Explorer",X=new a1({}),se=new d_({props:{column:"wide",$$slots:{default:[X1]},$$scope:{ctx:u}}}),{c(){d=je("meta"),p=je("meta"),_=je("meta"),a=je("meta"),T=je("meta"),F=je("meta"),L=bt(),ir(X.$$.fragment),oe=bt(),ir(se.$$.fragment),this.h()},l(xe){const be=h_("svelte-ovl3z1",document.head);d=Ge(be,"META",{name:!0,content:!0}),p=Ge(be,"META",{property:!0,content:!0}),_=Ge(be,"META",{property:!0,content:!0}),a=Ge(be,"META",{property:!0,content:!0}),T=Ge(be,"META",{property:!0,content:!0}),F=Ge(be,"META",{name:!0,content:!0}),be.forEach(ae),L=xt(xe),nr(X.$$.fragment,xe),oe=xt(xe),nr(se.$$.fragment,xe),this.h()},h(){ne(d,"name","description"),ne(d,"content",""),ne(p,"property","og:title"),ne(p,"content",y=u[0].place.name+" Local Statistics"),ne(_,"property","og:type"),ne(_,"content","website"),ne(a,"property","og:url"),ne(a,"content",I=wh.base+"/"+u[0].place.code+"/"),ne(T,"property","og:description"),ne(T,"content",D="Explore NISRA Statistics for "+u[0].place.name+"."),ne(F,"name","description"),ne(F,"content",M="Explore NISRA Statistics for "+u[0].place.name+".")},m(xe,be){Ae(document.head,d),Ae(document.head,p),Ae(document.head,_),Ae(document.head,a),Ae(document.head,T),Ae(document.head,F),Be(xe,L,be),ar(X,xe,be),Be(xe,oe,be),ar(se,xe,be),pe=!0},p(xe,be){(!pe||be[0]&1)&&h!==(h=xe[0].place.name+" Local Statistics Explorer")&&(document.title=h),(!pe||be[0]&1&&y!==(y=xe[0].place.name+" Local Statistics"))&&ne(p,"content",y),(!pe||be[0]&1&&I!==(I=wh.base+"/"+xe[0].place.code+"/"))&&ne(a,"content",I),(!pe||be[0]&1&&D!==(D="Explore NISRA Statistics for "+xe[0].place.name+"."))&&ne(T,"content",D),(!pe||be[0]&1&&M!==(M="Explore NISRA Statistics for "+xe[0].place.name+"."))&&ne(F,"content",M);const ct={};be[0]&255|be[1]&128&&(ct.$$scope={dirty:be,ctx:xe}),se.$set(ct)},i(xe){pe||(tt(X.$$.fragment,xe),tt(se.$$.fragment,xe),pe=!0)},o(xe){ut(X.$$.fragment,xe),ut(se.$$.fragment,xe),pe=!1},d(xe){ae(d),ae(p),ae(_),ae(a),ae(T),ae(F),xe&&ae(L),or(X,xe),xe&&ae(oe),or(se,xe)}}}function mh(u){let h=(u*100).toFixed(1);return h<.1?"<0.1%":h+"%"}function Wt(u,h){return h.meta_data.hasOwnProperty(u)?h.meta_data[u][0].year:null}function ry(u){let h=u.data.MYETotal.value/(u.hectares/100);return h<10?h="< 10":h=(Math.round(h*10)/10).toLocaleString(void 0,{minimumFractionDigits:1}),h}function Y1(u,h,d){let p,y,_,{data:a}=h,I,T,D=null,F={selected:null,type:null,childType:null,highlighted:[],hovered:null},M={};Object.keys(ts).forEach(Ne=>d(5,M[Ne]=!1,M));function L(Ne,Rt,Me){const $e=(er,Hr)=>er+Hr;let mt=Ne[0],qt=Me[0],Bt=Rt[0],St="perc",Oe=a.place.data[mt][St][qt],ot=a.place.data[mt][St][Bt],Dr=a.ni.data[mt][St][qt],Kr=ah[mt].map(er=>er.category),vi=ah[mt].map(er=>er.label?er.label:er.category);return Kr.map((er,Hr)=>Array.isArray(er)?{x:vi[Hr],y:er.map(Jt=>Oe[Jt]).reduce($e,0),ni:er.map(Jt=>Dr[Jt]).reduce($e,0),prev:er.map(Jt=>ot[Jt]).reduce($e,0)}:{x:vi[Hr],y:Oe[er],ni:Dr[er],prev:ot[er]})}function X(Ne){let Rt=[];if(a.place.data.hasOwnProperty(Ne)){let Me=a.place.data[Ne].perc,$e,mt;Me.hasOwnProperty("2021")?($e=Me[2021],mt=a.ni.data[Ne].perc[2021]):($e=Me,mt=a.ni.data[Ne].perc);for(let qt=0;qt<Object.keys($e).length;qt++)Object.values($e)[qt]<=100&&(Rt.push({group:"Northern Ireland",category:Object.values(ah[Ne])[qt].label,perc:Object.values(mt)[qt],width:0}),a.place.name!="Northern Ireland"&&Rt.push({group:a.place.name,category:Object.values(ah[Ne])[qt].label,perc:Object.values($e)[qt],width:0}))}return Rt}function oe(Ne){D&&D.fitBounds(Ne,{padding:20})}function se(Ne){let Rt=JSON.parse(JSON.stringify(F)),Me=a.place.code,$e=a.place.type,mt=a.place.children[0]?a.place.children.map(ot=>ot.code):[],qt=a.place.type=="rgn"?"cty":mt[0]?a.place.children[0].type:null;d(4,F.selected=Me,F),d(4,F.type=$e,F),d(4,F.childType=qt,F),d(4,F.highlighted=mt,F);let Bt=Object.keys(ts),St=["fill-color","fill-opacity"],Oe=["line-color","line-width","line-opacity"];D&&(F.type!=Rt.type||F.childType!=Rt.childType)&&(Bt.forEach(ot=>{let Dr=ot==$e||qt&&ot==qt?"visible":"none";D.setLayoutProperty(ot+"-fill","visibility",Dr),D.setLayoutProperty(ot+"-bounds","visibility",Dr),a.place.type!="ni"&&D.setLayoutProperty(ot+"-self","visibility",Dr),d(5,M[ot]=ot==qt,M)}),a.place.type!="ni"&&(St.forEach(ot=>D.setPaintProperty($e+"-fill",ot,$i[mt[0]?"fill-active":"fill-self"][ot])),Oe.forEach(ot=>{D.setPaintProperty($e+"-bounds",ot,$i["line-active"][ot]),D.setPaintProperty($e+"-self",ot,$i["line-self"][ot])})),qt&&(St.forEach(ot=>D.setPaintProperty(qt+"-fill",ot,$i["fill-child"][ot])),Oe.forEach(ot=>D.setPaintProperty(qt+"-bounds",ot,$i["line-child"][ot]))))}function pe(Ne){se(),oe(a.place.bounds)}function xe(Ne){gd(`${ha}/${Ne.detail.code}/`,{noScroll:!0})}function be(Ne){gd(`${ha}/${Ne.detail.value}/`,{noScroll:!0})}function ct(){d(2,T=I<575?1:window.getComputedStyle(grid).getPropertyValue("grid-template-columns").split(" ").length)}function We(Ne){return Ne==1?"largest":Ne==a.place.count?"smallest":Ne+n_(Ne)+" largest"}function De(Ne){let Rt="";if(Ne.data.hasOwnProperty("PopChange")){let Me=Ne.data.PopChange.value,$e=Object.keys(Me).slice(-1),mt=$e-10,qt=(Me[$e]-Me[mt])/Me[mt]*100;Rt="<p>The population of "+Ne.name+" in "+mt+' was <span class="text-big">'+Me[mt].toLocaleString()+"</span> and in "+$e+' was <span class="text-big">'+Me[$e].toLocaleString()+'</span><p><span class="em '+a_(qt)+'">'+o_(qt,"%",1)+"</span> since "+mt+" Mid-Year Population Estimate</p>"}return Rt}function Ze(Ne){let Me=Ne.replaceAll("[",".").replaceAll("]","").split("."),$e=a.place.data;for(let mt=0;mt<Me.length;mt++)$e.hasOwnProperty(Me[mt])?$e=$e[Me[mt]]:$e=[];return $e.length!=0&Me.includes("perc")&&($e=$e.toFixed(0)+"%"),$e}function Dt(Ne){let Me=Ne.replaceAll("[",".").replaceAll("]","").split("."),$e=a.ni.data,mt=Ze(Ne);Me[0]=="grouped_data_nocompare"|Me[0]=="grouped_data_areacompare"&&($e=a.ni);for(let qt=0;qt<Me.length;qt++)$e.hasOwnProperty(Me[qt])?$e=$e[Me[qt]]:$e=[];return mt>$e+2?$e="<p>This is higher than the NI value</p>":mt<$e-2?$e="<p>This is lower than the NI value</p>":$e="<p>This is similar to the NI value</p>",$e}function zt(Ne){return a.place.data.hasOwnProperty(Ne)?"Census "+Object.keys(a.place.data[Ne].perc).slice(-1):null}function Ue(Ne,Rt){return Rt.type!="ni"?"You can also explore "+Ne+" data for <a href = '"+ha+"/"+Rt.parents[0].code+"/' data-sveltekit-noscroll>"+Rt.parents[0].name+" </a>":""}function Ke(Ne){let Rt=Ne.data.MYETotal.value/(Ne.hectares/100),Me=a.ni.data.MYETotal.value/(a.ni.hectares/100),$e=Rt/Me;return Math.round($e)==1?$e='Approximately <span class = "em" style = "background-color: lightgrey">the same density level</span> as the Northern Ireland average':$e>1?$e='Approximately <span class = "em" style = "background-color: lightgrey">'+$e.toFixed(0)+" times more dense</span> than the Northern Ireland average":$e='Approximately <span class = "em" style = "background-color: lightgrey">1/'+(1/$e).toFixed(0)+" as dense</span> as the Northern Ireland average",$e}function vt(Ne){D=Ne,d(3,D)}function cr(){I=this.clientWidth,d(1,I)}return u.$$set=Ne=>{"data"in Ne&&d(0,a=Ne.data)},u.$$.update=()=>{u.$$.dirty[0]&2&&I&&ct(),u.$$.dirty[0]&1&&d(7,p=a.place&&a.place.type!="ni"?"NI 2021":null),u.$$.dirty[0]&524289&&d(6,y=_?null:a.place.type!="ni"?"ni":null),u.$$.dirty[0]&1&&a.place&&pe(a.place)},d(19,_=!1),[a,I,T,D,F,M,y,p,L,X,xe,be,We,De,Ze,Dt,zt,Ue,Ke,_,vt,cr]}class ab extends mn{constructor(h){super(),yn(this,h,Y1,W1,gn,{data:0},null,[-1,-1])}}export{ab as component,nb as universal};
