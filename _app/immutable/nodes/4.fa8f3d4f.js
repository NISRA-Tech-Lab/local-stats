import{g as a_,c as _d,a as vd,s as o_,S as s_,b as ts,d as rs}from"../chunks/navigation.6ee7ba7c.js";import{g as Kn,a as kh,m as ns,b as Tp,c as l_,d as Yi,e as bd}from"../chunks/config.1f593336.js";import{S as fn,i as dn,s as mn,k as qe,l as je,m as Ue,h as ae,n as oe,R as Ku,b as Le,T as Hu,g as Qe,v as En,d as ut,f as zn,P as ay,o as oy,K as Fu,M as Nu,N as Uu,O as Vu,w as qu,e as or,E as Xu,U as u_,Q as Zt,V as Sr,p as Xe,W as Hn,X as Xn,C as Ie,D as si,Y as tn,Z as as,q as Ot,r as Ft,u as Tr,y as er,z as tr,A as rr,B as ir,a as vt,c as bt,_ as Ph,G as xd,I as c_,$ as Ol,a0 as Fl,F as wd,L as h_,a1 as p_,a2 as f_,a3 as _h,a4 as vh,a5 as bh}from"../chunks/index.baf6a862.js";import{b as Na}from"../chunks/paths.fc2b7c1a.js";import{S as d_}from"../chunks/Section.6106804d.js";/* empty css                                                              */import{w as kr,h as Ci}from"../chunks/singletons.590d61c1.js";async function Sd(u,h){return await(await h(kh.app_json_data+u+".json")).json()}async function m_({params:u,fetch:h}){let d=u.code,p=await a_(kh.search_data,h),y={};p.forEach(E=>y[E.code]=E.name),p.forEach(E=>{E.typepl=Kn[E.type].pl,E.typenm=Kn[E.type].name,E.typestr=y[E.parent]&&E.parent==E.code?`View:  ${y[E.parent]}
        ${Kn[E.parent_type].name}  `:y[E.parent]&&E.parent!=E.code?`${Kn[E.type].name} `:""});let _=p.sort((E,D)=>E.name.localeCompare(D.name)),a=await Sd("N92000002",h),T=await Sd(d,h);return{search_data:_,place:T,ni:a}}const ob=Object.freeze(Object.defineProperty({__proto__:null,load:m_},Symbol.toStringTag,{value:"Module"}));var y_=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function g_(u){return u&&u.__esModule&&Object.prototype.hasOwnProperty.call(u,"default")?u.default:u}var __={rgb2hsl:Wu,rgb2hsv:Ch,rgb2hwb:Yu,rgb2cmyk:Ju,rgb2keyword:Qu,rgb2xyz:Vp,rgb2lab:qp,rgb2lch:v_,hsl2rgb:Mh,hsl2hsv:b_,hsl2hwb:x_,hsl2cmyk:w_,hsl2keyword:S_,hsv2rgb:Dh,hsv2hsl:k_,hsv2hwb:E_,hsv2cmyk:z_,hsv2keyword:T_,hwb2rgb:$u,hwb2hsl:I_,hwb2hsv:A_,hwb2cmyk:P_,hwb2keyword:C_,cmyk2rgb:ec,cmyk2hsl:M_,cmyk2hsv:D_,cmyk2hwb:L_,cmyk2keyword:R_,keyword2rgb:Fs,keyword2hsl:N_,keyword2hsv:U_,keyword2hwb:V_,keyword2cmyk:q_,keyword2lab:j_,keyword2xyz:Z_,xyz2rgb:sy,xyz2lab:ly,xyz2lch:B_,lab2xyz:jp,lab2rgb:uy,lab2lch:Zp,lch2lab:Gp,lch2xyz:O_,lch2rgb:F_};function Wu(u){var h=u[0]/255,d=u[1]/255,p=u[2]/255,y=Math.min(h,d,p),_=Math.max(h,d,p),a=_-y,T,E,D;return _==y?T=0:h==_?T=(d-p)/a:d==_?T=2+(p-h)/a:p==_&&(T=4+(h-d)/a),T=Math.min(T*60,360),T<0&&(T+=360),D=(y+_)/2,_==y?E=0:D<=.5?E=a/(_+y):E=a/(2-_-y),[T,E*100,D*100]}function Ch(u){var h=u[0],d=u[1],p=u[2],y=Math.min(h,d,p),_=Math.max(h,d,p),a=_-y,T,E,D;return _==0?E=0:E=a/_*1e3/10,_==y?T=0:h==_?T=(d-p)/a:d==_?T=2+(p-h)/a:p==_&&(T=4+(h-d)/a),T=Math.min(T*60,360),T<0&&(T+=360),D=_/255*1e3/10,[T,E,D]}function Yu(u){var h=u[0],d=u[1],_=u[2],p=Wu(u)[0],y=1/255*Math.min(h,Math.min(d,_)),_=1-1/255*Math.max(h,Math.max(d,_));return[p,y*100,_*100]}function Ju(u){var h=u[0]/255,d=u[1]/255,p=u[2]/255,y,_,a,T;return T=Math.min(1-h,1-d,1-p),y=(1-h-T)/(1-T)||0,_=(1-d-T)/(1-T)||0,a=(1-p-T)/(1-T)||0,[y*100,_*100,a*100,T*100]}function Qu(u){return cy[JSON.stringify(u)]}function Vp(u){var h=u[0]/255,d=u[1]/255,p=u[2]/255;h=h>.04045?Math.pow((h+.055)/1.055,2.4):h/12.92,d=d>.04045?Math.pow((d+.055)/1.055,2.4):d/12.92,p=p>.04045?Math.pow((p+.055)/1.055,2.4):p/12.92;var y=h*.4124+d*.3576+p*.1805,_=h*.2126+d*.7152+p*.0722,a=h*.0193+d*.1192+p*.9505;return[y*100,_*100,a*100]}function qp(u){var h=Vp(u),d=h[0],p=h[1],y=h[2],_,a,T;return d/=95.047,p/=100,y/=108.883,d=d>.008856?Math.pow(d,1/3):7.787*d+16/116,p=p>.008856?Math.pow(p,1/3):7.787*p+16/116,y=y>.008856?Math.pow(y,1/3):7.787*y+16/116,_=116*p-16,a=500*(d-p),T=200*(p-y),[_,a,T]}function v_(u){return Zp(qp(u))}function Mh(u){var h=u[0]/360,d=u[1]/100,p=u[2]/100,y,_,a,T,E;if(d==0)return E=p*255,[E,E,E];p<.5?_=p*(1+d):_=p+d-p*d,y=2*p-_,T=[0,0,0];for(var D=0;D<3;D++)a=h+1/3*-(D-1),a<0&&a++,a>1&&a--,6*a<1?E=y+(_-y)*6*a:2*a<1?E=_:3*a<2?E=y+(_-y)*(2/3-a)*6:E=y,T[D]=E*255;return T}function b_(u){var h=u[0],d=u[1]/100,p=u[2]/100,y,_;return p===0?[0,0,0]:(p*=2,d*=p<=1?p:2-p,_=(p+d)/2,y=2*d/(p+d),[h,y*100,_*100])}function x_(u){return Yu(Mh(u))}function w_(u){return Ju(Mh(u))}function S_(u){return Qu(Mh(u))}function Dh(u){var h=u[0]/60,d=u[1]/100,E=u[2]/100,p=Math.floor(h)%6,y=h-Math.floor(h),_=255*E*(1-d),a=255*E*(1-d*y),T=255*E*(1-d*(1-y)),E=255*E;switch(p){case 0:return[E,T,_];case 1:return[a,E,_];case 2:return[_,E,T];case 3:return[_,a,E];case 4:return[T,_,E];case 5:return[E,_,a]}}function k_(u){var h=u[0],d=u[1]/100,p=u[2]/100,y,_;return _=(2-d)*p,y=d*p,y/=_<=1?_:2-_,y=y||0,_/=2,[h,y*100,_*100]}function E_(u){return Yu(Dh(u))}function z_(u){return Ju(Dh(u))}function T_(u){return Qu(Dh(u))}function $u(u){var h=u[0]/360,d=u[1]/100,p=u[2]/100,y=d+p,_,a,T,E;switch(y>1&&(d/=y,p/=y),_=Math.floor(6*h),a=1-p,T=6*h-_,_&1&&(T=1-T),E=d+T*(a-d),_){default:case 6:case 0:r=a,g=E,b=d;break;case 1:r=E,g=a,b=d;break;case 2:r=d,g=a,b=E;break;case 3:r=d,g=E,b=a;break;case 4:r=E,g=d,b=a;break;case 5:r=a,g=d,b=E;break}return[r*255,g*255,b*255]}function I_(u){return Wu($u(u))}function A_(u){return Ch($u(u))}function P_(u){return Ju($u(u))}function C_(u){return Qu($u(u))}function ec(u){var h=u[0]/100,d=u[1]/100,p=u[2]/100,y=u[3]/100,_,a,T;return _=1-Math.min(1,h*(1-y)+y),a=1-Math.min(1,d*(1-y)+y),T=1-Math.min(1,p*(1-y)+y),[_*255,a*255,T*255]}function M_(u){return Wu(ec(u))}function D_(u){return Ch(ec(u))}function L_(u){return Yu(ec(u))}function R_(u){return Qu(ec(u))}function sy(u){var h=u[0]/100,d=u[1]/100,p=u[2]/100,y,_,a;return y=h*3.2406+d*-1.5372+p*-.4986,_=h*-.9689+d*1.8758+p*.0415,a=h*.0557+d*-.204+p*1.057,y=y>.0031308?1.055*Math.pow(y,1/2.4)-.055:y=y*12.92,_=_>.0031308?1.055*Math.pow(_,1/2.4)-.055:_=_*12.92,a=a>.0031308?1.055*Math.pow(a,1/2.4)-.055:a=a*12.92,y=Math.min(Math.max(0,y),1),_=Math.min(Math.max(0,_),1),a=Math.min(Math.max(0,a),1),[y*255,_*255,a*255]}function ly(u){var h=u[0],d=u[1],p=u[2],y,_,a;return h/=95.047,d/=100,p/=108.883,h=h>.008856?Math.pow(h,1/3):7.787*h+16/116,d=d>.008856?Math.pow(d,1/3):7.787*d+16/116,p=p>.008856?Math.pow(p,1/3):7.787*p+16/116,y=116*d-16,_=500*(h-d),a=200*(d-p),[y,_,a]}function B_(u){return Zp(ly(u))}function jp(u){var h=u[0],d=u[1],p=u[2],y,_,a,T;return h<=8?(_=h*100/903.3,T=7.787*(_/100)+16/116):(_=100*Math.pow((h+16)/116,3),T=Math.pow(_/100,1/3)),y=y/95.047<=.008856?y=95.047*(d/500+T-16/116)/7.787:95.047*Math.pow(d/500+T,3),a=a/108.883<=.008859?a=108.883*(T-p/200-16/116)/7.787:108.883*Math.pow(T-p/200,3),[y,_,a]}function Zp(u){var h=u[0],d=u[1],p=u[2],y,_,a;return y=Math.atan2(p,d),_=y*360/2/Math.PI,_<0&&(_+=360),a=Math.sqrt(d*d+p*p),[h,a,_]}function uy(u){return sy(jp(u))}function Gp(u){var h=u[0],d=u[1],p=u[2],y,_,a;return a=p/360*2*Math.PI,y=d*Math.cos(a),_=d*Math.sin(a),[h,y,_]}function O_(u){return jp(Gp(u))}function F_(u){return uy(Gp(u))}function Fs(u){return Lp[u]}function N_(u){return Wu(Fs(u))}function U_(u){return Ch(Fs(u))}function V_(u){return Yu(Fs(u))}function q_(u){return Ju(Fs(u))}function j_(u){return qp(Fs(u))}function Z_(u){return Vp(Fs(u))}var Lp={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,134,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,250,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,221],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[112,128,144],slategrey:[112,128,144],snow:[255,250,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,50]},cy={};for(var kd in Lp)cy[JSON.stringify(Lp[kd])]=kd;var Ip=__,Ll=function(){return new tc};for(var Ru in Ip){Ll[Ru+"Raw"]=function(u){return function(h){return typeof h=="number"&&(h=Array.prototype.slice.call(arguments)),Ip[u](h)}}(Ru);var Ed=/(\w+)2(\w+)/.exec(Ru),Ap=Ed[1],G_=Ed[2];Ll[Ap]=Ll[Ap]||{},Ll[Ap][G_]=Ll[Ru]=function(u){return function(h){typeof h=="number"&&(h=Array.prototype.slice.call(arguments));var d=Ip[u](h);if(typeof d=="string"||d===void 0)return d;for(var p=0;p<d.length;p++)d[p]=Math.round(d[p]);return d}}(Ru)}var tc=function(){this.convs={}};tc.prototype.routeSpace=function(u,h){var d=h[0];return d===void 0?this.getValues(u):(typeof d=="number"&&(d=Array.prototype.slice.call(h)),this.setValues(u,d))};tc.prototype.setValues=function(u,h){return this.space=u,this.convs={},this.convs[u]=h,this};tc.prototype.getValues=function(u){var h=this.convs[u];if(!h){var d=this.space,p=this.convs[d];h=Ll[d][u](p),this.convs[u]=h}return h};["rgb","hsl","hsv","cmyk","keyword"].forEach(function(u){tc.prototype[u]=function(h){return this.routeSpace(u,arguments)}});var hy={exports:{}};(function(u,h){(function(d,p){u.exports=p()})(y_,function(){var d,p,y;function _(a,T){if(!d)d=T;else if(!p)p=T;else{var E="var sharedChunk = {}; ("+d+")(sharedChunk); ("+p+")(sharedChunk);",D={};d(D),y=T(D),typeof window<"u"&&(y.workerUrl=window.URL.createObjectURL(new Blob([E],{type:"text/javascript"})))}}return _(["exports"],function(a){function T(e,t){return e(t={exports:{}},t.exports),t.exports}var E=D;function D(e,t,i,l){this.cx=3*e,this.bx=3*(i-e)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*t,this.by=3*(l-t)-this.cy,this.ay=1-this.cy-this.by,this.p1x=e,this.p1y=l,this.p2x=i,this.p2y=l}D.prototype.sampleCurveX=function(e){return((this.ax*e+this.bx)*e+this.cx)*e},D.prototype.sampleCurveY=function(e){return((this.ay*e+this.by)*e+this.cy)*e},D.prototype.sampleCurveDerivativeX=function(e){return(3*this.ax*e+2*this.bx)*e+this.cx},D.prototype.solveCurveX=function(e,t){var i,l,f,m,x;for(t===void 0&&(t=1e-6),f=e,x=0;x<8;x++){if(m=this.sampleCurveX(f)-e,Math.abs(m)<t)return f;var k=this.sampleCurveDerivativeX(f);if(Math.abs(k)<1e-6)break;f-=m/k}if((f=e)<(i=0))return i;if(f>(l=1))return l;for(;i<l;){if(m=this.sampleCurveX(f),Math.abs(m-e)<t)return f;e>m?i=f:l=f,f=.5*(l-i)+i}return f},D.prototype.solve=function(e,t){return this.sampleCurveY(this.solveCurveX(e,t))};var F=L;function L(e,t){this.x=e,this.y=t}L.prototype={clone:function(){return new L(this.x,this.y)},add:function(e){return this.clone()._add(e)},sub:function(e){return this.clone()._sub(e)},multByPoint:function(e){return this.clone()._multByPoint(e)},divByPoint:function(e){return this.clone()._divByPoint(e)},mult:function(e){return this.clone()._mult(e)},div:function(e){return this.clone()._div(e)},rotate:function(e){return this.clone()._rotate(e)},rotateAround:function(e,t){return this.clone()._rotateAround(e,t)},matMult:function(e){return this.clone()._matMult(e)},unit:function(){return this.clone()._unit()},perp:function(){return this.clone()._perp()},round:function(){return this.clone()._round()},mag:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals:function(e){return this.x===e.x&&this.y===e.y},dist:function(e){return Math.sqrt(this.distSqr(e))},distSqr:function(e){var t=e.x-this.x,i=e.y-this.y;return t*t+i*i},angle:function(){return Math.atan2(this.y,this.x)},angleTo:function(e){return Math.atan2(this.y-e.y,this.x-e.x)},angleWith:function(e){return this.angleWithSep(e.x,e.y)},angleWithSep:function(e,t){return Math.atan2(this.x*t-this.y*e,this.x*e+this.y*t)},_matMult:function(e){var t=e[2]*this.x+e[3]*this.y;return this.x=e[0]*this.x+e[1]*this.y,this.y=t,this},_add:function(e){return this.x+=e.x,this.y+=e.y,this},_sub:function(e){return this.x-=e.x,this.y-=e.y,this},_mult:function(e){return this.x*=e,this.y*=e,this},_div:function(e){return this.x/=e,this.y/=e,this},_multByPoint:function(e){return this.x*=e.x,this.y*=e.y,this},_divByPoint:function(e){return this.x/=e.x,this.y/=e.y,this},_unit:function(){return this._div(this.mag()),this},_perp:function(){var e=this.y;return this.y=this.x,this.x=-e,this},_rotate:function(e){var t=Math.cos(e),i=Math.sin(e),l=i*this.x+t*this.y;return this.x=t*this.x-i*this.y,this.y=l,this},_rotateAround:function(e,t){var i=Math.cos(e),l=Math.sin(e),f=t.y+l*(this.x-t.x)+i*(this.y-t.y);return this.x=t.x+i*(this.x-t.x)-l*(this.y-t.y),this.y=f,this},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}},L.convert=function(e){return e instanceof L?e:Array.isArray(e)?new L(e[0],e[1]):e};var R=typeof self<"u"?self:{},X=Math.pow(2,53)-1;function ne(e,t,i,l){var f=new E(e,t,i,l);return function(m){return f.solve(m)}}var pe=ne(.25,.1,.25,1);function ve(e,t,i){return Math.min(i,Math.max(t,e))}function de(e,t,i){var l=i-t,f=((e-t)%l+l)%l+t;return f===t?i:f}function xe(e){for(var t=[],i=arguments.length-1;i-- >0;)t[i]=arguments[i+1];for(var l=0,f=t;l<f.length;l+=1){var m=f[l];for(var x in m)e[x]=m[x]}return e}var $e=1;function ht(){return $e++}function Pe(){return function e(t){return t?(t^16*Math.random()>>t/4).toString(16):([1e7]+-[1e3]+-4e3+-8e3+-1e11).replace(/[018]/g,e)}()}function We(e){return!!e&&/^[0-9a-f]{8}-[0-9a-f]{4}-[4][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i.test(e)}function gt(e,t){e.forEach(function(i){t[i]&&(t[i]=t[i].bind(t))})}function Ke(e,t){return e.indexOf(t,e.length-t.length)!==-1}function dt(e,t,i){var l={};for(var f in e)l[f]=t.call(i||this,e[f],f,e);return l}function Ne(e,t,i){var l={};for(var f in e)t.call(i||this,e[f],f,e)&&(l[f]=e[f]);return l}function at(e){return Array.isArray(e)?e.map(at):typeof e=="object"&&e?dt(e,at):e}var Vt={};function st(e){Vt[e]||(typeof console<"u"&&console.warn(e),Vt[e]=!0)}function At(e,t,i){return(i.y-e.y)*(t.x-e.x)>(t.y-e.y)*(i.x-e.x)}function Fe(e){for(var t=0,i=0,l=e.length,f=l-1,m=void 0,x=void 0;i<l;f=i++)t+=((x=e[f]).x-(m=e[i]).x)*(m.y+x.y);return t}function qt(){return typeof WorkerGlobalScope<"u"&&typeof self<"u"&&self instanceof WorkerGlobalScope}function St(e){var t={};if(e.replace(/(?:^|(?:\s*\,\s*))([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)(?:\=(?:([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)|(?:\"((?:[^"\\]|\\.)*)\")))?/g,function(l,f,m,x){var k=m||x;return t[f]=!k||k.toLowerCase(),""}),t["max-age"]){var i=parseInt(t["max-age"],10);isNaN(i)?delete t["max-age"]:t["max-age"]=i}return t}var Ir=null;function _t(e){if(Ir==null){var t=e.navigator?e.navigator.userAgent:null;Ir=!!e.safari||!(!t||!(/\b(iPad|iPhone|iPod)\b/.test(t)||t.match("Safari")&&!t.match("Chrome")))}return Ir}function xt(e){try{var t=R[e];return t.setItem("_mapbox_test_",1),t.removeItem("_mapbox_test_"),!0}catch{return!1}}var Re,Dt,Rr,xr,Vr=R.performance&&R.performance.now?R.performance.now.bind(R.performance):Date.now.bind(Date),Br=R.requestAnimationFrame||R.mozRequestAnimationFrame||R.webkitRequestAnimationFrame||R.msRequestAnimationFrame,fr=R.cancelAnimationFrame||R.mozCancelAnimationFrame||R.webkitCancelAnimationFrame||R.msCancelAnimationFrame,yi={now:Vr,frame:function(e){var t=Br(e);return{cancel:function(){return fr(t)}}},getImageData:function(e,t){t===void 0&&(t=0);var i=R.document.createElement("canvas"),l=i.getContext("2d");if(!l)throw new Error("failed to create canvas 2d context");return i.width=e.width,i.height=e.height,l.drawImage(e,0,0,e.width,e.height),l.getImageData(-t,-t,e.width+2*t,e.height+2*t)},resolveURL:function(e){return Re||(Re=R.document.createElement("a")),Re.href=e,Re.href},hardwareConcurrency:R.navigator&&R.navigator.hardwareConcurrency||4,get devicePixelRatio(){return R.devicePixelRatio},get prefersReducedMotion(){return!!R.matchMedia&&(Dt==null&&(Dt=R.matchMedia("(prefers-reduced-motion: reduce)")),Dt.matches)}},Jt={API_URL:"https://api.mapbox.com",get EVENTS_URL(){return this.API_URL?this.API_URL.indexOf("https://api.mapbox.cn")===0?"https://events.mapbox.cn/events/v2":this.API_URL.indexOf("https://api.mapbox.com")===0?"https://events.mapbox.com/events/v2":null:null},FEEDBACK_URL:"https://apps.mapbox.com/feedback",REQUIRE_ACCESS_TOKEN:!0,ACCESS_TOKEN:null,MAX_PARALLEL_IMAGE_REQUESTS:16},rn={supported:!1,testSupport:function(e){!Mi&&xr&&($r?Gt(e):Rr=e)}},Mi=!1,$r=!1;function Gt(e){var t=e.createTexture();e.bindTexture(e.TEXTURE_2D,t);try{if(e.texImage2D(e.TEXTURE_2D,0,e.RGBA,e.RGBA,e.UNSIGNED_BYTE,xr),e.isContextLost())return;rn.supported=!0}catch{}e.deleteTexture(t),Mi=!0}R.document&&((xr=R.document.createElement("img")).onload=function(){Rr&&Gt(Rr),Rr=null,$r=!0},xr.onerror=function(){Mi=!0,Rr=null},xr.src="data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAQAAAAfQ//73v/+BiOh/AAA=");var yn="01",Yr=function(e,t){this._transformRequestFn=e,this._customAccessToken=t,this._createSkuToken()};function li(e){return e.indexOf("mapbox:")===0}Yr.prototype._createSkuToken=function(){var e=function(){for(var t="",i=0;i<10;i++)t+="0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ"[Math.floor(62*Math.random())];return{token:["1",yn,t].join(""),tokenExpiresAt:Date.now()+432e5}}();this._skuToken=e.token,this._skuTokenExpiresAt=e.tokenExpiresAt},Yr.prototype._isSkuTokenExpired=function(){return Date.now()>this._skuTokenExpiresAt},Yr.prototype.transformRequest=function(e,t){return this._transformRequestFn&&this._transformRequestFn(e,t)||{url:e}},Yr.prototype.normalizeStyleURL=function(e,t){if(!li(e))return e;var i=yr(e);return i.path="/styles/v1"+i.path,this._makeAPIURL(i,this._customAccessToken||t)},Yr.prototype.normalizeGlyphsURL=function(e,t){if(!li(e))return e;var i=yr(e);return i.path="/fonts/v1"+i.path,this._makeAPIURL(i,this._customAccessToken||t)},Yr.prototype.normalizeSourceURL=function(e,t){if(!li(e))return e;var i=yr(e);return i.path="/v4/"+i.authority+".json",i.params.push("secure"),this._makeAPIURL(i,this._customAccessToken||t)},Yr.prototype.normalizeSpriteURL=function(e,t,i,l){var f=yr(e);return li(e)?(f.path="/styles/v1"+f.path+"/sprite"+t+i,this._makeAPIURL(f,this._customAccessToken||l)):(f.path+=""+t+i,ui(f))},Yr.prototype.normalizeTileURL=function(e,t){if(this._isSkuTokenExpired()&&this._createSkuToken(),e&&!li(e))return e;var i=yr(e);i.path=i.path.replace(/(\.(png|jpg)\d*)(?=$)/,(yi.devicePixelRatio>=2||t===512?"@2x":"")+(rn.supported?".webp":"$1")),i.path=i.path.replace(/^.+\/v4\//,"/"),i.path="/v4"+i.path;var l=this._customAccessToken||function(f){for(var m=0,x=f;m<x.length;m+=1){var k=x[m].match(/^access_token=(.*)$/);if(k)return k[1]}return null}(i.params)||Jt.ACCESS_TOKEN;return Jt.REQUIRE_ACCESS_TOKEN&&l&&this._skuToken&&i.params.push("sku="+this._skuToken),this._makeAPIURL(i,l)},Yr.prototype.canonicalizeTileURL=function(e,t){var i=yr(e);if(!i.path.match(/(^\/v4\/)/)||!i.path.match(/\.[\w]+$/))return e;var l="mapbox://tiles/";l+=i.path.replace("/v4/","");var f=i.params;return t&&(f=f.filter(function(m){return!m.match(/^access_token=/)})),f.length&&(l+="?"+f.join("&")),l},Yr.prototype.canonicalizeTileset=function(e,t){for(var i=!!t&&li(t),l=[],f=0,m=e.tiles||[];f<m.length;f+=1){var x=m[f];Ui(x)?l.push(this.canonicalizeTileURL(x,i)):l.push(x)}return l},Yr.prototype._makeAPIURL=function(e,t){var i="See https://www.mapbox.com/api-documentation/#access-tokens-and-token-scopes",l=yr(Jt.API_URL);if(e.protocol=l.protocol,e.authority=l.authority,e.protocol==="http"){var f=e.params.indexOf("secure");f>=0&&e.params.splice(f,1)}if(l.path!=="/"&&(e.path=""+l.path+e.path),!Jt.REQUIRE_ACCESS_TOKEN)return ui(e);if(!(t=t||Jt.ACCESS_TOKEN))throw new Error("An API access token is required to use Mapbox GL. "+i);if(t[0]==="s")throw new Error("Use a public access token (pk.*) with Mapbox GL, not a secret access token (sk.*). "+i);return e.params=e.params.filter(function(m){return m.indexOf("access_token")===-1}),e.params.push("access_token="+t),ui(e)};var nn=/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/|\?|$)/i;function Ui(e){return nn.test(e)}var an=/^(\w+):\/\/([^/?]*)(\/[^?]+)?\??(.+)?/;function yr(e){var t=e.match(an);if(!t)throw new Error("Unable to parse URL object");return{protocol:t[1],authority:t[2],path:t[3]||"/",params:t[4]?t[4].split("&"):[]}}function ui(e){var t=e.params.length?"?"+e.params.join("&"):"";return e.protocol+"://"+e.authority+e.path+t}function on(e){if(!e)return null;var t=e.split(".");if(!t||t.length!==3)return null;try{return JSON.parse(decodeURIComponent(R.atob(t[1]).split("").map(function(i){return"%"+("00"+i.charCodeAt(0).toString(16)).slice(-2)}).join("")))}catch{return null}}var qr=function(e){this.type=e,this.anonId=null,this.eventData={},this.queue=[],this.pendingRequest=null};qr.prototype.getStorageKey=function(e){var t,i=on(Jt.ACCESS_TOKEN);return t=i&&i.u?R.btoa(encodeURIComponent(i.u).replace(/%([0-9A-F]{2})/g,function(l,f){return String.fromCharCode(+("0x"+f))})):Jt.ACCESS_TOKEN||"",e?"mapbox.eventData."+e+":"+t:"mapbox.eventData:"+t},qr.prototype.fetchEventData=function(){var e=xt("localStorage"),t=this.getStorageKey(),i=this.getStorageKey("uuid");if(e)try{var l=R.localStorage.getItem(t);l&&(this.eventData=JSON.parse(l));var f=R.localStorage.getItem(i);f&&(this.anonId=f)}catch{st("Unable to read from LocalStorage")}},qr.prototype.saveEventData=function(){var e=xt("localStorage"),t=this.getStorageKey(),i=this.getStorageKey("uuid");if(e)try{R.localStorage.setItem(i,this.anonId),Object.keys(this.eventData).length>=1&&R.localStorage.setItem(t,JSON.stringify(this.eventData))}catch{st("Unable to write to LocalStorage")}},qr.prototype.processRequests=function(e){},qr.prototype.postEvent=function(e,t,i,l){var f=this;if(Jt.EVENTS_URL){var m=yr(Jt.EVENTS_URL);m.params.push("access_token="+(l||Jt.ACCESS_TOKEN||""));var x={event:this.type,created:new Date(e).toISOString(),sdkIdentifier:"mapbox-gl-js",sdkVersion:"1.13.2",skuId:yn,userId:this.anonId},k=t?xe(x,t):x,I={url:ui(m),headers:{"Content-Type":"text/plain"},body:JSON.stringify([k])};this.pendingRequest=te(I,function(A){f.pendingRequest=null,i(A),f.saveEventData(),f.processRequests(l)})}},qr.prototype.queueRequest=function(e,t){this.queue.push(e),this.processRequests(t)};var ci,hi,gi=function(e){function t(){e.call(this,"map.load"),this.success={},this.skuToken=""}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.postMapLoadEvent=function(i,l,f,m){this.skuToken=f,(Jt.EVENTS_URL&&m||Jt.ACCESS_TOKEN&&Array.isArray(i)&&i.some(function(x){return li(x)||Ui(x)}))&&this.queueRequest({id:l,timestamp:Date.now()},m)},t.prototype.processRequests=function(i){var l=this;if(!this.pendingRequest&&this.queue.length!==0){var f=this.queue.shift(),m=f.id,x=f.timestamp;m&&this.success[m]||(this.anonId||this.fetchEventData(),We(this.anonId)||(this.anonId=Pe()),this.postEvent(x,{skuToken:this.skuToken},function(k){k||m&&(l.success[m]=!0)},i))}},t}(qr),Di=new(function(e){function t(i){e.call(this,"appUserTurnstile"),this._customAccessToken=i}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.postTurnstileEvent=function(i,l){Jt.EVENTS_URL&&Jt.ACCESS_TOKEN&&Array.isArray(i)&&i.some(function(f){return li(f)||Ui(f)})&&this.queueRequest(Date.now(),l)},t.prototype.processRequests=function(i){var l=this;if(!this.pendingRequest&&this.queue.length!==0){this.anonId&&this.eventData.lastSuccess&&this.eventData.tokenU||this.fetchEventData();var f=on(Jt.ACCESS_TOKEN),m=f?f.u:Jt.ACCESS_TOKEN,x=m!==this.eventData.tokenU;We(this.anonId)||(this.anonId=Pe(),x=!0);var k=this.queue.shift();if(this.eventData.lastSuccess){var I=new Date(this.eventData.lastSuccess),A=new Date(k),M=(k-this.eventData.lastSuccess)/864e5;x=x||M>=1||M<-1||I.getDate()!==A.getDate()}else x=!0;if(!x)return this.processRequests();this.postEvent(k,{"enabled.telemetry":!1},function(B){B||(l.eventData.lastSuccess=k,l.eventData.tokenU=m)},i)}},t}(qr)),Wn=Di.postTurnstileEvent.bind(Di),Vi=new gi,Ln=Vi.postMapLoadEvent.bind(Vi),Li=500,Ji=50;function Rn(){R.caches&&!ci&&(ci=R.caches.open("mapbox-tiles"))}function Tn(e){var t=e.indexOf("?");return t<0?e:e.slice(0,t)}var ei,Yn=1/0;function In(){return ei==null&&(ei=R.OffscreenCanvas&&new R.OffscreenCanvas(1,1).getContext("2d")&&typeof R.createImageBitmap=="function"),ei}var wi={Unknown:"Unknown",Style:"Style",Source:"Source",Tile:"Tile",Glyphs:"Glyphs",SpriteImage:"SpriteImage",SpriteJSON:"SpriteJSON",Image:"Image"};typeof Object.freeze=="function"&&Object.freeze(wi);var ca=function(e){function t(i,l,f){l===401&&Ui(f)&&(i+=": you may have provided an invalid Mapbox access token. See https://www.mapbox.com/api-documentation/#access-tokens-and-token-scopes"),e.call(this,i),this.status=l,this.url=f,this.name=this.constructor.name,this.message=i}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.toString=function(){return this.name+": "+this.message+" ("+this.status+"): "+this.url},t}(Error),An=qt()?function(){return self.worker&&self.worker.referrer}:function(){return(R.location.protocol==="blob:"?R.parent:R).location.href},Mr,sn,gn=function(e,t){if(!(/^file:/.test(i=e.url)||/^file:/.test(An())&&!/^\w+:/.test(i))){if(R.fetch&&R.Request&&R.AbortController&&R.Request.prototype.hasOwnProperty("signal"))return function(l,f){var m,x=new R.AbortController,k=new R.Request(l.url,{method:l.method||"GET",body:l.body,credentials:l.credentials,headers:l.headers,referrer:An(),signal:x.signal}),I=!1,A=!1,M=(m=k.url).indexOf("sku=")>0&&Ui(m);l.type==="json"&&k.headers.set("Accept","application/json");var B=function(j,J,$){if(!A){if(j&&j.message!=="SecurityError"&&st(j),J&&$)return U(J);var ce=Date.now();R.fetch(k).then(function(ie){if(ie.ok){var ye=M?ie.clone():null;return U(ie,ye,ce)}return f(new ca(ie.statusText,ie.status,l.url))}).catch(function(ie){ie.code!==20&&f(new Error(ie.message))})}},U=function(j,J,$){(l.type==="arrayBuffer"?j.arrayBuffer():l.type==="json"?j.json():j.text()).then(function(ce){A||(J&&$&&function(ie,ye,be){if(Rn(),ci){var we={status:ye.status,statusText:ye.statusText,headers:new R.Headers};ye.headers.forEach(function(Ce,Ve){return we.headers.set(Ve,Ce)});var ke=St(ye.headers.get("Cache-Control")||"");ke["no-store"]||(ke["max-age"]&&we.headers.set("Expires",new Date(be+1e3*ke["max-age"]).toUTCString()),new Date(we.headers.get("Expires")).getTime()-be<42e4||function(Ce,Ve){if(hi===void 0)try{new Response(new ReadableStream),hi=!0}catch{hi=!1}hi?Ve(Ce.body):Ce.blob().then(Ve)}(ye,function(Ce){var Ve=new R.Response(Ce,we);Rn(),ci&&ci.then(function(Je){return Je.put(Tn(ie.url),Ve)}).catch(function(Je){return st(Je.message)})}))}}(k,J,$),I=!0,f(null,ce,j.headers.get("Cache-Control"),j.headers.get("Expires")))}).catch(function(ce){A||f(new Error(ce.message))})};return M?function(j,J){if(Rn(),!ci)return J(null);var $=Tn(j.url);ci.then(function(ce){ce.match($).then(function(ie){var ye=function(be){if(!be)return!1;var we=new Date(be.headers.get("Expires")||0),ke=St(be.headers.get("Cache-Control")||"");return we>Date.now()&&!ke["no-cache"]}(ie);ce.delete($),ye&&ce.put($,ie.clone()),J(null,ie,ye)}).catch(J)}).catch(J)}(k,B):B(null,null),{cancel:function(){A=!0,I||x.abort()}}}(e,t);if(qt()&&self.worker&&self.worker.actor)return self.worker.actor.send("getResource",e,t,void 0,!0)}var i;return function(l,f){var m=new R.XMLHttpRequest;for(var x in m.open(l.method||"GET",l.url,!0),l.type==="arrayBuffer"&&(m.responseType="arraybuffer"),l.headers)m.setRequestHeader(x,l.headers[x]);return l.type==="json"&&(m.responseType="text",m.setRequestHeader("Accept","application/json")),m.withCredentials=l.credentials==="include",m.onerror=function(){f(new Error(m.statusText))},m.onload=function(){if((m.status>=200&&m.status<300||m.status===0)&&m.response!==null){var k=m.response;if(l.type==="json")try{k=JSON.parse(m.response)}catch(I){return f(I)}f(null,k,m.getResponseHeader("Cache-Control"),m.getResponseHeader("Expires"))}else f(new ca(m.statusText,m.status,l.url))},m.send(l.body),{cancel:function(){return m.abort()}}}(e,t)},ti=function(e,t){return gn(xe(e,{type:"arrayBuffer"}),t)},te=function(e,t){return gn(xe(e,{method:"POST"}),t)},P="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAC0lEQVQYV2NgAAIAAAUAAarVyFEAAAAASUVORK5CYII=";Mr=[],sn=0;var N=function(e,t){if(rn.supported&&(e.headers||(e.headers={}),e.headers.accept="image/webp,*/*"),sn>=Jt.MAX_PARALLEL_IMAGE_REQUESTS){var i={requestParameters:e,callback:t,cancelled:!1,cancel:function(){this.cancelled=!0}};return Mr.push(i),i}sn++;var l=!1,f=function(){if(!l)for(l=!0,sn--;Mr.length&&sn<Jt.MAX_PARALLEL_IMAGE_REQUESTS;){var x=Mr.shift();x.cancelled||(x.cancel=N(x.requestParameters,x.callback).cancel)}},m=ti(e,function(x,k,I,A){f(),x?t(x):k&&(In()?function(M,B){var U=new R.Blob([new Uint8Array(M)],{type:"image/png"});R.createImageBitmap(U).then(function(j){B(null,j)}).catch(function(j){B(new Error("Could not load image because of "+j.message+". Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."))})}(k,t):function(M,B,U,j){var J=new R.Image,$=R.URL;J.onload=function(){B(null,J),$.revokeObjectURL(J.src),J.onload=null,R.requestAnimationFrame(function(){J.src=P})},J.onerror=function(){return B(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."))};var ce=new R.Blob([new Uint8Array(M)],{type:"image/png"});J.cacheControl=U,J.expires=j,J.src=M.byteLength?$.createObjectURL(ce):P}(k,t,I,A))});return{cancel:function(){m.cancel(),f()}}};function V(e,t,i){i[e]&&i[e].indexOf(t)!==-1||(i[e]=i[e]||[],i[e].push(t))}function K(e,t,i){if(i&&i[e]){var l=i[e].indexOf(t);l!==-1&&i[e].splice(l,1)}}var W=function(e,t){t===void 0&&(t={}),xe(this,t),this.type=e},ue=function(e){function t(i,l){l===void 0&&(l={}),e.call(this,"error",xe({error:i},l))}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t}(W),he=function(){};he.prototype.on=function(e,t){return this._listeners=this._listeners||{},V(e,t,this._listeners),this},he.prototype.off=function(e,t){return K(e,t,this._listeners),K(e,t,this._oneTimeListeners),this},he.prototype.once=function(e,t){return this._oneTimeListeners=this._oneTimeListeners||{},V(e,t,this._oneTimeListeners),this},he.prototype.fire=function(e,t){typeof e=="string"&&(e=new W(e,t||{}));var i=e.type;if(this.listens(i)){e.target=this;for(var l=0,f=this._listeners&&this._listeners[i]?this._listeners[i].slice():[];l<f.length;l+=1)f[l].call(this,e);for(var m=0,x=this._oneTimeListeners&&this._oneTimeListeners[i]?this._oneTimeListeners[i].slice():[];m<x.length;m+=1){var k=x[m];K(i,k,this._oneTimeListeners),k.call(this,e)}var I=this._eventedParent;I&&(xe(e,typeof this._eventedParentData=="function"?this._eventedParentData():this._eventedParentData),I.fire(e))}else e instanceof ue&&console.error(e.error);return this},he.prototype.listens=function(e){return this._listeners&&this._listeners[e]&&this._listeners[e].length>0||this._oneTimeListeners&&this._oneTimeListeners[e]&&this._oneTimeListeners[e].length>0||this._eventedParent&&this._eventedParent.listens(e)},he.prototype.setEventedParent=function(e,t){return this._eventedParent=e,this._eventedParentData=t,this};var q={$version:8,$root:{version:{required:!0,type:"enum",values:[8]},name:{type:"string"},metadata:{type:"*"},center:{type:"array",value:"number"},zoom:{type:"number"},bearing:{type:"number",default:0,period:360,units:"degrees"},pitch:{type:"number",default:0,units:"degrees"},light:{type:"light"},sources:{required:!0,type:"sources"},sprite:{type:"string"},glyphs:{type:"string"},transition:{type:"transition"},layers:{required:!0,type:"array",value:"layer"}},sources:{"*":{type:"source"}},source:["source_vector","source_raster","source_raster_dem","source_geojson","source_video","source_image"],source_vector:{type:{required:!0,type:"enum",values:{vector:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},attribution:{type:"string"},promoteId:{type:"promoteId"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_raster:{type:{required:!0,type:"enum",values:{raster:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},attribution:{type:"string"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_raster_dem:{type:{required:!0,type:"enum",values:{"raster-dem":{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},attribution:{type:"string"},encoding:{type:"enum",values:{terrarium:{},mapbox:{}},default:"mapbox"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_geojson:{type:{required:!0,type:"enum",values:{geojson:{}}},data:{type:"*"},maxzoom:{type:"number",default:18},attribution:{type:"string"},buffer:{type:"number",default:128,maximum:512,minimum:0},filter:{type:"*"},tolerance:{type:"number",default:.375},cluster:{type:"boolean",default:!1},clusterRadius:{type:"number",default:50,minimum:0},clusterMaxZoom:{type:"number"},clusterMinPoints:{type:"number"},clusterProperties:{type:"*"},lineMetrics:{type:"boolean",default:!1},generateId:{type:"boolean",default:!1},promoteId:{type:"promoteId"}},source_video:{type:{required:!0,type:"enum",values:{video:{}}},urls:{required:!0,type:"array",value:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},source_image:{type:{required:!0,type:"enum",values:{image:{}}},url:{required:!0,type:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},layer:{id:{type:"string",required:!0},type:{type:"enum",values:{fill:{},line:{},symbol:{},circle:{},heatmap:{},"fill-extrusion":{},raster:{},hillshade:{},background:{}},required:!0},metadata:{type:"*"},source:{type:"string"},"source-layer":{type:"string"},minzoom:{type:"number",minimum:0,maximum:24},maxzoom:{type:"number",minimum:0,maximum:24},filter:{type:"filter"},layout:{type:"layout"},paint:{type:"paint"}},layout:["layout_fill","layout_line","layout_circle","layout_heatmap","layout_fill-extrusion","layout_symbol","layout_raster","layout_hillshade","layout_background"],layout_background:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_fill:{"fill-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_circle:{"circle-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_heatmap:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},"layout_fill-extrusion":{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_line:{"line-cap":{type:"enum",values:{butt:{},round:{},square:{}},default:"butt",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-join":{type:"enum",values:{bevel:{},round:{},miter:{}},default:"miter",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"line-miter-limit":{type:"number",default:2,requires:[{"line-join":"miter"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-round-limit":{type:"number",default:1.05,requires:[{"line-join":"round"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_symbol:{"symbol-placement":{type:"enum",values:{point:{},line:{},"line-center":{}},default:"point",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-spacing":{type:"number",default:250,minimum:1,units:"pixels",requires:[{"symbol-placement":"line"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"symbol-avoid-edges":{type:"boolean",default:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"symbol-z-order":{type:"enum",values:{auto:{},"viewport-y":{},source:{}},default:"auto",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-allow-overlap":{type:"boolean",default:!1,requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-ignore-placement":{type:"boolean",default:!1,requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-optional":{type:"boolean",default:!1,requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-rotation-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-size":{type:"number",default:1,minimum:0,units:"factor of the original icon size",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-text-fit":{type:"enum",values:{none:{},width:{},height:{},both:{}},default:"none",requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-text-fit-padding":{type:"array",value:"number",length:4,default:[0,0,0,0],units:"pixels",requires:["icon-image","text-field",{"icon-text-fit":["both","width","height"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-image":{type:"resolvedImage",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-padding":{type:"number",default:2,minimum:0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-keep-upright":{type:"boolean",default:!1,requires:["icon-image",{"icon-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-offset":{type:"array",value:"number",length:2,default:[0,0],requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotation-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-field":{type:"formatted",default:"",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-font":{type:"array",value:"string",default:["Open Sans Regular","Arial Unicode MS Regular"],requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-size":{type:"number",default:16,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-width":{type:"number",default:10,minimum:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-line-height":{type:"number",default:1.2,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-letter-spacing":{type:"number",default:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-justify":{type:"enum",values:{auto:{},left:{},center:{},right:{}},default:"center",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-radial-offset":{type:"number",units:"ems",default:0,requires:["text-field"],"property-type":"data-driven",expression:{interpolated:!0,parameters:["zoom","feature"]}},"text-variable-anchor":{type:"array",value:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["text-field",{"!":"text-variable-anchor"}],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-angle":{type:"number",default:45,units:"degrees",requires:["text-field",{"symbol-placement":["line","line-center"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-writing-mode":{type:"array",value:"enum",values:{horizontal:{},vertical:{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-padding":{type:"number",default:2,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-keep-upright":{type:"boolean",default:!0,requires:["text-field",{"text-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-transform":{type:"enum",values:{none:{},uppercase:{},lowercase:{}},default:"none",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-offset":{type:"array",value:"number",units:"ems",length:2,default:[0,0],requires:["text-field",{"!":"text-radial-offset"}],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-allow-overlap":{type:"boolean",default:!1,requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-ignore-placement":{type:"boolean",default:!1,requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-optional":{type:"boolean",default:!1,requires:["text-field","icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_raster:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_hillshade:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},filter:{type:"array",value:"*"},filter_operator:{type:"enum",values:{"==":{},"!=":{},">":{},">=":{},"<":{},"<=":{},in:{},"!in":{},all:{},any:{},none:{},has:{},"!has":{},within:{}}},geometry_type:{type:"enum",values:{Point:{},LineString:{},Polygon:{}}},function:{expression:{type:"expression"},stops:{type:"array",value:"function_stop"},base:{type:"number",default:1,minimum:0},property:{type:"string",default:"$zoom"},type:{type:"enum",values:{identity:{},exponential:{},interval:{},categorical:{}},default:"exponential"},colorSpace:{type:"enum",values:{rgb:{},lab:{},hcl:{}},default:"rgb"},default:{type:"*",required:!1}},function_stop:{type:"array",minimum:0,maximum:24,value:["number","color"],length:2},expression:{type:"array",value:"*",minimum:1},light:{anchor:{type:"enum",default:"viewport",values:{map:{},viewport:{}},"property-type":"data-constant",transition:!1,expression:{interpolated:!1,parameters:["zoom"]}},position:{type:"array",default:[1.15,210,30],length:3,value:"number","property-type":"data-constant",transition:!0,expression:{interpolated:!0,parameters:["zoom"]}},color:{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},intensity:{type:"number","property-type":"data-constant",default:.5,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0}},paint:["paint_fill","paint_line","paint_circle","paint_heatmap","paint_fill-extrusion","paint_symbol","paint_raster","paint_hillshade","paint_background"],paint_fill:{"fill-antialias":{type:"boolean",default:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-outline-color":{type:"color",transition:!0,requires:[{"!":"fill-pattern"},{"fill-antialias":!0}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"}},"paint_fill-extrusion":{"fill-extrusion-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-extrusion-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-extrusion-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"fill-extrusion-height":{type:"number",default:0,minimum:0,units:"meters",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-base":{type:"number",default:0,minimum:0,units:"meters",transition:!0,requires:["fill-extrusion-height"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-vertical-gradient":{type:"boolean",default:!0,transition:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_line:{"line-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"line-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["line-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-width":{type:"number",default:1,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-gap-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-offset":{type:"number",default:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-dasharray":{type:"array",value:"number",minimum:0,transition:!0,units:"line widths",requires:[{"!":"line-pattern"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"line-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"line-gradient":{type:"color",transition:!1,requires:[{"!":"line-dasharray"},{"!":"line-pattern"},{source:"geojson",has:{lineMetrics:!0}}],expression:{interpolated:!0,parameters:["line-progress"]},"property-type":"color-ramp"}},paint_circle:{"circle-radius":{type:"number",default:5,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-blur":{type:"number",default:0,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"circle-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["circle-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-scale":{type:"enum",values:{map:{},viewport:{}},default:"map",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-alignment":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-stroke-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"}},paint_heatmap:{"heatmap-radius":{type:"number",default:30,minimum:1,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-weight":{type:"number",default:1,minimum:0,transition:!1,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-intensity":{type:"number",default:1,minimum:0,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"heatmap-color":{type:"color",default:["interpolate",["linear"],["heatmap-density"],0,"rgba(0, 0, 255, 0)",.1,"royalblue",.3,"cyan",.5,"lime",.7,"yellow",1,"red"],transition:!1,expression:{interpolated:!0,parameters:["heatmap-density"]},"property-type":"color-ramp"},"heatmap-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_symbol:{"icon-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-color":{type:"color",default:"#000000",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["icon-image","icon-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-color":{type:"color",default:"#000000",transition:!0,overridable:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["text-field","text-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_raster:{"raster-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-hue-rotate":{type:"number",default:0,period:360,transition:!0,units:"degrees",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-min":{type:"number",default:0,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-max":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-saturation":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-contrast":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-resampling":{type:"enum",values:{linear:{},nearest:{}},default:"linear",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"raster-fade-duration":{type:"number",default:300,minimum:0,transition:!1,units:"milliseconds",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_hillshade:{"hillshade-illumination-direction":{type:"number",default:335,minimum:0,maximum:359,transition:!1,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-illumination-anchor":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-exaggeration":{type:"number",default:.5,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-shadow-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-highlight-color":{type:"color",default:"#FFFFFF",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-accent-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_background:{"background-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"background-pattern"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"background-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"background-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},transition:{duration:{type:"number",default:300,minimum:0,units:"milliseconds"},delay:{type:"number",default:0,minimum:0,units:"milliseconds"}},"property-type":{"data-driven":{type:"property-type"},"cross-faded":{type:"property-type"},"cross-faded-data-driven":{type:"property-type"},"color-ramp":{type:"property-type"},"data-constant":{type:"property-type"},constant:{type:"property-type"}},promoteId:{"*":{type:"string"}}},Q=function(e,t,i,l){this.message=(e?e+": ":"")+i,l&&(this.identifier=l),t!=null&&t.__line__&&(this.line=t.__line__)};function me(e){var t=e.value;return t?[new Q(e.key,t,"constants have been deprecated as of v8")]:[]}function Me(e){for(var t=[],i=arguments.length-1;i-- >0;)t[i]=arguments[i+1];for(var l=0,f=t;l<f.length;l+=1){var m=f[l];for(var x in m)e[x]=m[x]}return e}function Be(e){return e instanceof Number||e instanceof String||e instanceof Boolean?e.valueOf():e}function Ee(e){if(Array.isArray(e))return e.map(Ee);if(e instanceof Object&&!(e instanceof Number||e instanceof String||e instanceof Boolean)){var t={};for(var i in e)t[i]=Ee(e[i]);return t}return Be(e)}var De=function(e){function t(i,l){e.call(this,l),this.message=l,this.key=i}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t}(Error),it=function(e,t){t===void 0&&(t=[]),this.parent=e,this.bindings={};for(var i=0,l=t;i<l.length;i+=1){var f=l[i];this.bindings[f[0]]=f[1]}};it.prototype.concat=function(e){return new it(this,e)},it.prototype.get=function(e){if(this.bindings[e])return this.bindings[e];if(this.parent)return this.parent.get(e);throw new Error(e+" not found in scope.")},it.prototype.has=function(e){return!!this.bindings[e]||!!this.parent&&this.parent.has(e)};var nt={kind:"null"},ze={kind:"number"},et={kind:"string"},Ge={kind:"boolean"},Ye={kind:"color"},Pt={kind:"object"},rt={kind:"value"},Qt={kind:"collator"},_r={kind:"formatted"},Kt={kind:"resolvedImage"};function lr(e,t){return{kind:"array",itemType:e,N:t}}function $t(e){if(e.kind==="array"){var t=$t(e.itemType);return typeof e.N=="number"?"array<"+t+", "+e.N+">":e.itemType.kind==="value"?"array":"array<"+t+">"}return e.kind}var _i=[nt,ze,et,Ge,Ye,_r,Pt,lr(rt),Kt];function hr(e,t){if(t.kind==="error")return null;if(e.kind==="array"){if(t.kind==="array"&&(t.N===0&&t.itemType.kind==="value"||!hr(e.itemType,t.itemType))&&(typeof e.N!="number"||e.N===t.N))return null}else{if(e.kind===t.kind)return null;if(e.kind==="value"){for(var i=0,l=_i;i<l.length;i+=1)if(!hr(l[i],t))return null}}return"Expected "+$t(e)+" but found "+$t(t)+" instead."}function Or(e,t){return t.some(function(i){return i.kind===e.kind})}function gr(e,t){return t.some(function(i){return i==="null"?e===null:i==="array"?Array.isArray(e):i==="object"?e&&!Array.isArray(e)&&typeof e=="object":i===typeof e})}var Wt=T(function(e,t){var i={transparent:[0,0,0,0],aliceblue:[240,248,255,1],antiquewhite:[250,235,215,1],aqua:[0,255,255,1],aquamarine:[127,255,212,1],azure:[240,255,255,1],beige:[245,245,220,1],bisque:[255,228,196,1],black:[0,0,0,1],blanchedalmond:[255,235,205,1],blue:[0,0,255,1],blueviolet:[138,43,226,1],brown:[165,42,42,1],burlywood:[222,184,135,1],cadetblue:[95,158,160,1],chartreuse:[127,255,0,1],chocolate:[210,105,30,1],coral:[255,127,80,1],cornflowerblue:[100,149,237,1],cornsilk:[255,248,220,1],crimson:[220,20,60,1],cyan:[0,255,255,1],darkblue:[0,0,139,1],darkcyan:[0,139,139,1],darkgoldenrod:[184,134,11,1],darkgray:[169,169,169,1],darkgreen:[0,100,0,1],darkgrey:[169,169,169,1],darkkhaki:[189,183,107,1],darkmagenta:[139,0,139,1],darkolivegreen:[85,107,47,1],darkorange:[255,140,0,1],darkorchid:[153,50,204,1],darkred:[139,0,0,1],darksalmon:[233,150,122,1],darkseagreen:[143,188,143,1],darkslateblue:[72,61,139,1],darkslategray:[47,79,79,1],darkslategrey:[47,79,79,1],darkturquoise:[0,206,209,1],darkviolet:[148,0,211,1],deeppink:[255,20,147,1],deepskyblue:[0,191,255,1],dimgray:[105,105,105,1],dimgrey:[105,105,105,1],dodgerblue:[30,144,255,1],firebrick:[178,34,34,1],floralwhite:[255,250,240,1],forestgreen:[34,139,34,1],fuchsia:[255,0,255,1],gainsboro:[220,220,220,1],ghostwhite:[248,248,255,1],gold:[255,215,0,1],goldenrod:[218,165,32,1],gray:[128,128,128,1],green:[0,128,0,1],greenyellow:[173,255,47,1],grey:[128,128,128,1],honeydew:[240,255,240,1],hotpink:[255,105,180,1],indianred:[205,92,92,1],indigo:[75,0,130,1],ivory:[255,255,240,1],khaki:[240,230,140,1],lavender:[230,230,250,1],lavenderblush:[255,240,245,1],lawngreen:[124,252,0,1],lemonchiffon:[255,250,205,1],lightblue:[173,216,230,1],lightcoral:[240,128,128,1],lightcyan:[224,255,255,1],lightgoldenrodyellow:[250,250,210,1],lightgray:[211,211,211,1],lightgreen:[144,238,144,1],lightgrey:[211,211,211,1],lightpink:[255,182,193,1],lightsalmon:[255,160,122,1],lightseagreen:[32,178,170,1],lightskyblue:[135,206,250,1],lightslategray:[119,136,153,1],lightslategrey:[119,136,153,1],lightsteelblue:[176,196,222,1],lightyellow:[255,255,224,1],lime:[0,255,0,1],limegreen:[50,205,50,1],linen:[250,240,230,1],magenta:[255,0,255,1],maroon:[128,0,0,1],mediumaquamarine:[102,205,170,1],mediumblue:[0,0,205,1],mediumorchid:[186,85,211,1],mediumpurple:[147,112,219,1],mediumseagreen:[60,179,113,1],mediumslateblue:[123,104,238,1],mediumspringgreen:[0,250,154,1],mediumturquoise:[72,209,204,1],mediumvioletred:[199,21,133,1],midnightblue:[25,25,112,1],mintcream:[245,255,250,1],mistyrose:[255,228,225,1],moccasin:[255,228,181,1],navajowhite:[255,222,173,1],navy:[0,0,128,1],oldlace:[253,245,230,1],olive:[128,128,0,1],olivedrab:[107,142,35,1],orange:[255,165,0,1],orangered:[255,69,0,1],orchid:[218,112,214,1],palegoldenrod:[238,232,170,1],palegreen:[152,251,152,1],paleturquoise:[175,238,238,1],palevioletred:[219,112,147,1],papayawhip:[255,239,213,1],peachpuff:[255,218,185,1],peru:[205,133,63,1],pink:[255,192,203,1],plum:[221,160,221,1],powderblue:[176,224,230,1],purple:[128,0,128,1],rebeccapurple:[102,51,153,1],red:[255,0,0,1],rosybrown:[188,143,143,1],royalblue:[65,105,225,1],saddlebrown:[139,69,19,1],salmon:[250,128,114,1],sandybrown:[244,164,96,1],seagreen:[46,139,87,1],seashell:[255,245,238,1],sienna:[160,82,45,1],silver:[192,192,192,1],skyblue:[135,206,235,1],slateblue:[106,90,205,1],slategray:[112,128,144,1],slategrey:[112,128,144,1],snow:[255,250,250,1],springgreen:[0,255,127,1],steelblue:[70,130,180,1],tan:[210,180,140,1],teal:[0,128,128,1],thistle:[216,191,216,1],tomato:[255,99,71,1],turquoise:[64,224,208,1],violet:[238,130,238,1],wheat:[245,222,179,1],white:[255,255,255,1],whitesmoke:[245,245,245,1],yellow:[255,255,0,1],yellowgreen:[154,205,50,1]};function l(k){return(k=Math.round(k))<0?0:k>255?255:k}function f(k){return l(k[k.length-1]==="%"?parseFloat(k)/100*255:parseInt(k))}function m(k){return(I=k[k.length-1]==="%"?parseFloat(k)/100:parseFloat(k))<0?0:I>1?1:I;var I}function x(k,I,A){return A<0?A+=1:A>1&&(A-=1),6*A<1?k+(I-k)*A*6:2*A<1?I:3*A<2?k+(I-k)*(2/3-A)*6:k}try{t.parseCSSColor=function(k){var I,A=k.replace(/ /g,"").toLowerCase();if(A in i)return i[A].slice();if(A[0]==="#")return A.length===4?(I=parseInt(A.substr(1),16))>=0&&I<=4095?[(3840&I)>>4|(3840&I)>>8,240&I|(240&I)>>4,15&I|(15&I)<<4,1]:null:A.length===7&&(I=parseInt(A.substr(1),16))>=0&&I<=16777215?[(16711680&I)>>16,(65280&I)>>8,255&I,1]:null;var M=A.indexOf("("),B=A.indexOf(")");if(M!==-1&&B+1===A.length){var U=A.substr(0,M),j=A.substr(M+1,B-(M+1)).split(","),J=1;switch(U){case"rgba":if(j.length!==4)return null;J=m(j.pop());case"rgb":return j.length!==3?null:[f(j[0]),f(j[1]),f(j[2]),J];case"hsla":if(j.length!==4)return null;J=m(j.pop());case"hsl":if(j.length!==3)return null;var $=(parseFloat(j[0])%360+360)%360/360,ce=m(j[1]),ie=m(j[2]),ye=ie<=.5?ie*(ce+1):ie+ce-ie*ce,be=2*ie-ye;return[l(255*x(be,ye,$+1/3)),l(255*x(be,ye,$)),l(255*x(be,ye,$-1/3)),J];default:return null}}return null}}catch{}}).parseCSSColor,ur=function(e,t,i,l){l===void 0&&(l=1),this.r=e,this.g=t,this.b=i,this.a=l};ur.parse=function(e){if(e){if(e instanceof ur)return e;if(typeof e=="string"){var t=Wt(e);if(t)return new ur(t[0]/255*t[3],t[1]/255*t[3],t[2]/255*t[3],t[3])}}},ur.prototype.toString=function(){var e=this.toArray(),t=e[1],i=e[2],l=e[3];return"rgba("+Math.round(e[0])+","+Math.round(t)+","+Math.round(i)+","+l+")"},ur.prototype.toArray=function(){var e=this.a;return e===0?[0,0,0,0]:[255*this.r/e,255*this.g/e,255*this.b/e,e]},ur.black=new ur(0,0,0,1),ur.white=new ur(1,1,1,1),ur.transparent=new ur(0,0,0,0),ur.red=new ur(1,0,0,1);var Si=function(e,t,i){this.sensitivity=e?t?"variant":"case":t?"accent":"base",this.locale=i,this.collator=new Intl.Collator(this.locale?this.locale:[],{sensitivity:this.sensitivity,usage:"search"})};Si.prototype.compare=function(e,t){return this.collator.compare(e,t)},Si.prototype.resolvedLocale=function(){return new Intl.Collator(this.locale?this.locale:[]).resolvedOptions().locale};var ha=function(e,t,i,l,f){this.text=e,this.image=t,this.scale=i,this.fontStack=l,this.textColor=f},ri=function(e){this.sections=e};ri.fromString=function(e){return new ri([new ha(e,null,null,null,null)])},ri.prototype.isEmpty=function(){return this.sections.length===0||!this.sections.some(function(e){return e.text.length!==0||e.image&&e.image.name.length!==0})},ri.factory=function(e){return e instanceof ri?e:ri.fromString(e)},ri.prototype.toString=function(){return this.sections.length===0?"":this.sections.map(function(e){return e.text}).join("")},ri.prototype.serialize=function(){for(var e=["format"],t=0,i=this.sections;t<i.length;t+=1){var l=i[t];if(l.image)e.push(["image",l.image.name]);else{e.push(l.text);var f={};l.fontStack&&(f["text-font"]=["literal",l.fontStack.split(",")]),l.scale&&(f["font-scale"]=l.scale),l.textColor&&(f["text-color"]=["rgba"].concat(l.textColor.toArray())),e.push(f)}}return e};var Ri=function(e){this.name=e.name,this.available=e.available};function Ua(e,t,i,l){return typeof e=="number"&&e>=0&&e<=255&&typeof t=="number"&&t>=0&&t<=255&&typeof i=="number"&&i>=0&&i<=255?l===void 0||typeof l=="number"&&l>=0&&l<=1?null:"Invalid rgba value ["+[e,t,i,l].join(", ")+"]: 'a' must be between 0 and 1.":"Invalid rgba value ["+(typeof l=="number"?[e,t,i,l]:[e,t,i]).join(", ")+"]: 'r', 'g', and 'b' must be between 0 and 255."}function _a(e){if(e===null||typeof e=="string"||typeof e=="boolean"||typeof e=="number"||e instanceof ur||e instanceof Si||e instanceof ri||e instanceof Ri)return!0;if(Array.isArray(e)){for(var t=0,i=e;t<i.length;t+=1)if(!_a(i[t]))return!1;return!0}if(typeof e=="object"){for(var l in e)if(!_a(e[l]))return!1;return!0}return!1}function jr(e){if(e===null)return nt;if(typeof e=="string")return et;if(typeof e=="boolean")return Ge;if(typeof e=="number")return ze;if(e instanceof ur)return Ye;if(e instanceof Si)return Qt;if(e instanceof ri)return _r;if(e instanceof Ri)return Kt;if(Array.isArray(e)){for(var t,i=e.length,l=0,f=e;l<f.length;l+=1){var m=jr(f[l]);if(t){if(t===m)continue;t=rt;break}t=m}return lr(t||rt,i)}return Pt}function va(e){var t=typeof e;return e===null?"":t==="string"||t==="number"||t==="boolean"?String(e):e instanceof ur||e instanceof ri||e instanceof Ri?e.toString():JSON.stringify(e)}Ri.prototype.toString=function(){return this.name},Ri.fromString=function(e){return e?new Ri({name:e,available:!1}):null},Ri.prototype.serialize=function(){return["image",this.name]};var ki=function(e,t){this.type=e,this.value=t};ki.parse=function(e,t){if(e.length!==2)return t.error("'literal' expression requires exactly one argument, but found "+(e.length-1)+" instead.");if(!_a(e[1]))return t.error("invalid value");var i=e[1],l=jr(i),f=t.expectedType;return l.kind!=="array"||l.N!==0||!f||f.kind!=="array"||typeof f.N=="number"&&f.N!==0||(l=f),new ki(l,i)},ki.prototype.evaluate=function(){return this.value},ki.prototype.eachChild=function(){},ki.prototype.outputDefined=function(){return!0},ki.prototype.serialize=function(){return this.type.kind==="array"||this.type.kind==="object"?["literal",this.value]:this.value instanceof ur?["rgba"].concat(this.value.toArray()):this.value instanceof ri?this.value.serialize():this.value};var ii=function(e){this.name="ExpressionEvaluationError",this.message=e};ii.prototype.toJSON=function(){return this.message};var ln={string:et,number:ze,boolean:Ge,object:Pt},Pr=function(e,t){this.type=e,this.args=t};Pr.parse=function(e,t){if(e.length<2)return t.error("Expected at least one argument.");var i,l=1,f=e[0];if(f==="array"){var m,x;if(e.length>2){var k=e[1];if(typeof k!="string"||!(k in ln)||k==="object")return t.error('The item type argument of "array" must be one of string, number, boolean',1);m=ln[k],l++}else m=rt;if(e.length>3){if(e[2]!==null&&(typeof e[2]!="number"||e[2]<0||e[2]!==Math.floor(e[2])))return t.error('The length argument to "array" must be a positive integer literal',2);x=e[2],l++}i=lr(m,x)}else i=ln[f];for(var I=[];l<e.length;l++){var A=t.parse(e[l],l,rt);if(!A)return null;I.push(A)}return new Pr(i,I)},Pr.prototype.evaluate=function(e){for(var t=0;t<this.args.length;t++){var i=this.args[t].evaluate(e);if(!hr(this.type,jr(i)))return i;if(t===this.args.length-1)throw new ii("Expected value to be of type "+$t(this.type)+", but found "+$t(jr(i))+" instead.")}return null},Pr.prototype.eachChild=function(e){this.args.forEach(e)},Pr.prototype.outputDefined=function(){return this.args.every(function(e){return e.outputDefined()})},Pr.prototype.serialize=function(){var e=this.type,t=[e.kind];if(e.kind==="array"){var i=e.itemType;if(i.kind==="string"||i.kind==="number"||i.kind==="boolean"){t.push(i.kind);var l=e.N;(typeof l=="number"||this.args.length>1)&&t.push(l)}}return t.concat(this.args.map(function(f){return f.serialize()}))};var Bn=function(e){this.type=_r,this.sections=e};Bn.parse=function(e,t){if(e.length<2)return t.error("Expected at least one argument.");var i=e[1];if(!Array.isArray(i)&&typeof i=="object")return t.error("First argument must be an image or text section.");for(var l=[],f=!1,m=1;m<=e.length-1;++m){var x=e[m];if(f&&typeof x=="object"&&!Array.isArray(x)){f=!1;var k=null;if(x["font-scale"]&&!(k=t.parse(x["font-scale"],1,ze)))return null;var I=null;if(x["text-font"]&&!(I=t.parse(x["text-font"],1,lr(et))))return null;var A=null;if(x["text-color"]&&!(A=t.parse(x["text-color"],1,Ye)))return null;var M=l[l.length-1];M.scale=k,M.font=I,M.textColor=A}else{var B=t.parse(e[m],1,rt);if(!B)return null;var U=B.type.kind;if(U!=="string"&&U!=="value"&&U!=="null"&&U!=="resolvedImage")return t.error("Formatted text type must be 'string', 'value', 'image' or 'null'.");f=!0,l.push({content:B,scale:null,font:null,textColor:null})}}return new Bn(l)},Bn.prototype.evaluate=function(e){return new ri(this.sections.map(function(t){var i=t.content.evaluate(e);return jr(i)===Kt?new ha("",i,null,null,null):new ha(va(i),null,t.scale?t.scale.evaluate(e):null,t.font?t.font.evaluate(e).join(","):null,t.textColor?t.textColor.evaluate(e):null)}))},Bn.prototype.eachChild=function(e){for(var t=0,i=this.sections;t<i.length;t+=1){var l=i[t];e(l.content),l.scale&&e(l.scale),l.font&&e(l.font),l.textColor&&e(l.textColor)}},Bn.prototype.outputDefined=function(){return!1},Bn.prototype.serialize=function(){for(var e=["format"],t=0,i=this.sections;t<i.length;t+=1){var l=i[t];e.push(l.content.serialize());var f={};l.scale&&(f["font-scale"]=l.scale.serialize()),l.font&&(f["text-font"]=l.font.serialize()),l.textColor&&(f["text-color"]=l.textColor.serialize()),e.push(f)}return e};var _n=function(e){this.type=Kt,this.input=e};_n.parse=function(e,t){if(e.length!==2)return t.error("Expected two arguments.");var i=t.parse(e[1],1,et);return i?new _n(i):t.error("No image name provided.")},_n.prototype.evaluate=function(e){var t=this.input.evaluate(e),i=Ri.fromString(t);return i&&e.availableImages&&(i.available=e.availableImages.indexOf(t)>-1),i},_n.prototype.eachChild=function(e){e(this.input)},_n.prototype.outputDefined=function(){return!1},_n.prototype.serialize=function(){return["image",this.input.serialize()]};var os={"to-boolean":Ge,"to-color":Ye,"to-number":ze,"to-string":et},Ei=function(e,t){this.type=e,this.args=t};Ei.parse=function(e,t){if(e.length<2)return t.error("Expected at least one argument.");var i=e[0];if((i==="to-boolean"||i==="to-string")&&e.length!==2)return t.error("Expected one argument.");for(var l=os[i],f=[],m=1;m<e.length;m++){var x=t.parse(e[m],m,rt);if(!x)return null;f.push(x)}return new Ei(l,f)},Ei.prototype.evaluate=function(e){if(this.type.kind==="boolean")return!!this.args[0].evaluate(e);if(this.type.kind==="color"){for(var t,i,l=0,f=this.args;l<f.length;l+=1){if(i=null,(t=f[l].evaluate(e))instanceof ur)return t;if(typeof t=="string"){var m=e.parseColor(t);if(m)return m}else if(Array.isArray(t)&&!(i=t.length<3||t.length>4?"Invalid rbga value "+JSON.stringify(t)+": expected an array containing either three or four numeric values.":Ua(t[0],t[1],t[2],t[3])))return new ur(t[0]/255,t[1]/255,t[2]/255,t[3])}throw new ii(i||"Could not parse color from value '"+(typeof t=="string"?t:String(JSON.stringify(t)))+"'")}if(this.type.kind==="number"){for(var x=null,k=0,I=this.args;k<I.length;k+=1){if((x=I[k].evaluate(e))===null)return 0;var A=Number(x);if(!isNaN(A))return A}throw new ii("Could not convert "+JSON.stringify(x)+" to number.")}return this.type.kind==="formatted"?ri.fromString(va(this.args[0].evaluate(e))):this.type.kind==="resolvedImage"?Ri.fromString(va(this.args[0].evaluate(e))):va(this.args[0].evaluate(e))},Ei.prototype.eachChild=function(e){this.args.forEach(e)},Ei.prototype.outputDefined=function(){return this.args.every(function(e){return e.outputDefined()})},Ei.prototype.serialize=function(){if(this.type.kind==="formatted")return new Bn([{content:this.args[0],scale:null,font:null,textColor:null}]).serialize();if(this.type.kind==="resolvedImage")return new _n(this.args[0]).serialize();var e=["to-"+this.type.kind];return this.eachChild(function(t){e.push(t.serialize())}),e};var ba=["Unknown","Point","LineString","Polygon"],qi=function(){this.globals=null,this.feature=null,this.featureState=null,this.formattedSection=null,this._parseColorCache={},this.availableImages=null,this.canonical=null};qi.prototype.id=function(){return this.feature&&"id"in this.feature?this.feature.id:null},qi.prototype.geometryType=function(){return this.feature?typeof this.feature.type=="number"?ba[this.feature.type]:this.feature.type:null},qi.prototype.geometry=function(){return this.feature&&"geometry"in this.feature?this.feature.geometry:null},qi.prototype.canonicalID=function(){return this.canonical},qi.prototype.properties=function(){return this.feature&&this.feature.properties||{}},qi.prototype.parseColor=function(e){var t=this._parseColorCache[e];return t||(t=this._parseColorCache[e]=ur.parse(e)),t};var zi=function(e,t,i,l){this.name=e,this.type=t,this._evaluate=i,this.args=l};zi.prototype.evaluate=function(e){return this._evaluate(e,this.args)},zi.prototype.eachChild=function(e){this.args.forEach(e)},zi.prototype.outputDefined=function(){return!1},zi.prototype.serialize=function(){return[this.name].concat(this.args.map(function(e){return e.serialize()}))},zi.parse=function(e,t){var i,l=e[0],f=zi.definitions[l];if(!f)return t.error('Unknown expression "'+l+'". If you wanted a literal array, use ["literal", [...]].',0);for(var m=Array.isArray(f)?f[0]:f.type,x=Array.isArray(f)?[[f[1],f[2]]]:f.overloads,k=x.filter(function(zt){var lt=zt[0];return!Array.isArray(lt)||lt.length===e.length-1}),I=null,A=0,M=k;A<M.length;A+=1){var B=M[A],U=B[0],j=B[1];I=new Zr(t.registry,t.path,null,t.scope);for(var J=[],$=!1,ce=1;ce<e.length;ce++){var ie=e[ce],ye=Array.isArray(U)?U[ce-1]:U.type,be=I.parse(ie,1+J.length,ye);if(!be){$=!0;break}J.push(be)}if(!$)if(Array.isArray(U)&&U.length!==J.length)I.error("Expected "+U.length+" arguments, but found "+J.length+" instead.");else{for(var we=0;we<J.length;we++){var ke=Array.isArray(U)?U[we]:U.type,Ce=J[we];I.concat(we+1).checkSubtype(ke,Ce.type)}if(I.errors.length===0)return new zi(l,m,j,J)}}if(k.length===1)(i=t.errors).push.apply(i,I.errors);else{for(var Ve=(k.length?k:x).map(function(zt){var lt;return lt=zt[0],Array.isArray(lt)?"("+lt.map($t).join(", ")+")":"("+$t(lt.type)+"...)"}).join(" | "),Je=[],wt=1;wt<e.length;wt++){var ot=t.parse(e[wt],1+Je.length);if(!ot)return null;Je.push($t(ot.type))}t.error("Expected arguments of type "+Ve+", but found ("+Je.join(", ")+") instead.")}return null},zi.register=function(e,t){for(var i in zi.definitions=t,t)e[i]=zi};var Jn=function(e,t,i){this.type=Qt,this.locale=i,this.caseSensitive=e,this.diacriticSensitive=t};function ji(e,t){e[0]=Math.min(e[0],t[0]),e[1]=Math.min(e[1],t[1]),e[2]=Math.max(e[2],t[0]),e[3]=Math.max(e[3],t[1])}function xa(e,t){return!(e[0]<=t[0]||e[2]>=t[2]||e[1]<=t[1]||e[3]>=t[3])}function ss(e,t){var i=(180+e[0])/360,l=(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+e[1]*Math.PI/360)))/360,f=Math.pow(2,t.z);return[Math.round(i*f*8192),Math.round(l*f*8192)]}function Nl(e,t,i){return t[1]>e[1]!=i[1]>e[1]&&e[0]<(i[0]-t[0])*(e[1]-t[1])/(i[1]-t[1])+t[0]}function co(e,t){for(var i,l,f,m,x,k,I,A=!1,M=0,B=t.length;M<B;M++)for(var U=t[M],j=0,J=U.length;j<J-1;j++){if((m=(i=e)[0]-(l=U[j])[0])*(I=i[1]-(f=U[j+1])[1])-(k=i[0]-f[0])*(x=i[1]-l[1])==0&&m*k<=0&&x*I<=0)return!1;Nl(e,U[j],U[j+1])&&(A=!A)}return A}function Ul(e,t){for(var i=0;i<t.length;i++)if(co(e,t[i]))return!0;return!1}function Bo(e,t,i,l){var f=l[0]-i[0],m=l[1]-i[1],x=(e[0]-i[0])*m-f*(e[1]-i[1]),k=(t[0]-i[0])*m-f*(t[1]-i[1]);return x>0&&k<0||x<0&&k>0}function Vl(e,t,i){for(var l=0,f=i;l<f.length;l+=1)for(var m=f[l],x=0;x<m.length-1;++x)if((B=[(M=m[x+1])[0]-(A=m[x])[0],M[1]-A[1]])[0]*(U=[(I=t)[0]-(k=e)[0],I[1]-k[1]])[1]-B[1]*U[0]!=0&&Bo(k,I,A,M)&&Bo(A,M,k,I))return!0;var k,I,A,M,B,U;return!1}function Oo(e,t){for(var i=0;i<e.length;++i)if(!co(e[i],t))return!1;for(var l=0;l<e.length-1;++l)if(Vl(e[l],e[l+1],t))return!1;return!0}function Ns(e,t){for(var i=0;i<t.length;i++)if(Oo(e,t[i]))return!0;return!1}function Va(e,t,i){for(var l=[],f=0;f<e.length;f++){for(var m=[],x=0;x<e[f].length;x++){var k=ss(e[f][x],i);ji(t,k),m.push(k)}l.push(m)}return l}function ls(e,t,i){for(var l=[],f=0;f<e.length;f++){var m=Va(e[f],t,i);l.push(m)}return l}function ho(e,t,i,l){if(e[0]<i[0]||e[0]>i[2]){var f=.5*l,m=e[0]-i[0]>f?-l:i[0]-e[0]>f?l:0;m===0&&(m=e[0]-i[2]>f?-l:i[2]-e[0]>f?l:0),e[0]+=m}ji(t,e)}function Us(e,t,i,l){for(var f=8192*Math.pow(2,l.z),m=[8192*l.x,8192*l.y],x=[],k=0,I=e;k<I.length;k+=1)for(var A=0,M=I[k];A<M.length;A+=1){var B=M[A],U=[B.x+m[0],B.y+m[1]];ho(U,t,i,f),x.push(U)}return x}function qa(e,t,i,l){for(var f,m=8192*Math.pow(2,l.z),x=[8192*l.x,8192*l.y],k=[],I=0,A=e;I<A.length;I+=1){for(var M=[],B=0,U=A[I];B<U.length;B+=1){var j=U[B],J=[j.x+x[0],j.y+x[1]];ji(t,J),M.push(J)}k.push(M)}if(t[2]-t[0]<=m/2){(f=t)[0]=f[1]=1/0,f[2]=f[3]=-1/0;for(var $=0,ce=k;$<ce.length;$+=1)for(var ie=0,ye=ce[$];ie<ye.length;ie+=1)ho(ye[ie],t,i,m)}return k}Jn.parse=function(e,t){if(e.length!==2)return t.error("Expected one argument.");var i=e[1];if(typeof i!="object"||Array.isArray(i))return t.error("Collator options argument must be an object.");var l=t.parse(i["case-sensitive"]!==void 0&&i["case-sensitive"],1,Ge);if(!l)return null;var f=t.parse(i["diacritic-sensitive"]!==void 0&&i["diacritic-sensitive"],1,Ge);if(!f)return null;var m=null;return i.locale&&!(m=t.parse(i.locale,1,et))?null:new Jn(l,f,m)},Jn.prototype.evaluate=function(e){return new Si(this.caseSensitive.evaluate(e),this.diacriticSensitive.evaluate(e),this.locale?this.locale.evaluate(e):null)},Jn.prototype.eachChild=function(e){e(this.caseSensitive),e(this.diacriticSensitive),this.locale&&e(this.locale)},Jn.prototype.outputDefined=function(){return!1},Jn.prototype.serialize=function(){var e={};return e["case-sensitive"]=this.caseSensitive.serialize(),e["diacritic-sensitive"]=this.diacriticSensitive.serialize(),this.locale&&(e.locale=this.locale.serialize()),["collator",e]};var On=function(e,t){this.type=Ge,this.geojson=e,this.geometries=t};function wa(e){if(e instanceof zi&&(e.name==="get"&&e.args.length===1||e.name==="feature-state"||e.name==="has"&&e.args.length===1||e.name==="properties"||e.name==="geometry-type"||e.name==="id"||/^filter-/.test(e.name))||e instanceof On)return!1;var t=!0;return e.eachChild(function(i){t&&!wa(i)&&(t=!1)}),t}function ge(e){if(e instanceof zi&&e.name==="feature-state")return!1;var t=!0;return e.eachChild(function(i){t&&!ge(i)&&(t=!1)}),t}function un(e,t){if(e instanceof zi&&t.indexOf(e.name)>=0)return!1;var i=!0;return e.eachChild(function(l){i&&!un(l,t)&&(i=!1)}),i}On.parse=function(e,t){if(e.length!==2)return t.error("'within' expression requires exactly one argument, but found "+(e.length-1)+" instead.");if(_a(e[1])){var i=e[1];if(i.type==="FeatureCollection")for(var l=0;l<i.features.length;++l){var f=i.features[l].geometry.type;if(f==="Polygon"||f==="MultiPolygon")return new On(i,i.features[l].geometry)}else if(i.type==="Feature"){var m=i.geometry.type;if(m==="Polygon"||m==="MultiPolygon")return new On(i,i.geometry)}else if(i.type==="Polygon"||i.type==="MultiPolygon")return new On(i,i)}return t.error("'within' expression requires valid geojson object that contains polygon geometry type.")},On.prototype.evaluate=function(e){if(e.geometry()!=null&&e.canonicalID()!=null){if(e.geometryType()==="Point")return function(t,i){var l=[1/0,1/0,-1/0,-1/0],f=[1/0,1/0,-1/0,-1/0],m=t.canonicalID();if(i.type==="Polygon"){var x=Va(i.coordinates,f,m),k=Us(t.geometry(),l,f,m);if(!xa(l,f))return!1;for(var I=0,A=k;I<A.length;I+=1)if(!co(A[I],x))return!1}if(i.type==="MultiPolygon"){var M=ls(i.coordinates,f,m),B=Us(t.geometry(),l,f,m);if(!xa(l,f))return!1;for(var U=0,j=B;U<j.length;U+=1)if(!Ul(j[U],M))return!1}return!0}(e,this.geometries);if(e.geometryType()==="LineString")return function(t,i){var l=[1/0,1/0,-1/0,-1/0],f=[1/0,1/0,-1/0,-1/0],m=t.canonicalID();if(i.type==="Polygon"){var x=Va(i.coordinates,f,m),k=qa(t.geometry(),l,f,m);if(!xa(l,f))return!1;for(var I=0,A=k;I<A.length;I+=1)if(!Oo(A[I],x))return!1}if(i.type==="MultiPolygon"){var M=ls(i.coordinates,f,m),B=qa(t.geometry(),l,f,m);if(!xa(l,f))return!1;for(var U=0,j=B;U<j.length;U+=1)if(!Ns(j[U],M))return!1}return!0}(e,this.geometries)}return!1},On.prototype.eachChild=function(){},On.prototype.outputDefined=function(){return!0},On.prototype.serialize=function(){return["within",this.geojson]};var Zi=function(e,t){this.type=t.type,this.name=e,this.boundExpression=t};Zi.parse=function(e,t){if(e.length!==2||typeof e[1]!="string")return t.error("'var' expression requires exactly one string literal argument.");var i=e[1];return t.scope.has(i)?new Zi(i,t.scope.get(i)):t.error('Unknown variable "'+i+'". Make sure "'+i+'" has been bound in an enclosing "let" expression before using it.',1)},Zi.prototype.evaluate=function(e){return this.boundExpression.evaluate(e)},Zi.prototype.eachChild=function(){},Zi.prototype.outputDefined=function(){return!1},Zi.prototype.serialize=function(){return["var",this.name]};var Zr=function(e,t,i,l,f){t===void 0&&(t=[]),l===void 0&&(l=new it),f===void 0&&(f=[]),this.registry=e,this.path=t,this.key=t.map(function(m){return"["+m+"]"}).join(""),this.scope=l,this.errors=f,this.expectedType=i};function Sa(e,t){for(var i,l=e.length-1,f=0,m=l,x=0;f<=m;)if((i=e[x=Math.floor((f+m)/2)])<=t){if(x===l||t<e[x+1])return x;f=x+1}else{if(!(i>t))throw new ii("Input is not a number.");m=x-1}return 0}Zr.prototype.parse=function(e,t,i,l,f){return f===void 0&&(f={}),t?this.concat(t,i,l)._parse(e,f):this._parse(e,f)},Zr.prototype._parse=function(e,t){function i(A,M,B){return B==="assert"?new Pr(M,[A]):B==="coerce"?new Ei(M,[A]):A}if(e!==null&&typeof e!="string"&&typeof e!="boolean"&&typeof e!="number"||(e=["literal",e]),Array.isArray(e)){if(e.length===0)return this.error('Expected an array with at least one element. If you wanted a literal array, use ["literal", []].');var l=e[0];if(typeof l!="string")return this.error("Expression name must be a string, but found "+typeof l+' instead. If you wanted a literal array, use ["literal", [...]].',0),null;var f=this.registry[l];if(f){var m=f.parse(e,this);if(!m)return null;if(this.expectedType){var x=this.expectedType,k=m.type;if(x.kind!=="string"&&x.kind!=="number"&&x.kind!=="boolean"&&x.kind!=="object"&&x.kind!=="array"||k.kind!=="value")if(x.kind!=="color"&&x.kind!=="formatted"&&x.kind!=="resolvedImage"||k.kind!=="value"&&k.kind!=="string"){if(this.checkSubtype(x,k))return null}else m=i(m,x,t.typeAnnotation||"coerce");else m=i(m,x,t.typeAnnotation||"assert")}if(!(m instanceof ki)&&m.type.kind!=="resolvedImage"&&function A(M){if(M instanceof Zi)return A(M.boundExpression);if(M instanceof zi&&M.name==="error"||M instanceof Jn||M instanceof On)return!1;var B=M instanceof Ei||M instanceof Pr,U=!0;return M.eachChild(function(j){U=B?U&&A(j):U&&j instanceof ki}),!!U&&wa(M)&&un(M,["zoom","heatmap-density","line-progress","accumulated","is-supported-script"])}(m)){var I=new qi;try{m=new ki(m.type,m.evaluate(I))}catch(A){return this.error(A.message),null}}return m}return this.error('Unknown expression "'+l+'". If you wanted a literal array, use ["literal", [...]].',0)}return this.error(e===void 0?"'undefined' value invalid. Use null instead.":typeof e=="object"?'Bare objects invalid. Use ["literal", {...}] instead.':"Expected an array, but found "+typeof e+" instead.")},Zr.prototype.concat=function(e,t,i){var l=typeof e=="number"?this.path.concat(e):this.path,f=i?this.scope.concat(i):this.scope;return new Zr(this.registry,l,t||null,f,this.errors)},Zr.prototype.error=function(e){for(var t=[],i=arguments.length-1;i-- >0;)t[i]=arguments[i+1];var l=""+this.key+t.map(function(f){return"["+f+"]"}).join("");this.errors.push(new De(l,e))},Zr.prototype.checkSubtype=function(e,t){var i=hr(e,t);return i&&this.error(i),i};var Fn=function(e,t,i){this.type=e,this.input=t,this.labels=[],this.outputs=[];for(var l=0,f=i;l<f.length;l+=1){var m=f[l],x=m[1];this.labels.push(m[0]),this.outputs.push(x)}};function vi(e,t,i){return e*(1-i)+t*i}Fn.parse=function(e,t){if(e.length-1<4)return t.error("Expected at least 4 arguments, but found only "+(e.length-1)+".");if((e.length-1)%2!=0)return t.error("Expected an even number of arguments.");var i=t.parse(e[1],1,ze);if(!i)return null;var l=[],f=null;t.expectedType&&t.expectedType.kind!=="value"&&(f=t.expectedType);for(var m=1;m<e.length;m+=2){var x=m===1?-1/0:e[m],k=e[m+1],I=m,A=m+1;if(typeof x!="number")return t.error('Input/output pairs for "step" expressions must be defined using literal numeric values (not computed expressions) for the input values.',I);if(l.length&&l[l.length-1][0]>=x)return t.error('Input/output pairs for "step" expressions must be arranged with input values in strictly ascending order.',I);var M=t.parse(k,A,f);if(!M)return null;f=f||M.type,l.push([x,M])}return new Fn(f,i,l)},Fn.prototype.evaluate=function(e){var t=this.labels,i=this.outputs;if(t.length===1)return i[0].evaluate(e);var l=this.input.evaluate(e);if(l<=t[0])return i[0].evaluate(e);var f=t.length;return l>=t[f-1]?i[f-1].evaluate(e):i[Sa(t,l)].evaluate(e)},Fn.prototype.eachChild=function(e){e(this.input);for(var t=0,i=this.outputs;t<i.length;t+=1)e(i[t])},Fn.prototype.outputDefined=function(){return this.outputs.every(function(e){return e.outputDefined()})},Fn.prototype.serialize=function(){for(var e=["step",this.input.serialize()],t=0;t<this.labels.length;t++)t>0&&e.push(this.labels[t]),e.push(this.outputs[t].serialize());return e};var Fo=Object.freeze({__proto__:null,number:vi,color:function(e,t,i){return new ur(vi(e.r,t.r,i),vi(e.g,t.g,i),vi(e.b,t.b,i),vi(e.a,t.a,i))},array:function(e,t,i){return e.map(function(l,f){return vi(l,t[f],i)})}}),ic=6/29*3*(6/29),Uh=Math.PI/180,Vh=180/Math.PI;function ql(e){return e>.008856451679035631?Math.pow(e,1/3):e/ic+4/29}function jl(e){return e>6/29?e*e*e:ic*(e-4/29)}function Zl(e){return 255*(e<=.0031308?12.92*e:1.055*Math.pow(e,1/2.4)-.055)}function Gl(e){return(e/=255)<=.04045?e/12.92:Math.pow((e+.055)/1.055,2.4)}function nc(e){var t=Gl(e.r),i=Gl(e.g),l=Gl(e.b),f=ql((.4124564*t+.3575761*i+.1804375*l)/.95047),m=ql((.2126729*t+.7151522*i+.072175*l)/1);return{l:116*m-16,a:500*(f-m),b:200*(m-ql((.0193339*t+.119192*i+.9503041*l)/1.08883)),alpha:e.a}}function ac(e){var t=(e.l+16)/116,i=isNaN(e.a)?t:t+e.a/500,l=isNaN(e.b)?t:t-e.b/200;return t=1*jl(t),i=.95047*jl(i),l=1.08883*jl(l),new ur(Zl(3.2404542*i-1.5371385*t-.4985314*l),Zl(-.969266*i+1.8760108*t+.041556*l),Zl(.0556434*i-.2040259*t+1.0572252*l),e.alpha)}function qh(e,t,i){var l=t-e;return e+i*(l>180||l<-180?l-360*Math.round(l/360):l)}var us={forward:nc,reverse:ac,interpolate:function(e,t,i){return{l:vi(e.l,t.l,i),a:vi(e.a,t.a,i),b:vi(e.b,t.b,i),alpha:vi(e.alpha,t.alpha,i)}}},cs={forward:function(e){var t=nc(e),i=t.l,l=t.a,f=t.b,m=Math.atan2(f,l)*Vh;return{h:m<0?m+360:m,c:Math.sqrt(l*l+f*f),l:i,alpha:e.a}},reverse:function(e){var t=e.h*Uh,i=e.c;return ac({l:e.l,a:Math.cos(t)*i,b:Math.sin(t)*i,alpha:e.alpha})},interpolate:function(e,t,i){return{h:qh(e.h,t.h,i),c:vi(e.c,t.c,i),l:vi(e.l,t.l,i),alpha:vi(e.alpha,t.alpha,i)}}},oc=Object.freeze({__proto__:null,lab:us,hcl:cs}),Qi=function(e,t,i,l,f){this.type=e,this.operator=t,this.interpolation=i,this.input=l,this.labels=[],this.outputs=[];for(var m=0,x=f;m<x.length;m+=1){var k=x[m],I=k[1];this.labels.push(k[0]),this.outputs.push(I)}};function Kl(e,t,i,l){var f=l-i,m=e-i;return f===0?0:t===1?m/f:(Math.pow(t,m)-1)/(Math.pow(t,f)-1)}Qi.interpolationFactor=function(e,t,i,l){var f=0;if(e.name==="exponential")f=Kl(t,e.base,i,l);else if(e.name==="linear")f=Kl(t,1,i,l);else if(e.name==="cubic-bezier"){var m=e.controlPoints;f=new E(m[0],m[1],m[2],m[3]).solve(Kl(t,1,i,l))}return f},Qi.parse=function(e,t){var i=e[0],l=e[1],f=e[2],m=e.slice(3);if(!Array.isArray(l)||l.length===0)return t.error("Expected an interpolation type expression.",1);if(l[0]==="linear")l={name:"linear"};else if(l[0]==="exponential"){var x=l[1];if(typeof x!="number")return t.error("Exponential interpolation requires a numeric base.",1,1);l={name:"exponential",base:x}}else{if(l[0]!=="cubic-bezier")return t.error("Unknown interpolation type "+String(l[0]),1,0);var k=l.slice(1);if(k.length!==4||k.some(function(ce){return typeof ce!="number"||ce<0||ce>1}))return t.error("Cubic bezier interpolation requires four numeric arguments with values between 0 and 1.",1);l={name:"cubic-bezier",controlPoints:k}}if(e.length-1<4)return t.error("Expected at least 4 arguments, but found only "+(e.length-1)+".");if((e.length-1)%2!=0)return t.error("Expected an even number of arguments.");if(!(f=t.parse(f,2,ze)))return null;var I=[],A=null;i==="interpolate-hcl"||i==="interpolate-lab"?A=Ye:t.expectedType&&t.expectedType.kind!=="value"&&(A=t.expectedType);for(var M=0;M<m.length;M+=2){var B=m[M],U=m[M+1],j=M+3,J=M+4;if(typeof B!="number")return t.error('Input/output pairs for "interpolate" expressions must be defined using literal numeric values (not computed expressions) for the input values.',j);if(I.length&&I[I.length-1][0]>=B)return t.error('Input/output pairs for "interpolate" expressions must be arranged with input values in strictly ascending order.',j);var $=t.parse(U,J,A);if(!$)return null;A=A||$.type,I.push([B,$])}return A.kind==="number"||A.kind==="color"||A.kind==="array"&&A.itemType.kind==="number"&&typeof A.N=="number"?new Qi(A,i,l,f,I):t.error("Type "+$t(A)+" is not interpolatable.")},Qi.prototype.evaluate=function(e){var t=this.labels,i=this.outputs;if(t.length===1)return i[0].evaluate(e);var l=this.input.evaluate(e);if(l<=t[0])return i[0].evaluate(e);var f=t.length;if(l>=t[f-1])return i[f-1].evaluate(e);var m=Sa(t,l),x=Qi.interpolationFactor(this.interpolation,l,t[m],t[m+1]),k=i[m].evaluate(e),I=i[m+1].evaluate(e);return this.operator==="interpolate"?Fo[this.type.kind.toLowerCase()](k,I,x):this.operator==="interpolate-hcl"?cs.reverse(cs.interpolate(cs.forward(k),cs.forward(I),x)):us.reverse(us.interpolate(us.forward(k),us.forward(I),x))},Qi.prototype.eachChild=function(e){e(this.input);for(var t=0,i=this.outputs;t<i.length;t+=1)e(i[t])},Qi.prototype.outputDefined=function(){return this.outputs.every(function(e){return e.outputDefined()})},Qi.prototype.serialize=function(){var e;e=this.interpolation.name==="linear"?["linear"]:this.interpolation.name==="exponential"?this.interpolation.base===1?["linear"]:["exponential",this.interpolation.base]:["cubic-bezier"].concat(this.interpolation.controlPoints);for(var t=[this.operator,e,this.input.serialize()],i=0;i<this.labels.length;i++)t.push(this.labels[i],this.outputs[i].serialize());return t};var ja=function(e,t){this.type=e,this.args=t};ja.parse=function(e,t){if(e.length<2)return t.error("Expectected at least one argument.");var i=null,l=t.expectedType;l&&l.kind!=="value"&&(i=l);for(var f=[],m=0,x=e.slice(1);m<x.length;m+=1){var k=t.parse(x[m],1+f.length,i,void 0,{typeAnnotation:"omit"});if(!k)return null;i=i||k.type,f.push(k)}var I=l&&f.some(function(A){return hr(l,A.type)});return new ja(I?rt:i,f)},ja.prototype.evaluate=function(e){for(var t,i=null,l=0,f=0,m=this.args;f<m.length&&(l++,(i=m[f].evaluate(e))&&i instanceof Ri&&!i.available&&(t||(t=i.name),i=null,l===this.args.length&&(i=t)),i===null);f+=1);return i},ja.prototype.eachChild=function(e){this.args.forEach(e)},ja.prototype.outputDefined=function(){return this.args.every(function(e){return e.outputDefined()})},ja.prototype.serialize=function(){var e=["coalesce"];return this.eachChild(function(t){e.push(t.serialize())}),e};var Za=function(e,t){this.type=t.type,this.bindings=[].concat(e),this.result=t};Za.prototype.evaluate=function(e){return this.result.evaluate(e)},Za.prototype.eachChild=function(e){for(var t=0,i=this.bindings;t<i.length;t+=1)e(i[t][1]);e(this.result)},Za.parse=function(e,t){if(e.length<4)return t.error("Expected at least 3 arguments, but found "+(e.length-1)+" instead.");for(var i=[],l=1;l<e.length-1;l+=2){var f=e[l];if(typeof f!="string")return t.error("Expected string, but found "+typeof f+" instead.",l);if(/[^a-zA-Z0-9_]/.test(f))return t.error("Variable names must contain only alphanumeric characters or '_'.",l);var m=t.parse(e[l+1],l+1);if(!m)return null;i.push([f,m])}var x=t.parse(e[e.length-1],e.length-1,t.expectedType,i);return x?new Za(i,x):null},Za.prototype.outputDefined=function(){return this.result.outputDefined()},Za.prototype.serialize=function(){for(var e=["let"],t=0,i=this.bindings;t<i.length;t+=1){var l=i[t];e.push(l[0],l[1].serialize())}return e.push(this.result.serialize()),e};var po=function(e,t,i){this.type=e,this.index=t,this.input=i};po.parse=function(e,t){if(e.length!==3)return t.error("Expected 2 arguments, but found "+(e.length-1)+" instead.");var i=t.parse(e[1],1,ze),l=t.parse(e[2],2,lr(t.expectedType||rt));return i&&l?new po(l.type.itemType,i,l):null},po.prototype.evaluate=function(e){var t=this.index.evaluate(e),i=this.input.evaluate(e);if(t<0)throw new ii("Array index out of bounds: "+t+" < 0.");if(t>=i.length)throw new ii("Array index out of bounds: "+t+" > "+(i.length-1)+".");if(t!==Math.floor(t))throw new ii("Array index must be an integer, but found "+t+" instead.");return i[t]},po.prototype.eachChild=function(e){e(this.index),e(this.input)},po.prototype.outputDefined=function(){return!1},po.prototype.serialize=function(){return["at",this.index.serialize(),this.input.serialize()]};var fo=function(e,t){this.type=Ge,this.needle=e,this.haystack=t};fo.parse=function(e,t){if(e.length!==3)return t.error("Expected 2 arguments, but found "+(e.length-1)+" instead.");var i=t.parse(e[1],1,rt),l=t.parse(e[2],2,rt);return i&&l?Or(i.type,[Ge,et,ze,nt,rt])?new fo(i,l):t.error("Expected first argument to be of type boolean, string, number or null, but found "+$t(i.type)+" instead"):null},fo.prototype.evaluate=function(e){var t=this.needle.evaluate(e),i=this.haystack.evaluate(e);if(!i)return!1;if(!gr(t,["boolean","string","number","null"]))throw new ii("Expected first argument to be of type boolean, string, number or null, but found "+$t(jr(t))+" instead.");if(!gr(i,["string","array"]))throw new ii("Expected second argument to be of type array or string, but found "+$t(jr(i))+" instead.");return i.indexOf(t)>=0},fo.prototype.eachChild=function(e){e(this.needle),e(this.haystack)},fo.prototype.outputDefined=function(){return!0},fo.prototype.serialize=function(){return["in",this.needle.serialize(),this.haystack.serialize()]};var Ga=function(e,t,i){this.type=ze,this.needle=e,this.haystack=t,this.fromIndex=i};Ga.parse=function(e,t){if(e.length<=2||e.length>=5)return t.error("Expected 3 or 4 arguments, but found "+(e.length-1)+" instead.");var i=t.parse(e[1],1,rt),l=t.parse(e[2],2,rt);if(!i||!l)return null;if(!Or(i.type,[Ge,et,ze,nt,rt]))return t.error("Expected first argument to be of type boolean, string, number or null, but found "+$t(i.type)+" instead");if(e.length===4){var f=t.parse(e[3],3,ze);return f?new Ga(i,l,f):null}return new Ga(i,l)},Ga.prototype.evaluate=function(e){var t=this.needle.evaluate(e),i=this.haystack.evaluate(e);if(!gr(t,["boolean","string","number","null"]))throw new ii("Expected first argument to be of type boolean, string, number or null, but found "+$t(jr(t))+" instead.");if(!gr(i,["string","array"]))throw new ii("Expected second argument to be of type array or string, but found "+$t(jr(i))+" instead.");if(this.fromIndex){var l=this.fromIndex.evaluate(e);return i.indexOf(t,l)}return i.indexOf(t)},Ga.prototype.eachChild=function(e){e(this.needle),e(this.haystack),this.fromIndex&&e(this.fromIndex)},Ga.prototype.outputDefined=function(){return!1},Ga.prototype.serialize=function(){if(this.fromIndex!=null&&this.fromIndex!==void 0){var e=this.fromIndex.serialize();return["index-of",this.needle.serialize(),this.haystack.serialize(),e]}return["index-of",this.needle.serialize(),this.haystack.serialize()]};var mo=function(e,t,i,l,f,m){this.inputType=e,this.type=t,this.input=i,this.cases=l,this.outputs=f,this.otherwise=m};mo.parse=function(e,t){if(e.length<5)return t.error("Expected at least 4 arguments, but found only "+(e.length-1)+".");if(e.length%2!=1)return t.error("Expected an even number of arguments.");var i,l;t.expectedType&&t.expectedType.kind!=="value"&&(l=t.expectedType);for(var f={},m=[],x=2;x<e.length-1;x+=2){var k=e[x],I=e[x+1];Array.isArray(k)||(k=[k]);var A=t.concat(x);if(k.length===0)return A.error("Expected at least one branch label.");for(var M=0,B=k;M<B.length;M+=1){var U=B[M];if(typeof U!="number"&&typeof U!="string")return A.error("Branch labels must be numbers or strings.");if(typeof U=="number"&&Math.abs(U)>Number.MAX_SAFE_INTEGER)return A.error("Branch labels must be integers no larger than "+Number.MAX_SAFE_INTEGER+".");if(typeof U=="number"&&Math.floor(U)!==U)return A.error("Numeric branch labels must be integer values.");if(i){if(A.checkSubtype(i,jr(U)))return null}else i=jr(U);if(f[String(U)]!==void 0)return A.error("Branch labels must be unique.");f[String(U)]=m.length}var j=t.parse(I,x,l);if(!j)return null;l=l||j.type,m.push(j)}var J=t.parse(e[1],1,rt);if(!J)return null;var $=t.parse(e[e.length-1],e.length-1,l);return $?J.type.kind!=="value"&&t.concat(1).checkSubtype(i,J.type)?null:new mo(i,l,J,f,m,$):null},mo.prototype.evaluate=function(e){var t=this.input.evaluate(e);return(jr(t)===this.inputType&&this.outputs[this.cases[t]]||this.otherwise).evaluate(e)},mo.prototype.eachChild=function(e){e(this.input),this.outputs.forEach(e),e(this.otherwise)},mo.prototype.outputDefined=function(){return this.outputs.every(function(e){return e.outputDefined()})&&this.otherwise.outputDefined()},mo.prototype.serialize=function(){for(var e=this,t=["match",this.input.serialize()],i=[],l={},f=0,m=Object.keys(this.cases).sort();f<m.length;f+=1){var x=m[f];(B=l[this.cases[x]])===void 0?(l[this.cases[x]]=i.length,i.push([this.cases[x],[x]])):i[B][1].push(x)}for(var k=function(j){return e.inputType.kind==="number"?Number(j):j},I=0,A=i;I<A.length;I+=1){var M=A[I],B=M[0],U=M[1];t.push(U.length===1?k(U[0]):U.map(k)),t.push(this.outputs[outputIndex$1].serialize())}return t.push(this.otherwise.serialize()),t};var yo=function(e,t,i){this.type=e,this.branches=t,this.otherwise=i};yo.parse=function(e,t){if(e.length<4)return t.error("Expected at least 3 arguments, but found only "+(e.length-1)+".");if(e.length%2!=0)return t.error("Expected an odd number of arguments.");var i;t.expectedType&&t.expectedType.kind!=="value"&&(i=t.expectedType);for(var l=[],f=1;f<e.length-1;f+=2){var m=t.parse(e[f],f,Ge);if(!m)return null;var x=t.parse(e[f+1],f+1,i);if(!x)return null;l.push([m,x]),i=i||x.type}var k=t.parse(e[e.length-1],e.length-1,i);return k?new yo(i,l,k):null},yo.prototype.evaluate=function(e){for(var t=0,i=this.branches;t<i.length;t+=1){var l=i[t],f=l[1];if(l[0].evaluate(e))return f.evaluate(e)}return this.otherwise.evaluate(e)},yo.prototype.eachChild=function(e){for(var t=0,i=this.branches;t<i.length;t+=1){var l=i[t],f=l[1];e(l[0]),e(f)}e(this.otherwise)},yo.prototype.outputDefined=function(){return this.branches.every(function(e){return e[1].outputDefined()})&&this.otherwise.outputDefined()},yo.prototype.serialize=function(){var e=["case"];return this.eachChild(function(t){e.push(t.serialize())}),e};var Ka=function(e,t,i,l){this.type=e,this.input=t,this.beginIndex=i,this.endIndex=l};function sc(e,t){return e==="=="||e==="!="?t.kind==="boolean"||t.kind==="string"||t.kind==="number"||t.kind==="null"||t.kind==="value":t.kind==="string"||t.kind==="number"||t.kind==="value"}function lc(e,t,i,l){return l.compare(t,i)===0}function Dr(e,t,i){var l=e!=="=="&&e!=="!=";return function(){function f(m,x,k){this.type=Ge,this.lhs=m,this.rhs=x,this.collator=k,this.hasUntypedArgument=m.type.kind==="value"||x.type.kind==="value"}return f.parse=function(m,x){if(m.length!==3&&m.length!==4)return x.error("Expected two or three arguments.");var k=m[0],I=x.parse(m[1],1,rt);if(!I)return null;if(!sc(k,I.type))return x.concat(1).error('"'+k+`" comparisons are not supported for type '`+$t(I.type)+"'.");var A=x.parse(m[2],2,rt);if(!A)return null;if(!sc(k,A.type))return x.concat(2).error('"'+k+`" comparisons are not supported for type '`+$t(A.type)+"'.");if(I.type.kind!==A.type.kind&&I.type.kind!=="value"&&A.type.kind!=="value")return x.error("Cannot compare types '"+$t(I.type)+"' and '"+$t(A.type)+"'.");l&&(I.type.kind==="value"&&A.type.kind!=="value"?I=new Pr(A.type,[I]):I.type.kind!=="value"&&A.type.kind==="value"&&(A=new Pr(I.type,[A])));var M=null;if(m.length===4){if(I.type.kind!=="string"&&A.type.kind!=="string"&&I.type.kind!=="value"&&A.type.kind!=="value")return x.error("Cannot use collator to compare non-string types.");if(!(M=x.parse(m[3],3,Qt)))return null}return new f(I,A,M)},f.prototype.evaluate=function(m){var x=this.lhs.evaluate(m),k=this.rhs.evaluate(m);if(l&&this.hasUntypedArgument){var I=jr(x),A=jr(k);if(I.kind!==A.kind||I.kind!=="string"&&I.kind!=="number")throw new ii('Expected arguments for "'+e+'" to be (string, string) or (number, number), but found ('+I.kind+", "+A.kind+") instead.")}if(this.collator&&!l&&this.hasUntypedArgument){var M=jr(x),B=jr(k);if(M.kind!=="string"||B.kind!=="string")return t(m,x,k)}return this.collator?i(m,x,k,this.collator.evaluate(m)):t(m,x,k)},f.prototype.eachChild=function(m){m(this.lhs),m(this.rhs),this.collator&&m(this.collator)},f.prototype.outputDefined=function(){return!0},f.prototype.serialize=function(){var m=[e];return this.eachChild(function(x){m.push(x.serialize())}),m},f}()}Ka.parse=function(e,t){if(e.length<=2||e.length>=5)return t.error("Expected 3 or 4 arguments, but found "+(e.length-1)+" instead.");var i=t.parse(e[1],1,rt),l=t.parse(e[2],2,ze);if(!i||!l)return null;if(!Or(i.type,[lr(rt),et,rt]))return t.error("Expected first argument to be of type array or string, but found "+$t(i.type)+" instead");if(e.length===4){var f=t.parse(e[3],3,ze);return f?new Ka(i.type,i,l,f):null}return new Ka(i.type,i,l)},Ka.prototype.evaluate=function(e){var t=this.input.evaluate(e),i=this.beginIndex.evaluate(e);if(!gr(t,["string","array"]))throw new ii("Expected first argument to be of type array or string, but found "+$t(jr(t))+" instead.");if(this.endIndex){var l=this.endIndex.evaluate(e);return t.slice(i,l)}return t.slice(i)},Ka.prototype.eachChild=function(e){e(this.input),e(this.beginIndex),this.endIndex&&e(this.endIndex)},Ka.prototype.outputDefined=function(){return!1},Ka.prototype.serialize=function(){if(this.endIndex!=null&&this.endIndex!==void 0){var e=this.endIndex.serialize();return["slice",this.input.serialize(),this.beginIndex.serialize(),e]}return["slice",this.input.serialize(),this.beginIndex.serialize()]};var jh=Dr("==",function(e,t,i){return t===i},lc),Vs=Dr("!=",function(e,t,i){return t!==i},function(e,t,i,l){return!lc(0,t,i,l)}),uc=Dr("<",function(e,t,i){return t<i},function(e,t,i,l){return l.compare(t,i)<0}),cc=Dr(">",function(e,t,i){return t>i},function(e,t,i,l){return l.compare(t,i)>0}),hc=Dr("<=",function(e,t,i){return t<=i},function(e,t,i,l){return l.compare(t,i)<=0}),pc=Dr(">=",function(e,t,i){return t>=i},function(e,t,i,l){return l.compare(t,i)>=0}),go=function(e,t,i,l,f){this.type=et,this.number=e,this.locale=t,this.currency=i,this.minFractionDigits=l,this.maxFractionDigits=f};go.parse=function(e,t){if(e.length!==3)return t.error("Expected two arguments.");var i=t.parse(e[1],1,ze);if(!i)return null;var l=e[2];if(typeof l!="object"||Array.isArray(l))return t.error("NumberFormat options argument must be an object.");var f=null;if(l.locale&&!(f=t.parse(l.locale,1,et)))return null;var m=null;if(l.currency&&!(m=t.parse(l.currency,1,et)))return null;var x=null;if(l["min-fraction-digits"]&&!(x=t.parse(l["min-fraction-digits"],1,ze)))return null;var k=null;return l["max-fraction-digits"]&&!(k=t.parse(l["max-fraction-digits"],1,ze))?null:new go(i,f,m,x,k)},go.prototype.evaluate=function(e){return new Intl.NumberFormat(this.locale?this.locale.evaluate(e):[],{style:this.currency?"currency":"decimal",currency:this.currency?this.currency.evaluate(e):void 0,minimumFractionDigits:this.minFractionDigits?this.minFractionDigits.evaluate(e):void 0,maximumFractionDigits:this.maxFractionDigits?this.maxFractionDigits.evaluate(e):void 0}).format(this.number.evaluate(e))},go.prototype.eachChild=function(e){e(this.number),this.locale&&e(this.locale),this.currency&&e(this.currency),this.minFractionDigits&&e(this.minFractionDigits),this.maxFractionDigits&&e(this.maxFractionDigits)},go.prototype.outputDefined=function(){return!1},go.prototype.serialize=function(){var e={};return this.locale&&(e.locale=this.locale.serialize()),this.currency&&(e.currency=this.currency.serialize()),this.minFractionDigits&&(e["min-fraction-digits"]=this.minFractionDigits.serialize()),this.maxFractionDigits&&(e["max-fraction-digits"]=this.maxFractionDigits.serialize()),["number-format",this.number.serialize(),e]};var Ha=function(e){this.type=ze,this.input=e};Ha.parse=function(e,t){if(e.length!==2)return t.error("Expected 1 argument, but found "+(e.length-1)+" instead.");var i=t.parse(e[1],1);return i?i.type.kind!=="array"&&i.type.kind!=="string"&&i.type.kind!=="value"?t.error("Expected argument of type string or array, but found "+$t(i.type)+" instead."):new Ha(i):null},Ha.prototype.evaluate=function(e){var t=this.input.evaluate(e);if(typeof t=="string"||Array.isArray(t))return t.length;throw new ii("Expected value to be of type string or array, but found "+$t(jr(t))+" instead.")},Ha.prototype.eachChild=function(e){e(this.input)},Ha.prototype.outputDefined=function(){return!1},Ha.prototype.serialize=function(){var e=["length"];return this.eachChild(function(t){e.push(t.serialize())}),e};var _o={"==":jh,"!=":Vs,">":cc,"<":uc,">=":pc,"<=":hc,array:Pr,at:po,boolean:Pr,case:yo,coalesce:ja,collator:Jn,format:Bn,image:_n,in:fo,"index-of":Ga,interpolate:Qi,"interpolate-hcl":Qi,"interpolate-lab":Qi,length:Ha,let:Za,literal:ki,match:mo,number:Pr,"number-format":go,object:Pr,slice:Ka,step:Fn,string:Pr,"to-boolean":Ei,"to-color":Ei,"to-number":Ei,"to-string":Ei,var:Zi,within:On};function fc(e,t){var i=t[0],l=t[1],f=t[2],m=t[3];i=i.evaluate(e),l=l.evaluate(e),f=f.evaluate(e);var x=m?m.evaluate(e):1,k=Ua(i,l,f,x);if(k)throw new ii(k);return new ur(i/255*x,l/255*x,f/255*x,x)}function dc(e,t){return e in t}function Hl(e,t){var i=t[e];return i===void 0?null:i}function vo(e){return{type:e}}function mc(e){return{result:"success",value:e}}function bo(e){return{result:"error",value:e}}function xo(e){return e["property-type"]==="data-driven"||e["property-type"]==="cross-faded-data-driven"}function yc(e){return!!e.expression&&e.expression.parameters.indexOf("zoom")>-1}function hs(e){return!!e.expression&&e.expression.interpolated}function Fr(e){return e instanceof Number?"number":e instanceof String?"string":e instanceof Boolean?"boolean":Array.isArray(e)?"array":e===null?"null":typeof e}function qs(e){return typeof e=="object"&&e!==null&&!Array.isArray(e)}function Zh(e){return e}function No(e,t,i){return e!==void 0?e:t!==void 0?t:i!==void 0?i:void 0}function gc(e,t,i,l,f){return No(typeof i===f?l[i]:void 0,e.default,t.default)}function Gh(e,t,i){if(Fr(i)!=="number")return No(e.default,t.default);var l=e.stops.length;if(l===1||i<=e.stops[0][0])return e.stops[0][1];if(i>=e.stops[l-1][0])return e.stops[l-1][1];var f=Sa(e.stops.map(function(m){return m[0]}),i);return e.stops[f][1]}function _c(e,t,i){var l=e.base!==void 0?e.base:1;if(Fr(i)!=="number")return No(e.default,t.default);var f=e.stops.length;if(f===1||i<=e.stops[0][0])return e.stops[0][1];if(i>=e.stops[f-1][0])return e.stops[f-1][1];var m=Sa(e.stops.map(function(B){return B[0]}),i),x=function(B,U,j,J){var $=J-j,ce=B-j;return $===0?0:U===1?ce/$:(Math.pow(U,ce)-1)/(Math.pow(U,$)-1)}(i,l,e.stops[m][0],e.stops[m+1][0]),k=e.stops[m][1],I=e.stops[m+1][1],A=Fo[t.type]||Zh;if(e.colorSpace&&e.colorSpace!=="rgb"){var M=oc[e.colorSpace];A=function(B,U){return M.reverse(M.interpolate(M.forward(B),M.forward(U),x))}}return typeof k.evaluate=="function"?{evaluate:function(){for(var B=[],U=arguments.length;U--;)B[U]=arguments[U];var j=k.evaluate.apply(void 0,B),J=I.evaluate.apply(void 0,B);if(j!==void 0&&J!==void 0)return A(j,J,x)}}:A(k,I,x)}function js(e,t,i){return t.type==="color"?i=ur.parse(i):t.type==="formatted"?i=ri.fromString(i.toString()):t.type==="resolvedImage"?i=Ri.fromString(i.toString()):Fr(i)===t.type||t.type==="enum"&&t.values[i]||(i=void 0),No(i,e.default,t.default)}zi.register(_o,{error:[{kind:"error"},[et],function(e,t){throw new ii(t[0].evaluate(e))}],typeof:[et,[rt],function(e,t){return $t(jr(t[0].evaluate(e)))}],"to-rgba":[lr(ze,4),[Ye],function(e,t){return t[0].evaluate(e).toArray()}],rgb:[Ye,[ze,ze,ze],fc],rgba:[Ye,[ze,ze,ze,ze],fc],has:{type:Ge,overloads:[[[et],function(e,t){return dc(t[0].evaluate(e),e.properties())}],[[et,Pt],function(e,t){var i=t[1];return dc(t[0].evaluate(e),i.evaluate(e))}]]},get:{type:rt,overloads:[[[et],function(e,t){return Hl(t[0].evaluate(e),e.properties())}],[[et,Pt],function(e,t){var i=t[1];return Hl(t[0].evaluate(e),i.evaluate(e))}]]},"feature-state":[rt,[et],function(e,t){return Hl(t[0].evaluate(e),e.featureState||{})}],properties:[Pt,[],function(e){return e.properties()}],"geometry-type":[et,[],function(e){return e.geometryType()}],id:[rt,[],function(e){return e.id()}],zoom:[ze,[],function(e){return e.globals.zoom}],"heatmap-density":[ze,[],function(e){return e.globals.heatmapDensity||0}],"line-progress":[ze,[],function(e){return e.globals.lineProgress||0}],accumulated:[rt,[],function(e){return e.globals.accumulated===void 0?null:e.globals.accumulated}],"+":[ze,vo(ze),function(e,t){for(var i=0,l=0,f=t;l<f.length;l+=1)i+=f[l].evaluate(e);return i}],"*":[ze,vo(ze),function(e,t){for(var i=1,l=0,f=t;l<f.length;l+=1)i*=f[l].evaluate(e);return i}],"-":{type:ze,overloads:[[[ze,ze],function(e,t){var i=t[1];return t[0].evaluate(e)-i.evaluate(e)}],[[ze],function(e,t){return-t[0].evaluate(e)}]]},"/":[ze,[ze,ze],function(e,t){var i=t[1];return t[0].evaluate(e)/i.evaluate(e)}],"%":[ze,[ze,ze],function(e,t){var i=t[1];return t[0].evaluate(e)%i.evaluate(e)}],ln2:[ze,[],function(){return Math.LN2}],pi:[ze,[],function(){return Math.PI}],e:[ze,[],function(){return Math.E}],"^":[ze,[ze,ze],function(e,t){var i=t[1];return Math.pow(t[0].evaluate(e),i.evaluate(e))}],sqrt:[ze,[ze],function(e,t){return Math.sqrt(t[0].evaluate(e))}],log10:[ze,[ze],function(e,t){return Math.log(t[0].evaluate(e))/Math.LN10}],ln:[ze,[ze],function(e,t){return Math.log(t[0].evaluate(e))}],log2:[ze,[ze],function(e,t){return Math.log(t[0].evaluate(e))/Math.LN2}],sin:[ze,[ze],function(e,t){return Math.sin(t[0].evaluate(e))}],cos:[ze,[ze],function(e,t){return Math.cos(t[0].evaluate(e))}],tan:[ze,[ze],function(e,t){return Math.tan(t[0].evaluate(e))}],asin:[ze,[ze],function(e,t){return Math.asin(t[0].evaluate(e))}],acos:[ze,[ze],function(e,t){return Math.acos(t[0].evaluate(e))}],atan:[ze,[ze],function(e,t){return Math.atan(t[0].evaluate(e))}],min:[ze,vo(ze),function(e,t){return Math.min.apply(Math,t.map(function(i){return i.evaluate(e)}))}],max:[ze,vo(ze),function(e,t){return Math.max.apply(Math,t.map(function(i){return i.evaluate(e)}))}],abs:[ze,[ze],function(e,t){return Math.abs(t[0].evaluate(e))}],round:[ze,[ze],function(e,t){var i=t[0].evaluate(e);return i<0?-Math.round(-i):Math.round(i)}],floor:[ze,[ze],function(e,t){return Math.floor(t[0].evaluate(e))}],ceil:[ze,[ze],function(e,t){return Math.ceil(t[0].evaluate(e))}],"filter-==":[Ge,[et,rt],function(e,t){var i=t[0],l=t[1];return e.properties()[i.value]===l.value}],"filter-id-==":[Ge,[rt],function(e,t){var i=t[0];return e.id()===i.value}],"filter-type-==":[Ge,[et],function(e,t){var i=t[0];return e.geometryType()===i.value}],"filter-<":[Ge,[et,rt],function(e,t){var i=t[0],l=t[1],f=e.properties()[i.value],m=l.value;return typeof f==typeof m&&f<m}],"filter-id-<":[Ge,[rt],function(e,t){var i=t[0],l=e.id(),f=i.value;return typeof l==typeof f&&l<f}],"filter->":[Ge,[et,rt],function(e,t){var i=t[0],l=t[1],f=e.properties()[i.value],m=l.value;return typeof f==typeof m&&f>m}],"filter-id->":[Ge,[rt],function(e,t){var i=t[0],l=e.id(),f=i.value;return typeof l==typeof f&&l>f}],"filter-<=":[Ge,[et,rt],function(e,t){var i=t[0],l=t[1],f=e.properties()[i.value],m=l.value;return typeof f==typeof m&&f<=m}],"filter-id-<=":[Ge,[rt],function(e,t){var i=t[0],l=e.id(),f=i.value;return typeof l==typeof f&&l<=f}],"filter->=":[Ge,[et,rt],function(e,t){var i=t[0],l=t[1],f=e.properties()[i.value],m=l.value;return typeof f==typeof m&&f>=m}],"filter-id->=":[Ge,[rt],function(e,t){var i=t[0],l=e.id(),f=i.value;return typeof l==typeof f&&l>=f}],"filter-has":[Ge,[rt],function(e,t){return t[0].value in e.properties()}],"filter-has-id":[Ge,[],function(e){return e.id()!==null&&e.id()!==void 0}],"filter-type-in":[Ge,[lr(et)],function(e,t){return t[0].value.indexOf(e.geometryType())>=0}],"filter-id-in":[Ge,[lr(rt)],function(e,t){return t[0].value.indexOf(e.id())>=0}],"filter-in-small":[Ge,[et,lr(rt)],function(e,t){var i=t[0];return t[1].value.indexOf(e.properties()[i.value])>=0}],"filter-in-large":[Ge,[et,lr(rt)],function(e,t){var i=t[0],l=t[1];return function(f,m,x,k){for(;x<=k;){var I=x+k>>1;if(m[I]===f)return!0;m[I]>f?k=I-1:x=I+1}return!1}(e.properties()[i.value],l.value,0,l.value.length-1)}],all:{type:Ge,overloads:[[[Ge,Ge],function(e,t){var i=t[1];return t[0].evaluate(e)&&i.evaluate(e)}],[vo(Ge),function(e,t){for(var i=0,l=t;i<l.length;i+=1)if(!l[i].evaluate(e))return!1;return!0}]]},any:{type:Ge,overloads:[[[Ge,Ge],function(e,t){var i=t[1];return t[0].evaluate(e)||i.evaluate(e)}],[vo(Ge),function(e,t){for(var i=0,l=t;i<l.length;i+=1)if(l[i].evaluate(e))return!0;return!1}]]},"!":[Ge,[Ge],function(e,t){return!t[0].evaluate(e)}],"is-supported-script":[Ge,[et],function(e,t){var i=e.globals&&e.globals.isSupportedScript;return!i||i(t[0].evaluate(e))}],upcase:[et,[et],function(e,t){return t[0].evaluate(e).toUpperCase()}],downcase:[et,[et],function(e,t){return t[0].evaluate(e).toLowerCase()}],concat:[et,vo(rt),function(e,t){return t.map(function(i){return va(i.evaluate(e))}).join("")}],"resolved-locale":[et,[Qt],function(e,t){return t[0].evaluate(e).resolvedLocale()}]});var Uo=function(e,t){this.expression=e,this._warningHistory={},this._evaluator=new qi,this._defaultValue=t?function(i){return i.type==="color"&&qs(i.default)?new ur(0,0,0,0):i.type==="color"?ur.parse(i.default)||null:i.default===void 0?null:i.default}(t):null,this._enumValues=t&&t.type==="enum"?t.values:null};function ps(e){return Array.isArray(e)&&e.length>0&&typeof e[0]=="string"&&e[0]in _o}function Zs(e,t){var i=new Zr(_o,[],t?function(f){var m={color:Ye,string:et,number:ze,enum:et,boolean:Ge,formatted:_r,resolvedImage:Kt};return f.type==="array"?lr(m[f.value]||rt,f.length):m[f.type]}(t):void 0),l=i.parse(e,void 0,void 0,void 0,t&&t.type==="string"?{typeAnnotation:"coerce"}:void 0);return l?mc(new Uo(l,t)):bo(i.errors)}Uo.prototype.evaluateWithoutErrorHandling=function(e,t,i,l,f,m){return this._evaluator.globals=e,this._evaluator.feature=t,this._evaluator.featureState=i,this._evaluator.canonical=l,this._evaluator.availableImages=f||null,this._evaluator.formattedSection=m,this.expression.evaluate(this._evaluator)},Uo.prototype.evaluate=function(e,t,i,l,f,m){this._evaluator.globals=e,this._evaluator.feature=t||null,this._evaluator.featureState=i||null,this._evaluator.canonical=l,this._evaluator.availableImages=f||null,this._evaluator.formattedSection=m||null;try{var x=this.expression.evaluate(this._evaluator);if(x==null||typeof x=="number"&&x!=x)return this._defaultValue;if(this._enumValues&&!(x in this._enumValues))throw new ii("Expected value to be one of "+Object.keys(this._enumValues).map(function(k){return JSON.stringify(k)}).join(", ")+", but found "+JSON.stringify(x)+" instead.");return x}catch(k){return this._warningHistory[k.message]||(this._warningHistory[k.message]=!0,typeof console<"u"&&console.warn(k.message)),this._defaultValue}};var fs=function(e,t){this.kind=e,this._styleExpression=t,this.isStateDependent=e!=="constant"&&!ge(t.expression)};fs.prototype.evaluateWithoutErrorHandling=function(e,t,i,l,f,m){return this._styleExpression.evaluateWithoutErrorHandling(e,t,i,l,f,m)},fs.prototype.evaluate=function(e,t,i,l,f,m){return this._styleExpression.evaluate(e,t,i,l,f,m)};var Vo=function(e,t,i,l){this.kind=e,this.zoomStops=i,this._styleExpression=t,this.isStateDependent=e!=="camera"&&!ge(t.expression),this.interpolationType=l};function vc(e,t){if((e=Zs(e,t)).result==="error")return e;var i=e.value.expression,l=wa(i);if(!l&&!xo(t))return bo([new De("","data expressions not supported")]);var f=un(i,["zoom"]);if(!f&&!yc(t))return bo([new De("","zoom expressions not supported")]);var m=function x(k){var I=null;if(k instanceof Za)I=x(k.result);else if(k instanceof ja)for(var A=0,M=k.args;A<M.length&&!(I=x(M[A]));A+=1);else(k instanceof Fn||k instanceof Qi)&&k.input instanceof zi&&k.input.name==="zoom"&&(I=k);return I instanceof De||k.eachChild(function(B){var U=x(B);U instanceof De?I=U:!I&&U?I=new De("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.'):I&&U&&I!==U&&(I=new De("",'Only one zoom-based "step" or "interpolate" subexpression may be used in an expression.'))}),I}(i);return m||f?m instanceof De?bo([m]):m instanceof Qi&&!hs(t)?bo([new De("",'"interpolate" expressions cannot be used with this property')]):mc(m?new Vo(l?"camera":"composite",e.value,m.labels,m instanceof Qi?m.interpolation:void 0):new fs(l?"constant":"source",e.value)):bo([new De("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.')])}Vo.prototype.evaluateWithoutErrorHandling=function(e,t,i,l,f,m){return this._styleExpression.evaluateWithoutErrorHandling(e,t,i,l,f,m)},Vo.prototype.evaluate=function(e,t,i,l,f,m){return this._styleExpression.evaluate(e,t,i,l,f,m)},Vo.prototype.interpolationFactor=function(e,t,i){return this.interpolationType?Qi.interpolationFactor(this.interpolationType,e,t,i):0};var qo=function(e,t){this._parameters=e,this._specification=t,Me(this,function i(l,f){var m,x,k,I=f.type==="color",A=l.stops&&typeof l.stops[0][0]=="object",M=A||!(A||l.property!==void 0),B=l.type||(hs(f)?"exponential":"interval");if(I&&((l=Me({},l)).stops&&(l.stops=l.stops.map(function(ot){return[ot[0],ur.parse(ot[1])]})),l.default=ur.parse(l.default?l.default:f.default)),l.colorSpace&&l.colorSpace!=="rgb"&&!oc[l.colorSpace])throw new Error("Unknown color space: "+l.colorSpace);if(B==="exponential")m=_c;else if(B==="interval")m=Gh;else if(B==="categorical"){m=gc,x=Object.create(null);for(var U=0,j=l.stops;U<j.length;U+=1){var J=j[U];x[J[0]]=J[1]}k=typeof l.stops[0][0]}else{if(B!=="identity")throw new Error('Unknown function type "'+B+'"');m=js}if(A){for(var $={},ce=[],ie=0;ie<l.stops.length;ie++){var ye=l.stops[ie],be=ye[0].zoom;$[be]===void 0&&($[be]={zoom:be,type:l.type,property:l.property,default:l.default,stops:[]},ce.push(be)),$[be].stops.push([ye[0].value,ye[1]])}for(var we=[],ke=0,Ce=ce;ke<Ce.length;ke+=1){var Ve=Ce[ke];we.push([$[Ve].zoom,i($[Ve],f)])}var Je={name:"linear"};return{kind:"composite",interpolationType:Je,interpolationFactor:Qi.interpolationFactor.bind(void 0,Je),zoomStops:we.map(function(ot){return ot[0]}),evaluate:function(ot,zt){var lt=ot.zoom;return _c({stops:we,base:l.base},f,lt).evaluate(lt,zt)}}}if(M){var wt=B==="exponential"?{name:"exponential",base:l.base!==void 0?l.base:1}:null;return{kind:"camera",interpolationType:wt,interpolationFactor:Qi.interpolationFactor.bind(void 0,wt),zoomStops:l.stops.map(function(ot){return ot[0]}),evaluate:function(ot){return m(l,f,ot.zoom,x,k)}}}return{kind:"source",evaluate:function(ot,zt){var lt=zt&&zt.properties?zt.properties[l.property]:void 0;return lt===void 0?No(l.default,f.default):m(l,f,lt,x,k)}}}(this._parameters,this._specification))};function pa(e){var t=e.key,i=e.value,l=e.valueSpec||{},f=e.objectElementValidators||{},m=e.style,x=e.styleSpec,k=[],I=Fr(i);if(I!=="object")return[new Q(t,i,"object expected, "+I+" found")];for(var A in i){var M=A.split(".")[0],B=l[M]||l["*"],U=void 0;if(f[M])U=f[M];else if(l[M])U=cr;else if(f["*"])U=f["*"];else{if(!l["*"]){k.push(new Q(t,i[A],'unknown property "'+A+'"'));continue}U=cr}k=k.concat(U({key:(t&&t+".")+A,value:i[A],valueSpec:B,style:m,styleSpec:x,object:i,objectKey:A},i))}for(var j in l)f[j]||l[j].required&&l[j].default===void 0&&i[j]===void 0&&k.push(new Q(t,i,'missing required property "'+j+'"'));return k}function bc(e){var t=e.value,i=e.valueSpec,l=e.style,f=e.styleSpec,m=e.key,x=e.arrayElementValidator||cr;if(Fr(t)!=="array")return[new Q(m,t,"array expected, "+Fr(t)+" found")];if(i.length&&t.length!==i.length)return[new Q(m,t,"array length "+i.length+" expected, length "+t.length+" found")];if(i["min-length"]&&t.length<i["min-length"])return[new Q(m,t,"array length at least "+i["min-length"]+" expected, length "+t.length+" found")];var k={type:i.value,values:i.values};f.$version<7&&(k.function=i.function),Fr(i.value)==="object"&&(k=i.value);for(var I=[],A=0;A<t.length;A++)I=I.concat(x({array:t,arrayIndex:A,value:t[A],valueSpec:k,style:l,styleSpec:f,key:m+"["+A+"]"}));return I}function xc(e){var t=e.key,i=e.value,l=e.valueSpec,f=Fr(i);return f==="number"&&i!=i&&(f="NaN"),f!=="number"?[new Q(t,i,"number expected, "+f+" found")]:"minimum"in l&&i<l.minimum?[new Q(t,i,i+" is less than the minimum value "+l.minimum)]:"maximum"in l&&i>l.maximum?[new Q(t,i,i+" is greater than the maximum value "+l.maximum)]:[]}function wc(e){var t,i,l,f=e.valueSpec,m=Be(e.value.type),x={},k=m!=="categorical"&&e.value.property===void 0,I=!k,A=Fr(e.value.stops)==="array"&&Fr(e.value.stops[0])==="array"&&Fr(e.value.stops[0][0])==="object",M=pa({key:e.key,value:e.value,valueSpec:e.styleSpec.function,style:e.style,styleSpec:e.styleSpec,objectElementValidators:{stops:function(j){if(m==="identity")return[new Q(j.key,j.value,'identity function may not have a "stops" property')];var J=[],$=j.value;return J=J.concat(bc({key:j.key,value:$,valueSpec:j.valueSpec,style:j.style,styleSpec:j.styleSpec,arrayElementValidator:B})),Fr($)==="array"&&$.length===0&&J.push(new Q(j.key,$,"array must have at least one stop")),J},default:function(j){return cr({key:j.key,value:j.value,valueSpec:f,style:j.style,styleSpec:j.styleSpec})}}});return m==="identity"&&k&&M.push(new Q(e.key,e.value,'missing required property "property"')),m==="identity"||e.value.stops||M.push(new Q(e.key,e.value,'missing required property "stops"')),m==="exponential"&&e.valueSpec.expression&&!hs(e.valueSpec)&&M.push(new Q(e.key,e.value,"exponential functions not supported")),e.styleSpec.$version>=8&&(I&&!xo(e.valueSpec)?M.push(new Q(e.key,e.value,"property functions not supported")):k&&!yc(e.valueSpec)&&M.push(new Q(e.key,e.value,"zoom functions not supported"))),m!=="categorical"&&!A||e.value.property!==void 0||M.push(new Q(e.key,e.value,'"property" property is required')),M;function B(j){var J=[],$=j.value,ce=j.key;if(Fr($)!=="array")return[new Q(ce,$,"array expected, "+Fr($)+" found")];if($.length!==2)return[new Q(ce,$,"array length 2 expected, length "+$.length+" found")];if(A){if(Fr($[0])!=="object")return[new Q(ce,$,"object expected, "+Fr($[0])+" found")];if($[0].zoom===void 0)return[new Q(ce,$,"object stop key must have zoom")];if($[0].value===void 0)return[new Q(ce,$,"object stop key must have value")];if(l&&l>Be($[0].zoom))return[new Q(ce,$[0].zoom,"stop zoom values must appear in ascending order")];Be($[0].zoom)!==l&&(l=Be($[0].zoom),i=void 0,x={}),J=J.concat(pa({key:ce+"[0]",value:$[0],valueSpec:{zoom:{}},style:j.style,styleSpec:j.styleSpec,objectElementValidators:{zoom:xc,value:U}}))}else J=J.concat(U({key:ce+"[0]",value:$[0],valueSpec:{},style:j.style,styleSpec:j.styleSpec},$));return ps(Ee($[1]))?J.concat([new Q(ce+"[1]",$[1],"expressions are not allowed in function stops.")]):J.concat(cr({key:ce+"[1]",value:$[1],valueSpec:f,style:j.style,styleSpec:j.styleSpec}))}function U(j,J){var $=Fr(j.value),ce=Be(j.value),ie=j.value!==null?j.value:J;if(t){if($!==t)return[new Q(j.key,ie,$+" stop domain type must match previous stop domain type "+t)]}else t=$;if($!=="number"&&$!=="string"&&$!=="boolean")return[new Q(j.key,ie,"stop domain value must be a number, string, or boolean")];if($!=="number"&&m!=="categorical"){var ye="number expected, "+$+" found";return xo(f)&&m===void 0&&(ye+='\nIf you intended to use a categorical function, specify `"type": "categorical"`.'),[new Q(j.key,ie,ye)]}return m!=="categorical"||$!=="number"||isFinite(ce)&&Math.floor(ce)===ce?m!=="categorical"&&$==="number"&&i!==void 0&&ce<i?[new Q(j.key,ie,"stop domain values must appear in ascending order")]:(i=ce,m==="categorical"&&ce in x?[new Q(j.key,ie,"stop domain values must be unique")]:(x[ce]=!0,[])):[new Q(j.key,ie,"integer expected, found "+ce)]}}function wo(e){var t=(e.expressionContext==="property"?vc:Zs)(Ee(e.value),e.valueSpec);if(t.result==="error")return t.value.map(function(l){return new Q(""+e.key+l.key,e.value,l.message)});var i=t.value.expression||t.value._styleExpression.expression;if(e.expressionContext==="property"&&e.propertyKey==="text-font"&&!i.outputDefined())return[new Q(e.key,e.value,'Invalid data expression for "'+e.propertyKey+'". Output values must be contained as literals within the expression.')];if(e.expressionContext==="property"&&e.propertyType==="layout"&&!ge(i))return[new Q(e.key,e.value,'"feature-state" data expressions are not supported with layout properties.')];if(e.expressionContext==="filter"&&!ge(i))return[new Q(e.key,e.value,'"feature-state" data expressions are not supported with filters.')];if(e.expressionContext&&e.expressionContext.indexOf("cluster")===0){if(!un(i,["zoom","feature-state"]))return[new Q(e.key,e.value,'"zoom" and "feature-state" expressions are not supported with cluster properties.')];if(e.expressionContext==="cluster-initial"&&!wa(i))return[new Q(e.key,e.value,"Feature data expressions are not supported with initial expression part of cluster properties.")]}return[]}function ds(e){var t=e.key,i=e.value,l=e.valueSpec,f=[];return Array.isArray(l.values)?l.values.indexOf(Be(i))===-1&&f.push(new Q(t,i,"expected one of ["+l.values.join(", ")+"], "+JSON.stringify(i)+" found")):Object.keys(l.values).indexOf(Be(i))===-1&&f.push(new Q(t,i,"expected one of ["+Object.keys(l.values).join(", ")+"], "+JSON.stringify(i)+" found")),f}function Gs(e){if(e===!0||e===!1)return!0;if(!Array.isArray(e)||e.length===0)return!1;switch(e[0]){case"has":return e.length>=2&&e[1]!=="$id"&&e[1]!=="$type";case"in":return e.length>=3&&(typeof e[1]!="string"||Array.isArray(e[2]));case"!in":case"!has":case"none":return!1;case"==":case"!=":case">":case">=":case"<":case"<=":return e.length!==3||Array.isArray(e[1])||Array.isArray(e[2]);case"any":case"all":for(var t=0,i=e.slice(1);t<i.length;t+=1){var l=i[t];if(!Gs(l)&&typeof l!="boolean")return!1}return!0;default:return!0}}qo.deserialize=function(e){return new qo(e._parameters,e._specification)},qo.serialize=function(e){return{_parameters:e._parameters,_specification:e._specification}};var Xl={type:"boolean",default:!1,transition:!1,"property-type":"data-driven",expression:{interpolated:!1,parameters:["zoom","feature"]}};function Ks(e){if(e==null)return{filter:function(){return!0},needGeometry:!1};Gs(e)||(e=Hs(e));var t=Zs(e,Xl);if(t.result==="error")throw new Error(t.value.map(function(i){return i.key+": "+i.message}).join(", "));return{filter:function(i,l,f){return t.value.evaluate(i,l,{},f)},needGeometry:function i(l){if(!Array.isArray(l))return!1;if(l[0]==="within")return!0;for(var f=1;f<l.length;f++)if(i(l[f]))return!0;return!1}(e)}}function Kh(e,t){return e<t?-1:e>t?1:0}function Hs(e){if(!e)return!0;var t,i=e[0];return e.length<=1?i!=="any":i==="=="?Wl(e[1],e[2],"=="):i==="!="?Xs(Wl(e[1],e[2],"==")):i==="<"||i===">"||i==="<="||i===">="?Wl(e[1],e[2],i):i==="any"?(t=e.slice(1),["any"].concat(t.map(Hs))):i==="all"?["all"].concat(e.slice(1).map(Hs)):i==="none"?["all"].concat(e.slice(1).map(Hs).map(Xs)):i==="in"?Sc(e[1],e.slice(2)):i==="!in"?Xs(Sc(e[1],e.slice(2))):i==="has"?kc(e[1]):i==="!has"?Xs(kc(e[1])):i!=="within"||e}function Wl(e,t,i){switch(e){case"$type":return["filter-type-"+i,t];case"$id":return["filter-id-"+i,t];default:return["filter-"+i,e,t]}}function Sc(e,t){if(t.length===0)return!1;switch(e){case"$type":return["filter-type-in",["literal",t]];case"$id":return["filter-id-in",["literal",t]];default:return t.length>200&&!t.some(function(i){return typeof i!=typeof t[0]})?["filter-in-large",e,["literal",t.sort(Kh)]]:["filter-in-small",e,["literal",t]]}}function kc(e){switch(e){case"$type":return!0;case"$id":return["filter-has-id"];default:return["filter-has",e]}}function Xs(e){return["!",e]}function Yl(e){return Gs(Ee(e.value))?wo(Me({},e,{expressionContext:"filter",valueSpec:{value:"boolean"}})):function t(i){var l=i.value,f=i.key;if(Fr(l)!=="array")return[new Q(f,l,"array expected, "+Fr(l)+" found")];var m,x=i.styleSpec,k=[];if(l.length<1)return[new Q(f,l,"filter array must have at least 1 element")];switch(k=k.concat(ds({key:f+"[0]",value:l[0],valueSpec:x.filter_operator,style:i.style,styleSpec:i.styleSpec})),Be(l[0])){case"<":case"<=":case">":case">=":l.length>=2&&Be(l[1])==="$type"&&k.push(new Q(f,l,'"$type" cannot be use with operator "'+l[0]+'"'));case"==":case"!=":l.length!==3&&k.push(new Q(f,l,'filter array for operator "'+l[0]+'" must have 3 elements'));case"in":case"!in":l.length>=2&&(m=Fr(l[1]))!=="string"&&k.push(new Q(f+"[1]",l[1],"string expected, "+m+" found"));for(var I=2;I<l.length;I++)m=Fr(l[I]),Be(l[1])==="$type"?k=k.concat(ds({key:f+"["+I+"]",value:l[I],valueSpec:x.geometry_type,style:i.style,styleSpec:i.styleSpec})):m!=="string"&&m!=="number"&&m!=="boolean"&&k.push(new Q(f+"["+I+"]",l[I],"string, number, or boolean expected, "+m+" found"));break;case"any":case"all":case"none":for(var A=1;A<l.length;A++)k=k.concat(t({key:f+"["+A+"]",value:l[A],style:i.style,styleSpec:i.styleSpec}));break;case"has":case"!has":m=Fr(l[1]),l.length!==2?k.push(new Q(f,l,'filter array for "'+l[0]+'" operator must have 2 elements')):m!=="string"&&k.push(new Q(f+"[1]",l[1],"string expected, "+m+" found"));break;case"within":m=Fr(l[1]),l.length!==2?k.push(new Q(f,l,'filter array for "'+l[0]+'" operator must have 2 elements')):m!=="object"&&k.push(new Q(f+"[1]",l[1],"object expected, "+m+" found"))}return k}(e)}function Jl(e,t){var i=e.key,l=e.style,f=e.styleSpec,m=e.value,x=e.objectKey,k=f[t+"_"+e.layerType];if(!k)return[];var I=x.match(/^(.*)-transition$/);if(t==="paint"&&I&&k[I[1]]&&k[I[1]].transition)return cr({key:i,value:m,valueSpec:f.transition,style:l,styleSpec:f});var A,M=e.valueSpec||k[x];if(!M)return[new Q(i,m,'unknown property "'+x+'"')];if(Fr(m)==="string"&&xo(M)&&!M.tokens&&(A=/^{([^}]+)}$/.exec(m)))return[new Q(i,m,'"'+x+'" does not support interpolation syntax\nUse an identity property function instead: `{ "type": "identity", "property": '+JSON.stringify(A[1])+" }`.")];var B=[];return e.layerType==="symbol"&&(x==="text-field"&&l&&!l.glyphs&&B.push(new Q(i,m,'use of "text-field" requires a style "glyphs" property')),x==="text-font"&&qs(Ee(m))&&Be(m.type)==="identity"&&B.push(new Q(i,m,'"text-font" does not support identity functions'))),B.concat(cr({key:e.key,value:m,valueSpec:M,style:l,styleSpec:f,expressionContext:"property",propertyType:t,propertyKey:x}))}function Ql(e){return Jl(e,"paint")}function ms(e){return Jl(e,"layout")}function Ec(e){var t=[],i=e.value,l=e.key,f=e.style,m=e.styleSpec;i.type||i.ref||t.push(new Q(l,i,'either "type" or "ref" is required'));var x,k=Be(i.type),I=Be(i.ref);if(i.id)for(var A=Be(i.id),M=0;M<e.arrayIndex;M++){var B=f.layers[M];Be(B.id)===A&&t.push(new Q(l,i.id,'duplicate layer id "'+i.id+'", previously used at line '+B.id.__line__))}if("ref"in i)["type","source","source-layer","filter","layout"].forEach(function(J){J in i&&t.push(new Q(l,i[J],'"'+J+'" is prohibited for ref layers'))}),f.layers.forEach(function(J){Be(J.id)===I&&(x=J)}),x?x.ref?t.push(new Q(l,i.ref,"ref cannot reference another ref layer")):k=Be(x.type):t.push(new Q(l,i.ref,'ref layer "'+I+'" not found'));else if(k!=="background")if(i.source){var U=f.sources&&f.sources[i.source],j=U&&Be(U.type);U?j==="vector"&&k==="raster"?t.push(new Q(l,i.source,'layer "'+i.id+'" requires a raster source')):j==="raster"&&k!=="raster"?t.push(new Q(l,i.source,'layer "'+i.id+'" requires a vector source')):j!=="vector"||i["source-layer"]?j==="raster-dem"&&k!=="hillshade"?t.push(new Q(l,i.source,"raster-dem source can only be used with layer type 'hillshade'.")):k!=="line"||!i.paint||!i.paint["line-gradient"]||j==="geojson"&&U.lineMetrics||t.push(new Q(l,i,'layer "'+i.id+'" specifies a line-gradient, which requires a GeoJSON source with `lineMetrics` enabled.')):t.push(new Q(l,i,'layer "'+i.id+'" must specify a "source-layer"')):t.push(new Q(l,i.source,'source "'+i.source+'" not found'))}else t.push(new Q(l,i,'missing required property "source"'));return t=t.concat(pa({key:l,value:i,valueSpec:m.layer,style:e.style,styleSpec:e.styleSpec,objectElementValidators:{"*":function(){return[]},type:function(){return cr({key:l+".type",value:i.type,valueSpec:m.layer.type,style:e.style,styleSpec:e.styleSpec,object:i,objectKey:"type"})},filter:Yl,layout:function(J){return pa({layer:i,key:J.key,value:J.value,style:J.style,styleSpec:J.styleSpec,objectElementValidators:{"*":function($){return ms(Me({layerType:k},$))}}})},paint:function(J){return pa({layer:i,key:J.key,value:J.value,style:J.style,styleSpec:J.styleSpec,objectElementValidators:{"*":function($){return Ql(Me({layerType:k},$))}}})}}}))}function So(e){var t=e.value,i=e.key,l=Fr(t);return l!=="string"?[new Q(i,t,"string expected, "+l+" found")]:[]}var Kr={promoteId:function(e){var t=e.key,i=e.value;if(Fr(i)==="string")return So({key:t,value:i});var l=[];for(var f in i)l.push.apply(l,So({key:t+"."+f,value:i[f]}));return l}};function Ws(e){var t=e.value,i=e.key,l=e.styleSpec,f=e.style;if(!t.type)return[new Q(i,t,'"type" is required')];var m,x=Be(t.type);switch(x){case"vector":case"raster":case"raster-dem":return pa({key:i,value:t,valueSpec:l["source_"+x.replace("-","_")],style:e.style,styleSpec:l,objectElementValidators:Kr});case"geojson":if(m=pa({key:i,value:t,valueSpec:l.source_geojson,style:f,styleSpec:l,objectElementValidators:Kr}),t.cluster)for(var k in t.clusterProperties){var I=t.clusterProperties[k],A=I[0],M=typeof A=="string"?[A,["accumulated"],["get",k]]:A;m.push.apply(m,wo({key:i+"."+k+".map",value:I[1],expressionContext:"cluster-map"})),m.push.apply(m,wo({key:i+"."+k+".reduce",value:M,expressionContext:"cluster-reduce"}))}return m;case"video":return pa({key:i,value:t,valueSpec:l.source_video,style:f,styleSpec:l});case"image":return pa({key:i,value:t,valueSpec:l.source_image,style:f,styleSpec:l});case"canvas":return[new Q(i,null,"Please use runtime APIs to add canvas sources, rather than including them in stylesheets.","source.canvas")];default:return ds({key:i+".type",value:t.type,valueSpec:{values:["vector","raster","raster-dem","geojson","video","image"]},style:f,styleSpec:l})}}function ko(e){var t=e.value,i=e.styleSpec,l=i.light,f=e.style,m=[],x=Fr(t);if(t===void 0)return m;if(x!=="object")return m.concat([new Q("light",t,"object expected, "+x+" found")]);for(var k in t){var I=k.match(/^(.*)-transition$/);m=m.concat(I&&l[I[1]]&&l[I[1]].transition?cr({key:k,value:t[k],valueSpec:i.transition,style:f,styleSpec:i}):l[k]?cr({key:k,value:t[k],valueSpec:l[k],style:f,styleSpec:i}):[new Q(k,t[k],'unknown property "'+k+'"')])}return m}var Xa={"*":function(){return[]},array:bc,boolean:function(e){var t=e.value,i=e.key,l=Fr(t);return l!=="boolean"?[new Q(i,t,"boolean expected, "+l+" found")]:[]},number:xc,color:function(e){var t=e.key,i=e.value,l=Fr(i);return l!=="string"?[new Q(t,i,"color expected, "+l+" found")]:Wt(i)===null?[new Q(t,i,'color expected, "'+i+'" found')]:[]},constants:me,enum:ds,filter:Yl,function:wc,layer:Ec,object:pa,source:Ws,light:ko,string:So,formatted:function(e){return So(e).length===0?[]:wo(e)},resolvedImage:function(e){return So(e).length===0?[]:wo(e)}};function cr(e){var t=e.value,i=e.valueSpec,l=e.styleSpec;return i.expression&&qs(Be(t))?wc(e):i.expression&&ps(Ee(t))?wo(e):i.type&&Xa[i.type]?Xa[i.type](e):pa(Me({},e,{valueSpec:i.type?l[i.type]:i}))}function Nr(e){var t=e.value,i=e.key,l=So(e);return l.length||(t.indexOf("{fontstack}")===-1&&l.push(new Q(i,t,'"glyphs" url must include a "{fontstack}" token')),t.indexOf("{range}")===-1&&l.push(new Q(i,t,'"glyphs" url must include a "{range}" token'))),l}function Qn(e,t){t===void 0&&(t=q);var i=[];return i=i.concat(cr({key:"",value:e,valueSpec:t.$root,styleSpec:t,style:e,objectElementValidators:{glyphs:Nr,"*":function(){return[]}}})),e.constants&&(i=i.concat(me({key:"constants",value:e.constants,style:e,styleSpec:t}))),ys(i)}function ys(e){return[].concat(e).sort(function(t,i){return t.line-i.line})}function jo(e){return function(){for(var t=[],i=arguments.length;i--;)t[i]=arguments[i];return ys(e.apply(this,t))}}Qn.source=jo(Ws),Qn.light=jo(ko),Qn.layer=jo(Ec),Qn.filter=jo(Yl),Qn.paintProperty=jo(Ql),Qn.layoutProperty=jo(ms);var gs=Qn,Hh=gs.light,Xh=gs.paintProperty,_s=gs.layoutProperty;function vs(e,t){var i=!1;if(t&&t.length)for(var l=0,f=t;l<f.length;l+=1)e.fire(new ue(new Error(f[l].message))),i=!0;return i}var Ca=Ti;function Ti(e,t,i){var l=this.cells=[];if(e instanceof ArrayBuffer){this.arrayBuffer=e;var f=new Int32Array(this.arrayBuffer);e=f[0],this.d=(t=f[1])+2*(i=f[2]);for(var m=0;m<this.d*this.d;m++){var x=f[3+m],k=f[3+m+1];l.push(x===k?null:f.subarray(x,k))}var I=f[3+l.length+1];this.keys=f.subarray(f[3+l.length],I),this.bboxes=f.subarray(I),this.insert=this._insertReadonly}else{this.d=t+2*i;for(var A=0;A<this.d*this.d;A++)l.push([]);this.keys=[],this.bboxes=[]}this.n=t,this.extent=e,this.padding=i,this.scale=t/e,this.uid=0;var M=i/t*e;this.min=-M,this.max=e+M}Ti.prototype.insert=function(e,t,i,l,f){this._forEachCell(t,i,l,f,this._insertCell,this.uid++),this.keys.push(e),this.bboxes.push(t),this.bboxes.push(i),this.bboxes.push(l),this.bboxes.push(f)},Ti.prototype._insertReadonly=function(){throw"Cannot insert into a GridIndex created from an ArrayBuffer."},Ti.prototype._insertCell=function(e,t,i,l,f,m){this.cells[f].push(m)},Ti.prototype.query=function(e,t,i,l,f){var m=this.min,x=this.max;if(e<=m&&t<=m&&x<=i&&x<=l&&!f)return Array.prototype.slice.call(this.keys);var k=[];return this._forEachCell(e,t,i,l,this._queryCell,k,{},f),k},Ti.prototype._queryCell=function(e,t,i,l,f,m,x,k){var I=this.cells[f];if(I!==null)for(var A=this.keys,M=this.bboxes,B=0;B<I.length;B++){var U=I[B];if(x[U]===void 0){var j=4*U;(k?k(M[j+0],M[j+1],M[j+2],M[j+3]):e<=M[j+2]&&t<=M[j+3]&&i>=M[j+0]&&l>=M[j+1])?(x[U]=!0,m.push(A[U])):x[U]=!1}}},Ti.prototype._forEachCell=function(e,t,i,l,f,m,x,k){for(var I=this._convertToCellCoord(e),A=this._convertToCellCoord(t),M=this._convertToCellCoord(i),B=this._convertToCellCoord(l),U=I;U<=M;U++)for(var j=A;j<=B;j++){var J=this.d*j+U;if((!k||k(this._convertFromCellCoord(U),this._convertFromCellCoord(j),this._convertFromCellCoord(U+1),this._convertFromCellCoord(j+1)))&&f.call(this,e,t,i,l,J,m,x,k))return}},Ti.prototype._convertFromCellCoord=function(e){return(e-this.padding)/this.scale},Ti.prototype._convertToCellCoord=function(e){return Math.max(0,Math.min(this.d-1,Math.floor(e*this.scale)+this.padding))},Ti.prototype.toArrayBuffer=function(){if(this.arrayBuffer)return this.arrayBuffer;for(var e=this.cells,t=3+this.cells.length+1+1,i=0,l=0;l<this.cells.length;l++)i+=this.cells[l].length;var f=new Int32Array(t+i+this.keys.length+this.bboxes.length);f[0]=this.extent,f[1]=this.n,f[2]=this.padding;for(var m=t,x=0;x<e.length;x++){var k=e[x];f[3+x]=m,f.set(k,m),m+=k.length}return f[3+e.length]=m,f.set(this.keys,m),f[3+e.length+1]=m+=this.keys.length,f.set(this.bboxes,m),m+=this.bboxes.length,f.buffer};var bs=R.ImageData,zc=R.ImageBitmap,bi={};function ft(e,t,i){i===void 0&&(i={}),Object.defineProperty(t,"_classRegistryKey",{value:e,writeable:!1}),bi[e]={klass:t,omit:i.omit||[],shallow:i.shallow||[]}}for(var Nn in ft("Object",Object),Ca.serialize=function(e,t){var i=e.toArrayBuffer();return t&&t.push(i),{buffer:i}},Ca.deserialize=function(e){return new Ca(e.buffer)},ft("Grid",Ca),ft("Color",ur),ft("Error",Error),ft("ResolvedImage",Ri),ft("StylePropertyFunction",qo),ft("StyleExpression",Uo,{omit:["_evaluator"]}),ft("ZoomDependentExpression",Vo),ft("ZoomConstantExpression",fs),ft("CompoundExpression",zi,{omit:["_evaluate"]}),_o)_o[Nn]._classRegistryKey||ft("Expression_"+Nn,_o[Nn]);function Ys(e){return e&&typeof ArrayBuffer<"u"&&(e instanceof ArrayBuffer||e.constructor&&e.constructor.name==="ArrayBuffer")}function Zo(e){return zc&&e instanceof zc}function fa(e,t){if(e==null||typeof e=="boolean"||typeof e=="number"||typeof e=="string"||e instanceof Boolean||e instanceof Number||e instanceof String||e instanceof Date||e instanceof RegExp)return e;if(Ys(e)||Zo(e))return t&&t.push(e),e;if(ArrayBuffer.isView(e)){var i=e;return t&&t.push(i.buffer),i}if(e instanceof bs)return t&&t.push(e.data.buffer),e;if(Array.isArray(e)){for(var l=[],f=0,m=e;f<m.length;f+=1)l.push(fa(m[f],t));return l}if(typeof e=="object"){var x=e.constructor,k=x._classRegistryKey;if(!k)throw new Error("can't serialize object of unregistered class");var I=x.serialize?x.serialize(e,t):{};if(!x.serialize){for(var A in e)if(e.hasOwnProperty(A)&&!(bi[k].omit.indexOf(A)>=0)){var M=e[A];I[A]=bi[k].shallow.indexOf(A)>=0?M:fa(M,t)}e instanceof Error&&(I.message=e.message)}if(I.$name)throw new Error("$name property is reserved for worker serialization logic.");return k!=="Object"&&(I.$name=k),I}throw new Error("can't serialize object of type "+typeof e)}function Un(e){if(e==null||typeof e=="boolean"||typeof e=="number"||typeof e=="string"||e instanceof Boolean||e instanceof Number||e instanceof String||e instanceof Date||e instanceof RegExp||Ys(e)||Zo(e)||ArrayBuffer.isView(e)||e instanceof bs)return e;if(Array.isArray(e))return e.map(Un);if(typeof e=="object"){var t=e.$name||"Object",i=bi[t].klass;if(!i)throw new Error("can't deserialize unregistered class "+t);if(i.deserialize)return i.deserialize(e);for(var l=Object.create(i.prototype),f=0,m=Object.keys(e);f<m.length;f+=1){var x=m[f];if(x!=="$name"){var k=e[x];l[x]=bi[t].shallow.indexOf(x)>=0?k:Un(k)}}return l}throw new Error("can't deserialize object of type "+typeof e)}var $l=function(){this.first=!0};$l.prototype.update=function(e,t){var i=Math.floor(e);return this.first?(this.first=!1,this.lastIntegerZoom=i,this.lastIntegerZoomTime=0,this.lastZoom=e,this.lastFloorZoom=i,!0):(this.lastFloorZoom>i?(this.lastIntegerZoom=i+1,this.lastIntegerZoomTime=t):this.lastFloorZoom<i&&(this.lastIntegerZoom=i,this.lastIntegerZoomTime=t),e!==this.lastZoom&&(this.lastZoom=e,this.lastFloorZoom=i,!0))};var tt={"Latin-1 Supplement":function(e){return e>=128&&e<=255},Arabic:function(e){return e>=1536&&e<=1791},"Arabic Supplement":function(e){return e>=1872&&e<=1919},"Arabic Extended-A":function(e){return e>=2208&&e<=2303},"Hangul Jamo":function(e){return e>=4352&&e<=4607},"Unified Canadian Aboriginal Syllabics":function(e){return e>=5120&&e<=5759},Khmer:function(e){return e>=6016&&e<=6143},"Unified Canadian Aboriginal Syllabics Extended":function(e){return e>=6320&&e<=6399},"General Punctuation":function(e){return e>=8192&&e<=8303},"Letterlike Symbols":function(e){return e>=8448&&e<=8527},"Number Forms":function(e){return e>=8528&&e<=8591},"Miscellaneous Technical":function(e){return e>=8960&&e<=9215},"Control Pictures":function(e){return e>=9216&&e<=9279},"Optical Character Recognition":function(e){return e>=9280&&e<=9311},"Enclosed Alphanumerics":function(e){return e>=9312&&e<=9471},"Geometric Shapes":function(e){return e>=9632&&e<=9727},"Miscellaneous Symbols":function(e){return e>=9728&&e<=9983},"Miscellaneous Symbols and Arrows":function(e){return e>=11008&&e<=11263},"CJK Radicals Supplement":function(e){return e>=11904&&e<=12031},"Kangxi Radicals":function(e){return e>=12032&&e<=12255},"Ideographic Description Characters":function(e){return e>=12272&&e<=12287},"CJK Symbols and Punctuation":function(e){return e>=12288&&e<=12351},Hiragana:function(e){return e>=12352&&e<=12447},Katakana:function(e){return e>=12448&&e<=12543},Bopomofo:function(e){return e>=12544&&e<=12591},"Hangul Compatibility Jamo":function(e){return e>=12592&&e<=12687},Kanbun:function(e){return e>=12688&&e<=12703},"Bopomofo Extended":function(e){return e>=12704&&e<=12735},"CJK Strokes":function(e){return e>=12736&&e<=12783},"Katakana Phonetic Extensions":function(e){return e>=12784&&e<=12799},"Enclosed CJK Letters and Months":function(e){return e>=12800&&e<=13055},"CJK Compatibility":function(e){return e>=13056&&e<=13311},"CJK Unified Ideographs Extension A":function(e){return e>=13312&&e<=19903},"Yijing Hexagram Symbols":function(e){return e>=19904&&e<=19967},"CJK Unified Ideographs":function(e){return e>=19968&&e<=40959},"Yi Syllables":function(e){return e>=40960&&e<=42127},"Yi Radicals":function(e){return e>=42128&&e<=42191},"Hangul Jamo Extended-A":function(e){return e>=43360&&e<=43391},"Hangul Syllables":function(e){return e>=44032&&e<=55215},"Hangul Jamo Extended-B":function(e){return e>=55216&&e<=55295},"Private Use Area":function(e){return e>=57344&&e<=63743},"CJK Compatibility Ideographs":function(e){return e>=63744&&e<=64255},"Arabic Presentation Forms-A":function(e){return e>=64336&&e<=65023},"Vertical Forms":function(e){return e>=65040&&e<=65055},"CJK Compatibility Forms":function(e){return e>=65072&&e<=65103},"Small Form Variants":function(e){return e>=65104&&e<=65135},"Arabic Presentation Forms-B":function(e){return e>=65136&&e<=65279},"Halfwidth and Fullwidth Forms":function(e){return e>=65280&&e<=65519}};function eu(e){for(var t=0,i=e;t<i.length;t+=1)if(Js(i[t].charCodeAt(0)))return!0;return!1}function Js(e){return!(e!==746&&e!==747&&(e<4352||!(tt["Bopomofo Extended"](e)||tt.Bopomofo(e)||tt["CJK Compatibility Forms"](e)&&!(e>=65097&&e<=65103)||tt["CJK Compatibility Ideographs"](e)||tt["CJK Compatibility"](e)||tt["CJK Radicals Supplement"](e)||tt["CJK Strokes"](e)||!(!tt["CJK Symbols and Punctuation"](e)||e>=12296&&e<=12305||e>=12308&&e<=12319||e===12336)||tt["CJK Unified Ideographs Extension A"](e)||tt["CJK Unified Ideographs"](e)||tt["Enclosed CJK Letters and Months"](e)||tt["Hangul Compatibility Jamo"](e)||tt["Hangul Jamo Extended-A"](e)||tt["Hangul Jamo Extended-B"](e)||tt["Hangul Jamo"](e)||tt["Hangul Syllables"](e)||tt.Hiragana(e)||tt["Ideographic Description Characters"](e)||tt.Kanbun(e)||tt["Kangxi Radicals"](e)||tt["Katakana Phonetic Extensions"](e)||tt.Katakana(e)&&e!==12540||!(!tt["Halfwidth and Fullwidth Forms"](e)||e===65288||e===65289||e===65293||e>=65306&&e<=65310||e===65339||e===65341||e===65343||e>=65371&&e<=65503||e===65507||e>=65512&&e<=65519)||!(!tt["Small Form Variants"](e)||e>=65112&&e<=65118||e>=65123&&e<=65126)||tt["Unified Canadian Aboriginal Syllabics"](e)||tt["Unified Canadian Aboriginal Syllabics Extended"](e)||tt["Vertical Forms"](e)||tt["Yijing Hexagram Symbols"](e)||tt["Yi Syllables"](e)||tt["Yi Radicals"](e))))}function tu(e){return!(Js(e)||function(t){return!!(tt["Latin-1 Supplement"](t)&&(t===167||t===169||t===174||t===177||t===188||t===189||t===190||t===215||t===247)||tt["General Punctuation"](t)&&(t===8214||t===8224||t===8225||t===8240||t===8241||t===8251||t===8252||t===8258||t===8263||t===8264||t===8265||t===8273)||tt["Letterlike Symbols"](t)||tt["Number Forms"](t)||tt["Miscellaneous Technical"](t)&&(t>=8960&&t<=8967||t>=8972&&t<=8991||t>=8996&&t<=9e3||t===9003||t>=9085&&t<=9114||t>=9150&&t<=9165||t===9167||t>=9169&&t<=9179||t>=9186&&t<=9215)||tt["Control Pictures"](t)&&t!==9251||tt["Optical Character Recognition"](t)||tt["Enclosed Alphanumerics"](t)||tt["Geometric Shapes"](t)||tt["Miscellaneous Symbols"](t)&&!(t>=9754&&t<=9759)||tt["Miscellaneous Symbols and Arrows"](t)&&(t>=11026&&t<=11055||t>=11088&&t<=11097||t>=11192&&t<=11243)||tt["CJK Symbols and Punctuation"](t)||tt.Katakana(t)||tt["Private Use Area"](t)||tt["CJK Compatibility Forms"](t)||tt["Small Form Variants"](t)||tt["Halfwidth and Fullwidth Forms"](t)||t===8734||t===8756||t===8757||t>=9984&&t<=10087||t>=10102&&t<=10131||t===65532||t===65533)}(e))}function ra(e){return e>=1424&&e<=2303||tt["Arabic Presentation Forms-A"](e)||tt["Arabic Presentation Forms-B"](e)}function Vn(e,t){return!(!t&&ra(e)||e>=2304&&e<=3583||e>=3840&&e<=4255||tt.Khmer(e))}function Qs(e){for(var t=0,i=e;t<i.length;t+=1)if(ra(i[t].charCodeAt(0)))return!0;return!1}var $s=null,qn="unavailable",Ma=null,Tc=function(e){e&&typeof e=="string"&&e.indexOf("NetworkError")>-1&&(qn="error"),$s&&$s(e)};function xs(){ru.fire(new W("pluginStateChange",{pluginStatus:qn,pluginURL:Ma}))}var ru=new he,iu=function(){return qn},da=function(){if(qn!=="deferred"||!Ma)throw new Error("rtl-text-plugin cannot be downloaded unless a pluginURL is specified");qn="loading",xs(),Ma&&ti({url:Ma},function(e){e?Tc(e):(qn="loaded",xs())})},$n={applyArabicShaping:null,processBidirectionalText:null,processStyledBidirectionalText:null,isLoaded:function(){return qn==="loaded"||$n.applyArabicShaping!=null},isLoading:function(){return qn==="loading"},setState:function(e){qn=e.pluginStatus,Ma=e.pluginURL},isParsed:function(){return $n.applyArabicShaping!=null&&$n.processBidirectionalText!=null&&$n.processStyledBidirectionalText!=null},getPluginURL:function(){return Ma}},ar=function(e,t){this.zoom=e,t?(this.now=t.now,this.fadeDuration=t.fadeDuration,this.zoomHistory=t.zoomHistory,this.transition=t.transition):(this.now=0,this.fadeDuration=0,this.zoomHistory=new $l,this.transition={})};ar.prototype.isSupportedScript=function(e){return function(t,i){for(var l=0,f=t;l<f.length;l+=1)if(!Vn(f[l].charCodeAt(0),i))return!1;return!0}(e,$n.isLoaded())},ar.prototype.crossFadingFactor=function(){return this.fadeDuration===0?1:Math.min((this.now-this.zoomHistory.lastIntegerZoomTime)/this.fadeDuration,1)},ar.prototype.getCrossfadeParameters=function(){var e=this.zoom,t=e-Math.floor(e),i=this.crossFadingFactor();return e>this.zoomHistory.lastIntegerZoom?{fromScale:2,toScale:1,t:t+(1-t)*i}:{fromScale:.5,toScale:1,t:1-(1-i)*t}};var ka=function(e,t){this.property=e,this.value=t,this.expression=function(i,l){if(qs(i))return new qo(i,l);if(ps(i)){var f=vc(i,l);if(f.result==="error")throw new Error(f.value.map(function(x){return x.key+": "+x.message}).join(", "));return f.value}var m=i;return typeof i=="string"&&l.type==="color"&&(m=ur.parse(i)),{kind:"constant",evaluate:function(){return m}}}(t===void 0?e.specification.default:t,e.specification)};ka.prototype.isDataDriven=function(){return this.expression.kind==="source"||this.expression.kind==="composite"},ka.prototype.possiblyEvaluate=function(e,t,i){return this.property.possiblyEvaluate(this,e,t,i)};var ia=function(e){this.property=e,this.value=new ka(e,void 0)};ia.prototype.transitioned=function(e,t){return new Eo(this.property,this.value,t,xe({},e.transition,this.transition),e.now)},ia.prototype.untransitioned=function(){return new Eo(this.property,this.value,null,{},0)};var $i=function(e){this._properties=e,this._values=Object.create(e.defaultTransitionablePropertyValues)};$i.prototype.getValue=function(e){return at(this._values[e].value.value)},$i.prototype.setValue=function(e,t){this._values.hasOwnProperty(e)||(this._values[e]=new ia(this._values[e].property)),this._values[e].value=new ka(this._values[e].property,t===null?void 0:at(t))},$i.prototype.getTransition=function(e){return at(this._values[e].transition)},$i.prototype.setTransition=function(e,t){this._values.hasOwnProperty(e)||(this._values[e]=new ia(this._values[e].property)),this._values[e].transition=at(t)||void 0},$i.prototype.serialize=function(){for(var e={},t=0,i=Object.keys(this._values);t<i.length;t+=1){var l=i[t],f=this.getValue(l);f!==void 0&&(e[l]=f);var m=this.getTransition(l);m!==void 0&&(e[l+"-transition"]=m)}return e},$i.prototype.transitioned=function(e,t){for(var i=new Wa(this._properties),l=0,f=Object.keys(this._values);l<f.length;l+=1){var m=f[l];i._values[m]=this._values[m].transitioned(e,t._values[m])}return i},$i.prototype.untransitioned=function(){for(var e=new Wa(this._properties),t=0,i=Object.keys(this._values);t<i.length;t+=1){var l=i[t];e._values[l]=this._values[l].untransitioned()}return e};var Eo=function(e,t,i,l,f){this.property=e,this.value=t,this.begin=f+l.delay||0,this.end=this.begin+l.duration||0,e.specification.transition&&(l.delay||l.duration)&&(this.prior=i)};Eo.prototype.possiblyEvaluate=function(e,t,i){var l=e.now||0,f=this.value.possiblyEvaluate(e,t,i),m=this.prior;if(m){if(l>this.end)return this.prior=null,f;if(this.value.isDataDriven())return this.prior=null,f;if(l<this.begin)return m.possiblyEvaluate(e,t,i);var x=(l-this.begin)/(this.end-this.begin);return this.property.interpolate(m.possiblyEvaluate(e,t,i),f,function(k){if(k<=0)return 0;if(k>=1)return 1;var I=k*k,A=I*k;return 4*(k<.5?A:3*(k-I)+A-.75)}(x))}return f};var Wa=function(e){this._properties=e,this._values=Object.create(e.defaultTransitioningPropertyValues)};Wa.prototype.possiblyEvaluate=function(e,t,i){for(var l=new ws(this._properties),f=0,m=Object.keys(this._values);f<m.length;f+=1){var x=m[f];l._values[x]=this._values[x].possiblyEvaluate(e,t,i)}return l},Wa.prototype.hasTransition=function(){for(var e=0,t=Object.keys(this._values);e<t.length;e+=1)if(this._values[t[e]].prior)return!0;return!1};var ma=function(e){this._properties=e,this._values=Object.create(e.defaultPropertyValues)};ma.prototype.getValue=function(e){return at(this._values[e].value)},ma.prototype.setValue=function(e,t){this._values[e]=new ka(this._values[e].property,t===null?void 0:at(t))},ma.prototype.serialize=function(){for(var e={},t=0,i=Object.keys(this._values);t<i.length;t+=1){var l=i[t],f=this.getValue(l);f!==void 0&&(e[l]=f)}return e},ma.prototype.possiblyEvaluate=function(e,t,i){for(var l=new ws(this._properties),f=0,m=Object.keys(this._values);f<m.length;f+=1){var x=m[f];l._values[x]=this._values[x].possiblyEvaluate(e,t,i)}return l};var vn=function(e,t,i){this.property=e,this.value=t,this.parameters=i};vn.prototype.isConstant=function(){return this.value.kind==="constant"},vn.prototype.constantOr=function(e){return this.value.kind==="constant"?this.value.value:e},vn.prototype.evaluate=function(e,t,i,l){return this.property.evaluate(this.value,this.parameters,e,t,i,l)};var ws=function(e){this._properties=e,this._values=Object.create(e.defaultPossiblyEvaluatedValues)};ws.prototype.get=function(e){return this._values[e]};var kt=function(e){this.specification=e};kt.prototype.possiblyEvaluate=function(e,t){return e.expression.evaluate(t)},kt.prototype.interpolate=function(e,t,i){var l=Fo[this.specification.type];return l?l(e,t,i):e};var mt=function(e,t){this.specification=e,this.overrides=t};mt.prototype.possiblyEvaluate=function(e,t,i,l){return new vn(this,e.expression.kind==="constant"||e.expression.kind==="camera"?{kind:"constant",value:e.expression.evaluate(t,null,{},i,l)}:e.expression,t)},mt.prototype.interpolate=function(e,t,i){if(e.value.kind!=="constant"||t.value.kind!=="constant")return e;if(e.value.value===void 0||t.value.value===void 0)return new vn(this,{kind:"constant",value:void 0},e.parameters);var l=Fo[this.specification.type];return l?new vn(this,{kind:"constant",value:l(e.value.value,t.value.value,i)},e.parameters):e},mt.prototype.evaluate=function(e,t,i,l,f,m){return e.kind==="constant"?e.value:e.evaluate(t,i,l,f,m)};var el=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.possiblyEvaluate=function(i,l,f,m){if(i.value===void 0)return new vn(this,{kind:"constant",value:void 0},l);if(i.expression.kind==="constant"){var x=i.expression.evaluate(l,null,{},f,m),k=i.property.specification.type==="resolvedImage"&&typeof x!="string"?x.name:x,I=this._calculate(k,k,k,l);return new vn(this,{kind:"constant",value:I},l)}if(i.expression.kind==="camera"){var A=this._calculate(i.expression.evaluate({zoom:l.zoom-1}),i.expression.evaluate({zoom:l.zoom}),i.expression.evaluate({zoom:l.zoom+1}),l);return new vn(this,{kind:"constant",value:A},l)}return new vn(this,i.expression,l)},t.prototype.evaluate=function(i,l,f,m,x,k){if(i.kind==="source"){var I=i.evaluate(l,f,m,x,k);return this._calculate(I,I,I,l)}return i.kind==="composite"?this._calculate(i.evaluate({zoom:Math.floor(l.zoom)-1},f,m),i.evaluate({zoom:Math.floor(l.zoom)},f,m),i.evaluate({zoom:Math.floor(l.zoom)+1},f,m),l):i.value},t.prototype._calculate=function(i,l,f,m){return m.zoom>m.zoomHistory.lastIntegerZoom?{from:i,to:l}:{from:f,to:l}},t.prototype.interpolate=function(i){return i},t}(mt),bn=function(e){this.specification=e};bn.prototype.possiblyEvaluate=function(e,t,i,l){if(e.value!==void 0){if(e.expression.kind==="constant"){var f=e.expression.evaluate(t,null,{},i,l);return this._calculate(f,f,f,t)}return this._calculate(e.expression.evaluate(new ar(Math.floor(t.zoom-1),t)),e.expression.evaluate(new ar(Math.floor(t.zoom),t)),e.expression.evaluate(new ar(Math.floor(t.zoom+1),t)),t)}},bn.prototype._calculate=function(e,t,i,l){return l.zoom>l.zoomHistory.lastIntegerZoom?{from:e,to:t}:{from:i,to:t}},bn.prototype.interpolate=function(e){return e};var ya=function(e){this.specification=e};ya.prototype.possiblyEvaluate=function(e,t,i,l){return!!e.expression.evaluate(t,null,{},i,l)},ya.prototype.interpolate=function(){return!1};var en=function(e){for(var t in this.properties=e,this.defaultPropertyValues={},this.defaultTransitionablePropertyValues={},this.defaultTransitioningPropertyValues={},this.defaultPossiblyEvaluatedValues={},this.overridableProperties=[],e){var i=e[t];i.specification.overridable&&this.overridableProperties.push(t);var l=this.defaultPropertyValues[t]=new ka(i,void 0),f=this.defaultTransitionablePropertyValues[t]=new ia(i);this.defaultTransitioningPropertyValues[t]=f.untransitioned(),this.defaultPossiblyEvaluatedValues[t]=l.possiblyEvaluate({})}};ft("DataDrivenProperty",mt),ft("DataConstantProperty",kt),ft("CrossFadedDataDrivenProperty",el),ft("CrossFadedProperty",bn),ft("ColorRampProperty",ya);var Ea=function(e){function t(i,l){if(e.call(this),this.id=i.id,this.type=i.type,this._featureFilter={filter:function(){return!0},needGeometry:!1},i.type!=="custom"&&(this.metadata=(i=i).metadata,this.minzoom=i.minzoom,this.maxzoom=i.maxzoom,i.type!=="background"&&(this.source=i.source,this.sourceLayer=i["source-layer"],this.filter=i.filter),l.layout&&(this._unevaluatedLayout=new ma(l.layout)),l.paint)){for(var f in this._transitionablePaint=new $i(l.paint),i.paint)this.setPaintProperty(f,i.paint[f],{validate:!1});for(var m in i.layout)this.setLayoutProperty(m,i.layout[m],{validate:!1});this._transitioningPaint=this._transitionablePaint.untransitioned(),this.paint=new ws(l.paint)}}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.getCrossfadeParameters=function(){return this._crossfadeParameters},t.prototype.getLayoutProperty=function(i){return i==="visibility"?this.visibility:this._unevaluatedLayout.getValue(i)},t.prototype.setLayoutProperty=function(i,l,f){f===void 0&&(f={}),l!=null&&this._validate(_s,"layers."+this.id+".layout."+i,i,l,f)||(i!=="visibility"?this._unevaluatedLayout.setValue(i,l):this.visibility=l)},t.prototype.getPaintProperty=function(i){return Ke(i,"-transition")?this._transitionablePaint.getTransition(i.slice(0,-11)):this._transitionablePaint.getValue(i)},t.prototype.setPaintProperty=function(i,l,f){if(f===void 0&&(f={}),l!=null&&this._validate(Xh,"layers."+this.id+".paint."+i,i,l,f))return!1;if(Ke(i,"-transition"))return this._transitionablePaint.setTransition(i.slice(0,-11),l||void 0),!1;var m=this._transitionablePaint._values[i],x=m.property.specification["property-type"]==="cross-faded-data-driven",k=m.value.isDataDriven(),I=m.value;this._transitionablePaint.setValue(i,l),this._handleSpecialPaintPropertyUpdate(i);var A=this._transitionablePaint._values[i].value;return A.isDataDriven()||k||x||this._handleOverridablePaintPropertyUpdate(i,I,A)},t.prototype._handleSpecialPaintPropertyUpdate=function(i){},t.prototype._handleOverridablePaintPropertyUpdate=function(i,l,f){return!1},t.prototype.isHidden=function(i){return!!(this.minzoom&&i<this.minzoom)||!!(this.maxzoom&&i>=this.maxzoom)||this.visibility==="none"},t.prototype.updateTransitions=function(i){this._transitioningPaint=this._transitionablePaint.transitioned(i,this._transitioningPaint)},t.prototype.hasTransition=function(){return this._transitioningPaint.hasTransition()},t.prototype.recalculate=function(i,l){i.getCrossfadeParameters&&(this._crossfadeParameters=i.getCrossfadeParameters()),this._unevaluatedLayout&&(this.layout=this._unevaluatedLayout.possiblyEvaluate(i,void 0,l)),this.paint=this._transitioningPaint.possiblyEvaluate(i,void 0,l)},t.prototype.serialize=function(){var i={id:this.id,type:this.type,source:this.source,"source-layer":this.sourceLayer,metadata:this.metadata,minzoom:this.minzoom,maxzoom:this.maxzoom,filter:this.filter,layout:this._unevaluatedLayout&&this._unevaluatedLayout.serialize(),paint:this._transitionablePaint&&this._transitionablePaint.serialize()};return this.visibility&&(i.layout=i.layout||{},i.layout.visibility=this.visibility),Ne(i,function(l,f){return!(l===void 0||f==="layout"&&!Object.keys(l).length||f==="paint"&&!Object.keys(l).length)})},t.prototype._validate=function(i,l,f,m,x){return x===void 0&&(x={}),(!x||x.validate!==!1)&&vs(this,i.call(gs,{key:l,layerType:this.type,objectKey:f,value:m,styleSpec:q,style:{glyphs:!0,sprite:!0}}))},t.prototype.is3D=function(){return!1},t.prototype.isTileClipped=function(){return!1},t.prototype.hasOffscreenPass=function(){return!1},t.prototype.resize=function(){},t.prototype.isStateDependent=function(){for(var i in this.paint._values){var l=this.paint.get(i);if(l instanceof vn&&xo(l.property.specification)&&(l.value.kind==="source"||l.value.kind==="composite")&&l.value.isStateDependent)return!0}return!1},t}(he),nu={Int8:Int8Array,Uint8:Uint8Array,Int16:Int16Array,Uint16:Uint16Array,Int32:Int32Array,Uint32:Uint32Array,Float32:Float32Array},tl=function(e,t){this._structArray=e,this._pos1=t*this.size,this._pos2=this._pos1/2,this._pos4=this._pos1/4,this._pos8=this._pos1/8},Er=function(){this.isTransferred=!1,this.capacity=-1,this.resize(0)};function Gi(e,t){t===void 0&&(t=1);var i=0,l=0;return{members:e.map(function(f){var m=nu[f.type].BYTES_PER_ELEMENT,x=i=Ic(i,Math.max(t,m)),k=f.components||1;return l=Math.max(l,m),i+=m*k,{name:f.name,type:f.type,components:k,offset:x}}),size:Ic(i,Math.max(l,t)),alignment:t}}function Ic(e,t){return Math.ceil(e/t)*t}Er.serialize=function(e,t){return e._trim(),t&&(e.isTransferred=!0,t.push(e.arrayBuffer)),{length:e.length,arrayBuffer:e.arrayBuffer}},Er.deserialize=function(e){var t=Object.create(this.prototype);return t.arrayBuffer=e.arrayBuffer,t.length=e.length,t.capacity=e.arrayBuffer.byteLength/t.bytesPerElement,t._refreshViews(),t},Er.prototype._trim=function(){this.length!==this.capacity&&(this.capacity=this.length,this.arrayBuffer=this.arrayBuffer.slice(0,this.length*this.bytesPerElement),this._refreshViews())},Er.prototype.clear=function(){this.length=0},Er.prototype.resize=function(e){this.reserve(e),this.length=e},Er.prototype.reserve=function(e){if(e>this.capacity){this.capacity=Math.max(e,Math.floor(5*this.capacity),128),this.arrayBuffer=new ArrayBuffer(this.capacity*this.bytesPerElement);var t=this.uint8;this._refreshViews(),t&&this.uint8.set(t)}},Er.prototype._refreshViews=function(){throw new Error("_refreshViews() must be implemented by each concrete StructArray layout")};var zo=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},t.prototype.emplaceBack=function(i,l){var f=this.length;return this.resize(f+1),this.emplace(f,i,l)},t.prototype.emplace=function(i,l,f){var m=2*i;return this.int16[m+0]=l,this.int16[m+1]=f,i},t}(Er);zo.prototype.bytesPerElement=4,ft("StructArrayLayout2i4",zo);var au=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},t.prototype.emplaceBack=function(i,l,f,m){var x=this.length;return this.resize(x+1),this.emplace(x,i,l,f,m)},t.prototype.emplace=function(i,l,f,m,x){var k=4*i;return this.int16[k+0]=l,this.int16[k+1]=f,this.int16[k+2]=m,this.int16[k+3]=x,i},t}(Er);au.prototype.bytesPerElement=8,ft("StructArrayLayout4i8",au);var Da=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},t.prototype.emplaceBack=function(i,l,f,m,x,k){var I=this.length;return this.resize(I+1),this.emplace(I,i,l,f,m,x,k)},t.prototype.emplace=function(i,l,f,m,x,k,I){var A=6*i;return this.int16[A+0]=l,this.int16[A+1]=f,this.int16[A+2]=m,this.int16[A+3]=x,this.int16[A+4]=k,this.int16[A+5]=I,i},t}(Er);Da.prototype.bytesPerElement=12,ft("StructArrayLayout2i4i12",Da);var jn=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},t.prototype.emplaceBack=function(i,l,f,m,x,k){var I=this.length;return this.resize(I+1),this.emplace(I,i,l,f,m,x,k)},t.prototype.emplace=function(i,l,f,m,x,k,I){var A=4*i,M=8*i;return this.int16[A+0]=l,this.int16[A+1]=f,this.uint8[M+4]=m,this.uint8[M+5]=x,this.uint8[M+6]=k,this.uint8[M+7]=I,i},t}(Er);jn.prototype.bytesPerElement=8,ft("StructArrayLayout2i4ub8",jn);var Go=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},t.prototype.emplaceBack=function(i,l){var f=this.length;return this.resize(f+1),this.emplace(f,i,l)},t.prototype.emplace=function(i,l,f){var m=2*i;return this.float32[m+0]=l,this.float32[m+1]=f,i},t}(Er);Go.prototype.bytesPerElement=8,ft("StructArrayLayout2f8",Go);var za=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},t.prototype.emplaceBack=function(i,l,f,m,x,k,I,A,M,B){var U=this.length;return this.resize(U+1),this.emplace(U,i,l,f,m,x,k,I,A,M,B)},t.prototype.emplace=function(i,l,f,m,x,k,I,A,M,B,U){var j=10*i;return this.uint16[j+0]=l,this.uint16[j+1]=f,this.uint16[j+2]=m,this.uint16[j+3]=x,this.uint16[j+4]=k,this.uint16[j+5]=I,this.uint16[j+6]=A,this.uint16[j+7]=M,this.uint16[j+8]=B,this.uint16[j+9]=U,i},t}(Er);za.prototype.bytesPerElement=20,ft("StructArrayLayout10ui20",za);var rl=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},t.prototype.emplaceBack=function(i,l,f,m,x,k,I,A,M,B,U,j){var J=this.length;return this.resize(J+1),this.emplace(J,i,l,f,m,x,k,I,A,M,B,U,j)},t.prototype.emplace=function(i,l,f,m,x,k,I,A,M,B,U,j,J){var $=12*i;return this.int16[$+0]=l,this.int16[$+1]=f,this.int16[$+2]=m,this.int16[$+3]=x,this.uint16[$+4]=k,this.uint16[$+5]=I,this.uint16[$+6]=A,this.uint16[$+7]=M,this.int16[$+8]=B,this.int16[$+9]=U,this.int16[$+10]=j,this.int16[$+11]=J,i},t}(Er);rl.prototype.bytesPerElement=24,ft("StructArrayLayout4i4ui4i24",rl);var Ko=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},t.prototype.emplaceBack=function(i,l,f){var m=this.length;return this.resize(m+1),this.emplace(m,i,l,f)},t.prototype.emplace=function(i,l,f,m){var x=3*i;return this.float32[x+0]=l,this.float32[x+1]=f,this.float32[x+2]=m,i},t}(Er);Ko.prototype.bytesPerElement=12,ft("StructArrayLayout3f12",Ko);var Ss=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)},t.prototype.emplaceBack=function(i){var l=this.length;return this.resize(l+1),this.emplace(l,i)},t.prototype.emplace=function(i,l){return this.uint32[1*i+0]=l,i},t}(Er);Ss.prototype.bytesPerElement=4,ft("StructArrayLayout1ul4",Ss);var ou=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},t.prototype.emplaceBack=function(i,l,f,m,x,k,I,A,M){var B=this.length;return this.resize(B+1),this.emplace(B,i,l,f,m,x,k,I,A,M)},t.prototype.emplace=function(i,l,f,m,x,k,I,A,M,B){var U=10*i,j=5*i;return this.int16[U+0]=l,this.int16[U+1]=f,this.int16[U+2]=m,this.int16[U+3]=x,this.int16[U+4]=k,this.int16[U+5]=I,this.uint32[j+3]=A,this.uint16[U+8]=M,this.uint16[U+9]=B,i},t}(Er);ou.prototype.bytesPerElement=20,ft("StructArrayLayout6i1ul2ui20",ou);var Ho=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},t.prototype.emplaceBack=function(i,l,f,m,x,k){var I=this.length;return this.resize(I+1),this.emplace(I,i,l,f,m,x,k)},t.prototype.emplace=function(i,l,f,m,x,k,I){var A=6*i;return this.int16[A+0]=l,this.int16[A+1]=f,this.int16[A+2]=m,this.int16[A+3]=x,this.int16[A+4]=k,this.int16[A+5]=I,i},t}(Er);Ho.prototype.bytesPerElement=12,ft("StructArrayLayout2i2i2i12",Ho);var To=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},t.prototype.emplaceBack=function(i,l,f,m,x){var k=this.length;return this.resize(k+1),this.emplace(k,i,l,f,m,x)},t.prototype.emplace=function(i,l,f,m,x,k){var I=4*i,A=8*i;return this.float32[I+0]=l,this.float32[I+1]=f,this.float32[I+2]=m,this.int16[A+6]=x,this.int16[A+7]=k,i},t}(Er);To.prototype.bytesPerElement=16,ft("StructArrayLayout2f1f2i16",To);var su=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},t.prototype.emplaceBack=function(i,l,f,m){var x=this.length;return this.resize(x+1),this.emplace(x,i,l,f,m)},t.prototype.emplace=function(i,l,f,m,x){var k=12*i,I=3*i;return this.uint8[k+0]=l,this.uint8[k+1]=f,this.float32[I+1]=m,this.float32[I+2]=x,i},t}(Er);su.prototype.bytesPerElement=12,ft("StructArrayLayout2ub2f12",su);var Ya=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},t.prototype.emplaceBack=function(i,l,f){var m=this.length;return this.resize(m+1),this.emplace(m,i,l,f)},t.prototype.emplace=function(i,l,f,m){var x=3*i;return this.uint16[x+0]=l,this.uint16[x+1]=f,this.uint16[x+2]=m,i},t}(Er);Ya.prototype.bytesPerElement=6,ft("StructArrayLayout3ui6",Ya);var Ja=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},t.prototype.emplaceBack=function(i,l,f,m,x,k,I,A,M,B,U,j,J,$,ce,ie,ye){var be=this.length;return this.resize(be+1),this.emplace(be,i,l,f,m,x,k,I,A,M,B,U,j,J,$,ce,ie,ye)},t.prototype.emplace=function(i,l,f,m,x,k,I,A,M,B,U,j,J,$,ce,ie,ye,be){var we=24*i,ke=12*i,Ce=48*i;return this.int16[we+0]=l,this.int16[we+1]=f,this.uint16[we+2]=m,this.uint16[we+3]=x,this.uint32[ke+2]=k,this.uint32[ke+3]=I,this.uint32[ke+4]=A,this.uint16[we+10]=M,this.uint16[we+11]=B,this.uint16[we+12]=U,this.float32[ke+7]=j,this.float32[ke+8]=J,this.uint8[Ce+36]=$,this.uint8[Ce+37]=ce,this.uint8[Ce+38]=ie,this.uint32[ke+10]=ye,this.int16[we+22]=be,i},t}(Er);Ja.prototype.bytesPerElement=48,ft("StructArrayLayout2i2ui3ul3ui2f3ub1ul1i48",Ja);var il=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},t.prototype.emplaceBack=function(i,l,f,m,x,k,I,A,M,B,U,j,J,$,ce,ie,ye,be,we,ke,Ce,Ve,Je,wt,ot,zt,lt,Yt){var Lt=this.length;return this.resize(Lt+1),this.emplace(Lt,i,l,f,m,x,k,I,A,M,B,U,j,J,$,ce,ie,ye,be,we,ke,Ce,Ve,Je,wt,ot,zt,lt,Yt)},t.prototype.emplace=function(i,l,f,m,x,k,I,A,M,B,U,j,J,$,ce,ie,ye,be,we,ke,Ce,Ve,Je,wt,ot,zt,lt,Yt,Lt){var yt=34*i,nr=17*i;return this.int16[yt+0]=l,this.int16[yt+1]=f,this.int16[yt+2]=m,this.int16[yt+3]=x,this.int16[yt+4]=k,this.int16[yt+5]=I,this.int16[yt+6]=A,this.int16[yt+7]=M,this.uint16[yt+8]=B,this.uint16[yt+9]=U,this.uint16[yt+10]=j,this.uint16[yt+11]=J,this.uint16[yt+12]=$,this.uint16[yt+13]=ce,this.uint16[yt+14]=ie,this.uint16[yt+15]=ye,this.uint16[yt+16]=be,this.uint16[yt+17]=we,this.uint16[yt+18]=ke,this.uint16[yt+19]=Ce,this.uint16[yt+20]=Ve,this.uint16[yt+21]=Je,this.uint16[yt+22]=wt,this.uint32[nr+12]=ot,this.float32[nr+13]=zt,this.float32[nr+14]=lt,this.float32[nr+15]=Yt,this.float32[nr+16]=Lt,i},t}(Er);il.prototype.bytesPerElement=68,ft("StructArrayLayout8i15ui1ul4f68",il);var Qa=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},t.prototype.emplaceBack=function(i){var l=this.length;return this.resize(l+1),this.emplace(l,i)},t.prototype.emplace=function(i,l){return this.float32[1*i+0]=l,i},t}(Er);Qa.prototype.bytesPerElement=4,ft("StructArrayLayout1f4",Qa);var na=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},t.prototype.emplaceBack=function(i,l,f){var m=this.length;return this.resize(m+1),this.emplace(m,i,l,f)},t.prototype.emplace=function(i,l,f,m){var x=3*i;return this.int16[x+0]=l,this.int16[x+1]=f,this.int16[x+2]=m,i},t}(Er);na.prototype.bytesPerElement=6,ft("StructArrayLayout3i6",na);var lu=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},t.prototype.emplaceBack=function(i,l,f){var m=this.length;return this.resize(m+1),this.emplace(m,i,l,f)},t.prototype.emplace=function(i,l,f,m){var x=4*i;return this.uint32[2*i+0]=l,this.uint16[x+2]=f,this.uint16[x+3]=m,i},t}(Er);lu.prototype.bytesPerElement=8,ft("StructArrayLayout1ul2ui8",lu);var ks=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},t.prototype.emplaceBack=function(i,l){var f=this.length;return this.resize(f+1),this.emplace(f,i,l)},t.prototype.emplace=function(i,l,f){var m=2*i;return this.uint16[m+0]=l,this.uint16[m+1]=f,i},t}(Er);ks.prototype.bytesPerElement=4,ft("StructArrayLayout2ui4",ks);var uu=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},t.prototype.emplaceBack=function(i){var l=this.length;return this.resize(l+1),this.emplace(l,i)},t.prototype.emplace=function(i,l){return this.uint16[1*i+0]=l,i},t}(Er);uu.prototype.bytesPerElement=2,ft("StructArrayLayout1ui2",uu);var nl=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},t.prototype.emplaceBack=function(i,l,f,m){var x=this.length;return this.resize(x+1),this.emplace(x,i,l,f,m)},t.prototype.emplace=function(i,l,f,m,x){var k=4*i;return this.float32[k+0]=l,this.float32[k+1]=f,this.float32[k+2]=m,this.float32[k+3]=x,i},t}(Er);nl.prototype.bytesPerElement=16,ft("StructArrayLayout4f16",nl);var n=function(e){function t(){e.apply(this,arguments)}e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t;var i={anchorPointX:{configurable:!0},anchorPointY:{configurable:!0},x1:{configurable:!0},y1:{configurable:!0},x2:{configurable:!0},y2:{configurable:!0},featureIndex:{configurable:!0},sourceLayerIndex:{configurable:!0},bucketIndex:{configurable:!0},anchorPoint:{configurable:!0}};return i.anchorPointX.get=function(){return this._structArray.int16[this._pos2+0]},i.anchorPointY.get=function(){return this._structArray.int16[this._pos2+1]},i.x1.get=function(){return this._structArray.int16[this._pos2+2]},i.y1.get=function(){return this._structArray.int16[this._pos2+3]},i.x2.get=function(){return this._structArray.int16[this._pos2+4]},i.y2.get=function(){return this._structArray.int16[this._pos2+5]},i.featureIndex.get=function(){return this._structArray.uint32[this._pos4+3]},i.sourceLayerIndex.get=function(){return this._structArray.uint16[this._pos2+8]},i.bucketIndex.get=function(){return this._structArray.uint16[this._pos2+9]},i.anchorPoint.get=function(){return new F(this.anchorPointX,this.anchorPointY)},Object.defineProperties(t.prototype,i),t}(tl);n.prototype.size=20;var s=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.get=function(i){return new n(this,i)},t}(ou);ft("CollisionBoxArray",s);var o=function(e){function t(){e.apply(this,arguments)}e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t;var i={anchorX:{configurable:!0},anchorY:{configurable:!0},glyphStartIndex:{configurable:!0},numGlyphs:{configurable:!0},vertexStartIndex:{configurable:!0},lineStartIndex:{configurable:!0},lineLength:{configurable:!0},segment:{configurable:!0},lowerSize:{configurable:!0},upperSize:{configurable:!0},lineOffsetX:{configurable:!0},lineOffsetY:{configurable:!0},writingMode:{configurable:!0},placedOrientation:{configurable:!0},hidden:{configurable:!0},crossTileID:{configurable:!0},associatedIconIndex:{configurable:!0}};return i.anchorX.get=function(){return this._structArray.int16[this._pos2+0]},i.anchorY.get=function(){return this._structArray.int16[this._pos2+1]},i.glyphStartIndex.get=function(){return this._structArray.uint16[this._pos2+2]},i.numGlyphs.get=function(){return this._structArray.uint16[this._pos2+3]},i.vertexStartIndex.get=function(){return this._structArray.uint32[this._pos4+2]},i.lineStartIndex.get=function(){return this._structArray.uint32[this._pos4+3]},i.lineLength.get=function(){return this._structArray.uint32[this._pos4+4]},i.segment.get=function(){return this._structArray.uint16[this._pos2+10]},i.lowerSize.get=function(){return this._structArray.uint16[this._pos2+11]},i.upperSize.get=function(){return this._structArray.uint16[this._pos2+12]},i.lineOffsetX.get=function(){return this._structArray.float32[this._pos4+7]},i.lineOffsetY.get=function(){return this._structArray.float32[this._pos4+8]},i.writingMode.get=function(){return this._structArray.uint8[this._pos1+36]},i.placedOrientation.get=function(){return this._structArray.uint8[this._pos1+37]},i.placedOrientation.set=function(l){this._structArray.uint8[this._pos1+37]=l},i.hidden.get=function(){return this._structArray.uint8[this._pos1+38]},i.hidden.set=function(l){this._structArray.uint8[this._pos1+38]=l},i.crossTileID.get=function(){return this._structArray.uint32[this._pos4+10]},i.crossTileID.set=function(l){this._structArray.uint32[this._pos4+10]=l},i.associatedIconIndex.get=function(){return this._structArray.int16[this._pos2+22]},Object.defineProperties(t.prototype,i),t}(tl);o.prototype.size=48;var c=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.get=function(i){return new o(this,i)},t}(Ja);ft("PlacedSymbolArray",c);var v=function(e){function t(){e.apply(this,arguments)}e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t;var i={anchorX:{configurable:!0},anchorY:{configurable:!0},rightJustifiedTextSymbolIndex:{configurable:!0},centerJustifiedTextSymbolIndex:{configurable:!0},leftJustifiedTextSymbolIndex:{configurable:!0},verticalPlacedTextSymbolIndex:{configurable:!0},placedIconSymbolIndex:{configurable:!0},verticalPlacedIconSymbolIndex:{configurable:!0},key:{configurable:!0},textBoxStartIndex:{configurable:!0},textBoxEndIndex:{configurable:!0},verticalTextBoxStartIndex:{configurable:!0},verticalTextBoxEndIndex:{configurable:!0},iconBoxStartIndex:{configurable:!0},iconBoxEndIndex:{configurable:!0},verticalIconBoxStartIndex:{configurable:!0},verticalIconBoxEndIndex:{configurable:!0},featureIndex:{configurable:!0},numHorizontalGlyphVertices:{configurable:!0},numVerticalGlyphVertices:{configurable:!0},numIconVertices:{configurable:!0},numVerticalIconVertices:{configurable:!0},useRuntimeCollisionCircles:{configurable:!0},crossTileID:{configurable:!0},textBoxScale:{configurable:!0},textOffset0:{configurable:!0},textOffset1:{configurable:!0},collisionCircleDiameter:{configurable:!0}};return i.anchorX.get=function(){return this._structArray.int16[this._pos2+0]},i.anchorY.get=function(){return this._structArray.int16[this._pos2+1]},i.rightJustifiedTextSymbolIndex.get=function(){return this._structArray.int16[this._pos2+2]},i.centerJustifiedTextSymbolIndex.get=function(){return this._structArray.int16[this._pos2+3]},i.leftJustifiedTextSymbolIndex.get=function(){return this._structArray.int16[this._pos2+4]},i.verticalPlacedTextSymbolIndex.get=function(){return this._structArray.int16[this._pos2+5]},i.placedIconSymbolIndex.get=function(){return this._structArray.int16[this._pos2+6]},i.verticalPlacedIconSymbolIndex.get=function(){return this._structArray.int16[this._pos2+7]},i.key.get=function(){return this._structArray.uint16[this._pos2+8]},i.textBoxStartIndex.get=function(){return this._structArray.uint16[this._pos2+9]},i.textBoxEndIndex.get=function(){return this._structArray.uint16[this._pos2+10]},i.verticalTextBoxStartIndex.get=function(){return this._structArray.uint16[this._pos2+11]},i.verticalTextBoxEndIndex.get=function(){return this._structArray.uint16[this._pos2+12]},i.iconBoxStartIndex.get=function(){return this._structArray.uint16[this._pos2+13]},i.iconBoxEndIndex.get=function(){return this._structArray.uint16[this._pos2+14]},i.verticalIconBoxStartIndex.get=function(){return this._structArray.uint16[this._pos2+15]},i.verticalIconBoxEndIndex.get=function(){return this._structArray.uint16[this._pos2+16]},i.featureIndex.get=function(){return this._structArray.uint16[this._pos2+17]},i.numHorizontalGlyphVertices.get=function(){return this._structArray.uint16[this._pos2+18]},i.numVerticalGlyphVertices.get=function(){return this._structArray.uint16[this._pos2+19]},i.numIconVertices.get=function(){return this._structArray.uint16[this._pos2+20]},i.numVerticalIconVertices.get=function(){return this._structArray.uint16[this._pos2+21]},i.useRuntimeCollisionCircles.get=function(){return this._structArray.uint16[this._pos2+22]},i.crossTileID.get=function(){return this._structArray.uint32[this._pos4+12]},i.crossTileID.set=function(l){this._structArray.uint32[this._pos4+12]=l},i.textBoxScale.get=function(){return this._structArray.float32[this._pos4+13]},i.textOffset0.get=function(){return this._structArray.float32[this._pos4+14]},i.textOffset1.get=function(){return this._structArray.float32[this._pos4+15]},i.collisionCircleDiameter.get=function(){return this._structArray.float32[this._pos4+16]},Object.defineProperties(t.prototype,i),t}(tl);v.prototype.size=68;var w=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.get=function(i){return new v(this,i)},t}(il);ft("SymbolInstanceArray",w);var S=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.getoffsetX=function(i){return this.float32[1*i+0]},t}(Qa);ft("GlyphOffsetArray",S);var z=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.getx=function(i){return this.int16[3*i+0]},t.prototype.gety=function(i){return this.int16[3*i+1]},t.prototype.gettileUnitDistanceFromAnchor=function(i){return this.int16[3*i+2]},t}(na);ft("SymbolLineVertexArray",z);var C=function(e){function t(){e.apply(this,arguments)}e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t;var i={featureIndex:{configurable:!0},sourceLayerIndex:{configurable:!0},bucketIndex:{configurable:!0}};return i.featureIndex.get=function(){return this._structArray.uint32[this._pos4+0]},i.sourceLayerIndex.get=function(){return this._structArray.uint16[this._pos2+2]},i.bucketIndex.get=function(){return this._structArray.uint16[this._pos2+3]},Object.defineProperties(t.prototype,i),t}(tl);C.prototype.size=8;var O=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.get=function(i){return new C(this,i)},t}(lu);ft("FeatureIndexArray",O);var Z=Gi([{name:"a_pos",components:2,type:"Int16"}],4).members,G=function(e){e===void 0&&(e=[]),this.segments=e};function H(e,t){return 256*(e=ve(Math.floor(e),0,255))+ve(Math.floor(t),0,255)}G.prototype.prepareSegment=function(e,t,i,l){var f=this.segments[this.segments.length-1];return e>G.MAX_VERTEX_ARRAY_LENGTH&&st("Max vertices per segment is "+G.MAX_VERTEX_ARRAY_LENGTH+": bucket requested "+e),(!f||f.vertexLength+e>G.MAX_VERTEX_ARRAY_LENGTH||f.sortKey!==l)&&(f={vertexOffset:t.length,primitiveOffset:i.length,vertexLength:0,primitiveLength:0},l!==void 0&&(f.sortKey=l),this.segments.push(f)),f},G.prototype.get=function(){return this.segments},G.prototype.destroy=function(){for(var e=0,t=this.segments;e<t.length;e+=1){var i=t[e];for(var l in i.vaos)i.vaos[l].destroy()}},G.simpleSegment=function(e,t,i,l){return new G([{vertexOffset:e,primitiveOffset:t,vertexLength:i,primitiveLength:l,vaos:{},sortKey:0}])},G.MAX_VERTEX_ARRAY_LENGTH=Math.pow(2,16)-1,ft("SegmentVector",G);var re=Gi([{name:"a_pattern_from",components:4,type:"Uint16"},{name:"a_pattern_to",components:4,type:"Uint16"},{name:"a_pixel_ratio_from",components:1,type:"Uint16"},{name:"a_pixel_ratio_to",components:1,type:"Uint16"}]),ee=T(function(e){e.exports=function(t,i){var l,f,m,x,k,I,A,M;for(f=t.length-(l=3&t.length),m=i,k=3432918353,I=461845907,M=0;M<f;)A=255&t.charCodeAt(M)|(255&t.charCodeAt(++M))<<8|(255&t.charCodeAt(++M))<<16|(255&t.charCodeAt(++M))<<24,++M,m=27492+(65535&(x=5*(65535&(m=(m^=A=(65535&(A=(A=(65535&A)*k+(((A>>>16)*k&65535)<<16)&4294967295)<<15|A>>>17))*I+(((A>>>16)*I&65535)<<16)&4294967295)<<13|m>>>19))+((5*(m>>>16)&65535)<<16)&4294967295))+((58964+(x>>>16)&65535)<<16);switch(A=0,l){case 3:A^=(255&t.charCodeAt(M+2))<<16;case 2:A^=(255&t.charCodeAt(M+1))<<8;case 1:m^=A=(65535&(A=(A=(65535&(A^=255&t.charCodeAt(M)))*k+(((A>>>16)*k&65535)<<16)&4294967295)<<15|A>>>17))*I+(((A>>>16)*I&65535)<<16)&4294967295}return m^=t.length,m=2246822507*(65535&(m^=m>>>16))+((2246822507*(m>>>16)&65535)<<16)&4294967295,m=3266489909*(65535&(m^=m>>>13))+((3266489909*(m>>>16)&65535)<<16)&4294967295,(m^=m>>>16)>>>0}}),le=T(function(e){e.exports=function(t,i){for(var l,f=t.length,m=i^f,x=0;f>=4;)l=1540483477*(65535&(l=255&t.charCodeAt(x)|(255&t.charCodeAt(++x))<<8|(255&t.charCodeAt(++x))<<16|(255&t.charCodeAt(++x))<<24))+((1540483477*(l>>>16)&65535)<<16),m=1540483477*(65535&m)+((1540483477*(m>>>16)&65535)<<16)^(l=1540483477*(65535&(l^=l>>>24))+((1540483477*(l>>>16)&65535)<<16)),f-=4,++x;switch(f){case 3:m^=(255&t.charCodeAt(x+2))<<16;case 2:m^=(255&t.charCodeAt(x+1))<<8;case 1:m=1540483477*(65535&(m^=255&t.charCodeAt(x)))+((1540483477*(m>>>16)&65535)<<16)}return m=1540483477*(65535&(m^=m>>>13))+((1540483477*(m>>>16)&65535)<<16),(m^=m>>>15)>>>0}}),Y=ee,se=le;Y.murmur3=ee,Y.murmur2=se;var fe=function(){this.ids=[],this.positions=[],this.indexed=!1};fe.prototype.add=function(e,t,i,l){this.ids.push(Te(e)),this.positions.push(t,i,l)},fe.prototype.getPositions=function(e){for(var t=Te(e),i=0,l=this.ids.length-1;i<l;){var f=i+l>>1;this.ids[f]>=t?l=f:i=f+1}for(var m=[];this.ids[i]===t;)m.push({index:this.positions[3*i],start:this.positions[3*i+1],end:this.positions[3*i+2]}),i++;return m},fe.serialize=function(e,t){var i=new Float64Array(e.ids),l=new Uint32Array(e.positions);return function f(m,x,k,I){for(;k<I;){for(var A=m[k+I>>1],M=k-1,B=I+1;;){do M++;while(m[M]<A);do B--;while(m[B]>A);if(M>=B)break;Se(m,M,B),Se(x,3*M,3*B),Se(x,3*M+1,3*B+1),Se(x,3*M+2,3*B+2)}B-k<I-B?(f(m,x,k,B),k=B+1):(f(m,x,B+1,I),I=B)}}(i,l,0,i.length-1),t&&t.push(i.buffer,l.buffer),{ids:i,positions:l}},fe.deserialize=function(e){var t=new fe;return t.ids=e.ids,t.positions=e.positions,t.indexed=!0,t};var _e=Math.pow(2,53)-1;function Te(e){var t=+e;return!isNaN(t)&&t<=_e?t:Y(String(e))}function Se(e,t,i){var l=e[t];e[t]=e[i],e[i]=l}ft("FeaturePositionMap",fe);var Ae=function(e,t){this.gl=e.gl,this.location=t},Oe=function(e){function t(i,l){e.call(this,i,l),this.current=0}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.set=function(i){this.current!==i&&(this.current=i,this.gl.uniform1i(this.location,i))},t}(Ae),He=function(e){function t(i,l){e.call(this,i,l),this.current=0}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.set=function(i){this.current!==i&&(this.current=i,this.gl.uniform1f(this.location,i))},t}(Ae),Ze=function(e){function t(i,l){e.call(this,i,l),this.current=[0,0]}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.set=function(i){i[0]===this.current[0]&&i[1]===this.current[1]||(this.current=i,this.gl.uniform2f(this.location,i[0],i[1]))},t}(Ae),ct=function(e){function t(i,l){e.call(this,i,l),this.current=[0,0,0]}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.set=function(i){i[0]===this.current[0]&&i[1]===this.current[1]&&i[2]===this.current[2]||(this.current=i,this.gl.uniform3f(this.location,i[0],i[1],i[2]))},t}(Ae),Et=function(e){function t(i,l){e.call(this,i,l),this.current=[0,0,0,0]}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.set=function(i){i[0]===this.current[0]&&i[1]===this.current[1]&&i[2]===this.current[2]&&i[3]===this.current[3]||(this.current=i,this.gl.uniform4f(this.location,i[0],i[1],i[2],i[3]))},t}(Ae),Ct=function(e){function t(i,l){e.call(this,i,l),this.current=ur.transparent}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.set=function(i){i.r===this.current.r&&i.g===this.current.g&&i.b===this.current.b&&i.a===this.current.a||(this.current=i,this.gl.uniform4f(this.location,i.r,i.g,i.b,i.a))},t}(Ae),It=new Float32Array(16),dr=function(e){function t(i,l){e.call(this,i,l),this.current=It}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.set=function(i){if(i[12]!==this.current[12]||i[0]!==this.current[0])return this.current=i,void this.gl.uniformMatrix4fv(this.location,!1,i);for(var l=1;l<16;l++)if(i[l]!==this.current[l]){this.current=i,this.gl.uniformMatrix4fv(this.location,!1,i);break}},t}(Ae);function pt(e){return[H(255*e.r,255*e.g),H(255*e.b,255*e.a)]}var Ut=function(e,t,i){this.value=e,this.uniformNames=t.map(function(l){return"u_"+l}),this.type=i};Ut.prototype.setUniform=function(e,t,i){e.set(i.constantOr(this.value))},Ut.prototype.getBinding=function(e,t,i){return this.type==="color"?new Ct(e,t):new He(e,t)};var Xt=function(e,t){this.uniformNames=t.map(function(i){return"u_"+i}),this.patternFrom=null,this.patternTo=null,this.pixelRatioFrom=1,this.pixelRatioTo=1};Xt.prototype.setConstantPatternPositions=function(e,t){this.pixelRatioFrom=t.pixelRatio,this.pixelRatioTo=e.pixelRatio,this.patternFrom=t.tlbr,this.patternTo=e.tlbr},Xt.prototype.setUniform=function(e,t,i,l){var f=l==="u_pattern_to"?this.patternTo:l==="u_pattern_from"?this.patternFrom:l==="u_pixel_ratio_to"?this.pixelRatioTo:l==="u_pixel_ratio_from"?this.pixelRatioFrom:null;f&&e.set(f)},Xt.prototype.getBinding=function(e,t,i){return i.substr(0,9)==="u_pattern"?new Et(e,t):new He(e,t)};var Nt=function(e,t,i,l){this.expression=e,this.type=i,this.maxValue=0,this.paintVertexAttributes=t.map(function(f){return{name:"a_"+f,type:"Float32",components:i==="color"?2:1,offset:0}}),this.paintVertexArray=new l};Nt.prototype.populatePaintArray=function(e,t,i,l,f){var m=this.paintVertexArray.length,x=this.expression.evaluate(new ar(0),t,{},l,[],f);this.paintVertexArray.resize(e),this._setPaintValue(m,e,x)},Nt.prototype.updatePaintArray=function(e,t,i,l){var f=this.expression.evaluate({zoom:0},i,l);this._setPaintValue(e,t,f)},Nt.prototype._setPaintValue=function(e,t,i){if(this.type==="color")for(var l=pt(i),f=e;f<t;f++)this.paintVertexArray.emplace(f,l[0],l[1]);else{for(var m=e;m<t;m++)this.paintVertexArray.emplace(m,i);this.maxValue=Math.max(this.maxValue,Math.abs(i))}},Nt.prototype.upload=function(e){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=e.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))},Nt.prototype.destroy=function(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()};var Bt=function(e,t,i,l,f,m){this.expression=e,this.uniformNames=t.map(function(x){return"u_"+x+"_t"}),this.type=i,this.useIntegerZoom=l,this.zoom=f,this.maxValue=0,this.paintVertexAttributes=t.map(function(x){return{name:"a_"+x,type:"Float32",components:i==="color"?4:2,offset:0}}),this.paintVertexArray=new m};Bt.prototype.populatePaintArray=function(e,t,i,l,f){var m=this.expression.evaluate(new ar(this.zoom),t,{},l,[],f),x=this.expression.evaluate(new ar(this.zoom+1),t,{},l,[],f),k=this.paintVertexArray.length;this.paintVertexArray.resize(e),this._setPaintValue(k,e,m,x)},Bt.prototype.updatePaintArray=function(e,t,i,l){var f=this.expression.evaluate({zoom:this.zoom},i,l),m=this.expression.evaluate({zoom:this.zoom+1},i,l);this._setPaintValue(e,t,f,m)},Bt.prototype._setPaintValue=function(e,t,i,l){if(this.type==="color")for(var f=pt(i),m=pt(l),x=e;x<t;x++)this.paintVertexArray.emplace(x,f[0],f[1],m[0],m[1]);else{for(var k=e;k<t;k++)this.paintVertexArray.emplace(k,i,l);this.maxValue=Math.max(this.maxValue,Math.abs(i),Math.abs(l))}},Bt.prototype.upload=function(e){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=e.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))},Bt.prototype.destroy=function(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()},Bt.prototype.setUniform=function(e,t){var i=this.useIntegerZoom?Math.floor(t.zoom):t.zoom,l=ve(this.expression.interpolationFactor(i,this.zoom,this.zoom+1),0,1);e.set(l)},Bt.prototype.getBinding=function(e,t,i){return new He(e,t)};var Ht=function(e,t,i,l,f,m){this.expression=e,this.type=t,this.useIntegerZoom=i,this.zoom=l,this.layerId=m,this.zoomInPaintVertexArray=new f,this.zoomOutPaintVertexArray=new f};Ht.prototype.populatePaintArray=function(e,t,i){var l=this.zoomInPaintVertexArray.length;this.zoomInPaintVertexArray.resize(e),this.zoomOutPaintVertexArray.resize(e),this._setPaintValues(l,e,t.patterns&&t.patterns[this.layerId],i)},Ht.prototype.updatePaintArray=function(e,t,i,l,f){this._setPaintValues(e,t,i.patterns&&i.patterns[this.layerId],f)},Ht.prototype._setPaintValues=function(e,t,i,l){if(l&&i){var f=l[i.min],m=l[i.mid],x=l[i.max];if(f&&m&&x)for(var k=e;k<t;k++)this.zoomInPaintVertexArray.emplace(k,m.tl[0],m.tl[1],m.br[0],m.br[1],f.tl[0],f.tl[1],f.br[0],f.br[1],m.pixelRatio,f.pixelRatio),this.zoomOutPaintVertexArray.emplace(k,m.tl[0],m.tl[1],m.br[0],m.br[1],x.tl[0],x.tl[1],x.br[0],x.br[1],m.pixelRatio,x.pixelRatio)}},Ht.prototype.upload=function(e){this.zoomInPaintVertexArray&&this.zoomInPaintVertexArray.arrayBuffer&&this.zoomOutPaintVertexArray&&this.zoomOutPaintVertexArray.arrayBuffer&&(this.zoomInPaintVertexBuffer=e.createVertexBuffer(this.zoomInPaintVertexArray,re.members,this.expression.isStateDependent),this.zoomOutPaintVertexBuffer=e.createVertexBuffer(this.zoomOutPaintVertexArray,re.members,this.expression.isStateDependent))},Ht.prototype.destroy=function(){this.zoomOutPaintVertexBuffer&&this.zoomOutPaintVertexBuffer.destroy(),this.zoomInPaintVertexBuffer&&this.zoomInPaintVertexBuffer.destroy()};var Rt=function(e,t,i){this.binders={},this._buffers=[];var l=[];for(var f in e.paint._values)if(i(f)){var m=e.paint.get(f);if(m instanceof vn&&xo(m.property.specification)){var x=Bi(f,e.type),k=m.value,I=m.property.specification.type,A=m.property.useIntegerZoom,M=m.property.specification["property-type"],B=M==="cross-faded"||M==="cross-faded-data-driven";if(k.kind==="constant")this.binders[f]=B?new Xt(k.value,x):new Ut(k.value,x,I),l.push("/u_"+f);else if(k.kind==="source"||B){var U=ni(f,I,"source");this.binders[f]=B?new Ht(k,I,A,t,U,e.id):new Nt(k,x,I,U),l.push("/a_"+f)}else{var j=ni(f,I,"composite");this.binders[f]=new Bt(k,x,I,A,t,j),l.push("/z_"+f)}}}this.cacheKey=l.sort().join("")};Rt.prototype.getMaxValue=function(e){var t=this.binders[e];return t instanceof Nt||t instanceof Bt?t.maxValue:0},Rt.prototype.populatePaintArrays=function(e,t,i,l,f){for(var m in this.binders){var x=this.binders[m];(x instanceof Nt||x instanceof Bt||x instanceof Ht)&&x.populatePaintArray(e,t,i,l,f)}},Rt.prototype.setConstantPatternPositions=function(e,t){for(var i in this.binders){var l=this.binders[i];l instanceof Xt&&l.setConstantPatternPositions(e,t)}},Rt.prototype.updatePaintArrays=function(e,t,i,l,f){var m=!1;for(var x in e)for(var k=0,I=t.getPositions(x);k<I.length;k+=1){var A=I[k],M=i.feature(A.index);for(var B in this.binders){var U=this.binders[B];if((U instanceof Nt||U instanceof Bt||U instanceof Ht)&&U.expression.isStateDependent===!0){var j=l.paint.get(B);U.expression=j.value,U.updatePaintArray(A.start,A.end,M,e[x],f),m=!0}}}return m},Rt.prototype.defines=function(){var e=[];for(var t in this.binders){var i=this.binders[t];(i instanceof Ut||i instanceof Xt)&&e.push.apply(e,i.uniformNames.map(function(l){return"#define HAS_UNIFORM_"+l}))}return e},Rt.prototype.getBinderAttributes=function(){var e=[];for(var t in this.binders){var i=this.binders[t];if(i instanceof Nt||i instanceof Bt)for(var l=0;l<i.paintVertexAttributes.length;l++)e.push(i.paintVertexAttributes[l].name);else if(i instanceof Ht)for(var f=0;f<re.members.length;f++)e.push(re.members[f].name)}return e},Rt.prototype.getBinderUniforms=function(){var e=[];for(var t in this.binders){var i=this.binders[t];if(i instanceof Ut||i instanceof Xt||i instanceof Bt)for(var l=0,f=i.uniformNames;l<f.length;l+=1)e.push(f[l])}return e},Rt.prototype.getPaintVertexBuffers=function(){return this._buffers},Rt.prototype.getUniforms=function(e,t){var i=[];for(var l in this.binders){var f=this.binders[l];if(f instanceof Ut||f instanceof Xt||f instanceof Bt)for(var m=0,x=f.uniformNames;m<x.length;m+=1){var k=x[m];if(t[k]){var I=f.getBinding(e,t[k],k);i.push({name:k,property:l,binding:I})}}}return i},Rt.prototype.setUniforms=function(e,t,i,l){for(var f=0,m=t;f<m.length;f+=1){var x=m[f],k=x.name,I=x.property;this.binders[I].setUniform(x.binding,l,i.get(I),k)}},Rt.prototype.updatePaintBuffers=function(e){for(var t in this._buffers=[],this.binders){var i=this.binders[t];if(e&&i instanceof Ht){var l=e.fromScale===2?i.zoomInPaintVertexBuffer:i.zoomOutPaintVertexBuffer;l&&this._buffers.push(l)}else(i instanceof Nt||i instanceof Bt)&&i.paintVertexBuffer&&this._buffers.push(i.paintVertexBuffer)}},Rt.prototype.upload=function(e){for(var t in this.binders){var i=this.binders[t];(i instanceof Nt||i instanceof Bt||i instanceof Ht)&&i.upload(e)}this.updatePaintBuffers()},Rt.prototype.destroy=function(){for(var e in this.binders){var t=this.binders[e];(t instanceof Nt||t instanceof Bt||t instanceof Ht)&&t.destroy()}};var Mt=function(e,t,i){i===void 0&&(i=function(){return!0}),this.programConfigurations={};for(var l=0,f=e;l<f.length;l+=1){var m=f[l];this.programConfigurations[m.id]=new Rt(m,t,i)}this.needsUpload=!1,this._featureMap=new fe,this._bufferOffset=0};function Bi(e,t){return{"text-opacity":["opacity"],"icon-opacity":["opacity"],"text-color":["fill_color"],"icon-color":["fill_color"],"text-halo-color":["halo_color"],"icon-halo-color":["halo_color"],"text-halo-blur":["halo_blur"],"icon-halo-blur":["halo_blur"],"text-halo-width":["halo_width"],"icon-halo-width":["halo_width"],"line-gap-width":["gapwidth"],"line-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-extrusion-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"]}[e]||[e.replace(t+"-","").replace(/-/g,"_")]}function ni(e,t,i){var l={color:{source:Go,composite:nl},number:{source:Qa,composite:Go}},f=function(m){return{"line-pattern":{source:za,composite:za},"fill-pattern":{source:za,composite:za},"fill-extrusion-pattern":{source:za,composite:za}}[m]}(e);return f&&f[i]||l[t][i]}Mt.prototype.populatePaintArrays=function(e,t,i,l,f,m){for(var x in this.programConfigurations)this.programConfigurations[x].populatePaintArrays(e,t,l,f,m);t.id!==void 0&&this._featureMap.add(t.id,i,this._bufferOffset,e),this._bufferOffset=e,this.needsUpload=!0},Mt.prototype.updatePaintArrays=function(e,t,i,l){for(var f=0,m=i;f<m.length;f+=1){var x=m[f];this.needsUpload=this.programConfigurations[x.id].updatePaintArrays(e,this._featureMap,t,x,l)||this.needsUpload}},Mt.prototype.get=function(e){return this.programConfigurations[e]},Mt.prototype.upload=function(e){if(this.needsUpload){for(var t in this.programConfigurations)this.programConfigurations[t].upload(e);this.needsUpload=!1}},Mt.prototype.destroy=function(){for(var e in this.programConfigurations)this.programConfigurations[e].destroy()},ft("ConstantBinder",Ut),ft("CrossFadedConstantBinder",Xt),ft("SourceExpressionBinder",Nt),ft("CrossFadedCompositeBinder",Ht),ft("CompositeExpressionBinder",Bt),ft("ProgramConfiguration",Rt,{omit:["_buffers"]}),ft("ProgramConfigurationSet",Mt);var cn=Math.pow(2,14)-1,Ki=-cn-1;function Jr(e){for(var t=8192/e.extent,i=e.loadGeometry(),l=0;l<i.length;l++)for(var f=i[l],m=0;m<f.length;m++){var x=f[m],k=Math.round(x.x*t),I=Math.round(x.y*t);x.x=ve(k,Ki,cn),x.y=ve(I,Ki,cn),(k<x.x||k>x.x+1||I<x.y||I>x.y+1)&&st("Geometry exceeds allowed extent, reduce your vector tile buffer size")}return i}function pi(e,t){return{type:e.type,id:e.id,properties:e.properties,geometry:t?Jr(e):[]}}function Zn(e,t,i,l,f){e.emplaceBack(2*t+(l+1)/2,2*i+(f+1)/2)}var xn=function(e){this.zoom=e.zoom,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map(function(t){return t.id}),this.index=e.index,this.hasPattern=!1,this.layoutVertexArray=new zo,this.indexArray=new Ya,this.segments=new G,this.programConfigurations=new Mt(e.layers,e.zoom),this.stateDependentLayerIds=this.layers.filter(function(t){return t.isStateDependent()}).map(function(t){return t.id})};function $a(e,t){for(var i=0;i<e.length;i++)if(Ta(t,e[i]))return!0;for(var l=0;l<t.length;l++)if(Ta(e,t[l]))return!0;return!!Es(e,t)}function Pn(e,t,i){return!!Ta(e,t)||!!eo(t,e,i)}function ga(e,t){if(e.length===1)return zs(t,e[0]);for(var i=0;i<t.length;i++)for(var l=t[i],f=0;f<l.length;f++)if(Ta(e,l[f]))return!0;for(var m=0;m<e.length;m++)if(zs(t,e[m]))return!0;for(var x=0;x<t.length;x++)if(Es(e,t[x]))return!0;return!1}function aa(e,t,i){if(e.length>1){if(Es(e,t))return!0;for(var l=0;l<t.length;l++)if(eo(t[l],e,i))return!0}for(var f=0;f<e.length;f++)if(eo(e[f],t,i))return!0;return!1}function Es(e,t){if(e.length===0||t.length===0)return!1;for(var i=0;i<e.length-1;i++)for(var l=e[i],f=e[i+1],m=0;m<t.length-1;m++)if(Xo(l,f,t[m],t[m+1]))return!0;return!1}function Xo(e,t,i,l){return At(e,i,l)!==At(t,i,l)&&At(e,t,i)!==At(e,t,l)}function eo(e,t,i){var l=i*i;if(t.length===1)return e.distSqr(t[0])<l;for(var f=1;f<t.length;f++)if(Wo(e,t[f-1],t[f])<l)return!0;return!1}function Wo(e,t,i){var l=t.distSqr(i);if(l===0)return e.distSqr(t);var f=((e.x-t.x)*(i.x-t.x)+(e.y-t.y)*(i.y-t.y))/l;return e.distSqr(f<0?t:f>1?i:i.sub(t)._mult(f)._add(t))}function zs(e,t){for(var i,l,f,m=!1,x=0;x<e.length;x++)for(var k=0,I=(i=e[x]).length-1;k<i.length;I=k++)(l=i[k]).y>t.y!=(f=i[I]).y>t.y&&t.x<(f.x-l.x)*(t.y-l.y)/(f.y-l.y)+l.x&&(m=!m);return m}function Ta(e,t){for(var i=!1,l=0,f=e.length-1;l<e.length;f=l++){var m=e[l],x=e[f];m.y>t.y!=x.y>t.y&&t.x<(x.x-m.x)*(t.y-m.y)/(x.y-m.y)+m.x&&(i=!i)}return i}function Ts(e,t,i){var l=i[0],f=i[2];if(e.x<l.x&&t.x<l.x||e.x>f.x&&t.x>f.x||e.y<l.y&&t.y<l.y||e.y>f.y&&t.y>f.y)return!1;var m=At(e,t,i[0]);return m!==At(e,t,i[1])||m!==At(e,t,i[2])||m!==At(e,t,i[3])}function Ia(e,t,i){var l=t.paint.get(e).value;return l.kind==="constant"?l.value:i.programConfigurations.get(t.id).getMaxValue(e)}function Oi(e){return Math.sqrt(e[0]*e[0]+e[1]*e[1])}function La(e,t,i,l,f){if(!t[0]&&!t[1])return e;var m=F.convert(t)._mult(f);i==="viewport"&&m._rotate(-l);for(var x=[],k=0;k<e.length;k++)x.push(e[k].sub(m));return x}xn.prototype.populate=function(e,t,i){var l=this.layers[0],f=[],m=null;l.type==="circle"&&(m=l.layout.get("circle-sort-key"));for(var x=0,k=e;x<k.length;x+=1){var I=k[x],A=I.feature,M=I.id,B=I.index,U=I.sourceLayerIndex,j=this.layers[0]._featureFilter.needGeometry,J=pi(A,j);if(this.layers[0]._featureFilter.filter(new ar(this.zoom),J,i)){var $=m?m.evaluate(J,{},i):void 0,ce={id:M,properties:A.properties,type:A.type,sourceLayerIndex:U,index:B,geometry:j?J.geometry:Jr(A),patterns:{},sortKey:$};f.push(ce)}}m&&f.sort(function(Je,wt){return Je.sortKey-wt.sortKey});for(var ie=0,ye=f;ie<ye.length;ie+=1){var be=ye[ie],we=be.geometry,ke=be.index,Ce=be.sourceLayerIndex,Ve=e[ke].feature;this.addFeature(be,we,ke,i),t.featureIndex.insert(Ve,we,ke,Ce,this.index)}},xn.prototype.update=function(e,t,i){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(e,t,this.stateDependentLayers,i)},xn.prototype.isEmpty=function(){return this.layoutVertexArray.length===0},xn.prototype.uploadPending=function(){return!this.uploaded||this.programConfigurations.needsUpload},xn.prototype.upload=function(e){this.uploaded||(this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,Z),this.indexBuffer=e.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(e),this.uploaded=!0},xn.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())},xn.prototype.addFeature=function(e,t,i,l){for(var f=0,m=t;f<m.length;f+=1)for(var x=0,k=m[f];x<k.length;x+=1){var I=k[x],A=I.x,M=I.y;if(!(A<0||A>=8192||M<0||M>=8192)){var B=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray,e.sortKey),U=B.vertexLength;Zn(this.layoutVertexArray,A,M,-1,-1),Zn(this.layoutVertexArray,A,M,1,-1),Zn(this.layoutVertexArray,A,M,1,1),Zn(this.layoutVertexArray,A,M,-1,1),this.indexArray.emplaceBack(U,U+1,U+2),this.indexArray.emplaceBack(U,U+3,U+2),B.vertexLength+=4,B.primitiveLength+=2}}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,e,i,{},l)},ft("CircleBucket",xn,{omit:["layers"]});var to=new en({"circle-sort-key":new mt(q.layout_circle["circle-sort-key"])}),Io={paint:new en({"circle-radius":new mt(q.paint_circle["circle-radius"]),"circle-color":new mt(q.paint_circle["circle-color"]),"circle-blur":new mt(q.paint_circle["circle-blur"]),"circle-opacity":new mt(q.paint_circle["circle-opacity"]),"circle-translate":new kt(q.paint_circle["circle-translate"]),"circle-translate-anchor":new kt(q.paint_circle["circle-translate-anchor"]),"circle-pitch-scale":new kt(q.paint_circle["circle-pitch-scale"]),"circle-pitch-alignment":new kt(q.paint_circle["circle-pitch-alignment"]),"circle-stroke-width":new mt(q.paint_circle["circle-stroke-width"]),"circle-stroke-color":new mt(q.paint_circle["circle-stroke-color"]),"circle-stroke-opacity":new mt(q.paint_circle["circle-stroke-opacity"])}),layout:to},wr=typeof Float32Array<"u"?Float32Array:Array;function ea(e){return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}function Cn(e,t,i){var l=t[0],f=t[1],m=t[2],x=t[3],k=t[4],I=t[5],A=t[6],M=t[7],B=t[8],U=t[9],j=t[10],J=t[11],$=t[12],ce=t[13],ie=t[14],ye=t[15],be=i[0],we=i[1],ke=i[2],Ce=i[3];return e[0]=be*l+we*k+ke*B+Ce*$,e[1]=be*f+we*I+ke*U+Ce*ce,e[2]=be*m+we*A+ke*j+Ce*ie,e[3]=be*x+we*M+ke*J+Ce*ye,e[4]=(be=i[4])*l+(we=i[5])*k+(ke=i[6])*B+(Ce=i[7])*$,e[5]=be*f+we*I+ke*U+Ce*ce,e[6]=be*m+we*A+ke*j+Ce*ie,e[7]=be*x+we*M+ke*J+Ce*ye,e[8]=(be=i[8])*l+(we=i[9])*k+(ke=i[10])*B+(Ce=i[11])*$,e[9]=be*f+we*I+ke*U+Ce*ce,e[10]=be*m+we*A+ke*j+Ce*ie,e[11]=be*x+we*M+ke*J+Ce*ye,e[12]=(be=i[12])*l+(we=i[13])*k+(ke=i[14])*B+(Ce=i[15])*$,e[13]=be*f+we*I+ke*U+Ce*ce,e[14]=be*m+we*A+ke*j+Ce*ie,e[15]=be*x+we*M+ke*J+Ce*ye,e}Math.hypot||(Math.hypot=function(){for(var e=arguments,t=0,i=arguments.length;i--;)t+=e[i]*e[i];return Math.sqrt(t)});var Ao,Wh=Cn;function al(e,t,i){var l=t[0],f=t[1],m=t[2],x=t[3];return e[0]=i[0]*l+i[4]*f+i[8]*m+i[12]*x,e[1]=i[1]*l+i[5]*f+i[9]*m+i[13]*x,e[2]=i[2]*l+i[6]*f+i[10]*m+i[14]*x,e[3]=i[3]*l+i[7]*f+i[11]*m+i[15]*x,e}Ao=new wr(3),wr!=Float32Array&&(Ao[0]=0,Ao[1]=0,Ao[2]=0),function(){var e=new wr(4);wr!=Float32Array&&(e[0]=0,e[1]=0,e[2]=0,e[3]=0)}();var Yh=(function(){var e=new wr(2);wr!=Float32Array&&(e[0]=0,e[1]=0)}(),function(e){function t(i){e.call(this,i,Io)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.createBucket=function(i){return new xn(i)},t.prototype.queryRadius=function(i){var l=i;return Ia("circle-radius",this,l)+Ia("circle-stroke-width",this,l)+Oi(this.paint.get("circle-translate"))},t.prototype.queryIntersectsFeature=function(i,l,f,m,x,k,I,A){for(var M=La(i,this.paint.get("circle-translate"),this.paint.get("circle-translate-anchor"),k.angle,I),B=this.paint.get("circle-radius").evaluate(l,f)+this.paint.get("circle-stroke-width").evaluate(l,f),U=this.paint.get("circle-pitch-alignment")==="map",j=U?M:function(Ve,Je){return Ve.map(function(wt){return Is(wt,Je)})}(M,A),J=U?B*I:B,$=0,ce=m;$<ce.length;$+=1)for(var ie=0,ye=ce[$];ie<ye.length;ie+=1){var be=ye[ie],we=U?be:Is(be,A),ke=J,Ce=al([],[be.x,be.y,0,1],A);if(this.paint.get("circle-pitch-scale")==="viewport"&&this.paint.get("circle-pitch-alignment")==="map"?ke*=Ce[3]/k.cameraToCenterDistance:this.paint.get("circle-pitch-scale")==="map"&&this.paint.get("circle-pitch-alignment")==="viewport"&&(ke*=k.cameraToCenterDistance/Ce[3]),Pn(j,we,ke))return!0}return!1},t}(Ea));function Is(e,t){var i=al([],[e.x,e.y,0,1],t);return new F(i[0]/i[3],i[1]/i[3])}var Ac=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t}(xn);function Yo(e,t,i,l){var f=t.width,m=t.height;if(l){if(l instanceof Uint8ClampedArray)l=new Uint8Array(l.buffer);else if(l.length!==f*m*i)throw new RangeError("mismatched image size")}else l=new Uint8Array(f*m*i);return e.width=f,e.height=m,e.data=l,e}function ol(e,t,i){var l=t.width,f=t.height;if(l!==e.width||f!==e.height){var m=Yo({},{width:l,height:f},i);Jh(e,m,{x:0,y:0},{x:0,y:0},{width:Math.min(e.width,l),height:Math.min(e.height,f)},i),e.width=l,e.height=f,e.data=m.data}}function Jh(e,t,i,l,f,m){if(f.width===0||f.height===0)return t;if(f.width>e.width||f.height>e.height||i.x>e.width-f.width||i.y>e.height-f.height)throw new RangeError("out of range source coordinates for image copy");if(f.width>t.width||f.height>t.height||l.x>t.width-f.width||l.y>t.height-f.height)throw new RangeError("out of range destination coordinates for image copy");for(var x=e.data,k=t.data,I=0;I<f.height;I++)for(var A=((i.y+I)*e.width+i.x)*m,M=((l.y+I)*t.width+l.x)*m,B=0;B<f.width*m;B++)k[M+B]=x[A+B];return t}ft("HeatmapBucket",Ac,{omit:["layers"]});var As=function(e,t){Yo(this,e,1,t)};As.prototype.resize=function(e){ol(this,e,1)},As.prototype.clone=function(){return new As({width:this.width,height:this.height},new Uint8Array(this.data))},As.copy=function(e,t,i,l,f){Jh(e,t,i,l,f,1)};var Gn=function(e,t){Yo(this,e,4,t)};Gn.prototype.resize=function(e){ol(this,e,4)},Gn.prototype.replace=function(e,t){t?this.data.set(e):this.data=e instanceof Uint8ClampedArray?new Uint8Array(e.buffer):e},Gn.prototype.clone=function(){return new Gn({width:this.width,height:this.height},new Uint8Array(this.data))},Gn.copy=function(e,t,i,l,f){Jh(e,t,i,l,f,4)},ft("AlphaImage",As),ft("RGBAImage",Gn);var Ty={paint:new en({"heatmap-radius":new mt(q.paint_heatmap["heatmap-radius"]),"heatmap-weight":new mt(q.paint_heatmap["heatmap-weight"]),"heatmap-intensity":new kt(q.paint_heatmap["heatmap-intensity"]),"heatmap-color":new ya(q.paint_heatmap["heatmap-color"]),"heatmap-opacity":new kt(q.paint_heatmap["heatmap-opacity"])})};function Jp(e){var t={},i=e.resolution||256,l=e.clips?e.clips.length:1,f=e.image||new Gn({width:i,height:l}),m=function(J,$,ce){t[e.evaluationKey]=ce;var ie=e.expression.evaluate(t);f.data[J+$+0]=Math.floor(255*ie.r/ie.a),f.data[J+$+1]=Math.floor(255*ie.g/ie.a),f.data[J+$+2]=Math.floor(255*ie.b/ie.a),f.data[J+$+3]=Math.floor(255*ie.a)};if(e.clips)for(var x=0,k=0;x<l;++x,k+=4*i)for(var I=0,A=0;I<i;I++,A+=4){var M=I/(i-1),B=e.clips[x];m(k,A,B.start*(1-M)+B.end*M)}else for(var U=0,j=0;U<i;U++,j+=4)m(0,j,U/(i-1));return f}var Iy=function(e){function t(i){e.call(this,i,Ty),this._updateColorRamp()}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.createBucket=function(i){return new Ac(i)},t.prototype._handleSpecialPaintPropertyUpdate=function(i){i==="heatmap-color"&&this._updateColorRamp()},t.prototype._updateColorRamp=function(){this.colorRamp=Jp({expression:this._transitionablePaint._values["heatmap-color"].value.expression,evaluationKey:"heatmapDensity",image:this.colorRamp}),this.colorRampTexture=null},t.prototype.resize=function(){this.heatmapFbo&&(this.heatmapFbo.destroy(),this.heatmapFbo=null)},t.prototype.queryRadius=function(){return 0},t.prototype.queryIntersectsFeature=function(){return!1},t.prototype.hasOffscreenPass=function(){return this.paint.get("heatmap-opacity")!==0&&this.visibility!=="none"},t}(Ea),Ay={paint:new en({"hillshade-illumination-direction":new kt(q.paint_hillshade["hillshade-illumination-direction"]),"hillshade-illumination-anchor":new kt(q.paint_hillshade["hillshade-illumination-anchor"]),"hillshade-exaggeration":new kt(q.paint_hillshade["hillshade-exaggeration"]),"hillshade-shadow-color":new kt(q.paint_hillshade["hillshade-shadow-color"]),"hillshade-highlight-color":new kt(q.paint_hillshade["hillshade-highlight-color"]),"hillshade-accent-color":new kt(q.paint_hillshade["hillshade-accent-color"])})},Py=function(e){function t(i){e.call(this,i,Ay)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.hasOffscreenPass=function(){return this.paint.get("hillshade-exaggeration")!==0&&this.visibility!=="none"},t}(Ea),Cy=Gi([{name:"a_pos",components:2,type:"Int16"}],4).members,Qh=Pc,My=Pc;function Pc(e,t,i){i=i||2;var l,f,m,x,k,I,A,M=t&&t.length,B=M?t[0]*i:e.length,U=Qp(e,0,B,i,!0),j=[];if(!U||U.next===U.prev)return j;if(M&&(U=function($,ce,ie,ye){var be,we,ke,Ce=[];for(be=0,we=ce.length;be<we;be++)(ke=Qp($,ce[be]*ye,be<we-1?ce[be+1]*ye:$.length,ye,!1))===ke.next&&(ke.steiner=!0),Ce.push(Uy(ke));for(Ce.sort(Oy),be=0;be<Ce.length;be++)Fy(Ce[be],ie),ie=Jo(ie,ie.next);return ie}(e,t,U,i)),e.length>80*i){l=m=e[0],f=x=e[1];for(var J=i;J<B;J+=i)(k=e[J])<l&&(l=k),(I=e[J+1])<f&&(f=I),k>m&&(m=k),I>x&&(x=I);A=(A=Math.max(m-l,x-f))!==0?1/A:0}return cu(U,j,i,l,f,A),j}function Qp(e,t,i,l,f){var m,x;if(f===tp(e,t,i,l)>0)for(m=t;m<i;m+=l)x=tf(m,e[m],e[m+1],x);else for(m=i-l;m>=t;m-=l)x=tf(m,e[m],e[m+1],x);return x&&Cc(x,x.next)&&(pu(x),x=x.next),x}function Jo(e,t){if(!e)return e;t||(t=e);var i,l=e;do if(i=!1,l.steiner||!Cc(l,l.next)&&Ii(l.prev,l,l.next)!==0)l=l.next;else{if(pu(l),(l=t=l.prev)===l.next)break;i=!0}while(i||l!==t);return t}function cu(e,t,i,l,f,m,x){if(e){!x&&m&&function(M,B,U,j){var J=M;do J.z===null&&(J.z=$h(J.x,J.y,B,U,j)),J.prevZ=J.prev,J.nextZ=J.next,J=J.next;while(J!==M);J.prevZ.nextZ=null,J.prevZ=null,function($){var ce,ie,ye,be,we,ke,Ce,Ve,Je=1;do{for(ie=$,$=null,we=null,ke=0;ie;){for(ke++,ye=ie,Ce=0,ce=0;ce<Je&&(Ce++,ye=ye.nextZ);ce++);for(Ve=Je;Ce>0||Ve>0&&ye;)Ce!==0&&(Ve===0||!ye||ie.z<=ye.z)?(be=ie,ie=ie.nextZ,Ce--):(be=ye,ye=ye.nextZ,Ve--),we?we.nextZ=be:$=be,be.prevZ=we,we=be;ie=ye}we.nextZ=null,Je*=2}while(ke>1)}(J)}(e,l,f,m);for(var k,I,A=e;e.prev!==e.next;)if(k=e.prev,I=e.next,m?Ly(e,l,f,m):Dy(e))t.push(k.i/i),t.push(e.i/i),t.push(I.i/i),pu(e),e=I.next,A=I.next;else if((e=I)===A){x?x===1?cu(e=Ry(Jo(e),t,i),t,i,l,f,m,2):x===2&&By(e,t,i,l,f,m):cu(Jo(e),t,i,l,f,m,1);break}}}function Dy(e){var t=e.prev,i=e,l=e.next;if(Ii(t,i,l)>=0)return!1;for(var f=e.next.next;f!==e.prev;){if(sl(t.x,t.y,i.x,i.y,l.x,l.y,f.x,f.y)&&Ii(f.prev,f,f.next)>=0)return!1;f=f.next}return!0}function Ly(e,t,i,l){var f=e.prev,m=e,x=e.next;if(Ii(f,m,x)>=0)return!1;for(var k=f.x>m.x?f.x>x.x?f.x:x.x:m.x>x.x?m.x:x.x,I=f.y>m.y?f.y>x.y?f.y:x.y:m.y>x.y?m.y:x.y,A=$h(f.x<m.x?f.x<x.x?f.x:x.x:m.x<x.x?m.x:x.x,f.y<m.y?f.y<x.y?f.y:x.y:m.y<x.y?m.y:x.y,t,i,l),M=$h(k,I,t,i,l),B=e.prevZ,U=e.nextZ;B&&B.z>=A&&U&&U.z<=M;){if(B!==e.prev&&B!==e.next&&sl(f.x,f.y,m.x,m.y,x.x,x.y,B.x,B.y)&&Ii(B.prev,B,B.next)>=0||(B=B.prevZ,U!==e.prev&&U!==e.next&&sl(f.x,f.y,m.x,m.y,x.x,x.y,U.x,U.y)&&Ii(U.prev,U,U.next)>=0))return!1;U=U.nextZ}for(;B&&B.z>=A;){if(B!==e.prev&&B!==e.next&&sl(f.x,f.y,m.x,m.y,x.x,x.y,B.x,B.y)&&Ii(B.prev,B,B.next)>=0)return!1;B=B.prevZ}for(;U&&U.z<=M;){if(U!==e.prev&&U!==e.next&&sl(f.x,f.y,m.x,m.y,x.x,x.y,U.x,U.y)&&Ii(U.prev,U,U.next)>=0)return!1;U=U.nextZ}return!0}function Ry(e,t,i){var l=e;do{var f=l.prev,m=l.next.next;!Cc(f,m)&&$p(f,l,l.next,m)&&hu(f,m)&&hu(m,f)&&(t.push(f.i/i),t.push(l.i/i),t.push(m.i/i),pu(l),pu(l.next),l=e=m),l=l.next}while(l!==e);return Jo(l)}function By(e,t,i,l,f,m){var x=e;do{for(var k=x.next.next;k!==x.prev;){if(x.i!==k.i&&Vy(x,k)){var I=ef(x,k);return x=Jo(x,x.next),I=Jo(I,I.next),cu(x,t,i,l,f,m),void cu(I,t,i,l,f,m)}k=k.next}x=x.next}while(x!==e)}function Oy(e,t){return e.x-t.x}function Fy(e,t){if(t=function(l,f){var m,x=f,k=l.x,I=l.y,A=-1/0;do{if(I<=x.y&&I>=x.next.y&&x.next.y!==x.y){var M=x.x+(I-x.y)*(x.next.x-x.x)/(x.next.y-x.y);if(M<=k&&M>A){if(A=M,M===k){if(I===x.y)return x;if(I===x.next.y)return x.next}m=x.x<x.next.x?x:x.next}}x=x.next}while(x!==f);if(!m)return null;if(k===A)return m;var B,U=m,j=m.x,J=m.y,$=1/0;x=m;do k>=x.x&&x.x>=j&&k!==x.x&&sl(I<J?k:A,I,j,J,I<J?A:k,I,x.x,x.y)&&(B=Math.abs(I-x.y)/(k-x.x),hu(x,l)&&(B<$||B===$&&(x.x>m.x||x.x===m.x&&Ny(m,x)))&&(m=x,$=B)),x=x.next;while(x!==U);return m}(e,t)){var i=ef(t,e);Jo(t,t.next),Jo(i,i.next)}}function Ny(e,t){return Ii(e.prev,e,t.prev)<0&&Ii(t.next,e,e.next)<0}function $h(e,t,i,l,f){return(e=1431655765&((e=858993459&((e=252645135&((e=16711935&((e=32767*(e-i)*f)|e<<8))|e<<4))|e<<2))|e<<1))|(t=1431655765&((t=858993459&((t=252645135&((t=16711935&((t=32767*(t-l)*f)|t<<8))|t<<4))|t<<2))|t<<1))<<1}function Uy(e){var t=e,i=e;do(t.x<i.x||t.x===i.x&&t.y<i.y)&&(i=t),t=t.next;while(t!==e);return i}function sl(e,t,i,l,f,m,x,k){return(f-x)*(t-k)-(e-x)*(m-k)>=0&&(e-x)*(l-k)-(i-x)*(t-k)>=0&&(i-x)*(m-k)-(f-x)*(l-k)>=0}function Vy(e,t){return e.next.i!==t.i&&e.prev.i!==t.i&&!function(i,l){var f=i;do{if(f.i!==i.i&&f.next.i!==i.i&&f.i!==l.i&&f.next.i!==l.i&&$p(f,f.next,i,l))return!0;f=f.next}while(f!==i);return!1}(e,t)&&(hu(e,t)&&hu(t,e)&&function(i,l){var f=i,m=!1,x=(i.x+l.x)/2,k=(i.y+l.y)/2;do f.y>k!=f.next.y>k&&f.next.y!==f.y&&x<(f.next.x-f.x)*(k-f.y)/(f.next.y-f.y)+f.x&&(m=!m),f=f.next;while(f!==i);return m}(e,t)&&(Ii(e.prev,e,t.prev)||Ii(e,t.prev,t))||Cc(e,t)&&Ii(e.prev,e,e.next)>0&&Ii(t.prev,t,t.next)>0)}function Ii(e,t,i){return(t.y-e.y)*(i.x-t.x)-(t.x-e.x)*(i.y-t.y)}function Cc(e,t){return e.x===t.x&&e.y===t.y}function $p(e,t,i,l){var f=Dc(Ii(e,t,i)),m=Dc(Ii(e,t,l)),x=Dc(Ii(i,l,e)),k=Dc(Ii(i,l,t));return f!==m&&x!==k||!(f!==0||!Mc(e,i,t))||!(m!==0||!Mc(e,l,t))||!(x!==0||!Mc(i,e,l))||!(k!==0||!Mc(i,t,l))}function Mc(e,t,i){return t.x<=Math.max(e.x,i.x)&&t.x>=Math.min(e.x,i.x)&&t.y<=Math.max(e.y,i.y)&&t.y>=Math.min(e.y,i.y)}function Dc(e){return e>0?1:e<0?-1:0}function hu(e,t){return Ii(e.prev,e,e.next)<0?Ii(e,t,e.next)>=0&&Ii(e,e.prev,t)>=0:Ii(e,t,e.prev)<0||Ii(e,e.next,t)<0}function ef(e,t){var i=new ep(e.i,e.x,e.y),l=new ep(t.i,t.x,t.y),f=e.next,m=t.prev;return e.next=t,t.prev=e,i.next=f,f.prev=i,l.next=i,i.prev=l,m.next=l,l.prev=m,l}function tf(e,t,i,l){var f=new ep(e,t,i);return l?(f.next=l.next,f.prev=l,l.next.prev=f,l.next=f):(f.prev=f,f.next=f),f}function pu(e){e.next.prev=e.prev,e.prev.next=e.next,e.prevZ&&(e.prevZ.nextZ=e.nextZ),e.nextZ&&(e.nextZ.prevZ=e.prevZ)}function ep(e,t,i){this.i=e,this.x=t,this.y=i,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}function tp(e,t,i,l){for(var f=0,m=t,x=i-l;m<i;m+=l)f+=(e[x]-e[m])*(e[m+1]+e[x+1]),x=m;return f}function qy(e,t,i,l,f){(function m(x,k,I,A,M){for(;A>I;){if(A-I>600){var B=A-I+1,U=k-I+1,j=Math.log(B),J=.5*Math.exp(2*j/3),$=.5*Math.sqrt(j*J*(B-J)/B)*(U-B/2<0?-1:1);m(x,k,Math.max(I,Math.floor(k-U*J/B+$)),Math.min(A,Math.floor(k+(B-U)*J/B+$)),M)}var ce=x[k],ie=I,ye=A;for(fu(x,I,k),M(x[A],ce)>0&&fu(x,I,A);ie<ye;){for(fu(x,ie,ye),ie++,ye--;M(x[ie],ce)<0;)ie++;for(;M(x[ye],ce)>0;)ye--}M(x[I],ce)===0?fu(x,I,ye):fu(x,++ye,A),ye<=k&&(I=ye+1),k<=ye&&(A=ye-1)}})(e,t,i||0,l||e.length-1,f||jy)}function fu(e,t,i){var l=e[t];e[t]=e[i],e[i]=l}function jy(e,t){return e<t?-1:e>t?1:0}function rp(e,t){var i=e.length;if(i<=1)return[e];for(var l,f,m=[],x=0;x<i;x++){var k=Fe(e[x]);k!==0&&(e[x].area=Math.abs(k),f===void 0&&(f=k<0),f===k<0?(l&&m.push(l),l=[e[x]]):l.push(e[x]))}if(l&&m.push(l),t>1)for(var I=0;I<m.length;I++)m[I].length<=t||(qy(m[I],t,1,m[I].length-1,Zy),m[I]=m[I].slice(0,t));return m}function Zy(e,t){return t.area-e.area}function ip(e,t,i){for(var l=i.patternDependencies,f=!1,m=0,x=t;m<x.length;m+=1){var k=x[m].paint.get(e+"-pattern");k.isConstant()||(f=!0);var I=k.constantOr(null);I&&(f=!0,l[I.to]=!0,l[I.from]=!0)}return f}function np(e,t,i,l,f){for(var m=f.patternDependencies,x=0,k=t;x<k.length;x+=1){var I=k[x],A=I.paint.get(e+"-pattern").value;if(A.kind!=="constant"){var M=A.evaluate({zoom:l-1},i,{},f.availableImages),B=A.evaluate({zoom:l},i,{},f.availableImages),U=A.evaluate({zoom:l+1},i,{},f.availableImages);B=B&&B.name?B.name:B,U=U&&U.name?U.name:U,m[M=M&&M.name?M.name:M]=!0,m[B]=!0,m[U]=!0,i.patterns[I.id]={min:M,mid:B,max:U}}}return i}Pc.deviation=function(e,t,i,l){var f=t&&t.length,m=Math.abs(tp(e,0,f?t[0]*i:e.length,i));if(f)for(var x=0,k=t.length;x<k;x++)m-=Math.abs(tp(e,t[x]*i,x<k-1?t[x+1]*i:e.length,i));var I=0;for(x=0;x<l.length;x+=3){var A=l[x]*i,M=l[x+1]*i,B=l[x+2]*i;I+=Math.abs((e[A]-e[B])*(e[M+1]-e[A+1])-(e[A]-e[M])*(e[B+1]-e[A+1]))}return m===0&&I===0?0:Math.abs((I-m)/m)},Pc.flatten=function(e){for(var t=e[0][0].length,i={vertices:[],holes:[],dimensions:t},l=0,f=0;f<e.length;f++){for(var m=0;m<e[f].length;m++)for(var x=0;x<t;x++)i.vertices.push(e[f][m][x]);f>0&&i.holes.push(l+=e[f-1].length)}return i},Qh.default=My;var Ra=function(e){this.zoom=e.zoom,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map(function(t){return t.id}),this.index=e.index,this.hasPattern=!1,this.patternFeatures=[],this.layoutVertexArray=new zo,this.indexArray=new Ya,this.indexArray2=new ks,this.programConfigurations=new Mt(e.layers,e.zoom),this.segments=new G,this.segments2=new G,this.stateDependentLayerIds=this.layers.filter(function(t){return t.isStateDependent()}).map(function(t){return t.id})};Ra.prototype.populate=function(e,t,i){this.hasPattern=ip("fill",this.layers,t);for(var l=this.layers[0].layout.get("fill-sort-key"),f=[],m=0,x=e;m<x.length;m+=1){var k=x[m],I=k.feature,A=k.id,M=k.index,B=k.sourceLayerIndex,U=this.layers[0]._featureFilter.needGeometry,j=pi(I,U);if(this.layers[0]._featureFilter.filter(new ar(this.zoom),j,i)){var J=l?l.evaluate(j,{},i,t.availableImages):void 0,$={id:A,properties:I.properties,type:I.type,sourceLayerIndex:B,index:M,geometry:U?j.geometry:Jr(I),patterns:{},sortKey:J};f.push($)}}l&&f.sort(function(Ve,Je){return Ve.sortKey-Je.sortKey});for(var ce=0,ie=f;ce<ie.length;ce+=1){var ye=ie[ce],be=ye.geometry,we=ye.index,ke=ye.sourceLayerIndex;if(this.hasPattern){var Ce=np("fill",this.layers,ye,this.zoom,t);this.patternFeatures.push(Ce)}else this.addFeature(ye,be,we,i,{});t.featureIndex.insert(e[we].feature,be,we,ke,this.index)}},Ra.prototype.update=function(e,t,i){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(e,t,this.stateDependentLayers,i)},Ra.prototype.addFeatures=function(e,t,i){for(var l=0,f=this.patternFeatures;l<f.length;l+=1){var m=f[l];this.addFeature(m,m.geometry,m.index,t,i)}},Ra.prototype.isEmpty=function(){return this.layoutVertexArray.length===0},Ra.prototype.uploadPending=function(){return!this.uploaded||this.programConfigurations.needsUpload},Ra.prototype.upload=function(e){this.uploaded||(this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,Cy),this.indexBuffer=e.createIndexBuffer(this.indexArray),this.indexBuffer2=e.createIndexBuffer(this.indexArray2)),this.programConfigurations.upload(e),this.uploaded=!0},Ra.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.indexBuffer2.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.segments2.destroy())},Ra.prototype.addFeature=function(e,t,i,l,f){for(var m=0,x=rp(t,500);m<x.length;m+=1){for(var k=x[m],I=0,A=0,M=k;A<M.length;A+=1)I+=M[A].length;for(var B=this.segments.prepareSegment(I,this.layoutVertexArray,this.indexArray),U=B.vertexLength,j=[],J=[],$=0,ce=k;$<ce.length;$+=1){var ie=ce[$];if(ie.length!==0){ie!==k[0]&&J.push(j.length/2);var ye=this.segments2.prepareSegment(ie.length,this.layoutVertexArray,this.indexArray2),be=ye.vertexLength;this.layoutVertexArray.emplaceBack(ie[0].x,ie[0].y),this.indexArray2.emplaceBack(be+ie.length-1,be),j.push(ie[0].x),j.push(ie[0].y);for(var we=1;we<ie.length;we++)this.layoutVertexArray.emplaceBack(ie[we].x,ie[we].y),this.indexArray2.emplaceBack(be+we-1,be+we),j.push(ie[we].x),j.push(ie[we].y);ye.vertexLength+=ie.length,ye.primitiveLength+=ie.length}}for(var ke=Qh(j,J),Ce=0;Ce<ke.length;Ce+=3)this.indexArray.emplaceBack(U+ke[Ce],U+ke[Ce+1],U+ke[Ce+2]);B.vertexLength+=I,B.primitiveLength+=ke.length/3}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,e,i,f,l)},ft("FillBucket",Ra,{omit:["layers","patternFeatures"]});var Gy=new en({"fill-sort-key":new mt(q.layout_fill["fill-sort-key"])}),Ky={paint:new en({"fill-antialias":new kt(q.paint_fill["fill-antialias"]),"fill-opacity":new mt(q.paint_fill["fill-opacity"]),"fill-color":new mt(q.paint_fill["fill-color"]),"fill-outline-color":new mt(q.paint_fill["fill-outline-color"]),"fill-translate":new kt(q.paint_fill["fill-translate"]),"fill-translate-anchor":new kt(q.paint_fill["fill-translate-anchor"]),"fill-pattern":new el(q.paint_fill["fill-pattern"])}),layout:Gy},Hy=function(e){function t(i){e.call(this,i,Ky)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.recalculate=function(i,l){e.prototype.recalculate.call(this,i,l);var f=this.paint._values["fill-outline-color"];f.value.kind==="constant"&&f.value.value===void 0&&(this.paint._values["fill-outline-color"]=this.paint._values["fill-color"])},t.prototype.createBucket=function(i){return new Ra(i)},t.prototype.queryRadius=function(){return Oi(this.paint.get("fill-translate"))},t.prototype.queryIntersectsFeature=function(i,l,f,m,x,k,I){return ga(La(i,this.paint.get("fill-translate"),this.paint.get("fill-translate-anchor"),k.angle,I),m)},t.prototype.isTileClipped=function(){return!0},t}(Ea),Xy=Gi([{name:"a_pos",components:2,type:"Int16"},{name:"a_normal_ed",components:4,type:"Int16"}],4).members,rf=ll;function ll(e,t,i,l,f){this.properties={},this.extent=i,this.type=0,this._pbf=e,this._geometry=-1,this._keys=l,this._values=f,e.readFields(Wy,this,t)}function Wy(e,t,i){e==1?t.id=i.readVarint():e==2?function(l,f){for(var m=l.readVarint()+l.pos;l.pos<m;){var x=f._keys[l.readVarint()],k=f._values[l.readVarint()];f.properties[x]=k}}(i,t):e==3?t.type=i.readVarint():e==4&&(t._geometry=i.pos)}function Yy(e){for(var t,i,l=0,f=0,m=e.length,x=m-1;f<m;x=f++)l+=((i=e[x]).x-(t=e[f]).x)*(t.y+i.y);return l}ll.types=["Unknown","Point","LineString","Polygon"],ll.prototype.loadGeometry=function(){var e=this._pbf;e.pos=this._geometry;for(var t,i=e.readVarint()+e.pos,l=1,f=0,m=0,x=0,k=[];e.pos<i;){if(f<=0){var I=e.readVarint();l=7&I,f=I>>3}if(f--,l===1||l===2)m+=e.readSVarint(),x+=e.readSVarint(),l===1&&(t&&k.push(t),t=[]),t.push(new F(m,x));else{if(l!==7)throw new Error("unknown command "+l);t&&t.push(t[0].clone())}}return t&&k.push(t),k},ll.prototype.bbox=function(){var e=this._pbf;e.pos=this._geometry;for(var t=e.readVarint()+e.pos,i=1,l=0,f=0,m=0,x=1/0,k=-1/0,I=1/0,A=-1/0;e.pos<t;){if(l<=0){var M=e.readVarint();i=7&M,l=M>>3}if(l--,i===1||i===2)(f+=e.readSVarint())<x&&(x=f),f>k&&(k=f),(m+=e.readSVarint())<I&&(I=m),m>A&&(A=m);else if(i!==7)throw new Error("unknown command "+i)}return[x,I,k,A]},ll.prototype.toGeoJSON=function(e,t,i){var l,f,m=this.extent*Math.pow(2,i),x=this.extent*e,k=this.extent*t,I=this.loadGeometry(),A=ll.types[this.type];function M(j){for(var J=0;J<j.length;J++){var $=j[J];j[J]=[360*($.x+x)/m-180,360/Math.PI*Math.atan(Math.exp((180-360*($.y+k)/m)*Math.PI/180))-90]}}switch(this.type){case 1:var B=[];for(l=0;l<I.length;l++)B[l]=I[l][0];M(I=B);break;case 2:for(l=0;l<I.length;l++)M(I[l]);break;case 3:for(I=function(j){var J=j.length;if(J<=1)return[j];for(var $,ce,ie=[],ye=0;ye<J;ye++){var be=Yy(j[ye]);be!==0&&(ce===void 0&&(ce=be<0),ce===be<0?($&&ie.push($),$=[j[ye]]):$.push(j[ye]))}return $&&ie.push($),ie}(I),l=0;l<I.length;l++)for(f=0;f<I[l].length;f++)M(I[l][f])}I.length===1?I=I[0]:A="Multi"+A;var U={type:"Feature",geometry:{type:A,coordinates:I},properties:this.properties};return"id"in this&&(U.id=this.id),U};var nf=af;function af(e,t){this.version=1,this.name=null,this.extent=4096,this.length=0,this._pbf=e,this._keys=[],this._values=[],this._features=[],e.readFields(Jy,this,t),this.length=this._features.length}function Jy(e,t,i){e===15?t.version=i.readVarint():e===1?t.name=i.readString():e===5?t.extent=i.readVarint():e===2?t._features.push(i.pos):e===3?t._keys.push(i.readString()):e===4&&t._values.push(function(l){for(var f=null,m=l.readVarint()+l.pos;l.pos<m;){var x=l.readVarint()>>3;f=x===1?l.readString():x===2?l.readFloat():x===3?l.readDouble():x===4?l.readVarint64():x===5?l.readVarint():x===6?l.readSVarint():x===7?l.readBoolean():null}return f}(i))}function Qy(e,t,i){if(e===3){var l=new nf(i,i.readVarint()+i.pos);l.length&&(t[l.name]=l)}}af.prototype.feature=function(e){if(e<0||e>=this._features.length)throw new Error("feature index out of bounds");this._pbf.pos=this._features[e];var t=this._pbf.readVarint()+this._pbf.pos;return new rf(this._pbf,t,this.extent,this._keys,this._values)};var ul={VectorTile:function(e,t){this.layers=e.readFields(Qy,{},t)},VectorTileFeature:rf,VectorTileLayer:nf},$y=ul.VectorTileFeature.types,ap=Math.pow(2,13);function du(e,t,i,l,f,m,x,k){e.emplaceBack(t,i,2*Math.floor(l*ap)+x,f*ap*2,m*ap*2,Math.round(k))}var Ba=function(e){this.zoom=e.zoom,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map(function(t){return t.id}),this.index=e.index,this.hasPattern=!1,this.layoutVertexArray=new Da,this.indexArray=new Ya,this.programConfigurations=new Mt(e.layers,e.zoom),this.segments=new G,this.stateDependentLayerIds=this.layers.filter(function(t){return t.isStateDependent()}).map(function(t){return t.id})};function eg(e,t){return e.x===t.x&&(e.x<0||e.x>8192)||e.y===t.y&&(e.y<0||e.y>8192)}Ba.prototype.populate=function(e,t,i){this.features=[],this.hasPattern=ip("fill-extrusion",this.layers,t);for(var l=0,f=e;l<f.length;l+=1){var m=f[l],x=m.feature,k=m.id,I=m.index,A=m.sourceLayerIndex,M=this.layers[0]._featureFilter.needGeometry,B=pi(x,M);if(this.layers[0]._featureFilter.filter(new ar(this.zoom),B,i)){var U={id:k,sourceLayerIndex:A,index:I,geometry:M?B.geometry:Jr(x),properties:x.properties,type:x.type,patterns:{}};this.hasPattern?this.features.push(np("fill-extrusion",this.layers,U,this.zoom,t)):this.addFeature(U,U.geometry,I,i,{}),t.featureIndex.insert(x,U.geometry,I,A,this.index,!0)}}},Ba.prototype.addFeatures=function(e,t,i){for(var l=0,f=this.features;l<f.length;l+=1){var m=f[l];this.addFeature(m,m.geometry,m.index,t,i)}},Ba.prototype.update=function(e,t,i){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(e,t,this.stateDependentLayers,i)},Ba.prototype.isEmpty=function(){return this.layoutVertexArray.length===0},Ba.prototype.uploadPending=function(){return!this.uploaded||this.programConfigurations.needsUpload},Ba.prototype.upload=function(e){this.uploaded||(this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,Xy),this.indexBuffer=e.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(e),this.uploaded=!0},Ba.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())},Ba.prototype.addFeature=function(e,t,i,l,f){for(var m=0,x=rp(t,500);m<x.length;m+=1){for(var k=x[m],I=0,A=0,M=k;A<M.length;A+=1)I+=M[A].length;for(var B=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray),U=0,j=k;U<j.length;U+=1){var J=j[U];if(J.length!==0&&!((nr=J).every(function(jt){return jt.x<0})||nr.every(function(jt){return jt.x>8192})||nr.every(function(jt){return jt.y<0})||nr.every(function(jt){return jt.y>8192})))for(var $=0,ce=0;ce<J.length;ce++){var ie=J[ce];if(ce>=1){var ye=J[ce-1];if(!eg(ie,ye)){B.vertexLength+4>G.MAX_VERTEX_ARRAY_LENGTH&&(B=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray));var be=ie.sub(ye)._perp()._unit(),we=ye.dist(ie);$+we>32768&&($=0),du(this.layoutVertexArray,ie.x,ie.y,be.x,be.y,0,0,$),du(this.layoutVertexArray,ie.x,ie.y,be.x,be.y,0,1,$),du(this.layoutVertexArray,ye.x,ye.y,be.x,be.y,0,0,$+=we),du(this.layoutVertexArray,ye.x,ye.y,be.x,be.y,0,1,$);var ke=B.vertexLength;this.indexArray.emplaceBack(ke,ke+2,ke+1),this.indexArray.emplaceBack(ke+1,ke+2,ke+3),B.vertexLength+=4,B.primitiveLength+=2}}}}if(B.vertexLength+I>G.MAX_VERTEX_ARRAY_LENGTH&&(B=this.segments.prepareSegment(I,this.layoutVertexArray,this.indexArray)),$y[e.type]==="Polygon"){for(var Ce=[],Ve=[],Je=B.vertexLength,wt=0,ot=k;wt<ot.length;wt+=1){var zt=ot[wt];if(zt.length!==0){zt!==k[0]&&Ve.push(Ce.length/2);for(var lt=0;lt<zt.length;lt++){var Yt=zt[lt];du(this.layoutVertexArray,Yt.x,Yt.y,0,0,1,1,0),Ce.push(Yt.x),Ce.push(Yt.y)}}}for(var Lt=Qh(Ce,Ve),yt=0;yt<Lt.length;yt+=3)this.indexArray.emplaceBack(Je+Lt[yt],Je+Lt[yt+2],Je+Lt[yt+1]);B.primitiveLength+=Lt.length/3,B.vertexLength+=I}}var nr;this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,e,i,f,l)},ft("FillExtrusionBucket",Ba,{omit:["layers","features"]});var tg={paint:new en({"fill-extrusion-opacity":new kt(q["paint_fill-extrusion"]["fill-extrusion-opacity"]),"fill-extrusion-color":new mt(q["paint_fill-extrusion"]["fill-extrusion-color"]),"fill-extrusion-translate":new kt(q["paint_fill-extrusion"]["fill-extrusion-translate"]),"fill-extrusion-translate-anchor":new kt(q["paint_fill-extrusion"]["fill-extrusion-translate-anchor"]),"fill-extrusion-pattern":new el(q["paint_fill-extrusion"]["fill-extrusion-pattern"]),"fill-extrusion-height":new mt(q["paint_fill-extrusion"]["fill-extrusion-height"]),"fill-extrusion-base":new mt(q["paint_fill-extrusion"]["fill-extrusion-base"]),"fill-extrusion-vertical-gradient":new kt(q["paint_fill-extrusion"]["fill-extrusion-vertical-gradient"])})},rg=function(e){function t(i){e.call(this,i,tg)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.createBucket=function(i){return new Ba(i)},t.prototype.queryRadius=function(){return Oi(this.paint.get("fill-extrusion-translate"))},t.prototype.is3D=function(){return!0},t.prototype.queryIntersectsFeature=function(i,l,f,m,x,k,I,A){var M=La(i,this.paint.get("fill-extrusion-translate"),this.paint.get("fill-extrusion-translate-anchor"),k.angle,I),B=this.paint.get("fill-extrusion-height").evaluate(l,f),U=this.paint.get("fill-extrusion-base").evaluate(l,f),j=function($,ce,ie,ye){for(var be=[],we=0,ke=$;we<ke.length;we+=1){var Ce=ke[we],Ve=[Ce.x,Ce.y,0,1];al(Ve,Ve,ce),be.push(new F(Ve[0]/Ve[3],Ve[1]/Ve[3]))}return be}(M,A),J=function($,ce,ie,ye){for(var be=[],we=[],ke=ye[8]*ce,Ce=ye[9]*ce,Ve=ye[10]*ce,Je=ye[11]*ce,wt=ye[8]*ie,ot=ye[9]*ie,zt=ye[10]*ie,lt=ye[11]*ie,Yt=0,Lt=$;Yt<Lt.length;Yt+=1){for(var yt=[],nr=[],jt=0,pr=Lt[Yt];jt<pr.length;jt+=1){var Tt=pr[jt],vr=Tt.x,Xr=Tt.y,ai=ye[0]*vr+ye[4]*Xr+ye[12],Qr=ye[1]*vr+ye[5]*Xr+ye[13],Wr=ye[2]*vr+ye[6]*Xr+ye[14],oi=ye[3]*vr+ye[7]*Xr+ye[15],Fi=Wr+Ve,Ni=oi+Je,Sn=ai+wt,Xi=Qr+ot,kn=Wr+zt,fi=oi+lt,Wi=new F((ai+ke)/Ni,(Qr+Ce)/Ni);Wi.z=Fi/Ni,yt.push(Wi);var sr=new F(Sn/fi,Xi/fi);sr.z=kn/fi,nr.push(sr)}be.push(yt),we.push(nr)}return[be,we]}(m,U,B,A);return function($,ce,ie){var ye=1/0;ga(ie,ce)&&(ye=of(ie,ce[0]));for(var be=0;be<ce.length;be++)for(var we=ce[be],ke=$[be],Ce=0;Ce<we.length-1;Ce++){var Ve=we[Ce],Je=[Ve,we[Ce+1],ke[Ce+1],ke[Ce],Ve];$a(ie,Je)&&(ye=Math.min(ye,of(ie,Je)))}return ye!==1/0&&ye}(J[0],J[1],j)},t}(Ea);function mu(e,t){return e.x*t.x+e.y*t.y}function of(e,t){if(e.length===1){for(var i,l=0,f=t[l++];!i||f.equals(i);)if(!(i=t[l++]))return 1/0;for(;l<t.length;l++){var m=t[l],x=e[0],k=i.sub(f),I=m.sub(f),A=x.sub(f),M=mu(k,k),B=mu(k,I),U=mu(I,I),j=mu(A,k),J=mu(A,I),$=M*U-B*B,ce=(U*j-B*J)/$,ie=(M*J-B*j)/$,ye=f.z*(1-ce-ie)+i.z*ce+m.z*ie;if(isFinite(ye))return ye}return 1/0}for(var be=1/0,we=0,ke=t;we<ke.length;we+=1)be=Math.min(be,ke[we].z);return be}var ig=Gi([{name:"a_pos_normal",components:2,type:"Int16"},{name:"a_data",components:4,type:"Uint8"}],4).members,ng=Gi([{name:"a_uv_x",components:1,type:"Float32"},{name:"a_split_index",components:1,type:"Float32"}]).members,ag=ul.VectorTileFeature.types,og=Math.cos(Math.PI/180*37.5),sf=Math.pow(2,14)/.5,Mn=function(e){var t=this;this.zoom=e.zoom,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map(function(i){return i.id}),this.index=e.index,this.hasPattern=!1,this.patternFeatures=[],this.lineClipsArray=[],this.gradients={},this.layers.forEach(function(i){t.gradients[i.id]={}}),this.layoutVertexArray=new jn,this.layoutVertexArray2=new Go,this.indexArray=new Ya,this.programConfigurations=new Mt(e.layers,e.zoom),this.segments=new G,this.maxLineLength=0,this.stateDependentLayerIds=this.layers.filter(function(i){return i.isStateDependent()}).map(function(i){return i.id})};Mn.prototype.populate=function(e,t,i){this.hasPattern=ip("line",this.layers,t);for(var l=this.layers[0].layout.get("line-sort-key"),f=[],m=0,x=e;m<x.length;m+=1){var k=x[m],I=k.feature,A=k.id,M=k.index,B=k.sourceLayerIndex,U=this.layers[0]._featureFilter.needGeometry,j=pi(I,U);if(this.layers[0]._featureFilter.filter(new ar(this.zoom),j,i)){var J=l?l.evaluate(j,{},i):void 0,$={id:A,properties:I.properties,type:I.type,sourceLayerIndex:B,index:M,geometry:U?j.geometry:Jr(I),patterns:{},sortKey:J};f.push($)}}l&&f.sort(function(Ve,Je){return Ve.sortKey-Je.sortKey});for(var ce=0,ie=f;ce<ie.length;ce+=1){var ye=ie[ce],be=ye.geometry,we=ye.index,ke=ye.sourceLayerIndex;if(this.hasPattern){var Ce=np("line",this.layers,ye,this.zoom,t);this.patternFeatures.push(Ce)}else this.addFeature(ye,be,we,i,{});t.featureIndex.insert(e[we].feature,be,we,ke,this.index)}},Mn.prototype.update=function(e,t,i){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(e,t,this.stateDependentLayers,i)},Mn.prototype.addFeatures=function(e,t,i){for(var l=0,f=this.patternFeatures;l<f.length;l+=1){var m=f[l];this.addFeature(m,m.geometry,m.index,t,i)}},Mn.prototype.isEmpty=function(){return this.layoutVertexArray.length===0},Mn.prototype.uploadPending=function(){return!this.uploaded||this.programConfigurations.needsUpload},Mn.prototype.upload=function(e){this.uploaded||(this.layoutVertexArray2.length!==0&&(this.layoutVertexBuffer2=e.createVertexBuffer(this.layoutVertexArray2,ng)),this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,ig),this.indexBuffer=e.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(e),this.uploaded=!0},Mn.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())},Mn.prototype.lineFeatureClips=function(e){if(e.properties&&e.properties.hasOwnProperty("mapbox_clip_start")&&e.properties.hasOwnProperty("mapbox_clip_end"))return{start:+e.properties.mapbox_clip_start,end:+e.properties.mapbox_clip_end}},Mn.prototype.addFeature=function(e,t,i,l,f){var m=this.layers[0].layout,x=m.get("line-join").evaluate(e,{}),k=m.get("line-cap"),I=m.get("line-miter-limit"),A=m.get("line-round-limit");this.lineClips=this.lineFeatureClips(e);for(var M=0,B=t;M<B.length;M+=1)this.addLine(B[M],e,x,k,I,A);this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,e,i,f,l)},Mn.prototype.addLine=function(e,t,i,l,f,m){if(this.distance=0,this.scaledDistance=0,this.totalDistance=0,this.lineClips){this.lineClipsArray.push(this.lineClips);for(var x=0;x<e.length-1;x++)this.totalDistance+=e[x].dist(e[x+1]);this.updateScaledDistance(),this.maxLineLength=Math.max(this.maxLineLength,this.totalDistance)}for(var k=ag[t.type]==="Polygon",I=e.length;I>=2&&e[I-1].equals(e[I-2]);)I--;for(var A=0;A<I-1&&e[A].equals(e[A+1]);)A++;if(!(I<(k?3:2))){i==="bevel"&&(f=1.05);var M,B=this.overscaling<=16?122880/(512*this.overscaling):0,U=this.segments.prepareSegment(10*I,this.layoutVertexArray,this.indexArray),j=void 0,J=void 0,$=void 0,ce=void 0;this.e1=this.e2=-1,k&&(ce=e[A].sub(M=e[I-2])._unit()._perp());for(var ie=A;ie<I;ie++)if(!(J=ie===I-1?k?e[A+1]:void 0:e[ie+1])||!e[ie].equals(J)){ce&&($=ce),M&&(j=M),M=e[ie],ce=J?J.sub(M)._unit()._perp():$;var ye=($=$||ce).add(ce);ye.x===0&&ye.y===0||ye._unit();var be=$.x*ce.x+$.y*ce.y,we=ye.x*ce.x+ye.y*ce.y,ke=we!==0?1/we:1/0,Ce=2*Math.sqrt(2-2*we),Ve=we<og&&j&&J,Je=$.x*ce.y-$.y*ce.x>0;if(Ve&&ie>A){var wt=M.dist(j);if(wt>2*B){var ot=M.sub(M.sub(j)._mult(B/wt)._round());this.updateDistance(j,ot),this.addCurrentVertex(ot,$,0,0,U),j=ot}}var zt=j&&J,lt=zt?i:k?"butt":l;if(zt&&lt==="round"&&(ke<m?lt="miter":ke<=2&&(lt="fakeround")),lt==="miter"&&ke>f&&(lt="bevel"),lt==="bevel"&&(ke>2&&(lt="flipbevel"),ke<f&&(lt="miter")),j&&this.updateDistance(j,M),lt==="miter")ye._mult(ke),this.addCurrentVertex(M,ye,0,0,U);else if(lt==="flipbevel"){if(ke>100)ye=ce.mult(-1);else{var Yt=ke*$.add(ce).mag()/$.sub(ce).mag();ye._perp()._mult(Yt*(Je?-1:1))}this.addCurrentVertex(M,ye,0,0,U),this.addCurrentVertex(M,ye.mult(-1),0,0,U)}else if(lt==="bevel"||lt==="fakeround"){var Lt=-Math.sqrt(ke*ke-1),yt=Je?Lt:0,nr=Je?0:Lt;if(j&&this.addCurrentVertex(M,$,yt,nr,U),lt==="fakeround")for(var jt=Math.round(180*Ce/Math.PI/20),pr=1;pr<jt;pr++){var Tt=pr/jt;if(Tt!==.5){var vr=Tt-.5;Tt+=Tt*vr*(Tt-1)*((1.0904+be*(be*(3.55645-1.43519*be)-3.2452))*vr*vr+(.848013+be*(.215638*be-1.06021)))}var Xr=ce.sub($)._mult(Tt)._add($)._unit()._mult(Je?-1:1);this.addHalfVertex(M,Xr.x,Xr.y,!1,Je,0,U)}J&&this.addCurrentVertex(M,ce,-yt,-nr,U)}else if(lt==="butt")this.addCurrentVertex(M,ye,0,0,U);else if(lt==="square"){var ai=j?1:-1;this.addCurrentVertex(M,ye,ai,ai,U)}else lt==="round"&&(j&&(this.addCurrentVertex(M,$,0,0,U),this.addCurrentVertex(M,$,1,1,U,!0)),J&&(this.addCurrentVertex(M,ce,-1,-1,U,!0),this.addCurrentVertex(M,ce,0,0,U)));if(Ve&&ie<I-1){var Qr=M.dist(J);if(Qr>2*B){var Wr=M.add(J.sub(M)._mult(B/Qr)._round());this.updateDistance(M,Wr),this.addCurrentVertex(Wr,ce,0,0,U),M=Wr}}}}},Mn.prototype.addCurrentVertex=function(e,t,i,l,f,m){m===void 0&&(m=!1);var x=t.y*l-t.x,k=-t.y-t.x*l;this.addHalfVertex(e,t.x+t.y*i,t.y-t.x*i,m,!1,i,f),this.addHalfVertex(e,x,k,m,!0,-l,f),this.distance>sf/2&&this.totalDistance===0&&(this.distance=0,this.addCurrentVertex(e,t,i,l,f,m))},Mn.prototype.addHalfVertex=function(e,t,i,l,f,m,x){var k=.5*(this.lineClips?this.scaledDistance*(sf-1):this.scaledDistance);this.layoutVertexArray.emplaceBack((e.x<<1)+(l?1:0),(e.y<<1)+(f?1:0),Math.round(63*t)+128,Math.round(63*i)+128,1+(m===0?0:m<0?-1:1)|(63&k)<<2,k>>6),this.lineClips&&this.layoutVertexArray2.emplaceBack((this.scaledDistance-this.lineClips.start)/(this.lineClips.end-this.lineClips.start),this.lineClipsArray.length);var I=x.vertexLength++;this.e1>=0&&this.e2>=0&&(this.indexArray.emplaceBack(this.e1,this.e2,I),x.primitiveLength++),f?this.e2=I:this.e1=I},Mn.prototype.updateScaledDistance=function(){this.scaledDistance=this.lineClips?this.lineClips.start+(this.lineClips.end-this.lineClips.start)*this.distance/this.totalDistance:this.distance},Mn.prototype.updateDistance=function(e,t){this.distance+=e.dist(t),this.updateScaledDistance()},ft("LineBucket",Mn,{omit:["layers","patternFeatures"]});var sg=new en({"line-cap":new kt(q.layout_line["line-cap"]),"line-join":new mt(q.layout_line["line-join"]),"line-miter-limit":new kt(q.layout_line["line-miter-limit"]),"line-round-limit":new kt(q.layout_line["line-round-limit"]),"line-sort-key":new mt(q.layout_line["line-sort-key"])}),lf={paint:new en({"line-opacity":new mt(q.paint_line["line-opacity"]),"line-color":new mt(q.paint_line["line-color"]),"line-translate":new kt(q.paint_line["line-translate"]),"line-translate-anchor":new kt(q.paint_line["line-translate-anchor"]),"line-width":new mt(q.paint_line["line-width"]),"line-gap-width":new mt(q.paint_line["line-gap-width"]),"line-offset":new mt(q.paint_line["line-offset"]),"line-blur":new mt(q.paint_line["line-blur"]),"line-dasharray":new bn(q.paint_line["line-dasharray"]),"line-pattern":new el(q.paint_line["line-pattern"]),"line-gradient":new ya(q.paint_line["line-gradient"])}),layout:sg},uf=new(function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.possiblyEvaluate=function(i,l){return l=new ar(Math.floor(l.zoom),{now:l.now,fadeDuration:l.fadeDuration,zoomHistory:l.zoomHistory,transition:l.transition}),e.prototype.possiblyEvaluate.call(this,i,l)},t.prototype.evaluate=function(i,l,f,m){return l=xe({},l,{zoom:Math.floor(l.zoom)}),e.prototype.evaluate.call(this,i,l,f,m)},t}(mt))(lf.paint.properties["line-width"].specification);uf.useIntegerZoom=!0;var lg=function(e){function t(i){e.call(this,i,lf),this.gradientVersion=0}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._handleSpecialPaintPropertyUpdate=function(i){i==="line-gradient"&&(this.stepInterpolant=this._transitionablePaint._values["line-gradient"].value.expression._styleExpression.expression instanceof Fn,this.gradientVersion=(this.gradientVersion+1)%X)},t.prototype.gradientExpression=function(){return this._transitionablePaint._values["line-gradient"].value.expression},t.prototype.recalculate=function(i,l){e.prototype.recalculate.call(this,i,l),this.paint._values["line-floorwidth"]=uf.possiblyEvaluate(this._transitioningPaint._values["line-width"].value,i)},t.prototype.createBucket=function(i){return new Mn(i)},t.prototype.queryRadius=function(i){var l=i,f=cf(Ia("line-width",this,l),Ia("line-gap-width",this,l)),m=Ia("line-offset",this,l);return f/2+Math.abs(m)+Oi(this.paint.get("line-translate"))},t.prototype.queryIntersectsFeature=function(i,l,f,m,x,k,I){var A=La(i,this.paint.get("line-translate"),this.paint.get("line-translate-anchor"),k.angle,I),M=I/2*cf(this.paint.get("line-width").evaluate(l,f),this.paint.get("line-gap-width").evaluate(l,f)),B=this.paint.get("line-offset").evaluate(l,f);return B&&(m=function(U,j){for(var J=[],$=new F(0,0),ce=0;ce<U.length;ce++){for(var ie=U[ce],ye=[],be=0;be<ie.length;be++){var we=ie[be],ke=ie[be+1],Ce=be===0?$:we.sub(ie[be-1])._unit()._perp(),Ve=be===ie.length-1?$:ke.sub(we)._unit()._perp(),Je=Ce._add(Ve)._unit();Je._mult(1/(Je.x*Ve.x+Je.y*Ve.y)),ye.push(Je._mult(j)._add(we))}J.push(ye)}return J}(m,B*I)),function(U,j,J){for(var $=0;$<j.length;$++){var ce=j[$];if(U.length>=3){for(var ie=0;ie<ce.length;ie++)if(Ta(U,ce[ie]))return!0}if(aa(U,ce,J))return!0}return!1}(A,m,M)},t.prototype.isTileClipped=function(){return!0},t}(Ea);function cf(e,t){return t>0?t+2*e:e}var ug=Gi([{name:"a_pos_offset",components:4,type:"Int16"},{name:"a_data",components:4,type:"Uint16"},{name:"a_pixeloffset",components:4,type:"Int16"}],4),cg=Gi([{name:"a_projected_pos",components:3,type:"Float32"}],4),hg=(Gi([{name:"a_fade_opacity",components:1,type:"Uint32"}],4),Gi([{name:"a_placed",components:2,type:"Uint8"},{name:"a_shift",components:2,type:"Float32"}])),hf=(Gi([{type:"Int16",name:"anchorPointX"},{type:"Int16",name:"anchorPointY"},{type:"Int16",name:"x1"},{type:"Int16",name:"y1"},{type:"Int16",name:"x2"},{type:"Int16",name:"y2"},{type:"Uint32",name:"featureIndex"},{type:"Uint16",name:"sourceLayerIndex"},{type:"Uint16",name:"bucketIndex"}]),Gi([{name:"a_pos",components:2,type:"Int16"},{name:"a_anchor_pos",components:2,type:"Int16"},{name:"a_extrude",components:2,type:"Int16"}],4)),pg=Gi([{name:"a_pos",components:2,type:"Float32"},{name:"a_radius",components:1,type:"Float32"},{name:"a_flags",components:2,type:"Int16"}],4);function fg(e,t,i){return e.sections.forEach(function(l){l.text=function(f,m,x){var k=m.layout.get("text-transform").evaluate(x,{});return k==="uppercase"?f=f.toLocaleUpperCase():k==="lowercase"&&(f=f.toLocaleLowerCase()),$n.applyArabicShaping&&(f=$n.applyArabicShaping(f)),f}(l.text,t,i)}),e}Gi([{name:"triangle",components:3,type:"Uint16"}]),Gi([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Uint16",name:"glyphStartIndex"},{type:"Uint16",name:"numGlyphs"},{type:"Uint32",name:"vertexStartIndex"},{type:"Uint32",name:"lineStartIndex"},{type:"Uint32",name:"lineLength"},{type:"Uint16",name:"segment"},{type:"Uint16",name:"lowerSize"},{type:"Uint16",name:"upperSize"},{type:"Float32",name:"lineOffsetX"},{type:"Float32",name:"lineOffsetY"},{type:"Uint8",name:"writingMode"},{type:"Uint8",name:"placedOrientation"},{type:"Uint8",name:"hidden"},{type:"Uint32",name:"crossTileID"},{type:"Int16",name:"associatedIconIndex"}]),Gi([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Int16",name:"rightJustifiedTextSymbolIndex"},{type:"Int16",name:"centerJustifiedTextSymbolIndex"},{type:"Int16",name:"leftJustifiedTextSymbolIndex"},{type:"Int16",name:"verticalPlacedTextSymbolIndex"},{type:"Int16",name:"placedIconSymbolIndex"},{type:"Int16",name:"verticalPlacedIconSymbolIndex"},{type:"Uint16",name:"key"},{type:"Uint16",name:"textBoxStartIndex"},{type:"Uint16",name:"textBoxEndIndex"},{type:"Uint16",name:"verticalTextBoxStartIndex"},{type:"Uint16",name:"verticalTextBoxEndIndex"},{type:"Uint16",name:"iconBoxStartIndex"},{type:"Uint16",name:"iconBoxEndIndex"},{type:"Uint16",name:"verticalIconBoxStartIndex"},{type:"Uint16",name:"verticalIconBoxEndIndex"},{type:"Uint16",name:"featureIndex"},{type:"Uint16",name:"numHorizontalGlyphVertices"},{type:"Uint16",name:"numVerticalGlyphVertices"},{type:"Uint16",name:"numIconVertices"},{type:"Uint16",name:"numVerticalIconVertices"},{type:"Uint16",name:"useRuntimeCollisionCircles"},{type:"Uint32",name:"crossTileID"},{type:"Float32",name:"textBoxScale"},{type:"Float32",components:2,name:"textOffset"},{type:"Float32",name:"collisionCircleDiameter"}]),Gi([{type:"Float32",name:"offsetX"}]),Gi([{type:"Int16",name:"x"},{type:"Int16",name:"y"},{type:"Int16",name:"tileUnitDistanceFromAnchor"}]);var yu={"!":"","#":"",$:"","%":"","&":"","(":"",")":"","*":"","+":"",",":"","-":"",".":"","/":"",":":"",";":"","<":"","=":"",">":"","?":"","@":"","[":"","\\":"","]":"","^":"",_:"","`":"","{":"","|":"","}":"","~":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":""},pf=function(e,t,i,l,f){var m,x,k=8*f-l-1,I=(1<<k)-1,A=I>>1,M=-7,B=i?f-1:0,U=i?-1:1,j=e[t+B];for(B+=U,m=j&(1<<-M)-1,j>>=-M,M+=k;M>0;m=256*m+e[t+B],B+=U,M-=8);for(x=m&(1<<-M)-1,m>>=-M,M+=l;M>0;x=256*x+e[t+B],B+=U,M-=8);if(m===0)m=1-A;else{if(m===I)return x?NaN:1/0*(j?-1:1);x+=Math.pow(2,l),m-=A}return(j?-1:1)*x*Math.pow(2,m-l)},ff=function(e,t,i,l,f,m){var x,k,I,A=8*m-f-1,M=(1<<A)-1,B=M>>1,U=f===23?Math.pow(2,-24)-Math.pow(2,-77):0,j=l?0:m-1,J=l?1:-1,$=t<0||t===0&&1/t<0?1:0;for(t=Math.abs(t),isNaN(t)||t===1/0?(k=isNaN(t)?1:0,x=M):(x=Math.floor(Math.log(t)/Math.LN2),t*(I=Math.pow(2,-x))<1&&(x--,I*=2),(t+=x+B>=1?U/I:U*Math.pow(2,1-B))*I>=2&&(x++,I/=2),x+B>=M?(k=0,x=M):x+B>=1?(k=(t*I-1)*Math.pow(2,f),x+=B):(k=t*Math.pow(2,B-1)*Math.pow(2,f),x=0));f>=8;e[i+j]=255&k,j+=J,k/=256,f-=8);for(x=x<<f|k,A+=f;A>0;e[i+j]=255&x,j+=J,x/=256,A-=8);e[i+j-J]|=128*$},Lc=Ur;function Ur(e){this.buf=ArrayBuffer.isView&&ArrayBuffer.isView(e)?e:new Uint8Array(e||0),this.pos=0,this.type=0,this.length=this.buf.length}Ur.Varint=0,Ur.Fixed64=1,Ur.Bytes=2,Ur.Fixed32=5;var df=typeof TextDecoder>"u"?null:new TextDecoder("utf8");function Po(e){return e.type===Ur.Bytes?e.readVarint()+e.pos:e.pos+1}function cl(e,t,i){return i?4294967296*t+(e>>>0):4294967296*(t>>>0)+(e>>>0)}function mf(e,t,i){var l=t<=16383?1:t<=2097151?2:t<=268435455?3:Math.floor(Math.log(t)/(7*Math.LN2));i.realloc(l);for(var f=i.pos-1;f>=e;f--)i.buf[f+l]=i.buf[f]}function dg(e,t){for(var i=0;i<e.length;i++)t.writeVarint(e[i])}function mg(e,t){for(var i=0;i<e.length;i++)t.writeSVarint(e[i])}function yg(e,t){for(var i=0;i<e.length;i++)t.writeFloat(e[i])}function gg(e,t){for(var i=0;i<e.length;i++)t.writeDouble(e[i])}function _g(e,t){for(var i=0;i<e.length;i++)t.writeBoolean(e[i])}function vg(e,t){for(var i=0;i<e.length;i++)t.writeFixed32(e[i])}function bg(e,t){for(var i=0;i<e.length;i++)t.writeSFixed32(e[i])}function xg(e,t){for(var i=0;i<e.length;i++)t.writeFixed64(e[i])}function wg(e,t){for(var i=0;i<e.length;i++)t.writeSFixed64(e[i])}function Rc(e,t){return(e[t]|e[t+1]<<8|e[t+2]<<16)+16777216*e[t+3]}function hl(e,t,i){e[i]=t,e[i+1]=t>>>8,e[i+2]=t>>>16,e[i+3]=t>>>24}function yf(e,t){return(e[t]|e[t+1]<<8|e[t+2]<<16)+(e[t+3]<<24)}function Sg(e,t,i){e===1&&i.readMessage(kg,t)}function kg(e,t,i){if(e===3){var l=i.readMessage(Eg,{}),f=l.width,m=l.height,x=l.left,k=l.top,I=l.advance;t.push({id:l.id,bitmap:new As({width:f+6,height:m+6},l.bitmap),metrics:{width:f,height:m,left:x,top:k,advance:I}})}}function Eg(e,t,i){e===1?t.id=i.readVarint():e===2?t.bitmap=i.readBytes():e===3?t.width=i.readVarint():e===4?t.height=i.readVarint():e===5?t.left=i.readSVarint():e===6?t.top=i.readSVarint():e===7&&(t.advance=i.readVarint())}function gf(e){for(var t=0,i=0,l=0,f=e;l<f.length;l+=1){var m=f[l];t+=m.w*m.h,i=Math.max(i,m.w)}e.sort(function($,ce){return ce.h-$.h});for(var x=[{x:0,y:0,w:Math.max(Math.ceil(Math.sqrt(t/.95)),i),h:1/0}],k=0,I=0,A=0,M=e;A<M.length;A+=1)for(var B=M[A],U=x.length-1;U>=0;U--){var j=x[U];if(!(B.w>j.w||B.h>j.h)){if(B.x=j.x,B.y=j.y,I=Math.max(I,B.y+B.h),k=Math.max(k,B.x+B.w),B.w===j.w&&B.h===j.h){var J=x.pop();U<x.length&&(x[U]=J)}else B.h===j.h?(j.x+=B.w,j.w-=B.w):B.w===j.w?(j.y+=B.h,j.h-=B.h):(x.push({x:j.x+B.w,y:j.y,w:j.w-B.w,h:B.h}),j.y+=B.h,j.h-=B.h);break}}return{w:k,h:I,fill:t/(k*I)||0}}Ur.prototype={destroy:function(){this.buf=null},readFields:function(e,t,i){for(i=i||this.length;this.pos<i;){var l=this.readVarint(),f=l>>3,m=this.pos;this.type=7&l,e(f,t,this),this.pos===m&&this.skip(l)}return t},readMessage:function(e,t){return this.readFields(e,t,this.readVarint()+this.pos)},readFixed32:function(){var e=Rc(this.buf,this.pos);return this.pos+=4,e},readSFixed32:function(){var e=yf(this.buf,this.pos);return this.pos+=4,e},readFixed64:function(){var e=Rc(this.buf,this.pos)+4294967296*Rc(this.buf,this.pos+4);return this.pos+=8,e},readSFixed64:function(){var e=Rc(this.buf,this.pos)+4294967296*yf(this.buf,this.pos+4);return this.pos+=8,e},readFloat:function(){var e=pf(this.buf,this.pos,!0,23,4);return this.pos+=4,e},readDouble:function(){var e=pf(this.buf,this.pos,!0,52,8);return this.pos+=8,e},readVarint:function(e){var t,i,l=this.buf;return t=127&(i=l[this.pos++]),i<128?t:(t|=(127&(i=l[this.pos++]))<<7,i<128?t:(t|=(127&(i=l[this.pos++]))<<14,i<128?t:(t|=(127&(i=l[this.pos++]))<<21,i<128?t:function(f,m,x){var k,I,A=x.buf;if(k=(112&(I=A[x.pos++]))>>4,I<128||(k|=(127&(I=A[x.pos++]))<<3,I<128)||(k|=(127&(I=A[x.pos++]))<<10,I<128)||(k|=(127&(I=A[x.pos++]))<<17,I<128)||(k|=(127&(I=A[x.pos++]))<<24,I<128)||(k|=(1&(I=A[x.pos++]))<<31,I<128))return cl(f,k,m);throw new Error("Expected varint not more than 10 bytes")}(t|=(15&(i=l[this.pos]))<<28,e,this))))},readVarint64:function(){return this.readVarint(!0)},readSVarint:function(){var e=this.readVarint();return e%2==1?(e+1)/-2:e/2},readBoolean:function(){return!!this.readVarint()},readString:function(){var e=this.readVarint()+this.pos,t=this.pos;return this.pos=e,e-t>=12&&df?function(i,l,f){return df.decode(i.subarray(l,f))}(this.buf,t,e):function(i,l,f){for(var m="",x=l;x<f;){var k,I,A,M=i[x],B=null,U=M>239?4:M>223?3:M>191?2:1;if(x+U>f)break;U===1?M<128&&(B=M):U===2?(192&(k=i[x+1]))==128&&(B=(31&M)<<6|63&k)<=127&&(B=null):U===3?(I=i[x+2],(192&(k=i[x+1]))==128&&(192&I)==128&&((B=(15&M)<<12|(63&k)<<6|63&I)<=2047||B>=55296&&B<=57343)&&(B=null)):U===4&&(I=i[x+2],A=i[x+3],(192&(k=i[x+1]))==128&&(192&I)==128&&(192&A)==128&&((B=(15&M)<<18|(63&k)<<12|(63&I)<<6|63&A)<=65535||B>=1114112)&&(B=null)),B===null?(B=65533,U=1):B>65535&&(B-=65536,m+=String.fromCharCode(B>>>10&1023|55296),B=56320|1023&B),m+=String.fromCharCode(B),x+=U}return m}(this.buf,t,e)},readBytes:function(){var e=this.readVarint()+this.pos,t=this.buf.subarray(this.pos,e);return this.pos=e,t},readPackedVarint:function(e,t){if(this.type!==Ur.Bytes)return e.push(this.readVarint(t));var i=Po(this);for(e=e||[];this.pos<i;)e.push(this.readVarint(t));return e},readPackedSVarint:function(e){if(this.type!==Ur.Bytes)return e.push(this.readSVarint());var t=Po(this);for(e=e||[];this.pos<t;)e.push(this.readSVarint());return e},readPackedBoolean:function(e){if(this.type!==Ur.Bytes)return e.push(this.readBoolean());var t=Po(this);for(e=e||[];this.pos<t;)e.push(this.readBoolean());return e},readPackedFloat:function(e){if(this.type!==Ur.Bytes)return e.push(this.readFloat());var t=Po(this);for(e=e||[];this.pos<t;)e.push(this.readFloat());return e},readPackedDouble:function(e){if(this.type!==Ur.Bytes)return e.push(this.readDouble());var t=Po(this);for(e=e||[];this.pos<t;)e.push(this.readDouble());return e},readPackedFixed32:function(e){if(this.type!==Ur.Bytes)return e.push(this.readFixed32());var t=Po(this);for(e=e||[];this.pos<t;)e.push(this.readFixed32());return e},readPackedSFixed32:function(e){if(this.type!==Ur.Bytes)return e.push(this.readSFixed32());var t=Po(this);for(e=e||[];this.pos<t;)e.push(this.readSFixed32());return e},readPackedFixed64:function(e){if(this.type!==Ur.Bytes)return e.push(this.readFixed64());var t=Po(this);for(e=e||[];this.pos<t;)e.push(this.readFixed64());return e},readPackedSFixed64:function(e){if(this.type!==Ur.Bytes)return e.push(this.readSFixed64());var t=Po(this);for(e=e||[];this.pos<t;)e.push(this.readSFixed64());return e},skip:function(e){var t=7&e;if(t===Ur.Varint)for(;this.buf[this.pos++]>127;);else if(t===Ur.Bytes)this.pos=this.readVarint()+this.pos;else if(t===Ur.Fixed32)this.pos+=4;else{if(t!==Ur.Fixed64)throw new Error("Unimplemented type: "+t);this.pos+=8}},writeTag:function(e,t){this.writeVarint(e<<3|t)},realloc:function(e){for(var t=this.length||16;t<this.pos+e;)t*=2;if(t!==this.length){var i=new Uint8Array(t);i.set(this.buf),this.buf=i,this.length=t}},finish:function(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)},writeFixed32:function(e){this.realloc(4),hl(this.buf,e,this.pos),this.pos+=4},writeSFixed32:function(e){this.realloc(4),hl(this.buf,e,this.pos),this.pos+=4},writeFixed64:function(e){this.realloc(8),hl(this.buf,-1&e,this.pos),hl(this.buf,Math.floor(e*(1/4294967296)),this.pos+4),this.pos+=8},writeSFixed64:function(e){this.realloc(8),hl(this.buf,-1&e,this.pos),hl(this.buf,Math.floor(e*(1/4294967296)),this.pos+4),this.pos+=8},writeVarint:function(e){(e=+e||0)>268435455||e<0?function(t,i){var l,f;if(t>=0?(l=t%4294967296|0,f=t/4294967296|0):(f=~(-t/4294967296),4294967295^(l=~(-t%4294967296))?l=l+1|0:(l=0,f=f+1|0)),t>=18446744073709552e3||t<-18446744073709552e3)throw new Error("Given varint doesn't fit into 10 bytes");i.realloc(10),function(m,x,k){k.buf[k.pos++]=127&m|128,m>>>=7,k.buf[k.pos++]=127&m|128,m>>>=7,k.buf[k.pos++]=127&m|128,m>>>=7,k.buf[k.pos++]=127&m|128,k.buf[k.pos]=127&(m>>>=7)}(l,0,i),function(m,x){var k=(7&m)<<4;x.buf[x.pos++]|=k|((m>>>=3)?128:0),m&&(x.buf[x.pos++]=127&m|((m>>>=7)?128:0),m&&(x.buf[x.pos++]=127&m|((m>>>=7)?128:0),m&&(x.buf[x.pos++]=127&m|((m>>>=7)?128:0),m&&(x.buf[x.pos++]=127&m|((m>>>=7)?128:0),m&&(x.buf[x.pos++]=127&m)))))}(f,i)}(e,this):(this.realloc(4),this.buf[this.pos++]=127&e|(e>127?128:0),e<=127||(this.buf[this.pos++]=127&(e>>>=7)|(e>127?128:0),e<=127||(this.buf[this.pos++]=127&(e>>>=7)|(e>127?128:0),e<=127||(this.buf[this.pos++]=e>>>7&127))))},writeSVarint:function(e){this.writeVarint(e<0?2*-e-1:2*e)},writeBoolean:function(e){this.writeVarint(!!e)},writeString:function(e){e=String(e),this.realloc(4*e.length),this.pos++;var t=this.pos;this.pos=function(l,f,m){for(var x,k,I=0;I<f.length;I++){if((x=f.charCodeAt(I))>55295&&x<57344){if(!k){x>56319||I+1===f.length?(l[m++]=239,l[m++]=191,l[m++]=189):k=x;continue}if(x<56320){l[m++]=239,l[m++]=191,l[m++]=189,k=x;continue}x=k-55296<<10|x-56320|65536,k=null}else k&&(l[m++]=239,l[m++]=191,l[m++]=189,k=null);x<128?l[m++]=x:(x<2048?l[m++]=x>>6|192:(x<65536?l[m++]=x>>12|224:(l[m++]=x>>18|240,l[m++]=x>>12&63|128),l[m++]=x>>6&63|128),l[m++]=63&x|128)}return m}(this.buf,e,this.pos);var i=this.pos-t;i>=128&&mf(t,i,this),this.pos=t-1,this.writeVarint(i),this.pos+=i},writeFloat:function(e){this.realloc(4),ff(this.buf,e,this.pos,!0,23,4),this.pos+=4},writeDouble:function(e){this.realloc(8),ff(this.buf,e,this.pos,!0,52,8),this.pos+=8},writeBytes:function(e){var t=e.length;this.writeVarint(t),this.realloc(t);for(var i=0;i<t;i++)this.buf[this.pos++]=e[i]},writeRawMessage:function(e,t){this.pos++;var i=this.pos;e(t,this);var l=this.pos-i;l>=128&&mf(i,l,this),this.pos=i-1,this.writeVarint(l),this.pos+=l},writeMessage:function(e,t,i){this.writeTag(e,Ur.Bytes),this.writeRawMessage(t,i)},writePackedVarint:function(e,t){t.length&&this.writeMessage(e,dg,t)},writePackedSVarint:function(e,t){t.length&&this.writeMessage(e,mg,t)},writePackedBoolean:function(e,t){t.length&&this.writeMessage(e,_g,t)},writePackedFloat:function(e,t){t.length&&this.writeMessage(e,yg,t)},writePackedDouble:function(e,t){t.length&&this.writeMessage(e,gg,t)},writePackedFixed32:function(e,t){t.length&&this.writeMessage(e,vg,t)},writePackedSFixed32:function(e,t){t.length&&this.writeMessage(e,bg,t)},writePackedFixed64:function(e,t){t.length&&this.writeMessage(e,xg,t)},writePackedSFixed64:function(e,t){t.length&&this.writeMessage(e,wg,t)},writeBytesField:function(e,t){this.writeTag(e,Ur.Bytes),this.writeBytes(t)},writeFixed32Field:function(e,t){this.writeTag(e,Ur.Fixed32),this.writeFixed32(t)},writeSFixed32Field:function(e,t){this.writeTag(e,Ur.Fixed32),this.writeSFixed32(t)},writeFixed64Field:function(e,t){this.writeTag(e,Ur.Fixed64),this.writeFixed64(t)},writeSFixed64Field:function(e,t){this.writeTag(e,Ur.Fixed64),this.writeSFixed64(t)},writeVarintField:function(e,t){this.writeTag(e,Ur.Varint),this.writeVarint(t)},writeSVarintField:function(e,t){this.writeTag(e,Ur.Varint),this.writeSVarint(t)},writeStringField:function(e,t){this.writeTag(e,Ur.Bytes),this.writeString(t)},writeFloatField:function(e,t){this.writeTag(e,Ur.Fixed32),this.writeFloat(t)},writeDoubleField:function(e,t){this.writeTag(e,Ur.Fixed64),this.writeDouble(t)},writeBooleanField:function(e,t){this.writeVarintField(e,!!t)}};var Bc=function(e,t){var i=t.pixelRatio,l=t.version,f=t.stretchX,m=t.stretchY,x=t.content;this.paddedRect=e,this.pixelRatio=i,this.stretchX=f,this.stretchY=m,this.content=x,this.version=l},gu={tl:{configurable:!0},br:{configurable:!0},tlbr:{configurable:!0},displaySize:{configurable:!0}};gu.tl.get=function(){return[this.paddedRect.x+1,this.paddedRect.y+1]},gu.br.get=function(){return[this.paddedRect.x+this.paddedRect.w-1,this.paddedRect.y+this.paddedRect.h-1]},gu.tlbr.get=function(){return this.tl.concat(this.br)},gu.displaySize.get=function(){return[(this.paddedRect.w-2)/this.pixelRatio,(this.paddedRect.h-2)/this.pixelRatio]},Object.defineProperties(Bc.prototype,gu);var _u=function(e,t){var i={},l={};this.haveRenderCallbacks=[];var f=[];this.addImages(e,i,f),this.addImages(t,l,f);var m=gf(f),x=new Gn({width:m.w||1,height:m.h||1});for(var k in e){var I=e[k],A=i[k].paddedRect;Gn.copy(I.data,x,{x:0,y:0},{x:A.x+1,y:A.y+1},I.data)}for(var M in t){var B=t[M],U=l[M].paddedRect,j=U.x+1,J=U.y+1,$=B.data.width,ce=B.data.height;Gn.copy(B.data,x,{x:0,y:0},{x:j,y:J},B.data),Gn.copy(B.data,x,{x:0,y:ce-1},{x:j,y:J-1},{width:$,height:1}),Gn.copy(B.data,x,{x:0,y:0},{x:j,y:J+ce},{width:$,height:1}),Gn.copy(B.data,x,{x:$-1,y:0},{x:j-1,y:J},{width:1,height:ce}),Gn.copy(B.data,x,{x:0,y:0},{x:j+$,y:J},{width:1,height:ce})}this.image=x,this.iconPositions=i,this.patternPositions=l};_u.prototype.addImages=function(e,t,i){for(var l in e){var f=e[l],m={x:0,y:0,w:f.data.width+2,h:f.data.height+2};i.push(m),t[l]=new Bc(m,f),f.hasRenderCallback&&this.haveRenderCallbacks.push(l)}},_u.prototype.patchUpdatedImages=function(e,t){for(var i in e.dispatchRenderCallbacks(this.haveRenderCallbacks),e.updatedImages)this.patchUpdatedImage(this.iconPositions[i],e.getImage(i),t),this.patchUpdatedImage(this.patternPositions[i],e.getImage(i),t)},_u.prototype.patchUpdatedImage=function(e,t,i){if(e&&t&&e.version!==t.version){e.version=t.version;var l=e.tl;i.update(t.data,void 0,{x:l[0],y:l[1]})}},ft("ImagePosition",Bc),ft("ImageAtlas",_u);var oa={horizontal:1,vertical:2,horizontalOnly:3},pl=function(){this.scale=1,this.fontStack="",this.imageName=null};pl.forText=function(e,t){var i=new pl;return i.scale=e||1,i.fontStack=t,i},pl.forImage=function(e){var t=new pl;return t.imageName=e,t};var wn=function(){this.text="",this.sectionIndex=[],this.sections=[],this.imageSectionID=null};function Oc(e,t,i,l,f,m,x,k,I,A,M,B,U,j,J,$){var ce,ie=wn.fromFeature(e,f);B===oa.vertical&&ie.verticalizePunctuation();var ye=$n.processBidirectionalText,be=$n.processStyledBidirectionalText;if(ye&&ie.sections.length===1){ce=[];for(var we=0,ke=ye(ie.toString(),op(ie,A,m,t,l,j,J));we<ke.length;we+=1){var Ce=ke[we],Ve=new wn;Ve.text=Ce,Ve.sections=ie.sections;for(var Je=0;Je<Ce.length;Je++)Ve.sectionIndex.push(0);ce.push(Ve)}}else if(be){ce=[];for(var wt=0,ot=be(ie.text,ie.sectionIndex,op(ie,A,m,t,l,j,J));wt<ot.length;wt+=1){var zt=ot[wt],lt=new wn;lt.text=zt[0],lt.sectionIndex=zt[1],lt.sections=ie.sections,ce.push(lt)}}else ce=function(yt,nr){for(var jt=[],pr=yt.text,Tt=0,vr=0,Xr=nr;vr<Xr.length;vr+=1){var ai=Xr[vr];jt.push(yt.substring(Tt,ai)),Tt=ai}return Tt<pr.length&&jt.push(yt.substring(Tt,pr.length)),jt}(ie,op(ie,A,m,t,l,j,J));var Yt=[],Lt={positionedLines:Yt,text:ie.toString(),top:M[1],bottom:M[1],left:M[0],right:M[0],writingMode:B,iconsInText:!1,verticalizable:!1};return function(yt,nr,jt,pr,Tt,vr,Xr,ai,Qr,Wr,oi,Fi){for(var Ni=0,Sn=-17,Xi=0,kn=0,fi=ai==="right"?1:ai==="left"?0:.5,Wi=0,sr=0,Lr=Tt;sr<Lr.length;sr+=1){var Ar=Lr[sr];Ar.trim();var mr=Ar.getMaxScale(),Dn=24*(mr-1),hn={positionedGlyphs:[],lineOffset:0};yt.positionedLines[Wi]=hn;var Gr=hn.positionedGlyphs,xi=0;if(Ar.length()){for(var pn=0;pn<Ar.length();pn++){var br=Ar.getSection(pn),ro=Ar.getSectionIndex(pn),sa=Ar.getCharCode(pn),io=0,di=null,no=null,Aa=null,bl=24,Ds=!(Qr===oa.horizontal||!oi&&!Js(sa)||oi&&(Fc[sa]||(Lo=sa,tt.Arabic(Lo)||tt["Arabic Supplement"](Lo)||tt["Arabic Extended-A"](Lo)||tt["Arabic Presentation Forms-A"](Lo)||tt["Arabic Presentation Forms-B"](Lo))));if(br.imageName){var xl=pr[br.imageName];if(!xl)continue;Aa=br.imageName,yt.iconsInText=yt.iconsInText||!0,no=xl.paddedRect;var Do=xl.displaySize;br.scale=24*br.scale/Fi,io=Dn+(24-Do[1]*br.scale),bl=(di={width:Do[0],height:Do[1],left:1,top:-3,advance:Ds?Do[1]:Do[0]}).advance;var wl=Ds?Do[0]*br.scale-24*mr:Do[1]*br.scale-24*mr;wl>0&&wl>xi&&(xi=wl)}else{var Hc=jt[br.fontStack],Sl=Hc&&Hc[sa];if(Sl&&Sl.rect)no=Sl.rect,di=Sl.metrics;else{var xu=nr[br.fontStack],Xc=xu&&xu[sa];if(!Xc)continue;di=Xc.metrics}io=24*(mr-br.scale)}Ds?(yt.verticalizable=!0,Gr.push({glyph:sa,imageName:Aa,x:Ni,y:Sn+io,vertical:Ds,scale:br.scale,fontStack:br.fontStack,sectionIndex:ro,metrics:di,rect:no}),Ni+=bl*br.scale+Wr):(Gr.push({glyph:sa,imageName:Aa,x:Ni,y:Sn+io,vertical:Ds,scale:br.scale,fontStack:br.fontStack,sectionIndex:ro,metrics:di,rect:no}),Ni+=di.advance*br.scale+Wr)}Gr.length!==0&&(Xi=Math.max(Ni-Wr,Xi),Tg(Gr,0,Gr.length-1,fi,xi)),Ni=0;var Wc=vr*mr+xi;hn.lineOffset=Math.max(xi,Dn),Sn+=Wc,kn=Math.max(Wc,kn),++Wi}else Sn+=vr,++Wi}var Lo,wu=Sn- -17,kl=sp(Xr),$o=kl.horizontalAlign,El=kl.verticalAlign;(function(Yc,Jc,Su,ku,Qc,Eu,zu,Tu,$c){var zl,eh=(Jc-Su)*Qc;zl=Eu!==zu?-Tu*ku- -17:(-ku*$c+.5)*zu;for(var Tl=0,Iu=Yc;Tl<Iu.length;Tl+=1)for(var Ls=0,Au=Iu[Tl].positionedGlyphs;Ls<Au.length;Ls+=1){var Il=Au[Ls];Il.x+=eh,Il.y+=zl}})(yt.positionedLines,fi,$o,El,Xi,kn,vr,wu,Tt.length),yt.top+=-El*wu,yt.bottom=yt.top+wu,yt.left+=-$o*Xi,yt.right=yt.left+Xi}(Lt,t,i,l,ce,x,k,I,B,A,U,$),!function(yt){for(var nr=0,jt=yt;nr<jt.length;nr+=1)if(jt[nr].positionedGlyphs.length!==0)return!1;return!0}(Yt)&&Lt}wn.fromFeature=function(e,t){for(var i=new wn,l=0;l<e.sections.length;l++){var f=e.sections[l];f.image?i.addImageSection(f):i.addTextSection(f,t)}return i},wn.prototype.length=function(){return this.text.length},wn.prototype.getSection=function(e){return this.sections[this.sectionIndex[e]]},wn.prototype.getSectionIndex=function(e){return this.sectionIndex[e]},wn.prototype.getCharCode=function(e){return this.text.charCodeAt(e)},wn.prototype.verticalizePunctuation=function(){this.text=function(e){for(var t="",i=0;i<e.length;i++){var l=e.charCodeAt(i+1)||null,f=e.charCodeAt(i-1)||null;t+=l&&tu(l)&&!yu[e[i+1]]||f&&tu(f)&&!yu[e[i-1]]||!yu[e[i]]?e[i]:yu[e[i]]}return t}(this.text)},wn.prototype.trim=function(){for(var e=0,t=0;t<this.text.length&&Fc[this.text.charCodeAt(t)];t++)e++;for(var i=this.text.length,l=this.text.length-1;l>=0&&l>=e&&Fc[this.text.charCodeAt(l)];l--)i--;this.text=this.text.substring(e,i),this.sectionIndex=this.sectionIndex.slice(e,i)},wn.prototype.substring=function(e,t){var i=new wn;return i.text=this.text.substring(e,t),i.sectionIndex=this.sectionIndex.slice(e,t),i.sections=this.sections,i},wn.prototype.toString=function(){return this.text},wn.prototype.getMaxScale=function(){var e=this;return this.sectionIndex.reduce(function(t,i){return Math.max(t,e.sections[i].scale)},0)},wn.prototype.addTextSection=function(e,t){this.text+=e.text,this.sections.push(pl.forText(e.scale,e.fontStack||t));for(var i=this.sections.length-1,l=0;l<e.text.length;++l)this.sectionIndex.push(i)},wn.prototype.addImageSection=function(e){var t=e.image?e.image.name:"";if(t.length!==0){var i=this.getNextImageSectionCharCode();i?(this.text+=String.fromCharCode(i),this.sections.push(pl.forImage(t)),this.sectionIndex.push(this.sections.length-1)):st("Reached maximum number of images 6401")}else st("Can't add FormattedSection with an empty image.")},wn.prototype.getNextImageSectionCharCode=function(){return this.imageSectionID?this.imageSectionID>=63743?null:++this.imageSectionID:(this.imageSectionID=57344,this.imageSectionID)};var Fc={9:!0,10:!0,11:!0,12:!0,13:!0,32:!0},ta={};function _f(e,t,i,l,f,m){if(t.imageName){var x=l[t.imageName];return x?x.displaySize[0]*t.scale*24/m+f:0}var k=i[t.fontStack],I=k&&k[e];return I?I.metrics.advance*t.scale+f:0}function vf(e,t,i,l){var f=Math.pow(e-t,2);return l?e<t?f/2:2*f:f+Math.abs(i)*i}function zg(e,t,i){var l=0;return e===10&&(l-=1e4),i&&(l+=150),e!==40&&e!==65288||(l+=50),t!==41&&t!==65289||(l+=50),l}function bf(e,t,i,l,f,m){for(var x=null,k=vf(t,i,f,m),I=0,A=l;I<A.length;I+=1){var M=A[I],B=vf(t-M.x,i,f,m)+M.badness;B<=k&&(x=M,k=B)}return{index:e,x:t,priorBreak:x,badness:k}}function op(e,t,i,l,f,m,x){if(m!=="point")return[];if(!e)return[];for(var k,I=[],A=function(ce,ie,ye,be,we,ke){for(var Ce=0,Ve=0;Ve<ce.length();Ve++){var Je=ce.getSection(Ve);Ce+=_f(ce.getCharCode(Ve),Je,be,we,ie,ke)}return Ce/Math.max(1,Math.ceil(Ce/ye))}(e,t,i,l,f,x),M=e.text.indexOf("")>=0,B=0,U=0;U<e.length();U++){var j=e.getSection(U),J=e.getCharCode(U);if(Fc[J]||(B+=_f(J,j,l,f,t,x)),U<e.length()-1){var $=!((k=J)<11904||!(tt["Bopomofo Extended"](k)||tt.Bopomofo(k)||tt["CJK Compatibility Forms"](k)||tt["CJK Compatibility Ideographs"](k)||tt["CJK Compatibility"](k)||tt["CJK Radicals Supplement"](k)||tt["CJK Strokes"](k)||tt["CJK Symbols and Punctuation"](k)||tt["CJK Unified Ideographs Extension A"](k)||tt["CJK Unified Ideographs"](k)||tt["Enclosed CJK Letters and Months"](k)||tt["Halfwidth and Fullwidth Forms"](k)||tt.Hiragana(k)||tt["Ideographic Description Characters"](k)||tt["Kangxi Radicals"](k)||tt["Katakana Phonetic Extensions"](k)||tt.Katakana(k)||tt["Vertical Forms"](k)||tt["Yi Radicals"](k)||tt["Yi Syllables"](k)));(ta[J]||$||j.imageName)&&I.push(bf(U+1,B,A,I,zg(J,e.getCharCode(U+1),$&&M),!1))}}return function ce(ie){return ie?ce(ie.priorBreak).concat(ie.index):[]}(bf(e.length(),B,A,I,0,!0))}function sp(e){var t=.5,i=.5;switch(e){case"right":case"top-right":case"bottom-right":t=1;break;case"left":case"top-left":case"bottom-left":t=0}switch(e){case"bottom":case"bottom-right":case"bottom-left":i=1;break;case"top":case"top-right":case"top-left":i=0}return{horizontalAlign:t,verticalAlign:i}}function Tg(e,t,i,l,f){if(l||f)for(var m=e[i],x=(e[i].x+m.metrics.advance*m.scale)*l,k=t;k<=i;k++)e[k].x-=x,e[k].y+=f}function xf(e,t,i,l,f,m){var x,k=e.image;if(k.content){var I=k.content,A=k.pixelRatio||1;x=[I[0]/A,I[1]/A,k.displaySize[0]-I[2]/A,k.displaySize[1]-I[3]/A]}var M,B,U,j,J=t.left*m,$=t.right*m;i==="width"||i==="both"?(j=f[0]+J-l[3],B=f[0]+$+l[1]):B=(j=f[0]+(J+$-k.displaySize[0])/2)+k.displaySize[0];var ce=t.top*m,ie=t.bottom*m;return i==="height"||i==="both"?(M=f[1]+ce-l[0],U=f[1]+ie+l[2]):U=(M=f[1]+(ce+ie-k.displaySize[1])/2)+k.displaySize[1],{image:k,top:M,right:B,bottom:U,left:j,collisionPadding:x}}ta[10]=!0,ta[32]=!0,ta[38]=!0,ta[40]=!0,ta[41]=!0,ta[43]=!0,ta[45]=!0,ta[47]=!0,ta[173]=!0,ta[183]=!0,ta[8203]=!0,ta[8208]=!0,ta[8211]=!0,ta[8231]=!0;var fl=function(e){function t(i,l,f,m){e.call(this,i,l),this.angle=f,m!==void 0&&(this.segment=m)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.clone=function(){return new t(this.x,this.y,this.angle,this.segment)},t}(F);function lp(e,t){var i=t.expression;if(i.kind==="constant")return{kind:"constant",layoutSize:i.evaluate(new ar(e+1))};if(i.kind==="source")return{kind:"source"};for(var l=i.zoomStops,f=i.interpolationType,m=0;m<l.length&&l[m]<=e;)m++;for(var x=m=Math.max(0,m-1);x<l.length&&l[x]<e+1;)x++;x=Math.min(l.length-1,x);var k=l[m],I=l[x];return i.kind==="composite"?{kind:"composite",minZoom:k,maxZoom:I,interpolationType:f}:{kind:"camera",minZoom:k,maxZoom:I,minSize:i.evaluate(new ar(k)),maxSize:i.evaluate(new ar(I)),interpolationType:f}}function wf(e,t,i){var l=t.uSize,f=i.lowerSize;return e.kind==="source"?f/128:e.kind==="composite"?vi(f/128,i.upperSize/128,t.uSizeT):l}function Sf(e,t){var i=0,l=0;if(e.kind==="constant")l=e.layoutSize;else if(e.kind!=="source"){var f=e.interpolationType,m=f?ve(Qi.interpolationFactor(f,t,e.minZoom,e.maxZoom),0,1):0;e.kind==="camera"?l=vi(e.minSize,e.maxSize,m):i=m}return{uSizeT:i,uSize:l}}ft("Anchor",fl);var Ig=Object.freeze({__proto__:null,getSizeData:lp,evaluateSizeForFeature:wf,evaluateSizeForZoom:Sf,SIZE_PACK_FACTOR:128});function kf(e,t,i,l,f){if(t.segment===void 0)return!0;for(var m=t,x=t.segment+1,k=0;k>-i/2;){if(--x<0)return!1;k-=e[x].dist(m),m=e[x]}k+=e[x].dist(e[x+1]),x++;for(var I=[],A=0;k<i/2;){var M=e[x],B=e[x+1];if(!B)return!1;var U=e[x-1].angleTo(M)-M.angleTo(B);for(U=Math.abs((U+3*Math.PI)%(2*Math.PI)-Math.PI),I.push({distance:k,angleDelta:U}),A+=U;k-I[0].distance>l;)A-=I.shift().angleDelta;if(A>f)return!1;x++,k+=M.dist(B)}return!0}function Ef(e){for(var t=0,i=0;i<e.length-1;i++)t+=e[i].dist(e[i+1]);return t}function zf(e,t,i){return e?.6*t*i:0}function Tf(e,t){return Math.max(e?e.right-e.left:0,t?t.right-t.left:0)}function Ag(e,t,i,l,f,m){for(var x=zf(i,f,m),k=Tf(i,l)*m,I=0,A=Ef(e)/2,M=0;M<e.length-1;M++){var B=e[M],U=e[M+1],j=B.dist(U);if(I+j>A){var J=(A-I)/j,$=vi(B.x,U.x,J),ce=vi(B.y,U.y,J),ie=new fl($,ce,U.angleTo(B),M);return ie._round(),!x||kf(e,ie,k,x,t)?ie:void 0}I+=j}}function Pg(e,t,i,l,f,m,x,k,I){var A=zf(l,m,x),M=Tf(l,f),B=M*x,U=e[0].x===0||e[0].x===I||e[0].y===0||e[0].y===I;return t-B<t/4&&(t=B+t/4),function j(J,$,ce,ie,ye,be,we,ke,Ce){for(var Ve=be/2,Je=Ef(J),wt=0,ot=$-ce,zt=[],lt=0;lt<J.length-1;lt++){for(var Yt=J[lt],Lt=J[lt+1],yt=Yt.dist(Lt),nr=Lt.angleTo(Yt);ot+ce<wt+yt;){var jt=((ot+=ce)-wt)/yt,pr=vi(Yt.x,Lt.x,jt),Tt=vi(Yt.y,Lt.y,jt);if(pr>=0&&pr<Ce&&Tt>=0&&Tt<Ce&&ot-Ve>=0&&ot+Ve<=Je){var vr=new fl(pr,Tt,nr,lt);vr._round(),ie&&!kf(J,vr,be,ie,ye)||zt.push(vr)}}wt+=yt}return ke||zt.length||we||(zt=j(J,wt/2,ce,ie,ye,be,we,!0,Ce)),zt}(e,U?t/2*k%t:(M/2+2*m)*x*k%t,t,A,i,B,U,!1,I)}function If(e,t,i,l,f){for(var m=[],x=0;x<e.length;x++)for(var k=e[x],I=void 0,A=0;A<k.length-1;A++){var M=k[A],B=k[A+1];M.x<t&&B.x<t||(M.x<t?M=new F(t,M.y+(t-M.x)/(B.x-M.x)*(B.y-M.y))._round():B.x<t&&(B=new F(t,M.y+(t-M.x)/(B.x-M.x)*(B.y-M.y))._round()),M.y<i&&B.y<i||(M.y<i?M=new F(M.x+(i-M.y)/(B.y-M.y)*(B.x-M.x),i)._round():B.y<i&&(B=new F(M.x+(i-M.y)/(B.y-M.y)*(B.x-M.x),i)._round()),M.x>=l&&B.x>=l||(M.x>=l?M=new F(l,M.y+(l-M.x)/(B.x-M.x)*(B.y-M.y))._round():B.x>=l&&(B=new F(l,M.y+(l-M.x)/(B.x-M.x)*(B.y-M.y))._round()),M.y>=f&&B.y>=f||(M.y>=f?M=new F(M.x+(f-M.y)/(B.y-M.y)*(B.x-M.x),f)._round():B.y>=f&&(B=new F(M.x+(f-M.y)/(B.y-M.y)*(B.x-M.x),f)._round()),I&&M.equals(I[I.length-1])||m.push(I=[M]),I.push(B)))))}return m}function Af(e,t,i,l){var f=[],m=e.image,x=m.pixelRatio,k=m.paddedRect.w-2,I=m.paddedRect.h-2,A=e.right-e.left,M=e.bottom-e.top,B=m.stretchX||[[0,k]],U=m.stretchY||[[0,I]],j=function(pr,Tt){return pr+Tt[1]-Tt[0]},J=B.reduce(j,0),$=U.reduce(j,0),ce=k-J,ie=I-$,ye=0,be=J,we=0,ke=$,Ce=0,Ve=ce,Je=0,wt=ie;if(m.content&&l){var ot=m.content;ye=Nc(B,0,ot[0]),we=Nc(U,0,ot[1]),be=Nc(B,ot[0],ot[2]),ke=Nc(U,ot[1],ot[3]),Ce=ot[0]-ye,Je=ot[1]-we,Ve=ot[2]-ot[0]-be,wt=ot[3]-ot[1]-ke}var zt=function(pr,Tt,vr,Xr){var ai=Uc(pr.stretch-ye,be,A,e.left),Qr=Vc(pr.fixed-Ce,Ve,pr.stretch,J),Wr=Uc(Tt.stretch-we,ke,M,e.top),oi=Vc(Tt.fixed-Je,wt,Tt.stretch,$),Fi=Uc(vr.stretch-ye,be,A,e.left),Ni=Vc(vr.fixed-Ce,Ve,vr.stretch,J),Sn=Uc(Xr.stretch-we,ke,M,e.top),Xi=Vc(Xr.fixed-Je,wt,Xr.stretch,$),kn=new F(ai,Wr),fi=new F(Fi,Wr),Wi=new F(Fi,Sn),sr=new F(ai,Sn),Lr=new F(Qr/x,oi/x),Ar=new F(Ni/x,Xi/x),mr=t*Math.PI/180;if(mr){var Dn=Math.sin(mr),hn=Math.cos(mr),Gr=[hn,-Dn,Dn,hn];kn._matMult(Gr),fi._matMult(Gr),sr._matMult(Gr),Wi._matMult(Gr)}var xi=pr.stretch+pr.fixed,pn=Tt.stretch+Tt.fixed;return{tl:kn,tr:fi,bl:sr,br:Wi,tex:{x:m.paddedRect.x+1+xi,y:m.paddedRect.y+1+pn,w:vr.stretch+vr.fixed-xi,h:Xr.stretch+Xr.fixed-pn},writingMode:void 0,glyphOffset:[0,0],sectionIndex:0,pixelOffsetTL:Lr,pixelOffsetBR:Ar,minFontScaleX:Ve/x/A,minFontScaleY:wt/x/M,isSDF:i}};if(l&&(m.stretchX||m.stretchY))for(var lt=Pf(B,ce,J),Yt=Pf(U,ie,$),Lt=0;Lt<lt.length-1;Lt++)for(var yt=lt[Lt],nr=lt[Lt+1],jt=0;jt<Yt.length-1;jt++)f.push(zt(yt,Yt[jt],nr,Yt[jt+1]));else f.push(zt({fixed:0,stretch:-1},{fixed:0,stretch:-1},{fixed:0,stretch:k+1},{fixed:0,stretch:I+1}));return f}function Nc(e,t,i){for(var l=0,f=0,m=e;f<m.length;f+=1){var x=m[f];l+=Math.max(t,Math.min(i,x[1]))-Math.max(t,Math.min(i,x[0]))}return l}function Pf(e,t,i){for(var l=[{fixed:-1,stretch:0}],f=0,m=e;f<m.length;f+=1){var x=m[f],k=x[0],I=x[1],A=l[l.length-1];l.push({fixed:k-A.stretch,stretch:A.stretch}),l.push({fixed:k-A.stretch,stretch:A.stretch+(I-k)})}return l.push({fixed:t+1,stretch:i}),l}function Uc(e,t,i,l){return e/t*i+l}function Vc(e,t,i,l){return e-t*i/l}var qc=function(e,t,i,l,f,m,x,k,I,A){if(this.boxStartIndex=e.length,I){var M=m.top,B=m.bottom,U=m.collisionPadding;U&&(M-=U[1],B+=U[3]);var j=B-M;j>0&&(j=Math.max(10,j),this.circleDiameter=j)}else{var J=m.top*x-k,$=m.bottom*x+k,ce=m.left*x-k,ie=m.right*x+k,ye=m.collisionPadding;if(ye&&(ce-=ye[0]*x,J-=ye[1]*x,ie+=ye[2]*x,$+=ye[3]*x),A){var be=new F(ce,J),we=new F(ie,J),ke=new F(ce,$),Ce=new F(ie,$),Ve=A*Math.PI/180;be._rotate(Ve),we._rotate(Ve),ke._rotate(Ve),Ce._rotate(Ve),ce=Math.min(be.x,we.x,ke.x,Ce.x),ie=Math.max(be.x,we.x,ke.x,Ce.x),J=Math.min(be.y,we.y,ke.y,Ce.y),$=Math.max(be.y,we.y,ke.y,Ce.y)}e.emplaceBack(t.x,t.y,ce,J,ie,$,i,l,f)}this.boxEndIndex=e.length},dl=function(e,t){if(e===void 0&&(e=[]),t===void 0&&(t=Cg),this.data=e,this.length=this.data.length,this.compare=t,this.length>0)for(var i=(this.length>>1)-1;i>=0;i--)this._down(i)};function Cg(e,t){return e<t?-1:e>t?1:0}function Mg(e,t,i){t===void 0&&(t=1),i===void 0&&(i=!1);for(var l=1/0,f=1/0,m=-1/0,x=-1/0,k=e[0],I=0;I<k.length;I++){var A=k[I];(!I||A.x<l)&&(l=A.x),(!I||A.y<f)&&(f=A.y),(!I||A.x>m)&&(m=A.x),(!I||A.y>x)&&(x=A.y)}var M=Math.min(m-l,x-f),B=M/2,U=new dl([],Dg);if(M===0)return new F(l,f);for(var j=l;j<m;j+=M)for(var J=f;J<x;J+=M)U.push(new ml(j+B,J+B,B,e));for(var $=function(ye){for(var be=0,we=0,ke=0,Ce=ye[0],Ve=0,Je=Ce.length,wt=Je-1;Ve<Je;wt=Ve++){var ot=Ce[Ve],zt=Ce[wt],lt=ot.x*zt.y-zt.x*ot.y;we+=(ot.x+zt.x)*lt,ke+=(ot.y+zt.y)*lt,be+=3*lt}return new ml(we/be,ke/be,0,ye)}(e),ce=U.length;U.length;){var ie=U.pop();(ie.d>$.d||!$.d)&&($=ie,i&&console.log("found best %d after %d probes",Math.round(1e4*ie.d)/1e4,ce)),ie.max-$.d<=t||(U.push(new ml(ie.p.x-(B=ie.h/2),ie.p.y-B,B,e)),U.push(new ml(ie.p.x+B,ie.p.y-B,B,e)),U.push(new ml(ie.p.x-B,ie.p.y+B,B,e)),U.push(new ml(ie.p.x+B,ie.p.y+B,B,e)),ce+=4)}return i&&(console.log("num probes: "+ce),console.log("best distance: "+$.d)),$.p}function Dg(e,t){return t.max-e.max}function ml(e,t,i,l){this.p=new F(e,t),this.h=i,this.d=function(f,m){for(var x=!1,k=1/0,I=0;I<m.length;I++)for(var A=m[I],M=0,B=A.length,U=B-1;M<B;U=M++){var j=A[M],J=A[U];j.y>f.y!=J.y>f.y&&f.x<(J.x-j.x)*(f.y-j.y)/(J.y-j.y)+j.x&&(x=!x),k=Math.min(k,Wo(f,j,J))}return(x?1:-1)*Math.sqrt(k)}(this.p,l),this.max=this.d+this.h*Math.SQRT2}dl.prototype.push=function(e){this.data.push(e),this.length++,this._up(this.length-1)},dl.prototype.pop=function(){if(this.length!==0){var e=this.data[0],t=this.data.pop();return this.length--,this.length>0&&(this.data[0]=t,this._down(0)),e}},dl.prototype.peek=function(){return this.data[0]},dl.prototype._up=function(e){for(var t=this.data,i=this.compare,l=t[e];e>0;){var f=e-1>>1,m=t[f];if(i(l,m)>=0)break;t[e]=m,e=f}t[e]=l},dl.prototype._down=function(e){for(var t=this.data,i=this.compare,l=this.length>>1,f=t[e];e<l;){var m=1+(e<<1),x=t[m],k=m+1;if(k<this.length&&i(t[k],x)<0&&(m=k,x=t[k]),i(x,f)>=0)break;t[e]=x,e=m}t[e]=f};var up=Number.POSITIVE_INFINITY;function Cf(e,t){return t[1]!==up?function(i,l,f){var m=0,x=0;switch(l=Math.abs(l),f=Math.abs(f),i){case"top-right":case"top-left":case"top":x=f-7;break;case"bottom-right":case"bottom-left":case"bottom":x=7-f}switch(i){case"top-right":case"bottom-right":case"right":m=-l;break;case"top-left":case"bottom-left":case"left":m=l}return[m,x]}(e,t[0],t[1]):function(i,l){var f=0,m=0;l<0&&(l=0);var x=l/Math.sqrt(2);switch(i){case"top-right":case"top-left":m=x-7;break;case"bottom-right":case"bottom-left":m=7-x;break;case"bottom":m=7-l;break;case"top":m=l-7}switch(i){case"top-right":case"bottom-right":f=-x;break;case"top-left":case"bottom-left":f=x;break;case"left":f=l;break;case"right":f=-l}return[f,m]}(e,t[0])}function cp(e){switch(e){case"right":case"top-right":case"bottom-right":return"right";case"left":case"top-left":case"bottom-left":return"left"}return"center"}function Mf(e,t,i,l,f,m,x,k,I,A,M,B,U,j,J){var $=function(we,ke,Ce,Ve,Je,wt,ot,zt){for(var lt=Ve.layout.get("text-rotate").evaluate(wt,{})*Math.PI/180,Yt=[],Lt=0,yt=ke.positionedLines;Lt<yt.length;Lt+=1)for(var nr=yt[Lt],jt=0,pr=nr.positionedGlyphs;jt<pr.length;jt+=1){var Tt=pr[jt];if(Tt.rect){var vr=Tt.rect||{},Xr=4,ai=!0,Qr=1,Wr=0,oi=(Je||zt)&&Tt.vertical,Fi=Tt.metrics.advance*Tt.scale/2;if(zt&&ke.verticalizable&&(Wr=nr.lineOffset/2-(Tt.imageName?-(24-Tt.metrics.width*Tt.scale)/2:24*(Tt.scale-1))),Tt.imageName){var Ni=ot[Tt.imageName];ai=Ni.sdf,Xr=1/(Qr=Ni.pixelRatio)}var Sn=Je?[Tt.x+Fi,Tt.y]:[0,0],Xi=Je?[0,0]:[Tt.x+Fi+Ce[0],Tt.y+Ce[1]-Wr],kn=[0,0];oi&&(kn=Xi,Xi=[0,0]);var fi=(Tt.metrics.left-Xr)*Tt.scale-Fi+Xi[0],Wi=(-Tt.metrics.top-Xr)*Tt.scale+Xi[1],sr=fi+vr.w*Tt.scale/Qr,Lr=Wi+vr.h*Tt.scale/Qr,Ar=new F(fi,Wi),mr=new F(sr,Wi),Dn=new F(fi,Lr),hn=new F(sr,Lr);if(oi){var Gr=new F(-Fi,Fi- -17),xi=-Math.PI/2,pn=12-Fi,br=new F(22-pn,-(Tt.imageName?pn:0)),ro=new(Function.prototype.bind.apply(F,[null].concat(kn)));Ar._rotateAround(xi,Gr)._add(br)._add(ro),mr._rotateAround(xi,Gr)._add(br)._add(ro),Dn._rotateAround(xi,Gr)._add(br)._add(ro),hn._rotateAround(xi,Gr)._add(br)._add(ro)}if(lt){var sa=Math.sin(lt),io=Math.cos(lt),di=[io,-sa,sa,io];Ar._matMult(di),mr._matMult(di),Dn._matMult(di),hn._matMult(di)}var no=new F(0,0),Aa=new F(0,0);Yt.push({tl:Ar,tr:mr,bl:Dn,br:hn,tex:vr,writingMode:ke.writingMode,glyphOffset:Sn,sectionIndex:Tt.sectionIndex,isSDF:ai,pixelOffsetTL:no,pixelOffsetBR:Aa,minFontScaleX:0,minFontScaleY:0})}}return Yt}(0,i,k,f,m,x,l,e.allowVerticalPlacement),ce=e.textSizeData,ie=null;ce.kind==="source"?(ie=[128*f.layout.get("text-size").evaluate(x,{})])[0]>32640&&st(e.layerIds[0]+': Value for "text-size" is >= 255. Reduce your "text-size".'):ce.kind==="composite"&&((ie=[128*j.compositeTextSizes[0].evaluate(x,{},J),128*j.compositeTextSizes[1].evaluate(x,{},J)])[0]>32640||ie[1]>32640)&&st(e.layerIds[0]+': Value for "text-size" is >= 255. Reduce your "text-size".'),e.addSymbols(e.text,$,ie,k,m,x,A,t,I.lineStartIndex,I.lineLength,U,J);for(var ye=0,be=M;ye<be.length;ye+=1)B[be[ye]]=e.text.placedSymbolArray.length-1;return 4*$.length}function Df(e){for(var t in e)return e[t];return null}function Lg(e,t,i,l){var f=e.compareText;if(t in f){for(var m=f[t],x=m.length-1;x>=0;x--)if(l.dist(m[x])<i)return!0}else f[t]=[];return f[t].push(l),!1}var Rg=ul.VectorTileFeature.types,Bg=[{name:"a_fade_opacity",components:1,type:"Uint8",offset:0}];function jc(e,t,i,l,f,m,x,k,I,A,M,B,U){var j=k?Math.min(32640,Math.round(k[0])):0,J=k?Math.min(32640,Math.round(k[1])):0;e.emplaceBack(t,i,Math.round(32*l),Math.round(32*f),m,x,(j<<1)+(I?1:0),J,16*A,16*M,256*B,256*U)}function hp(e,t,i){e.emplaceBack(t.x,t.y,i),e.emplaceBack(t.x,t.y,i),e.emplaceBack(t.x,t.y,i),e.emplaceBack(t.x,t.y,i)}function Og(e){for(var t=0,i=e.sections;t<i.length;t+=1)if(Qs(i[t].text))return!0;return!1}var yl=function(e){this.layoutVertexArray=new rl,this.indexArray=new Ya,this.programConfigurations=e,this.segments=new G,this.dynamicLayoutVertexArray=new Ko,this.opacityVertexArray=new Ss,this.placedSymbolArray=new c};yl.prototype.isEmpty=function(){return this.layoutVertexArray.length===0&&this.indexArray.length===0&&this.dynamicLayoutVertexArray.length===0&&this.opacityVertexArray.length===0},yl.prototype.upload=function(e,t,i,l){this.isEmpty()||(i&&(this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,ug.members),this.indexBuffer=e.createIndexBuffer(this.indexArray,t),this.dynamicLayoutVertexBuffer=e.createVertexBuffer(this.dynamicLayoutVertexArray,cg.members,!0),this.opacityVertexBuffer=e.createVertexBuffer(this.opacityVertexArray,Bg,!0),this.opacityVertexBuffer.itemSize=1),(i||l)&&this.programConfigurations.upload(e))},yl.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.dynamicLayoutVertexBuffer.destroy(),this.opacityVertexBuffer.destroy())},ft("SymbolBuffers",yl);var vu=function(e,t,i){this.layoutVertexArray=new e,this.layoutAttributes=t,this.indexArray=new i,this.segments=new G,this.collisionVertexArray=new su};vu.prototype.upload=function(e){this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,this.layoutAttributes),this.indexBuffer=e.createIndexBuffer(this.indexArray),this.collisionVertexBuffer=e.createVertexBuffer(this.collisionVertexArray,hg.members,!0)},vu.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.collisionVertexBuffer.destroy())},ft("CollisionBuffers",vu);var Cr=function(e){this.collisionBoxArray=e.collisionBoxArray,this.zoom=e.zoom,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map(function(m){return m.id}),this.index=e.index,this.pixelRatio=e.pixelRatio,this.sourceLayerIndex=e.sourceLayerIndex,this.hasPattern=!1,this.hasRTLText=!1,this.sortKeyRanges=[],this.collisionCircleArray=[],this.placementInvProjMatrix=ea([]),this.placementViewportMatrix=ea([]);var t=this.layers[0]._unevaluatedLayout._values;this.textSizeData=lp(this.zoom,t["text-size"]),this.iconSizeData=lp(this.zoom,t["icon-size"]);var i=this.layers[0].layout,l=i.get("symbol-sort-key"),f=i.get("symbol-z-order");this.canOverlap=i.get("text-allow-overlap")||i.get("icon-allow-overlap")||i.get("text-ignore-placement")||i.get("icon-ignore-placement"),this.sortFeaturesByKey=f!=="viewport-y"&&l.constantOr(1)!==void 0,this.sortFeaturesByY=(f==="viewport-y"||f==="auto"&&!this.sortFeaturesByKey)&&this.canOverlap,i.get("symbol-placement")==="point"&&(this.writingModes=i.get("text-writing-mode").map(function(m){return oa[m]})),this.stateDependentLayerIds=this.layers.filter(function(m){return m.isStateDependent()}).map(function(m){return m.id}),this.sourceID=e.sourceID};Cr.prototype.createArrays=function(){this.text=new yl(new Mt(this.layers,this.zoom,function(e){return/^text/.test(e)})),this.icon=new yl(new Mt(this.layers,this.zoom,function(e){return/^icon/.test(e)})),this.glyphOffsetArray=new S,this.lineVertexArray=new z,this.symbolInstances=new w},Cr.prototype.calculateGlyphDependencies=function(e,t,i,l,f){for(var m=0;m<e.length;m++)if(t[e.charCodeAt(m)]=!0,(i||l)&&f){var x=yu[e.charAt(m)];x&&(t[x.charCodeAt(0)]=!0)}},Cr.prototype.populate=function(e,t,i){var l=this.layers[0],f=l.layout,m=f.get("text-font"),x=f.get("text-field"),k=f.get("icon-image"),I=(x.value.kind!=="constant"||x.value.value instanceof ri&&!x.value.value.isEmpty()||x.value.value.toString().length>0)&&(m.value.kind!=="constant"||m.value.value.length>0),A=k.value.kind!=="constant"||!!k.value.value||Object.keys(k.parameters).length>0,M=f.get("symbol-sort-key");if(this.features=[],I||A){for(var B=t.iconDependencies,U=t.glyphDependencies,j=t.availableImages,J=new ar(this.zoom),$=0,ce=e;$<ce.length;$+=1){var ie=ce[$],ye=ie.feature,be=ie.id,we=ie.index,ke=ie.sourceLayerIndex,Ce=l._featureFilter.needGeometry,Ve=pi(ye,Ce);if(l._featureFilter.filter(J,Ve,i)){Ce||(Ve.geometry=Jr(ye));var Je=void 0;if(I){var wt=l.getValueAndResolveTokens("text-field",Ve,i,j),ot=ri.factory(wt);Og(ot)&&(this.hasRTLText=!0),(!this.hasRTLText||iu()==="unavailable"||this.hasRTLText&&$n.isParsed())&&(Je=fg(ot,l,Ve))}var zt=void 0;if(A){var lt=l.getValueAndResolveTokens("icon-image",Ve,i,j);zt=lt instanceof Ri?lt:Ri.fromString(lt)}if(Je||zt){var Yt=this.sortFeaturesByKey?M.evaluate(Ve,{},i):void 0;if(this.features.push({id:be,text:Je,icon:zt,index:we,sourceLayerIndex:ke,geometry:Ve.geometry,properties:ye.properties,type:Rg[ye.type],sortKey:Yt}),zt&&(B[zt.name]=!0),Je){var Lt=m.evaluate(Ve,{},i).join(","),yt=f.get("text-rotation-alignment")==="map"&&f.get("symbol-placement")!=="point";this.allowVerticalPlacement=this.writingModes&&this.writingModes.indexOf(oa.vertical)>=0;for(var nr=0,jt=Je.sections;nr<jt.length;nr+=1){var pr=jt[nr];if(pr.image)B[pr.image.name]=!0;else{var Tt=eu(Je.toString()),vr=pr.fontStack||Lt,Xr=U[vr]=U[vr]||{};this.calculateGlyphDependencies(pr.text,Xr,yt,this.allowVerticalPlacement,Tt)}}}}}}f.get("symbol-placement")==="line"&&(this.features=function(ai){var Qr={},Wr={},oi=[],Fi=0;function Ni(Gr){oi.push(ai[Gr]),Fi++}function Sn(Gr,xi,pn){var br=Wr[Gr];return delete Wr[Gr],Wr[xi]=br,oi[br].geometry[0].pop(),oi[br].geometry[0]=oi[br].geometry[0].concat(pn[0]),br}function Xi(Gr,xi,pn){var br=Qr[xi];return delete Qr[xi],Qr[Gr]=br,oi[br].geometry[0].shift(),oi[br].geometry[0]=pn[0].concat(oi[br].geometry[0]),br}function kn(Gr,xi,pn){var br=pn?xi[0][xi[0].length-1]:xi[0][0];return Gr+":"+br.x+":"+br.y}for(var fi=0;fi<ai.length;fi++){var Wi=ai[fi],sr=Wi.geometry,Lr=Wi.text?Wi.text.toString():null;if(Lr){var Ar=kn(Lr,sr),mr=kn(Lr,sr,!0);if(Ar in Wr&&mr in Qr&&Wr[Ar]!==Qr[mr]){var Dn=Xi(Ar,mr,sr),hn=Sn(Ar,mr,oi[Dn].geometry);delete Qr[Ar],delete Wr[mr],Wr[kn(Lr,oi[hn].geometry,!0)]=hn,oi[Dn].geometry=null}else Ar in Wr?Sn(Ar,mr,sr):mr in Qr?Xi(Ar,mr,sr):(Ni(fi),Qr[Ar]=Fi-1,Wr[mr]=Fi-1)}else Ni(fi)}return oi.filter(function(Gr){return Gr.geometry})}(this.features)),this.sortFeaturesByKey&&this.features.sort(function(ai,Qr){return ai.sortKey-Qr.sortKey})}},Cr.prototype.update=function(e,t,i){this.stateDependentLayers.length&&(this.text.programConfigurations.updatePaintArrays(e,t,this.layers,i),this.icon.programConfigurations.updatePaintArrays(e,t,this.layers,i))},Cr.prototype.isEmpty=function(){return this.symbolInstances.length===0&&!this.hasRTLText},Cr.prototype.uploadPending=function(){return!this.uploaded||this.text.programConfigurations.needsUpload||this.icon.programConfigurations.needsUpload},Cr.prototype.upload=function(e){!this.uploaded&&this.hasDebugData()&&(this.textCollisionBox.upload(e),this.iconCollisionBox.upload(e)),this.text.upload(e,this.sortFeaturesByY,!this.uploaded,this.text.programConfigurations.needsUpload),this.icon.upload(e,this.sortFeaturesByY,!this.uploaded,this.icon.programConfigurations.needsUpload),this.uploaded=!0},Cr.prototype.destroyDebugData=function(){this.textCollisionBox.destroy(),this.iconCollisionBox.destroy()},Cr.prototype.destroy=function(){this.text.destroy(),this.icon.destroy(),this.hasDebugData()&&this.destroyDebugData()},Cr.prototype.addToLineVertexArray=function(e,t){var i=this.lineVertexArray.length;if(e.segment!==void 0){for(var l=e.dist(t[e.segment+1]),f=e.dist(t[e.segment]),m={},x=e.segment+1;x<t.length;x++)m[x]={x:t[x].x,y:t[x].y,tileUnitDistanceFromAnchor:l},x<t.length-1&&(l+=t[x+1].dist(t[x]));for(var k=e.segment||0;k>=0;k--)m[k]={x:t[k].x,y:t[k].y,tileUnitDistanceFromAnchor:f},k>0&&(f+=t[k-1].dist(t[k]));for(var I=0;I<t.length;I++){var A=m[I];this.lineVertexArray.emplaceBack(A.x,A.y,A.tileUnitDistanceFromAnchor)}}return{lineStartIndex:i,lineLength:this.lineVertexArray.length-i}},Cr.prototype.addSymbols=function(e,t,i,l,f,m,x,k,I,A,M,B){for(var U=e.indexArray,j=e.layoutVertexArray,J=e.segments.prepareSegment(4*t.length,j,U,this.canOverlap?m.sortKey:void 0),$=this.glyphOffsetArray.length,ce=J.vertexLength,ie=this.allowVerticalPlacement&&x===oa.vertical?Math.PI/2:0,ye=m.text&&m.text.sections,be=0;be<t.length;be++){var we=t[be],ke=we.tl,Ce=we.tr,Ve=we.bl,Je=we.br,wt=we.tex,ot=we.pixelOffsetTL,zt=we.pixelOffsetBR,lt=we.minFontScaleX,Yt=we.minFontScaleY,Lt=we.glyphOffset,yt=we.isSDF,nr=we.sectionIndex,jt=J.vertexLength,pr=Lt[1];jc(j,k.x,k.y,ke.x,pr+ke.y,wt.x,wt.y,i,yt,ot.x,ot.y,lt,Yt),jc(j,k.x,k.y,Ce.x,pr+Ce.y,wt.x+wt.w,wt.y,i,yt,zt.x,ot.y,lt,Yt),jc(j,k.x,k.y,Ve.x,pr+Ve.y,wt.x,wt.y+wt.h,i,yt,ot.x,zt.y,lt,Yt),jc(j,k.x,k.y,Je.x,pr+Je.y,wt.x+wt.w,wt.y+wt.h,i,yt,zt.x,zt.y,lt,Yt),hp(e.dynamicLayoutVertexArray,k,ie),U.emplaceBack(jt,jt+1,jt+2),U.emplaceBack(jt+1,jt+2,jt+3),J.vertexLength+=4,J.primitiveLength+=2,this.glyphOffsetArray.emplaceBack(Lt[0]),be!==t.length-1&&nr===t[be+1].sectionIndex||e.programConfigurations.populatePaintArrays(j.length,m,m.index,{},B,ye&&ye[nr])}e.placedSymbolArray.emplaceBack(k.x,k.y,$,this.glyphOffsetArray.length-$,ce,I,A,k.segment,i?i[0]:0,i?i[1]:0,l[0],l[1],x,0,!1,0,M)},Cr.prototype._addCollisionDebugVertex=function(e,t,i,l,f,m){return t.emplaceBack(0,0),e.emplaceBack(i.x,i.y,l,f,Math.round(m.x),Math.round(m.y))},Cr.prototype.addCollisionDebugVertices=function(e,t,i,l,f,m,x){var k=f.segments.prepareSegment(4,f.layoutVertexArray,f.indexArray),I=k.vertexLength,A=f.layoutVertexArray,M=f.collisionVertexArray,B=x.anchorX,U=x.anchorY;this._addCollisionDebugVertex(A,M,m,B,U,new F(e,t)),this._addCollisionDebugVertex(A,M,m,B,U,new F(i,t)),this._addCollisionDebugVertex(A,M,m,B,U,new F(i,l)),this._addCollisionDebugVertex(A,M,m,B,U,new F(e,l)),k.vertexLength+=4;var j=f.indexArray;j.emplaceBack(I,I+1),j.emplaceBack(I+1,I+2),j.emplaceBack(I+2,I+3),j.emplaceBack(I+3,I),k.primitiveLength+=4},Cr.prototype.addDebugCollisionBoxes=function(e,t,i,l){for(var f=e;f<t;f++){var m=this.collisionBoxArray.get(f);this.addCollisionDebugVertices(m.x1,m.y1,m.x2,m.y2,l?this.textCollisionBox:this.iconCollisionBox,m.anchorPoint,i)}},Cr.prototype.generateCollisionDebugBuffers=function(){this.hasDebugData()&&this.destroyDebugData(),this.textCollisionBox=new vu(Ho,hf.members,ks),this.iconCollisionBox=new vu(Ho,hf.members,ks);for(var e=0;e<this.symbolInstances.length;e++){var t=this.symbolInstances.get(e);this.addDebugCollisionBoxes(t.textBoxStartIndex,t.textBoxEndIndex,t,!0),this.addDebugCollisionBoxes(t.verticalTextBoxStartIndex,t.verticalTextBoxEndIndex,t,!0),this.addDebugCollisionBoxes(t.iconBoxStartIndex,t.iconBoxEndIndex,t,!1),this.addDebugCollisionBoxes(t.verticalIconBoxStartIndex,t.verticalIconBoxEndIndex,t,!1)}},Cr.prototype._deserializeCollisionBoxesForSymbol=function(e,t,i,l,f,m,x,k,I){for(var A={},M=t;M<i;M++){var B=e.get(M);A.textBox={x1:B.x1,y1:B.y1,x2:B.x2,y2:B.y2,anchorPointX:B.anchorPointX,anchorPointY:B.anchorPointY},A.textFeatureIndex=B.featureIndex;break}for(var U=l;U<f;U++){var j=e.get(U);A.verticalTextBox={x1:j.x1,y1:j.y1,x2:j.x2,y2:j.y2,anchorPointX:j.anchorPointX,anchorPointY:j.anchorPointY},A.verticalTextFeatureIndex=j.featureIndex;break}for(var J=m;J<x;J++){var $=e.get(J);A.iconBox={x1:$.x1,y1:$.y1,x2:$.x2,y2:$.y2,anchorPointX:$.anchorPointX,anchorPointY:$.anchorPointY},A.iconFeatureIndex=$.featureIndex;break}for(var ce=k;ce<I;ce++){var ie=e.get(ce);A.verticalIconBox={x1:ie.x1,y1:ie.y1,x2:ie.x2,y2:ie.y2,anchorPointX:ie.anchorPointX,anchorPointY:ie.anchorPointY},A.verticalIconFeatureIndex=ie.featureIndex;break}return A},Cr.prototype.deserializeCollisionBoxes=function(e){this.collisionArrays=[];for(var t=0;t<this.symbolInstances.length;t++){var i=this.symbolInstances.get(t);this.collisionArrays.push(this._deserializeCollisionBoxesForSymbol(e,i.textBoxStartIndex,i.textBoxEndIndex,i.verticalTextBoxStartIndex,i.verticalTextBoxEndIndex,i.iconBoxStartIndex,i.iconBoxEndIndex,i.verticalIconBoxStartIndex,i.verticalIconBoxEndIndex))}},Cr.prototype.hasTextData=function(){return this.text.segments.get().length>0},Cr.prototype.hasIconData=function(){return this.icon.segments.get().length>0},Cr.prototype.hasDebugData=function(){return this.textCollisionBox&&this.iconCollisionBox},Cr.prototype.hasTextCollisionBoxData=function(){return this.hasDebugData()&&this.textCollisionBox.segments.get().length>0},Cr.prototype.hasIconCollisionBoxData=function(){return this.hasDebugData()&&this.iconCollisionBox.segments.get().length>0},Cr.prototype.addIndicesForPlacedSymbol=function(e,t){for(var i=e.placedSymbolArray.get(t),l=i.vertexStartIndex+4*i.numGlyphs,f=i.vertexStartIndex;f<l;f+=4)e.indexArray.emplaceBack(f,f+1,f+2),e.indexArray.emplaceBack(f+1,f+2,f+3)},Cr.prototype.getSortedSymbolIndexes=function(e){if(this.sortedAngle===e&&this.symbolInstanceIndexes!==void 0)return this.symbolInstanceIndexes;for(var t=Math.sin(e),i=Math.cos(e),l=[],f=[],m=[],x=0;x<this.symbolInstances.length;++x){m.push(x);var k=this.symbolInstances.get(x);l.push(0|Math.round(t*k.anchorX+i*k.anchorY)),f.push(k.featureIndex)}return m.sort(function(I,A){return l[I]-l[A]||f[A]-f[I]}),m},Cr.prototype.addToSortKeyRanges=function(e,t){var i=this.sortKeyRanges[this.sortKeyRanges.length-1];i&&i.sortKey===t?i.symbolInstanceEnd=e+1:this.sortKeyRanges.push({sortKey:t,symbolInstanceStart:e,symbolInstanceEnd:e+1})},Cr.prototype.sortFeatures=function(e){var t=this;if(this.sortFeaturesByY&&this.sortedAngle!==e&&!(this.text.segments.get().length>1||this.icon.segments.get().length>1)){this.symbolInstanceIndexes=this.getSortedSymbolIndexes(e),this.sortedAngle=e,this.text.indexArray.clear(),this.icon.indexArray.clear(),this.featureSortOrder=[];for(var i=0,l=this.symbolInstanceIndexes;i<l.length;i+=1){var f=this.symbolInstances.get(l[i]);this.featureSortOrder.push(f.featureIndex),[f.rightJustifiedTextSymbolIndex,f.centerJustifiedTextSymbolIndex,f.leftJustifiedTextSymbolIndex].forEach(function(m,x,k){m>=0&&k.indexOf(m)===x&&t.addIndicesForPlacedSymbol(t.text,m)}),f.verticalPlacedTextSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.text,f.verticalPlacedTextSymbolIndex),f.placedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,f.placedIconSymbolIndex),f.verticalPlacedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,f.verticalPlacedIconSymbolIndex)}this.text.indexBuffer&&this.text.indexBuffer.updateData(this.text.indexArray),this.icon.indexBuffer&&this.icon.indexBuffer.updateData(this.icon.indexArray)}},ft("SymbolBucket",Cr,{omit:["layers","collisionBoxArray","features","compareText"]}),Cr.MAX_GLYPHS=65535,Cr.addDynamicAttributes=hp;var Fg=new en({"symbol-placement":new kt(q.layout_symbol["symbol-placement"]),"symbol-spacing":new kt(q.layout_symbol["symbol-spacing"]),"symbol-avoid-edges":new kt(q.layout_symbol["symbol-avoid-edges"]),"symbol-sort-key":new mt(q.layout_symbol["symbol-sort-key"]),"symbol-z-order":new kt(q.layout_symbol["symbol-z-order"]),"icon-allow-overlap":new kt(q.layout_symbol["icon-allow-overlap"]),"icon-ignore-placement":new kt(q.layout_symbol["icon-ignore-placement"]),"icon-optional":new kt(q.layout_symbol["icon-optional"]),"icon-rotation-alignment":new kt(q.layout_symbol["icon-rotation-alignment"]),"icon-size":new mt(q.layout_symbol["icon-size"]),"icon-text-fit":new kt(q.layout_symbol["icon-text-fit"]),"icon-text-fit-padding":new kt(q.layout_symbol["icon-text-fit-padding"]),"icon-image":new mt(q.layout_symbol["icon-image"]),"icon-rotate":new mt(q.layout_symbol["icon-rotate"]),"icon-padding":new kt(q.layout_symbol["icon-padding"]),"icon-keep-upright":new kt(q.layout_symbol["icon-keep-upright"]),"icon-offset":new mt(q.layout_symbol["icon-offset"]),"icon-anchor":new mt(q.layout_symbol["icon-anchor"]),"icon-pitch-alignment":new kt(q.layout_symbol["icon-pitch-alignment"]),"text-pitch-alignment":new kt(q.layout_symbol["text-pitch-alignment"]),"text-rotation-alignment":new kt(q.layout_symbol["text-rotation-alignment"]),"text-field":new mt(q.layout_symbol["text-field"]),"text-font":new mt(q.layout_symbol["text-font"]),"text-size":new mt(q.layout_symbol["text-size"]),"text-max-width":new mt(q.layout_symbol["text-max-width"]),"text-line-height":new kt(q.layout_symbol["text-line-height"]),"text-letter-spacing":new mt(q.layout_symbol["text-letter-spacing"]),"text-justify":new mt(q.layout_symbol["text-justify"]),"text-radial-offset":new mt(q.layout_symbol["text-radial-offset"]),"text-variable-anchor":new kt(q.layout_symbol["text-variable-anchor"]),"text-anchor":new mt(q.layout_symbol["text-anchor"]),"text-max-angle":new kt(q.layout_symbol["text-max-angle"]),"text-writing-mode":new kt(q.layout_symbol["text-writing-mode"]),"text-rotate":new mt(q.layout_symbol["text-rotate"]),"text-padding":new kt(q.layout_symbol["text-padding"]),"text-keep-upright":new kt(q.layout_symbol["text-keep-upright"]),"text-transform":new mt(q.layout_symbol["text-transform"]),"text-offset":new mt(q.layout_symbol["text-offset"]),"text-allow-overlap":new kt(q.layout_symbol["text-allow-overlap"]),"text-ignore-placement":new kt(q.layout_symbol["text-ignore-placement"]),"text-optional":new kt(q.layout_symbol["text-optional"])}),pp={paint:new en({"icon-opacity":new mt(q.paint_symbol["icon-opacity"]),"icon-color":new mt(q.paint_symbol["icon-color"]),"icon-halo-color":new mt(q.paint_symbol["icon-halo-color"]),"icon-halo-width":new mt(q.paint_symbol["icon-halo-width"]),"icon-halo-blur":new mt(q.paint_symbol["icon-halo-blur"]),"icon-translate":new kt(q.paint_symbol["icon-translate"]),"icon-translate-anchor":new kt(q.paint_symbol["icon-translate-anchor"]),"text-opacity":new mt(q.paint_symbol["text-opacity"]),"text-color":new mt(q.paint_symbol["text-color"],{runtimeType:Ye,getOverride:function(e){return e.textColor},hasOverride:function(e){return!!e.textColor}}),"text-halo-color":new mt(q.paint_symbol["text-halo-color"]),"text-halo-width":new mt(q.paint_symbol["text-halo-width"]),"text-halo-blur":new mt(q.paint_symbol["text-halo-blur"]),"text-translate":new kt(q.paint_symbol["text-translate"]),"text-translate-anchor":new kt(q.paint_symbol["text-translate-anchor"])}),layout:Fg},gl=function(e){this.type=e.property.overrides?e.property.overrides.runtimeType:nt,this.defaultValue=e};gl.prototype.evaluate=function(e){if(e.formattedSection){var t=this.defaultValue.property.overrides;if(t&&t.hasOverride(e.formattedSection))return t.getOverride(e.formattedSection)}return e.feature&&e.featureState?this.defaultValue.evaluate(e.feature,e.featureState):this.defaultValue.property.specification.default},gl.prototype.eachChild=function(e){this.defaultValue.isConstant()||e(this.defaultValue.value._styleExpression.expression)},gl.prototype.outputDefined=function(){return!1},gl.prototype.serialize=function(){return null},ft("FormatSectionOverride",gl,{omit:["defaultValue"]});var Ng=function(e){function t(i){e.call(this,i,pp)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.recalculate=function(i,l){if(e.prototype.recalculate.call(this,i,l),this.layout.get("icon-rotation-alignment")==="auto"&&(this.layout._values["icon-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-rotation-alignment")==="auto"&&(this.layout._values["text-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-pitch-alignment")==="auto"&&(this.layout._values["text-pitch-alignment"]=this.layout.get("text-rotation-alignment")),this.layout.get("icon-pitch-alignment")==="auto"&&(this.layout._values["icon-pitch-alignment"]=this.layout.get("icon-rotation-alignment")),this.layout.get("symbol-placement")==="point"){var f=this.layout.get("text-writing-mode");if(f){for(var m=[],x=0,k=f;x<k.length;x+=1){var I=k[x];m.indexOf(I)<0&&m.push(I)}this.layout._values["text-writing-mode"]=m}else this.layout._values["text-writing-mode"]=["horizontal"]}this._setPaintOverrides()},t.prototype.getValueAndResolveTokens=function(i,l,f,m){var x=this.layout.get(i).evaluate(l,{},f,m),k=this._unevaluatedLayout._values[i];return k.isDataDriven()||ps(k.value)||!x?x:function(I,A){return A.replace(/{([^{}]+)}/g,function(M,B){return B in I?String(I[B]):""})}(l.properties,x)},t.prototype.createBucket=function(i){return new Cr(i)},t.prototype.queryRadius=function(){return 0},t.prototype.queryIntersectsFeature=function(){return!1},t.prototype._setPaintOverrides=function(){for(var i=0,l=pp.paint.overridableProperties;i<l.length;i+=1){var f=l[i];if(t.hasPaintOverride(this.layout,f)){var m,x=this.paint.get(f),k=new gl(x),I=new Uo(k,x.property.specification);m=x.value.kind==="constant"||x.value.kind==="source"?new fs("source",I):new Vo("composite",I,x.value.zoomStops,x.value._interpolationType),this.paint._values[f]=new vn(x.property,m,x.parameters)}}},t.prototype._handleOverridablePaintPropertyUpdate=function(i,l,f){return!(!this.layout||l.isDataDriven()||f.isDataDriven())&&t.hasPaintOverride(this.layout,i)},t.hasPaintOverride=function(i,l){var f=i.get("text-field"),m=pp.paint.properties[l],x=!1,k=function(M){for(var B=0,U=M;B<U.length;B+=1)if(m.overrides&&m.overrides.hasOverride(U[B]))return void(x=!0)};if(f.value.kind==="constant"&&f.value.value instanceof ri)k(f.value.value.sections);else if(f.value.kind==="source"){var I=function(M){x||(M instanceof ki&&jr(M.value)===_r?k(M.value.sections):M instanceof Bn?k(M.sections):M.eachChild(I))},A=f.value;A._styleExpression&&I(A._styleExpression.expression)}return x},t}(Ea),Ug={paint:new en({"background-color":new kt(q.paint_background["background-color"]),"background-pattern":new bn(q.paint_background["background-pattern"]),"background-opacity":new kt(q.paint_background["background-opacity"])})},Vg=function(e){function t(i){e.call(this,i,Ug)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t}(Ea),qg={paint:new en({"raster-opacity":new kt(q.paint_raster["raster-opacity"]),"raster-hue-rotate":new kt(q.paint_raster["raster-hue-rotate"]),"raster-brightness-min":new kt(q.paint_raster["raster-brightness-min"]),"raster-brightness-max":new kt(q.paint_raster["raster-brightness-max"]),"raster-saturation":new kt(q.paint_raster["raster-saturation"]),"raster-contrast":new kt(q.paint_raster["raster-contrast"]),"raster-resampling":new kt(q.paint_raster["raster-resampling"]),"raster-fade-duration":new kt(q.paint_raster["raster-fade-duration"])})},jg=function(e){function t(i){e.call(this,i,qg)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t}(Ea),Zg=function(e){function t(i){e.call(this,i,{}),this.implementation=i}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.is3D=function(){return this.implementation.renderingMode==="3d"},t.prototype.hasOffscreenPass=function(){return this.implementation.prerender!==void 0},t.prototype.recalculate=function(){},t.prototype.updateTransitions=function(){},t.prototype.hasTransition=function(){},t.prototype.serialize=function(){},t.prototype.onAdd=function(i){this.implementation.onAdd&&this.implementation.onAdd(i,i.painter.context.gl)},t.prototype.onRemove=function(i){this.implementation.onRemove&&this.implementation.onRemove(i,i.painter.context.gl)},t}(Ea),Gg={circle:Yh,heatmap:Iy,hillshade:Py,fill:Hy,"fill-extrusion":rg,line:lg,symbol:Ng,background:Vg,raster:jg},Lf=R.HTMLImageElement,Rf=R.HTMLCanvasElement,Bf=R.HTMLVideoElement,Of=R.ImageData,Zc=R.ImageBitmap,Ps=function(e,t,i,l){this.context=e,this.format=i,this.texture=e.gl.createTexture(),this.update(t,l)};Ps.prototype.update=function(e,t,i){var l=e.width,f=e.height,m=!(this.size&&this.size[0]===l&&this.size[1]===f||i),x=this.context,k=x.gl;if(this.useMipmap=!!(t&&t.useMipmap),k.bindTexture(k.TEXTURE_2D,this.texture),x.pixelStoreUnpackFlipY.set(!1),x.pixelStoreUnpack.set(1),x.pixelStoreUnpackPremultiplyAlpha.set(this.format===k.RGBA&&(!t||t.premultiply!==!1)),m)this.size=[l,f],e instanceof Lf||e instanceof Rf||e instanceof Bf||e instanceof Of||Zc&&e instanceof Zc?k.texImage2D(k.TEXTURE_2D,0,this.format,this.format,k.UNSIGNED_BYTE,e):k.texImage2D(k.TEXTURE_2D,0,this.format,l,f,0,this.format,k.UNSIGNED_BYTE,e.data);else{var I=i||{x:0,y:0},A=I.x,M=I.y;e instanceof Lf||e instanceof Rf||e instanceof Bf||e instanceof Of||Zc&&e instanceof Zc?k.texSubImage2D(k.TEXTURE_2D,0,A,M,k.RGBA,k.UNSIGNED_BYTE,e):k.texSubImage2D(k.TEXTURE_2D,0,A,M,l,f,k.RGBA,k.UNSIGNED_BYTE,e.data)}this.useMipmap&&this.isSizePowerOfTwo()&&k.generateMipmap(k.TEXTURE_2D)},Ps.prototype.bind=function(e,t,i){var l=this.context.gl;l.bindTexture(l.TEXTURE_2D,this.texture),i!==l.LINEAR_MIPMAP_NEAREST||this.isSizePowerOfTwo()||(i=l.LINEAR),e!==this.filter&&(l.texParameteri(l.TEXTURE_2D,l.TEXTURE_MAG_FILTER,e),l.texParameteri(l.TEXTURE_2D,l.TEXTURE_MIN_FILTER,i||e),this.filter=e),t!==this.wrap&&(l.texParameteri(l.TEXTURE_2D,l.TEXTURE_WRAP_S,t),l.texParameteri(l.TEXTURE_2D,l.TEXTURE_WRAP_T,t),this.wrap=t)},Ps.prototype.isSizePowerOfTwo=function(){return this.size[0]===this.size[1]&&Math.log(this.size[0])/Math.LN2%1==0},Ps.prototype.destroy=function(){this.context.gl.deleteTexture(this.texture),this.texture=null};var fp=function(e){var t=this;this._callback=e,this._triggered=!1,typeof MessageChannel<"u"&&(this._channel=new MessageChannel,this._channel.port2.onmessage=function(){t._triggered=!1,t._callback()})};fp.prototype.trigger=function(){var e=this;this._triggered||(this._triggered=!0,this._channel?this._channel.port1.postMessage(!0):setTimeout(function(){e._triggered=!1,e._callback()},0))},fp.prototype.remove=function(){delete this._channel,this._callback=function(){}};var _l=function(e,t,i){this.target=e,this.parent=t,this.mapId=i,this.callbacks={},this.tasks={},this.taskQueue=[],this.cancelCallbacks={},gt(["receive","process"],this),this.invoker=new fp(this.process),this.target.addEventListener("message",this.receive,!1),this.globalScope=qt()?e:R};function Ff(e,t,i){var l=2*Math.PI*6378137/256/Math.pow(2,i);return[e*l-2*Math.PI*6378137/2,t*l-2*Math.PI*6378137/2]}_l.prototype.send=function(e,t,i,l,f){var m=this;f===void 0&&(f=!1);var x=Math.round(1e18*Math.random()).toString(36).substring(0,10);i&&(this.callbacks[x]=i);var k=_t(this.globalScope)?void 0:[];return this.target.postMessage({id:x,type:e,hasCallback:!!i,targetMapId:l,mustQueue:f,sourceMapId:this.mapId,data:fa(t,k)},k),{cancel:function(){i&&delete m.callbacks[x],m.target.postMessage({id:x,type:"<cancel>",targetMapId:l,sourceMapId:m.mapId})}}},_l.prototype.receive=function(e){var t=e.data,i=t.id;if(i&&(!t.targetMapId||this.mapId===t.targetMapId))if(t.type==="<cancel>"){delete this.tasks[i];var l=this.cancelCallbacks[i];delete this.cancelCallbacks[i],l&&l()}else qt()||t.mustQueue?(this.tasks[i]=t,this.taskQueue.push(i),this.invoker.trigger()):this.processTask(i,t)},_l.prototype.process=function(){if(this.taskQueue.length){var e=this.taskQueue.shift(),t=this.tasks[e];delete this.tasks[e],this.taskQueue.length&&this.invoker.trigger(),t&&this.processTask(e,t)}},_l.prototype.processTask=function(e,t){var i=this;if(t.type==="<response>"){var l=this.callbacks[e];delete this.callbacks[e],l&&(t.error?l(Un(t.error)):l(null,Un(t.data)))}else{var f=!1,m=_t(this.globalScope)?void 0:[],x=t.hasCallback?function(M,B){f=!0,delete i.cancelCallbacks[e],i.target.postMessage({id:e,type:"<response>",sourceMapId:i.mapId,error:M?fa(M):null,data:fa(B,m)},m)}:function(M){f=!0},k=null,I=Un(t.data);if(this.parent[t.type])k=this.parent[t.type](t.sourceMapId,I,x);else if(this.parent.getWorkerSource){var A=t.type.split(".");k=this.parent.getWorkerSource(t.sourceMapId,A[0],I.source)[A[1]](I,x)}else x(new Error("Could not find function "+t.type));!f&&k&&k.cancel&&(this.cancelCallbacks[e]=k.cancel)}},_l.prototype.remove=function(){this.invoker.remove(),this.target.removeEventListener("message",this.receive,!1)};var Ai=function(e,t){e&&(t?this.setSouthWest(e).setNorthEast(t):e.length===4?this.setSouthWest([e[0],e[1]]).setNorthEast([e[2],e[3]]):this.setSouthWest(e[0]).setNorthEast(e[1]))};Ai.prototype.setNorthEast=function(e){return this._ne=e instanceof Hr?new Hr(e.lng,e.lat):Hr.convert(e),this},Ai.prototype.setSouthWest=function(e){return this._sw=e instanceof Hr?new Hr(e.lng,e.lat):Hr.convert(e),this},Ai.prototype.extend=function(e){var t,i,l=this._sw,f=this._ne;if(e instanceof Hr)t=e,i=e;else{if(!(e instanceof Ai))return Array.isArray(e)?e.length===4||e.every(Array.isArray)?this.extend(Ai.convert(e)):this.extend(Hr.convert(e)):this;if(i=e._ne,!(t=e._sw)||!i)return this}return l||f?(l.lng=Math.min(t.lng,l.lng),l.lat=Math.min(t.lat,l.lat),f.lng=Math.max(i.lng,f.lng),f.lat=Math.max(i.lat,f.lat)):(this._sw=new Hr(t.lng,t.lat),this._ne=new Hr(i.lng,i.lat)),this},Ai.prototype.getCenter=function(){return new Hr((this._sw.lng+this._ne.lng)/2,(this._sw.lat+this._ne.lat)/2)},Ai.prototype.getSouthWest=function(){return this._sw},Ai.prototype.getNorthEast=function(){return this._ne},Ai.prototype.getNorthWest=function(){return new Hr(this.getWest(),this.getNorth())},Ai.prototype.getSouthEast=function(){return new Hr(this.getEast(),this.getSouth())},Ai.prototype.getWest=function(){return this._sw.lng},Ai.prototype.getSouth=function(){return this._sw.lat},Ai.prototype.getEast=function(){return this._ne.lng},Ai.prototype.getNorth=function(){return this._ne.lat},Ai.prototype.toArray=function(){return[this._sw.toArray(),this._ne.toArray()]},Ai.prototype.toString=function(){return"LngLatBounds("+this._sw.toString()+", "+this._ne.toString()+")"},Ai.prototype.isEmpty=function(){return!(this._sw&&this._ne)},Ai.prototype.contains=function(e){var t=Hr.convert(e),i=t.lng,l=t.lat,f=this._sw.lng<=i&&i<=this._ne.lng;return this._sw.lng>this._ne.lng&&(f=this._sw.lng>=i&&i>=this._ne.lng),this._sw.lat<=l&&l<=this._ne.lat&&f},Ai.convert=function(e){return!e||e instanceof Ai?e:new Ai(e)};var Hr=function(e,t){if(isNaN(e)||isNaN(t))throw new Error("Invalid LngLat object: ("+e+", "+t+")");if(this.lng=+e,this.lat=+t,this.lat>90||this.lat<-90)throw new Error("Invalid LngLat latitude value: must be between -90 and 90")};Hr.prototype.wrap=function(){return new Hr(de(this.lng,-180,180),this.lat)},Hr.prototype.toArray=function(){return[this.lng,this.lat]},Hr.prototype.toString=function(){return"LngLat("+this.lng+", "+this.lat+")"},Hr.prototype.distanceTo=function(e){var t=Math.PI/180,i=this.lat*t,l=e.lat*t,f=Math.sin(i)*Math.sin(l)+Math.cos(i)*Math.cos(l)*Math.cos((e.lng-this.lng)*t);return 63710088e-1*Math.acos(Math.min(f,1))},Hr.prototype.toBounds=function(e){e===void 0&&(e=0);var t=360*e/40075017,i=t/Math.cos(Math.PI/180*this.lat);return new Ai(new Hr(this.lng-i,this.lat-t),new Hr(this.lng+i,this.lat+t))},Hr.convert=function(e){if(e instanceof Hr)return e;if(Array.isArray(e)&&(e.length===2||e.length===3))return new Hr(Number(e[0]),Number(e[1]));if(!Array.isArray(e)&&typeof e=="object"&&e!==null)return new Hr(Number("lng"in e?e.lng:e.lon),Number(e.lat));throw new Error("`LngLatLike` argument must be specified as a LngLat instance, an object {lng: <lng>, lat: <lat>}, an object {lon: <lng>, lat: <lat>}, or an array of [<lng>, <lat>]")};var Nf=2*Math.PI*63710088e-1;function Uf(e){return Nf*Math.cos(e*Math.PI/180)}function Vf(e){return(180+e)/360}function qf(e){return(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+e*Math.PI/360)))/360}function jf(e,t){return e/Uf(t)}function dp(e){return 360/Math.PI*Math.atan(Math.exp((180-360*e)*Math.PI/180))-90}var Cs=function(e,t,i){i===void 0&&(i=0),this.x=+e,this.y=+t,this.z=+i};Cs.fromLngLat=function(e,t){t===void 0&&(t=0);var i=Hr.convert(e);return new Cs(Vf(i.lng),qf(i.lat),jf(t,i.lat))},Cs.prototype.toLngLat=function(){return new Hr(360*this.x-180,dp(this.y))},Cs.prototype.toAltitude=function(){return this.z*Uf(dp(this.y))},Cs.prototype.meterInMercatorCoordinateUnits=function(){return 1/Nf*(e=dp(this.y),1/Math.cos(e*Math.PI/180));var e};var Ms=function(e,t,i){this.z=e,this.x=t,this.y=i,this.key=bu(0,e,e,t,i)};Ms.prototype.equals=function(e){return this.z===e.z&&this.x===e.x&&this.y===e.y},Ms.prototype.url=function(e,t){var i,l,f,m,x,k=(l=this.y,f=this.z,m=Ff(256*(i=this.x),256*(l=Math.pow(2,f)-l-1),f),x=Ff(256*(i+1),256*(l+1),f),m[0]+","+m[1]+","+x[0]+","+x[1]),I=function(A,M,B){for(var U,j="",J=A;J>0;J--)j+=(M&(U=1<<J-1)?1:0)+(B&U?2:0);return j}(this.z,this.x,this.y);return e[(this.x+this.y)%e.length].replace("{prefix}",(this.x%16).toString(16)+(this.y%16).toString(16)).replace("{z}",String(this.z)).replace("{x}",String(this.x)).replace("{y}",String(t==="tms"?Math.pow(2,this.z)-this.y-1:this.y)).replace("{quadkey}",I).replace("{bbox-epsg-3857}",k)},Ms.prototype.getTilePoint=function(e){var t=Math.pow(2,this.z);return new F(8192*(e.x*t-this.x),8192*(e.y*t-this.y))},Ms.prototype.toString=function(){return this.z+"/"+this.x+"/"+this.y};var Zf=function(e,t){this.wrap=e,this.canonical=t,this.key=bu(e,t.z,t.z,t.x,t.y)},Pi=function(e,t,i,l,f){this.overscaledZ=e,this.wrap=t,this.canonical=new Ms(i,+l,+f),this.key=bu(t,e,i,l,f)};function bu(e,t,i,l,f){(e*=2)<0&&(e=-1*e-1);var m=1<<i;return(m*m*e+m*f+l).toString(36)+i.toString(36)+t.toString(36)}Pi.prototype.equals=function(e){return this.overscaledZ===e.overscaledZ&&this.wrap===e.wrap&&this.canonical.equals(e.canonical)},Pi.prototype.scaledTo=function(e){var t=this.canonical.z-e;return e>this.canonical.z?new Pi(e,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y):new Pi(e,this.wrap,e,this.canonical.x>>t,this.canonical.y>>t)},Pi.prototype.calculateScaledKey=function(e,t){var i=this.canonical.z-e;return e>this.canonical.z?bu(this.wrap*+t,e,this.canonical.z,this.canonical.x,this.canonical.y):bu(this.wrap*+t,e,e,this.canonical.x>>i,this.canonical.y>>i)},Pi.prototype.isChildOf=function(e){if(e.wrap!==this.wrap)return!1;var t=this.canonical.z-e.canonical.z;return e.overscaledZ===0||e.overscaledZ<this.overscaledZ&&e.canonical.x===this.canonical.x>>t&&e.canonical.y===this.canonical.y>>t},Pi.prototype.children=function(e){if(this.overscaledZ>=e)return[new Pi(this.overscaledZ+1,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)];var t=this.canonical.z+1,i=2*this.canonical.x,l=2*this.canonical.y;return[new Pi(t,this.wrap,t,i,l),new Pi(t,this.wrap,t,i+1,l),new Pi(t,this.wrap,t,i,l+1),new Pi(t,this.wrap,t,i+1,l+1)]},Pi.prototype.isLessThan=function(e){return this.wrap<e.wrap||!(this.wrap>e.wrap)&&(this.overscaledZ<e.overscaledZ||!(this.overscaledZ>e.overscaledZ)&&(this.canonical.x<e.canonical.x||!(this.canonical.x>e.canonical.x)&&this.canonical.y<e.canonical.y))},Pi.prototype.wrapped=function(){return new Pi(this.overscaledZ,0,this.canonical.z,this.canonical.x,this.canonical.y)},Pi.prototype.unwrapTo=function(e){return new Pi(this.overscaledZ,e,this.canonical.z,this.canonical.x,this.canonical.y)},Pi.prototype.overscaleFactor=function(){return Math.pow(2,this.overscaledZ-this.canonical.z)},Pi.prototype.toUnwrapped=function(){return new Zf(this.wrap,this.canonical)},Pi.prototype.toString=function(){return this.overscaledZ+"/"+this.canonical.x+"/"+this.canonical.y},Pi.prototype.getTilePoint=function(e){return this.canonical.getTilePoint(new Cs(e.x-this.wrap,e.y))},ft("CanonicalTileID",Ms),ft("OverscaledTileID",Pi,{omit:["posMatrix"]});var Co=function(e,t,i){if(this.uid=e,t.height!==t.width)throw new RangeError("DEM tiles must be square");if(i&&i!=="mapbox"&&i!=="terrarium")return st('"'+i+'" is not a valid encoding type. Valid types include "mapbox" and "terrarium".');this.stride=t.height;var l=this.dim=t.height-2;this.data=new Uint32Array(t.data.buffer),this.encoding=i||"mapbox";for(var f=0;f<l;f++)this.data[this._idx(-1,f)]=this.data[this._idx(0,f)],this.data[this._idx(l,f)]=this.data[this._idx(l-1,f)],this.data[this._idx(f,-1)]=this.data[this._idx(f,0)],this.data[this._idx(f,l)]=this.data[this._idx(f,l-1)];this.data[this._idx(-1,-1)]=this.data[this._idx(0,0)],this.data[this._idx(l,-1)]=this.data[this._idx(l-1,0)],this.data[this._idx(-1,l)]=this.data[this._idx(0,l-1)],this.data[this._idx(l,l)]=this.data[this._idx(l-1,l-1)]};Co.prototype.get=function(e,t){var i=new Uint8Array(this.data.buffer),l=4*this._idx(e,t);return(this.encoding==="terrarium"?this._unpackTerrarium:this._unpackMapbox)(i[l],i[l+1],i[l+2])},Co.prototype.getUnpackVector=function(){return this.encoding==="terrarium"?[256,1,1/256,32768]:[6553.6,25.6,.1,1e4]},Co.prototype._idx=function(e,t){if(e<-1||e>=this.dim+1||t<-1||t>=this.dim+1)throw new RangeError("out of range source coordinates for DEM data");return(t+1)*this.stride+(e+1)},Co.prototype._unpackMapbox=function(e,t,i){return(256*e*256+256*t+i)/10-1e4},Co.prototype._unpackTerrarium=function(e,t,i){return 256*e+t+i/256-32768},Co.prototype.getPixels=function(){return new Gn({width:this.stride,height:this.stride},new Uint8Array(this.data.buffer))},Co.prototype.backfillBorder=function(e,t,i){if(this.dim!==e.dim)throw new Error("dem dimension mismatch");var l=t*this.dim,f=t*this.dim+this.dim,m=i*this.dim,x=i*this.dim+this.dim;switch(t){case-1:l=f-1;break;case 1:f=l+1}switch(i){case-1:m=x-1;break;case 1:x=m+1}for(var k=-t*this.dim,I=-i*this.dim,A=m;A<x;A++)for(var M=l;M<f;M++)this.data[this._idx(M,A)]=e.data[this._idx(M+k,A+I)]},ft("DEMData",Co);var Gc=function(e){this._stringToNumber={},this._numberToString=[];for(var t=0;t<e.length;t++){var i=e[t];this._stringToNumber[i]=t,this._numberToString[t]=i}};Gc.prototype.encode=function(e){return this._stringToNumber[e]},Gc.prototype.decode=function(e){return this._numberToString[e]};var Kc=function(e,t,i,l,f){this.type="Feature",this._vectorTileFeature=e,e._z=t,e._x=i,e._y=l,this.properties=e.properties,this.id=f},mp={geometry:{configurable:!0}};mp.geometry.get=function(){return this._geometry===void 0&&(this._geometry=this._vectorTileFeature.toGeoJSON(this._vectorTileFeature._x,this._vectorTileFeature._y,this._vectorTileFeature._z).geometry),this._geometry},mp.geometry.set=function(e){this._geometry=e},Kc.prototype.toJSON=function(){var e={geometry:this.geometry};for(var t in this)t!=="_geometry"&&t!=="_vectorTileFeature"&&(e[t]=this[t]);return e},Object.defineProperties(Kc.prototype,mp);var vl=function(){this.state={},this.stateChanges={},this.deletedStates={}};vl.prototype.updateState=function(e,t,i){var l=String(t);if(this.stateChanges[e]=this.stateChanges[e]||{},this.stateChanges[e][l]=this.stateChanges[e][l]||{},xe(this.stateChanges[e][l],i),this.deletedStates[e]===null)for(var f in this.deletedStates[e]={},this.state[e])f!==l&&(this.deletedStates[e][f]=null);else if(this.deletedStates[e]&&this.deletedStates[e][l]===null)for(var m in this.deletedStates[e][l]={},this.state[e][l])i[m]||(this.deletedStates[e][l][m]=null);else for(var x in i)this.deletedStates[e]&&this.deletedStates[e][l]&&this.deletedStates[e][l][x]===null&&delete this.deletedStates[e][l][x]},vl.prototype.removeFeatureState=function(e,t,i){if(this.deletedStates[e]!==null){var l=String(t);if(this.deletedStates[e]=this.deletedStates[e]||{},i&&t!==void 0)this.deletedStates[e][l]!==null&&(this.deletedStates[e][l]=this.deletedStates[e][l]||{},this.deletedStates[e][l][i]=null);else if(t!==void 0)if(this.stateChanges[e]&&this.stateChanges[e][l])for(i in this.deletedStates[e][l]={},this.stateChanges[e][l])this.deletedStates[e][l][i]=null;else this.deletedStates[e][l]=null;else this.deletedStates[e]=null}},vl.prototype.getState=function(e,t){var i=String(t),l=xe({},(this.state[e]||{})[i],(this.stateChanges[e]||{})[i]);if(this.deletedStates[e]===null)return{};if(this.deletedStates[e]){var f=this.deletedStates[e][t];if(f===null)return{};for(var m in f)delete l[m]}return l},vl.prototype.initializeTileState=function(e,t){e.setFeatureState(this.state,t)},vl.prototype.coalesceChanges=function(e,t){var i={};for(var l in this.stateChanges){this.state[l]=this.state[l]||{};var f={};for(var m in this.stateChanges[l])this.state[l][m]||(this.state[l][m]={}),xe(this.state[l][m],this.stateChanges[l][m]),f[m]=this.state[l][m];i[l]=f}for(var x in this.deletedStates){this.state[x]=this.state[x]||{};var k={};if(this.deletedStates[x]===null)for(var I in this.state[x])k[I]={},this.state[x][I]={};else for(var A in this.deletedStates[x]){if(this.deletedStates[x][A]===null)this.state[x][A]={};else for(var M=0,B=Object.keys(this.deletedStates[x][A]);M<B.length;M+=1)delete this.state[x][A][B[M]];k[A]=this.state[x][A]}i[x]=i[x]||{},xe(i[x],k)}if(this.stateChanges={},this.deletedStates={},Object.keys(i).length!==0)for(var U in e)e[U].setFeatureState(i,t)};var Mo=function(e,t){this.tileID=e,this.x=e.canonical.x,this.y=e.canonical.y,this.z=e.canonical.z,this.grid=new Ca(8192,16,0),this.grid3D=new Ca(8192,16,0),this.featureIndexArray=new O,this.promoteId=t};function Gf(e,t,i,l,f){return dt(e,function(m,x){var k=t instanceof ws?t.get(x):null;return k&&k.evaluate?k.evaluate(i,l,f):k})}function Kf(e){for(var t=1/0,i=1/0,l=-1/0,f=-1/0,m=0,x=e;m<x.length;m+=1){var k=x[m];t=Math.min(t,k.x),i=Math.min(i,k.y),l=Math.max(l,k.x),f=Math.max(f,k.y)}return{minX:t,minY:i,maxX:l,maxY:f}}function Kg(e,t){return t-e}Mo.prototype.insert=function(e,t,i,l,f,m){var x=this.featureIndexArray.length;this.featureIndexArray.emplaceBack(i,l,f);for(var k=m?this.grid3D:this.grid,I=0;I<t.length;I++){for(var A=t[I],M=[1/0,1/0,-1/0,-1/0],B=0;B<A.length;B++){var U=A[B];M[0]=Math.min(M[0],U.x),M[1]=Math.min(M[1],U.y),M[2]=Math.max(M[2],U.x),M[3]=Math.max(M[3],U.y)}M[0]<8192&&M[1]<8192&&M[2]>=0&&M[3]>=0&&k.insert(x,M[0],M[1],M[2],M[3])}},Mo.prototype.loadVTLayers=function(){return this.vtLayers||(this.vtLayers=new ul.VectorTile(new Lc(this.rawTileData)).layers,this.sourceLayerCoder=new Gc(this.vtLayers?Object.keys(this.vtLayers).sort():["_geojsonTileLayer"])),this.vtLayers},Mo.prototype.query=function(e,t,i,l){var f=this;this.loadVTLayers();for(var m=e.params||{},x=8192/e.tileSize/e.scale,k=Ks(m.filter),I=e.queryGeometry,A=e.queryPadding*x,M=Kf(I),B=this.grid.query(M.minX-A,M.minY-A,M.maxX+A,M.maxY+A),U=Kf(e.cameraQueryGeometry),j=this.grid3D.query(U.minX-A,U.minY-A,U.maxX+A,U.maxY+A,function(we,ke,Ce,Ve){return function(Je,wt,ot,zt,lt){for(var Yt=0,Lt=Je;Yt<Lt.length;Yt+=1){var yt=Lt[Yt];if(wt<=yt.x&&ot<=yt.y&&zt>=yt.x&&lt>=yt.y)return!0}var nr=[new F(wt,ot),new F(wt,lt),new F(zt,lt),new F(zt,ot)];if(Je.length>2){for(var jt=0,pr=nr;jt<pr.length;jt+=1)if(Ta(Je,pr[jt]))return!0}for(var Tt=0;Tt<Je.length-1;Tt++)if(Ts(Je[Tt],Je[Tt+1],nr))return!0;return!1}(e.cameraQueryGeometry,we-A,ke-A,Ce+A,Ve+A)}),J=0,$=j;J<$.length;J+=1)B.push($[J]);B.sort(Kg);for(var ce,ie={},ye=function(we){var ke=B[we];if(ke!==ce){ce=ke;var Ce=f.featureIndexArray.get(ke),Ve=null;f.loadMatchingFeature(ie,Ce.bucketIndex,Ce.sourceLayerIndex,Ce.featureIndex,k,m.layers,m.availableImages,t,i,l,function(Je,wt,ot){return Ve||(Ve=Jr(Je)),wt.queryIntersectsFeature(I,Je,ot,Ve,f.z,e.transform,x,e.pixelPosMatrix)})}},be=0;be<B.length;be++)ye(be);return ie},Mo.prototype.loadMatchingFeature=function(e,t,i,l,f,m,x,k,I,A,M){var B=this.bucketLayerIDs[t];if(!m||function(Je,wt){for(var ot=0;ot<Je.length;ot++)if(wt.indexOf(Je[ot])>=0)return!0;return!1}(m,B)){var U=this.sourceLayerCoder.decode(i),j=this.vtLayers[U].feature(l);if(f.needGeometry){var J=pi(j,!0);if(!f.filter(new ar(this.tileID.overscaledZ),J,this.tileID.canonical))return}else if(!f.filter(new ar(this.tileID.overscaledZ),j))return;for(var $=this.getId(j,U),ce=0;ce<B.length;ce++){var ie=B[ce];if(!(m&&m.indexOf(ie)<0)){var ye=k[ie];if(ye){var be={};$!==void 0&&A&&(be=A.getState(ye.sourceLayer||"_geojsonTileLayer",$));var we=xe({},I[ie]);we.paint=Gf(we.paint,ye.paint,j,be,x),we.layout=Gf(we.layout,ye.layout,j,be,x);var ke=!M||M(j,ye,be);if(ke){var Ce=new Kc(j,this.z,this.x,this.y,$);Ce.layer=we;var Ve=e[ie];Ve===void 0&&(Ve=e[ie]=[]),Ve.push({featureIndex:l,feature:Ce,intersectionZ:ke})}}}}}},Mo.prototype.lookupSymbolFeatures=function(e,t,i,l,f,m,x,k){var I={};this.loadVTLayers();for(var A=Ks(f),M=0,B=e;M<B.length;M+=1)this.loadMatchingFeature(I,i,l,B[M],A,m,x,k,t);return I},Mo.prototype.hasLayer=function(e){for(var t=0,i=this.bucketLayerIDs;t<i.length;t+=1)for(var l=0,f=i[t];l<f.length;l+=1)if(e===f[l])return!0;return!1},Mo.prototype.getId=function(e,t){var i=e.id;return this.promoteId&&typeof(i=e.properties[typeof this.promoteId=="string"?this.promoteId:this.promoteId[t]])=="boolean"&&(i=Number(i)),i},ft("FeatureIndex",Mo,{omit:["rawTileData","sourceLayerCoder"]});var Hi=function(e,t){this.tileID=e,this.uid=ht(),this.uses=0,this.tileSize=t,this.buckets={},this.expirationTime=null,this.queryPadding=0,this.hasSymbolBuckets=!1,this.hasRTLText=!1,this.dependencies={},this.expiredRequestCount=0,this.state="loading"};Hi.prototype.registerFadeDuration=function(e){var t=e+this.timeAdded;t<yi.now()||this.fadeEndTime&&t<this.fadeEndTime||(this.fadeEndTime=t)},Hi.prototype.wasRequested=function(){return this.state==="errored"||this.state==="loaded"||this.state==="reloading"},Hi.prototype.loadVectorData=function(e,t,i){if(this.hasData()&&this.unloadVectorData(),this.state="loaded",e){for(var l in e.featureIndex&&(this.latestFeatureIndex=e.featureIndex,e.rawTileData?(this.latestRawTileData=e.rawTileData,this.latestFeatureIndex.rawTileData=e.rawTileData):this.latestRawTileData&&(this.latestFeatureIndex.rawTileData=this.latestRawTileData)),this.collisionBoxArray=e.collisionBoxArray,this.buckets=function(A,M){var B={};if(!M)return B;for(var U=function(){var $=J[j],ce=$.layerIds.map(function(be){return M.getLayer(be)}).filter(Boolean);if(ce.length!==0){$.layers=ce,$.stateDependentLayerIds&&($.stateDependentLayers=$.stateDependentLayerIds.map(function(be){return ce.filter(function(we){return we.id===be})[0]}));for(var ie=0,ye=ce;ie<ye.length;ie+=1)B[ye[ie].id]=$}},j=0,J=A;j<J.length;j+=1)U();return B}(e.buckets,t.style),this.hasSymbolBuckets=!1,this.buckets){var f=this.buckets[l];if(f instanceof Cr){if(this.hasSymbolBuckets=!0,!i)break;f.justReloaded=!0}}if(this.hasRTLText=!1,this.hasSymbolBuckets)for(var m in this.buckets){var x=this.buckets[m];if(x instanceof Cr&&x.hasRTLText){this.hasRTLText=!0,$n.isLoading()||$n.isLoaded()||iu()!=="deferred"||da();break}}for(var k in this.queryPadding=0,this.buckets){var I=this.buckets[k];this.queryPadding=Math.max(this.queryPadding,t.style.getLayer(k).queryRadius(I))}e.imageAtlas&&(this.imageAtlas=e.imageAtlas),e.glyphAtlasImage&&(this.glyphAtlasImage=e.glyphAtlasImage)}else this.collisionBoxArray=new s},Hi.prototype.unloadVectorData=function(){for(var e in this.buckets)this.buckets[e].destroy();this.buckets={},this.imageAtlasTexture&&this.imageAtlasTexture.destroy(),this.imageAtlas&&(this.imageAtlas=null),this.glyphAtlasTexture&&this.glyphAtlasTexture.destroy(),this.latestFeatureIndex=null,this.state="unloaded"},Hi.prototype.getBucket=function(e){return this.buckets[e.id]},Hi.prototype.upload=function(e){for(var t in this.buckets){var i=this.buckets[t];i.uploadPending()&&i.upload(e)}var l=e.gl;this.imageAtlas&&!this.imageAtlas.uploaded&&(this.imageAtlasTexture=new Ps(e,this.imageAtlas.image,l.RGBA),this.imageAtlas.uploaded=!0),this.glyphAtlasImage&&(this.glyphAtlasTexture=new Ps(e,this.glyphAtlasImage,l.ALPHA),this.glyphAtlasImage=null)},Hi.prototype.prepare=function(e){this.imageAtlas&&this.imageAtlas.patchUpdatedImages(e,this.imageAtlasTexture)},Hi.prototype.queryRenderedFeatures=function(e,t,i,l,f,m,x,k,I,A){return this.latestFeatureIndex&&this.latestFeatureIndex.rawTileData?this.latestFeatureIndex.query({queryGeometry:l,cameraQueryGeometry:f,scale:m,tileSize:this.tileSize,pixelPosMatrix:A,transform:k,params:x,queryPadding:this.queryPadding*I},e,t,i):{}},Hi.prototype.querySourceFeatures=function(e,t){var i=this.latestFeatureIndex;if(i&&i.rawTileData){var l=i.loadVTLayers(),f=t?t.sourceLayer:"",m=l._geojsonTileLayer||l[f];if(m)for(var x=Ks(t&&t.filter),k=this.tileID.canonical,I=k.z,A=k.x,M=k.y,B={z:I,x:A,y:M},U=0;U<m.length;U++){var j=m.feature(U);if(x.needGeometry){var J=pi(j,!0);if(!x.filter(new ar(this.tileID.overscaledZ),J,this.tileID.canonical))continue}else if(!x.filter(new ar(this.tileID.overscaledZ),j))continue;var $=i.getId(j,f),ce=new Kc(j,I,A,M,$);ce.tile=B,e.push(ce)}}},Hi.prototype.hasData=function(){return this.state==="loaded"||this.state==="reloading"||this.state==="expired"},Hi.prototype.patternsLoaded=function(){return this.imageAtlas&&!!Object.keys(this.imageAtlas.patternPositions).length},Hi.prototype.setExpiryData=function(e){var t=this.expirationTime;if(e.cacheControl){var i=St(e.cacheControl);i["max-age"]&&(this.expirationTime=Date.now()+1e3*i["max-age"])}else e.expires&&(this.expirationTime=new Date(e.expires).getTime());if(this.expirationTime){var l=Date.now(),f=!1;if(this.expirationTime>l)f=!1;else if(t)if(this.expirationTime<t)f=!0;else{var m=this.expirationTime-t;m?this.expirationTime=l+Math.max(m,3e4):f=!0}else f=!0;f?(this.expiredRequestCount++,this.state="expired"):this.expiredRequestCount=0}},Hi.prototype.getExpiryTimeout=function(){if(this.expirationTime)return this.expiredRequestCount?1e3*(1<<Math.min(this.expiredRequestCount-1,31)):Math.min(this.expirationTime-new Date().getTime(),Math.pow(2,31)-1)},Hi.prototype.setFeatureState=function(e,t){if(this.latestFeatureIndex&&this.latestFeatureIndex.rawTileData&&Object.keys(e).length!==0){var i=this.latestFeatureIndex.loadVTLayers();for(var l in this.buckets)if(t.style.hasLayer(l)){var f=this.buckets[l],m=f.layers[0].sourceLayer||"_geojsonTileLayer",x=i[m],k=e[m];if(x&&k&&Object.keys(k).length!==0){f.update(k,x,this.imageAtlas&&this.imageAtlas.patternPositions||{});var I=t&&t.style&&t.style.getLayer(l);I&&(this.queryPadding=Math.max(this.queryPadding,I.queryRadius(f)))}}}},Hi.prototype.holdingForFade=function(){return this.symbolFadeHoldUntil!==void 0},Hi.prototype.symbolFadeFinished=function(){return!this.symbolFadeHoldUntil||this.symbolFadeHoldUntil<yi.now()},Hi.prototype.clearFadeHold=function(){this.symbolFadeHoldUntil=void 0},Hi.prototype.setHoldDuration=function(e){this.symbolFadeHoldUntil=yi.now()+e},Hi.prototype.setDependencies=function(e,t){for(var i={},l=0,f=t;l<f.length;l+=1)i[f[l]]=!0;this.dependencies[e]=i},Hi.prototype.hasDependency=function(e,t){for(var i=0,l=e;i<l.length;i+=1){var f=this.dependencies[l[i]];if(f){for(var m=0,x=t;m<x.length;m+=1)if(f[x[m]])return!0}}return!1};var Qo=R.performance,Hf=function(e){this._marks={start:[e.url,"start"].join("#"),end:[e.url,"end"].join("#"),measure:e.url.toString()},Qo.mark(this._marks.start)};Hf.prototype.finish=function(){Qo.mark(this._marks.end);var e=Qo.getEntriesByName(this._marks.measure);return e.length===0&&(Qo.measure(this._marks.measure,this._marks.start,this._marks.end),e=Qo.getEntriesByName(this._marks.measure),Qo.clearMarks(this._marks.start),Qo.clearMarks(this._marks.end),Qo.clearMeasures(this._marks.measure)),e},a.Actor=_l,a.AlphaImage=As,a.CanonicalTileID=Ms,a.CollisionBoxArray=s,a.Color=ur,a.DEMData=Co,a.DataConstantProperty=kt,a.DictionaryCoder=Gc,a.EXTENT=8192,a.ErrorEvent=ue,a.EvaluationParameters=ar,a.Event=W,a.Evented=he,a.FeatureIndex=Mo,a.FillBucket=Ra,a.FillExtrusionBucket=Ba,a.ImageAtlas=_u,a.ImagePosition=Bc,a.LineBucket=Mn,a.LngLat=Hr,a.LngLatBounds=Ai,a.MercatorCoordinate=Cs,a.ONE_EM=24,a.OverscaledTileID=Pi,a.Point=F,a.Point$1=F,a.Properties=en,a.Protobuf=Lc,a.RGBAImage=Gn,a.RequestManager=Yr,a.RequestPerformance=Hf,a.ResourceType=wi,a.SegmentVector=G,a.SourceFeatureState=vl,a.StructArrayLayout1ui2=uu,a.StructArrayLayout2f1f2i16=To,a.StructArrayLayout2i4=zo,a.StructArrayLayout3ui6=Ya,a.StructArrayLayout4i8=au,a.SymbolBucket=Cr,a.Texture=Ps,a.Tile=Hi,a.Transitionable=$i,a.Uniform1f=He,a.Uniform1i=Oe,a.Uniform2f=Ze,a.Uniform3f=ct,a.Uniform4f=Et,a.UniformColor=Ct,a.UniformMatrix4f=dr,a.UnwrappedTileID=Zf,a.ValidationError=Q,a.WritingMode=oa,a.ZoomHistory=$l,a.add=function(e,t,i){return e[0]=t[0]+i[0],e[1]=t[1]+i[1],e[2]=t[2]+i[2],e},a.addDynamicAttributes=hp,a.asyncAll=function(e,t,i){if(!e.length)return i(null,[]);var l=e.length,f=new Array(e.length),m=null;e.forEach(function(x,k){t(x,function(I,A){I&&(m=I),f[k]=A,--l==0&&i(m,f)})})},a.bezier=ne,a.bindAll=gt,a.browser=yi,a.cacheEntryPossiblyAdded=function(e){++Yn>Ji&&(e.getActor().send("enforceCacheSizeLimit",Li),Yn=0)},a.clamp=ve,a.clearTileCache=function(e){var t=R.caches.delete("mapbox-tiles");e&&t.catch(e).then(function(){return e()})},a.clipLine=If,a.clone=function(e){var t=new wr(16);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t},a.clone$1=at,a.clone$2=function(e){var t=new wr(3);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t},a.collisionCircleLayout=pg,a.config=Jt,a.create=function(){var e=new wr(16);return wr!=Float32Array&&(e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[11]=0,e[12]=0,e[13]=0,e[14]=0),e[0]=1,e[5]=1,e[10]=1,e[15]=1,e},a.create$1=function(){var e=new wr(9);return wr!=Float32Array&&(e[1]=0,e[2]=0,e[3]=0,e[5]=0,e[6]=0,e[7]=0),e[0]=1,e[4]=1,e[8]=1,e},a.create$2=function(){var e=new wr(4);return wr!=Float32Array&&(e[1]=0,e[2]=0),e[0]=1,e[3]=1,e},a.createCommonjsModule=T,a.createExpression=Zs,a.createLayout=Gi,a.createStyleLayer=function(e){return e.type==="custom"?new Zg(e):new Gg[e.type](e)},a.cross=function(e,t,i){var l=t[0],f=t[1],m=t[2],x=i[0],k=i[1],I=i[2];return e[0]=f*I-m*k,e[1]=m*x-l*I,e[2]=l*k-f*x,e},a.deepEqual=function e(t,i){if(Array.isArray(t)){if(!Array.isArray(i)||t.length!==i.length)return!1;for(var l=0;l<t.length;l++)if(!e(t[l],i[l]))return!1;return!0}if(typeof t=="object"&&t!==null&&i!==null){if(typeof i!="object"||Object.keys(t).length!==Object.keys(i).length)return!1;for(var f in t)if(!e(t[f],i[f]))return!1;return!0}return t===i},a.dot=function(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]},a.dot$1=function(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]+e[3]*t[3]},a.ease=pe,a.emitValidationErrors=vs,a.endsWith=Ke,a.enforceCacheSizeLimit=function(e){Rn(),ci&&ci.then(function(t){t.keys().then(function(i){for(var l=0;l<i.length-e;l++)t.delete(i[l])})})},a.evaluateSizeForFeature=wf,a.evaluateSizeForZoom=Sf,a.evaluateVariableOffset=Cf,a.evented=ru,a.extend=xe,a.featureFilter=Ks,a.filterObject=Ne,a.fromRotation=function(e,t){var i=Math.sin(t),l=Math.cos(t);return e[0]=l,e[1]=i,e[2]=0,e[3]=-i,e[4]=l,e[5]=0,e[6]=0,e[7]=0,e[8]=1,e},a.getAnchorAlignment=sp,a.getAnchorJustification=cp,a.getArrayBuffer=ti,a.getImage=N,a.getJSON=function(e,t){return gn(xe(e,{type:"json"}),t)},a.getRTLTextPluginStatus=iu,a.getReferrer=An,a.getVideo=function(e,t){var i,l,f=R.document.createElement("video");f.muted=!0,f.onloadstart=function(){t(null,f)};for(var m=0;m<e.length;m++){var x=R.document.createElement("source");i=e[m],l=void 0,(l=R.document.createElement("a")).href=i,(l.protocol!==R.document.location.protocol||l.host!==R.document.location.host)&&(f.crossOrigin="Anonymous"),x.src=e[m],f.appendChild(x)}return{cancel:function(){}}},a.identity=ea,a.invert=function(e,t){var i=t[0],l=t[1],f=t[2],m=t[3],x=t[4],k=t[5],I=t[6],A=t[7],M=t[8],B=t[9],U=t[10],j=t[11],J=t[12],$=t[13],ce=t[14],ie=t[15],ye=i*k-l*x,be=i*I-f*x,we=i*A-m*x,ke=l*I-f*k,Ce=l*A-m*k,Ve=f*A-m*I,Je=M*$-B*J,wt=M*ce-U*J,ot=M*ie-j*J,zt=B*ce-U*$,lt=B*ie-j*$,Yt=U*ie-j*ce,Lt=ye*Yt-be*lt+we*zt+ke*ot-Ce*wt+Ve*Je;return Lt?(e[0]=(k*Yt-I*lt+A*zt)*(Lt=1/Lt),e[1]=(f*lt-l*Yt-m*zt)*Lt,e[2]=($*Ve-ce*Ce+ie*ke)*Lt,e[3]=(U*Ce-B*Ve-j*ke)*Lt,e[4]=(I*ot-x*Yt-A*wt)*Lt,e[5]=(i*Yt-f*ot+m*wt)*Lt,e[6]=(ce*we-J*Ve-ie*be)*Lt,e[7]=(M*Ve-U*we+j*be)*Lt,e[8]=(x*lt-k*ot+A*Je)*Lt,e[9]=(l*ot-i*lt-m*Je)*Lt,e[10]=(J*Ce-$*we+ie*ye)*Lt,e[11]=(B*we-M*Ce-j*ye)*Lt,e[12]=(k*wt-x*zt-I*Je)*Lt,e[13]=(i*zt-l*wt+f*Je)*Lt,e[14]=($*be-J*ke-ce*ye)*Lt,e[15]=(M*ke-B*be+U*ye)*Lt,e):null},a.isChar=tt,a.isMapboxURL=li,a.keysDifference=function(e,t){var i=[];for(var l in e)l in t||i.push(l);return i},a.makeRequest=gn,a.mapObject=dt,a.mercatorXfromLng=Vf,a.mercatorYfromLat=qf,a.mercatorZfromAltitude=jf,a.mul=Wh,a.multiply=Cn,a.mvt=ul,a.nextPowerOfTwo=function(e){return e<=1?1:Math.pow(2,Math.ceil(Math.log(e)/Math.LN2))},a.normalize=function(e,t){var i=t[0],l=t[1],f=t[2],m=i*i+l*l+f*f;return m>0&&(m=1/Math.sqrt(m)),e[0]=t[0]*m,e[1]=t[1]*m,e[2]=t[2]*m,e},a.number=vi,a.offscreenCanvasSupported=In,a.ortho=function(e,t,i,l,f,m,x){var k=1/(t-i),I=1/(l-f),A=1/(m-x);return e[0]=-2*k,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=-2*I,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=2*A,e[11]=0,e[12]=(t+i)*k,e[13]=(f+l)*I,e[14]=(x+m)*A,e[15]=1,e},a.parseGlyphPBF=function(e){return new Lc(e).readFields(Sg,[])},a.pbf=Lc,a.performSymbolLayout=function(e,t,i,l,f,m,x){e.createArrays(),e.tilePixelRatio=8192/(512*e.overscaling),e.compareText={},e.iconsNeedLinear=!1;var k=e.layers[0].layout,I=e.layers[0]._unevaluatedLayout._values,A={};if(e.textSizeData.kind==="composite"){var M=e.textSizeData,B=M.maxZoom;A.compositeTextSizes=[I["text-size"].possiblyEvaluate(new ar(M.minZoom),x),I["text-size"].possiblyEvaluate(new ar(B),x)]}if(e.iconSizeData.kind==="composite"){var U=e.iconSizeData,j=U.maxZoom;A.compositeIconSizes=[I["icon-size"].possiblyEvaluate(new ar(U.minZoom),x),I["icon-size"].possiblyEvaluate(new ar(j),x)]}A.layoutTextSize=I["text-size"].possiblyEvaluate(new ar(e.zoom+1),x),A.layoutIconSize=I["icon-size"].possiblyEvaluate(new ar(e.zoom+1),x),A.textMaxSize=I["text-size"].possiblyEvaluate(new ar(18));for(var J=24*k.get("text-line-height"),$=k.get("text-rotation-alignment")==="map"&&k.get("symbol-placement")!=="point",ce=k.get("text-keep-upright"),ie=k.get("text-size"),ye=function(){var ke=we[be],Ce=k.get("text-font").evaluate(ke,{},x).join(","),Ve=ie.evaluate(ke,{},x),Je=A.layoutTextSize.evaluate(ke,{},x),wt=A.layoutIconSize.evaluate(ke,{},x),ot={horizontal:{},vertical:void 0},zt=ke.text,lt=[0,0];if(zt){var Yt=zt.toString(),Lt=24*k.get("text-letter-spacing").evaluate(ke,{},x),yt=function(sr){for(var Lr=0,Ar=sr;Lr<Ar.length;Lr+=1)if(mr=Ar[Lr].charCodeAt(0),tt.Arabic(mr)||tt["Arabic Supplement"](mr)||tt["Arabic Extended-A"](mr)||tt["Arabic Presentation Forms-A"](mr)||tt["Arabic Presentation Forms-B"](mr))return!1;var mr;return!0}(Yt)?Lt:0,nr=k.get("text-anchor").evaluate(ke,{},x),jt=k.get("text-variable-anchor");if(!jt){var pr=k.get("text-radial-offset").evaluate(ke,{},x);lt=pr?Cf(nr,[24*pr,up]):k.get("text-offset").evaluate(ke,{},x).map(function(sr){return 24*sr})}var Tt=$?"center":k.get("text-justify").evaluate(ke,{},x),vr=k.get("symbol-placement"),Xr=vr==="point"?24*k.get("text-max-width").evaluate(ke,{},x):0,ai=function(){e.allowVerticalPlacement&&eu(Yt)&&(ot.vertical=Oc(zt,t,i,f,Ce,Xr,J,nr,"left",yt,lt,oa.vertical,!0,vr,Je,Ve))};if(!$&&jt){for(var Qr=Tt==="auto"?jt.map(function(sr){return cp(sr)}):[Tt],Wr=!1,oi=0;oi<Qr.length;oi++){var Fi=Qr[oi];if(!ot.horizontal[Fi])if(Wr)ot.horizontal[Fi]=ot.horizontal[0];else{var Ni=Oc(zt,t,i,f,Ce,Xr,J,"center",Fi,yt,lt,oa.horizontal,!1,vr,Je,Ve);Ni&&(ot.horizontal[Fi]=Ni,Wr=Ni.positionedLines.length===1)}}ai()}else{Tt==="auto"&&(Tt=cp(nr));var Sn=Oc(zt,t,i,f,Ce,Xr,J,nr,Tt,yt,lt,oa.horizontal,!1,vr,Je,Ve);Sn&&(ot.horizontal[Tt]=Sn),ai(),eu(Yt)&&$&&ce&&(ot.vertical=Oc(zt,t,i,f,Ce,Xr,J,nr,Tt,yt,lt,oa.vertical,!1,vr,Je,Ve))}}var Xi=void 0,kn=!1;if(ke.icon&&ke.icon.name){var fi=l[ke.icon.name];fi&&(Xi=function(sr,Lr,Ar){var mr=sp(Ar),Dn=Lr[0]-sr.displaySize[0]*mr.horizontalAlign,hn=Lr[1]-sr.displaySize[1]*mr.verticalAlign;return{image:sr,top:hn,bottom:hn+sr.displaySize[1],left:Dn,right:Dn+sr.displaySize[0]}}(f[ke.icon.name],k.get("icon-offset").evaluate(ke,{},x),k.get("icon-anchor").evaluate(ke,{},x)),kn=fi.sdf,e.sdfIcons===void 0?e.sdfIcons=fi.sdf:e.sdfIcons!==fi.sdf&&st("Style sheet warning: Cannot mix SDF and non-SDF icons in one buffer"),(fi.pixelRatio!==e.pixelRatio||k.get("icon-rotate").constantOr(1)!==0)&&(e.iconsNeedLinear=!0))}var Wi=Df(ot.horizontal)||ot.vertical;e.iconsInText=!!Wi&&Wi.iconsInText,(Wi||Xi)&&function(sr,Lr,Ar,mr,Dn,hn,Gr,xi,pn,br,ro){var sa=hn.textMaxSize.evaluate(Lr,{});sa===void 0&&(sa=Gr);var io,di=sr.layers[0].layout,no=di.get("icon-offset").evaluate(Lr,{},ro),Aa=Df(Ar.horizontal),bl=Gr/24,Ds=sr.tilePixelRatio*bl,xl=sr.tilePixelRatio*sa/24,Do=sr.tilePixelRatio*xi,wl=sr.tilePixelRatio*di.get("symbol-spacing"),Hc=di.get("text-padding")*sr.tilePixelRatio,Sl=di.get("icon-padding")*sr.tilePixelRatio,xu=di.get("text-max-angle")/180*Math.PI,Xc=di.get("text-rotation-alignment")==="map"&&di.get("symbol-placement")!=="point",Wc=di.get("icon-rotation-alignment")==="map"&&di.get("symbol-placement")!=="point",Lo=di.get("symbol-placement"),wu=wl/2,kl=di.get("icon-text-fit");mr&&kl!=="none"&&(sr.allowVerticalPlacement&&Ar.vertical&&(io=xf(mr,Ar.vertical,kl,di.get("icon-text-fit-padding"),no,bl)),Aa&&(mr=xf(mr,Aa,kl,di.get("icon-text-fit-padding"),no,bl)));var $o=function(Hg,Pu){Pu.x<0||Pu.x>=8192||Pu.y<0||Pu.y>=8192||function(mi,Oa,Xg,es,vp,Yf,th,ao,rh,Cu,ih,nh,bp,Jf,Mu,Qf,$f,ed,td,rd,la,ah,id,oo,Wg){var nd,Rs,Al,Pl,Cl,Ml=mi.addToLineVertexArray(Oa,Xg),ad=0,od=0,sd=0,ld=0,xp=-1,wp=-1,Ro={},ud=Y(""),Sp=0,kp=0;if(ao._unevaluatedLayout.getValue("text-radial-offset")===void 0?(Sp=(nd=ao.layout.get("text-offset").evaluate(la,{},oo).map(function(Lu){return 24*Lu}))[0],kp=nd[1]):(Sp=24*ao.layout.get("text-radial-offset").evaluate(la,{},oo),kp=up),mi.allowVerticalPlacement&&es.vertical){var cd=ao.layout.get("text-rotate").evaluate(la,{},oo)+90;Pl=new qc(rh,Oa,Cu,ih,nh,es.vertical,bp,Jf,Mu,cd),th&&(Cl=new qc(rh,Oa,Cu,ih,nh,th,$f,ed,Mu,cd))}if(vp){var Ep=ao.layout.get("icon-rotate").evaluate(la,{}),hd=ao.layout.get("icon-text-fit")!=="none",pd=Af(vp,Ep,id,hd),zp=th?Af(th,Ep,id,hd):void 0;Al=new qc(rh,Oa,Cu,ih,nh,vp,$f,ed,!1,Ep),ad=4*pd.length;var fd=mi.iconSizeData,Du=null;fd.kind==="source"?(Du=[128*ao.layout.get("icon-size").evaluate(la,{})])[0]>32640&&st(mi.layerIds[0]+': Value for "icon-size" is >= 255. Reduce your "icon-size".'):fd.kind==="composite"&&((Du=[128*ah.compositeIconSizes[0].evaluate(la,{},oo),128*ah.compositeIconSizes[1].evaluate(la,{},oo)])[0]>32640||Du[1]>32640)&&st(mi.layerIds[0]+': Value for "icon-size" is >= 255. Reduce your "icon-size".'),mi.addSymbols(mi.icon,pd,Du,rd,td,la,!1,Oa,Ml.lineStartIndex,Ml.lineLength,-1,oo),xp=mi.icon.placedSymbolArray.length-1,zp&&(od=4*zp.length,mi.addSymbols(mi.icon,zp,Du,rd,td,la,oa.vertical,Oa,Ml.lineStartIndex,Ml.lineLength,-1,oo),wp=mi.icon.placedSymbolArray.length-1)}for(var dd in es.horizontal){var oh=es.horizontal[dd];if(!Rs){ud=Y(oh.text);var Yg=ao.layout.get("text-rotate").evaluate(la,{},oo);Rs=new qc(rh,Oa,Cu,ih,nh,oh,bp,Jf,Mu,Yg)}var md=oh.positionedLines.length===1;if(sd+=Mf(mi,Oa,oh,Yf,ao,Mu,la,Qf,Ml,es.vertical?oa.horizontal:oa.horizontalOnly,md?Object.keys(es.horizontal):[dd],Ro,xp,ah,oo),md)break}es.vertical&&(ld+=Mf(mi,Oa,es.vertical,Yf,ao,Mu,la,Qf,Ml,oa.vertical,["vertical"],Ro,wp,ah,oo));var Jg=Rs?Rs.boxStartIndex:mi.collisionBoxArray.length,Qg=Rs?Rs.boxEndIndex:mi.collisionBoxArray.length,$g=Pl?Pl.boxStartIndex:mi.collisionBoxArray.length,e_=Pl?Pl.boxEndIndex:mi.collisionBoxArray.length,t_=Al?Al.boxStartIndex:mi.collisionBoxArray.length,r_=Al?Al.boxEndIndex:mi.collisionBoxArray.length,i_=Cl?Cl.boxStartIndex:mi.collisionBoxArray.length,n_=Cl?Cl.boxEndIndex:mi.collisionBoxArray.length,so=-1,sh=function(Lu,gd){return Lu&&Lu.circleDiameter?Math.max(Lu.circleDiameter,gd):gd};so=sh(Rs,so),so=sh(Pl,so),so=sh(Al,so);var yd=(so=sh(Cl,so))>-1?1:0;yd&&(so*=Wg/24),mi.glyphOffsetArray.length>=Cr.MAX_GLYPHS&&st("Too many glyphs being rendered in a tile. See https://github.com/mapbox/mapbox-gl-js/issues/2907"),la.sortKey!==void 0&&mi.addToSortKeyRanges(mi.symbolInstances.length,la.sortKey),mi.symbolInstances.emplaceBack(Oa.x,Oa.y,Ro.right>=0?Ro.right:-1,Ro.center>=0?Ro.center:-1,Ro.left>=0?Ro.left:-1,Ro.vertical||-1,xp,wp,ud,Jg,Qg,$g,e_,t_,r_,i_,n_,Cu,sd,ld,ad,od,yd,0,bp,Sp,kp,so)}(sr,Pu,Hg,Ar,mr,Dn,io,sr.layers[0],sr.collisionBoxArray,Lr.index,Lr.sourceLayerIndex,sr.index,Ds,Hc,Xc,pn,Do,Sl,Wc,no,Lr,hn,br,ro,Gr)};if(Lo==="line")for(var El=0,Yc=If(Lr.geometry,0,0,8192,8192);El<Yc.length;El+=1)for(var Jc=Yc[El],Su=0,ku=Pg(Jc,wl,xu,Ar.vertical||Aa,mr,24,xl,sr.overscaling,8192);Su<ku.length;Su+=1){var Qc=ku[Su];Aa&&Lg(sr,Aa.text,wu,Qc)||$o(Jc,Qc)}else if(Lo==="line-center")for(var Eu=0,zu=Lr.geometry;Eu<zu.length;Eu+=1){var Tu=zu[Eu];if(Tu.length>1){var $c=Ag(Tu,xu,Ar.vertical||Aa,mr,24,xl);$c&&$o(Tu,$c)}}else if(Lr.type==="Polygon")for(var zl=0,eh=rp(Lr.geometry,0);zl<eh.length;zl+=1){var Tl=eh[zl],Iu=Mg(Tl,16);$o(Tl[0],new fl(Iu.x,Iu.y,0))}else if(Lr.type==="LineString")for(var Ls=0,Au=Lr.geometry;Ls<Au.length;Ls+=1){var Il=Au[Ls];$o(Il,new fl(Il[0].x,Il[0].y,0))}else if(Lr.type==="Point")for(var yp=0,Xf=Lr.geometry;yp<Xf.length;yp+=1)for(var gp=0,Wf=Xf[yp];gp<Wf.length;gp+=1){var _p=Wf[gp];$o([_p],new fl(_p.x,_p.y,0))}}(e,ke,ot,Xi,l,A,Je,wt,lt,kn,x)},be=0,we=e.features;be<we.length;be+=1)ye();m&&e.generateCollisionDebugBuffers()},a.perspective=function(e,t,i,l,f){var m,x=1/Math.tan(t/2);return e[0]=x/i,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=x,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[11]=-1,e[12]=0,e[13]=0,e[15]=0,f!=null&&f!==1/0?(e[10]=(f+l)*(m=1/(l-f)),e[14]=2*f*l*m):(e[10]=-1,e[14]=-2*l),e},a.pick=function(e,t){for(var i={},l=0;l<t.length;l++){var f=t[l];f in e&&(i[f]=e[f])}return i},a.plugin=$n,a.polygonIntersectsPolygon=$a,a.postMapLoadEvent=Ln,a.postTurnstileEvent=Wn,a.potpack=gf,a.refProperties=["type","source","source-layer","minzoom","maxzoom","filter","layout"],a.register=ft,a.registerForPluginStateChange=function(e){return e({pluginStatus:qn,pluginURL:Ma}),ru.on("pluginStateChange",e),e},a.renderColorRamp=Jp,a.rotate=function(e,t,i){var l=t[0],f=t[1],m=t[2],x=t[3],k=Math.sin(i),I=Math.cos(i);return e[0]=l*I+m*k,e[1]=f*I+x*k,e[2]=l*-k+m*I,e[3]=f*-k+x*I,e},a.rotateX=function(e,t,i){var l=Math.sin(i),f=Math.cos(i),m=t[4],x=t[5],k=t[6],I=t[7],A=t[8],M=t[9],B=t[10],U=t[11];return t!==e&&(e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e[4]=m*f+A*l,e[5]=x*f+M*l,e[6]=k*f+B*l,e[7]=I*f+U*l,e[8]=A*f-m*l,e[9]=M*f-x*l,e[10]=B*f-k*l,e[11]=U*f-I*l,e},a.rotateZ=function(e,t,i){var l=Math.sin(i),f=Math.cos(i),m=t[0],x=t[1],k=t[2],I=t[3],A=t[4],M=t[5],B=t[6],U=t[7];return t!==e&&(e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e[0]=m*f+A*l,e[1]=x*f+M*l,e[2]=k*f+B*l,e[3]=I*f+U*l,e[4]=A*f-m*l,e[5]=M*f-x*l,e[6]=B*f-k*l,e[7]=U*f-I*l,e},a.scale=function(e,t,i){var l=i[0],f=i[1],m=i[2];return e[0]=t[0]*l,e[1]=t[1]*l,e[2]=t[2]*l,e[3]=t[3]*l,e[4]=t[4]*f,e[5]=t[5]*f,e[6]=t[6]*f,e[7]=t[7]*f,e[8]=t[8]*m,e[9]=t[9]*m,e[10]=t[10]*m,e[11]=t[11]*m,e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15],e},a.scale$1=function(e,t,i){return e[0]=t[0]*i,e[1]=t[1]*i,e[2]=t[2]*i,e[3]=t[3]*i,e},a.scale$2=function(e,t,i){return e[0]=t[0]*i,e[1]=t[1]*i,e[2]=t[2]*i,e},a.setCacheLimits=function(e,t){Li=e,Ji=t},a.setRTLTextPlugin=function(e,t,i){if(i===void 0&&(i=!1),qn==="deferred"||qn==="loading"||qn==="loaded")throw new Error("setRTLTextPlugin cannot be called multiple times.");Ma=yi.resolveURL(e),qn="deferred",$s=t,xs(),i||da()},a.sphericalToCartesian=function(e){var t=e[0],i=e[1],l=e[2];return i+=90,i*=Math.PI/180,l*=Math.PI/180,{x:t*Math.cos(i)*Math.sin(l),y:t*Math.sin(i)*Math.sin(l),z:t*Math.cos(l)}},a.sqrLen=function(e){var t=e[0],i=e[1];return t*t+i*i},a.styleSpec=q,a.sub=function(e,t,i){return e[0]=t[0]-i[0],e[1]=t[1]-i[1],e[2]=t[2]-i[2],e},a.symbolSize=Ig,a.transformMat3=function(e,t,i){var l=t[0],f=t[1],m=t[2];return e[0]=l*i[0]+f*i[3]+m*i[6],e[1]=l*i[1]+f*i[4]+m*i[7],e[2]=l*i[2]+f*i[5]+m*i[8],e},a.transformMat4=al,a.translate=function(e,t,i){var l,f,m,x,k,I,A,M,B,U,j,J,$=i[0],ce=i[1],ie=i[2];return t===e?(e[12]=t[0]*$+t[4]*ce+t[8]*ie+t[12],e[13]=t[1]*$+t[5]*ce+t[9]*ie+t[13],e[14]=t[2]*$+t[6]*ce+t[10]*ie+t[14],e[15]=t[3]*$+t[7]*ce+t[11]*ie+t[15]):(f=t[1],m=t[2],x=t[3],k=t[4],I=t[5],A=t[6],M=t[7],B=t[8],U=t[9],j=t[10],J=t[11],e[0]=l=t[0],e[1]=f,e[2]=m,e[3]=x,e[4]=k,e[5]=I,e[6]=A,e[7]=M,e[8]=B,e[9]=U,e[10]=j,e[11]=J,e[12]=l*$+k*ce+B*ie+t[12],e[13]=f*$+I*ce+U*ie+t[13],e[14]=m*$+A*ce+j*ie+t[14],e[15]=x*$+M*ce+J*ie+t[15]),e},a.triggerPluginCompletionEvent=Tc,a.uniqueId=ht,a.validateCustomStyleLayer=function(e){var t=[],i=e.id;return i===void 0&&t.push({message:"layers."+i+': missing required property "id"'}),e.render===void 0&&t.push({message:"layers."+i+': missing required method "render"'}),e.renderingMode&&e.renderingMode!=="2d"&&e.renderingMode!=="3d"&&t.push({message:"layers."+i+': property "renderingMode" must be either "2d" or "3d"'}),t},a.validateLight=Hh,a.validateStyle=gs,a.values=function(e){var t=[];for(var i in e)t.push(e[i]);return t},a.vectorTile=ul,a.version="1.13.2",a.warnOnce=st,a.webpSupported=rn,a.window=R,a.wrap=de}),_(["./shared"],function(a){function T(P){var N=typeof P;if(N==="number"||N==="boolean"||N==="string"||P==null)return JSON.stringify(P);if(Array.isArray(P)){for(var V="[",K=0,W=P;K<W.length;K+=1)V+=T(W[K])+",";return V+"]"}for(var ue=Object.keys(P).sort(),he="{",q=0;q<ue.length;q++)he+=JSON.stringify(ue[q])+":"+T(P[ue[q]])+",";return he+"}"}function E(P){for(var N="",V=0,K=a.refProperties;V<K.length;V+=1)N+="/"+T(P[K[V]]);return N}var D=function(P){this.keyCache={},P&&this.replace(P)};D.prototype.replace=function(P){this._layerConfigs={},this._layers={},this.update(P,[])},D.prototype.update=function(P,N){for(var V=this,K=0,W=P;K<W.length;K+=1){var ue=W[K];this._layerConfigs[ue.id]=ue;var he=this._layers[ue.id]=a.createStyleLayer(ue);he._featureFilter=a.featureFilter(he.filter),this.keyCache[ue.id]&&delete this.keyCache[ue.id]}for(var q=0,Q=N;q<Q.length;q+=1){var me=Q[q];delete this.keyCache[me],delete this._layerConfigs[me],delete this._layers[me]}this.familiesBySource={};for(var Me=0,Be=function(Ge,Ye){for(var Pt={},rt=0;rt<Ge.length;rt++){var Qt=Ye&&Ye[Ge[rt].id]||E(Ge[rt]);Ye&&(Ye[Ge[rt].id]=Qt);var _r=Pt[Qt];_r||(_r=Pt[Qt]=[]),_r.push(Ge[rt])}var Kt=[];for(var lr in Pt)Kt.push(Pt[lr]);return Kt}(a.values(this._layerConfigs),this.keyCache);Me<Be.length;Me+=1){var Ee=Be[Me].map(function(Ge){return V._layers[Ge.id]}),De=Ee[0];if(De.visibility!=="none"){var it=De.source||"",nt=this.familiesBySource[it];nt||(nt=this.familiesBySource[it]={});var ze=De.sourceLayer||"_geojsonTileLayer",et=nt[ze];et||(et=nt[ze]=[]),et.push(Ee)}}};var F=function(P){var N={},V=[];for(var K in P){var W=P[K],ue=N[K]={};for(var he in W){var q=W[+he];if(q&&q.bitmap.width!==0&&q.bitmap.height!==0){var Q={x:0,y:0,w:q.bitmap.width+2,h:q.bitmap.height+2};V.push(Q),ue[he]={rect:Q,metrics:q.metrics}}}}var me=a.potpack(V),Me=new a.AlphaImage({width:me.w||1,height:me.h||1});for(var Be in P){var Ee=P[Be];for(var De in Ee){var it=Ee[+De];if(it&&it.bitmap.width!==0&&it.bitmap.height!==0){var nt=N[Be][De].rect;a.AlphaImage.copy(it.bitmap,Me,{x:0,y:0},{x:nt.x+1,y:nt.y+1},it.bitmap)}}}this.image=Me,this.positions=N};a.register("GlyphAtlas",F);var L=function(P){this.tileID=new a.OverscaledTileID(P.tileID.overscaledZ,P.tileID.wrap,P.tileID.canonical.z,P.tileID.canonical.x,P.tileID.canonical.y),this.uid=P.uid,this.zoom=P.zoom,this.pixelRatio=P.pixelRatio,this.tileSize=P.tileSize,this.source=P.source,this.overscaling=this.tileID.overscaleFactor(),this.showCollisionBoxes=P.showCollisionBoxes,this.collectResourceTiming=!!P.collectResourceTiming,this.returnDependencies=!!P.returnDependencies,this.promoteId=P.promoteId};function R(P,N,V){for(var K=new a.EvaluationParameters(N),W=0,ue=P;W<ue.length;W+=1)ue[W].recalculate(K,V)}function X(P,N){var V=a.getArrayBuffer(P.request,function(K,W,ue,he){K?N(K):W&&N(null,{vectorTile:new a.vectorTile.VectorTile(new a.pbf(W)),rawData:W,cacheControl:ue,expires:he})});return function(){V.cancel(),N()}}L.prototype.parse=function(P,N,V,K,W){var ue=this;this.status="parsing",this.data=P,this.collisionBoxArray=new a.CollisionBoxArray;var he=new a.DictionaryCoder(Object.keys(P.layers).sort()),q=new a.FeatureIndex(this.tileID,this.promoteId);q.bucketLayerIDs=[];var Q,me,Me,Be,Ee={},De={featureIndex:q,iconDependencies:{},patternDependencies:{},glyphDependencies:{},availableImages:V},it=N.familiesBySource[this.source];for(var nt in it){var ze=P.layers[nt];if(ze){ze.version===1&&a.warnOnce('Vector tile source "'+this.source+'" layer "'+nt+'" does not use vector tile spec v2 and therefore may have some rendering errors.');for(var et=he.encode(nt),Ge=[],Ye=0;Ye<ze.length;Ye++){var Pt=ze.feature(Ye),rt=q.getId(Pt,nt);Ge.push({feature:Pt,id:rt,index:Ye,sourceLayerIndex:et})}for(var Qt=0,_r=it[nt];Qt<_r.length;Qt+=1){var Kt=_r[Qt],lr=Kt[0];lr.minzoom&&this.zoom<Math.floor(lr.minzoom)||lr.maxzoom&&this.zoom>=lr.maxzoom||lr.visibility!=="none"&&(R(Kt,this.zoom,V),(Ee[lr.id]=lr.createBucket({index:q.bucketLayerIDs.length,layers:Kt,zoom:this.zoom,pixelRatio:this.pixelRatio,overscaling:this.overscaling,collisionBoxArray:this.collisionBoxArray,sourceLayerIndex:et,sourceID:this.source})).populate(Ge,De,this.tileID.canonical),q.bucketLayerIDs.push(Kt.map(function(gr){return gr.id})))}}}var $t=a.mapObject(De.glyphDependencies,function(gr){return Object.keys(gr).map(Number)});Object.keys($t).length?K.send("getGlyphs",{uid:this.uid,stacks:$t},function(gr,Wt){Q||(Q=gr,me=Wt,Or.call(ue))}):me={};var _i=Object.keys(De.iconDependencies);_i.length?K.send("getImages",{icons:_i,source:this.source,tileID:this.tileID,type:"icons"},function(gr,Wt){Q||(Q=gr,Me=Wt,Or.call(ue))}):Me={};var hr=Object.keys(De.patternDependencies);function Or(){if(Q)return W(Q);if(me&&Me&&Be){var gr=new F(me),Wt=new a.ImageAtlas(Me,Be);for(var ur in Ee){var Si=Ee[ur];Si instanceof a.SymbolBucket?(R(Si.layers,this.zoom,V),a.performSymbolLayout(Si,me,gr.positions,Me,Wt.iconPositions,this.showCollisionBoxes,this.tileID.canonical)):Si.hasPattern&&(Si instanceof a.LineBucket||Si instanceof a.FillBucket||Si instanceof a.FillExtrusionBucket)&&(R(Si.layers,this.zoom,V),Si.addFeatures(De,this.tileID.canonical,Wt.patternPositions))}this.status="done",W(null,{buckets:a.values(Ee).filter(function(ha){return!ha.isEmpty()}),featureIndex:q,collisionBoxArray:this.collisionBoxArray,glyphAtlasImage:gr.image,imageAtlas:Wt,glyphMap:this.returnDependencies?me:null,iconMap:this.returnDependencies?Me:null,glyphPositions:this.returnDependencies?gr.positions:null})}}hr.length?K.send("getImages",{icons:hr,source:this.source,tileID:this.tileID,type:"patterns"},function(gr,Wt){Q||(Q=gr,Be=Wt,Or.call(ue))}):Be={},Or.call(this)};var ne=function(P,N,V,K){this.actor=P,this.layerIndex=N,this.availableImages=V,this.loadVectorData=K||X,this.loading={},this.loaded={}};ne.prototype.loadTile=function(P,N){var V=this,K=P.uid;this.loading||(this.loading={});var W=!!(P&&P.request&&P.request.collectResourceTiming)&&new a.RequestPerformance(P.request),ue=this.loading[K]=new L(P);ue.abort=this.loadVectorData(P,function(he,q){if(delete V.loading[K],he||!q)return ue.status="done",V.loaded[K]=ue,N(he);var Q=q.rawData,me={};q.expires&&(me.expires=q.expires),q.cacheControl&&(me.cacheControl=q.cacheControl);var Me={};if(W){var Be=W.finish();Be&&(Me.resourceTiming=JSON.parse(JSON.stringify(Be)))}ue.vectorTile=q.vectorTile,ue.parse(q.vectorTile,V.layerIndex,V.availableImages,V.actor,function(Ee,De){if(Ee||!De)return N(Ee);N(null,a.extend({rawTileData:Q.slice(0)},De,me,Me))}),V.loaded=V.loaded||{},V.loaded[K]=ue})},ne.prototype.reloadTile=function(P,N){var V=this,K=this.loaded,W=P.uid,ue=this;if(K&&K[W]){var he=K[W];he.showCollisionBoxes=P.showCollisionBoxes;var q=function(Q,me){var Me=he.reloadCallback;Me&&(delete he.reloadCallback,he.parse(he.vectorTile,ue.layerIndex,V.availableImages,ue.actor,Me)),N(Q,me)};he.status==="parsing"?he.reloadCallback=q:he.status==="done"&&(he.vectorTile?he.parse(he.vectorTile,this.layerIndex,this.availableImages,this.actor,q):q())}},ne.prototype.abortTile=function(P,N){var V=this.loading,K=P.uid;V&&V[K]&&V[K].abort&&(V[K].abort(),delete V[K]),N()},ne.prototype.removeTile=function(P,N){var V=this.loaded,K=P.uid;V&&V[K]&&delete V[K],N()};var pe=a.window.ImageBitmap,ve=function(){this.loaded={}};function de(P,N){if(P.length!==0){xe(P[0],N);for(var V=1;V<P.length;V++)xe(P[V],!N)}}function xe(P,N){for(var V=0,K=0,W=P.length,ue=W-1;K<W;ue=K++)V+=(P[K][0]-P[ue][0])*(P[ue][1]+P[K][1]);V>=0!=!!N&&P.reverse()}ve.prototype.loadTile=function(P,N){var V=P.uid,K=P.encoding,W=P.rawImageData,ue=pe&&W instanceof pe?this.getImageData(W):W,he=new a.DEMData(V,ue,K);this.loaded=this.loaded||{},this.loaded[V]=he,N(null,he)},ve.prototype.getImageData=function(P){this.offscreenCanvas&&this.offscreenCanvasContext||(this.offscreenCanvas=new OffscreenCanvas(P.width,P.height),this.offscreenCanvasContext=this.offscreenCanvas.getContext("2d")),this.offscreenCanvas.width=P.width,this.offscreenCanvas.height=P.height,this.offscreenCanvasContext.drawImage(P,0,0,P.width,P.height);var N=this.offscreenCanvasContext.getImageData(-1,-1,P.width+2,P.height+2);return this.offscreenCanvasContext.clearRect(0,0,this.offscreenCanvas.width,this.offscreenCanvas.height),new a.RGBAImage({width:N.width,height:N.height},N.data)},ve.prototype.removeTile=function(P){var N=this.loaded,V=P.uid;N&&N[V]&&delete N[V]};var $e=a.vectorTile.VectorTileFeature.prototype.toGeoJSON,ht=function(P){this._feature=P,this.extent=a.EXTENT,this.type=P.type,this.properties=P.tags,"id"in P&&!isNaN(P.id)&&(this.id=parseInt(P.id,10))};ht.prototype.loadGeometry=function(){if(this._feature.type===1){for(var P=[],N=0,V=this._feature.geometry;N<V.length;N+=1){var K=V[N];P.push([new a.Point$1(K[0],K[1])])}return P}for(var W=[],ue=0,he=this._feature.geometry;ue<he.length;ue+=1){for(var q=[],Q=0,me=he[ue];Q<me.length;Q+=1){var Me=me[Q];q.push(new a.Point$1(Me[0],Me[1]))}W.push(q)}return W},ht.prototype.toGeoJSON=function(P,N,V){return $e.call(this,P,N,V)};var Pe=function(P){this.layers={_geojsonTileLayer:this},this.name="_geojsonTileLayer",this.extent=a.EXTENT,this.length=P.length,this._features=P};Pe.prototype.feature=function(P){return new ht(this._features[P])};var We=a.vectorTile.VectorTileFeature,gt=Ke;function Ke(P,N){this.options=N||{},this.features=P,this.length=P.length}function dt(P,N){this.id=typeof P.id=="number"?P.id:void 0,this.type=P.type,this.rawGeometry=P.type===1?[P.geometry]:P.geometry,this.properties=P.tags,this.extent=N||4096}Ke.prototype.feature=function(P){return new dt(this.features[P],this.options.extent)},dt.prototype.loadGeometry=function(){var P=this.rawGeometry;this.geometry=[];for(var N=0;N<P.length;N++){for(var V=P[N],K=[],W=0;W<V.length;W++)K.push(new a.Point$1(V[W][0],V[W][1]));this.geometry.push(K)}return this.geometry},dt.prototype.bbox=function(){this.geometry||this.loadGeometry();for(var P=this.geometry,N=1/0,V=-1/0,K=1/0,W=-1/0,ue=0;ue<P.length;ue++)for(var he=P[ue],q=0;q<he.length;q++){var Q=he[q];N=Math.min(N,Q.x),V=Math.max(V,Q.x),K=Math.min(K,Q.y),W=Math.max(W,Q.y)}return[N,K,V,W]},dt.prototype.toGeoJSON=We.prototype.toGeoJSON;var Ne=Vt,at=gt;function Vt(P){var N=new a.pbf;return function(V,K){for(var W in V.layers)K.writeMessage(3,st,V.layers[W])}(P,N),N.finish()}function st(P,N){var V;N.writeVarintField(15,P.version||1),N.writeStringField(1,P.name||""),N.writeVarintField(5,P.extent||4096);var K={keys:[],values:[],keycache:{},valuecache:{}};for(V=0;V<P.length;V++)K.feature=P.feature(V),N.writeMessage(2,At,K);var W=K.keys;for(V=0;V<W.length;V++)N.writeStringField(3,W[V]);var ue=K.values;for(V=0;V<ue.length;V++)N.writeMessage(4,_t,ue[V])}function At(P,N){var V=P.feature;V.id!==void 0&&N.writeVarintField(1,V.id),N.writeMessage(2,Fe,P),N.writeVarintField(3,V.type),N.writeMessage(4,Ir,V)}function Fe(P,N){var V=P.feature,K=P.keys,W=P.values,ue=P.keycache,he=P.valuecache;for(var q in V.properties){var Q=ue[q];Q===void 0&&(K.push(q),ue[q]=Q=K.length-1),N.writeVarint(Q);var me=V.properties[q],Me=typeof me;Me!=="string"&&Me!=="boolean"&&Me!=="number"&&(me=JSON.stringify(me));var Be=Me+":"+me,Ee=he[Be];Ee===void 0&&(W.push(me),he[Be]=Ee=W.length-1),N.writeVarint(Ee)}}function qt(P,N){return(N<<3)+(7&P)}function St(P){return P<<1^P>>31}function Ir(P,N){for(var V=P.loadGeometry(),K=P.type,W=0,ue=0,he=V.length,q=0;q<he;q++){var Q=V[q],me=1;K===1&&(me=Q.length),N.writeVarint(qt(1,me));for(var Me=K===3?Q.length-1:Q.length,Be=0;Be<Me;Be++){Be===1&&K!==1&&N.writeVarint(qt(2,Me-1));var Ee=Q[Be].x-W,De=Q[Be].y-ue;N.writeVarint(St(Ee)),N.writeVarint(St(De)),W+=Ee,ue+=De}K===3&&N.writeVarint(qt(7,1))}}function _t(P,N){var V=typeof P;V==="string"?N.writeStringField(1,P):V==="boolean"?N.writeBooleanField(7,P):V==="number"&&(P%1!=0?N.writeDoubleField(3,P):P<0?N.writeSVarintField(6,P):N.writeVarintField(5,P))}function xt(P,N,V,K){Re(P,V,K),Re(N,2*V,2*K),Re(N,2*V+1,2*K+1)}function Re(P,N,V){var K=P[N];P[N]=P[V],P[V]=K}function Dt(P,N,V,K){var W=P-V,ue=N-K;return W*W+ue*ue}Ne.fromVectorTileJs=Vt,Ne.fromGeojsonVt=function(P,N){N=N||{};var V={};for(var K in P)V[K]=new gt(P[K].features,N),V[K].name=K,V[K].version=N.version,V[K].extent=N.extent;return Vt({layers:V})},Ne.GeoJSONWrapper=at;var Rr=function(P){return P[0]},xr=function(P){return P[1]},Vr=function(P,N,V,K,W){N===void 0&&(N=Rr),V===void 0&&(V=xr),K===void 0&&(K=64),W===void 0&&(W=Float64Array),this.nodeSize=K,this.points=P;for(var ue=P.length<65536?Uint16Array:Uint32Array,he=this.ids=new ue(P.length),q=this.coords=new W(2*P.length),Q=0;Q<P.length;Q++)he[Q]=Q,q[2*Q]=N(P[Q]),q[2*Q+1]=V(P[Q]);(function me(Me,Be,Ee,De,it,nt){if(!(it-De<=Ee)){var ze=De+it>>1;(function et(Ge,Ye,Pt,rt,Qt,_r){for(;Qt>rt;){if(Qt-rt>600){var Kt=Qt-rt+1,lr=Pt-rt+1,$t=Math.log(Kt),_i=.5*Math.exp(2*$t/3),hr=.5*Math.sqrt($t*_i*(Kt-_i)/Kt)*(lr-Kt/2<0?-1:1);et(Ge,Ye,Pt,Math.max(rt,Math.floor(Pt-lr*_i/Kt+hr)),Math.min(Qt,Math.floor(Pt+(Kt-lr)*_i/Kt+hr)),_r)}var Or=Ye[2*Pt+_r],gr=rt,Wt=Qt;for(xt(Ge,Ye,rt,Pt),Ye[2*Qt+_r]>Or&&xt(Ge,Ye,rt,Qt);gr<Wt;){for(xt(Ge,Ye,gr,Wt),gr++,Wt--;Ye[2*gr+_r]<Or;)gr++;for(;Ye[2*Wt+_r]>Or;)Wt--}Ye[2*rt+_r]===Or?xt(Ge,Ye,rt,Wt):xt(Ge,Ye,++Wt,Qt),Wt<=Pt&&(rt=Wt+1),Pt<=Wt&&(Qt=Wt-1)}})(Me,Be,ze,De,it,nt%2),me(Me,Be,Ee,De,ze-1,nt+1),me(Me,Be,Ee,ze+1,it,nt+1)}})(he,q,K,0,he.length-1,0)};Vr.prototype.range=function(P,N,V,K){return function(W,ue,he,q,Q,me,Me){for(var Be,Ee,De=[0,W.length-1,0],it=[];De.length;){var nt=De.pop(),ze=De.pop(),et=De.pop();if(ze-et<=Me)for(var Ge=et;Ge<=ze;Ge++)Ee=ue[2*Ge+1],(Be=ue[2*Ge])>=he&&Be<=Q&&Ee>=q&&Ee<=me&&it.push(W[Ge]);else{var Ye=Math.floor((et+ze)/2);Ee=ue[2*Ye+1],(Be=ue[2*Ye])>=he&&Be<=Q&&Ee>=q&&Ee<=me&&it.push(W[Ye]);var Pt=(nt+1)%2;(nt===0?he<=Be:q<=Ee)&&(De.push(et),De.push(Ye-1),De.push(Pt)),(nt===0?Q>=Be:me>=Ee)&&(De.push(Ye+1),De.push(ze),De.push(Pt))}}return it}(this.ids,this.coords,P,N,V,K,this.nodeSize)},Vr.prototype.within=function(P,N,V){return function(K,W,ue,he,q,Q){for(var me=[0,K.length-1,0],Me=[],Be=q*q;me.length;){var Ee=me.pop(),De=me.pop(),it=me.pop();if(De-it<=Q)for(var nt=it;nt<=De;nt++)Dt(W[2*nt],W[2*nt+1],ue,he)<=Be&&Me.push(K[nt]);else{var ze=Math.floor((it+De)/2),et=W[2*ze],Ge=W[2*ze+1];Dt(et,Ge,ue,he)<=Be&&Me.push(K[ze]);var Ye=(Ee+1)%2;(Ee===0?ue-q<=et:he-q<=Ge)&&(me.push(it),me.push(ze-1),me.push(Ye)),(Ee===0?ue+q>=et:he+q>=Ge)&&(me.push(ze+1),me.push(De),me.push(Ye))}}return Me}(this.ids,this.coords,P,N,V,this.nodeSize)};var Br={minZoom:0,maxZoom:16,minPoints:2,radius:40,extent:512,nodeSize:64,log:!1,generateId:!1,reduce:null,map:function(P){return P}},fr=function(P){this.options=yn(Object.create(Br),P),this.trees=new Array(this.options.maxZoom+1)};function yi(P,N,V,K,W){return{x:P,y:N,zoom:1/0,id:V,parentId:-1,numPoints:K,properties:W}}function Jt(P,N){var V=P.geometry.coordinates,K=V[1];return{x:$r(V[0]),y:Gt(K),zoom:1/0,index:N,parentId:-1}}function rn(P){return{type:"Feature",id:P.id,properties:Mi(P),geometry:{type:"Point",coordinates:[(K=P.x,360*(K-.5)),(N=P.y,V=(180-360*N)*Math.PI/180,360*Math.atan(Math.exp(V))/Math.PI-90)]}};var N,V,K}function Mi(P){var N=P.numPoints,V=N>=1e4?Math.round(N/1e3)+"k":N>=1e3?Math.round(N/100)/10+"k":N;return yn(yn({},P.properties),{cluster:!0,cluster_id:P.id,point_count:N,point_count_abbreviated:V})}function $r(P){return P/360+.5}function Gt(P){var N=Math.sin(P*Math.PI/180),V=.5-.25*Math.log((1+N)/(1-N))/Math.PI;return V<0?0:V>1?1:V}function yn(P,N){for(var V in N)P[V]=N[V];return P}function Yr(P){return P.x}function li(P){return P.y}function nn(P,N,V,K,W,ue){var he=W-V,q=ue-K;if(he!==0||q!==0){var Q=((P-V)*he+(N-K)*q)/(he*he+q*q);Q>1?(V=W,K=ue):Q>0&&(V+=he*Q,K+=q*Q)}return(he=P-V)*he+(q=N-K)*q}function Ui(P,N,V,K){var W={id:P===void 0?null:P,type:N,geometry:V,tags:K,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0};return function(ue){var he=ue.geometry,q=ue.type;if(q==="Point"||q==="MultiPoint"||q==="LineString")an(ue,he);else if(q==="Polygon"||q==="MultiLineString")for(var Q=0;Q<he.length;Q++)an(ue,he[Q]);else if(q==="MultiPolygon")for(Q=0;Q<he.length;Q++)for(var me=0;me<he[Q].length;me++)an(ue,he[Q][me])}(W),W}function an(P,N){for(var V=0;V<N.length;V+=3)P.minX=Math.min(P.minX,N[V]),P.minY=Math.min(P.minY,N[V+1]),P.maxX=Math.max(P.maxX,N[V]),P.maxY=Math.max(P.maxY,N[V+1])}function yr(P,N,V,K){if(N.geometry){var W=N.geometry.coordinates,ue=N.geometry.type,he=Math.pow(V.tolerance/((1<<V.maxZoom)*V.extent),2),q=[],Q=N.id;if(V.promoteId?Q=N.properties[V.promoteId]:V.generateId&&(Q=K||0),ue==="Point")ui(W,q);else if(ue==="MultiPoint")for(var me=0;me<W.length;me++)ui(W[me],q);else if(ue==="LineString")on(W,q,he,!1);else if(ue==="MultiLineString"){if(V.lineMetrics){for(me=0;me<W.length;me++)on(W[me],q=[],he,!1),P.push(Ui(Q,"LineString",q,N.properties));return}qr(W,q,he,!1)}else if(ue==="Polygon")qr(W,q,he,!0);else{if(ue!=="MultiPolygon"){if(ue==="GeometryCollection"){for(me=0;me<N.geometry.geometries.length;me++)yr(P,{id:Q,geometry:N.geometry.geometries[me],properties:N.properties},V,K);return}throw new Error("Input data is not a valid GeoJSON object.")}for(me=0;me<W.length;me++){var Me=[];qr(W[me],Me,he,!0),q.push(Me)}}P.push(Ui(Q,ue,q,N.properties))}}function ui(P,N){N.push(ci(P[0])),N.push(hi(P[1])),N.push(0)}function on(P,N,V,K){for(var W,ue,he=0,q=0;q<P.length;q++){var Q=ci(P[q][0]),me=hi(P[q][1]);N.push(Q),N.push(me),N.push(0),q>0&&(he+=K?(W*me-Q*ue)/2:Math.sqrt(Math.pow(Q-W,2)+Math.pow(me-ue,2))),W=Q,ue=me}var Me=N.length-3;N[2]=1,function Be(Ee,De,it,nt){for(var ze,et=nt,Ge=it-De>>1,Ye=it-De,Pt=Ee[De],rt=Ee[De+1],Qt=Ee[it],_r=Ee[it+1],Kt=De+3;Kt<it;Kt+=3){var lr=nn(Ee[Kt],Ee[Kt+1],Pt,rt,Qt,_r);if(lr>et)ze=Kt,et=lr;else if(lr===et){var $t=Math.abs(Kt-Ge);$t<Ye&&(ze=Kt,Ye=$t)}}et>nt&&(ze-De>3&&Be(Ee,De,ze,nt),Ee[ze+2]=et,it-ze>3&&Be(Ee,ze,it,nt))}(N,0,Me,V),N[Me+2]=1,N.size=Math.abs(he),N.start=0,N.end=N.size}function qr(P,N,V,K){for(var W=0;W<P.length;W++){var ue=[];on(P[W],ue,V,K),N.push(ue)}}function ci(P){return P/360+.5}function hi(P){var N=Math.sin(P*Math.PI/180),V=.5-.25*Math.log((1+N)/(1-N))/Math.PI;return V<0?0:V>1?1:V}function gi(P,N,V,K,W,ue,he,q){if(K/=N,ue>=(V/=N)&&he<K)return P;if(he<V||ue>=K)return null;for(var Q=[],me=0;me<P.length;me++){var Me=P[me],Be=Me.geometry,Ee=Me.type,De=W===0?Me.minX:Me.minY,it=W===0?Me.maxX:Me.maxY;if(De>=V&&it<K)Q.push(Me);else if(!(it<V||De>=K)){var nt=[];if(Ee==="Point"||Ee==="MultiPoint")Di(Be,nt,V,K,W);else if(Ee==="LineString")Wn(Be,nt,V,K,W,!1,q.lineMetrics);else if(Ee==="MultiLineString")Ln(Be,nt,V,K,W,!1);else if(Ee==="Polygon")Ln(Be,nt,V,K,W,!0);else if(Ee==="MultiPolygon")for(var ze=0;ze<Be.length;ze++){var et=[];Ln(Be[ze],et,V,K,W,!0),et.length&&nt.push(et)}if(nt.length){if(q.lineMetrics&&Ee==="LineString"){for(ze=0;ze<nt.length;ze++)Q.push(Ui(Me.id,Ee,nt[ze],Me.tags));continue}Ee!=="LineString"&&Ee!=="MultiLineString"||(nt.length===1?(Ee="LineString",nt=nt[0]):Ee="MultiLineString"),Ee!=="Point"&&Ee!=="MultiPoint"||(Ee=nt.length===3?"Point":"MultiPoint"),Q.push(Ui(Me.id,Ee,nt,Me.tags))}}}return Q.length?Q:null}function Di(P,N,V,K,W){for(var ue=0;ue<P.length;ue+=3){var he=P[ue+W];he>=V&&he<=K&&(N.push(P[ue]),N.push(P[ue+1]),N.push(P[ue+2]))}}function Wn(P,N,V,K,W,ue,he){for(var q,Q,me=Vi(P),Me=W===0?Ji:Rn,Be=P.start,Ee=0;Ee<P.length-3;Ee+=3){var De=P[Ee],it=P[Ee+1],nt=P[Ee+2],ze=P[Ee+3],et=P[Ee+4],Ge=W===0?De:it,Ye=W===0?ze:et,Pt=!1;he&&(q=Math.sqrt(Math.pow(De-ze,2)+Math.pow(it-et,2))),Ge<V?Ye>V&&(Q=Me(me,De,it,ze,et,V),he&&(me.start=Be+q*Q)):Ge>K?Ye<K&&(Q=Me(me,De,it,ze,et,K),he&&(me.start=Be+q*Q)):Li(me,De,it,nt),Ye<V&&Ge>=V&&(Q=Me(me,De,it,ze,et,V),Pt=!0),Ye>K&&Ge<=K&&(Q=Me(me,De,it,ze,et,K),Pt=!0),!ue&&Pt&&(he&&(me.end=Be+q*Q),N.push(me),me=Vi(P)),he&&(Be+=q)}var rt=P.length-3;De=P[rt],it=P[rt+1],nt=P[rt+2],(Ge=W===0?De:it)>=V&&Ge<=K&&Li(me,De,it,nt),rt=me.length-3,ue&&rt>=3&&(me[rt]!==me[0]||me[rt+1]!==me[1])&&Li(me,me[0],me[1],me[2]),me.length&&N.push(me)}function Vi(P){var N=[];return N.size=P.size,N.start=P.start,N.end=P.end,N}function Ln(P,N,V,K,W,ue){for(var he=0;he<P.length;he++)Wn(P[he],N,V,K,W,ue,!1)}function Li(P,N,V,K){P.push(N),P.push(V),P.push(K)}function Ji(P,N,V,K,W,ue){var he=(ue-N)/(K-N);return P.push(ue),P.push(V+(W-V)*he),P.push(1),he}function Rn(P,N,V,K,W,ue){var he=(ue-V)/(W-V);return P.push(N+(K-N)*he),P.push(ue),P.push(1),he}function Tn(P,N){for(var V=[],K=0;K<P.length;K++){var W,ue=P[K],he=ue.type;if(he==="Point"||he==="MultiPoint"||he==="LineString")W=ei(ue.geometry,N);else if(he==="MultiLineString"||he==="Polygon"){W=[];for(var q=0;q<ue.geometry.length;q++)W.push(ei(ue.geometry[q],N))}else if(he==="MultiPolygon")for(W=[],q=0;q<ue.geometry.length;q++){for(var Q=[],me=0;me<ue.geometry[q].length;me++)Q.push(ei(ue.geometry[q][me],N));W.push(Q)}V.push(Ui(ue.id,he,W,ue.tags))}return V}function ei(P,N){var V=[];V.size=P.size,P.start!==void 0&&(V.start=P.start,V.end=P.end);for(var K=0;K<P.length;K+=3)V.push(P[K]+N,P[K+1],P[K+2]);return V}function Yn(P,N){if(P.transformed)return P;var V,K,W,ue=1<<P.z,he=P.x,q=P.y;for(V=0;V<P.features.length;V++){var Q=P.features[V],me=Q.geometry,Me=Q.type;if(Q.geometry=[],Me===1)for(K=0;K<me.length;K+=2)Q.geometry.push(In(me[K],me[K+1],N,ue,he,q));else for(K=0;K<me.length;K++){var Be=[];for(W=0;W<me[K].length;W+=2)Be.push(In(me[K][W],me[K][W+1],N,ue,he,q));Q.geometry.push(Be)}}return P.transformed=!0,P}function In(P,N,V,K,W,ue){return[Math.round(V*(P*K-W)),Math.round(V*(N*K-ue))]}function wi(P,N,V,K,W){for(var ue=N===W.maxZoom?0:W.tolerance/((1<<N)*W.extent),he={features:[],numPoints:0,numSimplified:0,numFeatures:0,source:null,x:V,y:K,z:N,transformed:!1,minX:2,minY:1,maxX:-1,maxY:0},q=0;q<P.length;q++){he.numFeatures++,ca(he,P[q],ue,W);var Q=P[q].minX,me=P[q].minY,Me=P[q].maxX,Be=P[q].maxY;Q<he.minX&&(he.minX=Q),me<he.minY&&(he.minY=me),Me>he.maxX&&(he.maxX=Me),Be>he.maxY&&(he.maxY=Be)}return he}function ca(P,N,V,K){var W=N.geometry,ue=N.type,he=[];if(ue==="Point"||ue==="MultiPoint")for(var q=0;q<W.length;q+=3)he.push(W[q]),he.push(W[q+1]),P.numPoints++,P.numSimplified++;else if(ue==="LineString")An(he,W,P,V,!1,!1);else if(ue==="MultiLineString"||ue==="Polygon")for(q=0;q<W.length;q++)An(he,W[q],P,V,ue==="Polygon",q===0);else if(ue==="MultiPolygon")for(var Q=0;Q<W.length;Q++){var me=W[Q];for(q=0;q<me.length;q++)An(he,me[q],P,V,!0,q===0)}if(he.length){var Me=N.tags||null;if(ue==="LineString"&&K.lineMetrics){for(var Be in Me={},N.tags)Me[Be]=N.tags[Be];Me.mapbox_clip_start=W.start/W.size,Me.mapbox_clip_end=W.end/W.size}var Ee={geometry:he,type:ue==="Polygon"||ue==="MultiPolygon"?3:ue==="LineString"||ue==="MultiLineString"?2:1,tags:Me};N.id!==null&&(Ee.id=N.id),P.features.push(Ee)}}function An(P,N,V,K,W,ue){var he=K*K;if(K>0&&N.size<(W?he:K))V.numPoints+=N.length/3;else{for(var q=[],Q=0;Q<N.length;Q+=3)(K===0||N[Q+2]>he)&&(V.numSimplified++,q.push(N[Q]),q.push(N[Q+1])),V.numPoints++;W&&function(me,Me){for(var Be=0,Ee=0,De=me.length,it=De-2;Ee<De;it=Ee,Ee+=2)Be+=(me[Ee]-me[it])*(me[Ee+1]+me[it+1]);if(Be>0===Me)for(Ee=0,De=me.length;Ee<De/2;Ee+=2){var nt=me[Ee],ze=me[Ee+1];me[Ee]=me[De-2-Ee],me[Ee+1]=me[De-1-Ee],me[De-2-Ee]=nt,me[De-1-Ee]=ze}}(q,ue),P.push(q)}}function Mr(P,N){var V=(N=this.options=function(W,ue){for(var he in ue)W[he]=ue[he];return W}(Object.create(this.options),N)).debug;if(V&&console.time("preprocess data"),N.maxZoom<0||N.maxZoom>24)throw new Error("maxZoom should be in the 0-24 range");if(N.promoteId&&N.generateId)throw new Error("promoteId and generateId cannot be used together.");var K=function(W,ue){var he=[];if(W.type==="FeatureCollection")for(var q=0;q<W.features.length;q++)yr(he,W.features[q],ue,q);else yr(he,W.type==="Feature"?W:{geometry:W},ue);return he}(P,N);this.tiles={},this.tileCoords=[],V&&(console.timeEnd("preprocess data"),console.log("index: maxZoom: %d, maxPoints: %d",N.indexMaxZoom,N.indexMaxPoints),console.time("generate tiles"),this.stats={},this.total=0),(K=function(W,ue){var he=ue.buffer/ue.extent,q=W,Q=gi(W,1,-1-he,he,0,-1,2,ue),me=gi(W,1,1-he,2+he,0,-1,2,ue);return(Q||me)&&(q=gi(W,1,-he,1+he,0,-1,2,ue)||[],Q&&(q=Tn(Q,1).concat(q)),me&&(q=q.concat(Tn(me,-1)))),q}(K,N)).length&&this.splitTile(K,0,0,0),V&&(K.length&&console.log("features: %d, points: %d",this.tiles[0].numFeatures,this.tiles[0].numPoints),console.timeEnd("generate tiles"),console.log("tiles generated:",this.total,JSON.stringify(this.stats)))}function sn(P,N,V){return 32*((1<<P)*V+N)+P}function gn(P,N){var V=P.tileID.canonical;if(!this._geoJSONIndex)return N(null,null);var K=this._geoJSONIndex.getTile(V.z,V.x,V.y);if(!K)return N(null,null);var W=new Pe(K.features),ue=Ne(W);ue.byteOffset===0&&ue.byteLength===ue.buffer.byteLength||(ue=new Uint8Array(ue)),N(null,{vectorTile:W,rawData:ue.buffer})}fr.prototype.load=function(P){var N=this.options,V=N.log,K=N.minZoom,W=N.maxZoom,ue=N.nodeSize;V&&console.time("total time");var he="prepare "+P.length+" points";V&&console.time(he),this.points=P;for(var q=[],Q=0;Q<P.length;Q++)P[Q].geometry&&q.push(Jt(P[Q],Q));this.trees[W+1]=new Vr(q,Yr,li,ue,Float32Array),V&&console.timeEnd(he);for(var me=W;me>=K;me--){var Me=+Date.now();q=this._cluster(q,me),this.trees[me]=new Vr(q,Yr,li,ue,Float32Array),V&&console.log("z%d: %d clusters in %dms",me,q.length,+Date.now()-Me)}return V&&console.timeEnd("total time"),this},fr.prototype.getClusters=function(P,N){var V=((P[0]+180)%360+360)%360-180,K=Math.max(-90,Math.min(90,P[1])),W=P[2]===180?180:((P[2]+180)%360+360)%360-180,ue=Math.max(-90,Math.min(90,P[3]));if(P[2]-P[0]>=360)V=-180,W=180;else if(V>W){var he=this.getClusters([V,K,180,ue],N),q=this.getClusters([-180,K,W,ue],N);return he.concat(q)}for(var Q=this.trees[this._limitZoom(N)],me=[],Me=0,Be=Q.range($r(V),Gt(ue),$r(W),Gt(K));Me<Be.length;Me+=1){var Ee=Q.points[Be[Me]];me.push(Ee.numPoints?rn(Ee):this.points[Ee.index])}return me},fr.prototype.getChildren=function(P){var N=this._getOriginId(P),V=this._getOriginZoom(P),K="No cluster with the specified id.",W=this.trees[V];if(!W)throw new Error(K);var ue=W.points[N];if(!ue)throw new Error(K);for(var he=this.options.radius/(this.options.extent*Math.pow(2,V-1)),q=[],Q=0,me=W.within(ue.x,ue.y,he);Q<me.length;Q+=1){var Me=W.points[me[Q]];Me.parentId===P&&q.push(Me.numPoints?rn(Me):this.points[Me.index])}if(q.length===0)throw new Error(K);return q},fr.prototype.getLeaves=function(P,N,V){var K=[];return this._appendLeaves(K,P,N=N||10,V=V||0,0),K},fr.prototype.getTile=function(P,N,V){var K=this.trees[this._limitZoom(P)],W=Math.pow(2,P),ue=this.options,he=ue.radius/ue.extent,q=(V-he)/W,Q=(V+1+he)/W,me={features:[]};return this._addTileFeatures(K.range((N-he)/W,q,(N+1+he)/W,Q),K.points,N,V,W,me),N===0&&this._addTileFeatures(K.range(1-he/W,q,1,Q),K.points,W,V,W,me),N===W-1&&this._addTileFeatures(K.range(0,q,he/W,Q),K.points,-1,V,W,me),me.features.length?me:null},fr.prototype.getClusterExpansionZoom=function(P){for(var N=this._getOriginZoom(P)-1;N<=this.options.maxZoom;){var V=this.getChildren(P);if(N++,V.length!==1)break;P=V[0].properties.cluster_id}return N},fr.prototype._appendLeaves=function(P,N,V,K,W){for(var ue=0,he=this.getChildren(N);ue<he.length;ue+=1){var q=he[ue],Q=q.properties;if(Q&&Q.cluster?W+Q.point_count<=K?W+=Q.point_count:W=this._appendLeaves(P,Q.cluster_id,V,K,W):W<K?W++:P.push(q),P.length===V)break}return W},fr.prototype._addTileFeatures=function(P,N,V,K,W,ue){for(var he=0,q=P;he<q.length;he+=1){var Q=N[q[he]],me=Q.numPoints,Me={type:1,geometry:[[Math.round(this.options.extent*(Q.x*W-V)),Math.round(this.options.extent*(Q.y*W-K))]],tags:me?Mi(Q):this.points[Q.index].properties},Be=void 0;me?Be=Q.id:this.options.generateId?Be=Q.index:this.points[Q.index].id&&(Be=this.points[Q.index].id),Be!==void 0&&(Me.id=Be),ue.features.push(Me)}},fr.prototype._limitZoom=function(P){return Math.max(this.options.minZoom,Math.min(+P,this.options.maxZoom+1))},fr.prototype._cluster=function(P,N){for(var V=[],K=this.options,W=K.reduce,ue=K.minPoints,he=K.radius/(K.extent*Math.pow(2,N)),q=0;q<P.length;q++){var Q=P[q];if(!(Q.zoom<=N)){Q.zoom=N;for(var me=this.trees[N+1],Me=me.within(Q.x,Q.y,he),Be=Q.numPoints||1,Ee=Be,De=0,it=Me;De<it.length;De+=1){var nt=me.points[it[De]];nt.zoom>N&&(Ee+=nt.numPoints||1)}if(Ee>=ue){for(var ze=Q.x*Be,et=Q.y*Be,Ge=W&&Be>1?this._map(Q,!0):null,Ye=(q<<5)+(N+1)+this.points.length,Pt=0,rt=Me;Pt<rt.length;Pt+=1){var Qt=me.points[rt[Pt]];if(!(Qt.zoom<=N)){Qt.zoom=N;var _r=Qt.numPoints||1;ze+=Qt.x*_r,et+=Qt.y*_r,Qt.parentId=Ye,W&&(Ge||(Ge=this._map(Q,!0)),W(Ge,this._map(Qt)))}}Q.parentId=Ye,V.push(yi(ze/Ee,et/Ee,Ye,Ee,Ge))}else if(V.push(Q),Ee>1)for(var Kt=0,lr=Me;Kt<lr.length;Kt+=1){var $t=me.points[lr[Kt]];$t.zoom<=N||($t.zoom=N,V.push($t))}}}return V},fr.prototype._getOriginId=function(P){return P-this.points.length>>5},fr.prototype._getOriginZoom=function(P){return(P-this.points.length)%32},fr.prototype._map=function(P,N){if(P.numPoints)return N?yn({},P.properties):P.properties;var V=this.points[P.index].properties,K=this.options.map(V);return N&&K===V?yn({},K):K},Mr.prototype.options={maxZoom:14,indexMaxZoom:5,indexMaxPoints:1e5,tolerance:3,extent:4096,buffer:64,lineMetrics:!1,promoteId:null,generateId:!1,debug:0},Mr.prototype.splitTile=function(P,N,V,K,W,ue,he){for(var q=[P,N,V,K],Q=this.options,me=Q.debug;q.length;){K=q.pop(),V=q.pop(),N=q.pop(),P=q.pop();var Me=1<<N,Be=sn(N,V,K),Ee=this.tiles[Be];if(!Ee&&(me>1&&console.time("creation"),Ee=this.tiles[Be]=wi(P,N,V,K,Q),this.tileCoords.push({z:N,x:V,y:K}),me)){me>1&&(console.log("tile z%d-%d-%d (features: %d, points: %d, simplified: %d)",N,V,K,Ee.numFeatures,Ee.numPoints,Ee.numSimplified),console.timeEnd("creation"));var De="z"+N;this.stats[De]=(this.stats[De]||0)+1,this.total++}if(Ee.source=P,W){if(N===Q.maxZoom||N===W)continue;var it=1<<W-N;if(V!==Math.floor(ue/it)||K!==Math.floor(he/it))continue}else if(N===Q.indexMaxZoom||Ee.numPoints<=Q.indexMaxPoints)continue;if(Ee.source=null,P.length!==0){me>1&&console.time("clipping");var nt,ze,et,Ge,Ye,Pt,rt=.5*Q.buffer/Q.extent,Qt=.5-rt,_r=.5+rt,Kt=1+rt;nt=ze=et=Ge=null,Ye=gi(P,Me,V-rt,V+_r,0,Ee.minX,Ee.maxX,Q),Pt=gi(P,Me,V+Qt,V+Kt,0,Ee.minX,Ee.maxX,Q),P=null,Ye&&(nt=gi(Ye,Me,K-rt,K+_r,1,Ee.minY,Ee.maxY,Q),ze=gi(Ye,Me,K+Qt,K+Kt,1,Ee.minY,Ee.maxY,Q),Ye=null),Pt&&(et=gi(Pt,Me,K-rt,K+_r,1,Ee.minY,Ee.maxY,Q),Ge=gi(Pt,Me,K+Qt,K+Kt,1,Ee.minY,Ee.maxY,Q),Pt=null),me>1&&console.timeEnd("clipping"),q.push(nt||[],N+1,2*V,2*K),q.push(ze||[],N+1,2*V,2*K+1),q.push(et||[],N+1,2*V+1,2*K),q.push(Ge||[],N+1,2*V+1,2*K+1)}}},Mr.prototype.getTile=function(P,N,V){var K=this.options,W=K.extent,ue=K.debug;if(P<0||P>24)return null;var he=1<<P,q=sn(P,N=(N%he+he)%he,V);if(this.tiles[q])return Yn(this.tiles[q],W);ue>1&&console.log("drilling down to z%d-%d-%d",P,N,V);for(var Q,me=P,Me=N,Be=V;!Q&&me>0;)me--,Me=Math.floor(Me/2),Be=Math.floor(Be/2),Q=this.tiles[sn(me,Me,Be)];return Q&&Q.source?(ue>1&&console.log("found parent tile z%d-%d-%d",me,Me,Be),ue>1&&console.time("drilling down"),this.splitTile(Q.source,me,Me,Be,P,N,V),ue>1&&console.timeEnd("drilling down"),this.tiles[q]?Yn(this.tiles[q],W):null):null};var ti=function(P){function N(V,K,W,ue){P.call(this,V,K,W,gn),ue&&(this.loadGeoJSON=ue)}return P&&(N.__proto__=P),(N.prototype=Object.create(P&&P.prototype)).constructor=N,N.prototype.loadData=function(V,K){this._pendingCallback&&this._pendingCallback(null,{abandoned:!0}),this._pendingCallback=K,this._pendingLoadDataParams=V,this._state&&this._state!=="Idle"?this._state="NeedsLoadData":(this._state="Coalescing",this._loadData())},N.prototype._loadData=function(){var V=this;if(this._pendingCallback&&this._pendingLoadDataParams){var K=this._pendingCallback,W=this._pendingLoadDataParams;delete this._pendingCallback,delete this._pendingLoadDataParams;var ue=!!(W&&W.request&&W.request.collectResourceTiming)&&new a.RequestPerformance(W.request);this.loadGeoJSON(W,function(he,q){if(he||!q)return K(he);if(typeof q!="object")return K(new Error("Input data given to '"+W.source+"' is not a valid GeoJSON object."));(function Ee(De,it){var nt,ze=De&&De.type;if(ze==="FeatureCollection")for(nt=0;nt<De.features.length;nt++)Ee(De.features[nt],it);else if(ze==="GeometryCollection")for(nt=0;nt<De.geometries.length;nt++)Ee(De.geometries[nt],it);else if(ze==="Feature")Ee(De.geometry,it);else if(ze==="Polygon")de(De.coordinates,it);else if(ze==="MultiPolygon")for(nt=0;nt<De.coordinates.length;nt++)de(De.coordinates[nt],it);return De})(q,!0);try{if(W.filter){var Q=a.createExpression(W.filter,{type:"boolean","property-type":"data-driven",overridable:!1,transition:!1});if(Q.result==="error")throw new Error(Q.value.map(function(Ee){return Ee.key+": "+Ee.message}).join(", "));var me=q.features.filter(function(Ee){return Q.value.evaluate({zoom:0},Ee)});q={type:"FeatureCollection",features:me}}V._geoJSONIndex=W.cluster?new fr(function(Ee){var De=Ee.superclusterOptions,it=Ee.clusterProperties;if(!it||!De)return De;for(var nt={},ze={},et={accumulated:null,zoom:0},Ge={properties:null},Ye=Object.keys(it),Pt=0,rt=Ye;Pt<rt.length;Pt+=1){var Qt=rt[Pt],_r=it[Qt],Kt=_r[0],lr=a.createExpression(_r[1]),$t=a.createExpression(typeof Kt=="string"?[Kt,["accumulated"],["get",Qt]]:Kt);nt[Qt]=lr.value,ze[Qt]=$t.value}return De.map=function(_i){Ge.properties=_i;for(var hr={},Or=0,gr=Ye;Or<gr.length;Or+=1){var Wt=gr[Or];hr[Wt]=nt[Wt].evaluate(et,Ge)}return hr},De.reduce=function(_i,hr){Ge.properties=hr;for(var Or=0,gr=Ye;Or<gr.length;Or+=1){var Wt=gr[Or];et.accumulated=_i[Wt],_i[Wt]=ze[Wt].evaluate(et,Ge)}},De}(W)).load(q.features):function(Ee,De){return new Mr(Ee,De)}(q,W.geojsonVtOptions)}catch(Ee){return K(Ee)}V.loaded={};var Me={};if(ue){var Be=ue.finish();Be&&(Me.resourceTiming={},Me.resourceTiming[W.source]=JSON.parse(JSON.stringify(Be)))}K(null,Me)})}},N.prototype.coalesce=function(){this._state==="Coalescing"?this._state="Idle":this._state==="NeedsLoadData"&&(this._state="Coalescing",this._loadData())},N.prototype.reloadTile=function(V,K){var W=this.loaded;return W&&W[V.uid]?P.prototype.reloadTile.call(this,V,K):this.loadTile(V,K)},N.prototype.loadGeoJSON=function(V,K){if(V.request)a.getJSON(V.request,K);else{if(typeof V.data!="string")return K(new Error("Input data given to '"+V.source+"' is not a valid GeoJSON object."));try{return K(null,JSON.parse(V.data))}catch{return K(new Error("Input data given to '"+V.source+"' is not a valid GeoJSON object."))}}},N.prototype.removeSource=function(V,K){this._pendingCallback&&this._pendingCallback(null,{abandoned:!0}),K()},N.prototype.getClusterExpansionZoom=function(V,K){try{K(null,this._geoJSONIndex.getClusterExpansionZoom(V.clusterId))}catch(W){K(W)}},N.prototype.getClusterChildren=function(V,K){try{K(null,this._geoJSONIndex.getChildren(V.clusterId))}catch(W){K(W)}},N.prototype.getClusterLeaves=function(V,K){try{K(null,this._geoJSONIndex.getLeaves(V.clusterId,V.limit,V.offset))}catch(W){K(W)}},N}(ne),te=function(P){var N=this;this.self=P,this.actor=new a.Actor(P,this),this.layerIndexes={},this.availableImages={},this.workerSourceTypes={vector:ne,geojson:ti},this.workerSources={},this.demWorkerSources={},this.self.registerWorkerSource=function(V,K){if(N.workerSourceTypes[V])throw new Error('Worker source with name "'+V+'" already registered.');N.workerSourceTypes[V]=K},this.self.registerRTLTextPlugin=function(V){if(a.plugin.isParsed())throw new Error("RTL text plugin already registered.");a.plugin.applyArabicShaping=V.applyArabicShaping,a.plugin.processBidirectionalText=V.processBidirectionalText,a.plugin.processStyledBidirectionalText=V.processStyledBidirectionalText}};return te.prototype.setReferrer=function(P,N){this.referrer=N},te.prototype.setImages=function(P,N,V){for(var K in this.availableImages[P]=N,this.workerSources[P]){var W=this.workerSources[P][K];for(var ue in W)W[ue].availableImages=N}V()},te.prototype.setLayers=function(P,N,V){this.getLayerIndex(P).replace(N),V()},te.prototype.updateLayers=function(P,N,V){this.getLayerIndex(P).update(N.layers,N.removedIds),V()},te.prototype.loadTile=function(P,N,V){this.getWorkerSource(P,N.type,N.source).loadTile(N,V)},te.prototype.loadDEMTile=function(P,N,V){this.getDEMWorkerSource(P,N.source).loadTile(N,V)},te.prototype.reloadTile=function(P,N,V){this.getWorkerSource(P,N.type,N.source).reloadTile(N,V)},te.prototype.abortTile=function(P,N,V){this.getWorkerSource(P,N.type,N.source).abortTile(N,V)},te.prototype.removeTile=function(P,N,V){this.getWorkerSource(P,N.type,N.source).removeTile(N,V)},te.prototype.removeDEMTile=function(P,N){this.getDEMWorkerSource(P,N.source).removeTile(N)},te.prototype.removeSource=function(P,N,V){if(this.workerSources[P]&&this.workerSources[P][N.type]&&this.workerSources[P][N.type][N.source]){var K=this.workerSources[P][N.type][N.source];delete this.workerSources[P][N.type][N.source],K.removeSource!==void 0?K.removeSource(N,V):V()}},te.prototype.loadWorkerSource=function(P,N,V){try{this.self.importScripts(N.url),V()}catch(K){V(K.toString())}},te.prototype.syncRTLPluginState=function(P,N,V){try{a.plugin.setState(N);var K=a.plugin.getPluginURL();if(a.plugin.isLoaded()&&!a.plugin.isParsed()&&K!=null){this.self.importScripts(K);var W=a.plugin.isParsed();V(W?void 0:new Error("RTL Text Plugin failed to import scripts from "+K),W)}}catch(ue){V(ue.toString())}},te.prototype.getAvailableImages=function(P){var N=this.availableImages[P];return N||(N=[]),N},te.prototype.getLayerIndex=function(P){var N=this.layerIndexes[P];return N||(N=this.layerIndexes[P]=new D),N},te.prototype.getWorkerSource=function(P,N,V){var K=this;return this.workerSources[P]||(this.workerSources[P]={}),this.workerSources[P][N]||(this.workerSources[P][N]={}),this.workerSources[P][N][V]||(this.workerSources[P][N][V]=new this.workerSourceTypes[N]({send:function(W,ue,he){K.actor.send(W,ue,he,P)}},this.getLayerIndex(P),this.getAvailableImages(P))),this.workerSources[P][N][V]},te.prototype.getDEMWorkerSource=function(P,N){return this.demWorkerSources[P]||(this.demWorkerSources[P]={}),this.demWorkerSources[P][N]||(this.demWorkerSources[P][N]=new ve),this.demWorkerSources[P][N]},te.prototype.enforceCacheSizeLimit=function(P,N){a.enforceCacheSizeLimit(N)},typeof WorkerGlobalScope<"u"&&typeof self<"u"&&self instanceof WorkerGlobalScope&&(self.worker=new te(self)),te}),_(["./shared"],function(a){var T=a.createCommonjsModule(function(n){function s(v){return!o(v)}function o(v){return typeof window>"u"||typeof document>"u"?"not a browser":Array.prototype&&Array.prototype.every&&Array.prototype.filter&&Array.prototype.forEach&&Array.prototype.indexOf&&Array.prototype.lastIndexOf&&Array.prototype.map&&Array.prototype.some&&Array.prototype.reduce&&Array.prototype.reduceRight&&Array.isArray?Function.prototype&&Function.prototype.bind?Object.keys&&Object.create&&Object.getPrototypeOf&&Object.getOwnPropertyNames&&Object.isSealed&&Object.isFrozen&&Object.isExtensible&&Object.getOwnPropertyDescriptor&&Object.defineProperty&&Object.defineProperties&&Object.seal&&Object.freeze&&Object.preventExtensions?"JSON"in window&&"parse"in JSON&&"stringify"in JSON?function(){if(!("Worker"in window&&"Blob"in window&&"URL"in window))return!1;var S,z,C=new Blob([""],{type:"text/javascript"}),O=URL.createObjectURL(C);try{z=new Worker(O),S=!0}catch{S=!1}return z&&z.terminate(),URL.revokeObjectURL(O),S}()?"Uint8ClampedArray"in window?ArrayBuffer.isView?function(){var S=document.createElement("canvas");S.width=S.height=1;var z=S.getContext("2d");if(!z)return!1;var C=z.getImageData(0,0,1,1);return C&&C.width===S.width}()?(c[w=v&&v.failIfMajorPerformanceCaveat]===void 0&&(c[w]=function(S){var z=function(O){var Z=document.createElement("canvas"),G=Object.create(s.webGLContextAttributes);return G.failIfMajorPerformanceCaveat=O,Z.probablySupportsContext?Z.probablySupportsContext("webgl",G)||Z.probablySupportsContext("experimental-webgl",G):Z.supportsContext?Z.supportsContext("webgl",G)||Z.supportsContext("experimental-webgl",G):Z.getContext("webgl",G)||Z.getContext("experimental-webgl",G)}(S);if(!z)return!1;var C=z.createShader(z.VERTEX_SHADER);return!(!C||z.isContextLost())&&(z.shaderSource(C,"void main() {}"),z.compileShader(C),z.getShaderParameter(C,z.COMPILE_STATUS)===!0)}(w)),c[w]?void 0:"insufficient WebGL support"):"insufficient Canvas/getImageData support":"insufficient ArrayBuffer support":"insufficient Uint8ClampedArray support":"insufficient worker support":"insufficient JSON support":"insufficient Object support":"insufficient Function support":"insufficent Array support";var w}n.exports?n.exports=s:window&&(window.mapboxgl=window.mapboxgl||{},window.mapboxgl.supported=s,window.mapboxgl.notSupportedReason=o);var c={};s.webGLContextAttributes={antialias:!1,alpha:!0,stencil:!0,depth:!0}}),E={create:function(n,s,o){var c=a.window.document.createElement(n);return s!==void 0&&(c.className=s),o&&o.appendChild(c),c},createNS:function(n,s){return a.window.document.createElementNS(n,s)}},D=a.window.document&&a.window.document.documentElement.style;function F(n){if(!D)return n[0];for(var s=0;s<n.length;s++)if(n[s]in D)return n[s];return n[0]}var L,R=F(["userSelect","MozUserSelect","WebkitUserSelect","msUserSelect"]);E.disableDrag=function(){D&&R&&(L=D[R],D[R]="none")},E.enableDrag=function(){D&&R&&(D[R]=L)};var X=F(["transform","WebkitTransform"]);E.setTransform=function(n,s){n.style[X]=s};var ne=!1;try{var pe=Object.defineProperty({},"passive",{get:function(){ne=!0}});a.window.addEventListener("test",pe,pe),a.window.removeEventListener("test",pe,pe)}catch{ne=!1}E.addEventListener=function(n,s,o,c){c===void 0&&(c={}),n.addEventListener(s,o,"passive"in c&&ne?c:c.capture)},E.removeEventListener=function(n,s,o,c){c===void 0&&(c={}),n.removeEventListener(s,o,"passive"in c&&ne?c:c.capture)};var ve=function(n){n.preventDefault(),n.stopPropagation(),a.window.removeEventListener("click",ve,!0)};function de(n){var s=n.userImage;return!!(s&&s.render&&s.render())&&(n.data.replace(new Uint8Array(s.data.buffer)),!0)}E.suppressClick=function(){a.window.addEventListener("click",ve,!0),a.window.setTimeout(function(){a.window.removeEventListener("click",ve,!0)},0)},E.mousePos=function(n,s){var o=n.getBoundingClientRect();return new a.Point(s.clientX-o.left-n.clientLeft,s.clientY-o.top-n.clientTop)},E.touchPos=function(n,s){for(var o=n.getBoundingClientRect(),c=[],v=0;v<s.length;v++)c.push(new a.Point(s[v].clientX-o.left-n.clientLeft,s[v].clientY-o.top-n.clientTop));return c},E.mouseButton=function(n){return a.window.InstallTrigger!==void 0&&n.button===2&&n.ctrlKey&&a.window.navigator.platform.toUpperCase().indexOf("MAC")>=0?0:n.button},E.remove=function(n){n.parentNode&&n.parentNode.removeChild(n)};var xe=function(n){function s(){n.call(this),this.images={},this.updatedImages={},this.callbackDispatchedThisFrame={},this.loaded=!1,this.requestors=[],this.patterns={},this.atlasImage=new a.RGBAImage({width:1,height:1}),this.dirty=!0}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype.isLoaded=function(){return this.loaded},s.prototype.setLoaded=function(o){if(this.loaded!==o&&(this.loaded=o,o)){for(var c=0,v=this.requestors;c<v.length;c+=1){var w=v[c];this._notify(w.ids,w.callback)}this.requestors=[]}},s.prototype.getImage=function(o){return this.images[o]},s.prototype.addImage=function(o,c){this._validate(o,c)&&(this.images[o]=c)},s.prototype._validate=function(o,c){var v=!0;return this._validateStretch(c.stretchX,c.data&&c.data.width)||(this.fire(new a.ErrorEvent(new Error('Image "'+o+'" has invalid "stretchX" value'))),v=!1),this._validateStretch(c.stretchY,c.data&&c.data.height)||(this.fire(new a.ErrorEvent(new Error('Image "'+o+'" has invalid "stretchY" value'))),v=!1),this._validateContent(c.content,c)||(this.fire(new a.ErrorEvent(new Error('Image "'+o+'" has invalid "content" value'))),v=!1),v},s.prototype._validateStretch=function(o,c){if(!o)return!0;for(var v=0,w=0,S=o;w<S.length;w+=1){var z=S[w];if(z[0]<v||z[1]<z[0]||c<z[1])return!1;v=z[1]}return!0},s.prototype._validateContent=function(o,c){return!(o&&(o.length!==4||o[0]<0||c.data.width<o[0]||o[1]<0||c.data.height<o[1]||o[2]<0||c.data.width<o[2]||o[3]<0||c.data.height<o[3]||o[2]<o[0]||o[3]<o[1]))},s.prototype.updateImage=function(o,c){c.version=this.images[o].version+1,this.images[o]=c,this.updatedImages[o]=!0},s.prototype.removeImage=function(o){var c=this.images[o];delete this.images[o],delete this.patterns[o],c.userImage&&c.userImage.onRemove&&c.userImage.onRemove()},s.prototype.listImages=function(){return Object.keys(this.images)},s.prototype.getImages=function(o,c){var v=!0;if(!this.isLoaded())for(var w=0,S=o;w<S.length;w+=1)this.images[S[w]]||(v=!1);this.isLoaded()||v?this._notify(o,c):this.requestors.push({ids:o,callback:c})},s.prototype._notify=function(o,c){for(var v={},w=0,S=o;w<S.length;w+=1){var z=S[w];this.images[z]||this.fire(new a.Event("styleimagemissing",{id:z}));var C=this.images[z];C?v[z]={data:C.data.clone(),pixelRatio:C.pixelRatio,sdf:C.sdf,version:C.version,stretchX:C.stretchX,stretchY:C.stretchY,content:C.content,hasRenderCallback:!!(C.userImage&&C.userImage.render)}:a.warnOnce('Image "'+z+'" could not be loaded. Please make sure you have added the image with map.addImage() or a "sprite" property in your style. You can provide missing images by listening for the "styleimagemissing" map event.')}c(null,v)},s.prototype.getPixelSize=function(){var o=this.atlasImage;return{width:o.width,height:o.height}},s.prototype.getPattern=function(o){var c=this.patterns[o],v=this.getImage(o);if(!v)return null;if(c&&c.position.version===v.version)return c.position;if(c)c.position.version=v.version;else{var w={w:v.data.width+2,h:v.data.height+2,x:0,y:0},S=new a.ImagePosition(w,v);this.patterns[o]={bin:w,position:S}}return this._updatePatternAtlas(),this.patterns[o].position},s.prototype.bind=function(o){var c=o.gl;this.atlasTexture?this.dirty&&(this.atlasTexture.update(this.atlasImage),this.dirty=!1):this.atlasTexture=new a.Texture(o,this.atlasImage,c.RGBA),this.atlasTexture.bind(c.LINEAR,c.CLAMP_TO_EDGE)},s.prototype._updatePatternAtlas=function(){var o=[];for(var c in this.patterns)o.push(this.patterns[c].bin);var v=a.potpack(o),w=v.w,S=v.h,z=this.atlasImage;for(var C in z.resize({width:w||1,height:S||1}),this.patterns){var O=this.patterns[C].bin,Z=O.x+1,G=O.y+1,H=this.images[C].data,re=H.width,ee=H.height;a.RGBAImage.copy(H,z,{x:0,y:0},{x:Z,y:G},{width:re,height:ee}),a.RGBAImage.copy(H,z,{x:0,y:ee-1},{x:Z,y:G-1},{width:re,height:1}),a.RGBAImage.copy(H,z,{x:0,y:0},{x:Z,y:G+ee},{width:re,height:1}),a.RGBAImage.copy(H,z,{x:re-1,y:0},{x:Z-1,y:G},{width:1,height:ee}),a.RGBAImage.copy(H,z,{x:0,y:0},{x:Z+re,y:G},{width:1,height:ee})}this.dirty=!0},s.prototype.beginFrame=function(){this.callbackDispatchedThisFrame={}},s.prototype.dispatchRenderCallbacks=function(o){for(var c=0,v=o;c<v.length;c+=1){var w=v[c];if(!this.callbackDispatchedThisFrame[w]){this.callbackDispatchedThisFrame[w]=!0;var S=this.images[w];de(S)&&this.updateImage(w,S)}}},s}(a.Evented),$e=We,ht=We,Pe=1e20;function We(n,s,o,c,v,w){this.fontSize=n||24,this.buffer=s===void 0?3:s,this.cutoff=c||.25,this.fontFamily=v||"sans-serif",this.fontWeight=w||"normal",this.radius=o||8;var S=this.size=this.fontSize+2*this.buffer;this.canvas=document.createElement("canvas"),this.canvas.width=this.canvas.height=S,this.ctx=this.canvas.getContext("2d"),this.ctx.font=this.fontWeight+" "+this.fontSize+"px "+this.fontFamily,this.ctx.textBaseline="middle",this.ctx.fillStyle="black",this.gridOuter=new Float64Array(S*S),this.gridInner=new Float64Array(S*S),this.f=new Float64Array(S),this.d=new Float64Array(S),this.z=new Float64Array(S+1),this.v=new Int16Array(S),this.middle=Math.round(S/2*(navigator.userAgent.indexOf("Gecko/")>=0?1.2:1))}function gt(n,s,o,c,v,w,S){for(var z=0;z<s;z++){for(var C=0;C<o;C++)c[C]=n[C*s+z];for(Ke(c,v,w,S,o),C=0;C<o;C++)n[C*s+z]=v[C]}for(C=0;C<o;C++){for(z=0;z<s;z++)c[z]=n[C*s+z];for(Ke(c,v,w,S,s),z=0;z<s;z++)n[C*s+z]=Math.sqrt(v[z])}}function Ke(n,s,o,c,v){o[0]=0,c[0]=-Pe,c[1]=+Pe;for(var w=1,S=0;w<v;w++){for(var z=(n[w]+w*w-(n[o[S]]+o[S]*o[S]))/(2*w-2*o[S]);z<=c[S];)S--,z=(n[w]+w*w-(n[o[S]]+o[S]*o[S]))/(2*w-2*o[S]);o[++S]=w,c[S]=z,c[S+1]=+Pe}for(w=0,S=0;w<v;w++){for(;c[S+1]<w;)S++;s[w]=(w-o[S])*(w-o[S])+n[o[S]]}}We.prototype.draw=function(n){this.ctx.clearRect(0,0,this.size,this.size),this.ctx.fillText(n,this.buffer,this.middle);for(var s=this.ctx.getImageData(0,0,this.size,this.size),o=new Uint8ClampedArray(this.size*this.size),c=0;c<this.size*this.size;c++){var v=s.data[4*c+3]/255;this.gridOuter[c]=v===1?0:v===0?Pe:Math.pow(Math.max(0,.5-v),2),this.gridInner[c]=v===1?Pe:v===0?0:Math.pow(Math.max(0,v-.5),2)}for(gt(this.gridOuter,this.size,this.size,this.f,this.d,this.v,this.z),gt(this.gridInner,this.size,this.size,this.f,this.d,this.v,this.z),c=0;c<this.size*this.size;c++)o[c]=Math.max(0,Math.min(255,Math.round(255-255*((this.gridOuter[c]-this.gridInner[c])/this.radius+this.cutoff))));return o},$e.default=ht;var dt=function(n,s){this.requestManager=n,this.localIdeographFontFamily=s,this.entries={}};dt.prototype.setURL=function(n){this.url=n},dt.prototype.getGlyphs=function(n,s){var o=this,c=[];for(var v in n)for(var w=0,S=n[v];w<S.length;w+=1)c.push({stack:v,id:S[w]});a.asyncAll(c,function(z,C){var O=z.stack,Z=z.id,G=o.entries[O];G||(G=o.entries[O]={glyphs:{},requests:{},ranges:{}});var H=G.glyphs[Z];if(H===void 0){if(H=o._tinySDF(G,O,Z))return G.glyphs[Z]=H,void C(null,{stack:O,id:Z,glyph:H});var re=Math.floor(Z/256);if(256*re>65535)C(new Error("glyphs > 65535 not supported"));else if(G.ranges[re])C(null,{stack:O,id:Z,glyph:H});else{var ee=G.requests[re];ee||(ee=G.requests[re]=[],dt.loadGlyphRange(O,re,o.url,o.requestManager,function(le,Y){if(Y){for(var se in Y)o._doesCharSupportLocalGlyph(+se)||(G.glyphs[+se]=Y[+se]);G.ranges[re]=!0}for(var fe=0,_e=ee;fe<_e.length;fe+=1)(0,_e[fe])(le,Y);delete G.requests[re]})),ee.push(function(le,Y){le?C(le):Y&&C(null,{stack:O,id:Z,glyph:Y[Z]||null})})}}else C(null,{stack:O,id:Z,glyph:H})},function(z,C){if(z)s(z);else if(C){for(var O={},Z=0,G=C;Z<G.length;Z+=1){var H=G[Z],re=H.stack,ee=H.id,le=H.glyph;(O[re]||(O[re]={}))[ee]=le&&{id:le.id,bitmap:le.bitmap.clone(),metrics:le.metrics}}s(null,O)}})},dt.prototype._doesCharSupportLocalGlyph=function(n){return!!this.localIdeographFontFamily&&(a.isChar["CJK Unified Ideographs"](n)||a.isChar["Hangul Syllables"](n)||a.isChar.Hiragana(n)||a.isChar.Katakana(n))},dt.prototype._tinySDF=function(n,s,o){var c=this.localIdeographFontFamily;if(c&&this._doesCharSupportLocalGlyph(o)){var v=n.tinySDF;if(!v){var w="400";/bold/i.test(s)?w="900":/medium/i.test(s)?w="500":/light/i.test(s)&&(w="200"),v=n.tinySDF=new dt.TinySDF(24,3,8,.25,c,w)}return{id:o,bitmap:new a.AlphaImage({width:30,height:30},v.draw(String.fromCharCode(o))),metrics:{width:24,height:24,left:0,top:-8,advance:24}}}},dt.loadGlyphRange=function(n,s,o,c,v){var w=256*s,S=w+255,z=c.transformRequest(c.normalizeGlyphsURL(o).replace("{fontstack}",n).replace("{range}",w+"-"+S),a.ResourceType.Glyphs);a.getArrayBuffer(z,function(C,O){if(C)v(C);else if(O){for(var Z={},G=0,H=a.parseGlyphPBF(O);G<H.length;G+=1){var re=H[G];Z[re.id]=re}v(null,Z)}})},dt.TinySDF=$e;var Ne=function(){this.specification=a.styleSpec.light.position};Ne.prototype.possiblyEvaluate=function(n,s){return a.sphericalToCartesian(n.expression.evaluate(s))},Ne.prototype.interpolate=function(n,s,o){return{x:a.number(n.x,s.x,o),y:a.number(n.y,s.y,o),z:a.number(n.z,s.z,o)}};var at=new a.Properties({anchor:new a.DataConstantProperty(a.styleSpec.light.anchor),position:new Ne,color:new a.DataConstantProperty(a.styleSpec.light.color),intensity:new a.DataConstantProperty(a.styleSpec.light.intensity)}),Vt=function(n){function s(o){n.call(this),this._transitionable=new a.Transitionable(at),this.setLight(o),this._transitioning=this._transitionable.untransitioned()}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype.getLight=function(){return this._transitionable.serialize()},s.prototype.setLight=function(o,c){if(c===void 0&&(c={}),!this._validate(a.validateLight,o,c))for(var v in o){var w=o[v];a.endsWith(v,"-transition")?this._transitionable.setTransition(v.slice(0,-11),w):this._transitionable.setValue(v,w)}},s.prototype.updateTransitions=function(o){this._transitioning=this._transitionable.transitioned(o,this._transitioning)},s.prototype.hasTransition=function(){return this._transitioning.hasTransition()},s.prototype.recalculate=function(o){this.properties=this._transitioning.possiblyEvaluate(o)},s.prototype._validate=function(o,c,v){return(!v||v.validate!==!1)&&a.emitValidationErrors(this,o.call(a.validateStyle,a.extend({value:c,style:{glyphs:!0,sprite:!0},styleSpec:a.styleSpec})))},s}(a.Evented),st=function(n,s){this.width=n,this.height=s,this.nextRow=0,this.data=new Uint8Array(this.width*this.height),this.dashEntry={}};st.prototype.getDash=function(n,s){var o=n.join(",")+String(s);return this.dashEntry[o]||(this.dashEntry[o]=this.addDash(n,s)),this.dashEntry[o]},st.prototype.getDashRanges=function(n,s,o){var c=[],v=n.length%2==1?-n[n.length-1]*o:0,w=n[0]*o,S=!0;c.push({left:v,right:w,isDash:S,zeroLength:n[0]===0});for(var z=n[0],C=1;C<n.length;C++){var O=n[C];c.push({left:v=z*o,right:w=(z+=O)*o,isDash:S=!S,zeroLength:O===0})}return c},st.prototype.addRoundDash=function(n,s,o){for(var c=s/2,v=-o;v<=o;v++)for(var w=this.width*(this.nextRow+o+v),S=0,z=n[S],C=0;C<this.width;C++){C/z.right>1&&(z=n[++S]);var O=Math.abs(C-z.left),Z=Math.abs(C-z.right),G=Math.min(O,Z),H=void 0,re=v/o*(c+1);if(z.isDash){var ee=c-Math.abs(re);H=Math.sqrt(G*G+ee*ee)}else H=c-Math.sqrt(G*G+re*re);this.data[w+C]=Math.max(0,Math.min(255,H+128))}},st.prototype.addRegularDash=function(n){for(var s=n.length-1;s>=0;--s){var o=n[s],c=n[s+1];o.zeroLength?n.splice(s,1):c&&c.isDash===o.isDash&&(c.left=o.left,n.splice(s,1))}var v=n[0],w=n[n.length-1];v.isDash===w.isDash&&(v.left=w.left-this.width,w.right=v.right+this.width);for(var S=this.width*this.nextRow,z=0,C=n[z],O=0;O<this.width;O++){O/C.right>1&&(C=n[++z]);var Z=Math.abs(O-C.left),G=Math.abs(O-C.right),H=Math.min(Z,G);this.data[S+O]=Math.max(0,Math.min(255,(C.isDash?H:-H)+128))}},st.prototype.addDash=function(n,s){var o=s?7:0,c=2*o+1;if(this.nextRow+c>this.height)return a.warnOnce("LineAtlas out of space"),null;for(var v=0,w=0;w<n.length;w++)v+=n[w];if(v!==0){var S=this.width/v,z=this.getDashRanges(n,this.width,S);s?this.addRoundDash(z,S,o):this.addRegularDash(z)}var C={y:(this.nextRow+o+.5)/this.height,height:2*o/this.height,width:v};return this.nextRow+=c,this.dirty=!0,C},st.prototype.bind=function(n){var s=n.gl;this.texture?(s.bindTexture(s.TEXTURE_2D,this.texture),this.dirty&&(this.dirty=!1,s.texSubImage2D(s.TEXTURE_2D,0,0,0,this.width,this.height,s.ALPHA,s.UNSIGNED_BYTE,this.data))):(this.texture=s.createTexture(),s.bindTexture(s.TEXTURE_2D,this.texture),s.texParameteri(s.TEXTURE_2D,s.TEXTURE_WRAP_S,s.REPEAT),s.texParameteri(s.TEXTURE_2D,s.TEXTURE_WRAP_T,s.REPEAT),s.texParameteri(s.TEXTURE_2D,s.TEXTURE_MIN_FILTER,s.LINEAR),s.texParameteri(s.TEXTURE_2D,s.TEXTURE_MAG_FILTER,s.LINEAR),s.texImage2D(s.TEXTURE_2D,0,s.ALPHA,this.width,this.height,0,s.ALPHA,s.UNSIGNED_BYTE,this.data))};var At=function n(s,o){this.workerPool=s,this.actors=[],this.currentActor=0,this.id=a.uniqueId();for(var c=this.workerPool.acquire(this.id),v=0;v<c.length;v++){var w=new n.Actor(c[v],o,this.id);w.name="Worker "+v,this.actors.push(w)}};function Fe(n,s,o){var c=function(v,w){if(v)return o(v);if(w){var S=a.pick(a.extend(w,n),["tiles","minzoom","maxzoom","attribution","mapbox_logo","bounds","scheme","tileSize","encoding"]);w.vector_layers&&(S.vectorLayers=w.vector_layers,S.vectorLayerIds=S.vectorLayers.map(function(z){return z.id})),S.tiles=s.canonicalizeTileset(S,n.url),o(null,S)}};return n.url?a.getJSON(s.transformRequest(s.normalizeSourceURL(n.url),a.ResourceType.Source),c):a.browser.frame(function(){return c(null,n)})}At.prototype.broadcast=function(n,s,o){a.asyncAll(this.actors,function(c,v){c.send(n,s,v)},o=o||function(){})},At.prototype.getActor=function(){return this.currentActor=(this.currentActor+1)%this.actors.length,this.actors[this.currentActor]},At.prototype.remove=function(){this.actors.forEach(function(n){n.remove()}),this.actors=[],this.workerPool.release(this.id)},At.Actor=a.Actor;var qt=function(n,s,o){this.bounds=a.LngLatBounds.convert(this.validateBounds(n)),this.minzoom=s||0,this.maxzoom=o||24};qt.prototype.validateBounds=function(n){return Array.isArray(n)&&n.length===4?[Math.max(-180,n[0]),Math.max(-90,n[1]),Math.min(180,n[2]),Math.min(90,n[3])]:[-180,-90,180,90]},qt.prototype.contains=function(n){var s=Math.pow(2,n.z),o=Math.floor(a.mercatorXfromLng(this.bounds.getWest())*s),c=Math.floor(a.mercatorYfromLat(this.bounds.getNorth())*s),v=Math.ceil(a.mercatorXfromLng(this.bounds.getEast())*s),w=Math.ceil(a.mercatorYfromLat(this.bounds.getSouth())*s);return n.x>=o&&n.x<v&&n.y>=c&&n.y<w};var St=function(n){function s(o,c,v,w){if(n.call(this),this.id=o,this.dispatcher=v,this.type="vector",this.minzoom=0,this.maxzoom=22,this.scheme="xyz",this.tileSize=512,this.reparseOverscaled=!0,this.isTileClipped=!0,this._loaded=!1,a.extend(this,a.pick(c,["url","scheme","tileSize","promoteId"])),this._options=a.extend({type:"vector"},c),this._collectResourceTiming=c.collectResourceTiming,this.tileSize!==512)throw new Error("vector tile sources must have a tileSize of 512");this.setEventedParent(w)}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype.load=function(){var o=this;this._loaded=!1,this.fire(new a.Event("dataloading",{dataType:"source"})),this._tileJSONRequest=Fe(this._options,this.map._requestManager,function(c,v){o._tileJSONRequest=null,o._loaded=!0,c?o.fire(new a.ErrorEvent(c)):v&&(a.extend(o,v),v.bounds&&(o.tileBounds=new qt(v.bounds,o.minzoom,o.maxzoom)),a.postTurnstileEvent(v.tiles,o.map._requestManager._customAccessToken),a.postMapLoadEvent(v.tiles,o.map._getMapId(),o.map._requestManager._skuToken,o.map._requestManager._customAccessToken),o.fire(new a.Event("data",{dataType:"source",sourceDataType:"metadata"})),o.fire(new a.Event("data",{dataType:"source",sourceDataType:"content"})))})},s.prototype.loaded=function(){return this._loaded},s.prototype.hasTile=function(o){return!this.tileBounds||this.tileBounds.contains(o.canonical)},s.prototype.onAdd=function(o){this.map=o,this.load()},s.prototype.setSourceProperty=function(o){this._tileJSONRequest&&this._tileJSONRequest.cancel(),o(),this.map.style.sourceCaches[this.id].clearTiles(),this.load()},s.prototype.setTiles=function(o){var c=this;return this.setSourceProperty(function(){c._options.tiles=o}),this},s.prototype.setUrl=function(o){var c=this;return this.setSourceProperty(function(){c.url=o,c._options.url=o}),this},s.prototype.onRemove=function(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)},s.prototype.serialize=function(){return a.extend({},this._options)},s.prototype.loadTile=function(o,c){var v=this.map._requestManager.normalizeTileURL(o.tileID.canonical.url(this.tiles,this.scheme)),w={request:this.map._requestManager.transformRequest(v,a.ResourceType.Tile),uid:o.uid,tileID:o.tileID,zoom:o.tileID.overscaledZ,tileSize:this.tileSize*o.tileID.overscaleFactor(),type:this.type,source:this.id,pixelRatio:a.browser.devicePixelRatio,showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId};function S(z,C){return delete o.request,o.aborted?c(null):z&&z.status!==404?c(z):(C&&C.resourceTiming&&(o.resourceTiming=C.resourceTiming),this.map._refreshExpiredTiles&&C&&o.setExpiryData(C),o.loadVectorData(C,this.map.painter),a.cacheEntryPossiblyAdded(this.dispatcher),c(null),void(o.reloadCallback&&(this.loadTile(o,o.reloadCallback),o.reloadCallback=null)))}w.request.collectResourceTiming=this._collectResourceTiming,o.actor&&o.state!=="expired"?o.state==="loading"?o.reloadCallback=c:o.request=o.actor.send("reloadTile",w,S.bind(this)):(o.actor=this.dispatcher.getActor(),o.request=o.actor.send("loadTile",w,S.bind(this)))},s.prototype.abortTile=function(o){o.request&&(o.request.cancel(),delete o.request),o.actor&&o.actor.send("abortTile",{uid:o.uid,type:this.type,source:this.id},void 0)},s.prototype.unloadTile=function(o){o.unloadVectorData(),o.actor&&o.actor.send("removeTile",{uid:o.uid,type:this.type,source:this.id},void 0)},s.prototype.hasTransition=function(){return!1},s}(a.Evented),Ir=function(n){function s(o,c,v,w){n.call(this),this.id=o,this.dispatcher=v,this.setEventedParent(w),this.type="raster",this.minzoom=0,this.maxzoom=22,this.roundZoom=!0,this.scheme="xyz",this.tileSize=512,this._loaded=!1,this._options=a.extend({type:"raster"},c),a.extend(this,a.pick(c,["url","scheme","tileSize"]))}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype.load=function(){var o=this;this._loaded=!1,this.fire(new a.Event("dataloading",{dataType:"source"})),this._tileJSONRequest=Fe(this._options,this.map._requestManager,function(c,v){o._tileJSONRequest=null,o._loaded=!0,c?o.fire(new a.ErrorEvent(c)):v&&(a.extend(o,v),v.bounds&&(o.tileBounds=new qt(v.bounds,o.minzoom,o.maxzoom)),a.postTurnstileEvent(v.tiles),a.postMapLoadEvent(v.tiles,o.map._getMapId(),o.map._requestManager._skuToken),o.fire(new a.Event("data",{dataType:"source",sourceDataType:"metadata"})),o.fire(new a.Event("data",{dataType:"source",sourceDataType:"content"})))})},s.prototype.loaded=function(){return this._loaded},s.prototype.onAdd=function(o){this.map=o,this.load()},s.prototype.onRemove=function(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)},s.prototype.serialize=function(){return a.extend({},this._options)},s.prototype.hasTile=function(o){return!this.tileBounds||this.tileBounds.contains(o.canonical)},s.prototype.loadTile=function(o,c){var v=this,w=this.map._requestManager.normalizeTileURL(o.tileID.canonical.url(this.tiles,this.scheme),this.tileSize);o.request=a.getImage(this.map._requestManager.transformRequest(w,a.ResourceType.Tile),function(S,z){if(delete o.request,o.aborted)o.state="unloaded",c(null);else if(S)o.state="errored",c(S);else if(z){v.map._refreshExpiredTiles&&o.setExpiryData(z),delete z.cacheControl,delete z.expires;var C=v.map.painter.context,O=C.gl;o.texture=v.map.painter.getTileTexture(z.width),o.texture?o.texture.update(z,{useMipmap:!0}):(o.texture=new a.Texture(C,z,O.RGBA,{useMipmap:!0}),o.texture.bind(O.LINEAR,O.CLAMP_TO_EDGE,O.LINEAR_MIPMAP_NEAREST),C.extTextureFilterAnisotropic&&O.texParameterf(O.TEXTURE_2D,C.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,C.extTextureFilterAnisotropicMax)),o.state="loaded",a.cacheEntryPossiblyAdded(v.dispatcher),c(null)}})},s.prototype.abortTile=function(o,c){o.request&&(o.request.cancel(),delete o.request),c()},s.prototype.unloadTile=function(o,c){o.texture&&this.map.painter.saveTileTexture(o.texture),c()},s.prototype.hasTransition=function(){return!1},s}(a.Evented),_t=function(n){function s(o,c,v,w){n.call(this,o,c,v,w),this.type="raster-dem",this.maxzoom=22,this._options=a.extend({type:"raster-dem"},c),this.encoding=c.encoding||"mapbox"}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype.serialize=function(){return{type:"raster-dem",url:this.url,tileSize:this.tileSize,tiles:this.tiles,bounds:this.bounds,encoding:this.encoding}},s.prototype.loadTile=function(o,c){var v=this.map._requestManager.normalizeTileURL(o.tileID.canonical.url(this.tiles,this.scheme),this.tileSize);function w(S,z){S&&(o.state="errored",c(S)),z&&(o.dem=z,o.needsHillshadePrepare=!0,o.state="loaded",c(null))}o.request=a.getImage(this.map._requestManager.transformRequest(v,a.ResourceType.Tile),(function(S,z){if(delete o.request,o.aborted)o.state="unloaded",c(null);else if(S)o.state="errored",c(S);else if(z){this.map._refreshExpiredTiles&&o.setExpiryData(z),delete z.cacheControl,delete z.expires;var C=a.window.ImageBitmap&&z instanceof a.window.ImageBitmap&&a.offscreenCanvasSupported()?z:a.browser.getImageData(z,1),O={uid:o.uid,coord:o.tileID,source:this.id,rawImageData:C,encoding:this.encoding};o.actor&&o.state!=="expired"||(o.actor=this.dispatcher.getActor(),o.actor.send("loadDEMTile",O,w.bind(this)))}}).bind(this)),o.neighboringTiles=this._getNeighboringTiles(o.tileID)},s.prototype._getNeighboringTiles=function(o){var c=o.canonical,v=Math.pow(2,c.z),w=(c.x-1+v)%v,S=c.x===0?o.wrap-1:o.wrap,z=(c.x+1+v)%v,C=c.x+1===v?o.wrap+1:o.wrap,O={};return O[new a.OverscaledTileID(o.overscaledZ,S,c.z,w,c.y).key]={backfilled:!1},O[new a.OverscaledTileID(o.overscaledZ,C,c.z,z,c.y).key]={backfilled:!1},c.y>0&&(O[new a.OverscaledTileID(o.overscaledZ,S,c.z,w,c.y-1).key]={backfilled:!1},O[new a.OverscaledTileID(o.overscaledZ,o.wrap,c.z,c.x,c.y-1).key]={backfilled:!1},O[new a.OverscaledTileID(o.overscaledZ,C,c.z,z,c.y-1).key]={backfilled:!1}),c.y+1<v&&(O[new a.OverscaledTileID(o.overscaledZ,S,c.z,w,c.y+1).key]={backfilled:!1},O[new a.OverscaledTileID(o.overscaledZ,o.wrap,c.z,c.x,c.y+1).key]={backfilled:!1},O[new a.OverscaledTileID(o.overscaledZ,C,c.z,z,c.y+1).key]={backfilled:!1}),O},s.prototype.unloadTile=function(o){o.demTexture&&this.map.painter.saveTileTexture(o.demTexture),o.fbo&&(o.fbo.destroy(),delete o.fbo),o.dem&&delete o.dem,delete o.neighboringTiles,o.state="unloaded",o.actor&&o.actor.send("removeDEMTile",{uid:o.uid,source:this.id})},s}(Ir),xt=function(n){function s(o,c,v,w){n.call(this),this.id=o,this.type="geojson",this.minzoom=0,this.maxzoom=18,this.tileSize=512,this.isTileClipped=!0,this.reparseOverscaled=!0,this._removed=!1,this._loaded=!1,this.actor=v.getActor(),this.setEventedParent(w),this._data=c.data,this._options=a.extend({},c),this._collectResourceTiming=c.collectResourceTiming,this._resourceTiming=[],c.maxzoom!==void 0&&(this.maxzoom=c.maxzoom),c.type&&(this.type=c.type),c.attribution&&(this.attribution=c.attribution),this.promoteId=c.promoteId;var S=a.EXTENT/this.tileSize;this.workerOptions=a.extend({source:this.id,cluster:c.cluster||!1,geojsonVtOptions:{buffer:(c.buffer!==void 0?c.buffer:128)*S,tolerance:(c.tolerance!==void 0?c.tolerance:.375)*S,extent:a.EXTENT,maxZoom:this.maxzoom,lineMetrics:c.lineMetrics||!1,generateId:c.generateId||!1},superclusterOptions:{maxZoom:c.clusterMaxZoom!==void 0?Math.min(c.clusterMaxZoom,this.maxzoom-1):this.maxzoom-1,minPoints:Math.max(2,c.clusterMinPoints||2),extent:a.EXTENT,radius:(c.clusterRadius||50)*S,log:!1,generateId:c.generateId||!1},clusterProperties:c.clusterProperties,filter:c.filter},c.workerOptions)}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype.load=function(){var o=this;this.fire(new a.Event("dataloading",{dataType:"source"})),this._updateWorkerData(function(c){if(c)o.fire(new a.ErrorEvent(c));else{var v={dataType:"source",sourceDataType:"metadata"};o._collectResourceTiming&&o._resourceTiming&&o._resourceTiming.length>0&&(v.resourceTiming=o._resourceTiming,o._resourceTiming=[]),o.fire(new a.Event("data",v))}})},s.prototype.onAdd=function(o){this.map=o,this.load()},s.prototype.setData=function(o){var c=this;return this._data=o,this.fire(new a.Event("dataloading",{dataType:"source"})),this._updateWorkerData(function(v){if(v)c.fire(new a.ErrorEvent(v));else{var w={dataType:"source",sourceDataType:"content"};c._collectResourceTiming&&c._resourceTiming&&c._resourceTiming.length>0&&(w.resourceTiming=c._resourceTiming,c._resourceTiming=[]),c.fire(new a.Event("data",w))}}),this},s.prototype.getClusterExpansionZoom=function(o,c){return this.actor.send("geojson.getClusterExpansionZoom",{clusterId:o,source:this.id},c),this},s.prototype.getClusterChildren=function(o,c){return this.actor.send("geojson.getClusterChildren",{clusterId:o,source:this.id},c),this},s.prototype.getClusterLeaves=function(o,c,v,w){return this.actor.send("geojson.getClusterLeaves",{source:this.id,clusterId:o,limit:c,offset:v},w),this},s.prototype._updateWorkerData=function(o){var c=this;this._loaded=!1;var v=a.extend({},this.workerOptions),w=this._data;typeof w=="string"?(v.request=this.map._requestManager.transformRequest(a.browser.resolveURL(w),a.ResourceType.Source),v.request.collectResourceTiming=this._collectResourceTiming):v.data=JSON.stringify(w),this.actor.send(this.type+".loadData",v,function(S,z){c._removed||z&&z.abandoned||(c._loaded=!0,z&&z.resourceTiming&&z.resourceTiming[c.id]&&(c._resourceTiming=z.resourceTiming[c.id].slice(0)),c.actor.send(c.type+".coalesce",{source:v.source},null),o(S))})},s.prototype.loaded=function(){return this._loaded},s.prototype.loadTile=function(o,c){var v=this,w=o.actor?"reloadTile":"loadTile";o.actor=this.actor,o.request=this.actor.send(w,{type:this.type,uid:o.uid,tileID:o.tileID,zoom:o.tileID.overscaledZ,maxZoom:this.maxzoom,tileSize:this.tileSize,source:this.id,pixelRatio:a.browser.devicePixelRatio,showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId},function(S,z){return delete o.request,o.unloadVectorData(),o.aborted?c(null):S?c(S):(o.loadVectorData(z,v.map.painter,w==="reloadTile"),c(null))})},s.prototype.abortTile=function(o){o.request&&(o.request.cancel(),delete o.request),o.aborted=!0},s.prototype.unloadTile=function(o){o.unloadVectorData(),this.actor.send("removeTile",{uid:o.uid,type:this.type,source:this.id})},s.prototype.onRemove=function(){this._removed=!0,this.actor.send("removeSource",{type:this.type,source:this.id})},s.prototype.serialize=function(){return a.extend({},this._options,{type:this.type,data:this._data})},s.prototype.hasTransition=function(){return!1},s}(a.Evented),Re=a.createLayout([{name:"a_pos",type:"Int16",components:2},{name:"a_texture_pos",type:"Int16",components:2}]),Dt=function(n){function s(o,c,v,w){n.call(this),this.id=o,this.dispatcher=v,this.coordinates=c.coordinates,this.type="image",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this.tiles={},this._loaded=!1,this.setEventedParent(w),this.options=c}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype.load=function(o,c){var v=this;this._loaded=!1,this.fire(new a.Event("dataloading",{dataType:"source"})),this.url=this.options.url,a.getImage(this.map._requestManager.transformRequest(this.url,a.ResourceType.Image),function(w,S){v._loaded=!0,w?v.fire(new a.ErrorEvent(w)):S&&(v.image=S,o&&(v.coordinates=o),c&&c(),v._finishLoading())})},s.prototype.loaded=function(){return this._loaded},s.prototype.updateImage=function(o){var c=this;return this.image&&o.url?(this.options.url=o.url,this.load(o.coordinates,function(){c.texture=null}),this):this},s.prototype._finishLoading=function(){this.map&&(this.setCoordinates(this.coordinates),this.fire(new a.Event("data",{dataType:"source",sourceDataType:"metadata"})))},s.prototype.onAdd=function(o){this.map=o,this.load()},s.prototype.setCoordinates=function(o){var c=this;this.coordinates=o;var v=o.map(a.MercatorCoordinate.fromLngLat);this.tileID=function(S){for(var z=1/0,C=1/0,O=-1/0,Z=-1/0,G=0,H=S;G<H.length;G+=1){var re=H[G];z=Math.min(z,re.x),C=Math.min(C,re.y),O=Math.max(O,re.x),Z=Math.max(Z,re.y)}var ee=Math.max(O-z,Z-C),le=Math.max(0,Math.floor(-Math.log(ee)/Math.LN2)),Y=Math.pow(2,le);return new a.CanonicalTileID(le,Math.floor((z+O)/2*Y),Math.floor((C+Z)/2*Y))}(v),this.minzoom=this.maxzoom=this.tileID.z;var w=v.map(function(S){return c.tileID.getTilePoint(S)._round()});return this._boundsArray=new a.StructArrayLayout4i8,this._boundsArray.emplaceBack(w[0].x,w[0].y,0,0),this._boundsArray.emplaceBack(w[1].x,w[1].y,a.EXTENT,0),this._boundsArray.emplaceBack(w[3].x,w[3].y,0,a.EXTENT),this._boundsArray.emplaceBack(w[2].x,w[2].y,a.EXTENT,a.EXTENT),this.boundsBuffer&&(this.boundsBuffer.destroy(),delete this.boundsBuffer),this.fire(new a.Event("data",{dataType:"source",sourceDataType:"content"})),this},s.prototype.prepare=function(){if(Object.keys(this.tiles).length!==0&&this.image){var o=this.map.painter.context,c=o.gl;for(var v in this.boundsBuffer||(this.boundsBuffer=o.createVertexBuffer(this._boundsArray,Re.members)),this.boundsSegments||(this.boundsSegments=a.SegmentVector.simpleSegment(0,0,4,2)),this.texture||(this.texture=new a.Texture(o,this.image,c.RGBA),this.texture.bind(c.LINEAR,c.CLAMP_TO_EDGE)),this.tiles){var w=this.tiles[v];w.state!=="loaded"&&(w.state="loaded",w.texture=this.texture)}}},s.prototype.loadTile=function(o,c){this.tileID&&this.tileID.equals(o.tileID.canonical)?(this.tiles[String(o.tileID.wrap)]=o,o.buckets={},c(null)):(o.state="errored",c(null))},s.prototype.serialize=function(){return{type:"image",url:this.options.url,coordinates:this.coordinates}},s.prototype.hasTransition=function(){return!1},s}(a.Evented),Rr=function(n){function s(o,c,v,w){n.call(this,o,c,v,w),this.roundZoom=!0,this.type="video",this.options=c}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype.load=function(){var o=this;this._loaded=!1;var c=this.options;this.urls=[];for(var v=0,w=c.urls;v<w.length;v+=1)this.urls.push(this.map._requestManager.transformRequest(w[v],a.ResourceType.Source).url);a.getVideo(this.urls,function(S,z){o._loaded=!0,S?o.fire(new a.ErrorEvent(S)):z&&(o.video=z,o.video.loop=!0,o.video.addEventListener("playing",function(){o.map.triggerRepaint()}),o.map&&o.video.play(),o._finishLoading())})},s.prototype.pause=function(){this.video&&this.video.pause()},s.prototype.play=function(){this.video&&this.video.play()},s.prototype.seek=function(o){if(this.video){var c=this.video.seekable;o<c.start(0)||o>c.end(0)?this.fire(new a.ErrorEvent(new a.ValidationError("sources."+this.id,null,"Playback for this video can be set only between the "+c.start(0)+" and "+c.end(0)+"-second mark."))):this.video.currentTime=o}},s.prototype.getVideo=function(){return this.video},s.prototype.onAdd=function(o){this.map||(this.map=o,this.load(),this.video&&(this.video.play(),this.setCoordinates(this.coordinates)))},s.prototype.prepare=function(){if(!(Object.keys(this.tiles).length===0||this.video.readyState<2)){var o=this.map.painter.context,c=o.gl;for(var v in this.boundsBuffer||(this.boundsBuffer=o.createVertexBuffer(this._boundsArray,Re.members)),this.boundsSegments||(this.boundsSegments=a.SegmentVector.simpleSegment(0,0,4,2)),this.texture?this.video.paused||(this.texture.bind(c.LINEAR,c.CLAMP_TO_EDGE),c.texSubImage2D(c.TEXTURE_2D,0,0,0,c.RGBA,c.UNSIGNED_BYTE,this.video)):(this.texture=new a.Texture(o,this.video,c.RGBA),this.texture.bind(c.LINEAR,c.CLAMP_TO_EDGE)),this.tiles){var w=this.tiles[v];w.state!=="loaded"&&(w.state="loaded",w.texture=this.texture)}}},s.prototype.serialize=function(){return{type:"video",urls:this.urls,coordinates:this.coordinates}},s.prototype.hasTransition=function(){return this.video&&!this.video.paused},s}(Dt),xr=function(n){function s(o,c,v,w){n.call(this,o,c,v,w),c.coordinates?Array.isArray(c.coordinates)&&c.coordinates.length===4&&!c.coordinates.some(function(S){return!Array.isArray(S)||S.length!==2||S.some(function(z){return typeof z!="number"})})||this.fire(new a.ErrorEvent(new a.ValidationError("sources."+o,null,'"coordinates" property must be an array of 4 longitude/latitude array pairs'))):this.fire(new a.ErrorEvent(new a.ValidationError("sources."+o,null,'missing required property "coordinates"'))),c.animate&&typeof c.animate!="boolean"&&this.fire(new a.ErrorEvent(new a.ValidationError("sources."+o,null,'optional "animate" property must be a boolean value'))),c.canvas?typeof c.canvas=="string"||c.canvas instanceof a.window.HTMLCanvasElement||this.fire(new a.ErrorEvent(new a.ValidationError("sources."+o,null,'"canvas" must be either a string representing the ID of the canvas element from which to read, or an HTMLCanvasElement instance'))):this.fire(new a.ErrorEvent(new a.ValidationError("sources."+o,null,'missing required property "canvas"'))),this.options=c,this.animate=c.animate===void 0||c.animate}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype.load=function(){this._loaded=!0,this.canvas||(this.canvas=this.options.canvas instanceof a.window.HTMLCanvasElement?this.options.canvas:a.window.document.getElementById(this.options.canvas)),this.width=this.canvas.width,this.height=this.canvas.height,this._hasInvalidDimensions()?this.fire(new a.ErrorEvent(new Error("Canvas dimensions cannot be less than or equal to zero."))):(this.play=function(){this._playing=!0,this.map.triggerRepaint()},this.pause=function(){this._playing&&(this.prepare(),this._playing=!1)},this._finishLoading())},s.prototype.getCanvas=function(){return this.canvas},s.prototype.onAdd=function(o){this.map=o,this.load(),this.canvas&&this.animate&&this.play()},s.prototype.onRemove=function(){this.pause()},s.prototype.prepare=function(){var o=!1;if(this.canvas.width!==this.width&&(this.width=this.canvas.width,o=!0),this.canvas.height!==this.height&&(this.height=this.canvas.height,o=!0),!this._hasInvalidDimensions()&&Object.keys(this.tiles).length!==0){var c=this.map.painter.context,v=c.gl;for(var w in this.boundsBuffer||(this.boundsBuffer=c.createVertexBuffer(this._boundsArray,Re.members)),this.boundsSegments||(this.boundsSegments=a.SegmentVector.simpleSegment(0,0,4,2)),this.texture?(o||this._playing)&&this.texture.update(this.canvas,{premultiply:!0}):this.texture=new a.Texture(c,this.canvas,v.RGBA,{premultiply:!0}),this.tiles){var S=this.tiles[w];S.state!=="loaded"&&(S.state="loaded",S.texture=this.texture)}}},s.prototype.serialize=function(){return{type:"canvas",coordinates:this.coordinates}},s.prototype.hasTransition=function(){return this._playing},s.prototype._hasInvalidDimensions=function(){for(var o=0,c=[this.canvas.width,this.canvas.height];o<c.length;o+=1){var v=c[o];if(isNaN(v)||v<=0)return!0}return!1},s}(Dt),Vr={vector:St,raster:Ir,"raster-dem":_t,geojson:xt,video:Rr,image:Dt,canvas:xr};function Br(n,s){var o=a.identity([]);return a.translate(o,o,[1,1,0]),a.scale(o,o,[.5*n.width,.5*n.height,1]),a.multiply(o,o,n.calculatePosMatrix(s.toUnwrapped()))}function fr(n,s,o,c,v,w){var S=function(le,Y,se){if(le)for(var fe=0,_e=le;fe<_e.length;fe+=1){var Te=Y[_e[fe]];if(Te&&Te.source===se&&Te.type==="fill-extrusion")return!0}else for(var Se in Y){var Ae=Y[Se];if(Ae.source===se&&Ae.type==="fill-extrusion")return!0}return!1}(v&&v.layers,s,n.id),z=w.maxPitchScaleFactor(),C=n.tilesIn(c,z,S);C.sort(yi);for(var O=[],Z=0,G=C;Z<G.length;Z+=1){var H=G[Z];O.push({wrappedTileID:H.tileID.wrapped().key,queryResults:H.tile.queryRenderedFeatures(s,o,n._state,H.queryGeometry,H.cameraQueryGeometry,H.scale,v,w,z,Br(n.transform,H.tileID))})}var re=function(le){for(var Y={},se={},fe=0,_e=le;fe<_e.length;fe+=1){var Te=_e[fe],Se=Te.queryResults,Ae=Te.wrappedTileID,Oe=se[Ae]=se[Ae]||{};for(var He in Se)for(var Ze=Se[He],ct=Oe[He]=Oe[He]||{},Et=Y[He]=Y[He]||[],Ct=0,It=Ze;Ct<It.length;Ct+=1){var dr=It[Ct];ct[dr.featureIndex]||(ct[dr.featureIndex]=!0,Et.push(dr))}}return Y}(O);for(var ee in re)re[ee].forEach(function(le){var Y=le.feature,se=n.getFeatureState(Y.layer["source-layer"],Y.id);Y.source=Y.layer.source,Y.layer["source-layer"]&&(Y.sourceLayer=Y.layer["source-layer"]),Y.state=se});return re}function yi(n,s){var o=n.tileID,c=s.tileID;return o.overscaledZ-c.overscaledZ||o.canonical.y-c.canonical.y||o.wrap-c.wrap||o.canonical.x-c.canonical.x}var Jt=function(n,s){this.max=n,this.onRemove=s,this.reset()};Jt.prototype.reset=function(){for(var n in this.data)for(var s=0,o=this.data[n];s<o.length;s+=1){var c=o[s];c.timeout&&clearTimeout(c.timeout),this.onRemove(c.value)}return this.data={},this.order=[],this},Jt.prototype.add=function(n,s,o){var c=this,v=n.wrapped().key;this.data[v]===void 0&&(this.data[v]=[]);var w={value:s,timeout:void 0};if(o!==void 0&&(w.timeout=setTimeout(function(){c.remove(n,w)},o)),this.data[v].push(w),this.order.push(v),this.order.length>this.max){var S=this._getAndRemoveByKey(this.order[0]);S&&this.onRemove(S)}return this},Jt.prototype.has=function(n){return n.wrapped().key in this.data},Jt.prototype.getAndRemove=function(n){return this.has(n)?this._getAndRemoveByKey(n.wrapped().key):null},Jt.prototype._getAndRemoveByKey=function(n){var s=this.data[n].shift();return s.timeout&&clearTimeout(s.timeout),this.data[n].length===0&&delete this.data[n],this.order.splice(this.order.indexOf(n),1),s.value},Jt.prototype.getByKey=function(n){var s=this.data[n];return s?s[0].value:null},Jt.prototype.get=function(n){return this.has(n)?this.data[n.wrapped().key][0].value:null},Jt.prototype.remove=function(n,s){if(!this.has(n))return this;var o=n.wrapped().key,c=s===void 0?0:this.data[o].indexOf(s),v=this.data[o][c];return this.data[o].splice(c,1),v.timeout&&clearTimeout(v.timeout),this.data[o].length===0&&delete this.data[o],this.onRemove(v.value),this.order.splice(this.order.indexOf(o),1),this},Jt.prototype.setMaxSize=function(n){for(this.max=n;this.order.length>this.max;){var s=this._getAndRemoveByKey(this.order[0]);s&&this.onRemove(s)}return this},Jt.prototype.filter=function(n){var s=[];for(var o in this.data)for(var c=0,v=this.data[o];c<v.length;c+=1){var w=v[c];n(w.value)||s.push(w)}for(var S=0,z=s;S<z.length;S+=1){var C=z[S];this.remove(C.value.tileID,C)}};var rn=function(n,s,o){this.context=n;var c=n.gl;this.buffer=c.createBuffer(),this.dynamicDraw=!!o,this.context.unbindVAO(),n.bindElementBuffer.set(this.buffer),c.bufferData(c.ELEMENT_ARRAY_BUFFER,s.arrayBuffer,this.dynamicDraw?c.DYNAMIC_DRAW:c.STATIC_DRAW),this.dynamicDraw||delete s.arrayBuffer};rn.prototype.bind=function(){this.context.bindElementBuffer.set(this.buffer)},rn.prototype.updateData=function(n){var s=this.context.gl;this.context.unbindVAO(),this.bind(),s.bufferSubData(s.ELEMENT_ARRAY_BUFFER,0,n.arrayBuffer)},rn.prototype.destroy=function(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)};var Mi={Int8:"BYTE",Uint8:"UNSIGNED_BYTE",Int16:"SHORT",Uint16:"UNSIGNED_SHORT",Int32:"INT",Uint32:"UNSIGNED_INT",Float32:"FLOAT"},$r=function(n,s,o,c){this.length=s.length,this.attributes=o,this.itemSize=s.bytesPerElement,this.dynamicDraw=c,this.context=n;var v=n.gl;this.buffer=v.createBuffer(),n.bindVertexBuffer.set(this.buffer),v.bufferData(v.ARRAY_BUFFER,s.arrayBuffer,this.dynamicDraw?v.DYNAMIC_DRAW:v.STATIC_DRAW),this.dynamicDraw||delete s.arrayBuffer};$r.prototype.bind=function(){this.context.bindVertexBuffer.set(this.buffer)},$r.prototype.updateData=function(n){var s=this.context.gl;this.bind(),s.bufferSubData(s.ARRAY_BUFFER,0,n.arrayBuffer)},$r.prototype.enableAttributes=function(n,s){for(var o=0;o<this.attributes.length;o++){var c=s.attributes[this.attributes[o].name];c!==void 0&&n.enableVertexAttribArray(c)}},$r.prototype.setVertexAttribPointers=function(n,s,o){for(var c=0;c<this.attributes.length;c++){var v=this.attributes[c],w=s.attributes[v.name];w!==void 0&&n.vertexAttribPointer(w,v.components,n[Mi[v.type]],!1,this.itemSize,v.offset+this.itemSize*(o||0))}},$r.prototype.destroy=function(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)};var Gt=function(n){this.gl=n.gl,this.default=this.getDefault(),this.current=this.default,this.dirty=!1};Gt.prototype.get=function(){return this.current},Gt.prototype.set=function(n){},Gt.prototype.getDefault=function(){return this.default},Gt.prototype.setDefault=function(){this.set(this.default)};var yn=function(n){function s(){n.apply(this,arguments)}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype.getDefault=function(){return a.Color.transparent},s.prototype.set=function(o){var c=this.current;(o.r!==c.r||o.g!==c.g||o.b!==c.b||o.a!==c.a||this.dirty)&&(this.gl.clearColor(o.r,o.g,o.b,o.a),this.current=o,this.dirty=!1)},s}(Gt),Yr=function(n){function s(){n.apply(this,arguments)}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype.getDefault=function(){return 1},s.prototype.set=function(o){(o!==this.current||this.dirty)&&(this.gl.clearDepth(o),this.current=o,this.dirty=!1)},s}(Gt),li=function(n){function s(){n.apply(this,arguments)}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype.getDefault=function(){return 0},s.prototype.set=function(o){(o!==this.current||this.dirty)&&(this.gl.clearStencil(o),this.current=o,this.dirty=!1)},s}(Gt),nn=function(n){function s(){n.apply(this,arguments)}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype.getDefault=function(){return[!0,!0,!0,!0]},s.prototype.set=function(o){var c=this.current;(o[0]!==c[0]||o[1]!==c[1]||o[2]!==c[2]||o[3]!==c[3]||this.dirty)&&(this.gl.colorMask(o[0],o[1],o[2],o[3]),this.current=o,this.dirty=!1)},s}(Gt),Ui=function(n){function s(){n.apply(this,arguments)}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype.getDefault=function(){return!0},s.prototype.set=function(o){(o!==this.current||this.dirty)&&(this.gl.depthMask(o),this.current=o,this.dirty=!1)},s}(Gt),an=function(n){function s(){n.apply(this,arguments)}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype.getDefault=function(){return 255},s.prototype.set=function(o){(o!==this.current||this.dirty)&&(this.gl.stencilMask(o),this.current=o,this.dirty=!1)},s}(Gt),yr=function(n){function s(){n.apply(this,arguments)}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype.getDefault=function(){return{func:this.gl.ALWAYS,ref:0,mask:255}},s.prototype.set=function(o){var c=this.current;(o.func!==c.func||o.ref!==c.ref||o.mask!==c.mask||this.dirty)&&(this.gl.stencilFunc(o.func,o.ref,o.mask),this.current=o,this.dirty=!1)},s}(Gt),ui=function(n){function s(){n.apply(this,arguments)}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype.getDefault=function(){var o=this.gl;return[o.KEEP,o.KEEP,o.KEEP]},s.prototype.set=function(o){var c=this.current;(o[0]!==c[0]||o[1]!==c[1]||o[2]!==c[2]||this.dirty)&&(this.gl.stencilOp(o[0],o[1],o[2]),this.current=o,this.dirty=!1)},s}(Gt),on=function(n){function s(){n.apply(this,arguments)}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype.getDefault=function(){return!1},s.prototype.set=function(o){if(o!==this.current||this.dirty){var c=this.gl;o?c.enable(c.STENCIL_TEST):c.disable(c.STENCIL_TEST),this.current=o,this.dirty=!1}},s}(Gt),qr=function(n){function s(){n.apply(this,arguments)}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype.getDefault=function(){return[0,1]},s.prototype.set=function(o){var c=this.current;(o[0]!==c[0]||o[1]!==c[1]||this.dirty)&&(this.gl.depthRange(o[0],o[1]),this.current=o,this.dirty=!1)},s}(Gt),ci=function(n){function s(){n.apply(this,arguments)}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype.getDefault=function(){return!1},s.prototype.set=function(o){if(o!==this.current||this.dirty){var c=this.gl;o?c.enable(c.DEPTH_TEST):c.disable(c.DEPTH_TEST),this.current=o,this.dirty=!1}},s}(Gt),hi=function(n){function s(){n.apply(this,arguments)}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype.getDefault=function(){return this.gl.LESS},s.prototype.set=function(o){(o!==this.current||this.dirty)&&(this.gl.depthFunc(o),this.current=o,this.dirty=!1)},s}(Gt),gi=function(n){function s(){n.apply(this,arguments)}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype.getDefault=function(){return!1},s.prototype.set=function(o){if(o!==this.current||this.dirty){var c=this.gl;o?c.enable(c.BLEND):c.disable(c.BLEND),this.current=o,this.dirty=!1}},s}(Gt),Di=function(n){function s(){n.apply(this,arguments)}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype.getDefault=function(){var o=this.gl;return[o.ONE,o.ZERO]},s.prototype.set=function(o){var c=this.current;(o[0]!==c[0]||o[1]!==c[1]||this.dirty)&&(this.gl.blendFunc(o[0],o[1]),this.current=o,this.dirty=!1)},s}(Gt),Wn=function(n){function s(){n.apply(this,arguments)}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype.getDefault=function(){return a.Color.transparent},s.prototype.set=function(o){var c=this.current;(o.r!==c.r||o.g!==c.g||o.b!==c.b||o.a!==c.a||this.dirty)&&(this.gl.blendColor(o.r,o.g,o.b,o.a),this.current=o,this.dirty=!1)},s}(Gt),Vi=function(n){function s(){n.apply(this,arguments)}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype.getDefault=function(){return this.gl.FUNC_ADD},s.prototype.set=function(o){(o!==this.current||this.dirty)&&(this.gl.blendEquation(o),this.current=o,this.dirty=!1)},s}(Gt),Ln=function(n){function s(){n.apply(this,arguments)}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype.getDefault=function(){return!1},s.prototype.set=function(o){if(o!==this.current||this.dirty){var c=this.gl;o?c.enable(c.CULL_FACE):c.disable(c.CULL_FACE),this.current=o,this.dirty=!1}},s}(Gt),Li=function(n){function s(){n.apply(this,arguments)}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype.getDefault=function(){return this.gl.BACK},s.prototype.set=function(o){(o!==this.current||this.dirty)&&(this.gl.cullFace(o),this.current=o,this.dirty=!1)},s}(Gt),Ji=function(n){function s(){n.apply(this,arguments)}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype.getDefault=function(){return this.gl.CCW},s.prototype.set=function(o){(o!==this.current||this.dirty)&&(this.gl.frontFace(o),this.current=o,this.dirty=!1)},s}(Gt),Rn=function(n){function s(){n.apply(this,arguments)}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype.getDefault=function(){return null},s.prototype.set=function(o){(o!==this.current||this.dirty)&&(this.gl.useProgram(o),this.current=o,this.dirty=!1)},s}(Gt),Tn=function(n){function s(){n.apply(this,arguments)}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype.getDefault=function(){return this.gl.TEXTURE0},s.prototype.set=function(o){(o!==this.current||this.dirty)&&(this.gl.activeTexture(o),this.current=o,this.dirty=!1)},s}(Gt),ei=function(n){function s(){n.apply(this,arguments)}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype.getDefault=function(){var o=this.gl;return[0,0,o.drawingBufferWidth,o.drawingBufferHeight]},s.prototype.set=function(o){var c=this.current;(o[0]!==c[0]||o[1]!==c[1]||o[2]!==c[2]||o[3]!==c[3]||this.dirty)&&(this.gl.viewport(o[0],o[1],o[2],o[3]),this.current=o,this.dirty=!1)},s}(Gt),Yn=function(n){function s(){n.apply(this,arguments)}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype.getDefault=function(){return null},s.prototype.set=function(o){if(o!==this.current||this.dirty){var c=this.gl;c.bindFramebuffer(c.FRAMEBUFFER,o),this.current=o,this.dirty=!1}},s}(Gt),In=function(n){function s(){n.apply(this,arguments)}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype.getDefault=function(){return null},s.prototype.set=function(o){if(o!==this.current||this.dirty){var c=this.gl;c.bindRenderbuffer(c.RENDERBUFFER,o),this.current=o,this.dirty=!1}},s}(Gt),wi=function(n){function s(){n.apply(this,arguments)}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype.getDefault=function(){return null},s.prototype.set=function(o){if(o!==this.current||this.dirty){var c=this.gl;c.bindTexture(c.TEXTURE_2D,o),this.current=o,this.dirty=!1}},s}(Gt),ca=function(n){function s(){n.apply(this,arguments)}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype.getDefault=function(){return null},s.prototype.set=function(o){if(o!==this.current||this.dirty){var c=this.gl;c.bindBuffer(c.ARRAY_BUFFER,o),this.current=o,this.dirty=!1}},s}(Gt),An=function(n){function s(){n.apply(this,arguments)}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype.getDefault=function(){return null},s.prototype.set=function(o){var c=this.gl;c.bindBuffer(c.ELEMENT_ARRAY_BUFFER,o),this.current=o,this.dirty=!1},s}(Gt),Mr=function(n){function s(o){n.call(this,o),this.vao=o.extVertexArrayObject}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype.getDefault=function(){return null},s.prototype.set=function(o){this.vao&&(o!==this.current||this.dirty)&&(this.vao.bindVertexArrayOES(o),this.current=o,this.dirty=!1)},s}(Gt),sn=function(n){function s(){n.apply(this,arguments)}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype.getDefault=function(){return 4},s.prototype.set=function(o){if(o!==this.current||this.dirty){var c=this.gl;c.pixelStorei(c.UNPACK_ALIGNMENT,o),this.current=o,this.dirty=!1}},s}(Gt),gn=function(n){function s(){n.apply(this,arguments)}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype.getDefault=function(){return!1},s.prototype.set=function(o){if(o!==this.current||this.dirty){var c=this.gl;c.pixelStorei(c.UNPACK_PREMULTIPLY_ALPHA_WEBGL,o),this.current=o,this.dirty=!1}},s}(Gt),ti=function(n){function s(){n.apply(this,arguments)}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype.getDefault=function(){return!1},s.prototype.set=function(o){if(o!==this.current||this.dirty){var c=this.gl;c.pixelStorei(c.UNPACK_FLIP_Y_WEBGL,o),this.current=o,this.dirty=!1}},s}(Gt),te=function(n){function s(o,c){n.call(this,o),this.context=o,this.parent=c}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype.getDefault=function(){return null},s}(Gt),P=function(n){function s(){n.apply(this,arguments)}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype.setDirty=function(){this.dirty=!0},s.prototype.set=function(o){if(o!==this.current||this.dirty){this.context.bindFramebuffer.set(this.parent);var c=this.gl;c.framebufferTexture2D(c.FRAMEBUFFER,c.COLOR_ATTACHMENT0,c.TEXTURE_2D,o,0),this.current=o,this.dirty=!1}},s}(te),N=function(n){function s(){n.apply(this,arguments)}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype.set=function(o){if(o!==this.current||this.dirty){this.context.bindFramebuffer.set(this.parent);var c=this.gl;c.framebufferRenderbuffer(c.FRAMEBUFFER,c.DEPTH_ATTACHMENT,c.RENDERBUFFER,o),this.current=o,this.dirty=!1}},s}(te),V=function(n,s,o,c){this.context=n,this.width=s,this.height=o;var v=this.framebuffer=n.gl.createFramebuffer();this.colorAttachment=new P(n,v),c&&(this.depthAttachment=new N(n,v))};V.prototype.destroy=function(){var n=this.context.gl,s=this.colorAttachment.get();if(s&&n.deleteTexture(s),this.depthAttachment){var o=this.depthAttachment.get();o&&n.deleteRenderbuffer(o)}n.deleteFramebuffer(this.framebuffer)};var K=function(n,s,o){this.func=n,this.mask=s,this.range=o};K.ReadOnly=!1,K.ReadWrite=!0,K.disabled=new K(519,K.ReadOnly,[0,1]);var W=function(n,s,o,c,v,w){this.test=n,this.ref=s,this.mask=o,this.fail=c,this.depthFail=v,this.pass=w};W.disabled=new W({func:519,mask:0},0,0,7680,7680,7680);var ue=function(n,s,o){this.blendFunction=n,this.blendColor=s,this.mask=o};ue.disabled=new ue(ue.Replace=[1,0],a.Color.transparent,[!1,!1,!1,!1]),ue.unblended=new ue(ue.Replace,a.Color.transparent,[!0,!0,!0,!0]),ue.alphaBlended=new ue([1,771],a.Color.transparent,[!0,!0,!0,!0]);var he=function(n,s,o){this.enable=n,this.mode=s,this.frontFace=o};he.disabled=new he(!1,1029,2305),he.backCCW=new he(!0,1029,2305);var q=function(n){this.gl=n,this.extVertexArrayObject=this.gl.getExtension("OES_vertex_array_object"),this.clearColor=new yn(this),this.clearDepth=new Yr(this),this.clearStencil=new li(this),this.colorMask=new nn(this),this.depthMask=new Ui(this),this.stencilMask=new an(this),this.stencilFunc=new yr(this),this.stencilOp=new ui(this),this.stencilTest=new on(this),this.depthRange=new qr(this),this.depthTest=new ci(this),this.depthFunc=new hi(this),this.blend=new gi(this),this.blendFunc=new Di(this),this.blendColor=new Wn(this),this.blendEquation=new Vi(this),this.cullFace=new Ln(this),this.cullFaceSide=new Li(this),this.frontFace=new Ji(this),this.program=new Rn(this),this.activeTexture=new Tn(this),this.viewport=new ei(this),this.bindFramebuffer=new Yn(this),this.bindRenderbuffer=new In(this),this.bindTexture=new wi(this),this.bindVertexBuffer=new ca(this),this.bindElementBuffer=new An(this),this.bindVertexArrayOES=this.extVertexArrayObject&&new Mr(this),this.pixelStoreUnpack=new sn(this),this.pixelStoreUnpackPremultiplyAlpha=new gn(this),this.pixelStoreUnpackFlipY=new ti(this),this.extTextureFilterAnisotropic=n.getExtension("EXT_texture_filter_anisotropic")||n.getExtension("MOZ_EXT_texture_filter_anisotropic")||n.getExtension("WEBKIT_EXT_texture_filter_anisotropic"),this.extTextureFilterAnisotropic&&(this.extTextureFilterAnisotropicMax=n.getParameter(this.extTextureFilterAnisotropic.MAX_TEXTURE_MAX_ANISOTROPY_EXT)),this.extTextureHalfFloat=n.getExtension("OES_texture_half_float"),this.extTextureHalfFloat&&(n.getExtension("OES_texture_half_float_linear"),this.extRenderToTextureHalfFloat=n.getExtension("EXT_color_buffer_half_float")),this.extTimerQuery=n.getExtension("EXT_disjoint_timer_query"),this.maxTextureSize=n.getParameter(n.MAX_TEXTURE_SIZE)};q.prototype.setDefault=function(){this.unbindVAO(),this.clearColor.setDefault(),this.clearDepth.setDefault(),this.clearStencil.setDefault(),this.colorMask.setDefault(),this.depthMask.setDefault(),this.stencilMask.setDefault(),this.stencilFunc.setDefault(),this.stencilOp.setDefault(),this.stencilTest.setDefault(),this.depthRange.setDefault(),this.depthTest.setDefault(),this.depthFunc.setDefault(),this.blend.setDefault(),this.blendFunc.setDefault(),this.blendColor.setDefault(),this.blendEquation.setDefault(),this.cullFace.setDefault(),this.cullFaceSide.setDefault(),this.frontFace.setDefault(),this.program.setDefault(),this.activeTexture.setDefault(),this.bindFramebuffer.setDefault(),this.pixelStoreUnpack.setDefault(),this.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.pixelStoreUnpackFlipY.setDefault()},q.prototype.setDirty=function(){this.clearColor.dirty=!0,this.clearDepth.dirty=!0,this.clearStencil.dirty=!0,this.colorMask.dirty=!0,this.depthMask.dirty=!0,this.stencilMask.dirty=!0,this.stencilFunc.dirty=!0,this.stencilOp.dirty=!0,this.stencilTest.dirty=!0,this.depthRange.dirty=!0,this.depthTest.dirty=!0,this.depthFunc.dirty=!0,this.blend.dirty=!0,this.blendFunc.dirty=!0,this.blendColor.dirty=!0,this.blendEquation.dirty=!0,this.cullFace.dirty=!0,this.cullFaceSide.dirty=!0,this.frontFace.dirty=!0,this.program.dirty=!0,this.activeTexture.dirty=!0,this.viewport.dirty=!0,this.bindFramebuffer.dirty=!0,this.bindRenderbuffer.dirty=!0,this.bindTexture.dirty=!0,this.bindVertexBuffer.dirty=!0,this.bindElementBuffer.dirty=!0,this.extVertexArrayObject&&(this.bindVertexArrayOES.dirty=!0),this.pixelStoreUnpack.dirty=!0,this.pixelStoreUnpackPremultiplyAlpha.dirty=!0,this.pixelStoreUnpackFlipY.dirty=!0},q.prototype.createIndexBuffer=function(n,s){return new rn(this,n,s)},q.prototype.createVertexBuffer=function(n,s,o){return new $r(this,n,s,o)},q.prototype.createRenderbuffer=function(n,s,o){var c=this.gl,v=c.createRenderbuffer();return this.bindRenderbuffer.set(v),c.renderbufferStorage(c.RENDERBUFFER,n,s,o),this.bindRenderbuffer.set(null),v},q.prototype.createFramebuffer=function(n,s,o){return new V(this,n,s,o)},q.prototype.clear=function(n){var s=n.color,o=n.depth,c=this.gl,v=0;s&&(v|=c.COLOR_BUFFER_BIT,this.clearColor.set(s),this.colorMask.set([!0,!0,!0,!0])),o!==void 0&&(v|=c.DEPTH_BUFFER_BIT,this.depthRange.set([0,1]),this.clearDepth.set(o),this.depthMask.set(!0)),c.clear(v)},q.prototype.setCullFace=function(n){n.enable===!1?this.cullFace.set(!1):(this.cullFace.set(!0),this.cullFaceSide.set(n.mode),this.frontFace.set(n.frontFace))},q.prototype.setDepthMode=function(n){n.func!==this.gl.ALWAYS||n.mask?(this.depthTest.set(!0),this.depthFunc.set(n.func),this.depthMask.set(n.mask),this.depthRange.set(n.range)):this.depthTest.set(!1)},q.prototype.setStencilMode=function(n){n.test.func!==this.gl.ALWAYS||n.mask?(this.stencilTest.set(!0),this.stencilMask.set(n.mask),this.stencilOp.set([n.fail,n.depthFail,n.pass]),this.stencilFunc.set({func:n.test.func,ref:n.ref,mask:n.test.mask})):this.stencilTest.set(!1)},q.prototype.setColorMode=function(n){a.deepEqual(n.blendFunction,ue.Replace)?this.blend.set(!1):(this.blend.set(!0),this.blendFunc.set(n.blendFunction),this.blendColor.set(n.blendColor)),this.colorMask.set(n.mask)},q.prototype.unbindVAO=function(){this.extVertexArrayObject&&this.bindVertexArrayOES.set(null)};var Q=function(n){function s(o,c,v){var w=this;n.call(this),this.id=o,this.dispatcher=v,this.on("data",function(S){S.dataType==="source"&&S.sourceDataType==="metadata"&&(w._sourceLoaded=!0),w._sourceLoaded&&!w._paused&&S.dataType==="source"&&S.sourceDataType==="content"&&(w.reload(),w.transform&&w.update(w.transform))}),this.on("error",function(){w._sourceErrored=!0}),this._source=function(S,z,C,O){var Z=new Vr[z.type](S,z,C,O);if(Z.id!==S)throw new Error("Expected Source id to be "+S+" instead of "+Z.id);return a.bindAll(["load","abort","unload","serialize","prepare"],Z),Z}(o,c,v,this),this._tiles={},this._cache=new Jt(0,this._unloadTile.bind(this)),this._timers={},this._cacheTimers={},this._maxTileCacheSize=null,this._loadedParentTiles={},this._coveredTiles={},this._state=new a.SourceFeatureState}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype.onAdd=function(o){this.map=o,this._maxTileCacheSize=o?o._maxTileCacheSize:null,this._source&&this._source.onAdd&&this._source.onAdd(o)},s.prototype.onRemove=function(o){this._source&&this._source.onRemove&&this._source.onRemove(o)},s.prototype.loaded=function(){if(this._sourceErrored)return!0;if(!this._sourceLoaded||!this._source.loaded())return!1;for(var o in this._tiles){var c=this._tiles[o];if(c.state!=="loaded"&&c.state!=="errored")return!1}return!0},s.prototype.getSource=function(){return this._source},s.prototype.pause=function(){this._paused=!0},s.prototype.resume=function(){if(this._paused){var o=this._shouldReloadOnResume;this._paused=!1,this._shouldReloadOnResume=!1,o&&this.reload(),this.transform&&this.update(this.transform)}},s.prototype._loadTile=function(o,c){return this._source.loadTile(o,c)},s.prototype._unloadTile=function(o){if(this._source.unloadTile)return this._source.unloadTile(o,function(){})},s.prototype._abortTile=function(o){if(this._source.abortTile)return this._source.abortTile(o,function(){})},s.prototype.serialize=function(){return this._source.serialize()},s.prototype.prepare=function(o){for(var c in this._source.prepare&&this._source.prepare(),this._state.coalesceChanges(this._tiles,this.map?this.map.painter:null),this._tiles){var v=this._tiles[c];v.upload(o),v.prepare(this.map.style.imageManager)}},s.prototype.getIds=function(){return a.values(this._tiles).map(function(o){return o.tileID}).sort(me).map(function(o){return o.key})},s.prototype.getRenderableIds=function(o){var c=this,v=[];for(var w in this._tiles)this._isIdRenderable(w,o)&&v.push(this._tiles[w]);return o?v.sort(function(S,z){var C=S.tileID,O=z.tileID,Z=new a.Point(C.canonical.x,C.canonical.y)._rotate(c.transform.angle),G=new a.Point(O.canonical.x,O.canonical.y)._rotate(c.transform.angle);return C.overscaledZ-O.overscaledZ||G.y-Z.y||G.x-Z.x}).map(function(S){return S.tileID.key}):v.map(function(S){return S.tileID}).sort(me).map(function(S){return S.key})},s.prototype.hasRenderableParent=function(o){var c=this.findLoadedParent(o,0);return!!c&&this._isIdRenderable(c.tileID.key)},s.prototype._isIdRenderable=function(o,c){return this._tiles[o]&&this._tiles[o].hasData()&&!this._coveredTiles[o]&&(c||!this._tiles[o].holdingForFade())},s.prototype.reload=function(){if(this._paused)this._shouldReloadOnResume=!0;else for(var o in this._cache.reset(),this._tiles)this._tiles[o].state!=="errored"&&this._reloadTile(o,"reloading")},s.prototype._reloadTile=function(o,c){var v=this._tiles[o];v&&(v.state!=="loading"&&(v.state=c),this._loadTile(v,this._tileLoaded.bind(this,v,o,c)))},s.prototype._tileLoaded=function(o,c,v,w){if(w)return o.state="errored",void(w.status!==404?this._source.fire(new a.ErrorEvent(w,{tile:o})):this.update(this.transform));o.timeAdded=a.browser.now(),v==="expired"&&(o.refreshedUponExpiration=!0),this._setTileReloadTimer(c,o),this.getSource().type==="raster-dem"&&o.dem&&this._backfillDEM(o),this._state.initializeTileState(o,this.map?this.map.painter:null),this._source.fire(new a.Event("data",{dataType:"source",tile:o,coord:o.tileID}))},s.prototype._backfillDEM=function(o){for(var c=this.getRenderableIds(),v=0;v<c.length;v++){var w=c[v];if(o.neighboringTiles&&o.neighboringTiles[w]){var S=this.getTileByID(w);z(o,S),z(S,o)}}function z(C,O){C.needsHillshadePrepare=!0;var Z=O.tileID.canonical.x-C.tileID.canonical.x,G=O.tileID.canonical.y-C.tileID.canonical.y,H=Math.pow(2,C.tileID.canonical.z),re=O.tileID.key;Z===0&&G===0||Math.abs(G)>1||(Math.abs(Z)>1&&(Math.abs(Z+H)===1?Z+=H:Math.abs(Z-H)===1&&(Z-=H)),O.dem&&C.dem&&(C.dem.backfillBorder(O.dem,Z,G),C.neighboringTiles&&C.neighboringTiles[re]&&(C.neighboringTiles[re].backfilled=!0)))}},s.prototype.getTile=function(o){return this.getTileByID(o.key)},s.prototype.getTileByID=function(o){return this._tiles[o]},s.prototype._retainLoadedChildren=function(o,c,v,w){for(var S in this._tiles){var z=this._tiles[S];if(!(w[S]||!z.hasData()||z.tileID.overscaledZ<=c||z.tileID.overscaledZ>v)){for(var C=z.tileID;z&&z.tileID.overscaledZ>c+1;){var O=z.tileID.scaledTo(z.tileID.overscaledZ-1);(z=this._tiles[O.key])&&z.hasData()&&(C=O)}for(var Z=C;Z.overscaledZ>c;)if(o[(Z=Z.scaledTo(Z.overscaledZ-1)).key]){w[C.key]=C;break}}}},s.prototype.findLoadedParent=function(o,c){if(o.key in this._loadedParentTiles){var v=this._loadedParentTiles[o.key];return v&&v.tileID.overscaledZ>=c?v:null}for(var w=o.overscaledZ-1;w>=c;w--){var S=o.scaledTo(w),z=this._getLoadedTile(S);if(z)return z}},s.prototype._getLoadedTile=function(o){var c=this._tiles[o.key];return c&&c.hasData()?c:this._cache.getByKey(o.wrapped().key)},s.prototype.updateCacheSize=function(o){var c=Math.ceil(o.width/this._source.tileSize)+1,v=Math.ceil(o.height/this._source.tileSize)+1,w=Math.floor(c*v*5),S=typeof this._maxTileCacheSize=="number"?Math.min(this._maxTileCacheSize,w):w;this._cache.setMaxSize(S)},s.prototype.handleWrapJump=function(o){var c=Math.round((o-(this._prevLng===void 0?o:this._prevLng))/360);if(this._prevLng=o,c){var v={};for(var w in this._tiles){var S=this._tiles[w];S.tileID=S.tileID.unwrapTo(S.tileID.wrap+c),v[S.tileID.key]=S}for(var z in this._tiles=v,this._timers)clearTimeout(this._timers[z]),delete this._timers[z];for(var C in this._tiles)this._setTileReloadTimer(C,this._tiles[C])}},s.prototype.update=function(o){var c=this;if(this.transform=o,this._sourceLoaded&&!this._paused){var v;this.updateCacheSize(o),this.handleWrapJump(this.transform.center.lng),this._coveredTiles={},this.used?this._source.tileID?v=o.getVisibleUnwrappedCoordinates(this._source.tileID).map(function(Oe){return new a.OverscaledTileID(Oe.canonical.z,Oe.wrap,Oe.canonical.z,Oe.canonical.x,Oe.canonical.y)}):(v=o.coveringTiles({tileSize:this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this._source.roundZoom,reparseOverscaled:this._source.reparseOverscaled}),this._source.hasTile&&(v=v.filter(function(Oe){return c._source.hasTile(Oe)}))):v=[];var w=o.coveringZoomLevel(this._source),S=Math.max(w-s.maxOverzooming,this._source.minzoom),z=Math.max(w+s.maxUnderzooming,this._source.minzoom),C=this._updateRetainedTiles(v,w);if(Me(this._source.type)){for(var O={},Z={},G=0,H=Object.keys(C);G<H.length;G+=1){var re=H[G],ee=C[re],le=this._tiles[re];if(le&&!(le.fadeEndTime&&le.fadeEndTime<=a.browser.now())){var Y=this.findLoadedParent(ee,S);Y&&(this._addTile(Y.tileID),O[Y.tileID.key]=Y.tileID),Z[re]=ee}}for(var se in this._retainLoadedChildren(Z,w,z,C),O)C[se]||(this._coveredTiles[se]=!0,C[se]=O[se])}for(var fe in C)this._tiles[fe].clearFadeHold();for(var _e=0,Te=a.keysDifference(this._tiles,C);_e<Te.length;_e+=1){var Se=Te[_e],Ae=this._tiles[Se];Ae.hasSymbolBuckets&&!Ae.holdingForFade()?Ae.setHoldDuration(this.map._fadeDuration):Ae.hasSymbolBuckets&&!Ae.symbolFadeFinished()||this._removeTile(Se)}this._updateLoadedParentTileCache()}},s.prototype.releaseSymbolFadeTiles=function(){for(var o in this._tiles)this._tiles[o].holdingForFade()&&this._removeTile(o)},s.prototype._updateRetainedTiles=function(o,c){for(var v={},w={},S=Math.max(c-s.maxOverzooming,this._source.minzoom),z=Math.max(c+s.maxUnderzooming,this._source.minzoom),C={},O=0,Z=o;O<Z.length;O+=1){var G=Z[O],H=this._addTile(G);v[G.key]=G,H.hasData()||c<this._source.maxzoom&&(C[G.key]=G)}this._retainLoadedChildren(C,c,z,v);for(var re=0,ee=o;re<ee.length;re+=1){var le=ee[re],Y=this._tiles[le.key];if(!Y.hasData()){if(c+1>this._source.maxzoom){var se=le.children(this._source.maxzoom)[0],fe=this.getTile(se);if(fe&&fe.hasData()){v[se.key]=se;continue}}else{var _e=le.children(this._source.maxzoom);if(v[_e[0].key]&&v[_e[1].key]&&v[_e[2].key]&&v[_e[3].key])continue}for(var Te=Y.wasRequested(),Se=le.overscaledZ-1;Se>=S;--Se){var Ae=le.scaledTo(Se);if(w[Ae.key]||(w[Ae.key]=!0,!(Y=this.getTile(Ae))&&Te&&(Y=this._addTile(Ae)),Y&&(v[Ae.key]=Ae,Te=Y.wasRequested(),Y.hasData())))break}}}return v},s.prototype._updateLoadedParentTileCache=function(){for(var o in this._loadedParentTiles={},this._tiles){for(var c=[],v=void 0,w=this._tiles[o].tileID;w.overscaledZ>0;){if(w.key in this._loadedParentTiles){v=this._loadedParentTiles[w.key];break}c.push(w.key);var S=w.scaledTo(w.overscaledZ-1);if(v=this._getLoadedTile(S))break;w=S}for(var z=0,C=c;z<C.length;z+=1)this._loadedParentTiles[C[z]]=v}},s.prototype._addTile=function(o){var c=this._tiles[o.key];if(c)return c;(c=this._cache.getAndRemove(o))&&(this._setTileReloadTimer(o.key,c),c.tileID=o,this._state.initializeTileState(c,this.map?this.map.painter:null),this._cacheTimers[o.key]&&(clearTimeout(this._cacheTimers[o.key]),delete this._cacheTimers[o.key],this._setTileReloadTimer(o.key,c)));var v=!!c;return v||(c=new a.Tile(o,this._source.tileSize*o.overscaleFactor()),this._loadTile(c,this._tileLoaded.bind(this,c,o.key,c.state))),c?(c.uses++,this._tiles[o.key]=c,v||this._source.fire(new a.Event("dataloading",{tile:c,coord:c.tileID,dataType:"source"})),c):null},s.prototype._setTileReloadTimer=function(o,c){var v=this;o in this._timers&&(clearTimeout(this._timers[o]),delete this._timers[o]);var w=c.getExpiryTimeout();w&&(this._timers[o]=setTimeout(function(){v._reloadTile(o,"expired"),delete v._timers[o]},w))},s.prototype._removeTile=function(o){var c=this._tiles[o];c&&(c.uses--,delete this._tiles[o],this._timers[o]&&(clearTimeout(this._timers[o]),delete this._timers[o]),c.uses>0||(c.hasData()&&c.state!=="reloading"?this._cache.add(c.tileID,c,c.getExpiryTimeout()):(c.aborted=!0,this._abortTile(c),this._unloadTile(c))))},s.prototype.clearTiles=function(){for(var o in this._shouldReloadOnResume=!1,this._paused=!1,this._tiles)this._removeTile(o);this._cache.reset()},s.prototype.tilesIn=function(o,c,v){var w=this,S=[],z=this.transform;if(!z)return S;for(var C=v?z.getCameraQueryGeometry(o):o,O=o.map(function(Se){return z.pointCoordinate(Se)}),Z=C.map(function(Se){return z.pointCoordinate(Se)}),G=this.getIds(),H=1/0,re=1/0,ee=-1/0,le=-1/0,Y=0,se=Z;Y<se.length;Y+=1){var fe=se[Y];H=Math.min(H,fe.x),re=Math.min(re,fe.y),ee=Math.max(ee,fe.x),le=Math.max(le,fe.y)}for(var _e=function(Se){var Ae=w._tiles[G[Se]];if(!Ae.holdingForFade()){var Oe=Ae.tileID,He=Math.pow(2,z.zoom-Ae.tileID.overscaledZ),Ze=c*Ae.queryPadding*a.EXTENT/Ae.tileSize/He,ct=[Oe.getTilePoint(new a.MercatorCoordinate(H,re)),Oe.getTilePoint(new a.MercatorCoordinate(ee,le))];if(ct[0].x-Ze<a.EXTENT&&ct[0].y-Ze<a.EXTENT&&ct[1].x+Ze>=0&&ct[1].y+Ze>=0){var Et=O.map(function(It){return Oe.getTilePoint(It)}),Ct=Z.map(function(It){return Oe.getTilePoint(It)});S.push({tile:Ae,tileID:Oe,queryGeometry:Et,cameraQueryGeometry:Ct,scale:He})}}},Te=0;Te<G.length;Te++)_e(Te);return S},s.prototype.getVisibleCoordinates=function(o){for(var c=this,v=this.getRenderableIds(o).map(function(C){return c._tiles[C].tileID}),w=0,S=v;w<S.length;w+=1){var z=S[w];z.posMatrix=this.transform.calculatePosMatrix(z.toUnwrapped())}return v},s.prototype.hasTransition=function(){if(this._source.hasTransition())return!0;if(Me(this._source.type))for(var o in this._tiles){var c=this._tiles[o];if(c.fadeEndTime!==void 0&&c.fadeEndTime>=a.browser.now())return!0}return!1},s.prototype.setFeatureState=function(o,c,v){this._state.updateState(o=o||"_geojsonTileLayer",c,v)},s.prototype.removeFeatureState=function(o,c,v){this._state.removeFeatureState(o=o||"_geojsonTileLayer",c,v)},s.prototype.getFeatureState=function(o,c){return this._state.getState(o=o||"_geojsonTileLayer",c)},s.prototype.setDependencies=function(o,c,v){var w=this._tiles[o];w&&w.setDependencies(c,v)},s.prototype.reloadTilesForDependencies=function(o,c){for(var v in this._tiles)this._tiles[v].hasDependency(o,c)&&this._reloadTile(v,"reloading");this._cache.filter(function(w){return!w.hasDependency(o,c)})},s}(a.Evented);function me(n,s){var o=Math.abs(2*n.wrap)-+(n.wrap<0),c=Math.abs(2*s.wrap)-+(s.wrap<0);return n.overscaledZ-s.overscaledZ||c-o||s.canonical.y-n.canonical.y||s.canonical.x-n.canonical.x}function Me(n){return n==="raster"||n==="image"||n==="video"}function Be(){return new a.window.Worker(nl.workerUrl)}Q.maxOverzooming=10,Q.maxUnderzooming=3;var Ee="mapboxgl_preloaded_worker_pool",De=function(){this.active={}};De.prototype.acquire=function(n){if(!this.workers)for(this.workers=[];this.workers.length<De.workerCount;)this.workers.push(new Be);return this.active[n]=!0,this.workers.slice()},De.prototype.release=function(n){delete this.active[n],this.numActive()===0&&(this.workers.forEach(function(s){s.terminate()}),this.workers=null)},De.prototype.isPreloaded=function(){return!!this.active[Ee]},De.prototype.numActive=function(){return Object.keys(this.active).length};var it,nt=Math.floor(a.browser.hardwareConcurrency/2);function ze(){return it||(it=new De),it}function et(n,s){var o={};for(var c in n)c!=="ref"&&(o[c]=n[c]);return a.refProperties.forEach(function(v){v in s&&(o[v]=s[v])}),o}function Ge(n){n=n.slice();for(var s=Object.create(null),o=0;o<n.length;o++)s[n[o].id]=n[o];for(var c=0;c<n.length;c++)"ref"in n[c]&&(n[c]=et(n[c],s[n[c].ref]));return n}De.workerCount=Math.max(Math.min(nt,6),1);var Ye={setStyle:"setStyle",addLayer:"addLayer",removeLayer:"removeLayer",setPaintProperty:"setPaintProperty",setLayoutProperty:"setLayoutProperty",setFilter:"setFilter",addSource:"addSource",removeSource:"removeSource",setGeoJSONSourceData:"setGeoJSONSourceData",setLayerZoomRange:"setLayerZoomRange",setLayerProperty:"setLayerProperty",setCenter:"setCenter",setZoom:"setZoom",setBearing:"setBearing",setPitch:"setPitch",setSprite:"setSprite",setGlyphs:"setGlyphs",setTransition:"setTransition",setLight:"setLight"};function Pt(n,s,o){o.push({command:Ye.addSource,args:[n,s[n]]})}function rt(n,s,o){s.push({command:Ye.removeSource,args:[n]}),o[n]=!0}function Qt(n,s,o,c){rt(n,o,c),Pt(n,s,o)}function _r(n,s,o){var c;for(c in n[o])if(n[o].hasOwnProperty(c)&&c!=="data"&&!a.deepEqual(n[o][c],s[o][c]))return!1;for(c in s[o])if(s[o].hasOwnProperty(c)&&c!=="data"&&!a.deepEqual(n[o][c],s[o][c]))return!1;return!0}function Kt(n,s,o,c,v,w){var S;for(S in s=s||{},n=n||{})n.hasOwnProperty(S)&&(a.deepEqual(n[S],s[S])||o.push({command:w,args:[c,S,s[S],v]}));for(S in s)s.hasOwnProperty(S)&&!n.hasOwnProperty(S)&&(a.deepEqual(n[S],s[S])||o.push({command:w,args:[c,S,s[S],v]}))}function lr(n){return n.id}function $t(n,s){return n[s.id]=s,n}var _i=function(n,s){this.reset(n,s)};_i.prototype.reset=function(n,s){this.points=n||[],this._distances=[0];for(var o=1;o<this.points.length;o++)this._distances[o]=this._distances[o-1]+this.points[o].dist(this.points[o-1]);this.length=this._distances[this._distances.length-1],this.padding=Math.min(s||0,.5*this.length),this.paddedLength=this.length-2*this.padding},_i.prototype.lerp=function(n){if(this.points.length===1)return this.points[0];n=a.clamp(n,0,1);for(var s=1,o=this._distances[s],c=n*this.paddedLength+this.padding;o<c&&s<this._distances.length;)o=this._distances[++s];var v=s-1,w=this._distances[v],S=o-w,z=S>0?(c-w)/S:0;return this.points[v].mult(1-z).add(this.points[s].mult(z))};var hr=function(n,s,o){var c=this.boxCells=[],v=this.circleCells=[];this.xCellCount=Math.ceil(n/o),this.yCellCount=Math.ceil(s/o);for(var w=0;w<this.xCellCount*this.yCellCount;w++)c.push([]),v.push([]);this.circleKeys=[],this.boxKeys=[],this.bboxes=[],this.circles=[],this.width=n,this.height=s,this.xScale=this.xCellCount/n,this.yScale=this.yCellCount/s,this.boxUid=0,this.circleUid=0};function Or(n,s,o,c,v){var w=a.create();return s?(a.scale(w,w,[1/v,1/v,1]),o||a.rotateZ(w,w,c.angle)):a.multiply(w,c.labelPlaneMatrix,n),w}function gr(n,s,o,c,v){if(s){var w=a.clone(n);return a.scale(w,w,[v,v,1]),o||a.rotateZ(w,w,-c.angle),w}return c.glCoordMatrix}function Wt(n,s){var o=[n.x,n.y,0,1];ii(o,o,s);var c=o[3];return{point:new a.Point(o[0]/c,o[1]/c),signedDistanceFromCamera:c}}function ur(n,s){return .5+n/s*.5}function Si(n,s){var o=n[0]/n[3],c=n[1]/n[3];return o>=-s[0]&&o<=s[0]&&c>=-s[1]&&c<=s[1]}function ha(n,s,o,c,v,w,S,z){var C=c?n.textSizeData:n.iconSizeData,O=a.evaluateSizeForZoom(C,o.transform.zoom),Z=[256/o.width*2+1,256/o.height*2+1],G=c?n.text.dynamicLayoutVertexArray:n.icon.dynamicLayoutVertexArray;G.clear();for(var H=n.lineVertexArray,re=c?n.text.placedSymbolArray:n.icon.placedSymbolArray,ee=o.transform.width/o.transform.height,le=!1,Y=0;Y<re.length;Y++){var se=re.get(Y);if(se.hidden||se.writingMode===a.WritingMode.vertical&&!le)ki(se.numGlyphs,G);else{le=!1;var fe=[se.anchorX,se.anchorY,0,1];if(a.transformMat4(fe,fe,s),Si(fe,Z)){var _e=ur(o.transform.cameraToCenterDistance,fe[3]),Te=a.evaluateSizeForFeature(C,O,se),Se=S?Te/_e:Te*_e,Ae=new a.Point(se.anchorX,se.anchorY),Oe=Wt(Ae,v).point,He={},Ze=Ua(se,Se,!1,z,s,v,w,n.glyphOffsetArray,H,G,Oe,Ae,He,ee);le=Ze.useVertical,(Ze.notEnoughRoom||le||Ze.needsFlipping&&Ua(se,Se,!0,z,s,v,w,n.glyphOffsetArray,H,G,Oe,Ae,He,ee).notEnoughRoom)&&ki(se.numGlyphs,G)}else ki(se.numGlyphs,G)}}c?n.text.dynamicLayoutVertexBuffer.updateData(G):n.icon.dynamicLayoutVertexBuffer.updateData(G)}function ri(n,s,o,c,v,w,S,z,C,O,Z){var G=z.glyphStartIndex+z.numGlyphs,H=z.lineStartIndex,re=z.lineStartIndex+z.lineLength,ee=s.getoffsetX(z.glyphStartIndex),le=s.getoffsetX(G-1),Y=jr(n*ee,o,c,v,w,S,z.segment,H,re,C,O,Z);if(!Y)return null;var se=jr(n*le,o,c,v,w,S,z.segment,H,re,C,O,Z);return se?{first:Y,last:se}:null}function Ri(n,s,o,c){return n===a.WritingMode.horizontal&&Math.abs(o.y-s.y)>Math.abs(o.x-s.x)*c?{useVertical:!0}:(n===a.WritingMode.vertical?s.y<o.y:s.x>o.x)?{needsFlipping:!0}:null}function Ua(n,s,o,c,v,w,S,z,C,O,Z,G,H,re){var ee,le=s/24,Y=n.lineOffsetX*le,se=n.lineOffsetY*le;if(n.numGlyphs>1){var fe=n.glyphStartIndex+n.numGlyphs,_e=n.lineStartIndex,Te=n.lineStartIndex+n.lineLength,Se=ri(le,z,Y,se,o,Z,G,n,C,w,H);if(!Se)return{notEnoughRoom:!0};var Ae=Wt(Se.first.point,S).point,Oe=Wt(Se.last.point,S).point;if(c&&!o){var He=Ri(n.writingMode,Ae,Oe,re);if(He)return He}ee=[Se.first];for(var Ze=n.glyphStartIndex+1;Ze<fe-1;Ze++)ee.push(jr(le*z.getoffsetX(Ze),Y,se,o,Z,G,n.segment,_e,Te,C,w,H));ee.push(Se.last)}else{if(c&&!o){var ct=Wt(G,v).point,Et=n.lineStartIndex+n.segment+1,Ct=new a.Point(C.getx(Et),C.gety(Et)),It=Wt(Ct,v),dr=It.signedDistanceFromCamera>0?It.point:_a(G,Ct,ct,1,v),pt=Ri(n.writingMode,ct,dr,re);if(pt)return pt}var Ut=jr(le*z.getoffsetX(n.glyphStartIndex),Y,se,o,Z,G,n.segment,n.lineStartIndex,n.lineStartIndex+n.lineLength,C,w,H);if(!Ut)return{notEnoughRoom:!0};ee=[Ut]}for(var Xt=0,Nt=ee;Xt<Nt.length;Xt+=1){var Bt=Nt[Xt];a.addDynamicAttributes(O,Bt.point,Bt.angle)}return{}}function _a(n,s,o,c,v){var w=Wt(n.add(n.sub(s)._unit()),v).point,S=o.sub(w);return o.add(S._mult(c/S.mag()))}function jr(n,s,o,c,v,w,S,z,C,O,Z,G){var H=c?n-s:n+s,re=H>0?1:-1,ee=0;c&&(re*=-1,ee=Math.PI),re<0&&(ee+=Math.PI);for(var le=re>0?z+S:z+S+1,Y=v,se=v,fe=0,_e=0,Te=Math.abs(H),Se=[];fe+_e<=Te;){if((le+=re)<z||le>=C)return null;if(se=Y,Se.push(Y),(Y=G[le])===void 0){var Ae=new a.Point(O.getx(le),O.gety(le)),Oe=Wt(Ae,Z);if(Oe.signedDistanceFromCamera>0)Y=G[le]=Oe.point;else{var He=le-re;Y=_a(fe===0?w:new a.Point(O.getx(He),O.gety(He)),Ae,se,Te-fe+1,Z)}}fe+=_e,_e=se.dist(Y)}var Ze=(Te-fe)/_e,ct=Y.sub(se),Et=ct.mult(Ze)._add(se);Et._add(ct._unit()._perp()._mult(o*re));var Ct=ee+Math.atan2(Y.y-se.y,Y.x-se.x);return Se.push(Et),{point:Et,angle:Ct,path:Se}}hr.prototype.keysLength=function(){return this.boxKeys.length+this.circleKeys.length},hr.prototype.insert=function(n,s,o,c,v){this._forEachCell(s,o,c,v,this._insertBoxCell,this.boxUid++),this.boxKeys.push(n),this.bboxes.push(s),this.bboxes.push(o),this.bboxes.push(c),this.bboxes.push(v)},hr.prototype.insertCircle=function(n,s,o,c){this._forEachCell(s-c,o-c,s+c,o+c,this._insertCircleCell,this.circleUid++),this.circleKeys.push(n),this.circles.push(s),this.circles.push(o),this.circles.push(c)},hr.prototype._insertBoxCell=function(n,s,o,c,v,w){this.boxCells[v].push(w)},hr.prototype._insertCircleCell=function(n,s,o,c,v,w){this.circleCells[v].push(w)},hr.prototype._query=function(n,s,o,c,v,w){if(o<0||n>this.width||c<0||s>this.height)return!v&&[];var S=[];if(n<=0&&s<=0&&this.width<=o&&this.height<=c){if(v)return!0;for(var z=0;z<this.boxKeys.length;z++)S.push({key:this.boxKeys[z],x1:this.bboxes[4*z],y1:this.bboxes[4*z+1],x2:this.bboxes[4*z+2],y2:this.bboxes[4*z+3]});for(var C=0;C<this.circleKeys.length;C++){var O=this.circles[3*C],Z=this.circles[3*C+1],G=this.circles[3*C+2];S.push({key:this.circleKeys[C],x1:O-G,y1:Z-G,x2:O+G,y2:Z+G})}return w?S.filter(w):S}return this._forEachCell(n,s,o,c,this._queryCell,S,{hitTest:v,seenUids:{box:{},circle:{}}},w),v?S.length>0:S},hr.prototype._queryCircle=function(n,s,o,c,v){var w=n-o,S=n+o,z=s-o,C=s+o;if(S<0||w>this.width||C<0||z>this.height)return!c&&[];var O=[];return this._forEachCell(w,z,S,C,this._queryCellCircle,O,{hitTest:c,circle:{x:n,y:s,radius:o},seenUids:{box:{},circle:{}}},v),c?O.length>0:O},hr.prototype.query=function(n,s,o,c,v){return this._query(n,s,o,c,!1,v)},hr.prototype.hitTest=function(n,s,o,c,v){return this._query(n,s,o,c,!0,v)},hr.prototype.hitTestCircle=function(n,s,o,c){return this._queryCircle(n,s,o,!0,c)},hr.prototype._queryCell=function(n,s,o,c,v,w,S,z){var C=S.seenUids,O=this.boxCells[v];if(O!==null)for(var Z=this.bboxes,G=0,H=O;G<H.length;G+=1){var re=H[G];if(!C.box[re]){C.box[re]=!0;var ee=4*re;if(n<=Z[ee+2]&&s<=Z[ee+3]&&o>=Z[ee+0]&&c>=Z[ee+1]&&(!z||z(this.boxKeys[re]))){if(S.hitTest)return w.push(!0),!0;w.push({key:this.boxKeys[re],x1:Z[ee],y1:Z[ee+1],x2:Z[ee+2],y2:Z[ee+3]})}}}var le=this.circleCells[v];if(le!==null)for(var Y=this.circles,se=0,fe=le;se<fe.length;se+=1){var _e=fe[se];if(!C.circle[_e]){C.circle[_e]=!0;var Te=3*_e;if(this._circleAndRectCollide(Y[Te],Y[Te+1],Y[Te+2],n,s,o,c)&&(!z||z(this.circleKeys[_e]))){if(S.hitTest)return w.push(!0),!0;var Se=Y[Te],Ae=Y[Te+1],Oe=Y[Te+2];w.push({key:this.circleKeys[_e],x1:Se-Oe,y1:Ae-Oe,x2:Se+Oe,y2:Ae+Oe})}}}},hr.prototype._queryCellCircle=function(n,s,o,c,v,w,S,z){var C=S.circle,O=S.seenUids,Z=this.boxCells[v];if(Z!==null)for(var G=this.bboxes,H=0,re=Z;H<re.length;H+=1){var ee=re[H];if(!O.box[ee]){O.box[ee]=!0;var le=4*ee;if(this._circleAndRectCollide(C.x,C.y,C.radius,G[le+0],G[le+1],G[le+2],G[le+3])&&(!z||z(this.boxKeys[ee])))return w.push(!0),!0}}var Y=this.circleCells[v];if(Y!==null)for(var se=this.circles,fe=0,_e=Y;fe<_e.length;fe+=1){var Te=_e[fe];if(!O.circle[Te]){O.circle[Te]=!0;var Se=3*Te;if(this._circlesCollide(se[Se],se[Se+1],se[Se+2],C.x,C.y,C.radius)&&(!z||z(this.circleKeys[Te])))return w.push(!0),!0}}},hr.prototype._forEachCell=function(n,s,o,c,v,w,S,z){for(var C=this._convertToXCellCoord(n),O=this._convertToYCellCoord(s),Z=this._convertToXCellCoord(o),G=this._convertToYCellCoord(c),H=C;H<=Z;H++)for(var re=O;re<=G;re++)if(v.call(this,n,s,o,c,this.xCellCount*re+H,w,S,z))return},hr.prototype._convertToXCellCoord=function(n){return Math.max(0,Math.min(this.xCellCount-1,Math.floor(n*this.xScale)))},hr.prototype._convertToYCellCoord=function(n){return Math.max(0,Math.min(this.yCellCount-1,Math.floor(n*this.yScale)))},hr.prototype._circlesCollide=function(n,s,o,c,v,w){var S=c-n,z=v-s,C=o+w;return C*C>S*S+z*z},hr.prototype._circleAndRectCollide=function(n,s,o,c,v,w,S){var z=(w-c)/2,C=Math.abs(n-(c+z));if(C>z+o)return!1;var O=(S-v)/2,Z=Math.abs(s-(v+O));if(Z>O+o)return!1;if(C<=z||Z<=O)return!0;var G=C-z,H=Z-O;return G*G+H*H<=o*o};var va=new Float32Array([-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0]);function ki(n,s){for(var o=0;o<n;o++){var c=s.length;s.resize(c+4),s.float32.set(va,3*c)}}function ii(n,s,o){var c=s[0],v=s[1];return n[0]=o[0]*c+o[4]*v+o[12],n[1]=o[1]*c+o[5]*v+o[13],n[3]=o[3]*c+o[7]*v+o[15],n}var ln=function(n,s,o){s===void 0&&(s=new hr(n.width+200,n.height+200,25)),o===void 0&&(o=new hr(n.width+200,n.height+200,25)),this.transform=n,this.grid=s,this.ignoredGrid=o,this.pitchfactor=Math.cos(n._pitch)*n.cameraToCenterDistance,this.screenRightBoundary=n.width+100,this.screenBottomBoundary=n.height+100,this.gridRightBoundary=n.width+200,this.gridBottomBoundary=n.height+200};function Pr(n,s,o){return s*(a.EXTENT/(n.tileSize*Math.pow(2,o-n.tileID.overscaledZ)))}ln.prototype.placeCollisionBox=function(n,s,o,c,v){var w=this.projectAndGetPerspectiveRatio(c,n.anchorPointX,n.anchorPointY),S=o*w.perspectiveRatio,z=n.x1*S+w.point.x,C=n.y1*S+w.point.y,O=n.x2*S+w.point.x,Z=n.y2*S+w.point.y;return!this.isInsideGrid(z,C,O,Z)||!s&&this.grid.hitTest(z,C,O,Z,v)?{box:[],offscreen:!1}:{box:[z,C,O,Z],offscreen:this.isOffscreen(z,C,O,Z)}},ln.prototype.placeCollisionCircles=function(n,s,o,c,v,w,S,z,C,O,Z,G,H){var re=[],ee=new a.Point(s.anchorX,s.anchorY),le=Wt(ee,w),Y=ur(this.transform.cameraToCenterDistance,le.signedDistanceFromCamera),se=(O?v/Y:v*Y)/a.ONE_EM,fe=Wt(ee,S).point,_e=ri(se,c,s.lineOffsetX*se,s.lineOffsetY*se,!1,fe,ee,s,o,S,{}),Te=!1,Se=!1,Ae=!0;if(_e){for(var Oe=.5*G*Y+H,He=new a.Point(-100,-100),Ze=new a.Point(this.screenRightBoundary,this.screenBottomBoundary),ct=new _i,Et=_e.first,Ct=_e.last,It=[],dr=Et.path.length-1;dr>=1;dr--)It.push(Et.path[dr]);for(var pt=1;pt<Ct.path.length;pt++)It.push(Ct.path[pt]);var Ut=2.5*Oe;if(z){var Xt=It.map(function(aa){return Wt(aa,z)});It=Xt.some(function(aa){return aa.signedDistanceFromCamera<=0})?[]:Xt.map(function(aa){return aa.point})}var Nt=[];if(It.length>0){for(var Bt=It[0].clone(),Ht=It[0].clone(),Rt=1;Rt<It.length;Rt++)Bt.x=Math.min(Bt.x,It[Rt].x),Bt.y=Math.min(Bt.y,It[Rt].y),Ht.x=Math.max(Ht.x,It[Rt].x),Ht.y=Math.max(Ht.y,It[Rt].y);Nt=Bt.x>=He.x&&Ht.x<=Ze.x&&Bt.y>=He.y&&Ht.y<=Ze.y?[It]:Ht.x<He.x||Bt.x>Ze.x||Ht.y<He.y||Bt.y>Ze.y?[]:a.clipLine([It],He.x,He.y,Ze.x,Ze.y)}for(var Mt=0,Bi=Nt;Mt<Bi.length;Mt+=1){var ni;ct.reset(Bi[Mt],.25*Oe),ni=ct.length<=.5*Oe?1:Math.ceil(ct.paddedLength/Ut)+1;for(var cn=0;cn<ni;cn++){var Ki=cn/Math.max(ni-1,1),Jr=ct.lerp(Ki),pi=Jr.x+100,Zn=Jr.y+100;re.push(pi,Zn,Oe,0);var xn=pi-Oe,$a=Zn-Oe,Pn=pi+Oe,ga=Zn+Oe;if(Ae=Ae&&this.isOffscreen(xn,$a,Pn,ga),Se=Se||this.isInsideGrid(xn,$a,Pn,ga),!n&&this.grid.hitTestCircle(pi,Zn,Oe,Z)&&(Te=!0,!C))return{circles:[],offscreen:!1,collisionDetected:Te}}}}return{circles:!C&&Te||!Se?[]:re,offscreen:Ae,collisionDetected:Te}},ln.prototype.queryRenderedSymbols=function(n){if(n.length===0||this.grid.keysLength()===0&&this.ignoredGrid.keysLength()===0)return{};for(var s=[],o=1/0,c=1/0,v=-1/0,w=-1/0,S=0,z=n;S<z.length;S+=1){var C=z[S],O=new a.Point(C.x+100,C.y+100);o=Math.min(o,O.x),c=Math.min(c,O.y),v=Math.max(v,O.x),w=Math.max(w,O.y),s.push(O)}for(var Z={},G={},H=0,re=this.grid.query(o,c,v,w).concat(this.ignoredGrid.query(o,c,v,w));H<re.length;H+=1){var ee=re[H],le=ee.key;if(Z[le.bucketInstanceId]===void 0&&(Z[le.bucketInstanceId]={}),!Z[le.bucketInstanceId][le.featureIndex]){var Y=[new a.Point(ee.x1,ee.y1),new a.Point(ee.x2,ee.y1),new a.Point(ee.x2,ee.y2),new a.Point(ee.x1,ee.y2)];a.polygonIntersectsPolygon(s,Y)&&(Z[le.bucketInstanceId][le.featureIndex]=!0,G[le.bucketInstanceId]===void 0&&(G[le.bucketInstanceId]=[]),G[le.bucketInstanceId].push(le.featureIndex))}}return G},ln.prototype.insertCollisionBox=function(n,s,o,c,v){(s?this.ignoredGrid:this.grid).insert({bucketInstanceId:o,featureIndex:c,collisionGroupID:v},n[0],n[1],n[2],n[3])},ln.prototype.insertCollisionCircles=function(n,s,o,c,v){for(var w=s?this.ignoredGrid:this.grid,S={bucketInstanceId:o,featureIndex:c,collisionGroupID:v},z=0;z<n.length;z+=4)w.insertCircle(S,n[z],n[z+1],n[z+2])},ln.prototype.projectAndGetPerspectiveRatio=function(n,s,o){var c=[s,o,0,1];return ii(c,c,n),{point:new a.Point((c[0]/c[3]+1)/2*this.transform.width+100,(-c[1]/c[3]+1)/2*this.transform.height+100),perspectiveRatio:.5+this.transform.cameraToCenterDistance/c[3]*.5}},ln.prototype.isOffscreen=function(n,s,o,c){return o<100||n>=this.screenRightBoundary||c<100||s>this.screenBottomBoundary},ln.prototype.isInsideGrid=function(n,s,o,c){return o>=0&&n<this.gridRightBoundary&&c>=0&&s<this.gridBottomBoundary},ln.prototype.getViewportMatrix=function(){var n=a.identity([]);return a.translate(n,n,[-100,-100,0]),n};var Bn=function(n,s,o,c){this.opacity=n?Math.max(0,Math.min(1,n.opacity+(n.placed?s:-s))):c&&o?1:0,this.placed=o};Bn.prototype.isHidden=function(){return this.opacity===0&&!this.placed};var _n=function(n,s,o,c,v){this.text=new Bn(n?n.text:null,s,o,v),this.icon=new Bn(n?n.icon:null,s,c,v)};_n.prototype.isHidden=function(){return this.text.isHidden()&&this.icon.isHidden()};var os=function(n,s,o){this.text=n,this.icon=s,this.skipFade=o},Ei=function(){this.invProjMatrix=a.create(),this.viewportMatrix=a.create(),this.circles=[]},ba=function(n,s,o,c,v){this.bucketInstanceId=n,this.featureIndex=s,this.sourceLayerIndex=o,this.bucketIndex=c,this.tileID=v},qi=function(n){this.crossSourceCollisions=n,this.maxGroupID=0,this.collisionGroups={}};function zi(n,s,o,c,v){var w=a.getAnchorAlignment(n),S=-(w.horizontalAlign-.5)*s,z=-(w.verticalAlign-.5)*o,C=a.evaluateVariableOffset(n,c);return new a.Point(S+C[0]*v,z+C[1]*v)}function Jn(n,s,o,c,v,w){var S=n.x1,z=n.x2,C=n.y1,O=n.y2,Z=n.anchorPointX,G=n.anchorPointY,H=new a.Point(s,o);return c&&H._rotate(v?w:-w),{x1:S+H.x,y1:C+H.y,x2:z+H.x,y2:O+H.y,anchorPointX:Z,anchorPointY:G}}qi.prototype.get=function(n){if(this.crossSourceCollisions)return{ID:0,predicate:null};if(!this.collisionGroups[n]){var s=++this.maxGroupID;this.collisionGroups[n]={ID:s,predicate:function(o){return o.collisionGroupID===s}}}return this.collisionGroups[n]};var ji=function(n,s,o,c){this.transform=n.clone(),this.collisionIndex=new ln(this.transform),this.placements={},this.opacities={},this.variableOffsets={},this.stale=!1,this.commitTime=0,this.fadeDuration=s,this.retainedQueryData={},this.collisionGroups=new qi(o),this.collisionCircleArrays={},this.prevPlacement=c,c&&(c.prevPlacement=void 0),this.placedOrientations={}};function xa(n,s,o,c,v){n.emplaceBack(s?1:0,o?1:0,c||0,v||0),n.emplaceBack(s?1:0,o?1:0,c||0,v||0),n.emplaceBack(s?1:0,o?1:0,c||0,v||0),n.emplaceBack(s?1:0,o?1:0,c||0,v||0)}ji.prototype.getBucketParts=function(n,s,o,c){var v=o.getBucket(s),w=o.latestFeatureIndex;if(v&&w&&s.id===v.layerIds[0]){var S=o.collisionBoxArray,z=v.layers[0].layout,C=Math.pow(2,this.transform.zoom-o.tileID.overscaledZ),O=o.tileSize/a.EXTENT,Z=this.transform.calculatePosMatrix(o.tileID.toUnwrapped()),G=z.get("text-pitch-alignment")==="map",H=z.get("text-rotation-alignment")==="map",re=Pr(o,1,this.transform.zoom),ee=Or(Z,G,H,this.transform,re),le=null;if(G){var Y=gr(Z,G,H,this.transform,re);le=a.multiply([],this.transform.labelPlaneMatrix,Y)}this.retainedQueryData[v.bucketInstanceId]=new ba(v.bucketInstanceId,w,v.sourceLayerIndex,v.index,o.tileID);var se={bucket:v,layout:z,posMatrix:Z,textLabelPlaneMatrix:ee,labelToScreenMatrix:le,scale:C,textPixelRatio:O,holdingForFade:o.holdingForFade(),collisionBoxArray:S,partiallyEvaluatedTextSize:a.evaluateSizeForZoom(v.textSizeData,this.transform.zoom),collisionGroup:this.collisionGroups.get(v.sourceID)};if(c)for(var fe=0,_e=v.sortKeyRanges;fe<_e.length;fe+=1){var Te=_e[fe];n.push({sortKey:Te.sortKey,symbolInstanceStart:Te.symbolInstanceStart,symbolInstanceEnd:Te.symbolInstanceEnd,parameters:se})}else n.push({symbolInstanceStart:0,symbolInstanceEnd:v.symbolInstances.length,parameters:se})}},ji.prototype.attemptAnchorPlacement=function(n,s,o,c,v,w,S,z,C,O,Z,G,H,re,ee){var le,Y=[G.textOffset0,G.textOffset1],se=zi(n,o,c,Y,v),fe=this.collisionIndex.placeCollisionBox(Jn(s,se.x,se.y,w,S,this.transform.angle),Z,z,C,O.predicate);if(!ee||this.collisionIndex.placeCollisionBox(Jn(ee,se.x,se.y,w,S,this.transform.angle),Z,z,C,O.predicate).box.length!==0)return fe.box.length>0?(this.prevPlacement&&this.prevPlacement.variableOffsets[G.crossTileID]&&this.prevPlacement.placements[G.crossTileID]&&this.prevPlacement.placements[G.crossTileID].text&&(le=this.prevPlacement.variableOffsets[G.crossTileID].anchor),this.variableOffsets[G.crossTileID]={textOffset:Y,width:o,height:c,anchor:n,textBoxScale:v,prevAnchor:le},this.markUsedJustification(H,n,G,re),H.allowVerticalPlacement&&(this.markUsedOrientation(H,re,G),this.placedOrientations[G.crossTileID]=re),{shift:se,placedGlyphBoxes:fe}):void 0},ji.prototype.placeLayerBucketPart=function(n,s,o){var c=this,v=n.parameters,w=v.bucket,S=v.layout,z=v.posMatrix,C=v.textLabelPlaneMatrix,O=v.labelToScreenMatrix,Z=v.textPixelRatio,G=v.holdingForFade,H=v.collisionBoxArray,re=v.partiallyEvaluatedTextSize,ee=v.collisionGroup,le=S.get("text-optional"),Y=S.get("icon-optional"),se=S.get("text-allow-overlap"),fe=S.get("icon-allow-overlap"),_e=S.get("text-rotation-alignment")==="map",Te=S.get("text-pitch-alignment")==="map",Se=S.get("icon-text-fit")!=="none",Ae=S.get("symbol-z-order")==="viewport-y",Oe=se&&(fe||!w.hasIconData()||Y),He=fe&&(se||!w.hasTextData()||le);!w.collisionArrays&&H&&w.deserializeCollisionBoxes(H);var Ze=function(pt,Ut){if(!s[pt.crossTileID])if(G)c.placements[pt.crossTileID]=new os(!1,!1,!1);else{var Xt,Nt=!1,Bt=!1,Ht=!0,Rt=null,Mt={box:null,offscreen:null},Bi={box:null,offscreen:null},ni=null,cn=null,Ki=0,Jr=0,pi=0;Ut.textFeatureIndex?Ki=Ut.textFeatureIndex:pt.useRuntimeCollisionCircles&&(Ki=pt.featureIndex),Ut.verticalTextFeatureIndex&&(Jr=Ut.verticalTextFeatureIndex);var Zn=Ut.textBox;if(Zn){var xn=function(wr){var ea=a.WritingMode.horizontal;if(w.allowVerticalPlacement&&!wr&&c.prevPlacement){var Cn=c.prevPlacement.placedOrientations[pt.crossTileID];Cn&&(c.placedOrientations[pt.crossTileID]=Cn,c.markUsedOrientation(w,ea=Cn,pt))}return ea},$a=function(wr,ea){if(w.allowVerticalPlacement&&pt.numVerticalGlyphVertices>0&&Ut.verticalTextBox)for(var Cn=0,Ao=w.writingModes;Cn<Ao.length&&(Ao[Cn]===a.WritingMode.vertical?(Mt=ea(),Bi=Mt):Mt=wr(),!(Mt&&Mt.box&&Mt.box.length));Cn+=1);else Mt=wr()};if(S.get("text-variable-anchor")){var Pn=S.get("text-variable-anchor");if(c.prevPlacement&&c.prevPlacement.variableOffsets[pt.crossTileID]){var ga=c.prevPlacement.variableOffsets[pt.crossTileID];Pn.indexOf(ga.anchor)>0&&(Pn=Pn.filter(function(wr){return wr!==ga.anchor})).unshift(ga.anchor)}var aa=function(wr,ea,Cn){for(var Ao=wr.x2-wr.x1,Wh=wr.y2-wr.y1,al=pt.textBoxScale,Yh=Se&&!fe?ea:null,Is={box:[],offscreen:!1},Ac=se?2*Pn.length:Pn.length,Yo=0;Yo<Ac;++Yo){var ol=c.attemptAnchorPlacement(Pn[Yo%Pn.length],wr,Ao,Wh,al,_e,Te,Z,z,ee,Yo>=Pn.length,pt,w,Cn,Yh);if(ol&&(Is=ol.placedGlyphBoxes)&&Is.box&&Is.box.length){Nt=!0,Rt=ol.shift;break}}return Is};$a(function(){return aa(Zn,Ut.iconBox,a.WritingMode.horizontal)},function(){var wr=Ut.verticalTextBox;return w.allowVerticalPlacement&&!(Mt&&Mt.box&&Mt.box.length)&&pt.numVerticalGlyphVertices>0&&wr?aa(wr,Ut.verticalIconBox,a.WritingMode.vertical):{box:null,offscreen:null}}),Mt&&(Nt=Mt.box,Ht=Mt.offscreen);var Es=xn(Mt&&Mt.box);if(!Nt&&c.prevPlacement){var Xo=c.prevPlacement.variableOffsets[pt.crossTileID];Xo&&(c.variableOffsets[pt.crossTileID]=Xo,c.markUsedJustification(w,Xo.anchor,pt,Es))}}else{var eo=function(wr,ea){var Cn=c.collisionIndex.placeCollisionBox(wr,se,Z,z,ee.predicate);return Cn&&Cn.box&&Cn.box.length&&(c.markUsedOrientation(w,ea,pt),c.placedOrientations[pt.crossTileID]=ea),Cn};$a(function(){return eo(Zn,a.WritingMode.horizontal)},function(){var wr=Ut.verticalTextBox;return w.allowVerticalPlacement&&pt.numVerticalGlyphVertices>0&&wr?eo(wr,a.WritingMode.vertical):{box:null,offscreen:null}}),xn(Mt&&Mt.box&&Mt.box.length)}}if(Nt=(Xt=Mt)&&Xt.box&&Xt.box.length>0,Ht=Xt&&Xt.offscreen,pt.useRuntimeCollisionCircles){var Wo=w.text.placedSymbolArray.get(pt.centerJustifiedTextSymbolIndex),zs=a.evaluateSizeForFeature(w.textSizeData,re,Wo),Ta=S.get("text-padding");ni=c.collisionIndex.placeCollisionCircles(se,Wo,w.lineVertexArray,w.glyphOffsetArray,zs,z,C,O,o,Te,ee.predicate,pt.collisionCircleDiameter,Ta),Nt=se||ni.circles.length>0&&!ni.collisionDetected,Ht=Ht&&ni.offscreen}if(Ut.iconFeatureIndex&&(pi=Ut.iconFeatureIndex),Ut.iconBox){var Ts=function(wr){var ea=Se&&Rt?Jn(wr,Rt.x,Rt.y,_e,Te,c.transform.angle):wr;return c.collisionIndex.placeCollisionBox(ea,fe,Z,z,ee.predicate)};Bt=Bi&&Bi.box&&Bi.box.length&&Ut.verticalIconBox?(cn=Ts(Ut.verticalIconBox)).box.length>0:(cn=Ts(Ut.iconBox)).box.length>0,Ht=Ht&&cn.offscreen}var Ia=le||pt.numHorizontalGlyphVertices===0&&pt.numVerticalGlyphVertices===0,Oi=Y||pt.numIconVertices===0;if(Ia||Oi?Oi?Ia||(Bt=Bt&&Nt):Nt=Bt&&Nt:Bt=Nt=Bt&&Nt,Nt&&Xt&&Xt.box&&c.collisionIndex.insertCollisionBox(Xt.box,S.get("text-ignore-placement"),w.bucketInstanceId,Bi&&Bi.box&&Jr?Jr:Ki,ee.ID),Bt&&cn&&c.collisionIndex.insertCollisionBox(cn.box,S.get("icon-ignore-placement"),w.bucketInstanceId,pi,ee.ID),ni&&(Nt&&c.collisionIndex.insertCollisionCircles(ni.circles,S.get("text-ignore-placement"),w.bucketInstanceId,Ki,ee.ID),o)){var La=w.bucketInstanceId,to=c.collisionCircleArrays[La];to===void 0&&(to=c.collisionCircleArrays[La]=new Ei);for(var Io=0;Io<ni.circles.length;Io+=4)to.circles.push(ni.circles[Io+0]),to.circles.push(ni.circles[Io+1]),to.circles.push(ni.circles[Io+2]),to.circles.push(ni.collisionDetected?1:0)}c.placements[pt.crossTileID]=new os(Nt||Oe,Bt||He,Ht||w.justReloaded),s[pt.crossTileID]=!0}};if(Ae)for(var ct=w.getSortedSymbolIndexes(this.transform.angle),Et=ct.length-1;Et>=0;--Et){var Ct=ct[Et];Ze(w.symbolInstances.get(Ct),w.collisionArrays[Ct])}else for(var It=n.symbolInstanceStart;It<n.symbolInstanceEnd;It++)Ze(w.symbolInstances.get(It),w.collisionArrays[It]);if(o&&w.bucketInstanceId in this.collisionCircleArrays){var dr=this.collisionCircleArrays[w.bucketInstanceId];a.invert(dr.invProjMatrix,z),dr.viewportMatrix=this.collisionIndex.getViewportMatrix()}w.justReloaded=!1},ji.prototype.markUsedJustification=function(n,s,o,c){var v;v=c===a.WritingMode.vertical?o.verticalPlacedTextSymbolIndex:{left:o.leftJustifiedTextSymbolIndex,center:o.centerJustifiedTextSymbolIndex,right:o.rightJustifiedTextSymbolIndex}[a.getAnchorJustification(s)];for(var w=0,S=[o.leftJustifiedTextSymbolIndex,o.centerJustifiedTextSymbolIndex,o.rightJustifiedTextSymbolIndex,o.verticalPlacedTextSymbolIndex];w<S.length;w+=1){var z=S[w];z>=0&&(n.text.placedSymbolArray.get(z).crossTileID=v>=0&&z!==v?0:o.crossTileID)}},ji.prototype.markUsedOrientation=function(n,s,o){for(var c=s===a.WritingMode.horizontal||s===a.WritingMode.horizontalOnly?s:0,v=s===a.WritingMode.vertical?s:0,w=0,S=[o.leftJustifiedTextSymbolIndex,o.centerJustifiedTextSymbolIndex,o.rightJustifiedTextSymbolIndex];w<S.length;w+=1)n.text.placedSymbolArray.get(S[w]).placedOrientation=c;o.verticalPlacedTextSymbolIndex&&(n.text.placedSymbolArray.get(o.verticalPlacedTextSymbolIndex).placedOrientation=v)},ji.prototype.commit=function(n){this.commitTime=n,this.zoomAtLastRecencyCheck=this.transform.zoom;var s=this.prevPlacement,o=!1;this.prevZoomAdjustment=s?s.zoomAdjustment(this.transform.zoom):0;var c=s?s.symbolFadeChange(n):1,v=s?s.opacities:{},w=s?s.variableOffsets:{},S=s?s.placedOrientations:{};for(var z in this.placements){var C=this.placements[z],O=v[z];O?(this.opacities[z]=new _n(O,c,C.text,C.icon),o=o||C.text!==O.text.placed||C.icon!==O.icon.placed):(this.opacities[z]=new _n(null,c,C.text,C.icon,C.skipFade),o=o||C.text||C.icon)}for(var Z in v){var G=v[Z];if(!this.opacities[Z]){var H=new _n(G,c,!1,!1);H.isHidden()||(this.opacities[Z]=H,o=o||G.text.placed||G.icon.placed)}}for(var re in w)this.variableOffsets[re]||!this.opacities[re]||this.opacities[re].isHidden()||(this.variableOffsets[re]=w[re]);for(var ee in S)this.placedOrientations[ee]||!this.opacities[ee]||this.opacities[ee].isHidden()||(this.placedOrientations[ee]=S[ee]);o?this.lastPlacementChangeTime=n:typeof this.lastPlacementChangeTime!="number"&&(this.lastPlacementChangeTime=s?s.lastPlacementChangeTime:n)},ji.prototype.updateLayerOpacities=function(n,s){for(var o={},c=0,v=s;c<v.length;c+=1){var w=v[c],S=w.getBucket(n);S&&w.latestFeatureIndex&&n.id===S.layerIds[0]&&this.updateBucketOpacities(S,o,w.collisionBoxArray)}},ji.prototype.updateBucketOpacities=function(n,s,o){var c=this;n.hasTextData()&&n.text.opacityVertexArray.clear(),n.hasIconData()&&n.icon.opacityVertexArray.clear(),n.hasIconCollisionBoxData()&&n.iconCollisionBox.collisionVertexArray.clear(),n.hasTextCollisionBoxData()&&n.textCollisionBox.collisionVertexArray.clear();var v=n.layers[0].layout,w=new _n(null,0,!1,!1,!0),S=v.get("text-allow-overlap"),z=v.get("icon-allow-overlap"),C=v.get("text-variable-anchor"),O=v.get("text-rotation-alignment")==="map",Z=v.get("text-pitch-alignment")==="map",G=v.get("icon-text-fit")!=="none",H=new _n(null,0,S&&(z||!n.hasIconData()||v.get("icon-optional")),z&&(S||!n.hasTextData()||v.get("text-optional")),!0);!n.collisionArrays&&o&&(n.hasIconCollisionBoxData()||n.hasTextCollisionBoxData())&&n.deserializeCollisionBoxes(o);for(var re=function(se,fe,_e){for(var Te=0;Te<fe/4;Te++)se.opacityVertexArray.emplaceBack(_e)},ee=function(se){var fe=n.symbolInstances.get(se),_e=fe.numHorizontalGlyphVertices,Te=fe.numVerticalGlyphVertices,Se=fe.crossTileID,Ae=c.opacities[Se];s[Se]?Ae=w:Ae||(c.opacities[Se]=Ae=H),s[Se]=!0;var Oe=fe.numIconVertices>0,He=c.placedOrientations[fe.crossTileID],Ze=He===a.WritingMode.vertical,ct=He===a.WritingMode.horizontal||He===a.WritingMode.horizontalOnly;if(_e>0||Te>0){var Et=Ns(Ae.text);re(n.text,_e,Ze?Va:Et),re(n.text,Te,ct?Va:Et);var Ct=Ae.text.isHidden();[fe.rightJustifiedTextSymbolIndex,fe.centerJustifiedTextSymbolIndex,fe.leftJustifiedTextSymbolIndex].forEach(function(Mt){Mt>=0&&(n.text.placedSymbolArray.get(Mt).hidden=Ct||Ze?1:0)}),fe.verticalPlacedTextSymbolIndex>=0&&(n.text.placedSymbolArray.get(fe.verticalPlacedTextSymbolIndex).hidden=Ct||ct?1:0);var It=c.variableOffsets[fe.crossTileID];It&&c.markUsedJustification(n,It.anchor,fe,He);var dr=c.placedOrientations[fe.crossTileID];dr&&(c.markUsedJustification(n,"left",fe,dr),c.markUsedOrientation(n,dr,fe))}if(Oe){var pt=Ns(Ae.icon),Ut=!(G&&fe.verticalPlacedIconSymbolIndex&&Ze);fe.placedIconSymbolIndex>=0&&(re(n.icon,fe.numIconVertices,Ut?pt:Va),n.icon.placedSymbolArray.get(fe.placedIconSymbolIndex).hidden=Ae.icon.isHidden()),fe.verticalPlacedIconSymbolIndex>=0&&(re(n.icon,fe.numVerticalIconVertices,Ut?Va:pt),n.icon.placedSymbolArray.get(fe.verticalPlacedIconSymbolIndex).hidden=Ae.icon.isHidden())}if(n.hasIconCollisionBoxData()||n.hasTextCollisionBoxData()){var Xt=n.collisionArrays[se];if(Xt){var Nt=new a.Point(0,0);if(Xt.textBox||Xt.verticalTextBox){var Bt=!0;if(C){var Ht=c.variableOffsets[Se];Ht?(Nt=zi(Ht.anchor,Ht.width,Ht.height,Ht.textOffset,Ht.textBoxScale),O&&Nt._rotate(Z?c.transform.angle:-c.transform.angle)):Bt=!1}Xt.textBox&&xa(n.textCollisionBox.collisionVertexArray,Ae.text.placed,!Bt||Ze,Nt.x,Nt.y),Xt.verticalTextBox&&xa(n.textCollisionBox.collisionVertexArray,Ae.text.placed,!Bt||ct,Nt.x,Nt.y)}var Rt=!!(!ct&&Xt.verticalIconBox);Xt.iconBox&&xa(n.iconCollisionBox.collisionVertexArray,Ae.icon.placed,Rt,G?Nt.x:0,G?Nt.y:0),Xt.verticalIconBox&&xa(n.iconCollisionBox.collisionVertexArray,Ae.icon.placed,!Rt,G?Nt.x:0,G?Nt.y:0)}}},le=0;le<n.symbolInstances.length;le++)ee(le);if(n.sortFeatures(this.transform.angle),this.retainedQueryData[n.bucketInstanceId]&&(this.retainedQueryData[n.bucketInstanceId].featureSortOrder=n.featureSortOrder),n.hasTextData()&&n.text.opacityVertexBuffer&&n.text.opacityVertexBuffer.updateData(n.text.opacityVertexArray),n.hasIconData()&&n.icon.opacityVertexBuffer&&n.icon.opacityVertexBuffer.updateData(n.icon.opacityVertexArray),n.hasIconCollisionBoxData()&&n.iconCollisionBox.collisionVertexBuffer&&n.iconCollisionBox.collisionVertexBuffer.updateData(n.iconCollisionBox.collisionVertexArray),n.hasTextCollisionBoxData()&&n.textCollisionBox.collisionVertexBuffer&&n.textCollisionBox.collisionVertexBuffer.updateData(n.textCollisionBox.collisionVertexArray),n.bucketInstanceId in this.collisionCircleArrays){var Y=this.collisionCircleArrays[n.bucketInstanceId];n.placementInvProjMatrix=Y.invProjMatrix,n.placementViewportMatrix=Y.viewportMatrix,n.collisionCircleArray=Y.circles,delete this.collisionCircleArrays[n.bucketInstanceId]}},ji.prototype.symbolFadeChange=function(n){return this.fadeDuration===0?1:(n-this.commitTime)/this.fadeDuration+this.prevZoomAdjustment},ji.prototype.zoomAdjustment=function(n){return Math.max(0,(this.transform.zoom-n)/1.5)},ji.prototype.hasTransitions=function(n){return this.stale||n-this.lastPlacementChangeTime<this.fadeDuration},ji.prototype.stillRecent=function(n,s){var o=this.zoomAtLastRecencyCheck===s?1-this.zoomAdjustment(s):1;return this.zoomAtLastRecencyCheck=s,this.commitTime+this.fadeDuration*o>n},ji.prototype.setStale=function(){this.stale=!0};var ss=Math.pow(2,25),Nl=Math.pow(2,24),co=Math.pow(2,17),Ul=Math.pow(2,16),Bo=Math.pow(2,9),Vl=Math.pow(2,8),Oo=Math.pow(2,1);function Ns(n){if(n.opacity===0&&!n.placed)return 0;if(n.opacity===1&&n.placed)return 4294967295;var s=n.placed?1:0,o=Math.floor(127*n.opacity);return o*ss+s*Nl+o*co+s*Ul+o*Bo+s*Vl+o*Oo+s}var Va=0,ls=function(n){this._sortAcrossTiles=n.layout.get("symbol-z-order")!=="viewport-y"&&n.layout.get("symbol-sort-key").constantOr(1)!==void 0,this._currentTileIndex=0,this._currentPartIndex=0,this._seenCrossTileIDs={},this._bucketParts=[]};ls.prototype.continuePlacement=function(n,s,o,c,v){for(var w=this._bucketParts;this._currentTileIndex<n.length;)if(s.getBucketParts(w,c,n[this._currentTileIndex],this._sortAcrossTiles),this._currentTileIndex++,v())return!0;for(this._sortAcrossTiles&&(this._sortAcrossTiles=!1,w.sort(function(S,z){return S.sortKey-z.sortKey}));this._currentPartIndex<w.length;)if(s.placeLayerBucketPart(w[this._currentPartIndex],this._seenCrossTileIDs,o),this._currentPartIndex++,v())return!0;return!1};var ho=function(n,s,o,c,v,w,S){this.placement=new ji(n,v,w,S),this._currentPlacementIndex=s.length-1,this._forceFullPlacement=o,this._showCollisionBoxes=c,this._done=!1};ho.prototype.isDone=function(){return this._done},ho.prototype.continuePlacement=function(n,s,o){for(var c=this,v=a.browser.now(),w=function(){var C=a.browser.now()-v;return!c._forceFullPlacement&&C>2};this._currentPlacementIndex>=0;){var S=s[n[this._currentPlacementIndex]],z=this.placement.collisionIndex.transform.zoom;if(S.type==="symbol"&&(!S.minzoom||S.minzoom<=z)&&(!S.maxzoom||S.maxzoom>z)){if(this._inProgressLayer||(this._inProgressLayer=new ls(S)),this._inProgressLayer.continuePlacement(o[S.source],this.placement,this._showCollisionBoxes,S,w))return;delete this._inProgressLayer}this._currentPlacementIndex--}this._done=!0},ho.prototype.commit=function(n){return this.placement.commit(n),this.placement};var Us=512/a.EXTENT/2,qa=function(n,s,o){this.tileID=n,this.indexedSymbolInstances={},this.bucketInstanceId=o;for(var c=0;c<s.length;c++){var v=s.get(c),w=v.key;this.indexedSymbolInstances[w]||(this.indexedSymbolInstances[w]=[]),this.indexedSymbolInstances[w].push({crossTileID:v.crossTileID,coord:this.getScaledCoordinates(v,n)})}};qa.prototype.getScaledCoordinates=function(n,s){var o=Us/Math.pow(2,s.canonical.z-this.tileID.canonical.z);return{x:Math.floor((s.canonical.x*a.EXTENT+n.anchorX)*o),y:Math.floor((s.canonical.y*a.EXTENT+n.anchorY)*o)}},qa.prototype.findMatches=function(n,s,o){for(var c=this.tileID.canonical.z<s.canonical.z?1:Math.pow(2,this.tileID.canonical.z-s.canonical.z),v=0;v<n.length;v++){var w=n.get(v);if(!w.crossTileID){var S=this.indexedSymbolInstances[w.key];if(S)for(var z=this.getScaledCoordinates(w,s),C=0,O=S;C<O.length;C+=1){var Z=O[C];if(Math.abs(Z.coord.x-z.x)<=c&&Math.abs(Z.coord.y-z.y)<=c&&!o[Z.crossTileID]){o[Z.crossTileID]=!0,w.crossTileID=Z.crossTileID;break}}}}};var On=function(){this.maxCrossTileID=0};On.prototype.generate=function(){return++this.maxCrossTileID};var wa=function(){this.indexes={},this.usedCrossTileIDs={},this.lng=0};wa.prototype.handleWrapJump=function(n){var s=Math.round((n-this.lng)/360);if(s!==0)for(var o in this.indexes){var c=this.indexes[o],v={};for(var w in c){var S=c[w];S.tileID=S.tileID.unwrapTo(S.tileID.wrap+s),v[S.tileID.key]=S}this.indexes[o]=v}this.lng=n},wa.prototype.addBucket=function(n,s,o){if(this.indexes[n.overscaledZ]&&this.indexes[n.overscaledZ][n.key]){if(this.indexes[n.overscaledZ][n.key].bucketInstanceId===s.bucketInstanceId)return!1;this.removeBucketCrossTileIDs(n.overscaledZ,this.indexes[n.overscaledZ][n.key])}for(var c=0;c<s.symbolInstances.length;c++)s.symbolInstances.get(c).crossTileID=0;this.usedCrossTileIDs[n.overscaledZ]||(this.usedCrossTileIDs[n.overscaledZ]={});var v=this.usedCrossTileIDs[n.overscaledZ];for(var w in this.indexes){var S=this.indexes[w];if(Number(w)>n.overscaledZ)for(var z in S){var C=S[z];C.tileID.isChildOf(n)&&C.findMatches(s.symbolInstances,n,v)}else{var O=S[n.scaledTo(Number(w)).key];O&&O.findMatches(s.symbolInstances,n,v)}}for(var Z=0;Z<s.symbolInstances.length;Z++){var G=s.symbolInstances.get(Z);G.crossTileID||(G.crossTileID=o.generate(),v[G.crossTileID]=!0)}return this.indexes[n.overscaledZ]===void 0&&(this.indexes[n.overscaledZ]={}),this.indexes[n.overscaledZ][n.key]=new qa(n,s.symbolInstances,s.bucketInstanceId),!0},wa.prototype.removeBucketCrossTileIDs=function(n,s){for(var o in s.indexedSymbolInstances)for(var c=0,v=s.indexedSymbolInstances[o];c<v.length;c+=1)delete this.usedCrossTileIDs[n][v[c].crossTileID]},wa.prototype.removeStaleBuckets=function(n){var s=!1;for(var o in this.indexes){var c=this.indexes[o];for(var v in c)n[c[v].bucketInstanceId]||(this.removeBucketCrossTileIDs(o,c[v]),delete c[v],s=!0)}return s};var ge=function(){this.layerIndexes={},this.crossTileIDs=new On,this.maxBucketInstanceId=0,this.bucketsInCurrentPlacement={}};ge.prototype.addLayer=function(n,s,o){var c=this.layerIndexes[n.id];c===void 0&&(c=this.layerIndexes[n.id]=new wa);var v=!1,w={};c.handleWrapJump(o);for(var S=0,z=s;S<z.length;S+=1){var C=z[S],O=C.getBucket(n);O&&n.id===O.layerIds[0]&&(O.bucketInstanceId||(O.bucketInstanceId=++this.maxBucketInstanceId),c.addBucket(C.tileID,O,this.crossTileIDs)&&(v=!0),w[O.bucketInstanceId]=!0)}return c.removeStaleBuckets(w)&&(v=!0),v},ge.prototype.pruneUnusedLayers=function(n){var s={};for(var o in n.forEach(function(c){s[c]=!0}),this.layerIndexes)s[o]||delete this.layerIndexes[o]};var un=function(n,s){return a.emitValidationErrors(n,s&&s.filter(function(o){return o.identifier!=="source.canvas"}))},Zi=a.pick(Ye,["addLayer","removeLayer","setPaintProperty","setLayoutProperty","setFilter","addSource","removeSource","setLayerZoomRange","setLight","setTransition","setGeoJSONSourceData"]),Zr=a.pick(Ye,["setCenter","setZoom","setBearing","setPitch"]),Sa=function(){var n={},s=a.styleSpec.$version;for(var o in a.styleSpec.$root){var c,v=a.styleSpec.$root[o];v.required&&(c=o==="version"?s:v.type==="array"?[]:{})!=null&&(n[o]=c)}return n}(),Fn=function(n){function s(o,c){var v=this;c===void 0&&(c={}),n.call(this),this.map=o,this.dispatcher=new At(ze(),this),this.imageManager=new xe,this.imageManager.setEventedParent(this),this.glyphManager=new dt(o._requestManager,c.localIdeographFontFamily),this.lineAtlas=new st(256,512),this.crossTileSymbolIndex=new ge,this._layers={},this._serializedLayers={},this._order=[],this.sourceCaches={},this.zoomHistory=new a.ZoomHistory,this._loaded=!1,this._availableImages=[],this._resetUpdates(),this.dispatcher.broadcast("setReferrer",a.getReferrer());var w=this;this._rtlTextPluginCallback=s.registerForPluginStateChange(function(S){w.dispatcher.broadcast("syncRTLPluginState",{pluginStatus:S.pluginStatus,pluginURL:S.pluginURL},function(z,C){if(a.triggerPluginCompletionEvent(z),C&&C.every(function(Z){return Z}))for(var O in w.sourceCaches)w.sourceCaches[O].reload()})}),this.on("data",function(S){if(S.dataType==="source"&&S.sourceDataType==="metadata"){var z=v.sourceCaches[S.sourceId];if(z){var C=z.getSource();if(C&&C.vectorLayerIds)for(var O in v._layers){var Z=v._layers[O];Z.source===C.id&&v._validateLayer(Z)}}}})}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype.loadURL=function(o,c){var v=this;c===void 0&&(c={}),this.fire(new a.Event("dataloading",{dataType:"style"}));var w=typeof c.validate=="boolean"?c.validate:!a.isMapboxURL(o);o=this.map._requestManager.normalizeStyleURL(o,c.accessToken);var S=this.map._requestManager.transformRequest(o,a.ResourceType.Style);this._request=a.getJSON(S,function(z,C){v._request=null,z?v.fire(new a.ErrorEvent(z)):C&&v._load(C,w)})},s.prototype.loadJSON=function(o,c){var v=this;c===void 0&&(c={}),this.fire(new a.Event("dataloading",{dataType:"style"})),this._request=a.browser.frame(function(){v._request=null,v._load(o,c.validate!==!1)})},s.prototype.loadEmpty=function(){this.fire(new a.Event("dataloading",{dataType:"style"})),this._load(Sa,!1)},s.prototype._load=function(o,c){if(!c||!un(this,a.validateStyle(o))){for(var v in this._loaded=!0,this.stylesheet=o,o.sources)this.addSource(v,o.sources[v],{validate:!1});o.sprite?this._loadSprite(o.sprite):this.imageManager.setLoaded(!0),this.glyphManager.setURL(o.glyphs);var w=Ge(this.stylesheet.layers);this._order=w.map(function(O){return O.id}),this._layers={},this._serializedLayers={};for(var S=0,z=w;S<z.length;S+=1){var C=z[S];(C=a.createStyleLayer(C)).setEventedParent(this,{layer:{id:C.id}}),this._layers[C.id]=C,this._serializedLayers[C.id]=C.serialize()}this.dispatcher.broadcast("setLayers",this._serializeLayers(this._order)),this.light=new Vt(this.stylesheet.light),this.fire(new a.Event("data",{dataType:"style"})),this.fire(new a.Event("style.load"))}},s.prototype._loadSprite=function(o){var c=this;this._spriteRequest=function(v,w,S){var z,C,O,Z=a.browser.devicePixelRatio>1?"@2x":"",G=a.getJSON(w.transformRequest(w.normalizeSpriteURL(v,Z,".json"),a.ResourceType.SpriteJSON),function(ee,le){G=null,O||(O=ee,z=le,re())}),H=a.getImage(w.transformRequest(w.normalizeSpriteURL(v,Z,".png"),a.ResourceType.SpriteImage),function(ee,le){H=null,O||(O=ee,C=le,re())});function re(){if(O)S(O);else if(z&&C){var ee=a.browser.getImageData(C),le={};for(var Y in z){var se=z[Y],fe=se.width,_e=se.height,Te=se.x,Se=se.y,Ae=se.sdf,Oe=se.pixelRatio,He=se.stretchX,Ze=se.stretchY,ct=se.content,Et=new a.RGBAImage({width:fe,height:_e});a.RGBAImage.copy(ee,Et,{x:Te,y:Se},{x:0,y:0},{width:fe,height:_e}),le[Y]={data:Et,pixelRatio:Oe,sdf:Ae,stretchX:He,stretchY:Ze,content:ct}}S(null,le)}}return{cancel:function(){G&&(G.cancel(),G=null),H&&(H.cancel(),H=null)}}}(o,this.map._requestManager,function(v,w){if(c._spriteRequest=null,v)c.fire(new a.ErrorEvent(v));else if(w)for(var S in w)c.imageManager.addImage(S,w[S]);c.imageManager.setLoaded(!0),c._availableImages=c.imageManager.listImages(),c.dispatcher.broadcast("setImages",c._availableImages),c.fire(new a.Event("data",{dataType:"style"}))})},s.prototype._validateLayer=function(o){var c=this.sourceCaches[o.source];if(c){var v=o.sourceLayer;if(v){var w=c.getSource();(w.type==="geojson"||w.vectorLayerIds&&w.vectorLayerIds.indexOf(v)===-1)&&this.fire(new a.ErrorEvent(new Error('Source layer "'+v+'" does not exist on source "'+w.id+'" as specified by style layer "'+o.id+'"')))}}},s.prototype.loaded=function(){if(!this._loaded||Object.keys(this._updatedSources).length)return!1;for(var o in this.sourceCaches)if(!this.sourceCaches[o].loaded())return!1;return!!this.imageManager.isLoaded()},s.prototype._serializeLayers=function(o){for(var c=[],v=0,w=o;v<w.length;v+=1){var S=this._layers[w[v]];S.type!=="custom"&&c.push(S.serialize())}return c},s.prototype.hasTransitions=function(){if(this.light&&this.light.hasTransition())return!0;for(var o in this.sourceCaches)if(this.sourceCaches[o].hasTransition())return!0;for(var c in this._layers)if(this._layers[c].hasTransition())return!0;return!1},s.prototype._checkLoaded=function(){if(!this._loaded)throw new Error("Style is not done loading")},s.prototype.update=function(o){if(this._loaded){var c=this._changed;if(this._changed){var v=Object.keys(this._updatedLayers),w=Object.keys(this._removedLayers);for(var S in(v.length||w.length)&&this._updateWorkerLayers(v,w),this._updatedSources){var z=this._updatedSources[S];z==="reload"?this._reloadSource(S):z==="clear"&&this._clearSource(S)}for(var C in this._updateTilesForChangedImages(),this._updatedPaintProps)this._layers[C].updateTransitions(o);this.light.updateTransitions(o),this._resetUpdates()}var O={};for(var Z in this.sourceCaches){var G=this.sourceCaches[Z];O[Z]=G.used,G.used=!1}for(var H=0,re=this._order;H<re.length;H+=1){var ee=this._layers[re[H]];ee.recalculate(o,this._availableImages),!ee.isHidden(o.zoom)&&ee.source&&(this.sourceCaches[ee.source].used=!0)}for(var le in O){var Y=this.sourceCaches[le];O[le]!==Y.used&&Y.fire(new a.Event("data",{sourceDataType:"visibility",dataType:"source",sourceId:le}))}this.light.recalculate(o),this.z=o.zoom,c&&this.fire(new a.Event("data",{dataType:"style"}))}},s.prototype._updateTilesForChangedImages=function(){var o=Object.keys(this._changedImages);if(o.length){for(var c in this.sourceCaches)this.sourceCaches[c].reloadTilesForDependencies(["icons","patterns"],o);this._changedImages={}}},s.prototype._updateWorkerLayers=function(o,c){this.dispatcher.broadcast("updateLayers",{layers:this._serializeLayers(o),removedIds:c})},s.prototype._resetUpdates=function(){this._changed=!1,this._updatedLayers={},this._removedLayers={},this._updatedSources={},this._updatedPaintProps={},this._changedImages={}},s.prototype.setState=function(o){var c=this;if(this._checkLoaded(),un(this,a.validateStyle(o)))return!1;(o=a.clone$1(o)).layers=Ge(o.layers);var v=function(S,z){if(!S)return[{command:Ye.setStyle,args:[z]}];var C=[];try{if(!a.deepEqual(S.version,z.version))return[{command:Ye.setStyle,args:[z]}];a.deepEqual(S.center,z.center)||C.push({command:Ye.setCenter,args:[z.center]}),a.deepEqual(S.zoom,z.zoom)||C.push({command:Ye.setZoom,args:[z.zoom]}),a.deepEqual(S.bearing,z.bearing)||C.push({command:Ye.setBearing,args:[z.bearing]}),a.deepEqual(S.pitch,z.pitch)||C.push({command:Ye.setPitch,args:[z.pitch]}),a.deepEqual(S.sprite,z.sprite)||C.push({command:Ye.setSprite,args:[z.sprite]}),a.deepEqual(S.glyphs,z.glyphs)||C.push({command:Ye.setGlyphs,args:[z.glyphs]}),a.deepEqual(S.transition,z.transition)||C.push({command:Ye.setTransition,args:[z.transition]}),a.deepEqual(S.light,z.light)||C.push({command:Ye.setLight,args:[z.light]});var O={},Z=[];(function(H,re,ee,le){var Y;for(Y in re=re||{},H=H||{})H.hasOwnProperty(Y)&&(re.hasOwnProperty(Y)||rt(Y,ee,le));for(Y in re)re.hasOwnProperty(Y)&&(H.hasOwnProperty(Y)?a.deepEqual(H[Y],re[Y])||(H[Y].type==="geojson"&&re[Y].type==="geojson"&&_r(H,re,Y)?ee.push({command:Ye.setGeoJSONSourceData,args:[Y,re[Y].data]}):Qt(Y,re,ee,le)):Pt(Y,re,ee))})(S.sources,z.sources,Z,O);var G=[];S.layers&&S.layers.forEach(function(H){O[H.source]?C.push({command:Ye.removeLayer,args:[H.id]}):G.push(H)}),C=C.concat(Z),function(H,re,ee){re=re||[];var le,Y,se,fe,_e,Te,Se,Ae=(H=H||[]).map(lr),Oe=re.map(lr),He=H.reduce($t,{}),Ze=re.reduce($t,{}),ct=Ae.slice(),Et=Object.create(null);for(le=0,Y=0;le<Ae.length;le++)Ze.hasOwnProperty(se=Ae[le])?Y++:(ee.push({command:Ye.removeLayer,args:[se]}),ct.splice(ct.indexOf(se,Y),1));for(le=0,Y=0;le<Oe.length;le++)ct[ct.length-1-le]!==(se=Oe[Oe.length-1-le])&&(He.hasOwnProperty(se)?(ee.push({command:Ye.removeLayer,args:[se]}),ct.splice(ct.lastIndexOf(se,ct.length-Y),1)):Y++,ee.push({command:Ye.addLayer,args:[Ze[se],Te=ct[ct.length-le]]}),ct.splice(ct.length-le,0,se),Et[se]=!0);for(le=0;le<Oe.length;le++)if(fe=He[se=Oe[le]],_e=Ze[se],!Et[se]&&!a.deepEqual(fe,_e))if(a.deepEqual(fe.source,_e.source)&&a.deepEqual(fe["source-layer"],_e["source-layer"])&&a.deepEqual(fe.type,_e.type)){for(Se in Kt(fe.layout,_e.layout,ee,se,null,Ye.setLayoutProperty),Kt(fe.paint,_e.paint,ee,se,null,Ye.setPaintProperty),a.deepEqual(fe.filter,_e.filter)||ee.push({command:Ye.setFilter,args:[se,_e.filter]}),a.deepEqual(fe.minzoom,_e.minzoom)&&a.deepEqual(fe.maxzoom,_e.maxzoom)||ee.push({command:Ye.setLayerZoomRange,args:[se,_e.minzoom,_e.maxzoom]}),fe)fe.hasOwnProperty(Se)&&Se!=="layout"&&Se!=="paint"&&Se!=="filter"&&Se!=="metadata"&&Se!=="minzoom"&&Se!=="maxzoom"&&(Se.indexOf("paint.")===0?Kt(fe[Se],_e[Se],ee,se,Se.slice(6),Ye.setPaintProperty):a.deepEqual(fe[Se],_e[Se])||ee.push({command:Ye.setLayerProperty,args:[se,Se,_e[Se]]}));for(Se in _e)_e.hasOwnProperty(Se)&&!fe.hasOwnProperty(Se)&&Se!=="layout"&&Se!=="paint"&&Se!=="filter"&&Se!=="metadata"&&Se!=="minzoom"&&Se!=="maxzoom"&&(Se.indexOf("paint.")===0?Kt(fe[Se],_e[Se],ee,se,Se.slice(6),Ye.setPaintProperty):a.deepEqual(fe[Se],_e[Se])||ee.push({command:Ye.setLayerProperty,args:[se,Se,_e[Se]]}))}else ee.push({command:Ye.removeLayer,args:[se]}),Te=ct[ct.lastIndexOf(se)+1],ee.push({command:Ye.addLayer,args:[_e,Te]})}(G,z.layers,C)}catch(H){console.warn("Unable to compute style diff:",H),C=[{command:Ye.setStyle,args:[z]}]}return C}(this.serialize(),o).filter(function(S){return!(S.command in Zr)});if(v.length===0)return!1;var w=v.filter(function(S){return!(S.command in Zi)});if(w.length>0)throw new Error("Unimplemented: "+w.map(function(S){return S.command}).join(", ")+".");return v.forEach(function(S){S.command!=="setTransition"&&c[S.command].apply(c,S.args)}),this.stylesheet=o,!0},s.prototype.addImage=function(o,c){if(this.getImage(o))return this.fire(new a.ErrorEvent(new Error("An image with this name already exists.")));this.imageManager.addImage(o,c),this._afterImageUpdated(o)},s.prototype.updateImage=function(o,c){this.imageManager.updateImage(o,c)},s.prototype.getImage=function(o){return this.imageManager.getImage(o)},s.prototype.removeImage=function(o){if(!this.getImage(o))return this.fire(new a.ErrorEvent(new Error("No image with this name exists.")));this.imageManager.removeImage(o),this._afterImageUpdated(o)},s.prototype._afterImageUpdated=function(o){this._availableImages=this.imageManager.listImages(),this._changedImages[o]=!0,this._changed=!0,this.dispatcher.broadcast("setImages",this._availableImages),this.fire(new a.Event("data",{dataType:"style"}))},s.prototype.listImages=function(){return this._checkLoaded(),this.imageManager.listImages()},s.prototype.addSource=function(o,c,v){var w=this;if(v===void 0&&(v={}),this._checkLoaded(),this.sourceCaches[o]!==void 0)throw new Error("There is already a source with this ID");if(!c.type)throw new Error("The type property must be defined, but only the following properties were given: "+Object.keys(c).join(", ")+".");if(!(["vector","raster","geojson","video","image"].indexOf(c.type)>=0&&this._validate(a.validateStyle.source,"sources."+o,c,null,v))){this.map&&this.map._collectResourceTiming&&(c.collectResourceTiming=!0);var S=this.sourceCaches[o]=new Q(o,c,this.dispatcher);S.style=this,S.setEventedParent(this,function(){return{isSourceLoaded:w.loaded(),source:S.serialize(),sourceId:o}}),S.onAdd(this.map),this._changed=!0}},s.prototype.removeSource=function(o){if(this._checkLoaded(),this.sourceCaches[o]===void 0)throw new Error("There is no source with this ID");for(var c in this._layers)if(this._layers[c].source===o)return this.fire(new a.ErrorEvent(new Error('Source "'+o+'" cannot be removed while layer "'+c+'" is using it.')));var v=this.sourceCaches[o];delete this.sourceCaches[o],delete this._updatedSources[o],v.fire(new a.Event("data",{sourceDataType:"metadata",dataType:"source",sourceId:o})),v.setEventedParent(null),v.clearTiles(),v.onRemove&&v.onRemove(this.map),this._changed=!0},s.prototype.setGeoJSONSourceData=function(o,c){this._checkLoaded(),this.sourceCaches[o].getSource().setData(c),this._changed=!0},s.prototype.getSource=function(o){return this.sourceCaches[o]&&this.sourceCaches[o].getSource()},s.prototype.addLayer=function(o,c,v){v===void 0&&(v={}),this._checkLoaded();var w=o.id;if(this.getLayer(w))this.fire(new a.ErrorEvent(new Error('Layer with id "'+w+'" already exists on this map')));else{var S;if(o.type==="custom"){if(un(this,a.validateCustomStyleLayer(o)))return;S=a.createStyleLayer(o)}else{if(typeof o.source=="object"&&(this.addSource(w,o.source),o=a.clone$1(o),o=a.extend(o,{source:w})),this._validate(a.validateStyle.layer,"layers."+w,o,{arrayIndex:-1},v))return;S=a.createStyleLayer(o),this._validateLayer(S),S.setEventedParent(this,{layer:{id:w}}),this._serializedLayers[S.id]=S.serialize()}var z=c?this._order.indexOf(c):this._order.length;if(c&&z===-1)this.fire(new a.ErrorEvent(new Error('Layer with id "'+c+'" does not exist on this map.')));else{if(this._order.splice(z,0,w),this._layerOrderChanged=!0,this._layers[w]=S,this._removedLayers[w]&&S.source&&S.type!=="custom"){var C=this._removedLayers[w];delete this._removedLayers[w],C.type!==S.type?this._updatedSources[S.source]="clear":(this._updatedSources[S.source]="reload",this.sourceCaches[S.source].pause())}this._updateLayer(S),S.onAdd&&S.onAdd(this.map)}}},s.prototype.moveLayer=function(o,c){if(this._checkLoaded(),this._changed=!0,this._layers[o]){if(o!==c){var v=this._order.indexOf(o);this._order.splice(v,1);var w=c?this._order.indexOf(c):this._order.length;c&&w===-1?this.fire(new a.ErrorEvent(new Error('Layer with id "'+c+'" does not exist on this map.'))):(this._order.splice(w,0,o),this._layerOrderChanged=!0)}}else this.fire(new a.ErrorEvent(new Error("The layer '"+o+"' does not exist in the map's style and cannot be moved.")))},s.prototype.removeLayer=function(o){this._checkLoaded();var c=this._layers[o];if(c){c.setEventedParent(null);var v=this._order.indexOf(o);this._order.splice(v,1),this._layerOrderChanged=!0,this._changed=!0,this._removedLayers[o]=c,delete this._layers[o],delete this._serializedLayers[o],delete this._updatedLayers[o],delete this._updatedPaintProps[o],c.onRemove&&c.onRemove(this.map)}else this.fire(new a.ErrorEvent(new Error("The layer '"+o+"' does not exist in the map's style and cannot be removed.")))},s.prototype.getLayer=function(o){return this._layers[o]},s.prototype.hasLayer=function(o){return o in this._layers},s.prototype.setLayerZoomRange=function(o,c,v){this._checkLoaded();var w=this.getLayer(o);w?w.minzoom===c&&w.maxzoom===v||(c!=null&&(w.minzoom=c),v!=null&&(w.maxzoom=v),this._updateLayer(w)):this.fire(new a.ErrorEvent(new Error("The layer '"+o+"' does not exist in the map's style and cannot have zoom extent.")))},s.prototype.setFilter=function(o,c,v){v===void 0&&(v={}),this._checkLoaded();var w=this.getLayer(o);if(w){if(!a.deepEqual(w.filter,c))return c==null?(w.filter=void 0,void this._updateLayer(w)):void(this._validate(a.validateStyle.filter,"layers."+w.id+".filter",c,null,v)||(w.filter=a.clone$1(c),this._updateLayer(w)))}else this.fire(new a.ErrorEvent(new Error("The layer '"+o+"' does not exist in the map's style and cannot be filtered.")))},s.prototype.getFilter=function(o){return a.clone$1(this.getLayer(o).filter)},s.prototype.setLayoutProperty=function(o,c,v,w){w===void 0&&(w={}),this._checkLoaded();var S=this.getLayer(o);S?a.deepEqual(S.getLayoutProperty(c),v)||(S.setLayoutProperty(c,v,w),this._updateLayer(S)):this.fire(new a.ErrorEvent(new Error("The layer '"+o+"' does not exist in the map's style and cannot be styled.")))},s.prototype.getLayoutProperty=function(o,c){var v=this.getLayer(o);if(v)return v.getLayoutProperty(c);this.fire(new a.ErrorEvent(new Error("The layer '"+o+"' does not exist in the map's style.")))},s.prototype.setPaintProperty=function(o,c,v,w){w===void 0&&(w={}),this._checkLoaded();var S=this.getLayer(o);S?a.deepEqual(S.getPaintProperty(c),v)||(S.setPaintProperty(c,v,w)&&this._updateLayer(S),this._changed=!0,this._updatedPaintProps[o]=!0):this.fire(new a.ErrorEvent(new Error("The layer '"+o+"' does not exist in the map's style and cannot be styled.")))},s.prototype.getPaintProperty=function(o,c){return this.getLayer(o).getPaintProperty(c)},s.prototype.setFeatureState=function(o,c){this._checkLoaded();var v=o.source,w=o.sourceLayer,S=this.sourceCaches[v];if(S!==void 0){var z=S.getSource().type;z==="geojson"&&w?this.fire(new a.ErrorEvent(new Error("GeoJSON sources cannot have a sourceLayer parameter."))):z!=="vector"||w?(o.id===void 0&&this.fire(new a.ErrorEvent(new Error("The feature id parameter must be provided."))),S.setFeatureState(w,o.id,c)):this.fire(new a.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")))}else this.fire(new a.ErrorEvent(new Error("The source '"+v+"' does not exist in the map's style.")))},s.prototype.removeFeatureState=function(o,c){this._checkLoaded();var v=o.source,w=this.sourceCaches[v];if(w!==void 0){var S=w.getSource().type,z=S==="vector"?o.sourceLayer:void 0;S!=="vector"||z?c&&typeof o.id!="string"&&typeof o.id!="number"?this.fire(new a.ErrorEvent(new Error("A feature id is required to remove its specific state property."))):w.removeFeatureState(z,o.id,c):this.fire(new a.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")))}else this.fire(new a.ErrorEvent(new Error("The source '"+v+"' does not exist in the map's style.")))},s.prototype.getFeatureState=function(o){this._checkLoaded();var c=o.source,v=o.sourceLayer,w=this.sourceCaches[c];if(w!==void 0){if(w.getSource().type!=="vector"||v)return o.id===void 0&&this.fire(new a.ErrorEvent(new Error("The feature id parameter must be provided."))),w.getFeatureState(v,o.id);this.fire(new a.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")))}else this.fire(new a.ErrorEvent(new Error("The source '"+c+"' does not exist in the map's style.")))},s.prototype.getTransition=function(){return a.extend({duration:300,delay:0},this.stylesheet&&this.stylesheet.transition)},s.prototype.serialize=function(){return a.filterObject({version:this.stylesheet.version,name:this.stylesheet.name,metadata:this.stylesheet.metadata,light:this.stylesheet.light,center:this.stylesheet.center,zoom:this.stylesheet.zoom,bearing:this.stylesheet.bearing,pitch:this.stylesheet.pitch,sprite:this.stylesheet.sprite,glyphs:this.stylesheet.glyphs,transition:this.stylesheet.transition,sources:a.mapObject(this.sourceCaches,function(o){return o.serialize()}),layers:this._serializeLayers(this._order)},function(o){return o!==void 0})},s.prototype._updateLayer=function(o){this._updatedLayers[o.id]=!0,o.source&&!this._updatedSources[o.source]&&this.sourceCaches[o.source].getSource().type!=="raster"&&(this._updatedSources[o.source]="reload",this.sourceCaches[o.source].pause()),this._changed=!0},s.prototype._flattenAndSortRenderedFeatures=function(o){for(var c=this,v=function(He){return c._layers[He].type==="fill-extrusion"},w={},S=[],z=this._order.length-1;z>=0;z--){var C=this._order[z];if(v(C)){w[C]=z;for(var O=0,Z=o;O<Z.length;O+=1){var G=Z[O][C];if(G)for(var H=0,re=G;H<re.length;H+=1)S.push(re[H])}}}S.sort(function(He,Ze){return Ze.intersectionZ-He.intersectionZ});for(var ee=[],le=this._order.length-1;le>=0;le--){var Y=this._order[le];if(v(Y))for(var se=S.length-1;se>=0;se--){var fe=S[se].feature;if(w[fe.layer.id]<le)break;ee.push(fe),S.pop()}else for(var _e=0,Te=o;_e<Te.length;_e+=1){var Se=Te[_e][Y];if(Se)for(var Ae=0,Oe=Se;Ae<Oe.length;Ae+=1)ee.push(Oe[Ae].feature)}}return ee},s.prototype.queryRenderedFeatures=function(o,c,v){c&&c.filter&&this._validate(a.validateStyle.filter,"queryRenderedFeatures.filter",c.filter,null,c);var w={};if(c&&c.layers){if(!Array.isArray(c.layers))return this.fire(new a.ErrorEvent(new Error("parameters.layers must be an Array."))),[];for(var S=0,z=c.layers;S<z.length;S+=1){var C=z[S],O=this._layers[C];if(!O)return this.fire(new a.ErrorEvent(new Error("The layer '"+C+"' does not exist in the map's style and cannot be queried for features."))),[];w[O.source]=!0}}var Z=[];for(var G in c.availableImages=this._availableImages,this.sourceCaches)c.layers&&!w[G]||Z.push(fr(this.sourceCaches[G],this._layers,this._serializedLayers,o,c,v));return this.placement&&Z.push(function(H,re,ee,le,Y,se,fe){for(var _e={},Te=se.queryRenderedSymbols(le),Se=[],Ae=0,Oe=Object.keys(Te).map(Number);Ae<Oe.length;Ae+=1)Se.push(fe[Oe[Ae]]);Se.sort(yi);for(var He=function(){var It=ct[Ze],dr=It.featureIndex.lookupSymbolFeatures(Te[It.bucketInstanceId],re,It.bucketIndex,It.sourceLayerIndex,Y.filter,Y.layers,Y.availableImages,H);for(var pt in dr){var Ut=_e[pt]=_e[pt]||[],Xt=dr[pt];Xt.sort(function(Ht,Rt){var Mt=It.featureSortOrder;if(Mt){var Bi=Mt.indexOf(Ht.featureIndex);return Mt.indexOf(Rt.featureIndex)-Bi}return Rt.featureIndex-Ht.featureIndex});for(var Nt=0,Bt=Xt;Nt<Bt.length;Nt+=1)Ut.push(Bt[Nt])}},Ze=0,ct=Se;Ze<ct.length;Ze+=1)He();var Et=function(It){_e[It].forEach(function(dr){var pt=dr.feature,Ut=ee[H[It].source].getFeatureState(pt.layer["source-layer"],pt.id);pt.source=pt.layer.source,pt.layer["source-layer"]&&(pt.sourceLayer=pt.layer["source-layer"]),pt.state=Ut})};for(var Ct in _e)Et(Ct);return _e}(this._layers,this._serializedLayers,this.sourceCaches,o,c,this.placement.collisionIndex,this.placement.retainedQueryData)),this._flattenAndSortRenderedFeatures(Z)},s.prototype.querySourceFeatures=function(o,c){c&&c.filter&&this._validate(a.validateStyle.filter,"querySourceFeatures.filter",c.filter,null,c);var v=this.sourceCaches[o];return v?function(w,S){for(var z=w.getRenderableIds().map(function(re){return w.getTileByID(re)}),C=[],O={},Z=0;Z<z.length;Z++){var G=z[Z],H=G.tileID.canonical.key;O[H]||(O[H]=!0,G.querySourceFeatures(C,S))}return C}(v,c):[]},s.prototype.addSourceType=function(o,c,v){return s.getSourceType(o)?v(new Error('A source type called "'+o+'" already exists.')):(s.setSourceType(o,c),c.workerSourceURL?void this.dispatcher.broadcast("loadWorkerSource",{name:o,url:c.workerSourceURL},v):v(null,null))},s.prototype.getLight=function(){return this.light.getLight()},s.prototype.setLight=function(o,c){c===void 0&&(c={}),this._checkLoaded();var v=this.light.getLight(),w=!1;for(var S in o)if(!a.deepEqual(o[S],v[S])){w=!0;break}if(w){var z={now:a.browser.now(),transition:a.extend({duration:300,delay:0},this.stylesheet.transition)};this.light.setLight(o,c),this.light.updateTransitions(z)}},s.prototype._validate=function(o,c,v,w,S){return S===void 0&&(S={}),(!S||S.validate!==!1)&&un(this,o.call(a.validateStyle,a.extend({key:c,style:this.serialize(),value:v,styleSpec:a.styleSpec},w)))},s.prototype._remove=function(){for(var o in this._request&&(this._request.cancel(),this._request=null),this._spriteRequest&&(this._spriteRequest.cancel(),this._spriteRequest=null),a.evented.off("pluginStateChange",this._rtlTextPluginCallback),this._layers)this._layers[o].setEventedParent(null);for(var c in this.sourceCaches)this.sourceCaches[c].clearTiles(),this.sourceCaches[c].setEventedParent(null);this.imageManager.setEventedParent(null),this.setEventedParent(null),this.dispatcher.remove()},s.prototype._clearSource=function(o){this.sourceCaches[o].clearTiles()},s.prototype._reloadSource=function(o){this.sourceCaches[o].resume(),this.sourceCaches[o].reload()},s.prototype._updateSources=function(o){for(var c in this.sourceCaches)this.sourceCaches[c].update(o)},s.prototype._generateCollisionBoxes=function(){for(var o in this.sourceCaches)this._reloadSource(o)},s.prototype._updatePlacement=function(o,c,v,w,S){S===void 0&&(S=!1);for(var z=!1,C=!1,O={},Z=0,G=this._order;Z<G.length;Z+=1){var H=this._layers[G[Z]];if(H.type==="symbol"){if(!O[H.source]){var re=this.sourceCaches[H.source];O[H.source]=re.getRenderableIds(!0).map(function(fe){return re.getTileByID(fe)}).sort(function(fe,_e){return _e.tileID.overscaledZ-fe.tileID.overscaledZ||(fe.tileID.isLessThan(_e.tileID)?-1:1)})}var ee=this.crossTileSymbolIndex.addLayer(H,O[H.source],o.center.lng);z=z||ee}}if(this.crossTileSymbolIndex.pruneUnusedLayers(this._order),((S=S||this._layerOrderChanged||v===0)||!this.pauseablePlacement||this.pauseablePlacement.isDone()&&!this.placement.stillRecent(a.browser.now(),o.zoom))&&(this.pauseablePlacement=new ho(o,this._order,S,c,v,w,this.placement),this._layerOrderChanged=!1),this.pauseablePlacement.isDone()?this.placement.setStale():(this.pauseablePlacement.continuePlacement(this._order,this._layers,O),this.pauseablePlacement.isDone()&&(this.placement=this.pauseablePlacement.commit(a.browser.now()),C=!0),z&&this.pauseablePlacement.placement.setStale()),C||z)for(var le=0,Y=this._order;le<Y.length;le+=1){var se=this._layers[Y[le]];se.type==="symbol"&&this.placement.updateLayerOpacities(se,O[se.source])}return!this.pauseablePlacement.isDone()||this.placement.hasTransitions(a.browser.now())},s.prototype._releaseSymbolFadeTiles=function(){for(var o in this.sourceCaches)this.sourceCaches[o].releaseSymbolFadeTiles()},s.prototype.getImages=function(o,c,v){this.imageManager.getImages(c.icons,v),this._updateTilesForChangedImages();var w=this.sourceCaches[c.source];w&&w.setDependencies(c.tileID.key,c.type,c.icons)},s.prototype.getGlyphs=function(o,c,v){this.glyphManager.getGlyphs(c.stacks,v)},s.prototype.getResource=function(o,c,v){return a.makeRequest(c,v)},s}(a.Evented);Fn.getSourceType=function(n){return Vr[n]},Fn.setSourceType=function(n,s){Vr[n]=s},Fn.registerForPluginStateChange=a.registerForPluginStateChange;var vi=a.createLayout([{name:"a_pos",type:"Int16",components:2}]),Fo=Dr(`#ifdef GL_ES
precision mediump float;
#else
#if !defined(lowp)
#define lowp
#endif
#if !defined(mediump)
#define mediump
#endif
#if !defined(highp)
#define highp
#endif
#endif`,`#ifdef GL_ES
precision highp float;
#else
#if !defined(lowp)
#define lowp
#endif
#if !defined(mediump)
#define mediump
#endif
#if !defined(highp)
#define highp
#endif
#endif
vec2 unpack_float(const float packedValue) {int packedIntValue=int(packedValue);int v0=packedIntValue/256;return vec2(v0,packedIntValue-v0*256);}vec2 unpack_opacity(const float packedOpacity) {int intOpacity=int(packedOpacity)/2;return vec2(float(intOpacity)/127.0,mod(packedOpacity,2.0));}vec4 decode_color(const vec2 encodedColor) {return vec4(unpack_float(encodedColor[0])/255.0,unpack_float(encodedColor[1])/255.0
);}float unpack_mix_vec2(const vec2 packedValue,const float t) {return mix(packedValue[0],packedValue[1],t);}vec4 unpack_mix_color(const vec4 packedColors,const float t) {vec4 minColor=decode_color(vec2(packedColors[0],packedColors[1]));vec4 maxColor=decode_color(vec2(packedColors[2],packedColors[3]));return mix(minColor,maxColor,t);}vec2 get_pattern_pos(const vec2 pixel_coord_upper,const vec2 pixel_coord_lower,const vec2 pattern_size,const float tile_units_to_pixels,const vec2 pos) {vec2 offset=mod(mod(mod(pixel_coord_upper,pattern_size)*256.0,pattern_size)*256.0+pixel_coord_lower,pattern_size);return (tile_units_to_pixels*pos+offset)/pattern_size;}`),ic=Dr(`uniform vec4 u_color;uniform float u_opacity;void main() {gl_FragColor=u_color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),Uh=Dr(`uniform vec2 u_pattern_tl_a;uniform vec2 u_pattern_br_a;uniform vec2 u_pattern_tl_b;uniform vec2 u_pattern_br_b;uniform vec2 u_texsize;uniform float u_mix;uniform float u_opacity;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;void main() {vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(u_pattern_tl_a/u_texsize,u_pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(u_pattern_tl_b/u_texsize,u_pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);gl_FragColor=mix(color1,color2,u_mix)*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_pattern_size_a;uniform vec2 u_pattern_size_b;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_scale_a;uniform float u_scale_b;uniform float u_tile_units_to_pixels;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_a*u_pattern_size_a,u_tile_units_to_pixels,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_b*u_pattern_size_b,u_tile_units_to_pixels,a_pos);}"),Vh=Dr(`varying vec3 v_data;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=v_data.xy;float extrude_length=length(extrude);lowp float antialiasblur=v_data.z;float antialiased_blur=-max(blur,antialiasblur);float opacity_t=smoothstep(0.0,antialiased_blur,extrude_length-1.0);float color_t=stroke_width < 0.01 ? 0.0 : smoothstep(antialiased_blur,0.0,extrude_length-radius/(radius+stroke_width));gl_FragColor=opacity_t*mix(color*opacity,stroke_color*stroke_opacity,color_t);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform bool u_scale_with_map;uniform bool u_pitch_with_map;uniform vec2 u_extrude_scale;uniform lowp float u_device_pixel_ratio;uniform highp float u_camera_to_center_distance;attribute vec2 a_pos;varying vec3 v_data;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
void main(void) {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=vec2(mod(a_pos,2.0)*2.0-1.0);vec2 circle_center=floor(a_pos*0.5);if (u_pitch_with_map) {vec2 corner_position=circle_center;if (u_scale_with_map) {corner_position+=extrude*(radius+stroke_width)*u_extrude_scale;} else {vec4 projected_center=u_matrix*vec4(circle_center,0,1);corner_position+=extrude*(radius+stroke_width)*u_extrude_scale*(projected_center.w/u_camera_to_center_distance);}gl_Position=u_matrix*vec4(corner_position,0,1);} else {gl_Position=u_matrix*vec4(circle_center,0,1);if (u_scale_with_map) {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*u_camera_to_center_distance;} else {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*gl_Position.w;}}lowp float antialiasblur=1.0/u_device_pixel_ratio/(radius+stroke_width);v_data=vec3(extrude.x,extrude.y,antialiasblur);}`),ql=Dr("void main() {gl_FragColor=vec4(1.0);}","attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),jl=Dr(`uniform highp float u_intensity;varying vec2 v_extrude;
#pragma mapbox: define highp float weight
#define GAUSS_COEF 0.3989422804014327
void main() {
#pragma mapbox: initialize highp float weight
float d=-0.5*3.0*3.0*dot(v_extrude,v_extrude);float val=weight*u_intensity*GAUSS_COEF*exp(d);gl_FragColor=vec4(val,1.0,1.0,1.0);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform float u_extrude_scale;uniform float u_opacity;uniform float u_intensity;attribute vec2 a_pos;varying vec2 v_extrude;
#pragma mapbox: define highp float weight
#pragma mapbox: define mediump float radius
const highp float ZERO=1.0/255.0/16.0;
#define GAUSS_COEF 0.3989422804014327
void main(void) {
#pragma mapbox: initialize highp float weight
#pragma mapbox: initialize mediump float radius
vec2 unscaled_extrude=vec2(mod(a_pos,2.0)*2.0-1.0);float S=sqrt(-2.0*log(ZERO/weight/u_intensity/GAUSS_COEF))/3.0;v_extrude=S*unscaled_extrude;vec2 extrude=v_extrude*radius*u_extrude_scale;vec4 pos=vec4(floor(a_pos*0.5)+extrude,0,1);gl_Position=u_matrix*pos;}`),Zl=Dr(`uniform sampler2D u_image;uniform sampler2D u_color_ramp;uniform float u_opacity;varying vec2 v_pos;void main() {float t=texture2D(u_image,v_pos).r;vec4 color=texture2D(u_color_ramp,vec2(t,0.5));gl_FragColor=color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(0.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_world;attribute vec2 a_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos*u_world,0,1);v_pos.x=a_pos.x;v_pos.y=1.0-a_pos.y;}"),Gl=Dr("varying float v_placed;varying float v_notUsed;void main() {float alpha=0.5;gl_FragColor=vec4(1.0,0.0,0.0,1.0)*alpha;if (v_placed > 0.5) {gl_FragColor=vec4(0.0,0.0,1.0,0.5)*alpha;}if (v_notUsed > 0.5) {gl_FragColor*=.1;}}","attribute vec2 a_pos;attribute vec2 a_anchor_pos;attribute vec2 a_extrude;attribute vec2 a_placed;attribute vec2 a_shift;uniform mat4 u_matrix;uniform vec2 u_extrude_scale;uniform float u_camera_to_center_distance;varying float v_placed;varying float v_notUsed;void main() {vec4 projectedPoint=u_matrix*vec4(a_anchor_pos,0,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float collision_perspective_ratio=clamp(0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,4.0);gl_Position=u_matrix*vec4(a_pos,0.0,1.0);gl_Position.xy+=(a_extrude+a_shift)*u_extrude_scale*gl_Position.w*collision_perspective_ratio;v_placed=a_placed.x;v_notUsed=a_placed.y;}"),nc=Dr("varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;void main() {float alpha=0.5*min(v_perspective_ratio,1.0);float stroke_radius=0.9*max(v_perspective_ratio,1.0);float distance_to_center=length(v_extrude);float distance_to_edge=abs(distance_to_center-v_radius);float opacity_t=smoothstep(-stroke_radius,0.0,-distance_to_edge);vec4 color=mix(vec4(0.0,0.0,1.0,0.5),vec4(1.0,0.0,0.0,1.0),v_collision);gl_FragColor=color*alpha*opacity_t;}","attribute vec2 a_pos;attribute float a_radius;attribute vec2 a_flags;uniform mat4 u_matrix;uniform mat4 u_inv_matrix;uniform vec2 u_viewport_size;uniform float u_camera_to_center_distance;varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;vec3 toTilePosition(vec2 screenPos) {vec4 rayStart=u_inv_matrix*vec4(screenPos,-1.0,1.0);vec4 rayEnd  =u_inv_matrix*vec4(screenPos, 1.0,1.0);rayStart.xyz/=rayStart.w;rayEnd.xyz  /=rayEnd.w;highp float t=(0.0-rayStart.z)/(rayEnd.z-rayStart.z);return mix(rayStart.xyz,rayEnd.xyz,t);}void main() {vec2 quadCenterPos=a_pos;float radius=a_radius;float collision=a_flags.x;float vertexIdx=a_flags.y;vec2 quadVertexOffset=vec2(mix(-1.0,1.0,float(vertexIdx >=2.0)),mix(-1.0,1.0,float(vertexIdx >=1.0 && vertexIdx <=2.0)));vec2 quadVertexExtent=quadVertexOffset*radius;vec3 tilePos=toTilePosition(quadCenterPos);vec4 clipPos=u_matrix*vec4(tilePos,1.0);highp float camera_to_anchor_distance=clipPos.w;highp float collision_perspective_ratio=clamp(0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,4.0);float padding_factor=1.2;v_radius=radius;v_extrude=quadVertexExtent*padding_factor;v_perspective_ratio=collision_perspective_ratio;v_collision=collision;gl_Position=vec4(clipPos.xyz/clipPos.w,1.0)+vec4(quadVertexExtent*padding_factor/u_viewport_size*2.0,0.0,0.0);}"),ac=Dr("uniform highp vec4 u_color;uniform sampler2D u_overlay;varying vec2 v_uv;void main() {vec4 overlay_color=texture2D(u_overlay,v_uv);gl_FragColor=mix(u_color,overlay_color,overlay_color.a);}","attribute vec2 a_pos;varying vec2 v_uv;uniform mat4 u_matrix;uniform float u_overlay_scale;void main() {v_uv=a_pos/8192.0;gl_Position=u_matrix*vec4(a_pos*u_overlay_scale,0,1);}"),qh=Dr(`#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
gl_FragColor=color*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec2 a_pos;uniform mat4 u_matrix;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
gl_Position=u_matrix*vec4(a_pos,0,1);}`),us=Dr(`varying vec2 v_pos;
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);gl_FragColor=outline_color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec2 a_pos;uniform mat4 u_matrix;uniform vec2 u_world;varying vec2 v_pos;
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;}`),cs=Dr(`uniform vec2 u_texsize;uniform sampler2D u_image;uniform float u_fade;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec2 v_pos;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);gl_FragColor=mix(color1,color2,u_fade)*alpha*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_world;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec2 v_pos;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;gl_Position=u_matrix*vec4(a_pos,0,1);vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,a_pos);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;}`),oc=Dr(`uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);gl_FragColor=mix(color1,color2,u_fade)*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;gl_Position=u_matrix*vec4(a_pos,0,1);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileZoomRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileZoomRatio,a_pos);}`),Qi=Dr(`varying vec4 v_color;void main() {gl_FragColor=v_color;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;uniform float u_vertical_gradient;uniform lowp float u_opacity;attribute vec2 a_pos;attribute vec4 a_normal_ed;varying vec4 v_color;
#pragma mapbox: define highp float base
#pragma mapbox: define highp float height
#pragma mapbox: define highp vec4 color
void main() {
#pragma mapbox: initialize highp float base
#pragma mapbox: initialize highp float height
#pragma mapbox: initialize highp vec4 color
vec3 normal=a_normal_ed.xyz;base=max(0.0,base);height=max(0.0,height);float t=mod(normal.x,2.0);gl_Position=u_matrix*vec4(a_pos,t > 0.0 ? height : base,1);float colorvalue=color.r*0.2126+color.g*0.7152+color.b*0.0722;v_color=vec4(0.0,0.0,0.0,1.0);vec4 ambientlight=vec4(0.03,0.03,0.03,1.0);color+=ambientlight;float directional=clamp(dot(normal/16384.0,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_color.r+=clamp(color.r*directional*u_lightcolor.r,mix(0.0,0.3,1.0-u_lightcolor.r),1.0);v_color.g+=clamp(color.g*directional*u_lightcolor.g,mix(0.0,0.3,1.0-u_lightcolor.g),1.0);v_color.b+=clamp(color.b*directional*u_lightcolor.b,mix(0.0,0.3,1.0-u_lightcolor.b),1.0);v_color*=u_opacity;}`),Kl=Dr(`uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec4 v_lighting;
#pragma mapbox: define lowp float base
#pragma mapbox: define lowp float height
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float base
#pragma mapbox: initialize lowp float height
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);vec4 mixedColor=mix(color1,color2,u_fade);gl_FragColor=mixedColor*v_lighting;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_height_factor;uniform vec3 u_scale;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;attribute vec2 a_pos;attribute vec4 a_normal_ed;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec4 v_lighting;
#pragma mapbox: define lowp float base
#pragma mapbox: define lowp float height
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float base
#pragma mapbox: initialize lowp float height
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec3 normal=a_normal_ed.xyz;float edgedistance=a_normal_ed.w;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;base=max(0.0,base);height=max(0.0,height);float t=mod(normal.x,2.0);float z=t > 0.0 ? height : base;gl_Position=u_matrix*vec4(a_pos,z,1);vec2 pos=normal.x==1.0 && normal.y==0.0 && normal.z==16384.0
? a_pos
: vec2(edgedistance,z*u_height_factor);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,pos);v_lighting=vec4(0.0,0.0,0.0,1.0);float directional=clamp(dot(normal/16383.0,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((0.5+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_lighting.rgb+=clamp(directional*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_lighting*=u_opacity;}`),ja=Dr(`#ifdef GL_ES
precision highp float;
#endif
uniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_dimension;uniform float u_zoom;uniform vec4 u_unpack;float getElevation(vec2 coord,float bias) {vec4 data=texture2D(u_image,coord)*255.0;data.a=-1.0;return dot(data,u_unpack)/4.0;}void main() {vec2 epsilon=1.0/u_dimension;float a=getElevation(v_pos+vec2(-epsilon.x,-epsilon.y),0.0);float b=getElevation(v_pos+vec2(0,-epsilon.y),0.0);float c=getElevation(v_pos+vec2(epsilon.x,-epsilon.y),0.0);float d=getElevation(v_pos+vec2(-epsilon.x,0),0.0);float e=getElevation(v_pos,0.0);float f=getElevation(v_pos+vec2(epsilon.x,0),0.0);float g=getElevation(v_pos+vec2(-epsilon.x,epsilon.y),0.0);float h=getElevation(v_pos+vec2(0,epsilon.y),0.0);float i=getElevation(v_pos+vec2(epsilon.x,epsilon.y),0.0);float exaggerationFactor=u_zoom < 2.0 ? 0.4 : u_zoom < 4.5 ? 0.35 : 0.3;float exaggeration=u_zoom < 15.0 ? (u_zoom-15.0)*exaggerationFactor : 0.0;vec2 deriv=vec2((c+f+f+i)-(a+d+d+g),(g+h+h+i)-(a+b+b+c))/pow(2.0,exaggeration+(19.2562-u_zoom));gl_FragColor=clamp(vec4(deriv.x/2.0+0.5,deriv.y/2.0+0.5,1.0,1.0),0.0,1.0);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_dimension;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);highp vec2 epsilon=1.0/u_dimension;float scale=(u_dimension.x-2.0)/u_dimension.x;v_pos=(a_texture_pos/8192.0)*scale+epsilon;}"),Za=Dr(`uniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_latrange;uniform vec2 u_light;uniform vec4 u_shadow;uniform vec4 u_highlight;uniform vec4 u_accent;
#define PI 3.141592653589793
void main() {vec4 pixel=texture2D(u_image,v_pos);vec2 deriv=((pixel.rg*2.0)-1.0);float scaleFactor=cos(radians((u_latrange[0]-u_latrange[1])*(1.0-v_pos.y)+u_latrange[1]));float slope=atan(1.25*length(deriv)/scaleFactor);float aspect=deriv.x !=0.0 ? atan(deriv.y,-deriv.x) : PI/2.0*(deriv.y > 0.0 ? 1.0 :-1.0);float intensity=u_light.x;float azimuth=u_light.y+PI;float base=1.875-intensity*1.75;float maxValue=0.5*PI;float scaledSlope=intensity !=0.5 ? ((pow(base,slope)-1.0)/(pow(base,maxValue)-1.0))*maxValue : slope;float accent=cos(scaledSlope);vec4 accent_color=(1.0-accent)*u_accent*clamp(intensity*2.0,0.0,1.0);float shade=abs(mod((aspect+azimuth)/PI+0.5,2.0)-1.0);vec4 shade_color=mix(u_shadow,u_highlight,shade)*sin(scaledSlope)*clamp(intensity*2.0,0.0,1.0);gl_FragColor=accent_color*(1.0-shade_color.a)+shade_color;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=a_texture_pos/8192.0;}"),po=Dr(`uniform lowp float u_device_pixel_ratio;varying vec2 v_width2;varying vec2 v_normal;varying float v_gamma_scale;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);gl_FragColor=color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
attribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform vec2 u_units_to_pixels;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_gamma_scale;varying highp float v_linesofar;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;v_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*2.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;v_width2=vec2(outset,inset);}`),fo=Dr(`uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;varying vec2 v_width2;varying vec2 v_normal;varying float v_gamma_scale;varying highp vec2 v_uv;
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);vec4 color=texture2D(u_image,v_uv);gl_FragColor=color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
attribute vec2 a_pos_normal;attribute vec4 a_data;attribute float a_uv_x;attribute float a_split_index;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_units_to_pixels;uniform float u_image_height;varying vec2 v_normal;varying vec2 v_width2;varying float v_gamma_scale;varying highp vec2 v_uv;
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;highp float texel_height=1.0/u_image_height;highp float half_texel_height=0.5*texel_height;v_uv=vec2(a_uv_x,a_split_index*texel_height-half_texel_height);vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;v_width2=vec2(outset,inset);}`),Ga=Dr(`uniform lowp float u_device_pixel_ratio;uniform vec2 u_texsize;uniform float u_fade;uniform mediump vec3 u_scale;uniform sampler2D u_image;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;vec2 pattern_size_a=vec2(display_size_a.x*fromScale/tileZoomRatio,display_size_a.y);vec2 pattern_size_b=vec2(display_size_b.x*toScale/tileZoomRatio,display_size_b.y);float aspect_a=display_size_a.y/v_width;float aspect_b=display_size_b.y/v_width;float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float x_a=mod(v_linesofar/pattern_size_a.x*aspect_a,1.0);float x_b=mod(v_linesofar/pattern_size_b.x*aspect_b,1.0);float y=0.5*v_normal.y+0.5;vec2 texel_size=1.0/u_texsize;vec2 pos_a=mix(pattern_tl_a*texel_size-texel_size,pattern_br_a*texel_size+texel_size,vec2(x_a,y));vec2 pos_b=mix(pattern_tl_b*texel_size-texel_size,pattern_br_b*texel_size+texel_size,vec2(x_b,y));vec4 color=mix(texture2D(u_image,pos_a),texture2D(u_image,pos_b),u_fade);gl_FragColor=color*alpha*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
#define LINE_DISTANCE_SCALE 2.0
attribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform vec2 u_units_to_pixels;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;v_linesofar=a_linesofar;v_width2=vec2(outset,inset);v_width=floorwidth;}`),mo=Dr(`uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;uniform float u_sdfgamma;uniform float u_mix;varying vec2 v_normal;varying vec2 v_width2;varying vec2 v_tex_a;varying vec2 v_tex_b;varying float v_gamma_scale;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float sdfdist_a=texture2D(u_image,v_tex_a).a;float sdfdist_b=texture2D(u_image,v_tex_b).a;float sdfdist=mix(sdfdist_a,sdfdist_b,u_mix);alpha*=smoothstep(0.5-u_sdfgamma/floorwidth,0.5+u_sdfgamma/floorwidth,sdfdist);gl_FragColor=color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
#define LINE_DISTANCE_SCALE 2.0
attribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_patternscale_a;uniform float u_tex_y_a;uniform vec2 u_patternscale_b;uniform float u_tex_y_b;uniform vec2 u_units_to_pixels;varying vec2 v_normal;varying vec2 v_width2;varying vec2 v_tex_a;varying vec2 v_tex_b;varying float v_gamma_scale;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;v_tex_a=vec2(a_linesofar*u_patternscale_a.x/floorwidth,normal.y*u_patternscale_a.y+u_tex_y_a);v_tex_b=vec2(a_linesofar*u_patternscale_b.x/floorwidth,normal.y*u_patternscale_b.y+u_tex_y_b);v_width2=vec2(outset,inset);}`),yo=Dr(`uniform float u_fade_t;uniform float u_opacity;uniform sampler2D u_image0;uniform sampler2D u_image1;varying vec2 v_pos0;varying vec2 v_pos1;uniform float u_brightness_low;uniform float u_brightness_high;uniform float u_saturation_factor;uniform float u_contrast_factor;uniform vec3 u_spin_weights;void main() {vec4 color0=texture2D(u_image0,v_pos0);vec4 color1=texture2D(u_image1,v_pos1);if (color0.a > 0.0) {color0.rgb=color0.rgb/color0.a;}if (color1.a > 0.0) {color1.rgb=color1.rgb/color1.a;}vec4 color=mix(color0,color1,u_fade_t);color.a*=u_opacity;vec3 rgb=color.rgb;rgb=vec3(dot(rgb,u_spin_weights.xyz),dot(rgb,u_spin_weights.zxy),dot(rgb,u_spin_weights.yzx));float average=(color.r+color.g+color.b)/3.0;rgb+=(average-rgb)*u_saturation_factor;rgb=(rgb-0.5)*u_contrast_factor+0.5;vec3 u_high_vec=vec3(u_brightness_low,u_brightness_low,u_brightness_low);vec3 u_low_vec=vec3(u_brightness_high,u_brightness_high,u_brightness_high);gl_FragColor=vec4(mix(u_high_vec,u_low_vec,rgb)*color.a,color.a);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_tl_parent;uniform float u_scale_parent;uniform float u_buffer_scale;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos0;varying vec2 v_pos1;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos0=(((a_texture_pos/8192.0)-0.5)/u_buffer_scale )+0.5;v_pos1=(v_pos0*u_scale_parent)+u_tl_parent;}"),Ka=Dr(`uniform sampler2D u_texture;varying vec2 v_tex;varying float v_fade_opacity;
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float opacity
lowp float alpha=opacity*v_fade_opacity;gl_FragColor=texture2D(u_texture,v_tex)*alpha;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`const float PI=3.141592653589793;attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec4 a_pixeloffset;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform highp float u_camera_to_center_distance;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform float u_fade_change;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform vec2 u_texsize;varying vec2 v_tex;varying float v_fade_opacity;
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float opacity
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;vec2 a_minFontScale=a_pixeloffset.zw/256.0;highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec4 projectedPoint=u_matrix*vec4(a_pos,0,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),0,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,0.0,1.0);gl_Position=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*max(a_minFontScale,fontScale)+a_pxoffset/16.0),0.0,1.0);v_tex=a_tex/u_texsize;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;v_fade_opacity=max(0.0,min(1.0,fade_opacity[0]+fade_change));}`),sc=Dr(`#define SDF_PX 8.0
uniform bool u_is_halo;uniform sampler2D u_texture;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;uniform bool u_is_text;varying vec2 v_data0;varying vec3 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
float EDGE_GAMMA=0.105/u_device_pixel_ratio;vec2 tex=v_data0.xy;float gamma_scale=v_data1.x;float size=v_data1.y;float fade_opacity=v_data1[2];float fontScale=u_is_text ? size/24.0 : size;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);gl_FragColor=color*(alpha*opacity*fade_opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`const float PI=3.141592653589793;attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec4 a_pixeloffset;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;varying vec2 v_data0;varying vec3 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec4 projectedPoint=u_matrix*vec4(a_pos,0,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),0,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,0.0,1.0);gl_Position=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale+a_pxoffset),0.0,1.0);float gamma_scale=gl_Position.w;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(1.0,fade_opacity[0]+fade_change));v_data0=a_tex/u_texsize;v_data1=vec3(gamma_scale,size,interpolated_fade_opacity);}`),lc=Dr(`#define SDF_PX 8.0
#define SDF 1.0
#define ICON 0.0
uniform bool u_is_halo;uniform sampler2D u_texture;uniform sampler2D u_texture_icon;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;varying vec4 v_data0;varying vec4 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
float fade_opacity=v_data1[2];if (v_data1.w==ICON) {vec2 tex_icon=v_data0.zw;lowp float alpha=opacity*fade_opacity;gl_FragColor=texture2D(u_texture_icon,tex_icon)*alpha;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
return;}vec2 tex=v_data0.xy;float EDGE_GAMMA=0.105/u_device_pixel_ratio;float gamma_scale=v_data1.x;float size=v_data1.y;float fontScale=size/24.0;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);gl_FragColor=color*(alpha*opacity*fade_opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`const float PI=3.141592653589793;attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec2 u_texsize_icon;varying vec4 v_data0;varying vec4 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);float is_sdf=a_size[0]-2.0*a_size_min;highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec4 projectedPoint=u_matrix*vec4(a_pos,0,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=size/24.0;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),0,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,0.0,1.0);gl_Position=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale),0.0,1.0);float gamma_scale=gl_Position.w;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(1.0,fade_opacity[0]+fade_change));v_data0.xy=a_tex/u_texsize;v_data0.zw=a_tex/u_texsize_icon;v_data1=vec4(gamma_scale,size,interpolated_fade_opacity,is_sdf);}`);function Dr(n,s){var o=/#pragma mapbox: ([\w]+) ([\w]+) ([\w]+) ([\w]+)/g,c=s.match(/attribute ([\w]+) ([\w]+)/g),v=n.match(/uniform ([\w]+) ([\w]+)([\s]*)([\w]*)/g),w=s.match(/uniform ([\w]+) ([\w]+)([\s]*)([\w]*)/g),S=w?w.concat(v):v,z={};return{fragmentSource:n=n.replace(o,function(C,O,Z,G,H){return z[H]=!0,O==="define"?`
#ifndef HAS_UNIFORM_u_`+H+`
varying `+Z+" "+G+" "+H+`;
#else
uniform `+Z+" "+G+" u_"+H+`;
#endif
`:`
#ifdef HAS_UNIFORM_u_`+H+`
    `+Z+" "+G+" "+H+" = u_"+H+`;
#endif
`}),vertexSource:s=s.replace(o,function(C,O,Z,G,H){var re=G==="float"?"vec2":"vec4",ee=H.match(/color/)?"color":re;return z[H]?O==="define"?`
#ifndef HAS_UNIFORM_u_`+H+`
uniform lowp float u_`+H+`_t;
attribute `+Z+" "+re+" a_"+H+`;
varying `+Z+" "+G+" "+H+`;
#else
uniform `+Z+" "+G+" u_"+H+`;
#endif
`:ee==="vec4"?`
#ifndef HAS_UNIFORM_u_`+H+`
    `+H+" = a_"+H+`;
#else
    `+Z+" "+G+" "+H+" = u_"+H+`;
#endif
`:`
#ifndef HAS_UNIFORM_u_`+H+`
    `+H+" = unpack_mix_"+ee+"(a_"+H+", u_"+H+`_t);
#else
    `+Z+" "+G+" "+H+" = u_"+H+`;
#endif
`:O==="define"?`
#ifndef HAS_UNIFORM_u_`+H+`
uniform lowp float u_`+H+`_t;
attribute `+Z+" "+re+" a_"+H+`;
#else
uniform `+Z+" "+G+" u_"+H+`;
#endif
`:ee==="vec4"?`
#ifndef HAS_UNIFORM_u_`+H+`
    `+Z+" "+G+" "+H+" = a_"+H+`;
#else
    `+Z+" "+G+" "+H+" = u_"+H+`;
#endif
`:`
#ifndef HAS_UNIFORM_u_`+H+`
    `+Z+" "+G+" "+H+" = unpack_mix_"+ee+"(a_"+H+", u_"+H+`_t);
#else
    `+Z+" "+G+" "+H+" = u_"+H+`;
#endif
`}),staticAttributes:c,staticUniforms:S}}var jh=Object.freeze({__proto__:null,prelude:Fo,background:ic,backgroundPattern:Uh,circle:Vh,clippingMask:ql,heatmap:jl,heatmapTexture:Zl,collisionBox:Gl,collisionCircle:nc,debug:ac,fill:qh,fillOutline:us,fillOutlinePattern:cs,fillPattern:oc,fillExtrusion:Qi,fillExtrusionPattern:Kl,hillshadePrepare:ja,hillshade:Za,line:po,lineGradient:fo,linePattern:Ga,lineSDF:mo,raster:yo,symbolIcon:Ka,symbolSDF:sc,symbolTextAndIcon:lc}),Vs=function(){this.boundProgram=null,this.boundLayoutVertexBuffer=null,this.boundPaintVertexBuffers=[],this.boundIndexBuffer=null,this.boundVertexOffset=null,this.boundDynamicVertexBuffer=null,this.vao=null};function uc(n){for(var s=[],o=0;o<n.length;o++)if(n[o]!==null){var c=n[o].split(" ");s.push(c.pop())}return s}Vs.prototype.bind=function(n,s,o,c,v,w,S,z){this.context=n;for(var C=this.boundPaintVertexBuffers.length!==c.length,O=0;!C&&O<c.length;O++)this.boundPaintVertexBuffers[O]!==c[O]&&(C=!0);n.extVertexArrayObject&&this.vao&&this.boundProgram===s&&this.boundLayoutVertexBuffer===o&&!C&&this.boundIndexBuffer===v&&this.boundVertexOffset===w&&this.boundDynamicVertexBuffer===S&&this.boundDynamicVertexBuffer2===z?(n.bindVertexArrayOES.set(this.vao),S&&S.bind(),v&&v.dynamicDraw&&v.bind(),z&&z.bind()):this.freshBind(s,o,c,v,w,S,z)},Vs.prototype.freshBind=function(n,s,o,c,v,w,S){var z,C=n.numAttributes,O=this.context,Z=O.gl;if(O.extVertexArrayObject)this.vao&&this.destroy(),this.vao=O.extVertexArrayObject.createVertexArrayOES(),O.bindVertexArrayOES.set(this.vao),z=0,this.boundProgram=n,this.boundLayoutVertexBuffer=s,this.boundPaintVertexBuffers=o,this.boundIndexBuffer=c,this.boundVertexOffset=v,this.boundDynamicVertexBuffer=w,this.boundDynamicVertexBuffer2=S;else{z=O.currentNumAttributes||0;for(var G=C;G<z;G++)Z.disableVertexAttribArray(G)}s.enableAttributes(Z,n);for(var H=0,re=o;H<re.length;H+=1)re[H].enableAttributes(Z,n);w&&w.enableAttributes(Z,n),S&&S.enableAttributes(Z,n),s.bind(),s.setVertexAttribPointers(Z,n,v);for(var ee=0,le=o;ee<le.length;ee+=1){var Y=le[ee];Y.bind(),Y.setVertexAttribPointers(Z,n,v)}w&&(w.bind(),w.setVertexAttribPointers(Z,n,v)),c&&c.bind(),S&&(S.bind(),S.setVertexAttribPointers(Z,n,v)),O.currentNumAttributes=C},Vs.prototype.destroy=function(){this.vao&&(this.context.extVertexArrayObject.deleteVertexArrayOES(this.vao),this.vao=null)};var cc=function(n,s,o,c,v,w){var S=n.gl;this.program=S.createProgram();for(var z=uc(o.staticAttributes),C=c?c.getBinderAttributes():[],O=z.concat(C),Z=o.staticUniforms?uc(o.staticUniforms):[],G=c?c.getBinderUniforms():[],H=[],re=0,ee=Z.concat(G);re<ee.length;re+=1){var le=ee[re];H.indexOf(le)<0&&H.push(le)}var Y=c?c.defines():[];w&&Y.push("#define OVERDRAW_INSPECTOR;");var se=Y.concat(Fo.fragmentSource,o.fragmentSource).join(`
`),fe=Y.concat(Fo.vertexSource,o.vertexSource).join(`
`),_e=S.createShader(S.FRAGMENT_SHADER);if(S.isContextLost())this.failedToCreate=!0;else{S.shaderSource(_e,se),S.compileShader(_e),S.attachShader(this.program,_e);var Te=S.createShader(S.VERTEX_SHADER);if(S.isContextLost())this.failedToCreate=!0;else{S.shaderSource(Te,fe),S.compileShader(Te),S.attachShader(this.program,Te),this.attributes={};var Se={};this.numAttributes=O.length;for(var Ae=0;Ae<this.numAttributes;Ae++)O[Ae]&&(S.bindAttribLocation(this.program,Ae,O[Ae]),this.attributes[O[Ae]]=Ae);S.linkProgram(this.program),S.deleteShader(Te),S.deleteShader(_e);for(var Oe=0;Oe<H.length;Oe++){var He=H[Oe];if(He&&!Se[He]){var Ze=S.getUniformLocation(this.program,He);Ze&&(Se[He]=Ze)}}this.fixedUniforms=v(n,Se),this.binderUniforms=c?c.getUniforms(n,Se):[]}}};function hc(n,s,o){var c=1/Pr(o,1,s.transform.tileZoom),v=Math.pow(2,o.tileID.overscaledZ),w=o.tileSize*Math.pow(2,s.transform.tileZoom)/v,S=w*(o.tileID.canonical.x+o.tileID.wrap*v),z=w*o.tileID.canonical.y;return{u_image:0,u_texsize:o.imageAtlasTexture.size,u_scale:[c,n.fromScale,n.toScale],u_fade:n.t,u_pixel_coord_upper:[S>>16,z>>16],u_pixel_coord_lower:[65535&S,65535&z]}}cc.prototype.draw=function(n,s,o,c,v,w,S,z,C,O,Z,G,H,re,ee,le){var Y,se=n.gl;if(!this.failedToCreate){for(var fe in n.program.set(this.program),n.setDepthMode(o),n.setStencilMode(c),n.setColorMode(v),n.setCullFace(w),this.fixedUniforms)this.fixedUniforms[fe].set(S[fe]);re&&re.setUniforms(n,this.binderUniforms,G,{zoom:H});for(var _e=(Y={},Y[se.LINES]=2,Y[se.TRIANGLES]=3,Y[se.LINE_STRIP]=1,Y)[s],Te=0,Se=Z.get();Te<Se.length;Te+=1){var Ae=Se[Te],Oe=Ae.vaos||(Ae.vaos={});(Oe[z]||(Oe[z]=new Vs)).bind(n,this,C,re?re.getPaintVertexBuffers():[],O,Ae.vertexOffset,ee,le),se.drawElements(s,Ae.primitiveLength*_e,se.UNSIGNED_SHORT,Ae.primitiveOffset*_e*2)}}};var pc=function(n,s,o,c){var v=s.style.light,w=v.properties.get("position"),S=[w.x,w.y,w.z],z=a.create$1();v.properties.get("anchor")==="viewport"&&a.fromRotation(z,-s.transform.angle),a.transformMat3(S,S,z);var C=v.properties.get("color");return{u_matrix:n,u_lightpos:S,u_lightintensity:v.properties.get("intensity"),u_lightcolor:[C.r,C.g,C.b],u_vertical_gradient:+o,u_opacity:c}},go=function(n,s,o,c,v,w,S){return a.extend(pc(n,s,o,c),hc(w,s,S),{u_height_factor:-Math.pow(2,v.overscaledZ)/S.tileSize/8})},Ha=function(n){return{u_matrix:n}},_o=function(n,s,o,c){return a.extend(Ha(n),hc(o,s,c))},fc=function(n,s){return{u_matrix:n,u_world:s}},dc=function(n,s,o,c,v){return a.extend(_o(n,s,o,c),{u_world:v})},Hl=function(n,s,o,c){var v,w,S=n.transform;if(c.paint.get("circle-pitch-alignment")==="map"){var z=Pr(o,1,S.zoom);v=!0,w=[z,z]}else v=!1,w=S.pixelsToGLUnits;return{u_camera_to_center_distance:S.cameraToCenterDistance,u_scale_with_map:+(c.paint.get("circle-pitch-scale")==="map"),u_matrix:n.translatePosMatrix(s.posMatrix,o,c.paint.get("circle-translate"),c.paint.get("circle-translate-anchor")),u_pitch_with_map:+v,u_device_pixel_ratio:a.browser.devicePixelRatio,u_extrude_scale:w}},vo=function(n,s,o){var c=Pr(o,1,s.zoom),v=Math.pow(2,s.zoom-o.tileID.overscaledZ),w=o.tileID.overscaleFactor();return{u_matrix:n,u_camera_to_center_distance:s.cameraToCenterDistance,u_pixels_to_tile_units:c,u_extrude_scale:[s.pixelsToGLUnits[0]/(c*v),s.pixelsToGLUnits[1]/(c*v)],u_overscale_factor:w}},mc=function(n,s,o){return{u_matrix:n,u_inv_matrix:s,u_camera_to_center_distance:o.cameraToCenterDistance,u_viewport_size:[o.width,o.height]}},bo=function(n,s,o){return o===void 0&&(o=1),{u_matrix:n,u_color:s,u_overlay:0,u_overlay_scale:o}},xo=function(n){return{u_matrix:n}},yc=function(n,s,o,c){return{u_matrix:n,u_extrude_scale:Pr(s,1,o),u_intensity:c}},hs=function(n,s,o){var c=n.transform;return{u_matrix:gc(n,s,o),u_ratio:1/Pr(s,1,c.zoom),u_device_pixel_ratio:a.browser.devicePixelRatio,u_units_to_pixels:[1/c.pixelsToGLUnits[0],1/c.pixelsToGLUnits[1]]}},Fr=function(n,s,o,c){return a.extend(hs(n,s,o),{u_image:0,u_image_height:c})},qs=function(n,s,o,c){var v=n.transform,w=No(s,v);return{u_matrix:gc(n,s,o),u_texsize:s.imageAtlasTexture.size,u_ratio:1/Pr(s,1,v.zoom),u_device_pixel_ratio:a.browser.devicePixelRatio,u_image:0,u_scale:[w,c.fromScale,c.toScale],u_fade:c.t,u_units_to_pixels:[1/v.pixelsToGLUnits[0],1/v.pixelsToGLUnits[1]]}},Zh=function(n,s,o,c,v){var w=n.lineAtlas,S=No(s,n.transform),z=o.layout.get("line-cap")==="round",C=w.getDash(c.from,z),O=w.getDash(c.to,z),Z=C.width*v.fromScale,G=O.width*v.toScale;return a.extend(hs(n,s,o),{u_patternscale_a:[S/Z,-C.height/2],u_patternscale_b:[S/G,-O.height/2],u_sdfgamma:w.width/(256*Math.min(Z,G)*a.browser.devicePixelRatio)/2,u_image:0,u_tex_y_a:C.y,u_tex_y_b:O.y,u_mix:v.t})};function No(n,s){return 1/Pr(n,1,s.tileZoom)}function gc(n,s,o){return n.translatePosMatrix(s.tileID.posMatrix,s,o.paint.get("line-translate"),o.paint.get("line-translate-anchor"))}var Gh=function(n,s,o,c,v){return{u_matrix:n,u_tl_parent:s,u_scale_parent:o,u_buffer_scale:1,u_fade_t:c.mix,u_opacity:c.opacity*v.paint.get("raster-opacity"),u_image0:0,u_image1:1,u_brightness_low:v.paint.get("raster-brightness-min"),u_brightness_high:v.paint.get("raster-brightness-max"),u_saturation_factor:(S=v.paint.get("raster-saturation"),S>0?1-1/(1.001-S):-S),u_contrast_factor:(w=v.paint.get("raster-contrast"),w>0?1/(1-w):1+w),u_spin_weights:_c(v.paint.get("raster-hue-rotate"))};var w,S};function _c(n){n*=Math.PI/180;var s=Math.sin(n),o=Math.cos(n);return[(2*o+1)/3,(-Math.sqrt(3)*s-o+1)/3,(Math.sqrt(3)*s-o+1)/3]}var js,Uo=function(n,s,o,c,v,w,S,z,C,O){var Z=v.transform;return{u_is_size_zoom_constant:+(n==="constant"||n==="source"),u_is_size_feature_constant:+(n==="constant"||n==="camera"),u_size_t:s?s.uSizeT:0,u_size:s?s.uSize:0,u_camera_to_center_distance:Z.cameraToCenterDistance,u_pitch:Z.pitch/360*2*Math.PI,u_rotate_symbol:+o,u_aspect_ratio:Z.width/Z.height,u_fade_change:v.options.fadeDuration?v.symbolFadeChange:1,u_matrix:w,u_label_plane_matrix:S,u_coord_matrix:z,u_is_text:+C,u_pitch_with_map:+c,u_texsize:O,u_texture:0}},ps=function(n,s,o,c,v,w,S,z,C,O,Z){var G=v.transform;return a.extend(Uo(n,s,o,c,v,w,S,z,C,O),{u_gamma_scale:c?Math.cos(G._pitch)*G.cameraToCenterDistance:1,u_device_pixel_ratio:a.browser.devicePixelRatio,u_is_halo:+Z})},Zs=function(n,s,o,c,v,w,S,z,C,O){return a.extend(ps(n,s,o,c,v,w,S,z,!0,C,!0),{u_texsize_icon:O,u_texture_icon:1})},fs=function(n,s,o){return{u_matrix:n,u_opacity:s,u_color:o}},Vo=function(n,s,o,c,v,w){return a.extend(function(S,z,C,O){var Z=C.imageManager.getPattern(S.from.toString()),G=C.imageManager.getPattern(S.to.toString()),H=C.imageManager.getPixelSize(),re=H.width,ee=H.height,le=Math.pow(2,O.tileID.overscaledZ),Y=O.tileSize*Math.pow(2,C.transform.tileZoom)/le,se=Y*(O.tileID.canonical.x+O.tileID.wrap*le),fe=Y*O.tileID.canonical.y;return{u_image:0,u_pattern_tl_a:Z.tl,u_pattern_br_a:Z.br,u_pattern_tl_b:G.tl,u_pattern_br_b:G.br,u_texsize:[re,ee],u_mix:z.t,u_pattern_size_a:Z.displaySize,u_pattern_size_b:G.displaySize,u_scale_a:z.fromScale,u_scale_b:z.toScale,u_tile_units_to_pixels:1/Pr(O,1,C.transform.tileZoom),u_pixel_coord_upper:[se>>16,fe>>16],u_pixel_coord_lower:[65535&se,65535&fe]}}(c,w,o,v),{u_matrix:n,u_opacity:s})},vc={fillExtrusion:function(n,s){return{u_matrix:new a.UniformMatrix4f(n,s.u_matrix),u_lightpos:new a.Uniform3f(n,s.u_lightpos),u_lightintensity:new a.Uniform1f(n,s.u_lightintensity),u_lightcolor:new a.Uniform3f(n,s.u_lightcolor),u_vertical_gradient:new a.Uniform1f(n,s.u_vertical_gradient),u_opacity:new a.Uniform1f(n,s.u_opacity)}},fillExtrusionPattern:function(n,s){return{u_matrix:new a.UniformMatrix4f(n,s.u_matrix),u_lightpos:new a.Uniform3f(n,s.u_lightpos),u_lightintensity:new a.Uniform1f(n,s.u_lightintensity),u_lightcolor:new a.Uniform3f(n,s.u_lightcolor),u_vertical_gradient:new a.Uniform1f(n,s.u_vertical_gradient),u_height_factor:new a.Uniform1f(n,s.u_height_factor),u_image:new a.Uniform1i(n,s.u_image),u_texsize:new a.Uniform2f(n,s.u_texsize),u_pixel_coord_upper:new a.Uniform2f(n,s.u_pixel_coord_upper),u_pixel_coord_lower:new a.Uniform2f(n,s.u_pixel_coord_lower),u_scale:new a.Uniform3f(n,s.u_scale),u_fade:new a.Uniform1f(n,s.u_fade),u_opacity:new a.Uniform1f(n,s.u_opacity)}},fill:function(n,s){return{u_matrix:new a.UniformMatrix4f(n,s.u_matrix)}},fillPattern:function(n,s){return{u_matrix:new a.UniformMatrix4f(n,s.u_matrix),u_image:new a.Uniform1i(n,s.u_image),u_texsize:new a.Uniform2f(n,s.u_texsize),u_pixel_coord_upper:new a.Uniform2f(n,s.u_pixel_coord_upper),u_pixel_coord_lower:new a.Uniform2f(n,s.u_pixel_coord_lower),u_scale:new a.Uniform3f(n,s.u_scale),u_fade:new a.Uniform1f(n,s.u_fade)}},fillOutline:function(n,s){return{u_matrix:new a.UniformMatrix4f(n,s.u_matrix),u_world:new a.Uniform2f(n,s.u_world)}},fillOutlinePattern:function(n,s){return{u_matrix:new a.UniformMatrix4f(n,s.u_matrix),u_world:new a.Uniform2f(n,s.u_world),u_image:new a.Uniform1i(n,s.u_image),u_texsize:new a.Uniform2f(n,s.u_texsize),u_pixel_coord_upper:new a.Uniform2f(n,s.u_pixel_coord_upper),u_pixel_coord_lower:new a.Uniform2f(n,s.u_pixel_coord_lower),u_scale:new a.Uniform3f(n,s.u_scale),u_fade:new a.Uniform1f(n,s.u_fade)}},circle:function(n,s){return{u_camera_to_center_distance:new a.Uniform1f(n,s.u_camera_to_center_distance),u_scale_with_map:new a.Uniform1i(n,s.u_scale_with_map),u_pitch_with_map:new a.Uniform1i(n,s.u_pitch_with_map),u_extrude_scale:new a.Uniform2f(n,s.u_extrude_scale),u_device_pixel_ratio:new a.Uniform1f(n,s.u_device_pixel_ratio),u_matrix:new a.UniformMatrix4f(n,s.u_matrix)}},collisionBox:function(n,s){return{u_matrix:new a.UniformMatrix4f(n,s.u_matrix),u_camera_to_center_distance:new a.Uniform1f(n,s.u_camera_to_center_distance),u_pixels_to_tile_units:new a.Uniform1f(n,s.u_pixels_to_tile_units),u_extrude_scale:new a.Uniform2f(n,s.u_extrude_scale),u_overscale_factor:new a.Uniform1f(n,s.u_overscale_factor)}},collisionCircle:function(n,s){return{u_matrix:new a.UniformMatrix4f(n,s.u_matrix),u_inv_matrix:new a.UniformMatrix4f(n,s.u_inv_matrix),u_camera_to_center_distance:new a.Uniform1f(n,s.u_camera_to_center_distance),u_viewport_size:new a.Uniform2f(n,s.u_viewport_size)}},debug:function(n,s){return{u_color:new a.UniformColor(n,s.u_color),u_matrix:new a.UniformMatrix4f(n,s.u_matrix),u_overlay:new a.Uniform1i(n,s.u_overlay),u_overlay_scale:new a.Uniform1f(n,s.u_overlay_scale)}},clippingMask:function(n,s){return{u_matrix:new a.UniformMatrix4f(n,s.u_matrix)}},heatmap:function(n,s){return{u_extrude_scale:new a.Uniform1f(n,s.u_extrude_scale),u_intensity:new a.Uniform1f(n,s.u_intensity),u_matrix:new a.UniformMatrix4f(n,s.u_matrix)}},heatmapTexture:function(n,s){return{u_matrix:new a.UniformMatrix4f(n,s.u_matrix),u_world:new a.Uniform2f(n,s.u_world),u_image:new a.Uniform1i(n,s.u_image),u_color_ramp:new a.Uniform1i(n,s.u_color_ramp),u_opacity:new a.Uniform1f(n,s.u_opacity)}},hillshade:function(n,s){return{u_matrix:new a.UniformMatrix4f(n,s.u_matrix),u_image:new a.Uniform1i(n,s.u_image),u_latrange:new a.Uniform2f(n,s.u_latrange),u_light:new a.Uniform2f(n,s.u_light),u_shadow:new a.UniformColor(n,s.u_shadow),u_highlight:new a.UniformColor(n,s.u_highlight),u_accent:new a.UniformColor(n,s.u_accent)}},hillshadePrepare:function(n,s){return{u_matrix:new a.UniformMatrix4f(n,s.u_matrix),u_image:new a.Uniform1i(n,s.u_image),u_dimension:new a.Uniform2f(n,s.u_dimension),u_zoom:new a.Uniform1f(n,s.u_zoom),u_unpack:new a.Uniform4f(n,s.u_unpack)}},line:function(n,s){return{u_matrix:new a.UniformMatrix4f(n,s.u_matrix),u_ratio:new a.Uniform1f(n,s.u_ratio),u_device_pixel_ratio:new a.Uniform1f(n,s.u_device_pixel_ratio),u_units_to_pixels:new a.Uniform2f(n,s.u_units_to_pixels)}},lineGradient:function(n,s){return{u_matrix:new a.UniformMatrix4f(n,s.u_matrix),u_ratio:new a.Uniform1f(n,s.u_ratio),u_device_pixel_ratio:new a.Uniform1f(n,s.u_device_pixel_ratio),u_units_to_pixels:new a.Uniform2f(n,s.u_units_to_pixels),u_image:new a.Uniform1i(n,s.u_image),u_image_height:new a.Uniform1f(n,s.u_image_height)}},linePattern:function(n,s){return{u_matrix:new a.UniformMatrix4f(n,s.u_matrix),u_texsize:new a.Uniform2f(n,s.u_texsize),u_ratio:new a.Uniform1f(n,s.u_ratio),u_device_pixel_ratio:new a.Uniform1f(n,s.u_device_pixel_ratio),u_image:new a.Uniform1i(n,s.u_image),u_units_to_pixels:new a.Uniform2f(n,s.u_units_to_pixels),u_scale:new a.Uniform3f(n,s.u_scale),u_fade:new a.Uniform1f(n,s.u_fade)}},lineSDF:function(n,s){return{u_matrix:new a.UniformMatrix4f(n,s.u_matrix),u_ratio:new a.Uniform1f(n,s.u_ratio),u_device_pixel_ratio:new a.Uniform1f(n,s.u_device_pixel_ratio),u_units_to_pixels:new a.Uniform2f(n,s.u_units_to_pixels),u_patternscale_a:new a.Uniform2f(n,s.u_patternscale_a),u_patternscale_b:new a.Uniform2f(n,s.u_patternscale_b),u_sdfgamma:new a.Uniform1f(n,s.u_sdfgamma),u_image:new a.Uniform1i(n,s.u_image),u_tex_y_a:new a.Uniform1f(n,s.u_tex_y_a),u_tex_y_b:new a.Uniform1f(n,s.u_tex_y_b),u_mix:new a.Uniform1f(n,s.u_mix)}},raster:function(n,s){return{u_matrix:new a.UniformMatrix4f(n,s.u_matrix),u_tl_parent:new a.Uniform2f(n,s.u_tl_parent),u_scale_parent:new a.Uniform1f(n,s.u_scale_parent),u_buffer_scale:new a.Uniform1f(n,s.u_buffer_scale),u_fade_t:new a.Uniform1f(n,s.u_fade_t),u_opacity:new a.Uniform1f(n,s.u_opacity),u_image0:new a.Uniform1i(n,s.u_image0),u_image1:new a.Uniform1i(n,s.u_image1),u_brightness_low:new a.Uniform1f(n,s.u_brightness_low),u_brightness_high:new a.Uniform1f(n,s.u_brightness_high),u_saturation_factor:new a.Uniform1f(n,s.u_saturation_factor),u_contrast_factor:new a.Uniform1f(n,s.u_contrast_factor),u_spin_weights:new a.Uniform3f(n,s.u_spin_weights)}},symbolIcon:function(n,s){return{u_is_size_zoom_constant:new a.Uniform1i(n,s.u_is_size_zoom_constant),u_is_size_feature_constant:new a.Uniform1i(n,s.u_is_size_feature_constant),u_size_t:new a.Uniform1f(n,s.u_size_t),u_size:new a.Uniform1f(n,s.u_size),u_camera_to_center_distance:new a.Uniform1f(n,s.u_camera_to_center_distance),u_pitch:new a.Uniform1f(n,s.u_pitch),u_rotate_symbol:new a.Uniform1i(n,s.u_rotate_symbol),u_aspect_ratio:new a.Uniform1f(n,s.u_aspect_ratio),u_fade_change:new a.Uniform1f(n,s.u_fade_change),u_matrix:new a.UniformMatrix4f(n,s.u_matrix),u_label_plane_matrix:new a.UniformMatrix4f(n,s.u_label_plane_matrix),u_coord_matrix:new a.UniformMatrix4f(n,s.u_coord_matrix),u_is_text:new a.Uniform1i(n,s.u_is_text),u_pitch_with_map:new a.Uniform1i(n,s.u_pitch_with_map),u_texsize:new a.Uniform2f(n,s.u_texsize),u_texture:new a.Uniform1i(n,s.u_texture)}},symbolSDF:function(n,s){return{u_is_size_zoom_constant:new a.Uniform1i(n,s.u_is_size_zoom_constant),u_is_size_feature_constant:new a.Uniform1i(n,s.u_is_size_feature_constant),u_size_t:new a.Uniform1f(n,s.u_size_t),u_size:new a.Uniform1f(n,s.u_size),u_camera_to_center_distance:new a.Uniform1f(n,s.u_camera_to_center_distance),u_pitch:new a.Uniform1f(n,s.u_pitch),u_rotate_symbol:new a.Uniform1i(n,s.u_rotate_symbol),u_aspect_ratio:new a.Uniform1f(n,s.u_aspect_ratio),u_fade_change:new a.Uniform1f(n,s.u_fade_change),u_matrix:new a.UniformMatrix4f(n,s.u_matrix),u_label_plane_matrix:new a.UniformMatrix4f(n,s.u_label_plane_matrix),u_coord_matrix:new a.UniformMatrix4f(n,s.u_coord_matrix),u_is_text:new a.Uniform1i(n,s.u_is_text),u_pitch_with_map:new a.Uniform1i(n,s.u_pitch_with_map),u_texsize:new a.Uniform2f(n,s.u_texsize),u_texture:new a.Uniform1i(n,s.u_texture),u_gamma_scale:new a.Uniform1f(n,s.u_gamma_scale),u_device_pixel_ratio:new a.Uniform1f(n,s.u_device_pixel_ratio),u_is_halo:new a.Uniform1i(n,s.u_is_halo)}},symbolTextAndIcon:function(n,s){return{u_is_size_zoom_constant:new a.Uniform1i(n,s.u_is_size_zoom_constant),u_is_size_feature_constant:new a.Uniform1i(n,s.u_is_size_feature_constant),u_size_t:new a.Uniform1f(n,s.u_size_t),u_size:new a.Uniform1f(n,s.u_size),u_camera_to_center_distance:new a.Uniform1f(n,s.u_camera_to_center_distance),u_pitch:new a.Uniform1f(n,s.u_pitch),u_rotate_symbol:new a.Uniform1i(n,s.u_rotate_symbol),u_aspect_ratio:new a.Uniform1f(n,s.u_aspect_ratio),u_fade_change:new a.Uniform1f(n,s.u_fade_change),u_matrix:new a.UniformMatrix4f(n,s.u_matrix),u_label_plane_matrix:new a.UniformMatrix4f(n,s.u_label_plane_matrix),u_coord_matrix:new a.UniformMatrix4f(n,s.u_coord_matrix),u_is_text:new a.Uniform1i(n,s.u_is_text),u_pitch_with_map:new a.Uniform1i(n,s.u_pitch_with_map),u_texsize:new a.Uniform2f(n,s.u_texsize),u_texsize_icon:new a.Uniform2f(n,s.u_texsize_icon),u_texture:new a.Uniform1i(n,s.u_texture),u_texture_icon:new a.Uniform1i(n,s.u_texture_icon),u_gamma_scale:new a.Uniform1f(n,s.u_gamma_scale),u_device_pixel_ratio:new a.Uniform1f(n,s.u_device_pixel_ratio),u_is_halo:new a.Uniform1i(n,s.u_is_halo)}},background:function(n,s){return{u_matrix:new a.UniformMatrix4f(n,s.u_matrix),u_opacity:new a.Uniform1f(n,s.u_opacity),u_color:new a.UniformColor(n,s.u_color)}},backgroundPattern:function(n,s){return{u_matrix:new a.UniformMatrix4f(n,s.u_matrix),u_opacity:new a.Uniform1f(n,s.u_opacity),u_image:new a.Uniform1i(n,s.u_image),u_pattern_tl_a:new a.Uniform2f(n,s.u_pattern_tl_a),u_pattern_br_a:new a.Uniform2f(n,s.u_pattern_br_a),u_pattern_tl_b:new a.Uniform2f(n,s.u_pattern_tl_b),u_pattern_br_b:new a.Uniform2f(n,s.u_pattern_br_b),u_texsize:new a.Uniform2f(n,s.u_texsize),u_mix:new a.Uniform1f(n,s.u_mix),u_pattern_size_a:new a.Uniform2f(n,s.u_pattern_size_a),u_pattern_size_b:new a.Uniform2f(n,s.u_pattern_size_b),u_scale_a:new a.Uniform1f(n,s.u_scale_a),u_scale_b:new a.Uniform1f(n,s.u_scale_b),u_pixel_coord_upper:new a.Uniform2f(n,s.u_pixel_coord_upper),u_pixel_coord_lower:new a.Uniform2f(n,s.u_pixel_coord_lower),u_tile_units_to_pixels:new a.Uniform1f(n,s.u_tile_units_to_pixels)}}};function qo(n,s,o,c,v,w,S){for(var z=n.context,C=z.gl,O=n.useProgram("collisionBox"),Z=[],G=0,H=0,re=0;re<c.length;re++){var ee=c[re],le=s.getTile(ee),Y=le.getBucket(o);if(Y){var se=ee.posMatrix;v[0]===0&&v[1]===0||(se=n.translatePosMatrix(ee.posMatrix,le,v,w));var fe=S?Y.textCollisionBox:Y.iconCollisionBox,_e=Y.collisionCircleArray;if(_e.length>0){var Te=a.create(),Se=se;a.mul(Te,Y.placementInvProjMatrix,n.transform.glCoordMatrix),a.mul(Te,Te,Y.placementViewportMatrix),Z.push({circleArray:_e,circleOffset:H,transform:Se,invTransform:Te}),H=G+=_e.length/4}fe&&O.draw(z,C.LINES,K.disabled,W.disabled,n.colorModeForRenderPass(),he.disabled,vo(se,n.transform,le),o.id,fe.layoutVertexBuffer,fe.indexBuffer,fe.segments,null,n.transform.zoom,null,null,fe.collisionVertexBuffer)}}if(S&&Z.length){var Ae=n.useProgram("collisionCircle"),Oe=new a.StructArrayLayout2f1f2i16;Oe.resize(4*G),Oe._trim();for(var He=0,Ze=0,ct=Z;Ze<ct.length;Ze+=1)for(var Et=ct[Ze],Ct=0;Ct<Et.circleArray.length/4;Ct++){var It=4*Ct,dr=Et.circleArray[It+0],pt=Et.circleArray[It+1],Ut=Et.circleArray[It+2],Xt=Et.circleArray[It+3];Oe.emplace(He++,dr,pt,Ut,Xt,0),Oe.emplace(He++,dr,pt,Ut,Xt,1),Oe.emplace(He++,dr,pt,Ut,Xt,2),Oe.emplace(He++,dr,pt,Ut,Xt,3)}(!js||js.length<2*G)&&(js=function(ni){var cn=2*ni,Ki=new a.StructArrayLayout3ui6;Ki.resize(cn),Ki._trim();for(var Jr=0;Jr<cn;Jr++){var pi=6*Jr;Ki.uint16[pi+0]=4*Jr+0,Ki.uint16[pi+1]=4*Jr+1,Ki.uint16[pi+2]=4*Jr+2,Ki.uint16[pi+3]=4*Jr+2,Ki.uint16[pi+4]=4*Jr+3,Ki.uint16[pi+5]=4*Jr+0}return Ki}(G));for(var Nt=z.createIndexBuffer(js,!0),Bt=z.createVertexBuffer(Oe,a.collisionCircleLayout.members,!0),Ht=0,Rt=Z;Ht<Rt.length;Ht+=1){var Mt=Rt[Ht],Bi=mc(Mt.transform,Mt.invTransform,n.transform);Ae.draw(z,C.TRIANGLES,K.disabled,W.disabled,n.colorModeForRenderPass(),he.disabled,Bi,o.id,Bt,Nt,a.SegmentVector.simpleSegment(0,2*Mt.circleOffset,Mt.circleArray.length,Mt.circleArray.length/2),null,n.transform.zoom,null,null,null)}Bt.destroy(),Nt.destroy()}}var pa=a.identity(new Float32Array(16));function bc(n,s,o,c,v,w){var S=a.getAnchorAlignment(n),z=-(S.horizontalAlign-.5)*s,C=-(S.verticalAlign-.5)*o,O=a.evaluateVariableOffset(n,c);return new a.Point((z/v+O[0])*w,(C/v+O[1])*w)}function xc(n,s,o,c,v,w,S,z,C,O,Z){var G=n.text.placedSymbolArray,H=n.text.dynamicLayoutVertexArray,re=n.icon.dynamicLayoutVertexArray,ee={};H.clear();for(var le=0;le<G.length;le++){var Y=G.get(le),se=Y.hidden||!Y.crossTileID||n.allowVerticalPlacement&&!Y.placedOrientation?null:c[Y.crossTileID];if(se){var fe=new a.Point(Y.anchorX,Y.anchorY),_e=Wt(fe,o?z:S),Te=ur(w.cameraToCenterDistance,_e.signedDistanceFromCamera),Se=v.evaluateSizeForFeature(n.textSizeData,O,Y)*Te/a.ONE_EM;o&&(Se*=n.tilePixelRatio/C);for(var Ae=bc(se.anchor,se.width,se.height,se.textOffset,se.textBoxScale,Se),Oe=o?Wt(fe.add(Ae),S).point:_e.point.add(s?Ae.rotate(-w.angle):Ae),He=n.allowVerticalPlacement&&Y.placedOrientation===a.WritingMode.vertical?Math.PI/2:0,Ze=0;Ze<Y.numGlyphs;Ze++)a.addDynamicAttributes(H,Oe,He);Z&&Y.associatedIconIndex>=0&&(ee[Y.associatedIconIndex]={shiftedAnchor:Oe,angle:He})}else ki(Y.numGlyphs,H)}if(Z){re.clear();for(var ct=n.icon.placedSymbolArray,Et=0;Et<ct.length;Et++){var Ct=ct.get(Et);if(Ct.hidden)ki(Ct.numGlyphs,re);else{var It=ee[Et];if(It)for(var dr=0;dr<Ct.numGlyphs;dr++)a.addDynamicAttributes(re,It.shiftedAnchor,It.angle);else ki(Ct.numGlyphs,re)}}n.icon.dynamicLayoutVertexBuffer.updateData(re)}n.text.dynamicLayoutVertexBuffer.updateData(H)}function wc(n,s,o){return o.iconsInText&&s?"symbolTextAndIcon":n?"symbolSDF":"symbolIcon"}function wo(n,s,o,c,v,w,S,z,C,O,Z,G){for(var H=n.context,re=H.gl,ee=n.transform,le=z==="map",Y=C==="map",se=le&&o.layout.get("symbol-placement")!=="point",fe=le&&!Y&&!se,_e=o.layout.get("symbol-sort-key").constantOr(1)!==void 0,Te=!1,Se=n.depthModeForSublayer(0,K.ReadOnly),Ae=o.layout.get("text-variable-anchor"),Oe=[],He=0,Ze=c;He<Ze.length;He+=1){var ct=Ze[He],Et=s.getTile(ct),Ct=Et.getBucket(o);if(Ct){var It=v?Ct.text:Ct.icon;if(It&&It.segments.get().length){var dr=It.programConfigurations.get(o.id),pt=v||Ct.sdfIcons,Ut=v?Ct.textSizeData:Ct.iconSizeData,Xt=Y||ee.pitch!==0,Nt=n.useProgram(wc(pt,v,Ct),dr),Bt=a.evaluateSizeForZoom(Ut,ee.zoom),Ht=void 0,Rt=[0,0],Mt=void 0,Bi=void 0,ni=null,cn=void 0;if(v)Mt=Et.glyphAtlasTexture,Bi=re.LINEAR,Ht=Et.glyphAtlasTexture.size,Ct.iconsInText&&(Rt=Et.imageAtlasTexture.size,ni=Et.imageAtlasTexture,cn=Xt||n.options.rotating||n.options.zooming||Ut.kind==="composite"||Ut.kind==="camera"?re.LINEAR:re.NEAREST);else{var Ki=o.layout.get("icon-size").constantOr(0)!==1||Ct.iconsNeedLinear;Mt=Et.imageAtlasTexture,Bi=pt||n.options.rotating||n.options.zooming||Ki||Xt?re.LINEAR:re.NEAREST,Ht=Et.imageAtlasTexture.size}var Jr=Pr(Et,1,n.transform.zoom),pi=Or(ct.posMatrix,Y,le,n.transform,Jr),Zn=gr(ct.posMatrix,Y,le,n.transform,Jr),xn=Ae&&Ct.hasTextData(),$a=o.layout.get("icon-text-fit")!=="none"&&xn&&Ct.hasIconData();se&&ha(Ct,ct.posMatrix,n,v,pi,Zn,Y,O);var Pn=n.translatePosMatrix(ct.posMatrix,Et,w,S),ga=se||v&&Ae||$a?pa:pi,aa=n.translatePosMatrix(Zn,Et,w,S,!0),Es=pt&&o.paint.get(v?"text-halo-width":"icon-halo-width").constantOr(1)!==0,Xo={program:Nt,buffers:It,uniformValues:pt?Ct.iconsInText?Zs(Ut.kind,Bt,fe,Y,n,Pn,ga,aa,Ht,Rt):ps(Ut.kind,Bt,fe,Y,n,Pn,ga,aa,v,Ht,!0):Uo(Ut.kind,Bt,fe,Y,n,Pn,ga,aa,v,Ht),atlasTexture:Mt,atlasTextureIcon:ni,atlasInterpolation:Bi,atlasInterpolationIcon:cn,isSDF:pt,hasHalo:Es};if(_e&&Ct.canOverlap){Te=!0;for(var eo=0,Wo=It.segments.get();eo<Wo.length;eo+=1){var zs=Wo[eo];Oe.push({segments:new a.SegmentVector([zs]),sortKey:zs.sortKey,state:Xo})}}else Oe.push({segments:It.segments,sortKey:0,state:Xo})}}}Te&&Oe.sort(function(to,Io){return to.sortKey-Io.sortKey});for(var Ta=0,Ts=Oe;Ta<Ts.length;Ta+=1){var Ia=Ts[Ta],Oi=Ia.state;if(H.activeTexture.set(re.TEXTURE0),Oi.atlasTexture.bind(Oi.atlasInterpolation,re.CLAMP_TO_EDGE),Oi.atlasTextureIcon&&(H.activeTexture.set(re.TEXTURE1),Oi.atlasTextureIcon&&Oi.atlasTextureIcon.bind(Oi.atlasInterpolationIcon,re.CLAMP_TO_EDGE)),Oi.isSDF){var La=Oi.uniformValues;Oi.hasHalo&&(La.u_is_halo=1,ds(Oi.buffers,Ia.segments,o,n,Oi.program,Se,Z,G,La)),La.u_is_halo=0}ds(Oi.buffers,Ia.segments,o,n,Oi.program,Se,Z,G,Oi.uniformValues)}}function ds(n,s,o,c,v,w,S,z,C){var O=c.context;v.draw(O,O.gl.TRIANGLES,w,S,z,he.disabled,C,o.id,n.layoutVertexBuffer,n.indexBuffer,s,o.paint,c.transform.zoom,n.programConfigurations.get(o.id),n.dynamicLayoutVertexBuffer,n.opacityVertexBuffer)}function Gs(n,s,o,c,v,w,S){var z,C,O,Z,G,H=n.context.gl,re=o.paint.get("fill-pattern"),ee=re&&re.constantOr(1),le=o.getCrossfadeParameters();S?(C=ee&&!o.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline",z=H.LINES):(C=ee?"fillPattern":"fill",z=H.TRIANGLES);for(var Y=0,se=c;Y<se.length;Y+=1){var fe=se[Y],_e=s.getTile(fe);if(!ee||_e.patternsLoaded()){var Te=_e.getBucket(o);if(Te){var Se=Te.programConfigurations.get(o.id),Ae=n.useProgram(C,Se);ee&&(n.context.activeTexture.set(H.TEXTURE0),_e.imageAtlasTexture.bind(H.LINEAR,H.CLAMP_TO_EDGE),Se.updatePaintBuffers(le));var Oe=re.constantOr(null);if(Oe&&_e.imageAtlas){var He=_e.imageAtlas,Ze=He.patternPositions[Oe.to.toString()],ct=He.patternPositions[Oe.from.toString()];Ze&&ct&&Se.setConstantPatternPositions(Ze,ct)}var Et=n.translatePosMatrix(fe.posMatrix,_e,o.paint.get("fill-translate"),o.paint.get("fill-translate-anchor"));if(S){Z=Te.indexBuffer2,G=Te.segments2;var Ct=[H.drawingBufferWidth,H.drawingBufferHeight];O=C==="fillOutlinePattern"&&ee?dc(Et,n,le,_e,Ct):fc(Et,Ct)}else Z=Te.indexBuffer,G=Te.segments,O=ee?_o(Et,n,le,_e):Ha(Et);Ae.draw(n.context,z,v,n.stencilModeForClipping(fe),w,he.disabled,O,o.id,Te.layoutVertexBuffer,Z,G,o.paint,n.transform.zoom,Se)}}}}function Xl(n,s,o,c,v,w,S){for(var z=n.context,C=z.gl,O=o.paint.get("fill-extrusion-pattern"),Z=O.constantOr(1),G=o.getCrossfadeParameters(),H=o.paint.get("fill-extrusion-opacity"),re=0,ee=c;re<ee.length;re+=1){var le=ee[re],Y=s.getTile(le),se=Y.getBucket(o);if(se){var fe=se.programConfigurations.get(o.id),_e=n.useProgram(Z?"fillExtrusionPattern":"fillExtrusion",fe);Z&&(n.context.activeTexture.set(C.TEXTURE0),Y.imageAtlasTexture.bind(C.LINEAR,C.CLAMP_TO_EDGE),fe.updatePaintBuffers(G));var Te=O.constantOr(null);if(Te&&Y.imageAtlas){var Se=Y.imageAtlas,Ae=Se.patternPositions[Te.to.toString()],Oe=Se.patternPositions[Te.from.toString()];Ae&&Oe&&fe.setConstantPatternPositions(Ae,Oe)}var He=n.translatePosMatrix(le.posMatrix,Y,o.paint.get("fill-extrusion-translate"),o.paint.get("fill-extrusion-translate-anchor")),Ze=o.paint.get("fill-extrusion-vertical-gradient"),ct=Z?go(He,n,Ze,H,le,G,Y):pc(He,n,Ze,H);_e.draw(z,z.gl.TRIANGLES,v,w,S,he.backCCW,ct,o.id,se.layoutVertexBuffer,se.indexBuffer,se.segments,o.paint,n.transform.zoom,fe)}}}function Ks(n,s,o,c,v,w){var S=n.context,z=S.gl,C=s.fbo;if(C){var O=n.useProgram("hillshade");S.activeTexture.set(z.TEXTURE0),z.bindTexture(z.TEXTURE_2D,C.colorAttachment.get());var Z=function(G,H,re){var ee=re.paint.get("hillshade-shadow-color"),le=re.paint.get("hillshade-highlight-color"),Y=re.paint.get("hillshade-accent-color"),se=re.paint.get("hillshade-illumination-direction")*(Math.PI/180);re.paint.get("hillshade-illumination-anchor")==="viewport"&&(se-=G.transform.angle);var fe,_e,Te,Se=!G.options.moving;return{u_matrix:G.transform.calculatePosMatrix(H.tileID.toUnwrapped(),Se),u_image:0,u_latrange:(fe=H.tileID,_e=Math.pow(2,fe.canonical.z),Te=fe.canonical.y,[new a.MercatorCoordinate(0,Te/_e).toLngLat().lat,new a.MercatorCoordinate(0,(Te+1)/_e).toLngLat().lat]),u_light:[re.paint.get("hillshade-exaggeration"),se],u_shadow:ee,u_highlight:le,u_accent:Y}}(n,s,o);O.draw(S,z.TRIANGLES,c,v,w,he.disabled,Z,o.id,n.rasterBoundsBuffer,n.quadTriangleIndexBuffer,n.rasterBoundsSegments)}}function Kh(n,s,o,c,v,w){var S=n.context,z=S.gl,C=s.dem;if(C&&C.data){var O=C.dim,Z=C.stride,G=C.getPixels();if(S.activeTexture.set(z.TEXTURE1),S.pixelStoreUnpackPremultiplyAlpha.set(!1),s.demTexture=s.demTexture||n.getTileTexture(Z),s.demTexture){var H=s.demTexture;H.update(G,{premultiply:!1}),H.bind(z.NEAREST,z.CLAMP_TO_EDGE)}else s.demTexture=new a.Texture(S,G,z.RGBA,{premultiply:!1}),s.demTexture.bind(z.NEAREST,z.CLAMP_TO_EDGE);S.activeTexture.set(z.TEXTURE0);var re=s.fbo;if(!re){var ee=new a.Texture(S,{width:O,height:O,data:null},z.RGBA);ee.bind(z.LINEAR,z.CLAMP_TO_EDGE),(re=s.fbo=S.createFramebuffer(O,O,!0)).colorAttachment.set(ee.texture)}S.bindFramebuffer.set(re.framebuffer),S.viewport.set([0,0,O,O]),n.useProgram("hillshadePrepare").draw(S,z.TRIANGLES,c,v,w,he.disabled,function(le,Y){var se=Y.stride,fe=a.create();return a.ortho(fe,0,a.EXTENT,-a.EXTENT,0,0,1),a.translate(fe,fe,[0,-a.EXTENT,0]),{u_matrix:fe,u_image:1,u_dimension:[se,se],u_zoom:le.overscaledZ,u_unpack:Y.getUnpackVector()}}(s.tileID,C),o.id,n.rasterBoundsBuffer,n.quadTriangleIndexBuffer,n.rasterBoundsSegments),s.needsHillshadePrepare=!1}}function Hs(n,s,o,c,v){var w=c.paint.get("raster-fade-duration");if(w>0){var S=a.browser.now(),z=(S-n.timeAdded)/w,C=s?(S-s.timeAdded)/w:-1,O=o.getSource(),Z=v.coveringZoomLevel({tileSize:O.tileSize,roundZoom:O.roundZoom}),G=!s||Math.abs(s.tileID.overscaledZ-Z)>Math.abs(n.tileID.overscaledZ-Z),H=G&&n.refreshedUponExpiration?1:a.clamp(G?z:1-C,0,1);return n.refreshedUponExpiration&&z>=1&&(n.refreshedUponExpiration=!1),s?{opacity:1,mix:1-H}:{opacity:H,mix:0}}return{opacity:1,mix:0}}var Wl=new a.Color(1,0,0,1),Sc=new a.Color(0,1,0,1),kc=new a.Color(0,0,1,1),Xs=new a.Color(1,0,1,1),Yl=new a.Color(0,1,1,1);function Jl(n,s,o,c){ms(n,0,s+o/2,n.transform.width,o,c)}function Ql(n,s,o,c){ms(n,s-o/2,0,o,n.transform.height,c)}function ms(n,s,o,c,v,w){var S=n.context,z=S.gl;z.enable(z.SCISSOR_TEST),z.scissor(s*a.browser.devicePixelRatio,o*a.browser.devicePixelRatio,c*a.browser.devicePixelRatio,v*a.browser.devicePixelRatio),S.clear({color:w}),z.disable(z.SCISSOR_TEST)}function Ec(n,s,o){var c=n.context,v=c.gl,w=o.posMatrix,S=n.useProgram("debug"),z=K.disabled,C=W.disabled,O=n.colorModeForRenderPass();c.activeTexture.set(v.TEXTURE0),n.emptyTexture.bind(v.LINEAR,v.CLAMP_TO_EDGE),S.draw(c,v.LINE_STRIP,z,C,O,he.disabled,bo(w,a.Color.red),"$debug",n.debugBuffer,n.tileBorderIndexBuffer,n.debugSegments);var Z=s.getTileByID(o.key).latestRawTileData,G=Math.floor((Z&&Z.byteLength||0)/1024),H=s.getTile(o).tileSize,re=512/Math.min(H,512)*(o.overscaledZ/n.transform.zoom)*.5,ee=o.canonical.toString();o.overscaledZ!==o.canonical.z&&(ee+=" => "+o.overscaledZ),function(le,Y){le.initDebugOverlayCanvas();var se=le.debugOverlayCanvas,fe=le.context.gl,_e=le.debugOverlayCanvas.getContext("2d");_e.clearRect(0,0,se.width,se.height),_e.shadowColor="white",_e.shadowBlur=2,_e.lineWidth=1.5,_e.strokeStyle="white",_e.textBaseline="top",_e.font="bold 36px Open Sans, sans-serif",_e.fillText(Y,5,5),_e.strokeText(Y,5,5),le.debugOverlayTexture.update(se),le.debugOverlayTexture.bind(fe.LINEAR,fe.CLAMP_TO_EDGE)}(n,ee+" "+G+"kb"),S.draw(c,v.TRIANGLES,z,C,ue.alphaBlended,he.disabled,bo(w,a.Color.transparent,re),"$debug",n.debugBuffer,n.quadTriangleIndexBuffer,n.debugSegments)}var So={symbol:function(n,s,o,c,v){if(n.renderPass==="translucent"){var w=W.disabled,S=n.colorModeForRenderPass();o.layout.get("text-variable-anchor")&&function(z,C,O,Z,G,H,re){for(var ee=C.transform,le=G==="map",Y=H==="map",se=0,fe=z;se<fe.length;se+=1){var _e=fe[se],Te=Z.getTile(_e),Se=Te.getBucket(O);if(Se&&Se.text&&Se.text.segments.get().length){var Ae=a.evaluateSizeForZoom(Se.textSizeData,ee.zoom),Oe=Pr(Te,1,C.transform.zoom),He=Or(_e.posMatrix,Y,le,C.transform,Oe),Ze=O.layout.get("icon-text-fit")!=="none"&&Se.hasIconData();if(Ae){var ct=Math.pow(2,ee.zoom-Te.tileID.overscaledZ);xc(Se,le,Y,re,a.symbolSize,ee,He,_e.posMatrix,ct,Ae,Ze)}}}}(c,n,o,s,o.layout.get("text-rotation-alignment"),o.layout.get("text-pitch-alignment"),v),o.paint.get("icon-opacity").constantOr(1)!==0&&wo(n,s,o,c,!1,o.paint.get("icon-translate"),o.paint.get("icon-translate-anchor"),o.layout.get("icon-rotation-alignment"),o.layout.get("icon-pitch-alignment"),o.layout.get("icon-keep-upright"),w,S),o.paint.get("text-opacity").constantOr(1)!==0&&wo(n,s,o,c,!0,o.paint.get("text-translate"),o.paint.get("text-translate-anchor"),o.layout.get("text-rotation-alignment"),o.layout.get("text-pitch-alignment"),o.layout.get("text-keep-upright"),w,S),s.map.showCollisionBoxes&&(qo(n,s,o,c,o.paint.get("text-translate"),o.paint.get("text-translate-anchor"),!0),qo(n,s,o,c,o.paint.get("icon-translate"),o.paint.get("icon-translate-anchor"),!1))}},circle:function(n,s,o,c){if(n.renderPass==="translucent"){var v=o.paint.get("circle-opacity"),w=o.paint.get("circle-stroke-width"),S=o.paint.get("circle-stroke-opacity"),z=o.layout.get("circle-sort-key").constantOr(1)!==void 0;if(v.constantOr(1)!==0||w.constantOr(1)!==0&&S.constantOr(1)!==0){for(var C=n.context,O=C.gl,Z=n.depthModeForSublayer(0,K.ReadOnly),G=W.disabled,H=n.colorModeForRenderPass(),re=[],ee=0;ee<c.length;ee++){var le=c[ee],Y=s.getTile(le),se=Y.getBucket(o);if(se){var fe=se.programConfigurations.get(o.id),_e={programConfiguration:fe,program:n.useProgram("circle",fe),layoutVertexBuffer:se.layoutVertexBuffer,indexBuffer:se.indexBuffer,uniformValues:Hl(n,le,Y,o)};if(z)for(var Te=0,Se=se.segments.get();Te<Se.length;Te+=1){var Ae=Se[Te];re.push({segments:new a.SegmentVector([Ae]),sortKey:Ae.sortKey,state:_e})}else re.push({segments:se.segments,sortKey:0,state:_e})}}z&&re.sort(function(Et,Ct){return Et.sortKey-Ct.sortKey});for(var Oe=0,He=re;Oe<He.length;Oe+=1){var Ze=He[Oe],ct=Ze.state;ct.program.draw(C,O.TRIANGLES,Z,G,H,he.disabled,ct.uniformValues,o.id,ct.layoutVertexBuffer,ct.indexBuffer,Ze.segments,o.paint,n.transform.zoom,ct.programConfiguration)}}}},heatmap:function(n,s,o,c){if(o.paint.get("heatmap-opacity")!==0)if(n.renderPass==="offscreen"){var v=n.context,w=v.gl,S=W.disabled,z=new ue([w.ONE,w.ONE],a.Color.transparent,[!0,!0,!0,!0]);(function(re,ee,le){var Y=re.gl;re.activeTexture.set(Y.TEXTURE1),re.viewport.set([0,0,ee.width/4,ee.height/4]);var se=le.heatmapFbo;if(se)Y.bindTexture(Y.TEXTURE_2D,se.colorAttachment.get()),re.bindFramebuffer.set(se.framebuffer);else{var fe=Y.createTexture();Y.bindTexture(Y.TEXTURE_2D,fe),Y.texParameteri(Y.TEXTURE_2D,Y.TEXTURE_WRAP_S,Y.CLAMP_TO_EDGE),Y.texParameteri(Y.TEXTURE_2D,Y.TEXTURE_WRAP_T,Y.CLAMP_TO_EDGE),Y.texParameteri(Y.TEXTURE_2D,Y.TEXTURE_MIN_FILTER,Y.LINEAR),Y.texParameteri(Y.TEXTURE_2D,Y.TEXTURE_MAG_FILTER,Y.LINEAR),se=le.heatmapFbo=re.createFramebuffer(ee.width/4,ee.height/4,!1),function(_e,Te,Se,Ae){var Oe=_e.gl;Oe.texImage2D(Oe.TEXTURE_2D,0,Oe.RGBA,Te.width/4,Te.height/4,0,Oe.RGBA,_e.extRenderToTextureHalfFloat?_e.extTextureHalfFloat.HALF_FLOAT_OES:Oe.UNSIGNED_BYTE,null),Ae.colorAttachment.set(Se)}(re,ee,fe,se)}})(v,n,o),v.clear({color:a.Color.transparent});for(var C=0;C<c.length;C++){var O=c[C];if(!s.hasRenderableParent(O)){var Z=s.getTile(O),G=Z.getBucket(o);if(G){var H=G.programConfigurations.get(o.id);n.useProgram("heatmap",H).draw(v,w.TRIANGLES,K.disabled,S,z,he.disabled,yc(O.posMatrix,Z,n.transform.zoom,o.paint.get("heatmap-intensity")),o.id,G.layoutVertexBuffer,G.indexBuffer,G.segments,o.paint,n.transform.zoom,H)}}}v.viewport.set([0,0,n.width,n.height])}else n.renderPass==="translucent"&&(n.context.setColorMode(n.colorModeForRenderPass()),function(re,ee){var le=re.context,Y=le.gl,se=ee.heatmapFbo;if(se){le.activeTexture.set(Y.TEXTURE0),Y.bindTexture(Y.TEXTURE_2D,se.colorAttachment.get()),le.activeTexture.set(Y.TEXTURE1);var fe=ee.colorRampTexture;fe||(fe=ee.colorRampTexture=new a.Texture(le,ee.colorRamp,Y.RGBA)),fe.bind(Y.LINEAR,Y.CLAMP_TO_EDGE),re.useProgram("heatmapTexture").draw(le,Y.TRIANGLES,K.disabled,W.disabled,re.colorModeForRenderPass(),he.disabled,function(_e,Te,Se,Ae){var Oe=a.create();a.ortho(Oe,0,_e.width,_e.height,0,0,1);var He=_e.context.gl;return{u_matrix:Oe,u_world:[He.drawingBufferWidth,He.drawingBufferHeight],u_image:0,u_color_ramp:1,u_opacity:Te.paint.get("heatmap-opacity")}}(re,ee),ee.id,re.viewportBuffer,re.quadTriangleIndexBuffer,re.viewportSegments,ee.paint,re.transform.zoom)}}(n,o))},line:function(n,s,o,c){if(n.renderPass==="translucent"){var v=o.paint.get("line-opacity"),w=o.paint.get("line-width");if(v.constantOr(1)!==0&&w.constantOr(1)!==0)for(var S=n.depthModeForSublayer(0,K.ReadOnly),z=n.colorModeForRenderPass(),C=o.paint.get("line-dasharray"),O=o.paint.get("line-pattern"),Z=O.constantOr(1),G=o.paint.get("line-gradient"),H=o.getCrossfadeParameters(),re=Z?"linePattern":C?"lineSDF":G?"lineGradient":"line",ee=n.context,le=ee.gl,Y=!0,se=0,fe=c;se<fe.length;se+=1){var _e=fe[se],Te=s.getTile(_e);if(!Z||Te.patternsLoaded()){var Se=Te.getBucket(o);if(Se){var Ae=Se.programConfigurations.get(o.id),Oe=n.context.program.get(),He=n.useProgram(re,Ae),Ze=Y||He.program!==Oe,ct=O.constantOr(null);if(ct&&Te.imageAtlas){var Et=Te.imageAtlas,Ct=Et.patternPositions[ct.to.toString()],It=Et.patternPositions[ct.from.toString()];Ct&&It&&Ae.setConstantPatternPositions(Ct,It)}var dr=Z?qs(n,Te,o,H):C?Zh(n,Te,o,C,H):G?Fr(n,Te,o,Se.lineClipsArray.length):hs(n,Te,o);if(Z)ee.activeTexture.set(le.TEXTURE0),Te.imageAtlasTexture.bind(le.LINEAR,le.CLAMP_TO_EDGE),Ae.updatePaintBuffers(H);else if(C&&(Ze||n.lineAtlas.dirty))ee.activeTexture.set(le.TEXTURE0),n.lineAtlas.bind(ee);else if(G){var pt=Se.gradients[o.id],Ut=pt.texture;if(o.gradientVersion!==pt.version){var Xt=256;if(o.stepInterpolant){var Nt=s.getSource().maxzoom,Bt=_e.canonical.z===Nt?Math.ceil(1<<n.transform.maxZoom-_e.canonical.z):1;Xt=a.clamp(a.nextPowerOfTwo(Se.maxLineLength/a.EXTENT*1024*Bt),256,ee.maxTextureSize)}pt.gradient=a.renderColorRamp({expression:o.gradientExpression(),evaluationKey:"lineProgress",resolution:Xt,image:pt.gradient||void 0,clips:Se.lineClipsArray}),pt.texture?pt.texture.update(pt.gradient):pt.texture=new a.Texture(ee,pt.gradient,le.RGBA),pt.version=o.gradientVersion,Ut=pt.texture}ee.activeTexture.set(le.TEXTURE0),Ut.bind(o.stepInterpolant?le.NEAREST:le.LINEAR,le.CLAMP_TO_EDGE)}He.draw(ee,le.TRIANGLES,S,n.stencilModeForClipping(_e),z,he.disabled,dr,o.id,Se.layoutVertexBuffer,Se.indexBuffer,Se.segments,o.paint,n.transform.zoom,Ae,Se.layoutVertexBuffer2),Y=!1}}}}},fill:function(n,s,o,c){var v=o.paint.get("fill-color"),w=o.paint.get("fill-opacity");if(w.constantOr(1)!==0){var S=n.colorModeForRenderPass(),z=o.paint.get("fill-pattern"),C=n.opaquePassEnabledForLayer()&&!z.constantOr(1)&&v.constantOr(a.Color.transparent).a===1&&w.constantOr(0)===1?"opaque":"translucent";if(n.renderPass===C){var O=n.depthModeForSublayer(1,n.renderPass==="opaque"?K.ReadWrite:K.ReadOnly);Gs(n,s,o,c,O,S,!1)}if(n.renderPass==="translucent"&&o.paint.get("fill-antialias")){var Z=n.depthModeForSublayer(o.getPaintProperty("fill-outline-color")?2:0,K.ReadOnly);Gs(n,s,o,c,Z,S,!0)}}},"fill-extrusion":function(n,s,o,c){var v=o.paint.get("fill-extrusion-opacity");if(v!==0&&n.renderPass==="translucent"){var w=new K(n.context.gl.LEQUAL,K.ReadWrite,n.depthRangeFor3D);if(v!==1||o.paint.get("fill-extrusion-pattern").constantOr(1))Xl(n,s,o,c,w,W.disabled,ue.disabled),Xl(n,s,o,c,w,n.stencilModeFor3D(),n.colorModeForRenderPass());else{var S=n.colorModeForRenderPass();Xl(n,s,o,c,w,W.disabled,S)}}},hillshade:function(n,s,o,c){if(n.renderPass==="offscreen"||n.renderPass==="translucent"){for(var v=n.context,w=n.depthModeForSublayer(0,K.ReadOnly),S=n.colorModeForRenderPass(),z=n.renderPass==="translucent"?n.stencilConfigForOverlap(c):[{},c],C=z[0],O=0,Z=z[1];O<Z.length;O+=1){var G=Z[O],H=s.getTile(G);H.needsHillshadePrepare&&n.renderPass==="offscreen"?Kh(n,H,o,w,W.disabled,S):n.renderPass==="translucent"&&Ks(n,H,o,w,C[G.overscaledZ],S)}v.viewport.set([0,0,n.width,n.height])}},raster:function(n,s,o,c){if(n.renderPass==="translucent"&&o.paint.get("raster-opacity")!==0&&c.length)for(var v=n.context,w=v.gl,S=s.getSource(),z=n.useProgram("raster"),C=n.colorModeForRenderPass(),O=S instanceof Dt?[{},c]:n.stencilConfigForOverlap(c),Z=O[0],G=O[1],H=G[G.length-1].overscaledZ,re=!n.options.moving,ee=0,le=G;ee<le.length;ee+=1){var Y=le[ee],se=n.depthModeForSublayer(Y.overscaledZ-H,o.paint.get("raster-opacity")===1?K.ReadWrite:K.ReadOnly,w.LESS),fe=s.getTile(Y),_e=n.transform.calculatePosMatrix(Y.toUnwrapped(),re);fe.registerFadeDuration(o.paint.get("raster-fade-duration"));var Te=s.findLoadedParent(Y,0),Se=Hs(fe,Te,s,o,n.transform),Ae=void 0,Oe=void 0,He=o.paint.get("raster-resampling")==="nearest"?w.NEAREST:w.LINEAR;v.activeTexture.set(w.TEXTURE0),fe.texture.bind(He,w.CLAMP_TO_EDGE,w.LINEAR_MIPMAP_NEAREST),v.activeTexture.set(w.TEXTURE1),Te?(Te.texture.bind(He,w.CLAMP_TO_EDGE,w.LINEAR_MIPMAP_NEAREST),Ae=Math.pow(2,Te.tileID.overscaledZ-fe.tileID.overscaledZ),Oe=[fe.tileID.canonical.x*Ae%1,fe.tileID.canonical.y*Ae%1]):fe.texture.bind(He,w.CLAMP_TO_EDGE,w.LINEAR_MIPMAP_NEAREST);var Ze=Gh(_e,Oe||[0,0],Ae||1,Se,o);S instanceof Dt?z.draw(v,w.TRIANGLES,se,W.disabled,C,he.disabled,Ze,o.id,S.boundsBuffer,n.quadTriangleIndexBuffer,S.boundsSegments):z.draw(v,w.TRIANGLES,se,Z[Y.overscaledZ],C,he.disabled,Ze,o.id,n.rasterBoundsBuffer,n.quadTriangleIndexBuffer,n.rasterBoundsSegments)}},background:function(n,s,o){var c=o.paint.get("background-color"),v=o.paint.get("background-opacity");if(v!==0){var w=n.context,S=w.gl,z=n.transform,C=z.tileSize,O=o.paint.get("background-pattern");if(!n.isPatternMissing(O)){var Z=!O&&c.a===1&&v===1&&n.opaquePassEnabledForLayer()?"opaque":"translucent";if(n.renderPass===Z){var G=W.disabled,H=n.depthModeForSublayer(0,Z==="opaque"?K.ReadWrite:K.ReadOnly),re=n.colorModeForRenderPass(),ee=n.useProgram(O?"backgroundPattern":"background"),le=z.coveringTiles({tileSize:C});O&&(w.activeTexture.set(S.TEXTURE0),n.imageManager.bind(n.context));for(var Y=o.getCrossfadeParameters(),se=0,fe=le;se<fe.length;se+=1){var _e=fe[se],Te=n.transform.calculatePosMatrix(_e.toUnwrapped()),Se=O?Vo(Te,v,n,O,{tileID:_e,tileSize:C},Y):fs(Te,v,c);ee.draw(w,S.TRIANGLES,H,G,re,he.disabled,Se,o.id,n.tileExtentBuffer,n.quadTriangleIndexBuffer,n.tileExtentSegments)}}}}},debug:function(n,s,o){for(var c=0;c<o.length;c++)Ec(n,s,o[c])},custom:function(n,s,o){var c=n.context,v=o.implementation;if(n.renderPass==="offscreen"){var w=v.prerender;w&&(n.setCustomLayerDefaults(),c.setColorMode(n.colorModeForRenderPass()),w.call(v,c.gl,n.transform.customLayerMatrix()),c.setDirty(),n.setBaseState())}else if(n.renderPass==="translucent"){n.setCustomLayerDefaults(),c.setColorMode(n.colorModeForRenderPass()),c.setStencilMode(W.disabled);var S=v.renderingMode==="3d"?new K(n.context.gl.LEQUAL,K.ReadWrite,n.depthRangeFor3D):n.depthModeForSublayer(0,K.ReadOnly);c.setDepthMode(S),v.render(c.gl,n.transform.customLayerMatrix()),c.setDirty(),n.setBaseState(),c.bindFramebuffer.set(null)}}},Kr=function(n,s){this.context=new q(n),this.transform=s,this._tileTextures={},this.setup(),this.numSublayers=Q.maxUnderzooming+Q.maxOverzooming+1,this.depthEpsilon=1/Math.pow(2,16),this.crossTileSymbolIndex=new ge,this.gpuTimers={}};Kr.prototype.resize=function(n,s){if(this.width=n*a.browser.devicePixelRatio,this.height=s*a.browser.devicePixelRatio,this.context.viewport.set([0,0,this.width,this.height]),this.style)for(var o=0,c=this.style._order;o<c.length;o+=1)this.style._layers[c[o]].resize()},Kr.prototype.setup=function(){var n=this.context,s=new a.StructArrayLayout2i4;s.emplaceBack(0,0),s.emplaceBack(a.EXTENT,0),s.emplaceBack(0,a.EXTENT),s.emplaceBack(a.EXTENT,a.EXTENT),this.tileExtentBuffer=n.createVertexBuffer(s,vi.members),this.tileExtentSegments=a.SegmentVector.simpleSegment(0,0,4,2);var o=new a.StructArrayLayout2i4;o.emplaceBack(0,0),o.emplaceBack(a.EXTENT,0),o.emplaceBack(0,a.EXTENT),o.emplaceBack(a.EXTENT,a.EXTENT),this.debugBuffer=n.createVertexBuffer(o,vi.members),this.debugSegments=a.SegmentVector.simpleSegment(0,0,4,5);var c=new a.StructArrayLayout4i8;c.emplaceBack(0,0,0,0),c.emplaceBack(a.EXTENT,0,a.EXTENT,0),c.emplaceBack(0,a.EXTENT,0,a.EXTENT),c.emplaceBack(a.EXTENT,a.EXTENT,a.EXTENT,a.EXTENT),this.rasterBoundsBuffer=n.createVertexBuffer(c,Re.members),this.rasterBoundsSegments=a.SegmentVector.simpleSegment(0,0,4,2);var v=new a.StructArrayLayout2i4;v.emplaceBack(0,0),v.emplaceBack(1,0),v.emplaceBack(0,1),v.emplaceBack(1,1),this.viewportBuffer=n.createVertexBuffer(v,vi.members),this.viewportSegments=a.SegmentVector.simpleSegment(0,0,4,2);var w=new a.StructArrayLayout1ui2;w.emplaceBack(0),w.emplaceBack(1),w.emplaceBack(3),w.emplaceBack(2),w.emplaceBack(0),this.tileBorderIndexBuffer=n.createIndexBuffer(w);var S=new a.StructArrayLayout3ui6;S.emplaceBack(0,1,2),S.emplaceBack(2,1,3),this.quadTriangleIndexBuffer=n.createIndexBuffer(S),this.emptyTexture=new a.Texture(n,{width:1,height:1,data:new Uint8Array([0,0,0,0])},n.gl.RGBA);var z=this.context.gl;this.stencilClearMode=new W({func:z.ALWAYS,mask:0},0,255,z.ZERO,z.ZERO,z.ZERO)},Kr.prototype.clearStencil=function(){var n=this.context,s=n.gl;this.nextStencilID=1,this.currentStencilSource=void 0;var o=a.create();a.ortho(o,0,this.width,this.height,0,0,1),a.scale(o,o,[s.drawingBufferWidth,s.drawingBufferHeight,0]),this.useProgram("clippingMask").draw(n,s.TRIANGLES,K.disabled,this.stencilClearMode,ue.disabled,he.disabled,xo(o),"$clipping",this.viewportBuffer,this.quadTriangleIndexBuffer,this.viewportSegments)},Kr.prototype._renderTileClippingMasks=function(n,s){if(this.currentStencilSource!==n.source&&n.isTileClipped()&&s&&s.length){this.currentStencilSource=n.source;var o=this.context,c=o.gl;this.nextStencilID+s.length>256&&this.clearStencil(),o.setColorMode(ue.disabled),o.setDepthMode(K.disabled);var v=this.useProgram("clippingMask");this._tileClippingMaskIDs={};for(var w=0,S=s;w<S.length;w+=1){var z=S[w],C=this._tileClippingMaskIDs[z.key]=this.nextStencilID++;v.draw(o,c.TRIANGLES,K.disabled,new W({func:c.ALWAYS,mask:0},C,255,c.KEEP,c.KEEP,c.REPLACE),ue.disabled,he.disabled,xo(z.posMatrix),"$clipping",this.tileExtentBuffer,this.quadTriangleIndexBuffer,this.tileExtentSegments)}}},Kr.prototype.stencilModeFor3D=function(){this.currentStencilSource=void 0,this.nextStencilID+1>256&&this.clearStencil();var n=this.nextStencilID++,s=this.context.gl;return new W({func:s.NOTEQUAL,mask:255},n,255,s.KEEP,s.KEEP,s.REPLACE)},Kr.prototype.stencilModeForClipping=function(n){var s=this.context.gl;return new W({func:s.EQUAL,mask:255},this._tileClippingMaskIDs[n.key],0,s.KEEP,s.KEEP,s.REPLACE)},Kr.prototype.stencilConfigForOverlap=function(n){var s,o=this.context.gl,c=n.sort(function(C,O){return O.overscaledZ-C.overscaledZ}),v=c[c.length-1].overscaledZ,w=c[0].overscaledZ-v+1;if(w>1){this.currentStencilSource=void 0,this.nextStencilID+w>256&&this.clearStencil();for(var S={},z=0;z<w;z++)S[z+v]=new W({func:o.GEQUAL,mask:255},z+this.nextStencilID,255,o.KEEP,o.KEEP,o.REPLACE);return this.nextStencilID+=w,[S,c]}return[(s={},s[v]=W.disabled,s),c]},Kr.prototype.colorModeForRenderPass=function(){var n=this.context.gl;return this._showOverdrawInspector?new ue([n.CONSTANT_COLOR,n.ONE],new a.Color(1/8,1/8,1/8,0),[!0,!0,!0,!0]):this.renderPass==="opaque"?ue.unblended:ue.alphaBlended},Kr.prototype.depthModeForSublayer=function(n,s,o){if(!this.opaquePassEnabledForLayer())return K.disabled;var c=1-((1+this.currentLayer)*this.numSublayers+n)*this.depthEpsilon;return new K(o||this.context.gl.LEQUAL,s,[c,c])},Kr.prototype.opaquePassEnabledForLayer=function(){return this.currentLayer<this.opaquePassCutoff},Kr.prototype.render=function(n,s){var o=this;this.style=n,this.options=s,this.lineAtlas=n.lineAtlas,this.imageManager=n.imageManager,this.glyphManager=n.glyphManager,this.symbolFadeChange=n.placement.symbolFadeChange(a.browser.now()),this.imageManager.beginFrame();var c=this.style._order,v=this.style.sourceCaches;for(var w in v){var S=v[w];S.used&&S.prepare(this.context)}var z,C,O={},Z={},G={};for(var H in v){var re=v[H];O[H]=re.getVisibleCoordinates(),Z[H]=O[H].slice().reverse(),G[H]=re.getVisibleCoordinates(!0).reverse()}this.opaquePassCutoff=1/0;for(var ee=0;ee<c.length;ee++)if(this.style._layers[c[ee]].is3D()){this.opaquePassCutoff=ee;break}this.renderPass="offscreen";for(var le=0,Y=c;le<Y.length;le+=1){var se=this.style._layers[Y[le]];if(se.hasOffscreenPass()&&!se.isHidden(this.transform.zoom)){var fe=Z[se.source];(se.type==="custom"||fe.length)&&this.renderLayer(this,v[se.source],se,fe)}}for(this.context.bindFramebuffer.set(null),this.context.clear({color:s.showOverdrawInspector?a.Color.black:a.Color.transparent,depth:1}),this.clearStencil(),this._showOverdrawInspector=s.showOverdrawInspector,this.depthRangeFor3D=[0,1-(n._order.length+2)*this.numSublayers*this.depthEpsilon],this.renderPass="opaque",this.currentLayer=c.length-1;this.currentLayer>=0;this.currentLayer--){var _e=this.style._layers[c[this.currentLayer]],Te=v[_e.source],Se=O[_e.source];this._renderTileClippingMasks(_e,Se),this.renderLayer(this,Te,_e,Se)}for(this.renderPass="translucent",this.currentLayer=0;this.currentLayer<c.length;this.currentLayer++){var Ae=this.style._layers[c[this.currentLayer]],Oe=v[Ae.source],He=(Ae.type==="symbol"?G:Z)[Ae.source];this._renderTileClippingMasks(Ae,O[Ae.source]),this.renderLayer(this,Oe,Ae,He)}this.options.showTileBoundaries&&(a.values(this.style._layers).forEach(function(Ze){Ze.source&&!Ze.isHidden(o.transform.zoom)&&(Ze.source!==(C&&C.id)&&(C=o.style.sourceCaches[Ze.source]),(!z||z.getSource().maxzoom<C.getSource().maxzoom)&&(z=C))}),z&&So.debug(this,z,z.getVisibleCoordinates())),this.options.showPadding&&function(Ze){var ct=Ze.transform.padding;Jl(Ze,Ze.transform.height-(ct.top||0),3,Wl),Jl(Ze,ct.bottom||0,3,Sc),Ql(Ze,ct.left||0,3,kc),Ql(Ze,Ze.transform.width-(ct.right||0),3,Xs);var Et=Ze.transform.centerPoint;(function(Ct,It,dr,pt){ms(Ct,It-1,dr-10,2,20,pt),ms(Ct,It-10,dr-1,20,2,pt)})(Ze,Et.x,Ze.transform.height-Et.y,Yl)}(this),this.context.setDefault()},Kr.prototype.renderLayer=function(n,s,o,c){o.isHidden(this.transform.zoom)||(o.type==="background"||o.type==="custom"||c.length)&&(this.id=o.id,this.gpuTimingStart(o),So[o.type](n,s,o,c,this.style.placement.variableOffsets),this.gpuTimingEnd())},Kr.prototype.gpuTimingStart=function(n){if(this.options.gpuTiming){var s=this.context.extTimerQuery,o=this.gpuTimers[n.id];o||(o=this.gpuTimers[n.id]={calls:0,cpuTime:0,query:s.createQueryEXT()}),o.calls++,s.beginQueryEXT(s.TIME_ELAPSED_EXT,o.query)}},Kr.prototype.gpuTimingEnd=function(){if(this.options.gpuTiming){var n=this.context.extTimerQuery;n.endQueryEXT(n.TIME_ELAPSED_EXT)}},Kr.prototype.collectGpuTimers=function(){var n=this.gpuTimers;return this.gpuTimers={},n},Kr.prototype.queryGpuTimers=function(n){var s={};for(var o in n){var c=n[o],v=this.context.extTimerQuery,w=v.getQueryObjectEXT(c.query,v.QUERY_RESULT_EXT)/1e6;v.deleteQueryEXT(c.query),s[o]=w}return s},Kr.prototype.translatePosMatrix=function(n,s,o,c,v){if(!o[0]&&!o[1])return n;var w=v?c==="map"?this.transform.angle:0:c==="viewport"?-this.transform.angle:0;if(w){var S=Math.sin(w),z=Math.cos(w);o=[o[0]*z-o[1]*S,o[0]*S+o[1]*z]}var C=[v?o[0]:Pr(s,o[0],this.transform.zoom),v?o[1]:Pr(s,o[1],this.transform.zoom),0],O=new Float32Array(16);return a.translate(O,n,C),O},Kr.prototype.saveTileTexture=function(n){var s=this._tileTextures[n.size[0]];s?s.push(n):this._tileTextures[n.size[0]]=[n]},Kr.prototype.getTileTexture=function(n){var s=this._tileTextures[n];return s&&s.length>0?s.pop():null},Kr.prototype.isPatternMissing=function(n){if(!n)return!1;if(!n.from||!n.to)return!0;var s=this.imageManager.getPattern(n.from.toString()),o=this.imageManager.getPattern(n.to.toString());return!s||!o},Kr.prototype.useProgram=function(n,s){this.cache=this.cache||{};var o=""+n+(s?s.cacheKey:"")+(this._showOverdrawInspector?"/overdraw":"");return this.cache[o]||(this.cache[o]=new cc(this.context,n,jh[n],s,vc[n],this._showOverdrawInspector)),this.cache[o]},Kr.prototype.setCustomLayerDefaults=function(){this.context.unbindVAO(),this.context.cullFace.setDefault(),this.context.activeTexture.setDefault(),this.context.pixelStoreUnpack.setDefault(),this.context.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.context.pixelStoreUnpackFlipY.setDefault()},Kr.prototype.setBaseState=function(){var n=this.context.gl;this.context.cullFace.set(!1),this.context.viewport.set([0,0,this.width,this.height]),this.context.blendEquation.set(n.FUNC_ADD)},Kr.prototype.initDebugOverlayCanvas=function(){this.debugOverlayCanvas==null&&(this.debugOverlayCanvas=a.window.document.createElement("canvas"),this.debugOverlayCanvas.width=512,this.debugOverlayCanvas.height=512,this.debugOverlayTexture=new a.Texture(this.context,this.debugOverlayCanvas,this.context.gl.RGBA))},Kr.prototype.destroy=function(){this.emptyTexture.destroy(),this.debugOverlayTexture&&this.debugOverlayTexture.destroy()};var Ws=function(n,s){this.points=n,this.planes=s};Ws.fromInvProjectionMatrix=function(n,s,o){var c=Math.pow(2,o),v=[[-1,1,-1,1],[1,1,-1,1],[1,-1,-1,1],[-1,-1,-1,1],[-1,1,1,1],[1,1,1,1],[1,-1,1,1],[-1,-1,1,1]].map(function(S){return a.transformMat4([],S,n)}).map(function(S){return a.scale$1([],S,1/S[3]/s*c)}),w=[[0,1,2],[6,5,4],[0,3,7],[2,1,5],[3,2,6],[0,4,5]].map(function(S){var z=a.sub([],v[S[0]],v[S[1]]),C=a.sub([],v[S[2]],v[S[1]]),O=a.normalize([],a.cross([],z,C)),Z=-a.dot(O,v[S[1]]);return O.concat(Z)});return new Ws(v,w)};var ko=function(n,s){this.min=n,this.max=s,this.center=a.scale$2([],a.add([],this.min,this.max),.5)};ko.prototype.quadrant=function(n){for(var s=[n%2==0,n<2],o=a.clone$2(this.min),c=a.clone$2(this.max),v=0;v<s.length;v++)o[v]=s[v]?this.min[v]:this.center[v],c[v]=s[v]?this.center[v]:this.max[v];return c[2]=this.max[2],new ko(o,c)},ko.prototype.distanceX=function(n){return Math.max(Math.min(this.max[0],n[0]),this.min[0])-n[0]},ko.prototype.distanceY=function(n){return Math.max(Math.min(this.max[1],n[1]),this.min[1])-n[1]},ko.prototype.intersects=function(n){for(var s=[[this.min[0],this.min[1],0,1],[this.max[0],this.min[1],0,1],[this.max[0],this.max[1],0,1],[this.min[0],this.max[1],0,1]],o=!0,c=0;c<n.planes.length;c++){for(var v=n.planes[c],w=0,S=0;S<s.length;S++)w+=a.dot$1(v,s[S])>=0;if(w===0)return 0;w!==s.length&&(o=!1)}if(o)return 2;for(var z=0;z<3;z++){for(var C=Number.MAX_VALUE,O=-Number.MAX_VALUE,Z=0;Z<n.points.length;Z++){var G=n.points[Z][z]-this.min[z];C=Math.min(C,G),O=Math.max(O,G)}if(O<0||C>this.max[z]-this.min[z])return 0}return 1};var Xa=function(n,s,o,c){if(n===void 0&&(n=0),s===void 0&&(s=0),o===void 0&&(o=0),c===void 0&&(c=0),isNaN(n)||n<0||isNaN(s)||s<0||isNaN(o)||o<0||isNaN(c)||c<0)throw new Error("Invalid value for edge-insets, top, bottom, left and right must all be numbers");this.top=n,this.bottom=s,this.left=o,this.right=c};Xa.prototype.interpolate=function(n,s,o){return s.top!=null&&n.top!=null&&(this.top=a.number(n.top,s.top,o)),s.bottom!=null&&n.bottom!=null&&(this.bottom=a.number(n.bottom,s.bottom,o)),s.left!=null&&n.left!=null&&(this.left=a.number(n.left,s.left,o)),s.right!=null&&n.right!=null&&(this.right=a.number(n.right,s.right,o)),this},Xa.prototype.getCenter=function(n,s){var o=a.clamp((this.left+n-this.right)/2,0,n),c=a.clamp((this.top+s-this.bottom)/2,0,s);return new a.Point(o,c)},Xa.prototype.equals=function(n){return this.top===n.top&&this.bottom===n.bottom&&this.left===n.left&&this.right===n.right},Xa.prototype.clone=function(){return new Xa(this.top,this.bottom,this.left,this.right)},Xa.prototype.toJSON=function(){return{top:this.top,bottom:this.bottom,left:this.left,right:this.right}};var cr=function(n,s,o,c,v){this.tileSize=512,this.maxValidLatitude=85.051129,this._renderWorldCopies=v===void 0||v,this._minZoom=n||0,this._maxZoom=s||22,this._minPitch=o??0,this._maxPitch=c??60,this.setMaxBounds(),this.width=0,this.height=0,this._center=new a.LngLat(0,0),this.zoom=0,this.angle=0,this._fov=.6435011087932844,this._pitch=0,this._unmodified=!0,this._edgeInsets=new Xa,this._posMatrixCache={},this._alignedPosMatrixCache={}},Nr={minZoom:{configurable:!0},maxZoom:{configurable:!0},minPitch:{configurable:!0},maxPitch:{configurable:!0},renderWorldCopies:{configurable:!0},worldSize:{configurable:!0},centerOffset:{configurable:!0},size:{configurable:!0},bearing:{configurable:!0},pitch:{configurable:!0},fov:{configurable:!0},zoom:{configurable:!0},center:{configurable:!0},padding:{configurable:!0},centerPoint:{configurable:!0},unmodified:{configurable:!0},point:{configurable:!0}};cr.prototype.clone=function(){var n=new cr(this._minZoom,this._maxZoom,this._minPitch,this.maxPitch,this._renderWorldCopies);return n.tileSize=this.tileSize,n.latRange=this.latRange,n.width=this.width,n.height=this.height,n._center=this._center,n.zoom=this.zoom,n.angle=this.angle,n._fov=this._fov,n._pitch=this._pitch,n._unmodified=this._unmodified,n._edgeInsets=this._edgeInsets.clone(),n._calcMatrices(),n},Nr.minZoom.get=function(){return this._minZoom},Nr.minZoom.set=function(n){this._minZoom!==n&&(this._minZoom=n,this.zoom=Math.max(this.zoom,n))},Nr.maxZoom.get=function(){return this._maxZoom},Nr.maxZoom.set=function(n){this._maxZoom!==n&&(this._maxZoom=n,this.zoom=Math.min(this.zoom,n))},Nr.minPitch.get=function(){return this._minPitch},Nr.minPitch.set=function(n){this._minPitch!==n&&(this._minPitch=n,this.pitch=Math.max(this.pitch,n))},Nr.maxPitch.get=function(){return this._maxPitch},Nr.maxPitch.set=function(n){this._maxPitch!==n&&(this._maxPitch=n,this.pitch=Math.min(this.pitch,n))},Nr.renderWorldCopies.get=function(){return this._renderWorldCopies},Nr.renderWorldCopies.set=function(n){n===void 0?n=!0:n===null&&(n=!1),this._renderWorldCopies=n},Nr.worldSize.get=function(){return this.tileSize*this.scale},Nr.centerOffset.get=function(){return this.centerPoint._sub(this.size._div(2))},Nr.size.get=function(){return new a.Point(this.width,this.height)},Nr.bearing.get=function(){return-this.angle/Math.PI*180},Nr.bearing.set=function(n){var s=-a.wrap(n,-180,180)*Math.PI/180;this.angle!==s&&(this._unmodified=!1,this.angle=s,this._calcMatrices(),this.rotationMatrix=a.create$2(),a.rotate(this.rotationMatrix,this.rotationMatrix,this.angle))},Nr.pitch.get=function(){return this._pitch/Math.PI*180},Nr.pitch.set=function(n){var s=a.clamp(n,this.minPitch,this.maxPitch)/180*Math.PI;this._pitch!==s&&(this._unmodified=!1,this._pitch=s,this._calcMatrices())},Nr.fov.get=function(){return this._fov/Math.PI*180},Nr.fov.set=function(n){n=Math.max(.01,Math.min(60,n)),this._fov!==n&&(this._unmodified=!1,this._fov=n/180*Math.PI,this._calcMatrices())},Nr.zoom.get=function(){return this._zoom},Nr.zoom.set=function(n){var s=Math.min(Math.max(n,this.minZoom),this.maxZoom);this._zoom!==s&&(this._unmodified=!1,this._zoom=s,this.scale=this.zoomScale(s),this.tileZoom=Math.floor(s),this.zoomFraction=s-this.tileZoom,this._constrain(),this._calcMatrices())},Nr.center.get=function(){return this._center},Nr.center.set=function(n){n.lat===this._center.lat&&n.lng===this._center.lng||(this._unmodified=!1,this._center=n,this._constrain(),this._calcMatrices())},Nr.padding.get=function(){return this._edgeInsets.toJSON()},Nr.padding.set=function(n){this._edgeInsets.equals(n)||(this._unmodified=!1,this._edgeInsets.interpolate(this._edgeInsets,n,1),this._calcMatrices())},Nr.centerPoint.get=function(){return this._edgeInsets.getCenter(this.width,this.height)},cr.prototype.isPaddingEqual=function(n){return this._edgeInsets.equals(n)},cr.prototype.interpolatePadding=function(n,s,o){this._unmodified=!1,this._edgeInsets.interpolate(n,s,o),this._constrain(),this._calcMatrices()},cr.prototype.coveringZoomLevel=function(n){var s=(n.roundZoom?Math.round:Math.floor)(this.zoom+this.scaleZoom(this.tileSize/n.tileSize));return Math.max(0,s)},cr.prototype.getVisibleUnwrappedCoordinates=function(n){var s=[new a.UnwrappedTileID(0,n)];if(this._renderWorldCopies)for(var o=this.pointCoordinate(new a.Point(0,0)),c=this.pointCoordinate(new a.Point(this.width,0)),v=this.pointCoordinate(new a.Point(this.width,this.height)),w=this.pointCoordinate(new a.Point(0,this.height)),S=Math.floor(Math.min(o.x,c.x,v.x,w.x)),z=Math.floor(Math.max(o.x,c.x,v.x,w.x)),C=S-1;C<=z+1;C++)C!==0&&s.push(new a.UnwrappedTileID(C,n));return s},cr.prototype.coveringTiles=function(n){var s=this.coveringZoomLevel(n),o=s;if(n.minzoom!==void 0&&s<n.minzoom)return[];n.maxzoom!==void 0&&s>n.maxzoom&&(s=n.maxzoom);var c=a.MercatorCoordinate.fromLngLat(this.center),v=Math.pow(2,s),w=[v*c.x,v*c.y,0],S=Ws.fromInvProjectionMatrix(this.invProjMatrix,this.worldSize,s),z=n.minzoom||0;this.pitch<=60&&this._edgeInsets.top<.1&&(z=s);var C=function(Ze){return{aabb:new ko([Ze*v,0,0],[(Ze+1)*v,v,0]),zoom:0,x:0,y:0,wrap:Ze,fullyVisible:!1}},O=[],Z=[],G=s,H=n.reparseOverscaled?o:s;if(this._renderWorldCopies)for(var re=1;re<=3;re++)O.push(C(-re)),O.push(C(re));for(O.push(C(0));O.length>0;){var ee=O.pop(),le=ee.x,Y=ee.y,se=ee.fullyVisible;if(!se){var fe=ee.aabb.intersects(S);if(fe===0)continue;se=fe===2}var _e=ee.aabb.distanceX(w),Te=ee.aabb.distanceY(w),Se=Math.max(Math.abs(_e),Math.abs(Te));if(ee.zoom===G||Se>3+(1<<G-ee.zoom)-2&&ee.zoom>=z)Z.push({tileID:new a.OverscaledTileID(ee.zoom===G?H:ee.zoom,ee.wrap,ee.zoom,le,Y),distanceSq:a.sqrLen([w[0]-.5-le,w[1]-.5-Y])});else for(var Ae=0;Ae<4;Ae++){var Oe=(le<<1)+Ae%2,He=(Y<<1)+(Ae>>1);O.push({aabb:ee.aabb.quadrant(Ae),zoom:ee.zoom+1,x:Oe,y:He,wrap:ee.wrap,fullyVisible:se})}}return Z.sort(function(Ze,ct){return Ze.distanceSq-ct.distanceSq}).map(function(Ze){return Ze.tileID})},cr.prototype.resize=function(n,s){this.width=n,this.height=s,this.pixelsToGLUnits=[2/n,-2/s],this._constrain(),this._calcMatrices()},Nr.unmodified.get=function(){return this._unmodified},cr.prototype.zoomScale=function(n){return Math.pow(2,n)},cr.prototype.scaleZoom=function(n){return Math.log(n)/Math.LN2},cr.prototype.project=function(n){var s=a.clamp(n.lat,-this.maxValidLatitude,this.maxValidLatitude);return new a.Point(a.mercatorXfromLng(n.lng)*this.worldSize,a.mercatorYfromLat(s)*this.worldSize)},cr.prototype.unproject=function(n){return new a.MercatorCoordinate(n.x/this.worldSize,n.y/this.worldSize).toLngLat()},Nr.point.get=function(){return this.project(this.center)},cr.prototype.setLocationAtPoint=function(n,s){var o=this.pointCoordinate(s),c=this.pointCoordinate(this.centerPoint),v=this.locationCoordinate(n),w=new a.MercatorCoordinate(v.x-(o.x-c.x),v.y-(o.y-c.y));this.center=this.coordinateLocation(w),this._renderWorldCopies&&(this.center=this.center.wrap())},cr.prototype.locationPoint=function(n){return this.coordinatePoint(this.locationCoordinate(n))},cr.prototype.pointLocation=function(n){return this.coordinateLocation(this.pointCoordinate(n))},cr.prototype.locationCoordinate=function(n){return a.MercatorCoordinate.fromLngLat(n)},cr.prototype.coordinateLocation=function(n){return n.toLngLat()},cr.prototype.pointCoordinate=function(n){var s=[n.x,n.y,0,1],o=[n.x,n.y,1,1];a.transformMat4(s,s,this.pixelMatrixInverse),a.transformMat4(o,o,this.pixelMatrixInverse);var c=s[3],v=o[3],w=s[1]/c,S=o[1]/v,z=s[2]/c,C=o[2]/v,O=z===C?0:(0-z)/(C-z);return new a.MercatorCoordinate(a.number(s[0]/c,o[0]/v,O)/this.worldSize,a.number(w,S,O)/this.worldSize)},cr.prototype.coordinatePoint=function(n){var s=[n.x*this.worldSize,n.y*this.worldSize,0,1];return a.transformMat4(s,s,this.pixelMatrix),new a.Point(s[0]/s[3],s[1]/s[3])},cr.prototype.getBounds=function(){return new a.LngLatBounds().extend(this.pointLocation(new a.Point(0,0))).extend(this.pointLocation(new a.Point(this.width,0))).extend(this.pointLocation(new a.Point(this.width,this.height))).extend(this.pointLocation(new a.Point(0,this.height)))},cr.prototype.getMaxBounds=function(){return this.latRange&&this.latRange.length===2&&this.lngRange&&this.lngRange.length===2?new a.LngLatBounds([this.lngRange[0],this.latRange[0]],[this.lngRange[1],this.latRange[1]]):null},cr.prototype.setMaxBounds=function(n){n?(this.lngRange=[n.getWest(),n.getEast()],this.latRange=[n.getSouth(),n.getNorth()],this._constrain()):(this.lngRange=null,this.latRange=[-this.maxValidLatitude,this.maxValidLatitude])},cr.prototype.calculatePosMatrix=function(n,s){s===void 0&&(s=!1);var o=n.key,c=s?this._alignedPosMatrixCache:this._posMatrixCache;if(c[o])return c[o];var v=n.canonical,w=this.worldSize/this.zoomScale(v.z),S=v.x+Math.pow(2,v.z)*n.wrap,z=a.identity(new Float64Array(16));return a.translate(z,z,[S*w,v.y*w,0]),a.scale(z,z,[w/a.EXTENT,w/a.EXTENT,1]),a.multiply(z,s?this.alignedProjMatrix:this.projMatrix,z),c[o]=new Float32Array(z),c[o]},cr.prototype.customLayerMatrix=function(){return this.mercatorMatrix.slice()},cr.prototype._constrain=function(){if(this.center&&this.width&&this.height&&!this._constraining){this._constraining=!0;var n,s,o,c,v=-90,w=90,S=-180,z=180,C=this.size,O=this._unmodified;if(this.latRange){var Z=this.latRange;v=a.mercatorYfromLat(Z[1])*this.worldSize,n=(w=a.mercatorYfromLat(Z[0])*this.worldSize)-v<C.y?C.y/(w-v):0}if(this.lngRange){var G=this.lngRange;S=a.mercatorXfromLng(G[0])*this.worldSize,s=(z=a.mercatorXfromLng(G[1])*this.worldSize)-S<C.x?C.x/(z-S):0}var H=this.point,re=Math.max(s||0,n||0);if(re)return this.center=this.unproject(new a.Point(s?(z+S)/2:H.x,n?(w+v)/2:H.y)),this.zoom+=this.scaleZoom(re),this._unmodified=O,void(this._constraining=!1);if(this.latRange){var ee=H.y,le=C.y/2;ee-le<v&&(c=v+le),ee+le>w&&(c=w-le)}if(this.lngRange){var Y=H.x,se=C.x/2;Y-se<S&&(o=S+se),Y+se>z&&(o=z-se)}o===void 0&&c===void 0||(this.center=this.unproject(new a.Point(o!==void 0?o:H.x,c!==void 0?c:H.y))),this._unmodified=O,this._constraining=!1}},cr.prototype._calcMatrices=function(){if(this.height){var n=this.centerOffset;this.cameraToCenterDistance=.5/Math.tan(this._fov/2)*this.height;var s=Math.PI/2+this._pitch,o=this._fov*(.5+n.y/this.height),c=Math.sin(o)*this.cameraToCenterDistance/Math.sin(a.clamp(Math.PI-s-o,.01,Math.PI-.01)),v=this.point,w=v.x,S=v.y,z=1.01*(Math.cos(Math.PI/2-this._pitch)*c+this.cameraToCenterDistance),C=this.height/50,O=new Float64Array(16);a.perspective(O,this._fov,this.width/this.height,C,z),O[8]=2*-n.x/this.width,O[9]=2*n.y/this.height,a.scale(O,O,[1,-1,1]),a.translate(O,O,[0,0,-this.cameraToCenterDistance]),a.rotateX(O,O,this._pitch),a.rotateZ(O,O,this.angle),a.translate(O,O,[-w,-S,0]),this.mercatorMatrix=a.scale([],O,[this.worldSize,this.worldSize,this.worldSize]),a.scale(O,O,[1,1,a.mercatorZfromAltitude(1,this.center.lat)*this.worldSize,1]),this.projMatrix=O,this.invProjMatrix=a.invert([],this.projMatrix);var Z=this.width%2/2,G=this.height%2/2,H=Math.cos(this.angle),re=Math.sin(this.angle),ee=w-Math.round(w)+H*Z+re*G,le=S-Math.round(S)+H*G+re*Z,Y=new Float64Array(O);if(a.translate(Y,Y,[ee>.5?ee-1:ee,le>.5?le-1:le,0]),this.alignedProjMatrix=Y,O=a.create(),a.scale(O,O,[this.width/2,-this.height/2,1]),a.translate(O,O,[1,-1,0]),this.labelPlaneMatrix=O,O=a.create(),a.scale(O,O,[1,-1,1]),a.translate(O,O,[-1,-1,0]),a.scale(O,O,[2/this.width,2/this.height,1]),this.glCoordMatrix=O,this.pixelMatrix=a.multiply(new Float64Array(16),this.labelPlaneMatrix,this.projMatrix),!(O=a.invert(new Float64Array(16),this.pixelMatrix)))throw new Error("failed to invert matrix");this.pixelMatrixInverse=O,this._posMatrixCache={},this._alignedPosMatrixCache={}}},cr.prototype.maxPitchScaleFactor=function(){if(!this.pixelMatrixInverse)return 1;var n=this.pointCoordinate(new a.Point(0,0)),s=[n.x*this.worldSize,n.y*this.worldSize,0,1];return a.transformMat4(s,s,this.pixelMatrix)[3]/this.cameraToCenterDistance},cr.prototype.getCameraPoint=function(){var n=Math.tan(this._pitch)*(this.cameraToCenterDistance||1);return this.centerPoint.add(new a.Point(0,n))},cr.prototype.getCameraQueryGeometry=function(n){var s=this.getCameraPoint();if(n.length===1)return[n[0],s];for(var o=s.x,c=s.y,v=s.x,w=s.y,S=0,z=n;S<z.length;S+=1){var C=z[S];o=Math.min(o,C.x),c=Math.min(c,C.y),v=Math.max(v,C.x),w=Math.max(w,C.y)}return[new a.Point(o,c),new a.Point(v,c),new a.Point(v,w),new a.Point(o,w),new a.Point(o,c)]},Object.defineProperties(cr.prototype,Nr);var Qn=function(n){var s,o,c,v;this._hashName=n&&encodeURIComponent(n),a.bindAll(["_getCurrentHash","_onHashChange","_updateHash"],this),this._updateHash=(s=this._updateHashUnthrottled.bind(this),o=!1,c=null,v=function(){c=null,o&&(s(),c=setTimeout(v,300),o=!1)},function(){return o=!0,c||v(),c})};Qn.prototype.addTo=function(n){return this._map=n,a.window.addEventListener("hashchange",this._onHashChange,!1),this._map.on("moveend",this._updateHash),this},Qn.prototype.remove=function(){return a.window.removeEventListener("hashchange",this._onHashChange,!1),this._map.off("moveend",this._updateHash),clearTimeout(this._updateHash()),delete this._map,this},Qn.prototype.getHashString=function(n){var s=this._map.getCenter(),o=Math.round(100*this._map.getZoom())/100,c=Math.ceil((o*Math.LN2+Math.log(512/360/.5))/Math.LN10),v=Math.pow(10,c),w=Math.round(s.lng*v)/v,S=Math.round(s.lat*v)/v,z=this._map.getBearing(),C=this._map.getPitch(),O="";if(O+=n?"/"+w+"/"+S+"/"+o:o+"/"+S+"/"+w,(z||C)&&(O+="/"+Math.round(10*z)/10),C&&(O+="/"+Math.round(C)),this._hashName){var Z=this._hashName,G=!1,H=a.window.location.hash.slice(1).split("&").map(function(re){var ee=re.split("=")[0];return ee===Z?(G=!0,ee+"="+O):re}).filter(function(re){return re});return G||H.push(Z+"="+O),"#"+H.join("&")}return"#"+O},Qn.prototype._getCurrentHash=function(){var n,s=this,o=a.window.location.hash.replace("#","");return this._hashName?(o.split("&").map(function(c){return c.split("=")}).forEach(function(c){c[0]===s._hashName&&(n=c)}),(n&&n[1]||"").split("/")):o.split("/")},Qn.prototype._onHashChange=function(){var n=this._getCurrentHash();if(n.length>=3&&!n.some(function(o){return isNaN(o)})){var s=this._map.dragRotate.isEnabled()&&this._map.touchZoomRotate.isEnabled()?+(n[3]||0):this._map.getBearing();return this._map.jumpTo({center:[+n[2],+n[1]],zoom:+n[0],bearing:s,pitch:+(n[4]||0)}),!0}return!1},Qn.prototype._updateHashUnthrottled=function(){var n=a.window.location.href.replace(/(#.+)?$/,this.getHashString());try{a.window.history.replaceState(a.window.history.state,null,n)}catch{}};var ys={linearity:.3,easing:a.bezier(0,0,.3,1)},jo=a.extend({deceleration:2500,maxSpeed:1400},ys),gs=a.extend({deceleration:20,maxSpeed:1400},ys),Hh=a.extend({deceleration:1e3,maxSpeed:360},ys),Xh=a.extend({deceleration:1e3,maxSpeed:90},ys),_s=function(n){this._map=n,this.clear()};function vs(n,s){(!n.duration||n.duration<s.duration)&&(n.duration=s.duration,n.easing=s.easing)}function Ca(n,s,o){var c=o.maxSpeed,v=o.linearity,w=o.deceleration,S=a.clamp(n*v/(s/1e3),-c,c),z=Math.abs(S)/(w*v);return{easing:o.easing,duration:1e3*z,amount:S*(z/2)}}_s.prototype.clear=function(){this._inertiaBuffer=[]},_s.prototype.record=function(n){this._drainInertiaBuffer(),this._inertiaBuffer.push({time:a.browser.now(),settings:n})},_s.prototype._drainInertiaBuffer=function(){for(var n=this._inertiaBuffer,s=a.browser.now();n.length>0&&s-n[0].time>160;)n.shift()},_s.prototype._onMoveEnd=function(n){if(this._drainInertiaBuffer(),!(this._inertiaBuffer.length<2)){for(var s={zoom:0,bearing:0,pitch:0,pan:new a.Point(0,0),pinchAround:void 0,around:void 0},o=0,c=this._inertiaBuffer;o<c.length;o+=1){var v=c[o].settings;s.zoom+=v.zoomDelta||0,s.bearing+=v.bearingDelta||0,s.pitch+=v.pitchDelta||0,v.panDelta&&s.pan._add(v.panDelta),v.around&&(s.around=v.around),v.pinchAround&&(s.pinchAround=v.pinchAround)}var w=this._inertiaBuffer[this._inertiaBuffer.length-1].time-this._inertiaBuffer[0].time,S={};if(s.pan.mag()){var z=Ca(s.pan.mag(),w,a.extend({},jo,n||{}));S.offset=s.pan.mult(z.amount/s.pan.mag()),S.center=this._map.transform.center,vs(S,z)}if(s.zoom){var C=Ca(s.zoom,w,gs);S.zoom=this._map.transform.zoom+C.amount,vs(S,C)}if(s.bearing){var O=Ca(s.bearing,w,Hh);S.bearing=this._map.transform.bearing+a.clamp(O.amount,-179,179),vs(S,O)}if(s.pitch){var Z=Ca(s.pitch,w,Xh);S.pitch=this._map.transform.pitch+Z.amount,vs(S,Z)}if(S.zoom||S.bearing){var G=s.pinchAround===void 0?s.around:s.pinchAround;S.around=G?this._map.unproject(G):this._map.getCenter()}return this.clear(),a.extend(S,{noMoveStart:!0})}};var Ti=function(n){function s(c,v,w,S){S===void 0&&(S={});var z=E.mousePos(v.getCanvasContainer(),w),C=v.unproject(z);n.call(this,c,a.extend({point:z,lngLat:C,originalEvent:w},S)),this._defaultPrevented=!1,this.target=v}n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s;var o={defaultPrevented:{configurable:!0}};return s.prototype.preventDefault=function(){this._defaultPrevented=!0},o.defaultPrevented.get=function(){return this._defaultPrevented},Object.defineProperties(s.prototype,o),s}(a.Event),bs=function(n){function s(c,v,w){var S=c==="touchend"?w.changedTouches:w.touches,z=E.touchPos(v.getCanvasContainer(),S),C=z.map(function(G){return v.unproject(G)}),O=z.reduce(function(G,H,re,ee){return G.add(H.div(ee.length))},new a.Point(0,0)),Z=v.unproject(O);n.call(this,c,{points:z,point:O,lngLats:C,lngLat:Z,originalEvent:w}),this._defaultPrevented=!1}n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s;var o={defaultPrevented:{configurable:!0}};return s.prototype.preventDefault=function(){this._defaultPrevented=!0},o.defaultPrevented.get=function(){return this._defaultPrevented},Object.defineProperties(s.prototype,o),s}(a.Event),zc=function(n){function s(c,v,w){n.call(this,c,{originalEvent:w}),this._defaultPrevented=!1}n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s;var o={defaultPrevented:{configurable:!0}};return s.prototype.preventDefault=function(){this._defaultPrevented=!0},o.defaultPrevented.get=function(){return this._defaultPrevented},Object.defineProperties(s.prototype,o),s}(a.Event),bi=function(n,s){this._map=n,this._clickTolerance=s.clickTolerance};bi.prototype.reset=function(){delete this._mousedownPos},bi.prototype.wheel=function(n){return this._firePreventable(new zc(n.type,this._map,n))},bi.prototype.mousedown=function(n,s){return this._mousedownPos=s,this._firePreventable(new Ti(n.type,this._map,n))},bi.prototype.mouseup=function(n){this._map.fire(new Ti(n.type,this._map,n))},bi.prototype.click=function(n,s){this._mousedownPos&&this._mousedownPos.dist(s)>=this._clickTolerance||this._map.fire(new Ti(n.type,this._map,n))},bi.prototype.dblclick=function(n){return this._firePreventable(new Ti(n.type,this._map,n))},bi.prototype.mouseover=function(n){this._map.fire(new Ti(n.type,this._map,n))},bi.prototype.mouseout=function(n){this._map.fire(new Ti(n.type,this._map,n))},bi.prototype.touchstart=function(n){return this._firePreventable(new bs(n.type,this._map,n))},bi.prototype.touchmove=function(n){this._map.fire(new bs(n.type,this._map,n))},bi.prototype.touchend=function(n){this._map.fire(new bs(n.type,this._map,n))},bi.prototype.touchcancel=function(n){this._map.fire(new bs(n.type,this._map,n))},bi.prototype._firePreventable=function(n){if(this._map.fire(n),n.defaultPrevented)return{}},bi.prototype.isEnabled=function(){return!0},bi.prototype.isActive=function(){return!1},bi.prototype.enable=function(){},bi.prototype.disable=function(){};var ft=function(n){this._map=n};ft.prototype.reset=function(){this._delayContextMenu=!1,delete this._contextMenuEvent},ft.prototype.mousemove=function(n){this._map.fire(new Ti(n.type,this._map,n))},ft.prototype.mousedown=function(){this._delayContextMenu=!0},ft.prototype.mouseup=function(){this._delayContextMenu=!1,this._contextMenuEvent&&(this._map.fire(new Ti("contextmenu",this._map,this._contextMenuEvent)),delete this._contextMenuEvent)},ft.prototype.contextmenu=function(n){this._delayContextMenu?this._contextMenuEvent=n:this._map.fire(new Ti(n.type,this._map,n)),this._map.listens("contextmenu")&&n.preventDefault()},ft.prototype.isEnabled=function(){return!0},ft.prototype.isActive=function(){return!1},ft.prototype.enable=function(){},ft.prototype.disable=function(){};var Nn=function(n,s){this._map=n,this._el=n.getCanvasContainer(),this._container=n.getContainer(),this._clickTolerance=s.clickTolerance||1};function Ys(n,s){for(var o={},c=0;c<n.length;c++)o[n[c].identifier]=s[c];return o}Nn.prototype.isEnabled=function(){return!!this._enabled},Nn.prototype.isActive=function(){return!!this._active},Nn.prototype.enable=function(){this.isEnabled()||(this._enabled=!0)},Nn.prototype.disable=function(){this.isEnabled()&&(this._enabled=!1)},Nn.prototype.mousedown=function(n,s){this.isEnabled()&&n.shiftKey&&n.button===0&&(E.disableDrag(),this._startPos=this._lastPos=s,this._active=!0)},Nn.prototype.mousemoveWindow=function(n,s){if(this._active){var o=s;if(!(this._lastPos.equals(o)||!this._box&&o.dist(this._startPos)<this._clickTolerance)){var c=this._startPos;this._lastPos=o,this._box||(this._box=E.create("div","mapboxgl-boxzoom",this._container),this._container.classList.add("mapboxgl-crosshair"),this._fireEvent("boxzoomstart",n));var v=Math.min(c.x,o.x),w=Math.max(c.x,o.x),S=Math.min(c.y,o.y),z=Math.max(c.y,o.y);E.setTransform(this._box,"translate("+v+"px,"+S+"px)"),this._box.style.width=w-v+"px",this._box.style.height=z-S+"px"}}},Nn.prototype.mouseupWindow=function(n,s){var o=this;if(this._active&&n.button===0){var c=this._startPos,v=s;if(this.reset(),E.suppressClick(),c.x!==v.x||c.y!==v.y)return this._map.fire(new a.Event("boxzoomend",{originalEvent:n})),{cameraAnimation:function(w){return w.fitScreenCoordinates(c,v,o._map.getBearing(),{linear:!0})}};this._fireEvent("boxzoomcancel",n)}},Nn.prototype.keydown=function(n){this._active&&n.keyCode===27&&(this.reset(),this._fireEvent("boxzoomcancel",n))},Nn.prototype.blur=function(){this.reset()},Nn.prototype.reset=function(){this._active=!1,this._container.classList.remove("mapboxgl-crosshair"),this._box&&(E.remove(this._box),this._box=null),E.enableDrag(),delete this._startPos,delete this._lastPos},Nn.prototype._fireEvent=function(n,s){return this._map.fire(new a.Event(n,{originalEvent:s}))};var Zo=function(n){this.reset(),this.numTouches=n.numTouches};Zo.prototype.reset=function(){delete this.centroid,delete this.startTime,delete this.touches,this.aborted=!1},Zo.prototype.touchstart=function(n,s,o){(this.centroid||o.length>this.numTouches)&&(this.aborted=!0),this.aborted||(this.startTime===void 0&&(this.startTime=n.timeStamp),o.length===this.numTouches&&(this.centroid=function(c){for(var v=new a.Point(0,0),w=0,S=c;w<S.length;w+=1)v._add(S[w]);return v.div(c.length)}(s),this.touches=Ys(o,s)))},Zo.prototype.touchmove=function(n,s,o){if(!this.aborted&&this.centroid){var c=Ys(o,s);for(var v in this.touches){var w=c[v];(!w||w.dist(this.touches[v])>30)&&(this.aborted=!0)}}},Zo.prototype.touchend=function(n,s,o){if((!this.centroid||n.timeStamp-this.startTime>500)&&(this.aborted=!0),o.length===0){var c=!this.aborted&&this.centroid;if(this.reset(),c)return c}};var fa=function(n){this.singleTap=new Zo(n),this.numTaps=n.numTaps,this.reset()};fa.prototype.reset=function(){this.lastTime=1/0,delete this.lastTap,this.count=0,this.singleTap.reset()},fa.prototype.touchstart=function(n,s,o){this.singleTap.touchstart(n,s,o)},fa.prototype.touchmove=function(n,s,o){this.singleTap.touchmove(n,s,o)},fa.prototype.touchend=function(n,s,o){var c=this.singleTap.touchend(n,s,o);if(c){var v=n.timeStamp-this.lastTime<500,w=!this.lastTap||this.lastTap.dist(c)<30;if(v&&w||this.reset(),this.count++,this.lastTime=n.timeStamp,this.lastTap=c,this.count===this.numTaps)return this.reset(),c}};var Un=function(){this._zoomIn=new fa({numTouches:1,numTaps:2}),this._zoomOut=new fa({numTouches:2,numTaps:1}),this.reset()};Un.prototype.reset=function(){this._active=!1,this._zoomIn.reset(),this._zoomOut.reset()},Un.prototype.touchstart=function(n,s,o){this._zoomIn.touchstart(n,s,o),this._zoomOut.touchstart(n,s,o)},Un.prototype.touchmove=function(n,s,o){this._zoomIn.touchmove(n,s,o),this._zoomOut.touchmove(n,s,o)},Un.prototype.touchend=function(n,s,o){var c=this,v=this._zoomIn.touchend(n,s,o),w=this._zoomOut.touchend(n,s,o);return v?(this._active=!0,n.preventDefault(),setTimeout(function(){return c.reset()},0),{cameraAnimation:function(S){return S.easeTo({duration:300,zoom:S.getZoom()+1,around:S.unproject(v)},{originalEvent:n})}}):w?(this._active=!0,n.preventDefault(),setTimeout(function(){return c.reset()},0),{cameraAnimation:function(S){return S.easeTo({duration:300,zoom:S.getZoom()-1,around:S.unproject(w)},{originalEvent:n})}}):void 0},Un.prototype.touchcancel=function(){this.reset()},Un.prototype.enable=function(){this._enabled=!0},Un.prototype.disable=function(){this._enabled=!1,this.reset()},Un.prototype.isEnabled=function(){return this._enabled},Un.prototype.isActive=function(){return this._active};var $l={0:1,2:2},tt=function(n){this.reset(),this._clickTolerance=n.clickTolerance||1};tt.prototype.blur=function(){this.reset()},tt.prototype.reset=function(){this._active=!1,this._moved=!1,delete this._lastPoint,delete this._eventButton},tt.prototype._correctButton=function(n,s){return!1},tt.prototype._move=function(n,s){return{}},tt.prototype.mousedown=function(n,s){if(!this._lastPoint){var o=E.mouseButton(n);this._correctButton(n,o)&&(this._lastPoint=s,this._eventButton=o)}},tt.prototype.mousemoveWindow=function(n,s){var o=this._lastPoint;if(o){if(n.preventDefault(),function(c,v){var w=$l[v];return c.buttons===void 0||(c.buttons&w)!==w}(n,this._eventButton))this.reset();else if(this._moved||!(s.dist(o)<this._clickTolerance))return this._moved=!0,this._lastPoint=s,this._move(o,s)}},tt.prototype.mouseupWindow=function(n){this._lastPoint&&E.mouseButton(n)===this._eventButton&&(this._moved&&E.suppressClick(),this.reset())},tt.prototype.enable=function(){this._enabled=!0},tt.prototype.disable=function(){this._enabled=!1,this.reset()},tt.prototype.isEnabled=function(){return this._enabled},tt.prototype.isActive=function(){return this._active};var eu=function(n){function s(){n.apply(this,arguments)}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype.mousedown=function(o,c){n.prototype.mousedown.call(this,o,c),this._lastPoint&&(this._active=!0)},s.prototype._correctButton=function(o,c){return c===0&&!o.ctrlKey},s.prototype._move=function(o,c){return{around:c,panDelta:c.sub(o)}},s}(tt),Js=function(n){function s(){n.apply(this,arguments)}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype._correctButton=function(o,c){return c===0&&o.ctrlKey||c===2},s.prototype._move=function(o,c){var v=.8*(c.x-o.x);if(v)return this._active=!0,{bearingDelta:v}},s.prototype.contextmenu=function(o){o.preventDefault()},s}(tt),tu=function(n){function s(){n.apply(this,arguments)}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype._correctButton=function(o,c){return c===0&&o.ctrlKey||c===2},s.prototype._move=function(o,c){var v=-.5*(c.y-o.y);if(v)return this._active=!0,{pitchDelta:v}},s.prototype.contextmenu=function(o){o.preventDefault()},s}(tt),ra=function(n){this._minTouches=1,this._clickTolerance=n.clickTolerance||1,this.reset()};ra.prototype.reset=function(){this._active=!1,this._touches={},this._sum=new a.Point(0,0)},ra.prototype.touchstart=function(n,s,o){return this._calculateTransform(n,s,o)},ra.prototype.touchmove=function(n,s,o){if(this._active&&!(o.length<this._minTouches))return n.preventDefault(),this._calculateTransform(n,s,o)},ra.prototype.touchend=function(n,s,o){this._calculateTransform(n,s,o),this._active&&o.length<this._minTouches&&this.reset()},ra.prototype.touchcancel=function(){this.reset()},ra.prototype._calculateTransform=function(n,s,o){o.length>0&&(this._active=!0);var c=Ys(o,s),v=new a.Point(0,0),w=new a.Point(0,0),S=0;for(var z in c){var C=c[z],O=this._touches[z];O&&(v._add(C),w._add(C.sub(O)),S++,c[z]=C)}if(this._touches=c,!(S<this._minTouches)&&w.mag()){var Z=w.div(S);if(this._sum._add(Z),!(this._sum.mag()<this._clickTolerance))return{around:v.div(S),panDelta:Z}}},ra.prototype.enable=function(){this._enabled=!0},ra.prototype.disable=function(){this._enabled=!1,this.reset()},ra.prototype.isEnabled=function(){return this._enabled},ra.prototype.isActive=function(){return this._active};var Vn=function(){this.reset()};function Qs(n,s,o){for(var c=0;c<n.length;c++)if(n[c].identifier===o)return s[c]}function $s(n,s){return Math.log(n/s)/Math.LN2}Vn.prototype.reset=function(){this._active=!1,delete this._firstTwoTouches},Vn.prototype._start=function(n){},Vn.prototype._move=function(n,s,o){return{}},Vn.prototype.touchstart=function(n,s,o){this._firstTwoTouches||o.length<2||(this._firstTwoTouches=[o[0].identifier,o[1].identifier],this._start([s[0],s[1]]))},Vn.prototype.touchmove=function(n,s,o){if(this._firstTwoTouches){n.preventDefault();var c=this._firstTwoTouches,v=c[1],w=Qs(o,s,c[0]),S=Qs(o,s,v);if(w&&S){var z=this._aroundCenter?null:w.add(S).div(2);return this._move([w,S],z,n)}}},Vn.prototype.touchend=function(n,s,o){if(this._firstTwoTouches){var c=this._firstTwoTouches,v=c[1],w=Qs(o,s,c[0]),S=Qs(o,s,v);w&&S||(this._active&&E.suppressClick(),this.reset())}},Vn.prototype.touchcancel=function(){this.reset()},Vn.prototype.enable=function(n){this._enabled=!0,this._aroundCenter=!!n&&n.around==="center"},Vn.prototype.disable=function(){this._enabled=!1,this.reset()},Vn.prototype.isEnabled=function(){return this._enabled},Vn.prototype.isActive=function(){return this._active};var qn=function(n){function s(){n.apply(this,arguments)}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype.reset=function(){n.prototype.reset.call(this),delete this._distance,delete this._startDistance},s.prototype._start=function(o){this._startDistance=this._distance=o[0].dist(o[1])},s.prototype._move=function(o,c){var v=this._distance;if(this._distance=o[0].dist(o[1]),this._active||!(Math.abs($s(this._distance,this._startDistance))<.1))return this._active=!0,{zoomDelta:$s(this._distance,v),pinchAround:c}},s}(Vn);function Ma(n,s){return 180*n.angleWith(s)/Math.PI}var Tc=function(n){function s(){n.apply(this,arguments)}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype.reset=function(){n.prototype.reset.call(this),delete this._minDiameter,delete this._startVector,delete this._vector},s.prototype._start=function(o){this._startVector=this._vector=o[0].sub(o[1]),this._minDiameter=o[0].dist(o[1])},s.prototype._move=function(o,c){var v=this._vector;if(this._vector=o[0].sub(o[1]),this._active||!this._isBelowThreshold(this._vector))return this._active=!0,{bearingDelta:Ma(this._vector,v),pinchAround:c}},s.prototype._isBelowThreshold=function(o){this._minDiameter=Math.min(this._minDiameter,o.mag());var c=25/(Math.PI*this._minDiameter)*360,v=Ma(o,this._startVector);return Math.abs(v)<c},s}(Vn);function xs(n){return Math.abs(n.y)>Math.abs(n.x)}var ru=function(n){function s(){n.apply(this,arguments)}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype.reset=function(){n.prototype.reset.call(this),this._valid=void 0,delete this._firstMove,delete this._lastPoints},s.prototype._start=function(o){this._lastPoints=o,xs(o[0].sub(o[1]))&&(this._valid=!1)},s.prototype._move=function(o,c,v){var w=o[0].sub(this._lastPoints[0]),S=o[1].sub(this._lastPoints[1]);if(this._valid=this.gestureBeginsVertically(w,S,v.timeStamp),this._valid)return this._lastPoints=o,this._active=!0,{pitchDelta:(w.y+S.y)/2*-.5}},s.prototype.gestureBeginsVertically=function(o,c,v){if(this._valid!==void 0)return this._valid;var w=o.mag()>=2,S=c.mag()>=2;if(w||S){if(!w||!S)return this._firstMove===void 0&&(this._firstMove=v),v-this._firstMove<100&&void 0;var z=o.y>0==c.y>0;return xs(o)&&xs(c)&&z}},s}(Vn),iu={panStep:100,bearingStep:15,pitchStep:10},da=function(){var n=iu;this._panStep=n.panStep,this._bearingStep=n.bearingStep,this._pitchStep=n.pitchStep,this._rotationDisabled=!1};function $n(n){return n*(2-n)}da.prototype.blur=function(){this.reset()},da.prototype.reset=function(){this._active=!1},da.prototype.keydown=function(n){var s=this;if(!(n.altKey||n.ctrlKey||n.metaKey)){var o=0,c=0,v=0,w=0,S=0;switch(n.keyCode){case 61:case 107:case 171:case 187:o=1;break;case 189:case 109:case 173:o=-1;break;case 37:n.shiftKey?c=-1:(n.preventDefault(),w=-1);break;case 39:n.shiftKey?c=1:(n.preventDefault(),w=1);break;case 38:n.shiftKey?v=1:(n.preventDefault(),S=-1);break;case 40:n.shiftKey?v=-1:(n.preventDefault(),S=1);break;default:return}return this._rotationDisabled&&(c=0,v=0),{cameraAnimation:function(z){var C=z.getZoom();z.easeTo({duration:300,easeId:"keyboardHandler",easing:$n,zoom:o?Math.round(C)+o*(n.shiftKey?2:1):C,bearing:z.getBearing()+c*s._bearingStep,pitch:z.getPitch()+v*s._pitchStep,offset:[-w*s._panStep,-S*s._panStep],center:z.getCenter()},{originalEvent:n})}}}},da.prototype.enable=function(){this._enabled=!0},da.prototype.disable=function(){this._enabled=!1,this.reset()},da.prototype.isEnabled=function(){return this._enabled},da.prototype.isActive=function(){return this._active},da.prototype.disableRotation=function(){this._rotationDisabled=!0},da.prototype.enableRotation=function(){this._rotationDisabled=!1};var ar=function(n,s){this._map=n,this._el=n.getCanvasContainer(),this._handler=s,this._delta=0,this._defaultZoomRate=.01,this._wheelZoomRate=1/450,a.bindAll(["_onTimeout"],this)};ar.prototype.setZoomRate=function(n){this._defaultZoomRate=n},ar.prototype.setWheelZoomRate=function(n){this._wheelZoomRate=n},ar.prototype.isEnabled=function(){return!!this._enabled},ar.prototype.isActive=function(){return!!this._active||this._finishTimeout!==void 0},ar.prototype.isZooming=function(){return!!this._zooming},ar.prototype.enable=function(n){this.isEnabled()||(this._enabled=!0,this._aroundCenter=n&&n.around==="center")},ar.prototype.disable=function(){this.isEnabled()&&(this._enabled=!1)},ar.prototype.wheel=function(n){if(this.isEnabled()){var s=n.deltaMode===a.window.WheelEvent.DOM_DELTA_LINE?40*n.deltaY:n.deltaY,o=a.browser.now(),c=o-(this._lastWheelEventTime||0);this._lastWheelEventTime=o,s!==0&&s%4.000244140625==0?this._type="wheel":s!==0&&Math.abs(s)<4?this._type="trackpad":c>400?(this._type=null,this._lastValue=s,this._timeout=setTimeout(this._onTimeout,40,n)):this._type||(this._type=Math.abs(c*s)<200?"trackpad":"wheel",this._timeout&&(clearTimeout(this._timeout),this._timeout=null,s+=this._lastValue)),n.shiftKey&&s&&(s/=4),this._type&&(this._lastWheelEvent=n,this._delta-=s,this._active||this._start(n)),n.preventDefault()}},ar.prototype._onTimeout=function(n){this._type="wheel",this._delta-=this._lastValue,this._active||this._start(n)},ar.prototype._start=function(n){if(this._delta){this._frameId&&(this._frameId=null),this._active=!0,this.isZooming()||(this._zooming=!0),this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout);var s=E.mousePos(this._el,n);this._around=a.LngLat.convert(this._aroundCenter?this._map.getCenter():this._map.unproject(s)),this._aroundPoint=this._map.transform.locationPoint(this._around),this._frameId||(this._frameId=!0,this._handler._triggerRenderFrame())}},ar.prototype.renderFrame=function(){var n=this;if(this._frameId&&(this._frameId=null,this.isActive())){var s=this._map.transform;if(this._delta!==0){var o=this._type==="wheel"&&Math.abs(this._delta)>4.000244140625?this._wheelZoomRate:this._defaultZoomRate,c=2/(1+Math.exp(-Math.abs(this._delta*o)));this._delta<0&&c!==0&&(c=1/c);var v=typeof this._targetZoom=="number"?s.zoomScale(this._targetZoom):s.scale;this._targetZoom=Math.min(s.maxZoom,Math.max(s.minZoom,s.scaleZoom(v*c))),this._type==="wheel"&&(this._startZoom=s.zoom,this._easing=this._smoothOutEasing(200)),this._delta=0}var w,S=typeof this._targetZoom=="number"?this._targetZoom:s.zoom,z=this._startZoom,C=this._easing,O=!1;if(this._type==="wheel"&&z&&C){var Z=Math.min((a.browser.now()-this._lastWheelEventTime)/200,1),G=C(Z);w=a.number(z,S,G),Z<1?this._frameId||(this._frameId=!0):O=!0}else w=S,O=!0;return this._active=!0,O&&(this._active=!1,this._finishTimeout=setTimeout(function(){n._zooming=!1,n._handler._triggerRenderFrame(),delete n._targetZoom,delete n._finishTimeout},200)),{noInertia:!0,needsRenderFrame:!O,zoomDelta:w-s.zoom,around:this._aroundPoint,originalEvent:this._lastWheelEvent}}},ar.prototype._smoothOutEasing=function(n){var s=a.ease;if(this._prevEase){var o=this._prevEase,c=(a.browser.now()-o.start)/o.duration,v=o.easing(c+.01)-o.easing(c),w=.27/Math.sqrt(v*v+1e-4)*.01,S=Math.sqrt(.0729-w*w);s=a.bezier(w,S,.25,1)}return this._prevEase={start:a.browser.now(),duration:n,easing:s},s},ar.prototype.blur=function(){this.reset()},ar.prototype.reset=function(){this._active=!1};var ka=function(n,s){this._clickZoom=n,this._tapZoom=s};ka.prototype.enable=function(){this._clickZoom.enable(),this._tapZoom.enable()},ka.prototype.disable=function(){this._clickZoom.disable(),this._tapZoom.disable()},ka.prototype.isEnabled=function(){return this._clickZoom.isEnabled()&&this._tapZoom.isEnabled()},ka.prototype.isActive=function(){return this._clickZoom.isActive()||this._tapZoom.isActive()};var ia=function(){this.reset()};ia.prototype.reset=function(){this._active=!1},ia.prototype.blur=function(){this.reset()},ia.prototype.dblclick=function(n,s){return n.preventDefault(),{cameraAnimation:function(o){o.easeTo({duration:300,zoom:o.getZoom()+(n.shiftKey?-1:1),around:o.unproject(s)},{originalEvent:n})}}},ia.prototype.enable=function(){this._enabled=!0},ia.prototype.disable=function(){this._enabled=!1,this.reset()},ia.prototype.isEnabled=function(){return this._enabled},ia.prototype.isActive=function(){return this._active};var $i=function(){this._tap=new fa({numTouches:1,numTaps:1}),this.reset()};$i.prototype.reset=function(){this._active=!1,delete this._swipePoint,delete this._swipeTouch,delete this._tapTime,this._tap.reset()},$i.prototype.touchstart=function(n,s,o){this._swipePoint||(this._tapTime&&n.timeStamp-this._tapTime>500&&this.reset(),this._tapTime?o.length>0&&(this._swipePoint=s[0],this._swipeTouch=o[0].identifier):this._tap.touchstart(n,s,o))},$i.prototype.touchmove=function(n,s,o){if(this._tapTime){if(this._swipePoint){if(o[0].identifier!==this._swipeTouch)return;var c=s[0],v=c.y-this._swipePoint.y;return this._swipePoint=c,n.preventDefault(),this._active=!0,{zoomDelta:v/128}}}else this._tap.touchmove(n,s,o)},$i.prototype.touchend=function(n,s,o){this._tapTime?this._swipePoint&&o.length===0&&this.reset():this._tap.touchend(n,s,o)&&(this._tapTime=n.timeStamp)},$i.prototype.touchcancel=function(){this.reset()},$i.prototype.enable=function(){this._enabled=!0},$i.prototype.disable=function(){this._enabled=!1,this.reset()},$i.prototype.isEnabled=function(){return this._enabled},$i.prototype.isActive=function(){return this._active};var Eo=function(n,s,o){this._el=n,this._mousePan=s,this._touchPan=o};Eo.prototype.enable=function(n){this._inertiaOptions=n||{},this._mousePan.enable(),this._touchPan.enable(),this._el.classList.add("mapboxgl-touch-drag-pan")},Eo.prototype.disable=function(){this._mousePan.disable(),this._touchPan.disable(),this._el.classList.remove("mapboxgl-touch-drag-pan")},Eo.prototype.isEnabled=function(){return this._mousePan.isEnabled()&&this._touchPan.isEnabled()},Eo.prototype.isActive=function(){return this._mousePan.isActive()||this._touchPan.isActive()};var Wa=function(n,s,o){this._pitchWithRotate=n.pitchWithRotate,this._mouseRotate=s,this._mousePitch=o};Wa.prototype.enable=function(){this._mouseRotate.enable(),this._pitchWithRotate&&this._mousePitch.enable()},Wa.prototype.disable=function(){this._mouseRotate.disable(),this._mousePitch.disable()},Wa.prototype.isEnabled=function(){return this._mouseRotate.isEnabled()&&(!this._pitchWithRotate||this._mousePitch.isEnabled())},Wa.prototype.isActive=function(){return this._mouseRotate.isActive()||this._mousePitch.isActive()};var ma=function(n,s,o,c){this._el=n,this._touchZoom=s,this._touchRotate=o,this._tapDragZoom=c,this._rotationDisabled=!1,this._enabled=!0};ma.prototype.enable=function(n){this._touchZoom.enable(n),this._rotationDisabled||this._touchRotate.enable(n),this._tapDragZoom.enable(),this._el.classList.add("mapboxgl-touch-zoom-rotate")},ma.prototype.disable=function(){this._touchZoom.disable(),this._touchRotate.disable(),this._tapDragZoom.disable(),this._el.classList.remove("mapboxgl-touch-zoom-rotate")},ma.prototype.isEnabled=function(){return this._touchZoom.isEnabled()&&(this._rotationDisabled||this._touchRotate.isEnabled())&&this._tapDragZoom.isEnabled()},ma.prototype.isActive=function(){return this._touchZoom.isActive()||this._touchRotate.isActive()||this._tapDragZoom.isActive()},ma.prototype.disableRotation=function(){this._rotationDisabled=!0,this._touchRotate.disable()},ma.prototype.enableRotation=function(){this._rotationDisabled=!1,this._touchZoom.isEnabled()&&this._touchRotate.enable()};var vn=function(n){return n.zoom||n.drag||n.pitch||n.rotate},ws=function(n){function s(){n.apply(this,arguments)}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s}(a.Event);function kt(n){return n.panDelta&&n.panDelta.mag()||n.zoomDelta||n.bearingDelta||n.pitchDelta}var mt=function(n,s){this._map=n,this._el=this._map.getCanvasContainer(),this._handlers=[],this._handlersById={},this._changes=[],this._inertia=new _s(n),this._bearingSnap=s.bearingSnap,this._previousActiveHandlers={},this._eventsInProgress={},this._addDefaultHandlers(s),a.bindAll(["handleEvent","handleWindowEvent"],this);var o=this._el;this._listeners=[[o,"touchstart",{passive:!0}],[o,"touchmove",{passive:!1}],[o,"touchend",void 0],[o,"touchcancel",void 0],[o,"mousedown",void 0],[o,"mousemove",void 0],[o,"mouseup",void 0],[a.window.document,"mousemove",{capture:!0}],[a.window.document,"mouseup",void 0],[o,"mouseover",void 0],[o,"mouseout",void 0],[o,"dblclick",void 0],[o,"click",void 0],[o,"keydown",{capture:!1}],[o,"keyup",void 0],[o,"wheel",{passive:!1}],[o,"contextmenu",void 0],[a.window,"blur",void 0]];for(var c=0,v=this._listeners;c<v.length;c+=1){var w=v[c],S=w[0];E.addEventListener(S,w[1],S===a.window.document?this.handleWindowEvent:this.handleEvent,w[2])}};mt.prototype.destroy=function(){for(var n=0,s=this._listeners;n<s.length;n+=1){var o=s[n],c=o[0];E.removeEventListener(c,o[1],c===a.window.document?this.handleWindowEvent:this.handleEvent,o[2])}},mt.prototype._addDefaultHandlers=function(n){var s=this._map,o=s.getCanvasContainer();this._add("mapEvent",new bi(s,n));var c=s.boxZoom=new Nn(s,n);this._add("boxZoom",c);var v=new Un,w=new ia;s.doubleClickZoom=new ka(w,v),this._add("tapZoom",v),this._add("clickZoom",w);var S=new $i;this._add("tapDragZoom",S);var z=s.touchPitch=new ru;this._add("touchPitch",z);var C=new Js(n),O=new tu(n);s.dragRotate=new Wa(n,C,O),this._add("mouseRotate",C,["mousePitch"]),this._add("mousePitch",O,["mouseRotate"]);var Z=new eu(n),G=new ra(n);s.dragPan=new Eo(o,Z,G),this._add("mousePan",Z),this._add("touchPan",G,["touchZoom","touchRotate"]);var H=new Tc,re=new qn;s.touchZoomRotate=new ma(o,re,H,S),this._add("touchRotate",H,["touchPan","touchZoom"]),this._add("touchZoom",re,["touchPan","touchRotate"]);var ee=s.scrollZoom=new ar(s,this);this._add("scrollZoom",ee,["mousePan"]);var le=s.keyboard=new da;this._add("keyboard",le),this._add("blockableMapEvent",new ft(s));for(var Y=0,se=["boxZoom","doubleClickZoom","tapDragZoom","touchPitch","dragRotate","dragPan","touchZoomRotate","scrollZoom","keyboard"];Y<se.length;Y+=1){var fe=se[Y];n.interactive&&n[fe]&&s[fe].enable(n[fe])}},mt.prototype._add=function(n,s,o){this._handlers.push({handlerName:n,handler:s,allowed:o}),this._handlersById[n]=s},mt.prototype.stop=function(n){if(!this._updatingCamera){for(var s=0,o=this._handlers;s<o.length;s+=1)o[s].handler.reset();this._inertia.clear(),this._fireEvents({},{},n),this._changes=[]}},mt.prototype.isActive=function(){for(var n=0,s=this._handlers;n<s.length;n+=1)if(s[n].handler.isActive())return!0;return!1},mt.prototype.isZooming=function(){return!!this._eventsInProgress.zoom||this._map.scrollZoom.isZooming()},mt.prototype.isRotating=function(){return!!this._eventsInProgress.rotate},mt.prototype.isMoving=function(){return!!vn(this._eventsInProgress)||this.isZooming()},mt.prototype._blockedByActive=function(n,s,o){for(var c in n)if(c!==o&&(!s||s.indexOf(c)<0))return!0;return!1},mt.prototype.handleWindowEvent=function(n){this.handleEvent(n,n.type+"Window")},mt.prototype._getMapTouches=function(n){for(var s=[],o=0,c=n;o<c.length;o+=1){var v=c[o];this._el.contains(v.target)&&s.push(v)}return s},mt.prototype.handleEvent=function(n,s){this._updatingCamera=!0;for(var o=n.type==="renderFrame"?void 0:n,c={needsRenderFrame:!1},v={},w={},S=n.touches?this._getMapTouches(n.touches):void 0,z=S?E.touchPos(this._el,S):E.mousePos(this._el,n),C=0,O=this._handlers;C<O.length;C+=1){var Z=O[C],G=Z.handlerName,H=Z.handler,re=Z.allowed;if(H.isEnabled()){var ee=void 0;this._blockedByActive(w,re,G)?H.reset():H[s||n.type]&&(ee=H[s||n.type](n,z,S),this.mergeHandlerResult(c,v,ee,G,o),ee&&ee.needsRenderFrame&&this._triggerRenderFrame()),(ee||H.isActive())&&(w[G]=H)}}var le={};for(var Y in this._previousActiveHandlers)w[Y]||(le[Y]=o);this._previousActiveHandlers=w,(Object.keys(le).length||kt(c))&&(this._changes.push([c,v,le]),this._triggerRenderFrame()),(Object.keys(w).length||kt(c))&&this._map._stop(!0),this._updatingCamera=!1;var se=c.cameraAnimation;se&&(this._inertia.clear(),this._fireEvents({},{},!0),this._changes=[],se(this._map))},mt.prototype.mergeHandlerResult=function(n,s,o,c,v){if(o){a.extend(n,o);var w={handlerName:c,originalEvent:o.originalEvent||v};o.zoomDelta!==void 0&&(s.zoom=w),o.panDelta!==void 0&&(s.drag=w),o.pitchDelta!==void 0&&(s.pitch=w),o.bearingDelta!==void 0&&(s.rotate=w)}},mt.prototype._applyChanges=function(){for(var n={},s={},o={},c=0,v=this._changes;c<v.length;c+=1){var w=v[c],S=w[0],z=w[1],C=w[2];S.panDelta&&(n.panDelta=(n.panDelta||new a.Point(0,0))._add(S.panDelta)),S.zoomDelta&&(n.zoomDelta=(n.zoomDelta||0)+S.zoomDelta),S.bearingDelta&&(n.bearingDelta=(n.bearingDelta||0)+S.bearingDelta),S.pitchDelta&&(n.pitchDelta=(n.pitchDelta||0)+S.pitchDelta),S.around!==void 0&&(n.around=S.around),S.pinchAround!==void 0&&(n.pinchAround=S.pinchAround),S.noInertia&&(n.noInertia=S.noInertia),a.extend(s,z),a.extend(o,C)}this._updateMapTransform(n,s,o),this._changes=[]},mt.prototype._updateMapTransform=function(n,s,o){var c=this._map,v=c.transform;if(!kt(n))return this._fireEvents(s,o,!0);var w=n.panDelta,S=n.zoomDelta,z=n.bearingDelta,C=n.pitchDelta,O=n.around,Z=n.pinchAround;Z!==void 0&&(O=Z),c._stop(!0),O=O||c.transform.centerPoint;var G=v.pointLocation(w?O.sub(w):O);z&&(v.bearing+=z),C&&(v.pitch+=C),S&&(v.zoom+=S),v.setLocationAtPoint(G,O),this._map._update(),n.noInertia||this._inertia.record(n),this._fireEvents(s,o,!0)},mt.prototype._fireEvents=function(n,s,o){var c=this,v=vn(this._eventsInProgress),w=vn(n),S={};for(var z in n)this._eventsInProgress[z]||(S[z+"start"]=n[z].originalEvent),this._eventsInProgress[z]=n[z];for(var C in!v&&w&&this._fireEvent("movestart",w.originalEvent),S)this._fireEvent(C,S[C]);for(var O in w&&this._fireEvent("move",w.originalEvent),n)this._fireEvent(O,n[O].originalEvent);var Z,G={};for(var H in this._eventsInProgress){var re=this._eventsInProgress[H],ee=re.handlerName,le=re.originalEvent;this._handlersById[ee].isActive()||(delete this._eventsInProgress[H],G[H+"end"]=Z=s[ee]||le)}for(var Y in G)this._fireEvent(Y,G[Y]);var se=vn(this._eventsInProgress);if(o&&(v||w)&&!se){this._updatingCamera=!0;var fe=this._inertia._onMoveEnd(this._map.dragPan._inertiaOptions),_e=function(Te){return Te!==0&&-c._bearingSnap<Te&&Te<c._bearingSnap};fe?(_e(fe.bearing||this._map.getBearing())&&(fe.bearing=0),this._map.easeTo(fe,{originalEvent:Z})):(this._map.fire(new a.Event("moveend",{originalEvent:Z})),_e(this._map.getBearing())&&this._map.resetNorth()),this._updatingCamera=!1}},mt.prototype._fireEvent=function(n,s){this._map.fire(new a.Event(n,s?{originalEvent:s}:{}))},mt.prototype._requestFrame=function(){var n=this;return this._map.triggerRepaint(),this._map._renderTaskQueue.add(function(s){delete n._frameId,n.handleEvent(new ws("renderFrame",{timeStamp:s})),n._applyChanges()})},mt.prototype._triggerRenderFrame=function(){this._frameId===void 0&&(this._frameId=this._requestFrame())};var el=function(n){function s(o,c){n.call(this),this._moving=!1,this._zooming=!1,this.transform=o,this._bearingSnap=c.bearingSnap,a.bindAll(["_renderFrameCallback"],this)}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype.getCenter=function(){return new a.LngLat(this.transform.center.lng,this.transform.center.lat)},s.prototype.setCenter=function(o,c){return this.jumpTo({center:o},c)},s.prototype.panBy=function(o,c,v){return o=a.Point.convert(o).mult(-1),this.panTo(this.transform.center,a.extend({offset:o},c),v)},s.prototype.panTo=function(o,c,v){return this.easeTo(a.extend({center:o},c),v)},s.prototype.getZoom=function(){return this.transform.zoom},s.prototype.setZoom=function(o,c){return this.jumpTo({zoom:o},c),this},s.prototype.zoomTo=function(o,c,v){return this.easeTo(a.extend({zoom:o},c),v)},s.prototype.zoomIn=function(o,c){return this.zoomTo(this.getZoom()+1,o,c),this},s.prototype.zoomOut=function(o,c){return this.zoomTo(this.getZoom()-1,o,c),this},s.prototype.getBearing=function(){return this.transform.bearing},s.prototype.setBearing=function(o,c){return this.jumpTo({bearing:o},c),this},s.prototype.getPadding=function(){return this.transform.padding},s.prototype.setPadding=function(o,c){return this.jumpTo({padding:o},c),this},s.prototype.rotateTo=function(o,c,v){return this.easeTo(a.extend({bearing:o},c),v)},s.prototype.resetNorth=function(o,c){return this.rotateTo(0,a.extend({duration:1e3},o),c),this},s.prototype.resetNorthPitch=function(o,c){return this.easeTo(a.extend({bearing:0,pitch:0,duration:1e3},o),c),this},s.prototype.snapToNorth=function(o,c){return Math.abs(this.getBearing())<this._bearingSnap?this.resetNorth(o,c):this},s.prototype.getPitch=function(){return this.transform.pitch},s.prototype.setPitch=function(o,c){return this.jumpTo({pitch:o},c),this},s.prototype.cameraForBounds=function(o,c){o=a.LngLatBounds.convert(o);var v=c&&c.bearing||0;return this._cameraForBoxAndBearing(o.getNorthWest(),o.getSouthEast(),v,c)},s.prototype._cameraForBoxAndBearing=function(o,c,v,w){var S={top:0,bottom:0,right:0,left:0};if(typeof(w=a.extend({padding:S,offset:[0,0],maxZoom:this.transform.maxZoom},w)).padding=="number"){var z=w.padding;w.padding={top:z,bottom:z,right:z,left:z}}w.padding=a.extend(S,w.padding);var C=this.transform,O=C.padding,Z=C.project(a.LngLat.convert(o)),G=C.project(a.LngLat.convert(c)),H=Z.rotate(-v*Math.PI/180),re=G.rotate(-v*Math.PI/180),ee=new a.Point(Math.max(H.x,re.x),Math.max(H.y,re.y)),le=new a.Point(Math.min(H.x,re.x),Math.min(H.y,re.y)),Y=ee.sub(le),se=(C.width-(O.left+O.right+w.padding.left+w.padding.right))/Y.x,fe=(C.height-(O.top+O.bottom+w.padding.top+w.padding.bottom))/Y.y;if(!(fe<0||se<0)){var _e=Math.min(C.scaleZoom(C.scale*Math.min(se,fe)),w.maxZoom),Te=typeof w.offset.x=="number"?new a.Point(w.offset.x,w.offset.y):a.Point.convert(w.offset),Se=new a.Point((w.padding.left-w.padding.right)/2,(w.padding.top-w.padding.bottom)/2).rotate(v*Math.PI/180),Ae=Te.add(Se).mult(C.scale/C.zoomScale(_e));return{center:C.unproject(Z.add(G).div(2).sub(Ae)),zoom:_e,bearing:v}}a.warnOnce("Map cannot fit within canvas with the given bounds, padding, and/or offset.")},s.prototype.fitBounds=function(o,c,v){return this._fitInternal(this.cameraForBounds(o,c),c,v)},s.prototype.fitScreenCoordinates=function(o,c,v,w,S){return this._fitInternal(this._cameraForBoxAndBearing(this.transform.pointLocation(a.Point.convert(o)),this.transform.pointLocation(a.Point.convert(c)),v,w),w,S)},s.prototype._fitInternal=function(o,c,v){return o?(delete(c=a.extend(o,c)).padding,c.linear?this.easeTo(c,v):this.flyTo(c,v)):this},s.prototype.jumpTo=function(o,c){this.stop();var v=this.transform,w=!1,S=!1,z=!1;return"zoom"in o&&v.zoom!==+o.zoom&&(w=!0,v.zoom=+o.zoom),o.center!==void 0&&(v.center=a.LngLat.convert(o.center)),"bearing"in o&&v.bearing!==+o.bearing&&(S=!0,v.bearing=+o.bearing),"pitch"in o&&v.pitch!==+o.pitch&&(z=!0,v.pitch=+o.pitch),o.padding==null||v.isPaddingEqual(o.padding)||(v.padding=o.padding),this.fire(new a.Event("movestart",c)).fire(new a.Event("move",c)),w&&this.fire(new a.Event("zoomstart",c)).fire(new a.Event("zoom",c)).fire(new a.Event("zoomend",c)),S&&this.fire(new a.Event("rotatestart",c)).fire(new a.Event("rotate",c)).fire(new a.Event("rotateend",c)),z&&this.fire(new a.Event("pitchstart",c)).fire(new a.Event("pitch",c)).fire(new a.Event("pitchend",c)),this.fire(new a.Event("moveend",c))},s.prototype.easeTo=function(o,c){var v=this;this._stop(!1,o.easeId),((o=a.extend({offset:[0,0],duration:500,easing:a.ease},o)).animate===!1||!o.essential&&a.browser.prefersReducedMotion)&&(o.duration=0);var w=this.transform,S=this.getZoom(),z=this.getBearing(),C=this.getPitch(),O=this.getPadding(),Z="zoom"in o?+o.zoom:S,G="bearing"in o?this._normalizeBearing(o.bearing,z):z,H="pitch"in o?+o.pitch:C,re="padding"in o?o.padding:w.padding,ee=a.Point.convert(o.offset),le=w.centerPoint.add(ee),Y=w.pointLocation(le),se=a.LngLat.convert(o.center||Y);this._normalizeCenter(se);var fe,_e,Te=w.project(Y),Se=w.project(se).sub(Te),Ae=w.zoomScale(Z-S);o.around&&(fe=a.LngLat.convert(o.around),_e=w.locationPoint(fe));var Oe={moving:this._moving,zooming:this._zooming,rotating:this._rotating,pitching:this._pitching};return this._zooming=this._zooming||Z!==S,this._rotating=this._rotating||z!==G,this._pitching=this._pitching||H!==C,this._padding=!w.isPaddingEqual(re),this._easeId=o.easeId,this._prepareEase(c,o.noMoveStart,Oe),this._ease(function(He){if(v._zooming&&(w.zoom=a.number(S,Z,He)),v._rotating&&(w.bearing=a.number(z,G,He)),v._pitching&&(w.pitch=a.number(C,H,He)),v._padding&&(w.interpolatePadding(O,re,He),le=w.centerPoint.add(ee)),fe)w.setLocationAtPoint(fe,_e);else{var Ze=w.zoomScale(w.zoom-S),ct=Z>S?Math.min(2,Ae):Math.max(.5,Ae),Et=Math.pow(ct,1-He),Ct=w.unproject(Te.add(Se.mult(He*Et)).mult(Ze));w.setLocationAtPoint(w.renderWorldCopies?Ct.wrap():Ct,le)}v._fireMoveEvents(c)},function(He){v._afterEase(c,He)},o),this},s.prototype._prepareEase=function(o,c,v){v===void 0&&(v={}),this._moving=!0,c||v.moving||this.fire(new a.Event("movestart",o)),this._zooming&&!v.zooming&&this.fire(new a.Event("zoomstart",o)),this._rotating&&!v.rotating&&this.fire(new a.Event("rotatestart",o)),this._pitching&&!v.pitching&&this.fire(new a.Event("pitchstart",o))},s.prototype._fireMoveEvents=function(o){this.fire(new a.Event("move",o)),this._zooming&&this.fire(new a.Event("zoom",o)),this._rotating&&this.fire(new a.Event("rotate",o)),this._pitching&&this.fire(new a.Event("pitch",o))},s.prototype._afterEase=function(o,c){if(!this._easeId||!c||this._easeId!==c){delete this._easeId;var v=this._zooming,w=this._rotating,S=this._pitching;this._moving=!1,this._zooming=!1,this._rotating=!1,this._pitching=!1,this._padding=!1,v&&this.fire(new a.Event("zoomend",o)),w&&this.fire(new a.Event("rotateend",o)),S&&this.fire(new a.Event("pitchend",o)),this.fire(new a.Event("moveend",o))}},s.prototype.flyTo=function(o,c){var v=this;if(!o.essential&&a.browser.prefersReducedMotion){var w=a.pick(o,["center","zoom","bearing","pitch","around"]);return this.jumpTo(w,c)}this.stop(),o=a.extend({offset:[0,0],speed:1.2,curve:1.42,easing:a.ease},o);var S=this.transform,z=this.getZoom(),C=this.getBearing(),O=this.getPitch(),Z=this.getPadding(),G="zoom"in o?a.clamp(+o.zoom,S.minZoom,S.maxZoom):z,H="bearing"in o?this._normalizeBearing(o.bearing,C):C,re="pitch"in o?+o.pitch:O,ee="padding"in o?o.padding:S.padding,le=S.zoomScale(G-z),Y=a.Point.convert(o.offset),se=S.centerPoint.add(Y),fe=S.pointLocation(se),_e=a.LngLat.convert(o.center||fe);this._normalizeCenter(_e);var Te=S.project(fe),Se=S.project(_e).sub(Te),Ae=o.curve,Oe=Math.max(S.width,S.height),He=Oe/le,Ze=Se.mag();if("minZoom"in o){var ct=a.clamp(Math.min(o.minZoom,z,G),S.minZoom,S.maxZoom),Et=Oe/S.zoomScale(ct-z);Ae=Math.sqrt(Et/Ze*2)}var Ct=Ae*Ae;function It(Rt){var Mt=(He*He-Oe*Oe+(Rt?-1:1)*Ct*Ct*Ze*Ze)/(2*(Rt?He:Oe)*Ct*Ze);return Math.log(Math.sqrt(Mt*Mt+1)-Mt)}function dr(Rt){return(Math.exp(Rt)-Math.exp(-Rt))/2}function pt(Rt){return(Math.exp(Rt)+Math.exp(-Rt))/2}var Ut=It(0),Xt=function(Rt){return pt(Ut)/pt(Ut+Ae*Rt)},Nt=function(Rt){return Oe*((pt(Ut)*(dr(Mt=Ut+Ae*Rt)/pt(Mt))-dr(Ut))/Ct)/Ze;var Mt},Bt=(It(1)-Ut)/Ae;if(Math.abs(Ze)<1e-6||!isFinite(Bt)){if(Math.abs(Oe-He)<1e-6)return this.easeTo(o,c);var Ht=He<Oe?-1:1;Bt=Math.abs(Math.log(He/Oe))/Ae,Nt=function(){return 0},Xt=function(Rt){return Math.exp(Ht*Ae*Rt)}}return o.duration="duration"in o?+o.duration:1e3*Bt/("screenSpeed"in o?+o.screenSpeed/Ae:+o.speed),o.maxDuration&&o.duration>o.maxDuration&&(o.duration=0),this._zooming=!0,this._rotating=C!==H,this._pitching=re!==O,this._padding=!S.isPaddingEqual(ee),this._prepareEase(c,!1),this._ease(function(Rt){var Mt=Rt*Bt,Bi=1/Xt(Mt);S.zoom=Rt===1?G:z+S.scaleZoom(Bi),v._rotating&&(S.bearing=a.number(C,H,Rt)),v._pitching&&(S.pitch=a.number(O,re,Rt)),v._padding&&(S.interpolatePadding(Z,ee,Rt),se=S.centerPoint.add(Y));var ni=Rt===1?_e:S.unproject(Te.add(Se.mult(Nt(Mt))).mult(Bi));S.setLocationAtPoint(S.renderWorldCopies?ni.wrap():ni,se),v._fireMoveEvents(c)},function(){return v._afterEase(c)},o),this},s.prototype.isEasing=function(){return!!this._easeFrameId},s.prototype.stop=function(){return this._stop()},s.prototype._stop=function(o,c){if(this._easeFrameId&&(this._cancelRenderFrame(this._easeFrameId),delete this._easeFrameId,delete this._onEaseFrame),this._onEaseEnd){var v=this._onEaseEnd;delete this._onEaseEnd,v.call(this,c)}if(!o){var w=this.handlers;w&&w.stop(!1)}return this},s.prototype._ease=function(o,c,v){v.animate===!1||v.duration===0?(o(1),c()):(this._easeStart=a.browser.now(),this._easeOptions=v,this._onEaseFrame=o,this._onEaseEnd=c,this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback))},s.prototype._renderFrameCallback=function(){var o=Math.min((a.browser.now()-this._easeStart)/this._easeOptions.duration,1);this._onEaseFrame(this._easeOptions.easing(o)),o<1?this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback):this.stop()},s.prototype._normalizeBearing=function(o,c){o=a.wrap(o,-180,180);var v=Math.abs(o-c);return Math.abs(o-360-c)<v&&(o-=360),Math.abs(o+360-c)<v&&(o+=360),o},s.prototype._normalizeCenter=function(o){var c=this.transform;if(c.renderWorldCopies&&!c.lngRange){var v=o.lng-c.center.lng;o.lng+=v>180?-360:v<-180?360:0}},s}(a.Evented),bn=function(n){n===void 0&&(n={}),this.options=n,a.bindAll(["_toggleAttribution","_updateEditLink","_updateData","_updateCompact"],this)};bn.prototype.getDefaultPosition=function(){return"bottom-right"},bn.prototype.onAdd=function(n){var s=this.options&&this.options.compact;return this._map=n,this._container=E.create("div","mapboxgl-ctrl mapboxgl-ctrl-attrib"),this._compactButton=E.create("button","mapboxgl-ctrl-attrib-button",this._container),this._compactButton.addEventListener("click",this._toggleAttribution),this._setElementTitle(this._compactButton,"ToggleAttribution"),this._innerContainer=E.create("div","mapboxgl-ctrl-attrib-inner",this._container),this._innerContainer.setAttribute("role","list"),s&&this._container.classList.add("mapboxgl-compact"),this._updateAttributions(),this._updateEditLink(),this._map.on("styledata",this._updateData),this._map.on("sourcedata",this._updateData),this._map.on("moveend",this._updateEditLink),s===void 0&&(this._map.on("resize",this._updateCompact),this._updateCompact()),this._container},bn.prototype.onRemove=function(){E.remove(this._container),this._map.off("styledata",this._updateData),this._map.off("sourcedata",this._updateData),this._map.off("moveend",this._updateEditLink),this._map.off("resize",this._updateCompact),this._map=void 0,this._attribHTML=void 0},bn.prototype._setElementTitle=function(n,s){var o=this._map._getUIString("AttributionControl."+s);n.title=o,n.setAttribute("aria-label",o)},bn.prototype._toggleAttribution=function(){this._container.classList.contains("mapboxgl-compact-show")?(this._container.classList.remove("mapboxgl-compact-show"),this._compactButton.setAttribute("aria-pressed","false")):(this._container.classList.add("mapboxgl-compact-show"),this._compactButton.setAttribute("aria-pressed","true"))},bn.prototype._updateEditLink=function(){var n=this._editLink;n||(n=this._editLink=this._container.querySelector(".mapbox-improve-map"));var s=[{key:"owner",value:this.styleOwner},{key:"id",value:this.styleId},{key:"access_token",value:this._map._requestManager._customAccessToken||a.config.ACCESS_TOKEN}];if(n){var o=s.reduce(function(c,v,w){return v.value&&(c+=v.key+"="+v.value+(w<s.length-1?"&":"")),c},"?");n.href=a.config.FEEDBACK_URL+"/"+o+(this._map._hash?this._map._hash.getHashString(!0):""),n.rel="noopener nofollow",this._setElementTitle(n,"MapFeedback")}},bn.prototype._updateData=function(n){!n||n.sourceDataType!=="metadata"&&n.sourceDataType!=="visibility"&&n.dataType!=="style"||(this._updateAttributions(),this._updateEditLink())},bn.prototype._updateAttributions=function(){if(this._map.style){var n=[];if(this.options.customAttribution&&(Array.isArray(this.options.customAttribution)?n=n.concat(this.options.customAttribution.map(function(z){return typeof z!="string"?"":z})):typeof this.options.customAttribution=="string"&&n.push(this.options.customAttribution)),this._map.style.stylesheet){var s=this._map.style.stylesheet;this.styleOwner=s.owner,this.styleId=s.id}var o=this._map.style.sourceCaches;for(var c in o){var v=o[c];if(v.used){var w=v.getSource();w.attribution&&n.indexOf(w.attribution)<0&&n.push(w.attribution)}}n.sort(function(z,C){return z.length-C.length});var S=(n=n.filter(function(z,C){for(var O=C+1;O<n.length;O++)if(n[O].indexOf(z)>=0)return!1;return!0})).join(" | ");S!==this._attribHTML&&(this._attribHTML=S,n.length?(this._innerContainer.innerHTML=S,this._container.classList.remove("mapboxgl-attrib-empty")):this._container.classList.add("mapboxgl-attrib-empty"),this._editLink=null)}},bn.prototype._updateCompact=function(){this._map.getCanvasContainer().offsetWidth<=640?this._container.classList.add("mapboxgl-compact"):this._container.classList.remove("mapboxgl-compact","mapboxgl-compact-show")};var ya=function(){a.bindAll(["_updateLogo"],this),a.bindAll(["_updateCompact"],this)};ya.prototype.onAdd=function(n){this._map=n,this._container=E.create("div","mapboxgl-ctrl");var s=E.create("a","mapboxgl-ctrl-logo");return s.target="_blank",s.rel="noopener nofollow",s.href="https://www.mapbox.com/",s.setAttribute("aria-label",this._map._getUIString("LogoControl.Title")),s.setAttribute("rel","noopener nofollow"),this._container.appendChild(s),this._container.style.display="none",this._map.on("sourcedata",this._updateLogo),this._updateLogo(),this._map.on("resize",this._updateCompact),this._updateCompact(),this._container},ya.prototype.onRemove=function(){E.remove(this._container),this._map.off("sourcedata",this._updateLogo),this._map.off("resize",this._updateCompact)},ya.prototype.getDefaultPosition=function(){return"bottom-left"},ya.prototype._updateLogo=function(n){n&&n.sourceDataType!=="metadata"||(this._container.style.display=this._logoRequired()?"block":"none")},ya.prototype._logoRequired=function(){if(this._map.style){var n=this._map.style.sourceCaches;for(var s in n)if(n[s].getSource().mapbox_logo)return!0;return!1}},ya.prototype._updateCompact=function(){var n=this._container.children;if(n.length){var s=n[0];this._map.getCanvasContainer().offsetWidth<250?s.classList.add("mapboxgl-compact"):s.classList.remove("mapboxgl-compact")}};var en=function(){this._queue=[],this._id=0,this._cleared=!1,this._currentlyRunning=!1};en.prototype.add=function(n){var s=++this._id;return this._queue.push({callback:n,id:s,cancelled:!1}),s},en.prototype.remove=function(n){for(var s=this._currentlyRunning,o=0,c=s?this._queue.concat(s):this._queue;o<c.length;o+=1){var v=c[o];if(v.id===n)return void(v.cancelled=!0)}},en.prototype.run=function(n){n===void 0&&(n=0);var s=this._currentlyRunning=this._queue;this._queue=[];for(var o=0,c=s;o<c.length;o+=1){var v=c[o];if(!v.cancelled&&(v.callback(n),this._cleared))break}this._cleared=!1,this._currentlyRunning=!1},en.prototype.clear=function(){this._currentlyRunning&&(this._cleared=!0),this._queue=[]};var Ea={"AttributionControl.ToggleAttribution":"Toggle attribution","AttributionControl.MapFeedback":"Map feedback","FullscreenControl.Enter":"Enter fullscreen","FullscreenControl.Exit":"Exit fullscreen","GeolocateControl.FindMyLocation":"Find my location","GeolocateControl.LocationNotAvailable":"Location not available","LogoControl.Title":"Mapbox logo","NavigationControl.ResetBearing":"Reset bearing to north","NavigationControl.ZoomIn":"Zoom in","NavigationControl.ZoomOut":"Zoom out","ScaleControl.Feet":"ft","ScaleControl.Meters":"m","ScaleControl.Kilometers":"km","ScaleControl.Miles":"mi","ScaleControl.NauticalMiles":"nm"},nu=a.window.HTMLImageElement,tl=a.window.HTMLElement,Er=a.window.ImageBitmap,Gi={center:[0,0],zoom:0,bearing:0,pitch:0,minZoom:-2,maxZoom:22,minPitch:0,maxPitch:60,interactive:!0,scrollZoom:!0,boxZoom:!0,dragRotate:!0,dragPan:!0,keyboard:!0,doubleClickZoom:!0,touchZoomRotate:!0,touchPitch:!0,bearingSnap:7,clickTolerance:3,pitchWithRotate:!0,hash:!1,attributionControl:!0,failIfMajorPerformanceCaveat:!1,preserveDrawingBuffer:!1,trackResize:!0,renderWorldCopies:!0,refreshExpiredTiles:!0,maxTileCacheSize:null,localIdeographFontFamily:"sans-serif",transformRequest:null,accessToken:null,fadeDuration:300,crossSourceCollisions:!0},Ic=function(n){function s(c){var v=this;if((c=a.extend({},Gi,c)).minZoom!=null&&c.maxZoom!=null&&c.minZoom>c.maxZoom)throw new Error("maxZoom must be greater than or equal to minZoom");if(c.minPitch!=null&&c.maxPitch!=null&&c.minPitch>c.maxPitch)throw new Error("maxPitch must be greater than or equal to minPitch");if(c.minPitch!=null&&c.minPitch<0)throw new Error("minPitch must be greater than or equal to 0");if(c.maxPitch!=null&&c.maxPitch>60)throw new Error("maxPitch must be less than or equal to 60");var w=new cr(c.minZoom,c.maxZoom,c.minPitch,c.maxPitch,c.renderWorldCopies);if(n.call(this,w,c),this._interactive=c.interactive,this._maxTileCacheSize=c.maxTileCacheSize,this._failIfMajorPerformanceCaveat=c.failIfMajorPerformanceCaveat,this._preserveDrawingBuffer=c.preserveDrawingBuffer,this._antialias=c.antialias,this._trackResize=c.trackResize,this._bearingSnap=c.bearingSnap,this._refreshExpiredTiles=c.refreshExpiredTiles,this._fadeDuration=c.fadeDuration,this._crossSourceCollisions=c.crossSourceCollisions,this._crossFadingFactor=1,this._collectResourceTiming=c.collectResourceTiming,this._renderTaskQueue=new en,this._controls=[],this._mapId=a.uniqueId(),this._locale=a.extend({},Ea,c.locale),this._clickTolerance=c.clickTolerance,this._requestManager=new a.RequestManager(c.transformRequest,c.accessToken),typeof c.container=="string"){if(this._container=a.window.document.getElementById(c.container),!this._container)throw new Error("Container '"+c.container+"' not found.")}else{if(!(c.container instanceof tl))throw new Error("Invalid type: 'container' must be a String or HTMLElement.");this._container=c.container}if(c.maxBounds&&this.setMaxBounds(c.maxBounds),a.bindAll(["_onWindowOnline","_onWindowResize","_onMapScroll","_contextLost","_contextRestored"],this),this._setupContainer(),this._setupPainter(),this.painter===void 0)throw new Error("Failed to initialize WebGL.");this.on("move",function(){return v._update(!1)}),this.on("moveend",function(){return v._update(!1)}),this.on("zoom",function(){return v._update(!0)}),a.window!==void 0&&(a.window.addEventListener("online",this._onWindowOnline,!1),a.window.addEventListener("resize",this._onWindowResize,!1),a.window.addEventListener("orientationchange",this._onWindowResize,!1)),this.handlers=new mt(this,c),this._hash=c.hash&&new Qn(typeof c.hash=="string"&&c.hash||void 0).addTo(this),this._hash&&this._hash._onHashChange()||(this.jumpTo({center:c.center,zoom:c.zoom,bearing:c.bearing,pitch:c.pitch}),c.bounds&&(this.resize(),this.fitBounds(c.bounds,a.extend({},c.fitBoundsOptions,{duration:0})))),this.resize(),this._localIdeographFontFamily=c.localIdeographFontFamily,c.style&&this.setStyle(c.style,{localIdeographFontFamily:c.localIdeographFontFamily}),c.attributionControl&&this.addControl(new bn({customAttribution:c.customAttribution})),this.addControl(new ya,c.logoPosition),this.on("style.load",function(){v.transform.unmodified&&v.jumpTo(v.style.stylesheet)}),this.on("data",function(S){v._update(S.dataType==="style"),v.fire(new a.Event(S.dataType+"data",S))}),this.on("dataloading",function(S){v.fire(new a.Event(S.dataType+"dataloading",S))})}n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s;var o={showTileBoundaries:{configurable:!0},showPadding:{configurable:!0},showCollisionBoxes:{configurable:!0},showOverdrawInspector:{configurable:!0},repaint:{configurable:!0},vertices:{configurable:!0},version:{configurable:!0}};return s.prototype._getMapId=function(){return this._mapId},s.prototype.addControl=function(c,v){if(v===void 0&&(v=c.getDefaultPosition?c.getDefaultPosition():"top-right"),!c||!c.onAdd)return this.fire(new a.ErrorEvent(new Error("Invalid argument to map.addControl(). Argument must be a control with onAdd and onRemove methods.")));var w=c.onAdd(this);this._controls.push(c);var S=this._controlPositions[v];return v.indexOf("bottom")!==-1?S.insertBefore(w,S.firstChild):S.appendChild(w),this},s.prototype.removeControl=function(c){if(!c||!c.onRemove)return this.fire(new a.ErrorEvent(new Error("Invalid argument to map.removeControl(). Argument must be a control with onAdd and onRemove methods.")));var v=this._controls.indexOf(c);return v>-1&&this._controls.splice(v,1),c.onRemove(this),this},s.prototype.hasControl=function(c){return this._controls.indexOf(c)>-1},s.prototype.resize=function(c){var v=this._containerDimensions(),w=v[0],S=v[1];if(w===this.transform.width&&S===this.transform.height)return this;this._resizeCanvas(w,S),this.transform.resize(w,S),this.painter.resize(w,S);var z=!this._moving;return z&&this.fire(new a.Event("movestart",c)).fire(new a.Event("move",c)),this.fire(new a.Event("resize",c)),z&&this.fire(new a.Event("moveend",c)),this},s.prototype.getBounds=function(){return this.transform.getBounds()},s.prototype.getMaxBounds=function(){return this.transform.getMaxBounds()},s.prototype.setMaxBounds=function(c){return this.transform.setMaxBounds(a.LngLatBounds.convert(c)),this._update()},s.prototype.setMinZoom=function(c){if((c=c??-2)>=-2&&c<=this.transform.maxZoom)return this.transform.minZoom=c,this._update(),this.getZoom()<c&&this.setZoom(c),this;throw new Error("minZoom must be between -2 and the current maxZoom, inclusive")},s.prototype.getMinZoom=function(){return this.transform.minZoom},s.prototype.setMaxZoom=function(c){if((c=c??22)>=this.transform.minZoom)return this.transform.maxZoom=c,this._update(),this.getZoom()>c&&this.setZoom(c),this;throw new Error("maxZoom must be greater than the current minZoom")},s.prototype.getMaxZoom=function(){return this.transform.maxZoom},s.prototype.setMinPitch=function(c){if((c=c??0)<0)throw new Error("minPitch must be greater than or equal to 0");if(c>=0&&c<=this.transform.maxPitch)return this.transform.minPitch=c,this._update(),this.getPitch()<c&&this.setPitch(c),this;throw new Error("minPitch must be between 0 and the current maxPitch, inclusive")},s.prototype.getMinPitch=function(){return this.transform.minPitch},s.prototype.setMaxPitch=function(c){if((c=c??60)>60)throw new Error("maxPitch must be less than or equal to 60");if(c>=this.transform.minPitch)return this.transform.maxPitch=c,this._update(),this.getPitch()>c&&this.setPitch(c),this;throw new Error("maxPitch must be greater than the current minPitch")},s.prototype.getMaxPitch=function(){return this.transform.maxPitch},s.prototype.getRenderWorldCopies=function(){return this.transform.renderWorldCopies},s.prototype.setRenderWorldCopies=function(c){return this.transform.renderWorldCopies=c,this._update()},s.prototype.project=function(c){return this.transform.locationPoint(a.LngLat.convert(c))},s.prototype.unproject=function(c){return this.transform.pointLocation(a.Point.convert(c))},s.prototype.isMoving=function(){return this._moving||this.handlers.isMoving()},s.prototype.isZooming=function(){return this._zooming||this.handlers.isZooming()},s.prototype.isRotating=function(){return this._rotating||this.handlers.isRotating()},s.prototype._createDelegatedListener=function(c,v,w){var S,z=this;if(c==="mouseenter"||c==="mouseover"){var C=!1;return{layer:v,listener:w,delegates:{mousemove:function(Z){var G=z.getLayer(v)?z.queryRenderedFeatures(Z.point,{layers:[v]}):[];G.length?C||(C=!0,w.call(z,new Ti(c,z,Z.originalEvent,{features:G}))):C=!1},mouseout:function(){C=!1}}}}if(c==="mouseleave"||c==="mouseout"){var O=!1;return{layer:v,listener:w,delegates:{mousemove:function(Z){(z.getLayer(v)?z.queryRenderedFeatures(Z.point,{layers:[v]}):[]).length?O=!0:O&&(O=!1,w.call(z,new Ti(c,z,Z.originalEvent)))},mouseout:function(Z){O&&(O=!1,w.call(z,new Ti(c,z,Z.originalEvent)))}}}}return{layer:v,listener:w,delegates:(S={},S[c]=function(Z){var G=z.getLayer(v)?z.queryRenderedFeatures(Z.point,{layers:[v]}):[];G.length&&(Z.features=G,w.call(z,Z),delete Z.features)},S)}},s.prototype.on=function(c,v,w){if(w===void 0)return n.prototype.on.call(this,c,v);var S=this._createDelegatedListener(c,v,w);for(var z in this._delegatedListeners=this._delegatedListeners||{},this._delegatedListeners[c]=this._delegatedListeners[c]||[],this._delegatedListeners[c].push(S),S.delegates)this.on(z,S.delegates[z]);return this},s.prototype.once=function(c,v,w){if(w===void 0)return n.prototype.once.call(this,c,v);var S=this._createDelegatedListener(c,v,w);for(var z in S.delegates)this.once(z,S.delegates[z]);return this},s.prototype.off=function(c,v,w){var S=this;return w===void 0?n.prototype.off.call(this,c,v):(this._delegatedListeners&&this._delegatedListeners[c]&&function(z){for(var C=z[c],O=0;O<C.length;O++){var Z=C[O];if(Z.layer===v&&Z.listener===w){for(var G in Z.delegates)S.off(G,Z.delegates[G]);return C.splice(O,1),S}}}(this._delegatedListeners),this)},s.prototype.queryRenderedFeatures=function(c,v){if(!this.style)return[];var w;if(v!==void 0||c===void 0||c instanceof a.Point||Array.isArray(c)||(v=c,c=void 0),v=v||{},(c=c||[[0,0],[this.transform.width,this.transform.height]])instanceof a.Point||typeof c[0]=="number")w=[a.Point.convert(c)];else{var S=a.Point.convert(c[0]),z=a.Point.convert(c[1]);w=[S,new a.Point(z.x,S.y),z,new a.Point(S.x,z.y),S]}return this.style.queryRenderedFeatures(w,v,this.transform)},s.prototype.querySourceFeatures=function(c,v){return this.style.querySourceFeatures(c,v)},s.prototype.setStyle=function(c,v){return(v=a.extend({},{localIdeographFontFamily:this._localIdeographFontFamily},v)).diff!==!1&&v.localIdeographFontFamily===this._localIdeographFontFamily&&this.style&&c?(this._diffStyle(c,v),this):(this._localIdeographFontFamily=v.localIdeographFontFamily,this._updateStyle(c,v))},s.prototype._getUIString=function(c){var v=this._locale[c];if(v==null)throw new Error("Missing UI string '"+c+"'");return v},s.prototype._updateStyle=function(c,v){return this.style&&(this.style.setEventedParent(null),this.style._remove()),c?(this.style=new Fn(this,v||{}),this.style.setEventedParent(this,{style:this.style}),typeof c=="string"?this.style.loadURL(c):this.style.loadJSON(c),this):(delete this.style,this)},s.prototype._lazyInitEmptyStyle=function(){this.style||(this.style=new Fn(this,{}),this.style.setEventedParent(this,{style:this.style}),this.style.loadEmpty())},s.prototype._diffStyle=function(c,v){var w=this;if(typeof c=="string"){var S=this._requestManager.normalizeStyleURL(c),z=this._requestManager.transformRequest(S,a.ResourceType.Style);a.getJSON(z,function(C,O){C?w.fire(new a.ErrorEvent(C)):O&&w._updateDiff(O,v)})}else typeof c=="object"&&this._updateDiff(c,v)},s.prototype._updateDiff=function(c,v){try{this.style.setState(c)&&this._update(!0)}catch(w){a.warnOnce("Unable to perform style diff: "+(w.message||w.error||w)+".  Rebuilding the style from scratch."),this._updateStyle(c,v)}},s.prototype.getStyle=function(){if(this.style)return this.style.serialize()},s.prototype.isStyleLoaded=function(){return this.style?this.style.loaded():a.warnOnce("There is no style added to the map.")},s.prototype.addSource=function(c,v){return this._lazyInitEmptyStyle(),this.style.addSource(c,v),this._update(!0)},s.prototype.isSourceLoaded=function(c){var v=this.style&&this.style.sourceCaches[c];if(v!==void 0)return v.loaded();this.fire(new a.ErrorEvent(new Error("There is no source with ID '"+c+"'")))},s.prototype.areTilesLoaded=function(){var c=this.style&&this.style.sourceCaches;for(var v in c){var w=c[v]._tiles;for(var S in w){var z=w[S];if(z.state!=="loaded"&&z.state!=="errored")return!1}}return!0},s.prototype.addSourceType=function(c,v,w){return this._lazyInitEmptyStyle(),this.style.addSourceType(c,v,w)},s.prototype.removeSource=function(c){return this.style.removeSource(c),this._update(!0)},s.prototype.getSource=function(c){return this.style.getSource(c)},s.prototype.addImage=function(c,v,w){w===void 0&&(w={});var S=w.pixelRatio;S===void 0&&(S=1);var z=w.sdf;z===void 0&&(z=!1);var C=w.stretchX,O=w.stretchY,Z=w.content;if(this._lazyInitEmptyStyle(),v instanceof nu||Er&&v instanceof Er){var G=a.browser.getImageData(v);this.style.addImage(c,{data:new a.RGBAImage({width:G.width,height:G.height},G.data),pixelRatio:S,stretchX:C,stretchY:O,content:Z,sdf:z,version:0})}else{if(v.width===void 0||v.height===void 0)return this.fire(new a.ErrorEvent(new Error("Invalid arguments to map.addImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));var H=v;this.style.addImage(c,{data:new a.RGBAImage({width:v.width,height:v.height},new Uint8Array(v.data)),pixelRatio:S,stretchX:C,stretchY:O,content:Z,sdf:z,version:0,userImage:H}),H.onAdd&&H.onAdd(this,c)}},s.prototype.updateImage=function(c,v){var w=this.style.getImage(c);if(!w)return this.fire(new a.ErrorEvent(new Error("The map has no image with that id. If you are adding a new image use `map.addImage(...)` instead.")));var S=v instanceof nu||Er&&v instanceof Er?a.browser.getImageData(v):v,z=S.width,C=S.height,O=S.data;return z===void 0||C===void 0?this.fire(new a.ErrorEvent(new Error("Invalid arguments to map.updateImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`"))):z!==w.data.width||C!==w.data.height?this.fire(new a.ErrorEvent(new Error("The width and height of the updated image must be that same as the previous version of the image"))):(w.data.replace(O,!(v instanceof nu||Er&&v instanceof Er)),void this.style.updateImage(c,w))},s.prototype.hasImage=function(c){return c?!!this.style.getImage(c):(this.fire(new a.ErrorEvent(new Error("Missing required image id"))),!1)},s.prototype.removeImage=function(c){this.style.removeImage(c)},s.prototype.loadImage=function(c,v){a.getImage(this._requestManager.transformRequest(c,a.ResourceType.Image),v)},s.prototype.listImages=function(){return this.style.listImages()},s.prototype.addLayer=function(c,v){return this._lazyInitEmptyStyle(),this.style.addLayer(c,v),this._update(!0)},s.prototype.moveLayer=function(c,v){return this.style.moveLayer(c,v),this._update(!0)},s.prototype.removeLayer=function(c){return this.style.removeLayer(c),this._update(!0)},s.prototype.getLayer=function(c){return this.style.getLayer(c)},s.prototype.setLayerZoomRange=function(c,v,w){return this.style.setLayerZoomRange(c,v,w),this._update(!0)},s.prototype.setFilter=function(c,v,w){return w===void 0&&(w={}),this.style.setFilter(c,v,w),this._update(!0)},s.prototype.getFilter=function(c){return this.style.getFilter(c)},s.prototype.setPaintProperty=function(c,v,w,S){return S===void 0&&(S={}),this.style.setPaintProperty(c,v,w,S),this._update(!0)},s.prototype.getPaintProperty=function(c,v){return this.style.getPaintProperty(c,v)},s.prototype.setLayoutProperty=function(c,v,w,S){return S===void 0&&(S={}),this.style.setLayoutProperty(c,v,w,S),this._update(!0)},s.prototype.getLayoutProperty=function(c,v){return this.style.getLayoutProperty(c,v)},s.prototype.setLight=function(c,v){return v===void 0&&(v={}),this._lazyInitEmptyStyle(),this.style.setLight(c,v),this._update(!0)},s.prototype.getLight=function(){return this.style.getLight()},s.prototype.setFeatureState=function(c,v){return this.style.setFeatureState(c,v),this._update()},s.prototype.removeFeatureState=function(c,v){return this.style.removeFeatureState(c,v),this._update()},s.prototype.getFeatureState=function(c){return this.style.getFeatureState(c)},s.prototype.getContainer=function(){return this._container},s.prototype.getCanvasContainer=function(){return this._canvasContainer},s.prototype.getCanvas=function(){return this._canvas},s.prototype._containerDimensions=function(){var c=0,v=0;return this._container&&(c=this._container.clientWidth||400,v=this._container.clientHeight||300),[c,v]},s.prototype._detectMissingCSS=function(){a.window.getComputedStyle(this._missingCSSCanary).getPropertyValue("background-color")!=="rgb(250, 128, 114)"&&a.warnOnce("This page appears to be missing CSS declarations for Mapbox GL JS, which may cause the map to display incorrectly. Please ensure your page includes mapbox-gl.css, as described in https://www.mapbox.com/mapbox-gl-js/api/.")},s.prototype._setupContainer=function(){var c=this._container;c.classList.add("mapboxgl-map"),(this._missingCSSCanary=E.create("div","mapboxgl-canary",c)).style.visibility="hidden",this._detectMissingCSS();var v=this._canvasContainer=E.create("div","mapboxgl-canvas-container",c);this._interactive&&v.classList.add("mapboxgl-interactive"),this._canvas=E.create("canvas","mapboxgl-canvas",v),this._canvas.addEventListener("webglcontextlost",this._contextLost,!1),this._canvas.addEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.setAttribute("tabindex","0"),this._canvas.setAttribute("aria-label","Map"),this._canvas.setAttribute("role","region");var w=this._containerDimensions();this._resizeCanvas(w[0],w[1]);var S=this._controlContainer=E.create("div","mapboxgl-control-container",c),z=this._controlPositions={};["top-left","top-right","bottom-left","bottom-right"].forEach(function(C){z[C]=E.create("div","mapboxgl-ctrl-"+C,S)}),this._container.addEventListener("scroll",this._onMapScroll,!1)},s.prototype._resizeCanvas=function(c,v){var w=a.browser.devicePixelRatio||1;this._canvas.width=w*c,this._canvas.height=w*v,this._canvas.style.width=c+"px",this._canvas.style.height=v+"px"},s.prototype._setupPainter=function(){var c=a.extend({},T.webGLContextAttributes,{failIfMajorPerformanceCaveat:this._failIfMajorPerformanceCaveat,preserveDrawingBuffer:this._preserveDrawingBuffer,antialias:this._antialias||!1}),v=this._canvas.getContext("webgl",c)||this._canvas.getContext("experimental-webgl",c);v?(this.painter=new Kr(v,this.transform),a.webpSupported.testSupport(v)):this.fire(new a.ErrorEvent(new Error("Failed to initialize WebGL")))},s.prototype._contextLost=function(c){c.preventDefault(),this._frame&&(this._frame.cancel(),this._frame=null),this.fire(new a.Event("webglcontextlost",{originalEvent:c}))},s.prototype._contextRestored=function(c){this._setupPainter(),this.resize(),this._update(),this.fire(new a.Event("webglcontextrestored",{originalEvent:c}))},s.prototype._onMapScroll=function(c){if(c.target===this._container)return this._container.scrollTop=0,this._container.scrollLeft=0,!1},s.prototype.loaded=function(){return!this._styleDirty&&!this._sourcesDirty&&!!this.style&&this.style.loaded()},s.prototype._update=function(c){return this.style?(this._styleDirty=this._styleDirty||c,this._sourcesDirty=!0,this.triggerRepaint(),this):this},s.prototype._requestRenderFrame=function(c){return this._update(),this._renderTaskQueue.add(c)},s.prototype._cancelRenderFrame=function(c){this._renderTaskQueue.remove(c)},s.prototype._render=function(c){var v,w=this,S=0,z=this.painter.context.extTimerQuery;if(this.listens("gpu-timing-frame")&&(v=z.createQueryEXT(),z.beginQueryEXT(z.TIME_ELAPSED_EXT,v),S=a.browser.now()),this.painter.context.setDirty(),this.painter.setBaseState(),this._renderTaskQueue.run(c),!this._removed){var C=!1;if(this.style&&this._styleDirty){this._styleDirty=!1;var O=this.transform.zoom,Z=a.browser.now();this.style.zoomHistory.update(O,Z);var G=new a.EvaluationParameters(O,{now:Z,fadeDuration:this._fadeDuration,zoomHistory:this.style.zoomHistory,transition:this.style.getTransition()}),H=G.crossFadingFactor();H===1&&H===this._crossFadingFactor||(C=!0,this._crossFadingFactor=H),this.style.update(G)}if(this.style&&this._sourcesDirty&&(this._sourcesDirty=!1,this.style._updateSources(this.transform)),this._placementDirty=this.style&&this.style._updatePlacement(this.painter.transform,this.showCollisionBoxes,this._fadeDuration,this._crossSourceCollisions),this.painter.render(this.style,{showTileBoundaries:this.showTileBoundaries,showOverdrawInspector:this._showOverdrawInspector,rotating:this.isRotating(),zooming:this.isZooming(),moving:this.isMoving(),fadeDuration:this._fadeDuration,showPadding:this.showPadding,gpuTiming:!!this.listens("gpu-timing-layer")}),this.fire(new a.Event("render")),this.loaded()&&!this._loaded&&(this._loaded=!0,this.fire(new a.Event("load"))),this.style&&(this.style.hasTransitions()||C)&&(this._styleDirty=!0),this.style&&!this._placementDirty&&this.style._releaseSymbolFadeTiles(),this.listens("gpu-timing-frame")){var re=a.browser.now()-S;z.endQueryEXT(z.TIME_ELAPSED_EXT,v),setTimeout(function(){var Y=z.getQueryObjectEXT(v,z.QUERY_RESULT_EXT)/1e6;z.deleteQueryEXT(v),w.fire(new a.Event("gpu-timing-frame",{cpuTime:re,gpuTime:Y}))},50)}if(this.listens("gpu-timing-layer")){var ee=this.painter.collectGpuTimers();setTimeout(function(){var Y=w.painter.queryGpuTimers(ee);w.fire(new a.Event("gpu-timing-layer",{layerTimes:Y}))},50)}var le=this._sourcesDirty||this._styleDirty||this._placementDirty;return le||this._repaint?this.triggerRepaint():!this.isMoving()&&this.loaded()&&this.fire(new a.Event("idle")),!this._loaded||this._fullyLoaded||le||(this._fullyLoaded=!0),this}},s.prototype.remove=function(){this._hash&&this._hash.remove();for(var c=0,v=this._controls;c<v.length;c+=1)v[c].onRemove(this);this._controls=[],this._frame&&(this._frame.cancel(),this._frame=null),this._renderTaskQueue.clear(),this.painter.destroy(),this.handlers.destroy(),delete this.handlers,this.setStyle(null),a.window!==void 0&&(a.window.removeEventListener("resize",this._onWindowResize,!1),a.window.removeEventListener("orientationchange",this._onWindowResize,!1),a.window.removeEventListener("online",this._onWindowOnline,!1));var w=this.painter.context.gl.getExtension("WEBGL_lose_context");w&&w.loseContext(),zo(this._canvasContainer),zo(this._controlContainer),zo(this._missingCSSCanary),this._container.classList.remove("mapboxgl-map"),this._removed=!0,this.fire(new a.Event("remove"))},s.prototype.triggerRepaint=function(){var c=this;this.style&&!this._frame&&(this._frame=a.browser.frame(function(v){c._frame=null,c._render(v)}))},s.prototype._onWindowOnline=function(){this._update()},s.prototype._onWindowResize=function(c){this._trackResize&&this.resize({originalEvent:c})._update()},o.showTileBoundaries.get=function(){return!!this._showTileBoundaries},o.showTileBoundaries.set=function(c){this._showTileBoundaries!==c&&(this._showTileBoundaries=c,this._update())},o.showPadding.get=function(){return!!this._showPadding},o.showPadding.set=function(c){this._showPadding!==c&&(this._showPadding=c,this._update())},o.showCollisionBoxes.get=function(){return!!this._showCollisionBoxes},o.showCollisionBoxes.set=function(c){this._showCollisionBoxes!==c&&(this._showCollisionBoxes=c,c?this.style._generateCollisionBoxes():this._update())},o.showOverdrawInspector.get=function(){return!!this._showOverdrawInspector},o.showOverdrawInspector.set=function(c){this._showOverdrawInspector!==c&&(this._showOverdrawInspector=c,this._update())},o.repaint.get=function(){return!!this._repaint},o.repaint.set=function(c){this._repaint!==c&&(this._repaint=c,this.triggerRepaint())},o.vertices.get=function(){return!!this._vertices},o.vertices.set=function(c){this._vertices=c,this._update()},s.prototype._setCacheLimits=function(c,v){a.setCacheLimits(c,v)},o.version.get=function(){return a.version},Object.defineProperties(s.prototype,o),s}(el);function zo(n){n.parentNode&&n.parentNode.removeChild(n)}var au={showCompass:!0,showZoom:!0,visualizePitch:!1},Da=function(n){var s=this;this.options=a.extend({},au,n),this._container=E.create("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._container.addEventListener("contextmenu",function(o){return o.preventDefault()}),this.options.showZoom&&(a.bindAll(["_setButtonTitle","_updateZoomButtons"],this),this._zoomInButton=this._createButton("mapboxgl-ctrl-zoom-in",function(o){return s._map.zoomIn({},{originalEvent:o})}),E.create("span","mapboxgl-ctrl-icon",this._zoomInButton).setAttribute("aria-hidden",!0),this._zoomOutButton=this._createButton("mapboxgl-ctrl-zoom-out",function(o){return s._map.zoomOut({},{originalEvent:o})}),E.create("span","mapboxgl-ctrl-icon",this._zoomOutButton).setAttribute("aria-hidden",!0)),this.options.showCompass&&(a.bindAll(["_rotateCompassArrow"],this),this._compass=this._createButton("mapboxgl-ctrl-compass",function(o){s.options.visualizePitch?s._map.resetNorthPitch({},{originalEvent:o}):s._map.resetNorth({},{originalEvent:o})}),this._compassIcon=E.create("span","mapboxgl-ctrl-icon",this._compass),this._compassIcon.setAttribute("aria-hidden",!0))};Da.prototype._updateZoomButtons=function(){var n=this._map.getZoom(),s=n===this._map.getMaxZoom(),o=n===this._map.getMinZoom();this._zoomInButton.disabled=s,this._zoomOutButton.disabled=o,this._zoomInButton.setAttribute("aria-disabled",s.toString()),this._zoomOutButton.setAttribute("aria-disabled",o.toString())},Da.prototype._rotateCompassArrow=function(){var n=this.options.visualizePitch?"scale("+1/Math.pow(Math.cos(this._map.transform.pitch*(Math.PI/180)),.5)+") rotateX("+this._map.transform.pitch+"deg) rotateZ("+this._map.transform.angle*(180/Math.PI)+"deg)":"rotate("+this._map.transform.angle*(180/Math.PI)+"deg)";this._compassIcon.style.transform=n},Da.prototype.onAdd=function(n){return this._map=n,this.options.showZoom&&(this._setButtonTitle(this._zoomInButton,"ZoomIn"),this._setButtonTitle(this._zoomOutButton,"ZoomOut"),this._map.on("zoom",this._updateZoomButtons),this._updateZoomButtons()),this.options.showCompass&&(this._setButtonTitle(this._compass,"ResetBearing"),this.options.visualizePitch&&this._map.on("pitch",this._rotateCompassArrow),this._map.on("rotate",this._rotateCompassArrow),this._rotateCompassArrow(),this._handler=new jn(this._map,this._compass,this.options.visualizePitch)),this._container},Da.prototype.onRemove=function(){E.remove(this._container),this.options.showZoom&&this._map.off("zoom",this._updateZoomButtons),this.options.showCompass&&(this.options.visualizePitch&&this._map.off("pitch",this._rotateCompassArrow),this._map.off("rotate",this._rotateCompassArrow),this._handler.off(),delete this._handler),delete this._map},Da.prototype._createButton=function(n,s){var o=E.create("button",n,this._container);return o.type="button",o.addEventListener("click",s),o},Da.prototype._setButtonTitle=function(n,s){var o=this._map._getUIString("NavigationControl."+s);n.title=o,n.setAttribute("aria-label",o)};var jn=function(n,s,o){o===void 0&&(o=!1),this._clickTolerance=10,this.element=s,this.mouseRotate=new Js({clickTolerance:n.dragRotate._mouseRotate._clickTolerance}),this.map=n,o&&(this.mousePitch=new tu({clickTolerance:n.dragRotate._mousePitch._clickTolerance})),a.bindAll(["mousedown","mousemove","mouseup","touchstart","touchmove","touchend","reset"],this),E.addEventListener(s,"mousedown",this.mousedown),E.addEventListener(s,"touchstart",this.touchstart,{passive:!1}),E.addEventListener(s,"touchmove",this.touchmove),E.addEventListener(s,"touchend",this.touchend),E.addEventListener(s,"touchcancel",this.reset)};function Go(n,s,o){if(n=new a.LngLat(n.lng,n.lat),s){var c=new a.LngLat(n.lng-360,n.lat),v=new a.LngLat(n.lng+360,n.lat),w=o.locationPoint(n).distSqr(s);o.locationPoint(c).distSqr(s)<w?n=c:o.locationPoint(v).distSqr(s)<w&&(n=v)}for(;Math.abs(n.lng-o.center.lng)>180;){var S=o.locationPoint(n);if(S.x>=0&&S.y>=0&&S.x<=o.width&&S.y<=o.height)break;n.lng>o.center.lng?n.lng-=360:n.lng+=360}return n}jn.prototype.down=function(n,s){this.mouseRotate.mousedown(n,s),this.mousePitch&&this.mousePitch.mousedown(n,s),E.disableDrag()},jn.prototype.move=function(n,s){var o=this.map,c=this.mouseRotate.mousemoveWindow(n,s);if(c&&c.bearingDelta&&o.setBearing(o.getBearing()+c.bearingDelta),this.mousePitch){var v=this.mousePitch.mousemoveWindow(n,s);v&&v.pitchDelta&&o.setPitch(o.getPitch()+v.pitchDelta)}},jn.prototype.off=function(){var n=this.element;E.removeEventListener(n,"mousedown",this.mousedown),E.removeEventListener(n,"touchstart",this.touchstart,{passive:!1}),E.removeEventListener(n,"touchmove",this.touchmove),E.removeEventListener(n,"touchend",this.touchend),E.removeEventListener(n,"touchcancel",this.reset),this.offTemp()},jn.prototype.offTemp=function(){E.enableDrag(),E.removeEventListener(a.window,"mousemove",this.mousemove),E.removeEventListener(a.window,"mouseup",this.mouseup)},jn.prototype.mousedown=function(n){this.down(a.extend({},n,{ctrlKey:!0,preventDefault:function(){return n.preventDefault()}}),E.mousePos(this.element,n)),E.addEventListener(a.window,"mousemove",this.mousemove),E.addEventListener(a.window,"mouseup",this.mouseup)},jn.prototype.mousemove=function(n){this.move(n,E.mousePos(this.element,n))},jn.prototype.mouseup=function(n){this.mouseRotate.mouseupWindow(n),this.mousePitch&&this.mousePitch.mouseupWindow(n),this.offTemp()},jn.prototype.touchstart=function(n){n.targetTouches.length!==1?this.reset():(this._startPos=this._lastPos=E.touchPos(this.element,n.targetTouches)[0],this.down({type:"mousedown",button:0,ctrlKey:!0,preventDefault:function(){return n.preventDefault()}},this._startPos))},jn.prototype.touchmove=function(n){n.targetTouches.length!==1?this.reset():(this._lastPos=E.touchPos(this.element,n.targetTouches)[0],this.move({preventDefault:function(){return n.preventDefault()}},this._lastPos))},jn.prototype.touchend=function(n){n.targetTouches.length===0&&this._startPos&&this._lastPos&&this._startPos.dist(this._lastPos)<this._clickTolerance&&this.element.click(),this.reset()},jn.prototype.reset=function(){this.mouseRotate.reset(),this.mousePitch&&this.mousePitch.reset(),delete this._startPos,delete this._lastPos,this.offTemp()};var za={center:"translate(-50%,-50%)",top:"translate(-50%,0)","top-left":"translate(0,0)","top-right":"translate(-100%,0)",bottom:"translate(-50%,-100%)","bottom-left":"translate(0,-100%)","bottom-right":"translate(-100%,-100%)",left:"translate(0,-50%)",right:"translate(-100%,-50%)"};function rl(n,s,o){var c=n.classList;for(var v in za)c.remove("mapboxgl-"+o+"-anchor-"+v);c.add("mapboxgl-"+o+"-anchor-"+s)}var Ko,Ss=function(n){function s(o,c){if(n.call(this),(o instanceof a.window.HTMLElement||c)&&(o=a.extend({element:o},c)),a.bindAll(["_update","_onMove","_onUp","_addDragHandler","_onMapClick","_onKeyPress"],this),this._anchor=o&&o.anchor||"center",this._color=o&&o.color||"#3FB1CE",this._scale=o&&o.scale||1,this._draggable=o&&o.draggable||!1,this._clickTolerance=o&&o.clickTolerance||0,this._isDragging=!1,this._state="inactive",this._rotation=o&&o.rotation||0,this._rotationAlignment=o&&o.rotationAlignment||"auto",this._pitchAlignment=o&&o.pitchAlignment&&o.pitchAlignment!=="auto"?o.pitchAlignment:this._rotationAlignment,o&&o.element)this._element=o.element,this._offset=a.Point.convert(o&&o.offset||[0,0]);else{this._defaultMarker=!0,this._element=E.create("div"),this._element.setAttribute("aria-label","Map marker");var v=E.createNS("http://www.w3.org/2000/svg","svg");v.setAttributeNS(null,"display","block"),v.setAttributeNS(null,"height","41px"),v.setAttributeNS(null,"width","27px"),v.setAttributeNS(null,"viewBox","0 0 27 41");var w=E.createNS("http://www.w3.org/2000/svg","g");w.setAttributeNS(null,"stroke","none"),w.setAttributeNS(null,"stroke-width","1"),w.setAttributeNS(null,"fill","none"),w.setAttributeNS(null,"fill-rule","evenodd");var S=E.createNS("http://www.w3.org/2000/svg","g");S.setAttributeNS(null,"fill-rule","nonzero");var z=E.createNS("http://www.w3.org/2000/svg","g");z.setAttributeNS(null,"transform","translate(3.0, 29.0)"),z.setAttributeNS(null,"fill","#000000");for(var C=0,O=[{rx:"10.5",ry:"5.25002273"},{rx:"10.5",ry:"5.25002273"},{rx:"9.5",ry:"4.77275007"},{rx:"8.5",ry:"4.29549936"},{rx:"7.5",ry:"3.81822308"},{rx:"6.5",ry:"3.34094679"},{rx:"5.5",ry:"2.86367051"},{rx:"4.5",ry:"2.38636864"}];C<O.length;C+=1){var Z=O[C],G=E.createNS("http://www.w3.org/2000/svg","ellipse");G.setAttributeNS(null,"opacity","0.04"),G.setAttributeNS(null,"cx","10.5"),G.setAttributeNS(null,"cy","5.80029008"),G.setAttributeNS(null,"rx",Z.rx),G.setAttributeNS(null,"ry",Z.ry),z.appendChild(G)}var H=E.createNS("http://www.w3.org/2000/svg","g");H.setAttributeNS(null,"fill",this._color);var re=E.createNS("http://www.w3.org/2000/svg","path");re.setAttributeNS(null,"d","M27,13.5 C27,19.074644 20.250001,27.000002 14.75,34.500002 C14.016665,35.500004 12.983335,35.500004 12.25,34.500002 C6.7499993,27.000002 0,19.222562 0,13.5 C0,6.0441559 6.0441559,0 13.5,0 C20.955844,0 27,6.0441559 27,13.5 Z"),H.appendChild(re);var ee=E.createNS("http://www.w3.org/2000/svg","g");ee.setAttributeNS(null,"opacity","0.25"),ee.setAttributeNS(null,"fill","#000000");var le=E.createNS("http://www.w3.org/2000/svg","path");le.setAttributeNS(null,"d","M13.5,0 C6.0441559,0 0,6.0441559 0,13.5 C0,19.222562 6.7499993,27 12.25,34.5 C13,35.522727 14.016664,35.500004 14.75,34.5 C20.250001,27 27,19.074644 27,13.5 C27,6.0441559 20.955844,0 13.5,0 Z M13.5,1 C20.415404,1 26,6.584596 26,13.5 C26,15.898657 24.495584,19.181431 22.220703,22.738281 C19.945823,26.295132 16.705119,30.142167 13.943359,33.908203 C13.743445,34.180814 13.612715,34.322738 13.5,34.441406 C13.387285,34.322738 13.256555,34.180814 13.056641,33.908203 C10.284481,30.127985 7.4148684,26.314159 5.015625,22.773438 C2.6163816,19.232715 1,15.953538 1,13.5 C1,6.584596 6.584596,1 13.5,1 Z"),ee.appendChild(le);var Y=E.createNS("http://www.w3.org/2000/svg","g");Y.setAttributeNS(null,"transform","translate(6.0, 7.0)"),Y.setAttributeNS(null,"fill","#FFFFFF");var se=E.createNS("http://www.w3.org/2000/svg","g");se.setAttributeNS(null,"transform","translate(8.0, 8.0)");var fe=E.createNS("http://www.w3.org/2000/svg","circle");fe.setAttributeNS(null,"fill","#000000"),fe.setAttributeNS(null,"opacity","0.25"),fe.setAttributeNS(null,"cx","5.5"),fe.setAttributeNS(null,"cy","5.5"),fe.setAttributeNS(null,"r","5.4999962");var _e=E.createNS("http://www.w3.org/2000/svg","circle");_e.setAttributeNS(null,"fill","#FFFFFF"),_e.setAttributeNS(null,"cx","5.5"),_e.setAttributeNS(null,"cy","5.5"),_e.setAttributeNS(null,"r","5.4999962"),se.appendChild(fe),se.appendChild(_e),S.appendChild(z),S.appendChild(H),S.appendChild(ee),S.appendChild(Y),S.appendChild(se),v.appendChild(S),v.setAttributeNS(null,"height",41*this._scale+"px"),v.setAttributeNS(null,"width",27*this._scale+"px"),this._element.appendChild(v),this._offset=a.Point.convert(o&&o.offset||[0,-14])}this._element.classList.add("mapboxgl-marker"),this._element.addEventListener("dragstart",function(Te){Te.preventDefault()}),this._element.addEventListener("mousedown",function(Te){Te.preventDefault()}),rl(this._element,this._anchor,"marker"),this._popup=null}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype.addTo=function(o){return this.remove(),this._map=o,o.getCanvasContainer().appendChild(this._element),o.on("move",this._update),o.on("moveend",this._update),this.setDraggable(this._draggable),this._update(),this._map.on("click",this._onMapClick),this},s.prototype.remove=function(){return this._map&&(this._map.off("click",this._onMapClick),this._map.off("move",this._update),this._map.off("moveend",this._update),this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler),this._map.off("mouseup",this._onUp),this._map.off("touchend",this._onUp),this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),delete this._map),E.remove(this._element),this._popup&&this._popup.remove(),this},s.prototype.getLngLat=function(){return this._lngLat},s.prototype.setLngLat=function(o){return this._lngLat=a.LngLat.convert(o),this._pos=null,this._popup&&this._popup.setLngLat(this._lngLat),this._update(),this},s.prototype.getElement=function(){return this._element},s.prototype.setPopup=function(o){if(this._popup&&(this._popup.remove(),this._popup=null,this._element.removeEventListener("keypress",this._onKeyPress),this._originalTabIndex||this._element.removeAttribute("tabindex")),o){if(!("offset"in o.options)){var c=Math.sqrt(Math.pow(13.5,2)/2);o.options.offset=this._defaultMarker?{top:[0,0],"top-left":[0,0],"top-right":[0,0],bottom:[0,-38.1],"bottom-left":[c,-1*(24.6+c)],"bottom-right":[-c,-1*(24.6+c)],left:[13.5,-24.6],right:[-13.5,-24.6]}:this._offset}this._popup=o,this._lngLat&&this._popup.setLngLat(this._lngLat),this._originalTabIndex=this._element.getAttribute("tabindex"),this._originalTabIndex||this._element.setAttribute("tabindex","0"),this._element.addEventListener("keypress",this._onKeyPress)}return this},s.prototype._onKeyPress=function(o){var c=o.code,v=o.charCode||o.keyCode;c!=="Space"&&c!=="Enter"&&v!==32&&v!==13||this.togglePopup()},s.prototype._onMapClick=function(o){var c=o.originalEvent.target,v=this._element;this._popup&&(c===v||v.contains(c))&&this.togglePopup()},s.prototype.getPopup=function(){return this._popup},s.prototype.togglePopup=function(){var o=this._popup;return o?(o.isOpen()?o.remove():o.addTo(this._map),this):this},s.prototype._update=function(o){if(this._map){this._map.transform.renderWorldCopies&&(this._lngLat=Go(this._lngLat,this._pos,this._map.transform)),this._pos=this._map.project(this._lngLat)._add(this._offset);var c="";this._rotationAlignment==="viewport"||this._rotationAlignment==="auto"?c="rotateZ("+this._rotation+"deg)":this._rotationAlignment==="map"&&(c="rotateZ("+(this._rotation-this._map.getBearing())+"deg)");var v="";this._pitchAlignment==="viewport"||this._pitchAlignment==="auto"?v="rotateX(0deg)":this._pitchAlignment==="map"&&(v="rotateX("+this._map.getPitch()+"deg)"),o&&o.type!=="moveend"||(this._pos=this._pos.round()),E.setTransform(this._element,za[this._anchor]+" translate("+this._pos.x+"px, "+this._pos.y+"px) "+v+" "+c)}},s.prototype.getOffset=function(){return this._offset},s.prototype.setOffset=function(o){return this._offset=a.Point.convert(o),this._update(),this},s.prototype._onMove=function(o){if(!this._isDragging){var c=this._clickTolerance||this._map._clickTolerance;this._isDragging=o.point.dist(this._pointerdownPos)>=c}this._isDragging&&(this._pos=o.point.sub(this._positionDelta),this._lngLat=this._map.unproject(this._pos),this.setLngLat(this._lngLat),this._element.style.pointerEvents="none",this._state==="pending"&&(this._state="active",this.fire(new a.Event("dragstart"))),this.fire(new a.Event("drag")))},s.prototype._onUp=function(){this._element.style.pointerEvents="auto",this._positionDelta=null,this._pointerdownPos=null,this._isDragging=!1,this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),this._state==="active"&&this.fire(new a.Event("dragend")),this._state="inactive"},s.prototype._addDragHandler=function(o){this._element.contains(o.originalEvent.target)&&(o.preventDefault(),this._positionDelta=o.point.sub(this._pos).add(this._offset),this._pointerdownPos=o.point,this._state="pending",this._map.on("mousemove",this._onMove),this._map.on("touchmove",this._onMove),this._map.once("mouseup",this._onUp),this._map.once("touchend",this._onUp))},s.prototype.setDraggable=function(o){return this._draggable=!!o,this._map&&(o?(this._map.on("mousedown",this._addDragHandler),this._map.on("touchstart",this._addDragHandler)):(this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler))),this},s.prototype.isDraggable=function(){return this._draggable},s.prototype.setRotation=function(o){return this._rotation=o||0,this._update(),this},s.prototype.getRotation=function(){return this._rotation},s.prototype.setRotationAlignment=function(o){return this._rotationAlignment=o||"auto",this._update(),this},s.prototype.getRotationAlignment=function(){return this._rotationAlignment},s.prototype.setPitchAlignment=function(o){return this._pitchAlignment=o&&o!=="auto"?o:this._rotationAlignment,this._update(),this},s.prototype.getPitchAlignment=function(){return this._pitchAlignment},s}(a.Evented),ou={positionOptions:{enableHighAccuracy:!1,maximumAge:0,timeout:6e3},fitBoundsOptions:{maxZoom:15},trackUserLocation:!1,showAccuracyCircle:!0,showUserLocation:!0},Ho=0,To=!1,su=function(n){function s(o){n.call(this),this.options=a.extend({},ou,o),a.bindAll(["_onSuccess","_onError","_onZoom","_finish","_setupUI","_updateCamera","_updateMarker"],this)}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype.onAdd=function(o){var c;return this._map=o,this._container=E.create("div","mapboxgl-ctrl mapboxgl-ctrl-group"),c=this._setupUI,Ko!==void 0?c(Ko):a.window.navigator.permissions!==void 0?a.window.navigator.permissions.query({name:"geolocation"}).then(function(v){c(Ko=v.state!=="denied")}):c(Ko=!!a.window.navigator.geolocation),this._container},s.prototype.onRemove=function(){this._geolocationWatchID!==void 0&&(a.window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0),this.options.showUserLocation&&this._userLocationDotMarker&&this._userLocationDotMarker.remove(),this.options.showAccuracyCircle&&this._accuracyCircleMarker&&this._accuracyCircleMarker.remove(),E.remove(this._container),this._map.off("zoom",this._onZoom),this._map=void 0,Ho=0,To=!1},s.prototype._isOutOfMapMaxBounds=function(o){var c=this._map.getMaxBounds(),v=o.coords;return c&&(v.longitude<c.getWest()||v.longitude>c.getEast()||v.latitude<c.getSouth()||v.latitude>c.getNorth())},s.prototype._setErrorState=function(){switch(this._watchState){case"WAITING_ACTIVE":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error");break;case"ACTIVE_LOCK":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting");break;case"BACKGROUND":this._watchState="BACKGROUND_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting")}},s.prototype._onSuccess=function(o){if(this._map){if(this._isOutOfMapMaxBounds(o))return this._setErrorState(),this.fire(new a.Event("outofmaxbounds",o)),this._updateMarker(),void this._finish();if(this.options.trackUserLocation)switch(this._lastKnownPosition=o,this._watchState){case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"BACKGROUND":case"BACKGROUND_ERROR":this._watchState="BACKGROUND",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background")}this.options.showUserLocation&&this._watchState!=="OFF"&&this._updateMarker(o),this.options.trackUserLocation&&this._watchState!=="ACTIVE_LOCK"||this._updateCamera(o),this.options.showUserLocation&&this._dotElement.classList.remove("mapboxgl-user-location-dot-stale"),this.fire(new a.Event("geolocate",o)),this._finish()}},s.prototype._updateCamera=function(o){var c=new a.LngLat(o.coords.longitude,o.coords.latitude),v=o.coords.accuracy,w=this._map.getBearing(),S=a.extend({bearing:w},this.options.fitBoundsOptions);this._map.fitBounds(c.toBounds(v),S,{geolocateSource:!0})},s.prototype._updateMarker=function(o){if(o){var c=new a.LngLat(o.coords.longitude,o.coords.latitude);this._accuracyCircleMarker.setLngLat(c).addTo(this._map),this._userLocationDotMarker.setLngLat(c).addTo(this._map),this._accuracy=o.coords.accuracy,this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}else this._userLocationDotMarker.remove(),this._accuracyCircleMarker.remove()},s.prototype._updateCircleRadius=function(){var o=this._map._container.clientHeight/2,c=this._map.unproject([0,o]),v=this._map.unproject([1,o]),w=c.distanceTo(v),S=Math.ceil(2*this._accuracy/w);this._circleElement.style.width=S+"px",this._circleElement.style.height=S+"px"},s.prototype._onZoom=function(){this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()},s.prototype._onError=function(o){if(this._map){if(this.options.trackUserLocation)if(o.code===1){this._watchState="OFF",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.disabled=!0;var c=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.title=c,this._geolocateButton.setAttribute("aria-label",c),this._geolocationWatchID!==void 0&&this._clearWatch()}else{if(o.code===3&&To)return;this._setErrorState()}this._watchState!=="OFF"&&this.options.showUserLocation&&this._dotElement.classList.add("mapboxgl-user-location-dot-stale"),this.fire(new a.Event("error",o)),this._finish()}},s.prototype._finish=function(){this._timeoutId&&clearTimeout(this._timeoutId),this._timeoutId=void 0},s.prototype._setupUI=function(o){var c=this;if(this._container.addEventListener("contextmenu",function(S){return S.preventDefault()}),this._geolocateButton=E.create("button","mapboxgl-ctrl-geolocate",this._container),E.create("span","mapboxgl-ctrl-icon",this._geolocateButton).setAttribute("aria-hidden",!0),this._geolocateButton.type="button",o===!1){a.warnOnce("Geolocation support is not available so the GeolocateControl will be disabled.");var v=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.disabled=!0,this._geolocateButton.title=v,this._geolocateButton.setAttribute("aria-label",v)}else{var w=this._map._getUIString("GeolocateControl.FindMyLocation");this._geolocateButton.title=w,this._geolocateButton.setAttribute("aria-label",w)}this.options.trackUserLocation&&(this._geolocateButton.setAttribute("aria-pressed","false"),this._watchState="OFF"),this.options.showUserLocation&&(this._dotElement=E.create("div","mapboxgl-user-location-dot"),this._userLocationDotMarker=new Ss(this._dotElement),this._circleElement=E.create("div","mapboxgl-user-location-accuracy-circle"),this._accuracyCircleMarker=new Ss({element:this._circleElement,pitchAlignment:"map"}),this.options.trackUserLocation&&(this._watchState="OFF"),this._map.on("zoom",this._onZoom)),this._geolocateButton.addEventListener("click",this.trigger.bind(this)),this._setup=!0,this.options.trackUserLocation&&this._map.on("movestart",function(S){S.geolocateSource||c._watchState!=="ACTIVE_LOCK"||S.originalEvent&&S.originalEvent.type==="resize"||(c._watchState="BACKGROUND",c._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background"),c._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),c.fire(new a.Event("trackuserlocationend")))})},s.prototype.trigger=function(){if(!this._setup)return a.warnOnce("Geolocate control triggered before added to a map"),!1;if(this.options.trackUserLocation){switch(this._watchState){case"OFF":this._watchState="WAITING_ACTIVE",this.fire(new a.Event("trackuserlocationstart"));break;case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":case"BACKGROUND_ERROR":Ho--,To=!1,this._watchState="OFF",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this.fire(new a.Event("trackuserlocationend"));break;case"BACKGROUND":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._lastKnownPosition&&this._updateCamera(this._lastKnownPosition),this.fire(new a.Event("trackuserlocationstart"))}switch(this._watchState){case"WAITING_ACTIVE":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"ACTIVE_LOCK":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"ACTIVE_ERROR":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error");break;case"BACKGROUND":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background");break;case"BACKGROUND_ERROR":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background-error")}if(this._watchState==="OFF"&&this._geolocationWatchID!==void 0)this._clearWatch();else if(this._geolocationWatchID===void 0){var o;this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","true"),++Ho>1?(o={maximumAge:6e5,timeout:0},To=!0):(o=this.options.positionOptions,To=!1),this._geolocationWatchID=a.window.navigator.geolocation.watchPosition(this._onSuccess,this._onError,o)}}else a.window.navigator.geolocation.getCurrentPosition(this._onSuccess,this._onError,this.options.positionOptions),this._timeoutId=setTimeout(this._finish,1e4);return!0},s.prototype._clearWatch=function(){a.window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0,this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","false"),this.options.showUserLocation&&this._updateMarker(null)},s}(a.Evented),Ya={maxWidth:100,unit:"metric"},Ja=function(n){this.options=a.extend({},Ya,n),a.bindAll(["_onMove","setUnit"],this)};function il(n,s,o){var c=o&&o.maxWidth||100,v=n._container.clientHeight/2,w=n.unproject([0,v]),S=n.unproject([c,v]),z=w.distanceTo(S);if(o&&o.unit==="imperial"){var C=3.2808*z;C>5280?Qa(s,c,C/5280,n._getUIString("ScaleControl.Miles")):Qa(s,c,C,n._getUIString("ScaleControl.Feet"))}else o&&o.unit==="nautical"?Qa(s,c,z/1852,n._getUIString("ScaleControl.NauticalMiles")):z>=1e3?Qa(s,c,z/1e3,n._getUIString("ScaleControl.Kilometers")):Qa(s,c,z,n._getUIString("ScaleControl.Meters"))}function Qa(n,s,o,c){var v,w,S,z=(v=o,(w=Math.pow(10,(""+Math.floor(v)).length-1))*(S=(S=v/w)>=10?10:S>=5?5:S>=3?3:S>=2?2:S>=1?1:function(C){var O=Math.pow(10,Math.ceil(-Math.log(C)/Math.LN10));return Math.round(C*O)/O}(S)));n.style.width=s*(z/o)+"px",n.innerHTML=z+"&nbsp;"+c}Ja.prototype.getDefaultPosition=function(){return"bottom-left"},Ja.prototype._onMove=function(){il(this._map,this._container,this.options)},Ja.prototype.onAdd=function(n){return this._map=n,this._container=E.create("div","mapboxgl-ctrl mapboxgl-ctrl-scale",n.getContainer()),this._map.on("move",this._onMove),this._onMove(),this._container},Ja.prototype.onRemove=function(){E.remove(this._container),this._map.off("move",this._onMove),this._map=void 0},Ja.prototype.setUnit=function(n){this.options.unit=n,il(this._map,this._container,this.options)};var na=function(n){this._fullscreen=!1,n&&n.container&&(n.container instanceof a.window.HTMLElement?this._container=n.container:a.warnOnce("Full screen control 'container' must be a DOM element.")),a.bindAll(["_onClickFullscreen","_changeIcon"],this),"onfullscreenchange"in a.window.document?this._fullscreenchange="fullscreenchange":"onmozfullscreenchange"in a.window.document?this._fullscreenchange="mozfullscreenchange":"onwebkitfullscreenchange"in a.window.document?this._fullscreenchange="webkitfullscreenchange":"onmsfullscreenchange"in a.window.document&&(this._fullscreenchange="MSFullscreenChange")};na.prototype.onAdd=function(n){return this._map=n,this._container||(this._container=this._map.getContainer()),this._controlContainer=E.create("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._checkFullscreenSupport()?this._setupUI():(this._controlContainer.style.display="none",a.warnOnce("This device does not support fullscreen mode.")),this._controlContainer},na.prototype.onRemove=function(){E.remove(this._controlContainer),this._map=null,a.window.document.removeEventListener(this._fullscreenchange,this._changeIcon)},na.prototype._checkFullscreenSupport=function(){return!!(a.window.document.fullscreenEnabled||a.window.document.mozFullScreenEnabled||a.window.document.msFullscreenEnabled||a.window.document.webkitFullscreenEnabled)},na.prototype._setupUI=function(){var n=this._fullscreenButton=E.create("button","mapboxgl-ctrl-fullscreen",this._controlContainer);E.create("span","mapboxgl-ctrl-icon",n).setAttribute("aria-hidden",!0),n.type="button",this._updateTitle(),this._fullscreenButton.addEventListener("click",this._onClickFullscreen),a.window.document.addEventListener(this._fullscreenchange,this._changeIcon)},na.prototype._updateTitle=function(){var n=this._getTitle();this._fullscreenButton.setAttribute("aria-label",n),this._fullscreenButton.title=n},na.prototype._getTitle=function(){return this._map._getUIString(this._isFullscreen()?"FullscreenControl.Exit":"FullscreenControl.Enter")},na.prototype._isFullscreen=function(){return this._fullscreen},na.prototype._changeIcon=function(){(a.window.document.fullscreenElement||a.window.document.mozFullScreenElement||a.window.document.webkitFullscreenElement||a.window.document.msFullscreenElement)===this._container!==this._fullscreen&&(this._fullscreen=!this._fullscreen,this._fullscreenButton.classList.toggle("mapboxgl-ctrl-shrink"),this._fullscreenButton.classList.toggle("mapboxgl-ctrl-fullscreen"),this._updateTitle())},na.prototype._onClickFullscreen=function(){this._isFullscreen()?a.window.document.exitFullscreen?a.window.document.exitFullscreen():a.window.document.mozCancelFullScreen?a.window.document.mozCancelFullScreen():a.window.document.msExitFullscreen?a.window.document.msExitFullscreen():a.window.document.webkitCancelFullScreen&&a.window.document.webkitCancelFullScreen():this._container.requestFullscreen?this._container.requestFullscreen():this._container.mozRequestFullScreen?this._container.mozRequestFullScreen():this._container.msRequestFullscreen?this._container.msRequestFullscreen():this._container.webkitRequestFullscreen&&this._container.webkitRequestFullscreen()};var lu={closeButton:!0,closeOnClick:!0,focusAfterOpen:!0,className:"",maxWidth:"240px"},ks=["a[href]","[tabindex]:not([tabindex='-1'])","[contenteditable]:not([contenteditable='false'])","button:not([disabled])","input:not([disabled])","select:not([disabled])","textarea:not([disabled])"].join(", "),uu=function(n){function s(o){n.call(this),this.options=a.extend(Object.create(lu),o),a.bindAll(["_update","_onClose","remove","_onMouseMove","_onMouseUp","_onDrag"],this)}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype.addTo=function(o){return this._map&&this.remove(),this._map=o,this.options.closeOnClick&&this._map.on("click",this._onClose),this.options.closeOnMove&&this._map.on("move",this._onClose),this._map.on("remove",this.remove),this._update(),this._focusFirstElement(),this._trackPointer?(this._map.on("mousemove",this._onMouseMove),this._map.on("mouseup",this._onMouseUp),this._container&&this._container.classList.add("mapboxgl-popup-track-pointer"),this._map._canvasContainer.classList.add("mapboxgl-track-pointer")):this._map.on("move",this._update),this.fire(new a.Event("open")),this},s.prototype.isOpen=function(){return!!this._map},s.prototype.remove=function(){return this._content&&E.remove(this._content),this._container&&(E.remove(this._container),delete this._container),this._map&&(this._map.off("move",this._update),this._map.off("move",this._onClose),this._map.off("click",this._onClose),this._map.off("remove",this.remove),this._map.off("mousemove",this._onMouseMove),this._map.off("mouseup",this._onMouseUp),this._map.off("drag",this._onDrag),delete this._map),this.fire(new a.Event("close")),this},s.prototype.getLngLat=function(){return this._lngLat},s.prototype.setLngLat=function(o){return this._lngLat=a.LngLat.convert(o),this._pos=null,this._trackPointer=!1,this._update(),this._map&&(this._map.on("move",this._update),this._map.off("mousemove",this._onMouseMove),this._container&&this._container.classList.remove("mapboxgl-popup-track-pointer"),this._map._canvasContainer.classList.remove("mapboxgl-track-pointer")),this},s.prototype.trackPointer=function(){return this._trackPointer=!0,this._pos=null,this._update(),this._map&&(this._map.off("move",this._update),this._map.on("mousemove",this._onMouseMove),this._map.on("drag",this._onDrag),this._container&&this._container.classList.add("mapboxgl-popup-track-pointer"),this._map._canvasContainer.classList.add("mapboxgl-track-pointer")),this},s.prototype.getElement=function(){return this._container},s.prototype.setText=function(o){return this.setDOMContent(a.window.document.createTextNode(o))},s.prototype.setHTML=function(o){var c,v=a.window.document.createDocumentFragment(),w=a.window.document.createElement("body");for(w.innerHTML=o;c=w.firstChild;)v.appendChild(c);return this.setDOMContent(v)},s.prototype.getMaxWidth=function(){return this._container&&this._container.style.maxWidth},s.prototype.setMaxWidth=function(o){return this.options.maxWidth=o,this._update(),this},s.prototype.setDOMContent=function(o){if(this._content)for(;this._content.hasChildNodes();)this._content.firstChild&&this._content.removeChild(this._content.firstChild);else this._content=E.create("div","mapboxgl-popup-content",this._container);return this._content.appendChild(o),this._createCloseButton(),this._update(),this._focusFirstElement(),this},s.prototype.addClassName=function(o){this._container&&this._container.classList.add(o)},s.prototype.removeClassName=function(o){this._container&&this._container.classList.remove(o)},s.prototype.setOffset=function(o){return this.options.offset=o,this._update(),this},s.prototype.toggleClassName=function(o){if(this._container)return this._container.classList.toggle(o)},s.prototype._createCloseButton=function(){this.options.closeButton&&(this._closeButton=E.create("button","mapboxgl-popup-close-button",this._content),this._closeButton.type="button",this._closeButton.setAttribute("aria-label","Close popup"),this._closeButton.innerHTML="&#215;",this._closeButton.addEventListener("click",this._onClose))},s.prototype._onMouseUp=function(o){this._update(o.point)},s.prototype._onMouseMove=function(o){this._update(o.point)},s.prototype._onDrag=function(o){this._update(o.point)},s.prototype._update=function(o){var c=this;if(this._map&&(this._lngLat||this._trackPointer)&&this._content&&(this._container||(this._container=E.create("div","mapboxgl-popup",this._map.getContainer()),this._tip=E.create("div","mapboxgl-popup-tip",this._container),this._container.appendChild(this._content),this.options.className&&this.options.className.split(" ").forEach(function(G){return c._container.classList.add(G)}),this._trackPointer&&this._container.classList.add("mapboxgl-popup-track-pointer")),this.options.maxWidth&&this._container.style.maxWidth!==this.options.maxWidth&&(this._container.style.maxWidth=this.options.maxWidth),this._map.transform.renderWorldCopies&&!this._trackPointer&&(this._lngLat=Go(this._lngLat,this._pos,this._map.transform)),!this._trackPointer||o)){var v=this._pos=this._trackPointer&&o?o:this._map.project(this._lngLat),w=this.options.anchor,S=function G(H){if(H){if(typeof H=="number"){var re=Math.round(Math.sqrt(.5*Math.pow(H,2)));return{center:new a.Point(0,0),top:new a.Point(0,H),"top-left":new a.Point(re,re),"top-right":new a.Point(-re,re),bottom:new a.Point(0,-H),"bottom-left":new a.Point(re,-re),"bottom-right":new a.Point(-re,-re),left:new a.Point(H,0),right:new a.Point(-H,0)}}if(H instanceof a.Point||Array.isArray(H)){var ee=a.Point.convert(H);return{center:ee,top:ee,"top-left":ee,"top-right":ee,bottom:ee,"bottom-left":ee,"bottom-right":ee,left:ee,right:ee}}return{center:a.Point.convert(H.center||[0,0]),top:a.Point.convert(H.top||[0,0]),"top-left":a.Point.convert(H["top-left"]||[0,0]),"top-right":a.Point.convert(H["top-right"]||[0,0]),bottom:a.Point.convert(H.bottom||[0,0]),"bottom-left":a.Point.convert(H["bottom-left"]||[0,0]),"bottom-right":a.Point.convert(H["bottom-right"]||[0,0]),left:a.Point.convert(H.left||[0,0]),right:a.Point.convert(H.right||[0,0])}}return G(new a.Point(0,0))}(this.options.offset);if(!w){var z,C=this._container.offsetWidth,O=this._container.offsetHeight;z=v.y+S.bottom.y<O?["top"]:v.y>this._map.transform.height-O?["bottom"]:[],v.x<C/2?z.push("left"):v.x>this._map.transform.width-C/2&&z.push("right"),w=z.length===0?"bottom":z.join("-")}var Z=v.add(S[w]).round();E.setTransform(this._container,za[w]+" translate("+Z.x+"px,"+Z.y+"px)"),rl(this._container,w,"popup")}},s.prototype._focusFirstElement=function(){if(this.options.focusAfterOpen&&this._container){var o=this._container.querySelector(ks);o&&o.focus()}},s.prototype._onClose=function(){this.remove()},s}(a.Evented),nl={version:a.version,supported:T,setRTLTextPlugin:a.setRTLTextPlugin,getRTLTextPluginStatus:a.getRTLTextPluginStatus,Map:Ic,NavigationControl:Da,GeolocateControl:su,AttributionControl:bn,ScaleControl:Ja,FullscreenControl:na,Popup:uu,Marker:Ss,Style:Fn,LngLat:a.LngLat,LngLatBounds:a.LngLatBounds,Point:a.Point,MercatorCoordinate:a.MercatorCoordinate,Evented:a.Evented,config:a.config,prewarm:function(){ze().acquire(Ee)},clearPrewarmedResources:function(){var n=it;n&&(n.isPreloaded()&&n.numActive()===1?(n.release(Ee),it=null):console.warn("Could not clear WebWorkers since there are active Map instances that still reference it. The pre-warmed WebWorker pool can only be cleared when all map instances have been removed with map.remove()"))},get accessToken(){return a.config.ACCESS_TOKEN},set accessToken(n){a.config.ACCESS_TOKEN=n},get baseApiUrl(){return a.config.API_URL},set baseApiUrl(n){a.config.API_URL=n},get workerCount(){return De.workerCount},set workerCount(n){De.workerCount=n},get maxParallelImageRequests(){return a.config.MAX_PARALLEL_IMAGE_REQUESTS},set maxParallelImageRequests(n){a.config.MAX_PARALLEL_IMAGE_REQUESTS=n},clearStorage:function(n){a.clearTileCache(n)},workerUrl:""};return nl}),y})})(hy);var xh=hy.exports;const K_=g_(xh);function zd(u){let h;const d=u[15].default,p=Fu(d,u,u[14],null);return{c(){p&&p.c()},l(y){p&&p.l(y)},m(y,_){p&&p.m(y,_),h=!0},p(y,_){p&&p.p&&(!h||_&16384)&&Nu(p,d,y,y[14],h?Vu(d,y[14],_,null):Uu(y[14]),null)},i(y){h||(Qe(p,y),h=!0)},o(y){ut(p,y),h=!1},d(y){p&&p.d(y)}}}function H_(u){let h,d,p,y=u[0]&&zd(u);return{c(){h=qe("div"),y&&y.c(),this.h()},l(_){h=je(_,"DIV",{class:!0,id:!0});var a=Ue(h);y&&y.l(a),a.forEach(ae),this.h()},h(){oe(h,"class","absolute top-0 bg-grey4 w-full h-full svelte-a65d1y"),oe(h,"id",u[1]),Ku(()=>u[16].call(h))},m(_,a){Le(_,h,a),y&&y.m(h,null),d=Hu(h,u[16].bind(h)),u[17](h),p=!0},p(_,[a]){_[0]?y?(y.p(_,a),a&1&&Qe(y,1)):(y=zd(_),y.c(),Qe(y,1),y.m(h,null)):y&&(En(),ut(y,1,1,()=>{y=null}),zn()),(!p||a&2)&&oe(h,"id",_[1])},i(_){p||(Qe(y),p=!0)},o(_){ut(y),p=!1},d(_){_&&ae(h),y&&y.d(),d(),u[17](null)}}}function X_(u,h,d){let{$$slots:p={},$$scope:y}=h,{map:_}=h,{id:a="map"}=h,{location:T={bounds:[[-8.1775,54.02275],[-5.43279,55.31298]]}}=h,{style:E="https://raw.githubusercontent.com/nisra-explore/map_tiles/main/basemap_styles/style-omt.json"}=h,{interactive:D=!0}=h,{minzoom:F=0}=h,{maxzoom:L=14}=h,{zoom:R=null}=h,{scrollzoom:X=!0}=h,{geolocate:ne=!0}=h,{zoomcontrol:pe=!0}=h,{options:ve={}}=h,de,xe;ay("map",{getMap:()=>_}),T.bounds?ve={...ve,bounds:T.bounds}:T.lon&&T.lat&&(ve={...ve,center:[T.lon,T.lat]},T.zoom&&(ve.zoom=T.zoom)),oy(()=>{const We=document.createElement("link");return We.rel="stylesheet",We.href="https://unpkg.com/mapbox-gl@1.13.0/dist/mapbox-gl.css",We.onload=()=>{d(0,_=new xh.Map({container:de,style:E,minZoom:F,maxZoom:L,maxBounds:[[-9.2,53.58],[-4.53,55.72]],interactive:D,...ve})),pe&&_.addControl(new xh.NavigationControl({showCompass:!1})),X||_.scrollZoom.disable(),ne&&_.addControl(new xh.GeolocateControl),_.on("load",()=>{d(4,R=_.getZoom())}),_.on("zoom",()=>{d(4,R=_.getZoom())})},document.head.appendChild(We),()=>{_.remove(),We.parentNode.removeChild(We)}});function $e(){let We=document.getElementsByClassName("mapboxgl-canvas");We[0]&&(We[0].style.width="100%",_.resize())}function ht(){xe=this.clientWidth,d(2,xe)}function Pe(We){qu[We?"unshift":"push"](()=>{de=We,d(3,de)})}return u.$$set=We=>{"map"in We&&d(0,_=We.map),"id"in We&&d(1,a=We.id),"location"in We&&d(6,T=We.location),"style"in We&&d(7,E=We.style),"interactive"in We&&d(8,D=We.interactive),"minzoom"in We&&d(9,F=We.minzoom),"maxzoom"in We&&d(10,L=We.maxzoom),"zoom"in We&&d(4,R=We.zoom),"scrollzoom"in We&&d(11,X=We.scrollzoom),"geolocate"in We&&d(12,ne=We.geolocate),"zoomcontrol"in We&&d(13,pe=We.zoomcontrol),"options"in We&&d(5,ve=We.options),"$$scope"in We&&d(14,y=We.$$scope)},u.$$.update=()=>{u.$$.dirty&4&&xe&&$e()},[_,a,xe,de,R,ve,T,E,D,F,L,X,ne,pe,y,p,ht,Pe]}class W_ extends fn{constructor(h){super(),dn(this,h,X_,H_,mn,{map:0,id:1,location:6,style:7,interactive:8,minzoom:9,maxzoom:10,zoom:4,scrollzoom:11,geolocate:12,zoomcontrol:13,options:5})}}function Td(u){let h;const d=u[11].default,p=Fu(d,u,u[10],null);return{c(){p&&p.c()},l(y){p&&p.l(y)},m(y,_){p&&p.m(y,_),h=!0},p(y,_){p&&p.p&&(!h||_&1024)&&Nu(p,d,y,y[10],h?Vu(d,y[10],_,null):Uu(y[10]),null)},i(y){h||(Qe(p,y),h=!0)},o(y){ut(p,y),h=!1},d(y){p&&p.d(y)}}}function Y_(u){let h,d,p=u[0]&&Td(u);return{c(){p&&p.c(),h=or()},l(y){p&&p.l(y),h=or()},m(y,_){p&&p.m(y,_),Le(y,h,_),d=!0},p(y,[_]){y[0]?p?(p.p(y,_),_&1&&Qe(p,1)):(p=Td(y),p.c(),Qe(p,1),p.m(h.parentNode,h)):p&&(En(),ut(p,1,1,()=>{p=null}),zn())},i(y){d||(Qe(p),d=!0)},o(y){ut(p),d=!1},d(y){p&&p.d(y),y&&ae(h)}}}function J_(u,h,d){let{$$slots:p={},$$scope:y}=h,{id:_}=h,{type:a}=h,{url:T=null}=h,{props:E={}}=h,{data:D=null}=h,{layer:F=null}=h,{promoteId:L=null}=h,{minzoom:R=null}=h,{maxzoom:X=null}=h,ne=!1;const{getMap:pe}=Xu("map"),ve=pe();ve.getSource(_)&&ve.removeSource(_);function de(){ve.isSourceLoaded(_)?(d(0,ne=!0),console.log(_+" loaded!")):setTimeout(()=>{console.log("..."),de()},500)}function xe(){ve.isStyleLoaded(_)?($e(),document.querySelector("#map canvas")&&document.querySelector("#map canvas").tabIndex=="0"&&(document.querySelector("#map canvas").tabIndex="-1")):setTimeout(()=>{console.log("..."),xe()},500)}R&&(E.minzoom=R),X&&(E.maxzoom=X),F&&L?(E.promoteId={},E.promoteId[F]=L):L&&(E.promoteId=L);function $e(){console.log(_+" map source loading..."),a=="geojson"?D?(ve.addSource(_,{type:a,data:D,...E}),de()):T&&(ve.addSource(_,{type:a,data:T,...E}),de()):a=="vector"&&(ve.addSource(_,{type:a,tiles:[T],...E}),de())}xe();function ht(){ve.getSource(_).setData(D)}return u.$$set=Pe=>{"id"in Pe&&d(2,_=Pe.id),"type"in Pe&&d(3,a=Pe.type),"url"in Pe&&d(4,T=Pe.url),"props"in Pe&&d(1,E=Pe.props),"data"in Pe&&d(5,D=Pe.data),"layer"in Pe&&d(6,F=Pe.layer),"promoteId"in Pe&&d(7,L=Pe.promoteId),"minzoom"in Pe&&d(8,R=Pe.minzoom),"maxzoom"in Pe&&d(9,X=Pe.maxzoom),"$$scope"in Pe&&d(10,y=Pe.$$scope)},u.$$.update=()=>{u.$$.dirty&33&&ne&&D&&ht()},[ne,E,_,a,T,D,F,L,R,X,y,p]}class Q_ extends fn{constructor(h){super(),dn(this,h,J_,Y_,mn,{id:2,type:3,url:4,props:1,data:5,layer:6,promoteId:7,minzoom:8,maxzoom:9})}}function $_(u,h,d){const{Popup:p}=K_,y=u_(),_=new p({closeButton:!1,closeOnClick:!1});let{id:a}=h,{source:T}=h,{sourceLayer:E=null}=h,{type:D}=h,{filter:F=null}=h,{layout:L={}}=h,{paint:R={}}=h,{data:X=null}=h,{code:ne=null}=h,{name:pe="name"}=h,{colorCode:ve=null}=h,{click:de=!1}=h,{ignoreClick:xe=!1}=h,{clickCenter:$e=!1}=h,{selected:ht=null}=h,{hover:Pe=!1}=h,{hovered:We=null}=h,{highlight:gt=!1}=h,{highlightKey:Ke="highlighted"}=h,{highlighted:dt=[]}=h,{order:Ne=null}=h,{maxzoom:at=null}=h,{minzoom:Vt=null}=h,{isChild:st=!1}=h;const{getMap:At}=Xu("map"),Fe=At();let qt=null,St=null,Ir=[];Fe.getLayer(a)&&Fe.removeLayer(a);let _t={id:a,type:D,source:T,paint:R,layout:L};F&&(_t.filter=F),E&&(_t["source-layer"]=E),at&&(_t.maxzoom=at),Vt&&(_t.minzoom=Vt),Fe.addLayer(_t,Ne);function xt(){console.log("updating colors..."),X.forEach(Re=>{Fe.setFeatureState({source:T,sourceLayer:E,id:Re[ne]},{color:Re[ve]})})}return de&&Fe.on("click",a,Re=>{if(Re.features.length>0&&!xe){let Dt=Re.features[0].id;if(st&&dt.includes(Dt)||!st&&ht!=Dt){if(d(0,ht=Dt),y("select",{code:ht}),qt&&Fe.setFeatureState({source:T,sourceLayer:E,id:qt},{selected:!1}),Fe.setFeatureState({source:T,sourceLayer:E,id:ht},{selected:!0}),$e){let Rr=centroid(Re.features[0].toJSON().geometry);Fe.flyTo({center:Rr.geometry.coordinates})}d(24,qt=ht)}}}),Pe&&(Fe.on("mousemove",a,Re=>{if(Re.features.length>0){let Dt=Re.features[0].id;We&&Fe.setFeatureState({source:T,sourceLayer:E,id:We},{hovered:!1}),st&&dt.includes(Dt)||!st&&ht!=Dt?(d(1,We=d(25,St=Dt)),Fe.setFeatureState({source:T,sourceLayer:E,id:We},{hovered:!0}),Fe.getCanvas().style.cursor="pointer",_.setLngLat(Re.lngLat).setHTML(`<strong>${Re.features[0].properties[pe]?Re.features[0].properties[pe]:Re.features[0].properties[ne]}</strong>`).addTo(Fe)):_.remove()}}),Fe.on("mouseleave",a,Re=>{We&&Fe.setFeatureState({source:T,sourceLayer:E,id:We},{hovered:!1}),d(1,We=d(25,St=null)),Fe.getCanvas().style.cursor="",_.remove()})),u.$$set=Re=>{"id"in Re&&d(2,a=Re.id),"source"in Re&&d(3,T=Re.source),"sourceLayer"in Re&&d(4,E=Re.sourceLayer),"type"in Re&&d(5,D=Re.type),"filter"in Re&&d(6,F=Re.filter),"layout"in Re&&d(7,L=Re.layout),"paint"in Re&&d(8,R=Re.paint),"data"in Re&&d(9,X=Re.data),"code"in Re&&d(10,ne=Re.code),"name"in Re&&d(11,pe=Re.name),"colorCode"in Re&&d(12,ve=Re.colorCode),"click"in Re&&d(13,de=Re.click),"ignoreClick"in Re&&d(14,xe=Re.ignoreClick),"clickCenter"in Re&&d(15,$e=Re.clickCenter),"selected"in Re&&d(0,ht=Re.selected),"hover"in Re&&d(16,Pe=Re.hover),"hovered"in Re&&d(1,We=Re.hovered),"highlight"in Re&&d(17,gt=Re.highlight),"highlightKey"in Re&&d(18,Ke=Re.highlightKey),"highlighted"in Re&&d(19,dt=Re.highlighted),"order"in Re&&d(20,Ne=Re.order),"maxzoom"in Re&&d(21,at=Re.maxzoom),"minzoom"in Re&&d(22,Vt=Re.minzoom),"isChild"in Re&&d(23,st=Re.isChild)},u.$$.update=()=>{u.$$.dirty[0]&4096&&ve&&xt(),u.$$.dirty[0]&68026392&&gt&&dt!=Ir&&(Ir[0]&&Ir.forEach(Re=>{let Dt={};Dt[Ke]=!1,Fe.setFeatureState({source:T,sourceLayer:E,id:Re},Dt)}),d(26,Ir=dt),dt[0]&&dt.forEach(Re=>{let Dt={};Dt[Ke]=!0,Fe.setFeatureState({source:T,sourceLayer:E,id:Re},Dt)})),u.$$.dirty[0]&16777241&&ht!=qt&&(qt&&Fe.setFeatureState({source:T,sourceLayer:E,id:qt},{selected:!1}),ht&&Fe.setFeatureState({source:T,sourceLayer:E,id:ht},{selected:!0}),d(24,qt=ht)),u.$$.dirty[0]&33619994&&Pe&&We!=St&&(St&&Fe.setFeatureState({source:T,sourceLayer:E,id:St},{hovered:!1}),We&&Fe.setFeatureState({source:T,sourceLayer:E,id:We},{hovered:!0}),d(25,St=We))},[ht,We,a,T,E,D,F,L,R,X,ne,pe,ve,de,xe,$e,Pe,gt,Ke,dt,Ne,at,Vt,st,qt,St,Ir]}class Pp extends fn{constructor(h){super(),dn(this,h,$_,null,mn,{id:2,source:3,sourceLayer:4,type:5,filter:6,layout:7,paint:8,data:9,code:10,name:11,colorCode:12,click:13,ignoreClick:14,clickCenter:15,selected:0,hover:16,hovered:1,highlight:17,highlightKey:18,highlighted:19,order:20,maxzoom:21,minzoom:22,isChild:23},null,[-1,-1])}}function ev(u){return u===0?!0:u}function is(u){return ev(u)?Array.isArray(u)?h=>u.map(d=>typeof d!="function"?h[d]:d(h)):typeof u!="function"?h=>h[u]:u:null}function tv(u){const h={};for(const d of u){if(Object(d)!==d)throw new TypeError("iterable for fromEntries should yield objects");const{"0":p,"1":y}=d;Object.defineProperty(h,p,{configurable:!0,enumerable:!0,writable:!0,value:y})}return h}function Cp(u,h={}){return tv(Object.entries(u).filter(([d,p])=>p!==void 0&&h[d]===void 0))}function rv(u,h){if(!Array.isArray(u))throw new TypeError(`The first argument of calcExtents() must be an array. You passed in a ${typeof u}. Consider passing a flat array to the \`flatData\` prop. More info: https://layercake.graphics/guide/#flatdata`);if(Array.isArray(h)||h===void 0||h===null)throw new TypeError("The second argument of calcExtents() must be an object with field names as keys as accessor functions as values.");const d={},p=Object.keys(h),y=p.length;let _,a,T,E,D,F,L,R;const X=u.length;for(_=0;_<y;_+=1){for(E=p[_],L=h[E],D=null,F=null,a=0;a<X;a+=1)if(R=L(u[a]),Array.isArray(R)){const ne=R.length;for(T=0;T<ne;T+=1)R[T]!==void 0&&R[T]!==null&&Number.isNaN(R[T])===!1&&((D===null||R[T]<D)&&(D=R[T]),(F===null||R[T]>F)&&(F=R[T]))}else R!=null&&Number.isNaN(R)===!1&&((D===null||R<D)&&(D=R),(F===null||R>F)&&(F=R));d[E]=[D,F]}return d}function py(u=[],h){return Array.isArray(h)===!0?h.map((d,p)=>d===null?u[p]:d):u}function lh(u){return function([d,p]){return d?py(d[u],p):p}}function wh(u,h){return u==null||h==null?NaN:u<h?-1:u>h?1:u>=h?0:NaN}function iv(u,h){return u==null||h==null?NaN:h<u?-1:h>u?1:h>=u?0:NaN}function fy(u){let h,d,p;u.length!==2?(h=wh,d=(T,E)=>wh(u(T),E),p=(T,E)=>u(T)-E):(h=u===wh||u===iv?u:nv,d=u,p=u);function y(T,E,D=0,F=T.length){if(D<F){if(h(E,E)!==0)return F;do{const L=D+F>>>1;d(T[L],E)<0?D=L+1:F=L}while(D<F)}return D}function _(T,E,D=0,F=T.length){if(D<F){if(h(E,E)!==0)return F;do{const L=D+F>>>1;d(T[L],E)<=0?D=L+1:F=L}while(D<F)}return D}function a(T,E,D=0,F=T.length){const L=y(T,E,D,F-1);return L>D&&p(T[L-1],E)>-p(T[L],E)?L-1:L}return{left:y,center:a,right:_}}function nv(){return 0}function av(u){return u===null?NaN:+u}const ov=fy(wh),sv=ov.right;fy(av).center;const lv=sv;class Id extends Map{constructor(h,d=hv){if(super(),Object.defineProperties(this,{_intern:{value:new Map},_key:{value:d}}),h!=null)for(const[p,y]of h)this.set(p,y)}get(h){return super.get(Ad(this,h))}has(h){return super.has(Ad(this,h))}set(h,d){return super.set(uv(this,h),d)}delete(h){return super.delete(cv(this,h))}}function Ad({_intern:u,_key:h},d){const p=h(d);return u.has(p)?u.get(p):d}function uv({_intern:u,_key:h},d){const p=h(d);return u.has(p)?u.get(p):(u.set(p,d),d)}function cv({_intern:u,_key:h},d){const p=h(d);return u.has(p)&&(d=u.get(p),u.delete(p)),d}function hv(u){return u!==null&&typeof u=="object"?u.valueOf():u}var Rp=Math.sqrt(50),Bp=Math.sqrt(10),Op=Math.sqrt(2);function pv(u,h,d){var p,y=-1,_,a,T;if(h=+h,u=+u,d=+d,u===h&&d>0)return[u];if((p=h<u)&&(_=u,u=h,h=_),(T=dy(u,h,d))===0||!isFinite(T))return[];if(T>0){let E=Math.round(u/T),D=Math.round(h/T);for(E*T<u&&++E,D*T>h&&--D,a=new Array(_=D-E+1);++y<_;)a[y]=(E+y)*T}else{T=-T;let E=Math.round(u*T),D=Math.round(h*T);for(E/T<u&&++E,D/T>h&&--D,a=new Array(_=D-E+1);++y<_;)a[y]=(E+y)/T}return p&&a.reverse(),a}function dy(u,h,d){var p=(h-u)/Math.max(0,d),y=Math.floor(Math.log(p)/Math.LN10),_=p/Math.pow(10,y);return y>=0?(_>=Rp?10:_>=Bp?5:_>=Op?2:1)*Math.pow(10,y):-Math.pow(10,-y)/(_>=Rp?10:_>=Bp?5:_>=Op?2:1)}function fv(u,h,d){var p=Math.abs(h-u)/Math.max(0,d),y=Math.pow(10,Math.floor(Math.log(p)/Math.LN10)),_=p/y;return _>=Rp?y*=10:_>=Bp?y*=5:_>=Op&&(y*=2),h<u?-y:y}function dv(u,h,d){u=+u,h=+h,d=(y=arguments.length)<2?(h=u,u=0,1):y<3?1:+d;for(var p=-1,y=Math.max(0,Math.ceil((h-u)/d))|0,_=new Array(y);++p<y;)_[p]=u+p*d;return _}function Lh(u,h){switch(arguments.length){case 0:break;case 1:this.range(u);break;default:this.range(h).domain(u);break}return this}const Pd=Symbol("implicit");function my(){var u=new Id,h=[],d=[],p=Pd;function y(_){let a=u.get(_);if(a===void 0){if(p!==Pd)return p;u.set(_,a=h.push(_)-1)}return d[a%d.length]}return y.domain=function(_){if(!arguments.length)return h.slice();h=[],u=new Id;for(const a of _)u.has(a)||u.set(a,h.push(a)-1);return y},y.range=function(_){return arguments.length?(d=Array.from(_),y):d.slice()},y.unknown=function(_){return arguments.length?(p=_,y):p},y.copy=function(){return my(h,d).unknown(p)},Lh.apply(y,arguments),y}function yy(){var u=my().unknown(void 0),h=u.domain,d=u.range,p=0,y=1,_,a,T=!1,E=0,D=0,F=.5;delete u.unknown;function L(){var R=h().length,X=y<p,ne=X?y:p,pe=X?p:y;_=(pe-ne)/Math.max(1,R-E+D*2),T&&(_=Math.floor(_)),ne+=(pe-ne-_*(R-E))*F,a=_*(1-E),T&&(ne=Math.round(ne),a=Math.round(a));var ve=dv(R).map(function(de){return ne+_*de});return d(X?ve.reverse():ve)}return u.domain=function(R){return arguments.length?(h(R),L()):h()},u.range=function(R){return arguments.length?([p,y]=R,p=+p,y=+y,L()):[p,y]},u.rangeRound=function(R){return[p,y]=R,p=+p,y=+y,T=!0,L()},u.bandwidth=function(){return a},u.step=function(){return _},u.round=function(R){return arguments.length?(T=!!R,L()):T},u.padding=function(R){return arguments.length?(E=Math.min(1,D=+R),L()):E},u.paddingInner=function(R){return arguments.length?(E=Math.min(1,R),L()):E},u.paddingOuter=function(R){return arguments.length?(D=+R,L()):D},u.align=function(R){return arguments.length?(F=Math.max(0,Math.min(1,R)),L()):F},u.copy=function(){return yy(h(),[p,y]).round(T).paddingInner(E).paddingOuter(D).align(F)},Lh.apply(L(),arguments)}function Kp(u,h,d){u.prototype=h.prototype=d,d.constructor=u}function gy(u,h){var d=Object.create(u.prototype);for(var p in h)d[p]=h[p];return d}function rc(){}var ju=.7,Eh=1/ju,Rl="\\s*([+-]?\\d+)\\s*",Zu="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",uo="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",mv=/^#([0-9a-f]{3,8})$/,yv=new RegExp(`^rgb\\(${Rl},${Rl},${Rl}\\)$`),gv=new RegExp(`^rgb\\(${uo},${uo},${uo}\\)$`),_v=new RegExp(`^rgba\\(${Rl},${Rl},${Rl},${Zu}\\)$`),vv=new RegExp(`^rgba\\(${uo},${uo},${uo},${Zu}\\)$`),bv=new RegExp(`^hsl\\(${Zu},${uo},${uo}\\)$`),xv=new RegExp(`^hsla\\(${Zu},${uo},${uo},${Zu}\\)$`),Cd={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};Kp(rc,Gu,{copy(u){return Object.assign(new this.constructor,this,u)},displayable(){return this.rgb().displayable()},hex:Md,formatHex:Md,formatHex8:wv,formatHsl:Sv,formatRgb:Dd,toString:Dd});function Md(){return this.rgb().formatHex()}function wv(){return this.rgb().formatHex8()}function Sv(){return _y(this).formatHsl()}function Dd(){return this.rgb().formatRgb()}function Gu(u){var h,d;return u=(u+"").trim().toLowerCase(),(h=mv.exec(u))?(d=h[1].length,h=parseInt(h[1],16),d===6?Ld(h):d===3?new ua(h>>8&15|h>>4&240,h>>4&15|h&240,(h&15)<<4|h&15,1):d===8?uh(h>>24&255,h>>16&255,h>>8&255,(h&255)/255):d===4?uh(h>>12&15|h>>8&240,h>>8&15|h>>4&240,h>>4&15|h&240,((h&15)<<4|h&15)/255):null):(h=yv.exec(u))?new ua(h[1],h[2],h[3],1):(h=gv.exec(u))?new ua(h[1]*255/100,h[2]*255/100,h[3]*255/100,1):(h=_v.exec(u))?uh(h[1],h[2],h[3],h[4]):(h=vv.exec(u))?uh(h[1]*255/100,h[2]*255/100,h[3]*255/100,h[4]):(h=bv.exec(u))?Od(h[1],h[2]/100,h[3]/100,1):(h=xv.exec(u))?Od(h[1],h[2]/100,h[3]/100,h[4]):Cd.hasOwnProperty(u)?Ld(Cd[u]):u==="transparent"?new ua(NaN,NaN,NaN,0):null}function Ld(u){return new ua(u>>16&255,u>>8&255,u&255,1)}function uh(u,h,d,p){return p<=0&&(u=h=d=NaN),new ua(u,h,d,p)}function kv(u){return u instanceof rc||(u=Gu(u)),u?(u=u.rgb(),new ua(u.r,u.g,u.b,u.opacity)):new ua}function Fp(u,h,d,p){return arguments.length===1?kv(u):new ua(u,h,d,p??1)}function ua(u,h,d,p){this.r=+u,this.g=+h,this.b=+d,this.opacity=+p}Kp(ua,Fp,gy(rc,{brighter(u){return u=u==null?Eh:Math.pow(Eh,u),new ua(this.r*u,this.g*u,this.b*u,this.opacity)},darker(u){return u=u==null?ju:Math.pow(ju,u),new ua(this.r*u,this.g*u,this.b*u,this.opacity)},rgb(){return this},clamp(){return new ua(Os(this.r),Os(this.g),Os(this.b),zh(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:Rd,formatHex:Rd,formatHex8:Ev,formatRgb:Bd,toString:Bd}));function Rd(){return`#${Bs(this.r)}${Bs(this.g)}${Bs(this.b)}`}function Ev(){return`#${Bs(this.r)}${Bs(this.g)}${Bs(this.b)}${Bs((isNaN(this.opacity)?1:this.opacity)*255)}`}function Bd(){const u=zh(this.opacity);return`${u===1?"rgb(":"rgba("}${Os(this.r)}, ${Os(this.g)}, ${Os(this.b)}${u===1?")":`, ${u})`}`}function zh(u){return isNaN(u)?1:Math.max(0,Math.min(1,u))}function Os(u){return Math.max(0,Math.min(255,Math.round(u)||0))}function Bs(u){return u=Os(u),(u<16?"0":"")+u.toString(16)}function Od(u,h,d,p){return p<=0?u=h=d=NaN:d<=0||d>=1?u=h=NaN:h<=0&&(u=NaN),new Fa(u,h,d,p)}function _y(u){if(u instanceof Fa)return new Fa(u.h,u.s,u.l,u.opacity);if(u instanceof rc||(u=Gu(u)),!u)return new Fa;if(u instanceof Fa)return u;u=u.rgb();var h=u.r/255,d=u.g/255,p=u.b/255,y=Math.min(h,d,p),_=Math.max(h,d,p),a=NaN,T=_-y,E=(_+y)/2;return T?(h===_?a=(d-p)/T+(d<p)*6:d===_?a=(p-h)/T+2:a=(h-d)/T+4,T/=E<.5?_+y:2-_-y,a*=60):T=E>0&&E<1?0:a,new Fa(a,T,E,u.opacity)}function zv(u,h,d,p){return arguments.length===1?_y(u):new Fa(u,h,d,p??1)}function Fa(u,h,d,p){this.h=+u,this.s=+h,this.l=+d,this.opacity=+p}Kp(Fa,zv,gy(rc,{brighter(u){return u=u==null?Eh:Math.pow(Eh,u),new Fa(this.h,this.s,this.l*u,this.opacity)},darker(u){return u=u==null?ju:Math.pow(ju,u),new Fa(this.h,this.s,this.l*u,this.opacity)},rgb(){var u=this.h%360+(this.h<0)*360,h=isNaN(u)||isNaN(this.s)?0:this.s,d=this.l,p=d+(d<.5?d:1-d)*h,y=2*d-p;return new ua(Mp(u>=240?u-240:u+120,y,p),Mp(u,y,p),Mp(u<120?u+240:u-120,y,p),this.opacity)},clamp(){return new Fa(Fd(this.h),ch(this.s),ch(this.l),zh(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){const u=zh(this.opacity);return`${u===1?"hsl(":"hsla("}${Fd(this.h)}, ${ch(this.s)*100}%, ${ch(this.l)*100}%${u===1?")":`, ${u})`}`}}));function Fd(u){return u=(u||0)%360,u<0?u+360:u}function ch(u){return Math.max(0,Math.min(1,u||0))}function Mp(u,h,d){return(u<60?h+(d-h)*u/60:u<180?d:u<240?h+(d-h)*(240-u)/60:h)*255}const Hp=u=>()=>u;function Tv(u,h){return function(d){return u+d*h}}function Iv(u,h,d){return u=Math.pow(u,d),h=Math.pow(h,d)-u,d=1/d,function(p){return Math.pow(u+p*h,d)}}function Av(u){return(u=+u)==1?vy:function(h,d){return d-h?Iv(h,d,u):Hp(isNaN(h)?d:h)}}function vy(u,h){var d=h-u;return d?Tv(u,d):Hp(isNaN(u)?h:u)}const Nd=function u(h){var d=Av(h);function p(y,_){var a=d((y=Fp(y)).r,(_=Fp(_)).r),T=d(y.g,_.g),E=d(y.b,_.b),D=vy(y.opacity,_.opacity);return function(F){return y.r=a(F),y.g=T(F),y.b=E(F),y.opacity=D(F),y+""}}return p.gamma=u,p}(1);function Pv(u,h){h||(h=[]);var d=u?Math.min(h.length,u.length):0,p=h.slice(),y;return function(_){for(y=0;y<d;++y)p[y]=u[y]*(1-_)+h[y]*_;return p}}function Cv(u){return ArrayBuffer.isView(u)&&!(u instanceof DataView)}function Mv(u,h){var d=h?h.length:0,p=u?Math.min(d,u.length):0,y=new Array(p),_=new Array(d),a;for(a=0;a<p;++a)y[a]=Xp(u[a],h[a]);for(;a<d;++a)_[a]=h[a];return function(T){for(a=0;a<p;++a)_[a]=y[a](T);return _}}function Dv(u,h){var d=new Date;return u=+u,h=+h,function(p){return d.setTime(u*(1-p)+h*p),d}}function Th(u,h){return u=+u,h=+h,function(d){return u*(1-d)+h*d}}function Lv(u,h){var d={},p={},y;(u===null||typeof u!="object")&&(u={}),(h===null||typeof h!="object")&&(h={});for(y in h)y in u?d[y]=Xp(u[y],h[y]):p[y]=h[y];return function(_){for(y in d)p[y]=d[y](_);return p}}var Np=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,Dp=new RegExp(Np.source,"g");function Rv(u){return function(){return u}}function Bv(u){return function(h){return u(h)+""}}function Ov(u,h){var d=Np.lastIndex=Dp.lastIndex=0,p,y,_,a=-1,T=[],E=[];for(u=u+"",h=h+"";(p=Np.exec(u))&&(y=Dp.exec(h));)(_=y.index)>d&&(_=h.slice(d,_),T[a]?T[a]+=_:T[++a]=_),(p=p[0])===(y=y[0])?T[a]?T[a]+=y:T[++a]=y:(T[++a]=null,E.push({i:a,x:Th(p,y)})),d=Dp.lastIndex;return d<h.length&&(_=h.slice(d),T[a]?T[a]+=_:T[++a]=_),T.length<2?E[0]?Bv(E[0].x):Rv(h):(h=E.length,function(D){for(var F=0,L;F<h;++F)T[(L=E[F]).i]=L.x(D);return T.join("")})}function Xp(u,h){var d=typeof h,p;return h==null||d==="boolean"?Hp(h):(d==="number"?Th:d==="string"?(p=Gu(h))?(h=p,Nd):Ov:h instanceof Gu?Nd:h instanceof Date?Dv:Cv(h)?Pv:Array.isArray(h)?Mv:typeof h.valueOf!="function"&&typeof h.toString!="function"||isNaN(h)?Lv:Th)(u,h)}function Fv(u,h){return u=+u,h=+h,function(d){return Math.round(u*(1-d)+h*d)}}function Nv(u){return function(){return u}}function Uv(u){return+u}var Ud=[0,1];function lo(u){return u}function Up(u,h){return(h-=u=+u)?function(d){return(d-u)/h}:Nv(isNaN(h)?NaN:.5)}function Vv(u,h){var d;return u>h&&(d=u,u=h,h=d),function(p){return Math.max(u,Math.min(h,p))}}function qv(u,h,d){var p=u[0],y=u[1],_=h[0],a=h[1];return y<p?(p=Up(y,p),_=d(a,_)):(p=Up(p,y),_=d(_,a)),function(T){return _(p(T))}}function jv(u,h,d){var p=Math.min(u.length,h.length)-1,y=new Array(p),_=new Array(p),a=-1;for(u[p]<u[0]&&(u=u.slice().reverse(),h=h.slice().reverse());++a<p;)y[a]=Up(u[a],u[a+1]),_[a]=d(h[a],h[a+1]);return function(T){var E=lv(u,T,1,p)-1;return _[E](y[E](T))}}function by(u,h){return h.domain(u.domain()).range(u.range()).interpolate(u.interpolate()).clamp(u.clamp()).unknown(u.unknown())}function xy(){var u=Ud,h=Ud,d=Xp,p,y,_,a=lo,T,E,D;function F(){var R=Math.min(u.length,h.length);return a!==lo&&(a=Vv(u[0],u[R-1])),T=R>2?jv:qv,E=D=null,L}function L(R){return R==null||isNaN(R=+R)?_:(E||(E=T(u.map(p),h,d)))(p(a(R)))}return L.invert=function(R){return a(y((D||(D=T(h,u.map(p),Th)))(R)))},L.domain=function(R){return arguments.length?(u=Array.from(R,Uv),F()):u.slice()},L.range=function(R){return arguments.length?(h=Array.from(R),F()):h.slice()},L.rangeRound=function(R){return h=Array.from(R),d=Fv,F()},L.clamp=function(R){return arguments.length?(a=R?!0:lo,F()):a!==lo},L.interpolate=function(R){return arguments.length?(d=R,F()):d},L.unknown=function(R){return arguments.length?(_=R,L):_},function(R,X){return p=R,y=X,F()}}function Zv(){return xy()(lo,lo)}function Gv(u){return Math.abs(u=Math.round(u))>=1e21?u.toLocaleString("en").replace(/,/g,""):u.toString(10)}function Ih(u,h){if((d=(u=h?u.toExponential(h-1):u.toExponential()).indexOf("e"))<0)return null;var d,p=u.slice(0,d);return[p.length>1?p[0]+p.slice(2):p,+u.slice(d+1)]}function Bl(u){return u=Ih(Math.abs(u)),u?u[1]:NaN}function Kv(u,h){return function(d,p){for(var y=d.length,_=[],a=0,T=u[0],E=0;y>0&&T>0&&(E+T+1>p&&(T=Math.max(1,p-E)),_.push(d.substring(y-=T,y+T)),!((E+=T+1)>p));)T=u[a=(a+1)%u.length];return _.reverse().join(h)}}function Hv(u){return function(h){return h.replace(/[0-9]/g,function(d){return u[+d]})}}var Xv=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function Ah(u){if(!(h=Xv.exec(u)))throw new Error("invalid format: "+u);var h;return new Wp({fill:h[1],align:h[2],sign:h[3],symbol:h[4],zero:h[5],width:h[6],comma:h[7],precision:h[8]&&h[8].slice(1),trim:h[9],type:h[10]})}Ah.prototype=Wp.prototype;function Wp(u){this.fill=u.fill===void 0?" ":u.fill+"",this.align=u.align===void 0?">":u.align+"",this.sign=u.sign===void 0?"-":u.sign+"",this.symbol=u.symbol===void 0?"":u.symbol+"",this.zero=!!u.zero,this.width=u.width===void 0?void 0:+u.width,this.comma=!!u.comma,this.precision=u.precision===void 0?void 0:+u.precision,this.trim=!!u.trim,this.type=u.type===void 0?"":u.type+""}Wp.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(this.width===void 0?"":Math.max(1,this.width|0))+(this.comma?",":"")+(this.precision===void 0?"":"."+Math.max(0,this.precision|0))+(this.trim?"~":"")+this.type};function Wv(u){e:for(var h=u.length,d=1,p=-1,y;d<h;++d)switch(u[d]){case".":p=y=d;break;case"0":p===0&&(p=d),y=d;break;default:if(!+u[d])break e;p>0&&(p=0);break}return p>0?u.slice(0,p)+u.slice(y+1):u}var wy;function Yv(u,h){var d=Ih(u,h);if(!d)return u+"";var p=d[0],y=d[1],_=y-(wy=Math.max(-8,Math.min(8,Math.floor(y/3)))*3)+1,a=p.length;return _===a?p:_>a?p+new Array(_-a+1).join("0"):_>0?p.slice(0,_)+"."+p.slice(_):"0."+new Array(1-_).join("0")+Ih(u,Math.max(0,h+_-1))[0]}function Vd(u,h){var d=Ih(u,h);if(!d)return u+"";var p=d[0],y=d[1];return y<0?"0."+new Array(-y).join("0")+p:p.length>y+1?p.slice(0,y+1)+"."+p.slice(y+1):p+new Array(y-p.length+2).join("0")}const qd={"%":(u,h)=>(u*100).toFixed(h),b:u=>Math.round(u).toString(2),c:u=>u+"",d:Gv,e:(u,h)=>u.toExponential(h),f:(u,h)=>u.toFixed(h),g:(u,h)=>u.toPrecision(h),o:u=>Math.round(u).toString(8),p:(u,h)=>Vd(u*100,h),r:Vd,s:Yv,X:u=>Math.round(u).toString(16).toUpperCase(),x:u=>Math.round(u).toString(16)};function jd(u){return u}var Zd=Array.prototype.map,Gd=["y","z","a","f","p","n","","m","","k","M","G","T","P","E","Z","Y"];function Jv(u){var h=u.grouping===void 0||u.thousands===void 0?jd:Kv(Zd.call(u.grouping,Number),u.thousands+""),d=u.currency===void 0?"":u.currency[0]+"",p=u.currency===void 0?"":u.currency[1]+"",y=u.decimal===void 0?".":u.decimal+"",_=u.numerals===void 0?jd:Hv(Zd.call(u.numerals,String)),a=u.percent===void 0?"%":u.percent+"",T=u.minus===void 0?"":u.minus+"",E=u.nan===void 0?"NaN":u.nan+"";function D(L){L=Ah(L);var R=L.fill,X=L.align,ne=L.sign,pe=L.symbol,ve=L.zero,de=L.width,xe=L.comma,$e=L.precision,ht=L.trim,Pe=L.type;Pe==="n"?(xe=!0,Pe="g"):qd[Pe]||($e===void 0&&($e=12),ht=!0,Pe="g"),(ve||R==="0"&&X==="=")&&(ve=!0,R="0",X="=");var We=pe==="$"?d:pe==="#"&&/[boxX]/.test(Pe)?"0"+Pe.toLowerCase():"",gt=pe==="$"?p:/[%p]/.test(Pe)?a:"",Ke=qd[Pe],dt=/[defgprs%]/.test(Pe);$e=$e===void 0?6:/[gprs]/.test(Pe)?Math.max(1,Math.min(21,$e)):Math.max(0,Math.min(20,$e));function Ne(at){var Vt=We,st=gt,At,Fe,qt;if(Pe==="c")st=Ke(at)+st,at="";else{at=+at;var St=at<0||1/at<0;if(at=isNaN(at)?E:Ke(Math.abs(at),$e),ht&&(at=Wv(at)),St&&+at==0&&ne!=="+"&&(St=!1),Vt=(St?ne==="("?ne:T:ne==="-"||ne==="("?"":ne)+Vt,st=(Pe==="s"?Gd[8+wy/3]:"")+st+(St&&ne==="("?")":""),dt){for(At=-1,Fe=at.length;++At<Fe;)if(qt=at.charCodeAt(At),48>qt||qt>57){st=(qt===46?y+at.slice(At+1):at.slice(At))+st,at=at.slice(0,At);break}}}xe&&!ve&&(at=h(at,1/0));var Ir=Vt.length+at.length+st.length,_t=Ir<de?new Array(de-Ir+1).join(R):"";switch(xe&&ve&&(at=h(_t+at,_t.length?de-st.length:1/0),_t=""),X){case"<":at=Vt+at+st+_t;break;case"=":at=Vt+_t+at+st;break;case"^":at=_t.slice(0,Ir=_t.length>>1)+Vt+at+st+_t.slice(Ir);break;default:at=_t+Vt+at+st;break}return _(at)}return Ne.toString=function(){return L+""},Ne}function F(L,R){var X=D((L=Ah(L),L.type="f",L)),ne=Math.max(-8,Math.min(8,Math.floor(Bl(R)/3)))*3,pe=Math.pow(10,-ne),ve=Gd[8+ne/3];return function(de){return X(pe*de)+ve}}return{format:D,formatPrefix:F}}var hh,Sy,ky;Qv({thousands:",",grouping:[3],currency:["$",""]});function Qv(u){return hh=Jv(u),Sy=hh.format,ky=hh.formatPrefix,hh}function $v(u){return Math.max(0,-Bl(Math.abs(u)))}function e0(u,h){return Math.max(0,Math.max(-8,Math.min(8,Math.floor(Bl(h)/3)))*3-Bl(Math.abs(u)))}function t0(u,h){return u=Math.abs(u),h=Math.abs(h)-u,Math.max(0,Bl(h)-Bl(u))+1}function r0(u,h,d,p){var y=fv(u,h,d),_;switch(p=Ah(p??",f"),p.type){case"s":{var a=Math.max(Math.abs(u),Math.abs(h));return p.precision==null&&!isNaN(_=e0(y,a))&&(p.precision=_),ky(p,a)}case"":case"e":case"g":case"p":case"r":{p.precision==null&&!isNaN(_=t0(y,Math.max(Math.abs(u),Math.abs(h))))&&(p.precision=_-(p.type==="e"));break}case"f":case"%":{p.precision==null&&!isNaN(_=$v(y))&&(p.precision=_-(p.type==="%")*2);break}}return Sy(p)}function Ey(u){var h=u.domain;return u.ticks=function(d){var p=h();return pv(p[0],p[p.length-1],d??10)},u.tickFormat=function(d,p){var y=h();return r0(y[0],y[y.length-1],d??10,p)},u.nice=function(d){d==null&&(d=10);var p=h(),y=0,_=p.length-1,a=p[y],T=p[_],E,D,F=10;for(T<a&&(D=a,a=T,T=D,D=y,y=_,_=D);F-- >0;){if(D=dy(a,T,d),D===E)return p[y]=a,p[_]=T,h(p);if(D>0)a=Math.floor(a/D)*D,T=Math.ceil(T/D)*D;else if(D<0)a=Math.ceil(a*D)/D,T=Math.floor(T*D)/D;else break;E=D}return u},u}function Sh(){var u=Zv();return u.copy=function(){return by(u,Sh())},Lh.apply(u,arguments),Ey(u)}function Kd(u){return function(h){return h<0?-Math.pow(-h,u):Math.pow(h,u)}}function i0(u){return u<0?-Math.sqrt(-u):Math.sqrt(u)}function n0(u){return u<0?-u*u:u*u}function a0(u){var h=u(lo,lo),d=1;function p(){return d===1?u(lo,lo):d===.5?u(i0,n0):u(Kd(d),Kd(1/d))}return h.exponent=function(y){return arguments.length?(d=+y,p()):d},Ey(h)}function zy(){var u=a0(xy());return u.copy=function(){return by(u,zy()).exponent(u.exponent())},Lh.apply(u,arguments),u}function o0(){return zy.apply(null,arguments).exponent(.5)}const Bu={x:Sh,y:Sh,z:Sh,r:o0};function s0(u){return u.constant?"symlog":u.base?"log":u.exponent?u.exponent()===.5?"sqrt":"pow":"other"}function Hd(u){return u}function l0(u){return h=>Math.log(u*h)}function u0(u){return h=>u*Math.exp(h)}function c0(u){return h=>Math.sign(h)*Math.log1p(Math.abs(h/u))}function h0(u){return h=>Math.sign(h)*Math.expm1(Math.abs(h))*u}function ph(u){return function(d){return d<0?-Math.pow(-d,u):Math.pow(d,u)}}function p0(u){const h=s0(u);if(h==="log"){const d=Math.sign(u.domain()[0]);return{lift:l0(d),ground:u0(d),scaleType:h}}return h==="pow"?{lift:ph(1),ground:ph(1/1),scaleType:h}:h==="sqrt"?{lift:ph(.5),ground:ph(1/.5),scaleType:h}:h==="symlog"?{lift:c0(1),ground:h0(1),scaleType:h}:{lift:Hd,ground:Hd,scaleType:h}}function f0(u,h){if(typeof u.range!="function")throw new Error("Scale method `range` must be a function");if(typeof u.domain!="function")throw new Error("Scale method `domain` must be a function");if(!Array.isArray(h))return u.domain();u.domain().length!==2&&console.warn("[LayerCake] The scale is expected to have a domain of length 2 to use padding. Are you sure you want to use padding? Your scale's domain is:",u.domain()),u.range().length!==2&&console.warn("[LayerCake] The scale is expected to have a range of length 2 to use padding. Are you sure you want to use padding? Your scale's range is:",u.range());const{lift:d,ground:p}=p0(u),y=u.domain()[0],_=Object.prototype.toString.call(y)==="[object Date]",[a,T]=u.domain().map(X=>d(_?X.getTime():X)),[E,D]=u.range(),F=h[0]||0,L=h[1]||0,R=(T-a)/(Math.abs(D-E)-F-L);return[a-F*R,L*R+T].map(X=>p(_?new Date(X):X))}function d0(u,h,d,p,y){let _,a;return y===!0?(_=0,a=100):(_=u==="r"?1:0,a=u==="y"?d:u==="r"?25:h),p===!0?[a,_]:[_,a]}function m0(u,h,d,p,y,_){return y?typeof y=="function"?y({width:h,height:d}):y:d0(u,h,d,p,_)}function fh(u){return function([d,p,y,_,a,T,E,D,F,L]){if(p===null)return null;const R=m0(u,E,D,T,F,L),X=d===Bu[u]?d():d.copy();return X.domain(py(p[u],y)).range(R),_&&X.domain(f0(X,_)),a===!0&&(typeof X.nice=="function"?X.nice():console.error(`[Layer Cake] You set \`${u}Nice: true\` but the ${u}Scale does not have a \`.nice\` method. Ignoring...`)),X}}function dh([u,h]){return d=>{const p=u(d);return Array.isArray(p)?p.map(y=>h(y)):h(p)}}function mh([u]){if(typeof u=="function"){if(typeof u.range=="function")return u.range();console.error("[LayerCake] Your scale doesn't have a `.range` method?")}return null}const yh={x:!1,y:!0,z:!1,r:!1};const y0=u=>({element:u[0]&4,width:u[0]&256,height:u[0]&512,aspectRatio:u[0]&1024,containerWidth:u[0]&128,containerHeight:u[0]&64}),Xd=u=>({element:u[2],width:u[8],height:u[9],aspectRatio:u[10],containerWidth:u[7],containerHeight:u[6]});function Wd(u){let h,d,p;const y=u[90].default,_=Fu(y,u,u[89],Xd);return{c(){h=qe("div"),_&&_.c(),this.h()},l(a){h=je(a,"DIV",{class:!0});var T=Ue(h);_&&_.l(T),T.forEach(ae),this.h()},h(){oe(h,"class","layercake-container svelte-vhzpsp"),Ku(()=>u[92].call(h)),Xe(h,"position",u[5]),Xe(h,"top",u[5]==="absolute"?"0":null),Xe(h,"right",u[5]==="absolute"?"0":null),Xe(h,"bottom",u[5]==="absolute"?"0":null),Xe(h,"left",u[5]==="absolute"?"0":null),Xe(h,"pointer-events",u[4]===!1?"none":null)},m(a,T){Le(a,h,T),_&&_.m(h,null),u[91](h),d=Hu(h,u[92].bind(h)),p=!0},p(a,T){_&&_.p&&(!p||T[0]&1988|T[2]&134217728)&&Nu(_,y,a,a[89],p?Vu(y,a[89],T,y0):Uu(a[89]),Xd),T[0]&32&&Xe(h,"position",a[5]),T[0]&32&&Xe(h,"top",a[5]==="absolute"?"0":null),T[0]&32&&Xe(h,"right",a[5]==="absolute"?"0":null),T[0]&32&&Xe(h,"bottom",a[5]==="absolute"?"0":null),T[0]&32&&Xe(h,"left",a[5]==="absolute"?"0":null),T[0]&16&&Xe(h,"pointer-events",a[4]===!1?"none":null)},i(a){p||(Qe(_,a),p=!0)},o(a){ut(_,a),p=!1},d(a){a&&ae(h),_&&_.d(a),u[91](null),d()}}}function g0(u){let h,d,p=(u[3]===!0||typeof window<"u")&&Wd(u);return{c(){p&&p.c(),h=or()},l(y){p&&p.l(y),h=or()},m(y,_){p&&p.m(y,_),Le(y,h,_),d=!0},p(y,_){y[3]===!0||typeof window<"u"?p?(p.p(y,_),_[0]&8&&Qe(p,1)):(p=Wd(y),p.c(),Qe(p,1),p.m(h.parentNode,h)):p&&(En(),ut(p,1,1,()=>{p=null}),zn())},i(y){d||(Qe(p),d=!0)},o(y){ut(p),d=!1},d(y){p&&p.d(y),y&&ae(h)}}}function _0(u,h,d){let p,y,_,a,T,E,D,F,L,R,X,ne,pe,ve,de,xe,$e,ht,Pe,We,gt,Ke,dt,Ne,at,Vt,st,At,Fe,qt,St,Ir,_t,xt,Re,Dt,Rr,xr,Vr,Br,fr,{$$slots:yi={},$$scope:Jt}=h,{ssr:rn=!1}=h,{pointerEvents:Mi=!0}=h,{position:$r="relative"}=h,{percentRange:Gt=!1}=h,{width:yn=void 0}=h,{height:Yr=void 0}=h,{containerWidth:li=yn||100}=h,{containerHeight:nn=Yr||100}=h,{element:Ui=void 0}=h,{x:an=void 0}=h,{y:yr=void 0}=h,{z:ui=void 0}=h,{r:on=void 0}=h,{data:qr=[]}=h,{xDomain:ci=void 0}=h,{yDomain:hi=void 0}=h,{zDomain:gi=void 0}=h,{rDomain:Di=void 0}=h,{xNice:Wn=!1}=h,{yNice:Vi=!1}=h,{zNice:Ln=!1}=h,{rNice:Li=!1}=h,{xReverse:Ji=yh.x}=h,{yReverse:Rn=yh.y}=h,{zReverse:Tn=yh.z}=h,{rReverse:ei=yh.r}=h,{xPadding:Yn=void 0}=h,{yPadding:In=void 0}=h,{zPadding:wi=void 0}=h,{rPadding:ca=void 0}=h,{xScale:An=Bu.x}=h,{yScale:Mr=Bu.y}=h,{zScale:sn=Bu.z}=h,{rScale:gn=Bu.r}=h,{xRange:ti=void 0}=h,{yRange:te=void 0}=h,{zRange:P=void 0}=h,{rRange:N=void 0}=h,{padding:V={}}=h,{extents:K={}}=h,{flatData:W=void 0}=h,{custom:ue={}}=h,he=!1;oy(()=>{he=!0});const q={},Q=kr(Gt);Zt(u,Q,ge=>d(128,xr=ge));const me=kr(li);Zt(u,me,ge=>d(7,Rr=ge));const Me=kr(nn);Zt(u,Me,ge=>d(6,Dt=ge));const Be=kr(Cp(K));Zt(u,Be,ge=>d(127,Re=ge));const Ee=kr(qr);Zt(u,Ee,ge=>d(126,xt=ge));const De=kr(W||qr);Zt(u,De,ge=>d(125,_t=ge));const it=kr(V);Zt(u,it,ge=>d(124,Ir=ge));const nt=kr(is(an));Zt(u,nt,ge=>d(123,St=ge));const ze=kr(is(yr));Zt(u,ze,ge=>d(122,qt=ge));const et=kr(is(ui));Zt(u,et,ge=>d(121,Fe=ge));const Ge=kr(is(on));Zt(u,Ge,ge=>d(120,At=ge));const Ye=kr(ci);Zt(u,Ye,ge=>d(119,st=ge));const Pt=kr(hi);Zt(u,Pt,ge=>d(118,Vt=ge));const rt=kr(gi);Zt(u,rt,ge=>d(117,at=ge));const Qt=kr(Di);Zt(u,Qt,ge=>d(116,Ne=ge));const _r=kr(Wn);Zt(u,_r,ge=>d(115,dt=ge));const Kt=kr(Vi);Zt(u,Kt,ge=>d(114,Ke=ge));const lr=kr(Ln);Zt(u,lr,ge=>d(113,gt=ge));const $t=kr(Li);Zt(u,$t,ge=>d(112,We=ge));const _i=kr(Ji);Zt(u,_i,ge=>d(111,Pe=ge));const hr=kr(Rn);Zt(u,hr,ge=>d(110,ht=ge));const Or=kr(Tn);Zt(u,Or,ge=>d(109,$e=ge));const gr=kr(ei);Zt(u,gr,ge=>d(108,xe=ge));const Wt=kr(Yn);Zt(u,Wt,ge=>d(107,de=ge));const ur=kr(In);Zt(u,ur,ge=>d(106,ve=ge));const Si=kr(wi);Zt(u,Si,ge=>d(105,pe=ge));const ha=kr(ca);Zt(u,ha,ge=>d(104,ne=ge));const ri=kr(ti);Zt(u,ri,ge=>d(103,X=ge));const Ri=kr(te);Zt(u,Ri,ge=>d(102,R=ge));const Ua=kr(P);Zt(u,Ua,ge=>d(101,L=ge));const _a=kr(N);Zt(u,_a,ge=>d(100,F=ge));const jr=kr(An);Zt(u,jr,ge=>d(99,D=ge));const va=kr(Mr);Zt(u,va,ge=>d(98,E=ge));const ki=kr(sn);Zt(u,ki,ge=>d(97,T=ge));const ii=kr(gn);Zt(u,ii,ge=>d(96,a=ge));const ln=kr(q);Zt(u,ln,ge=>d(94,y=ge));const Pr=kr(ue);Zt(u,Pr,ge=>d(95,_=ge));const Bn=Ci([nt,ze,et,Ge],([ge,un,Zi,Zr])=>{const Sa={};return ge&&(Sa.x=ge),un&&(Sa.y=un),Zi&&(Sa.z=Zi),Zr&&(Sa.r=Zr),Sa}),_n=Ci([it,me,Me],([ge])=>Object.assign({top:0,right:0,bottom:0,left:0},ge)),os=Ci([me,Me,_n],([ge,un,Zi])=>{const Zr={};return Zr.top=Zi.top,Zr.right=ge-Zi.right,Zr.bottom=un-Zi.bottom,Zr.left=Zi.left,Zr.width=Zr.right-Zr.left,Zr.height=Zr.bottom-Zr.top,Zr.width<=0&&he===!0&&console.warn("[LayerCake] Target div has zero or negative width. Did you forget to set an explicit width in CSS on the container?"),Zr.height<=0&&he===!0&&console.warn("[LayerCake] Target div has zero or negative height. Did you forget to set an explicit height in CSS on the container?"),Zr}),Ei=Ci([os],([ge])=>ge.width);Zt(u,Ei,ge=>d(8,Vr=ge));const ba=Ci([os],([ge])=>ge.height);Zt(u,ba,ge=>d(9,Br=ge));const qi=Ci([De,Bn,Be],([ge,un,Zi])=>{const Zr=Cp(un,Zi);return Object.keys(Zr).length>0?{...rv(ge,Zr),...Zi}:{}}),zi=Ci([qi,Ye],lh("x")),Jn=Ci([qi,Pt],lh("y")),ji=Ci([qi,rt],lh("z")),xa=Ci([qi,Qt],lh("r")),ss=Ci([jr,qi,zi,Wt,_r,_i,Ei,ba,ri,Q],fh("x")),Nl=Ci([nt,ss],dh),co=Ci([va,qi,Jn,ur,Kt,hr,Ei,ba,Ri,Q],fh("y")),Ul=Ci([ze,co],dh),Bo=Ci([ki,qi,ji,Si,lr,Or,Ei,ba,Ua,Q],fh("z")),Vl=Ci([et,Bo],dh),Oo=Ci([ii,qi,xa,ha,$t,gr,Ei,ba,_a,Q],fh("r")),Ns=Ci([Ge,Oo],dh),Va=Ci([ss],mh),ls=Ci([co],mh),ho=Ci([Bo],mh),Us=Ci([Oo],mh),qa=Ci([Ei,ba],([ge,un])=>ge/un);Zt(u,qa,ge=>d(10,fr=ge));function On(ge){qu[ge?"unshift":"push"](()=>{Ui=ge,d(2,Ui)})}function wa(){li=this.clientWidth,nn=this.clientHeight,d(0,li),d(1,nn)}return u.$$set=ge=>{"ssr"in ge&&d(3,rn=ge.ssr),"pointerEvents"in ge&&d(4,Mi=ge.pointerEvents),"position"in ge&&d(5,$r=ge.position),"percentRange"in ge&&d(51,Gt=ge.percentRange),"width"in ge&&d(52,yn=ge.width),"height"in ge&&d(53,Yr=ge.height),"containerWidth"in ge&&d(0,li=ge.containerWidth),"containerHeight"in ge&&d(1,nn=ge.containerHeight),"element"in ge&&d(2,Ui=ge.element),"x"in ge&&d(54,an=ge.x),"y"in ge&&d(55,yr=ge.y),"z"in ge&&d(56,ui=ge.z),"r"in ge&&d(57,on=ge.r),"data"in ge&&d(58,qr=ge.data),"xDomain"in ge&&d(59,ci=ge.xDomain),"yDomain"in ge&&d(60,hi=ge.yDomain),"zDomain"in ge&&d(61,gi=ge.zDomain),"rDomain"in ge&&d(62,Di=ge.rDomain),"xNice"in ge&&d(63,Wn=ge.xNice),"yNice"in ge&&d(64,Vi=ge.yNice),"zNice"in ge&&d(65,Ln=ge.zNice),"rNice"in ge&&d(66,Li=ge.rNice),"xReverse"in ge&&d(67,Ji=ge.xReverse),"yReverse"in ge&&d(68,Rn=ge.yReverse),"zReverse"in ge&&d(69,Tn=ge.zReverse),"rReverse"in ge&&d(70,ei=ge.rReverse),"xPadding"in ge&&d(71,Yn=ge.xPadding),"yPadding"in ge&&d(72,In=ge.yPadding),"zPadding"in ge&&d(73,wi=ge.zPadding),"rPadding"in ge&&d(74,ca=ge.rPadding),"xScale"in ge&&d(75,An=ge.xScale),"yScale"in ge&&d(76,Mr=ge.yScale),"zScale"in ge&&d(77,sn=ge.zScale),"rScale"in ge&&d(78,gn=ge.rScale),"xRange"in ge&&d(79,ti=ge.xRange),"yRange"in ge&&d(80,te=ge.yRange),"zRange"in ge&&d(81,P=ge.zRange),"rRange"in ge&&d(82,N=ge.rRange),"padding"in ge&&d(83,V=ge.padding),"extents"in ge&&d(84,K=ge.extents),"flatData"in ge&&d(85,W=ge.flatData),"custom"in ge&&d(86,ue=ge.custom),"$$scope"in ge&&d(89,Jt=ge.$$scope)},u.$$.update=()=>{u.$$.dirty[1]&8388608&&an&&d(87,q.x=an,q),u.$$.dirty[1]&16777216&&yr&&d(87,q.y=yr,q),u.$$.dirty[1]&33554432&&ui&&d(87,q.z=ui,q),u.$$.dirty[1]&67108864&&on&&d(87,q.r=on,q),u.$$.dirty[1]&268435456&&ci&&d(87,q.xDomain=ci,q),u.$$.dirty[1]&536870912&&hi&&d(87,q.yDomain=hi,q),u.$$.dirty[1]&1073741824&&gi&&d(87,q.zDomain=gi,q),u.$$.dirty[2]&1&&Di&&d(87,q.rDomain=Di,q),u.$$.dirty[2]&131072&&ti&&d(87,q.xRange=ti,q),u.$$.dirty[2]&262144&&te&&d(87,q.yRange=te,q),u.$$.dirty[2]&524288&&P&&d(87,q.zRange=P,q),u.$$.dirty[2]&1048576&&N&&d(87,q.rRange=N,q),u.$$.dirty[1]&1048576&&Sr(Q,xr=Gt,xr),u.$$.dirty[0]&1&&Sr(me,Rr=li,Rr),u.$$.dirty[0]&2&&Sr(Me,Dt=nn,Dt),u.$$.dirty[2]&4194304&&Sr(Be,Re=Cp(K),Re),u.$$.dirty[1]&134217728&&Sr(Ee,xt=qr,xt),u.$$.dirty[1]&134217728|u.$$.dirty[2]&8388608&&Sr(De,_t=W||qr,_t),u.$$.dirty[2]&2097152&&Sr(it,Ir=V,Ir),u.$$.dirty[1]&8388608&&Sr(nt,St=is(an),St),u.$$.dirty[1]&16777216&&Sr(ze,qt=is(yr),qt),u.$$.dirty[1]&33554432&&Sr(et,Fe=is(ui),Fe),u.$$.dirty[1]&67108864&&Sr(Ge,At=is(on),At),u.$$.dirty[1]&268435456&&Sr(Ye,st=ci,st),u.$$.dirty[1]&536870912&&Sr(Pt,Vt=hi,Vt),u.$$.dirty[1]&1073741824&&Sr(rt,at=gi,at),u.$$.dirty[2]&1&&Sr(Qt,Ne=Di,Ne),u.$$.dirty[2]&2&&Sr(_r,dt=Wn,dt),u.$$.dirty[2]&4&&Sr(Kt,Ke=Vi,Ke),u.$$.dirty[2]&8&&Sr(lr,gt=Ln,gt),u.$$.dirty[2]&16&&Sr($t,We=Li,We),u.$$.dirty[2]&32&&Sr(_i,Pe=Ji,Pe),u.$$.dirty[2]&64&&Sr(hr,ht=Rn,ht),u.$$.dirty[2]&128&&Sr(Or,$e=Tn,$e),u.$$.dirty[2]&256&&Sr(gr,xe=ei,xe),u.$$.dirty[2]&512&&Sr(Wt,de=Yn,de),u.$$.dirty[2]&1024&&Sr(ur,ve=In,ve),u.$$.dirty[2]&2048&&Sr(Si,pe=wi,pe),u.$$.dirty[2]&4096&&Sr(ha,ne=ca,ne),u.$$.dirty[2]&131072&&Sr(ri,X=ti,X),u.$$.dirty[2]&262144&&Sr(Ri,R=te,R),u.$$.dirty[2]&524288&&Sr(Ua,L=P,L),u.$$.dirty[2]&1048576&&Sr(_a,F=N,F),u.$$.dirty[2]&8192&&Sr(jr,D=An,D),u.$$.dirty[2]&16384&&Sr(va,E=Mr,E),u.$$.dirty[2]&32768&&Sr(ki,T=sn,T),u.$$.dirty[2]&65536&&Sr(ii,a=gn,a),u.$$.dirty[2]&16777216&&Sr(Pr,_=ue,_),u.$$.dirty[2]&33554432&&Sr(ln,y=q,y),u.$$.dirty[2]&67108864&&ay("LayerCake",p)},d(88,p={activeGetters:Bn,width:Ei,height:ba,percentRange:Q,aspectRatio:qa,containerWidth:me,containerHeight:Me,x:nt,y:ze,z:et,r:Ge,custom:Pr,data:Ee,xNice:_r,yNice:Kt,zNice:lr,rNice:$t,xReverse:_i,yReverse:hr,zReverse:Or,rReverse:gr,xPadding:Wt,yPadding:ur,zPadding:Si,rPadding:ha,padding:_n,flatData:De,extents:qi,xDomain:zi,yDomain:Jn,zDomain:ji,rDomain:xa,xRange:Va,yRange:ls,zRange:ho,rRange:Us,config:ln,xScale:ss,xGet:Nl,yScale:co,yGet:Ul,zScale:Bo,zGet:Vl,rScale:Oo,rGet:Ns}),[li,nn,Ui,rn,Mi,$r,Dt,Rr,Vr,Br,fr,Q,me,Me,Be,Ee,De,it,nt,ze,et,Ge,Ye,Pt,rt,Qt,_r,Kt,lr,$t,_i,hr,Or,gr,Wt,ur,Si,ha,ri,Ri,Ua,_a,jr,va,ki,ii,ln,Pr,Ei,ba,qa,Gt,yn,Yr,an,yr,ui,on,qr,ci,hi,gi,Di,Wn,Vi,Ln,Li,Ji,Rn,Tn,ei,Yn,In,wi,ca,An,Mr,sn,gn,ti,te,P,N,V,K,W,ue,q,p,Jt,yi,On,wa]}class v0 extends fn{constructor(h){super(),dn(this,h,_0,g0,mn,{ssr:3,pointerEvents:4,position:5,percentRange:51,width:52,height:53,containerWidth:0,containerHeight:1,element:2,x:54,y:55,z:56,r:57,data:58,xDomain:59,yDomain:60,zDomain:61,rDomain:62,xNice:63,yNice:64,zNice:65,rNice:66,xReverse:67,yReverse:68,zReverse:69,rReverse:70,xPadding:71,yPadding:72,zPadding:73,rPadding:74,xScale:75,yScale:76,zScale:77,rScale:78,xRange:79,yRange:80,zRange:81,rRange:82,padding:83,extents:84,flatData:85,custom:86},null,[-1,-1,-1,-1,-1])}}const b0=u=>({element:u&1}),Yd=u=>({element:u[0]}),x0=u=>({element:u&1}),Jd=u=>({element:u[0]});function w0(u){let h,d,p,y,_;const a=u[12].defs,T=Fu(a,u,u[11],Jd),E=u[12].default,D=Fu(E,u,u[11],Yd);return{c(){h=Hn("svg"),d=Hn("defs"),T&&T.c(),p=Hn("g"),D&&D.c(),this.h()},l(F){h=Xn(F,"svg",{class:!0,viewBox:!0,width:!0,height:!0});var L=Ue(h);d=Xn(L,"defs",{});var R=Ue(d);T&&T.l(R),R.forEach(ae),p=Xn(L,"g",{class:!0,transform:!0});var X=Ue(p);D&&D.l(X),X.forEach(ae),L.forEach(ae),this.h()},h(){oe(p,"class","layercake-layout-svg_g"),oe(p,"transform",y="translate("+u[7].left+", "+u[7].top+")"),oe(h,"class","layercake-layout-svg svelte-u84d8d"),oe(h,"viewBox",u[4]),oe(h,"width",u[5]),oe(h,"height",u[6]),Xe(h,"z-index",u[2]),Xe(h,"pointer-events",u[3]===!1?"none":null)},m(F,L){Le(F,h,L),Ie(h,d),T&&T.m(d,null),Ie(h,p),D&&D.m(p,null),u[13](p),u[14](h),_=!0},p(F,[L]){T&&T.p&&(!_||L&2049)&&Nu(T,a,F,F[11],_?Vu(a,F[11],L,x0):Uu(F[11]),Jd),D&&D.p&&(!_||L&2049)&&Nu(D,E,F,F[11],_?Vu(E,F[11],L,b0):Uu(F[11]),Yd),(!_||L&128&&y!==(y="translate("+F[7].left+", "+F[7].top+")"))&&oe(p,"transform",y),(!_||L&16)&&oe(h,"viewBox",F[4]),(!_||L&32)&&oe(h,"width",F[5]),(!_||L&64)&&oe(h,"height",F[6]),L&4&&Xe(h,"z-index",F[2]),L&8&&Xe(h,"pointer-events",F[3]===!1?"none":null)},i(F){_||(Qe(T,F),Qe(D,F),_=!0)},o(F){ut(T,F),ut(D,F),_=!1},d(F){F&&ae(h),T&&T.d(F),D&&D.d(F),u[13](null),u[14](null)}}}function S0(u,h,d){let p,y,_,{$$slots:a={},$$scope:T}=h,{element:E=void 0}=h,{innerElement:D=void 0}=h,{zIndex:F=void 0}=h,{pointerEvents:L=void 0}=h,{viewBox:R=void 0}=h;const{containerWidth:X,containerHeight:ne,padding:pe}=Xu("LayerCake");Zt(u,X,xe=>d(5,p=xe)),Zt(u,ne,xe=>d(6,y=xe)),Zt(u,pe,xe=>d(7,_=xe));function ve(xe){qu[xe?"unshift":"push"](()=>{D=xe,d(1,D)})}function de(xe){qu[xe?"unshift":"push"](()=>{E=xe,d(0,E)})}return u.$$set=xe=>{"element"in xe&&d(0,E=xe.element),"innerElement"in xe&&d(1,D=xe.innerElement),"zIndex"in xe&&d(2,F=xe.zIndex),"pointerEvents"in xe&&d(3,L=xe.pointerEvents),"viewBox"in xe&&d(4,R=xe.viewBox),"$$scope"in xe&&d(11,T=xe.$$scope)},[E,D,F,L,R,p,y,_,X,ne,pe,T,a,ve,de]}class k0 extends fn{constructor(h){super(),dn(this,h,S0,w0,mn,{element:0,innerElement:1,zIndex:2,pointerEvents:3,viewBox:4})}}function Qd(u,h,d){const p=u.slice();return p[23]=h[d],p[25]=d,p}function $d(u){let h,d,p,y;return{c(){h=Hn("rect"),this.h()},l(_){h=Xn(_,"rect",{class:!0,"data-id":!0,x:!0,y:!0,width:!0,height:!0,fill:!0,stroke:!0,"stroke-width":!0}),Ue(h).forEach(ae),this.h()},h(){oe(h,"class","group-rect"),oe(h,"data-id",u[25]),oe(h,"x",d=u[11].bandwidth?u[7](u[23]):u[7](u[23])[0]),oe(h,"y",p=u[13](u[12](u[23]))-1),oe(h,"width",y=u[11].bandwidth?u[11].bandwidth():u[9](u[23])),oe(h,"height","3"),oe(h,"fill","#308182"),oe(h,"stroke",u[0]),oe(h,"stroke-width",u[1])},m(_,a){Le(_,h,a)},p(_,a){a&3200&&d!==(d=_[11].bandwidth?_[7](_[23]):_[7](_[23])[0])&&oe(h,"x",d),a&13312&&p!==(p=_[13](_[12](_[23]))-1)&&oe(h,"y",p),a&3584&&y!==(y=_[11].bandwidth?_[11].bandwidth():_[9](_[23]))&&oe(h,"width",y),a&1&&oe(h,"stroke",_[0]),a&2&&oe(h,"stroke-width",_[1])},d(_){_&&ae(h)}}}function em(u){let h,d,p,y,_,a,T,E,D=u[12]&&$d(u);return{c(){h=Hn("rect"),D&&D.c(),a=Hn("text"),this.h()},l(F){h=Xn(F,"rect",{class:!0,"data-id":!0,x:!0,y:!0,width:!0,height:!0,fill:!0,stroke:!0,"stroke-width":!0}),Ue(h).forEach(ae),D&&D.l(F),a=Xn(F,"text",{x:!0,y:!0,dx:!0,dy:!0,"text-anchor":!0}),Ue(a).forEach(ae),this.h()},h(){oe(h,"class","group-rect"),oe(h,"data-id",u[25]),oe(h,"x",d=u[11].bandwidth?u[7](u[23]):u[7](u[23])[0]),oe(h,"y",p=u[6](u[23])),oe(h,"width",y=u[11].bandwidth?u[11].bandwidth():u[9](u[23])),oe(h,"height",_=u[8](u[23])),oe(h,"fill",u[4]),oe(h,"stroke",u[0]),oe(h,"stroke-width",u[1]),oe(a,"x",T=u[11].bandwidth?u[7](u[23])+u[11].bandwidth()/2:u[7](u[23])[0]),oe(a,"y",E=u[6](u[23])-4),oe(a,"dx",u[2]),oe(a,"dy",u[3]),oe(a,"text-anchor",u[5])},m(F,L){Le(F,h,L),D&&D.m(F,L),Le(F,a,L)},p(F,L){L&3200&&d!==(d=F[11].bandwidth?F[7](F[23]):F[7](F[23])[0])&&oe(h,"x",d),L&1088&&p!==(p=F[6](F[23]))&&oe(h,"y",p),L&3584&&y!==(y=F[11].bandwidth?F[11].bandwidth():F[9](F[23]))&&oe(h,"width",y),L&1280&&_!==(_=F[8](F[23]))&&oe(h,"height",_),L&16&&oe(h,"fill",F[4]),L&1&&oe(h,"stroke",F[0]),L&2&&oe(h,"stroke-width",F[1]),F[12]?D?D.p(F,L):(D=$d(F),D.c(),D.m(a.parentNode,a)):D&&(D.d(1),D=null),L&3200&&T!==(T=F[11].bandwidth?F[7](F[23])+F[11].bandwidth()/2:F[7](F[23])[0])&&oe(a,"x",T),L&1088&&E!==(E=F[6](F[23])-4)&&oe(a,"y",E),L&4&&oe(a,"dx",F[2]),L&8&&oe(a,"dy",F[3]),L&32&&oe(a,"text-anchor",F[5])},d(F){F&&ae(h),D&&D.d(F),F&&ae(a)}}}function E0(u){let h,d=u[10],p=[];for(let y=0;y<d.length;y+=1)p[y]=em(Qd(u,d,y));return{c(){h=Hn("g");for(let y=0;y<p.length;y+=1)p[y].c();this.h()},l(y){h=Xn(y,"g",{class:!0});var _=Ue(h);for(let a=0;a<p.length;a+=1)p[a].l(_);_.forEach(ae),this.h()},h(){oe(h,"class","column-group svelte-wgzwsk")},m(y,_){Le(y,h,_);for(let a=0;a<p.length;a+=1)p[a]&&p[a].m(h,null)},p(y,[_]){if(_&16383){d=y[10];let a;for(a=0;a<d.length;a+=1){const T=Qd(y,d,a);p[a]?p[a].p(T,_):(p[a]=em(T),p[a].c(),p[a].m(h,null))}for(;a<p.length;a+=1)p[a].d(1);p.length=d.length}},i:si,o:si,d(y){y&&ae(h),tn(p,y)}}}function z0(u,h,d){let p,y,_,a,T,E,D,F,L;const{data:R,xGet:X,yGet:ne,yRange:pe,xScale:ve,yScale:de,y:xe,z:$e}=Xu("LayerCake");Zt(u,R,Ne=>d(10,E=Ne)),Zt(u,X,Ne=>d(7,T=Ne)),Zt(u,ne,Ne=>d(6,_=Ne)),Zt(u,pe,Ne=>d(21,a=Ne)),Zt(u,ve,Ne=>d(11,D=Ne)),Zt(u,de,Ne=>d(13,L=Ne)),Zt(u,$e,Ne=>d(12,F=Ne));let{stroke:ht=""}=h,{strokeWidth:Pe=0}=h,{dxTick:We=0}=h,{dyTick:gt=0}=h,{fill:Ke="#00205b"}=h,{textAnchor:dt="middle"}=h;return u.$$set=Ne=>{"stroke"in Ne&&d(0,ht=Ne.stroke),"strokeWidth"in Ne&&d(1,Pe=Ne.strokeWidth),"dxTick"in Ne&&d(2,We=Ne.dxTick),"dyTick"in Ne&&d(3,gt=Ne.dyTick),"fill"in Ne&&d(4,Ke=Ne.fill),"textAnchor"in Ne&&d(5,dt=Ne.textAnchor)},u.$$.update=()=>{u.$$.dirty&128&&d(9,p=Ne=>{const at=T(Ne);return Math.max(0,at[1]-at[0])}),u.$$.dirty&2097216&&d(8,y=Ne=>a[0]-_(Ne))},[ht,Pe,We,gt,Ke,dt,_,T,y,p,E,D,F,L,R,X,ne,pe,ve,de,$e,a]}class T0 extends fn{constructor(h){super(),dn(this,h,z0,E0,mn,{stroke:0,strokeWidth:1,dxTick:2,dyTick:3,fill:4,textAnchor:5})}}function tm(u,h,d){const p=u.slice();return p[28]=h[d],p[30]=d,p}function rm(u){let h,d,p,y;return{c(){h=Hn("line"),this.h()},l(_){h=Xn(_,"line",{y1:!0,y2:!0,x1:!0,x2:!0,stroke:!0,"stroke-width":!0,class:!0}),Ue(h).forEach(ae),this.h()},h(){oe(h,"y1",d=u[20]*-1),oe(h,"y2",p=u[14]&&u[30]%2==0?u[10]+u[8]+2:u[10]+u[8]-13),oe(h,"x1","0"),oe(h,"x2","0"),oe(h,"stroke",u[11]),oe(h,"stroke-width",y=u[15]&&Array.isArray(u[4])&&u[30]==Math.floor(u[4].length/2)?2:1),oe(h,"class","svelte-fwjh80"),as(h,"baseline",u[13])},m(_,a){Le(_,h,a)},p(_,a){a&1048576&&d!==(d=_[20]*-1)&&oe(h,"y1",d),a&17664&&p!==(p=_[14]&&_[30]%2==0?_[10]+_[8]+2:_[10]+_[8]-13)&&oe(h,"y2",p),a&2048&&oe(h,"stroke",_[11]),a&32784&&y!==(y=_[15]&&Array.isArray(_[4])&&_[30]==Math.floor(_[4].length/2)?2:1)&&oe(h,"stroke-width",y),a&8192&&as(h,"baseline",_[13])},d(_){_&&ae(h)}}}function I0(u){let h=u[1](u[28])+"",d;return{c(){d=Ot(h)},l(p){d=Ft(p,h)},m(p,y){Le(p,d,y)},p(p,y){y&262146&&h!==(h=p[1](p[28])+"")&&Tr(d,h)},d(p){p&&ae(d)}}}function A0(u){let h,d=u[1](u[28])+"",p,y;return{c(){h=Ot(u[5]),p=Ot(d),y=Ot(u[6])},l(_){h=Ft(_,u[5]),p=Ft(_,d),y=Ft(_,u[6])},m(_,a){Le(_,h,a),Le(_,p,a),Le(_,y,a)},p(_,a){a&32&&Tr(h,_[5]),a&262146&&d!==(d=_[1](_[28])+"")&&Tr(p,d),a&64&&Tr(y,_[6])},d(_){_&&ae(h),_&&ae(p),_&&ae(y)}}}function im(u){let h,d,p,y,_,a,T,E=u[0]!==!1&&rm(u);function D(R,X){return R[30]==R[18].length-1?A0:I0}let F=D(u),L=F(u);return{c(){h=Hn("g"),E&&E.c(),d=Hn("text"),L.c(),this.h()},l(R){h=Xn(R,"g",{class:!0,transform:!0});var X=Ue(h);E&&E.l(X),d=Xn(X,"text",{x:!0,y:!0,dx:!0,dy:!0,"text-anchor":!0,fill:!0,class:!0});var ne=Ue(d);L.l(ne),ne.forEach(ae),X.forEach(ae),this.h()},h(){oe(d,"x",p=u[7]||u[16]?u[17].bandwidth()/2:0),oe(d,"y",y=u[3]?u[20]*-1-6:u[14]&&u[30]%2==0?u[8]+15:u[8]),oe(d,"dx",_=u[24](u[30])=="start"?u[9]-2:u[24](u[30])=="end"?u[9]+2:u[9]),oe(d,"dy",u[10]),oe(d,"text-anchor",u[24](u[30])),oe(d,"fill",u[12]),oe(d,"class","svelte-fwjh80"),as(d,"bold",u[15]&&Array.isArray(u[4])&&u[30]==Math.floor(u[4].length/2)),oe(h,"class",a="tick tick-"+u[28]+" svelte-fwjh80"),oe(h,"transform",T="translate("+u[17](u[28])+","+u[19][0]+")")},m(R,X){Le(R,h,X),E&&E.m(h,null),Ie(h,d),L.m(d,null)},p(R,X){R[0]!==!1?E?E.p(R,X):(E=rm(R),E.c(),E.m(h,d)):E&&(E.d(1),E=null),F===(F=D(R))&&L?L.p(R,X):(L.d(1),L=F(R),L&&(L.c(),L.m(d,null))),X&196736&&p!==(p=R[7]||R[16]?R[17].bandwidth()/2:0)&&oe(d,"x",p),X&1065224&&y!==(y=R[3]?R[20]*-1-6:R[14]&&R[30]%2==0?R[8]+15:R[8])&&oe(d,"y",y),X&512&&_!==(_=R[24](R[30])=="start"?R[9]-2:R[24](R[30])=="end"?R[9]+2:R[9])&&oe(d,"dx",_),X&1024&&oe(d,"dy",R[10]),X&4096&&oe(d,"fill",R[12]),X&32784&&as(d,"bold",R[15]&&Array.isArray(R[4])&&R[30]==Math.floor(R[4].length/2)),X&262144&&a!==(a="tick tick-"+R[28]+" svelte-fwjh80")&&oe(h,"class",a),X&917504&&T!==(T="translate("+R[17](R[28])+","+R[19][0]+")")&&oe(h,"transform",T)},d(R){R&&ae(h),E&&E.d(),L.d()}}}function nm(u){let h,d,p;return{c(){h=Hn("line"),this.h()},l(y){h=Xn(y,"line",{class:!0,y1:!0,y2:!0,x1:!0,x2:!0,stroke:!0}),Ue(h).forEach(ae),this.h()},h(){oe(h,"class","baseline svelte-fwjh80"),oe(h,"y1",u[20]),oe(h,"y2","0"),oe(h,"x1",d=u[17](0)),oe(h,"x2",p=u[17](0)),oe(h,"stroke",u[11])},m(y,_){Le(y,h,_)},p(y,_){_&1048576&&oe(h,"y1",y[20]),_&131072&&d!==(d=y[17](0))&&oe(h,"x1",d),_&131072&&p!==(p=y[17](0))&&oe(h,"x2",p),_&2048&&oe(h,"stroke",y[11])},d(y){y&&ae(h)}}}function P0(u){let h,d,p=u[18],y=[];for(let a=0;a<p.length;a+=1)y[a]=im(tm(u,p,a));let _=u[2]===!0&&nm(u);return{c(){h=Hn("g");for(let a=0;a<y.length;a+=1)y[a].c();d=or(),_&&_.c(),this.h()},l(a){h=Xn(a,"g",{class:!0});var T=Ue(h);for(let E=0;E<y.length;E+=1)y[E].l(T);d=or(),_&&_.l(T),T.forEach(ae),this.h()},h(){oe(h,"class","axis x-axis")},m(a,T){Le(a,h,T);for(let E=0;E<y.length;E+=1)y[E]&&y[E].m(h,null);Ie(h,d),_&&_.m(h,null)},p(a,[T]){if(T&18874363){p=a[18];let E;for(E=0;E<p.length;E+=1){const D=tm(a,p,E);y[E]?y[E].p(D,T):(y[E]=im(D),y[E].c(),y[E].m(h,d))}for(;E<y.length;E+=1)y[E].d(1);y.length=p.length}a[2]===!0?_?_.p(a,T):(_=nm(a),_.c(),_.m(h,null)):_&&(_.d(1),_=null)},i:si,o:si,d(a){a&&ae(h),tn(y,a),_&&_.d()}}}function C0(u,h,d){let p,y,_,a,T;const{width:E,height:D,xScale:F,yScale:L,yRange:R}=Xu("LayerCake");Zt(u,D,Fe=>d(20,T=Fe)),Zt(u,F,Fe=>d(17,_=Fe)),Zt(u,R,Fe=>d(19,a=Fe));let{gridlines:X=!0}=h,{formatTick:ne=Fe=>Fe}=h,{baseline:pe=!1}=h,{flipped:ve=!1}=h,{snapTicks:de=!1}=h,{ticks:xe=void 0}=h,{prefix:$e=""}=h,{suffix:ht=""}=h,{xTick:Pe=void 0}=h,{yTick:We=15}=h,{dxTick:gt=0}=h,{dyTick:Ke=0}=h,{lineColor:dt="#999"}=h,{textColor:Ne="#555"}=h,{solid:at=!1}=h,{stagger:Vt=!1}=h,{median:st=!0}=h;function At(Fe){if(de===!0){if(Fe===0)return"start";if(Fe===y.length-1)return"end"}return"middle"}return u.$$set=Fe=>{"gridlines"in Fe&&d(0,X=Fe.gridlines),"formatTick"in Fe&&d(1,ne=Fe.formatTick),"baseline"in Fe&&d(2,pe=Fe.baseline),"flipped"in Fe&&d(3,ve=Fe.flipped),"snapTicks"in Fe&&d(25,de=Fe.snapTicks),"ticks"in Fe&&d(4,xe=Fe.ticks),"prefix"in Fe&&d(5,$e=Fe.prefix),"suffix"in Fe&&d(6,ht=Fe.suffix),"xTick"in Fe&&d(7,Pe=Fe.xTick),"yTick"in Fe&&d(8,We=Fe.yTick),"dxTick"in Fe&&d(9,gt=Fe.dxTick),"dyTick"in Fe&&d(10,Ke=Fe.dyTick),"lineColor"in Fe&&d(11,dt=Fe.lineColor),"textColor"in Fe&&d(12,Ne=Fe.textColor),"solid"in Fe&&d(13,at=Fe.solid),"stagger"in Fe&&d(14,Vt=Fe.stagger),"median"in Fe&&d(15,st=Fe.median)},u.$$.update=()=>{u.$$.dirty&131072&&d(16,p=typeof _.bandwidth=="function"),u.$$.dirty&196624&&d(18,y=Array.isArray(xe)?xe:p?_.domain():_.ticks(xe))},[X,ne,pe,ve,xe,$e,ht,Pe,We,gt,Ke,dt,Ne,at,Vt,st,p,_,y,a,T,D,F,R,At,de]}class M0 extends fn{constructor(h){super(),dn(this,h,C0,P0,mn,{gridlines:0,formatTick:1,baseline:2,flipped:3,snapTicks:25,ticks:4,prefix:5,suffix:6,xTick:7,yTick:8,dxTick:9,dyTick:10,lineColor:11,textColor:12,solid:13,stagger:14,median:15})}}function D0(u){let h,d,p,y;return h=new T0({props:{fill:u[1],formatVal:u[5]}}),p=new M0({props:{gridlines:!1}}),{c(){er(h.$$.fragment),d=vt(),er(p.$$.fragment)},l(_){tr(h.$$.fragment,_),d=bt(_),tr(p.$$.fragment,_)},m(_,a){rr(h,_,a),Le(_,d,a),rr(p,_,a),y=!0},p(_,a){const T={};a&2&&(T.fill=_[1]),a&32&&(T.formatVal=_[5]),h.$set(T)},i(_){y||(Qe(h.$$.fragment,_),Qe(p.$$.fragment,_),y=!0)},o(_){ut(h.$$.fragment,_),ut(p.$$.fragment,_),y=!1},d(_){ir(h,_),_&&ae(d),ir(p,_)}}}function L0(u){let h,d;return h=new k0({props:{$$slots:{default:[D0]},$$scope:{ctx:u}}}),{c(){er(h.$$.fragment)},l(p){tr(h.$$.fragment,p)},m(p,y){rr(h,p,y),d=!0},p(p,y){const _={};y&1058&&(_.$$scope={dirty:y,ctx:p}),h.$set(_)},i(p){d||(Qe(h.$$.fragment,p),d=!0)},o(p){ut(h.$$.fragment,p),d=!1},d(p){ir(h,p)}}}function R0(u){let h,d,p;return d=new v0({props:{padding:{top:15,right:0,bottom:20,left:0},x:u[2],y:u[3],z:u[4],xScale:yy().paddingInner([.02]).round(!0),xDomain:u[7],yDomain:u[6],zDomain:u[6],data:u[0],$$slots:{default:[L0]},$$scope:{ctx:u}}}),{c(){h=qe("div"),er(d.$$.fragment),this.h()},l(y){h=je(y,"DIV",{class:!0});var _=Ue(h);tr(d.$$.fragment,_),_.forEach(ae),this.h()},h(){oe(h,"class","chart-container svelte-1i1qsul")},m(y,_){Le(y,h,_),rr(d,h,null),p=!0},p(y,[_]){const a={};_&4&&(a.x=y[2]),_&8&&(a.y=y[3]),_&16&&(a.z=y[4]),_&128&&(a.xDomain=y[7]),_&64&&(a.yDomain=y[6]),_&64&&(a.zDomain=y[6]),_&1&&(a.data=y[0]),_&1058&&(a.$$scope={dirty:_,ctx:y}),d.$set(a)},i(y){p||(Qe(d.$$.fragment,y),p=!0)},o(y){ut(d.$$.fragment,y),p=!1},d(y){y&&ae(h),ir(d)}}}function B0(u,h,d){let p,y,_,{data:a}=h,{suffix:T="%"}=h,{decimals:E=null}=h,{fill:D="#00205B"}=h,{xKey:F="x"}=h,{yKey:L="y"}=h,{zKey:R=null}=h;return u.$$set=X=>{"data"in X&&d(0,a=X.data),"suffix"in X&&d(8,T=X.suffix),"decimals"in X&&d(9,E=X.decimals),"fill"in X&&d(1,D=X.fill),"xKey"in X&&d(2,F=X.xKey),"yKey"in X&&d(3,L=X.yKey),"zKey"in X&&d(4,R=X.zKey)},u.$$.update=()=>{u.$$.dirty&5&&d(7,p=a.map(X=>X[F])),u.$$.dirty&9&&d(6,y=[0,Math.max(...a.map(X=>X[L]))]),u.$$.dirty&768&&d(5,_=X=>X.toFixed(E)+T)},[a,D,F,L,R,_,y,p,T,E]}class Rh extends fn{constructor(h){super(),dn(this,h,B0,R0,mn,{data:0,suffix:8,decimals:9,fill:1,xKey:2,yKey:3,zKey:4})}}function am(u,h,d){const p=u.slice();return p[6]=h[d],p[8]=d,p}function om(u){let h,d=u[0],p=[];for(let y=0;y<d.length;y+=1)p[y]=sm(am(u,d,y));return{c(){h=Hn("svg");for(let y=0;y<p.length;y+=1)p[y].c();this.h()},l(y){h=Xn(y,"svg",{class:!0});var _=Ue(h);for(let a=0;a<p.length;a+=1)p[a].l(_);_.forEach(ae),this.h()},h(){oe(h,"class","stack svelte-pzvhwz")},m(y,_){Le(y,h,_);for(let a=0;a<p.length;a+=1)p[a]&&p[a].m(h,null)},p(y,_){if(_&31){d=y[0];let a;for(a=0;a<d.length;a+=1){const T=am(y,d,a);p[a]?p[a].p(T,_):(p[a]=sm(T),p[a].c(),p[a].m(h,null))}for(;a<p.length;a+=1)p[a].d(1);p.length=d.length}},d(y){y&&ae(h),tn(p,y)}}}function sm(u){let h,d;return{c(){h=Hn("rect"),this.h()},l(p){h=Xn(p,"rect",{class:!0,x:!0,style:!0}),Ue(h).forEach(ae),this.h()},h(){oe(h,"class","cell svelte-pzvhwz"),oe(h,"x",d=u[4][u[8]]/u[3]*100+"%"),Xe(h,"width",u[6][u[1]]/u[3]*100+"%"),Xe(h,"fill",u[2][u[8]])},m(p,y){Le(p,h,y)},p(p,y){y&24&&d!==(d=p[4][p[8]]/p[3]*100+"%")&&oe(h,"x",d),y&11&&Xe(h,"width",p[6][p[1]]/p[3]*100+"%"),y&4&&Xe(h,"fill",p[2][p[8]])},d(p){p&&ae(h)}}}function O0(u){let h,d=u[3]&&u[4]&&om(u);return{c(){d&&d.c(),h=or()},l(p){d&&d.l(p),h=or()},m(p,y){d&&d.m(p,y),Le(p,h,y)},p(p,[y]){p[3]&&p[4]?d?d.p(p,y):(d=om(p),d.c(),d.m(h.parentNode,h)):d&&(d.d(1),d=null)},i:si,o:si,d(p){d&&d.d(p),p&&ae(h)}}}function F0(u,h,d){let{data:p}=h,{yKey:y="y"}=h,{colors:_=["#00205B","#308182","#002417","#BD00BD","lightgrey"]}=h,a,T;function E(){d(3,a=p.map(F=>F[y]).reduce((F,L)=>F+L,0));let D=[0];p.forEach(F=>D.push(D[D.length-1]+F[y])),d(4,T=D)}return u.$$set=D=>{"data"in D&&d(0,p=D.data),"yKey"in D&&d(1,y=D.yKey),"colors"in D&&d(2,_=D.colors)},u.$$.update=()=>{u.$$.dirty&3&&(p||y)&&E()},[p,y,_,a,T]}class Yp extends fn{constructor(h){super(),dn(this,h,F0,O0,mn,{data:0,yKey:1,colors:2})}}function lm(u,h,d){const p=u.slice();return p[10]=h[d],p[12]=d,p}function N0(u){let h,d,p=u[6](u[10][u[3]])+"",y,_;return{c(){h=qe("span"),d=Ot("(NI "),y=Ot(p),_=Ot(")"),this.h()},l(a){h=je(a,"SPAN",{class:!0,style:!0});var T=Ue(h);d=Ft(T,"(NI "),y=Ft(T,p),_=Ft(T,")"),T.forEach(ae),this.h()},h(){oe(h,"class",""),Xe(h,"color","#1460aa")},m(a,T){Le(a,h,T),Ie(h,d),Ie(h,y),Ie(h,_)},p(a,T){T&9&&p!==(p=a[6](a[10][a[3]])+"")&&Tr(y,p)},d(a){a&&ae(h)}}}function U0(u){let h;return{c(){h=qe("span"),this.h()},l(d){h=je(d,"SPAN",{class:!0,style:!0}),Ue(h).forEach(ae),this.h()},h(){oe(h,"class",""),Xe(h,"color","#1460aa")},m(d,p){Le(d,h,p)},p:si,d(d){d&&ae(h)}}}function V0(u){let h,d,p=_d(Math.round(u[10][u[3]]),"%)")+"",y;return{c(){h=qe("span"),d=Ot("(2011 "),y=Ot(p),this.h()},l(_){h=je(_,"SPAN",{class:!0,style:!0});var a=Ue(h);d=Ft(a,"(2011 "),y=Ft(a,p),a.forEach(ae),this.h()},h(){oe(h,"class",""),Xe(h,"color","#1460aa")},m(_,a){Le(_,h,a),Ie(h,d),Ie(h,y)},p(_,a){a&9&&p!==(p=_d(Math.round(_[10][_[3]]),"%)")+"")&&Tr(y,p)},d(_){_&&ae(h)}}}function um(u){let h,d,p,y,_,a=u[10][u[1]]+"",T,E,D,F=u[6](u[10][u[2]])+"",L,R,X;function ne(de,xe){if(de[3]=="prev"&&de[4])return V0;if(de[3]=="prev"&&!de[4])return U0;if(de[3])return N0}let pe=ne(u),ve=pe&&pe(u);return{c(){h=qe("tr"),d=qe("td"),p=Hn("svg"),y=Hn("rect"),_=vt(),T=Ot(a),E=vt(),D=qe("td"),L=Ot(F),R=vt(),ve&&ve.c(),X=vt(),this.h()},l(de){h=je(de,"TR",{});var xe=Ue(h);d=je(xe,"TD",{class:!0});var $e=Ue(d);p=Xn($e,"svg",{width:!0,height:!0,class:!0});var ht=Ue(p);y=Xn(ht,"rect",{width:!0,height:!0,style:!0}),Ue(y).forEach(ae),ht.forEach(ae),_=bt($e),T=Ft($e,a),$e.forEach(ae),E=bt(xe),D=je(xe,"TD",{class:!0,style:!0});var Pe=Ue(D);L=Ft(Pe,F),R=bt(Pe),ve&&ve.l(Pe),Pe.forEach(ae),X=bt(xe),xe.forEach(ae),this.h()},h(){oe(y,"width","20"),oe(y,"height","30"),Xe(y,"fill",u[5][u[12]]),oe(p,"width","20"),oe(p,"height","30"),oe(p,"class","bullet svelte-1gvovsq"),oe(d,"class","svelte-1gvovsq"),oe(D,"class","cell-right svelte-1gvovsq"),Xe(D,"vertical-align","top")},m(de,xe){Le(de,h,xe),Ie(h,d),Ie(d,p),Ie(p,y),Ie(d,_),Ie(d,T),Ie(h,E),Ie(h,D),Ie(D,L),Ie(D,R),ve&&ve.m(D,null),Ie(h,X)},p(de,xe){xe&32&&Xe(y,"fill",de[5][de[12]]),xe&3&&a!==(a=de[10][de[1]]+"")&&Tr(T,a),xe&5&&F!==(F=de[6](de[10][de[2]])+"")&&Tr(L,F),pe===(pe=ne(de))&&ve?ve.p(de,xe):(ve&&ve.d(1),ve=pe&&pe(de),ve&&(ve.c(),ve.m(D,null)))},d(de){de&&ae(h),ve&&ve.d()}}}function q0(u){let h,d,p=u[0],y=[];for(let _=0;_<p.length;_+=1)y[_]=um(lm(u,p,_));return{c(){h=qe("table"),d=qe("tbody");for(let _=0;_<y.length;_+=1)y[_].c();this.h()},l(_){h=je(_,"TABLE",{class:!0});var a=Ue(h);d=je(a,"TBODY",{});var T=Ue(d);for(let E=0;E<y.length;E+=1)y[E].l(T);T.forEach(ae),a.forEach(ae),this.h()},h(){oe(h,"class","legend svelte-1gvovsq")},m(_,a){Le(_,h,a),Ie(h,d);for(let T=0;T<y.length;T+=1)y[T]&&y[T].m(d,null)},p(_,[a]){if(a&127){p=_[0];let T;for(T=0;T<p.length;T+=1){const E=lm(_,p,T);y[T]?y[T].p(E,a):(y[T]=um(E),y[T].c(),y[T].m(d,null))}for(;T<y.length;T+=1)y[T].d(1);y.length=p.length}},i:si,o:si,d(_){_&&ae(h),tn(y,_)}}}function j0(u,h,d){let p,{data:y}=h,{xKey:_="x"}=h,{yKey:a="y"}=h,{zKey:T="ni"}=h,{topic_prev_available:E=!0}=h,{colors:D=["#3878c5","#00205B","#308182","#002417","#BD00BD","lightgrey"]}=h,{decimals:F=null}=h;function L(R){let X;return F?X=(R/p*100).toFixed(F)+"%":R/p*100<1?X="<1%":X=(R/p*100).toFixed(0)+"%",X}return u.$$set=R=>{"data"in R&&d(0,y=R.data),"xKey"in R&&d(1,_=R.xKey),"yKey"in R&&d(2,a=R.yKey),"zKey"in R&&d(3,T=R.zKey),"topic_prev_available"in R&&d(4,E=R.topic_prev_available),"colors"in R&&d(5,D=R.colors),"decimals"in R&&d(7,F=R.decimals)},u.$$.update=()=>{u.$$.dirty&5&&(p=y.map(R=>R[a]).reduce((R,X)=>R+X,0)),u.$$.dirty&9&&y.map(R=>R[T]).reduce((R,X)=>R+X,0)},[y,_,a,T,E,D,L,F]}class Z0 extends fn{constructor(h){super(),dn(this,h,j0,q0,mn,{data:0,xKey:1,yKey:2,zKey:3,topic_prev_available:4,colors:5,decimals:7})}}function cm(u){let h,d,p,y;d=new Yp({props:{data:u[0],yKey:u[4],colors:u[6]}});let _=u[8]&&hm(u);return{c(){h=qe("div"),er(d.$$.fragment),p=vt(),_&&_.c(),this.h()},l(a){h=je(a,"DIV",{class:!0,style:!0});var T=Ue(h);tr(d.$$.fragment,T),p=bt(T),_&&_.l(T),T.forEach(ae),this.h()},h(){oe(h,"class","chart svelte-1tebgpk"),Xe(h,"height",u[1]*.28+"px")},m(a,T){Le(a,h,T),rr(d,h,null),Ie(h,p),_&&_.m(h,null),y=!0},p(a,T){const E={};T&1&&(E.data=a[0]),T&16&&(E.yKey=a[4]),T&64&&(E.colors=a[6]),d.$set(E),a[8]?_?_.p(a,T):(_=hm(a),_.c(),_.m(h,null)):_&&(_.d(1),_=null),(!y||T&2)&&Xe(h,"height",a[1]*.28+"px")},i(a){y||(Qe(d.$$.fragment,a),y=!0)},o(a){ut(d.$$.fragment,a),y=!1},d(a){a&&ae(h),ir(d),_&&_.d()}}}function hm(u){let h,d;return{c(){h=qe("div"),d=Ot(u[8]),this.h()},l(p){h=je(p,"DIV",{class:!0});var y=Ue(h);d=Ft(y,u[8]),y.forEach(ae),this.h()},h(){oe(h,"class","label svelte-1tebgpk")},m(p,y){Le(p,h,y),Ie(h,d)},p(p,y){y&256&&Tr(d,p[8])},d(p){p&&ae(h)}}}function pm(u){let h,d,p,y,_,a;return d=new Yp({props:{data:u[0],yKey:u[4],colors:u[6]}}),{c(){h=qe("div"),er(d.$$.fragment),p=vt(),y=qe("div"),_=Ot("2011 comparison not available"),this.h()},l(T){h=je(T,"DIV",{class:!0,style:!0});var E=Ue(h);tr(d.$$.fragment,E),p=bt(E),y=je(E,"DIV",{class:!0,style:!0});var D=Ue(y);_=Ft(D,"2011 comparison not available"),D.forEach(ae),E.forEach(ae),this.h()},h(){oe(y,"class","label svelte-1tebgpk"),Xe(y,"background-color","#d8d8d8 "),Xe(y,"color","#000000"),oe(h,"class","chart svelte-1tebgpk"),Xe(h,"height",u[1]*.28+"px")},m(T,E){Le(T,h,E),rr(d,h,null),Ie(h,p),Ie(h,y),Ie(y,_),a=!0},p(T,E){const D={};E&1&&(D.data=T[0]),E&16&&(D.yKey=T[4]),E&64&&(D.colors=T[6]),d.$set(D),(!a||E&2)&&Xe(h,"height",T[1]*.28+"px")},i(T){a||(Qe(d.$$.fragment,T),a=!0)},o(T){ut(d.$$.fragment,T),a=!1},d(T){T&&ae(h),ir(d)}}}function G0(u){let h,d,p,y,_,a,T,E;d=new Yp({props:{data:u[0],yKey:u[3],colors:u[6]}});let D=(u[4]&&u[5]||u[4]=="ni")&&cm(u),F=u[4]=="prev"&&!u[5]&&pm(u);return T=new Z0({props:{data:u[0],xKey:u[2],yKey:u[3],zKey:u[4],topic_prev_available:u[5],decimals:u[7],colors:u[6]}}),{c(){h=qe("div"),er(d.$$.fragment),p=vt(),D&&D.c(),y=vt(),F&&F.c(),_=vt(),a=qe("div"),er(T.$$.fragment),this.h()},l(L){h=je(L,"DIV",{class:!0,style:!0});var R=Ue(h);tr(d.$$.fragment,R),R.forEach(ae),p=bt(L),D&&D.l(L),y=bt(L),F&&F.l(L),_=bt(L),a=je(L,"DIV",{class:!0});var X=Ue(a);tr(T.$$.fragment,X),X.forEach(ae),this.h()},h(){oe(h,"class","chart svelte-1tebgpk"),Xe(h,"padding-top","3px"),Xe(h,"height",(u[4]?u[1]*.72:u[1])+"px"),oe(a,"class","legend svelte-1tebgpk")},m(L,R){Le(L,h,R),rr(d,h,null),Le(L,p,R),D&&D.m(L,R),Le(L,y,R),F&&F.m(L,R),Le(L,_,R),Le(L,a,R),rr(T,a,null),E=!0},p(L,[R]){const X={};R&1&&(X.data=L[0]),R&8&&(X.yKey=L[3]),R&64&&(X.colors=L[6]),d.$set(X),(!E||R&18)&&Xe(h,"height",(L[4]?L[1]*.72:L[1])+"px"),L[4]&&L[5]||L[4]=="ni"?D?(D.p(L,R),R&48&&Qe(D,1)):(D=cm(L),D.c(),Qe(D,1),D.m(y.parentNode,y)):D&&(En(),ut(D,1,1,()=>{D=null}),zn()),L[4]=="prev"&&!L[5]?F?(F.p(L,R),R&48&&Qe(F,1)):(F=pm(L),F.c(),Qe(F,1),F.m(_.parentNode,_)):F&&(En(),ut(F,1,1,()=>{F=null}),zn());const ne={};R&1&&(ne.data=L[0]),R&4&&(ne.xKey=L[2]),R&8&&(ne.yKey=L[3]),R&16&&(ne.zKey=L[4]),R&32&&(ne.topic_prev_available=L[5]),R&128&&(ne.decimals=L[7]),R&64&&(ne.colors=L[6]),T.$set(ne)},i(L){E||(Qe(d.$$.fragment,L),Qe(D),Qe(F),Qe(T.$$.fragment,L),E=!0)},o(L){ut(d.$$.fragment,L),ut(D),ut(F),ut(T.$$.fragment,L),E=!1},d(L){L&&ae(h),ir(d),L&&ae(p),D&&D.d(L),L&&ae(y),F&&F.d(L),L&&ae(_),L&&ae(a),ir(T)}}}function K0(u,h,d){let{data:p}=h,{height:y=80}=h,{xKey:_="x"}=h,{yKey:a="y"}=h,{zKey:T="ni"}=h,{topic_prev_available:E=!0}=h,{colors:D=["#8268b6","#00205B","#308182","#3d007a","#3878c5","lightgrey"]}=h,{decimals:F=null}=h,{label:L=null}=h;return u.$$set=R=>{"data"in R&&d(0,p=R.data),"height"in R&&d(1,y=R.height),"xKey"in R&&d(2,_=R.xKey),"yKey"in R&&d(3,a=R.yKey),"zKey"in R&&d(4,T=R.zKey),"topic_prev_available"in R&&d(5,E=R.topic_prev_available),"colors"in R&&d(6,D=R.colors),"decimals"in R&&d(7,F=R.decimals),"label"in R&&d(8,L=R.label)},[p,y,_,a,T,E,D,F,L]}class Bh extends fn{constructor(h){super(),dn(this,h,K0,G0,mn,{data:0,height:1,xKey:2,yKey:3,zKey:4,topic_prev_available:5,colors:6,decimals:7,label:8})}}function fm(u,h,d){const p=u.slice();return p[15]=h[d],p}function dm(u,h,d){const p=u.slice();return p[18]=h[d],p[19]=h,p[20]=d,p}function mm(u,h,d){const p=u.slice();return p[15]=h[d],p[20]=d,p}function ym(u){let h,d=u[5],p=[];for(let y=0;y<d.length;y+=1)p[y]=gm(mm(u,d,y));return{c(){h=qe("ul");for(let y=0;y<p.length;y+=1)p[y].c();this.h()},l(y){h=je(y,"UL",{class:!0});var _=Ue(h);for(let a=0;a<p.length;a+=1)p[a].l(_);_.forEach(ae),this.h()},h(){oe(h,"class","legend-block svelte-sk00pb")},m(y,_){Le(y,h,_);for(let a=0;a<p.length;a+=1)p[a]&&p[a].m(h,null)},p(y,_){if(_&32){d=y[5];let a;for(a=0;a<d.length;a+=1){const T=mm(y,d,a);p[a]?p[a].p(T,_):(p[a]=gm(T),p[a].c(),p[a].m(h,null))}for(;a<p.length;a+=1)p[a].d(1);p.length=d.length}},d(y){y&&ae(h),tn(p,y)}}}function gm(u){let h,d,p,y,_=u[15]+"",a,T;return{c(){h=qe("li"),d=qe("div"),p=vt(),y=qe("span"),a=Ot(_),T=vt(),this.h()},l(E){h=je(E,"LI",{class:!0});var D=Ue(h);d=je(D,"DIV",{class:!0}),Ue(d).forEach(ae),p=bt(D),y=je(D,"SPAN",{});var F=Ue(y);a=Ft(F,_),F.forEach(ae),T=bt(D),D.forEach(ae),this.h()},h(){oe(d,"class","legend-vis "+(u[20]==0?"bar":"bar2")+" svelte-sk00pb"),oe(h,"class","svelte-sk00pb")},m(E,D){Le(E,h,D),Ie(h,d),Ie(h,p),Ie(h,y),Ie(y,a),Ie(h,T)},p(E,D){D&32&&_!==(_=E[15]+"")&&Tr(a,_)},d(E){E&&ae(h)}}}function _m(u){let h,d=`${u[4](u[18][u[0]])}%`,p,y,_=bm(u[18][u[0]])+"",a,T,E=`calc(${u[4](u[18][u[0]])}% + 2px)`;function D(){u[12].call(y,u[19],u[20])}return{c(){h=qe("div"),p=vt(),y=qe("div"),a=Ot(_),this.h()},l(F){h=je(F,"DIV",{class:!0}),Ue(h).forEach(ae),p=bt(F),y=je(F,"DIV",{class:!0});var L=Ue(y);a=Ft(L,_),L.forEach(ae),this.h()},h(){oe(h,"class",Ph(u[20]==0?"bar":"bar2")+" svelte-sk00pb"),Xe(h,"left","0"),Xe(h,"width",d),Xe(h,"top",u[20]==0?"0":"50%"),Xe(h,"height",u[5][1]?"50%":"100%"),oe(y,"class","label svelte-sk00pb"),Ku(()=>D.call(y)),Xe(y,"left",E),Xe(y,"top",u[20]==0?"0":"50%"),Xe(y,"height","50%")},m(F,L){Le(F,h,L),Le(F,p,L),Le(F,y,L),Ie(y,a),T=Hu(y,D.bind(y))},p(F,L){u=F,L&25&&d!==(d=`${u[4](u[18][u[0]])}%`)&&Xe(h,"width",d),L&32&&Xe(h,"height",u[5][1]?"50%":"100%"),L&9&&_!==(_=bm(u[18][u[0]])+"")&&Tr(a,_),L&25&&E!==(E=`calc(${u[4](u[18][u[0]])}% + 2px)`)&&Xe(y,"left",E)},d(F){F&&ae(h),F&&ae(p),F&&ae(y),T()}}}function vm(u){let h,d=u[15].label+"",p,y,_,a,T=`${u[5][1]?u[1]*2:u[1]}px`,E=`calc(100% - ${u[2]}px)`,D=u[15].values,F=[];for(let L=0;L<D.length;L+=1)F[L]=_m(dm(u,D,L));return{c(){h=qe("div"),p=Ot(d),y=vt(),_=qe("div");for(let L=0;L<F.length;L+=1)F[L].c();a=vt(),this.h()},l(L){h=je(L,"DIV",{class:!0});var R=Ue(h);p=Ft(R,d),R.forEach(ae),y=bt(L),_=je(L,"DIV",{class:!0});var X=Ue(_);for(let ne=0;ne<F.length;ne+=1)F[ne].l(X);a=bt(X),X.forEach(ae),this.h()},h(){oe(h,"class","label-group svelte-sk00pb"),oe(_,"class","bar-group svelte-sk00pb"),Xe(_,"height",T),Xe(_,"width",E)},m(L,R){Le(L,h,R),Ie(h,p),Le(L,y,R),Le(L,_,R);for(let X=0;X<F.length;X+=1)F[X]&&F[X].m(_,null);Ie(_,a)},p(L,R){if(R&8&&d!==(d=L[15].label+"")&&Tr(p,d),R&57){D=L[15].values;let X;for(X=0;X<D.length;X+=1){const ne=dm(L,D,X);F[X]?F[X].p(ne,R):(F[X]=_m(ne),F[X].c(),F[X].m(_,a))}for(;X<F.length;X+=1)F[X].d(1);F.length=D.length}R&34&&T!==(T=`${L[5][1]?L[1]*2:L[1]}px`)&&Xe(_,"height",T),R&4&&E!==(E=`calc(100% - ${L[2]}px)`)&&Xe(_,"width",E)},d(L){L&&ae(h),L&&ae(y),L&&ae(_),tn(F,L)}}}function H0(u){let h,d,p=u[5][1]&&ym(u),y=u[3],_=[];for(let a=0;a<y.length;a+=1)_[a]=vm(fm(u,y,a));return{c(){p&&p.c(),h=vt();for(let a=0;a<_.length;a+=1)_[a].c();d=or()},l(a){p&&p.l(a),h=bt(a);for(let T=0;T<_.length;T+=1)_[T].l(a);d=or()},m(a,T){p&&p.m(a,T),Le(a,h,T);for(let E=0;E<_.length;E+=1)_[E]&&_[E].m(a,T);Le(a,d,T)},p(a,[T]){if(a[5][1]?p?p.p(a,T):(p=ym(a),p.c(),p.m(h.parentNode,h)):p&&(p.d(1),p=null),T&63){y=a[3];let E;for(E=0;E<y.length;E+=1){const D=fm(a,y,E);_[E]?_[E].p(D,T):(_[E]=vm(D),_[E].c(),_[E].m(d.parentNode,d))}for(;E<_.length;E+=1)_[E].d(1);_.length=y.length}},i:si,o:si,d(a){p&&p.d(a),a&&ae(h),tn(_,a),a&&ae(d)}}}function bm(u){let h;return u<1?h="<1%":h=u.toFixed(0)+"%",h}function X0(u,h,d){let p,y,_,a,{data:T}=h,{xKey:E="perc"}=h,{yKey:D="category"}=h,{zKey:F="ni"}=h,{formatTick:L=de=>Math.round(de)}=h,{suffix:R="%"}=h,{barHeight:X=20}=h,{margin:ne=30}=h;function pe(de,xe){let $e={};for(const Pe of de)$e[Pe[xe]]||($e[Pe[xe]]={label:Pe[xe],values:[]}),$e[Pe[xe]].values.push(Pe);let ht=[];for(const Pe in $e)ht.push($e[Pe]);return ht}function ve(de,xe){de[xe].width=this.clientWidth,d(3,a),d(6,T),d(7,D)}return u.$$set=de=>{"data"in de&&d(6,T=de.data),"xKey"in de&&d(0,E=de.xKey),"yKey"in de&&d(7,D=de.yKey),"zKey"in de&&d(8,F=de.zKey),"formatTick"in de&&d(9,L=de.formatTick),"suffix"in de&&d(10,R=de.suffix),"barHeight"in de&&d(1,X=de.barHeight),"margin"in de&&d(2,ne=de.margin)},u.$$.update=()=>{u.$$.dirty&65&&d(11,p=[0,Math.max(...T.map(de=>de[E]))]),u.$$.dirty&192&&T.map(de=>de[D]).filter((de,xe,$e)=>$e.indexOf(de)===xe),u.$$.dirty&320&&d(5,y=T.map(de=>de[F]).filter((de,xe,$e)=>$e.indexOf(de)===xe)),u.$$.dirty&2048&&d(4,_=de=>de/p[1]*100),u.$$.dirty&192&&d(3,a=pe(T,D))},[E,X,ne,a,_,y,T,D,F,L,R,p,ve]}class Oh extends fn{constructor(h){super(),dn(this,h,X0,H0,mn,{data:6,xKey:0,yKey:7,zKey:8,formatTick:9,suffix:10,barHeight:1,margin:2})}}function xm(u,h,d){const p=u.slice();return p[14]=h[d],p}function wm(u,h,d){const p=u.slice();return p[17]=h[d],p[19]=d,p}function Sm(u,h,d){const p=u.slice();return p[17]=h[d],p[19]=d,p}function km(u,h,d){const p=u.slice();return p[14]=h[d],p[19]=d,p}function Em(u){let h,d=u[7],p=[];for(let y=0;y<d.length;y+=1)p[y]=zm(km(u,d,y));return{c(){h=qe("ul");for(let y=0;y<p.length;y+=1)p[y].c();this.h()},l(y){h=je(y,"UL",{class:!0});var _=Ue(h);for(let a=0;a<p.length;a+=1)p[a].l(_);_.forEach(ae),this.h()},h(){oe(h,"class","legend svelte-1hk4284")},m(y,_){Le(y,h,_);for(let a=0;a<p.length;a+=1)p[a]&&p[a].m(h,null)},p(y,_){if(_&144){d=y[7];let a;for(a=0;a<d.length;a+=1){const T=km(y,d,a);p[a]?p[a].p(T,_):(p[a]=zm(T),p[a].c(),p[a].m(h,null))}for(;a<p.length;a+=1)p[a].d(1);p.length=d.length}},d(y){y&&ae(h),tn(p,y)}}}function zm(u){let h,d,p,y,_=u[14]+"",a,T;return{c(){h=qe("li"),d=qe("div"),p=vt(),y=qe("span"),a=Ot(_),T=vt(),this.h()},l(E){h=je(E,"LI",{class:!0});var D=Ue(h);d=je(D,"DIV",{class:!0}),Ue(d).forEach(ae),p=bt(D),y=je(D,"SPAN",{class:!0});var F=Ue(y);a=Ft(F,_),F.forEach(ae),T=bt(D),D.forEach(ae),this.h()},h(){oe(d,"class","legend-vis "+(u[19]==0?"bar":"marker")+" svelte-1hk4284"),Xe(d,"height","1rem"),Xe(d,"width",u[19]==0?"1rem":u[4]+"px"),oe(y,"class",Ph(u[19]==0?"bold":"brackets")+" svelte-1hk4284"),oe(h,"class","svelte-1hk4284")},m(E,D){Le(E,h,D),Ie(h,d),Ie(h,p),Ie(h,y),Ie(y,a),Ie(h,T)},p(E,D){D&16&&Xe(d,"width",E[19]==0?"1rem":E[4]+"px"),D&128&&_!==(_=E[14]+"")&&Tr(a,_)},d(E){E&&ae(h)}}}function Tm(u){let h,d=u[1](u[17].perc/100)+"",p,y;return{c(){h=qe("span"),p=Ot(d),y=Ot(u[2]),this.h()},l(_){h=je(_,"SPAN",{class:!0,style:!0});var a=Ue(h);p=Ft(a,d),y=Ft(a,u[2]),a.forEach(ae),this.h()},h(){oe(h,"class",Ph(u[19]==0?"bold":"sml brackets")+" svelte-1hk4284"),Xe(h,"color",u[19]==0?"#000000":"#1460aa")},m(_,a){Le(_,h,a),Ie(h,p),Ie(h,y)},p(_,a){a&34&&d!==(d=_[1](_[17].perc/100)+"")&&Tr(p,d),a&4&&Tr(y,_[2])},d(_){_&&ae(h)}}}function W0(u){let h,d=`calc(${u[6](u[17][u[0]])}% - ${u[4]/2}px)`,p=`${u[4]}px`;return{c(){h=qe("div"),this.h()},l(y){h=je(y,"DIV",{class:!0}),Ue(h).forEach(ae),this.h()},h(){oe(h,"class","marker svelte-1hk4284"),Xe(h,"left",d),Xe(h,"border-left-width",p)},m(y,_){Le(y,h,_)},p(y,_){_&113&&d!==(d=`calc(${y[6](y[17][y[0]])}% - ${y[4]/2}px)`)&&Xe(h,"left",d),_&16&&p!==(p=`${y[4]}px`)&&Xe(h,"border-left-width",p)},d(y){y&&ae(h)}}}function Y0(u){let h,d=`${u[6](u[17][u[0]])}%`;return{c(){h=qe("div"),this.h()},l(p){h=je(p,"DIV",{class:!0}),Ue(h).forEach(ae),this.h()},h(){oe(h,"class","bar svelte-1hk4284"),Xe(h,"left","0"),Xe(h,"width",d)},m(p,y){Le(p,h,y)},p(p,y){y&97&&d!==(d=`${p[6](p[17][p[0]])}%`)&&Xe(h,"width",d)},d(p){p&&ae(h)}}}function Im(u){let h;function d(_,a){return _[19]==0?Y0:W0}let y=d(u)(u);return{c(){y.c(),h=or()},l(_){y.l(_),h=or()},m(_,a){y.m(_,a),Le(_,h,a)},p(_,a){y.p(_,a)},d(_){y.d(_),_&&ae(h)}}}function Am(u){let h,d=u[14].label+"",p,y,_,a,T,E=`${u[3]}px`,D=u[14].values,F=[];for(let X=0;X<D.length;X+=1)F[X]=Tm(Sm(u,D,X));let L=u[14].values,R=[];for(let X=0;X<L.length;X+=1)R[X]=Im(wm(u,L,X));return{c(){h=qe("div"),p=Ot(d),y=vt();for(let X=0;X<F.length;X+=1)F[X].c();_=vt(),a=qe("div");for(let X=0;X<R.length;X+=1)R[X].c();T=vt(),this.h()},l(X){h=je(X,"DIV",{class:!0});var ne=Ue(h);p=Ft(ne,d),y=bt(ne);for(let ve=0;ve<F.length;ve+=1)F[ve].l(ne);ne.forEach(ae),_=bt(X),a=je(X,"DIV",{class:!0});var pe=Ue(a);for(let ve=0;ve<R.length;ve+=1)R[ve].l(pe);T=bt(pe),pe.forEach(ae),this.h()},h(){oe(h,"class","label-group svelte-1hk4284"),oe(a,"class","bar-group svelte-1hk4284"),Xe(a,"height",E)},m(X,ne){Le(X,h,ne),Ie(h,p),Ie(h,y);for(let pe=0;pe<F.length;pe+=1)F[pe]&&F[pe].m(h,null);Le(X,_,ne),Le(X,a,ne);for(let pe=0;pe<R.length;pe+=1)R[pe]&&R[pe].m(a,null);Ie(a,T)},p(X,ne){if(ne&32&&d!==(d=X[14].label+"")&&Tr(p,d),ne&38){D=X[14].values;let pe;for(pe=0;pe<D.length;pe+=1){const ve=Sm(X,D,pe);F[pe]?F[pe].p(ve,ne):(F[pe]=Tm(ve),F[pe].c(),F[pe].m(h,null))}for(;pe<F.length;pe+=1)F[pe].d(1);F.length=D.length}if(ne&113){L=X[14].values;let pe;for(pe=0;pe<L.length;pe+=1){const ve=wm(X,L,pe);R[pe]?R[pe].p(ve,ne):(R[pe]=Im(ve),R[pe].c(),R[pe].m(a,T))}for(;pe<R.length;pe+=1)R[pe].d(1);R.length=L.length}ne&8&&E!==(E=`${X[3]}px`)&&Xe(a,"height",E)},d(X){X&&ae(h),tn(F,X),X&&ae(_),X&&ae(a),tn(R,X)}}}function J0(u){let h,d,p=u[7][1]&&Em(u),y=u[5],_=[];for(let a=0;a<y.length;a+=1)_[a]=Am(xm(u,y,a));return{c(){p&&p.c(),h=vt();for(let a=0;a<_.length;a+=1)_[a].c();d=or()},l(a){p&&p.l(a),h=bt(a);for(let T=0;T<_.length;T+=1)_[T].l(a);d=or()},m(a,T){p&&p.m(a,T),Le(a,h,T);for(let E=0;E<_.length;E+=1)_[E]&&_[E].m(a,T);Le(a,d,T)},p(a,[T]){if(a[7][1]?p?p.p(a,T):(p=Em(a),p.c(),p.m(h.parentNode,h)):p&&(p.d(1),p=null),T&127){y=a[5];let E;for(E=0;E<y.length;E+=1){const D=xm(a,y,E);_[E]?_[E].p(D,T):(_[E]=Am(D),_[E].c(),_[E].m(d.parentNode,d))}for(;E<_.length;E+=1)_[E].d(1);_.length=y.length}},i:si,o:si,d(a){p&&p.d(a),a&&ae(h),tn(_,a),a&&ae(d)}}}function Q0(u,h,d){let p,y,_,a,{data:T}=h,{xKey:E="perc"}=h,{yKey:D="category"}=h,{zKey:F="group"}=h,{formatTick:L=ve=>Math.round(100*ve)}=h,{suffix:R="%"}=h,{barHeight:X=25}=h,{markerWidth:ne=3}=h;function pe(ve,de){let xe={};for(const ht of ve)xe[ht[de]]||(xe[ht[de]]={label:ht[de],values:[]}),xe[ht[de]].values.push(ht);let $e=[];for(const ht in xe)$e.push(xe[ht]);return $e}return u.$$set=ve=>{"data"in ve&&d(8,T=ve.data),"xKey"in ve&&d(0,E=ve.xKey),"yKey"in ve&&d(9,D=ve.yKey),"zKey"in ve&&d(10,F=ve.zKey),"formatTick"in ve&&d(1,L=ve.formatTick),"suffix"in ve&&d(2,R=ve.suffix),"barHeight"in ve&&d(3,X=ve.barHeight),"markerWidth"in ve&&d(4,ne=ve.markerWidth)},u.$$.update=()=>{u.$$.dirty&257&&d(11,p=[0,Math.max(...T.map(ve=>ve[E]))]),u.$$.dirty&768&&T.map(ve=>ve[D]).filter((ve,de,xe)=>xe.indexOf(ve)===de),u.$$.dirty&1280&&d(7,y=T.map(ve=>ve[F]).filter((ve,de,xe)=>xe.indexOf(ve)===de)),u.$$.dirty&2048&&d(6,_=ve=>ve/p[1]*100),u.$$.dirty&768&&d(5,a=pe(T,D))},[E,L,R,X,ne,a,_,y,T,D,F,p]}class Fh extends fn{constructor(h){super(),dn(this,h,Q0,J0,mn,{data:8,xKey:0,yKey:9,zKey:10,formatTick:1,suffix:2,barHeight:3,markerWidth:4})}}function Pm(u,h,d){const p=u.slice();return p[12]=h[d],p[14]=d,p}function Cm(u,h,d){const p=u.slice();return p[15]=h[d],p[17]=d,p}function Mm(u,h,d){const p=u.slice();return p[15]=h[d],p[17]=d,p}function Dm(u,h,d){const p=u.slice();return p[19]=h[d],p[14]=d,p}function Lm(u){let h,d=u[5],p=[];for(let y=0;y<d.length;y+=1)p[y]=Rm(Dm(u,d,y));return{c(){h=qe("ul");for(let y=0;y<p.length;y+=1)p[y].c();this.h()},l(y){h=je(y,"UL",{class:!0});var _=Ue(h);for(let a=0;a<p.length;a+=1)p[a].l(_);_.forEach(ae),this.h()},h(){oe(h,"class","legend svelte-pmaxst")},m(y,_){Le(y,h,_);for(let a=0;a<p.length;a+=1)p[a]&&p[a].m(h,null)},p(y,_){if(_&36){d=y[5];let a;for(a=0;a<d.length;a+=1){const T=Dm(y,d,a);p[a]?p[a].p(T,_):(p[a]=Rm(T),p[a].c(),p[a].m(h,null))}for(;a<p.length;a+=1)p[a].d(1);p.length=d.length}},d(y){y&&ae(h),tn(p,y)}}}function Rm(u){let h,d,p,y,_=u[19]+"",a,T;return{c(){h=qe("li"),d=qe("div"),p=vt(),y=qe("span"),a=Ot(_),T=vt(),this.h()},l(E){h=je(E,"LI",{class:!0});var D=Ue(h);d=je(D,"DIV",{class:!0}),Ue(d).forEach(ae),p=bt(D),y=je(D,"SPAN",{class:!0});var F=Ue(y);a=Ft(F,_),F.forEach(ae),T=bt(D),D.forEach(ae),this.h()},h(){oe(d,"class","legend-vis "+(u[14]==0?"bar":"markerSmall")+" svelte-pmaxst"),Xe(d,"height","1rem"),Xe(d,"width",u[14]==0?"1rem":u[2]+"px"),oe(y,"class",Ph(u[14]==0?"bold":"brackets")+" svelte-pmaxst"),oe(h,"class","svelte-pmaxst")},m(E,D){Le(E,h,D),Ie(h,d),Ie(h,p),Ie(h,y),Ie(y,a),Ie(h,T)},p(E,D){D&4&&Xe(d,"width",E[14]==0?"1rem":E[2]+"px"),D&32&&_!==(_=E[19]+"")&&Tr(a,_)},d(E){E&&ae(h)}}}function $0(u){let h,d=u[12].values,p=[];for(let y=0;y<d.length;y+=1)p[y]=Bm(Cm(u,d,y));return{c(){for(let y=0;y<p.length;y+=1)p[y].c();h=or()},l(y){for(let _=0;_<p.length;_+=1)p[_].l(y);h=or()},m(y,_){for(let a=0;a<p.length;a+=1)p[a]&&p[a].m(y,_);Le(y,h,_)},p(y,_){if(_&89){d=y[12].values;let a;for(a=0;a<d.length;a+=1){const T=Cm(y,d,a);p[a]?p[a].p(T,_):(p[a]=Bm(T),p[a].c(),p[a].m(h.parentNode,h))}for(;a<p.length;a+=1)p[a].d(1);p.length=d.length}},d(y){tn(p,y),y&&ae(h)}}}function e1(u){let h,d=u[12].values,p=[];for(let y=0;y<d.length;y+=1)p[y]=Om(Mm(u,d,y));return{c(){for(let y=0;y<p.length;y+=1)p[y].c();h=or()},l(y){for(let _=0;_<p.length;_+=1)p[_].l(y);h=or()},m(y,_){for(let a=0;a<p.length;a+=1)p[a]&&p[a].m(y,_);Le(y,h,_)},p(y,_){if(_&89){d=y[12].values;let a;for(a=0;a<d.length;a+=1){const T=Mm(y,d,a);p[a]?p[a].p(T,_):(p[a]=Om(T),p[a].c(),p[a].m(h.parentNode,h))}for(;a<p.length;a+=1)p[a].d(1);p.length=d.length}},d(y){tn(p,y),y&&ae(h)}}}function Bm(u){let h,d,p=`calc(100% - ${u[15].offset<0?u[4](u[15][u[0]]-u[15].offset):u[4](u[15][u[0]])}%)`,y=`${u[4](u[15].offset)}%`,_=`${u[17]/u[6].length*100}%`,a=`${1/u[6].length*100}%`;return{c(){h=qe("div"),this.h()},l(T){h=je(T,"DIV",{class:!0,style:!0}),Ue(h).forEach(ae),this.h()},h(){oe(h,"class","marker svelte-pmaxst"),oe(h,"style",d="border-"+(u[15].offset<0?"top":"bottom")+": none"),Xe(h,"top",p),Xe(h,"height",y),Xe(h,"left",_),Xe(h,"width",a)},m(T,E){Le(T,h,E)},p(T,E){E&8&&d!==(d="border-"+(T[15].offset<0?"top":"bottom")+": none")&&oe(h,"style",d);const D=E&8;(D||E&25&&p!==(p=`calc(100% - ${T[15].offset<0?T[4](T[15][T[0]]-T[15].offset):T[4](T[15][T[0]])}%)`))&&Xe(h,"top",p),(D||E&24&&y!==(y=`${T[4](T[15].offset)}%`))&&Xe(h,"height",y),(D||E&72&&_!==(_=`${T[17]/T[6].length*100}%`))&&Xe(h,"left",_),(D||E&72&&a!==(a=`${1/T[6].length*100}%`))&&Xe(h,"width",a)},d(T){T&&ae(h)}}}function Om(u){let h,d=`${100-u[4](u[15][u[0]])}%`,p=`${u[4](u[15][u[0]])}%`,y=`${u[17]/u[6].length*100}%`,_=`calc(${1/u[6].length*100}% - 2px)`;return{c(){h=qe("div"),this.h()},l(a){h=je(a,"DIV",{class:!0}),Ue(h).forEach(ae),this.h()},h(){oe(h,"class","bar svelte-pmaxst"),Xe(h,"top",d),Xe(h,"height",p),Xe(h,"left",y),Xe(h,"width",_)},m(a,T){Le(a,h,T)},p(a,T){T&25&&d!==(d=`${100-a[4](a[15][a[0]])}%`)&&Xe(h,"top",d),T&25&&p!==(p=`${a[4](a[15][a[0]])}%`)&&Xe(h,"height",p),T&64&&y!==(y=`${a[17]/a[6].length*100}%`)&&Xe(h,"left",y),T&64&&_!==(_=`calc(${1/a[6].length*100}% - 2px)`)&&Xe(h,"width",_)},d(a){a&&ae(h)}}}function Fm(u){let h;function d(_,a){return _[14]==0?e1:$0}let y=d(u)(u);return{c(){y.c(),h=or()},l(_){y.l(_),h=or()},m(_,a){y.m(_,a),Le(_,h,a)},p(_,a){y.p(_,a)},d(_){y.d(_),_&&ae(h)}}}function t1(u){let h,d,p=`${u[1]}px`,y,_,a,T,E,D,F,L,R,X,ne,pe,ve,de,xe=u[5][1]&&Lm(u),$e=u[3],ht=[];for(let Pe=0;Pe<$e.length;Pe+=1)ht[Pe]=Fm(Pm(u,$e,Pe));return{c(){xe&&xe.c(),h=vt(),d=qe("div");for(let Pe=0;Pe<ht.length;Pe+=1)ht[Pe].c();y=vt(),_=qe("div"),a=qe("div"),T=qe("div"),E=Ot("0-14"),D=vt(),F=qe("div"),L=Ot("15-39"),R=vt(),X=qe("div"),ne=Ot("40-64"),pe=vt(),ve=qe("div"),de=Ot("65+"),this.h()},l(Pe){xe&&xe.l(Pe),h=bt(Pe),d=je(Pe,"DIV",{class:!0});var We=Ue(d);for(let st=0;st<ht.length;st+=1)ht[st].l(We);We.forEach(ae),y=bt(Pe),_=je(Pe,"DIV",{class:!0});var gt=Ue(_);a=je(gt,"DIV",{class:!0});var Ke=Ue(a);T=je(Ke,"DIV",{class:!0});var dt=Ue(T);E=Ft(dt,"0-14"),dt.forEach(ae),D=bt(Ke),F=je(Ke,"DIV",{class:!0});var Ne=Ue(F);L=Ft(Ne,"15-39"),Ne.forEach(ae),R=bt(Ke),X=je(Ke,"DIV",{class:!0});var at=Ue(X);ne=Ft(at,"40-64"),at.forEach(ae),pe=bt(Ke),ve=je(Ke,"DIV",{class:!0});var Vt=Ue(ve);de=Ft(Vt,"65+"),Vt.forEach(ae),Ke.forEach(ae),gt.forEach(ae),this.h()},h(){oe(d,"class","bar-group svelte-pmaxst"),Xe(d,"height",p),oe(T,"class","column svelte-pmaxst"),oe(F,"class","column svelte-pmaxst"),oe(X,"class","column svelte-pmaxst"),oe(ve,"class","column svelte-pmaxst"),oe(a,"class","row svelte-pmaxst"),Xe(a,"width","100%"),oe(_,"class","x-scale svelte-pmaxst")},m(Pe,We){xe&&xe.m(Pe,We),Le(Pe,h,We),Le(Pe,d,We);for(let gt=0;gt<ht.length;gt+=1)ht[gt]&&ht[gt].m(d,null);Le(Pe,y,We),Le(Pe,_,We),Ie(_,a),Ie(a,T),Ie(T,E),Ie(a,D),Ie(a,F),Ie(F,L),Ie(a,R),Ie(a,X),Ie(X,ne),Ie(a,pe),Ie(a,ve),Ie(ve,de)},p(Pe,[We]){if(Pe[5][1]?xe?xe.p(Pe,We):(xe=Lm(Pe),xe.c(),xe.m(h.parentNode,h)):xe&&(xe.d(1),xe=null),We&89){$e=Pe[3];let gt;for(gt=0;gt<$e.length;gt+=1){const Ke=Pm(Pe,$e,gt);ht[gt]?ht[gt].p(Ke,We):(ht[gt]=Fm(Ke),ht[gt].c(),ht[gt].m(d,null))}for(;gt<ht.length;gt+=1)ht[gt].d(1);ht.length=$e.length}We&2&&p!==(p=`${Pe[1]}px`)&&Xe(d,"height",p)},i:si,o:si,d(Pe){xe&&xe.d(Pe),Pe&&ae(h),Pe&&ae(d),tn(ht,Pe),Pe&&ae(y),Pe&&ae(_)}}}function r1(u,h,d){let p,y,_,a,T,{data:E}=h,{xKey:D="category"}=h,{yKey:F="perc"}=h,{zKey:L="group"}=h,{height:R=100}=h,{markerWidth:X=3}=h;function ne(pe,ve){let de={};for(const $e of pe){de[$e[ve]]||(de[$e[ve]]={label:$e[ve],values:[]});let ht=de[$e[ve]].values.length,Pe=ht==0?0:$e[F]-de[$e[ve]].values[ht-1][F];de[$e[ve]].values.push({...$e,offset:Pe})}let xe=[];for(const $e in de)xe.push(de[$e]);return console.log(xe),xe}return u.$$set=pe=>{"data"in pe&&d(7,E=pe.data),"xKey"in pe&&d(8,D=pe.xKey),"yKey"in pe&&d(0,F=pe.yKey),"zKey"in pe&&d(9,L=pe.zKey),"height"in pe&&d(1,R=pe.height),"markerWidth"in pe&&d(2,X=pe.markerWidth)},u.$$.update=()=>{u.$$.dirty&384&&d(6,p=E.map(pe=>pe[D]).filter((pe,ve,de)=>de.indexOf(pe)===ve)),u.$$.dirty&129&&d(10,y=[0,Math.max(...E.map(pe=>pe[F]))]),u.$$.dirty&640&&d(5,_=E.map(pe=>pe[L]).filter((pe,ve,de)=>de.indexOf(pe)===ve)),u.$$.dirty&1024&&d(4,a=pe=>Math.abs(pe/y[1])*100),u.$$.dirty&640&&d(3,T=ne(E,L))},[F,R,X,T,a,_,p,E,D,L,y]}class Nh extends fn{constructor(h){super(),dn(this,h,r1,t1,mn,{data:7,xKey:8,yKey:0,zKey:9,height:1,markerWidth:2})}}function i1(u){let h,d,p,y;return{c(){h=qe("div"),d=Ot("Back to top"),this.h()},l(_){h=je(_,"DIV",{class:!0});var a=Ue(h);d=Ft(a,"Back to top"),a.forEach(ae),this.h()},h(){oe(h,"class","back_to_start svelte-11zibd5"),as(h,"hidden",u[0])},m(_,a){Le(_,h,a),Ie(h,d),p||(y=[xd(window,"scroll",u[2]),xd(h,"click",u[1])],p=!0)},p(_,[a]){a&1&&as(h,"hidden",_[0])},i:si,o:si,d(_){_&&ae(h),p=!1,c_(y)}}}function n1(u,h,d){let{buttonVisibleOnPX:p=200}=h,y=!0;const _=()=>{document.body.scrollIntoView()},a=()=>document.documentElement||document.body,T=()=>{a().scrollTop>p?d(0,y=!1):d(0,y=!0)};return u.$$set=E=>{"buttonVisibleOnPX"in E&&d(3,p=E.buttonVisibleOnPX)},[y,_,T,p]}class a1 extends fn{constructor(h){super(),dn(this,h,n1,i1,mn,{buttonVisibleOnPX:3})}}function o1(u){let h,d,p=u[1][u[0]].title+"",y,_,a,T,E,D,F,L=u[1][u[0]].info+"",R;return{c(){h=qe("div"),d=qe("div"),y=Ot(p),_=qe("span"),E=vt(),D=qe("div"),F=qe("div"),this.h()},l(X){h=je(X,"DIV",{class:!0,style:!0,"data-bs-toggle":!0,"data-bs-target":!0,"aria-expanded":!0,"aria-controls":!0});var ne=Ue(h);d=je(ne,"DIV",{class:!0,style:!0});var pe=Ue(d);y=Ft(pe,p),_=je(pe,"SPAN",{class:!0}),Ue(_).forEach(ae),pe.forEach(ae),ne.forEach(ae),E=bt(X),D=je(X,"DIV",{class:!0,id:!0});var ve=Ue(D);F=je(ve,"DIV",{class:!0});var de=Ue(F);de.forEach(ae),ve.forEach(ae),this.h()},h(){oe(_,"class","i-button"),oe(d,"class","blocktitle"),Xe(d,"margin","0"),Xe(d,"width","100%"),oe(h,"class","row"),Xe(h,"display","flex"),Xe(h,"cursor","pointer"),oe(h,"data-bs-toggle","collapse"),oe(h,"data-bs-target",a="#"+u[0]+"-info"),oe(h,"aria-expanded","false"),oe(h,"aria-controls",T=u[0]+"-info"),oe(F,"class","card card-body svelte-1qrf6oz"),oe(D,"class","collapse svelte-1qrf6oz"),oe(D,"id",R=u[0]+"-info")},m(X,ne){Le(X,h,ne),Ie(h,d),Ie(d,y),Ie(d,_),Le(X,E,ne),Le(X,D,ne),Ie(D,F),F.innerHTML=L},p(X,[ne]){ne&1&&p!==(p=X[1][X[0]].title+"")&&Tr(y,p),ne&1&&a!==(a="#"+X[0]+"-info")&&oe(h,"data-bs-target",a),ne&1&&T!==(T=X[0]+"-info")&&oe(h,"aria-controls",T),ne&1&&L!==(L=X[1][X[0]].info+"")&&(F.innerHTML=L),ne&1&&R!==(R=X[0]+"-info")&&oe(D,"id",R)},i:si,o:si,d(X){X&&ae(h),X&&ae(E),X&&ae(D)}}}function s1(u,h,d){let{id:p}=h,{place:y}=h;function _(T){let D=T.replaceAll("[",".").replaceAll("]","").split("."),F=y.meta_data;for(let L=0;L<D.length;L++)if(F.hasOwnProperty(D[L])&&(F=F[D[L]],D[L]=="last_updated")){let R=F.split("-");F=R[2]+"/"+R[1]+"/"+R[0]}return F}let a={location:{title:"About the area",info:"Information about the area including its geographical hierarchy."},area:{title:"Area",info:"Area is measured in hectares (ha), it is rounded to the nearest whole number."},popden:{title:"Population density",info:"Population density is the number of usual residents per hectare. It is rounded to 1 d.p."},pop:{title:"Population",info:"Population is based on the number of usual residents. <p>From Census 2021 data - <a href='https://explore.nisra.gov.uk/area-explorer-2021/'><strong>Census Area Explorer</strong></a></p>A usual resident is anyone who, on 21 March 2021 is in the UK, and staying in the UK for a period of 3 months or more; or has a permanent UK address and is outside the UK and is staying outside the UK for less than 12 months. <a href='https://www.nisra.gov.uk/publications/census-2021-statistical-bulletins'><strong>Statistical bulletins</strong></a>"},generalhealth:{title:"General Health",info:"<p>From Census 2021 data - <a href='https://explore.nisra.gov.uk/area-explorer-2021/'><strong>Census Area Explorer</strong></a></p>General health is a self-assessment of a person's general state of health. It is not based over any specified period of time. <a href='https://www.nisra.gov.uk/publications/census-2021-statistical-bulletins'><strong>Statistical bulletins</strong></a>"},wellbeing:{title:"Personal Wellbeing",info:"Average Happiness score out of 10 for people aged 16+</p>Average Life satisfaction score out of 10 for people aged 16+</p><p class = 'pibutton'><a href='mailto:"+_("Happy[0].email")+"'>Email for more information</a> </p><p class = 'pibutton'>Last updated: "+_("Happy[0].last_updated")+"</p> <p class = 'pibutton'>Access data at: <a href='"+_("Happy[0].dataset_url")+"'>"+_("Happy[0].title")+"</a></p>"},lifeexpectancy:{title:"Life Expectancy at birth",info:"<p class = 'pibutton'><a href='mailto:"+_("LE[0].email")+"'>Email for more information</a> </p><p class = 'pibutton'>Last updated: "+_("LE[0].last_updated")+"</p> <p class = 'pibutton'>Access data at: <a href='"+_("LE[0].dataset_url")+"'>"+_("LE[0].title")+"</a></p>"},carers:{title:"Unpaid care giving",info:"<p>From Census 2021 data - <a href='https://explore.nisra.gov.uk/area-explorer-2021/'><strong>Census Area Explorer</strong></a></p>Unpaid care covers looking after giving help or support to anyone because they have long-term physical or mental health conditions or illnesses, or problems related to old age. It does not include any activities as part of paid employment. All unpaid care statistics are restricted to persons aged 5 and over. <a href='https://www.nisra.gov.uk/publications/census-2021-statistical-bulletins'><strong>Statistical bulletins</strong></a>"},hospitalactivity:{title:"Annual admissions to hospital",info:"<p class = 'pibutton'><a href='mailto:"+_("Admiss[0].email")+"'>Email for more information</a> </p><p class = 'pibutton'>Last updated: "+_("Admiss[0].last_updated")+"</p> <p class = 'pibutton'>Access data at: <a href='"+_("Admiss[0].dataset_url")+"'>"+_("Admiss[0].title")+"</a></p>"},primarycare:{title:"Primary care providers",info:"<p class = 'pibutton'>Access data at: <a href='"+_("GP[0].dataset_url")+"'>"+_("GP[0].title")+"</a>, <a href='"+_("DEN[0].dataset_url")+"'>"+_("DEN[0].title")+"</a> and <a href='"+_("DEN_REG[0].dataset_url")+"'>"+_("DEN_REG[0].title")+"</a></p>"},employmentrates:{title:"Work status of adults",info:"<p class = 'pibutton'><a href='mailto:"+_("LMS[0].email")+"'>Email for more information</a> </p><p class = 'pibutton'>Last updated: "+_("LMS[0].last_updated")+"</p> <p class = 'pibutton'>Access data at: <a href='"+_("LMS[0].dataset_url")+"'>"+_("LMS[0].title")+"</a></p><p>Inactive includes students, early retirees, or people looking after a home, who are long-term sick or disabled. </p>"},employed:{title:"Number of people employed",info:"<p class = 'pibutton'><a href='mailto:"+_("LMS[0].email")+"'>Email for more information</a> </p><p class = 'pibutton'>Last updated: "+_("LMS[0].last_updated")+"</p> <p class = 'pibutton'>Access data at: <a href='"+_("LMS[0].dataset_url")+"'>"+_("LMS[0].title")+"</a></p>"},wages:{title:"Average annual wage",info:"<p class = 'pibutton'><a href='mailto:"+_("ASHE[0].email")+"'>Email for more information</a> </p><p class = 'pibutton'>Last updated: "+_("ASHE[0].last_updated")+"</p> <p class = 'pibutton'>Access data at: <a href='"+_("ASHE[0].dataset_url")+"'>"+_("ASHE[0].title")+"</a></p><p>Median is the ..... </p>"},bres:{title:"Type of work",info:"<p class = 'pibutton'><a href='mailto:"+_("BRES[0].email")+"'>Email for more information</a> </p><p class = 'pibutton'>Last updated: "+_("BRES[0].last_updated")+"</p> <p class = 'pibutton'>Access data at: <a href='"+_("BRES[0].dataset_url")+"'>"+_("BRES[0].title")+"</a></p>"},pensionagebenefits:{title:"Pension Age benefits",info:"Benefits included are: SP and PC<p class = 'pibutton'><a href='mailto:"+_("BS[0].email")+"'>Email for more information</a> </p><p class = 'pibutton'>Last updated: "+_("BS[0].last_updated")+"</p> <p class = 'pibutton'>Access data at: <a href='"+_("BS[0].dataset_url")+"'>"+_("BS[0].title")+"</a></p>"},workingagebenefits:{title:"Working Age benefits",info:"Benefits included are: UC, JSA, IS and ESA<p class = 'pibutton'><a href='mailto:"+_("BS[0].email")+"'>Email for more information</a> </p><p class = 'pibutton'>Last updated: "+_("BS[0].last_updated")+"</p> <p class = 'pibutton'>Access data at: <a href='"+_("BS[0].dataset_url")+"'>"+_("BS[0].title")+"</a></p>"},disabilitybenefits:{title:"Disability and Carers benefits",info:"Benefits included are: PIP, CA, AA and DLA<p class = 'pibutton'><a href='mailto:"+_("BS[0].email")+"'>Email for more information</a> </p><p class = 'pibutton'>Last updated: "+_("BS[0].last_updated")+"</p> <p class = 'pibutton'>Access data at: <a href='"+_("BS[0].dataset_url")+"'>"+_("BS[0].title")+"</a></p>"},enrollments:{title:"People in education",info:"<p class = 'pibutton'>Access data at: <a href='"+_("Primary[0].dataset_url")+"'>"+_("Primary[0].title")+"</a>, <a href='"+_("PostPrimary[0].dataset_url")+"'>"+_("PostPrimary[0].title")+"</a>,  <a href='"+_("FE[0].dataset_url")+"'>"+_("FE[0].title")+"</a> and <a href='"+_("HE[0].dataset_url")+"'>"+_("HE[0].title")+"</a></p>"},fsme:{title:"Pupils entitled to Free School Meals",info:"<p class = 'pibutton'><a href='mailto:"+_("Primary[0].email")+"'>Email for more information</a> </p><p class = 'pibutton'>Last updated: "+_("Primary[0].last_updated")+"</p> <p class = 'pibutton'>Access data at: <a href='"+_("Primary[0].dataset_url")+"'>"+_("Primary[0].title")+"</a> and <a href='"+_("PostPrimary[0].dataset_url")+"'>"+_("PostPrimary[0].title")+"</a></p>"},teachers:{title:"School class size",info:"<p class = 'pibutton'><a href='mailto:"+_("ClassSize[0].email")+"'>Email for more information</a> </p><p class = 'pibutton'>Last updated: "+_("ClassSize[0].last_updated")+"</p> <p class = 'pibutton'>Access data at: <a href='"+_("ClassSize[0].dataset_url")+"'>"+_("ClassSize[0].title")+"</a></p>"},qualifications:{title:"Highest level of qualifications in the population",info:"<p>From Census 2021 data - <a href='https://explore.nisra.gov.uk/area-explorer-2021/'><strong>Census Area Explorer</strong></a></p>Needs tidied up with proper CSS.   The highest level of qualification categories are as follows:No qualifications;Level 1: 1 to 4 GCSEs, O levels, CSEs (any grades); 1 AS Level; NVQ level 1; or equivalent;Level 2: 5 or more GCSEs (A*-C or 9-4), O levels (passes) CSEs (grade 1); 1 A level, 2-3 AS Levels; NVQ level 2, BTEC General, City and Guilds Craft; or equivalent;Apprenticeship; Level 3: 2 or more A Levels, 4 or more AS Levels; NVQ Level 3, BTEC National, OND, ONC, City and Guilds Advanced Craft; or equivalent; Level 4 and above: Degree (BA, BSc), foundation degree, NVQ Level 4 and above, HND, HNC, professional qualifications (teaching or nursing, for example), or equivalent; and Other: Other qualifications, equivalent unknown.Highest level of qualification is derived from the question asking people aged 16 years and over to indicate all qualifications held. For qualifications gained outside Northern Ireland, respondents were directed to select the nearest equivalent."},attainment:{title:"GCSEs for school leavers",info:"<p class = 'pibutton'><a href='mailto:"+_("Attainment[0].email")+"'>Email for more information</a> </p><p class = 'pibutton'>Last updated: "+_("Attainment[0].last_updated")+"</p> <p class = 'pibutton'>Access data at: <a href='"+_("Attainment[0].dataset_url")+"'>"+_("Attainment[0].title")+"</a></p>"},empty:{title:"",info:""},destination:{title:"Next steps for school leavers",info:"<p class = 'pibutton'><a href='mailto:"+_("Destination[0].email")+"'>Email for more information</a> </p><p class = 'pibutton'>Last updated: "+_("Destination[0].last_updated")+"</p> <p class = 'pibutton'>Access data at: <a href='"+_("Destination[0].dataset_url")+"'>"+_("Destination[0].title")+"</a></p>"},popchange:{title:"Population change",info:"words to be added"},age:{title:"Age",info:"<p>From Census 2021 data - <a href='https://explore.nisra.gov.uk/area-explorer-2021/'><strong>Census Area Explorer</strong></a></p>A grouping of ages where a person's age is their age at their last birthday on or prior to census day. <a href='https://www.nisra.gov.uk/publications/census-2021-statistical-bulletins'><strong>Statistical bulletins</strong></a>"},sex:{title:"Sex",info:"words to be added"},hhsize:{title:"Household size",info:"<p>From Census 2021 data - <a href='https://explore.nisra.gov.uk/area-explorer-2021/'><strong>Census Area Explorer</strong></a></p>The number of usual residents in the household.      <a href='https://www.nisra.gov.uk/publications/census-2021-statistical-bulletins'><strong>Statistical bulletins</strong></a>"},religion:{title:"Religion, Religion brought up in",info:"<p>From Census 2021 data - <a href='https://explore.nisra.gov.uk/area-explorer-2021/'><strong>Census Area Explorer</strong></a></p>The religious group the person belongs to or for people with no current religion their religious group of upbringing.People with no current religion and no religion of upbringing are labelled 'None'.<a href='https://www.nisra.gov.uk/publications/census-2021-statistical-bulletins'><strong>Statistical bulletins</strong></a>"},language:{title:"Main language",info:"<p>From Census 2021 data - <a href='https://explore.nisra.gov.uk/area-explorer-2021/'><strong>Census Area Explorer</strong></a></p>Person's main language as declared in the Census.Statistics for all language questions are restrictedto persons aged 3 and over. <ahref='https://www.nisra.gov.uk/publications/census-2021-statistical-bulletins'><strong>Statistical bulletins</strong></a>"},households:{title:"Households - box with numbers",info:"<p>From Census 2021 data - <a href='https://explore.nisra.gov.uk/area-explorer-2021/'><strong>Census Area Explorer</strong></a></p>A household is either one person living alone or a group of people living at the same address who share cooking facilities and share a living room, sitting room or dining area. <a href='https://www.nisra.gov.uk/publications/census-2021-statistical-bulletins'><strong>Statistical bulletins</strong></a>"}};return u.$$set=T=>{"id"in T&&d(0,p=T.id),"place"in T&&d(2,y=T.place)},[p,a,y]}class l1 extends fn{constructor(h){super(),dn(this,h,s1,o1,mn,{id:0,place:2})}}function u1(u){let h;return{c(){h=qe("h3"),this.h()},l(d){h=je(d,"H3",{style:!0});var p=Ue(h);p.forEach(ae),this.h()},h(){Xe(h,"margin","0 0 10px 0"),Xe(h,"line-height","1.78")},m(d,p){Le(d,h,p),h.innerHTML=u[9]},p(d,p){p&512&&(h.innerHTML=d[9])},i:si,o:si,d(d){d&&ae(h)}}}function c1(u){let h,d;return h=new l1({props:{id:u[1],place:u[3]}}),{c(){er(h.$$.fragment)},l(p){tr(h.$$.fragment,p)},m(p,y){rr(h,p,y),d=!0},p(p,y){const _={};y&2&&(_.id=p[1]),y&8&&(_.place=p[3]),h.$set(_)},i(p){d||(Qe(h.$$.fragment,p),d=!0)},o(p){ut(h.$$.fragment,p),d=!1},d(p){ir(h,p)}}}function Nm(u){let h,d;return{c(){h=qe("div"),d=Ot(u[12]),this.h()},l(p){h=je(p,"DIV",{class:!0});var y=Ue(h);d=Ft(y,u[12]),y.forEach(ae),this.h()},h(){oe(h,"class","text-small")},m(p,y){Le(p,h,y),Ie(h,d)},p(p,y){y&4096&&Tr(d,p[12])},d(p){p&&ae(h)}}}function h1(u){let h,d;return{c(){h=new Ol(!1),d=or(),this.h()},l(p){h=Fl(p,!1),d=or(),this.h()},h(){h.a=d},m(p,y){h.m(u[4],p,y),Le(p,d,y)},p(p,y){y&16&&h.p(p[4])},i:si,o:si,d(p){p&&ae(d),p&&h.d()}}}function p1(u){let h,d=u[4][u[3].type]+"",p;return{c(){h=new Ol(!1),p=or(),this.h()},l(y){h=Fl(y,!1),p=or(),this.h()},h(){h.a=p},m(y,_){h.m(d,y,_),Le(y,p,_)},p(y,_){_&24&&d!==(d=y[4][y[3].type]+"")&&h.p(d)},i:si,o:si,d(y){y&&ae(p),y&&h.d()}}}function f1(u){let h,d,p,y,_,a,T;const E=[x1,b1,v1,_1],D=[];function F(L,R){return R&1056&&(h=null),R&1056&&(d=null),R&1056&&(p=null),h==null&&(h=!!(L[5].hasOwnProperty("none")&L[10]==null)),h?0:(d==null&&(d=!!(L[5].hasOwnProperty("prev")&L[10]=="prev")),d?1:(p==null&&(p=!!(L[5].hasOwnProperty("ni")&L[10]=="ni")),p?2:3))}return y=F(u,-1),_=D[y]=E[y](u),{c(){_.c(),a=or()},l(L){_.l(L),a=or()},m(L,R){D[y].m(L,R),Le(L,a,R),T=!0},p(L,R){let X=y;y=F(L,R),y===X?D[y].p(L,R):(En(),ut(D[X],1,1,()=>{D[X]=null}),zn(),_=D[y],_?_.p(L,R):(_=D[y]=E[y](L),_.c()),Qe(_,1),_.m(a.parentNode,a))},i(L){T||(Qe(_),T=!0)},o(L){ut(_),T=!1},d(L){D[y].d(L),L&&ae(a)}}}function d1(u){let h,d,p,y,_,a,T;const E=[E1,k1,S1,w1],D=[];function F(L,R){return R&1056&&(h=null),R&1056&&(d=null),R&1056&&(p=null),h==null&&(h=!!(L[5].hasOwnProperty("none")&L[10]==null)),h?0:(d==null&&(d=!!(L[5].hasOwnProperty("prev")&L[10]=="prev")),d?1:(p==null&&(p=!!(L[5].hasOwnProperty("ni")&L[10]=="ni")),p?2:3))}return y=F(u,-1),_=D[y]=E[y](u),{c(){_.c(),a=or()},l(L){_.l(L),a=or()},m(L,R){D[y].m(L,R),Le(L,a,R),T=!0},p(L,R){let X=y;y=F(L,R),y===X?D[y].p(L,R):(En(),ut(D[X],1,1,()=>{D[X]=null}),zn(),_=D[y],_?_.p(L,R):(_=D[y]=E[y](L),_.c()),Qe(_,1),_.m(a.parentNode,a))},i(L){T||(Qe(_),T=!0)},o(L){ut(_),T=!1},d(L){D[y].d(L),L&&ae(a)}}}function m1(u){let h,d,p,y,_,a,T;const E=[A1,I1,T1,z1],D=[];function F(L,R){return R&1056&&(h=null),R&1056&&(d=null),R&1056&&(p=null),h==null&&(h=!!(L[5].hasOwnProperty("none")&L[10]==null)),h?0:(d==null&&(d=!!(L[5].hasOwnProperty("prev")&L[10]=="prev")),d?1:(p==null&&(p=!!(L[5].hasOwnProperty("ni")&L[10]=="ni")),p?2:3))}return y=F(u,-1),_=D[y]=E[y](u),{c(){_.c(),a=or()},l(L){_.l(L),a=or()},m(L,R){D[y].m(L,R),Le(L,a,R),T=!0},p(L,R){let X=y;y=F(L,R),y===X?D[y].p(L,R):(En(),ut(D[X],1,1,()=>{D[X]=null}),zn(),_=D[y],_?_.p(L,R):(_=D[y]=E[y](L),_.c()),Qe(_,1),_.m(a.parentNode,a))},i(L){T||(Qe(_),T=!0)},o(L){ut(_),T=!1},d(L){D[y].d(L),L&&ae(a)}}}function y1(u){let h,d,p,y,_,a,T;const E=[D1,M1,C1,P1],D=[];function F(L,R){return R&1056&&(h=null),R&1056&&(d=null),R&1056&&(p=null),h==null&&(h=!!(L[5].hasOwnProperty("none")&L[10]==null)),h?0:(d==null&&(d=!!(L[5].hasOwnProperty("prev")&L[10]=="prev")),d?1:(p==null&&(p=!!(L[5].hasOwnProperty("ni")&L[10]=="ni")),p?2:3))}return y=F(u,-1),_=D[y]=E[y](u),{c(){_.c(),a=or()},l(L){_.l(L),a=or()},m(L,R){D[y].m(L,R),Le(L,a,R),T=!0},p(L,R){let X=y;y=F(L,R),y===X?D[y].p(L,R):(En(),ut(D[X],1,1,()=>{D[X]=null}),zn(),_=D[y],_?_.p(L,R):(_=D[y]=E[y](L),_.c()),Qe(_,1),_.m(a.parentNode,a))},i(L){T||(Qe(_),T=!0)},o(L){ut(_),T=!1},d(L){D[y].d(L),L&&ae(a)}}}function g1(u){let h,d,p,y,_,a,T;const E=[O1,B1,R1,L1],D=[];function F(L,R){return R&1056&&(h=null),R&1056&&(d=null),R&1056&&(p=null),h==null&&(h=!!(L[5].hasOwnProperty("none")&L[10]==null)),h?0:(d==null&&(d=!!(L[5].hasOwnProperty("prev")&L[10]=="prev")),d?1:(p==null&&(p=!!(L[5].hasOwnProperty("ni")&L[10]=="ni")),p?2:3))}return y=F(u,-1),_=D[y]=E[y](u),{c(){_.c(),a=or()},l(L){_.l(L),a=or()},m(L,R){D[y].m(L,R),Le(L,a,R),T=!0},p(L,R){let X=y;y=F(L,R),y===X?D[y].p(L,R):(En(),ut(D[X],1,1,()=>{D[X]=null}),zn(),_=D[y],_?_.p(L,R):(_=D[y]=E[y](L),_.c()),Qe(_,1),_.m(a.parentNode,a))},i(L){T||(Qe(_),T=!0)},o(L){ut(_),T=!1},d(L){D[y].d(L),L&&ae(a)}}}function _1(u){let h,d;return h=new Rh({props:{data:u[5],zKey:u[6]}}),{c(){er(h.$$.fragment)},l(p){tr(h.$$.fragment,p)},m(p,y){rr(h,p,y),d=!0},p(p,y){const _={};y&32&&(_.data=p[5]),y&64&&(_.zKey=p[6]),h.$set(_)},i(p){d||(Qe(h.$$.fragment,p),d=!0)},o(p){ut(h.$$.fragment,p),d=!1},d(p){ir(h,p)}}}function v1(u){let h,d;return h=new Rh({props:{data:u[5].ni,zKey:u[6]}}),{c(){er(h.$$.fragment)},l(p){tr(h.$$.fragment,p)},m(p,y){rr(h,p,y),d=!0},p(p,y){const _={};y&32&&(_.data=p[5].ni),y&64&&(_.zKey=p[6]),h.$set(_)},i(p){d||(Qe(h.$$.fragment,p),d=!0)},o(p){ut(h.$$.fragment,p),d=!1},d(p){ir(h,p)}}}function b1(u){let h,d;return h=new Rh({props:{data:u[5].prev,zKey:u[6]}}),{c(){er(h.$$.fragment)},l(p){tr(h.$$.fragment,p)},m(p,y){rr(h,p,y),d=!0},p(p,y){const _={};y&32&&(_.data=p[5].prev),y&64&&(_.zKey=p[6]),h.$set(_)},i(p){d||(Qe(h.$$.fragment,p),d=!0)},o(p){ut(h.$$.fragment,p),d=!1},d(p){ir(h,p)}}}function x1(u){let h,d;return h=new Rh({props:{data:u[5].none,zKey:u[6]}}),{c(){er(h.$$.fragment)},l(p){tr(h.$$.fragment,p)},m(p,y){rr(h,p,y),d=!0},p(p,y){const _={};y&32&&(_.data=p[5].none),y&64&&(_.zKey=p[6]),h.$set(_)},i(p){d||(Qe(h.$$.fragment,p),d=!0)},o(p){ut(h.$$.fragment,p),d=!1},d(p){ir(h,p)}}}function w1(u){let h,d;return h=new Fh({props:{data:u[5],zKey:u[6],label:u[7]}}),{c(){er(h.$$.fragment)},l(p){tr(h.$$.fragment,p)},m(p,y){rr(h,p,y),d=!0},p(p,y){const _={};y&32&&(_.data=p[5]),y&64&&(_.zKey=p[6]),y&128&&(_.label=p[7]),h.$set(_)},i(p){d||(Qe(h.$$.fragment,p),d=!0)},o(p){ut(h.$$.fragment,p),d=!1},d(p){ir(h,p)}}}function S1(u){let h,d;return h=new Fh({props:{data:u[5].ni,zKey:u[6],label:u[7]}}),{c(){er(h.$$.fragment)},l(p){tr(h.$$.fragment,p)},m(p,y){rr(h,p,y),d=!0},p(p,y){const _={};y&32&&(_.data=p[5].ni),y&64&&(_.zKey=p[6]),y&128&&(_.label=p[7]),h.$set(_)},i(p){d||(Qe(h.$$.fragment,p),d=!0)},o(p){ut(h.$$.fragment,p),d=!1},d(p){ir(h,p)}}}function k1(u){let h,d;return h=new Fh({props:{data:u[5].prev,zKey:u[6],label:u[7]}}),{c(){er(h.$$.fragment)},l(p){tr(h.$$.fragment,p)},m(p,y){rr(h,p,y),d=!0},p(p,y){const _={};y&32&&(_.data=p[5].prev),y&64&&(_.zKey=p[6]),y&128&&(_.label=p[7]),h.$set(_)},i(p){d||(Qe(h.$$.fragment,p),d=!0)},o(p){ut(h.$$.fragment,p),d=!1},d(p){ir(h,p)}}}function E1(u){let h,d;return h=new Fh({props:{data:u[5].none,zKey:u[6],label:u[7]}}),{c(){er(h.$$.fragment)},l(p){tr(h.$$.fragment,p)},m(p,y){rr(h,p,y),d=!0},p(p,y){const _={};y&32&&(_.data=p[5].none),y&64&&(_.zKey=p[6]),y&128&&(_.label=p[7]),h.$set(_)},i(p){d||(Qe(h.$$.fragment,p),d=!0)},o(p){ut(h.$$.fragment,p),d=!1},d(p){ir(h,p)}}}function z1(u){let h,d;return h=new Nh({props:{data:u[5],zKey:u[6],label:u[7]}}),{c(){er(h.$$.fragment)},l(p){tr(h.$$.fragment,p)},m(p,y){rr(h,p,y),d=!0},p(p,y){const _={};y&32&&(_.data=p[5]),y&64&&(_.zKey=p[6]),y&128&&(_.label=p[7]),h.$set(_)},i(p){d||(Qe(h.$$.fragment,p),d=!0)},o(p){ut(h.$$.fragment,p),d=!1},d(p){ir(h,p)}}}function T1(u){let h,d;return h=new Nh({props:{data:u[5].ni,zKey:u[6],label:u[7]}}),{c(){er(h.$$.fragment)},l(p){tr(h.$$.fragment,p)},m(p,y){rr(h,p,y),d=!0},p(p,y){const _={};y&32&&(_.data=p[5].ni),y&64&&(_.zKey=p[6]),y&128&&(_.label=p[7]),h.$set(_)},i(p){d||(Qe(h.$$.fragment,p),d=!0)},o(p){ut(h.$$.fragment,p),d=!1},d(p){ir(h,p)}}}function I1(u){let h,d;return h=new Nh({props:{data:u[5].prev,zKey:u[6],label:u[7]}}),{c(){er(h.$$.fragment)},l(p){tr(h.$$.fragment,p)},m(p,y){rr(h,p,y),d=!0},p(p,y){const _={};y&32&&(_.data=p[5].prev),y&64&&(_.zKey=p[6]),y&128&&(_.label=p[7]),h.$set(_)},i(p){d||(Qe(h.$$.fragment,p),d=!0)},o(p){ut(h.$$.fragment,p),d=!1},d(p){ir(h,p)}}}function A1(u){let h,d;return h=new Nh({props:{data:u[5].none,zKey:u[6],label:u[7]}}),{c(){er(h.$$.fragment)},l(p){tr(h.$$.fragment,p)},m(p,y){rr(h,p,y),d=!0},p(p,y){const _={};y&32&&(_.data=p[5].none),y&64&&(_.zKey=p[6]),y&128&&(_.label=p[7]),h.$set(_)},i(p){d||(Qe(h.$$.fragment,p),d=!0)},o(p){ut(h.$$.fragment,p),d=!1},d(p){ir(h,p)}}}function P1(u){let h,d;return h=new Oh({props:{data:u[5],zKey:"group"}}),{c(){er(h.$$.fragment)},l(p){tr(h.$$.fragment,p)},m(p,y){rr(h,p,y),d=!0},p(p,y){const _={};y&32&&(_.data=p[5]),h.$set(_)},i(p){d||(Qe(h.$$.fragment,p),d=!0)},o(p){ut(h.$$.fragment,p),d=!1},d(p){ir(h,p)}}}function C1(u){let h,d;return h=new Oh({props:{data:u[5].ni,zKey:"group"}}),{c(){er(h.$$.fragment)},l(p){tr(h.$$.fragment,p)},m(p,y){rr(h,p,y),d=!0},p(p,y){const _={};y&32&&(_.data=p[5].ni),h.$set(_)},i(p){d||(Qe(h.$$.fragment,p),d=!0)},o(p){ut(h.$$.fragment,p),d=!1},d(p){ir(h,p)}}}function M1(u){let h,d;return h=new Oh({props:{data:u[5].prev,zKey:"group"}}),{c(){er(h.$$.fragment)},l(p){tr(h.$$.fragment,p)},m(p,y){rr(h,p,y),d=!0},p(p,y){const _={};y&32&&(_.data=p[5].prev),h.$set(_)},i(p){d||(Qe(h.$$.fragment,p),d=!0)},o(p){ut(h.$$.fragment,p),d=!1},d(p){ir(h,p)}}}function D1(u){let h,d;return h=new Oh({props:{data:u[5].none,zKey:"group"}}),{c(){er(h.$$.fragment)},l(p){tr(h.$$.fragment,p)},m(p,y){rr(h,p,y),d=!0},p(p,y){const _={};y&32&&(_.data=p[5].none),h.$set(_)},i(p){d||(Qe(h.$$.fragment,p),d=!0)},o(p){ut(h.$$.fragment,p),d=!1},d(p){ir(h,p)}}}function L1(u){let h,d;return h=new Bh({props:{data:u[5],zKey:u[6],label:u[7],topic_prev_available:u[0]}}),{c(){er(h.$$.fragment)},l(p){tr(h.$$.fragment,p)},m(p,y){rr(h,p,y),d=!0},p(p,y){const _={};y&32&&(_.data=p[5]),y&64&&(_.zKey=p[6]),y&128&&(_.label=p[7]),y&1&&(_.topic_prev_available=p[0]),h.$set(_)},i(p){d||(Qe(h.$$.fragment,p),d=!0)},o(p){ut(h.$$.fragment,p),d=!1},d(p){ir(h,p)}}}function R1(u){let h,d;return h=new Bh({props:{data:u[5].ni,zKey:u[6],label:u[7],topic_prev_available:u[0]}}),{c(){er(h.$$.fragment)},l(p){tr(h.$$.fragment,p)},m(p,y){rr(h,p,y),d=!0},p(p,y){const _={};y&32&&(_.data=p[5].ni),y&64&&(_.zKey=p[6]),y&128&&(_.label=p[7]),y&1&&(_.topic_prev_available=p[0]),h.$set(_)},i(p){d||(Qe(h.$$.fragment,p),d=!0)},o(p){ut(h.$$.fragment,p),d=!1},d(p){ir(h,p)}}}function B1(u){let h,d;return h=new Bh({props:{data:u[5].prev,zKey:u[6],label:u[7],topic_prev_available:u[0]}}),{c(){er(h.$$.fragment)},l(p){tr(h.$$.fragment,p)},m(p,y){rr(h,p,y),d=!0},p(p,y){const _={};y&32&&(_.data=p[5].prev),y&64&&(_.zKey=p[6]),y&128&&(_.label=p[7]),y&1&&(_.topic_prev_available=p[0]),h.$set(_)},i(p){d||(Qe(h.$$.fragment,p),d=!0)},o(p){ut(h.$$.fragment,p),d=!1},d(p){ir(h,p)}}}function O1(u){let h,d;return h=new Bh({props:{data:u[5].none,zKey:u[6],label:u[7],topic_prev_available:u[0]}}),{c(){er(h.$$.fragment)},l(p){tr(h.$$.fragment,p)},m(p,y){rr(h,p,y),d=!0},p(p,y){const _={};y&32&&(_.data=p[5].none),y&64&&(_.zKey=p[6]),y&128&&(_.label=p[7]),y&1&&(_.topic_prev_available=p[0]),h.$set(_)},i(p){d||(Qe(h.$$.fragment,p),d=!0)},o(p){ut(h.$$.fragment,p),d=!1},d(p){ir(h,p)}}}function Um(u){let h=u[11][u[3].type].hasOwnProperty(u[10]),d,p=h&&Vm(u);return{c(){p&&p.c(),d=or()},l(y){p&&p.l(y),d=or()},m(y,_){p&&p.m(y,_),Le(y,d,_)},p(y,_){_&3080&&(h=y[11][y[3].type].hasOwnProperty(y[10])),h?p?p.p(y,_):(p=Vm(y),p.c(),p.m(d.parentNode,d)):p&&(p.d(1),p=null)},d(y){p&&p.d(y),y&&ae(d)}}}function Vm(u){let h,d,p,y=u[11][u[3].type][u[10]]+"";return{c(){h=qe("br"),d=vt(),p=qe("span"),this.h()},l(_){h=je(_,"BR",{}),d=bt(_),p=je(_,"SPAN",{class:!0});var a=Ue(p);a.forEach(ae),this.h()},h(){oe(p,"class","text-small")},m(_,a){Le(_,h,a),Le(_,d,a),Le(_,p,a),p.innerHTML=y},p(_,a){a&3080&&y!==(y=_[11][_[3].type][_[10]]+"")&&(p.innerHTML=y)},d(_){_&&ae(h),_&&ae(d),_&&ae(p)}}}function F1(u){let h,d,p,y,_,a,T,E,D,F,L,R,X,ne,pe;const ve=[c1,u1],de=[];function xe(Ke,dt){return Ke[8]?0:1}d=xe(u),p=de[d]=ve[d](u);let $e=u[12]!=null&&Nm(u);const ht=[g1,y1,m1,d1,f1,p1,h1],Pe=[];function We(Ke,dt){return dt&24&&(a=null),dt&24&&(T=null),dt&24&&(E=null),dt&24&&(D=null),dt&24&&(F=null),dt&24&&(L=null),a==null&&(a=!!(Ke[4]=="StackedBarChart"|Ke[4].hasOwnProperty(Ke[3].type)&Ke[4][Ke[3].type]=="StackedBarChart")),a?0:(T==null&&(T=!!(Ke[4]=="GroupChart"|Ke[4].hasOwnProperty(Ke[3].type)&Ke[4][Ke[3].type]=="GroupChart")),T?1:(E==null&&(E=!!(Ke[4]=="ProfileChart"|Ke[4].hasOwnProperty(Ke[3].type)&Ke[4][Ke[3].type]=="ProfileChart")),E?2:(D==null&&(D=!!(Ke[4]=="BarChart"|Ke[4].hasOwnProperty(Ke[3].type)&Ke[4][Ke[3].type]=="BarChart")),D?3:(F==null&&(F=!!(Ke[4]=="ColChart"|Ke[4].hasOwnProperty(Ke[3].type)&Ke[4][Ke[3].type]=="ColChart")),F?4:(L==null&&(L=!!Ke[4].hasOwnProperty(Ke[3].type)),L?5:6)))))}R=We(u,-1),X=Pe[R]=ht[R](u);let gt=u[11]!=null&u[10]!=null&&Um(u);return{c(){h=qe("div"),p.c(),y=vt(),$e&&$e.c(),_=vt(),X.c(),ne=vt(),gt&&gt.c(),this.h()},l(Ke){h=je(Ke,"DIV",{class:!0,style:!0});var dt=Ue(h);p.l(dt),y=bt(dt),$e&&$e.l(dt),_=bt(dt),X.l(dt),ne=bt(dt),gt&&gt.l(dt),dt.forEach(ae),this.h()},h(){oe(h,"class","div-grey-box svelte-1mdbgz6"),oe(h,"style",u[2])},m(Ke,dt){Le(Ke,h,dt),de[d].m(h,null),Ie(h,y),$e&&$e.m(h,null),Ie(h,_),Pe[R].m(h,null),Ie(h,ne),gt&&gt.m(h,null),pe=!0},p(Ke,[dt]){let Ne=d;d=xe(Ke),d===Ne?de[d].p(Ke,dt):(En(),ut(de[Ne],1,1,()=>{de[Ne]=null}),zn(),p=de[d],p?p.p(Ke,dt):(p=de[d]=ve[d](Ke),p.c()),Qe(p,1),p.m(h,y)),Ke[12]!=null?$e?$e.p(Ke,dt):($e=Nm(Ke),$e.c(),$e.m(h,_)):$e&&($e.d(1),$e=null);let at=R;R=We(Ke,dt),R===at?Pe[R].p(Ke,dt):(En(),ut(Pe[at],1,1,()=>{Pe[at]=null}),zn(),X=Pe[R],X?X.p(Ke,dt):(X=Pe[R]=ht[R](Ke),X.c()),Qe(X,1),X.m(h,ne)),Ke[11]!=null&Ke[10]!=null?gt?gt.p(Ke,dt):(gt=Um(Ke),gt.c(),gt.m(h,null)):gt&&(gt.d(1),gt=null),(!pe||dt&4)&&oe(h,"style",Ke[2])},i(Ke){pe||(Qe(p),Qe(X),pe=!0)},o(Ke){ut(p),ut(X),pe=!1},d(Ke){Ke&&ae(h),de[d].d(),$e&&$e.d(),Pe[R].d(),gt&&gt.d()}}}function N1(u,h,d){let{id:p}=h,{style:y=""}=h,{place:_}=h,{content:a}=h,{chart_data:T=null}=h,{zKey:E="ni"}=h,{label:D=null}=h,{topic_prev_available:F=null}=h,{topic_boolean:L=null}=h,{i_button:R=!0}=h,{heading:X=null}=h,{chart_compare_type:ne}=h,{compare_content:pe=null}=h,{year:ve=null}=h;return F=="false"?L=!1:L=!0,u.$$set=de=>{"id"in de&&d(1,p=de.id),"style"in de&&d(2,y=de.style),"place"in de&&d(3,_=de.place),"content"in de&&d(4,a=de.content),"chart_data"in de&&d(5,T=de.chart_data),"zKey"in de&&d(6,E=de.zKey),"label"in de&&d(7,D=de.label),"topic_prev_available"in de&&d(13,F=de.topic_prev_available),"topic_boolean"in de&&d(0,L=de.topic_boolean),"i_button"in de&&d(8,R=de.i_button),"heading"in de&&d(9,X=de.heading),"chart_compare_type"in de&&d(10,ne=de.chart_compare_type),"compare_content"in de&&d(11,pe=de.compare_content),"year"in de&&d(12,ve=de.year)},[L,p,y,_,a,T,E,D,R,X,ne,pe,ve,F]}class Ou extends fn{constructor(h){super(),dn(this,h,N1,F1,mn,{id:1,style:2,place:3,content:4,chart_data:5,zKey:6,label:7,topic_prev_available:13,topic_boolean:0,i_button:8,heading:9,chart_compare_type:10,compare_content:11,year:12})}}function qm(u,h,d){const p=u.slice();return p[13]=h[d],p[15]=d,p}function jm(u){let h=u[6][u[10][u[15]]].show.includes(u[3].type),d,p,y=h&&Zm(u);return{c(){y&&y.c(),d=or()},l(_){y&&y.l(_),d=or()},m(_,a){y&&y.m(_,a),Le(_,d,a),p=!0},p(_,a){a&72&&(h=_[6][_[10][_[15]]].show.includes(_[3].type)),h?y?(y.p(_,a),a&72&&Qe(y,1)):(y=Zm(_),y.c(),Qe(y,1),y.m(d.parentNode,d)):y&&(En(),ut(y,1,1,()=>{y=null}),zn())},i(_){p||(Qe(y),p=!0)},o(_){ut(y),p=!1},d(_){y&&y.d(_),_&&ae(d)}}}function Zm(u){let h,d;return h=new Ou({props:{id:u[6][u[10][u[15]]].id,style:u[6][u[10][u[15]]].style,place:u[3],year:u[6][u[10][u[15]]].year,content:u[6][u[10][u[15]]].content,chart_data:u[6][u[10][u[15]]].chart_data,zKey:u[6][u[10][u[15]]].zKey,label:u[6][u[10][u[15]]].label,topic_prev_available:u[6][u[10][u[15]]].topic_prev_available,chart_compare_type:u[8]}}),{c(){er(h.$$.fragment)},l(p){tr(h.$$.fragment,p)},m(p,y){rr(h,p,y),d=!0},p(p,y){const _={};y&64&&(_.id=p[6][p[10][p[15]]].id),y&64&&(_.style=p[6][p[10][p[15]]].style),y&8&&(_.place=p[3]),y&64&&(_.year=p[6][p[10][p[15]]].year),y&64&&(_.content=p[6][p[10][p[15]]].content),y&64&&(_.chart_data=p[6][p[10][p[15]]].chart_data),y&64&&(_.zKey=p[6][p[10][p[15]]].zKey),y&64&&(_.label=p[6][p[10][p[15]]].label),y&64&&(_.topic_prev_available=p[6][p[10][p[15]]].topic_prev_available),y&256&&(_.chart_compare_type=p[8]),h.$set(_)},i(p){d||(Qe(h.$$.fragment,p),d=!0)},o(p){ut(h.$$.fragment,p),d=!1},d(p){ir(h,p)}}}function Gm(u){let h,d;return h=new Ou({props:{id:u[6][u[10][u[15]]].id,style:u[6][u[10][u[15]]].style,place:u[3],year:u[6][u[10][u[15]]].year,content:u[6][u[10][u[15]]].content,chart_data:u[6][u[10][u[15]]].chart_data,zKey:u[6][u[10][u[15]]].zKey,label:u[6][u[10][u[15]]].label,topic_prev_available:u[6][u[10][u[15]]].topic_prev_available,chart_compare_type:u[8]}}),{c(){er(h.$$.fragment)},l(p){tr(h.$$.fragment,p)},m(p,y){rr(h,p,y),d=!0},p(p,y){const _={};y&64&&(_.id=p[6][p[10][p[15]]].id),y&64&&(_.style=p[6][p[10][p[15]]].style),y&8&&(_.place=p[3]),y&64&&(_.year=p[6][p[10][p[15]]].year),y&64&&(_.content=p[6][p[10][p[15]]].content),y&64&&(_.chart_data=p[6][p[10][p[15]]].chart_data),y&64&&(_.zKey=p[6][p[10][p[15]]].zKey),y&64&&(_.label=p[6][p[10][p[15]]].label),y&64&&(_.topic_prev_available=p[6][p[10][p[15]]].topic_prev_available),y&256&&(_.chart_compare_type=p[8]),h.$set(_)},i(p){d||(Qe(h.$$.fragment,p),d=!0)},o(p){ut(h.$$.fragment,p),d=!1},d(p){ir(h,p)}}}function Km(u){let h=u[6][u[10][u[15]]].hasOwnProperty("show"),d,p=!u[6][u[10][u[15]]].hasOwnProperty("show"),y,_,a=h&&jm(u),T=p&&Gm(u);return{c(){a&&a.c(),d=vt(),T&&T.c(),y=or()},l(E){a&&a.l(E),d=bt(E),T&&T.l(E),y=or()},m(E,D){a&&a.m(E,D),Le(E,d,D),T&&T.m(E,D),Le(E,y,D),_=!0},p(E,D){D&64&&(h=E[6][E[10][E[15]]].hasOwnProperty("show")),h?a?(a.p(E,D),D&64&&Qe(a,1)):(a=jm(E),a.c(),Qe(a,1),a.m(d.parentNode,d)):a&&(En(),ut(a,1,1,()=>{a=null}),zn()),D&64&&(p=!E[6][E[10][E[15]]].hasOwnProperty("show")),p?T?(T.p(E,D),D&64&&Qe(T,1)):(T=Gm(E),T.c(),Qe(T,1),T.m(y.parentNode,y)):T&&(En(),ut(T,1,1,()=>{T=null}),zn())},i(E){_||(Qe(a),Qe(T),_=!0)},o(E){ut(a),ut(T),_=!1},d(E){a&&a.d(E),E&&ae(d),T&&T.d(E),E&&ae(y)}}}function Hm(u){let h,d,p,y;return{c(){h=qe("h3"),d=Ot("More Statistics"),p=vt(),y=qe("div"),this.h()},l(_){h=je(_,"H3",{});var a=Ue(h);d=Ft(a,"More Statistics"),a.forEach(ae),p=bt(_),y=je(_,"DIV",{class:!0});var T=Ue(y);T.forEach(ae),this.h()},h(){oe(y,"class","accordion-more svelte-1jaw0n6")},m(_,a){Le(_,h,a),Ie(h,d),Le(_,p,a),Le(_,y,a),y.innerHTML=u[7]},p(_,a){a&128&&(y.innerHTML=_[7])},d(_){_&&ae(h),_&&ae(p),_&&ae(y)}}}function U1(u){let h,d,p,y,_,a,T,E,D,F,L,R,X,ne,pe=u[3].name+"",ve,de,xe=u[3].type.toLocaleUpperCase()+"",$e,ht,Pe,We,gt,Ke,dt,Ne,at,Vt,st,At,Fe,qt={length:u[10].length},St=[];for(let xt=0;xt<qt.length;xt+=1)St[xt]=Km(qm(u,qt,xt));const Ir=xt=>ut(St[xt],1,1,()=>{St[xt]=null});let _t=u[7]!=""&&Hm(u);return{c(){h=qe("div"),d=qe("h2"),p=qe("button"),y=qe("span"),_=qe("img"),T=vt(),E=Ot(u[2]),R=vt(),X=qe("div"),ne=qe("div"),ve=Ot(pe),de=vt(),$e=Ot(xe),ht=Ot(" - "),Pe=new Ol(!1),We=vt(),gt=qe("span"),Ke=Ot(u[5]),dt=vt(),Ne=qe("div");for(let xt=0;xt<St.length;xt+=1)St[xt].c();Vt=vt(),_t&&_t.c(),this.h()},l(xt){h=je(xt,"DIV",{class:!0});var Re=Ue(h);d=je(Re,"H2",{class:!0,id:!0});var Dt=Ue(d);p=je(Dt,"BUTTON",{class:!0,type:!0,"data-bs-toggle":!0,"data-bs-target":!0,"aria-expanded":!0,"aria-controls":!0});var Rr=Ue(p);y=je(Rr,"SPAN",{class:!0});var xr=Ue(y);_=je(xr,"IMG",{src:!0,alt:!0,height:!0,class:!0}),T=bt(xr),E=Ft(xr,u[2]),xr.forEach(ae),Rr.forEach(ae),Dt.forEach(ae),R=bt(Re),X=je(Re,"DIV",{id:!0,class:!0,"aria-labelledby":!0});var Vr=Ue(X);ne=je(Vr,"DIV",{class:!0});var Br=Ue(ne);ve=Ft(Br,pe),de=bt(Br),$e=Ft(Br,xe),ht=Ft(Br," - "),Pe=Fl(Br,!1),We=bt(Br),gt=je(Br,"SPAN",{class:!0});var fr=Ue(gt);Ke=Ft(fr,u[5]),fr.forEach(ae),dt=bt(Br),Ne=je(Br,"DIV",{class:!0});var yi=Ue(Ne);for(let Jt=0;Jt<St.length;Jt+=1)St[Jt].l(yi);yi.forEach(ae),Vt=bt(Br),_t&&_t.l(Br),Br.forEach(ae),Vr.forEach(ae),Re.forEach(ae),this.h()},h(){wd(_.src,a=Na+"/img/"+u[1])||oe(_,"src",a),oe(_,"alt","logo"),oe(_,"height","40"),oe(_,"class","accordion-dept-logo"),oe(y,"class","accordion-button-title"),oe(p,"class","accordion-button collapsed"),oe(p,"type","button"),oe(p,"data-bs-toggle","collapse"),oe(p,"data-bs-target",D="#panelsStayOpen-collapse"+u[0]),oe(p,"aria-expanded","false"),oe(p,"aria-controls",F="panelsStayOpen-collapse"+u[0]),oe(d,"class","accordion-header"),oe(d,"id",L="panelsStayOpen-heading"+u[0]),Pe.a=We,oe(gt,"class","accordion-button-title-sub"),oe(Ne,"class","grid mt svelte-1jaw0n6"),Ku(()=>u[11].call(Ne)),oe(ne,"class","accordion-body"),oe(X,"id",st="panelsStayOpen-collapse"+u[0]),oe(X,"class","accordion-collapse collapse"),oe(X,"aria-labelledby",At="panelsStayOpen-heading"+u[0]),oe(h,"class","accordion-item")},m(xt,Re){Le(xt,h,Re),Ie(h,d),Ie(d,p),Ie(p,y),Ie(y,_),Ie(y,T),Ie(y,E),Ie(h,R),Ie(h,X),Ie(X,ne),Ie(ne,ve),Ie(ne,de),Ie(ne,$e),Ie(ne,ht),Pe.m(u[4],ne),Ie(ne,We),Ie(ne,gt),Ie(gt,Ke),Ie(ne,dt),Ie(ne,Ne);for(let Dt=0;Dt<St.length;Dt+=1)St[Dt]&&St[Dt].m(Ne,null);at=Hu(Ne,u[11].bind(Ne)),Ie(ne,Vt),_t&&_t.m(ne,null),Fe=!0},p(xt,[Re]){if((!Fe||Re&2&&!wd(_.src,a=Na+"/img/"+xt[1]))&&oe(_,"src",a),(!Fe||Re&4)&&Tr(E,xt[2]),(!Fe||Re&1&&D!==(D="#panelsStayOpen-collapse"+xt[0]))&&oe(p,"data-bs-target",D),(!Fe||Re&1&&F!==(F="panelsStayOpen-collapse"+xt[0]))&&oe(p,"aria-controls",F),(!Fe||Re&1&&L!==(L="panelsStayOpen-heading"+xt[0]))&&oe(d,"id",L),(!Fe||Re&8)&&pe!==(pe=xt[3].name+"")&&Tr(ve,pe),(!Fe||Re&8)&&xe!==(xe=xt[3].type.toLocaleUpperCase()+"")&&Tr($e,xe),(!Fe||Re&16)&&Pe.p(xt[4]),(!Fe||Re&32)&&Tr(Ke,xt[5]),Re&1352){qt={length:xt[10].length};let Dt;for(Dt=0;Dt<qt.length;Dt+=1){const Rr=qm(xt,qt,Dt);St[Dt]?(St[Dt].p(Rr,Re),Qe(St[Dt],1)):(St[Dt]=Km(Rr),St[Dt].c(),Qe(St[Dt],1),St[Dt].m(Ne,null))}for(En(),Dt=qt.length;Dt<St.length;Dt+=1)Ir(Dt);zn()}xt[7]!=""?_t?_t.p(xt,Re):(_t=Hm(xt),_t.c(),_t.m(ne,null)):_t&&(_t.d(1),_t=null),(!Fe||Re&1&&st!==(st="panelsStayOpen-collapse"+xt[0]))&&oe(X,"id",st),(!Fe||Re&1&&At!==(At="panelsStayOpen-heading"+xt[0]))&&oe(X,"aria-labelledby",At)},i(xt){if(!Fe){for(let Re=0;Re<qt.length;Re+=1)Qe(St[Re]);Fe=!0}},o(xt){St=St.filter(Boolean);for(let Re=0;Re<St.length;Re+=1)ut(St[Re]);Fe=!1},d(xt){xt&&ae(h),tn(St,xt),at(),_t&&_t.d()}}}function V1(u,h,d){let{id:p}=h,{img:y}=h,{heading:_}=h,{place:a}=h,{sub_heading:T}=h,{description:E}=h,{boxes:D}=h,{more:F}=h,{chart_compare_type:L}=h,R=Object.keys(D),X;function ne(){X=this.clientWidth,d(9,X)}return u.$$set=pe=>{"id"in pe&&d(0,p=pe.id),"img"in pe&&d(1,y=pe.img),"heading"in pe&&d(2,_=pe.heading),"place"in pe&&d(3,a=pe.place),"sub_heading"in pe&&d(4,T=pe.sub_heading),"description"in pe&&d(5,E=pe.description),"boxes"in pe&&d(6,D=pe.boxes),"more"in pe&&d(7,F=pe.more),"chart_compare_type"in pe&&d(8,L=pe.chart_compare_type)},[p,y,_,a,T,E,D,F,L,X,R,ne]}class Dl extends fn{constructor(h){super(),dn(this,h,V1,U1,mn,{id:0,img:1,heading:2,place:3,sub_heading:4,description:5,boxes:6,more:7,chart_compare_type:8})}}function Xm(u,h,d){const p=u.slice();return p[25]=h[d],p[27]=d,p}function Wm(u,h,d){const p=u.slice();return p[28]=h[d],p[27]=d,p}function Ym(u,h,d){const p=u.slice();return p[30]=h[d],p}function Jm(u,h,d){const p=u.slice();return p[28]=h[d],p[27]=d,p}function Qm(u){let h,d,p,y,_,a,T=" &gt; ",E,D,F,L,R,X=u[0].place.name+"",ne,pe,ve,de,xe,$e,ht,Pe,We,gt,Ke,dt,Ne,at,Vt,st,At,Fe,qt,St,Ir,_t,xt,Re,Dt,Rr,xr,Vr,Br,fr,yi,Jt,rn,Mi,$r,Gt,yn,Yr,li,nn,Ui,an,yr,ui,on,qr,ci,hi,gi,Di,Wn,Vi,Ln,Li,Ji;function Rn(te,P){return te[0].place.type!="ni"?j1:q1}let Tn=Rn(u),ei=Tn(u);Pe=new s_({props:{search_data:u[0].search_data,group:"typestr",search:!0}}),Pe.$on("select",u[11]),Re=new Ou({props:{id:"overview",i_button:!1,heading:"About "+u[0].place.name,place:u[0].place,style:"line-height: 1.3;",content:{ni:"Northern Ireland has 11 Local Government Districts (LGDs),  which can be subdivided into District Electoral Areas (DEAs), then further into Super Data Zones and Data Zones. Statistics can be viewed for these smaller areas.",lgd:u[0].place.name+" is one of "+u[0].place.count.toLocaleString()+" "+Kn[u[0].place.type].pl+".",dea:u[0].place.name+" is one of "+u[0].place.count.toLocaleString()+" "+Kn[u[0].place.type].pl+"in Northern Ireland.  It is within <a href = '/"+u[0].place.parents[0].code+"/' data-sveltekit-noscroll>"+u[0].place.parents[0].name+" </a> and covers "+u[0].place.dea_location_description+".",sdz:u[0].place.name+" is one of "+u[0].place.count.toLocaleString()+" "+Kn[u[0].place.type].pl,dz:u[0].place.name+" is one of "+u[0].place.count.toLocaleString()+" "+Kn[u[0].place.type].pl},chart_compare_type:u[6]}}),Rr=new Ou({props:{id:"pop",place:u[0].place,year:zr("MYETotal",u[0].place),content:'<span class="text-big" style="font-size: 2.8em;">'+(Math.round(u[0].place.data.MYETotal.value/1e3)*1e3).toLocaleString()+"</span>",chart_compare_type:u[6],compare_content:{ni:{prev:'<span class="em '+ts(u[0].place.data.population.value.change.all)+'">'+rs(u[0].place.data.population.value.change.all,"%",1)+"</span> since 2011 Census"},lgd:{prev:'<span class="em '+ts(u[0].place.data.population.value.change.all)+'">'+rs(u[0].place.data.population.value.change.all,"%",1)+"</span> since 2011 Census",ni:'<span class = "em" style = "background-color: lightgrey">'+gh(u[0].place.data.population.value[2021].all/u[0].ni.data.population.value[2021].all)+"</span> of Northern Ireland population<br>The "+u[12](u[0].place.data.population.value_rank[2021].all)+" population of 11 Local Government Districts"},dea:{ni:'<span class = "em" style = "background-color: lightgrey">'+gh(u[0].place.data.population.value[2021].all/u[0].ni.data.population.value[2021].all)+"</span> of Northern Ireland population"},sdz:{prev:" nothing further",ni:" nothing further"},dz:{prev:" no comparisons",ni:" nothing further"}}}}),Vr=new Ou({props:{id:"popden",place:u[0].place,year:u[14]("population"),content:'<span class="text-big" style="font-size: 2.8em;">'+ny(u[0].place)+"</span> people per hectare",chart_compare_type:u[6],compare_content:{ni:{prev:'<span class="em '+ts(u[0].place.data.households.value.change.all_households)+'">'+rs(u[0].place.data.households.value.change.all_households,"%",1)+"</span> since 2011 Census"},lgd:{prev:'<span class="em '+ts(u[0].place.data.households.value.change.all_households)+'">'+rs(u[0].place.data.households.value.change.all_households,"%",1)+"</span> since 2011 Census",ni:u[15](u[0].place)},dea:{ni:u[15](u[0].place)},sdz:{prev:" nothing further",ni:u[15](u[0].place)},dz:{prev:" no comparisons",ni:u[15](u[0].place)}}}});function Yn(te,P){return te[0].place.type!="ni"?G1:Z1}let In=Yn(u),wi=In(u);function ca(te){u[17](te)}let An={location:{bounds:u[0].place.bounds},options:{fitBoundsOptions:{padding:20}},style:l_,$$slots:{default:[H1]},$$scope:{ctx:u}};u[3]!==void 0&&(An.map=u[3]),$r=new W_({props:An}),qu.push(()=>p_($r,"map",ca));let Mr=u[0].place.type!="ni"&&ty(u);function sn(te,P){return te[0].place.children[0]?W1:X1}let gn=sn(u),ti=gn(u);return ui=new Dl({props:{id:"people",img:"nisra-taxonomy-icon-census.png",heading:"People and Households",place:u[0].place,sub_heading:Pa("People and Households",u[0].place),description:"",chart_compare_type:u[6],boxes:{box_1:{id:"popchange",content:"<span > population growth/shrink to be added</span> "},box_2:{id:"age",year:u[14]("age"),content:"GroupChart",chart_data:{none:u[9](u[0].place.grouped_data_nocompare.age,"age"),prev:u[9](u[0].place.grouped_data_timecompare.age,"age"),ni:u[9](u[0].place.grouped_data_areacompare.age,"age")},topic_prev_available:"true"},box_4:{id:"hhsize",year:u[14]("hh_size"),content:"GroupChart",chart_data:{none:u[9](u[0].place.grouped_data_nocompare.hh_size,"hh_size"),prev:u[9](u[0].place.grouped_data_timecompare.hh_size,"hh_size"),ni:u[9](u[0].place.grouped_data_areacompare.hh_size,"hh_size")},topic_prev_available:"true"},box_5:{id:"religion",year:u[14]("religion_or_religion_brought_up_in"),content:"GroupChart",chart_data:{none:u[9](u[0].place.grouped_data_nocompare.religion_or_religion_brought_up_in,"religion_or_religion_brought_up_in"),prev:u[9](u[0].place.grouped_data_timecompare.religion_or_religion_brought_up_in,"religion_or_religion_brought_up_in"),ni:u[9](u[0].place.grouped_data_areacompare.religion_or_religion_brought_up_in,"religion_or_religion_brought_up_in")},topic_prev_available:"true"},box_6:{id:"language",year:u[14]("mainlang"),content:"GroupChart",chart_data:{none:u[9](u[0].place.grouped_data_nocompare.mainlang,"mainlang"),prev:u[9](u[0].place.grouped_data_timecompare.mainlang,"mainlang"),ni:u[9](u[0].place.grouped_data_areacompare.mainlang,"mainlang")},topic_prev_available:"true"}},more:`More information on the size of the population is available in the latest <a href='https://www.nisra.gov.uk/publications/2022-mid-year-population-estimates-northern-ireland'>mid-year estimates release</a>, \r
					which includes an <a href='https://www.nisra.gov.uk/system/files/statistics/MYE22-summary.pdf'>infographic</a>, \r
					<a href='https://www.nisra.gov.uk/system/files/statistics/MYE22-Factsheets.pdf'>Fact Sheets</a>, \r
					a <a href='https://www.nisra.gov.uk/system/files/statistics/Statistical%20Bulletin%20-%202022%20Mid-year%20Population%20Estimates%20for%20Northern%20Ireland.pdf'>publication</a> \r
					and statistical tables. Population characteristics are from the census data which can be explored further in the <a href='https://explore.nisra.gov.uk/area-explorer-2021/N92000002/'>Census Area Explorer</a>, \r
					bespoke tables can be created using the <a href='https://build.nisra.gov.uk/en/'>Flexible Table Builder</a> and the NISRA website has \r
					<a href='https://www.nisra.gov.uk/publications/census-2021-statistical-bulletins'>statistical bulletins</a> providing commentary on a range of census population characteristics.`}}),qr=new Dl({props:{id:"health",img:"nisra-taxonomy-icon-health.png",heading:"Health and Social Care",place:u[0].place,sub_heading:Pa("Health and Social Care",u[0].place),description:" ",chart_compare_type:u[6],boxes:{box_1:{id:"generalhealth",year:u[14]("general_health"),content:{ni:"StackedBarChart",lgd:"StackedBarChart",dea:"StackedBarChart",sdz:"not available - needs missing 2011",dz:"not available - needs missing 2011"},chart_data:u[0].place&&u[8](["general_health"],["2011"],["2021"]),zKey:u[6],label:u[7],topic_prev_available:"true"},box_2:{id:"wellbeing",year:zr("Happy",u[0].place),content:{ni:"<p><span class='text-big' style='font-size: 1.8em'>7.5</span> / 10 happiness</p><p><span class='text-big' style='font-size: 1.8em'>7.5</span> / 10 life satisfaction</p>",lgd:"<p><span class='text-big' style='font-size: 1.8em'>"+u[13]("Happy.value").toLocaleString()+"</span> / 10 happiness</p><p><span class='text-big' style='font-size: 1.8em'>7.5</span> / 10 life satisfaction</p>"},show:["ni","lgd"]},box_3:{id:"lifeexpectancy",year:zr("LE",u[0].place),content:"<p>Male <span class='text-big' style='font-size: 1.8em'>"+u[13]("LE.value.Males").toLocaleString()+"</span> years</p><p>Female <span class='text-big' style='font-size: 1.8em'>"+u[13]("LE.value.Females").toLocaleString()+"</span> years</p>",show:["ni","lgd"]},box_4:{id:"carers",content:"GroupChart",year:u[14]("provision_care"),chart_data:{none:u[9](u[0].place.grouped_data_nocompare.provision_care,"provision_care"),prev:u[9](u[0].place.grouped_data_timecompare.provision_care,"provision_care"),ni:u[9](u[0].place.grouped_data_areacompare.provision_care,"provision_care")},label:u[7],topic_prev_available:"true"},box_5:{id:"hospitalactivity",year:zr("Admiss",u[0].place),content:"<p><span class='text-big' style='font-size: 1.8em'>"+u[13]("Admiss.value").toLocaleString()+"</span> hospital patients</p><p>  The most frequent reason was for Diseases of the respiratory system</p>",show:["ni","dea"]},box_6a:{id:"primarycare",year:zr("GP",u[0].place),content:"<p><span class='text-big' style='font-size: 1.2em'>"+u[13]("GP.value.PRACS").toLocaleString()+"</span> GP practices with an average of <span class='text-big' style='font-size: 1.2em'>"+u[13]("GP.value.PRACLIST").toLocaleString()+"</span> patients per practice</p><p><span class='text-big' style='font-size: 1.2em'>"+ +u[13]("DEN.value.GDSDSSurgeries").toLocaleString()+"</span> dental surgeries</span> with an average of <span class='text-big' style='font-size: 1.2em'>"+(u[13]("DEN_REG.value.Dental_Registrations")/u[13]("DEN.value.GDSDSSurgeries")).toLocaleString(void 0,{minimumFractionDigits:0,maximumFractionDigits:0})+"</span> patients per surgery</p>",show:["ni","lgd"]},box_6b:{id:"primarycare",year:zr("DEN",u[0].place),content:"<p><span class='text-big' style='font-size: 1.2em'>"+ +u[13]("DEN.value.GDSDSSurgeries").toLocaleString()+"</span> dental surgeries</span> with an average of <span class='text-big' style='font-size: 1.2em'>"+(u[13]("DEN_REG.value.Dental_Registrations")/u[13]("DEN.value.GDSDSSurgeries")).toLocaleString(void 0,{minimumFractionDigits:0,maximumFractionDigits:0})+"</span> patients per surgery</p>",show:["dea"]},box_6c:{id:"empty",content:"",show:["sdz","dz"]}},more:`<p>Significant volumes of information are prepared by the <a href='https://www.health-ni.gov.uk/topics/doh-statistics-and-research'>Department of Health</a> \r
			and the <a href='https://bso.hscni.net/directorates/operations/family-practitioner-services/directorates-operations-family-practitioner-services-information-unit/general-ophthalmic-services-statistics/'>\r
				Business Services Organisation</a>, including statistics on <a href='https://www.health-ni.gov.uk/topics/dhssps-statistics-and-research/health-inequalities-statistics'>Health inequalities</a>, \r
				Primary care (including <a href='https://bso.hscni.net/directorates/operations/family-practitioner-services/directorates-operations-family-practitioner-services-information-unit/1776-2/'>Medical</a>, \r
				<a href='https://bso.hscni.net/directorates/operations/family-practitioner-services/directorates-operations-family-practitioner-services-information-unit/general-dental-services-statistics/'>Dental</a>, \r
				<a href='https://bso.hscni.net/directorates/operations/family-practitioner-services/directorates-operations-family-practitioner-services-information-unit/general-pharmaceutical-services-and-prescribing-statistics/'>\r
				Pharmaceutical</a> and <a href='https://bso.hscni.net/directorates/operations/family-practitioner-services/directorates-operations-family-practitioner-services-information-unit/general-ophthalmic-services-statistics/'>\r
				Ophthalmic</a>), <a href='https://www.health-ni.gov.uk/topics/dhssps-statistics-and-research/family-health-services-statistics'>\r
				Family health services</a>, <a href='https://www.health-ni.gov.uk/topics/doh-statistics-and-research-mental-health-and-learning-disabilities/mental-health-learning-disability-and-autism-statistics'>\r
				Mental health, learning disability and autism</a>, <a href='https://www.health-ni.gov.uk/topics/dhssps-statistics-and-research-social-services/social-care-statistics'>\r
				Social care</a>, <a href='https://www.health-ni.gov.uk/topics/dhssps-statistics-and-research/workforce-statistics'>Workforce</a>, and <u>COVID-19</u>.\r
				A number of <a href='https://visual.nisra.gov.uk/?body=entity/health'>interactive dashboards</a> are available and a compendium dashboard for <a href='https://visual.nisra.gov.uk/?body=entity/las'>\r
				Making Life Better</a>.\r
				The <a href='https://www.nisra.gov.uk/statistics/census'>2021 census</a> collected data on general health, long-term conditions and carers which can \r
				be explored in the <a href='https://explore.nisra.gov.uk/area-explorer-2021/N92000002/'>Census Area Explorer</a> and the <a href='https://build.nisra.gov.uk/en/'>Flexible Table Builder</a>.</p><p></p>`}}),hi=new Dl({props:{id:"work",img:"nisra-taxonomy-icon-labour-market.png",heading:"Work and Welfare",place:u[0].place,sub_heading:Pa("Work and Welfare",u[0].place),description:" ",chart_compare_type:u[6],boxes:{box_1:{id:"employmentrates",year:zr("LMS",u[0].place),content:"To be changed to a chart<p style='margin:0'>Employed <span class='text-big' style='font-size: 1.8em'>"+u[13]("LMS.value.EMPR").toLocaleString()+"%</span> </p><p style='margin:0'>Unemployed <span class='text-big' style='font-size: 1.8em'>"+u[13]("LMS.value.UNEMPR").toLocaleString()+"%</span> </p><p style='margin:0'>Inactive <span class='text-big' style='font-size: 1.8em'>"+u[13]("LMS.value.INACTR").toLocaleString()+"%</span></p>",show:["ni","lgd"]},box_2:{id:"employed",year:zr("LMS",u[0].place),content:"<p><span class='text-big' style='font-size: 1.8em'>"+u[13]("LMS.value.EMPN").toLocaleString()+"</span> employed out of "+u[0].place.data.MYETotal.value.toLocaleString()+" who live in this area (including children and pensioners) possibly add working age number</p>",show:["ni","lgd"]},box_3b:{id:"bres",year:zr("BRES",u[0].place),content:"To be changed to a chart<p style='margin:0'>Construction <span class='text-big' style='font-size: 1.8em'>"+u[13]("grouped_data_nocompare.BRES[0].perc").toLocaleString()+"</span> </p><p style='margin:0'>Manufacturing <span class='text-big' style='font-size: 1.8em'>"+u[13]("grouped_data_nocompare.BRES[1].perc").toLocaleString()+"</span> </p><p style='margin:0'>Services <span class='text-big' style='font-size: 1.8em'>"+u[13]("grouped_data_nocompare.BRES[2].perc").toLocaleString()+"</span></p><p style='margin:0'>Other <span class='text-big' style='font-size: 1.8em'>"+u[13]("grouped_data_nocompare.BRES[3].perc").toLocaleString()+"</span></p>",show:["ni","lgd"]},box_3:{id:"wages",year:zr("ASHE",u[0].place),content:'<p><span class="text-big" style="font-size: 1.8em">'+u[13]("ASHE.value").toLocaleString()+"</span> median salary</p>",show:["ni","lgd"]},box_4:{id:"disabilitybenefits",year:zr("BS",u[0].place),content:'<span class="text-big" style="font-size: 1.8em">'+(u[0].place.data.BS.value.PIP+u[0].place.data.BS.value.DLA+u[0].place.data.BS.value.CA+u[0].place.data.BS.value.AA).toLocaleString()+"</span> claimants"},box_5:{id:"workingagebenefits",year:zr("BS",u[0].place),content:'<span class="text-big" style="font-size: 1.8em">'+(u[0].place.data.BS.value.UC+u[0].place.data.BS.value.JSA+u[0].place.data.BS.value.IS+u[0].place.data.BS.value.ESA).toLocaleString()+"</span> claimants"},box_6:{id:"pensionagebenefits",year:zr("BS",u[0].place),content:'<span class="text-big" style="font-size: 1.8em">'+(u[0].place.data.BS.value.RP+u[0].place.data.BS.value.PC).toLocaleString()+"</span> claimants"}},more:`<p>The monthly <a href='https://www.nisra.gov.uk/statistics/labour-market-and-social-welfare/labour-market-overview'>Labour Market Report</a>\r
			contains the most up to date labour market statistics. The <a href='https://www.nisra.gov.uk/statistics/labour-market-and-social-welfare/annual-survey-hours-and-earnings'>\r
				Annual Survey of Hours and Earnings</a> providesdata on hourly, weekly and annual earnings. The <a href='https://www.nisra.gov.uk/statistics/labour-market-and-social-welfare/quarterly-employment-survey'>\r
					Quarterly Employment Survey</a> provides short-term employee jobs estimates for NI. Further information is available for the \r
					unemployed <a href='https://www.nisra.gov.uk/statistics/labour-market-and-social-welfare/claimant-count'>Claimant Count</a>, \r
					claimant numbers for <a href='https://www.nisra.gov.uk/statistics/labour-market-and-social-welfare/disability-benefits'>Disability Benefits</a>, \r
					and <a href='https://www.nisra.gov.uk/statistics/labour-market-and-social-welfare/work-related-benefits'>Work Related Benefits</a>. \r
					Statistics on <a href='https://www.nisra.gov.uk/statistics/labour-market-and-social-welfare/redundancies'>Redundancies</a> \r
					and <a href='https://www.nisra.gov.uk/statistics/labour-market-and-social-welfare/job-vacancies'>Job Vacancies</a> are also available. \r
					A number of <a href='https://visual.nisra.gov.uk/?body=entity/lm'>interactive dashboards</a> are available. \r
					The <a href='https://www.nisra.gov.uk/statistics/census'>2021 census</a> collected data on occupations, industry and number of hours worked which can be \r
					explored in the <a href='https://explore.nisra.gov.uk/area-explorer-2021/N92000002/'>Census Area Explorer</a> and the <a href='https://build.nisra.gov.uk/en/'>Flexible Table Builder</a>.</p>`}}),Di=new Dl({props:{id:"education",img:"nisra-taxonomy-icon-child-education-skills.png",heading:"Education",place:u[0].place,sub_heading:Pa("Schools, colleges and universities",u[0].place),description:"",chart_compare_type:u[6],boxes:{box_1:{id:"enrollments",content:"<p style='margin:0'>Primary school <span class='text-big' style='font-size: 1.2em'>"+u[13]("Primary.value").toLocaleString()+"</span></p><p style='margin:0'>Secondary school <span class='text-big' style='font-size: 1.2em'>"+u[13]("PostPrimary.value").toLocaleString()+" </span></p><p style='margin:0'>Further education <span class='text-big' style='font-size: 1.2em'>"+u[13]("FE.value").toLocaleString()+"</span></p><p style='margin:0'>Higher education <span class='text-big' style='font-size: 1.2em'>"+u[13]("HE.value").toLocaleString()+" </span></p>",year:zr("Primary",u[0].place),show:["ni","lgd","dea"]},box_2:{id:"fsme",content:"<p style='margin:0'>Primary school <span class='text-big' style='font-size: 1.8em'> "+u[13]("grouped_data_nocompare.Primary[0].perc")+" </span></p><p style='margin:0'>Secondary school <span class='text-big' style='font-size: 1.8em'>"+u[13]("grouped_data_nocompare.PostPrimary[0].perc")+" </span></p>",year:zr("Primary",u[0].place),show:["ni","lgd","dea"]},box_3:{id:"teachers",year:zr("ClassSize",u[0].place),content:"<p><span class='text-big' style='font-size: 1.8em'>"+u[13]("ClassSize.value").toLocaleString()+"</span> pupils per teacher</p>",show:["ni","lgd"]},box_4:{id:"qualifications",content:"GroupChart",year:u[14]("highest_level_of_qualifications"),chart_data:{none:u[9](u[0].place.grouped_data_nocompare.highest_level_of_qualifications,"highest_level_of_qualifications"),prev:u[9](u[0].place.grouped_data_timecompare.highest_level_of_qualifications,"highest_level_of_qualifications"),ni:u[9](u[0].place.grouped_data_areacompare.highest_level_of_qualifications,"highest_level_of_qualifications")},topic_prev_available:"true"},box_5:{id:"attainment",year:zr("Attainment",u[0].place),content:"<p><span class='text-big' style='font-size: 1.8em'>"+u[13]("Attainment.value").toLocaleString()+"</span>% of pupils left school with 5 or more GCSEs grades A*-C (including Maths and English)</p>",show:["ni","lgd"]},box_6:{id:"destination",year:zr("Destination",u[0].place),content:"Chart to be added",show:["ni","lgd","dea"]},box_6a:{id:"empty",content:"",show:["sdz","dz"]},box_6b:{id:"empty",content:"",show:["sdz","dz"]}},more:"<p>The <a href='https://www.nisra.gov.uk/statistics/children-education-and-skills/school-education-statistics'>Department of Education</a> publishes statistics on <a href='https://www.education-ni.gov.uk/articles/school-enrolments-overview'>school enrolments</a>, <a href='https://www.education-ni.gov.uk/articles/school-performance'>school performance</a>, <a href='https://www.education-ni.gov.uk/articles/school-leavers'>school leavers</a>, qualifications and destinations, <a href='https://www.education-ni.gov.uk/articles/pupil-attendance'>pupil attendance</a>, suspensions and expulsions, school meals and <a href='https://www.education-ni.gov.uk/articles/education-workforce'>education workforce</a>. The <a href='https://www.nisra.gov.uk/statistics/children-education-and-skills/higher-and-further-education-and-training-statistics'>Department for the Economy</a> publishes <a href='https://www.economy-ni.gov.uk/topics/statistics-and-economic-research/higher-education-statistics-and-research'>Higher</a> and <a href='https://www.economy-ni.gov.uk/topics/statistics-and-economic-research/further-education-statistics-and-research'>Further</a> education and <a href='https://www.economy-ni.gov.uk/articles/training-success-statistics'>training</a> statistics. The <a href='https://www.nisra.gov.uk/statistics/census'>2021 census</a> collected data on qualifications which can be explored in the <a href='https://explore.nisra.gov.uk/area-explorer-2021/N92000002/'>Census Area Explorer</a> and the <a href='https://build.nisra.gov.uk/en/'>Flexible Table Builder</a>.</p>"}}),Vi=new Dl({props:{id:"crime",img:"nisra-taxonomy-icon-crime-justice.png",heading:"Crime and Justice",place:u[0].place,sub_heading:Pa("Crime and Court Activity",u[0].place),description:" ",chart_compare_type:u[6],boxes:{},more:""}}),Li=new Dl({props:{id:"travel",img:"nisra-taxonomy-icon-travel-transport.png",heading:"Travel and Transport",place:u[0].place,sub_heading:Pa("Travel and transport",u[0].place),description:" ",chart_compare_type:u[6],boxes:{},more:""}}),{c(){h=qe("div"),d=qe("div"),p=qe("span"),y=qe("a"),_=Ot("Home"),a=new Ol(!1),E=vt(),ei.c(),D=vt(),F=qe("br"),L=vt(),R=qe("span"),ne=Ot(X),pe=vt(),ve=qe("div"),de=qe("div"),xe=qe("b"),$e=Ot("Search for your area:"),ht=vt(),er(Pe.$$.fragment),We=vt(),gt=qe("script"),Ke=Ot(`// Share button\r
						// Possible tooltip: https://stackoverflow.com/questions/37798967/tooltip-on-click-of-a-button\r
\r
						function copyToClipboard(text) {\r
							var inputc = document.body.appendChild(\r
								document.createElement("input"),\r
							);\r
							inputc.value = window.location.href;\r
							inputc.select();\r
							document.execCommand("copy");\r
							inputc.parentNode.removeChild(inputc);\r
							alert("URL Copied.");\r
						}\r
\r
						(function (win, doc) {\r
							const testButton = doc.createElement("button");\r
							testButton.setAttribute("type", "share");\r
							if (testButton.type != "share") {\r
								win.addEventListener("click", function (ev) {\r
									ev = ev || win.event;\r
									let target = ev.target;\r
									let button = target.closest(\r
										'button[type="share"]',\r
									);\r
									if (button) {\r
										const title = "Share URL";\r
										const url = win.location.href;\r
										if (navigator.share) {\r
											navigator.share({\r
												title: title,\r
												url: url,\r
											});\r
										} else {\r
											copyToClipboard();\r
										}\r
									}\r
								});\r
							}\r
						})(this, this.document);`),dt=vt(),Ne=qe("div"),at=qe("button"),Vt=Ot("About"),st=vt(),At=qe("button"),Fe=Ot("Print / PDF"),qt=vt(),St=qe("button"),Ir=Ot("Share"),_t=vt(),xt=qe("div"),er(Re.$$.fragment),Dt=vt(),er(Rr.$$.fragment),xr=vt(),er(Vr.$$.fragment),Br=vt(),fr=qe("div"),yi=qe("div"),Jt=qe("h3"),wi.c(),rn=vt(),Mi=qe("div"),er($r.$$.fragment),yn=vt(),Yr=qe("div"),Mr&&Mr.c(),li=vt(),nn=qe("div"),ti.c(),an=vt(),yr=qe("div"),er(ui.$$.fragment),on=vt(),er(qr.$$.fragment),ci=vt(),er(hi.$$.fragment),gi=vt(),er(Di.$$.fragment),Wn=vt(),er(Vi.$$.fragment),Ln=vt(),er(Li.$$.fragment),this.h()},l(te){h=je(te,"DIV",{class:!0});var P=Ue(h);d=je(P,"DIV",{});var N=Ue(d);p=je(N,"SPAN",{class:!0});var V=Ue(p);y=je(V,"A",{href:!0,"data-sveltekit-noscroll":!0,class:!0});var K=Ue(y);_=Ft(K,"Home"),K.forEach(ae),a=Fl(V,!1),E=bt(V),ei.l(V),D=bt(V),V.forEach(ae),F=je(N,"BR",{}),L=bt(N),R=je(N,"SPAN",{class:!0});var W=Ue(R);ne=Ft(W,X),W.forEach(ae),N.forEach(ae),pe=bt(P),ve=je(P,"DIV",{});var ue=Ue(ve);de=je(ue,"DIV",{style:!0,class:!0});var he=Ue(de);xe=je(he,"B",{});var q=Ue(xe);$e=Ft(q,"Search for your area:"),q.forEach(ae),ht=bt(he),tr(Pe.$$.fragment,he),We=bt(he),gt=je(he,"SCRIPT",{});var Q=Ue(gt);Ke=Ft(Q,`// Share button\r
						// Possible tooltip: https://stackoverflow.com/questions/37798967/tooltip-on-click-of-a-button\r
\r
						function copyToClipboard(text) {\r
							var inputc = document.body.appendChild(\r
								document.createElement("input"),\r
							);\r
							inputc.value = window.location.href;\r
							inputc.select();\r
							document.execCommand("copy");\r
							inputc.parentNode.removeChild(inputc);\r
							alert("URL Copied.");\r
						}\r
\r
						(function (win, doc) {\r
							const testButton = doc.createElement("button");\r
							testButton.setAttribute("type", "share");\r
							if (testButton.type != "share") {\r
								win.addEventListener("click", function (ev) {\r
									ev = ev || win.event;\r
									let target = ev.target;\r
									let button = target.closest(\r
										'button[type="share"]',\r
									);\r
									if (button) {\r
										const title = "Share URL";\r
										const url = win.location.href;\r
										if (navigator.share) {\r
											navigator.share({\r
												title: title,\r
												url: url,\r
											});\r
										} else {\r
											copyToClipboard();\r
										}\r
									}\r
								});\r
							}\r
						})(this, this.document);`),Q.forEach(ae),dt=bt(he),Ne=je(he,"DIV",{width:!0});var me=Ue(Ne);at=je(me,"BUTTON",{class:!0,style:!0,alt:!0,onclick:!0});var Me=Ue(at);Vt=Ft(Me,"About"),Me.forEach(ae),st=bt(me),At=je(me,"BUTTON",{class:!0,style:!0,title:!0,onclick:!0});var Be=Ue(At);Fe=Ft(Be,"Print / PDF"),Be.forEach(ae),qt=bt(me),St=je(me,"BUTTON",{class:!0,style:!0,type:!0,alt:!0});var Ee=Ue(St);Ir=Ft(Ee,"Share"),Ee.forEach(ae),me.forEach(ae),he.forEach(ae),ue.forEach(ae),P.forEach(ae),_t=bt(te),xt=je(te,"DIV",{id:!0,class:!0});var De=Ue(xt);tr(Re.$$.fragment,De),Dt=bt(De),tr(Rr.$$.fragment,De),xr=bt(De),tr(Vr.$$.fragment,De),De.forEach(ae),Br=bt(te),fr=je(te,"DIV",{class:!0});var it=Ue(fr);yi=je(it,"DIV",{style:!0});var nt=Ue(yi);Jt=je(nt,"H3",{class:!0});var ze=Ue(Jt);wi.l(ze),ze.forEach(ae),nt.forEach(ae),rn=bt(it),Mi=je(it,"DIV",{id:!0,style:!0,class:!0});var et=Ue(Mi);tr($r.$$.fragment,et),et.forEach(ae),yn=bt(it),Yr=je(it,"DIV",{});var Ge=Ue(Yr);Mr&&Mr.l(Ge),Ge.forEach(ae),li=bt(it),nn=je(it,"DIV",{});var Ye=Ue(nn);ti.l(Ye),Ye.forEach(ae),it.forEach(ae),an=bt(te),yr=je(te,"DIV",{class:!0,id:!0});var Pt=Ue(yr);tr(ui.$$.fragment,Pt),on=bt(Pt),tr(qr.$$.fragment,Pt),ci=bt(Pt),tr(hi.$$.fragment,Pt),gi=bt(Pt),tr(Di.$$.fragment,Pt),Wn=bt(Pt),tr(Vi.$$.fragment,Pt),Ln=bt(Pt),tr(Li.$$.fragment,Pt),Pt.forEach(ae),this.h()},h(){oe(y,"href",Na+"/"),oe(y,"data-sveltekit-noscroll",""),oe(y,"class","svelte-hmrro5"),a.a=E,oe(p,"class","text-small"),oe(R,"class","text-big title svelte-hmrro5"),oe(at,"class","btn svelte-hmrro5"),Xe(at,"width","33%"),oe(at,"alt","Return to the landing page"),oe(at,"onclick","window.location.href='/about';"),oe(At,"class","btn svelte-hmrro5"),Xe(At,"width","33%"),oe(At,"title","Click to print this page to pdf or printer"),oe(At,"onclick","window.print();return false;"),oe(St,"class","btn svelte-hmrro5"),Xe(St,"width","30%"),oe(St,"type","share"),oe(St,"alt","Share this page"),oe(Ne,"width","100%"),Xe(de,"width","350px"),Xe(de,"padding-top","5px"),oe(de,"class","svelte-hmrro5"),as(de,"float-right",u[2]>1),oe(h,"class","grid mtl svelte-hmrro5"),oe(xt,"id","grid"),oe(xt,"class","grid mt svelte-hmrro5"),oe(Jt,"class","svelte-hmrro5"),Xe(yi,"grid-column","span "+u[2]),oe(Mi,"id","map"),Xe(Mi,"padding-right","45px"),Xe(Mi,"grid-column","span "+(u[2]==2?2:u[2]&&u[2]>2?u[2]-1:1)),oe(Mi,"class","svelte-hmrro5"),oe(fr,"class","grid mt svelte-hmrro5"),Ku(()=>u[18].call(fr)),oe(yr,"class","accordion"),oe(yr,"id","accordionPanelsStayOpenExample")},m(te,P){Le(te,h,P),Ie(h,d),Ie(d,p),Ie(p,y),Ie(y,_),a.m(T,p),Ie(p,E),ei.m(p,null),Ie(p,D),Ie(d,F),Ie(d,L),Ie(d,R),Ie(R,ne),Ie(h,pe),Ie(h,ve),Ie(ve,de),Ie(de,xe),Ie(xe,$e),Ie(de,ht),rr(Pe,de,null),Ie(de,We),Ie(de,gt),Ie(gt,Ke),Ie(de,dt),Ie(de,Ne),Ie(Ne,at),Ie(at,Vt),Ie(Ne,st),Ie(Ne,At),Ie(At,Fe),Ie(Ne,qt),Ie(Ne,St),Ie(St,Ir),Le(te,_t,P),Le(te,xt,P),rr(Re,xt,null),Ie(xt,Dt),rr(Rr,xt,null),Ie(xt,xr),rr(Vr,xt,null),Le(te,Br,P),Le(te,fr,P),Ie(fr,yi),Ie(yi,Jt),wi.m(Jt,null),Ie(fr,rn),Ie(fr,Mi),rr($r,Mi,null),Ie(fr,yn),Ie(fr,Yr),Mr&&Mr.m(Yr,null),Ie(fr,li),Ie(fr,nn),ti.m(nn,null),Ui=Hu(fr,u[18].bind(fr)),Le(te,an,P),Le(te,yr,P),rr(ui,yr,null),Ie(yr,on),rr(qr,yr,null),Ie(yr,ci),rr(hi,yr,null),Ie(yr,gi),rr(Di,yr,null),Ie(yr,Wn),rr(Vi,yr,null),Ie(yr,Ln),rr(Li,yr,null),Ji=!0},p(te,P){Tn===(Tn=Rn(te))&&ei?ei.p(te,P):(ei.d(1),ei=Tn(te),ei&&(ei.c(),ei.m(p,D))),(!Ji||P[0]&1)&&X!==(X=te[0].place.name+"")&&Tr(ne,X);const N={};P[0]&1&&(N.search_data=te[0].search_data),Pe.$set(N),(!Ji||P[0]&4)&&as(de,"float-right",te[2]>1);const V={};P[0]&1&&(V.heading="About "+te[0].place.name),P[0]&1&&(V.place=te[0].place),P[0]&1&&(V.content={ni:"Northern Ireland has 11 Local Government Districts (LGDs),  which can be subdivided into District Electoral Areas (DEAs), then further into Super Data Zones and Data Zones. Statistics can be viewed for these smaller areas.",lgd:te[0].place.name+" is one of "+te[0].place.count.toLocaleString()+" "+Kn[te[0].place.type].pl+".",dea:te[0].place.name+" is one of "+te[0].place.count.toLocaleString()+" "+Kn[te[0].place.type].pl+"in Northern Ireland.  It is within <a href = '/"+te[0].place.parents[0].code+"/' data-sveltekit-noscroll>"+te[0].place.parents[0].name+" </a> and covers "+te[0].place.dea_location_description+".",sdz:te[0].place.name+" is one of "+te[0].place.count.toLocaleString()+" "+Kn[te[0].place.type].pl,dz:te[0].place.name+" is one of "+te[0].place.count.toLocaleString()+" "+Kn[te[0].place.type].pl}),P[0]&64&&(V.chart_compare_type=te[6]),Re.$set(V);const K={};P[0]&1&&(K.place=te[0].place),P[0]&1&&(K.year=zr("MYETotal",te[0].place)),P[0]&1&&(K.content='<span class="text-big" style="font-size: 2.8em;">'+(Math.round(te[0].place.data.MYETotal.value/1e3)*1e3).toLocaleString()+"</span>"),P[0]&64&&(K.chart_compare_type=te[6]),P[0]&1&&(K.compare_content={ni:{prev:'<span class="em '+ts(te[0].place.data.population.value.change.all)+'">'+rs(te[0].place.data.population.value.change.all,"%",1)+"</span> since 2011 Census"},lgd:{prev:'<span class="em '+ts(te[0].place.data.population.value.change.all)+'">'+rs(te[0].place.data.population.value.change.all,"%",1)+"</span> since 2011 Census",ni:'<span class = "em" style = "background-color: lightgrey">'+gh(te[0].place.data.population.value[2021].all/te[0].ni.data.population.value[2021].all)+"</span> of Northern Ireland population<br>The "+te[12](te[0].place.data.population.value_rank[2021].all)+" population of 11 Local Government Districts"},dea:{ni:'<span class = "em" style = "background-color: lightgrey">'+gh(te[0].place.data.population.value[2021].all/te[0].ni.data.population.value[2021].all)+"</span> of Northern Ireland population"},sdz:{prev:" nothing further",ni:" nothing further"},dz:{prev:" no comparisons",ni:" nothing further"}}),Rr.$set(K);const W={};P[0]&1&&(W.place=te[0].place),P[0]&1&&(W.content='<span class="text-big" style="font-size: 2.8em;">'+ny(te[0].place)+"</span> people per hectare"),P[0]&64&&(W.chart_compare_type=te[6]),P[0]&1&&(W.compare_content={ni:{prev:'<span class="em '+ts(te[0].place.data.households.value.change.all_households)+'">'+rs(te[0].place.data.households.value.change.all_households,"%",1)+"</span> since 2011 Census"},lgd:{prev:'<span class="em '+ts(te[0].place.data.households.value.change.all_households)+'">'+rs(te[0].place.data.households.value.change.all_households,"%",1)+"</span> since 2011 Census",ni:te[15](te[0].place)},dea:{ni:te[15](te[0].place)},sdz:{prev:" nothing further",ni:te[15](te[0].place)},dz:{prev:" no comparisons",ni:te[15](te[0].place)}}),Vr.$set(W),In===(In=Yn(te))&&wi?wi.p(te,P):(wi.d(1),wi=In(te),wi&&(wi.c(),wi.m(Jt,null))),(!Ji||P[0]&4)&&Xe(yi,"grid-column","span "+te[2]);const ue={};P[0]&1&&(ue.location={bounds:te[0].place.bounds}),P[0]&48|P[1]&8&&(ue.$$scope={dirty:P,ctx:te}),!Gt&&P[0]&8&&(Gt=!0,ue.map=te[3],f_(()=>Gt=!1)),$r.$set(ue),(!Ji||P[0]&4)&&Xe(Mi,"grid-column","span "+(te[2]==2?2:te[2]&&te[2]>2?te[2]-1:1)),te[0].place.type!="ni"?Mr?Mr.p(te,P):(Mr=ty(te),Mr.c(),Mr.m(Yr,null)):Mr&&(Mr.d(1),Mr=null),gn===(gn=sn(te))&&ti?ti.p(te,P):(ti.d(1),ti=gn(te),ti&&(ti.c(),ti.m(nn,null)));const he={};P[0]&1&&(he.place=te[0].place),P[0]&1&&(he.sub_heading=Pa("People and Households",te[0].place)),P[0]&64&&(he.chart_compare_type=te[6]),P[0]&1&&(he.boxes={box_1:{id:"popchange",content:"<span > population growth/shrink to be added</span> "},box_2:{id:"age",year:te[14]("age"),content:"GroupChart",chart_data:{none:te[9](te[0].place.grouped_data_nocompare.age,"age"),prev:te[9](te[0].place.grouped_data_timecompare.age,"age"),ni:te[9](te[0].place.grouped_data_areacompare.age,"age")},topic_prev_available:"true"},box_4:{id:"hhsize",year:te[14]("hh_size"),content:"GroupChart",chart_data:{none:te[9](te[0].place.grouped_data_nocompare.hh_size,"hh_size"),prev:te[9](te[0].place.grouped_data_timecompare.hh_size,"hh_size"),ni:te[9](te[0].place.grouped_data_areacompare.hh_size,"hh_size")},topic_prev_available:"true"},box_5:{id:"religion",year:te[14]("religion_or_religion_brought_up_in"),content:"GroupChart",chart_data:{none:te[9](te[0].place.grouped_data_nocompare.religion_or_religion_brought_up_in,"religion_or_religion_brought_up_in"),prev:te[9](te[0].place.grouped_data_timecompare.religion_or_religion_brought_up_in,"religion_or_religion_brought_up_in"),ni:te[9](te[0].place.grouped_data_areacompare.religion_or_religion_brought_up_in,"religion_or_religion_brought_up_in")},topic_prev_available:"true"},box_6:{id:"language",year:te[14]("mainlang"),content:"GroupChart",chart_data:{none:te[9](te[0].place.grouped_data_nocompare.mainlang,"mainlang"),prev:te[9](te[0].place.grouped_data_timecompare.mainlang,"mainlang"),ni:te[9](te[0].place.grouped_data_areacompare.mainlang,"mainlang")},topic_prev_available:"true"}}),ui.$set(he);const q={};P[0]&1&&(q.place=te[0].place),P[0]&1&&(q.sub_heading=Pa("Health and Social Care",te[0].place)),P[0]&64&&(q.chart_compare_type=te[6]),P[0]&193&&(q.boxes={box_1:{id:"generalhealth",year:te[14]("general_health"),content:{ni:"StackedBarChart",lgd:"StackedBarChart",dea:"StackedBarChart",sdz:"not available - needs missing 2011",dz:"not available - needs missing 2011"},chart_data:te[0].place&&te[8](["general_health"],["2011"],["2021"]),zKey:te[6],label:te[7],topic_prev_available:"true"},box_2:{id:"wellbeing",year:zr("Happy",te[0].place),content:{ni:"<p><span class='text-big' style='font-size: 1.8em'>7.5</span> / 10 happiness</p><p><span class='text-big' style='font-size: 1.8em'>7.5</span> / 10 life satisfaction</p>",lgd:"<p><span class='text-big' style='font-size: 1.8em'>"+te[13]("Happy.value").toLocaleString()+"</span> / 10 happiness</p><p><span class='text-big' style='font-size: 1.8em'>7.5</span> / 10 life satisfaction</p>"},show:["ni","lgd"]},box_3:{id:"lifeexpectancy",year:zr("LE",te[0].place),content:"<p>Male <span class='text-big' style='font-size: 1.8em'>"+te[13]("LE.value.Males").toLocaleString()+"</span> years</p><p>Female <span class='text-big' style='font-size: 1.8em'>"+te[13]("LE.value.Females").toLocaleString()+"</span> years</p>",show:["ni","lgd"]},box_4:{id:"carers",content:"GroupChart",year:te[14]("provision_care"),chart_data:{none:te[9](te[0].place.grouped_data_nocompare.provision_care,"provision_care"),prev:te[9](te[0].place.grouped_data_timecompare.provision_care,"provision_care"),ni:te[9](te[0].place.grouped_data_areacompare.provision_care,"provision_care")},label:te[7],topic_prev_available:"true"},box_5:{id:"hospitalactivity",year:zr("Admiss",te[0].place),content:"<p><span class='text-big' style='font-size: 1.8em'>"+te[13]("Admiss.value").toLocaleString()+"</span> hospital patients</p><p>  The most frequent reason was for Diseases of the respiratory system</p>",show:["ni","dea"]},box_6a:{id:"primarycare",year:zr("GP",te[0].place),content:"<p><span class='text-big' style='font-size: 1.2em'>"+te[13]("GP.value.PRACS").toLocaleString()+"</span> GP practices with an average of <span class='text-big' style='font-size: 1.2em'>"+te[13]("GP.value.PRACLIST").toLocaleString()+"</span> patients per practice</p><p><span class='text-big' style='font-size: 1.2em'>"+ +te[13]("DEN.value.GDSDSSurgeries").toLocaleString()+"</span> dental surgeries</span> with an average of <span class='text-big' style='font-size: 1.2em'>"+(te[13]("DEN_REG.value.Dental_Registrations")/te[13]("DEN.value.GDSDSSurgeries")).toLocaleString(void 0,{minimumFractionDigits:0,maximumFractionDigits:0})+"</span> patients per surgery</p>",show:["ni","lgd"]},box_6b:{id:"primarycare",year:zr("DEN",te[0].place),content:"<p><span class='text-big' style='font-size: 1.2em'>"+ +te[13]("DEN.value.GDSDSSurgeries").toLocaleString()+"</span> dental surgeries</span> with an average of <span class='text-big' style='font-size: 1.2em'>"+(te[13]("DEN_REG.value.Dental_Registrations")/te[13]("DEN.value.GDSDSSurgeries")).toLocaleString(void 0,{minimumFractionDigits:0,maximumFractionDigits:0})+"</span> patients per surgery</p>",show:["dea"]},box_6c:{id:"empty",content:"",show:["sdz","dz"]}}),qr.$set(q);const Q={};P[0]&1&&(Q.place=te[0].place),P[0]&1&&(Q.sub_heading=Pa("Work and Welfare",te[0].place)),P[0]&64&&(Q.chart_compare_type=te[6]),P[0]&1&&(Q.boxes={box_1:{id:"employmentrates",year:zr("LMS",te[0].place),content:"To be changed to a chart<p style='margin:0'>Employed <span class='text-big' style='font-size: 1.8em'>"+te[13]("LMS.value.EMPR").toLocaleString()+"%</span> </p><p style='margin:0'>Unemployed <span class='text-big' style='font-size: 1.8em'>"+te[13]("LMS.value.UNEMPR").toLocaleString()+"%</span> </p><p style='margin:0'>Inactive <span class='text-big' style='font-size: 1.8em'>"+te[13]("LMS.value.INACTR").toLocaleString()+"%</span></p>",show:["ni","lgd"]},box_2:{id:"employed",year:zr("LMS",te[0].place),content:"<p><span class='text-big' style='font-size: 1.8em'>"+te[13]("LMS.value.EMPN").toLocaleString()+"</span> employed out of "+te[0].place.data.MYETotal.value.toLocaleString()+" who live in this area (including children and pensioners) possibly add working age number</p>",show:["ni","lgd"]},box_3b:{id:"bres",year:zr("BRES",te[0].place),content:"To be changed to a chart<p style='margin:0'>Construction <span class='text-big' style='font-size: 1.8em'>"+te[13]("grouped_data_nocompare.BRES[0].perc").toLocaleString()+"</span> </p><p style='margin:0'>Manufacturing <span class='text-big' style='font-size: 1.8em'>"+te[13]("grouped_data_nocompare.BRES[1].perc").toLocaleString()+"</span> </p><p style='margin:0'>Services <span class='text-big' style='font-size: 1.8em'>"+te[13]("grouped_data_nocompare.BRES[2].perc").toLocaleString()+"</span></p><p style='margin:0'>Other <span class='text-big' style='font-size: 1.8em'>"+te[13]("grouped_data_nocompare.BRES[3].perc").toLocaleString()+"</span></p>",show:["ni","lgd"]},box_3:{id:"wages",year:zr("ASHE",te[0].place),content:'<p><span class="text-big" style="font-size: 1.8em">'+te[13]("ASHE.value").toLocaleString()+"</span> median salary</p>",show:["ni","lgd"]},box_4:{id:"disabilitybenefits",year:zr("BS",te[0].place),content:'<span class="text-big" style="font-size: 1.8em">'+(te[0].place.data.BS.value.PIP+te[0].place.data.BS.value.DLA+te[0].place.data.BS.value.CA+te[0].place.data.BS.value.AA).toLocaleString()+"</span> claimants"},box_5:{id:"workingagebenefits",year:zr("BS",te[0].place),content:'<span class="text-big" style="font-size: 1.8em">'+(te[0].place.data.BS.value.UC+te[0].place.data.BS.value.JSA+te[0].place.data.BS.value.IS+te[0].place.data.BS.value.ESA).toLocaleString()+"</span> claimants"},box_6:{id:"pensionagebenefits",year:zr("BS",te[0].place),content:'<span class="text-big" style="font-size: 1.8em">'+(te[0].place.data.BS.value.RP+te[0].place.data.BS.value.PC).toLocaleString()+"</span> claimants"}}),hi.$set(Q);const me={};P[0]&1&&(me.place=te[0].place),P[0]&1&&(me.sub_heading=Pa("Schools, colleges and universities",te[0].place)),P[0]&64&&(me.chart_compare_type=te[6]),P[0]&1&&(me.boxes={box_1:{id:"enrollments",content:"<p style='margin:0'>Primary school <span class='text-big' style='font-size: 1.2em'>"+te[13]("Primary.value").toLocaleString()+"</span></p><p style='margin:0'>Secondary school <span class='text-big' style='font-size: 1.2em'>"+te[13]("PostPrimary.value").toLocaleString()+" </span></p><p style='margin:0'>Further education <span class='text-big' style='font-size: 1.2em'>"+te[13]("FE.value").toLocaleString()+"</span></p><p style='margin:0'>Higher education <span class='text-big' style='font-size: 1.2em'>"+te[13]("HE.value").toLocaleString()+" </span></p>",year:zr("Primary",te[0].place),show:["ni","lgd","dea"]},box_2:{id:"fsme",content:"<p style='margin:0'>Primary school <span class='text-big' style='font-size: 1.8em'> "+te[13]("grouped_data_nocompare.Primary[0].perc")+" </span></p><p style='margin:0'>Secondary school <span class='text-big' style='font-size: 1.8em'>"+te[13]("grouped_data_nocompare.PostPrimary[0].perc")+" </span></p>",year:zr("Primary",te[0].place),show:["ni","lgd","dea"]},box_3:{id:"teachers",year:zr("ClassSize",te[0].place),content:"<p><span class='text-big' style='font-size: 1.8em'>"+te[13]("ClassSize.value").toLocaleString()+"</span> pupils per teacher</p>",show:["ni","lgd"]},box_4:{id:"qualifications",content:"GroupChart",year:te[14]("highest_level_of_qualifications"),chart_data:{none:te[9](te[0].place.grouped_data_nocompare.highest_level_of_qualifications,"highest_level_of_qualifications"),prev:te[9](te[0].place.grouped_data_timecompare.highest_level_of_qualifications,"highest_level_of_qualifications"),ni:te[9](te[0].place.grouped_data_areacompare.highest_level_of_qualifications,"highest_level_of_qualifications")},topic_prev_available:"true"},box_5:{id:"attainment",year:zr("Attainment",te[0].place),content:"<p><span class='text-big' style='font-size: 1.8em'>"+te[13]("Attainment.value").toLocaleString()+"</span>% of pupils left school with 5 or more GCSEs grades A*-C (including Maths and English)</p>",show:["ni","lgd"]},box_6:{id:"destination",year:zr("Destination",te[0].place),content:"Chart to be added",show:["ni","lgd","dea"]},box_6a:{id:"empty",content:"",show:["sdz","dz"]},box_6b:{id:"empty",content:"",show:["sdz","dz"]}}),Di.$set(me);const Me={};P[0]&1&&(Me.place=te[0].place),P[0]&1&&(Me.sub_heading=Pa("Crime and Court Activity",te[0].place)),P[0]&64&&(Me.chart_compare_type=te[6]),Vi.$set(Me);const Be={};P[0]&1&&(Be.place=te[0].place),P[0]&1&&(Be.sub_heading=Pa("Travel and transport",te[0].place)),P[0]&64&&(Be.chart_compare_type=te[6]),Li.$set(Be)},i(te){Ji||(Qe(Pe.$$.fragment,te),Qe(Re.$$.fragment,te),Qe(Rr.$$.fragment,te),Qe(Vr.$$.fragment,te),Qe($r.$$.fragment,te),Qe(ui.$$.fragment,te),Qe(qr.$$.fragment,te),Qe(hi.$$.fragment,te),Qe(Di.$$.fragment,te),Qe(Vi.$$.fragment,te),Qe(Li.$$.fragment,te),Ji=!0)},o(te){ut(Pe.$$.fragment,te),ut(Re.$$.fragment,te),ut(Rr.$$.fragment,te),ut(Vr.$$.fragment,te),ut($r.$$.fragment,te),ut(ui.$$.fragment,te),ut(qr.$$.fragment,te),ut(hi.$$.fragment,te),ut(Di.$$.fragment,te),ut(Vi.$$.fragment,te),ut(Li.$$.fragment,te),Ji=!1},d(te){te&&ae(h),ei.d(),ir(Pe),te&&ae(_t),te&&ae(xt),ir(Re),ir(Rr),ir(Vr),te&&ae(Br),te&&ae(fr),wi.d(),ir($r),Mr&&Mr.d(),ti.d(),Ui(),te&&ae(an),te&&ae(yr),ir(ui),ir(qr),ir(hi),ir(Di),ir(Vi),ir(Li)}}}function q1(u){let h=u[0].place.name+"",d;return{c(){d=Ot(h)},l(p){d=Ft(p,h)},m(p,y){Le(p,d,y)},p(p,y){y[0]&1&&h!==(h=p[0].place.name+"")&&Tr(d,h)},d(p){p&&ae(d)}}}function j1(u){let h,d=u[0].place.name+"",p,y=[...u[0].place.parents].reverse(),_=[];for(let a=0;a<y.length;a+=1)_[a]=$m(Jm(u,y,a));return{c(){for(let a=0;a<_.length;a+=1)_[a].c();h=vt(),p=Ot(d)},l(a){for(let T=0;T<_.length;T+=1)_[T].l(a);h=bt(a),p=Ft(a,d)},m(a,T){for(let E=0;E<_.length;E+=1)_[E]&&_[E].m(a,T);Le(a,h,T),Le(a,p,T)},p(a,T){if(T[0]&1){y=[...a[0].place.parents].reverse();let E;for(E=0;E<y.length;E+=1){const D=Jm(a,y,E);_[E]?_[E].p(D,T):(_[E]=$m(D),_[E].c(),_[E].m(h.parentNode,h))}for(;E<_.length;E+=1)_[E].d(1);_.length=y.length}T[0]&1&&d!==(d=a[0].place.name+"")&&Tr(p,d)},d(a){tn(_,a),a&&ae(h),a&&ae(p)}}}function $m(u){let h,d=u[28].name+"",p,y,_,a=" &gt; ",T;return{c(){h=qe("a"),p=Ot(d),_=new Ol(!1),T=or(),this.h()},l(E){h=je(E,"A",{href:!0,"data-sveltekit-noscroll":!0,class:!0});var D=Ue(h);p=Ft(D,d),D.forEach(ae),_=Fl(E,!1),T=or(),this.h()},h(){oe(h,"href",y=Na+"/"+u[28].code+"/"),oe(h,"data-sveltekit-noscroll",""),oe(h,"class","svelte-hmrro5"),_.a=T},m(E,D){Le(E,h,D),Ie(h,p),_.m(a,E,D),Le(E,T,D)},p(E,D){D[0]&1&&d!==(d=E[28].name+"")&&Tr(p,d),D[0]&1&&y!==(y=Na+"/"+E[28].code+"/")&&oe(h,"href",y)},d(E){E&&ae(h),E&&ae(T),E&&_.d()}}}function Z1(u){let h,d;return{c(){h=qe("p"),d=Ot("Zoom and click on map to explore other areas"),this.h()},l(p){h=je(p,"P",{class:!0});var y=Ue(h);d=Ft(y,"Zoom and click on map to explore other areas"),y.forEach(ae),this.h()},h(){oe(h,"class","text-bold")},m(p,y){Le(p,h,y),Ie(h,d)},p:si,d(p){p&&ae(h)}}}function G1(u){let h,d,p=u[0].place.name+"",y,_,a,T,E,D,F;return{c(){h=Ot("You are currently viewing "),d=qe("span"),y=Ot(p),_=vt(),a=qe("span"),T=vt(),E=qe("p"),D=qe("span"),F=Ot("Zoom and click on map to explore other areas"),this.h()},l(L){h=Ft(L,"You are currently viewing "),d=je(L,"SPAN",{style:!0});var R=Ue(d);y=Ft(R,p),R.forEach(ae),_=bt(L),a=je(L,"SPAN",{style:!0});var X=Ue(a);X.forEach(ae),T=bt(L),E=je(L,"P",{});var ne=Ue(E);D=je(ne,"SPAN",{class:!0});var pe=Ue(D);F=Ft(pe,"Zoom and click on map to explore other areas"),pe.forEach(ae),ne.forEach(ae),this.h()},h(){Xe(d,"color","#3878c5"),Xe(a,"color","#00205b"),oe(D,"class","text-bold")},m(L,R){Le(L,h,R),Le(L,d,R),Ie(d,y),Le(L,_,R),Le(L,a,R),Le(L,T,R),Le(L,E,R),Ie(E,D),Ie(D,F)},p(L,R){R[0]&1&&p!==(p=L[0].place.name+"")&&Tr(y,p)},d(L){L&&ae(h),L&&ae(d),L&&ae(_),L&&ae(a),L&&ae(T),L&&ae(E)}}}function K1(u){let h,d,p,y,_,a,T;const E=[ns[u[30]],{id:u[30]+"-fill"},{type:"fill"},{isChild:u[5][u[30]]},{click:!0},{selected:u[4].selected},{highlight:!0},{highlighted:u[4].highlighted},{hover:!0},{hovered:u[4].hovered},{layout:{visibility:u[4].type==u[30]||u[4].childType==u[30]?"visible":"none"}},{paint:u[4].type==u[30]?Yi["fill-self"]:u[4].childType==u[30]?Yi["fill-child"]:Yi.fill}];let D={};for(let ne=0;ne<E.length;ne+=1)D=_h(D,E[ne]);h=new Pp({props:D}),h.$on("select",u[10]);const F=[ns[u[30]],{id:u[30]+"-bounds"},{type:"line"},{selected:u[4].selected},{highlight:!0},{highlighted:u[4].highlighted},{layout:{visibility:u[4].type==u[30]||u[4].childType==u[30]?"visible":"none"}},{paint:u[4].type==u[30]?Yi["line-active"]:u[4].childType==u[30]?Yi["line-child"]:Yi.line}];let L={};for(let ne=0;ne<F.length;ne+=1)L=_h(L,F[ne]);p=new Pp({props:L});const R=[ns[u[30]],{id:u[30]+"-self"},{type:"line"},{selected:u[4].selected},{layout:{visibility:u[4].type==u[30]?"visible":"none"}},{paint:u[4].type==u[30]?Yi["line-self"]:Yi.line}];let X={};for(let ne=0;ne<R.length;ne+=1)X=_h(X,R[ne]);return _=new Pp({props:X}),{c(){er(h.$$.fragment),d=vt(),er(p.$$.fragment),y=vt(),er(_.$$.fragment),a=vt()},l(ne){tr(h.$$.fragment,ne),d=bt(ne),tr(p.$$.fragment,ne),y=bt(ne),tr(_.$$.fragment,ne),a=bt(ne)},m(ne,pe){rr(h,ne,pe),Le(ne,d,pe),rr(p,ne,pe),Le(ne,y,pe),rr(_,ne,pe),Le(ne,a,pe),T=!0},p(ne,pe){const ve=pe[0]&48?vh(E,[pe&0&&bh(ns[ne[30]]),E[1],E[2],pe[0]&32&&{isChild:ne[5][ne[30]]},E[4],pe[0]&16&&{selected:ne[4].selected},E[6],pe[0]&16&&{highlighted:ne[4].highlighted},E[8],pe[0]&16&&{hovered:ne[4].hovered},pe[0]&16&&{layout:{visibility:ne[4].type==ne[30]||ne[4].childType==ne[30]?"visible":"none"}},pe[0]&16&&{paint:ne[4].type==ne[30]?Yi["fill-self"]:ne[4].childType==ne[30]?Yi["fill-child"]:Yi.fill}]):{};h.$set(ve);const de=pe[0]&16?vh(F,[pe&0&&bh(ns[ne[30]]),F[1],F[2],pe[0]&16&&{selected:ne[4].selected},F[4],pe[0]&16&&{highlighted:ne[4].highlighted},pe[0]&16&&{layout:{visibility:ne[4].type==ne[30]||ne[4].childType==ne[30]?"visible":"none"}},pe[0]&16&&{paint:ne[4].type==ne[30]?Yi["line-active"]:ne[4].childType==ne[30]?Yi["line-child"]:Yi.line}]):{};p.$set(de);const xe=pe[0]&16?vh(R,[pe&0&&bh(ns[ne[30]]),R[1],R[2],pe[0]&16&&{selected:ne[4].selected},pe[0]&16&&{layout:{visibility:ne[4].type==ne[30]?"visible":"none"}},pe[0]&16&&{paint:ne[4].type==ne[30]?Yi["line-self"]:Yi.line}]):{};_.$set(xe)},i(ne){T||(Qe(h.$$.fragment,ne),Qe(p.$$.fragment,ne),Qe(_.$$.fragment,ne),T=!0)},o(ne){ut(h.$$.fragment,ne),ut(p.$$.fragment,ne),ut(_.$$.fragment,ne),T=!1},d(ne){ir(h,ne),ne&&ae(d),ir(p,ne),ne&&ae(y),ir(_,ne),ne&&ae(a)}}}function ey(u){let h,d;const p=[bd[u[30]]];let y={$$slots:{default:[K1]},$$scope:{ctx:u}};for(let _=0;_<p.length;_+=1)y=_h(y,p[_]);return h=new Q_({props:y}),{c(){er(h.$$.fragment)},l(_){tr(h.$$.fragment,_)},m(_,a){rr(h,_,a),d=!0},p(_,a){const T=a&0?vh(p,[bh(bd[_[30]])]):{};a[0]&48|a[1]&8&&(T.$$scope={dirty:a,ctx:_}),h.$set(T)},i(_){d||(Qe(h.$$.fragment,_),d=!0)},o(_){ut(h.$$.fragment,_),d=!1},d(_){ir(h,_)}}}function H1(u){let h,d,p=["dz","sdz","dea","lgd"],y=[];for(let a=0;a<4;a+=1)y[a]=ey(Ym(u,p,a));const _=a=>ut(y[a],1,1,()=>{y[a]=null});return{c(){for(let a=0;a<4;a+=1)y[a].c();h=or()},l(a){for(let T=0;T<4;T+=1)y[T].l(a);h=or()},m(a,T){for(let E=0;E<4;E+=1)y[E]&&y[E].m(a,T);Le(a,h,T),d=!0},p(a,T){if(T[0]&1072){p=["dz","sdz","dea","lgd"];let E;for(E=0;E<4;E+=1){const D=Ym(a,p,E);y[E]?(y[E].p(D,T),Qe(y[E],1)):(y[E]=ey(D),y[E].c(),Qe(y[E],1),y[E].m(h.parentNode,h))}for(En(),E=4;E<4;E+=1)_(E);zn()}},i(a){if(!d){for(let T=0;T<4;T+=1)Qe(y[T]);d=!0}},o(a){y=y.filter(Boolean);for(let T=0;T<4;T+=1)ut(y[T]);d=!1},d(a){tn(y,a),a&&ae(h)}}}function ty(u){let h,d,p=u[0].place.name+"",y,_,a,T=[...u[0].place.parents].reverse(),E=[];for(let D=0;D<T.length;D+=1)E[D]=ry(Wm(u,T,D));return{c(){h=qe("span"),d=Ot("Select a larger area containing "),y=Ot(p),_=vt(),a=qe("span");for(let D=0;D<E.length;D+=1)E[D].c();this.h()},l(D){h=je(D,"SPAN",{class:!0});var F=Ue(h);d=Ft(F,"Select a larger area containing "),y=Ft(F,p),F.forEach(ae),_=bt(D),a=je(D,"SPAN",{class:!0});var L=Ue(a);for(let R=0;R<E.length;R+=1)E[R].l(L);L.forEach(ae),this.h()},h(){oe(h,"class","text-bold"),oe(a,"class","text-small")},m(D,F){Le(D,h,F),Ie(h,d),Ie(h,y),Le(D,_,F),Le(D,a,F);for(let L=0;L<E.length;L+=1)E[L]&&E[L].m(a,null)},p(D,F){if(F[0]&1&&p!==(p=D[0].place.name+"")&&Tr(y,p),F[0]&1){T=[...D[0].place.parents].reverse();let L;for(L=0;L<T.length;L+=1){const R=Wm(D,T,L);E[L]?E[L].p(R,F):(E[L]=ry(R),E[L].c(),E[L].m(a,null))}for(;L<E.length;L+=1)E[L].d(1);E.length=T.length}},d(D){D&&ae(h),D&&ae(_),D&&ae(a),tn(E,D)}}}function ry(u){let h,d,p=u[27]>0?" ":"",y,_=u[28].name+"",a,T;return{c(){h=qe("span"),d=new Ol(!1),y=qe("a"),a=Ot(_),this.h()},l(E){h=je(E,"SPAN",{style:!0});var D=Ue(h);d=Fl(D,!1),y=je(D,"A",{href:!0,"data-sveltekit-noscroll":!0,class:!0});var F=Ue(y);a=Ft(F,_),F.forEach(ae),D.forEach(ae),this.h()},h(){d.a=y,oe(y,"href",T=Na+"/"+u[28].code),oe(y,"data-sveltekit-noscroll",""),oe(y,"class","svelte-hmrro5"),Xe(h,"display","block"),Xe(h,"margin-left",(u[27]>0?(u[27]-1)*15:0)+"px")},m(E,D){Le(E,h,D),d.m(p,h),Ie(h,y),Ie(y,a)},p(E,D){D[0]&1&&_!==(_=E[28].name+"")&&Tr(a,_),D[0]&1&&T!==(T=Na+"/"+E[28].code)&&oe(y,"href",T)},d(E){E&&ae(h)}}}function X1(u){let h,d,p=u[0].place.name+"",y,_,a=Kn[u[0].place.type].name+"",T;return{c(){h=qe("span"),d=Ot("No areas below "),y=Ot(p),_=vt(),T=Ot(a),this.h()},l(E){h=je(E,"SPAN",{class:!0});var D=Ue(h);d=Ft(D,"No areas below "),y=Ft(D,p),_=bt(D),T=Ft(D,a),D.forEach(ae),this.h()},h(){oe(h,"class","muted")},m(E,D){Le(E,h,D),Ie(h,d),Ie(h,y),Ie(h,_),Ie(h,T)},p(E,D){D[0]&1&&p!==(p=E[0].place.name+"")&&Tr(y,p),D[0]&1&&a!==(a=Kn[E[0].place.type].name+"")&&Tr(T,a)},d(E){E&&ae(h)}}}function W1(u){let h,d,p=(u[0].place.children[0]?Kn[u[0].place.children[0].type].name:"Areas")+"",y,_,a=u[0].place.name+"",T,E,D,F,L=u[0].place.children,R=[];for(let X=0;X<L.length;X+=1)R[X]=iy(Xm(u,L,X));return{c(){h=qe("span"),d=Ot("Select a "),y=Ot(p),_=Ot(" within "),T=Ot(a),E=qe("br"),D=vt(),F=qe("span");for(let X=0;X<R.length;X+=1)R[X].c();this.h()},l(X){h=je(X,"SPAN",{class:!0});var ne=Ue(h);d=Ft(ne,"Select a "),y=Ft(ne,p),_=Ft(ne," within "),T=Ft(ne,a),ne.forEach(ae),E=je(X,"BR",{}),D=bt(X),F=je(X,"SPAN",{class:!0});var pe=Ue(F);for(let ve=0;ve<R.length;ve+=1)R[ve].l(pe);pe.forEach(ae),this.h()},h(){oe(h,"class","text-bold"),oe(F,"class","text-small")},m(X,ne){Le(X,h,ne),Ie(h,d),Ie(h,y),Ie(h,_),Ie(h,T),Le(X,E,ne),Le(X,D,ne),Le(X,F,ne);for(let pe=0;pe<R.length;pe+=1)R[pe]&&R[pe].m(F,null)},p(X,ne){if(ne[0]&1&&p!==(p=(X[0].place.children[0]?Kn[X[0].place.children[0].type].name:"Areas")+"")&&Tr(y,p),ne[0]&1&&a!==(a=X[0].place.name+"")&&Tr(T,a),ne[0]&1){L=X[0].place.children;let pe;for(pe=0;pe<L.length;pe+=1){const ve=Xm(X,L,pe);R[pe]?R[pe].p(ve,ne):(R[pe]=iy(ve),R[pe].c(),R[pe].m(F,null))}for(;pe<R.length;pe+=1)R[pe].d(1);R.length=L.length}},d(X){X&&ae(h),X&&ae(E),X&&ae(D),X&&ae(F),tn(R,X)}}}function iy(u){let h,d=u[25].name+"",p,y,_=u[27]<u[0].place.children.length-1?", ":"",a;return{c(){h=qe("a"),p=Ot(d),a=Ot(_),this.h()},l(T){h=je(T,"A",{href:!0,"data-sveltekit-noscroll":!0,class:!0});var E=Ue(h);p=Ft(E,d),E.forEach(ae),a=Ft(T,_),this.h()},h(){oe(h,"href",y=Na+"/"+u[25].code),oe(h,"data-sveltekit-noscroll",""),oe(h,"class","svelte-hmrro5")},m(T,E){Le(T,h,E),Ie(h,p),Le(T,a,E)},p(T,E){E[0]&1&&d!==(d=T[25].name+"")&&Tr(p,d),E[0]&1&&y!==(y=Na+"/"+T[25].code)&&oe(h,"href",y),E[0]&1&&_!==(_=T[27]<T[0].place.children.length-1?", ":"")&&Tr(a,_)},d(T){T&&ae(h),T&&ae(a)}}}function Y1(u){let h,d,p=u[0].place&&u[0].ni&&Qm(u);return{c(){p&&p.c(),h=or()},l(y){p&&p.l(y),h=or()},m(y,_){p&&p.m(y,_),Le(y,h,_),d=!0},p(y,_){y[0].place&&y[0].ni?p?(p.p(y,_),_[0]&1&&Qe(p,1)):(p=Qm(y),p.c(),Qe(p,1),p.m(h.parentNode,h)):p&&(En(),ut(p,1,1,()=>{p=null}),zn())},i(y){d||(Qe(p),d=!0)},o(y){ut(p),d=!1},d(y){p&&p.d(y),y&&ae(h)}}}function J1(u){let h,d,p,y,_,a,T,E,D,F,L,R,X,ne,pe,ve;return document.title=h=u[0].place.name+" NISRA Key Statistics",X=new a1({}),pe=new d_({props:{column:"wide",$$slots:{default:[Y1]},$$scope:{ctx:u}}}),{c(){d=qe("meta"),p=qe("meta"),_=qe("meta"),a=qe("meta"),E=qe("meta"),F=qe("meta"),R=vt(),er(X.$$.fragment),ne=vt(),er(pe.$$.fragment),this.h()},l(de){const xe=h_("svelte-12i6502",document.head);d=je(xe,"META",{name:!0,content:!0}),p=je(xe,"META",{property:!0,content:!0}),_=je(xe,"META",{property:!0,content:!0}),a=je(xe,"META",{property:!0,content:!0}),E=je(xe,"META",{property:!0,content:!0}),F=je(xe,"META",{name:!0,content:!0}),xe.forEach(ae),R=bt(de),tr(X.$$.fragment,de),ne=bt(de),tr(pe.$$.fragment,de),this.h()},h(){oe(d,"name","description"),oe(d,"content",""),oe(p,"property","og:title"),oe(p,"content",y=u[0].place.name+" Census Data"),oe(_,"property","og:type"),oe(_,"content","website"),oe(a,"property","og:url"),oe(a,"content",T=kh.base+"/"+u[0].place.code+"/"),oe(E,"property","og:description"),oe(E,"content",D="Explore NISRA Statistics for "+u[0].place.name+"."),oe(F,"name","description"),oe(F,"content",L="Explore NISRA Statistics for "+u[0].place.name+".")},m(de,xe){Ie(document.head,d),Ie(document.head,p),Ie(document.head,_),Ie(document.head,a),Ie(document.head,E),Ie(document.head,F),Le(de,R,xe),rr(X,de,xe),Le(de,ne,xe),rr(pe,de,xe),ve=!0},p(de,xe){(!ve||xe[0]&1)&&h!==(h=de[0].place.name+" NISRA Key Statistics")&&(document.title=h),(!ve||xe[0]&1&&y!==(y=de[0].place.name+" Census Data"))&&oe(p,"content",y),(!ve||xe[0]&1&&T!==(T=kh.base+"/"+de[0].place.code+"/"))&&oe(a,"content",T),(!ve||xe[0]&1&&D!==(D="Explore NISRA Statistics for "+de[0].place.name+"."))&&oe(E,"content",D),(!ve||xe[0]&1&&L!==(L="Explore NISRA Statistics for "+de[0].place.name+"."))&&oe(F,"content",L);const $e={};xe[0]&255|xe[1]&8&&($e.$$scope={dirty:xe,ctx:de}),pe.$set($e)},i(de){ve||(Qe(X.$$.fragment,de),Qe(pe.$$.fragment,de),ve=!0)},o(de){ut(X.$$.fragment,de),ut(pe.$$.fragment,de),ve=!1},d(de){ae(d),ae(p),ae(_),ae(a),ae(E),ae(F),de&&ae(R),ir(X,de),de&&ae(ne),ir(pe,de)}}}function gh(u){let h=(u*100).toFixed(1);return h<.1?"<0.1%":h+"%"}function zr(u,h){return h.meta_data.hasOwnProperty(u)?h.meta_data[u][0].year:null}function ny(u){let d=u.data.population.value[Object.keys(u.data.population.value).filter(function(p){return p!="change"}).splice(-1)].all/u.hectares;return d<.1?d="< 0.1":d=d.toFixed(1),d}function Pa(u,h){return h.type!="ni"?"Also look at  "+u+" data for <a href = '/"+h.parents[0].code+"/' data-sveltekit-noscroll>"+h.parents[0].name+" </a>":""}function Q1(u,h,d){let p,y,_,{data:a}=h,T,E,D=null,F={selected:null,type:null,childType:null,highlighted:[],hovered:null},L={};Object.keys(ns).forEach(Ne=>d(5,L[Ne]=!1,L));function R(Ne,at,Vt){const st=(xr,Vr)=>xr+Vr;let At=Ne[0],Fe=Vt[0],qt=at[0],St="perc",Ir=a.place.data[At][St][Fe],_t=a.place.data[At][St][qt],xt=a.ni.data[At][St][Fe],Re=Tp[At].map(xr=>xr.category),Dt=Tp[At].map(xr=>xr.label?xr.label:xr.category);return Re.map((xr,Vr)=>Array.isArray(xr)?{x:Dt[Vr],y:xr.map(Br=>Ir[Br]).reduce(st,0),ni:xr.map(Br=>xt[Br]).reduce(st,0),prev:xr.map(Br=>_t[Br]).reduce(st,0)}:{x:Dt[Vr],y:Ir[xr],ni:xt[xr],prev:_t[xr]})}function X(Ne,at){const Vt=Tp[at];let st=[];return Vt.forEach(At=>{let qt=Ne.filter(St=>St.category===At.category).map(St=>({group:St.group,category:At.label,perc:St.perc}));st=[...st,...qt]}),st}function ne(Ne){D&&D.fitBounds(Ne,{padding:20})}function pe(Ne){let at=JSON.parse(JSON.stringify(F)),Vt=a.place.code,st=a.place.type,At=a.place.children[0]?a.place.children.map(_t=>_t.code):[],Fe=a.place.type=="rgn"?"cty":At[0]?a.place.children[0].type:null;d(4,F.selected=Vt,F),d(4,F.type=st,F),d(4,F.childType=Fe,F),d(4,F.highlighted=At,F);let qt=Object.keys(ns),St=["fill-color","fill-opacity"],Ir=["line-color","line-width","line-opacity"];D&&(F.type!=at.type||F.childType!=at.childType)&&(qt.forEach(_t=>{let xt=_t==st||Fe&&_t==Fe?"visible":"none";D.setLayoutProperty(_t+"-fill","visibility",xt),D.setLayoutProperty(_t+"-bounds","visibility",xt),a.place.type!="ni"&&D.setLayoutProperty(_t+"-self","visibility",xt),d(5,L[_t]=_t==Fe,L)}),a.place.type!="ni"&&(St.forEach(_t=>D.setPaintProperty(st+"-fill",_t,Yi[At[0]?"fill-active":"fill-self"][_t])),Ir.forEach(_t=>{D.setPaintProperty(st+"-bounds",_t,Yi["line-active"][_t]),D.setPaintProperty(st+"-self",_t,Yi["line-self"][_t])})),Fe&&(St.forEach(_t=>D.setPaintProperty(Fe+"-fill",_t,Yi["fill-child"][_t])),Ir.forEach(_t=>D.setPaintProperty(Fe+"-bounds",_t,Yi["line-child"][_t]))))}function ve(Ne){pe(),ne(a.place.bounds)}function de(Ne){vd(`${Na}/${Ne.detail.code}/`,{noScroll:!0})}function xe(Ne){vd(`${Na}/${Ne.detail.value}/`,{noScroll:!0})}function $e(){d(2,E=T<575?1:window.getComputedStyle(grid).getPropertyValue("grid-template-columns").split(" ").length)}function ht(Ne){return Ne==1?"largest":Ne==a.place.count?"smallest":Ne+o_(Ne)+" largest"}function Pe(Ne){let Vt=Ne.replaceAll("[",".").replaceAll("]","").split("."),st=a.place.data;Vt[0]=="grouped_data_nocompare"&&(st=a.place);for(let At=0;At<Vt.length;At++)st.hasOwnProperty(Vt[At])&&(st=st[Vt[At]],Vt[At]=="perc"&&(st=st.toFixed(0)+"%"));return st}function We(Ne){return a.place.data.hasOwnProperty(Ne)?Object.keys(a.place.data[Ne].perc).slice(-1):null}function gt(Ne){let Vt=Ne.data.population.value[Object.keys(Ne.data.population.value).filter(function(qt){return qt!="change"}).splice(-1)].all/Ne.hectares,At=a.ni.data.population.value[Object.keys(a.ni.data.population.value).filter(function(qt){return qt!="change"}).splice(-1)].all/a.ni.hectares,Fe=Vt/At;return Fe.toFixed(0)=="1"?Fe='Approximately <span class = "em" style = "background-color: lightgrey">the same density level</span> as the Northern Ireland average':Fe>1?Fe='Approximately <span class = "em" style = "background-color: lightgrey">'+Fe.toFixed(0)+" times more dense</span> than the Northern Ireland average":Fe='Approximately <span class = "em" style = "background-color: lightgrey">1/'+(1/Fe).toFixed(0)+" as dense</span> as the Northern Ireland average",Fe}function Ke(Ne){D=Ne,d(3,D)}function dt(){T=this.clientWidth,d(1,T)}return u.$$set=Ne=>{"data"in Ne&&d(0,a=Ne.data)},u.$$.update=()=>{u.$$.dirty[0]&2&&T&&$e(),u.$$.dirty[0]&1&&d(7,p=a.place&&a.place.type!="ni"?"NI 2021":null),u.$$.dirty[0]&65537&&d(6,y=_?null:a.place.type!="ni"?"ni":null),u.$$.dirty[0]&1&&a.place&&ve(a.place)},d(16,_=!1),[a,T,E,D,F,L,y,p,R,X,de,xe,ht,Pe,We,gt,_,Ke,dt]}class sb extends fn{constructor(h){super(),dn(this,h,Q1,J1,mn,{data:0},null,[-1,-1])}}export{sb as component,ob as universal};
