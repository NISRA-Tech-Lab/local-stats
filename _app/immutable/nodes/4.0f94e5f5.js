import{g as i_,c as _d,a as vd,s as n_,S as a_,b as ts,d as rs}from"../chunks/navigation.68f00c40.js";import{g as In,a as kh,m as as,b as zp,c as o_,d as Yi,e as bd}from"../chunks/config.c2f456fa.js";import{S as mn,i as yn,s as gn,k as Fe,l as Ne,m as Be,h as ae,n as oe,R as Ku,b as Le,T as Xu,g as Qe,v as An,d as at,f as Pn,P as iy,o as ny,K as Fu,M as Nu,N as Uu,O as Vu,w as ju,e as cr,E as Wu,U as s_,Q as Xt,V as zr,p as Ge,W as Yn,X as Qn,C as Te,D as vi,Y as on,Z as Jn,q as Pt,r as Ct,u as Ar,y as er,z as tr,A as rr,B as ir,a as mt,c as yt,_ as Ph,G as pa,I as Hu,$ as Ol,a0 as Fl,F as xd,L as l_,a1 as u_,a2 as c_,a3 as _h,a4 as vh,a5 as bh}from"../chunks/index.baf6a862.js";import{b as Na}from"../chunks/paths.838c69ae.js";import{S as h_}from"../chunks/Section.6106804d.js";/* empty css                                                              */import{w as Ir,h as Ci}from"../chunks/singletons.7d1af716.js";async function wd(u,h){return await(await h(kh.app_json_data+u+".json")).json()}async function p_({params:u,fetch:h}){let d=u.code,p=await i_(kh.search_data,h),y={};p.forEach(E=>y[E.code]=E.name),p.forEach(E=>{E.typepl=In[E.type].pl,E.typenm=In[E.type].name,E.typestr=y[E.parent]&&E.parent==E.code?`View:  ${y[E.parent]}
        ${In[E.parent_type].name}  `:y[E.parent]&&E.parent!=E.code?`${In[E.type].name} `:""});let v=p.sort((E,M)=>E.name.localeCompare(M.name)),a=await wd("N92000002",h),T=await wd(d,h);return{search_data:v,place:T,ni:a}}const ab=Object.freeze(Object.defineProperty({__proto__:null,load:p_},Symbol.toStringTag,{value:"Module"}));var f_=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function d_(u){return u&&u.__esModule&&Object.prototype.hasOwnProperty.call(u,"default")?u.default:u}var m_={rgb2hsl:Ju,rgb2hsv:Ch,rgb2hwb:Yu,rgb2cmyk:Qu,rgb2keyword:$u,rgb2xyz:Vp,rgb2lab:jp,rgb2lch:y_,hsl2rgb:Mh,hsl2hsv:g_,hsl2hwb:__,hsl2cmyk:v_,hsl2keyword:b_,hsv2rgb:Dh,hsv2hsl:x_,hsv2hwb:w_,hsv2cmyk:S_,hsv2keyword:k_,hwb2rgb:ec,hwb2hsl:E_,hwb2hsv:T_,hwb2cmyk:z_,hwb2keyword:I_,cmyk2rgb:tc,cmyk2hsl:A_,cmyk2hsv:P_,cmyk2hwb:C_,cmyk2keyword:M_,keyword2rgb:Fs,keyword2hsl:B_,keyword2hsv:O_,keyword2hwb:F_,keyword2cmyk:N_,keyword2lab:U_,keyword2xyz:V_,xyz2rgb:ay,xyz2lab:oy,xyz2lch:D_,lab2xyz:qp,lab2rgb:sy,lab2lch:Zp,lch2lab:Gp,lch2xyz:L_,lch2rgb:R_};function Ju(u){var h=u[0]/255,d=u[1]/255,p=u[2]/255,y=Math.min(h,d,p),v=Math.max(h,d,p),a=v-y,T,E,M;return v==y?T=0:h==v?T=(d-p)/a:d==v?T=2+(p-h)/a:p==v&&(T=4+(h-d)/a),T=Math.min(T*60,360),T<0&&(T+=360),M=(y+v)/2,v==y?E=0:M<=.5?E=a/(v+y):E=a/(2-v-y),[T,E*100,M*100]}function Ch(u){var h=u[0],d=u[1],p=u[2],y=Math.min(h,d,p),v=Math.max(h,d,p),a=v-y,T,E,M;return v==0?E=0:E=a/v*1e3/10,v==y?T=0:h==v?T=(d-p)/a:d==v?T=2+(p-h)/a:p==v&&(T=4+(h-d)/a),T=Math.min(T*60,360),T<0&&(T+=360),M=v/255*1e3/10,[T,E,M]}function Yu(u){var h=u[0],d=u[1],v=u[2],p=Ju(u)[0],y=1/255*Math.min(h,Math.min(d,v)),v=1-1/255*Math.max(h,Math.max(d,v));return[p,y*100,v*100]}function Qu(u){var h=u[0]/255,d=u[1]/255,p=u[2]/255,y,v,a,T;return T=Math.min(1-h,1-d,1-p),y=(1-h-T)/(1-T)||0,v=(1-d-T)/(1-T)||0,a=(1-p-T)/(1-T)||0,[y*100,v*100,a*100,T*100]}function $u(u){return ly[JSON.stringify(u)]}function Vp(u){var h=u[0]/255,d=u[1]/255,p=u[2]/255;h=h>.04045?Math.pow((h+.055)/1.055,2.4):h/12.92,d=d>.04045?Math.pow((d+.055)/1.055,2.4):d/12.92,p=p>.04045?Math.pow((p+.055)/1.055,2.4):p/12.92;var y=h*.4124+d*.3576+p*.1805,v=h*.2126+d*.7152+p*.0722,a=h*.0193+d*.1192+p*.9505;return[y*100,v*100,a*100]}function jp(u){var h=Vp(u),d=h[0],p=h[1],y=h[2],v,a,T;return d/=95.047,p/=100,y/=108.883,d=d>.008856?Math.pow(d,1/3):7.787*d+16/116,p=p>.008856?Math.pow(p,1/3):7.787*p+16/116,y=y>.008856?Math.pow(y,1/3):7.787*y+16/116,v=116*p-16,a=500*(d-p),T=200*(p-y),[v,a,T]}function y_(u){return Zp(jp(u))}function Mh(u){var h=u[0]/360,d=u[1]/100,p=u[2]/100,y,v,a,T,E;if(d==0)return E=p*255,[E,E,E];p<.5?v=p*(1+d):v=p+d-p*d,y=2*p-v,T=[0,0,0];for(var M=0;M<3;M++)a=h+1/3*-(M-1),a<0&&a++,a>1&&a--,6*a<1?E=y+(v-y)*6*a:2*a<1?E=v:3*a<2?E=y+(v-y)*(2/3-a)*6:E=y,T[M]=E*255;return T}function g_(u){var h=u[0],d=u[1]/100,p=u[2]/100,y,v;return p===0?[0,0,0]:(p*=2,d*=p<=1?p:2-p,v=(p+d)/2,y=2*d/(p+d),[h,y*100,v*100])}function __(u){return Yu(Mh(u))}function v_(u){return Qu(Mh(u))}function b_(u){return $u(Mh(u))}function Dh(u){var h=u[0]/60,d=u[1]/100,E=u[2]/100,p=Math.floor(h)%6,y=h-Math.floor(h),v=255*E*(1-d),a=255*E*(1-d*y),T=255*E*(1-d*(1-y)),E=255*E;switch(p){case 0:return[E,T,v];case 1:return[a,E,v];case 2:return[v,E,T];case 3:return[v,a,E];case 4:return[T,v,E];case 5:return[E,v,a]}}function x_(u){var h=u[0],d=u[1]/100,p=u[2]/100,y,v;return v=(2-d)*p,y=d*p,y/=v<=1?v:2-v,y=y||0,v/=2,[h,y*100,v*100]}function w_(u){return Yu(Dh(u))}function S_(u){return Qu(Dh(u))}function k_(u){return $u(Dh(u))}function ec(u){var h=u[0]/360,d=u[1]/100,p=u[2]/100,y=d+p,v,a,T,E;switch(y>1&&(d/=y,p/=y),v=Math.floor(6*h),a=1-p,T=6*h-v,v&1&&(T=1-T),E=d+T*(a-d),v){default:case 6:case 0:r=a,g=E,b=d;break;case 1:r=E,g=a,b=d;break;case 2:r=d,g=a,b=E;break;case 3:r=d,g=E,b=a;break;case 4:r=E,g=d,b=a;break;case 5:r=a,g=d,b=E;break}return[r*255,g*255,b*255]}function E_(u){return Ju(ec(u))}function T_(u){return Ch(ec(u))}function z_(u){return Qu(ec(u))}function I_(u){return $u(ec(u))}function tc(u){var h=u[0]/100,d=u[1]/100,p=u[2]/100,y=u[3]/100,v,a,T;return v=1-Math.min(1,h*(1-y)+y),a=1-Math.min(1,d*(1-y)+y),T=1-Math.min(1,p*(1-y)+y),[v*255,a*255,T*255]}function A_(u){return Ju(tc(u))}function P_(u){return Ch(tc(u))}function C_(u){return Yu(tc(u))}function M_(u){return $u(tc(u))}function ay(u){var h=u[0]/100,d=u[1]/100,p=u[2]/100,y,v,a;return y=h*3.2406+d*-1.5372+p*-.4986,v=h*-.9689+d*1.8758+p*.0415,a=h*.0557+d*-.204+p*1.057,y=y>.0031308?1.055*Math.pow(y,1/2.4)-.055:y=y*12.92,v=v>.0031308?1.055*Math.pow(v,1/2.4)-.055:v=v*12.92,a=a>.0031308?1.055*Math.pow(a,1/2.4)-.055:a=a*12.92,y=Math.min(Math.max(0,y),1),v=Math.min(Math.max(0,v),1),a=Math.min(Math.max(0,a),1),[y*255,v*255,a*255]}function oy(u){var h=u[0],d=u[1],p=u[2],y,v,a;return h/=95.047,d/=100,p/=108.883,h=h>.008856?Math.pow(h,1/3):7.787*h+16/116,d=d>.008856?Math.pow(d,1/3):7.787*d+16/116,p=p>.008856?Math.pow(p,1/3):7.787*p+16/116,y=116*d-16,v=500*(h-d),a=200*(d-p),[y,v,a]}function D_(u){return Zp(oy(u))}function qp(u){var h=u[0],d=u[1],p=u[2],y,v,a,T;return h<=8?(v=h*100/903.3,T=7.787*(v/100)+16/116):(v=100*Math.pow((h+16)/116,3),T=Math.pow(v/100,1/3)),y=y/95.047<=.008856?y=95.047*(d/500+T-16/116)/7.787:95.047*Math.pow(d/500+T,3),a=a/108.883<=.008859?a=108.883*(T-p/200-16/116)/7.787:108.883*Math.pow(T-p/200,3),[y,v,a]}function Zp(u){var h=u[0],d=u[1],p=u[2],y,v,a;return y=Math.atan2(p,d),v=y*360/2/Math.PI,v<0&&(v+=360),a=Math.sqrt(d*d+p*p),[h,a,v]}function sy(u){return ay(qp(u))}function Gp(u){var h=u[0],d=u[1],p=u[2],y,v,a;return a=p/360*2*Math.PI,y=d*Math.cos(a),v=d*Math.sin(a),[h,y,v]}function L_(u){return qp(Gp(u))}function R_(u){return sy(Gp(u))}function Fs(u){return Lp[u]}function B_(u){return Ju(Fs(u))}function O_(u){return Ch(Fs(u))}function F_(u){return Yu(Fs(u))}function N_(u){return Qu(Fs(u))}function U_(u){return jp(Fs(u))}function V_(u){return Vp(Fs(u))}var Lp={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,134,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,250,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,221],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[112,128,144],slategrey:[112,128,144],snow:[255,250,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,50]},ly={};for(var Sd in Lp)ly[JSON.stringify(Lp[Sd])]=Sd;var Ip=m_,Ll=function(){return new rc};for(var Ru in Ip){Ll[Ru+"Raw"]=function(u){return function(h){return typeof h=="number"&&(h=Array.prototype.slice.call(arguments)),Ip[u](h)}}(Ru);var kd=/(\w+)2(\w+)/.exec(Ru),Ap=kd[1],j_=kd[2];Ll[Ap]=Ll[Ap]||{},Ll[Ap][j_]=Ll[Ru]=function(u){return function(h){typeof h=="number"&&(h=Array.prototype.slice.call(arguments));var d=Ip[u](h);if(typeof d=="string"||d===void 0)return d;for(var p=0;p<d.length;p++)d[p]=Math.round(d[p]);return d}}(Ru)}var rc=function(){this.convs={}};rc.prototype.routeSpace=function(u,h){var d=h[0];return d===void 0?this.getValues(u):(typeof d=="number"&&(d=Array.prototype.slice.call(h)),this.setValues(u,d))};rc.prototype.setValues=function(u,h){return this.space=u,this.convs={},this.convs[u]=h,this};rc.prototype.getValues=function(u){var h=this.convs[u];if(!h){var d=this.space,p=this.convs[d];h=Ll[d][u](p),this.convs[u]=h}return h};["rgb","hsl","hsv","cmyk","keyword"].forEach(function(u){rc.prototype[u]=function(h){return this.routeSpace(u,arguments)}});var uy={exports:{}};(function(u,h){(function(d,p){u.exports=p()})(f_,function(){var d,p,y;function v(a,T){if(!d)d=T;else if(!p)p=T;else{var E="var sharedChunk = {}; ("+d+")(sharedChunk); ("+p+")(sharedChunk);",M={};d(M),y=T(M),typeof window<"u"&&(y.workerUrl=window.URL.createObjectURL(new Blob([E],{type:"text/javascript"})))}}return v(["exports"],function(a){function T(e,t){return e(t={exports:{}},t.exports),t.exports}var E=M;function M(e,t,i,l){this.cx=3*e,this.bx=3*(i-e)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*t,this.by=3*(l-t)-this.cy,this.ay=1-this.cy-this.by,this.p1x=e,this.p1y=l,this.p2x=i,this.p2y=l}M.prototype.sampleCurveX=function(e){return((this.ax*e+this.bx)*e+this.cx)*e},M.prototype.sampleCurveY=function(e){return((this.ay*e+this.by)*e+this.cy)*e},M.prototype.sampleCurveDerivativeX=function(e){return(3*this.ax*e+2*this.bx)*e+this.cx},M.prototype.solveCurveX=function(e,t){var i,l,f,m,x;for(t===void 0&&(t=1e-6),f=e,x=0;x<8;x++){if(m=this.sampleCurveX(f)-e,Math.abs(m)<t)return f;var k=this.sampleCurveDerivativeX(f);if(Math.abs(k)<1e-6)break;f-=m/k}if((f=e)<(i=0))return i;if(f>(l=1))return l;for(;i<l;){if(m=this.sampleCurveX(f),Math.abs(m-e)<t)return f;e>m?i=f:l=f,f=.5*(l-i)+i}return f},M.prototype.solve=function(e,t){return this.sampleCurveY(this.solveCurveX(e,t))};var F=R;function R(e,t){this.x=e,this.y=t}R.prototype={clone:function(){return new R(this.x,this.y)},add:function(e){return this.clone()._add(e)},sub:function(e){return this.clone()._sub(e)},multByPoint:function(e){return this.clone()._multByPoint(e)},divByPoint:function(e){return this.clone()._divByPoint(e)},mult:function(e){return this.clone()._mult(e)},div:function(e){return this.clone()._div(e)},rotate:function(e){return this.clone()._rotate(e)},rotateAround:function(e,t){return this.clone()._rotateAround(e,t)},matMult:function(e){return this.clone()._matMult(e)},unit:function(){return this.clone()._unit()},perp:function(){return this.clone()._perp()},round:function(){return this.clone()._round()},mag:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals:function(e){return this.x===e.x&&this.y===e.y},dist:function(e){return Math.sqrt(this.distSqr(e))},distSqr:function(e){var t=e.x-this.x,i=e.y-this.y;return t*t+i*i},angle:function(){return Math.atan2(this.y,this.x)},angleTo:function(e){return Math.atan2(this.y-e.y,this.x-e.x)},angleWith:function(e){return this.angleWithSep(e.x,e.y)},angleWithSep:function(e,t){return Math.atan2(this.x*t-this.y*e,this.x*e+this.y*t)},_matMult:function(e){var t=e[2]*this.x+e[3]*this.y;return this.x=e[0]*this.x+e[1]*this.y,this.y=t,this},_add:function(e){return this.x+=e.x,this.y+=e.y,this},_sub:function(e){return this.x-=e.x,this.y-=e.y,this},_mult:function(e){return this.x*=e,this.y*=e,this},_div:function(e){return this.x/=e,this.y/=e,this},_multByPoint:function(e){return this.x*=e.x,this.y*=e.y,this},_divByPoint:function(e){return this.x/=e.x,this.y/=e.y,this},_unit:function(){return this._div(this.mag()),this},_perp:function(){var e=this.y;return this.y=this.x,this.x=-e,this},_rotate:function(e){var t=Math.cos(e),i=Math.sin(e),l=i*this.x+t*this.y;return this.x=t*this.x-i*this.y,this.y=l,this},_rotateAround:function(e,t){var i=Math.cos(e),l=Math.sin(e),f=t.y+l*(this.x-t.x)+i*(this.y-t.y);return this.x=t.x+i*(this.x-t.x)-l*(this.y-t.y),this.y=f,this},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}},R.convert=function(e){return e instanceof R?e:Array.isArray(e)?new R(e[0],e[1]):e};var D=typeof self<"u"?self:{},H=Math.pow(2,53)-1;function ie(e,t,i,l){var f=new E(e,t,i,l);return function(m){return f.solve(m)}}var de=ie(.25,.1,.25,1);function fe(e,t,i){return Math.min(i,Math.max(t,e))}function we(e,t,i){var l=i-t,f=((e-t)%l+l)%l+t;return f===t?i:f}function xe(e){for(var t=[],i=arguments.length-1;i-- >0;)t[i]=arguments[i+1];for(var l=0,f=t;l<f.length;l+=1){var m=f[l];for(var x in m)e[x]=m[x]}return e}var st=1;function $e(){return st++}function Me(){return function e(t){return t?(t^16*Math.random()>>t/4).toString(16):([1e7]+-[1e3]+-4e3+-8e3+-1e11).replace(/[018]/g,e)}()}function Je(e){return!!e&&/^[0-9a-f]{8}-[0-9a-f]{4}-[4][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i.test(e)}function ct(e,t){e.forEach(function(i){t[i]&&(t[i]=t[i].bind(t))})}function Ue(e,t){return e.indexOf(t,e.length-t.length)!==-1}function ht(e,t,i){var l={};for(var f in e)l[f]=t.call(i||this,e[f],f,e);return l}function _t(e,t,i){var l={};for(var f in e)t.call(i||this,e[f],f,e)&&(l[f]=e[f]);return l}function pt(e){return Array.isArray(e)?e.map(pt):typeof e=="object"&&e?ht(e,pt):e}var Nt={};function bt(e){Nt[e]||(typeof console<"u"&&console.warn(e),Nt[e]=!0)}function zt(e,t,i){return(i.y-e.y)*(t.x-e.x)>(t.y-e.y)*(i.x-e.x)}function rt(e){for(var t=0,i=0,l=e.length,f=l-1,m=void 0,x=void 0;i<l;f=i++)t+=((x=e[f]).x-(m=e[i]).x)*(m.y+x.y);return t}function Zt(){return typeof WorkerGlobalScope<"u"&&typeof self<"u"&&self instanceof WorkerGlobalScope}function gt(e){var t={};if(e.replace(/(?:^|(?:\s*\,\s*))([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)(?:\=(?:([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)|(?:\"((?:[^"\\]|\\.)*)\")))?/g,function(l,f,m,x){var k=m||x;return t[f]=!k||k.toLowerCase(),""}),t["max-age"]){var i=parseInt(t["max-age"],10);isNaN(i)?delete t["max-age"]:t["max-age"]=i}return t}var It=null;function jt(e){if(It==null){var t=e.navigator?e.navigator.userAgent:null;It=!!e.safari||!(!t||!(/\b(iPad|iPhone|iPod)\b/.test(t)||t.match("Safari")&&!t.match("Chrome")))}return It}function ei(e){try{var t=D[e];return t.setItem("_mapbox_test_",1),t.removeItem("_mapbox_test_"),!0}catch{return!1}}var We,At,mr,Tr,xr=D.performance&&D.performance.now?D.performance.now.bind(D.performance):Date.now.bind(Date),Zr=D.requestAnimationFrame||D.mozRequestAnimationFrame||D.webkitRequestAnimationFrame||D.msRequestAnimationFrame,sr=D.cancelAnimationFrame||D.mozCancelAnimationFrame||D.webkitCancelAnimationFrame||D.msCancelAnimationFrame,ti={now:xr,frame:function(e){var t=Zr(e);return{cancel:function(){return sr(t)}}},getImageData:function(e,t){t===void 0&&(t=0);var i=D.document.createElement("canvas"),l=i.getContext("2d");if(!l)throw new Error("failed to create canvas 2d context");return i.width=e.width,i.height=e.height,l.drawImage(e,0,0,e.width,e.height),l.getImageData(-t,-t,e.width+2*t,e.height+2*t)},resolveURL:function(e){return We||(We=D.document.createElement("a")),We.href=e,We.href},hardwareConcurrency:D.navigator&&D.navigator.hardwareConcurrency||4,get devicePixelRatio(){return D.devicePixelRatio},get prefersReducedMotion(){return!!D.matchMedia&&(At==null&&(At=D.matchMedia("(prefers-reduced-motion: reduce)")),At.matches)}},Wt={API_URL:"https://api.mapbox.com",get EVENTS_URL(){return this.API_URL?this.API_URL.indexOf("https://api.mapbox.cn")===0?"https://events.mapbox.cn/events/v2":this.API_URL.indexOf("https://api.mapbox.com")===0?"https://events.mapbox.com/events/v2":null:null},FEEDBACK_URL:"https://apps.mapbox.com/feedback",REQUIRE_ACCESS_TOKEN:!0,ACCESS_TOKEN:null,MAX_PARALLEL_IMAGE_REQUESTS:16},Gr={supported:!1,testSupport:function(e){!yr&&Tr&&(Nr?qt(e):mr=e)}},yr=!1,Nr=!1;function qt(e){var t=e.createTexture();e.bindTexture(e.TEXTURE_2D,t);try{if(e.texImage2D(e.TEXTURE_2D,0,e.RGBA,e.RGBA,e.UNSIGNED_BYTE,Tr),e.isContextLost())return;Gr.supported=!0}catch{}e.deleteTexture(t),yr=!0}D.document&&((Tr=D.document.createElement("img")).onload=function(){mr&&qt(mr),mr=null,Nr=!0},Tr.onerror=function(){yr=!0,mr=null},Tr.src="data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAQAAAAfQ//73v/+BiOh/AAA=");var Lr="01",Kr=function(e,t){this._transformRequestFn=e,this._customAccessToken=t,this._createSkuToken()};function hr(e){return e.indexOf("mapbox:")===0}Kr.prototype._createSkuToken=function(){var e=function(){for(var t="",i=0;i<10;i++)t+="0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ"[Math.floor(62*Math.random())];return{token:["1",Lr,t].join(""),tokenExpiresAt:Date.now()+432e5}}();this._skuToken=e.token,this._skuTokenExpiresAt=e.tokenExpiresAt},Kr.prototype._isSkuTokenExpired=function(){return Date.now()>this._skuTokenExpiresAt},Kr.prototype.transformRequest=function(e,t){return this._transformRequestFn&&this._transformRequestFn(e,t)||{url:e}},Kr.prototype.normalizeStyleURL=function(e,t){if(!hr(e))return e;var i=pi(e);return i.path="/styles/v1"+i.path,this._makeAPIURL(i,this._customAccessToken||t)},Kr.prototype.normalizeGlyphsURL=function(e,t){if(!hr(e))return e;var i=pi(e);return i.path="/fonts/v1"+i.path,this._makeAPIURL(i,this._customAccessToken||t)},Kr.prototype.normalizeSourceURL=function(e,t){if(!hr(e))return e;var i=pi(e);return i.path="/v4/"+i.authority+".json",i.params.push("secure"),this._makeAPIURL(i,this._customAccessToken||t)},Kr.prototype.normalizeSpriteURL=function(e,t,i,l){var f=pi(e);return hr(e)?(f.path="/styles/v1"+f.path+"/sprite"+t+i,this._makeAPIURL(f,this._customAccessToken||l)):(f.path+=""+t+i,Qi(f))},Kr.prototype.normalizeTileURL=function(e,t){if(this._isSkuTokenExpired()&&this._createSkuToken(),e&&!hr(e))return e;var i=pi(e);i.path=i.path.replace(/(\.(png|jpg)\d*)(?=$)/,(ti.devicePixelRatio>=2||t===512?"@2x":"")+(Gr.supported?".webp":"$1")),i.path=i.path.replace(/^.+\/v4\//,"/"),i.path="/v4"+i.path;var l=this._customAccessToken||function(f){for(var m=0,x=f;m<x.length;m+=1){var k=x[m].match(/^access_token=(.*)$/);if(k)return k[1]}return null}(i.params)||Wt.ACCESS_TOKEN;return Wt.REQUIRE_ACCESS_TOKEN&&l&&this._skuToken&&i.params.push("sku="+this._skuToken),this._makeAPIURL(i,l)},Kr.prototype.canonicalizeTileURL=function(e,t){var i=pi(e);if(!i.path.match(/(^\/v4\/)/)||!i.path.match(/\.[\w]+$/))return e;var l="mapbox://tiles/";l+=i.path.replace("/v4/","");var f=i.params;return t&&(f=f.filter(function(m){return!m.match(/^access_token=/)})),f.length&&(l+="?"+f.join("&")),l},Kr.prototype.canonicalizeTileset=function(e,t){for(var i=!!t&&hr(t),l=[],f=0,m=e.tiles||[];f<m.length;f+=1){var x=m[f];Cr(x)?l.push(this.canonicalizeTileURL(x,i)):l.push(x)}return l},Kr.prototype._makeAPIURL=function(e,t){var i="See https://www.mapbox.com/api-documentation/#access-tokens-and-token-scopes",l=pi(Wt.API_URL);if(e.protocol=l.protocol,e.authority=l.authority,e.protocol==="http"){var f=e.params.indexOf("secure");f>=0&&e.params.splice(f,1)}if(l.path!=="/"&&(e.path=""+l.path+e.path),!Wt.REQUIRE_ACCESS_TOKEN)return Qi(e);if(!(t=t||Wt.ACCESS_TOKEN))throw new Error("An API access token is required to use Mapbox GL. "+i);if(t[0]==="s")throw new Error("Use a public access token (pk.*) with Mapbox GL, not a secret access token (sk.*). "+i);return e.params=e.params.filter(function(m){return m.indexOf("access_token")===-1}),e.params.push("access_token="+t),Qi(e)};var Fi=/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/|\?|$)/i;function Cr(e){return Fi.test(e)}var bi=/^(\w+):\/\/([^/?]*)(\/[^?]+)?\??(.+)?/;function pi(e){var t=e.match(bi);if(!t)throw new Error("Unable to parse URL object");return{protocol:t[1],authority:t[2],path:t[3]||"/",params:t[4]?t[4].split("&"):[]}}function Qi(e){var t=e.params.length?"?"+e.params.join("&"):"";return e.protocol+"://"+e.authority+e.path+t}function Mi(e){if(!e)return null;var t=e.split(".");if(!t||t.length!==3)return null;try{return JSON.parse(decodeURIComponent(D.atob(t[1]).split("").map(function(i){return"%"+("00"+i.charCodeAt(0).toString(16)).slice(-2)}).join("")))}catch{return null}}var fi=function(e){this.type=e,this.anonId=null,this.eventData={},this.queue=[],this.pendingRequest=null};fi.prototype.getStorageKey=function(e){var t,i=Mi(Wt.ACCESS_TOKEN);return t=i&&i.u?D.btoa(encodeURIComponent(i.u).replace(/%([0-9A-F]{2})/g,function(l,f){return String.fromCharCode(+("0x"+f))})):Wt.ACCESS_TOKEN||"",e?"mapbox.eventData."+e+":"+t:"mapbox.eventData:"+t},fi.prototype.fetchEventData=function(){var e=ei("localStorage"),t=this.getStorageKey(),i=this.getStorageKey("uuid");if(e)try{var l=D.localStorage.getItem(t);l&&(this.eventData=JSON.parse(l));var f=D.localStorage.getItem(i);f&&(this.anonId=f)}catch{bt("Unable to read from LocalStorage")}},fi.prototype.saveEventData=function(){var e=ei("localStorage"),t=this.getStorageKey(),i=this.getStorageKey("uuid");if(e)try{D.localStorage.setItem(i,this.anonId),Object.keys(this.eventData).length>=1&&D.localStorage.setItem(t,JSON.stringify(this.eventData))}catch{bt("Unable to write to LocalStorage")}},fi.prototype.processRequests=function(e){},fi.prototype.postEvent=function(e,t,i,l){var f=this;if(Wt.EVENTS_URL){var m=pi(Wt.EVENTS_URL);m.params.push("access_token="+(l||Wt.ACCESS_TOKEN||""));var x={event:this.type,created:new Date(e).toISOString(),sdkIdentifier:"mapbox-gl-js",sdkVersion:"1.13.2",skuId:Lr,userId:this.anonId},k=t?xe(x,t):x,I={url:Qi(m),headers:{"Content-Type":"text/plain"},body:JSON.stringify([k])};this.pendingRequest=Mr(I,function(A){f.pendingRequest=null,i(A),f.saveEventData(),f.processRequests(l)})}},fi.prototype.queueRequest=function(e,t){this.queue.push(e),this.processRequests(t)};var ri,sn,di=function(e){function t(){e.call(this,"map.load"),this.success={},this.skuToken=""}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.postMapLoadEvent=function(i,l,f,m){this.skuToken=f,(Wt.EVENTS_URL&&m||Wt.ACCESS_TOKEN&&Array.isArray(i)&&i.some(function(x){return hr(x)||Cr(x)}))&&this.queueRequest({id:l,timestamp:Date.now()},m)},t.prototype.processRequests=function(i){var l=this;if(!this.pendingRequest&&this.queue.length!==0){var f=this.queue.shift(),m=f.id,x=f.timestamp;m&&this.success[m]||(this.anonId||this.fetchEventData(),Je(this.anonId)||(this.anonId=Me()),this.postEvent(x,{skuToken:this.skuToken},function(k){k||m&&(l.success[m]=!0)},i))}},t}(fi),Ur=new(function(e){function t(i){e.call(this,"appUserTurnstile"),this._customAccessToken=i}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.postTurnstileEvent=function(i,l){Wt.EVENTS_URL&&Wt.ACCESS_TOKEN&&Array.isArray(i)&&i.some(function(f){return hr(f)||Cr(f)})&&this.queueRequest(Date.now(),l)},t.prototype.processRequests=function(i){var l=this;if(!this.pendingRequest&&this.queue.length!==0){this.anonId&&this.eventData.lastSuccess&&this.eventData.tokenU||this.fetchEventData();var f=Mi(Wt.ACCESS_TOKEN),m=f?f.u:Wt.ACCESS_TOKEN,x=m!==this.eventData.tokenU;Je(this.anonId)||(this.anonId=Me(),x=!0);var k=this.queue.shift();if(this.eventData.lastSuccess){var I=new Date(this.eventData.lastSuccess),A=new Date(k),C=(k-this.eventData.lastSuccess)/864e5;x=x||C>=1||C<-1||I.getDate()!==A.getDate()}else x=!0;if(!x)return this.processRequests();this.postEvent(k,{"enabled.telemetry":!1},function(B){B||(l.eventData.lastSuccess=k,l.eventData.tokenU=m)},i)}},t}(fi)),$i=Ur.postTurnstileEvent.bind(Ur),On=new di,Ni=On.postMapLoadEvent.bind(On),Cn=500,en=50;function Mn(){D.caches&&!ri&&(ri=D.caches.open("mapbox-tiles"))}function Ui(e){var t=e.indexOf("?");return t<0?e:e.slice(0,t)}var _n,Vi=1/0;function Fn(){return _n==null&&(_n=D.OffscreenCanvas&&new D.OffscreenCanvas(1,1).getContext("2d")&&typeof D.createImageBitmap=="function"),_n}var tn={Unknown:"Unknown",Style:"Style",Source:"Source",Tile:"Tile",Glyphs:"Glyphs",SpriteImage:"SpriteImage",SpriteJSON:"SpriteJSON",Image:"Image"};typeof Object.freeze=="function"&&Object.freeze(tn);var ji=function(e){function t(i,l,f){l===401&&Cr(f)&&(i+=": you may have provided an invalid Mapbox access token. See https://www.mapbox.com/api-documentation/#access-tokens-and-token-scopes"),e.call(this,i),this.status=l,this.url=f,this.name=this.constructor.name,this.message=i}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.toString=function(){return this.name+": "+this.message+" ("+this.status+"): "+this.url},t}(Error),vn=Zt()?function(){return self.worker&&self.worker.referrer}:function(){return(D.location.protocol==="blob:"?D.parent:D).location.href},ln,un,bn=function(e,t){if(!(/^file:/.test(i=e.url)||/^file:/.test(vn())&&!/^\w+:/.test(i))){if(D.fetch&&D.Request&&D.AbortController&&D.Request.prototype.hasOwnProperty("signal"))return function(l,f){var m,x=new D.AbortController,k=new D.Request(l.url,{method:l.method||"GET",body:l.body,credentials:l.credentials,headers:l.headers,referrer:vn(),signal:x.signal}),I=!1,A=!1,C=(m=k.url).indexOf("sku=")>0&&Cr(m);l.type==="json"&&k.headers.set("Accept","application/json");var B=function(Z,Q,ee){if(!A){if(Z&&Z.message!=="SecurityError"&&bt(Z),Q&&ee)return U(Q);var ce=Date.now();D.fetch(k).then(function(ne){if(ne.ok){var me=C?ne.clone():null;return U(ne,me,ce)}return f(new ji(ne.statusText,ne.status,l.url))}).catch(function(ne){ne.code!==20&&f(new Error(ne.message))})}},U=function(Z,Q,ee){(l.type==="arrayBuffer"?Z.arrayBuffer():l.type==="json"?Z.json():Z.text()).then(function(ce){A||(Q&&ee&&function(ne,me,be){if(Mn(),ri){var Se={status:me.status,statusText:me.statusText,headers:new D.Headers};me.headers.forEach(function(Pe,Ve){return Se.headers.set(Ve,Pe)});var ze=gt(me.headers.get("Cache-Control")||"");ze["no-store"]||(ze["max-age"]&&Se.headers.set("Expires",new Date(be+1e3*ze["max-age"]).toUTCString()),new Date(Se.headers.get("Expires")).getTime()-be<42e4||function(Pe,Ve){if(sn===void 0)try{new Response(new ReadableStream),sn=!0}catch{sn=!1}sn?Ve(Pe.body):Pe.blob().then(Ve)}(me,function(Pe){var Ve=new D.Response(Pe,Se);Mn(),ri&&ri.then(function(Ye){return Ye.put(Ui(ne.url),Ve)}).catch(function(Ye){return bt(Ye.message)})}))}}(k,Q,ee),I=!0,f(null,ce,Z.headers.get("Cache-Control"),Z.headers.get("Expires")))}).catch(function(ce){A||f(new Error(ce.message))})};return C?function(Z,Q){if(Mn(),!ri)return Q(null);var ee=Ui(Z.url);ri.then(function(ce){ce.match(ee).then(function(ne){var me=function(be){if(!be)return!1;var Se=new Date(be.headers.get("Expires")||0),ze=gt(be.headers.get("Cache-Control")||"");return Se>Date.now()&&!ze["no-cache"]}(ne);ce.delete(ee),me&&ce.put(ee,ne.clone()),Q(null,ne,me)}).catch(Q)}).catch(Q)}(k,B):B(null,null),{cancel:function(){A=!0,I||x.abort()}}}(e,t);if(Zt()&&self.worker&&self.worker.actor)return self.worker.actor.send("getResource",e,t,void 0,!0)}var i;return function(l,f){var m=new D.XMLHttpRequest;for(var x in m.open(l.method||"GET",l.url,!0),l.type==="arrayBuffer"&&(m.responseType="arraybuffer"),l.headers)m.setRequestHeader(x,l.headers[x]);return l.type==="json"&&(m.responseType="text",m.setRequestHeader("Accept","application/json")),m.withCredentials=l.credentials==="include",m.onerror=function(){f(new Error(m.statusText))},m.onload=function(){if((m.status>=200&&m.status<300||m.status===0)&&m.response!==null){var k=m.response;if(l.type==="json")try{k=JSON.parse(m.response)}catch(I){return f(I)}f(null,k,m.getResponseHeader("Cache-Control"),m.getResponseHeader("Expires"))}else f(new ji(m.statusText,m.status,l.url))},m.send(l.body),{cancel:function(){return m.abort()}}}(e,t)},oi=function(e,t){return bn(xe(e,{type:"arrayBuffer"}),t)},Mr=function(e,t){return bn(xe(e,{method:"POST"}),t)},L="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAC0lEQVQYV2NgAAIAAAUAAarVyFEAAAAASUVORK5CYII=";ln=[],un=0;var N=function(e,t){if(Gr.supported&&(e.headers||(e.headers={}),e.headers.accept="image/webp,*/*"),un>=Wt.MAX_PARALLEL_IMAGE_REQUESTS){var i={requestParameters:e,callback:t,cancelled:!1,cancel:function(){this.cancelled=!0}};return ln.push(i),i}un++;var l=!1,f=function(){if(!l)for(l=!0,un--;ln.length&&un<Wt.MAX_PARALLEL_IMAGE_REQUESTS;){var x=ln.shift();x.cancelled||(x.cancel=N(x.requestParameters,x.callback).cancel)}},m=oi(e,function(x,k,I,A){f(),x?t(x):k&&(Fn()?function(C,B){var U=new D.Blob([new Uint8Array(C)],{type:"image/png"});D.createImageBitmap(U).then(function(Z){B(null,Z)}).catch(function(Z){B(new Error("Could not load image because of "+Z.message+". Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."))})}(k,t):function(C,B,U,Z){var Q=new D.Image,ee=D.URL;Q.onload=function(){B(null,Q),ee.revokeObjectURL(Q.src),Q.onload=null,D.requestAnimationFrame(function(){Q.src=L})},Q.onerror=function(){return B(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."))};var ce=new D.Blob([new Uint8Array(C)],{type:"image/png"});Q.cacheControl=U,Q.expires=Z,Q.src=C.byteLength?ee.createObjectURL(ce):L}(k,t,I,A))});return{cancel:function(){m.cancel(),f()}}};function V(e,t,i){i[e]&&i[e].indexOf(t)!==-1||(i[e]=i[e]||[],i[e].push(t))}function W(e,t,i){if(i&&i[e]){var l=i[e].indexOf(t);l!==-1&&i[e].splice(l,1)}}var $=function(e,t){t===void 0&&(t={}),xe(this,t),this.type=e},se=function(e){function t(i,l){l===void 0&&(l={}),e.call(this,"error",xe({error:i},l))}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t}($),he=function(){};he.prototype.on=function(e,t){return this._listeners=this._listeners||{},V(e,t,this._listeners),this},he.prototype.off=function(e,t){return W(e,t,this._listeners),W(e,t,this._oneTimeListeners),this},he.prototype.once=function(e,t){return this._oneTimeListeners=this._oneTimeListeners||{},V(e,t,this._oneTimeListeners),this},he.prototype.fire=function(e,t){typeof e=="string"&&(e=new $(e,t||{}));var i=e.type;if(this.listens(i)){e.target=this;for(var l=0,f=this._listeners&&this._listeners[i]?this._listeners[i].slice():[];l<f.length;l+=1)f[l].call(this,e);for(var m=0,x=this._oneTimeListeners&&this._oneTimeListeners[i]?this._oneTimeListeners[i].slice():[];m<x.length;m+=1){var k=x[m];W(i,k,this._oneTimeListeners),k.call(this,e)}var I=this._eventedParent;I&&(xe(e,typeof this._eventedParentData=="function"?this._eventedParentData():this._eventedParentData),I.fire(e))}else e instanceof se&&console.error(e.error);return this},he.prototype.listens=function(e){return this._listeners&&this._listeners[e]&&this._listeners[e].length>0||this._oneTimeListeners&&this._oneTimeListeners[e]&&this._oneTimeListeners[e].length>0||this._eventedParent&&this._eventedParent.listens(e)},he.prototype.setEventedParent=function(e,t){return this._eventedParent=e,this._eventedParentData=t,this};var j={$version:8,$root:{version:{required:!0,type:"enum",values:[8]},name:{type:"string"},metadata:{type:"*"},center:{type:"array",value:"number"},zoom:{type:"number"},bearing:{type:"number",default:0,period:360,units:"degrees"},pitch:{type:"number",default:0,units:"degrees"},light:{type:"light"},sources:{required:!0,type:"sources"},sprite:{type:"string"},glyphs:{type:"string"},transition:{type:"transition"},layers:{required:!0,type:"array",value:"layer"}},sources:{"*":{type:"source"}},source:["source_vector","source_raster","source_raster_dem","source_geojson","source_video","source_image"],source_vector:{type:{required:!0,type:"enum",values:{vector:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},attribution:{type:"string"},promoteId:{type:"promoteId"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_raster:{type:{required:!0,type:"enum",values:{raster:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},attribution:{type:"string"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_raster_dem:{type:{required:!0,type:"enum",values:{"raster-dem":{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},attribution:{type:"string"},encoding:{type:"enum",values:{terrarium:{},mapbox:{}},default:"mapbox"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_geojson:{type:{required:!0,type:"enum",values:{geojson:{}}},data:{type:"*"},maxzoom:{type:"number",default:18},attribution:{type:"string"},buffer:{type:"number",default:128,maximum:512,minimum:0},filter:{type:"*"},tolerance:{type:"number",default:.375},cluster:{type:"boolean",default:!1},clusterRadius:{type:"number",default:50,minimum:0},clusterMaxZoom:{type:"number"},clusterMinPoints:{type:"number"},clusterProperties:{type:"*"},lineMetrics:{type:"boolean",default:!1},generateId:{type:"boolean",default:!1},promoteId:{type:"promoteId"}},source_video:{type:{required:!0,type:"enum",values:{video:{}}},urls:{required:!0,type:"array",value:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},source_image:{type:{required:!0,type:"enum",values:{image:{}}},url:{required:!0,type:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},layer:{id:{type:"string",required:!0},type:{type:"enum",values:{fill:{},line:{},symbol:{},circle:{},heatmap:{},"fill-extrusion":{},raster:{},hillshade:{},background:{}},required:!0},metadata:{type:"*"},source:{type:"string"},"source-layer":{type:"string"},minzoom:{type:"number",minimum:0,maximum:24},maxzoom:{type:"number",minimum:0,maximum:24},filter:{type:"filter"},layout:{type:"layout"},paint:{type:"paint"}},layout:["layout_fill","layout_line","layout_circle","layout_heatmap","layout_fill-extrusion","layout_symbol","layout_raster","layout_hillshade","layout_background"],layout_background:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_fill:{"fill-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_circle:{"circle-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_heatmap:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},"layout_fill-extrusion":{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_line:{"line-cap":{type:"enum",values:{butt:{},round:{},square:{}},default:"butt",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-join":{type:"enum",values:{bevel:{},round:{},miter:{}},default:"miter",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"line-miter-limit":{type:"number",default:2,requires:[{"line-join":"miter"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-round-limit":{type:"number",default:1.05,requires:[{"line-join":"round"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_symbol:{"symbol-placement":{type:"enum",values:{point:{},line:{},"line-center":{}},default:"point",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-spacing":{type:"number",default:250,minimum:1,units:"pixels",requires:[{"symbol-placement":"line"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"symbol-avoid-edges":{type:"boolean",default:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"symbol-z-order":{type:"enum",values:{auto:{},"viewport-y":{},source:{}},default:"auto",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-allow-overlap":{type:"boolean",default:!1,requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-ignore-placement":{type:"boolean",default:!1,requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-optional":{type:"boolean",default:!1,requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-rotation-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-size":{type:"number",default:1,minimum:0,units:"factor of the original icon size",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-text-fit":{type:"enum",values:{none:{},width:{},height:{},both:{}},default:"none",requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-text-fit-padding":{type:"array",value:"number",length:4,default:[0,0,0,0],units:"pixels",requires:["icon-image","text-field",{"icon-text-fit":["both","width","height"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-image":{type:"resolvedImage",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-padding":{type:"number",default:2,minimum:0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-keep-upright":{type:"boolean",default:!1,requires:["icon-image",{"icon-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-offset":{type:"array",value:"number",length:2,default:[0,0],requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotation-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-field":{type:"formatted",default:"",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-font":{type:"array",value:"string",default:["Open Sans Regular","Arial Unicode MS Regular"],requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-size":{type:"number",default:16,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-width":{type:"number",default:10,minimum:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-line-height":{type:"number",default:1.2,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-letter-spacing":{type:"number",default:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-justify":{type:"enum",values:{auto:{},left:{},center:{},right:{}},default:"center",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-radial-offset":{type:"number",units:"ems",default:0,requires:["text-field"],"property-type":"data-driven",expression:{interpolated:!0,parameters:["zoom","feature"]}},"text-variable-anchor":{type:"array",value:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["text-field",{"!":"text-variable-anchor"}],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-angle":{type:"number",default:45,units:"degrees",requires:["text-field",{"symbol-placement":["line","line-center"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-writing-mode":{type:"array",value:"enum",values:{horizontal:{},vertical:{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-padding":{type:"number",default:2,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-keep-upright":{type:"boolean",default:!0,requires:["text-field",{"text-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-transform":{type:"enum",values:{none:{},uppercase:{},lowercase:{}},default:"none",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-offset":{type:"array",value:"number",units:"ems",length:2,default:[0,0],requires:["text-field",{"!":"text-radial-offset"}],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-allow-overlap":{type:"boolean",default:!1,requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-ignore-placement":{type:"boolean",default:!1,requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-optional":{type:"boolean",default:!1,requires:["text-field","icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_raster:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_hillshade:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},filter:{type:"array",value:"*"},filter_operator:{type:"enum",values:{"==":{},"!=":{},">":{},">=":{},"<":{},"<=":{},in:{},"!in":{},all:{},any:{},none:{},has:{},"!has":{},within:{}}},geometry_type:{type:"enum",values:{Point:{},LineString:{},Polygon:{}}},function:{expression:{type:"expression"},stops:{type:"array",value:"function_stop"},base:{type:"number",default:1,minimum:0},property:{type:"string",default:"$zoom"},type:{type:"enum",values:{identity:{},exponential:{},interval:{},categorical:{}},default:"exponential"},colorSpace:{type:"enum",values:{rgb:{},lab:{},hcl:{}},default:"rgb"},default:{type:"*",required:!1}},function_stop:{type:"array",minimum:0,maximum:24,value:["number","color"],length:2},expression:{type:"array",value:"*",minimum:1},light:{anchor:{type:"enum",default:"viewport",values:{map:{},viewport:{}},"property-type":"data-constant",transition:!1,expression:{interpolated:!1,parameters:["zoom"]}},position:{type:"array",default:[1.15,210,30],length:3,value:"number","property-type":"data-constant",transition:!0,expression:{interpolated:!0,parameters:["zoom"]}},color:{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},intensity:{type:"number","property-type":"data-constant",default:.5,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0}},paint:["paint_fill","paint_line","paint_circle","paint_heatmap","paint_fill-extrusion","paint_symbol","paint_raster","paint_hillshade","paint_background"],paint_fill:{"fill-antialias":{type:"boolean",default:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-outline-color":{type:"color",transition:!0,requires:[{"!":"fill-pattern"},{"fill-antialias":!0}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"}},"paint_fill-extrusion":{"fill-extrusion-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-extrusion-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-extrusion-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"fill-extrusion-height":{type:"number",default:0,minimum:0,units:"meters",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-base":{type:"number",default:0,minimum:0,units:"meters",transition:!0,requires:["fill-extrusion-height"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-vertical-gradient":{type:"boolean",default:!0,transition:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_line:{"line-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"line-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["line-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-width":{type:"number",default:1,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-gap-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-offset":{type:"number",default:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-dasharray":{type:"array",value:"number",minimum:0,transition:!0,units:"line widths",requires:[{"!":"line-pattern"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"line-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"line-gradient":{type:"color",transition:!1,requires:[{"!":"line-dasharray"},{"!":"line-pattern"},{source:"geojson",has:{lineMetrics:!0}}],expression:{interpolated:!0,parameters:["line-progress"]},"property-type":"color-ramp"}},paint_circle:{"circle-radius":{type:"number",default:5,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-blur":{type:"number",default:0,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"circle-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["circle-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-scale":{type:"enum",values:{map:{},viewport:{}},default:"map",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-alignment":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-stroke-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"}},paint_heatmap:{"heatmap-radius":{type:"number",default:30,minimum:1,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-weight":{type:"number",default:1,minimum:0,transition:!1,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-intensity":{type:"number",default:1,minimum:0,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"heatmap-color":{type:"color",default:["interpolate",["linear"],["heatmap-density"],0,"rgba(0, 0, 255, 0)",.1,"royalblue",.3,"cyan",.5,"lime",.7,"yellow",1,"red"],transition:!1,expression:{interpolated:!0,parameters:["heatmap-density"]},"property-type":"color-ramp"},"heatmap-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_symbol:{"icon-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-color":{type:"color",default:"#000000",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["icon-image","icon-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-color":{type:"color",default:"#000000",transition:!0,overridable:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["text-field","text-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_raster:{"raster-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-hue-rotate":{type:"number",default:0,period:360,transition:!0,units:"degrees",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-min":{type:"number",default:0,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-max":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-saturation":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-contrast":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-resampling":{type:"enum",values:{linear:{},nearest:{}},default:"linear",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"raster-fade-duration":{type:"number",default:300,minimum:0,transition:!1,units:"milliseconds",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_hillshade:{"hillshade-illumination-direction":{type:"number",default:335,minimum:0,maximum:359,transition:!1,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-illumination-anchor":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-exaggeration":{type:"number",default:.5,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-shadow-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-highlight-color":{type:"color",default:"#FFFFFF",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-accent-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_background:{"background-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"background-pattern"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"background-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"background-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},transition:{duration:{type:"number",default:300,minimum:0,units:"milliseconds"},delay:{type:"number",default:0,minimum:0,units:"milliseconds"}},"property-type":{"data-driven":{type:"property-type"},"cross-faded":{type:"property-type"},"cross-faded-data-driven":{type:"property-type"},"color-ramp":{type:"property-type"},"data-constant":{type:"property-type"},constant:{type:"property-type"}},promoteId:{"*":{type:"string"}}},J=function(e,t,i,l){this.message=(e?e+": ":"")+i,l&&(this.identifier=l),t!=null&&t.__line__&&(this.line=t.__line__)};function ge(e){var t=e.value;return t?[new J(e.key,t,"constants have been deprecated as of v8")]:[]}function Ce(e){for(var t=[],i=arguments.length-1;i-- >0;)t[i]=arguments[i+1];for(var l=0,f=t;l<f.length;l+=1){var m=f[l];for(var x in m)e[x]=m[x]}return e}function De(e){return e instanceof Number||e instanceof String||e instanceof Boolean?e.valueOf():e}function q(e){if(Array.isArray(e))return e.map(q);if(e instanceof Object&&!(e instanceof Number||e instanceof String||e instanceof Boolean)){var t={};for(var i in e)t[i]=q(e[i]);return t}return De(e)}var _e=function(e){function t(i,l){e.call(this,l),this.message=l,this.key=i}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t}(Error),tt=function(e,t){t===void 0&&(t=[]),this.parent=e,this.bindings={};for(var i=0,l=t;i<l.length;i+=1){var f=l[i];this.bindings[f[0]]=f[1]}};tt.prototype.concat=function(e){return new tt(this,e)},tt.prototype.get=function(e){if(this.bindings[e])return this.bindings[e];if(this.parent)return this.parent.get(e);throw new Error(e+" not found in scope.")},tt.prototype.has=function(e){return!!this.bindings[e]||!!this.parent&&this.parent.has(e)};var He={kind:"null"},ke={kind:"number"},Xe={kind:"string"},Oe={kind:"boolean"},qe={kind:"color"},Mt={kind:"object"},je={kind:"value"},Vt={kind:"collator"},lr={kind:"formatted"},Dt={kind:"resolvedImage"};function nr(e,t){return{kind:"array",itemType:e,N:t}}function Jt(e){if(e.kind==="array"){var t=Jt(e.itemType);return typeof e.N=="number"?"array<"+t+", "+e.N+">":e.itemType.kind==="value"?"array":"array<"+t+">"}return e.kind}var ii=[He,ke,Xe,Oe,qe,lr,Mt,nr(je),Dt];function $t(e,t){if(t.kind==="error")return null;if(e.kind==="array"){if(t.kind==="array"&&(t.N===0&&t.itemType.kind==="value"||!$t(e.itemType,t.itemType))&&(typeof e.N!="number"||e.N===t.N))return null}else{if(e.kind===t.kind)return null;if(e.kind==="value"){for(var i=0,l=ii;i<l.length;i+=1)if(!$t(l[i],t))return null}}return"Expected "+Jt(e)+" but found "+Jt(t)+" instead."}function br(e,t){return t.some(function(i){return i.kind===e.kind})}function fr(e,t){return t.some(function(i){return i==="null"?e===null:i==="array"?Array.isArray(e):i==="object"?e&&!Array.isArray(e)&&typeof e=="object":i===typeof e})}var Gt=T(function(e,t){var i={transparent:[0,0,0,0],aliceblue:[240,248,255,1],antiquewhite:[250,235,215,1],aqua:[0,255,255,1],aquamarine:[127,255,212,1],azure:[240,255,255,1],beige:[245,245,220,1],bisque:[255,228,196,1],black:[0,0,0,1],blanchedalmond:[255,235,205,1],blue:[0,0,255,1],blueviolet:[138,43,226,1],brown:[165,42,42,1],burlywood:[222,184,135,1],cadetblue:[95,158,160,1],chartreuse:[127,255,0,1],chocolate:[210,105,30,1],coral:[255,127,80,1],cornflowerblue:[100,149,237,1],cornsilk:[255,248,220,1],crimson:[220,20,60,1],cyan:[0,255,255,1],darkblue:[0,0,139,1],darkcyan:[0,139,139,1],darkgoldenrod:[184,134,11,1],darkgray:[169,169,169,1],darkgreen:[0,100,0,1],darkgrey:[169,169,169,1],darkkhaki:[189,183,107,1],darkmagenta:[139,0,139,1],darkolivegreen:[85,107,47,1],darkorange:[255,140,0,1],darkorchid:[153,50,204,1],darkred:[139,0,0,1],darksalmon:[233,150,122,1],darkseagreen:[143,188,143,1],darkslateblue:[72,61,139,1],darkslategray:[47,79,79,1],darkslategrey:[47,79,79,1],darkturquoise:[0,206,209,1],darkviolet:[148,0,211,1],deeppink:[255,20,147,1],deepskyblue:[0,191,255,1],dimgray:[105,105,105,1],dimgrey:[105,105,105,1],dodgerblue:[30,144,255,1],firebrick:[178,34,34,1],floralwhite:[255,250,240,1],forestgreen:[34,139,34,1],fuchsia:[255,0,255,1],gainsboro:[220,220,220,1],ghostwhite:[248,248,255,1],gold:[255,215,0,1],goldenrod:[218,165,32,1],gray:[128,128,128,1],green:[0,128,0,1],greenyellow:[173,255,47,1],grey:[128,128,128,1],honeydew:[240,255,240,1],hotpink:[255,105,180,1],indianred:[205,92,92,1],indigo:[75,0,130,1],ivory:[255,255,240,1],khaki:[240,230,140,1],lavender:[230,230,250,1],lavenderblush:[255,240,245,1],lawngreen:[124,252,0,1],lemonchiffon:[255,250,205,1],lightblue:[173,216,230,1],lightcoral:[240,128,128,1],lightcyan:[224,255,255,1],lightgoldenrodyellow:[250,250,210,1],lightgray:[211,211,211,1],lightgreen:[144,238,144,1],lightgrey:[211,211,211,1],lightpink:[255,182,193,1],lightsalmon:[255,160,122,1],lightseagreen:[32,178,170,1],lightskyblue:[135,206,250,1],lightslategray:[119,136,153,1],lightslategrey:[119,136,153,1],lightsteelblue:[176,196,222,1],lightyellow:[255,255,224,1],lime:[0,255,0,1],limegreen:[50,205,50,1],linen:[250,240,230,1],magenta:[255,0,255,1],maroon:[128,0,0,1],mediumaquamarine:[102,205,170,1],mediumblue:[0,0,205,1],mediumorchid:[186,85,211,1],mediumpurple:[147,112,219,1],mediumseagreen:[60,179,113,1],mediumslateblue:[123,104,238,1],mediumspringgreen:[0,250,154,1],mediumturquoise:[72,209,204,1],mediumvioletred:[199,21,133,1],midnightblue:[25,25,112,1],mintcream:[245,255,250,1],mistyrose:[255,228,225,1],moccasin:[255,228,181,1],navajowhite:[255,222,173,1],navy:[0,0,128,1],oldlace:[253,245,230,1],olive:[128,128,0,1],olivedrab:[107,142,35,1],orange:[255,165,0,1],orangered:[255,69,0,1],orchid:[218,112,214,1],palegoldenrod:[238,232,170,1],palegreen:[152,251,152,1],paleturquoise:[175,238,238,1],palevioletred:[219,112,147,1],papayawhip:[255,239,213,1],peachpuff:[255,218,185,1],peru:[205,133,63,1],pink:[255,192,203,1],plum:[221,160,221,1],powderblue:[176,224,230,1],purple:[128,0,128,1],rebeccapurple:[102,51,153,1],red:[255,0,0,1],rosybrown:[188,143,143,1],royalblue:[65,105,225,1],saddlebrown:[139,69,19,1],salmon:[250,128,114,1],sandybrown:[244,164,96,1],seagreen:[46,139,87,1],seashell:[255,245,238,1],sienna:[160,82,45,1],silver:[192,192,192,1],skyblue:[135,206,235,1],slateblue:[106,90,205,1],slategray:[112,128,144,1],slategrey:[112,128,144,1],snow:[255,250,250,1],springgreen:[0,255,127,1],steelblue:[70,130,180,1],tan:[210,180,140,1],teal:[0,128,128,1],thistle:[216,191,216,1],tomato:[255,99,71,1],turquoise:[64,224,208,1],violet:[238,130,238,1],wheat:[245,222,179,1],white:[255,255,255,1],whitesmoke:[245,245,245,1],yellow:[255,255,0,1],yellowgreen:[154,205,50,1]};function l(k){return(k=Math.round(k))<0?0:k>255?255:k}function f(k){return l(k[k.length-1]==="%"?parseFloat(k)/100*255:parseInt(k))}function m(k){return(I=k[k.length-1]==="%"?parseFloat(k)/100:parseFloat(k))<0?0:I>1?1:I;var I}function x(k,I,A){return A<0?A+=1:A>1&&(A-=1),6*A<1?k+(I-k)*A*6:2*A<1?I:3*A<2?k+(I-k)*(2/3-A)*6:k}try{t.parseCSSColor=function(k){var I,A=k.replace(/ /g,"").toLowerCase();if(A in i)return i[A].slice();if(A[0]==="#")return A.length===4?(I=parseInt(A.substr(1),16))>=0&&I<=4095?[(3840&I)>>4|(3840&I)>>8,240&I|(240&I)>>4,15&I|(15&I)<<4,1]:null:A.length===7&&(I=parseInt(A.substr(1),16))>=0&&I<=16777215?[(16711680&I)>>16,(65280&I)>>8,255&I,1]:null;var C=A.indexOf("("),B=A.indexOf(")");if(C!==-1&&B+1===A.length){var U=A.substr(0,C),Z=A.substr(C+1,B-(C+1)).split(","),Q=1;switch(U){case"rgba":if(Z.length!==4)return null;Q=m(Z.pop());case"rgb":return Z.length!==3?null:[f(Z[0]),f(Z[1]),f(Z[2]),Q];case"hsla":if(Z.length!==4)return null;Q=m(Z.pop());case"hsl":if(Z.length!==3)return null;var ee=(parseFloat(Z[0])%360+360)%360/360,ce=m(Z[1]),ne=m(Z[2]),me=ne<=.5?ne*(ce+1):ne+ce-ne*ce,be=2*ne-me;return[l(255*x(be,me,ee+1/3)),l(255*x(be,me,ee)),l(255*x(be,me,ee-1/3)),Q];default:return null}}return null}}catch{}}).parseCSSColor,ar=function(e,t,i,l){l===void 0&&(l=1),this.r=e,this.g=t,this.b=i,this.a=l};ar.parse=function(e){if(e){if(e instanceof ar)return e;if(typeof e=="string"){var t=Gt(e);if(t)return new ar(t[0]/255*t[3],t[1]/255*t[3],t[2]/255*t[3],t[3])}}},ar.prototype.toString=function(){var e=this.toArray(),t=e[1],i=e[2],l=e[3];return"rgba("+Math.round(e[0])+","+Math.round(t)+","+Math.round(i)+","+l+")"},ar.prototype.toArray=function(){var e=this.a;return e===0?[0,0,0,0]:[255*this.r/e,255*this.g/e,255*this.b/e,e]},ar.black=new ar(0,0,0,1),ar.white=new ar(1,1,1,1),ar.transparent=new ar(0,0,0,0),ar.red=new ar(1,0,0,1);var si=function(e,t,i){this.sensitivity=e?t?"variant":"case":t?"accent":"base",this.locale=i,this.collator=new Intl.Collator(this.locale?this.locale:[],{sensitivity:this.sensitivity,usage:"search"})};si.prototype.compare=function(e,t){return this.collator.compare(e,t)},si.prototype.resolvedLocale=function(){return new Intl.Collator(this.locale?this.locale:[]).resolvedOptions().locale};var Nn=function(e,t,i,l,f){this.text=e,this.image=t,this.scale=i,this.fontStack=l,this.textColor=f},wr=function(e){this.sections=e};wr.fromString=function(e){return new wr([new Nn(e,null,null,null,null)])},wr.prototype.isEmpty=function(){return this.sections.length===0||!this.sections.some(function(e){return e.text.length!==0||e.image&&e.image.name.length!==0})},wr.factory=function(e){return e instanceof wr?e:wr.fromString(e)},wr.prototype.toString=function(){return this.sections.length===0?"":this.sections.map(function(e){return e.text}).join("")},wr.prototype.serialize=function(){for(var e=["format"],t=0,i=this.sections;t<i.length;t+=1){var l=i[t];if(l.image)e.push(["image",l.image.name]);else{e.push(l.text);var f={};l.fontStack&&(f["text-font"]=["literal",l.fontStack.split(",")]),l.scale&&(f["font-scale"]=l.scale),l.textColor&&(f["text-color"]=["rgba"].concat(l.textColor.toArray())),e.push(f)}}return e};var Di=function(e){this.name=e.name,this.available=e.available};function Ua(e,t,i,l){return typeof e=="number"&&e>=0&&e<=255&&typeof t=="number"&&t>=0&&t<=255&&typeof i=="number"&&i>=0&&i<=255?l===void 0||typeof l=="number"&&l>=0&&l<=1?null:"Invalid rgba value ["+[e,t,i,l].join(", ")+"]: 'a' must be between 0 and 1.":"Invalid rgba value ["+(typeof l=="number"?[e,t,i,l]:[e,t,i]).join(", ")+"]: 'r', 'g', and 'b' must be between 0 and 255."}function va(e){if(e===null||typeof e=="string"||typeof e=="boolean"||typeof e=="number"||e instanceof ar||e instanceof si||e instanceof wr||e instanceof Di)return!0;if(Array.isArray(e)){for(var t=0,i=e;t<i.length;t+=1)if(!va(i[t]))return!1;return!0}if(typeof e=="object"){for(var l in e)if(!va(e[l]))return!1;return!0}return!1}function Xr(e){if(e===null)return He;if(typeof e=="string")return Xe;if(typeof e=="boolean")return Oe;if(typeof e=="number")return ke;if(e instanceof ar)return qe;if(e instanceof si)return Vt;if(e instanceof wr)return lr;if(e instanceof Di)return Dt;if(Array.isArray(e)){for(var t,i=e.length,l=0,f=e;l<f.length;l+=1){var m=Xr(f[l]);if(t){if(t===m)continue;t=je;break}t=m}return nr(t||je,i)}return Mt}function ba(e){var t=typeof e;return e===null?"":t==="string"||t==="number"||t==="boolean"?String(e):e instanceof ar||e instanceof wr||e instanceof Di?e.toString():JSON.stringify(e)}Di.prototype.toString=function(){return this.name},Di.fromString=function(e){return e?new Di({name:e,available:!1}):null},Di.prototype.serialize=function(){return["image",this.name]};var ki=function(e,t){this.type=e,this.value=t};ki.parse=function(e,t){if(e.length!==2)return t.error("'literal' expression requires exactly one argument, but found "+(e.length-1)+" instead.");if(!va(e[1]))return t.error("invalid value");var i=e[1],l=Xr(i),f=t.expectedType;return l.kind!=="array"||l.N!==0||!f||f.kind!=="array"||typeof f.N=="number"&&f.N!==0||(l=f),new ki(l,i)},ki.prototype.evaluate=function(){return this.value},ki.prototype.eachChild=function(){},ki.prototype.outputDefined=function(){return!0},ki.prototype.serialize=function(){return this.type.kind==="array"||this.type.kind==="object"?["literal",this.value]:this.value instanceof ar?["rgba"].concat(this.value.toArray()):this.value instanceof wr?this.value.serialize():this.value};var li=function(e){this.name="ExpressionEvaluationError",this.message=e};li.prototype.toJSON=function(){return this.message};var cn={string:Xe,number:ke,boolean:Oe,object:Mt},Rr=function(e,t){this.type=e,this.args=t};Rr.parse=function(e,t){if(e.length<2)return t.error("Expected at least one argument.");var i,l=1,f=e[0];if(f==="array"){var m,x;if(e.length>2){var k=e[1];if(typeof k!="string"||!(k in cn)||k==="object")return t.error('The item type argument of "array" must be one of string, number, boolean',1);m=cn[k],l++}else m=je;if(e.length>3){if(e[2]!==null&&(typeof e[2]!="number"||e[2]<0||e[2]!==Math.floor(e[2])))return t.error('The length argument to "array" must be a positive integer literal',2);x=e[2],l++}i=nr(m,x)}else i=cn[f];for(var I=[];l<e.length;l++){var A=t.parse(e[l],l,je);if(!A)return null;I.push(A)}return new Rr(i,I)},Rr.prototype.evaluate=function(e){for(var t=0;t<this.args.length;t++){var i=this.args[t].evaluate(e);if(!$t(this.type,Xr(i)))return i;if(t===this.args.length-1)throw new li("Expected value to be of type "+Jt(this.type)+", but found "+Jt(Xr(i))+" instead.")}return null},Rr.prototype.eachChild=function(e){this.args.forEach(e)},Rr.prototype.outputDefined=function(){return this.args.every(function(e){return e.outputDefined()})},Rr.prototype.serialize=function(){var e=this.type,t=[e.kind];if(e.kind==="array"){var i=e.itemType;if(i.kind==="string"||i.kind==="number"||i.kind==="boolean"){t.push(i.kind);var l=e.N;(typeof l=="number"||this.args.length>1)&&t.push(l)}}return t.concat(this.args.map(function(f){return f.serialize()}))};var Un=function(e){this.type=lr,this.sections=e};Un.parse=function(e,t){if(e.length<2)return t.error("Expected at least one argument.");var i=e[1];if(!Array.isArray(i)&&typeof i=="object")return t.error("First argument must be an image or text section.");for(var l=[],f=!1,m=1;m<=e.length-1;++m){var x=e[m];if(f&&typeof x=="object"&&!Array.isArray(x)){f=!1;var k=null;if(x["font-scale"]&&!(k=t.parse(x["font-scale"],1,ke)))return null;var I=null;if(x["text-font"]&&!(I=t.parse(x["text-font"],1,nr(Xe))))return null;var A=null;if(x["text-color"]&&!(A=t.parse(x["text-color"],1,qe)))return null;var C=l[l.length-1];C.scale=k,C.font=I,C.textColor=A}else{var B=t.parse(e[m],1,je);if(!B)return null;var U=B.type.kind;if(U!=="string"&&U!=="value"&&U!=="null"&&U!=="resolvedImage")return t.error("Formatted text type must be 'string', 'value', 'image' or 'null'.");f=!0,l.push({content:B,scale:null,font:null,textColor:null})}}return new Un(l)},Un.prototype.evaluate=function(e){return new wr(this.sections.map(function(t){var i=t.content.evaluate(e);return Xr(i)===Dt?new Nn("",i,null,null,null):new Nn(ba(i),null,t.scale?t.scale.evaluate(e):null,t.font?t.font.evaluate(e).join(","):null,t.textColor?t.textColor.evaluate(e):null)}))},Un.prototype.eachChild=function(e){for(var t=0,i=this.sections;t<i.length;t+=1){var l=i[t];e(l.content),l.scale&&e(l.scale),l.font&&e(l.font),l.textColor&&e(l.textColor)}},Un.prototype.outputDefined=function(){return!1},Un.prototype.serialize=function(){for(var e=["format"],t=0,i=this.sections;t<i.length;t+=1){var l=i[t];e.push(l.content.serialize());var f={};l.scale&&(f["font-scale"]=l.scale.serialize()),l.font&&(f["text-font"]=l.font.serialize()),l.textColor&&(f["text-color"]=l.textColor.serialize()),e.push(f)}return e};var xn=function(e){this.type=Dt,this.input=e};xn.parse=function(e,t){if(e.length!==2)return t.error("Expected two arguments.");var i=t.parse(e[1],1,Xe);return i?new xn(i):t.error("No image name provided.")},xn.prototype.evaluate=function(e){var t=this.input.evaluate(e),i=Di.fromString(t);return i&&e.availableImages&&(i.available=e.availableImages.indexOf(t)>-1),i},xn.prototype.eachChild=function(e){e(this.input)},xn.prototype.outputDefined=function(){return!1},xn.prototype.serialize=function(){return["image",this.input.serialize()]};var os={"to-boolean":Oe,"to-color":qe,"to-number":ke,"to-string":Xe},Ei=function(e,t){this.type=e,this.args=t};Ei.parse=function(e,t){if(e.length<2)return t.error("Expected at least one argument.");var i=e[0];if((i==="to-boolean"||i==="to-string")&&e.length!==2)return t.error("Expected one argument.");for(var l=os[i],f=[],m=1;m<e.length;m++){var x=t.parse(e[m],m,je);if(!x)return null;f.push(x)}return new Ei(l,f)},Ei.prototype.evaluate=function(e){if(this.type.kind==="boolean")return!!this.args[0].evaluate(e);if(this.type.kind==="color"){for(var t,i,l=0,f=this.args;l<f.length;l+=1){if(i=null,(t=f[l].evaluate(e))instanceof ar)return t;if(typeof t=="string"){var m=e.parseColor(t);if(m)return m}else if(Array.isArray(t)&&!(i=t.length<3||t.length>4?"Invalid rbga value "+JSON.stringify(t)+": expected an array containing either three or four numeric values.":Ua(t[0],t[1],t[2],t[3])))return new ar(t[0]/255,t[1]/255,t[2]/255,t[3])}throw new li(i||"Could not parse color from value '"+(typeof t=="string"?t:String(JSON.stringify(t)))+"'")}if(this.type.kind==="number"){for(var x=null,k=0,I=this.args;k<I.length;k+=1){if((x=I[k].evaluate(e))===null)return 0;var A=Number(x);if(!isNaN(A))return A}throw new li("Could not convert "+JSON.stringify(x)+" to number.")}return this.type.kind==="formatted"?wr.fromString(ba(this.args[0].evaluate(e))):this.type.kind==="resolvedImage"?Di.fromString(ba(this.args[0].evaluate(e))):ba(this.args[0].evaluate(e))},Ei.prototype.eachChild=function(e){this.args.forEach(e)},Ei.prototype.outputDefined=function(){return this.args.every(function(e){return e.outputDefined()})},Ei.prototype.serialize=function(){if(this.type.kind==="formatted")return new Un([{content:this.args[0],scale:null,font:null,textColor:null}]).serialize();if(this.type.kind==="resolvedImage")return new xn(this.args[0]).serialize();var e=["to-"+this.type.kind];return this.eachChild(function(t){e.push(t.serialize())}),e};var xa=["Unknown","Point","LineString","Polygon"],qi=function(){this.globals=null,this.feature=null,this.featureState=null,this.formattedSection=null,this._parseColorCache={},this.availableImages=null,this.canonical=null};qi.prototype.id=function(){return this.feature&&"id"in this.feature?this.feature.id:null},qi.prototype.geometryType=function(){return this.feature?typeof this.feature.type=="number"?xa[this.feature.type]:this.feature.type:null},qi.prototype.geometry=function(){return this.feature&&"geometry"in this.feature?this.feature.geometry:null},qi.prototype.canonicalID=function(){return this.canonical},qi.prototype.properties=function(){return this.feature&&this.feature.properties||{}},qi.prototype.parseColor=function(e){var t=this._parseColorCache[e];return t||(t=this._parseColorCache[e]=ar.parse(e)),t};var Ti=function(e,t,i,l){this.name=e,this.type=t,this._evaluate=i,this.args=l};Ti.prototype.evaluate=function(e){return this._evaluate(e,this.args)},Ti.prototype.eachChild=function(e){this.args.forEach(e)},Ti.prototype.outputDefined=function(){return!1},Ti.prototype.serialize=function(){return[this.name].concat(this.args.map(function(e){return e.serialize()}))},Ti.parse=function(e,t){var i,l=e[0],f=Ti.definitions[l];if(!f)return t.error('Unknown expression "'+l+'". If you wanted a literal array, use ["literal", [...]].',0);for(var m=Array.isArray(f)?f[0]:f.type,x=Array.isArray(f)?[[f[1],f[2]]]:f.overloads,k=x.filter(function(St){var nt=St[0];return!Array.isArray(nt)||nt.length===e.length-1}),I=null,A=0,C=k;A<C.length;A+=1){var B=C[A],U=B[0],Z=B[1];I=new Wr(t.registry,t.path,null,t.scope);for(var Q=[],ee=!1,ce=1;ce<e.length;ce++){var ne=e[ce],me=Array.isArray(U)?U[ce-1]:U.type,be=I.parse(ne,1+Q.length,me);if(!be){ee=!0;break}Q.push(be)}if(!ee)if(Array.isArray(U)&&U.length!==Q.length)I.error("Expected "+U.length+" arguments, but found "+Q.length+" instead.");else{for(var Se=0;Se<Q.length;Se++){var ze=Array.isArray(U)?U[Se]:U.type,Pe=Q[Se];I.concat(Se+1).checkSubtype(ze,Pe.type)}if(I.errors.length===0)return new Ti(l,m,Z,Q)}}if(k.length===1)(i=t.errors).push.apply(i,I.errors);else{for(var Ve=(k.length?k:x).map(function(St){var nt;return nt=St[0],Array.isArray(nt)?"("+nt.map(Jt).join(", ")+")":"("+Jt(nt.type)+"...)"}).join(" | "),Ye=[],vt=1;vt<e.length;vt++){var it=t.parse(e[vt],1+Ye.length);if(!it)return null;Ye.push(Jt(it.type))}t.error("Expected arguments of type "+Ve+", but found ("+Ye.join(", ")+") instead.")}return null},Ti.register=function(e,t){for(var i in Ti.definitions=t,t)e[i]=Ti};var $n=function(e,t,i){this.type=Vt,this.locale=i,this.caseSensitive=e,this.diacriticSensitive=t};function Zi(e,t){e[0]=Math.min(e[0],t[0]),e[1]=Math.min(e[1],t[1]),e[2]=Math.max(e[2],t[0]),e[3]=Math.max(e[3],t[1])}function wa(e,t){return!(e[0]<=t[0]||e[2]>=t[2]||e[1]<=t[1]||e[3]>=t[3])}function ss(e,t){var i=(180+e[0])/360,l=(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+e[1]*Math.PI/360)))/360,f=Math.pow(2,t.z);return[Math.round(i*f*8192),Math.round(l*f*8192)]}function Nl(e,t,i){return t[1]>e[1]!=i[1]>e[1]&&e[0]<(i[0]-t[0])*(e[1]-t[1])/(i[1]-t[1])+t[0]}function co(e,t){for(var i,l,f,m,x,k,I,A=!1,C=0,B=t.length;C<B;C++)for(var U=t[C],Z=0,Q=U.length;Z<Q-1;Z++){if((m=(i=e)[0]-(l=U[Z])[0])*(I=i[1]-(f=U[Z+1])[1])-(k=i[0]-f[0])*(x=i[1]-l[1])==0&&m*k<=0&&x*I<=0)return!1;Nl(e,U[Z],U[Z+1])&&(A=!A)}return A}function Ul(e,t){for(var i=0;i<t.length;i++)if(co(e,t[i]))return!0;return!1}function Bo(e,t,i,l){var f=l[0]-i[0],m=l[1]-i[1],x=(e[0]-i[0])*m-f*(e[1]-i[1]),k=(t[0]-i[0])*m-f*(t[1]-i[1]);return x>0&&k<0||x<0&&k>0}function Vl(e,t,i){for(var l=0,f=i;l<f.length;l+=1)for(var m=f[l],x=0;x<m.length-1;++x)if((B=[(C=m[x+1])[0]-(A=m[x])[0],C[1]-A[1]])[0]*(U=[(I=t)[0]-(k=e)[0],I[1]-k[1]])[1]-B[1]*U[0]!=0&&Bo(k,I,A,C)&&Bo(A,C,k,I))return!0;var k,I,A,C,B,U;return!1}function Oo(e,t){for(var i=0;i<e.length;++i)if(!co(e[i],t))return!1;for(var l=0;l<e.length-1;++l)if(Vl(e[l],e[l+1],t))return!1;return!0}function Ns(e,t){for(var i=0;i<t.length;i++)if(Oo(e,t[i]))return!0;return!1}function Va(e,t,i){for(var l=[],f=0;f<e.length;f++){for(var m=[],x=0;x<e[f].length;x++){var k=ss(e[f][x],i);Zi(t,k),m.push(k)}l.push(m)}return l}function ls(e,t,i){for(var l=[],f=0;f<e.length;f++){var m=Va(e[f],t,i);l.push(m)}return l}function ho(e,t,i,l){if(e[0]<i[0]||e[0]>i[2]){var f=.5*l,m=e[0]-i[0]>f?-l:i[0]-e[0]>f?l:0;m===0&&(m=e[0]-i[2]>f?-l:i[2]-e[0]>f?l:0),e[0]+=m}Zi(t,e)}function Us(e,t,i,l){for(var f=8192*Math.pow(2,l.z),m=[8192*l.x,8192*l.y],x=[],k=0,I=e;k<I.length;k+=1)for(var A=0,C=I[k];A<C.length;A+=1){var B=C[A],U=[B.x+m[0],B.y+m[1]];ho(U,t,i,f),x.push(U)}return x}function ja(e,t,i,l){for(var f,m=8192*Math.pow(2,l.z),x=[8192*l.x,8192*l.y],k=[],I=0,A=e;I<A.length;I+=1){for(var C=[],B=0,U=A[I];B<U.length;B+=1){var Z=U[B],Q=[Z.x+x[0],Z.y+x[1]];Zi(t,Q),C.push(Q)}k.push(C)}if(t[2]-t[0]<=m/2){(f=t)[0]=f[1]=1/0,f[2]=f[3]=-1/0;for(var ee=0,ce=k;ee<ce.length;ee+=1)for(var ne=0,me=ce[ee];ne<me.length;ne+=1)ho(me[ne],t,i,m)}return k}$n.parse=function(e,t){if(e.length!==2)return t.error("Expected one argument.");var i=e[1];if(typeof i!="object"||Array.isArray(i))return t.error("Collator options argument must be an object.");var l=t.parse(i["case-sensitive"]!==void 0&&i["case-sensitive"],1,Oe);if(!l)return null;var f=t.parse(i["diacritic-sensitive"]!==void 0&&i["diacritic-sensitive"],1,Oe);if(!f)return null;var m=null;return i.locale&&!(m=t.parse(i.locale,1,Xe))?null:new $n(l,f,m)},$n.prototype.evaluate=function(e){return new si(this.caseSensitive.evaluate(e),this.diacriticSensitive.evaluate(e),this.locale?this.locale.evaluate(e):null)},$n.prototype.eachChild=function(e){e(this.caseSensitive),e(this.diacriticSensitive),this.locale&&e(this.locale)},$n.prototype.outputDefined=function(){return!1},$n.prototype.serialize=function(){var e={};return e["case-sensitive"]=this.caseSensitive.serialize(),e["diacritic-sensitive"]=this.diacriticSensitive.serialize(),this.locale&&(e.locale=this.locale.serialize()),["collator",e]};var Vn=function(e,t){this.type=Oe,this.geojson=e,this.geometries=t};function Sa(e){if(e instanceof Ti&&(e.name==="get"&&e.args.length===1||e.name==="feature-state"||e.name==="has"&&e.args.length===1||e.name==="properties"||e.name==="geometry-type"||e.name==="id"||/^filter-/.test(e.name))||e instanceof Vn)return!1;var t=!0;return e.eachChild(function(i){t&&!Sa(i)&&(t=!1)}),t}function ye(e){if(e instanceof Ti&&e.name==="feature-state")return!1;var t=!0;return e.eachChild(function(i){t&&!ye(i)&&(t=!1)}),t}function hn(e,t){if(e instanceof Ti&&t.indexOf(e.name)>=0)return!1;var i=!0;return e.eachChild(function(l){i&&!hn(l,t)&&(i=!1)}),i}Vn.parse=function(e,t){if(e.length!==2)return t.error("'within' expression requires exactly one argument, but found "+(e.length-1)+" instead.");if(va(e[1])){var i=e[1];if(i.type==="FeatureCollection")for(var l=0;l<i.features.length;++l){var f=i.features[l].geometry.type;if(f==="Polygon"||f==="MultiPolygon")return new Vn(i,i.features[l].geometry)}else if(i.type==="Feature"){var m=i.geometry.type;if(m==="Polygon"||m==="MultiPolygon")return new Vn(i,i.geometry)}else if(i.type==="Polygon"||i.type==="MultiPolygon")return new Vn(i,i)}return t.error("'within' expression requires valid geojson object that contains polygon geometry type.")},Vn.prototype.evaluate=function(e){if(e.geometry()!=null&&e.canonicalID()!=null){if(e.geometryType()==="Point")return function(t,i){var l=[1/0,1/0,-1/0,-1/0],f=[1/0,1/0,-1/0,-1/0],m=t.canonicalID();if(i.type==="Polygon"){var x=Va(i.coordinates,f,m),k=Us(t.geometry(),l,f,m);if(!wa(l,f))return!1;for(var I=0,A=k;I<A.length;I+=1)if(!co(A[I],x))return!1}if(i.type==="MultiPolygon"){var C=ls(i.coordinates,f,m),B=Us(t.geometry(),l,f,m);if(!wa(l,f))return!1;for(var U=0,Z=B;U<Z.length;U+=1)if(!Ul(Z[U],C))return!1}return!0}(e,this.geometries);if(e.geometryType()==="LineString")return function(t,i){var l=[1/0,1/0,-1/0,-1/0],f=[1/0,1/0,-1/0,-1/0],m=t.canonicalID();if(i.type==="Polygon"){var x=Va(i.coordinates,f,m),k=ja(t.geometry(),l,f,m);if(!wa(l,f))return!1;for(var I=0,A=k;I<A.length;I+=1)if(!Oo(A[I],x))return!1}if(i.type==="MultiPolygon"){var C=ls(i.coordinates,f,m),B=ja(t.geometry(),l,f,m);if(!wa(l,f))return!1;for(var U=0,Z=B;U<Z.length;U+=1)if(!Ns(Z[U],C))return!1}return!0}(e,this.geometries)}return!1},Vn.prototype.eachChild=function(){},Vn.prototype.outputDefined=function(){return!0},Vn.prototype.serialize=function(){return["within",this.geojson]};var Gi=function(e,t){this.type=t.type,this.name=e,this.boundExpression=t};Gi.parse=function(e,t){if(e.length!==2||typeof e[1]!="string")return t.error("'var' expression requires exactly one string literal argument.");var i=e[1];return t.scope.has(i)?new Gi(i,t.scope.get(i)):t.error('Unknown variable "'+i+'". Make sure "'+i+'" has been bound in an enclosing "let" expression before using it.',1)},Gi.prototype.evaluate=function(e){return this.boundExpression.evaluate(e)},Gi.prototype.eachChild=function(){},Gi.prototype.outputDefined=function(){return!1},Gi.prototype.serialize=function(){return["var",this.name]};var Wr=function(e,t,i,l,f){t===void 0&&(t=[]),l===void 0&&(l=new tt),f===void 0&&(f=[]),this.registry=e,this.path=t,this.key=t.map(function(m){return"["+m+"]"}).join(""),this.scope=l,this.errors=f,this.expectedType=i};function ka(e,t){for(var i,l=e.length-1,f=0,m=l,x=0;f<=m;)if((i=e[x=Math.floor((f+m)/2)])<=t){if(x===l||t<e[x+1])return x;f=x+1}else{if(!(i>t))throw new li("Input is not a number.");m=x-1}return 0}Wr.prototype.parse=function(e,t,i,l,f){return f===void 0&&(f={}),t?this.concat(t,i,l)._parse(e,f):this._parse(e,f)},Wr.prototype._parse=function(e,t){function i(A,C,B){return B==="assert"?new Rr(C,[A]):B==="coerce"?new Ei(C,[A]):A}if(e!==null&&typeof e!="string"&&typeof e!="boolean"&&typeof e!="number"||(e=["literal",e]),Array.isArray(e)){if(e.length===0)return this.error('Expected an array with at least one element. If you wanted a literal array, use ["literal", []].');var l=e[0];if(typeof l!="string")return this.error("Expression name must be a string, but found "+typeof l+' instead. If you wanted a literal array, use ["literal", [...]].',0),null;var f=this.registry[l];if(f){var m=f.parse(e,this);if(!m)return null;if(this.expectedType){var x=this.expectedType,k=m.type;if(x.kind!=="string"&&x.kind!=="number"&&x.kind!=="boolean"&&x.kind!=="object"&&x.kind!=="array"||k.kind!=="value")if(x.kind!=="color"&&x.kind!=="formatted"&&x.kind!=="resolvedImage"||k.kind!=="value"&&k.kind!=="string"){if(this.checkSubtype(x,k))return null}else m=i(m,x,t.typeAnnotation||"coerce");else m=i(m,x,t.typeAnnotation||"assert")}if(!(m instanceof ki)&&m.type.kind!=="resolvedImage"&&function A(C){if(C instanceof Gi)return A(C.boundExpression);if(C instanceof Ti&&C.name==="error"||C instanceof $n||C instanceof Vn)return!1;var B=C instanceof Ei||C instanceof Rr,U=!0;return C.eachChild(function(Z){U=B?U&&A(Z):U&&Z instanceof ki}),!!U&&Sa(C)&&hn(C,["zoom","heatmap-density","line-progress","accumulated","is-supported-script"])}(m)){var I=new qi;try{m=new ki(m.type,m.evaluate(I))}catch(A){return this.error(A.message),null}}return m}return this.error('Unknown expression "'+l+'". If you wanted a literal array, use ["literal", [...]].',0)}return this.error(e===void 0?"'undefined' value invalid. Use null instead.":typeof e=="object"?'Bare objects invalid. Use ["literal", {...}] instead.':"Expected an array, but found "+typeof e+" instead.")},Wr.prototype.concat=function(e,t,i){var l=typeof e=="number"?this.path.concat(e):this.path,f=i?this.scope.concat(i):this.scope;return new Wr(this.registry,l,t||null,f,this.errors)},Wr.prototype.error=function(e){for(var t=[],i=arguments.length-1;i-- >0;)t[i]=arguments[i+1];var l=""+this.key+t.map(function(f){return"["+f+"]"}).join("");this.errors.push(new _e(l,e))},Wr.prototype.checkSubtype=function(e,t){var i=$t(e,t);return i&&this.error(i),i};var jn=function(e,t,i){this.type=e,this.input=t,this.labels=[],this.outputs=[];for(var l=0,f=i;l<f.length;l+=1){var m=f[l],x=m[1];this.labels.push(m[0]),this.outputs.push(x)}};function xi(e,t,i){return e*(1-i)+t*i}jn.parse=function(e,t){if(e.length-1<4)return t.error("Expected at least 4 arguments, but found only "+(e.length-1)+".");if((e.length-1)%2!=0)return t.error("Expected an even number of arguments.");var i=t.parse(e[1],1,ke);if(!i)return null;var l=[],f=null;t.expectedType&&t.expectedType.kind!=="value"&&(f=t.expectedType);for(var m=1;m<e.length;m+=2){var x=m===1?-1/0:e[m],k=e[m+1],I=m,A=m+1;if(typeof x!="number")return t.error('Input/output pairs for "step" expressions must be defined using literal numeric values (not computed expressions) for the input values.',I);if(l.length&&l[l.length-1][0]>=x)return t.error('Input/output pairs for "step" expressions must be arranged with input values in strictly ascending order.',I);var C=t.parse(k,A,f);if(!C)return null;f=f||C.type,l.push([x,C])}return new jn(f,i,l)},jn.prototype.evaluate=function(e){var t=this.labels,i=this.outputs;if(t.length===1)return i[0].evaluate(e);var l=this.input.evaluate(e);if(l<=t[0])return i[0].evaluate(e);var f=t.length;return l>=t[f-1]?i[f-1].evaluate(e):i[ka(t,l)].evaluate(e)},jn.prototype.eachChild=function(e){e(this.input);for(var t=0,i=this.outputs;t<i.length;t+=1)e(i[t])},jn.prototype.outputDefined=function(){return this.outputs.every(function(e){return e.outputDefined()})},jn.prototype.serialize=function(){for(var e=["step",this.input.serialize()],t=0;t<this.labels.length;t++)t>0&&e.push(this.labels[t]),e.push(this.outputs[t].serialize());return e};var Fo=Object.freeze({__proto__:null,number:xi,color:function(e,t,i){return new ar(xi(e.r,t.r,i),xi(e.g,t.g,i),xi(e.b,t.b,i),xi(e.a,t.a,i))},array:function(e,t,i){return e.map(function(l,f){return xi(l,t[f],i)})}}),nc=6/29*3*(6/29),Uh=Math.PI/180,Vh=180/Math.PI;function jl(e){return e>.008856451679035631?Math.pow(e,1/3):e/nc+4/29}function ql(e){return e>6/29?e*e*e:nc*(e-4/29)}function Zl(e){return 255*(e<=.0031308?12.92*e:1.055*Math.pow(e,1/2.4)-.055)}function Gl(e){return(e/=255)<=.04045?e/12.92:Math.pow((e+.055)/1.055,2.4)}function ac(e){var t=Gl(e.r),i=Gl(e.g),l=Gl(e.b),f=jl((.4124564*t+.3575761*i+.1804375*l)/.95047),m=jl((.2126729*t+.7151522*i+.072175*l)/1);return{l:116*m-16,a:500*(f-m),b:200*(m-jl((.0193339*t+.119192*i+.9503041*l)/1.08883)),alpha:e.a}}function oc(e){var t=(e.l+16)/116,i=isNaN(e.a)?t:t+e.a/500,l=isNaN(e.b)?t:t-e.b/200;return t=1*ql(t),i=.95047*ql(i),l=1.08883*ql(l),new ar(Zl(3.2404542*i-1.5371385*t-.4985314*l),Zl(-.969266*i+1.8760108*t+.041556*l),Zl(.0556434*i-.2040259*t+1.0572252*l),e.alpha)}function jh(e,t,i){var l=t-e;return e+i*(l>180||l<-180?l-360*Math.round(l/360):l)}var us={forward:ac,reverse:oc,interpolate:function(e,t,i){return{l:xi(e.l,t.l,i),a:xi(e.a,t.a,i),b:xi(e.b,t.b,i),alpha:xi(e.alpha,t.alpha,i)}}},cs={forward:function(e){var t=ac(e),i=t.l,l=t.a,f=t.b,m=Math.atan2(f,l)*Vh;return{h:m<0?m+360:m,c:Math.sqrt(l*l+f*f),l:i,alpha:e.a}},reverse:function(e){var t=e.h*Uh,i=e.c;return oc({l:e.l,a:Math.cos(t)*i,b:Math.sin(t)*i,alpha:e.alpha})},interpolate:function(e,t,i){return{h:jh(e.h,t.h,i),c:xi(e.c,t.c,i),l:xi(e.l,t.l,i),alpha:xi(e.alpha,t.alpha,i)}}},sc=Object.freeze({__proto__:null,lab:us,hcl:cs}),rn=function(e,t,i,l,f){this.type=e,this.operator=t,this.interpolation=i,this.input=l,this.labels=[],this.outputs=[];for(var m=0,x=f;m<x.length;m+=1){var k=x[m],I=k[1];this.labels.push(k[0]),this.outputs.push(I)}};function Kl(e,t,i,l){var f=l-i,m=e-i;return f===0?0:t===1?m/f:(Math.pow(t,m)-1)/(Math.pow(t,f)-1)}rn.interpolationFactor=function(e,t,i,l){var f=0;if(e.name==="exponential")f=Kl(t,e.base,i,l);else if(e.name==="linear")f=Kl(t,1,i,l);else if(e.name==="cubic-bezier"){var m=e.controlPoints;f=new E(m[0],m[1],m[2],m[3]).solve(Kl(t,1,i,l))}return f},rn.parse=function(e,t){var i=e[0],l=e[1],f=e[2],m=e.slice(3);if(!Array.isArray(l)||l.length===0)return t.error("Expected an interpolation type expression.",1);if(l[0]==="linear")l={name:"linear"};else if(l[0]==="exponential"){var x=l[1];if(typeof x!="number")return t.error("Exponential interpolation requires a numeric base.",1,1);l={name:"exponential",base:x}}else{if(l[0]!=="cubic-bezier")return t.error("Unknown interpolation type "+String(l[0]),1,0);var k=l.slice(1);if(k.length!==4||k.some(function(ce){return typeof ce!="number"||ce<0||ce>1}))return t.error("Cubic bezier interpolation requires four numeric arguments with values between 0 and 1.",1);l={name:"cubic-bezier",controlPoints:k}}if(e.length-1<4)return t.error("Expected at least 4 arguments, but found only "+(e.length-1)+".");if((e.length-1)%2!=0)return t.error("Expected an even number of arguments.");if(!(f=t.parse(f,2,ke)))return null;var I=[],A=null;i==="interpolate-hcl"||i==="interpolate-lab"?A=qe:t.expectedType&&t.expectedType.kind!=="value"&&(A=t.expectedType);for(var C=0;C<m.length;C+=2){var B=m[C],U=m[C+1],Z=C+3,Q=C+4;if(typeof B!="number")return t.error('Input/output pairs for "interpolate" expressions must be defined using literal numeric values (not computed expressions) for the input values.',Z);if(I.length&&I[I.length-1][0]>=B)return t.error('Input/output pairs for "interpolate" expressions must be arranged with input values in strictly ascending order.',Z);var ee=t.parse(U,Q,A);if(!ee)return null;A=A||ee.type,I.push([B,ee])}return A.kind==="number"||A.kind==="color"||A.kind==="array"&&A.itemType.kind==="number"&&typeof A.N=="number"?new rn(A,i,l,f,I):t.error("Type "+Jt(A)+" is not interpolatable.")},rn.prototype.evaluate=function(e){var t=this.labels,i=this.outputs;if(t.length===1)return i[0].evaluate(e);var l=this.input.evaluate(e);if(l<=t[0])return i[0].evaluate(e);var f=t.length;if(l>=t[f-1])return i[f-1].evaluate(e);var m=ka(t,l),x=rn.interpolationFactor(this.interpolation,l,t[m],t[m+1]),k=i[m].evaluate(e),I=i[m+1].evaluate(e);return this.operator==="interpolate"?Fo[this.type.kind.toLowerCase()](k,I,x):this.operator==="interpolate-hcl"?cs.reverse(cs.interpolate(cs.forward(k),cs.forward(I),x)):us.reverse(us.interpolate(us.forward(k),us.forward(I),x))},rn.prototype.eachChild=function(e){e(this.input);for(var t=0,i=this.outputs;t<i.length;t+=1)e(i[t])},rn.prototype.outputDefined=function(){return this.outputs.every(function(e){return e.outputDefined()})},rn.prototype.serialize=function(){var e;e=this.interpolation.name==="linear"?["linear"]:this.interpolation.name==="exponential"?this.interpolation.base===1?["linear"]:["exponential",this.interpolation.base]:["cubic-bezier"].concat(this.interpolation.controlPoints);for(var t=[this.operator,e,this.input.serialize()],i=0;i<this.labels.length;i++)t.push(this.labels[i],this.outputs[i].serialize());return t};var qa=function(e,t){this.type=e,this.args=t};qa.parse=function(e,t){if(e.length<2)return t.error("Expectected at least one argument.");var i=null,l=t.expectedType;l&&l.kind!=="value"&&(i=l);for(var f=[],m=0,x=e.slice(1);m<x.length;m+=1){var k=t.parse(x[m],1+f.length,i,void 0,{typeAnnotation:"omit"});if(!k)return null;i=i||k.type,f.push(k)}var I=l&&f.some(function(A){return $t(l,A.type)});return new qa(I?je:i,f)},qa.prototype.evaluate=function(e){for(var t,i=null,l=0,f=0,m=this.args;f<m.length&&(l++,(i=m[f].evaluate(e))&&i instanceof Di&&!i.available&&(t||(t=i.name),i=null,l===this.args.length&&(i=t)),i===null);f+=1);return i},qa.prototype.eachChild=function(e){this.args.forEach(e)},qa.prototype.outputDefined=function(){return this.args.every(function(e){return e.outputDefined()})},qa.prototype.serialize=function(){var e=["coalesce"];return this.eachChild(function(t){e.push(t.serialize())}),e};var Za=function(e,t){this.type=t.type,this.bindings=[].concat(e),this.result=t};Za.prototype.evaluate=function(e){return this.result.evaluate(e)},Za.prototype.eachChild=function(e){for(var t=0,i=this.bindings;t<i.length;t+=1)e(i[t][1]);e(this.result)},Za.parse=function(e,t){if(e.length<4)return t.error("Expected at least 3 arguments, but found "+(e.length-1)+" instead.");for(var i=[],l=1;l<e.length-1;l+=2){var f=e[l];if(typeof f!="string")return t.error("Expected string, but found "+typeof f+" instead.",l);if(/[^a-zA-Z0-9_]/.test(f))return t.error("Variable names must contain only alphanumeric characters or '_'.",l);var m=t.parse(e[l+1],l+1);if(!m)return null;i.push([f,m])}var x=t.parse(e[e.length-1],e.length-1,t.expectedType,i);return x?new Za(i,x):null},Za.prototype.outputDefined=function(){return this.result.outputDefined()},Za.prototype.serialize=function(){for(var e=["let"],t=0,i=this.bindings;t<i.length;t+=1){var l=i[t];e.push(l[0],l[1].serialize())}return e.push(this.result.serialize()),e};var po=function(e,t,i){this.type=e,this.index=t,this.input=i};po.parse=function(e,t){if(e.length!==3)return t.error("Expected 2 arguments, but found "+(e.length-1)+" instead.");var i=t.parse(e[1],1,ke),l=t.parse(e[2],2,nr(t.expectedType||je));return i&&l?new po(l.type.itemType,i,l):null},po.prototype.evaluate=function(e){var t=this.index.evaluate(e),i=this.input.evaluate(e);if(t<0)throw new li("Array index out of bounds: "+t+" < 0.");if(t>=i.length)throw new li("Array index out of bounds: "+t+" > "+(i.length-1)+".");if(t!==Math.floor(t))throw new li("Array index must be an integer, but found "+t+" instead.");return i[t]},po.prototype.eachChild=function(e){e(this.index),e(this.input)},po.prototype.outputDefined=function(){return!1},po.prototype.serialize=function(){return["at",this.index.serialize(),this.input.serialize()]};var fo=function(e,t){this.type=Oe,this.needle=e,this.haystack=t};fo.parse=function(e,t){if(e.length!==3)return t.error("Expected 2 arguments, but found "+(e.length-1)+" instead.");var i=t.parse(e[1],1,je),l=t.parse(e[2],2,je);return i&&l?br(i.type,[Oe,Xe,ke,He,je])?new fo(i,l):t.error("Expected first argument to be of type boolean, string, number or null, but found "+Jt(i.type)+" instead"):null},fo.prototype.evaluate=function(e){var t=this.needle.evaluate(e),i=this.haystack.evaluate(e);if(!i)return!1;if(!fr(t,["boolean","string","number","null"]))throw new li("Expected first argument to be of type boolean, string, number or null, but found "+Jt(Xr(t))+" instead.");if(!fr(i,["string","array"]))throw new li("Expected second argument to be of type array or string, but found "+Jt(Xr(i))+" instead.");return i.indexOf(t)>=0},fo.prototype.eachChild=function(e){e(this.needle),e(this.haystack)},fo.prototype.outputDefined=function(){return!0},fo.prototype.serialize=function(){return["in",this.needle.serialize(),this.haystack.serialize()]};var Ga=function(e,t,i){this.type=ke,this.needle=e,this.haystack=t,this.fromIndex=i};Ga.parse=function(e,t){if(e.length<=2||e.length>=5)return t.error("Expected 3 or 4 arguments, but found "+(e.length-1)+" instead.");var i=t.parse(e[1],1,je),l=t.parse(e[2],2,je);if(!i||!l)return null;if(!br(i.type,[Oe,Xe,ke,He,je]))return t.error("Expected first argument to be of type boolean, string, number or null, but found "+Jt(i.type)+" instead");if(e.length===4){var f=t.parse(e[3],3,ke);return f?new Ga(i,l,f):null}return new Ga(i,l)},Ga.prototype.evaluate=function(e){var t=this.needle.evaluate(e),i=this.haystack.evaluate(e);if(!fr(t,["boolean","string","number","null"]))throw new li("Expected first argument to be of type boolean, string, number or null, but found "+Jt(Xr(t))+" instead.");if(!fr(i,["string","array"]))throw new li("Expected second argument to be of type array or string, but found "+Jt(Xr(i))+" instead.");if(this.fromIndex){var l=this.fromIndex.evaluate(e);return i.indexOf(t,l)}return i.indexOf(t)},Ga.prototype.eachChild=function(e){e(this.needle),e(this.haystack),this.fromIndex&&e(this.fromIndex)},Ga.prototype.outputDefined=function(){return!1},Ga.prototype.serialize=function(){if(this.fromIndex!=null&&this.fromIndex!==void 0){var e=this.fromIndex.serialize();return["index-of",this.needle.serialize(),this.haystack.serialize(),e]}return["index-of",this.needle.serialize(),this.haystack.serialize()]};var mo=function(e,t,i,l,f,m){this.inputType=e,this.type=t,this.input=i,this.cases=l,this.outputs=f,this.otherwise=m};mo.parse=function(e,t){if(e.length<5)return t.error("Expected at least 4 arguments, but found only "+(e.length-1)+".");if(e.length%2!=1)return t.error("Expected an even number of arguments.");var i,l;t.expectedType&&t.expectedType.kind!=="value"&&(l=t.expectedType);for(var f={},m=[],x=2;x<e.length-1;x+=2){var k=e[x],I=e[x+1];Array.isArray(k)||(k=[k]);var A=t.concat(x);if(k.length===0)return A.error("Expected at least one branch label.");for(var C=0,B=k;C<B.length;C+=1){var U=B[C];if(typeof U!="number"&&typeof U!="string")return A.error("Branch labels must be numbers or strings.");if(typeof U=="number"&&Math.abs(U)>Number.MAX_SAFE_INTEGER)return A.error("Branch labels must be integers no larger than "+Number.MAX_SAFE_INTEGER+".");if(typeof U=="number"&&Math.floor(U)!==U)return A.error("Numeric branch labels must be integer values.");if(i){if(A.checkSubtype(i,Xr(U)))return null}else i=Xr(U);if(f[String(U)]!==void 0)return A.error("Branch labels must be unique.");f[String(U)]=m.length}var Z=t.parse(I,x,l);if(!Z)return null;l=l||Z.type,m.push(Z)}var Q=t.parse(e[1],1,je);if(!Q)return null;var ee=t.parse(e[e.length-1],e.length-1,l);return ee?Q.type.kind!=="value"&&t.concat(1).checkSubtype(i,Q.type)?null:new mo(i,l,Q,f,m,ee):null},mo.prototype.evaluate=function(e){var t=this.input.evaluate(e);return(Xr(t)===this.inputType&&this.outputs[this.cases[t]]||this.otherwise).evaluate(e)},mo.prototype.eachChild=function(e){e(this.input),this.outputs.forEach(e),e(this.otherwise)},mo.prototype.outputDefined=function(){return this.outputs.every(function(e){return e.outputDefined()})&&this.otherwise.outputDefined()},mo.prototype.serialize=function(){for(var e=this,t=["match",this.input.serialize()],i=[],l={},f=0,m=Object.keys(this.cases).sort();f<m.length;f+=1){var x=m[f];(B=l[this.cases[x]])===void 0?(l[this.cases[x]]=i.length,i.push([this.cases[x],[x]])):i[B][1].push(x)}for(var k=function(Z){return e.inputType.kind==="number"?Number(Z):Z},I=0,A=i;I<A.length;I+=1){var C=A[I],B=C[0],U=C[1];t.push(U.length===1?k(U[0]):U.map(k)),t.push(this.outputs[outputIndex$1].serialize())}return t.push(this.otherwise.serialize()),t};var yo=function(e,t,i){this.type=e,this.branches=t,this.otherwise=i};yo.parse=function(e,t){if(e.length<4)return t.error("Expected at least 3 arguments, but found only "+(e.length-1)+".");if(e.length%2!=0)return t.error("Expected an odd number of arguments.");var i;t.expectedType&&t.expectedType.kind!=="value"&&(i=t.expectedType);for(var l=[],f=1;f<e.length-1;f+=2){var m=t.parse(e[f],f,Oe);if(!m)return null;var x=t.parse(e[f+1],f+1,i);if(!x)return null;l.push([m,x]),i=i||x.type}var k=t.parse(e[e.length-1],e.length-1,i);return k?new yo(i,l,k):null},yo.prototype.evaluate=function(e){for(var t=0,i=this.branches;t<i.length;t+=1){var l=i[t],f=l[1];if(l[0].evaluate(e))return f.evaluate(e)}return this.otherwise.evaluate(e)},yo.prototype.eachChild=function(e){for(var t=0,i=this.branches;t<i.length;t+=1){var l=i[t],f=l[1];e(l[0]),e(f)}e(this.otherwise)},yo.prototype.outputDefined=function(){return this.branches.every(function(e){return e[1].outputDefined()})&&this.otherwise.outputDefined()},yo.prototype.serialize=function(){var e=["case"];return this.eachChild(function(t){e.push(t.serialize())}),e};var Ka=function(e,t,i,l){this.type=e,this.input=t,this.beginIndex=i,this.endIndex=l};function lc(e,t){return e==="=="||e==="!="?t.kind==="boolean"||t.kind==="string"||t.kind==="number"||t.kind==="null"||t.kind==="value":t.kind==="string"||t.kind==="number"||t.kind==="value"}function uc(e,t,i,l){return l.compare(t,i)===0}function Or(e,t,i){var l=e!=="=="&&e!=="!=";return function(){function f(m,x,k){this.type=Oe,this.lhs=m,this.rhs=x,this.collator=k,this.hasUntypedArgument=m.type.kind==="value"||x.type.kind==="value"}return f.parse=function(m,x){if(m.length!==3&&m.length!==4)return x.error("Expected two or three arguments.");var k=m[0],I=x.parse(m[1],1,je);if(!I)return null;if(!lc(k,I.type))return x.concat(1).error('"'+k+`" comparisons are not supported for type '`+Jt(I.type)+"'.");var A=x.parse(m[2],2,je);if(!A)return null;if(!lc(k,A.type))return x.concat(2).error('"'+k+`" comparisons are not supported for type '`+Jt(A.type)+"'.");if(I.type.kind!==A.type.kind&&I.type.kind!=="value"&&A.type.kind!=="value")return x.error("Cannot compare types '"+Jt(I.type)+"' and '"+Jt(A.type)+"'.");l&&(I.type.kind==="value"&&A.type.kind!=="value"?I=new Rr(A.type,[I]):I.type.kind!=="value"&&A.type.kind==="value"&&(A=new Rr(I.type,[A])));var C=null;if(m.length===4){if(I.type.kind!=="string"&&A.type.kind!=="string"&&I.type.kind!=="value"&&A.type.kind!=="value")return x.error("Cannot use collator to compare non-string types.");if(!(C=x.parse(m[3],3,Vt)))return null}return new f(I,A,C)},f.prototype.evaluate=function(m){var x=this.lhs.evaluate(m),k=this.rhs.evaluate(m);if(l&&this.hasUntypedArgument){var I=Xr(x),A=Xr(k);if(I.kind!==A.kind||I.kind!=="string"&&I.kind!=="number")throw new li('Expected arguments for "'+e+'" to be (string, string) or (number, number), but found ('+I.kind+", "+A.kind+") instead.")}if(this.collator&&!l&&this.hasUntypedArgument){var C=Xr(x),B=Xr(k);if(C.kind!=="string"||B.kind!=="string")return t(m,x,k)}return this.collator?i(m,x,k,this.collator.evaluate(m)):t(m,x,k)},f.prototype.eachChild=function(m){m(this.lhs),m(this.rhs),this.collator&&m(this.collator)},f.prototype.outputDefined=function(){return!0},f.prototype.serialize=function(){var m=[e];return this.eachChild(function(x){m.push(x.serialize())}),m},f}()}Ka.parse=function(e,t){if(e.length<=2||e.length>=5)return t.error("Expected 3 or 4 arguments, but found "+(e.length-1)+" instead.");var i=t.parse(e[1],1,je),l=t.parse(e[2],2,ke);if(!i||!l)return null;if(!br(i.type,[nr(je),Xe,je]))return t.error("Expected first argument to be of type array or string, but found "+Jt(i.type)+" instead");if(e.length===4){var f=t.parse(e[3],3,ke);return f?new Ka(i.type,i,l,f):null}return new Ka(i.type,i,l)},Ka.prototype.evaluate=function(e){var t=this.input.evaluate(e),i=this.beginIndex.evaluate(e);if(!fr(t,["string","array"]))throw new li("Expected first argument to be of type array or string, but found "+Jt(Xr(t))+" instead.");if(this.endIndex){var l=this.endIndex.evaluate(e);return t.slice(i,l)}return t.slice(i)},Ka.prototype.eachChild=function(e){e(this.input),e(this.beginIndex),this.endIndex&&e(this.endIndex)},Ka.prototype.outputDefined=function(){return!1},Ka.prototype.serialize=function(){if(this.endIndex!=null&&this.endIndex!==void 0){var e=this.endIndex.serialize();return["slice",this.input.serialize(),this.beginIndex.serialize(),e]}return["slice",this.input.serialize(),this.beginIndex.serialize()]};var qh=Or("==",function(e,t,i){return t===i},uc),Vs=Or("!=",function(e,t,i){return t!==i},function(e,t,i,l){return!uc(0,t,i,l)}),cc=Or("<",function(e,t,i){return t<i},function(e,t,i,l){return l.compare(t,i)<0}),hc=Or(">",function(e,t,i){return t>i},function(e,t,i,l){return l.compare(t,i)>0}),pc=Or("<=",function(e,t,i){return t<=i},function(e,t,i,l){return l.compare(t,i)<=0}),fc=Or(">=",function(e,t,i){return t>=i},function(e,t,i,l){return l.compare(t,i)>=0}),go=function(e,t,i,l,f){this.type=Xe,this.number=e,this.locale=t,this.currency=i,this.minFractionDigits=l,this.maxFractionDigits=f};go.parse=function(e,t){if(e.length!==3)return t.error("Expected two arguments.");var i=t.parse(e[1],1,ke);if(!i)return null;var l=e[2];if(typeof l!="object"||Array.isArray(l))return t.error("NumberFormat options argument must be an object.");var f=null;if(l.locale&&!(f=t.parse(l.locale,1,Xe)))return null;var m=null;if(l.currency&&!(m=t.parse(l.currency,1,Xe)))return null;var x=null;if(l["min-fraction-digits"]&&!(x=t.parse(l["min-fraction-digits"],1,ke)))return null;var k=null;return l["max-fraction-digits"]&&!(k=t.parse(l["max-fraction-digits"],1,ke))?null:new go(i,f,m,x,k)},go.prototype.evaluate=function(e){return new Intl.NumberFormat(this.locale?this.locale.evaluate(e):[],{style:this.currency?"currency":"decimal",currency:this.currency?this.currency.evaluate(e):void 0,minimumFractionDigits:this.minFractionDigits?this.minFractionDigits.evaluate(e):void 0,maximumFractionDigits:this.maxFractionDigits?this.maxFractionDigits.evaluate(e):void 0}).format(this.number.evaluate(e))},go.prototype.eachChild=function(e){e(this.number),this.locale&&e(this.locale),this.currency&&e(this.currency),this.minFractionDigits&&e(this.minFractionDigits),this.maxFractionDigits&&e(this.maxFractionDigits)},go.prototype.outputDefined=function(){return!1},go.prototype.serialize=function(){var e={};return this.locale&&(e.locale=this.locale.serialize()),this.currency&&(e.currency=this.currency.serialize()),this.minFractionDigits&&(e["min-fraction-digits"]=this.minFractionDigits.serialize()),this.maxFractionDigits&&(e["max-fraction-digits"]=this.maxFractionDigits.serialize()),["number-format",this.number.serialize(),e]};var Xa=function(e){this.type=ke,this.input=e};Xa.parse=function(e,t){if(e.length!==2)return t.error("Expected 1 argument, but found "+(e.length-1)+" instead.");var i=t.parse(e[1],1);return i?i.type.kind!=="array"&&i.type.kind!=="string"&&i.type.kind!=="value"?t.error("Expected argument of type string or array, but found "+Jt(i.type)+" instead."):new Xa(i):null},Xa.prototype.evaluate=function(e){var t=this.input.evaluate(e);if(typeof t=="string"||Array.isArray(t))return t.length;throw new li("Expected value to be of type string or array, but found "+Jt(Xr(t))+" instead.")},Xa.prototype.eachChild=function(e){e(this.input)},Xa.prototype.outputDefined=function(){return!1},Xa.prototype.serialize=function(){var e=["length"];return this.eachChild(function(t){e.push(t.serialize())}),e};var _o={"==":qh,"!=":Vs,">":hc,"<":cc,">=":fc,"<=":pc,array:Rr,at:po,boolean:Rr,case:yo,coalesce:qa,collator:$n,format:Un,image:xn,in:fo,"index-of":Ga,interpolate:rn,"interpolate-hcl":rn,"interpolate-lab":rn,length:Xa,let:Za,literal:ki,match:mo,number:Rr,"number-format":go,object:Rr,slice:Ka,step:jn,string:Rr,"to-boolean":Ei,"to-color":Ei,"to-number":Ei,"to-string":Ei,var:Gi,within:Vn};function dc(e,t){var i=t[0],l=t[1],f=t[2],m=t[3];i=i.evaluate(e),l=l.evaluate(e),f=f.evaluate(e);var x=m?m.evaluate(e):1,k=Ua(i,l,f,x);if(k)throw new li(k);return new ar(i/255*x,l/255*x,f/255*x,x)}function mc(e,t){return e in t}function Xl(e,t){var i=t[e];return i===void 0?null:i}function vo(e){return{type:e}}function yc(e){return{result:"success",value:e}}function bo(e){return{result:"error",value:e}}function xo(e){return e["property-type"]==="data-driven"||e["property-type"]==="cross-faded-data-driven"}function gc(e){return!!e.expression&&e.expression.parameters.indexOf("zoom")>-1}function hs(e){return!!e.expression&&e.expression.interpolated}function Vr(e){return e instanceof Number?"number":e instanceof String?"string":e instanceof Boolean?"boolean":Array.isArray(e)?"array":e===null?"null":typeof e}function js(e){return typeof e=="object"&&e!==null&&!Array.isArray(e)}function Zh(e){return e}function No(e,t,i){return e!==void 0?e:t!==void 0?t:i!==void 0?i:void 0}function _c(e,t,i,l,f){return No(typeof i===f?l[i]:void 0,e.default,t.default)}function Gh(e,t,i){if(Vr(i)!=="number")return No(e.default,t.default);var l=e.stops.length;if(l===1||i<=e.stops[0][0])return e.stops[0][1];if(i>=e.stops[l-1][0])return e.stops[l-1][1];var f=ka(e.stops.map(function(m){return m[0]}),i);return e.stops[f][1]}function vc(e,t,i){var l=e.base!==void 0?e.base:1;if(Vr(i)!=="number")return No(e.default,t.default);var f=e.stops.length;if(f===1||i<=e.stops[0][0])return e.stops[0][1];if(i>=e.stops[f-1][0])return e.stops[f-1][1];var m=ka(e.stops.map(function(B){return B[0]}),i),x=function(B,U,Z,Q){var ee=Q-Z,ce=B-Z;return ee===0?0:U===1?ce/ee:(Math.pow(U,ce)-1)/(Math.pow(U,ee)-1)}(i,l,e.stops[m][0],e.stops[m+1][0]),k=e.stops[m][1],I=e.stops[m+1][1],A=Fo[t.type]||Zh;if(e.colorSpace&&e.colorSpace!=="rgb"){var C=sc[e.colorSpace];A=function(B,U){return C.reverse(C.interpolate(C.forward(B),C.forward(U),x))}}return typeof k.evaluate=="function"?{evaluate:function(){for(var B=[],U=arguments.length;U--;)B[U]=arguments[U];var Z=k.evaluate.apply(void 0,B),Q=I.evaluate.apply(void 0,B);if(Z!==void 0&&Q!==void 0)return A(Z,Q,x)}}:A(k,I,x)}function qs(e,t,i){return t.type==="color"?i=ar.parse(i):t.type==="formatted"?i=wr.fromString(i.toString()):t.type==="resolvedImage"?i=Di.fromString(i.toString()):Vr(i)===t.type||t.type==="enum"&&t.values[i]||(i=void 0),No(i,e.default,t.default)}Ti.register(_o,{error:[{kind:"error"},[Xe],function(e,t){throw new li(t[0].evaluate(e))}],typeof:[Xe,[je],function(e,t){return Jt(Xr(t[0].evaluate(e)))}],"to-rgba":[nr(ke,4),[qe],function(e,t){return t[0].evaluate(e).toArray()}],rgb:[qe,[ke,ke,ke],dc],rgba:[qe,[ke,ke,ke,ke],dc],has:{type:Oe,overloads:[[[Xe],function(e,t){return mc(t[0].evaluate(e),e.properties())}],[[Xe,Mt],function(e,t){var i=t[1];return mc(t[0].evaluate(e),i.evaluate(e))}]]},get:{type:je,overloads:[[[Xe],function(e,t){return Xl(t[0].evaluate(e),e.properties())}],[[Xe,Mt],function(e,t){var i=t[1];return Xl(t[0].evaluate(e),i.evaluate(e))}]]},"feature-state":[je,[Xe],function(e,t){return Xl(t[0].evaluate(e),e.featureState||{})}],properties:[Mt,[],function(e){return e.properties()}],"geometry-type":[Xe,[],function(e){return e.geometryType()}],id:[je,[],function(e){return e.id()}],zoom:[ke,[],function(e){return e.globals.zoom}],"heatmap-density":[ke,[],function(e){return e.globals.heatmapDensity||0}],"line-progress":[ke,[],function(e){return e.globals.lineProgress||0}],accumulated:[je,[],function(e){return e.globals.accumulated===void 0?null:e.globals.accumulated}],"+":[ke,vo(ke),function(e,t){for(var i=0,l=0,f=t;l<f.length;l+=1)i+=f[l].evaluate(e);return i}],"*":[ke,vo(ke),function(e,t){for(var i=1,l=0,f=t;l<f.length;l+=1)i*=f[l].evaluate(e);return i}],"-":{type:ke,overloads:[[[ke,ke],function(e,t){var i=t[1];return t[0].evaluate(e)-i.evaluate(e)}],[[ke],function(e,t){return-t[0].evaluate(e)}]]},"/":[ke,[ke,ke],function(e,t){var i=t[1];return t[0].evaluate(e)/i.evaluate(e)}],"%":[ke,[ke,ke],function(e,t){var i=t[1];return t[0].evaluate(e)%i.evaluate(e)}],ln2:[ke,[],function(){return Math.LN2}],pi:[ke,[],function(){return Math.PI}],e:[ke,[],function(){return Math.E}],"^":[ke,[ke,ke],function(e,t){var i=t[1];return Math.pow(t[0].evaluate(e),i.evaluate(e))}],sqrt:[ke,[ke],function(e,t){return Math.sqrt(t[0].evaluate(e))}],log10:[ke,[ke],function(e,t){return Math.log(t[0].evaluate(e))/Math.LN10}],ln:[ke,[ke],function(e,t){return Math.log(t[0].evaluate(e))}],log2:[ke,[ke],function(e,t){return Math.log(t[0].evaluate(e))/Math.LN2}],sin:[ke,[ke],function(e,t){return Math.sin(t[0].evaluate(e))}],cos:[ke,[ke],function(e,t){return Math.cos(t[0].evaluate(e))}],tan:[ke,[ke],function(e,t){return Math.tan(t[0].evaluate(e))}],asin:[ke,[ke],function(e,t){return Math.asin(t[0].evaluate(e))}],acos:[ke,[ke],function(e,t){return Math.acos(t[0].evaluate(e))}],atan:[ke,[ke],function(e,t){return Math.atan(t[0].evaluate(e))}],min:[ke,vo(ke),function(e,t){return Math.min.apply(Math,t.map(function(i){return i.evaluate(e)}))}],max:[ke,vo(ke),function(e,t){return Math.max.apply(Math,t.map(function(i){return i.evaluate(e)}))}],abs:[ke,[ke],function(e,t){return Math.abs(t[0].evaluate(e))}],round:[ke,[ke],function(e,t){var i=t[0].evaluate(e);return i<0?-Math.round(-i):Math.round(i)}],floor:[ke,[ke],function(e,t){return Math.floor(t[0].evaluate(e))}],ceil:[ke,[ke],function(e,t){return Math.ceil(t[0].evaluate(e))}],"filter-==":[Oe,[Xe,je],function(e,t){var i=t[0],l=t[1];return e.properties()[i.value]===l.value}],"filter-id-==":[Oe,[je],function(e,t){var i=t[0];return e.id()===i.value}],"filter-type-==":[Oe,[Xe],function(e,t){var i=t[0];return e.geometryType()===i.value}],"filter-<":[Oe,[Xe,je],function(e,t){var i=t[0],l=t[1],f=e.properties()[i.value],m=l.value;return typeof f==typeof m&&f<m}],"filter-id-<":[Oe,[je],function(e,t){var i=t[0],l=e.id(),f=i.value;return typeof l==typeof f&&l<f}],"filter->":[Oe,[Xe,je],function(e,t){var i=t[0],l=t[1],f=e.properties()[i.value],m=l.value;return typeof f==typeof m&&f>m}],"filter-id->":[Oe,[je],function(e,t){var i=t[0],l=e.id(),f=i.value;return typeof l==typeof f&&l>f}],"filter-<=":[Oe,[Xe,je],function(e,t){var i=t[0],l=t[1],f=e.properties()[i.value],m=l.value;return typeof f==typeof m&&f<=m}],"filter-id-<=":[Oe,[je],function(e,t){var i=t[0],l=e.id(),f=i.value;return typeof l==typeof f&&l<=f}],"filter->=":[Oe,[Xe,je],function(e,t){var i=t[0],l=t[1],f=e.properties()[i.value],m=l.value;return typeof f==typeof m&&f>=m}],"filter-id->=":[Oe,[je],function(e,t){var i=t[0],l=e.id(),f=i.value;return typeof l==typeof f&&l>=f}],"filter-has":[Oe,[je],function(e,t){return t[0].value in e.properties()}],"filter-has-id":[Oe,[],function(e){return e.id()!==null&&e.id()!==void 0}],"filter-type-in":[Oe,[nr(Xe)],function(e,t){return t[0].value.indexOf(e.geometryType())>=0}],"filter-id-in":[Oe,[nr(je)],function(e,t){return t[0].value.indexOf(e.id())>=0}],"filter-in-small":[Oe,[Xe,nr(je)],function(e,t){var i=t[0];return t[1].value.indexOf(e.properties()[i.value])>=0}],"filter-in-large":[Oe,[Xe,nr(je)],function(e,t){var i=t[0],l=t[1];return function(f,m,x,k){for(;x<=k;){var I=x+k>>1;if(m[I]===f)return!0;m[I]>f?k=I-1:x=I+1}return!1}(e.properties()[i.value],l.value,0,l.value.length-1)}],all:{type:Oe,overloads:[[[Oe,Oe],function(e,t){var i=t[1];return t[0].evaluate(e)&&i.evaluate(e)}],[vo(Oe),function(e,t){for(var i=0,l=t;i<l.length;i+=1)if(!l[i].evaluate(e))return!1;return!0}]]},any:{type:Oe,overloads:[[[Oe,Oe],function(e,t){var i=t[1];return t[0].evaluate(e)||i.evaluate(e)}],[vo(Oe),function(e,t){for(var i=0,l=t;i<l.length;i+=1)if(l[i].evaluate(e))return!0;return!1}]]},"!":[Oe,[Oe],function(e,t){return!t[0].evaluate(e)}],"is-supported-script":[Oe,[Xe],function(e,t){var i=e.globals&&e.globals.isSupportedScript;return!i||i(t[0].evaluate(e))}],upcase:[Xe,[Xe],function(e,t){return t[0].evaluate(e).toUpperCase()}],downcase:[Xe,[Xe],function(e,t){return t[0].evaluate(e).toLowerCase()}],concat:[Xe,vo(je),function(e,t){return t.map(function(i){return ba(i.evaluate(e))}).join("")}],"resolved-locale":[Xe,[Vt],function(e,t){return t[0].evaluate(e).resolvedLocale()}]});var Uo=function(e,t){this.expression=e,this._warningHistory={},this._evaluator=new qi,this._defaultValue=t?function(i){return i.type==="color"&&js(i.default)?new ar(0,0,0,0):i.type==="color"?ar.parse(i.default)||null:i.default===void 0?null:i.default}(t):null,this._enumValues=t&&t.type==="enum"?t.values:null};function ps(e){return Array.isArray(e)&&e.length>0&&typeof e[0]=="string"&&e[0]in _o}function Zs(e,t){var i=new Wr(_o,[],t?function(f){var m={color:qe,string:Xe,number:ke,enum:Xe,boolean:Oe,formatted:lr,resolvedImage:Dt};return f.type==="array"?nr(m[f.value]||je,f.length):m[f.type]}(t):void 0),l=i.parse(e,void 0,void 0,void 0,t&&t.type==="string"?{typeAnnotation:"coerce"}:void 0);return l?yc(new Uo(l,t)):bo(i.errors)}Uo.prototype.evaluateWithoutErrorHandling=function(e,t,i,l,f,m){return this._evaluator.globals=e,this._evaluator.feature=t,this._evaluator.featureState=i,this._evaluator.canonical=l,this._evaluator.availableImages=f||null,this._evaluator.formattedSection=m,this.expression.evaluate(this._evaluator)},Uo.prototype.evaluate=function(e,t,i,l,f,m){this._evaluator.globals=e,this._evaluator.feature=t||null,this._evaluator.featureState=i||null,this._evaluator.canonical=l,this._evaluator.availableImages=f||null,this._evaluator.formattedSection=m||null;try{var x=this.expression.evaluate(this._evaluator);if(x==null||typeof x=="number"&&x!=x)return this._defaultValue;if(this._enumValues&&!(x in this._enumValues))throw new li("Expected value to be one of "+Object.keys(this._enumValues).map(function(k){return JSON.stringify(k)}).join(", ")+", but found "+JSON.stringify(x)+" instead.");return x}catch(k){return this._warningHistory[k.message]||(this._warningHistory[k.message]=!0,typeof console<"u"&&console.warn(k.message)),this._defaultValue}};var fs=function(e,t){this.kind=e,this._styleExpression=t,this.isStateDependent=e!=="constant"&&!ye(t.expression)};fs.prototype.evaluateWithoutErrorHandling=function(e,t,i,l,f,m){return this._styleExpression.evaluateWithoutErrorHandling(e,t,i,l,f,m)},fs.prototype.evaluate=function(e,t,i,l,f,m){return this._styleExpression.evaluate(e,t,i,l,f,m)};var Vo=function(e,t,i,l){this.kind=e,this.zoomStops=i,this._styleExpression=t,this.isStateDependent=e!=="camera"&&!ye(t.expression),this.interpolationType=l};function bc(e,t){if((e=Zs(e,t)).result==="error")return e;var i=e.value.expression,l=Sa(i);if(!l&&!xo(t))return bo([new _e("","data expressions not supported")]);var f=hn(i,["zoom"]);if(!f&&!gc(t))return bo([new _e("","zoom expressions not supported")]);var m=function x(k){var I=null;if(k instanceof Za)I=x(k.result);else if(k instanceof qa)for(var A=0,C=k.args;A<C.length&&!(I=x(C[A]));A+=1);else(k instanceof jn||k instanceof rn)&&k.input instanceof Ti&&k.input.name==="zoom"&&(I=k);return I instanceof _e||k.eachChild(function(B){var U=x(B);U instanceof _e?I=U:!I&&U?I=new _e("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.'):I&&U&&I!==U&&(I=new _e("",'Only one zoom-based "step" or "interpolate" subexpression may be used in an expression.'))}),I}(i);return m||f?m instanceof _e?bo([m]):m instanceof rn&&!hs(t)?bo([new _e("",'"interpolate" expressions cannot be used with this property')]):yc(m?new Vo(l?"camera":"composite",e.value,m.labels,m instanceof rn?m.interpolation:void 0):new fs(l?"constant":"source",e.value)):bo([new _e("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.')])}Vo.prototype.evaluateWithoutErrorHandling=function(e,t,i,l,f,m){return this._styleExpression.evaluateWithoutErrorHandling(e,t,i,l,f,m)},Vo.prototype.evaluate=function(e,t,i,l,f,m){return this._styleExpression.evaluate(e,t,i,l,f,m)},Vo.prototype.interpolationFactor=function(e,t,i){return this.interpolationType?rn.interpolationFactor(this.interpolationType,e,t,i):0};var jo=function(e,t){this._parameters=e,this._specification=t,Ce(this,function i(l,f){var m,x,k,I=f.type==="color",A=l.stops&&typeof l.stops[0][0]=="object",C=A||!(A||l.property!==void 0),B=l.type||(hs(f)?"exponential":"interval");if(I&&((l=Ce({},l)).stops&&(l.stops=l.stops.map(function(it){return[it[0],ar.parse(it[1])]})),l.default=ar.parse(l.default?l.default:f.default)),l.colorSpace&&l.colorSpace!=="rgb"&&!sc[l.colorSpace])throw new Error("Unknown color space: "+l.colorSpace);if(B==="exponential")m=vc;else if(B==="interval")m=Gh;else if(B==="categorical"){m=_c,x=Object.create(null);for(var U=0,Z=l.stops;U<Z.length;U+=1){var Q=Z[U];x[Q[0]]=Q[1]}k=typeof l.stops[0][0]}else{if(B!=="identity")throw new Error('Unknown function type "'+B+'"');m=qs}if(A){for(var ee={},ce=[],ne=0;ne<l.stops.length;ne++){var me=l.stops[ne],be=me[0].zoom;ee[be]===void 0&&(ee[be]={zoom:be,type:l.type,property:l.property,default:l.default,stops:[]},ce.push(be)),ee[be].stops.push([me[0].value,me[1]])}for(var Se=[],ze=0,Pe=ce;ze<Pe.length;ze+=1){var Ve=Pe[ze];Se.push([ee[Ve].zoom,i(ee[Ve],f)])}var Ye={name:"linear"};return{kind:"composite",interpolationType:Ye,interpolationFactor:rn.interpolationFactor.bind(void 0,Ye),zoomStops:Se.map(function(it){return it[0]}),evaluate:function(it,St){var nt=it.zoom;return vc({stops:Se,base:l.base},f,nt).evaluate(nt,St)}}}if(C){var vt=B==="exponential"?{name:"exponential",base:l.base!==void 0?l.base:1}:null;return{kind:"camera",interpolationType:vt,interpolationFactor:rn.interpolationFactor.bind(void 0,vt),zoomStops:l.stops.map(function(it){return it[0]}),evaluate:function(it){return m(l,f,it.zoom,x,k)}}}return{kind:"source",evaluate:function(it,St){var nt=St&&St.properties?St.properties[l.property]:void 0;return nt===void 0?No(l.default,f.default):m(l,f,nt,x,k)}}}(this._parameters,this._specification))};function fa(e){var t=e.key,i=e.value,l=e.valueSpec||{},f=e.objectElementValidators||{},m=e.style,x=e.styleSpec,k=[],I=Vr(i);if(I!=="object")return[new J(t,i,"object expected, "+I+" found")];for(var A in i){var C=A.split(".")[0],B=l[C]||l["*"],U=void 0;if(f[C])U=f[C];else if(l[C])U=dr;else if(f["*"])U=f["*"];else{if(!l["*"]){k.push(new J(t,i[A],'unknown property "'+A+'"'));continue}U=dr}k=k.concat(U({key:(t&&t+".")+A,value:i[A],valueSpec:B,style:m,styleSpec:x,object:i,objectKey:A},i))}for(var Z in l)f[Z]||l[Z].required&&l[Z].default===void 0&&i[Z]===void 0&&k.push(new J(t,i,'missing required property "'+Z+'"'));return k}function xc(e){var t=e.value,i=e.valueSpec,l=e.style,f=e.styleSpec,m=e.key,x=e.arrayElementValidator||dr;if(Vr(t)!=="array")return[new J(m,t,"array expected, "+Vr(t)+" found")];if(i.length&&t.length!==i.length)return[new J(m,t,"array length "+i.length+" expected, length "+t.length+" found")];if(i["min-length"]&&t.length<i["min-length"])return[new J(m,t,"array length at least "+i["min-length"]+" expected, length "+t.length+" found")];var k={type:i.value,values:i.values};f.$version<7&&(k.function=i.function),Vr(i.value)==="object"&&(k=i.value);for(var I=[],A=0;A<t.length;A++)I=I.concat(x({array:t,arrayIndex:A,value:t[A],valueSpec:k,style:l,styleSpec:f,key:m+"["+A+"]"}));return I}function wc(e){var t=e.key,i=e.value,l=e.valueSpec,f=Vr(i);return f==="number"&&i!=i&&(f="NaN"),f!=="number"?[new J(t,i,"number expected, "+f+" found")]:"minimum"in l&&i<l.minimum?[new J(t,i,i+" is less than the minimum value "+l.minimum)]:"maximum"in l&&i>l.maximum?[new J(t,i,i+" is greater than the maximum value "+l.maximum)]:[]}function Sc(e){var t,i,l,f=e.valueSpec,m=De(e.value.type),x={},k=m!=="categorical"&&e.value.property===void 0,I=!k,A=Vr(e.value.stops)==="array"&&Vr(e.value.stops[0])==="array"&&Vr(e.value.stops[0][0])==="object",C=fa({key:e.key,value:e.value,valueSpec:e.styleSpec.function,style:e.style,styleSpec:e.styleSpec,objectElementValidators:{stops:function(Z){if(m==="identity")return[new J(Z.key,Z.value,'identity function may not have a "stops" property')];var Q=[],ee=Z.value;return Q=Q.concat(xc({key:Z.key,value:ee,valueSpec:Z.valueSpec,style:Z.style,styleSpec:Z.styleSpec,arrayElementValidator:B})),Vr(ee)==="array"&&ee.length===0&&Q.push(new J(Z.key,ee,"array must have at least one stop")),Q},default:function(Z){return dr({key:Z.key,value:Z.value,valueSpec:f,style:Z.style,styleSpec:Z.styleSpec})}}});return m==="identity"&&k&&C.push(new J(e.key,e.value,'missing required property "property"')),m==="identity"||e.value.stops||C.push(new J(e.key,e.value,'missing required property "stops"')),m==="exponential"&&e.valueSpec.expression&&!hs(e.valueSpec)&&C.push(new J(e.key,e.value,"exponential functions not supported")),e.styleSpec.$version>=8&&(I&&!xo(e.valueSpec)?C.push(new J(e.key,e.value,"property functions not supported")):k&&!gc(e.valueSpec)&&C.push(new J(e.key,e.value,"zoom functions not supported"))),m!=="categorical"&&!A||e.value.property!==void 0||C.push(new J(e.key,e.value,'"property" property is required')),C;function B(Z){var Q=[],ee=Z.value,ce=Z.key;if(Vr(ee)!=="array")return[new J(ce,ee,"array expected, "+Vr(ee)+" found")];if(ee.length!==2)return[new J(ce,ee,"array length 2 expected, length "+ee.length+" found")];if(A){if(Vr(ee[0])!=="object")return[new J(ce,ee,"object expected, "+Vr(ee[0])+" found")];if(ee[0].zoom===void 0)return[new J(ce,ee,"object stop key must have zoom")];if(ee[0].value===void 0)return[new J(ce,ee,"object stop key must have value")];if(l&&l>De(ee[0].zoom))return[new J(ce,ee[0].zoom,"stop zoom values must appear in ascending order")];De(ee[0].zoom)!==l&&(l=De(ee[0].zoom),i=void 0,x={}),Q=Q.concat(fa({key:ce+"[0]",value:ee[0],valueSpec:{zoom:{}},style:Z.style,styleSpec:Z.styleSpec,objectElementValidators:{zoom:wc,value:U}}))}else Q=Q.concat(U({key:ce+"[0]",value:ee[0],valueSpec:{},style:Z.style,styleSpec:Z.styleSpec},ee));return ps(q(ee[1]))?Q.concat([new J(ce+"[1]",ee[1],"expressions are not allowed in function stops.")]):Q.concat(dr({key:ce+"[1]",value:ee[1],valueSpec:f,style:Z.style,styleSpec:Z.styleSpec}))}function U(Z,Q){var ee=Vr(Z.value),ce=De(Z.value),ne=Z.value!==null?Z.value:Q;if(t){if(ee!==t)return[new J(Z.key,ne,ee+" stop domain type must match previous stop domain type "+t)]}else t=ee;if(ee!=="number"&&ee!=="string"&&ee!=="boolean")return[new J(Z.key,ne,"stop domain value must be a number, string, or boolean")];if(ee!=="number"&&m!=="categorical"){var me="number expected, "+ee+" found";return xo(f)&&m===void 0&&(me+='\nIf you intended to use a categorical function, specify `"type": "categorical"`.'),[new J(Z.key,ne,me)]}return m!=="categorical"||ee!=="number"||isFinite(ce)&&Math.floor(ce)===ce?m!=="categorical"&&ee==="number"&&i!==void 0&&ce<i?[new J(Z.key,ne,"stop domain values must appear in ascending order")]:(i=ce,m==="categorical"&&ce in x?[new J(Z.key,ne,"stop domain values must be unique")]:(x[ce]=!0,[])):[new J(Z.key,ne,"integer expected, found "+ce)]}}function wo(e){var t=(e.expressionContext==="property"?bc:Zs)(q(e.value),e.valueSpec);if(t.result==="error")return t.value.map(function(l){return new J(""+e.key+l.key,e.value,l.message)});var i=t.value.expression||t.value._styleExpression.expression;if(e.expressionContext==="property"&&e.propertyKey==="text-font"&&!i.outputDefined())return[new J(e.key,e.value,'Invalid data expression for "'+e.propertyKey+'". Output values must be contained as literals within the expression.')];if(e.expressionContext==="property"&&e.propertyType==="layout"&&!ye(i))return[new J(e.key,e.value,'"feature-state" data expressions are not supported with layout properties.')];if(e.expressionContext==="filter"&&!ye(i))return[new J(e.key,e.value,'"feature-state" data expressions are not supported with filters.')];if(e.expressionContext&&e.expressionContext.indexOf("cluster")===0){if(!hn(i,["zoom","feature-state"]))return[new J(e.key,e.value,'"zoom" and "feature-state" expressions are not supported with cluster properties.')];if(e.expressionContext==="cluster-initial"&&!Sa(i))return[new J(e.key,e.value,"Feature data expressions are not supported with initial expression part of cluster properties.")]}return[]}function ds(e){var t=e.key,i=e.value,l=e.valueSpec,f=[];return Array.isArray(l.values)?l.values.indexOf(De(i))===-1&&f.push(new J(t,i,"expected one of ["+l.values.join(", ")+"], "+JSON.stringify(i)+" found")):Object.keys(l.values).indexOf(De(i))===-1&&f.push(new J(t,i,"expected one of ["+Object.keys(l.values).join(", ")+"], "+JSON.stringify(i)+" found")),f}function Gs(e){if(e===!0||e===!1)return!0;if(!Array.isArray(e)||e.length===0)return!1;switch(e[0]){case"has":return e.length>=2&&e[1]!=="$id"&&e[1]!=="$type";case"in":return e.length>=3&&(typeof e[1]!="string"||Array.isArray(e[2]));case"!in":case"!has":case"none":return!1;case"==":case"!=":case">":case">=":case"<":case"<=":return e.length!==3||Array.isArray(e[1])||Array.isArray(e[2]);case"any":case"all":for(var t=0,i=e.slice(1);t<i.length;t+=1){var l=i[t];if(!Gs(l)&&typeof l!="boolean")return!1}return!0;default:return!0}}jo.deserialize=function(e){return new jo(e._parameters,e._specification)},jo.serialize=function(e){return{_parameters:e._parameters,_specification:e._specification}};var Wl={type:"boolean",default:!1,transition:!1,"property-type":"data-driven",expression:{interpolated:!1,parameters:["zoom","feature"]}};function Ks(e){if(e==null)return{filter:function(){return!0},needGeometry:!1};Gs(e)||(e=Xs(e));var t=Zs(e,Wl);if(t.result==="error")throw new Error(t.value.map(function(i){return i.key+": "+i.message}).join(", "));return{filter:function(i,l,f){return t.value.evaluate(i,l,{},f)},needGeometry:function i(l){if(!Array.isArray(l))return!1;if(l[0]==="within")return!0;for(var f=1;f<l.length;f++)if(i(l[f]))return!0;return!1}(e)}}function Kh(e,t){return e<t?-1:e>t?1:0}function Xs(e){if(!e)return!0;var t,i=e[0];return e.length<=1?i!=="any":i==="=="?Hl(e[1],e[2],"=="):i==="!="?Ws(Hl(e[1],e[2],"==")):i==="<"||i===">"||i==="<="||i===">="?Hl(e[1],e[2],i):i==="any"?(t=e.slice(1),["any"].concat(t.map(Xs))):i==="all"?["all"].concat(e.slice(1).map(Xs)):i==="none"?["all"].concat(e.slice(1).map(Xs).map(Ws)):i==="in"?kc(e[1],e.slice(2)):i==="!in"?Ws(kc(e[1],e.slice(2))):i==="has"?Ec(e[1]):i==="!has"?Ws(Ec(e[1])):i!=="within"||e}function Hl(e,t,i){switch(e){case"$type":return["filter-type-"+i,t];case"$id":return["filter-id-"+i,t];default:return["filter-"+i,e,t]}}function kc(e,t){if(t.length===0)return!1;switch(e){case"$type":return["filter-type-in",["literal",t]];case"$id":return["filter-id-in",["literal",t]];default:return t.length>200&&!t.some(function(i){return typeof i!=typeof t[0]})?["filter-in-large",e,["literal",t.sort(Kh)]]:["filter-in-small",e,["literal",t]]}}function Ec(e){switch(e){case"$type":return!0;case"$id":return["filter-has-id"];default:return["filter-has",e]}}function Ws(e){return["!",e]}function Jl(e){return Gs(q(e.value))?wo(Ce({},e,{expressionContext:"filter",valueSpec:{value:"boolean"}})):function t(i){var l=i.value,f=i.key;if(Vr(l)!=="array")return[new J(f,l,"array expected, "+Vr(l)+" found")];var m,x=i.styleSpec,k=[];if(l.length<1)return[new J(f,l,"filter array must have at least 1 element")];switch(k=k.concat(ds({key:f+"[0]",value:l[0],valueSpec:x.filter_operator,style:i.style,styleSpec:i.styleSpec})),De(l[0])){case"<":case"<=":case">":case">=":l.length>=2&&De(l[1])==="$type"&&k.push(new J(f,l,'"$type" cannot be use with operator "'+l[0]+'"'));case"==":case"!=":l.length!==3&&k.push(new J(f,l,'filter array for operator "'+l[0]+'" must have 3 elements'));case"in":case"!in":l.length>=2&&(m=Vr(l[1]))!=="string"&&k.push(new J(f+"[1]",l[1],"string expected, "+m+" found"));for(var I=2;I<l.length;I++)m=Vr(l[I]),De(l[1])==="$type"?k=k.concat(ds({key:f+"["+I+"]",value:l[I],valueSpec:x.geometry_type,style:i.style,styleSpec:i.styleSpec})):m!=="string"&&m!=="number"&&m!=="boolean"&&k.push(new J(f+"["+I+"]",l[I],"string, number, or boolean expected, "+m+" found"));break;case"any":case"all":case"none":for(var A=1;A<l.length;A++)k=k.concat(t({key:f+"["+A+"]",value:l[A],style:i.style,styleSpec:i.styleSpec}));break;case"has":case"!has":m=Vr(l[1]),l.length!==2?k.push(new J(f,l,'filter array for "'+l[0]+'" operator must have 2 elements')):m!=="string"&&k.push(new J(f+"[1]",l[1],"string expected, "+m+" found"));break;case"within":m=Vr(l[1]),l.length!==2?k.push(new J(f,l,'filter array for "'+l[0]+'" operator must have 2 elements')):m!=="object"&&k.push(new J(f+"[1]",l[1],"object expected, "+m+" found"))}return k}(e)}function Yl(e,t){var i=e.key,l=e.style,f=e.styleSpec,m=e.value,x=e.objectKey,k=f[t+"_"+e.layerType];if(!k)return[];var I=x.match(/^(.*)-transition$/);if(t==="paint"&&I&&k[I[1]]&&k[I[1]].transition)return dr({key:i,value:m,valueSpec:f.transition,style:l,styleSpec:f});var A,C=e.valueSpec||k[x];if(!C)return[new J(i,m,'unknown property "'+x+'"')];if(Vr(m)==="string"&&xo(C)&&!C.tokens&&(A=/^{([^}]+)}$/.exec(m)))return[new J(i,m,'"'+x+'" does not support interpolation syntax\nUse an identity property function instead: `{ "type": "identity", "property": '+JSON.stringify(A[1])+" }`.")];var B=[];return e.layerType==="symbol"&&(x==="text-field"&&l&&!l.glyphs&&B.push(new J(i,m,'use of "text-field" requires a style "glyphs" property')),x==="text-font"&&js(q(m))&&De(m.type)==="identity"&&B.push(new J(i,m,'"text-font" does not support identity functions'))),B.concat(dr({key:e.key,value:m,valueSpec:C,style:l,styleSpec:f,expressionContext:"property",propertyType:t,propertyKey:x}))}function Ql(e){return Yl(e,"paint")}function ms(e){return Yl(e,"layout")}function Tc(e){var t=[],i=e.value,l=e.key,f=e.style,m=e.styleSpec;i.type||i.ref||t.push(new J(l,i,'either "type" or "ref" is required'));var x,k=De(i.type),I=De(i.ref);if(i.id)for(var A=De(i.id),C=0;C<e.arrayIndex;C++){var B=f.layers[C];De(B.id)===A&&t.push(new J(l,i.id,'duplicate layer id "'+i.id+'", previously used at line '+B.id.__line__))}if("ref"in i)["type","source","source-layer","filter","layout"].forEach(function(Q){Q in i&&t.push(new J(l,i[Q],'"'+Q+'" is prohibited for ref layers'))}),f.layers.forEach(function(Q){De(Q.id)===I&&(x=Q)}),x?x.ref?t.push(new J(l,i.ref,"ref cannot reference another ref layer")):k=De(x.type):t.push(new J(l,i.ref,'ref layer "'+I+'" not found'));else if(k!=="background")if(i.source){var U=f.sources&&f.sources[i.source],Z=U&&De(U.type);U?Z==="vector"&&k==="raster"?t.push(new J(l,i.source,'layer "'+i.id+'" requires a raster source')):Z==="raster"&&k!=="raster"?t.push(new J(l,i.source,'layer "'+i.id+'" requires a vector source')):Z!=="vector"||i["source-layer"]?Z==="raster-dem"&&k!=="hillshade"?t.push(new J(l,i.source,"raster-dem source can only be used with layer type 'hillshade'.")):k!=="line"||!i.paint||!i.paint["line-gradient"]||Z==="geojson"&&U.lineMetrics||t.push(new J(l,i,'layer "'+i.id+'" specifies a line-gradient, which requires a GeoJSON source with `lineMetrics` enabled.')):t.push(new J(l,i,'layer "'+i.id+'" must specify a "source-layer"')):t.push(new J(l,i.source,'source "'+i.source+'" not found'))}else t.push(new J(l,i,'missing required property "source"'));return t=t.concat(fa({key:l,value:i,valueSpec:m.layer,style:e.style,styleSpec:e.styleSpec,objectElementValidators:{"*":function(){return[]},type:function(){return dr({key:l+".type",value:i.type,valueSpec:m.layer.type,style:e.style,styleSpec:e.styleSpec,object:i,objectKey:"type"})},filter:Jl,layout:function(Q){return fa({layer:i,key:Q.key,value:Q.value,style:Q.style,styleSpec:Q.styleSpec,objectElementValidators:{"*":function(ee){return ms(Ce({layerType:k},ee))}}})},paint:function(Q){return fa({layer:i,key:Q.key,value:Q.value,style:Q.style,styleSpec:Q.styleSpec,objectElementValidators:{"*":function(ee){return Ql(Ce({layerType:k},ee))}}})}}}))}function So(e){var t=e.value,i=e.key,l=Vr(t);return l!=="string"?[new J(i,t,"string expected, "+l+" found")]:[]}var Jr={promoteId:function(e){var t=e.key,i=e.value;if(Vr(i)==="string")return So({key:t,value:i});var l=[];for(var f in i)l.push.apply(l,So({key:t+"."+f,value:i[f]}));return l}};function Hs(e){var t=e.value,i=e.key,l=e.styleSpec,f=e.style;if(!t.type)return[new J(i,t,'"type" is required')];var m,x=De(t.type);switch(x){case"vector":case"raster":case"raster-dem":return fa({key:i,value:t,valueSpec:l["source_"+x.replace("-","_")],style:e.style,styleSpec:l,objectElementValidators:Jr});case"geojson":if(m=fa({key:i,value:t,valueSpec:l.source_geojson,style:f,styleSpec:l,objectElementValidators:Jr}),t.cluster)for(var k in t.clusterProperties){var I=t.clusterProperties[k],A=I[0],C=typeof A=="string"?[A,["accumulated"],["get",k]]:A;m.push.apply(m,wo({key:i+"."+k+".map",value:I[1],expressionContext:"cluster-map"})),m.push.apply(m,wo({key:i+"."+k+".reduce",value:C,expressionContext:"cluster-reduce"}))}return m;case"video":return fa({key:i,value:t,valueSpec:l.source_video,style:f,styleSpec:l});case"image":return fa({key:i,value:t,valueSpec:l.source_image,style:f,styleSpec:l});case"canvas":return[new J(i,null,"Please use runtime APIs to add canvas sources, rather than including them in stylesheets.","source.canvas")];default:return ds({key:i+".type",value:t.type,valueSpec:{values:["vector","raster","raster-dem","geojson","video","image"]},style:f,styleSpec:l})}}function ko(e){var t=e.value,i=e.styleSpec,l=i.light,f=e.style,m=[],x=Vr(t);if(t===void 0)return m;if(x!=="object")return m.concat([new J("light",t,"object expected, "+x+" found")]);for(var k in t){var I=k.match(/^(.*)-transition$/);m=m.concat(I&&l[I[1]]&&l[I[1]].transition?dr({key:k,value:t[k],valueSpec:i.transition,style:f,styleSpec:i}):l[k]?dr({key:k,value:t[k],valueSpec:l[k],style:f,styleSpec:i}):[new J(k,t[k],'unknown property "'+k+'"')])}return m}var Wa={"*":function(){return[]},array:xc,boolean:function(e){var t=e.value,i=e.key,l=Vr(t);return l!=="boolean"?[new J(i,t,"boolean expected, "+l+" found")]:[]},number:wc,color:function(e){var t=e.key,i=e.value,l=Vr(i);return l!=="string"?[new J(t,i,"color expected, "+l+" found")]:Gt(i)===null?[new J(t,i,'color expected, "'+i+'" found')]:[]},constants:ge,enum:ds,filter:Jl,function:Sc,layer:Tc,object:fa,source:Hs,light:ko,string:So,formatted:function(e){return So(e).length===0?[]:wo(e)},resolvedImage:function(e){return So(e).length===0?[]:wo(e)}};function dr(e){var t=e.value,i=e.valueSpec,l=e.styleSpec;return i.expression&&js(De(t))?Sc(e):i.expression&&ps(q(t))?wo(e):i.type&&Wa[i.type]?Wa[i.type](e):fa(Ce({},e,{valueSpec:i.type?l[i.type]:i}))}function jr(e){var t=e.value,i=e.key,l=So(e);return l.length||(t.indexOf("{fontstack}")===-1&&l.push(new J(i,t,'"glyphs" url must include a "{fontstack}" token')),t.indexOf("{range}")===-1&&l.push(new J(i,t,'"glyphs" url must include a "{range}" token'))),l}function ea(e,t){t===void 0&&(t=j);var i=[];return i=i.concat(dr({key:"",value:e,valueSpec:t.$root,styleSpec:t,style:e,objectElementValidators:{glyphs:jr,"*":function(){return[]}}})),e.constants&&(i=i.concat(ge({key:"constants",value:e.constants,style:e,styleSpec:t}))),ys(i)}function ys(e){return[].concat(e).sort(function(t,i){return t.line-i.line})}function qo(e){return function(){for(var t=[],i=arguments.length;i--;)t[i]=arguments[i];return ys(e.apply(this,t))}}ea.source=qo(Hs),ea.light=qo(ko),ea.layer=qo(Tc),ea.filter=qo(Jl),ea.paintProperty=qo(Ql),ea.layoutProperty=qo(ms);var gs=ea,Xh=gs.light,Wh=gs.paintProperty,_s=gs.layoutProperty;function vs(e,t){var i=!1;if(t&&t.length)for(var l=0,f=t;l<f.length;l+=1)e.fire(new se(new Error(f[l].message))),i=!0;return i}var Ca=zi;function zi(e,t,i){var l=this.cells=[];if(e instanceof ArrayBuffer){this.arrayBuffer=e;var f=new Int32Array(this.arrayBuffer);e=f[0],this.d=(t=f[1])+2*(i=f[2]);for(var m=0;m<this.d*this.d;m++){var x=f[3+m],k=f[3+m+1];l.push(x===k?null:f.subarray(x,k))}var I=f[3+l.length+1];this.keys=f.subarray(f[3+l.length],I),this.bboxes=f.subarray(I),this.insert=this._insertReadonly}else{this.d=t+2*i;for(var A=0;A<this.d*this.d;A++)l.push([]);this.keys=[],this.bboxes=[]}this.n=t,this.extent=e,this.padding=i,this.scale=t/e,this.uid=0;var C=i/t*e;this.min=-C,this.max=e+C}zi.prototype.insert=function(e,t,i,l,f){this._forEachCell(t,i,l,f,this._insertCell,this.uid++),this.keys.push(e),this.bboxes.push(t),this.bboxes.push(i),this.bboxes.push(l),this.bboxes.push(f)},zi.prototype._insertReadonly=function(){throw"Cannot insert into a GridIndex created from an ArrayBuffer."},zi.prototype._insertCell=function(e,t,i,l,f,m){this.cells[f].push(m)},zi.prototype.query=function(e,t,i,l,f){var m=this.min,x=this.max;if(e<=m&&t<=m&&x<=i&&x<=l&&!f)return Array.prototype.slice.call(this.keys);var k=[];return this._forEachCell(e,t,i,l,this._queryCell,k,{},f),k},zi.prototype._queryCell=function(e,t,i,l,f,m,x,k){var I=this.cells[f];if(I!==null)for(var A=this.keys,C=this.bboxes,B=0;B<I.length;B++){var U=I[B];if(x[U]===void 0){var Z=4*U;(k?k(C[Z+0],C[Z+1],C[Z+2],C[Z+3]):e<=C[Z+2]&&t<=C[Z+3]&&i>=C[Z+0]&&l>=C[Z+1])?(x[U]=!0,m.push(A[U])):x[U]=!1}}},zi.prototype._forEachCell=function(e,t,i,l,f,m,x,k){for(var I=this._convertToCellCoord(e),A=this._convertToCellCoord(t),C=this._convertToCellCoord(i),B=this._convertToCellCoord(l),U=I;U<=C;U++)for(var Z=A;Z<=B;Z++){var Q=this.d*Z+U;if((!k||k(this._convertFromCellCoord(U),this._convertFromCellCoord(Z),this._convertFromCellCoord(U+1),this._convertFromCellCoord(Z+1)))&&f.call(this,e,t,i,l,Q,m,x,k))return}},zi.prototype._convertFromCellCoord=function(e){return(e-this.padding)/this.scale},zi.prototype._convertToCellCoord=function(e){return Math.max(0,Math.min(this.d-1,Math.floor(e*this.scale)+this.padding))},zi.prototype.toArrayBuffer=function(){if(this.arrayBuffer)return this.arrayBuffer;for(var e=this.cells,t=3+this.cells.length+1+1,i=0,l=0;l<this.cells.length;l++)i+=this.cells[l].length;var f=new Int32Array(t+i+this.keys.length+this.bboxes.length);f[0]=this.extent,f[1]=this.n,f[2]=this.padding;for(var m=t,x=0;x<e.length;x++){var k=e[x];f[3+x]=m,f.set(k,m),m+=k.length}return f[3+e.length]=m,f.set(this.keys,m),f[3+e.length+1]=m+=this.keys.length,f.set(this.bboxes,m),m+=this.bboxes.length,f.buffer};var bs=D.ImageData,zc=D.ImageBitmap,wi={};function ut(e,t,i){i===void 0&&(i={}),Object.defineProperty(t,"_classRegistryKey",{value:e,writeable:!1}),wi[e]={klass:t,omit:i.omit||[],shallow:i.shallow||[]}}for(var qn in ut("Object",Object),Ca.serialize=function(e,t){var i=e.toArrayBuffer();return t&&t.push(i),{buffer:i}},Ca.deserialize=function(e){return new Ca(e.buffer)},ut("Grid",Ca),ut("Color",ar),ut("Error",Error),ut("ResolvedImage",Di),ut("StylePropertyFunction",jo),ut("StyleExpression",Uo,{omit:["_evaluator"]}),ut("ZoomDependentExpression",Vo),ut("ZoomConstantExpression",fs),ut("CompoundExpression",Ti,{omit:["_evaluate"]}),_o)_o[qn]._classRegistryKey||ut("Expression_"+qn,_o[qn]);function Js(e){return e&&typeof ArrayBuffer<"u"&&(e instanceof ArrayBuffer||e.constructor&&e.constructor.name==="ArrayBuffer")}function Zo(e){return zc&&e instanceof zc}function da(e,t){if(e==null||typeof e=="boolean"||typeof e=="number"||typeof e=="string"||e instanceof Boolean||e instanceof Number||e instanceof String||e instanceof Date||e instanceof RegExp)return e;if(Js(e)||Zo(e))return t&&t.push(e),e;if(ArrayBuffer.isView(e)){var i=e;return t&&t.push(i.buffer),i}if(e instanceof bs)return t&&t.push(e.data.buffer),e;if(Array.isArray(e)){for(var l=[],f=0,m=e;f<m.length;f+=1)l.push(da(m[f],t));return l}if(typeof e=="object"){var x=e.constructor,k=x._classRegistryKey;if(!k)throw new Error("can't serialize object of unregistered class");var I=x.serialize?x.serialize(e,t):{};if(!x.serialize){for(var A in e)if(e.hasOwnProperty(A)&&!(wi[k].omit.indexOf(A)>=0)){var C=e[A];I[A]=wi[k].shallow.indexOf(A)>=0?C:da(C,t)}e instanceof Error&&(I.message=e.message)}if(I.$name)throw new Error("$name property is reserved for worker serialization logic.");return k!=="Object"&&(I.$name=k),I}throw new Error("can't serialize object of type "+typeof e)}function Zn(e){if(e==null||typeof e=="boolean"||typeof e=="number"||typeof e=="string"||e instanceof Boolean||e instanceof Number||e instanceof String||e instanceof Date||e instanceof RegExp||Js(e)||Zo(e)||ArrayBuffer.isView(e)||e instanceof bs)return e;if(Array.isArray(e))return e.map(Zn);if(typeof e=="object"){var t=e.$name||"Object",i=wi[t].klass;if(!i)throw new Error("can't deserialize unregistered class "+t);if(i.deserialize)return i.deserialize(e);for(var l=Object.create(i.prototype),f=0,m=Object.keys(e);f<m.length;f+=1){var x=m[f];if(x!=="$name"){var k=e[x];l[x]=wi[t].shallow.indexOf(x)>=0?k:Zn(k)}}return l}throw new Error("can't deserialize object of type "+typeof e)}var $l=function(){this.first=!0};$l.prototype.update=function(e,t){var i=Math.floor(e);return this.first?(this.first=!1,this.lastIntegerZoom=i,this.lastIntegerZoomTime=0,this.lastZoom=e,this.lastFloorZoom=i,!0):(this.lastFloorZoom>i?(this.lastIntegerZoom=i+1,this.lastIntegerZoomTime=t):this.lastFloorZoom<i&&(this.lastIntegerZoom=i,this.lastIntegerZoomTime=t),e!==this.lastZoom&&(this.lastZoom=e,this.lastFloorZoom=i,!0))};var et={"Latin-1 Supplement":function(e){return e>=128&&e<=255},Arabic:function(e){return e>=1536&&e<=1791},"Arabic Supplement":function(e){return e>=1872&&e<=1919},"Arabic Extended-A":function(e){return e>=2208&&e<=2303},"Hangul Jamo":function(e){return e>=4352&&e<=4607},"Unified Canadian Aboriginal Syllabics":function(e){return e>=5120&&e<=5759},Khmer:function(e){return e>=6016&&e<=6143},"Unified Canadian Aboriginal Syllabics Extended":function(e){return e>=6320&&e<=6399},"General Punctuation":function(e){return e>=8192&&e<=8303},"Letterlike Symbols":function(e){return e>=8448&&e<=8527},"Number Forms":function(e){return e>=8528&&e<=8591},"Miscellaneous Technical":function(e){return e>=8960&&e<=9215},"Control Pictures":function(e){return e>=9216&&e<=9279},"Optical Character Recognition":function(e){return e>=9280&&e<=9311},"Enclosed Alphanumerics":function(e){return e>=9312&&e<=9471},"Geometric Shapes":function(e){return e>=9632&&e<=9727},"Miscellaneous Symbols":function(e){return e>=9728&&e<=9983},"Miscellaneous Symbols and Arrows":function(e){return e>=11008&&e<=11263},"CJK Radicals Supplement":function(e){return e>=11904&&e<=12031},"Kangxi Radicals":function(e){return e>=12032&&e<=12255},"Ideographic Description Characters":function(e){return e>=12272&&e<=12287},"CJK Symbols and Punctuation":function(e){return e>=12288&&e<=12351},Hiragana:function(e){return e>=12352&&e<=12447},Katakana:function(e){return e>=12448&&e<=12543},Bopomofo:function(e){return e>=12544&&e<=12591},"Hangul Compatibility Jamo":function(e){return e>=12592&&e<=12687},Kanbun:function(e){return e>=12688&&e<=12703},"Bopomofo Extended":function(e){return e>=12704&&e<=12735},"CJK Strokes":function(e){return e>=12736&&e<=12783},"Katakana Phonetic Extensions":function(e){return e>=12784&&e<=12799},"Enclosed CJK Letters and Months":function(e){return e>=12800&&e<=13055},"CJK Compatibility":function(e){return e>=13056&&e<=13311},"CJK Unified Ideographs Extension A":function(e){return e>=13312&&e<=19903},"Yijing Hexagram Symbols":function(e){return e>=19904&&e<=19967},"CJK Unified Ideographs":function(e){return e>=19968&&e<=40959},"Yi Syllables":function(e){return e>=40960&&e<=42127},"Yi Radicals":function(e){return e>=42128&&e<=42191},"Hangul Jamo Extended-A":function(e){return e>=43360&&e<=43391},"Hangul Syllables":function(e){return e>=44032&&e<=55215},"Hangul Jamo Extended-B":function(e){return e>=55216&&e<=55295},"Private Use Area":function(e){return e>=57344&&e<=63743},"CJK Compatibility Ideographs":function(e){return e>=63744&&e<=64255},"Arabic Presentation Forms-A":function(e){return e>=64336&&e<=65023},"Vertical Forms":function(e){return e>=65040&&e<=65055},"CJK Compatibility Forms":function(e){return e>=65072&&e<=65103},"Small Form Variants":function(e){return e>=65104&&e<=65135},"Arabic Presentation Forms-B":function(e){return e>=65136&&e<=65279},"Halfwidth and Fullwidth Forms":function(e){return e>=65280&&e<=65519}};function eu(e){for(var t=0,i=e;t<i.length;t+=1)if(Ys(i[t].charCodeAt(0)))return!0;return!1}function Ys(e){return!(e!==746&&e!==747&&(e<4352||!(et["Bopomofo Extended"](e)||et.Bopomofo(e)||et["CJK Compatibility Forms"](e)&&!(e>=65097&&e<=65103)||et["CJK Compatibility Ideographs"](e)||et["CJK Compatibility"](e)||et["CJK Radicals Supplement"](e)||et["CJK Strokes"](e)||!(!et["CJK Symbols and Punctuation"](e)||e>=12296&&e<=12305||e>=12308&&e<=12319||e===12336)||et["CJK Unified Ideographs Extension A"](e)||et["CJK Unified Ideographs"](e)||et["Enclosed CJK Letters and Months"](e)||et["Hangul Compatibility Jamo"](e)||et["Hangul Jamo Extended-A"](e)||et["Hangul Jamo Extended-B"](e)||et["Hangul Jamo"](e)||et["Hangul Syllables"](e)||et.Hiragana(e)||et["Ideographic Description Characters"](e)||et.Kanbun(e)||et["Kangxi Radicals"](e)||et["Katakana Phonetic Extensions"](e)||et.Katakana(e)&&e!==12540||!(!et["Halfwidth and Fullwidth Forms"](e)||e===65288||e===65289||e===65293||e>=65306&&e<=65310||e===65339||e===65341||e===65343||e>=65371&&e<=65503||e===65507||e>=65512&&e<=65519)||!(!et["Small Form Variants"](e)||e>=65112&&e<=65118||e>=65123&&e<=65126)||et["Unified Canadian Aboriginal Syllabics"](e)||et["Unified Canadian Aboriginal Syllabics Extended"](e)||et["Vertical Forms"](e)||et["Yijing Hexagram Symbols"](e)||et["Yi Syllables"](e)||et["Yi Radicals"](e))))}function tu(e){return!(Ys(e)||function(t){return!!(et["Latin-1 Supplement"](t)&&(t===167||t===169||t===174||t===177||t===188||t===189||t===190||t===215||t===247)||et["General Punctuation"](t)&&(t===8214||t===8224||t===8225||t===8240||t===8241||t===8251||t===8252||t===8258||t===8263||t===8264||t===8265||t===8273)||et["Letterlike Symbols"](t)||et["Number Forms"](t)||et["Miscellaneous Technical"](t)&&(t>=8960&&t<=8967||t>=8972&&t<=8991||t>=8996&&t<=9e3||t===9003||t>=9085&&t<=9114||t>=9150&&t<=9165||t===9167||t>=9169&&t<=9179||t>=9186&&t<=9215)||et["Control Pictures"](t)&&t!==9251||et["Optical Character Recognition"](t)||et["Enclosed Alphanumerics"](t)||et["Geometric Shapes"](t)||et["Miscellaneous Symbols"](t)&&!(t>=9754&&t<=9759)||et["Miscellaneous Symbols and Arrows"](t)&&(t>=11026&&t<=11055||t>=11088&&t<=11097||t>=11192&&t<=11243)||et["CJK Symbols and Punctuation"](t)||et.Katakana(t)||et["Private Use Area"](t)||et["CJK Compatibility Forms"](t)||et["Small Form Variants"](t)||et["Halfwidth and Fullwidth Forms"](t)||t===8734||t===8756||t===8757||t>=9984&&t<=10087||t>=10102&&t<=10131||t===65532||t===65533)}(e))}function na(e){return e>=1424&&e<=2303||et["Arabic Presentation Forms-A"](e)||et["Arabic Presentation Forms-B"](e)}function Gn(e,t){return!(!t&&na(e)||e>=2304&&e<=3583||e>=3840&&e<=4255||et.Khmer(e))}function Qs(e){for(var t=0,i=e;t<i.length;t+=1)if(na(i[t].charCodeAt(0)))return!0;return!1}var $s=null,Kn="unavailable",Ma=null,Ic=function(e){e&&typeof e=="string"&&e.indexOf("NetworkError")>-1&&(Kn="error"),$s&&$s(e)};function xs(){ru.fire(new $("pluginStateChange",{pluginStatus:Kn,pluginURL:Ma}))}var ru=new he,iu=function(){return Kn},ma=function(){if(Kn!=="deferred"||!Ma)throw new Error("rtl-text-plugin cannot be downloaded unless a pluginURL is specified");Kn="loading",xs(),Ma&&oi({url:Ma},function(e){e?Ic(e):(Kn="loaded",xs())})},ta={applyArabicShaping:null,processBidirectionalText:null,processStyledBidirectionalText:null,isLoaded:function(){return Kn==="loaded"||ta.applyArabicShaping!=null},isLoading:function(){return Kn==="loading"},setState:function(e){Kn=e.pluginStatus,Ma=e.pluginURL},isParsed:function(){return ta.applyArabicShaping!=null&&ta.processBidirectionalText!=null&&ta.processStyledBidirectionalText!=null},getPluginURL:function(){return Ma}},ur=function(e,t){this.zoom=e,t?(this.now=t.now,this.fadeDuration=t.fadeDuration,this.zoomHistory=t.zoomHistory,this.transition=t.transition):(this.now=0,this.fadeDuration=0,this.zoomHistory=new $l,this.transition={})};ur.prototype.isSupportedScript=function(e){return function(t,i){for(var l=0,f=t;l<f.length;l+=1)if(!Gn(f[l].charCodeAt(0),i))return!1;return!0}(e,ta.isLoaded())},ur.prototype.crossFadingFactor=function(){return this.fadeDuration===0?1:Math.min((this.now-this.zoomHistory.lastIntegerZoomTime)/this.fadeDuration,1)},ur.prototype.getCrossfadeParameters=function(){var e=this.zoom,t=e-Math.floor(e),i=this.crossFadingFactor();return e>this.zoomHistory.lastIntegerZoom?{fromScale:2,toScale:1,t:t+(1-t)*i}:{fromScale:.5,toScale:1,t:1-(1-i)*t}};var Ea=function(e,t){this.property=e,this.value=t,this.expression=function(i,l){if(js(i))return new jo(i,l);if(ps(i)){var f=bc(i,l);if(f.result==="error")throw new Error(f.value.map(function(x){return x.key+": "+x.message}).join(", "));return f.value}var m=i;return typeof i=="string"&&l.type==="color"&&(m=ar.parse(i)),{kind:"constant",evaluate:function(){return m}}}(t===void 0?e.specification.default:t,e.specification)};Ea.prototype.isDataDriven=function(){return this.expression.kind==="source"||this.expression.kind==="composite"},Ea.prototype.possiblyEvaluate=function(e,t,i){return this.property.possiblyEvaluate(this,e,t,i)};var aa=function(e){this.property=e,this.value=new Ea(e,void 0)};aa.prototype.transitioned=function(e,t){return new Eo(this.property,this.value,t,xe({},e.transition,this.transition),e.now)},aa.prototype.untransitioned=function(){return new Eo(this.property,this.value,null,{},0)};var nn=function(e){this._properties=e,this._values=Object.create(e.defaultTransitionablePropertyValues)};nn.prototype.getValue=function(e){return pt(this._values[e].value.value)},nn.prototype.setValue=function(e,t){this._values.hasOwnProperty(e)||(this._values[e]=new aa(this._values[e].property)),this._values[e].value=new Ea(this._values[e].property,t===null?void 0:pt(t))},nn.prototype.getTransition=function(e){return pt(this._values[e].transition)},nn.prototype.setTransition=function(e,t){this._values.hasOwnProperty(e)||(this._values[e]=new aa(this._values[e].property)),this._values[e].transition=pt(t)||void 0},nn.prototype.serialize=function(){for(var e={},t=0,i=Object.keys(this._values);t<i.length;t+=1){var l=i[t],f=this.getValue(l);f!==void 0&&(e[l]=f);var m=this.getTransition(l);m!==void 0&&(e[l+"-transition"]=m)}return e},nn.prototype.transitioned=function(e,t){for(var i=new Ha(this._properties),l=0,f=Object.keys(this._values);l<f.length;l+=1){var m=f[l];i._values[m]=this._values[m].transitioned(e,t._values[m])}return i},nn.prototype.untransitioned=function(){for(var e=new Ha(this._properties),t=0,i=Object.keys(this._values);t<i.length;t+=1){var l=i[t];e._values[l]=this._values[l].untransitioned()}return e};var Eo=function(e,t,i,l,f){this.property=e,this.value=t,this.begin=f+l.delay||0,this.end=this.begin+l.duration||0,e.specification.transition&&(l.delay||l.duration)&&(this.prior=i)};Eo.prototype.possiblyEvaluate=function(e,t,i){var l=e.now||0,f=this.value.possiblyEvaluate(e,t,i),m=this.prior;if(m){if(l>this.end)return this.prior=null,f;if(this.value.isDataDriven())return this.prior=null,f;if(l<this.begin)return m.possiblyEvaluate(e,t,i);var x=(l-this.begin)/(this.end-this.begin);return this.property.interpolate(m.possiblyEvaluate(e,t,i),f,function(k){if(k<=0)return 0;if(k>=1)return 1;var I=k*k,A=I*k;return 4*(k<.5?A:3*(k-I)+A-.75)}(x))}return f};var Ha=function(e){this._properties=e,this._values=Object.create(e.defaultTransitioningPropertyValues)};Ha.prototype.possiblyEvaluate=function(e,t,i){for(var l=new ws(this._properties),f=0,m=Object.keys(this._values);f<m.length;f+=1){var x=m[f];l._values[x]=this._values[x].possiblyEvaluate(e,t,i)}return l},Ha.prototype.hasTransition=function(){for(var e=0,t=Object.keys(this._values);e<t.length;e+=1)if(this._values[t[e]].prior)return!0;return!1};var ya=function(e){this._properties=e,this._values=Object.create(e.defaultPropertyValues)};ya.prototype.getValue=function(e){return pt(this._values[e].value)},ya.prototype.setValue=function(e,t){this._values[e]=new Ea(this._values[e].property,t===null?void 0:pt(t))},ya.prototype.serialize=function(){for(var e={},t=0,i=Object.keys(this._values);t<i.length;t+=1){var l=i[t],f=this.getValue(l);f!==void 0&&(e[l]=f)}return e},ya.prototype.possiblyEvaluate=function(e,t,i){for(var l=new ws(this._properties),f=0,m=Object.keys(this._values);f<m.length;f+=1){var x=m[f];l._values[x]=this._values[x].possiblyEvaluate(e,t,i)}return l};var wn=function(e,t,i){this.property=e,this.value=t,this.parameters=i};wn.prototype.isConstant=function(){return this.value.kind==="constant"},wn.prototype.constantOr=function(e){return this.value.kind==="constant"?this.value.value:e},wn.prototype.evaluate=function(e,t,i,l){return this.property.evaluate(this.value,this.parameters,e,t,i,l)};var ws=function(e){this._properties=e,this._values=Object.create(e.defaultPossiblyEvaluatedValues)};ws.prototype.get=function(e){return this._values[e]};var xt=function(e){this.specification=e};xt.prototype.possiblyEvaluate=function(e,t){return e.expression.evaluate(t)},xt.prototype.interpolate=function(e,t,i){var l=Fo[this.specification.type];return l?l(e,t,i):e};var ft=function(e,t){this.specification=e,this.overrides=t};ft.prototype.possiblyEvaluate=function(e,t,i,l){return new wn(this,e.expression.kind==="constant"||e.expression.kind==="camera"?{kind:"constant",value:e.expression.evaluate(t,null,{},i,l)}:e.expression,t)},ft.prototype.interpolate=function(e,t,i){if(e.value.kind!=="constant"||t.value.kind!=="constant")return e;if(e.value.value===void 0||t.value.value===void 0)return new wn(this,{kind:"constant",value:void 0},e.parameters);var l=Fo[this.specification.type];return l?new wn(this,{kind:"constant",value:l(e.value.value,t.value.value,i)},e.parameters):e},ft.prototype.evaluate=function(e,t,i,l,f,m){return e.kind==="constant"?e.value:e.evaluate(t,i,l,f,m)};var el=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.possiblyEvaluate=function(i,l,f,m){if(i.value===void 0)return new wn(this,{kind:"constant",value:void 0},l);if(i.expression.kind==="constant"){var x=i.expression.evaluate(l,null,{},f,m),k=i.property.specification.type==="resolvedImage"&&typeof x!="string"?x.name:x,I=this._calculate(k,k,k,l);return new wn(this,{kind:"constant",value:I},l)}if(i.expression.kind==="camera"){var A=this._calculate(i.expression.evaluate({zoom:l.zoom-1}),i.expression.evaluate({zoom:l.zoom}),i.expression.evaluate({zoom:l.zoom+1}),l);return new wn(this,{kind:"constant",value:A},l)}return new wn(this,i.expression,l)},t.prototype.evaluate=function(i,l,f,m,x,k){if(i.kind==="source"){var I=i.evaluate(l,f,m,x,k);return this._calculate(I,I,I,l)}return i.kind==="composite"?this._calculate(i.evaluate({zoom:Math.floor(l.zoom)-1},f,m),i.evaluate({zoom:Math.floor(l.zoom)},f,m),i.evaluate({zoom:Math.floor(l.zoom)+1},f,m),l):i.value},t.prototype._calculate=function(i,l,f,m){return m.zoom>m.zoomHistory.lastIntegerZoom?{from:i,to:l}:{from:f,to:l}},t.prototype.interpolate=function(i){return i},t}(ft),Sn=function(e){this.specification=e};Sn.prototype.possiblyEvaluate=function(e,t,i,l){if(e.value!==void 0){if(e.expression.kind==="constant"){var f=e.expression.evaluate(t,null,{},i,l);return this._calculate(f,f,f,t)}return this._calculate(e.expression.evaluate(new ur(Math.floor(t.zoom-1),t)),e.expression.evaluate(new ur(Math.floor(t.zoom),t)),e.expression.evaluate(new ur(Math.floor(t.zoom+1),t)),t)}},Sn.prototype._calculate=function(e,t,i,l){return l.zoom>l.zoomHistory.lastIntegerZoom?{from:e,to:t}:{from:i,to:t}},Sn.prototype.interpolate=function(e){return e};var ga=function(e){this.specification=e};ga.prototype.possiblyEvaluate=function(e,t,i,l){return!!e.expression.evaluate(t,null,{},i,l)},ga.prototype.interpolate=function(){return!1};var an=function(e){for(var t in this.properties=e,this.defaultPropertyValues={},this.defaultTransitionablePropertyValues={},this.defaultTransitioningPropertyValues={},this.defaultPossiblyEvaluatedValues={},this.overridableProperties=[],e){var i=e[t];i.specification.overridable&&this.overridableProperties.push(t);var l=this.defaultPropertyValues[t]=new Ea(i,void 0),f=this.defaultTransitionablePropertyValues[t]=new aa(i);this.defaultTransitioningPropertyValues[t]=f.untransitioned(),this.defaultPossiblyEvaluatedValues[t]=l.possiblyEvaluate({})}};ut("DataDrivenProperty",ft),ut("DataConstantProperty",xt),ut("CrossFadedDataDrivenProperty",el),ut("CrossFadedProperty",Sn),ut("ColorRampProperty",ga);var Ta=function(e){function t(i,l){if(e.call(this),this.id=i.id,this.type=i.type,this._featureFilter={filter:function(){return!0},needGeometry:!1},i.type!=="custom"&&(this.metadata=(i=i).metadata,this.minzoom=i.minzoom,this.maxzoom=i.maxzoom,i.type!=="background"&&(this.source=i.source,this.sourceLayer=i["source-layer"],this.filter=i.filter),l.layout&&(this._unevaluatedLayout=new ya(l.layout)),l.paint)){for(var f in this._transitionablePaint=new nn(l.paint),i.paint)this.setPaintProperty(f,i.paint[f],{validate:!1});for(var m in i.layout)this.setLayoutProperty(m,i.layout[m],{validate:!1});this._transitioningPaint=this._transitionablePaint.untransitioned(),this.paint=new ws(l.paint)}}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.getCrossfadeParameters=function(){return this._crossfadeParameters},t.prototype.getLayoutProperty=function(i){return i==="visibility"?this.visibility:this._unevaluatedLayout.getValue(i)},t.prototype.setLayoutProperty=function(i,l,f){f===void 0&&(f={}),l!=null&&this._validate(_s,"layers."+this.id+".layout."+i,i,l,f)||(i!=="visibility"?this._unevaluatedLayout.setValue(i,l):this.visibility=l)},t.prototype.getPaintProperty=function(i){return Ue(i,"-transition")?this._transitionablePaint.getTransition(i.slice(0,-11)):this._transitionablePaint.getValue(i)},t.prototype.setPaintProperty=function(i,l,f){if(f===void 0&&(f={}),l!=null&&this._validate(Wh,"layers."+this.id+".paint."+i,i,l,f))return!1;if(Ue(i,"-transition"))return this._transitionablePaint.setTransition(i.slice(0,-11),l||void 0),!1;var m=this._transitionablePaint._values[i],x=m.property.specification["property-type"]==="cross-faded-data-driven",k=m.value.isDataDriven(),I=m.value;this._transitionablePaint.setValue(i,l),this._handleSpecialPaintPropertyUpdate(i);var A=this._transitionablePaint._values[i].value;return A.isDataDriven()||k||x||this._handleOverridablePaintPropertyUpdate(i,I,A)},t.prototype._handleSpecialPaintPropertyUpdate=function(i){},t.prototype._handleOverridablePaintPropertyUpdate=function(i,l,f){return!1},t.prototype.isHidden=function(i){return!!(this.minzoom&&i<this.minzoom)||!!(this.maxzoom&&i>=this.maxzoom)||this.visibility==="none"},t.prototype.updateTransitions=function(i){this._transitioningPaint=this._transitionablePaint.transitioned(i,this._transitioningPaint)},t.prototype.hasTransition=function(){return this._transitioningPaint.hasTransition()},t.prototype.recalculate=function(i,l){i.getCrossfadeParameters&&(this._crossfadeParameters=i.getCrossfadeParameters()),this._unevaluatedLayout&&(this.layout=this._unevaluatedLayout.possiblyEvaluate(i,void 0,l)),this.paint=this._transitioningPaint.possiblyEvaluate(i,void 0,l)},t.prototype.serialize=function(){var i={id:this.id,type:this.type,source:this.source,"source-layer":this.sourceLayer,metadata:this.metadata,minzoom:this.minzoom,maxzoom:this.maxzoom,filter:this.filter,layout:this._unevaluatedLayout&&this._unevaluatedLayout.serialize(),paint:this._transitionablePaint&&this._transitionablePaint.serialize()};return this.visibility&&(i.layout=i.layout||{},i.layout.visibility=this.visibility),_t(i,function(l,f){return!(l===void 0||f==="layout"&&!Object.keys(l).length||f==="paint"&&!Object.keys(l).length)})},t.prototype._validate=function(i,l,f,m,x){return x===void 0&&(x={}),(!x||x.validate!==!1)&&vs(this,i.call(gs,{key:l,layerType:this.type,objectKey:f,value:m,styleSpec:j,style:{glyphs:!0,sprite:!0}}))},t.prototype.is3D=function(){return!1},t.prototype.isTileClipped=function(){return!1},t.prototype.hasOffscreenPass=function(){return!1},t.prototype.resize=function(){},t.prototype.isStateDependent=function(){for(var i in this.paint._values){var l=this.paint.get(i);if(l instanceof wn&&xo(l.property.specification)&&(l.value.kind==="source"||l.value.kind==="composite")&&l.value.isStateDependent)return!0}return!1},t}(he),nu={Int8:Int8Array,Uint8:Uint8Array,Int16:Int16Array,Uint16:Uint16Array,Int32:Int32Array,Uint32:Uint32Array,Float32:Float32Array},tl=function(e,t){this._structArray=e,this._pos1=t*this.size,this._pos2=this._pos1/2,this._pos4=this._pos1/4,this._pos8=this._pos1/8},Pr=function(){this.isTransferred=!1,this.capacity=-1,this.resize(0)};function Ki(e,t){t===void 0&&(t=1);var i=0,l=0;return{members:e.map(function(f){var m=nu[f.type].BYTES_PER_ELEMENT,x=i=Ac(i,Math.max(t,m)),k=f.components||1;return l=Math.max(l,m),i+=m*k,{name:f.name,type:f.type,components:k,offset:x}}),size:Ac(i,Math.max(l,t)),alignment:t}}function Ac(e,t){return Math.ceil(e/t)*t}Pr.serialize=function(e,t){return e._trim(),t&&(e.isTransferred=!0,t.push(e.arrayBuffer)),{length:e.length,arrayBuffer:e.arrayBuffer}},Pr.deserialize=function(e){var t=Object.create(this.prototype);return t.arrayBuffer=e.arrayBuffer,t.length=e.length,t.capacity=e.arrayBuffer.byteLength/t.bytesPerElement,t._refreshViews(),t},Pr.prototype._trim=function(){this.length!==this.capacity&&(this.capacity=this.length,this.arrayBuffer=this.arrayBuffer.slice(0,this.length*this.bytesPerElement),this._refreshViews())},Pr.prototype.clear=function(){this.length=0},Pr.prototype.resize=function(e){this.reserve(e),this.length=e},Pr.prototype.reserve=function(e){if(e>this.capacity){this.capacity=Math.max(e,Math.floor(5*this.capacity),128),this.arrayBuffer=new ArrayBuffer(this.capacity*this.bytesPerElement);var t=this.uint8;this._refreshViews(),t&&this.uint8.set(t)}},Pr.prototype._refreshViews=function(){throw new Error("_refreshViews() must be implemented by each concrete StructArray layout")};var To=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},t.prototype.emplaceBack=function(i,l){var f=this.length;return this.resize(f+1),this.emplace(f,i,l)},t.prototype.emplace=function(i,l,f){var m=2*i;return this.int16[m+0]=l,this.int16[m+1]=f,i},t}(Pr);To.prototype.bytesPerElement=4,ut("StructArrayLayout2i4",To);var au=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},t.prototype.emplaceBack=function(i,l,f,m){var x=this.length;return this.resize(x+1),this.emplace(x,i,l,f,m)},t.prototype.emplace=function(i,l,f,m,x){var k=4*i;return this.int16[k+0]=l,this.int16[k+1]=f,this.int16[k+2]=m,this.int16[k+3]=x,i},t}(Pr);au.prototype.bytesPerElement=8,ut("StructArrayLayout4i8",au);var Da=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},t.prototype.emplaceBack=function(i,l,f,m,x,k){var I=this.length;return this.resize(I+1),this.emplace(I,i,l,f,m,x,k)},t.prototype.emplace=function(i,l,f,m,x,k,I){var A=6*i;return this.int16[A+0]=l,this.int16[A+1]=f,this.int16[A+2]=m,this.int16[A+3]=x,this.int16[A+4]=k,this.int16[A+5]=I,i},t}(Pr);Da.prototype.bytesPerElement=12,ut("StructArrayLayout2i4i12",Da);var Xn=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},t.prototype.emplaceBack=function(i,l,f,m,x,k){var I=this.length;return this.resize(I+1),this.emplace(I,i,l,f,m,x,k)},t.prototype.emplace=function(i,l,f,m,x,k,I){var A=4*i,C=8*i;return this.int16[A+0]=l,this.int16[A+1]=f,this.uint8[C+4]=m,this.uint8[C+5]=x,this.uint8[C+6]=k,this.uint8[C+7]=I,i},t}(Pr);Xn.prototype.bytesPerElement=8,ut("StructArrayLayout2i4ub8",Xn);var Go=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},t.prototype.emplaceBack=function(i,l){var f=this.length;return this.resize(f+1),this.emplace(f,i,l)},t.prototype.emplace=function(i,l,f){var m=2*i;return this.float32[m+0]=l,this.float32[m+1]=f,i},t}(Pr);Go.prototype.bytesPerElement=8,ut("StructArrayLayout2f8",Go);var za=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},t.prototype.emplaceBack=function(i,l,f,m,x,k,I,A,C,B){var U=this.length;return this.resize(U+1),this.emplace(U,i,l,f,m,x,k,I,A,C,B)},t.prototype.emplace=function(i,l,f,m,x,k,I,A,C,B,U){var Z=10*i;return this.uint16[Z+0]=l,this.uint16[Z+1]=f,this.uint16[Z+2]=m,this.uint16[Z+3]=x,this.uint16[Z+4]=k,this.uint16[Z+5]=I,this.uint16[Z+6]=A,this.uint16[Z+7]=C,this.uint16[Z+8]=B,this.uint16[Z+9]=U,i},t}(Pr);za.prototype.bytesPerElement=20,ut("StructArrayLayout10ui20",za);var rl=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},t.prototype.emplaceBack=function(i,l,f,m,x,k,I,A,C,B,U,Z){var Q=this.length;return this.resize(Q+1),this.emplace(Q,i,l,f,m,x,k,I,A,C,B,U,Z)},t.prototype.emplace=function(i,l,f,m,x,k,I,A,C,B,U,Z,Q){var ee=12*i;return this.int16[ee+0]=l,this.int16[ee+1]=f,this.int16[ee+2]=m,this.int16[ee+3]=x,this.uint16[ee+4]=k,this.uint16[ee+5]=I,this.uint16[ee+6]=A,this.uint16[ee+7]=C,this.int16[ee+8]=B,this.int16[ee+9]=U,this.int16[ee+10]=Z,this.int16[ee+11]=Q,i},t}(Pr);rl.prototype.bytesPerElement=24,ut("StructArrayLayout4i4ui4i24",rl);var Ko=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},t.prototype.emplaceBack=function(i,l,f){var m=this.length;return this.resize(m+1),this.emplace(m,i,l,f)},t.prototype.emplace=function(i,l,f,m){var x=3*i;return this.float32[x+0]=l,this.float32[x+1]=f,this.float32[x+2]=m,i},t}(Pr);Ko.prototype.bytesPerElement=12,ut("StructArrayLayout3f12",Ko);var Ss=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)},t.prototype.emplaceBack=function(i){var l=this.length;return this.resize(l+1),this.emplace(l,i)},t.prototype.emplace=function(i,l){return this.uint32[1*i+0]=l,i},t}(Pr);Ss.prototype.bytesPerElement=4,ut("StructArrayLayout1ul4",Ss);var ou=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},t.prototype.emplaceBack=function(i,l,f,m,x,k,I,A,C){var B=this.length;return this.resize(B+1),this.emplace(B,i,l,f,m,x,k,I,A,C)},t.prototype.emplace=function(i,l,f,m,x,k,I,A,C,B){var U=10*i,Z=5*i;return this.int16[U+0]=l,this.int16[U+1]=f,this.int16[U+2]=m,this.int16[U+3]=x,this.int16[U+4]=k,this.int16[U+5]=I,this.uint32[Z+3]=A,this.uint16[U+8]=C,this.uint16[U+9]=B,i},t}(Pr);ou.prototype.bytesPerElement=20,ut("StructArrayLayout6i1ul2ui20",ou);var Xo=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},t.prototype.emplaceBack=function(i,l,f,m,x,k){var I=this.length;return this.resize(I+1),this.emplace(I,i,l,f,m,x,k)},t.prototype.emplace=function(i,l,f,m,x,k,I){var A=6*i;return this.int16[A+0]=l,this.int16[A+1]=f,this.int16[A+2]=m,this.int16[A+3]=x,this.int16[A+4]=k,this.int16[A+5]=I,i},t}(Pr);Xo.prototype.bytesPerElement=12,ut("StructArrayLayout2i2i2i12",Xo);var zo=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},t.prototype.emplaceBack=function(i,l,f,m,x){var k=this.length;return this.resize(k+1),this.emplace(k,i,l,f,m,x)},t.prototype.emplace=function(i,l,f,m,x,k){var I=4*i,A=8*i;return this.float32[I+0]=l,this.float32[I+1]=f,this.float32[I+2]=m,this.int16[A+6]=x,this.int16[A+7]=k,i},t}(Pr);zo.prototype.bytesPerElement=16,ut("StructArrayLayout2f1f2i16",zo);var su=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},t.prototype.emplaceBack=function(i,l,f,m){var x=this.length;return this.resize(x+1),this.emplace(x,i,l,f,m)},t.prototype.emplace=function(i,l,f,m,x){var k=12*i,I=3*i;return this.uint8[k+0]=l,this.uint8[k+1]=f,this.float32[I+1]=m,this.float32[I+2]=x,i},t}(Pr);su.prototype.bytesPerElement=12,ut("StructArrayLayout2ub2f12",su);var Ja=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},t.prototype.emplaceBack=function(i,l,f){var m=this.length;return this.resize(m+1),this.emplace(m,i,l,f)},t.prototype.emplace=function(i,l,f,m){var x=3*i;return this.uint16[x+0]=l,this.uint16[x+1]=f,this.uint16[x+2]=m,i},t}(Pr);Ja.prototype.bytesPerElement=6,ut("StructArrayLayout3ui6",Ja);var Ya=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},t.prototype.emplaceBack=function(i,l,f,m,x,k,I,A,C,B,U,Z,Q,ee,ce,ne,me){var be=this.length;return this.resize(be+1),this.emplace(be,i,l,f,m,x,k,I,A,C,B,U,Z,Q,ee,ce,ne,me)},t.prototype.emplace=function(i,l,f,m,x,k,I,A,C,B,U,Z,Q,ee,ce,ne,me,be){var Se=24*i,ze=12*i,Pe=48*i;return this.int16[Se+0]=l,this.int16[Se+1]=f,this.uint16[Se+2]=m,this.uint16[Se+3]=x,this.uint32[ze+2]=k,this.uint32[ze+3]=I,this.uint32[ze+4]=A,this.uint16[Se+10]=C,this.uint16[Se+11]=B,this.uint16[Se+12]=U,this.float32[ze+7]=Z,this.float32[ze+8]=Q,this.uint8[Pe+36]=ee,this.uint8[Pe+37]=ce,this.uint8[Pe+38]=ne,this.uint32[ze+10]=me,this.int16[Se+22]=be,i},t}(Pr);Ya.prototype.bytesPerElement=48,ut("StructArrayLayout2i2ui3ul3ui2f3ub1ul1i48",Ya);var il=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},t.prototype.emplaceBack=function(i,l,f,m,x,k,I,A,C,B,U,Z,Q,ee,ce,ne,me,be,Se,ze,Pe,Ve,Ye,vt,it,St,nt,Qt){var Rt=this.length;return this.resize(Rt+1),this.emplace(Rt,i,l,f,m,x,k,I,A,C,B,U,Z,Q,ee,ce,ne,me,be,Se,ze,Pe,Ve,Ye,vt,it,St,nt,Qt)},t.prototype.emplace=function(i,l,f,m,x,k,I,A,C,B,U,Z,Q,ee,ce,ne,me,be,Se,ze,Pe,Ve,Ye,vt,it,St,nt,Qt,Rt){var dt=34*i,or=17*i;return this.int16[dt+0]=l,this.int16[dt+1]=f,this.int16[dt+2]=m,this.int16[dt+3]=x,this.int16[dt+4]=k,this.int16[dt+5]=I,this.int16[dt+6]=A,this.int16[dt+7]=C,this.uint16[dt+8]=B,this.uint16[dt+9]=U,this.uint16[dt+10]=Z,this.uint16[dt+11]=Q,this.uint16[dt+12]=ee,this.uint16[dt+13]=ce,this.uint16[dt+14]=ne,this.uint16[dt+15]=me,this.uint16[dt+16]=be,this.uint16[dt+17]=Se,this.uint16[dt+18]=ze,this.uint16[dt+19]=Pe,this.uint16[dt+20]=Ve,this.uint16[dt+21]=Ye,this.uint16[dt+22]=vt,this.uint32[or+12]=it,this.float32[or+13]=St,this.float32[or+14]=nt,this.float32[or+15]=Qt,this.float32[or+16]=Rt,i},t}(Pr);il.prototype.bytesPerElement=68,ut("StructArrayLayout8i15ui1ul4f68",il);var Qa=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},t.prototype.emplaceBack=function(i){var l=this.length;return this.resize(l+1),this.emplace(l,i)},t.prototype.emplace=function(i,l){return this.float32[1*i+0]=l,i},t}(Pr);Qa.prototype.bytesPerElement=4,ut("StructArrayLayout1f4",Qa);var oa=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},t.prototype.emplaceBack=function(i,l,f){var m=this.length;return this.resize(m+1),this.emplace(m,i,l,f)},t.prototype.emplace=function(i,l,f,m){var x=3*i;return this.int16[x+0]=l,this.int16[x+1]=f,this.int16[x+2]=m,i},t}(Pr);oa.prototype.bytesPerElement=6,ut("StructArrayLayout3i6",oa);var lu=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},t.prototype.emplaceBack=function(i,l,f){var m=this.length;return this.resize(m+1),this.emplace(m,i,l,f)},t.prototype.emplace=function(i,l,f,m){var x=4*i;return this.uint32[2*i+0]=l,this.uint16[x+2]=f,this.uint16[x+3]=m,i},t}(Pr);lu.prototype.bytesPerElement=8,ut("StructArrayLayout1ul2ui8",lu);var ks=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},t.prototype.emplaceBack=function(i,l){var f=this.length;return this.resize(f+1),this.emplace(f,i,l)},t.prototype.emplace=function(i,l,f){var m=2*i;return this.uint16[m+0]=l,this.uint16[m+1]=f,i},t}(Pr);ks.prototype.bytesPerElement=4,ut("StructArrayLayout2ui4",ks);var uu=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},t.prototype.emplaceBack=function(i){var l=this.length;return this.resize(l+1),this.emplace(l,i)},t.prototype.emplace=function(i,l){return this.uint16[1*i+0]=l,i},t}(Pr);uu.prototype.bytesPerElement=2,ut("StructArrayLayout1ui2",uu);var nl=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},t.prototype.emplaceBack=function(i,l,f,m){var x=this.length;return this.resize(x+1),this.emplace(x,i,l,f,m)},t.prototype.emplace=function(i,l,f,m,x){var k=4*i;return this.float32[k+0]=l,this.float32[k+1]=f,this.float32[k+2]=m,this.float32[k+3]=x,i},t}(Pr);nl.prototype.bytesPerElement=16,ut("StructArrayLayout4f16",nl);var n=function(e){function t(){e.apply(this,arguments)}e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t;var i={anchorPointX:{configurable:!0},anchorPointY:{configurable:!0},x1:{configurable:!0},y1:{configurable:!0},x2:{configurable:!0},y2:{configurable:!0},featureIndex:{configurable:!0},sourceLayerIndex:{configurable:!0},bucketIndex:{configurable:!0},anchorPoint:{configurable:!0}};return i.anchorPointX.get=function(){return this._structArray.int16[this._pos2+0]},i.anchorPointY.get=function(){return this._structArray.int16[this._pos2+1]},i.x1.get=function(){return this._structArray.int16[this._pos2+2]},i.y1.get=function(){return this._structArray.int16[this._pos2+3]},i.x2.get=function(){return this._structArray.int16[this._pos2+4]},i.y2.get=function(){return this._structArray.int16[this._pos2+5]},i.featureIndex.get=function(){return this._structArray.uint32[this._pos4+3]},i.sourceLayerIndex.get=function(){return this._structArray.uint16[this._pos2+8]},i.bucketIndex.get=function(){return this._structArray.uint16[this._pos2+9]},i.anchorPoint.get=function(){return new F(this.anchorPointX,this.anchorPointY)},Object.defineProperties(t.prototype,i),t}(tl);n.prototype.size=20;var s=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.get=function(i){return new n(this,i)},t}(ou);ut("CollisionBoxArray",s);var o=function(e){function t(){e.apply(this,arguments)}e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t;var i={anchorX:{configurable:!0},anchorY:{configurable:!0},glyphStartIndex:{configurable:!0},numGlyphs:{configurable:!0},vertexStartIndex:{configurable:!0},lineStartIndex:{configurable:!0},lineLength:{configurable:!0},segment:{configurable:!0},lowerSize:{configurable:!0},upperSize:{configurable:!0},lineOffsetX:{configurable:!0},lineOffsetY:{configurable:!0},writingMode:{configurable:!0},placedOrientation:{configurable:!0},hidden:{configurable:!0},crossTileID:{configurable:!0},associatedIconIndex:{configurable:!0}};return i.anchorX.get=function(){return this._structArray.int16[this._pos2+0]},i.anchorY.get=function(){return this._structArray.int16[this._pos2+1]},i.glyphStartIndex.get=function(){return this._structArray.uint16[this._pos2+2]},i.numGlyphs.get=function(){return this._structArray.uint16[this._pos2+3]},i.vertexStartIndex.get=function(){return this._structArray.uint32[this._pos4+2]},i.lineStartIndex.get=function(){return this._structArray.uint32[this._pos4+3]},i.lineLength.get=function(){return this._structArray.uint32[this._pos4+4]},i.segment.get=function(){return this._structArray.uint16[this._pos2+10]},i.lowerSize.get=function(){return this._structArray.uint16[this._pos2+11]},i.upperSize.get=function(){return this._structArray.uint16[this._pos2+12]},i.lineOffsetX.get=function(){return this._structArray.float32[this._pos4+7]},i.lineOffsetY.get=function(){return this._structArray.float32[this._pos4+8]},i.writingMode.get=function(){return this._structArray.uint8[this._pos1+36]},i.placedOrientation.get=function(){return this._structArray.uint8[this._pos1+37]},i.placedOrientation.set=function(l){this._structArray.uint8[this._pos1+37]=l},i.hidden.get=function(){return this._structArray.uint8[this._pos1+38]},i.hidden.set=function(l){this._structArray.uint8[this._pos1+38]=l},i.crossTileID.get=function(){return this._structArray.uint32[this._pos4+10]},i.crossTileID.set=function(l){this._structArray.uint32[this._pos4+10]=l},i.associatedIconIndex.get=function(){return this._structArray.int16[this._pos2+22]},Object.defineProperties(t.prototype,i),t}(tl);o.prototype.size=48;var c=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.get=function(i){return new o(this,i)},t}(Ya);ut("PlacedSymbolArray",c);var _=function(e){function t(){e.apply(this,arguments)}e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t;var i={anchorX:{configurable:!0},anchorY:{configurable:!0},rightJustifiedTextSymbolIndex:{configurable:!0},centerJustifiedTextSymbolIndex:{configurable:!0},leftJustifiedTextSymbolIndex:{configurable:!0},verticalPlacedTextSymbolIndex:{configurable:!0},placedIconSymbolIndex:{configurable:!0},verticalPlacedIconSymbolIndex:{configurable:!0},key:{configurable:!0},textBoxStartIndex:{configurable:!0},textBoxEndIndex:{configurable:!0},verticalTextBoxStartIndex:{configurable:!0},verticalTextBoxEndIndex:{configurable:!0},iconBoxStartIndex:{configurable:!0},iconBoxEndIndex:{configurable:!0},verticalIconBoxStartIndex:{configurable:!0},verticalIconBoxEndIndex:{configurable:!0},featureIndex:{configurable:!0},numHorizontalGlyphVertices:{configurable:!0},numVerticalGlyphVertices:{configurable:!0},numIconVertices:{configurable:!0},numVerticalIconVertices:{configurable:!0},useRuntimeCollisionCircles:{configurable:!0},crossTileID:{configurable:!0},textBoxScale:{configurable:!0},textOffset0:{configurable:!0},textOffset1:{configurable:!0},collisionCircleDiameter:{configurable:!0}};return i.anchorX.get=function(){return this._structArray.int16[this._pos2+0]},i.anchorY.get=function(){return this._structArray.int16[this._pos2+1]},i.rightJustifiedTextSymbolIndex.get=function(){return this._structArray.int16[this._pos2+2]},i.centerJustifiedTextSymbolIndex.get=function(){return this._structArray.int16[this._pos2+3]},i.leftJustifiedTextSymbolIndex.get=function(){return this._structArray.int16[this._pos2+4]},i.verticalPlacedTextSymbolIndex.get=function(){return this._structArray.int16[this._pos2+5]},i.placedIconSymbolIndex.get=function(){return this._structArray.int16[this._pos2+6]},i.verticalPlacedIconSymbolIndex.get=function(){return this._structArray.int16[this._pos2+7]},i.key.get=function(){return this._structArray.uint16[this._pos2+8]},i.textBoxStartIndex.get=function(){return this._structArray.uint16[this._pos2+9]},i.textBoxEndIndex.get=function(){return this._structArray.uint16[this._pos2+10]},i.verticalTextBoxStartIndex.get=function(){return this._structArray.uint16[this._pos2+11]},i.verticalTextBoxEndIndex.get=function(){return this._structArray.uint16[this._pos2+12]},i.iconBoxStartIndex.get=function(){return this._structArray.uint16[this._pos2+13]},i.iconBoxEndIndex.get=function(){return this._structArray.uint16[this._pos2+14]},i.verticalIconBoxStartIndex.get=function(){return this._structArray.uint16[this._pos2+15]},i.verticalIconBoxEndIndex.get=function(){return this._structArray.uint16[this._pos2+16]},i.featureIndex.get=function(){return this._structArray.uint16[this._pos2+17]},i.numHorizontalGlyphVertices.get=function(){return this._structArray.uint16[this._pos2+18]},i.numVerticalGlyphVertices.get=function(){return this._structArray.uint16[this._pos2+19]},i.numIconVertices.get=function(){return this._structArray.uint16[this._pos2+20]},i.numVerticalIconVertices.get=function(){return this._structArray.uint16[this._pos2+21]},i.useRuntimeCollisionCircles.get=function(){return this._structArray.uint16[this._pos2+22]},i.crossTileID.get=function(){return this._structArray.uint32[this._pos4+12]},i.crossTileID.set=function(l){this._structArray.uint32[this._pos4+12]=l},i.textBoxScale.get=function(){return this._structArray.float32[this._pos4+13]},i.textOffset0.get=function(){return this._structArray.float32[this._pos4+14]},i.textOffset1.get=function(){return this._structArray.float32[this._pos4+15]},i.collisionCircleDiameter.get=function(){return this._structArray.float32[this._pos4+16]},Object.defineProperties(t.prototype,i),t}(tl);_.prototype.size=68;var w=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.get=function(i){return new _(this,i)},t}(il);ut("SymbolInstanceArray",w);var S=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.getoffsetX=function(i){return this.float32[1*i+0]},t}(Qa);ut("GlyphOffsetArray",S);var z=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.getx=function(i){return this.int16[3*i+0]},t.prototype.gety=function(i){return this.int16[3*i+1]},t.prototype.gettileUnitDistanceFromAnchor=function(i){return this.int16[3*i+2]},t}(oa);ut("SymbolLineVertexArray",z);var P=function(e){function t(){e.apply(this,arguments)}e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t;var i={featureIndex:{configurable:!0},sourceLayerIndex:{configurable:!0},bucketIndex:{configurable:!0}};return i.featureIndex.get=function(){return this._structArray.uint32[this._pos4+0]},i.sourceLayerIndex.get=function(){return this._structArray.uint16[this._pos2+2]},i.bucketIndex.get=function(){return this._structArray.uint16[this._pos2+3]},Object.defineProperties(t.prototype,i),t}(tl);P.prototype.size=8;var O=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.get=function(i){return new P(this,i)},t}(lu);ut("FeatureIndexArray",O);var G=Ki([{name:"a_pos",components:2,type:"Int16"}],4).members,K=function(e){e===void 0&&(e=[]),this.segments=e};function X(e,t){return 256*(e=fe(Math.floor(e),0,255))+fe(Math.floor(t),0,255)}K.prototype.prepareSegment=function(e,t,i,l){var f=this.segments[this.segments.length-1];return e>K.MAX_VERTEX_ARRAY_LENGTH&&bt("Max vertices per segment is "+K.MAX_VERTEX_ARRAY_LENGTH+": bucket requested "+e),(!f||f.vertexLength+e>K.MAX_VERTEX_ARRAY_LENGTH||f.sortKey!==l)&&(f={vertexOffset:t.length,primitiveOffset:i.length,vertexLength:0,primitiveLength:0},l!==void 0&&(f.sortKey=l),this.segments.push(f)),f},K.prototype.get=function(){return this.segments},K.prototype.destroy=function(){for(var e=0,t=this.segments;e<t.length;e+=1){var i=t[e];for(var l in i.vaos)i.vaos[l].destroy()}},K.simpleSegment=function(e,t,i,l){return new K([{vertexOffset:e,primitiveOffset:t,vertexLength:i,primitiveLength:l,vaos:{},sortKey:0}])},K.MAX_VERTEX_ARRAY_LENGTH=Math.pow(2,16)-1,ut("SegmentVector",K);var re=Ki([{name:"a_pattern_from",components:4,type:"Uint16"},{name:"a_pattern_to",components:4,type:"Uint16"},{name:"a_pixel_ratio_from",components:1,type:"Uint16"},{name:"a_pixel_ratio_to",components:1,type:"Uint16"}]),te=T(function(e){e.exports=function(t,i){var l,f,m,x,k,I,A,C;for(f=t.length-(l=3&t.length),m=i,k=3432918353,I=461845907,C=0;C<f;)A=255&t.charCodeAt(C)|(255&t.charCodeAt(++C))<<8|(255&t.charCodeAt(++C))<<16|(255&t.charCodeAt(++C))<<24,++C,m=27492+(65535&(x=5*(65535&(m=(m^=A=(65535&(A=(A=(65535&A)*k+(((A>>>16)*k&65535)<<16)&4294967295)<<15|A>>>17))*I+(((A>>>16)*I&65535)<<16)&4294967295)<<13|m>>>19))+((5*(m>>>16)&65535)<<16)&4294967295))+((58964+(x>>>16)&65535)<<16);switch(A=0,l){case 3:A^=(255&t.charCodeAt(C+2))<<16;case 2:A^=(255&t.charCodeAt(C+1))<<8;case 1:m^=A=(65535&(A=(A=(65535&(A^=255&t.charCodeAt(C)))*k+(((A>>>16)*k&65535)<<16)&4294967295)<<15|A>>>17))*I+(((A>>>16)*I&65535)<<16)&4294967295}return m^=t.length,m=2246822507*(65535&(m^=m>>>16))+((2246822507*(m>>>16)&65535)<<16)&4294967295,m=3266489909*(65535&(m^=m>>>13))+((3266489909*(m>>>16)&65535)<<16)&4294967295,(m^=m>>>16)>>>0}}),ue=T(function(e){e.exports=function(t,i){for(var l,f=t.length,m=i^f,x=0;f>=4;)l=1540483477*(65535&(l=255&t.charCodeAt(x)|(255&t.charCodeAt(++x))<<8|(255&t.charCodeAt(++x))<<16|(255&t.charCodeAt(++x))<<24))+((1540483477*(l>>>16)&65535)<<16),m=1540483477*(65535&m)+((1540483477*(m>>>16)&65535)<<16)^(l=1540483477*(65535&(l^=l>>>24))+((1540483477*(l>>>16)&65535)<<16)),f-=4,++x;switch(f){case 3:m^=(255&t.charCodeAt(x+2))<<16;case 2:m^=(255&t.charCodeAt(x+1))<<8;case 1:m=1540483477*(65535&(m^=255&t.charCodeAt(x)))+((1540483477*(m>>>16)&65535)<<16)}return m=1540483477*(65535&(m^=m>>>13))+((1540483477*(m>>>16)&65535)<<16),(m^=m>>>15)>>>0}}),Y=te,le=ue;Y.murmur3=te,Y.murmur2=le;var pe=function(){this.ids=[],this.positions=[],this.indexed=!1};pe.prototype.add=function(e,t,i,l){this.ids.push(Ie(e)),this.positions.push(t,i,l)},pe.prototype.getPositions=function(e){for(var t=Ie(e),i=0,l=this.ids.length-1;i<l;){var f=i+l>>1;this.ids[f]>=t?l=f:i=f+1}for(var m=[];this.ids[i]===t;)m.push({index:this.positions[3*i],start:this.positions[3*i+1],end:this.positions[3*i+2]}),i++;return m},pe.serialize=function(e,t){var i=new Float64Array(e.ids),l=new Uint32Array(e.positions);return function f(m,x,k,I){for(;k<I;){for(var A=m[k+I>>1],C=k-1,B=I+1;;){do C++;while(m[C]<A);do B--;while(m[B]>A);if(C>=B)break;Ee(m,C,B),Ee(x,3*C,3*B),Ee(x,3*C+1,3*B+1),Ee(x,3*C+2,3*B+2)}B-k<I-B?(f(m,x,k,B),k=B+1):(f(m,x,B+1,I),I=B)}}(i,l,0,i.length-1),t&&t.push(i.buffer,l.buffer),{ids:i,positions:l}},pe.deserialize=function(e){var t=new pe;return t.ids=e.ids,t.positions=e.positions,t.indexed=!0,t};var ve=Math.pow(2,53)-1;function Ie(e){var t=+e;return!isNaN(t)&&t<=ve?t:Y(String(e))}function Ee(e,t,i){var l=e[t];e[t]=e[i],e[i]=l}ut("FeaturePositionMap",pe);var Ae=function(e,t){this.gl=e.gl,this.location=t},Re=function(e){function t(i,l){e.call(this,i,l),this.current=0}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.set=function(i){this.current!==i&&(this.current=i,this.gl.uniform1i(this.location,i))},t}(Ae),Ke=function(e){function t(i,l){e.call(this,i,l),this.current=0}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.set=function(i){this.current!==i&&(this.current=i,this.gl.uniform1f(this.location,i))},t}(Ae),Ze=function(e){function t(i,l){e.call(this,i,l),this.current=[0,0]}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.set=function(i){i[0]===this.current[0]&&i[1]===this.current[1]||(this.current=i,this.gl.uniform2f(this.location,i[0],i[1]))},t}(Ae),ot=function(e){function t(i,l){e.call(this,i,l),this.current=[0,0,0]}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.set=function(i){i[0]===this.current[0]&&i[1]===this.current[1]&&i[2]===this.current[2]||(this.current=i,this.gl.uniform3f(this.location,i[0],i[1],i[2]))},t}(Ae),wt=function(e){function t(i,l){e.call(this,i,l),this.current=[0,0,0,0]}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.set=function(i){i[0]===this.current[0]&&i[1]===this.current[1]&&i[2]===this.current[2]&&i[3]===this.current[3]||(this.current=i,this.gl.uniform4f(this.location,i[0],i[1],i[2],i[3]))},t}(Ae),Tt=function(e){function t(i,l){e.call(this,i,l),this.current=ar.transparent}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.set=function(i){i.r===this.current.r&&i.g===this.current.g&&i.b===this.current.b&&i.a===this.current.a||(this.current=i,this.gl.uniform4f(this.location,i.r,i.g,i.b,i.a))},t}(Ae),Et=new Float32Array(16),_r=function(e){function t(i,l){e.call(this,i,l),this.current=Et}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.set=function(i){if(i[12]!==this.current[12]||i[0]!==this.current[0])return this.current=i,void this.gl.uniformMatrix4fv(this.location,!1,i);for(var l=1;l<16;l++)if(i[l]!==this.current[l]){this.current=i,this.gl.uniformMatrix4fv(this.location,!1,i);break}},t}(Ae);function lt(e){return[X(255*e.r,255*e.g),X(255*e.b,255*e.a)]}var Ut=function(e,t,i){this.value=e,this.uniformNames=t.map(function(l){return"u_"+l}),this.type=i};Ut.prototype.setUniform=function(e,t,i){e.set(i.constantOr(this.value))},Ut.prototype.getBinding=function(e,t,i){return this.type==="color"?new Tt(e,t):new Ke(e,t)};var Yt=function(e,t){this.uniformNames=t.map(function(i){return"u_"+i}),this.patternFrom=null,this.patternTo=null,this.pixelRatioFrom=1,this.pixelRatioTo=1};Yt.prototype.setConstantPatternPositions=function(e,t){this.pixelRatioFrom=t.pixelRatio,this.pixelRatioTo=e.pixelRatio,this.patternFrom=t.tlbr,this.patternTo=e.tlbr},Yt.prototype.setUniform=function(e,t,i,l){var f=l==="u_pattern_to"?this.patternTo:l==="u_pattern_from"?this.patternFrom:l==="u_pixel_ratio_to"?this.pixelRatioTo:l==="u_pixel_ratio_from"?this.pixelRatioFrom:null;f&&e.set(f)},Yt.prototype.getBinding=function(e,t,i){return i.substr(0,9)==="u_pattern"?new wt(e,t):new Ke(e,t)};var Ft=function(e,t,i,l){this.expression=e,this.type=i,this.maxValue=0,this.paintVertexAttributes=t.map(function(f){return{name:"a_"+f,type:"Float32",components:i==="color"?2:1,offset:0}}),this.paintVertexArray=new l};Ft.prototype.populatePaintArray=function(e,t,i,l,f){var m=this.paintVertexArray.length,x=this.expression.evaluate(new ur(0),t,{},l,[],f);this.paintVertexArray.resize(e),this._setPaintValue(m,e,x)},Ft.prototype.updatePaintArray=function(e,t,i,l){var f=this.expression.evaluate({zoom:0},i,l);this._setPaintValue(e,t,f)},Ft.prototype._setPaintValue=function(e,t,i){if(this.type==="color")for(var l=lt(i),f=e;f<t;f++)this.paintVertexArray.emplace(f,l[0],l[1]);else{for(var m=e;m<t;m++)this.paintVertexArray.emplace(m,i);this.maxValue=Math.max(this.maxValue,Math.abs(i))}},Ft.prototype.upload=function(e){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=e.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))},Ft.prototype.destroy=function(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()};var Ot=function(e,t,i,l,f,m){this.expression=e,this.uniformNames=t.map(function(x){return"u_"+x+"_t"}),this.type=i,this.useIntegerZoom=l,this.zoom=f,this.maxValue=0,this.paintVertexAttributes=t.map(function(x){return{name:"a_"+x,type:"Float32",components:i==="color"?4:2,offset:0}}),this.paintVertexArray=new m};Ot.prototype.populatePaintArray=function(e,t,i,l,f){var m=this.expression.evaluate(new ur(this.zoom),t,{},l,[],f),x=this.expression.evaluate(new ur(this.zoom+1),t,{},l,[],f),k=this.paintVertexArray.length;this.paintVertexArray.resize(e),this._setPaintValue(k,e,m,x)},Ot.prototype.updatePaintArray=function(e,t,i,l){var f=this.expression.evaluate({zoom:this.zoom},i,l),m=this.expression.evaluate({zoom:this.zoom+1},i,l);this._setPaintValue(e,t,f,m)},Ot.prototype._setPaintValue=function(e,t,i,l){if(this.type==="color")for(var f=lt(i),m=lt(l),x=e;x<t;x++)this.paintVertexArray.emplace(x,f[0],f[1],m[0],m[1]);else{for(var k=e;k<t;k++)this.paintVertexArray.emplace(k,i,l);this.maxValue=Math.max(this.maxValue,Math.abs(i),Math.abs(l))}},Ot.prototype.upload=function(e){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=e.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))},Ot.prototype.destroy=function(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()},Ot.prototype.setUniform=function(e,t){var i=this.useIntegerZoom?Math.floor(t.zoom):t.zoom,l=fe(this.expression.interpolationFactor(i,this.zoom,this.zoom+1),0,1);e.set(l)},Ot.prototype.getBinding=function(e,t,i){return new Ke(e,t)};var Ht=function(e,t,i,l,f,m){this.expression=e,this.type=t,this.useIntegerZoom=i,this.zoom=l,this.layerId=m,this.zoomInPaintVertexArray=new f,this.zoomOutPaintVertexArray=new f};Ht.prototype.populatePaintArray=function(e,t,i){var l=this.zoomInPaintVertexArray.length;this.zoomInPaintVertexArray.resize(e),this.zoomOutPaintVertexArray.resize(e),this._setPaintValues(l,e,t.patterns&&t.patterns[this.layerId],i)},Ht.prototype.updatePaintArray=function(e,t,i,l,f){this._setPaintValues(e,t,i.patterns&&i.patterns[this.layerId],f)},Ht.prototype._setPaintValues=function(e,t,i,l){if(l&&i){var f=l[i.min],m=l[i.mid],x=l[i.max];if(f&&m&&x)for(var k=e;k<t;k++)this.zoomInPaintVertexArray.emplace(k,m.tl[0],m.tl[1],m.br[0],m.br[1],f.tl[0],f.tl[1],f.br[0],f.br[1],m.pixelRatio,f.pixelRatio),this.zoomOutPaintVertexArray.emplace(k,m.tl[0],m.tl[1],m.br[0],m.br[1],x.tl[0],x.tl[1],x.br[0],x.br[1],m.pixelRatio,x.pixelRatio)}},Ht.prototype.upload=function(e){this.zoomInPaintVertexArray&&this.zoomInPaintVertexArray.arrayBuffer&&this.zoomOutPaintVertexArray&&this.zoomOutPaintVertexArray.arrayBuffer&&(this.zoomInPaintVertexBuffer=e.createVertexBuffer(this.zoomInPaintVertexArray,re.members,this.expression.isStateDependent),this.zoomOutPaintVertexBuffer=e.createVertexBuffer(this.zoomOutPaintVertexArray,re.members,this.expression.isStateDependent))},Ht.prototype.destroy=function(){this.zoomOutPaintVertexBuffer&&this.zoomOutPaintVertexBuffer.destroy(),this.zoomInPaintVertexBuffer&&this.zoomInPaintVertexBuffer.destroy()};var Bt=function(e,t,i){this.binders={},this._buffers=[];var l=[];for(var f in e.paint._values)if(i(f)){var m=e.paint.get(f);if(m instanceof wn&&xo(m.property.specification)){var x=Li(f,e.type),k=m.value,I=m.property.specification.type,A=m.property.useIntegerZoom,C=m.property.specification["property-type"],B=C==="cross-faded"||C==="cross-faded-data-driven";if(k.kind==="constant")this.binders[f]=B?new Yt(k.value,x):new Ut(k.value,x,I),l.push("/u_"+f);else if(k.kind==="source"||B){var U=ui(f,I,"source");this.binders[f]=B?new Ht(k,I,A,t,U,e.id):new Ft(k,x,I,U),l.push("/a_"+f)}else{var Z=ui(f,I,"composite");this.binders[f]=new Ot(k,x,I,A,t,Z),l.push("/z_"+f)}}}this.cacheKey=l.sort().join("")};Bt.prototype.getMaxValue=function(e){var t=this.binders[e];return t instanceof Ft||t instanceof Ot?t.maxValue:0},Bt.prototype.populatePaintArrays=function(e,t,i,l,f){for(var m in this.binders){var x=this.binders[m];(x instanceof Ft||x instanceof Ot||x instanceof Ht)&&x.populatePaintArray(e,t,i,l,f)}},Bt.prototype.setConstantPatternPositions=function(e,t){for(var i in this.binders){var l=this.binders[i];l instanceof Yt&&l.setConstantPatternPositions(e,t)}},Bt.prototype.updatePaintArrays=function(e,t,i,l,f){var m=!1;for(var x in e)for(var k=0,I=t.getPositions(x);k<I.length;k+=1){var A=I[k],C=i.feature(A.index);for(var B in this.binders){var U=this.binders[B];if((U instanceof Ft||U instanceof Ot||U instanceof Ht)&&U.expression.isStateDependent===!0){var Z=l.paint.get(B);U.expression=Z.value,U.updatePaintArray(A.start,A.end,C,e[x],f),m=!0}}}return m},Bt.prototype.defines=function(){var e=[];for(var t in this.binders){var i=this.binders[t];(i instanceof Ut||i instanceof Yt)&&e.push.apply(e,i.uniformNames.map(function(l){return"#define HAS_UNIFORM_"+l}))}return e},Bt.prototype.getBinderAttributes=function(){var e=[];for(var t in this.binders){var i=this.binders[t];if(i instanceof Ft||i instanceof Ot)for(var l=0;l<i.paintVertexAttributes.length;l++)e.push(i.paintVertexAttributes[l].name);else if(i instanceof Ht)for(var f=0;f<re.members.length;f++)e.push(re.members[f].name)}return e},Bt.prototype.getBinderUniforms=function(){var e=[];for(var t in this.binders){var i=this.binders[t];if(i instanceof Ut||i instanceof Yt||i instanceof Ot)for(var l=0,f=i.uniformNames;l<f.length;l+=1)e.push(f[l])}return e},Bt.prototype.getPaintVertexBuffers=function(){return this._buffers},Bt.prototype.getUniforms=function(e,t){var i=[];for(var l in this.binders){var f=this.binders[l];if(f instanceof Ut||f instanceof Yt||f instanceof Ot)for(var m=0,x=f.uniformNames;m<x.length;m+=1){var k=x[m];if(t[k]){var I=f.getBinding(e,t[k],k);i.push({name:k,property:l,binding:I})}}}return i},Bt.prototype.setUniforms=function(e,t,i,l){for(var f=0,m=t;f<m.length;f+=1){var x=m[f],k=x.name,I=x.property;this.binders[I].setUniform(x.binding,l,i.get(I),k)}},Bt.prototype.updatePaintBuffers=function(e){for(var t in this._buffers=[],this.binders){var i=this.binders[t];if(e&&i instanceof Ht){var l=e.fromScale===2?i.zoomInPaintVertexBuffer:i.zoomOutPaintVertexBuffer;l&&this._buffers.push(l)}else(i instanceof Ft||i instanceof Ot)&&i.paintVertexBuffer&&this._buffers.push(i.paintVertexBuffer)}},Bt.prototype.upload=function(e){for(var t in this.binders){var i=this.binders[t];(i instanceof Ft||i instanceof Ot||i instanceof Ht)&&i.upload(e)}this.updatePaintBuffers()},Bt.prototype.destroy=function(){for(var e in this.binders){var t=this.binders[e];(t instanceof Ft||t instanceof Ot||t instanceof Ht)&&t.destroy()}};var Lt=function(e,t,i){i===void 0&&(i=function(){return!0}),this.programConfigurations={};for(var l=0,f=e;l<f.length;l+=1){var m=f[l];this.programConfigurations[m.id]=new Bt(m,t,i)}this.needsUpload=!1,this._featureMap=new pe,this._bufferOffset=0};function Li(e,t){return{"text-opacity":["opacity"],"icon-opacity":["opacity"],"text-color":["fill_color"],"icon-color":["fill_color"],"text-halo-color":["halo_color"],"icon-halo-color":["halo_color"],"text-halo-blur":["halo_blur"],"icon-halo-blur":["halo_blur"],"text-halo-width":["halo_width"],"icon-halo-width":["halo_width"],"line-gap-width":["gapwidth"],"line-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-extrusion-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"]}[e]||[e.replace(t+"-","").replace(/-/g,"_")]}function ui(e,t,i){var l={color:{source:Go,composite:nl},number:{source:Qa,composite:Go}},f=function(m){return{"line-pattern":{source:za,composite:za},"fill-pattern":{source:za,composite:za},"fill-extrusion-pattern":{source:za,composite:za}}[m]}(e);return f&&f[i]||l[t][i]}Lt.prototype.populatePaintArrays=function(e,t,i,l,f,m){for(var x in this.programConfigurations)this.programConfigurations[x].populatePaintArrays(e,t,l,f,m);t.id!==void 0&&this._featureMap.add(t.id,i,this._bufferOffset,e),this._bufferOffset=e,this.needsUpload=!0},Lt.prototype.updatePaintArrays=function(e,t,i,l){for(var f=0,m=i;f<m.length;f+=1){var x=m[f];this.needsUpload=this.programConfigurations[x.id].updatePaintArrays(e,this._featureMap,t,x,l)||this.needsUpload}},Lt.prototype.get=function(e){return this.programConfigurations[e]},Lt.prototype.upload=function(e){if(this.needsUpload){for(var t in this.programConfigurations)this.programConfigurations[t].upload(e);this.needsUpload=!1}},Lt.prototype.destroy=function(){for(var e in this.programConfigurations)this.programConfigurations[e].destroy()},ut("ConstantBinder",Ut),ut("CrossFadedConstantBinder",Yt),ut("SourceExpressionBinder",Ft),ut("CrossFadedCompositeBinder",Ht),ut("CompositeExpressionBinder",Ot),ut("ProgramConfiguration",Bt,{omit:["_buffers"]}),ut("ProgramConfigurationSet",Lt);var pn=Math.pow(2,14)-1,Xi=-pn-1;function ni(e){for(var t=8192/e.extent,i=e.loadGeometry(),l=0;l<i.length;l++)for(var f=i[l],m=0;m<f.length;m++){var x=f[m],k=Math.round(x.x*t),I=Math.round(x.y*t);x.x=fe(k,Xi,pn),x.y=fe(I,Xi,pn),(k<x.x||k>x.x+1||I<x.y||I>x.y+1)&&bt("Geometry exceeds allowed extent, reduce your vector tile buffer size")}return i}function mi(e,t){return{type:e.type,id:e.id,properties:e.properties,geometry:t?ni(e):[]}}function Wn(e,t,i,l,f){e.emplaceBack(2*t+(l+1)/2,2*i+(f+1)/2)}var kn=function(e){this.zoom=e.zoom,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map(function(t){return t.id}),this.index=e.index,this.hasPattern=!1,this.layoutVertexArray=new To,this.indexArray=new Ja,this.segments=new K,this.programConfigurations=new Lt(e.layers,e.zoom),this.stateDependentLayerIds=this.layers.filter(function(t){return t.isStateDependent()}).map(function(t){return t.id})};function $a(e,t){for(var i=0;i<e.length;i++)if(Ia(t,e[i]))return!0;for(var l=0;l<t.length;l++)if(Ia(e,t[l]))return!0;return!!Es(e,t)}function Dn(e,t,i){return!!Ia(e,t)||!!eo(t,e,i)}function _a(e,t){if(e.length===1)return Ts(t,e[0]);for(var i=0;i<t.length;i++)for(var l=t[i],f=0;f<l.length;f++)if(Ia(e,l[f]))return!0;for(var m=0;m<e.length;m++)if(Ts(t,e[m]))return!0;for(var x=0;x<t.length;x++)if(Es(e,t[x]))return!0;return!1}function sa(e,t,i){if(e.length>1){if(Es(e,t))return!0;for(var l=0;l<t.length;l++)if(eo(t[l],e,i))return!0}for(var f=0;f<e.length;f++)if(eo(e[f],t,i))return!0;return!1}function Es(e,t){if(e.length===0||t.length===0)return!1;for(var i=0;i<e.length-1;i++)for(var l=e[i],f=e[i+1],m=0;m<t.length-1;m++)if(Wo(l,f,t[m],t[m+1]))return!0;return!1}function Wo(e,t,i,l){return zt(e,i,l)!==zt(t,i,l)&&zt(e,t,i)!==zt(e,t,l)}function eo(e,t,i){var l=i*i;if(t.length===1)return e.distSqr(t[0])<l;for(var f=1;f<t.length;f++)if(Ho(e,t[f-1],t[f])<l)return!0;return!1}function Ho(e,t,i){var l=t.distSqr(i);if(l===0)return e.distSqr(t);var f=((e.x-t.x)*(i.x-t.x)+(e.y-t.y)*(i.y-t.y))/l;return e.distSqr(f<0?t:f>1?i:i.sub(t)._mult(f)._add(t))}function Ts(e,t){for(var i,l,f,m=!1,x=0;x<e.length;x++)for(var k=0,I=(i=e[x]).length-1;k<i.length;I=k++)(l=i[k]).y>t.y!=(f=i[I]).y>t.y&&t.x<(f.x-l.x)*(t.y-l.y)/(f.y-l.y)+l.x&&(m=!m);return m}function Ia(e,t){for(var i=!1,l=0,f=e.length-1;l<e.length;f=l++){var m=e[l],x=e[f];m.y>t.y!=x.y>t.y&&t.x<(x.x-m.x)*(t.y-m.y)/(x.y-m.y)+m.x&&(i=!i)}return i}function zs(e,t,i){var l=i[0],f=i[2];if(e.x<l.x&&t.x<l.x||e.x>f.x&&t.x>f.x||e.y<l.y&&t.y<l.y||e.y>f.y&&t.y>f.y)return!1;var m=zt(e,t,i[0]);return m!==zt(e,t,i[1])||m!==zt(e,t,i[2])||m!==zt(e,t,i[3])}function Aa(e,t,i){var l=t.paint.get(e).value;return l.kind==="constant"?l.value:i.programConfigurations.get(t.id).getMaxValue(e)}function Ri(e){return Math.sqrt(e[0]*e[0]+e[1]*e[1])}function La(e,t,i,l,f){if(!t[0]&&!t[1])return e;var m=F.convert(t)._mult(f);i==="viewport"&&m._rotate(-l);for(var x=[],k=0;k<e.length;k++)x.push(e[k].sub(m));return x}kn.prototype.populate=function(e,t,i){var l=this.layers[0],f=[],m=null;l.type==="circle"&&(m=l.layout.get("circle-sort-key"));for(var x=0,k=e;x<k.length;x+=1){var I=k[x],A=I.feature,C=I.id,B=I.index,U=I.sourceLayerIndex,Z=this.layers[0]._featureFilter.needGeometry,Q=mi(A,Z);if(this.layers[0]._featureFilter.filter(new ur(this.zoom),Q,i)){var ee=m?m.evaluate(Q,{},i):void 0,ce={id:C,properties:A.properties,type:A.type,sourceLayerIndex:U,index:B,geometry:Z?Q.geometry:ni(A),patterns:{},sortKey:ee};f.push(ce)}}m&&f.sort(function(Ye,vt){return Ye.sortKey-vt.sortKey});for(var ne=0,me=f;ne<me.length;ne+=1){var be=me[ne],Se=be.geometry,ze=be.index,Pe=be.sourceLayerIndex,Ve=e[ze].feature;this.addFeature(be,Se,ze,i),t.featureIndex.insert(Ve,Se,ze,Pe,this.index)}},kn.prototype.update=function(e,t,i){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(e,t,this.stateDependentLayers,i)},kn.prototype.isEmpty=function(){return this.layoutVertexArray.length===0},kn.prototype.uploadPending=function(){return!this.uploaded||this.programConfigurations.needsUpload},kn.prototype.upload=function(e){this.uploaded||(this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,G),this.indexBuffer=e.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(e),this.uploaded=!0},kn.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())},kn.prototype.addFeature=function(e,t,i,l){for(var f=0,m=t;f<m.length;f+=1)for(var x=0,k=m[f];x<k.length;x+=1){var I=k[x],A=I.x,C=I.y;if(!(A<0||A>=8192||C<0||C>=8192)){var B=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray,e.sortKey),U=B.vertexLength;Wn(this.layoutVertexArray,A,C,-1,-1),Wn(this.layoutVertexArray,A,C,1,-1),Wn(this.layoutVertexArray,A,C,1,1),Wn(this.layoutVertexArray,A,C,-1,1),this.indexArray.emplaceBack(U,U+1,U+2),this.indexArray.emplaceBack(U,U+3,U+2),B.vertexLength+=4,B.primitiveLength+=2}}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,e,i,{},l)},ut("CircleBucket",kn,{omit:["layers"]});var to=new an({"circle-sort-key":new ft(j.layout_circle["circle-sort-key"])}),Io={paint:new an({"circle-radius":new ft(j.paint_circle["circle-radius"]),"circle-color":new ft(j.paint_circle["circle-color"]),"circle-blur":new ft(j.paint_circle["circle-blur"]),"circle-opacity":new ft(j.paint_circle["circle-opacity"]),"circle-translate":new xt(j.paint_circle["circle-translate"]),"circle-translate-anchor":new xt(j.paint_circle["circle-translate-anchor"]),"circle-pitch-scale":new xt(j.paint_circle["circle-pitch-scale"]),"circle-pitch-alignment":new xt(j.paint_circle["circle-pitch-alignment"]),"circle-stroke-width":new ft(j.paint_circle["circle-stroke-width"]),"circle-stroke-color":new ft(j.paint_circle["circle-stroke-color"]),"circle-stroke-opacity":new ft(j.paint_circle["circle-stroke-opacity"])}),layout:to},Er=typeof Float32Array<"u"?Float32Array:Array;function ra(e){return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}function Ln(e,t,i){var l=t[0],f=t[1],m=t[2],x=t[3],k=t[4],I=t[5],A=t[6],C=t[7],B=t[8],U=t[9],Z=t[10],Q=t[11],ee=t[12],ce=t[13],ne=t[14],me=t[15],be=i[0],Se=i[1],ze=i[2],Pe=i[3];return e[0]=be*l+Se*k+ze*B+Pe*ee,e[1]=be*f+Se*I+ze*U+Pe*ce,e[2]=be*m+Se*A+ze*Z+Pe*ne,e[3]=be*x+Se*C+ze*Q+Pe*me,e[4]=(be=i[4])*l+(Se=i[5])*k+(ze=i[6])*B+(Pe=i[7])*ee,e[5]=be*f+Se*I+ze*U+Pe*ce,e[6]=be*m+Se*A+ze*Z+Pe*ne,e[7]=be*x+Se*C+ze*Q+Pe*me,e[8]=(be=i[8])*l+(Se=i[9])*k+(ze=i[10])*B+(Pe=i[11])*ee,e[9]=be*f+Se*I+ze*U+Pe*ce,e[10]=be*m+Se*A+ze*Z+Pe*ne,e[11]=be*x+Se*C+ze*Q+Pe*me,e[12]=(be=i[12])*l+(Se=i[13])*k+(ze=i[14])*B+(Pe=i[15])*ee,e[13]=be*f+Se*I+ze*U+Pe*ce,e[14]=be*m+Se*A+ze*Z+Pe*ne,e[15]=be*x+Se*C+ze*Q+Pe*me,e}Math.hypot||(Math.hypot=function(){for(var e=arguments,t=0,i=arguments.length;i--;)t+=e[i]*e[i];return Math.sqrt(t)});var Ao,Hh=Ln;function al(e,t,i){var l=t[0],f=t[1],m=t[2],x=t[3];return e[0]=i[0]*l+i[4]*f+i[8]*m+i[12]*x,e[1]=i[1]*l+i[5]*f+i[9]*m+i[13]*x,e[2]=i[2]*l+i[6]*f+i[10]*m+i[14]*x,e[3]=i[3]*l+i[7]*f+i[11]*m+i[15]*x,e}Ao=new Er(3),Er!=Float32Array&&(Ao[0]=0,Ao[1]=0,Ao[2]=0),function(){var e=new Er(4);Er!=Float32Array&&(e[0]=0,e[1]=0,e[2]=0,e[3]=0)}();var Jh=(function(){var e=new Er(2);Er!=Float32Array&&(e[0]=0,e[1]=0)}(),function(e){function t(i){e.call(this,i,Io)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.createBucket=function(i){return new kn(i)},t.prototype.queryRadius=function(i){var l=i;return Aa("circle-radius",this,l)+Aa("circle-stroke-width",this,l)+Ri(this.paint.get("circle-translate"))},t.prototype.queryIntersectsFeature=function(i,l,f,m,x,k,I,A){for(var C=La(i,this.paint.get("circle-translate"),this.paint.get("circle-translate-anchor"),k.angle,I),B=this.paint.get("circle-radius").evaluate(l,f)+this.paint.get("circle-stroke-width").evaluate(l,f),U=this.paint.get("circle-pitch-alignment")==="map",Z=U?C:function(Ve,Ye){return Ve.map(function(vt){return Is(vt,Ye)})}(C,A),Q=U?B*I:B,ee=0,ce=m;ee<ce.length;ee+=1)for(var ne=0,me=ce[ee];ne<me.length;ne+=1){var be=me[ne],Se=U?be:Is(be,A),ze=Q,Pe=al([],[be.x,be.y,0,1],A);if(this.paint.get("circle-pitch-scale")==="viewport"&&this.paint.get("circle-pitch-alignment")==="map"?ze*=Pe[3]/k.cameraToCenterDistance:this.paint.get("circle-pitch-scale")==="map"&&this.paint.get("circle-pitch-alignment")==="viewport"&&(ze*=k.cameraToCenterDistance/Pe[3]),Dn(Z,Se,ze))return!0}return!1},t}(Ta));function Is(e,t){var i=al([],[e.x,e.y,0,1],t);return new F(i[0]/i[3],i[1]/i[3])}var Pc=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t}(kn);function Jo(e,t,i,l){var f=t.width,m=t.height;if(l){if(l instanceof Uint8ClampedArray)l=new Uint8Array(l.buffer);else if(l.length!==f*m*i)throw new RangeError("mismatched image size")}else l=new Uint8Array(f*m*i);return e.width=f,e.height=m,e.data=l,e}function ol(e,t,i){var l=t.width,f=t.height;if(l!==e.width||f!==e.height){var m=Jo({},{width:l,height:f},i);Yh(e,m,{x:0,y:0},{x:0,y:0},{width:Math.min(e.width,l),height:Math.min(e.height,f)},i),e.width=l,e.height=f,e.data=m.data}}function Yh(e,t,i,l,f,m){if(f.width===0||f.height===0)return t;if(f.width>e.width||f.height>e.height||i.x>e.width-f.width||i.y>e.height-f.height)throw new RangeError("out of range source coordinates for image copy");if(f.width>t.width||f.height>t.height||l.x>t.width-f.width||l.y>t.height-f.height)throw new RangeError("out of range destination coordinates for image copy");for(var x=e.data,k=t.data,I=0;I<f.height;I++)for(var A=((i.y+I)*e.width+i.x)*m,C=((l.y+I)*t.width+l.x)*m,B=0;B<f.width*m;B++)k[C+B]=x[A+B];return t}ut("HeatmapBucket",Pc,{omit:["layers"]});var As=function(e,t){Jo(this,e,1,t)};As.prototype.resize=function(e){ol(this,e,1)},As.prototype.clone=function(){return new As({width:this.width,height:this.height},new Uint8Array(this.data))},As.copy=function(e,t,i,l,f){Yh(e,t,i,l,f,1)};var Hn=function(e,t){Jo(this,e,4,t)};Hn.prototype.resize=function(e){ol(this,e,4)},Hn.prototype.replace=function(e,t){t?this.data.set(e):this.data=e instanceof Uint8ClampedArray?new Uint8Array(e.buffer):e},Hn.prototype.clone=function(){return new Hn({width:this.width,height:this.height},new Uint8Array(this.data))},Hn.copy=function(e,t,i,l,f){Yh(e,t,i,l,f,4)},ut("AlphaImage",As),ut("RGBAImage",Hn);var Ey={paint:new an({"heatmap-radius":new ft(j.paint_heatmap["heatmap-radius"]),"heatmap-weight":new ft(j.paint_heatmap["heatmap-weight"]),"heatmap-intensity":new xt(j.paint_heatmap["heatmap-intensity"]),"heatmap-color":new ga(j.paint_heatmap["heatmap-color"]),"heatmap-opacity":new xt(j.paint_heatmap["heatmap-opacity"])})};function Yp(e){var t={},i=e.resolution||256,l=e.clips?e.clips.length:1,f=e.image||new Hn({width:i,height:l}),m=function(Q,ee,ce){t[e.evaluationKey]=ce;var ne=e.expression.evaluate(t);f.data[Q+ee+0]=Math.floor(255*ne.r/ne.a),f.data[Q+ee+1]=Math.floor(255*ne.g/ne.a),f.data[Q+ee+2]=Math.floor(255*ne.b/ne.a),f.data[Q+ee+3]=Math.floor(255*ne.a)};if(e.clips)for(var x=0,k=0;x<l;++x,k+=4*i)for(var I=0,A=0;I<i;I++,A+=4){var C=I/(i-1),B=e.clips[x];m(k,A,B.start*(1-C)+B.end*C)}else for(var U=0,Z=0;U<i;U++,Z+=4)m(0,Z,U/(i-1));return f}var Ty=function(e){function t(i){e.call(this,i,Ey),this._updateColorRamp()}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.createBucket=function(i){return new Pc(i)},t.prototype._handleSpecialPaintPropertyUpdate=function(i){i==="heatmap-color"&&this._updateColorRamp()},t.prototype._updateColorRamp=function(){this.colorRamp=Yp({expression:this._transitionablePaint._values["heatmap-color"].value.expression,evaluationKey:"heatmapDensity",image:this.colorRamp}),this.colorRampTexture=null},t.prototype.resize=function(){this.heatmapFbo&&(this.heatmapFbo.destroy(),this.heatmapFbo=null)},t.prototype.queryRadius=function(){return 0},t.prototype.queryIntersectsFeature=function(){return!1},t.prototype.hasOffscreenPass=function(){return this.paint.get("heatmap-opacity")!==0&&this.visibility!=="none"},t}(Ta),zy={paint:new an({"hillshade-illumination-direction":new xt(j.paint_hillshade["hillshade-illumination-direction"]),"hillshade-illumination-anchor":new xt(j.paint_hillshade["hillshade-illumination-anchor"]),"hillshade-exaggeration":new xt(j.paint_hillshade["hillshade-exaggeration"]),"hillshade-shadow-color":new xt(j.paint_hillshade["hillshade-shadow-color"]),"hillshade-highlight-color":new xt(j.paint_hillshade["hillshade-highlight-color"]),"hillshade-accent-color":new xt(j.paint_hillshade["hillshade-accent-color"])})},Iy=function(e){function t(i){e.call(this,i,zy)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.hasOffscreenPass=function(){return this.paint.get("hillshade-exaggeration")!==0&&this.visibility!=="none"},t}(Ta),Ay=Ki([{name:"a_pos",components:2,type:"Int16"}],4).members,Qh=Cc,Py=Cc;function Cc(e,t,i){i=i||2;var l,f,m,x,k,I,A,C=t&&t.length,B=C?t[0]*i:e.length,U=Qp(e,0,B,i,!0),Z=[];if(!U||U.next===U.prev)return Z;if(C&&(U=function(ee,ce,ne,me){var be,Se,ze,Pe=[];for(be=0,Se=ce.length;be<Se;be++)(ze=Qp(ee,ce[be]*me,be<Se-1?ce[be+1]*me:ee.length,me,!1))===ze.next&&(ze.steiner=!0),Pe.push(Fy(ze));for(Pe.sort(Ry),be=0;be<Pe.length;be++)By(Pe[be],ne),ne=Yo(ne,ne.next);return ne}(e,t,U,i)),e.length>80*i){l=m=e[0],f=x=e[1];for(var Q=i;Q<B;Q+=i)(k=e[Q])<l&&(l=k),(I=e[Q+1])<f&&(f=I),k>m&&(m=k),I>x&&(x=I);A=(A=Math.max(m-l,x-f))!==0?1/A:0}return cu(U,Z,i,l,f,A),Z}function Qp(e,t,i,l,f){var m,x;if(f===tp(e,t,i,l)>0)for(m=t;m<i;m+=l)x=tf(m,e[m],e[m+1],x);else for(m=i-l;m>=t;m-=l)x=tf(m,e[m],e[m+1],x);return x&&Mc(x,x.next)&&(pu(x),x=x.next),x}function Yo(e,t){if(!e)return e;t||(t=e);var i,l=e;do if(i=!1,l.steiner||!Mc(l,l.next)&&Ii(l.prev,l,l.next)!==0)l=l.next;else{if(pu(l),(l=t=l.prev)===l.next)break;i=!0}while(i||l!==t);return t}function cu(e,t,i,l,f,m,x){if(e){!x&&m&&function(C,B,U,Z){var Q=C;do Q.z===null&&(Q.z=$h(Q.x,Q.y,B,U,Z)),Q.prevZ=Q.prev,Q.nextZ=Q.next,Q=Q.next;while(Q!==C);Q.prevZ.nextZ=null,Q.prevZ=null,function(ee){var ce,ne,me,be,Se,ze,Pe,Ve,Ye=1;do{for(ne=ee,ee=null,Se=null,ze=0;ne;){for(ze++,me=ne,Pe=0,ce=0;ce<Ye&&(Pe++,me=me.nextZ);ce++);for(Ve=Ye;Pe>0||Ve>0&&me;)Pe!==0&&(Ve===0||!me||ne.z<=me.z)?(be=ne,ne=ne.nextZ,Pe--):(be=me,me=me.nextZ,Ve--),Se?Se.nextZ=be:ee=be,be.prevZ=Se,Se=be;ne=me}Se.nextZ=null,Ye*=2}while(ze>1)}(Q)}(e,l,f,m);for(var k,I,A=e;e.prev!==e.next;)if(k=e.prev,I=e.next,m?My(e,l,f,m):Cy(e))t.push(k.i/i),t.push(e.i/i),t.push(I.i/i),pu(e),e=I.next,A=I.next;else if((e=I)===A){x?x===1?cu(e=Dy(Yo(e),t,i),t,i,l,f,m,2):x===2&&Ly(e,t,i,l,f,m):cu(Yo(e),t,i,l,f,m,1);break}}}function Cy(e){var t=e.prev,i=e,l=e.next;if(Ii(t,i,l)>=0)return!1;for(var f=e.next.next;f!==e.prev;){if(sl(t.x,t.y,i.x,i.y,l.x,l.y,f.x,f.y)&&Ii(f.prev,f,f.next)>=0)return!1;f=f.next}return!0}function My(e,t,i,l){var f=e.prev,m=e,x=e.next;if(Ii(f,m,x)>=0)return!1;for(var k=f.x>m.x?f.x>x.x?f.x:x.x:m.x>x.x?m.x:x.x,I=f.y>m.y?f.y>x.y?f.y:x.y:m.y>x.y?m.y:x.y,A=$h(f.x<m.x?f.x<x.x?f.x:x.x:m.x<x.x?m.x:x.x,f.y<m.y?f.y<x.y?f.y:x.y:m.y<x.y?m.y:x.y,t,i,l),C=$h(k,I,t,i,l),B=e.prevZ,U=e.nextZ;B&&B.z>=A&&U&&U.z<=C;){if(B!==e.prev&&B!==e.next&&sl(f.x,f.y,m.x,m.y,x.x,x.y,B.x,B.y)&&Ii(B.prev,B,B.next)>=0||(B=B.prevZ,U!==e.prev&&U!==e.next&&sl(f.x,f.y,m.x,m.y,x.x,x.y,U.x,U.y)&&Ii(U.prev,U,U.next)>=0))return!1;U=U.nextZ}for(;B&&B.z>=A;){if(B!==e.prev&&B!==e.next&&sl(f.x,f.y,m.x,m.y,x.x,x.y,B.x,B.y)&&Ii(B.prev,B,B.next)>=0)return!1;B=B.prevZ}for(;U&&U.z<=C;){if(U!==e.prev&&U!==e.next&&sl(f.x,f.y,m.x,m.y,x.x,x.y,U.x,U.y)&&Ii(U.prev,U,U.next)>=0)return!1;U=U.nextZ}return!0}function Dy(e,t,i){var l=e;do{var f=l.prev,m=l.next.next;!Mc(f,m)&&$p(f,l,l.next,m)&&hu(f,m)&&hu(m,f)&&(t.push(f.i/i),t.push(l.i/i),t.push(m.i/i),pu(l),pu(l.next),l=e=m),l=l.next}while(l!==e);return Yo(l)}function Ly(e,t,i,l,f,m){var x=e;do{for(var k=x.next.next;k!==x.prev;){if(x.i!==k.i&&Ny(x,k)){var I=ef(x,k);return x=Yo(x,x.next),I=Yo(I,I.next),cu(x,t,i,l,f,m),void cu(I,t,i,l,f,m)}k=k.next}x=x.next}while(x!==e)}function Ry(e,t){return e.x-t.x}function By(e,t){if(t=function(l,f){var m,x=f,k=l.x,I=l.y,A=-1/0;do{if(I<=x.y&&I>=x.next.y&&x.next.y!==x.y){var C=x.x+(I-x.y)*(x.next.x-x.x)/(x.next.y-x.y);if(C<=k&&C>A){if(A=C,C===k){if(I===x.y)return x;if(I===x.next.y)return x.next}m=x.x<x.next.x?x:x.next}}x=x.next}while(x!==f);if(!m)return null;if(k===A)return m;var B,U=m,Z=m.x,Q=m.y,ee=1/0;x=m;do k>=x.x&&x.x>=Z&&k!==x.x&&sl(I<Q?k:A,I,Z,Q,I<Q?A:k,I,x.x,x.y)&&(B=Math.abs(I-x.y)/(k-x.x),hu(x,l)&&(B<ee||B===ee&&(x.x>m.x||x.x===m.x&&Oy(m,x)))&&(m=x,ee=B)),x=x.next;while(x!==U);return m}(e,t)){var i=ef(t,e);Yo(t,t.next),Yo(i,i.next)}}function Oy(e,t){return Ii(e.prev,e,t.prev)<0&&Ii(t.next,e,e.next)<0}function $h(e,t,i,l,f){return(e=1431655765&((e=858993459&((e=252645135&((e=16711935&((e=32767*(e-i)*f)|e<<8))|e<<4))|e<<2))|e<<1))|(t=1431655765&((t=858993459&((t=252645135&((t=16711935&((t=32767*(t-l)*f)|t<<8))|t<<4))|t<<2))|t<<1))<<1}function Fy(e){var t=e,i=e;do(t.x<i.x||t.x===i.x&&t.y<i.y)&&(i=t),t=t.next;while(t!==e);return i}function sl(e,t,i,l,f,m,x,k){return(f-x)*(t-k)-(e-x)*(m-k)>=0&&(e-x)*(l-k)-(i-x)*(t-k)>=0&&(i-x)*(m-k)-(f-x)*(l-k)>=0}function Ny(e,t){return e.next.i!==t.i&&e.prev.i!==t.i&&!function(i,l){var f=i;do{if(f.i!==i.i&&f.next.i!==i.i&&f.i!==l.i&&f.next.i!==l.i&&$p(f,f.next,i,l))return!0;f=f.next}while(f!==i);return!1}(e,t)&&(hu(e,t)&&hu(t,e)&&function(i,l){var f=i,m=!1,x=(i.x+l.x)/2,k=(i.y+l.y)/2;do f.y>k!=f.next.y>k&&f.next.y!==f.y&&x<(f.next.x-f.x)*(k-f.y)/(f.next.y-f.y)+f.x&&(m=!m),f=f.next;while(f!==i);return m}(e,t)&&(Ii(e.prev,e,t.prev)||Ii(e,t.prev,t))||Mc(e,t)&&Ii(e.prev,e,e.next)>0&&Ii(t.prev,t,t.next)>0)}function Ii(e,t,i){return(t.y-e.y)*(i.x-t.x)-(t.x-e.x)*(i.y-t.y)}function Mc(e,t){return e.x===t.x&&e.y===t.y}function $p(e,t,i,l){var f=Lc(Ii(e,t,i)),m=Lc(Ii(e,t,l)),x=Lc(Ii(i,l,e)),k=Lc(Ii(i,l,t));return f!==m&&x!==k||!(f!==0||!Dc(e,i,t))||!(m!==0||!Dc(e,l,t))||!(x!==0||!Dc(i,e,l))||!(k!==0||!Dc(i,t,l))}function Dc(e,t,i){return t.x<=Math.max(e.x,i.x)&&t.x>=Math.min(e.x,i.x)&&t.y<=Math.max(e.y,i.y)&&t.y>=Math.min(e.y,i.y)}function Lc(e){return e>0?1:e<0?-1:0}function hu(e,t){return Ii(e.prev,e,e.next)<0?Ii(e,t,e.next)>=0&&Ii(e,e.prev,t)>=0:Ii(e,t,e.prev)<0||Ii(e,e.next,t)<0}function ef(e,t){var i=new ep(e.i,e.x,e.y),l=new ep(t.i,t.x,t.y),f=e.next,m=t.prev;return e.next=t,t.prev=e,i.next=f,f.prev=i,l.next=i,i.prev=l,m.next=l,l.prev=m,l}function tf(e,t,i,l){var f=new ep(e,t,i);return l?(f.next=l.next,f.prev=l,l.next.prev=f,l.next=f):(f.prev=f,f.next=f),f}function pu(e){e.next.prev=e.prev,e.prev.next=e.next,e.prevZ&&(e.prevZ.nextZ=e.nextZ),e.nextZ&&(e.nextZ.prevZ=e.prevZ)}function ep(e,t,i){this.i=e,this.x=t,this.y=i,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}function tp(e,t,i,l){for(var f=0,m=t,x=i-l;m<i;m+=l)f+=(e[x]-e[m])*(e[m+1]+e[x+1]),x=m;return f}function Uy(e,t,i,l,f){(function m(x,k,I,A,C){for(;A>I;){if(A-I>600){var B=A-I+1,U=k-I+1,Z=Math.log(B),Q=.5*Math.exp(2*Z/3),ee=.5*Math.sqrt(Z*Q*(B-Q)/B)*(U-B/2<0?-1:1);m(x,k,Math.max(I,Math.floor(k-U*Q/B+ee)),Math.min(A,Math.floor(k+(B-U)*Q/B+ee)),C)}var ce=x[k],ne=I,me=A;for(fu(x,I,k),C(x[A],ce)>0&&fu(x,I,A);ne<me;){for(fu(x,ne,me),ne++,me--;C(x[ne],ce)<0;)ne++;for(;C(x[me],ce)>0;)me--}C(x[I],ce)===0?fu(x,I,me):fu(x,++me,A),me<=k&&(I=me+1),k<=me&&(A=me-1)}})(e,t,i||0,l||e.length-1,f||Vy)}function fu(e,t,i){var l=e[t];e[t]=e[i],e[i]=l}function Vy(e,t){return e<t?-1:e>t?1:0}function rp(e,t){var i=e.length;if(i<=1)return[e];for(var l,f,m=[],x=0;x<i;x++){var k=rt(e[x]);k!==0&&(e[x].area=Math.abs(k),f===void 0&&(f=k<0),f===k<0?(l&&m.push(l),l=[e[x]]):l.push(e[x]))}if(l&&m.push(l),t>1)for(var I=0;I<m.length;I++)m[I].length<=t||(Uy(m[I],t,1,m[I].length-1,jy),m[I]=m[I].slice(0,t));return m}function jy(e,t){return t.area-e.area}function ip(e,t,i){for(var l=i.patternDependencies,f=!1,m=0,x=t;m<x.length;m+=1){var k=x[m].paint.get(e+"-pattern");k.isConstant()||(f=!0);var I=k.constantOr(null);I&&(f=!0,l[I.to]=!0,l[I.from]=!0)}return f}function np(e,t,i,l,f){for(var m=f.patternDependencies,x=0,k=t;x<k.length;x+=1){var I=k[x],A=I.paint.get(e+"-pattern").value;if(A.kind!=="constant"){var C=A.evaluate({zoom:l-1},i,{},f.availableImages),B=A.evaluate({zoom:l},i,{},f.availableImages),U=A.evaluate({zoom:l+1},i,{},f.availableImages);B=B&&B.name?B.name:B,U=U&&U.name?U.name:U,m[C=C&&C.name?C.name:C]=!0,m[B]=!0,m[U]=!0,i.patterns[I.id]={min:C,mid:B,max:U}}}return i}Cc.deviation=function(e,t,i,l){var f=t&&t.length,m=Math.abs(tp(e,0,f?t[0]*i:e.length,i));if(f)for(var x=0,k=t.length;x<k;x++)m-=Math.abs(tp(e,t[x]*i,x<k-1?t[x+1]*i:e.length,i));var I=0;for(x=0;x<l.length;x+=3){var A=l[x]*i,C=l[x+1]*i,B=l[x+2]*i;I+=Math.abs((e[A]-e[B])*(e[C+1]-e[A+1])-(e[A]-e[C])*(e[B+1]-e[A+1]))}return m===0&&I===0?0:Math.abs((I-m)/m)},Cc.flatten=function(e){for(var t=e[0][0].length,i={vertices:[],holes:[],dimensions:t},l=0,f=0;f<e.length;f++){for(var m=0;m<e[f].length;m++)for(var x=0;x<t;x++)i.vertices.push(e[f][m][x]);f>0&&i.holes.push(l+=e[f-1].length)}return i},Qh.default=Py;var Ra=function(e){this.zoom=e.zoom,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map(function(t){return t.id}),this.index=e.index,this.hasPattern=!1,this.patternFeatures=[],this.layoutVertexArray=new To,this.indexArray=new Ja,this.indexArray2=new ks,this.programConfigurations=new Lt(e.layers,e.zoom),this.segments=new K,this.segments2=new K,this.stateDependentLayerIds=this.layers.filter(function(t){return t.isStateDependent()}).map(function(t){return t.id})};Ra.prototype.populate=function(e,t,i){this.hasPattern=ip("fill",this.layers,t);for(var l=this.layers[0].layout.get("fill-sort-key"),f=[],m=0,x=e;m<x.length;m+=1){var k=x[m],I=k.feature,A=k.id,C=k.index,B=k.sourceLayerIndex,U=this.layers[0]._featureFilter.needGeometry,Z=mi(I,U);if(this.layers[0]._featureFilter.filter(new ur(this.zoom),Z,i)){var Q=l?l.evaluate(Z,{},i,t.availableImages):void 0,ee={id:A,properties:I.properties,type:I.type,sourceLayerIndex:B,index:C,geometry:U?Z.geometry:ni(I),patterns:{},sortKey:Q};f.push(ee)}}l&&f.sort(function(Ve,Ye){return Ve.sortKey-Ye.sortKey});for(var ce=0,ne=f;ce<ne.length;ce+=1){var me=ne[ce],be=me.geometry,Se=me.index,ze=me.sourceLayerIndex;if(this.hasPattern){var Pe=np("fill",this.layers,me,this.zoom,t);this.patternFeatures.push(Pe)}else this.addFeature(me,be,Se,i,{});t.featureIndex.insert(e[Se].feature,be,Se,ze,this.index)}},Ra.prototype.update=function(e,t,i){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(e,t,this.stateDependentLayers,i)},Ra.prototype.addFeatures=function(e,t,i){for(var l=0,f=this.patternFeatures;l<f.length;l+=1){var m=f[l];this.addFeature(m,m.geometry,m.index,t,i)}},Ra.prototype.isEmpty=function(){return this.layoutVertexArray.length===0},Ra.prototype.uploadPending=function(){return!this.uploaded||this.programConfigurations.needsUpload},Ra.prototype.upload=function(e){this.uploaded||(this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,Ay),this.indexBuffer=e.createIndexBuffer(this.indexArray),this.indexBuffer2=e.createIndexBuffer(this.indexArray2)),this.programConfigurations.upload(e),this.uploaded=!0},Ra.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.indexBuffer2.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.segments2.destroy())},Ra.prototype.addFeature=function(e,t,i,l,f){for(var m=0,x=rp(t,500);m<x.length;m+=1){for(var k=x[m],I=0,A=0,C=k;A<C.length;A+=1)I+=C[A].length;for(var B=this.segments.prepareSegment(I,this.layoutVertexArray,this.indexArray),U=B.vertexLength,Z=[],Q=[],ee=0,ce=k;ee<ce.length;ee+=1){var ne=ce[ee];if(ne.length!==0){ne!==k[0]&&Q.push(Z.length/2);var me=this.segments2.prepareSegment(ne.length,this.layoutVertexArray,this.indexArray2),be=me.vertexLength;this.layoutVertexArray.emplaceBack(ne[0].x,ne[0].y),this.indexArray2.emplaceBack(be+ne.length-1,be),Z.push(ne[0].x),Z.push(ne[0].y);for(var Se=1;Se<ne.length;Se++)this.layoutVertexArray.emplaceBack(ne[Se].x,ne[Se].y),this.indexArray2.emplaceBack(be+Se-1,be+Se),Z.push(ne[Se].x),Z.push(ne[Se].y);me.vertexLength+=ne.length,me.primitiveLength+=ne.length}}for(var ze=Qh(Z,Q),Pe=0;Pe<ze.length;Pe+=3)this.indexArray.emplaceBack(U+ze[Pe],U+ze[Pe+1],U+ze[Pe+2]);B.vertexLength+=I,B.primitiveLength+=ze.length/3}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,e,i,f,l)},ut("FillBucket",Ra,{omit:["layers","patternFeatures"]});var qy=new an({"fill-sort-key":new ft(j.layout_fill["fill-sort-key"])}),Zy={paint:new an({"fill-antialias":new xt(j.paint_fill["fill-antialias"]),"fill-opacity":new ft(j.paint_fill["fill-opacity"]),"fill-color":new ft(j.paint_fill["fill-color"]),"fill-outline-color":new ft(j.paint_fill["fill-outline-color"]),"fill-translate":new xt(j.paint_fill["fill-translate"]),"fill-translate-anchor":new xt(j.paint_fill["fill-translate-anchor"]),"fill-pattern":new el(j.paint_fill["fill-pattern"])}),layout:qy},Gy=function(e){function t(i){e.call(this,i,Zy)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.recalculate=function(i,l){e.prototype.recalculate.call(this,i,l);var f=this.paint._values["fill-outline-color"];f.value.kind==="constant"&&f.value.value===void 0&&(this.paint._values["fill-outline-color"]=this.paint._values["fill-color"])},t.prototype.createBucket=function(i){return new Ra(i)},t.prototype.queryRadius=function(){return Ri(this.paint.get("fill-translate"))},t.prototype.queryIntersectsFeature=function(i,l,f,m,x,k,I){return _a(La(i,this.paint.get("fill-translate"),this.paint.get("fill-translate-anchor"),k.angle,I),m)},t.prototype.isTileClipped=function(){return!0},t}(Ta),Ky=Ki([{name:"a_pos",components:2,type:"Int16"},{name:"a_normal_ed",components:4,type:"Int16"}],4).members,rf=ll;function ll(e,t,i,l,f){this.properties={},this.extent=i,this.type=0,this._pbf=e,this._geometry=-1,this._keys=l,this._values=f,e.readFields(Xy,this,t)}function Xy(e,t,i){e==1?t.id=i.readVarint():e==2?function(l,f){for(var m=l.readVarint()+l.pos;l.pos<m;){var x=f._keys[l.readVarint()],k=f._values[l.readVarint()];f.properties[x]=k}}(i,t):e==3?t.type=i.readVarint():e==4&&(t._geometry=i.pos)}function Wy(e){for(var t,i,l=0,f=0,m=e.length,x=m-1;f<m;x=f++)l+=((i=e[x]).x-(t=e[f]).x)*(t.y+i.y);return l}ll.types=["Unknown","Point","LineString","Polygon"],ll.prototype.loadGeometry=function(){var e=this._pbf;e.pos=this._geometry;for(var t,i=e.readVarint()+e.pos,l=1,f=0,m=0,x=0,k=[];e.pos<i;){if(f<=0){var I=e.readVarint();l=7&I,f=I>>3}if(f--,l===1||l===2)m+=e.readSVarint(),x+=e.readSVarint(),l===1&&(t&&k.push(t),t=[]),t.push(new F(m,x));else{if(l!==7)throw new Error("unknown command "+l);t&&t.push(t[0].clone())}}return t&&k.push(t),k},ll.prototype.bbox=function(){var e=this._pbf;e.pos=this._geometry;for(var t=e.readVarint()+e.pos,i=1,l=0,f=0,m=0,x=1/0,k=-1/0,I=1/0,A=-1/0;e.pos<t;){if(l<=0){var C=e.readVarint();i=7&C,l=C>>3}if(l--,i===1||i===2)(f+=e.readSVarint())<x&&(x=f),f>k&&(k=f),(m+=e.readSVarint())<I&&(I=m),m>A&&(A=m);else if(i!==7)throw new Error("unknown command "+i)}return[x,I,k,A]},ll.prototype.toGeoJSON=function(e,t,i){var l,f,m=this.extent*Math.pow(2,i),x=this.extent*e,k=this.extent*t,I=this.loadGeometry(),A=ll.types[this.type];function C(Z){for(var Q=0;Q<Z.length;Q++){var ee=Z[Q];Z[Q]=[360*(ee.x+x)/m-180,360/Math.PI*Math.atan(Math.exp((180-360*(ee.y+k)/m)*Math.PI/180))-90]}}switch(this.type){case 1:var B=[];for(l=0;l<I.length;l++)B[l]=I[l][0];C(I=B);break;case 2:for(l=0;l<I.length;l++)C(I[l]);break;case 3:for(I=function(Z){var Q=Z.length;if(Q<=1)return[Z];for(var ee,ce,ne=[],me=0;me<Q;me++){var be=Wy(Z[me]);be!==0&&(ce===void 0&&(ce=be<0),ce===be<0?(ee&&ne.push(ee),ee=[Z[me]]):ee.push(Z[me]))}return ee&&ne.push(ee),ne}(I),l=0;l<I.length;l++)for(f=0;f<I[l].length;f++)C(I[l][f])}I.length===1?I=I[0]:A="Multi"+A;var U={type:"Feature",geometry:{type:A,coordinates:I},properties:this.properties};return"id"in this&&(U.id=this.id),U};var nf=af;function af(e,t){this.version=1,this.name=null,this.extent=4096,this.length=0,this._pbf=e,this._keys=[],this._values=[],this._features=[],e.readFields(Hy,this,t),this.length=this._features.length}function Hy(e,t,i){e===15?t.version=i.readVarint():e===1?t.name=i.readString():e===5?t.extent=i.readVarint():e===2?t._features.push(i.pos):e===3?t._keys.push(i.readString()):e===4&&t._values.push(function(l){for(var f=null,m=l.readVarint()+l.pos;l.pos<m;){var x=l.readVarint()>>3;f=x===1?l.readString():x===2?l.readFloat():x===3?l.readDouble():x===4?l.readVarint64():x===5?l.readVarint():x===6?l.readSVarint():x===7?l.readBoolean():null}return f}(i))}function Jy(e,t,i){if(e===3){var l=new nf(i,i.readVarint()+i.pos);l.length&&(t[l.name]=l)}}af.prototype.feature=function(e){if(e<0||e>=this._features.length)throw new Error("feature index out of bounds");this._pbf.pos=this._features[e];var t=this._pbf.readVarint()+this._pbf.pos;return new rf(this._pbf,t,this.extent,this._keys,this._values)};var ul={VectorTile:function(e,t){this.layers=e.readFields(Jy,{},t)},VectorTileFeature:rf,VectorTileLayer:nf},Yy=ul.VectorTileFeature.types,ap=Math.pow(2,13);function du(e,t,i,l,f,m,x,k){e.emplaceBack(t,i,2*Math.floor(l*ap)+x,f*ap*2,m*ap*2,Math.round(k))}var Ba=function(e){this.zoom=e.zoom,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map(function(t){return t.id}),this.index=e.index,this.hasPattern=!1,this.layoutVertexArray=new Da,this.indexArray=new Ja,this.programConfigurations=new Lt(e.layers,e.zoom),this.segments=new K,this.stateDependentLayerIds=this.layers.filter(function(t){return t.isStateDependent()}).map(function(t){return t.id})};function Qy(e,t){return e.x===t.x&&(e.x<0||e.x>8192)||e.y===t.y&&(e.y<0||e.y>8192)}Ba.prototype.populate=function(e,t,i){this.features=[],this.hasPattern=ip("fill-extrusion",this.layers,t);for(var l=0,f=e;l<f.length;l+=1){var m=f[l],x=m.feature,k=m.id,I=m.index,A=m.sourceLayerIndex,C=this.layers[0]._featureFilter.needGeometry,B=mi(x,C);if(this.layers[0]._featureFilter.filter(new ur(this.zoom),B,i)){var U={id:k,sourceLayerIndex:A,index:I,geometry:C?B.geometry:ni(x),properties:x.properties,type:x.type,patterns:{}};this.hasPattern?this.features.push(np("fill-extrusion",this.layers,U,this.zoom,t)):this.addFeature(U,U.geometry,I,i,{}),t.featureIndex.insert(x,U.geometry,I,A,this.index,!0)}}},Ba.prototype.addFeatures=function(e,t,i){for(var l=0,f=this.features;l<f.length;l+=1){var m=f[l];this.addFeature(m,m.geometry,m.index,t,i)}},Ba.prototype.update=function(e,t,i){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(e,t,this.stateDependentLayers,i)},Ba.prototype.isEmpty=function(){return this.layoutVertexArray.length===0},Ba.prototype.uploadPending=function(){return!this.uploaded||this.programConfigurations.needsUpload},Ba.prototype.upload=function(e){this.uploaded||(this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,Ky),this.indexBuffer=e.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(e),this.uploaded=!0},Ba.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())},Ba.prototype.addFeature=function(e,t,i,l,f){for(var m=0,x=rp(t,500);m<x.length;m+=1){for(var k=x[m],I=0,A=0,C=k;A<C.length;A+=1)I+=C[A].length;for(var B=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray),U=0,Z=k;U<Z.length;U+=1){var Q=Z[U];if(Q.length!==0&&!((or=Q).every(function(Kt){return Kt.x<0})||or.every(function(Kt){return Kt.x>8192})||or.every(function(Kt){return Kt.y<0})||or.every(function(Kt){return Kt.y>8192})))for(var ee=0,ce=0;ce<Q.length;ce++){var ne=Q[ce];if(ce>=1){var me=Q[ce-1];if(!Qy(ne,me)){B.vertexLength+4>K.MAX_VERTEX_ARRAY_LENGTH&&(B=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray));var be=ne.sub(me)._perp()._unit(),Se=me.dist(ne);ee+Se>32768&&(ee=0),du(this.layoutVertexArray,ne.x,ne.y,be.x,be.y,0,0,ee),du(this.layoutVertexArray,ne.x,ne.y,be.x,be.y,0,1,ee),du(this.layoutVertexArray,me.x,me.y,be.x,be.y,0,0,ee+=Se),du(this.layoutVertexArray,me.x,me.y,be.x,be.y,0,1,ee);var ze=B.vertexLength;this.indexArray.emplaceBack(ze,ze+2,ze+1),this.indexArray.emplaceBack(ze+1,ze+2,ze+3),B.vertexLength+=4,B.primitiveLength+=2}}}}if(B.vertexLength+I>K.MAX_VERTEX_ARRAY_LENGTH&&(B=this.segments.prepareSegment(I,this.layoutVertexArray,this.indexArray)),Yy[e.type]==="Polygon"){for(var Pe=[],Ve=[],Ye=B.vertexLength,vt=0,it=k;vt<it.length;vt+=1){var St=it[vt];if(St.length!==0){St!==k[0]&&Ve.push(Pe.length/2);for(var nt=0;nt<St.length;nt++){var Qt=St[nt];du(this.layoutVertexArray,Qt.x,Qt.y,0,0,1,1,0),Pe.push(Qt.x),Pe.push(Qt.y)}}}for(var Rt=Qh(Pe,Ve),dt=0;dt<Rt.length;dt+=3)this.indexArray.emplaceBack(Ye+Rt[dt],Ye+Rt[dt+2],Ye+Rt[dt+1]);B.primitiveLength+=Rt.length/3,B.vertexLength+=I}}var or;this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,e,i,f,l)},ut("FillExtrusionBucket",Ba,{omit:["layers","features"]});var $y={paint:new an({"fill-extrusion-opacity":new xt(j["paint_fill-extrusion"]["fill-extrusion-opacity"]),"fill-extrusion-color":new ft(j["paint_fill-extrusion"]["fill-extrusion-color"]),"fill-extrusion-translate":new xt(j["paint_fill-extrusion"]["fill-extrusion-translate"]),"fill-extrusion-translate-anchor":new xt(j["paint_fill-extrusion"]["fill-extrusion-translate-anchor"]),"fill-extrusion-pattern":new el(j["paint_fill-extrusion"]["fill-extrusion-pattern"]),"fill-extrusion-height":new ft(j["paint_fill-extrusion"]["fill-extrusion-height"]),"fill-extrusion-base":new ft(j["paint_fill-extrusion"]["fill-extrusion-base"]),"fill-extrusion-vertical-gradient":new xt(j["paint_fill-extrusion"]["fill-extrusion-vertical-gradient"])})},eg=function(e){function t(i){e.call(this,i,$y)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.createBucket=function(i){return new Ba(i)},t.prototype.queryRadius=function(){return Ri(this.paint.get("fill-extrusion-translate"))},t.prototype.is3D=function(){return!0},t.prototype.queryIntersectsFeature=function(i,l,f,m,x,k,I,A){var C=La(i,this.paint.get("fill-extrusion-translate"),this.paint.get("fill-extrusion-translate-anchor"),k.angle,I),B=this.paint.get("fill-extrusion-height").evaluate(l,f),U=this.paint.get("fill-extrusion-base").evaluate(l,f),Z=function(ee,ce,ne,me){for(var be=[],Se=0,ze=ee;Se<ze.length;Se+=1){var Pe=ze[Se],Ve=[Pe.x,Pe.y,0,1];al(Ve,Ve,ce),be.push(new F(Ve[0]/Ve[3],Ve[1]/Ve[3]))}return be}(C,A),Q=function(ee,ce,ne,me){for(var be=[],Se=[],ze=me[8]*ce,Pe=me[9]*ce,Ve=me[10]*ce,Ye=me[11]*ce,vt=me[8]*ne,it=me[9]*ne,St=me[10]*ne,nt=me[11]*ne,Qt=0,Rt=ee;Qt<Rt.length;Qt+=1){for(var dt=[],or=[],Kt=0,gr=Rt[Qt];Kt<gr.length;Kt+=1){var kt=gr[Kt],Sr=kt.x,Qr=kt.y,ci=me[0]*Sr+me[4]*Qr+me[12],ai=me[1]*Sr+me[5]*Qr+me[13],$r=me[2]*Sr+me[6]*Qr+me[14],hi=me[3]*Sr+me[7]*Qr+me[15],Bi=$r+Ve,Oi=hi+Ye,Tn=ci+vt,Hi=ai+it,zn=$r+St,yi=hi+nt,Ji=new F((ci+ze)/Oi,(ai+Pe)/Oi);Ji.z=Bi/Oi,dt.push(Ji);var pr=new F(Tn/yi,Hi/yi);pr.z=zn/yi,or.push(pr)}be.push(dt),Se.push(or)}return[be,Se]}(m,U,B,A);return function(ee,ce,ne){var me=1/0;_a(ne,ce)&&(me=of(ne,ce[0]));for(var be=0;be<ce.length;be++)for(var Se=ce[be],ze=ee[be],Pe=0;Pe<Se.length-1;Pe++){var Ve=Se[Pe],Ye=[Ve,Se[Pe+1],ze[Pe+1],ze[Pe],Ve];$a(ne,Ye)&&(me=Math.min(me,of(ne,Ye)))}return me!==1/0&&me}(Q[0],Q[1],Z)},t}(Ta);function mu(e,t){return e.x*t.x+e.y*t.y}function of(e,t){if(e.length===1){for(var i,l=0,f=t[l++];!i||f.equals(i);)if(!(i=t[l++]))return 1/0;for(;l<t.length;l++){var m=t[l],x=e[0],k=i.sub(f),I=m.sub(f),A=x.sub(f),C=mu(k,k),B=mu(k,I),U=mu(I,I),Z=mu(A,k),Q=mu(A,I),ee=C*U-B*B,ce=(U*Z-B*Q)/ee,ne=(C*Q-B*Z)/ee,me=f.z*(1-ce-ne)+i.z*ce+m.z*ne;if(isFinite(me))return me}return 1/0}for(var be=1/0,Se=0,ze=t;Se<ze.length;Se+=1)be=Math.min(be,ze[Se].z);return be}var tg=Ki([{name:"a_pos_normal",components:2,type:"Int16"},{name:"a_data",components:4,type:"Uint8"}],4).members,rg=Ki([{name:"a_uv_x",components:1,type:"Float32"},{name:"a_split_index",components:1,type:"Float32"}]).members,ig=ul.VectorTileFeature.types,ng=Math.cos(Math.PI/180*37.5),sf=Math.pow(2,14)/.5,Rn=function(e){var t=this;this.zoom=e.zoom,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map(function(i){return i.id}),this.index=e.index,this.hasPattern=!1,this.patternFeatures=[],this.lineClipsArray=[],this.gradients={},this.layers.forEach(function(i){t.gradients[i.id]={}}),this.layoutVertexArray=new Xn,this.layoutVertexArray2=new Go,this.indexArray=new Ja,this.programConfigurations=new Lt(e.layers,e.zoom),this.segments=new K,this.maxLineLength=0,this.stateDependentLayerIds=this.layers.filter(function(i){return i.isStateDependent()}).map(function(i){return i.id})};Rn.prototype.populate=function(e,t,i){this.hasPattern=ip("line",this.layers,t);for(var l=this.layers[0].layout.get("line-sort-key"),f=[],m=0,x=e;m<x.length;m+=1){var k=x[m],I=k.feature,A=k.id,C=k.index,B=k.sourceLayerIndex,U=this.layers[0]._featureFilter.needGeometry,Z=mi(I,U);if(this.layers[0]._featureFilter.filter(new ur(this.zoom),Z,i)){var Q=l?l.evaluate(Z,{},i):void 0,ee={id:A,properties:I.properties,type:I.type,sourceLayerIndex:B,index:C,geometry:U?Z.geometry:ni(I),patterns:{},sortKey:Q};f.push(ee)}}l&&f.sort(function(Ve,Ye){return Ve.sortKey-Ye.sortKey});for(var ce=0,ne=f;ce<ne.length;ce+=1){var me=ne[ce],be=me.geometry,Se=me.index,ze=me.sourceLayerIndex;if(this.hasPattern){var Pe=np("line",this.layers,me,this.zoom,t);this.patternFeatures.push(Pe)}else this.addFeature(me,be,Se,i,{});t.featureIndex.insert(e[Se].feature,be,Se,ze,this.index)}},Rn.prototype.update=function(e,t,i){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(e,t,this.stateDependentLayers,i)},Rn.prototype.addFeatures=function(e,t,i){for(var l=0,f=this.patternFeatures;l<f.length;l+=1){var m=f[l];this.addFeature(m,m.geometry,m.index,t,i)}},Rn.prototype.isEmpty=function(){return this.layoutVertexArray.length===0},Rn.prototype.uploadPending=function(){return!this.uploaded||this.programConfigurations.needsUpload},Rn.prototype.upload=function(e){this.uploaded||(this.layoutVertexArray2.length!==0&&(this.layoutVertexBuffer2=e.createVertexBuffer(this.layoutVertexArray2,rg)),this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,tg),this.indexBuffer=e.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(e),this.uploaded=!0},Rn.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())},Rn.prototype.lineFeatureClips=function(e){if(e.properties&&e.properties.hasOwnProperty("mapbox_clip_start")&&e.properties.hasOwnProperty("mapbox_clip_end"))return{start:+e.properties.mapbox_clip_start,end:+e.properties.mapbox_clip_end}},Rn.prototype.addFeature=function(e,t,i,l,f){var m=this.layers[0].layout,x=m.get("line-join").evaluate(e,{}),k=m.get("line-cap"),I=m.get("line-miter-limit"),A=m.get("line-round-limit");this.lineClips=this.lineFeatureClips(e);for(var C=0,B=t;C<B.length;C+=1)this.addLine(B[C],e,x,k,I,A);this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,e,i,f,l)},Rn.prototype.addLine=function(e,t,i,l,f,m){if(this.distance=0,this.scaledDistance=0,this.totalDistance=0,this.lineClips){this.lineClipsArray.push(this.lineClips);for(var x=0;x<e.length-1;x++)this.totalDistance+=e[x].dist(e[x+1]);this.updateScaledDistance(),this.maxLineLength=Math.max(this.maxLineLength,this.totalDistance)}for(var k=ig[t.type]==="Polygon",I=e.length;I>=2&&e[I-1].equals(e[I-2]);)I--;for(var A=0;A<I-1&&e[A].equals(e[A+1]);)A++;if(!(I<(k?3:2))){i==="bevel"&&(f=1.05);var C,B=this.overscaling<=16?122880/(512*this.overscaling):0,U=this.segments.prepareSegment(10*I,this.layoutVertexArray,this.indexArray),Z=void 0,Q=void 0,ee=void 0,ce=void 0;this.e1=this.e2=-1,k&&(ce=e[A].sub(C=e[I-2])._unit()._perp());for(var ne=A;ne<I;ne++)if(!(Q=ne===I-1?k?e[A+1]:void 0:e[ne+1])||!e[ne].equals(Q)){ce&&(ee=ce),C&&(Z=C),C=e[ne],ce=Q?Q.sub(C)._unit()._perp():ee;var me=(ee=ee||ce).add(ce);me.x===0&&me.y===0||me._unit();var be=ee.x*ce.x+ee.y*ce.y,Se=me.x*ce.x+me.y*ce.y,ze=Se!==0?1/Se:1/0,Pe=2*Math.sqrt(2-2*Se),Ve=Se<ng&&Z&&Q,Ye=ee.x*ce.y-ee.y*ce.x>0;if(Ve&&ne>A){var vt=C.dist(Z);if(vt>2*B){var it=C.sub(C.sub(Z)._mult(B/vt)._round());this.updateDistance(Z,it),this.addCurrentVertex(it,ee,0,0,U),Z=it}}var St=Z&&Q,nt=St?i:k?"butt":l;if(St&&nt==="round"&&(ze<m?nt="miter":ze<=2&&(nt="fakeround")),nt==="miter"&&ze>f&&(nt="bevel"),nt==="bevel"&&(ze>2&&(nt="flipbevel"),ze<f&&(nt="miter")),Z&&this.updateDistance(Z,C),nt==="miter")me._mult(ze),this.addCurrentVertex(C,me,0,0,U);else if(nt==="flipbevel"){if(ze>100)me=ce.mult(-1);else{var Qt=ze*ee.add(ce).mag()/ee.sub(ce).mag();me._perp()._mult(Qt*(Ye?-1:1))}this.addCurrentVertex(C,me,0,0,U),this.addCurrentVertex(C,me.mult(-1),0,0,U)}else if(nt==="bevel"||nt==="fakeround"){var Rt=-Math.sqrt(ze*ze-1),dt=Ye?Rt:0,or=Ye?0:Rt;if(Z&&this.addCurrentVertex(C,ee,dt,or,U),nt==="fakeround")for(var Kt=Math.round(180*Pe/Math.PI/20),gr=1;gr<Kt;gr++){var kt=gr/Kt;if(kt!==.5){var Sr=kt-.5;kt+=kt*Sr*(kt-1)*((1.0904+be*(be*(3.55645-1.43519*be)-3.2452))*Sr*Sr+(.848013+be*(.215638*be-1.06021)))}var Qr=ce.sub(ee)._mult(kt)._add(ee)._unit()._mult(Ye?-1:1);this.addHalfVertex(C,Qr.x,Qr.y,!1,Ye,0,U)}Q&&this.addCurrentVertex(C,ce,-dt,-or,U)}else if(nt==="butt")this.addCurrentVertex(C,me,0,0,U);else if(nt==="square"){var ci=Z?1:-1;this.addCurrentVertex(C,me,ci,ci,U)}else nt==="round"&&(Z&&(this.addCurrentVertex(C,ee,0,0,U),this.addCurrentVertex(C,ee,1,1,U,!0)),Q&&(this.addCurrentVertex(C,ce,-1,-1,U,!0),this.addCurrentVertex(C,ce,0,0,U)));if(Ve&&ne<I-1){var ai=C.dist(Q);if(ai>2*B){var $r=C.add(Q.sub(C)._mult(B/ai)._round());this.updateDistance(C,$r),this.addCurrentVertex($r,ce,0,0,U),C=$r}}}}},Rn.prototype.addCurrentVertex=function(e,t,i,l,f,m){m===void 0&&(m=!1);var x=t.y*l-t.x,k=-t.y-t.x*l;this.addHalfVertex(e,t.x+t.y*i,t.y-t.x*i,m,!1,i,f),this.addHalfVertex(e,x,k,m,!0,-l,f),this.distance>sf/2&&this.totalDistance===0&&(this.distance=0,this.addCurrentVertex(e,t,i,l,f,m))},Rn.prototype.addHalfVertex=function(e,t,i,l,f,m,x){var k=.5*(this.lineClips?this.scaledDistance*(sf-1):this.scaledDistance);this.layoutVertexArray.emplaceBack((e.x<<1)+(l?1:0),(e.y<<1)+(f?1:0),Math.round(63*t)+128,Math.round(63*i)+128,1+(m===0?0:m<0?-1:1)|(63&k)<<2,k>>6),this.lineClips&&this.layoutVertexArray2.emplaceBack((this.scaledDistance-this.lineClips.start)/(this.lineClips.end-this.lineClips.start),this.lineClipsArray.length);var I=x.vertexLength++;this.e1>=0&&this.e2>=0&&(this.indexArray.emplaceBack(this.e1,this.e2,I),x.primitiveLength++),f?this.e2=I:this.e1=I},Rn.prototype.updateScaledDistance=function(){this.scaledDistance=this.lineClips?this.lineClips.start+(this.lineClips.end-this.lineClips.start)*this.distance/this.totalDistance:this.distance},Rn.prototype.updateDistance=function(e,t){this.distance+=e.dist(t),this.updateScaledDistance()},ut("LineBucket",Rn,{omit:["layers","patternFeatures"]});var ag=new an({"line-cap":new xt(j.layout_line["line-cap"]),"line-join":new ft(j.layout_line["line-join"]),"line-miter-limit":new xt(j.layout_line["line-miter-limit"]),"line-round-limit":new xt(j.layout_line["line-round-limit"]),"line-sort-key":new ft(j.layout_line["line-sort-key"])}),lf={paint:new an({"line-opacity":new ft(j.paint_line["line-opacity"]),"line-color":new ft(j.paint_line["line-color"]),"line-translate":new xt(j.paint_line["line-translate"]),"line-translate-anchor":new xt(j.paint_line["line-translate-anchor"]),"line-width":new ft(j.paint_line["line-width"]),"line-gap-width":new ft(j.paint_line["line-gap-width"]),"line-offset":new ft(j.paint_line["line-offset"]),"line-blur":new ft(j.paint_line["line-blur"]),"line-dasharray":new Sn(j.paint_line["line-dasharray"]),"line-pattern":new el(j.paint_line["line-pattern"]),"line-gradient":new ga(j.paint_line["line-gradient"])}),layout:ag},uf=new(function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.possiblyEvaluate=function(i,l){return l=new ur(Math.floor(l.zoom),{now:l.now,fadeDuration:l.fadeDuration,zoomHistory:l.zoomHistory,transition:l.transition}),e.prototype.possiblyEvaluate.call(this,i,l)},t.prototype.evaluate=function(i,l,f,m){return l=xe({},l,{zoom:Math.floor(l.zoom)}),e.prototype.evaluate.call(this,i,l,f,m)},t}(ft))(lf.paint.properties["line-width"].specification);uf.useIntegerZoom=!0;var og=function(e){function t(i){e.call(this,i,lf),this.gradientVersion=0}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._handleSpecialPaintPropertyUpdate=function(i){i==="line-gradient"&&(this.stepInterpolant=this._transitionablePaint._values["line-gradient"].value.expression._styleExpression.expression instanceof jn,this.gradientVersion=(this.gradientVersion+1)%H)},t.prototype.gradientExpression=function(){return this._transitionablePaint._values["line-gradient"].value.expression},t.prototype.recalculate=function(i,l){e.prototype.recalculate.call(this,i,l),this.paint._values["line-floorwidth"]=uf.possiblyEvaluate(this._transitioningPaint._values["line-width"].value,i)},t.prototype.createBucket=function(i){return new Rn(i)},t.prototype.queryRadius=function(i){var l=i,f=cf(Aa("line-width",this,l),Aa("line-gap-width",this,l)),m=Aa("line-offset",this,l);return f/2+Math.abs(m)+Ri(this.paint.get("line-translate"))},t.prototype.queryIntersectsFeature=function(i,l,f,m,x,k,I){var A=La(i,this.paint.get("line-translate"),this.paint.get("line-translate-anchor"),k.angle,I),C=I/2*cf(this.paint.get("line-width").evaluate(l,f),this.paint.get("line-gap-width").evaluate(l,f)),B=this.paint.get("line-offset").evaluate(l,f);return B&&(m=function(U,Z){for(var Q=[],ee=new F(0,0),ce=0;ce<U.length;ce++){for(var ne=U[ce],me=[],be=0;be<ne.length;be++){var Se=ne[be],ze=ne[be+1],Pe=be===0?ee:Se.sub(ne[be-1])._unit()._perp(),Ve=be===ne.length-1?ee:ze.sub(Se)._unit()._perp(),Ye=Pe._add(Ve)._unit();Ye._mult(1/(Ye.x*Ve.x+Ye.y*Ve.y)),me.push(Ye._mult(Z)._add(Se))}Q.push(me)}return Q}(m,B*I)),function(U,Z,Q){for(var ee=0;ee<Z.length;ee++){var ce=Z[ee];if(U.length>=3){for(var ne=0;ne<ce.length;ne++)if(Ia(U,ce[ne]))return!0}if(sa(U,ce,Q))return!0}return!1}(A,m,C)},t.prototype.isTileClipped=function(){return!0},t}(Ta);function cf(e,t){return t>0?t+2*e:e}var sg=Ki([{name:"a_pos_offset",components:4,type:"Int16"},{name:"a_data",components:4,type:"Uint16"},{name:"a_pixeloffset",components:4,type:"Int16"}],4),lg=Ki([{name:"a_projected_pos",components:3,type:"Float32"}],4),ug=(Ki([{name:"a_fade_opacity",components:1,type:"Uint32"}],4),Ki([{name:"a_placed",components:2,type:"Uint8"},{name:"a_shift",components:2,type:"Float32"}])),hf=(Ki([{type:"Int16",name:"anchorPointX"},{type:"Int16",name:"anchorPointY"},{type:"Int16",name:"x1"},{type:"Int16",name:"y1"},{type:"Int16",name:"x2"},{type:"Int16",name:"y2"},{type:"Uint32",name:"featureIndex"},{type:"Uint16",name:"sourceLayerIndex"},{type:"Uint16",name:"bucketIndex"}]),Ki([{name:"a_pos",components:2,type:"Int16"},{name:"a_anchor_pos",components:2,type:"Int16"},{name:"a_extrude",components:2,type:"Int16"}],4)),cg=Ki([{name:"a_pos",components:2,type:"Float32"},{name:"a_radius",components:1,type:"Float32"},{name:"a_flags",components:2,type:"Int16"}],4);function hg(e,t,i){return e.sections.forEach(function(l){l.text=function(f,m,x){var k=m.layout.get("text-transform").evaluate(x,{});return k==="uppercase"?f=f.toLocaleUpperCase():k==="lowercase"&&(f=f.toLocaleLowerCase()),ta.applyArabicShaping&&(f=ta.applyArabicShaping(f)),f}(l.text,t,i)}),e}Ki([{name:"triangle",components:3,type:"Uint16"}]),Ki([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Uint16",name:"glyphStartIndex"},{type:"Uint16",name:"numGlyphs"},{type:"Uint32",name:"vertexStartIndex"},{type:"Uint32",name:"lineStartIndex"},{type:"Uint32",name:"lineLength"},{type:"Uint16",name:"segment"},{type:"Uint16",name:"lowerSize"},{type:"Uint16",name:"upperSize"},{type:"Float32",name:"lineOffsetX"},{type:"Float32",name:"lineOffsetY"},{type:"Uint8",name:"writingMode"},{type:"Uint8",name:"placedOrientation"},{type:"Uint8",name:"hidden"},{type:"Uint32",name:"crossTileID"},{type:"Int16",name:"associatedIconIndex"}]),Ki([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Int16",name:"rightJustifiedTextSymbolIndex"},{type:"Int16",name:"centerJustifiedTextSymbolIndex"},{type:"Int16",name:"leftJustifiedTextSymbolIndex"},{type:"Int16",name:"verticalPlacedTextSymbolIndex"},{type:"Int16",name:"placedIconSymbolIndex"},{type:"Int16",name:"verticalPlacedIconSymbolIndex"},{type:"Uint16",name:"key"},{type:"Uint16",name:"textBoxStartIndex"},{type:"Uint16",name:"textBoxEndIndex"},{type:"Uint16",name:"verticalTextBoxStartIndex"},{type:"Uint16",name:"verticalTextBoxEndIndex"},{type:"Uint16",name:"iconBoxStartIndex"},{type:"Uint16",name:"iconBoxEndIndex"},{type:"Uint16",name:"verticalIconBoxStartIndex"},{type:"Uint16",name:"verticalIconBoxEndIndex"},{type:"Uint16",name:"featureIndex"},{type:"Uint16",name:"numHorizontalGlyphVertices"},{type:"Uint16",name:"numVerticalGlyphVertices"},{type:"Uint16",name:"numIconVertices"},{type:"Uint16",name:"numVerticalIconVertices"},{type:"Uint16",name:"useRuntimeCollisionCircles"},{type:"Uint32",name:"crossTileID"},{type:"Float32",name:"textBoxScale"},{type:"Float32",components:2,name:"textOffset"},{type:"Float32",name:"collisionCircleDiameter"}]),Ki([{type:"Float32",name:"offsetX"}]),Ki([{type:"Int16",name:"x"},{type:"Int16",name:"y"},{type:"Int16",name:"tileUnitDistanceFromAnchor"}]);var yu={"!":"︕","#":"＃",$:"＄","%":"％","&":"＆","(":"︵",")":"︶","*":"＊","+":"＋",",":"︐","-":"︲",".":"・","/":"／",":":"︓",";":"︔","<":"︿","=":"＝",">":"﹀","?":"︖","@":"＠","[":"﹇","\\":"＼","]":"﹈","^":"＾",_:"︳","`":"｀","{":"︷","|":"―","}":"︸","~":"～","¢":"￠","£":"￡","¥":"￥","¦":"￤","¬":"￢","¯":"￣","–":"︲","—":"︱","‘":"﹃","’":"﹄","“":"﹁","”":"﹂","…":"︙","‧":"・","₩":"￦","、":"︑","。":"︒","〈":"︿","〉":"﹀","《":"︽","》":"︾","「":"﹁","」":"﹂","『":"﹃","』":"﹄","【":"︻","】":"︼","〔":"︹","〕":"︺","〖":"︗","〗":"︘","！":"︕","（":"︵","）":"︶","，":"︐","－":"︲","．":"・","：":"︓","；":"︔","＜":"︿","＞":"﹀","？":"︖","［":"﹇","］":"﹈","＿":"︳","｛":"︷","｜":"―","｝":"︸","｟":"︵","｠":"︶","｡":"︒","｢":"﹁","｣":"﹂"},pf=function(e,t,i,l,f){var m,x,k=8*f-l-1,I=(1<<k)-1,A=I>>1,C=-7,B=i?f-1:0,U=i?-1:1,Z=e[t+B];for(B+=U,m=Z&(1<<-C)-1,Z>>=-C,C+=k;C>0;m=256*m+e[t+B],B+=U,C-=8);for(x=m&(1<<-C)-1,m>>=-C,C+=l;C>0;x=256*x+e[t+B],B+=U,C-=8);if(m===0)m=1-A;else{if(m===I)return x?NaN:1/0*(Z?-1:1);x+=Math.pow(2,l),m-=A}return(Z?-1:1)*x*Math.pow(2,m-l)},ff=function(e,t,i,l,f,m){var x,k,I,A=8*m-f-1,C=(1<<A)-1,B=C>>1,U=f===23?Math.pow(2,-24)-Math.pow(2,-77):0,Z=l?0:m-1,Q=l?1:-1,ee=t<0||t===0&&1/t<0?1:0;for(t=Math.abs(t),isNaN(t)||t===1/0?(k=isNaN(t)?1:0,x=C):(x=Math.floor(Math.log(t)/Math.LN2),t*(I=Math.pow(2,-x))<1&&(x--,I*=2),(t+=x+B>=1?U/I:U*Math.pow(2,1-B))*I>=2&&(x++,I/=2),x+B>=C?(k=0,x=C):x+B>=1?(k=(t*I-1)*Math.pow(2,f),x+=B):(k=t*Math.pow(2,B-1)*Math.pow(2,f),x=0));f>=8;e[i+Z]=255&k,Z+=Q,k/=256,f-=8);for(x=x<<f|k,A+=f;A>0;e[i+Z]=255&x,Z+=Q,x/=256,A-=8);e[i+Z-Q]|=128*ee},Rc=qr;function qr(e){this.buf=ArrayBuffer.isView&&ArrayBuffer.isView(e)?e:new Uint8Array(e||0),this.pos=0,this.type=0,this.length=this.buf.length}qr.Varint=0,qr.Fixed64=1,qr.Bytes=2,qr.Fixed32=5;var df=typeof TextDecoder>"u"?null:new TextDecoder("utf8");function Po(e){return e.type===qr.Bytes?e.readVarint()+e.pos:e.pos+1}function cl(e,t,i){return i?4294967296*t+(e>>>0):4294967296*(t>>>0)+(e>>>0)}function mf(e,t,i){var l=t<=16383?1:t<=2097151?2:t<=268435455?3:Math.floor(Math.log(t)/(7*Math.LN2));i.realloc(l);for(var f=i.pos-1;f>=e;f--)i.buf[f+l]=i.buf[f]}function pg(e,t){for(var i=0;i<e.length;i++)t.writeVarint(e[i])}function fg(e,t){for(var i=0;i<e.length;i++)t.writeSVarint(e[i])}function dg(e,t){for(var i=0;i<e.length;i++)t.writeFloat(e[i])}function mg(e,t){for(var i=0;i<e.length;i++)t.writeDouble(e[i])}function yg(e,t){for(var i=0;i<e.length;i++)t.writeBoolean(e[i])}function gg(e,t){for(var i=0;i<e.length;i++)t.writeFixed32(e[i])}function _g(e,t){for(var i=0;i<e.length;i++)t.writeSFixed32(e[i])}function vg(e,t){for(var i=0;i<e.length;i++)t.writeFixed64(e[i])}function bg(e,t){for(var i=0;i<e.length;i++)t.writeSFixed64(e[i])}function Bc(e,t){return(e[t]|e[t+1]<<8|e[t+2]<<16)+16777216*e[t+3]}function hl(e,t,i){e[i]=t,e[i+1]=t>>>8,e[i+2]=t>>>16,e[i+3]=t>>>24}function yf(e,t){return(e[t]|e[t+1]<<8|e[t+2]<<16)+(e[t+3]<<24)}function xg(e,t,i){e===1&&i.readMessage(wg,t)}function wg(e,t,i){if(e===3){var l=i.readMessage(Sg,{}),f=l.width,m=l.height,x=l.left,k=l.top,I=l.advance;t.push({id:l.id,bitmap:new As({width:f+6,height:m+6},l.bitmap),metrics:{width:f,height:m,left:x,top:k,advance:I}})}}function Sg(e,t,i){e===1?t.id=i.readVarint():e===2?t.bitmap=i.readBytes():e===3?t.width=i.readVarint():e===4?t.height=i.readVarint():e===5?t.left=i.readSVarint():e===6?t.top=i.readSVarint():e===7&&(t.advance=i.readVarint())}function gf(e){for(var t=0,i=0,l=0,f=e;l<f.length;l+=1){var m=f[l];t+=m.w*m.h,i=Math.max(i,m.w)}e.sort(function(ee,ce){return ce.h-ee.h});for(var x=[{x:0,y:0,w:Math.max(Math.ceil(Math.sqrt(t/.95)),i),h:1/0}],k=0,I=0,A=0,C=e;A<C.length;A+=1)for(var B=C[A],U=x.length-1;U>=0;U--){var Z=x[U];if(!(B.w>Z.w||B.h>Z.h)){if(B.x=Z.x,B.y=Z.y,I=Math.max(I,B.y+B.h),k=Math.max(k,B.x+B.w),B.w===Z.w&&B.h===Z.h){var Q=x.pop();U<x.length&&(x[U]=Q)}else B.h===Z.h?(Z.x+=B.w,Z.w-=B.w):B.w===Z.w?(Z.y+=B.h,Z.h-=B.h):(x.push({x:Z.x+B.w,y:Z.y,w:Z.w-B.w,h:B.h}),Z.y+=B.h,Z.h-=B.h);break}}return{w:k,h:I,fill:t/(k*I)||0}}qr.prototype={destroy:function(){this.buf=null},readFields:function(e,t,i){for(i=i||this.length;this.pos<i;){var l=this.readVarint(),f=l>>3,m=this.pos;this.type=7&l,e(f,t,this),this.pos===m&&this.skip(l)}return t},readMessage:function(e,t){return this.readFields(e,t,this.readVarint()+this.pos)},readFixed32:function(){var e=Bc(this.buf,this.pos);return this.pos+=4,e},readSFixed32:function(){var e=yf(this.buf,this.pos);return this.pos+=4,e},readFixed64:function(){var e=Bc(this.buf,this.pos)+4294967296*Bc(this.buf,this.pos+4);return this.pos+=8,e},readSFixed64:function(){var e=Bc(this.buf,this.pos)+4294967296*yf(this.buf,this.pos+4);return this.pos+=8,e},readFloat:function(){var e=pf(this.buf,this.pos,!0,23,4);return this.pos+=4,e},readDouble:function(){var e=pf(this.buf,this.pos,!0,52,8);return this.pos+=8,e},readVarint:function(e){var t,i,l=this.buf;return t=127&(i=l[this.pos++]),i<128?t:(t|=(127&(i=l[this.pos++]))<<7,i<128?t:(t|=(127&(i=l[this.pos++]))<<14,i<128?t:(t|=(127&(i=l[this.pos++]))<<21,i<128?t:function(f,m,x){var k,I,A=x.buf;if(k=(112&(I=A[x.pos++]))>>4,I<128||(k|=(127&(I=A[x.pos++]))<<3,I<128)||(k|=(127&(I=A[x.pos++]))<<10,I<128)||(k|=(127&(I=A[x.pos++]))<<17,I<128)||(k|=(127&(I=A[x.pos++]))<<24,I<128)||(k|=(1&(I=A[x.pos++]))<<31,I<128))return cl(f,k,m);throw new Error("Expected varint not more than 10 bytes")}(t|=(15&(i=l[this.pos]))<<28,e,this))))},readVarint64:function(){return this.readVarint(!0)},readSVarint:function(){var e=this.readVarint();return e%2==1?(e+1)/-2:e/2},readBoolean:function(){return!!this.readVarint()},readString:function(){var e=this.readVarint()+this.pos,t=this.pos;return this.pos=e,e-t>=12&&df?function(i,l,f){return df.decode(i.subarray(l,f))}(this.buf,t,e):function(i,l,f){for(var m="",x=l;x<f;){var k,I,A,C=i[x],B=null,U=C>239?4:C>223?3:C>191?2:1;if(x+U>f)break;U===1?C<128&&(B=C):U===2?(192&(k=i[x+1]))==128&&(B=(31&C)<<6|63&k)<=127&&(B=null):U===3?(I=i[x+2],(192&(k=i[x+1]))==128&&(192&I)==128&&((B=(15&C)<<12|(63&k)<<6|63&I)<=2047||B>=55296&&B<=57343)&&(B=null)):U===4&&(I=i[x+2],A=i[x+3],(192&(k=i[x+1]))==128&&(192&I)==128&&(192&A)==128&&((B=(15&C)<<18|(63&k)<<12|(63&I)<<6|63&A)<=65535||B>=1114112)&&(B=null)),B===null?(B=65533,U=1):B>65535&&(B-=65536,m+=String.fromCharCode(B>>>10&1023|55296),B=56320|1023&B),m+=String.fromCharCode(B),x+=U}return m}(this.buf,t,e)},readBytes:function(){var e=this.readVarint()+this.pos,t=this.buf.subarray(this.pos,e);return this.pos=e,t},readPackedVarint:function(e,t){if(this.type!==qr.Bytes)return e.push(this.readVarint(t));var i=Po(this);for(e=e||[];this.pos<i;)e.push(this.readVarint(t));return e},readPackedSVarint:function(e){if(this.type!==qr.Bytes)return e.push(this.readSVarint());var t=Po(this);for(e=e||[];this.pos<t;)e.push(this.readSVarint());return e},readPackedBoolean:function(e){if(this.type!==qr.Bytes)return e.push(this.readBoolean());var t=Po(this);for(e=e||[];this.pos<t;)e.push(this.readBoolean());return e},readPackedFloat:function(e){if(this.type!==qr.Bytes)return e.push(this.readFloat());var t=Po(this);for(e=e||[];this.pos<t;)e.push(this.readFloat());return e},readPackedDouble:function(e){if(this.type!==qr.Bytes)return e.push(this.readDouble());var t=Po(this);for(e=e||[];this.pos<t;)e.push(this.readDouble());return e},readPackedFixed32:function(e){if(this.type!==qr.Bytes)return e.push(this.readFixed32());var t=Po(this);for(e=e||[];this.pos<t;)e.push(this.readFixed32());return e},readPackedSFixed32:function(e){if(this.type!==qr.Bytes)return e.push(this.readSFixed32());var t=Po(this);for(e=e||[];this.pos<t;)e.push(this.readSFixed32());return e},readPackedFixed64:function(e){if(this.type!==qr.Bytes)return e.push(this.readFixed64());var t=Po(this);for(e=e||[];this.pos<t;)e.push(this.readFixed64());return e},readPackedSFixed64:function(e){if(this.type!==qr.Bytes)return e.push(this.readSFixed64());var t=Po(this);for(e=e||[];this.pos<t;)e.push(this.readSFixed64());return e},skip:function(e){var t=7&e;if(t===qr.Varint)for(;this.buf[this.pos++]>127;);else if(t===qr.Bytes)this.pos=this.readVarint()+this.pos;else if(t===qr.Fixed32)this.pos+=4;else{if(t!==qr.Fixed64)throw new Error("Unimplemented type: "+t);this.pos+=8}},writeTag:function(e,t){this.writeVarint(e<<3|t)},realloc:function(e){for(var t=this.length||16;t<this.pos+e;)t*=2;if(t!==this.length){var i=new Uint8Array(t);i.set(this.buf),this.buf=i,this.length=t}},finish:function(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)},writeFixed32:function(e){this.realloc(4),hl(this.buf,e,this.pos),this.pos+=4},writeSFixed32:function(e){this.realloc(4),hl(this.buf,e,this.pos),this.pos+=4},writeFixed64:function(e){this.realloc(8),hl(this.buf,-1&e,this.pos),hl(this.buf,Math.floor(e*(1/4294967296)),this.pos+4),this.pos+=8},writeSFixed64:function(e){this.realloc(8),hl(this.buf,-1&e,this.pos),hl(this.buf,Math.floor(e*(1/4294967296)),this.pos+4),this.pos+=8},writeVarint:function(e){(e=+e||0)>268435455||e<0?function(t,i){var l,f;if(t>=0?(l=t%4294967296|0,f=t/4294967296|0):(f=~(-t/4294967296),4294967295^(l=~(-t%4294967296))?l=l+1|0:(l=0,f=f+1|0)),t>=18446744073709552e3||t<-18446744073709552e3)throw new Error("Given varint doesn't fit into 10 bytes");i.realloc(10),function(m,x,k){k.buf[k.pos++]=127&m|128,m>>>=7,k.buf[k.pos++]=127&m|128,m>>>=7,k.buf[k.pos++]=127&m|128,m>>>=7,k.buf[k.pos++]=127&m|128,k.buf[k.pos]=127&(m>>>=7)}(l,0,i),function(m,x){var k=(7&m)<<4;x.buf[x.pos++]|=k|((m>>>=3)?128:0),m&&(x.buf[x.pos++]=127&m|((m>>>=7)?128:0),m&&(x.buf[x.pos++]=127&m|((m>>>=7)?128:0),m&&(x.buf[x.pos++]=127&m|((m>>>=7)?128:0),m&&(x.buf[x.pos++]=127&m|((m>>>=7)?128:0),m&&(x.buf[x.pos++]=127&m)))))}(f,i)}(e,this):(this.realloc(4),this.buf[this.pos++]=127&e|(e>127?128:0),e<=127||(this.buf[this.pos++]=127&(e>>>=7)|(e>127?128:0),e<=127||(this.buf[this.pos++]=127&(e>>>=7)|(e>127?128:0),e<=127||(this.buf[this.pos++]=e>>>7&127))))},writeSVarint:function(e){this.writeVarint(e<0?2*-e-1:2*e)},writeBoolean:function(e){this.writeVarint(!!e)},writeString:function(e){e=String(e),this.realloc(4*e.length),this.pos++;var t=this.pos;this.pos=function(l,f,m){for(var x,k,I=0;I<f.length;I++){if((x=f.charCodeAt(I))>55295&&x<57344){if(!k){x>56319||I+1===f.length?(l[m++]=239,l[m++]=191,l[m++]=189):k=x;continue}if(x<56320){l[m++]=239,l[m++]=191,l[m++]=189,k=x;continue}x=k-55296<<10|x-56320|65536,k=null}else k&&(l[m++]=239,l[m++]=191,l[m++]=189,k=null);x<128?l[m++]=x:(x<2048?l[m++]=x>>6|192:(x<65536?l[m++]=x>>12|224:(l[m++]=x>>18|240,l[m++]=x>>12&63|128),l[m++]=x>>6&63|128),l[m++]=63&x|128)}return m}(this.buf,e,this.pos);var i=this.pos-t;i>=128&&mf(t,i,this),this.pos=t-1,this.writeVarint(i),this.pos+=i},writeFloat:function(e){this.realloc(4),ff(this.buf,e,this.pos,!0,23,4),this.pos+=4},writeDouble:function(e){this.realloc(8),ff(this.buf,e,this.pos,!0,52,8),this.pos+=8},writeBytes:function(e){var t=e.length;this.writeVarint(t),this.realloc(t);for(var i=0;i<t;i++)this.buf[this.pos++]=e[i]},writeRawMessage:function(e,t){this.pos++;var i=this.pos;e(t,this);var l=this.pos-i;l>=128&&mf(i,l,this),this.pos=i-1,this.writeVarint(l),this.pos+=l},writeMessage:function(e,t,i){this.writeTag(e,qr.Bytes),this.writeRawMessage(t,i)},writePackedVarint:function(e,t){t.length&&this.writeMessage(e,pg,t)},writePackedSVarint:function(e,t){t.length&&this.writeMessage(e,fg,t)},writePackedBoolean:function(e,t){t.length&&this.writeMessage(e,yg,t)},writePackedFloat:function(e,t){t.length&&this.writeMessage(e,dg,t)},writePackedDouble:function(e,t){t.length&&this.writeMessage(e,mg,t)},writePackedFixed32:function(e,t){t.length&&this.writeMessage(e,gg,t)},writePackedSFixed32:function(e,t){t.length&&this.writeMessage(e,_g,t)},writePackedFixed64:function(e,t){t.length&&this.writeMessage(e,vg,t)},writePackedSFixed64:function(e,t){t.length&&this.writeMessage(e,bg,t)},writeBytesField:function(e,t){this.writeTag(e,qr.Bytes),this.writeBytes(t)},writeFixed32Field:function(e,t){this.writeTag(e,qr.Fixed32),this.writeFixed32(t)},writeSFixed32Field:function(e,t){this.writeTag(e,qr.Fixed32),this.writeSFixed32(t)},writeFixed64Field:function(e,t){this.writeTag(e,qr.Fixed64),this.writeFixed64(t)},writeSFixed64Field:function(e,t){this.writeTag(e,qr.Fixed64),this.writeSFixed64(t)},writeVarintField:function(e,t){this.writeTag(e,qr.Varint),this.writeVarint(t)},writeSVarintField:function(e,t){this.writeTag(e,qr.Varint),this.writeSVarint(t)},writeStringField:function(e,t){this.writeTag(e,qr.Bytes),this.writeString(t)},writeFloatField:function(e,t){this.writeTag(e,qr.Fixed32),this.writeFloat(t)},writeDoubleField:function(e,t){this.writeTag(e,qr.Fixed64),this.writeDouble(t)},writeBooleanField:function(e,t){this.writeVarintField(e,!!t)}};var Oc=function(e,t){var i=t.pixelRatio,l=t.version,f=t.stretchX,m=t.stretchY,x=t.content;this.paddedRect=e,this.pixelRatio=i,this.stretchX=f,this.stretchY=m,this.content=x,this.version=l},gu={tl:{configurable:!0},br:{configurable:!0},tlbr:{configurable:!0},displaySize:{configurable:!0}};gu.tl.get=function(){return[this.paddedRect.x+1,this.paddedRect.y+1]},gu.br.get=function(){return[this.paddedRect.x+this.paddedRect.w-1,this.paddedRect.y+this.paddedRect.h-1]},gu.tlbr.get=function(){return this.tl.concat(this.br)},gu.displaySize.get=function(){return[(this.paddedRect.w-2)/this.pixelRatio,(this.paddedRect.h-2)/this.pixelRatio]},Object.defineProperties(Oc.prototype,gu);var _u=function(e,t){var i={},l={};this.haveRenderCallbacks=[];var f=[];this.addImages(e,i,f),this.addImages(t,l,f);var m=gf(f),x=new Hn({width:m.w||1,height:m.h||1});for(var k in e){var I=e[k],A=i[k].paddedRect;Hn.copy(I.data,x,{x:0,y:0},{x:A.x+1,y:A.y+1},I.data)}for(var C in t){var B=t[C],U=l[C].paddedRect,Z=U.x+1,Q=U.y+1,ee=B.data.width,ce=B.data.height;Hn.copy(B.data,x,{x:0,y:0},{x:Z,y:Q},B.data),Hn.copy(B.data,x,{x:0,y:ce-1},{x:Z,y:Q-1},{width:ee,height:1}),Hn.copy(B.data,x,{x:0,y:0},{x:Z,y:Q+ce},{width:ee,height:1}),Hn.copy(B.data,x,{x:ee-1,y:0},{x:Z-1,y:Q},{width:1,height:ce}),Hn.copy(B.data,x,{x:0,y:0},{x:Z+ee,y:Q},{width:1,height:ce})}this.image=x,this.iconPositions=i,this.patternPositions=l};_u.prototype.addImages=function(e,t,i){for(var l in e){var f=e[l],m={x:0,y:0,w:f.data.width+2,h:f.data.height+2};i.push(m),t[l]=new Oc(m,f),f.hasRenderCallback&&this.haveRenderCallbacks.push(l)}},_u.prototype.patchUpdatedImages=function(e,t){for(var i in e.dispatchRenderCallbacks(this.haveRenderCallbacks),e.updatedImages)this.patchUpdatedImage(this.iconPositions[i],e.getImage(i),t),this.patchUpdatedImage(this.patternPositions[i],e.getImage(i),t)},_u.prototype.patchUpdatedImage=function(e,t,i){if(e&&t&&e.version!==t.version){e.version=t.version;var l=e.tl;i.update(t.data,void 0,{x:l[0],y:l[1]})}},ut("ImagePosition",Oc),ut("ImageAtlas",_u);var la={horizontal:1,vertical:2,horizontalOnly:3},pl=function(){this.scale=1,this.fontStack="",this.imageName=null};pl.forText=function(e,t){var i=new pl;return i.scale=e||1,i.fontStack=t,i},pl.forImage=function(e){var t=new pl;return t.imageName=e,t};var En=function(){this.text="",this.sectionIndex=[],this.sections=[],this.imageSectionID=null};function Fc(e,t,i,l,f,m,x,k,I,A,C,B,U,Z,Q,ee){var ce,ne=En.fromFeature(e,f);B===la.vertical&&ne.verticalizePunctuation();var me=ta.processBidirectionalText,be=ta.processStyledBidirectionalText;if(me&&ne.sections.length===1){ce=[];for(var Se=0,ze=me(ne.toString(),op(ne,A,m,t,l,Z,Q));Se<ze.length;Se+=1){var Pe=ze[Se],Ve=new En;Ve.text=Pe,Ve.sections=ne.sections;for(var Ye=0;Ye<Pe.length;Ye++)Ve.sectionIndex.push(0);ce.push(Ve)}}else if(be){ce=[];for(var vt=0,it=be(ne.text,ne.sectionIndex,op(ne,A,m,t,l,Z,Q));vt<it.length;vt+=1){var St=it[vt],nt=new En;nt.text=St[0],nt.sectionIndex=St[1],nt.sections=ne.sections,ce.push(nt)}}else ce=function(dt,or){for(var Kt=[],gr=dt.text,kt=0,Sr=0,Qr=or;Sr<Qr.length;Sr+=1){var ci=Qr[Sr];Kt.push(dt.substring(kt,ci)),kt=ci}return kt<gr.length&&Kt.push(dt.substring(kt,gr.length)),Kt}(ne,op(ne,A,m,t,l,Z,Q));var Qt=[],Rt={positionedLines:Qt,text:ne.toString(),top:C[1],bottom:C[1],left:C[0],right:C[0],writingMode:B,iconsInText:!1,verticalizable:!1};return function(dt,or,Kt,gr,kt,Sr,Qr,ci,ai,$r,hi,Bi){for(var Oi=0,Tn=-17,Hi=0,zn=0,yi=ci==="right"?1:ci==="left"?0:.5,Ji=0,pr=0,Fr=kt;pr<Fr.length;pr+=1){var Dr=Fr[pr];Dr.trim();var vr=Dr.getMaxScale(),Bn=24*(vr-1),fn={positionedGlyphs:[],lineOffset:0};dt.positionedLines[Ji]=fn;var Hr=fn.positionedGlyphs,Si=0;if(Dr.length()){for(var dn=0;dn<Dr.length();dn++){var kr=Dr.getSection(dn),ro=Dr.getSectionIndex(dn),ua=Dr.getCharCode(dn),io=0,gi=null,no=null,Pa=null,bl=24,Ds=!(ai===la.horizontal||!hi&&!Ys(ua)||hi&&(Nc[ua]||(Lo=ua,et.Arabic(Lo)||et["Arabic Supplement"](Lo)||et["Arabic Extended-A"](Lo)||et["Arabic Presentation Forms-A"](Lo)||et["Arabic Presentation Forms-B"](Lo))));if(kr.imageName){var xl=gr[kr.imageName];if(!xl)continue;Pa=kr.imageName,dt.iconsInText=dt.iconsInText||!0,no=xl.paddedRect;var Do=xl.displaySize;kr.scale=24*kr.scale/Bi,io=Bn+(24-Do[1]*kr.scale),bl=(gi={width:Do[0],height:Do[1],left:1,top:-3,advance:Ds?Do[1]:Do[0]}).advance;var wl=Ds?Do[0]*kr.scale-24*vr:Do[1]*kr.scale-24*vr;wl>0&&wl>Si&&(Si=wl)}else{var Wc=Kt[kr.fontStack],Sl=Wc&&Wc[ua];if(Sl&&Sl.rect)no=Sl.rect,gi=Sl.metrics;else{var xu=or[kr.fontStack],Hc=xu&&xu[ua];if(!Hc)continue;gi=Hc.metrics}io=24*(vr-kr.scale)}Ds?(dt.verticalizable=!0,Hr.push({glyph:ua,imageName:Pa,x:Oi,y:Tn+io,vertical:Ds,scale:kr.scale,fontStack:kr.fontStack,sectionIndex:ro,metrics:gi,rect:no}),Oi+=bl*kr.scale+$r):(Hr.push({glyph:ua,imageName:Pa,x:Oi,y:Tn+io,vertical:Ds,scale:kr.scale,fontStack:kr.fontStack,sectionIndex:ro,metrics:gi,rect:no}),Oi+=gi.advance*kr.scale+$r)}Hr.length!==0&&(Hi=Math.max(Oi-$r,Hi),Eg(Hr,0,Hr.length-1,yi,Si)),Oi=0;var Jc=Sr*vr+Si;fn.lineOffset=Math.max(Si,Bn),Tn+=Jc,zn=Math.max(Jc,zn),++Ji}else Tn+=Sr,++Ji}var Lo,wu=Tn- -17,kl=sp(Qr),$o=kl.horizontalAlign,El=kl.verticalAlign;(function(Yc,Qc,Su,ku,$c,Eu,Tu,zu,eh){var Tl,th=(Qc-Su)*$c;Tl=Eu!==Tu?-zu*ku- -17:(-ku*eh+.5)*Tu;for(var zl=0,Iu=Yc;zl<Iu.length;zl+=1)for(var Ls=0,Au=Iu[zl].positionedGlyphs;Ls<Au.length;Ls+=1){var Il=Au[Ls];Il.x+=th,Il.y+=Tl}})(dt.positionedLines,yi,$o,El,Hi,zn,Sr,wu,kt.length),dt.top+=-El*wu,dt.bottom=dt.top+wu,dt.left+=-$o*Hi,dt.right=dt.left+Hi}(Rt,t,i,l,ce,x,k,I,B,A,U,ee),!function(dt){for(var or=0,Kt=dt;or<Kt.length;or+=1)if(Kt[or].positionedGlyphs.length!==0)return!1;return!0}(Qt)&&Rt}En.fromFeature=function(e,t){for(var i=new En,l=0;l<e.sections.length;l++){var f=e.sections[l];f.image?i.addImageSection(f):i.addTextSection(f,t)}return i},En.prototype.length=function(){return this.text.length},En.prototype.getSection=function(e){return this.sections[this.sectionIndex[e]]},En.prototype.getSectionIndex=function(e){return this.sectionIndex[e]},En.prototype.getCharCode=function(e){return this.text.charCodeAt(e)},En.prototype.verticalizePunctuation=function(){this.text=function(e){for(var t="",i=0;i<e.length;i++){var l=e.charCodeAt(i+1)||null,f=e.charCodeAt(i-1)||null;t+=l&&tu(l)&&!yu[e[i+1]]||f&&tu(f)&&!yu[e[i-1]]||!yu[e[i]]?e[i]:yu[e[i]]}return t}(this.text)},En.prototype.trim=function(){for(var e=0,t=0;t<this.text.length&&Nc[this.text.charCodeAt(t)];t++)e++;for(var i=this.text.length,l=this.text.length-1;l>=0&&l>=e&&Nc[this.text.charCodeAt(l)];l--)i--;this.text=this.text.substring(e,i),this.sectionIndex=this.sectionIndex.slice(e,i)},En.prototype.substring=function(e,t){var i=new En;return i.text=this.text.substring(e,t),i.sectionIndex=this.sectionIndex.slice(e,t),i.sections=this.sections,i},En.prototype.toString=function(){return this.text},En.prototype.getMaxScale=function(){var e=this;return this.sectionIndex.reduce(function(t,i){return Math.max(t,e.sections[i].scale)},0)},En.prototype.addTextSection=function(e,t){this.text+=e.text,this.sections.push(pl.forText(e.scale,e.fontStack||t));for(var i=this.sections.length-1,l=0;l<e.text.length;++l)this.sectionIndex.push(i)},En.prototype.addImageSection=function(e){var t=e.image?e.image.name:"";if(t.length!==0){var i=this.getNextImageSectionCharCode();i?(this.text+=String.fromCharCode(i),this.sections.push(pl.forImage(t)),this.sectionIndex.push(this.sections.length-1)):bt("Reached maximum number of images 6401")}else bt("Can't add FormattedSection with an empty image.")},En.prototype.getNextImageSectionCharCode=function(){return this.imageSectionID?this.imageSectionID>=63743?null:++this.imageSectionID:(this.imageSectionID=57344,this.imageSectionID)};var Nc={9:!0,10:!0,11:!0,12:!0,13:!0,32:!0},ia={};function _f(e,t,i,l,f,m){if(t.imageName){var x=l[t.imageName];return x?x.displaySize[0]*t.scale*24/m+f:0}var k=i[t.fontStack],I=k&&k[e];return I?I.metrics.advance*t.scale+f:0}function vf(e,t,i,l){var f=Math.pow(e-t,2);return l?e<t?f/2:2*f:f+Math.abs(i)*i}function kg(e,t,i){var l=0;return e===10&&(l-=1e4),i&&(l+=150),e!==40&&e!==65288||(l+=50),t!==41&&t!==65289||(l+=50),l}function bf(e,t,i,l,f,m){for(var x=null,k=vf(t,i,f,m),I=0,A=l;I<A.length;I+=1){var C=A[I],B=vf(t-C.x,i,f,m)+C.badness;B<=k&&(x=C,k=B)}return{index:e,x:t,priorBreak:x,badness:k}}function op(e,t,i,l,f,m,x){if(m!=="point")return[];if(!e)return[];for(var k,I=[],A=function(ce,ne,me,be,Se,ze){for(var Pe=0,Ve=0;Ve<ce.length();Ve++){var Ye=ce.getSection(Ve);Pe+=_f(ce.getCharCode(Ve),Ye,be,Se,ne,ze)}return Pe/Math.max(1,Math.ceil(Pe/me))}(e,t,i,l,f,x),C=e.text.indexOf("​")>=0,B=0,U=0;U<e.length();U++){var Z=e.getSection(U),Q=e.getCharCode(U);if(Nc[Q]||(B+=_f(Q,Z,l,f,t,x)),U<e.length()-1){var ee=!((k=Q)<11904||!(et["Bopomofo Extended"](k)||et.Bopomofo(k)||et["CJK Compatibility Forms"](k)||et["CJK Compatibility Ideographs"](k)||et["CJK Compatibility"](k)||et["CJK Radicals Supplement"](k)||et["CJK Strokes"](k)||et["CJK Symbols and Punctuation"](k)||et["CJK Unified Ideographs Extension A"](k)||et["CJK Unified Ideographs"](k)||et["Enclosed CJK Letters and Months"](k)||et["Halfwidth and Fullwidth Forms"](k)||et.Hiragana(k)||et["Ideographic Description Characters"](k)||et["Kangxi Radicals"](k)||et["Katakana Phonetic Extensions"](k)||et.Katakana(k)||et["Vertical Forms"](k)||et["Yi Radicals"](k)||et["Yi Syllables"](k)));(ia[Q]||ee||Z.imageName)&&I.push(bf(U+1,B,A,I,kg(Q,e.getCharCode(U+1),ee&&C),!1))}}return function ce(ne){return ne?ce(ne.priorBreak).concat(ne.index):[]}(bf(e.length(),B,A,I,0,!0))}function sp(e){var t=.5,i=.5;switch(e){case"right":case"top-right":case"bottom-right":t=1;break;case"left":case"top-left":case"bottom-left":t=0}switch(e){case"bottom":case"bottom-right":case"bottom-left":i=1;break;case"top":case"top-right":case"top-left":i=0}return{horizontalAlign:t,verticalAlign:i}}function Eg(e,t,i,l,f){if(l||f)for(var m=e[i],x=(e[i].x+m.metrics.advance*m.scale)*l,k=t;k<=i;k++)e[k].x-=x,e[k].y+=f}function xf(e,t,i,l,f,m){var x,k=e.image;if(k.content){var I=k.content,A=k.pixelRatio||1;x=[I[0]/A,I[1]/A,k.displaySize[0]-I[2]/A,k.displaySize[1]-I[3]/A]}var C,B,U,Z,Q=t.left*m,ee=t.right*m;i==="width"||i==="both"?(Z=f[0]+Q-l[3],B=f[0]+ee+l[1]):B=(Z=f[0]+(Q+ee-k.displaySize[0])/2)+k.displaySize[0];var ce=t.top*m,ne=t.bottom*m;return i==="height"||i==="both"?(C=f[1]+ce-l[0],U=f[1]+ne+l[2]):U=(C=f[1]+(ce+ne-k.displaySize[1])/2)+k.displaySize[1],{image:k,top:C,right:B,bottom:U,left:Z,collisionPadding:x}}ia[10]=!0,ia[32]=!0,ia[38]=!0,ia[40]=!0,ia[41]=!0,ia[43]=!0,ia[45]=!0,ia[47]=!0,ia[173]=!0,ia[183]=!0,ia[8203]=!0,ia[8208]=!0,ia[8211]=!0,ia[8231]=!0;var fl=function(e){function t(i,l,f,m){e.call(this,i,l),this.angle=f,m!==void 0&&(this.segment=m)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.clone=function(){return new t(this.x,this.y,this.angle,this.segment)},t}(F);function lp(e,t){var i=t.expression;if(i.kind==="constant")return{kind:"constant",layoutSize:i.evaluate(new ur(e+1))};if(i.kind==="source")return{kind:"source"};for(var l=i.zoomStops,f=i.interpolationType,m=0;m<l.length&&l[m]<=e;)m++;for(var x=m=Math.max(0,m-1);x<l.length&&l[x]<e+1;)x++;x=Math.min(l.length-1,x);var k=l[m],I=l[x];return i.kind==="composite"?{kind:"composite",minZoom:k,maxZoom:I,interpolationType:f}:{kind:"camera",minZoom:k,maxZoom:I,minSize:i.evaluate(new ur(k)),maxSize:i.evaluate(new ur(I)),interpolationType:f}}function wf(e,t,i){var l=t.uSize,f=i.lowerSize;return e.kind==="source"?f/128:e.kind==="composite"?xi(f/128,i.upperSize/128,t.uSizeT):l}function Sf(e,t){var i=0,l=0;if(e.kind==="constant")l=e.layoutSize;else if(e.kind!=="source"){var f=e.interpolationType,m=f?fe(rn.interpolationFactor(f,t,e.minZoom,e.maxZoom),0,1):0;e.kind==="camera"?l=xi(e.minSize,e.maxSize,m):i=m}return{uSizeT:i,uSize:l}}ut("Anchor",fl);var Tg=Object.freeze({__proto__:null,getSizeData:lp,evaluateSizeForFeature:wf,evaluateSizeForZoom:Sf,SIZE_PACK_FACTOR:128});function kf(e,t,i,l,f){if(t.segment===void 0)return!0;for(var m=t,x=t.segment+1,k=0;k>-i/2;){if(--x<0)return!1;k-=e[x].dist(m),m=e[x]}k+=e[x].dist(e[x+1]),x++;for(var I=[],A=0;k<i/2;){var C=e[x],B=e[x+1];if(!B)return!1;var U=e[x-1].angleTo(C)-C.angleTo(B);for(U=Math.abs((U+3*Math.PI)%(2*Math.PI)-Math.PI),I.push({distance:k,angleDelta:U}),A+=U;k-I[0].distance>l;)A-=I.shift().angleDelta;if(A>f)return!1;x++,k+=C.dist(B)}return!0}function Ef(e){for(var t=0,i=0;i<e.length-1;i++)t+=e[i].dist(e[i+1]);return t}function Tf(e,t,i){return e?.6*t*i:0}function zf(e,t){return Math.max(e?e.right-e.left:0,t?t.right-t.left:0)}function zg(e,t,i,l,f,m){for(var x=Tf(i,f,m),k=zf(i,l)*m,I=0,A=Ef(e)/2,C=0;C<e.length-1;C++){var B=e[C],U=e[C+1],Z=B.dist(U);if(I+Z>A){var Q=(A-I)/Z,ee=xi(B.x,U.x,Q),ce=xi(B.y,U.y,Q),ne=new fl(ee,ce,U.angleTo(B),C);return ne._round(),!x||kf(e,ne,k,x,t)?ne:void 0}I+=Z}}function Ig(e,t,i,l,f,m,x,k,I){var A=Tf(l,m,x),C=zf(l,f),B=C*x,U=e[0].x===0||e[0].x===I||e[0].y===0||e[0].y===I;return t-B<t/4&&(t=B+t/4),function Z(Q,ee,ce,ne,me,be,Se,ze,Pe){for(var Ve=be/2,Ye=Ef(Q),vt=0,it=ee-ce,St=[],nt=0;nt<Q.length-1;nt++){for(var Qt=Q[nt],Rt=Q[nt+1],dt=Qt.dist(Rt),or=Rt.angleTo(Qt);it+ce<vt+dt;){var Kt=((it+=ce)-vt)/dt,gr=xi(Qt.x,Rt.x,Kt),kt=xi(Qt.y,Rt.y,Kt);if(gr>=0&&gr<Pe&&kt>=0&&kt<Pe&&it-Ve>=0&&it+Ve<=Ye){var Sr=new fl(gr,kt,or,nt);Sr._round(),ne&&!kf(Q,Sr,be,ne,me)||St.push(Sr)}}vt+=dt}return ze||St.length||Se||(St=Z(Q,vt/2,ce,ne,me,be,Se,!0,Pe)),St}(e,U?t/2*k%t:(C/2+2*m)*x*k%t,t,A,i,B,U,!1,I)}function If(e,t,i,l,f){for(var m=[],x=0;x<e.length;x++)for(var k=e[x],I=void 0,A=0;A<k.length-1;A++){var C=k[A],B=k[A+1];C.x<t&&B.x<t||(C.x<t?C=new F(t,C.y+(t-C.x)/(B.x-C.x)*(B.y-C.y))._round():B.x<t&&(B=new F(t,C.y+(t-C.x)/(B.x-C.x)*(B.y-C.y))._round()),C.y<i&&B.y<i||(C.y<i?C=new F(C.x+(i-C.y)/(B.y-C.y)*(B.x-C.x),i)._round():B.y<i&&(B=new F(C.x+(i-C.y)/(B.y-C.y)*(B.x-C.x),i)._round()),C.x>=l&&B.x>=l||(C.x>=l?C=new F(l,C.y+(l-C.x)/(B.x-C.x)*(B.y-C.y))._round():B.x>=l&&(B=new F(l,C.y+(l-C.x)/(B.x-C.x)*(B.y-C.y))._round()),C.y>=f&&B.y>=f||(C.y>=f?C=new F(C.x+(f-C.y)/(B.y-C.y)*(B.x-C.x),f)._round():B.y>=f&&(B=new F(C.x+(f-C.y)/(B.y-C.y)*(B.x-C.x),f)._round()),I&&C.equals(I[I.length-1])||m.push(I=[C]),I.push(B)))))}return m}function Af(e,t,i,l){var f=[],m=e.image,x=m.pixelRatio,k=m.paddedRect.w-2,I=m.paddedRect.h-2,A=e.right-e.left,C=e.bottom-e.top,B=m.stretchX||[[0,k]],U=m.stretchY||[[0,I]],Z=function(gr,kt){return gr+kt[1]-kt[0]},Q=B.reduce(Z,0),ee=U.reduce(Z,0),ce=k-Q,ne=I-ee,me=0,be=Q,Se=0,ze=ee,Pe=0,Ve=ce,Ye=0,vt=ne;if(m.content&&l){var it=m.content;me=Uc(B,0,it[0]),Se=Uc(U,0,it[1]),be=Uc(B,it[0],it[2]),ze=Uc(U,it[1],it[3]),Pe=it[0]-me,Ye=it[1]-Se,Ve=it[2]-it[0]-be,vt=it[3]-it[1]-ze}var St=function(gr,kt,Sr,Qr){var ci=Vc(gr.stretch-me,be,A,e.left),ai=jc(gr.fixed-Pe,Ve,gr.stretch,Q),$r=Vc(kt.stretch-Se,ze,C,e.top),hi=jc(kt.fixed-Ye,vt,kt.stretch,ee),Bi=Vc(Sr.stretch-me,be,A,e.left),Oi=jc(Sr.fixed-Pe,Ve,Sr.stretch,Q),Tn=Vc(Qr.stretch-Se,ze,C,e.top),Hi=jc(Qr.fixed-Ye,vt,Qr.stretch,ee),zn=new F(ci,$r),yi=new F(Bi,$r),Ji=new F(Bi,Tn),pr=new F(ci,Tn),Fr=new F(ai/x,hi/x),Dr=new F(Oi/x,Hi/x),vr=t*Math.PI/180;if(vr){var Bn=Math.sin(vr),fn=Math.cos(vr),Hr=[fn,-Bn,Bn,fn];zn._matMult(Hr),yi._matMult(Hr),pr._matMult(Hr),Ji._matMult(Hr)}var Si=gr.stretch+gr.fixed,dn=kt.stretch+kt.fixed;return{tl:zn,tr:yi,bl:pr,br:Ji,tex:{x:m.paddedRect.x+1+Si,y:m.paddedRect.y+1+dn,w:Sr.stretch+Sr.fixed-Si,h:Qr.stretch+Qr.fixed-dn},writingMode:void 0,glyphOffset:[0,0],sectionIndex:0,pixelOffsetTL:Fr,pixelOffsetBR:Dr,minFontScaleX:Ve/x/A,minFontScaleY:vt/x/C,isSDF:i}};if(l&&(m.stretchX||m.stretchY))for(var nt=Pf(B,ce,Q),Qt=Pf(U,ne,ee),Rt=0;Rt<nt.length-1;Rt++)for(var dt=nt[Rt],or=nt[Rt+1],Kt=0;Kt<Qt.length-1;Kt++)f.push(St(dt,Qt[Kt],or,Qt[Kt+1]));else f.push(St({fixed:0,stretch:-1},{fixed:0,stretch:-1},{fixed:0,stretch:k+1},{fixed:0,stretch:I+1}));return f}function Uc(e,t,i){for(var l=0,f=0,m=e;f<m.length;f+=1){var x=m[f];l+=Math.max(t,Math.min(i,x[1]))-Math.max(t,Math.min(i,x[0]))}return l}function Pf(e,t,i){for(var l=[{fixed:-1,stretch:0}],f=0,m=e;f<m.length;f+=1){var x=m[f],k=x[0],I=x[1],A=l[l.length-1];l.push({fixed:k-A.stretch,stretch:A.stretch}),l.push({fixed:k-A.stretch,stretch:A.stretch+(I-k)})}return l.push({fixed:t+1,stretch:i}),l}function Vc(e,t,i,l){return e/t*i+l}function jc(e,t,i,l){return e-t*i/l}var qc=function(e,t,i,l,f,m,x,k,I,A){if(this.boxStartIndex=e.length,I){var C=m.top,B=m.bottom,U=m.collisionPadding;U&&(C-=U[1],B+=U[3]);var Z=B-C;Z>0&&(Z=Math.max(10,Z),this.circleDiameter=Z)}else{var Q=m.top*x-k,ee=m.bottom*x+k,ce=m.left*x-k,ne=m.right*x+k,me=m.collisionPadding;if(me&&(ce-=me[0]*x,Q-=me[1]*x,ne+=me[2]*x,ee+=me[3]*x),A){var be=new F(ce,Q),Se=new F(ne,Q),ze=new F(ce,ee),Pe=new F(ne,ee),Ve=A*Math.PI/180;be._rotate(Ve),Se._rotate(Ve),ze._rotate(Ve),Pe._rotate(Ve),ce=Math.min(be.x,Se.x,ze.x,Pe.x),ne=Math.max(be.x,Se.x,ze.x,Pe.x),Q=Math.min(be.y,Se.y,ze.y,Pe.y),ee=Math.max(be.y,Se.y,ze.y,Pe.y)}e.emplaceBack(t.x,t.y,ce,Q,ne,ee,i,l,f)}this.boxEndIndex=e.length},dl=function(e,t){if(e===void 0&&(e=[]),t===void 0&&(t=Ag),this.data=e,this.length=this.data.length,this.compare=t,this.length>0)for(var i=(this.length>>1)-1;i>=0;i--)this._down(i)};function Ag(e,t){return e<t?-1:e>t?1:0}function Pg(e,t,i){t===void 0&&(t=1),i===void 0&&(i=!1);for(var l=1/0,f=1/0,m=-1/0,x=-1/0,k=e[0],I=0;I<k.length;I++){var A=k[I];(!I||A.x<l)&&(l=A.x),(!I||A.y<f)&&(f=A.y),(!I||A.x>m)&&(m=A.x),(!I||A.y>x)&&(x=A.y)}var C=Math.min(m-l,x-f),B=C/2,U=new dl([],Cg);if(C===0)return new F(l,f);for(var Z=l;Z<m;Z+=C)for(var Q=f;Q<x;Q+=C)U.push(new ml(Z+B,Q+B,B,e));for(var ee=function(me){for(var be=0,Se=0,ze=0,Pe=me[0],Ve=0,Ye=Pe.length,vt=Ye-1;Ve<Ye;vt=Ve++){var it=Pe[Ve],St=Pe[vt],nt=it.x*St.y-St.x*it.y;Se+=(it.x+St.x)*nt,ze+=(it.y+St.y)*nt,be+=3*nt}return new ml(Se/be,ze/be,0,me)}(e),ce=U.length;U.length;){var ne=U.pop();(ne.d>ee.d||!ee.d)&&(ee=ne,i&&console.log("found best %d after %d probes",Math.round(1e4*ne.d)/1e4,ce)),ne.max-ee.d<=t||(U.push(new ml(ne.p.x-(B=ne.h/2),ne.p.y-B,B,e)),U.push(new ml(ne.p.x+B,ne.p.y-B,B,e)),U.push(new ml(ne.p.x-B,ne.p.y+B,B,e)),U.push(new ml(ne.p.x+B,ne.p.y+B,B,e)),ce+=4)}return i&&(console.log("num probes: "+ce),console.log("best distance: "+ee.d)),ee.p}function Cg(e,t){return t.max-e.max}function ml(e,t,i,l){this.p=new F(e,t),this.h=i,this.d=function(f,m){for(var x=!1,k=1/0,I=0;I<m.length;I++)for(var A=m[I],C=0,B=A.length,U=B-1;C<B;U=C++){var Z=A[C],Q=A[U];Z.y>f.y!=Q.y>f.y&&f.x<(Q.x-Z.x)*(f.y-Z.y)/(Q.y-Z.y)+Z.x&&(x=!x),k=Math.min(k,Ho(f,Z,Q))}return(x?1:-1)*Math.sqrt(k)}(this.p,l),this.max=this.d+this.h*Math.SQRT2}dl.prototype.push=function(e){this.data.push(e),this.length++,this._up(this.length-1)},dl.prototype.pop=function(){if(this.length!==0){var e=this.data[0],t=this.data.pop();return this.length--,this.length>0&&(this.data[0]=t,this._down(0)),e}},dl.prototype.peek=function(){return this.data[0]},dl.prototype._up=function(e){for(var t=this.data,i=this.compare,l=t[e];e>0;){var f=e-1>>1,m=t[f];if(i(l,m)>=0)break;t[e]=m,e=f}t[e]=l},dl.prototype._down=function(e){for(var t=this.data,i=this.compare,l=this.length>>1,f=t[e];e<l;){var m=1+(e<<1),x=t[m],k=m+1;if(k<this.length&&i(t[k],x)<0&&(m=k,x=t[k]),i(x,f)>=0)break;t[e]=x,e=m}t[e]=f};var up=Number.POSITIVE_INFINITY;function Cf(e,t){return t[1]!==up?function(i,l,f){var m=0,x=0;switch(l=Math.abs(l),f=Math.abs(f),i){case"top-right":case"top-left":case"top":x=f-7;break;case"bottom-right":case"bottom-left":case"bottom":x=7-f}switch(i){case"top-right":case"bottom-right":case"right":m=-l;break;case"top-left":case"bottom-left":case"left":m=l}return[m,x]}(e,t[0],t[1]):function(i,l){var f=0,m=0;l<0&&(l=0);var x=l/Math.sqrt(2);switch(i){case"top-right":case"top-left":m=x-7;break;case"bottom-right":case"bottom-left":m=7-x;break;case"bottom":m=7-l;break;case"top":m=l-7}switch(i){case"top-right":case"bottom-right":f=-x;break;case"top-left":case"bottom-left":f=x;break;case"left":f=l;break;case"right":f=-l}return[f,m]}(e,t[0])}function cp(e){switch(e){case"right":case"top-right":case"bottom-right":return"right";case"left":case"top-left":case"bottom-left":return"left"}return"center"}function Mf(e,t,i,l,f,m,x,k,I,A,C,B,U,Z,Q){var ee=function(Se,ze,Pe,Ve,Ye,vt,it,St){for(var nt=Ve.layout.get("text-rotate").evaluate(vt,{})*Math.PI/180,Qt=[],Rt=0,dt=ze.positionedLines;Rt<dt.length;Rt+=1)for(var or=dt[Rt],Kt=0,gr=or.positionedGlyphs;Kt<gr.length;Kt+=1){var kt=gr[Kt];if(kt.rect){var Sr=kt.rect||{},Qr=4,ci=!0,ai=1,$r=0,hi=(Ye||St)&&kt.vertical,Bi=kt.metrics.advance*kt.scale/2;if(St&&ze.verticalizable&&($r=or.lineOffset/2-(kt.imageName?-(24-kt.metrics.width*kt.scale)/2:24*(kt.scale-1))),kt.imageName){var Oi=it[kt.imageName];ci=Oi.sdf,Qr=1/(ai=Oi.pixelRatio)}var Tn=Ye?[kt.x+Bi,kt.y]:[0,0],Hi=Ye?[0,0]:[kt.x+Bi+Pe[0],kt.y+Pe[1]-$r],zn=[0,0];hi&&(zn=Hi,Hi=[0,0]);var yi=(kt.metrics.left-Qr)*kt.scale-Bi+Hi[0],Ji=(-kt.metrics.top-Qr)*kt.scale+Hi[1],pr=yi+Sr.w*kt.scale/ai,Fr=Ji+Sr.h*kt.scale/ai,Dr=new F(yi,Ji),vr=new F(pr,Ji),Bn=new F(yi,Fr),fn=new F(pr,Fr);if(hi){var Hr=new F(-Bi,Bi- -17),Si=-Math.PI/2,dn=12-Bi,kr=new F(22-dn,-(kt.imageName?dn:0)),ro=new(Function.prototype.bind.apply(F,[null].concat(zn)));Dr._rotateAround(Si,Hr)._add(kr)._add(ro),vr._rotateAround(Si,Hr)._add(kr)._add(ro),Bn._rotateAround(Si,Hr)._add(kr)._add(ro),fn._rotateAround(Si,Hr)._add(kr)._add(ro)}if(nt){var ua=Math.sin(nt),io=Math.cos(nt),gi=[io,-ua,ua,io];Dr._matMult(gi),vr._matMult(gi),Bn._matMult(gi),fn._matMult(gi)}var no=new F(0,0),Pa=new F(0,0);Qt.push({tl:Dr,tr:vr,bl:Bn,br:fn,tex:Sr,writingMode:ze.writingMode,glyphOffset:Tn,sectionIndex:kt.sectionIndex,isSDF:ci,pixelOffsetTL:no,pixelOffsetBR:Pa,minFontScaleX:0,minFontScaleY:0})}}return Qt}(0,i,k,f,m,x,l,e.allowVerticalPlacement),ce=e.textSizeData,ne=null;ce.kind==="source"?(ne=[128*f.layout.get("text-size").evaluate(x,{})])[0]>32640&&bt(e.layerIds[0]+': Value for "text-size" is >= 255. Reduce your "text-size".'):ce.kind==="composite"&&((ne=[128*Z.compositeTextSizes[0].evaluate(x,{},Q),128*Z.compositeTextSizes[1].evaluate(x,{},Q)])[0]>32640||ne[1]>32640)&&bt(e.layerIds[0]+': Value for "text-size" is >= 255. Reduce your "text-size".'),e.addSymbols(e.text,ee,ne,k,m,x,A,t,I.lineStartIndex,I.lineLength,U,Q);for(var me=0,be=C;me<be.length;me+=1)B[be[me]]=e.text.placedSymbolArray.length-1;return 4*ee.length}function Df(e){for(var t in e)return e[t];return null}function Mg(e,t,i,l){var f=e.compareText;if(t in f){for(var m=f[t],x=m.length-1;x>=0;x--)if(l.dist(m[x])<i)return!0}else f[t]=[];return f[t].push(l),!1}var Dg=ul.VectorTileFeature.types,Lg=[{name:"a_fade_opacity",components:1,type:"Uint8",offset:0}];function Zc(e,t,i,l,f,m,x,k,I,A,C,B,U){var Z=k?Math.min(32640,Math.round(k[0])):0,Q=k?Math.min(32640,Math.round(k[1])):0;e.emplaceBack(t,i,Math.round(32*l),Math.round(32*f),m,x,(Z<<1)+(I?1:0),Q,16*A,16*C,256*B,256*U)}function hp(e,t,i){e.emplaceBack(t.x,t.y,i),e.emplaceBack(t.x,t.y,i),e.emplaceBack(t.x,t.y,i),e.emplaceBack(t.x,t.y,i)}function Rg(e){for(var t=0,i=e.sections;t<i.length;t+=1)if(Qs(i[t].text))return!0;return!1}var yl=function(e){this.layoutVertexArray=new rl,this.indexArray=new Ja,this.programConfigurations=e,this.segments=new K,this.dynamicLayoutVertexArray=new Ko,this.opacityVertexArray=new Ss,this.placedSymbolArray=new c};yl.prototype.isEmpty=function(){return this.layoutVertexArray.length===0&&this.indexArray.length===0&&this.dynamicLayoutVertexArray.length===0&&this.opacityVertexArray.length===0},yl.prototype.upload=function(e,t,i,l){this.isEmpty()||(i&&(this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,sg.members),this.indexBuffer=e.createIndexBuffer(this.indexArray,t),this.dynamicLayoutVertexBuffer=e.createVertexBuffer(this.dynamicLayoutVertexArray,lg.members,!0),this.opacityVertexBuffer=e.createVertexBuffer(this.opacityVertexArray,Lg,!0),this.opacityVertexBuffer.itemSize=1),(i||l)&&this.programConfigurations.upload(e))},yl.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.dynamicLayoutVertexBuffer.destroy(),this.opacityVertexBuffer.destroy())},ut("SymbolBuffers",yl);var vu=function(e,t,i){this.layoutVertexArray=new e,this.layoutAttributes=t,this.indexArray=new i,this.segments=new K,this.collisionVertexArray=new su};vu.prototype.upload=function(e){this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,this.layoutAttributes),this.indexBuffer=e.createIndexBuffer(this.indexArray),this.collisionVertexBuffer=e.createVertexBuffer(this.collisionVertexArray,ug.members,!0)},vu.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.collisionVertexBuffer.destroy())},ut("CollisionBuffers",vu);var Br=function(e){this.collisionBoxArray=e.collisionBoxArray,this.zoom=e.zoom,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map(function(m){return m.id}),this.index=e.index,this.pixelRatio=e.pixelRatio,this.sourceLayerIndex=e.sourceLayerIndex,this.hasPattern=!1,this.hasRTLText=!1,this.sortKeyRanges=[],this.collisionCircleArray=[],this.placementInvProjMatrix=ra([]),this.placementViewportMatrix=ra([]);var t=this.layers[0]._unevaluatedLayout._values;this.textSizeData=lp(this.zoom,t["text-size"]),this.iconSizeData=lp(this.zoom,t["icon-size"]);var i=this.layers[0].layout,l=i.get("symbol-sort-key"),f=i.get("symbol-z-order");this.canOverlap=i.get("text-allow-overlap")||i.get("icon-allow-overlap")||i.get("text-ignore-placement")||i.get("icon-ignore-placement"),this.sortFeaturesByKey=f!=="viewport-y"&&l.constantOr(1)!==void 0,this.sortFeaturesByY=(f==="viewport-y"||f==="auto"&&!this.sortFeaturesByKey)&&this.canOverlap,i.get("symbol-placement")==="point"&&(this.writingModes=i.get("text-writing-mode").map(function(m){return la[m]})),this.stateDependentLayerIds=this.layers.filter(function(m){return m.isStateDependent()}).map(function(m){return m.id}),this.sourceID=e.sourceID};Br.prototype.createArrays=function(){this.text=new yl(new Lt(this.layers,this.zoom,function(e){return/^text/.test(e)})),this.icon=new yl(new Lt(this.layers,this.zoom,function(e){return/^icon/.test(e)})),this.glyphOffsetArray=new S,this.lineVertexArray=new z,this.symbolInstances=new w},Br.prototype.calculateGlyphDependencies=function(e,t,i,l,f){for(var m=0;m<e.length;m++)if(t[e.charCodeAt(m)]=!0,(i||l)&&f){var x=yu[e.charAt(m)];x&&(t[x.charCodeAt(0)]=!0)}},Br.prototype.populate=function(e,t,i){var l=this.layers[0],f=l.layout,m=f.get("text-font"),x=f.get("text-field"),k=f.get("icon-image"),I=(x.value.kind!=="constant"||x.value.value instanceof wr&&!x.value.value.isEmpty()||x.value.value.toString().length>0)&&(m.value.kind!=="constant"||m.value.value.length>0),A=k.value.kind!=="constant"||!!k.value.value||Object.keys(k.parameters).length>0,C=f.get("symbol-sort-key");if(this.features=[],I||A){for(var B=t.iconDependencies,U=t.glyphDependencies,Z=t.availableImages,Q=new ur(this.zoom),ee=0,ce=e;ee<ce.length;ee+=1){var ne=ce[ee],me=ne.feature,be=ne.id,Se=ne.index,ze=ne.sourceLayerIndex,Pe=l._featureFilter.needGeometry,Ve=mi(me,Pe);if(l._featureFilter.filter(Q,Ve,i)){Pe||(Ve.geometry=ni(me));var Ye=void 0;if(I){var vt=l.getValueAndResolveTokens("text-field",Ve,i,Z),it=wr.factory(vt);Rg(it)&&(this.hasRTLText=!0),(!this.hasRTLText||iu()==="unavailable"||this.hasRTLText&&ta.isParsed())&&(Ye=hg(it,l,Ve))}var St=void 0;if(A){var nt=l.getValueAndResolveTokens("icon-image",Ve,i,Z);St=nt instanceof Di?nt:Di.fromString(nt)}if(Ye||St){var Qt=this.sortFeaturesByKey?C.evaluate(Ve,{},i):void 0;if(this.features.push({id:be,text:Ye,icon:St,index:Se,sourceLayerIndex:ze,geometry:Ve.geometry,properties:me.properties,type:Dg[me.type],sortKey:Qt}),St&&(B[St.name]=!0),Ye){var Rt=m.evaluate(Ve,{},i).join(","),dt=f.get("text-rotation-alignment")==="map"&&f.get("symbol-placement")!=="point";this.allowVerticalPlacement=this.writingModes&&this.writingModes.indexOf(la.vertical)>=0;for(var or=0,Kt=Ye.sections;or<Kt.length;or+=1){var gr=Kt[or];if(gr.image)B[gr.image.name]=!0;else{var kt=eu(Ye.toString()),Sr=gr.fontStack||Rt,Qr=U[Sr]=U[Sr]||{};this.calculateGlyphDependencies(gr.text,Qr,dt,this.allowVerticalPlacement,kt)}}}}}}f.get("symbol-placement")==="line"&&(this.features=function(ci){var ai={},$r={},hi=[],Bi=0;function Oi(Hr){hi.push(ci[Hr]),Bi++}function Tn(Hr,Si,dn){var kr=$r[Hr];return delete $r[Hr],$r[Si]=kr,hi[kr].geometry[0].pop(),hi[kr].geometry[0]=hi[kr].geometry[0].concat(dn[0]),kr}function Hi(Hr,Si,dn){var kr=ai[Si];return delete ai[Si],ai[Hr]=kr,hi[kr].geometry[0].shift(),hi[kr].geometry[0]=dn[0].concat(hi[kr].geometry[0]),kr}function zn(Hr,Si,dn){var kr=dn?Si[0][Si[0].length-1]:Si[0][0];return Hr+":"+kr.x+":"+kr.y}for(var yi=0;yi<ci.length;yi++){var Ji=ci[yi],pr=Ji.geometry,Fr=Ji.text?Ji.text.toString():null;if(Fr){var Dr=zn(Fr,pr),vr=zn(Fr,pr,!0);if(Dr in $r&&vr in ai&&$r[Dr]!==ai[vr]){var Bn=Hi(Dr,vr,pr),fn=Tn(Dr,vr,hi[Bn].geometry);delete ai[Dr],delete $r[vr],$r[zn(Fr,hi[fn].geometry,!0)]=fn,hi[Bn].geometry=null}else Dr in $r?Tn(Dr,vr,pr):vr in ai?Hi(Dr,vr,pr):(Oi(yi),ai[Dr]=Bi-1,$r[vr]=Bi-1)}else Oi(yi)}return hi.filter(function(Hr){return Hr.geometry})}(this.features)),this.sortFeaturesByKey&&this.features.sort(function(ci,ai){return ci.sortKey-ai.sortKey})}},Br.prototype.update=function(e,t,i){this.stateDependentLayers.length&&(this.text.programConfigurations.updatePaintArrays(e,t,this.layers,i),this.icon.programConfigurations.updatePaintArrays(e,t,this.layers,i))},Br.prototype.isEmpty=function(){return this.symbolInstances.length===0&&!this.hasRTLText},Br.prototype.uploadPending=function(){return!this.uploaded||this.text.programConfigurations.needsUpload||this.icon.programConfigurations.needsUpload},Br.prototype.upload=function(e){!this.uploaded&&this.hasDebugData()&&(this.textCollisionBox.upload(e),this.iconCollisionBox.upload(e)),this.text.upload(e,this.sortFeaturesByY,!this.uploaded,this.text.programConfigurations.needsUpload),this.icon.upload(e,this.sortFeaturesByY,!this.uploaded,this.icon.programConfigurations.needsUpload),this.uploaded=!0},Br.prototype.destroyDebugData=function(){this.textCollisionBox.destroy(),this.iconCollisionBox.destroy()},Br.prototype.destroy=function(){this.text.destroy(),this.icon.destroy(),this.hasDebugData()&&this.destroyDebugData()},Br.prototype.addToLineVertexArray=function(e,t){var i=this.lineVertexArray.length;if(e.segment!==void 0){for(var l=e.dist(t[e.segment+1]),f=e.dist(t[e.segment]),m={},x=e.segment+1;x<t.length;x++)m[x]={x:t[x].x,y:t[x].y,tileUnitDistanceFromAnchor:l},x<t.length-1&&(l+=t[x+1].dist(t[x]));for(var k=e.segment||0;k>=0;k--)m[k]={x:t[k].x,y:t[k].y,tileUnitDistanceFromAnchor:f},k>0&&(f+=t[k-1].dist(t[k]));for(var I=0;I<t.length;I++){var A=m[I];this.lineVertexArray.emplaceBack(A.x,A.y,A.tileUnitDistanceFromAnchor)}}return{lineStartIndex:i,lineLength:this.lineVertexArray.length-i}},Br.prototype.addSymbols=function(e,t,i,l,f,m,x,k,I,A,C,B){for(var U=e.indexArray,Z=e.layoutVertexArray,Q=e.segments.prepareSegment(4*t.length,Z,U,this.canOverlap?m.sortKey:void 0),ee=this.glyphOffsetArray.length,ce=Q.vertexLength,ne=this.allowVerticalPlacement&&x===la.vertical?Math.PI/2:0,me=m.text&&m.text.sections,be=0;be<t.length;be++){var Se=t[be],ze=Se.tl,Pe=Se.tr,Ve=Se.bl,Ye=Se.br,vt=Se.tex,it=Se.pixelOffsetTL,St=Se.pixelOffsetBR,nt=Se.minFontScaleX,Qt=Se.minFontScaleY,Rt=Se.glyphOffset,dt=Se.isSDF,or=Se.sectionIndex,Kt=Q.vertexLength,gr=Rt[1];Zc(Z,k.x,k.y,ze.x,gr+ze.y,vt.x,vt.y,i,dt,it.x,it.y,nt,Qt),Zc(Z,k.x,k.y,Pe.x,gr+Pe.y,vt.x+vt.w,vt.y,i,dt,St.x,it.y,nt,Qt),Zc(Z,k.x,k.y,Ve.x,gr+Ve.y,vt.x,vt.y+vt.h,i,dt,it.x,St.y,nt,Qt),Zc(Z,k.x,k.y,Ye.x,gr+Ye.y,vt.x+vt.w,vt.y+vt.h,i,dt,St.x,St.y,nt,Qt),hp(e.dynamicLayoutVertexArray,k,ne),U.emplaceBack(Kt,Kt+1,Kt+2),U.emplaceBack(Kt+1,Kt+2,Kt+3),Q.vertexLength+=4,Q.primitiveLength+=2,this.glyphOffsetArray.emplaceBack(Rt[0]),be!==t.length-1&&or===t[be+1].sectionIndex||e.programConfigurations.populatePaintArrays(Z.length,m,m.index,{},B,me&&me[or])}e.placedSymbolArray.emplaceBack(k.x,k.y,ee,this.glyphOffsetArray.length-ee,ce,I,A,k.segment,i?i[0]:0,i?i[1]:0,l[0],l[1],x,0,!1,0,C)},Br.prototype._addCollisionDebugVertex=function(e,t,i,l,f,m){return t.emplaceBack(0,0),e.emplaceBack(i.x,i.y,l,f,Math.round(m.x),Math.round(m.y))},Br.prototype.addCollisionDebugVertices=function(e,t,i,l,f,m,x){var k=f.segments.prepareSegment(4,f.layoutVertexArray,f.indexArray),I=k.vertexLength,A=f.layoutVertexArray,C=f.collisionVertexArray,B=x.anchorX,U=x.anchorY;this._addCollisionDebugVertex(A,C,m,B,U,new F(e,t)),this._addCollisionDebugVertex(A,C,m,B,U,new F(i,t)),this._addCollisionDebugVertex(A,C,m,B,U,new F(i,l)),this._addCollisionDebugVertex(A,C,m,B,U,new F(e,l)),k.vertexLength+=4;var Z=f.indexArray;Z.emplaceBack(I,I+1),Z.emplaceBack(I+1,I+2),Z.emplaceBack(I+2,I+3),Z.emplaceBack(I+3,I),k.primitiveLength+=4},Br.prototype.addDebugCollisionBoxes=function(e,t,i,l){for(var f=e;f<t;f++){var m=this.collisionBoxArray.get(f);this.addCollisionDebugVertices(m.x1,m.y1,m.x2,m.y2,l?this.textCollisionBox:this.iconCollisionBox,m.anchorPoint,i)}},Br.prototype.generateCollisionDebugBuffers=function(){this.hasDebugData()&&this.destroyDebugData(),this.textCollisionBox=new vu(Xo,hf.members,ks),this.iconCollisionBox=new vu(Xo,hf.members,ks);for(var e=0;e<this.symbolInstances.length;e++){var t=this.symbolInstances.get(e);this.addDebugCollisionBoxes(t.textBoxStartIndex,t.textBoxEndIndex,t,!0),this.addDebugCollisionBoxes(t.verticalTextBoxStartIndex,t.verticalTextBoxEndIndex,t,!0),this.addDebugCollisionBoxes(t.iconBoxStartIndex,t.iconBoxEndIndex,t,!1),this.addDebugCollisionBoxes(t.verticalIconBoxStartIndex,t.verticalIconBoxEndIndex,t,!1)}},Br.prototype._deserializeCollisionBoxesForSymbol=function(e,t,i,l,f,m,x,k,I){for(var A={},C=t;C<i;C++){var B=e.get(C);A.textBox={x1:B.x1,y1:B.y1,x2:B.x2,y2:B.y2,anchorPointX:B.anchorPointX,anchorPointY:B.anchorPointY},A.textFeatureIndex=B.featureIndex;break}for(var U=l;U<f;U++){var Z=e.get(U);A.verticalTextBox={x1:Z.x1,y1:Z.y1,x2:Z.x2,y2:Z.y2,anchorPointX:Z.anchorPointX,anchorPointY:Z.anchorPointY},A.verticalTextFeatureIndex=Z.featureIndex;break}for(var Q=m;Q<x;Q++){var ee=e.get(Q);A.iconBox={x1:ee.x1,y1:ee.y1,x2:ee.x2,y2:ee.y2,anchorPointX:ee.anchorPointX,anchorPointY:ee.anchorPointY},A.iconFeatureIndex=ee.featureIndex;break}for(var ce=k;ce<I;ce++){var ne=e.get(ce);A.verticalIconBox={x1:ne.x1,y1:ne.y1,x2:ne.x2,y2:ne.y2,anchorPointX:ne.anchorPointX,anchorPointY:ne.anchorPointY},A.verticalIconFeatureIndex=ne.featureIndex;break}return A},Br.prototype.deserializeCollisionBoxes=function(e){this.collisionArrays=[];for(var t=0;t<this.symbolInstances.length;t++){var i=this.symbolInstances.get(t);this.collisionArrays.push(this._deserializeCollisionBoxesForSymbol(e,i.textBoxStartIndex,i.textBoxEndIndex,i.verticalTextBoxStartIndex,i.verticalTextBoxEndIndex,i.iconBoxStartIndex,i.iconBoxEndIndex,i.verticalIconBoxStartIndex,i.verticalIconBoxEndIndex))}},Br.prototype.hasTextData=function(){return this.text.segments.get().length>0},Br.prototype.hasIconData=function(){return this.icon.segments.get().length>0},Br.prototype.hasDebugData=function(){return this.textCollisionBox&&this.iconCollisionBox},Br.prototype.hasTextCollisionBoxData=function(){return this.hasDebugData()&&this.textCollisionBox.segments.get().length>0},Br.prototype.hasIconCollisionBoxData=function(){return this.hasDebugData()&&this.iconCollisionBox.segments.get().length>0},Br.prototype.addIndicesForPlacedSymbol=function(e,t){for(var i=e.placedSymbolArray.get(t),l=i.vertexStartIndex+4*i.numGlyphs,f=i.vertexStartIndex;f<l;f+=4)e.indexArray.emplaceBack(f,f+1,f+2),e.indexArray.emplaceBack(f+1,f+2,f+3)},Br.prototype.getSortedSymbolIndexes=function(e){if(this.sortedAngle===e&&this.symbolInstanceIndexes!==void 0)return this.symbolInstanceIndexes;for(var t=Math.sin(e),i=Math.cos(e),l=[],f=[],m=[],x=0;x<this.symbolInstances.length;++x){m.push(x);var k=this.symbolInstances.get(x);l.push(0|Math.round(t*k.anchorX+i*k.anchorY)),f.push(k.featureIndex)}return m.sort(function(I,A){return l[I]-l[A]||f[A]-f[I]}),m},Br.prototype.addToSortKeyRanges=function(e,t){var i=this.sortKeyRanges[this.sortKeyRanges.length-1];i&&i.sortKey===t?i.symbolInstanceEnd=e+1:this.sortKeyRanges.push({sortKey:t,symbolInstanceStart:e,symbolInstanceEnd:e+1})},Br.prototype.sortFeatures=function(e){var t=this;if(this.sortFeaturesByY&&this.sortedAngle!==e&&!(this.text.segments.get().length>1||this.icon.segments.get().length>1)){this.symbolInstanceIndexes=this.getSortedSymbolIndexes(e),this.sortedAngle=e,this.text.indexArray.clear(),this.icon.indexArray.clear(),this.featureSortOrder=[];for(var i=0,l=this.symbolInstanceIndexes;i<l.length;i+=1){var f=this.symbolInstances.get(l[i]);this.featureSortOrder.push(f.featureIndex),[f.rightJustifiedTextSymbolIndex,f.centerJustifiedTextSymbolIndex,f.leftJustifiedTextSymbolIndex].forEach(function(m,x,k){m>=0&&k.indexOf(m)===x&&t.addIndicesForPlacedSymbol(t.text,m)}),f.verticalPlacedTextSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.text,f.verticalPlacedTextSymbolIndex),f.placedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,f.placedIconSymbolIndex),f.verticalPlacedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,f.verticalPlacedIconSymbolIndex)}this.text.indexBuffer&&this.text.indexBuffer.updateData(this.text.indexArray),this.icon.indexBuffer&&this.icon.indexBuffer.updateData(this.icon.indexArray)}},ut("SymbolBucket",Br,{omit:["layers","collisionBoxArray","features","compareText"]}),Br.MAX_GLYPHS=65535,Br.addDynamicAttributes=hp;var Bg=new an({"symbol-placement":new xt(j.layout_symbol["symbol-placement"]),"symbol-spacing":new xt(j.layout_symbol["symbol-spacing"]),"symbol-avoid-edges":new xt(j.layout_symbol["symbol-avoid-edges"]),"symbol-sort-key":new ft(j.layout_symbol["symbol-sort-key"]),"symbol-z-order":new xt(j.layout_symbol["symbol-z-order"]),"icon-allow-overlap":new xt(j.layout_symbol["icon-allow-overlap"]),"icon-ignore-placement":new xt(j.layout_symbol["icon-ignore-placement"]),"icon-optional":new xt(j.layout_symbol["icon-optional"]),"icon-rotation-alignment":new xt(j.layout_symbol["icon-rotation-alignment"]),"icon-size":new ft(j.layout_symbol["icon-size"]),"icon-text-fit":new xt(j.layout_symbol["icon-text-fit"]),"icon-text-fit-padding":new xt(j.layout_symbol["icon-text-fit-padding"]),"icon-image":new ft(j.layout_symbol["icon-image"]),"icon-rotate":new ft(j.layout_symbol["icon-rotate"]),"icon-padding":new xt(j.layout_symbol["icon-padding"]),"icon-keep-upright":new xt(j.layout_symbol["icon-keep-upright"]),"icon-offset":new ft(j.layout_symbol["icon-offset"]),"icon-anchor":new ft(j.layout_symbol["icon-anchor"]),"icon-pitch-alignment":new xt(j.layout_symbol["icon-pitch-alignment"]),"text-pitch-alignment":new xt(j.layout_symbol["text-pitch-alignment"]),"text-rotation-alignment":new xt(j.layout_symbol["text-rotation-alignment"]),"text-field":new ft(j.layout_symbol["text-field"]),"text-font":new ft(j.layout_symbol["text-font"]),"text-size":new ft(j.layout_symbol["text-size"]),"text-max-width":new ft(j.layout_symbol["text-max-width"]),"text-line-height":new xt(j.layout_symbol["text-line-height"]),"text-letter-spacing":new ft(j.layout_symbol["text-letter-spacing"]),"text-justify":new ft(j.layout_symbol["text-justify"]),"text-radial-offset":new ft(j.layout_symbol["text-radial-offset"]),"text-variable-anchor":new xt(j.layout_symbol["text-variable-anchor"]),"text-anchor":new ft(j.layout_symbol["text-anchor"]),"text-max-angle":new xt(j.layout_symbol["text-max-angle"]),"text-writing-mode":new xt(j.layout_symbol["text-writing-mode"]),"text-rotate":new ft(j.layout_symbol["text-rotate"]),"text-padding":new xt(j.layout_symbol["text-padding"]),"text-keep-upright":new xt(j.layout_symbol["text-keep-upright"]),"text-transform":new ft(j.layout_symbol["text-transform"]),"text-offset":new ft(j.layout_symbol["text-offset"]),"text-allow-overlap":new xt(j.layout_symbol["text-allow-overlap"]),"text-ignore-placement":new xt(j.layout_symbol["text-ignore-placement"]),"text-optional":new xt(j.layout_symbol["text-optional"])}),pp={paint:new an({"icon-opacity":new ft(j.paint_symbol["icon-opacity"]),"icon-color":new ft(j.paint_symbol["icon-color"]),"icon-halo-color":new ft(j.paint_symbol["icon-halo-color"]),"icon-halo-width":new ft(j.paint_symbol["icon-halo-width"]),"icon-halo-blur":new ft(j.paint_symbol["icon-halo-blur"]),"icon-translate":new xt(j.paint_symbol["icon-translate"]),"icon-translate-anchor":new xt(j.paint_symbol["icon-translate-anchor"]),"text-opacity":new ft(j.paint_symbol["text-opacity"]),"text-color":new ft(j.paint_symbol["text-color"],{runtimeType:qe,getOverride:function(e){return e.textColor},hasOverride:function(e){return!!e.textColor}}),"text-halo-color":new ft(j.paint_symbol["text-halo-color"]),"text-halo-width":new ft(j.paint_symbol["text-halo-width"]),"text-halo-blur":new ft(j.paint_symbol["text-halo-blur"]),"text-translate":new xt(j.paint_symbol["text-translate"]),"text-translate-anchor":new xt(j.paint_symbol["text-translate-anchor"])}),layout:Bg},gl=function(e){this.type=e.property.overrides?e.property.overrides.runtimeType:He,this.defaultValue=e};gl.prototype.evaluate=function(e){if(e.formattedSection){var t=this.defaultValue.property.overrides;if(t&&t.hasOverride(e.formattedSection))return t.getOverride(e.formattedSection)}return e.feature&&e.featureState?this.defaultValue.evaluate(e.feature,e.featureState):this.defaultValue.property.specification.default},gl.prototype.eachChild=function(e){this.defaultValue.isConstant()||e(this.defaultValue.value._styleExpression.expression)},gl.prototype.outputDefined=function(){return!1},gl.prototype.serialize=function(){return null},ut("FormatSectionOverride",gl,{omit:["defaultValue"]});var Og=function(e){function t(i){e.call(this,i,pp)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.recalculate=function(i,l){if(e.prototype.recalculate.call(this,i,l),this.layout.get("icon-rotation-alignment")==="auto"&&(this.layout._values["icon-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-rotation-alignment")==="auto"&&(this.layout._values["text-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-pitch-alignment")==="auto"&&(this.layout._values["text-pitch-alignment"]=this.layout.get("text-rotation-alignment")),this.layout.get("icon-pitch-alignment")==="auto"&&(this.layout._values["icon-pitch-alignment"]=this.layout.get("icon-rotation-alignment")),this.layout.get("symbol-placement")==="point"){var f=this.layout.get("text-writing-mode");if(f){for(var m=[],x=0,k=f;x<k.length;x+=1){var I=k[x];m.indexOf(I)<0&&m.push(I)}this.layout._values["text-writing-mode"]=m}else this.layout._values["text-writing-mode"]=["horizontal"]}this._setPaintOverrides()},t.prototype.getValueAndResolveTokens=function(i,l,f,m){var x=this.layout.get(i).evaluate(l,{},f,m),k=this._unevaluatedLayout._values[i];return k.isDataDriven()||ps(k.value)||!x?x:function(I,A){return A.replace(/{([^{}]+)}/g,function(C,B){return B in I?String(I[B]):""})}(l.properties,x)},t.prototype.createBucket=function(i){return new Br(i)},t.prototype.queryRadius=function(){return 0},t.prototype.queryIntersectsFeature=function(){return!1},t.prototype._setPaintOverrides=function(){for(var i=0,l=pp.paint.overridableProperties;i<l.length;i+=1){var f=l[i];if(t.hasPaintOverride(this.layout,f)){var m,x=this.paint.get(f),k=new gl(x),I=new Uo(k,x.property.specification);m=x.value.kind==="constant"||x.value.kind==="source"?new fs("source",I):new Vo("composite",I,x.value.zoomStops,x.value._interpolationType),this.paint._values[f]=new wn(x.property,m,x.parameters)}}},t.prototype._handleOverridablePaintPropertyUpdate=function(i,l,f){return!(!this.layout||l.isDataDriven()||f.isDataDriven())&&t.hasPaintOverride(this.layout,i)},t.hasPaintOverride=function(i,l){var f=i.get("text-field"),m=pp.paint.properties[l],x=!1,k=function(C){for(var B=0,U=C;B<U.length;B+=1)if(m.overrides&&m.overrides.hasOverride(U[B]))return void(x=!0)};if(f.value.kind==="constant"&&f.value.value instanceof wr)k(f.value.value.sections);else if(f.value.kind==="source"){var I=function(C){x||(C instanceof ki&&Xr(C.value)===lr?k(C.value.sections):C instanceof Un?k(C.sections):C.eachChild(I))},A=f.value;A._styleExpression&&I(A._styleExpression.expression)}return x},t}(Ta),Fg={paint:new an({"background-color":new xt(j.paint_background["background-color"]),"background-pattern":new Sn(j.paint_background["background-pattern"]),"background-opacity":new xt(j.paint_background["background-opacity"])})},Ng=function(e){function t(i){e.call(this,i,Fg)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t}(Ta),Ug={paint:new an({"raster-opacity":new xt(j.paint_raster["raster-opacity"]),"raster-hue-rotate":new xt(j.paint_raster["raster-hue-rotate"]),"raster-brightness-min":new xt(j.paint_raster["raster-brightness-min"]),"raster-brightness-max":new xt(j.paint_raster["raster-brightness-max"]),"raster-saturation":new xt(j.paint_raster["raster-saturation"]),"raster-contrast":new xt(j.paint_raster["raster-contrast"]),"raster-resampling":new xt(j.paint_raster["raster-resampling"]),"raster-fade-duration":new xt(j.paint_raster["raster-fade-duration"])})},Vg=function(e){function t(i){e.call(this,i,Ug)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t}(Ta),jg=function(e){function t(i){e.call(this,i,{}),this.implementation=i}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.is3D=function(){return this.implementation.renderingMode==="3d"},t.prototype.hasOffscreenPass=function(){return this.implementation.prerender!==void 0},t.prototype.recalculate=function(){},t.prototype.updateTransitions=function(){},t.prototype.hasTransition=function(){},t.prototype.serialize=function(){},t.prototype.onAdd=function(i){this.implementation.onAdd&&this.implementation.onAdd(i,i.painter.context.gl)},t.prototype.onRemove=function(i){this.implementation.onRemove&&this.implementation.onRemove(i,i.painter.context.gl)},t}(Ta),qg={circle:Jh,heatmap:Ty,hillshade:Iy,fill:Gy,"fill-extrusion":eg,line:og,symbol:Og,background:Ng,raster:Vg},Lf=D.HTMLImageElement,Rf=D.HTMLCanvasElement,Bf=D.HTMLVideoElement,Of=D.ImageData,Gc=D.ImageBitmap,Ps=function(e,t,i,l){this.context=e,this.format=i,this.texture=e.gl.createTexture(),this.update(t,l)};Ps.prototype.update=function(e,t,i){var l=e.width,f=e.height,m=!(this.size&&this.size[0]===l&&this.size[1]===f||i),x=this.context,k=x.gl;if(this.useMipmap=!!(t&&t.useMipmap),k.bindTexture(k.TEXTURE_2D,this.texture),x.pixelStoreUnpackFlipY.set(!1),x.pixelStoreUnpack.set(1),x.pixelStoreUnpackPremultiplyAlpha.set(this.format===k.RGBA&&(!t||t.premultiply!==!1)),m)this.size=[l,f],e instanceof Lf||e instanceof Rf||e instanceof Bf||e instanceof Of||Gc&&e instanceof Gc?k.texImage2D(k.TEXTURE_2D,0,this.format,this.format,k.UNSIGNED_BYTE,e):k.texImage2D(k.TEXTURE_2D,0,this.format,l,f,0,this.format,k.UNSIGNED_BYTE,e.data);else{var I=i||{x:0,y:0},A=I.x,C=I.y;e instanceof Lf||e instanceof Rf||e instanceof Bf||e instanceof Of||Gc&&e instanceof Gc?k.texSubImage2D(k.TEXTURE_2D,0,A,C,k.RGBA,k.UNSIGNED_BYTE,e):k.texSubImage2D(k.TEXTURE_2D,0,A,C,l,f,k.RGBA,k.UNSIGNED_BYTE,e.data)}this.useMipmap&&this.isSizePowerOfTwo()&&k.generateMipmap(k.TEXTURE_2D)},Ps.prototype.bind=function(e,t,i){var l=this.context.gl;l.bindTexture(l.TEXTURE_2D,this.texture),i!==l.LINEAR_MIPMAP_NEAREST||this.isSizePowerOfTwo()||(i=l.LINEAR),e!==this.filter&&(l.texParameteri(l.TEXTURE_2D,l.TEXTURE_MAG_FILTER,e),l.texParameteri(l.TEXTURE_2D,l.TEXTURE_MIN_FILTER,i||e),this.filter=e),t!==this.wrap&&(l.texParameteri(l.TEXTURE_2D,l.TEXTURE_WRAP_S,t),l.texParameteri(l.TEXTURE_2D,l.TEXTURE_WRAP_T,t),this.wrap=t)},Ps.prototype.isSizePowerOfTwo=function(){return this.size[0]===this.size[1]&&Math.log(this.size[0])/Math.LN2%1==0},Ps.prototype.destroy=function(){this.context.gl.deleteTexture(this.texture),this.texture=null};var fp=function(e){var t=this;this._callback=e,this._triggered=!1,typeof MessageChannel<"u"&&(this._channel=new MessageChannel,this._channel.port2.onmessage=function(){t._triggered=!1,t._callback()})};fp.prototype.trigger=function(){var e=this;this._triggered||(this._triggered=!0,this._channel?this._channel.port1.postMessage(!0):setTimeout(function(){e._triggered=!1,e._callback()},0))},fp.prototype.remove=function(){delete this._channel,this._callback=function(){}};var _l=function(e,t,i){this.target=e,this.parent=t,this.mapId=i,this.callbacks={},this.tasks={},this.taskQueue=[],this.cancelCallbacks={},ct(["receive","process"],this),this.invoker=new fp(this.process),this.target.addEventListener("message",this.receive,!1),this.globalScope=Zt()?e:D};function Ff(e,t,i){var l=2*Math.PI*6378137/256/Math.pow(2,i);return[e*l-2*Math.PI*6378137/2,t*l-2*Math.PI*6378137/2]}_l.prototype.send=function(e,t,i,l,f){var m=this;f===void 0&&(f=!1);var x=Math.round(1e18*Math.random()).toString(36).substring(0,10);i&&(this.callbacks[x]=i);var k=jt(this.globalScope)?void 0:[];return this.target.postMessage({id:x,type:e,hasCallback:!!i,targetMapId:l,mustQueue:f,sourceMapId:this.mapId,data:da(t,k)},k),{cancel:function(){i&&delete m.callbacks[x],m.target.postMessage({id:x,type:"<cancel>",targetMapId:l,sourceMapId:m.mapId})}}},_l.prototype.receive=function(e){var t=e.data,i=t.id;if(i&&(!t.targetMapId||this.mapId===t.targetMapId))if(t.type==="<cancel>"){delete this.tasks[i];var l=this.cancelCallbacks[i];delete this.cancelCallbacks[i],l&&l()}else Zt()||t.mustQueue?(this.tasks[i]=t,this.taskQueue.push(i),this.invoker.trigger()):this.processTask(i,t)},_l.prototype.process=function(){if(this.taskQueue.length){var e=this.taskQueue.shift(),t=this.tasks[e];delete this.tasks[e],this.taskQueue.length&&this.invoker.trigger(),t&&this.processTask(e,t)}},_l.prototype.processTask=function(e,t){var i=this;if(t.type==="<response>"){var l=this.callbacks[e];delete this.callbacks[e],l&&(t.error?l(Zn(t.error)):l(null,Zn(t.data)))}else{var f=!1,m=jt(this.globalScope)?void 0:[],x=t.hasCallback?function(C,B){f=!0,delete i.cancelCallbacks[e],i.target.postMessage({id:e,type:"<response>",sourceMapId:i.mapId,error:C?da(C):null,data:da(B,m)},m)}:function(C){f=!0},k=null,I=Zn(t.data);if(this.parent[t.type])k=this.parent[t.type](t.sourceMapId,I,x);else if(this.parent.getWorkerSource){var A=t.type.split(".");k=this.parent.getWorkerSource(t.sourceMapId,A[0],I.source)[A[1]](I,x)}else x(new Error("Could not find function "+t.type));!f&&k&&k.cancel&&(this.cancelCallbacks[e]=k.cancel)}},_l.prototype.remove=function(){this.invoker.remove(),this.target.removeEventListener("message",this.receive,!1)};var Ai=function(e,t){e&&(t?this.setSouthWest(e).setNorthEast(t):e.length===4?this.setSouthWest([e[0],e[1]]).setNorthEast([e[2],e[3]]):this.setSouthWest(e[0]).setNorthEast(e[1]))};Ai.prototype.setNorthEast=function(e){return this._ne=e instanceof Yr?new Yr(e.lng,e.lat):Yr.convert(e),this},Ai.prototype.setSouthWest=function(e){return this._sw=e instanceof Yr?new Yr(e.lng,e.lat):Yr.convert(e),this},Ai.prototype.extend=function(e){var t,i,l=this._sw,f=this._ne;if(e instanceof Yr)t=e,i=e;else{if(!(e instanceof Ai))return Array.isArray(e)?e.length===4||e.every(Array.isArray)?this.extend(Ai.convert(e)):this.extend(Yr.convert(e)):this;if(i=e._ne,!(t=e._sw)||!i)return this}return l||f?(l.lng=Math.min(t.lng,l.lng),l.lat=Math.min(t.lat,l.lat),f.lng=Math.max(i.lng,f.lng),f.lat=Math.max(i.lat,f.lat)):(this._sw=new Yr(t.lng,t.lat),this._ne=new Yr(i.lng,i.lat)),this},Ai.prototype.getCenter=function(){return new Yr((this._sw.lng+this._ne.lng)/2,(this._sw.lat+this._ne.lat)/2)},Ai.prototype.getSouthWest=function(){return this._sw},Ai.prototype.getNorthEast=function(){return this._ne},Ai.prototype.getNorthWest=function(){return new Yr(this.getWest(),this.getNorth())},Ai.prototype.getSouthEast=function(){return new Yr(this.getEast(),this.getSouth())},Ai.prototype.getWest=function(){return this._sw.lng},Ai.prototype.getSouth=function(){return this._sw.lat},Ai.prototype.getEast=function(){return this._ne.lng},Ai.prototype.getNorth=function(){return this._ne.lat},Ai.prototype.toArray=function(){return[this._sw.toArray(),this._ne.toArray()]},Ai.prototype.toString=function(){return"LngLatBounds("+this._sw.toString()+", "+this._ne.toString()+")"},Ai.prototype.isEmpty=function(){return!(this._sw&&this._ne)},Ai.prototype.contains=function(e){var t=Yr.convert(e),i=t.lng,l=t.lat,f=this._sw.lng<=i&&i<=this._ne.lng;return this._sw.lng>this._ne.lng&&(f=this._sw.lng>=i&&i>=this._ne.lng),this._sw.lat<=l&&l<=this._ne.lat&&f},Ai.convert=function(e){return!e||e instanceof Ai?e:new Ai(e)};var Yr=function(e,t){if(isNaN(e)||isNaN(t))throw new Error("Invalid LngLat object: ("+e+", "+t+")");if(this.lng=+e,this.lat=+t,this.lat>90||this.lat<-90)throw new Error("Invalid LngLat latitude value: must be between -90 and 90")};Yr.prototype.wrap=function(){return new Yr(we(this.lng,-180,180),this.lat)},Yr.prototype.toArray=function(){return[this.lng,this.lat]},Yr.prototype.toString=function(){return"LngLat("+this.lng+", "+this.lat+")"},Yr.prototype.distanceTo=function(e){var t=Math.PI/180,i=this.lat*t,l=e.lat*t,f=Math.sin(i)*Math.sin(l)+Math.cos(i)*Math.cos(l)*Math.cos((e.lng-this.lng)*t);return 63710088e-1*Math.acos(Math.min(f,1))},Yr.prototype.toBounds=function(e){e===void 0&&(e=0);var t=360*e/40075017,i=t/Math.cos(Math.PI/180*this.lat);return new Ai(new Yr(this.lng-i,this.lat-t),new Yr(this.lng+i,this.lat+t))},Yr.convert=function(e){if(e instanceof Yr)return e;if(Array.isArray(e)&&(e.length===2||e.length===3))return new Yr(Number(e[0]),Number(e[1]));if(!Array.isArray(e)&&typeof e=="object"&&e!==null)return new Yr(Number("lng"in e?e.lng:e.lon),Number(e.lat));throw new Error("`LngLatLike` argument must be specified as a LngLat instance, an object {lng: <lng>, lat: <lat>}, an object {lon: <lng>, lat: <lat>}, or an array of [<lng>, <lat>]")};var Nf=2*Math.PI*63710088e-1;function Uf(e){return Nf*Math.cos(e*Math.PI/180)}function Vf(e){return(180+e)/360}function jf(e){return(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+e*Math.PI/360)))/360}function qf(e,t){return e/Uf(t)}function dp(e){return 360/Math.PI*Math.atan(Math.exp((180-360*e)*Math.PI/180))-90}var Cs=function(e,t,i){i===void 0&&(i=0),this.x=+e,this.y=+t,this.z=+i};Cs.fromLngLat=function(e,t){t===void 0&&(t=0);var i=Yr.convert(e);return new Cs(Vf(i.lng),jf(i.lat),qf(t,i.lat))},Cs.prototype.toLngLat=function(){return new Yr(360*this.x-180,dp(this.y))},Cs.prototype.toAltitude=function(){return this.z*Uf(dp(this.y))},Cs.prototype.meterInMercatorCoordinateUnits=function(){return 1/Nf*(e=dp(this.y),1/Math.cos(e*Math.PI/180));var e};var Ms=function(e,t,i){this.z=e,this.x=t,this.y=i,this.key=bu(0,e,e,t,i)};Ms.prototype.equals=function(e){return this.z===e.z&&this.x===e.x&&this.y===e.y},Ms.prototype.url=function(e,t){var i,l,f,m,x,k=(l=this.y,f=this.z,m=Ff(256*(i=this.x),256*(l=Math.pow(2,f)-l-1),f),x=Ff(256*(i+1),256*(l+1),f),m[0]+","+m[1]+","+x[0]+","+x[1]),I=function(A,C,B){for(var U,Z="",Q=A;Q>0;Q--)Z+=(C&(U=1<<Q-1)?1:0)+(B&U?2:0);return Z}(this.z,this.x,this.y);return e[(this.x+this.y)%e.length].replace("{prefix}",(this.x%16).toString(16)+(this.y%16).toString(16)).replace("{z}",String(this.z)).replace("{x}",String(this.x)).replace("{y}",String(t==="tms"?Math.pow(2,this.z)-this.y-1:this.y)).replace("{quadkey}",I).replace("{bbox-epsg-3857}",k)},Ms.prototype.getTilePoint=function(e){var t=Math.pow(2,this.z);return new F(8192*(e.x*t-this.x),8192*(e.y*t-this.y))},Ms.prototype.toString=function(){return this.z+"/"+this.x+"/"+this.y};var Zf=function(e,t){this.wrap=e,this.canonical=t,this.key=bu(e,t.z,t.z,t.x,t.y)},Pi=function(e,t,i,l,f){this.overscaledZ=e,this.wrap=t,this.canonical=new Ms(i,+l,+f),this.key=bu(t,e,i,l,f)};function bu(e,t,i,l,f){(e*=2)<0&&(e=-1*e-1);var m=1<<i;return(m*m*e+m*f+l).toString(36)+i.toString(36)+t.toString(36)}Pi.prototype.equals=function(e){return this.overscaledZ===e.overscaledZ&&this.wrap===e.wrap&&this.canonical.equals(e.canonical)},Pi.prototype.scaledTo=function(e){var t=this.canonical.z-e;return e>this.canonical.z?new Pi(e,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y):new Pi(e,this.wrap,e,this.canonical.x>>t,this.canonical.y>>t)},Pi.prototype.calculateScaledKey=function(e,t){var i=this.canonical.z-e;return e>this.canonical.z?bu(this.wrap*+t,e,this.canonical.z,this.canonical.x,this.canonical.y):bu(this.wrap*+t,e,e,this.canonical.x>>i,this.canonical.y>>i)},Pi.prototype.isChildOf=function(e){if(e.wrap!==this.wrap)return!1;var t=this.canonical.z-e.canonical.z;return e.overscaledZ===0||e.overscaledZ<this.overscaledZ&&e.canonical.x===this.canonical.x>>t&&e.canonical.y===this.canonical.y>>t},Pi.prototype.children=function(e){if(this.overscaledZ>=e)return[new Pi(this.overscaledZ+1,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)];var t=this.canonical.z+1,i=2*this.canonical.x,l=2*this.canonical.y;return[new Pi(t,this.wrap,t,i,l),new Pi(t,this.wrap,t,i+1,l),new Pi(t,this.wrap,t,i,l+1),new Pi(t,this.wrap,t,i+1,l+1)]},Pi.prototype.isLessThan=function(e){return this.wrap<e.wrap||!(this.wrap>e.wrap)&&(this.overscaledZ<e.overscaledZ||!(this.overscaledZ>e.overscaledZ)&&(this.canonical.x<e.canonical.x||!(this.canonical.x>e.canonical.x)&&this.canonical.y<e.canonical.y))},Pi.prototype.wrapped=function(){return new Pi(this.overscaledZ,0,this.canonical.z,this.canonical.x,this.canonical.y)},Pi.prototype.unwrapTo=function(e){return new Pi(this.overscaledZ,e,this.canonical.z,this.canonical.x,this.canonical.y)},Pi.prototype.overscaleFactor=function(){return Math.pow(2,this.overscaledZ-this.canonical.z)},Pi.prototype.toUnwrapped=function(){return new Zf(this.wrap,this.canonical)},Pi.prototype.toString=function(){return this.overscaledZ+"/"+this.canonical.x+"/"+this.canonical.y},Pi.prototype.getTilePoint=function(e){return this.canonical.getTilePoint(new Cs(e.x-this.wrap,e.y))},ut("CanonicalTileID",Ms),ut("OverscaledTileID",Pi,{omit:["posMatrix"]});var Co=function(e,t,i){if(this.uid=e,t.height!==t.width)throw new RangeError("DEM tiles must be square");if(i&&i!=="mapbox"&&i!=="terrarium")return bt('"'+i+'" is not a valid encoding type. Valid types include "mapbox" and "terrarium".');this.stride=t.height;var l=this.dim=t.height-2;this.data=new Uint32Array(t.data.buffer),this.encoding=i||"mapbox";for(var f=0;f<l;f++)this.data[this._idx(-1,f)]=this.data[this._idx(0,f)],this.data[this._idx(l,f)]=this.data[this._idx(l-1,f)],this.data[this._idx(f,-1)]=this.data[this._idx(f,0)],this.data[this._idx(f,l)]=this.data[this._idx(f,l-1)];this.data[this._idx(-1,-1)]=this.data[this._idx(0,0)],this.data[this._idx(l,-1)]=this.data[this._idx(l-1,0)],this.data[this._idx(-1,l)]=this.data[this._idx(0,l-1)],this.data[this._idx(l,l)]=this.data[this._idx(l-1,l-1)]};Co.prototype.get=function(e,t){var i=new Uint8Array(this.data.buffer),l=4*this._idx(e,t);return(this.encoding==="terrarium"?this._unpackTerrarium:this._unpackMapbox)(i[l],i[l+1],i[l+2])},Co.prototype.getUnpackVector=function(){return this.encoding==="terrarium"?[256,1,1/256,32768]:[6553.6,25.6,.1,1e4]},Co.prototype._idx=function(e,t){if(e<-1||e>=this.dim+1||t<-1||t>=this.dim+1)throw new RangeError("out of range source coordinates for DEM data");return(t+1)*this.stride+(e+1)},Co.prototype._unpackMapbox=function(e,t,i){return(256*e*256+256*t+i)/10-1e4},Co.prototype._unpackTerrarium=function(e,t,i){return 256*e+t+i/256-32768},Co.prototype.getPixels=function(){return new Hn({width:this.stride,height:this.stride},new Uint8Array(this.data.buffer))},Co.prototype.backfillBorder=function(e,t,i){if(this.dim!==e.dim)throw new Error("dem dimension mismatch");var l=t*this.dim,f=t*this.dim+this.dim,m=i*this.dim,x=i*this.dim+this.dim;switch(t){case-1:l=f-1;break;case 1:f=l+1}switch(i){case-1:m=x-1;break;case 1:x=m+1}for(var k=-t*this.dim,I=-i*this.dim,A=m;A<x;A++)for(var C=l;C<f;C++)this.data[this._idx(C,A)]=e.data[this._idx(C+k,A+I)]},ut("DEMData",Co);var Kc=function(e){this._stringToNumber={},this._numberToString=[];for(var t=0;t<e.length;t++){var i=e[t];this._stringToNumber[i]=t,this._numberToString[t]=i}};Kc.prototype.encode=function(e){return this._stringToNumber[e]},Kc.prototype.decode=function(e){return this._numberToString[e]};var Xc=function(e,t,i,l,f){this.type="Feature",this._vectorTileFeature=e,e._z=t,e._x=i,e._y=l,this.properties=e.properties,this.id=f},mp={geometry:{configurable:!0}};mp.geometry.get=function(){return this._geometry===void 0&&(this._geometry=this._vectorTileFeature.toGeoJSON(this._vectorTileFeature._x,this._vectorTileFeature._y,this._vectorTileFeature._z).geometry),this._geometry},mp.geometry.set=function(e){this._geometry=e},Xc.prototype.toJSON=function(){var e={geometry:this.geometry};for(var t in this)t!=="_geometry"&&t!=="_vectorTileFeature"&&(e[t]=this[t]);return e},Object.defineProperties(Xc.prototype,mp);var vl=function(){this.state={},this.stateChanges={},this.deletedStates={}};vl.prototype.updateState=function(e,t,i){var l=String(t);if(this.stateChanges[e]=this.stateChanges[e]||{},this.stateChanges[e][l]=this.stateChanges[e][l]||{},xe(this.stateChanges[e][l],i),this.deletedStates[e]===null)for(var f in this.deletedStates[e]={},this.state[e])f!==l&&(this.deletedStates[e][f]=null);else if(this.deletedStates[e]&&this.deletedStates[e][l]===null)for(var m in this.deletedStates[e][l]={},this.state[e][l])i[m]||(this.deletedStates[e][l][m]=null);else for(var x in i)this.deletedStates[e]&&this.deletedStates[e][l]&&this.deletedStates[e][l][x]===null&&delete this.deletedStates[e][l][x]},vl.prototype.removeFeatureState=function(e,t,i){if(this.deletedStates[e]!==null){var l=String(t);if(this.deletedStates[e]=this.deletedStates[e]||{},i&&t!==void 0)this.deletedStates[e][l]!==null&&(this.deletedStates[e][l]=this.deletedStates[e][l]||{},this.deletedStates[e][l][i]=null);else if(t!==void 0)if(this.stateChanges[e]&&this.stateChanges[e][l])for(i in this.deletedStates[e][l]={},this.stateChanges[e][l])this.deletedStates[e][l][i]=null;else this.deletedStates[e][l]=null;else this.deletedStates[e]=null}},vl.prototype.getState=function(e,t){var i=String(t),l=xe({},(this.state[e]||{})[i],(this.stateChanges[e]||{})[i]);if(this.deletedStates[e]===null)return{};if(this.deletedStates[e]){var f=this.deletedStates[e][t];if(f===null)return{};for(var m in f)delete l[m]}return l},vl.prototype.initializeTileState=function(e,t){e.setFeatureState(this.state,t)},vl.prototype.coalesceChanges=function(e,t){var i={};for(var l in this.stateChanges){this.state[l]=this.state[l]||{};var f={};for(var m in this.stateChanges[l])this.state[l][m]||(this.state[l][m]={}),xe(this.state[l][m],this.stateChanges[l][m]),f[m]=this.state[l][m];i[l]=f}for(var x in this.deletedStates){this.state[x]=this.state[x]||{};var k={};if(this.deletedStates[x]===null)for(var I in this.state[x])k[I]={},this.state[x][I]={};else for(var A in this.deletedStates[x]){if(this.deletedStates[x][A]===null)this.state[x][A]={};else for(var C=0,B=Object.keys(this.deletedStates[x][A]);C<B.length;C+=1)delete this.state[x][A][B[C]];k[A]=this.state[x][A]}i[x]=i[x]||{},xe(i[x],k)}if(this.stateChanges={},this.deletedStates={},Object.keys(i).length!==0)for(var U in e)e[U].setFeatureState(i,t)};var Mo=function(e,t){this.tileID=e,this.x=e.canonical.x,this.y=e.canonical.y,this.z=e.canonical.z,this.grid=new Ca(8192,16,0),this.grid3D=new Ca(8192,16,0),this.featureIndexArray=new O,this.promoteId=t};function Gf(e,t,i,l,f){return ht(e,function(m,x){var k=t instanceof ws?t.get(x):null;return k&&k.evaluate?k.evaluate(i,l,f):k})}function Kf(e){for(var t=1/0,i=1/0,l=-1/0,f=-1/0,m=0,x=e;m<x.length;m+=1){var k=x[m];t=Math.min(t,k.x),i=Math.min(i,k.y),l=Math.max(l,k.x),f=Math.max(f,k.y)}return{minX:t,minY:i,maxX:l,maxY:f}}function Zg(e,t){return t-e}Mo.prototype.insert=function(e,t,i,l,f,m){var x=this.featureIndexArray.length;this.featureIndexArray.emplaceBack(i,l,f);for(var k=m?this.grid3D:this.grid,I=0;I<t.length;I++){for(var A=t[I],C=[1/0,1/0,-1/0,-1/0],B=0;B<A.length;B++){var U=A[B];C[0]=Math.min(C[0],U.x),C[1]=Math.min(C[1],U.y),C[2]=Math.max(C[2],U.x),C[3]=Math.max(C[3],U.y)}C[0]<8192&&C[1]<8192&&C[2]>=0&&C[3]>=0&&k.insert(x,C[0],C[1],C[2],C[3])}},Mo.prototype.loadVTLayers=function(){return this.vtLayers||(this.vtLayers=new ul.VectorTile(new Rc(this.rawTileData)).layers,this.sourceLayerCoder=new Kc(this.vtLayers?Object.keys(this.vtLayers).sort():["_geojsonTileLayer"])),this.vtLayers},Mo.prototype.query=function(e,t,i,l){var f=this;this.loadVTLayers();for(var m=e.params||{},x=8192/e.tileSize/e.scale,k=Ks(m.filter),I=e.queryGeometry,A=e.queryPadding*x,C=Kf(I),B=this.grid.query(C.minX-A,C.minY-A,C.maxX+A,C.maxY+A),U=Kf(e.cameraQueryGeometry),Z=this.grid3D.query(U.minX-A,U.minY-A,U.maxX+A,U.maxY+A,function(Se,ze,Pe,Ve){return function(Ye,vt,it,St,nt){for(var Qt=0,Rt=Ye;Qt<Rt.length;Qt+=1){var dt=Rt[Qt];if(vt<=dt.x&&it<=dt.y&&St>=dt.x&&nt>=dt.y)return!0}var or=[new F(vt,it),new F(vt,nt),new F(St,nt),new F(St,it)];if(Ye.length>2){for(var Kt=0,gr=or;Kt<gr.length;Kt+=1)if(Ia(Ye,gr[Kt]))return!0}for(var kt=0;kt<Ye.length-1;kt++)if(zs(Ye[kt],Ye[kt+1],or))return!0;return!1}(e.cameraQueryGeometry,Se-A,ze-A,Pe+A,Ve+A)}),Q=0,ee=Z;Q<ee.length;Q+=1)B.push(ee[Q]);B.sort(Zg);for(var ce,ne={},me=function(Se){var ze=B[Se];if(ze!==ce){ce=ze;var Pe=f.featureIndexArray.get(ze),Ve=null;f.loadMatchingFeature(ne,Pe.bucketIndex,Pe.sourceLayerIndex,Pe.featureIndex,k,m.layers,m.availableImages,t,i,l,function(Ye,vt,it){return Ve||(Ve=ni(Ye)),vt.queryIntersectsFeature(I,Ye,it,Ve,f.z,e.transform,x,e.pixelPosMatrix)})}},be=0;be<B.length;be++)me(be);return ne},Mo.prototype.loadMatchingFeature=function(e,t,i,l,f,m,x,k,I,A,C){var B=this.bucketLayerIDs[t];if(!m||function(Ye,vt){for(var it=0;it<Ye.length;it++)if(vt.indexOf(Ye[it])>=0)return!0;return!1}(m,B)){var U=this.sourceLayerCoder.decode(i),Z=this.vtLayers[U].feature(l);if(f.needGeometry){var Q=mi(Z,!0);if(!f.filter(new ur(this.tileID.overscaledZ),Q,this.tileID.canonical))return}else if(!f.filter(new ur(this.tileID.overscaledZ),Z))return;for(var ee=this.getId(Z,U),ce=0;ce<B.length;ce++){var ne=B[ce];if(!(m&&m.indexOf(ne)<0)){var me=k[ne];if(me){var be={};ee!==void 0&&A&&(be=A.getState(me.sourceLayer||"_geojsonTileLayer",ee));var Se=xe({},I[ne]);Se.paint=Gf(Se.paint,me.paint,Z,be,x),Se.layout=Gf(Se.layout,me.layout,Z,be,x);var ze=!C||C(Z,me,be);if(ze){var Pe=new Xc(Z,this.z,this.x,this.y,ee);Pe.layer=Se;var Ve=e[ne];Ve===void 0&&(Ve=e[ne]=[]),Ve.push({featureIndex:l,feature:Pe,intersectionZ:ze})}}}}}},Mo.prototype.lookupSymbolFeatures=function(e,t,i,l,f,m,x,k){var I={};this.loadVTLayers();for(var A=Ks(f),C=0,B=e;C<B.length;C+=1)this.loadMatchingFeature(I,i,l,B[C],A,m,x,k,t);return I},Mo.prototype.hasLayer=function(e){for(var t=0,i=this.bucketLayerIDs;t<i.length;t+=1)for(var l=0,f=i[t];l<f.length;l+=1)if(e===f[l])return!0;return!1},Mo.prototype.getId=function(e,t){var i=e.id;return this.promoteId&&typeof(i=e.properties[typeof this.promoteId=="string"?this.promoteId:this.promoteId[t]])=="boolean"&&(i=Number(i)),i},ut("FeatureIndex",Mo,{omit:["rawTileData","sourceLayerCoder"]});var Wi=function(e,t){this.tileID=e,this.uid=$e(),this.uses=0,this.tileSize=t,this.buckets={},this.expirationTime=null,this.queryPadding=0,this.hasSymbolBuckets=!1,this.hasRTLText=!1,this.dependencies={},this.expiredRequestCount=0,this.state="loading"};Wi.prototype.registerFadeDuration=function(e){var t=e+this.timeAdded;t<ti.now()||this.fadeEndTime&&t<this.fadeEndTime||(this.fadeEndTime=t)},Wi.prototype.wasRequested=function(){return this.state==="errored"||this.state==="loaded"||this.state==="reloading"},Wi.prototype.loadVectorData=function(e,t,i){if(this.hasData()&&this.unloadVectorData(),this.state="loaded",e){for(var l in e.featureIndex&&(this.latestFeatureIndex=e.featureIndex,e.rawTileData?(this.latestRawTileData=e.rawTileData,this.latestFeatureIndex.rawTileData=e.rawTileData):this.latestRawTileData&&(this.latestFeatureIndex.rawTileData=this.latestRawTileData)),this.collisionBoxArray=e.collisionBoxArray,this.buckets=function(A,C){var B={};if(!C)return B;for(var U=function(){var ee=Q[Z],ce=ee.layerIds.map(function(be){return C.getLayer(be)}).filter(Boolean);if(ce.length!==0){ee.layers=ce,ee.stateDependentLayerIds&&(ee.stateDependentLayers=ee.stateDependentLayerIds.map(function(be){return ce.filter(function(Se){return Se.id===be})[0]}));for(var ne=0,me=ce;ne<me.length;ne+=1)B[me[ne].id]=ee}},Z=0,Q=A;Z<Q.length;Z+=1)U();return B}(e.buckets,t.style),this.hasSymbolBuckets=!1,this.buckets){var f=this.buckets[l];if(f instanceof Br){if(this.hasSymbolBuckets=!0,!i)break;f.justReloaded=!0}}if(this.hasRTLText=!1,this.hasSymbolBuckets)for(var m in this.buckets){var x=this.buckets[m];if(x instanceof Br&&x.hasRTLText){this.hasRTLText=!0,ta.isLoading()||ta.isLoaded()||iu()!=="deferred"||ma();break}}for(var k in this.queryPadding=0,this.buckets){var I=this.buckets[k];this.queryPadding=Math.max(this.queryPadding,t.style.getLayer(k).queryRadius(I))}e.imageAtlas&&(this.imageAtlas=e.imageAtlas),e.glyphAtlasImage&&(this.glyphAtlasImage=e.glyphAtlasImage)}else this.collisionBoxArray=new s},Wi.prototype.unloadVectorData=function(){for(var e in this.buckets)this.buckets[e].destroy();this.buckets={},this.imageAtlasTexture&&this.imageAtlasTexture.destroy(),this.imageAtlas&&(this.imageAtlas=null),this.glyphAtlasTexture&&this.glyphAtlasTexture.destroy(),this.latestFeatureIndex=null,this.state="unloaded"},Wi.prototype.getBucket=function(e){return this.buckets[e.id]},Wi.prototype.upload=function(e){for(var t in this.buckets){var i=this.buckets[t];i.uploadPending()&&i.upload(e)}var l=e.gl;this.imageAtlas&&!this.imageAtlas.uploaded&&(this.imageAtlasTexture=new Ps(e,this.imageAtlas.image,l.RGBA),this.imageAtlas.uploaded=!0),this.glyphAtlasImage&&(this.glyphAtlasTexture=new Ps(e,this.glyphAtlasImage,l.ALPHA),this.glyphAtlasImage=null)},Wi.prototype.prepare=function(e){this.imageAtlas&&this.imageAtlas.patchUpdatedImages(e,this.imageAtlasTexture)},Wi.prototype.queryRenderedFeatures=function(e,t,i,l,f,m,x,k,I,A){return this.latestFeatureIndex&&this.latestFeatureIndex.rawTileData?this.latestFeatureIndex.query({queryGeometry:l,cameraQueryGeometry:f,scale:m,tileSize:this.tileSize,pixelPosMatrix:A,transform:k,params:x,queryPadding:this.queryPadding*I},e,t,i):{}},Wi.prototype.querySourceFeatures=function(e,t){var i=this.latestFeatureIndex;if(i&&i.rawTileData){var l=i.loadVTLayers(),f=t?t.sourceLayer:"",m=l._geojsonTileLayer||l[f];if(m)for(var x=Ks(t&&t.filter),k=this.tileID.canonical,I=k.z,A=k.x,C=k.y,B={z:I,x:A,y:C},U=0;U<m.length;U++){var Z=m.feature(U);if(x.needGeometry){var Q=mi(Z,!0);if(!x.filter(new ur(this.tileID.overscaledZ),Q,this.tileID.canonical))continue}else if(!x.filter(new ur(this.tileID.overscaledZ),Z))continue;var ee=i.getId(Z,f),ce=new Xc(Z,I,A,C,ee);ce.tile=B,e.push(ce)}}},Wi.prototype.hasData=function(){return this.state==="loaded"||this.state==="reloading"||this.state==="expired"},Wi.prototype.patternsLoaded=function(){return this.imageAtlas&&!!Object.keys(this.imageAtlas.patternPositions).length},Wi.prototype.setExpiryData=function(e){var t=this.expirationTime;if(e.cacheControl){var i=gt(e.cacheControl);i["max-age"]&&(this.expirationTime=Date.now()+1e3*i["max-age"])}else e.expires&&(this.expirationTime=new Date(e.expires).getTime());if(this.expirationTime){var l=Date.now(),f=!1;if(this.expirationTime>l)f=!1;else if(t)if(this.expirationTime<t)f=!0;else{var m=this.expirationTime-t;m?this.expirationTime=l+Math.max(m,3e4):f=!0}else f=!0;f?(this.expiredRequestCount++,this.state="expired"):this.expiredRequestCount=0}},Wi.prototype.getExpiryTimeout=function(){if(this.expirationTime)return this.expiredRequestCount?1e3*(1<<Math.min(this.expiredRequestCount-1,31)):Math.min(this.expirationTime-new Date().getTime(),Math.pow(2,31)-1)},Wi.prototype.setFeatureState=function(e,t){if(this.latestFeatureIndex&&this.latestFeatureIndex.rawTileData&&Object.keys(e).length!==0){var i=this.latestFeatureIndex.loadVTLayers();for(var l in this.buckets)if(t.style.hasLayer(l)){var f=this.buckets[l],m=f.layers[0].sourceLayer||"_geojsonTileLayer",x=i[m],k=e[m];if(x&&k&&Object.keys(k).length!==0){f.update(k,x,this.imageAtlas&&this.imageAtlas.patternPositions||{});var I=t&&t.style&&t.style.getLayer(l);I&&(this.queryPadding=Math.max(this.queryPadding,I.queryRadius(f)))}}}},Wi.prototype.holdingForFade=function(){return this.symbolFadeHoldUntil!==void 0},Wi.prototype.symbolFadeFinished=function(){return!this.symbolFadeHoldUntil||this.symbolFadeHoldUntil<ti.now()},Wi.prototype.clearFadeHold=function(){this.symbolFadeHoldUntil=void 0},Wi.prototype.setHoldDuration=function(e){this.symbolFadeHoldUntil=ti.now()+e},Wi.prototype.setDependencies=function(e,t){for(var i={},l=0,f=t;l<f.length;l+=1)i[f[l]]=!0;this.dependencies[e]=i},Wi.prototype.hasDependency=function(e,t){for(var i=0,l=e;i<l.length;i+=1){var f=this.dependencies[l[i]];if(f){for(var m=0,x=t;m<x.length;m+=1)if(f[x[m]])return!0}}return!1};var Qo=D.performance,Xf=function(e){this._marks={start:[e.url,"start"].join("#"),end:[e.url,"end"].join("#"),measure:e.url.toString()},Qo.mark(this._marks.start)};Xf.prototype.finish=function(){Qo.mark(this._marks.end);var e=Qo.getEntriesByName(this._marks.measure);return e.length===0&&(Qo.measure(this._marks.measure,this._marks.start,this._marks.end),e=Qo.getEntriesByName(this._marks.measure),Qo.clearMarks(this._marks.start),Qo.clearMarks(this._marks.end),Qo.clearMeasures(this._marks.measure)),e},a.Actor=_l,a.AlphaImage=As,a.CanonicalTileID=Ms,a.CollisionBoxArray=s,a.Color=ar,a.DEMData=Co,a.DataConstantProperty=xt,a.DictionaryCoder=Kc,a.EXTENT=8192,a.ErrorEvent=se,a.EvaluationParameters=ur,a.Event=$,a.Evented=he,a.FeatureIndex=Mo,a.FillBucket=Ra,a.FillExtrusionBucket=Ba,a.ImageAtlas=_u,a.ImagePosition=Oc,a.LineBucket=Rn,a.LngLat=Yr,a.LngLatBounds=Ai,a.MercatorCoordinate=Cs,a.ONE_EM=24,a.OverscaledTileID=Pi,a.Point=F,a.Point$1=F,a.Properties=an,a.Protobuf=Rc,a.RGBAImage=Hn,a.RequestManager=Kr,a.RequestPerformance=Xf,a.ResourceType=tn,a.SegmentVector=K,a.SourceFeatureState=vl,a.StructArrayLayout1ui2=uu,a.StructArrayLayout2f1f2i16=zo,a.StructArrayLayout2i4=To,a.StructArrayLayout3ui6=Ja,a.StructArrayLayout4i8=au,a.SymbolBucket=Br,a.Texture=Ps,a.Tile=Wi,a.Transitionable=nn,a.Uniform1f=Ke,a.Uniform1i=Re,a.Uniform2f=Ze,a.Uniform3f=ot,a.Uniform4f=wt,a.UniformColor=Tt,a.UniformMatrix4f=_r,a.UnwrappedTileID=Zf,a.ValidationError=J,a.WritingMode=la,a.ZoomHistory=$l,a.add=function(e,t,i){return e[0]=t[0]+i[0],e[1]=t[1]+i[1],e[2]=t[2]+i[2],e},a.addDynamicAttributes=hp,a.asyncAll=function(e,t,i){if(!e.length)return i(null,[]);var l=e.length,f=new Array(e.length),m=null;e.forEach(function(x,k){t(x,function(I,A){I&&(m=I),f[k]=A,--l==0&&i(m,f)})})},a.bezier=ie,a.bindAll=ct,a.browser=ti,a.cacheEntryPossiblyAdded=function(e){++Vi>en&&(e.getActor().send("enforceCacheSizeLimit",Cn),Vi=0)},a.clamp=fe,a.clearTileCache=function(e){var t=D.caches.delete("mapbox-tiles");e&&t.catch(e).then(function(){return e()})},a.clipLine=If,a.clone=function(e){var t=new Er(16);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t},a.clone$1=pt,a.clone$2=function(e){var t=new Er(3);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t},a.collisionCircleLayout=cg,a.config=Wt,a.create=function(){var e=new Er(16);return Er!=Float32Array&&(e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[11]=0,e[12]=0,e[13]=0,e[14]=0),e[0]=1,e[5]=1,e[10]=1,e[15]=1,e},a.create$1=function(){var e=new Er(9);return Er!=Float32Array&&(e[1]=0,e[2]=0,e[3]=0,e[5]=0,e[6]=0,e[7]=0),e[0]=1,e[4]=1,e[8]=1,e},a.create$2=function(){var e=new Er(4);return Er!=Float32Array&&(e[1]=0,e[2]=0),e[0]=1,e[3]=1,e},a.createCommonjsModule=T,a.createExpression=Zs,a.createLayout=Ki,a.createStyleLayer=function(e){return e.type==="custom"?new jg(e):new qg[e.type](e)},a.cross=function(e,t,i){var l=t[0],f=t[1],m=t[2],x=i[0],k=i[1],I=i[2];return e[0]=f*I-m*k,e[1]=m*x-l*I,e[2]=l*k-f*x,e},a.deepEqual=function e(t,i){if(Array.isArray(t)){if(!Array.isArray(i)||t.length!==i.length)return!1;for(var l=0;l<t.length;l++)if(!e(t[l],i[l]))return!1;return!0}if(typeof t=="object"&&t!==null&&i!==null){if(typeof i!="object"||Object.keys(t).length!==Object.keys(i).length)return!1;for(var f in t)if(!e(t[f],i[f]))return!1;return!0}return t===i},a.dot=function(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]},a.dot$1=function(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]+e[3]*t[3]},a.ease=de,a.emitValidationErrors=vs,a.endsWith=Ue,a.enforceCacheSizeLimit=function(e){Mn(),ri&&ri.then(function(t){t.keys().then(function(i){for(var l=0;l<i.length-e;l++)t.delete(i[l])})})},a.evaluateSizeForFeature=wf,a.evaluateSizeForZoom=Sf,a.evaluateVariableOffset=Cf,a.evented=ru,a.extend=xe,a.featureFilter=Ks,a.filterObject=_t,a.fromRotation=function(e,t){var i=Math.sin(t),l=Math.cos(t);return e[0]=l,e[1]=i,e[2]=0,e[3]=-i,e[4]=l,e[5]=0,e[6]=0,e[7]=0,e[8]=1,e},a.getAnchorAlignment=sp,a.getAnchorJustification=cp,a.getArrayBuffer=oi,a.getImage=N,a.getJSON=function(e,t){return bn(xe(e,{type:"json"}),t)},a.getRTLTextPluginStatus=iu,a.getReferrer=vn,a.getVideo=function(e,t){var i,l,f=D.document.createElement("video");f.muted=!0,f.onloadstart=function(){t(null,f)};for(var m=0;m<e.length;m++){var x=D.document.createElement("source");i=e[m],l=void 0,(l=D.document.createElement("a")).href=i,(l.protocol!==D.document.location.protocol||l.host!==D.document.location.host)&&(f.crossOrigin="Anonymous"),x.src=e[m],f.appendChild(x)}return{cancel:function(){}}},a.identity=ra,a.invert=function(e,t){var i=t[0],l=t[1],f=t[2],m=t[3],x=t[4],k=t[5],I=t[6],A=t[7],C=t[8],B=t[9],U=t[10],Z=t[11],Q=t[12],ee=t[13],ce=t[14],ne=t[15],me=i*k-l*x,be=i*I-f*x,Se=i*A-m*x,ze=l*I-f*k,Pe=l*A-m*k,Ve=f*A-m*I,Ye=C*ee-B*Q,vt=C*ce-U*Q,it=C*ne-Z*Q,St=B*ce-U*ee,nt=B*ne-Z*ee,Qt=U*ne-Z*ce,Rt=me*Qt-be*nt+Se*St+ze*it-Pe*vt+Ve*Ye;return Rt?(e[0]=(k*Qt-I*nt+A*St)*(Rt=1/Rt),e[1]=(f*nt-l*Qt-m*St)*Rt,e[2]=(ee*Ve-ce*Pe+ne*ze)*Rt,e[3]=(U*Pe-B*Ve-Z*ze)*Rt,e[4]=(I*it-x*Qt-A*vt)*Rt,e[5]=(i*Qt-f*it+m*vt)*Rt,e[6]=(ce*Se-Q*Ve-ne*be)*Rt,e[7]=(C*Ve-U*Se+Z*be)*Rt,e[8]=(x*nt-k*it+A*Ye)*Rt,e[9]=(l*it-i*nt-m*Ye)*Rt,e[10]=(Q*Pe-ee*Se+ne*me)*Rt,e[11]=(B*Se-C*Pe-Z*me)*Rt,e[12]=(k*vt-x*St-I*Ye)*Rt,e[13]=(i*St-l*vt+f*Ye)*Rt,e[14]=(ee*be-Q*ze-ce*me)*Rt,e[15]=(C*ze-B*be+U*me)*Rt,e):null},a.isChar=et,a.isMapboxURL=hr,a.keysDifference=function(e,t){var i=[];for(var l in e)l in t||i.push(l);return i},a.makeRequest=bn,a.mapObject=ht,a.mercatorXfromLng=Vf,a.mercatorYfromLat=jf,a.mercatorZfromAltitude=qf,a.mul=Hh,a.multiply=Ln,a.mvt=ul,a.nextPowerOfTwo=function(e){return e<=1?1:Math.pow(2,Math.ceil(Math.log(e)/Math.LN2))},a.normalize=function(e,t){var i=t[0],l=t[1],f=t[2],m=i*i+l*l+f*f;return m>0&&(m=1/Math.sqrt(m)),e[0]=t[0]*m,e[1]=t[1]*m,e[2]=t[2]*m,e},a.number=xi,a.offscreenCanvasSupported=Fn,a.ortho=function(e,t,i,l,f,m,x){var k=1/(t-i),I=1/(l-f),A=1/(m-x);return e[0]=-2*k,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=-2*I,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=2*A,e[11]=0,e[12]=(t+i)*k,e[13]=(f+l)*I,e[14]=(x+m)*A,e[15]=1,e},a.parseGlyphPBF=function(e){return new Rc(e).readFields(xg,[])},a.pbf=Rc,a.performSymbolLayout=function(e,t,i,l,f,m,x){e.createArrays(),e.tilePixelRatio=8192/(512*e.overscaling),e.compareText={},e.iconsNeedLinear=!1;var k=e.layers[0].layout,I=e.layers[0]._unevaluatedLayout._values,A={};if(e.textSizeData.kind==="composite"){var C=e.textSizeData,B=C.maxZoom;A.compositeTextSizes=[I["text-size"].possiblyEvaluate(new ur(C.minZoom),x),I["text-size"].possiblyEvaluate(new ur(B),x)]}if(e.iconSizeData.kind==="composite"){var U=e.iconSizeData,Z=U.maxZoom;A.compositeIconSizes=[I["icon-size"].possiblyEvaluate(new ur(U.minZoom),x),I["icon-size"].possiblyEvaluate(new ur(Z),x)]}A.layoutTextSize=I["text-size"].possiblyEvaluate(new ur(e.zoom+1),x),A.layoutIconSize=I["icon-size"].possiblyEvaluate(new ur(e.zoom+1),x),A.textMaxSize=I["text-size"].possiblyEvaluate(new ur(18));for(var Q=24*k.get("text-line-height"),ee=k.get("text-rotation-alignment")==="map"&&k.get("symbol-placement")!=="point",ce=k.get("text-keep-upright"),ne=k.get("text-size"),me=function(){var ze=Se[be],Pe=k.get("text-font").evaluate(ze,{},x).join(","),Ve=ne.evaluate(ze,{},x),Ye=A.layoutTextSize.evaluate(ze,{},x),vt=A.layoutIconSize.evaluate(ze,{},x),it={horizontal:{},vertical:void 0},St=ze.text,nt=[0,0];if(St){var Qt=St.toString(),Rt=24*k.get("text-letter-spacing").evaluate(ze,{},x),dt=function(pr){for(var Fr=0,Dr=pr;Fr<Dr.length;Fr+=1)if(vr=Dr[Fr].charCodeAt(0),et.Arabic(vr)||et["Arabic Supplement"](vr)||et["Arabic Extended-A"](vr)||et["Arabic Presentation Forms-A"](vr)||et["Arabic Presentation Forms-B"](vr))return!1;var vr;return!0}(Qt)?Rt:0,or=k.get("text-anchor").evaluate(ze,{},x),Kt=k.get("text-variable-anchor");if(!Kt){var gr=k.get("text-radial-offset").evaluate(ze,{},x);nt=gr?Cf(or,[24*gr,up]):k.get("text-offset").evaluate(ze,{},x).map(function(pr){return 24*pr})}var kt=ee?"center":k.get("text-justify").evaluate(ze,{},x),Sr=k.get("symbol-placement"),Qr=Sr==="point"?24*k.get("text-max-width").evaluate(ze,{},x):0,ci=function(){e.allowVerticalPlacement&&eu(Qt)&&(it.vertical=Fc(St,t,i,f,Pe,Qr,Q,or,"left",dt,nt,la.vertical,!0,Sr,Ye,Ve))};if(!ee&&Kt){for(var ai=kt==="auto"?Kt.map(function(pr){return cp(pr)}):[kt],$r=!1,hi=0;hi<ai.length;hi++){var Bi=ai[hi];if(!it.horizontal[Bi])if($r)it.horizontal[Bi]=it.horizontal[0];else{var Oi=Fc(St,t,i,f,Pe,Qr,Q,"center",Bi,dt,nt,la.horizontal,!1,Sr,Ye,Ve);Oi&&(it.horizontal[Bi]=Oi,$r=Oi.positionedLines.length===1)}}ci()}else{kt==="auto"&&(kt=cp(or));var Tn=Fc(St,t,i,f,Pe,Qr,Q,or,kt,dt,nt,la.horizontal,!1,Sr,Ye,Ve);Tn&&(it.horizontal[kt]=Tn),ci(),eu(Qt)&&ee&&ce&&(it.vertical=Fc(St,t,i,f,Pe,Qr,Q,or,kt,dt,nt,la.vertical,!1,Sr,Ye,Ve))}}var Hi=void 0,zn=!1;if(ze.icon&&ze.icon.name){var yi=l[ze.icon.name];yi&&(Hi=function(pr,Fr,Dr){var vr=sp(Dr),Bn=Fr[0]-pr.displaySize[0]*vr.horizontalAlign,fn=Fr[1]-pr.displaySize[1]*vr.verticalAlign;return{image:pr,top:fn,bottom:fn+pr.displaySize[1],left:Bn,right:Bn+pr.displaySize[0]}}(f[ze.icon.name],k.get("icon-offset").evaluate(ze,{},x),k.get("icon-anchor").evaluate(ze,{},x)),zn=yi.sdf,e.sdfIcons===void 0?e.sdfIcons=yi.sdf:e.sdfIcons!==yi.sdf&&bt("Style sheet warning: Cannot mix SDF and non-SDF icons in one buffer"),(yi.pixelRatio!==e.pixelRatio||k.get("icon-rotate").constantOr(1)!==0)&&(e.iconsNeedLinear=!0))}var Ji=Df(it.horizontal)||it.vertical;e.iconsInText=!!Ji&&Ji.iconsInText,(Ji||Hi)&&function(pr,Fr,Dr,vr,Bn,fn,Hr,Si,dn,kr,ro){var ua=fn.textMaxSize.evaluate(Fr,{});ua===void 0&&(ua=Hr);var io,gi=pr.layers[0].layout,no=gi.get("icon-offset").evaluate(Fr,{},ro),Pa=Df(Dr.horizontal),bl=Hr/24,Ds=pr.tilePixelRatio*bl,xl=pr.tilePixelRatio*ua/24,Do=pr.tilePixelRatio*Si,wl=pr.tilePixelRatio*gi.get("symbol-spacing"),Wc=gi.get("text-padding")*pr.tilePixelRatio,Sl=gi.get("icon-padding")*pr.tilePixelRatio,xu=gi.get("text-max-angle")/180*Math.PI,Hc=gi.get("text-rotation-alignment")==="map"&&gi.get("symbol-placement")!=="point",Jc=gi.get("icon-rotation-alignment")==="map"&&gi.get("symbol-placement")!=="point",Lo=gi.get("symbol-placement"),wu=wl/2,kl=gi.get("icon-text-fit");vr&&kl!=="none"&&(pr.allowVerticalPlacement&&Dr.vertical&&(io=xf(vr,Dr.vertical,kl,gi.get("icon-text-fit-padding"),no,bl)),Pa&&(vr=xf(vr,Pa,kl,gi.get("icon-text-fit-padding"),no,bl)));var $o=function(Gg,Pu){Pu.x<0||Pu.x>=8192||Pu.y<0||Pu.y>=8192||function(_i,Oa,Kg,es,vp,Jf,rh,ao,ih,Cu,nh,ah,bp,Yf,Mu,Qf,$f,ed,td,rd,ca,oh,id,oo,Xg){var nd,Rs,Al,Pl,Cl,Ml=_i.addToLineVertexArray(Oa,Kg),ad=0,od=0,sd=0,ld=0,xp=-1,wp=-1,Ro={},ud=Y(""),Sp=0,kp=0;if(ao._unevaluatedLayout.getValue("text-radial-offset")===void 0?(Sp=(nd=ao.layout.get("text-offset").evaluate(ca,{},oo).map(function(Lu){return 24*Lu}))[0],kp=nd[1]):(Sp=24*ao.layout.get("text-radial-offset").evaluate(ca,{},oo),kp=up),_i.allowVerticalPlacement&&es.vertical){var cd=ao.layout.get("text-rotate").evaluate(ca,{},oo)+90;Pl=new qc(ih,Oa,Cu,nh,ah,es.vertical,bp,Yf,Mu,cd),rh&&(Cl=new qc(ih,Oa,Cu,nh,ah,rh,$f,ed,Mu,cd))}if(vp){var Ep=ao.layout.get("icon-rotate").evaluate(ca,{}),hd=ao.layout.get("icon-text-fit")!=="none",pd=Af(vp,Ep,id,hd),Tp=rh?Af(rh,Ep,id,hd):void 0;Al=new qc(ih,Oa,Cu,nh,ah,vp,$f,ed,!1,Ep),ad=4*pd.length;var fd=_i.iconSizeData,Du=null;fd.kind==="source"?(Du=[128*ao.layout.get("icon-size").evaluate(ca,{})])[0]>32640&&bt(_i.layerIds[0]+': Value for "icon-size" is >= 255. Reduce your "icon-size".'):fd.kind==="composite"&&((Du=[128*oh.compositeIconSizes[0].evaluate(ca,{},oo),128*oh.compositeIconSizes[1].evaluate(ca,{},oo)])[0]>32640||Du[1]>32640)&&bt(_i.layerIds[0]+': Value for "icon-size" is >= 255. Reduce your "icon-size".'),_i.addSymbols(_i.icon,pd,Du,rd,td,ca,!1,Oa,Ml.lineStartIndex,Ml.lineLength,-1,oo),xp=_i.icon.placedSymbolArray.length-1,Tp&&(od=4*Tp.length,_i.addSymbols(_i.icon,Tp,Du,rd,td,ca,la.vertical,Oa,Ml.lineStartIndex,Ml.lineLength,-1,oo),wp=_i.icon.placedSymbolArray.length-1)}for(var dd in es.horizontal){var sh=es.horizontal[dd];if(!Rs){ud=Y(sh.text);var Wg=ao.layout.get("text-rotate").evaluate(ca,{},oo);Rs=new qc(ih,Oa,Cu,nh,ah,sh,bp,Yf,Mu,Wg)}var md=sh.positionedLines.length===1;if(sd+=Mf(_i,Oa,sh,Jf,ao,Mu,ca,Qf,Ml,es.vertical?la.horizontal:la.horizontalOnly,md?Object.keys(es.horizontal):[dd],Ro,xp,oh,oo),md)break}es.vertical&&(ld+=Mf(_i,Oa,es.vertical,Jf,ao,Mu,ca,Qf,Ml,la.vertical,["vertical"],Ro,wp,oh,oo));var Hg=Rs?Rs.boxStartIndex:_i.collisionBoxArray.length,Jg=Rs?Rs.boxEndIndex:_i.collisionBoxArray.length,Yg=Pl?Pl.boxStartIndex:_i.collisionBoxArray.length,Qg=Pl?Pl.boxEndIndex:_i.collisionBoxArray.length,$g=Al?Al.boxStartIndex:_i.collisionBoxArray.length,e_=Al?Al.boxEndIndex:_i.collisionBoxArray.length,t_=Cl?Cl.boxStartIndex:_i.collisionBoxArray.length,r_=Cl?Cl.boxEndIndex:_i.collisionBoxArray.length,so=-1,lh=function(Lu,gd){return Lu&&Lu.circleDiameter?Math.max(Lu.circleDiameter,gd):gd};so=lh(Rs,so),so=lh(Pl,so),so=lh(Al,so);var yd=(so=lh(Cl,so))>-1?1:0;yd&&(so*=Xg/24),_i.glyphOffsetArray.length>=Br.MAX_GLYPHS&&bt("Too many glyphs being rendered in a tile. See https://github.com/mapbox/mapbox-gl-js/issues/2907"),ca.sortKey!==void 0&&_i.addToSortKeyRanges(_i.symbolInstances.length,ca.sortKey),_i.symbolInstances.emplaceBack(Oa.x,Oa.y,Ro.right>=0?Ro.right:-1,Ro.center>=0?Ro.center:-1,Ro.left>=0?Ro.left:-1,Ro.vertical||-1,xp,wp,ud,Hg,Jg,Yg,Qg,$g,e_,t_,r_,Cu,sd,ld,ad,od,yd,0,bp,Sp,kp,so)}(pr,Pu,Gg,Dr,vr,Bn,io,pr.layers[0],pr.collisionBoxArray,Fr.index,Fr.sourceLayerIndex,pr.index,Ds,Wc,Hc,dn,Do,Sl,Jc,no,Fr,fn,kr,ro,Hr)};if(Lo==="line")for(var El=0,Yc=If(Fr.geometry,0,0,8192,8192);El<Yc.length;El+=1)for(var Qc=Yc[El],Su=0,ku=Ig(Qc,wl,xu,Dr.vertical||Pa,vr,24,xl,pr.overscaling,8192);Su<ku.length;Su+=1){var $c=ku[Su];Pa&&Mg(pr,Pa.text,wu,$c)||$o(Qc,$c)}else if(Lo==="line-center")for(var Eu=0,Tu=Fr.geometry;Eu<Tu.length;Eu+=1){var zu=Tu[Eu];if(zu.length>1){var eh=zg(zu,xu,Dr.vertical||Pa,vr,24,xl);eh&&$o(zu,eh)}}else if(Fr.type==="Polygon")for(var Tl=0,th=rp(Fr.geometry,0);Tl<th.length;Tl+=1){var zl=th[Tl],Iu=Pg(zl,16);$o(zl[0],new fl(Iu.x,Iu.y,0))}else if(Fr.type==="LineString")for(var Ls=0,Au=Fr.geometry;Ls<Au.length;Ls+=1){var Il=Au[Ls];$o(Il,new fl(Il[0].x,Il[0].y,0))}else if(Fr.type==="Point")for(var yp=0,Wf=Fr.geometry;yp<Wf.length;yp+=1)for(var gp=0,Hf=Wf[yp];gp<Hf.length;gp+=1){var _p=Hf[gp];$o([_p],new fl(_p.x,_p.y,0))}}(e,ze,it,Hi,l,A,Ye,vt,nt,zn,x)},be=0,Se=e.features;be<Se.length;be+=1)me();m&&e.generateCollisionDebugBuffers()},a.perspective=function(e,t,i,l,f){var m,x=1/Math.tan(t/2);return e[0]=x/i,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=x,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[11]=-1,e[12]=0,e[13]=0,e[15]=0,f!=null&&f!==1/0?(e[10]=(f+l)*(m=1/(l-f)),e[14]=2*f*l*m):(e[10]=-1,e[14]=-2*l),e},a.pick=function(e,t){for(var i={},l=0;l<t.length;l++){var f=t[l];f in e&&(i[f]=e[f])}return i},a.plugin=ta,a.polygonIntersectsPolygon=$a,a.postMapLoadEvent=Ni,a.postTurnstileEvent=$i,a.potpack=gf,a.refProperties=["type","source","source-layer","minzoom","maxzoom","filter","layout"],a.register=ut,a.registerForPluginStateChange=function(e){return e({pluginStatus:Kn,pluginURL:Ma}),ru.on("pluginStateChange",e),e},a.renderColorRamp=Yp,a.rotate=function(e,t,i){var l=t[0],f=t[1],m=t[2],x=t[3],k=Math.sin(i),I=Math.cos(i);return e[0]=l*I+m*k,e[1]=f*I+x*k,e[2]=l*-k+m*I,e[3]=f*-k+x*I,e},a.rotateX=function(e,t,i){var l=Math.sin(i),f=Math.cos(i),m=t[4],x=t[5],k=t[6],I=t[7],A=t[8],C=t[9],B=t[10],U=t[11];return t!==e&&(e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e[4]=m*f+A*l,e[5]=x*f+C*l,e[6]=k*f+B*l,e[7]=I*f+U*l,e[8]=A*f-m*l,e[9]=C*f-x*l,e[10]=B*f-k*l,e[11]=U*f-I*l,e},a.rotateZ=function(e,t,i){var l=Math.sin(i),f=Math.cos(i),m=t[0],x=t[1],k=t[2],I=t[3],A=t[4],C=t[5],B=t[6],U=t[7];return t!==e&&(e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e[0]=m*f+A*l,e[1]=x*f+C*l,e[2]=k*f+B*l,e[3]=I*f+U*l,e[4]=A*f-m*l,e[5]=C*f-x*l,e[6]=B*f-k*l,e[7]=U*f-I*l,e},a.scale=function(e,t,i){var l=i[0],f=i[1],m=i[2];return e[0]=t[0]*l,e[1]=t[1]*l,e[2]=t[2]*l,e[3]=t[3]*l,e[4]=t[4]*f,e[5]=t[5]*f,e[6]=t[6]*f,e[7]=t[7]*f,e[8]=t[8]*m,e[9]=t[9]*m,e[10]=t[10]*m,e[11]=t[11]*m,e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15],e},a.scale$1=function(e,t,i){return e[0]=t[0]*i,e[1]=t[1]*i,e[2]=t[2]*i,e[3]=t[3]*i,e},a.scale$2=function(e,t,i){return e[0]=t[0]*i,e[1]=t[1]*i,e[2]=t[2]*i,e},a.setCacheLimits=function(e,t){Cn=e,en=t},a.setRTLTextPlugin=function(e,t,i){if(i===void 0&&(i=!1),Kn==="deferred"||Kn==="loading"||Kn==="loaded")throw new Error("setRTLTextPlugin cannot be called multiple times.");Ma=ti.resolveURL(e),Kn="deferred",$s=t,xs(),i||ma()},a.sphericalToCartesian=function(e){var t=e[0],i=e[1],l=e[2];return i+=90,i*=Math.PI/180,l*=Math.PI/180,{x:t*Math.cos(i)*Math.sin(l),y:t*Math.sin(i)*Math.sin(l),z:t*Math.cos(l)}},a.sqrLen=function(e){var t=e[0],i=e[1];return t*t+i*i},a.styleSpec=j,a.sub=function(e,t,i){return e[0]=t[0]-i[0],e[1]=t[1]-i[1],e[2]=t[2]-i[2],e},a.symbolSize=Tg,a.transformMat3=function(e,t,i){var l=t[0],f=t[1],m=t[2];return e[0]=l*i[0]+f*i[3]+m*i[6],e[1]=l*i[1]+f*i[4]+m*i[7],e[2]=l*i[2]+f*i[5]+m*i[8],e},a.transformMat4=al,a.translate=function(e,t,i){var l,f,m,x,k,I,A,C,B,U,Z,Q,ee=i[0],ce=i[1],ne=i[2];return t===e?(e[12]=t[0]*ee+t[4]*ce+t[8]*ne+t[12],e[13]=t[1]*ee+t[5]*ce+t[9]*ne+t[13],e[14]=t[2]*ee+t[6]*ce+t[10]*ne+t[14],e[15]=t[3]*ee+t[7]*ce+t[11]*ne+t[15]):(f=t[1],m=t[2],x=t[3],k=t[4],I=t[5],A=t[6],C=t[7],B=t[8],U=t[9],Z=t[10],Q=t[11],e[0]=l=t[0],e[1]=f,e[2]=m,e[3]=x,e[4]=k,e[5]=I,e[6]=A,e[7]=C,e[8]=B,e[9]=U,e[10]=Z,e[11]=Q,e[12]=l*ee+k*ce+B*ne+t[12],e[13]=f*ee+I*ce+U*ne+t[13],e[14]=m*ee+A*ce+Z*ne+t[14],e[15]=x*ee+C*ce+Q*ne+t[15]),e},a.triggerPluginCompletionEvent=Ic,a.uniqueId=$e,a.validateCustomStyleLayer=function(e){var t=[],i=e.id;return i===void 0&&t.push({message:"layers."+i+': missing required property "id"'}),e.render===void 0&&t.push({message:"layers."+i+': missing required method "render"'}),e.renderingMode&&e.renderingMode!=="2d"&&e.renderingMode!=="3d"&&t.push({message:"layers."+i+': property "renderingMode" must be either "2d" or "3d"'}),t},a.validateLight=Xh,a.validateStyle=gs,a.values=function(e){var t=[];for(var i in e)t.push(e[i]);return t},a.vectorTile=ul,a.version="1.13.2",a.warnOnce=bt,a.webpSupported=Gr,a.window=D,a.wrap=we}),v(["./shared"],function(a){function T(L){var N=typeof L;if(N==="number"||N==="boolean"||N==="string"||L==null)return JSON.stringify(L);if(Array.isArray(L)){for(var V="[",W=0,$=L;W<$.length;W+=1)V+=T($[W])+",";return V+"]"}for(var se=Object.keys(L).sort(),he="{",j=0;j<se.length;j++)he+=JSON.stringify(se[j])+":"+T(L[se[j]])+",";return he+"}"}function E(L){for(var N="",V=0,W=a.refProperties;V<W.length;V+=1)N+="/"+T(L[W[V]]);return N}var M=function(L){this.keyCache={},L&&this.replace(L)};M.prototype.replace=function(L){this._layerConfigs={},this._layers={},this.update(L,[])},M.prototype.update=function(L,N){for(var V=this,W=0,$=L;W<$.length;W+=1){var se=$[W];this._layerConfigs[se.id]=se;var he=this._layers[se.id]=a.createStyleLayer(se);he._featureFilter=a.featureFilter(he.filter),this.keyCache[se.id]&&delete this.keyCache[se.id]}for(var j=0,J=N;j<J.length;j+=1){var ge=J[j];delete this.keyCache[ge],delete this._layerConfigs[ge],delete this._layers[ge]}this.familiesBySource={};for(var Ce=0,De=function(Oe,qe){for(var Mt={},je=0;je<Oe.length;je++){var Vt=qe&&qe[Oe[je].id]||E(Oe[je]);qe&&(qe[Oe[je].id]=Vt);var lr=Mt[Vt];lr||(lr=Mt[Vt]=[]),lr.push(Oe[je])}var Dt=[];for(var nr in Mt)Dt.push(Mt[nr]);return Dt}(a.values(this._layerConfigs),this.keyCache);Ce<De.length;Ce+=1){var q=De[Ce].map(function(Oe){return V._layers[Oe.id]}),_e=q[0];if(_e.visibility!=="none"){var tt=_e.source||"",He=this.familiesBySource[tt];He||(He=this.familiesBySource[tt]={});var ke=_e.sourceLayer||"_geojsonTileLayer",Xe=He[ke];Xe||(Xe=He[ke]=[]),Xe.push(q)}}};var F=function(L){var N={},V=[];for(var W in L){var $=L[W],se=N[W]={};for(var he in $){var j=$[+he];if(j&&j.bitmap.width!==0&&j.bitmap.height!==0){var J={x:0,y:0,w:j.bitmap.width+2,h:j.bitmap.height+2};V.push(J),se[he]={rect:J,metrics:j.metrics}}}}var ge=a.potpack(V),Ce=new a.AlphaImage({width:ge.w||1,height:ge.h||1});for(var De in L){var q=L[De];for(var _e in q){var tt=q[+_e];if(tt&&tt.bitmap.width!==0&&tt.bitmap.height!==0){var He=N[De][_e].rect;a.AlphaImage.copy(tt.bitmap,Ce,{x:0,y:0},{x:He.x+1,y:He.y+1},tt.bitmap)}}}this.image=Ce,this.positions=N};a.register("GlyphAtlas",F);var R=function(L){this.tileID=new a.OverscaledTileID(L.tileID.overscaledZ,L.tileID.wrap,L.tileID.canonical.z,L.tileID.canonical.x,L.tileID.canonical.y),this.uid=L.uid,this.zoom=L.zoom,this.pixelRatio=L.pixelRatio,this.tileSize=L.tileSize,this.source=L.source,this.overscaling=this.tileID.overscaleFactor(),this.showCollisionBoxes=L.showCollisionBoxes,this.collectResourceTiming=!!L.collectResourceTiming,this.returnDependencies=!!L.returnDependencies,this.promoteId=L.promoteId};function D(L,N,V){for(var W=new a.EvaluationParameters(N),$=0,se=L;$<se.length;$+=1)se[$].recalculate(W,V)}function H(L,N){var V=a.getArrayBuffer(L.request,function(W,$,se,he){W?N(W):$&&N(null,{vectorTile:new a.vectorTile.VectorTile(new a.pbf($)),rawData:$,cacheControl:se,expires:he})});return function(){V.cancel(),N()}}R.prototype.parse=function(L,N,V,W,$){var se=this;this.status="parsing",this.data=L,this.collisionBoxArray=new a.CollisionBoxArray;var he=new a.DictionaryCoder(Object.keys(L.layers).sort()),j=new a.FeatureIndex(this.tileID,this.promoteId);j.bucketLayerIDs=[];var J,ge,Ce,De,q={},_e={featureIndex:j,iconDependencies:{},patternDependencies:{},glyphDependencies:{},availableImages:V},tt=N.familiesBySource[this.source];for(var He in tt){var ke=L.layers[He];if(ke){ke.version===1&&a.warnOnce('Vector tile source "'+this.source+'" layer "'+He+'" does not use vector tile spec v2 and therefore may have some rendering errors.');for(var Xe=he.encode(He),Oe=[],qe=0;qe<ke.length;qe++){var Mt=ke.feature(qe),je=j.getId(Mt,He);Oe.push({feature:Mt,id:je,index:qe,sourceLayerIndex:Xe})}for(var Vt=0,lr=tt[He];Vt<lr.length;Vt+=1){var Dt=lr[Vt],nr=Dt[0];nr.minzoom&&this.zoom<Math.floor(nr.minzoom)||nr.maxzoom&&this.zoom>=nr.maxzoom||nr.visibility!=="none"&&(D(Dt,this.zoom,V),(q[nr.id]=nr.createBucket({index:j.bucketLayerIDs.length,layers:Dt,zoom:this.zoom,pixelRatio:this.pixelRatio,overscaling:this.overscaling,collisionBoxArray:this.collisionBoxArray,sourceLayerIndex:Xe,sourceID:this.source})).populate(Oe,_e,this.tileID.canonical),j.bucketLayerIDs.push(Dt.map(function(fr){return fr.id})))}}}var Jt=a.mapObject(_e.glyphDependencies,function(fr){return Object.keys(fr).map(Number)});Object.keys(Jt).length?W.send("getGlyphs",{uid:this.uid,stacks:Jt},function(fr,Gt){J||(J=fr,ge=Gt,br.call(se))}):ge={};var ii=Object.keys(_e.iconDependencies);ii.length?W.send("getImages",{icons:ii,source:this.source,tileID:this.tileID,type:"icons"},function(fr,Gt){J||(J=fr,Ce=Gt,br.call(se))}):Ce={};var $t=Object.keys(_e.patternDependencies);function br(){if(J)return $(J);if(ge&&Ce&&De){var fr=new F(ge),Gt=new a.ImageAtlas(Ce,De);for(var ar in q){var si=q[ar];si instanceof a.SymbolBucket?(D(si.layers,this.zoom,V),a.performSymbolLayout(si,ge,fr.positions,Ce,Gt.iconPositions,this.showCollisionBoxes,this.tileID.canonical)):si.hasPattern&&(si instanceof a.LineBucket||si instanceof a.FillBucket||si instanceof a.FillExtrusionBucket)&&(D(si.layers,this.zoom,V),si.addFeatures(_e,this.tileID.canonical,Gt.patternPositions))}this.status="done",$(null,{buckets:a.values(q).filter(function(Nn){return!Nn.isEmpty()}),featureIndex:j,collisionBoxArray:this.collisionBoxArray,glyphAtlasImage:fr.image,imageAtlas:Gt,glyphMap:this.returnDependencies?ge:null,iconMap:this.returnDependencies?Ce:null,glyphPositions:this.returnDependencies?fr.positions:null})}}$t.length?W.send("getImages",{icons:$t,source:this.source,tileID:this.tileID,type:"patterns"},function(fr,Gt){J||(J=fr,De=Gt,br.call(se))}):De={},br.call(this)};var ie=function(L,N,V,W){this.actor=L,this.layerIndex=N,this.availableImages=V,this.loadVectorData=W||H,this.loading={},this.loaded={}};ie.prototype.loadTile=function(L,N){var V=this,W=L.uid;this.loading||(this.loading={});var $=!!(L&&L.request&&L.request.collectResourceTiming)&&new a.RequestPerformance(L.request),se=this.loading[W]=new R(L);se.abort=this.loadVectorData(L,function(he,j){if(delete V.loading[W],he||!j)return se.status="done",V.loaded[W]=se,N(he);var J=j.rawData,ge={};j.expires&&(ge.expires=j.expires),j.cacheControl&&(ge.cacheControl=j.cacheControl);var Ce={};if($){var De=$.finish();De&&(Ce.resourceTiming=JSON.parse(JSON.stringify(De)))}se.vectorTile=j.vectorTile,se.parse(j.vectorTile,V.layerIndex,V.availableImages,V.actor,function(q,_e){if(q||!_e)return N(q);N(null,a.extend({rawTileData:J.slice(0)},_e,ge,Ce))}),V.loaded=V.loaded||{},V.loaded[W]=se})},ie.prototype.reloadTile=function(L,N){var V=this,W=this.loaded,$=L.uid,se=this;if(W&&W[$]){var he=W[$];he.showCollisionBoxes=L.showCollisionBoxes;var j=function(J,ge){var Ce=he.reloadCallback;Ce&&(delete he.reloadCallback,he.parse(he.vectorTile,se.layerIndex,V.availableImages,se.actor,Ce)),N(J,ge)};he.status==="parsing"?he.reloadCallback=j:he.status==="done"&&(he.vectorTile?he.parse(he.vectorTile,this.layerIndex,this.availableImages,this.actor,j):j())}},ie.prototype.abortTile=function(L,N){var V=this.loading,W=L.uid;V&&V[W]&&V[W].abort&&(V[W].abort(),delete V[W]),N()},ie.prototype.removeTile=function(L,N){var V=this.loaded,W=L.uid;V&&V[W]&&delete V[W],N()};var de=a.window.ImageBitmap,fe=function(){this.loaded={}};function we(L,N){if(L.length!==0){xe(L[0],N);for(var V=1;V<L.length;V++)xe(L[V],!N)}}function xe(L,N){for(var V=0,W=0,$=L.length,se=$-1;W<$;se=W++)V+=(L[W][0]-L[se][0])*(L[se][1]+L[W][1]);V>=0!=!!N&&L.reverse()}fe.prototype.loadTile=function(L,N){var V=L.uid,W=L.encoding,$=L.rawImageData,se=de&&$ instanceof de?this.getImageData($):$,he=new a.DEMData(V,se,W);this.loaded=this.loaded||{},this.loaded[V]=he,N(null,he)},fe.prototype.getImageData=function(L){this.offscreenCanvas&&this.offscreenCanvasContext||(this.offscreenCanvas=new OffscreenCanvas(L.width,L.height),this.offscreenCanvasContext=this.offscreenCanvas.getContext("2d")),this.offscreenCanvas.width=L.width,this.offscreenCanvas.height=L.height,this.offscreenCanvasContext.drawImage(L,0,0,L.width,L.height);var N=this.offscreenCanvasContext.getImageData(-1,-1,L.width+2,L.height+2);return this.offscreenCanvasContext.clearRect(0,0,this.offscreenCanvas.width,this.offscreenCanvas.height),new a.RGBAImage({width:N.width,height:N.height},N.data)},fe.prototype.removeTile=function(L){var N=this.loaded,V=L.uid;N&&N[V]&&delete N[V]};var st=a.vectorTile.VectorTileFeature.prototype.toGeoJSON,$e=function(L){this._feature=L,this.extent=a.EXTENT,this.type=L.type,this.properties=L.tags,"id"in L&&!isNaN(L.id)&&(this.id=parseInt(L.id,10))};$e.prototype.loadGeometry=function(){if(this._feature.type===1){for(var L=[],N=0,V=this._feature.geometry;N<V.length;N+=1){var W=V[N];L.push([new a.Point$1(W[0],W[1])])}return L}for(var $=[],se=0,he=this._feature.geometry;se<he.length;se+=1){for(var j=[],J=0,ge=he[se];J<ge.length;J+=1){var Ce=ge[J];j.push(new a.Point$1(Ce[0],Ce[1]))}$.push(j)}return $},$e.prototype.toGeoJSON=function(L,N,V){return st.call(this,L,N,V)};var Me=function(L){this.layers={_geojsonTileLayer:this},this.name="_geojsonTileLayer",this.extent=a.EXTENT,this.length=L.length,this._features=L};Me.prototype.feature=function(L){return new $e(this._features[L])};var Je=a.vectorTile.VectorTileFeature,ct=Ue;function Ue(L,N){this.options=N||{},this.features=L,this.length=L.length}function ht(L,N){this.id=typeof L.id=="number"?L.id:void 0,this.type=L.type,this.rawGeometry=L.type===1?[L.geometry]:L.geometry,this.properties=L.tags,this.extent=N||4096}Ue.prototype.feature=function(L){return new ht(this.features[L],this.options.extent)},ht.prototype.loadGeometry=function(){var L=this.rawGeometry;this.geometry=[];for(var N=0;N<L.length;N++){for(var V=L[N],W=[],$=0;$<V.length;$++)W.push(new a.Point$1(V[$][0],V[$][1]));this.geometry.push(W)}return this.geometry},ht.prototype.bbox=function(){this.geometry||this.loadGeometry();for(var L=this.geometry,N=1/0,V=-1/0,W=1/0,$=-1/0,se=0;se<L.length;se++)for(var he=L[se],j=0;j<he.length;j++){var J=he[j];N=Math.min(N,J.x),V=Math.max(V,J.x),W=Math.min(W,J.y),$=Math.max($,J.y)}return[N,W,V,$]},ht.prototype.toGeoJSON=Je.prototype.toGeoJSON;var _t=Nt,pt=ct;function Nt(L){var N=new a.pbf;return function(V,W){for(var $ in V.layers)W.writeMessage(3,bt,V.layers[$])}(L,N),N.finish()}function bt(L,N){var V;N.writeVarintField(15,L.version||1),N.writeStringField(1,L.name||""),N.writeVarintField(5,L.extent||4096);var W={keys:[],values:[],keycache:{},valuecache:{}};for(V=0;V<L.length;V++)W.feature=L.feature(V),N.writeMessage(2,zt,W);var $=W.keys;for(V=0;V<$.length;V++)N.writeStringField(3,$[V]);var se=W.values;for(V=0;V<se.length;V++)N.writeMessage(4,jt,se[V])}function zt(L,N){var V=L.feature;V.id!==void 0&&N.writeVarintField(1,V.id),N.writeMessage(2,rt,L),N.writeVarintField(3,V.type),N.writeMessage(4,It,V)}function rt(L,N){var V=L.feature,W=L.keys,$=L.values,se=L.keycache,he=L.valuecache;for(var j in V.properties){var J=se[j];J===void 0&&(W.push(j),se[j]=J=W.length-1),N.writeVarint(J);var ge=V.properties[j],Ce=typeof ge;Ce!=="string"&&Ce!=="boolean"&&Ce!=="number"&&(ge=JSON.stringify(ge));var De=Ce+":"+ge,q=he[De];q===void 0&&($.push(ge),he[De]=q=$.length-1),N.writeVarint(q)}}function Zt(L,N){return(N<<3)+(7&L)}function gt(L){return L<<1^L>>31}function It(L,N){for(var V=L.loadGeometry(),W=L.type,$=0,se=0,he=V.length,j=0;j<he;j++){var J=V[j],ge=1;W===1&&(ge=J.length),N.writeVarint(Zt(1,ge));for(var Ce=W===3?J.length-1:J.length,De=0;De<Ce;De++){De===1&&W!==1&&N.writeVarint(Zt(2,Ce-1));var q=J[De].x-$,_e=J[De].y-se;N.writeVarint(gt(q)),N.writeVarint(gt(_e)),$+=q,se+=_e}W===3&&N.writeVarint(Zt(7,1))}}function jt(L,N){var V=typeof L;V==="string"?N.writeStringField(1,L):V==="boolean"?N.writeBooleanField(7,L):V==="number"&&(L%1!=0?N.writeDoubleField(3,L):L<0?N.writeSVarintField(6,L):N.writeVarintField(5,L))}function ei(L,N,V,W){We(L,V,W),We(N,2*V,2*W),We(N,2*V+1,2*W+1)}function We(L,N,V){var W=L[N];L[N]=L[V],L[V]=W}function At(L,N,V,W){var $=L-V,se=N-W;return $*$+se*se}_t.fromVectorTileJs=Nt,_t.fromGeojsonVt=function(L,N){N=N||{};var V={};for(var W in L)V[W]=new ct(L[W].features,N),V[W].name=W,V[W].version=N.version,V[W].extent=N.extent;return Nt({layers:V})},_t.GeoJSONWrapper=pt;var mr=function(L){return L[0]},Tr=function(L){return L[1]},xr=function(L,N,V,W,$){N===void 0&&(N=mr),V===void 0&&(V=Tr),W===void 0&&(W=64),$===void 0&&($=Float64Array),this.nodeSize=W,this.points=L;for(var se=L.length<65536?Uint16Array:Uint32Array,he=this.ids=new se(L.length),j=this.coords=new $(2*L.length),J=0;J<L.length;J++)he[J]=J,j[2*J]=N(L[J]),j[2*J+1]=V(L[J]);(function ge(Ce,De,q,_e,tt,He){if(!(tt-_e<=q)){var ke=_e+tt>>1;(function Xe(Oe,qe,Mt,je,Vt,lr){for(;Vt>je;){if(Vt-je>600){var Dt=Vt-je+1,nr=Mt-je+1,Jt=Math.log(Dt),ii=.5*Math.exp(2*Jt/3),$t=.5*Math.sqrt(Jt*ii*(Dt-ii)/Dt)*(nr-Dt/2<0?-1:1);Xe(Oe,qe,Mt,Math.max(je,Math.floor(Mt-nr*ii/Dt+$t)),Math.min(Vt,Math.floor(Mt+(Dt-nr)*ii/Dt+$t)),lr)}var br=qe[2*Mt+lr],fr=je,Gt=Vt;for(ei(Oe,qe,je,Mt),qe[2*Vt+lr]>br&&ei(Oe,qe,je,Vt);fr<Gt;){for(ei(Oe,qe,fr,Gt),fr++,Gt--;qe[2*fr+lr]<br;)fr++;for(;qe[2*Gt+lr]>br;)Gt--}qe[2*je+lr]===br?ei(Oe,qe,je,Gt):ei(Oe,qe,++Gt,Vt),Gt<=Mt&&(je=Gt+1),Mt<=Gt&&(Vt=Gt-1)}})(Ce,De,ke,_e,tt,He%2),ge(Ce,De,q,_e,ke-1,He+1),ge(Ce,De,q,ke+1,tt,He+1)}})(he,j,W,0,he.length-1,0)};xr.prototype.range=function(L,N,V,W){return function($,se,he,j,J,ge,Ce){for(var De,q,_e=[0,$.length-1,0],tt=[];_e.length;){var He=_e.pop(),ke=_e.pop(),Xe=_e.pop();if(ke-Xe<=Ce)for(var Oe=Xe;Oe<=ke;Oe++)q=se[2*Oe+1],(De=se[2*Oe])>=he&&De<=J&&q>=j&&q<=ge&&tt.push($[Oe]);else{var qe=Math.floor((Xe+ke)/2);q=se[2*qe+1],(De=se[2*qe])>=he&&De<=J&&q>=j&&q<=ge&&tt.push($[qe]);var Mt=(He+1)%2;(He===0?he<=De:j<=q)&&(_e.push(Xe),_e.push(qe-1),_e.push(Mt)),(He===0?J>=De:ge>=q)&&(_e.push(qe+1),_e.push(ke),_e.push(Mt))}}return tt}(this.ids,this.coords,L,N,V,W,this.nodeSize)},xr.prototype.within=function(L,N,V){return function(W,$,se,he,j,J){for(var ge=[0,W.length-1,0],Ce=[],De=j*j;ge.length;){var q=ge.pop(),_e=ge.pop(),tt=ge.pop();if(_e-tt<=J)for(var He=tt;He<=_e;He++)At($[2*He],$[2*He+1],se,he)<=De&&Ce.push(W[He]);else{var ke=Math.floor((tt+_e)/2),Xe=$[2*ke],Oe=$[2*ke+1];At(Xe,Oe,se,he)<=De&&Ce.push(W[ke]);var qe=(q+1)%2;(q===0?se-j<=Xe:he-j<=Oe)&&(ge.push(tt),ge.push(ke-1),ge.push(qe)),(q===0?se+j>=Xe:he+j>=Oe)&&(ge.push(ke+1),ge.push(_e),ge.push(qe))}}return Ce}(this.ids,this.coords,L,N,V,this.nodeSize)};var Zr={minZoom:0,maxZoom:16,minPoints:2,radius:40,extent:512,nodeSize:64,log:!1,generateId:!1,reduce:null,map:function(L){return L}},sr=function(L){this.options=Lr(Object.create(Zr),L),this.trees=new Array(this.options.maxZoom+1)};function ti(L,N,V,W,$){return{x:L,y:N,zoom:1/0,id:V,parentId:-1,numPoints:W,properties:$}}function Wt(L,N){var V=L.geometry.coordinates,W=V[1];return{x:Nr(V[0]),y:qt(W),zoom:1/0,index:N,parentId:-1}}function Gr(L){return{type:"Feature",id:L.id,properties:yr(L),geometry:{type:"Point",coordinates:[(W=L.x,360*(W-.5)),(N=L.y,V=(180-360*N)*Math.PI/180,360*Math.atan(Math.exp(V))/Math.PI-90)]}};var N,V,W}function yr(L){var N=L.numPoints,V=N>=1e4?Math.round(N/1e3)+"k":N>=1e3?Math.round(N/100)/10+"k":N;return Lr(Lr({},L.properties),{cluster:!0,cluster_id:L.id,point_count:N,point_count_abbreviated:V})}function Nr(L){return L/360+.5}function qt(L){var N=Math.sin(L*Math.PI/180),V=.5-.25*Math.log((1+N)/(1-N))/Math.PI;return V<0?0:V>1?1:V}function Lr(L,N){for(var V in N)L[V]=N[V];return L}function Kr(L){return L.x}function hr(L){return L.y}function Fi(L,N,V,W,$,se){var he=$-V,j=se-W;if(he!==0||j!==0){var J=((L-V)*he+(N-W)*j)/(he*he+j*j);J>1?(V=$,W=se):J>0&&(V+=he*J,W+=j*J)}return(he=L-V)*he+(j=N-W)*j}function Cr(L,N,V,W){var $={id:L===void 0?null:L,type:N,geometry:V,tags:W,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0};return function(se){var he=se.geometry,j=se.type;if(j==="Point"||j==="MultiPoint"||j==="LineString")bi(se,he);else if(j==="Polygon"||j==="MultiLineString")for(var J=0;J<he.length;J++)bi(se,he[J]);else if(j==="MultiPolygon")for(J=0;J<he.length;J++)for(var ge=0;ge<he[J].length;ge++)bi(se,he[J][ge])}($),$}function bi(L,N){for(var V=0;V<N.length;V+=3)L.minX=Math.min(L.minX,N[V]),L.minY=Math.min(L.minY,N[V+1]),L.maxX=Math.max(L.maxX,N[V]),L.maxY=Math.max(L.maxY,N[V+1])}function pi(L,N,V,W){if(N.geometry){var $=N.geometry.coordinates,se=N.geometry.type,he=Math.pow(V.tolerance/((1<<V.maxZoom)*V.extent),2),j=[],J=N.id;if(V.promoteId?J=N.properties[V.promoteId]:V.generateId&&(J=W||0),se==="Point")Qi($,j);else if(se==="MultiPoint")for(var ge=0;ge<$.length;ge++)Qi($[ge],j);else if(se==="LineString")Mi($,j,he,!1);else if(se==="MultiLineString"){if(V.lineMetrics){for(ge=0;ge<$.length;ge++)Mi($[ge],j=[],he,!1),L.push(Cr(J,"LineString",j,N.properties));return}fi($,j,he,!1)}else if(se==="Polygon")fi($,j,he,!0);else{if(se!=="MultiPolygon"){if(se==="GeometryCollection"){for(ge=0;ge<N.geometry.geometries.length;ge++)pi(L,{id:J,geometry:N.geometry.geometries[ge],properties:N.properties},V,W);return}throw new Error("Input data is not a valid GeoJSON object.")}for(ge=0;ge<$.length;ge++){var Ce=[];fi($[ge],Ce,he,!0),j.push(Ce)}}L.push(Cr(J,se,j,N.properties))}}function Qi(L,N){N.push(ri(L[0])),N.push(sn(L[1])),N.push(0)}function Mi(L,N,V,W){for(var $,se,he=0,j=0;j<L.length;j++){var J=ri(L[j][0]),ge=sn(L[j][1]);N.push(J),N.push(ge),N.push(0),j>0&&(he+=W?($*ge-J*se)/2:Math.sqrt(Math.pow(J-$,2)+Math.pow(ge-se,2))),$=J,se=ge}var Ce=N.length-3;N[2]=1,function De(q,_e,tt,He){for(var ke,Xe=He,Oe=tt-_e>>1,qe=tt-_e,Mt=q[_e],je=q[_e+1],Vt=q[tt],lr=q[tt+1],Dt=_e+3;Dt<tt;Dt+=3){var nr=Fi(q[Dt],q[Dt+1],Mt,je,Vt,lr);if(nr>Xe)ke=Dt,Xe=nr;else if(nr===Xe){var Jt=Math.abs(Dt-Oe);Jt<qe&&(ke=Dt,qe=Jt)}}Xe>He&&(ke-_e>3&&De(q,_e,ke,He),q[ke+2]=Xe,tt-ke>3&&De(q,ke,tt,He))}(N,0,Ce,V),N[Ce+2]=1,N.size=Math.abs(he),N.start=0,N.end=N.size}function fi(L,N,V,W){for(var $=0;$<L.length;$++){var se=[];Mi(L[$],se,V,W),N.push(se)}}function ri(L){return L/360+.5}function sn(L){var N=Math.sin(L*Math.PI/180),V=.5-.25*Math.log((1+N)/(1-N))/Math.PI;return V<0?0:V>1?1:V}function di(L,N,V,W,$,se,he,j){if(W/=N,se>=(V/=N)&&he<W)return L;if(he<V||se>=W)return null;for(var J=[],ge=0;ge<L.length;ge++){var Ce=L[ge],De=Ce.geometry,q=Ce.type,_e=$===0?Ce.minX:Ce.minY,tt=$===0?Ce.maxX:Ce.maxY;if(_e>=V&&tt<W)J.push(Ce);else if(!(tt<V||_e>=W)){var He=[];if(q==="Point"||q==="MultiPoint")Ur(De,He,V,W,$);else if(q==="LineString")$i(De,He,V,W,$,!1,j.lineMetrics);else if(q==="MultiLineString")Ni(De,He,V,W,$,!1);else if(q==="Polygon")Ni(De,He,V,W,$,!0);else if(q==="MultiPolygon")for(var ke=0;ke<De.length;ke++){var Xe=[];Ni(De[ke],Xe,V,W,$,!0),Xe.length&&He.push(Xe)}if(He.length){if(j.lineMetrics&&q==="LineString"){for(ke=0;ke<He.length;ke++)J.push(Cr(Ce.id,q,He[ke],Ce.tags));continue}q!=="LineString"&&q!=="MultiLineString"||(He.length===1?(q="LineString",He=He[0]):q="MultiLineString"),q!=="Point"&&q!=="MultiPoint"||(q=He.length===3?"Point":"MultiPoint"),J.push(Cr(Ce.id,q,He,Ce.tags))}}}return J.length?J:null}function Ur(L,N,V,W,$){for(var se=0;se<L.length;se+=3){var he=L[se+$];he>=V&&he<=W&&(N.push(L[se]),N.push(L[se+1]),N.push(L[se+2]))}}function $i(L,N,V,W,$,se,he){for(var j,J,ge=On(L),Ce=$===0?en:Mn,De=L.start,q=0;q<L.length-3;q+=3){var _e=L[q],tt=L[q+1],He=L[q+2],ke=L[q+3],Xe=L[q+4],Oe=$===0?_e:tt,qe=$===0?ke:Xe,Mt=!1;he&&(j=Math.sqrt(Math.pow(_e-ke,2)+Math.pow(tt-Xe,2))),Oe<V?qe>V&&(J=Ce(ge,_e,tt,ke,Xe,V),he&&(ge.start=De+j*J)):Oe>W?qe<W&&(J=Ce(ge,_e,tt,ke,Xe,W),he&&(ge.start=De+j*J)):Cn(ge,_e,tt,He),qe<V&&Oe>=V&&(J=Ce(ge,_e,tt,ke,Xe,V),Mt=!0),qe>W&&Oe<=W&&(J=Ce(ge,_e,tt,ke,Xe,W),Mt=!0),!se&&Mt&&(he&&(ge.end=De+j*J),N.push(ge),ge=On(L)),he&&(De+=j)}var je=L.length-3;_e=L[je],tt=L[je+1],He=L[je+2],(Oe=$===0?_e:tt)>=V&&Oe<=W&&Cn(ge,_e,tt,He),je=ge.length-3,se&&je>=3&&(ge[je]!==ge[0]||ge[je+1]!==ge[1])&&Cn(ge,ge[0],ge[1],ge[2]),ge.length&&N.push(ge)}function On(L){var N=[];return N.size=L.size,N.start=L.start,N.end=L.end,N}function Ni(L,N,V,W,$,se){for(var he=0;he<L.length;he++)$i(L[he],N,V,W,$,se,!1)}function Cn(L,N,V,W){L.push(N),L.push(V),L.push(W)}function en(L,N,V,W,$,se){var he=(se-N)/(W-N);return L.push(se),L.push(V+($-V)*he),L.push(1),he}function Mn(L,N,V,W,$,se){var he=(se-V)/($-V);return L.push(N+(W-N)*he),L.push(se),L.push(1),he}function Ui(L,N){for(var V=[],W=0;W<L.length;W++){var $,se=L[W],he=se.type;if(he==="Point"||he==="MultiPoint"||he==="LineString")$=_n(se.geometry,N);else if(he==="MultiLineString"||he==="Polygon"){$=[];for(var j=0;j<se.geometry.length;j++)$.push(_n(se.geometry[j],N))}else if(he==="MultiPolygon")for($=[],j=0;j<se.geometry.length;j++){for(var J=[],ge=0;ge<se.geometry[j].length;ge++)J.push(_n(se.geometry[j][ge],N));$.push(J)}V.push(Cr(se.id,he,$,se.tags))}return V}function _n(L,N){var V=[];V.size=L.size,L.start!==void 0&&(V.start=L.start,V.end=L.end);for(var W=0;W<L.length;W+=3)V.push(L[W]+N,L[W+1],L[W+2]);return V}function Vi(L,N){if(L.transformed)return L;var V,W,$,se=1<<L.z,he=L.x,j=L.y;for(V=0;V<L.features.length;V++){var J=L.features[V],ge=J.geometry,Ce=J.type;if(J.geometry=[],Ce===1)for(W=0;W<ge.length;W+=2)J.geometry.push(Fn(ge[W],ge[W+1],N,se,he,j));else for(W=0;W<ge.length;W++){var De=[];for($=0;$<ge[W].length;$+=2)De.push(Fn(ge[W][$],ge[W][$+1],N,se,he,j));J.geometry.push(De)}}return L.transformed=!0,L}function Fn(L,N,V,W,$,se){return[Math.round(V*(L*W-$)),Math.round(V*(N*W-se))]}function tn(L,N,V,W,$){for(var se=N===$.maxZoom?0:$.tolerance/((1<<N)*$.extent),he={features:[],numPoints:0,numSimplified:0,numFeatures:0,source:null,x:V,y:W,z:N,transformed:!1,minX:2,minY:1,maxX:-1,maxY:0},j=0;j<L.length;j++){he.numFeatures++,ji(he,L[j],se,$);var J=L[j].minX,ge=L[j].minY,Ce=L[j].maxX,De=L[j].maxY;J<he.minX&&(he.minX=J),ge<he.minY&&(he.minY=ge),Ce>he.maxX&&(he.maxX=Ce),De>he.maxY&&(he.maxY=De)}return he}function ji(L,N,V,W){var $=N.geometry,se=N.type,he=[];if(se==="Point"||se==="MultiPoint")for(var j=0;j<$.length;j+=3)he.push($[j]),he.push($[j+1]),L.numPoints++,L.numSimplified++;else if(se==="LineString")vn(he,$,L,V,!1,!1);else if(se==="MultiLineString"||se==="Polygon")for(j=0;j<$.length;j++)vn(he,$[j],L,V,se==="Polygon",j===0);else if(se==="MultiPolygon")for(var J=0;J<$.length;J++){var ge=$[J];for(j=0;j<ge.length;j++)vn(he,ge[j],L,V,!0,j===0)}if(he.length){var Ce=N.tags||null;if(se==="LineString"&&W.lineMetrics){for(var De in Ce={},N.tags)Ce[De]=N.tags[De];Ce.mapbox_clip_start=$.start/$.size,Ce.mapbox_clip_end=$.end/$.size}var q={geometry:he,type:se==="Polygon"||se==="MultiPolygon"?3:se==="LineString"||se==="MultiLineString"?2:1,tags:Ce};N.id!==null&&(q.id=N.id),L.features.push(q)}}function vn(L,N,V,W,$,se){var he=W*W;if(W>0&&N.size<($?he:W))V.numPoints+=N.length/3;else{for(var j=[],J=0;J<N.length;J+=3)(W===0||N[J+2]>he)&&(V.numSimplified++,j.push(N[J]),j.push(N[J+1])),V.numPoints++;$&&function(ge,Ce){for(var De=0,q=0,_e=ge.length,tt=_e-2;q<_e;tt=q,q+=2)De+=(ge[q]-ge[tt])*(ge[q+1]+ge[tt+1]);if(De>0===Ce)for(q=0,_e=ge.length;q<_e/2;q+=2){var He=ge[q],ke=ge[q+1];ge[q]=ge[_e-2-q],ge[q+1]=ge[_e-1-q],ge[_e-2-q]=He,ge[_e-1-q]=ke}}(j,se),L.push(j)}}function ln(L,N){var V=(N=this.options=function($,se){for(var he in se)$[he]=se[he];return $}(Object.create(this.options),N)).debug;if(V&&console.time("preprocess data"),N.maxZoom<0||N.maxZoom>24)throw new Error("maxZoom should be in the 0-24 range");if(N.promoteId&&N.generateId)throw new Error("promoteId and generateId cannot be used together.");var W=function($,se){var he=[];if($.type==="FeatureCollection")for(var j=0;j<$.features.length;j++)pi(he,$.features[j],se,j);else pi(he,$.type==="Feature"?$:{geometry:$},se);return he}(L,N);this.tiles={},this.tileCoords=[],V&&(console.timeEnd("preprocess data"),console.log("index: maxZoom: %d, maxPoints: %d",N.indexMaxZoom,N.indexMaxPoints),console.time("generate tiles"),this.stats={},this.total=0),(W=function($,se){var he=se.buffer/se.extent,j=$,J=di($,1,-1-he,he,0,-1,2,se),ge=di($,1,1-he,2+he,0,-1,2,se);return(J||ge)&&(j=di($,1,-he,1+he,0,-1,2,se)||[],J&&(j=Ui(J,1).concat(j)),ge&&(j=j.concat(Ui(ge,-1)))),j}(W,N)).length&&this.splitTile(W,0,0,0),V&&(W.length&&console.log("features: %d, points: %d",this.tiles[0].numFeatures,this.tiles[0].numPoints),console.timeEnd("generate tiles"),console.log("tiles generated:",this.total,JSON.stringify(this.stats)))}function un(L,N,V){return 32*((1<<L)*V+N)+L}function bn(L,N){var V=L.tileID.canonical;if(!this._geoJSONIndex)return N(null,null);var W=this._geoJSONIndex.getTile(V.z,V.x,V.y);if(!W)return N(null,null);var $=new Me(W.features),se=_t($);se.byteOffset===0&&se.byteLength===se.buffer.byteLength||(se=new Uint8Array(se)),N(null,{vectorTile:$,rawData:se.buffer})}sr.prototype.load=function(L){var N=this.options,V=N.log,W=N.minZoom,$=N.maxZoom,se=N.nodeSize;V&&console.time("total time");var he="prepare "+L.length+" points";V&&console.time(he),this.points=L;for(var j=[],J=0;J<L.length;J++)L[J].geometry&&j.push(Wt(L[J],J));this.trees[$+1]=new xr(j,Kr,hr,se,Float32Array),V&&console.timeEnd(he);for(var ge=$;ge>=W;ge--){var Ce=+Date.now();j=this._cluster(j,ge),this.trees[ge]=new xr(j,Kr,hr,se,Float32Array),V&&console.log("z%d: %d clusters in %dms",ge,j.length,+Date.now()-Ce)}return V&&console.timeEnd("total time"),this},sr.prototype.getClusters=function(L,N){var V=((L[0]+180)%360+360)%360-180,W=Math.max(-90,Math.min(90,L[1])),$=L[2]===180?180:((L[2]+180)%360+360)%360-180,se=Math.max(-90,Math.min(90,L[3]));if(L[2]-L[0]>=360)V=-180,$=180;else if(V>$){var he=this.getClusters([V,W,180,se],N),j=this.getClusters([-180,W,$,se],N);return he.concat(j)}for(var J=this.trees[this._limitZoom(N)],ge=[],Ce=0,De=J.range(Nr(V),qt(se),Nr($),qt(W));Ce<De.length;Ce+=1){var q=J.points[De[Ce]];ge.push(q.numPoints?Gr(q):this.points[q.index])}return ge},sr.prototype.getChildren=function(L){var N=this._getOriginId(L),V=this._getOriginZoom(L),W="No cluster with the specified id.",$=this.trees[V];if(!$)throw new Error(W);var se=$.points[N];if(!se)throw new Error(W);for(var he=this.options.radius/(this.options.extent*Math.pow(2,V-1)),j=[],J=0,ge=$.within(se.x,se.y,he);J<ge.length;J+=1){var Ce=$.points[ge[J]];Ce.parentId===L&&j.push(Ce.numPoints?Gr(Ce):this.points[Ce.index])}if(j.length===0)throw new Error(W);return j},sr.prototype.getLeaves=function(L,N,V){var W=[];return this._appendLeaves(W,L,N=N||10,V=V||0,0),W},sr.prototype.getTile=function(L,N,V){var W=this.trees[this._limitZoom(L)],$=Math.pow(2,L),se=this.options,he=se.radius/se.extent,j=(V-he)/$,J=(V+1+he)/$,ge={features:[]};return this._addTileFeatures(W.range((N-he)/$,j,(N+1+he)/$,J),W.points,N,V,$,ge),N===0&&this._addTileFeatures(W.range(1-he/$,j,1,J),W.points,$,V,$,ge),N===$-1&&this._addTileFeatures(W.range(0,j,he/$,J),W.points,-1,V,$,ge),ge.features.length?ge:null},sr.prototype.getClusterExpansionZoom=function(L){for(var N=this._getOriginZoom(L)-1;N<=this.options.maxZoom;){var V=this.getChildren(L);if(N++,V.length!==1)break;L=V[0].properties.cluster_id}return N},sr.prototype._appendLeaves=function(L,N,V,W,$){for(var se=0,he=this.getChildren(N);se<he.length;se+=1){var j=he[se],J=j.properties;if(J&&J.cluster?$+J.point_count<=W?$+=J.point_count:$=this._appendLeaves(L,J.cluster_id,V,W,$):$<W?$++:L.push(j),L.length===V)break}return $},sr.prototype._addTileFeatures=function(L,N,V,W,$,se){for(var he=0,j=L;he<j.length;he+=1){var J=N[j[he]],ge=J.numPoints,Ce={type:1,geometry:[[Math.round(this.options.extent*(J.x*$-V)),Math.round(this.options.extent*(J.y*$-W))]],tags:ge?yr(J):this.points[J.index].properties},De=void 0;ge?De=J.id:this.options.generateId?De=J.index:this.points[J.index].id&&(De=this.points[J.index].id),De!==void 0&&(Ce.id=De),se.features.push(Ce)}},sr.prototype._limitZoom=function(L){return Math.max(this.options.minZoom,Math.min(+L,this.options.maxZoom+1))},sr.prototype._cluster=function(L,N){for(var V=[],W=this.options,$=W.reduce,se=W.minPoints,he=W.radius/(W.extent*Math.pow(2,N)),j=0;j<L.length;j++){var J=L[j];if(!(J.zoom<=N)){J.zoom=N;for(var ge=this.trees[N+1],Ce=ge.within(J.x,J.y,he),De=J.numPoints||1,q=De,_e=0,tt=Ce;_e<tt.length;_e+=1){var He=ge.points[tt[_e]];He.zoom>N&&(q+=He.numPoints||1)}if(q>=se){for(var ke=J.x*De,Xe=J.y*De,Oe=$&&De>1?this._map(J,!0):null,qe=(j<<5)+(N+1)+this.points.length,Mt=0,je=Ce;Mt<je.length;Mt+=1){var Vt=ge.points[je[Mt]];if(!(Vt.zoom<=N)){Vt.zoom=N;var lr=Vt.numPoints||1;ke+=Vt.x*lr,Xe+=Vt.y*lr,Vt.parentId=qe,$&&(Oe||(Oe=this._map(J,!0)),$(Oe,this._map(Vt)))}}J.parentId=qe,V.push(ti(ke/q,Xe/q,qe,q,Oe))}else if(V.push(J),q>1)for(var Dt=0,nr=Ce;Dt<nr.length;Dt+=1){var Jt=ge.points[nr[Dt]];Jt.zoom<=N||(Jt.zoom=N,V.push(Jt))}}}return V},sr.prototype._getOriginId=function(L){return L-this.points.length>>5},sr.prototype._getOriginZoom=function(L){return(L-this.points.length)%32},sr.prototype._map=function(L,N){if(L.numPoints)return N?Lr({},L.properties):L.properties;var V=this.points[L.index].properties,W=this.options.map(V);return N&&W===V?Lr({},W):W},ln.prototype.options={maxZoom:14,indexMaxZoom:5,indexMaxPoints:1e5,tolerance:3,extent:4096,buffer:64,lineMetrics:!1,promoteId:null,generateId:!1,debug:0},ln.prototype.splitTile=function(L,N,V,W,$,se,he){for(var j=[L,N,V,W],J=this.options,ge=J.debug;j.length;){W=j.pop(),V=j.pop(),N=j.pop(),L=j.pop();var Ce=1<<N,De=un(N,V,W),q=this.tiles[De];if(!q&&(ge>1&&console.time("creation"),q=this.tiles[De]=tn(L,N,V,W,J),this.tileCoords.push({z:N,x:V,y:W}),ge)){ge>1&&(console.log("tile z%d-%d-%d (features: %d, points: %d, simplified: %d)",N,V,W,q.numFeatures,q.numPoints,q.numSimplified),console.timeEnd("creation"));var _e="z"+N;this.stats[_e]=(this.stats[_e]||0)+1,this.total++}if(q.source=L,$){if(N===J.maxZoom||N===$)continue;var tt=1<<$-N;if(V!==Math.floor(se/tt)||W!==Math.floor(he/tt))continue}else if(N===J.indexMaxZoom||q.numPoints<=J.indexMaxPoints)continue;if(q.source=null,L.length!==0){ge>1&&console.time("clipping");var He,ke,Xe,Oe,qe,Mt,je=.5*J.buffer/J.extent,Vt=.5-je,lr=.5+je,Dt=1+je;He=ke=Xe=Oe=null,qe=di(L,Ce,V-je,V+lr,0,q.minX,q.maxX,J),Mt=di(L,Ce,V+Vt,V+Dt,0,q.minX,q.maxX,J),L=null,qe&&(He=di(qe,Ce,W-je,W+lr,1,q.minY,q.maxY,J),ke=di(qe,Ce,W+Vt,W+Dt,1,q.minY,q.maxY,J),qe=null),Mt&&(Xe=di(Mt,Ce,W-je,W+lr,1,q.minY,q.maxY,J),Oe=di(Mt,Ce,W+Vt,W+Dt,1,q.minY,q.maxY,J),Mt=null),ge>1&&console.timeEnd("clipping"),j.push(He||[],N+1,2*V,2*W),j.push(ke||[],N+1,2*V,2*W+1),j.push(Xe||[],N+1,2*V+1,2*W),j.push(Oe||[],N+1,2*V+1,2*W+1)}}},ln.prototype.getTile=function(L,N,V){var W=this.options,$=W.extent,se=W.debug;if(L<0||L>24)return null;var he=1<<L,j=un(L,N=(N%he+he)%he,V);if(this.tiles[j])return Vi(this.tiles[j],$);se>1&&console.log("drilling down to z%d-%d-%d",L,N,V);for(var J,ge=L,Ce=N,De=V;!J&&ge>0;)ge--,Ce=Math.floor(Ce/2),De=Math.floor(De/2),J=this.tiles[un(ge,Ce,De)];return J&&J.source?(se>1&&console.log("found parent tile z%d-%d-%d",ge,Ce,De),se>1&&console.time("drilling down"),this.splitTile(J.source,ge,Ce,De,L,N,V),se>1&&console.timeEnd("drilling down"),this.tiles[j]?Vi(this.tiles[j],$):null):null};var oi=function(L){function N(V,W,$,se){L.call(this,V,W,$,bn),se&&(this.loadGeoJSON=se)}return L&&(N.__proto__=L),(N.prototype=Object.create(L&&L.prototype)).constructor=N,N.prototype.loadData=function(V,W){this._pendingCallback&&this._pendingCallback(null,{abandoned:!0}),this._pendingCallback=W,this._pendingLoadDataParams=V,this._state&&this._state!=="Idle"?this._state="NeedsLoadData":(this._state="Coalescing",this._loadData())},N.prototype._loadData=function(){var V=this;if(this._pendingCallback&&this._pendingLoadDataParams){var W=this._pendingCallback,$=this._pendingLoadDataParams;delete this._pendingCallback,delete this._pendingLoadDataParams;var se=!!($&&$.request&&$.request.collectResourceTiming)&&new a.RequestPerformance($.request);this.loadGeoJSON($,function(he,j){if(he||!j)return W(he);if(typeof j!="object")return W(new Error("Input data given to '"+$.source+"' is not a valid GeoJSON object."));(function q(_e,tt){var He,ke=_e&&_e.type;if(ke==="FeatureCollection")for(He=0;He<_e.features.length;He++)q(_e.features[He],tt);else if(ke==="GeometryCollection")for(He=0;He<_e.geometries.length;He++)q(_e.geometries[He],tt);else if(ke==="Feature")q(_e.geometry,tt);else if(ke==="Polygon")we(_e.coordinates,tt);else if(ke==="MultiPolygon")for(He=0;He<_e.coordinates.length;He++)we(_e.coordinates[He],tt);return _e})(j,!0);try{if($.filter){var J=a.createExpression($.filter,{type:"boolean","property-type":"data-driven",overridable:!1,transition:!1});if(J.result==="error")throw new Error(J.value.map(function(q){return q.key+": "+q.message}).join(", "));var ge=j.features.filter(function(q){return J.value.evaluate({zoom:0},q)});j={type:"FeatureCollection",features:ge}}V._geoJSONIndex=$.cluster?new sr(function(q){var _e=q.superclusterOptions,tt=q.clusterProperties;if(!tt||!_e)return _e;for(var He={},ke={},Xe={accumulated:null,zoom:0},Oe={properties:null},qe=Object.keys(tt),Mt=0,je=qe;Mt<je.length;Mt+=1){var Vt=je[Mt],lr=tt[Vt],Dt=lr[0],nr=a.createExpression(lr[1]),Jt=a.createExpression(typeof Dt=="string"?[Dt,["accumulated"],["get",Vt]]:Dt);He[Vt]=nr.value,ke[Vt]=Jt.value}return _e.map=function(ii){Oe.properties=ii;for(var $t={},br=0,fr=qe;br<fr.length;br+=1){var Gt=fr[br];$t[Gt]=He[Gt].evaluate(Xe,Oe)}return $t},_e.reduce=function(ii,$t){Oe.properties=$t;for(var br=0,fr=qe;br<fr.length;br+=1){var Gt=fr[br];Xe.accumulated=ii[Gt],ii[Gt]=ke[Gt].evaluate(Xe,Oe)}},_e}($)).load(j.features):function(q,_e){return new ln(q,_e)}(j,$.geojsonVtOptions)}catch(q){return W(q)}V.loaded={};var Ce={};if(se){var De=se.finish();De&&(Ce.resourceTiming={},Ce.resourceTiming[$.source]=JSON.parse(JSON.stringify(De)))}W(null,Ce)})}},N.prototype.coalesce=function(){this._state==="Coalescing"?this._state="Idle":this._state==="NeedsLoadData"&&(this._state="Coalescing",this._loadData())},N.prototype.reloadTile=function(V,W){var $=this.loaded;return $&&$[V.uid]?L.prototype.reloadTile.call(this,V,W):this.loadTile(V,W)},N.prototype.loadGeoJSON=function(V,W){if(V.request)a.getJSON(V.request,W);else{if(typeof V.data!="string")return W(new Error("Input data given to '"+V.source+"' is not a valid GeoJSON object."));try{return W(null,JSON.parse(V.data))}catch{return W(new Error("Input data given to '"+V.source+"' is not a valid GeoJSON object."))}}},N.prototype.removeSource=function(V,W){this._pendingCallback&&this._pendingCallback(null,{abandoned:!0}),W()},N.prototype.getClusterExpansionZoom=function(V,W){try{W(null,this._geoJSONIndex.getClusterExpansionZoom(V.clusterId))}catch($){W($)}},N.prototype.getClusterChildren=function(V,W){try{W(null,this._geoJSONIndex.getChildren(V.clusterId))}catch($){W($)}},N.prototype.getClusterLeaves=function(V,W){try{W(null,this._geoJSONIndex.getLeaves(V.clusterId,V.limit,V.offset))}catch($){W($)}},N}(ie),Mr=function(L){var N=this;this.self=L,this.actor=new a.Actor(L,this),this.layerIndexes={},this.availableImages={},this.workerSourceTypes={vector:ie,geojson:oi},this.workerSources={},this.demWorkerSources={},this.self.registerWorkerSource=function(V,W){if(N.workerSourceTypes[V])throw new Error('Worker source with name "'+V+'" already registered.');N.workerSourceTypes[V]=W},this.self.registerRTLTextPlugin=function(V){if(a.plugin.isParsed())throw new Error("RTL text plugin already registered.");a.plugin.applyArabicShaping=V.applyArabicShaping,a.plugin.processBidirectionalText=V.processBidirectionalText,a.plugin.processStyledBidirectionalText=V.processStyledBidirectionalText}};return Mr.prototype.setReferrer=function(L,N){this.referrer=N},Mr.prototype.setImages=function(L,N,V){for(var W in this.availableImages[L]=N,this.workerSources[L]){var $=this.workerSources[L][W];for(var se in $)$[se].availableImages=N}V()},Mr.prototype.setLayers=function(L,N,V){this.getLayerIndex(L).replace(N),V()},Mr.prototype.updateLayers=function(L,N,V){this.getLayerIndex(L).update(N.layers,N.removedIds),V()},Mr.prototype.loadTile=function(L,N,V){this.getWorkerSource(L,N.type,N.source).loadTile(N,V)},Mr.prototype.loadDEMTile=function(L,N,V){this.getDEMWorkerSource(L,N.source).loadTile(N,V)},Mr.prototype.reloadTile=function(L,N,V){this.getWorkerSource(L,N.type,N.source).reloadTile(N,V)},Mr.prototype.abortTile=function(L,N,V){this.getWorkerSource(L,N.type,N.source).abortTile(N,V)},Mr.prototype.removeTile=function(L,N,V){this.getWorkerSource(L,N.type,N.source).removeTile(N,V)},Mr.prototype.removeDEMTile=function(L,N){this.getDEMWorkerSource(L,N.source).removeTile(N)},Mr.prototype.removeSource=function(L,N,V){if(this.workerSources[L]&&this.workerSources[L][N.type]&&this.workerSources[L][N.type][N.source]){var W=this.workerSources[L][N.type][N.source];delete this.workerSources[L][N.type][N.source],W.removeSource!==void 0?W.removeSource(N,V):V()}},Mr.prototype.loadWorkerSource=function(L,N,V){try{this.self.importScripts(N.url),V()}catch(W){V(W.toString())}},Mr.prototype.syncRTLPluginState=function(L,N,V){try{a.plugin.setState(N);var W=a.plugin.getPluginURL();if(a.plugin.isLoaded()&&!a.plugin.isParsed()&&W!=null){this.self.importScripts(W);var $=a.plugin.isParsed();V($?void 0:new Error("RTL Text Plugin failed to import scripts from "+W),$)}}catch(se){V(se.toString())}},Mr.prototype.getAvailableImages=function(L){var N=this.availableImages[L];return N||(N=[]),N},Mr.prototype.getLayerIndex=function(L){var N=this.layerIndexes[L];return N||(N=this.layerIndexes[L]=new M),N},Mr.prototype.getWorkerSource=function(L,N,V){var W=this;return this.workerSources[L]||(this.workerSources[L]={}),this.workerSources[L][N]||(this.workerSources[L][N]={}),this.workerSources[L][N][V]||(this.workerSources[L][N][V]=new this.workerSourceTypes[N]({send:function($,se,he){W.actor.send($,se,he,L)}},this.getLayerIndex(L),this.getAvailableImages(L))),this.workerSources[L][N][V]},Mr.prototype.getDEMWorkerSource=function(L,N){return this.demWorkerSources[L]||(this.demWorkerSources[L]={}),this.demWorkerSources[L][N]||(this.demWorkerSources[L][N]=new fe),this.demWorkerSources[L][N]},Mr.prototype.enforceCacheSizeLimit=function(L,N){a.enforceCacheSizeLimit(N)},typeof WorkerGlobalScope<"u"&&typeof self<"u"&&self instanceof WorkerGlobalScope&&(self.worker=new Mr(self)),Mr}),v(["./shared"],function(a){var T=a.createCommonjsModule(function(n){function s(_){return!o(_)}function o(_){return typeof window>"u"||typeof document>"u"?"not a browser":Array.prototype&&Array.prototype.every&&Array.prototype.filter&&Array.prototype.forEach&&Array.prototype.indexOf&&Array.prototype.lastIndexOf&&Array.prototype.map&&Array.prototype.some&&Array.prototype.reduce&&Array.prototype.reduceRight&&Array.isArray?Function.prototype&&Function.prototype.bind?Object.keys&&Object.create&&Object.getPrototypeOf&&Object.getOwnPropertyNames&&Object.isSealed&&Object.isFrozen&&Object.isExtensible&&Object.getOwnPropertyDescriptor&&Object.defineProperty&&Object.defineProperties&&Object.seal&&Object.freeze&&Object.preventExtensions?"JSON"in window&&"parse"in JSON&&"stringify"in JSON?function(){if(!("Worker"in window&&"Blob"in window&&"URL"in window))return!1;var S,z,P=new Blob([""],{type:"text/javascript"}),O=URL.createObjectURL(P);try{z=new Worker(O),S=!0}catch{S=!1}return z&&z.terminate(),URL.revokeObjectURL(O),S}()?"Uint8ClampedArray"in window?ArrayBuffer.isView?function(){var S=document.createElement("canvas");S.width=S.height=1;var z=S.getContext("2d");if(!z)return!1;var P=z.getImageData(0,0,1,1);return P&&P.width===S.width}()?(c[w=_&&_.failIfMajorPerformanceCaveat]===void 0&&(c[w]=function(S){var z=function(O){var G=document.createElement("canvas"),K=Object.create(s.webGLContextAttributes);return K.failIfMajorPerformanceCaveat=O,G.probablySupportsContext?G.probablySupportsContext("webgl",K)||G.probablySupportsContext("experimental-webgl",K):G.supportsContext?G.supportsContext("webgl",K)||G.supportsContext("experimental-webgl",K):G.getContext("webgl",K)||G.getContext("experimental-webgl",K)}(S);if(!z)return!1;var P=z.createShader(z.VERTEX_SHADER);return!(!P||z.isContextLost())&&(z.shaderSource(P,"void main() {}"),z.compileShader(P),z.getShaderParameter(P,z.COMPILE_STATUS)===!0)}(w)),c[w]?void 0:"insufficient WebGL support"):"insufficient Canvas/getImageData support":"insufficient ArrayBuffer support":"insufficient Uint8ClampedArray support":"insufficient worker support":"insufficient JSON support":"insufficient Object support":"insufficient Function support":"insufficent Array support";var w}n.exports?n.exports=s:window&&(window.mapboxgl=window.mapboxgl||{},window.mapboxgl.supported=s,window.mapboxgl.notSupportedReason=o);var c={};s.webGLContextAttributes={antialias:!1,alpha:!0,stencil:!0,depth:!0}}),E={create:function(n,s,o){var c=a.window.document.createElement(n);return s!==void 0&&(c.className=s),o&&o.appendChild(c),c},createNS:function(n,s){return a.window.document.createElementNS(n,s)}},M=a.window.document&&a.window.document.documentElement.style;function F(n){if(!M)return n[0];for(var s=0;s<n.length;s++)if(n[s]in M)return n[s];return n[0]}var R,D=F(["userSelect","MozUserSelect","WebkitUserSelect","msUserSelect"]);E.disableDrag=function(){M&&D&&(R=M[D],M[D]="none")},E.enableDrag=function(){M&&D&&(M[D]=R)};var H=F(["transform","WebkitTransform"]);E.setTransform=function(n,s){n.style[H]=s};var ie=!1;try{var de=Object.defineProperty({},"passive",{get:function(){ie=!0}});a.window.addEventListener("test",de,de),a.window.removeEventListener("test",de,de)}catch{ie=!1}E.addEventListener=function(n,s,o,c){c===void 0&&(c={}),n.addEventListener(s,o,"passive"in c&&ie?c:c.capture)},E.removeEventListener=function(n,s,o,c){c===void 0&&(c={}),n.removeEventListener(s,o,"passive"in c&&ie?c:c.capture)};var fe=function(n){n.preventDefault(),n.stopPropagation(),a.window.removeEventListener("click",fe,!0)};function we(n){var s=n.userImage;return!!(s&&s.render&&s.render())&&(n.data.replace(new Uint8Array(s.data.buffer)),!0)}E.suppressClick=function(){a.window.addEventListener("click",fe,!0),a.window.setTimeout(function(){a.window.removeEventListener("click",fe,!0)},0)},E.mousePos=function(n,s){var o=n.getBoundingClientRect();return new a.Point(s.clientX-o.left-n.clientLeft,s.clientY-o.top-n.clientTop)},E.touchPos=function(n,s){for(var o=n.getBoundingClientRect(),c=[],_=0;_<s.length;_++)c.push(new a.Point(s[_].clientX-o.left-n.clientLeft,s[_].clientY-o.top-n.clientTop));return c},E.mouseButton=function(n){return a.window.InstallTrigger!==void 0&&n.button===2&&n.ctrlKey&&a.window.navigator.platform.toUpperCase().indexOf("MAC")>=0?0:n.button},E.remove=function(n){n.parentNode&&n.parentNode.removeChild(n)};var xe=function(n){function s(){n.call(this),this.images={},this.updatedImages={},this.callbackDispatchedThisFrame={},this.loaded=!1,this.requestors=[],this.patterns={},this.atlasImage=new a.RGBAImage({width:1,height:1}),this.dirty=!0}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype.isLoaded=function(){return this.loaded},s.prototype.setLoaded=function(o){if(this.loaded!==o&&(this.loaded=o,o)){for(var c=0,_=this.requestors;c<_.length;c+=1){var w=_[c];this._notify(w.ids,w.callback)}this.requestors=[]}},s.prototype.getImage=function(o){return this.images[o]},s.prototype.addImage=function(o,c){this._validate(o,c)&&(this.images[o]=c)},s.prototype._validate=function(o,c){var _=!0;return this._validateStretch(c.stretchX,c.data&&c.data.width)||(this.fire(new a.ErrorEvent(new Error('Image "'+o+'" has invalid "stretchX" value'))),_=!1),this._validateStretch(c.stretchY,c.data&&c.data.height)||(this.fire(new a.ErrorEvent(new Error('Image "'+o+'" has invalid "stretchY" value'))),_=!1),this._validateContent(c.content,c)||(this.fire(new a.ErrorEvent(new Error('Image "'+o+'" has invalid "content" value'))),_=!1),_},s.prototype._validateStretch=function(o,c){if(!o)return!0;for(var _=0,w=0,S=o;w<S.length;w+=1){var z=S[w];if(z[0]<_||z[1]<z[0]||c<z[1])return!1;_=z[1]}return!0},s.prototype._validateContent=function(o,c){return!(o&&(o.length!==4||o[0]<0||c.data.width<o[0]||o[1]<0||c.data.height<o[1]||o[2]<0||c.data.width<o[2]||o[3]<0||c.data.height<o[3]||o[2]<o[0]||o[3]<o[1]))},s.prototype.updateImage=function(o,c){c.version=this.images[o].version+1,this.images[o]=c,this.updatedImages[o]=!0},s.prototype.removeImage=function(o){var c=this.images[o];delete this.images[o],delete this.patterns[o],c.userImage&&c.userImage.onRemove&&c.userImage.onRemove()},s.prototype.listImages=function(){return Object.keys(this.images)},s.prototype.getImages=function(o,c){var _=!0;if(!this.isLoaded())for(var w=0,S=o;w<S.length;w+=1)this.images[S[w]]||(_=!1);this.isLoaded()||_?this._notify(o,c):this.requestors.push({ids:o,callback:c})},s.prototype._notify=function(o,c){for(var _={},w=0,S=o;w<S.length;w+=1){var z=S[w];this.images[z]||this.fire(new a.Event("styleimagemissing",{id:z}));var P=this.images[z];P?_[z]={data:P.data.clone(),pixelRatio:P.pixelRatio,sdf:P.sdf,version:P.version,stretchX:P.stretchX,stretchY:P.stretchY,content:P.content,hasRenderCallback:!!(P.userImage&&P.userImage.render)}:a.warnOnce('Image "'+z+'" could not be loaded. Please make sure you have added the image with map.addImage() or a "sprite" property in your style. You can provide missing images by listening for the "styleimagemissing" map event.')}c(null,_)},s.prototype.getPixelSize=function(){var o=this.atlasImage;return{width:o.width,height:o.height}},s.prototype.getPattern=function(o){var c=this.patterns[o],_=this.getImage(o);if(!_)return null;if(c&&c.position.version===_.version)return c.position;if(c)c.position.version=_.version;else{var w={w:_.data.width+2,h:_.data.height+2,x:0,y:0},S=new a.ImagePosition(w,_);this.patterns[o]={bin:w,position:S}}return this._updatePatternAtlas(),this.patterns[o].position},s.prototype.bind=function(o){var c=o.gl;this.atlasTexture?this.dirty&&(this.atlasTexture.update(this.atlasImage),this.dirty=!1):this.atlasTexture=new a.Texture(o,this.atlasImage,c.RGBA),this.atlasTexture.bind(c.LINEAR,c.CLAMP_TO_EDGE)},s.prototype._updatePatternAtlas=function(){var o=[];for(var c in this.patterns)o.push(this.patterns[c].bin);var _=a.potpack(o),w=_.w,S=_.h,z=this.atlasImage;for(var P in z.resize({width:w||1,height:S||1}),this.patterns){var O=this.patterns[P].bin,G=O.x+1,K=O.y+1,X=this.images[P].data,re=X.width,te=X.height;a.RGBAImage.copy(X,z,{x:0,y:0},{x:G,y:K},{width:re,height:te}),a.RGBAImage.copy(X,z,{x:0,y:te-1},{x:G,y:K-1},{width:re,height:1}),a.RGBAImage.copy(X,z,{x:0,y:0},{x:G,y:K+te},{width:re,height:1}),a.RGBAImage.copy(X,z,{x:re-1,y:0},{x:G-1,y:K},{width:1,height:te}),a.RGBAImage.copy(X,z,{x:0,y:0},{x:G+re,y:K},{width:1,height:te})}this.dirty=!0},s.prototype.beginFrame=function(){this.callbackDispatchedThisFrame={}},s.prototype.dispatchRenderCallbacks=function(o){for(var c=0,_=o;c<_.length;c+=1){var w=_[c];if(!this.callbackDispatchedThisFrame[w]){this.callbackDispatchedThisFrame[w]=!0;var S=this.images[w];we(S)&&this.updateImage(w,S)}}},s}(a.Evented),st=Je,$e=Je,Me=1e20;function Je(n,s,o,c,_,w){this.fontSize=n||24,this.buffer=s===void 0?3:s,this.cutoff=c||.25,this.fontFamily=_||"sans-serif",this.fontWeight=w||"normal",this.radius=o||8;var S=this.size=this.fontSize+2*this.buffer;this.canvas=document.createElement("canvas"),this.canvas.width=this.canvas.height=S,this.ctx=this.canvas.getContext("2d"),this.ctx.font=this.fontWeight+" "+this.fontSize+"px "+this.fontFamily,this.ctx.textBaseline="middle",this.ctx.fillStyle="black",this.gridOuter=new Float64Array(S*S),this.gridInner=new Float64Array(S*S),this.f=new Float64Array(S),this.d=new Float64Array(S),this.z=new Float64Array(S+1),this.v=new Int16Array(S),this.middle=Math.round(S/2*(navigator.userAgent.indexOf("Gecko/")>=0?1.2:1))}function ct(n,s,o,c,_,w,S){for(var z=0;z<s;z++){for(var P=0;P<o;P++)c[P]=n[P*s+z];for(Ue(c,_,w,S,o),P=0;P<o;P++)n[P*s+z]=_[P]}for(P=0;P<o;P++){for(z=0;z<s;z++)c[z]=n[P*s+z];for(Ue(c,_,w,S,s),z=0;z<s;z++)n[P*s+z]=Math.sqrt(_[z])}}function Ue(n,s,o,c,_){o[0]=0,c[0]=-Me,c[1]=+Me;for(var w=1,S=0;w<_;w++){for(var z=(n[w]+w*w-(n[o[S]]+o[S]*o[S]))/(2*w-2*o[S]);z<=c[S];)S--,z=(n[w]+w*w-(n[o[S]]+o[S]*o[S]))/(2*w-2*o[S]);o[++S]=w,c[S]=z,c[S+1]=+Me}for(w=0,S=0;w<_;w++){for(;c[S+1]<w;)S++;s[w]=(w-o[S])*(w-o[S])+n[o[S]]}}Je.prototype.draw=function(n){this.ctx.clearRect(0,0,this.size,this.size),this.ctx.fillText(n,this.buffer,this.middle);for(var s=this.ctx.getImageData(0,0,this.size,this.size),o=new Uint8ClampedArray(this.size*this.size),c=0;c<this.size*this.size;c++){var _=s.data[4*c+3]/255;this.gridOuter[c]=_===1?0:_===0?Me:Math.pow(Math.max(0,.5-_),2),this.gridInner[c]=_===1?Me:_===0?0:Math.pow(Math.max(0,_-.5),2)}for(ct(this.gridOuter,this.size,this.size,this.f,this.d,this.v,this.z),ct(this.gridInner,this.size,this.size,this.f,this.d,this.v,this.z),c=0;c<this.size*this.size;c++)o[c]=Math.max(0,Math.min(255,Math.round(255-255*((this.gridOuter[c]-this.gridInner[c])/this.radius+this.cutoff))));return o},st.default=$e;var ht=function(n,s){this.requestManager=n,this.localIdeographFontFamily=s,this.entries={}};ht.prototype.setURL=function(n){this.url=n},ht.prototype.getGlyphs=function(n,s){var o=this,c=[];for(var _ in n)for(var w=0,S=n[_];w<S.length;w+=1)c.push({stack:_,id:S[w]});a.asyncAll(c,function(z,P){var O=z.stack,G=z.id,K=o.entries[O];K||(K=o.entries[O]={glyphs:{},requests:{},ranges:{}});var X=K.glyphs[G];if(X===void 0){if(X=o._tinySDF(K,O,G))return K.glyphs[G]=X,void P(null,{stack:O,id:G,glyph:X});var re=Math.floor(G/256);if(256*re>65535)P(new Error("glyphs > 65535 not supported"));else if(K.ranges[re])P(null,{stack:O,id:G,glyph:X});else{var te=K.requests[re];te||(te=K.requests[re]=[],ht.loadGlyphRange(O,re,o.url,o.requestManager,function(ue,Y){if(Y){for(var le in Y)o._doesCharSupportLocalGlyph(+le)||(K.glyphs[+le]=Y[+le]);K.ranges[re]=!0}for(var pe=0,ve=te;pe<ve.length;pe+=1)(0,ve[pe])(ue,Y);delete K.requests[re]})),te.push(function(ue,Y){ue?P(ue):Y&&P(null,{stack:O,id:G,glyph:Y[G]||null})})}}else P(null,{stack:O,id:G,glyph:X})},function(z,P){if(z)s(z);else if(P){for(var O={},G=0,K=P;G<K.length;G+=1){var X=K[G],re=X.stack,te=X.id,ue=X.glyph;(O[re]||(O[re]={}))[te]=ue&&{id:ue.id,bitmap:ue.bitmap.clone(),metrics:ue.metrics}}s(null,O)}})},ht.prototype._doesCharSupportLocalGlyph=function(n){return!!this.localIdeographFontFamily&&(a.isChar["CJK Unified Ideographs"](n)||a.isChar["Hangul Syllables"](n)||a.isChar.Hiragana(n)||a.isChar.Katakana(n))},ht.prototype._tinySDF=function(n,s,o){var c=this.localIdeographFontFamily;if(c&&this._doesCharSupportLocalGlyph(o)){var _=n.tinySDF;if(!_){var w="400";/bold/i.test(s)?w="900":/medium/i.test(s)?w="500":/light/i.test(s)&&(w="200"),_=n.tinySDF=new ht.TinySDF(24,3,8,.25,c,w)}return{id:o,bitmap:new a.AlphaImage({width:30,height:30},_.draw(String.fromCharCode(o))),metrics:{width:24,height:24,left:0,top:-8,advance:24}}}},ht.loadGlyphRange=function(n,s,o,c,_){var w=256*s,S=w+255,z=c.transformRequest(c.normalizeGlyphsURL(o).replace("{fontstack}",n).replace("{range}",w+"-"+S),a.ResourceType.Glyphs);a.getArrayBuffer(z,function(P,O){if(P)_(P);else if(O){for(var G={},K=0,X=a.parseGlyphPBF(O);K<X.length;K+=1){var re=X[K];G[re.id]=re}_(null,G)}})},ht.TinySDF=st;var _t=function(){this.specification=a.styleSpec.light.position};_t.prototype.possiblyEvaluate=function(n,s){return a.sphericalToCartesian(n.expression.evaluate(s))},_t.prototype.interpolate=function(n,s,o){return{x:a.number(n.x,s.x,o),y:a.number(n.y,s.y,o),z:a.number(n.z,s.z,o)}};var pt=new a.Properties({anchor:new a.DataConstantProperty(a.styleSpec.light.anchor),position:new _t,color:new a.DataConstantProperty(a.styleSpec.light.color),intensity:new a.DataConstantProperty(a.styleSpec.light.intensity)}),Nt=function(n){function s(o){n.call(this),this._transitionable=new a.Transitionable(pt),this.setLight(o),this._transitioning=this._transitionable.untransitioned()}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype.getLight=function(){return this._transitionable.serialize()},s.prototype.setLight=function(o,c){if(c===void 0&&(c={}),!this._validate(a.validateLight,o,c))for(var _ in o){var w=o[_];a.endsWith(_,"-transition")?this._transitionable.setTransition(_.slice(0,-11),w):this._transitionable.setValue(_,w)}},s.prototype.updateTransitions=function(o){this._transitioning=this._transitionable.transitioned(o,this._transitioning)},s.prototype.hasTransition=function(){return this._transitioning.hasTransition()},s.prototype.recalculate=function(o){this.properties=this._transitioning.possiblyEvaluate(o)},s.prototype._validate=function(o,c,_){return(!_||_.validate!==!1)&&a.emitValidationErrors(this,o.call(a.validateStyle,a.extend({value:c,style:{glyphs:!0,sprite:!0},styleSpec:a.styleSpec})))},s}(a.Evented),bt=function(n,s){this.width=n,this.height=s,this.nextRow=0,this.data=new Uint8Array(this.width*this.height),this.dashEntry={}};bt.prototype.getDash=function(n,s){var o=n.join(",")+String(s);return this.dashEntry[o]||(this.dashEntry[o]=this.addDash(n,s)),this.dashEntry[o]},bt.prototype.getDashRanges=function(n,s,o){var c=[],_=n.length%2==1?-n[n.length-1]*o:0,w=n[0]*o,S=!0;c.push({left:_,right:w,isDash:S,zeroLength:n[0]===0});for(var z=n[0],P=1;P<n.length;P++){var O=n[P];c.push({left:_=z*o,right:w=(z+=O)*o,isDash:S=!S,zeroLength:O===0})}return c},bt.prototype.addRoundDash=function(n,s,o){for(var c=s/2,_=-o;_<=o;_++)for(var w=this.width*(this.nextRow+o+_),S=0,z=n[S],P=0;P<this.width;P++){P/z.right>1&&(z=n[++S]);var O=Math.abs(P-z.left),G=Math.abs(P-z.right),K=Math.min(O,G),X=void 0,re=_/o*(c+1);if(z.isDash){var te=c-Math.abs(re);X=Math.sqrt(K*K+te*te)}else X=c-Math.sqrt(K*K+re*re);this.data[w+P]=Math.max(0,Math.min(255,X+128))}},bt.prototype.addRegularDash=function(n){for(var s=n.length-1;s>=0;--s){var o=n[s],c=n[s+1];o.zeroLength?n.splice(s,1):c&&c.isDash===o.isDash&&(c.left=o.left,n.splice(s,1))}var _=n[0],w=n[n.length-1];_.isDash===w.isDash&&(_.left=w.left-this.width,w.right=_.right+this.width);for(var S=this.width*this.nextRow,z=0,P=n[z],O=0;O<this.width;O++){O/P.right>1&&(P=n[++z]);var G=Math.abs(O-P.left),K=Math.abs(O-P.right),X=Math.min(G,K);this.data[S+O]=Math.max(0,Math.min(255,(P.isDash?X:-X)+128))}},bt.prototype.addDash=function(n,s){var o=s?7:0,c=2*o+1;if(this.nextRow+c>this.height)return a.warnOnce("LineAtlas out of space"),null;for(var _=0,w=0;w<n.length;w++)_+=n[w];if(_!==0){var S=this.width/_,z=this.getDashRanges(n,this.width,S);s?this.addRoundDash(z,S,o):this.addRegularDash(z)}var P={y:(this.nextRow+o+.5)/this.height,height:2*o/this.height,width:_};return this.nextRow+=c,this.dirty=!0,P},bt.prototype.bind=function(n){var s=n.gl;this.texture?(s.bindTexture(s.TEXTURE_2D,this.texture),this.dirty&&(this.dirty=!1,s.texSubImage2D(s.TEXTURE_2D,0,0,0,this.width,this.height,s.ALPHA,s.UNSIGNED_BYTE,this.data))):(this.texture=s.createTexture(),s.bindTexture(s.TEXTURE_2D,this.texture),s.texParameteri(s.TEXTURE_2D,s.TEXTURE_WRAP_S,s.REPEAT),s.texParameteri(s.TEXTURE_2D,s.TEXTURE_WRAP_T,s.REPEAT),s.texParameteri(s.TEXTURE_2D,s.TEXTURE_MIN_FILTER,s.LINEAR),s.texParameteri(s.TEXTURE_2D,s.TEXTURE_MAG_FILTER,s.LINEAR),s.texImage2D(s.TEXTURE_2D,0,s.ALPHA,this.width,this.height,0,s.ALPHA,s.UNSIGNED_BYTE,this.data))};var zt=function n(s,o){this.workerPool=s,this.actors=[],this.currentActor=0,this.id=a.uniqueId();for(var c=this.workerPool.acquire(this.id),_=0;_<c.length;_++){var w=new n.Actor(c[_],o,this.id);w.name="Worker "+_,this.actors.push(w)}};function rt(n,s,o){var c=function(_,w){if(_)return o(_);if(w){var S=a.pick(a.extend(w,n),["tiles","minzoom","maxzoom","attribution","mapbox_logo","bounds","scheme","tileSize","encoding"]);w.vector_layers&&(S.vectorLayers=w.vector_layers,S.vectorLayerIds=S.vectorLayers.map(function(z){return z.id})),S.tiles=s.canonicalizeTileset(S,n.url),o(null,S)}};return n.url?a.getJSON(s.transformRequest(s.normalizeSourceURL(n.url),a.ResourceType.Source),c):a.browser.frame(function(){return c(null,n)})}zt.prototype.broadcast=function(n,s,o){a.asyncAll(this.actors,function(c,_){c.send(n,s,_)},o=o||function(){})},zt.prototype.getActor=function(){return this.currentActor=(this.currentActor+1)%this.actors.length,this.actors[this.currentActor]},zt.prototype.remove=function(){this.actors.forEach(function(n){n.remove()}),this.actors=[],this.workerPool.release(this.id)},zt.Actor=a.Actor;var Zt=function(n,s,o){this.bounds=a.LngLatBounds.convert(this.validateBounds(n)),this.minzoom=s||0,this.maxzoom=o||24};Zt.prototype.validateBounds=function(n){return Array.isArray(n)&&n.length===4?[Math.max(-180,n[0]),Math.max(-90,n[1]),Math.min(180,n[2]),Math.min(90,n[3])]:[-180,-90,180,90]},Zt.prototype.contains=function(n){var s=Math.pow(2,n.z),o=Math.floor(a.mercatorXfromLng(this.bounds.getWest())*s),c=Math.floor(a.mercatorYfromLat(this.bounds.getNorth())*s),_=Math.ceil(a.mercatorXfromLng(this.bounds.getEast())*s),w=Math.ceil(a.mercatorYfromLat(this.bounds.getSouth())*s);return n.x>=o&&n.x<_&&n.y>=c&&n.y<w};var gt=function(n){function s(o,c,_,w){if(n.call(this),this.id=o,this.dispatcher=_,this.type="vector",this.minzoom=0,this.maxzoom=22,this.scheme="xyz",this.tileSize=512,this.reparseOverscaled=!0,this.isTileClipped=!0,this._loaded=!1,a.extend(this,a.pick(c,["url","scheme","tileSize","promoteId"])),this._options=a.extend({type:"vector"},c),this._collectResourceTiming=c.collectResourceTiming,this.tileSize!==512)throw new Error("vector tile sources must have a tileSize of 512");this.setEventedParent(w)}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype.load=function(){var o=this;this._loaded=!1,this.fire(new a.Event("dataloading",{dataType:"source"})),this._tileJSONRequest=rt(this._options,this.map._requestManager,function(c,_){o._tileJSONRequest=null,o._loaded=!0,c?o.fire(new a.ErrorEvent(c)):_&&(a.extend(o,_),_.bounds&&(o.tileBounds=new Zt(_.bounds,o.minzoom,o.maxzoom)),a.postTurnstileEvent(_.tiles,o.map._requestManager._customAccessToken),a.postMapLoadEvent(_.tiles,o.map._getMapId(),o.map._requestManager._skuToken,o.map._requestManager._customAccessToken),o.fire(new a.Event("data",{dataType:"source",sourceDataType:"metadata"})),o.fire(new a.Event("data",{dataType:"source",sourceDataType:"content"})))})},s.prototype.loaded=function(){return this._loaded},s.prototype.hasTile=function(o){return!this.tileBounds||this.tileBounds.contains(o.canonical)},s.prototype.onAdd=function(o){this.map=o,this.load()},s.prototype.setSourceProperty=function(o){this._tileJSONRequest&&this._tileJSONRequest.cancel(),o(),this.map.style.sourceCaches[this.id].clearTiles(),this.load()},s.prototype.setTiles=function(o){var c=this;return this.setSourceProperty(function(){c._options.tiles=o}),this},s.prototype.setUrl=function(o){var c=this;return this.setSourceProperty(function(){c.url=o,c._options.url=o}),this},s.prototype.onRemove=function(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)},s.prototype.serialize=function(){return a.extend({},this._options)},s.prototype.loadTile=function(o,c){var _=this.map._requestManager.normalizeTileURL(o.tileID.canonical.url(this.tiles,this.scheme)),w={request:this.map._requestManager.transformRequest(_,a.ResourceType.Tile),uid:o.uid,tileID:o.tileID,zoom:o.tileID.overscaledZ,tileSize:this.tileSize*o.tileID.overscaleFactor(),type:this.type,source:this.id,pixelRatio:a.browser.devicePixelRatio,showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId};function S(z,P){return delete o.request,o.aborted?c(null):z&&z.status!==404?c(z):(P&&P.resourceTiming&&(o.resourceTiming=P.resourceTiming),this.map._refreshExpiredTiles&&P&&o.setExpiryData(P),o.loadVectorData(P,this.map.painter),a.cacheEntryPossiblyAdded(this.dispatcher),c(null),void(o.reloadCallback&&(this.loadTile(o,o.reloadCallback),o.reloadCallback=null)))}w.request.collectResourceTiming=this._collectResourceTiming,o.actor&&o.state!=="expired"?o.state==="loading"?o.reloadCallback=c:o.request=o.actor.send("reloadTile",w,S.bind(this)):(o.actor=this.dispatcher.getActor(),o.request=o.actor.send("loadTile",w,S.bind(this)))},s.prototype.abortTile=function(o){o.request&&(o.request.cancel(),delete o.request),o.actor&&o.actor.send("abortTile",{uid:o.uid,type:this.type,source:this.id},void 0)},s.prototype.unloadTile=function(o){o.unloadVectorData(),o.actor&&o.actor.send("removeTile",{uid:o.uid,type:this.type,source:this.id},void 0)},s.prototype.hasTransition=function(){return!1},s}(a.Evented),It=function(n){function s(o,c,_,w){n.call(this),this.id=o,this.dispatcher=_,this.setEventedParent(w),this.type="raster",this.minzoom=0,this.maxzoom=22,this.roundZoom=!0,this.scheme="xyz",this.tileSize=512,this._loaded=!1,this._options=a.extend({type:"raster"},c),a.extend(this,a.pick(c,["url","scheme","tileSize"]))}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype.load=function(){var o=this;this._loaded=!1,this.fire(new a.Event("dataloading",{dataType:"source"})),this._tileJSONRequest=rt(this._options,this.map._requestManager,function(c,_){o._tileJSONRequest=null,o._loaded=!0,c?o.fire(new a.ErrorEvent(c)):_&&(a.extend(o,_),_.bounds&&(o.tileBounds=new Zt(_.bounds,o.minzoom,o.maxzoom)),a.postTurnstileEvent(_.tiles),a.postMapLoadEvent(_.tiles,o.map._getMapId(),o.map._requestManager._skuToken),o.fire(new a.Event("data",{dataType:"source",sourceDataType:"metadata"})),o.fire(new a.Event("data",{dataType:"source",sourceDataType:"content"})))})},s.prototype.loaded=function(){return this._loaded},s.prototype.onAdd=function(o){this.map=o,this.load()},s.prototype.onRemove=function(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)},s.prototype.serialize=function(){return a.extend({},this._options)},s.prototype.hasTile=function(o){return!this.tileBounds||this.tileBounds.contains(o.canonical)},s.prototype.loadTile=function(o,c){var _=this,w=this.map._requestManager.normalizeTileURL(o.tileID.canonical.url(this.tiles,this.scheme),this.tileSize);o.request=a.getImage(this.map._requestManager.transformRequest(w,a.ResourceType.Tile),function(S,z){if(delete o.request,o.aborted)o.state="unloaded",c(null);else if(S)o.state="errored",c(S);else if(z){_.map._refreshExpiredTiles&&o.setExpiryData(z),delete z.cacheControl,delete z.expires;var P=_.map.painter.context,O=P.gl;o.texture=_.map.painter.getTileTexture(z.width),o.texture?o.texture.update(z,{useMipmap:!0}):(o.texture=new a.Texture(P,z,O.RGBA,{useMipmap:!0}),o.texture.bind(O.LINEAR,O.CLAMP_TO_EDGE,O.LINEAR_MIPMAP_NEAREST),P.extTextureFilterAnisotropic&&O.texParameterf(O.TEXTURE_2D,P.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,P.extTextureFilterAnisotropicMax)),o.state="loaded",a.cacheEntryPossiblyAdded(_.dispatcher),c(null)}})},s.prototype.abortTile=function(o,c){o.request&&(o.request.cancel(),delete o.request),c()},s.prototype.unloadTile=function(o,c){o.texture&&this.map.painter.saveTileTexture(o.texture),c()},s.prototype.hasTransition=function(){return!1},s}(a.Evented),jt=function(n){function s(o,c,_,w){n.call(this,o,c,_,w),this.type="raster-dem",this.maxzoom=22,this._options=a.extend({type:"raster-dem"},c),this.encoding=c.encoding||"mapbox"}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype.serialize=function(){return{type:"raster-dem",url:this.url,tileSize:this.tileSize,tiles:this.tiles,bounds:this.bounds,encoding:this.encoding}},s.prototype.loadTile=function(o,c){var _=this.map._requestManager.normalizeTileURL(o.tileID.canonical.url(this.tiles,this.scheme),this.tileSize);function w(S,z){S&&(o.state="errored",c(S)),z&&(o.dem=z,o.needsHillshadePrepare=!0,o.state="loaded",c(null))}o.request=a.getImage(this.map._requestManager.transformRequest(_,a.ResourceType.Tile),(function(S,z){if(delete o.request,o.aborted)o.state="unloaded",c(null);else if(S)o.state="errored",c(S);else if(z){this.map._refreshExpiredTiles&&o.setExpiryData(z),delete z.cacheControl,delete z.expires;var P=a.window.ImageBitmap&&z instanceof a.window.ImageBitmap&&a.offscreenCanvasSupported()?z:a.browser.getImageData(z,1),O={uid:o.uid,coord:o.tileID,source:this.id,rawImageData:P,encoding:this.encoding};o.actor&&o.state!=="expired"||(o.actor=this.dispatcher.getActor(),o.actor.send("loadDEMTile",O,w.bind(this)))}}).bind(this)),o.neighboringTiles=this._getNeighboringTiles(o.tileID)},s.prototype._getNeighboringTiles=function(o){var c=o.canonical,_=Math.pow(2,c.z),w=(c.x-1+_)%_,S=c.x===0?o.wrap-1:o.wrap,z=(c.x+1+_)%_,P=c.x+1===_?o.wrap+1:o.wrap,O={};return O[new a.OverscaledTileID(o.overscaledZ,S,c.z,w,c.y).key]={backfilled:!1},O[new a.OverscaledTileID(o.overscaledZ,P,c.z,z,c.y).key]={backfilled:!1},c.y>0&&(O[new a.OverscaledTileID(o.overscaledZ,S,c.z,w,c.y-1).key]={backfilled:!1},O[new a.OverscaledTileID(o.overscaledZ,o.wrap,c.z,c.x,c.y-1).key]={backfilled:!1},O[new a.OverscaledTileID(o.overscaledZ,P,c.z,z,c.y-1).key]={backfilled:!1}),c.y+1<_&&(O[new a.OverscaledTileID(o.overscaledZ,S,c.z,w,c.y+1).key]={backfilled:!1},O[new a.OverscaledTileID(o.overscaledZ,o.wrap,c.z,c.x,c.y+1).key]={backfilled:!1},O[new a.OverscaledTileID(o.overscaledZ,P,c.z,z,c.y+1).key]={backfilled:!1}),O},s.prototype.unloadTile=function(o){o.demTexture&&this.map.painter.saveTileTexture(o.demTexture),o.fbo&&(o.fbo.destroy(),delete o.fbo),o.dem&&delete o.dem,delete o.neighboringTiles,o.state="unloaded",o.actor&&o.actor.send("removeDEMTile",{uid:o.uid,source:this.id})},s}(It),ei=function(n){function s(o,c,_,w){n.call(this),this.id=o,this.type="geojson",this.minzoom=0,this.maxzoom=18,this.tileSize=512,this.isTileClipped=!0,this.reparseOverscaled=!0,this._removed=!1,this._loaded=!1,this.actor=_.getActor(),this.setEventedParent(w),this._data=c.data,this._options=a.extend({},c),this._collectResourceTiming=c.collectResourceTiming,this._resourceTiming=[],c.maxzoom!==void 0&&(this.maxzoom=c.maxzoom),c.type&&(this.type=c.type),c.attribution&&(this.attribution=c.attribution),this.promoteId=c.promoteId;var S=a.EXTENT/this.tileSize;this.workerOptions=a.extend({source:this.id,cluster:c.cluster||!1,geojsonVtOptions:{buffer:(c.buffer!==void 0?c.buffer:128)*S,tolerance:(c.tolerance!==void 0?c.tolerance:.375)*S,extent:a.EXTENT,maxZoom:this.maxzoom,lineMetrics:c.lineMetrics||!1,generateId:c.generateId||!1},superclusterOptions:{maxZoom:c.clusterMaxZoom!==void 0?Math.min(c.clusterMaxZoom,this.maxzoom-1):this.maxzoom-1,minPoints:Math.max(2,c.clusterMinPoints||2),extent:a.EXTENT,radius:(c.clusterRadius||50)*S,log:!1,generateId:c.generateId||!1},clusterProperties:c.clusterProperties,filter:c.filter},c.workerOptions)}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype.load=function(){var o=this;this.fire(new a.Event("dataloading",{dataType:"source"})),this._updateWorkerData(function(c){if(c)o.fire(new a.ErrorEvent(c));else{var _={dataType:"source",sourceDataType:"metadata"};o._collectResourceTiming&&o._resourceTiming&&o._resourceTiming.length>0&&(_.resourceTiming=o._resourceTiming,o._resourceTiming=[]),o.fire(new a.Event("data",_))}})},s.prototype.onAdd=function(o){this.map=o,this.load()},s.prototype.setData=function(o){var c=this;return this._data=o,this.fire(new a.Event("dataloading",{dataType:"source"})),this._updateWorkerData(function(_){if(_)c.fire(new a.ErrorEvent(_));else{var w={dataType:"source",sourceDataType:"content"};c._collectResourceTiming&&c._resourceTiming&&c._resourceTiming.length>0&&(w.resourceTiming=c._resourceTiming,c._resourceTiming=[]),c.fire(new a.Event("data",w))}}),this},s.prototype.getClusterExpansionZoom=function(o,c){return this.actor.send("geojson.getClusterExpansionZoom",{clusterId:o,source:this.id},c),this},s.prototype.getClusterChildren=function(o,c){return this.actor.send("geojson.getClusterChildren",{clusterId:o,source:this.id},c),this},s.prototype.getClusterLeaves=function(o,c,_,w){return this.actor.send("geojson.getClusterLeaves",{source:this.id,clusterId:o,limit:c,offset:_},w),this},s.prototype._updateWorkerData=function(o){var c=this;this._loaded=!1;var _=a.extend({},this.workerOptions),w=this._data;typeof w=="string"?(_.request=this.map._requestManager.transformRequest(a.browser.resolveURL(w),a.ResourceType.Source),_.request.collectResourceTiming=this._collectResourceTiming):_.data=JSON.stringify(w),this.actor.send(this.type+".loadData",_,function(S,z){c._removed||z&&z.abandoned||(c._loaded=!0,z&&z.resourceTiming&&z.resourceTiming[c.id]&&(c._resourceTiming=z.resourceTiming[c.id].slice(0)),c.actor.send(c.type+".coalesce",{source:_.source},null),o(S))})},s.prototype.loaded=function(){return this._loaded},s.prototype.loadTile=function(o,c){var _=this,w=o.actor?"reloadTile":"loadTile";o.actor=this.actor,o.request=this.actor.send(w,{type:this.type,uid:o.uid,tileID:o.tileID,zoom:o.tileID.overscaledZ,maxZoom:this.maxzoom,tileSize:this.tileSize,source:this.id,pixelRatio:a.browser.devicePixelRatio,showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId},function(S,z){return delete o.request,o.unloadVectorData(),o.aborted?c(null):S?c(S):(o.loadVectorData(z,_.map.painter,w==="reloadTile"),c(null))})},s.prototype.abortTile=function(o){o.request&&(o.request.cancel(),delete o.request),o.aborted=!0},s.prototype.unloadTile=function(o){o.unloadVectorData(),this.actor.send("removeTile",{uid:o.uid,type:this.type,source:this.id})},s.prototype.onRemove=function(){this._removed=!0,this.actor.send("removeSource",{type:this.type,source:this.id})},s.prototype.serialize=function(){return a.extend({},this._options,{type:this.type,data:this._data})},s.prototype.hasTransition=function(){return!1},s}(a.Evented),We=a.createLayout([{name:"a_pos",type:"Int16",components:2},{name:"a_texture_pos",type:"Int16",components:2}]),At=function(n){function s(o,c,_,w){n.call(this),this.id=o,this.dispatcher=_,this.coordinates=c.coordinates,this.type="image",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this.tiles={},this._loaded=!1,this.setEventedParent(w),this.options=c}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype.load=function(o,c){var _=this;this._loaded=!1,this.fire(new a.Event("dataloading",{dataType:"source"})),this.url=this.options.url,a.getImage(this.map._requestManager.transformRequest(this.url,a.ResourceType.Image),function(w,S){_._loaded=!0,w?_.fire(new a.ErrorEvent(w)):S&&(_.image=S,o&&(_.coordinates=o),c&&c(),_._finishLoading())})},s.prototype.loaded=function(){return this._loaded},s.prototype.updateImage=function(o){var c=this;return this.image&&o.url?(this.options.url=o.url,this.load(o.coordinates,function(){c.texture=null}),this):this},s.prototype._finishLoading=function(){this.map&&(this.setCoordinates(this.coordinates),this.fire(new a.Event("data",{dataType:"source",sourceDataType:"metadata"})))},s.prototype.onAdd=function(o){this.map=o,this.load()},s.prototype.setCoordinates=function(o){var c=this;this.coordinates=o;var _=o.map(a.MercatorCoordinate.fromLngLat);this.tileID=function(S){for(var z=1/0,P=1/0,O=-1/0,G=-1/0,K=0,X=S;K<X.length;K+=1){var re=X[K];z=Math.min(z,re.x),P=Math.min(P,re.y),O=Math.max(O,re.x),G=Math.max(G,re.y)}var te=Math.max(O-z,G-P),ue=Math.max(0,Math.floor(-Math.log(te)/Math.LN2)),Y=Math.pow(2,ue);return new a.CanonicalTileID(ue,Math.floor((z+O)/2*Y),Math.floor((P+G)/2*Y))}(_),this.minzoom=this.maxzoom=this.tileID.z;var w=_.map(function(S){return c.tileID.getTilePoint(S)._round()});return this._boundsArray=new a.StructArrayLayout4i8,this._boundsArray.emplaceBack(w[0].x,w[0].y,0,0),this._boundsArray.emplaceBack(w[1].x,w[1].y,a.EXTENT,0),this._boundsArray.emplaceBack(w[3].x,w[3].y,0,a.EXTENT),this._boundsArray.emplaceBack(w[2].x,w[2].y,a.EXTENT,a.EXTENT),this.boundsBuffer&&(this.boundsBuffer.destroy(),delete this.boundsBuffer),this.fire(new a.Event("data",{dataType:"source",sourceDataType:"content"})),this},s.prototype.prepare=function(){if(Object.keys(this.tiles).length!==0&&this.image){var o=this.map.painter.context,c=o.gl;for(var _ in this.boundsBuffer||(this.boundsBuffer=o.createVertexBuffer(this._boundsArray,We.members)),this.boundsSegments||(this.boundsSegments=a.SegmentVector.simpleSegment(0,0,4,2)),this.texture||(this.texture=new a.Texture(o,this.image,c.RGBA),this.texture.bind(c.LINEAR,c.CLAMP_TO_EDGE)),this.tiles){var w=this.tiles[_];w.state!=="loaded"&&(w.state="loaded",w.texture=this.texture)}}},s.prototype.loadTile=function(o,c){this.tileID&&this.tileID.equals(o.tileID.canonical)?(this.tiles[String(o.tileID.wrap)]=o,o.buckets={},c(null)):(o.state="errored",c(null))},s.prototype.serialize=function(){return{type:"image",url:this.options.url,coordinates:this.coordinates}},s.prototype.hasTransition=function(){return!1},s}(a.Evented),mr=function(n){function s(o,c,_,w){n.call(this,o,c,_,w),this.roundZoom=!0,this.type="video",this.options=c}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype.load=function(){var o=this;this._loaded=!1;var c=this.options;this.urls=[];for(var _=0,w=c.urls;_<w.length;_+=1)this.urls.push(this.map._requestManager.transformRequest(w[_],a.ResourceType.Source).url);a.getVideo(this.urls,function(S,z){o._loaded=!0,S?o.fire(new a.ErrorEvent(S)):z&&(o.video=z,o.video.loop=!0,o.video.addEventListener("playing",function(){o.map.triggerRepaint()}),o.map&&o.video.play(),o._finishLoading())})},s.prototype.pause=function(){this.video&&this.video.pause()},s.prototype.play=function(){this.video&&this.video.play()},s.prototype.seek=function(o){if(this.video){var c=this.video.seekable;o<c.start(0)||o>c.end(0)?this.fire(new a.ErrorEvent(new a.ValidationError("sources."+this.id,null,"Playback for this video can be set only between the "+c.start(0)+" and "+c.end(0)+"-second mark."))):this.video.currentTime=o}},s.prototype.getVideo=function(){return this.video},s.prototype.onAdd=function(o){this.map||(this.map=o,this.load(),this.video&&(this.video.play(),this.setCoordinates(this.coordinates)))},s.prototype.prepare=function(){if(!(Object.keys(this.tiles).length===0||this.video.readyState<2)){var o=this.map.painter.context,c=o.gl;for(var _ in this.boundsBuffer||(this.boundsBuffer=o.createVertexBuffer(this._boundsArray,We.members)),this.boundsSegments||(this.boundsSegments=a.SegmentVector.simpleSegment(0,0,4,2)),this.texture?this.video.paused||(this.texture.bind(c.LINEAR,c.CLAMP_TO_EDGE),c.texSubImage2D(c.TEXTURE_2D,0,0,0,c.RGBA,c.UNSIGNED_BYTE,this.video)):(this.texture=new a.Texture(o,this.video,c.RGBA),this.texture.bind(c.LINEAR,c.CLAMP_TO_EDGE)),this.tiles){var w=this.tiles[_];w.state!=="loaded"&&(w.state="loaded",w.texture=this.texture)}}},s.prototype.serialize=function(){return{type:"video",urls:this.urls,coordinates:this.coordinates}},s.prototype.hasTransition=function(){return this.video&&!this.video.paused},s}(At),Tr=function(n){function s(o,c,_,w){n.call(this,o,c,_,w),c.coordinates?Array.isArray(c.coordinates)&&c.coordinates.length===4&&!c.coordinates.some(function(S){return!Array.isArray(S)||S.length!==2||S.some(function(z){return typeof z!="number"})})||this.fire(new a.ErrorEvent(new a.ValidationError("sources."+o,null,'"coordinates" property must be an array of 4 longitude/latitude array pairs'))):this.fire(new a.ErrorEvent(new a.ValidationError("sources."+o,null,'missing required property "coordinates"'))),c.animate&&typeof c.animate!="boolean"&&this.fire(new a.ErrorEvent(new a.ValidationError("sources."+o,null,'optional "animate" property must be a boolean value'))),c.canvas?typeof c.canvas=="string"||c.canvas instanceof a.window.HTMLCanvasElement||this.fire(new a.ErrorEvent(new a.ValidationError("sources."+o,null,'"canvas" must be either a string representing the ID of the canvas element from which to read, or an HTMLCanvasElement instance'))):this.fire(new a.ErrorEvent(new a.ValidationError("sources."+o,null,'missing required property "canvas"'))),this.options=c,this.animate=c.animate===void 0||c.animate}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype.load=function(){this._loaded=!0,this.canvas||(this.canvas=this.options.canvas instanceof a.window.HTMLCanvasElement?this.options.canvas:a.window.document.getElementById(this.options.canvas)),this.width=this.canvas.width,this.height=this.canvas.height,this._hasInvalidDimensions()?this.fire(new a.ErrorEvent(new Error("Canvas dimensions cannot be less than or equal to zero."))):(this.play=function(){this._playing=!0,this.map.triggerRepaint()},this.pause=function(){this._playing&&(this.prepare(),this._playing=!1)},this._finishLoading())},s.prototype.getCanvas=function(){return this.canvas},s.prototype.onAdd=function(o){this.map=o,this.load(),this.canvas&&this.animate&&this.play()},s.prototype.onRemove=function(){this.pause()},s.prototype.prepare=function(){var o=!1;if(this.canvas.width!==this.width&&(this.width=this.canvas.width,o=!0),this.canvas.height!==this.height&&(this.height=this.canvas.height,o=!0),!this._hasInvalidDimensions()&&Object.keys(this.tiles).length!==0){var c=this.map.painter.context,_=c.gl;for(var w in this.boundsBuffer||(this.boundsBuffer=c.createVertexBuffer(this._boundsArray,We.members)),this.boundsSegments||(this.boundsSegments=a.SegmentVector.simpleSegment(0,0,4,2)),this.texture?(o||this._playing)&&this.texture.update(this.canvas,{premultiply:!0}):this.texture=new a.Texture(c,this.canvas,_.RGBA,{premultiply:!0}),this.tiles){var S=this.tiles[w];S.state!=="loaded"&&(S.state="loaded",S.texture=this.texture)}}},s.prototype.serialize=function(){return{type:"canvas",coordinates:this.coordinates}},s.prototype.hasTransition=function(){return this._playing},s.prototype._hasInvalidDimensions=function(){for(var o=0,c=[this.canvas.width,this.canvas.height];o<c.length;o+=1){var _=c[o];if(isNaN(_)||_<=0)return!0}return!1},s}(At),xr={vector:gt,raster:It,"raster-dem":jt,geojson:ei,video:mr,image:At,canvas:Tr};function Zr(n,s){var o=a.identity([]);return a.translate(o,o,[1,1,0]),a.scale(o,o,[.5*n.width,.5*n.height,1]),a.multiply(o,o,n.calculatePosMatrix(s.toUnwrapped()))}function sr(n,s,o,c,_,w){var S=function(ue,Y,le){if(ue)for(var pe=0,ve=ue;pe<ve.length;pe+=1){var Ie=Y[ve[pe]];if(Ie&&Ie.source===le&&Ie.type==="fill-extrusion")return!0}else for(var Ee in Y){var Ae=Y[Ee];if(Ae.source===le&&Ae.type==="fill-extrusion")return!0}return!1}(_&&_.layers,s,n.id),z=w.maxPitchScaleFactor(),P=n.tilesIn(c,z,S);P.sort(ti);for(var O=[],G=0,K=P;G<K.length;G+=1){var X=K[G];O.push({wrappedTileID:X.tileID.wrapped().key,queryResults:X.tile.queryRenderedFeatures(s,o,n._state,X.queryGeometry,X.cameraQueryGeometry,X.scale,_,w,z,Zr(n.transform,X.tileID))})}var re=function(ue){for(var Y={},le={},pe=0,ve=ue;pe<ve.length;pe+=1){var Ie=ve[pe],Ee=Ie.queryResults,Ae=Ie.wrappedTileID,Re=le[Ae]=le[Ae]||{};for(var Ke in Ee)for(var Ze=Ee[Ke],ot=Re[Ke]=Re[Ke]||{},wt=Y[Ke]=Y[Ke]||[],Tt=0,Et=Ze;Tt<Et.length;Tt+=1){var _r=Et[Tt];ot[_r.featureIndex]||(ot[_r.featureIndex]=!0,wt.push(_r))}}return Y}(O);for(var te in re)re[te].forEach(function(ue){var Y=ue.feature,le=n.getFeatureState(Y.layer["source-layer"],Y.id);Y.source=Y.layer.source,Y.layer["source-layer"]&&(Y.sourceLayer=Y.layer["source-layer"]),Y.state=le});return re}function ti(n,s){var o=n.tileID,c=s.tileID;return o.overscaledZ-c.overscaledZ||o.canonical.y-c.canonical.y||o.wrap-c.wrap||o.canonical.x-c.canonical.x}var Wt=function(n,s){this.max=n,this.onRemove=s,this.reset()};Wt.prototype.reset=function(){for(var n in this.data)for(var s=0,o=this.data[n];s<o.length;s+=1){var c=o[s];c.timeout&&clearTimeout(c.timeout),this.onRemove(c.value)}return this.data={},this.order=[],this},Wt.prototype.add=function(n,s,o){var c=this,_=n.wrapped().key;this.data[_]===void 0&&(this.data[_]=[]);var w={value:s,timeout:void 0};if(o!==void 0&&(w.timeout=setTimeout(function(){c.remove(n,w)},o)),this.data[_].push(w),this.order.push(_),this.order.length>this.max){var S=this._getAndRemoveByKey(this.order[0]);S&&this.onRemove(S)}return this},Wt.prototype.has=function(n){return n.wrapped().key in this.data},Wt.prototype.getAndRemove=function(n){return this.has(n)?this._getAndRemoveByKey(n.wrapped().key):null},Wt.prototype._getAndRemoveByKey=function(n){var s=this.data[n].shift();return s.timeout&&clearTimeout(s.timeout),this.data[n].length===0&&delete this.data[n],this.order.splice(this.order.indexOf(n),1),s.value},Wt.prototype.getByKey=function(n){var s=this.data[n];return s?s[0].value:null},Wt.prototype.get=function(n){return this.has(n)?this.data[n.wrapped().key][0].value:null},Wt.prototype.remove=function(n,s){if(!this.has(n))return this;var o=n.wrapped().key,c=s===void 0?0:this.data[o].indexOf(s),_=this.data[o][c];return this.data[o].splice(c,1),_.timeout&&clearTimeout(_.timeout),this.data[o].length===0&&delete this.data[o],this.onRemove(_.value),this.order.splice(this.order.indexOf(o),1),this},Wt.prototype.setMaxSize=function(n){for(this.max=n;this.order.length>this.max;){var s=this._getAndRemoveByKey(this.order[0]);s&&this.onRemove(s)}return this},Wt.prototype.filter=function(n){var s=[];for(var o in this.data)for(var c=0,_=this.data[o];c<_.length;c+=1){var w=_[c];n(w.value)||s.push(w)}for(var S=0,z=s;S<z.length;S+=1){var P=z[S];this.remove(P.value.tileID,P)}};var Gr=function(n,s,o){this.context=n;var c=n.gl;this.buffer=c.createBuffer(),this.dynamicDraw=!!o,this.context.unbindVAO(),n.bindElementBuffer.set(this.buffer),c.bufferData(c.ELEMENT_ARRAY_BUFFER,s.arrayBuffer,this.dynamicDraw?c.DYNAMIC_DRAW:c.STATIC_DRAW),this.dynamicDraw||delete s.arrayBuffer};Gr.prototype.bind=function(){this.context.bindElementBuffer.set(this.buffer)},Gr.prototype.updateData=function(n){var s=this.context.gl;this.context.unbindVAO(),this.bind(),s.bufferSubData(s.ELEMENT_ARRAY_BUFFER,0,n.arrayBuffer)},Gr.prototype.destroy=function(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)};var yr={Int8:"BYTE",Uint8:"UNSIGNED_BYTE",Int16:"SHORT",Uint16:"UNSIGNED_SHORT",Int32:"INT",Uint32:"UNSIGNED_INT",Float32:"FLOAT"},Nr=function(n,s,o,c){this.length=s.length,this.attributes=o,this.itemSize=s.bytesPerElement,this.dynamicDraw=c,this.context=n;var _=n.gl;this.buffer=_.createBuffer(),n.bindVertexBuffer.set(this.buffer),_.bufferData(_.ARRAY_BUFFER,s.arrayBuffer,this.dynamicDraw?_.DYNAMIC_DRAW:_.STATIC_DRAW),this.dynamicDraw||delete s.arrayBuffer};Nr.prototype.bind=function(){this.context.bindVertexBuffer.set(this.buffer)},Nr.prototype.updateData=function(n){var s=this.context.gl;this.bind(),s.bufferSubData(s.ARRAY_BUFFER,0,n.arrayBuffer)},Nr.prototype.enableAttributes=function(n,s){for(var o=0;o<this.attributes.length;o++){var c=s.attributes[this.attributes[o].name];c!==void 0&&n.enableVertexAttribArray(c)}},Nr.prototype.setVertexAttribPointers=function(n,s,o){for(var c=0;c<this.attributes.length;c++){var _=this.attributes[c],w=s.attributes[_.name];w!==void 0&&n.vertexAttribPointer(w,_.components,n[yr[_.type]],!1,this.itemSize,_.offset+this.itemSize*(o||0))}},Nr.prototype.destroy=function(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)};var qt=function(n){this.gl=n.gl,this.default=this.getDefault(),this.current=this.default,this.dirty=!1};qt.prototype.get=function(){return this.current},qt.prototype.set=function(n){},qt.prototype.getDefault=function(){return this.default},qt.prototype.setDefault=function(){this.set(this.default)};var Lr=function(n){function s(){n.apply(this,arguments)}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype.getDefault=function(){return a.Color.transparent},s.prototype.set=function(o){var c=this.current;(o.r!==c.r||o.g!==c.g||o.b!==c.b||o.a!==c.a||this.dirty)&&(this.gl.clearColor(o.r,o.g,o.b,o.a),this.current=o,this.dirty=!1)},s}(qt),Kr=function(n){function s(){n.apply(this,arguments)}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype.getDefault=function(){return 1},s.prototype.set=function(o){(o!==this.current||this.dirty)&&(this.gl.clearDepth(o),this.current=o,this.dirty=!1)},s}(qt),hr=function(n){function s(){n.apply(this,arguments)}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype.getDefault=function(){return 0},s.prototype.set=function(o){(o!==this.current||this.dirty)&&(this.gl.clearStencil(o),this.current=o,this.dirty=!1)},s}(qt),Fi=function(n){function s(){n.apply(this,arguments)}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype.getDefault=function(){return[!0,!0,!0,!0]},s.prototype.set=function(o){var c=this.current;(o[0]!==c[0]||o[1]!==c[1]||o[2]!==c[2]||o[3]!==c[3]||this.dirty)&&(this.gl.colorMask(o[0],o[1],o[2],o[3]),this.current=o,this.dirty=!1)},s}(qt),Cr=function(n){function s(){n.apply(this,arguments)}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype.getDefault=function(){return!0},s.prototype.set=function(o){(o!==this.current||this.dirty)&&(this.gl.depthMask(o),this.current=o,this.dirty=!1)},s}(qt),bi=function(n){function s(){n.apply(this,arguments)}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype.getDefault=function(){return 255},s.prototype.set=function(o){(o!==this.current||this.dirty)&&(this.gl.stencilMask(o),this.current=o,this.dirty=!1)},s}(qt),pi=function(n){function s(){n.apply(this,arguments)}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype.getDefault=function(){return{func:this.gl.ALWAYS,ref:0,mask:255}},s.prototype.set=function(o){var c=this.current;(o.func!==c.func||o.ref!==c.ref||o.mask!==c.mask||this.dirty)&&(this.gl.stencilFunc(o.func,o.ref,o.mask),this.current=o,this.dirty=!1)},s}(qt),Qi=function(n){function s(){n.apply(this,arguments)}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype.getDefault=function(){var o=this.gl;return[o.KEEP,o.KEEP,o.KEEP]},s.prototype.set=function(o){var c=this.current;(o[0]!==c[0]||o[1]!==c[1]||o[2]!==c[2]||this.dirty)&&(this.gl.stencilOp(o[0],o[1],o[2]),this.current=o,this.dirty=!1)},s}(qt),Mi=function(n){function s(){n.apply(this,arguments)}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype.getDefault=function(){return!1},s.prototype.set=function(o){if(o!==this.current||this.dirty){var c=this.gl;o?c.enable(c.STENCIL_TEST):c.disable(c.STENCIL_TEST),this.current=o,this.dirty=!1}},s}(qt),fi=function(n){function s(){n.apply(this,arguments)}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype.getDefault=function(){return[0,1]},s.prototype.set=function(o){var c=this.current;(o[0]!==c[0]||o[1]!==c[1]||this.dirty)&&(this.gl.depthRange(o[0],o[1]),this.current=o,this.dirty=!1)},s}(qt),ri=function(n){function s(){n.apply(this,arguments)}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype.getDefault=function(){return!1},s.prototype.set=function(o){if(o!==this.current||this.dirty){var c=this.gl;o?c.enable(c.DEPTH_TEST):c.disable(c.DEPTH_TEST),this.current=o,this.dirty=!1}},s}(qt),sn=function(n){function s(){n.apply(this,arguments)}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype.getDefault=function(){return this.gl.LESS},s.prototype.set=function(o){(o!==this.current||this.dirty)&&(this.gl.depthFunc(o),this.current=o,this.dirty=!1)},s}(qt),di=function(n){function s(){n.apply(this,arguments)}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype.getDefault=function(){return!1},s.prototype.set=function(o){if(o!==this.current||this.dirty){var c=this.gl;o?c.enable(c.BLEND):c.disable(c.BLEND),this.current=o,this.dirty=!1}},s}(qt),Ur=function(n){function s(){n.apply(this,arguments)}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype.getDefault=function(){var o=this.gl;return[o.ONE,o.ZERO]},s.prototype.set=function(o){var c=this.current;(o[0]!==c[0]||o[1]!==c[1]||this.dirty)&&(this.gl.blendFunc(o[0],o[1]),this.current=o,this.dirty=!1)},s}(qt),$i=function(n){function s(){n.apply(this,arguments)}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype.getDefault=function(){return a.Color.transparent},s.prototype.set=function(o){var c=this.current;(o.r!==c.r||o.g!==c.g||o.b!==c.b||o.a!==c.a||this.dirty)&&(this.gl.blendColor(o.r,o.g,o.b,o.a),this.current=o,this.dirty=!1)},s}(qt),On=function(n){function s(){n.apply(this,arguments)}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype.getDefault=function(){return this.gl.FUNC_ADD},s.prototype.set=function(o){(o!==this.current||this.dirty)&&(this.gl.blendEquation(o),this.current=o,this.dirty=!1)},s}(qt),Ni=function(n){function s(){n.apply(this,arguments)}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype.getDefault=function(){return!1},s.prototype.set=function(o){if(o!==this.current||this.dirty){var c=this.gl;o?c.enable(c.CULL_FACE):c.disable(c.CULL_FACE),this.current=o,this.dirty=!1}},s}(qt),Cn=function(n){function s(){n.apply(this,arguments)}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype.getDefault=function(){return this.gl.BACK},s.prototype.set=function(o){(o!==this.current||this.dirty)&&(this.gl.cullFace(o),this.current=o,this.dirty=!1)},s}(qt),en=function(n){function s(){n.apply(this,arguments)}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype.getDefault=function(){return this.gl.CCW},s.prototype.set=function(o){(o!==this.current||this.dirty)&&(this.gl.frontFace(o),this.current=o,this.dirty=!1)},s}(qt),Mn=function(n){function s(){n.apply(this,arguments)}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype.getDefault=function(){return null},s.prototype.set=function(o){(o!==this.current||this.dirty)&&(this.gl.useProgram(o),this.current=o,this.dirty=!1)},s}(qt),Ui=function(n){function s(){n.apply(this,arguments)}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype.getDefault=function(){return this.gl.TEXTURE0},s.prototype.set=function(o){(o!==this.current||this.dirty)&&(this.gl.activeTexture(o),this.current=o,this.dirty=!1)},s}(qt),_n=function(n){function s(){n.apply(this,arguments)}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype.getDefault=function(){var o=this.gl;return[0,0,o.drawingBufferWidth,o.drawingBufferHeight]},s.prototype.set=function(o){var c=this.current;(o[0]!==c[0]||o[1]!==c[1]||o[2]!==c[2]||o[3]!==c[3]||this.dirty)&&(this.gl.viewport(o[0],o[1],o[2],o[3]),this.current=o,this.dirty=!1)},s}(qt),Vi=function(n){function s(){n.apply(this,arguments)}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype.getDefault=function(){return null},s.prototype.set=function(o){if(o!==this.current||this.dirty){var c=this.gl;c.bindFramebuffer(c.FRAMEBUFFER,o),this.current=o,this.dirty=!1}},s}(qt),Fn=function(n){function s(){n.apply(this,arguments)}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype.getDefault=function(){return null},s.prototype.set=function(o){if(o!==this.current||this.dirty){var c=this.gl;c.bindRenderbuffer(c.RENDERBUFFER,o),this.current=o,this.dirty=!1}},s}(qt),tn=function(n){function s(){n.apply(this,arguments)}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype.getDefault=function(){return null},s.prototype.set=function(o){if(o!==this.current||this.dirty){var c=this.gl;c.bindTexture(c.TEXTURE_2D,o),this.current=o,this.dirty=!1}},s}(qt),ji=function(n){function s(){n.apply(this,arguments)}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype.getDefault=function(){return null},s.prototype.set=function(o){if(o!==this.current||this.dirty){var c=this.gl;c.bindBuffer(c.ARRAY_BUFFER,o),this.current=o,this.dirty=!1}},s}(qt),vn=function(n){function s(){n.apply(this,arguments)}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype.getDefault=function(){return null},s.prototype.set=function(o){var c=this.gl;c.bindBuffer(c.ELEMENT_ARRAY_BUFFER,o),this.current=o,this.dirty=!1},s}(qt),ln=function(n){function s(o){n.call(this,o),this.vao=o.extVertexArrayObject}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype.getDefault=function(){return null},s.prototype.set=function(o){this.vao&&(o!==this.current||this.dirty)&&(this.vao.bindVertexArrayOES(o),this.current=o,this.dirty=!1)},s}(qt),un=function(n){function s(){n.apply(this,arguments)}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype.getDefault=function(){return 4},s.prototype.set=function(o){if(o!==this.current||this.dirty){var c=this.gl;c.pixelStorei(c.UNPACK_ALIGNMENT,o),this.current=o,this.dirty=!1}},s}(qt),bn=function(n){function s(){n.apply(this,arguments)}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype.getDefault=function(){return!1},s.prototype.set=function(o){if(o!==this.current||this.dirty){var c=this.gl;c.pixelStorei(c.UNPACK_PREMULTIPLY_ALPHA_WEBGL,o),this.current=o,this.dirty=!1}},s}(qt),oi=function(n){function s(){n.apply(this,arguments)}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype.getDefault=function(){return!1},s.prototype.set=function(o){if(o!==this.current||this.dirty){var c=this.gl;c.pixelStorei(c.UNPACK_FLIP_Y_WEBGL,o),this.current=o,this.dirty=!1}},s}(qt),Mr=function(n){function s(o,c){n.call(this,o),this.context=o,this.parent=c}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype.getDefault=function(){return null},s}(qt),L=function(n){function s(){n.apply(this,arguments)}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype.setDirty=function(){this.dirty=!0},s.prototype.set=function(o){if(o!==this.current||this.dirty){this.context.bindFramebuffer.set(this.parent);var c=this.gl;c.framebufferTexture2D(c.FRAMEBUFFER,c.COLOR_ATTACHMENT0,c.TEXTURE_2D,o,0),this.current=o,this.dirty=!1}},s}(Mr),N=function(n){function s(){n.apply(this,arguments)}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype.set=function(o){if(o!==this.current||this.dirty){this.context.bindFramebuffer.set(this.parent);var c=this.gl;c.framebufferRenderbuffer(c.FRAMEBUFFER,c.DEPTH_ATTACHMENT,c.RENDERBUFFER,o),this.current=o,this.dirty=!1}},s}(Mr),V=function(n,s,o,c){this.context=n,this.width=s,this.height=o;var _=this.framebuffer=n.gl.createFramebuffer();this.colorAttachment=new L(n,_),c&&(this.depthAttachment=new N(n,_))};V.prototype.destroy=function(){var n=this.context.gl,s=this.colorAttachment.get();if(s&&n.deleteTexture(s),this.depthAttachment){var o=this.depthAttachment.get();o&&n.deleteRenderbuffer(o)}n.deleteFramebuffer(this.framebuffer)};var W=function(n,s,o){this.func=n,this.mask=s,this.range=o};W.ReadOnly=!1,W.ReadWrite=!0,W.disabled=new W(519,W.ReadOnly,[0,1]);var $=function(n,s,o,c,_,w){this.test=n,this.ref=s,this.mask=o,this.fail=c,this.depthFail=_,this.pass=w};$.disabled=new $({func:519,mask:0},0,0,7680,7680,7680);var se=function(n,s,o){this.blendFunction=n,this.blendColor=s,this.mask=o};se.disabled=new se(se.Replace=[1,0],a.Color.transparent,[!1,!1,!1,!1]),se.unblended=new se(se.Replace,a.Color.transparent,[!0,!0,!0,!0]),se.alphaBlended=new se([1,771],a.Color.transparent,[!0,!0,!0,!0]);var he=function(n,s,o){this.enable=n,this.mode=s,this.frontFace=o};he.disabled=new he(!1,1029,2305),he.backCCW=new he(!0,1029,2305);var j=function(n){this.gl=n,this.extVertexArrayObject=this.gl.getExtension("OES_vertex_array_object"),this.clearColor=new Lr(this),this.clearDepth=new Kr(this),this.clearStencil=new hr(this),this.colorMask=new Fi(this),this.depthMask=new Cr(this),this.stencilMask=new bi(this),this.stencilFunc=new pi(this),this.stencilOp=new Qi(this),this.stencilTest=new Mi(this),this.depthRange=new fi(this),this.depthTest=new ri(this),this.depthFunc=new sn(this),this.blend=new di(this),this.blendFunc=new Ur(this),this.blendColor=new $i(this),this.blendEquation=new On(this),this.cullFace=new Ni(this),this.cullFaceSide=new Cn(this),this.frontFace=new en(this),this.program=new Mn(this),this.activeTexture=new Ui(this),this.viewport=new _n(this),this.bindFramebuffer=new Vi(this),this.bindRenderbuffer=new Fn(this),this.bindTexture=new tn(this),this.bindVertexBuffer=new ji(this),this.bindElementBuffer=new vn(this),this.bindVertexArrayOES=this.extVertexArrayObject&&new ln(this),this.pixelStoreUnpack=new un(this),this.pixelStoreUnpackPremultiplyAlpha=new bn(this),this.pixelStoreUnpackFlipY=new oi(this),this.extTextureFilterAnisotropic=n.getExtension("EXT_texture_filter_anisotropic")||n.getExtension("MOZ_EXT_texture_filter_anisotropic")||n.getExtension("WEBKIT_EXT_texture_filter_anisotropic"),this.extTextureFilterAnisotropic&&(this.extTextureFilterAnisotropicMax=n.getParameter(this.extTextureFilterAnisotropic.MAX_TEXTURE_MAX_ANISOTROPY_EXT)),this.extTextureHalfFloat=n.getExtension("OES_texture_half_float"),this.extTextureHalfFloat&&(n.getExtension("OES_texture_half_float_linear"),this.extRenderToTextureHalfFloat=n.getExtension("EXT_color_buffer_half_float")),this.extTimerQuery=n.getExtension("EXT_disjoint_timer_query"),this.maxTextureSize=n.getParameter(n.MAX_TEXTURE_SIZE)};j.prototype.setDefault=function(){this.unbindVAO(),this.clearColor.setDefault(),this.clearDepth.setDefault(),this.clearStencil.setDefault(),this.colorMask.setDefault(),this.depthMask.setDefault(),this.stencilMask.setDefault(),this.stencilFunc.setDefault(),this.stencilOp.setDefault(),this.stencilTest.setDefault(),this.depthRange.setDefault(),this.depthTest.setDefault(),this.depthFunc.setDefault(),this.blend.setDefault(),this.blendFunc.setDefault(),this.blendColor.setDefault(),this.blendEquation.setDefault(),this.cullFace.setDefault(),this.cullFaceSide.setDefault(),this.frontFace.setDefault(),this.program.setDefault(),this.activeTexture.setDefault(),this.bindFramebuffer.setDefault(),this.pixelStoreUnpack.setDefault(),this.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.pixelStoreUnpackFlipY.setDefault()},j.prototype.setDirty=function(){this.clearColor.dirty=!0,this.clearDepth.dirty=!0,this.clearStencil.dirty=!0,this.colorMask.dirty=!0,this.depthMask.dirty=!0,this.stencilMask.dirty=!0,this.stencilFunc.dirty=!0,this.stencilOp.dirty=!0,this.stencilTest.dirty=!0,this.depthRange.dirty=!0,this.depthTest.dirty=!0,this.depthFunc.dirty=!0,this.blend.dirty=!0,this.blendFunc.dirty=!0,this.blendColor.dirty=!0,this.blendEquation.dirty=!0,this.cullFace.dirty=!0,this.cullFaceSide.dirty=!0,this.frontFace.dirty=!0,this.program.dirty=!0,this.activeTexture.dirty=!0,this.viewport.dirty=!0,this.bindFramebuffer.dirty=!0,this.bindRenderbuffer.dirty=!0,this.bindTexture.dirty=!0,this.bindVertexBuffer.dirty=!0,this.bindElementBuffer.dirty=!0,this.extVertexArrayObject&&(this.bindVertexArrayOES.dirty=!0),this.pixelStoreUnpack.dirty=!0,this.pixelStoreUnpackPremultiplyAlpha.dirty=!0,this.pixelStoreUnpackFlipY.dirty=!0},j.prototype.createIndexBuffer=function(n,s){return new Gr(this,n,s)},j.prototype.createVertexBuffer=function(n,s,o){return new Nr(this,n,s,o)},j.prototype.createRenderbuffer=function(n,s,o){var c=this.gl,_=c.createRenderbuffer();return this.bindRenderbuffer.set(_),c.renderbufferStorage(c.RENDERBUFFER,n,s,o),this.bindRenderbuffer.set(null),_},j.prototype.createFramebuffer=function(n,s,o){return new V(this,n,s,o)},j.prototype.clear=function(n){var s=n.color,o=n.depth,c=this.gl,_=0;s&&(_|=c.COLOR_BUFFER_BIT,this.clearColor.set(s),this.colorMask.set([!0,!0,!0,!0])),o!==void 0&&(_|=c.DEPTH_BUFFER_BIT,this.depthRange.set([0,1]),this.clearDepth.set(o),this.depthMask.set(!0)),c.clear(_)},j.prototype.setCullFace=function(n){n.enable===!1?this.cullFace.set(!1):(this.cullFace.set(!0),this.cullFaceSide.set(n.mode),this.frontFace.set(n.frontFace))},j.prototype.setDepthMode=function(n){n.func!==this.gl.ALWAYS||n.mask?(this.depthTest.set(!0),this.depthFunc.set(n.func),this.depthMask.set(n.mask),this.depthRange.set(n.range)):this.depthTest.set(!1)},j.prototype.setStencilMode=function(n){n.test.func!==this.gl.ALWAYS||n.mask?(this.stencilTest.set(!0),this.stencilMask.set(n.mask),this.stencilOp.set([n.fail,n.depthFail,n.pass]),this.stencilFunc.set({func:n.test.func,ref:n.ref,mask:n.test.mask})):this.stencilTest.set(!1)},j.prototype.setColorMode=function(n){a.deepEqual(n.blendFunction,se.Replace)?this.blend.set(!1):(this.blend.set(!0),this.blendFunc.set(n.blendFunction),this.blendColor.set(n.blendColor)),this.colorMask.set(n.mask)},j.prototype.unbindVAO=function(){this.extVertexArrayObject&&this.bindVertexArrayOES.set(null)};var J=function(n){function s(o,c,_){var w=this;n.call(this),this.id=o,this.dispatcher=_,this.on("data",function(S){S.dataType==="source"&&S.sourceDataType==="metadata"&&(w._sourceLoaded=!0),w._sourceLoaded&&!w._paused&&S.dataType==="source"&&S.sourceDataType==="content"&&(w.reload(),w.transform&&w.update(w.transform))}),this.on("error",function(){w._sourceErrored=!0}),this._source=function(S,z,P,O){var G=new xr[z.type](S,z,P,O);if(G.id!==S)throw new Error("Expected Source id to be "+S+" instead of "+G.id);return a.bindAll(["load","abort","unload","serialize","prepare"],G),G}(o,c,_,this),this._tiles={},this._cache=new Wt(0,this._unloadTile.bind(this)),this._timers={},this._cacheTimers={},this._maxTileCacheSize=null,this._loadedParentTiles={},this._coveredTiles={},this._state=new a.SourceFeatureState}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype.onAdd=function(o){this.map=o,this._maxTileCacheSize=o?o._maxTileCacheSize:null,this._source&&this._source.onAdd&&this._source.onAdd(o)},s.prototype.onRemove=function(o){this._source&&this._source.onRemove&&this._source.onRemove(o)},s.prototype.loaded=function(){if(this._sourceErrored)return!0;if(!this._sourceLoaded||!this._source.loaded())return!1;for(var o in this._tiles){var c=this._tiles[o];if(c.state!=="loaded"&&c.state!=="errored")return!1}return!0},s.prototype.getSource=function(){return this._source},s.prototype.pause=function(){this._paused=!0},s.prototype.resume=function(){if(this._paused){var o=this._shouldReloadOnResume;this._paused=!1,this._shouldReloadOnResume=!1,o&&this.reload(),this.transform&&this.update(this.transform)}},s.prototype._loadTile=function(o,c){return this._source.loadTile(o,c)},s.prototype._unloadTile=function(o){if(this._source.unloadTile)return this._source.unloadTile(o,function(){})},s.prototype._abortTile=function(o){if(this._source.abortTile)return this._source.abortTile(o,function(){})},s.prototype.serialize=function(){return this._source.serialize()},s.prototype.prepare=function(o){for(var c in this._source.prepare&&this._source.prepare(),this._state.coalesceChanges(this._tiles,this.map?this.map.painter:null),this._tiles){var _=this._tiles[c];_.upload(o),_.prepare(this.map.style.imageManager)}},s.prototype.getIds=function(){return a.values(this._tiles).map(function(o){return o.tileID}).sort(ge).map(function(o){return o.key})},s.prototype.getRenderableIds=function(o){var c=this,_=[];for(var w in this._tiles)this._isIdRenderable(w,o)&&_.push(this._tiles[w]);return o?_.sort(function(S,z){var P=S.tileID,O=z.tileID,G=new a.Point(P.canonical.x,P.canonical.y)._rotate(c.transform.angle),K=new a.Point(O.canonical.x,O.canonical.y)._rotate(c.transform.angle);return P.overscaledZ-O.overscaledZ||K.y-G.y||K.x-G.x}).map(function(S){return S.tileID.key}):_.map(function(S){return S.tileID}).sort(ge).map(function(S){return S.key})},s.prototype.hasRenderableParent=function(o){var c=this.findLoadedParent(o,0);return!!c&&this._isIdRenderable(c.tileID.key)},s.prototype._isIdRenderable=function(o,c){return this._tiles[o]&&this._tiles[o].hasData()&&!this._coveredTiles[o]&&(c||!this._tiles[o].holdingForFade())},s.prototype.reload=function(){if(this._paused)this._shouldReloadOnResume=!0;else for(var o in this._cache.reset(),this._tiles)this._tiles[o].state!=="errored"&&this._reloadTile(o,"reloading")},s.prototype._reloadTile=function(o,c){var _=this._tiles[o];_&&(_.state!=="loading"&&(_.state=c),this._loadTile(_,this._tileLoaded.bind(this,_,o,c)))},s.prototype._tileLoaded=function(o,c,_,w){if(w)return o.state="errored",void(w.status!==404?this._source.fire(new a.ErrorEvent(w,{tile:o})):this.update(this.transform));o.timeAdded=a.browser.now(),_==="expired"&&(o.refreshedUponExpiration=!0),this._setTileReloadTimer(c,o),this.getSource().type==="raster-dem"&&o.dem&&this._backfillDEM(o),this._state.initializeTileState(o,this.map?this.map.painter:null),this._source.fire(new a.Event("data",{dataType:"source",tile:o,coord:o.tileID}))},s.prototype._backfillDEM=function(o){for(var c=this.getRenderableIds(),_=0;_<c.length;_++){var w=c[_];if(o.neighboringTiles&&o.neighboringTiles[w]){var S=this.getTileByID(w);z(o,S),z(S,o)}}function z(P,O){P.needsHillshadePrepare=!0;var G=O.tileID.canonical.x-P.tileID.canonical.x,K=O.tileID.canonical.y-P.tileID.canonical.y,X=Math.pow(2,P.tileID.canonical.z),re=O.tileID.key;G===0&&K===0||Math.abs(K)>1||(Math.abs(G)>1&&(Math.abs(G+X)===1?G+=X:Math.abs(G-X)===1&&(G-=X)),O.dem&&P.dem&&(P.dem.backfillBorder(O.dem,G,K),P.neighboringTiles&&P.neighboringTiles[re]&&(P.neighboringTiles[re].backfilled=!0)))}},s.prototype.getTile=function(o){return this.getTileByID(o.key)},s.prototype.getTileByID=function(o){return this._tiles[o]},s.prototype._retainLoadedChildren=function(o,c,_,w){for(var S in this._tiles){var z=this._tiles[S];if(!(w[S]||!z.hasData()||z.tileID.overscaledZ<=c||z.tileID.overscaledZ>_)){for(var P=z.tileID;z&&z.tileID.overscaledZ>c+1;){var O=z.tileID.scaledTo(z.tileID.overscaledZ-1);(z=this._tiles[O.key])&&z.hasData()&&(P=O)}for(var G=P;G.overscaledZ>c;)if(o[(G=G.scaledTo(G.overscaledZ-1)).key]){w[P.key]=P;break}}}},s.prototype.findLoadedParent=function(o,c){if(o.key in this._loadedParentTiles){var _=this._loadedParentTiles[o.key];return _&&_.tileID.overscaledZ>=c?_:null}for(var w=o.overscaledZ-1;w>=c;w--){var S=o.scaledTo(w),z=this._getLoadedTile(S);if(z)return z}},s.prototype._getLoadedTile=function(o){var c=this._tiles[o.key];return c&&c.hasData()?c:this._cache.getByKey(o.wrapped().key)},s.prototype.updateCacheSize=function(o){var c=Math.ceil(o.width/this._source.tileSize)+1,_=Math.ceil(o.height/this._source.tileSize)+1,w=Math.floor(c*_*5),S=typeof this._maxTileCacheSize=="number"?Math.min(this._maxTileCacheSize,w):w;this._cache.setMaxSize(S)},s.prototype.handleWrapJump=function(o){var c=Math.round((o-(this._prevLng===void 0?o:this._prevLng))/360);if(this._prevLng=o,c){var _={};for(var w in this._tiles){var S=this._tiles[w];S.tileID=S.tileID.unwrapTo(S.tileID.wrap+c),_[S.tileID.key]=S}for(var z in this._tiles=_,this._timers)clearTimeout(this._timers[z]),delete this._timers[z];for(var P in this._tiles)this._setTileReloadTimer(P,this._tiles[P])}},s.prototype.update=function(o){var c=this;if(this.transform=o,this._sourceLoaded&&!this._paused){var _;this.updateCacheSize(o),this.handleWrapJump(this.transform.center.lng),this._coveredTiles={},this.used?this._source.tileID?_=o.getVisibleUnwrappedCoordinates(this._source.tileID).map(function(Re){return new a.OverscaledTileID(Re.canonical.z,Re.wrap,Re.canonical.z,Re.canonical.x,Re.canonical.y)}):(_=o.coveringTiles({tileSize:this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this._source.roundZoom,reparseOverscaled:this._source.reparseOverscaled}),this._source.hasTile&&(_=_.filter(function(Re){return c._source.hasTile(Re)}))):_=[];var w=o.coveringZoomLevel(this._source),S=Math.max(w-s.maxOverzooming,this._source.minzoom),z=Math.max(w+s.maxUnderzooming,this._source.minzoom),P=this._updateRetainedTiles(_,w);if(Ce(this._source.type)){for(var O={},G={},K=0,X=Object.keys(P);K<X.length;K+=1){var re=X[K],te=P[re],ue=this._tiles[re];if(ue&&!(ue.fadeEndTime&&ue.fadeEndTime<=a.browser.now())){var Y=this.findLoadedParent(te,S);Y&&(this._addTile(Y.tileID),O[Y.tileID.key]=Y.tileID),G[re]=te}}for(var le in this._retainLoadedChildren(G,w,z,P),O)P[le]||(this._coveredTiles[le]=!0,P[le]=O[le])}for(var pe in P)this._tiles[pe].clearFadeHold();for(var ve=0,Ie=a.keysDifference(this._tiles,P);ve<Ie.length;ve+=1){var Ee=Ie[ve],Ae=this._tiles[Ee];Ae.hasSymbolBuckets&&!Ae.holdingForFade()?Ae.setHoldDuration(this.map._fadeDuration):Ae.hasSymbolBuckets&&!Ae.symbolFadeFinished()||this._removeTile(Ee)}this._updateLoadedParentTileCache()}},s.prototype.releaseSymbolFadeTiles=function(){for(var o in this._tiles)this._tiles[o].holdingForFade()&&this._removeTile(o)},s.prototype._updateRetainedTiles=function(o,c){for(var _={},w={},S=Math.max(c-s.maxOverzooming,this._source.minzoom),z=Math.max(c+s.maxUnderzooming,this._source.minzoom),P={},O=0,G=o;O<G.length;O+=1){var K=G[O],X=this._addTile(K);_[K.key]=K,X.hasData()||c<this._source.maxzoom&&(P[K.key]=K)}this._retainLoadedChildren(P,c,z,_);for(var re=0,te=o;re<te.length;re+=1){var ue=te[re],Y=this._tiles[ue.key];if(!Y.hasData()){if(c+1>this._source.maxzoom){var le=ue.children(this._source.maxzoom)[0],pe=this.getTile(le);if(pe&&pe.hasData()){_[le.key]=le;continue}}else{var ve=ue.children(this._source.maxzoom);if(_[ve[0].key]&&_[ve[1].key]&&_[ve[2].key]&&_[ve[3].key])continue}for(var Ie=Y.wasRequested(),Ee=ue.overscaledZ-1;Ee>=S;--Ee){var Ae=ue.scaledTo(Ee);if(w[Ae.key]||(w[Ae.key]=!0,!(Y=this.getTile(Ae))&&Ie&&(Y=this._addTile(Ae)),Y&&(_[Ae.key]=Ae,Ie=Y.wasRequested(),Y.hasData())))break}}}return _},s.prototype._updateLoadedParentTileCache=function(){for(var o in this._loadedParentTiles={},this._tiles){for(var c=[],_=void 0,w=this._tiles[o].tileID;w.overscaledZ>0;){if(w.key in this._loadedParentTiles){_=this._loadedParentTiles[w.key];break}c.push(w.key);var S=w.scaledTo(w.overscaledZ-1);if(_=this._getLoadedTile(S))break;w=S}for(var z=0,P=c;z<P.length;z+=1)this._loadedParentTiles[P[z]]=_}},s.prototype._addTile=function(o){var c=this._tiles[o.key];if(c)return c;(c=this._cache.getAndRemove(o))&&(this._setTileReloadTimer(o.key,c),c.tileID=o,this._state.initializeTileState(c,this.map?this.map.painter:null),this._cacheTimers[o.key]&&(clearTimeout(this._cacheTimers[o.key]),delete this._cacheTimers[o.key],this._setTileReloadTimer(o.key,c)));var _=!!c;return _||(c=new a.Tile(o,this._source.tileSize*o.overscaleFactor()),this._loadTile(c,this._tileLoaded.bind(this,c,o.key,c.state))),c?(c.uses++,this._tiles[o.key]=c,_||this._source.fire(new a.Event("dataloading",{tile:c,coord:c.tileID,dataType:"source"})),c):null},s.prototype._setTileReloadTimer=function(o,c){var _=this;o in this._timers&&(clearTimeout(this._timers[o]),delete this._timers[o]);var w=c.getExpiryTimeout();w&&(this._timers[o]=setTimeout(function(){_._reloadTile(o,"expired"),delete _._timers[o]},w))},s.prototype._removeTile=function(o){var c=this._tiles[o];c&&(c.uses--,delete this._tiles[o],this._timers[o]&&(clearTimeout(this._timers[o]),delete this._timers[o]),c.uses>0||(c.hasData()&&c.state!=="reloading"?this._cache.add(c.tileID,c,c.getExpiryTimeout()):(c.aborted=!0,this._abortTile(c),this._unloadTile(c))))},s.prototype.clearTiles=function(){for(var o in this._shouldReloadOnResume=!1,this._paused=!1,this._tiles)this._removeTile(o);this._cache.reset()},s.prototype.tilesIn=function(o,c,_){var w=this,S=[],z=this.transform;if(!z)return S;for(var P=_?z.getCameraQueryGeometry(o):o,O=o.map(function(Ee){return z.pointCoordinate(Ee)}),G=P.map(function(Ee){return z.pointCoordinate(Ee)}),K=this.getIds(),X=1/0,re=1/0,te=-1/0,ue=-1/0,Y=0,le=G;Y<le.length;Y+=1){var pe=le[Y];X=Math.min(X,pe.x),re=Math.min(re,pe.y),te=Math.max(te,pe.x),ue=Math.max(ue,pe.y)}for(var ve=function(Ee){var Ae=w._tiles[K[Ee]];if(!Ae.holdingForFade()){var Re=Ae.tileID,Ke=Math.pow(2,z.zoom-Ae.tileID.overscaledZ),Ze=c*Ae.queryPadding*a.EXTENT/Ae.tileSize/Ke,ot=[Re.getTilePoint(new a.MercatorCoordinate(X,re)),Re.getTilePoint(new a.MercatorCoordinate(te,ue))];if(ot[0].x-Ze<a.EXTENT&&ot[0].y-Ze<a.EXTENT&&ot[1].x+Ze>=0&&ot[1].y+Ze>=0){var wt=O.map(function(Et){return Re.getTilePoint(Et)}),Tt=G.map(function(Et){return Re.getTilePoint(Et)});S.push({tile:Ae,tileID:Re,queryGeometry:wt,cameraQueryGeometry:Tt,scale:Ke})}}},Ie=0;Ie<K.length;Ie++)ve(Ie);return S},s.prototype.getVisibleCoordinates=function(o){for(var c=this,_=this.getRenderableIds(o).map(function(P){return c._tiles[P].tileID}),w=0,S=_;w<S.length;w+=1){var z=S[w];z.posMatrix=this.transform.calculatePosMatrix(z.toUnwrapped())}return _},s.prototype.hasTransition=function(){if(this._source.hasTransition())return!0;if(Ce(this._source.type))for(var o in this._tiles){var c=this._tiles[o];if(c.fadeEndTime!==void 0&&c.fadeEndTime>=a.browser.now())return!0}return!1},s.prototype.setFeatureState=function(o,c,_){this._state.updateState(o=o||"_geojsonTileLayer",c,_)},s.prototype.removeFeatureState=function(o,c,_){this._state.removeFeatureState(o=o||"_geojsonTileLayer",c,_)},s.prototype.getFeatureState=function(o,c){return this._state.getState(o=o||"_geojsonTileLayer",c)},s.prototype.setDependencies=function(o,c,_){var w=this._tiles[o];w&&w.setDependencies(c,_)},s.prototype.reloadTilesForDependencies=function(o,c){for(var _ in this._tiles)this._tiles[_].hasDependency(o,c)&&this._reloadTile(_,"reloading");this._cache.filter(function(w){return!w.hasDependency(o,c)})},s}(a.Evented);function ge(n,s){var o=Math.abs(2*n.wrap)-+(n.wrap<0),c=Math.abs(2*s.wrap)-+(s.wrap<0);return n.overscaledZ-s.overscaledZ||c-o||s.canonical.y-n.canonical.y||s.canonical.x-n.canonical.x}function Ce(n){return n==="raster"||n==="image"||n==="video"}function De(){return new a.window.Worker(nl.workerUrl)}J.maxOverzooming=10,J.maxUnderzooming=3;var q="mapboxgl_preloaded_worker_pool",_e=function(){this.active={}};_e.prototype.acquire=function(n){if(!this.workers)for(this.workers=[];this.workers.length<_e.workerCount;)this.workers.push(new De);return this.active[n]=!0,this.workers.slice()},_e.prototype.release=function(n){delete this.active[n],this.numActive()===0&&(this.workers.forEach(function(s){s.terminate()}),this.workers=null)},_e.prototype.isPreloaded=function(){return!!this.active[q]},_e.prototype.numActive=function(){return Object.keys(this.active).length};var tt,He=Math.floor(a.browser.hardwareConcurrency/2);function ke(){return tt||(tt=new _e),tt}function Xe(n,s){var o={};for(var c in n)c!=="ref"&&(o[c]=n[c]);return a.refProperties.forEach(function(_){_ in s&&(o[_]=s[_])}),o}function Oe(n){n=n.slice();for(var s=Object.create(null),o=0;o<n.length;o++)s[n[o].id]=n[o];for(var c=0;c<n.length;c++)"ref"in n[c]&&(n[c]=Xe(n[c],s[n[c].ref]));return n}_e.workerCount=Math.max(Math.min(He,6),1);var qe={setStyle:"setStyle",addLayer:"addLayer",removeLayer:"removeLayer",setPaintProperty:"setPaintProperty",setLayoutProperty:"setLayoutProperty",setFilter:"setFilter",addSource:"addSource",removeSource:"removeSource",setGeoJSONSourceData:"setGeoJSONSourceData",setLayerZoomRange:"setLayerZoomRange",setLayerProperty:"setLayerProperty",setCenter:"setCenter",setZoom:"setZoom",setBearing:"setBearing",setPitch:"setPitch",setSprite:"setSprite",setGlyphs:"setGlyphs",setTransition:"setTransition",setLight:"setLight"};function Mt(n,s,o){o.push({command:qe.addSource,args:[n,s[n]]})}function je(n,s,o){s.push({command:qe.removeSource,args:[n]}),o[n]=!0}function Vt(n,s,o,c){je(n,o,c),Mt(n,s,o)}function lr(n,s,o){var c;for(c in n[o])if(n[o].hasOwnProperty(c)&&c!=="data"&&!a.deepEqual(n[o][c],s[o][c]))return!1;for(c in s[o])if(s[o].hasOwnProperty(c)&&c!=="data"&&!a.deepEqual(n[o][c],s[o][c]))return!1;return!0}function Dt(n,s,o,c,_,w){var S;for(S in s=s||{},n=n||{})n.hasOwnProperty(S)&&(a.deepEqual(n[S],s[S])||o.push({command:w,args:[c,S,s[S],_]}));for(S in s)s.hasOwnProperty(S)&&!n.hasOwnProperty(S)&&(a.deepEqual(n[S],s[S])||o.push({command:w,args:[c,S,s[S],_]}))}function nr(n){return n.id}function Jt(n,s){return n[s.id]=s,n}var ii=function(n,s){this.reset(n,s)};ii.prototype.reset=function(n,s){this.points=n||[],this._distances=[0];for(var o=1;o<this.points.length;o++)this._distances[o]=this._distances[o-1]+this.points[o].dist(this.points[o-1]);this.length=this._distances[this._distances.length-1],this.padding=Math.min(s||0,.5*this.length),this.paddedLength=this.length-2*this.padding},ii.prototype.lerp=function(n){if(this.points.length===1)return this.points[0];n=a.clamp(n,0,1);for(var s=1,o=this._distances[s],c=n*this.paddedLength+this.padding;o<c&&s<this._distances.length;)o=this._distances[++s];var _=s-1,w=this._distances[_],S=o-w,z=S>0?(c-w)/S:0;return this.points[_].mult(1-z).add(this.points[s].mult(z))};var $t=function(n,s,o){var c=this.boxCells=[],_=this.circleCells=[];this.xCellCount=Math.ceil(n/o),this.yCellCount=Math.ceil(s/o);for(var w=0;w<this.xCellCount*this.yCellCount;w++)c.push([]),_.push([]);this.circleKeys=[],this.boxKeys=[],this.bboxes=[],this.circles=[],this.width=n,this.height=s,this.xScale=this.xCellCount/n,this.yScale=this.yCellCount/s,this.boxUid=0,this.circleUid=0};function br(n,s,o,c,_){var w=a.create();return s?(a.scale(w,w,[1/_,1/_,1]),o||a.rotateZ(w,w,c.angle)):a.multiply(w,c.labelPlaneMatrix,n),w}function fr(n,s,o,c,_){if(s){var w=a.clone(n);return a.scale(w,w,[_,_,1]),o||a.rotateZ(w,w,-c.angle),w}return c.glCoordMatrix}function Gt(n,s){var o=[n.x,n.y,0,1];li(o,o,s);var c=o[3];return{point:new a.Point(o[0]/c,o[1]/c),signedDistanceFromCamera:c}}function ar(n,s){return .5+n/s*.5}function si(n,s){var o=n[0]/n[3],c=n[1]/n[3];return o>=-s[0]&&o<=s[0]&&c>=-s[1]&&c<=s[1]}function Nn(n,s,o,c,_,w,S,z){var P=c?n.textSizeData:n.iconSizeData,O=a.evaluateSizeForZoom(P,o.transform.zoom),G=[256/o.width*2+1,256/o.height*2+1],K=c?n.text.dynamicLayoutVertexArray:n.icon.dynamicLayoutVertexArray;K.clear();for(var X=n.lineVertexArray,re=c?n.text.placedSymbolArray:n.icon.placedSymbolArray,te=o.transform.width/o.transform.height,ue=!1,Y=0;Y<re.length;Y++){var le=re.get(Y);if(le.hidden||le.writingMode===a.WritingMode.vertical&&!ue)ki(le.numGlyphs,K);else{ue=!1;var pe=[le.anchorX,le.anchorY,0,1];if(a.transformMat4(pe,pe,s),si(pe,G)){var ve=ar(o.transform.cameraToCenterDistance,pe[3]),Ie=a.evaluateSizeForFeature(P,O,le),Ee=S?Ie/ve:Ie*ve,Ae=new a.Point(le.anchorX,le.anchorY),Re=Gt(Ae,_).point,Ke={},Ze=Ua(le,Ee,!1,z,s,_,w,n.glyphOffsetArray,X,K,Re,Ae,Ke,te);ue=Ze.useVertical,(Ze.notEnoughRoom||ue||Ze.needsFlipping&&Ua(le,Ee,!0,z,s,_,w,n.glyphOffsetArray,X,K,Re,Ae,Ke,te).notEnoughRoom)&&ki(le.numGlyphs,K)}else ki(le.numGlyphs,K)}}c?n.text.dynamicLayoutVertexBuffer.updateData(K):n.icon.dynamicLayoutVertexBuffer.updateData(K)}function wr(n,s,o,c,_,w,S,z,P,O,G){var K=z.glyphStartIndex+z.numGlyphs,X=z.lineStartIndex,re=z.lineStartIndex+z.lineLength,te=s.getoffsetX(z.glyphStartIndex),ue=s.getoffsetX(K-1),Y=Xr(n*te,o,c,_,w,S,z.segment,X,re,P,O,G);if(!Y)return null;var le=Xr(n*ue,o,c,_,w,S,z.segment,X,re,P,O,G);return le?{first:Y,last:le}:null}function Di(n,s,o,c){return n===a.WritingMode.horizontal&&Math.abs(o.y-s.y)>Math.abs(o.x-s.x)*c?{useVertical:!0}:(n===a.WritingMode.vertical?s.y<o.y:s.x>o.x)?{needsFlipping:!0}:null}function Ua(n,s,o,c,_,w,S,z,P,O,G,K,X,re){var te,ue=s/24,Y=n.lineOffsetX*ue,le=n.lineOffsetY*ue;if(n.numGlyphs>1){var pe=n.glyphStartIndex+n.numGlyphs,ve=n.lineStartIndex,Ie=n.lineStartIndex+n.lineLength,Ee=wr(ue,z,Y,le,o,G,K,n,P,w,X);if(!Ee)return{notEnoughRoom:!0};var Ae=Gt(Ee.first.point,S).point,Re=Gt(Ee.last.point,S).point;if(c&&!o){var Ke=Di(n.writingMode,Ae,Re,re);if(Ke)return Ke}te=[Ee.first];for(var Ze=n.glyphStartIndex+1;Ze<pe-1;Ze++)te.push(Xr(ue*z.getoffsetX(Ze),Y,le,o,G,K,n.segment,ve,Ie,P,w,X));te.push(Ee.last)}else{if(c&&!o){var ot=Gt(K,_).point,wt=n.lineStartIndex+n.segment+1,Tt=new a.Point(P.getx(wt),P.gety(wt)),Et=Gt(Tt,_),_r=Et.signedDistanceFromCamera>0?Et.point:va(K,Tt,ot,1,_),lt=Di(n.writingMode,ot,_r,re);if(lt)return lt}var Ut=Xr(ue*z.getoffsetX(n.glyphStartIndex),Y,le,o,G,K,n.segment,n.lineStartIndex,n.lineStartIndex+n.lineLength,P,w,X);if(!Ut)return{notEnoughRoom:!0};te=[Ut]}for(var Yt=0,Ft=te;Yt<Ft.length;Yt+=1){var Ot=Ft[Yt];a.addDynamicAttributes(O,Ot.point,Ot.angle)}return{}}function va(n,s,o,c,_){var w=Gt(n.add(n.sub(s)._unit()),_).point,S=o.sub(w);return o.add(S._mult(c/S.mag()))}function Xr(n,s,o,c,_,w,S,z,P,O,G,K){var X=c?n-s:n+s,re=X>0?1:-1,te=0;c&&(re*=-1,te=Math.PI),re<0&&(te+=Math.PI);for(var ue=re>0?z+S:z+S+1,Y=_,le=_,pe=0,ve=0,Ie=Math.abs(X),Ee=[];pe+ve<=Ie;){if((ue+=re)<z||ue>=P)return null;if(le=Y,Ee.push(Y),(Y=K[ue])===void 0){var Ae=new a.Point(O.getx(ue),O.gety(ue)),Re=Gt(Ae,G);if(Re.signedDistanceFromCamera>0)Y=K[ue]=Re.point;else{var Ke=ue-re;Y=va(pe===0?w:new a.Point(O.getx(Ke),O.gety(Ke)),Ae,le,Ie-pe+1,G)}}pe+=ve,ve=le.dist(Y)}var Ze=(Ie-pe)/ve,ot=Y.sub(le),wt=ot.mult(Ze)._add(le);wt._add(ot._unit()._perp()._mult(o*re));var Tt=te+Math.atan2(Y.y-le.y,Y.x-le.x);return Ee.push(wt),{point:wt,angle:Tt,path:Ee}}$t.prototype.keysLength=function(){return this.boxKeys.length+this.circleKeys.length},$t.prototype.insert=function(n,s,o,c,_){this._forEachCell(s,o,c,_,this._insertBoxCell,this.boxUid++),this.boxKeys.push(n),this.bboxes.push(s),this.bboxes.push(o),this.bboxes.push(c),this.bboxes.push(_)},$t.prototype.insertCircle=function(n,s,o,c){this._forEachCell(s-c,o-c,s+c,o+c,this._insertCircleCell,this.circleUid++),this.circleKeys.push(n),this.circles.push(s),this.circles.push(o),this.circles.push(c)},$t.prototype._insertBoxCell=function(n,s,o,c,_,w){this.boxCells[_].push(w)},$t.prototype._insertCircleCell=function(n,s,o,c,_,w){this.circleCells[_].push(w)},$t.prototype._query=function(n,s,o,c,_,w){if(o<0||n>this.width||c<0||s>this.height)return!_&&[];var S=[];if(n<=0&&s<=0&&this.width<=o&&this.height<=c){if(_)return!0;for(var z=0;z<this.boxKeys.length;z++)S.push({key:this.boxKeys[z],x1:this.bboxes[4*z],y1:this.bboxes[4*z+1],x2:this.bboxes[4*z+2],y2:this.bboxes[4*z+3]});for(var P=0;P<this.circleKeys.length;P++){var O=this.circles[3*P],G=this.circles[3*P+1],K=this.circles[3*P+2];S.push({key:this.circleKeys[P],x1:O-K,y1:G-K,x2:O+K,y2:G+K})}return w?S.filter(w):S}return this._forEachCell(n,s,o,c,this._queryCell,S,{hitTest:_,seenUids:{box:{},circle:{}}},w),_?S.length>0:S},$t.prototype._queryCircle=function(n,s,o,c,_){var w=n-o,S=n+o,z=s-o,P=s+o;if(S<0||w>this.width||P<0||z>this.height)return!c&&[];var O=[];return this._forEachCell(w,z,S,P,this._queryCellCircle,O,{hitTest:c,circle:{x:n,y:s,radius:o},seenUids:{box:{},circle:{}}},_),c?O.length>0:O},$t.prototype.query=function(n,s,o,c,_){return this._query(n,s,o,c,!1,_)},$t.prototype.hitTest=function(n,s,o,c,_){return this._query(n,s,o,c,!0,_)},$t.prototype.hitTestCircle=function(n,s,o,c){return this._queryCircle(n,s,o,!0,c)},$t.prototype._queryCell=function(n,s,o,c,_,w,S,z){var P=S.seenUids,O=this.boxCells[_];if(O!==null)for(var G=this.bboxes,K=0,X=O;K<X.length;K+=1){var re=X[K];if(!P.box[re]){P.box[re]=!0;var te=4*re;if(n<=G[te+2]&&s<=G[te+3]&&o>=G[te+0]&&c>=G[te+1]&&(!z||z(this.boxKeys[re]))){if(S.hitTest)return w.push(!0),!0;w.push({key:this.boxKeys[re],x1:G[te],y1:G[te+1],x2:G[te+2],y2:G[te+3]})}}}var ue=this.circleCells[_];if(ue!==null)for(var Y=this.circles,le=0,pe=ue;le<pe.length;le+=1){var ve=pe[le];if(!P.circle[ve]){P.circle[ve]=!0;var Ie=3*ve;if(this._circleAndRectCollide(Y[Ie],Y[Ie+1],Y[Ie+2],n,s,o,c)&&(!z||z(this.circleKeys[ve]))){if(S.hitTest)return w.push(!0),!0;var Ee=Y[Ie],Ae=Y[Ie+1],Re=Y[Ie+2];w.push({key:this.circleKeys[ve],x1:Ee-Re,y1:Ae-Re,x2:Ee+Re,y2:Ae+Re})}}}},$t.prototype._queryCellCircle=function(n,s,o,c,_,w,S,z){var P=S.circle,O=S.seenUids,G=this.boxCells[_];if(G!==null)for(var K=this.bboxes,X=0,re=G;X<re.length;X+=1){var te=re[X];if(!O.box[te]){O.box[te]=!0;var ue=4*te;if(this._circleAndRectCollide(P.x,P.y,P.radius,K[ue+0],K[ue+1],K[ue+2],K[ue+3])&&(!z||z(this.boxKeys[te])))return w.push(!0),!0}}var Y=this.circleCells[_];if(Y!==null)for(var le=this.circles,pe=0,ve=Y;pe<ve.length;pe+=1){var Ie=ve[pe];if(!O.circle[Ie]){O.circle[Ie]=!0;var Ee=3*Ie;if(this._circlesCollide(le[Ee],le[Ee+1],le[Ee+2],P.x,P.y,P.radius)&&(!z||z(this.circleKeys[Ie])))return w.push(!0),!0}}},$t.prototype._forEachCell=function(n,s,o,c,_,w,S,z){for(var P=this._convertToXCellCoord(n),O=this._convertToYCellCoord(s),G=this._convertToXCellCoord(o),K=this._convertToYCellCoord(c),X=P;X<=G;X++)for(var re=O;re<=K;re++)if(_.call(this,n,s,o,c,this.xCellCount*re+X,w,S,z))return},$t.prototype._convertToXCellCoord=function(n){return Math.max(0,Math.min(this.xCellCount-1,Math.floor(n*this.xScale)))},$t.prototype._convertToYCellCoord=function(n){return Math.max(0,Math.min(this.yCellCount-1,Math.floor(n*this.yScale)))},$t.prototype._circlesCollide=function(n,s,o,c,_,w){var S=c-n,z=_-s,P=o+w;return P*P>S*S+z*z},$t.prototype._circleAndRectCollide=function(n,s,o,c,_,w,S){var z=(w-c)/2,P=Math.abs(n-(c+z));if(P>z+o)return!1;var O=(S-_)/2,G=Math.abs(s-(_+O));if(G>O+o)return!1;if(P<=z||G<=O)return!0;var K=P-z,X=G-O;return K*K+X*X<=o*o};var ba=new Float32Array([-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0]);function ki(n,s){for(var o=0;o<n;o++){var c=s.length;s.resize(c+4),s.float32.set(ba,3*c)}}function li(n,s,o){var c=s[0],_=s[1];return n[0]=o[0]*c+o[4]*_+o[12],n[1]=o[1]*c+o[5]*_+o[13],n[3]=o[3]*c+o[7]*_+o[15],n}var cn=function(n,s,o){s===void 0&&(s=new $t(n.width+200,n.height+200,25)),o===void 0&&(o=new $t(n.width+200,n.height+200,25)),this.transform=n,this.grid=s,this.ignoredGrid=o,this.pitchfactor=Math.cos(n._pitch)*n.cameraToCenterDistance,this.screenRightBoundary=n.width+100,this.screenBottomBoundary=n.height+100,this.gridRightBoundary=n.width+200,this.gridBottomBoundary=n.height+200};function Rr(n,s,o){return s*(a.EXTENT/(n.tileSize*Math.pow(2,o-n.tileID.overscaledZ)))}cn.prototype.placeCollisionBox=function(n,s,o,c,_){var w=this.projectAndGetPerspectiveRatio(c,n.anchorPointX,n.anchorPointY),S=o*w.perspectiveRatio,z=n.x1*S+w.point.x,P=n.y1*S+w.point.y,O=n.x2*S+w.point.x,G=n.y2*S+w.point.y;return!this.isInsideGrid(z,P,O,G)||!s&&this.grid.hitTest(z,P,O,G,_)?{box:[],offscreen:!1}:{box:[z,P,O,G],offscreen:this.isOffscreen(z,P,O,G)}},cn.prototype.placeCollisionCircles=function(n,s,o,c,_,w,S,z,P,O,G,K,X){var re=[],te=new a.Point(s.anchorX,s.anchorY),ue=Gt(te,w),Y=ar(this.transform.cameraToCenterDistance,ue.signedDistanceFromCamera),le=(O?_/Y:_*Y)/a.ONE_EM,pe=Gt(te,S).point,ve=wr(le,c,s.lineOffsetX*le,s.lineOffsetY*le,!1,pe,te,s,o,S,{}),Ie=!1,Ee=!1,Ae=!0;if(ve){for(var Re=.5*K*Y+X,Ke=new a.Point(-100,-100),Ze=new a.Point(this.screenRightBoundary,this.screenBottomBoundary),ot=new ii,wt=ve.first,Tt=ve.last,Et=[],_r=wt.path.length-1;_r>=1;_r--)Et.push(wt.path[_r]);for(var lt=1;lt<Tt.path.length;lt++)Et.push(Tt.path[lt]);var Ut=2.5*Re;if(z){var Yt=Et.map(function(sa){return Gt(sa,z)});Et=Yt.some(function(sa){return sa.signedDistanceFromCamera<=0})?[]:Yt.map(function(sa){return sa.point})}var Ft=[];if(Et.length>0){for(var Ot=Et[0].clone(),Ht=Et[0].clone(),Bt=1;Bt<Et.length;Bt++)Ot.x=Math.min(Ot.x,Et[Bt].x),Ot.y=Math.min(Ot.y,Et[Bt].y),Ht.x=Math.max(Ht.x,Et[Bt].x),Ht.y=Math.max(Ht.y,Et[Bt].y);Ft=Ot.x>=Ke.x&&Ht.x<=Ze.x&&Ot.y>=Ke.y&&Ht.y<=Ze.y?[Et]:Ht.x<Ke.x||Ot.x>Ze.x||Ht.y<Ke.y||Ot.y>Ze.y?[]:a.clipLine([Et],Ke.x,Ke.y,Ze.x,Ze.y)}for(var Lt=0,Li=Ft;Lt<Li.length;Lt+=1){var ui;ot.reset(Li[Lt],.25*Re),ui=ot.length<=.5*Re?1:Math.ceil(ot.paddedLength/Ut)+1;for(var pn=0;pn<ui;pn++){var Xi=pn/Math.max(ui-1,1),ni=ot.lerp(Xi),mi=ni.x+100,Wn=ni.y+100;re.push(mi,Wn,Re,0);var kn=mi-Re,$a=Wn-Re,Dn=mi+Re,_a=Wn+Re;if(Ae=Ae&&this.isOffscreen(kn,$a,Dn,_a),Ee=Ee||this.isInsideGrid(kn,$a,Dn,_a),!n&&this.grid.hitTestCircle(mi,Wn,Re,G)&&(Ie=!0,!P))return{circles:[],offscreen:!1,collisionDetected:Ie}}}}return{circles:!P&&Ie||!Ee?[]:re,offscreen:Ae,collisionDetected:Ie}},cn.prototype.queryRenderedSymbols=function(n){if(n.length===0||this.grid.keysLength()===0&&this.ignoredGrid.keysLength()===0)return{};for(var s=[],o=1/0,c=1/0,_=-1/0,w=-1/0,S=0,z=n;S<z.length;S+=1){var P=z[S],O=new a.Point(P.x+100,P.y+100);o=Math.min(o,O.x),c=Math.min(c,O.y),_=Math.max(_,O.x),w=Math.max(w,O.y),s.push(O)}for(var G={},K={},X=0,re=this.grid.query(o,c,_,w).concat(this.ignoredGrid.query(o,c,_,w));X<re.length;X+=1){var te=re[X],ue=te.key;if(G[ue.bucketInstanceId]===void 0&&(G[ue.bucketInstanceId]={}),!G[ue.bucketInstanceId][ue.featureIndex]){var Y=[new a.Point(te.x1,te.y1),new a.Point(te.x2,te.y1),new a.Point(te.x2,te.y2),new a.Point(te.x1,te.y2)];a.polygonIntersectsPolygon(s,Y)&&(G[ue.bucketInstanceId][ue.featureIndex]=!0,K[ue.bucketInstanceId]===void 0&&(K[ue.bucketInstanceId]=[]),K[ue.bucketInstanceId].push(ue.featureIndex))}}return K},cn.prototype.insertCollisionBox=function(n,s,o,c,_){(s?this.ignoredGrid:this.grid).insert({bucketInstanceId:o,featureIndex:c,collisionGroupID:_},n[0],n[1],n[2],n[3])},cn.prototype.insertCollisionCircles=function(n,s,o,c,_){for(var w=s?this.ignoredGrid:this.grid,S={bucketInstanceId:o,featureIndex:c,collisionGroupID:_},z=0;z<n.length;z+=4)w.insertCircle(S,n[z],n[z+1],n[z+2])},cn.prototype.projectAndGetPerspectiveRatio=function(n,s,o){var c=[s,o,0,1];return li(c,c,n),{point:new a.Point((c[0]/c[3]+1)/2*this.transform.width+100,(-c[1]/c[3]+1)/2*this.transform.height+100),perspectiveRatio:.5+this.transform.cameraToCenterDistance/c[3]*.5}},cn.prototype.isOffscreen=function(n,s,o,c){return o<100||n>=this.screenRightBoundary||c<100||s>this.screenBottomBoundary},cn.prototype.isInsideGrid=function(n,s,o,c){return o>=0&&n<this.gridRightBoundary&&c>=0&&s<this.gridBottomBoundary},cn.prototype.getViewportMatrix=function(){var n=a.identity([]);return a.translate(n,n,[-100,-100,0]),n};var Un=function(n,s,o,c){this.opacity=n?Math.max(0,Math.min(1,n.opacity+(n.placed?s:-s))):c&&o?1:0,this.placed=o};Un.prototype.isHidden=function(){return this.opacity===0&&!this.placed};var xn=function(n,s,o,c,_){this.text=new Un(n?n.text:null,s,o,_),this.icon=new Un(n?n.icon:null,s,c,_)};xn.prototype.isHidden=function(){return this.text.isHidden()&&this.icon.isHidden()};var os=function(n,s,o){this.text=n,this.icon=s,this.skipFade=o},Ei=function(){this.invProjMatrix=a.create(),this.viewportMatrix=a.create(),this.circles=[]},xa=function(n,s,o,c,_){this.bucketInstanceId=n,this.featureIndex=s,this.sourceLayerIndex=o,this.bucketIndex=c,this.tileID=_},qi=function(n){this.crossSourceCollisions=n,this.maxGroupID=0,this.collisionGroups={}};function Ti(n,s,o,c,_){var w=a.getAnchorAlignment(n),S=-(w.horizontalAlign-.5)*s,z=-(w.verticalAlign-.5)*o,P=a.evaluateVariableOffset(n,c);return new a.Point(S+P[0]*_,z+P[1]*_)}function $n(n,s,o,c,_,w){var S=n.x1,z=n.x2,P=n.y1,O=n.y2,G=n.anchorPointX,K=n.anchorPointY,X=new a.Point(s,o);return c&&X._rotate(_?w:-w),{x1:S+X.x,y1:P+X.y,x2:z+X.x,y2:O+X.y,anchorPointX:G,anchorPointY:K}}qi.prototype.get=function(n){if(this.crossSourceCollisions)return{ID:0,predicate:null};if(!this.collisionGroups[n]){var s=++this.maxGroupID;this.collisionGroups[n]={ID:s,predicate:function(o){return o.collisionGroupID===s}}}return this.collisionGroups[n]};var Zi=function(n,s,o,c){this.transform=n.clone(),this.collisionIndex=new cn(this.transform),this.placements={},this.opacities={},this.variableOffsets={},this.stale=!1,this.commitTime=0,this.fadeDuration=s,this.retainedQueryData={},this.collisionGroups=new qi(o),this.collisionCircleArrays={},this.prevPlacement=c,c&&(c.prevPlacement=void 0),this.placedOrientations={}};function wa(n,s,o,c,_){n.emplaceBack(s?1:0,o?1:0,c||0,_||0),n.emplaceBack(s?1:0,o?1:0,c||0,_||0),n.emplaceBack(s?1:0,o?1:0,c||0,_||0),n.emplaceBack(s?1:0,o?1:0,c||0,_||0)}Zi.prototype.getBucketParts=function(n,s,o,c){var _=o.getBucket(s),w=o.latestFeatureIndex;if(_&&w&&s.id===_.layerIds[0]){var S=o.collisionBoxArray,z=_.layers[0].layout,P=Math.pow(2,this.transform.zoom-o.tileID.overscaledZ),O=o.tileSize/a.EXTENT,G=this.transform.calculatePosMatrix(o.tileID.toUnwrapped()),K=z.get("text-pitch-alignment")==="map",X=z.get("text-rotation-alignment")==="map",re=Rr(o,1,this.transform.zoom),te=br(G,K,X,this.transform,re),ue=null;if(K){var Y=fr(G,K,X,this.transform,re);ue=a.multiply([],this.transform.labelPlaneMatrix,Y)}this.retainedQueryData[_.bucketInstanceId]=new xa(_.bucketInstanceId,w,_.sourceLayerIndex,_.index,o.tileID);var le={bucket:_,layout:z,posMatrix:G,textLabelPlaneMatrix:te,labelToScreenMatrix:ue,scale:P,textPixelRatio:O,holdingForFade:o.holdingForFade(),collisionBoxArray:S,partiallyEvaluatedTextSize:a.evaluateSizeForZoom(_.textSizeData,this.transform.zoom),collisionGroup:this.collisionGroups.get(_.sourceID)};if(c)for(var pe=0,ve=_.sortKeyRanges;pe<ve.length;pe+=1){var Ie=ve[pe];n.push({sortKey:Ie.sortKey,symbolInstanceStart:Ie.symbolInstanceStart,symbolInstanceEnd:Ie.symbolInstanceEnd,parameters:le})}else n.push({symbolInstanceStart:0,symbolInstanceEnd:_.symbolInstances.length,parameters:le})}},Zi.prototype.attemptAnchorPlacement=function(n,s,o,c,_,w,S,z,P,O,G,K,X,re,te){var ue,Y=[K.textOffset0,K.textOffset1],le=Ti(n,o,c,Y,_),pe=this.collisionIndex.placeCollisionBox($n(s,le.x,le.y,w,S,this.transform.angle),G,z,P,O.predicate);if(!te||this.collisionIndex.placeCollisionBox($n(te,le.x,le.y,w,S,this.transform.angle),G,z,P,O.predicate).box.length!==0)return pe.box.length>0?(this.prevPlacement&&this.prevPlacement.variableOffsets[K.crossTileID]&&this.prevPlacement.placements[K.crossTileID]&&this.prevPlacement.placements[K.crossTileID].text&&(ue=this.prevPlacement.variableOffsets[K.crossTileID].anchor),this.variableOffsets[K.crossTileID]={textOffset:Y,width:o,height:c,anchor:n,textBoxScale:_,prevAnchor:ue},this.markUsedJustification(X,n,K,re),X.allowVerticalPlacement&&(this.markUsedOrientation(X,re,K),this.placedOrientations[K.crossTileID]=re),{shift:le,placedGlyphBoxes:pe}):void 0},Zi.prototype.placeLayerBucketPart=function(n,s,o){var c=this,_=n.parameters,w=_.bucket,S=_.layout,z=_.posMatrix,P=_.textLabelPlaneMatrix,O=_.labelToScreenMatrix,G=_.textPixelRatio,K=_.holdingForFade,X=_.collisionBoxArray,re=_.partiallyEvaluatedTextSize,te=_.collisionGroup,ue=S.get("text-optional"),Y=S.get("icon-optional"),le=S.get("text-allow-overlap"),pe=S.get("icon-allow-overlap"),ve=S.get("text-rotation-alignment")==="map",Ie=S.get("text-pitch-alignment")==="map",Ee=S.get("icon-text-fit")!=="none",Ae=S.get("symbol-z-order")==="viewport-y",Re=le&&(pe||!w.hasIconData()||Y),Ke=pe&&(le||!w.hasTextData()||ue);!w.collisionArrays&&X&&w.deserializeCollisionBoxes(X);var Ze=function(lt,Ut){if(!s[lt.crossTileID])if(K)c.placements[lt.crossTileID]=new os(!1,!1,!1);else{var Yt,Ft=!1,Ot=!1,Ht=!0,Bt=null,Lt={box:null,offscreen:null},Li={box:null,offscreen:null},ui=null,pn=null,Xi=0,ni=0,mi=0;Ut.textFeatureIndex?Xi=Ut.textFeatureIndex:lt.useRuntimeCollisionCircles&&(Xi=lt.featureIndex),Ut.verticalTextFeatureIndex&&(ni=Ut.verticalTextFeatureIndex);var Wn=Ut.textBox;if(Wn){var kn=function(Er){var ra=a.WritingMode.horizontal;if(w.allowVerticalPlacement&&!Er&&c.prevPlacement){var Ln=c.prevPlacement.placedOrientations[lt.crossTileID];Ln&&(c.placedOrientations[lt.crossTileID]=Ln,c.markUsedOrientation(w,ra=Ln,lt))}return ra},$a=function(Er,ra){if(w.allowVerticalPlacement&&lt.numVerticalGlyphVertices>0&&Ut.verticalTextBox)for(var Ln=0,Ao=w.writingModes;Ln<Ao.length&&(Ao[Ln]===a.WritingMode.vertical?(Lt=ra(),Li=Lt):Lt=Er(),!(Lt&&Lt.box&&Lt.box.length));Ln+=1);else Lt=Er()};if(S.get("text-variable-anchor")){var Dn=S.get("text-variable-anchor");if(c.prevPlacement&&c.prevPlacement.variableOffsets[lt.crossTileID]){var _a=c.prevPlacement.variableOffsets[lt.crossTileID];Dn.indexOf(_a.anchor)>0&&(Dn=Dn.filter(function(Er){return Er!==_a.anchor})).unshift(_a.anchor)}var sa=function(Er,ra,Ln){for(var Ao=Er.x2-Er.x1,Hh=Er.y2-Er.y1,al=lt.textBoxScale,Jh=Ee&&!pe?ra:null,Is={box:[],offscreen:!1},Pc=le?2*Dn.length:Dn.length,Jo=0;Jo<Pc;++Jo){var ol=c.attemptAnchorPlacement(Dn[Jo%Dn.length],Er,Ao,Hh,al,ve,Ie,G,z,te,Jo>=Dn.length,lt,w,Ln,Jh);if(ol&&(Is=ol.placedGlyphBoxes)&&Is.box&&Is.box.length){Ft=!0,Bt=ol.shift;break}}return Is};$a(function(){return sa(Wn,Ut.iconBox,a.WritingMode.horizontal)},function(){var Er=Ut.verticalTextBox;return w.allowVerticalPlacement&&!(Lt&&Lt.box&&Lt.box.length)&&lt.numVerticalGlyphVertices>0&&Er?sa(Er,Ut.verticalIconBox,a.WritingMode.vertical):{box:null,offscreen:null}}),Lt&&(Ft=Lt.box,Ht=Lt.offscreen);var Es=kn(Lt&&Lt.box);if(!Ft&&c.prevPlacement){var Wo=c.prevPlacement.variableOffsets[lt.crossTileID];Wo&&(c.variableOffsets[lt.crossTileID]=Wo,c.markUsedJustification(w,Wo.anchor,lt,Es))}}else{var eo=function(Er,ra){var Ln=c.collisionIndex.placeCollisionBox(Er,le,G,z,te.predicate);return Ln&&Ln.box&&Ln.box.length&&(c.markUsedOrientation(w,ra,lt),c.placedOrientations[lt.crossTileID]=ra),Ln};$a(function(){return eo(Wn,a.WritingMode.horizontal)},function(){var Er=Ut.verticalTextBox;return w.allowVerticalPlacement&&lt.numVerticalGlyphVertices>0&&Er?eo(Er,a.WritingMode.vertical):{box:null,offscreen:null}}),kn(Lt&&Lt.box&&Lt.box.length)}}if(Ft=(Yt=Lt)&&Yt.box&&Yt.box.length>0,Ht=Yt&&Yt.offscreen,lt.useRuntimeCollisionCircles){var Ho=w.text.placedSymbolArray.get(lt.centerJustifiedTextSymbolIndex),Ts=a.evaluateSizeForFeature(w.textSizeData,re,Ho),Ia=S.get("text-padding");ui=c.collisionIndex.placeCollisionCircles(le,Ho,w.lineVertexArray,w.glyphOffsetArray,Ts,z,P,O,o,Ie,te.predicate,lt.collisionCircleDiameter,Ia),Ft=le||ui.circles.length>0&&!ui.collisionDetected,Ht=Ht&&ui.offscreen}if(Ut.iconFeatureIndex&&(mi=Ut.iconFeatureIndex),Ut.iconBox){var zs=function(Er){var ra=Ee&&Bt?$n(Er,Bt.x,Bt.y,ve,Ie,c.transform.angle):Er;return c.collisionIndex.placeCollisionBox(ra,pe,G,z,te.predicate)};Ot=Li&&Li.box&&Li.box.length&&Ut.verticalIconBox?(pn=zs(Ut.verticalIconBox)).box.length>0:(pn=zs(Ut.iconBox)).box.length>0,Ht=Ht&&pn.offscreen}var Aa=ue||lt.numHorizontalGlyphVertices===0&&lt.numVerticalGlyphVertices===0,Ri=Y||lt.numIconVertices===0;if(Aa||Ri?Ri?Aa||(Ot=Ot&&Ft):Ft=Ot&&Ft:Ot=Ft=Ot&&Ft,Ft&&Yt&&Yt.box&&c.collisionIndex.insertCollisionBox(Yt.box,S.get("text-ignore-placement"),w.bucketInstanceId,Li&&Li.box&&ni?ni:Xi,te.ID),Ot&&pn&&c.collisionIndex.insertCollisionBox(pn.box,S.get("icon-ignore-placement"),w.bucketInstanceId,mi,te.ID),ui&&(Ft&&c.collisionIndex.insertCollisionCircles(ui.circles,S.get("text-ignore-placement"),w.bucketInstanceId,Xi,te.ID),o)){var La=w.bucketInstanceId,to=c.collisionCircleArrays[La];to===void 0&&(to=c.collisionCircleArrays[La]=new Ei);for(var Io=0;Io<ui.circles.length;Io+=4)to.circles.push(ui.circles[Io+0]),to.circles.push(ui.circles[Io+1]),to.circles.push(ui.circles[Io+2]),to.circles.push(ui.collisionDetected?1:0)}c.placements[lt.crossTileID]=new os(Ft||Re,Ot||Ke,Ht||w.justReloaded),s[lt.crossTileID]=!0}};if(Ae)for(var ot=w.getSortedSymbolIndexes(this.transform.angle),wt=ot.length-1;wt>=0;--wt){var Tt=ot[wt];Ze(w.symbolInstances.get(Tt),w.collisionArrays[Tt])}else for(var Et=n.symbolInstanceStart;Et<n.symbolInstanceEnd;Et++)Ze(w.symbolInstances.get(Et),w.collisionArrays[Et]);if(o&&w.bucketInstanceId in this.collisionCircleArrays){var _r=this.collisionCircleArrays[w.bucketInstanceId];a.invert(_r.invProjMatrix,z),_r.viewportMatrix=this.collisionIndex.getViewportMatrix()}w.justReloaded=!1},Zi.prototype.markUsedJustification=function(n,s,o,c){var _;_=c===a.WritingMode.vertical?o.verticalPlacedTextSymbolIndex:{left:o.leftJustifiedTextSymbolIndex,center:o.centerJustifiedTextSymbolIndex,right:o.rightJustifiedTextSymbolIndex}[a.getAnchorJustification(s)];for(var w=0,S=[o.leftJustifiedTextSymbolIndex,o.centerJustifiedTextSymbolIndex,o.rightJustifiedTextSymbolIndex,o.verticalPlacedTextSymbolIndex];w<S.length;w+=1){var z=S[w];z>=0&&(n.text.placedSymbolArray.get(z).crossTileID=_>=0&&z!==_?0:o.crossTileID)}},Zi.prototype.markUsedOrientation=function(n,s,o){for(var c=s===a.WritingMode.horizontal||s===a.WritingMode.horizontalOnly?s:0,_=s===a.WritingMode.vertical?s:0,w=0,S=[o.leftJustifiedTextSymbolIndex,o.centerJustifiedTextSymbolIndex,o.rightJustifiedTextSymbolIndex];w<S.length;w+=1)n.text.placedSymbolArray.get(S[w]).placedOrientation=c;o.verticalPlacedTextSymbolIndex&&(n.text.placedSymbolArray.get(o.verticalPlacedTextSymbolIndex).placedOrientation=_)},Zi.prototype.commit=function(n){this.commitTime=n,this.zoomAtLastRecencyCheck=this.transform.zoom;var s=this.prevPlacement,o=!1;this.prevZoomAdjustment=s?s.zoomAdjustment(this.transform.zoom):0;var c=s?s.symbolFadeChange(n):1,_=s?s.opacities:{},w=s?s.variableOffsets:{},S=s?s.placedOrientations:{};for(var z in this.placements){var P=this.placements[z],O=_[z];O?(this.opacities[z]=new xn(O,c,P.text,P.icon),o=o||P.text!==O.text.placed||P.icon!==O.icon.placed):(this.opacities[z]=new xn(null,c,P.text,P.icon,P.skipFade),o=o||P.text||P.icon)}for(var G in _){var K=_[G];if(!this.opacities[G]){var X=new xn(K,c,!1,!1);X.isHidden()||(this.opacities[G]=X,o=o||K.text.placed||K.icon.placed)}}for(var re in w)this.variableOffsets[re]||!this.opacities[re]||this.opacities[re].isHidden()||(this.variableOffsets[re]=w[re]);for(var te in S)this.placedOrientations[te]||!this.opacities[te]||this.opacities[te].isHidden()||(this.placedOrientations[te]=S[te]);o?this.lastPlacementChangeTime=n:typeof this.lastPlacementChangeTime!="number"&&(this.lastPlacementChangeTime=s?s.lastPlacementChangeTime:n)},Zi.prototype.updateLayerOpacities=function(n,s){for(var o={},c=0,_=s;c<_.length;c+=1){var w=_[c],S=w.getBucket(n);S&&w.latestFeatureIndex&&n.id===S.layerIds[0]&&this.updateBucketOpacities(S,o,w.collisionBoxArray)}},Zi.prototype.updateBucketOpacities=function(n,s,o){var c=this;n.hasTextData()&&n.text.opacityVertexArray.clear(),n.hasIconData()&&n.icon.opacityVertexArray.clear(),n.hasIconCollisionBoxData()&&n.iconCollisionBox.collisionVertexArray.clear(),n.hasTextCollisionBoxData()&&n.textCollisionBox.collisionVertexArray.clear();var _=n.layers[0].layout,w=new xn(null,0,!1,!1,!0),S=_.get("text-allow-overlap"),z=_.get("icon-allow-overlap"),P=_.get("text-variable-anchor"),O=_.get("text-rotation-alignment")==="map",G=_.get("text-pitch-alignment")==="map",K=_.get("icon-text-fit")!=="none",X=new xn(null,0,S&&(z||!n.hasIconData()||_.get("icon-optional")),z&&(S||!n.hasTextData()||_.get("text-optional")),!0);!n.collisionArrays&&o&&(n.hasIconCollisionBoxData()||n.hasTextCollisionBoxData())&&n.deserializeCollisionBoxes(o);for(var re=function(le,pe,ve){for(var Ie=0;Ie<pe/4;Ie++)le.opacityVertexArray.emplaceBack(ve)},te=function(le){var pe=n.symbolInstances.get(le),ve=pe.numHorizontalGlyphVertices,Ie=pe.numVerticalGlyphVertices,Ee=pe.crossTileID,Ae=c.opacities[Ee];s[Ee]?Ae=w:Ae||(c.opacities[Ee]=Ae=X),s[Ee]=!0;var Re=pe.numIconVertices>0,Ke=c.placedOrientations[pe.crossTileID],Ze=Ke===a.WritingMode.vertical,ot=Ke===a.WritingMode.horizontal||Ke===a.WritingMode.horizontalOnly;if(ve>0||Ie>0){var wt=Ns(Ae.text);re(n.text,ve,Ze?Va:wt),re(n.text,Ie,ot?Va:wt);var Tt=Ae.text.isHidden();[pe.rightJustifiedTextSymbolIndex,pe.centerJustifiedTextSymbolIndex,pe.leftJustifiedTextSymbolIndex].forEach(function(Lt){Lt>=0&&(n.text.placedSymbolArray.get(Lt).hidden=Tt||Ze?1:0)}),pe.verticalPlacedTextSymbolIndex>=0&&(n.text.placedSymbolArray.get(pe.verticalPlacedTextSymbolIndex).hidden=Tt||ot?1:0);var Et=c.variableOffsets[pe.crossTileID];Et&&c.markUsedJustification(n,Et.anchor,pe,Ke);var _r=c.placedOrientations[pe.crossTileID];_r&&(c.markUsedJustification(n,"left",pe,_r),c.markUsedOrientation(n,_r,pe))}if(Re){var lt=Ns(Ae.icon),Ut=!(K&&pe.verticalPlacedIconSymbolIndex&&Ze);pe.placedIconSymbolIndex>=0&&(re(n.icon,pe.numIconVertices,Ut?lt:Va),n.icon.placedSymbolArray.get(pe.placedIconSymbolIndex).hidden=Ae.icon.isHidden()),pe.verticalPlacedIconSymbolIndex>=0&&(re(n.icon,pe.numVerticalIconVertices,Ut?Va:lt),n.icon.placedSymbolArray.get(pe.verticalPlacedIconSymbolIndex).hidden=Ae.icon.isHidden())}if(n.hasIconCollisionBoxData()||n.hasTextCollisionBoxData()){var Yt=n.collisionArrays[le];if(Yt){var Ft=new a.Point(0,0);if(Yt.textBox||Yt.verticalTextBox){var Ot=!0;if(P){var Ht=c.variableOffsets[Ee];Ht?(Ft=Ti(Ht.anchor,Ht.width,Ht.height,Ht.textOffset,Ht.textBoxScale),O&&Ft._rotate(G?c.transform.angle:-c.transform.angle)):Ot=!1}Yt.textBox&&wa(n.textCollisionBox.collisionVertexArray,Ae.text.placed,!Ot||Ze,Ft.x,Ft.y),Yt.verticalTextBox&&wa(n.textCollisionBox.collisionVertexArray,Ae.text.placed,!Ot||ot,Ft.x,Ft.y)}var Bt=!!(!ot&&Yt.verticalIconBox);Yt.iconBox&&wa(n.iconCollisionBox.collisionVertexArray,Ae.icon.placed,Bt,K?Ft.x:0,K?Ft.y:0),Yt.verticalIconBox&&wa(n.iconCollisionBox.collisionVertexArray,Ae.icon.placed,!Bt,K?Ft.x:0,K?Ft.y:0)}}},ue=0;ue<n.symbolInstances.length;ue++)te(ue);if(n.sortFeatures(this.transform.angle),this.retainedQueryData[n.bucketInstanceId]&&(this.retainedQueryData[n.bucketInstanceId].featureSortOrder=n.featureSortOrder),n.hasTextData()&&n.text.opacityVertexBuffer&&n.text.opacityVertexBuffer.updateData(n.text.opacityVertexArray),n.hasIconData()&&n.icon.opacityVertexBuffer&&n.icon.opacityVertexBuffer.updateData(n.icon.opacityVertexArray),n.hasIconCollisionBoxData()&&n.iconCollisionBox.collisionVertexBuffer&&n.iconCollisionBox.collisionVertexBuffer.updateData(n.iconCollisionBox.collisionVertexArray),n.hasTextCollisionBoxData()&&n.textCollisionBox.collisionVertexBuffer&&n.textCollisionBox.collisionVertexBuffer.updateData(n.textCollisionBox.collisionVertexArray),n.bucketInstanceId in this.collisionCircleArrays){var Y=this.collisionCircleArrays[n.bucketInstanceId];n.placementInvProjMatrix=Y.invProjMatrix,n.placementViewportMatrix=Y.viewportMatrix,n.collisionCircleArray=Y.circles,delete this.collisionCircleArrays[n.bucketInstanceId]}},Zi.prototype.symbolFadeChange=function(n){return this.fadeDuration===0?1:(n-this.commitTime)/this.fadeDuration+this.prevZoomAdjustment},Zi.prototype.zoomAdjustment=function(n){return Math.max(0,(this.transform.zoom-n)/1.5)},Zi.prototype.hasTransitions=function(n){return this.stale||n-this.lastPlacementChangeTime<this.fadeDuration},Zi.prototype.stillRecent=function(n,s){var o=this.zoomAtLastRecencyCheck===s?1-this.zoomAdjustment(s):1;return this.zoomAtLastRecencyCheck=s,this.commitTime+this.fadeDuration*o>n},Zi.prototype.setStale=function(){this.stale=!0};var ss=Math.pow(2,25),Nl=Math.pow(2,24),co=Math.pow(2,17),Ul=Math.pow(2,16),Bo=Math.pow(2,9),Vl=Math.pow(2,8),Oo=Math.pow(2,1);function Ns(n){if(n.opacity===0&&!n.placed)return 0;if(n.opacity===1&&n.placed)return 4294967295;var s=n.placed?1:0,o=Math.floor(127*n.opacity);return o*ss+s*Nl+o*co+s*Ul+o*Bo+s*Vl+o*Oo+s}var Va=0,ls=function(n){this._sortAcrossTiles=n.layout.get("symbol-z-order")!=="viewport-y"&&n.layout.get("symbol-sort-key").constantOr(1)!==void 0,this._currentTileIndex=0,this._currentPartIndex=0,this._seenCrossTileIDs={},this._bucketParts=[]};ls.prototype.continuePlacement=function(n,s,o,c,_){for(var w=this._bucketParts;this._currentTileIndex<n.length;)if(s.getBucketParts(w,c,n[this._currentTileIndex],this._sortAcrossTiles),this._currentTileIndex++,_())return!0;for(this._sortAcrossTiles&&(this._sortAcrossTiles=!1,w.sort(function(S,z){return S.sortKey-z.sortKey}));this._currentPartIndex<w.length;)if(s.placeLayerBucketPart(w[this._currentPartIndex],this._seenCrossTileIDs,o),this._currentPartIndex++,_())return!0;return!1};var ho=function(n,s,o,c,_,w,S){this.placement=new Zi(n,_,w,S),this._currentPlacementIndex=s.length-1,this._forceFullPlacement=o,this._showCollisionBoxes=c,this._done=!1};ho.prototype.isDone=function(){return this._done},ho.prototype.continuePlacement=function(n,s,o){for(var c=this,_=a.browser.now(),w=function(){var P=a.browser.now()-_;return!c._forceFullPlacement&&P>2};this._currentPlacementIndex>=0;){var S=s[n[this._currentPlacementIndex]],z=this.placement.collisionIndex.transform.zoom;if(S.type==="symbol"&&(!S.minzoom||S.minzoom<=z)&&(!S.maxzoom||S.maxzoom>z)){if(this._inProgressLayer||(this._inProgressLayer=new ls(S)),this._inProgressLayer.continuePlacement(o[S.source],this.placement,this._showCollisionBoxes,S,w))return;delete this._inProgressLayer}this._currentPlacementIndex--}this._done=!0},ho.prototype.commit=function(n){return this.placement.commit(n),this.placement};var Us=512/a.EXTENT/2,ja=function(n,s,o){this.tileID=n,this.indexedSymbolInstances={},this.bucketInstanceId=o;for(var c=0;c<s.length;c++){var _=s.get(c),w=_.key;this.indexedSymbolInstances[w]||(this.indexedSymbolInstances[w]=[]),this.indexedSymbolInstances[w].push({crossTileID:_.crossTileID,coord:this.getScaledCoordinates(_,n)})}};ja.prototype.getScaledCoordinates=function(n,s){var o=Us/Math.pow(2,s.canonical.z-this.tileID.canonical.z);return{x:Math.floor((s.canonical.x*a.EXTENT+n.anchorX)*o),y:Math.floor((s.canonical.y*a.EXTENT+n.anchorY)*o)}},ja.prototype.findMatches=function(n,s,o){for(var c=this.tileID.canonical.z<s.canonical.z?1:Math.pow(2,this.tileID.canonical.z-s.canonical.z),_=0;_<n.length;_++){var w=n.get(_);if(!w.crossTileID){var S=this.indexedSymbolInstances[w.key];if(S)for(var z=this.getScaledCoordinates(w,s),P=0,O=S;P<O.length;P+=1){var G=O[P];if(Math.abs(G.coord.x-z.x)<=c&&Math.abs(G.coord.y-z.y)<=c&&!o[G.crossTileID]){o[G.crossTileID]=!0,w.crossTileID=G.crossTileID;break}}}}};var Vn=function(){this.maxCrossTileID=0};Vn.prototype.generate=function(){return++this.maxCrossTileID};var Sa=function(){this.indexes={},this.usedCrossTileIDs={},this.lng=0};Sa.prototype.handleWrapJump=function(n){var s=Math.round((n-this.lng)/360);if(s!==0)for(var o in this.indexes){var c=this.indexes[o],_={};for(var w in c){var S=c[w];S.tileID=S.tileID.unwrapTo(S.tileID.wrap+s),_[S.tileID.key]=S}this.indexes[o]=_}this.lng=n},Sa.prototype.addBucket=function(n,s,o){if(this.indexes[n.overscaledZ]&&this.indexes[n.overscaledZ][n.key]){if(this.indexes[n.overscaledZ][n.key].bucketInstanceId===s.bucketInstanceId)return!1;this.removeBucketCrossTileIDs(n.overscaledZ,this.indexes[n.overscaledZ][n.key])}for(var c=0;c<s.symbolInstances.length;c++)s.symbolInstances.get(c).crossTileID=0;this.usedCrossTileIDs[n.overscaledZ]||(this.usedCrossTileIDs[n.overscaledZ]={});var _=this.usedCrossTileIDs[n.overscaledZ];for(var w in this.indexes){var S=this.indexes[w];if(Number(w)>n.overscaledZ)for(var z in S){var P=S[z];P.tileID.isChildOf(n)&&P.findMatches(s.symbolInstances,n,_)}else{var O=S[n.scaledTo(Number(w)).key];O&&O.findMatches(s.symbolInstances,n,_)}}for(var G=0;G<s.symbolInstances.length;G++){var K=s.symbolInstances.get(G);K.crossTileID||(K.crossTileID=o.generate(),_[K.crossTileID]=!0)}return this.indexes[n.overscaledZ]===void 0&&(this.indexes[n.overscaledZ]={}),this.indexes[n.overscaledZ][n.key]=new ja(n,s.symbolInstances,s.bucketInstanceId),!0},Sa.prototype.removeBucketCrossTileIDs=function(n,s){for(var o in s.indexedSymbolInstances)for(var c=0,_=s.indexedSymbolInstances[o];c<_.length;c+=1)delete this.usedCrossTileIDs[n][_[c].crossTileID]},Sa.prototype.removeStaleBuckets=function(n){var s=!1;for(var o in this.indexes){var c=this.indexes[o];for(var _ in c)n[c[_].bucketInstanceId]||(this.removeBucketCrossTileIDs(o,c[_]),delete c[_],s=!0)}return s};var ye=function(){this.layerIndexes={},this.crossTileIDs=new Vn,this.maxBucketInstanceId=0,this.bucketsInCurrentPlacement={}};ye.prototype.addLayer=function(n,s,o){var c=this.layerIndexes[n.id];c===void 0&&(c=this.layerIndexes[n.id]=new Sa);var _=!1,w={};c.handleWrapJump(o);for(var S=0,z=s;S<z.length;S+=1){var P=z[S],O=P.getBucket(n);O&&n.id===O.layerIds[0]&&(O.bucketInstanceId||(O.bucketInstanceId=++this.maxBucketInstanceId),c.addBucket(P.tileID,O,this.crossTileIDs)&&(_=!0),w[O.bucketInstanceId]=!0)}return c.removeStaleBuckets(w)&&(_=!0),_},ye.prototype.pruneUnusedLayers=function(n){var s={};for(var o in n.forEach(function(c){s[c]=!0}),this.layerIndexes)s[o]||delete this.layerIndexes[o]};var hn=function(n,s){return a.emitValidationErrors(n,s&&s.filter(function(o){return o.identifier!=="source.canvas"}))},Gi=a.pick(qe,["addLayer","removeLayer","setPaintProperty","setLayoutProperty","setFilter","addSource","removeSource","setLayerZoomRange","setLight","setTransition","setGeoJSONSourceData"]),Wr=a.pick(qe,["setCenter","setZoom","setBearing","setPitch"]),ka=function(){var n={},s=a.styleSpec.$version;for(var o in a.styleSpec.$root){var c,_=a.styleSpec.$root[o];_.required&&(c=o==="version"?s:_.type==="array"?[]:{})!=null&&(n[o]=c)}return n}(),jn=function(n){function s(o,c){var _=this;c===void 0&&(c={}),n.call(this),this.map=o,this.dispatcher=new zt(ke(),this),this.imageManager=new xe,this.imageManager.setEventedParent(this),this.glyphManager=new ht(o._requestManager,c.localIdeographFontFamily),this.lineAtlas=new bt(256,512),this.crossTileSymbolIndex=new ye,this._layers={},this._serializedLayers={},this._order=[],this.sourceCaches={},this.zoomHistory=new a.ZoomHistory,this._loaded=!1,this._availableImages=[],this._resetUpdates(),this.dispatcher.broadcast("setReferrer",a.getReferrer());var w=this;this._rtlTextPluginCallback=s.registerForPluginStateChange(function(S){w.dispatcher.broadcast("syncRTLPluginState",{pluginStatus:S.pluginStatus,pluginURL:S.pluginURL},function(z,P){if(a.triggerPluginCompletionEvent(z),P&&P.every(function(G){return G}))for(var O in w.sourceCaches)w.sourceCaches[O].reload()})}),this.on("data",function(S){if(S.dataType==="source"&&S.sourceDataType==="metadata"){var z=_.sourceCaches[S.sourceId];if(z){var P=z.getSource();if(P&&P.vectorLayerIds)for(var O in _._layers){var G=_._layers[O];G.source===P.id&&_._validateLayer(G)}}}})}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype.loadURL=function(o,c){var _=this;c===void 0&&(c={}),this.fire(new a.Event("dataloading",{dataType:"style"}));var w=typeof c.validate=="boolean"?c.validate:!a.isMapboxURL(o);o=this.map._requestManager.normalizeStyleURL(o,c.accessToken);var S=this.map._requestManager.transformRequest(o,a.ResourceType.Style);this._request=a.getJSON(S,function(z,P){_._request=null,z?_.fire(new a.ErrorEvent(z)):P&&_._load(P,w)})},s.prototype.loadJSON=function(o,c){var _=this;c===void 0&&(c={}),this.fire(new a.Event("dataloading",{dataType:"style"})),this._request=a.browser.frame(function(){_._request=null,_._load(o,c.validate!==!1)})},s.prototype.loadEmpty=function(){this.fire(new a.Event("dataloading",{dataType:"style"})),this._load(ka,!1)},s.prototype._load=function(o,c){if(!c||!hn(this,a.validateStyle(o))){for(var _ in this._loaded=!0,this.stylesheet=o,o.sources)this.addSource(_,o.sources[_],{validate:!1});o.sprite?this._loadSprite(o.sprite):this.imageManager.setLoaded(!0),this.glyphManager.setURL(o.glyphs);var w=Oe(this.stylesheet.layers);this._order=w.map(function(O){return O.id}),this._layers={},this._serializedLayers={};for(var S=0,z=w;S<z.length;S+=1){var P=z[S];(P=a.createStyleLayer(P)).setEventedParent(this,{layer:{id:P.id}}),this._layers[P.id]=P,this._serializedLayers[P.id]=P.serialize()}this.dispatcher.broadcast("setLayers",this._serializeLayers(this._order)),this.light=new Nt(this.stylesheet.light),this.fire(new a.Event("data",{dataType:"style"})),this.fire(new a.Event("style.load"))}},s.prototype._loadSprite=function(o){var c=this;this._spriteRequest=function(_,w,S){var z,P,O,G=a.browser.devicePixelRatio>1?"@2x":"",K=a.getJSON(w.transformRequest(w.normalizeSpriteURL(_,G,".json"),a.ResourceType.SpriteJSON),function(te,ue){K=null,O||(O=te,z=ue,re())}),X=a.getImage(w.transformRequest(w.normalizeSpriteURL(_,G,".png"),a.ResourceType.SpriteImage),function(te,ue){X=null,O||(O=te,P=ue,re())});function re(){if(O)S(O);else if(z&&P){var te=a.browser.getImageData(P),ue={};for(var Y in z){var le=z[Y],pe=le.width,ve=le.height,Ie=le.x,Ee=le.y,Ae=le.sdf,Re=le.pixelRatio,Ke=le.stretchX,Ze=le.stretchY,ot=le.content,wt=new a.RGBAImage({width:pe,height:ve});a.RGBAImage.copy(te,wt,{x:Ie,y:Ee},{x:0,y:0},{width:pe,height:ve}),ue[Y]={data:wt,pixelRatio:Re,sdf:Ae,stretchX:Ke,stretchY:Ze,content:ot}}S(null,ue)}}return{cancel:function(){K&&(K.cancel(),K=null),X&&(X.cancel(),X=null)}}}(o,this.map._requestManager,function(_,w){if(c._spriteRequest=null,_)c.fire(new a.ErrorEvent(_));else if(w)for(var S in w)c.imageManager.addImage(S,w[S]);c.imageManager.setLoaded(!0),c._availableImages=c.imageManager.listImages(),c.dispatcher.broadcast("setImages",c._availableImages),c.fire(new a.Event("data",{dataType:"style"}))})},s.prototype._validateLayer=function(o){var c=this.sourceCaches[o.source];if(c){var _=o.sourceLayer;if(_){var w=c.getSource();(w.type==="geojson"||w.vectorLayerIds&&w.vectorLayerIds.indexOf(_)===-1)&&this.fire(new a.ErrorEvent(new Error('Source layer "'+_+'" does not exist on source "'+w.id+'" as specified by style layer "'+o.id+'"')))}}},s.prototype.loaded=function(){if(!this._loaded||Object.keys(this._updatedSources).length)return!1;for(var o in this.sourceCaches)if(!this.sourceCaches[o].loaded())return!1;return!!this.imageManager.isLoaded()},s.prototype._serializeLayers=function(o){for(var c=[],_=0,w=o;_<w.length;_+=1){var S=this._layers[w[_]];S.type!=="custom"&&c.push(S.serialize())}return c},s.prototype.hasTransitions=function(){if(this.light&&this.light.hasTransition())return!0;for(var o in this.sourceCaches)if(this.sourceCaches[o].hasTransition())return!0;for(var c in this._layers)if(this._layers[c].hasTransition())return!0;return!1},s.prototype._checkLoaded=function(){if(!this._loaded)throw new Error("Style is not done loading")},s.prototype.update=function(o){if(this._loaded){var c=this._changed;if(this._changed){var _=Object.keys(this._updatedLayers),w=Object.keys(this._removedLayers);for(var S in(_.length||w.length)&&this._updateWorkerLayers(_,w),this._updatedSources){var z=this._updatedSources[S];z==="reload"?this._reloadSource(S):z==="clear"&&this._clearSource(S)}for(var P in this._updateTilesForChangedImages(),this._updatedPaintProps)this._layers[P].updateTransitions(o);this.light.updateTransitions(o),this._resetUpdates()}var O={};for(var G in this.sourceCaches){var K=this.sourceCaches[G];O[G]=K.used,K.used=!1}for(var X=0,re=this._order;X<re.length;X+=1){var te=this._layers[re[X]];te.recalculate(o,this._availableImages),!te.isHidden(o.zoom)&&te.source&&(this.sourceCaches[te.source].used=!0)}for(var ue in O){var Y=this.sourceCaches[ue];O[ue]!==Y.used&&Y.fire(new a.Event("data",{sourceDataType:"visibility",dataType:"source",sourceId:ue}))}this.light.recalculate(o),this.z=o.zoom,c&&this.fire(new a.Event("data",{dataType:"style"}))}},s.prototype._updateTilesForChangedImages=function(){var o=Object.keys(this._changedImages);if(o.length){for(var c in this.sourceCaches)this.sourceCaches[c].reloadTilesForDependencies(["icons","patterns"],o);this._changedImages={}}},s.prototype._updateWorkerLayers=function(o,c){this.dispatcher.broadcast("updateLayers",{layers:this._serializeLayers(o),removedIds:c})},s.prototype._resetUpdates=function(){this._changed=!1,this._updatedLayers={},this._removedLayers={},this._updatedSources={},this._updatedPaintProps={},this._changedImages={}},s.prototype.setState=function(o){var c=this;if(this._checkLoaded(),hn(this,a.validateStyle(o)))return!1;(o=a.clone$1(o)).layers=Oe(o.layers);var _=function(S,z){if(!S)return[{command:qe.setStyle,args:[z]}];var P=[];try{if(!a.deepEqual(S.version,z.version))return[{command:qe.setStyle,args:[z]}];a.deepEqual(S.center,z.center)||P.push({command:qe.setCenter,args:[z.center]}),a.deepEqual(S.zoom,z.zoom)||P.push({command:qe.setZoom,args:[z.zoom]}),a.deepEqual(S.bearing,z.bearing)||P.push({command:qe.setBearing,args:[z.bearing]}),a.deepEqual(S.pitch,z.pitch)||P.push({command:qe.setPitch,args:[z.pitch]}),a.deepEqual(S.sprite,z.sprite)||P.push({command:qe.setSprite,args:[z.sprite]}),a.deepEqual(S.glyphs,z.glyphs)||P.push({command:qe.setGlyphs,args:[z.glyphs]}),a.deepEqual(S.transition,z.transition)||P.push({command:qe.setTransition,args:[z.transition]}),a.deepEqual(S.light,z.light)||P.push({command:qe.setLight,args:[z.light]});var O={},G=[];(function(X,re,te,ue){var Y;for(Y in re=re||{},X=X||{})X.hasOwnProperty(Y)&&(re.hasOwnProperty(Y)||je(Y,te,ue));for(Y in re)re.hasOwnProperty(Y)&&(X.hasOwnProperty(Y)?a.deepEqual(X[Y],re[Y])||(X[Y].type==="geojson"&&re[Y].type==="geojson"&&lr(X,re,Y)?te.push({command:qe.setGeoJSONSourceData,args:[Y,re[Y].data]}):Vt(Y,re,te,ue)):Mt(Y,re,te))})(S.sources,z.sources,G,O);var K=[];S.layers&&S.layers.forEach(function(X){O[X.source]?P.push({command:qe.removeLayer,args:[X.id]}):K.push(X)}),P=P.concat(G),function(X,re,te){re=re||[];var ue,Y,le,pe,ve,Ie,Ee,Ae=(X=X||[]).map(nr),Re=re.map(nr),Ke=X.reduce(Jt,{}),Ze=re.reduce(Jt,{}),ot=Ae.slice(),wt=Object.create(null);for(ue=0,Y=0;ue<Ae.length;ue++)Ze.hasOwnProperty(le=Ae[ue])?Y++:(te.push({command:qe.removeLayer,args:[le]}),ot.splice(ot.indexOf(le,Y),1));for(ue=0,Y=0;ue<Re.length;ue++)ot[ot.length-1-ue]!==(le=Re[Re.length-1-ue])&&(Ke.hasOwnProperty(le)?(te.push({command:qe.removeLayer,args:[le]}),ot.splice(ot.lastIndexOf(le,ot.length-Y),1)):Y++,te.push({command:qe.addLayer,args:[Ze[le],Ie=ot[ot.length-ue]]}),ot.splice(ot.length-ue,0,le),wt[le]=!0);for(ue=0;ue<Re.length;ue++)if(pe=Ke[le=Re[ue]],ve=Ze[le],!wt[le]&&!a.deepEqual(pe,ve))if(a.deepEqual(pe.source,ve.source)&&a.deepEqual(pe["source-layer"],ve["source-layer"])&&a.deepEqual(pe.type,ve.type)){for(Ee in Dt(pe.layout,ve.layout,te,le,null,qe.setLayoutProperty),Dt(pe.paint,ve.paint,te,le,null,qe.setPaintProperty),a.deepEqual(pe.filter,ve.filter)||te.push({command:qe.setFilter,args:[le,ve.filter]}),a.deepEqual(pe.minzoom,ve.minzoom)&&a.deepEqual(pe.maxzoom,ve.maxzoom)||te.push({command:qe.setLayerZoomRange,args:[le,ve.minzoom,ve.maxzoom]}),pe)pe.hasOwnProperty(Ee)&&Ee!=="layout"&&Ee!=="paint"&&Ee!=="filter"&&Ee!=="metadata"&&Ee!=="minzoom"&&Ee!=="maxzoom"&&(Ee.indexOf("paint.")===0?Dt(pe[Ee],ve[Ee],te,le,Ee.slice(6),qe.setPaintProperty):a.deepEqual(pe[Ee],ve[Ee])||te.push({command:qe.setLayerProperty,args:[le,Ee,ve[Ee]]}));for(Ee in ve)ve.hasOwnProperty(Ee)&&!pe.hasOwnProperty(Ee)&&Ee!=="layout"&&Ee!=="paint"&&Ee!=="filter"&&Ee!=="metadata"&&Ee!=="minzoom"&&Ee!=="maxzoom"&&(Ee.indexOf("paint.")===0?Dt(pe[Ee],ve[Ee],te,le,Ee.slice(6),qe.setPaintProperty):a.deepEqual(pe[Ee],ve[Ee])||te.push({command:qe.setLayerProperty,args:[le,Ee,ve[Ee]]}))}else te.push({command:qe.removeLayer,args:[le]}),Ie=ot[ot.lastIndexOf(le)+1],te.push({command:qe.addLayer,args:[ve,Ie]})}(K,z.layers,P)}catch(X){console.warn("Unable to compute style diff:",X),P=[{command:qe.setStyle,args:[z]}]}return P}(this.serialize(),o).filter(function(S){return!(S.command in Wr)});if(_.length===0)return!1;var w=_.filter(function(S){return!(S.command in Gi)});if(w.length>0)throw new Error("Unimplemented: "+w.map(function(S){return S.command}).join(", ")+".");return _.forEach(function(S){S.command!=="setTransition"&&c[S.command].apply(c,S.args)}),this.stylesheet=o,!0},s.prototype.addImage=function(o,c){if(this.getImage(o))return this.fire(new a.ErrorEvent(new Error("An image with this name already exists.")));this.imageManager.addImage(o,c),this._afterImageUpdated(o)},s.prototype.updateImage=function(o,c){this.imageManager.updateImage(o,c)},s.prototype.getImage=function(o){return this.imageManager.getImage(o)},s.prototype.removeImage=function(o){if(!this.getImage(o))return this.fire(new a.ErrorEvent(new Error("No image with this name exists.")));this.imageManager.removeImage(o),this._afterImageUpdated(o)},s.prototype._afterImageUpdated=function(o){this._availableImages=this.imageManager.listImages(),this._changedImages[o]=!0,this._changed=!0,this.dispatcher.broadcast("setImages",this._availableImages),this.fire(new a.Event("data",{dataType:"style"}))},s.prototype.listImages=function(){return this._checkLoaded(),this.imageManager.listImages()},s.prototype.addSource=function(o,c,_){var w=this;if(_===void 0&&(_={}),this._checkLoaded(),this.sourceCaches[o]!==void 0)throw new Error("There is already a source with this ID");if(!c.type)throw new Error("The type property must be defined, but only the following properties were given: "+Object.keys(c).join(", ")+".");if(!(["vector","raster","geojson","video","image"].indexOf(c.type)>=0&&this._validate(a.validateStyle.source,"sources."+o,c,null,_))){this.map&&this.map._collectResourceTiming&&(c.collectResourceTiming=!0);var S=this.sourceCaches[o]=new J(o,c,this.dispatcher);S.style=this,S.setEventedParent(this,function(){return{isSourceLoaded:w.loaded(),source:S.serialize(),sourceId:o}}),S.onAdd(this.map),this._changed=!0}},s.prototype.removeSource=function(o){if(this._checkLoaded(),this.sourceCaches[o]===void 0)throw new Error("There is no source with this ID");for(var c in this._layers)if(this._layers[c].source===o)return this.fire(new a.ErrorEvent(new Error('Source "'+o+'" cannot be removed while layer "'+c+'" is using it.')));var _=this.sourceCaches[o];delete this.sourceCaches[o],delete this._updatedSources[o],_.fire(new a.Event("data",{sourceDataType:"metadata",dataType:"source",sourceId:o})),_.setEventedParent(null),_.clearTiles(),_.onRemove&&_.onRemove(this.map),this._changed=!0},s.prototype.setGeoJSONSourceData=function(o,c){this._checkLoaded(),this.sourceCaches[o].getSource().setData(c),this._changed=!0},s.prototype.getSource=function(o){return this.sourceCaches[o]&&this.sourceCaches[o].getSource()},s.prototype.addLayer=function(o,c,_){_===void 0&&(_={}),this._checkLoaded();var w=o.id;if(this.getLayer(w))this.fire(new a.ErrorEvent(new Error('Layer with id "'+w+'" already exists on this map')));else{var S;if(o.type==="custom"){if(hn(this,a.validateCustomStyleLayer(o)))return;S=a.createStyleLayer(o)}else{if(typeof o.source=="object"&&(this.addSource(w,o.source),o=a.clone$1(o),o=a.extend(o,{source:w})),this._validate(a.validateStyle.layer,"layers."+w,o,{arrayIndex:-1},_))return;S=a.createStyleLayer(o),this._validateLayer(S),S.setEventedParent(this,{layer:{id:w}}),this._serializedLayers[S.id]=S.serialize()}var z=c?this._order.indexOf(c):this._order.length;if(c&&z===-1)this.fire(new a.ErrorEvent(new Error('Layer with id "'+c+'" does not exist on this map.')));else{if(this._order.splice(z,0,w),this._layerOrderChanged=!0,this._layers[w]=S,this._removedLayers[w]&&S.source&&S.type!=="custom"){var P=this._removedLayers[w];delete this._removedLayers[w],P.type!==S.type?this._updatedSources[S.source]="clear":(this._updatedSources[S.source]="reload",this.sourceCaches[S.source].pause())}this._updateLayer(S),S.onAdd&&S.onAdd(this.map)}}},s.prototype.moveLayer=function(o,c){if(this._checkLoaded(),this._changed=!0,this._layers[o]){if(o!==c){var _=this._order.indexOf(o);this._order.splice(_,1);var w=c?this._order.indexOf(c):this._order.length;c&&w===-1?this.fire(new a.ErrorEvent(new Error('Layer with id "'+c+'" does not exist on this map.'))):(this._order.splice(w,0,o),this._layerOrderChanged=!0)}}else this.fire(new a.ErrorEvent(new Error("The layer '"+o+"' does not exist in the map's style and cannot be moved.")))},s.prototype.removeLayer=function(o){this._checkLoaded();var c=this._layers[o];if(c){c.setEventedParent(null);var _=this._order.indexOf(o);this._order.splice(_,1),this._layerOrderChanged=!0,this._changed=!0,this._removedLayers[o]=c,delete this._layers[o],delete this._serializedLayers[o],delete this._updatedLayers[o],delete this._updatedPaintProps[o],c.onRemove&&c.onRemove(this.map)}else this.fire(new a.ErrorEvent(new Error("The layer '"+o+"' does not exist in the map's style and cannot be removed.")))},s.prototype.getLayer=function(o){return this._layers[o]},s.prototype.hasLayer=function(o){return o in this._layers},s.prototype.setLayerZoomRange=function(o,c,_){this._checkLoaded();var w=this.getLayer(o);w?w.minzoom===c&&w.maxzoom===_||(c!=null&&(w.minzoom=c),_!=null&&(w.maxzoom=_),this._updateLayer(w)):this.fire(new a.ErrorEvent(new Error("The layer '"+o+"' does not exist in the map's style and cannot have zoom extent.")))},s.prototype.setFilter=function(o,c,_){_===void 0&&(_={}),this._checkLoaded();var w=this.getLayer(o);if(w){if(!a.deepEqual(w.filter,c))return c==null?(w.filter=void 0,void this._updateLayer(w)):void(this._validate(a.validateStyle.filter,"layers."+w.id+".filter",c,null,_)||(w.filter=a.clone$1(c),this._updateLayer(w)))}else this.fire(new a.ErrorEvent(new Error("The layer '"+o+"' does not exist in the map's style and cannot be filtered.")))},s.prototype.getFilter=function(o){return a.clone$1(this.getLayer(o).filter)},s.prototype.setLayoutProperty=function(o,c,_,w){w===void 0&&(w={}),this._checkLoaded();var S=this.getLayer(o);S?a.deepEqual(S.getLayoutProperty(c),_)||(S.setLayoutProperty(c,_,w),this._updateLayer(S)):this.fire(new a.ErrorEvent(new Error("The layer '"+o+"' does not exist in the map's style and cannot be styled.")))},s.prototype.getLayoutProperty=function(o,c){var _=this.getLayer(o);if(_)return _.getLayoutProperty(c);this.fire(new a.ErrorEvent(new Error("The layer '"+o+"' does not exist in the map's style.")))},s.prototype.setPaintProperty=function(o,c,_,w){w===void 0&&(w={}),this._checkLoaded();var S=this.getLayer(o);S?a.deepEqual(S.getPaintProperty(c),_)||(S.setPaintProperty(c,_,w)&&this._updateLayer(S),this._changed=!0,this._updatedPaintProps[o]=!0):this.fire(new a.ErrorEvent(new Error("The layer '"+o+"' does not exist in the map's style and cannot be styled.")))},s.prototype.getPaintProperty=function(o,c){return this.getLayer(o).getPaintProperty(c)},s.prototype.setFeatureState=function(o,c){this._checkLoaded();var _=o.source,w=o.sourceLayer,S=this.sourceCaches[_];if(S!==void 0){var z=S.getSource().type;z==="geojson"&&w?this.fire(new a.ErrorEvent(new Error("GeoJSON sources cannot have a sourceLayer parameter."))):z!=="vector"||w?(o.id===void 0&&this.fire(new a.ErrorEvent(new Error("The feature id parameter must be provided."))),S.setFeatureState(w,o.id,c)):this.fire(new a.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")))}else this.fire(new a.ErrorEvent(new Error("The source '"+_+"' does not exist in the map's style.")))},s.prototype.removeFeatureState=function(o,c){this._checkLoaded();var _=o.source,w=this.sourceCaches[_];if(w!==void 0){var S=w.getSource().type,z=S==="vector"?o.sourceLayer:void 0;S!=="vector"||z?c&&typeof o.id!="string"&&typeof o.id!="number"?this.fire(new a.ErrorEvent(new Error("A feature id is required to remove its specific state property."))):w.removeFeatureState(z,o.id,c):this.fire(new a.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")))}else this.fire(new a.ErrorEvent(new Error("The source '"+_+"' does not exist in the map's style.")))},s.prototype.getFeatureState=function(o){this._checkLoaded();var c=o.source,_=o.sourceLayer,w=this.sourceCaches[c];if(w!==void 0){if(w.getSource().type!=="vector"||_)return o.id===void 0&&this.fire(new a.ErrorEvent(new Error("The feature id parameter must be provided."))),w.getFeatureState(_,o.id);this.fire(new a.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")))}else this.fire(new a.ErrorEvent(new Error("The source '"+c+"' does not exist in the map's style.")))},s.prototype.getTransition=function(){return a.extend({duration:300,delay:0},this.stylesheet&&this.stylesheet.transition)},s.prototype.serialize=function(){return a.filterObject({version:this.stylesheet.version,name:this.stylesheet.name,metadata:this.stylesheet.metadata,light:this.stylesheet.light,center:this.stylesheet.center,zoom:this.stylesheet.zoom,bearing:this.stylesheet.bearing,pitch:this.stylesheet.pitch,sprite:this.stylesheet.sprite,glyphs:this.stylesheet.glyphs,transition:this.stylesheet.transition,sources:a.mapObject(this.sourceCaches,function(o){return o.serialize()}),layers:this._serializeLayers(this._order)},function(o){return o!==void 0})},s.prototype._updateLayer=function(o){this._updatedLayers[o.id]=!0,o.source&&!this._updatedSources[o.source]&&this.sourceCaches[o.source].getSource().type!=="raster"&&(this._updatedSources[o.source]="reload",this.sourceCaches[o.source].pause()),this._changed=!0},s.prototype._flattenAndSortRenderedFeatures=function(o){for(var c=this,_=function(Ke){return c._layers[Ke].type==="fill-extrusion"},w={},S=[],z=this._order.length-1;z>=0;z--){var P=this._order[z];if(_(P)){w[P]=z;for(var O=0,G=o;O<G.length;O+=1){var K=G[O][P];if(K)for(var X=0,re=K;X<re.length;X+=1)S.push(re[X])}}}S.sort(function(Ke,Ze){return Ze.intersectionZ-Ke.intersectionZ});for(var te=[],ue=this._order.length-1;ue>=0;ue--){var Y=this._order[ue];if(_(Y))for(var le=S.length-1;le>=0;le--){var pe=S[le].feature;if(w[pe.layer.id]<ue)break;te.push(pe),S.pop()}else for(var ve=0,Ie=o;ve<Ie.length;ve+=1){var Ee=Ie[ve][Y];if(Ee)for(var Ae=0,Re=Ee;Ae<Re.length;Ae+=1)te.push(Re[Ae].feature)}}return te},s.prototype.queryRenderedFeatures=function(o,c,_){c&&c.filter&&this._validate(a.validateStyle.filter,"queryRenderedFeatures.filter",c.filter,null,c);var w={};if(c&&c.layers){if(!Array.isArray(c.layers))return this.fire(new a.ErrorEvent(new Error("parameters.layers must be an Array."))),[];for(var S=0,z=c.layers;S<z.length;S+=1){var P=z[S],O=this._layers[P];if(!O)return this.fire(new a.ErrorEvent(new Error("The layer '"+P+"' does not exist in the map's style and cannot be queried for features."))),[];w[O.source]=!0}}var G=[];for(var K in c.availableImages=this._availableImages,this.sourceCaches)c.layers&&!w[K]||G.push(sr(this.sourceCaches[K],this._layers,this._serializedLayers,o,c,_));return this.placement&&G.push(function(X,re,te,ue,Y,le,pe){for(var ve={},Ie=le.queryRenderedSymbols(ue),Ee=[],Ae=0,Re=Object.keys(Ie).map(Number);Ae<Re.length;Ae+=1)Ee.push(pe[Re[Ae]]);Ee.sort(ti);for(var Ke=function(){var Et=ot[Ze],_r=Et.featureIndex.lookupSymbolFeatures(Ie[Et.bucketInstanceId],re,Et.bucketIndex,Et.sourceLayerIndex,Y.filter,Y.layers,Y.availableImages,X);for(var lt in _r){var Ut=ve[lt]=ve[lt]||[],Yt=_r[lt];Yt.sort(function(Ht,Bt){var Lt=Et.featureSortOrder;if(Lt){var Li=Lt.indexOf(Ht.featureIndex);return Lt.indexOf(Bt.featureIndex)-Li}return Bt.featureIndex-Ht.featureIndex});for(var Ft=0,Ot=Yt;Ft<Ot.length;Ft+=1)Ut.push(Ot[Ft])}},Ze=0,ot=Ee;Ze<ot.length;Ze+=1)Ke();var wt=function(Et){ve[Et].forEach(function(_r){var lt=_r.feature,Ut=te[X[Et].source].getFeatureState(lt.layer["source-layer"],lt.id);lt.source=lt.layer.source,lt.layer["source-layer"]&&(lt.sourceLayer=lt.layer["source-layer"]),lt.state=Ut})};for(var Tt in ve)wt(Tt);return ve}(this._layers,this._serializedLayers,this.sourceCaches,o,c,this.placement.collisionIndex,this.placement.retainedQueryData)),this._flattenAndSortRenderedFeatures(G)},s.prototype.querySourceFeatures=function(o,c){c&&c.filter&&this._validate(a.validateStyle.filter,"querySourceFeatures.filter",c.filter,null,c);var _=this.sourceCaches[o];return _?function(w,S){for(var z=w.getRenderableIds().map(function(re){return w.getTileByID(re)}),P=[],O={},G=0;G<z.length;G++){var K=z[G],X=K.tileID.canonical.key;O[X]||(O[X]=!0,K.querySourceFeatures(P,S))}return P}(_,c):[]},s.prototype.addSourceType=function(o,c,_){return s.getSourceType(o)?_(new Error('A source type called "'+o+'" already exists.')):(s.setSourceType(o,c),c.workerSourceURL?void this.dispatcher.broadcast("loadWorkerSource",{name:o,url:c.workerSourceURL},_):_(null,null))},s.prototype.getLight=function(){return this.light.getLight()},s.prototype.setLight=function(o,c){c===void 0&&(c={}),this._checkLoaded();var _=this.light.getLight(),w=!1;for(var S in o)if(!a.deepEqual(o[S],_[S])){w=!0;break}if(w){var z={now:a.browser.now(),transition:a.extend({duration:300,delay:0},this.stylesheet.transition)};this.light.setLight(o,c),this.light.updateTransitions(z)}},s.prototype._validate=function(o,c,_,w,S){return S===void 0&&(S={}),(!S||S.validate!==!1)&&hn(this,o.call(a.validateStyle,a.extend({key:c,style:this.serialize(),value:_,styleSpec:a.styleSpec},w)))},s.prototype._remove=function(){for(var o in this._request&&(this._request.cancel(),this._request=null),this._spriteRequest&&(this._spriteRequest.cancel(),this._spriteRequest=null),a.evented.off("pluginStateChange",this._rtlTextPluginCallback),this._layers)this._layers[o].setEventedParent(null);for(var c in this.sourceCaches)this.sourceCaches[c].clearTiles(),this.sourceCaches[c].setEventedParent(null);this.imageManager.setEventedParent(null),this.setEventedParent(null),this.dispatcher.remove()},s.prototype._clearSource=function(o){this.sourceCaches[o].clearTiles()},s.prototype._reloadSource=function(o){this.sourceCaches[o].resume(),this.sourceCaches[o].reload()},s.prototype._updateSources=function(o){for(var c in this.sourceCaches)this.sourceCaches[c].update(o)},s.prototype._generateCollisionBoxes=function(){for(var o in this.sourceCaches)this._reloadSource(o)},s.prototype._updatePlacement=function(o,c,_,w,S){S===void 0&&(S=!1);for(var z=!1,P=!1,O={},G=0,K=this._order;G<K.length;G+=1){var X=this._layers[K[G]];if(X.type==="symbol"){if(!O[X.source]){var re=this.sourceCaches[X.source];O[X.source]=re.getRenderableIds(!0).map(function(pe){return re.getTileByID(pe)}).sort(function(pe,ve){return ve.tileID.overscaledZ-pe.tileID.overscaledZ||(pe.tileID.isLessThan(ve.tileID)?-1:1)})}var te=this.crossTileSymbolIndex.addLayer(X,O[X.source],o.center.lng);z=z||te}}if(this.crossTileSymbolIndex.pruneUnusedLayers(this._order),((S=S||this._layerOrderChanged||_===0)||!this.pauseablePlacement||this.pauseablePlacement.isDone()&&!this.placement.stillRecent(a.browser.now(),o.zoom))&&(this.pauseablePlacement=new ho(o,this._order,S,c,_,w,this.placement),this._layerOrderChanged=!1),this.pauseablePlacement.isDone()?this.placement.setStale():(this.pauseablePlacement.continuePlacement(this._order,this._layers,O),this.pauseablePlacement.isDone()&&(this.placement=this.pauseablePlacement.commit(a.browser.now()),P=!0),z&&this.pauseablePlacement.placement.setStale()),P||z)for(var ue=0,Y=this._order;ue<Y.length;ue+=1){var le=this._layers[Y[ue]];le.type==="symbol"&&this.placement.updateLayerOpacities(le,O[le.source])}return!this.pauseablePlacement.isDone()||this.placement.hasTransitions(a.browser.now())},s.prototype._releaseSymbolFadeTiles=function(){for(var o in this.sourceCaches)this.sourceCaches[o].releaseSymbolFadeTiles()},s.prototype.getImages=function(o,c,_){this.imageManager.getImages(c.icons,_),this._updateTilesForChangedImages();var w=this.sourceCaches[c.source];w&&w.setDependencies(c.tileID.key,c.type,c.icons)},s.prototype.getGlyphs=function(o,c,_){this.glyphManager.getGlyphs(c.stacks,_)},s.prototype.getResource=function(o,c,_){return a.makeRequest(c,_)},s}(a.Evented);jn.getSourceType=function(n){return xr[n]},jn.setSourceType=function(n,s){xr[n]=s},jn.registerForPluginStateChange=a.registerForPluginStateChange;var xi=a.createLayout([{name:"a_pos",type:"Int16",components:2}]),Fo=Or(`#ifdef GL_ES
precision mediump float;
#else
#if !defined(lowp)
#define lowp
#endif
#if !defined(mediump)
#define mediump
#endif
#if !defined(highp)
#define highp
#endif
#endif`,`#ifdef GL_ES
precision highp float;
#else
#if !defined(lowp)
#define lowp
#endif
#if !defined(mediump)
#define mediump
#endif
#if !defined(highp)
#define highp
#endif
#endif
vec2 unpack_float(const float packedValue) {int packedIntValue=int(packedValue);int v0=packedIntValue/256;return vec2(v0,packedIntValue-v0*256);}vec2 unpack_opacity(const float packedOpacity) {int intOpacity=int(packedOpacity)/2;return vec2(float(intOpacity)/127.0,mod(packedOpacity,2.0));}vec4 decode_color(const vec2 encodedColor) {return vec4(unpack_float(encodedColor[0])/255.0,unpack_float(encodedColor[1])/255.0
);}float unpack_mix_vec2(const vec2 packedValue,const float t) {return mix(packedValue[0],packedValue[1],t);}vec4 unpack_mix_color(const vec4 packedColors,const float t) {vec4 minColor=decode_color(vec2(packedColors[0],packedColors[1]));vec4 maxColor=decode_color(vec2(packedColors[2],packedColors[3]));return mix(minColor,maxColor,t);}vec2 get_pattern_pos(const vec2 pixel_coord_upper,const vec2 pixel_coord_lower,const vec2 pattern_size,const float tile_units_to_pixels,const vec2 pos) {vec2 offset=mod(mod(mod(pixel_coord_upper,pattern_size)*256.0,pattern_size)*256.0+pixel_coord_lower,pattern_size);return (tile_units_to_pixels*pos+offset)/pattern_size;}`),nc=Or(`uniform vec4 u_color;uniform float u_opacity;void main() {gl_FragColor=u_color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),Uh=Or(`uniform vec2 u_pattern_tl_a;uniform vec2 u_pattern_br_a;uniform vec2 u_pattern_tl_b;uniform vec2 u_pattern_br_b;uniform vec2 u_texsize;uniform float u_mix;uniform float u_opacity;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;void main() {vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(u_pattern_tl_a/u_texsize,u_pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(u_pattern_tl_b/u_texsize,u_pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);gl_FragColor=mix(color1,color2,u_mix)*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_pattern_size_a;uniform vec2 u_pattern_size_b;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_scale_a;uniform float u_scale_b;uniform float u_tile_units_to_pixels;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_a*u_pattern_size_a,u_tile_units_to_pixels,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_b*u_pattern_size_b,u_tile_units_to_pixels,a_pos);}"),Vh=Or(`varying vec3 v_data;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=v_data.xy;float extrude_length=length(extrude);lowp float antialiasblur=v_data.z;float antialiased_blur=-max(blur,antialiasblur);float opacity_t=smoothstep(0.0,antialiased_blur,extrude_length-1.0);float color_t=stroke_width < 0.01 ? 0.0 : smoothstep(antialiased_blur,0.0,extrude_length-radius/(radius+stroke_width));gl_FragColor=opacity_t*mix(color*opacity,stroke_color*stroke_opacity,color_t);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform bool u_scale_with_map;uniform bool u_pitch_with_map;uniform vec2 u_extrude_scale;uniform lowp float u_device_pixel_ratio;uniform highp float u_camera_to_center_distance;attribute vec2 a_pos;varying vec3 v_data;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
void main(void) {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=vec2(mod(a_pos,2.0)*2.0-1.0);vec2 circle_center=floor(a_pos*0.5);if (u_pitch_with_map) {vec2 corner_position=circle_center;if (u_scale_with_map) {corner_position+=extrude*(radius+stroke_width)*u_extrude_scale;} else {vec4 projected_center=u_matrix*vec4(circle_center,0,1);corner_position+=extrude*(radius+stroke_width)*u_extrude_scale*(projected_center.w/u_camera_to_center_distance);}gl_Position=u_matrix*vec4(corner_position,0,1);} else {gl_Position=u_matrix*vec4(circle_center,0,1);if (u_scale_with_map) {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*u_camera_to_center_distance;} else {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*gl_Position.w;}}lowp float antialiasblur=1.0/u_device_pixel_ratio/(radius+stroke_width);v_data=vec3(extrude.x,extrude.y,antialiasblur);}`),jl=Or("void main() {gl_FragColor=vec4(1.0);}","attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),ql=Or(`uniform highp float u_intensity;varying vec2 v_extrude;
#pragma mapbox: define highp float weight
#define GAUSS_COEF 0.3989422804014327
void main() {
#pragma mapbox: initialize highp float weight
float d=-0.5*3.0*3.0*dot(v_extrude,v_extrude);float val=weight*u_intensity*GAUSS_COEF*exp(d);gl_FragColor=vec4(val,1.0,1.0,1.0);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform float u_extrude_scale;uniform float u_opacity;uniform float u_intensity;attribute vec2 a_pos;varying vec2 v_extrude;
#pragma mapbox: define highp float weight
#pragma mapbox: define mediump float radius
const highp float ZERO=1.0/255.0/16.0;
#define GAUSS_COEF 0.3989422804014327
void main(void) {
#pragma mapbox: initialize highp float weight
#pragma mapbox: initialize mediump float radius
vec2 unscaled_extrude=vec2(mod(a_pos,2.0)*2.0-1.0);float S=sqrt(-2.0*log(ZERO/weight/u_intensity/GAUSS_COEF))/3.0;v_extrude=S*unscaled_extrude;vec2 extrude=v_extrude*radius*u_extrude_scale;vec4 pos=vec4(floor(a_pos*0.5)+extrude,0,1);gl_Position=u_matrix*pos;}`),Zl=Or(`uniform sampler2D u_image;uniform sampler2D u_color_ramp;uniform float u_opacity;varying vec2 v_pos;void main() {float t=texture2D(u_image,v_pos).r;vec4 color=texture2D(u_color_ramp,vec2(t,0.5));gl_FragColor=color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(0.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_world;attribute vec2 a_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos*u_world,0,1);v_pos.x=a_pos.x;v_pos.y=1.0-a_pos.y;}"),Gl=Or("varying float v_placed;varying float v_notUsed;void main() {float alpha=0.5;gl_FragColor=vec4(1.0,0.0,0.0,1.0)*alpha;if (v_placed > 0.5) {gl_FragColor=vec4(0.0,0.0,1.0,0.5)*alpha;}if (v_notUsed > 0.5) {gl_FragColor*=.1;}}","attribute vec2 a_pos;attribute vec2 a_anchor_pos;attribute vec2 a_extrude;attribute vec2 a_placed;attribute vec2 a_shift;uniform mat4 u_matrix;uniform vec2 u_extrude_scale;uniform float u_camera_to_center_distance;varying float v_placed;varying float v_notUsed;void main() {vec4 projectedPoint=u_matrix*vec4(a_anchor_pos,0,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float collision_perspective_ratio=clamp(0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,4.0);gl_Position=u_matrix*vec4(a_pos,0.0,1.0);gl_Position.xy+=(a_extrude+a_shift)*u_extrude_scale*gl_Position.w*collision_perspective_ratio;v_placed=a_placed.x;v_notUsed=a_placed.y;}"),ac=Or("varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;void main() {float alpha=0.5*min(v_perspective_ratio,1.0);float stroke_radius=0.9*max(v_perspective_ratio,1.0);float distance_to_center=length(v_extrude);float distance_to_edge=abs(distance_to_center-v_radius);float opacity_t=smoothstep(-stroke_radius,0.0,-distance_to_edge);vec4 color=mix(vec4(0.0,0.0,1.0,0.5),vec4(1.0,0.0,0.0,1.0),v_collision);gl_FragColor=color*alpha*opacity_t;}","attribute vec2 a_pos;attribute float a_radius;attribute vec2 a_flags;uniform mat4 u_matrix;uniform mat4 u_inv_matrix;uniform vec2 u_viewport_size;uniform float u_camera_to_center_distance;varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;vec3 toTilePosition(vec2 screenPos) {vec4 rayStart=u_inv_matrix*vec4(screenPos,-1.0,1.0);vec4 rayEnd  =u_inv_matrix*vec4(screenPos, 1.0,1.0);rayStart.xyz/=rayStart.w;rayEnd.xyz  /=rayEnd.w;highp float t=(0.0-rayStart.z)/(rayEnd.z-rayStart.z);return mix(rayStart.xyz,rayEnd.xyz,t);}void main() {vec2 quadCenterPos=a_pos;float radius=a_radius;float collision=a_flags.x;float vertexIdx=a_flags.y;vec2 quadVertexOffset=vec2(mix(-1.0,1.0,float(vertexIdx >=2.0)),mix(-1.0,1.0,float(vertexIdx >=1.0 && vertexIdx <=2.0)));vec2 quadVertexExtent=quadVertexOffset*radius;vec3 tilePos=toTilePosition(quadCenterPos);vec4 clipPos=u_matrix*vec4(tilePos,1.0);highp float camera_to_anchor_distance=clipPos.w;highp float collision_perspective_ratio=clamp(0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,4.0);float padding_factor=1.2;v_radius=radius;v_extrude=quadVertexExtent*padding_factor;v_perspective_ratio=collision_perspective_ratio;v_collision=collision;gl_Position=vec4(clipPos.xyz/clipPos.w,1.0)+vec4(quadVertexExtent*padding_factor/u_viewport_size*2.0,0.0,0.0);}"),oc=Or("uniform highp vec4 u_color;uniform sampler2D u_overlay;varying vec2 v_uv;void main() {vec4 overlay_color=texture2D(u_overlay,v_uv);gl_FragColor=mix(u_color,overlay_color,overlay_color.a);}","attribute vec2 a_pos;varying vec2 v_uv;uniform mat4 u_matrix;uniform float u_overlay_scale;void main() {v_uv=a_pos/8192.0;gl_Position=u_matrix*vec4(a_pos*u_overlay_scale,0,1);}"),jh=Or(`#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
gl_FragColor=color*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec2 a_pos;uniform mat4 u_matrix;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
gl_Position=u_matrix*vec4(a_pos,0,1);}`),us=Or(`varying vec2 v_pos;
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);gl_FragColor=outline_color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec2 a_pos;uniform mat4 u_matrix;uniform vec2 u_world;varying vec2 v_pos;
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;}`),cs=Or(`uniform vec2 u_texsize;uniform sampler2D u_image;uniform float u_fade;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec2 v_pos;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);gl_FragColor=mix(color1,color2,u_fade)*alpha*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_world;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec2 v_pos;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;gl_Position=u_matrix*vec4(a_pos,0,1);vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,a_pos);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;}`),sc=Or(`uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);gl_FragColor=mix(color1,color2,u_fade)*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;gl_Position=u_matrix*vec4(a_pos,0,1);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileZoomRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileZoomRatio,a_pos);}`),rn=Or(`varying vec4 v_color;void main() {gl_FragColor=v_color;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;uniform float u_vertical_gradient;uniform lowp float u_opacity;attribute vec2 a_pos;attribute vec4 a_normal_ed;varying vec4 v_color;
#pragma mapbox: define highp float base
#pragma mapbox: define highp float height
#pragma mapbox: define highp vec4 color
void main() {
#pragma mapbox: initialize highp float base
#pragma mapbox: initialize highp float height
#pragma mapbox: initialize highp vec4 color
vec3 normal=a_normal_ed.xyz;base=max(0.0,base);height=max(0.0,height);float t=mod(normal.x,2.0);gl_Position=u_matrix*vec4(a_pos,t > 0.0 ? height : base,1);float colorvalue=color.r*0.2126+color.g*0.7152+color.b*0.0722;v_color=vec4(0.0,0.0,0.0,1.0);vec4 ambientlight=vec4(0.03,0.03,0.03,1.0);color+=ambientlight;float directional=clamp(dot(normal/16384.0,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_color.r+=clamp(color.r*directional*u_lightcolor.r,mix(0.0,0.3,1.0-u_lightcolor.r),1.0);v_color.g+=clamp(color.g*directional*u_lightcolor.g,mix(0.0,0.3,1.0-u_lightcolor.g),1.0);v_color.b+=clamp(color.b*directional*u_lightcolor.b,mix(0.0,0.3,1.0-u_lightcolor.b),1.0);v_color*=u_opacity;}`),Kl=Or(`uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec4 v_lighting;
#pragma mapbox: define lowp float base
#pragma mapbox: define lowp float height
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float base
#pragma mapbox: initialize lowp float height
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);vec4 mixedColor=mix(color1,color2,u_fade);gl_FragColor=mixedColor*v_lighting;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_height_factor;uniform vec3 u_scale;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;attribute vec2 a_pos;attribute vec4 a_normal_ed;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec4 v_lighting;
#pragma mapbox: define lowp float base
#pragma mapbox: define lowp float height
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float base
#pragma mapbox: initialize lowp float height
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec3 normal=a_normal_ed.xyz;float edgedistance=a_normal_ed.w;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;base=max(0.0,base);height=max(0.0,height);float t=mod(normal.x,2.0);float z=t > 0.0 ? height : base;gl_Position=u_matrix*vec4(a_pos,z,1);vec2 pos=normal.x==1.0 && normal.y==0.0 && normal.z==16384.0
? a_pos
: vec2(edgedistance,z*u_height_factor);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,pos);v_lighting=vec4(0.0,0.0,0.0,1.0);float directional=clamp(dot(normal/16383.0,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((0.5+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_lighting.rgb+=clamp(directional*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_lighting*=u_opacity;}`),qa=Or(`#ifdef GL_ES
precision highp float;
#endif
uniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_dimension;uniform float u_zoom;uniform vec4 u_unpack;float getElevation(vec2 coord,float bias) {vec4 data=texture2D(u_image,coord)*255.0;data.a=-1.0;return dot(data,u_unpack)/4.0;}void main() {vec2 epsilon=1.0/u_dimension;float a=getElevation(v_pos+vec2(-epsilon.x,-epsilon.y),0.0);float b=getElevation(v_pos+vec2(0,-epsilon.y),0.0);float c=getElevation(v_pos+vec2(epsilon.x,-epsilon.y),0.0);float d=getElevation(v_pos+vec2(-epsilon.x,0),0.0);float e=getElevation(v_pos,0.0);float f=getElevation(v_pos+vec2(epsilon.x,0),0.0);float g=getElevation(v_pos+vec2(-epsilon.x,epsilon.y),0.0);float h=getElevation(v_pos+vec2(0,epsilon.y),0.0);float i=getElevation(v_pos+vec2(epsilon.x,epsilon.y),0.0);float exaggerationFactor=u_zoom < 2.0 ? 0.4 : u_zoom < 4.5 ? 0.35 : 0.3;float exaggeration=u_zoom < 15.0 ? (u_zoom-15.0)*exaggerationFactor : 0.0;vec2 deriv=vec2((c+f+f+i)-(a+d+d+g),(g+h+h+i)-(a+b+b+c))/pow(2.0,exaggeration+(19.2562-u_zoom));gl_FragColor=clamp(vec4(deriv.x/2.0+0.5,deriv.y/2.0+0.5,1.0,1.0),0.0,1.0);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_dimension;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);highp vec2 epsilon=1.0/u_dimension;float scale=(u_dimension.x-2.0)/u_dimension.x;v_pos=(a_texture_pos/8192.0)*scale+epsilon;}"),Za=Or(`uniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_latrange;uniform vec2 u_light;uniform vec4 u_shadow;uniform vec4 u_highlight;uniform vec4 u_accent;
#define PI 3.141592653589793
void main() {vec4 pixel=texture2D(u_image,v_pos);vec2 deriv=((pixel.rg*2.0)-1.0);float scaleFactor=cos(radians((u_latrange[0]-u_latrange[1])*(1.0-v_pos.y)+u_latrange[1]));float slope=atan(1.25*length(deriv)/scaleFactor);float aspect=deriv.x !=0.0 ? atan(deriv.y,-deriv.x) : PI/2.0*(deriv.y > 0.0 ? 1.0 :-1.0);float intensity=u_light.x;float azimuth=u_light.y+PI;float base=1.875-intensity*1.75;float maxValue=0.5*PI;float scaledSlope=intensity !=0.5 ? ((pow(base,slope)-1.0)/(pow(base,maxValue)-1.0))*maxValue : slope;float accent=cos(scaledSlope);vec4 accent_color=(1.0-accent)*u_accent*clamp(intensity*2.0,0.0,1.0);float shade=abs(mod((aspect+azimuth)/PI+0.5,2.0)-1.0);vec4 shade_color=mix(u_shadow,u_highlight,shade)*sin(scaledSlope)*clamp(intensity*2.0,0.0,1.0);gl_FragColor=accent_color*(1.0-shade_color.a)+shade_color;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=a_texture_pos/8192.0;}"),po=Or(`uniform lowp float u_device_pixel_ratio;varying vec2 v_width2;varying vec2 v_normal;varying float v_gamma_scale;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);gl_FragColor=color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
attribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform vec2 u_units_to_pixels;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_gamma_scale;varying highp float v_linesofar;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;v_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*2.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;v_width2=vec2(outset,inset);}`),fo=Or(`uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;varying vec2 v_width2;varying vec2 v_normal;varying float v_gamma_scale;varying highp vec2 v_uv;
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);vec4 color=texture2D(u_image,v_uv);gl_FragColor=color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
attribute vec2 a_pos_normal;attribute vec4 a_data;attribute float a_uv_x;attribute float a_split_index;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_units_to_pixels;uniform float u_image_height;varying vec2 v_normal;varying vec2 v_width2;varying float v_gamma_scale;varying highp vec2 v_uv;
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;highp float texel_height=1.0/u_image_height;highp float half_texel_height=0.5*texel_height;v_uv=vec2(a_uv_x,a_split_index*texel_height-half_texel_height);vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;v_width2=vec2(outset,inset);}`),Ga=Or(`uniform lowp float u_device_pixel_ratio;uniform vec2 u_texsize;uniform float u_fade;uniform mediump vec3 u_scale;uniform sampler2D u_image;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;vec2 pattern_size_a=vec2(display_size_a.x*fromScale/tileZoomRatio,display_size_a.y);vec2 pattern_size_b=vec2(display_size_b.x*toScale/tileZoomRatio,display_size_b.y);float aspect_a=display_size_a.y/v_width;float aspect_b=display_size_b.y/v_width;float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float x_a=mod(v_linesofar/pattern_size_a.x*aspect_a,1.0);float x_b=mod(v_linesofar/pattern_size_b.x*aspect_b,1.0);float y=0.5*v_normal.y+0.5;vec2 texel_size=1.0/u_texsize;vec2 pos_a=mix(pattern_tl_a*texel_size-texel_size,pattern_br_a*texel_size+texel_size,vec2(x_a,y));vec2 pos_b=mix(pattern_tl_b*texel_size-texel_size,pattern_br_b*texel_size+texel_size,vec2(x_b,y));vec4 color=mix(texture2D(u_image,pos_a),texture2D(u_image,pos_b),u_fade);gl_FragColor=color*alpha*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
#define LINE_DISTANCE_SCALE 2.0
attribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform vec2 u_units_to_pixels;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;v_linesofar=a_linesofar;v_width2=vec2(outset,inset);v_width=floorwidth;}`),mo=Or(`uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;uniform float u_sdfgamma;uniform float u_mix;varying vec2 v_normal;varying vec2 v_width2;varying vec2 v_tex_a;varying vec2 v_tex_b;varying float v_gamma_scale;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float sdfdist_a=texture2D(u_image,v_tex_a).a;float sdfdist_b=texture2D(u_image,v_tex_b).a;float sdfdist=mix(sdfdist_a,sdfdist_b,u_mix);alpha*=smoothstep(0.5-u_sdfgamma/floorwidth,0.5+u_sdfgamma/floorwidth,sdfdist);gl_FragColor=color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
#define LINE_DISTANCE_SCALE 2.0
attribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_patternscale_a;uniform float u_tex_y_a;uniform vec2 u_patternscale_b;uniform float u_tex_y_b;uniform vec2 u_units_to_pixels;varying vec2 v_normal;varying vec2 v_width2;varying vec2 v_tex_a;varying vec2 v_tex_b;varying float v_gamma_scale;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;v_tex_a=vec2(a_linesofar*u_patternscale_a.x/floorwidth,normal.y*u_patternscale_a.y+u_tex_y_a);v_tex_b=vec2(a_linesofar*u_patternscale_b.x/floorwidth,normal.y*u_patternscale_b.y+u_tex_y_b);v_width2=vec2(outset,inset);}`),yo=Or(`uniform float u_fade_t;uniform float u_opacity;uniform sampler2D u_image0;uniform sampler2D u_image1;varying vec2 v_pos0;varying vec2 v_pos1;uniform float u_brightness_low;uniform float u_brightness_high;uniform float u_saturation_factor;uniform float u_contrast_factor;uniform vec3 u_spin_weights;void main() {vec4 color0=texture2D(u_image0,v_pos0);vec4 color1=texture2D(u_image1,v_pos1);if (color0.a > 0.0) {color0.rgb=color0.rgb/color0.a;}if (color1.a > 0.0) {color1.rgb=color1.rgb/color1.a;}vec4 color=mix(color0,color1,u_fade_t);color.a*=u_opacity;vec3 rgb=color.rgb;rgb=vec3(dot(rgb,u_spin_weights.xyz),dot(rgb,u_spin_weights.zxy),dot(rgb,u_spin_weights.yzx));float average=(color.r+color.g+color.b)/3.0;rgb+=(average-rgb)*u_saturation_factor;rgb=(rgb-0.5)*u_contrast_factor+0.5;vec3 u_high_vec=vec3(u_brightness_low,u_brightness_low,u_brightness_low);vec3 u_low_vec=vec3(u_brightness_high,u_brightness_high,u_brightness_high);gl_FragColor=vec4(mix(u_high_vec,u_low_vec,rgb)*color.a,color.a);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_tl_parent;uniform float u_scale_parent;uniform float u_buffer_scale;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos0;varying vec2 v_pos1;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos0=(((a_texture_pos/8192.0)-0.5)/u_buffer_scale )+0.5;v_pos1=(v_pos0*u_scale_parent)+u_tl_parent;}"),Ka=Or(`uniform sampler2D u_texture;varying vec2 v_tex;varying float v_fade_opacity;
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float opacity
lowp float alpha=opacity*v_fade_opacity;gl_FragColor=texture2D(u_texture,v_tex)*alpha;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`const float PI=3.141592653589793;attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec4 a_pixeloffset;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform highp float u_camera_to_center_distance;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform float u_fade_change;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform vec2 u_texsize;varying vec2 v_tex;varying float v_fade_opacity;
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float opacity
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;vec2 a_minFontScale=a_pixeloffset.zw/256.0;highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec4 projectedPoint=u_matrix*vec4(a_pos,0,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),0,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,0.0,1.0);gl_Position=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*max(a_minFontScale,fontScale)+a_pxoffset/16.0),0.0,1.0);v_tex=a_tex/u_texsize;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;v_fade_opacity=max(0.0,min(1.0,fade_opacity[0]+fade_change));}`),lc=Or(`#define SDF_PX 8.0
uniform bool u_is_halo;uniform sampler2D u_texture;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;uniform bool u_is_text;varying vec2 v_data0;varying vec3 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
float EDGE_GAMMA=0.105/u_device_pixel_ratio;vec2 tex=v_data0.xy;float gamma_scale=v_data1.x;float size=v_data1.y;float fade_opacity=v_data1[2];float fontScale=u_is_text ? size/24.0 : size;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);gl_FragColor=color*(alpha*opacity*fade_opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`const float PI=3.141592653589793;attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec4 a_pixeloffset;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;varying vec2 v_data0;varying vec3 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec4 projectedPoint=u_matrix*vec4(a_pos,0,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),0,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,0.0,1.0);gl_Position=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale+a_pxoffset),0.0,1.0);float gamma_scale=gl_Position.w;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(1.0,fade_opacity[0]+fade_change));v_data0=a_tex/u_texsize;v_data1=vec3(gamma_scale,size,interpolated_fade_opacity);}`),uc=Or(`#define SDF_PX 8.0
#define SDF 1.0
#define ICON 0.0
uniform bool u_is_halo;uniform sampler2D u_texture;uniform sampler2D u_texture_icon;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;varying vec4 v_data0;varying vec4 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
float fade_opacity=v_data1[2];if (v_data1.w==ICON) {vec2 tex_icon=v_data0.zw;lowp float alpha=opacity*fade_opacity;gl_FragColor=texture2D(u_texture_icon,tex_icon)*alpha;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
return;}vec2 tex=v_data0.xy;float EDGE_GAMMA=0.105/u_device_pixel_ratio;float gamma_scale=v_data1.x;float size=v_data1.y;float fontScale=size/24.0;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);gl_FragColor=color*(alpha*opacity*fade_opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`const float PI=3.141592653589793;attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec2 u_texsize_icon;varying vec4 v_data0;varying vec4 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);float is_sdf=a_size[0]-2.0*a_size_min;highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec4 projectedPoint=u_matrix*vec4(a_pos,0,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=size/24.0;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),0,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,0.0,1.0);gl_Position=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale),0.0,1.0);float gamma_scale=gl_Position.w;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(1.0,fade_opacity[0]+fade_change));v_data0.xy=a_tex/u_texsize;v_data0.zw=a_tex/u_texsize_icon;v_data1=vec4(gamma_scale,size,interpolated_fade_opacity,is_sdf);}`);function Or(n,s){var o=/#pragma mapbox: ([\w]+) ([\w]+) ([\w]+) ([\w]+)/g,c=s.match(/attribute ([\w]+) ([\w]+)/g),_=n.match(/uniform ([\w]+) ([\w]+)([\s]*)([\w]*)/g),w=s.match(/uniform ([\w]+) ([\w]+)([\s]*)([\w]*)/g),S=w?w.concat(_):_,z={};return{fragmentSource:n=n.replace(o,function(P,O,G,K,X){return z[X]=!0,O==="define"?`
#ifndef HAS_UNIFORM_u_`+X+`
varying `+G+" "+K+" "+X+`;
#else
uniform `+G+" "+K+" u_"+X+`;
#endif
`:`
#ifdef HAS_UNIFORM_u_`+X+`
    `+G+" "+K+" "+X+" = u_"+X+`;
#endif
`}),vertexSource:s=s.replace(o,function(P,O,G,K,X){var re=K==="float"?"vec2":"vec4",te=X.match(/color/)?"color":re;return z[X]?O==="define"?`
#ifndef HAS_UNIFORM_u_`+X+`
uniform lowp float u_`+X+`_t;
attribute `+G+" "+re+" a_"+X+`;
varying `+G+" "+K+" "+X+`;
#else
uniform `+G+" "+K+" u_"+X+`;
#endif
`:te==="vec4"?`
#ifndef HAS_UNIFORM_u_`+X+`
    `+X+" = a_"+X+`;
#else
    `+G+" "+K+" "+X+" = u_"+X+`;
#endif
`:`
#ifndef HAS_UNIFORM_u_`+X+`
    `+X+" = unpack_mix_"+te+"(a_"+X+", u_"+X+`_t);
#else
    `+G+" "+K+" "+X+" = u_"+X+`;
#endif
`:O==="define"?`
#ifndef HAS_UNIFORM_u_`+X+`
uniform lowp float u_`+X+`_t;
attribute `+G+" "+re+" a_"+X+`;
#else
uniform `+G+" "+K+" u_"+X+`;
#endif
`:te==="vec4"?`
#ifndef HAS_UNIFORM_u_`+X+`
    `+G+" "+K+" "+X+" = a_"+X+`;
#else
    `+G+" "+K+" "+X+" = u_"+X+`;
#endif
`:`
#ifndef HAS_UNIFORM_u_`+X+`
    `+G+" "+K+" "+X+" = unpack_mix_"+te+"(a_"+X+", u_"+X+`_t);
#else
    `+G+" "+K+" "+X+" = u_"+X+`;
#endif
`}),staticAttributes:c,staticUniforms:S}}var qh=Object.freeze({__proto__:null,prelude:Fo,background:nc,backgroundPattern:Uh,circle:Vh,clippingMask:jl,heatmap:ql,heatmapTexture:Zl,collisionBox:Gl,collisionCircle:ac,debug:oc,fill:jh,fillOutline:us,fillOutlinePattern:cs,fillPattern:sc,fillExtrusion:rn,fillExtrusionPattern:Kl,hillshadePrepare:qa,hillshade:Za,line:po,lineGradient:fo,linePattern:Ga,lineSDF:mo,raster:yo,symbolIcon:Ka,symbolSDF:lc,symbolTextAndIcon:uc}),Vs=function(){this.boundProgram=null,this.boundLayoutVertexBuffer=null,this.boundPaintVertexBuffers=[],this.boundIndexBuffer=null,this.boundVertexOffset=null,this.boundDynamicVertexBuffer=null,this.vao=null};function cc(n){for(var s=[],o=0;o<n.length;o++)if(n[o]!==null){var c=n[o].split(" ");s.push(c.pop())}return s}Vs.prototype.bind=function(n,s,o,c,_,w,S,z){this.context=n;for(var P=this.boundPaintVertexBuffers.length!==c.length,O=0;!P&&O<c.length;O++)this.boundPaintVertexBuffers[O]!==c[O]&&(P=!0);n.extVertexArrayObject&&this.vao&&this.boundProgram===s&&this.boundLayoutVertexBuffer===o&&!P&&this.boundIndexBuffer===_&&this.boundVertexOffset===w&&this.boundDynamicVertexBuffer===S&&this.boundDynamicVertexBuffer2===z?(n.bindVertexArrayOES.set(this.vao),S&&S.bind(),_&&_.dynamicDraw&&_.bind(),z&&z.bind()):this.freshBind(s,o,c,_,w,S,z)},Vs.prototype.freshBind=function(n,s,o,c,_,w,S){var z,P=n.numAttributes,O=this.context,G=O.gl;if(O.extVertexArrayObject)this.vao&&this.destroy(),this.vao=O.extVertexArrayObject.createVertexArrayOES(),O.bindVertexArrayOES.set(this.vao),z=0,this.boundProgram=n,this.boundLayoutVertexBuffer=s,this.boundPaintVertexBuffers=o,this.boundIndexBuffer=c,this.boundVertexOffset=_,this.boundDynamicVertexBuffer=w,this.boundDynamicVertexBuffer2=S;else{z=O.currentNumAttributes||0;for(var K=P;K<z;K++)G.disableVertexAttribArray(K)}s.enableAttributes(G,n);for(var X=0,re=o;X<re.length;X+=1)re[X].enableAttributes(G,n);w&&w.enableAttributes(G,n),S&&S.enableAttributes(G,n),s.bind(),s.setVertexAttribPointers(G,n,_);for(var te=0,ue=o;te<ue.length;te+=1){var Y=ue[te];Y.bind(),Y.setVertexAttribPointers(G,n,_)}w&&(w.bind(),w.setVertexAttribPointers(G,n,_)),c&&c.bind(),S&&(S.bind(),S.setVertexAttribPointers(G,n,_)),O.currentNumAttributes=P},Vs.prototype.destroy=function(){this.vao&&(this.context.extVertexArrayObject.deleteVertexArrayOES(this.vao),this.vao=null)};var hc=function(n,s,o,c,_,w){var S=n.gl;this.program=S.createProgram();for(var z=cc(o.staticAttributes),P=c?c.getBinderAttributes():[],O=z.concat(P),G=o.staticUniforms?cc(o.staticUniforms):[],K=c?c.getBinderUniforms():[],X=[],re=0,te=G.concat(K);re<te.length;re+=1){var ue=te[re];X.indexOf(ue)<0&&X.push(ue)}var Y=c?c.defines():[];w&&Y.push("#define OVERDRAW_INSPECTOR;");var le=Y.concat(Fo.fragmentSource,o.fragmentSource).join(`
`),pe=Y.concat(Fo.vertexSource,o.vertexSource).join(`
`),ve=S.createShader(S.FRAGMENT_SHADER);if(S.isContextLost())this.failedToCreate=!0;else{S.shaderSource(ve,le),S.compileShader(ve),S.attachShader(this.program,ve);var Ie=S.createShader(S.VERTEX_SHADER);if(S.isContextLost())this.failedToCreate=!0;else{S.shaderSource(Ie,pe),S.compileShader(Ie),S.attachShader(this.program,Ie),this.attributes={};var Ee={};this.numAttributes=O.length;for(var Ae=0;Ae<this.numAttributes;Ae++)O[Ae]&&(S.bindAttribLocation(this.program,Ae,O[Ae]),this.attributes[O[Ae]]=Ae);S.linkProgram(this.program),S.deleteShader(Ie),S.deleteShader(ve);for(var Re=0;Re<X.length;Re++){var Ke=X[Re];if(Ke&&!Ee[Ke]){var Ze=S.getUniformLocation(this.program,Ke);Ze&&(Ee[Ke]=Ze)}}this.fixedUniforms=_(n,Ee),this.binderUniforms=c?c.getUniforms(n,Ee):[]}}};function pc(n,s,o){var c=1/Rr(o,1,s.transform.tileZoom),_=Math.pow(2,o.tileID.overscaledZ),w=o.tileSize*Math.pow(2,s.transform.tileZoom)/_,S=w*(o.tileID.canonical.x+o.tileID.wrap*_),z=w*o.tileID.canonical.y;return{u_image:0,u_texsize:o.imageAtlasTexture.size,u_scale:[c,n.fromScale,n.toScale],u_fade:n.t,u_pixel_coord_upper:[S>>16,z>>16],u_pixel_coord_lower:[65535&S,65535&z]}}hc.prototype.draw=function(n,s,o,c,_,w,S,z,P,O,G,K,X,re,te,ue){var Y,le=n.gl;if(!this.failedToCreate){for(var pe in n.program.set(this.program),n.setDepthMode(o),n.setStencilMode(c),n.setColorMode(_),n.setCullFace(w),this.fixedUniforms)this.fixedUniforms[pe].set(S[pe]);re&&re.setUniforms(n,this.binderUniforms,K,{zoom:X});for(var ve=(Y={},Y[le.LINES]=2,Y[le.TRIANGLES]=3,Y[le.LINE_STRIP]=1,Y)[s],Ie=0,Ee=G.get();Ie<Ee.length;Ie+=1){var Ae=Ee[Ie],Re=Ae.vaos||(Ae.vaos={});(Re[z]||(Re[z]=new Vs)).bind(n,this,P,re?re.getPaintVertexBuffers():[],O,Ae.vertexOffset,te,ue),le.drawElements(s,Ae.primitiveLength*ve,le.UNSIGNED_SHORT,Ae.primitiveOffset*ve*2)}}};var fc=function(n,s,o,c){var _=s.style.light,w=_.properties.get("position"),S=[w.x,w.y,w.z],z=a.create$1();_.properties.get("anchor")==="viewport"&&a.fromRotation(z,-s.transform.angle),a.transformMat3(S,S,z);var P=_.properties.get("color");return{u_matrix:n,u_lightpos:S,u_lightintensity:_.properties.get("intensity"),u_lightcolor:[P.r,P.g,P.b],u_vertical_gradient:+o,u_opacity:c}},go=function(n,s,o,c,_,w,S){return a.extend(fc(n,s,o,c),pc(w,s,S),{u_height_factor:-Math.pow(2,_.overscaledZ)/S.tileSize/8})},Xa=function(n){return{u_matrix:n}},_o=function(n,s,o,c){return a.extend(Xa(n),pc(o,s,c))},dc=function(n,s){return{u_matrix:n,u_world:s}},mc=function(n,s,o,c,_){return a.extend(_o(n,s,o,c),{u_world:_})},Xl=function(n,s,o,c){var _,w,S=n.transform;if(c.paint.get("circle-pitch-alignment")==="map"){var z=Rr(o,1,S.zoom);_=!0,w=[z,z]}else _=!1,w=S.pixelsToGLUnits;return{u_camera_to_center_distance:S.cameraToCenterDistance,u_scale_with_map:+(c.paint.get("circle-pitch-scale")==="map"),u_matrix:n.translatePosMatrix(s.posMatrix,o,c.paint.get("circle-translate"),c.paint.get("circle-translate-anchor")),u_pitch_with_map:+_,u_device_pixel_ratio:a.browser.devicePixelRatio,u_extrude_scale:w}},vo=function(n,s,o){var c=Rr(o,1,s.zoom),_=Math.pow(2,s.zoom-o.tileID.overscaledZ),w=o.tileID.overscaleFactor();return{u_matrix:n,u_camera_to_center_distance:s.cameraToCenterDistance,u_pixels_to_tile_units:c,u_extrude_scale:[s.pixelsToGLUnits[0]/(c*_),s.pixelsToGLUnits[1]/(c*_)],u_overscale_factor:w}},yc=function(n,s,o){return{u_matrix:n,u_inv_matrix:s,u_camera_to_center_distance:o.cameraToCenterDistance,u_viewport_size:[o.width,o.height]}},bo=function(n,s,o){return o===void 0&&(o=1),{u_matrix:n,u_color:s,u_overlay:0,u_overlay_scale:o}},xo=function(n){return{u_matrix:n}},gc=function(n,s,o,c){return{u_matrix:n,u_extrude_scale:Rr(s,1,o),u_intensity:c}},hs=function(n,s,o){var c=n.transform;return{u_matrix:_c(n,s,o),u_ratio:1/Rr(s,1,c.zoom),u_device_pixel_ratio:a.browser.devicePixelRatio,u_units_to_pixels:[1/c.pixelsToGLUnits[0],1/c.pixelsToGLUnits[1]]}},Vr=function(n,s,o,c){return a.extend(hs(n,s,o),{u_image:0,u_image_height:c})},js=function(n,s,o,c){var _=n.transform,w=No(s,_);return{u_matrix:_c(n,s,o),u_texsize:s.imageAtlasTexture.size,u_ratio:1/Rr(s,1,_.zoom),u_device_pixel_ratio:a.browser.devicePixelRatio,u_image:0,u_scale:[w,c.fromScale,c.toScale],u_fade:c.t,u_units_to_pixels:[1/_.pixelsToGLUnits[0],1/_.pixelsToGLUnits[1]]}},Zh=function(n,s,o,c,_){var w=n.lineAtlas,S=No(s,n.transform),z=o.layout.get("line-cap")==="round",P=w.getDash(c.from,z),O=w.getDash(c.to,z),G=P.width*_.fromScale,K=O.width*_.toScale;return a.extend(hs(n,s,o),{u_patternscale_a:[S/G,-P.height/2],u_patternscale_b:[S/K,-O.height/2],u_sdfgamma:w.width/(256*Math.min(G,K)*a.browser.devicePixelRatio)/2,u_image:0,u_tex_y_a:P.y,u_tex_y_b:O.y,u_mix:_.t})};function No(n,s){return 1/Rr(n,1,s.tileZoom)}function _c(n,s,o){return n.translatePosMatrix(s.tileID.posMatrix,s,o.paint.get("line-translate"),o.paint.get("line-translate-anchor"))}var Gh=function(n,s,o,c,_){return{u_matrix:n,u_tl_parent:s,u_scale_parent:o,u_buffer_scale:1,u_fade_t:c.mix,u_opacity:c.opacity*_.paint.get("raster-opacity"),u_image0:0,u_image1:1,u_brightness_low:_.paint.get("raster-brightness-min"),u_brightness_high:_.paint.get("raster-brightness-max"),u_saturation_factor:(S=_.paint.get("raster-saturation"),S>0?1-1/(1.001-S):-S),u_contrast_factor:(w=_.paint.get("raster-contrast"),w>0?1/(1-w):1+w),u_spin_weights:vc(_.paint.get("raster-hue-rotate"))};var w,S};function vc(n){n*=Math.PI/180;var s=Math.sin(n),o=Math.cos(n);return[(2*o+1)/3,(-Math.sqrt(3)*s-o+1)/3,(Math.sqrt(3)*s-o+1)/3]}var qs,Uo=function(n,s,o,c,_,w,S,z,P,O){var G=_.transform;return{u_is_size_zoom_constant:+(n==="constant"||n==="source"),u_is_size_feature_constant:+(n==="constant"||n==="camera"),u_size_t:s?s.uSizeT:0,u_size:s?s.uSize:0,u_camera_to_center_distance:G.cameraToCenterDistance,u_pitch:G.pitch/360*2*Math.PI,u_rotate_symbol:+o,u_aspect_ratio:G.width/G.height,u_fade_change:_.options.fadeDuration?_.symbolFadeChange:1,u_matrix:w,u_label_plane_matrix:S,u_coord_matrix:z,u_is_text:+P,u_pitch_with_map:+c,u_texsize:O,u_texture:0}},ps=function(n,s,o,c,_,w,S,z,P,O,G){var K=_.transform;return a.extend(Uo(n,s,o,c,_,w,S,z,P,O),{u_gamma_scale:c?Math.cos(K._pitch)*K.cameraToCenterDistance:1,u_device_pixel_ratio:a.browser.devicePixelRatio,u_is_halo:+G})},Zs=function(n,s,o,c,_,w,S,z,P,O){return a.extend(ps(n,s,o,c,_,w,S,z,!0,P,!0),{u_texsize_icon:O,u_texture_icon:1})},fs=function(n,s,o){return{u_matrix:n,u_opacity:s,u_color:o}},Vo=function(n,s,o,c,_,w){return a.extend(function(S,z,P,O){var G=P.imageManager.getPattern(S.from.toString()),K=P.imageManager.getPattern(S.to.toString()),X=P.imageManager.getPixelSize(),re=X.width,te=X.height,ue=Math.pow(2,O.tileID.overscaledZ),Y=O.tileSize*Math.pow(2,P.transform.tileZoom)/ue,le=Y*(O.tileID.canonical.x+O.tileID.wrap*ue),pe=Y*O.tileID.canonical.y;return{u_image:0,u_pattern_tl_a:G.tl,u_pattern_br_a:G.br,u_pattern_tl_b:K.tl,u_pattern_br_b:K.br,u_texsize:[re,te],u_mix:z.t,u_pattern_size_a:G.displaySize,u_pattern_size_b:K.displaySize,u_scale_a:z.fromScale,u_scale_b:z.toScale,u_tile_units_to_pixels:1/Rr(O,1,P.transform.tileZoom),u_pixel_coord_upper:[le>>16,pe>>16],u_pixel_coord_lower:[65535&le,65535&pe]}}(c,w,o,_),{u_matrix:n,u_opacity:s})},bc={fillExtrusion:function(n,s){return{u_matrix:new a.UniformMatrix4f(n,s.u_matrix),u_lightpos:new a.Uniform3f(n,s.u_lightpos),u_lightintensity:new a.Uniform1f(n,s.u_lightintensity),u_lightcolor:new a.Uniform3f(n,s.u_lightcolor),u_vertical_gradient:new a.Uniform1f(n,s.u_vertical_gradient),u_opacity:new a.Uniform1f(n,s.u_opacity)}},fillExtrusionPattern:function(n,s){return{u_matrix:new a.UniformMatrix4f(n,s.u_matrix),u_lightpos:new a.Uniform3f(n,s.u_lightpos),u_lightintensity:new a.Uniform1f(n,s.u_lightintensity),u_lightcolor:new a.Uniform3f(n,s.u_lightcolor),u_vertical_gradient:new a.Uniform1f(n,s.u_vertical_gradient),u_height_factor:new a.Uniform1f(n,s.u_height_factor),u_image:new a.Uniform1i(n,s.u_image),u_texsize:new a.Uniform2f(n,s.u_texsize),u_pixel_coord_upper:new a.Uniform2f(n,s.u_pixel_coord_upper),u_pixel_coord_lower:new a.Uniform2f(n,s.u_pixel_coord_lower),u_scale:new a.Uniform3f(n,s.u_scale),u_fade:new a.Uniform1f(n,s.u_fade),u_opacity:new a.Uniform1f(n,s.u_opacity)}},fill:function(n,s){return{u_matrix:new a.UniformMatrix4f(n,s.u_matrix)}},fillPattern:function(n,s){return{u_matrix:new a.UniformMatrix4f(n,s.u_matrix),u_image:new a.Uniform1i(n,s.u_image),u_texsize:new a.Uniform2f(n,s.u_texsize),u_pixel_coord_upper:new a.Uniform2f(n,s.u_pixel_coord_upper),u_pixel_coord_lower:new a.Uniform2f(n,s.u_pixel_coord_lower),u_scale:new a.Uniform3f(n,s.u_scale),u_fade:new a.Uniform1f(n,s.u_fade)}},fillOutline:function(n,s){return{u_matrix:new a.UniformMatrix4f(n,s.u_matrix),u_world:new a.Uniform2f(n,s.u_world)}},fillOutlinePattern:function(n,s){return{u_matrix:new a.UniformMatrix4f(n,s.u_matrix),u_world:new a.Uniform2f(n,s.u_world),u_image:new a.Uniform1i(n,s.u_image),u_texsize:new a.Uniform2f(n,s.u_texsize),u_pixel_coord_upper:new a.Uniform2f(n,s.u_pixel_coord_upper),u_pixel_coord_lower:new a.Uniform2f(n,s.u_pixel_coord_lower),u_scale:new a.Uniform3f(n,s.u_scale),u_fade:new a.Uniform1f(n,s.u_fade)}},circle:function(n,s){return{u_camera_to_center_distance:new a.Uniform1f(n,s.u_camera_to_center_distance),u_scale_with_map:new a.Uniform1i(n,s.u_scale_with_map),u_pitch_with_map:new a.Uniform1i(n,s.u_pitch_with_map),u_extrude_scale:new a.Uniform2f(n,s.u_extrude_scale),u_device_pixel_ratio:new a.Uniform1f(n,s.u_device_pixel_ratio),u_matrix:new a.UniformMatrix4f(n,s.u_matrix)}},collisionBox:function(n,s){return{u_matrix:new a.UniformMatrix4f(n,s.u_matrix),u_camera_to_center_distance:new a.Uniform1f(n,s.u_camera_to_center_distance),u_pixels_to_tile_units:new a.Uniform1f(n,s.u_pixels_to_tile_units),u_extrude_scale:new a.Uniform2f(n,s.u_extrude_scale),u_overscale_factor:new a.Uniform1f(n,s.u_overscale_factor)}},collisionCircle:function(n,s){return{u_matrix:new a.UniformMatrix4f(n,s.u_matrix),u_inv_matrix:new a.UniformMatrix4f(n,s.u_inv_matrix),u_camera_to_center_distance:new a.Uniform1f(n,s.u_camera_to_center_distance),u_viewport_size:new a.Uniform2f(n,s.u_viewport_size)}},debug:function(n,s){return{u_color:new a.UniformColor(n,s.u_color),u_matrix:new a.UniformMatrix4f(n,s.u_matrix),u_overlay:new a.Uniform1i(n,s.u_overlay),u_overlay_scale:new a.Uniform1f(n,s.u_overlay_scale)}},clippingMask:function(n,s){return{u_matrix:new a.UniformMatrix4f(n,s.u_matrix)}},heatmap:function(n,s){return{u_extrude_scale:new a.Uniform1f(n,s.u_extrude_scale),u_intensity:new a.Uniform1f(n,s.u_intensity),u_matrix:new a.UniformMatrix4f(n,s.u_matrix)}},heatmapTexture:function(n,s){return{u_matrix:new a.UniformMatrix4f(n,s.u_matrix),u_world:new a.Uniform2f(n,s.u_world),u_image:new a.Uniform1i(n,s.u_image),u_color_ramp:new a.Uniform1i(n,s.u_color_ramp),u_opacity:new a.Uniform1f(n,s.u_opacity)}},hillshade:function(n,s){return{u_matrix:new a.UniformMatrix4f(n,s.u_matrix),u_image:new a.Uniform1i(n,s.u_image),u_latrange:new a.Uniform2f(n,s.u_latrange),u_light:new a.Uniform2f(n,s.u_light),u_shadow:new a.UniformColor(n,s.u_shadow),u_highlight:new a.UniformColor(n,s.u_highlight),u_accent:new a.UniformColor(n,s.u_accent)}},hillshadePrepare:function(n,s){return{u_matrix:new a.UniformMatrix4f(n,s.u_matrix),u_image:new a.Uniform1i(n,s.u_image),u_dimension:new a.Uniform2f(n,s.u_dimension),u_zoom:new a.Uniform1f(n,s.u_zoom),u_unpack:new a.Uniform4f(n,s.u_unpack)}},line:function(n,s){return{u_matrix:new a.UniformMatrix4f(n,s.u_matrix),u_ratio:new a.Uniform1f(n,s.u_ratio),u_device_pixel_ratio:new a.Uniform1f(n,s.u_device_pixel_ratio),u_units_to_pixels:new a.Uniform2f(n,s.u_units_to_pixels)}},lineGradient:function(n,s){return{u_matrix:new a.UniformMatrix4f(n,s.u_matrix),u_ratio:new a.Uniform1f(n,s.u_ratio),u_device_pixel_ratio:new a.Uniform1f(n,s.u_device_pixel_ratio),u_units_to_pixels:new a.Uniform2f(n,s.u_units_to_pixels),u_image:new a.Uniform1i(n,s.u_image),u_image_height:new a.Uniform1f(n,s.u_image_height)}},linePattern:function(n,s){return{u_matrix:new a.UniformMatrix4f(n,s.u_matrix),u_texsize:new a.Uniform2f(n,s.u_texsize),u_ratio:new a.Uniform1f(n,s.u_ratio),u_device_pixel_ratio:new a.Uniform1f(n,s.u_device_pixel_ratio),u_image:new a.Uniform1i(n,s.u_image),u_units_to_pixels:new a.Uniform2f(n,s.u_units_to_pixels),u_scale:new a.Uniform3f(n,s.u_scale),u_fade:new a.Uniform1f(n,s.u_fade)}},lineSDF:function(n,s){return{u_matrix:new a.UniformMatrix4f(n,s.u_matrix),u_ratio:new a.Uniform1f(n,s.u_ratio),u_device_pixel_ratio:new a.Uniform1f(n,s.u_device_pixel_ratio),u_units_to_pixels:new a.Uniform2f(n,s.u_units_to_pixels),u_patternscale_a:new a.Uniform2f(n,s.u_patternscale_a),u_patternscale_b:new a.Uniform2f(n,s.u_patternscale_b),u_sdfgamma:new a.Uniform1f(n,s.u_sdfgamma),u_image:new a.Uniform1i(n,s.u_image),u_tex_y_a:new a.Uniform1f(n,s.u_tex_y_a),u_tex_y_b:new a.Uniform1f(n,s.u_tex_y_b),u_mix:new a.Uniform1f(n,s.u_mix)}},raster:function(n,s){return{u_matrix:new a.UniformMatrix4f(n,s.u_matrix),u_tl_parent:new a.Uniform2f(n,s.u_tl_parent),u_scale_parent:new a.Uniform1f(n,s.u_scale_parent),u_buffer_scale:new a.Uniform1f(n,s.u_buffer_scale),u_fade_t:new a.Uniform1f(n,s.u_fade_t),u_opacity:new a.Uniform1f(n,s.u_opacity),u_image0:new a.Uniform1i(n,s.u_image0),u_image1:new a.Uniform1i(n,s.u_image1),u_brightness_low:new a.Uniform1f(n,s.u_brightness_low),u_brightness_high:new a.Uniform1f(n,s.u_brightness_high),u_saturation_factor:new a.Uniform1f(n,s.u_saturation_factor),u_contrast_factor:new a.Uniform1f(n,s.u_contrast_factor),u_spin_weights:new a.Uniform3f(n,s.u_spin_weights)}},symbolIcon:function(n,s){return{u_is_size_zoom_constant:new a.Uniform1i(n,s.u_is_size_zoom_constant),u_is_size_feature_constant:new a.Uniform1i(n,s.u_is_size_feature_constant),u_size_t:new a.Uniform1f(n,s.u_size_t),u_size:new a.Uniform1f(n,s.u_size),u_camera_to_center_distance:new a.Uniform1f(n,s.u_camera_to_center_distance),u_pitch:new a.Uniform1f(n,s.u_pitch),u_rotate_symbol:new a.Uniform1i(n,s.u_rotate_symbol),u_aspect_ratio:new a.Uniform1f(n,s.u_aspect_ratio),u_fade_change:new a.Uniform1f(n,s.u_fade_change),u_matrix:new a.UniformMatrix4f(n,s.u_matrix),u_label_plane_matrix:new a.UniformMatrix4f(n,s.u_label_plane_matrix),u_coord_matrix:new a.UniformMatrix4f(n,s.u_coord_matrix),u_is_text:new a.Uniform1i(n,s.u_is_text),u_pitch_with_map:new a.Uniform1i(n,s.u_pitch_with_map),u_texsize:new a.Uniform2f(n,s.u_texsize),u_texture:new a.Uniform1i(n,s.u_texture)}},symbolSDF:function(n,s){return{u_is_size_zoom_constant:new a.Uniform1i(n,s.u_is_size_zoom_constant),u_is_size_feature_constant:new a.Uniform1i(n,s.u_is_size_feature_constant),u_size_t:new a.Uniform1f(n,s.u_size_t),u_size:new a.Uniform1f(n,s.u_size),u_camera_to_center_distance:new a.Uniform1f(n,s.u_camera_to_center_distance),u_pitch:new a.Uniform1f(n,s.u_pitch),u_rotate_symbol:new a.Uniform1i(n,s.u_rotate_symbol),u_aspect_ratio:new a.Uniform1f(n,s.u_aspect_ratio),u_fade_change:new a.Uniform1f(n,s.u_fade_change),u_matrix:new a.UniformMatrix4f(n,s.u_matrix),u_label_plane_matrix:new a.UniformMatrix4f(n,s.u_label_plane_matrix),u_coord_matrix:new a.UniformMatrix4f(n,s.u_coord_matrix),u_is_text:new a.Uniform1i(n,s.u_is_text),u_pitch_with_map:new a.Uniform1i(n,s.u_pitch_with_map),u_texsize:new a.Uniform2f(n,s.u_texsize),u_texture:new a.Uniform1i(n,s.u_texture),u_gamma_scale:new a.Uniform1f(n,s.u_gamma_scale),u_device_pixel_ratio:new a.Uniform1f(n,s.u_device_pixel_ratio),u_is_halo:new a.Uniform1i(n,s.u_is_halo)}},symbolTextAndIcon:function(n,s){return{u_is_size_zoom_constant:new a.Uniform1i(n,s.u_is_size_zoom_constant),u_is_size_feature_constant:new a.Uniform1i(n,s.u_is_size_feature_constant),u_size_t:new a.Uniform1f(n,s.u_size_t),u_size:new a.Uniform1f(n,s.u_size),u_camera_to_center_distance:new a.Uniform1f(n,s.u_camera_to_center_distance),u_pitch:new a.Uniform1f(n,s.u_pitch),u_rotate_symbol:new a.Uniform1i(n,s.u_rotate_symbol),u_aspect_ratio:new a.Uniform1f(n,s.u_aspect_ratio),u_fade_change:new a.Uniform1f(n,s.u_fade_change),u_matrix:new a.UniformMatrix4f(n,s.u_matrix),u_label_plane_matrix:new a.UniformMatrix4f(n,s.u_label_plane_matrix),u_coord_matrix:new a.UniformMatrix4f(n,s.u_coord_matrix),u_is_text:new a.Uniform1i(n,s.u_is_text),u_pitch_with_map:new a.Uniform1i(n,s.u_pitch_with_map),u_texsize:new a.Uniform2f(n,s.u_texsize),u_texsize_icon:new a.Uniform2f(n,s.u_texsize_icon),u_texture:new a.Uniform1i(n,s.u_texture),u_texture_icon:new a.Uniform1i(n,s.u_texture_icon),u_gamma_scale:new a.Uniform1f(n,s.u_gamma_scale),u_device_pixel_ratio:new a.Uniform1f(n,s.u_device_pixel_ratio),u_is_halo:new a.Uniform1i(n,s.u_is_halo)}},background:function(n,s){return{u_matrix:new a.UniformMatrix4f(n,s.u_matrix),u_opacity:new a.Uniform1f(n,s.u_opacity),u_color:new a.UniformColor(n,s.u_color)}},backgroundPattern:function(n,s){return{u_matrix:new a.UniformMatrix4f(n,s.u_matrix),u_opacity:new a.Uniform1f(n,s.u_opacity),u_image:new a.Uniform1i(n,s.u_image),u_pattern_tl_a:new a.Uniform2f(n,s.u_pattern_tl_a),u_pattern_br_a:new a.Uniform2f(n,s.u_pattern_br_a),u_pattern_tl_b:new a.Uniform2f(n,s.u_pattern_tl_b),u_pattern_br_b:new a.Uniform2f(n,s.u_pattern_br_b),u_texsize:new a.Uniform2f(n,s.u_texsize),u_mix:new a.Uniform1f(n,s.u_mix),u_pattern_size_a:new a.Uniform2f(n,s.u_pattern_size_a),u_pattern_size_b:new a.Uniform2f(n,s.u_pattern_size_b),u_scale_a:new a.Uniform1f(n,s.u_scale_a),u_scale_b:new a.Uniform1f(n,s.u_scale_b),u_pixel_coord_upper:new a.Uniform2f(n,s.u_pixel_coord_upper),u_pixel_coord_lower:new a.Uniform2f(n,s.u_pixel_coord_lower),u_tile_units_to_pixels:new a.Uniform1f(n,s.u_tile_units_to_pixels)}}};function jo(n,s,o,c,_,w,S){for(var z=n.context,P=z.gl,O=n.useProgram("collisionBox"),G=[],K=0,X=0,re=0;re<c.length;re++){var te=c[re],ue=s.getTile(te),Y=ue.getBucket(o);if(Y){var le=te.posMatrix;_[0]===0&&_[1]===0||(le=n.translatePosMatrix(te.posMatrix,ue,_,w));var pe=S?Y.textCollisionBox:Y.iconCollisionBox,ve=Y.collisionCircleArray;if(ve.length>0){var Ie=a.create(),Ee=le;a.mul(Ie,Y.placementInvProjMatrix,n.transform.glCoordMatrix),a.mul(Ie,Ie,Y.placementViewportMatrix),G.push({circleArray:ve,circleOffset:X,transform:Ee,invTransform:Ie}),X=K+=ve.length/4}pe&&O.draw(z,P.LINES,W.disabled,$.disabled,n.colorModeForRenderPass(),he.disabled,vo(le,n.transform,ue),o.id,pe.layoutVertexBuffer,pe.indexBuffer,pe.segments,null,n.transform.zoom,null,null,pe.collisionVertexBuffer)}}if(S&&G.length){var Ae=n.useProgram("collisionCircle"),Re=new a.StructArrayLayout2f1f2i16;Re.resize(4*K),Re._trim();for(var Ke=0,Ze=0,ot=G;Ze<ot.length;Ze+=1)for(var wt=ot[Ze],Tt=0;Tt<wt.circleArray.length/4;Tt++){var Et=4*Tt,_r=wt.circleArray[Et+0],lt=wt.circleArray[Et+1],Ut=wt.circleArray[Et+2],Yt=wt.circleArray[Et+3];Re.emplace(Ke++,_r,lt,Ut,Yt,0),Re.emplace(Ke++,_r,lt,Ut,Yt,1),Re.emplace(Ke++,_r,lt,Ut,Yt,2),Re.emplace(Ke++,_r,lt,Ut,Yt,3)}(!qs||qs.length<2*K)&&(qs=function(ui){var pn=2*ui,Xi=new a.StructArrayLayout3ui6;Xi.resize(pn),Xi._trim();for(var ni=0;ni<pn;ni++){var mi=6*ni;Xi.uint16[mi+0]=4*ni+0,Xi.uint16[mi+1]=4*ni+1,Xi.uint16[mi+2]=4*ni+2,Xi.uint16[mi+3]=4*ni+2,Xi.uint16[mi+4]=4*ni+3,Xi.uint16[mi+5]=4*ni+0}return Xi}(K));for(var Ft=z.createIndexBuffer(qs,!0),Ot=z.createVertexBuffer(Re,a.collisionCircleLayout.members,!0),Ht=0,Bt=G;Ht<Bt.length;Ht+=1){var Lt=Bt[Ht],Li=yc(Lt.transform,Lt.invTransform,n.transform);Ae.draw(z,P.TRIANGLES,W.disabled,$.disabled,n.colorModeForRenderPass(),he.disabled,Li,o.id,Ot,Ft,a.SegmentVector.simpleSegment(0,2*Lt.circleOffset,Lt.circleArray.length,Lt.circleArray.length/2),null,n.transform.zoom,null,null,null)}Ot.destroy(),Ft.destroy()}}var fa=a.identity(new Float32Array(16));function xc(n,s,o,c,_,w){var S=a.getAnchorAlignment(n),z=-(S.horizontalAlign-.5)*s,P=-(S.verticalAlign-.5)*o,O=a.evaluateVariableOffset(n,c);return new a.Point((z/_+O[0])*w,(P/_+O[1])*w)}function wc(n,s,o,c,_,w,S,z,P,O,G){var K=n.text.placedSymbolArray,X=n.text.dynamicLayoutVertexArray,re=n.icon.dynamicLayoutVertexArray,te={};X.clear();for(var ue=0;ue<K.length;ue++){var Y=K.get(ue),le=Y.hidden||!Y.crossTileID||n.allowVerticalPlacement&&!Y.placedOrientation?null:c[Y.crossTileID];if(le){var pe=new a.Point(Y.anchorX,Y.anchorY),ve=Gt(pe,o?z:S),Ie=ar(w.cameraToCenterDistance,ve.signedDistanceFromCamera),Ee=_.evaluateSizeForFeature(n.textSizeData,O,Y)*Ie/a.ONE_EM;o&&(Ee*=n.tilePixelRatio/P);for(var Ae=xc(le.anchor,le.width,le.height,le.textOffset,le.textBoxScale,Ee),Re=o?Gt(pe.add(Ae),S).point:ve.point.add(s?Ae.rotate(-w.angle):Ae),Ke=n.allowVerticalPlacement&&Y.placedOrientation===a.WritingMode.vertical?Math.PI/2:0,Ze=0;Ze<Y.numGlyphs;Ze++)a.addDynamicAttributes(X,Re,Ke);G&&Y.associatedIconIndex>=0&&(te[Y.associatedIconIndex]={shiftedAnchor:Re,angle:Ke})}else ki(Y.numGlyphs,X)}if(G){re.clear();for(var ot=n.icon.placedSymbolArray,wt=0;wt<ot.length;wt++){var Tt=ot.get(wt);if(Tt.hidden)ki(Tt.numGlyphs,re);else{var Et=te[wt];if(Et)for(var _r=0;_r<Tt.numGlyphs;_r++)a.addDynamicAttributes(re,Et.shiftedAnchor,Et.angle);else ki(Tt.numGlyphs,re)}}n.icon.dynamicLayoutVertexBuffer.updateData(re)}n.text.dynamicLayoutVertexBuffer.updateData(X)}function Sc(n,s,o){return o.iconsInText&&s?"symbolTextAndIcon":n?"symbolSDF":"symbolIcon"}function wo(n,s,o,c,_,w,S,z,P,O,G,K){for(var X=n.context,re=X.gl,te=n.transform,ue=z==="map",Y=P==="map",le=ue&&o.layout.get("symbol-placement")!=="point",pe=ue&&!Y&&!le,ve=o.layout.get("symbol-sort-key").constantOr(1)!==void 0,Ie=!1,Ee=n.depthModeForSublayer(0,W.ReadOnly),Ae=o.layout.get("text-variable-anchor"),Re=[],Ke=0,Ze=c;Ke<Ze.length;Ke+=1){var ot=Ze[Ke],wt=s.getTile(ot),Tt=wt.getBucket(o);if(Tt){var Et=_?Tt.text:Tt.icon;if(Et&&Et.segments.get().length){var _r=Et.programConfigurations.get(o.id),lt=_||Tt.sdfIcons,Ut=_?Tt.textSizeData:Tt.iconSizeData,Yt=Y||te.pitch!==0,Ft=n.useProgram(Sc(lt,_,Tt),_r),Ot=a.evaluateSizeForZoom(Ut,te.zoom),Ht=void 0,Bt=[0,0],Lt=void 0,Li=void 0,ui=null,pn=void 0;if(_)Lt=wt.glyphAtlasTexture,Li=re.LINEAR,Ht=wt.glyphAtlasTexture.size,Tt.iconsInText&&(Bt=wt.imageAtlasTexture.size,ui=wt.imageAtlasTexture,pn=Yt||n.options.rotating||n.options.zooming||Ut.kind==="composite"||Ut.kind==="camera"?re.LINEAR:re.NEAREST);else{var Xi=o.layout.get("icon-size").constantOr(0)!==1||Tt.iconsNeedLinear;Lt=wt.imageAtlasTexture,Li=lt||n.options.rotating||n.options.zooming||Xi||Yt?re.LINEAR:re.NEAREST,Ht=wt.imageAtlasTexture.size}var ni=Rr(wt,1,n.transform.zoom),mi=br(ot.posMatrix,Y,ue,n.transform,ni),Wn=fr(ot.posMatrix,Y,ue,n.transform,ni),kn=Ae&&Tt.hasTextData(),$a=o.layout.get("icon-text-fit")!=="none"&&kn&&Tt.hasIconData();le&&Nn(Tt,ot.posMatrix,n,_,mi,Wn,Y,O);var Dn=n.translatePosMatrix(ot.posMatrix,wt,w,S),_a=le||_&&Ae||$a?fa:mi,sa=n.translatePosMatrix(Wn,wt,w,S,!0),Es=lt&&o.paint.get(_?"text-halo-width":"icon-halo-width").constantOr(1)!==0,Wo={program:Ft,buffers:Et,uniformValues:lt?Tt.iconsInText?Zs(Ut.kind,Ot,pe,Y,n,Dn,_a,sa,Ht,Bt):ps(Ut.kind,Ot,pe,Y,n,Dn,_a,sa,_,Ht,!0):Uo(Ut.kind,Ot,pe,Y,n,Dn,_a,sa,_,Ht),atlasTexture:Lt,atlasTextureIcon:ui,atlasInterpolation:Li,atlasInterpolationIcon:pn,isSDF:lt,hasHalo:Es};if(ve&&Tt.canOverlap){Ie=!0;for(var eo=0,Ho=Et.segments.get();eo<Ho.length;eo+=1){var Ts=Ho[eo];Re.push({segments:new a.SegmentVector([Ts]),sortKey:Ts.sortKey,state:Wo})}}else Re.push({segments:Et.segments,sortKey:0,state:Wo})}}}Ie&&Re.sort(function(to,Io){return to.sortKey-Io.sortKey});for(var Ia=0,zs=Re;Ia<zs.length;Ia+=1){var Aa=zs[Ia],Ri=Aa.state;if(X.activeTexture.set(re.TEXTURE0),Ri.atlasTexture.bind(Ri.atlasInterpolation,re.CLAMP_TO_EDGE),Ri.atlasTextureIcon&&(X.activeTexture.set(re.TEXTURE1),Ri.atlasTextureIcon&&Ri.atlasTextureIcon.bind(Ri.atlasInterpolationIcon,re.CLAMP_TO_EDGE)),Ri.isSDF){var La=Ri.uniformValues;Ri.hasHalo&&(La.u_is_halo=1,ds(Ri.buffers,Aa.segments,o,n,Ri.program,Ee,G,K,La)),La.u_is_halo=0}ds(Ri.buffers,Aa.segments,o,n,Ri.program,Ee,G,K,Ri.uniformValues)}}function ds(n,s,o,c,_,w,S,z,P){var O=c.context;_.draw(O,O.gl.TRIANGLES,w,S,z,he.disabled,P,o.id,n.layoutVertexBuffer,n.indexBuffer,s,o.paint,c.transform.zoom,n.programConfigurations.get(o.id),n.dynamicLayoutVertexBuffer,n.opacityVertexBuffer)}function Gs(n,s,o,c,_,w,S){var z,P,O,G,K,X=n.context.gl,re=o.paint.get("fill-pattern"),te=re&&re.constantOr(1),ue=o.getCrossfadeParameters();S?(P=te&&!o.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline",z=X.LINES):(P=te?"fillPattern":"fill",z=X.TRIANGLES);for(var Y=0,le=c;Y<le.length;Y+=1){var pe=le[Y],ve=s.getTile(pe);if(!te||ve.patternsLoaded()){var Ie=ve.getBucket(o);if(Ie){var Ee=Ie.programConfigurations.get(o.id),Ae=n.useProgram(P,Ee);te&&(n.context.activeTexture.set(X.TEXTURE0),ve.imageAtlasTexture.bind(X.LINEAR,X.CLAMP_TO_EDGE),Ee.updatePaintBuffers(ue));var Re=re.constantOr(null);if(Re&&ve.imageAtlas){var Ke=ve.imageAtlas,Ze=Ke.patternPositions[Re.to.toString()],ot=Ke.patternPositions[Re.from.toString()];Ze&&ot&&Ee.setConstantPatternPositions(Ze,ot)}var wt=n.translatePosMatrix(pe.posMatrix,ve,o.paint.get("fill-translate"),o.paint.get("fill-translate-anchor"));if(S){G=Ie.indexBuffer2,K=Ie.segments2;var Tt=[X.drawingBufferWidth,X.drawingBufferHeight];O=P==="fillOutlinePattern"&&te?mc(wt,n,ue,ve,Tt):dc(wt,Tt)}else G=Ie.indexBuffer,K=Ie.segments,O=te?_o(wt,n,ue,ve):Xa(wt);Ae.draw(n.context,z,_,n.stencilModeForClipping(pe),w,he.disabled,O,o.id,Ie.layoutVertexBuffer,G,K,o.paint,n.transform.zoom,Ee)}}}}function Wl(n,s,o,c,_,w,S){for(var z=n.context,P=z.gl,O=o.paint.get("fill-extrusion-pattern"),G=O.constantOr(1),K=o.getCrossfadeParameters(),X=o.paint.get("fill-extrusion-opacity"),re=0,te=c;re<te.length;re+=1){var ue=te[re],Y=s.getTile(ue),le=Y.getBucket(o);if(le){var pe=le.programConfigurations.get(o.id),ve=n.useProgram(G?"fillExtrusionPattern":"fillExtrusion",pe);G&&(n.context.activeTexture.set(P.TEXTURE0),Y.imageAtlasTexture.bind(P.LINEAR,P.CLAMP_TO_EDGE),pe.updatePaintBuffers(K));var Ie=O.constantOr(null);if(Ie&&Y.imageAtlas){var Ee=Y.imageAtlas,Ae=Ee.patternPositions[Ie.to.toString()],Re=Ee.patternPositions[Ie.from.toString()];Ae&&Re&&pe.setConstantPatternPositions(Ae,Re)}var Ke=n.translatePosMatrix(ue.posMatrix,Y,o.paint.get("fill-extrusion-translate"),o.paint.get("fill-extrusion-translate-anchor")),Ze=o.paint.get("fill-extrusion-vertical-gradient"),ot=G?go(Ke,n,Ze,X,ue,K,Y):fc(Ke,n,Ze,X);ve.draw(z,z.gl.TRIANGLES,_,w,S,he.backCCW,ot,o.id,le.layoutVertexBuffer,le.indexBuffer,le.segments,o.paint,n.transform.zoom,pe)}}}function Ks(n,s,o,c,_,w){var S=n.context,z=S.gl,P=s.fbo;if(P){var O=n.useProgram("hillshade");S.activeTexture.set(z.TEXTURE0),z.bindTexture(z.TEXTURE_2D,P.colorAttachment.get());var G=function(K,X,re){var te=re.paint.get("hillshade-shadow-color"),ue=re.paint.get("hillshade-highlight-color"),Y=re.paint.get("hillshade-accent-color"),le=re.paint.get("hillshade-illumination-direction")*(Math.PI/180);re.paint.get("hillshade-illumination-anchor")==="viewport"&&(le-=K.transform.angle);var pe,ve,Ie,Ee=!K.options.moving;return{u_matrix:K.transform.calculatePosMatrix(X.tileID.toUnwrapped(),Ee),u_image:0,u_latrange:(pe=X.tileID,ve=Math.pow(2,pe.canonical.z),Ie=pe.canonical.y,[new a.MercatorCoordinate(0,Ie/ve).toLngLat().lat,new a.MercatorCoordinate(0,(Ie+1)/ve).toLngLat().lat]),u_light:[re.paint.get("hillshade-exaggeration"),le],u_shadow:te,u_highlight:ue,u_accent:Y}}(n,s,o);O.draw(S,z.TRIANGLES,c,_,w,he.disabled,G,o.id,n.rasterBoundsBuffer,n.quadTriangleIndexBuffer,n.rasterBoundsSegments)}}function Kh(n,s,o,c,_,w){var S=n.context,z=S.gl,P=s.dem;if(P&&P.data){var O=P.dim,G=P.stride,K=P.getPixels();if(S.activeTexture.set(z.TEXTURE1),S.pixelStoreUnpackPremultiplyAlpha.set(!1),s.demTexture=s.demTexture||n.getTileTexture(G),s.demTexture){var X=s.demTexture;X.update(K,{premultiply:!1}),X.bind(z.NEAREST,z.CLAMP_TO_EDGE)}else s.demTexture=new a.Texture(S,K,z.RGBA,{premultiply:!1}),s.demTexture.bind(z.NEAREST,z.CLAMP_TO_EDGE);S.activeTexture.set(z.TEXTURE0);var re=s.fbo;if(!re){var te=new a.Texture(S,{width:O,height:O,data:null},z.RGBA);te.bind(z.LINEAR,z.CLAMP_TO_EDGE),(re=s.fbo=S.createFramebuffer(O,O,!0)).colorAttachment.set(te.texture)}S.bindFramebuffer.set(re.framebuffer),S.viewport.set([0,0,O,O]),n.useProgram("hillshadePrepare").draw(S,z.TRIANGLES,c,_,w,he.disabled,function(ue,Y){var le=Y.stride,pe=a.create();return a.ortho(pe,0,a.EXTENT,-a.EXTENT,0,0,1),a.translate(pe,pe,[0,-a.EXTENT,0]),{u_matrix:pe,u_image:1,u_dimension:[le,le],u_zoom:ue.overscaledZ,u_unpack:Y.getUnpackVector()}}(s.tileID,P),o.id,n.rasterBoundsBuffer,n.quadTriangleIndexBuffer,n.rasterBoundsSegments),s.needsHillshadePrepare=!1}}function Xs(n,s,o,c,_){var w=c.paint.get("raster-fade-duration");if(w>0){var S=a.browser.now(),z=(S-n.timeAdded)/w,P=s?(S-s.timeAdded)/w:-1,O=o.getSource(),G=_.coveringZoomLevel({tileSize:O.tileSize,roundZoom:O.roundZoom}),K=!s||Math.abs(s.tileID.overscaledZ-G)>Math.abs(n.tileID.overscaledZ-G),X=K&&n.refreshedUponExpiration?1:a.clamp(K?z:1-P,0,1);return n.refreshedUponExpiration&&z>=1&&(n.refreshedUponExpiration=!1),s?{opacity:1,mix:1-X}:{opacity:X,mix:0}}return{opacity:1,mix:0}}var Hl=new a.Color(1,0,0,1),kc=new a.Color(0,1,0,1),Ec=new a.Color(0,0,1,1),Ws=new a.Color(1,0,1,1),Jl=new a.Color(0,1,1,1);function Yl(n,s,o,c){ms(n,0,s+o/2,n.transform.width,o,c)}function Ql(n,s,o,c){ms(n,s-o/2,0,o,n.transform.height,c)}function ms(n,s,o,c,_,w){var S=n.context,z=S.gl;z.enable(z.SCISSOR_TEST),z.scissor(s*a.browser.devicePixelRatio,o*a.browser.devicePixelRatio,c*a.browser.devicePixelRatio,_*a.browser.devicePixelRatio),S.clear({color:w}),z.disable(z.SCISSOR_TEST)}function Tc(n,s,o){var c=n.context,_=c.gl,w=o.posMatrix,S=n.useProgram("debug"),z=W.disabled,P=$.disabled,O=n.colorModeForRenderPass();c.activeTexture.set(_.TEXTURE0),n.emptyTexture.bind(_.LINEAR,_.CLAMP_TO_EDGE),S.draw(c,_.LINE_STRIP,z,P,O,he.disabled,bo(w,a.Color.red),"$debug",n.debugBuffer,n.tileBorderIndexBuffer,n.debugSegments);var G=s.getTileByID(o.key).latestRawTileData,K=Math.floor((G&&G.byteLength||0)/1024),X=s.getTile(o).tileSize,re=512/Math.min(X,512)*(o.overscaledZ/n.transform.zoom)*.5,te=o.canonical.toString();o.overscaledZ!==o.canonical.z&&(te+=" => "+o.overscaledZ),function(ue,Y){ue.initDebugOverlayCanvas();var le=ue.debugOverlayCanvas,pe=ue.context.gl,ve=ue.debugOverlayCanvas.getContext("2d");ve.clearRect(0,0,le.width,le.height),ve.shadowColor="white",ve.shadowBlur=2,ve.lineWidth=1.5,ve.strokeStyle="white",ve.textBaseline="top",ve.font="bold 36px Open Sans, sans-serif",ve.fillText(Y,5,5),ve.strokeText(Y,5,5),ue.debugOverlayTexture.update(le),ue.debugOverlayTexture.bind(pe.LINEAR,pe.CLAMP_TO_EDGE)}(n,te+" "+K+"kb"),S.draw(c,_.TRIANGLES,z,P,se.alphaBlended,he.disabled,bo(w,a.Color.transparent,re),"$debug",n.debugBuffer,n.quadTriangleIndexBuffer,n.debugSegments)}var So={symbol:function(n,s,o,c,_){if(n.renderPass==="translucent"){var w=$.disabled,S=n.colorModeForRenderPass();o.layout.get("text-variable-anchor")&&function(z,P,O,G,K,X,re){for(var te=P.transform,ue=K==="map",Y=X==="map",le=0,pe=z;le<pe.length;le+=1){var ve=pe[le],Ie=G.getTile(ve),Ee=Ie.getBucket(O);if(Ee&&Ee.text&&Ee.text.segments.get().length){var Ae=a.evaluateSizeForZoom(Ee.textSizeData,te.zoom),Re=Rr(Ie,1,P.transform.zoom),Ke=br(ve.posMatrix,Y,ue,P.transform,Re),Ze=O.layout.get("icon-text-fit")!=="none"&&Ee.hasIconData();if(Ae){var ot=Math.pow(2,te.zoom-Ie.tileID.overscaledZ);wc(Ee,ue,Y,re,a.symbolSize,te,Ke,ve.posMatrix,ot,Ae,Ze)}}}}(c,n,o,s,o.layout.get("text-rotation-alignment"),o.layout.get("text-pitch-alignment"),_),o.paint.get("icon-opacity").constantOr(1)!==0&&wo(n,s,o,c,!1,o.paint.get("icon-translate"),o.paint.get("icon-translate-anchor"),o.layout.get("icon-rotation-alignment"),o.layout.get("icon-pitch-alignment"),o.layout.get("icon-keep-upright"),w,S),o.paint.get("text-opacity").constantOr(1)!==0&&wo(n,s,o,c,!0,o.paint.get("text-translate"),o.paint.get("text-translate-anchor"),o.layout.get("text-rotation-alignment"),o.layout.get("text-pitch-alignment"),o.layout.get("text-keep-upright"),w,S),s.map.showCollisionBoxes&&(jo(n,s,o,c,o.paint.get("text-translate"),o.paint.get("text-translate-anchor"),!0),jo(n,s,o,c,o.paint.get("icon-translate"),o.paint.get("icon-translate-anchor"),!1))}},circle:function(n,s,o,c){if(n.renderPass==="translucent"){var _=o.paint.get("circle-opacity"),w=o.paint.get("circle-stroke-width"),S=o.paint.get("circle-stroke-opacity"),z=o.layout.get("circle-sort-key").constantOr(1)!==void 0;if(_.constantOr(1)!==0||w.constantOr(1)!==0&&S.constantOr(1)!==0){for(var P=n.context,O=P.gl,G=n.depthModeForSublayer(0,W.ReadOnly),K=$.disabled,X=n.colorModeForRenderPass(),re=[],te=0;te<c.length;te++){var ue=c[te],Y=s.getTile(ue),le=Y.getBucket(o);if(le){var pe=le.programConfigurations.get(o.id),ve={programConfiguration:pe,program:n.useProgram("circle",pe),layoutVertexBuffer:le.layoutVertexBuffer,indexBuffer:le.indexBuffer,uniformValues:Xl(n,ue,Y,o)};if(z)for(var Ie=0,Ee=le.segments.get();Ie<Ee.length;Ie+=1){var Ae=Ee[Ie];re.push({segments:new a.SegmentVector([Ae]),sortKey:Ae.sortKey,state:ve})}else re.push({segments:le.segments,sortKey:0,state:ve})}}z&&re.sort(function(wt,Tt){return wt.sortKey-Tt.sortKey});for(var Re=0,Ke=re;Re<Ke.length;Re+=1){var Ze=Ke[Re],ot=Ze.state;ot.program.draw(P,O.TRIANGLES,G,K,X,he.disabled,ot.uniformValues,o.id,ot.layoutVertexBuffer,ot.indexBuffer,Ze.segments,o.paint,n.transform.zoom,ot.programConfiguration)}}}},heatmap:function(n,s,o,c){if(o.paint.get("heatmap-opacity")!==0)if(n.renderPass==="offscreen"){var _=n.context,w=_.gl,S=$.disabled,z=new se([w.ONE,w.ONE],a.Color.transparent,[!0,!0,!0,!0]);(function(re,te,ue){var Y=re.gl;re.activeTexture.set(Y.TEXTURE1),re.viewport.set([0,0,te.width/4,te.height/4]);var le=ue.heatmapFbo;if(le)Y.bindTexture(Y.TEXTURE_2D,le.colorAttachment.get()),re.bindFramebuffer.set(le.framebuffer);else{var pe=Y.createTexture();Y.bindTexture(Y.TEXTURE_2D,pe),Y.texParameteri(Y.TEXTURE_2D,Y.TEXTURE_WRAP_S,Y.CLAMP_TO_EDGE),Y.texParameteri(Y.TEXTURE_2D,Y.TEXTURE_WRAP_T,Y.CLAMP_TO_EDGE),Y.texParameteri(Y.TEXTURE_2D,Y.TEXTURE_MIN_FILTER,Y.LINEAR),Y.texParameteri(Y.TEXTURE_2D,Y.TEXTURE_MAG_FILTER,Y.LINEAR),le=ue.heatmapFbo=re.createFramebuffer(te.width/4,te.height/4,!1),function(ve,Ie,Ee,Ae){var Re=ve.gl;Re.texImage2D(Re.TEXTURE_2D,0,Re.RGBA,Ie.width/4,Ie.height/4,0,Re.RGBA,ve.extRenderToTextureHalfFloat?ve.extTextureHalfFloat.HALF_FLOAT_OES:Re.UNSIGNED_BYTE,null),Ae.colorAttachment.set(Ee)}(re,te,pe,le)}})(_,n,o),_.clear({color:a.Color.transparent});for(var P=0;P<c.length;P++){var O=c[P];if(!s.hasRenderableParent(O)){var G=s.getTile(O),K=G.getBucket(o);if(K){var X=K.programConfigurations.get(o.id);n.useProgram("heatmap",X).draw(_,w.TRIANGLES,W.disabled,S,z,he.disabled,gc(O.posMatrix,G,n.transform.zoom,o.paint.get("heatmap-intensity")),o.id,K.layoutVertexBuffer,K.indexBuffer,K.segments,o.paint,n.transform.zoom,X)}}}_.viewport.set([0,0,n.width,n.height])}else n.renderPass==="translucent"&&(n.context.setColorMode(n.colorModeForRenderPass()),function(re,te){var ue=re.context,Y=ue.gl,le=te.heatmapFbo;if(le){ue.activeTexture.set(Y.TEXTURE0),Y.bindTexture(Y.TEXTURE_2D,le.colorAttachment.get()),ue.activeTexture.set(Y.TEXTURE1);var pe=te.colorRampTexture;pe||(pe=te.colorRampTexture=new a.Texture(ue,te.colorRamp,Y.RGBA)),pe.bind(Y.LINEAR,Y.CLAMP_TO_EDGE),re.useProgram("heatmapTexture").draw(ue,Y.TRIANGLES,W.disabled,$.disabled,re.colorModeForRenderPass(),he.disabled,function(ve,Ie,Ee,Ae){var Re=a.create();a.ortho(Re,0,ve.width,ve.height,0,0,1);var Ke=ve.context.gl;return{u_matrix:Re,u_world:[Ke.drawingBufferWidth,Ke.drawingBufferHeight],u_image:0,u_color_ramp:1,u_opacity:Ie.paint.get("heatmap-opacity")}}(re,te),te.id,re.viewportBuffer,re.quadTriangleIndexBuffer,re.viewportSegments,te.paint,re.transform.zoom)}}(n,o))},line:function(n,s,o,c){if(n.renderPass==="translucent"){var _=o.paint.get("line-opacity"),w=o.paint.get("line-width");if(_.constantOr(1)!==0&&w.constantOr(1)!==0)for(var S=n.depthModeForSublayer(0,W.ReadOnly),z=n.colorModeForRenderPass(),P=o.paint.get("line-dasharray"),O=o.paint.get("line-pattern"),G=O.constantOr(1),K=o.paint.get("line-gradient"),X=o.getCrossfadeParameters(),re=G?"linePattern":P?"lineSDF":K?"lineGradient":"line",te=n.context,ue=te.gl,Y=!0,le=0,pe=c;le<pe.length;le+=1){var ve=pe[le],Ie=s.getTile(ve);if(!G||Ie.patternsLoaded()){var Ee=Ie.getBucket(o);if(Ee){var Ae=Ee.programConfigurations.get(o.id),Re=n.context.program.get(),Ke=n.useProgram(re,Ae),Ze=Y||Ke.program!==Re,ot=O.constantOr(null);if(ot&&Ie.imageAtlas){var wt=Ie.imageAtlas,Tt=wt.patternPositions[ot.to.toString()],Et=wt.patternPositions[ot.from.toString()];Tt&&Et&&Ae.setConstantPatternPositions(Tt,Et)}var _r=G?js(n,Ie,o,X):P?Zh(n,Ie,o,P,X):K?Vr(n,Ie,o,Ee.lineClipsArray.length):hs(n,Ie,o);if(G)te.activeTexture.set(ue.TEXTURE0),Ie.imageAtlasTexture.bind(ue.LINEAR,ue.CLAMP_TO_EDGE),Ae.updatePaintBuffers(X);else if(P&&(Ze||n.lineAtlas.dirty))te.activeTexture.set(ue.TEXTURE0),n.lineAtlas.bind(te);else if(K){var lt=Ee.gradients[o.id],Ut=lt.texture;if(o.gradientVersion!==lt.version){var Yt=256;if(o.stepInterpolant){var Ft=s.getSource().maxzoom,Ot=ve.canonical.z===Ft?Math.ceil(1<<n.transform.maxZoom-ve.canonical.z):1;Yt=a.clamp(a.nextPowerOfTwo(Ee.maxLineLength/a.EXTENT*1024*Ot),256,te.maxTextureSize)}lt.gradient=a.renderColorRamp({expression:o.gradientExpression(),evaluationKey:"lineProgress",resolution:Yt,image:lt.gradient||void 0,clips:Ee.lineClipsArray}),lt.texture?lt.texture.update(lt.gradient):lt.texture=new a.Texture(te,lt.gradient,ue.RGBA),lt.version=o.gradientVersion,Ut=lt.texture}te.activeTexture.set(ue.TEXTURE0),Ut.bind(o.stepInterpolant?ue.NEAREST:ue.LINEAR,ue.CLAMP_TO_EDGE)}Ke.draw(te,ue.TRIANGLES,S,n.stencilModeForClipping(ve),z,he.disabled,_r,o.id,Ee.layoutVertexBuffer,Ee.indexBuffer,Ee.segments,o.paint,n.transform.zoom,Ae,Ee.layoutVertexBuffer2),Y=!1}}}}},fill:function(n,s,o,c){var _=o.paint.get("fill-color"),w=o.paint.get("fill-opacity");if(w.constantOr(1)!==0){var S=n.colorModeForRenderPass(),z=o.paint.get("fill-pattern"),P=n.opaquePassEnabledForLayer()&&!z.constantOr(1)&&_.constantOr(a.Color.transparent).a===1&&w.constantOr(0)===1?"opaque":"translucent";if(n.renderPass===P){var O=n.depthModeForSublayer(1,n.renderPass==="opaque"?W.ReadWrite:W.ReadOnly);Gs(n,s,o,c,O,S,!1)}if(n.renderPass==="translucent"&&o.paint.get("fill-antialias")){var G=n.depthModeForSublayer(o.getPaintProperty("fill-outline-color")?2:0,W.ReadOnly);Gs(n,s,o,c,G,S,!0)}}},"fill-extrusion":function(n,s,o,c){var _=o.paint.get("fill-extrusion-opacity");if(_!==0&&n.renderPass==="translucent"){var w=new W(n.context.gl.LEQUAL,W.ReadWrite,n.depthRangeFor3D);if(_!==1||o.paint.get("fill-extrusion-pattern").constantOr(1))Wl(n,s,o,c,w,$.disabled,se.disabled),Wl(n,s,o,c,w,n.stencilModeFor3D(),n.colorModeForRenderPass());else{var S=n.colorModeForRenderPass();Wl(n,s,o,c,w,$.disabled,S)}}},hillshade:function(n,s,o,c){if(n.renderPass==="offscreen"||n.renderPass==="translucent"){for(var _=n.context,w=n.depthModeForSublayer(0,W.ReadOnly),S=n.colorModeForRenderPass(),z=n.renderPass==="translucent"?n.stencilConfigForOverlap(c):[{},c],P=z[0],O=0,G=z[1];O<G.length;O+=1){var K=G[O],X=s.getTile(K);X.needsHillshadePrepare&&n.renderPass==="offscreen"?Kh(n,X,o,w,$.disabled,S):n.renderPass==="translucent"&&Ks(n,X,o,w,P[K.overscaledZ],S)}_.viewport.set([0,0,n.width,n.height])}},raster:function(n,s,o,c){if(n.renderPass==="translucent"&&o.paint.get("raster-opacity")!==0&&c.length)for(var _=n.context,w=_.gl,S=s.getSource(),z=n.useProgram("raster"),P=n.colorModeForRenderPass(),O=S instanceof At?[{},c]:n.stencilConfigForOverlap(c),G=O[0],K=O[1],X=K[K.length-1].overscaledZ,re=!n.options.moving,te=0,ue=K;te<ue.length;te+=1){var Y=ue[te],le=n.depthModeForSublayer(Y.overscaledZ-X,o.paint.get("raster-opacity")===1?W.ReadWrite:W.ReadOnly,w.LESS),pe=s.getTile(Y),ve=n.transform.calculatePosMatrix(Y.toUnwrapped(),re);pe.registerFadeDuration(o.paint.get("raster-fade-duration"));var Ie=s.findLoadedParent(Y,0),Ee=Xs(pe,Ie,s,o,n.transform),Ae=void 0,Re=void 0,Ke=o.paint.get("raster-resampling")==="nearest"?w.NEAREST:w.LINEAR;_.activeTexture.set(w.TEXTURE0),pe.texture.bind(Ke,w.CLAMP_TO_EDGE,w.LINEAR_MIPMAP_NEAREST),_.activeTexture.set(w.TEXTURE1),Ie?(Ie.texture.bind(Ke,w.CLAMP_TO_EDGE,w.LINEAR_MIPMAP_NEAREST),Ae=Math.pow(2,Ie.tileID.overscaledZ-pe.tileID.overscaledZ),Re=[pe.tileID.canonical.x*Ae%1,pe.tileID.canonical.y*Ae%1]):pe.texture.bind(Ke,w.CLAMP_TO_EDGE,w.LINEAR_MIPMAP_NEAREST);var Ze=Gh(ve,Re||[0,0],Ae||1,Ee,o);S instanceof At?z.draw(_,w.TRIANGLES,le,$.disabled,P,he.disabled,Ze,o.id,S.boundsBuffer,n.quadTriangleIndexBuffer,S.boundsSegments):z.draw(_,w.TRIANGLES,le,G[Y.overscaledZ],P,he.disabled,Ze,o.id,n.rasterBoundsBuffer,n.quadTriangleIndexBuffer,n.rasterBoundsSegments)}},background:function(n,s,o){var c=o.paint.get("background-color"),_=o.paint.get("background-opacity");if(_!==0){var w=n.context,S=w.gl,z=n.transform,P=z.tileSize,O=o.paint.get("background-pattern");if(!n.isPatternMissing(O)){var G=!O&&c.a===1&&_===1&&n.opaquePassEnabledForLayer()?"opaque":"translucent";if(n.renderPass===G){var K=$.disabled,X=n.depthModeForSublayer(0,G==="opaque"?W.ReadWrite:W.ReadOnly),re=n.colorModeForRenderPass(),te=n.useProgram(O?"backgroundPattern":"background"),ue=z.coveringTiles({tileSize:P});O&&(w.activeTexture.set(S.TEXTURE0),n.imageManager.bind(n.context));for(var Y=o.getCrossfadeParameters(),le=0,pe=ue;le<pe.length;le+=1){var ve=pe[le],Ie=n.transform.calculatePosMatrix(ve.toUnwrapped()),Ee=O?Vo(Ie,_,n,O,{tileID:ve,tileSize:P},Y):fs(Ie,_,c);te.draw(w,S.TRIANGLES,X,K,re,he.disabled,Ee,o.id,n.tileExtentBuffer,n.quadTriangleIndexBuffer,n.tileExtentSegments)}}}}},debug:function(n,s,o){for(var c=0;c<o.length;c++)Tc(n,s,o[c])},custom:function(n,s,o){var c=n.context,_=o.implementation;if(n.renderPass==="offscreen"){var w=_.prerender;w&&(n.setCustomLayerDefaults(),c.setColorMode(n.colorModeForRenderPass()),w.call(_,c.gl,n.transform.customLayerMatrix()),c.setDirty(),n.setBaseState())}else if(n.renderPass==="translucent"){n.setCustomLayerDefaults(),c.setColorMode(n.colorModeForRenderPass()),c.setStencilMode($.disabled);var S=_.renderingMode==="3d"?new W(n.context.gl.LEQUAL,W.ReadWrite,n.depthRangeFor3D):n.depthModeForSublayer(0,W.ReadOnly);c.setDepthMode(S),_.render(c.gl,n.transform.customLayerMatrix()),c.setDirty(),n.setBaseState(),c.bindFramebuffer.set(null)}}},Jr=function(n,s){this.context=new j(n),this.transform=s,this._tileTextures={},this.setup(),this.numSublayers=J.maxUnderzooming+J.maxOverzooming+1,this.depthEpsilon=1/Math.pow(2,16),this.crossTileSymbolIndex=new ye,this.gpuTimers={}};Jr.prototype.resize=function(n,s){if(this.width=n*a.browser.devicePixelRatio,this.height=s*a.browser.devicePixelRatio,this.context.viewport.set([0,0,this.width,this.height]),this.style)for(var o=0,c=this.style._order;o<c.length;o+=1)this.style._layers[c[o]].resize()},Jr.prototype.setup=function(){var n=this.context,s=new a.StructArrayLayout2i4;s.emplaceBack(0,0),s.emplaceBack(a.EXTENT,0),s.emplaceBack(0,a.EXTENT),s.emplaceBack(a.EXTENT,a.EXTENT),this.tileExtentBuffer=n.createVertexBuffer(s,xi.members),this.tileExtentSegments=a.SegmentVector.simpleSegment(0,0,4,2);var o=new a.StructArrayLayout2i4;o.emplaceBack(0,0),o.emplaceBack(a.EXTENT,0),o.emplaceBack(0,a.EXTENT),o.emplaceBack(a.EXTENT,a.EXTENT),this.debugBuffer=n.createVertexBuffer(o,xi.members),this.debugSegments=a.SegmentVector.simpleSegment(0,0,4,5);var c=new a.StructArrayLayout4i8;c.emplaceBack(0,0,0,0),c.emplaceBack(a.EXTENT,0,a.EXTENT,0),c.emplaceBack(0,a.EXTENT,0,a.EXTENT),c.emplaceBack(a.EXTENT,a.EXTENT,a.EXTENT,a.EXTENT),this.rasterBoundsBuffer=n.createVertexBuffer(c,We.members),this.rasterBoundsSegments=a.SegmentVector.simpleSegment(0,0,4,2);var _=new a.StructArrayLayout2i4;_.emplaceBack(0,0),_.emplaceBack(1,0),_.emplaceBack(0,1),_.emplaceBack(1,1),this.viewportBuffer=n.createVertexBuffer(_,xi.members),this.viewportSegments=a.SegmentVector.simpleSegment(0,0,4,2);var w=new a.StructArrayLayout1ui2;w.emplaceBack(0),w.emplaceBack(1),w.emplaceBack(3),w.emplaceBack(2),w.emplaceBack(0),this.tileBorderIndexBuffer=n.createIndexBuffer(w);var S=new a.StructArrayLayout3ui6;S.emplaceBack(0,1,2),S.emplaceBack(2,1,3),this.quadTriangleIndexBuffer=n.createIndexBuffer(S),this.emptyTexture=new a.Texture(n,{width:1,height:1,data:new Uint8Array([0,0,0,0])},n.gl.RGBA);var z=this.context.gl;this.stencilClearMode=new $({func:z.ALWAYS,mask:0},0,255,z.ZERO,z.ZERO,z.ZERO)},Jr.prototype.clearStencil=function(){var n=this.context,s=n.gl;this.nextStencilID=1,this.currentStencilSource=void 0;var o=a.create();a.ortho(o,0,this.width,this.height,0,0,1),a.scale(o,o,[s.drawingBufferWidth,s.drawingBufferHeight,0]),this.useProgram("clippingMask").draw(n,s.TRIANGLES,W.disabled,this.stencilClearMode,se.disabled,he.disabled,xo(o),"$clipping",this.viewportBuffer,this.quadTriangleIndexBuffer,this.viewportSegments)},Jr.prototype._renderTileClippingMasks=function(n,s){if(this.currentStencilSource!==n.source&&n.isTileClipped()&&s&&s.length){this.currentStencilSource=n.source;var o=this.context,c=o.gl;this.nextStencilID+s.length>256&&this.clearStencil(),o.setColorMode(se.disabled),o.setDepthMode(W.disabled);var _=this.useProgram("clippingMask");this._tileClippingMaskIDs={};for(var w=0,S=s;w<S.length;w+=1){var z=S[w],P=this._tileClippingMaskIDs[z.key]=this.nextStencilID++;_.draw(o,c.TRIANGLES,W.disabled,new $({func:c.ALWAYS,mask:0},P,255,c.KEEP,c.KEEP,c.REPLACE),se.disabled,he.disabled,xo(z.posMatrix),"$clipping",this.tileExtentBuffer,this.quadTriangleIndexBuffer,this.tileExtentSegments)}}},Jr.prototype.stencilModeFor3D=function(){this.currentStencilSource=void 0,this.nextStencilID+1>256&&this.clearStencil();var n=this.nextStencilID++,s=this.context.gl;return new $({func:s.NOTEQUAL,mask:255},n,255,s.KEEP,s.KEEP,s.REPLACE)},Jr.prototype.stencilModeForClipping=function(n){var s=this.context.gl;return new $({func:s.EQUAL,mask:255},this._tileClippingMaskIDs[n.key],0,s.KEEP,s.KEEP,s.REPLACE)},Jr.prototype.stencilConfigForOverlap=function(n){var s,o=this.context.gl,c=n.sort(function(P,O){return O.overscaledZ-P.overscaledZ}),_=c[c.length-1].overscaledZ,w=c[0].overscaledZ-_+1;if(w>1){this.currentStencilSource=void 0,this.nextStencilID+w>256&&this.clearStencil();for(var S={},z=0;z<w;z++)S[z+_]=new $({func:o.GEQUAL,mask:255},z+this.nextStencilID,255,o.KEEP,o.KEEP,o.REPLACE);return this.nextStencilID+=w,[S,c]}return[(s={},s[_]=$.disabled,s),c]},Jr.prototype.colorModeForRenderPass=function(){var n=this.context.gl;return this._showOverdrawInspector?new se([n.CONSTANT_COLOR,n.ONE],new a.Color(1/8,1/8,1/8,0),[!0,!0,!0,!0]):this.renderPass==="opaque"?se.unblended:se.alphaBlended},Jr.prototype.depthModeForSublayer=function(n,s,o){if(!this.opaquePassEnabledForLayer())return W.disabled;var c=1-((1+this.currentLayer)*this.numSublayers+n)*this.depthEpsilon;return new W(o||this.context.gl.LEQUAL,s,[c,c])},Jr.prototype.opaquePassEnabledForLayer=function(){return this.currentLayer<this.opaquePassCutoff},Jr.prototype.render=function(n,s){var o=this;this.style=n,this.options=s,this.lineAtlas=n.lineAtlas,this.imageManager=n.imageManager,this.glyphManager=n.glyphManager,this.symbolFadeChange=n.placement.symbolFadeChange(a.browser.now()),this.imageManager.beginFrame();var c=this.style._order,_=this.style.sourceCaches;for(var w in _){var S=_[w];S.used&&S.prepare(this.context)}var z,P,O={},G={},K={};for(var X in _){var re=_[X];O[X]=re.getVisibleCoordinates(),G[X]=O[X].slice().reverse(),K[X]=re.getVisibleCoordinates(!0).reverse()}this.opaquePassCutoff=1/0;for(var te=0;te<c.length;te++)if(this.style._layers[c[te]].is3D()){this.opaquePassCutoff=te;break}this.renderPass="offscreen";for(var ue=0,Y=c;ue<Y.length;ue+=1){var le=this.style._layers[Y[ue]];if(le.hasOffscreenPass()&&!le.isHidden(this.transform.zoom)){var pe=G[le.source];(le.type==="custom"||pe.length)&&this.renderLayer(this,_[le.source],le,pe)}}for(this.context.bindFramebuffer.set(null),this.context.clear({color:s.showOverdrawInspector?a.Color.black:a.Color.transparent,depth:1}),this.clearStencil(),this._showOverdrawInspector=s.showOverdrawInspector,this.depthRangeFor3D=[0,1-(n._order.length+2)*this.numSublayers*this.depthEpsilon],this.renderPass="opaque",this.currentLayer=c.length-1;this.currentLayer>=0;this.currentLayer--){var ve=this.style._layers[c[this.currentLayer]],Ie=_[ve.source],Ee=O[ve.source];this._renderTileClippingMasks(ve,Ee),this.renderLayer(this,Ie,ve,Ee)}for(this.renderPass="translucent",this.currentLayer=0;this.currentLayer<c.length;this.currentLayer++){var Ae=this.style._layers[c[this.currentLayer]],Re=_[Ae.source],Ke=(Ae.type==="symbol"?K:G)[Ae.source];this._renderTileClippingMasks(Ae,O[Ae.source]),this.renderLayer(this,Re,Ae,Ke)}this.options.showTileBoundaries&&(a.values(this.style._layers).forEach(function(Ze){Ze.source&&!Ze.isHidden(o.transform.zoom)&&(Ze.source!==(P&&P.id)&&(P=o.style.sourceCaches[Ze.source]),(!z||z.getSource().maxzoom<P.getSource().maxzoom)&&(z=P))}),z&&So.debug(this,z,z.getVisibleCoordinates())),this.options.showPadding&&function(Ze){var ot=Ze.transform.padding;Yl(Ze,Ze.transform.height-(ot.top||0),3,Hl),Yl(Ze,ot.bottom||0,3,kc),Ql(Ze,ot.left||0,3,Ec),Ql(Ze,Ze.transform.width-(ot.right||0),3,Ws);var wt=Ze.transform.centerPoint;(function(Tt,Et,_r,lt){ms(Tt,Et-1,_r-10,2,20,lt),ms(Tt,Et-10,_r-1,20,2,lt)})(Ze,wt.x,Ze.transform.height-wt.y,Jl)}(this),this.context.setDefault()},Jr.prototype.renderLayer=function(n,s,o,c){o.isHidden(this.transform.zoom)||(o.type==="background"||o.type==="custom"||c.length)&&(this.id=o.id,this.gpuTimingStart(o),So[o.type](n,s,o,c,this.style.placement.variableOffsets),this.gpuTimingEnd())},Jr.prototype.gpuTimingStart=function(n){if(this.options.gpuTiming){var s=this.context.extTimerQuery,o=this.gpuTimers[n.id];o||(o=this.gpuTimers[n.id]={calls:0,cpuTime:0,query:s.createQueryEXT()}),o.calls++,s.beginQueryEXT(s.TIME_ELAPSED_EXT,o.query)}},Jr.prototype.gpuTimingEnd=function(){if(this.options.gpuTiming){var n=this.context.extTimerQuery;n.endQueryEXT(n.TIME_ELAPSED_EXT)}},Jr.prototype.collectGpuTimers=function(){var n=this.gpuTimers;return this.gpuTimers={},n},Jr.prototype.queryGpuTimers=function(n){var s={};for(var o in n){var c=n[o],_=this.context.extTimerQuery,w=_.getQueryObjectEXT(c.query,_.QUERY_RESULT_EXT)/1e6;_.deleteQueryEXT(c.query),s[o]=w}return s},Jr.prototype.translatePosMatrix=function(n,s,o,c,_){if(!o[0]&&!o[1])return n;var w=_?c==="map"?this.transform.angle:0:c==="viewport"?-this.transform.angle:0;if(w){var S=Math.sin(w),z=Math.cos(w);o=[o[0]*z-o[1]*S,o[0]*S+o[1]*z]}var P=[_?o[0]:Rr(s,o[0],this.transform.zoom),_?o[1]:Rr(s,o[1],this.transform.zoom),0],O=new Float32Array(16);return a.translate(O,n,P),O},Jr.prototype.saveTileTexture=function(n){var s=this._tileTextures[n.size[0]];s?s.push(n):this._tileTextures[n.size[0]]=[n]},Jr.prototype.getTileTexture=function(n){var s=this._tileTextures[n];return s&&s.length>0?s.pop():null},Jr.prototype.isPatternMissing=function(n){if(!n)return!1;if(!n.from||!n.to)return!0;var s=this.imageManager.getPattern(n.from.toString()),o=this.imageManager.getPattern(n.to.toString());return!s||!o},Jr.prototype.useProgram=function(n,s){this.cache=this.cache||{};var o=""+n+(s?s.cacheKey:"")+(this._showOverdrawInspector?"/overdraw":"");return this.cache[o]||(this.cache[o]=new hc(this.context,n,qh[n],s,bc[n],this._showOverdrawInspector)),this.cache[o]},Jr.prototype.setCustomLayerDefaults=function(){this.context.unbindVAO(),this.context.cullFace.setDefault(),this.context.activeTexture.setDefault(),this.context.pixelStoreUnpack.setDefault(),this.context.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.context.pixelStoreUnpackFlipY.setDefault()},Jr.prototype.setBaseState=function(){var n=this.context.gl;this.context.cullFace.set(!1),this.context.viewport.set([0,0,this.width,this.height]),this.context.blendEquation.set(n.FUNC_ADD)},Jr.prototype.initDebugOverlayCanvas=function(){this.debugOverlayCanvas==null&&(this.debugOverlayCanvas=a.window.document.createElement("canvas"),this.debugOverlayCanvas.width=512,this.debugOverlayCanvas.height=512,this.debugOverlayTexture=new a.Texture(this.context,this.debugOverlayCanvas,this.context.gl.RGBA))},Jr.prototype.destroy=function(){this.emptyTexture.destroy(),this.debugOverlayTexture&&this.debugOverlayTexture.destroy()};var Hs=function(n,s){this.points=n,this.planes=s};Hs.fromInvProjectionMatrix=function(n,s,o){var c=Math.pow(2,o),_=[[-1,1,-1,1],[1,1,-1,1],[1,-1,-1,1],[-1,-1,-1,1],[-1,1,1,1],[1,1,1,1],[1,-1,1,1],[-1,-1,1,1]].map(function(S){return a.transformMat4([],S,n)}).map(function(S){return a.scale$1([],S,1/S[3]/s*c)}),w=[[0,1,2],[6,5,4],[0,3,7],[2,1,5],[3,2,6],[0,4,5]].map(function(S){var z=a.sub([],_[S[0]],_[S[1]]),P=a.sub([],_[S[2]],_[S[1]]),O=a.normalize([],a.cross([],z,P)),G=-a.dot(O,_[S[1]]);return O.concat(G)});return new Hs(_,w)};var ko=function(n,s){this.min=n,this.max=s,this.center=a.scale$2([],a.add([],this.min,this.max),.5)};ko.prototype.quadrant=function(n){for(var s=[n%2==0,n<2],o=a.clone$2(this.min),c=a.clone$2(this.max),_=0;_<s.length;_++)o[_]=s[_]?this.min[_]:this.center[_],c[_]=s[_]?this.center[_]:this.max[_];return c[2]=this.max[2],new ko(o,c)},ko.prototype.distanceX=function(n){return Math.max(Math.min(this.max[0],n[0]),this.min[0])-n[0]},ko.prototype.distanceY=function(n){return Math.max(Math.min(this.max[1],n[1]),this.min[1])-n[1]},ko.prototype.intersects=function(n){for(var s=[[this.min[0],this.min[1],0,1],[this.max[0],this.min[1],0,1],[this.max[0],this.max[1],0,1],[this.min[0],this.max[1],0,1]],o=!0,c=0;c<n.planes.length;c++){for(var _=n.planes[c],w=0,S=0;S<s.length;S++)w+=a.dot$1(_,s[S])>=0;if(w===0)return 0;w!==s.length&&(o=!1)}if(o)return 2;for(var z=0;z<3;z++){for(var P=Number.MAX_VALUE,O=-Number.MAX_VALUE,G=0;G<n.points.length;G++){var K=n.points[G][z]-this.min[z];P=Math.min(P,K),O=Math.max(O,K)}if(O<0||P>this.max[z]-this.min[z])return 0}return 1};var Wa=function(n,s,o,c){if(n===void 0&&(n=0),s===void 0&&(s=0),o===void 0&&(o=0),c===void 0&&(c=0),isNaN(n)||n<0||isNaN(s)||s<0||isNaN(o)||o<0||isNaN(c)||c<0)throw new Error("Invalid value for edge-insets, top, bottom, left and right must all be numbers");this.top=n,this.bottom=s,this.left=o,this.right=c};Wa.prototype.interpolate=function(n,s,o){return s.top!=null&&n.top!=null&&(this.top=a.number(n.top,s.top,o)),s.bottom!=null&&n.bottom!=null&&(this.bottom=a.number(n.bottom,s.bottom,o)),s.left!=null&&n.left!=null&&(this.left=a.number(n.left,s.left,o)),s.right!=null&&n.right!=null&&(this.right=a.number(n.right,s.right,o)),this},Wa.prototype.getCenter=function(n,s){var o=a.clamp((this.left+n-this.right)/2,0,n),c=a.clamp((this.top+s-this.bottom)/2,0,s);return new a.Point(o,c)},Wa.prototype.equals=function(n){return this.top===n.top&&this.bottom===n.bottom&&this.left===n.left&&this.right===n.right},Wa.prototype.clone=function(){return new Wa(this.top,this.bottom,this.left,this.right)},Wa.prototype.toJSON=function(){return{top:this.top,bottom:this.bottom,left:this.left,right:this.right}};var dr=function(n,s,o,c,_){this.tileSize=512,this.maxValidLatitude=85.051129,this._renderWorldCopies=_===void 0||_,this._minZoom=n||0,this._maxZoom=s||22,this._minPitch=o??0,this._maxPitch=c??60,this.setMaxBounds(),this.width=0,this.height=0,this._center=new a.LngLat(0,0),this.zoom=0,this.angle=0,this._fov=.6435011087932844,this._pitch=0,this._unmodified=!0,this._edgeInsets=new Wa,this._posMatrixCache={},this._alignedPosMatrixCache={}},jr={minZoom:{configurable:!0},maxZoom:{configurable:!0},minPitch:{configurable:!0},maxPitch:{configurable:!0},renderWorldCopies:{configurable:!0},worldSize:{configurable:!0},centerOffset:{configurable:!0},size:{configurable:!0},bearing:{configurable:!0},pitch:{configurable:!0},fov:{configurable:!0},zoom:{configurable:!0},center:{configurable:!0},padding:{configurable:!0},centerPoint:{configurable:!0},unmodified:{configurable:!0},point:{configurable:!0}};dr.prototype.clone=function(){var n=new dr(this._minZoom,this._maxZoom,this._minPitch,this.maxPitch,this._renderWorldCopies);return n.tileSize=this.tileSize,n.latRange=this.latRange,n.width=this.width,n.height=this.height,n._center=this._center,n.zoom=this.zoom,n.angle=this.angle,n._fov=this._fov,n._pitch=this._pitch,n._unmodified=this._unmodified,n._edgeInsets=this._edgeInsets.clone(),n._calcMatrices(),n},jr.minZoom.get=function(){return this._minZoom},jr.minZoom.set=function(n){this._minZoom!==n&&(this._minZoom=n,this.zoom=Math.max(this.zoom,n))},jr.maxZoom.get=function(){return this._maxZoom},jr.maxZoom.set=function(n){this._maxZoom!==n&&(this._maxZoom=n,this.zoom=Math.min(this.zoom,n))},jr.minPitch.get=function(){return this._minPitch},jr.minPitch.set=function(n){this._minPitch!==n&&(this._minPitch=n,this.pitch=Math.max(this.pitch,n))},jr.maxPitch.get=function(){return this._maxPitch},jr.maxPitch.set=function(n){this._maxPitch!==n&&(this._maxPitch=n,this.pitch=Math.min(this.pitch,n))},jr.renderWorldCopies.get=function(){return this._renderWorldCopies},jr.renderWorldCopies.set=function(n){n===void 0?n=!0:n===null&&(n=!1),this._renderWorldCopies=n},jr.worldSize.get=function(){return this.tileSize*this.scale},jr.centerOffset.get=function(){return this.centerPoint._sub(this.size._div(2))},jr.size.get=function(){return new a.Point(this.width,this.height)},jr.bearing.get=function(){return-this.angle/Math.PI*180},jr.bearing.set=function(n){var s=-a.wrap(n,-180,180)*Math.PI/180;this.angle!==s&&(this._unmodified=!1,this.angle=s,this._calcMatrices(),this.rotationMatrix=a.create$2(),a.rotate(this.rotationMatrix,this.rotationMatrix,this.angle))},jr.pitch.get=function(){return this._pitch/Math.PI*180},jr.pitch.set=function(n){var s=a.clamp(n,this.minPitch,this.maxPitch)/180*Math.PI;this._pitch!==s&&(this._unmodified=!1,this._pitch=s,this._calcMatrices())},jr.fov.get=function(){return this._fov/Math.PI*180},jr.fov.set=function(n){n=Math.max(.01,Math.min(60,n)),this._fov!==n&&(this._unmodified=!1,this._fov=n/180*Math.PI,this._calcMatrices())},jr.zoom.get=function(){return this._zoom},jr.zoom.set=function(n){var s=Math.min(Math.max(n,this.minZoom),this.maxZoom);this._zoom!==s&&(this._unmodified=!1,this._zoom=s,this.scale=this.zoomScale(s),this.tileZoom=Math.floor(s),this.zoomFraction=s-this.tileZoom,this._constrain(),this._calcMatrices())},jr.center.get=function(){return this._center},jr.center.set=function(n){n.lat===this._center.lat&&n.lng===this._center.lng||(this._unmodified=!1,this._center=n,this._constrain(),this._calcMatrices())},jr.padding.get=function(){return this._edgeInsets.toJSON()},jr.padding.set=function(n){this._edgeInsets.equals(n)||(this._unmodified=!1,this._edgeInsets.interpolate(this._edgeInsets,n,1),this._calcMatrices())},jr.centerPoint.get=function(){return this._edgeInsets.getCenter(this.width,this.height)},dr.prototype.isPaddingEqual=function(n){return this._edgeInsets.equals(n)},dr.prototype.interpolatePadding=function(n,s,o){this._unmodified=!1,this._edgeInsets.interpolate(n,s,o),this._constrain(),this._calcMatrices()},dr.prototype.coveringZoomLevel=function(n){var s=(n.roundZoom?Math.round:Math.floor)(this.zoom+this.scaleZoom(this.tileSize/n.tileSize));return Math.max(0,s)},dr.prototype.getVisibleUnwrappedCoordinates=function(n){var s=[new a.UnwrappedTileID(0,n)];if(this._renderWorldCopies)for(var o=this.pointCoordinate(new a.Point(0,0)),c=this.pointCoordinate(new a.Point(this.width,0)),_=this.pointCoordinate(new a.Point(this.width,this.height)),w=this.pointCoordinate(new a.Point(0,this.height)),S=Math.floor(Math.min(o.x,c.x,_.x,w.x)),z=Math.floor(Math.max(o.x,c.x,_.x,w.x)),P=S-1;P<=z+1;P++)P!==0&&s.push(new a.UnwrappedTileID(P,n));return s},dr.prototype.coveringTiles=function(n){var s=this.coveringZoomLevel(n),o=s;if(n.minzoom!==void 0&&s<n.minzoom)return[];n.maxzoom!==void 0&&s>n.maxzoom&&(s=n.maxzoom);var c=a.MercatorCoordinate.fromLngLat(this.center),_=Math.pow(2,s),w=[_*c.x,_*c.y,0],S=Hs.fromInvProjectionMatrix(this.invProjMatrix,this.worldSize,s),z=n.minzoom||0;this.pitch<=60&&this._edgeInsets.top<.1&&(z=s);var P=function(Ze){return{aabb:new ko([Ze*_,0,0],[(Ze+1)*_,_,0]),zoom:0,x:0,y:0,wrap:Ze,fullyVisible:!1}},O=[],G=[],K=s,X=n.reparseOverscaled?o:s;if(this._renderWorldCopies)for(var re=1;re<=3;re++)O.push(P(-re)),O.push(P(re));for(O.push(P(0));O.length>0;){var te=O.pop(),ue=te.x,Y=te.y,le=te.fullyVisible;if(!le){var pe=te.aabb.intersects(S);if(pe===0)continue;le=pe===2}var ve=te.aabb.distanceX(w),Ie=te.aabb.distanceY(w),Ee=Math.max(Math.abs(ve),Math.abs(Ie));if(te.zoom===K||Ee>3+(1<<K-te.zoom)-2&&te.zoom>=z)G.push({tileID:new a.OverscaledTileID(te.zoom===K?X:te.zoom,te.wrap,te.zoom,ue,Y),distanceSq:a.sqrLen([w[0]-.5-ue,w[1]-.5-Y])});else for(var Ae=0;Ae<4;Ae++){var Re=(ue<<1)+Ae%2,Ke=(Y<<1)+(Ae>>1);O.push({aabb:te.aabb.quadrant(Ae),zoom:te.zoom+1,x:Re,y:Ke,wrap:te.wrap,fullyVisible:le})}}return G.sort(function(Ze,ot){return Ze.distanceSq-ot.distanceSq}).map(function(Ze){return Ze.tileID})},dr.prototype.resize=function(n,s){this.width=n,this.height=s,this.pixelsToGLUnits=[2/n,-2/s],this._constrain(),this._calcMatrices()},jr.unmodified.get=function(){return this._unmodified},dr.prototype.zoomScale=function(n){return Math.pow(2,n)},dr.prototype.scaleZoom=function(n){return Math.log(n)/Math.LN2},dr.prototype.project=function(n){var s=a.clamp(n.lat,-this.maxValidLatitude,this.maxValidLatitude);return new a.Point(a.mercatorXfromLng(n.lng)*this.worldSize,a.mercatorYfromLat(s)*this.worldSize)},dr.prototype.unproject=function(n){return new a.MercatorCoordinate(n.x/this.worldSize,n.y/this.worldSize).toLngLat()},jr.point.get=function(){return this.project(this.center)},dr.prototype.setLocationAtPoint=function(n,s){var o=this.pointCoordinate(s),c=this.pointCoordinate(this.centerPoint),_=this.locationCoordinate(n),w=new a.MercatorCoordinate(_.x-(o.x-c.x),_.y-(o.y-c.y));this.center=this.coordinateLocation(w),this._renderWorldCopies&&(this.center=this.center.wrap())},dr.prototype.locationPoint=function(n){return this.coordinatePoint(this.locationCoordinate(n))},dr.prototype.pointLocation=function(n){return this.coordinateLocation(this.pointCoordinate(n))},dr.prototype.locationCoordinate=function(n){return a.MercatorCoordinate.fromLngLat(n)},dr.prototype.coordinateLocation=function(n){return n.toLngLat()},dr.prototype.pointCoordinate=function(n){var s=[n.x,n.y,0,1],o=[n.x,n.y,1,1];a.transformMat4(s,s,this.pixelMatrixInverse),a.transformMat4(o,o,this.pixelMatrixInverse);var c=s[3],_=o[3],w=s[1]/c,S=o[1]/_,z=s[2]/c,P=o[2]/_,O=z===P?0:(0-z)/(P-z);return new a.MercatorCoordinate(a.number(s[0]/c,o[0]/_,O)/this.worldSize,a.number(w,S,O)/this.worldSize)},dr.prototype.coordinatePoint=function(n){var s=[n.x*this.worldSize,n.y*this.worldSize,0,1];return a.transformMat4(s,s,this.pixelMatrix),new a.Point(s[0]/s[3],s[1]/s[3])},dr.prototype.getBounds=function(){return new a.LngLatBounds().extend(this.pointLocation(new a.Point(0,0))).extend(this.pointLocation(new a.Point(this.width,0))).extend(this.pointLocation(new a.Point(this.width,this.height))).extend(this.pointLocation(new a.Point(0,this.height)))},dr.prototype.getMaxBounds=function(){return this.latRange&&this.latRange.length===2&&this.lngRange&&this.lngRange.length===2?new a.LngLatBounds([this.lngRange[0],this.latRange[0]],[this.lngRange[1],this.latRange[1]]):null},dr.prototype.setMaxBounds=function(n){n?(this.lngRange=[n.getWest(),n.getEast()],this.latRange=[n.getSouth(),n.getNorth()],this._constrain()):(this.lngRange=null,this.latRange=[-this.maxValidLatitude,this.maxValidLatitude])},dr.prototype.calculatePosMatrix=function(n,s){s===void 0&&(s=!1);var o=n.key,c=s?this._alignedPosMatrixCache:this._posMatrixCache;if(c[o])return c[o];var _=n.canonical,w=this.worldSize/this.zoomScale(_.z),S=_.x+Math.pow(2,_.z)*n.wrap,z=a.identity(new Float64Array(16));return a.translate(z,z,[S*w,_.y*w,0]),a.scale(z,z,[w/a.EXTENT,w/a.EXTENT,1]),a.multiply(z,s?this.alignedProjMatrix:this.projMatrix,z),c[o]=new Float32Array(z),c[o]},dr.prototype.customLayerMatrix=function(){return this.mercatorMatrix.slice()},dr.prototype._constrain=function(){if(this.center&&this.width&&this.height&&!this._constraining){this._constraining=!0;var n,s,o,c,_=-90,w=90,S=-180,z=180,P=this.size,O=this._unmodified;if(this.latRange){var G=this.latRange;_=a.mercatorYfromLat(G[1])*this.worldSize,n=(w=a.mercatorYfromLat(G[0])*this.worldSize)-_<P.y?P.y/(w-_):0}if(this.lngRange){var K=this.lngRange;S=a.mercatorXfromLng(K[0])*this.worldSize,s=(z=a.mercatorXfromLng(K[1])*this.worldSize)-S<P.x?P.x/(z-S):0}var X=this.point,re=Math.max(s||0,n||0);if(re)return this.center=this.unproject(new a.Point(s?(z+S)/2:X.x,n?(w+_)/2:X.y)),this.zoom+=this.scaleZoom(re),this._unmodified=O,void(this._constraining=!1);if(this.latRange){var te=X.y,ue=P.y/2;te-ue<_&&(c=_+ue),te+ue>w&&(c=w-ue)}if(this.lngRange){var Y=X.x,le=P.x/2;Y-le<S&&(o=S+le),Y+le>z&&(o=z-le)}o===void 0&&c===void 0||(this.center=this.unproject(new a.Point(o!==void 0?o:X.x,c!==void 0?c:X.y))),this._unmodified=O,this._constraining=!1}},dr.prototype._calcMatrices=function(){if(this.height){var n=this.centerOffset;this.cameraToCenterDistance=.5/Math.tan(this._fov/2)*this.height;var s=Math.PI/2+this._pitch,o=this._fov*(.5+n.y/this.height),c=Math.sin(o)*this.cameraToCenterDistance/Math.sin(a.clamp(Math.PI-s-o,.01,Math.PI-.01)),_=this.point,w=_.x,S=_.y,z=1.01*(Math.cos(Math.PI/2-this._pitch)*c+this.cameraToCenterDistance),P=this.height/50,O=new Float64Array(16);a.perspective(O,this._fov,this.width/this.height,P,z),O[8]=2*-n.x/this.width,O[9]=2*n.y/this.height,a.scale(O,O,[1,-1,1]),a.translate(O,O,[0,0,-this.cameraToCenterDistance]),a.rotateX(O,O,this._pitch),a.rotateZ(O,O,this.angle),a.translate(O,O,[-w,-S,0]),this.mercatorMatrix=a.scale([],O,[this.worldSize,this.worldSize,this.worldSize]),a.scale(O,O,[1,1,a.mercatorZfromAltitude(1,this.center.lat)*this.worldSize,1]),this.projMatrix=O,this.invProjMatrix=a.invert([],this.projMatrix);var G=this.width%2/2,K=this.height%2/2,X=Math.cos(this.angle),re=Math.sin(this.angle),te=w-Math.round(w)+X*G+re*K,ue=S-Math.round(S)+X*K+re*G,Y=new Float64Array(O);if(a.translate(Y,Y,[te>.5?te-1:te,ue>.5?ue-1:ue,0]),this.alignedProjMatrix=Y,O=a.create(),a.scale(O,O,[this.width/2,-this.height/2,1]),a.translate(O,O,[1,-1,0]),this.labelPlaneMatrix=O,O=a.create(),a.scale(O,O,[1,-1,1]),a.translate(O,O,[-1,-1,0]),a.scale(O,O,[2/this.width,2/this.height,1]),this.glCoordMatrix=O,this.pixelMatrix=a.multiply(new Float64Array(16),this.labelPlaneMatrix,this.projMatrix),!(O=a.invert(new Float64Array(16),this.pixelMatrix)))throw new Error("failed to invert matrix");this.pixelMatrixInverse=O,this._posMatrixCache={},this._alignedPosMatrixCache={}}},dr.prototype.maxPitchScaleFactor=function(){if(!this.pixelMatrixInverse)return 1;var n=this.pointCoordinate(new a.Point(0,0)),s=[n.x*this.worldSize,n.y*this.worldSize,0,1];return a.transformMat4(s,s,this.pixelMatrix)[3]/this.cameraToCenterDistance},dr.prototype.getCameraPoint=function(){var n=Math.tan(this._pitch)*(this.cameraToCenterDistance||1);return this.centerPoint.add(new a.Point(0,n))},dr.prototype.getCameraQueryGeometry=function(n){var s=this.getCameraPoint();if(n.length===1)return[n[0],s];for(var o=s.x,c=s.y,_=s.x,w=s.y,S=0,z=n;S<z.length;S+=1){var P=z[S];o=Math.min(o,P.x),c=Math.min(c,P.y),_=Math.max(_,P.x),w=Math.max(w,P.y)}return[new a.Point(o,c),new a.Point(_,c),new a.Point(_,w),new a.Point(o,w),new a.Point(o,c)]},Object.defineProperties(dr.prototype,jr);var ea=function(n){var s,o,c,_;this._hashName=n&&encodeURIComponent(n),a.bindAll(["_getCurrentHash","_onHashChange","_updateHash"],this),this._updateHash=(s=this._updateHashUnthrottled.bind(this),o=!1,c=null,_=function(){c=null,o&&(s(),c=setTimeout(_,300),o=!1)},function(){return o=!0,c||_(),c})};ea.prototype.addTo=function(n){return this._map=n,a.window.addEventListener("hashchange",this._onHashChange,!1),this._map.on("moveend",this._updateHash),this},ea.prototype.remove=function(){return a.window.removeEventListener("hashchange",this._onHashChange,!1),this._map.off("moveend",this._updateHash),clearTimeout(this._updateHash()),delete this._map,this},ea.prototype.getHashString=function(n){var s=this._map.getCenter(),o=Math.round(100*this._map.getZoom())/100,c=Math.ceil((o*Math.LN2+Math.log(512/360/.5))/Math.LN10),_=Math.pow(10,c),w=Math.round(s.lng*_)/_,S=Math.round(s.lat*_)/_,z=this._map.getBearing(),P=this._map.getPitch(),O="";if(O+=n?"/"+w+"/"+S+"/"+o:o+"/"+S+"/"+w,(z||P)&&(O+="/"+Math.round(10*z)/10),P&&(O+="/"+Math.round(P)),this._hashName){var G=this._hashName,K=!1,X=a.window.location.hash.slice(1).split("&").map(function(re){var te=re.split("=")[0];return te===G?(K=!0,te+"="+O):re}).filter(function(re){return re});return K||X.push(G+"="+O),"#"+X.join("&")}return"#"+O},ea.prototype._getCurrentHash=function(){var n,s=this,o=a.window.location.hash.replace("#","");return this._hashName?(o.split("&").map(function(c){return c.split("=")}).forEach(function(c){c[0]===s._hashName&&(n=c)}),(n&&n[1]||"").split("/")):o.split("/")},ea.prototype._onHashChange=function(){var n=this._getCurrentHash();if(n.length>=3&&!n.some(function(o){return isNaN(o)})){var s=this._map.dragRotate.isEnabled()&&this._map.touchZoomRotate.isEnabled()?+(n[3]||0):this._map.getBearing();return this._map.jumpTo({center:[+n[2],+n[1]],zoom:+n[0],bearing:s,pitch:+(n[4]||0)}),!0}return!1},ea.prototype._updateHashUnthrottled=function(){var n=a.window.location.href.replace(/(#.+)?$/,this.getHashString());try{a.window.history.replaceState(a.window.history.state,null,n)}catch{}};var ys={linearity:.3,easing:a.bezier(0,0,.3,1)},qo=a.extend({deceleration:2500,maxSpeed:1400},ys),gs=a.extend({deceleration:20,maxSpeed:1400},ys),Xh=a.extend({deceleration:1e3,maxSpeed:360},ys),Wh=a.extend({deceleration:1e3,maxSpeed:90},ys),_s=function(n){this._map=n,this.clear()};function vs(n,s){(!n.duration||n.duration<s.duration)&&(n.duration=s.duration,n.easing=s.easing)}function Ca(n,s,o){var c=o.maxSpeed,_=o.linearity,w=o.deceleration,S=a.clamp(n*_/(s/1e3),-c,c),z=Math.abs(S)/(w*_);return{easing:o.easing,duration:1e3*z,amount:S*(z/2)}}_s.prototype.clear=function(){this._inertiaBuffer=[]},_s.prototype.record=function(n){this._drainInertiaBuffer(),this._inertiaBuffer.push({time:a.browser.now(),settings:n})},_s.prototype._drainInertiaBuffer=function(){for(var n=this._inertiaBuffer,s=a.browser.now();n.length>0&&s-n[0].time>160;)n.shift()},_s.prototype._onMoveEnd=function(n){if(this._drainInertiaBuffer(),!(this._inertiaBuffer.length<2)){for(var s={zoom:0,bearing:0,pitch:0,pan:new a.Point(0,0),pinchAround:void 0,around:void 0},o=0,c=this._inertiaBuffer;o<c.length;o+=1){var _=c[o].settings;s.zoom+=_.zoomDelta||0,s.bearing+=_.bearingDelta||0,s.pitch+=_.pitchDelta||0,_.panDelta&&s.pan._add(_.panDelta),_.around&&(s.around=_.around),_.pinchAround&&(s.pinchAround=_.pinchAround)}var w=this._inertiaBuffer[this._inertiaBuffer.length-1].time-this._inertiaBuffer[0].time,S={};if(s.pan.mag()){var z=Ca(s.pan.mag(),w,a.extend({},qo,n||{}));S.offset=s.pan.mult(z.amount/s.pan.mag()),S.center=this._map.transform.center,vs(S,z)}if(s.zoom){var P=Ca(s.zoom,w,gs);S.zoom=this._map.transform.zoom+P.amount,vs(S,P)}if(s.bearing){var O=Ca(s.bearing,w,Xh);S.bearing=this._map.transform.bearing+a.clamp(O.amount,-179,179),vs(S,O)}if(s.pitch){var G=Ca(s.pitch,w,Wh);S.pitch=this._map.transform.pitch+G.amount,vs(S,G)}if(S.zoom||S.bearing){var K=s.pinchAround===void 0?s.around:s.pinchAround;S.around=K?this._map.unproject(K):this._map.getCenter()}return this.clear(),a.extend(S,{noMoveStart:!0})}};var zi=function(n){function s(c,_,w,S){S===void 0&&(S={});var z=E.mousePos(_.getCanvasContainer(),w),P=_.unproject(z);n.call(this,c,a.extend({point:z,lngLat:P,originalEvent:w},S)),this._defaultPrevented=!1,this.target=_}n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s;var o={defaultPrevented:{configurable:!0}};return s.prototype.preventDefault=function(){this._defaultPrevented=!0},o.defaultPrevented.get=function(){return this._defaultPrevented},Object.defineProperties(s.prototype,o),s}(a.Event),bs=function(n){function s(c,_,w){var S=c==="touchend"?w.changedTouches:w.touches,z=E.touchPos(_.getCanvasContainer(),S),P=z.map(function(K){return _.unproject(K)}),O=z.reduce(function(K,X,re,te){return K.add(X.div(te.length))},new a.Point(0,0)),G=_.unproject(O);n.call(this,c,{points:z,point:O,lngLats:P,lngLat:G,originalEvent:w}),this._defaultPrevented=!1}n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s;var o={defaultPrevented:{configurable:!0}};return s.prototype.preventDefault=function(){this._defaultPrevented=!0},o.defaultPrevented.get=function(){return this._defaultPrevented},Object.defineProperties(s.prototype,o),s}(a.Event),zc=function(n){function s(c,_,w){n.call(this,c,{originalEvent:w}),this._defaultPrevented=!1}n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s;var o={defaultPrevented:{configurable:!0}};return s.prototype.preventDefault=function(){this._defaultPrevented=!0},o.defaultPrevented.get=function(){return this._defaultPrevented},Object.defineProperties(s.prototype,o),s}(a.Event),wi=function(n,s){this._map=n,this._clickTolerance=s.clickTolerance};wi.prototype.reset=function(){delete this._mousedownPos},wi.prototype.wheel=function(n){return this._firePreventable(new zc(n.type,this._map,n))},wi.prototype.mousedown=function(n,s){return this._mousedownPos=s,this._firePreventable(new zi(n.type,this._map,n))},wi.prototype.mouseup=function(n){this._map.fire(new zi(n.type,this._map,n))},wi.prototype.click=function(n,s){this._mousedownPos&&this._mousedownPos.dist(s)>=this._clickTolerance||this._map.fire(new zi(n.type,this._map,n))},wi.prototype.dblclick=function(n){return this._firePreventable(new zi(n.type,this._map,n))},wi.prototype.mouseover=function(n){this._map.fire(new zi(n.type,this._map,n))},wi.prototype.mouseout=function(n){this._map.fire(new zi(n.type,this._map,n))},wi.prototype.touchstart=function(n){return this._firePreventable(new bs(n.type,this._map,n))},wi.prototype.touchmove=function(n){this._map.fire(new bs(n.type,this._map,n))},wi.prototype.touchend=function(n){this._map.fire(new bs(n.type,this._map,n))},wi.prototype.touchcancel=function(n){this._map.fire(new bs(n.type,this._map,n))},wi.prototype._firePreventable=function(n){if(this._map.fire(n),n.defaultPrevented)return{}},wi.prototype.isEnabled=function(){return!0},wi.prototype.isActive=function(){return!1},wi.prototype.enable=function(){},wi.prototype.disable=function(){};var ut=function(n){this._map=n};ut.prototype.reset=function(){this._delayContextMenu=!1,delete this._contextMenuEvent},ut.prototype.mousemove=function(n){this._map.fire(new zi(n.type,this._map,n))},ut.prototype.mousedown=function(){this._delayContextMenu=!0},ut.prototype.mouseup=function(){this._delayContextMenu=!1,this._contextMenuEvent&&(this._map.fire(new zi("contextmenu",this._map,this._contextMenuEvent)),delete this._contextMenuEvent)},ut.prototype.contextmenu=function(n){this._delayContextMenu?this._contextMenuEvent=n:this._map.fire(new zi(n.type,this._map,n)),this._map.listens("contextmenu")&&n.preventDefault()},ut.prototype.isEnabled=function(){return!0},ut.prototype.isActive=function(){return!1},ut.prototype.enable=function(){},ut.prototype.disable=function(){};var qn=function(n,s){this._map=n,this._el=n.getCanvasContainer(),this._container=n.getContainer(),this._clickTolerance=s.clickTolerance||1};function Js(n,s){for(var o={},c=0;c<n.length;c++)o[n[c].identifier]=s[c];return o}qn.prototype.isEnabled=function(){return!!this._enabled},qn.prototype.isActive=function(){return!!this._active},qn.prototype.enable=function(){this.isEnabled()||(this._enabled=!0)},qn.prototype.disable=function(){this.isEnabled()&&(this._enabled=!1)},qn.prototype.mousedown=function(n,s){this.isEnabled()&&n.shiftKey&&n.button===0&&(E.disableDrag(),this._startPos=this._lastPos=s,this._active=!0)},qn.prototype.mousemoveWindow=function(n,s){if(this._active){var o=s;if(!(this._lastPos.equals(o)||!this._box&&o.dist(this._startPos)<this._clickTolerance)){var c=this._startPos;this._lastPos=o,this._box||(this._box=E.create("div","mapboxgl-boxzoom",this._container),this._container.classList.add("mapboxgl-crosshair"),this._fireEvent("boxzoomstart",n));var _=Math.min(c.x,o.x),w=Math.max(c.x,o.x),S=Math.min(c.y,o.y),z=Math.max(c.y,o.y);E.setTransform(this._box,"translate("+_+"px,"+S+"px)"),this._box.style.width=w-_+"px",this._box.style.height=z-S+"px"}}},qn.prototype.mouseupWindow=function(n,s){var o=this;if(this._active&&n.button===0){var c=this._startPos,_=s;if(this.reset(),E.suppressClick(),c.x!==_.x||c.y!==_.y)return this._map.fire(new a.Event("boxzoomend",{originalEvent:n})),{cameraAnimation:function(w){return w.fitScreenCoordinates(c,_,o._map.getBearing(),{linear:!0})}};this._fireEvent("boxzoomcancel",n)}},qn.prototype.keydown=function(n){this._active&&n.keyCode===27&&(this.reset(),this._fireEvent("boxzoomcancel",n))},qn.prototype.blur=function(){this.reset()},qn.prototype.reset=function(){this._active=!1,this._container.classList.remove("mapboxgl-crosshair"),this._box&&(E.remove(this._box),this._box=null),E.enableDrag(),delete this._startPos,delete this._lastPos},qn.prototype._fireEvent=function(n,s){return this._map.fire(new a.Event(n,{originalEvent:s}))};var Zo=function(n){this.reset(),this.numTouches=n.numTouches};Zo.prototype.reset=function(){delete this.centroid,delete this.startTime,delete this.touches,this.aborted=!1},Zo.prototype.touchstart=function(n,s,o){(this.centroid||o.length>this.numTouches)&&(this.aborted=!0),this.aborted||(this.startTime===void 0&&(this.startTime=n.timeStamp),o.length===this.numTouches&&(this.centroid=function(c){for(var _=new a.Point(0,0),w=0,S=c;w<S.length;w+=1)_._add(S[w]);return _.div(c.length)}(s),this.touches=Js(o,s)))},Zo.prototype.touchmove=function(n,s,o){if(!this.aborted&&this.centroid){var c=Js(o,s);for(var _ in this.touches){var w=c[_];(!w||w.dist(this.touches[_])>30)&&(this.aborted=!0)}}},Zo.prototype.touchend=function(n,s,o){if((!this.centroid||n.timeStamp-this.startTime>500)&&(this.aborted=!0),o.length===0){var c=!this.aborted&&this.centroid;if(this.reset(),c)return c}};var da=function(n){this.singleTap=new Zo(n),this.numTaps=n.numTaps,this.reset()};da.prototype.reset=function(){this.lastTime=1/0,delete this.lastTap,this.count=0,this.singleTap.reset()},da.prototype.touchstart=function(n,s,o){this.singleTap.touchstart(n,s,o)},da.prototype.touchmove=function(n,s,o){this.singleTap.touchmove(n,s,o)},da.prototype.touchend=function(n,s,o){var c=this.singleTap.touchend(n,s,o);if(c){var _=n.timeStamp-this.lastTime<500,w=!this.lastTap||this.lastTap.dist(c)<30;if(_&&w||this.reset(),this.count++,this.lastTime=n.timeStamp,this.lastTap=c,this.count===this.numTaps)return this.reset(),c}};var Zn=function(){this._zoomIn=new da({numTouches:1,numTaps:2}),this._zoomOut=new da({numTouches:2,numTaps:1}),this.reset()};Zn.prototype.reset=function(){this._active=!1,this._zoomIn.reset(),this._zoomOut.reset()},Zn.prototype.touchstart=function(n,s,o){this._zoomIn.touchstart(n,s,o),this._zoomOut.touchstart(n,s,o)},Zn.prototype.touchmove=function(n,s,o){this._zoomIn.touchmove(n,s,o),this._zoomOut.touchmove(n,s,o)},Zn.prototype.touchend=function(n,s,o){var c=this,_=this._zoomIn.touchend(n,s,o),w=this._zoomOut.touchend(n,s,o);return _?(this._active=!0,n.preventDefault(),setTimeout(function(){return c.reset()},0),{cameraAnimation:function(S){return S.easeTo({duration:300,zoom:S.getZoom()+1,around:S.unproject(_)},{originalEvent:n})}}):w?(this._active=!0,n.preventDefault(),setTimeout(function(){return c.reset()},0),{cameraAnimation:function(S){return S.easeTo({duration:300,zoom:S.getZoom()-1,around:S.unproject(w)},{originalEvent:n})}}):void 0},Zn.prototype.touchcancel=function(){this.reset()},Zn.prototype.enable=function(){this._enabled=!0},Zn.prototype.disable=function(){this._enabled=!1,this.reset()},Zn.prototype.isEnabled=function(){return this._enabled},Zn.prototype.isActive=function(){return this._active};var $l={0:1,2:2},et=function(n){this.reset(),this._clickTolerance=n.clickTolerance||1};et.prototype.blur=function(){this.reset()},et.prototype.reset=function(){this._active=!1,this._moved=!1,delete this._lastPoint,delete this._eventButton},et.prototype._correctButton=function(n,s){return!1},et.prototype._move=function(n,s){return{}},et.prototype.mousedown=function(n,s){if(!this._lastPoint){var o=E.mouseButton(n);this._correctButton(n,o)&&(this._lastPoint=s,this._eventButton=o)}},et.prototype.mousemoveWindow=function(n,s){var o=this._lastPoint;if(o){if(n.preventDefault(),function(c,_){var w=$l[_];return c.buttons===void 0||(c.buttons&w)!==w}(n,this._eventButton))this.reset();else if(this._moved||!(s.dist(o)<this._clickTolerance))return this._moved=!0,this._lastPoint=s,this._move(o,s)}},et.prototype.mouseupWindow=function(n){this._lastPoint&&E.mouseButton(n)===this._eventButton&&(this._moved&&E.suppressClick(),this.reset())},et.prototype.enable=function(){this._enabled=!0},et.prototype.disable=function(){this._enabled=!1,this.reset()},et.prototype.isEnabled=function(){return this._enabled},et.prototype.isActive=function(){return this._active};var eu=function(n){function s(){n.apply(this,arguments)}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype.mousedown=function(o,c){n.prototype.mousedown.call(this,o,c),this._lastPoint&&(this._active=!0)},s.prototype._correctButton=function(o,c){return c===0&&!o.ctrlKey},s.prototype._move=function(o,c){return{around:c,panDelta:c.sub(o)}},s}(et),Ys=function(n){function s(){n.apply(this,arguments)}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype._correctButton=function(o,c){return c===0&&o.ctrlKey||c===2},s.prototype._move=function(o,c){var _=.8*(c.x-o.x);if(_)return this._active=!0,{bearingDelta:_}},s.prototype.contextmenu=function(o){o.preventDefault()},s}(et),tu=function(n){function s(){n.apply(this,arguments)}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype._correctButton=function(o,c){return c===0&&o.ctrlKey||c===2},s.prototype._move=function(o,c){var _=-.5*(c.y-o.y);if(_)return this._active=!0,{pitchDelta:_}},s.prototype.contextmenu=function(o){o.preventDefault()},s}(et),na=function(n){this._minTouches=1,this._clickTolerance=n.clickTolerance||1,this.reset()};na.prototype.reset=function(){this._active=!1,this._touches={},this._sum=new a.Point(0,0)},na.prototype.touchstart=function(n,s,o){return this._calculateTransform(n,s,o)},na.prototype.touchmove=function(n,s,o){if(this._active&&!(o.length<this._minTouches))return n.preventDefault(),this._calculateTransform(n,s,o)},na.prototype.touchend=function(n,s,o){this._calculateTransform(n,s,o),this._active&&o.length<this._minTouches&&this.reset()},na.prototype.touchcancel=function(){this.reset()},na.prototype._calculateTransform=function(n,s,o){o.length>0&&(this._active=!0);var c=Js(o,s),_=new a.Point(0,0),w=new a.Point(0,0),S=0;for(var z in c){var P=c[z],O=this._touches[z];O&&(_._add(P),w._add(P.sub(O)),S++,c[z]=P)}if(this._touches=c,!(S<this._minTouches)&&w.mag()){var G=w.div(S);if(this._sum._add(G),!(this._sum.mag()<this._clickTolerance))return{around:_.div(S),panDelta:G}}},na.prototype.enable=function(){this._enabled=!0},na.prototype.disable=function(){this._enabled=!1,this.reset()},na.prototype.isEnabled=function(){return this._enabled},na.prototype.isActive=function(){return this._active};var Gn=function(){this.reset()};function Qs(n,s,o){for(var c=0;c<n.length;c++)if(n[c].identifier===o)return s[c]}function $s(n,s){return Math.log(n/s)/Math.LN2}Gn.prototype.reset=function(){this._active=!1,delete this._firstTwoTouches},Gn.prototype._start=function(n){},Gn.prototype._move=function(n,s,o){return{}},Gn.prototype.touchstart=function(n,s,o){this._firstTwoTouches||o.length<2||(this._firstTwoTouches=[o[0].identifier,o[1].identifier],this._start([s[0],s[1]]))},Gn.prototype.touchmove=function(n,s,o){if(this._firstTwoTouches){n.preventDefault();var c=this._firstTwoTouches,_=c[1],w=Qs(o,s,c[0]),S=Qs(o,s,_);if(w&&S){var z=this._aroundCenter?null:w.add(S).div(2);return this._move([w,S],z,n)}}},Gn.prototype.touchend=function(n,s,o){if(this._firstTwoTouches){var c=this._firstTwoTouches,_=c[1],w=Qs(o,s,c[0]),S=Qs(o,s,_);w&&S||(this._active&&E.suppressClick(),this.reset())}},Gn.prototype.touchcancel=function(){this.reset()},Gn.prototype.enable=function(n){this._enabled=!0,this._aroundCenter=!!n&&n.around==="center"},Gn.prototype.disable=function(){this._enabled=!1,this.reset()},Gn.prototype.isEnabled=function(){return this._enabled},Gn.prototype.isActive=function(){return this._active};var Kn=function(n){function s(){n.apply(this,arguments)}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype.reset=function(){n.prototype.reset.call(this),delete this._distance,delete this._startDistance},s.prototype._start=function(o){this._startDistance=this._distance=o[0].dist(o[1])},s.prototype._move=function(o,c){var _=this._distance;if(this._distance=o[0].dist(o[1]),this._active||!(Math.abs($s(this._distance,this._startDistance))<.1))return this._active=!0,{zoomDelta:$s(this._distance,_),pinchAround:c}},s}(Gn);function Ma(n,s){return 180*n.angleWith(s)/Math.PI}var Ic=function(n){function s(){n.apply(this,arguments)}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype.reset=function(){n.prototype.reset.call(this),delete this._minDiameter,delete this._startVector,delete this._vector},s.prototype._start=function(o){this._startVector=this._vector=o[0].sub(o[1]),this._minDiameter=o[0].dist(o[1])},s.prototype._move=function(o,c){var _=this._vector;if(this._vector=o[0].sub(o[1]),this._active||!this._isBelowThreshold(this._vector))return this._active=!0,{bearingDelta:Ma(this._vector,_),pinchAround:c}},s.prototype._isBelowThreshold=function(o){this._minDiameter=Math.min(this._minDiameter,o.mag());var c=25/(Math.PI*this._minDiameter)*360,_=Ma(o,this._startVector);return Math.abs(_)<c},s}(Gn);function xs(n){return Math.abs(n.y)>Math.abs(n.x)}var ru=function(n){function s(){n.apply(this,arguments)}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype.reset=function(){n.prototype.reset.call(this),this._valid=void 0,delete this._firstMove,delete this._lastPoints},s.prototype._start=function(o){this._lastPoints=o,xs(o[0].sub(o[1]))&&(this._valid=!1)},s.prototype._move=function(o,c,_){var w=o[0].sub(this._lastPoints[0]),S=o[1].sub(this._lastPoints[1]);if(this._valid=this.gestureBeginsVertically(w,S,_.timeStamp),this._valid)return this._lastPoints=o,this._active=!0,{pitchDelta:(w.y+S.y)/2*-.5}},s.prototype.gestureBeginsVertically=function(o,c,_){if(this._valid!==void 0)return this._valid;var w=o.mag()>=2,S=c.mag()>=2;if(w||S){if(!w||!S)return this._firstMove===void 0&&(this._firstMove=_),_-this._firstMove<100&&void 0;var z=o.y>0==c.y>0;return xs(o)&&xs(c)&&z}},s}(Gn),iu={panStep:100,bearingStep:15,pitchStep:10},ma=function(){var n=iu;this._panStep=n.panStep,this._bearingStep=n.bearingStep,this._pitchStep=n.pitchStep,this._rotationDisabled=!1};function ta(n){return n*(2-n)}ma.prototype.blur=function(){this.reset()},ma.prototype.reset=function(){this._active=!1},ma.prototype.keydown=function(n){var s=this;if(!(n.altKey||n.ctrlKey||n.metaKey)){var o=0,c=0,_=0,w=0,S=0;switch(n.keyCode){case 61:case 107:case 171:case 187:o=1;break;case 189:case 109:case 173:o=-1;break;case 37:n.shiftKey?c=-1:(n.preventDefault(),w=-1);break;case 39:n.shiftKey?c=1:(n.preventDefault(),w=1);break;case 38:n.shiftKey?_=1:(n.preventDefault(),S=-1);break;case 40:n.shiftKey?_=-1:(n.preventDefault(),S=1);break;default:return}return this._rotationDisabled&&(c=0,_=0),{cameraAnimation:function(z){var P=z.getZoom();z.easeTo({duration:300,easeId:"keyboardHandler",easing:ta,zoom:o?Math.round(P)+o*(n.shiftKey?2:1):P,bearing:z.getBearing()+c*s._bearingStep,pitch:z.getPitch()+_*s._pitchStep,offset:[-w*s._panStep,-S*s._panStep],center:z.getCenter()},{originalEvent:n})}}}},ma.prototype.enable=function(){this._enabled=!0},ma.prototype.disable=function(){this._enabled=!1,this.reset()},ma.prototype.isEnabled=function(){return this._enabled},ma.prototype.isActive=function(){return this._active},ma.prototype.disableRotation=function(){this._rotationDisabled=!0},ma.prototype.enableRotation=function(){this._rotationDisabled=!1};var ur=function(n,s){this._map=n,this._el=n.getCanvasContainer(),this._handler=s,this._delta=0,this._defaultZoomRate=.01,this._wheelZoomRate=1/450,a.bindAll(["_onTimeout"],this)};ur.prototype.setZoomRate=function(n){this._defaultZoomRate=n},ur.prototype.setWheelZoomRate=function(n){this._wheelZoomRate=n},ur.prototype.isEnabled=function(){return!!this._enabled},ur.prototype.isActive=function(){return!!this._active||this._finishTimeout!==void 0},ur.prototype.isZooming=function(){return!!this._zooming},ur.prototype.enable=function(n){this.isEnabled()||(this._enabled=!0,this._aroundCenter=n&&n.around==="center")},ur.prototype.disable=function(){this.isEnabled()&&(this._enabled=!1)},ur.prototype.wheel=function(n){if(this.isEnabled()){var s=n.deltaMode===a.window.WheelEvent.DOM_DELTA_LINE?40*n.deltaY:n.deltaY,o=a.browser.now(),c=o-(this._lastWheelEventTime||0);this._lastWheelEventTime=o,s!==0&&s%4.000244140625==0?this._type="wheel":s!==0&&Math.abs(s)<4?this._type="trackpad":c>400?(this._type=null,this._lastValue=s,this._timeout=setTimeout(this._onTimeout,40,n)):this._type||(this._type=Math.abs(c*s)<200?"trackpad":"wheel",this._timeout&&(clearTimeout(this._timeout),this._timeout=null,s+=this._lastValue)),n.shiftKey&&s&&(s/=4),this._type&&(this._lastWheelEvent=n,this._delta-=s,this._active||this._start(n)),n.preventDefault()}},ur.prototype._onTimeout=function(n){this._type="wheel",this._delta-=this._lastValue,this._active||this._start(n)},ur.prototype._start=function(n){if(this._delta){this._frameId&&(this._frameId=null),this._active=!0,this.isZooming()||(this._zooming=!0),this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout);var s=E.mousePos(this._el,n);this._around=a.LngLat.convert(this._aroundCenter?this._map.getCenter():this._map.unproject(s)),this._aroundPoint=this._map.transform.locationPoint(this._around),this._frameId||(this._frameId=!0,this._handler._triggerRenderFrame())}},ur.prototype.renderFrame=function(){var n=this;if(this._frameId&&(this._frameId=null,this.isActive())){var s=this._map.transform;if(this._delta!==0){var o=this._type==="wheel"&&Math.abs(this._delta)>4.000244140625?this._wheelZoomRate:this._defaultZoomRate,c=2/(1+Math.exp(-Math.abs(this._delta*o)));this._delta<0&&c!==0&&(c=1/c);var _=typeof this._targetZoom=="number"?s.zoomScale(this._targetZoom):s.scale;this._targetZoom=Math.min(s.maxZoom,Math.max(s.minZoom,s.scaleZoom(_*c))),this._type==="wheel"&&(this._startZoom=s.zoom,this._easing=this._smoothOutEasing(200)),this._delta=0}var w,S=typeof this._targetZoom=="number"?this._targetZoom:s.zoom,z=this._startZoom,P=this._easing,O=!1;if(this._type==="wheel"&&z&&P){var G=Math.min((a.browser.now()-this._lastWheelEventTime)/200,1),K=P(G);w=a.number(z,S,K),G<1?this._frameId||(this._frameId=!0):O=!0}else w=S,O=!0;return this._active=!0,O&&(this._active=!1,this._finishTimeout=setTimeout(function(){n._zooming=!1,n._handler._triggerRenderFrame(),delete n._targetZoom,delete n._finishTimeout},200)),{noInertia:!0,needsRenderFrame:!O,zoomDelta:w-s.zoom,around:this._aroundPoint,originalEvent:this._lastWheelEvent}}},ur.prototype._smoothOutEasing=function(n){var s=a.ease;if(this._prevEase){var o=this._prevEase,c=(a.browser.now()-o.start)/o.duration,_=o.easing(c+.01)-o.easing(c),w=.27/Math.sqrt(_*_+1e-4)*.01,S=Math.sqrt(.0729-w*w);s=a.bezier(w,S,.25,1)}return this._prevEase={start:a.browser.now(),duration:n,easing:s},s},ur.prototype.blur=function(){this.reset()},ur.prototype.reset=function(){this._active=!1};var Ea=function(n,s){this._clickZoom=n,this._tapZoom=s};Ea.prototype.enable=function(){this._clickZoom.enable(),this._tapZoom.enable()},Ea.prototype.disable=function(){this._clickZoom.disable(),this._tapZoom.disable()},Ea.prototype.isEnabled=function(){return this._clickZoom.isEnabled()&&this._tapZoom.isEnabled()},Ea.prototype.isActive=function(){return this._clickZoom.isActive()||this._tapZoom.isActive()};var aa=function(){this.reset()};aa.prototype.reset=function(){this._active=!1},aa.prototype.blur=function(){this.reset()},aa.prototype.dblclick=function(n,s){return n.preventDefault(),{cameraAnimation:function(o){o.easeTo({duration:300,zoom:o.getZoom()+(n.shiftKey?-1:1),around:o.unproject(s)},{originalEvent:n})}}},aa.prototype.enable=function(){this._enabled=!0},aa.prototype.disable=function(){this._enabled=!1,this.reset()},aa.prototype.isEnabled=function(){return this._enabled},aa.prototype.isActive=function(){return this._active};var nn=function(){this._tap=new da({numTouches:1,numTaps:1}),this.reset()};nn.prototype.reset=function(){this._active=!1,delete this._swipePoint,delete this._swipeTouch,delete this._tapTime,this._tap.reset()},nn.prototype.touchstart=function(n,s,o){this._swipePoint||(this._tapTime&&n.timeStamp-this._tapTime>500&&this.reset(),this._tapTime?o.length>0&&(this._swipePoint=s[0],this._swipeTouch=o[0].identifier):this._tap.touchstart(n,s,o))},nn.prototype.touchmove=function(n,s,o){if(this._tapTime){if(this._swipePoint){if(o[0].identifier!==this._swipeTouch)return;var c=s[0],_=c.y-this._swipePoint.y;return this._swipePoint=c,n.preventDefault(),this._active=!0,{zoomDelta:_/128}}}else this._tap.touchmove(n,s,o)},nn.prototype.touchend=function(n,s,o){this._tapTime?this._swipePoint&&o.length===0&&this.reset():this._tap.touchend(n,s,o)&&(this._tapTime=n.timeStamp)},nn.prototype.touchcancel=function(){this.reset()},nn.prototype.enable=function(){this._enabled=!0},nn.prototype.disable=function(){this._enabled=!1,this.reset()},nn.prototype.isEnabled=function(){return this._enabled},nn.prototype.isActive=function(){return this._active};var Eo=function(n,s,o){this._el=n,this._mousePan=s,this._touchPan=o};Eo.prototype.enable=function(n){this._inertiaOptions=n||{},this._mousePan.enable(),this._touchPan.enable(),this._el.classList.add("mapboxgl-touch-drag-pan")},Eo.prototype.disable=function(){this._mousePan.disable(),this._touchPan.disable(),this._el.classList.remove("mapboxgl-touch-drag-pan")},Eo.prototype.isEnabled=function(){return this._mousePan.isEnabled()&&this._touchPan.isEnabled()},Eo.prototype.isActive=function(){return this._mousePan.isActive()||this._touchPan.isActive()};var Ha=function(n,s,o){this._pitchWithRotate=n.pitchWithRotate,this._mouseRotate=s,this._mousePitch=o};Ha.prototype.enable=function(){this._mouseRotate.enable(),this._pitchWithRotate&&this._mousePitch.enable()},Ha.prototype.disable=function(){this._mouseRotate.disable(),this._mousePitch.disable()},Ha.prototype.isEnabled=function(){return this._mouseRotate.isEnabled()&&(!this._pitchWithRotate||this._mousePitch.isEnabled())},Ha.prototype.isActive=function(){return this._mouseRotate.isActive()||this._mousePitch.isActive()};var ya=function(n,s,o,c){this._el=n,this._touchZoom=s,this._touchRotate=o,this._tapDragZoom=c,this._rotationDisabled=!1,this._enabled=!0};ya.prototype.enable=function(n){this._touchZoom.enable(n),this._rotationDisabled||this._touchRotate.enable(n),this._tapDragZoom.enable(),this._el.classList.add("mapboxgl-touch-zoom-rotate")},ya.prototype.disable=function(){this._touchZoom.disable(),this._touchRotate.disable(),this._tapDragZoom.disable(),this._el.classList.remove("mapboxgl-touch-zoom-rotate")},ya.prototype.isEnabled=function(){return this._touchZoom.isEnabled()&&(this._rotationDisabled||this._touchRotate.isEnabled())&&this._tapDragZoom.isEnabled()},ya.prototype.isActive=function(){return this._touchZoom.isActive()||this._touchRotate.isActive()||this._tapDragZoom.isActive()},ya.prototype.disableRotation=function(){this._rotationDisabled=!0,this._touchRotate.disable()},ya.prototype.enableRotation=function(){this._rotationDisabled=!1,this._touchZoom.isEnabled()&&this._touchRotate.enable()};var wn=function(n){return n.zoom||n.drag||n.pitch||n.rotate},ws=function(n){function s(){n.apply(this,arguments)}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s}(a.Event);function xt(n){return n.panDelta&&n.panDelta.mag()||n.zoomDelta||n.bearingDelta||n.pitchDelta}var ft=function(n,s){this._map=n,this._el=this._map.getCanvasContainer(),this._handlers=[],this._handlersById={},this._changes=[],this._inertia=new _s(n),this._bearingSnap=s.bearingSnap,this._previousActiveHandlers={},this._eventsInProgress={},this._addDefaultHandlers(s),a.bindAll(["handleEvent","handleWindowEvent"],this);var o=this._el;this._listeners=[[o,"touchstart",{passive:!0}],[o,"touchmove",{passive:!1}],[o,"touchend",void 0],[o,"touchcancel",void 0],[o,"mousedown",void 0],[o,"mousemove",void 0],[o,"mouseup",void 0],[a.window.document,"mousemove",{capture:!0}],[a.window.document,"mouseup",void 0],[o,"mouseover",void 0],[o,"mouseout",void 0],[o,"dblclick",void 0],[o,"click",void 0],[o,"keydown",{capture:!1}],[o,"keyup",void 0],[o,"wheel",{passive:!1}],[o,"contextmenu",void 0],[a.window,"blur",void 0]];for(var c=0,_=this._listeners;c<_.length;c+=1){var w=_[c],S=w[0];E.addEventListener(S,w[1],S===a.window.document?this.handleWindowEvent:this.handleEvent,w[2])}};ft.prototype.destroy=function(){for(var n=0,s=this._listeners;n<s.length;n+=1){var o=s[n],c=o[0];E.removeEventListener(c,o[1],c===a.window.document?this.handleWindowEvent:this.handleEvent,o[2])}},ft.prototype._addDefaultHandlers=function(n){var s=this._map,o=s.getCanvasContainer();this._add("mapEvent",new wi(s,n));var c=s.boxZoom=new qn(s,n);this._add("boxZoom",c);var _=new Zn,w=new aa;s.doubleClickZoom=new Ea(w,_),this._add("tapZoom",_),this._add("clickZoom",w);var S=new nn;this._add("tapDragZoom",S);var z=s.touchPitch=new ru;this._add("touchPitch",z);var P=new Ys(n),O=new tu(n);s.dragRotate=new Ha(n,P,O),this._add("mouseRotate",P,["mousePitch"]),this._add("mousePitch",O,["mouseRotate"]);var G=new eu(n),K=new na(n);s.dragPan=new Eo(o,G,K),this._add("mousePan",G),this._add("touchPan",K,["touchZoom","touchRotate"]);var X=new Ic,re=new Kn;s.touchZoomRotate=new ya(o,re,X,S),this._add("touchRotate",X,["touchPan","touchZoom"]),this._add("touchZoom",re,["touchPan","touchRotate"]);var te=s.scrollZoom=new ur(s,this);this._add("scrollZoom",te,["mousePan"]);var ue=s.keyboard=new ma;this._add("keyboard",ue),this._add("blockableMapEvent",new ut(s));for(var Y=0,le=["boxZoom","doubleClickZoom","tapDragZoom","touchPitch","dragRotate","dragPan","touchZoomRotate","scrollZoom","keyboard"];Y<le.length;Y+=1){var pe=le[Y];n.interactive&&n[pe]&&s[pe].enable(n[pe])}},ft.prototype._add=function(n,s,o){this._handlers.push({handlerName:n,handler:s,allowed:o}),this._handlersById[n]=s},ft.prototype.stop=function(n){if(!this._updatingCamera){for(var s=0,o=this._handlers;s<o.length;s+=1)o[s].handler.reset();this._inertia.clear(),this._fireEvents({},{},n),this._changes=[]}},ft.prototype.isActive=function(){for(var n=0,s=this._handlers;n<s.length;n+=1)if(s[n].handler.isActive())return!0;return!1},ft.prototype.isZooming=function(){return!!this._eventsInProgress.zoom||this._map.scrollZoom.isZooming()},ft.prototype.isRotating=function(){return!!this._eventsInProgress.rotate},ft.prototype.isMoving=function(){return!!wn(this._eventsInProgress)||this.isZooming()},ft.prototype._blockedByActive=function(n,s,o){for(var c in n)if(c!==o&&(!s||s.indexOf(c)<0))return!0;return!1},ft.prototype.handleWindowEvent=function(n){this.handleEvent(n,n.type+"Window")},ft.prototype._getMapTouches=function(n){for(var s=[],o=0,c=n;o<c.length;o+=1){var _=c[o];this._el.contains(_.target)&&s.push(_)}return s},ft.prototype.handleEvent=function(n,s){this._updatingCamera=!0;for(var o=n.type==="renderFrame"?void 0:n,c={needsRenderFrame:!1},_={},w={},S=n.touches?this._getMapTouches(n.touches):void 0,z=S?E.touchPos(this._el,S):E.mousePos(this._el,n),P=0,O=this._handlers;P<O.length;P+=1){var G=O[P],K=G.handlerName,X=G.handler,re=G.allowed;if(X.isEnabled()){var te=void 0;this._blockedByActive(w,re,K)?X.reset():X[s||n.type]&&(te=X[s||n.type](n,z,S),this.mergeHandlerResult(c,_,te,K,o),te&&te.needsRenderFrame&&this._triggerRenderFrame()),(te||X.isActive())&&(w[K]=X)}}var ue={};for(var Y in this._previousActiveHandlers)w[Y]||(ue[Y]=o);this._previousActiveHandlers=w,(Object.keys(ue).length||xt(c))&&(this._changes.push([c,_,ue]),this._triggerRenderFrame()),(Object.keys(w).length||xt(c))&&this._map._stop(!0),this._updatingCamera=!1;var le=c.cameraAnimation;le&&(this._inertia.clear(),this._fireEvents({},{},!0),this._changes=[],le(this._map))},ft.prototype.mergeHandlerResult=function(n,s,o,c,_){if(o){a.extend(n,o);var w={handlerName:c,originalEvent:o.originalEvent||_};o.zoomDelta!==void 0&&(s.zoom=w),o.panDelta!==void 0&&(s.drag=w),o.pitchDelta!==void 0&&(s.pitch=w),o.bearingDelta!==void 0&&(s.rotate=w)}},ft.prototype._applyChanges=function(){for(var n={},s={},o={},c=0,_=this._changes;c<_.length;c+=1){var w=_[c],S=w[0],z=w[1],P=w[2];S.panDelta&&(n.panDelta=(n.panDelta||new a.Point(0,0))._add(S.panDelta)),S.zoomDelta&&(n.zoomDelta=(n.zoomDelta||0)+S.zoomDelta),S.bearingDelta&&(n.bearingDelta=(n.bearingDelta||0)+S.bearingDelta),S.pitchDelta&&(n.pitchDelta=(n.pitchDelta||0)+S.pitchDelta),S.around!==void 0&&(n.around=S.around),S.pinchAround!==void 0&&(n.pinchAround=S.pinchAround),S.noInertia&&(n.noInertia=S.noInertia),a.extend(s,z),a.extend(o,P)}this._updateMapTransform(n,s,o),this._changes=[]},ft.prototype._updateMapTransform=function(n,s,o){var c=this._map,_=c.transform;if(!xt(n))return this._fireEvents(s,o,!0);var w=n.panDelta,S=n.zoomDelta,z=n.bearingDelta,P=n.pitchDelta,O=n.around,G=n.pinchAround;G!==void 0&&(O=G),c._stop(!0),O=O||c.transform.centerPoint;var K=_.pointLocation(w?O.sub(w):O);z&&(_.bearing+=z),P&&(_.pitch+=P),S&&(_.zoom+=S),_.setLocationAtPoint(K,O),this._map._update(),n.noInertia||this._inertia.record(n),this._fireEvents(s,o,!0)},ft.prototype._fireEvents=function(n,s,o){var c=this,_=wn(this._eventsInProgress),w=wn(n),S={};for(var z in n)this._eventsInProgress[z]||(S[z+"start"]=n[z].originalEvent),this._eventsInProgress[z]=n[z];for(var P in!_&&w&&this._fireEvent("movestart",w.originalEvent),S)this._fireEvent(P,S[P]);for(var O in w&&this._fireEvent("move",w.originalEvent),n)this._fireEvent(O,n[O].originalEvent);var G,K={};for(var X in this._eventsInProgress){var re=this._eventsInProgress[X],te=re.handlerName,ue=re.originalEvent;this._handlersById[te].isActive()||(delete this._eventsInProgress[X],K[X+"end"]=G=s[te]||ue)}for(var Y in K)this._fireEvent(Y,K[Y]);var le=wn(this._eventsInProgress);if(o&&(_||w)&&!le){this._updatingCamera=!0;var pe=this._inertia._onMoveEnd(this._map.dragPan._inertiaOptions),ve=function(Ie){return Ie!==0&&-c._bearingSnap<Ie&&Ie<c._bearingSnap};pe?(ve(pe.bearing||this._map.getBearing())&&(pe.bearing=0),this._map.easeTo(pe,{originalEvent:G})):(this._map.fire(new a.Event("moveend",{originalEvent:G})),ve(this._map.getBearing())&&this._map.resetNorth()),this._updatingCamera=!1}},ft.prototype._fireEvent=function(n,s){this._map.fire(new a.Event(n,s?{originalEvent:s}:{}))},ft.prototype._requestFrame=function(){var n=this;return this._map.triggerRepaint(),this._map._renderTaskQueue.add(function(s){delete n._frameId,n.handleEvent(new ws("renderFrame",{timeStamp:s})),n._applyChanges()})},ft.prototype._triggerRenderFrame=function(){this._frameId===void 0&&(this._frameId=this._requestFrame())};var el=function(n){function s(o,c){n.call(this),this._moving=!1,this._zooming=!1,this.transform=o,this._bearingSnap=c.bearingSnap,a.bindAll(["_renderFrameCallback"],this)}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype.getCenter=function(){return new a.LngLat(this.transform.center.lng,this.transform.center.lat)},s.prototype.setCenter=function(o,c){return this.jumpTo({center:o},c)},s.prototype.panBy=function(o,c,_){return o=a.Point.convert(o).mult(-1),this.panTo(this.transform.center,a.extend({offset:o},c),_)},s.prototype.panTo=function(o,c,_){return this.easeTo(a.extend({center:o},c),_)},s.prototype.getZoom=function(){return this.transform.zoom},s.prototype.setZoom=function(o,c){return this.jumpTo({zoom:o},c),this},s.prototype.zoomTo=function(o,c,_){return this.easeTo(a.extend({zoom:o},c),_)},s.prototype.zoomIn=function(o,c){return this.zoomTo(this.getZoom()+1,o,c),this},s.prototype.zoomOut=function(o,c){return this.zoomTo(this.getZoom()-1,o,c),this},s.prototype.getBearing=function(){return this.transform.bearing},s.prototype.setBearing=function(o,c){return this.jumpTo({bearing:o},c),this},s.prototype.getPadding=function(){return this.transform.padding},s.prototype.setPadding=function(o,c){return this.jumpTo({padding:o},c),this},s.prototype.rotateTo=function(o,c,_){return this.easeTo(a.extend({bearing:o},c),_)},s.prototype.resetNorth=function(o,c){return this.rotateTo(0,a.extend({duration:1e3},o),c),this},s.prototype.resetNorthPitch=function(o,c){return this.easeTo(a.extend({bearing:0,pitch:0,duration:1e3},o),c),this},s.prototype.snapToNorth=function(o,c){return Math.abs(this.getBearing())<this._bearingSnap?this.resetNorth(o,c):this},s.prototype.getPitch=function(){return this.transform.pitch},s.prototype.setPitch=function(o,c){return this.jumpTo({pitch:o},c),this},s.prototype.cameraForBounds=function(o,c){o=a.LngLatBounds.convert(o);var _=c&&c.bearing||0;return this._cameraForBoxAndBearing(o.getNorthWest(),o.getSouthEast(),_,c)},s.prototype._cameraForBoxAndBearing=function(o,c,_,w){var S={top:0,bottom:0,right:0,left:0};if(typeof(w=a.extend({padding:S,offset:[0,0],maxZoom:this.transform.maxZoom},w)).padding=="number"){var z=w.padding;w.padding={top:z,bottom:z,right:z,left:z}}w.padding=a.extend(S,w.padding);var P=this.transform,O=P.padding,G=P.project(a.LngLat.convert(o)),K=P.project(a.LngLat.convert(c)),X=G.rotate(-_*Math.PI/180),re=K.rotate(-_*Math.PI/180),te=new a.Point(Math.max(X.x,re.x),Math.max(X.y,re.y)),ue=new a.Point(Math.min(X.x,re.x),Math.min(X.y,re.y)),Y=te.sub(ue),le=(P.width-(O.left+O.right+w.padding.left+w.padding.right))/Y.x,pe=(P.height-(O.top+O.bottom+w.padding.top+w.padding.bottom))/Y.y;if(!(pe<0||le<0)){var ve=Math.min(P.scaleZoom(P.scale*Math.min(le,pe)),w.maxZoom),Ie=typeof w.offset.x=="number"?new a.Point(w.offset.x,w.offset.y):a.Point.convert(w.offset),Ee=new a.Point((w.padding.left-w.padding.right)/2,(w.padding.top-w.padding.bottom)/2).rotate(_*Math.PI/180),Ae=Ie.add(Ee).mult(P.scale/P.zoomScale(ve));return{center:P.unproject(G.add(K).div(2).sub(Ae)),zoom:ve,bearing:_}}a.warnOnce("Map cannot fit within canvas with the given bounds, padding, and/or offset.")},s.prototype.fitBounds=function(o,c,_){return this._fitInternal(this.cameraForBounds(o,c),c,_)},s.prototype.fitScreenCoordinates=function(o,c,_,w,S){return this._fitInternal(this._cameraForBoxAndBearing(this.transform.pointLocation(a.Point.convert(o)),this.transform.pointLocation(a.Point.convert(c)),_,w),w,S)},s.prototype._fitInternal=function(o,c,_){return o?(delete(c=a.extend(o,c)).padding,c.linear?this.easeTo(c,_):this.flyTo(c,_)):this},s.prototype.jumpTo=function(o,c){this.stop();var _=this.transform,w=!1,S=!1,z=!1;return"zoom"in o&&_.zoom!==+o.zoom&&(w=!0,_.zoom=+o.zoom),o.center!==void 0&&(_.center=a.LngLat.convert(o.center)),"bearing"in o&&_.bearing!==+o.bearing&&(S=!0,_.bearing=+o.bearing),"pitch"in o&&_.pitch!==+o.pitch&&(z=!0,_.pitch=+o.pitch),o.padding==null||_.isPaddingEqual(o.padding)||(_.padding=o.padding),this.fire(new a.Event("movestart",c)).fire(new a.Event("move",c)),w&&this.fire(new a.Event("zoomstart",c)).fire(new a.Event("zoom",c)).fire(new a.Event("zoomend",c)),S&&this.fire(new a.Event("rotatestart",c)).fire(new a.Event("rotate",c)).fire(new a.Event("rotateend",c)),z&&this.fire(new a.Event("pitchstart",c)).fire(new a.Event("pitch",c)).fire(new a.Event("pitchend",c)),this.fire(new a.Event("moveend",c))},s.prototype.easeTo=function(o,c){var _=this;this._stop(!1,o.easeId),((o=a.extend({offset:[0,0],duration:500,easing:a.ease},o)).animate===!1||!o.essential&&a.browser.prefersReducedMotion)&&(o.duration=0);var w=this.transform,S=this.getZoom(),z=this.getBearing(),P=this.getPitch(),O=this.getPadding(),G="zoom"in o?+o.zoom:S,K="bearing"in o?this._normalizeBearing(o.bearing,z):z,X="pitch"in o?+o.pitch:P,re="padding"in o?o.padding:w.padding,te=a.Point.convert(o.offset),ue=w.centerPoint.add(te),Y=w.pointLocation(ue),le=a.LngLat.convert(o.center||Y);this._normalizeCenter(le);var pe,ve,Ie=w.project(Y),Ee=w.project(le).sub(Ie),Ae=w.zoomScale(G-S);o.around&&(pe=a.LngLat.convert(o.around),ve=w.locationPoint(pe));var Re={moving:this._moving,zooming:this._zooming,rotating:this._rotating,pitching:this._pitching};return this._zooming=this._zooming||G!==S,this._rotating=this._rotating||z!==K,this._pitching=this._pitching||X!==P,this._padding=!w.isPaddingEqual(re),this._easeId=o.easeId,this._prepareEase(c,o.noMoveStart,Re),this._ease(function(Ke){if(_._zooming&&(w.zoom=a.number(S,G,Ke)),_._rotating&&(w.bearing=a.number(z,K,Ke)),_._pitching&&(w.pitch=a.number(P,X,Ke)),_._padding&&(w.interpolatePadding(O,re,Ke),ue=w.centerPoint.add(te)),pe)w.setLocationAtPoint(pe,ve);else{var Ze=w.zoomScale(w.zoom-S),ot=G>S?Math.min(2,Ae):Math.max(.5,Ae),wt=Math.pow(ot,1-Ke),Tt=w.unproject(Ie.add(Ee.mult(Ke*wt)).mult(Ze));w.setLocationAtPoint(w.renderWorldCopies?Tt.wrap():Tt,ue)}_._fireMoveEvents(c)},function(Ke){_._afterEase(c,Ke)},o),this},s.prototype._prepareEase=function(o,c,_){_===void 0&&(_={}),this._moving=!0,c||_.moving||this.fire(new a.Event("movestart",o)),this._zooming&&!_.zooming&&this.fire(new a.Event("zoomstart",o)),this._rotating&&!_.rotating&&this.fire(new a.Event("rotatestart",o)),this._pitching&&!_.pitching&&this.fire(new a.Event("pitchstart",o))},s.prototype._fireMoveEvents=function(o){this.fire(new a.Event("move",o)),this._zooming&&this.fire(new a.Event("zoom",o)),this._rotating&&this.fire(new a.Event("rotate",o)),this._pitching&&this.fire(new a.Event("pitch",o))},s.prototype._afterEase=function(o,c){if(!this._easeId||!c||this._easeId!==c){delete this._easeId;var _=this._zooming,w=this._rotating,S=this._pitching;this._moving=!1,this._zooming=!1,this._rotating=!1,this._pitching=!1,this._padding=!1,_&&this.fire(new a.Event("zoomend",o)),w&&this.fire(new a.Event("rotateend",o)),S&&this.fire(new a.Event("pitchend",o)),this.fire(new a.Event("moveend",o))}},s.prototype.flyTo=function(o,c){var _=this;if(!o.essential&&a.browser.prefersReducedMotion){var w=a.pick(o,["center","zoom","bearing","pitch","around"]);return this.jumpTo(w,c)}this.stop(),o=a.extend({offset:[0,0],speed:1.2,curve:1.42,easing:a.ease},o);var S=this.transform,z=this.getZoom(),P=this.getBearing(),O=this.getPitch(),G=this.getPadding(),K="zoom"in o?a.clamp(+o.zoom,S.minZoom,S.maxZoom):z,X="bearing"in o?this._normalizeBearing(o.bearing,P):P,re="pitch"in o?+o.pitch:O,te="padding"in o?o.padding:S.padding,ue=S.zoomScale(K-z),Y=a.Point.convert(o.offset),le=S.centerPoint.add(Y),pe=S.pointLocation(le),ve=a.LngLat.convert(o.center||pe);this._normalizeCenter(ve);var Ie=S.project(pe),Ee=S.project(ve).sub(Ie),Ae=o.curve,Re=Math.max(S.width,S.height),Ke=Re/ue,Ze=Ee.mag();if("minZoom"in o){var ot=a.clamp(Math.min(o.minZoom,z,K),S.minZoom,S.maxZoom),wt=Re/S.zoomScale(ot-z);Ae=Math.sqrt(wt/Ze*2)}var Tt=Ae*Ae;function Et(Bt){var Lt=(Ke*Ke-Re*Re+(Bt?-1:1)*Tt*Tt*Ze*Ze)/(2*(Bt?Ke:Re)*Tt*Ze);return Math.log(Math.sqrt(Lt*Lt+1)-Lt)}function _r(Bt){return(Math.exp(Bt)-Math.exp(-Bt))/2}function lt(Bt){return(Math.exp(Bt)+Math.exp(-Bt))/2}var Ut=Et(0),Yt=function(Bt){return lt(Ut)/lt(Ut+Ae*Bt)},Ft=function(Bt){return Re*((lt(Ut)*(_r(Lt=Ut+Ae*Bt)/lt(Lt))-_r(Ut))/Tt)/Ze;var Lt},Ot=(Et(1)-Ut)/Ae;if(Math.abs(Ze)<1e-6||!isFinite(Ot)){if(Math.abs(Re-Ke)<1e-6)return this.easeTo(o,c);var Ht=Ke<Re?-1:1;Ot=Math.abs(Math.log(Ke/Re))/Ae,Ft=function(){return 0},Yt=function(Bt){return Math.exp(Ht*Ae*Bt)}}return o.duration="duration"in o?+o.duration:1e3*Ot/("screenSpeed"in o?+o.screenSpeed/Ae:+o.speed),o.maxDuration&&o.duration>o.maxDuration&&(o.duration=0),this._zooming=!0,this._rotating=P!==X,this._pitching=re!==O,this._padding=!S.isPaddingEqual(te),this._prepareEase(c,!1),this._ease(function(Bt){var Lt=Bt*Ot,Li=1/Yt(Lt);S.zoom=Bt===1?K:z+S.scaleZoom(Li),_._rotating&&(S.bearing=a.number(P,X,Bt)),_._pitching&&(S.pitch=a.number(O,re,Bt)),_._padding&&(S.interpolatePadding(G,te,Bt),le=S.centerPoint.add(Y));var ui=Bt===1?ve:S.unproject(Ie.add(Ee.mult(Ft(Lt))).mult(Li));S.setLocationAtPoint(S.renderWorldCopies?ui.wrap():ui,le),_._fireMoveEvents(c)},function(){return _._afterEase(c)},o),this},s.prototype.isEasing=function(){return!!this._easeFrameId},s.prototype.stop=function(){return this._stop()},s.prototype._stop=function(o,c){if(this._easeFrameId&&(this._cancelRenderFrame(this._easeFrameId),delete this._easeFrameId,delete this._onEaseFrame),this._onEaseEnd){var _=this._onEaseEnd;delete this._onEaseEnd,_.call(this,c)}if(!o){var w=this.handlers;w&&w.stop(!1)}return this},s.prototype._ease=function(o,c,_){_.animate===!1||_.duration===0?(o(1),c()):(this._easeStart=a.browser.now(),this._easeOptions=_,this._onEaseFrame=o,this._onEaseEnd=c,this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback))},s.prototype._renderFrameCallback=function(){var o=Math.min((a.browser.now()-this._easeStart)/this._easeOptions.duration,1);this._onEaseFrame(this._easeOptions.easing(o)),o<1?this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback):this.stop()},s.prototype._normalizeBearing=function(o,c){o=a.wrap(o,-180,180);var _=Math.abs(o-c);return Math.abs(o-360-c)<_&&(o-=360),Math.abs(o+360-c)<_&&(o+=360),o},s.prototype._normalizeCenter=function(o){var c=this.transform;if(c.renderWorldCopies&&!c.lngRange){var _=o.lng-c.center.lng;o.lng+=_>180?-360:_<-180?360:0}},s}(a.Evented),Sn=function(n){n===void 0&&(n={}),this.options=n,a.bindAll(["_toggleAttribution","_updateEditLink","_updateData","_updateCompact"],this)};Sn.prototype.getDefaultPosition=function(){return"bottom-right"},Sn.prototype.onAdd=function(n){var s=this.options&&this.options.compact;return this._map=n,this._container=E.create("div","mapboxgl-ctrl mapboxgl-ctrl-attrib"),this._compactButton=E.create("button","mapboxgl-ctrl-attrib-button",this._container),this._compactButton.addEventListener("click",this._toggleAttribution),this._setElementTitle(this._compactButton,"ToggleAttribution"),this._innerContainer=E.create("div","mapboxgl-ctrl-attrib-inner",this._container),this._innerContainer.setAttribute("role","list"),s&&this._container.classList.add("mapboxgl-compact"),this._updateAttributions(),this._updateEditLink(),this._map.on("styledata",this._updateData),this._map.on("sourcedata",this._updateData),this._map.on("moveend",this._updateEditLink),s===void 0&&(this._map.on("resize",this._updateCompact),this._updateCompact()),this._container},Sn.prototype.onRemove=function(){E.remove(this._container),this._map.off("styledata",this._updateData),this._map.off("sourcedata",this._updateData),this._map.off("moveend",this._updateEditLink),this._map.off("resize",this._updateCompact),this._map=void 0,this._attribHTML=void 0},Sn.prototype._setElementTitle=function(n,s){var o=this._map._getUIString("AttributionControl."+s);n.title=o,n.setAttribute("aria-label",o)},Sn.prototype._toggleAttribution=function(){this._container.classList.contains("mapboxgl-compact-show")?(this._container.classList.remove("mapboxgl-compact-show"),this._compactButton.setAttribute("aria-pressed","false")):(this._container.classList.add("mapboxgl-compact-show"),this._compactButton.setAttribute("aria-pressed","true"))},Sn.prototype._updateEditLink=function(){var n=this._editLink;n||(n=this._editLink=this._container.querySelector(".mapbox-improve-map"));var s=[{key:"owner",value:this.styleOwner},{key:"id",value:this.styleId},{key:"access_token",value:this._map._requestManager._customAccessToken||a.config.ACCESS_TOKEN}];if(n){var o=s.reduce(function(c,_,w){return _.value&&(c+=_.key+"="+_.value+(w<s.length-1?"&":"")),c},"?");n.href=a.config.FEEDBACK_URL+"/"+o+(this._map._hash?this._map._hash.getHashString(!0):""),n.rel="noopener nofollow",this._setElementTitle(n,"MapFeedback")}},Sn.prototype._updateData=function(n){!n||n.sourceDataType!=="metadata"&&n.sourceDataType!=="visibility"&&n.dataType!=="style"||(this._updateAttributions(),this._updateEditLink())},Sn.prototype._updateAttributions=function(){if(this._map.style){var n=[];if(this.options.customAttribution&&(Array.isArray(this.options.customAttribution)?n=n.concat(this.options.customAttribution.map(function(z){return typeof z!="string"?"":z})):typeof this.options.customAttribution=="string"&&n.push(this.options.customAttribution)),this._map.style.stylesheet){var s=this._map.style.stylesheet;this.styleOwner=s.owner,this.styleId=s.id}var o=this._map.style.sourceCaches;for(var c in o){var _=o[c];if(_.used){var w=_.getSource();w.attribution&&n.indexOf(w.attribution)<0&&n.push(w.attribution)}}n.sort(function(z,P){return z.length-P.length});var S=(n=n.filter(function(z,P){for(var O=P+1;O<n.length;O++)if(n[O].indexOf(z)>=0)return!1;return!0})).join(" | ");S!==this._attribHTML&&(this._attribHTML=S,n.length?(this._innerContainer.innerHTML=S,this._container.classList.remove("mapboxgl-attrib-empty")):this._container.classList.add("mapboxgl-attrib-empty"),this._editLink=null)}},Sn.prototype._updateCompact=function(){this._map.getCanvasContainer().offsetWidth<=640?this._container.classList.add("mapboxgl-compact"):this._container.classList.remove("mapboxgl-compact","mapboxgl-compact-show")};var ga=function(){a.bindAll(["_updateLogo"],this),a.bindAll(["_updateCompact"],this)};ga.prototype.onAdd=function(n){this._map=n,this._container=E.create("div","mapboxgl-ctrl");var s=E.create("a","mapboxgl-ctrl-logo");return s.target="_blank",s.rel="noopener nofollow",s.href="https://www.mapbox.com/",s.setAttribute("aria-label",this._map._getUIString("LogoControl.Title")),s.setAttribute("rel","noopener nofollow"),this._container.appendChild(s),this._container.style.display="none",this._map.on("sourcedata",this._updateLogo),this._updateLogo(),this._map.on("resize",this._updateCompact),this._updateCompact(),this._container},ga.prototype.onRemove=function(){E.remove(this._container),this._map.off("sourcedata",this._updateLogo),this._map.off("resize",this._updateCompact)},ga.prototype.getDefaultPosition=function(){return"bottom-left"},ga.prototype._updateLogo=function(n){n&&n.sourceDataType!=="metadata"||(this._container.style.display=this._logoRequired()?"block":"none")},ga.prototype._logoRequired=function(){if(this._map.style){var n=this._map.style.sourceCaches;for(var s in n)if(n[s].getSource().mapbox_logo)return!0;return!1}},ga.prototype._updateCompact=function(){var n=this._container.children;if(n.length){var s=n[0];this._map.getCanvasContainer().offsetWidth<250?s.classList.add("mapboxgl-compact"):s.classList.remove("mapboxgl-compact")}};var an=function(){this._queue=[],this._id=0,this._cleared=!1,this._currentlyRunning=!1};an.prototype.add=function(n){var s=++this._id;return this._queue.push({callback:n,id:s,cancelled:!1}),s},an.prototype.remove=function(n){for(var s=this._currentlyRunning,o=0,c=s?this._queue.concat(s):this._queue;o<c.length;o+=1){var _=c[o];if(_.id===n)return void(_.cancelled=!0)}},an.prototype.run=function(n){n===void 0&&(n=0);var s=this._currentlyRunning=this._queue;this._queue=[];for(var o=0,c=s;o<c.length;o+=1){var _=c[o];if(!_.cancelled&&(_.callback(n),this._cleared))break}this._cleared=!1,this._currentlyRunning=!1},an.prototype.clear=function(){this._currentlyRunning&&(this._cleared=!0),this._queue=[]};var Ta={"AttributionControl.ToggleAttribution":"Toggle attribution","AttributionControl.MapFeedback":"Map feedback","FullscreenControl.Enter":"Enter fullscreen","FullscreenControl.Exit":"Exit fullscreen","GeolocateControl.FindMyLocation":"Find my location","GeolocateControl.LocationNotAvailable":"Location not available","LogoControl.Title":"Mapbox logo","NavigationControl.ResetBearing":"Reset bearing to north","NavigationControl.ZoomIn":"Zoom in","NavigationControl.ZoomOut":"Zoom out","ScaleControl.Feet":"ft","ScaleControl.Meters":"m","ScaleControl.Kilometers":"km","ScaleControl.Miles":"mi","ScaleControl.NauticalMiles":"nm"},nu=a.window.HTMLImageElement,tl=a.window.HTMLElement,Pr=a.window.ImageBitmap,Ki={center:[0,0],zoom:0,bearing:0,pitch:0,minZoom:-2,maxZoom:22,minPitch:0,maxPitch:60,interactive:!0,scrollZoom:!0,boxZoom:!0,dragRotate:!0,dragPan:!0,keyboard:!0,doubleClickZoom:!0,touchZoomRotate:!0,touchPitch:!0,bearingSnap:7,clickTolerance:3,pitchWithRotate:!0,hash:!1,attributionControl:!0,failIfMajorPerformanceCaveat:!1,preserveDrawingBuffer:!1,trackResize:!0,renderWorldCopies:!0,refreshExpiredTiles:!0,maxTileCacheSize:null,localIdeographFontFamily:"sans-serif",transformRequest:null,accessToken:null,fadeDuration:300,crossSourceCollisions:!0},Ac=function(n){function s(c){var _=this;if((c=a.extend({},Ki,c)).minZoom!=null&&c.maxZoom!=null&&c.minZoom>c.maxZoom)throw new Error("maxZoom must be greater than or equal to minZoom");if(c.minPitch!=null&&c.maxPitch!=null&&c.minPitch>c.maxPitch)throw new Error("maxPitch must be greater than or equal to minPitch");if(c.minPitch!=null&&c.minPitch<0)throw new Error("minPitch must be greater than or equal to 0");if(c.maxPitch!=null&&c.maxPitch>60)throw new Error("maxPitch must be less than or equal to 60");var w=new dr(c.minZoom,c.maxZoom,c.minPitch,c.maxPitch,c.renderWorldCopies);if(n.call(this,w,c),this._interactive=c.interactive,this._maxTileCacheSize=c.maxTileCacheSize,this._failIfMajorPerformanceCaveat=c.failIfMajorPerformanceCaveat,this._preserveDrawingBuffer=c.preserveDrawingBuffer,this._antialias=c.antialias,this._trackResize=c.trackResize,this._bearingSnap=c.bearingSnap,this._refreshExpiredTiles=c.refreshExpiredTiles,this._fadeDuration=c.fadeDuration,this._crossSourceCollisions=c.crossSourceCollisions,this._crossFadingFactor=1,this._collectResourceTiming=c.collectResourceTiming,this._renderTaskQueue=new an,this._controls=[],this._mapId=a.uniqueId(),this._locale=a.extend({},Ta,c.locale),this._clickTolerance=c.clickTolerance,this._requestManager=new a.RequestManager(c.transformRequest,c.accessToken),typeof c.container=="string"){if(this._container=a.window.document.getElementById(c.container),!this._container)throw new Error("Container '"+c.container+"' not found.")}else{if(!(c.container instanceof tl))throw new Error("Invalid type: 'container' must be a String or HTMLElement.");this._container=c.container}if(c.maxBounds&&this.setMaxBounds(c.maxBounds),a.bindAll(["_onWindowOnline","_onWindowResize","_onMapScroll","_contextLost","_contextRestored"],this),this._setupContainer(),this._setupPainter(),this.painter===void 0)throw new Error("Failed to initialize WebGL.");this.on("move",function(){return _._update(!1)}),this.on("moveend",function(){return _._update(!1)}),this.on("zoom",function(){return _._update(!0)}),a.window!==void 0&&(a.window.addEventListener("online",this._onWindowOnline,!1),a.window.addEventListener("resize",this._onWindowResize,!1),a.window.addEventListener("orientationchange",this._onWindowResize,!1)),this.handlers=new ft(this,c),this._hash=c.hash&&new ea(typeof c.hash=="string"&&c.hash||void 0).addTo(this),this._hash&&this._hash._onHashChange()||(this.jumpTo({center:c.center,zoom:c.zoom,bearing:c.bearing,pitch:c.pitch}),c.bounds&&(this.resize(),this.fitBounds(c.bounds,a.extend({},c.fitBoundsOptions,{duration:0})))),this.resize(),this._localIdeographFontFamily=c.localIdeographFontFamily,c.style&&this.setStyle(c.style,{localIdeographFontFamily:c.localIdeographFontFamily}),c.attributionControl&&this.addControl(new Sn({customAttribution:c.customAttribution})),this.addControl(new ga,c.logoPosition),this.on("style.load",function(){_.transform.unmodified&&_.jumpTo(_.style.stylesheet)}),this.on("data",function(S){_._update(S.dataType==="style"),_.fire(new a.Event(S.dataType+"data",S))}),this.on("dataloading",function(S){_.fire(new a.Event(S.dataType+"dataloading",S))})}n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s;var o={showTileBoundaries:{configurable:!0},showPadding:{configurable:!0},showCollisionBoxes:{configurable:!0},showOverdrawInspector:{configurable:!0},repaint:{configurable:!0},vertices:{configurable:!0},version:{configurable:!0}};return s.prototype._getMapId=function(){return this._mapId},s.prototype.addControl=function(c,_){if(_===void 0&&(_=c.getDefaultPosition?c.getDefaultPosition():"top-right"),!c||!c.onAdd)return this.fire(new a.ErrorEvent(new Error("Invalid argument to map.addControl(). Argument must be a control with onAdd and onRemove methods.")));var w=c.onAdd(this);this._controls.push(c);var S=this._controlPositions[_];return _.indexOf("bottom")!==-1?S.insertBefore(w,S.firstChild):S.appendChild(w),this},s.prototype.removeControl=function(c){if(!c||!c.onRemove)return this.fire(new a.ErrorEvent(new Error("Invalid argument to map.removeControl(). Argument must be a control with onAdd and onRemove methods.")));var _=this._controls.indexOf(c);return _>-1&&this._controls.splice(_,1),c.onRemove(this),this},s.prototype.hasControl=function(c){return this._controls.indexOf(c)>-1},s.prototype.resize=function(c){var _=this._containerDimensions(),w=_[0],S=_[1];if(w===this.transform.width&&S===this.transform.height)return this;this._resizeCanvas(w,S),this.transform.resize(w,S),this.painter.resize(w,S);var z=!this._moving;return z&&this.fire(new a.Event("movestart",c)).fire(new a.Event("move",c)),this.fire(new a.Event("resize",c)),z&&this.fire(new a.Event("moveend",c)),this},s.prototype.getBounds=function(){return this.transform.getBounds()},s.prototype.getMaxBounds=function(){return this.transform.getMaxBounds()},s.prototype.setMaxBounds=function(c){return this.transform.setMaxBounds(a.LngLatBounds.convert(c)),this._update()},s.prototype.setMinZoom=function(c){if((c=c??-2)>=-2&&c<=this.transform.maxZoom)return this.transform.minZoom=c,this._update(),this.getZoom()<c&&this.setZoom(c),this;throw new Error("minZoom must be between -2 and the current maxZoom, inclusive")},s.prototype.getMinZoom=function(){return this.transform.minZoom},s.prototype.setMaxZoom=function(c){if((c=c??22)>=this.transform.minZoom)return this.transform.maxZoom=c,this._update(),this.getZoom()>c&&this.setZoom(c),this;throw new Error("maxZoom must be greater than the current minZoom")},s.prototype.getMaxZoom=function(){return this.transform.maxZoom},s.prototype.setMinPitch=function(c){if((c=c??0)<0)throw new Error("minPitch must be greater than or equal to 0");if(c>=0&&c<=this.transform.maxPitch)return this.transform.minPitch=c,this._update(),this.getPitch()<c&&this.setPitch(c),this;throw new Error("minPitch must be between 0 and the current maxPitch, inclusive")},s.prototype.getMinPitch=function(){return this.transform.minPitch},s.prototype.setMaxPitch=function(c){if((c=c??60)>60)throw new Error("maxPitch must be less than or equal to 60");if(c>=this.transform.minPitch)return this.transform.maxPitch=c,this._update(),this.getPitch()>c&&this.setPitch(c),this;throw new Error("maxPitch must be greater than the current minPitch")},s.prototype.getMaxPitch=function(){return this.transform.maxPitch},s.prototype.getRenderWorldCopies=function(){return this.transform.renderWorldCopies},s.prototype.setRenderWorldCopies=function(c){return this.transform.renderWorldCopies=c,this._update()},s.prototype.project=function(c){return this.transform.locationPoint(a.LngLat.convert(c))},s.prototype.unproject=function(c){return this.transform.pointLocation(a.Point.convert(c))},s.prototype.isMoving=function(){return this._moving||this.handlers.isMoving()},s.prototype.isZooming=function(){return this._zooming||this.handlers.isZooming()},s.prototype.isRotating=function(){return this._rotating||this.handlers.isRotating()},s.prototype._createDelegatedListener=function(c,_,w){var S,z=this;if(c==="mouseenter"||c==="mouseover"){var P=!1;return{layer:_,listener:w,delegates:{mousemove:function(G){var K=z.getLayer(_)?z.queryRenderedFeatures(G.point,{layers:[_]}):[];K.length?P||(P=!0,w.call(z,new zi(c,z,G.originalEvent,{features:K}))):P=!1},mouseout:function(){P=!1}}}}if(c==="mouseleave"||c==="mouseout"){var O=!1;return{layer:_,listener:w,delegates:{mousemove:function(G){(z.getLayer(_)?z.queryRenderedFeatures(G.point,{layers:[_]}):[]).length?O=!0:O&&(O=!1,w.call(z,new zi(c,z,G.originalEvent)))},mouseout:function(G){O&&(O=!1,w.call(z,new zi(c,z,G.originalEvent)))}}}}return{layer:_,listener:w,delegates:(S={},S[c]=function(G){var K=z.getLayer(_)?z.queryRenderedFeatures(G.point,{layers:[_]}):[];K.length&&(G.features=K,w.call(z,G),delete G.features)},S)}},s.prototype.on=function(c,_,w){if(w===void 0)return n.prototype.on.call(this,c,_);var S=this._createDelegatedListener(c,_,w);for(var z in this._delegatedListeners=this._delegatedListeners||{},this._delegatedListeners[c]=this._delegatedListeners[c]||[],this._delegatedListeners[c].push(S),S.delegates)this.on(z,S.delegates[z]);return this},s.prototype.once=function(c,_,w){if(w===void 0)return n.prototype.once.call(this,c,_);var S=this._createDelegatedListener(c,_,w);for(var z in S.delegates)this.once(z,S.delegates[z]);return this},s.prototype.off=function(c,_,w){var S=this;return w===void 0?n.prototype.off.call(this,c,_):(this._delegatedListeners&&this._delegatedListeners[c]&&function(z){for(var P=z[c],O=0;O<P.length;O++){var G=P[O];if(G.layer===_&&G.listener===w){for(var K in G.delegates)S.off(K,G.delegates[K]);return P.splice(O,1),S}}}(this._delegatedListeners),this)},s.prototype.queryRenderedFeatures=function(c,_){if(!this.style)return[];var w;if(_!==void 0||c===void 0||c instanceof a.Point||Array.isArray(c)||(_=c,c=void 0),_=_||{},(c=c||[[0,0],[this.transform.width,this.transform.height]])instanceof a.Point||typeof c[0]=="number")w=[a.Point.convert(c)];else{var S=a.Point.convert(c[0]),z=a.Point.convert(c[1]);w=[S,new a.Point(z.x,S.y),z,new a.Point(S.x,z.y),S]}return this.style.queryRenderedFeatures(w,_,this.transform)},s.prototype.querySourceFeatures=function(c,_){return this.style.querySourceFeatures(c,_)},s.prototype.setStyle=function(c,_){return(_=a.extend({},{localIdeographFontFamily:this._localIdeographFontFamily},_)).diff!==!1&&_.localIdeographFontFamily===this._localIdeographFontFamily&&this.style&&c?(this._diffStyle(c,_),this):(this._localIdeographFontFamily=_.localIdeographFontFamily,this._updateStyle(c,_))},s.prototype._getUIString=function(c){var _=this._locale[c];if(_==null)throw new Error("Missing UI string '"+c+"'");return _},s.prototype._updateStyle=function(c,_){return this.style&&(this.style.setEventedParent(null),this.style._remove()),c?(this.style=new jn(this,_||{}),this.style.setEventedParent(this,{style:this.style}),typeof c=="string"?this.style.loadURL(c):this.style.loadJSON(c),this):(delete this.style,this)},s.prototype._lazyInitEmptyStyle=function(){this.style||(this.style=new jn(this,{}),this.style.setEventedParent(this,{style:this.style}),this.style.loadEmpty())},s.prototype._diffStyle=function(c,_){var w=this;if(typeof c=="string"){var S=this._requestManager.normalizeStyleURL(c),z=this._requestManager.transformRequest(S,a.ResourceType.Style);a.getJSON(z,function(P,O){P?w.fire(new a.ErrorEvent(P)):O&&w._updateDiff(O,_)})}else typeof c=="object"&&this._updateDiff(c,_)},s.prototype._updateDiff=function(c,_){try{this.style.setState(c)&&this._update(!0)}catch(w){a.warnOnce("Unable to perform style diff: "+(w.message||w.error||w)+".  Rebuilding the style from scratch."),this._updateStyle(c,_)}},s.prototype.getStyle=function(){if(this.style)return this.style.serialize()},s.prototype.isStyleLoaded=function(){return this.style?this.style.loaded():a.warnOnce("There is no style added to the map.")},s.prototype.addSource=function(c,_){return this._lazyInitEmptyStyle(),this.style.addSource(c,_),this._update(!0)},s.prototype.isSourceLoaded=function(c){var _=this.style&&this.style.sourceCaches[c];if(_!==void 0)return _.loaded();this.fire(new a.ErrorEvent(new Error("There is no source with ID '"+c+"'")))},s.prototype.areTilesLoaded=function(){var c=this.style&&this.style.sourceCaches;for(var _ in c){var w=c[_]._tiles;for(var S in w){var z=w[S];if(z.state!=="loaded"&&z.state!=="errored")return!1}}return!0},s.prototype.addSourceType=function(c,_,w){return this._lazyInitEmptyStyle(),this.style.addSourceType(c,_,w)},s.prototype.removeSource=function(c){return this.style.removeSource(c),this._update(!0)},s.prototype.getSource=function(c){return this.style.getSource(c)},s.prototype.addImage=function(c,_,w){w===void 0&&(w={});var S=w.pixelRatio;S===void 0&&(S=1);var z=w.sdf;z===void 0&&(z=!1);var P=w.stretchX,O=w.stretchY,G=w.content;if(this._lazyInitEmptyStyle(),_ instanceof nu||Pr&&_ instanceof Pr){var K=a.browser.getImageData(_);this.style.addImage(c,{data:new a.RGBAImage({width:K.width,height:K.height},K.data),pixelRatio:S,stretchX:P,stretchY:O,content:G,sdf:z,version:0})}else{if(_.width===void 0||_.height===void 0)return this.fire(new a.ErrorEvent(new Error("Invalid arguments to map.addImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));var X=_;this.style.addImage(c,{data:new a.RGBAImage({width:_.width,height:_.height},new Uint8Array(_.data)),pixelRatio:S,stretchX:P,stretchY:O,content:G,sdf:z,version:0,userImage:X}),X.onAdd&&X.onAdd(this,c)}},s.prototype.updateImage=function(c,_){var w=this.style.getImage(c);if(!w)return this.fire(new a.ErrorEvent(new Error("The map has no image with that id. If you are adding a new image use `map.addImage(...)` instead.")));var S=_ instanceof nu||Pr&&_ instanceof Pr?a.browser.getImageData(_):_,z=S.width,P=S.height,O=S.data;return z===void 0||P===void 0?this.fire(new a.ErrorEvent(new Error("Invalid arguments to map.updateImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`"))):z!==w.data.width||P!==w.data.height?this.fire(new a.ErrorEvent(new Error("The width and height of the updated image must be that same as the previous version of the image"))):(w.data.replace(O,!(_ instanceof nu||Pr&&_ instanceof Pr)),void this.style.updateImage(c,w))},s.prototype.hasImage=function(c){return c?!!this.style.getImage(c):(this.fire(new a.ErrorEvent(new Error("Missing required image id"))),!1)},s.prototype.removeImage=function(c){this.style.removeImage(c)},s.prototype.loadImage=function(c,_){a.getImage(this._requestManager.transformRequest(c,a.ResourceType.Image),_)},s.prototype.listImages=function(){return this.style.listImages()},s.prototype.addLayer=function(c,_){return this._lazyInitEmptyStyle(),this.style.addLayer(c,_),this._update(!0)},s.prototype.moveLayer=function(c,_){return this.style.moveLayer(c,_),this._update(!0)},s.prototype.removeLayer=function(c){return this.style.removeLayer(c),this._update(!0)},s.prototype.getLayer=function(c){return this.style.getLayer(c)},s.prototype.setLayerZoomRange=function(c,_,w){return this.style.setLayerZoomRange(c,_,w),this._update(!0)},s.prototype.setFilter=function(c,_,w){return w===void 0&&(w={}),this.style.setFilter(c,_,w),this._update(!0)},s.prototype.getFilter=function(c){return this.style.getFilter(c)},s.prototype.setPaintProperty=function(c,_,w,S){return S===void 0&&(S={}),this.style.setPaintProperty(c,_,w,S),this._update(!0)},s.prototype.getPaintProperty=function(c,_){return this.style.getPaintProperty(c,_)},s.prototype.setLayoutProperty=function(c,_,w,S){return S===void 0&&(S={}),this.style.setLayoutProperty(c,_,w,S),this._update(!0)},s.prototype.getLayoutProperty=function(c,_){return this.style.getLayoutProperty(c,_)},s.prototype.setLight=function(c,_){return _===void 0&&(_={}),this._lazyInitEmptyStyle(),this.style.setLight(c,_),this._update(!0)},s.prototype.getLight=function(){return this.style.getLight()},s.prototype.setFeatureState=function(c,_){return this.style.setFeatureState(c,_),this._update()},s.prototype.removeFeatureState=function(c,_){return this.style.removeFeatureState(c,_),this._update()},s.prototype.getFeatureState=function(c){return this.style.getFeatureState(c)},s.prototype.getContainer=function(){return this._container},s.prototype.getCanvasContainer=function(){return this._canvasContainer},s.prototype.getCanvas=function(){return this._canvas},s.prototype._containerDimensions=function(){var c=0,_=0;return this._container&&(c=this._container.clientWidth||400,_=this._container.clientHeight||300),[c,_]},s.prototype._detectMissingCSS=function(){a.window.getComputedStyle(this._missingCSSCanary).getPropertyValue("background-color")!=="rgb(250, 128, 114)"&&a.warnOnce("This page appears to be missing CSS declarations for Mapbox GL JS, which may cause the map to display incorrectly. Please ensure your page includes mapbox-gl.css, as described in https://www.mapbox.com/mapbox-gl-js/api/.")},s.prototype._setupContainer=function(){var c=this._container;c.classList.add("mapboxgl-map"),(this._missingCSSCanary=E.create("div","mapboxgl-canary",c)).style.visibility="hidden",this._detectMissingCSS();var _=this._canvasContainer=E.create("div","mapboxgl-canvas-container",c);this._interactive&&_.classList.add("mapboxgl-interactive"),this._canvas=E.create("canvas","mapboxgl-canvas",_),this._canvas.addEventListener("webglcontextlost",this._contextLost,!1),this._canvas.addEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.setAttribute("tabindex","0"),this._canvas.setAttribute("aria-label","Map"),this._canvas.setAttribute("role","region");var w=this._containerDimensions();this._resizeCanvas(w[0],w[1]);var S=this._controlContainer=E.create("div","mapboxgl-control-container",c),z=this._controlPositions={};["top-left","top-right","bottom-left","bottom-right"].forEach(function(P){z[P]=E.create("div","mapboxgl-ctrl-"+P,S)}),this._container.addEventListener("scroll",this._onMapScroll,!1)},s.prototype._resizeCanvas=function(c,_){var w=a.browser.devicePixelRatio||1;this._canvas.width=w*c,this._canvas.height=w*_,this._canvas.style.width=c+"px",this._canvas.style.height=_+"px"},s.prototype._setupPainter=function(){var c=a.extend({},T.webGLContextAttributes,{failIfMajorPerformanceCaveat:this._failIfMajorPerformanceCaveat,preserveDrawingBuffer:this._preserveDrawingBuffer,antialias:this._antialias||!1}),_=this._canvas.getContext("webgl",c)||this._canvas.getContext("experimental-webgl",c);_?(this.painter=new Jr(_,this.transform),a.webpSupported.testSupport(_)):this.fire(new a.ErrorEvent(new Error("Failed to initialize WebGL")))},s.prototype._contextLost=function(c){c.preventDefault(),this._frame&&(this._frame.cancel(),this._frame=null),this.fire(new a.Event("webglcontextlost",{originalEvent:c}))},s.prototype._contextRestored=function(c){this._setupPainter(),this.resize(),this._update(),this.fire(new a.Event("webglcontextrestored",{originalEvent:c}))},s.prototype._onMapScroll=function(c){if(c.target===this._container)return this._container.scrollTop=0,this._container.scrollLeft=0,!1},s.prototype.loaded=function(){return!this._styleDirty&&!this._sourcesDirty&&!!this.style&&this.style.loaded()},s.prototype._update=function(c){return this.style?(this._styleDirty=this._styleDirty||c,this._sourcesDirty=!0,this.triggerRepaint(),this):this},s.prototype._requestRenderFrame=function(c){return this._update(),this._renderTaskQueue.add(c)},s.prototype._cancelRenderFrame=function(c){this._renderTaskQueue.remove(c)},s.prototype._render=function(c){var _,w=this,S=0,z=this.painter.context.extTimerQuery;if(this.listens("gpu-timing-frame")&&(_=z.createQueryEXT(),z.beginQueryEXT(z.TIME_ELAPSED_EXT,_),S=a.browser.now()),this.painter.context.setDirty(),this.painter.setBaseState(),this._renderTaskQueue.run(c),!this._removed){var P=!1;if(this.style&&this._styleDirty){this._styleDirty=!1;var O=this.transform.zoom,G=a.browser.now();this.style.zoomHistory.update(O,G);var K=new a.EvaluationParameters(O,{now:G,fadeDuration:this._fadeDuration,zoomHistory:this.style.zoomHistory,transition:this.style.getTransition()}),X=K.crossFadingFactor();X===1&&X===this._crossFadingFactor||(P=!0,this._crossFadingFactor=X),this.style.update(K)}if(this.style&&this._sourcesDirty&&(this._sourcesDirty=!1,this.style._updateSources(this.transform)),this._placementDirty=this.style&&this.style._updatePlacement(this.painter.transform,this.showCollisionBoxes,this._fadeDuration,this._crossSourceCollisions),this.painter.render(this.style,{showTileBoundaries:this.showTileBoundaries,showOverdrawInspector:this._showOverdrawInspector,rotating:this.isRotating(),zooming:this.isZooming(),moving:this.isMoving(),fadeDuration:this._fadeDuration,showPadding:this.showPadding,gpuTiming:!!this.listens("gpu-timing-layer")}),this.fire(new a.Event("render")),this.loaded()&&!this._loaded&&(this._loaded=!0,this.fire(new a.Event("load"))),this.style&&(this.style.hasTransitions()||P)&&(this._styleDirty=!0),this.style&&!this._placementDirty&&this.style._releaseSymbolFadeTiles(),this.listens("gpu-timing-frame")){var re=a.browser.now()-S;z.endQueryEXT(z.TIME_ELAPSED_EXT,_),setTimeout(function(){var Y=z.getQueryObjectEXT(_,z.QUERY_RESULT_EXT)/1e6;z.deleteQueryEXT(_),w.fire(new a.Event("gpu-timing-frame",{cpuTime:re,gpuTime:Y}))},50)}if(this.listens("gpu-timing-layer")){var te=this.painter.collectGpuTimers();setTimeout(function(){var Y=w.painter.queryGpuTimers(te);w.fire(new a.Event("gpu-timing-layer",{layerTimes:Y}))},50)}var ue=this._sourcesDirty||this._styleDirty||this._placementDirty;return ue||this._repaint?this.triggerRepaint():!this.isMoving()&&this.loaded()&&this.fire(new a.Event("idle")),!this._loaded||this._fullyLoaded||ue||(this._fullyLoaded=!0),this}},s.prototype.remove=function(){this._hash&&this._hash.remove();for(var c=0,_=this._controls;c<_.length;c+=1)_[c].onRemove(this);this._controls=[],this._frame&&(this._frame.cancel(),this._frame=null),this._renderTaskQueue.clear(),this.painter.destroy(),this.handlers.destroy(),delete this.handlers,this.setStyle(null),a.window!==void 0&&(a.window.removeEventListener("resize",this._onWindowResize,!1),a.window.removeEventListener("orientationchange",this._onWindowResize,!1),a.window.removeEventListener("online",this._onWindowOnline,!1));var w=this.painter.context.gl.getExtension("WEBGL_lose_context");w&&w.loseContext(),To(this._canvasContainer),To(this._controlContainer),To(this._missingCSSCanary),this._container.classList.remove("mapboxgl-map"),this._removed=!0,this.fire(new a.Event("remove"))},s.prototype.triggerRepaint=function(){var c=this;this.style&&!this._frame&&(this._frame=a.browser.frame(function(_){c._frame=null,c._render(_)}))},s.prototype._onWindowOnline=function(){this._update()},s.prototype._onWindowResize=function(c){this._trackResize&&this.resize({originalEvent:c})._update()},o.showTileBoundaries.get=function(){return!!this._showTileBoundaries},o.showTileBoundaries.set=function(c){this._showTileBoundaries!==c&&(this._showTileBoundaries=c,this._update())},o.showPadding.get=function(){return!!this._showPadding},o.showPadding.set=function(c){this._showPadding!==c&&(this._showPadding=c,this._update())},o.showCollisionBoxes.get=function(){return!!this._showCollisionBoxes},o.showCollisionBoxes.set=function(c){this._showCollisionBoxes!==c&&(this._showCollisionBoxes=c,c?this.style._generateCollisionBoxes():this._update())},o.showOverdrawInspector.get=function(){return!!this._showOverdrawInspector},o.showOverdrawInspector.set=function(c){this._showOverdrawInspector!==c&&(this._showOverdrawInspector=c,this._update())},o.repaint.get=function(){return!!this._repaint},o.repaint.set=function(c){this._repaint!==c&&(this._repaint=c,this.triggerRepaint())},o.vertices.get=function(){return!!this._vertices},o.vertices.set=function(c){this._vertices=c,this._update()},s.prototype._setCacheLimits=function(c,_){a.setCacheLimits(c,_)},o.version.get=function(){return a.version},Object.defineProperties(s.prototype,o),s}(el);function To(n){n.parentNode&&n.parentNode.removeChild(n)}var au={showCompass:!0,showZoom:!0,visualizePitch:!1},Da=function(n){var s=this;this.options=a.extend({},au,n),this._container=E.create("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._container.addEventListener("contextmenu",function(o){return o.preventDefault()}),this.options.showZoom&&(a.bindAll(["_setButtonTitle","_updateZoomButtons"],this),this._zoomInButton=this._createButton("mapboxgl-ctrl-zoom-in",function(o){return s._map.zoomIn({},{originalEvent:o})}),E.create("span","mapboxgl-ctrl-icon",this._zoomInButton).setAttribute("aria-hidden",!0),this._zoomOutButton=this._createButton("mapboxgl-ctrl-zoom-out",function(o){return s._map.zoomOut({},{originalEvent:o})}),E.create("span","mapboxgl-ctrl-icon",this._zoomOutButton).setAttribute("aria-hidden",!0)),this.options.showCompass&&(a.bindAll(["_rotateCompassArrow"],this),this._compass=this._createButton("mapboxgl-ctrl-compass",function(o){s.options.visualizePitch?s._map.resetNorthPitch({},{originalEvent:o}):s._map.resetNorth({},{originalEvent:o})}),this._compassIcon=E.create("span","mapboxgl-ctrl-icon",this._compass),this._compassIcon.setAttribute("aria-hidden",!0))};Da.prototype._updateZoomButtons=function(){var n=this._map.getZoom(),s=n===this._map.getMaxZoom(),o=n===this._map.getMinZoom();this._zoomInButton.disabled=s,this._zoomOutButton.disabled=o,this._zoomInButton.setAttribute("aria-disabled",s.toString()),this._zoomOutButton.setAttribute("aria-disabled",o.toString())},Da.prototype._rotateCompassArrow=function(){var n=this.options.visualizePitch?"scale("+1/Math.pow(Math.cos(this._map.transform.pitch*(Math.PI/180)),.5)+") rotateX("+this._map.transform.pitch+"deg) rotateZ("+this._map.transform.angle*(180/Math.PI)+"deg)":"rotate("+this._map.transform.angle*(180/Math.PI)+"deg)";this._compassIcon.style.transform=n},Da.prototype.onAdd=function(n){return this._map=n,this.options.showZoom&&(this._setButtonTitle(this._zoomInButton,"ZoomIn"),this._setButtonTitle(this._zoomOutButton,"ZoomOut"),this._map.on("zoom",this._updateZoomButtons),this._updateZoomButtons()),this.options.showCompass&&(this._setButtonTitle(this._compass,"ResetBearing"),this.options.visualizePitch&&this._map.on("pitch",this._rotateCompassArrow),this._map.on("rotate",this._rotateCompassArrow),this._rotateCompassArrow(),this._handler=new Xn(this._map,this._compass,this.options.visualizePitch)),this._container},Da.prototype.onRemove=function(){E.remove(this._container),this.options.showZoom&&this._map.off("zoom",this._updateZoomButtons),this.options.showCompass&&(this.options.visualizePitch&&this._map.off("pitch",this._rotateCompassArrow),this._map.off("rotate",this._rotateCompassArrow),this._handler.off(),delete this._handler),delete this._map},Da.prototype._createButton=function(n,s){var o=E.create("button",n,this._container);return o.type="button",o.addEventListener("click",s),o},Da.prototype._setButtonTitle=function(n,s){var o=this._map._getUIString("NavigationControl."+s);n.title=o,n.setAttribute("aria-label",o)};var Xn=function(n,s,o){o===void 0&&(o=!1),this._clickTolerance=10,this.element=s,this.mouseRotate=new Ys({clickTolerance:n.dragRotate._mouseRotate._clickTolerance}),this.map=n,o&&(this.mousePitch=new tu({clickTolerance:n.dragRotate._mousePitch._clickTolerance})),a.bindAll(["mousedown","mousemove","mouseup","touchstart","touchmove","touchend","reset"],this),E.addEventListener(s,"mousedown",this.mousedown),E.addEventListener(s,"touchstart",this.touchstart,{passive:!1}),E.addEventListener(s,"touchmove",this.touchmove),E.addEventListener(s,"touchend",this.touchend),E.addEventListener(s,"touchcancel",this.reset)};function Go(n,s,o){if(n=new a.LngLat(n.lng,n.lat),s){var c=new a.LngLat(n.lng-360,n.lat),_=new a.LngLat(n.lng+360,n.lat),w=o.locationPoint(n).distSqr(s);o.locationPoint(c).distSqr(s)<w?n=c:o.locationPoint(_).distSqr(s)<w&&(n=_)}for(;Math.abs(n.lng-o.center.lng)>180;){var S=o.locationPoint(n);if(S.x>=0&&S.y>=0&&S.x<=o.width&&S.y<=o.height)break;n.lng>o.center.lng?n.lng-=360:n.lng+=360}return n}Xn.prototype.down=function(n,s){this.mouseRotate.mousedown(n,s),this.mousePitch&&this.mousePitch.mousedown(n,s),E.disableDrag()},Xn.prototype.move=function(n,s){var o=this.map,c=this.mouseRotate.mousemoveWindow(n,s);if(c&&c.bearingDelta&&o.setBearing(o.getBearing()+c.bearingDelta),this.mousePitch){var _=this.mousePitch.mousemoveWindow(n,s);_&&_.pitchDelta&&o.setPitch(o.getPitch()+_.pitchDelta)}},Xn.prototype.off=function(){var n=this.element;E.removeEventListener(n,"mousedown",this.mousedown),E.removeEventListener(n,"touchstart",this.touchstart,{passive:!1}),E.removeEventListener(n,"touchmove",this.touchmove),E.removeEventListener(n,"touchend",this.touchend),E.removeEventListener(n,"touchcancel",this.reset),this.offTemp()},Xn.prototype.offTemp=function(){E.enableDrag(),E.removeEventListener(a.window,"mousemove",this.mousemove),E.removeEventListener(a.window,"mouseup",this.mouseup)},Xn.prototype.mousedown=function(n){this.down(a.extend({},n,{ctrlKey:!0,preventDefault:function(){return n.preventDefault()}}),E.mousePos(this.element,n)),E.addEventListener(a.window,"mousemove",this.mousemove),E.addEventListener(a.window,"mouseup",this.mouseup)},Xn.prototype.mousemove=function(n){this.move(n,E.mousePos(this.element,n))},Xn.prototype.mouseup=function(n){this.mouseRotate.mouseupWindow(n),this.mousePitch&&this.mousePitch.mouseupWindow(n),this.offTemp()},Xn.prototype.touchstart=function(n){n.targetTouches.length!==1?this.reset():(this._startPos=this._lastPos=E.touchPos(this.element,n.targetTouches)[0],this.down({type:"mousedown",button:0,ctrlKey:!0,preventDefault:function(){return n.preventDefault()}},this._startPos))},Xn.prototype.touchmove=function(n){n.targetTouches.length!==1?this.reset():(this._lastPos=E.touchPos(this.element,n.targetTouches)[0],this.move({preventDefault:function(){return n.preventDefault()}},this._lastPos))},Xn.prototype.touchend=function(n){n.targetTouches.length===0&&this._startPos&&this._lastPos&&this._startPos.dist(this._lastPos)<this._clickTolerance&&this.element.click(),this.reset()},Xn.prototype.reset=function(){this.mouseRotate.reset(),this.mousePitch&&this.mousePitch.reset(),delete this._startPos,delete this._lastPos,this.offTemp()};var za={center:"translate(-50%,-50%)",top:"translate(-50%,0)","top-left":"translate(0,0)","top-right":"translate(-100%,0)",bottom:"translate(-50%,-100%)","bottom-left":"translate(0,-100%)","bottom-right":"translate(-100%,-100%)",left:"translate(0,-50%)",right:"translate(-100%,-50%)"};function rl(n,s,o){var c=n.classList;for(var _ in za)c.remove("mapboxgl-"+o+"-anchor-"+_);c.add("mapboxgl-"+o+"-anchor-"+s)}var Ko,Ss=function(n){function s(o,c){if(n.call(this),(o instanceof a.window.HTMLElement||c)&&(o=a.extend({element:o},c)),a.bindAll(["_update","_onMove","_onUp","_addDragHandler","_onMapClick","_onKeyPress"],this),this._anchor=o&&o.anchor||"center",this._color=o&&o.color||"#3FB1CE",this._scale=o&&o.scale||1,this._draggable=o&&o.draggable||!1,this._clickTolerance=o&&o.clickTolerance||0,this._isDragging=!1,this._state="inactive",this._rotation=o&&o.rotation||0,this._rotationAlignment=o&&o.rotationAlignment||"auto",this._pitchAlignment=o&&o.pitchAlignment&&o.pitchAlignment!=="auto"?o.pitchAlignment:this._rotationAlignment,o&&o.element)this._element=o.element,this._offset=a.Point.convert(o&&o.offset||[0,0]);else{this._defaultMarker=!0,this._element=E.create("div"),this._element.setAttribute("aria-label","Map marker");var _=E.createNS("http://www.w3.org/2000/svg","svg");_.setAttributeNS(null,"display","block"),_.setAttributeNS(null,"height","41px"),_.setAttributeNS(null,"width","27px"),_.setAttributeNS(null,"viewBox","0 0 27 41");var w=E.createNS("http://www.w3.org/2000/svg","g");w.setAttributeNS(null,"stroke","none"),w.setAttributeNS(null,"stroke-width","1"),w.setAttributeNS(null,"fill","none"),w.setAttributeNS(null,"fill-rule","evenodd");var S=E.createNS("http://www.w3.org/2000/svg","g");S.setAttributeNS(null,"fill-rule","nonzero");var z=E.createNS("http://www.w3.org/2000/svg","g");z.setAttributeNS(null,"transform","translate(3.0, 29.0)"),z.setAttributeNS(null,"fill","#000000");for(var P=0,O=[{rx:"10.5",ry:"5.25002273"},{rx:"10.5",ry:"5.25002273"},{rx:"9.5",ry:"4.77275007"},{rx:"8.5",ry:"4.29549936"},{rx:"7.5",ry:"3.81822308"},{rx:"6.5",ry:"3.34094679"},{rx:"5.5",ry:"2.86367051"},{rx:"4.5",ry:"2.38636864"}];P<O.length;P+=1){var G=O[P],K=E.createNS("http://www.w3.org/2000/svg","ellipse");K.setAttributeNS(null,"opacity","0.04"),K.setAttributeNS(null,"cx","10.5"),K.setAttributeNS(null,"cy","5.80029008"),K.setAttributeNS(null,"rx",G.rx),K.setAttributeNS(null,"ry",G.ry),z.appendChild(K)}var X=E.createNS("http://www.w3.org/2000/svg","g");X.setAttributeNS(null,"fill",this._color);var re=E.createNS("http://www.w3.org/2000/svg","path");re.setAttributeNS(null,"d","M27,13.5 C27,19.074644 20.250001,27.000002 14.75,34.500002 C14.016665,35.500004 12.983335,35.500004 12.25,34.500002 C6.7499993,27.000002 0,19.222562 0,13.5 C0,6.0441559 6.0441559,0 13.5,0 C20.955844,0 27,6.0441559 27,13.5 Z"),X.appendChild(re);var te=E.createNS("http://www.w3.org/2000/svg","g");te.setAttributeNS(null,"opacity","0.25"),te.setAttributeNS(null,"fill","#000000");var ue=E.createNS("http://www.w3.org/2000/svg","path");ue.setAttributeNS(null,"d","M13.5,0 C6.0441559,0 0,6.0441559 0,13.5 C0,19.222562 6.7499993,27 12.25,34.5 C13,35.522727 14.016664,35.500004 14.75,34.5 C20.250001,27 27,19.074644 27,13.5 C27,6.0441559 20.955844,0 13.5,0 Z M13.5,1 C20.415404,1 26,6.584596 26,13.5 C26,15.898657 24.495584,19.181431 22.220703,22.738281 C19.945823,26.295132 16.705119,30.142167 13.943359,33.908203 C13.743445,34.180814 13.612715,34.322738 13.5,34.441406 C13.387285,34.322738 13.256555,34.180814 13.056641,33.908203 C10.284481,30.127985 7.4148684,26.314159 5.015625,22.773438 C2.6163816,19.232715 1,15.953538 1,13.5 C1,6.584596 6.584596,1 13.5,1 Z"),te.appendChild(ue);var Y=E.createNS("http://www.w3.org/2000/svg","g");Y.setAttributeNS(null,"transform","translate(6.0, 7.0)"),Y.setAttributeNS(null,"fill","#FFFFFF");var le=E.createNS("http://www.w3.org/2000/svg","g");le.setAttributeNS(null,"transform","translate(8.0, 8.0)");var pe=E.createNS("http://www.w3.org/2000/svg","circle");pe.setAttributeNS(null,"fill","#000000"),pe.setAttributeNS(null,"opacity","0.25"),pe.setAttributeNS(null,"cx","5.5"),pe.setAttributeNS(null,"cy","5.5"),pe.setAttributeNS(null,"r","5.4999962");var ve=E.createNS("http://www.w3.org/2000/svg","circle");ve.setAttributeNS(null,"fill","#FFFFFF"),ve.setAttributeNS(null,"cx","5.5"),ve.setAttributeNS(null,"cy","5.5"),ve.setAttributeNS(null,"r","5.4999962"),le.appendChild(pe),le.appendChild(ve),S.appendChild(z),S.appendChild(X),S.appendChild(te),S.appendChild(Y),S.appendChild(le),_.appendChild(S),_.setAttributeNS(null,"height",41*this._scale+"px"),_.setAttributeNS(null,"width",27*this._scale+"px"),this._element.appendChild(_),this._offset=a.Point.convert(o&&o.offset||[0,-14])}this._element.classList.add("mapboxgl-marker"),this._element.addEventListener("dragstart",function(Ie){Ie.preventDefault()}),this._element.addEventListener("mousedown",function(Ie){Ie.preventDefault()}),rl(this._element,this._anchor,"marker"),this._popup=null}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype.addTo=function(o){return this.remove(),this._map=o,o.getCanvasContainer().appendChild(this._element),o.on("move",this._update),o.on("moveend",this._update),this.setDraggable(this._draggable),this._update(),this._map.on("click",this._onMapClick),this},s.prototype.remove=function(){return this._map&&(this._map.off("click",this._onMapClick),this._map.off("move",this._update),this._map.off("moveend",this._update),this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler),this._map.off("mouseup",this._onUp),this._map.off("touchend",this._onUp),this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),delete this._map),E.remove(this._element),this._popup&&this._popup.remove(),this},s.prototype.getLngLat=function(){return this._lngLat},s.prototype.setLngLat=function(o){return this._lngLat=a.LngLat.convert(o),this._pos=null,this._popup&&this._popup.setLngLat(this._lngLat),this._update(),this},s.prototype.getElement=function(){return this._element},s.prototype.setPopup=function(o){if(this._popup&&(this._popup.remove(),this._popup=null,this._element.removeEventListener("keypress",this._onKeyPress),this._originalTabIndex||this._element.removeAttribute("tabindex")),o){if(!("offset"in o.options)){var c=Math.sqrt(Math.pow(13.5,2)/2);o.options.offset=this._defaultMarker?{top:[0,0],"top-left":[0,0],"top-right":[0,0],bottom:[0,-38.1],"bottom-left":[c,-1*(24.6+c)],"bottom-right":[-c,-1*(24.6+c)],left:[13.5,-24.6],right:[-13.5,-24.6]}:this._offset}this._popup=o,this._lngLat&&this._popup.setLngLat(this._lngLat),this._originalTabIndex=this._element.getAttribute("tabindex"),this._originalTabIndex||this._element.setAttribute("tabindex","0"),this._element.addEventListener("keypress",this._onKeyPress)}return this},s.prototype._onKeyPress=function(o){var c=o.code,_=o.charCode||o.keyCode;c!=="Space"&&c!=="Enter"&&_!==32&&_!==13||this.togglePopup()},s.prototype._onMapClick=function(o){var c=o.originalEvent.target,_=this._element;this._popup&&(c===_||_.contains(c))&&this.togglePopup()},s.prototype.getPopup=function(){return this._popup},s.prototype.togglePopup=function(){var o=this._popup;return o?(o.isOpen()?o.remove():o.addTo(this._map),this):this},s.prototype._update=function(o){if(this._map){this._map.transform.renderWorldCopies&&(this._lngLat=Go(this._lngLat,this._pos,this._map.transform)),this._pos=this._map.project(this._lngLat)._add(this._offset);var c="";this._rotationAlignment==="viewport"||this._rotationAlignment==="auto"?c="rotateZ("+this._rotation+"deg)":this._rotationAlignment==="map"&&(c="rotateZ("+(this._rotation-this._map.getBearing())+"deg)");var _="";this._pitchAlignment==="viewport"||this._pitchAlignment==="auto"?_="rotateX(0deg)":this._pitchAlignment==="map"&&(_="rotateX("+this._map.getPitch()+"deg)"),o&&o.type!=="moveend"||(this._pos=this._pos.round()),E.setTransform(this._element,za[this._anchor]+" translate("+this._pos.x+"px, "+this._pos.y+"px) "+_+" "+c)}},s.prototype.getOffset=function(){return this._offset},s.prototype.setOffset=function(o){return this._offset=a.Point.convert(o),this._update(),this},s.prototype._onMove=function(o){if(!this._isDragging){var c=this._clickTolerance||this._map._clickTolerance;this._isDragging=o.point.dist(this._pointerdownPos)>=c}this._isDragging&&(this._pos=o.point.sub(this._positionDelta),this._lngLat=this._map.unproject(this._pos),this.setLngLat(this._lngLat),this._element.style.pointerEvents="none",this._state==="pending"&&(this._state="active",this.fire(new a.Event("dragstart"))),this.fire(new a.Event("drag")))},s.prototype._onUp=function(){this._element.style.pointerEvents="auto",this._positionDelta=null,this._pointerdownPos=null,this._isDragging=!1,this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),this._state==="active"&&this.fire(new a.Event("dragend")),this._state="inactive"},s.prototype._addDragHandler=function(o){this._element.contains(o.originalEvent.target)&&(o.preventDefault(),this._positionDelta=o.point.sub(this._pos).add(this._offset),this._pointerdownPos=o.point,this._state="pending",this._map.on("mousemove",this._onMove),this._map.on("touchmove",this._onMove),this._map.once("mouseup",this._onUp),this._map.once("touchend",this._onUp))},s.prototype.setDraggable=function(o){return this._draggable=!!o,this._map&&(o?(this._map.on("mousedown",this._addDragHandler),this._map.on("touchstart",this._addDragHandler)):(this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler))),this},s.prototype.isDraggable=function(){return this._draggable},s.prototype.setRotation=function(o){return this._rotation=o||0,this._update(),this},s.prototype.getRotation=function(){return this._rotation},s.prototype.setRotationAlignment=function(o){return this._rotationAlignment=o||"auto",this._update(),this},s.prototype.getRotationAlignment=function(){return this._rotationAlignment},s.prototype.setPitchAlignment=function(o){return this._pitchAlignment=o&&o!=="auto"?o:this._rotationAlignment,this._update(),this},s.prototype.getPitchAlignment=function(){return this._pitchAlignment},s}(a.Evented),ou={positionOptions:{enableHighAccuracy:!1,maximumAge:0,timeout:6e3},fitBoundsOptions:{maxZoom:15},trackUserLocation:!1,showAccuracyCircle:!0,showUserLocation:!0},Xo=0,zo=!1,su=function(n){function s(o){n.call(this),this.options=a.extend({},ou,o),a.bindAll(["_onSuccess","_onError","_onZoom","_finish","_setupUI","_updateCamera","_updateMarker"],this)}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype.onAdd=function(o){var c;return this._map=o,this._container=E.create("div","mapboxgl-ctrl mapboxgl-ctrl-group"),c=this._setupUI,Ko!==void 0?c(Ko):a.window.navigator.permissions!==void 0?a.window.navigator.permissions.query({name:"geolocation"}).then(function(_){c(Ko=_.state!=="denied")}):c(Ko=!!a.window.navigator.geolocation),this._container},s.prototype.onRemove=function(){this._geolocationWatchID!==void 0&&(a.window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0),this.options.showUserLocation&&this._userLocationDotMarker&&this._userLocationDotMarker.remove(),this.options.showAccuracyCircle&&this._accuracyCircleMarker&&this._accuracyCircleMarker.remove(),E.remove(this._container),this._map.off("zoom",this._onZoom),this._map=void 0,Xo=0,zo=!1},s.prototype._isOutOfMapMaxBounds=function(o){var c=this._map.getMaxBounds(),_=o.coords;return c&&(_.longitude<c.getWest()||_.longitude>c.getEast()||_.latitude<c.getSouth()||_.latitude>c.getNorth())},s.prototype._setErrorState=function(){switch(this._watchState){case"WAITING_ACTIVE":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error");break;case"ACTIVE_LOCK":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting");break;case"BACKGROUND":this._watchState="BACKGROUND_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting")}},s.prototype._onSuccess=function(o){if(this._map){if(this._isOutOfMapMaxBounds(o))return this._setErrorState(),this.fire(new a.Event("outofmaxbounds",o)),this._updateMarker(),void this._finish();if(this.options.trackUserLocation)switch(this._lastKnownPosition=o,this._watchState){case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"BACKGROUND":case"BACKGROUND_ERROR":this._watchState="BACKGROUND",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background")}this.options.showUserLocation&&this._watchState!=="OFF"&&this._updateMarker(o),this.options.trackUserLocation&&this._watchState!=="ACTIVE_LOCK"||this._updateCamera(o),this.options.showUserLocation&&this._dotElement.classList.remove("mapboxgl-user-location-dot-stale"),this.fire(new a.Event("geolocate",o)),this._finish()}},s.prototype._updateCamera=function(o){var c=new a.LngLat(o.coords.longitude,o.coords.latitude),_=o.coords.accuracy,w=this._map.getBearing(),S=a.extend({bearing:w},this.options.fitBoundsOptions);this._map.fitBounds(c.toBounds(_),S,{geolocateSource:!0})},s.prototype._updateMarker=function(o){if(o){var c=new a.LngLat(o.coords.longitude,o.coords.latitude);this._accuracyCircleMarker.setLngLat(c).addTo(this._map),this._userLocationDotMarker.setLngLat(c).addTo(this._map),this._accuracy=o.coords.accuracy,this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}else this._userLocationDotMarker.remove(),this._accuracyCircleMarker.remove()},s.prototype._updateCircleRadius=function(){var o=this._map._container.clientHeight/2,c=this._map.unproject([0,o]),_=this._map.unproject([1,o]),w=c.distanceTo(_),S=Math.ceil(2*this._accuracy/w);this._circleElement.style.width=S+"px",this._circleElement.style.height=S+"px"},s.prototype._onZoom=function(){this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()},s.prototype._onError=function(o){if(this._map){if(this.options.trackUserLocation)if(o.code===1){this._watchState="OFF",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.disabled=!0;var c=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.title=c,this._geolocateButton.setAttribute("aria-label",c),this._geolocationWatchID!==void 0&&this._clearWatch()}else{if(o.code===3&&zo)return;this._setErrorState()}this._watchState!=="OFF"&&this.options.showUserLocation&&this._dotElement.classList.add("mapboxgl-user-location-dot-stale"),this.fire(new a.Event("error",o)),this._finish()}},s.prototype._finish=function(){this._timeoutId&&clearTimeout(this._timeoutId),this._timeoutId=void 0},s.prototype._setupUI=function(o){var c=this;if(this._container.addEventListener("contextmenu",function(S){return S.preventDefault()}),this._geolocateButton=E.create("button","mapboxgl-ctrl-geolocate",this._container),E.create("span","mapboxgl-ctrl-icon",this._geolocateButton).setAttribute("aria-hidden",!0),this._geolocateButton.type="button",o===!1){a.warnOnce("Geolocation support is not available so the GeolocateControl will be disabled.");var _=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.disabled=!0,this._geolocateButton.title=_,this._geolocateButton.setAttribute("aria-label",_)}else{var w=this._map._getUIString("GeolocateControl.FindMyLocation");this._geolocateButton.title=w,this._geolocateButton.setAttribute("aria-label",w)}this.options.trackUserLocation&&(this._geolocateButton.setAttribute("aria-pressed","false"),this._watchState="OFF"),this.options.showUserLocation&&(this._dotElement=E.create("div","mapboxgl-user-location-dot"),this._userLocationDotMarker=new Ss(this._dotElement),this._circleElement=E.create("div","mapboxgl-user-location-accuracy-circle"),this._accuracyCircleMarker=new Ss({element:this._circleElement,pitchAlignment:"map"}),this.options.trackUserLocation&&(this._watchState="OFF"),this._map.on("zoom",this._onZoom)),this._geolocateButton.addEventListener("click",this.trigger.bind(this)),this._setup=!0,this.options.trackUserLocation&&this._map.on("movestart",function(S){S.geolocateSource||c._watchState!=="ACTIVE_LOCK"||S.originalEvent&&S.originalEvent.type==="resize"||(c._watchState="BACKGROUND",c._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background"),c._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),c.fire(new a.Event("trackuserlocationend")))})},s.prototype.trigger=function(){if(!this._setup)return a.warnOnce("Geolocate control triggered before added to a map"),!1;if(this.options.trackUserLocation){switch(this._watchState){case"OFF":this._watchState="WAITING_ACTIVE",this.fire(new a.Event("trackuserlocationstart"));break;case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":case"BACKGROUND_ERROR":Xo--,zo=!1,this._watchState="OFF",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this.fire(new a.Event("trackuserlocationend"));break;case"BACKGROUND":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._lastKnownPosition&&this._updateCamera(this._lastKnownPosition),this.fire(new a.Event("trackuserlocationstart"))}switch(this._watchState){case"WAITING_ACTIVE":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"ACTIVE_LOCK":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"ACTIVE_ERROR":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error");break;case"BACKGROUND":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background");break;case"BACKGROUND_ERROR":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background-error")}if(this._watchState==="OFF"&&this._geolocationWatchID!==void 0)this._clearWatch();else if(this._geolocationWatchID===void 0){var o;this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","true"),++Xo>1?(o={maximumAge:6e5,timeout:0},zo=!0):(o=this.options.positionOptions,zo=!1),this._geolocationWatchID=a.window.navigator.geolocation.watchPosition(this._onSuccess,this._onError,o)}}else a.window.navigator.geolocation.getCurrentPosition(this._onSuccess,this._onError,this.options.positionOptions),this._timeoutId=setTimeout(this._finish,1e4);return!0},s.prototype._clearWatch=function(){a.window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0,this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","false"),this.options.showUserLocation&&this._updateMarker(null)},s}(a.Evented),Ja={maxWidth:100,unit:"metric"},Ya=function(n){this.options=a.extend({},Ja,n),a.bindAll(["_onMove","setUnit"],this)};function il(n,s,o){var c=o&&o.maxWidth||100,_=n._container.clientHeight/2,w=n.unproject([0,_]),S=n.unproject([c,_]),z=w.distanceTo(S);if(o&&o.unit==="imperial"){var P=3.2808*z;P>5280?Qa(s,c,P/5280,n._getUIString("ScaleControl.Miles")):Qa(s,c,P,n._getUIString("ScaleControl.Feet"))}else o&&o.unit==="nautical"?Qa(s,c,z/1852,n._getUIString("ScaleControl.NauticalMiles")):z>=1e3?Qa(s,c,z/1e3,n._getUIString("ScaleControl.Kilometers")):Qa(s,c,z,n._getUIString("ScaleControl.Meters"))}function Qa(n,s,o,c){var _,w,S,z=(_=o,(w=Math.pow(10,(""+Math.floor(_)).length-1))*(S=(S=_/w)>=10?10:S>=5?5:S>=3?3:S>=2?2:S>=1?1:function(P){var O=Math.pow(10,Math.ceil(-Math.log(P)/Math.LN10));return Math.round(P*O)/O}(S)));n.style.width=s*(z/o)+"px",n.innerHTML=z+"&nbsp;"+c}Ya.prototype.getDefaultPosition=function(){return"bottom-left"},Ya.prototype._onMove=function(){il(this._map,this._container,this.options)},Ya.prototype.onAdd=function(n){return this._map=n,this._container=E.create("div","mapboxgl-ctrl mapboxgl-ctrl-scale",n.getContainer()),this._map.on("move",this._onMove),this._onMove(),this._container},Ya.prototype.onRemove=function(){E.remove(this._container),this._map.off("move",this._onMove),this._map=void 0},Ya.prototype.setUnit=function(n){this.options.unit=n,il(this._map,this._container,this.options)};var oa=function(n){this._fullscreen=!1,n&&n.container&&(n.container instanceof a.window.HTMLElement?this._container=n.container:a.warnOnce("Full screen control 'container' must be a DOM element.")),a.bindAll(["_onClickFullscreen","_changeIcon"],this),"onfullscreenchange"in a.window.document?this._fullscreenchange="fullscreenchange":"onmozfullscreenchange"in a.window.document?this._fullscreenchange="mozfullscreenchange":"onwebkitfullscreenchange"in a.window.document?this._fullscreenchange="webkitfullscreenchange":"onmsfullscreenchange"in a.window.document&&(this._fullscreenchange="MSFullscreenChange")};oa.prototype.onAdd=function(n){return this._map=n,this._container||(this._container=this._map.getContainer()),this._controlContainer=E.create("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._checkFullscreenSupport()?this._setupUI():(this._controlContainer.style.display="none",a.warnOnce("This device does not support fullscreen mode.")),this._controlContainer},oa.prototype.onRemove=function(){E.remove(this._controlContainer),this._map=null,a.window.document.removeEventListener(this._fullscreenchange,this._changeIcon)},oa.prototype._checkFullscreenSupport=function(){return!!(a.window.document.fullscreenEnabled||a.window.document.mozFullScreenEnabled||a.window.document.msFullscreenEnabled||a.window.document.webkitFullscreenEnabled)},oa.prototype._setupUI=function(){var n=this._fullscreenButton=E.create("button","mapboxgl-ctrl-fullscreen",this._controlContainer);E.create("span","mapboxgl-ctrl-icon",n).setAttribute("aria-hidden",!0),n.type="button",this._updateTitle(),this._fullscreenButton.addEventListener("click",this._onClickFullscreen),a.window.document.addEventListener(this._fullscreenchange,this._changeIcon)},oa.prototype._updateTitle=function(){var n=this._getTitle();this._fullscreenButton.setAttribute("aria-label",n),this._fullscreenButton.title=n},oa.prototype._getTitle=function(){return this._map._getUIString(this._isFullscreen()?"FullscreenControl.Exit":"FullscreenControl.Enter")},oa.prototype._isFullscreen=function(){return this._fullscreen},oa.prototype._changeIcon=function(){(a.window.document.fullscreenElement||a.window.document.mozFullScreenElement||a.window.document.webkitFullscreenElement||a.window.document.msFullscreenElement)===this._container!==this._fullscreen&&(this._fullscreen=!this._fullscreen,this._fullscreenButton.classList.toggle("mapboxgl-ctrl-shrink"),this._fullscreenButton.classList.toggle("mapboxgl-ctrl-fullscreen"),this._updateTitle())},oa.prototype._onClickFullscreen=function(){this._isFullscreen()?a.window.document.exitFullscreen?a.window.document.exitFullscreen():a.window.document.mozCancelFullScreen?a.window.document.mozCancelFullScreen():a.window.document.msExitFullscreen?a.window.document.msExitFullscreen():a.window.document.webkitCancelFullScreen&&a.window.document.webkitCancelFullScreen():this._container.requestFullscreen?this._container.requestFullscreen():this._container.mozRequestFullScreen?this._container.mozRequestFullScreen():this._container.msRequestFullscreen?this._container.msRequestFullscreen():this._container.webkitRequestFullscreen&&this._container.webkitRequestFullscreen()};var lu={closeButton:!0,closeOnClick:!0,focusAfterOpen:!0,className:"",maxWidth:"240px"},ks=["a[href]","[tabindex]:not([tabindex='-1'])","[contenteditable]:not([contenteditable='false'])","button:not([disabled])","input:not([disabled])","select:not([disabled])","textarea:not([disabled])"].join(", "),uu=function(n){function s(o){n.call(this),this.options=a.extend(Object.create(lu),o),a.bindAll(["_update","_onClose","remove","_onMouseMove","_onMouseUp","_onDrag"],this)}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype.addTo=function(o){return this._map&&this.remove(),this._map=o,this.options.closeOnClick&&this._map.on("click",this._onClose),this.options.closeOnMove&&this._map.on("move",this._onClose),this._map.on("remove",this.remove),this._update(),this._focusFirstElement(),this._trackPointer?(this._map.on("mousemove",this._onMouseMove),this._map.on("mouseup",this._onMouseUp),this._container&&this._container.classList.add("mapboxgl-popup-track-pointer"),this._map._canvasContainer.classList.add("mapboxgl-track-pointer")):this._map.on("move",this._update),this.fire(new a.Event("open")),this},s.prototype.isOpen=function(){return!!this._map},s.prototype.remove=function(){return this._content&&E.remove(this._content),this._container&&(E.remove(this._container),delete this._container),this._map&&(this._map.off("move",this._update),this._map.off("move",this._onClose),this._map.off("click",this._onClose),this._map.off("remove",this.remove),this._map.off("mousemove",this._onMouseMove),this._map.off("mouseup",this._onMouseUp),this._map.off("drag",this._onDrag),delete this._map),this.fire(new a.Event("close")),this},s.prototype.getLngLat=function(){return this._lngLat},s.prototype.setLngLat=function(o){return this._lngLat=a.LngLat.convert(o),this._pos=null,this._trackPointer=!1,this._update(),this._map&&(this._map.on("move",this._update),this._map.off("mousemove",this._onMouseMove),this._container&&this._container.classList.remove("mapboxgl-popup-track-pointer"),this._map._canvasContainer.classList.remove("mapboxgl-track-pointer")),this},s.prototype.trackPointer=function(){return this._trackPointer=!0,this._pos=null,this._update(),this._map&&(this._map.off("move",this._update),this._map.on("mousemove",this._onMouseMove),this._map.on("drag",this._onDrag),this._container&&this._container.classList.add("mapboxgl-popup-track-pointer"),this._map._canvasContainer.classList.add("mapboxgl-track-pointer")),this},s.prototype.getElement=function(){return this._container},s.prototype.setText=function(o){return this.setDOMContent(a.window.document.createTextNode(o))},s.prototype.setHTML=function(o){var c,_=a.window.document.createDocumentFragment(),w=a.window.document.createElement("body");for(w.innerHTML=o;c=w.firstChild;)_.appendChild(c);return this.setDOMContent(_)},s.prototype.getMaxWidth=function(){return this._container&&this._container.style.maxWidth},s.prototype.setMaxWidth=function(o){return this.options.maxWidth=o,this._update(),this},s.prototype.setDOMContent=function(o){if(this._content)for(;this._content.hasChildNodes();)this._content.firstChild&&this._content.removeChild(this._content.firstChild);else this._content=E.create("div","mapboxgl-popup-content",this._container);return this._content.appendChild(o),this._createCloseButton(),this._update(),this._focusFirstElement(),this},s.prototype.addClassName=function(o){this._container&&this._container.classList.add(o)},s.prototype.removeClassName=function(o){this._container&&this._container.classList.remove(o)},s.prototype.setOffset=function(o){return this.options.offset=o,this._update(),this},s.prototype.toggleClassName=function(o){if(this._container)return this._container.classList.toggle(o)},s.prototype._createCloseButton=function(){this.options.closeButton&&(this._closeButton=E.create("button","mapboxgl-popup-close-button",this._content),this._closeButton.type="button",this._closeButton.setAttribute("aria-label","Close popup"),this._closeButton.innerHTML="&#215;",this._closeButton.addEventListener("click",this._onClose))},s.prototype._onMouseUp=function(o){this._update(o.point)},s.prototype._onMouseMove=function(o){this._update(o.point)},s.prototype._onDrag=function(o){this._update(o.point)},s.prototype._update=function(o){var c=this;if(this._map&&(this._lngLat||this._trackPointer)&&this._content&&(this._container||(this._container=E.create("div","mapboxgl-popup",this._map.getContainer()),this._tip=E.create("div","mapboxgl-popup-tip",this._container),this._container.appendChild(this._content),this.options.className&&this.options.className.split(" ").forEach(function(K){return c._container.classList.add(K)}),this._trackPointer&&this._container.classList.add("mapboxgl-popup-track-pointer")),this.options.maxWidth&&this._container.style.maxWidth!==this.options.maxWidth&&(this._container.style.maxWidth=this.options.maxWidth),this._map.transform.renderWorldCopies&&!this._trackPointer&&(this._lngLat=Go(this._lngLat,this._pos,this._map.transform)),!this._trackPointer||o)){var _=this._pos=this._trackPointer&&o?o:this._map.project(this._lngLat),w=this.options.anchor,S=function K(X){if(X){if(typeof X=="number"){var re=Math.round(Math.sqrt(.5*Math.pow(X,2)));return{center:new a.Point(0,0),top:new a.Point(0,X),"top-left":new a.Point(re,re),"top-right":new a.Point(-re,re),bottom:new a.Point(0,-X),"bottom-left":new a.Point(re,-re),"bottom-right":new a.Point(-re,-re),left:new a.Point(X,0),right:new a.Point(-X,0)}}if(X instanceof a.Point||Array.isArray(X)){var te=a.Point.convert(X);return{center:te,top:te,"top-left":te,"top-right":te,bottom:te,"bottom-left":te,"bottom-right":te,left:te,right:te}}return{center:a.Point.convert(X.center||[0,0]),top:a.Point.convert(X.top||[0,0]),"top-left":a.Point.convert(X["top-left"]||[0,0]),"top-right":a.Point.convert(X["top-right"]||[0,0]),bottom:a.Point.convert(X.bottom||[0,0]),"bottom-left":a.Point.convert(X["bottom-left"]||[0,0]),"bottom-right":a.Point.convert(X["bottom-right"]||[0,0]),left:a.Point.convert(X.left||[0,0]),right:a.Point.convert(X.right||[0,0])}}return K(new a.Point(0,0))}(this.options.offset);if(!w){var z,P=this._container.offsetWidth,O=this._container.offsetHeight;z=_.y+S.bottom.y<O?["top"]:_.y>this._map.transform.height-O?["bottom"]:[],_.x<P/2?z.push("left"):_.x>this._map.transform.width-P/2&&z.push("right"),w=z.length===0?"bottom":z.join("-")}var G=_.add(S[w]).round();E.setTransform(this._container,za[w]+" translate("+G.x+"px,"+G.y+"px)"),rl(this._container,w,"popup")}},s.prototype._focusFirstElement=function(){if(this.options.focusAfterOpen&&this._container){var o=this._container.querySelector(ks);o&&o.focus()}},s.prototype._onClose=function(){this.remove()},s}(a.Evented),nl={version:a.version,supported:T,setRTLTextPlugin:a.setRTLTextPlugin,getRTLTextPluginStatus:a.getRTLTextPluginStatus,Map:Ac,NavigationControl:Da,GeolocateControl:su,AttributionControl:Sn,ScaleControl:Ya,FullscreenControl:oa,Popup:uu,Marker:Ss,Style:jn,LngLat:a.LngLat,LngLatBounds:a.LngLatBounds,Point:a.Point,MercatorCoordinate:a.MercatorCoordinate,Evented:a.Evented,config:a.config,prewarm:function(){ke().acquire(q)},clearPrewarmedResources:function(){var n=tt;n&&(n.isPreloaded()&&n.numActive()===1?(n.release(q),tt=null):console.warn("Could not clear WebWorkers since there are active Map instances that still reference it. The pre-warmed WebWorker pool can only be cleared when all map instances have been removed with map.remove()"))},get accessToken(){return a.config.ACCESS_TOKEN},set accessToken(n){a.config.ACCESS_TOKEN=n},get baseApiUrl(){return a.config.API_URL},set baseApiUrl(n){a.config.API_URL=n},get workerCount(){return _e.workerCount},set workerCount(n){_e.workerCount=n},get maxParallelImageRequests(){return a.config.MAX_PARALLEL_IMAGE_REQUESTS},set maxParallelImageRequests(n){a.config.MAX_PARALLEL_IMAGE_REQUESTS=n},clearStorage:function(n){a.clearTileCache(n)},workerUrl:""};return nl}),y})})(uy);var xh=uy.exports;const q_=d_(xh);function Ed(u){let h;const d=u[15].default,p=Fu(d,u,u[14],null);return{c(){p&&p.c()},l(y){p&&p.l(y)},m(y,v){p&&p.m(y,v),h=!0},p(y,v){p&&p.p&&(!h||v&16384)&&Nu(p,d,y,y[14],h?Vu(d,y[14],v,null):Uu(y[14]),null)},i(y){h||(Qe(p,y),h=!0)},o(y){at(p,y),h=!1},d(y){p&&p.d(y)}}}function Z_(u){let h,d,p,y=u[0]&&Ed(u);return{c(){h=Fe("div"),y&&y.c(),this.h()},l(v){h=Ne(v,"DIV",{class:!0,id:!0});var a=Be(h);y&&y.l(a),a.forEach(ae),this.h()},h(){oe(h,"class","absolute top-0 bg-grey4 w-full h-full svelte-a65d1y"),oe(h,"id",u[1]),Ku(()=>u[16].call(h))},m(v,a){Le(v,h,a),y&&y.m(h,null),d=Xu(h,u[16].bind(h)),u[17](h),p=!0},p(v,[a]){v[0]?y?(y.p(v,a),a&1&&Qe(y,1)):(y=Ed(v),y.c(),Qe(y,1),y.m(h,null)):y&&(An(),at(y,1,1,()=>{y=null}),Pn()),(!p||a&2)&&oe(h,"id",v[1])},i(v){p||(Qe(y),p=!0)},o(v){at(y),p=!1},d(v){v&&ae(h),y&&y.d(),d(),u[17](null)}}}function G_(u,h,d){let{$$slots:p={},$$scope:y}=h,{map:v}=h,{id:a="map"}=h,{location:T={bounds:[[-8.1775,54.02275],[-5.43279,55.31298]]}}=h,{style:E="https://raw.githubusercontent.com/nisra-explore/map_tiles/main/basemap_styles/style-omt.json"}=h,{interactive:M=!0}=h,{minzoom:F=0}=h,{maxzoom:R=14}=h,{zoom:D=null}=h,{scrollzoom:H=!0}=h,{geolocate:ie=!0}=h,{zoomcontrol:de=!0}=h,{options:fe={}}=h,we,xe;iy("map",{getMap:()=>v}),T.bounds?fe={...fe,bounds:T.bounds}:T.lon&&T.lat&&(fe={...fe,center:[T.lon,T.lat]},T.zoom&&(fe.zoom=T.zoom)),ny(()=>{const Je=document.createElement("link");return Je.rel="stylesheet",Je.href="https://unpkg.com/mapbox-gl@1.13.0/dist/mapbox-gl.css",Je.onload=()=>{d(0,v=new xh.Map({container:we,style:E,minZoom:F,maxZoom:R,maxBounds:[[-9.2,53.58],[-4.53,55.72]],interactive:M,...fe})),de&&v.addControl(new xh.NavigationControl({showCompass:!1})),H||v.scrollZoom.disable(),ie&&v.addControl(new xh.GeolocateControl),v.on("load",()=>{d(4,D=v.getZoom())}),v.on("zoom",()=>{d(4,D=v.getZoom())})},document.head.appendChild(Je),()=>{v.remove(),Je.parentNode.removeChild(Je)}});function st(){let Je=document.getElementsByClassName("mapboxgl-canvas");Je[0]&&(Je[0].style.width="100%",v.resize())}function $e(){xe=this.clientWidth,d(2,xe)}function Me(Je){ju[Je?"unshift":"push"](()=>{we=Je,d(3,we)})}return u.$$set=Je=>{"map"in Je&&d(0,v=Je.map),"id"in Je&&d(1,a=Je.id),"location"in Je&&d(6,T=Je.location),"style"in Je&&d(7,E=Je.style),"interactive"in Je&&d(8,M=Je.interactive),"minzoom"in Je&&d(9,F=Je.minzoom),"maxzoom"in Je&&d(10,R=Je.maxzoom),"zoom"in Je&&d(4,D=Je.zoom),"scrollzoom"in Je&&d(11,H=Je.scrollzoom),"geolocate"in Je&&d(12,ie=Je.geolocate),"zoomcontrol"in Je&&d(13,de=Je.zoomcontrol),"options"in Je&&d(5,fe=Je.options),"$$scope"in Je&&d(14,y=Je.$$scope)},u.$$.update=()=>{u.$$.dirty&4&&xe&&st()},[v,a,xe,we,D,fe,T,E,M,F,R,H,ie,de,y,p,$e,Me]}class K_ extends mn{constructor(h){super(),yn(this,h,G_,Z_,gn,{map:0,id:1,location:6,style:7,interactive:8,minzoom:9,maxzoom:10,zoom:4,scrollzoom:11,geolocate:12,zoomcontrol:13,options:5})}}function Td(u){let h;const d=u[11].default,p=Fu(d,u,u[10],null);return{c(){p&&p.c()},l(y){p&&p.l(y)},m(y,v){p&&p.m(y,v),h=!0},p(y,v){p&&p.p&&(!h||v&1024)&&Nu(p,d,y,y[10],h?Vu(d,y[10],v,null):Uu(y[10]),null)},i(y){h||(Qe(p,y),h=!0)},o(y){at(p,y),h=!1},d(y){p&&p.d(y)}}}function X_(u){let h,d,p=u[0]&&Td(u);return{c(){p&&p.c(),h=cr()},l(y){p&&p.l(y),h=cr()},m(y,v){p&&p.m(y,v),Le(y,h,v),d=!0},p(y,[v]){y[0]?p?(p.p(y,v),v&1&&Qe(p,1)):(p=Td(y),p.c(),Qe(p,1),p.m(h.parentNode,h)):p&&(An(),at(p,1,1,()=>{p=null}),Pn())},i(y){d||(Qe(p),d=!0)},o(y){at(p),d=!1},d(y){p&&p.d(y),y&&ae(h)}}}function W_(u,h,d){let{$$slots:p={},$$scope:y}=h,{id:v}=h,{type:a}=h,{url:T=null}=h,{props:E={}}=h,{data:M=null}=h,{layer:F=null}=h,{promoteId:R=null}=h,{minzoom:D=null}=h,{maxzoom:H=null}=h,ie=!1;const{getMap:de}=Wu("map"),fe=de();fe.getSource(v)&&fe.removeSource(v);function we(){fe.isSourceLoaded(v)?(d(0,ie=!0),console.log(v+" loaded!")):setTimeout(()=>{console.log("..."),we()},500)}function xe(){fe.isStyleLoaded(v)?(st(),document.querySelector("#map canvas")&&document.querySelector("#map canvas").tabIndex=="0"&&(document.querySelector("#map canvas").tabIndex="-1")):setTimeout(()=>{console.log("..."),xe()},500)}D&&(E.minzoom=D),H&&(E.maxzoom=H),F&&R?(E.promoteId={},E.promoteId[F]=R):R&&(E.promoteId=R);function st(){console.log(v+" map source loading..."),a=="geojson"?M?(fe.addSource(v,{type:a,data:M,...E}),we()):T&&(fe.addSource(v,{type:a,data:T,...E}),we()):a=="vector"&&(fe.addSource(v,{type:a,tiles:[T],...E}),we())}xe();function $e(){fe.getSource(v).setData(M)}return u.$$set=Me=>{"id"in Me&&d(2,v=Me.id),"type"in Me&&d(3,a=Me.type),"url"in Me&&d(4,T=Me.url),"props"in Me&&d(1,E=Me.props),"data"in Me&&d(5,M=Me.data),"layer"in Me&&d(6,F=Me.layer),"promoteId"in Me&&d(7,R=Me.promoteId),"minzoom"in Me&&d(8,D=Me.minzoom),"maxzoom"in Me&&d(9,H=Me.maxzoom),"$$scope"in Me&&d(10,y=Me.$$scope)},u.$$.update=()=>{u.$$.dirty&33&&ie&&M&&$e()},[ie,E,v,a,T,M,F,R,D,H,y,p]}class H_ extends mn{constructor(h){super(),yn(this,h,W_,X_,gn,{id:2,type:3,url:4,props:1,data:5,layer:6,promoteId:7,minzoom:8,maxzoom:9})}}function J_(u,h,d){const{Popup:p}=q_,y=s_(),v=new p({closeButton:!1,closeOnClick:!1});let{id:a}=h,{source:T}=h,{sourceLayer:E=null}=h,{type:M}=h,{filter:F=null}=h,{layout:R={}}=h,{paint:D={}}=h,{data:H=null}=h,{code:ie=null}=h,{name:de="name"}=h,{colorCode:fe=null}=h,{click:we=!1}=h,{ignoreClick:xe=!1}=h,{clickCenter:st=!1}=h,{selected:$e=null}=h,{hover:Me=!1}=h,{hovered:Je=null}=h,{highlight:ct=!1}=h,{highlightKey:Ue="highlighted"}=h,{highlighted:ht=[]}=h,{order:_t=null}=h,{maxzoom:pt=null}=h,{minzoom:Nt=null}=h,{isChild:bt=!1}=h;const{getMap:zt}=Wu("map"),rt=zt();let Zt=null,gt=null,It=[];rt.getLayer(a)&&rt.removeLayer(a);let jt={id:a,type:M,source:T,paint:D,layout:R};F&&(jt.filter=F),E&&(jt["source-layer"]=E),pt&&(jt.maxzoom=pt),Nt&&(jt.minzoom=Nt),rt.addLayer(jt,_t);function ei(){console.log("updating colors..."),H.forEach(We=>{rt.setFeatureState({source:T,sourceLayer:E,id:We[ie]},{color:We[fe]})})}return we&&rt.on("click",a,We=>{if(We.features.length>0&&!xe){let At=We.features[0].id;if(bt&&ht.includes(At)||!bt&&$e!=At){if(d(0,$e=At),y("select",{code:$e}),Zt&&rt.setFeatureState({source:T,sourceLayer:E,id:Zt},{selected:!1}),rt.setFeatureState({source:T,sourceLayer:E,id:$e},{selected:!0}),st){let mr=centroid(We.features[0].toJSON().geometry);rt.flyTo({center:mr.geometry.coordinates})}d(24,Zt=$e)}}}),Me&&(rt.on("mousemove",a,We=>{if(We.features.length>0){let At=We.features[0].id;Je&&rt.setFeatureState({source:T,sourceLayer:E,id:Je},{hovered:!1}),bt&&ht.includes(At)||!bt&&$e!=At?(d(1,Je=d(25,gt=At)),rt.setFeatureState({source:T,sourceLayer:E,id:Je},{hovered:!0}),rt.getCanvas().style.cursor="pointer",v.setLngLat(We.lngLat).setHTML(`<strong>${We.features[0].properties[de]?We.features[0].properties[de]:We.features[0].properties[ie]}</strong>`).addTo(rt)):v.remove()}}),rt.on("mouseleave",a,We=>{Je&&rt.setFeatureState({source:T,sourceLayer:E,id:Je},{hovered:!1}),d(1,Je=d(25,gt=null)),rt.getCanvas().style.cursor="",v.remove()})),u.$$set=We=>{"id"in We&&d(2,a=We.id),"source"in We&&d(3,T=We.source),"sourceLayer"in We&&d(4,E=We.sourceLayer),"type"in We&&d(5,M=We.type),"filter"in We&&d(6,F=We.filter),"layout"in We&&d(7,R=We.layout),"paint"in We&&d(8,D=We.paint),"data"in We&&d(9,H=We.data),"code"in We&&d(10,ie=We.code),"name"in We&&d(11,de=We.name),"colorCode"in We&&d(12,fe=We.colorCode),"click"in We&&d(13,we=We.click),"ignoreClick"in We&&d(14,xe=We.ignoreClick),"clickCenter"in We&&d(15,st=We.clickCenter),"selected"in We&&d(0,$e=We.selected),"hover"in We&&d(16,Me=We.hover),"hovered"in We&&d(1,Je=We.hovered),"highlight"in We&&d(17,ct=We.highlight),"highlightKey"in We&&d(18,Ue=We.highlightKey),"highlighted"in We&&d(19,ht=We.highlighted),"order"in We&&d(20,_t=We.order),"maxzoom"in We&&d(21,pt=We.maxzoom),"minzoom"in We&&d(22,Nt=We.minzoom),"isChild"in We&&d(23,bt=We.isChild)},u.$$.update=()=>{u.$$.dirty[0]&4096&&fe&&ei(),u.$$.dirty[0]&68026392&&ct&&ht!=It&&(It[0]&&It.forEach(We=>{let At={};At[Ue]=!1,rt.setFeatureState({source:T,sourceLayer:E,id:We},At)}),d(26,It=ht),ht[0]&&ht.forEach(We=>{let At={};At[Ue]=!0,rt.setFeatureState({source:T,sourceLayer:E,id:We},At)})),u.$$.dirty[0]&16777241&&$e!=Zt&&(Zt&&rt.setFeatureState({source:T,sourceLayer:E,id:Zt},{selected:!1}),$e&&rt.setFeatureState({source:T,sourceLayer:E,id:$e},{selected:!0}),d(24,Zt=$e)),u.$$.dirty[0]&33619994&&Me&&Je!=gt&&(gt&&rt.setFeatureState({source:T,sourceLayer:E,id:gt},{hovered:!1}),Je&&rt.setFeatureState({source:T,sourceLayer:E,id:Je},{hovered:!0}),d(25,gt=Je))},[$e,Je,a,T,E,M,F,R,D,H,ie,de,fe,we,xe,st,Me,ct,Ue,ht,_t,pt,Nt,bt,Zt,gt,It]}class Pp extends mn{constructor(h){super(),yn(this,h,J_,null,gn,{id:2,source:3,sourceLayer:4,type:5,filter:6,layout:7,paint:8,data:9,code:10,name:11,colorCode:12,click:13,ignoreClick:14,clickCenter:15,selected:0,hover:16,hovered:1,highlight:17,highlightKey:18,highlighted:19,order:20,maxzoom:21,minzoom:22,isChild:23},null,[-1,-1])}}function Y_(u){return u===0?!0:u}function is(u){return Y_(u)?Array.isArray(u)?h=>u.map(d=>typeof d!="function"?h[d]:d(h)):typeof u!="function"?h=>h[u]:u:null}function Q_(u){const h={};for(const d of u){if(Object(d)!==d)throw new TypeError("iterable for fromEntries should yield objects");const{"0":p,"1":y}=d;Object.defineProperty(h,p,{configurable:!0,enumerable:!0,writable:!0,value:y})}return h}function Cp(u,h={}){return Q_(Object.entries(u).filter(([d,p])=>p!==void 0&&h[d]===void 0))}function $_(u,h){if(!Array.isArray(u))throw new TypeError(`The first argument of calcExtents() must be an array. You passed in a ${typeof u}. Consider passing a flat array to the \`flatData\` prop. More info: https://layercake.graphics/guide/#flatdata`);if(Array.isArray(h)||h===void 0||h===null)throw new TypeError("The second argument of calcExtents() must be an object with field names as keys as accessor functions as values.");const d={},p=Object.keys(h),y=p.length;let v,a,T,E,M,F,R,D;const H=u.length;for(v=0;v<y;v+=1){for(E=p[v],R=h[E],M=null,F=null,a=0;a<H;a+=1)if(D=R(u[a]),Array.isArray(D)){const ie=D.length;for(T=0;T<ie;T+=1)D[T]!==void 0&&D[T]!==null&&Number.isNaN(D[T])===!1&&((M===null||D[T]<M)&&(M=D[T]),(F===null||D[T]>F)&&(F=D[T]))}else D!=null&&Number.isNaN(D)===!1&&((M===null||D<M)&&(M=D),(F===null||D>F)&&(F=D));d[E]=[M,F]}return d}function cy(u=[],h){return Array.isArray(h)===!0?h.map((d,p)=>d===null?u[p]:d):u}function uh(u){return function([d,p]){return d?cy(d[u],p):p}}function wh(u,h){return u==null||h==null?NaN:u<h?-1:u>h?1:u>=h?0:NaN}function ev(u,h){return u==null||h==null?NaN:h<u?-1:h>u?1:h>=u?0:NaN}function hy(u){let h,d,p;u.length!==2?(h=wh,d=(T,E)=>wh(u(T),E),p=(T,E)=>u(T)-E):(h=u===wh||u===ev?u:tv,d=u,p=u);function y(T,E,M=0,F=T.length){if(M<F){if(h(E,E)!==0)return F;do{const R=M+F>>>1;d(T[R],E)<0?M=R+1:F=R}while(M<F)}return M}function v(T,E,M=0,F=T.length){if(M<F){if(h(E,E)!==0)return F;do{const R=M+F>>>1;d(T[R],E)<=0?M=R+1:F=R}while(M<F)}return M}function a(T,E,M=0,F=T.length){const R=y(T,E,M,F-1);return R>M&&p(T[R-1],E)>-p(T[R],E)?R-1:R}return{left:y,center:a,right:v}}function tv(){return 0}function rv(u){return u===null?NaN:+u}const iv=hy(wh),nv=iv.right;hy(rv).center;const av=nv;class zd extends Map{constructor(h,d=lv){if(super(),Object.defineProperties(this,{_intern:{value:new Map},_key:{value:d}}),h!=null)for(const[p,y]of h)this.set(p,y)}get(h){return super.get(Id(this,h))}has(h){return super.has(Id(this,h))}set(h,d){return super.set(ov(this,h),d)}delete(h){return super.delete(sv(this,h))}}function Id({_intern:u,_key:h},d){const p=h(d);return u.has(p)?u.get(p):d}function ov({_intern:u,_key:h},d){const p=h(d);return u.has(p)?u.get(p):(u.set(p,d),d)}function sv({_intern:u,_key:h},d){const p=h(d);return u.has(p)&&(d=u.get(p),u.delete(p)),d}function lv(u){return u!==null&&typeof u=="object"?u.valueOf():u}var Rp=Math.sqrt(50),Bp=Math.sqrt(10),Op=Math.sqrt(2);function uv(u,h,d){var p,y=-1,v,a,T;if(h=+h,u=+u,d=+d,u===h&&d>0)return[u];if((p=h<u)&&(v=u,u=h,h=v),(T=py(u,h,d))===0||!isFinite(T))return[];if(T>0){let E=Math.round(u/T),M=Math.round(h/T);for(E*T<u&&++E,M*T>h&&--M,a=new Array(v=M-E+1);++y<v;)a[y]=(E+y)*T}else{T=-T;let E=Math.round(u*T),M=Math.round(h*T);for(E/T<u&&++E,M/T>h&&--M,a=new Array(v=M-E+1);++y<v;)a[y]=(E+y)/T}return p&&a.reverse(),a}function py(u,h,d){var p=(h-u)/Math.max(0,d),y=Math.floor(Math.log(p)/Math.LN10),v=p/Math.pow(10,y);return y>=0?(v>=Rp?10:v>=Bp?5:v>=Op?2:1)*Math.pow(10,y):-Math.pow(10,-y)/(v>=Rp?10:v>=Bp?5:v>=Op?2:1)}function cv(u,h,d){var p=Math.abs(h-u)/Math.max(0,d),y=Math.pow(10,Math.floor(Math.log(p)/Math.LN10)),v=p/y;return v>=Rp?y*=10:v>=Bp?y*=5:v>=Op&&(y*=2),h<u?-y:y}function hv(u,h,d){u=+u,h=+h,d=(y=arguments.length)<2?(h=u,u=0,1):y<3?1:+d;for(var p=-1,y=Math.max(0,Math.ceil((h-u)/d))|0,v=new Array(y);++p<y;)v[p]=u+p*d;return v}function Lh(u,h){switch(arguments.length){case 0:break;case 1:this.range(u);break;default:this.range(h).domain(u);break}return this}const Ad=Symbol("implicit");function fy(){var u=new zd,h=[],d=[],p=Ad;function y(v){let a=u.get(v);if(a===void 0){if(p!==Ad)return p;u.set(v,a=h.push(v)-1)}return d[a%d.length]}return y.domain=function(v){if(!arguments.length)return h.slice();h=[],u=new zd;for(const a of v)u.has(a)||u.set(a,h.push(a)-1);return y},y.range=function(v){return arguments.length?(d=Array.from(v),y):d.slice()},y.unknown=function(v){return arguments.length?(p=v,y):p},y.copy=function(){return fy(h,d).unknown(p)},Lh.apply(y,arguments),y}function dy(){var u=fy().unknown(void 0),h=u.domain,d=u.range,p=0,y=1,v,a,T=!1,E=0,M=0,F=.5;delete u.unknown;function R(){var D=h().length,H=y<p,ie=H?y:p,de=H?p:y;v=(de-ie)/Math.max(1,D-E+M*2),T&&(v=Math.floor(v)),ie+=(de-ie-v*(D-E))*F,a=v*(1-E),T&&(ie=Math.round(ie),a=Math.round(a));var fe=hv(D).map(function(we){return ie+v*we});return d(H?fe.reverse():fe)}return u.domain=function(D){return arguments.length?(h(D),R()):h()},u.range=function(D){return arguments.length?([p,y]=D,p=+p,y=+y,R()):[p,y]},u.rangeRound=function(D){return[p,y]=D,p=+p,y=+y,T=!0,R()},u.bandwidth=function(){return a},u.step=function(){return v},u.round=function(D){return arguments.length?(T=!!D,R()):T},u.padding=function(D){return arguments.length?(E=Math.min(1,M=+D),R()):E},u.paddingInner=function(D){return arguments.length?(E=Math.min(1,D),R()):E},u.paddingOuter=function(D){return arguments.length?(M=+D,R()):M},u.align=function(D){return arguments.length?(F=Math.max(0,Math.min(1,D)),R()):F},u.copy=function(){return dy(h(),[p,y]).round(T).paddingInner(E).paddingOuter(M).align(F)},Lh.apply(R(),arguments)}function Kp(u,h,d){u.prototype=h.prototype=d,d.constructor=u}function my(u,h){var d=Object.create(u.prototype);for(var p in h)d[p]=h[p];return d}function ic(){}var qu=.7,Eh=1/qu,Rl="\\s*([+-]?\\d+)\\s*",Zu="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",uo="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",pv=/^#([0-9a-f]{3,8})$/,fv=new RegExp(`^rgb\\(${Rl},${Rl},${Rl}\\)$`),dv=new RegExp(`^rgb\\(${uo},${uo},${uo}\\)$`),mv=new RegExp(`^rgba\\(${Rl},${Rl},${Rl},${Zu}\\)$`),yv=new RegExp(`^rgba\\(${uo},${uo},${uo},${Zu}\\)$`),gv=new RegExp(`^hsl\\(${Zu},${uo},${uo}\\)$`),_v=new RegExp(`^hsla\\(${Zu},${uo},${uo},${Zu}\\)$`),Pd={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};Kp(ic,Gu,{copy(u){return Object.assign(new this.constructor,this,u)},displayable(){return this.rgb().displayable()},hex:Cd,formatHex:Cd,formatHex8:vv,formatHsl:bv,formatRgb:Md,toString:Md});function Cd(){return this.rgb().formatHex()}function vv(){return this.rgb().formatHex8()}function bv(){return yy(this).formatHsl()}function Md(){return this.rgb().formatRgb()}function Gu(u){var h,d;return u=(u+"").trim().toLowerCase(),(h=pv.exec(u))?(d=h[1].length,h=parseInt(h[1],16),d===6?Dd(h):d===3?new ha(h>>8&15|h>>4&240,h>>4&15|h&240,(h&15)<<4|h&15,1):d===8?ch(h>>24&255,h>>16&255,h>>8&255,(h&255)/255):d===4?ch(h>>12&15|h>>8&240,h>>8&15|h>>4&240,h>>4&15|h&240,((h&15)<<4|h&15)/255):null):(h=fv.exec(u))?new ha(h[1],h[2],h[3],1):(h=dv.exec(u))?new ha(h[1]*255/100,h[2]*255/100,h[3]*255/100,1):(h=mv.exec(u))?ch(h[1],h[2],h[3],h[4]):(h=yv.exec(u))?ch(h[1]*255/100,h[2]*255/100,h[3]*255/100,h[4]):(h=gv.exec(u))?Bd(h[1],h[2]/100,h[3]/100,1):(h=_v.exec(u))?Bd(h[1],h[2]/100,h[3]/100,h[4]):Pd.hasOwnProperty(u)?Dd(Pd[u]):u==="transparent"?new ha(NaN,NaN,NaN,0):null}function Dd(u){return new ha(u>>16&255,u>>8&255,u&255,1)}function ch(u,h,d,p){return p<=0&&(u=h=d=NaN),new ha(u,h,d,p)}function xv(u){return u instanceof ic||(u=Gu(u)),u?(u=u.rgb(),new ha(u.r,u.g,u.b,u.opacity)):new ha}function Fp(u,h,d,p){return arguments.length===1?xv(u):new ha(u,h,d,p??1)}function ha(u,h,d,p){this.r=+u,this.g=+h,this.b=+d,this.opacity=+p}Kp(ha,Fp,my(ic,{brighter(u){return u=u==null?Eh:Math.pow(Eh,u),new ha(this.r*u,this.g*u,this.b*u,this.opacity)},darker(u){return u=u==null?qu:Math.pow(qu,u),new ha(this.r*u,this.g*u,this.b*u,this.opacity)},rgb(){return this},clamp(){return new ha(Os(this.r),Os(this.g),Os(this.b),Th(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:Ld,formatHex:Ld,formatHex8:wv,formatRgb:Rd,toString:Rd}));function Ld(){return`#${Bs(this.r)}${Bs(this.g)}${Bs(this.b)}`}function wv(){return`#${Bs(this.r)}${Bs(this.g)}${Bs(this.b)}${Bs((isNaN(this.opacity)?1:this.opacity)*255)}`}function Rd(){const u=Th(this.opacity);return`${u===1?"rgb(":"rgba("}${Os(this.r)}, ${Os(this.g)}, ${Os(this.b)}${u===1?")":`, ${u})`}`}function Th(u){return isNaN(u)?1:Math.max(0,Math.min(1,u))}function Os(u){return Math.max(0,Math.min(255,Math.round(u)||0))}function Bs(u){return u=Os(u),(u<16?"0":"")+u.toString(16)}function Bd(u,h,d,p){return p<=0?u=h=d=NaN:d<=0||d>=1?u=h=NaN:h<=0&&(u=NaN),new Fa(u,h,d,p)}function yy(u){if(u instanceof Fa)return new Fa(u.h,u.s,u.l,u.opacity);if(u instanceof ic||(u=Gu(u)),!u)return new Fa;if(u instanceof Fa)return u;u=u.rgb();var h=u.r/255,d=u.g/255,p=u.b/255,y=Math.min(h,d,p),v=Math.max(h,d,p),a=NaN,T=v-y,E=(v+y)/2;return T?(h===v?a=(d-p)/T+(d<p)*6:d===v?a=(p-h)/T+2:a=(h-d)/T+4,T/=E<.5?v+y:2-v-y,a*=60):T=E>0&&E<1?0:a,new Fa(a,T,E,u.opacity)}function Sv(u,h,d,p){return arguments.length===1?yy(u):new Fa(u,h,d,p??1)}function Fa(u,h,d,p){this.h=+u,this.s=+h,this.l=+d,this.opacity=+p}Kp(Fa,Sv,my(ic,{brighter(u){return u=u==null?Eh:Math.pow(Eh,u),new Fa(this.h,this.s,this.l*u,this.opacity)},darker(u){return u=u==null?qu:Math.pow(qu,u),new Fa(this.h,this.s,this.l*u,this.opacity)},rgb(){var u=this.h%360+(this.h<0)*360,h=isNaN(u)||isNaN(this.s)?0:this.s,d=this.l,p=d+(d<.5?d:1-d)*h,y=2*d-p;return new ha(Mp(u>=240?u-240:u+120,y,p),Mp(u,y,p),Mp(u<120?u+240:u-120,y,p),this.opacity)},clamp(){return new Fa(Od(this.h),hh(this.s),hh(this.l),Th(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){const u=Th(this.opacity);return`${u===1?"hsl(":"hsla("}${Od(this.h)}, ${hh(this.s)*100}%, ${hh(this.l)*100}%${u===1?")":`, ${u})`}`}}));function Od(u){return u=(u||0)%360,u<0?u+360:u}function hh(u){return Math.max(0,Math.min(1,u||0))}function Mp(u,h,d){return(u<60?h+(d-h)*u/60:u<180?d:u<240?h+(d-h)*(240-u)/60:h)*255}const Xp=u=>()=>u;function kv(u,h){return function(d){return u+d*h}}function Ev(u,h,d){return u=Math.pow(u,d),h=Math.pow(h,d)-u,d=1/d,function(p){return Math.pow(u+p*h,d)}}function Tv(u){return(u=+u)==1?gy:function(h,d){return d-h?Ev(h,d,u):Xp(isNaN(h)?d:h)}}function gy(u,h){var d=h-u;return d?kv(u,d):Xp(isNaN(u)?h:u)}const Fd=function u(h){var d=Tv(h);function p(y,v){var a=d((y=Fp(y)).r,(v=Fp(v)).r),T=d(y.g,v.g),E=d(y.b,v.b),M=gy(y.opacity,v.opacity);return function(F){return y.r=a(F),y.g=T(F),y.b=E(F),y.opacity=M(F),y+""}}return p.gamma=u,p}(1);function zv(u,h){h||(h=[]);var d=u?Math.min(h.length,u.length):0,p=h.slice(),y;return function(v){for(y=0;y<d;++y)p[y]=u[y]*(1-v)+h[y]*v;return p}}function Iv(u){return ArrayBuffer.isView(u)&&!(u instanceof DataView)}function Av(u,h){var d=h?h.length:0,p=u?Math.min(d,u.length):0,y=new Array(p),v=new Array(d),a;for(a=0;a<p;++a)y[a]=Wp(u[a],h[a]);for(;a<d;++a)v[a]=h[a];return function(T){for(a=0;a<p;++a)v[a]=y[a](T);return v}}function Pv(u,h){var d=new Date;return u=+u,h=+h,function(p){return d.setTime(u*(1-p)+h*p),d}}function zh(u,h){return u=+u,h=+h,function(d){return u*(1-d)+h*d}}function Cv(u,h){var d={},p={},y;(u===null||typeof u!="object")&&(u={}),(h===null||typeof h!="object")&&(h={});for(y in h)y in u?d[y]=Wp(u[y],h[y]):p[y]=h[y];return function(v){for(y in d)p[y]=d[y](v);return p}}var Np=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,Dp=new RegExp(Np.source,"g");function Mv(u){return function(){return u}}function Dv(u){return function(h){return u(h)+""}}function Lv(u,h){var d=Np.lastIndex=Dp.lastIndex=0,p,y,v,a=-1,T=[],E=[];for(u=u+"",h=h+"";(p=Np.exec(u))&&(y=Dp.exec(h));)(v=y.index)>d&&(v=h.slice(d,v),T[a]?T[a]+=v:T[++a]=v),(p=p[0])===(y=y[0])?T[a]?T[a]+=y:T[++a]=y:(T[++a]=null,E.push({i:a,x:zh(p,y)})),d=Dp.lastIndex;return d<h.length&&(v=h.slice(d),T[a]?T[a]+=v:T[++a]=v),T.length<2?E[0]?Dv(E[0].x):Mv(h):(h=E.length,function(M){for(var F=0,R;F<h;++F)T[(R=E[F]).i]=R.x(M);return T.join("")})}function Wp(u,h){var d=typeof h,p;return h==null||d==="boolean"?Xp(h):(d==="number"?zh:d==="string"?(p=Gu(h))?(h=p,Fd):Lv:h instanceof Gu?Fd:h instanceof Date?Pv:Iv(h)?zv:Array.isArray(h)?Av:typeof h.valueOf!="function"&&typeof h.toString!="function"||isNaN(h)?Cv:zh)(u,h)}function Rv(u,h){return u=+u,h=+h,function(d){return Math.round(u*(1-d)+h*d)}}function Bv(u){return function(){return u}}function Ov(u){return+u}var Nd=[0,1];function lo(u){return u}function Up(u,h){return(h-=u=+u)?function(d){return(d-u)/h}:Bv(isNaN(h)?NaN:.5)}function Fv(u,h){var d;return u>h&&(d=u,u=h,h=d),function(p){return Math.max(u,Math.min(h,p))}}function Nv(u,h,d){var p=u[0],y=u[1],v=h[0],a=h[1];return y<p?(p=Up(y,p),v=d(a,v)):(p=Up(p,y),v=d(v,a)),function(T){return v(p(T))}}function Uv(u,h,d){var p=Math.min(u.length,h.length)-1,y=new Array(p),v=new Array(p),a=-1;for(u[p]<u[0]&&(u=u.slice().reverse(),h=h.slice().reverse());++a<p;)y[a]=Up(u[a],u[a+1]),v[a]=d(h[a],h[a+1]);return function(T){var E=av(u,T,1,p)-1;return v[E](y[E](T))}}function _y(u,h){return h.domain(u.domain()).range(u.range()).interpolate(u.interpolate()).clamp(u.clamp()).unknown(u.unknown())}function vy(){var u=Nd,h=Nd,d=Wp,p,y,v,a=lo,T,E,M;function F(){var D=Math.min(u.length,h.length);return a!==lo&&(a=Fv(u[0],u[D-1])),T=D>2?Uv:Nv,E=M=null,R}function R(D){return D==null||isNaN(D=+D)?v:(E||(E=T(u.map(p),h,d)))(p(a(D)))}return R.invert=function(D){return a(y((M||(M=T(h,u.map(p),zh)))(D)))},R.domain=function(D){return arguments.length?(u=Array.from(D,Ov),F()):u.slice()},R.range=function(D){return arguments.length?(h=Array.from(D),F()):h.slice()},R.rangeRound=function(D){return h=Array.from(D),d=Rv,F()},R.clamp=function(D){return arguments.length?(a=D?!0:lo,F()):a!==lo},R.interpolate=function(D){return arguments.length?(d=D,F()):d},R.unknown=function(D){return arguments.length?(v=D,R):v},function(D,H){return p=D,y=H,F()}}function Vv(){return vy()(lo,lo)}function jv(u){return Math.abs(u=Math.round(u))>=1e21?u.toLocaleString("en").replace(/,/g,""):u.toString(10)}function Ih(u,h){if((d=(u=h?u.toExponential(h-1):u.toExponential()).indexOf("e"))<0)return null;var d,p=u.slice(0,d);return[p.length>1?p[0]+p.slice(2):p,+u.slice(d+1)]}function Bl(u){return u=Ih(Math.abs(u)),u?u[1]:NaN}function qv(u,h){return function(d,p){for(var y=d.length,v=[],a=0,T=u[0],E=0;y>0&&T>0&&(E+T+1>p&&(T=Math.max(1,p-E)),v.push(d.substring(y-=T,y+T)),!((E+=T+1)>p));)T=u[a=(a+1)%u.length];return v.reverse().join(h)}}function Zv(u){return function(h){return h.replace(/[0-9]/g,function(d){return u[+d]})}}var Gv=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function Ah(u){if(!(h=Gv.exec(u)))throw new Error("invalid format: "+u);var h;return new Hp({fill:h[1],align:h[2],sign:h[3],symbol:h[4],zero:h[5],width:h[6],comma:h[7],precision:h[8]&&h[8].slice(1),trim:h[9],type:h[10]})}Ah.prototype=Hp.prototype;function Hp(u){this.fill=u.fill===void 0?" ":u.fill+"",this.align=u.align===void 0?">":u.align+"",this.sign=u.sign===void 0?"-":u.sign+"",this.symbol=u.symbol===void 0?"":u.symbol+"",this.zero=!!u.zero,this.width=u.width===void 0?void 0:+u.width,this.comma=!!u.comma,this.precision=u.precision===void 0?void 0:+u.precision,this.trim=!!u.trim,this.type=u.type===void 0?"":u.type+""}Hp.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(this.width===void 0?"":Math.max(1,this.width|0))+(this.comma?",":"")+(this.precision===void 0?"":"."+Math.max(0,this.precision|0))+(this.trim?"~":"")+this.type};function Kv(u){e:for(var h=u.length,d=1,p=-1,y;d<h;++d)switch(u[d]){case".":p=y=d;break;case"0":p===0&&(p=d),y=d;break;default:if(!+u[d])break e;p>0&&(p=0);break}return p>0?u.slice(0,p)+u.slice(y+1):u}var by;function Xv(u,h){var d=Ih(u,h);if(!d)return u+"";var p=d[0],y=d[1],v=y-(by=Math.max(-8,Math.min(8,Math.floor(y/3)))*3)+1,a=p.length;return v===a?p:v>a?p+new Array(v-a+1).join("0"):v>0?p.slice(0,v)+"."+p.slice(v):"0."+new Array(1-v).join("0")+Ih(u,Math.max(0,h+v-1))[0]}function Ud(u,h){var d=Ih(u,h);if(!d)return u+"";var p=d[0],y=d[1];return y<0?"0."+new Array(-y).join("0")+p:p.length>y+1?p.slice(0,y+1)+"."+p.slice(y+1):p+new Array(y-p.length+2).join("0")}const Vd={"%":(u,h)=>(u*100).toFixed(h),b:u=>Math.round(u).toString(2),c:u=>u+"",d:jv,e:(u,h)=>u.toExponential(h),f:(u,h)=>u.toFixed(h),g:(u,h)=>u.toPrecision(h),o:u=>Math.round(u).toString(8),p:(u,h)=>Ud(u*100,h),r:Ud,s:Xv,X:u=>Math.round(u).toString(16).toUpperCase(),x:u=>Math.round(u).toString(16)};function jd(u){return u}var qd=Array.prototype.map,Zd=["y","z","a","f","p","n","µ","m","","k","M","G","T","P","E","Z","Y"];function Wv(u){var h=u.grouping===void 0||u.thousands===void 0?jd:qv(qd.call(u.grouping,Number),u.thousands+""),d=u.currency===void 0?"":u.currency[0]+"",p=u.currency===void 0?"":u.currency[1]+"",y=u.decimal===void 0?".":u.decimal+"",v=u.numerals===void 0?jd:Zv(qd.call(u.numerals,String)),a=u.percent===void 0?"%":u.percent+"",T=u.minus===void 0?"−":u.minus+"",E=u.nan===void 0?"NaN":u.nan+"";function M(R){R=Ah(R);var D=R.fill,H=R.align,ie=R.sign,de=R.symbol,fe=R.zero,we=R.width,xe=R.comma,st=R.precision,$e=R.trim,Me=R.type;Me==="n"?(xe=!0,Me="g"):Vd[Me]||(st===void 0&&(st=12),$e=!0,Me="g"),(fe||D==="0"&&H==="=")&&(fe=!0,D="0",H="=");var Je=de==="$"?d:de==="#"&&/[boxX]/.test(Me)?"0"+Me.toLowerCase():"",ct=de==="$"?p:/[%p]/.test(Me)?a:"",Ue=Vd[Me],ht=/[defgprs%]/.test(Me);st=st===void 0?6:/[gprs]/.test(Me)?Math.max(1,Math.min(21,st)):Math.max(0,Math.min(20,st));function _t(pt){var Nt=Je,bt=ct,zt,rt,Zt;if(Me==="c")bt=Ue(pt)+bt,pt="";else{pt=+pt;var gt=pt<0||1/pt<0;if(pt=isNaN(pt)?E:Ue(Math.abs(pt),st),$e&&(pt=Kv(pt)),gt&&+pt==0&&ie!=="+"&&(gt=!1),Nt=(gt?ie==="("?ie:T:ie==="-"||ie==="("?"":ie)+Nt,bt=(Me==="s"?Zd[8+by/3]:"")+bt+(gt&&ie==="("?")":""),ht){for(zt=-1,rt=pt.length;++zt<rt;)if(Zt=pt.charCodeAt(zt),48>Zt||Zt>57){bt=(Zt===46?y+pt.slice(zt+1):pt.slice(zt))+bt,pt=pt.slice(0,zt);break}}}xe&&!fe&&(pt=h(pt,1/0));var It=Nt.length+pt.length+bt.length,jt=It<we?new Array(we-It+1).join(D):"";switch(xe&&fe&&(pt=h(jt+pt,jt.length?we-bt.length:1/0),jt=""),H){case"<":pt=Nt+pt+bt+jt;break;case"=":pt=Nt+jt+pt+bt;break;case"^":pt=jt.slice(0,It=jt.length>>1)+Nt+pt+bt+jt.slice(It);break;default:pt=jt+Nt+pt+bt;break}return v(pt)}return _t.toString=function(){return R+""},_t}function F(R,D){var H=M((R=Ah(R),R.type="f",R)),ie=Math.max(-8,Math.min(8,Math.floor(Bl(D)/3)))*3,de=Math.pow(10,-ie),fe=Zd[8+ie/3];return function(we){return H(de*we)+fe}}return{format:M,formatPrefix:F}}var ph,xy,wy;Hv({thousands:",",grouping:[3],currency:["$",""]});function Hv(u){return ph=Wv(u),xy=ph.format,wy=ph.formatPrefix,ph}function Jv(u){return Math.max(0,-Bl(Math.abs(u)))}function Yv(u,h){return Math.max(0,Math.max(-8,Math.min(8,Math.floor(Bl(h)/3)))*3-Bl(Math.abs(u)))}function Qv(u,h){return u=Math.abs(u),h=Math.abs(h)-u,Math.max(0,Bl(h)-Bl(u))+1}function $v(u,h,d,p){var y=cv(u,h,d),v;switch(p=Ah(p??",f"),p.type){case"s":{var a=Math.max(Math.abs(u),Math.abs(h));return p.precision==null&&!isNaN(v=Yv(y,a))&&(p.precision=v),wy(p,a)}case"":case"e":case"g":case"p":case"r":{p.precision==null&&!isNaN(v=Qv(y,Math.max(Math.abs(u),Math.abs(h))))&&(p.precision=v-(p.type==="e"));break}case"f":case"%":{p.precision==null&&!isNaN(v=Jv(y))&&(p.precision=v-(p.type==="%")*2);break}}return xy(p)}function Sy(u){var h=u.domain;return u.ticks=function(d){var p=h();return uv(p[0],p[p.length-1],d??10)},u.tickFormat=function(d,p){var y=h();return $v(y[0],y[y.length-1],d??10,p)},u.nice=function(d){d==null&&(d=10);var p=h(),y=0,v=p.length-1,a=p[y],T=p[v],E,M,F=10;for(T<a&&(M=a,a=T,T=M,M=y,y=v,v=M);F-- >0;){if(M=py(a,T,d),M===E)return p[y]=a,p[v]=T,h(p);if(M>0)a=Math.floor(a/M)*M,T=Math.ceil(T/M)*M;else if(M<0)a=Math.ceil(a*M)/M,T=Math.floor(T*M)/M;else break;E=M}return u},u}function Sh(){var u=Vv();return u.copy=function(){return _y(u,Sh())},Lh.apply(u,arguments),Sy(u)}function Gd(u){return function(h){return h<0?-Math.pow(-h,u):Math.pow(h,u)}}function e0(u){return u<0?-Math.sqrt(-u):Math.sqrt(u)}function t0(u){return u<0?-u*u:u*u}function r0(u){var h=u(lo,lo),d=1;function p(){return d===1?u(lo,lo):d===.5?u(e0,t0):u(Gd(d),Gd(1/d))}return h.exponent=function(y){return arguments.length?(d=+y,p()):d},Sy(h)}function ky(){var u=r0(vy());return u.copy=function(){return _y(u,ky()).exponent(u.exponent())},Lh.apply(u,arguments),u}function i0(){return ky.apply(null,arguments).exponent(.5)}const Bu={x:Sh,y:Sh,z:Sh,r:i0};function n0(u){return u.constant?"symlog":u.base?"log":u.exponent?u.exponent()===.5?"sqrt":"pow":"other"}function Kd(u){return u}function a0(u){return h=>Math.log(u*h)}function o0(u){return h=>u*Math.exp(h)}function s0(u){return h=>Math.sign(h)*Math.log1p(Math.abs(h/u))}function l0(u){return h=>Math.sign(h)*Math.expm1(Math.abs(h))*u}function fh(u){return function(d){return d<0?-Math.pow(-d,u):Math.pow(d,u)}}function u0(u){const h=n0(u);if(h==="log"){const d=Math.sign(u.domain()[0]);return{lift:a0(d),ground:o0(d),scaleType:h}}return h==="pow"?{lift:fh(1),ground:fh(1/1),scaleType:h}:h==="sqrt"?{lift:fh(.5),ground:fh(1/.5),scaleType:h}:h==="symlog"?{lift:s0(1),ground:l0(1),scaleType:h}:{lift:Kd,ground:Kd,scaleType:h}}function c0(u,h){if(typeof u.range!="function")throw new Error("Scale method `range` must be a function");if(typeof u.domain!="function")throw new Error("Scale method `domain` must be a function");if(!Array.isArray(h))return u.domain();u.domain().length!==2&&console.warn("[LayerCake] The scale is expected to have a domain of length 2 to use padding. Are you sure you want to use padding? Your scale's domain is:",u.domain()),u.range().length!==2&&console.warn("[LayerCake] The scale is expected to have a range of length 2 to use padding. Are you sure you want to use padding? Your scale's range is:",u.range());const{lift:d,ground:p}=u0(u),y=u.domain()[0],v=Object.prototype.toString.call(y)==="[object Date]",[a,T]=u.domain().map(H=>d(v?H.getTime():H)),[E,M]=u.range(),F=h[0]||0,R=h[1]||0,D=(T-a)/(Math.abs(M-E)-F-R);return[a-F*D,R*D+T].map(H=>p(v?new Date(H):H))}function h0(u,h,d,p,y){let v,a;return y===!0?(v=0,a=100):(v=u==="r"?1:0,a=u==="y"?d:u==="r"?25:h),p===!0?[a,v]:[v,a]}function p0(u,h,d,p,y,v){return y?typeof y=="function"?y({width:h,height:d}):y:h0(u,h,d,p,v)}function dh(u){return function([d,p,y,v,a,T,E,M,F,R]){if(p===null)return null;const D=p0(u,E,M,T,F,R),H=d===Bu[u]?d():d.copy();return H.domain(cy(p[u],y)).range(D),v&&H.domain(c0(H,v)),a===!0&&(typeof H.nice=="function"?H.nice():console.error(`[Layer Cake] You set \`${u}Nice: true\` but the ${u}Scale does not have a \`.nice\` method. Ignoring...`)),H}}function mh([u,h]){return d=>{const p=u(d);return Array.isArray(p)?p.map(y=>h(y)):h(p)}}function yh([u]){if(typeof u=="function"){if(typeof u.range=="function")return u.range();console.error("[LayerCake] Your scale doesn't have a `.range` method?")}return null}const gh={x:!1,y:!0,z:!1,r:!1};const f0=u=>({element:u[0]&4,width:u[0]&256,height:u[0]&512,aspectRatio:u[0]&1024,containerWidth:u[0]&128,containerHeight:u[0]&64}),Xd=u=>({element:u[2],width:u[8],height:u[9],aspectRatio:u[10],containerWidth:u[7],containerHeight:u[6]});function Wd(u){let h,d,p;const y=u[90].default,v=Fu(y,u,u[89],Xd);return{c(){h=Fe("div"),v&&v.c(),this.h()},l(a){h=Ne(a,"DIV",{class:!0});var T=Be(h);v&&v.l(T),T.forEach(ae),this.h()},h(){oe(h,"class","layercake-container svelte-vhzpsp"),Ku(()=>u[92].call(h)),Ge(h,"position",u[5]),Ge(h,"top",u[5]==="absolute"?"0":null),Ge(h,"right",u[5]==="absolute"?"0":null),Ge(h,"bottom",u[5]==="absolute"?"0":null),Ge(h,"left",u[5]==="absolute"?"0":null),Ge(h,"pointer-events",u[4]===!1?"none":null)},m(a,T){Le(a,h,T),v&&v.m(h,null),u[91](h),d=Xu(h,u[92].bind(h)),p=!0},p(a,T){v&&v.p&&(!p||T[0]&1988|T[2]&134217728)&&Nu(v,y,a,a[89],p?Vu(y,a[89],T,f0):Uu(a[89]),Xd),T[0]&32&&Ge(h,"position",a[5]),T[0]&32&&Ge(h,"top",a[5]==="absolute"?"0":null),T[0]&32&&Ge(h,"right",a[5]==="absolute"?"0":null),T[0]&32&&Ge(h,"bottom",a[5]==="absolute"?"0":null),T[0]&32&&Ge(h,"left",a[5]==="absolute"?"0":null),T[0]&16&&Ge(h,"pointer-events",a[4]===!1?"none":null)},i(a){p||(Qe(v,a),p=!0)},o(a){at(v,a),p=!1},d(a){a&&ae(h),v&&v.d(a),u[91](null),d()}}}function d0(u){let h,d,p=(u[3]===!0||typeof window<"u")&&Wd(u);return{c(){p&&p.c(),h=cr()},l(y){p&&p.l(y),h=cr()},m(y,v){p&&p.m(y,v),Le(y,h,v),d=!0},p(y,v){y[3]===!0||typeof window<"u"?p?(p.p(y,v),v[0]&8&&Qe(p,1)):(p=Wd(y),p.c(),Qe(p,1),p.m(h.parentNode,h)):p&&(An(),at(p,1,1,()=>{p=null}),Pn())},i(y){d||(Qe(p),d=!0)},o(y){at(p),d=!1},d(y){p&&p.d(y),y&&ae(h)}}}function m0(u,h,d){let p,y,v,a,T,E,M,F,R,D,H,ie,de,fe,we,xe,st,$e,Me,Je,ct,Ue,ht,_t,pt,Nt,bt,zt,rt,Zt,gt,It,jt,ei,We,At,mr,Tr,xr,Zr,sr,{$$slots:ti={},$$scope:Wt}=h,{ssr:Gr=!1}=h,{pointerEvents:yr=!0}=h,{position:Nr="relative"}=h,{percentRange:qt=!1}=h,{width:Lr=void 0}=h,{height:Kr=void 0}=h,{containerWidth:hr=Lr||100}=h,{containerHeight:Fi=Kr||100}=h,{element:Cr=void 0}=h,{x:bi=void 0}=h,{y:pi=void 0}=h,{z:Qi=void 0}=h,{r:Mi=void 0}=h,{data:fi=[]}=h,{xDomain:ri=void 0}=h,{yDomain:sn=void 0}=h,{zDomain:di=void 0}=h,{rDomain:Ur=void 0}=h,{xNice:$i=!1}=h,{yNice:On=!1}=h,{zNice:Ni=!1}=h,{rNice:Cn=!1}=h,{xReverse:en=gh.x}=h,{yReverse:Mn=gh.y}=h,{zReverse:Ui=gh.z}=h,{rReverse:_n=gh.r}=h,{xPadding:Vi=void 0}=h,{yPadding:Fn=void 0}=h,{zPadding:tn=void 0}=h,{rPadding:ji=void 0}=h,{xScale:vn=Bu.x}=h,{yScale:ln=Bu.y}=h,{zScale:un=Bu.z}=h,{rScale:bn=Bu.r}=h,{xRange:oi=void 0}=h,{yRange:Mr=void 0}=h,{zRange:L=void 0}=h,{rRange:N=void 0}=h,{padding:V={}}=h,{extents:W={}}=h,{flatData:$=void 0}=h,{custom:se={}}=h,he=!1;ny(()=>{he=!0});const j={},J=Ir(qt);Xt(u,J,ye=>d(128,Tr=ye));const ge=Ir(hr);Xt(u,ge,ye=>d(7,mr=ye));const Ce=Ir(Fi);Xt(u,Ce,ye=>d(6,At=ye));const De=Ir(Cp(W));Xt(u,De,ye=>d(127,We=ye));const q=Ir(fi);Xt(u,q,ye=>d(126,ei=ye));const _e=Ir($||fi);Xt(u,_e,ye=>d(125,jt=ye));const tt=Ir(V);Xt(u,tt,ye=>d(124,It=ye));const He=Ir(is(bi));Xt(u,He,ye=>d(123,gt=ye));const ke=Ir(is(pi));Xt(u,ke,ye=>d(122,Zt=ye));const Xe=Ir(is(Qi));Xt(u,Xe,ye=>d(121,rt=ye));const Oe=Ir(is(Mi));Xt(u,Oe,ye=>d(120,zt=ye));const qe=Ir(ri);Xt(u,qe,ye=>d(119,bt=ye));const Mt=Ir(sn);Xt(u,Mt,ye=>d(118,Nt=ye));const je=Ir(di);Xt(u,je,ye=>d(117,pt=ye));const Vt=Ir(Ur);Xt(u,Vt,ye=>d(116,_t=ye));const lr=Ir($i);Xt(u,lr,ye=>d(115,ht=ye));const Dt=Ir(On);Xt(u,Dt,ye=>d(114,Ue=ye));const nr=Ir(Ni);Xt(u,nr,ye=>d(113,ct=ye));const Jt=Ir(Cn);Xt(u,Jt,ye=>d(112,Je=ye));const ii=Ir(en);Xt(u,ii,ye=>d(111,Me=ye));const $t=Ir(Mn);Xt(u,$t,ye=>d(110,$e=ye));const br=Ir(Ui);Xt(u,br,ye=>d(109,st=ye));const fr=Ir(_n);Xt(u,fr,ye=>d(108,xe=ye));const Gt=Ir(Vi);Xt(u,Gt,ye=>d(107,we=ye));const ar=Ir(Fn);Xt(u,ar,ye=>d(106,fe=ye));const si=Ir(tn);Xt(u,si,ye=>d(105,de=ye));const Nn=Ir(ji);Xt(u,Nn,ye=>d(104,ie=ye));const wr=Ir(oi);Xt(u,wr,ye=>d(103,H=ye));const Di=Ir(Mr);Xt(u,Di,ye=>d(102,D=ye));const Ua=Ir(L);Xt(u,Ua,ye=>d(101,R=ye));const va=Ir(N);Xt(u,va,ye=>d(100,F=ye));const Xr=Ir(vn);Xt(u,Xr,ye=>d(99,M=ye));const ba=Ir(ln);Xt(u,ba,ye=>d(98,E=ye));const ki=Ir(un);Xt(u,ki,ye=>d(97,T=ye));const li=Ir(bn);Xt(u,li,ye=>d(96,a=ye));const cn=Ir(j);Xt(u,cn,ye=>d(94,y=ye));const Rr=Ir(se);Xt(u,Rr,ye=>d(95,v=ye));const Un=Ci([He,ke,Xe,Oe],([ye,hn,Gi,Wr])=>{const ka={};return ye&&(ka.x=ye),hn&&(ka.y=hn),Gi&&(ka.z=Gi),Wr&&(ka.r=Wr),ka}),xn=Ci([tt,ge,Ce],([ye])=>Object.assign({top:0,right:0,bottom:0,left:0},ye)),os=Ci([ge,Ce,xn],([ye,hn,Gi])=>{const Wr={};return Wr.top=Gi.top,Wr.right=ye-Gi.right,Wr.bottom=hn-Gi.bottom,Wr.left=Gi.left,Wr.width=Wr.right-Wr.left,Wr.height=Wr.bottom-Wr.top,Wr.width<=0&&he===!0&&console.warn("[LayerCake] Target div has zero or negative width. Did you forget to set an explicit width in CSS on the container?"),Wr.height<=0&&he===!0&&console.warn("[LayerCake] Target div has zero or negative height. Did you forget to set an explicit height in CSS on the container?"),Wr}),Ei=Ci([os],([ye])=>ye.width);Xt(u,Ei,ye=>d(8,xr=ye));const xa=Ci([os],([ye])=>ye.height);Xt(u,xa,ye=>d(9,Zr=ye));const qi=Ci([_e,Un,De],([ye,hn,Gi])=>{const Wr=Cp(hn,Gi);return Object.keys(Wr).length>0?{...$_(ye,Wr),...Gi}:{}}),Ti=Ci([qi,qe],uh("x")),$n=Ci([qi,Mt],uh("y")),Zi=Ci([qi,je],uh("z")),wa=Ci([qi,Vt],uh("r")),ss=Ci([Xr,qi,Ti,Gt,lr,ii,Ei,xa,wr,J],dh("x")),Nl=Ci([He,ss],mh),co=Ci([ba,qi,$n,ar,Dt,$t,Ei,xa,Di,J],dh("y")),Ul=Ci([ke,co],mh),Bo=Ci([ki,qi,Zi,si,nr,br,Ei,xa,Ua,J],dh("z")),Vl=Ci([Xe,Bo],mh),Oo=Ci([li,qi,wa,Nn,Jt,fr,Ei,xa,va,J],dh("r")),Ns=Ci([Oe,Oo],mh),Va=Ci([ss],yh),ls=Ci([co],yh),ho=Ci([Bo],yh),Us=Ci([Oo],yh),ja=Ci([Ei,xa],([ye,hn])=>ye/hn);Xt(u,ja,ye=>d(10,sr=ye));function Vn(ye){ju[ye?"unshift":"push"](()=>{Cr=ye,d(2,Cr)})}function Sa(){hr=this.clientWidth,Fi=this.clientHeight,d(0,hr),d(1,Fi)}return u.$$set=ye=>{"ssr"in ye&&d(3,Gr=ye.ssr),"pointerEvents"in ye&&d(4,yr=ye.pointerEvents),"position"in ye&&d(5,Nr=ye.position),"percentRange"in ye&&d(51,qt=ye.percentRange),"width"in ye&&d(52,Lr=ye.width),"height"in ye&&d(53,Kr=ye.height),"containerWidth"in ye&&d(0,hr=ye.containerWidth),"containerHeight"in ye&&d(1,Fi=ye.containerHeight),"element"in ye&&d(2,Cr=ye.element),"x"in ye&&d(54,bi=ye.x),"y"in ye&&d(55,pi=ye.y),"z"in ye&&d(56,Qi=ye.z),"r"in ye&&d(57,Mi=ye.r),"data"in ye&&d(58,fi=ye.data),"xDomain"in ye&&d(59,ri=ye.xDomain),"yDomain"in ye&&d(60,sn=ye.yDomain),"zDomain"in ye&&d(61,di=ye.zDomain),"rDomain"in ye&&d(62,Ur=ye.rDomain),"xNice"in ye&&d(63,$i=ye.xNice),"yNice"in ye&&d(64,On=ye.yNice),"zNice"in ye&&d(65,Ni=ye.zNice),"rNice"in ye&&d(66,Cn=ye.rNice),"xReverse"in ye&&d(67,en=ye.xReverse),"yReverse"in ye&&d(68,Mn=ye.yReverse),"zReverse"in ye&&d(69,Ui=ye.zReverse),"rReverse"in ye&&d(70,_n=ye.rReverse),"xPadding"in ye&&d(71,Vi=ye.xPadding),"yPadding"in ye&&d(72,Fn=ye.yPadding),"zPadding"in ye&&d(73,tn=ye.zPadding),"rPadding"in ye&&d(74,ji=ye.rPadding),"xScale"in ye&&d(75,vn=ye.xScale),"yScale"in ye&&d(76,ln=ye.yScale),"zScale"in ye&&d(77,un=ye.zScale),"rScale"in ye&&d(78,bn=ye.rScale),"xRange"in ye&&d(79,oi=ye.xRange),"yRange"in ye&&d(80,Mr=ye.yRange),"zRange"in ye&&d(81,L=ye.zRange),"rRange"in ye&&d(82,N=ye.rRange),"padding"in ye&&d(83,V=ye.padding),"extents"in ye&&d(84,W=ye.extents),"flatData"in ye&&d(85,$=ye.flatData),"custom"in ye&&d(86,se=ye.custom),"$$scope"in ye&&d(89,Wt=ye.$$scope)},u.$$.update=()=>{u.$$.dirty[1]&8388608&&bi&&d(87,j.x=bi,j),u.$$.dirty[1]&16777216&&pi&&d(87,j.y=pi,j),u.$$.dirty[1]&33554432&&Qi&&d(87,j.z=Qi,j),u.$$.dirty[1]&67108864&&Mi&&d(87,j.r=Mi,j),u.$$.dirty[1]&268435456&&ri&&d(87,j.xDomain=ri,j),u.$$.dirty[1]&536870912&&sn&&d(87,j.yDomain=sn,j),u.$$.dirty[1]&1073741824&&di&&d(87,j.zDomain=di,j),u.$$.dirty[2]&1&&Ur&&d(87,j.rDomain=Ur,j),u.$$.dirty[2]&131072&&oi&&d(87,j.xRange=oi,j),u.$$.dirty[2]&262144&&Mr&&d(87,j.yRange=Mr,j),u.$$.dirty[2]&524288&&L&&d(87,j.zRange=L,j),u.$$.dirty[2]&1048576&&N&&d(87,j.rRange=N,j),u.$$.dirty[1]&1048576&&zr(J,Tr=qt,Tr),u.$$.dirty[0]&1&&zr(ge,mr=hr,mr),u.$$.dirty[0]&2&&zr(Ce,At=Fi,At),u.$$.dirty[2]&4194304&&zr(De,We=Cp(W),We),u.$$.dirty[1]&134217728&&zr(q,ei=fi,ei),u.$$.dirty[1]&134217728|u.$$.dirty[2]&8388608&&zr(_e,jt=$||fi,jt),u.$$.dirty[2]&2097152&&zr(tt,It=V,It),u.$$.dirty[1]&8388608&&zr(He,gt=is(bi),gt),u.$$.dirty[1]&16777216&&zr(ke,Zt=is(pi),Zt),u.$$.dirty[1]&33554432&&zr(Xe,rt=is(Qi),rt),u.$$.dirty[1]&67108864&&zr(Oe,zt=is(Mi),zt),u.$$.dirty[1]&268435456&&zr(qe,bt=ri,bt),u.$$.dirty[1]&536870912&&zr(Mt,Nt=sn,Nt),u.$$.dirty[1]&1073741824&&zr(je,pt=di,pt),u.$$.dirty[2]&1&&zr(Vt,_t=Ur,_t),u.$$.dirty[2]&2&&zr(lr,ht=$i,ht),u.$$.dirty[2]&4&&zr(Dt,Ue=On,Ue),u.$$.dirty[2]&8&&zr(nr,ct=Ni,ct),u.$$.dirty[2]&16&&zr(Jt,Je=Cn,Je),u.$$.dirty[2]&32&&zr(ii,Me=en,Me),u.$$.dirty[2]&64&&zr($t,$e=Mn,$e),u.$$.dirty[2]&128&&zr(br,st=Ui,st),u.$$.dirty[2]&256&&zr(fr,xe=_n,xe),u.$$.dirty[2]&512&&zr(Gt,we=Vi,we),u.$$.dirty[2]&1024&&zr(ar,fe=Fn,fe),u.$$.dirty[2]&2048&&zr(si,de=tn,de),u.$$.dirty[2]&4096&&zr(Nn,ie=ji,ie),u.$$.dirty[2]&131072&&zr(wr,H=oi,H),u.$$.dirty[2]&262144&&zr(Di,D=Mr,D),u.$$.dirty[2]&524288&&zr(Ua,R=L,R),u.$$.dirty[2]&1048576&&zr(va,F=N,F),u.$$.dirty[2]&8192&&zr(Xr,M=vn,M),u.$$.dirty[2]&16384&&zr(ba,E=ln,E),u.$$.dirty[2]&32768&&zr(ki,T=un,T),u.$$.dirty[2]&65536&&zr(li,a=bn,a),u.$$.dirty[2]&16777216&&zr(Rr,v=se,v),u.$$.dirty[2]&33554432&&zr(cn,y=j,y),u.$$.dirty[2]&67108864&&iy("LayerCake",p)},d(88,p={activeGetters:Un,width:Ei,height:xa,percentRange:J,aspectRatio:ja,containerWidth:ge,containerHeight:Ce,x:He,y:ke,z:Xe,r:Oe,custom:Rr,data:q,xNice:lr,yNice:Dt,zNice:nr,rNice:Jt,xReverse:ii,yReverse:$t,zReverse:br,rReverse:fr,xPadding:Gt,yPadding:ar,zPadding:si,rPadding:Nn,padding:xn,flatData:_e,extents:qi,xDomain:Ti,yDomain:$n,zDomain:Zi,rDomain:wa,xRange:Va,yRange:ls,zRange:ho,rRange:Us,config:cn,xScale:ss,xGet:Nl,yScale:co,yGet:Ul,zScale:Bo,zGet:Vl,rScale:Oo,rGet:Ns}),[hr,Fi,Cr,Gr,yr,Nr,At,mr,xr,Zr,sr,J,ge,Ce,De,q,_e,tt,He,ke,Xe,Oe,qe,Mt,je,Vt,lr,Dt,nr,Jt,ii,$t,br,fr,Gt,ar,si,Nn,wr,Di,Ua,va,Xr,ba,ki,li,cn,Rr,Ei,xa,ja,qt,Lr,Kr,bi,pi,Qi,Mi,fi,ri,sn,di,Ur,$i,On,Ni,Cn,en,Mn,Ui,_n,Vi,Fn,tn,ji,vn,ln,un,bn,oi,Mr,L,N,V,W,$,se,j,p,Wt,ti,Vn,Sa]}class y0 extends mn{constructor(h){super(),yn(this,h,m0,d0,gn,{ssr:3,pointerEvents:4,position:5,percentRange:51,width:52,height:53,containerWidth:0,containerHeight:1,element:2,x:54,y:55,z:56,r:57,data:58,xDomain:59,yDomain:60,zDomain:61,rDomain:62,xNice:63,yNice:64,zNice:65,rNice:66,xReverse:67,yReverse:68,zReverse:69,rReverse:70,xPadding:71,yPadding:72,zPadding:73,rPadding:74,xScale:75,yScale:76,zScale:77,rScale:78,xRange:79,yRange:80,zRange:81,rRange:82,padding:83,extents:84,flatData:85,custom:86},null,[-1,-1,-1,-1,-1])}}const g0=u=>({element:u&1}),Hd=u=>({element:u[0]}),_0=u=>({element:u&1}),Jd=u=>({element:u[0]});function v0(u){let h,d,p,y,v;const a=u[12].defs,T=Fu(a,u,u[11],Jd),E=u[12].default,M=Fu(E,u,u[11],Hd);return{c(){h=Yn("svg"),d=Yn("defs"),T&&T.c(),p=Yn("g"),M&&M.c(),this.h()},l(F){h=Qn(F,"svg",{class:!0,viewBox:!0,width:!0,height:!0});var R=Be(h);d=Qn(R,"defs",{});var D=Be(d);T&&T.l(D),D.forEach(ae),p=Qn(R,"g",{class:!0,transform:!0});var H=Be(p);M&&M.l(H),H.forEach(ae),R.forEach(ae),this.h()},h(){oe(p,"class","layercake-layout-svg_g"),oe(p,"transform",y="translate("+u[7].left+", "+u[7].top+")"),oe(h,"class","layercake-layout-svg svelte-u84d8d"),oe(h,"viewBox",u[4]),oe(h,"width",u[5]),oe(h,"height",u[6]),Ge(h,"z-index",u[2]),Ge(h,"pointer-events",u[3]===!1?"none":null)},m(F,R){Le(F,h,R),Te(h,d),T&&T.m(d,null),Te(h,p),M&&M.m(p,null),u[13](p),u[14](h),v=!0},p(F,[R]){T&&T.p&&(!v||R&2049)&&Nu(T,a,F,F[11],v?Vu(a,F[11],R,_0):Uu(F[11]),Jd),M&&M.p&&(!v||R&2049)&&Nu(M,E,F,F[11],v?Vu(E,F[11],R,g0):Uu(F[11]),Hd),(!v||R&128&&y!==(y="translate("+F[7].left+", "+F[7].top+")"))&&oe(p,"transform",y),(!v||R&16)&&oe(h,"viewBox",F[4]),(!v||R&32)&&oe(h,"width",F[5]),(!v||R&64)&&oe(h,"height",F[6]),R&4&&Ge(h,"z-index",F[2]),R&8&&Ge(h,"pointer-events",F[3]===!1?"none":null)},i(F){v||(Qe(T,F),Qe(M,F),v=!0)},o(F){at(T,F),at(M,F),v=!1},d(F){F&&ae(h),T&&T.d(F),M&&M.d(F),u[13](null),u[14](null)}}}function b0(u,h,d){let p,y,v,{$$slots:a={},$$scope:T}=h,{element:E=void 0}=h,{innerElement:M=void 0}=h,{zIndex:F=void 0}=h,{pointerEvents:R=void 0}=h,{viewBox:D=void 0}=h;const{containerWidth:H,containerHeight:ie,padding:de}=Wu("LayerCake");Xt(u,H,xe=>d(5,p=xe)),Xt(u,ie,xe=>d(6,y=xe)),Xt(u,de,xe=>d(7,v=xe));function fe(xe){ju[xe?"unshift":"push"](()=>{M=xe,d(1,M)})}function we(xe){ju[xe?"unshift":"push"](()=>{E=xe,d(0,E)})}return u.$$set=xe=>{"element"in xe&&d(0,E=xe.element),"innerElement"in xe&&d(1,M=xe.innerElement),"zIndex"in xe&&d(2,F=xe.zIndex),"pointerEvents"in xe&&d(3,R=xe.pointerEvents),"viewBox"in xe&&d(4,D=xe.viewBox),"$$scope"in xe&&d(11,T=xe.$$scope)},[E,M,F,R,D,p,y,v,H,ie,de,T,a,fe,we]}class x0 extends mn{constructor(h){super(),yn(this,h,b0,v0,gn,{element:0,innerElement:1,zIndex:2,pointerEvents:3,viewBox:4})}}function Yd(u,h,d){const p=u.slice();return p[23]=h[d],p[25]=d,p}function Qd(u){let h,d,p,y;return{c(){h=Yn("rect"),this.h()},l(v){h=Qn(v,"rect",{class:!0,"data-id":!0,x:!0,y:!0,width:!0,height:!0,fill:!0,stroke:!0,"stroke-width":!0}),Be(h).forEach(ae),this.h()},h(){oe(h,"class","group-rect"),oe(h,"data-id",u[25]),oe(h,"x",d=u[11].bandwidth?u[7](u[23]):u[7](u[23])[0]),oe(h,"y",p=u[13](u[12](u[23]))-1),oe(h,"width",y=u[11].bandwidth?u[11].bandwidth():u[9](u[23])),oe(h,"height","3"),oe(h,"fill","#308182"),oe(h,"stroke",u[0]),oe(h,"stroke-width",u[1])},m(v,a){Le(v,h,a)},p(v,a){a&3200&&d!==(d=v[11].bandwidth?v[7](v[23]):v[7](v[23])[0])&&oe(h,"x",d),a&13312&&p!==(p=v[13](v[12](v[23]))-1)&&oe(h,"y",p),a&3584&&y!==(y=v[11].bandwidth?v[11].bandwidth():v[9](v[23]))&&oe(h,"width",y),a&1&&oe(h,"stroke",v[0]),a&2&&oe(h,"stroke-width",v[1])},d(v){v&&ae(h)}}}function $d(u){let h,d,p,y,v,a,T,E,M=u[12]&&Qd(u);return{c(){h=Yn("rect"),M&&M.c(),a=Yn("text"),this.h()},l(F){h=Qn(F,"rect",{class:!0,"data-id":!0,x:!0,y:!0,width:!0,height:!0,fill:!0,stroke:!0,"stroke-width":!0}),Be(h).forEach(ae),M&&M.l(F),a=Qn(F,"text",{x:!0,y:!0,dx:!0,dy:!0,"text-anchor":!0}),Be(a).forEach(ae),this.h()},h(){oe(h,"class","group-rect"),oe(h,"data-id",u[25]),oe(h,"x",d=u[11].bandwidth?u[7](u[23]):u[7](u[23])[0]),oe(h,"y",p=u[6](u[23])),oe(h,"width",y=u[11].bandwidth?u[11].bandwidth():u[9](u[23])),oe(h,"height",v=u[8](u[23])),oe(h,"fill",u[4]),oe(h,"stroke",u[0]),oe(h,"stroke-width",u[1]),oe(a,"x",T=u[11].bandwidth?u[7](u[23])+u[11].bandwidth()/2:u[7](u[23])[0]),oe(a,"y",E=u[6](u[23])-4),oe(a,"dx",u[2]),oe(a,"dy",u[3]),oe(a,"text-anchor",u[5])},m(F,R){Le(F,h,R),M&&M.m(F,R),Le(F,a,R)},p(F,R){R&3200&&d!==(d=F[11].bandwidth?F[7](F[23]):F[7](F[23])[0])&&oe(h,"x",d),R&1088&&p!==(p=F[6](F[23]))&&oe(h,"y",p),R&3584&&y!==(y=F[11].bandwidth?F[11].bandwidth():F[9](F[23]))&&oe(h,"width",y),R&1280&&v!==(v=F[8](F[23]))&&oe(h,"height",v),R&16&&oe(h,"fill",F[4]),R&1&&oe(h,"stroke",F[0]),R&2&&oe(h,"stroke-width",F[1]),F[12]?M?M.p(F,R):(M=Qd(F),M.c(),M.m(a.parentNode,a)):M&&(M.d(1),M=null),R&3200&&T!==(T=F[11].bandwidth?F[7](F[23])+F[11].bandwidth()/2:F[7](F[23])[0])&&oe(a,"x",T),R&1088&&E!==(E=F[6](F[23])-4)&&oe(a,"y",E),R&4&&oe(a,"dx",F[2]),R&8&&oe(a,"dy",F[3]),R&32&&oe(a,"text-anchor",F[5])},d(F){F&&ae(h),M&&M.d(F),F&&ae(a)}}}function w0(u){let h,d=u[10],p=[];for(let y=0;y<d.length;y+=1)p[y]=$d(Yd(u,d,y));return{c(){h=Yn("g");for(let y=0;y<p.length;y+=1)p[y].c();this.h()},l(y){h=Qn(y,"g",{class:!0});var v=Be(h);for(let a=0;a<p.length;a+=1)p[a].l(v);v.forEach(ae),this.h()},h(){oe(h,"class","column-group svelte-wgzwsk")},m(y,v){Le(y,h,v);for(let a=0;a<p.length;a+=1)p[a]&&p[a].m(h,null)},p(y,[v]){if(v&16383){d=y[10];let a;for(a=0;a<d.length;a+=1){const T=Yd(y,d,a);p[a]?p[a].p(T,v):(p[a]=$d(T),p[a].c(),p[a].m(h,null))}for(;a<p.length;a+=1)p[a].d(1);p.length=d.length}},i:vi,o:vi,d(y){y&&ae(h),on(p,y)}}}function S0(u,h,d){let p,y,v,a,T,E,M,F,R;const{data:D,xGet:H,yGet:ie,yRange:de,xScale:fe,yScale:we,y:xe,z:st}=Wu("LayerCake");Xt(u,D,_t=>d(10,E=_t)),Xt(u,H,_t=>d(7,T=_t)),Xt(u,ie,_t=>d(6,v=_t)),Xt(u,de,_t=>d(21,a=_t)),Xt(u,fe,_t=>d(11,M=_t)),Xt(u,we,_t=>d(13,R=_t)),Xt(u,st,_t=>d(12,F=_t));let{stroke:$e=""}=h,{strokeWidth:Me=0}=h,{dxTick:Je=0}=h,{dyTick:ct=0}=h,{fill:Ue="#00205b"}=h,{textAnchor:ht="middle"}=h;return u.$$set=_t=>{"stroke"in _t&&d(0,$e=_t.stroke),"strokeWidth"in _t&&d(1,Me=_t.strokeWidth),"dxTick"in _t&&d(2,Je=_t.dxTick),"dyTick"in _t&&d(3,ct=_t.dyTick),"fill"in _t&&d(4,Ue=_t.fill),"textAnchor"in _t&&d(5,ht=_t.textAnchor)},u.$$.update=()=>{u.$$.dirty&128&&d(9,p=_t=>{const pt=T(_t);return Math.max(0,pt[1]-pt[0])}),u.$$.dirty&2097216&&d(8,y=_t=>a[0]-v(_t))},[$e,Me,Je,ct,Ue,ht,v,T,y,p,E,M,F,R,D,H,ie,de,fe,we,st,a]}class k0 extends mn{constructor(h){super(),yn(this,h,S0,w0,gn,{stroke:0,strokeWidth:1,dxTick:2,dyTick:3,fill:4,textAnchor:5})}}function em(u,h,d){const p=u.slice();return p[28]=h[d],p[30]=d,p}function tm(u){let h,d,p,y;return{c(){h=Yn("line"),this.h()},l(v){h=Qn(v,"line",{y1:!0,y2:!0,x1:!0,x2:!0,stroke:!0,"stroke-width":!0,class:!0}),Be(h).forEach(ae),this.h()},h(){oe(h,"y1",d=u[20]*-1),oe(h,"y2",p=u[14]&&u[30]%2==0?u[10]+u[8]+2:u[10]+u[8]-13),oe(h,"x1","0"),oe(h,"x2","0"),oe(h,"stroke",u[11]),oe(h,"stroke-width",y=u[15]&&Array.isArray(u[4])&&u[30]==Math.floor(u[4].length/2)?2:1),oe(h,"class","svelte-fwjh80"),Jn(h,"baseline",u[13])},m(v,a){Le(v,h,a)},p(v,a){a&1048576&&d!==(d=v[20]*-1)&&oe(h,"y1",d),a&17664&&p!==(p=v[14]&&v[30]%2==0?v[10]+v[8]+2:v[10]+v[8]-13)&&oe(h,"y2",p),a&2048&&oe(h,"stroke",v[11]),a&32784&&y!==(y=v[15]&&Array.isArray(v[4])&&v[30]==Math.floor(v[4].length/2)?2:1)&&oe(h,"stroke-width",y),a&8192&&Jn(h,"baseline",v[13])},d(v){v&&ae(h)}}}function E0(u){let h=u[1](u[28])+"",d;return{c(){d=Pt(h)},l(p){d=Ct(p,h)},m(p,y){Le(p,d,y)},p(p,y){y&262146&&h!==(h=p[1](p[28])+"")&&Ar(d,h)},d(p){p&&ae(d)}}}function T0(u){let h,d=u[1](u[28])+"",p,y;return{c(){h=Pt(u[5]),p=Pt(d),y=Pt(u[6])},l(v){h=Ct(v,u[5]),p=Ct(v,d),y=Ct(v,u[6])},m(v,a){Le(v,h,a),Le(v,p,a),Le(v,y,a)},p(v,a){a&32&&Ar(h,v[5]),a&262146&&d!==(d=v[1](v[28])+"")&&Ar(p,d),a&64&&Ar(y,v[6])},d(v){v&&ae(h),v&&ae(p),v&&ae(y)}}}function rm(u){let h,d,p,y,v,a,T,E=u[0]!==!1&&tm(u);function M(D,H){return D[30]==D[18].length-1?T0:E0}let F=M(u),R=F(u);return{c(){h=Yn("g"),E&&E.c(),d=Yn("text"),R.c(),this.h()},l(D){h=Qn(D,"g",{class:!0,transform:!0});var H=Be(h);E&&E.l(H),d=Qn(H,"text",{x:!0,y:!0,dx:!0,dy:!0,"text-anchor":!0,fill:!0,class:!0});var ie=Be(d);R.l(ie),ie.forEach(ae),H.forEach(ae),this.h()},h(){oe(d,"x",p=u[7]||u[16]?u[17].bandwidth()/2:0),oe(d,"y",y=u[3]?u[20]*-1-6:u[14]&&u[30]%2==0?u[8]+15:u[8]),oe(d,"dx",v=u[24](u[30])=="start"?u[9]-2:u[24](u[30])=="end"?u[9]+2:u[9]),oe(d,"dy",u[10]),oe(d,"text-anchor",u[24](u[30])),oe(d,"fill",u[12]),oe(d,"class","svelte-fwjh80"),Jn(d,"bold",u[15]&&Array.isArray(u[4])&&u[30]==Math.floor(u[4].length/2)),oe(h,"class",a="tick tick-"+u[28]+" svelte-fwjh80"),oe(h,"transform",T="translate("+u[17](u[28])+","+u[19][0]+")")},m(D,H){Le(D,h,H),E&&E.m(h,null),Te(h,d),R.m(d,null)},p(D,H){D[0]!==!1?E?E.p(D,H):(E=tm(D),E.c(),E.m(h,d)):E&&(E.d(1),E=null),F===(F=M(D))&&R?R.p(D,H):(R.d(1),R=F(D),R&&(R.c(),R.m(d,null))),H&196736&&p!==(p=D[7]||D[16]?D[17].bandwidth()/2:0)&&oe(d,"x",p),H&1065224&&y!==(y=D[3]?D[20]*-1-6:D[14]&&D[30]%2==0?D[8]+15:D[8])&&oe(d,"y",y),H&512&&v!==(v=D[24](D[30])=="start"?D[9]-2:D[24](D[30])=="end"?D[9]+2:D[9])&&oe(d,"dx",v),H&1024&&oe(d,"dy",D[10]),H&4096&&oe(d,"fill",D[12]),H&32784&&Jn(d,"bold",D[15]&&Array.isArray(D[4])&&D[30]==Math.floor(D[4].length/2)),H&262144&&a!==(a="tick tick-"+D[28]+" svelte-fwjh80")&&oe(h,"class",a),H&917504&&T!==(T="translate("+D[17](D[28])+","+D[19][0]+")")&&oe(h,"transform",T)},d(D){D&&ae(h),E&&E.d(),R.d()}}}function im(u){let h,d,p;return{c(){h=Yn("line"),this.h()},l(y){h=Qn(y,"line",{class:!0,y1:!0,y2:!0,x1:!0,x2:!0,stroke:!0}),Be(h).forEach(ae),this.h()},h(){oe(h,"class","baseline svelte-fwjh80"),oe(h,"y1",u[20]),oe(h,"y2","0"),oe(h,"x1",d=u[17](0)),oe(h,"x2",p=u[17](0)),oe(h,"stroke",u[11])},m(y,v){Le(y,h,v)},p(y,v){v&1048576&&oe(h,"y1",y[20]),v&131072&&d!==(d=y[17](0))&&oe(h,"x1",d),v&131072&&p!==(p=y[17](0))&&oe(h,"x2",p),v&2048&&oe(h,"stroke",y[11])},d(y){y&&ae(h)}}}function z0(u){let h,d,p=u[18],y=[];for(let a=0;a<p.length;a+=1)y[a]=rm(em(u,p,a));let v=u[2]===!0&&im(u);return{c(){h=Yn("g");for(let a=0;a<y.length;a+=1)y[a].c();d=cr(),v&&v.c(),this.h()},l(a){h=Qn(a,"g",{class:!0});var T=Be(h);for(let E=0;E<y.length;E+=1)y[E].l(T);d=cr(),v&&v.l(T),T.forEach(ae),this.h()},h(){oe(h,"class","axis x-axis")},m(a,T){Le(a,h,T);for(let E=0;E<y.length;E+=1)y[E]&&y[E].m(h,null);Te(h,d),v&&v.m(h,null)},p(a,[T]){if(T&18874363){p=a[18];let E;for(E=0;E<p.length;E+=1){const M=em(a,p,E);y[E]?y[E].p(M,T):(y[E]=rm(M),y[E].c(),y[E].m(h,d))}for(;E<y.length;E+=1)y[E].d(1);y.length=p.length}a[2]===!0?v?v.p(a,T):(v=im(a),v.c(),v.m(h,null)):v&&(v.d(1),v=null)},i:vi,o:vi,d(a){a&&ae(h),on(y,a),v&&v.d()}}}function I0(u,h,d){let p,y,v,a,T;const{width:E,height:M,xScale:F,yScale:R,yRange:D}=Wu("LayerCake");Xt(u,M,rt=>d(20,T=rt)),Xt(u,F,rt=>d(17,v=rt)),Xt(u,D,rt=>d(19,a=rt));let{gridlines:H=!0}=h,{formatTick:ie=rt=>rt}=h,{baseline:de=!1}=h,{flipped:fe=!1}=h,{snapTicks:we=!1}=h,{ticks:xe=void 0}=h,{prefix:st=""}=h,{suffix:$e=""}=h,{xTick:Me=void 0}=h,{yTick:Je=15}=h,{dxTick:ct=0}=h,{dyTick:Ue=0}=h,{lineColor:ht="#999"}=h,{textColor:_t="#555"}=h,{solid:pt=!1}=h,{stagger:Nt=!1}=h,{median:bt=!0}=h;function zt(rt){if(we===!0){if(rt===0)return"start";if(rt===y.length-1)return"end"}return"middle"}return u.$$set=rt=>{"gridlines"in rt&&d(0,H=rt.gridlines),"formatTick"in rt&&d(1,ie=rt.formatTick),"baseline"in rt&&d(2,de=rt.baseline),"flipped"in rt&&d(3,fe=rt.flipped),"snapTicks"in rt&&d(25,we=rt.snapTicks),"ticks"in rt&&d(4,xe=rt.ticks),"prefix"in rt&&d(5,st=rt.prefix),"suffix"in rt&&d(6,$e=rt.suffix),"xTick"in rt&&d(7,Me=rt.xTick),"yTick"in rt&&d(8,Je=rt.yTick),"dxTick"in rt&&d(9,ct=rt.dxTick),"dyTick"in rt&&d(10,Ue=rt.dyTick),"lineColor"in rt&&d(11,ht=rt.lineColor),"textColor"in rt&&d(12,_t=rt.textColor),"solid"in rt&&d(13,pt=rt.solid),"stagger"in rt&&d(14,Nt=rt.stagger),"median"in rt&&d(15,bt=rt.median)},u.$$.update=()=>{u.$$.dirty&131072&&d(16,p=typeof v.bandwidth=="function"),u.$$.dirty&196624&&d(18,y=Array.isArray(xe)?xe:p?v.domain():v.ticks(xe))},[H,ie,de,fe,xe,st,$e,Me,Je,ct,Ue,ht,_t,pt,Nt,bt,p,v,y,a,T,M,F,D,zt,we]}class A0 extends mn{constructor(h){super(),yn(this,h,I0,z0,gn,{gridlines:0,formatTick:1,baseline:2,flipped:3,snapTicks:25,ticks:4,prefix:5,suffix:6,xTick:7,yTick:8,dxTick:9,dyTick:10,lineColor:11,textColor:12,solid:13,stagger:14,median:15})}}function P0(u){let h,d,p,y;return h=new k0({props:{fill:u[1],formatVal:u[5]}}),p=new A0({props:{gridlines:!1}}),{c(){er(h.$$.fragment),d=mt(),er(p.$$.fragment)},l(v){tr(h.$$.fragment,v),d=yt(v),tr(p.$$.fragment,v)},m(v,a){rr(h,v,a),Le(v,d,a),rr(p,v,a),y=!0},p(v,a){const T={};a&2&&(T.fill=v[1]),a&32&&(T.formatVal=v[5]),h.$set(T)},i(v){y||(Qe(h.$$.fragment,v),Qe(p.$$.fragment,v),y=!0)},o(v){at(h.$$.fragment,v),at(p.$$.fragment,v),y=!1},d(v){ir(h,v),v&&ae(d),ir(p,v)}}}function C0(u){let h,d;return h=new x0({props:{$$slots:{default:[P0]},$$scope:{ctx:u}}}),{c(){er(h.$$.fragment)},l(p){tr(h.$$.fragment,p)},m(p,y){rr(h,p,y),d=!0},p(p,y){const v={};y&1058&&(v.$$scope={dirty:y,ctx:p}),h.$set(v)},i(p){d||(Qe(h.$$.fragment,p),d=!0)},o(p){at(h.$$.fragment,p),d=!1},d(p){ir(h,p)}}}function M0(u){let h,d,p;return d=new y0({props:{padding:{top:15,right:0,bottom:20,left:0},x:u[2],y:u[3],z:u[4],xScale:dy().paddingInner([.02]).round(!0),xDomain:u[7],yDomain:u[6],zDomain:u[6],data:u[0],$$slots:{default:[C0]},$$scope:{ctx:u}}}),{c(){h=Fe("div"),er(d.$$.fragment),this.h()},l(y){h=Ne(y,"DIV",{class:!0});var v=Be(h);tr(d.$$.fragment,v),v.forEach(ae),this.h()},h(){oe(h,"class","chart-container svelte-1i1qsul")},m(y,v){Le(y,h,v),rr(d,h,null),p=!0},p(y,[v]){const a={};v&4&&(a.x=y[2]),v&8&&(a.y=y[3]),v&16&&(a.z=y[4]),v&128&&(a.xDomain=y[7]),v&64&&(a.yDomain=y[6]),v&64&&(a.zDomain=y[6]),v&1&&(a.data=y[0]),v&1058&&(a.$$scope={dirty:v,ctx:y}),d.$set(a)},i(y){p||(Qe(d.$$.fragment,y),p=!0)},o(y){at(d.$$.fragment,y),p=!1},d(y){y&&ae(h),ir(d)}}}function D0(u,h,d){let p,y,v,{data:a}=h,{suffix:T="%"}=h,{decimals:E=null}=h,{fill:M="#00205B"}=h,{xKey:F="x"}=h,{yKey:R="y"}=h,{zKey:D=null}=h;return u.$$set=H=>{"data"in H&&d(0,a=H.data),"suffix"in H&&d(8,T=H.suffix),"decimals"in H&&d(9,E=H.decimals),"fill"in H&&d(1,M=H.fill),"xKey"in H&&d(2,F=H.xKey),"yKey"in H&&d(3,R=H.yKey),"zKey"in H&&d(4,D=H.zKey)},u.$$.update=()=>{u.$$.dirty&5&&d(7,p=a.map(H=>H[F])),u.$$.dirty&9&&d(6,y=[0,Math.max(...a.map(H=>H[R]))]),u.$$.dirty&768&&d(5,v=H=>H.toFixed(E)+T)},[a,M,F,R,D,v,y,p,T,E]}class Rh extends mn{constructor(h){super(),yn(this,h,D0,M0,gn,{data:0,suffix:8,decimals:9,fill:1,xKey:2,yKey:3,zKey:4})}}function nm(u,h,d){const p=u.slice();return p[6]=h[d],p[8]=d,p}function am(u){let h,d=u[0],p=[];for(let y=0;y<d.length;y+=1)p[y]=om(nm(u,d,y));return{c(){h=Yn("svg");for(let y=0;y<p.length;y+=1)p[y].c();this.h()},l(y){h=Qn(y,"svg",{class:!0});var v=Be(h);for(let a=0;a<p.length;a+=1)p[a].l(v);v.forEach(ae),this.h()},h(){oe(h,"class","stack svelte-pzvhwz")},m(y,v){Le(y,h,v);for(let a=0;a<p.length;a+=1)p[a]&&p[a].m(h,null)},p(y,v){if(v&31){d=y[0];let a;for(a=0;a<d.length;a+=1){const T=nm(y,d,a);p[a]?p[a].p(T,v):(p[a]=om(T),p[a].c(),p[a].m(h,null))}for(;a<p.length;a+=1)p[a].d(1);p.length=d.length}},d(y){y&&ae(h),on(p,y)}}}function om(u){let h,d;return{c(){h=Yn("rect"),this.h()},l(p){h=Qn(p,"rect",{class:!0,x:!0,style:!0}),Be(h).forEach(ae),this.h()},h(){oe(h,"class","cell svelte-pzvhwz"),oe(h,"x",d=u[4][u[8]]/u[3]*100+"%"),Ge(h,"width",u[6][u[1]]/u[3]*100+"%"),Ge(h,"fill",u[2][u[8]])},m(p,y){Le(p,h,y)},p(p,y){y&24&&d!==(d=p[4][p[8]]/p[3]*100+"%")&&oe(h,"x",d),y&11&&Ge(h,"width",p[6][p[1]]/p[3]*100+"%"),y&4&&Ge(h,"fill",p[2][p[8]])},d(p){p&&ae(h)}}}function L0(u){let h,d=u[3]&&u[4]&&am(u);return{c(){d&&d.c(),h=cr()},l(p){d&&d.l(p),h=cr()},m(p,y){d&&d.m(p,y),Le(p,h,y)},p(p,[y]){p[3]&&p[4]?d?d.p(p,y):(d=am(p),d.c(),d.m(h.parentNode,h)):d&&(d.d(1),d=null)},i:vi,o:vi,d(p){d&&d.d(p),p&&ae(h)}}}function R0(u,h,d){let{data:p}=h,{yKey:y="y"}=h,{colors:v=["#00205B","#308182","#002417","#BD00BD","lightgrey"]}=h,a,T;function E(){d(3,a=p.map(F=>F[y]).reduce((F,R)=>F+R,0));let M=[0];p.forEach(F=>M.push(M[M.length-1]+F[y])),d(4,T=M)}return u.$$set=M=>{"data"in M&&d(0,p=M.data),"yKey"in M&&d(1,y=M.yKey),"colors"in M&&d(2,v=M.colors)},u.$$.update=()=>{u.$$.dirty&3&&(p||y)&&E()},[p,y,v,a,T]}class Jp extends mn{constructor(h){super(),yn(this,h,R0,L0,gn,{data:0,yKey:1,colors:2})}}function sm(u,h,d){const p=u.slice();return p[10]=h[d],p[12]=d,p}function B0(u){let h,d,p=u[6](u[10][u[3]])+"",y,v;return{c(){h=Fe("span"),d=Pt("(NI "),y=Pt(p),v=Pt(")"),this.h()},l(a){h=Ne(a,"SPAN",{class:!0,style:!0});var T=Be(h);d=Ct(T,"(NI "),y=Ct(T,p),v=Ct(T,")"),T.forEach(ae),this.h()},h(){oe(h,"class",""),Ge(h,"color","#1460aa")},m(a,T){Le(a,h,T),Te(h,d),Te(h,y),Te(h,v)},p(a,T){T&9&&p!==(p=a[6](a[10][a[3]])+"")&&Ar(y,p)},d(a){a&&ae(h)}}}function O0(u){let h;return{c(){h=Fe("span"),this.h()},l(d){h=Ne(d,"SPAN",{class:!0,style:!0}),Be(h).forEach(ae),this.h()},h(){oe(h,"class",""),Ge(h,"color","#1460aa")},m(d,p){Le(d,h,p)},p:vi,d(d){d&&ae(h)}}}function F0(u){let h,d,p=_d(Math.round(u[10][u[3]]),"%)")+"",y;return{c(){h=Fe("span"),d=Pt("(2011 "),y=Pt(p),this.h()},l(v){h=Ne(v,"SPAN",{class:!0,style:!0});var a=Be(h);d=Ct(a,"(2011 "),y=Ct(a,p),a.forEach(ae),this.h()},h(){oe(h,"class",""),Ge(h,"color","#1460aa")},m(v,a){Le(v,h,a),Te(h,d),Te(h,y)},p(v,a){a&9&&p!==(p=_d(Math.round(v[10][v[3]]),"%)")+"")&&Ar(y,p)},d(v){v&&ae(h)}}}function lm(u){let h,d,p,y,v,a=u[10][u[1]]+"",T,E,M,F=u[6](u[10][u[2]])+"",R,D,H;function ie(we,xe){if(we[3]=="prev"&&we[4])return F0;if(we[3]=="prev"&&!we[4])return O0;if(we[3])return B0}let de=ie(u),fe=de&&de(u);return{c(){h=Fe("tr"),d=Fe("td"),p=Yn("svg"),y=Yn("rect"),v=mt(),T=Pt(a),E=mt(),M=Fe("td"),R=Pt(F),D=mt(),fe&&fe.c(),H=mt(),this.h()},l(we){h=Ne(we,"TR",{});var xe=Be(h);d=Ne(xe,"TD",{class:!0});var st=Be(d);p=Qn(st,"svg",{width:!0,height:!0,class:!0});var $e=Be(p);y=Qn($e,"rect",{width:!0,height:!0,style:!0}),Be(y).forEach(ae),$e.forEach(ae),v=yt(st),T=Ct(st,a),st.forEach(ae),E=yt(xe),M=Ne(xe,"TD",{class:!0,style:!0});var Me=Be(M);R=Ct(Me,F),D=yt(Me),fe&&fe.l(Me),Me.forEach(ae),H=yt(xe),xe.forEach(ae),this.h()},h(){oe(y,"width","20"),oe(y,"height","30"),Ge(y,"fill",u[5][u[12]]),oe(p,"width","20"),oe(p,"height","30"),oe(p,"class","bullet svelte-1gvovsq"),oe(d,"class","svelte-1gvovsq"),oe(M,"class","cell-right svelte-1gvovsq"),Ge(M,"vertical-align","top")},m(we,xe){Le(we,h,xe),Te(h,d),Te(d,p),Te(p,y),Te(d,v),Te(d,T),Te(h,E),Te(h,M),Te(M,R),Te(M,D),fe&&fe.m(M,null),Te(h,H)},p(we,xe){xe&32&&Ge(y,"fill",we[5][we[12]]),xe&3&&a!==(a=we[10][we[1]]+"")&&Ar(T,a),xe&5&&F!==(F=we[6](we[10][we[2]])+"")&&Ar(R,F),de===(de=ie(we))&&fe?fe.p(we,xe):(fe&&fe.d(1),fe=de&&de(we),fe&&(fe.c(),fe.m(M,null)))},d(we){we&&ae(h),fe&&fe.d()}}}function N0(u){let h,d,p=u[0],y=[];for(let v=0;v<p.length;v+=1)y[v]=lm(sm(u,p,v));return{c(){h=Fe("table"),d=Fe("tbody");for(let v=0;v<y.length;v+=1)y[v].c();this.h()},l(v){h=Ne(v,"TABLE",{class:!0});var a=Be(h);d=Ne(a,"TBODY",{});var T=Be(d);for(let E=0;E<y.length;E+=1)y[E].l(T);T.forEach(ae),a.forEach(ae),this.h()},h(){oe(h,"class","legend svelte-1gvovsq")},m(v,a){Le(v,h,a),Te(h,d);for(let T=0;T<y.length;T+=1)y[T]&&y[T].m(d,null)},p(v,[a]){if(a&127){p=v[0];let T;for(T=0;T<p.length;T+=1){const E=sm(v,p,T);y[T]?y[T].p(E,a):(y[T]=lm(E),y[T].c(),y[T].m(d,null))}for(;T<y.length;T+=1)y[T].d(1);y.length=p.length}},i:vi,o:vi,d(v){v&&ae(h),on(y,v)}}}function U0(u,h,d){let p,{data:y}=h,{xKey:v="x"}=h,{yKey:a="y"}=h,{zKey:T="ni"}=h,{topic_prev_available:E=!0}=h,{colors:M=["#3878c5","#00205B","#308182","#002417","#BD00BD","lightgrey"]}=h,{decimals:F=null}=h;function R(D){let H;return F?H=(D/p*100).toFixed(F)+"%":D/p*100<1?H="<1%":H=(D/p*100).toFixed(0)+"%",H}return u.$$set=D=>{"data"in D&&d(0,y=D.data),"xKey"in D&&d(1,v=D.xKey),"yKey"in D&&d(2,a=D.yKey),"zKey"in D&&d(3,T=D.zKey),"topic_prev_available"in D&&d(4,E=D.topic_prev_available),"colors"in D&&d(5,M=D.colors),"decimals"in D&&d(7,F=D.decimals)},u.$$.update=()=>{u.$$.dirty&5&&(p=y.map(D=>D[a]).reduce((D,H)=>D+H,0)),u.$$.dirty&9&&y.map(D=>D[T]).reduce((D,H)=>D+H,0)},[y,v,a,T,E,M,R,F]}class V0 extends mn{constructor(h){super(),yn(this,h,U0,N0,gn,{data:0,xKey:1,yKey:2,zKey:3,topic_prev_available:4,colors:5,decimals:7})}}function um(u){let h,d,p,y;d=new Jp({props:{data:u[0],yKey:u[4],colors:u[6]}});let v=u[8]&&cm(u);return{c(){h=Fe("div"),er(d.$$.fragment),p=mt(),v&&v.c(),this.h()},l(a){h=Ne(a,"DIV",{class:!0,style:!0});var T=Be(h);tr(d.$$.fragment,T),p=yt(T),v&&v.l(T),T.forEach(ae),this.h()},h(){oe(h,"class","chart svelte-1tebgpk"),Ge(h,"height",u[1]*.28+"px")},m(a,T){Le(a,h,T),rr(d,h,null),Te(h,p),v&&v.m(h,null),y=!0},p(a,T){const E={};T&1&&(E.data=a[0]),T&16&&(E.yKey=a[4]),T&64&&(E.colors=a[6]),d.$set(E),a[8]?v?v.p(a,T):(v=cm(a),v.c(),v.m(h,null)):v&&(v.d(1),v=null),(!y||T&2)&&Ge(h,"height",a[1]*.28+"px")},i(a){y||(Qe(d.$$.fragment,a),y=!0)},o(a){at(d.$$.fragment,a),y=!1},d(a){a&&ae(h),ir(d),v&&v.d()}}}function cm(u){let h,d;return{c(){h=Fe("div"),d=Pt(u[8]),this.h()},l(p){h=Ne(p,"DIV",{class:!0});var y=Be(h);d=Ct(y,u[8]),y.forEach(ae),this.h()},h(){oe(h,"class","label svelte-1tebgpk")},m(p,y){Le(p,h,y),Te(h,d)},p(p,y){y&256&&Ar(d,p[8])},d(p){p&&ae(h)}}}function hm(u){let h,d,p,y,v,a;return d=new Jp({props:{data:u[0],yKey:u[4],colors:u[6]}}),{c(){h=Fe("div"),er(d.$$.fragment),p=mt(),y=Fe("div"),v=Pt("2011 comparison not available"),this.h()},l(T){h=Ne(T,"DIV",{class:!0,style:!0});var E=Be(h);tr(d.$$.fragment,E),p=yt(E),y=Ne(E,"DIV",{class:!0,style:!0});var M=Be(y);v=Ct(M,"2011 comparison not available"),M.forEach(ae),E.forEach(ae),this.h()},h(){oe(y,"class","label svelte-1tebgpk"),Ge(y,"background-color","#d8d8d8 "),Ge(y,"color","#000000"),oe(h,"class","chart svelte-1tebgpk"),Ge(h,"height",u[1]*.28+"px")},m(T,E){Le(T,h,E),rr(d,h,null),Te(h,p),Te(h,y),Te(y,v),a=!0},p(T,E){const M={};E&1&&(M.data=T[0]),E&16&&(M.yKey=T[4]),E&64&&(M.colors=T[6]),d.$set(M),(!a||E&2)&&Ge(h,"height",T[1]*.28+"px")},i(T){a||(Qe(d.$$.fragment,T),a=!0)},o(T){at(d.$$.fragment,T),a=!1},d(T){T&&ae(h),ir(d)}}}function j0(u){let h,d,p,y,v,a,T,E;d=new Jp({props:{data:u[0],yKey:u[3],colors:u[6]}});let M=(u[4]&&u[5]||u[4]=="ni")&&um(u),F=u[4]=="prev"&&!u[5]&&hm(u);return T=new V0({props:{data:u[0],xKey:u[2],yKey:u[3],zKey:u[4],topic_prev_available:u[5],decimals:u[7],colors:u[6]}}),{c(){h=Fe("div"),er(d.$$.fragment),p=mt(),M&&M.c(),y=mt(),F&&F.c(),v=mt(),a=Fe("div"),er(T.$$.fragment),this.h()},l(R){h=Ne(R,"DIV",{class:!0,style:!0});var D=Be(h);tr(d.$$.fragment,D),D.forEach(ae),p=yt(R),M&&M.l(R),y=yt(R),F&&F.l(R),v=yt(R),a=Ne(R,"DIV",{class:!0});var H=Be(a);tr(T.$$.fragment,H),H.forEach(ae),this.h()},h(){oe(h,"class","chart svelte-1tebgpk"),Ge(h,"padding-top","3px"),Ge(h,"height",(u[4]?u[1]*.72:u[1])+"px"),oe(a,"class","legend svelte-1tebgpk")},m(R,D){Le(R,h,D),rr(d,h,null),Le(R,p,D),M&&M.m(R,D),Le(R,y,D),F&&F.m(R,D),Le(R,v,D),Le(R,a,D),rr(T,a,null),E=!0},p(R,[D]){const H={};D&1&&(H.data=R[0]),D&8&&(H.yKey=R[3]),D&64&&(H.colors=R[6]),d.$set(H),(!E||D&18)&&Ge(h,"height",(R[4]?R[1]*.72:R[1])+"px"),R[4]&&R[5]||R[4]=="ni"?M?(M.p(R,D),D&48&&Qe(M,1)):(M=um(R),M.c(),Qe(M,1),M.m(y.parentNode,y)):M&&(An(),at(M,1,1,()=>{M=null}),Pn()),R[4]=="prev"&&!R[5]?F?(F.p(R,D),D&48&&Qe(F,1)):(F=hm(R),F.c(),Qe(F,1),F.m(v.parentNode,v)):F&&(An(),at(F,1,1,()=>{F=null}),Pn());const ie={};D&1&&(ie.data=R[0]),D&4&&(ie.xKey=R[2]),D&8&&(ie.yKey=R[3]),D&16&&(ie.zKey=R[4]),D&32&&(ie.topic_prev_available=R[5]),D&128&&(ie.decimals=R[7]),D&64&&(ie.colors=R[6]),T.$set(ie)},i(R){E||(Qe(d.$$.fragment,R),Qe(M),Qe(F),Qe(T.$$.fragment,R),E=!0)},o(R){at(d.$$.fragment,R),at(M),at(F),at(T.$$.fragment,R),E=!1},d(R){R&&ae(h),ir(d),R&&ae(p),M&&M.d(R),R&&ae(y),F&&F.d(R),R&&ae(v),R&&ae(a),ir(T)}}}function q0(u,h,d){let{data:p}=h,{height:y=80}=h,{xKey:v="x"}=h,{yKey:a="y"}=h,{zKey:T="ni"}=h,{topic_prev_available:E=!0}=h,{colors:M=["#8268b6","#00205B","#308182","#3d007a","#3878c5","lightgrey"]}=h,{decimals:F=null}=h,{label:R=null}=h;return u.$$set=D=>{"data"in D&&d(0,p=D.data),"height"in D&&d(1,y=D.height),"xKey"in D&&d(2,v=D.xKey),"yKey"in D&&d(3,a=D.yKey),"zKey"in D&&d(4,T=D.zKey),"topic_prev_available"in D&&d(5,E=D.topic_prev_available),"colors"in D&&d(6,M=D.colors),"decimals"in D&&d(7,F=D.decimals),"label"in D&&d(8,R=D.label)},[p,y,v,a,T,E,M,F,R]}class Bh extends mn{constructor(h){super(),yn(this,h,q0,j0,gn,{data:0,height:1,xKey:2,yKey:3,zKey:4,topic_prev_available:5,colors:6,decimals:7,label:8})}}function pm(u,h,d){const p=u.slice();return p[15]=h[d],p}function fm(u,h,d){const p=u.slice();return p[18]=h[d],p[19]=h,p[20]=d,p}function dm(u,h,d){const p=u.slice();return p[15]=h[d],p[20]=d,p}function mm(u){let h,d=u[5],p=[];for(let y=0;y<d.length;y+=1)p[y]=ym(dm(u,d,y));return{c(){h=Fe("ul");for(let y=0;y<p.length;y+=1)p[y].c();this.h()},l(y){h=Ne(y,"UL",{class:!0});var v=Be(h);for(let a=0;a<p.length;a+=1)p[a].l(v);v.forEach(ae),this.h()},h(){oe(h,"class","legend-block svelte-sk00pb")},m(y,v){Le(y,h,v);for(let a=0;a<p.length;a+=1)p[a]&&p[a].m(h,null)},p(y,v){if(v&32){d=y[5];let a;for(a=0;a<d.length;a+=1){const T=dm(y,d,a);p[a]?p[a].p(T,v):(p[a]=ym(T),p[a].c(),p[a].m(h,null))}for(;a<p.length;a+=1)p[a].d(1);p.length=d.length}},d(y){y&&ae(h),on(p,y)}}}function ym(u){let h,d,p,y,v=u[15]+"",a,T;return{c(){h=Fe("li"),d=Fe("div"),p=mt(),y=Fe("span"),a=Pt(v),T=mt(),this.h()},l(E){h=Ne(E,"LI",{class:!0});var M=Be(h);d=Ne(M,"DIV",{class:!0}),Be(d).forEach(ae),p=yt(M),y=Ne(M,"SPAN",{});var F=Be(y);a=Ct(F,v),F.forEach(ae),T=yt(M),M.forEach(ae),this.h()},h(){oe(d,"class","legend-vis "+(u[20]==0?"bar":"bar2")+" svelte-sk00pb"),oe(h,"class","svelte-sk00pb")},m(E,M){Le(E,h,M),Te(h,d),Te(h,p),Te(h,y),Te(y,a),Te(h,T)},p(E,M){M&32&&v!==(v=E[15]+"")&&Ar(a,v)},d(E){E&&ae(h)}}}function gm(u){let h,d=`${u[4](u[18][u[0]])}%`,p,y,v=vm(u[18][u[0]])+"",a,T,E=`calc(${u[4](u[18][u[0]])}% + 2px)`;function M(){u[12].call(y,u[19],u[20])}return{c(){h=Fe("div"),p=mt(),y=Fe("div"),a=Pt(v),this.h()},l(F){h=Ne(F,"DIV",{class:!0}),Be(h).forEach(ae),p=yt(F),y=Ne(F,"DIV",{class:!0});var R=Be(y);a=Ct(R,v),R.forEach(ae),this.h()},h(){oe(h,"class",Ph(u[20]==0?"bar":"bar2")+" svelte-sk00pb"),Ge(h,"left","0"),Ge(h,"width",d),Ge(h,"top",u[20]==0?"0":"50%"),Ge(h,"height",u[5][1]?"50%":"100%"),oe(y,"class","label svelte-sk00pb"),Ku(()=>M.call(y)),Ge(y,"left",E),Ge(y,"top",u[20]==0?"0":"50%"),Ge(y,"height","50%")},m(F,R){Le(F,h,R),Le(F,p,R),Le(F,y,R),Te(y,a),T=Xu(y,M.bind(y))},p(F,R){u=F,R&25&&d!==(d=`${u[4](u[18][u[0]])}%`)&&Ge(h,"width",d),R&32&&Ge(h,"height",u[5][1]?"50%":"100%"),R&9&&v!==(v=vm(u[18][u[0]])+"")&&Ar(a,v),R&25&&E!==(E=`calc(${u[4](u[18][u[0]])}% + 2px)`)&&Ge(y,"left",E)},d(F){F&&ae(h),F&&ae(p),F&&ae(y),T()}}}function _m(u){let h,d=u[15].label+"",p,y,v,a,T=`${u[5][1]?u[1]*2:u[1]}px`,E=`calc(100% - ${u[2]}px)`,M=u[15].values,F=[];for(let R=0;R<M.length;R+=1)F[R]=gm(fm(u,M,R));return{c(){h=Fe("div"),p=Pt(d),y=mt(),v=Fe("div");for(let R=0;R<F.length;R+=1)F[R].c();a=mt(),this.h()},l(R){h=Ne(R,"DIV",{class:!0});var D=Be(h);p=Ct(D,d),D.forEach(ae),y=yt(R),v=Ne(R,"DIV",{class:!0});var H=Be(v);for(let ie=0;ie<F.length;ie+=1)F[ie].l(H);a=yt(H),H.forEach(ae),this.h()},h(){oe(h,"class","label-group svelte-sk00pb"),oe(v,"class","bar-group svelte-sk00pb"),Ge(v,"height",T),Ge(v,"width",E)},m(R,D){Le(R,h,D),Te(h,p),Le(R,y,D),Le(R,v,D);for(let H=0;H<F.length;H+=1)F[H]&&F[H].m(v,null);Te(v,a)},p(R,D){if(D&8&&d!==(d=R[15].label+"")&&Ar(p,d),D&57){M=R[15].values;let H;for(H=0;H<M.length;H+=1){const ie=fm(R,M,H);F[H]?F[H].p(ie,D):(F[H]=gm(ie),F[H].c(),F[H].m(v,a))}for(;H<F.length;H+=1)F[H].d(1);F.length=M.length}D&34&&T!==(T=`${R[5][1]?R[1]*2:R[1]}px`)&&Ge(v,"height",T),D&4&&E!==(E=`calc(100% - ${R[2]}px)`)&&Ge(v,"width",E)},d(R){R&&ae(h),R&&ae(y),R&&ae(v),on(F,R)}}}function Z0(u){let h,d,p=u[5][1]&&mm(u),y=u[3],v=[];for(let a=0;a<y.length;a+=1)v[a]=_m(pm(u,y,a));return{c(){p&&p.c(),h=mt();for(let a=0;a<v.length;a+=1)v[a].c();d=cr()},l(a){p&&p.l(a),h=yt(a);for(let T=0;T<v.length;T+=1)v[T].l(a);d=cr()},m(a,T){p&&p.m(a,T),Le(a,h,T);for(let E=0;E<v.length;E+=1)v[E]&&v[E].m(a,T);Le(a,d,T)},p(a,[T]){if(a[5][1]?p?p.p(a,T):(p=mm(a),p.c(),p.m(h.parentNode,h)):p&&(p.d(1),p=null),T&63){y=a[3];let E;for(E=0;E<y.length;E+=1){const M=pm(a,y,E);v[E]?v[E].p(M,T):(v[E]=_m(M),v[E].c(),v[E].m(d.parentNode,d))}for(;E<v.length;E+=1)v[E].d(1);v.length=y.length}},i:vi,o:vi,d(a){p&&p.d(a),a&&ae(h),on(v,a),a&&ae(d)}}}function vm(u){let h;return u<1?h="<1%":h=u.toFixed(0)+"%",h}function G0(u,h,d){let p,y,v,a,{data:T}=h,{xKey:E="perc"}=h,{yKey:M="category"}=h,{zKey:F="ni"}=h,{formatTick:R=we=>Math.round(we)}=h,{suffix:D="%"}=h,{barHeight:H=20}=h,{margin:ie=30}=h;function de(we,xe){let st={};for(const Me of we)st[Me[xe]]||(st[Me[xe]]={label:Me[xe],values:[]}),st[Me[xe]].values.push(Me);let $e=[];for(const Me in st)$e.push(st[Me]);return $e}function fe(we,xe){we[xe].width=this.clientWidth,d(3,a),d(6,T),d(7,M)}return u.$$set=we=>{"data"in we&&d(6,T=we.data),"xKey"in we&&d(0,E=we.xKey),"yKey"in we&&d(7,M=we.yKey),"zKey"in we&&d(8,F=we.zKey),"formatTick"in we&&d(9,R=we.formatTick),"suffix"in we&&d(10,D=we.suffix),"barHeight"in we&&d(1,H=we.barHeight),"margin"in we&&d(2,ie=we.margin)},u.$$.update=()=>{u.$$.dirty&65&&d(11,p=[0,Math.max(...T.map(we=>we[E]))]),u.$$.dirty&192&&T.map(we=>we[M]).filter((we,xe,st)=>st.indexOf(we)===xe),u.$$.dirty&320&&d(5,y=T.map(we=>we[F]).filter((we,xe,st)=>st.indexOf(we)===xe)),u.$$.dirty&2048&&d(4,v=we=>we/p[1]*100),u.$$.dirty&192&&d(3,a=de(T,M))},[E,H,ie,a,v,y,T,M,F,R,D,p,fe]}class Oh extends mn{constructor(h){super(),yn(this,h,G0,Z0,gn,{data:6,xKey:0,yKey:7,zKey:8,formatTick:9,suffix:10,barHeight:1,margin:2})}}function bm(u,h,d){const p=u.slice();return p[14]=h[d],p}function xm(u,h,d){const p=u.slice();return p[17]=h[d],p[19]=d,p}function wm(u,h,d){const p=u.slice();return p[17]=h[d],p[19]=d,p}function Sm(u,h,d){const p=u.slice();return p[14]=h[d],p[19]=d,p}function km(u){let h,d=u[7],p=[];for(let y=0;y<d.length;y+=1)p[y]=Em(Sm(u,d,y));return{c(){h=Fe("ul");for(let y=0;y<p.length;y+=1)p[y].c();this.h()},l(y){h=Ne(y,"UL",{class:!0});var v=Be(h);for(let a=0;a<p.length;a+=1)p[a].l(v);v.forEach(ae),this.h()},h(){oe(h,"class","legend svelte-1hk4284")},m(y,v){Le(y,h,v);for(let a=0;a<p.length;a+=1)p[a]&&p[a].m(h,null)},p(y,v){if(v&144){d=y[7];let a;for(a=0;a<d.length;a+=1){const T=Sm(y,d,a);p[a]?p[a].p(T,v):(p[a]=Em(T),p[a].c(),p[a].m(h,null))}for(;a<p.length;a+=1)p[a].d(1);p.length=d.length}},d(y){y&&ae(h),on(p,y)}}}function Em(u){let h,d,p,y,v=u[14]+"",a,T;return{c(){h=Fe("li"),d=Fe("div"),p=mt(),y=Fe("span"),a=Pt(v),T=mt(),this.h()},l(E){h=Ne(E,"LI",{class:!0});var M=Be(h);d=Ne(M,"DIV",{class:!0}),Be(d).forEach(ae),p=yt(M),y=Ne(M,"SPAN",{class:!0});var F=Be(y);a=Ct(F,v),F.forEach(ae),T=yt(M),M.forEach(ae),this.h()},h(){oe(d,"class","legend-vis "+(u[19]==0?"bar":"marker")+" svelte-1hk4284"),Ge(d,"height","1rem"),Ge(d,"width",u[19]==0?"1rem":u[4]+"px"),oe(y,"class",Ph(u[19]==0?"bold":"brackets")+" svelte-1hk4284"),oe(h,"class","svelte-1hk4284")},m(E,M){Le(E,h,M),Te(h,d),Te(h,p),Te(h,y),Te(y,a),Te(h,T)},p(E,M){M&16&&Ge(d,"width",E[19]==0?"1rem":E[4]+"px"),M&128&&v!==(v=E[14]+"")&&Ar(a,v)},d(E){E&&ae(h)}}}function Tm(u){let h,d=u[1](u[17].perc/100)+"",p,y;return{c(){h=Fe("span"),p=Pt(d),y=Pt(u[2]),this.h()},l(v){h=Ne(v,"SPAN",{class:!0,style:!0});var a=Be(h);p=Ct(a,d),y=Ct(a,u[2]),a.forEach(ae),this.h()},h(){oe(h,"class",Ph(u[19]==0?"bold":"sml brackets")+" svelte-1hk4284"),Ge(h,"color",u[19]==0?"#000000":"#1460aa")},m(v,a){Le(v,h,a),Te(h,p),Te(h,y)},p(v,a){a&34&&d!==(d=v[1](v[17].perc/100)+"")&&Ar(p,d),a&4&&Ar(y,v[2])},d(v){v&&ae(h)}}}function K0(u){let h,d=`calc(${u[6](u[17][u[0]])}% - ${u[4]/2}px)`,p=`${u[4]}px`;return{c(){h=Fe("div"),this.h()},l(y){h=Ne(y,"DIV",{class:!0}),Be(h).forEach(ae),this.h()},h(){oe(h,"class","marker svelte-1hk4284"),Ge(h,"left",d),Ge(h,"border-left-width",p)},m(y,v){Le(y,h,v)},p(y,v){v&113&&d!==(d=`calc(${y[6](y[17][y[0]])}% - ${y[4]/2}px)`)&&Ge(h,"left",d),v&16&&p!==(p=`${y[4]}px`)&&Ge(h,"border-left-width",p)},d(y){y&&ae(h)}}}function X0(u){let h,d=`${u[6](u[17][u[0]])}%`;return{c(){h=Fe("div"),this.h()},l(p){h=Ne(p,"DIV",{class:!0}),Be(h).forEach(ae),this.h()},h(){oe(h,"class","bar svelte-1hk4284"),Ge(h,"left","0"),Ge(h,"width",d)},m(p,y){Le(p,h,y)},p(p,y){y&97&&d!==(d=`${p[6](p[17][p[0]])}%`)&&Ge(h,"width",d)},d(p){p&&ae(h)}}}function zm(u){let h;function d(v,a){return v[19]==0?X0:K0}let y=d(u)(u);return{c(){y.c(),h=cr()},l(v){y.l(v),h=cr()},m(v,a){y.m(v,a),Le(v,h,a)},p(v,a){y.p(v,a)},d(v){y.d(v),v&&ae(h)}}}function Im(u){let h,d=u[14].label+"",p,y,v,a,T,E=`${u[3]}px`,M=u[14].values,F=[];for(let H=0;H<M.length;H+=1)F[H]=Tm(wm(u,M,H));let R=u[14].values,D=[];for(let H=0;H<R.length;H+=1)D[H]=zm(xm(u,R,H));return{c(){h=Fe("div"),p=Pt(d),y=mt();for(let H=0;H<F.length;H+=1)F[H].c();v=mt(),a=Fe("div");for(let H=0;H<D.length;H+=1)D[H].c();T=mt(),this.h()},l(H){h=Ne(H,"DIV",{class:!0});var ie=Be(h);p=Ct(ie,d),y=yt(ie);for(let fe=0;fe<F.length;fe+=1)F[fe].l(ie);ie.forEach(ae),v=yt(H),a=Ne(H,"DIV",{class:!0});var de=Be(a);for(let fe=0;fe<D.length;fe+=1)D[fe].l(de);T=yt(de),de.forEach(ae),this.h()},h(){oe(h,"class","label-group svelte-1hk4284"),oe(a,"class","bar-group svelte-1hk4284"),Ge(a,"height",E)},m(H,ie){Le(H,h,ie),Te(h,p),Te(h,y);for(let de=0;de<F.length;de+=1)F[de]&&F[de].m(h,null);Le(H,v,ie),Le(H,a,ie);for(let de=0;de<D.length;de+=1)D[de]&&D[de].m(a,null);Te(a,T)},p(H,ie){if(ie&32&&d!==(d=H[14].label+"")&&Ar(p,d),ie&38){M=H[14].values;let de;for(de=0;de<M.length;de+=1){const fe=wm(H,M,de);F[de]?F[de].p(fe,ie):(F[de]=Tm(fe),F[de].c(),F[de].m(h,null))}for(;de<F.length;de+=1)F[de].d(1);F.length=M.length}if(ie&113){R=H[14].values;let de;for(de=0;de<R.length;de+=1){const fe=xm(H,R,de);D[de]?D[de].p(fe,ie):(D[de]=zm(fe),D[de].c(),D[de].m(a,T))}for(;de<D.length;de+=1)D[de].d(1);D.length=R.length}ie&8&&E!==(E=`${H[3]}px`)&&Ge(a,"height",E)},d(H){H&&ae(h),on(F,H),H&&ae(v),H&&ae(a),on(D,H)}}}function W0(u){let h,d,p=u[7][1]&&km(u),y=u[5],v=[];for(let a=0;a<y.length;a+=1)v[a]=Im(bm(u,y,a));return{c(){p&&p.c(),h=mt();for(let a=0;a<v.length;a+=1)v[a].c();d=cr()},l(a){p&&p.l(a),h=yt(a);for(let T=0;T<v.length;T+=1)v[T].l(a);d=cr()},m(a,T){p&&p.m(a,T),Le(a,h,T);for(let E=0;E<v.length;E+=1)v[E]&&v[E].m(a,T);Le(a,d,T)},p(a,[T]){if(a[7][1]?p?p.p(a,T):(p=km(a),p.c(),p.m(h.parentNode,h)):p&&(p.d(1),p=null),T&127){y=a[5];let E;for(E=0;E<y.length;E+=1){const M=bm(a,y,E);v[E]?v[E].p(M,T):(v[E]=Im(M),v[E].c(),v[E].m(d.parentNode,d))}for(;E<v.length;E+=1)v[E].d(1);v.length=y.length}},i:vi,o:vi,d(a){p&&p.d(a),a&&ae(h),on(v,a),a&&ae(d)}}}function H0(u,h,d){let p,y,v,a,{data:T}=h,{xKey:E="perc"}=h,{yKey:M="category"}=h,{zKey:F="group"}=h,{formatTick:R=fe=>Math.round(100*fe)}=h,{suffix:D="%"}=h,{barHeight:H=25}=h,{markerWidth:ie=3}=h;function de(fe,we){let xe={};for(const $e of fe)xe[$e[we]]||(xe[$e[we]]={label:$e[we],values:[]}),xe[$e[we]].values.push($e);let st=[];for(const $e in xe)st.push(xe[$e]);return st}return u.$$set=fe=>{"data"in fe&&d(8,T=fe.data),"xKey"in fe&&d(0,E=fe.xKey),"yKey"in fe&&d(9,M=fe.yKey),"zKey"in fe&&d(10,F=fe.zKey),"formatTick"in fe&&d(1,R=fe.formatTick),"suffix"in fe&&d(2,D=fe.suffix),"barHeight"in fe&&d(3,H=fe.barHeight),"markerWidth"in fe&&d(4,ie=fe.markerWidth)},u.$$.update=()=>{u.$$.dirty&257&&d(11,p=[0,Math.max(...T.map(fe=>fe[E]))]),u.$$.dirty&768&&T.map(fe=>fe[M]).filter((fe,we,xe)=>xe.indexOf(fe)===we),u.$$.dirty&1280&&d(7,y=T.map(fe=>fe[F]).filter((fe,we,xe)=>xe.indexOf(fe)===we)),u.$$.dirty&2048&&d(6,v=fe=>fe/p[1]*100),u.$$.dirty&768&&d(5,a=de(T,M))},[E,R,D,H,ie,a,v,y,T,M,F,p]}class Fh extends mn{constructor(h){super(),yn(this,h,H0,W0,gn,{data:8,xKey:0,yKey:9,zKey:10,formatTick:1,suffix:2,barHeight:3,markerWidth:4})}}function Am(u,h,d){const p=u.slice();return p[12]=h[d],p[14]=d,p}function Pm(u,h,d){const p=u.slice();return p[15]=h[d],p[17]=d,p}function Cm(u,h,d){const p=u.slice();return p[15]=h[d],p[17]=d,p}function Mm(u,h,d){const p=u.slice();return p[19]=h[d],p[14]=d,p}function Dm(u){let h,d=u[5],p=[];for(let y=0;y<d.length;y+=1)p[y]=Lm(Mm(u,d,y));return{c(){h=Fe("ul");for(let y=0;y<p.length;y+=1)p[y].c();this.h()},l(y){h=Ne(y,"UL",{class:!0});var v=Be(h);for(let a=0;a<p.length;a+=1)p[a].l(v);v.forEach(ae),this.h()},h(){oe(h,"class","legend svelte-pmaxst")},m(y,v){Le(y,h,v);for(let a=0;a<p.length;a+=1)p[a]&&p[a].m(h,null)},p(y,v){if(v&36){d=y[5];let a;for(a=0;a<d.length;a+=1){const T=Mm(y,d,a);p[a]?p[a].p(T,v):(p[a]=Lm(T),p[a].c(),p[a].m(h,null))}for(;a<p.length;a+=1)p[a].d(1);p.length=d.length}},d(y){y&&ae(h),on(p,y)}}}function Lm(u){let h,d,p,y,v=u[19]+"",a,T;return{c(){h=Fe("li"),d=Fe("div"),p=mt(),y=Fe("span"),a=Pt(v),T=mt(),this.h()},l(E){h=Ne(E,"LI",{class:!0});var M=Be(h);d=Ne(M,"DIV",{class:!0}),Be(d).forEach(ae),p=yt(M),y=Ne(M,"SPAN",{class:!0});var F=Be(y);a=Ct(F,v),F.forEach(ae),T=yt(M),M.forEach(ae),this.h()},h(){oe(d,"class","legend-vis "+(u[14]==0?"bar":"markerSmall")+" svelte-pmaxst"),Ge(d,"height","1rem"),Ge(d,"width",u[14]==0?"1rem":u[2]+"px"),oe(y,"class",Ph(u[14]==0?"bold":"brackets")+" svelte-pmaxst"),oe(h,"class","svelte-pmaxst")},m(E,M){Le(E,h,M),Te(h,d),Te(h,p),Te(h,y),Te(y,a),Te(h,T)},p(E,M){M&4&&Ge(d,"width",E[14]==0?"1rem":E[2]+"px"),M&32&&v!==(v=E[19]+"")&&Ar(a,v)},d(E){E&&ae(h)}}}function J0(u){let h,d=u[12].values,p=[];for(let y=0;y<d.length;y+=1)p[y]=Rm(Pm(u,d,y));return{c(){for(let y=0;y<p.length;y+=1)p[y].c();h=cr()},l(y){for(let v=0;v<p.length;v+=1)p[v].l(y);h=cr()},m(y,v){for(let a=0;a<p.length;a+=1)p[a]&&p[a].m(y,v);Le(y,h,v)},p(y,v){if(v&89){d=y[12].values;let a;for(a=0;a<d.length;a+=1){const T=Pm(y,d,a);p[a]?p[a].p(T,v):(p[a]=Rm(T),p[a].c(),p[a].m(h.parentNode,h))}for(;a<p.length;a+=1)p[a].d(1);p.length=d.length}},d(y){on(p,y),y&&ae(h)}}}function Y0(u){let h,d=u[12].values,p=[];for(let y=0;y<d.length;y+=1)p[y]=Bm(Cm(u,d,y));return{c(){for(let y=0;y<p.length;y+=1)p[y].c();h=cr()},l(y){for(let v=0;v<p.length;v+=1)p[v].l(y);h=cr()},m(y,v){for(let a=0;a<p.length;a+=1)p[a]&&p[a].m(y,v);Le(y,h,v)},p(y,v){if(v&89){d=y[12].values;let a;for(a=0;a<d.length;a+=1){const T=Cm(y,d,a);p[a]?p[a].p(T,v):(p[a]=Bm(T),p[a].c(),p[a].m(h.parentNode,h))}for(;a<p.length;a+=1)p[a].d(1);p.length=d.length}},d(y){on(p,y),y&&ae(h)}}}function Rm(u){let h,d,p=`calc(100% - ${u[15].offset<0?u[4](u[15][u[0]]-u[15].offset):u[4](u[15][u[0]])}%)`,y=`${u[4](u[15].offset)}%`,v=`${u[17]/u[6].length*100}%`,a=`${1/u[6].length*100}%`;return{c(){h=Fe("div"),this.h()},l(T){h=Ne(T,"DIV",{class:!0,style:!0}),Be(h).forEach(ae),this.h()},h(){oe(h,"class","marker svelte-pmaxst"),oe(h,"style",d="border-"+(u[15].offset<0?"top":"bottom")+": none"),Ge(h,"top",p),Ge(h,"height",y),Ge(h,"left",v),Ge(h,"width",a)},m(T,E){Le(T,h,E)},p(T,E){E&8&&d!==(d="border-"+(T[15].offset<0?"top":"bottom")+": none")&&oe(h,"style",d);const M=E&8;(M||E&25&&p!==(p=`calc(100% - ${T[15].offset<0?T[4](T[15][T[0]]-T[15].offset):T[4](T[15][T[0]])}%)`))&&Ge(h,"top",p),(M||E&24&&y!==(y=`${T[4](T[15].offset)}%`))&&Ge(h,"height",y),(M||E&72&&v!==(v=`${T[17]/T[6].length*100}%`))&&Ge(h,"left",v),(M||E&72&&a!==(a=`${1/T[6].length*100}%`))&&Ge(h,"width",a)},d(T){T&&ae(h)}}}function Bm(u){let h,d=`${100-u[4](u[15][u[0]])}%`,p=`${u[4](u[15][u[0]])}%`,y=`${u[17]/u[6].length*100}%`,v=`calc(${1/u[6].length*100}% - 2px)`;return{c(){h=Fe("div"),this.h()},l(a){h=Ne(a,"DIV",{class:!0}),Be(h).forEach(ae),this.h()},h(){oe(h,"class","bar svelte-pmaxst"),Ge(h,"top",d),Ge(h,"height",p),Ge(h,"left",y),Ge(h,"width",v)},m(a,T){Le(a,h,T)},p(a,T){T&25&&d!==(d=`${100-a[4](a[15][a[0]])}%`)&&Ge(h,"top",d),T&25&&p!==(p=`${a[4](a[15][a[0]])}%`)&&Ge(h,"height",p),T&64&&y!==(y=`${a[17]/a[6].length*100}%`)&&Ge(h,"left",y),T&64&&v!==(v=`calc(${1/a[6].length*100}% - 2px)`)&&Ge(h,"width",v)},d(a){a&&ae(h)}}}function Om(u){let h;function d(v,a){return v[14]==0?Y0:J0}let y=d(u)(u);return{c(){y.c(),h=cr()},l(v){y.l(v),h=cr()},m(v,a){y.m(v,a),Le(v,h,a)},p(v,a){y.p(v,a)},d(v){y.d(v),v&&ae(h)}}}function Q0(u){let h,d,p=`${u[1]}px`,y,v,a,T,E,M,F,R,D,H,ie,de,fe,we,xe=u[5][1]&&Dm(u),st=u[3],$e=[];for(let Me=0;Me<st.length;Me+=1)$e[Me]=Om(Am(u,st,Me));return{c(){xe&&xe.c(),h=mt(),d=Fe("div");for(let Me=0;Me<$e.length;Me+=1)$e[Me].c();y=mt(),v=Fe("div"),a=Fe("div"),T=Fe("div"),E=Pt("0-14"),M=mt(),F=Fe("div"),R=Pt("15-39"),D=mt(),H=Fe("div"),ie=Pt("40-64"),de=mt(),fe=Fe("div"),we=Pt("65+"),this.h()},l(Me){xe&&xe.l(Me),h=yt(Me),d=Ne(Me,"DIV",{class:!0});var Je=Be(d);for(let bt=0;bt<$e.length;bt+=1)$e[bt].l(Je);Je.forEach(ae),y=yt(Me),v=Ne(Me,"DIV",{class:!0});var ct=Be(v);a=Ne(ct,"DIV",{class:!0});var Ue=Be(a);T=Ne(Ue,"DIV",{class:!0});var ht=Be(T);E=Ct(ht,"0-14"),ht.forEach(ae),M=yt(Ue),F=Ne(Ue,"DIV",{class:!0});var _t=Be(F);R=Ct(_t,"15-39"),_t.forEach(ae),D=yt(Ue),H=Ne(Ue,"DIV",{class:!0});var pt=Be(H);ie=Ct(pt,"40-64"),pt.forEach(ae),de=yt(Ue),fe=Ne(Ue,"DIV",{class:!0});var Nt=Be(fe);we=Ct(Nt,"65+"),Nt.forEach(ae),Ue.forEach(ae),ct.forEach(ae),this.h()},h(){oe(d,"class","bar-group svelte-pmaxst"),Ge(d,"height",p),oe(T,"class","column svelte-pmaxst"),oe(F,"class","column svelte-pmaxst"),oe(H,"class","column svelte-pmaxst"),oe(fe,"class","column svelte-pmaxst"),oe(a,"class","row svelte-pmaxst"),Ge(a,"width","100%"),oe(v,"class","x-scale svelte-pmaxst")},m(Me,Je){xe&&xe.m(Me,Je),Le(Me,h,Je),Le(Me,d,Je);for(let ct=0;ct<$e.length;ct+=1)$e[ct]&&$e[ct].m(d,null);Le(Me,y,Je),Le(Me,v,Je),Te(v,a),Te(a,T),Te(T,E),Te(a,M),Te(a,F),Te(F,R),Te(a,D),Te(a,H),Te(H,ie),Te(a,de),Te(a,fe),Te(fe,we)},p(Me,[Je]){if(Me[5][1]?xe?xe.p(Me,Je):(xe=Dm(Me),xe.c(),xe.m(h.parentNode,h)):xe&&(xe.d(1),xe=null),Je&89){st=Me[3];let ct;for(ct=0;ct<st.length;ct+=1){const Ue=Am(Me,st,ct);$e[ct]?$e[ct].p(Ue,Je):($e[ct]=Om(Ue),$e[ct].c(),$e[ct].m(d,null))}for(;ct<$e.length;ct+=1)$e[ct].d(1);$e.length=st.length}Je&2&&p!==(p=`${Me[1]}px`)&&Ge(d,"height",p)},i:vi,o:vi,d(Me){xe&&xe.d(Me),Me&&ae(h),Me&&ae(d),on($e,Me),Me&&ae(y),Me&&ae(v)}}}function $0(u,h,d){let p,y,v,a,T,{data:E}=h,{xKey:M="category"}=h,{yKey:F="perc"}=h,{zKey:R="group"}=h,{height:D=100}=h,{markerWidth:H=3}=h;function ie(de,fe){let we={};for(const st of de){we[st[fe]]||(we[st[fe]]={label:st[fe],values:[]});let $e=we[st[fe]].values.length,Me=$e==0?0:st[F]-we[st[fe]].values[$e-1][F];we[st[fe]].values.push({...st,offset:Me})}let xe=[];for(const st in we)xe.push(we[st]);return console.log(xe),xe}return u.$$set=de=>{"data"in de&&d(7,E=de.data),"xKey"in de&&d(8,M=de.xKey),"yKey"in de&&d(0,F=de.yKey),"zKey"in de&&d(9,R=de.zKey),"height"in de&&d(1,D=de.height),"markerWidth"in de&&d(2,H=de.markerWidth)},u.$$.update=()=>{u.$$.dirty&384&&d(6,p=E.map(de=>de[M]).filter((de,fe,we)=>we.indexOf(de)===fe)),u.$$.dirty&129&&d(10,y=[0,Math.max(...E.map(de=>de[F]))]),u.$$.dirty&640&&d(5,v=E.map(de=>de[R]).filter((de,fe,we)=>we.indexOf(de)===fe)),u.$$.dirty&1024&&d(4,a=de=>Math.abs(de/y[1])*100),u.$$.dirty&640&&d(3,T=ie(E,R))},[F,D,H,T,a,v,p,E,M,R,y]}class Nh extends mn{constructor(h){super(),yn(this,h,$0,Q0,gn,{data:7,xKey:8,yKey:0,zKey:9,height:1,markerWidth:2})}}function e1(u){let h,d,p,y;return{c(){h=Fe("div"),d=Pt("Back to top"),this.h()},l(v){h=Ne(v,"DIV",{class:!0});var a=Be(h);d=Ct(a,"Back to top"),a.forEach(ae),this.h()},h(){oe(h,"class","back_to_start svelte-11zibd5"),Jn(h,"hidden",u[0])},m(v,a){Le(v,h,a),Te(h,d),p||(y=[pa(window,"scroll",u[2]),pa(h,"click",u[1])],p=!0)},p(v,[a]){a&1&&Jn(h,"hidden",v[0])},i:vi,o:vi,d(v){v&&ae(h),p=!1,Hu(y)}}}function t1(u,h,d){let{buttonVisibleOnPX:p=200}=h,y=!0;const v=()=>{document.body.scrollIntoView()},a=()=>document.documentElement||document.body,T=()=>{a().scrollTop>p?d(0,y=!1):d(0,y=!0)};return u.$$set=E=>{"buttonVisibleOnPX"in E&&d(3,p=E.buttonVisibleOnPX)},[y,v,T,p]}class r1 extends mn{constructor(h){super(),yn(this,h,t1,e1,gn,{buttonVisibleOnPX:3})}}function i1(u){let h,d,p=u[1][u[0]].title+"",y,v,a,T,E,M,F,R=u[1][u[0]].info+"",D;return{c(){h=Fe("div"),d=Fe("div"),y=Pt(p),v=Fe("span"),E=mt(),M=Fe("div"),F=Fe("div"),this.h()},l(H){h=Ne(H,"DIV",{class:!0,style:!0,"data-bs-toggle":!0,"data-bs-target":!0,"aria-expanded":!0,"aria-controls":!0});var ie=Be(h);d=Ne(ie,"DIV",{class:!0,style:!0});var de=Be(d);y=Ct(de,p),v=Ne(de,"SPAN",{class:!0}),Be(v).forEach(ae),de.forEach(ae),ie.forEach(ae),E=yt(H),M=Ne(H,"DIV",{class:!0,id:!0});var fe=Be(M);F=Ne(fe,"DIV",{class:!0});var we=Be(F);we.forEach(ae),fe.forEach(ae),this.h()},h(){oe(v,"class","i-button"),oe(d,"class","blocktitle"),Ge(d,"margin","0"),Ge(d,"width","100%"),oe(h,"class","row"),Ge(h,"display","flex"),Ge(h,"cursor","pointer"),oe(h,"data-bs-toggle","collapse"),oe(h,"data-bs-target",a="#"+u[0]+"-info"),oe(h,"aria-expanded","false"),oe(h,"aria-controls",T=u[0]+"-info"),oe(F,"class","card card-body svelte-1qrf6oz"),oe(M,"class","collapse svelte-1qrf6oz"),oe(M,"id",D=u[0]+"-info")},m(H,ie){Le(H,h,ie),Te(h,d),Te(d,y),Te(d,v),Le(H,E,ie),Le(H,M,ie),Te(M,F),F.innerHTML=R},p(H,[ie]){ie&1&&p!==(p=H[1][H[0]].title+"")&&Ar(y,p),ie&1&&a!==(a="#"+H[0]+"-info")&&oe(h,"data-bs-target",a),ie&1&&T!==(T=H[0]+"-info")&&oe(h,"aria-controls",T),ie&1&&R!==(R=H[1][H[0]].info+"")&&(F.innerHTML=R),ie&1&&D!==(D=H[0]+"-info")&&oe(M,"id",D)},i:vi,o:vi,d(H){H&&ae(h),H&&ae(E),H&&ae(M)}}}function n1(u,h,d){let{id:p}=h,{place:y}=h,v={location:{title:"About the area",info:"Information about the area including its geographical hierarchy."},area:{title:"Area",info:"Area is measured in hectares (ha), it is rounded to the nearest whole number."},popden:{title:"Population density",info:"Population density is the number of usual residents per hectare. It is rounded to 1 d.p."},pop:{title:"Population",info:"Population is based on the number of usual residents. <p>Sourced from Census 2021 data - <a href='https://explore.nisra.gov.uk/area-explorer-2021/'><strong>Census Area Explorer</strong></a></p>A usual resident is anyone who, on 21 March 2021 is in the UK, and staying in the UK for a period of 3 months or more; or has a permanent UK address and is outside the UK and is staying outside the UK for less than 12 months. <a href='https://www.nisra.gov.uk/publications/census-2021-statistical-bulletins'><strong>Statistical bulletins</strong></a>"},generalhealth:{title:"General Health",info:"<p>Sourced from Census 2021 data - <a href='https://explore.nisra.gov.uk/area-explorer-2021/'><strong>Census Area Explorer</strong></a></p>General health is a self-assessment of a person’s general state of health. It is not based over any specified period of time. <a href='https://www.nisra.gov.uk/publications/census-2021-statistical-bulletins'><strong>Statistical bulletins</strong></a>"},wellbeing:{title:"Happiness",info:"Average Happiness score out of 10 for people aged 16+</p><p>source:</p><p>Last Updated:</p><p>Further Information:</p>"},lifeexpectancy:{title:"Life Expectancy at birth",info:"words to be added"},carers:{title:"Provision of unpaid care",info:"<p>Sourced from Census 2021 data - <a href='https://explore.nisra.gov.uk/area-explorer-2021/'><strong>Census Area Explorer</strong></a></p>Unpaid care covers looking after giving help or support to anyone because they have long-term physical or mental health conditions or illnesses, or problems related to old age. It does not include any activities as part of paid employment. All unpaid care statistics are restricted to persons aged 5 and over. <a href='https://www.nisra.gov.uk/publications/census-2021-statistical-bulletins'><strong>Statistical bulletins</strong></a>"},hospitalactivity:{title:"Activity in hospitals / waiting lists",info:"words to be added"},primarycare:{title:"Primary care providers",info:"words to be added"},employmentrates:{title:"Employment rates",info:"words to be added"},employed:{title:"Number of people employed",info:"words to be added"},wages:{title:"Average wages",info:"words to be added"},benefits:{title:"Personal Independent Payment (PIP) benefits",info:"some info here"},pensionagebenefits:{title:"Pension Age benefits",info:"some info here"},workingagebenefits:{title:"Working Age benefits",info:"some info here"},disabilitybenefits:{title:"Disability & Carer’s benefits",info:"some info here"},enrollments:{title:"Number of enrolled in schools and colleges",info:"words to be added"},fsme:{title:"Entitlement to Free School Meals",info:"words to be added"},teachers:{title:"Teachers",info:"words to be added"},qualifications:{title:"Highest level of Qualifications",info:"<p>Sourced from Census 2021 data - <a href='https://explore.nisra.gov.uk/area-explorer-2021/'><strong>Census Area Explorer</strong></a></p>words to be added"},attainment:{title:"Attainment of Qualifications",info:"<p>Sourced from Census 2021 data - <a href='https://explore.nisra.gov.uk/area-explorer-2021/'><strong>Census Area Explorer</strong></a></p>words to be added"},popchange:{title:"Population change",info:"words to be added"},age:{title:"Broad age bands",info:"<p>Sourced from Census 2021 data - <a href='https://explore.nisra.gov.uk/area-explorer-2021/'><strong>Census Area Explorer</strong></a></p>A grouping of ages where a person’s age is their age at their last birthday on or prior to census day. <a href='https://www.nisra.gov.uk/publications/census-2021-statistical-bulletins'><strong>Statistical bulletins</strong></a>"},sex:{title:"Sex",info:"words to be added"},hhsize:{title:"Household size",info:"<p>Sourced from Census 2021 data - <a href='https://explore.nisra.gov.uk/area-explorer-2021/'><strong>Census Area Explorer</strong></a></p>The number of usual residents in the household.      <a href='https://www.nisra.gov.uk/publications/census-2021-statistical-bulletins'><strong>Statistical bulletins</strong></a>"},religion:{title:"Religion, Religion brought up",info:"<p>Sourced from Census 2021 data - <a href='https://explore.nisra.gov.uk/area-explorer-2021/'><strong>Census Area Explorer</strong></a></p>The religious group the person belongs to or for people with no current religion their religious group of upbringing.People with no current religion and no religion of upbringing are labelled 'None'.<a href='https://www.nisra.gov.uk/publications/census-2021-statistical-bulletins'><strong>Statistical bulletins</strong></a>"},language:{title:"Main language",info:"<p>Sourced from Census 2021 data - <a href='https://explore.nisra.gov.uk/area-explorer-2021/'><strong>Census Area Explorer</strong></a></p>Person's main language as declared in the Census.Statistics for all language questions are restrictedto persons aged 3 and over. <ahref='https://www.nisra.gov.uk/publications/census-2021-statistical-bulletins'><strong>Statistical bulletins</strong></a>"},households:{title:"Households - box with numbers",info:"<p>Sourced from Census 2021 data - <a href='https://explore.nisra.gov.uk/area-explorer-2021/'><strong>Census Area Explorer</strong></a></p>A household is either one person living alone or a group of people living at the same address who share cooking facilities and share a living room, sitting room or dining area. <a href='https://www.nisra.gov.uk/publications/census-2021-statistical-bulletins'><strong>Statistical bulletins</strong></a>"}};return u.$$set=a=>{"id"in a&&d(0,p=a.id),"place"in a&&d(2,y=a.place)},[p,v,y]}class a1 extends mn{constructor(h){super(),yn(this,h,n1,i1,gn,{id:0,place:2})}}function o1(u){let h,d;return{c(){h=Fe("h3"),d=Pt(u[9]),this.h()},l(p){h=Ne(p,"H3",{style:!0});var y=Be(h);d=Ct(y,u[9]),y.forEach(ae),this.h()},h(){Ge(h,"margin","0 0 10px 0"),Ge(h,"line-height","1.78")},m(p,y){Le(p,h,y),Te(h,d)},p(p,y){y&512&&Ar(d,p[9])},i:vi,o:vi,d(p){p&&ae(h)}}}function s1(u){let h,d;return h=new a1({props:{id:u[1],place:u[3]}}),{c(){er(h.$$.fragment)},l(p){tr(h.$$.fragment,p)},m(p,y){rr(h,p,y),d=!0},p(p,y){const v={};y&2&&(v.id=p[1]),y&8&&(v.place=p[3]),h.$set(v)},i(p){d||(Qe(h.$$.fragment,p),d=!0)},o(p){at(h.$$.fragment,p),d=!1},d(p){ir(h,p)}}}function l1(u){let h,d;return{c(){h=new Ol(!1),d=cr(),this.h()},l(p){h=Fl(p,!1),d=cr(),this.h()},h(){h.a=d},m(p,y){h.m(u[4],p,y),Le(p,d,y)},p(p,y){y&16&&h.p(p[4])},i:vi,o:vi,d(p){p&&ae(d),p&&h.d()}}}function u1(u){let h,d=u[4][u[3].type]+"",p;return{c(){h=new Ol(!1),p=cr(),this.h()},l(y){h=Fl(y,!1),p=cr(),this.h()},h(){h.a=p},m(y,v){h.m(d,y,v),Le(y,p,v)},p(y,v){v&24&&d!==(d=y[4][y[3].type]+"")&&h.p(d)},i:vi,o:vi,d(y){y&&ae(p),y&&h.d()}}}function c1(u){let h,d,p,y,v,a,T;const E=[_1,g1,y1,m1],M=[];function F(R,D){return D&1056&&(h=null),D&1056&&(d=null),D&1056&&(p=null),h==null&&(h=!!(R[5].hasOwnProperty("none")&R[10]==null)),h?0:(d==null&&(d=!!(R[5].hasOwnProperty("prev")&R[10]=="prev")),d?1:(p==null&&(p=!!(R[5].hasOwnProperty("ni")&R[10]=="ni")),p?2:3))}return y=F(u,-1),v=M[y]=E[y](u),{c(){v.c(),a=cr()},l(R){v.l(R),a=cr()},m(R,D){M[y].m(R,D),Le(R,a,D),T=!0},p(R,D){let H=y;y=F(R,D),y===H?M[y].p(R,D):(An(),at(M[H],1,1,()=>{M[H]=null}),Pn(),v=M[y],v?v.p(R,D):(v=M[y]=E[y](R),v.c()),Qe(v,1),v.m(a.parentNode,a))},i(R){T||(Qe(v),T=!0)},o(R){at(v),T=!1},d(R){M[y].d(R),R&&ae(a)}}}function h1(u){let h,d,p,y,v,a,T;const E=[w1,x1,b1,v1],M=[];function F(R,D){return D&1056&&(h=null),D&1056&&(d=null),D&1056&&(p=null),h==null&&(h=!!(R[5].hasOwnProperty("none")&R[10]==null)),h?0:(d==null&&(d=!!(R[5].hasOwnProperty("prev")&R[10]=="prev")),d?1:(p==null&&(p=!!(R[5].hasOwnProperty("ni")&R[10]=="ni")),p?2:3))}return y=F(u,-1),v=M[y]=E[y](u),{c(){v.c(),a=cr()},l(R){v.l(R),a=cr()},m(R,D){M[y].m(R,D),Le(R,a,D),T=!0},p(R,D){let H=y;y=F(R,D),y===H?M[y].p(R,D):(An(),at(M[H],1,1,()=>{M[H]=null}),Pn(),v=M[y],v?v.p(R,D):(v=M[y]=E[y](R),v.c()),Qe(v,1),v.m(a.parentNode,a))},i(R){T||(Qe(v),T=!0)},o(R){at(v),T=!1},d(R){M[y].d(R),R&&ae(a)}}}function p1(u){let h,d,p,y,v,a,T;const E=[T1,E1,k1,S1],M=[];function F(R,D){return D&1056&&(h=null),D&1056&&(d=null),D&1056&&(p=null),h==null&&(h=!!(R[5].hasOwnProperty("none")&R[10]==null)),h?0:(d==null&&(d=!!(R[5].hasOwnProperty("prev")&R[10]=="prev")),d?1:(p==null&&(p=!!(R[5].hasOwnProperty("ni")&R[10]=="ni")),p?2:3))}return y=F(u,-1),v=M[y]=E[y](u),{c(){v.c(),a=cr()},l(R){v.l(R),a=cr()},m(R,D){M[y].m(R,D),Le(R,a,D),T=!0},p(R,D){let H=y;y=F(R,D),y===H?M[y].p(R,D):(An(),at(M[H],1,1,()=>{M[H]=null}),Pn(),v=M[y],v?v.p(R,D):(v=M[y]=E[y](R),v.c()),Qe(v,1),v.m(a.parentNode,a))},i(R){T||(Qe(v),T=!0)},o(R){at(v),T=!1},d(R){M[y].d(R),R&&ae(a)}}}function f1(u){let h,d,p,y,v,a,T;const E=[P1,A1,I1,z1],M=[];function F(R,D){return D&1056&&(h=null),D&1056&&(d=null),D&1056&&(p=null),h==null&&(h=!!(R[5].hasOwnProperty("none")&R[10]==null)),h?0:(d==null&&(d=!!(R[5].hasOwnProperty("prev")&R[10]=="prev")),d?1:(p==null&&(p=!!(R[5].hasOwnProperty("ni")&R[10]=="ni")),p?2:3))}return y=F(u,-1),v=M[y]=E[y](u),{c(){v.c(),a=cr()},l(R){v.l(R),a=cr()},m(R,D){M[y].m(R,D),Le(R,a,D),T=!0},p(R,D){let H=y;y=F(R,D),y===H?M[y].p(R,D):(An(),at(M[H],1,1,()=>{M[H]=null}),Pn(),v=M[y],v?v.p(R,D):(v=M[y]=E[y](R),v.c()),Qe(v,1),v.m(a.parentNode,a))},i(R){T||(Qe(v),T=!0)},o(R){at(v),T=!1},d(R){M[y].d(R),R&&ae(a)}}}function d1(u){let h,d,p,y,v,a,T;const E=[L1,D1,M1,C1],M=[];function F(R,D){return D&1056&&(h=null),D&1056&&(d=null),D&1056&&(p=null),h==null&&(h=!!(R[5].hasOwnProperty("none")&R[10]==null)),h?0:(d==null&&(d=!!(R[5].hasOwnProperty("prev")&R[10]=="prev")),d?1:(p==null&&(p=!!(R[5].hasOwnProperty("ni")&R[10]=="ni")),p?2:3))}return y=F(u,-1),v=M[y]=E[y](u),{c(){v.c(),a=cr()},l(R){v.l(R),a=cr()},m(R,D){M[y].m(R,D),Le(R,a,D),T=!0},p(R,D){let H=y;y=F(R,D),y===H?M[y].p(R,D):(An(),at(M[H],1,1,()=>{M[H]=null}),Pn(),v=M[y],v?v.p(R,D):(v=M[y]=E[y](R),v.c()),Qe(v,1),v.m(a.parentNode,a))},i(R){T||(Qe(v),T=!0)},o(R){at(v),T=!1},d(R){M[y].d(R),R&&ae(a)}}}function m1(u){let h,d;return h=new Rh({props:{data:u[5],zKey:u[6]}}),{c(){er(h.$$.fragment)},l(p){tr(h.$$.fragment,p)},m(p,y){rr(h,p,y),d=!0},p(p,y){const v={};y&32&&(v.data=p[5]),y&64&&(v.zKey=p[6]),h.$set(v)},i(p){d||(Qe(h.$$.fragment,p),d=!0)},o(p){at(h.$$.fragment,p),d=!1},d(p){ir(h,p)}}}function y1(u){let h,d;return h=new Rh({props:{data:u[5].ni,zKey:u[6]}}),{c(){er(h.$$.fragment)},l(p){tr(h.$$.fragment,p)},m(p,y){rr(h,p,y),d=!0},p(p,y){const v={};y&32&&(v.data=p[5].ni),y&64&&(v.zKey=p[6]),h.$set(v)},i(p){d||(Qe(h.$$.fragment,p),d=!0)},o(p){at(h.$$.fragment,p),d=!1},d(p){ir(h,p)}}}function g1(u){let h,d;return h=new Rh({props:{data:u[5].prev,zKey:u[6]}}),{c(){er(h.$$.fragment)},l(p){tr(h.$$.fragment,p)},m(p,y){rr(h,p,y),d=!0},p(p,y){const v={};y&32&&(v.data=p[5].prev),y&64&&(v.zKey=p[6]),h.$set(v)},i(p){d||(Qe(h.$$.fragment,p),d=!0)},o(p){at(h.$$.fragment,p),d=!1},d(p){ir(h,p)}}}function _1(u){let h,d;return h=new Rh({props:{data:u[5].none,zKey:u[6]}}),{c(){er(h.$$.fragment)},l(p){tr(h.$$.fragment,p)},m(p,y){rr(h,p,y),d=!0},p(p,y){const v={};y&32&&(v.data=p[5].none),y&64&&(v.zKey=p[6]),h.$set(v)},i(p){d||(Qe(h.$$.fragment,p),d=!0)},o(p){at(h.$$.fragment,p),d=!1},d(p){ir(h,p)}}}function v1(u){let h,d;return h=new Fh({props:{data:u[5],zKey:u[6],label:u[7]}}),{c(){er(h.$$.fragment)},l(p){tr(h.$$.fragment,p)},m(p,y){rr(h,p,y),d=!0},p(p,y){const v={};y&32&&(v.data=p[5]),y&64&&(v.zKey=p[6]),y&128&&(v.label=p[7]),h.$set(v)},i(p){d||(Qe(h.$$.fragment,p),d=!0)},o(p){at(h.$$.fragment,p),d=!1},d(p){ir(h,p)}}}function b1(u){let h,d;return h=new Fh({props:{data:u[5].ni,zKey:u[6],label:u[7]}}),{c(){er(h.$$.fragment)},l(p){tr(h.$$.fragment,p)},m(p,y){rr(h,p,y),d=!0},p(p,y){const v={};y&32&&(v.data=p[5].ni),y&64&&(v.zKey=p[6]),y&128&&(v.label=p[7]),h.$set(v)},i(p){d||(Qe(h.$$.fragment,p),d=!0)},o(p){at(h.$$.fragment,p),d=!1},d(p){ir(h,p)}}}function x1(u){let h,d;return h=new Fh({props:{data:u[5].prev,zKey:u[6],label:u[7]}}),{c(){er(h.$$.fragment)},l(p){tr(h.$$.fragment,p)},m(p,y){rr(h,p,y),d=!0},p(p,y){const v={};y&32&&(v.data=p[5].prev),y&64&&(v.zKey=p[6]),y&128&&(v.label=p[7]),h.$set(v)},i(p){d||(Qe(h.$$.fragment,p),d=!0)},o(p){at(h.$$.fragment,p),d=!1},d(p){ir(h,p)}}}function w1(u){let h,d;return h=new Fh({props:{data:u[5].none,zKey:u[6],label:u[7]}}),{c(){er(h.$$.fragment)},l(p){tr(h.$$.fragment,p)},m(p,y){rr(h,p,y),d=!0},p(p,y){const v={};y&32&&(v.data=p[5].none),y&64&&(v.zKey=p[6]),y&128&&(v.label=p[7]),h.$set(v)},i(p){d||(Qe(h.$$.fragment,p),d=!0)},o(p){at(h.$$.fragment,p),d=!1},d(p){ir(h,p)}}}function S1(u){let h,d;return h=new Nh({props:{data:u[5],zKey:u[6],label:u[7]}}),{c(){er(h.$$.fragment)},l(p){tr(h.$$.fragment,p)},m(p,y){rr(h,p,y),d=!0},p(p,y){const v={};y&32&&(v.data=p[5]),y&64&&(v.zKey=p[6]),y&128&&(v.label=p[7]),h.$set(v)},i(p){d||(Qe(h.$$.fragment,p),d=!0)},o(p){at(h.$$.fragment,p),d=!1},d(p){ir(h,p)}}}function k1(u){let h,d;return h=new Nh({props:{data:u[5].ni,zKey:u[6],label:u[7]}}),{c(){er(h.$$.fragment)},l(p){tr(h.$$.fragment,p)},m(p,y){rr(h,p,y),d=!0},p(p,y){const v={};y&32&&(v.data=p[5].ni),y&64&&(v.zKey=p[6]),y&128&&(v.label=p[7]),h.$set(v)},i(p){d||(Qe(h.$$.fragment,p),d=!0)},o(p){at(h.$$.fragment,p),d=!1},d(p){ir(h,p)}}}function E1(u){let h,d;return h=new Nh({props:{data:u[5].prev,zKey:u[6],label:u[7]}}),{c(){er(h.$$.fragment)},l(p){tr(h.$$.fragment,p)},m(p,y){rr(h,p,y),d=!0},p(p,y){const v={};y&32&&(v.data=p[5].prev),y&64&&(v.zKey=p[6]),y&128&&(v.label=p[7]),h.$set(v)},i(p){d||(Qe(h.$$.fragment,p),d=!0)},o(p){at(h.$$.fragment,p),d=!1},d(p){ir(h,p)}}}function T1(u){let h,d;return h=new Nh({props:{data:u[5].none,zKey:u[6],label:u[7]}}),{c(){er(h.$$.fragment)},l(p){tr(h.$$.fragment,p)},m(p,y){rr(h,p,y),d=!0},p(p,y){const v={};y&32&&(v.data=p[5].none),y&64&&(v.zKey=p[6]),y&128&&(v.label=p[7]),h.$set(v)},i(p){d||(Qe(h.$$.fragment,p),d=!0)},o(p){at(h.$$.fragment,p),d=!1},d(p){ir(h,p)}}}function z1(u){let h,d;return h=new Oh({props:{data:u[5],zKey:"group"}}),{c(){er(h.$$.fragment)},l(p){tr(h.$$.fragment,p)},m(p,y){rr(h,p,y),d=!0},p(p,y){const v={};y&32&&(v.data=p[5]),h.$set(v)},i(p){d||(Qe(h.$$.fragment,p),d=!0)},o(p){at(h.$$.fragment,p),d=!1},d(p){ir(h,p)}}}function I1(u){let h,d;return h=new Oh({props:{data:u[5].ni,zKey:"group"}}),{c(){er(h.$$.fragment)},l(p){tr(h.$$.fragment,p)},m(p,y){rr(h,p,y),d=!0},p(p,y){const v={};y&32&&(v.data=p[5].ni),h.$set(v)},i(p){d||(Qe(h.$$.fragment,p),d=!0)},o(p){at(h.$$.fragment,p),d=!1},d(p){ir(h,p)}}}function A1(u){let h,d;return h=new Oh({props:{data:u[5].prev,zKey:"group"}}),{c(){er(h.$$.fragment)},l(p){tr(h.$$.fragment,p)},m(p,y){rr(h,p,y),d=!0},p(p,y){const v={};y&32&&(v.data=p[5].prev),h.$set(v)},i(p){d||(Qe(h.$$.fragment,p),d=!0)},o(p){at(h.$$.fragment,p),d=!1},d(p){ir(h,p)}}}function P1(u){let h,d;return h=new Oh({props:{data:u[5].none,zKey:"group"}}),{c(){er(h.$$.fragment)},l(p){tr(h.$$.fragment,p)},m(p,y){rr(h,p,y),d=!0},p(p,y){const v={};y&32&&(v.data=p[5].none),h.$set(v)},i(p){d||(Qe(h.$$.fragment,p),d=!0)},o(p){at(h.$$.fragment,p),d=!1},d(p){ir(h,p)}}}function C1(u){let h,d;return h=new Bh({props:{data:u[5],zKey:u[6],label:u[7],topic_prev_available:u[0]}}),{c(){er(h.$$.fragment)},l(p){tr(h.$$.fragment,p)},m(p,y){rr(h,p,y),d=!0},p(p,y){const v={};y&32&&(v.data=p[5]),y&64&&(v.zKey=p[6]),y&128&&(v.label=p[7]),y&1&&(v.topic_prev_available=p[0]),h.$set(v)},i(p){d||(Qe(h.$$.fragment,p),d=!0)},o(p){at(h.$$.fragment,p),d=!1},d(p){ir(h,p)}}}function M1(u){let h,d;return h=new Bh({props:{data:u[5].ni,zKey:u[6],label:u[7],topic_prev_available:u[0]}}),{c(){er(h.$$.fragment)},l(p){tr(h.$$.fragment,p)},m(p,y){rr(h,p,y),d=!0},p(p,y){const v={};y&32&&(v.data=p[5].ni),y&64&&(v.zKey=p[6]),y&128&&(v.label=p[7]),y&1&&(v.topic_prev_available=p[0]),h.$set(v)},i(p){d||(Qe(h.$$.fragment,p),d=!0)},o(p){at(h.$$.fragment,p),d=!1},d(p){ir(h,p)}}}function D1(u){let h,d;return h=new Bh({props:{data:u[5].prev,zKey:u[6],label:u[7],topic_prev_available:u[0]}}),{c(){er(h.$$.fragment)},l(p){tr(h.$$.fragment,p)},m(p,y){rr(h,p,y),d=!0},p(p,y){const v={};y&32&&(v.data=p[5].prev),y&64&&(v.zKey=p[6]),y&128&&(v.label=p[7]),y&1&&(v.topic_prev_available=p[0]),h.$set(v)},i(p){d||(Qe(h.$$.fragment,p),d=!0)},o(p){at(h.$$.fragment,p),d=!1},d(p){ir(h,p)}}}function L1(u){let h,d;return h=new Bh({props:{data:u[5].none,zKey:u[6],label:u[7],topic_prev_available:u[0]}}),{c(){er(h.$$.fragment)},l(p){tr(h.$$.fragment,p)},m(p,y){rr(h,p,y),d=!0},p(p,y){const v={};y&32&&(v.data=p[5].none),y&64&&(v.zKey=p[6]),y&128&&(v.label=p[7]),y&1&&(v.topic_prev_available=p[0]),h.$set(v)},i(p){d||(Qe(h.$$.fragment,p),d=!0)},o(p){at(h.$$.fragment,p),d=!1},d(p){ir(h,p)}}}function Fm(u){let h=u[11][u[3].type].hasOwnProperty(u[10]),d,p=h&&Nm(u);return{c(){p&&p.c(),d=cr()},l(y){p&&p.l(y),d=cr()},m(y,v){p&&p.m(y,v),Le(y,d,v)},p(y,v){v&3080&&(h=y[11][y[3].type].hasOwnProperty(y[10])),h?p?p.p(y,v):(p=Nm(y),p.c(),p.m(d.parentNode,d)):p&&(p.d(1),p=null)},d(y){p&&p.d(y),y&&ae(d)}}}function Nm(u){let h,d,p,y=u[11][u[3].type][u[10]]+"";return{c(){h=Fe("br"),d=mt(),p=Fe("span"),this.h()},l(v){h=Ne(v,"BR",{}),d=yt(v),p=Ne(v,"SPAN",{class:!0});var a=Be(p);a.forEach(ae),this.h()},h(){oe(p,"class","text-small")},m(v,a){Le(v,h,a),Le(v,d,a),Le(v,p,a),p.innerHTML=y},p(v,a){a&3080&&y!==(y=v[11][v[3].type][v[10]]+"")&&(p.innerHTML=y)},d(v){v&&ae(h),v&&ae(d),v&&ae(p)}}}function R1(u){let h,d,p,y,v,a,T,E,M,F,R,D,H,ie,de,fe;const we=[s1,o1],xe=[];function st(Ue,ht){return Ue[8]?0:1}d=st(u),p=xe[d]=we[d](u);const $e=[d1,f1,p1,h1,c1,u1,l1],Me=[];function Je(Ue,ht){return ht&24&&(T=null),ht&24&&(E=null),ht&24&&(M=null),ht&24&&(F=null),ht&24&&(R=null),ht&24&&(D=null),T==null&&(T=!!(Ue[4]=="StackedBarChart"|Ue[4].hasOwnProperty(Ue[3].type)&Ue[4][Ue[3].type]=="StackedBarChart")),T?0:(E==null&&(E=!!(Ue[4]=="GroupChart"|Ue[4].hasOwnProperty(Ue[3].type)&Ue[4][Ue[3].type]=="GroupChart")),E?1:(M==null&&(M=!!(Ue[4]=="ProfileChart"|Ue[4].hasOwnProperty(Ue[3].type)&Ue[4][Ue[3].type]=="ProfileChart")),M?2:(F==null&&(F=!!(Ue[4]=="BarChart"|Ue[4].hasOwnProperty(Ue[3].type)&Ue[4][Ue[3].type]=="BarChart")),F?3:(R==null&&(R=!!(Ue[4]=="ColChart"|Ue[4].hasOwnProperty(Ue[3].type)&Ue[4][Ue[3].type]=="ColChart")),R?4:(D==null&&(D=!!Ue[4].hasOwnProperty(Ue[3].type)),D?5:6)))))}H=Je(u,-1),ie=Me[H]=$e[H](u);let ct=u[11]!=null&u[10]!=null&&Fm(u);return{c(){h=Fe("div"),p.c(),y=mt(),v=Fe("br"),a=mt(),ie.c(),de=mt(),ct&&ct.c(),this.h()},l(Ue){h=Ne(Ue,"DIV",{class:!0,style:!0});var ht=Be(h);p.l(ht),y=yt(ht),v=Ne(ht,"BR",{}),a=yt(ht),ie.l(ht),de=yt(ht),ct&&ct.l(ht),ht.forEach(ae),this.h()},h(){oe(h,"class","div-grey-box svelte-1mdbgz6"),oe(h,"style",u[2])},m(Ue,ht){Le(Ue,h,ht),xe[d].m(h,null),Te(h,y),Te(h,v),Te(h,a),Me[H].m(h,null),Te(h,de),ct&&ct.m(h,null),fe=!0},p(Ue,[ht]){let _t=d;d=st(Ue),d===_t?xe[d].p(Ue,ht):(An(),at(xe[_t],1,1,()=>{xe[_t]=null}),Pn(),p=xe[d],p?p.p(Ue,ht):(p=xe[d]=we[d](Ue),p.c()),Qe(p,1),p.m(h,y));let pt=H;H=Je(Ue,ht),H===pt?Me[H].p(Ue,ht):(An(),at(Me[pt],1,1,()=>{Me[pt]=null}),Pn(),ie=Me[H],ie?ie.p(Ue,ht):(ie=Me[H]=$e[H](Ue),ie.c()),Qe(ie,1),ie.m(h,de)),Ue[11]!=null&Ue[10]!=null?ct?ct.p(Ue,ht):(ct=Fm(Ue),ct.c(),ct.m(h,null)):ct&&(ct.d(1),ct=null),(!fe||ht&4)&&oe(h,"style",Ue[2])},i(Ue){fe||(Qe(p),Qe(ie),fe=!0)},o(Ue){at(p),at(ie),fe=!1},d(Ue){Ue&&ae(h),xe[d].d(),Me[H].d(),ct&&ct.d()}}}function B1(u,h,d){let{id:p}=h,{style:y=""}=h,{place:v}=h,{content:a}=h,{chart_data:T=null}=h,{zKey:E="ni"}=h,{label:M=null}=h,{topic_prev_available:F=null}=h,{topic_boolean:R=null}=h,{i_button:D=!0}=h,{heading:H=null}=h,{chart_compare_type:ie}=h,{compare_content:de=null}=h;return F=="false"?R=!1:R=!0,u.$$set=fe=>{"id"in fe&&d(1,p=fe.id),"style"in fe&&d(2,y=fe.style),"place"in fe&&d(3,v=fe.place),"content"in fe&&d(4,a=fe.content),"chart_data"in fe&&d(5,T=fe.chart_data),"zKey"in fe&&d(6,E=fe.zKey),"label"in fe&&d(7,M=fe.label),"topic_prev_available"in fe&&d(12,F=fe.topic_prev_available),"topic_boolean"in fe&&d(0,R=fe.topic_boolean),"i_button"in fe&&d(8,D=fe.i_button),"heading"in fe&&d(9,H=fe.heading),"chart_compare_type"in fe&&d(10,ie=fe.chart_compare_type),"compare_content"in fe&&d(11,de=fe.compare_content)},[R,p,y,v,a,T,E,M,D,H,ie,de,F]}class Ou extends mn{constructor(h){super(),yn(this,h,B1,R1,gn,{id:1,style:2,place:3,content:4,chart_data:5,zKey:6,label:7,topic_prev_available:12,topic_boolean:0,i_button:8,heading:9,chart_compare_type:10,compare_content:11})}}function Um(u,h,d){const p=u.slice();return p[13]=h[d],p[15]=d,p}function Vm(u){let h=u[6][u[10][u[15]]].show.includes(u[3].type),d,p,y=h&&jm(u);return{c(){y&&y.c(),d=cr()},l(v){y&&y.l(v),d=cr()},m(v,a){y&&y.m(v,a),Le(v,d,a),p=!0},p(v,a){a&72&&(h=v[6][v[10][v[15]]].show.includes(v[3].type)),h?y?(y.p(v,a),a&72&&Qe(y,1)):(y=jm(v),y.c(),Qe(y,1),y.m(d.parentNode,d)):y&&(An(),at(y,1,1,()=>{y=null}),Pn())},i(v){p||(Qe(y),p=!0)},o(v){at(y),p=!1},d(v){y&&y.d(v),v&&ae(d)}}}function jm(u){let h,d;return h=new Ou({props:{id:u[6][u[10][u[15]]].id,style:u[6][u[10][u[15]]].style,place:u[3],content:u[6][u[10][u[15]]].content,chart_data:u[6][u[10][u[15]]].chart_data,zKey:u[6][u[10][u[15]]].zKey,label:u[6][u[10][u[15]]].label,topic_prev_available:u[6][u[10][u[15]]].topic_prev_available,chart_compare_type:u[8]}}),{c(){er(h.$$.fragment)},l(p){tr(h.$$.fragment,p)},m(p,y){rr(h,p,y),d=!0},p(p,y){const v={};y&64&&(v.id=p[6][p[10][p[15]]].id),y&64&&(v.style=p[6][p[10][p[15]]].style),y&8&&(v.place=p[3]),y&64&&(v.content=p[6][p[10][p[15]]].content),y&64&&(v.chart_data=p[6][p[10][p[15]]].chart_data),y&64&&(v.zKey=p[6][p[10][p[15]]].zKey),y&64&&(v.label=p[6][p[10][p[15]]].label),y&64&&(v.topic_prev_available=p[6][p[10][p[15]]].topic_prev_available),y&256&&(v.chart_compare_type=p[8]),h.$set(v)},i(p){d||(Qe(h.$$.fragment,p),d=!0)},o(p){at(h.$$.fragment,p),d=!1},d(p){ir(h,p)}}}function qm(u){let h,d;return h=new Ou({props:{id:u[6][u[10][u[15]]].id,style:u[6][u[10][u[15]]].style,place:u[3],content:u[6][u[10][u[15]]].content,chart_data:u[6][u[10][u[15]]].chart_data,zKey:u[6][u[10][u[15]]].zKey,label:u[6][u[10][u[15]]].label,topic_prev_available:u[6][u[10][u[15]]].topic_prev_available,chart_compare_type:u[8]}}),{c(){er(h.$$.fragment)},l(p){tr(h.$$.fragment,p)},m(p,y){rr(h,p,y),d=!0},p(p,y){const v={};y&64&&(v.id=p[6][p[10][p[15]]].id),y&64&&(v.style=p[6][p[10][p[15]]].style),y&8&&(v.place=p[3]),y&64&&(v.content=p[6][p[10][p[15]]].content),y&64&&(v.chart_data=p[6][p[10][p[15]]].chart_data),y&64&&(v.zKey=p[6][p[10][p[15]]].zKey),y&64&&(v.label=p[6][p[10][p[15]]].label),y&64&&(v.topic_prev_available=p[6][p[10][p[15]]].topic_prev_available),y&256&&(v.chart_compare_type=p[8]),h.$set(v)},i(p){d||(Qe(h.$$.fragment,p),d=!0)},o(p){at(h.$$.fragment,p),d=!1},d(p){ir(h,p)}}}function Zm(u){let h=u[6][u[10][u[15]]].hasOwnProperty("show"),d,p=!u[6][u[10][u[15]]].hasOwnProperty("show"),y,v,a=h&&Vm(u),T=p&&qm(u);return{c(){a&&a.c(),d=mt(),T&&T.c(),y=cr()},l(E){a&&a.l(E),d=yt(E),T&&T.l(E),y=cr()},m(E,M){a&&a.m(E,M),Le(E,d,M),T&&T.m(E,M),Le(E,y,M),v=!0},p(E,M){M&64&&(h=E[6][E[10][E[15]]].hasOwnProperty("show")),h?a?(a.p(E,M),M&64&&Qe(a,1)):(a=Vm(E),a.c(),Qe(a,1),a.m(d.parentNode,d)):a&&(An(),at(a,1,1,()=>{a=null}),Pn()),M&64&&(p=!E[6][E[10][E[15]]].hasOwnProperty("show")),p?T?(T.p(E,M),M&64&&Qe(T,1)):(T=qm(E),T.c(),Qe(T,1),T.m(y.parentNode,y)):T&&(An(),at(T,1,1,()=>{T=null}),Pn())},i(E){v||(Qe(a),Qe(T),v=!0)},o(E){at(a),at(T),v=!1},d(E){a&&a.d(E),E&&ae(d),T&&T.d(E),E&&ae(y)}}}function Gm(u){let h,d,p,y;return{c(){h=Fe("h3"),d=Pt("More Statistics"),p=mt(),y=Fe("div"),this.h()},l(v){h=Ne(v,"H3",{});var a=Be(h);d=Ct(a,"More Statistics"),a.forEach(ae),p=yt(v),y=Ne(v,"DIV",{class:!0});var T=Be(y);T.forEach(ae),this.h()},h(){oe(y,"class","accordion-more svelte-1jaw0n6")},m(v,a){Le(v,h,a),Te(h,d),Le(v,p,a),Le(v,y,a),y.innerHTML=u[7]},p(v,a){a&128&&(y.innerHTML=v[7])},d(v){v&&ae(h),v&&ae(p),v&&ae(y)}}}function O1(u){let h,d,p,y,v,a,T,E,M,F,R,D,H,ie,de=u[3].name+"",fe,we,xe,st,$e,Me,Je,ct,Ue,ht,_t,pt,Nt,bt={length:u[10].length},zt=[];for(let gt=0;gt<bt.length;gt+=1)zt[gt]=Zm(Um(u,bt,gt));const rt=gt=>at(zt[gt],1,1,()=>{zt[gt]=null});let Zt=u[7]!=""&&Gm(u);return{c(){h=Fe("div"),d=Fe("h2"),p=Fe("button"),y=Fe("span"),v=Fe("img"),T=mt(),E=Pt(u[2]),D=mt(),H=Fe("div"),ie=Fe("div"),fe=Pt(de),we=Pt(" - "),xe=new Ol(!1),st=mt(),$e=Fe("span"),Me=Pt(u[5]),Je=mt(),ct=Fe("div");for(let gt=0;gt<zt.length;gt+=1)zt[gt].c();ht=mt(),Zt&&Zt.c(),this.h()},l(gt){h=Ne(gt,"DIV",{class:!0});var It=Be(h);d=Ne(It,"H2",{class:!0,id:!0});var jt=Be(d);p=Ne(jt,"BUTTON",{class:!0,type:!0,"data-bs-toggle":!0,"data-bs-target":!0,"aria-expanded":!0,"aria-controls":!0});var ei=Be(p);y=Ne(ei,"SPAN",{class:!0});var We=Be(y);v=Ne(We,"IMG",{src:!0,alt:!0,height:!0,class:!0}),T=yt(We),E=Ct(We,u[2]),We.forEach(ae),ei.forEach(ae),jt.forEach(ae),D=yt(It),H=Ne(It,"DIV",{id:!0,class:!0,"aria-labelledby":!0});var At=Be(H);ie=Ne(At,"DIV",{class:!0});var mr=Be(ie);fe=Ct(mr,de),we=Ct(mr," - "),xe=Fl(mr,!1),st=yt(mr),$e=Ne(mr,"SPAN",{class:!0});var Tr=Be($e);Me=Ct(Tr,u[5]),Tr.forEach(ae),Je=yt(mr),ct=Ne(mr,"DIV",{class:!0});var xr=Be(ct);for(let Zr=0;Zr<zt.length;Zr+=1)zt[Zr].l(xr);xr.forEach(ae),ht=yt(mr),Zt&&Zt.l(mr),mr.forEach(ae),At.forEach(ae),It.forEach(ae),this.h()},h(){xd(v.src,a=Na+"/img/"+u[1])||oe(v,"src",a),oe(v,"alt","logo"),oe(v,"height","40"),oe(v,"class","accordion-dept-logo"),oe(y,"class","accordion-button-title"),oe(p,"class","accordion-button collapsed"),oe(p,"type","button"),oe(p,"data-bs-toggle","collapse"),oe(p,"data-bs-target",M="#panelsStayOpen-collapse"+u[0]),oe(p,"aria-expanded","false"),oe(p,"aria-controls",F="panelsStayOpen-collapse"+u[0]),oe(d,"class","accordion-header"),oe(d,"id",R="panelsStayOpen-heading"+u[0]),xe.a=st,oe($e,"class","accordion-button-title-sub"),oe(ct,"class","grid mt svelte-1jaw0n6"),Ku(()=>u[11].call(ct)),oe(ie,"class","accordion-body"),oe(H,"id",_t="panelsStayOpen-collapse"+u[0]),oe(H,"class","accordion-collapse collapse"),oe(H,"aria-labelledby",pt="panelsStayOpen-heading"+u[0]),oe(h,"class","accordion-item")},m(gt,It){Le(gt,h,It),Te(h,d),Te(d,p),Te(p,y),Te(y,v),Te(y,T),Te(y,E),Te(h,D),Te(h,H),Te(H,ie),Te(ie,fe),Te(ie,we),xe.m(u[4],ie),Te(ie,st),Te(ie,$e),Te($e,Me),Te(ie,Je),Te(ie,ct);for(let jt=0;jt<zt.length;jt+=1)zt[jt]&&zt[jt].m(ct,null);Ue=Xu(ct,u[11].bind(ct)),Te(ie,ht),Zt&&Zt.m(ie,null),Nt=!0},p(gt,[It]){if((!Nt||It&2&&!xd(v.src,a=Na+"/img/"+gt[1]))&&oe(v,"src",a),(!Nt||It&4)&&Ar(E,gt[2]),(!Nt||It&1&&M!==(M="#panelsStayOpen-collapse"+gt[0]))&&oe(p,"data-bs-target",M),(!Nt||It&1&&F!==(F="panelsStayOpen-collapse"+gt[0]))&&oe(p,"aria-controls",F),(!Nt||It&1&&R!==(R="panelsStayOpen-heading"+gt[0]))&&oe(d,"id",R),(!Nt||It&8)&&de!==(de=gt[3].name+"")&&Ar(fe,de),(!Nt||It&16)&&xe.p(gt[4]),(!Nt||It&32)&&Ar(Me,gt[5]),It&1352){bt={length:gt[10].length};let jt;for(jt=0;jt<bt.length;jt+=1){const ei=Um(gt,bt,jt);zt[jt]?(zt[jt].p(ei,It),Qe(zt[jt],1)):(zt[jt]=Zm(ei),zt[jt].c(),Qe(zt[jt],1),zt[jt].m(ct,null))}for(An(),jt=bt.length;jt<zt.length;jt+=1)rt(jt);Pn()}gt[7]!=""?Zt?Zt.p(gt,It):(Zt=Gm(gt),Zt.c(),Zt.m(ie,null)):Zt&&(Zt.d(1),Zt=null),(!Nt||It&1&&_t!==(_t="panelsStayOpen-collapse"+gt[0]))&&oe(H,"id",_t),(!Nt||It&1&&pt!==(pt="panelsStayOpen-heading"+gt[0]))&&oe(H,"aria-labelledby",pt)},i(gt){if(!Nt){for(let It=0;It<bt.length;It+=1)Qe(zt[It]);Nt=!0}},o(gt){zt=zt.filter(Boolean);for(let It=0;It<zt.length;It+=1)at(zt[It]);Nt=!1},d(gt){gt&&ae(h),on(zt,gt),Ue(),Zt&&Zt.d()}}}function F1(u,h,d){let{id:p}=h,{img:y}=h,{heading:v}=h,{place:a}=h,{sub_heading:T}=h,{description:E}=h,{boxes:M}=h,{more:F}=h,{chart_compare_type:R}=h,D=Object.keys(M),H;function ie(){H=this.clientWidth,d(9,H)}return u.$$set=de=>{"id"in de&&d(0,p=de.id),"img"in de&&d(1,y=de.img),"heading"in de&&d(2,v=de.heading),"place"in de&&d(3,a=de.place),"sub_heading"in de&&d(4,T=de.sub_heading),"description"in de&&d(5,E=de.description),"boxes"in de&&d(6,M=de.boxes),"more"in de&&d(7,F=de.more),"chart_compare_type"in de&&d(8,R=de.chart_compare_type)},[p,y,v,a,T,E,M,F,R,H,D,ie]}class Dl extends mn{constructor(h){super(),yn(this,h,F1,O1,gn,{id:0,img:1,heading:2,place:3,sub_heading:4,description:5,boxes:6,more:7,chart_compare_type:8})}}function Km(u,h,d){const p=u.slice();return p[36]=h[d],p[38]=d,p}function Xm(u,h,d){const p=u.slice();return p[39]=h[d],p[38]=d,p}function Wm(u,h,d){const p=u.slice();return p[41]=h[d],p}function Hm(u,h,d){const p=u.slice();return p[39]=h[d],p[38]=d,p}function Jm(u){let h,d,p,y,v,a,T=" &gt; ",E,M,F,R,D,H=u[0].place.name+"",ie,de,fe,we,xe,st,$e,Me,Je,ct,Ue,ht,_t,pt,Nt,bt,zt,rt,Zt,gt,It,jt,ei,We,At,mr,Tr,xr,Zr,sr,ti,Wt,Gr,yr,Nr,qt,Lr,Kr,hr,Fi,Cr,bi,pi,Qi,Mi,fi,ri,sn,di,Ur,$i,On,Ni,Cn,en,Mn,Ui,_n,Vi,Fn,tn,ji,vn,ln;function un(q,_e){return q[0].place.type!="ni"?U1:N1}let bn=un(u),oi=bn(u);function Mr(q,_e){return q[0].place.type=="ni"?j1:V1}let L=Mr(u),N=L(u),V=u[0].place.type!="ni"&&Qm(u);Nt=new a_({props:{search_data:u[0].search_data,group:"typestr",search:!0}}),Nt.$on("select",u[14]),ti=new Ou({props:{id:"overview",i_button:!1,heading:"Overview",place:u[0].place,style:"line-height: 1.3;",content:{ni:"The population of "+u[0].place.name+" was "+u[0].place.data.population.value[2021].all.toLocaleString()+" at the time of the 2021 Census.",lgd:u[0].place.name+" is one of "+u[0].place.count.toLocaleString()+" "+In[u[0].place.type].pl+".",dea:u[0].place.name+" is one of "+u[0].place.count.toLocaleString()+" "+In[u[0].place.type].pl+" and covers "+u[0].place.dea_location_description+".",sdz:u[0].place.name+" is one of "+u[0].place.count.toLocaleString()+" "+In[u[0].place.type].pl,dz:u[0].place.name+" is one of "+u[0].place.count.toLocaleString()+" "+In[u[0].place.type].pl},chart_compare_type:u[9]}}),Gr=new Ou({props:{id:"pop",place:u[0].place,content:'<span class="text-big" style="font-size: 2.8em;">'+u[0].place.data.population.value[2021].all.toLocaleString()+"</span>",chart_compare_type:u[9],compare_content:{ni:{prev:'<span class="em '+ts(u[0].place.data.population.value.change.all)+'">'+rs(u[0].place.data.population.value.change.all,"%",1)+"</span> since 2011 Census"},lgd:{prev:'<span class="em '+ts(u[0].place.data.population.value.change.all)+'">'+rs(u[0].place.data.population.value.change.all,"%",1)+"</span> since 2011 Census",ni:'<span class = "em" style = "background-color: lightgrey">'+ns(u[0].place.data.population.value[2021].all/u[0].ni.data.population.value[2021].all)+"</span> of Northern Ireland population<br>The "+u[15](u[0].place.data.population.value_rank[2021].all)+" population of 11 Local Government Districts"},dea:{ni:'<span class = "em" style = "background-color: lightgrey">'+ns(u[0].place.data.population.value[2021].all/u[0].ni.data.population.value[2021].all)+"</span> of Northern Ireland population"},sdz:{prev:" nothing further",ni:" nothing further"},dz:{prev:" no comparisons",ni:" nothing further"}}}}),Nr=new Ou({props:{id:"popden",place:u[0].place,content:'<span class="text-big" style="font-size: 2.8em;">'+u[0].place.data.households.value[2021].all_households.toLocaleString()+"</span>",chart_compare_type:u[9],compare_content:{ni:{prev:'<span class="em '+ts(u[0].place.data.households.value.change.all_households)+'">'+rs(u[0].place.data.households.value.change.all_households,"%",1)+"</span> since 2011 Census"},lgd:{prev:'<span class="em '+ts(u[0].place.data.households.value.change.all_households)+'">'+rs(u[0].place.data.households.value.change.all_households,"%",1)+"</span> since 2011 Census",ni:'<span class = "em" style = "background-color: lightgrey">'+ns(u[0].place.data.households.value[2021].all_households/u[0].ni.data.households.value[2021].all_households)+"</span> of Northern Ireland households"},dea:{ni:'<span class = "em" style = "background-color: lightgrey">'+ns(u[0].place.data.households.value[2021].all_households/u[0].ni.data.households.value[2021].all_households)+"</span> of Northern Ireland households"},sdz:{prev:" nothing further",ni:" nothing further"},dz:{prev:" no comparisons",ni:"no ni comparisons"}}}});function W(q,_e){return q[0].place.type!="ni"?Z1:q1}let $=W(u),se=$(u);function he(q){u[29](q)}let j={location:{bounds:u[0].place.bounds},options:{fitBoundsOptions:{padding:20}},style:o_,$$slots:{default:[K1]},$$scope:{ctx:u}};u[5]!==void 0&&(j.map=u[5]),bi=new K_({props:j}),ju.push(()=>u_(bi,"map",he));let J=u[0].place.type!="ni"&&ey(u);function ge(q,_e){return q[0].place.children[0]?W1:X1}let Ce=ge(u),De=Ce(u);return $i=new Dl({props:{id:"people",img:"nisra-taxonomy-icon-census.png",heading:"People and Households",place:u[0].place,sub_heading:"There is more People and Households data available for <a href = '/"+u[0].place.parents[0].code+"/' data-sveltekit-noscroll>"+u[0].place.parents[0].name+" </a>",description:"",chart_compare_type:u[9],boxes:{box_1:{id:"popchange",content:"<span > population growth/shrink to be added</span> "},box_2:{id:"age",content:"GroupChart",chart_data:{none:u[12](u[0].place.grouped_data_nocompare.age,"age"),prev:u[12](u[0].place.grouped_data_timecompare.age,"age"),ni:u[12](u[0].place.grouped_data_areacompare.age,"age")},topic_prev_available:"true"},box_3:{id:"sex",content:"<span > sex split to be added</span>"},box_4:{id:"hhsize",content:"GroupChart",chart_data:{none:u[12](u[0].place.grouped_data_nocompare.hh_size,"hh_size"),prev:u[12](u[0].place.grouped_data_timecompare.hh_size,"hh_size"),ni:u[12](u[0].place.grouped_data_areacompare.hh_size,"hh_size")},topic_prev_available:"true"},box_5:{id:"religion",content:"GroupChart",chart_data:{none:u[12](u[0].place.grouped_data_nocompare.religion_or_religion_brought_up_in,"religion_or_religion_brought_up_in"),prev:u[12](u[0].place.grouped_data_timecompare.religion_or_religion_brought_up_in,"religion_or_religion_brought_up_in"),ni:u[12](u[0].place.grouped_data_areacompare.religion_or_religion_brought_up_in,"religion_or_religion_brought_up_in")},topic_prev_available:"true"},box_6:{id:"language",content:"GroupChart",chart_data:{none:u[12](u[0].place.grouped_data_nocompare.mainlang,"mainlang"),prev:u[12](u[0].place.grouped_data_timecompare.mainlang,"mainlang"),ni:u[12](u[0].place.grouped_data_areacompare.mainlang,"mainlang")},topic_prev_available:"true"}},more:`More information on the size of the population is available in the latest <a href='https://www.nisra.gov.uk/publications/2022-mid-year-population-estimates-northern-ireland'>mid-year estimates release</a>, \r
					which includes an <a href='https://www.nisra.gov.uk/system/files/statistics/MYE22-summary.pdf'>infographic</a>, \r
					<a href='https://www.nisra.gov.uk/system/files/statistics/MYE22-Factsheets.pdf'>Fact Sheets</a>, \r
					a <a href='https://www.nisra.gov.uk/system/files/statistics/Statistical%20Bulletin%20-%202022%20Mid-year%20Population%20Estimates%20for%20Northern%20Ireland.pdf'>publication</a> \r
					and statistical tables. Population characteristics are from the census data which can be explored further in the <a href='https://explore.nisra.gov.uk/area-explorer-2021/N92000002/'>Census Area Explorer</a>, \r
					bespoke tables can be created using the <a href='https://build.nisra.gov.uk/en/'>Flexible Table Builder</a> and the NISRA website has \r
					<a href='https://www.nisra.gov.uk/publications/census-2021-statistical-bulletins'>statistical bulletins</a> providing commentary on a range of census population characteristics.\r
					`}}),Ni=new Dl({props:{id:"health",img:"nisra-taxonomy-icon-health.png",heading:"Health and Social Care",place:u[0].place,sub_heading:"There is more Health and Social Care data available for <a href = '/"+u[0].place.parents[0].code+"/' data-sveltekit-noscroll>"+u[0].place.parents[0].name+" </a>",description:"xxxx",chart_compare_type:u[9],boxes:{box_1:{id:"generalhealth",content:{ni:"StackedBarChart",lgd:"StackedBarChart",dea:"StackedBarChart",sdz:"not available - needs missing 2011",dz:"not available - needs missing 2011"},chart_data:u[0].place&&u[11](["general_health"],["2011"],["2021"]),zKey:u[9],label:u[10],topic_prev_available:"true"},box_2:{id:"wellbeing",content:"<p><span class='text-big' style='font-size: 2.8em'>7.5</span> / 10 </p><p><span class='text-big' style='font-size: 2.8em'>"+u[16]("Happy.value").toLocaleString()+"</span> / 10 </p>",show:["ni","lgd"]},box_3:{id:"lifeexpectancy",content:"<p>Males <span class='text-big' style='font-size: 1.8em'>"+u[16]("LE.value.Males").toLocaleString()+"</span> years</p><p>Female <span class='text-big' style='font-size: 1.8em'>"+u[16]("LE.value.Females").toLocaleString()+"</span> years</p>",show:["ni","lgd"]},box_4:{id:"carers",content:"GroupChart",chart_data:{none:u[12](u[0].place.grouped_data_nocompare.provision_care,"provision_care"),prev:u[12](u[0].place.grouped_data_timecompare.provision_care,"provision_care"),ni:u[12](u[0].place.grouped_data_areacompare.provision_care,"provision_care")},label:u[10],topic_prev_available:"true"},box_5:{id:"hospitalactivity",content:"<p><span class='text-big' style='font-size: 1.8em'>"+u[16]("Admiss.value").toLocaleString()+"</span> hospital admissions.  The most frequent reason was xxx</p>",show:["ni","dea"]},box_6:{id:"primarycare",content:"<p><span class='text-big' style='font-size: 1.2em'>"+u[16]("GP.value.PRACS").toLocaleString()+"</span> practices, <span class='text-big' style='font-size: 1.2em'>"+u[16]("GP.value.GPS").toLocaleString()+"</span> GPs, and <span class='text-big' style='font-size: 1.2em'>"+u[16]("GP.value.PRACLIST").toLocaleString()+"</span> patients per practice<span class='text-big' style='font-size: 1.2em'></p><p>"+u[16]("DEN.value.GDSDSSurgeries").toLocaleString()+"</span> dental surgeries, <span class='text-big' style='font-size: 1.2em'>"+u[16]("DEN.value.GDSDSDentists").toLocaleString()+"</span> dentists and <span class='text-big' style='font-size: 1.2em'>"+u[16]("DEN_REG.value.Dental_Registrations").toLocaleString()+"</span> patients registered in total</p>",show:["ni","lgd"]},box_7:{id:"primarycare",content:"<p><span class='text-big' style='font-size: 1.2em'>"+u[16]("DEN.value.GDSDSSurgeries").toLocaleString()+"</span> dental surgeries, <span class='text-big' style='font-size: 1.2em'>"+u[16]("DEN.value.GDSDSDentists").toLocaleString()+"</span> dentists and <span class='text-big' style='font-size: 1.2em'>"+u[16]("DEN_REG.value.Dental_Registrations").toLocaleString()+"</span> patients registered in total</p>",show:["dea"]}},more:`<p>Significant volumes of information are prepared by the <a href='https://www.health-ni.gov.uk/topics/doh-statistics-and-research'>Department of Health</a> \r
			and the <a href='https://bso.hscni.net/directorates/operations/family-practitioner-services/directorates-operations-family-practitioner-services-information-unit/general-ophthalmic-services-statistics/'>\r
				Business Services Organisation</a>, including statistics on <a href='https://www.health-ni.gov.uk/topics/dhssps-statistics-and-research/health-inequalities-statistics'>Health inequalities</a>, \r
				Primary care (including <a href='https://bso.hscni.net/directorates/operations/family-practitioner-services/directorates-operations-family-practitioner-services-information-unit/1776-2/'>Medical</a>, \r
				<a href='https://bso.hscni.net/directorates/operations/family-practitioner-services/directorates-operations-family-practitioner-services-information-unit/general-dental-services-statistics/'>Dental</a>, \r
				<a href='https://bso.hscni.net/directorates/operations/family-practitioner-services/directorates-operations-family-practitioner-services-information-unit/general-pharmaceutical-services-and-prescribing-statistics/'>\r
				Pharmaceutical</a> and <a href='https://bso.hscni.net/directorates/operations/family-practitioner-services/directorates-operations-family-practitioner-services-information-unit/general-ophthalmic-services-statistics/'>\r
				Ophthalmic</a>), <a href='https://www.health-ni.gov.uk/topics/dhssps-statistics-and-research/family-health-services-statistics'>\r
				Family health services</a>, <a href='https://www.health-ni.gov.uk/topics/doh-statistics-and-research-mental-health-and-learning-disabilities/mental-health-learning-disability-and-autism-statistics'>\r
				Mental health, learning disability and autism</a>, <a href='https://www.health-ni.gov.uk/topics/dhssps-statistics-and-research-social-services/social-care-statistics'>\r
				Social care</a>, <a href='https://www.health-ni.gov.uk/topics/dhssps-statistics-and-research/workforce-statistics'>Workforce</a>, and <u>COVID-19</u>.\r
				A number of <a href='https://visual.nisra.gov.uk/?body=entity/health'>interactive dashboards</a> are available and a compendium dashboard for <a href='https://visual.nisra.gov.uk/?body=entity/las'>\r
				Making Life Better</a>.\r
				The <a href='https://www.nisra.gov.uk/statistics/census'>2021 census</a> collected data on general health, long-term conditions and carers which can \r
				be explored in the <a href='https://explore.nisra.gov.uk/area-explorer-2021/N92000002/'>Census Area Explorer</a> and the <a href='https://build.nisra.gov.uk/en/'>Flexible Table Builder</a>.</p><p></p>`}}),en=new Dl({props:{id:"work",img:"nisra-taxonomy-icon-labour-market.png",heading:"Work and Welfare",place:u[0].place,sub_heading:"There is more Work and Welfare data available for <a href = '/"+u[0].place.parents[0].code+"/' data-sveltekit-noscroll>"+u[0].place.parents[0].name+" </a>",description:"xxxx",chart_compare_type:u[9],boxes:{box_1:{id:"employmentrates",content:"<p><span class='text-big' style='font-size: 1.8em'>"+u[16]("LMS.value.EMPR").toLocaleString()+"</span> employment rate</p><p><span class='text-big' style='font-size: 1.8em'>"+u[16]("LMS.value.UNEMPR").toLocaleString()+"</span> unemployment rate</p><p><span class='text-big' style='font-size: 1.8em'>"+u[16]("LMS.value.INACTR").toLocaleString()+"</span> inactivity rate</p>",show:["ni","lgd"]},box_2:{id:"employed",content:"<p><span class='text-big' style='font-size: 1.8em'>"+u[16]("LMS.value.EMPN").toLocaleString()+"</span> employed</p>",show:["ni","lgd"]},box_3:{id:"wages",content:'<p><span class="text-big" style="font-size: 1.8em">'+u[16]("ASHE.value").toLocaleString()+"</span> annual median salary</p>",show:["ni","lgd"]},box_4:{id:"disabilitybenefits",content:'<span class="text-big">'+(u[0].place.data.BS.value.PIP+u[0].place.data.BS.value.DLA+u[0].place.data.BS.value.CA+u[0].place.data.BS.value.AA).toLocaleString()+"</span> claimants"},box_5:{id:"workingagebenefits",content:'<span class="text-big">'+(u[0].place.data.BS.value.UC+u[0].place.data.BS.value.JSA+u[0].place.data.BS.value.IS+u[0].place.data.BS.value.ESA).toLocaleString()+"</span> claimants"},box_6:{id:"pensionagebenefits",content:'<span class="text-big">'+(u[0].place.data.BS.value.RP+u[0].place.data.BS.value.PC).toLocaleString()+"</span> claimants"}},more:`<p>The monthly <a href='https://www.nisra.gov.uk/statistics/labour-market-and-social-welfare/labour-market-overview'>Labour Market Report</a>\r
			contains the most up to date labour market statistics. The <a href='https://www.nisra.gov.uk/statistics/labour-market-and-social-welfare/annual-survey-hours-and-earnings'>\r
				Annual Survey of Hours and Earnings</a> providesdata on hourly, weekly and annual earnings. The <a href='https://www.nisra.gov.uk/statistics/labour-market-and-social-welfare/quarterly-employment-survey'>\r
					Quarterly Employment Survey</a> provides short-term employee jobs estimates for NI. Further information is available for the \r
					unemployed <a href='https://www.nisra.gov.uk/statistics/labour-market-and-social-welfare/claimant-count'>Claimant Count</a>, \r
					claimant numbers for <a href='https://www.nisra.gov.uk/statistics/labour-market-and-social-welfare/disability-benefits'>Disability Benefits</a>, \r
					and <a href='https://www.nisra.gov.uk/statistics/labour-market-and-social-welfare/work-related-benefits'>Work Related Benefits</a>. \r
					Statistics on <a href='https://www.nisra.gov.uk/statistics/labour-market-and-social-welfare/redundancies'>Redundancies</a> \r
					and <a href='https://www.nisra.gov.uk/statistics/labour-market-and-social-welfare/job-vacancies'>Job Vacancies</a> are also available. \r
					A number of <a href='https://visual.nisra.gov.uk/?body=entity/lm'>interactive dashboards</a> are available. \r
					The <a href='https://www.nisra.gov.uk/statistics/census'>2021 census</a> collected data on occupations, industry and number of hours worked which can be \r
					explored in the <a href='https://explore.nisra.gov.uk/area-explorer-2021/N92000002/'>Census Area Explorer</a> and the <a href='https://build.nisra.gov.uk/en/'>Flexible Table Builder</a>.</p>`}}),Ui=new Dl({props:{id:"education",img:"nisra-taxonomy-icon-child-education-skills.png",heading:"Education",place:u[0].place,sub_heading:"There is more Schools, colleges and universities data available for <a href = '/"+u[0].place.parents[0].code+"/' data-sveltekit-noscroll>"+u[0].place.parents[0].name+" </a>",description:"",chart_compare_type:u[9],boxes:{box_1:{id:"enrollments",content:"<p>Primary school <span class='text-big' style='font-size: 1.2em'>500 </span></p><p>Secondary school <span class='text-big' style='font-size: 1.2em'>320 </span></p><p>Further education colleges <span class='text-big' style='font-size: 1.2em'>45 </span></p><p>University <span class='text-big' style='font-size: 1.2em'>200 </span></p>",show:["ni","lgd","dea"]},box_2:{id:"fsme",content:"<p>Primary school <span class='text-big' style='font-size: 1.8em'>33.2%</span></p><p>Secondary school <span class='text-big' style='font-size: 1.8em'>25.2%</span></p>",show:["ni","lgd","dea"]},box_3:{id:"teachers",content:"<p><span class='text-big' style='font-size: 1.8em'>"+u[16]("ClassSize.value").toLocaleString()+"</span> pupils per teacher</p>",show:["ni","lgd"]},box_4:{id:"qualifications",content:"GroupChart",chart_data:{none:u[12](u[0].place.grouped_data_nocompare.highest_level_of_qualifications,"highest_level_of_qualifications"),prev:u[12](u[0].place.grouped_data_timecompare.highest_level_of_qualifications,"highest_level_of_qualifications"),ni:u[12](u[0].place.grouped_data_areacompare.highest_level_of_qualifications,"highest_level_of_qualifications")},topic_prev_available:"true"},box_5:{id:"attainment",content:"<span > attainment to be added</span>",show:["ni","lgd"]}},more:"<p>The <a href='https://www.nisra.gov.uk/statistics/children-education-and-skills/school-education-statistics'>Department of Education</a> publishes statistics on <a href='https://www.education-ni.gov.uk/articles/school-enrolments-overview'>school enrolments</a>, <a href='https://www.education-ni.gov.uk/articles/school-performance'>school performance</a>, <a href='https://www.education-ni.gov.uk/articles/school-leavers'>school leavers</a>, qualifications and destinations, <a href='https://www.education-ni.gov.uk/articles/pupil-attendance'>pupil attendance</a>, suspensions and expulsions, school meals and <a href='https://www.education-ni.gov.uk/articles/education-workforce'>education workforce</a>. The <a href='https://www.nisra.gov.uk/statistics/children-education-and-skills/higher-and-further-education-and-training-statistics'>Department for the Economy</a> publishes <a href='https://www.economy-ni.gov.uk/topics/statistics-and-economic-research/higher-education-statistics-and-research'>Higher</a> and <a href='https://www.economy-ni.gov.uk/topics/statistics-and-economic-research/further-education-statistics-and-research'>Further</a> education and <a href='https://www.economy-ni.gov.uk/articles/training-success-statistics'>training</a> statistics. The <a href='https://www.nisra.gov.uk/statistics/census'>2021 census</a> collected data on qualifications which can be explored in the <a href='https://explore.nisra.gov.uk/area-explorer-2021/N92000002/'>Census Area Explorer</a> and the <a href='https://build.nisra.gov.uk/en/'>Flexible Table Builder</a>.</p>"}}),Vi=new Dl({props:{id:"crime",img:"nisra-taxonomy-icon-crime-justice.png",heading:"Crime and Justice",place:u[0].place,sub_heading:"Crime and court activity",description:"xxxx",chart_compare_type:u[9],boxes:{},more:""}}),tn=new Dl({props:{id:"travel",img:"nisra-taxonomy-icon-travel-transport.png",heading:"Travel and Transport",place:u[0].place,sub_heading:"Travel and transport .... ",description:"xxxx",chart_compare_type:u[9],boxes:{},more:""}}),{c(){h=Fe("div"),d=Fe("div"),p=Fe("span"),y=Fe("a"),v=Pt("Home"),a=new Ol(!1),E=mt(),oi.c(),M=mt(),F=Fe("br"),R=mt(),D=Fe("span"),ie=Pt(H),de=mt(),fe=Fe("div"),we=Pt(`Click for:\r
\r
					`),N.c(),xe=mt(),V&&V.c(),st=mt(),$e=Fe("button"),Me=Pt("Same area - previous"),Je=mt(),ct=Fe("div"),Ue=Fe("div"),ht=Fe("b"),_t=Pt("Search for your area:"),pt=mt(),er(Nt.$$.fragment),bt=mt(),zt=Fe("script"),rt=Pt(`// Share button\r
						// Possible tooltip: https://stackoverflow.com/questions/37798967/tooltip-on-click-of-a-button\r
\r
						function copyToClipboard(text) {\r
							var inputc = document.body.appendChild(\r
								document.createElement("input"),\r
							);\r
							inputc.value = window.location.href;\r
							inputc.select();\r
							document.execCommand("copy");\r
							inputc.parentNode.removeChild(inputc);\r
							alert("URL Copied.");\r
						}\r
\r
						(function (win, doc) {\r
							const testButton = doc.createElement("button");\r
							testButton.setAttribute("type", "share");\r
							if (testButton.type != "share") {\r
								win.addEventListener("click", function (ev) {\r
									ev = ev || win.event;\r
									let target = ev.target;\r
									let button = target.closest(\r
										'button[type="share"]',\r
									);\r
									if (button) {\r
										const title = "Share URL";\r
										const url = win.location.href;\r
										if (navigator.share) {\r
											navigator.share({\r
												title: title,\r
												url: url,\r
											});\r
										} else {\r
											copyToClipboard();\r
										}\r
									}\r
								});\r
							}\r
						})(this, this.document);`),Zt=mt(),gt=Fe("div"),It=Fe("button"),jt=Pt("About"),ei=mt(),We=Fe("button"),At=Pt("Print / PDF"),mr=mt(),Tr=Fe("button"),xr=Pt("Share"),Zr=mt(),sr=Fe("div"),er(ti.$$.fragment),Wt=mt(),er(Gr.$$.fragment),yr=mt(),er(Nr.$$.fragment),qt=mt(),Lr=Fe("div"),Kr=Fe("div"),hr=Fe("h3"),se.c(),Fi=mt(),Cr=Fe("div"),er(bi.$$.fragment),Qi=mt(),Mi=Fe("div"),J&&J.c(),fi=mt(),ri=Fe("div"),De.c(),di=mt(),Ur=Fe("div"),er($i.$$.fragment),On=mt(),er(Ni.$$.fragment),Cn=mt(),er(en.$$.fragment),Mn=mt(),er(Ui.$$.fragment),_n=mt(),er(Vi.$$.fragment),Fn=mt(),er(tn.$$.fragment),this.h()},l(q){h=Ne(q,"DIV",{class:!0});var _e=Be(h);d=Ne(_e,"DIV",{});var tt=Be(d);p=Ne(tt,"SPAN",{class:!0});var He=Be(p);y=Ne(He,"A",{href:!0,"data-sveltekit-noscroll":!0,class:!0});var ke=Be(y);v=Ct(ke,"Home"),ke.forEach(ae),a=Fl(He,!1),E=yt(He),oi.l(He),M=yt(He),He.forEach(ae),F=Ne(tt,"BR",{}),R=yt(tt),D=Ne(tt,"SPAN",{class:!0});var Xe=Be(D);ie=Ct(Xe,H),Xe.forEach(ae),de=yt(tt),fe=Ne(tt,"DIV",{class:!0,style:!0});var Oe=Be(fe);we=Ct(Oe,`Click for:\r
\r
					`),N.l(Oe),xe=yt(Oe),V&&V.l(Oe),st=yt(Oe),$e=Ne(Oe,"BUTTON",{class:!0});var qe=Be($e);Me=Ct(qe,"Same area - previous"),qe.forEach(ae),Oe.forEach(ae),tt.forEach(ae),Je=yt(_e),ct=Ne(_e,"DIV",{});var Mt=Be(ct);Ue=Ne(Mt,"DIV",{style:!0,class:!0});var je=Be(Ue);ht=Ne(je,"B",{});var Vt=Be(ht);_t=Ct(Vt,"Search for your area:"),Vt.forEach(ae),pt=yt(je),tr(Nt.$$.fragment,je),bt=yt(je),zt=Ne(je,"SCRIPT",{});var lr=Be(zt);rt=Ct(lr,`// Share button\r
						// Possible tooltip: https://stackoverflow.com/questions/37798967/tooltip-on-click-of-a-button\r
\r
						function copyToClipboard(text) {\r
							var inputc = document.body.appendChild(\r
								document.createElement("input"),\r
							);\r
							inputc.value = window.location.href;\r
							inputc.select();\r
							document.execCommand("copy");\r
							inputc.parentNode.removeChild(inputc);\r
							alert("URL Copied.");\r
						}\r
\r
						(function (win, doc) {\r
							const testButton = doc.createElement("button");\r
							testButton.setAttribute("type", "share");\r
							if (testButton.type != "share") {\r
								win.addEventListener("click", function (ev) {\r
									ev = ev || win.event;\r
									let target = ev.target;\r
									let button = target.closest(\r
										'button[type="share"]',\r
									);\r
									if (button) {\r
										const title = "Share URL";\r
										const url = win.location.href;\r
										if (navigator.share) {\r
											navigator.share({\r
												title: title,\r
												url: url,\r
											});\r
										} else {\r
											copyToClipboard();\r
										}\r
									}\r
								});\r
							}\r
						})(this, this.document);`),lr.forEach(ae),Zt=yt(je),gt=Ne(je,"DIV",{width:!0});var Dt=Be(gt);It=Ne(Dt,"BUTTON",{class:!0,style:!0,alt:!0,onclick:!0});var nr=Be(It);jt=Ct(nr,"About"),nr.forEach(ae),ei=yt(Dt),We=Ne(Dt,"BUTTON",{class:!0,style:!0,title:!0,onclick:!0});var Jt=Be(We);At=Ct(Jt,"Print / PDF"),Jt.forEach(ae),mr=yt(Dt),Tr=Ne(Dt,"BUTTON",{class:!0,style:!0,type:!0,alt:!0});var ii=Be(Tr);xr=Ct(ii,"Share"),ii.forEach(ae),Dt.forEach(ae),je.forEach(ae),Mt.forEach(ae),_e.forEach(ae),Zr=yt(q),sr=Ne(q,"DIV",{id:!0,class:!0});var $t=Be(sr);tr(ti.$$.fragment,$t),Wt=yt($t),tr(Gr.$$.fragment,$t),yr=yt($t),tr(Nr.$$.fragment,$t),$t.forEach(ae),qt=yt(q),Lr=Ne(q,"DIV",{class:!0});var br=Be(Lr);Kr=Ne(br,"DIV",{style:!0});var fr=Be(Kr);hr=Ne(fr,"H3",{class:!0});var Gt=Be(hr);se.l(Gt),Gt.forEach(ae),fr.forEach(ae),Fi=yt(br),Cr=Ne(br,"DIV",{id:!0,style:!0,class:!0});var ar=Be(Cr);tr(bi.$$.fragment,ar),ar.forEach(ae),Qi=yt(br),Mi=Ne(br,"DIV",{});var si=Be(Mi);J&&J.l(si),si.forEach(ae),fi=yt(br),ri=Ne(br,"DIV",{});var Nn=Be(ri);De.l(Nn),Nn.forEach(ae),br.forEach(ae),di=yt(q),Ur=Ne(q,"DIV",{class:!0,id:!0});var wr=Be(Ur);tr($i.$$.fragment,wr),On=yt(wr),tr(Ni.$$.fragment,wr),Cn=yt(wr),tr(en.$$.fragment,wr),Mn=yt(wr),tr(Ui.$$.fragment,wr),_n=yt(wr),tr(Vi.$$.fragment,wr),Fn=yt(wr),tr(tn.$$.fragment,wr),wr.forEach(ae),this.h()},h(){oe(y,"href",Na+"/"),oe(y,"data-sveltekit-noscroll",""),oe(y,"class","svelte-hmrro5"),a.a=E,oe(p,"class","text-small"),oe(D,"class","text-big title svelte-hmrro5"),oe($e,"class","btn svelte-hmrro5"),Jn($e,"btn-active",u[2]&!u[3]&!u[8]),oe(fe,"class","text-bold"),Ge(fe,"font-size","0.85em"),oe(It,"class","btn svelte-hmrro5"),Ge(It,"width","33%"),oe(It,"alt","Return to the landing page"),oe(It,"onclick","window.location.href='/about';"),oe(We,"class","btn svelte-hmrro5"),Ge(We,"width","33%"),oe(We,"title","Click to print this page to pdf or printer"),oe(We,"onclick","window.print();return false;"),oe(Tr,"class","btn svelte-hmrro5"),Ge(Tr,"width","30%"),oe(Tr,"type","share"),oe(Tr,"alt","Share this page"),oe(gt,"width","100%"),Ge(Ue,"width","350px"),Ge(Ue,"padding-top","5px"),oe(Ue,"class","svelte-hmrro5"),Jn(Ue,"float-right",u[4]>1),oe(h,"class","grid mtl svelte-hmrro5"),oe(sr,"id","grid"),oe(sr,"class","grid mt svelte-hmrro5"),oe(hr,"class","svelte-hmrro5"),Ge(Kr,"grid-column","span "+u[4]),oe(Cr,"id","map"),Ge(Cr,"padding-right","45px"),Ge(Cr,"grid-column","span "+(u[4]==2?2:u[4]&&u[4]>2?u[4]-1:1)),oe(Cr,"class","svelte-hmrro5"),oe(Lr,"class","grid mt svelte-hmrro5"),Ku(()=>u[30].call(Lr)),oe(Ur,"class","accordion"),oe(Ur,"id","accordionPanelsStayOpenExample")},m(q,_e){Le(q,h,_e),Te(h,d),Te(d,p),Te(p,y),Te(y,v),a.m(T,p),Te(p,E),oi.m(p,null),Te(p,M),Te(d,F),Te(d,R),Te(d,D),Te(D,ie),Te(d,de),Te(d,fe),Te(fe,we),N.m(fe,null),Te(fe,xe),V&&V.m(fe,null),Te(fe,st),Te(fe,$e),Te($e,Me),Te(h,Je),Te(h,ct),Te(ct,Ue),Te(Ue,ht),Te(ht,_t),Te(Ue,pt),rr(Nt,Ue,null),Te(Ue,bt),Te(Ue,zt),Te(zt,rt),Te(Ue,Zt),Te(Ue,gt),Te(gt,It),Te(It,jt),Te(gt,ei),Te(gt,We),Te(We,At),Te(gt,mr),Te(gt,Tr),Te(Tr,xr),Le(q,Zr,_e),Le(q,sr,_e),rr(ti,sr,null),Te(sr,Wt),rr(Gr,sr,null),Te(sr,yr),rr(Nr,sr,null),Le(q,qt,_e),Le(q,Lr,_e),Te(Lr,Kr),Te(Kr,hr),se.m(hr,null),Te(Lr,Fi),Te(Lr,Cr),rr(bi,Cr,null),Te(Lr,Qi),Te(Lr,Mi),J&&J.m(Mi,null),Te(Lr,fi),Te(Lr,ri),De.m(ri,null),sn=Xu(Lr,u[30].bind(Lr)),Le(q,di,_e),Le(q,Ur,_e),rr($i,Ur,null),Te(Ur,On),rr(Ni,Ur,null),Te(Ur,Cn),rr(en,Ur,null),Te(Ur,Mn),rr(Ui,Ur,null),Te(Ur,_n),rr(Vi,Ur,null),Te(Ur,Fn),rr(tn,Ur,null),ji=!0,vn||(ln=[pa($e,"click",u[26]),pa($e,"click",u[27]),pa($e,"click",u[28])],vn=!0)},p(q,_e){bn===(bn=un(q))&&oi?oi.p(q,_e):(oi.d(1),oi=bn(q),oi&&(oi.c(),oi.m(p,M))),(!ji||_e[0]&1)&&H!==(H=q[0].place.name+"")&&Ar(ie,H),L===(L=Mr(q))&&N?N.p(q,_e):(N.d(1),N=L(q),N&&(N.c(),N.m(fe,xe))),q[0].place.type!="ni"?V?V.p(q,_e):(V=Qm(q),V.c(),V.m(fe,st)):V&&(V.d(1),V=null),(!ji||_e[0]&268)&&Jn($e,"btn-active",q[2]&!q[3]&!q[8]);const tt={};_e[0]&1&&(tt.search_data=q[0].search_data),Nt.$set(tt),(!ji||_e[0]&16)&&Jn(Ue,"float-right",q[4]>1);const He={};_e[0]&1&&(He.place=q[0].place),_e[0]&1&&(He.content={ni:"The population of "+q[0].place.name+" was "+q[0].place.data.population.value[2021].all.toLocaleString()+" at the time of the 2021 Census.",lgd:q[0].place.name+" is one of "+q[0].place.count.toLocaleString()+" "+In[q[0].place.type].pl+".",dea:q[0].place.name+" is one of "+q[0].place.count.toLocaleString()+" "+In[q[0].place.type].pl+" and covers "+q[0].place.dea_location_description+".",sdz:q[0].place.name+" is one of "+q[0].place.count.toLocaleString()+" "+In[q[0].place.type].pl,dz:q[0].place.name+" is one of "+q[0].place.count.toLocaleString()+" "+In[q[0].place.type].pl}),_e[0]&512&&(He.chart_compare_type=q[9]),ti.$set(He);const ke={};_e[0]&1&&(ke.place=q[0].place),_e[0]&1&&(ke.content='<span class="text-big" style="font-size: 2.8em;">'+q[0].place.data.population.value[2021].all.toLocaleString()+"</span>"),_e[0]&512&&(ke.chart_compare_type=q[9]),_e[0]&1&&(ke.compare_content={ni:{prev:'<span class="em '+ts(q[0].place.data.population.value.change.all)+'">'+rs(q[0].place.data.population.value.change.all,"%",1)+"</span> since 2011 Census"},lgd:{prev:'<span class="em '+ts(q[0].place.data.population.value.change.all)+'">'+rs(q[0].place.data.population.value.change.all,"%",1)+"</span> since 2011 Census",ni:'<span class = "em" style = "background-color: lightgrey">'+ns(q[0].place.data.population.value[2021].all/q[0].ni.data.population.value[2021].all)+"</span> of Northern Ireland population<br>The "+q[15](q[0].place.data.population.value_rank[2021].all)+" population of 11 Local Government Districts"},dea:{ni:'<span class = "em" style = "background-color: lightgrey">'+ns(q[0].place.data.population.value[2021].all/q[0].ni.data.population.value[2021].all)+"</span> of Northern Ireland population"},sdz:{prev:" nothing further",ni:" nothing further"},dz:{prev:" no comparisons",ni:" nothing further"}}),Gr.$set(ke);const Xe={};_e[0]&1&&(Xe.place=q[0].place),_e[0]&1&&(Xe.content='<span class="text-big" style="font-size: 2.8em;">'+q[0].place.data.households.value[2021].all_households.toLocaleString()+"</span>"),_e[0]&512&&(Xe.chart_compare_type=q[9]),_e[0]&1&&(Xe.compare_content={ni:{prev:'<span class="em '+ts(q[0].place.data.households.value.change.all_households)+'">'+rs(q[0].place.data.households.value.change.all_households,"%",1)+"</span> since 2011 Census"},lgd:{prev:'<span class="em '+ts(q[0].place.data.households.value.change.all_households)+'">'+rs(q[0].place.data.households.value.change.all_households,"%",1)+"</span> since 2011 Census",ni:'<span class = "em" style = "background-color: lightgrey">'+ns(q[0].place.data.households.value[2021].all_households/q[0].ni.data.households.value[2021].all_households)+"</span> of Northern Ireland households"},dea:{ni:'<span class = "em" style = "background-color: lightgrey">'+ns(q[0].place.data.households.value[2021].all_households/q[0].ni.data.households.value[2021].all_households)+"</span> of Northern Ireland households"},sdz:{prev:" nothing further",ni:" nothing further"},dz:{prev:" no comparisons",ni:"no ni comparisons"}}),Nr.$set(Xe),$===($=W(q))&&se?se.p(q,_e):(se.d(1),se=$(q),se&&(se.c(),se.m(hr,null))),(!ji||_e[0]&16)&&Ge(Kr,"grid-column","span "+q[4]);const Oe={};_e[0]&1&&(Oe.location={bounds:q[0].place.bounds}),_e[0]&192|_e[1]&16384&&(Oe.$$scope={dirty:_e,ctx:q}),!pi&&_e[0]&32&&(pi=!0,Oe.map=q[5],c_(()=>pi=!1)),bi.$set(Oe),(!ji||_e[0]&16)&&Ge(Cr,"grid-column","span "+(q[4]==2?2:q[4]&&q[4]>2?q[4]-1:1)),q[0].place.type!="ni"?J?J.p(q,_e):(J=ey(q),J.c(),J.m(Mi,null)):J&&(J.d(1),J=null),Ce===(Ce=ge(q))&&De?De.p(q,_e):(De.d(1),De=Ce(q),De&&(De.c(),De.m(ri,null)));const qe={};_e[0]&1&&(qe.place=q[0].place),_e[0]&1&&(qe.sub_heading="There is more People and Households data available for <a href = '/"+q[0].place.parents[0].code+"/' data-sveltekit-noscroll>"+q[0].place.parents[0].name+" </a>"),_e[0]&512&&(qe.chart_compare_type=q[9]),_e[0]&1&&(qe.boxes={box_1:{id:"popchange",content:"<span > population growth/shrink to be added</span> "},box_2:{id:"age",content:"GroupChart",chart_data:{none:q[12](q[0].place.grouped_data_nocompare.age,"age"),prev:q[12](q[0].place.grouped_data_timecompare.age,"age"),ni:q[12](q[0].place.grouped_data_areacompare.age,"age")},topic_prev_available:"true"},box_3:{id:"sex",content:"<span > sex split to be added</span>"},box_4:{id:"hhsize",content:"GroupChart",chart_data:{none:q[12](q[0].place.grouped_data_nocompare.hh_size,"hh_size"),prev:q[12](q[0].place.grouped_data_timecompare.hh_size,"hh_size"),ni:q[12](q[0].place.grouped_data_areacompare.hh_size,"hh_size")},topic_prev_available:"true"},box_5:{id:"religion",content:"GroupChart",chart_data:{none:q[12](q[0].place.grouped_data_nocompare.religion_or_religion_brought_up_in,"religion_or_religion_brought_up_in"),prev:q[12](q[0].place.grouped_data_timecompare.religion_or_religion_brought_up_in,"religion_or_religion_brought_up_in"),ni:q[12](q[0].place.grouped_data_areacompare.religion_or_religion_brought_up_in,"religion_or_religion_brought_up_in")},topic_prev_available:"true"},box_6:{id:"language",content:"GroupChart",chart_data:{none:q[12](q[0].place.grouped_data_nocompare.mainlang,"mainlang"),prev:q[12](q[0].place.grouped_data_timecompare.mainlang,"mainlang"),ni:q[12](q[0].place.grouped_data_areacompare.mainlang,"mainlang")},topic_prev_available:"true"}}),$i.$set(qe);const Mt={};_e[0]&1&&(Mt.place=q[0].place),_e[0]&1&&(Mt.sub_heading="There is more Health and Social Care data available for <a href = '/"+q[0].place.parents[0].code+"/' data-sveltekit-noscroll>"+q[0].place.parents[0].name+" </a>"),_e[0]&512&&(Mt.chart_compare_type=q[9]),_e[0]&1537&&(Mt.boxes={box_1:{id:"generalhealth",content:{ni:"StackedBarChart",lgd:"StackedBarChart",dea:"StackedBarChart",sdz:"not available - needs missing 2011",dz:"not available - needs missing 2011"},chart_data:q[0].place&&q[11](["general_health"],["2011"],["2021"]),zKey:q[9],label:q[10],topic_prev_available:"true"},box_2:{id:"wellbeing",content:"<p><span class='text-big' style='font-size: 2.8em'>7.5</span> / 10 </p><p><span class='text-big' style='font-size: 2.8em'>"+q[16]("Happy.value").toLocaleString()+"</span> / 10 </p>",show:["ni","lgd"]},box_3:{id:"lifeexpectancy",content:"<p>Males <span class='text-big' style='font-size: 1.8em'>"+q[16]("LE.value.Males").toLocaleString()+"</span> years</p><p>Female <span class='text-big' style='font-size: 1.8em'>"+q[16]("LE.value.Females").toLocaleString()+"</span> years</p>",show:["ni","lgd"]},box_4:{id:"carers",content:"GroupChart",chart_data:{none:q[12](q[0].place.grouped_data_nocompare.provision_care,"provision_care"),prev:q[12](q[0].place.grouped_data_timecompare.provision_care,"provision_care"),ni:q[12](q[0].place.grouped_data_areacompare.provision_care,"provision_care")},label:q[10],topic_prev_available:"true"},box_5:{id:"hospitalactivity",content:"<p><span class='text-big' style='font-size: 1.8em'>"+q[16]("Admiss.value").toLocaleString()+"</span> hospital admissions.  The most frequent reason was xxx</p>",show:["ni","dea"]},box_6:{id:"primarycare",content:"<p><span class='text-big' style='font-size: 1.2em'>"+q[16]("GP.value.PRACS").toLocaleString()+"</span> practices, <span class='text-big' style='font-size: 1.2em'>"+q[16]("GP.value.GPS").toLocaleString()+"</span> GPs, and <span class='text-big' style='font-size: 1.2em'>"+q[16]("GP.value.PRACLIST").toLocaleString()+"</span> patients per practice<span class='text-big' style='font-size: 1.2em'></p><p>"+q[16]("DEN.value.GDSDSSurgeries").toLocaleString()+"</span> dental surgeries, <span class='text-big' style='font-size: 1.2em'>"+q[16]("DEN.value.GDSDSDentists").toLocaleString()+"</span> dentists and <span class='text-big' style='font-size: 1.2em'>"+q[16]("DEN_REG.value.Dental_Registrations").toLocaleString()+"</span> patients registered in total</p>",show:["ni","lgd"]},box_7:{id:"primarycare",content:"<p><span class='text-big' style='font-size: 1.2em'>"+q[16]("DEN.value.GDSDSSurgeries").toLocaleString()+"</span> dental surgeries, <span class='text-big' style='font-size: 1.2em'>"+q[16]("DEN.value.GDSDSDentists").toLocaleString()+"</span> dentists and <span class='text-big' style='font-size: 1.2em'>"+q[16]("DEN_REG.value.Dental_Registrations").toLocaleString()+"</span> patients registered in total</p>",show:["dea"]}}),Ni.$set(Mt);const je={};_e[0]&1&&(je.place=q[0].place),_e[0]&1&&(je.sub_heading="There is more Work and Welfare data available for <a href = '/"+q[0].place.parents[0].code+"/' data-sveltekit-noscroll>"+q[0].place.parents[0].name+" </a>"),_e[0]&512&&(je.chart_compare_type=q[9]),_e[0]&1&&(je.boxes={box_1:{id:"employmentrates",content:"<p><span class='text-big' style='font-size: 1.8em'>"+q[16]("LMS.value.EMPR").toLocaleString()+"</span> employment rate</p><p><span class='text-big' style='font-size: 1.8em'>"+q[16]("LMS.value.UNEMPR").toLocaleString()+"</span> unemployment rate</p><p><span class='text-big' style='font-size: 1.8em'>"+q[16]("LMS.value.INACTR").toLocaleString()+"</span> inactivity rate</p>",show:["ni","lgd"]},box_2:{id:"employed",content:"<p><span class='text-big' style='font-size: 1.8em'>"+q[16]("LMS.value.EMPN").toLocaleString()+"</span> employed</p>",show:["ni","lgd"]},box_3:{id:"wages",content:'<p><span class="text-big" style="font-size: 1.8em">'+q[16]("ASHE.value").toLocaleString()+"</span> annual median salary</p>",show:["ni","lgd"]},box_4:{id:"disabilitybenefits",content:'<span class="text-big">'+(q[0].place.data.BS.value.PIP+q[0].place.data.BS.value.DLA+q[0].place.data.BS.value.CA+q[0].place.data.BS.value.AA).toLocaleString()+"</span> claimants"},box_5:{id:"workingagebenefits",content:'<span class="text-big">'+(q[0].place.data.BS.value.UC+q[0].place.data.BS.value.JSA+q[0].place.data.BS.value.IS+q[0].place.data.BS.value.ESA).toLocaleString()+"</span> claimants"},box_6:{id:"pensionagebenefits",content:'<span class="text-big">'+(q[0].place.data.BS.value.RP+q[0].place.data.BS.value.PC).toLocaleString()+"</span> claimants"}}),en.$set(je);const Vt={};_e[0]&1&&(Vt.place=q[0].place),_e[0]&1&&(Vt.sub_heading="There is more Schools, colleges and universities data available for <a href = '/"+q[0].place.parents[0].code+"/' data-sveltekit-noscroll>"+q[0].place.parents[0].name+" </a>"),_e[0]&512&&(Vt.chart_compare_type=q[9]),_e[0]&1&&(Vt.boxes={box_1:{id:"enrollments",content:"<p>Primary school <span class='text-big' style='font-size: 1.2em'>500 </span></p><p>Secondary school <span class='text-big' style='font-size: 1.2em'>320 </span></p><p>Further education colleges <span class='text-big' style='font-size: 1.2em'>45 </span></p><p>University <span class='text-big' style='font-size: 1.2em'>200 </span></p>",show:["ni","lgd","dea"]},box_2:{id:"fsme",content:"<p>Primary school <span class='text-big' style='font-size: 1.8em'>33.2%</span></p><p>Secondary school <span class='text-big' style='font-size: 1.8em'>25.2%</span></p>",show:["ni","lgd","dea"]},box_3:{id:"teachers",content:"<p><span class='text-big' style='font-size: 1.8em'>"+q[16]("ClassSize.value").toLocaleString()+"</span> pupils per teacher</p>",show:["ni","lgd"]},box_4:{id:"qualifications",content:"GroupChart",chart_data:{none:q[12](q[0].place.grouped_data_nocompare.highest_level_of_qualifications,"highest_level_of_qualifications"),prev:q[12](q[0].place.grouped_data_timecompare.highest_level_of_qualifications,"highest_level_of_qualifications"),ni:q[12](q[0].place.grouped_data_areacompare.highest_level_of_qualifications,"highest_level_of_qualifications")},topic_prev_available:"true"},box_5:{id:"attainment",content:"<span > attainment to be added</span>",show:["ni","lgd"]}}),Ui.$set(Vt);const lr={};_e[0]&1&&(lr.place=q[0].place),_e[0]&512&&(lr.chart_compare_type=q[9]),Vi.$set(lr);const Dt={};_e[0]&1&&(Dt.place=q[0].place),_e[0]&512&&(Dt.chart_compare_type=q[9]),tn.$set(Dt)},i(q){ji||(Qe(Nt.$$.fragment,q),Qe(ti.$$.fragment,q),Qe(Gr.$$.fragment,q),Qe(Nr.$$.fragment,q),Qe(bi.$$.fragment,q),Qe($i.$$.fragment,q),Qe(Ni.$$.fragment,q),Qe(en.$$.fragment,q),Qe(Ui.$$.fragment,q),Qe(Vi.$$.fragment,q),Qe(tn.$$.fragment,q),ji=!0)},o(q){at(Nt.$$.fragment,q),at(ti.$$.fragment,q),at(Gr.$$.fragment,q),at(Nr.$$.fragment,q),at(bi.$$.fragment,q),at($i.$$.fragment,q),at(Ni.$$.fragment,q),at(en.$$.fragment,q),at(Ui.$$.fragment,q),at(Vi.$$.fragment,q),at(tn.$$.fragment,q),ji=!1},d(q){q&&ae(h),oi.d(),N.d(),V&&V.d(),ir(Nt),q&&ae(Zr),q&&ae(sr),ir(ti),ir(Gr),ir(Nr),q&&ae(qt),q&&ae(Lr),se.d(),ir(bi),J&&J.d(),De.d(),sn(),q&&ae(di),q&&ae(Ur),ir($i),ir(Ni),ir(en),ir(Ui),ir(Vi),ir(tn),vn=!1,Hu(ln)}}}function N1(u){let h=u[0].place.name+"",d;return{c(){d=Pt(h)},l(p){d=Ct(p,h)},m(p,y){Le(p,d,y)},p(p,y){y[0]&1&&h!==(h=p[0].place.name+"")&&Ar(d,h)},d(p){p&&ae(d)}}}function U1(u){let h,d=u[0].place.name+"",p,y=[...u[0].place.parents].reverse(),v=[];for(let a=0;a<y.length;a+=1)v[a]=Ym(Hm(u,y,a));return{c(){for(let a=0;a<v.length;a+=1)v[a].c();h=mt(),p=Pt(d)},l(a){for(let T=0;T<v.length;T+=1)v[T].l(a);h=yt(a),p=Ct(a,d)},m(a,T){for(let E=0;E<v.length;E+=1)v[E]&&v[E].m(a,T);Le(a,h,T),Le(a,p,T)},p(a,T){if(T[0]&1){y=[...a[0].place.parents].reverse();let E;for(E=0;E<y.length;E+=1){const M=Hm(a,y,E);v[E]?v[E].p(M,T):(v[E]=Ym(M),v[E].c(),v[E].m(h.parentNode,h))}for(;E<v.length;E+=1)v[E].d(1);v.length=y.length}T[0]&1&&d!==(d=a[0].place.name+"")&&Ar(p,d)},d(a){on(v,a),a&&ae(h),a&&ae(p)}}}function Ym(u){let h,d=u[39].name+"",p,y,v,a=" &gt; ",T;return{c(){h=Fe("a"),p=Pt(d),v=new Ol(!1),T=cr(),this.h()},l(E){h=Ne(E,"A",{href:!0,"data-sveltekit-noscroll":!0,class:!0});var M=Be(h);p=Ct(M,d),M.forEach(ae),v=Fl(E,!1),T=cr(),this.h()},h(){oe(h,"href",y=Na+"/"+u[39].code+"/"),oe(h,"data-sveltekit-noscroll",""),oe(h,"class","svelte-hmrro5"),v.a=T},m(E,M){Le(E,h,M),Te(h,p),v.m(a,E,M),Le(E,T,M)},p(E,M){M[0]&1&&d!==(d=E[39].name+"")&&Ar(p,d),M[0]&1&&y!==(y=Na+"/"+E[39].code+"/")&&oe(h,"href",y)},d(E){E&&ae(h),E&&ae(T),E&&v.d()}}}function V1(u){let h,d,p,y;return{c(){h=Fe("button"),d=Pt("No comparison"),this.h()},l(v){h=Ne(v,"BUTTON",{class:!0});var a=Be(h);d=Ct(a,"No comparison"),a.forEach(ae),this.h()},h(){oe(h,"class","btn svelte-hmrro5"),Jn(h,"btn-active",u[3])},m(v,a){Le(v,h,a),Te(h,d),p||(y=[pa(h,"click",u[20]),pa(h,"click",u[21]),pa(h,"click",u[22])],p=!0)},p(v,a){a[0]&8&&Jn(h,"btn-active",v[3])},d(v){v&&ae(h),p=!1,Hu(y)}}}function j1(u){let h,d,p,y;return{c(){h=Fe("button"),d=Pt("No comparison"),this.h()},l(v){h=Ne(v,"BUTTON",{class:!0});var a=Be(h);d=Ct(a,"No comparison"),a.forEach(ae),this.h()},h(){oe(h,"class","btn svelte-hmrro5"),Jn(h,"btn-active",!u[2])},m(v,a){Le(v,h,a),Te(h,d),p||(y=[pa(h,"click",u[17]),pa(h,"click",u[18]),pa(h,"click",u[19])],p=!0)},p(v,a){a[0]&4&&Jn(h,"btn-active",!v[2])},d(v){v&&ae(h),p=!1,Hu(y)}}}function Qm(u){let h,d,p,y;return{c(){h=Fe("button"),d=Pt("NI compare"),this.h()},l(v){h=Ne(v,"BUTTON",{class:!0});var a=Be(h);d=Ct(a,"NI compare"),a.forEach(ae),this.h()},h(){oe(h,"class","btn svelte-hmrro5"),Jn(h,"btn-active",u[8]&!u[3]&!u[2])},m(v,a){Le(v,h,a),Te(h,d),p||(y=[pa(h,"click",u[23]),pa(h,"click",u[24]),pa(h,"click",u[25])],p=!0)},p(v,a){a[0]&268&&Jn(h,"btn-active",v[8]&!v[3]&!v[2])},d(v){v&&ae(h),p=!1,Hu(y)}}}function q1(u){let h,d,p=u[0].place.name+"",y;return{c(){h=Pt("Explore "),d=Fe("span"),y=Pt(p),this.h()},l(v){h=Ct(v,"Explore "),d=Ne(v,"SPAN",{style:!0});var a=Be(d);y=Ct(a,p),a.forEach(ae),this.h()},h(){Ge(d,"color","#3878c5")},m(v,a){Le(v,h,a),Le(v,d,a),Te(d,y)},p(v,a){a[0]&1&&p!==(p=v[0].place.name+"")&&Ar(y,p)},d(v){v&&ae(h),v&&ae(d)}}}function Z1(u){let h,d,p=u[0].place.name+"",y,v,a,T=In[u[0].place.type].name+"",E;return{c(){h=Pt(`Explore \r
					`),d=Fe("span"),y=Pt(p),v=mt(),a=Fe("span"),E=Pt(T),this.h()},l(M){h=Ct(M,`Explore \r
					`),d=Ne(M,"SPAN",{style:!0});var F=Be(d);y=Ct(F,p),F.forEach(ae),v=yt(M),a=Ne(M,"SPAN",{style:!0});var R=Be(a);E=Ct(R,T),R.forEach(ae),this.h()},h(){Ge(d,"color","#3878c5"),Ge(a,"color","#00205b")},m(M,F){Le(M,h,F),Le(M,d,F),Te(d,y),Le(M,v,F),Le(M,a,F),Te(a,E)},p(M,F){F[0]&1&&p!==(p=M[0].place.name+"")&&Ar(y,p),F[0]&1&&T!==(T=In[M[0].place.type].name+"")&&Ar(E,T)},d(M){M&&ae(h),M&&ae(d),M&&ae(v),M&&ae(a)}}}function G1(u){let h,d,p,y,v,a,T;const E=[as[u[41]],{id:u[41]+"-fill"},{type:"fill"},{isChild:u[7][u[41]]},{click:!0},{selected:u[6].selected},{highlight:!0},{highlighted:u[6].highlighted},{hover:!0},{hovered:u[6].hovered},{layout:{visibility:u[6].type==u[41]||u[6].childType==u[41]?"visible":"none"}},{paint:u[6].type==u[41]?Yi["fill-self"]:u[6].childType==u[41]?Yi["fill-child"]:Yi.fill}];let M={};for(let ie=0;ie<E.length;ie+=1)M=_h(M,E[ie]);h=new Pp({props:M}),h.$on("select",u[13]);const F=[as[u[41]],{id:u[41]+"-bounds"},{type:"line"},{selected:u[6].selected},{highlight:!0},{highlighted:u[6].highlighted},{layout:{visibility:u[6].type==u[41]||u[6].childType==u[41]?"visible":"none"}},{paint:u[6].type==u[41]?Yi["line-active"]:u[6].childType==u[41]?Yi["line-child"]:Yi.line}];let R={};for(let ie=0;ie<F.length;ie+=1)R=_h(R,F[ie]);p=new Pp({props:R});const D=[as[u[41]],{id:u[41]+"-self"},{type:"line"},{selected:u[6].selected},{layout:{visibility:u[6].type==u[41]?"visible":"none"}},{paint:u[6].type==u[41]?Yi["line-self"]:Yi.line}];let H={};for(let ie=0;ie<D.length;ie+=1)H=_h(H,D[ie]);return v=new Pp({props:H}),{c(){er(h.$$.fragment),d=mt(),er(p.$$.fragment),y=mt(),er(v.$$.fragment),a=mt()},l(ie){tr(h.$$.fragment,ie),d=yt(ie),tr(p.$$.fragment,ie),y=yt(ie),tr(v.$$.fragment,ie),a=yt(ie)},m(ie,de){rr(h,ie,de),Le(ie,d,de),rr(p,ie,de),Le(ie,y,de),rr(v,ie,de),Le(ie,a,de),T=!0},p(ie,de){const fe=de[0]&192?vh(E,[de&0&&bh(as[ie[41]]),E[1],E[2],de[0]&128&&{isChild:ie[7][ie[41]]},E[4],de[0]&64&&{selected:ie[6].selected},E[6],de[0]&64&&{highlighted:ie[6].highlighted},E[8],de[0]&64&&{hovered:ie[6].hovered},de[0]&64&&{layout:{visibility:ie[6].type==ie[41]||ie[6].childType==ie[41]?"visible":"none"}},de[0]&64&&{paint:ie[6].type==ie[41]?Yi["fill-self"]:ie[6].childType==ie[41]?Yi["fill-child"]:Yi.fill}]):{};h.$set(fe);const we=de[0]&64?vh(F,[de&0&&bh(as[ie[41]]),F[1],F[2],de[0]&64&&{selected:ie[6].selected},F[4],de[0]&64&&{highlighted:ie[6].highlighted},de[0]&64&&{layout:{visibility:ie[6].type==ie[41]||ie[6].childType==ie[41]?"visible":"none"}},de[0]&64&&{paint:ie[6].type==ie[41]?Yi["line-active"]:ie[6].childType==ie[41]?Yi["line-child"]:Yi.line}]):{};p.$set(we);const xe=de[0]&64?vh(D,[de&0&&bh(as[ie[41]]),D[1],D[2],de[0]&64&&{selected:ie[6].selected},de[0]&64&&{layout:{visibility:ie[6].type==ie[41]?"visible":"none"}},de[0]&64&&{paint:ie[6].type==ie[41]?Yi["line-self"]:Yi.line}]):{};v.$set(xe)},i(ie){T||(Qe(h.$$.fragment,ie),Qe(p.$$.fragment,ie),Qe(v.$$.fragment,ie),T=!0)},o(ie){at(h.$$.fragment,ie),at(p.$$.fragment,ie),at(v.$$.fragment,ie),T=!1},d(ie){ir(h,ie),ie&&ae(d),ir(p,ie),ie&&ae(y),ir(v,ie),ie&&ae(a)}}}function $m(u){let h,d;const p=[bd[u[41]]];let y={$$slots:{default:[G1]},$$scope:{ctx:u}};for(let v=0;v<p.length;v+=1)y=_h(y,p[v]);return h=new H_({props:y}),{c(){er(h.$$.fragment)},l(v){tr(h.$$.fragment,v)},m(v,a){rr(h,v,a),d=!0},p(v,a){const T=a&0?vh(p,[bh(bd[v[41]])]):{};a[0]&192|a[1]&16384&&(T.$$scope={dirty:a,ctx:v}),h.$set(T)},i(v){d||(Qe(h.$$.fragment,v),d=!0)},o(v){at(h.$$.fragment,v),d=!1},d(v){ir(h,v)}}}function K1(u){let h,d,p=["dz","sdz","ward","dea","lgd"],y=[];for(let a=0;a<5;a+=1)y[a]=$m(Wm(u,p,a));const v=a=>at(y[a],1,1,()=>{y[a]=null});return{c(){for(let a=0;a<5;a+=1)y[a].c();h=cr()},l(a){for(let T=0;T<5;T+=1)y[T].l(a);h=cr()},m(a,T){for(let E=0;E<5;E+=1)y[E]&&y[E].m(a,T);Le(a,h,T),d=!0},p(a,T){if(T[0]&8384){p=["dz","sdz","ward","dea","lgd"];let E;for(E=0;E<5;E+=1){const M=Wm(a,p,E);y[E]?(y[E].p(M,T),Qe(y[E],1)):(y[E]=$m(M),y[E].c(),Qe(y[E],1),y[E].m(h.parentNode,h))}for(An(),E=5;E<5;E+=1)v(E);Pn()}},i(a){if(!d){for(let T=0;T<5;T+=1)Qe(y[T]);d=!0}},o(a){y=y.filter(Boolean);for(let T=0;T<5;T+=1)at(y[T]);d=!1},d(a){on(y,a),a&&ae(h)}}}function ey(u){let h,d,p=u[0].place.name+"",y,v,a,T=[...u[0].place.parents].reverse(),E=[];for(let M=0;M<T.length;M+=1)E[M]=ty(Xm(u,T,M));return{c(){h=Fe("span"),d=Pt("Parents of "),y=Pt(p),v=mt(),a=Fe("span");for(let M=0;M<E.length;M+=1)E[M].c();this.h()},l(M){h=Ne(M,"SPAN",{class:!0});var F=Be(h);d=Ct(F,"Parents of "),y=Ct(F,p),F.forEach(ae),v=yt(M),a=Ne(M,"SPAN",{class:!0});var R=Be(a);for(let D=0;D<E.length;D+=1)E[D].l(R);R.forEach(ae),this.h()},h(){oe(h,"class","text-bold"),oe(a,"class","text-small")},m(M,F){Le(M,h,F),Te(h,d),Te(h,y),Le(M,v,F),Le(M,a,F);for(let R=0;R<E.length;R+=1)E[R]&&E[R].m(a,null)},p(M,F){if(F[0]&1&&p!==(p=M[0].place.name+"")&&Ar(y,p),F[0]&1){T=[...M[0].place.parents].reverse();let R;for(R=0;R<T.length;R+=1){const D=Xm(M,T,R);E[R]?E[R].p(D,F):(E[R]=ty(D),E[R].c(),E[R].m(a,null))}for(;R<E.length;R+=1)E[R].d(1);E.length=T.length}},d(M){M&&ae(h),M&&ae(v),M&&ae(a),on(E,M)}}}function ty(u){let h,d,p=u[38]>0?"↳ ":"",y,v=u[39].name+"",a,T;return{c(){h=Fe("span"),d=new Ol(!1),y=Fe("a"),a=Pt(v),this.h()},l(E){h=Ne(E,"SPAN",{style:!0});var M=Be(h);d=Fl(M,!1),y=Ne(M,"A",{href:!0,"data-sveltekit-noscroll":!0,class:!0});var F=Be(y);a=Ct(F,v),F.forEach(ae),M.forEach(ae),this.h()},h(){d.a=y,oe(y,"href",T=Na+"/"+u[39].code),oe(y,"data-sveltekit-noscroll",""),oe(y,"class","svelte-hmrro5"),Ge(h,"display","block"),Ge(h,"margin-left",(u[38]>0?(u[38]-1)*15:0)+"px")},m(E,M){Le(E,h,M),d.m(p,h),Te(h,y),Te(y,a)},p(E,M){M[0]&1&&v!==(v=E[39].name+"")&&Ar(a,v),M[0]&1&&T!==(T=Na+"/"+E[39].code)&&oe(y,"href",T)},d(E){E&&ae(h)}}}function X1(u){let h,d,p=u[0].place.name+"",y,v,a=In[u[0].place.type].name+"",T;return{c(){h=Fe("span"),d=Pt("No areas below "),y=Pt(p),v=mt(),T=Pt(a),this.h()},l(E){h=Ne(E,"SPAN",{class:!0});var M=Be(h);d=Ct(M,"No areas below "),y=Ct(M,p),v=yt(M),T=Ct(M,a),M.forEach(ae),this.h()},h(){oe(h,"class","muted")},m(E,M){Le(E,h,M),Te(h,d),Te(h,y),Te(h,v),Te(h,T)},p(E,M){M[0]&1&&p!==(p=E[0].place.name+"")&&Ar(y,p),M[0]&1&&a!==(a=In[E[0].place.type].name+"")&&Ar(T,a)},d(E){E&&ae(h)}}}function W1(u){let h,d=(u[0].place.children[0]?In[u[0].place.children[0].type].pl:"Areas")+"",p,y,v=u[0].place.name+"",a,T,E,M,F=u[0].place.children,R=[];for(let D=0;D<F.length;D+=1)R[D]=ry(Km(u,F,D));return{c(){h=Fe("span"),p=Pt(d),y=Pt(" within "),a=Pt(v),T=Fe("br"),E=mt(),M=Fe("span");for(let D=0;D<R.length;D+=1)R[D].c();this.h()},l(D){h=Ne(D,"SPAN",{class:!0});var H=Be(h);p=Ct(H,d),y=Ct(H," within "),a=Ct(H,v),H.forEach(ae),T=Ne(D,"BR",{}),E=yt(D),M=Ne(D,"SPAN",{class:!0});var ie=Be(M);for(let de=0;de<R.length;de+=1)R[de].l(ie);ie.forEach(ae),this.h()},h(){oe(h,"class","text-bold"),oe(M,"class","text-small")},m(D,H){Le(D,h,H),Te(h,p),Te(h,y),Te(h,a),Le(D,T,H),Le(D,E,H),Le(D,M,H);for(let ie=0;ie<R.length;ie+=1)R[ie]&&R[ie].m(M,null)},p(D,H){if(H[0]&1&&d!==(d=(D[0].place.children[0]?In[D[0].place.children[0].type].pl:"Areas")+"")&&Ar(p,d),H[0]&1&&v!==(v=D[0].place.name+"")&&Ar(a,v),H[0]&1){F=D[0].place.children;let ie;for(ie=0;ie<F.length;ie+=1){const de=Km(D,F,ie);R[ie]?R[ie].p(de,H):(R[ie]=ry(de),R[ie].c(),R[ie].m(M,null))}for(;ie<R.length;ie+=1)R[ie].d(1);R.length=F.length}},d(D){D&&ae(h),D&&ae(T),D&&ae(E),D&&ae(M),on(R,D)}}}function ry(u){let h,d=u[36].name+"",p,y,v=u[38]<u[0].place.children.length-1?", ":"",a;return{c(){h=Fe("a"),p=Pt(d),a=Pt(v),this.h()},l(T){h=Ne(T,"A",{href:!0,"data-sveltekit-noscroll":!0,class:!0});var E=Be(h);p=Ct(E,d),E.forEach(ae),a=Ct(T,v),this.h()},h(){oe(h,"href",y=Na+"/"+u[36].code),oe(h,"data-sveltekit-noscroll",""),oe(h,"class","svelte-hmrro5")},m(T,E){Le(T,h,E),Te(h,p),Le(T,a,E)},p(T,E){E[0]&1&&d!==(d=T[36].name+"")&&Ar(p,d),E[0]&1&&y!==(y=Na+"/"+T[36].code)&&oe(h,"href",y),E[0]&1&&v!==(v=T[38]<T[0].place.children.length-1?", ":"")&&Ar(a,v)},d(T){T&&ae(h),T&&ae(a)}}}function H1(u){let h,d,p=u[0].place&&u[0].ni&&Jm(u);return{c(){p&&p.c(),h=cr()},l(y){p&&p.l(y),h=cr()},m(y,v){p&&p.m(y,v),Le(y,h,v),d=!0},p(y,v){y[0].place&&y[0].ni?p?(p.p(y,v),v[0]&1&&Qe(p,1)):(p=Jm(y),p.c(),Qe(p,1),p.m(h.parentNode,h)):p&&(An(),at(p,1,1,()=>{p=null}),Pn())},i(y){d||(Qe(p),d=!0)},o(y){at(p),d=!1},d(y){p&&p.d(y),y&&ae(h)}}}function J1(u){let h,d,p,y,v,a,T,E,M,F,R,D,H,ie,de,fe;return document.title=h=u[0].place.name+" NISRA Key Statistics",H=new r1({}),de=new h_({props:{column:"wide",$$slots:{default:[H1]},$$scope:{ctx:u}}}),{c(){d=Fe("meta"),p=Fe("meta"),v=Fe("meta"),a=Fe("meta"),E=Fe("meta"),F=Fe("meta"),D=mt(),er(H.$$.fragment),ie=mt(),er(de.$$.fragment),this.h()},l(we){const xe=l_("svelte-12i6502",document.head);d=Ne(xe,"META",{name:!0,content:!0}),p=Ne(xe,"META",{property:!0,content:!0}),v=Ne(xe,"META",{property:!0,content:!0}),a=Ne(xe,"META",{property:!0,content:!0}),E=Ne(xe,"META",{property:!0,content:!0}),F=Ne(xe,"META",{name:!0,content:!0}),xe.forEach(ae),D=yt(we),tr(H.$$.fragment,we),ie=yt(we),tr(de.$$.fragment,we),this.h()},h(){oe(d,"name","description"),oe(d,"content",""),oe(p,"property","og:title"),oe(p,"content",y=u[0].place.name+" Census Data"),oe(v,"property","og:type"),oe(v,"content","website"),oe(a,"property","og:url"),oe(a,"content",T=kh.base+"/"+u[0].place.code+"/"),oe(E,"property","og:description"),oe(E,"content",M="Explore NISRA Statistics for "+u[0].place.name+"."),oe(F,"name","description"),oe(F,"content",R="Explore NISRA Statistics for "+u[0].place.name+".")},m(we,xe){Te(document.head,d),Te(document.head,p),Te(document.head,v),Te(document.head,a),Te(document.head,E),Te(document.head,F),Le(we,D,xe),rr(H,we,xe),Le(we,ie,xe),rr(de,we,xe),fe=!0},p(we,xe){(!fe||xe[0]&1)&&h!==(h=we[0].place.name+" NISRA Key Statistics")&&(document.title=h),(!fe||xe[0]&1&&y!==(y=we[0].place.name+" Census Data"))&&oe(p,"content",y),(!fe||xe[0]&1&&T!==(T=kh.base+"/"+we[0].place.code+"/"))&&oe(a,"content",T),(!fe||xe[0]&1&&M!==(M="Explore NISRA Statistics for "+we[0].place.name+"."))&&oe(E,"content",M),(!fe||xe[0]&1&&R!==(R="Explore NISRA Statistics for "+we[0].place.name+"."))&&oe(F,"content",R);const st={};xe[0]&2047|xe[1]&16384&&(st.$$scope={dirty:xe,ctx:we}),de.$set(st)},i(we){fe||(Qe(H.$$.fragment,we),Qe(de.$$.fragment,we),fe=!0)},o(we){at(H.$$.fragment,we),at(de.$$.fragment,we),fe=!1},d(we){ae(d),ae(p),ae(v),ae(a),ae(E),ae(F),we&&ae(D),ir(H,we),we&&ae(ie),ir(de,we)}}}function ns(u){let h=(u*100).toFixed(1);return h<.1?"<0.1%":h+"%"}function Y1(u,h,d){let p,y,v,a,{data:T}=h,E,M,F=null,R=!1,D={selected:null,type:null,childType:null,highlighted:[],hovered:null},H={};Object.keys(as).forEach(At=>d(7,H[At]=!1,H));function ie(At,mr,Tr){const xr=(hr,Fi)=>hr+Fi;let Zr=At[0],sr=Tr[0],ti=mr[0],Wt="perc",Gr=T.place.data[Zr][Wt][sr],yr=T.place.data[Zr][Wt][ti],Nr=T.ni.data[Zr][Wt][sr],qt=zp[Zr].map(hr=>hr.category),Lr=zp[Zr].map(hr=>hr.label?hr.label:hr.category);return qt.map((hr,Fi)=>Array.isArray(hr)?{x:Lr[Fi],y:hr.map(Cr=>Gr[Cr]).reduce(xr,0),ni:hr.map(Cr=>Nr[Cr]).reduce(xr,0),prev:hr.map(Cr=>yr[Cr]).reduce(xr,0)}:{x:Lr[Fi],y:Gr[hr],ni:Nr[hr],prev:yr[hr]})}function de(At,mr){const Tr=zp[mr];let xr=[];return Tr.forEach(Zr=>{let ti=At.filter(Wt=>Wt.category===Zr.category).map(Wt=>({group:Wt.group,category:Zr.label,perc:Wt.perc}));xr=[...xr,...ti]}),xr}function fe(At){F&&F.fitBounds(At,{padding:20})}function we(At){let mr=JSON.parse(JSON.stringify(D)),Tr=T.place.code,xr=T.place.type,Zr=T.place.children[0]?T.place.children.map(yr=>yr.code):[],sr=T.place.type=="rgn"?"cty":Zr[0]?T.place.children[0].type:null;d(6,D.selected=Tr,D),d(6,D.type=xr,D),d(6,D.childType=sr,D),d(6,D.highlighted=Zr,D);let ti=Object.keys(as),Wt=["fill-color","fill-opacity"],Gr=["line-color","line-width","line-opacity"];F&&(D.type!=mr.type||D.childType!=mr.childType)&&(ti.forEach(yr=>{let Nr=yr==xr||sr&&yr==sr?"visible":"none";F.setLayoutProperty(yr+"-fill","visibility",Nr),F.setLayoutProperty(yr+"-bounds","visibility",Nr),T.place.type!="ni"&&F.setLayoutProperty(yr+"-self","visibility",Nr),d(7,H[yr]=yr==sr,H)}),T.place.type!="ni"&&(Wt.forEach(yr=>F.setPaintProperty(xr+"-fill",yr,Yi[Zr[0]?"fill-active":"fill-self"][yr])),Gr.forEach(yr=>{F.setPaintProperty(xr+"-bounds",yr,Yi["line-active"][yr]),F.setPaintProperty(xr+"-self",yr,Yi["line-self"][yr])})),sr&&(Wt.forEach(yr=>F.setPaintProperty(sr+"-fill",yr,Yi["fill-child"][yr])),Gr.forEach(yr=>F.setPaintProperty(sr+"-bounds",yr,Yi["line-child"][yr]))))}function xe(At){we(),fe(T.place.bounds)}function st(At){vd(`${Na}/${At.detail.code}/`,{noScroll:!0})}function $e(At){vd(`${Na}/${At.detail.value}/`,{noScroll:!0})}function Me(){d(4,M=E<575?1:window.getComputedStyle(grid).getPropertyValue("grid-template-columns").split(" ").length)}function Je(At){return At==1?"largest":At==T.place.count?"smallest":At+n_(At)+" largest"}function ct(At){let mr=At.split("."),Tr=T.place.data;for(let xr=0;xr<mr.length;xr++)Tr.hasOwnProperty(mr[xr])&&(Tr=Tr[mr[xr]]);return Tr}const Ue=()=>d(3,a=!0),ht=()=>d(2,R=!1),_t=()=>d(8,v=!1),pt=()=>d(3,a=!0),Nt=()=>d(2,R=!1),bt=()=>d(8,v=!1),zt=()=>d(8,v=!0),rt=()=>d(3,a=!1),Zt=()=>d(2,R=!1),gt=()=>d(2,R=!0),It=()=>d(3,a=!1),jt=()=>d(8,v=!1);function ei(At){F=At,d(5,F)}function We(){E=this.clientWidth,d(1,E)}return u.$$set=At=>{"data"in At&&d(0,T=At.data)},u.$$.update=()=>{u.$$.dirty[0]&2&&E&&Me(),u.$$.dirty[0]&5&&d(10,p=R?"Same area 2011":T.place&&T.place.type!="ni"?"NI 2021":null),u.$$.dirty[0]&13&&d(9,y=a?null:R?"prev":!R&&T.place.type!="ni"?"ni":null),u.$$.dirty[0]&1&&T.place&&xe(T.place)},d(3,a=!0),d(8,v=!1),[T,E,R,a,M,F,D,H,v,y,p,ie,de,st,$e,Je,ct,Ue,ht,_t,pt,Nt,bt,zt,rt,Zt,gt,It,jt,ei,We]}class ob extends mn{constructor(h){super(),yn(this,h,Y1,J1,gn,{data:0},null,[-1,-1])}}export{ob as component,ab as universal};
