import{g as n_,c as gd,a as _d,s as a_,b as o_,d as s_,S as l_}from"../chunks/navigation.11173fc4.js";import{g as En,a as wh,m as rs,b as Ml,c as u_,d as Yi,e as vd}from"../chunks/config.efd7d94e.js";import{S as an,i as on,s as sn,k as Ue,l as Ve,m as Be,h as ne,n as ie,R as Gu,b as Le,T as Zu,g as ot,v as Ln,d as ft,f as Rn,P as ay,o as Rp,K as Fu,M as Ou,N as Nu,O as Uu,w as Bs,e as ir,E as Ku,U as c_,Q as Kt,V as kr,p as We,W as Wn,X as Yn,C as xe,D as ei,Y as nn,Z as is,q as Tt,r as It,u as wr,y as ur,z as cr,A as hr,B as pr,a as yt,c as gt,_ as zh,G as Ip,I as h_,F as Sh,$ as Bl,a0 as Fl,L as p_,a1 as f_,a2 as d_,a3 as yh,a4 as gh,a5 as _h}from"../chunks/index.baf6a862.js";import{b as kn,a as m_}from"../chunks/paths.6cd261b1.js";import{S as y_}from"../chunks/Section.6106804d.js";/* empty css                                                              */import{w as Tr,h as Mi}from"../chunks/singletons.30e3d455.js";async function bd(l,h){return await(await h(wh.app_json_data+l+".json")).json()}async function g_({params:l,fetch:h}){let d=l.code,p=await n_(wh.search_data,h),y={};p.forEach(T=>y[T.code]=T.name),p.forEach(T=>{T.typepl=En[T.type].pl,T.typenm=En[T.type].name,T.typestr=y[T.parent]&&T.parent==T.code?`View:  ${y[T.parent]}
        ${En[T.parent_type].name}  `:y[T.parent]&&T.parent!=T.code?`${En[T.type].name} `:""});let v=p.sort((T,F)=>T.name.localeCompare(F.name)),a=await bd("N92000002",h),k=await bd(d,h);return{search_data:v,place:k,ni:a}}const rb=Object.freeze(Object.defineProperty({__proto__:null,load:g_},Symbol.toStringTag,{value:"Module"}));var __=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function v_(l){return l&&l.__esModule&&Object.prototype.hasOwnProperty.call(l,"default")?l.default:l}var b_={rgb2hsl:Hu,rgb2hsv:Ah,rgb2hwb:Xu,rgb2cmyk:Wu,rgb2keyword:Yu,rgb2xyz:Bp,rgb2lab:Fp,rgb2lch:x_,hsl2rgb:Ch,hsl2hsv:w_,hsl2hwb:S_,hsl2cmyk:E_,hsl2keyword:k_,hsv2rgb:Mh,hsv2hsl:T_,hsv2hwb:I_,hsv2cmyk:P_,hsv2keyword:z_,hwb2rgb:Ju,hwb2hsl:A_,hwb2hsv:C_,hwb2cmyk:M_,hwb2keyword:D_,cmyk2rgb:Qu,cmyk2hsl:L_,cmyk2hsv:R_,cmyk2hwb:B_,cmyk2keyword:F_,keyword2rgb:Fs,keyword2hsl:V_,keyword2hsv:q_,keyword2hwb:j_,keyword2cmyk:G_,keyword2lab:Z_,keyword2xyz:K_,xyz2rgb:oy,xyz2lab:sy,xyz2lch:O_,lab2xyz:Op,lab2rgb:ly,lab2lch:Np,lch2lab:Up,lch2xyz:N_,lch2rgb:U_};function Hu(l){var h=l[0]/255,d=l[1]/255,p=l[2]/255,y=Math.min(h,d,p),v=Math.max(h,d,p),a=v-y,k,T,F;return v==y?k=0:h==v?k=(d-p)/a:d==v?k=2+(p-h)/a:p==v&&(k=4+(h-d)/a),k=Math.min(k*60,360),k<0&&(k+=360),F=(y+v)/2,v==y?T=0:F<=.5?T=a/(v+y):T=a/(2-v-y),[k,T*100,F*100]}function Ah(l){var h=l[0],d=l[1],p=l[2],y=Math.min(h,d,p),v=Math.max(h,d,p),a=v-y,k,T,F;return v==0?T=0:T=a/v*1e3/10,v==y?k=0:h==v?k=(d-p)/a:d==v?k=2+(p-h)/a:p==v&&(k=4+(h-d)/a),k=Math.min(k*60,360),k<0&&(k+=360),F=v/255*1e3/10,[k,T,F]}function Xu(l){var h=l[0],d=l[1],v=l[2],p=Hu(l)[0],y=1/255*Math.min(h,Math.min(d,v)),v=1-1/255*Math.max(h,Math.max(d,v));return[p,y*100,v*100]}function Wu(l){var h=l[0]/255,d=l[1]/255,p=l[2]/255,y,v,a,k;return k=Math.min(1-h,1-d,1-p),y=(1-h-k)/(1-k)||0,v=(1-d-k)/(1-k)||0,a=(1-p-k)/(1-k)||0,[y*100,v*100,a*100,k*100]}function Yu(l){return uy[JSON.stringify(l)]}function Bp(l){var h=l[0]/255,d=l[1]/255,p=l[2]/255;h=h>.04045?Math.pow((h+.055)/1.055,2.4):h/12.92,d=d>.04045?Math.pow((d+.055)/1.055,2.4):d/12.92,p=p>.04045?Math.pow((p+.055)/1.055,2.4):p/12.92;var y=h*.4124+d*.3576+p*.1805,v=h*.2126+d*.7152+p*.0722,a=h*.0193+d*.1192+p*.9505;return[y*100,v*100,a*100]}function Fp(l){var h=Bp(l),d=h[0],p=h[1],y=h[2],v,a,k;return d/=95.047,p/=100,y/=108.883,d=d>.008856?Math.pow(d,1/3):7.787*d+16/116,p=p>.008856?Math.pow(p,1/3):7.787*p+16/116,y=y>.008856?Math.pow(y,1/3):7.787*y+16/116,v=116*p-16,a=500*(d-p),k=200*(p-y),[v,a,k]}function x_(l){return Np(Fp(l))}function Ch(l){var h=l[0]/360,d=l[1]/100,p=l[2]/100,y,v,a,k,T;if(d==0)return T=p*255,[T,T,T];p<.5?v=p*(1+d):v=p+d-p*d,y=2*p-v,k=[0,0,0];for(var F=0;F<3;F++)a=h+1/3*-(F-1),a<0&&a++,a>1&&a--,6*a<1?T=y+(v-y)*6*a:2*a<1?T=v:3*a<2?T=y+(v-y)*(2/3-a)*6:T=y,k[F]=T*255;return k}function w_(l){var h=l[0],d=l[1]/100,p=l[2]/100,y,v;return p===0?[0,0,0]:(p*=2,d*=p<=1?p:2-p,v=(p+d)/2,y=2*d/(p+d),[h,y*100,v*100])}function S_(l){return Xu(Ch(l))}function E_(l){return Wu(Ch(l))}function k_(l){return Yu(Ch(l))}function Mh(l){var h=l[0]/60,d=l[1]/100,T=l[2]/100,p=Math.floor(h)%6,y=h-Math.floor(h),v=255*T*(1-d),a=255*T*(1-d*y),k=255*T*(1-d*(1-y)),T=255*T;switch(p){case 0:return[T,k,v];case 1:return[a,T,v];case 2:return[v,T,k];case 3:return[v,a,T];case 4:return[k,v,T];case 5:return[T,v,a]}}function T_(l){var h=l[0],d=l[1]/100,p=l[2]/100,y,v;return v=(2-d)*p,y=d*p,y/=v<=1?v:2-v,y=y||0,v/=2,[h,y*100,v*100]}function I_(l){return Xu(Mh(l))}function P_(l){return Wu(Mh(l))}function z_(l){return Yu(Mh(l))}function Ju(l){var h=l[0]/360,d=l[1]/100,p=l[2]/100,y=d+p,v,a,k,T;switch(y>1&&(d/=y,p/=y),v=Math.floor(6*h),a=1-p,k=6*h-v,v&1&&(k=1-k),T=d+k*(a-d),v){default:case 6:case 0:r=a,g=T,b=d;break;case 1:r=T,g=a,b=d;break;case 2:r=d,g=a,b=T;break;case 3:r=d,g=T,b=a;break;case 4:r=T,g=d,b=a;break;case 5:r=a,g=d,b=T;break}return[r*255,g*255,b*255]}function A_(l){return Hu(Ju(l))}function C_(l){return Ah(Ju(l))}function M_(l){return Wu(Ju(l))}function D_(l){return Yu(Ju(l))}function Qu(l){var h=l[0]/100,d=l[1]/100,p=l[2]/100,y=l[3]/100,v,a,k;return v=1-Math.min(1,h*(1-y)+y),a=1-Math.min(1,d*(1-y)+y),k=1-Math.min(1,p*(1-y)+y),[v*255,a*255,k*255]}function L_(l){return Hu(Qu(l))}function R_(l){return Ah(Qu(l))}function B_(l){return Xu(Qu(l))}function F_(l){return Yu(Qu(l))}function oy(l){var h=l[0]/100,d=l[1]/100,p=l[2]/100,y,v,a;return y=h*3.2406+d*-1.5372+p*-.4986,v=h*-.9689+d*1.8758+p*.0415,a=h*.0557+d*-.204+p*1.057,y=y>.0031308?1.055*Math.pow(y,1/2.4)-.055:y=y*12.92,v=v>.0031308?1.055*Math.pow(v,1/2.4)-.055:v=v*12.92,a=a>.0031308?1.055*Math.pow(a,1/2.4)-.055:a=a*12.92,y=Math.min(Math.max(0,y),1),v=Math.min(Math.max(0,v),1),a=Math.min(Math.max(0,a),1),[y*255,v*255,a*255]}function sy(l){var h=l[0],d=l[1],p=l[2],y,v,a;return h/=95.047,d/=100,p/=108.883,h=h>.008856?Math.pow(h,1/3):7.787*h+16/116,d=d>.008856?Math.pow(d,1/3):7.787*d+16/116,p=p>.008856?Math.pow(p,1/3):7.787*p+16/116,y=116*d-16,v=500*(h-d),a=200*(d-p),[y,v,a]}function O_(l){return Np(sy(l))}function Op(l){var h=l[0],d=l[1],p=l[2],y,v,a,k;return h<=8?(v=h*100/903.3,k=7.787*(v/100)+16/116):(v=100*Math.pow((h+16)/116,3),k=Math.pow(v/100,1/3)),y=y/95.047<=.008856?y=95.047*(d/500+k-16/116)/7.787:95.047*Math.pow(d/500+k,3),a=a/108.883<=.008859?a=108.883*(k-p/200-16/116)/7.787:108.883*Math.pow(k-p/200,3),[y,v,a]}function Np(l){var h=l[0],d=l[1],p=l[2],y,v,a;return y=Math.atan2(p,d),v=y*360/2/Math.PI,v<0&&(v+=360),a=Math.sqrt(d*d+p*p),[h,a,v]}function ly(l){return oy(Op(l))}function Up(l){var h=l[0],d=l[1],p=l[2],y,v,a;return a=p/360*2*Math.PI,y=d*Math.cos(a),v=d*Math.sin(a),[h,y,v]}function N_(l){return Op(Up(l))}function U_(l){return ly(Up(l))}function Fs(l){return Pp[l]}function V_(l){return Hu(Fs(l))}function q_(l){return Ah(Fs(l))}function j_(l){return Xu(Fs(l))}function G_(l){return Wu(Fs(l))}function Z_(l){return Fp(Fs(l))}function K_(l){return Bp(Fs(l))}var Pp={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,134,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,250,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,221],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[112,128,144],slategrey:[112,128,144],snow:[255,250,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,50]},uy={};for(var xd in Pp)uy[JSON.stringify(Pp[xd])]=xd;var xp=b_,Dl=function(){return new $u};for(var Lu in xp){Dl[Lu+"Raw"]=function(l){return function(h){return typeof h=="number"&&(h=Array.prototype.slice.call(arguments)),xp[l](h)}}(Lu);var wd=/(\w+)2(\w+)/.exec(Lu),wp=wd[1],H_=wd[2];Dl[wp]=Dl[wp]||{},Dl[wp][H_]=Dl[Lu]=function(l){return function(h){typeof h=="number"&&(h=Array.prototype.slice.call(arguments));var d=xp[l](h);if(typeof d=="string"||d===void 0)return d;for(var p=0;p<d.length;p++)d[p]=Math.round(d[p]);return d}}(Lu)}var $u=function(){this.convs={}};$u.prototype.routeSpace=function(l,h){var d=h[0];return d===void 0?this.getValues(l):(typeof d=="number"&&(d=Array.prototype.slice.call(h)),this.setValues(l,d))};$u.prototype.setValues=function(l,h){return this.space=l,this.convs={},this.convs[l]=h,this};$u.prototype.getValues=function(l){var h=this.convs[l];if(!h){var d=this.space,p=this.convs[d];h=Dl[d][l](p),this.convs[l]=h}return h};["rgb","hsl","hsv","cmyk","keyword"].forEach(function(l){$u.prototype[l]=function(h){return this.routeSpace(l,arguments)}});var cy={exports:{}};(function(l,h){(function(d,p){l.exports=p()})(__,function(){var d,p,y;function v(a,k){if(!d)d=k;else if(!p)p=k;else{var T="var sharedChunk = {}; ("+d+")(sharedChunk); ("+p+")(sharedChunk);",F={};d(F),y=k(F),typeof window<"u"&&(y.workerUrl=window.URL.createObjectURL(new Blob([T],{type:"text/javascript"})))}}return v(["exports"],function(a){function k(e,t){return e(t={exports:{}},t.exports),t.exports}var T=F;function F(e,t,i,u){this.cx=3*e,this.bx=3*(i-e)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*t,this.by=3*(u-t)-this.cy,this.ay=1-this.cy-this.by,this.p1x=e,this.p1y=u,this.p2x=i,this.p2y=u}F.prototype.sampleCurveX=function(e){return((this.ax*e+this.bx)*e+this.cx)*e},F.prototype.sampleCurveY=function(e){return((this.ay*e+this.by)*e+this.cy)*e},F.prototype.sampleCurveDerivativeX=function(e){return(3*this.ax*e+2*this.bx)*e+this.cx},F.prototype.solveCurveX=function(e,t){var i,u,f,m,x;for(t===void 0&&(t=1e-6),f=e,x=0;x<8;x++){if(m=this.sampleCurveX(f)-e,Math.abs(m)<t)return f;var E=this.sampleCurveDerivativeX(f);if(Math.abs(E)<1e-6)break;f-=m/E}if((f=e)<(i=0))return i;if(f>(u=1))return u;for(;i<u;){if(m=this.sampleCurveX(f),Math.abs(m-e)<t)return f;e>m?i=f:u=f,f=.5*(u-i)+i}return f},F.prototype.solve=function(e,t){return this.sampleCurveY(this.solveCurveX(e,t))};var M=N;function N(e,t){this.x=e,this.y=t}N.prototype={clone:function(){return new N(this.x,this.y)},add:function(e){return this.clone()._add(e)},sub:function(e){return this.clone()._sub(e)},multByPoint:function(e){return this.clone()._multByPoint(e)},divByPoint:function(e){return this.clone()._divByPoint(e)},mult:function(e){return this.clone()._mult(e)},div:function(e){return this.clone()._div(e)},rotate:function(e){return this.clone()._rotate(e)},rotateAround:function(e,t){return this.clone()._rotateAround(e,t)},matMult:function(e){return this.clone()._matMult(e)},unit:function(){return this.clone()._unit()},perp:function(){return this.clone()._perp()},round:function(){return this.clone()._round()},mag:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals:function(e){return this.x===e.x&&this.y===e.y},dist:function(e){return Math.sqrt(this.distSqr(e))},distSqr:function(e){var t=e.x-this.x,i=e.y-this.y;return t*t+i*i},angle:function(){return Math.atan2(this.y,this.x)},angleTo:function(e){return Math.atan2(this.y-e.y,this.x-e.x)},angleWith:function(e){return this.angleWithSep(e.x,e.y)},angleWithSep:function(e,t){return Math.atan2(this.x*t-this.y*e,this.x*e+this.y*t)},_matMult:function(e){var t=e[2]*this.x+e[3]*this.y;return this.x=e[0]*this.x+e[1]*this.y,this.y=t,this},_add:function(e){return this.x+=e.x,this.y+=e.y,this},_sub:function(e){return this.x-=e.x,this.y-=e.y,this},_mult:function(e){return this.x*=e,this.y*=e,this},_div:function(e){return this.x/=e,this.y/=e,this},_multByPoint:function(e){return this.x*=e.x,this.y*=e.y,this},_divByPoint:function(e){return this.x/=e.x,this.y/=e.y,this},_unit:function(){return this._div(this.mag()),this},_perp:function(){var e=this.y;return this.y=this.x,this.x=-e,this},_rotate:function(e){var t=Math.cos(e),i=Math.sin(e),u=i*this.x+t*this.y;return this.x=t*this.x-i*this.y,this.y=u,this},_rotateAround:function(e,t){var i=Math.cos(e),u=Math.sin(e),f=t.y+u*(this.x-t.x)+i*(this.y-t.y);return this.x=t.x+i*(this.x-t.x)-u*(this.y-t.y),this.y=f,this},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}},N.convert=function(e){return e instanceof N?e:Array.isArray(e)?new N(e[0],e[1]):e};var R=typeof self<"u"?self:{},X=Math.pow(2,53)-1;function Q(e,t,i,u){var f=new T(e,t,i,u);return function(m){return f.solve(m)}}var ae=Q(.25,.1,.25,1);function le(e,t,i){return Math.min(i,Math.max(t,e))}function de(e,t,i){var u=i-t,f=((e-t)%u+u)%u+t;return f===t?i:f}function ge(e){for(var t=[],i=arguments.length-1;i-- >0;)t[i]=arguments[i+1];for(var u=0,f=t;u<f.length;u+=1){var m=f[u];for(var x in m)e[x]=m[x]}return e}var rt=1;function Fe(){return rt++}function ze(){return function e(t){return t?(t^16*Math.random()>>t/4).toString(16):([1e7]+-[1e3]+-4e3+-8e3+-1e11).replace(/[018]/g,e)}()}function Ge(e){return!!e&&/^[0-9a-f]{8}-[0-9a-f]{4}-[4][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i.test(e)}function zt(e,t){e.forEach(function(i){t[i]&&(t[i]=t[i].bind(t))})}function wt(e,t){return e.indexOf(t,e.length-t.length)!==-1}function je(e,t,i){var u={};for(var f in e)u[f]=t.call(i||this,e[f],f,e);return u}function Ze(e,t,i){var u={};for(var f in e)t.call(i||this,e[f],f,e)&&(u[f]=e[f]);return u}function mt(e){return Array.isArray(e)?e.map(mt):typeof e=="object"&&e?je(e,mt):e}var nr={};function qe(e){nr[e]||(typeof console<"u"&&console.warn(e),nr[e]=!0)}function Bt(e,t,i){return(i.y-e.y)*(t.x-e.x)>(t.y-e.y)*(i.x-e.x)}function Re(e){for(var t=0,i=0,u=e.length,f=u-1,m=void 0,x=void 0;i<u;f=i++)t+=((x=e[f]).x-(m=e[i]).x)*(m.y+x.y);return t}function et(){return typeof WorkerGlobalScope<"u"&&typeof self<"u"&&self instanceof WorkerGlobalScope}function dt(e){var t={};if(e.replace(/(?:^|(?:\s*\,\s*))([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)(?:\=(?:([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)|(?:\"((?:[^"\\]|\\.)*)\")))?/g,function(u,f,m,x){var E=m||x;return t[f]=!E||E.toLowerCase(),""}),t["max-age"]){var i=parseInt(t["max-age"],10);isNaN(i)?delete t["max-age"]:t["max-age"]=i}return t}var qt=null;function Mt(e){if(qt==null){var t=e.navigator?e.navigator.userAgent:null;qt=!!e.safari||!(!t||!(/\b(iPad|iPhone|iPod)\b/.test(t)||t.match("Safari")&&!t.match("Chrome")))}return qt}function xt(e){try{var t=R[e];return t.setItem("_mapbox_test_",1),t.removeItem("_mapbox_test_"),!0}catch{return!1}}var Ae,at,Mr,Zr,wi=R.performance&&R.performance.now?R.performance.now.bind(R.performance):Date.now.bind(Date),Rr=R.requestAnimationFrame||R.mozRequestAnimationFrame||R.webkitRequestAnimationFrame||R.msRequestAnimationFrame,ar=R.cancelAnimationFrame||R.mozCancelAnimationFrame||R.webkitCancelAnimationFrame||R.msCancelAnimationFrame,Sr={now:wi,frame:function(e){var t=Rr(e);return{cancel:function(){return ar(t)}}},getImageData:function(e,t){t===void 0&&(t=0);var i=R.document.createElement("canvas"),u=i.getContext("2d");if(!u)throw new Error("failed to create canvas 2d context");return i.width=e.width,i.height=e.height,u.drawImage(e,0,0,e.width,e.height),u.getImageData(-t,-t,e.width+2*t,e.height+2*t)},resolveURL:function(e){return Ae||(Ae=R.document.createElement("a")),Ae.href=e,Ae.href},hardwareConcurrency:R.navigator&&R.navigator.hardwareConcurrency||4,get devicePixelRatio(){return R.devicePixelRatio},get prefersReducedMotion(){return!!R.matchMedia&&(at==null&&(at=R.matchMedia("(prefers-reduced-motion: reduce)")),at.matches)}},Gt={API_URL:"https://api.mapbox.com",get EVENTS_URL(){return this.API_URL?this.API_URL.indexOf("https://api.mapbox.cn")===0?"https://events.mapbox.cn/events/v2":this.API_URL.indexOf("https://api.mapbox.com")===0?"https://events.mapbox.com/events/v2":null:null},FEEDBACK_URL:"https://apps.mapbox.com/feedback",REQUIRE_ACCESS_TOKEN:!0,ACCESS_TOKEN:null,MAX_PARALLEL_IMAGE_REQUESTS:16},Si={supported:!1,testSupport:function(e){!Jn&&Zr&&(ti?Nt(e):Mr=e)}},Jn=!1,ti=!1;function Nt(e){var t=e.createTexture();e.bindTexture(e.TEXTURE_2D,t);try{if(e.texImage2D(e.TEXTURE_2D,0,e.RGBA,e.RGBA,e.UNSIGNED_BYTE,Zr),e.isContextLost())return;Si.supported=!0}catch{}e.deleteTexture(t),Jn=!0}R.document&&((Zr=R.document.createElement("img")).onload=function(){Mr&&Nt(Mr),Mr=null,ti=!0},Zr.onerror=function(){Jn=!0,Mr=null},Zr.src="data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAQAAAAfQ//73v/+BiOh/AAA=");var dn="01",ci=function(e,t){this._transformRequestFn=e,this._customAccessToken=t,this._createSkuToken()};function Jr(e){return e.indexOf("mapbox:")===0}ci.prototype._createSkuToken=function(){var e=function(){for(var t="",i=0;i<10;i++)t+="0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ"[Math.floor(62*Math.random())];return{token:["1",dn,t].join(""),tokenExpiresAt:Date.now()+432e5}}();this._skuToken=e.token,this._skuTokenExpiresAt=e.tokenExpiresAt},ci.prototype._isSkuTokenExpired=function(){return Date.now()>this._skuTokenExpiresAt},ci.prototype.transformRequest=function(e,t){return this._transformRequestFn&&this._transformRequestFn(e,t)||{url:e}},ci.prototype.normalizeStyleURL=function(e,t){if(!Jr(e))return e;var i=ni(e);return i.path="/styles/v1"+i.path,this._makeAPIURL(i,this._customAccessToken||t)},ci.prototype.normalizeGlyphsURL=function(e,t){if(!Jr(e))return e;var i=ni(e);return i.path="/fonts/v1"+i.path,this._makeAPIURL(i,this._customAccessToken||t)},ci.prototype.normalizeSourceURL=function(e,t){if(!Jr(e))return e;var i=ni(e);return i.path="/v4/"+i.authority+".json",i.params.push("secure"),this._makeAPIURL(i,this._customAccessToken||t)},ci.prototype.normalizeSpriteURL=function(e,t,i,u){var f=ni(e);return Jr(e)?(f.path="/styles/v1"+f.path+"/sprite"+t+i,this._makeAPIURL(f,this._customAccessToken||u)):(f.path+=""+t+i,vr(f))},ci.prototype.normalizeTileURL=function(e,t){if(this._isSkuTokenExpired()&&this._createSkuToken(),e&&!Jr(e))return e;var i=ni(e);i.path=i.path.replace(/(\.(png|jpg)\d*)(?=$)/,(Sr.devicePixelRatio>=2||t===512?"@2x":"")+(Si.supported?".webp":"$1")),i.path=i.path.replace(/^.+\/v4\//,"/"),i.path="/v4"+i.path;var u=this._customAccessToken||function(f){for(var m=0,x=f;m<x.length;m+=1){var E=x[m].match(/^access_token=(.*)$/);if(E)return E[1]}return null}(i.params)||Gt.ACCESS_TOKEN;return Gt.REQUIRE_ACCESS_TOKEN&&u&&this._skuToken&&i.params.push("sku="+this._skuToken),this._makeAPIURL(i,u)},ci.prototype.canonicalizeTileURL=function(e,t){var i=ni(e);if(!i.path.match(/(^\/v4\/)/)||!i.path.match(/\.[\w]+$/))return e;var u="mapbox://tiles/";u+=i.path.replace("/v4/","");var f=i.params;return t&&(f=f.filter(function(m){return!m.match(/^access_token=/)})),f.length&&(u+="?"+f.join("&")),u},ci.prototype.canonicalizeTileset=function(e,t){for(var i=!!t&&Jr(t),u=[],f=0,m=e.tiles||[];f<m.length;f+=1){var x=m[f];hi(x)?u.push(this.canonicalizeTileURL(x,i)):u.push(x)}return u},ci.prototype._makeAPIURL=function(e,t){var i="See https://www.mapbox.com/api-documentation/#access-tokens-and-token-scopes",u=ni(Gt.API_URL);if(e.protocol=u.protocol,e.authority=u.authority,e.protocol==="http"){var f=e.params.indexOf("secure");f>=0&&e.params.splice(f,1)}if(u.path!=="/"&&(e.path=""+u.path+e.path),!Gt.REQUIRE_ACCESS_TOKEN)return vr(e);if(!(t=t||Gt.ACCESS_TOKEN))throw new Error("An API access token is required to use Mapbox GL. "+i);if(t[0]==="s")throw new Error("Use a public access token (pk.*) with Mapbox GL, not a secret access token (sk.*). "+i);return e.params=e.params.filter(function(m){return m.indexOf("access_token")===-1}),e.params.push("access_token="+t),vr(e)};var Bn=/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/|\?|$)/i;function hi(e){return Bn.test(e)}var Tn=/^(\w+):\/\/([^/?]*)(\/[^?]+)?\??(.+)?/;function ni(e){var t=e.match(Tn);if(!t)throw new Error("Unable to parse URL object");return{protocol:t[1],authority:t[2],path:t[3]||"/",params:t[4]?t[4].split("&"):[]}}function vr(e){var t=e.params.length?"?"+e.params.join("&"):"";return e.protocol+"://"+e.authority+e.path+t}function gi(e){if(!e)return null;var t=e.split(".");if(!t||t.length!==3)return null;try{return JSON.parse(decodeURIComponent(R.atob(t[1]).split("").map(function(i){return"%"+("00"+i.charCodeAt(0).toString(16)).slice(-2)}).join("")))}catch{return null}}var pi=function(e){this.type=e,this.anonId=null,this.eventData={},this.queue=[],this.pendingRequest=null};pi.prototype.getStorageKey=function(e){var t,i=gi(Gt.ACCESS_TOKEN);return t=i&&i.u?R.btoa(encodeURIComponent(i.u).replace(/%([0-9A-F]{2})/g,function(u,f){return String.fromCharCode(+("0x"+f))})):Gt.ACCESS_TOKEN||"",e?"mapbox.eventData."+e+":"+t:"mapbox.eventData:"+t},pi.prototype.fetchEventData=function(){var e=xt("localStorage"),t=this.getStorageKey(),i=this.getStorageKey("uuid");if(e)try{var u=R.localStorage.getItem(t);u&&(this.eventData=JSON.parse(u));var f=R.localStorage.getItem(i);f&&(this.anonId=f)}catch{qe("Unable to read from LocalStorage")}},pi.prototype.saveEventData=function(){var e=xt("localStorage"),t=this.getStorageKey(),i=this.getStorageKey("uuid");if(e)try{R.localStorage.setItem(i,this.anonId),Object.keys(this.eventData).length>=1&&R.localStorage.setItem(t,JSON.stringify(this.eventData))}catch{qe("Unable to write to LocalStorage")}},pi.prototype.processRequests=function(e){},pi.prototype.postEvent=function(e,t,i,u){var f=this;if(Gt.EVENTS_URL){var m=ni(Gt.EVENTS_URL);m.params.push("access_token="+(u||Gt.ACCESS_TOKEN||""));var x={event:this.type,created:new Date(e).toISOString(),sdkIdentifier:"mapbox-gl-js",sdkVersion:"1.13.2",skuId:dn,userId:this.anonId},E=t?ge(x,t):x,z={url:vr(m),headers:{"Content-Type":"text/plain"},body:JSON.stringify([E])};this.pendingRequest=Pr(z,function(A){f.pendingRequest=null,i(A),f.saveEventData(),f.processRequests(u)})}},pi.prototype.queueRequest=function(e,t){this.queue.push(e),this.processRequests(t)};var Vr,Ji,Kr=function(e){function t(){e.call(this,"map.load"),this.success={},this.skuToken=""}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.postMapLoadEvent=function(i,u,f,m){this.skuToken=f,(Gt.EVENTS_URL&&m||Gt.ACCESS_TOKEN&&Array.isArray(i)&&i.some(function(x){return Jr(x)||hi(x)}))&&this.queueRequest({id:u,timestamp:Date.now()},m)},t.prototype.processRequests=function(i){var u=this;if(!this.pendingRequest&&this.queue.length!==0){var f=this.queue.shift(),m=f.id,x=f.timestamp;m&&this.success[m]||(this.anonId||this.fetchEventData(),Ge(this.anonId)||(this.anonId=ze()),this.postEvent(x,{skuToken:this.skuToken},function(E){E||m&&(u.success[m]=!0)},i))}},t}(pi),In=new(function(e){function t(i){e.call(this,"appUserTurnstile"),this._customAccessToken=i}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.postTurnstileEvent=function(i,u){Gt.EVENTS_URL&&Gt.ACCESS_TOKEN&&Array.isArray(i)&&i.some(function(f){return Jr(f)||hi(f)})&&this.queueRequest(Date.now(),u)},t.prototype.processRequests=function(i){var u=this;if(!this.pendingRequest&&this.queue.length!==0){this.anonId&&this.eventData.lastSuccess&&this.eventData.tokenU||this.fetchEventData();var f=gi(Gt.ACCESS_TOKEN),m=f?f.u:Gt.ACCESS_TOKEN,x=m!==this.eventData.tokenU;Ge(this.anonId)||(this.anonId=ze(),x=!0);var E=this.queue.shift();if(this.eventData.lastSuccess){var z=new Date(this.eventData.lastSuccess),A=new Date(E),D=(E-this.eventData.lastSuccess)/864e5;x=x||D>=1||D<-1||z.getDate()!==A.getDate()}else x=!0;if(!x)return this.processRequests();this.postEvent(E,{"enabled.telemetry":!1},function(B){B||(u.eventData.lastSuccess=E,u.eventData.tokenU=m)},i)}},t}(pi)),Qi=In.postTurnstileEvent.bind(In),Fn=new Kr,Oi=Fn.postMapLoadEvent.bind(Fn),Pn=500,$i=50;function zn(){R.caches&&!Vr&&(Vr=R.caches.open("mapbox-tiles"))}function Ni(e){var t=e.indexOf("?");return t<0?e:e.slice(0,t)}var mn,Ui=1/0;function Vi(){return mn==null&&(mn=R.OffscreenCanvas&&new R.OffscreenCanvas(1,1).getContext("2d")&&typeof R.createImageBitmap=="function"),mn}var Qr={Unknown:"Unknown",Style:"Style",Source:"Source",Tile:"Tile",Glyphs:"Glyphs",SpriteImage:"SpriteImage",SpriteJSON:"SpriteJSON",Image:"Image"};typeof Object.freeze=="function"&&Object.freeze(Qr);var ia=function(e){function t(i,u,f){u===401&&hi(f)&&(i+=": you may have provided an invalid Mapbox access token. See https://www.mapbox.com/api-documentation/#access-tokens-and-token-scopes"),e.call(this,i),this.status=u,this.url=f,this.name=this.constructor.name,this.message=i}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.toString=function(){return this.name+": "+this.message+" ("+this.status+"): "+this.url},t}(Error),ln=et()?function(){return self.worker&&self.worker.referrer}:function(){return(R.location.protocol==="blob:"?R.parent:R).location.href},$r,yn,On=function(e,t){if(!(/^file:/.test(i=e.url)||/^file:/.test(ln())&&!/^\w+:/.test(i))){if(R.fetch&&R.Request&&R.AbortController&&R.Request.prototype.hasOwnProperty("signal"))return function(u,f){var m,x=new R.AbortController,E=new R.Request(u.url,{method:u.method||"GET",body:u.body,credentials:u.credentials,headers:u.headers,referrer:ln(),signal:x.signal}),z=!1,A=!1,D=(m=E.url).indexOf("sku=")>0&&hi(m);u.type==="json"&&E.headers.set("Accept","application/json");var B=function(G,J,ee){if(!A){if(G&&G.message!=="SecurityError"&&qe(G),J&&ee)return q(J);var he=Date.now();R.fetch(E).then(function(oe){if(oe.ok){var ye=D?oe.clone():null;return q(oe,ye,he)}return f(new ia(oe.statusText,oe.status,u.url))}).catch(function(oe){oe.code!==20&&f(new Error(oe.message))})}},q=function(G,J,ee){(u.type==="arrayBuffer"?G.arrayBuffer():u.type==="json"?G.json():G.text()).then(function(he){A||(J&&ee&&function(oe,ye,be){if(zn(),Vr){var Ee={status:ye.status,statusText:ye.statusText,headers:new R.Headers};ye.headers.forEach(function(Me,Ke){return Ee.headers.set(Ke,Me)});var Te=dt(ye.headers.get("Cache-Control")||"");Te["no-store"]||(Te["max-age"]&&Ee.headers.set("Expires",new Date(be+1e3*Te["max-age"]).toUTCString()),new Date(Ee.headers.get("Expires")).getTime()-be<42e4||function(Me,Ke){if(Ji===void 0)try{new Response(new ReadableStream),Ji=!0}catch{Ji=!1}Ji?Ke(Me.body):Me.blob().then(Ke)}(ye,function(Me){var Ke=new R.Response(Me,Ee);zn(),Vr&&Vr.then(function($e){return $e.put(Ni(oe.url),Ke)}).catch(function($e){return qe($e.message)})}))}}(E,J,ee),z=!0,f(null,he,G.headers.get("Cache-Control"),G.headers.get("Expires")))}).catch(function(he){A||f(new Error(he.message))})};return D?function(G,J){if(zn(),!Vr)return J(null);var ee=Ni(G.url);Vr.then(function(he){he.match(ee).then(function(oe){var ye=function(be){if(!be)return!1;var Ee=new Date(be.headers.get("Expires")||0),Te=dt(be.headers.get("Cache-Control")||"");return Ee>Date.now()&&!Te["no-cache"]}(oe);he.delete(ee),ye&&he.put(ee,oe.clone()),J(null,oe,ye)}).catch(J)}).catch(J)}(E,B):B(null,null),{cancel:function(){A=!0,z||x.abort()}}}(e,t);if(et()&&self.worker&&self.worker.actor)return self.worker.actor.send("getResource",e,t,void 0,!0)}var i;return function(u,f){var m=new R.XMLHttpRequest;for(var x in m.open(u.method||"GET",u.url,!0),u.type==="arrayBuffer"&&(m.responseType="arraybuffer"),u.headers)m.setRequestHeader(x,u.headers[x]);return u.type==="json"&&(m.responseType="text",m.setRequestHeader("Accept","application/json")),m.withCredentials=u.credentials==="include",m.onerror=function(){f(new Error(m.statusText))},m.onload=function(){if((m.status>=200&&m.status<300||m.status===0)&&m.response!==null){var E=m.response;if(u.type==="json")try{E=JSON.parse(m.response)}catch(z){return f(z)}f(null,E,m.getResponseHeader("Cache-Control"),m.getResponseHeader("Expires"))}else f(new ia(m.statusText,m.status,u.url))},m.send(u.body),{cancel:function(){return m.abort()}}}(e,t)},Br=function(e,t){return On(ge(e,{type:"arrayBuffer"}),t)},Pr=function(e,t){return On(ge(e,{method:"POST"}),t)},L="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAC0lEQVQYV2NgAAIAAAUAAarVyFEAAAAASUVORK5CYII=";$r=[],yn=0;var U=function(e,t){if(Si.supported&&(e.headers||(e.headers={}),e.headers.accept="image/webp,*/*"),yn>=Gt.MAX_PARALLEL_IMAGE_REQUESTS){var i={requestParameters:e,callback:t,cancelled:!1,cancel:function(){this.cancelled=!0}};return $r.push(i),i}yn++;var u=!1,f=function(){if(!u)for(u=!0,yn--;$r.length&&yn<Gt.MAX_PARALLEL_IMAGE_REQUESTS;){var x=$r.shift();x.cancelled||(x.cancel=U(x.requestParameters,x.callback).cancel)}},m=Br(e,function(x,E,z,A){f(),x?t(x):E&&(Vi()?function(D,B){var q=new R.Blob([new Uint8Array(D)],{type:"image/png"});R.createImageBitmap(q).then(function(G){B(null,G)}).catch(function(G){B(new Error("Could not load image because of "+G.message+". Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."))})}(E,t):function(D,B,q,G){var J=new R.Image,ee=R.URL;J.onload=function(){B(null,J),ee.revokeObjectURL(J.src),J.onload=null,R.requestAnimationFrame(function(){J.src=L})},J.onerror=function(){return B(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."))};var he=new R.Blob([new Uint8Array(D)],{type:"image/png"});J.cacheControl=q,J.expires=G,J.src=D.byteLength?ee.createObjectURL(he):L}(E,t,z,A))});return{cancel:function(){m.cancel(),f()}}};function I(e,t,i){i[e]&&i[e].indexOf(t)!==-1||(i[e]=i[e]||[],i[e].push(t))}function V(e,t,i){if(i&&i[e]){var u=i[e].indexOf(t);u!==-1&&i[e].splice(u,1)}}var W=function(e,t){t===void 0&&(t={}),ge(this,t),this.type=e},ue=function(e){function t(i,u){u===void 0&&(u={}),e.call(this,"error",ge({error:i},u))}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t}(W),pe=function(){};pe.prototype.on=function(e,t){return this._listeners=this._listeners||{},I(e,t,this._listeners),this},pe.prototype.off=function(e,t){return V(e,t,this._listeners),V(e,t,this._oneTimeListeners),this},pe.prototype.once=function(e,t){return this._oneTimeListeners=this._oneTimeListeners||{},I(e,t,this._oneTimeListeners),this},pe.prototype.fire=function(e,t){typeof e=="string"&&(e=new W(e,t||{}));var i=e.type;if(this.listens(i)){e.target=this;for(var u=0,f=this._listeners&&this._listeners[i]?this._listeners[i].slice():[];u<f.length;u+=1)f[u].call(this,e);for(var m=0,x=this._oneTimeListeners&&this._oneTimeListeners[i]?this._oneTimeListeners[i].slice():[];m<x.length;m+=1){var E=x[m];V(i,E,this._oneTimeListeners),E.call(this,e)}var z=this._eventedParent;z&&(ge(e,typeof this._eventedParentData=="function"?this._eventedParentData():this._eventedParentData),z.fire(e))}else e instanceof ue&&console.error(e.error);return this},pe.prototype.listens=function(e){return this._listeners&&this._listeners[e]&&this._listeners[e].length>0||this._oneTimeListeners&&this._oneTimeListeners[e]&&this._oneTimeListeners[e].length>0||this._eventedParent&&this._eventedParent.listens(e)},pe.prototype.setEventedParent=function(e,t){return this._eventedParent=e,this._eventedParentData=t,this};var j={$version:8,$root:{version:{required:!0,type:"enum",values:[8]},name:{type:"string"},metadata:{type:"*"},center:{type:"array",value:"number"},zoom:{type:"number"},bearing:{type:"number",default:0,period:360,units:"degrees"},pitch:{type:"number",default:0,units:"degrees"},light:{type:"light"},sources:{required:!0,type:"sources"},sprite:{type:"string"},glyphs:{type:"string"},transition:{type:"transition"},layers:{required:!0,type:"array",value:"layer"}},sources:{"*":{type:"source"}},source:["source_vector","source_raster","source_raster_dem","source_geojson","source_video","source_image"],source_vector:{type:{required:!0,type:"enum",values:{vector:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},attribution:{type:"string"},promoteId:{type:"promoteId"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_raster:{type:{required:!0,type:"enum",values:{raster:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},attribution:{type:"string"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_raster_dem:{type:{required:!0,type:"enum",values:{"raster-dem":{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},attribution:{type:"string"},encoding:{type:"enum",values:{terrarium:{},mapbox:{}},default:"mapbox"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_geojson:{type:{required:!0,type:"enum",values:{geojson:{}}},data:{type:"*"},maxzoom:{type:"number",default:18},attribution:{type:"string"},buffer:{type:"number",default:128,maximum:512,minimum:0},filter:{type:"*"},tolerance:{type:"number",default:.375},cluster:{type:"boolean",default:!1},clusterRadius:{type:"number",default:50,minimum:0},clusterMaxZoom:{type:"number"},clusterMinPoints:{type:"number"},clusterProperties:{type:"*"},lineMetrics:{type:"boolean",default:!1},generateId:{type:"boolean",default:!1},promoteId:{type:"promoteId"}},source_video:{type:{required:!0,type:"enum",values:{video:{}}},urls:{required:!0,type:"array",value:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},source_image:{type:{required:!0,type:"enum",values:{image:{}}},url:{required:!0,type:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},layer:{id:{type:"string",required:!0},type:{type:"enum",values:{fill:{},line:{},symbol:{},circle:{},heatmap:{},"fill-extrusion":{},raster:{},hillshade:{},background:{}},required:!0},metadata:{type:"*"},source:{type:"string"},"source-layer":{type:"string"},minzoom:{type:"number",minimum:0,maximum:24},maxzoom:{type:"number",minimum:0,maximum:24},filter:{type:"filter"},layout:{type:"layout"},paint:{type:"paint"}},layout:["layout_fill","layout_line","layout_circle","layout_heatmap","layout_fill-extrusion","layout_symbol","layout_raster","layout_hillshade","layout_background"],layout_background:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_fill:{"fill-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_circle:{"circle-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_heatmap:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},"layout_fill-extrusion":{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_line:{"line-cap":{type:"enum",values:{butt:{},round:{},square:{}},default:"butt",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-join":{type:"enum",values:{bevel:{},round:{},miter:{}},default:"miter",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"line-miter-limit":{type:"number",default:2,requires:[{"line-join":"miter"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-round-limit":{type:"number",default:1.05,requires:[{"line-join":"round"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_symbol:{"symbol-placement":{type:"enum",values:{point:{},line:{},"line-center":{}},default:"point",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-spacing":{type:"number",default:250,minimum:1,units:"pixels",requires:[{"symbol-placement":"line"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"symbol-avoid-edges":{type:"boolean",default:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"symbol-z-order":{type:"enum",values:{auto:{},"viewport-y":{},source:{}},default:"auto",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-allow-overlap":{type:"boolean",default:!1,requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-ignore-placement":{type:"boolean",default:!1,requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-optional":{type:"boolean",default:!1,requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-rotation-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-size":{type:"number",default:1,minimum:0,units:"factor of the original icon size",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-text-fit":{type:"enum",values:{none:{},width:{},height:{},both:{}},default:"none",requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-text-fit-padding":{type:"array",value:"number",length:4,default:[0,0,0,0],units:"pixels",requires:["icon-image","text-field",{"icon-text-fit":["both","width","height"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-image":{type:"resolvedImage",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-padding":{type:"number",default:2,minimum:0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-keep-upright":{type:"boolean",default:!1,requires:["icon-image",{"icon-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-offset":{type:"array",value:"number",length:2,default:[0,0],requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotation-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-field":{type:"formatted",default:"",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-font":{type:"array",value:"string",default:["Open Sans Regular","Arial Unicode MS Regular"],requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-size":{type:"number",default:16,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-width":{type:"number",default:10,minimum:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-line-height":{type:"number",default:1.2,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-letter-spacing":{type:"number",default:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-justify":{type:"enum",values:{auto:{},left:{},center:{},right:{}},default:"center",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-radial-offset":{type:"number",units:"ems",default:0,requires:["text-field"],"property-type":"data-driven",expression:{interpolated:!0,parameters:["zoom","feature"]}},"text-variable-anchor":{type:"array",value:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["text-field",{"!":"text-variable-anchor"}],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-angle":{type:"number",default:45,units:"degrees",requires:["text-field",{"symbol-placement":["line","line-center"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-writing-mode":{type:"array",value:"enum",values:{horizontal:{},vertical:{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-padding":{type:"number",default:2,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-keep-upright":{type:"boolean",default:!0,requires:["text-field",{"text-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-transform":{type:"enum",values:{none:{},uppercase:{},lowercase:{}},default:"none",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-offset":{type:"array",value:"number",units:"ems",length:2,default:[0,0],requires:["text-field",{"!":"text-radial-offset"}],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-allow-overlap":{type:"boolean",default:!1,requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-ignore-placement":{type:"boolean",default:!1,requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-optional":{type:"boolean",default:!1,requires:["text-field","icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_raster:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_hillshade:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},filter:{type:"array",value:"*"},filter_operator:{type:"enum",values:{"==":{},"!=":{},">":{},">=":{},"<":{},"<=":{},in:{},"!in":{},all:{},any:{},none:{},has:{},"!has":{},within:{}}},geometry_type:{type:"enum",values:{Point:{},LineString:{},Polygon:{}}},function:{expression:{type:"expression"},stops:{type:"array",value:"function_stop"},base:{type:"number",default:1,minimum:0},property:{type:"string",default:"$zoom"},type:{type:"enum",values:{identity:{},exponential:{},interval:{},categorical:{}},default:"exponential"},colorSpace:{type:"enum",values:{rgb:{},lab:{},hcl:{}},default:"rgb"},default:{type:"*",required:!1}},function_stop:{type:"array",minimum:0,maximum:24,value:["number","color"],length:2},expression:{type:"array",value:"*",minimum:1},light:{anchor:{type:"enum",default:"viewport",values:{map:{},viewport:{}},"property-type":"data-constant",transition:!1,expression:{interpolated:!1,parameters:["zoom"]}},position:{type:"array",default:[1.15,210,30],length:3,value:"number","property-type":"data-constant",transition:!0,expression:{interpolated:!0,parameters:["zoom"]}},color:{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},intensity:{type:"number","property-type":"data-constant",default:.5,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0}},paint:["paint_fill","paint_line","paint_circle","paint_heatmap","paint_fill-extrusion","paint_symbol","paint_raster","paint_hillshade","paint_background"],paint_fill:{"fill-antialias":{type:"boolean",default:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-outline-color":{type:"color",transition:!0,requires:[{"!":"fill-pattern"},{"fill-antialias":!0}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"}},"paint_fill-extrusion":{"fill-extrusion-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-extrusion-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-extrusion-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"fill-extrusion-height":{type:"number",default:0,minimum:0,units:"meters",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-base":{type:"number",default:0,minimum:0,units:"meters",transition:!0,requires:["fill-extrusion-height"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-vertical-gradient":{type:"boolean",default:!0,transition:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_line:{"line-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"line-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["line-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-width":{type:"number",default:1,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-gap-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-offset":{type:"number",default:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-dasharray":{type:"array",value:"number",minimum:0,transition:!0,units:"line widths",requires:[{"!":"line-pattern"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"line-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"line-gradient":{type:"color",transition:!1,requires:[{"!":"line-dasharray"},{"!":"line-pattern"},{source:"geojson",has:{lineMetrics:!0}}],expression:{interpolated:!0,parameters:["line-progress"]},"property-type":"color-ramp"}},paint_circle:{"circle-radius":{type:"number",default:5,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-blur":{type:"number",default:0,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"circle-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["circle-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-scale":{type:"enum",values:{map:{},viewport:{}},default:"map",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-alignment":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-stroke-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"}},paint_heatmap:{"heatmap-radius":{type:"number",default:30,minimum:1,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-weight":{type:"number",default:1,minimum:0,transition:!1,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-intensity":{type:"number",default:1,minimum:0,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"heatmap-color":{type:"color",default:["interpolate",["linear"],["heatmap-density"],0,"rgba(0, 0, 255, 0)",.1,"royalblue",.3,"cyan",.5,"lime",.7,"yellow",1,"red"],transition:!1,expression:{interpolated:!0,parameters:["heatmap-density"]},"property-type":"color-ramp"},"heatmap-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_symbol:{"icon-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-color":{type:"color",default:"#000000",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["icon-image","icon-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-color":{type:"color",default:"#000000",transition:!0,overridable:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["text-field","text-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_raster:{"raster-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-hue-rotate":{type:"number",default:0,period:360,transition:!0,units:"degrees",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-min":{type:"number",default:0,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-max":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-saturation":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-contrast":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-resampling":{type:"enum",values:{linear:{},nearest:{}},default:"linear",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"raster-fade-duration":{type:"number",default:300,minimum:0,transition:!1,units:"milliseconds",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_hillshade:{"hillshade-illumination-direction":{type:"number",default:335,minimum:0,maximum:359,transition:!1,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-illumination-anchor":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-exaggeration":{type:"number",default:.5,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-shadow-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-highlight-color":{type:"color",default:"#FFFFFF",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-accent-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_background:{"background-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"background-pattern"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"background-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"background-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},transition:{duration:{type:"number",default:300,minimum:0,units:"milliseconds"},delay:{type:"number",default:0,minimum:0,units:"milliseconds"}},"property-type":{"data-driven":{type:"property-type"},"cross-faded":{type:"property-type"},"cross-faded-data-driven":{type:"property-type"},"color-ramp":{type:"property-type"},"data-constant":{type:"property-type"},constant:{type:"property-type"}},promoteId:{"*":{type:"string"}}},$=function(e,t,i,u){this.message=(e?e+": ":"")+i,u&&(this.identifier=u),t!=null&&t.__line__&&(this.line=t.__line__)};function me(e){var t=e.value;return t?[new $(e.key,t,"constants have been deprecated as of v8")]:[]}function Ce(e){for(var t=[],i=arguments.length-1;i-- >0;)t[i]=arguments[i+1];for(var u=0,f=t;u<f.length;u+=1){var m=f[u];for(var x in m)e[x]=m[x]}return e}function Oe(e){return e instanceof Number||e instanceof String||e instanceof Boolean?e.valueOf():e}function we(e){if(Array.isArray(e))return e.map(we);if(e instanceof Object&&!(e instanceof Number||e instanceof String||e instanceof Boolean)){var t={};for(var i in e)t[i]=we(e[i]);return t}return Oe(e)}var De=function(e){function t(i,u){e.call(this,u),this.message=u,this.key=i}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t}(Error),st=function(e,t){t===void 0&&(t=[]),this.parent=e,this.bindings={};for(var i=0,u=t;i<u.length;i+=1){var f=u[i];this.bindings[f[0]]=f[1]}};st.prototype.concat=function(e){return new st(this,e)},st.prototype.get=function(e){if(this.bindings[e])return this.bindings[e];if(this.parent)return this.parent.get(e);throw new Error(e+" not found in scope.")},st.prototype.has=function(e){return!!this.bindings[e]||!!this.parent&&this.parent.has(e)};var tt={kind:"null"},Se={kind:"number"},He={kind:"string"},Ye={kind:"boolean"},Qe={kind:"color"},Vt={kind:"object"},it={kind:"value"},Wt={kind:"collator"},jt={kind:"formatted"},Ht={kind:"resolvedImage"};function sr(e,t){return{kind:"array",itemType:e,N:t}}function er(e){if(e.kind==="array"){var t=er(e.itemType);return typeof e.N=="number"?"array<"+t+", "+e.N+">":e.itemType.kind==="value"?"array":"array<"+t+">"}return e.kind}var _i=[tt,Se,He,Ye,Qe,jt,Vt,sr(it),Ht];function dr(e,t){if(t.kind==="error")return null;if(e.kind==="array"){if(t.kind==="array"&&(t.N===0&&t.itemType.kind==="value"||!dr(e.itemType,t.itemType))&&(typeof e.N!="number"||e.N===t.N))return null}else{if(e.kind===t.kind)return null;if(e.kind==="value"){for(var i=0,u=_i;i<u.length;i+=1)if(!dr(u[i],t))return null}}return"Expected "+er(e)+" but found "+er(t)+" instead."}function Fr(e,t){return t.some(function(i){return i.kind===e.kind})}function _r(e,t){return t.some(function(i){return i==="null"?e===null:i==="array"?Array.isArray(e):i==="object"?e&&!Array.isArray(e)&&typeof e=="object":i===typeof e})}var Jt=k(function(e,t){var i={transparent:[0,0,0,0],aliceblue:[240,248,255,1],antiquewhite:[250,235,215,1],aqua:[0,255,255,1],aquamarine:[127,255,212,1],azure:[240,255,255,1],beige:[245,245,220,1],bisque:[255,228,196,1],black:[0,0,0,1],blanchedalmond:[255,235,205,1],blue:[0,0,255,1],blueviolet:[138,43,226,1],brown:[165,42,42,1],burlywood:[222,184,135,1],cadetblue:[95,158,160,1],chartreuse:[127,255,0,1],chocolate:[210,105,30,1],coral:[255,127,80,1],cornflowerblue:[100,149,237,1],cornsilk:[255,248,220,1],crimson:[220,20,60,1],cyan:[0,255,255,1],darkblue:[0,0,139,1],darkcyan:[0,139,139,1],darkgoldenrod:[184,134,11,1],darkgray:[169,169,169,1],darkgreen:[0,100,0,1],darkgrey:[169,169,169,1],darkkhaki:[189,183,107,1],darkmagenta:[139,0,139,1],darkolivegreen:[85,107,47,1],darkorange:[255,140,0,1],darkorchid:[153,50,204,1],darkred:[139,0,0,1],darksalmon:[233,150,122,1],darkseagreen:[143,188,143,1],darkslateblue:[72,61,139,1],darkslategray:[47,79,79,1],darkslategrey:[47,79,79,1],darkturquoise:[0,206,209,1],darkviolet:[148,0,211,1],deeppink:[255,20,147,1],deepskyblue:[0,191,255,1],dimgray:[105,105,105,1],dimgrey:[105,105,105,1],dodgerblue:[30,144,255,1],firebrick:[178,34,34,1],floralwhite:[255,250,240,1],forestgreen:[34,139,34,1],fuchsia:[255,0,255,1],gainsboro:[220,220,220,1],ghostwhite:[248,248,255,1],gold:[255,215,0,1],goldenrod:[218,165,32,1],gray:[128,128,128,1],green:[0,128,0,1],greenyellow:[173,255,47,1],grey:[128,128,128,1],honeydew:[240,255,240,1],hotpink:[255,105,180,1],indianred:[205,92,92,1],indigo:[75,0,130,1],ivory:[255,255,240,1],khaki:[240,230,140,1],lavender:[230,230,250,1],lavenderblush:[255,240,245,1],lawngreen:[124,252,0,1],lemonchiffon:[255,250,205,1],lightblue:[173,216,230,1],lightcoral:[240,128,128,1],lightcyan:[224,255,255,1],lightgoldenrodyellow:[250,250,210,1],lightgray:[211,211,211,1],lightgreen:[144,238,144,1],lightgrey:[211,211,211,1],lightpink:[255,182,193,1],lightsalmon:[255,160,122,1],lightseagreen:[32,178,170,1],lightskyblue:[135,206,250,1],lightslategray:[119,136,153,1],lightslategrey:[119,136,153,1],lightsteelblue:[176,196,222,1],lightyellow:[255,255,224,1],lime:[0,255,0,1],limegreen:[50,205,50,1],linen:[250,240,230,1],magenta:[255,0,255,1],maroon:[128,0,0,1],mediumaquamarine:[102,205,170,1],mediumblue:[0,0,205,1],mediumorchid:[186,85,211,1],mediumpurple:[147,112,219,1],mediumseagreen:[60,179,113,1],mediumslateblue:[123,104,238,1],mediumspringgreen:[0,250,154,1],mediumturquoise:[72,209,204,1],mediumvioletred:[199,21,133,1],midnightblue:[25,25,112,1],mintcream:[245,255,250,1],mistyrose:[255,228,225,1],moccasin:[255,228,181,1],navajowhite:[255,222,173,1],navy:[0,0,128,1],oldlace:[253,245,230,1],olive:[128,128,0,1],olivedrab:[107,142,35,1],orange:[255,165,0,1],orangered:[255,69,0,1],orchid:[218,112,214,1],palegoldenrod:[238,232,170,1],palegreen:[152,251,152,1],paleturquoise:[175,238,238,1],palevioletred:[219,112,147,1],papayawhip:[255,239,213,1],peachpuff:[255,218,185,1],peru:[205,133,63,1],pink:[255,192,203,1],plum:[221,160,221,1],powderblue:[176,224,230,1],purple:[128,0,128,1],rebeccapurple:[102,51,153,1],red:[255,0,0,1],rosybrown:[188,143,143,1],royalblue:[65,105,225,1],saddlebrown:[139,69,19,1],salmon:[250,128,114,1],sandybrown:[244,164,96,1],seagreen:[46,139,87,1],seashell:[255,245,238,1],sienna:[160,82,45,1],silver:[192,192,192,1],skyblue:[135,206,235,1],slateblue:[106,90,205,1],slategray:[112,128,144,1],slategrey:[112,128,144,1],snow:[255,250,250,1],springgreen:[0,255,127,1],steelblue:[70,130,180,1],tan:[210,180,140,1],teal:[0,128,128,1],thistle:[216,191,216,1],tomato:[255,99,71,1],turquoise:[64,224,208,1],violet:[238,130,238,1],wheat:[245,222,179,1],white:[255,255,255,1],whitesmoke:[245,245,245,1],yellow:[255,255,0,1],yellowgreen:[154,205,50,1]};function u(E){return(E=Math.round(E))<0?0:E>255?255:E}function f(E){return u(E[E.length-1]==="%"?parseFloat(E)/100*255:parseInt(E))}function m(E){return(z=E[E.length-1]==="%"?parseFloat(E)/100:parseFloat(E))<0?0:z>1?1:z;var z}function x(E,z,A){return A<0?A+=1:A>1&&(A-=1),6*A<1?E+(z-E)*A*6:2*A<1?z:3*A<2?E+(z-E)*(2/3-A)*6:E}try{t.parseCSSColor=function(E){var z,A=E.replace(/ /g,"").toLowerCase();if(A in i)return i[A].slice();if(A[0]==="#")return A.length===4?(z=parseInt(A.substr(1),16))>=0&&z<=4095?[(3840&z)>>4|(3840&z)>>8,240&z|(240&z)>>4,15&z|(15&z)<<4,1]:null:A.length===7&&(z=parseInt(A.substr(1),16))>=0&&z<=16777215?[(16711680&z)>>16,(65280&z)>>8,255&z,1]:null;var D=A.indexOf("("),B=A.indexOf(")");if(D!==-1&&B+1===A.length){var q=A.substr(0,D),G=A.substr(D+1,B-(D+1)).split(","),J=1;switch(q){case"rgba":if(G.length!==4)return null;J=m(G.pop());case"rgb":return G.length!==3?null:[f(G[0]),f(G[1]),f(G[2]),J];case"hsla":if(G.length!==4)return null;J=m(G.pop());case"hsl":if(G.length!==3)return null;var ee=(parseFloat(G[0])%360+360)%360/360,he=m(G[1]),oe=m(G[2]),ye=oe<=.5?oe*(he+1):oe+he-oe*he,be=2*oe-ye;return[u(255*x(be,ye,ee+1/3)),u(255*x(be,ye,ee)),u(255*x(be,ye,ee-1/3)),J];default:return null}}return null}}catch{}}).parseCSSColor,lr=function(e,t,i,u){u===void 0&&(u=1),this.r=e,this.g=t,this.b=i,this.a=u};lr.parse=function(e){if(e){if(e instanceof lr)return e;if(typeof e=="string"){var t=Jt(e);if(t)return new lr(t[0]/255*t[3],t[1]/255*t[3],t[2]/255*t[3],t[3])}}},lr.prototype.toString=function(){var e=this.toArray(),t=e[1],i=e[2],u=e[3];return"rgba("+Math.round(e[0])+","+Math.round(t)+","+Math.round(i)+","+u+")"},lr.prototype.toArray=function(){var e=this.a;return e===0?[0,0,0,0]:[255*this.r/e,255*this.g/e,255*this.b/e,e]},lr.black=new lr(0,0,0,1),lr.white=new lr(1,1,1,1),lr.transparent=new lr(0,0,0,0),lr.red=new lr(1,0,0,1);var Ei=function(e,t,i){this.sensitivity=e?t?"variant":"case":t?"accent":"base",this.locale=i,this.collator=new Intl.Collator(this.locale?this.locale:[],{sensitivity:this.sensitivity,usage:"search"})};Ei.prototype.compare=function(e,t){return this.collator.compare(e,t)},Ei.prototype.resolvedLocale=function(){return new Intl.Collator(this.locale?this.locale:[]).resolvedOptions().locale};var pa=function(e,t,i,u,f){this.text=e,this.image=t,this.scale=i,this.fontStack=u,this.textColor=f},ai=function(e){this.sections=e};ai.fromString=function(e){return new ai([new pa(e,null,null,null,null)])},ai.prototype.isEmpty=function(){return this.sections.length===0||!this.sections.some(function(e){return e.text.length!==0||e.image&&e.image.name.length!==0})},ai.factory=function(e){return e instanceof ai?e:ai.fromString(e)},ai.prototype.toString=function(){return this.sections.length===0?"":this.sections.map(function(e){return e.text}).join("")},ai.prototype.serialize=function(){for(var e=["format"],t=0,i=this.sections;t<i.length;t+=1){var u=i[t];if(u.image)e.push(["image",u.image.name]);else{e.push(u.text);var f={};u.fontStack&&(f["text-font"]=["literal",u.fontStack.split(",")]),u.scale&&(f["font-scale"]=u.scale),u.textColor&&(f["text-color"]=["rgba"].concat(u.textColor.toArray())),e.push(f)}}return e};var Di=function(e){this.name=e.name,this.available=e.available};function Na(e,t,i,u){return typeof e=="number"&&e>=0&&e<=255&&typeof t=="number"&&t>=0&&t<=255&&typeof i=="number"&&i>=0&&i<=255?u===void 0||typeof u=="number"&&u>=0&&u<=1?null:"Invalid rgba value ["+[e,t,i,u].join(", ")+"]: 'a' must be between 0 and 1.":"Invalid rgba value ["+(typeof u=="number"?[e,t,i,u]:[e,t,i]).join(", ")+"]: 'r', 'g', and 'b' must be between 0 and 255."}function va(e){if(e===null||typeof e=="string"||typeof e=="boolean"||typeof e=="number"||e instanceof lr||e instanceof Ei||e instanceof ai||e instanceof Di)return!0;if(Array.isArray(e)){for(var t=0,i=e;t<i.length;t+=1)if(!va(i[t]))return!1;return!0}if(typeof e=="object"){for(var u in e)if(!va(e[u]))return!1;return!0}return!1}function qr(e){if(e===null)return tt;if(typeof e=="string")return He;if(typeof e=="boolean")return Ye;if(typeof e=="number")return Se;if(e instanceof lr)return Qe;if(e instanceof Ei)return Wt;if(e instanceof ai)return jt;if(e instanceof Di)return Ht;if(Array.isArray(e)){for(var t,i=e.length,u=0,f=e;u<f.length;u+=1){var m=qr(f[u]);if(t){if(t===m)continue;t=it;break}t=m}return sr(t||it,i)}return Vt}function ba(e){var t=typeof e;return e===null?"":t==="string"||t==="number"||t==="boolean"?String(e):e instanceof lr||e instanceof ai||e instanceof Di?e.toString():JSON.stringify(e)}Di.prototype.toString=function(){return this.name},Di.fromString=function(e){return e?new Di({name:e,available:!1}):null},Di.prototype.serialize=function(){return["image",this.name]};var ki=function(e,t){this.type=e,this.value=t};ki.parse=function(e,t){if(e.length!==2)return t.error("'literal' expression requires exactly one argument, but found "+(e.length-1)+" instead.");if(!va(e[1]))return t.error("invalid value");var i=e[1],u=qr(i),f=t.expectedType;return u.kind!=="array"||u.N!==0||!f||f.kind!=="array"||typeof f.N=="number"&&f.N!==0||(u=f),new ki(u,i)},ki.prototype.evaluate=function(){return this.value},ki.prototype.eachChild=function(){},ki.prototype.outputDefined=function(){return!0},ki.prototype.serialize=function(){return this.type.kind==="array"||this.type.kind==="object"?["literal",this.value]:this.value instanceof lr?["rgba"].concat(this.value.toArray()):this.value instanceof ai?this.value.serialize():this.value};var oi=function(e){this.name="ExpressionEvaluationError",this.message=e};oi.prototype.toJSON=function(){return this.message};var un={string:He,number:Se,boolean:Ye,object:Vt},Ar=function(e,t){this.type=e,this.args=t};Ar.parse=function(e,t){if(e.length<2)return t.error("Expected at least one argument.");var i,u=1,f=e[0];if(f==="array"){var m,x;if(e.length>2){var E=e[1];if(typeof E!="string"||!(E in un)||E==="object")return t.error('The item type argument of "array" must be one of string, number, boolean',1);m=un[E],u++}else m=it;if(e.length>3){if(e[2]!==null&&(typeof e[2]!="number"||e[2]<0||e[2]!==Math.floor(e[2])))return t.error('The length argument to "array" must be a positive integer literal',2);x=e[2],u++}i=sr(m,x)}else i=un[f];for(var z=[];u<e.length;u++){var A=t.parse(e[u],u,it);if(!A)return null;z.push(A)}return new Ar(i,z)},Ar.prototype.evaluate=function(e){for(var t=0;t<this.args.length;t++){var i=this.args[t].evaluate(e);if(!dr(this.type,qr(i)))return i;if(t===this.args.length-1)throw new oi("Expected value to be of type "+er(this.type)+", but found "+er(qr(i))+" instead.")}return null},Ar.prototype.eachChild=function(e){this.args.forEach(e)},Ar.prototype.outputDefined=function(){return this.args.every(function(e){return e.outputDefined()})},Ar.prototype.serialize=function(){var e=this.type,t=[e.kind];if(e.kind==="array"){var i=e.itemType;if(i.kind==="string"||i.kind==="number"||i.kind==="boolean"){t.push(i.kind);var u=e.N;(typeof u=="number"||this.args.length>1)&&t.push(u)}}return t.concat(this.args.map(function(f){return f.serialize()}))};var Nn=function(e){this.type=jt,this.sections=e};Nn.parse=function(e,t){if(e.length<2)return t.error("Expected at least one argument.");var i=e[1];if(!Array.isArray(i)&&typeof i=="object")return t.error("First argument must be an image or text section.");for(var u=[],f=!1,m=1;m<=e.length-1;++m){var x=e[m];if(f&&typeof x=="object"&&!Array.isArray(x)){f=!1;var E=null;if(x["font-scale"]&&!(E=t.parse(x["font-scale"],1,Se)))return null;var z=null;if(x["text-font"]&&!(z=t.parse(x["text-font"],1,sr(He))))return null;var A=null;if(x["text-color"]&&!(A=t.parse(x["text-color"],1,Qe)))return null;var D=u[u.length-1];D.scale=E,D.font=z,D.textColor=A}else{var B=t.parse(e[m],1,it);if(!B)return null;var q=B.type.kind;if(q!=="string"&&q!=="value"&&q!=="null"&&q!=="resolvedImage")return t.error("Formatted text type must be 'string', 'value', 'image' or 'null'.");f=!0,u.push({content:B,scale:null,font:null,textColor:null})}}return new Nn(u)},Nn.prototype.evaluate=function(e){return new ai(this.sections.map(function(t){var i=t.content.evaluate(e);return qr(i)===Ht?new pa("",i,null,null,null):new pa(ba(i),null,t.scale?t.scale.evaluate(e):null,t.font?t.font.evaluate(e).join(","):null,t.textColor?t.textColor.evaluate(e):null)}))},Nn.prototype.eachChild=function(e){for(var t=0,i=this.sections;t<i.length;t+=1){var u=i[t];e(u.content),u.scale&&e(u.scale),u.font&&e(u.font),u.textColor&&e(u.textColor)}},Nn.prototype.outputDefined=function(){return!1},Nn.prototype.serialize=function(){for(var e=["format"],t=0,i=this.sections;t<i.length;t+=1){var u=i[t];e.push(u.content.serialize());var f={};u.scale&&(f["font-scale"]=u.scale.serialize()),u.font&&(f["text-font"]=u.font.serialize()),u.textColor&&(f["text-color"]=u.textColor.serialize()),e.push(f)}return e};var gn=function(e){this.type=Ht,this.input=e};gn.parse=function(e,t){if(e.length!==2)return t.error("Expected two arguments.");var i=t.parse(e[1],1,He);return i?new gn(i):t.error("No image name provided.")},gn.prototype.evaluate=function(e){var t=this.input.evaluate(e),i=Di.fromString(t);return i&&e.availableImages&&(i.available=e.availableImages.indexOf(t)>-1),i},gn.prototype.eachChild=function(e){e(this.input)},gn.prototype.outputDefined=function(){return!1},gn.prototype.serialize=function(){return["image",this.input.serialize()]};var ns={"to-boolean":Ye,"to-color":Qe,"to-number":Se,"to-string":He},Ti=function(e,t){this.type=e,this.args=t};Ti.parse=function(e,t){if(e.length<2)return t.error("Expected at least one argument.");var i=e[0];if((i==="to-boolean"||i==="to-string")&&e.length!==2)return t.error("Expected one argument.");for(var u=ns[i],f=[],m=1;m<e.length;m++){var x=t.parse(e[m],m,it);if(!x)return null;f.push(x)}return new Ti(u,f)},Ti.prototype.evaluate=function(e){if(this.type.kind==="boolean")return!!this.args[0].evaluate(e);if(this.type.kind==="color"){for(var t,i,u=0,f=this.args;u<f.length;u+=1){if(i=null,(t=f[u].evaluate(e))instanceof lr)return t;if(typeof t=="string"){var m=e.parseColor(t);if(m)return m}else if(Array.isArray(t)&&!(i=t.length<3||t.length>4?"Invalid rbga value "+JSON.stringify(t)+": expected an array containing either three or four numeric values.":Na(t[0],t[1],t[2],t[3])))return new lr(t[0]/255,t[1]/255,t[2]/255,t[3])}throw new oi(i||"Could not parse color from value '"+(typeof t=="string"?t:String(JSON.stringify(t)))+"'")}if(this.type.kind==="number"){for(var x=null,E=0,z=this.args;E<z.length;E+=1){if((x=z[E].evaluate(e))===null)return 0;var A=Number(x);if(!isNaN(A))return A}throw new oi("Could not convert "+JSON.stringify(x)+" to number.")}return this.type.kind==="formatted"?ai.fromString(ba(this.args[0].evaluate(e))):this.type.kind==="resolvedImage"?Di.fromString(ba(this.args[0].evaluate(e))):ba(this.args[0].evaluate(e))},Ti.prototype.eachChild=function(e){this.args.forEach(e)},Ti.prototype.outputDefined=function(){return this.args.every(function(e){return e.outputDefined()})},Ti.prototype.serialize=function(){if(this.type.kind==="formatted")return new Nn([{content:this.args[0],scale:null,font:null,textColor:null}]).serialize();if(this.type.kind==="resolvedImage")return new gn(this.args[0]).serialize();var e=["to-"+this.type.kind];return this.eachChild(function(t){e.push(t.serialize())}),e};var xa=["Unknown","Point","LineString","Polygon"],qi=function(){this.globals=null,this.feature=null,this.featureState=null,this.formattedSection=null,this._parseColorCache={},this.availableImages=null,this.canonical=null};qi.prototype.id=function(){return this.feature&&"id"in this.feature?this.feature.id:null},qi.prototype.geometryType=function(){return this.feature?typeof this.feature.type=="number"?xa[this.feature.type]:this.feature.type:null},qi.prototype.geometry=function(){return this.feature&&"geometry"in this.feature?this.feature.geometry:null},qi.prototype.canonicalID=function(){return this.canonical},qi.prototype.properties=function(){return this.feature&&this.feature.properties||{}},qi.prototype.parseColor=function(e){var t=this._parseColorCache[e];return t||(t=this._parseColorCache[e]=lr.parse(e)),t};var Ii=function(e,t,i,u){this.name=e,this.type=t,this._evaluate=i,this.args=u};Ii.prototype.evaluate=function(e){return this._evaluate(e,this.args)},Ii.prototype.eachChild=function(e){this.args.forEach(e)},Ii.prototype.outputDefined=function(){return!1},Ii.prototype.serialize=function(){return[this.name].concat(this.args.map(function(e){return e.serialize()}))},Ii.parse=function(e,t){var i,u=e[0],f=Ii.definitions[u];if(!f)return t.error('Unknown expression "'+u+'". If you wanted a literal array, use ["literal", [...]].',0);for(var m=Array.isArray(f)?f[0]:f.type,x=Array.isArray(f)?[[f[1],f[2]]]:f.overloads,E=x.filter(function(kt){var ut=kt[0];return!Array.isArray(ut)||ut.length===e.length-1}),z=null,A=0,D=E;A<D.length;A+=1){var B=D[A],q=B[0],G=B[1];z=new jr(t.registry,t.path,null,t.scope);for(var J=[],ee=!1,he=1;he<e.length;he++){var oe=e[he],ye=Array.isArray(q)?q[he-1]:q.type,be=z.parse(oe,1+J.length,ye);if(!be){ee=!0;break}J.push(be)}if(!ee)if(Array.isArray(q)&&q.length!==J.length)z.error("Expected "+q.length+" arguments, but found "+J.length+" instead.");else{for(var Ee=0;Ee<J.length;Ee++){var Te=Array.isArray(q)?q[Ee]:q.type,Me=J[Ee];z.concat(Ee+1).checkSubtype(Te,Me.type)}if(z.errors.length===0)return new Ii(u,m,G,J)}}if(E.length===1)(i=t.errors).push.apply(i,z.errors);else{for(var Ke=(E.length?E:x).map(function(kt){var ut;return ut=kt[0],Array.isArray(ut)?"("+ut.map(er).join(", ")+")":"("+er(ut.type)+"...)"}).join(" | "),$e=[],bt=1;bt<e.length;bt++){var lt=t.parse(e[bt],1+$e.length);if(!lt)return null;$e.push(er(lt.type))}t.error("Expected arguments of type "+Ke+", but found ("+$e.join(", ")+") instead.")}return null},Ii.register=function(e,t){for(var i in Ii.definitions=t,t)e[i]=Ii};var Qn=function(e,t,i){this.type=Wt,this.locale=i,this.caseSensitive=e,this.diacriticSensitive=t};function ji(e,t){e[0]=Math.min(e[0],t[0]),e[1]=Math.min(e[1],t[1]),e[2]=Math.max(e[2],t[0]),e[3]=Math.max(e[3],t[1])}function wa(e,t){return!(e[0]<=t[0]||e[2]>=t[2]||e[1]<=t[1]||e[3]>=t[3])}function as(e,t){var i=(180+e[0])/360,u=(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+e[1]*Math.PI/360)))/360,f=Math.pow(2,t.z);return[Math.round(i*f*8192),Math.round(u*f*8192)]}function Ol(e,t,i){return t[1]>e[1]!=i[1]>e[1]&&e[0]<(i[0]-t[0])*(e[1]-t[1])/(i[1]-t[1])+t[0]}function uo(e,t){for(var i,u,f,m,x,E,z,A=!1,D=0,B=t.length;D<B;D++)for(var q=t[D],G=0,J=q.length;G<J-1;G++){if((m=(i=e)[0]-(u=q[G])[0])*(z=i[1]-(f=q[G+1])[1])-(E=i[0]-f[0])*(x=i[1]-u[1])==0&&m*E<=0&&x*z<=0)return!1;Ol(e,q[G],q[G+1])&&(A=!A)}return A}function Nl(e,t){for(var i=0;i<t.length;i++)if(uo(e,t[i]))return!0;return!1}function Ro(e,t,i,u){var f=u[0]-i[0],m=u[1]-i[1],x=(e[0]-i[0])*m-f*(e[1]-i[1]),E=(t[0]-i[0])*m-f*(t[1]-i[1]);return x>0&&E<0||x<0&&E>0}function Ul(e,t,i){for(var u=0,f=i;u<f.length;u+=1)for(var m=f[u],x=0;x<m.length-1;++x)if((B=[(D=m[x+1])[0]-(A=m[x])[0],D[1]-A[1]])[0]*(q=[(z=t)[0]-(E=e)[0],z[1]-E[1]])[1]-B[1]*q[0]!=0&&Ro(E,z,A,D)&&Ro(A,D,E,z))return!0;var E,z,A,D,B,q;return!1}function Bo(e,t){for(var i=0;i<e.length;++i)if(!uo(e[i],t))return!1;for(var u=0;u<e.length-1;++u)if(Ul(e[u],e[u+1],t))return!1;return!0}function Os(e,t){for(var i=0;i<t.length;i++)if(Bo(e,t[i]))return!0;return!1}function Ua(e,t,i){for(var u=[],f=0;f<e.length;f++){for(var m=[],x=0;x<e[f].length;x++){var E=as(e[f][x],i);ji(t,E),m.push(E)}u.push(m)}return u}function os(e,t,i){for(var u=[],f=0;f<e.length;f++){var m=Ua(e[f],t,i);u.push(m)}return u}function co(e,t,i,u){if(e[0]<i[0]||e[0]>i[2]){var f=.5*u,m=e[0]-i[0]>f?-u:i[0]-e[0]>f?u:0;m===0&&(m=e[0]-i[2]>f?-u:i[2]-e[0]>f?u:0),e[0]+=m}ji(t,e)}function Ns(e,t,i,u){for(var f=8192*Math.pow(2,u.z),m=[8192*u.x,8192*u.y],x=[],E=0,z=e;E<z.length;E+=1)for(var A=0,D=z[E];A<D.length;A+=1){var B=D[A],q=[B.x+m[0],B.y+m[1]];co(q,t,i,f),x.push(q)}return x}function Va(e,t,i,u){for(var f,m=8192*Math.pow(2,u.z),x=[8192*u.x,8192*u.y],E=[],z=0,A=e;z<A.length;z+=1){for(var D=[],B=0,q=A[z];B<q.length;B+=1){var G=q[B],J=[G.x+x[0],G.y+x[1]];ji(t,J),D.push(J)}E.push(D)}if(t[2]-t[0]<=m/2){(f=t)[0]=f[1]=1/0,f[2]=f[3]=-1/0;for(var ee=0,he=E;ee<he.length;ee+=1)for(var oe=0,ye=he[ee];oe<ye.length;oe+=1)co(ye[oe],t,i,m)}return E}Qn.parse=function(e,t){if(e.length!==2)return t.error("Expected one argument.");var i=e[1];if(typeof i!="object"||Array.isArray(i))return t.error("Collator options argument must be an object.");var u=t.parse(i["case-sensitive"]!==void 0&&i["case-sensitive"],1,Ye);if(!u)return null;var f=t.parse(i["diacritic-sensitive"]!==void 0&&i["diacritic-sensitive"],1,Ye);if(!f)return null;var m=null;return i.locale&&!(m=t.parse(i.locale,1,He))?null:new Qn(u,f,m)},Qn.prototype.evaluate=function(e){return new Ei(this.caseSensitive.evaluate(e),this.diacriticSensitive.evaluate(e),this.locale?this.locale.evaluate(e):null)},Qn.prototype.eachChild=function(e){e(this.caseSensitive),e(this.diacriticSensitive),this.locale&&e(this.locale)},Qn.prototype.outputDefined=function(){return!1},Qn.prototype.serialize=function(){var e={};return e["case-sensitive"]=this.caseSensitive.serialize(),e["diacritic-sensitive"]=this.diacriticSensitive.serialize(),this.locale&&(e.locale=this.locale.serialize()),["collator",e]};var Un=function(e,t){this.type=Ye,this.geojson=e,this.geometries=t};function Sa(e){if(e instanceof Ii&&(e.name==="get"&&e.args.length===1||e.name==="feature-state"||e.name==="has"&&e.args.length===1||e.name==="properties"||e.name==="geometry-type"||e.name==="id"||/^filter-/.test(e.name))||e instanceof Un)return!1;var t=!0;return e.eachChild(function(i){t&&!Sa(i)&&(t=!1)}),t}function _e(e){if(e instanceof Ii&&e.name==="feature-state")return!1;var t=!0;return e.eachChild(function(i){t&&!_e(i)&&(t=!1)}),t}function cn(e,t){if(e instanceof Ii&&t.indexOf(e.name)>=0)return!1;var i=!0;return e.eachChild(function(u){i&&!cn(u,t)&&(i=!1)}),i}Un.parse=function(e,t){if(e.length!==2)return t.error("'within' expression requires exactly one argument, but found "+(e.length-1)+" instead.");if(va(e[1])){var i=e[1];if(i.type==="FeatureCollection")for(var u=0;u<i.features.length;++u){var f=i.features[u].geometry.type;if(f==="Polygon"||f==="MultiPolygon")return new Un(i,i.features[u].geometry)}else if(i.type==="Feature"){var m=i.geometry.type;if(m==="Polygon"||m==="MultiPolygon")return new Un(i,i.geometry)}else if(i.type==="Polygon"||i.type==="MultiPolygon")return new Un(i,i)}return t.error("'within' expression requires valid geojson object that contains polygon geometry type.")},Un.prototype.evaluate=function(e){if(e.geometry()!=null&&e.canonicalID()!=null){if(e.geometryType()==="Point")return function(t,i){var u=[1/0,1/0,-1/0,-1/0],f=[1/0,1/0,-1/0,-1/0],m=t.canonicalID();if(i.type==="Polygon"){var x=Ua(i.coordinates,f,m),E=Ns(t.geometry(),u,f,m);if(!wa(u,f))return!1;for(var z=0,A=E;z<A.length;z+=1)if(!uo(A[z],x))return!1}if(i.type==="MultiPolygon"){var D=os(i.coordinates,f,m),B=Ns(t.geometry(),u,f,m);if(!wa(u,f))return!1;for(var q=0,G=B;q<G.length;q+=1)if(!Nl(G[q],D))return!1}return!0}(e,this.geometries);if(e.geometryType()==="LineString")return function(t,i){var u=[1/0,1/0,-1/0,-1/0],f=[1/0,1/0,-1/0,-1/0],m=t.canonicalID();if(i.type==="Polygon"){var x=Ua(i.coordinates,f,m),E=Va(t.geometry(),u,f,m);if(!wa(u,f))return!1;for(var z=0,A=E;z<A.length;z+=1)if(!Bo(A[z],x))return!1}if(i.type==="MultiPolygon"){var D=os(i.coordinates,f,m),B=Va(t.geometry(),u,f,m);if(!wa(u,f))return!1;for(var q=0,G=B;q<G.length;q+=1)if(!Os(G[q],D))return!1}return!0}(e,this.geometries)}return!1},Un.prototype.eachChild=function(){},Un.prototype.outputDefined=function(){return!0},Un.prototype.serialize=function(){return["within",this.geojson]};var Gi=function(e,t){this.type=t.type,this.name=e,this.boundExpression=t};Gi.parse=function(e,t){if(e.length!==2||typeof e[1]!="string")return t.error("'var' expression requires exactly one string literal argument.");var i=e[1];return t.scope.has(i)?new Gi(i,t.scope.get(i)):t.error('Unknown variable "'+i+'". Make sure "'+i+'" has been bound in an enclosing "let" expression before using it.',1)},Gi.prototype.evaluate=function(e){return this.boundExpression.evaluate(e)},Gi.prototype.eachChild=function(){},Gi.prototype.outputDefined=function(){return!1},Gi.prototype.serialize=function(){return["var",this.name]};var jr=function(e,t,i,u,f){t===void 0&&(t=[]),u===void 0&&(u=new st),f===void 0&&(f=[]),this.registry=e,this.path=t,this.key=t.map(function(m){return"["+m+"]"}).join(""),this.scope=u,this.errors=f,this.expectedType=i};function Ea(e,t){for(var i,u=e.length-1,f=0,m=u,x=0;f<=m;)if((i=e[x=Math.floor((f+m)/2)])<=t){if(x===u||t<e[x+1])return x;f=x+1}else{if(!(i>t))throw new oi("Input is not a number.");m=x-1}return 0}jr.prototype.parse=function(e,t,i,u,f){return f===void 0&&(f={}),t?this.concat(t,i,u)._parse(e,f):this._parse(e,f)},jr.prototype._parse=function(e,t){function i(A,D,B){return B==="assert"?new Ar(D,[A]):B==="coerce"?new Ti(D,[A]):A}if(e!==null&&typeof e!="string"&&typeof e!="boolean"&&typeof e!="number"||(e=["literal",e]),Array.isArray(e)){if(e.length===0)return this.error('Expected an array with at least one element. If you wanted a literal array, use ["literal", []].');var u=e[0];if(typeof u!="string")return this.error("Expression name must be a string, but found "+typeof u+' instead. If you wanted a literal array, use ["literal", [...]].',0),null;var f=this.registry[u];if(f){var m=f.parse(e,this);if(!m)return null;if(this.expectedType){var x=this.expectedType,E=m.type;if(x.kind!=="string"&&x.kind!=="number"&&x.kind!=="boolean"&&x.kind!=="object"&&x.kind!=="array"||E.kind!=="value")if(x.kind!=="color"&&x.kind!=="formatted"&&x.kind!=="resolvedImage"||E.kind!=="value"&&E.kind!=="string"){if(this.checkSubtype(x,E))return null}else m=i(m,x,t.typeAnnotation||"coerce");else m=i(m,x,t.typeAnnotation||"assert")}if(!(m instanceof ki)&&m.type.kind!=="resolvedImage"&&function A(D){if(D instanceof Gi)return A(D.boundExpression);if(D instanceof Ii&&D.name==="error"||D instanceof Qn||D instanceof Un)return!1;var B=D instanceof Ti||D instanceof Ar,q=!0;return D.eachChild(function(G){q=B?q&&A(G):q&&G instanceof ki}),!!q&&Sa(D)&&cn(D,["zoom","heatmap-density","line-progress","accumulated","is-supported-script"])}(m)){var z=new qi;try{m=new ki(m.type,m.evaluate(z))}catch(A){return this.error(A.message),null}}return m}return this.error('Unknown expression "'+u+'". If you wanted a literal array, use ["literal", [...]].',0)}return this.error(e===void 0?"'undefined' value invalid. Use null instead.":typeof e=="object"?'Bare objects invalid. Use ["literal", {...}] instead.':"Expected an array, but found "+typeof e+" instead.")},jr.prototype.concat=function(e,t,i){var u=typeof e=="number"?this.path.concat(e):this.path,f=i?this.scope.concat(i):this.scope;return new jr(this.registry,u,t||null,f,this.errors)},jr.prototype.error=function(e){for(var t=[],i=arguments.length-1;i-- >0;)t[i]=arguments[i+1];var u=""+this.key+t.map(function(f){return"["+f+"]"}).join("");this.errors.push(new De(u,e))},jr.prototype.checkSubtype=function(e,t){var i=dr(e,t);return i&&this.error(i),i};var Vn=function(e,t,i){this.type=e,this.input=t,this.labels=[],this.outputs=[];for(var u=0,f=i;u<f.length;u+=1){var m=f[u],x=m[1];this.labels.push(m[0]),this.outputs.push(x)}};function vi(e,t,i){return e*(1-i)+t*i}Vn.parse=function(e,t){if(e.length-1<4)return t.error("Expected at least 4 arguments, but found only "+(e.length-1)+".");if((e.length-1)%2!=0)return t.error("Expected an even number of arguments.");var i=t.parse(e[1],1,Se);if(!i)return null;var u=[],f=null;t.expectedType&&t.expectedType.kind!=="value"&&(f=t.expectedType);for(var m=1;m<e.length;m+=2){var x=m===1?-1/0:e[m],E=e[m+1],z=m,A=m+1;if(typeof x!="number")return t.error('Input/output pairs for "step" expressions must be defined using literal numeric values (not computed expressions) for the input values.',z);if(u.length&&u[u.length-1][0]>=x)return t.error('Input/output pairs for "step" expressions must be arranged with input values in strictly ascending order.',z);var D=t.parse(E,A,f);if(!D)return null;f=f||D.type,u.push([x,D])}return new Vn(f,i,u)},Vn.prototype.evaluate=function(e){var t=this.labels,i=this.outputs;if(t.length===1)return i[0].evaluate(e);var u=this.input.evaluate(e);if(u<=t[0])return i[0].evaluate(e);var f=t.length;return u>=t[f-1]?i[f-1].evaluate(e):i[Ea(t,u)].evaluate(e)},Vn.prototype.eachChild=function(e){e(this.input);for(var t=0,i=this.outputs;t<i.length;t+=1)e(i[t])},Vn.prototype.outputDefined=function(){return this.outputs.every(function(e){return e.outputDefined()})},Vn.prototype.serialize=function(){for(var e=["step",this.input.serialize()],t=0;t<this.labels.length;t++)t>0&&e.push(this.labels[t]),e.push(this.outputs[t].serialize());return e};var Fo=Object.freeze({__proto__:null,number:vi,color:function(e,t,i){return new lr(vi(e.r,t.r,i),vi(e.g,t.g,i),vi(e.b,t.b,i),vi(e.a,t.a,i))},array:function(e,t,i){return e.map(function(u,f){return vi(u,t[f],i)})}}),tc=6/29*3*(6/29),Lh=Math.PI/180,Rh=180/Math.PI;function Vl(e){return e>.008856451679035631?Math.pow(e,1/3):e/tc+4/29}function ql(e){return e>6/29?e*e*e:tc*(e-4/29)}function jl(e){return 255*(e<=.0031308?12.92*e:1.055*Math.pow(e,1/2.4)-.055)}function Gl(e){return(e/=255)<=.04045?e/12.92:Math.pow((e+.055)/1.055,2.4)}function rc(e){var t=Gl(e.r),i=Gl(e.g),u=Gl(e.b),f=Vl((.4124564*t+.3575761*i+.1804375*u)/.95047),m=Vl((.2126729*t+.7151522*i+.072175*u)/1);return{l:116*m-16,a:500*(f-m),b:200*(m-Vl((.0193339*t+.119192*i+.9503041*u)/1.08883)),alpha:e.a}}function ic(e){var t=(e.l+16)/116,i=isNaN(e.a)?t:t+e.a/500,u=isNaN(e.b)?t:t-e.b/200;return t=1*ql(t),i=.95047*ql(i),u=1.08883*ql(u),new lr(jl(3.2404542*i-1.5371385*t-.4985314*u),jl(-.969266*i+1.8760108*t+.041556*u),jl(.0556434*i-.2040259*t+1.0572252*u),e.alpha)}function Bh(e,t,i){var u=t-e;return e+i*(u>180||u<-180?u-360*Math.round(u/360):u)}var ss={forward:rc,reverse:ic,interpolate:function(e,t,i){return{l:vi(e.l,t.l,i),a:vi(e.a,t.a,i),b:vi(e.b,t.b,i),alpha:vi(e.alpha,t.alpha,i)}}},ls={forward:function(e){var t=rc(e),i=t.l,u=t.a,f=t.b,m=Math.atan2(f,u)*Rh;return{h:m<0?m+360:m,c:Math.sqrt(u*u+f*f),l:i,alpha:e.a}},reverse:function(e){var t=e.h*Lh,i=e.c;return ic({l:e.l,a:Math.cos(t)*i,b:Math.sin(t)*i,alpha:e.alpha})},interpolate:function(e,t,i){return{h:Bh(e.h,t.h,i),c:vi(e.c,t.c,i),l:vi(e.l,t.l,i),alpha:vi(e.alpha,t.alpha,i)}}},nc=Object.freeze({__proto__:null,lab:ss,hcl:ls}),en=function(e,t,i,u,f){this.type=e,this.operator=t,this.interpolation=i,this.input=u,this.labels=[],this.outputs=[];for(var m=0,x=f;m<x.length;m+=1){var E=x[m],z=E[1];this.labels.push(E[0]),this.outputs.push(z)}};function Zl(e,t,i,u){var f=u-i,m=e-i;return f===0?0:t===1?m/f:(Math.pow(t,m)-1)/(Math.pow(t,f)-1)}en.interpolationFactor=function(e,t,i,u){var f=0;if(e.name==="exponential")f=Zl(t,e.base,i,u);else if(e.name==="linear")f=Zl(t,1,i,u);else if(e.name==="cubic-bezier"){var m=e.controlPoints;f=new T(m[0],m[1],m[2],m[3]).solve(Zl(t,1,i,u))}return f},en.parse=function(e,t){var i=e[0],u=e[1],f=e[2],m=e.slice(3);if(!Array.isArray(u)||u.length===0)return t.error("Expected an interpolation type expression.",1);if(u[0]==="linear")u={name:"linear"};else if(u[0]==="exponential"){var x=u[1];if(typeof x!="number")return t.error("Exponential interpolation requires a numeric base.",1,1);u={name:"exponential",base:x}}else{if(u[0]!=="cubic-bezier")return t.error("Unknown interpolation type "+String(u[0]),1,0);var E=u.slice(1);if(E.length!==4||E.some(function(he){return typeof he!="number"||he<0||he>1}))return t.error("Cubic bezier interpolation requires four numeric arguments with values between 0 and 1.",1);u={name:"cubic-bezier",controlPoints:E}}if(e.length-1<4)return t.error("Expected at least 4 arguments, but found only "+(e.length-1)+".");if((e.length-1)%2!=0)return t.error("Expected an even number of arguments.");if(!(f=t.parse(f,2,Se)))return null;var z=[],A=null;i==="interpolate-hcl"||i==="interpolate-lab"?A=Qe:t.expectedType&&t.expectedType.kind!=="value"&&(A=t.expectedType);for(var D=0;D<m.length;D+=2){var B=m[D],q=m[D+1],G=D+3,J=D+4;if(typeof B!="number")return t.error('Input/output pairs for "interpolate" expressions must be defined using literal numeric values (not computed expressions) for the input values.',G);if(z.length&&z[z.length-1][0]>=B)return t.error('Input/output pairs for "interpolate" expressions must be arranged with input values in strictly ascending order.',G);var ee=t.parse(q,J,A);if(!ee)return null;A=A||ee.type,z.push([B,ee])}return A.kind==="number"||A.kind==="color"||A.kind==="array"&&A.itemType.kind==="number"&&typeof A.N=="number"?new en(A,i,u,f,z):t.error("Type "+er(A)+" is not interpolatable.")},en.prototype.evaluate=function(e){var t=this.labels,i=this.outputs;if(t.length===1)return i[0].evaluate(e);var u=this.input.evaluate(e);if(u<=t[0])return i[0].evaluate(e);var f=t.length;if(u>=t[f-1])return i[f-1].evaluate(e);var m=Ea(t,u),x=en.interpolationFactor(this.interpolation,u,t[m],t[m+1]),E=i[m].evaluate(e),z=i[m+1].evaluate(e);return this.operator==="interpolate"?Fo[this.type.kind.toLowerCase()](E,z,x):this.operator==="interpolate-hcl"?ls.reverse(ls.interpolate(ls.forward(E),ls.forward(z),x)):ss.reverse(ss.interpolate(ss.forward(E),ss.forward(z),x))},en.prototype.eachChild=function(e){e(this.input);for(var t=0,i=this.outputs;t<i.length;t+=1)e(i[t])},en.prototype.outputDefined=function(){return this.outputs.every(function(e){return e.outputDefined()})},en.prototype.serialize=function(){var e;e=this.interpolation.name==="linear"?["linear"]:this.interpolation.name==="exponential"?this.interpolation.base===1?["linear"]:["exponential",this.interpolation.base]:["cubic-bezier"].concat(this.interpolation.controlPoints);for(var t=[this.operator,e,this.input.serialize()],i=0;i<this.labels.length;i++)t.push(this.labels[i],this.outputs[i].serialize());return t};var qa=function(e,t){this.type=e,this.args=t};qa.parse=function(e,t){if(e.length<2)return t.error("Expectected at least one argument.");var i=null,u=t.expectedType;u&&u.kind!=="value"&&(i=u);for(var f=[],m=0,x=e.slice(1);m<x.length;m+=1){var E=t.parse(x[m],1+f.length,i,void 0,{typeAnnotation:"omit"});if(!E)return null;i=i||E.type,f.push(E)}var z=u&&f.some(function(A){return dr(u,A.type)});return new qa(z?it:i,f)},qa.prototype.evaluate=function(e){for(var t,i=null,u=0,f=0,m=this.args;f<m.length&&(u++,(i=m[f].evaluate(e))&&i instanceof Di&&!i.available&&(t||(t=i.name),i=null,u===this.args.length&&(i=t)),i===null);f+=1);return i},qa.prototype.eachChild=function(e){this.args.forEach(e)},qa.prototype.outputDefined=function(){return this.args.every(function(e){return e.outputDefined()})},qa.prototype.serialize=function(){var e=["coalesce"];return this.eachChild(function(t){e.push(t.serialize())}),e};var ja=function(e,t){this.type=t.type,this.bindings=[].concat(e),this.result=t};ja.prototype.evaluate=function(e){return this.result.evaluate(e)},ja.prototype.eachChild=function(e){for(var t=0,i=this.bindings;t<i.length;t+=1)e(i[t][1]);e(this.result)},ja.parse=function(e,t){if(e.length<4)return t.error("Expected at least 3 arguments, but found "+(e.length-1)+" instead.");for(var i=[],u=1;u<e.length-1;u+=2){var f=e[u];if(typeof f!="string")return t.error("Expected string, but found "+typeof f+" instead.",u);if(/[^a-zA-Z0-9_]/.test(f))return t.error("Variable names must contain only alphanumeric characters or '_'.",u);var m=t.parse(e[u+1],u+1);if(!m)return null;i.push([f,m])}var x=t.parse(e[e.length-1],e.length-1,t.expectedType,i);return x?new ja(i,x):null},ja.prototype.outputDefined=function(){return this.result.outputDefined()},ja.prototype.serialize=function(){for(var e=["let"],t=0,i=this.bindings;t<i.length;t+=1){var u=i[t];e.push(u[0],u[1].serialize())}return e.push(this.result.serialize()),e};var ho=function(e,t,i){this.type=e,this.index=t,this.input=i};ho.parse=function(e,t){if(e.length!==3)return t.error("Expected 2 arguments, but found "+(e.length-1)+" instead.");var i=t.parse(e[1],1,Se),u=t.parse(e[2],2,sr(t.expectedType||it));return i&&u?new ho(u.type.itemType,i,u):null},ho.prototype.evaluate=function(e){var t=this.index.evaluate(e),i=this.input.evaluate(e);if(t<0)throw new oi("Array index out of bounds: "+t+" < 0.");if(t>=i.length)throw new oi("Array index out of bounds: "+t+" > "+(i.length-1)+".");if(t!==Math.floor(t))throw new oi("Array index must be an integer, but found "+t+" instead.");return i[t]},ho.prototype.eachChild=function(e){e(this.index),e(this.input)},ho.prototype.outputDefined=function(){return!1},ho.prototype.serialize=function(){return["at",this.index.serialize(),this.input.serialize()]};var po=function(e,t){this.type=Ye,this.needle=e,this.haystack=t};po.parse=function(e,t){if(e.length!==3)return t.error("Expected 2 arguments, but found "+(e.length-1)+" instead.");var i=t.parse(e[1],1,it),u=t.parse(e[2],2,it);return i&&u?Fr(i.type,[Ye,He,Se,tt,it])?new po(i,u):t.error("Expected first argument to be of type boolean, string, number or null, but found "+er(i.type)+" instead"):null},po.prototype.evaluate=function(e){var t=this.needle.evaluate(e),i=this.haystack.evaluate(e);if(!i)return!1;if(!_r(t,["boolean","string","number","null"]))throw new oi("Expected first argument to be of type boolean, string, number or null, but found "+er(qr(t))+" instead.");if(!_r(i,["string","array"]))throw new oi("Expected second argument to be of type array or string, but found "+er(qr(i))+" instead.");return i.indexOf(t)>=0},po.prototype.eachChild=function(e){e(this.needle),e(this.haystack)},po.prototype.outputDefined=function(){return!0},po.prototype.serialize=function(){return["in",this.needle.serialize(),this.haystack.serialize()]};var Ga=function(e,t,i){this.type=Se,this.needle=e,this.haystack=t,this.fromIndex=i};Ga.parse=function(e,t){if(e.length<=2||e.length>=5)return t.error("Expected 3 or 4 arguments, but found "+(e.length-1)+" instead.");var i=t.parse(e[1],1,it),u=t.parse(e[2],2,it);if(!i||!u)return null;if(!Fr(i.type,[Ye,He,Se,tt,it]))return t.error("Expected first argument to be of type boolean, string, number or null, but found "+er(i.type)+" instead");if(e.length===4){var f=t.parse(e[3],3,Se);return f?new Ga(i,u,f):null}return new Ga(i,u)},Ga.prototype.evaluate=function(e){var t=this.needle.evaluate(e),i=this.haystack.evaluate(e);if(!_r(t,["boolean","string","number","null"]))throw new oi("Expected first argument to be of type boolean, string, number or null, but found "+er(qr(t))+" instead.");if(!_r(i,["string","array"]))throw new oi("Expected second argument to be of type array or string, but found "+er(qr(i))+" instead.");if(this.fromIndex){var u=this.fromIndex.evaluate(e);return i.indexOf(t,u)}return i.indexOf(t)},Ga.prototype.eachChild=function(e){e(this.needle),e(this.haystack),this.fromIndex&&e(this.fromIndex)},Ga.prototype.outputDefined=function(){return!1},Ga.prototype.serialize=function(){if(this.fromIndex!=null&&this.fromIndex!==void 0){var e=this.fromIndex.serialize();return["index-of",this.needle.serialize(),this.haystack.serialize(),e]}return["index-of",this.needle.serialize(),this.haystack.serialize()]};var fo=function(e,t,i,u,f,m){this.inputType=e,this.type=t,this.input=i,this.cases=u,this.outputs=f,this.otherwise=m};fo.parse=function(e,t){if(e.length<5)return t.error("Expected at least 4 arguments, but found only "+(e.length-1)+".");if(e.length%2!=1)return t.error("Expected an even number of arguments.");var i,u;t.expectedType&&t.expectedType.kind!=="value"&&(u=t.expectedType);for(var f={},m=[],x=2;x<e.length-1;x+=2){var E=e[x],z=e[x+1];Array.isArray(E)||(E=[E]);var A=t.concat(x);if(E.length===0)return A.error("Expected at least one branch label.");for(var D=0,B=E;D<B.length;D+=1){var q=B[D];if(typeof q!="number"&&typeof q!="string")return A.error("Branch labels must be numbers or strings.");if(typeof q=="number"&&Math.abs(q)>Number.MAX_SAFE_INTEGER)return A.error("Branch labels must be integers no larger than "+Number.MAX_SAFE_INTEGER+".");if(typeof q=="number"&&Math.floor(q)!==q)return A.error("Numeric branch labels must be integer values.");if(i){if(A.checkSubtype(i,qr(q)))return null}else i=qr(q);if(f[String(q)]!==void 0)return A.error("Branch labels must be unique.");f[String(q)]=m.length}var G=t.parse(z,x,u);if(!G)return null;u=u||G.type,m.push(G)}var J=t.parse(e[1],1,it);if(!J)return null;var ee=t.parse(e[e.length-1],e.length-1,u);return ee?J.type.kind!=="value"&&t.concat(1).checkSubtype(i,J.type)?null:new fo(i,u,J,f,m,ee):null},fo.prototype.evaluate=function(e){var t=this.input.evaluate(e);return(qr(t)===this.inputType&&this.outputs[this.cases[t]]||this.otherwise).evaluate(e)},fo.prototype.eachChild=function(e){e(this.input),this.outputs.forEach(e),e(this.otherwise)},fo.prototype.outputDefined=function(){return this.outputs.every(function(e){return e.outputDefined()})&&this.otherwise.outputDefined()},fo.prototype.serialize=function(){for(var e=this,t=["match",this.input.serialize()],i=[],u={},f=0,m=Object.keys(this.cases).sort();f<m.length;f+=1){var x=m[f];(B=u[this.cases[x]])===void 0?(u[this.cases[x]]=i.length,i.push([this.cases[x],[x]])):i[B][1].push(x)}for(var E=function(G){return e.inputType.kind==="number"?Number(G):G},z=0,A=i;z<A.length;z+=1){var D=A[z],B=D[0],q=D[1];t.push(q.length===1?E(q[0]):q.map(E)),t.push(this.outputs[outputIndex$1].serialize())}return t.push(this.otherwise.serialize()),t};var mo=function(e,t,i){this.type=e,this.branches=t,this.otherwise=i};mo.parse=function(e,t){if(e.length<4)return t.error("Expected at least 3 arguments, but found only "+(e.length-1)+".");if(e.length%2!=0)return t.error("Expected an odd number of arguments.");var i;t.expectedType&&t.expectedType.kind!=="value"&&(i=t.expectedType);for(var u=[],f=1;f<e.length-1;f+=2){var m=t.parse(e[f],f,Ye);if(!m)return null;var x=t.parse(e[f+1],f+1,i);if(!x)return null;u.push([m,x]),i=i||x.type}var E=t.parse(e[e.length-1],e.length-1,i);return E?new mo(i,u,E):null},mo.prototype.evaluate=function(e){for(var t=0,i=this.branches;t<i.length;t+=1){var u=i[t],f=u[1];if(u[0].evaluate(e))return f.evaluate(e)}return this.otherwise.evaluate(e)},mo.prototype.eachChild=function(e){for(var t=0,i=this.branches;t<i.length;t+=1){var u=i[t],f=u[1];e(u[0]),e(f)}e(this.otherwise)},mo.prototype.outputDefined=function(){return this.branches.every(function(e){return e[1].outputDefined()})&&this.otherwise.outputDefined()},mo.prototype.serialize=function(){var e=["case"];return this.eachChild(function(t){e.push(t.serialize())}),e};var Za=function(e,t,i,u){this.type=e,this.input=t,this.beginIndex=i,this.endIndex=u};function ac(e,t){return e==="=="||e==="!="?t.kind==="boolean"||t.kind==="string"||t.kind==="number"||t.kind==="null"||t.kind==="value":t.kind==="string"||t.kind==="number"||t.kind==="value"}function oc(e,t,i,u){return u.compare(t,i)===0}function Dr(e,t,i){var u=e!=="=="&&e!=="!=";return function(){function f(m,x,E){this.type=Ye,this.lhs=m,this.rhs=x,this.collator=E,this.hasUntypedArgument=m.type.kind==="value"||x.type.kind==="value"}return f.parse=function(m,x){if(m.length!==3&&m.length!==4)return x.error("Expected two or three arguments.");var E=m[0],z=x.parse(m[1],1,it);if(!z)return null;if(!ac(E,z.type))return x.concat(1).error('"'+E+`" comparisons are not supported for type '`+er(z.type)+"'.");var A=x.parse(m[2],2,it);if(!A)return null;if(!ac(E,A.type))return x.concat(2).error('"'+E+`" comparisons are not supported for type '`+er(A.type)+"'.");if(z.type.kind!==A.type.kind&&z.type.kind!=="value"&&A.type.kind!=="value")return x.error("Cannot compare types '"+er(z.type)+"' and '"+er(A.type)+"'.");u&&(z.type.kind==="value"&&A.type.kind!=="value"?z=new Ar(A.type,[z]):z.type.kind!=="value"&&A.type.kind==="value"&&(A=new Ar(z.type,[A])));var D=null;if(m.length===4){if(z.type.kind!=="string"&&A.type.kind!=="string"&&z.type.kind!=="value"&&A.type.kind!=="value")return x.error("Cannot use collator to compare non-string types.");if(!(D=x.parse(m[3],3,Wt)))return null}return new f(z,A,D)},f.prototype.evaluate=function(m){var x=this.lhs.evaluate(m),E=this.rhs.evaluate(m);if(u&&this.hasUntypedArgument){var z=qr(x),A=qr(E);if(z.kind!==A.kind||z.kind!=="string"&&z.kind!=="number")throw new oi('Expected arguments for "'+e+'" to be (string, string) or (number, number), but found ('+z.kind+", "+A.kind+") instead.")}if(this.collator&&!u&&this.hasUntypedArgument){var D=qr(x),B=qr(E);if(D.kind!=="string"||B.kind!=="string")return t(m,x,E)}return this.collator?i(m,x,E,this.collator.evaluate(m)):t(m,x,E)},f.prototype.eachChild=function(m){m(this.lhs),m(this.rhs),this.collator&&m(this.collator)},f.prototype.outputDefined=function(){return!0},f.prototype.serialize=function(){var m=[e];return this.eachChild(function(x){m.push(x.serialize())}),m},f}()}Za.parse=function(e,t){if(e.length<=2||e.length>=5)return t.error("Expected 3 or 4 arguments, but found "+(e.length-1)+" instead.");var i=t.parse(e[1],1,it),u=t.parse(e[2],2,Se);if(!i||!u)return null;if(!Fr(i.type,[sr(it),He,it]))return t.error("Expected first argument to be of type array or string, but found "+er(i.type)+" instead");if(e.length===4){var f=t.parse(e[3],3,Se);return f?new Za(i.type,i,u,f):null}return new Za(i.type,i,u)},Za.prototype.evaluate=function(e){var t=this.input.evaluate(e),i=this.beginIndex.evaluate(e);if(!_r(t,["string","array"]))throw new oi("Expected first argument to be of type array or string, but found "+er(qr(t))+" instead.");if(this.endIndex){var u=this.endIndex.evaluate(e);return t.slice(i,u)}return t.slice(i)},Za.prototype.eachChild=function(e){e(this.input),e(this.beginIndex),this.endIndex&&e(this.endIndex)},Za.prototype.outputDefined=function(){return!1},Za.prototype.serialize=function(){if(this.endIndex!=null&&this.endIndex!==void 0){var e=this.endIndex.serialize();return["slice",this.input.serialize(),this.beginIndex.serialize(),e]}return["slice",this.input.serialize(),this.beginIndex.serialize()]};var Fh=Dr("==",function(e,t,i){return t===i},oc),Us=Dr("!=",function(e,t,i){return t!==i},function(e,t,i,u){return!oc(0,t,i,u)}),sc=Dr("<",function(e,t,i){return t<i},function(e,t,i,u){return u.compare(t,i)<0}),lc=Dr(">",function(e,t,i){return t>i},function(e,t,i,u){return u.compare(t,i)>0}),uc=Dr("<=",function(e,t,i){return t<=i},function(e,t,i,u){return u.compare(t,i)<=0}),cc=Dr(">=",function(e,t,i){return t>=i},function(e,t,i,u){return u.compare(t,i)>=0}),yo=function(e,t,i,u,f){this.type=He,this.number=e,this.locale=t,this.currency=i,this.minFractionDigits=u,this.maxFractionDigits=f};yo.parse=function(e,t){if(e.length!==3)return t.error("Expected two arguments.");var i=t.parse(e[1],1,Se);if(!i)return null;var u=e[2];if(typeof u!="object"||Array.isArray(u))return t.error("NumberFormat options argument must be an object.");var f=null;if(u.locale&&!(f=t.parse(u.locale,1,He)))return null;var m=null;if(u.currency&&!(m=t.parse(u.currency,1,He)))return null;var x=null;if(u["min-fraction-digits"]&&!(x=t.parse(u["min-fraction-digits"],1,Se)))return null;var E=null;return u["max-fraction-digits"]&&!(E=t.parse(u["max-fraction-digits"],1,Se))?null:new yo(i,f,m,x,E)},yo.prototype.evaluate=function(e){return new Intl.NumberFormat(this.locale?this.locale.evaluate(e):[],{style:this.currency?"currency":"decimal",currency:this.currency?this.currency.evaluate(e):void 0,minimumFractionDigits:this.minFractionDigits?this.minFractionDigits.evaluate(e):void 0,maximumFractionDigits:this.maxFractionDigits?this.maxFractionDigits.evaluate(e):void 0}).format(this.number.evaluate(e))},yo.prototype.eachChild=function(e){e(this.number),this.locale&&e(this.locale),this.currency&&e(this.currency),this.minFractionDigits&&e(this.minFractionDigits),this.maxFractionDigits&&e(this.maxFractionDigits)},yo.prototype.outputDefined=function(){return!1},yo.prototype.serialize=function(){var e={};return this.locale&&(e.locale=this.locale.serialize()),this.currency&&(e.currency=this.currency.serialize()),this.minFractionDigits&&(e["min-fraction-digits"]=this.minFractionDigits.serialize()),this.maxFractionDigits&&(e["max-fraction-digits"]=this.maxFractionDigits.serialize()),["number-format",this.number.serialize(),e]};var Ka=function(e){this.type=Se,this.input=e};Ka.parse=function(e,t){if(e.length!==2)return t.error("Expected 1 argument, but found "+(e.length-1)+" instead.");var i=t.parse(e[1],1);return i?i.type.kind!=="array"&&i.type.kind!=="string"&&i.type.kind!=="value"?t.error("Expected argument of type string or array, but found "+er(i.type)+" instead."):new Ka(i):null},Ka.prototype.evaluate=function(e){var t=this.input.evaluate(e);if(typeof t=="string"||Array.isArray(t))return t.length;throw new oi("Expected value to be of type string or array, but found "+er(qr(t))+" instead.")},Ka.prototype.eachChild=function(e){e(this.input)},Ka.prototype.outputDefined=function(){return!1},Ka.prototype.serialize=function(){var e=["length"];return this.eachChild(function(t){e.push(t.serialize())}),e};var go={"==":Fh,"!=":Us,">":lc,"<":sc,">=":cc,"<=":uc,array:Ar,at:ho,boolean:Ar,case:mo,coalesce:qa,collator:Qn,format:Nn,image:gn,in:po,"index-of":Ga,interpolate:en,"interpolate-hcl":en,"interpolate-lab":en,length:Ka,let:ja,literal:ki,match:fo,number:Ar,"number-format":yo,object:Ar,slice:Za,step:Vn,string:Ar,"to-boolean":Ti,"to-color":Ti,"to-number":Ti,"to-string":Ti,var:Gi,within:Un};function hc(e,t){var i=t[0],u=t[1],f=t[2],m=t[3];i=i.evaluate(e),u=u.evaluate(e),f=f.evaluate(e);var x=m?m.evaluate(e):1,E=Na(i,u,f,x);if(E)throw new oi(E);return new lr(i/255*x,u/255*x,f/255*x,x)}function pc(e,t){return e in t}function Kl(e,t){var i=t[e];return i===void 0?null:i}function _o(e){return{type:e}}function fc(e){return{result:"success",value:e}}function vo(e){return{result:"error",value:e}}function bo(e){return e["property-type"]==="data-driven"||e["property-type"]==="cross-faded-data-driven"}function dc(e){return!!e.expression&&e.expression.parameters.indexOf("zoom")>-1}function us(e){return!!e.expression&&e.expression.interpolated}function Or(e){return e instanceof Number?"number":e instanceof String?"string":e instanceof Boolean?"boolean":Array.isArray(e)?"array":e===null?"null":typeof e}function Vs(e){return typeof e=="object"&&e!==null&&!Array.isArray(e)}function Oh(e){return e}function Oo(e,t,i){return e!==void 0?e:t!==void 0?t:i!==void 0?i:void 0}function mc(e,t,i,u,f){return Oo(typeof i===f?u[i]:void 0,e.default,t.default)}function Nh(e,t,i){if(Or(i)!=="number")return Oo(e.default,t.default);var u=e.stops.length;if(u===1||i<=e.stops[0][0])return e.stops[0][1];if(i>=e.stops[u-1][0])return e.stops[u-1][1];var f=Ea(e.stops.map(function(m){return m[0]}),i);return e.stops[f][1]}function yc(e,t,i){var u=e.base!==void 0?e.base:1;if(Or(i)!=="number")return Oo(e.default,t.default);var f=e.stops.length;if(f===1||i<=e.stops[0][0])return e.stops[0][1];if(i>=e.stops[f-1][0])return e.stops[f-1][1];var m=Ea(e.stops.map(function(B){return B[0]}),i),x=function(B,q,G,J){var ee=J-G,he=B-G;return ee===0?0:q===1?he/ee:(Math.pow(q,he)-1)/(Math.pow(q,ee)-1)}(i,u,e.stops[m][0],e.stops[m+1][0]),E=e.stops[m][1],z=e.stops[m+1][1],A=Fo[t.type]||Oh;if(e.colorSpace&&e.colorSpace!=="rgb"){var D=nc[e.colorSpace];A=function(B,q){return D.reverse(D.interpolate(D.forward(B),D.forward(q),x))}}return typeof E.evaluate=="function"?{evaluate:function(){for(var B=[],q=arguments.length;q--;)B[q]=arguments[q];var G=E.evaluate.apply(void 0,B),J=z.evaluate.apply(void 0,B);if(G!==void 0&&J!==void 0)return A(G,J,x)}}:A(E,z,x)}function qs(e,t,i){return t.type==="color"?i=lr.parse(i):t.type==="formatted"?i=ai.fromString(i.toString()):t.type==="resolvedImage"?i=Di.fromString(i.toString()):Or(i)===t.type||t.type==="enum"&&t.values[i]||(i=void 0),Oo(i,e.default,t.default)}Ii.register(go,{error:[{kind:"error"},[He],function(e,t){throw new oi(t[0].evaluate(e))}],typeof:[He,[it],function(e,t){return er(qr(t[0].evaluate(e)))}],"to-rgba":[sr(Se,4),[Qe],function(e,t){return t[0].evaluate(e).toArray()}],rgb:[Qe,[Se,Se,Se],hc],rgba:[Qe,[Se,Se,Se,Se],hc],has:{type:Ye,overloads:[[[He],function(e,t){return pc(t[0].evaluate(e),e.properties())}],[[He,Vt],function(e,t){var i=t[1];return pc(t[0].evaluate(e),i.evaluate(e))}]]},get:{type:it,overloads:[[[He],function(e,t){return Kl(t[0].evaluate(e),e.properties())}],[[He,Vt],function(e,t){var i=t[1];return Kl(t[0].evaluate(e),i.evaluate(e))}]]},"feature-state":[it,[He],function(e,t){return Kl(t[0].evaluate(e),e.featureState||{})}],properties:[Vt,[],function(e){return e.properties()}],"geometry-type":[He,[],function(e){return e.geometryType()}],id:[it,[],function(e){return e.id()}],zoom:[Se,[],function(e){return e.globals.zoom}],"heatmap-density":[Se,[],function(e){return e.globals.heatmapDensity||0}],"line-progress":[Se,[],function(e){return e.globals.lineProgress||0}],accumulated:[it,[],function(e){return e.globals.accumulated===void 0?null:e.globals.accumulated}],"+":[Se,_o(Se),function(e,t){for(var i=0,u=0,f=t;u<f.length;u+=1)i+=f[u].evaluate(e);return i}],"*":[Se,_o(Se),function(e,t){for(var i=1,u=0,f=t;u<f.length;u+=1)i*=f[u].evaluate(e);return i}],"-":{type:Se,overloads:[[[Se,Se],function(e,t){var i=t[1];return t[0].evaluate(e)-i.evaluate(e)}],[[Se],function(e,t){return-t[0].evaluate(e)}]]},"/":[Se,[Se,Se],function(e,t){var i=t[1];return t[0].evaluate(e)/i.evaluate(e)}],"%":[Se,[Se,Se],function(e,t){var i=t[1];return t[0].evaluate(e)%i.evaluate(e)}],ln2:[Se,[],function(){return Math.LN2}],pi:[Se,[],function(){return Math.PI}],e:[Se,[],function(){return Math.E}],"^":[Se,[Se,Se],function(e,t){var i=t[1];return Math.pow(t[0].evaluate(e),i.evaluate(e))}],sqrt:[Se,[Se],function(e,t){return Math.sqrt(t[0].evaluate(e))}],log10:[Se,[Se],function(e,t){return Math.log(t[0].evaluate(e))/Math.LN10}],ln:[Se,[Se],function(e,t){return Math.log(t[0].evaluate(e))}],log2:[Se,[Se],function(e,t){return Math.log(t[0].evaluate(e))/Math.LN2}],sin:[Se,[Se],function(e,t){return Math.sin(t[0].evaluate(e))}],cos:[Se,[Se],function(e,t){return Math.cos(t[0].evaluate(e))}],tan:[Se,[Se],function(e,t){return Math.tan(t[0].evaluate(e))}],asin:[Se,[Se],function(e,t){return Math.asin(t[0].evaluate(e))}],acos:[Se,[Se],function(e,t){return Math.acos(t[0].evaluate(e))}],atan:[Se,[Se],function(e,t){return Math.atan(t[0].evaluate(e))}],min:[Se,_o(Se),function(e,t){return Math.min.apply(Math,t.map(function(i){return i.evaluate(e)}))}],max:[Se,_o(Se),function(e,t){return Math.max.apply(Math,t.map(function(i){return i.evaluate(e)}))}],abs:[Se,[Se],function(e,t){return Math.abs(t[0].evaluate(e))}],round:[Se,[Se],function(e,t){var i=t[0].evaluate(e);return i<0?-Math.round(-i):Math.round(i)}],floor:[Se,[Se],function(e,t){return Math.floor(t[0].evaluate(e))}],ceil:[Se,[Se],function(e,t){return Math.ceil(t[0].evaluate(e))}],"filter-==":[Ye,[He,it],function(e,t){var i=t[0],u=t[1];return e.properties()[i.value]===u.value}],"filter-id-==":[Ye,[it],function(e,t){var i=t[0];return e.id()===i.value}],"filter-type-==":[Ye,[He],function(e,t){var i=t[0];return e.geometryType()===i.value}],"filter-<":[Ye,[He,it],function(e,t){var i=t[0],u=t[1],f=e.properties()[i.value],m=u.value;return typeof f==typeof m&&f<m}],"filter-id-<":[Ye,[it],function(e,t){var i=t[0],u=e.id(),f=i.value;return typeof u==typeof f&&u<f}],"filter->":[Ye,[He,it],function(e,t){var i=t[0],u=t[1],f=e.properties()[i.value],m=u.value;return typeof f==typeof m&&f>m}],"filter-id->":[Ye,[it],function(e,t){var i=t[0],u=e.id(),f=i.value;return typeof u==typeof f&&u>f}],"filter-<=":[Ye,[He,it],function(e,t){var i=t[0],u=t[1],f=e.properties()[i.value],m=u.value;return typeof f==typeof m&&f<=m}],"filter-id-<=":[Ye,[it],function(e,t){var i=t[0],u=e.id(),f=i.value;return typeof u==typeof f&&u<=f}],"filter->=":[Ye,[He,it],function(e,t){var i=t[0],u=t[1],f=e.properties()[i.value],m=u.value;return typeof f==typeof m&&f>=m}],"filter-id->=":[Ye,[it],function(e,t){var i=t[0],u=e.id(),f=i.value;return typeof u==typeof f&&u>=f}],"filter-has":[Ye,[it],function(e,t){return t[0].value in e.properties()}],"filter-has-id":[Ye,[],function(e){return e.id()!==null&&e.id()!==void 0}],"filter-type-in":[Ye,[sr(He)],function(e,t){return t[0].value.indexOf(e.geometryType())>=0}],"filter-id-in":[Ye,[sr(it)],function(e,t){return t[0].value.indexOf(e.id())>=0}],"filter-in-small":[Ye,[He,sr(it)],function(e,t){var i=t[0];return t[1].value.indexOf(e.properties()[i.value])>=0}],"filter-in-large":[Ye,[He,sr(it)],function(e,t){var i=t[0],u=t[1];return function(f,m,x,E){for(;x<=E;){var z=x+E>>1;if(m[z]===f)return!0;m[z]>f?E=z-1:x=z+1}return!1}(e.properties()[i.value],u.value,0,u.value.length-1)}],all:{type:Ye,overloads:[[[Ye,Ye],function(e,t){var i=t[1];return t[0].evaluate(e)&&i.evaluate(e)}],[_o(Ye),function(e,t){for(var i=0,u=t;i<u.length;i+=1)if(!u[i].evaluate(e))return!1;return!0}]]},any:{type:Ye,overloads:[[[Ye,Ye],function(e,t){var i=t[1];return t[0].evaluate(e)||i.evaluate(e)}],[_o(Ye),function(e,t){for(var i=0,u=t;i<u.length;i+=1)if(u[i].evaluate(e))return!0;return!1}]]},"!":[Ye,[Ye],function(e,t){return!t[0].evaluate(e)}],"is-supported-script":[Ye,[He],function(e,t){var i=e.globals&&e.globals.isSupportedScript;return!i||i(t[0].evaluate(e))}],upcase:[He,[He],function(e,t){return t[0].evaluate(e).toUpperCase()}],downcase:[He,[He],function(e,t){return t[0].evaluate(e).toLowerCase()}],concat:[He,_o(it),function(e,t){return t.map(function(i){return ba(i.evaluate(e))}).join("")}],"resolved-locale":[He,[Wt],function(e,t){return t[0].evaluate(e).resolvedLocale()}]});var No=function(e,t){this.expression=e,this._warningHistory={},this._evaluator=new qi,this._defaultValue=t?function(i){return i.type==="color"&&Vs(i.default)?new lr(0,0,0,0):i.type==="color"?lr.parse(i.default)||null:i.default===void 0?null:i.default}(t):null,this._enumValues=t&&t.type==="enum"?t.values:null};function cs(e){return Array.isArray(e)&&e.length>0&&typeof e[0]=="string"&&e[0]in go}function js(e,t){var i=new jr(go,[],t?function(f){var m={color:Qe,string:He,number:Se,enum:He,boolean:Ye,formatted:jt,resolvedImage:Ht};return f.type==="array"?sr(m[f.value]||it,f.length):m[f.type]}(t):void 0),u=i.parse(e,void 0,void 0,void 0,t&&t.type==="string"?{typeAnnotation:"coerce"}:void 0);return u?fc(new No(u,t)):vo(i.errors)}No.prototype.evaluateWithoutErrorHandling=function(e,t,i,u,f,m){return this._evaluator.globals=e,this._evaluator.feature=t,this._evaluator.featureState=i,this._evaluator.canonical=u,this._evaluator.availableImages=f||null,this._evaluator.formattedSection=m,this.expression.evaluate(this._evaluator)},No.prototype.evaluate=function(e,t,i,u,f,m){this._evaluator.globals=e,this._evaluator.feature=t||null,this._evaluator.featureState=i||null,this._evaluator.canonical=u,this._evaluator.availableImages=f||null,this._evaluator.formattedSection=m||null;try{var x=this.expression.evaluate(this._evaluator);if(x==null||typeof x=="number"&&x!=x)return this._defaultValue;if(this._enumValues&&!(x in this._enumValues))throw new oi("Expected value to be one of "+Object.keys(this._enumValues).map(function(E){return JSON.stringify(E)}).join(", ")+", but found "+JSON.stringify(x)+" instead.");return x}catch(E){return this._warningHistory[E.message]||(this._warningHistory[E.message]=!0,typeof console<"u"&&console.warn(E.message)),this._defaultValue}};var hs=function(e,t){this.kind=e,this._styleExpression=t,this.isStateDependent=e!=="constant"&&!_e(t.expression)};hs.prototype.evaluateWithoutErrorHandling=function(e,t,i,u,f,m){return this._styleExpression.evaluateWithoutErrorHandling(e,t,i,u,f,m)},hs.prototype.evaluate=function(e,t,i,u,f,m){return this._styleExpression.evaluate(e,t,i,u,f,m)};var Uo=function(e,t,i,u){this.kind=e,this.zoomStops=i,this._styleExpression=t,this.isStateDependent=e!=="camera"&&!_e(t.expression),this.interpolationType=u};function gc(e,t){if((e=js(e,t)).result==="error")return e;var i=e.value.expression,u=Sa(i);if(!u&&!bo(t))return vo([new De("","data expressions not supported")]);var f=cn(i,["zoom"]);if(!f&&!dc(t))return vo([new De("","zoom expressions not supported")]);var m=function x(E){var z=null;if(E instanceof ja)z=x(E.result);else if(E instanceof qa)for(var A=0,D=E.args;A<D.length&&!(z=x(D[A]));A+=1);else(E instanceof Vn||E instanceof en)&&E.input instanceof Ii&&E.input.name==="zoom"&&(z=E);return z instanceof De||E.eachChild(function(B){var q=x(B);q instanceof De?z=q:!z&&q?z=new De("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.'):z&&q&&z!==q&&(z=new De("",'Only one zoom-based "step" or "interpolate" subexpression may be used in an expression.'))}),z}(i);return m||f?m instanceof De?vo([m]):m instanceof en&&!us(t)?vo([new De("",'"interpolate" expressions cannot be used with this property')]):fc(m?new Uo(u?"camera":"composite",e.value,m.labels,m instanceof en?m.interpolation:void 0):new hs(u?"constant":"source",e.value)):vo([new De("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.')])}Uo.prototype.evaluateWithoutErrorHandling=function(e,t,i,u,f,m){return this._styleExpression.evaluateWithoutErrorHandling(e,t,i,u,f,m)},Uo.prototype.evaluate=function(e,t,i,u,f,m){return this._styleExpression.evaluate(e,t,i,u,f,m)},Uo.prototype.interpolationFactor=function(e,t,i){return this.interpolationType?en.interpolationFactor(this.interpolationType,e,t,i):0};var Vo=function(e,t){this._parameters=e,this._specification=t,Ce(this,function i(u,f){var m,x,E,z=f.type==="color",A=u.stops&&typeof u.stops[0][0]=="object",D=A||!(A||u.property!==void 0),B=u.type||(us(f)?"exponential":"interval");if(z&&((u=Ce({},u)).stops&&(u.stops=u.stops.map(function(lt){return[lt[0],lr.parse(lt[1])]})),u.default=lr.parse(u.default?u.default:f.default)),u.colorSpace&&u.colorSpace!=="rgb"&&!nc[u.colorSpace])throw new Error("Unknown color space: "+u.colorSpace);if(B==="exponential")m=yc;else if(B==="interval")m=Nh;else if(B==="categorical"){m=mc,x=Object.create(null);for(var q=0,G=u.stops;q<G.length;q+=1){var J=G[q];x[J[0]]=J[1]}E=typeof u.stops[0][0]}else{if(B!=="identity")throw new Error('Unknown function type "'+B+'"');m=qs}if(A){for(var ee={},he=[],oe=0;oe<u.stops.length;oe++){var ye=u.stops[oe],be=ye[0].zoom;ee[be]===void 0&&(ee[be]={zoom:be,type:u.type,property:u.property,default:u.default,stops:[]},he.push(be)),ee[be].stops.push([ye[0].value,ye[1]])}for(var Ee=[],Te=0,Me=he;Te<Me.length;Te+=1){var Ke=Me[Te];Ee.push([ee[Ke].zoom,i(ee[Ke],f)])}var $e={name:"linear"};return{kind:"composite",interpolationType:$e,interpolationFactor:en.interpolationFactor.bind(void 0,$e),zoomStops:Ee.map(function(lt){return lt[0]}),evaluate:function(lt,kt){var ut=lt.zoom;return yc({stops:Ee,base:u.base},f,ut).evaluate(ut,kt)}}}if(D){var bt=B==="exponential"?{name:"exponential",base:u.base!==void 0?u.base:1}:null;return{kind:"camera",interpolationType:bt,interpolationFactor:en.interpolationFactor.bind(void 0,bt),zoomStops:u.stops.map(function(lt){return lt[0]}),evaluate:function(lt){return m(u,f,lt.zoom,x,E)}}}return{kind:"source",evaluate:function(lt,kt){var ut=kt&&kt.properties?kt.properties[u.property]:void 0;return ut===void 0?Oo(u.default,f.default):m(u,f,ut,x,E)}}}(this._parameters,this._specification))};function fa(e){var t=e.key,i=e.value,u=e.valueSpec||{},f=e.objectElementValidators||{},m=e.style,x=e.styleSpec,E=[],z=Or(i);if(z!=="object")return[new $(t,i,"object expected, "+z+" found")];for(var A in i){var D=A.split(".")[0],B=u[D]||u["*"],q=void 0;if(f[D])q=f[D];else if(u[D])q=fr;else if(f["*"])q=f["*"];else{if(!u["*"]){E.push(new $(t,i[A],'unknown property "'+A+'"'));continue}q=fr}E=E.concat(q({key:(t&&t+".")+A,value:i[A],valueSpec:B,style:m,styleSpec:x,object:i,objectKey:A},i))}for(var G in u)f[G]||u[G].required&&u[G].default===void 0&&i[G]===void 0&&E.push(new $(t,i,'missing required property "'+G+'"'));return E}function _c(e){var t=e.value,i=e.valueSpec,u=e.style,f=e.styleSpec,m=e.key,x=e.arrayElementValidator||fr;if(Or(t)!=="array")return[new $(m,t,"array expected, "+Or(t)+" found")];if(i.length&&t.length!==i.length)return[new $(m,t,"array length "+i.length+" expected, length "+t.length+" found")];if(i["min-length"]&&t.length<i["min-length"])return[new $(m,t,"array length at least "+i["min-length"]+" expected, length "+t.length+" found")];var E={type:i.value,values:i.values};f.$version<7&&(E.function=i.function),Or(i.value)==="object"&&(E=i.value);for(var z=[],A=0;A<t.length;A++)z=z.concat(x({array:t,arrayIndex:A,value:t[A],valueSpec:E,style:u,styleSpec:f,key:m+"["+A+"]"}));return z}function vc(e){var t=e.key,i=e.value,u=e.valueSpec,f=Or(i);return f==="number"&&i!=i&&(f="NaN"),f!=="number"?[new $(t,i,"number expected, "+f+" found")]:"minimum"in u&&i<u.minimum?[new $(t,i,i+" is less than the minimum value "+u.minimum)]:"maximum"in u&&i>u.maximum?[new $(t,i,i+" is greater than the maximum value "+u.maximum)]:[]}function bc(e){var t,i,u,f=e.valueSpec,m=Oe(e.value.type),x={},E=m!=="categorical"&&e.value.property===void 0,z=!E,A=Or(e.value.stops)==="array"&&Or(e.value.stops[0])==="array"&&Or(e.value.stops[0][0])==="object",D=fa({key:e.key,value:e.value,valueSpec:e.styleSpec.function,style:e.style,styleSpec:e.styleSpec,objectElementValidators:{stops:function(G){if(m==="identity")return[new $(G.key,G.value,'identity function may not have a "stops" property')];var J=[],ee=G.value;return J=J.concat(_c({key:G.key,value:ee,valueSpec:G.valueSpec,style:G.style,styleSpec:G.styleSpec,arrayElementValidator:B})),Or(ee)==="array"&&ee.length===0&&J.push(new $(G.key,ee,"array must have at least one stop")),J},default:function(G){return fr({key:G.key,value:G.value,valueSpec:f,style:G.style,styleSpec:G.styleSpec})}}});return m==="identity"&&E&&D.push(new $(e.key,e.value,'missing required property "property"')),m==="identity"||e.value.stops||D.push(new $(e.key,e.value,'missing required property "stops"')),m==="exponential"&&e.valueSpec.expression&&!us(e.valueSpec)&&D.push(new $(e.key,e.value,"exponential functions not supported")),e.styleSpec.$version>=8&&(z&&!bo(e.valueSpec)?D.push(new $(e.key,e.value,"property functions not supported")):E&&!dc(e.valueSpec)&&D.push(new $(e.key,e.value,"zoom functions not supported"))),m!=="categorical"&&!A||e.value.property!==void 0||D.push(new $(e.key,e.value,'"property" property is required')),D;function B(G){var J=[],ee=G.value,he=G.key;if(Or(ee)!=="array")return[new $(he,ee,"array expected, "+Or(ee)+" found")];if(ee.length!==2)return[new $(he,ee,"array length 2 expected, length "+ee.length+" found")];if(A){if(Or(ee[0])!=="object")return[new $(he,ee,"object expected, "+Or(ee[0])+" found")];if(ee[0].zoom===void 0)return[new $(he,ee,"object stop key must have zoom")];if(ee[0].value===void 0)return[new $(he,ee,"object stop key must have value")];if(u&&u>Oe(ee[0].zoom))return[new $(he,ee[0].zoom,"stop zoom values must appear in ascending order")];Oe(ee[0].zoom)!==u&&(u=Oe(ee[0].zoom),i=void 0,x={}),J=J.concat(fa({key:he+"[0]",value:ee[0],valueSpec:{zoom:{}},style:G.style,styleSpec:G.styleSpec,objectElementValidators:{zoom:vc,value:q}}))}else J=J.concat(q({key:he+"[0]",value:ee[0],valueSpec:{},style:G.style,styleSpec:G.styleSpec},ee));return cs(we(ee[1]))?J.concat([new $(he+"[1]",ee[1],"expressions are not allowed in function stops.")]):J.concat(fr({key:he+"[1]",value:ee[1],valueSpec:f,style:G.style,styleSpec:G.styleSpec}))}function q(G,J){var ee=Or(G.value),he=Oe(G.value),oe=G.value!==null?G.value:J;if(t){if(ee!==t)return[new $(G.key,oe,ee+" stop domain type must match previous stop domain type "+t)]}else t=ee;if(ee!=="number"&&ee!=="string"&&ee!=="boolean")return[new $(G.key,oe,"stop domain value must be a number, string, or boolean")];if(ee!=="number"&&m!=="categorical"){var ye="number expected, "+ee+" found";return bo(f)&&m===void 0&&(ye+='\nIf you intended to use a categorical function, specify `"type": "categorical"`.'),[new $(G.key,oe,ye)]}return m!=="categorical"||ee!=="number"||isFinite(he)&&Math.floor(he)===he?m!=="categorical"&&ee==="number"&&i!==void 0&&he<i?[new $(G.key,oe,"stop domain values must appear in ascending order")]:(i=he,m==="categorical"&&he in x?[new $(G.key,oe,"stop domain values must be unique")]:(x[he]=!0,[])):[new $(G.key,oe,"integer expected, found "+he)]}}function xo(e){var t=(e.expressionContext==="property"?gc:js)(we(e.value),e.valueSpec);if(t.result==="error")return t.value.map(function(u){return new $(""+e.key+u.key,e.value,u.message)});var i=t.value.expression||t.value._styleExpression.expression;if(e.expressionContext==="property"&&e.propertyKey==="text-font"&&!i.outputDefined())return[new $(e.key,e.value,'Invalid data expression for "'+e.propertyKey+'". Output values must be contained as literals within the expression.')];if(e.expressionContext==="property"&&e.propertyType==="layout"&&!_e(i))return[new $(e.key,e.value,'"feature-state" data expressions are not supported with layout properties.')];if(e.expressionContext==="filter"&&!_e(i))return[new $(e.key,e.value,'"feature-state" data expressions are not supported with filters.')];if(e.expressionContext&&e.expressionContext.indexOf("cluster")===0){if(!cn(i,["zoom","feature-state"]))return[new $(e.key,e.value,'"zoom" and "feature-state" expressions are not supported with cluster properties.')];if(e.expressionContext==="cluster-initial"&&!Sa(i))return[new $(e.key,e.value,"Feature data expressions are not supported with initial expression part of cluster properties.")]}return[]}function ps(e){var t=e.key,i=e.value,u=e.valueSpec,f=[];return Array.isArray(u.values)?u.values.indexOf(Oe(i))===-1&&f.push(new $(t,i,"expected one of ["+u.values.join(", ")+"], "+JSON.stringify(i)+" found")):Object.keys(u.values).indexOf(Oe(i))===-1&&f.push(new $(t,i,"expected one of ["+Object.keys(u.values).join(", ")+"], "+JSON.stringify(i)+" found")),f}function Gs(e){if(e===!0||e===!1)return!0;if(!Array.isArray(e)||e.length===0)return!1;switch(e[0]){case"has":return e.length>=2&&e[1]!=="$id"&&e[1]!=="$type";case"in":return e.length>=3&&(typeof e[1]!="string"||Array.isArray(e[2]));case"!in":case"!has":case"none":return!1;case"==":case"!=":case">":case">=":case"<":case"<=":return e.length!==3||Array.isArray(e[1])||Array.isArray(e[2]);case"any":case"all":for(var t=0,i=e.slice(1);t<i.length;t+=1){var u=i[t];if(!Gs(u)&&typeof u!="boolean")return!1}return!0;default:return!0}}Vo.deserialize=function(e){return new Vo(e._parameters,e._specification)},Vo.serialize=function(e){return{_parameters:e._parameters,_specification:e._specification}};var Hl={type:"boolean",default:!1,transition:!1,"property-type":"data-driven",expression:{interpolated:!1,parameters:["zoom","feature"]}};function Zs(e){if(e==null)return{filter:function(){return!0},needGeometry:!1};Gs(e)||(e=Ks(e));var t=js(e,Hl);if(t.result==="error")throw new Error(t.value.map(function(i){return i.key+": "+i.message}).join(", "));return{filter:function(i,u,f){return t.value.evaluate(i,u,{},f)},needGeometry:function i(u){if(!Array.isArray(u))return!1;if(u[0]==="within")return!0;for(var f=1;f<u.length;f++)if(i(u[f]))return!0;return!1}(e)}}function Uh(e,t){return e<t?-1:e>t?1:0}function Ks(e){if(!e)return!0;var t,i=e[0];return e.length<=1?i!=="any":i==="=="?Xl(e[1],e[2],"=="):i==="!="?Hs(Xl(e[1],e[2],"==")):i==="<"||i===">"||i==="<="||i===">="?Xl(e[1],e[2],i):i==="any"?(t=e.slice(1),["any"].concat(t.map(Ks))):i==="all"?["all"].concat(e.slice(1).map(Ks)):i==="none"?["all"].concat(e.slice(1).map(Ks).map(Hs)):i==="in"?xc(e[1],e.slice(2)):i==="!in"?Hs(xc(e[1],e.slice(2))):i==="has"?wc(e[1]):i==="!has"?Hs(wc(e[1])):i!=="within"||e}function Xl(e,t,i){switch(e){case"$type":return["filter-type-"+i,t];case"$id":return["filter-id-"+i,t];default:return["filter-"+i,e,t]}}function xc(e,t){if(t.length===0)return!1;switch(e){case"$type":return["filter-type-in",["literal",t]];case"$id":return["filter-id-in",["literal",t]];default:return t.length>200&&!t.some(function(i){return typeof i!=typeof t[0]})?["filter-in-large",e,["literal",t.sort(Uh)]]:["filter-in-small",e,["literal",t]]}}function wc(e){switch(e){case"$type":return!0;case"$id":return["filter-has-id"];default:return["filter-has",e]}}function Hs(e){return["!",e]}function Wl(e){return Gs(we(e.value))?xo(Ce({},e,{expressionContext:"filter",valueSpec:{value:"boolean"}})):function t(i){var u=i.value,f=i.key;if(Or(u)!=="array")return[new $(f,u,"array expected, "+Or(u)+" found")];var m,x=i.styleSpec,E=[];if(u.length<1)return[new $(f,u,"filter array must have at least 1 element")];switch(E=E.concat(ps({key:f+"[0]",value:u[0],valueSpec:x.filter_operator,style:i.style,styleSpec:i.styleSpec})),Oe(u[0])){case"<":case"<=":case">":case">=":u.length>=2&&Oe(u[1])==="$type"&&E.push(new $(f,u,'"$type" cannot be use with operator "'+u[0]+'"'));case"==":case"!=":u.length!==3&&E.push(new $(f,u,'filter array for operator "'+u[0]+'" must have 3 elements'));case"in":case"!in":u.length>=2&&(m=Or(u[1]))!=="string"&&E.push(new $(f+"[1]",u[1],"string expected, "+m+" found"));for(var z=2;z<u.length;z++)m=Or(u[z]),Oe(u[1])==="$type"?E=E.concat(ps({key:f+"["+z+"]",value:u[z],valueSpec:x.geometry_type,style:i.style,styleSpec:i.styleSpec})):m!=="string"&&m!=="number"&&m!=="boolean"&&E.push(new $(f+"["+z+"]",u[z],"string, number, or boolean expected, "+m+" found"));break;case"any":case"all":case"none":for(var A=1;A<u.length;A++)E=E.concat(t({key:f+"["+A+"]",value:u[A],style:i.style,styleSpec:i.styleSpec}));break;case"has":case"!has":m=Or(u[1]),u.length!==2?E.push(new $(f,u,'filter array for "'+u[0]+'" operator must have 2 elements')):m!=="string"&&E.push(new $(f+"[1]",u[1],"string expected, "+m+" found"));break;case"within":m=Or(u[1]),u.length!==2?E.push(new $(f,u,'filter array for "'+u[0]+'" operator must have 2 elements')):m!=="object"&&E.push(new $(f+"[1]",u[1],"object expected, "+m+" found"))}return E}(e)}function Yl(e,t){var i=e.key,u=e.style,f=e.styleSpec,m=e.value,x=e.objectKey,E=f[t+"_"+e.layerType];if(!E)return[];var z=x.match(/^(.*)-transition$/);if(t==="paint"&&z&&E[z[1]]&&E[z[1]].transition)return fr({key:i,value:m,valueSpec:f.transition,style:u,styleSpec:f});var A,D=e.valueSpec||E[x];if(!D)return[new $(i,m,'unknown property "'+x+'"')];if(Or(m)==="string"&&bo(D)&&!D.tokens&&(A=/^{([^}]+)}$/.exec(m)))return[new $(i,m,'"'+x+'" does not support interpolation syntax\nUse an identity property function instead: `{ "type": "identity", "property": '+JSON.stringify(A[1])+" }`.")];var B=[];return e.layerType==="symbol"&&(x==="text-field"&&u&&!u.glyphs&&B.push(new $(i,m,'use of "text-field" requires a style "glyphs" property')),x==="text-font"&&Vs(we(m))&&Oe(m.type)==="identity"&&B.push(new $(i,m,'"text-font" does not support identity functions'))),B.concat(fr({key:e.key,value:m,valueSpec:D,style:u,styleSpec:f,expressionContext:"property",propertyType:t,propertyKey:x}))}function Jl(e){return Yl(e,"paint")}function fs(e){return Yl(e,"layout")}function Sc(e){var t=[],i=e.value,u=e.key,f=e.style,m=e.styleSpec;i.type||i.ref||t.push(new $(u,i,'either "type" or "ref" is required'));var x,E=Oe(i.type),z=Oe(i.ref);if(i.id)for(var A=Oe(i.id),D=0;D<e.arrayIndex;D++){var B=f.layers[D];Oe(B.id)===A&&t.push(new $(u,i.id,'duplicate layer id "'+i.id+'", previously used at line '+B.id.__line__))}if("ref"in i)["type","source","source-layer","filter","layout"].forEach(function(J){J in i&&t.push(new $(u,i[J],'"'+J+'" is prohibited for ref layers'))}),f.layers.forEach(function(J){Oe(J.id)===z&&(x=J)}),x?x.ref?t.push(new $(u,i.ref,"ref cannot reference another ref layer")):E=Oe(x.type):t.push(new $(u,i.ref,'ref layer "'+z+'" not found'));else if(E!=="background")if(i.source){var q=f.sources&&f.sources[i.source],G=q&&Oe(q.type);q?G==="vector"&&E==="raster"?t.push(new $(u,i.source,'layer "'+i.id+'" requires a raster source')):G==="raster"&&E!=="raster"?t.push(new $(u,i.source,'layer "'+i.id+'" requires a vector source')):G!=="vector"||i["source-layer"]?G==="raster-dem"&&E!=="hillshade"?t.push(new $(u,i.source,"raster-dem source can only be used with layer type 'hillshade'.")):E!=="line"||!i.paint||!i.paint["line-gradient"]||G==="geojson"&&q.lineMetrics||t.push(new $(u,i,'layer "'+i.id+'" specifies a line-gradient, which requires a GeoJSON source with `lineMetrics` enabled.')):t.push(new $(u,i,'layer "'+i.id+'" must specify a "source-layer"')):t.push(new $(u,i.source,'source "'+i.source+'" not found'))}else t.push(new $(u,i,'missing required property "source"'));return t=t.concat(fa({key:u,value:i,valueSpec:m.layer,style:e.style,styleSpec:e.styleSpec,objectElementValidators:{"*":function(){return[]},type:function(){return fr({key:u+".type",value:i.type,valueSpec:m.layer.type,style:e.style,styleSpec:e.styleSpec,object:i,objectKey:"type"})},filter:Wl,layout:function(J){return fa({layer:i,key:J.key,value:J.value,style:J.style,styleSpec:J.styleSpec,objectElementValidators:{"*":function(ee){return fs(Ce({layerType:E},ee))}}})},paint:function(J){return fa({layer:i,key:J.key,value:J.value,style:J.style,styleSpec:J.styleSpec,objectElementValidators:{"*":function(ee){return Jl(Ce({layerType:E},ee))}}})}}}))}function wo(e){var t=e.value,i=e.key,u=Or(t);return u!=="string"?[new $(i,t,"string expected, "+u+" found")]:[]}var Hr={promoteId:function(e){var t=e.key,i=e.value;if(Or(i)==="string")return wo({key:t,value:i});var u=[];for(var f in i)u.push.apply(u,wo({key:t+"."+f,value:i[f]}));return u}};function Xs(e){var t=e.value,i=e.key,u=e.styleSpec,f=e.style;if(!t.type)return[new $(i,t,'"type" is required')];var m,x=Oe(t.type);switch(x){case"vector":case"raster":case"raster-dem":return fa({key:i,value:t,valueSpec:u["source_"+x.replace("-","_")],style:e.style,styleSpec:u,objectElementValidators:Hr});case"geojson":if(m=fa({key:i,value:t,valueSpec:u.source_geojson,style:f,styleSpec:u,objectElementValidators:Hr}),t.cluster)for(var E in t.clusterProperties){var z=t.clusterProperties[E],A=z[0],D=typeof A=="string"?[A,["accumulated"],["get",E]]:A;m.push.apply(m,xo({key:i+"."+E+".map",value:z[1],expressionContext:"cluster-map"})),m.push.apply(m,xo({key:i+"."+E+".reduce",value:D,expressionContext:"cluster-reduce"}))}return m;case"video":return fa({key:i,value:t,valueSpec:u.source_video,style:f,styleSpec:u});case"image":return fa({key:i,value:t,valueSpec:u.source_image,style:f,styleSpec:u});case"canvas":return[new $(i,null,"Please use runtime APIs to add canvas sources, rather than including them in stylesheets.","source.canvas")];default:return ps({key:i+".type",value:t.type,valueSpec:{values:["vector","raster","raster-dem","geojson","video","image"]},style:f,styleSpec:u})}}function So(e){var t=e.value,i=e.styleSpec,u=i.light,f=e.style,m=[],x=Or(t);if(t===void 0)return m;if(x!=="object")return m.concat([new $("light",t,"object expected, "+x+" found")]);for(var E in t){var z=E.match(/^(.*)-transition$/);m=m.concat(z&&u[z[1]]&&u[z[1]].transition?fr({key:E,value:t[E],valueSpec:i.transition,style:f,styleSpec:i}):u[E]?fr({key:E,value:t[E],valueSpec:u[E],style:f,styleSpec:i}):[new $(E,t[E],'unknown property "'+E+'"')])}return m}var Ha={"*":function(){return[]},array:_c,boolean:function(e){var t=e.value,i=e.key,u=Or(t);return u!=="boolean"?[new $(i,t,"boolean expected, "+u+" found")]:[]},number:vc,color:function(e){var t=e.key,i=e.value,u=Or(i);return u!=="string"?[new $(t,i,"color expected, "+u+" found")]:Jt(i)===null?[new $(t,i,'color expected, "'+i+'" found')]:[]},constants:me,enum:ps,filter:Wl,function:bc,layer:Sc,object:fa,source:Xs,light:So,string:wo,formatted:function(e){return wo(e).length===0?[]:xo(e)},resolvedImage:function(e){return wo(e).length===0?[]:xo(e)}};function fr(e){var t=e.value,i=e.valueSpec,u=e.styleSpec;return i.expression&&Vs(Oe(t))?bc(e):i.expression&&cs(we(t))?xo(e):i.type&&Ha[i.type]?Ha[i.type](e):fa(Ce({},e,{valueSpec:i.type?u[i.type]:i}))}function Nr(e){var t=e.value,i=e.key,u=wo(e);return u.length||(t.indexOf("{fontstack}")===-1&&u.push(new $(i,t,'"glyphs" url must include a "{fontstack}" token')),t.indexOf("{range}")===-1&&u.push(new $(i,t,'"glyphs" url must include a "{range}" token'))),u}function $n(e,t){t===void 0&&(t=j);var i=[];return i=i.concat(fr({key:"",value:e,valueSpec:t.$root,styleSpec:t,style:e,objectElementValidators:{glyphs:Nr,"*":function(){return[]}}})),e.constants&&(i=i.concat(me({key:"constants",value:e.constants,style:e,styleSpec:t}))),ds(i)}function ds(e){return[].concat(e).sort(function(t,i){return t.line-i.line})}function qo(e){return function(){for(var t=[],i=arguments.length;i--;)t[i]=arguments[i];return ds(e.apply(this,t))}}$n.source=qo(Xs),$n.light=qo(So),$n.layer=qo(Sc),$n.filter=qo(Wl),$n.paintProperty=qo(Jl),$n.layoutProperty=qo(fs);var ms=$n,Vh=ms.light,qh=ms.paintProperty,ys=ms.layoutProperty;function gs(e,t){var i=!1;if(t&&t.length)for(var u=0,f=t;u<f.length;u+=1)e.fire(new ue(new Error(f[u].message))),i=!0;return i}var Ca=Pi;function Pi(e,t,i){var u=this.cells=[];if(e instanceof ArrayBuffer){this.arrayBuffer=e;var f=new Int32Array(this.arrayBuffer);e=f[0],this.d=(t=f[1])+2*(i=f[2]);for(var m=0;m<this.d*this.d;m++){var x=f[3+m],E=f[3+m+1];u.push(x===E?null:f.subarray(x,E))}var z=f[3+u.length+1];this.keys=f.subarray(f[3+u.length],z),this.bboxes=f.subarray(z),this.insert=this._insertReadonly}else{this.d=t+2*i;for(var A=0;A<this.d*this.d;A++)u.push([]);this.keys=[],this.bboxes=[]}this.n=t,this.extent=e,this.padding=i,this.scale=t/e,this.uid=0;var D=i/t*e;this.min=-D,this.max=e+D}Pi.prototype.insert=function(e,t,i,u,f){this._forEachCell(t,i,u,f,this._insertCell,this.uid++),this.keys.push(e),this.bboxes.push(t),this.bboxes.push(i),this.bboxes.push(u),this.bboxes.push(f)},Pi.prototype._insertReadonly=function(){throw"Cannot insert into a GridIndex created from an ArrayBuffer."},Pi.prototype._insertCell=function(e,t,i,u,f,m){this.cells[f].push(m)},Pi.prototype.query=function(e,t,i,u,f){var m=this.min,x=this.max;if(e<=m&&t<=m&&x<=i&&x<=u&&!f)return Array.prototype.slice.call(this.keys);var E=[];return this._forEachCell(e,t,i,u,this._queryCell,E,{},f),E},Pi.prototype._queryCell=function(e,t,i,u,f,m,x,E){var z=this.cells[f];if(z!==null)for(var A=this.keys,D=this.bboxes,B=0;B<z.length;B++){var q=z[B];if(x[q]===void 0){var G=4*q;(E?E(D[G+0],D[G+1],D[G+2],D[G+3]):e<=D[G+2]&&t<=D[G+3]&&i>=D[G+0]&&u>=D[G+1])?(x[q]=!0,m.push(A[q])):x[q]=!1}}},Pi.prototype._forEachCell=function(e,t,i,u,f,m,x,E){for(var z=this._convertToCellCoord(e),A=this._convertToCellCoord(t),D=this._convertToCellCoord(i),B=this._convertToCellCoord(u),q=z;q<=D;q++)for(var G=A;G<=B;G++){var J=this.d*G+q;if((!E||E(this._convertFromCellCoord(q),this._convertFromCellCoord(G),this._convertFromCellCoord(q+1),this._convertFromCellCoord(G+1)))&&f.call(this,e,t,i,u,J,m,x,E))return}},Pi.prototype._convertFromCellCoord=function(e){return(e-this.padding)/this.scale},Pi.prototype._convertToCellCoord=function(e){return Math.max(0,Math.min(this.d-1,Math.floor(e*this.scale)+this.padding))},Pi.prototype.toArrayBuffer=function(){if(this.arrayBuffer)return this.arrayBuffer;for(var e=this.cells,t=3+this.cells.length+1+1,i=0,u=0;u<this.cells.length;u++)i+=this.cells[u].length;var f=new Int32Array(t+i+this.keys.length+this.bboxes.length);f[0]=this.extent,f[1]=this.n,f[2]=this.padding;for(var m=t,x=0;x<e.length;x++){var E=e[x];f[3+x]=m,f.set(E,m),m+=E.length}return f[3+e.length]=m,f.set(this.keys,m),f[3+e.length+1]=m+=this.keys.length,f.set(this.bboxes,m),m+=this.bboxes.length,f.buffer};var _s=R.ImageData,Ec=R.ImageBitmap,bi={};function pt(e,t,i){i===void 0&&(i={}),Object.defineProperty(t,"_classRegistryKey",{value:e,writeable:!1}),bi[e]={klass:t,omit:i.omit||[],shallow:i.shallow||[]}}for(var qn in pt("Object",Object),Ca.serialize=function(e,t){var i=e.toArrayBuffer();return t&&t.push(i),{buffer:i}},Ca.deserialize=function(e){return new Ca(e.buffer)},pt("Grid",Ca),pt("Color",lr),pt("Error",Error),pt("ResolvedImage",Di),pt("StylePropertyFunction",Vo),pt("StyleExpression",No,{omit:["_evaluator"]}),pt("ZoomDependentExpression",Uo),pt("ZoomConstantExpression",hs),pt("CompoundExpression",Ii,{omit:["_evaluate"]}),go)go[qn]._classRegistryKey||pt("Expression_"+qn,go[qn]);function Ws(e){return e&&typeof ArrayBuffer<"u"&&(e instanceof ArrayBuffer||e.constructor&&e.constructor.name==="ArrayBuffer")}function jo(e){return Ec&&e instanceof Ec}function da(e,t){if(e==null||typeof e=="boolean"||typeof e=="number"||typeof e=="string"||e instanceof Boolean||e instanceof Number||e instanceof String||e instanceof Date||e instanceof RegExp)return e;if(Ws(e)||jo(e))return t&&t.push(e),e;if(ArrayBuffer.isView(e)){var i=e;return t&&t.push(i.buffer),i}if(e instanceof _s)return t&&t.push(e.data.buffer),e;if(Array.isArray(e)){for(var u=[],f=0,m=e;f<m.length;f+=1)u.push(da(m[f],t));return u}if(typeof e=="object"){var x=e.constructor,E=x._classRegistryKey;if(!E)throw new Error("can't serialize object of unregistered class");var z=x.serialize?x.serialize(e,t):{};if(!x.serialize){for(var A in e)if(e.hasOwnProperty(A)&&!(bi[E].omit.indexOf(A)>=0)){var D=e[A];z[A]=bi[E].shallow.indexOf(A)>=0?D:da(D,t)}e instanceof Error&&(z.message=e.message)}if(z.$name)throw new Error("$name property is reserved for worker serialization logic.");return E!=="Object"&&(z.$name=E),z}throw new Error("can't serialize object of type "+typeof e)}function jn(e){if(e==null||typeof e=="boolean"||typeof e=="number"||typeof e=="string"||e instanceof Boolean||e instanceof Number||e instanceof String||e instanceof Date||e instanceof RegExp||Ws(e)||jo(e)||ArrayBuffer.isView(e)||e instanceof _s)return e;if(Array.isArray(e))return e.map(jn);if(typeof e=="object"){var t=e.$name||"Object",i=bi[t].klass;if(!i)throw new Error("can't deserialize unregistered class "+t);if(i.deserialize)return i.deserialize(e);for(var u=Object.create(i.prototype),f=0,m=Object.keys(e);f<m.length;f+=1){var x=m[f];if(x!=="$name"){var E=e[x];u[x]=bi[t].shallow.indexOf(x)>=0?E:jn(E)}}return u}throw new Error("can't deserialize object of type "+typeof e)}var Ql=function(){this.first=!0};Ql.prototype.update=function(e,t){var i=Math.floor(e);return this.first?(this.first=!1,this.lastIntegerZoom=i,this.lastIntegerZoomTime=0,this.lastZoom=e,this.lastFloorZoom=i,!0):(this.lastFloorZoom>i?(this.lastIntegerZoom=i+1,this.lastIntegerZoomTime=t):this.lastFloorZoom<i&&(this.lastIntegerZoom=i,this.lastIntegerZoomTime=t),e!==this.lastZoom&&(this.lastZoom=e,this.lastFloorZoom=i,!0))};var nt={"Latin-1 Supplement":function(e){return e>=128&&e<=255},Arabic:function(e){return e>=1536&&e<=1791},"Arabic Supplement":function(e){return e>=1872&&e<=1919},"Arabic Extended-A":function(e){return e>=2208&&e<=2303},"Hangul Jamo":function(e){return e>=4352&&e<=4607},"Unified Canadian Aboriginal Syllabics":function(e){return e>=5120&&e<=5759},Khmer:function(e){return e>=6016&&e<=6143},"Unified Canadian Aboriginal Syllabics Extended":function(e){return e>=6320&&e<=6399},"General Punctuation":function(e){return e>=8192&&e<=8303},"Letterlike Symbols":function(e){return e>=8448&&e<=8527},"Number Forms":function(e){return e>=8528&&e<=8591},"Miscellaneous Technical":function(e){return e>=8960&&e<=9215},"Control Pictures":function(e){return e>=9216&&e<=9279},"Optical Character Recognition":function(e){return e>=9280&&e<=9311},"Enclosed Alphanumerics":function(e){return e>=9312&&e<=9471},"Geometric Shapes":function(e){return e>=9632&&e<=9727},"Miscellaneous Symbols":function(e){return e>=9728&&e<=9983},"Miscellaneous Symbols and Arrows":function(e){return e>=11008&&e<=11263},"CJK Radicals Supplement":function(e){return e>=11904&&e<=12031},"Kangxi Radicals":function(e){return e>=12032&&e<=12255},"Ideographic Description Characters":function(e){return e>=12272&&e<=12287},"CJK Symbols and Punctuation":function(e){return e>=12288&&e<=12351},Hiragana:function(e){return e>=12352&&e<=12447},Katakana:function(e){return e>=12448&&e<=12543},Bopomofo:function(e){return e>=12544&&e<=12591},"Hangul Compatibility Jamo":function(e){return e>=12592&&e<=12687},Kanbun:function(e){return e>=12688&&e<=12703},"Bopomofo Extended":function(e){return e>=12704&&e<=12735},"CJK Strokes":function(e){return e>=12736&&e<=12783},"Katakana Phonetic Extensions":function(e){return e>=12784&&e<=12799},"Enclosed CJK Letters and Months":function(e){return e>=12800&&e<=13055},"CJK Compatibility":function(e){return e>=13056&&e<=13311},"CJK Unified Ideographs Extension A":function(e){return e>=13312&&e<=19903},"Yijing Hexagram Symbols":function(e){return e>=19904&&e<=19967},"CJK Unified Ideographs":function(e){return e>=19968&&e<=40959},"Yi Syllables":function(e){return e>=40960&&e<=42127},"Yi Radicals":function(e){return e>=42128&&e<=42191},"Hangul Jamo Extended-A":function(e){return e>=43360&&e<=43391},"Hangul Syllables":function(e){return e>=44032&&e<=55215},"Hangul Jamo Extended-B":function(e){return e>=55216&&e<=55295},"Private Use Area":function(e){return e>=57344&&e<=63743},"CJK Compatibility Ideographs":function(e){return e>=63744&&e<=64255},"Arabic Presentation Forms-A":function(e){return e>=64336&&e<=65023},"Vertical Forms":function(e){return e>=65040&&e<=65055},"CJK Compatibility Forms":function(e){return e>=65072&&e<=65103},"Small Form Variants":function(e){return e>=65104&&e<=65135},"Arabic Presentation Forms-B":function(e){return e>=65136&&e<=65279},"Halfwidth and Fullwidth Forms":function(e){return e>=65280&&e<=65519}};function $l(e){for(var t=0,i=e;t<i.length;t+=1)if(Ys(i[t].charCodeAt(0)))return!0;return!1}function Ys(e){return!(e!==746&&e!==747&&(e<4352||!(nt["Bopomofo Extended"](e)||nt.Bopomofo(e)||nt["CJK Compatibility Forms"](e)&&!(e>=65097&&e<=65103)||nt["CJK Compatibility Ideographs"](e)||nt["CJK Compatibility"](e)||nt["CJK Radicals Supplement"](e)||nt["CJK Strokes"](e)||!(!nt["CJK Symbols and Punctuation"](e)||e>=12296&&e<=12305||e>=12308&&e<=12319||e===12336)||nt["CJK Unified Ideographs Extension A"](e)||nt["CJK Unified Ideographs"](e)||nt["Enclosed CJK Letters and Months"](e)||nt["Hangul Compatibility Jamo"](e)||nt["Hangul Jamo Extended-A"](e)||nt["Hangul Jamo Extended-B"](e)||nt["Hangul Jamo"](e)||nt["Hangul Syllables"](e)||nt.Hiragana(e)||nt["Ideographic Description Characters"](e)||nt.Kanbun(e)||nt["Kangxi Radicals"](e)||nt["Katakana Phonetic Extensions"](e)||nt.Katakana(e)&&e!==12540||!(!nt["Halfwidth and Fullwidth Forms"](e)||e===65288||e===65289||e===65293||e>=65306&&e<=65310||e===65339||e===65341||e===65343||e>=65371&&e<=65503||e===65507||e>=65512&&e<=65519)||!(!nt["Small Form Variants"](e)||e>=65112&&e<=65118||e>=65123&&e<=65126)||nt["Unified Canadian Aboriginal Syllabics"](e)||nt["Unified Canadian Aboriginal Syllabics Extended"](e)||nt["Vertical Forms"](e)||nt["Yijing Hexagram Symbols"](e)||nt["Yi Syllables"](e)||nt["Yi Radicals"](e))))}function eu(e){return!(Ys(e)||function(t){return!!(nt["Latin-1 Supplement"](t)&&(t===167||t===169||t===174||t===177||t===188||t===189||t===190||t===215||t===247)||nt["General Punctuation"](t)&&(t===8214||t===8224||t===8225||t===8240||t===8241||t===8251||t===8252||t===8258||t===8263||t===8264||t===8265||t===8273)||nt["Letterlike Symbols"](t)||nt["Number Forms"](t)||nt["Miscellaneous Technical"](t)&&(t>=8960&&t<=8967||t>=8972&&t<=8991||t>=8996&&t<=9e3||t===9003||t>=9085&&t<=9114||t>=9150&&t<=9165||t===9167||t>=9169&&t<=9179||t>=9186&&t<=9215)||nt["Control Pictures"](t)&&t!==9251||nt["Optical Character Recognition"](t)||nt["Enclosed Alphanumerics"](t)||nt["Geometric Shapes"](t)||nt["Miscellaneous Symbols"](t)&&!(t>=9754&&t<=9759)||nt["Miscellaneous Symbols and Arrows"](t)&&(t>=11026&&t<=11055||t>=11088&&t<=11097||t>=11192&&t<=11243)||nt["CJK Symbols and Punctuation"](t)||nt.Katakana(t)||nt["Private Use Area"](t)||nt["CJK Compatibility Forms"](t)||nt["Small Form Variants"](t)||nt["Halfwidth and Fullwidth Forms"](t)||t===8734||t===8756||t===8757||t>=9984&&t<=10087||t>=10102&&t<=10131||t===65532||t===65533)}(e))}function na(e){return e>=1424&&e<=2303||nt["Arabic Presentation Forms-A"](e)||nt["Arabic Presentation Forms-B"](e)}function Gn(e,t){return!(!t&&na(e)||e>=2304&&e<=3583||e>=3840&&e<=4255||nt.Khmer(e))}function Js(e){for(var t=0,i=e;t<i.length;t+=1)if(na(i[t].charCodeAt(0)))return!0;return!1}var Qs=null,Zn="unavailable",Ma=null,kc=function(e){e&&typeof e=="string"&&e.indexOf("NetworkError")>-1&&(Zn="error"),Qs&&Qs(e)};function vs(){tu.fire(new W("pluginStateChange",{pluginStatus:Zn,pluginURL:Ma}))}var tu=new pe,ru=function(){return Zn},ma=function(){if(Zn!=="deferred"||!Ma)throw new Error("rtl-text-plugin cannot be downloaded unless a pluginURL is specified");Zn="loading",vs(),Ma&&Br({url:Ma},function(e){e?kc(e):(Zn="loaded",vs())})},ea={applyArabicShaping:null,processBidirectionalText:null,processStyledBidirectionalText:null,isLoaded:function(){return Zn==="loaded"||ea.applyArabicShaping!=null},isLoading:function(){return Zn==="loading"},setState:function(e){Zn=e.pluginStatus,Ma=e.pluginURL},isParsed:function(){return ea.applyArabicShaping!=null&&ea.processBidirectionalText!=null&&ea.processStyledBidirectionalText!=null},getPluginURL:function(){return Ma}},rr=function(e,t){this.zoom=e,t?(this.now=t.now,this.fadeDuration=t.fadeDuration,this.zoomHistory=t.zoomHistory,this.transition=t.transition):(this.now=0,this.fadeDuration=0,this.zoomHistory=new Ql,this.transition={})};rr.prototype.isSupportedScript=function(e){return function(t,i){for(var u=0,f=t;u<f.length;u+=1)if(!Gn(f[u].charCodeAt(0),i))return!1;return!0}(e,ea.isLoaded())},rr.prototype.crossFadingFactor=function(){return this.fadeDuration===0?1:Math.min((this.now-this.zoomHistory.lastIntegerZoomTime)/this.fadeDuration,1)},rr.prototype.getCrossfadeParameters=function(){var e=this.zoom,t=e-Math.floor(e),i=this.crossFadingFactor();return e>this.zoomHistory.lastIntegerZoom?{fromScale:2,toScale:1,t:t+(1-t)*i}:{fromScale:.5,toScale:1,t:1-(1-i)*t}};var ka=function(e,t){this.property=e,this.value=t,this.expression=function(i,u){if(Vs(i))return new Vo(i,u);if(cs(i)){var f=gc(i,u);if(f.result==="error")throw new Error(f.value.map(function(x){return x.key+": "+x.message}).join(", "));return f.value}var m=i;return typeof i=="string"&&u.type==="color"&&(m=lr.parse(i)),{kind:"constant",evaluate:function(){return m}}}(t===void 0?e.specification.default:t,e.specification)};ka.prototype.isDataDriven=function(){return this.expression.kind==="source"||this.expression.kind==="composite"},ka.prototype.possiblyEvaluate=function(e,t,i){return this.property.possiblyEvaluate(this,e,t,i)};var aa=function(e){this.property=e,this.value=new ka(e,void 0)};aa.prototype.transitioned=function(e,t){return new Eo(this.property,this.value,t,ge({},e.transition,this.transition),e.now)},aa.prototype.untransitioned=function(){return new Eo(this.property,this.value,null,{},0)};var tn=function(e){this._properties=e,this._values=Object.create(e.defaultTransitionablePropertyValues)};tn.prototype.getValue=function(e){return mt(this._values[e].value.value)},tn.prototype.setValue=function(e,t){this._values.hasOwnProperty(e)||(this._values[e]=new aa(this._values[e].property)),this._values[e].value=new ka(this._values[e].property,t===null?void 0:mt(t))},tn.prototype.getTransition=function(e){return mt(this._values[e].transition)},tn.prototype.setTransition=function(e,t){this._values.hasOwnProperty(e)||(this._values[e]=new aa(this._values[e].property)),this._values[e].transition=mt(t)||void 0},tn.prototype.serialize=function(){for(var e={},t=0,i=Object.keys(this._values);t<i.length;t+=1){var u=i[t],f=this.getValue(u);f!==void 0&&(e[u]=f);var m=this.getTransition(u);m!==void 0&&(e[u+"-transition"]=m)}return e},tn.prototype.transitioned=function(e,t){for(var i=new Xa(this._properties),u=0,f=Object.keys(this._values);u<f.length;u+=1){var m=f[u];i._values[m]=this._values[m].transitioned(e,t._values[m])}return i},tn.prototype.untransitioned=function(){for(var e=new Xa(this._properties),t=0,i=Object.keys(this._values);t<i.length;t+=1){var u=i[t];e._values[u]=this._values[u].untransitioned()}return e};var Eo=function(e,t,i,u,f){this.property=e,this.value=t,this.begin=f+u.delay||0,this.end=this.begin+u.duration||0,e.specification.transition&&(u.delay||u.duration)&&(this.prior=i)};Eo.prototype.possiblyEvaluate=function(e,t,i){var u=e.now||0,f=this.value.possiblyEvaluate(e,t,i),m=this.prior;if(m){if(u>this.end)return this.prior=null,f;if(this.value.isDataDriven())return this.prior=null,f;if(u<this.begin)return m.possiblyEvaluate(e,t,i);var x=(u-this.begin)/(this.end-this.begin);return this.property.interpolate(m.possiblyEvaluate(e,t,i),f,function(E){if(E<=0)return 0;if(E>=1)return 1;var z=E*E,A=z*E;return 4*(E<.5?A:3*(E-z)+A-.75)}(x))}return f};var Xa=function(e){this._properties=e,this._values=Object.create(e.defaultTransitioningPropertyValues)};Xa.prototype.possiblyEvaluate=function(e,t,i){for(var u=new bs(this._properties),f=0,m=Object.keys(this._values);f<m.length;f+=1){var x=m[f];u._values[x]=this._values[x].possiblyEvaluate(e,t,i)}return u},Xa.prototype.hasTransition=function(){for(var e=0,t=Object.keys(this._values);e<t.length;e+=1)if(this._values[t[e]].prior)return!0;return!1};var ya=function(e){this._properties=e,this._values=Object.create(e.defaultPropertyValues)};ya.prototype.getValue=function(e){return mt(this._values[e].value)},ya.prototype.setValue=function(e,t){this._values[e]=new ka(this._values[e].property,t===null?void 0:mt(t))},ya.prototype.serialize=function(){for(var e={},t=0,i=Object.keys(this._values);t<i.length;t+=1){var u=i[t],f=this.getValue(u);f!==void 0&&(e[u]=f)}return e},ya.prototype.possiblyEvaluate=function(e,t,i){for(var u=new bs(this._properties),f=0,m=Object.keys(this._values);f<m.length;f+=1){var x=m[f];u._values[x]=this._values[x].possiblyEvaluate(e,t,i)}return u};var _n=function(e,t,i){this.property=e,this.value=t,this.parameters=i};_n.prototype.isConstant=function(){return this.value.kind==="constant"},_n.prototype.constantOr=function(e){return this.value.kind==="constant"?this.value.value:e},_n.prototype.evaluate=function(e,t,i,u){return this.property.evaluate(this.value,this.parameters,e,t,i,u)};var bs=function(e){this._properties=e,this._values=Object.create(e.defaultPossiblyEvaluatedValues)};bs.prototype.get=function(e){return this._values[e]};var St=function(e){this.specification=e};St.prototype.possiblyEvaluate=function(e,t){return e.expression.evaluate(t)},St.prototype.interpolate=function(e,t,i){var u=Fo[this.specification.type];return u?u(e,t,i):e};var _t=function(e,t){this.specification=e,this.overrides=t};_t.prototype.possiblyEvaluate=function(e,t,i,u){return new _n(this,e.expression.kind==="constant"||e.expression.kind==="camera"?{kind:"constant",value:e.expression.evaluate(t,null,{},i,u)}:e.expression,t)},_t.prototype.interpolate=function(e,t,i){if(e.value.kind!=="constant"||t.value.kind!=="constant")return e;if(e.value.value===void 0||t.value.value===void 0)return new _n(this,{kind:"constant",value:void 0},e.parameters);var u=Fo[this.specification.type];return u?new _n(this,{kind:"constant",value:u(e.value.value,t.value.value,i)},e.parameters):e},_t.prototype.evaluate=function(e,t,i,u,f,m){return e.kind==="constant"?e.value:e.evaluate(t,i,u,f,m)};var $s=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.possiblyEvaluate=function(i,u,f,m){if(i.value===void 0)return new _n(this,{kind:"constant",value:void 0},u);if(i.expression.kind==="constant"){var x=i.expression.evaluate(u,null,{},f,m),E=i.property.specification.type==="resolvedImage"&&typeof x!="string"?x.name:x,z=this._calculate(E,E,E,u);return new _n(this,{kind:"constant",value:z},u)}if(i.expression.kind==="camera"){var A=this._calculate(i.expression.evaluate({zoom:u.zoom-1}),i.expression.evaluate({zoom:u.zoom}),i.expression.evaluate({zoom:u.zoom+1}),u);return new _n(this,{kind:"constant",value:A},u)}return new _n(this,i.expression,u)},t.prototype.evaluate=function(i,u,f,m,x,E){if(i.kind==="source"){var z=i.evaluate(u,f,m,x,E);return this._calculate(z,z,z,u)}return i.kind==="composite"?this._calculate(i.evaluate({zoom:Math.floor(u.zoom)-1},f,m),i.evaluate({zoom:Math.floor(u.zoom)},f,m),i.evaluate({zoom:Math.floor(u.zoom)+1},f,m),u):i.value},t.prototype._calculate=function(i,u,f,m){return m.zoom>m.zoomHistory.lastIntegerZoom?{from:i,to:u}:{from:f,to:u}},t.prototype.interpolate=function(i){return i},t}(_t),vn=function(e){this.specification=e};vn.prototype.possiblyEvaluate=function(e,t,i,u){if(e.value!==void 0){if(e.expression.kind==="constant"){var f=e.expression.evaluate(t,null,{},i,u);return this._calculate(f,f,f,t)}return this._calculate(e.expression.evaluate(new rr(Math.floor(t.zoom-1),t)),e.expression.evaluate(new rr(Math.floor(t.zoom),t)),e.expression.evaluate(new rr(Math.floor(t.zoom+1),t)),t)}},vn.prototype._calculate=function(e,t,i,u){return u.zoom>u.zoomHistory.lastIntegerZoom?{from:e,to:t}:{from:i,to:t}},vn.prototype.interpolate=function(e){return e};var ga=function(e){this.specification=e};ga.prototype.possiblyEvaluate=function(e,t,i,u){return!!e.expression.evaluate(t,null,{},i,u)},ga.prototype.interpolate=function(){return!1};var rn=function(e){for(var t in this.properties=e,this.defaultPropertyValues={},this.defaultTransitionablePropertyValues={},this.defaultTransitioningPropertyValues={},this.defaultPossiblyEvaluatedValues={},this.overridableProperties=[],e){var i=e[t];i.specification.overridable&&this.overridableProperties.push(t);var u=this.defaultPropertyValues[t]=new ka(i,void 0),f=this.defaultTransitionablePropertyValues[t]=new aa(i);this.defaultTransitioningPropertyValues[t]=f.untransitioned(),this.defaultPossiblyEvaluatedValues[t]=u.possiblyEvaluate({})}};pt("DataDrivenProperty",_t),pt("DataConstantProperty",St),pt("CrossFadedDataDrivenProperty",$s),pt("CrossFadedProperty",vn),pt("ColorRampProperty",ga);var Ta=function(e){function t(i,u){if(e.call(this),this.id=i.id,this.type=i.type,this._featureFilter={filter:function(){return!0},needGeometry:!1},i.type!=="custom"&&(this.metadata=(i=i).metadata,this.minzoom=i.minzoom,this.maxzoom=i.maxzoom,i.type!=="background"&&(this.source=i.source,this.sourceLayer=i["source-layer"],this.filter=i.filter),u.layout&&(this._unevaluatedLayout=new ya(u.layout)),u.paint)){for(var f in this._transitionablePaint=new tn(u.paint),i.paint)this.setPaintProperty(f,i.paint[f],{validate:!1});for(var m in i.layout)this.setLayoutProperty(m,i.layout[m],{validate:!1});this._transitioningPaint=this._transitionablePaint.untransitioned(),this.paint=new bs(u.paint)}}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.getCrossfadeParameters=function(){return this._crossfadeParameters},t.prototype.getLayoutProperty=function(i){return i==="visibility"?this.visibility:this._unevaluatedLayout.getValue(i)},t.prototype.setLayoutProperty=function(i,u,f){f===void 0&&(f={}),u!=null&&this._validate(ys,"layers."+this.id+".layout."+i,i,u,f)||(i!=="visibility"?this._unevaluatedLayout.setValue(i,u):this.visibility=u)},t.prototype.getPaintProperty=function(i){return wt(i,"-transition")?this._transitionablePaint.getTransition(i.slice(0,-11)):this._transitionablePaint.getValue(i)},t.prototype.setPaintProperty=function(i,u,f){if(f===void 0&&(f={}),u!=null&&this._validate(qh,"layers."+this.id+".paint."+i,i,u,f))return!1;if(wt(i,"-transition"))return this._transitionablePaint.setTransition(i.slice(0,-11),u||void 0),!1;var m=this._transitionablePaint._values[i],x=m.property.specification["property-type"]==="cross-faded-data-driven",E=m.value.isDataDriven(),z=m.value;this._transitionablePaint.setValue(i,u),this._handleSpecialPaintPropertyUpdate(i);var A=this._transitionablePaint._values[i].value;return A.isDataDriven()||E||x||this._handleOverridablePaintPropertyUpdate(i,z,A)},t.prototype._handleSpecialPaintPropertyUpdate=function(i){},t.prototype._handleOverridablePaintPropertyUpdate=function(i,u,f){return!1},t.prototype.isHidden=function(i){return!!(this.minzoom&&i<this.minzoom)||!!(this.maxzoom&&i>=this.maxzoom)||this.visibility==="none"},t.prototype.updateTransitions=function(i){this._transitioningPaint=this._transitionablePaint.transitioned(i,this._transitioningPaint)},t.prototype.hasTransition=function(){return this._transitioningPaint.hasTransition()},t.prototype.recalculate=function(i,u){i.getCrossfadeParameters&&(this._crossfadeParameters=i.getCrossfadeParameters()),this._unevaluatedLayout&&(this.layout=this._unevaluatedLayout.possiblyEvaluate(i,void 0,u)),this.paint=this._transitioningPaint.possiblyEvaluate(i,void 0,u)},t.prototype.serialize=function(){var i={id:this.id,type:this.type,source:this.source,"source-layer":this.sourceLayer,metadata:this.metadata,minzoom:this.minzoom,maxzoom:this.maxzoom,filter:this.filter,layout:this._unevaluatedLayout&&this._unevaluatedLayout.serialize(),paint:this._transitionablePaint&&this._transitionablePaint.serialize()};return this.visibility&&(i.layout=i.layout||{},i.layout.visibility=this.visibility),Ze(i,function(u,f){return!(u===void 0||f==="layout"&&!Object.keys(u).length||f==="paint"&&!Object.keys(u).length)})},t.prototype._validate=function(i,u,f,m,x){return x===void 0&&(x={}),(!x||x.validate!==!1)&&gs(this,i.call(ms,{key:u,layerType:this.type,objectKey:f,value:m,styleSpec:j,style:{glyphs:!0,sprite:!0}}))},t.prototype.is3D=function(){return!1},t.prototype.isTileClipped=function(){return!1},t.prototype.hasOffscreenPass=function(){return!1},t.prototype.resize=function(){},t.prototype.isStateDependent=function(){for(var i in this.paint._values){var u=this.paint.get(i);if(u instanceof _n&&bo(u.property.specification)&&(u.value.kind==="source"||u.value.kind==="composite")&&u.value.isStateDependent)return!0}return!1},t}(pe),iu={Int8:Int8Array,Uint8:Uint8Array,Int16:Int16Array,Uint16:Uint16Array,Int32:Int32Array,Uint32:Uint32Array,Float32:Float32Array},el=function(e,t){this._structArray=e,this._pos1=t*this.size,this._pos2=this._pos1/2,this._pos4=this._pos1/4,this._pos8=this._pos1/8},Ir=function(){this.isTransferred=!1,this.capacity=-1,this.resize(0)};function Zi(e,t){t===void 0&&(t=1);var i=0,u=0;return{members:e.map(function(f){var m=iu[f.type].BYTES_PER_ELEMENT,x=i=Tc(i,Math.max(t,m)),E=f.components||1;return u=Math.max(u,m),i+=m*E,{name:f.name,type:f.type,components:E,offset:x}}),size:Tc(i,Math.max(u,t)),alignment:t}}function Tc(e,t){return Math.ceil(e/t)*t}Ir.serialize=function(e,t){return e._trim(),t&&(e.isTransferred=!0,t.push(e.arrayBuffer)),{length:e.length,arrayBuffer:e.arrayBuffer}},Ir.deserialize=function(e){var t=Object.create(this.prototype);return t.arrayBuffer=e.arrayBuffer,t.length=e.length,t.capacity=e.arrayBuffer.byteLength/t.bytesPerElement,t._refreshViews(),t},Ir.prototype._trim=function(){this.length!==this.capacity&&(this.capacity=this.length,this.arrayBuffer=this.arrayBuffer.slice(0,this.length*this.bytesPerElement),this._refreshViews())},Ir.prototype.clear=function(){this.length=0},Ir.prototype.resize=function(e){this.reserve(e),this.length=e},Ir.prototype.reserve=function(e){if(e>this.capacity){this.capacity=Math.max(e,Math.floor(5*this.capacity),128),this.arrayBuffer=new ArrayBuffer(this.capacity*this.bytesPerElement);var t=this.uint8;this._refreshViews(),t&&this.uint8.set(t)}},Ir.prototype._refreshViews=function(){throw new Error("_refreshViews() must be implemented by each concrete StructArray layout")};var ko=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},t.prototype.emplaceBack=function(i,u){var f=this.length;return this.resize(f+1),this.emplace(f,i,u)},t.prototype.emplace=function(i,u,f){var m=2*i;return this.int16[m+0]=u,this.int16[m+1]=f,i},t}(Ir);ko.prototype.bytesPerElement=4,pt("StructArrayLayout2i4",ko);var nu=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},t.prototype.emplaceBack=function(i,u,f,m){var x=this.length;return this.resize(x+1),this.emplace(x,i,u,f,m)},t.prototype.emplace=function(i,u,f,m,x){var E=4*i;return this.int16[E+0]=u,this.int16[E+1]=f,this.int16[E+2]=m,this.int16[E+3]=x,i},t}(Ir);nu.prototype.bytesPerElement=8,pt("StructArrayLayout4i8",nu);var Da=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},t.prototype.emplaceBack=function(i,u,f,m,x,E){var z=this.length;return this.resize(z+1),this.emplace(z,i,u,f,m,x,E)},t.prototype.emplace=function(i,u,f,m,x,E,z){var A=6*i;return this.int16[A+0]=u,this.int16[A+1]=f,this.int16[A+2]=m,this.int16[A+3]=x,this.int16[A+4]=E,this.int16[A+5]=z,i},t}(Ir);Da.prototype.bytesPerElement=12,pt("StructArrayLayout2i4i12",Da);var Kn=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},t.prototype.emplaceBack=function(i,u,f,m,x,E){var z=this.length;return this.resize(z+1),this.emplace(z,i,u,f,m,x,E)},t.prototype.emplace=function(i,u,f,m,x,E,z){var A=4*i,D=8*i;return this.int16[A+0]=u,this.int16[A+1]=f,this.uint8[D+4]=m,this.uint8[D+5]=x,this.uint8[D+6]=E,this.uint8[D+7]=z,i},t}(Ir);Kn.prototype.bytesPerElement=8,pt("StructArrayLayout2i4ub8",Kn);var Go=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},t.prototype.emplaceBack=function(i,u){var f=this.length;return this.resize(f+1),this.emplace(f,i,u)},t.prototype.emplace=function(i,u,f){var m=2*i;return this.float32[m+0]=u,this.float32[m+1]=f,i},t}(Ir);Go.prototype.bytesPerElement=8,pt("StructArrayLayout2f8",Go);var Ia=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},t.prototype.emplaceBack=function(i,u,f,m,x,E,z,A,D,B){var q=this.length;return this.resize(q+1),this.emplace(q,i,u,f,m,x,E,z,A,D,B)},t.prototype.emplace=function(i,u,f,m,x,E,z,A,D,B,q){var G=10*i;return this.uint16[G+0]=u,this.uint16[G+1]=f,this.uint16[G+2]=m,this.uint16[G+3]=x,this.uint16[G+4]=E,this.uint16[G+5]=z,this.uint16[G+6]=A,this.uint16[G+7]=D,this.uint16[G+8]=B,this.uint16[G+9]=q,i},t}(Ir);Ia.prototype.bytesPerElement=20,pt("StructArrayLayout10ui20",Ia);var tl=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},t.prototype.emplaceBack=function(i,u,f,m,x,E,z,A,D,B,q,G){var J=this.length;return this.resize(J+1),this.emplace(J,i,u,f,m,x,E,z,A,D,B,q,G)},t.prototype.emplace=function(i,u,f,m,x,E,z,A,D,B,q,G,J){var ee=12*i;return this.int16[ee+0]=u,this.int16[ee+1]=f,this.int16[ee+2]=m,this.int16[ee+3]=x,this.uint16[ee+4]=E,this.uint16[ee+5]=z,this.uint16[ee+6]=A,this.uint16[ee+7]=D,this.int16[ee+8]=B,this.int16[ee+9]=q,this.int16[ee+10]=G,this.int16[ee+11]=J,i},t}(Ir);tl.prototype.bytesPerElement=24,pt("StructArrayLayout4i4ui4i24",tl);var Zo=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},t.prototype.emplaceBack=function(i,u,f){var m=this.length;return this.resize(m+1),this.emplace(m,i,u,f)},t.prototype.emplace=function(i,u,f,m){var x=3*i;return this.float32[x+0]=u,this.float32[x+1]=f,this.float32[x+2]=m,i},t}(Ir);Zo.prototype.bytesPerElement=12,pt("StructArrayLayout3f12",Zo);var xs=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)},t.prototype.emplaceBack=function(i){var u=this.length;return this.resize(u+1),this.emplace(u,i)},t.prototype.emplace=function(i,u){return this.uint32[1*i+0]=u,i},t}(Ir);xs.prototype.bytesPerElement=4,pt("StructArrayLayout1ul4",xs);var au=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},t.prototype.emplaceBack=function(i,u,f,m,x,E,z,A,D){var B=this.length;return this.resize(B+1),this.emplace(B,i,u,f,m,x,E,z,A,D)},t.prototype.emplace=function(i,u,f,m,x,E,z,A,D,B){var q=10*i,G=5*i;return this.int16[q+0]=u,this.int16[q+1]=f,this.int16[q+2]=m,this.int16[q+3]=x,this.int16[q+4]=E,this.int16[q+5]=z,this.uint32[G+3]=A,this.uint16[q+8]=D,this.uint16[q+9]=B,i},t}(Ir);au.prototype.bytesPerElement=20,pt("StructArrayLayout6i1ul2ui20",au);var Ko=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},t.prototype.emplaceBack=function(i,u,f,m,x,E){var z=this.length;return this.resize(z+1),this.emplace(z,i,u,f,m,x,E)},t.prototype.emplace=function(i,u,f,m,x,E,z){var A=6*i;return this.int16[A+0]=u,this.int16[A+1]=f,this.int16[A+2]=m,this.int16[A+3]=x,this.int16[A+4]=E,this.int16[A+5]=z,i},t}(Ir);Ko.prototype.bytesPerElement=12,pt("StructArrayLayout2i2i2i12",Ko);var To=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},t.prototype.emplaceBack=function(i,u,f,m,x){var E=this.length;return this.resize(E+1),this.emplace(E,i,u,f,m,x)},t.prototype.emplace=function(i,u,f,m,x,E){var z=4*i,A=8*i;return this.float32[z+0]=u,this.float32[z+1]=f,this.float32[z+2]=m,this.int16[A+6]=x,this.int16[A+7]=E,i},t}(Ir);To.prototype.bytesPerElement=16,pt("StructArrayLayout2f1f2i16",To);var ou=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},t.prototype.emplaceBack=function(i,u,f,m){var x=this.length;return this.resize(x+1),this.emplace(x,i,u,f,m)},t.prototype.emplace=function(i,u,f,m,x){var E=12*i,z=3*i;return this.uint8[E+0]=u,this.uint8[E+1]=f,this.float32[z+1]=m,this.float32[z+2]=x,i},t}(Ir);ou.prototype.bytesPerElement=12,pt("StructArrayLayout2ub2f12",ou);var Wa=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},t.prototype.emplaceBack=function(i,u,f){var m=this.length;return this.resize(m+1),this.emplace(m,i,u,f)},t.prototype.emplace=function(i,u,f,m){var x=3*i;return this.uint16[x+0]=u,this.uint16[x+1]=f,this.uint16[x+2]=m,i},t}(Ir);Wa.prototype.bytesPerElement=6,pt("StructArrayLayout3ui6",Wa);var Ya=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},t.prototype.emplaceBack=function(i,u,f,m,x,E,z,A,D,B,q,G,J,ee,he,oe,ye){var be=this.length;return this.resize(be+1),this.emplace(be,i,u,f,m,x,E,z,A,D,B,q,G,J,ee,he,oe,ye)},t.prototype.emplace=function(i,u,f,m,x,E,z,A,D,B,q,G,J,ee,he,oe,ye,be){var Ee=24*i,Te=12*i,Me=48*i;return this.int16[Ee+0]=u,this.int16[Ee+1]=f,this.uint16[Ee+2]=m,this.uint16[Ee+3]=x,this.uint32[Te+2]=E,this.uint32[Te+3]=z,this.uint32[Te+4]=A,this.uint16[Ee+10]=D,this.uint16[Ee+11]=B,this.uint16[Ee+12]=q,this.float32[Te+7]=G,this.float32[Te+8]=J,this.uint8[Me+36]=ee,this.uint8[Me+37]=he,this.uint8[Me+38]=oe,this.uint32[Te+10]=ye,this.int16[Ee+22]=be,i},t}(Ir);Ya.prototype.bytesPerElement=48,pt("StructArrayLayout2i2ui3ul3ui2f3ub1ul1i48",Ya);var rl=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},t.prototype.emplaceBack=function(i,u,f,m,x,E,z,A,D,B,q,G,J,ee,he,oe,ye,be,Ee,Te,Me,Ke,$e,bt,lt,kt,ut,Qt){var Lt=this.length;return this.resize(Lt+1),this.emplace(Lt,i,u,f,m,x,E,z,A,D,B,q,G,J,ee,he,oe,ye,be,Ee,Te,Me,Ke,$e,bt,lt,kt,ut,Qt)},t.prototype.emplace=function(i,u,f,m,x,E,z,A,D,B,q,G,J,ee,he,oe,ye,be,Ee,Te,Me,Ke,$e,bt,lt,kt,ut,Qt,Lt){var vt=34*i,tr=17*i;return this.int16[vt+0]=u,this.int16[vt+1]=f,this.int16[vt+2]=m,this.int16[vt+3]=x,this.int16[vt+4]=E,this.int16[vt+5]=z,this.int16[vt+6]=A,this.int16[vt+7]=D,this.uint16[vt+8]=B,this.uint16[vt+9]=q,this.uint16[vt+10]=G,this.uint16[vt+11]=J,this.uint16[vt+12]=ee,this.uint16[vt+13]=he,this.uint16[vt+14]=oe,this.uint16[vt+15]=ye,this.uint16[vt+16]=be,this.uint16[vt+17]=Ee,this.uint16[vt+18]=Te,this.uint16[vt+19]=Me,this.uint16[vt+20]=Ke,this.uint16[vt+21]=$e,this.uint16[vt+22]=bt,this.uint32[tr+12]=lt,this.float32[tr+13]=kt,this.float32[tr+14]=ut,this.float32[tr+15]=Qt,this.float32[tr+16]=Lt,i},t}(Ir);rl.prototype.bytesPerElement=68,pt("StructArrayLayout8i15ui1ul4f68",rl);var Ja=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},t.prototype.emplaceBack=function(i){var u=this.length;return this.resize(u+1),this.emplace(u,i)},t.prototype.emplace=function(i,u){return this.float32[1*i+0]=u,i},t}(Ir);Ja.prototype.bytesPerElement=4,pt("StructArrayLayout1f4",Ja);var oa=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},t.prototype.emplaceBack=function(i,u,f){var m=this.length;return this.resize(m+1),this.emplace(m,i,u,f)},t.prototype.emplace=function(i,u,f,m){var x=3*i;return this.int16[x+0]=u,this.int16[x+1]=f,this.int16[x+2]=m,i},t}(Ir);oa.prototype.bytesPerElement=6,pt("StructArrayLayout3i6",oa);var su=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},t.prototype.emplaceBack=function(i,u,f){var m=this.length;return this.resize(m+1),this.emplace(m,i,u,f)},t.prototype.emplace=function(i,u,f,m){var x=4*i;return this.uint32[2*i+0]=u,this.uint16[x+2]=f,this.uint16[x+3]=m,i},t}(Ir);su.prototype.bytesPerElement=8,pt("StructArrayLayout1ul2ui8",su);var ws=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},t.prototype.emplaceBack=function(i,u){var f=this.length;return this.resize(f+1),this.emplace(f,i,u)},t.prototype.emplace=function(i,u,f){var m=2*i;return this.uint16[m+0]=u,this.uint16[m+1]=f,i},t}(Ir);ws.prototype.bytesPerElement=4,pt("StructArrayLayout2ui4",ws);var lu=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},t.prototype.emplaceBack=function(i){var u=this.length;return this.resize(u+1),this.emplace(u,i)},t.prototype.emplace=function(i,u){return this.uint16[1*i+0]=u,i},t}(Ir);lu.prototype.bytesPerElement=2,pt("StructArrayLayout1ui2",lu);var il=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},t.prototype.emplaceBack=function(i,u,f,m){var x=this.length;return this.resize(x+1),this.emplace(x,i,u,f,m)},t.prototype.emplace=function(i,u,f,m,x){var E=4*i;return this.float32[E+0]=u,this.float32[E+1]=f,this.float32[E+2]=m,this.float32[E+3]=x,i},t}(Ir);il.prototype.bytesPerElement=16,pt("StructArrayLayout4f16",il);var n=function(e){function t(){e.apply(this,arguments)}e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t;var i={anchorPointX:{configurable:!0},anchorPointY:{configurable:!0},x1:{configurable:!0},y1:{configurable:!0},x2:{configurable:!0},y2:{configurable:!0},featureIndex:{configurable:!0},sourceLayerIndex:{configurable:!0},bucketIndex:{configurable:!0},anchorPoint:{configurable:!0}};return i.anchorPointX.get=function(){return this._structArray.int16[this._pos2+0]},i.anchorPointY.get=function(){return this._structArray.int16[this._pos2+1]},i.x1.get=function(){return this._structArray.int16[this._pos2+2]},i.y1.get=function(){return this._structArray.int16[this._pos2+3]},i.x2.get=function(){return this._structArray.int16[this._pos2+4]},i.y2.get=function(){return this._structArray.int16[this._pos2+5]},i.featureIndex.get=function(){return this._structArray.uint32[this._pos4+3]},i.sourceLayerIndex.get=function(){return this._structArray.uint16[this._pos2+8]},i.bucketIndex.get=function(){return this._structArray.uint16[this._pos2+9]},i.anchorPoint.get=function(){return new M(this.anchorPointX,this.anchorPointY)},Object.defineProperties(t.prototype,i),t}(el);n.prototype.size=20;var s=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.get=function(i){return new n(this,i)},t}(au);pt("CollisionBoxArray",s);var o=function(e){function t(){e.apply(this,arguments)}e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t;var i={anchorX:{configurable:!0},anchorY:{configurable:!0},glyphStartIndex:{configurable:!0},numGlyphs:{configurable:!0},vertexStartIndex:{configurable:!0},lineStartIndex:{configurable:!0},lineLength:{configurable:!0},segment:{configurable:!0},lowerSize:{configurable:!0},upperSize:{configurable:!0},lineOffsetX:{configurable:!0},lineOffsetY:{configurable:!0},writingMode:{configurable:!0},placedOrientation:{configurable:!0},hidden:{configurable:!0},crossTileID:{configurable:!0},associatedIconIndex:{configurable:!0}};return i.anchorX.get=function(){return this._structArray.int16[this._pos2+0]},i.anchorY.get=function(){return this._structArray.int16[this._pos2+1]},i.glyphStartIndex.get=function(){return this._structArray.uint16[this._pos2+2]},i.numGlyphs.get=function(){return this._structArray.uint16[this._pos2+3]},i.vertexStartIndex.get=function(){return this._structArray.uint32[this._pos4+2]},i.lineStartIndex.get=function(){return this._structArray.uint32[this._pos4+3]},i.lineLength.get=function(){return this._structArray.uint32[this._pos4+4]},i.segment.get=function(){return this._structArray.uint16[this._pos2+10]},i.lowerSize.get=function(){return this._structArray.uint16[this._pos2+11]},i.upperSize.get=function(){return this._structArray.uint16[this._pos2+12]},i.lineOffsetX.get=function(){return this._structArray.float32[this._pos4+7]},i.lineOffsetY.get=function(){return this._structArray.float32[this._pos4+8]},i.writingMode.get=function(){return this._structArray.uint8[this._pos1+36]},i.placedOrientation.get=function(){return this._structArray.uint8[this._pos1+37]},i.placedOrientation.set=function(u){this._structArray.uint8[this._pos1+37]=u},i.hidden.get=function(){return this._structArray.uint8[this._pos1+38]},i.hidden.set=function(u){this._structArray.uint8[this._pos1+38]=u},i.crossTileID.get=function(){return this._structArray.uint32[this._pos4+10]},i.crossTileID.set=function(u){this._structArray.uint32[this._pos4+10]=u},i.associatedIconIndex.get=function(){return this._structArray.int16[this._pos2+22]},Object.defineProperties(t.prototype,i),t}(el);o.prototype.size=48;var c=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.get=function(i){return new o(this,i)},t}(Ya);pt("PlacedSymbolArray",c);var _=function(e){function t(){e.apply(this,arguments)}e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t;var i={anchorX:{configurable:!0},anchorY:{configurable:!0},rightJustifiedTextSymbolIndex:{configurable:!0},centerJustifiedTextSymbolIndex:{configurable:!0},leftJustifiedTextSymbolIndex:{configurable:!0},verticalPlacedTextSymbolIndex:{configurable:!0},placedIconSymbolIndex:{configurable:!0},verticalPlacedIconSymbolIndex:{configurable:!0},key:{configurable:!0},textBoxStartIndex:{configurable:!0},textBoxEndIndex:{configurable:!0},verticalTextBoxStartIndex:{configurable:!0},verticalTextBoxEndIndex:{configurable:!0},iconBoxStartIndex:{configurable:!0},iconBoxEndIndex:{configurable:!0},verticalIconBoxStartIndex:{configurable:!0},verticalIconBoxEndIndex:{configurable:!0},featureIndex:{configurable:!0},numHorizontalGlyphVertices:{configurable:!0},numVerticalGlyphVertices:{configurable:!0},numIconVertices:{configurable:!0},numVerticalIconVertices:{configurable:!0},useRuntimeCollisionCircles:{configurable:!0},crossTileID:{configurable:!0},textBoxScale:{configurable:!0},textOffset0:{configurable:!0},textOffset1:{configurable:!0},collisionCircleDiameter:{configurable:!0}};return i.anchorX.get=function(){return this._structArray.int16[this._pos2+0]},i.anchorY.get=function(){return this._structArray.int16[this._pos2+1]},i.rightJustifiedTextSymbolIndex.get=function(){return this._structArray.int16[this._pos2+2]},i.centerJustifiedTextSymbolIndex.get=function(){return this._structArray.int16[this._pos2+3]},i.leftJustifiedTextSymbolIndex.get=function(){return this._structArray.int16[this._pos2+4]},i.verticalPlacedTextSymbolIndex.get=function(){return this._structArray.int16[this._pos2+5]},i.placedIconSymbolIndex.get=function(){return this._structArray.int16[this._pos2+6]},i.verticalPlacedIconSymbolIndex.get=function(){return this._structArray.int16[this._pos2+7]},i.key.get=function(){return this._structArray.uint16[this._pos2+8]},i.textBoxStartIndex.get=function(){return this._structArray.uint16[this._pos2+9]},i.textBoxEndIndex.get=function(){return this._structArray.uint16[this._pos2+10]},i.verticalTextBoxStartIndex.get=function(){return this._structArray.uint16[this._pos2+11]},i.verticalTextBoxEndIndex.get=function(){return this._structArray.uint16[this._pos2+12]},i.iconBoxStartIndex.get=function(){return this._structArray.uint16[this._pos2+13]},i.iconBoxEndIndex.get=function(){return this._structArray.uint16[this._pos2+14]},i.verticalIconBoxStartIndex.get=function(){return this._structArray.uint16[this._pos2+15]},i.verticalIconBoxEndIndex.get=function(){return this._structArray.uint16[this._pos2+16]},i.featureIndex.get=function(){return this._structArray.uint16[this._pos2+17]},i.numHorizontalGlyphVertices.get=function(){return this._structArray.uint16[this._pos2+18]},i.numVerticalGlyphVertices.get=function(){return this._structArray.uint16[this._pos2+19]},i.numIconVertices.get=function(){return this._structArray.uint16[this._pos2+20]},i.numVerticalIconVertices.get=function(){return this._structArray.uint16[this._pos2+21]},i.useRuntimeCollisionCircles.get=function(){return this._structArray.uint16[this._pos2+22]},i.crossTileID.get=function(){return this._structArray.uint32[this._pos4+12]},i.crossTileID.set=function(u){this._structArray.uint32[this._pos4+12]=u},i.textBoxScale.get=function(){return this._structArray.float32[this._pos4+13]},i.textOffset0.get=function(){return this._structArray.float32[this._pos4+14]},i.textOffset1.get=function(){return this._structArray.float32[this._pos4+15]},i.collisionCircleDiameter.get=function(){return this._structArray.float32[this._pos4+16]},Object.defineProperties(t.prototype,i),t}(el);_.prototype.size=68;var w=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.get=function(i){return new _(this,i)},t}(rl);pt("SymbolInstanceArray",w);var S=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.getoffsetX=function(i){return this.float32[1*i+0]},t}(Ja);pt("GlyphOffsetArray",S);var P=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.getx=function(i){return this.int16[3*i+0]},t.prototype.gety=function(i){return this.int16[3*i+1]},t.prototype.gettileUnitDistanceFromAnchor=function(i){return this.int16[3*i+2]},t}(oa);pt("SymbolLineVertexArray",P);var C=function(e){function t(){e.apply(this,arguments)}e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t;var i={featureIndex:{configurable:!0},sourceLayerIndex:{configurable:!0},bucketIndex:{configurable:!0}};return i.featureIndex.get=function(){return this._structArray.uint32[this._pos4+0]},i.sourceLayerIndex.get=function(){return this._structArray.uint16[this._pos2+2]},i.bucketIndex.get=function(){return this._structArray.uint16[this._pos2+3]},Object.defineProperties(t.prototype,i),t}(el);C.prototype.size=8;var O=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.get=function(i){return new C(this,i)},t}(su);pt("FeatureIndexArray",O);var Z=Zi([{name:"a_pos",components:2,type:"Int16"}],4).members,K=function(e){e===void 0&&(e=[]),this.segments=e};function H(e,t){return 256*(e=le(Math.floor(e),0,255))+le(Math.floor(t),0,255)}K.prototype.prepareSegment=function(e,t,i,u){var f=this.segments[this.segments.length-1];return e>K.MAX_VERTEX_ARRAY_LENGTH&&qe("Max vertices per segment is "+K.MAX_VERTEX_ARRAY_LENGTH+": bucket requested "+e),(!f||f.vertexLength+e>K.MAX_VERTEX_ARRAY_LENGTH||f.sortKey!==u)&&(f={vertexOffset:t.length,primitiveOffset:i.length,vertexLength:0,primitiveLength:0},u!==void 0&&(f.sortKey=u),this.segments.push(f)),f},K.prototype.get=function(){return this.segments},K.prototype.destroy=function(){for(var e=0,t=this.segments;e<t.length;e+=1){var i=t[e];for(var u in i.vaos)i.vaos[u].destroy()}},K.simpleSegment=function(e,t,i,u){return new K([{vertexOffset:e,primitiveOffset:t,vertexLength:i,primitiveLength:u,vaos:{},sortKey:0}])},K.MAX_VERTEX_ARRAY_LENGTH=Math.pow(2,16)-1,pt("SegmentVector",K);var re=Zi([{name:"a_pattern_from",components:4,type:"Uint16"},{name:"a_pattern_to",components:4,type:"Uint16"},{name:"a_pixel_ratio_from",components:1,type:"Uint16"},{name:"a_pixel_ratio_to",components:1,type:"Uint16"}]),te=k(function(e){e.exports=function(t,i){var u,f,m,x,E,z,A,D;for(f=t.length-(u=3&t.length),m=i,E=3432918353,z=461845907,D=0;D<f;)A=255&t.charCodeAt(D)|(255&t.charCodeAt(++D))<<8|(255&t.charCodeAt(++D))<<16|(255&t.charCodeAt(++D))<<24,++D,m=27492+(65535&(x=5*(65535&(m=(m^=A=(65535&(A=(A=(65535&A)*E+(((A>>>16)*E&65535)<<16)&4294967295)<<15|A>>>17))*z+(((A>>>16)*z&65535)<<16)&4294967295)<<13|m>>>19))+((5*(m>>>16)&65535)<<16)&4294967295))+((58964+(x>>>16)&65535)<<16);switch(A=0,u){case 3:A^=(255&t.charCodeAt(D+2))<<16;case 2:A^=(255&t.charCodeAt(D+1))<<8;case 1:m^=A=(65535&(A=(A=(65535&(A^=255&t.charCodeAt(D)))*E+(((A>>>16)*E&65535)<<16)&4294967295)<<15|A>>>17))*z+(((A>>>16)*z&65535)<<16)&4294967295}return m^=t.length,m=2246822507*(65535&(m^=m>>>16))+((2246822507*(m>>>16)&65535)<<16)&4294967295,m=3266489909*(65535&(m^=m>>>13))+((3266489909*(m>>>16)&65535)<<16)&4294967295,(m^=m>>>16)>>>0}}),ce=k(function(e){e.exports=function(t,i){for(var u,f=t.length,m=i^f,x=0;f>=4;)u=1540483477*(65535&(u=255&t.charCodeAt(x)|(255&t.charCodeAt(++x))<<8|(255&t.charCodeAt(++x))<<16|(255&t.charCodeAt(++x))<<24))+((1540483477*(u>>>16)&65535)<<16),m=1540483477*(65535&m)+((1540483477*(m>>>16)&65535)<<16)^(u=1540483477*(65535&(u^=u>>>24))+((1540483477*(u>>>16)&65535)<<16)),f-=4,++x;switch(f){case 3:m^=(255&t.charCodeAt(x+2))<<16;case 2:m^=(255&t.charCodeAt(x+1))<<8;case 1:m=1540483477*(65535&(m^=255&t.charCodeAt(x)))+((1540483477*(m>>>16)&65535)<<16)}return m=1540483477*(65535&(m^=m>>>13))+((1540483477*(m>>>16)&65535)<<16),(m^=m>>>15)>>>0}}),Y=te,se=ce;Y.murmur3=te,Y.murmur2=se;var fe=function(){this.ids=[],this.positions=[],this.indexed=!1};fe.prototype.add=function(e,t,i,u){this.ids.push(Ie(e)),this.positions.push(t,i,u)},fe.prototype.getPositions=function(e){for(var t=Ie(e),i=0,u=this.ids.length-1;i<u;){var f=i+u>>1;this.ids[f]>=t?u=f:i=f+1}for(var m=[];this.ids[i]===t;)m.push({index:this.positions[3*i],start:this.positions[3*i+1],end:this.positions[3*i+2]}),i++;return m},fe.serialize=function(e,t){var i=new Float64Array(e.ids),u=new Uint32Array(e.positions);return function f(m,x,E,z){for(;E<z;){for(var A=m[E+z>>1],D=E-1,B=z+1;;){do D++;while(m[D]<A);do B--;while(m[B]>A);if(D>=B)break;ke(m,D,B),ke(x,3*D,3*B),ke(x,3*D+1,3*B+1),ke(x,3*D+2,3*B+2)}B-E<z-B?(f(m,x,E,B),E=B+1):(f(m,x,B+1,z),z=B)}}(i,u,0,i.length-1),t&&t.push(i.buffer,u.buffer),{ids:i,positions:u}},fe.deserialize=function(e){var t=new fe;return t.ids=e.ids,t.positions=e.positions,t.indexed=!0,t};var ve=Math.pow(2,53)-1;function Ie(e){var t=+e;return!isNaN(t)&&t<=ve?t:Y(String(e))}function ke(e,t,i){var u=e[t];e[t]=e[i],e[i]=u}pt("FeaturePositionMap",fe);var Pe=function(e,t){this.gl=e.gl,this.location=t},Ne=function(e){function t(i,u){e.call(this,i,u),this.current=0}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.set=function(i){this.current!==i&&(this.current=i,this.gl.uniform1i(this.location,i))},t}(Pe),Je=function(e){function t(i,u){e.call(this,i,u),this.current=0}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.set=function(i){this.current!==i&&(this.current=i,this.gl.uniform1f(this.location,i))},t}(Pe),Xe=function(e){function t(i,u){e.call(this,i,u),this.current=[0,0]}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.set=function(i){i[0]===this.current[0]&&i[1]===this.current[1]||(this.current=i,this.gl.uniform2f(this.location,i[0],i[1]))},t}(Pe),ct=function(e){function t(i,u){e.call(this,i,u),this.current=[0,0,0]}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.set=function(i){i[0]===this.current[0]&&i[1]===this.current[1]&&i[2]===this.current[2]||(this.current=i,this.gl.uniform3f(this.location,i[0],i[1],i[2]))},t}(Pe),Et=function(e){function t(i,u){e.call(this,i,u),this.current=[0,0,0,0]}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.set=function(i){i[0]===this.current[0]&&i[1]===this.current[1]&&i[2]===this.current[2]&&i[3]===this.current[3]||(this.current=i,this.gl.uniform4f(this.location,i[0],i[1],i[2],i[3]))},t}(Pe),Ct=function(e){function t(i,u){e.call(this,i,u),this.current=lr.transparent}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.set=function(i){i.r===this.current.r&&i.g===this.current.g&&i.b===this.current.b&&i.a===this.current.a||(this.current=i,this.gl.uniform4f(this.location,i.r,i.g,i.b,i.a))},t}(Pe),At=new Float32Array(16),yr=function(e){function t(i,u){e.call(this,i,u),this.current=At}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.set=function(i){if(i[12]!==this.current[12]||i[0]!==this.current[0])return this.current=i,void this.gl.uniformMatrix4fv(this.location,!1,i);for(var u=1;u<16;u++)if(i[u]!==this.current[u]){this.current=i,this.gl.uniformMatrix4fv(this.location,!1,i);break}},t}(Pe);function ht(e){return[H(255*e.r,255*e.g),H(255*e.b,255*e.a)]}var Ut=function(e,t,i){this.value=e,this.uniformNames=t.map(function(u){return"u_"+u}),this.type=i};Ut.prototype.setUniform=function(e,t,i){e.set(i.constantOr(this.value))},Ut.prototype.getBinding=function(e,t,i){return this.type==="color"?new Ct(e,t):new Je(e,t)};var Yt=function(e,t){this.uniformNames=t.map(function(i){return"u_"+i}),this.patternFrom=null,this.patternTo=null,this.pixelRatioFrom=1,this.pixelRatioTo=1};Yt.prototype.setConstantPatternPositions=function(e,t){this.pixelRatioFrom=t.pixelRatio,this.pixelRatioTo=e.pixelRatio,this.patternFrom=t.tlbr,this.patternTo=e.tlbr},Yt.prototype.setUniform=function(e,t,i,u){var f=u==="u_pattern_to"?this.patternTo:u==="u_pattern_from"?this.patternFrom:u==="u_pixel_ratio_to"?this.pixelRatioTo:u==="u_pixel_ratio_from"?this.pixelRatioFrom:null;f&&e.set(f)},Yt.prototype.getBinding=function(e,t,i){return i.substr(0,9)==="u_pattern"?new Et(e,t):new Je(e,t)};var Ot=function(e,t,i,u){this.expression=e,this.type=i,this.maxValue=0,this.paintVertexAttributes=t.map(function(f){return{name:"a_"+f,type:"Float32",components:i==="color"?2:1,offset:0}}),this.paintVertexArray=new u};Ot.prototype.populatePaintArray=function(e,t,i,u,f){var m=this.paintVertexArray.length,x=this.expression.evaluate(new rr(0),t,{},u,[],f);this.paintVertexArray.resize(e),this._setPaintValue(m,e,x)},Ot.prototype.updatePaintArray=function(e,t,i,u){var f=this.expression.evaluate({zoom:0},i,u);this._setPaintValue(e,t,f)},Ot.prototype._setPaintValue=function(e,t,i){if(this.type==="color")for(var u=ht(i),f=e;f<t;f++)this.paintVertexArray.emplace(f,u[0],u[1]);else{for(var m=e;m<t;m++)this.paintVertexArray.emplace(m,i);this.maxValue=Math.max(this.maxValue,Math.abs(i))}},Ot.prototype.upload=function(e){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=e.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))},Ot.prototype.destroy=function(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()};var Ft=function(e,t,i,u,f,m){this.expression=e,this.uniformNames=t.map(function(x){return"u_"+x+"_t"}),this.type=i,this.useIntegerZoom=u,this.zoom=f,this.maxValue=0,this.paintVertexAttributes=t.map(function(x){return{name:"a_"+x,type:"Float32",components:i==="color"?4:2,offset:0}}),this.paintVertexArray=new m};Ft.prototype.populatePaintArray=function(e,t,i,u,f){var m=this.expression.evaluate(new rr(this.zoom),t,{},u,[],f),x=this.expression.evaluate(new rr(this.zoom+1),t,{},u,[],f),E=this.paintVertexArray.length;this.paintVertexArray.resize(e),this._setPaintValue(E,e,m,x)},Ft.prototype.updatePaintArray=function(e,t,i,u){var f=this.expression.evaluate({zoom:this.zoom},i,u),m=this.expression.evaluate({zoom:this.zoom+1},i,u);this._setPaintValue(e,t,f,m)},Ft.prototype._setPaintValue=function(e,t,i,u){if(this.type==="color")for(var f=ht(i),m=ht(u),x=e;x<t;x++)this.paintVertexArray.emplace(x,f[0],f[1],m[0],m[1]);else{for(var E=e;E<t;E++)this.paintVertexArray.emplace(E,i,u);this.maxValue=Math.max(this.maxValue,Math.abs(i),Math.abs(u))}},Ft.prototype.upload=function(e){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=e.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))},Ft.prototype.destroy=function(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()},Ft.prototype.setUniform=function(e,t){var i=this.useIntegerZoom?Math.floor(t.zoom):t.zoom,u=le(this.expression.interpolationFactor(i,this.zoom,this.zoom+1),0,1);e.set(u)},Ft.prototype.getBinding=function(e,t,i){return new Je(e,t)};var Xt=function(e,t,i,u,f,m){this.expression=e,this.type=t,this.useIntegerZoom=i,this.zoom=u,this.layerId=m,this.zoomInPaintVertexArray=new f,this.zoomOutPaintVertexArray=new f};Xt.prototype.populatePaintArray=function(e,t,i){var u=this.zoomInPaintVertexArray.length;this.zoomInPaintVertexArray.resize(e),this.zoomOutPaintVertexArray.resize(e),this._setPaintValues(u,e,t.patterns&&t.patterns[this.layerId],i)},Xt.prototype.updatePaintArray=function(e,t,i,u,f){this._setPaintValues(e,t,i.patterns&&i.patterns[this.layerId],f)},Xt.prototype._setPaintValues=function(e,t,i,u){if(u&&i){var f=u[i.min],m=u[i.mid],x=u[i.max];if(f&&m&&x)for(var E=e;E<t;E++)this.zoomInPaintVertexArray.emplace(E,m.tl[0],m.tl[1],m.br[0],m.br[1],f.tl[0],f.tl[1],f.br[0],f.br[1],m.pixelRatio,f.pixelRatio),this.zoomOutPaintVertexArray.emplace(E,m.tl[0],m.tl[1],m.br[0],m.br[1],x.tl[0],x.tl[1],x.br[0],x.br[1],m.pixelRatio,x.pixelRatio)}},Xt.prototype.upload=function(e){this.zoomInPaintVertexArray&&this.zoomInPaintVertexArray.arrayBuffer&&this.zoomOutPaintVertexArray&&this.zoomOutPaintVertexArray.arrayBuffer&&(this.zoomInPaintVertexBuffer=e.createVertexBuffer(this.zoomInPaintVertexArray,re.members,this.expression.isStateDependent),this.zoomOutPaintVertexBuffer=e.createVertexBuffer(this.zoomOutPaintVertexArray,re.members,this.expression.isStateDependent))},Xt.prototype.destroy=function(){this.zoomOutPaintVertexBuffer&&this.zoomOutPaintVertexBuffer.destroy(),this.zoomInPaintVertexBuffer&&this.zoomInPaintVertexBuffer.destroy()};var Rt=function(e,t,i){this.binders={},this._buffers=[];var u=[];for(var f in e.paint._values)if(i(f)){var m=e.paint.get(f);if(m instanceof _n&&bo(m.property.specification)){var x=Li(f,e.type),E=m.value,z=m.property.specification.type,A=m.property.useIntegerZoom,D=m.property.specification["property-type"],B=D==="cross-faded"||D==="cross-faded-data-driven";if(E.kind==="constant")this.binders[f]=B?new Yt(E.value,x):new Ut(E.value,x,z),u.push("/u_"+f);else if(E.kind==="source"||B){var q=si(f,z,"source");this.binders[f]=B?new Xt(E,z,A,t,q,e.id):new Ot(E,x,z,q),u.push("/a_"+f)}else{var G=si(f,z,"composite");this.binders[f]=new Ft(E,x,z,A,t,G),u.push("/z_"+f)}}}this.cacheKey=u.sort().join("")};Rt.prototype.getMaxValue=function(e){var t=this.binders[e];return t instanceof Ot||t instanceof Ft?t.maxValue:0},Rt.prototype.populatePaintArrays=function(e,t,i,u,f){for(var m in this.binders){var x=this.binders[m];(x instanceof Ot||x instanceof Ft||x instanceof Xt)&&x.populatePaintArray(e,t,i,u,f)}},Rt.prototype.setConstantPatternPositions=function(e,t){for(var i in this.binders){var u=this.binders[i];u instanceof Yt&&u.setConstantPatternPositions(e,t)}},Rt.prototype.updatePaintArrays=function(e,t,i,u,f){var m=!1;for(var x in e)for(var E=0,z=t.getPositions(x);E<z.length;E+=1){var A=z[E],D=i.feature(A.index);for(var B in this.binders){var q=this.binders[B];if((q instanceof Ot||q instanceof Ft||q instanceof Xt)&&q.expression.isStateDependent===!0){var G=u.paint.get(B);q.expression=G.value,q.updatePaintArray(A.start,A.end,D,e[x],f),m=!0}}}return m},Rt.prototype.defines=function(){var e=[];for(var t in this.binders){var i=this.binders[t];(i instanceof Ut||i instanceof Yt)&&e.push.apply(e,i.uniformNames.map(function(u){return"#define HAS_UNIFORM_"+u}))}return e},Rt.prototype.getBinderAttributes=function(){var e=[];for(var t in this.binders){var i=this.binders[t];if(i instanceof Ot||i instanceof Ft)for(var u=0;u<i.paintVertexAttributes.length;u++)e.push(i.paintVertexAttributes[u].name);else if(i instanceof Xt)for(var f=0;f<re.members.length;f++)e.push(re.members[f].name)}return e},Rt.prototype.getBinderUniforms=function(){var e=[];for(var t in this.binders){var i=this.binders[t];if(i instanceof Ut||i instanceof Yt||i instanceof Ft)for(var u=0,f=i.uniformNames;u<f.length;u+=1)e.push(f[u])}return e},Rt.prototype.getPaintVertexBuffers=function(){return this._buffers},Rt.prototype.getUniforms=function(e,t){var i=[];for(var u in this.binders){var f=this.binders[u];if(f instanceof Ut||f instanceof Yt||f instanceof Ft)for(var m=0,x=f.uniformNames;m<x.length;m+=1){var E=x[m];if(t[E]){var z=f.getBinding(e,t[E],E);i.push({name:E,property:u,binding:z})}}}return i},Rt.prototype.setUniforms=function(e,t,i,u){for(var f=0,m=t;f<m.length;f+=1){var x=m[f],E=x.name,z=x.property;this.binders[z].setUniform(x.binding,u,i.get(z),E)}},Rt.prototype.updatePaintBuffers=function(e){for(var t in this._buffers=[],this.binders){var i=this.binders[t];if(e&&i instanceof Xt){var u=e.fromScale===2?i.zoomInPaintVertexBuffer:i.zoomOutPaintVertexBuffer;u&&this._buffers.push(u)}else(i instanceof Ot||i instanceof Ft)&&i.paintVertexBuffer&&this._buffers.push(i.paintVertexBuffer)}},Rt.prototype.upload=function(e){for(var t in this.binders){var i=this.binders[t];(i instanceof Ot||i instanceof Ft||i instanceof Xt)&&i.upload(e)}this.updatePaintBuffers()},Rt.prototype.destroy=function(){for(var e in this.binders){var t=this.binders[e];(t instanceof Ot||t instanceof Ft||t instanceof Xt)&&t.destroy()}};var Dt=function(e,t,i){i===void 0&&(i=function(){return!0}),this.programConfigurations={};for(var u=0,f=e;u<f.length;u+=1){var m=f[u];this.programConfigurations[m.id]=new Rt(m,t,i)}this.needsUpload=!1,this._featureMap=new fe,this._bufferOffset=0};function Li(e,t){return{"text-opacity":["opacity"],"icon-opacity":["opacity"],"text-color":["fill_color"],"icon-color":["fill_color"],"text-halo-color":["halo_color"],"icon-halo-color":["halo_color"],"text-halo-blur":["halo_blur"],"icon-halo-blur":["halo_blur"],"text-halo-width":["halo_width"],"icon-halo-width":["halo_width"],"line-gap-width":["gapwidth"],"line-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-extrusion-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"]}[e]||[e.replace(t+"-","").replace(/-/g,"_")]}function si(e,t,i){var u={color:{source:Go,composite:il},number:{source:Ja,composite:Go}},f=function(m){return{"line-pattern":{source:Ia,composite:Ia},"fill-pattern":{source:Ia,composite:Ia},"fill-extrusion-pattern":{source:Ia,composite:Ia}}[m]}(e);return f&&f[i]||u[t][i]}Dt.prototype.populatePaintArrays=function(e,t,i,u,f,m){for(var x in this.programConfigurations)this.programConfigurations[x].populatePaintArrays(e,t,u,f,m);t.id!==void 0&&this._featureMap.add(t.id,i,this._bufferOffset,e),this._bufferOffset=e,this.needsUpload=!0},Dt.prototype.updatePaintArrays=function(e,t,i,u){for(var f=0,m=i;f<m.length;f+=1){var x=m[f];this.needsUpload=this.programConfigurations[x.id].updatePaintArrays(e,this._featureMap,t,x,u)||this.needsUpload}},Dt.prototype.get=function(e){return this.programConfigurations[e]},Dt.prototype.upload=function(e){if(this.needsUpload){for(var t in this.programConfigurations)this.programConfigurations[t].upload(e);this.needsUpload=!1}},Dt.prototype.destroy=function(){for(var e in this.programConfigurations)this.programConfigurations[e].destroy()},pt("ConstantBinder",Ut),pt("CrossFadedConstantBinder",Yt),pt("SourceExpressionBinder",Ot),pt("CrossFadedCompositeBinder",Xt),pt("CompositeExpressionBinder",Ft),pt("ProgramConfiguration",Rt,{omit:["_buffers"]}),pt("ProgramConfigurationSet",Dt);var hn=Math.pow(2,14)-1,Ki=-hn-1;function ri(e){for(var t=8192/e.extent,i=e.loadGeometry(),u=0;u<i.length;u++)for(var f=i[u],m=0;m<f.length;m++){var x=f[m],E=Math.round(x.x*t),z=Math.round(x.y*t);x.x=le(E,Ki,hn),x.y=le(z,Ki,hn),(E<x.x||E>x.x+1||z<x.y||z>x.y+1)&&qe("Geometry exceeds allowed extent, reduce your vector tile buffer size")}return i}function fi(e,t){return{type:e.type,id:e.id,properties:e.properties,geometry:t?ri(e):[]}}function Hn(e,t,i,u,f){e.emplaceBack(2*t+(u+1)/2,2*i+(f+1)/2)}var bn=function(e){this.zoom=e.zoom,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map(function(t){return t.id}),this.index=e.index,this.hasPattern=!1,this.layoutVertexArray=new ko,this.indexArray=new Wa,this.segments=new K,this.programConfigurations=new Dt(e.layers,e.zoom),this.stateDependentLayerIds=this.layers.filter(function(t){return t.isStateDependent()}).map(function(t){return t.id})};function Qa(e,t){for(var i=0;i<e.length;i++)if(Pa(t,e[i]))return!0;for(var u=0;u<t.length;u++)if(Pa(e,t[u]))return!0;return!!Ss(e,t)}function An(e,t,i){return!!Pa(e,t)||!!$a(t,e,i)}function _a(e,t){if(e.length===1)return Es(t,e[0]);for(var i=0;i<t.length;i++)for(var u=t[i],f=0;f<u.length;f++)if(Pa(e,u[f]))return!0;for(var m=0;m<e.length;m++)if(Es(t,e[m]))return!0;for(var x=0;x<t.length;x++)if(Ss(e,t[x]))return!0;return!1}function sa(e,t,i){if(e.length>1){if(Ss(e,t))return!0;for(var u=0;u<t.length;u++)if($a(t[u],e,i))return!0}for(var f=0;f<e.length;f++)if($a(e[f],t,i))return!0;return!1}function Ss(e,t){if(e.length===0||t.length===0)return!1;for(var i=0;i<e.length-1;i++)for(var u=e[i],f=e[i+1],m=0;m<t.length-1;m++)if(Ho(u,f,t[m],t[m+1]))return!0;return!1}function Ho(e,t,i,u){return Bt(e,i,u)!==Bt(t,i,u)&&Bt(e,t,i)!==Bt(e,t,u)}function $a(e,t,i){var u=i*i;if(t.length===1)return e.distSqr(t[0])<u;for(var f=1;f<t.length;f++)if(Xo(e,t[f-1],t[f])<u)return!0;return!1}function Xo(e,t,i){var u=t.distSqr(i);if(u===0)return e.distSqr(t);var f=((e.x-t.x)*(i.x-t.x)+(e.y-t.y)*(i.y-t.y))/u;return e.distSqr(f<0?t:f>1?i:i.sub(t)._mult(f)._add(t))}function Es(e,t){for(var i,u,f,m=!1,x=0;x<e.length;x++)for(var E=0,z=(i=e[x]).length-1;E<i.length;z=E++)(u=i[E]).y>t.y!=(f=i[z]).y>t.y&&t.x<(f.x-u.x)*(t.y-u.y)/(f.y-u.y)+u.x&&(m=!m);return m}function Pa(e,t){for(var i=!1,u=0,f=e.length-1;u<e.length;f=u++){var m=e[u],x=e[f];m.y>t.y!=x.y>t.y&&t.x<(x.x-m.x)*(t.y-m.y)/(x.y-m.y)+m.x&&(i=!i)}return i}function ks(e,t,i){var u=i[0],f=i[2];if(e.x<u.x&&t.x<u.x||e.x>f.x&&t.x>f.x||e.y<u.y&&t.y<u.y||e.y>f.y&&t.y>f.y)return!1;var m=Bt(e,t,i[0]);return m!==Bt(e,t,i[1])||m!==Bt(e,t,i[2])||m!==Bt(e,t,i[3])}function za(e,t,i){var u=t.paint.get(e).value;return u.kind==="constant"?u.value:i.programConfigurations.get(t.id).getMaxValue(e)}function Ri(e){return Math.sqrt(e[0]*e[0]+e[1]*e[1])}function La(e,t,i,u,f){if(!t[0]&&!t[1])return e;var m=M.convert(t)._mult(f);i==="viewport"&&m._rotate(-u);for(var x=[],E=0;E<e.length;E++)x.push(e[E].sub(m));return x}bn.prototype.populate=function(e,t,i){var u=this.layers[0],f=[],m=null;u.type==="circle"&&(m=u.layout.get("circle-sort-key"));for(var x=0,E=e;x<E.length;x+=1){var z=E[x],A=z.feature,D=z.id,B=z.index,q=z.sourceLayerIndex,G=this.layers[0]._featureFilter.needGeometry,J=fi(A,G);if(this.layers[0]._featureFilter.filter(new rr(this.zoom),J,i)){var ee=m?m.evaluate(J,{},i):void 0,he={id:D,properties:A.properties,type:A.type,sourceLayerIndex:q,index:B,geometry:G?J.geometry:ri(A),patterns:{},sortKey:ee};f.push(he)}}m&&f.sort(function($e,bt){return $e.sortKey-bt.sortKey});for(var oe=0,ye=f;oe<ye.length;oe+=1){var be=ye[oe],Ee=be.geometry,Te=be.index,Me=be.sourceLayerIndex,Ke=e[Te].feature;this.addFeature(be,Ee,Te,i),t.featureIndex.insert(Ke,Ee,Te,Me,this.index)}},bn.prototype.update=function(e,t,i){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(e,t,this.stateDependentLayers,i)},bn.prototype.isEmpty=function(){return this.layoutVertexArray.length===0},bn.prototype.uploadPending=function(){return!this.uploaded||this.programConfigurations.needsUpload},bn.prototype.upload=function(e){this.uploaded||(this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,Z),this.indexBuffer=e.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(e),this.uploaded=!0},bn.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())},bn.prototype.addFeature=function(e,t,i,u){for(var f=0,m=t;f<m.length;f+=1)for(var x=0,E=m[f];x<E.length;x+=1){var z=E[x],A=z.x,D=z.y;if(!(A<0||A>=8192||D<0||D>=8192)){var B=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray,e.sortKey),q=B.vertexLength;Hn(this.layoutVertexArray,A,D,-1,-1),Hn(this.layoutVertexArray,A,D,1,-1),Hn(this.layoutVertexArray,A,D,1,1),Hn(this.layoutVertexArray,A,D,-1,1),this.indexArray.emplaceBack(q,q+1,q+2),this.indexArray.emplaceBack(q,q+3,q+2),B.vertexLength+=4,B.primitiveLength+=2}}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,e,i,{},u)},pt("CircleBucket",bn,{omit:["layers"]});var eo=new rn({"circle-sort-key":new _t(j.layout_circle["circle-sort-key"])}),Io={paint:new rn({"circle-radius":new _t(j.paint_circle["circle-radius"]),"circle-color":new _t(j.paint_circle["circle-color"]),"circle-blur":new _t(j.paint_circle["circle-blur"]),"circle-opacity":new _t(j.paint_circle["circle-opacity"]),"circle-translate":new St(j.paint_circle["circle-translate"]),"circle-translate-anchor":new St(j.paint_circle["circle-translate-anchor"]),"circle-pitch-scale":new St(j.paint_circle["circle-pitch-scale"]),"circle-pitch-alignment":new St(j.paint_circle["circle-pitch-alignment"]),"circle-stroke-width":new _t(j.paint_circle["circle-stroke-width"]),"circle-stroke-color":new _t(j.paint_circle["circle-stroke-color"]),"circle-stroke-opacity":new _t(j.paint_circle["circle-stroke-opacity"])}),layout:eo},Er=typeof Float32Array<"u"?Float32Array:Array;function ta(e){return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}function Cn(e,t,i){var u=t[0],f=t[1],m=t[2],x=t[3],E=t[4],z=t[5],A=t[6],D=t[7],B=t[8],q=t[9],G=t[10],J=t[11],ee=t[12],he=t[13],oe=t[14],ye=t[15],be=i[0],Ee=i[1],Te=i[2],Me=i[3];return e[0]=be*u+Ee*E+Te*B+Me*ee,e[1]=be*f+Ee*z+Te*q+Me*he,e[2]=be*m+Ee*A+Te*G+Me*oe,e[3]=be*x+Ee*D+Te*J+Me*ye,e[4]=(be=i[4])*u+(Ee=i[5])*E+(Te=i[6])*B+(Me=i[7])*ee,e[5]=be*f+Ee*z+Te*q+Me*he,e[6]=be*m+Ee*A+Te*G+Me*oe,e[7]=be*x+Ee*D+Te*J+Me*ye,e[8]=(be=i[8])*u+(Ee=i[9])*E+(Te=i[10])*B+(Me=i[11])*ee,e[9]=be*f+Ee*z+Te*q+Me*he,e[10]=be*m+Ee*A+Te*G+Me*oe,e[11]=be*x+Ee*D+Te*J+Me*ye,e[12]=(be=i[12])*u+(Ee=i[13])*E+(Te=i[14])*B+(Me=i[15])*ee,e[13]=be*f+Ee*z+Te*q+Me*he,e[14]=be*m+Ee*A+Te*G+Me*oe,e[15]=be*x+Ee*D+Te*J+Me*ye,e}Math.hypot||(Math.hypot=function(){for(var e=arguments,t=0,i=arguments.length;i--;)t+=e[i]*e[i];return Math.sqrt(t)});var Po,jh=Cn;function nl(e,t,i){var u=t[0],f=t[1],m=t[2],x=t[3];return e[0]=i[0]*u+i[4]*f+i[8]*m+i[12]*x,e[1]=i[1]*u+i[5]*f+i[9]*m+i[13]*x,e[2]=i[2]*u+i[6]*f+i[10]*m+i[14]*x,e[3]=i[3]*u+i[7]*f+i[11]*m+i[15]*x,e}Po=new Er(3),Er!=Float32Array&&(Po[0]=0,Po[1]=0,Po[2]=0),function(){var e=new Er(4);Er!=Float32Array&&(e[0]=0,e[1]=0,e[2]=0,e[3]=0)}();var Gh=(function(){var e=new Er(2);Er!=Float32Array&&(e[0]=0,e[1]=0)}(),function(e){function t(i){e.call(this,i,Io)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.createBucket=function(i){return new bn(i)},t.prototype.queryRadius=function(i){var u=i;return za("circle-radius",this,u)+za("circle-stroke-width",this,u)+Ri(this.paint.get("circle-translate"))},t.prototype.queryIntersectsFeature=function(i,u,f,m,x,E,z,A){for(var D=La(i,this.paint.get("circle-translate"),this.paint.get("circle-translate-anchor"),E.angle,z),B=this.paint.get("circle-radius").evaluate(u,f)+this.paint.get("circle-stroke-width").evaluate(u,f),q=this.paint.get("circle-pitch-alignment")==="map",G=q?D:function(Ke,$e){return Ke.map(function(bt){return Ts(bt,$e)})}(D,A),J=q?B*z:B,ee=0,he=m;ee<he.length;ee+=1)for(var oe=0,ye=he[ee];oe<ye.length;oe+=1){var be=ye[oe],Ee=q?be:Ts(be,A),Te=J,Me=nl([],[be.x,be.y,0,1],A);if(this.paint.get("circle-pitch-scale")==="viewport"&&this.paint.get("circle-pitch-alignment")==="map"?Te*=Me[3]/E.cameraToCenterDistance:this.paint.get("circle-pitch-scale")==="map"&&this.paint.get("circle-pitch-alignment")==="viewport"&&(Te*=E.cameraToCenterDistance/Me[3]),An(G,Ee,Te))return!0}return!1},t}(Ta));function Ts(e,t){var i=nl([],[e.x,e.y,0,1],t);return new M(i[0]/i[3],i[1]/i[3])}var Ic=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t}(bn);function Wo(e,t,i,u){var f=t.width,m=t.height;if(u){if(u instanceof Uint8ClampedArray)u=new Uint8Array(u.buffer);else if(u.length!==f*m*i)throw new RangeError("mismatched image size")}else u=new Uint8Array(f*m*i);return e.width=f,e.height=m,e.data=u,e}function al(e,t,i){var u=t.width,f=t.height;if(u!==e.width||f!==e.height){var m=Wo({},{width:u,height:f},i);Zh(e,m,{x:0,y:0},{x:0,y:0},{width:Math.min(e.width,u),height:Math.min(e.height,f)},i),e.width=u,e.height=f,e.data=m.data}}function Zh(e,t,i,u,f,m){if(f.width===0||f.height===0)return t;if(f.width>e.width||f.height>e.height||i.x>e.width-f.width||i.y>e.height-f.height)throw new RangeError("out of range source coordinates for image copy");if(f.width>t.width||f.height>t.height||u.x>t.width-f.width||u.y>t.height-f.height)throw new RangeError("out of range destination coordinates for image copy");for(var x=e.data,E=t.data,z=0;z<f.height;z++)for(var A=((i.y+z)*e.width+i.x)*m,D=((u.y+z)*t.width+u.x)*m,B=0;B<f.width*m;B++)E[D+B]=x[A+B];return t}pt("HeatmapBucket",Ic,{omit:["layers"]});var Is=function(e,t){Wo(this,e,1,t)};Is.prototype.resize=function(e){al(this,e,1)},Is.prototype.clone=function(){return new Is({width:this.width,height:this.height},new Uint8Array(this.data))},Is.copy=function(e,t,i,u,f){Zh(e,t,i,u,f,1)};var Xn=function(e,t){Wo(this,e,4,t)};Xn.prototype.resize=function(e){al(this,e,4)},Xn.prototype.replace=function(e,t){t?this.data.set(e):this.data=e instanceof Uint8ClampedArray?new Uint8Array(e.buffer):e},Xn.prototype.clone=function(){return new Xn({width:this.width,height:this.height},new Uint8Array(this.data))},Xn.copy=function(e,t,i,u,f){Zh(e,t,i,u,f,4)},pt("AlphaImage",Is),pt("RGBAImage",Xn);var Ty={paint:new rn({"heatmap-radius":new _t(j.paint_heatmap["heatmap-radius"]),"heatmap-weight":new _t(j.paint_heatmap["heatmap-weight"]),"heatmap-intensity":new St(j.paint_heatmap["heatmap-intensity"]),"heatmap-color":new ga(j.paint_heatmap["heatmap-color"]),"heatmap-opacity":new St(j.paint_heatmap["heatmap-opacity"])})};function Yp(e){var t={},i=e.resolution||256,u=e.clips?e.clips.length:1,f=e.image||new Xn({width:i,height:u}),m=function(J,ee,he){t[e.evaluationKey]=he;var oe=e.expression.evaluate(t);f.data[J+ee+0]=Math.floor(255*oe.r/oe.a),f.data[J+ee+1]=Math.floor(255*oe.g/oe.a),f.data[J+ee+2]=Math.floor(255*oe.b/oe.a),f.data[J+ee+3]=Math.floor(255*oe.a)};if(e.clips)for(var x=0,E=0;x<u;++x,E+=4*i)for(var z=0,A=0;z<i;z++,A+=4){var D=z/(i-1),B=e.clips[x];m(E,A,B.start*(1-D)+B.end*D)}else for(var q=0,G=0;q<i;q++,G+=4)m(0,G,q/(i-1));return f}var Iy=function(e){function t(i){e.call(this,i,Ty),this._updateColorRamp()}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.createBucket=function(i){return new Ic(i)},t.prototype._handleSpecialPaintPropertyUpdate=function(i){i==="heatmap-color"&&this._updateColorRamp()},t.prototype._updateColorRamp=function(){this.colorRamp=Yp({expression:this._transitionablePaint._values["heatmap-color"].value.expression,evaluationKey:"heatmapDensity",image:this.colorRamp}),this.colorRampTexture=null},t.prototype.resize=function(){this.heatmapFbo&&(this.heatmapFbo.destroy(),this.heatmapFbo=null)},t.prototype.queryRadius=function(){return 0},t.prototype.queryIntersectsFeature=function(){return!1},t.prototype.hasOffscreenPass=function(){return this.paint.get("heatmap-opacity")!==0&&this.visibility!=="none"},t}(Ta),Py={paint:new rn({"hillshade-illumination-direction":new St(j.paint_hillshade["hillshade-illumination-direction"]),"hillshade-illumination-anchor":new St(j.paint_hillshade["hillshade-illumination-anchor"]),"hillshade-exaggeration":new St(j.paint_hillshade["hillshade-exaggeration"]),"hillshade-shadow-color":new St(j.paint_hillshade["hillshade-shadow-color"]),"hillshade-highlight-color":new St(j.paint_hillshade["hillshade-highlight-color"]),"hillshade-accent-color":new St(j.paint_hillshade["hillshade-accent-color"])})},zy=function(e){function t(i){e.call(this,i,Py)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.hasOffscreenPass=function(){return this.paint.get("hillshade-exaggeration")!==0&&this.visibility!=="none"},t}(Ta),Ay=Zi([{name:"a_pos",components:2,type:"Int16"}],4).members,Kh=Pc,Cy=Pc;function Pc(e,t,i){i=i||2;var u,f,m,x,E,z,A,D=t&&t.length,B=D?t[0]*i:e.length,q=Jp(e,0,B,i,!0),G=[];if(!q||q.next===q.prev)return G;if(D&&(q=function(ee,he,oe,ye){var be,Ee,Te,Me=[];for(be=0,Ee=he.length;be<Ee;be++)(Te=Jp(ee,he[be]*ye,be<Ee-1?he[be+1]*ye:ee.length,ye,!1))===Te.next&&(Te.steiner=!0),Me.push(Ny(Te));for(Me.sort(By),be=0;be<Me.length;be++)Fy(Me[be],oe),oe=Yo(oe,oe.next);return oe}(e,t,q,i)),e.length>80*i){u=m=e[0],f=x=e[1];for(var J=i;J<B;J+=i)(E=e[J])<u&&(u=E),(z=e[J+1])<f&&(f=z),E>m&&(m=E),z>x&&(x=z);A=(A=Math.max(m-u,x-f))!==0?1/A:0}return uu(q,G,i,u,f,A),G}function Jp(e,t,i,u,f){var m,x;if(f===Wh(e,t,i,u)>0)for(m=t;m<i;m+=u)x=ef(m,e[m],e[m+1],x);else for(m=i-u;m>=t;m-=u)x=ef(m,e[m],e[m+1],x);return x&&zc(x,x.next)&&(hu(x),x=x.next),x}function Yo(e,t){if(!e)return e;t||(t=e);var i,u=e;do if(i=!1,u.steiner||!zc(u,u.next)&&zi(u.prev,u,u.next)!==0)u=u.next;else{if(hu(u),(u=t=u.prev)===u.next)break;i=!0}while(i||u!==t);return t}function uu(e,t,i,u,f,m,x){if(e){!x&&m&&function(D,B,q,G){var J=D;do J.z===null&&(J.z=Hh(J.x,J.y,B,q,G)),J.prevZ=J.prev,J.nextZ=J.next,J=J.next;while(J!==D);J.prevZ.nextZ=null,J.prevZ=null,function(ee){var he,oe,ye,be,Ee,Te,Me,Ke,$e=1;do{for(oe=ee,ee=null,Ee=null,Te=0;oe;){for(Te++,ye=oe,Me=0,he=0;he<$e&&(Me++,ye=ye.nextZ);he++);for(Ke=$e;Me>0||Ke>0&&ye;)Me!==0&&(Ke===0||!ye||oe.z<=ye.z)?(be=oe,oe=oe.nextZ,Me--):(be=ye,ye=ye.nextZ,Ke--),Ee?Ee.nextZ=be:ee=be,be.prevZ=Ee,Ee=be;oe=ye}Ee.nextZ=null,$e*=2}while(Te>1)}(J)}(e,u,f,m);for(var E,z,A=e;e.prev!==e.next;)if(E=e.prev,z=e.next,m?Dy(e,u,f,m):My(e))t.push(E.i/i),t.push(e.i/i),t.push(z.i/i),hu(e),e=z.next,A=z.next;else if((e=z)===A){x?x===1?uu(e=Ly(Yo(e),t,i),t,i,u,f,m,2):x===2&&Ry(e,t,i,u,f,m):uu(Yo(e),t,i,u,f,m,1);break}}}function My(e){var t=e.prev,i=e,u=e.next;if(zi(t,i,u)>=0)return!1;for(var f=e.next.next;f!==e.prev;){if(ol(t.x,t.y,i.x,i.y,u.x,u.y,f.x,f.y)&&zi(f.prev,f,f.next)>=0)return!1;f=f.next}return!0}function Dy(e,t,i,u){var f=e.prev,m=e,x=e.next;if(zi(f,m,x)>=0)return!1;for(var E=f.x>m.x?f.x>x.x?f.x:x.x:m.x>x.x?m.x:x.x,z=f.y>m.y?f.y>x.y?f.y:x.y:m.y>x.y?m.y:x.y,A=Hh(f.x<m.x?f.x<x.x?f.x:x.x:m.x<x.x?m.x:x.x,f.y<m.y?f.y<x.y?f.y:x.y:m.y<x.y?m.y:x.y,t,i,u),D=Hh(E,z,t,i,u),B=e.prevZ,q=e.nextZ;B&&B.z>=A&&q&&q.z<=D;){if(B!==e.prev&&B!==e.next&&ol(f.x,f.y,m.x,m.y,x.x,x.y,B.x,B.y)&&zi(B.prev,B,B.next)>=0||(B=B.prevZ,q!==e.prev&&q!==e.next&&ol(f.x,f.y,m.x,m.y,x.x,x.y,q.x,q.y)&&zi(q.prev,q,q.next)>=0))return!1;q=q.nextZ}for(;B&&B.z>=A;){if(B!==e.prev&&B!==e.next&&ol(f.x,f.y,m.x,m.y,x.x,x.y,B.x,B.y)&&zi(B.prev,B,B.next)>=0)return!1;B=B.prevZ}for(;q&&q.z<=D;){if(q!==e.prev&&q!==e.next&&ol(f.x,f.y,m.x,m.y,x.x,x.y,q.x,q.y)&&zi(q.prev,q,q.next)>=0)return!1;q=q.nextZ}return!0}function Ly(e,t,i){var u=e;do{var f=u.prev,m=u.next.next;!zc(f,m)&&Qp(f,u,u.next,m)&&cu(f,m)&&cu(m,f)&&(t.push(f.i/i),t.push(u.i/i),t.push(m.i/i),hu(u),hu(u.next),u=e=m),u=u.next}while(u!==e);return Yo(u)}function Ry(e,t,i,u,f,m){var x=e;do{for(var E=x.next.next;E!==x.prev;){if(x.i!==E.i&&Uy(x,E)){var z=$p(x,E);return x=Yo(x,x.next),z=Yo(z,z.next),uu(x,t,i,u,f,m),void uu(z,t,i,u,f,m)}E=E.next}x=x.next}while(x!==e)}function By(e,t){return e.x-t.x}function Fy(e,t){if(t=function(u,f){var m,x=f,E=u.x,z=u.y,A=-1/0;do{if(z<=x.y&&z>=x.next.y&&x.next.y!==x.y){var D=x.x+(z-x.y)*(x.next.x-x.x)/(x.next.y-x.y);if(D<=E&&D>A){if(A=D,D===E){if(z===x.y)return x;if(z===x.next.y)return x.next}m=x.x<x.next.x?x:x.next}}x=x.next}while(x!==f);if(!m)return null;if(E===A)return m;var B,q=m,G=m.x,J=m.y,ee=1/0;x=m;do E>=x.x&&x.x>=G&&E!==x.x&&ol(z<J?E:A,z,G,J,z<J?A:E,z,x.x,x.y)&&(B=Math.abs(z-x.y)/(E-x.x),cu(x,u)&&(B<ee||B===ee&&(x.x>m.x||x.x===m.x&&Oy(m,x)))&&(m=x,ee=B)),x=x.next;while(x!==q);return m}(e,t)){var i=$p(t,e);Yo(t,t.next),Yo(i,i.next)}}function Oy(e,t){return zi(e.prev,e,t.prev)<0&&zi(t.next,e,e.next)<0}function Hh(e,t,i,u,f){return(e=1431655765&((e=858993459&((e=252645135&((e=16711935&((e=32767*(e-i)*f)|e<<8))|e<<4))|e<<2))|e<<1))|(t=1431655765&((t=858993459&((t=252645135&((t=16711935&((t=32767*(t-u)*f)|t<<8))|t<<4))|t<<2))|t<<1))<<1}function Ny(e){var t=e,i=e;do(t.x<i.x||t.x===i.x&&t.y<i.y)&&(i=t),t=t.next;while(t!==e);return i}function ol(e,t,i,u,f,m,x,E){return(f-x)*(t-E)-(e-x)*(m-E)>=0&&(e-x)*(u-E)-(i-x)*(t-E)>=0&&(i-x)*(m-E)-(f-x)*(u-E)>=0}function Uy(e,t){return e.next.i!==t.i&&e.prev.i!==t.i&&!function(i,u){var f=i;do{if(f.i!==i.i&&f.next.i!==i.i&&f.i!==u.i&&f.next.i!==u.i&&Qp(f,f.next,i,u))return!0;f=f.next}while(f!==i);return!1}(e,t)&&(cu(e,t)&&cu(t,e)&&function(i,u){var f=i,m=!1,x=(i.x+u.x)/2,E=(i.y+u.y)/2;do f.y>E!=f.next.y>E&&f.next.y!==f.y&&x<(f.next.x-f.x)*(E-f.y)/(f.next.y-f.y)+f.x&&(m=!m),f=f.next;while(f!==i);return m}(e,t)&&(zi(e.prev,e,t.prev)||zi(e,t.prev,t))||zc(e,t)&&zi(e.prev,e,e.next)>0&&zi(t.prev,t,t.next)>0)}function zi(e,t,i){return(t.y-e.y)*(i.x-t.x)-(t.x-e.x)*(i.y-t.y)}function zc(e,t){return e.x===t.x&&e.y===t.y}function Qp(e,t,i,u){var f=Cc(zi(e,t,i)),m=Cc(zi(e,t,u)),x=Cc(zi(i,u,e)),E=Cc(zi(i,u,t));return f!==m&&x!==E||!(f!==0||!Ac(e,i,t))||!(m!==0||!Ac(e,u,t))||!(x!==0||!Ac(i,e,u))||!(E!==0||!Ac(i,t,u))}function Ac(e,t,i){return t.x<=Math.max(e.x,i.x)&&t.x>=Math.min(e.x,i.x)&&t.y<=Math.max(e.y,i.y)&&t.y>=Math.min(e.y,i.y)}function Cc(e){return e>0?1:e<0?-1:0}function cu(e,t){return zi(e.prev,e,e.next)<0?zi(e,t,e.next)>=0&&zi(e,e.prev,t)>=0:zi(e,t,e.prev)<0||zi(e,e.next,t)<0}function $p(e,t){var i=new Xh(e.i,e.x,e.y),u=new Xh(t.i,t.x,t.y),f=e.next,m=t.prev;return e.next=t,t.prev=e,i.next=f,f.prev=i,u.next=i,i.prev=u,m.next=u,u.prev=m,u}function ef(e,t,i,u){var f=new Xh(e,t,i);return u?(f.next=u.next,f.prev=u,u.next.prev=f,u.next=f):(f.prev=f,f.next=f),f}function hu(e){e.next.prev=e.prev,e.prev.next=e.next,e.prevZ&&(e.prevZ.nextZ=e.nextZ),e.nextZ&&(e.nextZ.prevZ=e.prevZ)}function Xh(e,t,i){this.i=e,this.x=t,this.y=i,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}function Wh(e,t,i,u){for(var f=0,m=t,x=i-u;m<i;m+=u)f+=(e[x]-e[m])*(e[m+1]+e[x+1]),x=m;return f}function Vy(e,t,i,u,f){(function m(x,E,z,A,D){for(;A>z;){if(A-z>600){var B=A-z+1,q=E-z+1,G=Math.log(B),J=.5*Math.exp(2*G/3),ee=.5*Math.sqrt(G*J*(B-J)/B)*(q-B/2<0?-1:1);m(x,E,Math.max(z,Math.floor(E-q*J/B+ee)),Math.min(A,Math.floor(E+(B-q)*J/B+ee)),D)}var he=x[E],oe=z,ye=A;for(pu(x,z,E),D(x[A],he)>0&&pu(x,z,A);oe<ye;){for(pu(x,oe,ye),oe++,ye--;D(x[oe],he)<0;)oe++;for(;D(x[ye],he)>0;)ye--}D(x[z],he)===0?pu(x,z,ye):pu(x,++ye,A),ye<=E&&(z=ye+1),E<=ye&&(A=ye-1)}})(e,t,i||0,u||e.length-1,f||qy)}function pu(e,t,i){var u=e[t];e[t]=e[i],e[i]=u}function qy(e,t){return e<t?-1:e>t?1:0}function Yh(e,t){var i=e.length;if(i<=1)return[e];for(var u,f,m=[],x=0;x<i;x++){var E=Re(e[x]);E!==0&&(e[x].area=Math.abs(E),f===void 0&&(f=E<0),f===E<0?(u&&m.push(u),u=[e[x]]):u.push(e[x]))}if(u&&m.push(u),t>1)for(var z=0;z<m.length;z++)m[z].length<=t||(Vy(m[z],t,1,m[z].length-1,jy),m[z]=m[z].slice(0,t));return m}function jy(e,t){return t.area-e.area}function Jh(e,t,i){for(var u=i.patternDependencies,f=!1,m=0,x=t;m<x.length;m+=1){var E=x[m].paint.get(e+"-pattern");E.isConstant()||(f=!0);var z=E.constantOr(null);z&&(f=!0,u[z.to]=!0,u[z.from]=!0)}return f}function Qh(e,t,i,u,f){for(var m=f.patternDependencies,x=0,E=t;x<E.length;x+=1){var z=E[x],A=z.paint.get(e+"-pattern").value;if(A.kind!=="constant"){var D=A.evaluate({zoom:u-1},i,{},f.availableImages),B=A.evaluate({zoom:u},i,{},f.availableImages),q=A.evaluate({zoom:u+1},i,{},f.availableImages);B=B&&B.name?B.name:B,q=q&&q.name?q.name:q,m[D=D&&D.name?D.name:D]=!0,m[B]=!0,m[q]=!0,i.patterns[z.id]={min:D,mid:B,max:q}}}return i}Pc.deviation=function(e,t,i,u){var f=t&&t.length,m=Math.abs(Wh(e,0,f?t[0]*i:e.length,i));if(f)for(var x=0,E=t.length;x<E;x++)m-=Math.abs(Wh(e,t[x]*i,x<E-1?t[x+1]*i:e.length,i));var z=0;for(x=0;x<u.length;x+=3){var A=u[x]*i,D=u[x+1]*i,B=u[x+2]*i;z+=Math.abs((e[A]-e[B])*(e[D+1]-e[A+1])-(e[A]-e[D])*(e[B+1]-e[A+1]))}return m===0&&z===0?0:Math.abs((z-m)/m)},Pc.flatten=function(e){for(var t=e[0][0].length,i={vertices:[],holes:[],dimensions:t},u=0,f=0;f<e.length;f++){for(var m=0;m<e[f].length;m++)for(var x=0;x<t;x++)i.vertices.push(e[f][m][x]);f>0&&i.holes.push(u+=e[f-1].length)}return i},Kh.default=Cy;var Ra=function(e){this.zoom=e.zoom,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map(function(t){return t.id}),this.index=e.index,this.hasPattern=!1,this.patternFeatures=[],this.layoutVertexArray=new ko,this.indexArray=new Wa,this.indexArray2=new ws,this.programConfigurations=new Dt(e.layers,e.zoom),this.segments=new K,this.segments2=new K,this.stateDependentLayerIds=this.layers.filter(function(t){return t.isStateDependent()}).map(function(t){return t.id})};Ra.prototype.populate=function(e,t,i){this.hasPattern=Jh("fill",this.layers,t);for(var u=this.layers[0].layout.get("fill-sort-key"),f=[],m=0,x=e;m<x.length;m+=1){var E=x[m],z=E.feature,A=E.id,D=E.index,B=E.sourceLayerIndex,q=this.layers[0]._featureFilter.needGeometry,G=fi(z,q);if(this.layers[0]._featureFilter.filter(new rr(this.zoom),G,i)){var J=u?u.evaluate(G,{},i,t.availableImages):void 0,ee={id:A,properties:z.properties,type:z.type,sourceLayerIndex:B,index:D,geometry:q?G.geometry:ri(z),patterns:{},sortKey:J};f.push(ee)}}u&&f.sort(function(Ke,$e){return Ke.sortKey-$e.sortKey});for(var he=0,oe=f;he<oe.length;he+=1){var ye=oe[he],be=ye.geometry,Ee=ye.index,Te=ye.sourceLayerIndex;if(this.hasPattern){var Me=Qh("fill",this.layers,ye,this.zoom,t);this.patternFeatures.push(Me)}else this.addFeature(ye,be,Ee,i,{});t.featureIndex.insert(e[Ee].feature,be,Ee,Te,this.index)}},Ra.prototype.update=function(e,t,i){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(e,t,this.stateDependentLayers,i)},Ra.prototype.addFeatures=function(e,t,i){for(var u=0,f=this.patternFeatures;u<f.length;u+=1){var m=f[u];this.addFeature(m,m.geometry,m.index,t,i)}},Ra.prototype.isEmpty=function(){return this.layoutVertexArray.length===0},Ra.prototype.uploadPending=function(){return!this.uploaded||this.programConfigurations.needsUpload},Ra.prototype.upload=function(e){this.uploaded||(this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,Ay),this.indexBuffer=e.createIndexBuffer(this.indexArray),this.indexBuffer2=e.createIndexBuffer(this.indexArray2)),this.programConfigurations.upload(e),this.uploaded=!0},Ra.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.indexBuffer2.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.segments2.destroy())},Ra.prototype.addFeature=function(e,t,i,u,f){for(var m=0,x=Yh(t,500);m<x.length;m+=1){for(var E=x[m],z=0,A=0,D=E;A<D.length;A+=1)z+=D[A].length;for(var B=this.segments.prepareSegment(z,this.layoutVertexArray,this.indexArray),q=B.vertexLength,G=[],J=[],ee=0,he=E;ee<he.length;ee+=1){var oe=he[ee];if(oe.length!==0){oe!==E[0]&&J.push(G.length/2);var ye=this.segments2.prepareSegment(oe.length,this.layoutVertexArray,this.indexArray2),be=ye.vertexLength;this.layoutVertexArray.emplaceBack(oe[0].x,oe[0].y),this.indexArray2.emplaceBack(be+oe.length-1,be),G.push(oe[0].x),G.push(oe[0].y);for(var Ee=1;Ee<oe.length;Ee++)this.layoutVertexArray.emplaceBack(oe[Ee].x,oe[Ee].y),this.indexArray2.emplaceBack(be+Ee-1,be+Ee),G.push(oe[Ee].x),G.push(oe[Ee].y);ye.vertexLength+=oe.length,ye.primitiveLength+=oe.length}}for(var Te=Kh(G,J),Me=0;Me<Te.length;Me+=3)this.indexArray.emplaceBack(q+Te[Me],q+Te[Me+1],q+Te[Me+2]);B.vertexLength+=z,B.primitiveLength+=Te.length/3}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,e,i,f,u)},pt("FillBucket",Ra,{omit:["layers","patternFeatures"]});var Gy=new rn({"fill-sort-key":new _t(j.layout_fill["fill-sort-key"])}),Zy={paint:new rn({"fill-antialias":new St(j.paint_fill["fill-antialias"]),"fill-opacity":new _t(j.paint_fill["fill-opacity"]),"fill-color":new _t(j.paint_fill["fill-color"]),"fill-outline-color":new _t(j.paint_fill["fill-outline-color"]),"fill-translate":new St(j.paint_fill["fill-translate"]),"fill-translate-anchor":new St(j.paint_fill["fill-translate-anchor"]),"fill-pattern":new $s(j.paint_fill["fill-pattern"])}),layout:Gy},Ky=function(e){function t(i){e.call(this,i,Zy)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.recalculate=function(i,u){e.prototype.recalculate.call(this,i,u);var f=this.paint._values["fill-outline-color"];f.value.kind==="constant"&&f.value.value===void 0&&(this.paint._values["fill-outline-color"]=this.paint._values["fill-color"])},t.prototype.createBucket=function(i){return new Ra(i)},t.prototype.queryRadius=function(){return Ri(this.paint.get("fill-translate"))},t.prototype.queryIntersectsFeature=function(i,u,f,m,x,E,z){return _a(La(i,this.paint.get("fill-translate"),this.paint.get("fill-translate-anchor"),E.angle,z),m)},t.prototype.isTileClipped=function(){return!0},t}(Ta),Hy=Zi([{name:"a_pos",components:2,type:"Int16"},{name:"a_normal_ed",components:4,type:"Int16"}],4).members,tf=sl;function sl(e,t,i,u,f){this.properties={},this.extent=i,this.type=0,this._pbf=e,this._geometry=-1,this._keys=u,this._values=f,e.readFields(Xy,this,t)}function Xy(e,t,i){e==1?t.id=i.readVarint():e==2?function(u,f){for(var m=u.readVarint()+u.pos;u.pos<m;){var x=f._keys[u.readVarint()],E=f._values[u.readVarint()];f.properties[x]=E}}(i,t):e==3?t.type=i.readVarint():e==4&&(t._geometry=i.pos)}function Wy(e){for(var t,i,u=0,f=0,m=e.length,x=m-1;f<m;x=f++)u+=((i=e[x]).x-(t=e[f]).x)*(t.y+i.y);return u}sl.types=["Unknown","Point","LineString","Polygon"],sl.prototype.loadGeometry=function(){var e=this._pbf;e.pos=this._geometry;for(var t,i=e.readVarint()+e.pos,u=1,f=0,m=0,x=0,E=[];e.pos<i;){if(f<=0){var z=e.readVarint();u=7&z,f=z>>3}if(f--,u===1||u===2)m+=e.readSVarint(),x+=e.readSVarint(),u===1&&(t&&E.push(t),t=[]),t.push(new M(m,x));else{if(u!==7)throw new Error("unknown command "+u);t&&t.push(t[0].clone())}}return t&&E.push(t),E},sl.prototype.bbox=function(){var e=this._pbf;e.pos=this._geometry;for(var t=e.readVarint()+e.pos,i=1,u=0,f=0,m=0,x=1/0,E=-1/0,z=1/0,A=-1/0;e.pos<t;){if(u<=0){var D=e.readVarint();i=7&D,u=D>>3}if(u--,i===1||i===2)(f+=e.readSVarint())<x&&(x=f),f>E&&(E=f),(m+=e.readSVarint())<z&&(z=m),m>A&&(A=m);else if(i!==7)throw new Error("unknown command "+i)}return[x,z,E,A]},sl.prototype.toGeoJSON=function(e,t,i){var u,f,m=this.extent*Math.pow(2,i),x=this.extent*e,E=this.extent*t,z=this.loadGeometry(),A=sl.types[this.type];function D(G){for(var J=0;J<G.length;J++){var ee=G[J];G[J]=[360*(ee.x+x)/m-180,360/Math.PI*Math.atan(Math.exp((180-360*(ee.y+E)/m)*Math.PI/180))-90]}}switch(this.type){case 1:var B=[];for(u=0;u<z.length;u++)B[u]=z[u][0];D(z=B);break;case 2:for(u=0;u<z.length;u++)D(z[u]);break;case 3:for(z=function(G){var J=G.length;if(J<=1)return[G];for(var ee,he,oe=[],ye=0;ye<J;ye++){var be=Wy(G[ye]);be!==0&&(he===void 0&&(he=be<0),he===be<0?(ee&&oe.push(ee),ee=[G[ye]]):ee.push(G[ye]))}return ee&&oe.push(ee),oe}(z),u=0;u<z.length;u++)for(f=0;f<z[u].length;f++)D(z[u][f])}z.length===1?z=z[0]:A="Multi"+A;var q={type:"Feature",geometry:{type:A,coordinates:z},properties:this.properties};return"id"in this&&(q.id=this.id),q};var rf=nf;function nf(e,t){this.version=1,this.name=null,this.extent=4096,this.length=0,this._pbf=e,this._keys=[],this._values=[],this._features=[],e.readFields(Yy,this,t),this.length=this._features.length}function Yy(e,t,i){e===15?t.version=i.readVarint():e===1?t.name=i.readString():e===5?t.extent=i.readVarint():e===2?t._features.push(i.pos):e===3?t._keys.push(i.readString()):e===4&&t._values.push(function(u){for(var f=null,m=u.readVarint()+u.pos;u.pos<m;){var x=u.readVarint()>>3;f=x===1?u.readString():x===2?u.readFloat():x===3?u.readDouble():x===4?u.readVarint64():x===5?u.readVarint():x===6?u.readSVarint():x===7?u.readBoolean():null}return f}(i))}function Jy(e,t,i){if(e===3){var u=new rf(i,i.readVarint()+i.pos);u.length&&(t[u.name]=u)}}nf.prototype.feature=function(e){if(e<0||e>=this._features.length)throw new Error("feature index out of bounds");this._pbf.pos=this._features[e];var t=this._pbf.readVarint()+this._pbf.pos;return new tf(this._pbf,t,this.extent,this._keys,this._values)};var ll={VectorTile:function(e,t){this.layers=e.readFields(Jy,{},t)},VectorTileFeature:tf,VectorTileLayer:rf},Qy=ll.VectorTileFeature.types,$h=Math.pow(2,13);function fu(e,t,i,u,f,m,x,E){e.emplaceBack(t,i,2*Math.floor(u*$h)+x,f*$h*2,m*$h*2,Math.round(E))}var Ba=function(e){this.zoom=e.zoom,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map(function(t){return t.id}),this.index=e.index,this.hasPattern=!1,this.layoutVertexArray=new Da,this.indexArray=new Wa,this.programConfigurations=new Dt(e.layers,e.zoom),this.segments=new K,this.stateDependentLayerIds=this.layers.filter(function(t){return t.isStateDependent()}).map(function(t){return t.id})};function $y(e,t){return e.x===t.x&&(e.x<0||e.x>8192)||e.y===t.y&&(e.y<0||e.y>8192)}Ba.prototype.populate=function(e,t,i){this.features=[],this.hasPattern=Jh("fill-extrusion",this.layers,t);for(var u=0,f=e;u<f.length;u+=1){var m=f[u],x=m.feature,E=m.id,z=m.index,A=m.sourceLayerIndex,D=this.layers[0]._featureFilter.needGeometry,B=fi(x,D);if(this.layers[0]._featureFilter.filter(new rr(this.zoom),B,i)){var q={id:E,sourceLayerIndex:A,index:z,geometry:D?B.geometry:ri(x),properties:x.properties,type:x.type,patterns:{}};this.hasPattern?this.features.push(Qh("fill-extrusion",this.layers,q,this.zoom,t)):this.addFeature(q,q.geometry,z,i,{}),t.featureIndex.insert(x,q.geometry,z,A,this.index,!0)}}},Ba.prototype.addFeatures=function(e,t,i){for(var u=0,f=this.features;u<f.length;u+=1){var m=f[u];this.addFeature(m,m.geometry,m.index,t,i)}},Ba.prototype.update=function(e,t,i){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(e,t,this.stateDependentLayers,i)},Ba.prototype.isEmpty=function(){return this.layoutVertexArray.length===0},Ba.prototype.uploadPending=function(){return!this.uploaded||this.programConfigurations.needsUpload},Ba.prototype.upload=function(e){this.uploaded||(this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,Hy),this.indexBuffer=e.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(e),this.uploaded=!0},Ba.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())},Ba.prototype.addFeature=function(e,t,i,u,f){for(var m=0,x=Yh(t,500);m<x.length;m+=1){for(var E=x[m],z=0,A=0,D=E;A<D.length;A+=1)z+=D[A].length;for(var B=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray),q=0,G=E;q<G.length;q+=1){var J=G[q];if(J.length!==0&&!((tr=J).every(function(Zt){return Zt.x<0})||tr.every(function(Zt){return Zt.x>8192})||tr.every(function(Zt){return Zt.y<0})||tr.every(function(Zt){return Zt.y>8192})))for(var ee=0,he=0;he<J.length;he++){var oe=J[he];if(he>=1){var ye=J[he-1];if(!$y(oe,ye)){B.vertexLength+4>K.MAX_VERTEX_ARRAY_LENGTH&&(B=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray));var be=oe.sub(ye)._perp()._unit(),Ee=ye.dist(oe);ee+Ee>32768&&(ee=0),fu(this.layoutVertexArray,oe.x,oe.y,be.x,be.y,0,0,ee),fu(this.layoutVertexArray,oe.x,oe.y,be.x,be.y,0,1,ee),fu(this.layoutVertexArray,ye.x,ye.y,be.x,be.y,0,0,ee+=Ee),fu(this.layoutVertexArray,ye.x,ye.y,be.x,be.y,0,1,ee);var Te=B.vertexLength;this.indexArray.emplaceBack(Te,Te+2,Te+1),this.indexArray.emplaceBack(Te+1,Te+2,Te+3),B.vertexLength+=4,B.primitiveLength+=2}}}}if(B.vertexLength+z>K.MAX_VERTEX_ARRAY_LENGTH&&(B=this.segments.prepareSegment(z,this.layoutVertexArray,this.indexArray)),Qy[e.type]==="Polygon"){for(var Me=[],Ke=[],$e=B.vertexLength,bt=0,lt=E;bt<lt.length;bt+=1){var kt=lt[bt];if(kt.length!==0){kt!==E[0]&&Ke.push(Me.length/2);for(var ut=0;ut<kt.length;ut++){var Qt=kt[ut];fu(this.layoutVertexArray,Qt.x,Qt.y,0,0,1,1,0),Me.push(Qt.x),Me.push(Qt.y)}}}for(var Lt=Kh(Me,Ke),vt=0;vt<Lt.length;vt+=3)this.indexArray.emplaceBack($e+Lt[vt],$e+Lt[vt+2],$e+Lt[vt+1]);B.primitiveLength+=Lt.length/3,B.vertexLength+=z}}var tr;this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,e,i,f,u)},pt("FillExtrusionBucket",Ba,{omit:["layers","features"]});var eg={paint:new rn({"fill-extrusion-opacity":new St(j["paint_fill-extrusion"]["fill-extrusion-opacity"]),"fill-extrusion-color":new _t(j["paint_fill-extrusion"]["fill-extrusion-color"]),"fill-extrusion-translate":new St(j["paint_fill-extrusion"]["fill-extrusion-translate"]),"fill-extrusion-translate-anchor":new St(j["paint_fill-extrusion"]["fill-extrusion-translate-anchor"]),"fill-extrusion-pattern":new $s(j["paint_fill-extrusion"]["fill-extrusion-pattern"]),"fill-extrusion-height":new _t(j["paint_fill-extrusion"]["fill-extrusion-height"]),"fill-extrusion-base":new _t(j["paint_fill-extrusion"]["fill-extrusion-base"]),"fill-extrusion-vertical-gradient":new St(j["paint_fill-extrusion"]["fill-extrusion-vertical-gradient"])})},tg=function(e){function t(i){e.call(this,i,eg)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.createBucket=function(i){return new Ba(i)},t.prototype.queryRadius=function(){return Ri(this.paint.get("fill-extrusion-translate"))},t.prototype.is3D=function(){return!0},t.prototype.queryIntersectsFeature=function(i,u,f,m,x,E,z,A){var D=La(i,this.paint.get("fill-extrusion-translate"),this.paint.get("fill-extrusion-translate-anchor"),E.angle,z),B=this.paint.get("fill-extrusion-height").evaluate(u,f),q=this.paint.get("fill-extrusion-base").evaluate(u,f),G=function(ee,he,oe,ye){for(var be=[],Ee=0,Te=ee;Ee<Te.length;Ee+=1){var Me=Te[Ee],Ke=[Me.x,Me.y,0,1];nl(Ke,Ke,he),be.push(new M(Ke[0]/Ke[3],Ke[1]/Ke[3]))}return be}(D,A),J=function(ee,he,oe,ye){for(var be=[],Ee=[],Te=ye[8]*he,Me=ye[9]*he,Ke=ye[10]*he,$e=ye[11]*he,bt=ye[8]*oe,lt=ye[9]*oe,kt=ye[10]*oe,ut=ye[11]*oe,Qt=0,Lt=ee;Qt<Lt.length;Qt+=1){for(var vt=[],tr=[],Zt=0,mr=Lt[Qt];Zt<mr.length;Zt+=1){var Pt=mr[Zt],br=Pt.x,Wr=Pt.y,li=ye[0]*br+ye[4]*Wr+ye[12],ii=ye[1]*br+ye[5]*Wr+ye[13],Yr=ye[2]*br+ye[6]*Wr+ye[14],ui=ye[3]*br+ye[7]*Wr+ye[15],Bi=Yr+Ke,Fi=ui+$e,wn=li+bt,Xi=ii+lt,Sn=Yr+kt,di=ui+ut,Wi=new M((li+Te)/Fi,(ii+Me)/Fi);Wi.z=Bi/Fi,vt.push(Wi);var or=new M(wn/di,Xi/di);or.z=Sn/di,tr.push(or)}be.push(vt),Ee.push(tr)}return[be,Ee]}(m,q,B,A);return function(ee,he,oe){var ye=1/0;_a(oe,he)&&(ye=af(oe,he[0]));for(var be=0;be<he.length;be++)for(var Ee=he[be],Te=ee[be],Me=0;Me<Ee.length-1;Me++){var Ke=Ee[Me],$e=[Ke,Ee[Me+1],Te[Me+1],Te[Me],Ke];Qa(oe,$e)&&(ye=Math.min(ye,af(oe,$e)))}return ye!==1/0&&ye}(J[0],J[1],G)},t}(Ta);function du(e,t){return e.x*t.x+e.y*t.y}function af(e,t){if(e.length===1){for(var i,u=0,f=t[u++];!i||f.equals(i);)if(!(i=t[u++]))return 1/0;for(;u<t.length;u++){var m=t[u],x=e[0],E=i.sub(f),z=m.sub(f),A=x.sub(f),D=du(E,E),B=du(E,z),q=du(z,z),G=du(A,E),J=du(A,z),ee=D*q-B*B,he=(q*G-B*J)/ee,oe=(D*J-B*G)/ee,ye=f.z*(1-he-oe)+i.z*he+m.z*oe;if(isFinite(ye))return ye}return 1/0}for(var be=1/0,Ee=0,Te=t;Ee<Te.length;Ee+=1)be=Math.min(be,Te[Ee].z);return be}var rg=Zi([{name:"a_pos_normal",components:2,type:"Int16"},{name:"a_data",components:4,type:"Uint8"}],4).members,ig=Zi([{name:"a_uv_x",components:1,type:"Float32"},{name:"a_split_index",components:1,type:"Float32"}]).members,ng=ll.VectorTileFeature.types,ag=Math.cos(Math.PI/180*37.5),of=Math.pow(2,14)/.5,Mn=function(e){var t=this;this.zoom=e.zoom,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map(function(i){return i.id}),this.index=e.index,this.hasPattern=!1,this.patternFeatures=[],this.lineClipsArray=[],this.gradients={},this.layers.forEach(function(i){t.gradients[i.id]={}}),this.layoutVertexArray=new Kn,this.layoutVertexArray2=new Go,this.indexArray=new Wa,this.programConfigurations=new Dt(e.layers,e.zoom),this.segments=new K,this.maxLineLength=0,this.stateDependentLayerIds=this.layers.filter(function(i){return i.isStateDependent()}).map(function(i){return i.id})};Mn.prototype.populate=function(e,t,i){this.hasPattern=Jh("line",this.layers,t);for(var u=this.layers[0].layout.get("line-sort-key"),f=[],m=0,x=e;m<x.length;m+=1){var E=x[m],z=E.feature,A=E.id,D=E.index,B=E.sourceLayerIndex,q=this.layers[0]._featureFilter.needGeometry,G=fi(z,q);if(this.layers[0]._featureFilter.filter(new rr(this.zoom),G,i)){var J=u?u.evaluate(G,{},i):void 0,ee={id:A,properties:z.properties,type:z.type,sourceLayerIndex:B,index:D,geometry:q?G.geometry:ri(z),patterns:{},sortKey:J};f.push(ee)}}u&&f.sort(function(Ke,$e){return Ke.sortKey-$e.sortKey});for(var he=0,oe=f;he<oe.length;he+=1){var ye=oe[he],be=ye.geometry,Ee=ye.index,Te=ye.sourceLayerIndex;if(this.hasPattern){var Me=Qh("line",this.layers,ye,this.zoom,t);this.patternFeatures.push(Me)}else this.addFeature(ye,be,Ee,i,{});t.featureIndex.insert(e[Ee].feature,be,Ee,Te,this.index)}},Mn.prototype.update=function(e,t,i){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(e,t,this.stateDependentLayers,i)},Mn.prototype.addFeatures=function(e,t,i){for(var u=0,f=this.patternFeatures;u<f.length;u+=1){var m=f[u];this.addFeature(m,m.geometry,m.index,t,i)}},Mn.prototype.isEmpty=function(){return this.layoutVertexArray.length===0},Mn.prototype.uploadPending=function(){return!this.uploaded||this.programConfigurations.needsUpload},Mn.prototype.upload=function(e){this.uploaded||(this.layoutVertexArray2.length!==0&&(this.layoutVertexBuffer2=e.createVertexBuffer(this.layoutVertexArray2,ig)),this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,rg),this.indexBuffer=e.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(e),this.uploaded=!0},Mn.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())},Mn.prototype.lineFeatureClips=function(e){if(e.properties&&e.properties.hasOwnProperty("mapbox_clip_start")&&e.properties.hasOwnProperty("mapbox_clip_end"))return{start:+e.properties.mapbox_clip_start,end:+e.properties.mapbox_clip_end}},Mn.prototype.addFeature=function(e,t,i,u,f){var m=this.layers[0].layout,x=m.get("line-join").evaluate(e,{}),E=m.get("line-cap"),z=m.get("line-miter-limit"),A=m.get("line-round-limit");this.lineClips=this.lineFeatureClips(e);for(var D=0,B=t;D<B.length;D+=1)this.addLine(B[D],e,x,E,z,A);this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,e,i,f,u)},Mn.prototype.addLine=function(e,t,i,u,f,m){if(this.distance=0,this.scaledDistance=0,this.totalDistance=0,this.lineClips){this.lineClipsArray.push(this.lineClips);for(var x=0;x<e.length-1;x++)this.totalDistance+=e[x].dist(e[x+1]);this.updateScaledDistance(),this.maxLineLength=Math.max(this.maxLineLength,this.totalDistance)}for(var E=ng[t.type]==="Polygon",z=e.length;z>=2&&e[z-1].equals(e[z-2]);)z--;for(var A=0;A<z-1&&e[A].equals(e[A+1]);)A++;if(!(z<(E?3:2))){i==="bevel"&&(f=1.05);var D,B=this.overscaling<=16?122880/(512*this.overscaling):0,q=this.segments.prepareSegment(10*z,this.layoutVertexArray,this.indexArray),G=void 0,J=void 0,ee=void 0,he=void 0;this.e1=this.e2=-1,E&&(he=e[A].sub(D=e[z-2])._unit()._perp());for(var oe=A;oe<z;oe++)if(!(J=oe===z-1?E?e[A+1]:void 0:e[oe+1])||!e[oe].equals(J)){he&&(ee=he),D&&(G=D),D=e[oe],he=J?J.sub(D)._unit()._perp():ee;var ye=(ee=ee||he).add(he);ye.x===0&&ye.y===0||ye._unit();var be=ee.x*he.x+ee.y*he.y,Ee=ye.x*he.x+ye.y*he.y,Te=Ee!==0?1/Ee:1/0,Me=2*Math.sqrt(2-2*Ee),Ke=Ee<ag&&G&&J,$e=ee.x*he.y-ee.y*he.x>0;if(Ke&&oe>A){var bt=D.dist(G);if(bt>2*B){var lt=D.sub(D.sub(G)._mult(B/bt)._round());this.updateDistance(G,lt),this.addCurrentVertex(lt,ee,0,0,q),G=lt}}var kt=G&&J,ut=kt?i:E?"butt":u;if(kt&&ut==="round"&&(Te<m?ut="miter":Te<=2&&(ut="fakeround")),ut==="miter"&&Te>f&&(ut="bevel"),ut==="bevel"&&(Te>2&&(ut="flipbevel"),Te<f&&(ut="miter")),G&&this.updateDistance(G,D),ut==="miter")ye._mult(Te),this.addCurrentVertex(D,ye,0,0,q);else if(ut==="flipbevel"){if(Te>100)ye=he.mult(-1);else{var Qt=Te*ee.add(he).mag()/ee.sub(he).mag();ye._perp()._mult(Qt*($e?-1:1))}this.addCurrentVertex(D,ye,0,0,q),this.addCurrentVertex(D,ye.mult(-1),0,0,q)}else if(ut==="bevel"||ut==="fakeround"){var Lt=-Math.sqrt(Te*Te-1),vt=$e?Lt:0,tr=$e?0:Lt;if(G&&this.addCurrentVertex(D,ee,vt,tr,q),ut==="fakeround")for(var Zt=Math.round(180*Me/Math.PI/20),mr=1;mr<Zt;mr++){var Pt=mr/Zt;if(Pt!==.5){var br=Pt-.5;Pt+=Pt*br*(Pt-1)*((1.0904+be*(be*(3.55645-1.43519*be)-3.2452))*br*br+(.848013+be*(.215638*be-1.06021)))}var Wr=he.sub(ee)._mult(Pt)._add(ee)._unit()._mult($e?-1:1);this.addHalfVertex(D,Wr.x,Wr.y,!1,$e,0,q)}J&&this.addCurrentVertex(D,he,-vt,-tr,q)}else if(ut==="butt")this.addCurrentVertex(D,ye,0,0,q);else if(ut==="square"){var li=G?1:-1;this.addCurrentVertex(D,ye,li,li,q)}else ut==="round"&&(G&&(this.addCurrentVertex(D,ee,0,0,q),this.addCurrentVertex(D,ee,1,1,q,!0)),J&&(this.addCurrentVertex(D,he,-1,-1,q,!0),this.addCurrentVertex(D,he,0,0,q)));if(Ke&&oe<z-1){var ii=D.dist(J);if(ii>2*B){var Yr=D.add(J.sub(D)._mult(B/ii)._round());this.updateDistance(D,Yr),this.addCurrentVertex(Yr,he,0,0,q),D=Yr}}}}},Mn.prototype.addCurrentVertex=function(e,t,i,u,f,m){m===void 0&&(m=!1);var x=t.y*u-t.x,E=-t.y-t.x*u;this.addHalfVertex(e,t.x+t.y*i,t.y-t.x*i,m,!1,i,f),this.addHalfVertex(e,x,E,m,!0,-u,f),this.distance>of/2&&this.totalDistance===0&&(this.distance=0,this.addCurrentVertex(e,t,i,u,f,m))},Mn.prototype.addHalfVertex=function(e,t,i,u,f,m,x){var E=.5*(this.lineClips?this.scaledDistance*(of-1):this.scaledDistance);this.layoutVertexArray.emplaceBack((e.x<<1)+(u?1:0),(e.y<<1)+(f?1:0),Math.round(63*t)+128,Math.round(63*i)+128,1+(m===0?0:m<0?-1:1)|(63&E)<<2,E>>6),this.lineClips&&this.layoutVertexArray2.emplaceBack((this.scaledDistance-this.lineClips.start)/(this.lineClips.end-this.lineClips.start),this.lineClipsArray.length);var z=x.vertexLength++;this.e1>=0&&this.e2>=0&&(this.indexArray.emplaceBack(this.e1,this.e2,z),x.primitiveLength++),f?this.e2=z:this.e1=z},Mn.prototype.updateScaledDistance=function(){this.scaledDistance=this.lineClips?this.lineClips.start+(this.lineClips.end-this.lineClips.start)*this.distance/this.totalDistance:this.distance},Mn.prototype.updateDistance=function(e,t){this.distance+=e.dist(t),this.updateScaledDistance()},pt("LineBucket",Mn,{omit:["layers","patternFeatures"]});var og=new rn({"line-cap":new St(j.layout_line["line-cap"]),"line-join":new _t(j.layout_line["line-join"]),"line-miter-limit":new St(j.layout_line["line-miter-limit"]),"line-round-limit":new St(j.layout_line["line-round-limit"]),"line-sort-key":new _t(j.layout_line["line-sort-key"])}),sf={paint:new rn({"line-opacity":new _t(j.paint_line["line-opacity"]),"line-color":new _t(j.paint_line["line-color"]),"line-translate":new St(j.paint_line["line-translate"]),"line-translate-anchor":new St(j.paint_line["line-translate-anchor"]),"line-width":new _t(j.paint_line["line-width"]),"line-gap-width":new _t(j.paint_line["line-gap-width"]),"line-offset":new _t(j.paint_line["line-offset"]),"line-blur":new _t(j.paint_line["line-blur"]),"line-dasharray":new vn(j.paint_line["line-dasharray"]),"line-pattern":new $s(j.paint_line["line-pattern"]),"line-gradient":new ga(j.paint_line["line-gradient"])}),layout:og},lf=new(function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.possiblyEvaluate=function(i,u){return u=new rr(Math.floor(u.zoom),{now:u.now,fadeDuration:u.fadeDuration,zoomHistory:u.zoomHistory,transition:u.transition}),e.prototype.possiblyEvaluate.call(this,i,u)},t.prototype.evaluate=function(i,u,f,m){return u=ge({},u,{zoom:Math.floor(u.zoom)}),e.prototype.evaluate.call(this,i,u,f,m)},t}(_t))(sf.paint.properties["line-width"].specification);lf.useIntegerZoom=!0;var sg=function(e){function t(i){e.call(this,i,sf),this.gradientVersion=0}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._handleSpecialPaintPropertyUpdate=function(i){i==="line-gradient"&&(this.stepInterpolant=this._transitionablePaint._values["line-gradient"].value.expression._styleExpression.expression instanceof Vn,this.gradientVersion=(this.gradientVersion+1)%X)},t.prototype.gradientExpression=function(){return this._transitionablePaint._values["line-gradient"].value.expression},t.prototype.recalculate=function(i,u){e.prototype.recalculate.call(this,i,u),this.paint._values["line-floorwidth"]=lf.possiblyEvaluate(this._transitioningPaint._values["line-width"].value,i)},t.prototype.createBucket=function(i){return new Mn(i)},t.prototype.queryRadius=function(i){var u=i,f=uf(za("line-width",this,u),za("line-gap-width",this,u)),m=za("line-offset",this,u);return f/2+Math.abs(m)+Ri(this.paint.get("line-translate"))},t.prototype.queryIntersectsFeature=function(i,u,f,m,x,E,z){var A=La(i,this.paint.get("line-translate"),this.paint.get("line-translate-anchor"),E.angle,z),D=z/2*uf(this.paint.get("line-width").evaluate(u,f),this.paint.get("line-gap-width").evaluate(u,f)),B=this.paint.get("line-offset").evaluate(u,f);return B&&(m=function(q,G){for(var J=[],ee=new M(0,0),he=0;he<q.length;he++){for(var oe=q[he],ye=[],be=0;be<oe.length;be++){var Ee=oe[be],Te=oe[be+1],Me=be===0?ee:Ee.sub(oe[be-1])._unit()._perp(),Ke=be===oe.length-1?ee:Te.sub(Ee)._unit()._perp(),$e=Me._add(Ke)._unit();$e._mult(1/($e.x*Ke.x+$e.y*Ke.y)),ye.push($e._mult(G)._add(Ee))}J.push(ye)}return J}(m,B*z)),function(q,G,J){for(var ee=0;ee<G.length;ee++){var he=G[ee];if(q.length>=3){for(var oe=0;oe<he.length;oe++)if(Pa(q,he[oe]))return!0}if(sa(q,he,J))return!0}return!1}(A,m,D)},t.prototype.isTileClipped=function(){return!0},t}(Ta);function uf(e,t){return t>0?t+2*e:e}var lg=Zi([{name:"a_pos_offset",components:4,type:"Int16"},{name:"a_data",components:4,type:"Uint16"},{name:"a_pixeloffset",components:4,type:"Int16"}],4),ug=Zi([{name:"a_projected_pos",components:3,type:"Float32"}],4),cg=(Zi([{name:"a_fade_opacity",components:1,type:"Uint32"}],4),Zi([{name:"a_placed",components:2,type:"Uint8"},{name:"a_shift",components:2,type:"Float32"}])),cf=(Zi([{type:"Int16",name:"anchorPointX"},{type:"Int16",name:"anchorPointY"},{type:"Int16",name:"x1"},{type:"Int16",name:"y1"},{type:"Int16",name:"x2"},{type:"Int16",name:"y2"},{type:"Uint32",name:"featureIndex"},{type:"Uint16",name:"sourceLayerIndex"},{type:"Uint16",name:"bucketIndex"}]),Zi([{name:"a_pos",components:2,type:"Int16"},{name:"a_anchor_pos",components:2,type:"Int16"},{name:"a_extrude",components:2,type:"Int16"}],4)),hg=Zi([{name:"a_pos",components:2,type:"Float32"},{name:"a_radius",components:1,type:"Float32"},{name:"a_flags",components:2,type:"Int16"}],4);function pg(e,t,i){return e.sections.forEach(function(u){u.text=function(f,m,x){var E=m.layout.get("text-transform").evaluate(x,{});return E==="uppercase"?f=f.toLocaleUpperCase():E==="lowercase"&&(f=f.toLocaleLowerCase()),ea.applyArabicShaping&&(f=ea.applyArabicShaping(f)),f}(u.text,t,i)}),e}Zi([{name:"triangle",components:3,type:"Uint16"}]),Zi([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Uint16",name:"glyphStartIndex"},{type:"Uint16",name:"numGlyphs"},{type:"Uint32",name:"vertexStartIndex"},{type:"Uint32",name:"lineStartIndex"},{type:"Uint32",name:"lineLength"},{type:"Uint16",name:"segment"},{type:"Uint16",name:"lowerSize"},{type:"Uint16",name:"upperSize"},{type:"Float32",name:"lineOffsetX"},{type:"Float32",name:"lineOffsetY"},{type:"Uint8",name:"writingMode"},{type:"Uint8",name:"placedOrientation"},{type:"Uint8",name:"hidden"},{type:"Uint32",name:"crossTileID"},{type:"Int16",name:"associatedIconIndex"}]),Zi([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Int16",name:"rightJustifiedTextSymbolIndex"},{type:"Int16",name:"centerJustifiedTextSymbolIndex"},{type:"Int16",name:"leftJustifiedTextSymbolIndex"},{type:"Int16",name:"verticalPlacedTextSymbolIndex"},{type:"Int16",name:"placedIconSymbolIndex"},{type:"Int16",name:"verticalPlacedIconSymbolIndex"},{type:"Uint16",name:"key"},{type:"Uint16",name:"textBoxStartIndex"},{type:"Uint16",name:"textBoxEndIndex"},{type:"Uint16",name:"verticalTextBoxStartIndex"},{type:"Uint16",name:"verticalTextBoxEndIndex"},{type:"Uint16",name:"iconBoxStartIndex"},{type:"Uint16",name:"iconBoxEndIndex"},{type:"Uint16",name:"verticalIconBoxStartIndex"},{type:"Uint16",name:"verticalIconBoxEndIndex"},{type:"Uint16",name:"featureIndex"},{type:"Uint16",name:"numHorizontalGlyphVertices"},{type:"Uint16",name:"numVerticalGlyphVertices"},{type:"Uint16",name:"numIconVertices"},{type:"Uint16",name:"numVerticalIconVertices"},{type:"Uint16",name:"useRuntimeCollisionCircles"},{type:"Uint32",name:"crossTileID"},{type:"Float32",name:"textBoxScale"},{type:"Float32",components:2,name:"textOffset"},{type:"Float32",name:"collisionCircleDiameter"}]),Zi([{type:"Float32",name:"offsetX"}]),Zi([{type:"Int16",name:"x"},{type:"Int16",name:"y"},{type:"Int16",name:"tileUnitDistanceFromAnchor"}]);var mu={"!":"︕","#":"＃",$:"＄","%":"％","&":"＆","(":"︵",")":"︶","*":"＊","+":"＋",",":"︐","-":"︲",".":"・","/":"／",":":"︓",";":"︔","<":"︿","=":"＝",">":"﹀","?":"︖","@":"＠","[":"﹇","\\":"＼","]":"﹈","^":"＾",_:"︳","`":"｀","{":"︷","|":"―","}":"︸","~":"～","¢":"￠","£":"￡","¥":"￥","¦":"￤","¬":"￢","¯":"￣","–":"︲","—":"︱","‘":"﹃","’":"﹄","“":"﹁","”":"﹂","…":"︙","‧":"・","₩":"￦","、":"︑","。":"︒","〈":"︿","〉":"﹀","《":"︽","》":"︾","「":"﹁","」":"﹂","『":"﹃","』":"﹄","【":"︻","】":"︼","〔":"︹","〕":"︺","〖":"︗","〗":"︘","！":"︕","（":"︵","）":"︶","，":"︐","－":"︲","．":"・","：":"︓","；":"︔","＜":"︿","＞":"﹀","？":"︖","［":"﹇","］":"﹈","＿":"︳","｛":"︷","｜":"―","｝":"︸","｟":"︵","｠":"︶","｡":"︒","｢":"﹁","｣":"﹂"},hf=function(e,t,i,u,f){var m,x,E=8*f-u-1,z=(1<<E)-1,A=z>>1,D=-7,B=i?f-1:0,q=i?-1:1,G=e[t+B];for(B+=q,m=G&(1<<-D)-1,G>>=-D,D+=E;D>0;m=256*m+e[t+B],B+=q,D-=8);for(x=m&(1<<-D)-1,m>>=-D,D+=u;D>0;x=256*x+e[t+B],B+=q,D-=8);if(m===0)m=1-A;else{if(m===z)return x?NaN:1/0*(G?-1:1);x+=Math.pow(2,u),m-=A}return(G?-1:1)*x*Math.pow(2,m-u)},pf=function(e,t,i,u,f,m){var x,E,z,A=8*m-f-1,D=(1<<A)-1,B=D>>1,q=f===23?Math.pow(2,-24)-Math.pow(2,-77):0,G=u?0:m-1,J=u?1:-1,ee=t<0||t===0&&1/t<0?1:0;for(t=Math.abs(t),isNaN(t)||t===1/0?(E=isNaN(t)?1:0,x=D):(x=Math.floor(Math.log(t)/Math.LN2),t*(z=Math.pow(2,-x))<1&&(x--,z*=2),(t+=x+B>=1?q/z:q*Math.pow(2,1-B))*z>=2&&(x++,z/=2),x+B>=D?(E=0,x=D):x+B>=1?(E=(t*z-1)*Math.pow(2,f),x+=B):(E=t*Math.pow(2,B-1)*Math.pow(2,f),x=0));f>=8;e[i+G]=255&E,G+=J,E/=256,f-=8);for(x=x<<f|E,A+=f;A>0;e[i+G]=255&x,G+=J,x/=256,A-=8);e[i+G-J]|=128*ee},Mc=Ur;function Ur(e){this.buf=ArrayBuffer.isView&&ArrayBuffer.isView(e)?e:new Uint8Array(e||0),this.pos=0,this.type=0,this.length=this.buf.length}Ur.Varint=0,Ur.Fixed64=1,Ur.Bytes=2,Ur.Fixed32=5;var ff=typeof TextDecoder>"u"?null:new TextDecoder("utf8");function zo(e){return e.type===Ur.Bytes?e.readVarint()+e.pos:e.pos+1}function ul(e,t,i){return i?4294967296*t+(e>>>0):4294967296*(t>>>0)+(e>>>0)}function df(e,t,i){var u=t<=16383?1:t<=2097151?2:t<=268435455?3:Math.floor(Math.log(t)/(7*Math.LN2));i.realloc(u);for(var f=i.pos-1;f>=e;f--)i.buf[f+u]=i.buf[f]}function fg(e,t){for(var i=0;i<e.length;i++)t.writeVarint(e[i])}function dg(e,t){for(var i=0;i<e.length;i++)t.writeSVarint(e[i])}function mg(e,t){for(var i=0;i<e.length;i++)t.writeFloat(e[i])}function yg(e,t){for(var i=0;i<e.length;i++)t.writeDouble(e[i])}function gg(e,t){for(var i=0;i<e.length;i++)t.writeBoolean(e[i])}function _g(e,t){for(var i=0;i<e.length;i++)t.writeFixed32(e[i])}function vg(e,t){for(var i=0;i<e.length;i++)t.writeSFixed32(e[i])}function bg(e,t){for(var i=0;i<e.length;i++)t.writeFixed64(e[i])}function xg(e,t){for(var i=0;i<e.length;i++)t.writeSFixed64(e[i])}function Dc(e,t){return(e[t]|e[t+1]<<8|e[t+2]<<16)+16777216*e[t+3]}function cl(e,t,i){e[i]=t,e[i+1]=t>>>8,e[i+2]=t>>>16,e[i+3]=t>>>24}function mf(e,t){return(e[t]|e[t+1]<<8|e[t+2]<<16)+(e[t+3]<<24)}function wg(e,t,i){e===1&&i.readMessage(Sg,t)}function Sg(e,t,i){if(e===3){var u=i.readMessage(Eg,{}),f=u.width,m=u.height,x=u.left,E=u.top,z=u.advance;t.push({id:u.id,bitmap:new Is({width:f+6,height:m+6},u.bitmap),metrics:{width:f,height:m,left:x,top:E,advance:z}})}}function Eg(e,t,i){e===1?t.id=i.readVarint():e===2?t.bitmap=i.readBytes():e===3?t.width=i.readVarint():e===4?t.height=i.readVarint():e===5?t.left=i.readSVarint():e===6?t.top=i.readSVarint():e===7&&(t.advance=i.readVarint())}function yf(e){for(var t=0,i=0,u=0,f=e;u<f.length;u+=1){var m=f[u];t+=m.w*m.h,i=Math.max(i,m.w)}e.sort(function(ee,he){return he.h-ee.h});for(var x=[{x:0,y:0,w:Math.max(Math.ceil(Math.sqrt(t/.95)),i),h:1/0}],E=0,z=0,A=0,D=e;A<D.length;A+=1)for(var B=D[A],q=x.length-1;q>=0;q--){var G=x[q];if(!(B.w>G.w||B.h>G.h)){if(B.x=G.x,B.y=G.y,z=Math.max(z,B.y+B.h),E=Math.max(E,B.x+B.w),B.w===G.w&&B.h===G.h){var J=x.pop();q<x.length&&(x[q]=J)}else B.h===G.h?(G.x+=B.w,G.w-=B.w):B.w===G.w?(G.y+=B.h,G.h-=B.h):(x.push({x:G.x+B.w,y:G.y,w:G.w-B.w,h:B.h}),G.y+=B.h,G.h-=B.h);break}}return{w:E,h:z,fill:t/(E*z)||0}}Ur.prototype={destroy:function(){this.buf=null},readFields:function(e,t,i){for(i=i||this.length;this.pos<i;){var u=this.readVarint(),f=u>>3,m=this.pos;this.type=7&u,e(f,t,this),this.pos===m&&this.skip(u)}return t},readMessage:function(e,t){return this.readFields(e,t,this.readVarint()+this.pos)},readFixed32:function(){var e=Dc(this.buf,this.pos);return this.pos+=4,e},readSFixed32:function(){var e=mf(this.buf,this.pos);return this.pos+=4,e},readFixed64:function(){var e=Dc(this.buf,this.pos)+4294967296*Dc(this.buf,this.pos+4);return this.pos+=8,e},readSFixed64:function(){var e=Dc(this.buf,this.pos)+4294967296*mf(this.buf,this.pos+4);return this.pos+=8,e},readFloat:function(){var e=hf(this.buf,this.pos,!0,23,4);return this.pos+=4,e},readDouble:function(){var e=hf(this.buf,this.pos,!0,52,8);return this.pos+=8,e},readVarint:function(e){var t,i,u=this.buf;return t=127&(i=u[this.pos++]),i<128?t:(t|=(127&(i=u[this.pos++]))<<7,i<128?t:(t|=(127&(i=u[this.pos++]))<<14,i<128?t:(t|=(127&(i=u[this.pos++]))<<21,i<128?t:function(f,m,x){var E,z,A=x.buf;if(E=(112&(z=A[x.pos++]))>>4,z<128||(E|=(127&(z=A[x.pos++]))<<3,z<128)||(E|=(127&(z=A[x.pos++]))<<10,z<128)||(E|=(127&(z=A[x.pos++]))<<17,z<128)||(E|=(127&(z=A[x.pos++]))<<24,z<128)||(E|=(1&(z=A[x.pos++]))<<31,z<128))return ul(f,E,m);throw new Error("Expected varint not more than 10 bytes")}(t|=(15&(i=u[this.pos]))<<28,e,this))))},readVarint64:function(){return this.readVarint(!0)},readSVarint:function(){var e=this.readVarint();return e%2==1?(e+1)/-2:e/2},readBoolean:function(){return!!this.readVarint()},readString:function(){var e=this.readVarint()+this.pos,t=this.pos;return this.pos=e,e-t>=12&&ff?function(i,u,f){return ff.decode(i.subarray(u,f))}(this.buf,t,e):function(i,u,f){for(var m="",x=u;x<f;){var E,z,A,D=i[x],B=null,q=D>239?4:D>223?3:D>191?2:1;if(x+q>f)break;q===1?D<128&&(B=D):q===2?(192&(E=i[x+1]))==128&&(B=(31&D)<<6|63&E)<=127&&(B=null):q===3?(z=i[x+2],(192&(E=i[x+1]))==128&&(192&z)==128&&((B=(15&D)<<12|(63&E)<<6|63&z)<=2047||B>=55296&&B<=57343)&&(B=null)):q===4&&(z=i[x+2],A=i[x+3],(192&(E=i[x+1]))==128&&(192&z)==128&&(192&A)==128&&((B=(15&D)<<18|(63&E)<<12|(63&z)<<6|63&A)<=65535||B>=1114112)&&(B=null)),B===null?(B=65533,q=1):B>65535&&(B-=65536,m+=String.fromCharCode(B>>>10&1023|55296),B=56320|1023&B),m+=String.fromCharCode(B),x+=q}return m}(this.buf,t,e)},readBytes:function(){var e=this.readVarint()+this.pos,t=this.buf.subarray(this.pos,e);return this.pos=e,t},readPackedVarint:function(e,t){if(this.type!==Ur.Bytes)return e.push(this.readVarint(t));var i=zo(this);for(e=e||[];this.pos<i;)e.push(this.readVarint(t));return e},readPackedSVarint:function(e){if(this.type!==Ur.Bytes)return e.push(this.readSVarint());var t=zo(this);for(e=e||[];this.pos<t;)e.push(this.readSVarint());return e},readPackedBoolean:function(e){if(this.type!==Ur.Bytes)return e.push(this.readBoolean());var t=zo(this);for(e=e||[];this.pos<t;)e.push(this.readBoolean());return e},readPackedFloat:function(e){if(this.type!==Ur.Bytes)return e.push(this.readFloat());var t=zo(this);for(e=e||[];this.pos<t;)e.push(this.readFloat());return e},readPackedDouble:function(e){if(this.type!==Ur.Bytes)return e.push(this.readDouble());var t=zo(this);for(e=e||[];this.pos<t;)e.push(this.readDouble());return e},readPackedFixed32:function(e){if(this.type!==Ur.Bytes)return e.push(this.readFixed32());var t=zo(this);for(e=e||[];this.pos<t;)e.push(this.readFixed32());return e},readPackedSFixed32:function(e){if(this.type!==Ur.Bytes)return e.push(this.readSFixed32());var t=zo(this);for(e=e||[];this.pos<t;)e.push(this.readSFixed32());return e},readPackedFixed64:function(e){if(this.type!==Ur.Bytes)return e.push(this.readFixed64());var t=zo(this);for(e=e||[];this.pos<t;)e.push(this.readFixed64());return e},readPackedSFixed64:function(e){if(this.type!==Ur.Bytes)return e.push(this.readSFixed64());var t=zo(this);for(e=e||[];this.pos<t;)e.push(this.readSFixed64());return e},skip:function(e){var t=7&e;if(t===Ur.Varint)for(;this.buf[this.pos++]>127;);else if(t===Ur.Bytes)this.pos=this.readVarint()+this.pos;else if(t===Ur.Fixed32)this.pos+=4;else{if(t!==Ur.Fixed64)throw new Error("Unimplemented type: "+t);this.pos+=8}},writeTag:function(e,t){this.writeVarint(e<<3|t)},realloc:function(e){for(var t=this.length||16;t<this.pos+e;)t*=2;if(t!==this.length){var i=new Uint8Array(t);i.set(this.buf),this.buf=i,this.length=t}},finish:function(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)},writeFixed32:function(e){this.realloc(4),cl(this.buf,e,this.pos),this.pos+=4},writeSFixed32:function(e){this.realloc(4),cl(this.buf,e,this.pos),this.pos+=4},writeFixed64:function(e){this.realloc(8),cl(this.buf,-1&e,this.pos),cl(this.buf,Math.floor(e*(1/4294967296)),this.pos+4),this.pos+=8},writeSFixed64:function(e){this.realloc(8),cl(this.buf,-1&e,this.pos),cl(this.buf,Math.floor(e*(1/4294967296)),this.pos+4),this.pos+=8},writeVarint:function(e){(e=+e||0)>268435455||e<0?function(t,i){var u,f;if(t>=0?(u=t%4294967296|0,f=t/4294967296|0):(f=~(-t/4294967296),4294967295^(u=~(-t%4294967296))?u=u+1|0:(u=0,f=f+1|0)),t>=18446744073709552e3||t<-18446744073709552e3)throw new Error("Given varint doesn't fit into 10 bytes");i.realloc(10),function(m,x,E){E.buf[E.pos++]=127&m|128,m>>>=7,E.buf[E.pos++]=127&m|128,m>>>=7,E.buf[E.pos++]=127&m|128,m>>>=7,E.buf[E.pos++]=127&m|128,E.buf[E.pos]=127&(m>>>=7)}(u,0,i),function(m,x){var E=(7&m)<<4;x.buf[x.pos++]|=E|((m>>>=3)?128:0),m&&(x.buf[x.pos++]=127&m|((m>>>=7)?128:0),m&&(x.buf[x.pos++]=127&m|((m>>>=7)?128:0),m&&(x.buf[x.pos++]=127&m|((m>>>=7)?128:0),m&&(x.buf[x.pos++]=127&m|((m>>>=7)?128:0),m&&(x.buf[x.pos++]=127&m)))))}(f,i)}(e,this):(this.realloc(4),this.buf[this.pos++]=127&e|(e>127?128:0),e<=127||(this.buf[this.pos++]=127&(e>>>=7)|(e>127?128:0),e<=127||(this.buf[this.pos++]=127&(e>>>=7)|(e>127?128:0),e<=127||(this.buf[this.pos++]=e>>>7&127))))},writeSVarint:function(e){this.writeVarint(e<0?2*-e-1:2*e)},writeBoolean:function(e){this.writeVarint(!!e)},writeString:function(e){e=String(e),this.realloc(4*e.length),this.pos++;var t=this.pos;this.pos=function(u,f,m){for(var x,E,z=0;z<f.length;z++){if((x=f.charCodeAt(z))>55295&&x<57344){if(!E){x>56319||z+1===f.length?(u[m++]=239,u[m++]=191,u[m++]=189):E=x;continue}if(x<56320){u[m++]=239,u[m++]=191,u[m++]=189,E=x;continue}x=E-55296<<10|x-56320|65536,E=null}else E&&(u[m++]=239,u[m++]=191,u[m++]=189,E=null);x<128?u[m++]=x:(x<2048?u[m++]=x>>6|192:(x<65536?u[m++]=x>>12|224:(u[m++]=x>>18|240,u[m++]=x>>12&63|128),u[m++]=x>>6&63|128),u[m++]=63&x|128)}return m}(this.buf,e,this.pos);var i=this.pos-t;i>=128&&df(t,i,this),this.pos=t-1,this.writeVarint(i),this.pos+=i},writeFloat:function(e){this.realloc(4),pf(this.buf,e,this.pos,!0,23,4),this.pos+=4},writeDouble:function(e){this.realloc(8),pf(this.buf,e,this.pos,!0,52,8),this.pos+=8},writeBytes:function(e){var t=e.length;this.writeVarint(t),this.realloc(t);for(var i=0;i<t;i++)this.buf[this.pos++]=e[i]},writeRawMessage:function(e,t){this.pos++;var i=this.pos;e(t,this);var u=this.pos-i;u>=128&&df(i,u,this),this.pos=i-1,this.writeVarint(u),this.pos+=u},writeMessage:function(e,t,i){this.writeTag(e,Ur.Bytes),this.writeRawMessage(t,i)},writePackedVarint:function(e,t){t.length&&this.writeMessage(e,fg,t)},writePackedSVarint:function(e,t){t.length&&this.writeMessage(e,dg,t)},writePackedBoolean:function(e,t){t.length&&this.writeMessage(e,gg,t)},writePackedFloat:function(e,t){t.length&&this.writeMessage(e,mg,t)},writePackedDouble:function(e,t){t.length&&this.writeMessage(e,yg,t)},writePackedFixed32:function(e,t){t.length&&this.writeMessage(e,_g,t)},writePackedSFixed32:function(e,t){t.length&&this.writeMessage(e,vg,t)},writePackedFixed64:function(e,t){t.length&&this.writeMessage(e,bg,t)},writePackedSFixed64:function(e,t){t.length&&this.writeMessage(e,xg,t)},writeBytesField:function(e,t){this.writeTag(e,Ur.Bytes),this.writeBytes(t)},writeFixed32Field:function(e,t){this.writeTag(e,Ur.Fixed32),this.writeFixed32(t)},writeSFixed32Field:function(e,t){this.writeTag(e,Ur.Fixed32),this.writeSFixed32(t)},writeFixed64Field:function(e,t){this.writeTag(e,Ur.Fixed64),this.writeFixed64(t)},writeSFixed64Field:function(e,t){this.writeTag(e,Ur.Fixed64),this.writeSFixed64(t)},writeVarintField:function(e,t){this.writeTag(e,Ur.Varint),this.writeVarint(t)},writeSVarintField:function(e,t){this.writeTag(e,Ur.Varint),this.writeSVarint(t)},writeStringField:function(e,t){this.writeTag(e,Ur.Bytes),this.writeString(t)},writeFloatField:function(e,t){this.writeTag(e,Ur.Fixed32),this.writeFloat(t)},writeDoubleField:function(e,t){this.writeTag(e,Ur.Fixed64),this.writeDouble(t)},writeBooleanField:function(e,t){this.writeVarintField(e,!!t)}};var Lc=function(e,t){var i=t.pixelRatio,u=t.version,f=t.stretchX,m=t.stretchY,x=t.content;this.paddedRect=e,this.pixelRatio=i,this.stretchX=f,this.stretchY=m,this.content=x,this.version=u},yu={tl:{configurable:!0},br:{configurable:!0},tlbr:{configurable:!0},displaySize:{configurable:!0}};yu.tl.get=function(){return[this.paddedRect.x+1,this.paddedRect.y+1]},yu.br.get=function(){return[this.paddedRect.x+this.paddedRect.w-1,this.paddedRect.y+this.paddedRect.h-1]},yu.tlbr.get=function(){return this.tl.concat(this.br)},yu.displaySize.get=function(){return[(this.paddedRect.w-2)/this.pixelRatio,(this.paddedRect.h-2)/this.pixelRatio]},Object.defineProperties(Lc.prototype,yu);var gu=function(e,t){var i={},u={};this.haveRenderCallbacks=[];var f=[];this.addImages(e,i,f),this.addImages(t,u,f);var m=yf(f),x=new Xn({width:m.w||1,height:m.h||1});for(var E in e){var z=e[E],A=i[E].paddedRect;Xn.copy(z.data,x,{x:0,y:0},{x:A.x+1,y:A.y+1},z.data)}for(var D in t){var B=t[D],q=u[D].paddedRect,G=q.x+1,J=q.y+1,ee=B.data.width,he=B.data.height;Xn.copy(B.data,x,{x:0,y:0},{x:G,y:J},B.data),Xn.copy(B.data,x,{x:0,y:he-1},{x:G,y:J-1},{width:ee,height:1}),Xn.copy(B.data,x,{x:0,y:0},{x:G,y:J+he},{width:ee,height:1}),Xn.copy(B.data,x,{x:ee-1,y:0},{x:G-1,y:J},{width:1,height:he}),Xn.copy(B.data,x,{x:0,y:0},{x:G+ee,y:J},{width:1,height:he})}this.image=x,this.iconPositions=i,this.patternPositions=u};gu.prototype.addImages=function(e,t,i){for(var u in e){var f=e[u],m={x:0,y:0,w:f.data.width+2,h:f.data.height+2};i.push(m),t[u]=new Lc(m,f),f.hasRenderCallback&&this.haveRenderCallbacks.push(u)}},gu.prototype.patchUpdatedImages=function(e,t){for(var i in e.dispatchRenderCallbacks(this.haveRenderCallbacks),e.updatedImages)this.patchUpdatedImage(this.iconPositions[i],e.getImage(i),t),this.patchUpdatedImage(this.patternPositions[i],e.getImage(i),t)},gu.prototype.patchUpdatedImage=function(e,t,i){if(e&&t&&e.version!==t.version){e.version=t.version;var u=e.tl;i.update(t.data,void 0,{x:u[0],y:u[1]})}},pt("ImagePosition",Lc),pt("ImageAtlas",gu);var la={horizontal:1,vertical:2,horizontalOnly:3},hl=function(){this.scale=1,this.fontStack="",this.imageName=null};hl.forText=function(e,t){var i=new hl;return i.scale=e||1,i.fontStack=t,i},hl.forImage=function(e){var t=new hl;return t.imageName=e,t};var xn=function(){this.text="",this.sectionIndex=[],this.sections=[],this.imageSectionID=null};function Rc(e,t,i,u,f,m,x,E,z,A,D,B,q,G,J,ee){var he,oe=xn.fromFeature(e,f);B===la.vertical&&oe.verticalizePunctuation();var ye=ea.processBidirectionalText,be=ea.processStyledBidirectionalText;if(ye&&oe.sections.length===1){he=[];for(var Ee=0,Te=ye(oe.toString(),ep(oe,A,m,t,u,G,J));Ee<Te.length;Ee+=1){var Me=Te[Ee],Ke=new xn;Ke.text=Me,Ke.sections=oe.sections;for(var $e=0;$e<Me.length;$e++)Ke.sectionIndex.push(0);he.push(Ke)}}else if(be){he=[];for(var bt=0,lt=be(oe.text,oe.sectionIndex,ep(oe,A,m,t,u,G,J));bt<lt.length;bt+=1){var kt=lt[bt],ut=new xn;ut.text=kt[0],ut.sectionIndex=kt[1],ut.sections=oe.sections,he.push(ut)}}else he=function(vt,tr){for(var Zt=[],mr=vt.text,Pt=0,br=0,Wr=tr;br<Wr.length;br+=1){var li=Wr[br];Zt.push(vt.substring(Pt,li)),Pt=li}return Pt<mr.length&&Zt.push(vt.substring(Pt,mr.length)),Zt}(oe,ep(oe,A,m,t,u,G,J));var Qt=[],Lt={positionedLines:Qt,text:oe.toString(),top:D[1],bottom:D[1],left:D[0],right:D[0],writingMode:B,iconsInText:!1,verticalizable:!1};return function(vt,tr,Zt,mr,Pt,br,Wr,li,ii,Yr,ui,Bi){for(var Fi=0,wn=-17,Xi=0,Sn=0,di=li==="right"?1:li==="left"?0:.5,Wi=0,or=0,Lr=Pt;or<Lr.length;or+=1){var zr=Lr[or];zr.trim();var gr=zr.getMaxScale(),Dn=24*(gr-1),pn={positionedGlyphs:[],lineOffset:0};vt.positionedLines[Wi]=pn;var Gr=pn.positionedGlyphs,xi=0;if(zr.length()){for(var fn=0;fn<zr.length();fn++){var xr=zr.getSection(fn),to=zr.getSectionIndex(fn),ua=zr.getCharCode(fn),ro=0,mi=null,io=null,Aa=null,vl=24,Cs=!(ii===la.horizontal||!ui&&!Ys(ua)||ui&&(Bc[ua]||(Do=ua,nt.Arabic(Do)||nt["Arabic Supplement"](Do)||nt["Arabic Extended-A"](Do)||nt["Arabic Presentation Forms-A"](Do)||nt["Arabic Presentation Forms-B"](Do))));if(xr.imageName){var bl=mr[xr.imageName];if(!bl)continue;Aa=xr.imageName,vt.iconsInText=vt.iconsInText||!0,io=bl.paddedRect;var Mo=bl.displaySize;xr.scale=24*xr.scale/Bi,ro=Dn+(24-Mo[1]*xr.scale),vl=(mi={width:Mo[0],height:Mo[1],left:1,top:-3,advance:Cs?Mo[1]:Mo[0]}).advance;var xl=Cs?Mo[0]*xr.scale-24*gr:Mo[1]*xr.scale-24*gr;xl>0&&xl>xi&&(xi=xl)}else{var Zc=Zt[xr.fontStack],wl=Zc&&Zc[ua];if(wl&&wl.rect)io=wl.rect,mi=wl.metrics;else{var bu=tr[xr.fontStack],Kc=bu&&bu[ua];if(!Kc)continue;mi=Kc.metrics}ro=24*(gr-xr.scale)}Cs?(vt.verticalizable=!0,Gr.push({glyph:ua,imageName:Aa,x:Fi,y:wn+ro,vertical:Cs,scale:xr.scale,fontStack:xr.fontStack,sectionIndex:to,metrics:mi,rect:io}),Fi+=vl*xr.scale+Yr):(Gr.push({glyph:ua,imageName:Aa,x:Fi,y:wn+ro,vertical:Cs,scale:xr.scale,fontStack:xr.fontStack,sectionIndex:to,metrics:mi,rect:io}),Fi+=mi.advance*xr.scale+Yr)}Gr.length!==0&&(Xi=Math.max(Fi-Yr,Xi),Tg(Gr,0,Gr.length-1,di,xi)),Fi=0;var Hc=br*gr+xi;pn.lineOffset=Math.max(xi,Dn),wn+=Hc,Sn=Math.max(Hc,Sn),++Wi}else wn+=br,++Wi}var Do,xu=wn- -17,Sl=tp(Wr),Qo=Sl.horizontalAlign,El=Sl.verticalAlign;(function(Xc,Wc,wu,Su,Yc,Eu,ku,Tu,Jc){var kl,Qc=(Wc-wu)*Yc;kl=Eu!==ku?-Tu*Su- -17:(-Su*Jc+.5)*ku;for(var Tl=0,Iu=Xc;Tl<Iu.length;Tl+=1)for(var Ms=0,Pu=Iu[Tl].positionedGlyphs;Ms<Pu.length;Ms+=1){var Il=Pu[Ms];Il.x+=Qc,Il.y+=kl}})(vt.positionedLines,di,Qo,El,Xi,Sn,br,xu,Pt.length),vt.top+=-El*xu,vt.bottom=vt.top+xu,vt.left+=-Qo*Xi,vt.right=vt.left+Xi}(Lt,t,i,u,he,x,E,z,B,A,q,ee),!function(vt){for(var tr=0,Zt=vt;tr<Zt.length;tr+=1)if(Zt[tr].positionedGlyphs.length!==0)return!1;return!0}(Qt)&&Lt}xn.fromFeature=function(e,t){for(var i=new xn,u=0;u<e.sections.length;u++){var f=e.sections[u];f.image?i.addImageSection(f):i.addTextSection(f,t)}return i},xn.prototype.length=function(){return this.text.length},xn.prototype.getSection=function(e){return this.sections[this.sectionIndex[e]]},xn.prototype.getSectionIndex=function(e){return this.sectionIndex[e]},xn.prototype.getCharCode=function(e){return this.text.charCodeAt(e)},xn.prototype.verticalizePunctuation=function(){this.text=function(e){for(var t="",i=0;i<e.length;i++){var u=e.charCodeAt(i+1)||null,f=e.charCodeAt(i-1)||null;t+=u&&eu(u)&&!mu[e[i+1]]||f&&eu(f)&&!mu[e[i-1]]||!mu[e[i]]?e[i]:mu[e[i]]}return t}(this.text)},xn.prototype.trim=function(){for(var e=0,t=0;t<this.text.length&&Bc[this.text.charCodeAt(t)];t++)e++;for(var i=this.text.length,u=this.text.length-1;u>=0&&u>=e&&Bc[this.text.charCodeAt(u)];u--)i--;this.text=this.text.substring(e,i),this.sectionIndex=this.sectionIndex.slice(e,i)},xn.prototype.substring=function(e,t){var i=new xn;return i.text=this.text.substring(e,t),i.sectionIndex=this.sectionIndex.slice(e,t),i.sections=this.sections,i},xn.prototype.toString=function(){return this.text},xn.prototype.getMaxScale=function(){var e=this;return this.sectionIndex.reduce(function(t,i){return Math.max(t,e.sections[i].scale)},0)},xn.prototype.addTextSection=function(e,t){this.text+=e.text,this.sections.push(hl.forText(e.scale,e.fontStack||t));for(var i=this.sections.length-1,u=0;u<e.text.length;++u)this.sectionIndex.push(i)},xn.prototype.addImageSection=function(e){var t=e.image?e.image.name:"";if(t.length!==0){var i=this.getNextImageSectionCharCode();i?(this.text+=String.fromCharCode(i),this.sections.push(hl.forImage(t)),this.sectionIndex.push(this.sections.length-1)):qe("Reached maximum number of images 6401")}else qe("Can't add FormattedSection with an empty image.")},xn.prototype.getNextImageSectionCharCode=function(){return this.imageSectionID?this.imageSectionID>=63743?null:++this.imageSectionID:(this.imageSectionID=57344,this.imageSectionID)};var Bc={9:!0,10:!0,11:!0,12:!0,13:!0,32:!0},ra={};function gf(e,t,i,u,f,m){if(t.imageName){var x=u[t.imageName];return x?x.displaySize[0]*t.scale*24/m+f:0}var E=i[t.fontStack],z=E&&E[e];return z?z.metrics.advance*t.scale+f:0}function _f(e,t,i,u){var f=Math.pow(e-t,2);return u?e<t?f/2:2*f:f+Math.abs(i)*i}function kg(e,t,i){var u=0;return e===10&&(u-=1e4),i&&(u+=150),e!==40&&e!==65288||(u+=50),t!==41&&t!==65289||(u+=50),u}function vf(e,t,i,u,f,m){for(var x=null,E=_f(t,i,f,m),z=0,A=u;z<A.length;z+=1){var D=A[z],B=_f(t-D.x,i,f,m)+D.badness;B<=E&&(x=D,E=B)}return{index:e,x:t,priorBreak:x,badness:E}}function ep(e,t,i,u,f,m,x){if(m!=="point")return[];if(!e)return[];for(var E,z=[],A=function(he,oe,ye,be,Ee,Te){for(var Me=0,Ke=0;Ke<he.length();Ke++){var $e=he.getSection(Ke);Me+=gf(he.getCharCode(Ke),$e,be,Ee,oe,Te)}return Me/Math.max(1,Math.ceil(Me/ye))}(e,t,i,u,f,x),D=e.text.indexOf("​")>=0,B=0,q=0;q<e.length();q++){var G=e.getSection(q),J=e.getCharCode(q);if(Bc[J]||(B+=gf(J,G,u,f,t,x)),q<e.length()-1){var ee=!((E=J)<11904||!(nt["Bopomofo Extended"](E)||nt.Bopomofo(E)||nt["CJK Compatibility Forms"](E)||nt["CJK Compatibility Ideographs"](E)||nt["CJK Compatibility"](E)||nt["CJK Radicals Supplement"](E)||nt["CJK Strokes"](E)||nt["CJK Symbols and Punctuation"](E)||nt["CJK Unified Ideographs Extension A"](E)||nt["CJK Unified Ideographs"](E)||nt["Enclosed CJK Letters and Months"](E)||nt["Halfwidth and Fullwidth Forms"](E)||nt.Hiragana(E)||nt["Ideographic Description Characters"](E)||nt["Kangxi Radicals"](E)||nt["Katakana Phonetic Extensions"](E)||nt.Katakana(E)||nt["Vertical Forms"](E)||nt["Yi Radicals"](E)||nt["Yi Syllables"](E)));(ra[J]||ee||G.imageName)&&z.push(vf(q+1,B,A,z,kg(J,e.getCharCode(q+1),ee&&D),!1))}}return function he(oe){return oe?he(oe.priorBreak).concat(oe.index):[]}(vf(e.length(),B,A,z,0,!0))}function tp(e){var t=.5,i=.5;switch(e){case"right":case"top-right":case"bottom-right":t=1;break;case"left":case"top-left":case"bottom-left":t=0}switch(e){case"bottom":case"bottom-right":case"bottom-left":i=1;break;case"top":case"top-right":case"top-left":i=0}return{horizontalAlign:t,verticalAlign:i}}function Tg(e,t,i,u,f){if(u||f)for(var m=e[i],x=(e[i].x+m.metrics.advance*m.scale)*u,E=t;E<=i;E++)e[E].x-=x,e[E].y+=f}function bf(e,t,i,u,f,m){var x,E=e.image;if(E.content){var z=E.content,A=E.pixelRatio||1;x=[z[0]/A,z[1]/A,E.displaySize[0]-z[2]/A,E.displaySize[1]-z[3]/A]}var D,B,q,G,J=t.left*m,ee=t.right*m;i==="width"||i==="both"?(G=f[0]+J-u[3],B=f[0]+ee+u[1]):B=(G=f[0]+(J+ee-E.displaySize[0])/2)+E.displaySize[0];var he=t.top*m,oe=t.bottom*m;return i==="height"||i==="both"?(D=f[1]+he-u[0],q=f[1]+oe+u[2]):q=(D=f[1]+(he+oe-E.displaySize[1])/2)+E.displaySize[1],{image:E,top:D,right:B,bottom:q,left:G,collisionPadding:x}}ra[10]=!0,ra[32]=!0,ra[38]=!0,ra[40]=!0,ra[41]=!0,ra[43]=!0,ra[45]=!0,ra[47]=!0,ra[173]=!0,ra[183]=!0,ra[8203]=!0,ra[8208]=!0,ra[8211]=!0,ra[8231]=!0;var pl=function(e){function t(i,u,f,m){e.call(this,i,u),this.angle=f,m!==void 0&&(this.segment=m)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.clone=function(){return new t(this.x,this.y,this.angle,this.segment)},t}(M);function rp(e,t){var i=t.expression;if(i.kind==="constant")return{kind:"constant",layoutSize:i.evaluate(new rr(e+1))};if(i.kind==="source")return{kind:"source"};for(var u=i.zoomStops,f=i.interpolationType,m=0;m<u.length&&u[m]<=e;)m++;for(var x=m=Math.max(0,m-1);x<u.length&&u[x]<e+1;)x++;x=Math.min(u.length-1,x);var E=u[m],z=u[x];return i.kind==="composite"?{kind:"composite",minZoom:E,maxZoom:z,interpolationType:f}:{kind:"camera",minZoom:E,maxZoom:z,minSize:i.evaluate(new rr(E)),maxSize:i.evaluate(new rr(z)),interpolationType:f}}function xf(e,t,i){var u=t.uSize,f=i.lowerSize;return e.kind==="source"?f/128:e.kind==="composite"?vi(f/128,i.upperSize/128,t.uSizeT):u}function wf(e,t){var i=0,u=0;if(e.kind==="constant")u=e.layoutSize;else if(e.kind!=="source"){var f=e.interpolationType,m=f?le(en.interpolationFactor(f,t,e.minZoom,e.maxZoom),0,1):0;e.kind==="camera"?u=vi(e.minSize,e.maxSize,m):i=m}return{uSizeT:i,uSize:u}}pt("Anchor",pl);var Ig=Object.freeze({__proto__:null,getSizeData:rp,evaluateSizeForFeature:xf,evaluateSizeForZoom:wf,SIZE_PACK_FACTOR:128});function Sf(e,t,i,u,f){if(t.segment===void 0)return!0;for(var m=t,x=t.segment+1,E=0;E>-i/2;){if(--x<0)return!1;E-=e[x].dist(m),m=e[x]}E+=e[x].dist(e[x+1]),x++;for(var z=[],A=0;E<i/2;){var D=e[x],B=e[x+1];if(!B)return!1;var q=e[x-1].angleTo(D)-D.angleTo(B);for(q=Math.abs((q+3*Math.PI)%(2*Math.PI)-Math.PI),z.push({distance:E,angleDelta:q}),A+=q;E-z[0].distance>u;)A-=z.shift().angleDelta;if(A>f)return!1;x++,E+=D.dist(B)}return!0}function Ef(e){for(var t=0,i=0;i<e.length-1;i++)t+=e[i].dist(e[i+1]);return t}function kf(e,t,i){return e?.6*t*i:0}function Tf(e,t){return Math.max(e?e.right-e.left:0,t?t.right-t.left:0)}function Pg(e,t,i,u,f,m){for(var x=kf(i,f,m),E=Tf(i,u)*m,z=0,A=Ef(e)/2,D=0;D<e.length-1;D++){var B=e[D],q=e[D+1],G=B.dist(q);if(z+G>A){var J=(A-z)/G,ee=vi(B.x,q.x,J),he=vi(B.y,q.y,J),oe=new pl(ee,he,q.angleTo(B),D);return oe._round(),!x||Sf(e,oe,E,x,t)?oe:void 0}z+=G}}function zg(e,t,i,u,f,m,x,E,z){var A=kf(u,m,x),D=Tf(u,f),B=D*x,q=e[0].x===0||e[0].x===z||e[0].y===0||e[0].y===z;return t-B<t/4&&(t=B+t/4),function G(J,ee,he,oe,ye,be,Ee,Te,Me){for(var Ke=be/2,$e=Ef(J),bt=0,lt=ee-he,kt=[],ut=0;ut<J.length-1;ut++){for(var Qt=J[ut],Lt=J[ut+1],vt=Qt.dist(Lt),tr=Lt.angleTo(Qt);lt+he<bt+vt;){var Zt=((lt+=he)-bt)/vt,mr=vi(Qt.x,Lt.x,Zt),Pt=vi(Qt.y,Lt.y,Zt);if(mr>=0&&mr<Me&&Pt>=0&&Pt<Me&&lt-Ke>=0&&lt+Ke<=$e){var br=new pl(mr,Pt,tr,ut);br._round(),oe&&!Sf(J,br,be,oe,ye)||kt.push(br)}}bt+=vt}return Te||kt.length||Ee||(kt=G(J,bt/2,he,oe,ye,be,Ee,!0,Me)),kt}(e,q?t/2*E%t:(D/2+2*m)*x*E%t,t,A,i,B,q,!1,z)}function If(e,t,i,u,f){for(var m=[],x=0;x<e.length;x++)for(var E=e[x],z=void 0,A=0;A<E.length-1;A++){var D=E[A],B=E[A+1];D.x<t&&B.x<t||(D.x<t?D=new M(t,D.y+(t-D.x)/(B.x-D.x)*(B.y-D.y))._round():B.x<t&&(B=new M(t,D.y+(t-D.x)/(B.x-D.x)*(B.y-D.y))._round()),D.y<i&&B.y<i||(D.y<i?D=new M(D.x+(i-D.y)/(B.y-D.y)*(B.x-D.x),i)._round():B.y<i&&(B=new M(D.x+(i-D.y)/(B.y-D.y)*(B.x-D.x),i)._round()),D.x>=u&&B.x>=u||(D.x>=u?D=new M(u,D.y+(u-D.x)/(B.x-D.x)*(B.y-D.y))._round():B.x>=u&&(B=new M(u,D.y+(u-D.x)/(B.x-D.x)*(B.y-D.y))._round()),D.y>=f&&B.y>=f||(D.y>=f?D=new M(D.x+(f-D.y)/(B.y-D.y)*(B.x-D.x),f)._round():B.y>=f&&(B=new M(D.x+(f-D.y)/(B.y-D.y)*(B.x-D.x),f)._round()),z&&D.equals(z[z.length-1])||m.push(z=[D]),z.push(B)))))}return m}function Pf(e,t,i,u){var f=[],m=e.image,x=m.pixelRatio,E=m.paddedRect.w-2,z=m.paddedRect.h-2,A=e.right-e.left,D=e.bottom-e.top,B=m.stretchX||[[0,E]],q=m.stretchY||[[0,z]],G=function(mr,Pt){return mr+Pt[1]-Pt[0]},J=B.reduce(G,0),ee=q.reduce(G,0),he=E-J,oe=z-ee,ye=0,be=J,Ee=0,Te=ee,Me=0,Ke=he,$e=0,bt=oe;if(m.content&&u){var lt=m.content;ye=Fc(B,0,lt[0]),Ee=Fc(q,0,lt[1]),be=Fc(B,lt[0],lt[2]),Te=Fc(q,lt[1],lt[3]),Me=lt[0]-ye,$e=lt[1]-Ee,Ke=lt[2]-lt[0]-be,bt=lt[3]-lt[1]-Te}var kt=function(mr,Pt,br,Wr){var li=Oc(mr.stretch-ye,be,A,e.left),ii=Nc(mr.fixed-Me,Ke,mr.stretch,J),Yr=Oc(Pt.stretch-Ee,Te,D,e.top),ui=Nc(Pt.fixed-$e,bt,Pt.stretch,ee),Bi=Oc(br.stretch-ye,be,A,e.left),Fi=Nc(br.fixed-Me,Ke,br.stretch,J),wn=Oc(Wr.stretch-Ee,Te,D,e.top),Xi=Nc(Wr.fixed-$e,bt,Wr.stretch,ee),Sn=new M(li,Yr),di=new M(Bi,Yr),Wi=new M(Bi,wn),or=new M(li,wn),Lr=new M(ii/x,ui/x),zr=new M(Fi/x,Xi/x),gr=t*Math.PI/180;if(gr){var Dn=Math.sin(gr),pn=Math.cos(gr),Gr=[pn,-Dn,Dn,pn];Sn._matMult(Gr),di._matMult(Gr),or._matMult(Gr),Wi._matMult(Gr)}var xi=mr.stretch+mr.fixed,fn=Pt.stretch+Pt.fixed;return{tl:Sn,tr:di,bl:or,br:Wi,tex:{x:m.paddedRect.x+1+xi,y:m.paddedRect.y+1+fn,w:br.stretch+br.fixed-xi,h:Wr.stretch+Wr.fixed-fn},writingMode:void 0,glyphOffset:[0,0],sectionIndex:0,pixelOffsetTL:Lr,pixelOffsetBR:zr,minFontScaleX:Ke/x/A,minFontScaleY:bt/x/D,isSDF:i}};if(u&&(m.stretchX||m.stretchY))for(var ut=zf(B,he,J),Qt=zf(q,oe,ee),Lt=0;Lt<ut.length-1;Lt++)for(var vt=ut[Lt],tr=ut[Lt+1],Zt=0;Zt<Qt.length-1;Zt++)f.push(kt(vt,Qt[Zt],tr,Qt[Zt+1]));else f.push(kt({fixed:0,stretch:-1},{fixed:0,stretch:-1},{fixed:0,stretch:E+1},{fixed:0,stretch:z+1}));return f}function Fc(e,t,i){for(var u=0,f=0,m=e;f<m.length;f+=1){var x=m[f];u+=Math.max(t,Math.min(i,x[1]))-Math.max(t,Math.min(i,x[0]))}return u}function zf(e,t,i){for(var u=[{fixed:-1,stretch:0}],f=0,m=e;f<m.length;f+=1){var x=m[f],E=x[0],z=x[1],A=u[u.length-1];u.push({fixed:E-A.stretch,stretch:A.stretch}),u.push({fixed:E-A.stretch,stretch:A.stretch+(z-E)})}return u.push({fixed:t+1,stretch:i}),u}function Oc(e,t,i,u){return e/t*i+u}function Nc(e,t,i,u){return e-t*i/u}var Uc=function(e,t,i,u,f,m,x,E,z,A){if(this.boxStartIndex=e.length,z){var D=m.top,B=m.bottom,q=m.collisionPadding;q&&(D-=q[1],B+=q[3]);var G=B-D;G>0&&(G=Math.max(10,G),this.circleDiameter=G)}else{var J=m.top*x-E,ee=m.bottom*x+E,he=m.left*x-E,oe=m.right*x+E,ye=m.collisionPadding;if(ye&&(he-=ye[0]*x,J-=ye[1]*x,oe+=ye[2]*x,ee+=ye[3]*x),A){var be=new M(he,J),Ee=new M(oe,J),Te=new M(he,ee),Me=new M(oe,ee),Ke=A*Math.PI/180;be._rotate(Ke),Ee._rotate(Ke),Te._rotate(Ke),Me._rotate(Ke),he=Math.min(be.x,Ee.x,Te.x,Me.x),oe=Math.max(be.x,Ee.x,Te.x,Me.x),J=Math.min(be.y,Ee.y,Te.y,Me.y),ee=Math.max(be.y,Ee.y,Te.y,Me.y)}e.emplaceBack(t.x,t.y,he,J,oe,ee,i,u,f)}this.boxEndIndex=e.length},fl=function(e,t){if(e===void 0&&(e=[]),t===void 0&&(t=Ag),this.data=e,this.length=this.data.length,this.compare=t,this.length>0)for(var i=(this.length>>1)-1;i>=0;i--)this._down(i)};function Ag(e,t){return e<t?-1:e>t?1:0}function Cg(e,t,i){t===void 0&&(t=1),i===void 0&&(i=!1);for(var u=1/0,f=1/0,m=-1/0,x=-1/0,E=e[0],z=0;z<E.length;z++){var A=E[z];(!z||A.x<u)&&(u=A.x),(!z||A.y<f)&&(f=A.y),(!z||A.x>m)&&(m=A.x),(!z||A.y>x)&&(x=A.y)}var D=Math.min(m-u,x-f),B=D/2,q=new fl([],Mg);if(D===0)return new M(u,f);for(var G=u;G<m;G+=D)for(var J=f;J<x;J+=D)q.push(new dl(G+B,J+B,B,e));for(var ee=function(ye){for(var be=0,Ee=0,Te=0,Me=ye[0],Ke=0,$e=Me.length,bt=$e-1;Ke<$e;bt=Ke++){var lt=Me[Ke],kt=Me[bt],ut=lt.x*kt.y-kt.x*lt.y;Ee+=(lt.x+kt.x)*ut,Te+=(lt.y+kt.y)*ut,be+=3*ut}return new dl(Ee/be,Te/be,0,ye)}(e),he=q.length;q.length;){var oe=q.pop();(oe.d>ee.d||!ee.d)&&(ee=oe,i&&console.log("found best %d after %d probes",Math.round(1e4*oe.d)/1e4,he)),oe.max-ee.d<=t||(q.push(new dl(oe.p.x-(B=oe.h/2),oe.p.y-B,B,e)),q.push(new dl(oe.p.x+B,oe.p.y-B,B,e)),q.push(new dl(oe.p.x-B,oe.p.y+B,B,e)),q.push(new dl(oe.p.x+B,oe.p.y+B,B,e)),he+=4)}return i&&(console.log("num probes: "+he),console.log("best distance: "+ee.d)),ee.p}function Mg(e,t){return t.max-e.max}function dl(e,t,i,u){this.p=new M(e,t),this.h=i,this.d=function(f,m){for(var x=!1,E=1/0,z=0;z<m.length;z++)for(var A=m[z],D=0,B=A.length,q=B-1;D<B;q=D++){var G=A[D],J=A[q];G.y>f.y!=J.y>f.y&&f.x<(J.x-G.x)*(f.y-G.y)/(J.y-G.y)+G.x&&(x=!x),E=Math.min(E,Xo(f,G,J))}return(x?1:-1)*Math.sqrt(E)}(this.p,u),this.max=this.d+this.h*Math.SQRT2}fl.prototype.push=function(e){this.data.push(e),this.length++,this._up(this.length-1)},fl.prototype.pop=function(){if(this.length!==0){var e=this.data[0],t=this.data.pop();return this.length--,this.length>0&&(this.data[0]=t,this._down(0)),e}},fl.prototype.peek=function(){return this.data[0]},fl.prototype._up=function(e){for(var t=this.data,i=this.compare,u=t[e];e>0;){var f=e-1>>1,m=t[f];if(i(u,m)>=0)break;t[e]=m,e=f}t[e]=u},fl.prototype._down=function(e){for(var t=this.data,i=this.compare,u=this.length>>1,f=t[e];e<u;){var m=1+(e<<1),x=t[m],E=m+1;if(E<this.length&&i(t[E],x)<0&&(m=E,x=t[E]),i(x,f)>=0)break;t[e]=x,e=m}t[e]=f};var ip=Number.POSITIVE_INFINITY;function Af(e,t){return t[1]!==ip?function(i,u,f){var m=0,x=0;switch(u=Math.abs(u),f=Math.abs(f),i){case"top-right":case"top-left":case"top":x=f-7;break;case"bottom-right":case"bottom-left":case"bottom":x=7-f}switch(i){case"top-right":case"bottom-right":case"right":m=-u;break;case"top-left":case"bottom-left":case"left":m=u}return[m,x]}(e,t[0],t[1]):function(i,u){var f=0,m=0;u<0&&(u=0);var x=u/Math.sqrt(2);switch(i){case"top-right":case"top-left":m=x-7;break;case"bottom-right":case"bottom-left":m=7-x;break;case"bottom":m=7-u;break;case"top":m=u-7}switch(i){case"top-right":case"bottom-right":f=-x;break;case"top-left":case"bottom-left":f=x;break;case"left":f=u;break;case"right":f=-u}return[f,m]}(e,t[0])}function np(e){switch(e){case"right":case"top-right":case"bottom-right":return"right";case"left":case"top-left":case"bottom-left":return"left"}return"center"}function Cf(e,t,i,u,f,m,x,E,z,A,D,B,q,G,J){var ee=function(Ee,Te,Me,Ke,$e,bt,lt,kt){for(var ut=Ke.layout.get("text-rotate").evaluate(bt,{})*Math.PI/180,Qt=[],Lt=0,vt=Te.positionedLines;Lt<vt.length;Lt+=1)for(var tr=vt[Lt],Zt=0,mr=tr.positionedGlyphs;Zt<mr.length;Zt+=1){var Pt=mr[Zt];if(Pt.rect){var br=Pt.rect||{},Wr=4,li=!0,ii=1,Yr=0,ui=($e||kt)&&Pt.vertical,Bi=Pt.metrics.advance*Pt.scale/2;if(kt&&Te.verticalizable&&(Yr=tr.lineOffset/2-(Pt.imageName?-(24-Pt.metrics.width*Pt.scale)/2:24*(Pt.scale-1))),Pt.imageName){var Fi=lt[Pt.imageName];li=Fi.sdf,Wr=1/(ii=Fi.pixelRatio)}var wn=$e?[Pt.x+Bi,Pt.y]:[0,0],Xi=$e?[0,0]:[Pt.x+Bi+Me[0],Pt.y+Me[1]-Yr],Sn=[0,0];ui&&(Sn=Xi,Xi=[0,0]);var di=(Pt.metrics.left-Wr)*Pt.scale-Bi+Xi[0],Wi=(-Pt.metrics.top-Wr)*Pt.scale+Xi[1],or=di+br.w*Pt.scale/ii,Lr=Wi+br.h*Pt.scale/ii,zr=new M(di,Wi),gr=new M(or,Wi),Dn=new M(di,Lr),pn=new M(or,Lr);if(ui){var Gr=new M(-Bi,Bi- -17),xi=-Math.PI/2,fn=12-Bi,xr=new M(22-fn,-(Pt.imageName?fn:0)),to=new(Function.prototype.bind.apply(M,[null].concat(Sn)));zr._rotateAround(xi,Gr)._add(xr)._add(to),gr._rotateAround(xi,Gr)._add(xr)._add(to),Dn._rotateAround(xi,Gr)._add(xr)._add(to),pn._rotateAround(xi,Gr)._add(xr)._add(to)}if(ut){var ua=Math.sin(ut),ro=Math.cos(ut),mi=[ro,-ua,ua,ro];zr._matMult(mi),gr._matMult(mi),Dn._matMult(mi),pn._matMult(mi)}var io=new M(0,0),Aa=new M(0,0);Qt.push({tl:zr,tr:gr,bl:Dn,br:pn,tex:br,writingMode:Te.writingMode,glyphOffset:wn,sectionIndex:Pt.sectionIndex,isSDF:li,pixelOffsetTL:io,pixelOffsetBR:Aa,minFontScaleX:0,minFontScaleY:0})}}return Qt}(0,i,E,f,m,x,u,e.allowVerticalPlacement),he=e.textSizeData,oe=null;he.kind==="source"?(oe=[128*f.layout.get("text-size").evaluate(x,{})])[0]>32640&&qe(e.layerIds[0]+': Value for "text-size" is >= 255. Reduce your "text-size".'):he.kind==="composite"&&((oe=[128*G.compositeTextSizes[0].evaluate(x,{},J),128*G.compositeTextSizes[1].evaluate(x,{},J)])[0]>32640||oe[1]>32640)&&qe(e.layerIds[0]+': Value for "text-size" is >= 255. Reduce your "text-size".'),e.addSymbols(e.text,ee,oe,E,m,x,A,t,z.lineStartIndex,z.lineLength,q,J);for(var ye=0,be=D;ye<be.length;ye+=1)B[be[ye]]=e.text.placedSymbolArray.length-1;return 4*ee.length}function Mf(e){for(var t in e)return e[t];return null}function Dg(e,t,i,u){var f=e.compareText;if(t in f){for(var m=f[t],x=m.length-1;x>=0;x--)if(u.dist(m[x])<i)return!0}else f[t]=[];return f[t].push(u),!1}var Lg=ll.VectorTileFeature.types,Rg=[{name:"a_fade_opacity",components:1,type:"Uint8",offset:0}];function Vc(e,t,i,u,f,m,x,E,z,A,D,B,q){var G=E?Math.min(32640,Math.round(E[0])):0,J=E?Math.min(32640,Math.round(E[1])):0;e.emplaceBack(t,i,Math.round(32*u),Math.round(32*f),m,x,(G<<1)+(z?1:0),J,16*A,16*D,256*B,256*q)}function ap(e,t,i){e.emplaceBack(t.x,t.y,i),e.emplaceBack(t.x,t.y,i),e.emplaceBack(t.x,t.y,i),e.emplaceBack(t.x,t.y,i)}function Bg(e){for(var t=0,i=e.sections;t<i.length;t+=1)if(Js(i[t].text))return!0;return!1}var ml=function(e){this.layoutVertexArray=new tl,this.indexArray=new Wa,this.programConfigurations=e,this.segments=new K,this.dynamicLayoutVertexArray=new Zo,this.opacityVertexArray=new xs,this.placedSymbolArray=new c};ml.prototype.isEmpty=function(){return this.layoutVertexArray.length===0&&this.indexArray.length===0&&this.dynamicLayoutVertexArray.length===0&&this.opacityVertexArray.length===0},ml.prototype.upload=function(e,t,i,u){this.isEmpty()||(i&&(this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,lg.members),this.indexBuffer=e.createIndexBuffer(this.indexArray,t),this.dynamicLayoutVertexBuffer=e.createVertexBuffer(this.dynamicLayoutVertexArray,ug.members,!0),this.opacityVertexBuffer=e.createVertexBuffer(this.opacityVertexArray,Rg,!0),this.opacityVertexBuffer.itemSize=1),(i||u)&&this.programConfigurations.upload(e))},ml.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.dynamicLayoutVertexBuffer.destroy(),this.opacityVertexBuffer.destroy())},pt("SymbolBuffers",ml);var _u=function(e,t,i){this.layoutVertexArray=new e,this.layoutAttributes=t,this.indexArray=new i,this.segments=new K,this.collisionVertexArray=new ou};_u.prototype.upload=function(e){this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,this.layoutAttributes),this.indexBuffer=e.createIndexBuffer(this.indexArray),this.collisionVertexBuffer=e.createVertexBuffer(this.collisionVertexArray,cg.members,!0)},_u.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.collisionVertexBuffer.destroy())},pt("CollisionBuffers",_u);var Cr=function(e){this.collisionBoxArray=e.collisionBoxArray,this.zoom=e.zoom,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map(function(m){return m.id}),this.index=e.index,this.pixelRatio=e.pixelRatio,this.sourceLayerIndex=e.sourceLayerIndex,this.hasPattern=!1,this.hasRTLText=!1,this.sortKeyRanges=[],this.collisionCircleArray=[],this.placementInvProjMatrix=ta([]),this.placementViewportMatrix=ta([]);var t=this.layers[0]._unevaluatedLayout._values;this.textSizeData=rp(this.zoom,t["text-size"]),this.iconSizeData=rp(this.zoom,t["icon-size"]);var i=this.layers[0].layout,u=i.get("symbol-sort-key"),f=i.get("symbol-z-order");this.canOverlap=i.get("text-allow-overlap")||i.get("icon-allow-overlap")||i.get("text-ignore-placement")||i.get("icon-ignore-placement"),this.sortFeaturesByKey=f!=="viewport-y"&&u.constantOr(1)!==void 0,this.sortFeaturesByY=(f==="viewport-y"||f==="auto"&&!this.sortFeaturesByKey)&&this.canOverlap,i.get("symbol-placement")==="point"&&(this.writingModes=i.get("text-writing-mode").map(function(m){return la[m]})),this.stateDependentLayerIds=this.layers.filter(function(m){return m.isStateDependent()}).map(function(m){return m.id}),this.sourceID=e.sourceID};Cr.prototype.createArrays=function(){this.text=new ml(new Dt(this.layers,this.zoom,function(e){return/^text/.test(e)})),this.icon=new ml(new Dt(this.layers,this.zoom,function(e){return/^icon/.test(e)})),this.glyphOffsetArray=new S,this.lineVertexArray=new P,this.symbolInstances=new w},Cr.prototype.calculateGlyphDependencies=function(e,t,i,u,f){for(var m=0;m<e.length;m++)if(t[e.charCodeAt(m)]=!0,(i||u)&&f){var x=mu[e.charAt(m)];x&&(t[x.charCodeAt(0)]=!0)}},Cr.prototype.populate=function(e,t,i){var u=this.layers[0],f=u.layout,m=f.get("text-font"),x=f.get("text-field"),E=f.get("icon-image"),z=(x.value.kind!=="constant"||x.value.value instanceof ai&&!x.value.value.isEmpty()||x.value.value.toString().length>0)&&(m.value.kind!=="constant"||m.value.value.length>0),A=E.value.kind!=="constant"||!!E.value.value||Object.keys(E.parameters).length>0,D=f.get("symbol-sort-key");if(this.features=[],z||A){for(var B=t.iconDependencies,q=t.glyphDependencies,G=t.availableImages,J=new rr(this.zoom),ee=0,he=e;ee<he.length;ee+=1){var oe=he[ee],ye=oe.feature,be=oe.id,Ee=oe.index,Te=oe.sourceLayerIndex,Me=u._featureFilter.needGeometry,Ke=fi(ye,Me);if(u._featureFilter.filter(J,Ke,i)){Me||(Ke.geometry=ri(ye));var $e=void 0;if(z){var bt=u.getValueAndResolveTokens("text-field",Ke,i,G),lt=ai.factory(bt);Bg(lt)&&(this.hasRTLText=!0),(!this.hasRTLText||ru()==="unavailable"||this.hasRTLText&&ea.isParsed())&&($e=pg(lt,u,Ke))}var kt=void 0;if(A){var ut=u.getValueAndResolveTokens("icon-image",Ke,i,G);kt=ut instanceof Di?ut:Di.fromString(ut)}if($e||kt){var Qt=this.sortFeaturesByKey?D.evaluate(Ke,{},i):void 0;if(this.features.push({id:be,text:$e,icon:kt,index:Ee,sourceLayerIndex:Te,geometry:Ke.geometry,properties:ye.properties,type:Lg[ye.type],sortKey:Qt}),kt&&(B[kt.name]=!0),$e){var Lt=m.evaluate(Ke,{},i).join(","),vt=f.get("text-rotation-alignment")==="map"&&f.get("symbol-placement")!=="point";this.allowVerticalPlacement=this.writingModes&&this.writingModes.indexOf(la.vertical)>=0;for(var tr=0,Zt=$e.sections;tr<Zt.length;tr+=1){var mr=Zt[tr];if(mr.image)B[mr.image.name]=!0;else{var Pt=$l($e.toString()),br=mr.fontStack||Lt,Wr=q[br]=q[br]||{};this.calculateGlyphDependencies(mr.text,Wr,vt,this.allowVerticalPlacement,Pt)}}}}}}f.get("symbol-placement")==="line"&&(this.features=function(li){var ii={},Yr={},ui=[],Bi=0;function Fi(Gr){ui.push(li[Gr]),Bi++}function wn(Gr,xi,fn){var xr=Yr[Gr];return delete Yr[Gr],Yr[xi]=xr,ui[xr].geometry[0].pop(),ui[xr].geometry[0]=ui[xr].geometry[0].concat(fn[0]),xr}function Xi(Gr,xi,fn){var xr=ii[xi];return delete ii[xi],ii[Gr]=xr,ui[xr].geometry[0].shift(),ui[xr].geometry[0]=fn[0].concat(ui[xr].geometry[0]),xr}function Sn(Gr,xi,fn){var xr=fn?xi[0][xi[0].length-1]:xi[0][0];return Gr+":"+xr.x+":"+xr.y}for(var di=0;di<li.length;di++){var Wi=li[di],or=Wi.geometry,Lr=Wi.text?Wi.text.toString():null;if(Lr){var zr=Sn(Lr,or),gr=Sn(Lr,or,!0);if(zr in Yr&&gr in ii&&Yr[zr]!==ii[gr]){var Dn=Xi(zr,gr,or),pn=wn(zr,gr,ui[Dn].geometry);delete ii[zr],delete Yr[gr],Yr[Sn(Lr,ui[pn].geometry,!0)]=pn,ui[Dn].geometry=null}else zr in Yr?wn(zr,gr,or):gr in ii?Xi(zr,gr,or):(Fi(di),ii[zr]=Bi-1,Yr[gr]=Bi-1)}else Fi(di)}return ui.filter(function(Gr){return Gr.geometry})}(this.features)),this.sortFeaturesByKey&&this.features.sort(function(li,ii){return li.sortKey-ii.sortKey})}},Cr.prototype.update=function(e,t,i){this.stateDependentLayers.length&&(this.text.programConfigurations.updatePaintArrays(e,t,this.layers,i),this.icon.programConfigurations.updatePaintArrays(e,t,this.layers,i))},Cr.prototype.isEmpty=function(){return this.symbolInstances.length===0&&!this.hasRTLText},Cr.prototype.uploadPending=function(){return!this.uploaded||this.text.programConfigurations.needsUpload||this.icon.programConfigurations.needsUpload},Cr.prototype.upload=function(e){!this.uploaded&&this.hasDebugData()&&(this.textCollisionBox.upload(e),this.iconCollisionBox.upload(e)),this.text.upload(e,this.sortFeaturesByY,!this.uploaded,this.text.programConfigurations.needsUpload),this.icon.upload(e,this.sortFeaturesByY,!this.uploaded,this.icon.programConfigurations.needsUpload),this.uploaded=!0},Cr.prototype.destroyDebugData=function(){this.textCollisionBox.destroy(),this.iconCollisionBox.destroy()},Cr.prototype.destroy=function(){this.text.destroy(),this.icon.destroy(),this.hasDebugData()&&this.destroyDebugData()},Cr.prototype.addToLineVertexArray=function(e,t){var i=this.lineVertexArray.length;if(e.segment!==void 0){for(var u=e.dist(t[e.segment+1]),f=e.dist(t[e.segment]),m={},x=e.segment+1;x<t.length;x++)m[x]={x:t[x].x,y:t[x].y,tileUnitDistanceFromAnchor:u},x<t.length-1&&(u+=t[x+1].dist(t[x]));for(var E=e.segment||0;E>=0;E--)m[E]={x:t[E].x,y:t[E].y,tileUnitDistanceFromAnchor:f},E>0&&(f+=t[E-1].dist(t[E]));for(var z=0;z<t.length;z++){var A=m[z];this.lineVertexArray.emplaceBack(A.x,A.y,A.tileUnitDistanceFromAnchor)}}return{lineStartIndex:i,lineLength:this.lineVertexArray.length-i}},Cr.prototype.addSymbols=function(e,t,i,u,f,m,x,E,z,A,D,B){for(var q=e.indexArray,G=e.layoutVertexArray,J=e.segments.prepareSegment(4*t.length,G,q,this.canOverlap?m.sortKey:void 0),ee=this.glyphOffsetArray.length,he=J.vertexLength,oe=this.allowVerticalPlacement&&x===la.vertical?Math.PI/2:0,ye=m.text&&m.text.sections,be=0;be<t.length;be++){var Ee=t[be],Te=Ee.tl,Me=Ee.tr,Ke=Ee.bl,$e=Ee.br,bt=Ee.tex,lt=Ee.pixelOffsetTL,kt=Ee.pixelOffsetBR,ut=Ee.minFontScaleX,Qt=Ee.minFontScaleY,Lt=Ee.glyphOffset,vt=Ee.isSDF,tr=Ee.sectionIndex,Zt=J.vertexLength,mr=Lt[1];Vc(G,E.x,E.y,Te.x,mr+Te.y,bt.x,bt.y,i,vt,lt.x,lt.y,ut,Qt),Vc(G,E.x,E.y,Me.x,mr+Me.y,bt.x+bt.w,bt.y,i,vt,kt.x,lt.y,ut,Qt),Vc(G,E.x,E.y,Ke.x,mr+Ke.y,bt.x,bt.y+bt.h,i,vt,lt.x,kt.y,ut,Qt),Vc(G,E.x,E.y,$e.x,mr+$e.y,bt.x+bt.w,bt.y+bt.h,i,vt,kt.x,kt.y,ut,Qt),ap(e.dynamicLayoutVertexArray,E,oe),q.emplaceBack(Zt,Zt+1,Zt+2),q.emplaceBack(Zt+1,Zt+2,Zt+3),J.vertexLength+=4,J.primitiveLength+=2,this.glyphOffsetArray.emplaceBack(Lt[0]),be!==t.length-1&&tr===t[be+1].sectionIndex||e.programConfigurations.populatePaintArrays(G.length,m,m.index,{},B,ye&&ye[tr])}e.placedSymbolArray.emplaceBack(E.x,E.y,ee,this.glyphOffsetArray.length-ee,he,z,A,E.segment,i?i[0]:0,i?i[1]:0,u[0],u[1],x,0,!1,0,D)},Cr.prototype._addCollisionDebugVertex=function(e,t,i,u,f,m){return t.emplaceBack(0,0),e.emplaceBack(i.x,i.y,u,f,Math.round(m.x),Math.round(m.y))},Cr.prototype.addCollisionDebugVertices=function(e,t,i,u,f,m,x){var E=f.segments.prepareSegment(4,f.layoutVertexArray,f.indexArray),z=E.vertexLength,A=f.layoutVertexArray,D=f.collisionVertexArray,B=x.anchorX,q=x.anchorY;this._addCollisionDebugVertex(A,D,m,B,q,new M(e,t)),this._addCollisionDebugVertex(A,D,m,B,q,new M(i,t)),this._addCollisionDebugVertex(A,D,m,B,q,new M(i,u)),this._addCollisionDebugVertex(A,D,m,B,q,new M(e,u)),E.vertexLength+=4;var G=f.indexArray;G.emplaceBack(z,z+1),G.emplaceBack(z+1,z+2),G.emplaceBack(z+2,z+3),G.emplaceBack(z+3,z),E.primitiveLength+=4},Cr.prototype.addDebugCollisionBoxes=function(e,t,i,u){for(var f=e;f<t;f++){var m=this.collisionBoxArray.get(f);this.addCollisionDebugVertices(m.x1,m.y1,m.x2,m.y2,u?this.textCollisionBox:this.iconCollisionBox,m.anchorPoint,i)}},Cr.prototype.generateCollisionDebugBuffers=function(){this.hasDebugData()&&this.destroyDebugData(),this.textCollisionBox=new _u(Ko,cf.members,ws),this.iconCollisionBox=new _u(Ko,cf.members,ws);for(var e=0;e<this.symbolInstances.length;e++){var t=this.symbolInstances.get(e);this.addDebugCollisionBoxes(t.textBoxStartIndex,t.textBoxEndIndex,t,!0),this.addDebugCollisionBoxes(t.verticalTextBoxStartIndex,t.verticalTextBoxEndIndex,t,!0),this.addDebugCollisionBoxes(t.iconBoxStartIndex,t.iconBoxEndIndex,t,!1),this.addDebugCollisionBoxes(t.verticalIconBoxStartIndex,t.verticalIconBoxEndIndex,t,!1)}},Cr.prototype._deserializeCollisionBoxesForSymbol=function(e,t,i,u,f,m,x,E,z){for(var A={},D=t;D<i;D++){var B=e.get(D);A.textBox={x1:B.x1,y1:B.y1,x2:B.x2,y2:B.y2,anchorPointX:B.anchorPointX,anchorPointY:B.anchorPointY},A.textFeatureIndex=B.featureIndex;break}for(var q=u;q<f;q++){var G=e.get(q);A.verticalTextBox={x1:G.x1,y1:G.y1,x2:G.x2,y2:G.y2,anchorPointX:G.anchorPointX,anchorPointY:G.anchorPointY},A.verticalTextFeatureIndex=G.featureIndex;break}for(var J=m;J<x;J++){var ee=e.get(J);A.iconBox={x1:ee.x1,y1:ee.y1,x2:ee.x2,y2:ee.y2,anchorPointX:ee.anchorPointX,anchorPointY:ee.anchorPointY},A.iconFeatureIndex=ee.featureIndex;break}for(var he=E;he<z;he++){var oe=e.get(he);A.verticalIconBox={x1:oe.x1,y1:oe.y1,x2:oe.x2,y2:oe.y2,anchorPointX:oe.anchorPointX,anchorPointY:oe.anchorPointY},A.verticalIconFeatureIndex=oe.featureIndex;break}return A},Cr.prototype.deserializeCollisionBoxes=function(e){this.collisionArrays=[];for(var t=0;t<this.symbolInstances.length;t++){var i=this.symbolInstances.get(t);this.collisionArrays.push(this._deserializeCollisionBoxesForSymbol(e,i.textBoxStartIndex,i.textBoxEndIndex,i.verticalTextBoxStartIndex,i.verticalTextBoxEndIndex,i.iconBoxStartIndex,i.iconBoxEndIndex,i.verticalIconBoxStartIndex,i.verticalIconBoxEndIndex))}},Cr.prototype.hasTextData=function(){return this.text.segments.get().length>0},Cr.prototype.hasIconData=function(){return this.icon.segments.get().length>0},Cr.prototype.hasDebugData=function(){return this.textCollisionBox&&this.iconCollisionBox},Cr.prototype.hasTextCollisionBoxData=function(){return this.hasDebugData()&&this.textCollisionBox.segments.get().length>0},Cr.prototype.hasIconCollisionBoxData=function(){return this.hasDebugData()&&this.iconCollisionBox.segments.get().length>0},Cr.prototype.addIndicesForPlacedSymbol=function(e,t){for(var i=e.placedSymbolArray.get(t),u=i.vertexStartIndex+4*i.numGlyphs,f=i.vertexStartIndex;f<u;f+=4)e.indexArray.emplaceBack(f,f+1,f+2),e.indexArray.emplaceBack(f+1,f+2,f+3)},Cr.prototype.getSortedSymbolIndexes=function(e){if(this.sortedAngle===e&&this.symbolInstanceIndexes!==void 0)return this.symbolInstanceIndexes;for(var t=Math.sin(e),i=Math.cos(e),u=[],f=[],m=[],x=0;x<this.symbolInstances.length;++x){m.push(x);var E=this.symbolInstances.get(x);u.push(0|Math.round(t*E.anchorX+i*E.anchorY)),f.push(E.featureIndex)}return m.sort(function(z,A){return u[z]-u[A]||f[A]-f[z]}),m},Cr.prototype.addToSortKeyRanges=function(e,t){var i=this.sortKeyRanges[this.sortKeyRanges.length-1];i&&i.sortKey===t?i.symbolInstanceEnd=e+1:this.sortKeyRanges.push({sortKey:t,symbolInstanceStart:e,symbolInstanceEnd:e+1})},Cr.prototype.sortFeatures=function(e){var t=this;if(this.sortFeaturesByY&&this.sortedAngle!==e&&!(this.text.segments.get().length>1||this.icon.segments.get().length>1)){this.symbolInstanceIndexes=this.getSortedSymbolIndexes(e),this.sortedAngle=e,this.text.indexArray.clear(),this.icon.indexArray.clear(),this.featureSortOrder=[];for(var i=0,u=this.symbolInstanceIndexes;i<u.length;i+=1){var f=this.symbolInstances.get(u[i]);this.featureSortOrder.push(f.featureIndex),[f.rightJustifiedTextSymbolIndex,f.centerJustifiedTextSymbolIndex,f.leftJustifiedTextSymbolIndex].forEach(function(m,x,E){m>=0&&E.indexOf(m)===x&&t.addIndicesForPlacedSymbol(t.text,m)}),f.verticalPlacedTextSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.text,f.verticalPlacedTextSymbolIndex),f.placedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,f.placedIconSymbolIndex),f.verticalPlacedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,f.verticalPlacedIconSymbolIndex)}this.text.indexBuffer&&this.text.indexBuffer.updateData(this.text.indexArray),this.icon.indexBuffer&&this.icon.indexBuffer.updateData(this.icon.indexArray)}},pt("SymbolBucket",Cr,{omit:["layers","collisionBoxArray","features","compareText"]}),Cr.MAX_GLYPHS=65535,Cr.addDynamicAttributes=ap;var Fg=new rn({"symbol-placement":new St(j.layout_symbol["symbol-placement"]),"symbol-spacing":new St(j.layout_symbol["symbol-spacing"]),"symbol-avoid-edges":new St(j.layout_symbol["symbol-avoid-edges"]),"symbol-sort-key":new _t(j.layout_symbol["symbol-sort-key"]),"symbol-z-order":new St(j.layout_symbol["symbol-z-order"]),"icon-allow-overlap":new St(j.layout_symbol["icon-allow-overlap"]),"icon-ignore-placement":new St(j.layout_symbol["icon-ignore-placement"]),"icon-optional":new St(j.layout_symbol["icon-optional"]),"icon-rotation-alignment":new St(j.layout_symbol["icon-rotation-alignment"]),"icon-size":new _t(j.layout_symbol["icon-size"]),"icon-text-fit":new St(j.layout_symbol["icon-text-fit"]),"icon-text-fit-padding":new St(j.layout_symbol["icon-text-fit-padding"]),"icon-image":new _t(j.layout_symbol["icon-image"]),"icon-rotate":new _t(j.layout_symbol["icon-rotate"]),"icon-padding":new St(j.layout_symbol["icon-padding"]),"icon-keep-upright":new St(j.layout_symbol["icon-keep-upright"]),"icon-offset":new _t(j.layout_symbol["icon-offset"]),"icon-anchor":new _t(j.layout_symbol["icon-anchor"]),"icon-pitch-alignment":new St(j.layout_symbol["icon-pitch-alignment"]),"text-pitch-alignment":new St(j.layout_symbol["text-pitch-alignment"]),"text-rotation-alignment":new St(j.layout_symbol["text-rotation-alignment"]),"text-field":new _t(j.layout_symbol["text-field"]),"text-font":new _t(j.layout_symbol["text-font"]),"text-size":new _t(j.layout_symbol["text-size"]),"text-max-width":new _t(j.layout_symbol["text-max-width"]),"text-line-height":new St(j.layout_symbol["text-line-height"]),"text-letter-spacing":new _t(j.layout_symbol["text-letter-spacing"]),"text-justify":new _t(j.layout_symbol["text-justify"]),"text-radial-offset":new _t(j.layout_symbol["text-radial-offset"]),"text-variable-anchor":new St(j.layout_symbol["text-variable-anchor"]),"text-anchor":new _t(j.layout_symbol["text-anchor"]),"text-max-angle":new St(j.layout_symbol["text-max-angle"]),"text-writing-mode":new St(j.layout_symbol["text-writing-mode"]),"text-rotate":new _t(j.layout_symbol["text-rotate"]),"text-padding":new St(j.layout_symbol["text-padding"]),"text-keep-upright":new St(j.layout_symbol["text-keep-upright"]),"text-transform":new _t(j.layout_symbol["text-transform"]),"text-offset":new _t(j.layout_symbol["text-offset"]),"text-allow-overlap":new St(j.layout_symbol["text-allow-overlap"]),"text-ignore-placement":new St(j.layout_symbol["text-ignore-placement"]),"text-optional":new St(j.layout_symbol["text-optional"])}),op={paint:new rn({"icon-opacity":new _t(j.paint_symbol["icon-opacity"]),"icon-color":new _t(j.paint_symbol["icon-color"]),"icon-halo-color":new _t(j.paint_symbol["icon-halo-color"]),"icon-halo-width":new _t(j.paint_symbol["icon-halo-width"]),"icon-halo-blur":new _t(j.paint_symbol["icon-halo-blur"]),"icon-translate":new St(j.paint_symbol["icon-translate"]),"icon-translate-anchor":new St(j.paint_symbol["icon-translate-anchor"]),"text-opacity":new _t(j.paint_symbol["text-opacity"]),"text-color":new _t(j.paint_symbol["text-color"],{runtimeType:Qe,getOverride:function(e){return e.textColor},hasOverride:function(e){return!!e.textColor}}),"text-halo-color":new _t(j.paint_symbol["text-halo-color"]),"text-halo-width":new _t(j.paint_symbol["text-halo-width"]),"text-halo-blur":new _t(j.paint_symbol["text-halo-blur"]),"text-translate":new St(j.paint_symbol["text-translate"]),"text-translate-anchor":new St(j.paint_symbol["text-translate-anchor"])}),layout:Fg},yl=function(e){this.type=e.property.overrides?e.property.overrides.runtimeType:tt,this.defaultValue=e};yl.prototype.evaluate=function(e){if(e.formattedSection){var t=this.defaultValue.property.overrides;if(t&&t.hasOverride(e.formattedSection))return t.getOverride(e.formattedSection)}return e.feature&&e.featureState?this.defaultValue.evaluate(e.feature,e.featureState):this.defaultValue.property.specification.default},yl.prototype.eachChild=function(e){this.defaultValue.isConstant()||e(this.defaultValue.value._styleExpression.expression)},yl.prototype.outputDefined=function(){return!1},yl.prototype.serialize=function(){return null},pt("FormatSectionOverride",yl,{omit:["defaultValue"]});var Og=function(e){function t(i){e.call(this,i,op)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.recalculate=function(i,u){if(e.prototype.recalculate.call(this,i,u),this.layout.get("icon-rotation-alignment")==="auto"&&(this.layout._values["icon-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-rotation-alignment")==="auto"&&(this.layout._values["text-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-pitch-alignment")==="auto"&&(this.layout._values["text-pitch-alignment"]=this.layout.get("text-rotation-alignment")),this.layout.get("icon-pitch-alignment")==="auto"&&(this.layout._values["icon-pitch-alignment"]=this.layout.get("icon-rotation-alignment")),this.layout.get("symbol-placement")==="point"){var f=this.layout.get("text-writing-mode");if(f){for(var m=[],x=0,E=f;x<E.length;x+=1){var z=E[x];m.indexOf(z)<0&&m.push(z)}this.layout._values["text-writing-mode"]=m}else this.layout._values["text-writing-mode"]=["horizontal"]}this._setPaintOverrides()},t.prototype.getValueAndResolveTokens=function(i,u,f,m){var x=this.layout.get(i).evaluate(u,{},f,m),E=this._unevaluatedLayout._values[i];return E.isDataDriven()||cs(E.value)||!x?x:function(z,A){return A.replace(/{([^{}]+)}/g,function(D,B){return B in z?String(z[B]):""})}(u.properties,x)},t.prototype.createBucket=function(i){return new Cr(i)},t.prototype.queryRadius=function(){return 0},t.prototype.queryIntersectsFeature=function(){return!1},t.prototype._setPaintOverrides=function(){for(var i=0,u=op.paint.overridableProperties;i<u.length;i+=1){var f=u[i];if(t.hasPaintOverride(this.layout,f)){var m,x=this.paint.get(f),E=new yl(x),z=new No(E,x.property.specification);m=x.value.kind==="constant"||x.value.kind==="source"?new hs("source",z):new Uo("composite",z,x.value.zoomStops,x.value._interpolationType),this.paint._values[f]=new _n(x.property,m,x.parameters)}}},t.prototype._handleOverridablePaintPropertyUpdate=function(i,u,f){return!(!this.layout||u.isDataDriven()||f.isDataDriven())&&t.hasPaintOverride(this.layout,i)},t.hasPaintOverride=function(i,u){var f=i.get("text-field"),m=op.paint.properties[u],x=!1,E=function(D){for(var B=0,q=D;B<q.length;B+=1)if(m.overrides&&m.overrides.hasOverride(q[B]))return void(x=!0)};if(f.value.kind==="constant"&&f.value.value instanceof ai)E(f.value.value.sections);else if(f.value.kind==="source"){var z=function(D){x||(D instanceof ki&&qr(D.value)===jt?E(D.value.sections):D instanceof Nn?E(D.sections):D.eachChild(z))},A=f.value;A._styleExpression&&z(A._styleExpression.expression)}return x},t}(Ta),Ng={paint:new rn({"background-color":new St(j.paint_background["background-color"]),"background-pattern":new vn(j.paint_background["background-pattern"]),"background-opacity":new St(j.paint_background["background-opacity"])})},Ug=function(e){function t(i){e.call(this,i,Ng)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t}(Ta),Vg={paint:new rn({"raster-opacity":new St(j.paint_raster["raster-opacity"]),"raster-hue-rotate":new St(j.paint_raster["raster-hue-rotate"]),"raster-brightness-min":new St(j.paint_raster["raster-brightness-min"]),"raster-brightness-max":new St(j.paint_raster["raster-brightness-max"]),"raster-saturation":new St(j.paint_raster["raster-saturation"]),"raster-contrast":new St(j.paint_raster["raster-contrast"]),"raster-resampling":new St(j.paint_raster["raster-resampling"]),"raster-fade-duration":new St(j.paint_raster["raster-fade-duration"])})},qg=function(e){function t(i){e.call(this,i,Vg)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t}(Ta),jg=function(e){function t(i){e.call(this,i,{}),this.implementation=i}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.is3D=function(){return this.implementation.renderingMode==="3d"},t.prototype.hasOffscreenPass=function(){return this.implementation.prerender!==void 0},t.prototype.recalculate=function(){},t.prototype.updateTransitions=function(){},t.prototype.hasTransition=function(){},t.prototype.serialize=function(){},t.prototype.onAdd=function(i){this.implementation.onAdd&&this.implementation.onAdd(i,i.painter.context.gl)},t.prototype.onRemove=function(i){this.implementation.onRemove&&this.implementation.onRemove(i,i.painter.context.gl)},t}(Ta),Gg={circle:Gh,heatmap:Iy,hillshade:zy,fill:Ky,"fill-extrusion":tg,line:sg,symbol:Og,background:Ug,raster:qg},Df=R.HTMLImageElement,Lf=R.HTMLCanvasElement,Rf=R.HTMLVideoElement,Bf=R.ImageData,qc=R.ImageBitmap,Ps=function(e,t,i,u){this.context=e,this.format=i,this.texture=e.gl.createTexture(),this.update(t,u)};Ps.prototype.update=function(e,t,i){var u=e.width,f=e.height,m=!(this.size&&this.size[0]===u&&this.size[1]===f||i),x=this.context,E=x.gl;if(this.useMipmap=!!(t&&t.useMipmap),E.bindTexture(E.TEXTURE_2D,this.texture),x.pixelStoreUnpackFlipY.set(!1),x.pixelStoreUnpack.set(1),x.pixelStoreUnpackPremultiplyAlpha.set(this.format===E.RGBA&&(!t||t.premultiply!==!1)),m)this.size=[u,f],e instanceof Df||e instanceof Lf||e instanceof Rf||e instanceof Bf||qc&&e instanceof qc?E.texImage2D(E.TEXTURE_2D,0,this.format,this.format,E.UNSIGNED_BYTE,e):E.texImage2D(E.TEXTURE_2D,0,this.format,u,f,0,this.format,E.UNSIGNED_BYTE,e.data);else{var z=i||{x:0,y:0},A=z.x,D=z.y;e instanceof Df||e instanceof Lf||e instanceof Rf||e instanceof Bf||qc&&e instanceof qc?E.texSubImage2D(E.TEXTURE_2D,0,A,D,E.RGBA,E.UNSIGNED_BYTE,e):E.texSubImage2D(E.TEXTURE_2D,0,A,D,u,f,E.RGBA,E.UNSIGNED_BYTE,e.data)}this.useMipmap&&this.isSizePowerOfTwo()&&E.generateMipmap(E.TEXTURE_2D)},Ps.prototype.bind=function(e,t,i){var u=this.context.gl;u.bindTexture(u.TEXTURE_2D,this.texture),i!==u.LINEAR_MIPMAP_NEAREST||this.isSizePowerOfTwo()||(i=u.LINEAR),e!==this.filter&&(u.texParameteri(u.TEXTURE_2D,u.TEXTURE_MAG_FILTER,e),u.texParameteri(u.TEXTURE_2D,u.TEXTURE_MIN_FILTER,i||e),this.filter=e),t!==this.wrap&&(u.texParameteri(u.TEXTURE_2D,u.TEXTURE_WRAP_S,t),u.texParameteri(u.TEXTURE_2D,u.TEXTURE_WRAP_T,t),this.wrap=t)},Ps.prototype.isSizePowerOfTwo=function(){return this.size[0]===this.size[1]&&Math.log(this.size[0])/Math.LN2%1==0},Ps.prototype.destroy=function(){this.context.gl.deleteTexture(this.texture),this.texture=null};var sp=function(e){var t=this;this._callback=e,this._triggered=!1,typeof MessageChannel<"u"&&(this._channel=new MessageChannel,this._channel.port2.onmessage=function(){t._triggered=!1,t._callback()})};sp.prototype.trigger=function(){var e=this;this._triggered||(this._triggered=!0,this._channel?this._channel.port1.postMessage(!0):setTimeout(function(){e._triggered=!1,e._callback()},0))},sp.prototype.remove=function(){delete this._channel,this._callback=function(){}};var gl=function(e,t,i){this.target=e,this.parent=t,this.mapId=i,this.callbacks={},this.tasks={},this.taskQueue=[],this.cancelCallbacks={},zt(["receive","process"],this),this.invoker=new sp(this.process),this.target.addEventListener("message",this.receive,!1),this.globalScope=et()?e:R};function Ff(e,t,i){var u=2*Math.PI*6378137/256/Math.pow(2,i);return[e*u-2*Math.PI*6378137/2,t*u-2*Math.PI*6378137/2]}gl.prototype.send=function(e,t,i,u,f){var m=this;f===void 0&&(f=!1);var x=Math.round(1e18*Math.random()).toString(36).substring(0,10);i&&(this.callbacks[x]=i);var E=Mt(this.globalScope)?void 0:[];return this.target.postMessage({id:x,type:e,hasCallback:!!i,targetMapId:u,mustQueue:f,sourceMapId:this.mapId,data:da(t,E)},E),{cancel:function(){i&&delete m.callbacks[x],m.target.postMessage({id:x,type:"<cancel>",targetMapId:u,sourceMapId:m.mapId})}}},gl.prototype.receive=function(e){var t=e.data,i=t.id;if(i&&(!t.targetMapId||this.mapId===t.targetMapId))if(t.type==="<cancel>"){delete this.tasks[i];var u=this.cancelCallbacks[i];delete this.cancelCallbacks[i],u&&u()}else et()||t.mustQueue?(this.tasks[i]=t,this.taskQueue.push(i),this.invoker.trigger()):this.processTask(i,t)},gl.prototype.process=function(){if(this.taskQueue.length){var e=this.taskQueue.shift(),t=this.tasks[e];delete this.tasks[e],this.taskQueue.length&&this.invoker.trigger(),t&&this.processTask(e,t)}},gl.prototype.processTask=function(e,t){var i=this;if(t.type==="<response>"){var u=this.callbacks[e];delete this.callbacks[e],u&&(t.error?u(jn(t.error)):u(null,jn(t.data)))}else{var f=!1,m=Mt(this.globalScope)?void 0:[],x=t.hasCallback?function(D,B){f=!0,delete i.cancelCallbacks[e],i.target.postMessage({id:e,type:"<response>",sourceMapId:i.mapId,error:D?da(D):null,data:da(B,m)},m)}:function(D){f=!0},E=null,z=jn(t.data);if(this.parent[t.type])E=this.parent[t.type](t.sourceMapId,z,x);else if(this.parent.getWorkerSource){var A=t.type.split(".");E=this.parent.getWorkerSource(t.sourceMapId,A[0],z.source)[A[1]](z,x)}else x(new Error("Could not find function "+t.type));!f&&E&&E.cancel&&(this.cancelCallbacks[e]=E.cancel)}},gl.prototype.remove=function(){this.invoker.remove(),this.target.removeEventListener("message",this.receive,!1)};var Ai=function(e,t){e&&(t?this.setSouthWest(e).setNorthEast(t):e.length===4?this.setSouthWest([e[0],e[1]]).setNorthEast([e[2],e[3]]):this.setSouthWest(e[0]).setNorthEast(e[1]))};Ai.prototype.setNorthEast=function(e){return this._ne=e instanceof Xr?new Xr(e.lng,e.lat):Xr.convert(e),this},Ai.prototype.setSouthWest=function(e){return this._sw=e instanceof Xr?new Xr(e.lng,e.lat):Xr.convert(e),this},Ai.prototype.extend=function(e){var t,i,u=this._sw,f=this._ne;if(e instanceof Xr)t=e,i=e;else{if(!(e instanceof Ai))return Array.isArray(e)?e.length===4||e.every(Array.isArray)?this.extend(Ai.convert(e)):this.extend(Xr.convert(e)):this;if(i=e._ne,!(t=e._sw)||!i)return this}return u||f?(u.lng=Math.min(t.lng,u.lng),u.lat=Math.min(t.lat,u.lat),f.lng=Math.max(i.lng,f.lng),f.lat=Math.max(i.lat,f.lat)):(this._sw=new Xr(t.lng,t.lat),this._ne=new Xr(i.lng,i.lat)),this},Ai.prototype.getCenter=function(){return new Xr((this._sw.lng+this._ne.lng)/2,(this._sw.lat+this._ne.lat)/2)},Ai.prototype.getSouthWest=function(){return this._sw},Ai.prototype.getNorthEast=function(){return this._ne},Ai.prototype.getNorthWest=function(){return new Xr(this.getWest(),this.getNorth())},Ai.prototype.getSouthEast=function(){return new Xr(this.getEast(),this.getSouth())},Ai.prototype.getWest=function(){return this._sw.lng},Ai.prototype.getSouth=function(){return this._sw.lat},Ai.prototype.getEast=function(){return this._ne.lng},Ai.prototype.getNorth=function(){return this._ne.lat},Ai.prototype.toArray=function(){return[this._sw.toArray(),this._ne.toArray()]},Ai.prototype.toString=function(){return"LngLatBounds("+this._sw.toString()+", "+this._ne.toString()+")"},Ai.prototype.isEmpty=function(){return!(this._sw&&this._ne)},Ai.prototype.contains=function(e){var t=Xr.convert(e),i=t.lng,u=t.lat,f=this._sw.lng<=i&&i<=this._ne.lng;return this._sw.lng>this._ne.lng&&(f=this._sw.lng>=i&&i>=this._ne.lng),this._sw.lat<=u&&u<=this._ne.lat&&f},Ai.convert=function(e){return!e||e instanceof Ai?e:new Ai(e)};var Xr=function(e,t){if(isNaN(e)||isNaN(t))throw new Error("Invalid LngLat object: ("+e+", "+t+")");if(this.lng=+e,this.lat=+t,this.lat>90||this.lat<-90)throw new Error("Invalid LngLat latitude value: must be between -90 and 90")};Xr.prototype.wrap=function(){return new Xr(de(this.lng,-180,180),this.lat)},Xr.prototype.toArray=function(){return[this.lng,this.lat]},Xr.prototype.toString=function(){return"LngLat("+this.lng+", "+this.lat+")"},Xr.prototype.distanceTo=function(e){var t=Math.PI/180,i=this.lat*t,u=e.lat*t,f=Math.sin(i)*Math.sin(u)+Math.cos(i)*Math.cos(u)*Math.cos((e.lng-this.lng)*t);return 63710088e-1*Math.acos(Math.min(f,1))},Xr.prototype.toBounds=function(e){e===void 0&&(e=0);var t=360*e/40075017,i=t/Math.cos(Math.PI/180*this.lat);return new Ai(new Xr(this.lng-i,this.lat-t),new Xr(this.lng+i,this.lat+t))},Xr.convert=function(e){if(e instanceof Xr)return e;if(Array.isArray(e)&&(e.length===2||e.length===3))return new Xr(Number(e[0]),Number(e[1]));if(!Array.isArray(e)&&typeof e=="object"&&e!==null)return new Xr(Number("lng"in e?e.lng:e.lon),Number(e.lat));throw new Error("`LngLatLike` argument must be specified as a LngLat instance, an object {lng: <lng>, lat: <lat>}, an object {lon: <lng>, lat: <lat>}, or an array of [<lng>, <lat>]")};var Of=2*Math.PI*63710088e-1;function Nf(e){return Of*Math.cos(e*Math.PI/180)}function Uf(e){return(180+e)/360}function Vf(e){return(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+e*Math.PI/360)))/360}function qf(e,t){return e/Nf(t)}function lp(e){return 360/Math.PI*Math.atan(Math.exp((180-360*e)*Math.PI/180))-90}var zs=function(e,t,i){i===void 0&&(i=0),this.x=+e,this.y=+t,this.z=+i};zs.fromLngLat=function(e,t){t===void 0&&(t=0);var i=Xr.convert(e);return new zs(Uf(i.lng),Vf(i.lat),qf(t,i.lat))},zs.prototype.toLngLat=function(){return new Xr(360*this.x-180,lp(this.y))},zs.prototype.toAltitude=function(){return this.z*Nf(lp(this.y))},zs.prototype.meterInMercatorCoordinateUnits=function(){return 1/Of*(e=lp(this.y),1/Math.cos(e*Math.PI/180));var e};var As=function(e,t,i){this.z=e,this.x=t,this.y=i,this.key=vu(0,e,e,t,i)};As.prototype.equals=function(e){return this.z===e.z&&this.x===e.x&&this.y===e.y},As.prototype.url=function(e,t){var i,u,f,m,x,E=(u=this.y,f=this.z,m=Ff(256*(i=this.x),256*(u=Math.pow(2,f)-u-1),f),x=Ff(256*(i+1),256*(u+1),f),m[0]+","+m[1]+","+x[0]+","+x[1]),z=function(A,D,B){for(var q,G="",J=A;J>0;J--)G+=(D&(q=1<<J-1)?1:0)+(B&q?2:0);return G}(this.z,this.x,this.y);return e[(this.x+this.y)%e.length].replace("{prefix}",(this.x%16).toString(16)+(this.y%16).toString(16)).replace("{z}",String(this.z)).replace("{x}",String(this.x)).replace("{y}",String(t==="tms"?Math.pow(2,this.z)-this.y-1:this.y)).replace("{quadkey}",z).replace("{bbox-epsg-3857}",E)},As.prototype.getTilePoint=function(e){var t=Math.pow(2,this.z);return new M(8192*(e.x*t-this.x),8192*(e.y*t-this.y))},As.prototype.toString=function(){return this.z+"/"+this.x+"/"+this.y};var jf=function(e,t){this.wrap=e,this.canonical=t,this.key=vu(e,t.z,t.z,t.x,t.y)},Ci=function(e,t,i,u,f){this.overscaledZ=e,this.wrap=t,this.canonical=new As(i,+u,+f),this.key=vu(t,e,i,u,f)};function vu(e,t,i,u,f){(e*=2)<0&&(e=-1*e-1);var m=1<<i;return(m*m*e+m*f+u).toString(36)+i.toString(36)+t.toString(36)}Ci.prototype.equals=function(e){return this.overscaledZ===e.overscaledZ&&this.wrap===e.wrap&&this.canonical.equals(e.canonical)},Ci.prototype.scaledTo=function(e){var t=this.canonical.z-e;return e>this.canonical.z?new Ci(e,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y):new Ci(e,this.wrap,e,this.canonical.x>>t,this.canonical.y>>t)},Ci.prototype.calculateScaledKey=function(e,t){var i=this.canonical.z-e;return e>this.canonical.z?vu(this.wrap*+t,e,this.canonical.z,this.canonical.x,this.canonical.y):vu(this.wrap*+t,e,e,this.canonical.x>>i,this.canonical.y>>i)},Ci.prototype.isChildOf=function(e){if(e.wrap!==this.wrap)return!1;var t=this.canonical.z-e.canonical.z;return e.overscaledZ===0||e.overscaledZ<this.overscaledZ&&e.canonical.x===this.canonical.x>>t&&e.canonical.y===this.canonical.y>>t},Ci.prototype.children=function(e){if(this.overscaledZ>=e)return[new Ci(this.overscaledZ+1,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)];var t=this.canonical.z+1,i=2*this.canonical.x,u=2*this.canonical.y;return[new Ci(t,this.wrap,t,i,u),new Ci(t,this.wrap,t,i+1,u),new Ci(t,this.wrap,t,i,u+1),new Ci(t,this.wrap,t,i+1,u+1)]},Ci.prototype.isLessThan=function(e){return this.wrap<e.wrap||!(this.wrap>e.wrap)&&(this.overscaledZ<e.overscaledZ||!(this.overscaledZ>e.overscaledZ)&&(this.canonical.x<e.canonical.x||!(this.canonical.x>e.canonical.x)&&this.canonical.y<e.canonical.y))},Ci.prototype.wrapped=function(){return new Ci(this.overscaledZ,0,this.canonical.z,this.canonical.x,this.canonical.y)},Ci.prototype.unwrapTo=function(e){return new Ci(this.overscaledZ,e,this.canonical.z,this.canonical.x,this.canonical.y)},Ci.prototype.overscaleFactor=function(){return Math.pow(2,this.overscaledZ-this.canonical.z)},Ci.prototype.toUnwrapped=function(){return new jf(this.wrap,this.canonical)},Ci.prototype.toString=function(){return this.overscaledZ+"/"+this.canonical.x+"/"+this.canonical.y},Ci.prototype.getTilePoint=function(e){return this.canonical.getTilePoint(new zs(e.x-this.wrap,e.y))},pt("CanonicalTileID",As),pt("OverscaledTileID",Ci,{omit:["posMatrix"]});var Ao=function(e,t,i){if(this.uid=e,t.height!==t.width)throw new RangeError("DEM tiles must be square");if(i&&i!=="mapbox"&&i!=="terrarium")return qe('"'+i+'" is not a valid encoding type. Valid types include "mapbox" and "terrarium".');this.stride=t.height;var u=this.dim=t.height-2;this.data=new Uint32Array(t.data.buffer),this.encoding=i||"mapbox";for(var f=0;f<u;f++)this.data[this._idx(-1,f)]=this.data[this._idx(0,f)],this.data[this._idx(u,f)]=this.data[this._idx(u-1,f)],this.data[this._idx(f,-1)]=this.data[this._idx(f,0)],this.data[this._idx(f,u)]=this.data[this._idx(f,u-1)];this.data[this._idx(-1,-1)]=this.data[this._idx(0,0)],this.data[this._idx(u,-1)]=this.data[this._idx(u-1,0)],this.data[this._idx(-1,u)]=this.data[this._idx(0,u-1)],this.data[this._idx(u,u)]=this.data[this._idx(u-1,u-1)]};Ao.prototype.get=function(e,t){var i=new Uint8Array(this.data.buffer),u=4*this._idx(e,t);return(this.encoding==="terrarium"?this._unpackTerrarium:this._unpackMapbox)(i[u],i[u+1],i[u+2])},Ao.prototype.getUnpackVector=function(){return this.encoding==="terrarium"?[256,1,1/256,32768]:[6553.6,25.6,.1,1e4]},Ao.prototype._idx=function(e,t){if(e<-1||e>=this.dim+1||t<-1||t>=this.dim+1)throw new RangeError("out of range source coordinates for DEM data");return(t+1)*this.stride+(e+1)},Ao.prototype._unpackMapbox=function(e,t,i){return(256*e*256+256*t+i)/10-1e4},Ao.prototype._unpackTerrarium=function(e,t,i){return 256*e+t+i/256-32768},Ao.prototype.getPixels=function(){return new Xn({width:this.stride,height:this.stride},new Uint8Array(this.data.buffer))},Ao.prototype.backfillBorder=function(e,t,i){if(this.dim!==e.dim)throw new Error("dem dimension mismatch");var u=t*this.dim,f=t*this.dim+this.dim,m=i*this.dim,x=i*this.dim+this.dim;switch(t){case-1:u=f-1;break;case 1:f=u+1}switch(i){case-1:m=x-1;break;case 1:x=m+1}for(var E=-t*this.dim,z=-i*this.dim,A=m;A<x;A++)for(var D=u;D<f;D++)this.data[this._idx(D,A)]=e.data[this._idx(D+E,A+z)]},pt("DEMData",Ao);var jc=function(e){this._stringToNumber={},this._numberToString=[];for(var t=0;t<e.length;t++){var i=e[t];this._stringToNumber[i]=t,this._numberToString[t]=i}};jc.prototype.encode=function(e){return this._stringToNumber[e]},jc.prototype.decode=function(e){return this._numberToString[e]};var Gc=function(e,t,i,u,f){this.type="Feature",this._vectorTileFeature=e,e._z=t,e._x=i,e._y=u,this.properties=e.properties,this.id=f},up={geometry:{configurable:!0}};up.geometry.get=function(){return this._geometry===void 0&&(this._geometry=this._vectorTileFeature.toGeoJSON(this._vectorTileFeature._x,this._vectorTileFeature._y,this._vectorTileFeature._z).geometry),this._geometry},up.geometry.set=function(e){this._geometry=e},Gc.prototype.toJSON=function(){var e={geometry:this.geometry};for(var t in this)t!=="_geometry"&&t!=="_vectorTileFeature"&&(e[t]=this[t]);return e},Object.defineProperties(Gc.prototype,up);var _l=function(){this.state={},this.stateChanges={},this.deletedStates={}};_l.prototype.updateState=function(e,t,i){var u=String(t);if(this.stateChanges[e]=this.stateChanges[e]||{},this.stateChanges[e][u]=this.stateChanges[e][u]||{},ge(this.stateChanges[e][u],i),this.deletedStates[e]===null)for(var f in this.deletedStates[e]={},this.state[e])f!==u&&(this.deletedStates[e][f]=null);else if(this.deletedStates[e]&&this.deletedStates[e][u]===null)for(var m in this.deletedStates[e][u]={},this.state[e][u])i[m]||(this.deletedStates[e][u][m]=null);else for(var x in i)this.deletedStates[e]&&this.deletedStates[e][u]&&this.deletedStates[e][u][x]===null&&delete this.deletedStates[e][u][x]},_l.prototype.removeFeatureState=function(e,t,i){if(this.deletedStates[e]!==null){var u=String(t);if(this.deletedStates[e]=this.deletedStates[e]||{},i&&t!==void 0)this.deletedStates[e][u]!==null&&(this.deletedStates[e][u]=this.deletedStates[e][u]||{},this.deletedStates[e][u][i]=null);else if(t!==void 0)if(this.stateChanges[e]&&this.stateChanges[e][u])for(i in this.deletedStates[e][u]={},this.stateChanges[e][u])this.deletedStates[e][u][i]=null;else this.deletedStates[e][u]=null;else this.deletedStates[e]=null}},_l.prototype.getState=function(e,t){var i=String(t),u=ge({},(this.state[e]||{})[i],(this.stateChanges[e]||{})[i]);if(this.deletedStates[e]===null)return{};if(this.deletedStates[e]){var f=this.deletedStates[e][t];if(f===null)return{};for(var m in f)delete u[m]}return u},_l.prototype.initializeTileState=function(e,t){e.setFeatureState(this.state,t)},_l.prototype.coalesceChanges=function(e,t){var i={};for(var u in this.stateChanges){this.state[u]=this.state[u]||{};var f={};for(var m in this.stateChanges[u])this.state[u][m]||(this.state[u][m]={}),ge(this.state[u][m],this.stateChanges[u][m]),f[m]=this.state[u][m];i[u]=f}for(var x in this.deletedStates){this.state[x]=this.state[x]||{};var E={};if(this.deletedStates[x]===null)for(var z in this.state[x])E[z]={},this.state[x][z]={};else for(var A in this.deletedStates[x]){if(this.deletedStates[x][A]===null)this.state[x][A]={};else for(var D=0,B=Object.keys(this.deletedStates[x][A]);D<B.length;D+=1)delete this.state[x][A][B[D]];E[A]=this.state[x][A]}i[x]=i[x]||{},ge(i[x],E)}if(this.stateChanges={},this.deletedStates={},Object.keys(i).length!==0)for(var q in e)e[q].setFeatureState(i,t)};var Co=function(e,t){this.tileID=e,this.x=e.canonical.x,this.y=e.canonical.y,this.z=e.canonical.z,this.grid=new Ca(8192,16,0),this.grid3D=new Ca(8192,16,0),this.featureIndexArray=new O,this.promoteId=t};function Gf(e,t,i,u,f){return je(e,function(m,x){var E=t instanceof bs?t.get(x):null;return E&&E.evaluate?E.evaluate(i,u,f):E})}function Zf(e){for(var t=1/0,i=1/0,u=-1/0,f=-1/0,m=0,x=e;m<x.length;m+=1){var E=x[m];t=Math.min(t,E.x),i=Math.min(i,E.y),u=Math.max(u,E.x),f=Math.max(f,E.y)}return{minX:t,minY:i,maxX:u,maxY:f}}function Zg(e,t){return t-e}Co.prototype.insert=function(e,t,i,u,f,m){var x=this.featureIndexArray.length;this.featureIndexArray.emplaceBack(i,u,f);for(var E=m?this.grid3D:this.grid,z=0;z<t.length;z++){for(var A=t[z],D=[1/0,1/0,-1/0,-1/0],B=0;B<A.length;B++){var q=A[B];D[0]=Math.min(D[0],q.x),D[1]=Math.min(D[1],q.y),D[2]=Math.max(D[2],q.x),D[3]=Math.max(D[3],q.y)}D[0]<8192&&D[1]<8192&&D[2]>=0&&D[3]>=0&&E.insert(x,D[0],D[1],D[2],D[3])}},Co.prototype.loadVTLayers=function(){return this.vtLayers||(this.vtLayers=new ll.VectorTile(new Mc(this.rawTileData)).layers,this.sourceLayerCoder=new jc(this.vtLayers?Object.keys(this.vtLayers).sort():["_geojsonTileLayer"])),this.vtLayers},Co.prototype.query=function(e,t,i,u){var f=this;this.loadVTLayers();for(var m=e.params||{},x=8192/e.tileSize/e.scale,E=Zs(m.filter),z=e.queryGeometry,A=e.queryPadding*x,D=Zf(z),B=this.grid.query(D.minX-A,D.minY-A,D.maxX+A,D.maxY+A),q=Zf(e.cameraQueryGeometry),G=this.grid3D.query(q.minX-A,q.minY-A,q.maxX+A,q.maxY+A,function(Ee,Te,Me,Ke){return function($e,bt,lt,kt,ut){for(var Qt=0,Lt=$e;Qt<Lt.length;Qt+=1){var vt=Lt[Qt];if(bt<=vt.x&&lt<=vt.y&&kt>=vt.x&&ut>=vt.y)return!0}var tr=[new M(bt,lt),new M(bt,ut),new M(kt,ut),new M(kt,lt)];if($e.length>2){for(var Zt=0,mr=tr;Zt<mr.length;Zt+=1)if(Pa($e,mr[Zt]))return!0}for(var Pt=0;Pt<$e.length-1;Pt++)if(ks($e[Pt],$e[Pt+1],tr))return!0;return!1}(e.cameraQueryGeometry,Ee-A,Te-A,Me+A,Ke+A)}),J=0,ee=G;J<ee.length;J+=1)B.push(ee[J]);B.sort(Zg);for(var he,oe={},ye=function(Ee){var Te=B[Ee];if(Te!==he){he=Te;var Me=f.featureIndexArray.get(Te),Ke=null;f.loadMatchingFeature(oe,Me.bucketIndex,Me.sourceLayerIndex,Me.featureIndex,E,m.layers,m.availableImages,t,i,u,function($e,bt,lt){return Ke||(Ke=ri($e)),bt.queryIntersectsFeature(z,$e,lt,Ke,f.z,e.transform,x,e.pixelPosMatrix)})}},be=0;be<B.length;be++)ye(be);return oe},Co.prototype.loadMatchingFeature=function(e,t,i,u,f,m,x,E,z,A,D){var B=this.bucketLayerIDs[t];if(!m||function($e,bt){for(var lt=0;lt<$e.length;lt++)if(bt.indexOf($e[lt])>=0)return!0;return!1}(m,B)){var q=this.sourceLayerCoder.decode(i),G=this.vtLayers[q].feature(u);if(f.needGeometry){var J=fi(G,!0);if(!f.filter(new rr(this.tileID.overscaledZ),J,this.tileID.canonical))return}else if(!f.filter(new rr(this.tileID.overscaledZ),G))return;for(var ee=this.getId(G,q),he=0;he<B.length;he++){var oe=B[he];if(!(m&&m.indexOf(oe)<0)){var ye=E[oe];if(ye){var be={};ee!==void 0&&A&&(be=A.getState(ye.sourceLayer||"_geojsonTileLayer",ee));var Ee=ge({},z[oe]);Ee.paint=Gf(Ee.paint,ye.paint,G,be,x),Ee.layout=Gf(Ee.layout,ye.layout,G,be,x);var Te=!D||D(G,ye,be);if(Te){var Me=new Gc(G,this.z,this.x,this.y,ee);Me.layer=Ee;var Ke=e[oe];Ke===void 0&&(Ke=e[oe]=[]),Ke.push({featureIndex:u,feature:Me,intersectionZ:Te})}}}}}},Co.prototype.lookupSymbolFeatures=function(e,t,i,u,f,m,x,E){var z={};this.loadVTLayers();for(var A=Zs(f),D=0,B=e;D<B.length;D+=1)this.loadMatchingFeature(z,i,u,B[D],A,m,x,E,t);return z},Co.prototype.hasLayer=function(e){for(var t=0,i=this.bucketLayerIDs;t<i.length;t+=1)for(var u=0,f=i[t];u<f.length;u+=1)if(e===f[u])return!0;return!1},Co.prototype.getId=function(e,t){var i=e.id;return this.promoteId&&typeof(i=e.properties[typeof this.promoteId=="string"?this.promoteId:this.promoteId[t]])=="boolean"&&(i=Number(i)),i},pt("FeatureIndex",Co,{omit:["rawTileData","sourceLayerCoder"]});var Hi=function(e,t){this.tileID=e,this.uid=Fe(),this.uses=0,this.tileSize=t,this.buckets={},this.expirationTime=null,this.queryPadding=0,this.hasSymbolBuckets=!1,this.hasRTLText=!1,this.dependencies={},this.expiredRequestCount=0,this.state="loading"};Hi.prototype.registerFadeDuration=function(e){var t=e+this.timeAdded;t<Sr.now()||this.fadeEndTime&&t<this.fadeEndTime||(this.fadeEndTime=t)},Hi.prototype.wasRequested=function(){return this.state==="errored"||this.state==="loaded"||this.state==="reloading"},Hi.prototype.loadVectorData=function(e,t,i){if(this.hasData()&&this.unloadVectorData(),this.state="loaded",e){for(var u in e.featureIndex&&(this.latestFeatureIndex=e.featureIndex,e.rawTileData?(this.latestRawTileData=e.rawTileData,this.latestFeatureIndex.rawTileData=e.rawTileData):this.latestRawTileData&&(this.latestFeatureIndex.rawTileData=this.latestRawTileData)),this.collisionBoxArray=e.collisionBoxArray,this.buckets=function(A,D){var B={};if(!D)return B;for(var q=function(){var ee=J[G],he=ee.layerIds.map(function(be){return D.getLayer(be)}).filter(Boolean);if(he.length!==0){ee.layers=he,ee.stateDependentLayerIds&&(ee.stateDependentLayers=ee.stateDependentLayerIds.map(function(be){return he.filter(function(Ee){return Ee.id===be})[0]}));for(var oe=0,ye=he;oe<ye.length;oe+=1)B[ye[oe].id]=ee}},G=0,J=A;G<J.length;G+=1)q();return B}(e.buckets,t.style),this.hasSymbolBuckets=!1,this.buckets){var f=this.buckets[u];if(f instanceof Cr){if(this.hasSymbolBuckets=!0,!i)break;f.justReloaded=!0}}if(this.hasRTLText=!1,this.hasSymbolBuckets)for(var m in this.buckets){var x=this.buckets[m];if(x instanceof Cr&&x.hasRTLText){this.hasRTLText=!0,ea.isLoading()||ea.isLoaded()||ru()!=="deferred"||ma();break}}for(var E in this.queryPadding=0,this.buckets){var z=this.buckets[E];this.queryPadding=Math.max(this.queryPadding,t.style.getLayer(E).queryRadius(z))}e.imageAtlas&&(this.imageAtlas=e.imageAtlas),e.glyphAtlasImage&&(this.glyphAtlasImage=e.glyphAtlasImage)}else this.collisionBoxArray=new s},Hi.prototype.unloadVectorData=function(){for(var e in this.buckets)this.buckets[e].destroy();this.buckets={},this.imageAtlasTexture&&this.imageAtlasTexture.destroy(),this.imageAtlas&&(this.imageAtlas=null),this.glyphAtlasTexture&&this.glyphAtlasTexture.destroy(),this.latestFeatureIndex=null,this.state="unloaded"},Hi.prototype.getBucket=function(e){return this.buckets[e.id]},Hi.prototype.upload=function(e){for(var t in this.buckets){var i=this.buckets[t];i.uploadPending()&&i.upload(e)}var u=e.gl;this.imageAtlas&&!this.imageAtlas.uploaded&&(this.imageAtlasTexture=new Ps(e,this.imageAtlas.image,u.RGBA),this.imageAtlas.uploaded=!0),this.glyphAtlasImage&&(this.glyphAtlasTexture=new Ps(e,this.glyphAtlasImage,u.ALPHA),this.glyphAtlasImage=null)},Hi.prototype.prepare=function(e){this.imageAtlas&&this.imageAtlas.patchUpdatedImages(e,this.imageAtlasTexture)},Hi.prototype.queryRenderedFeatures=function(e,t,i,u,f,m,x,E,z,A){return this.latestFeatureIndex&&this.latestFeatureIndex.rawTileData?this.latestFeatureIndex.query({queryGeometry:u,cameraQueryGeometry:f,scale:m,tileSize:this.tileSize,pixelPosMatrix:A,transform:E,params:x,queryPadding:this.queryPadding*z},e,t,i):{}},Hi.prototype.querySourceFeatures=function(e,t){var i=this.latestFeatureIndex;if(i&&i.rawTileData){var u=i.loadVTLayers(),f=t?t.sourceLayer:"",m=u._geojsonTileLayer||u[f];if(m)for(var x=Zs(t&&t.filter),E=this.tileID.canonical,z=E.z,A=E.x,D=E.y,B={z,x:A,y:D},q=0;q<m.length;q++){var G=m.feature(q);if(x.needGeometry){var J=fi(G,!0);if(!x.filter(new rr(this.tileID.overscaledZ),J,this.tileID.canonical))continue}else if(!x.filter(new rr(this.tileID.overscaledZ),G))continue;var ee=i.getId(G,f),he=new Gc(G,z,A,D,ee);he.tile=B,e.push(he)}}},Hi.prototype.hasData=function(){return this.state==="loaded"||this.state==="reloading"||this.state==="expired"},Hi.prototype.patternsLoaded=function(){return this.imageAtlas&&!!Object.keys(this.imageAtlas.patternPositions).length},Hi.prototype.setExpiryData=function(e){var t=this.expirationTime;if(e.cacheControl){var i=dt(e.cacheControl);i["max-age"]&&(this.expirationTime=Date.now()+1e3*i["max-age"])}else e.expires&&(this.expirationTime=new Date(e.expires).getTime());if(this.expirationTime){var u=Date.now(),f=!1;if(this.expirationTime>u)f=!1;else if(t)if(this.expirationTime<t)f=!0;else{var m=this.expirationTime-t;m?this.expirationTime=u+Math.max(m,3e4):f=!0}else f=!0;f?(this.expiredRequestCount++,this.state="expired"):this.expiredRequestCount=0}},Hi.prototype.getExpiryTimeout=function(){if(this.expirationTime)return this.expiredRequestCount?1e3*(1<<Math.min(this.expiredRequestCount-1,31)):Math.min(this.expirationTime-new Date().getTime(),Math.pow(2,31)-1)},Hi.prototype.setFeatureState=function(e,t){if(this.latestFeatureIndex&&this.latestFeatureIndex.rawTileData&&Object.keys(e).length!==0){var i=this.latestFeatureIndex.loadVTLayers();for(var u in this.buckets)if(t.style.hasLayer(u)){var f=this.buckets[u],m=f.layers[0].sourceLayer||"_geojsonTileLayer",x=i[m],E=e[m];if(x&&E&&Object.keys(E).length!==0){f.update(E,x,this.imageAtlas&&this.imageAtlas.patternPositions||{});var z=t&&t.style&&t.style.getLayer(u);z&&(this.queryPadding=Math.max(this.queryPadding,z.queryRadius(f)))}}}},Hi.prototype.holdingForFade=function(){return this.symbolFadeHoldUntil!==void 0},Hi.prototype.symbolFadeFinished=function(){return!this.symbolFadeHoldUntil||this.symbolFadeHoldUntil<Sr.now()},Hi.prototype.clearFadeHold=function(){this.symbolFadeHoldUntil=void 0},Hi.prototype.setHoldDuration=function(e){this.symbolFadeHoldUntil=Sr.now()+e},Hi.prototype.setDependencies=function(e,t){for(var i={},u=0,f=t;u<f.length;u+=1)i[f[u]]=!0;this.dependencies[e]=i},Hi.prototype.hasDependency=function(e,t){for(var i=0,u=e;i<u.length;i+=1){var f=this.dependencies[u[i]];if(f){for(var m=0,x=t;m<x.length;m+=1)if(f[x[m]])return!0}}return!1};var Jo=R.performance,Kf=function(e){this._marks={start:[e.url,"start"].join("#"),end:[e.url,"end"].join("#"),measure:e.url.toString()},Jo.mark(this._marks.start)};Kf.prototype.finish=function(){Jo.mark(this._marks.end);var e=Jo.getEntriesByName(this._marks.measure);return e.length===0&&(Jo.measure(this._marks.measure,this._marks.start,this._marks.end),e=Jo.getEntriesByName(this._marks.measure),Jo.clearMarks(this._marks.start),Jo.clearMarks(this._marks.end),Jo.clearMeasures(this._marks.measure)),e},a.Actor=gl,a.AlphaImage=Is,a.CanonicalTileID=As,a.CollisionBoxArray=s,a.Color=lr,a.DEMData=Ao,a.DataConstantProperty=St,a.DictionaryCoder=jc,a.EXTENT=8192,a.ErrorEvent=ue,a.EvaluationParameters=rr,a.Event=W,a.Evented=pe,a.FeatureIndex=Co,a.FillBucket=Ra,a.FillExtrusionBucket=Ba,a.ImageAtlas=gu,a.ImagePosition=Lc,a.LineBucket=Mn,a.LngLat=Xr,a.LngLatBounds=Ai,a.MercatorCoordinate=zs,a.ONE_EM=24,a.OverscaledTileID=Ci,a.Point=M,a.Point$1=M,a.Properties=rn,a.Protobuf=Mc,a.RGBAImage=Xn,a.RequestManager=ci,a.RequestPerformance=Kf,a.ResourceType=Qr,a.SegmentVector=K,a.SourceFeatureState=_l,a.StructArrayLayout1ui2=lu,a.StructArrayLayout2f1f2i16=To,a.StructArrayLayout2i4=ko,a.StructArrayLayout3ui6=Wa,a.StructArrayLayout4i8=nu,a.SymbolBucket=Cr,a.Texture=Ps,a.Tile=Hi,a.Transitionable=tn,a.Uniform1f=Je,a.Uniform1i=Ne,a.Uniform2f=Xe,a.Uniform3f=ct,a.Uniform4f=Et,a.UniformColor=Ct,a.UniformMatrix4f=yr,a.UnwrappedTileID=jf,a.ValidationError=$,a.WritingMode=la,a.ZoomHistory=Ql,a.add=function(e,t,i){return e[0]=t[0]+i[0],e[1]=t[1]+i[1],e[2]=t[2]+i[2],e},a.addDynamicAttributes=ap,a.asyncAll=function(e,t,i){if(!e.length)return i(null,[]);var u=e.length,f=new Array(e.length),m=null;e.forEach(function(x,E){t(x,function(z,A){z&&(m=z),f[E]=A,--u==0&&i(m,f)})})},a.bezier=Q,a.bindAll=zt,a.browser=Sr,a.cacheEntryPossiblyAdded=function(e){++Ui>$i&&(e.getActor().send("enforceCacheSizeLimit",Pn),Ui=0)},a.clamp=le,a.clearTileCache=function(e){var t=R.caches.delete("mapbox-tiles");e&&t.catch(e).then(function(){return e()})},a.clipLine=If,a.clone=function(e){var t=new Er(16);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t},a.clone$1=mt,a.clone$2=function(e){var t=new Er(3);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t},a.collisionCircleLayout=hg,a.config=Gt,a.create=function(){var e=new Er(16);return Er!=Float32Array&&(e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[11]=0,e[12]=0,e[13]=0,e[14]=0),e[0]=1,e[5]=1,e[10]=1,e[15]=1,e},a.create$1=function(){var e=new Er(9);return Er!=Float32Array&&(e[1]=0,e[2]=0,e[3]=0,e[5]=0,e[6]=0,e[7]=0),e[0]=1,e[4]=1,e[8]=1,e},a.create$2=function(){var e=new Er(4);return Er!=Float32Array&&(e[1]=0,e[2]=0),e[0]=1,e[3]=1,e},a.createCommonjsModule=k,a.createExpression=js,a.createLayout=Zi,a.createStyleLayer=function(e){return e.type==="custom"?new jg(e):new Gg[e.type](e)},a.cross=function(e,t,i){var u=t[0],f=t[1],m=t[2],x=i[0],E=i[1],z=i[2];return e[0]=f*z-m*E,e[1]=m*x-u*z,e[2]=u*E-f*x,e},a.deepEqual=function e(t,i){if(Array.isArray(t)){if(!Array.isArray(i)||t.length!==i.length)return!1;for(var u=0;u<t.length;u++)if(!e(t[u],i[u]))return!1;return!0}if(typeof t=="object"&&t!==null&&i!==null){if(typeof i!="object"||Object.keys(t).length!==Object.keys(i).length)return!1;for(var f in t)if(!e(t[f],i[f]))return!1;return!0}return t===i},a.dot=function(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]},a.dot$1=function(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]+e[3]*t[3]},a.ease=ae,a.emitValidationErrors=gs,a.endsWith=wt,a.enforceCacheSizeLimit=function(e){zn(),Vr&&Vr.then(function(t){t.keys().then(function(i){for(var u=0;u<i.length-e;u++)t.delete(i[u])})})},a.evaluateSizeForFeature=xf,a.evaluateSizeForZoom=wf,a.evaluateVariableOffset=Af,a.evented=tu,a.extend=ge,a.featureFilter=Zs,a.filterObject=Ze,a.fromRotation=function(e,t){var i=Math.sin(t),u=Math.cos(t);return e[0]=u,e[1]=i,e[2]=0,e[3]=-i,e[4]=u,e[5]=0,e[6]=0,e[7]=0,e[8]=1,e},a.getAnchorAlignment=tp,a.getAnchorJustification=np,a.getArrayBuffer=Br,a.getImage=U,a.getJSON=function(e,t){return On(ge(e,{type:"json"}),t)},a.getRTLTextPluginStatus=ru,a.getReferrer=ln,a.getVideo=function(e,t){var i,u,f=R.document.createElement("video");f.muted=!0,f.onloadstart=function(){t(null,f)};for(var m=0;m<e.length;m++){var x=R.document.createElement("source");i=e[m],u=void 0,(u=R.document.createElement("a")).href=i,(u.protocol!==R.document.location.protocol||u.host!==R.document.location.host)&&(f.crossOrigin="Anonymous"),x.src=e[m],f.appendChild(x)}return{cancel:function(){}}},a.identity=ta,a.invert=function(e,t){var i=t[0],u=t[1],f=t[2],m=t[3],x=t[4],E=t[5],z=t[6],A=t[7],D=t[8],B=t[9],q=t[10],G=t[11],J=t[12],ee=t[13],he=t[14],oe=t[15],ye=i*E-u*x,be=i*z-f*x,Ee=i*A-m*x,Te=u*z-f*E,Me=u*A-m*E,Ke=f*A-m*z,$e=D*ee-B*J,bt=D*he-q*J,lt=D*oe-G*J,kt=B*he-q*ee,ut=B*oe-G*ee,Qt=q*oe-G*he,Lt=ye*Qt-be*ut+Ee*kt+Te*lt-Me*bt+Ke*$e;return Lt?(e[0]=(E*Qt-z*ut+A*kt)*(Lt=1/Lt),e[1]=(f*ut-u*Qt-m*kt)*Lt,e[2]=(ee*Ke-he*Me+oe*Te)*Lt,e[3]=(q*Me-B*Ke-G*Te)*Lt,e[4]=(z*lt-x*Qt-A*bt)*Lt,e[5]=(i*Qt-f*lt+m*bt)*Lt,e[6]=(he*Ee-J*Ke-oe*be)*Lt,e[7]=(D*Ke-q*Ee+G*be)*Lt,e[8]=(x*ut-E*lt+A*$e)*Lt,e[9]=(u*lt-i*ut-m*$e)*Lt,e[10]=(J*Me-ee*Ee+oe*ye)*Lt,e[11]=(B*Ee-D*Me-G*ye)*Lt,e[12]=(E*bt-x*kt-z*$e)*Lt,e[13]=(i*kt-u*bt+f*$e)*Lt,e[14]=(ee*be-J*Te-he*ye)*Lt,e[15]=(D*Te-B*be+q*ye)*Lt,e):null},a.isChar=nt,a.isMapboxURL=Jr,a.keysDifference=function(e,t){var i=[];for(var u in e)u in t||i.push(u);return i},a.makeRequest=On,a.mapObject=je,a.mercatorXfromLng=Uf,a.mercatorYfromLat=Vf,a.mercatorZfromAltitude=qf,a.mul=jh,a.multiply=Cn,a.mvt=ll,a.nextPowerOfTwo=function(e){return e<=1?1:Math.pow(2,Math.ceil(Math.log(e)/Math.LN2))},a.normalize=function(e,t){var i=t[0],u=t[1],f=t[2],m=i*i+u*u+f*f;return m>0&&(m=1/Math.sqrt(m)),e[0]=t[0]*m,e[1]=t[1]*m,e[2]=t[2]*m,e},a.number=vi,a.offscreenCanvasSupported=Vi,a.ortho=function(e,t,i,u,f,m,x){var E=1/(t-i),z=1/(u-f),A=1/(m-x);return e[0]=-2*E,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=-2*z,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=2*A,e[11]=0,e[12]=(t+i)*E,e[13]=(f+u)*z,e[14]=(x+m)*A,e[15]=1,e},a.parseGlyphPBF=function(e){return new Mc(e).readFields(wg,[])},a.pbf=Mc,a.performSymbolLayout=function(e,t,i,u,f,m,x){e.createArrays(),e.tilePixelRatio=8192/(512*e.overscaling),e.compareText={},e.iconsNeedLinear=!1;var E=e.layers[0].layout,z=e.layers[0]._unevaluatedLayout._values,A={};if(e.textSizeData.kind==="composite"){var D=e.textSizeData,B=D.maxZoom;A.compositeTextSizes=[z["text-size"].possiblyEvaluate(new rr(D.minZoom),x),z["text-size"].possiblyEvaluate(new rr(B),x)]}if(e.iconSizeData.kind==="composite"){var q=e.iconSizeData,G=q.maxZoom;A.compositeIconSizes=[z["icon-size"].possiblyEvaluate(new rr(q.minZoom),x),z["icon-size"].possiblyEvaluate(new rr(G),x)]}A.layoutTextSize=z["text-size"].possiblyEvaluate(new rr(e.zoom+1),x),A.layoutIconSize=z["icon-size"].possiblyEvaluate(new rr(e.zoom+1),x),A.textMaxSize=z["text-size"].possiblyEvaluate(new rr(18));for(var J=24*E.get("text-line-height"),ee=E.get("text-rotation-alignment")==="map"&&E.get("symbol-placement")!=="point",he=E.get("text-keep-upright"),oe=E.get("text-size"),ye=function(){var Te=Ee[be],Me=E.get("text-font").evaluate(Te,{},x).join(","),Ke=oe.evaluate(Te,{},x),$e=A.layoutTextSize.evaluate(Te,{},x),bt=A.layoutIconSize.evaluate(Te,{},x),lt={horizontal:{},vertical:void 0},kt=Te.text,ut=[0,0];if(kt){var Qt=kt.toString(),Lt=24*E.get("text-letter-spacing").evaluate(Te,{},x),vt=function(or){for(var Lr=0,zr=or;Lr<zr.length;Lr+=1)if(gr=zr[Lr].charCodeAt(0),nt.Arabic(gr)||nt["Arabic Supplement"](gr)||nt["Arabic Extended-A"](gr)||nt["Arabic Presentation Forms-A"](gr)||nt["Arabic Presentation Forms-B"](gr))return!1;var gr;return!0}(Qt)?Lt:0,tr=E.get("text-anchor").evaluate(Te,{},x),Zt=E.get("text-variable-anchor");if(!Zt){var mr=E.get("text-radial-offset").evaluate(Te,{},x);ut=mr?Af(tr,[24*mr,ip]):E.get("text-offset").evaluate(Te,{},x).map(function(or){return 24*or})}var Pt=ee?"center":E.get("text-justify").evaluate(Te,{},x),br=E.get("symbol-placement"),Wr=br==="point"?24*E.get("text-max-width").evaluate(Te,{},x):0,li=function(){e.allowVerticalPlacement&&$l(Qt)&&(lt.vertical=Rc(kt,t,i,f,Me,Wr,J,tr,"left",vt,ut,la.vertical,!0,br,$e,Ke))};if(!ee&&Zt){for(var ii=Pt==="auto"?Zt.map(function(or){return np(or)}):[Pt],Yr=!1,ui=0;ui<ii.length;ui++){var Bi=ii[ui];if(!lt.horizontal[Bi])if(Yr)lt.horizontal[Bi]=lt.horizontal[0];else{var Fi=Rc(kt,t,i,f,Me,Wr,J,"center",Bi,vt,ut,la.horizontal,!1,br,$e,Ke);Fi&&(lt.horizontal[Bi]=Fi,Yr=Fi.positionedLines.length===1)}}li()}else{Pt==="auto"&&(Pt=np(tr));var wn=Rc(kt,t,i,f,Me,Wr,J,tr,Pt,vt,ut,la.horizontal,!1,br,$e,Ke);wn&&(lt.horizontal[Pt]=wn),li(),$l(Qt)&&ee&&he&&(lt.vertical=Rc(kt,t,i,f,Me,Wr,J,tr,Pt,vt,ut,la.vertical,!1,br,$e,Ke))}}var Xi=void 0,Sn=!1;if(Te.icon&&Te.icon.name){var di=u[Te.icon.name];di&&(Xi=function(or,Lr,zr){var gr=tp(zr),Dn=Lr[0]-or.displaySize[0]*gr.horizontalAlign,pn=Lr[1]-or.displaySize[1]*gr.verticalAlign;return{image:or,top:pn,bottom:pn+or.displaySize[1],left:Dn,right:Dn+or.displaySize[0]}}(f[Te.icon.name],E.get("icon-offset").evaluate(Te,{},x),E.get("icon-anchor").evaluate(Te,{},x)),Sn=di.sdf,e.sdfIcons===void 0?e.sdfIcons=di.sdf:e.sdfIcons!==di.sdf&&qe("Style sheet warning: Cannot mix SDF and non-SDF icons in one buffer"),(di.pixelRatio!==e.pixelRatio||E.get("icon-rotate").constantOr(1)!==0)&&(e.iconsNeedLinear=!0))}var Wi=Mf(lt.horizontal)||lt.vertical;e.iconsInText=!!Wi&&Wi.iconsInText,(Wi||Xi)&&function(or,Lr,zr,gr,Dn,pn,Gr,xi,fn,xr,to){var ua=pn.textMaxSize.evaluate(Lr,{});ua===void 0&&(ua=Gr);var ro,mi=or.layers[0].layout,io=mi.get("icon-offset").evaluate(Lr,{},to),Aa=Mf(zr.horizontal),vl=Gr/24,Cs=or.tilePixelRatio*vl,bl=or.tilePixelRatio*ua/24,Mo=or.tilePixelRatio*xi,xl=or.tilePixelRatio*mi.get("symbol-spacing"),Zc=mi.get("text-padding")*or.tilePixelRatio,wl=mi.get("icon-padding")*or.tilePixelRatio,bu=mi.get("text-max-angle")/180*Math.PI,Kc=mi.get("text-rotation-alignment")==="map"&&mi.get("symbol-placement")!=="point",Hc=mi.get("icon-rotation-alignment")==="map"&&mi.get("symbol-placement")!=="point",Do=mi.get("symbol-placement"),xu=xl/2,Sl=mi.get("icon-text-fit");gr&&Sl!=="none"&&(or.allowVerticalPlacement&&zr.vertical&&(ro=bf(gr,zr.vertical,Sl,mi.get("icon-text-fit-padding"),io,vl)),Aa&&(gr=bf(gr,Aa,Sl,mi.get("icon-text-fit-padding"),io,vl)));var Qo=function(Kg,zu){zu.x<0||zu.x>=8192||zu.y<0||zu.y>=8192||function(yi,Fa,Hg,$o,fp,Wf,$c,no,eh,Au,th,rh,dp,Yf,Cu,Jf,Qf,$f,ed,td,ca,ih,rd,ao,Xg){var id,Ds,Pl,zl,Al,Cl=yi.addToLineVertexArray(Fa,Hg),nd=0,ad=0,od=0,sd=0,mp=-1,yp=-1,Lo={},ld=Y(""),gp=0,_p=0;if(no._unevaluatedLayout.getValue("text-radial-offset")===void 0?(gp=(id=no.layout.get("text-offset").evaluate(ca,{},ao).map(function(Du){return 24*Du}))[0],_p=id[1]):(gp=24*no.layout.get("text-radial-offset").evaluate(ca,{},ao),_p=ip),yi.allowVerticalPlacement&&$o.vertical){var ud=no.layout.get("text-rotate").evaluate(ca,{},ao)+90;zl=new Uc(eh,Fa,Au,th,rh,$o.vertical,dp,Yf,Cu,ud),$c&&(Al=new Uc(eh,Fa,Au,th,rh,$c,Qf,$f,Cu,ud))}if(fp){var vp=no.layout.get("icon-rotate").evaluate(ca,{}),cd=no.layout.get("icon-text-fit")!=="none",hd=Pf(fp,vp,rd,cd),bp=$c?Pf($c,vp,rd,cd):void 0;Pl=new Uc(eh,Fa,Au,th,rh,fp,Qf,$f,!1,vp),nd=4*hd.length;var pd=yi.iconSizeData,Mu=null;pd.kind==="source"?(Mu=[128*no.layout.get("icon-size").evaluate(ca,{})])[0]>32640&&qe(yi.layerIds[0]+': Value for "icon-size" is >= 255. Reduce your "icon-size".'):pd.kind==="composite"&&((Mu=[128*ih.compositeIconSizes[0].evaluate(ca,{},ao),128*ih.compositeIconSizes[1].evaluate(ca,{},ao)])[0]>32640||Mu[1]>32640)&&qe(yi.layerIds[0]+': Value for "icon-size" is >= 255. Reduce your "icon-size".'),yi.addSymbols(yi.icon,hd,Mu,td,ed,ca,!1,Fa,Cl.lineStartIndex,Cl.lineLength,-1,ao),mp=yi.icon.placedSymbolArray.length-1,bp&&(ad=4*bp.length,yi.addSymbols(yi.icon,bp,Mu,td,ed,ca,la.vertical,Fa,Cl.lineStartIndex,Cl.lineLength,-1,ao),yp=yi.icon.placedSymbolArray.length-1)}for(var fd in $o.horizontal){var nh=$o.horizontal[fd];if(!Ds){ld=Y(nh.text);var Wg=no.layout.get("text-rotate").evaluate(ca,{},ao);Ds=new Uc(eh,Fa,Au,th,rh,nh,dp,Yf,Cu,Wg)}var dd=nh.positionedLines.length===1;if(od+=Cf(yi,Fa,nh,Wf,no,Cu,ca,Jf,Cl,$o.vertical?la.horizontal:la.horizontalOnly,dd?Object.keys($o.horizontal):[fd],Lo,mp,ih,ao),dd)break}$o.vertical&&(sd+=Cf(yi,Fa,$o.vertical,Wf,no,Cu,ca,Jf,Cl,la.vertical,["vertical"],Lo,yp,ih,ao));var Yg=Ds?Ds.boxStartIndex:yi.collisionBoxArray.length,Jg=Ds?Ds.boxEndIndex:yi.collisionBoxArray.length,Qg=zl?zl.boxStartIndex:yi.collisionBoxArray.length,$g=zl?zl.boxEndIndex:yi.collisionBoxArray.length,e_=Pl?Pl.boxStartIndex:yi.collisionBoxArray.length,t_=Pl?Pl.boxEndIndex:yi.collisionBoxArray.length,r_=Al?Al.boxStartIndex:yi.collisionBoxArray.length,i_=Al?Al.boxEndIndex:yi.collisionBoxArray.length,oo=-1,ah=function(Du,yd){return Du&&Du.circleDiameter?Math.max(Du.circleDiameter,yd):yd};oo=ah(Ds,oo),oo=ah(zl,oo),oo=ah(Pl,oo);var md=(oo=ah(Al,oo))>-1?1:0;md&&(oo*=Xg/24),yi.glyphOffsetArray.length>=Cr.MAX_GLYPHS&&qe("Too many glyphs being rendered in a tile. See https://github.com/mapbox/mapbox-gl-js/issues/2907"),ca.sortKey!==void 0&&yi.addToSortKeyRanges(yi.symbolInstances.length,ca.sortKey),yi.symbolInstances.emplaceBack(Fa.x,Fa.y,Lo.right>=0?Lo.right:-1,Lo.center>=0?Lo.center:-1,Lo.left>=0?Lo.left:-1,Lo.vertical||-1,mp,yp,ld,Yg,Jg,Qg,$g,e_,t_,r_,i_,Au,od,sd,nd,ad,md,0,dp,gp,_p,oo)}(or,zu,Kg,zr,gr,Dn,ro,or.layers[0],or.collisionBoxArray,Lr.index,Lr.sourceLayerIndex,or.index,Cs,Zc,Kc,fn,Mo,wl,Hc,io,Lr,pn,xr,to,Gr)};if(Do==="line")for(var El=0,Xc=If(Lr.geometry,0,0,8192,8192);El<Xc.length;El+=1)for(var Wc=Xc[El],wu=0,Su=zg(Wc,xl,bu,zr.vertical||Aa,gr,24,bl,or.overscaling,8192);wu<Su.length;wu+=1){var Yc=Su[wu];Aa&&Dg(or,Aa.text,xu,Yc)||Qo(Wc,Yc)}else if(Do==="line-center")for(var Eu=0,ku=Lr.geometry;Eu<ku.length;Eu+=1){var Tu=ku[Eu];if(Tu.length>1){var Jc=Pg(Tu,bu,zr.vertical||Aa,gr,24,bl);Jc&&Qo(Tu,Jc)}}else if(Lr.type==="Polygon")for(var kl=0,Qc=Yh(Lr.geometry,0);kl<Qc.length;kl+=1){var Tl=Qc[kl],Iu=Cg(Tl,16);Qo(Tl[0],new pl(Iu.x,Iu.y,0))}else if(Lr.type==="LineString")for(var Ms=0,Pu=Lr.geometry;Ms<Pu.length;Ms+=1){var Il=Pu[Ms];Qo(Il,new pl(Il[0].x,Il[0].y,0))}else if(Lr.type==="Point")for(var cp=0,Hf=Lr.geometry;cp<Hf.length;cp+=1)for(var hp=0,Xf=Hf[cp];hp<Xf.length;hp+=1){var pp=Xf[hp];Qo([pp],new pl(pp.x,pp.y,0))}}(e,Te,lt,Xi,u,A,$e,bt,ut,Sn,x)},be=0,Ee=e.features;be<Ee.length;be+=1)ye();m&&e.generateCollisionDebugBuffers()},a.perspective=function(e,t,i,u,f){var m,x=1/Math.tan(t/2);return e[0]=x/i,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=x,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[11]=-1,e[12]=0,e[13]=0,e[15]=0,f!=null&&f!==1/0?(e[10]=(f+u)*(m=1/(u-f)),e[14]=2*f*u*m):(e[10]=-1,e[14]=-2*u),e},a.pick=function(e,t){for(var i={},u=0;u<t.length;u++){var f=t[u];f in e&&(i[f]=e[f])}return i},a.plugin=ea,a.polygonIntersectsPolygon=Qa,a.postMapLoadEvent=Oi,a.postTurnstileEvent=Qi,a.potpack=yf,a.refProperties=["type","source","source-layer","minzoom","maxzoom","filter","layout"],a.register=pt,a.registerForPluginStateChange=function(e){return e({pluginStatus:Zn,pluginURL:Ma}),tu.on("pluginStateChange",e),e},a.renderColorRamp=Yp,a.rotate=function(e,t,i){var u=t[0],f=t[1],m=t[2],x=t[3],E=Math.sin(i),z=Math.cos(i);return e[0]=u*z+m*E,e[1]=f*z+x*E,e[2]=u*-E+m*z,e[3]=f*-E+x*z,e},a.rotateX=function(e,t,i){var u=Math.sin(i),f=Math.cos(i),m=t[4],x=t[5],E=t[6],z=t[7],A=t[8],D=t[9],B=t[10],q=t[11];return t!==e&&(e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e[4]=m*f+A*u,e[5]=x*f+D*u,e[6]=E*f+B*u,e[7]=z*f+q*u,e[8]=A*f-m*u,e[9]=D*f-x*u,e[10]=B*f-E*u,e[11]=q*f-z*u,e},a.rotateZ=function(e,t,i){var u=Math.sin(i),f=Math.cos(i),m=t[0],x=t[1],E=t[2],z=t[3],A=t[4],D=t[5],B=t[6],q=t[7];return t!==e&&(e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e[0]=m*f+A*u,e[1]=x*f+D*u,e[2]=E*f+B*u,e[3]=z*f+q*u,e[4]=A*f-m*u,e[5]=D*f-x*u,e[6]=B*f-E*u,e[7]=q*f-z*u,e},a.scale=function(e,t,i){var u=i[0],f=i[1],m=i[2];return e[0]=t[0]*u,e[1]=t[1]*u,e[2]=t[2]*u,e[3]=t[3]*u,e[4]=t[4]*f,e[5]=t[5]*f,e[6]=t[6]*f,e[7]=t[7]*f,e[8]=t[8]*m,e[9]=t[9]*m,e[10]=t[10]*m,e[11]=t[11]*m,e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15],e},a.scale$1=function(e,t,i){return e[0]=t[0]*i,e[1]=t[1]*i,e[2]=t[2]*i,e[3]=t[3]*i,e},a.scale$2=function(e,t,i){return e[0]=t[0]*i,e[1]=t[1]*i,e[2]=t[2]*i,e},a.setCacheLimits=function(e,t){Pn=e,$i=t},a.setRTLTextPlugin=function(e,t,i){if(i===void 0&&(i=!1),Zn==="deferred"||Zn==="loading"||Zn==="loaded")throw new Error("setRTLTextPlugin cannot be called multiple times.");Ma=Sr.resolveURL(e),Zn="deferred",Qs=t,vs(),i||ma()},a.sphericalToCartesian=function(e){var t=e[0],i=e[1],u=e[2];return i+=90,i*=Math.PI/180,u*=Math.PI/180,{x:t*Math.cos(i)*Math.sin(u),y:t*Math.sin(i)*Math.sin(u),z:t*Math.cos(u)}},a.sqrLen=function(e){var t=e[0],i=e[1];return t*t+i*i},a.styleSpec=j,a.sub=function(e,t,i){return e[0]=t[0]-i[0],e[1]=t[1]-i[1],e[2]=t[2]-i[2],e},a.symbolSize=Ig,a.transformMat3=function(e,t,i){var u=t[0],f=t[1],m=t[2];return e[0]=u*i[0]+f*i[3]+m*i[6],e[1]=u*i[1]+f*i[4]+m*i[7],e[2]=u*i[2]+f*i[5]+m*i[8],e},a.transformMat4=nl,a.translate=function(e,t,i){var u,f,m,x,E,z,A,D,B,q,G,J,ee=i[0],he=i[1],oe=i[2];return t===e?(e[12]=t[0]*ee+t[4]*he+t[8]*oe+t[12],e[13]=t[1]*ee+t[5]*he+t[9]*oe+t[13],e[14]=t[2]*ee+t[6]*he+t[10]*oe+t[14],e[15]=t[3]*ee+t[7]*he+t[11]*oe+t[15]):(f=t[1],m=t[2],x=t[3],E=t[4],z=t[5],A=t[6],D=t[7],B=t[8],q=t[9],G=t[10],J=t[11],e[0]=u=t[0],e[1]=f,e[2]=m,e[3]=x,e[4]=E,e[5]=z,e[6]=A,e[7]=D,e[8]=B,e[9]=q,e[10]=G,e[11]=J,e[12]=u*ee+E*he+B*oe+t[12],e[13]=f*ee+z*he+q*oe+t[13],e[14]=m*ee+A*he+G*oe+t[14],e[15]=x*ee+D*he+J*oe+t[15]),e},a.triggerPluginCompletionEvent=kc,a.uniqueId=Fe,a.validateCustomStyleLayer=function(e){var t=[],i=e.id;return i===void 0&&t.push({message:"layers."+i+': missing required property "id"'}),e.render===void 0&&t.push({message:"layers."+i+': missing required method "render"'}),e.renderingMode&&e.renderingMode!=="2d"&&e.renderingMode!=="3d"&&t.push({message:"layers."+i+': property "renderingMode" must be either "2d" or "3d"'}),t},a.validateLight=Vh,a.validateStyle=ms,a.values=function(e){var t=[];for(var i in e)t.push(e[i]);return t},a.vectorTile=ll,a.version="1.13.2",a.warnOnce=qe,a.webpSupported=Si,a.window=R,a.wrap=de}),v(["./shared"],function(a){function k(L){var U=typeof L;if(U==="number"||U==="boolean"||U==="string"||L==null)return JSON.stringify(L);if(Array.isArray(L)){for(var I="[",V=0,W=L;V<W.length;V+=1)I+=k(W[V])+",";return I+"]"}for(var ue=Object.keys(L).sort(),pe="{",j=0;j<ue.length;j++)pe+=JSON.stringify(ue[j])+":"+k(L[ue[j]])+",";return pe+"}"}function T(L){for(var U="",I=0,V=a.refProperties;I<V.length;I+=1)U+="/"+k(L[V[I]]);return U}var F=function(L){this.keyCache={},L&&this.replace(L)};F.prototype.replace=function(L){this._layerConfigs={},this._layers={},this.update(L,[])},F.prototype.update=function(L,U){for(var I=this,V=0,W=L;V<W.length;V+=1){var ue=W[V];this._layerConfigs[ue.id]=ue;var pe=this._layers[ue.id]=a.createStyleLayer(ue);pe._featureFilter=a.featureFilter(pe.filter),this.keyCache[ue.id]&&delete this.keyCache[ue.id]}for(var j=0,$=U;j<$.length;j+=1){var me=$[j];delete this.keyCache[me],delete this._layerConfigs[me],delete this._layers[me]}this.familiesBySource={};for(var Ce=0,Oe=function(Ye,Qe){for(var Vt={},it=0;it<Ye.length;it++){var Wt=Qe&&Qe[Ye[it].id]||T(Ye[it]);Qe&&(Qe[Ye[it].id]=Wt);var jt=Vt[Wt];jt||(jt=Vt[Wt]=[]),jt.push(Ye[it])}var Ht=[];for(var sr in Vt)Ht.push(Vt[sr]);return Ht}(a.values(this._layerConfigs),this.keyCache);Ce<Oe.length;Ce+=1){var we=Oe[Ce].map(function(Ye){return I._layers[Ye.id]}),De=we[0];if(De.visibility!=="none"){var st=De.source||"",tt=this.familiesBySource[st];tt||(tt=this.familiesBySource[st]={});var Se=De.sourceLayer||"_geojsonTileLayer",He=tt[Se];He||(He=tt[Se]=[]),He.push(we)}}};var M=function(L){var U={},I=[];for(var V in L){var W=L[V],ue=U[V]={};for(var pe in W){var j=W[+pe];if(j&&j.bitmap.width!==0&&j.bitmap.height!==0){var $={x:0,y:0,w:j.bitmap.width+2,h:j.bitmap.height+2};I.push($),ue[pe]={rect:$,metrics:j.metrics}}}}var me=a.potpack(I),Ce=new a.AlphaImage({width:me.w||1,height:me.h||1});for(var Oe in L){var we=L[Oe];for(var De in we){var st=we[+De];if(st&&st.bitmap.width!==0&&st.bitmap.height!==0){var tt=U[Oe][De].rect;a.AlphaImage.copy(st.bitmap,Ce,{x:0,y:0},{x:tt.x+1,y:tt.y+1},st.bitmap)}}}this.image=Ce,this.positions=U};a.register("GlyphAtlas",M);var N=function(L){this.tileID=new a.OverscaledTileID(L.tileID.overscaledZ,L.tileID.wrap,L.tileID.canonical.z,L.tileID.canonical.x,L.tileID.canonical.y),this.uid=L.uid,this.zoom=L.zoom,this.pixelRatio=L.pixelRatio,this.tileSize=L.tileSize,this.source=L.source,this.overscaling=this.tileID.overscaleFactor(),this.showCollisionBoxes=L.showCollisionBoxes,this.collectResourceTiming=!!L.collectResourceTiming,this.returnDependencies=!!L.returnDependencies,this.promoteId=L.promoteId};function R(L,U,I){for(var V=new a.EvaluationParameters(U),W=0,ue=L;W<ue.length;W+=1)ue[W].recalculate(V,I)}function X(L,U){var I=a.getArrayBuffer(L.request,function(V,W,ue,pe){V?U(V):W&&U(null,{vectorTile:new a.vectorTile.VectorTile(new a.pbf(W)),rawData:W,cacheControl:ue,expires:pe})});return function(){I.cancel(),U()}}N.prototype.parse=function(L,U,I,V,W){var ue=this;this.status="parsing",this.data=L,this.collisionBoxArray=new a.CollisionBoxArray;var pe=new a.DictionaryCoder(Object.keys(L.layers).sort()),j=new a.FeatureIndex(this.tileID,this.promoteId);j.bucketLayerIDs=[];var $,me,Ce,Oe,we={},De={featureIndex:j,iconDependencies:{},patternDependencies:{},glyphDependencies:{},availableImages:I},st=U.familiesBySource[this.source];for(var tt in st){var Se=L.layers[tt];if(Se){Se.version===1&&a.warnOnce('Vector tile source "'+this.source+'" layer "'+tt+'" does not use vector tile spec v2 and therefore may have some rendering errors.');for(var He=pe.encode(tt),Ye=[],Qe=0;Qe<Se.length;Qe++){var Vt=Se.feature(Qe),it=j.getId(Vt,tt);Ye.push({feature:Vt,id:it,index:Qe,sourceLayerIndex:He})}for(var Wt=0,jt=st[tt];Wt<jt.length;Wt+=1){var Ht=jt[Wt],sr=Ht[0];sr.minzoom&&this.zoom<Math.floor(sr.minzoom)||sr.maxzoom&&this.zoom>=sr.maxzoom||sr.visibility!=="none"&&(R(Ht,this.zoom,I),(we[sr.id]=sr.createBucket({index:j.bucketLayerIDs.length,layers:Ht,zoom:this.zoom,pixelRatio:this.pixelRatio,overscaling:this.overscaling,collisionBoxArray:this.collisionBoxArray,sourceLayerIndex:He,sourceID:this.source})).populate(Ye,De,this.tileID.canonical),j.bucketLayerIDs.push(Ht.map(function(_r){return _r.id})))}}}var er=a.mapObject(De.glyphDependencies,function(_r){return Object.keys(_r).map(Number)});Object.keys(er).length?V.send("getGlyphs",{uid:this.uid,stacks:er},function(_r,Jt){$||($=_r,me=Jt,Fr.call(ue))}):me={};var _i=Object.keys(De.iconDependencies);_i.length?V.send("getImages",{icons:_i,source:this.source,tileID:this.tileID,type:"icons"},function(_r,Jt){$||($=_r,Ce=Jt,Fr.call(ue))}):Ce={};var dr=Object.keys(De.patternDependencies);function Fr(){if($)return W($);if(me&&Ce&&Oe){var _r=new M(me),Jt=new a.ImageAtlas(Ce,Oe);for(var lr in we){var Ei=we[lr];Ei instanceof a.SymbolBucket?(R(Ei.layers,this.zoom,I),a.performSymbolLayout(Ei,me,_r.positions,Ce,Jt.iconPositions,this.showCollisionBoxes,this.tileID.canonical)):Ei.hasPattern&&(Ei instanceof a.LineBucket||Ei instanceof a.FillBucket||Ei instanceof a.FillExtrusionBucket)&&(R(Ei.layers,this.zoom,I),Ei.addFeatures(De,this.tileID.canonical,Jt.patternPositions))}this.status="done",W(null,{buckets:a.values(we).filter(function(pa){return!pa.isEmpty()}),featureIndex:j,collisionBoxArray:this.collisionBoxArray,glyphAtlasImage:_r.image,imageAtlas:Jt,glyphMap:this.returnDependencies?me:null,iconMap:this.returnDependencies?Ce:null,glyphPositions:this.returnDependencies?_r.positions:null})}}dr.length?V.send("getImages",{icons:dr,source:this.source,tileID:this.tileID,type:"patterns"},function(_r,Jt){$||($=_r,Oe=Jt,Fr.call(ue))}):Oe={},Fr.call(this)};var Q=function(L,U,I,V){this.actor=L,this.layerIndex=U,this.availableImages=I,this.loadVectorData=V||X,this.loading={},this.loaded={}};Q.prototype.loadTile=function(L,U){var I=this,V=L.uid;this.loading||(this.loading={});var W=!!(L&&L.request&&L.request.collectResourceTiming)&&new a.RequestPerformance(L.request),ue=this.loading[V]=new N(L);ue.abort=this.loadVectorData(L,function(pe,j){if(delete I.loading[V],pe||!j)return ue.status="done",I.loaded[V]=ue,U(pe);var $=j.rawData,me={};j.expires&&(me.expires=j.expires),j.cacheControl&&(me.cacheControl=j.cacheControl);var Ce={};if(W){var Oe=W.finish();Oe&&(Ce.resourceTiming=JSON.parse(JSON.stringify(Oe)))}ue.vectorTile=j.vectorTile,ue.parse(j.vectorTile,I.layerIndex,I.availableImages,I.actor,function(we,De){if(we||!De)return U(we);U(null,a.extend({rawTileData:$.slice(0)},De,me,Ce))}),I.loaded=I.loaded||{},I.loaded[V]=ue})},Q.prototype.reloadTile=function(L,U){var I=this,V=this.loaded,W=L.uid,ue=this;if(V&&V[W]){var pe=V[W];pe.showCollisionBoxes=L.showCollisionBoxes;var j=function($,me){var Ce=pe.reloadCallback;Ce&&(delete pe.reloadCallback,pe.parse(pe.vectorTile,ue.layerIndex,I.availableImages,ue.actor,Ce)),U($,me)};pe.status==="parsing"?pe.reloadCallback=j:pe.status==="done"&&(pe.vectorTile?pe.parse(pe.vectorTile,this.layerIndex,this.availableImages,this.actor,j):j())}},Q.prototype.abortTile=function(L,U){var I=this.loading,V=L.uid;I&&I[V]&&I[V].abort&&(I[V].abort(),delete I[V]),U()},Q.prototype.removeTile=function(L,U){var I=this.loaded,V=L.uid;I&&I[V]&&delete I[V],U()};var ae=a.window.ImageBitmap,le=function(){this.loaded={}};function de(L,U){if(L.length!==0){ge(L[0],U);for(var I=1;I<L.length;I++)ge(L[I],!U)}}function ge(L,U){for(var I=0,V=0,W=L.length,ue=W-1;V<W;ue=V++)I+=(L[V][0]-L[ue][0])*(L[ue][1]+L[V][1]);I>=0!=!!U&&L.reverse()}le.prototype.loadTile=function(L,U){var I=L.uid,V=L.encoding,W=L.rawImageData,ue=ae&&W instanceof ae?this.getImageData(W):W,pe=new a.DEMData(I,ue,V);this.loaded=this.loaded||{},this.loaded[I]=pe,U(null,pe)},le.prototype.getImageData=function(L){this.offscreenCanvas&&this.offscreenCanvasContext||(this.offscreenCanvas=new OffscreenCanvas(L.width,L.height),this.offscreenCanvasContext=this.offscreenCanvas.getContext("2d")),this.offscreenCanvas.width=L.width,this.offscreenCanvas.height=L.height,this.offscreenCanvasContext.drawImage(L,0,0,L.width,L.height);var U=this.offscreenCanvasContext.getImageData(-1,-1,L.width+2,L.height+2);return this.offscreenCanvasContext.clearRect(0,0,this.offscreenCanvas.width,this.offscreenCanvas.height),new a.RGBAImage({width:U.width,height:U.height},U.data)},le.prototype.removeTile=function(L){var U=this.loaded,I=L.uid;U&&U[I]&&delete U[I]};var rt=a.vectorTile.VectorTileFeature.prototype.toGeoJSON,Fe=function(L){this._feature=L,this.extent=a.EXTENT,this.type=L.type,this.properties=L.tags,"id"in L&&!isNaN(L.id)&&(this.id=parseInt(L.id,10))};Fe.prototype.loadGeometry=function(){if(this._feature.type===1){for(var L=[],U=0,I=this._feature.geometry;U<I.length;U+=1){var V=I[U];L.push([new a.Point$1(V[0],V[1])])}return L}for(var W=[],ue=0,pe=this._feature.geometry;ue<pe.length;ue+=1){for(var j=[],$=0,me=pe[ue];$<me.length;$+=1){var Ce=me[$];j.push(new a.Point$1(Ce[0],Ce[1]))}W.push(j)}return W},Fe.prototype.toGeoJSON=function(L,U,I){return rt.call(this,L,U,I)};var ze=function(L){this.layers={_geojsonTileLayer:this},this.name="_geojsonTileLayer",this.extent=a.EXTENT,this.length=L.length,this._features=L};ze.prototype.feature=function(L){return new Fe(this._features[L])};var Ge=a.vectorTile.VectorTileFeature,zt=wt;function wt(L,U){this.options=U||{},this.features=L,this.length=L.length}function je(L,U){this.id=typeof L.id=="number"?L.id:void 0,this.type=L.type,this.rawGeometry=L.type===1?[L.geometry]:L.geometry,this.properties=L.tags,this.extent=U||4096}wt.prototype.feature=function(L){return new je(this.features[L],this.options.extent)},je.prototype.loadGeometry=function(){var L=this.rawGeometry;this.geometry=[];for(var U=0;U<L.length;U++){for(var I=L[U],V=[],W=0;W<I.length;W++)V.push(new a.Point$1(I[W][0],I[W][1]));this.geometry.push(V)}return this.geometry},je.prototype.bbox=function(){this.geometry||this.loadGeometry();for(var L=this.geometry,U=1/0,I=-1/0,V=1/0,W=-1/0,ue=0;ue<L.length;ue++)for(var pe=L[ue],j=0;j<pe.length;j++){var $=pe[j];U=Math.min(U,$.x),I=Math.max(I,$.x),V=Math.min(V,$.y),W=Math.max(W,$.y)}return[U,V,I,W]},je.prototype.toGeoJSON=Ge.prototype.toGeoJSON;var Ze=nr,mt=zt;function nr(L){var U=new a.pbf;return function(I,V){for(var W in I.layers)V.writeMessage(3,qe,I.layers[W])}(L,U),U.finish()}function qe(L,U){var I;U.writeVarintField(15,L.version||1),U.writeStringField(1,L.name||""),U.writeVarintField(5,L.extent||4096);var V={keys:[],values:[],keycache:{},valuecache:{}};for(I=0;I<L.length;I++)V.feature=L.feature(I),U.writeMessage(2,Bt,V);var W=V.keys;for(I=0;I<W.length;I++)U.writeStringField(3,W[I]);var ue=V.values;for(I=0;I<ue.length;I++)U.writeMessage(4,Mt,ue[I])}function Bt(L,U){var I=L.feature;I.id!==void 0&&U.writeVarintField(1,I.id),U.writeMessage(2,Re,L),U.writeVarintField(3,I.type),U.writeMessage(4,qt,I)}function Re(L,U){var I=L.feature,V=L.keys,W=L.values,ue=L.keycache,pe=L.valuecache;for(var j in I.properties){var $=ue[j];$===void 0&&(V.push(j),ue[j]=$=V.length-1),U.writeVarint($);var me=I.properties[j],Ce=typeof me;Ce!=="string"&&Ce!=="boolean"&&Ce!=="number"&&(me=JSON.stringify(me));var Oe=Ce+":"+me,we=pe[Oe];we===void 0&&(W.push(me),pe[Oe]=we=W.length-1),U.writeVarint(we)}}function et(L,U){return(U<<3)+(7&L)}function dt(L){return L<<1^L>>31}function qt(L,U){for(var I=L.loadGeometry(),V=L.type,W=0,ue=0,pe=I.length,j=0;j<pe;j++){var $=I[j],me=1;V===1&&(me=$.length),U.writeVarint(et(1,me));for(var Ce=V===3?$.length-1:$.length,Oe=0;Oe<Ce;Oe++){Oe===1&&V!==1&&U.writeVarint(et(2,Ce-1));var we=$[Oe].x-W,De=$[Oe].y-ue;U.writeVarint(dt(we)),U.writeVarint(dt(De)),W+=we,ue+=De}V===3&&U.writeVarint(et(7,1))}}function Mt(L,U){var I=typeof L;I==="string"?U.writeStringField(1,L):I==="boolean"?U.writeBooleanField(7,L):I==="number"&&(L%1!=0?U.writeDoubleField(3,L):L<0?U.writeSVarintField(6,L):U.writeVarintField(5,L))}function xt(L,U,I,V){Ae(L,I,V),Ae(U,2*I,2*V),Ae(U,2*I+1,2*V+1)}function Ae(L,U,I){var V=L[U];L[U]=L[I],L[I]=V}function at(L,U,I,V){var W=L-I,ue=U-V;return W*W+ue*ue}Ze.fromVectorTileJs=nr,Ze.fromGeojsonVt=function(L,U){U=U||{};var I={};for(var V in L)I[V]=new zt(L[V].features,U),I[V].name=V,I[V].version=U.version,I[V].extent=U.extent;return nr({layers:I})},Ze.GeoJSONWrapper=mt;var Mr=function(L){return L[0]},Zr=function(L){return L[1]},wi=function(L,U,I,V,W){U===void 0&&(U=Mr),I===void 0&&(I=Zr),V===void 0&&(V=64),W===void 0&&(W=Float64Array),this.nodeSize=V,this.points=L;for(var ue=L.length<65536?Uint16Array:Uint32Array,pe=this.ids=new ue(L.length),j=this.coords=new W(2*L.length),$=0;$<L.length;$++)pe[$]=$,j[2*$]=U(L[$]),j[2*$+1]=I(L[$]);(function me(Ce,Oe,we,De,st,tt){if(!(st-De<=we)){var Se=De+st>>1;(function He(Ye,Qe,Vt,it,Wt,jt){for(;Wt>it;){if(Wt-it>600){var Ht=Wt-it+1,sr=Vt-it+1,er=Math.log(Ht),_i=.5*Math.exp(2*er/3),dr=.5*Math.sqrt(er*_i*(Ht-_i)/Ht)*(sr-Ht/2<0?-1:1);He(Ye,Qe,Vt,Math.max(it,Math.floor(Vt-sr*_i/Ht+dr)),Math.min(Wt,Math.floor(Vt+(Ht-sr)*_i/Ht+dr)),jt)}var Fr=Qe[2*Vt+jt],_r=it,Jt=Wt;for(xt(Ye,Qe,it,Vt),Qe[2*Wt+jt]>Fr&&xt(Ye,Qe,it,Wt);_r<Jt;){for(xt(Ye,Qe,_r,Jt),_r++,Jt--;Qe[2*_r+jt]<Fr;)_r++;for(;Qe[2*Jt+jt]>Fr;)Jt--}Qe[2*it+jt]===Fr?xt(Ye,Qe,it,Jt):xt(Ye,Qe,++Jt,Wt),Jt<=Vt&&(it=Jt+1),Vt<=Jt&&(Wt=Jt-1)}})(Ce,Oe,Se,De,st,tt%2),me(Ce,Oe,we,De,Se-1,tt+1),me(Ce,Oe,we,Se+1,st,tt+1)}})(pe,j,V,0,pe.length-1,0)};wi.prototype.range=function(L,U,I,V){return function(W,ue,pe,j,$,me,Ce){for(var Oe,we,De=[0,W.length-1,0],st=[];De.length;){var tt=De.pop(),Se=De.pop(),He=De.pop();if(Se-He<=Ce)for(var Ye=He;Ye<=Se;Ye++)we=ue[2*Ye+1],(Oe=ue[2*Ye])>=pe&&Oe<=$&&we>=j&&we<=me&&st.push(W[Ye]);else{var Qe=Math.floor((He+Se)/2);we=ue[2*Qe+1],(Oe=ue[2*Qe])>=pe&&Oe<=$&&we>=j&&we<=me&&st.push(W[Qe]);var Vt=(tt+1)%2;(tt===0?pe<=Oe:j<=we)&&(De.push(He),De.push(Qe-1),De.push(Vt)),(tt===0?$>=Oe:me>=we)&&(De.push(Qe+1),De.push(Se),De.push(Vt))}}return st}(this.ids,this.coords,L,U,I,V,this.nodeSize)},wi.prototype.within=function(L,U,I){return function(V,W,ue,pe,j,$){for(var me=[0,V.length-1,0],Ce=[],Oe=j*j;me.length;){var we=me.pop(),De=me.pop(),st=me.pop();if(De-st<=$)for(var tt=st;tt<=De;tt++)at(W[2*tt],W[2*tt+1],ue,pe)<=Oe&&Ce.push(V[tt]);else{var Se=Math.floor((st+De)/2),He=W[2*Se],Ye=W[2*Se+1];at(He,Ye,ue,pe)<=Oe&&Ce.push(V[Se]);var Qe=(we+1)%2;(we===0?ue-j<=He:pe-j<=Ye)&&(me.push(st),me.push(Se-1),me.push(Qe)),(we===0?ue+j>=He:pe+j>=Ye)&&(me.push(Se+1),me.push(De),me.push(Qe))}}return Ce}(this.ids,this.coords,L,U,I,this.nodeSize)};var Rr={minZoom:0,maxZoom:16,minPoints:2,radius:40,extent:512,nodeSize:64,log:!1,generateId:!1,reduce:null,map:function(L){return L}},ar=function(L){this.options=dn(Object.create(Rr),L),this.trees=new Array(this.options.maxZoom+1)};function Sr(L,U,I,V,W){return{x:L,y:U,zoom:1/0,id:I,parentId:-1,numPoints:V,properties:W}}function Gt(L,U){var I=L.geometry.coordinates,V=I[1];return{x:ti(I[0]),y:Nt(V),zoom:1/0,index:U,parentId:-1}}function Si(L){return{type:"Feature",id:L.id,properties:Jn(L),geometry:{type:"Point",coordinates:[(V=L.x,360*(V-.5)),(U=L.y,I=(180-360*U)*Math.PI/180,360*Math.atan(Math.exp(I))/Math.PI-90)]}};var U,I,V}function Jn(L){var U=L.numPoints,I=U>=1e4?Math.round(U/1e3)+"k":U>=1e3?Math.round(U/100)/10+"k":U;return dn(dn({},L.properties),{cluster:!0,cluster_id:L.id,point_count:U,point_count_abbreviated:I})}function ti(L){return L/360+.5}function Nt(L){var U=Math.sin(L*Math.PI/180),I=.5-.25*Math.log((1+U)/(1-U))/Math.PI;return I<0?0:I>1?1:I}function dn(L,U){for(var I in U)L[I]=U[I];return L}function ci(L){return L.x}function Jr(L){return L.y}function Bn(L,U,I,V,W,ue){var pe=W-I,j=ue-V;if(pe!==0||j!==0){var $=((L-I)*pe+(U-V)*j)/(pe*pe+j*j);$>1?(I=W,V=ue):$>0&&(I+=pe*$,V+=j*$)}return(pe=L-I)*pe+(j=U-V)*j}function hi(L,U,I,V){var W={id:L===void 0?null:L,type:U,geometry:I,tags:V,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0};return function(ue){var pe=ue.geometry,j=ue.type;if(j==="Point"||j==="MultiPoint"||j==="LineString")Tn(ue,pe);else if(j==="Polygon"||j==="MultiLineString")for(var $=0;$<pe.length;$++)Tn(ue,pe[$]);else if(j==="MultiPolygon")for($=0;$<pe.length;$++)for(var me=0;me<pe[$].length;me++)Tn(ue,pe[$][me])}(W),W}function Tn(L,U){for(var I=0;I<U.length;I+=3)L.minX=Math.min(L.minX,U[I]),L.minY=Math.min(L.minY,U[I+1]),L.maxX=Math.max(L.maxX,U[I]),L.maxY=Math.max(L.maxY,U[I+1])}function ni(L,U,I,V){if(U.geometry){var W=U.geometry.coordinates,ue=U.geometry.type,pe=Math.pow(I.tolerance/((1<<I.maxZoom)*I.extent),2),j=[],$=U.id;if(I.promoteId?$=U.properties[I.promoteId]:I.generateId&&($=V||0),ue==="Point")vr(W,j);else if(ue==="MultiPoint")for(var me=0;me<W.length;me++)vr(W[me],j);else if(ue==="LineString")gi(W,j,pe,!1);else if(ue==="MultiLineString"){if(I.lineMetrics){for(me=0;me<W.length;me++)gi(W[me],j=[],pe,!1),L.push(hi($,"LineString",j,U.properties));return}pi(W,j,pe,!1)}else if(ue==="Polygon")pi(W,j,pe,!0);else{if(ue!=="MultiPolygon"){if(ue==="GeometryCollection"){for(me=0;me<U.geometry.geometries.length;me++)ni(L,{id:$,geometry:U.geometry.geometries[me],properties:U.properties},I,V);return}throw new Error("Input data is not a valid GeoJSON object.")}for(me=0;me<W.length;me++){var Ce=[];pi(W[me],Ce,pe,!0),j.push(Ce)}}L.push(hi($,ue,j,U.properties))}}function vr(L,U){U.push(Vr(L[0])),U.push(Ji(L[1])),U.push(0)}function gi(L,U,I,V){for(var W,ue,pe=0,j=0;j<L.length;j++){var $=Vr(L[j][0]),me=Ji(L[j][1]);U.push($),U.push(me),U.push(0),j>0&&(pe+=V?(W*me-$*ue)/2:Math.sqrt(Math.pow($-W,2)+Math.pow(me-ue,2))),W=$,ue=me}var Ce=U.length-3;U[2]=1,function Oe(we,De,st,tt){for(var Se,He=tt,Ye=st-De>>1,Qe=st-De,Vt=we[De],it=we[De+1],Wt=we[st],jt=we[st+1],Ht=De+3;Ht<st;Ht+=3){var sr=Bn(we[Ht],we[Ht+1],Vt,it,Wt,jt);if(sr>He)Se=Ht,He=sr;else if(sr===He){var er=Math.abs(Ht-Ye);er<Qe&&(Se=Ht,Qe=er)}}He>tt&&(Se-De>3&&Oe(we,De,Se,tt),we[Se+2]=He,st-Se>3&&Oe(we,Se,st,tt))}(U,0,Ce,I),U[Ce+2]=1,U.size=Math.abs(pe),U.start=0,U.end=U.size}function pi(L,U,I,V){for(var W=0;W<L.length;W++){var ue=[];gi(L[W],ue,I,V),U.push(ue)}}function Vr(L){return L/360+.5}function Ji(L){var U=Math.sin(L*Math.PI/180),I=.5-.25*Math.log((1+U)/(1-U))/Math.PI;return I<0?0:I>1?1:I}function Kr(L,U,I,V,W,ue,pe,j){if(V/=U,ue>=(I/=U)&&pe<V)return L;if(pe<I||ue>=V)return null;for(var $=[],me=0;me<L.length;me++){var Ce=L[me],Oe=Ce.geometry,we=Ce.type,De=W===0?Ce.minX:Ce.minY,st=W===0?Ce.maxX:Ce.maxY;if(De>=I&&st<V)$.push(Ce);else if(!(st<I||De>=V)){var tt=[];if(we==="Point"||we==="MultiPoint")In(Oe,tt,I,V,W);else if(we==="LineString")Qi(Oe,tt,I,V,W,!1,j.lineMetrics);else if(we==="MultiLineString")Oi(Oe,tt,I,V,W,!1);else if(we==="Polygon")Oi(Oe,tt,I,V,W,!0);else if(we==="MultiPolygon")for(var Se=0;Se<Oe.length;Se++){var He=[];Oi(Oe[Se],He,I,V,W,!0),He.length&&tt.push(He)}if(tt.length){if(j.lineMetrics&&we==="LineString"){for(Se=0;Se<tt.length;Se++)$.push(hi(Ce.id,we,tt[Se],Ce.tags));continue}we!=="LineString"&&we!=="MultiLineString"||(tt.length===1?(we="LineString",tt=tt[0]):we="MultiLineString"),we!=="Point"&&we!=="MultiPoint"||(we=tt.length===3?"Point":"MultiPoint"),$.push(hi(Ce.id,we,tt,Ce.tags))}}}return $.length?$:null}function In(L,U,I,V,W){for(var ue=0;ue<L.length;ue+=3){var pe=L[ue+W];pe>=I&&pe<=V&&(U.push(L[ue]),U.push(L[ue+1]),U.push(L[ue+2]))}}function Qi(L,U,I,V,W,ue,pe){for(var j,$,me=Fn(L),Ce=W===0?$i:zn,Oe=L.start,we=0;we<L.length-3;we+=3){var De=L[we],st=L[we+1],tt=L[we+2],Se=L[we+3],He=L[we+4],Ye=W===0?De:st,Qe=W===0?Se:He,Vt=!1;pe&&(j=Math.sqrt(Math.pow(De-Se,2)+Math.pow(st-He,2))),Ye<I?Qe>I&&($=Ce(me,De,st,Se,He,I),pe&&(me.start=Oe+j*$)):Ye>V?Qe<V&&($=Ce(me,De,st,Se,He,V),pe&&(me.start=Oe+j*$)):Pn(me,De,st,tt),Qe<I&&Ye>=I&&($=Ce(me,De,st,Se,He,I),Vt=!0),Qe>V&&Ye<=V&&($=Ce(me,De,st,Se,He,V),Vt=!0),!ue&&Vt&&(pe&&(me.end=Oe+j*$),U.push(me),me=Fn(L)),pe&&(Oe+=j)}var it=L.length-3;De=L[it],st=L[it+1],tt=L[it+2],(Ye=W===0?De:st)>=I&&Ye<=V&&Pn(me,De,st,tt),it=me.length-3,ue&&it>=3&&(me[it]!==me[0]||me[it+1]!==me[1])&&Pn(me,me[0],me[1],me[2]),me.length&&U.push(me)}function Fn(L){var U=[];return U.size=L.size,U.start=L.start,U.end=L.end,U}function Oi(L,U,I,V,W,ue){for(var pe=0;pe<L.length;pe++)Qi(L[pe],U,I,V,W,ue,!1)}function Pn(L,U,I,V){L.push(U),L.push(I),L.push(V)}function $i(L,U,I,V,W,ue){var pe=(ue-U)/(V-U);return L.push(ue),L.push(I+(W-I)*pe),L.push(1),pe}function zn(L,U,I,V,W,ue){var pe=(ue-I)/(W-I);return L.push(U+(V-U)*pe),L.push(ue),L.push(1),pe}function Ni(L,U){for(var I=[],V=0;V<L.length;V++){var W,ue=L[V],pe=ue.type;if(pe==="Point"||pe==="MultiPoint"||pe==="LineString")W=mn(ue.geometry,U);else if(pe==="MultiLineString"||pe==="Polygon"){W=[];for(var j=0;j<ue.geometry.length;j++)W.push(mn(ue.geometry[j],U))}else if(pe==="MultiPolygon")for(W=[],j=0;j<ue.geometry.length;j++){for(var $=[],me=0;me<ue.geometry[j].length;me++)$.push(mn(ue.geometry[j][me],U));W.push($)}I.push(hi(ue.id,pe,W,ue.tags))}return I}function mn(L,U){var I=[];I.size=L.size,L.start!==void 0&&(I.start=L.start,I.end=L.end);for(var V=0;V<L.length;V+=3)I.push(L[V]+U,L[V+1],L[V+2]);return I}function Ui(L,U){if(L.transformed)return L;var I,V,W,ue=1<<L.z,pe=L.x,j=L.y;for(I=0;I<L.features.length;I++){var $=L.features[I],me=$.geometry,Ce=$.type;if($.geometry=[],Ce===1)for(V=0;V<me.length;V+=2)$.geometry.push(Vi(me[V],me[V+1],U,ue,pe,j));else for(V=0;V<me.length;V++){var Oe=[];for(W=0;W<me[V].length;W+=2)Oe.push(Vi(me[V][W],me[V][W+1],U,ue,pe,j));$.geometry.push(Oe)}}return L.transformed=!0,L}function Vi(L,U,I,V,W,ue){return[Math.round(I*(L*V-W)),Math.round(I*(U*V-ue))]}function Qr(L,U,I,V,W){for(var ue=U===W.maxZoom?0:W.tolerance/((1<<U)*W.extent),pe={features:[],numPoints:0,numSimplified:0,numFeatures:0,source:null,x:I,y:V,z:U,transformed:!1,minX:2,minY:1,maxX:-1,maxY:0},j=0;j<L.length;j++){pe.numFeatures++,ia(pe,L[j],ue,W);var $=L[j].minX,me=L[j].minY,Ce=L[j].maxX,Oe=L[j].maxY;$<pe.minX&&(pe.minX=$),me<pe.minY&&(pe.minY=me),Ce>pe.maxX&&(pe.maxX=Ce),Oe>pe.maxY&&(pe.maxY=Oe)}return pe}function ia(L,U,I,V){var W=U.geometry,ue=U.type,pe=[];if(ue==="Point"||ue==="MultiPoint")for(var j=0;j<W.length;j+=3)pe.push(W[j]),pe.push(W[j+1]),L.numPoints++,L.numSimplified++;else if(ue==="LineString")ln(pe,W,L,I,!1,!1);else if(ue==="MultiLineString"||ue==="Polygon")for(j=0;j<W.length;j++)ln(pe,W[j],L,I,ue==="Polygon",j===0);else if(ue==="MultiPolygon")for(var $=0;$<W.length;$++){var me=W[$];for(j=0;j<me.length;j++)ln(pe,me[j],L,I,!0,j===0)}if(pe.length){var Ce=U.tags||null;if(ue==="LineString"&&V.lineMetrics){for(var Oe in Ce={},U.tags)Ce[Oe]=U.tags[Oe];Ce.mapbox_clip_start=W.start/W.size,Ce.mapbox_clip_end=W.end/W.size}var we={geometry:pe,type:ue==="Polygon"||ue==="MultiPolygon"?3:ue==="LineString"||ue==="MultiLineString"?2:1,tags:Ce};U.id!==null&&(we.id=U.id),L.features.push(we)}}function ln(L,U,I,V,W,ue){var pe=V*V;if(V>0&&U.size<(W?pe:V))I.numPoints+=U.length/3;else{for(var j=[],$=0;$<U.length;$+=3)(V===0||U[$+2]>pe)&&(I.numSimplified++,j.push(U[$]),j.push(U[$+1])),I.numPoints++;W&&function(me,Ce){for(var Oe=0,we=0,De=me.length,st=De-2;we<De;st=we,we+=2)Oe+=(me[we]-me[st])*(me[we+1]+me[st+1]);if(Oe>0===Ce)for(we=0,De=me.length;we<De/2;we+=2){var tt=me[we],Se=me[we+1];me[we]=me[De-2-we],me[we+1]=me[De-1-we],me[De-2-we]=tt,me[De-1-we]=Se}}(j,ue),L.push(j)}}function $r(L,U){var I=(U=this.options=function(W,ue){for(var pe in ue)W[pe]=ue[pe];return W}(Object.create(this.options),U)).debug;if(I&&console.time("preprocess data"),U.maxZoom<0||U.maxZoom>24)throw new Error("maxZoom should be in the 0-24 range");if(U.promoteId&&U.generateId)throw new Error("promoteId and generateId cannot be used together.");var V=function(W,ue){var pe=[];if(W.type==="FeatureCollection")for(var j=0;j<W.features.length;j++)ni(pe,W.features[j],ue,j);else ni(pe,W.type==="Feature"?W:{geometry:W},ue);return pe}(L,U);this.tiles={},this.tileCoords=[],I&&(console.timeEnd("preprocess data"),console.log("index: maxZoom: %d, maxPoints: %d",U.indexMaxZoom,U.indexMaxPoints),console.time("generate tiles"),this.stats={},this.total=0),(V=function(W,ue){var pe=ue.buffer/ue.extent,j=W,$=Kr(W,1,-1-pe,pe,0,-1,2,ue),me=Kr(W,1,1-pe,2+pe,0,-1,2,ue);return($||me)&&(j=Kr(W,1,-pe,1+pe,0,-1,2,ue)||[],$&&(j=Ni($,1).concat(j)),me&&(j=j.concat(Ni(me,-1)))),j}(V,U)).length&&this.splitTile(V,0,0,0),I&&(V.length&&console.log("features: %d, points: %d",this.tiles[0].numFeatures,this.tiles[0].numPoints),console.timeEnd("generate tiles"),console.log("tiles generated:",this.total,JSON.stringify(this.stats)))}function yn(L,U,I){return 32*((1<<L)*I+U)+L}function On(L,U){var I=L.tileID.canonical;if(!this._geoJSONIndex)return U(null,null);var V=this._geoJSONIndex.getTile(I.z,I.x,I.y);if(!V)return U(null,null);var W=new ze(V.features),ue=Ze(W);ue.byteOffset===0&&ue.byteLength===ue.buffer.byteLength||(ue=new Uint8Array(ue)),U(null,{vectorTile:W,rawData:ue.buffer})}ar.prototype.load=function(L){var U=this.options,I=U.log,V=U.minZoom,W=U.maxZoom,ue=U.nodeSize;I&&console.time("total time");var pe="prepare "+L.length+" points";I&&console.time(pe),this.points=L;for(var j=[],$=0;$<L.length;$++)L[$].geometry&&j.push(Gt(L[$],$));this.trees[W+1]=new wi(j,ci,Jr,ue,Float32Array),I&&console.timeEnd(pe);for(var me=W;me>=V;me--){var Ce=+Date.now();j=this._cluster(j,me),this.trees[me]=new wi(j,ci,Jr,ue,Float32Array),I&&console.log("z%d: %d clusters in %dms",me,j.length,+Date.now()-Ce)}return I&&console.timeEnd("total time"),this},ar.prototype.getClusters=function(L,U){var I=((L[0]+180)%360+360)%360-180,V=Math.max(-90,Math.min(90,L[1])),W=L[2]===180?180:((L[2]+180)%360+360)%360-180,ue=Math.max(-90,Math.min(90,L[3]));if(L[2]-L[0]>=360)I=-180,W=180;else if(I>W){var pe=this.getClusters([I,V,180,ue],U),j=this.getClusters([-180,V,W,ue],U);return pe.concat(j)}for(var $=this.trees[this._limitZoom(U)],me=[],Ce=0,Oe=$.range(ti(I),Nt(ue),ti(W),Nt(V));Ce<Oe.length;Ce+=1){var we=$.points[Oe[Ce]];me.push(we.numPoints?Si(we):this.points[we.index])}return me},ar.prototype.getChildren=function(L){var U=this._getOriginId(L),I=this._getOriginZoom(L),V="No cluster with the specified id.",W=this.trees[I];if(!W)throw new Error(V);var ue=W.points[U];if(!ue)throw new Error(V);for(var pe=this.options.radius/(this.options.extent*Math.pow(2,I-1)),j=[],$=0,me=W.within(ue.x,ue.y,pe);$<me.length;$+=1){var Ce=W.points[me[$]];Ce.parentId===L&&j.push(Ce.numPoints?Si(Ce):this.points[Ce.index])}if(j.length===0)throw new Error(V);return j},ar.prototype.getLeaves=function(L,U,I){var V=[];return this._appendLeaves(V,L,U=U||10,I=I||0,0),V},ar.prototype.getTile=function(L,U,I){var V=this.trees[this._limitZoom(L)],W=Math.pow(2,L),ue=this.options,pe=ue.radius/ue.extent,j=(I-pe)/W,$=(I+1+pe)/W,me={features:[]};return this._addTileFeatures(V.range((U-pe)/W,j,(U+1+pe)/W,$),V.points,U,I,W,me),U===0&&this._addTileFeatures(V.range(1-pe/W,j,1,$),V.points,W,I,W,me),U===W-1&&this._addTileFeatures(V.range(0,j,pe/W,$),V.points,-1,I,W,me),me.features.length?me:null},ar.prototype.getClusterExpansionZoom=function(L){for(var U=this._getOriginZoom(L)-1;U<=this.options.maxZoom;){var I=this.getChildren(L);if(U++,I.length!==1)break;L=I[0].properties.cluster_id}return U},ar.prototype._appendLeaves=function(L,U,I,V,W){for(var ue=0,pe=this.getChildren(U);ue<pe.length;ue+=1){var j=pe[ue],$=j.properties;if($&&$.cluster?W+$.point_count<=V?W+=$.point_count:W=this._appendLeaves(L,$.cluster_id,I,V,W):W<V?W++:L.push(j),L.length===I)break}return W},ar.prototype._addTileFeatures=function(L,U,I,V,W,ue){for(var pe=0,j=L;pe<j.length;pe+=1){var $=U[j[pe]],me=$.numPoints,Ce={type:1,geometry:[[Math.round(this.options.extent*($.x*W-I)),Math.round(this.options.extent*($.y*W-V))]],tags:me?Jn($):this.points[$.index].properties},Oe=void 0;me?Oe=$.id:this.options.generateId?Oe=$.index:this.points[$.index].id&&(Oe=this.points[$.index].id),Oe!==void 0&&(Ce.id=Oe),ue.features.push(Ce)}},ar.prototype._limitZoom=function(L){return Math.max(this.options.minZoom,Math.min(+L,this.options.maxZoom+1))},ar.prototype._cluster=function(L,U){for(var I=[],V=this.options,W=V.reduce,ue=V.minPoints,pe=V.radius/(V.extent*Math.pow(2,U)),j=0;j<L.length;j++){var $=L[j];if(!($.zoom<=U)){$.zoom=U;for(var me=this.trees[U+1],Ce=me.within($.x,$.y,pe),Oe=$.numPoints||1,we=Oe,De=0,st=Ce;De<st.length;De+=1){var tt=me.points[st[De]];tt.zoom>U&&(we+=tt.numPoints||1)}if(we>=ue){for(var Se=$.x*Oe,He=$.y*Oe,Ye=W&&Oe>1?this._map($,!0):null,Qe=(j<<5)+(U+1)+this.points.length,Vt=0,it=Ce;Vt<it.length;Vt+=1){var Wt=me.points[it[Vt]];if(!(Wt.zoom<=U)){Wt.zoom=U;var jt=Wt.numPoints||1;Se+=Wt.x*jt,He+=Wt.y*jt,Wt.parentId=Qe,W&&(Ye||(Ye=this._map($,!0)),W(Ye,this._map(Wt)))}}$.parentId=Qe,I.push(Sr(Se/we,He/we,Qe,we,Ye))}else if(I.push($),we>1)for(var Ht=0,sr=Ce;Ht<sr.length;Ht+=1){var er=me.points[sr[Ht]];er.zoom<=U||(er.zoom=U,I.push(er))}}}return I},ar.prototype._getOriginId=function(L){return L-this.points.length>>5},ar.prototype._getOriginZoom=function(L){return(L-this.points.length)%32},ar.prototype._map=function(L,U){if(L.numPoints)return U?dn({},L.properties):L.properties;var I=this.points[L.index].properties,V=this.options.map(I);return U&&V===I?dn({},V):V},$r.prototype.options={maxZoom:14,indexMaxZoom:5,indexMaxPoints:1e5,tolerance:3,extent:4096,buffer:64,lineMetrics:!1,promoteId:null,generateId:!1,debug:0},$r.prototype.splitTile=function(L,U,I,V,W,ue,pe){for(var j=[L,U,I,V],$=this.options,me=$.debug;j.length;){V=j.pop(),I=j.pop(),U=j.pop(),L=j.pop();var Ce=1<<U,Oe=yn(U,I,V),we=this.tiles[Oe];if(!we&&(me>1&&console.time("creation"),we=this.tiles[Oe]=Qr(L,U,I,V,$),this.tileCoords.push({z:U,x:I,y:V}),me)){me>1&&(console.log("tile z%d-%d-%d (features: %d, points: %d, simplified: %d)",U,I,V,we.numFeatures,we.numPoints,we.numSimplified),console.timeEnd("creation"));var De="z"+U;this.stats[De]=(this.stats[De]||0)+1,this.total++}if(we.source=L,W){if(U===$.maxZoom||U===W)continue;var st=1<<W-U;if(I!==Math.floor(ue/st)||V!==Math.floor(pe/st))continue}else if(U===$.indexMaxZoom||we.numPoints<=$.indexMaxPoints)continue;if(we.source=null,L.length!==0){me>1&&console.time("clipping");var tt,Se,He,Ye,Qe,Vt,it=.5*$.buffer/$.extent,Wt=.5-it,jt=.5+it,Ht=1+it;tt=Se=He=Ye=null,Qe=Kr(L,Ce,I-it,I+jt,0,we.minX,we.maxX,$),Vt=Kr(L,Ce,I+Wt,I+Ht,0,we.minX,we.maxX,$),L=null,Qe&&(tt=Kr(Qe,Ce,V-it,V+jt,1,we.minY,we.maxY,$),Se=Kr(Qe,Ce,V+Wt,V+Ht,1,we.minY,we.maxY,$),Qe=null),Vt&&(He=Kr(Vt,Ce,V-it,V+jt,1,we.minY,we.maxY,$),Ye=Kr(Vt,Ce,V+Wt,V+Ht,1,we.minY,we.maxY,$),Vt=null),me>1&&console.timeEnd("clipping"),j.push(tt||[],U+1,2*I,2*V),j.push(Se||[],U+1,2*I,2*V+1),j.push(He||[],U+1,2*I+1,2*V),j.push(Ye||[],U+1,2*I+1,2*V+1)}}},$r.prototype.getTile=function(L,U,I){var V=this.options,W=V.extent,ue=V.debug;if(L<0||L>24)return null;var pe=1<<L,j=yn(L,U=(U%pe+pe)%pe,I);if(this.tiles[j])return Ui(this.tiles[j],W);ue>1&&console.log("drilling down to z%d-%d-%d",L,U,I);for(var $,me=L,Ce=U,Oe=I;!$&&me>0;)me--,Ce=Math.floor(Ce/2),Oe=Math.floor(Oe/2),$=this.tiles[yn(me,Ce,Oe)];return $&&$.source?(ue>1&&console.log("found parent tile z%d-%d-%d",me,Ce,Oe),ue>1&&console.time("drilling down"),this.splitTile($.source,me,Ce,Oe,L,U,I),ue>1&&console.timeEnd("drilling down"),this.tiles[j]?Ui(this.tiles[j],W):null):null};var Br=function(L){function U(I,V,W,ue){L.call(this,I,V,W,On),ue&&(this.loadGeoJSON=ue)}return L&&(U.__proto__=L),(U.prototype=Object.create(L&&L.prototype)).constructor=U,U.prototype.loadData=function(I,V){this._pendingCallback&&this._pendingCallback(null,{abandoned:!0}),this._pendingCallback=V,this._pendingLoadDataParams=I,this._state&&this._state!=="Idle"?this._state="NeedsLoadData":(this._state="Coalescing",this._loadData())},U.prototype._loadData=function(){var I=this;if(this._pendingCallback&&this._pendingLoadDataParams){var V=this._pendingCallback,W=this._pendingLoadDataParams;delete this._pendingCallback,delete this._pendingLoadDataParams;var ue=!!(W&&W.request&&W.request.collectResourceTiming)&&new a.RequestPerformance(W.request);this.loadGeoJSON(W,function(pe,j){if(pe||!j)return V(pe);if(typeof j!="object")return V(new Error("Input data given to '"+W.source+"' is not a valid GeoJSON object."));(function we(De,st){var tt,Se=De&&De.type;if(Se==="FeatureCollection")for(tt=0;tt<De.features.length;tt++)we(De.features[tt],st);else if(Se==="GeometryCollection")for(tt=0;tt<De.geometries.length;tt++)we(De.geometries[tt],st);else if(Se==="Feature")we(De.geometry,st);else if(Se==="Polygon")de(De.coordinates,st);else if(Se==="MultiPolygon")for(tt=0;tt<De.coordinates.length;tt++)de(De.coordinates[tt],st);return De})(j,!0);try{if(W.filter){var $=a.createExpression(W.filter,{type:"boolean","property-type":"data-driven",overridable:!1,transition:!1});if($.result==="error")throw new Error($.value.map(function(we){return we.key+": "+we.message}).join(", "));var me=j.features.filter(function(we){return $.value.evaluate({zoom:0},we)});j={type:"FeatureCollection",features:me}}I._geoJSONIndex=W.cluster?new ar(function(we){var De=we.superclusterOptions,st=we.clusterProperties;if(!st||!De)return De;for(var tt={},Se={},He={accumulated:null,zoom:0},Ye={properties:null},Qe=Object.keys(st),Vt=0,it=Qe;Vt<it.length;Vt+=1){var Wt=it[Vt],jt=st[Wt],Ht=jt[0],sr=a.createExpression(jt[1]),er=a.createExpression(typeof Ht=="string"?[Ht,["accumulated"],["get",Wt]]:Ht);tt[Wt]=sr.value,Se[Wt]=er.value}return De.map=function(_i){Ye.properties=_i;for(var dr={},Fr=0,_r=Qe;Fr<_r.length;Fr+=1){var Jt=_r[Fr];dr[Jt]=tt[Jt].evaluate(He,Ye)}return dr},De.reduce=function(_i,dr){Ye.properties=dr;for(var Fr=0,_r=Qe;Fr<_r.length;Fr+=1){var Jt=_r[Fr];He.accumulated=_i[Jt],_i[Jt]=Se[Jt].evaluate(He,Ye)}},De}(W)).load(j.features):function(we,De){return new $r(we,De)}(j,W.geojsonVtOptions)}catch(we){return V(we)}I.loaded={};var Ce={};if(ue){var Oe=ue.finish();Oe&&(Ce.resourceTiming={},Ce.resourceTiming[W.source]=JSON.parse(JSON.stringify(Oe)))}V(null,Ce)})}},U.prototype.coalesce=function(){this._state==="Coalescing"?this._state="Idle":this._state==="NeedsLoadData"&&(this._state="Coalescing",this._loadData())},U.prototype.reloadTile=function(I,V){var W=this.loaded;return W&&W[I.uid]?L.prototype.reloadTile.call(this,I,V):this.loadTile(I,V)},U.prototype.loadGeoJSON=function(I,V){if(I.request)a.getJSON(I.request,V);else{if(typeof I.data!="string")return V(new Error("Input data given to '"+I.source+"' is not a valid GeoJSON object."));try{return V(null,JSON.parse(I.data))}catch{return V(new Error("Input data given to '"+I.source+"' is not a valid GeoJSON object."))}}},U.prototype.removeSource=function(I,V){this._pendingCallback&&this._pendingCallback(null,{abandoned:!0}),V()},U.prototype.getClusterExpansionZoom=function(I,V){try{V(null,this._geoJSONIndex.getClusterExpansionZoom(I.clusterId))}catch(W){V(W)}},U.prototype.getClusterChildren=function(I,V){try{V(null,this._geoJSONIndex.getChildren(I.clusterId))}catch(W){V(W)}},U.prototype.getClusterLeaves=function(I,V){try{V(null,this._geoJSONIndex.getLeaves(I.clusterId,I.limit,I.offset))}catch(W){V(W)}},U}(Q),Pr=function(L){var U=this;this.self=L,this.actor=new a.Actor(L,this),this.layerIndexes={},this.availableImages={},this.workerSourceTypes={vector:Q,geojson:Br},this.workerSources={},this.demWorkerSources={},this.self.registerWorkerSource=function(I,V){if(U.workerSourceTypes[I])throw new Error('Worker source with name "'+I+'" already registered.');U.workerSourceTypes[I]=V},this.self.registerRTLTextPlugin=function(I){if(a.plugin.isParsed())throw new Error("RTL text plugin already registered.");a.plugin.applyArabicShaping=I.applyArabicShaping,a.plugin.processBidirectionalText=I.processBidirectionalText,a.plugin.processStyledBidirectionalText=I.processStyledBidirectionalText}};return Pr.prototype.setReferrer=function(L,U){this.referrer=U},Pr.prototype.setImages=function(L,U,I){for(var V in this.availableImages[L]=U,this.workerSources[L]){var W=this.workerSources[L][V];for(var ue in W)W[ue].availableImages=U}I()},Pr.prototype.setLayers=function(L,U,I){this.getLayerIndex(L).replace(U),I()},Pr.prototype.updateLayers=function(L,U,I){this.getLayerIndex(L).update(U.layers,U.removedIds),I()},Pr.prototype.loadTile=function(L,U,I){this.getWorkerSource(L,U.type,U.source).loadTile(U,I)},Pr.prototype.loadDEMTile=function(L,U,I){this.getDEMWorkerSource(L,U.source).loadTile(U,I)},Pr.prototype.reloadTile=function(L,U,I){this.getWorkerSource(L,U.type,U.source).reloadTile(U,I)},Pr.prototype.abortTile=function(L,U,I){this.getWorkerSource(L,U.type,U.source).abortTile(U,I)},Pr.prototype.removeTile=function(L,U,I){this.getWorkerSource(L,U.type,U.source).removeTile(U,I)},Pr.prototype.removeDEMTile=function(L,U){this.getDEMWorkerSource(L,U.source).removeTile(U)},Pr.prototype.removeSource=function(L,U,I){if(this.workerSources[L]&&this.workerSources[L][U.type]&&this.workerSources[L][U.type][U.source]){var V=this.workerSources[L][U.type][U.source];delete this.workerSources[L][U.type][U.source],V.removeSource!==void 0?V.removeSource(U,I):I()}},Pr.prototype.loadWorkerSource=function(L,U,I){try{this.self.importScripts(U.url),I()}catch(V){I(V.toString())}},Pr.prototype.syncRTLPluginState=function(L,U,I){try{a.plugin.setState(U);var V=a.plugin.getPluginURL();if(a.plugin.isLoaded()&&!a.plugin.isParsed()&&V!=null){this.self.importScripts(V);var W=a.plugin.isParsed();I(W?void 0:new Error("RTL Text Plugin failed to import scripts from "+V),W)}}catch(ue){I(ue.toString())}},Pr.prototype.getAvailableImages=function(L){var U=this.availableImages[L];return U||(U=[]),U},Pr.prototype.getLayerIndex=function(L){var U=this.layerIndexes[L];return U||(U=this.layerIndexes[L]=new F),U},Pr.prototype.getWorkerSource=function(L,U,I){var V=this;return this.workerSources[L]||(this.workerSources[L]={}),this.workerSources[L][U]||(this.workerSources[L][U]={}),this.workerSources[L][U][I]||(this.workerSources[L][U][I]=new this.workerSourceTypes[U]({send:function(W,ue,pe){V.actor.send(W,ue,pe,L)}},this.getLayerIndex(L),this.getAvailableImages(L))),this.workerSources[L][U][I]},Pr.prototype.getDEMWorkerSource=function(L,U){return this.demWorkerSources[L]||(this.demWorkerSources[L]={}),this.demWorkerSources[L][U]||(this.demWorkerSources[L][U]=new le),this.demWorkerSources[L][U]},Pr.prototype.enforceCacheSizeLimit=function(L,U){a.enforceCacheSizeLimit(U)},typeof WorkerGlobalScope<"u"&&typeof self<"u"&&self instanceof WorkerGlobalScope&&(self.worker=new Pr(self)),Pr}),v(["./shared"],function(a){var k=a.createCommonjsModule(function(n){function s(_){return!o(_)}function o(_){return typeof window>"u"||typeof document>"u"?"not a browser":Array.prototype&&Array.prototype.every&&Array.prototype.filter&&Array.prototype.forEach&&Array.prototype.indexOf&&Array.prototype.lastIndexOf&&Array.prototype.map&&Array.prototype.some&&Array.prototype.reduce&&Array.prototype.reduceRight&&Array.isArray?Function.prototype&&Function.prototype.bind?Object.keys&&Object.create&&Object.getPrototypeOf&&Object.getOwnPropertyNames&&Object.isSealed&&Object.isFrozen&&Object.isExtensible&&Object.getOwnPropertyDescriptor&&Object.defineProperty&&Object.defineProperties&&Object.seal&&Object.freeze&&Object.preventExtensions?"JSON"in window&&"parse"in JSON&&"stringify"in JSON?function(){if(!("Worker"in window&&"Blob"in window&&"URL"in window))return!1;var S,P,C=new Blob([""],{type:"text/javascript"}),O=URL.createObjectURL(C);try{P=new Worker(O),S=!0}catch{S=!1}return P&&P.terminate(),URL.revokeObjectURL(O),S}()?"Uint8ClampedArray"in window?ArrayBuffer.isView?function(){var S=document.createElement("canvas");S.width=S.height=1;var P=S.getContext("2d");if(!P)return!1;var C=P.getImageData(0,0,1,1);return C&&C.width===S.width}()?(c[w=_&&_.failIfMajorPerformanceCaveat]===void 0&&(c[w]=function(S){var P=function(O){var Z=document.createElement("canvas"),K=Object.create(s.webGLContextAttributes);return K.failIfMajorPerformanceCaveat=O,Z.probablySupportsContext?Z.probablySupportsContext("webgl",K)||Z.probablySupportsContext("experimental-webgl",K):Z.supportsContext?Z.supportsContext("webgl",K)||Z.supportsContext("experimental-webgl",K):Z.getContext("webgl",K)||Z.getContext("experimental-webgl",K)}(S);if(!P)return!1;var C=P.createShader(P.VERTEX_SHADER);return!(!C||P.isContextLost())&&(P.shaderSource(C,"void main() {}"),P.compileShader(C),P.getShaderParameter(C,P.COMPILE_STATUS)===!0)}(w)),c[w]?void 0:"insufficient WebGL support"):"insufficient Canvas/getImageData support":"insufficient ArrayBuffer support":"insufficient Uint8ClampedArray support":"insufficient worker support":"insufficient JSON support":"insufficient Object support":"insufficient Function support":"insufficent Array support";var w}n.exports?n.exports=s:window&&(window.mapboxgl=window.mapboxgl||{},window.mapboxgl.supported=s,window.mapboxgl.notSupportedReason=o);var c={};s.webGLContextAttributes={antialias:!1,alpha:!0,stencil:!0,depth:!0}}),T={create:function(n,s,o){var c=a.window.document.createElement(n);return s!==void 0&&(c.className=s),o&&o.appendChild(c),c},createNS:function(n,s){return a.window.document.createElementNS(n,s)}},F=a.window.document&&a.window.document.documentElement.style;function M(n){if(!F)return n[0];for(var s=0;s<n.length;s++)if(n[s]in F)return n[s];return n[0]}var N,R=M(["userSelect","MozUserSelect","WebkitUserSelect","msUserSelect"]);T.disableDrag=function(){F&&R&&(N=F[R],F[R]="none")},T.enableDrag=function(){F&&R&&(F[R]=N)};var X=M(["transform","WebkitTransform"]);T.setTransform=function(n,s){n.style[X]=s};var Q=!1;try{var ae=Object.defineProperty({},"passive",{get:function(){Q=!0}});a.window.addEventListener("test",ae,ae),a.window.removeEventListener("test",ae,ae)}catch{Q=!1}T.addEventListener=function(n,s,o,c){c===void 0&&(c={}),n.addEventListener(s,o,"passive"in c&&Q?c:c.capture)},T.removeEventListener=function(n,s,o,c){c===void 0&&(c={}),n.removeEventListener(s,o,"passive"in c&&Q?c:c.capture)};var le=function(n){n.preventDefault(),n.stopPropagation(),a.window.removeEventListener("click",le,!0)};function de(n){var s=n.userImage;return!!(s&&s.render&&s.render())&&(n.data.replace(new Uint8Array(s.data.buffer)),!0)}T.suppressClick=function(){a.window.addEventListener("click",le,!0),a.window.setTimeout(function(){a.window.removeEventListener("click",le,!0)},0)},T.mousePos=function(n,s){var o=n.getBoundingClientRect();return new a.Point(s.clientX-o.left-n.clientLeft,s.clientY-o.top-n.clientTop)},T.touchPos=function(n,s){for(var o=n.getBoundingClientRect(),c=[],_=0;_<s.length;_++)c.push(new a.Point(s[_].clientX-o.left-n.clientLeft,s[_].clientY-o.top-n.clientTop));return c},T.mouseButton=function(n){return a.window.InstallTrigger!==void 0&&n.button===2&&n.ctrlKey&&a.window.navigator.platform.toUpperCase().indexOf("MAC")>=0?0:n.button},T.remove=function(n){n.parentNode&&n.parentNode.removeChild(n)};var ge=function(n){function s(){n.call(this),this.images={},this.updatedImages={},this.callbackDispatchedThisFrame={},this.loaded=!1,this.requestors=[],this.patterns={},this.atlasImage=new a.RGBAImage({width:1,height:1}),this.dirty=!0}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype.isLoaded=function(){return this.loaded},s.prototype.setLoaded=function(o){if(this.loaded!==o&&(this.loaded=o,o)){for(var c=0,_=this.requestors;c<_.length;c+=1){var w=_[c];this._notify(w.ids,w.callback)}this.requestors=[]}},s.prototype.getImage=function(o){return this.images[o]},s.prototype.addImage=function(o,c){this._validate(o,c)&&(this.images[o]=c)},s.prototype._validate=function(o,c){var _=!0;return this._validateStretch(c.stretchX,c.data&&c.data.width)||(this.fire(new a.ErrorEvent(new Error('Image "'+o+'" has invalid "stretchX" value'))),_=!1),this._validateStretch(c.stretchY,c.data&&c.data.height)||(this.fire(new a.ErrorEvent(new Error('Image "'+o+'" has invalid "stretchY" value'))),_=!1),this._validateContent(c.content,c)||(this.fire(new a.ErrorEvent(new Error('Image "'+o+'" has invalid "content" value'))),_=!1),_},s.prototype._validateStretch=function(o,c){if(!o)return!0;for(var _=0,w=0,S=o;w<S.length;w+=1){var P=S[w];if(P[0]<_||P[1]<P[0]||c<P[1])return!1;_=P[1]}return!0},s.prototype._validateContent=function(o,c){return!(o&&(o.length!==4||o[0]<0||c.data.width<o[0]||o[1]<0||c.data.height<o[1]||o[2]<0||c.data.width<o[2]||o[3]<0||c.data.height<o[3]||o[2]<o[0]||o[3]<o[1]))},s.prototype.updateImage=function(o,c){c.version=this.images[o].version+1,this.images[o]=c,this.updatedImages[o]=!0},s.prototype.removeImage=function(o){var c=this.images[o];delete this.images[o],delete this.patterns[o],c.userImage&&c.userImage.onRemove&&c.userImage.onRemove()},s.prototype.listImages=function(){return Object.keys(this.images)},s.prototype.getImages=function(o,c){var _=!0;if(!this.isLoaded())for(var w=0,S=o;w<S.length;w+=1)this.images[S[w]]||(_=!1);this.isLoaded()||_?this._notify(o,c):this.requestors.push({ids:o,callback:c})},s.prototype._notify=function(o,c){for(var _={},w=0,S=o;w<S.length;w+=1){var P=S[w];this.images[P]||this.fire(new a.Event("styleimagemissing",{id:P}));var C=this.images[P];C?_[P]={data:C.data.clone(),pixelRatio:C.pixelRatio,sdf:C.sdf,version:C.version,stretchX:C.stretchX,stretchY:C.stretchY,content:C.content,hasRenderCallback:!!(C.userImage&&C.userImage.render)}:a.warnOnce('Image "'+P+'" could not be loaded. Please make sure you have added the image with map.addImage() or a "sprite" property in your style. You can provide missing images by listening for the "styleimagemissing" map event.')}c(null,_)},s.prototype.getPixelSize=function(){var o=this.atlasImage;return{width:o.width,height:o.height}},s.prototype.getPattern=function(o){var c=this.patterns[o],_=this.getImage(o);if(!_)return null;if(c&&c.position.version===_.version)return c.position;if(c)c.position.version=_.version;else{var w={w:_.data.width+2,h:_.data.height+2,x:0,y:0},S=new a.ImagePosition(w,_);this.patterns[o]={bin:w,position:S}}return this._updatePatternAtlas(),this.patterns[o].position},s.prototype.bind=function(o){var c=o.gl;this.atlasTexture?this.dirty&&(this.atlasTexture.update(this.atlasImage),this.dirty=!1):this.atlasTexture=new a.Texture(o,this.atlasImage,c.RGBA),this.atlasTexture.bind(c.LINEAR,c.CLAMP_TO_EDGE)},s.prototype._updatePatternAtlas=function(){var o=[];for(var c in this.patterns)o.push(this.patterns[c].bin);var _=a.potpack(o),w=_.w,S=_.h,P=this.atlasImage;for(var C in P.resize({width:w||1,height:S||1}),this.patterns){var O=this.patterns[C].bin,Z=O.x+1,K=O.y+1,H=this.images[C].data,re=H.width,te=H.height;a.RGBAImage.copy(H,P,{x:0,y:0},{x:Z,y:K},{width:re,height:te}),a.RGBAImage.copy(H,P,{x:0,y:te-1},{x:Z,y:K-1},{width:re,height:1}),a.RGBAImage.copy(H,P,{x:0,y:0},{x:Z,y:K+te},{width:re,height:1}),a.RGBAImage.copy(H,P,{x:re-1,y:0},{x:Z-1,y:K},{width:1,height:te}),a.RGBAImage.copy(H,P,{x:0,y:0},{x:Z+re,y:K},{width:1,height:te})}this.dirty=!0},s.prototype.beginFrame=function(){this.callbackDispatchedThisFrame={}},s.prototype.dispatchRenderCallbacks=function(o){for(var c=0,_=o;c<_.length;c+=1){var w=_[c];if(!this.callbackDispatchedThisFrame[w]){this.callbackDispatchedThisFrame[w]=!0;var S=this.images[w];de(S)&&this.updateImage(w,S)}}},s}(a.Evented),rt=Ge,Fe=Ge,ze=1e20;function Ge(n,s,o,c,_,w){this.fontSize=n||24,this.buffer=s===void 0?3:s,this.cutoff=c||.25,this.fontFamily=_||"sans-serif",this.fontWeight=w||"normal",this.radius=o||8;var S=this.size=this.fontSize+2*this.buffer;this.canvas=document.createElement("canvas"),this.canvas.width=this.canvas.height=S,this.ctx=this.canvas.getContext("2d"),this.ctx.font=this.fontWeight+" "+this.fontSize+"px "+this.fontFamily,this.ctx.textBaseline="middle",this.ctx.fillStyle="black",this.gridOuter=new Float64Array(S*S),this.gridInner=new Float64Array(S*S),this.f=new Float64Array(S),this.d=new Float64Array(S),this.z=new Float64Array(S+1),this.v=new Int16Array(S),this.middle=Math.round(S/2*(navigator.userAgent.indexOf("Gecko/")>=0?1.2:1))}function zt(n,s,o,c,_,w,S){for(var P=0;P<s;P++){for(var C=0;C<o;C++)c[C]=n[C*s+P];for(wt(c,_,w,S,o),C=0;C<o;C++)n[C*s+P]=_[C]}for(C=0;C<o;C++){for(P=0;P<s;P++)c[P]=n[C*s+P];for(wt(c,_,w,S,s),P=0;P<s;P++)n[C*s+P]=Math.sqrt(_[P])}}function wt(n,s,o,c,_){o[0]=0,c[0]=-ze,c[1]=+ze;for(var w=1,S=0;w<_;w++){for(var P=(n[w]+w*w-(n[o[S]]+o[S]*o[S]))/(2*w-2*o[S]);P<=c[S];)S--,P=(n[w]+w*w-(n[o[S]]+o[S]*o[S]))/(2*w-2*o[S]);o[++S]=w,c[S]=P,c[S+1]=+ze}for(w=0,S=0;w<_;w++){for(;c[S+1]<w;)S++;s[w]=(w-o[S])*(w-o[S])+n[o[S]]}}Ge.prototype.draw=function(n){this.ctx.clearRect(0,0,this.size,this.size),this.ctx.fillText(n,this.buffer,this.middle);for(var s=this.ctx.getImageData(0,0,this.size,this.size),o=new Uint8ClampedArray(this.size*this.size),c=0;c<this.size*this.size;c++){var _=s.data[4*c+3]/255;this.gridOuter[c]=_===1?0:_===0?ze:Math.pow(Math.max(0,.5-_),2),this.gridInner[c]=_===1?ze:_===0?0:Math.pow(Math.max(0,_-.5),2)}for(zt(this.gridOuter,this.size,this.size,this.f,this.d,this.v,this.z),zt(this.gridInner,this.size,this.size,this.f,this.d,this.v,this.z),c=0;c<this.size*this.size;c++)o[c]=Math.max(0,Math.min(255,Math.round(255-255*((this.gridOuter[c]-this.gridInner[c])/this.radius+this.cutoff))));return o},rt.default=Fe;var je=function(n,s){this.requestManager=n,this.localIdeographFontFamily=s,this.entries={}};je.prototype.setURL=function(n){this.url=n},je.prototype.getGlyphs=function(n,s){var o=this,c=[];for(var _ in n)for(var w=0,S=n[_];w<S.length;w+=1)c.push({stack:_,id:S[w]});a.asyncAll(c,function(P,C){var O=P.stack,Z=P.id,K=o.entries[O];K||(K=o.entries[O]={glyphs:{},requests:{},ranges:{}});var H=K.glyphs[Z];if(H===void 0){if(H=o._tinySDF(K,O,Z))return K.glyphs[Z]=H,void C(null,{stack:O,id:Z,glyph:H});var re=Math.floor(Z/256);if(256*re>65535)C(new Error("glyphs > 65535 not supported"));else if(K.ranges[re])C(null,{stack:O,id:Z,glyph:H});else{var te=K.requests[re];te||(te=K.requests[re]=[],je.loadGlyphRange(O,re,o.url,o.requestManager,function(ce,Y){if(Y){for(var se in Y)o._doesCharSupportLocalGlyph(+se)||(K.glyphs[+se]=Y[+se]);K.ranges[re]=!0}for(var fe=0,ve=te;fe<ve.length;fe+=1)(0,ve[fe])(ce,Y);delete K.requests[re]})),te.push(function(ce,Y){ce?C(ce):Y&&C(null,{stack:O,id:Z,glyph:Y[Z]||null})})}}else C(null,{stack:O,id:Z,glyph:H})},function(P,C){if(P)s(P);else if(C){for(var O={},Z=0,K=C;Z<K.length;Z+=1){var H=K[Z],re=H.stack,te=H.id,ce=H.glyph;(O[re]||(O[re]={}))[te]=ce&&{id:ce.id,bitmap:ce.bitmap.clone(),metrics:ce.metrics}}s(null,O)}})},je.prototype._doesCharSupportLocalGlyph=function(n){return!!this.localIdeographFontFamily&&(a.isChar["CJK Unified Ideographs"](n)||a.isChar["Hangul Syllables"](n)||a.isChar.Hiragana(n)||a.isChar.Katakana(n))},je.prototype._tinySDF=function(n,s,o){var c=this.localIdeographFontFamily;if(c&&this._doesCharSupportLocalGlyph(o)){var _=n.tinySDF;if(!_){var w="400";/bold/i.test(s)?w="900":/medium/i.test(s)?w="500":/light/i.test(s)&&(w="200"),_=n.tinySDF=new je.TinySDF(24,3,8,.25,c,w)}return{id:o,bitmap:new a.AlphaImage({width:30,height:30},_.draw(String.fromCharCode(o))),metrics:{width:24,height:24,left:0,top:-8,advance:24}}}},je.loadGlyphRange=function(n,s,o,c,_){var w=256*s,S=w+255,P=c.transformRequest(c.normalizeGlyphsURL(o).replace("{fontstack}",n).replace("{range}",w+"-"+S),a.ResourceType.Glyphs);a.getArrayBuffer(P,function(C,O){if(C)_(C);else if(O){for(var Z={},K=0,H=a.parseGlyphPBF(O);K<H.length;K+=1){var re=H[K];Z[re.id]=re}_(null,Z)}})},je.TinySDF=rt;var Ze=function(){this.specification=a.styleSpec.light.position};Ze.prototype.possiblyEvaluate=function(n,s){return a.sphericalToCartesian(n.expression.evaluate(s))},Ze.prototype.interpolate=function(n,s,o){return{x:a.number(n.x,s.x,o),y:a.number(n.y,s.y,o),z:a.number(n.z,s.z,o)}};var mt=new a.Properties({anchor:new a.DataConstantProperty(a.styleSpec.light.anchor),position:new Ze,color:new a.DataConstantProperty(a.styleSpec.light.color),intensity:new a.DataConstantProperty(a.styleSpec.light.intensity)}),nr=function(n){function s(o){n.call(this),this._transitionable=new a.Transitionable(mt),this.setLight(o),this._transitioning=this._transitionable.untransitioned()}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype.getLight=function(){return this._transitionable.serialize()},s.prototype.setLight=function(o,c){if(c===void 0&&(c={}),!this._validate(a.validateLight,o,c))for(var _ in o){var w=o[_];a.endsWith(_,"-transition")?this._transitionable.setTransition(_.slice(0,-11),w):this._transitionable.setValue(_,w)}},s.prototype.updateTransitions=function(o){this._transitioning=this._transitionable.transitioned(o,this._transitioning)},s.prototype.hasTransition=function(){return this._transitioning.hasTransition()},s.prototype.recalculate=function(o){this.properties=this._transitioning.possiblyEvaluate(o)},s.prototype._validate=function(o,c,_){return(!_||_.validate!==!1)&&a.emitValidationErrors(this,o.call(a.validateStyle,a.extend({value:c,style:{glyphs:!0,sprite:!0},styleSpec:a.styleSpec})))},s}(a.Evented),qe=function(n,s){this.width=n,this.height=s,this.nextRow=0,this.data=new Uint8Array(this.width*this.height),this.dashEntry={}};qe.prototype.getDash=function(n,s){var o=n.join(",")+String(s);return this.dashEntry[o]||(this.dashEntry[o]=this.addDash(n,s)),this.dashEntry[o]},qe.prototype.getDashRanges=function(n,s,o){var c=[],_=n.length%2==1?-n[n.length-1]*o:0,w=n[0]*o,S=!0;c.push({left:_,right:w,isDash:S,zeroLength:n[0]===0});for(var P=n[0],C=1;C<n.length;C++){var O=n[C];c.push({left:_=P*o,right:w=(P+=O)*o,isDash:S=!S,zeroLength:O===0})}return c},qe.prototype.addRoundDash=function(n,s,o){for(var c=s/2,_=-o;_<=o;_++)for(var w=this.width*(this.nextRow+o+_),S=0,P=n[S],C=0;C<this.width;C++){C/P.right>1&&(P=n[++S]);var O=Math.abs(C-P.left),Z=Math.abs(C-P.right),K=Math.min(O,Z),H=void 0,re=_/o*(c+1);if(P.isDash){var te=c-Math.abs(re);H=Math.sqrt(K*K+te*te)}else H=c-Math.sqrt(K*K+re*re);this.data[w+C]=Math.max(0,Math.min(255,H+128))}},qe.prototype.addRegularDash=function(n){for(var s=n.length-1;s>=0;--s){var o=n[s],c=n[s+1];o.zeroLength?n.splice(s,1):c&&c.isDash===o.isDash&&(c.left=o.left,n.splice(s,1))}var _=n[0],w=n[n.length-1];_.isDash===w.isDash&&(_.left=w.left-this.width,w.right=_.right+this.width);for(var S=this.width*this.nextRow,P=0,C=n[P],O=0;O<this.width;O++){O/C.right>1&&(C=n[++P]);var Z=Math.abs(O-C.left),K=Math.abs(O-C.right),H=Math.min(Z,K);this.data[S+O]=Math.max(0,Math.min(255,(C.isDash?H:-H)+128))}},qe.prototype.addDash=function(n,s){var o=s?7:0,c=2*o+1;if(this.nextRow+c>this.height)return a.warnOnce("LineAtlas out of space"),null;for(var _=0,w=0;w<n.length;w++)_+=n[w];if(_!==0){var S=this.width/_,P=this.getDashRanges(n,this.width,S);s?this.addRoundDash(P,S,o):this.addRegularDash(P)}var C={y:(this.nextRow+o+.5)/this.height,height:2*o/this.height,width:_};return this.nextRow+=c,this.dirty=!0,C},qe.prototype.bind=function(n){var s=n.gl;this.texture?(s.bindTexture(s.TEXTURE_2D,this.texture),this.dirty&&(this.dirty=!1,s.texSubImage2D(s.TEXTURE_2D,0,0,0,this.width,this.height,s.ALPHA,s.UNSIGNED_BYTE,this.data))):(this.texture=s.createTexture(),s.bindTexture(s.TEXTURE_2D,this.texture),s.texParameteri(s.TEXTURE_2D,s.TEXTURE_WRAP_S,s.REPEAT),s.texParameteri(s.TEXTURE_2D,s.TEXTURE_WRAP_T,s.REPEAT),s.texParameteri(s.TEXTURE_2D,s.TEXTURE_MIN_FILTER,s.LINEAR),s.texParameteri(s.TEXTURE_2D,s.TEXTURE_MAG_FILTER,s.LINEAR),s.texImage2D(s.TEXTURE_2D,0,s.ALPHA,this.width,this.height,0,s.ALPHA,s.UNSIGNED_BYTE,this.data))};var Bt=function n(s,o){this.workerPool=s,this.actors=[],this.currentActor=0,this.id=a.uniqueId();for(var c=this.workerPool.acquire(this.id),_=0;_<c.length;_++){var w=new n.Actor(c[_],o,this.id);w.name="Worker "+_,this.actors.push(w)}};function Re(n,s,o){var c=function(_,w){if(_)return o(_);if(w){var S=a.pick(a.extend(w,n),["tiles","minzoom","maxzoom","attribution","mapbox_logo","bounds","scheme","tileSize","encoding"]);w.vector_layers&&(S.vectorLayers=w.vector_layers,S.vectorLayerIds=S.vectorLayers.map(function(P){return P.id})),S.tiles=s.canonicalizeTileset(S,n.url),o(null,S)}};return n.url?a.getJSON(s.transformRequest(s.normalizeSourceURL(n.url),a.ResourceType.Source),c):a.browser.frame(function(){return c(null,n)})}Bt.prototype.broadcast=function(n,s,o){a.asyncAll(this.actors,function(c,_){c.send(n,s,_)},o=o||function(){})},Bt.prototype.getActor=function(){return this.currentActor=(this.currentActor+1)%this.actors.length,this.actors[this.currentActor]},Bt.prototype.remove=function(){this.actors.forEach(function(n){n.remove()}),this.actors=[],this.workerPool.release(this.id)},Bt.Actor=a.Actor;var et=function(n,s,o){this.bounds=a.LngLatBounds.convert(this.validateBounds(n)),this.minzoom=s||0,this.maxzoom=o||24};et.prototype.validateBounds=function(n){return Array.isArray(n)&&n.length===4?[Math.max(-180,n[0]),Math.max(-90,n[1]),Math.min(180,n[2]),Math.min(90,n[3])]:[-180,-90,180,90]},et.prototype.contains=function(n){var s=Math.pow(2,n.z),o=Math.floor(a.mercatorXfromLng(this.bounds.getWest())*s),c=Math.floor(a.mercatorYfromLat(this.bounds.getNorth())*s),_=Math.ceil(a.mercatorXfromLng(this.bounds.getEast())*s),w=Math.ceil(a.mercatorYfromLat(this.bounds.getSouth())*s);return n.x>=o&&n.x<_&&n.y>=c&&n.y<w};var dt=function(n){function s(o,c,_,w){if(n.call(this),this.id=o,this.dispatcher=_,this.type="vector",this.minzoom=0,this.maxzoom=22,this.scheme="xyz",this.tileSize=512,this.reparseOverscaled=!0,this.isTileClipped=!0,this._loaded=!1,a.extend(this,a.pick(c,["url","scheme","tileSize","promoteId"])),this._options=a.extend({type:"vector"},c),this._collectResourceTiming=c.collectResourceTiming,this.tileSize!==512)throw new Error("vector tile sources must have a tileSize of 512");this.setEventedParent(w)}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype.load=function(){var o=this;this._loaded=!1,this.fire(new a.Event("dataloading",{dataType:"source"})),this._tileJSONRequest=Re(this._options,this.map._requestManager,function(c,_){o._tileJSONRequest=null,o._loaded=!0,c?o.fire(new a.ErrorEvent(c)):_&&(a.extend(o,_),_.bounds&&(o.tileBounds=new et(_.bounds,o.minzoom,o.maxzoom)),a.postTurnstileEvent(_.tiles,o.map._requestManager._customAccessToken),a.postMapLoadEvent(_.tiles,o.map._getMapId(),o.map._requestManager._skuToken,o.map._requestManager._customAccessToken),o.fire(new a.Event("data",{dataType:"source",sourceDataType:"metadata"})),o.fire(new a.Event("data",{dataType:"source",sourceDataType:"content"})))})},s.prototype.loaded=function(){return this._loaded},s.prototype.hasTile=function(o){return!this.tileBounds||this.tileBounds.contains(o.canonical)},s.prototype.onAdd=function(o){this.map=o,this.load()},s.prototype.setSourceProperty=function(o){this._tileJSONRequest&&this._tileJSONRequest.cancel(),o(),this.map.style.sourceCaches[this.id].clearTiles(),this.load()},s.prototype.setTiles=function(o){var c=this;return this.setSourceProperty(function(){c._options.tiles=o}),this},s.prototype.setUrl=function(o){var c=this;return this.setSourceProperty(function(){c.url=o,c._options.url=o}),this},s.prototype.onRemove=function(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)},s.prototype.serialize=function(){return a.extend({},this._options)},s.prototype.loadTile=function(o,c){var _=this.map._requestManager.normalizeTileURL(o.tileID.canonical.url(this.tiles,this.scheme)),w={request:this.map._requestManager.transformRequest(_,a.ResourceType.Tile),uid:o.uid,tileID:o.tileID,zoom:o.tileID.overscaledZ,tileSize:this.tileSize*o.tileID.overscaleFactor(),type:this.type,source:this.id,pixelRatio:a.browser.devicePixelRatio,showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId};function S(P,C){return delete o.request,o.aborted?c(null):P&&P.status!==404?c(P):(C&&C.resourceTiming&&(o.resourceTiming=C.resourceTiming),this.map._refreshExpiredTiles&&C&&o.setExpiryData(C),o.loadVectorData(C,this.map.painter),a.cacheEntryPossiblyAdded(this.dispatcher),c(null),void(o.reloadCallback&&(this.loadTile(o,o.reloadCallback),o.reloadCallback=null)))}w.request.collectResourceTiming=this._collectResourceTiming,o.actor&&o.state!=="expired"?o.state==="loading"?o.reloadCallback=c:o.request=o.actor.send("reloadTile",w,S.bind(this)):(o.actor=this.dispatcher.getActor(),o.request=o.actor.send("loadTile",w,S.bind(this)))},s.prototype.abortTile=function(o){o.request&&(o.request.cancel(),delete o.request),o.actor&&o.actor.send("abortTile",{uid:o.uid,type:this.type,source:this.id},void 0)},s.prototype.unloadTile=function(o){o.unloadVectorData(),o.actor&&o.actor.send("removeTile",{uid:o.uid,type:this.type,source:this.id},void 0)},s.prototype.hasTransition=function(){return!1},s}(a.Evented),qt=function(n){function s(o,c,_,w){n.call(this),this.id=o,this.dispatcher=_,this.setEventedParent(w),this.type="raster",this.minzoom=0,this.maxzoom=22,this.roundZoom=!0,this.scheme="xyz",this.tileSize=512,this._loaded=!1,this._options=a.extend({type:"raster"},c),a.extend(this,a.pick(c,["url","scheme","tileSize"]))}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype.load=function(){var o=this;this._loaded=!1,this.fire(new a.Event("dataloading",{dataType:"source"})),this._tileJSONRequest=Re(this._options,this.map._requestManager,function(c,_){o._tileJSONRequest=null,o._loaded=!0,c?o.fire(new a.ErrorEvent(c)):_&&(a.extend(o,_),_.bounds&&(o.tileBounds=new et(_.bounds,o.minzoom,o.maxzoom)),a.postTurnstileEvent(_.tiles),a.postMapLoadEvent(_.tiles,o.map._getMapId(),o.map._requestManager._skuToken),o.fire(new a.Event("data",{dataType:"source",sourceDataType:"metadata"})),o.fire(new a.Event("data",{dataType:"source",sourceDataType:"content"})))})},s.prototype.loaded=function(){return this._loaded},s.prototype.onAdd=function(o){this.map=o,this.load()},s.prototype.onRemove=function(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)},s.prototype.serialize=function(){return a.extend({},this._options)},s.prototype.hasTile=function(o){return!this.tileBounds||this.tileBounds.contains(o.canonical)},s.prototype.loadTile=function(o,c){var _=this,w=this.map._requestManager.normalizeTileURL(o.tileID.canonical.url(this.tiles,this.scheme),this.tileSize);o.request=a.getImage(this.map._requestManager.transformRequest(w,a.ResourceType.Tile),function(S,P){if(delete o.request,o.aborted)o.state="unloaded",c(null);else if(S)o.state="errored",c(S);else if(P){_.map._refreshExpiredTiles&&o.setExpiryData(P),delete P.cacheControl,delete P.expires;var C=_.map.painter.context,O=C.gl;o.texture=_.map.painter.getTileTexture(P.width),o.texture?o.texture.update(P,{useMipmap:!0}):(o.texture=new a.Texture(C,P,O.RGBA,{useMipmap:!0}),o.texture.bind(O.LINEAR,O.CLAMP_TO_EDGE,O.LINEAR_MIPMAP_NEAREST),C.extTextureFilterAnisotropic&&O.texParameterf(O.TEXTURE_2D,C.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,C.extTextureFilterAnisotropicMax)),o.state="loaded",a.cacheEntryPossiblyAdded(_.dispatcher),c(null)}})},s.prototype.abortTile=function(o,c){o.request&&(o.request.cancel(),delete o.request),c()},s.prototype.unloadTile=function(o,c){o.texture&&this.map.painter.saveTileTexture(o.texture),c()},s.prototype.hasTransition=function(){return!1},s}(a.Evented),Mt=function(n){function s(o,c,_,w){n.call(this,o,c,_,w),this.type="raster-dem",this.maxzoom=22,this._options=a.extend({type:"raster-dem"},c),this.encoding=c.encoding||"mapbox"}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype.serialize=function(){return{type:"raster-dem",url:this.url,tileSize:this.tileSize,tiles:this.tiles,bounds:this.bounds,encoding:this.encoding}},s.prototype.loadTile=function(o,c){var _=this.map._requestManager.normalizeTileURL(o.tileID.canonical.url(this.tiles,this.scheme),this.tileSize);function w(S,P){S&&(o.state="errored",c(S)),P&&(o.dem=P,o.needsHillshadePrepare=!0,o.state="loaded",c(null))}o.request=a.getImage(this.map._requestManager.transformRequest(_,a.ResourceType.Tile),(function(S,P){if(delete o.request,o.aborted)o.state="unloaded",c(null);else if(S)o.state="errored",c(S);else if(P){this.map._refreshExpiredTiles&&o.setExpiryData(P),delete P.cacheControl,delete P.expires;var C=a.window.ImageBitmap&&P instanceof a.window.ImageBitmap&&a.offscreenCanvasSupported()?P:a.browser.getImageData(P,1),O={uid:o.uid,coord:o.tileID,source:this.id,rawImageData:C,encoding:this.encoding};o.actor&&o.state!=="expired"||(o.actor=this.dispatcher.getActor(),o.actor.send("loadDEMTile",O,w.bind(this)))}}).bind(this)),o.neighboringTiles=this._getNeighboringTiles(o.tileID)},s.prototype._getNeighboringTiles=function(o){var c=o.canonical,_=Math.pow(2,c.z),w=(c.x-1+_)%_,S=c.x===0?o.wrap-1:o.wrap,P=(c.x+1+_)%_,C=c.x+1===_?o.wrap+1:o.wrap,O={};return O[new a.OverscaledTileID(o.overscaledZ,S,c.z,w,c.y).key]={backfilled:!1},O[new a.OverscaledTileID(o.overscaledZ,C,c.z,P,c.y).key]={backfilled:!1},c.y>0&&(O[new a.OverscaledTileID(o.overscaledZ,S,c.z,w,c.y-1).key]={backfilled:!1},O[new a.OverscaledTileID(o.overscaledZ,o.wrap,c.z,c.x,c.y-1).key]={backfilled:!1},O[new a.OverscaledTileID(o.overscaledZ,C,c.z,P,c.y-1).key]={backfilled:!1}),c.y+1<_&&(O[new a.OverscaledTileID(o.overscaledZ,S,c.z,w,c.y+1).key]={backfilled:!1},O[new a.OverscaledTileID(o.overscaledZ,o.wrap,c.z,c.x,c.y+1).key]={backfilled:!1},O[new a.OverscaledTileID(o.overscaledZ,C,c.z,P,c.y+1).key]={backfilled:!1}),O},s.prototype.unloadTile=function(o){o.demTexture&&this.map.painter.saveTileTexture(o.demTexture),o.fbo&&(o.fbo.destroy(),delete o.fbo),o.dem&&delete o.dem,delete o.neighboringTiles,o.state="unloaded",o.actor&&o.actor.send("removeDEMTile",{uid:o.uid,source:this.id})},s}(qt),xt=function(n){function s(o,c,_,w){n.call(this),this.id=o,this.type="geojson",this.minzoom=0,this.maxzoom=18,this.tileSize=512,this.isTileClipped=!0,this.reparseOverscaled=!0,this._removed=!1,this._loaded=!1,this.actor=_.getActor(),this.setEventedParent(w),this._data=c.data,this._options=a.extend({},c),this._collectResourceTiming=c.collectResourceTiming,this._resourceTiming=[],c.maxzoom!==void 0&&(this.maxzoom=c.maxzoom),c.type&&(this.type=c.type),c.attribution&&(this.attribution=c.attribution),this.promoteId=c.promoteId;var S=a.EXTENT/this.tileSize;this.workerOptions=a.extend({source:this.id,cluster:c.cluster||!1,geojsonVtOptions:{buffer:(c.buffer!==void 0?c.buffer:128)*S,tolerance:(c.tolerance!==void 0?c.tolerance:.375)*S,extent:a.EXTENT,maxZoom:this.maxzoom,lineMetrics:c.lineMetrics||!1,generateId:c.generateId||!1},superclusterOptions:{maxZoom:c.clusterMaxZoom!==void 0?Math.min(c.clusterMaxZoom,this.maxzoom-1):this.maxzoom-1,minPoints:Math.max(2,c.clusterMinPoints||2),extent:a.EXTENT,radius:(c.clusterRadius||50)*S,log:!1,generateId:c.generateId||!1},clusterProperties:c.clusterProperties,filter:c.filter},c.workerOptions)}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype.load=function(){var o=this;this.fire(new a.Event("dataloading",{dataType:"source"})),this._updateWorkerData(function(c){if(c)o.fire(new a.ErrorEvent(c));else{var _={dataType:"source",sourceDataType:"metadata"};o._collectResourceTiming&&o._resourceTiming&&o._resourceTiming.length>0&&(_.resourceTiming=o._resourceTiming,o._resourceTiming=[]),o.fire(new a.Event("data",_))}})},s.prototype.onAdd=function(o){this.map=o,this.load()},s.prototype.setData=function(o){var c=this;return this._data=o,this.fire(new a.Event("dataloading",{dataType:"source"})),this._updateWorkerData(function(_){if(_)c.fire(new a.ErrorEvent(_));else{var w={dataType:"source",sourceDataType:"content"};c._collectResourceTiming&&c._resourceTiming&&c._resourceTiming.length>0&&(w.resourceTiming=c._resourceTiming,c._resourceTiming=[]),c.fire(new a.Event("data",w))}}),this},s.prototype.getClusterExpansionZoom=function(o,c){return this.actor.send("geojson.getClusterExpansionZoom",{clusterId:o,source:this.id},c),this},s.prototype.getClusterChildren=function(o,c){return this.actor.send("geojson.getClusterChildren",{clusterId:o,source:this.id},c),this},s.prototype.getClusterLeaves=function(o,c,_,w){return this.actor.send("geojson.getClusterLeaves",{source:this.id,clusterId:o,limit:c,offset:_},w),this},s.prototype._updateWorkerData=function(o){var c=this;this._loaded=!1;var _=a.extend({},this.workerOptions),w=this._data;typeof w=="string"?(_.request=this.map._requestManager.transformRequest(a.browser.resolveURL(w),a.ResourceType.Source),_.request.collectResourceTiming=this._collectResourceTiming):_.data=JSON.stringify(w),this.actor.send(this.type+".loadData",_,function(S,P){c._removed||P&&P.abandoned||(c._loaded=!0,P&&P.resourceTiming&&P.resourceTiming[c.id]&&(c._resourceTiming=P.resourceTiming[c.id].slice(0)),c.actor.send(c.type+".coalesce",{source:_.source},null),o(S))})},s.prototype.loaded=function(){return this._loaded},s.prototype.loadTile=function(o,c){var _=this,w=o.actor?"reloadTile":"loadTile";o.actor=this.actor,o.request=this.actor.send(w,{type:this.type,uid:o.uid,tileID:o.tileID,zoom:o.tileID.overscaledZ,maxZoom:this.maxzoom,tileSize:this.tileSize,source:this.id,pixelRatio:a.browser.devicePixelRatio,showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId},function(S,P){return delete o.request,o.unloadVectorData(),o.aborted?c(null):S?c(S):(o.loadVectorData(P,_.map.painter,w==="reloadTile"),c(null))})},s.prototype.abortTile=function(o){o.request&&(o.request.cancel(),delete o.request),o.aborted=!0},s.prototype.unloadTile=function(o){o.unloadVectorData(),this.actor.send("removeTile",{uid:o.uid,type:this.type,source:this.id})},s.prototype.onRemove=function(){this._removed=!0,this.actor.send("removeSource",{type:this.type,source:this.id})},s.prototype.serialize=function(){return a.extend({},this._options,{type:this.type,data:this._data})},s.prototype.hasTransition=function(){return!1},s}(a.Evented),Ae=a.createLayout([{name:"a_pos",type:"Int16",components:2},{name:"a_texture_pos",type:"Int16",components:2}]),at=function(n){function s(o,c,_,w){n.call(this),this.id=o,this.dispatcher=_,this.coordinates=c.coordinates,this.type="image",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this.tiles={},this._loaded=!1,this.setEventedParent(w),this.options=c}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype.load=function(o,c){var _=this;this._loaded=!1,this.fire(new a.Event("dataloading",{dataType:"source"})),this.url=this.options.url,a.getImage(this.map._requestManager.transformRequest(this.url,a.ResourceType.Image),function(w,S){_._loaded=!0,w?_.fire(new a.ErrorEvent(w)):S&&(_.image=S,o&&(_.coordinates=o),c&&c(),_._finishLoading())})},s.prototype.loaded=function(){return this._loaded},s.prototype.updateImage=function(o){var c=this;return this.image&&o.url?(this.options.url=o.url,this.load(o.coordinates,function(){c.texture=null}),this):this},s.prototype._finishLoading=function(){this.map&&(this.setCoordinates(this.coordinates),this.fire(new a.Event("data",{dataType:"source",sourceDataType:"metadata"})))},s.prototype.onAdd=function(o){this.map=o,this.load()},s.prototype.setCoordinates=function(o){var c=this;this.coordinates=o;var _=o.map(a.MercatorCoordinate.fromLngLat);this.tileID=function(S){for(var P=1/0,C=1/0,O=-1/0,Z=-1/0,K=0,H=S;K<H.length;K+=1){var re=H[K];P=Math.min(P,re.x),C=Math.min(C,re.y),O=Math.max(O,re.x),Z=Math.max(Z,re.y)}var te=Math.max(O-P,Z-C),ce=Math.max(0,Math.floor(-Math.log(te)/Math.LN2)),Y=Math.pow(2,ce);return new a.CanonicalTileID(ce,Math.floor((P+O)/2*Y),Math.floor((C+Z)/2*Y))}(_),this.minzoom=this.maxzoom=this.tileID.z;var w=_.map(function(S){return c.tileID.getTilePoint(S)._round()});return this._boundsArray=new a.StructArrayLayout4i8,this._boundsArray.emplaceBack(w[0].x,w[0].y,0,0),this._boundsArray.emplaceBack(w[1].x,w[1].y,a.EXTENT,0),this._boundsArray.emplaceBack(w[3].x,w[3].y,0,a.EXTENT),this._boundsArray.emplaceBack(w[2].x,w[2].y,a.EXTENT,a.EXTENT),this.boundsBuffer&&(this.boundsBuffer.destroy(),delete this.boundsBuffer),this.fire(new a.Event("data",{dataType:"source",sourceDataType:"content"})),this},s.prototype.prepare=function(){if(Object.keys(this.tiles).length!==0&&this.image){var o=this.map.painter.context,c=o.gl;for(var _ in this.boundsBuffer||(this.boundsBuffer=o.createVertexBuffer(this._boundsArray,Ae.members)),this.boundsSegments||(this.boundsSegments=a.SegmentVector.simpleSegment(0,0,4,2)),this.texture||(this.texture=new a.Texture(o,this.image,c.RGBA),this.texture.bind(c.LINEAR,c.CLAMP_TO_EDGE)),this.tiles){var w=this.tiles[_];w.state!=="loaded"&&(w.state="loaded",w.texture=this.texture)}}},s.prototype.loadTile=function(o,c){this.tileID&&this.tileID.equals(o.tileID.canonical)?(this.tiles[String(o.tileID.wrap)]=o,o.buckets={},c(null)):(o.state="errored",c(null))},s.prototype.serialize=function(){return{type:"image",url:this.options.url,coordinates:this.coordinates}},s.prototype.hasTransition=function(){return!1},s}(a.Evented),Mr=function(n){function s(o,c,_,w){n.call(this,o,c,_,w),this.roundZoom=!0,this.type="video",this.options=c}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype.load=function(){var o=this;this._loaded=!1;var c=this.options;this.urls=[];for(var _=0,w=c.urls;_<w.length;_+=1)this.urls.push(this.map._requestManager.transformRequest(w[_],a.ResourceType.Source).url);a.getVideo(this.urls,function(S,P){o._loaded=!0,S?o.fire(new a.ErrorEvent(S)):P&&(o.video=P,o.video.loop=!0,o.video.addEventListener("playing",function(){o.map.triggerRepaint()}),o.map&&o.video.play(),o._finishLoading())})},s.prototype.pause=function(){this.video&&this.video.pause()},s.prototype.play=function(){this.video&&this.video.play()},s.prototype.seek=function(o){if(this.video){var c=this.video.seekable;o<c.start(0)||o>c.end(0)?this.fire(new a.ErrorEvent(new a.ValidationError("sources."+this.id,null,"Playback for this video can be set only between the "+c.start(0)+" and "+c.end(0)+"-second mark."))):this.video.currentTime=o}},s.prototype.getVideo=function(){return this.video},s.prototype.onAdd=function(o){this.map||(this.map=o,this.load(),this.video&&(this.video.play(),this.setCoordinates(this.coordinates)))},s.prototype.prepare=function(){if(!(Object.keys(this.tiles).length===0||this.video.readyState<2)){var o=this.map.painter.context,c=o.gl;for(var _ in this.boundsBuffer||(this.boundsBuffer=o.createVertexBuffer(this._boundsArray,Ae.members)),this.boundsSegments||(this.boundsSegments=a.SegmentVector.simpleSegment(0,0,4,2)),this.texture?this.video.paused||(this.texture.bind(c.LINEAR,c.CLAMP_TO_EDGE),c.texSubImage2D(c.TEXTURE_2D,0,0,0,c.RGBA,c.UNSIGNED_BYTE,this.video)):(this.texture=new a.Texture(o,this.video,c.RGBA),this.texture.bind(c.LINEAR,c.CLAMP_TO_EDGE)),this.tiles){var w=this.tiles[_];w.state!=="loaded"&&(w.state="loaded",w.texture=this.texture)}}},s.prototype.serialize=function(){return{type:"video",urls:this.urls,coordinates:this.coordinates}},s.prototype.hasTransition=function(){return this.video&&!this.video.paused},s}(at),Zr=function(n){function s(o,c,_,w){n.call(this,o,c,_,w),c.coordinates?Array.isArray(c.coordinates)&&c.coordinates.length===4&&!c.coordinates.some(function(S){return!Array.isArray(S)||S.length!==2||S.some(function(P){return typeof P!="number"})})||this.fire(new a.ErrorEvent(new a.ValidationError("sources."+o,null,'"coordinates" property must be an array of 4 longitude/latitude array pairs'))):this.fire(new a.ErrorEvent(new a.ValidationError("sources."+o,null,'missing required property "coordinates"'))),c.animate&&typeof c.animate!="boolean"&&this.fire(new a.ErrorEvent(new a.ValidationError("sources."+o,null,'optional "animate" property must be a boolean value'))),c.canvas?typeof c.canvas=="string"||c.canvas instanceof a.window.HTMLCanvasElement||this.fire(new a.ErrorEvent(new a.ValidationError("sources."+o,null,'"canvas" must be either a string representing the ID of the canvas element from which to read, or an HTMLCanvasElement instance'))):this.fire(new a.ErrorEvent(new a.ValidationError("sources."+o,null,'missing required property "canvas"'))),this.options=c,this.animate=c.animate===void 0||c.animate}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype.load=function(){this._loaded=!0,this.canvas||(this.canvas=this.options.canvas instanceof a.window.HTMLCanvasElement?this.options.canvas:a.window.document.getElementById(this.options.canvas)),this.width=this.canvas.width,this.height=this.canvas.height,this._hasInvalidDimensions()?this.fire(new a.ErrorEvent(new Error("Canvas dimensions cannot be less than or equal to zero."))):(this.play=function(){this._playing=!0,this.map.triggerRepaint()},this.pause=function(){this._playing&&(this.prepare(),this._playing=!1)},this._finishLoading())},s.prototype.getCanvas=function(){return this.canvas},s.prototype.onAdd=function(o){this.map=o,this.load(),this.canvas&&this.animate&&this.play()},s.prototype.onRemove=function(){this.pause()},s.prototype.prepare=function(){var o=!1;if(this.canvas.width!==this.width&&(this.width=this.canvas.width,o=!0),this.canvas.height!==this.height&&(this.height=this.canvas.height,o=!0),!this._hasInvalidDimensions()&&Object.keys(this.tiles).length!==0){var c=this.map.painter.context,_=c.gl;for(var w in this.boundsBuffer||(this.boundsBuffer=c.createVertexBuffer(this._boundsArray,Ae.members)),this.boundsSegments||(this.boundsSegments=a.SegmentVector.simpleSegment(0,0,4,2)),this.texture?(o||this._playing)&&this.texture.update(this.canvas,{premultiply:!0}):this.texture=new a.Texture(c,this.canvas,_.RGBA,{premultiply:!0}),this.tiles){var S=this.tiles[w];S.state!=="loaded"&&(S.state="loaded",S.texture=this.texture)}}},s.prototype.serialize=function(){return{type:"canvas",coordinates:this.coordinates}},s.prototype.hasTransition=function(){return this._playing},s.prototype._hasInvalidDimensions=function(){for(var o=0,c=[this.canvas.width,this.canvas.height];o<c.length;o+=1){var _=c[o];if(isNaN(_)||_<=0)return!0}return!1},s}(at),wi={vector:dt,raster:qt,"raster-dem":Mt,geojson:xt,video:Mr,image:at,canvas:Zr};function Rr(n,s){var o=a.identity([]);return a.translate(o,o,[1,1,0]),a.scale(o,o,[.5*n.width,.5*n.height,1]),a.multiply(o,o,n.calculatePosMatrix(s.toUnwrapped()))}function ar(n,s,o,c,_,w){var S=function(ce,Y,se){if(ce)for(var fe=0,ve=ce;fe<ve.length;fe+=1){var Ie=Y[ve[fe]];if(Ie&&Ie.source===se&&Ie.type==="fill-extrusion")return!0}else for(var ke in Y){var Pe=Y[ke];if(Pe.source===se&&Pe.type==="fill-extrusion")return!0}return!1}(_&&_.layers,s,n.id),P=w.maxPitchScaleFactor(),C=n.tilesIn(c,P,S);C.sort(Sr);for(var O=[],Z=0,K=C;Z<K.length;Z+=1){var H=K[Z];O.push({wrappedTileID:H.tileID.wrapped().key,queryResults:H.tile.queryRenderedFeatures(s,o,n._state,H.queryGeometry,H.cameraQueryGeometry,H.scale,_,w,P,Rr(n.transform,H.tileID))})}var re=function(ce){for(var Y={},se={},fe=0,ve=ce;fe<ve.length;fe+=1){var Ie=ve[fe],ke=Ie.queryResults,Pe=Ie.wrappedTileID,Ne=se[Pe]=se[Pe]||{};for(var Je in ke)for(var Xe=ke[Je],ct=Ne[Je]=Ne[Je]||{},Et=Y[Je]=Y[Je]||[],Ct=0,At=Xe;Ct<At.length;Ct+=1){var yr=At[Ct];ct[yr.featureIndex]||(ct[yr.featureIndex]=!0,Et.push(yr))}}return Y}(O);for(var te in re)re[te].forEach(function(ce){var Y=ce.feature,se=n.getFeatureState(Y.layer["source-layer"],Y.id);Y.source=Y.layer.source,Y.layer["source-layer"]&&(Y.sourceLayer=Y.layer["source-layer"]),Y.state=se});return re}function Sr(n,s){var o=n.tileID,c=s.tileID;return o.overscaledZ-c.overscaledZ||o.canonical.y-c.canonical.y||o.wrap-c.wrap||o.canonical.x-c.canonical.x}var Gt=function(n,s){this.max=n,this.onRemove=s,this.reset()};Gt.prototype.reset=function(){for(var n in this.data)for(var s=0,o=this.data[n];s<o.length;s+=1){var c=o[s];c.timeout&&clearTimeout(c.timeout),this.onRemove(c.value)}return this.data={},this.order=[],this},Gt.prototype.add=function(n,s,o){var c=this,_=n.wrapped().key;this.data[_]===void 0&&(this.data[_]=[]);var w={value:s,timeout:void 0};if(o!==void 0&&(w.timeout=setTimeout(function(){c.remove(n,w)},o)),this.data[_].push(w),this.order.push(_),this.order.length>this.max){var S=this._getAndRemoveByKey(this.order[0]);S&&this.onRemove(S)}return this},Gt.prototype.has=function(n){return n.wrapped().key in this.data},Gt.prototype.getAndRemove=function(n){return this.has(n)?this._getAndRemoveByKey(n.wrapped().key):null},Gt.prototype._getAndRemoveByKey=function(n){var s=this.data[n].shift();return s.timeout&&clearTimeout(s.timeout),this.data[n].length===0&&delete this.data[n],this.order.splice(this.order.indexOf(n),1),s.value},Gt.prototype.getByKey=function(n){var s=this.data[n];return s?s[0].value:null},Gt.prototype.get=function(n){return this.has(n)?this.data[n.wrapped().key][0].value:null},Gt.prototype.remove=function(n,s){if(!this.has(n))return this;var o=n.wrapped().key,c=s===void 0?0:this.data[o].indexOf(s),_=this.data[o][c];return this.data[o].splice(c,1),_.timeout&&clearTimeout(_.timeout),this.data[o].length===0&&delete this.data[o],this.onRemove(_.value),this.order.splice(this.order.indexOf(o),1),this},Gt.prototype.setMaxSize=function(n){for(this.max=n;this.order.length>this.max;){var s=this._getAndRemoveByKey(this.order[0]);s&&this.onRemove(s)}return this},Gt.prototype.filter=function(n){var s=[];for(var o in this.data)for(var c=0,_=this.data[o];c<_.length;c+=1){var w=_[c];n(w.value)||s.push(w)}for(var S=0,P=s;S<P.length;S+=1){var C=P[S];this.remove(C.value.tileID,C)}};var Si=function(n,s,o){this.context=n;var c=n.gl;this.buffer=c.createBuffer(),this.dynamicDraw=!!o,this.context.unbindVAO(),n.bindElementBuffer.set(this.buffer),c.bufferData(c.ELEMENT_ARRAY_BUFFER,s.arrayBuffer,this.dynamicDraw?c.DYNAMIC_DRAW:c.STATIC_DRAW),this.dynamicDraw||delete s.arrayBuffer};Si.prototype.bind=function(){this.context.bindElementBuffer.set(this.buffer)},Si.prototype.updateData=function(n){var s=this.context.gl;this.context.unbindVAO(),this.bind(),s.bufferSubData(s.ELEMENT_ARRAY_BUFFER,0,n.arrayBuffer)},Si.prototype.destroy=function(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)};var Jn={Int8:"BYTE",Uint8:"UNSIGNED_BYTE",Int16:"SHORT",Uint16:"UNSIGNED_SHORT",Int32:"INT",Uint32:"UNSIGNED_INT",Float32:"FLOAT"},ti=function(n,s,o,c){this.length=s.length,this.attributes=o,this.itemSize=s.bytesPerElement,this.dynamicDraw=c,this.context=n;var _=n.gl;this.buffer=_.createBuffer(),n.bindVertexBuffer.set(this.buffer),_.bufferData(_.ARRAY_BUFFER,s.arrayBuffer,this.dynamicDraw?_.DYNAMIC_DRAW:_.STATIC_DRAW),this.dynamicDraw||delete s.arrayBuffer};ti.prototype.bind=function(){this.context.bindVertexBuffer.set(this.buffer)},ti.prototype.updateData=function(n){var s=this.context.gl;this.bind(),s.bufferSubData(s.ARRAY_BUFFER,0,n.arrayBuffer)},ti.prototype.enableAttributes=function(n,s){for(var o=0;o<this.attributes.length;o++){var c=s.attributes[this.attributes[o].name];c!==void 0&&n.enableVertexAttribArray(c)}},ti.prototype.setVertexAttribPointers=function(n,s,o){for(var c=0;c<this.attributes.length;c++){var _=this.attributes[c],w=s.attributes[_.name];w!==void 0&&n.vertexAttribPointer(w,_.components,n[Jn[_.type]],!1,this.itemSize,_.offset+this.itemSize*(o||0))}},ti.prototype.destroy=function(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)};var Nt=function(n){this.gl=n.gl,this.default=this.getDefault(),this.current=this.default,this.dirty=!1};Nt.prototype.get=function(){return this.current},Nt.prototype.set=function(n){},Nt.prototype.getDefault=function(){return this.default},Nt.prototype.setDefault=function(){this.set(this.default)};var dn=function(n){function s(){n.apply(this,arguments)}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype.getDefault=function(){return a.Color.transparent},s.prototype.set=function(o){var c=this.current;(o.r!==c.r||o.g!==c.g||o.b!==c.b||o.a!==c.a||this.dirty)&&(this.gl.clearColor(o.r,o.g,o.b,o.a),this.current=o,this.dirty=!1)},s}(Nt),ci=function(n){function s(){n.apply(this,arguments)}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype.getDefault=function(){return 1},s.prototype.set=function(o){(o!==this.current||this.dirty)&&(this.gl.clearDepth(o),this.current=o,this.dirty=!1)},s}(Nt),Jr=function(n){function s(){n.apply(this,arguments)}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype.getDefault=function(){return 0},s.prototype.set=function(o){(o!==this.current||this.dirty)&&(this.gl.clearStencil(o),this.current=o,this.dirty=!1)},s}(Nt),Bn=function(n){function s(){n.apply(this,arguments)}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype.getDefault=function(){return[!0,!0,!0,!0]},s.prototype.set=function(o){var c=this.current;(o[0]!==c[0]||o[1]!==c[1]||o[2]!==c[2]||o[3]!==c[3]||this.dirty)&&(this.gl.colorMask(o[0],o[1],o[2],o[3]),this.current=o,this.dirty=!1)},s}(Nt),hi=function(n){function s(){n.apply(this,arguments)}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype.getDefault=function(){return!0},s.prototype.set=function(o){(o!==this.current||this.dirty)&&(this.gl.depthMask(o),this.current=o,this.dirty=!1)},s}(Nt),Tn=function(n){function s(){n.apply(this,arguments)}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype.getDefault=function(){return 255},s.prototype.set=function(o){(o!==this.current||this.dirty)&&(this.gl.stencilMask(o),this.current=o,this.dirty=!1)},s}(Nt),ni=function(n){function s(){n.apply(this,arguments)}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype.getDefault=function(){return{func:this.gl.ALWAYS,ref:0,mask:255}},s.prototype.set=function(o){var c=this.current;(o.func!==c.func||o.ref!==c.ref||o.mask!==c.mask||this.dirty)&&(this.gl.stencilFunc(o.func,o.ref,o.mask),this.current=o,this.dirty=!1)},s}(Nt),vr=function(n){function s(){n.apply(this,arguments)}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype.getDefault=function(){var o=this.gl;return[o.KEEP,o.KEEP,o.KEEP]},s.prototype.set=function(o){var c=this.current;(o[0]!==c[0]||o[1]!==c[1]||o[2]!==c[2]||this.dirty)&&(this.gl.stencilOp(o[0],o[1],o[2]),this.current=o,this.dirty=!1)},s}(Nt),gi=function(n){function s(){n.apply(this,arguments)}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype.getDefault=function(){return!1},s.prototype.set=function(o){if(o!==this.current||this.dirty){var c=this.gl;o?c.enable(c.STENCIL_TEST):c.disable(c.STENCIL_TEST),this.current=o,this.dirty=!1}},s}(Nt),pi=function(n){function s(){n.apply(this,arguments)}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype.getDefault=function(){return[0,1]},s.prototype.set=function(o){var c=this.current;(o[0]!==c[0]||o[1]!==c[1]||this.dirty)&&(this.gl.depthRange(o[0],o[1]),this.current=o,this.dirty=!1)},s}(Nt),Vr=function(n){function s(){n.apply(this,arguments)}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype.getDefault=function(){return!1},s.prototype.set=function(o){if(o!==this.current||this.dirty){var c=this.gl;o?c.enable(c.DEPTH_TEST):c.disable(c.DEPTH_TEST),this.current=o,this.dirty=!1}},s}(Nt),Ji=function(n){function s(){n.apply(this,arguments)}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype.getDefault=function(){return this.gl.LESS},s.prototype.set=function(o){(o!==this.current||this.dirty)&&(this.gl.depthFunc(o),this.current=o,this.dirty=!1)},s}(Nt),Kr=function(n){function s(){n.apply(this,arguments)}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype.getDefault=function(){return!1},s.prototype.set=function(o){if(o!==this.current||this.dirty){var c=this.gl;o?c.enable(c.BLEND):c.disable(c.BLEND),this.current=o,this.dirty=!1}},s}(Nt),In=function(n){function s(){n.apply(this,arguments)}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype.getDefault=function(){var o=this.gl;return[o.ONE,o.ZERO]},s.prototype.set=function(o){var c=this.current;(o[0]!==c[0]||o[1]!==c[1]||this.dirty)&&(this.gl.blendFunc(o[0],o[1]),this.current=o,this.dirty=!1)},s}(Nt),Qi=function(n){function s(){n.apply(this,arguments)}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype.getDefault=function(){return a.Color.transparent},s.prototype.set=function(o){var c=this.current;(o.r!==c.r||o.g!==c.g||o.b!==c.b||o.a!==c.a||this.dirty)&&(this.gl.blendColor(o.r,o.g,o.b,o.a),this.current=o,this.dirty=!1)},s}(Nt),Fn=function(n){function s(){n.apply(this,arguments)}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype.getDefault=function(){return this.gl.FUNC_ADD},s.prototype.set=function(o){(o!==this.current||this.dirty)&&(this.gl.blendEquation(o),this.current=o,this.dirty=!1)},s}(Nt),Oi=function(n){function s(){n.apply(this,arguments)}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype.getDefault=function(){return!1},s.prototype.set=function(o){if(o!==this.current||this.dirty){var c=this.gl;o?c.enable(c.CULL_FACE):c.disable(c.CULL_FACE),this.current=o,this.dirty=!1}},s}(Nt),Pn=function(n){function s(){n.apply(this,arguments)}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype.getDefault=function(){return this.gl.BACK},s.prototype.set=function(o){(o!==this.current||this.dirty)&&(this.gl.cullFace(o),this.current=o,this.dirty=!1)},s}(Nt),$i=function(n){function s(){n.apply(this,arguments)}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype.getDefault=function(){return this.gl.CCW},s.prototype.set=function(o){(o!==this.current||this.dirty)&&(this.gl.frontFace(o),this.current=o,this.dirty=!1)},s}(Nt),zn=function(n){function s(){n.apply(this,arguments)}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype.getDefault=function(){return null},s.prototype.set=function(o){(o!==this.current||this.dirty)&&(this.gl.useProgram(o),this.current=o,this.dirty=!1)},s}(Nt),Ni=function(n){function s(){n.apply(this,arguments)}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype.getDefault=function(){return this.gl.TEXTURE0},s.prototype.set=function(o){(o!==this.current||this.dirty)&&(this.gl.activeTexture(o),this.current=o,this.dirty=!1)},s}(Nt),mn=function(n){function s(){n.apply(this,arguments)}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype.getDefault=function(){var o=this.gl;return[0,0,o.drawingBufferWidth,o.drawingBufferHeight]},s.prototype.set=function(o){var c=this.current;(o[0]!==c[0]||o[1]!==c[1]||o[2]!==c[2]||o[3]!==c[3]||this.dirty)&&(this.gl.viewport(o[0],o[1],o[2],o[3]),this.current=o,this.dirty=!1)},s}(Nt),Ui=function(n){function s(){n.apply(this,arguments)}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype.getDefault=function(){return null},s.prototype.set=function(o){if(o!==this.current||this.dirty){var c=this.gl;c.bindFramebuffer(c.FRAMEBUFFER,o),this.current=o,this.dirty=!1}},s}(Nt),Vi=function(n){function s(){n.apply(this,arguments)}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype.getDefault=function(){return null},s.prototype.set=function(o){if(o!==this.current||this.dirty){var c=this.gl;c.bindRenderbuffer(c.RENDERBUFFER,o),this.current=o,this.dirty=!1}},s}(Nt),Qr=function(n){function s(){n.apply(this,arguments)}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype.getDefault=function(){return null},s.prototype.set=function(o){if(o!==this.current||this.dirty){var c=this.gl;c.bindTexture(c.TEXTURE_2D,o),this.current=o,this.dirty=!1}},s}(Nt),ia=function(n){function s(){n.apply(this,arguments)}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype.getDefault=function(){return null},s.prototype.set=function(o){if(o!==this.current||this.dirty){var c=this.gl;c.bindBuffer(c.ARRAY_BUFFER,o),this.current=o,this.dirty=!1}},s}(Nt),ln=function(n){function s(){n.apply(this,arguments)}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype.getDefault=function(){return null},s.prototype.set=function(o){var c=this.gl;c.bindBuffer(c.ELEMENT_ARRAY_BUFFER,o),this.current=o,this.dirty=!1},s}(Nt),$r=function(n){function s(o){n.call(this,o),this.vao=o.extVertexArrayObject}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype.getDefault=function(){return null},s.prototype.set=function(o){this.vao&&(o!==this.current||this.dirty)&&(this.vao.bindVertexArrayOES(o),this.current=o,this.dirty=!1)},s}(Nt),yn=function(n){function s(){n.apply(this,arguments)}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype.getDefault=function(){return 4},s.prototype.set=function(o){if(o!==this.current||this.dirty){var c=this.gl;c.pixelStorei(c.UNPACK_ALIGNMENT,o),this.current=o,this.dirty=!1}},s}(Nt),On=function(n){function s(){n.apply(this,arguments)}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype.getDefault=function(){return!1},s.prototype.set=function(o){if(o!==this.current||this.dirty){var c=this.gl;c.pixelStorei(c.UNPACK_PREMULTIPLY_ALPHA_WEBGL,o),this.current=o,this.dirty=!1}},s}(Nt),Br=function(n){function s(){n.apply(this,arguments)}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype.getDefault=function(){return!1},s.prototype.set=function(o){if(o!==this.current||this.dirty){var c=this.gl;c.pixelStorei(c.UNPACK_FLIP_Y_WEBGL,o),this.current=o,this.dirty=!1}},s}(Nt),Pr=function(n){function s(o,c){n.call(this,o),this.context=o,this.parent=c}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype.getDefault=function(){return null},s}(Nt),L=function(n){function s(){n.apply(this,arguments)}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype.setDirty=function(){this.dirty=!0},s.prototype.set=function(o){if(o!==this.current||this.dirty){this.context.bindFramebuffer.set(this.parent);var c=this.gl;c.framebufferTexture2D(c.FRAMEBUFFER,c.COLOR_ATTACHMENT0,c.TEXTURE_2D,o,0),this.current=o,this.dirty=!1}},s}(Pr),U=function(n){function s(){n.apply(this,arguments)}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype.set=function(o){if(o!==this.current||this.dirty){this.context.bindFramebuffer.set(this.parent);var c=this.gl;c.framebufferRenderbuffer(c.FRAMEBUFFER,c.DEPTH_ATTACHMENT,c.RENDERBUFFER,o),this.current=o,this.dirty=!1}},s}(Pr),I=function(n,s,o,c){this.context=n,this.width=s,this.height=o;var _=this.framebuffer=n.gl.createFramebuffer();this.colorAttachment=new L(n,_),c&&(this.depthAttachment=new U(n,_))};I.prototype.destroy=function(){var n=this.context.gl,s=this.colorAttachment.get();if(s&&n.deleteTexture(s),this.depthAttachment){var o=this.depthAttachment.get();o&&n.deleteRenderbuffer(o)}n.deleteFramebuffer(this.framebuffer)};var V=function(n,s,o){this.func=n,this.mask=s,this.range=o};V.ReadOnly=!1,V.ReadWrite=!0,V.disabled=new V(519,V.ReadOnly,[0,1]);var W=function(n,s,o,c,_,w){this.test=n,this.ref=s,this.mask=o,this.fail=c,this.depthFail=_,this.pass=w};W.disabled=new W({func:519,mask:0},0,0,7680,7680,7680);var ue=function(n,s,o){this.blendFunction=n,this.blendColor=s,this.mask=o};ue.disabled=new ue(ue.Replace=[1,0],a.Color.transparent,[!1,!1,!1,!1]),ue.unblended=new ue(ue.Replace,a.Color.transparent,[!0,!0,!0,!0]),ue.alphaBlended=new ue([1,771],a.Color.transparent,[!0,!0,!0,!0]);var pe=function(n,s,o){this.enable=n,this.mode=s,this.frontFace=o};pe.disabled=new pe(!1,1029,2305),pe.backCCW=new pe(!0,1029,2305);var j=function(n){this.gl=n,this.extVertexArrayObject=this.gl.getExtension("OES_vertex_array_object"),this.clearColor=new dn(this),this.clearDepth=new ci(this),this.clearStencil=new Jr(this),this.colorMask=new Bn(this),this.depthMask=new hi(this),this.stencilMask=new Tn(this),this.stencilFunc=new ni(this),this.stencilOp=new vr(this),this.stencilTest=new gi(this),this.depthRange=new pi(this),this.depthTest=new Vr(this),this.depthFunc=new Ji(this),this.blend=new Kr(this),this.blendFunc=new In(this),this.blendColor=new Qi(this),this.blendEquation=new Fn(this),this.cullFace=new Oi(this),this.cullFaceSide=new Pn(this),this.frontFace=new $i(this),this.program=new zn(this),this.activeTexture=new Ni(this),this.viewport=new mn(this),this.bindFramebuffer=new Ui(this),this.bindRenderbuffer=new Vi(this),this.bindTexture=new Qr(this),this.bindVertexBuffer=new ia(this),this.bindElementBuffer=new ln(this),this.bindVertexArrayOES=this.extVertexArrayObject&&new $r(this),this.pixelStoreUnpack=new yn(this),this.pixelStoreUnpackPremultiplyAlpha=new On(this),this.pixelStoreUnpackFlipY=new Br(this),this.extTextureFilterAnisotropic=n.getExtension("EXT_texture_filter_anisotropic")||n.getExtension("MOZ_EXT_texture_filter_anisotropic")||n.getExtension("WEBKIT_EXT_texture_filter_anisotropic"),this.extTextureFilterAnisotropic&&(this.extTextureFilterAnisotropicMax=n.getParameter(this.extTextureFilterAnisotropic.MAX_TEXTURE_MAX_ANISOTROPY_EXT)),this.extTextureHalfFloat=n.getExtension("OES_texture_half_float"),this.extTextureHalfFloat&&(n.getExtension("OES_texture_half_float_linear"),this.extRenderToTextureHalfFloat=n.getExtension("EXT_color_buffer_half_float")),this.extTimerQuery=n.getExtension("EXT_disjoint_timer_query"),this.maxTextureSize=n.getParameter(n.MAX_TEXTURE_SIZE)};j.prototype.setDefault=function(){this.unbindVAO(),this.clearColor.setDefault(),this.clearDepth.setDefault(),this.clearStencil.setDefault(),this.colorMask.setDefault(),this.depthMask.setDefault(),this.stencilMask.setDefault(),this.stencilFunc.setDefault(),this.stencilOp.setDefault(),this.stencilTest.setDefault(),this.depthRange.setDefault(),this.depthTest.setDefault(),this.depthFunc.setDefault(),this.blend.setDefault(),this.blendFunc.setDefault(),this.blendColor.setDefault(),this.blendEquation.setDefault(),this.cullFace.setDefault(),this.cullFaceSide.setDefault(),this.frontFace.setDefault(),this.program.setDefault(),this.activeTexture.setDefault(),this.bindFramebuffer.setDefault(),this.pixelStoreUnpack.setDefault(),this.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.pixelStoreUnpackFlipY.setDefault()},j.prototype.setDirty=function(){this.clearColor.dirty=!0,this.clearDepth.dirty=!0,this.clearStencil.dirty=!0,this.colorMask.dirty=!0,this.depthMask.dirty=!0,this.stencilMask.dirty=!0,this.stencilFunc.dirty=!0,this.stencilOp.dirty=!0,this.stencilTest.dirty=!0,this.depthRange.dirty=!0,this.depthTest.dirty=!0,this.depthFunc.dirty=!0,this.blend.dirty=!0,this.blendFunc.dirty=!0,this.blendColor.dirty=!0,this.blendEquation.dirty=!0,this.cullFace.dirty=!0,this.cullFaceSide.dirty=!0,this.frontFace.dirty=!0,this.program.dirty=!0,this.activeTexture.dirty=!0,this.viewport.dirty=!0,this.bindFramebuffer.dirty=!0,this.bindRenderbuffer.dirty=!0,this.bindTexture.dirty=!0,this.bindVertexBuffer.dirty=!0,this.bindElementBuffer.dirty=!0,this.extVertexArrayObject&&(this.bindVertexArrayOES.dirty=!0),this.pixelStoreUnpack.dirty=!0,this.pixelStoreUnpackPremultiplyAlpha.dirty=!0,this.pixelStoreUnpackFlipY.dirty=!0},j.prototype.createIndexBuffer=function(n,s){return new Si(this,n,s)},j.prototype.createVertexBuffer=function(n,s,o){return new ti(this,n,s,o)},j.prototype.createRenderbuffer=function(n,s,o){var c=this.gl,_=c.createRenderbuffer();return this.bindRenderbuffer.set(_),c.renderbufferStorage(c.RENDERBUFFER,n,s,o),this.bindRenderbuffer.set(null),_},j.prototype.createFramebuffer=function(n,s,o){return new I(this,n,s,o)},j.prototype.clear=function(n){var s=n.color,o=n.depth,c=this.gl,_=0;s&&(_|=c.COLOR_BUFFER_BIT,this.clearColor.set(s),this.colorMask.set([!0,!0,!0,!0])),o!==void 0&&(_|=c.DEPTH_BUFFER_BIT,this.depthRange.set([0,1]),this.clearDepth.set(o),this.depthMask.set(!0)),c.clear(_)},j.prototype.setCullFace=function(n){n.enable===!1?this.cullFace.set(!1):(this.cullFace.set(!0),this.cullFaceSide.set(n.mode),this.frontFace.set(n.frontFace))},j.prototype.setDepthMode=function(n){n.func!==this.gl.ALWAYS||n.mask?(this.depthTest.set(!0),this.depthFunc.set(n.func),this.depthMask.set(n.mask),this.depthRange.set(n.range)):this.depthTest.set(!1)},j.prototype.setStencilMode=function(n){n.test.func!==this.gl.ALWAYS||n.mask?(this.stencilTest.set(!0),this.stencilMask.set(n.mask),this.stencilOp.set([n.fail,n.depthFail,n.pass]),this.stencilFunc.set({func:n.test.func,ref:n.ref,mask:n.test.mask})):this.stencilTest.set(!1)},j.prototype.setColorMode=function(n){a.deepEqual(n.blendFunction,ue.Replace)?this.blend.set(!1):(this.blend.set(!0),this.blendFunc.set(n.blendFunction),this.blendColor.set(n.blendColor)),this.colorMask.set(n.mask)},j.prototype.unbindVAO=function(){this.extVertexArrayObject&&this.bindVertexArrayOES.set(null)};var $=function(n){function s(o,c,_){var w=this;n.call(this),this.id=o,this.dispatcher=_,this.on("data",function(S){S.dataType==="source"&&S.sourceDataType==="metadata"&&(w._sourceLoaded=!0),w._sourceLoaded&&!w._paused&&S.dataType==="source"&&S.sourceDataType==="content"&&(w.reload(),w.transform&&w.update(w.transform))}),this.on("error",function(){w._sourceErrored=!0}),this._source=function(S,P,C,O){var Z=new wi[P.type](S,P,C,O);if(Z.id!==S)throw new Error("Expected Source id to be "+S+" instead of "+Z.id);return a.bindAll(["load","abort","unload","serialize","prepare"],Z),Z}(o,c,_,this),this._tiles={},this._cache=new Gt(0,this._unloadTile.bind(this)),this._timers={},this._cacheTimers={},this._maxTileCacheSize=null,this._loadedParentTiles={},this._coveredTiles={},this._state=new a.SourceFeatureState}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype.onAdd=function(o){this.map=o,this._maxTileCacheSize=o?o._maxTileCacheSize:null,this._source&&this._source.onAdd&&this._source.onAdd(o)},s.prototype.onRemove=function(o){this._source&&this._source.onRemove&&this._source.onRemove(o)},s.prototype.loaded=function(){if(this._sourceErrored)return!0;if(!this._sourceLoaded||!this._source.loaded())return!1;for(var o in this._tiles){var c=this._tiles[o];if(c.state!=="loaded"&&c.state!=="errored")return!1}return!0},s.prototype.getSource=function(){return this._source},s.prototype.pause=function(){this._paused=!0},s.prototype.resume=function(){if(this._paused){var o=this._shouldReloadOnResume;this._paused=!1,this._shouldReloadOnResume=!1,o&&this.reload(),this.transform&&this.update(this.transform)}},s.prototype._loadTile=function(o,c){return this._source.loadTile(o,c)},s.prototype._unloadTile=function(o){if(this._source.unloadTile)return this._source.unloadTile(o,function(){})},s.prototype._abortTile=function(o){if(this._source.abortTile)return this._source.abortTile(o,function(){})},s.prototype.serialize=function(){return this._source.serialize()},s.prototype.prepare=function(o){for(var c in this._source.prepare&&this._source.prepare(),this._state.coalesceChanges(this._tiles,this.map?this.map.painter:null),this._tiles){var _=this._tiles[c];_.upload(o),_.prepare(this.map.style.imageManager)}},s.prototype.getIds=function(){return a.values(this._tiles).map(function(o){return o.tileID}).sort(me).map(function(o){return o.key})},s.prototype.getRenderableIds=function(o){var c=this,_=[];for(var w in this._tiles)this._isIdRenderable(w,o)&&_.push(this._tiles[w]);return o?_.sort(function(S,P){var C=S.tileID,O=P.tileID,Z=new a.Point(C.canonical.x,C.canonical.y)._rotate(c.transform.angle),K=new a.Point(O.canonical.x,O.canonical.y)._rotate(c.transform.angle);return C.overscaledZ-O.overscaledZ||K.y-Z.y||K.x-Z.x}).map(function(S){return S.tileID.key}):_.map(function(S){return S.tileID}).sort(me).map(function(S){return S.key})},s.prototype.hasRenderableParent=function(o){var c=this.findLoadedParent(o,0);return!!c&&this._isIdRenderable(c.tileID.key)},s.prototype._isIdRenderable=function(o,c){return this._tiles[o]&&this._tiles[o].hasData()&&!this._coveredTiles[o]&&(c||!this._tiles[o].holdingForFade())},s.prototype.reload=function(){if(this._paused)this._shouldReloadOnResume=!0;else for(var o in this._cache.reset(),this._tiles)this._tiles[o].state!=="errored"&&this._reloadTile(o,"reloading")},s.prototype._reloadTile=function(o,c){var _=this._tiles[o];_&&(_.state!=="loading"&&(_.state=c),this._loadTile(_,this._tileLoaded.bind(this,_,o,c)))},s.prototype._tileLoaded=function(o,c,_,w){if(w)return o.state="errored",void(w.status!==404?this._source.fire(new a.ErrorEvent(w,{tile:o})):this.update(this.transform));o.timeAdded=a.browser.now(),_==="expired"&&(o.refreshedUponExpiration=!0),this._setTileReloadTimer(c,o),this.getSource().type==="raster-dem"&&o.dem&&this._backfillDEM(o),this._state.initializeTileState(o,this.map?this.map.painter:null),this._source.fire(new a.Event("data",{dataType:"source",tile:o,coord:o.tileID}))},s.prototype._backfillDEM=function(o){for(var c=this.getRenderableIds(),_=0;_<c.length;_++){var w=c[_];if(o.neighboringTiles&&o.neighboringTiles[w]){var S=this.getTileByID(w);P(o,S),P(S,o)}}function P(C,O){C.needsHillshadePrepare=!0;var Z=O.tileID.canonical.x-C.tileID.canonical.x,K=O.tileID.canonical.y-C.tileID.canonical.y,H=Math.pow(2,C.tileID.canonical.z),re=O.tileID.key;Z===0&&K===0||Math.abs(K)>1||(Math.abs(Z)>1&&(Math.abs(Z+H)===1?Z+=H:Math.abs(Z-H)===1&&(Z-=H)),O.dem&&C.dem&&(C.dem.backfillBorder(O.dem,Z,K),C.neighboringTiles&&C.neighboringTiles[re]&&(C.neighboringTiles[re].backfilled=!0)))}},s.prototype.getTile=function(o){return this.getTileByID(o.key)},s.prototype.getTileByID=function(o){return this._tiles[o]},s.prototype._retainLoadedChildren=function(o,c,_,w){for(var S in this._tiles){var P=this._tiles[S];if(!(w[S]||!P.hasData()||P.tileID.overscaledZ<=c||P.tileID.overscaledZ>_)){for(var C=P.tileID;P&&P.tileID.overscaledZ>c+1;){var O=P.tileID.scaledTo(P.tileID.overscaledZ-1);(P=this._tiles[O.key])&&P.hasData()&&(C=O)}for(var Z=C;Z.overscaledZ>c;)if(o[(Z=Z.scaledTo(Z.overscaledZ-1)).key]){w[C.key]=C;break}}}},s.prototype.findLoadedParent=function(o,c){if(o.key in this._loadedParentTiles){var _=this._loadedParentTiles[o.key];return _&&_.tileID.overscaledZ>=c?_:null}for(var w=o.overscaledZ-1;w>=c;w--){var S=o.scaledTo(w),P=this._getLoadedTile(S);if(P)return P}},s.prototype._getLoadedTile=function(o){var c=this._tiles[o.key];return c&&c.hasData()?c:this._cache.getByKey(o.wrapped().key)},s.prototype.updateCacheSize=function(o){var c=Math.ceil(o.width/this._source.tileSize)+1,_=Math.ceil(o.height/this._source.tileSize)+1,w=Math.floor(c*_*5),S=typeof this._maxTileCacheSize=="number"?Math.min(this._maxTileCacheSize,w):w;this._cache.setMaxSize(S)},s.prototype.handleWrapJump=function(o){var c=Math.round((o-(this._prevLng===void 0?o:this._prevLng))/360);if(this._prevLng=o,c){var _={};for(var w in this._tiles){var S=this._tiles[w];S.tileID=S.tileID.unwrapTo(S.tileID.wrap+c),_[S.tileID.key]=S}for(var P in this._tiles=_,this._timers)clearTimeout(this._timers[P]),delete this._timers[P];for(var C in this._tiles)this._setTileReloadTimer(C,this._tiles[C])}},s.prototype.update=function(o){var c=this;if(this.transform=o,this._sourceLoaded&&!this._paused){var _;this.updateCacheSize(o),this.handleWrapJump(this.transform.center.lng),this._coveredTiles={},this.used?this._source.tileID?_=o.getVisibleUnwrappedCoordinates(this._source.tileID).map(function(Ne){return new a.OverscaledTileID(Ne.canonical.z,Ne.wrap,Ne.canonical.z,Ne.canonical.x,Ne.canonical.y)}):(_=o.coveringTiles({tileSize:this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this._source.roundZoom,reparseOverscaled:this._source.reparseOverscaled}),this._source.hasTile&&(_=_.filter(function(Ne){return c._source.hasTile(Ne)}))):_=[];var w=o.coveringZoomLevel(this._source),S=Math.max(w-s.maxOverzooming,this._source.minzoom),P=Math.max(w+s.maxUnderzooming,this._source.minzoom),C=this._updateRetainedTiles(_,w);if(Ce(this._source.type)){for(var O={},Z={},K=0,H=Object.keys(C);K<H.length;K+=1){var re=H[K],te=C[re],ce=this._tiles[re];if(ce&&!(ce.fadeEndTime&&ce.fadeEndTime<=a.browser.now())){var Y=this.findLoadedParent(te,S);Y&&(this._addTile(Y.tileID),O[Y.tileID.key]=Y.tileID),Z[re]=te}}for(var se in this._retainLoadedChildren(Z,w,P,C),O)C[se]||(this._coveredTiles[se]=!0,C[se]=O[se])}for(var fe in C)this._tiles[fe].clearFadeHold();for(var ve=0,Ie=a.keysDifference(this._tiles,C);ve<Ie.length;ve+=1){var ke=Ie[ve],Pe=this._tiles[ke];Pe.hasSymbolBuckets&&!Pe.holdingForFade()?Pe.setHoldDuration(this.map._fadeDuration):Pe.hasSymbolBuckets&&!Pe.symbolFadeFinished()||this._removeTile(ke)}this._updateLoadedParentTileCache()}},s.prototype.releaseSymbolFadeTiles=function(){for(var o in this._tiles)this._tiles[o].holdingForFade()&&this._removeTile(o)},s.prototype._updateRetainedTiles=function(o,c){for(var _={},w={},S=Math.max(c-s.maxOverzooming,this._source.minzoom),P=Math.max(c+s.maxUnderzooming,this._source.minzoom),C={},O=0,Z=o;O<Z.length;O+=1){var K=Z[O],H=this._addTile(K);_[K.key]=K,H.hasData()||c<this._source.maxzoom&&(C[K.key]=K)}this._retainLoadedChildren(C,c,P,_);for(var re=0,te=o;re<te.length;re+=1){var ce=te[re],Y=this._tiles[ce.key];if(!Y.hasData()){if(c+1>this._source.maxzoom){var se=ce.children(this._source.maxzoom)[0],fe=this.getTile(se);if(fe&&fe.hasData()){_[se.key]=se;continue}}else{var ve=ce.children(this._source.maxzoom);if(_[ve[0].key]&&_[ve[1].key]&&_[ve[2].key]&&_[ve[3].key])continue}for(var Ie=Y.wasRequested(),ke=ce.overscaledZ-1;ke>=S;--ke){var Pe=ce.scaledTo(ke);if(w[Pe.key]||(w[Pe.key]=!0,!(Y=this.getTile(Pe))&&Ie&&(Y=this._addTile(Pe)),Y&&(_[Pe.key]=Pe,Ie=Y.wasRequested(),Y.hasData())))break}}}return _},s.prototype._updateLoadedParentTileCache=function(){for(var o in this._loadedParentTiles={},this._tiles){for(var c=[],_=void 0,w=this._tiles[o].tileID;w.overscaledZ>0;){if(w.key in this._loadedParentTiles){_=this._loadedParentTiles[w.key];break}c.push(w.key);var S=w.scaledTo(w.overscaledZ-1);if(_=this._getLoadedTile(S))break;w=S}for(var P=0,C=c;P<C.length;P+=1)this._loadedParentTiles[C[P]]=_}},s.prototype._addTile=function(o){var c=this._tiles[o.key];if(c)return c;(c=this._cache.getAndRemove(o))&&(this._setTileReloadTimer(o.key,c),c.tileID=o,this._state.initializeTileState(c,this.map?this.map.painter:null),this._cacheTimers[o.key]&&(clearTimeout(this._cacheTimers[o.key]),delete this._cacheTimers[o.key],this._setTileReloadTimer(o.key,c)));var _=!!c;return _||(c=new a.Tile(o,this._source.tileSize*o.overscaleFactor()),this._loadTile(c,this._tileLoaded.bind(this,c,o.key,c.state))),c?(c.uses++,this._tiles[o.key]=c,_||this._source.fire(new a.Event("dataloading",{tile:c,coord:c.tileID,dataType:"source"})),c):null},s.prototype._setTileReloadTimer=function(o,c){var _=this;o in this._timers&&(clearTimeout(this._timers[o]),delete this._timers[o]);var w=c.getExpiryTimeout();w&&(this._timers[o]=setTimeout(function(){_._reloadTile(o,"expired"),delete _._timers[o]},w))},s.prototype._removeTile=function(o){var c=this._tiles[o];c&&(c.uses--,delete this._tiles[o],this._timers[o]&&(clearTimeout(this._timers[o]),delete this._timers[o]),c.uses>0||(c.hasData()&&c.state!=="reloading"?this._cache.add(c.tileID,c,c.getExpiryTimeout()):(c.aborted=!0,this._abortTile(c),this._unloadTile(c))))},s.prototype.clearTiles=function(){for(var o in this._shouldReloadOnResume=!1,this._paused=!1,this._tiles)this._removeTile(o);this._cache.reset()},s.prototype.tilesIn=function(o,c,_){var w=this,S=[],P=this.transform;if(!P)return S;for(var C=_?P.getCameraQueryGeometry(o):o,O=o.map(function(ke){return P.pointCoordinate(ke)}),Z=C.map(function(ke){return P.pointCoordinate(ke)}),K=this.getIds(),H=1/0,re=1/0,te=-1/0,ce=-1/0,Y=0,se=Z;Y<se.length;Y+=1){var fe=se[Y];H=Math.min(H,fe.x),re=Math.min(re,fe.y),te=Math.max(te,fe.x),ce=Math.max(ce,fe.y)}for(var ve=function(ke){var Pe=w._tiles[K[ke]];if(!Pe.holdingForFade()){var Ne=Pe.tileID,Je=Math.pow(2,P.zoom-Pe.tileID.overscaledZ),Xe=c*Pe.queryPadding*a.EXTENT/Pe.tileSize/Je,ct=[Ne.getTilePoint(new a.MercatorCoordinate(H,re)),Ne.getTilePoint(new a.MercatorCoordinate(te,ce))];if(ct[0].x-Xe<a.EXTENT&&ct[0].y-Xe<a.EXTENT&&ct[1].x+Xe>=0&&ct[1].y+Xe>=0){var Et=O.map(function(At){return Ne.getTilePoint(At)}),Ct=Z.map(function(At){return Ne.getTilePoint(At)});S.push({tile:Pe,tileID:Ne,queryGeometry:Et,cameraQueryGeometry:Ct,scale:Je})}}},Ie=0;Ie<K.length;Ie++)ve(Ie);return S},s.prototype.getVisibleCoordinates=function(o){for(var c=this,_=this.getRenderableIds(o).map(function(C){return c._tiles[C].tileID}),w=0,S=_;w<S.length;w+=1){var P=S[w];P.posMatrix=this.transform.calculatePosMatrix(P.toUnwrapped())}return _},s.prototype.hasTransition=function(){if(this._source.hasTransition())return!0;if(Ce(this._source.type))for(var o in this._tiles){var c=this._tiles[o];if(c.fadeEndTime!==void 0&&c.fadeEndTime>=a.browser.now())return!0}return!1},s.prototype.setFeatureState=function(o,c,_){this._state.updateState(o=o||"_geojsonTileLayer",c,_)},s.prototype.removeFeatureState=function(o,c,_){this._state.removeFeatureState(o=o||"_geojsonTileLayer",c,_)},s.prototype.getFeatureState=function(o,c){return this._state.getState(o=o||"_geojsonTileLayer",c)},s.prototype.setDependencies=function(o,c,_){var w=this._tiles[o];w&&w.setDependencies(c,_)},s.prototype.reloadTilesForDependencies=function(o,c){for(var _ in this._tiles)this._tiles[_].hasDependency(o,c)&&this._reloadTile(_,"reloading");this._cache.filter(function(w){return!w.hasDependency(o,c)})},s}(a.Evented);function me(n,s){var o=Math.abs(2*n.wrap)-+(n.wrap<0),c=Math.abs(2*s.wrap)-+(s.wrap<0);return n.overscaledZ-s.overscaledZ||c-o||s.canonical.y-n.canonical.y||s.canonical.x-n.canonical.x}function Ce(n){return n==="raster"||n==="image"||n==="video"}function Oe(){return new a.window.Worker(il.workerUrl)}$.maxOverzooming=10,$.maxUnderzooming=3;var we="mapboxgl_preloaded_worker_pool",De=function(){this.active={}};De.prototype.acquire=function(n){if(!this.workers)for(this.workers=[];this.workers.length<De.workerCount;)this.workers.push(new Oe);return this.active[n]=!0,this.workers.slice()},De.prototype.release=function(n){delete this.active[n],this.numActive()===0&&(this.workers.forEach(function(s){s.terminate()}),this.workers=null)},De.prototype.isPreloaded=function(){return!!this.active[we]},De.prototype.numActive=function(){return Object.keys(this.active).length};var st,tt=Math.floor(a.browser.hardwareConcurrency/2);function Se(){return st||(st=new De),st}function He(n,s){var o={};for(var c in n)c!=="ref"&&(o[c]=n[c]);return a.refProperties.forEach(function(_){_ in s&&(o[_]=s[_])}),o}function Ye(n){n=n.slice();for(var s=Object.create(null),o=0;o<n.length;o++)s[n[o].id]=n[o];for(var c=0;c<n.length;c++)"ref"in n[c]&&(n[c]=He(n[c],s[n[c].ref]));return n}De.workerCount=Math.max(Math.min(tt,6),1);var Qe={setStyle:"setStyle",addLayer:"addLayer",removeLayer:"removeLayer",setPaintProperty:"setPaintProperty",setLayoutProperty:"setLayoutProperty",setFilter:"setFilter",addSource:"addSource",removeSource:"removeSource",setGeoJSONSourceData:"setGeoJSONSourceData",setLayerZoomRange:"setLayerZoomRange",setLayerProperty:"setLayerProperty",setCenter:"setCenter",setZoom:"setZoom",setBearing:"setBearing",setPitch:"setPitch",setSprite:"setSprite",setGlyphs:"setGlyphs",setTransition:"setTransition",setLight:"setLight"};function Vt(n,s,o){o.push({command:Qe.addSource,args:[n,s[n]]})}function it(n,s,o){s.push({command:Qe.removeSource,args:[n]}),o[n]=!0}function Wt(n,s,o,c){it(n,o,c),Vt(n,s,o)}function jt(n,s,o){var c;for(c in n[o])if(n[o].hasOwnProperty(c)&&c!=="data"&&!a.deepEqual(n[o][c],s[o][c]))return!1;for(c in s[o])if(s[o].hasOwnProperty(c)&&c!=="data"&&!a.deepEqual(n[o][c],s[o][c]))return!1;return!0}function Ht(n,s,o,c,_,w){var S;for(S in s=s||{},n=n||{})n.hasOwnProperty(S)&&(a.deepEqual(n[S],s[S])||o.push({command:w,args:[c,S,s[S],_]}));for(S in s)s.hasOwnProperty(S)&&!n.hasOwnProperty(S)&&(a.deepEqual(n[S],s[S])||o.push({command:w,args:[c,S,s[S],_]}))}function sr(n){return n.id}function er(n,s){return n[s.id]=s,n}var _i=function(n,s){this.reset(n,s)};_i.prototype.reset=function(n,s){this.points=n||[],this._distances=[0];for(var o=1;o<this.points.length;o++)this._distances[o]=this._distances[o-1]+this.points[o].dist(this.points[o-1]);this.length=this._distances[this._distances.length-1],this.padding=Math.min(s||0,.5*this.length),this.paddedLength=this.length-2*this.padding},_i.prototype.lerp=function(n){if(this.points.length===1)return this.points[0];n=a.clamp(n,0,1);for(var s=1,o=this._distances[s],c=n*this.paddedLength+this.padding;o<c&&s<this._distances.length;)o=this._distances[++s];var _=s-1,w=this._distances[_],S=o-w,P=S>0?(c-w)/S:0;return this.points[_].mult(1-P).add(this.points[s].mult(P))};var dr=function(n,s,o){var c=this.boxCells=[],_=this.circleCells=[];this.xCellCount=Math.ceil(n/o),this.yCellCount=Math.ceil(s/o);for(var w=0;w<this.xCellCount*this.yCellCount;w++)c.push([]),_.push([]);this.circleKeys=[],this.boxKeys=[],this.bboxes=[],this.circles=[],this.width=n,this.height=s,this.xScale=this.xCellCount/n,this.yScale=this.yCellCount/s,this.boxUid=0,this.circleUid=0};function Fr(n,s,o,c,_){var w=a.create();return s?(a.scale(w,w,[1/_,1/_,1]),o||a.rotateZ(w,w,c.angle)):a.multiply(w,c.labelPlaneMatrix,n),w}function _r(n,s,o,c,_){if(s){var w=a.clone(n);return a.scale(w,w,[_,_,1]),o||a.rotateZ(w,w,-c.angle),w}return c.glCoordMatrix}function Jt(n,s){var o=[n.x,n.y,0,1];oi(o,o,s);var c=o[3];return{point:new a.Point(o[0]/c,o[1]/c),signedDistanceFromCamera:c}}function lr(n,s){return .5+n/s*.5}function Ei(n,s){var o=n[0]/n[3],c=n[1]/n[3];return o>=-s[0]&&o<=s[0]&&c>=-s[1]&&c<=s[1]}function pa(n,s,o,c,_,w,S,P){var C=c?n.textSizeData:n.iconSizeData,O=a.evaluateSizeForZoom(C,o.transform.zoom),Z=[256/o.width*2+1,256/o.height*2+1],K=c?n.text.dynamicLayoutVertexArray:n.icon.dynamicLayoutVertexArray;K.clear();for(var H=n.lineVertexArray,re=c?n.text.placedSymbolArray:n.icon.placedSymbolArray,te=o.transform.width/o.transform.height,ce=!1,Y=0;Y<re.length;Y++){var se=re.get(Y);if(se.hidden||se.writingMode===a.WritingMode.vertical&&!ce)ki(se.numGlyphs,K);else{ce=!1;var fe=[se.anchorX,se.anchorY,0,1];if(a.transformMat4(fe,fe,s),Ei(fe,Z)){var ve=lr(o.transform.cameraToCenterDistance,fe[3]),Ie=a.evaluateSizeForFeature(C,O,se),ke=S?Ie/ve:Ie*ve,Pe=new a.Point(se.anchorX,se.anchorY),Ne=Jt(Pe,_).point,Je={},Xe=Na(se,ke,!1,P,s,_,w,n.glyphOffsetArray,H,K,Ne,Pe,Je,te);ce=Xe.useVertical,(Xe.notEnoughRoom||ce||Xe.needsFlipping&&Na(se,ke,!0,P,s,_,w,n.glyphOffsetArray,H,K,Ne,Pe,Je,te).notEnoughRoom)&&ki(se.numGlyphs,K)}else ki(se.numGlyphs,K)}}c?n.text.dynamicLayoutVertexBuffer.updateData(K):n.icon.dynamicLayoutVertexBuffer.updateData(K)}function ai(n,s,o,c,_,w,S,P,C,O,Z){var K=P.glyphStartIndex+P.numGlyphs,H=P.lineStartIndex,re=P.lineStartIndex+P.lineLength,te=s.getoffsetX(P.glyphStartIndex),ce=s.getoffsetX(K-1),Y=qr(n*te,o,c,_,w,S,P.segment,H,re,C,O,Z);if(!Y)return null;var se=qr(n*ce,o,c,_,w,S,P.segment,H,re,C,O,Z);return se?{first:Y,last:se}:null}function Di(n,s,o,c){return n===a.WritingMode.horizontal&&Math.abs(o.y-s.y)>Math.abs(o.x-s.x)*c?{useVertical:!0}:(n===a.WritingMode.vertical?s.y<o.y:s.x>o.x)?{needsFlipping:!0}:null}function Na(n,s,o,c,_,w,S,P,C,O,Z,K,H,re){var te,ce=s/24,Y=n.lineOffsetX*ce,se=n.lineOffsetY*ce;if(n.numGlyphs>1){var fe=n.glyphStartIndex+n.numGlyphs,ve=n.lineStartIndex,Ie=n.lineStartIndex+n.lineLength,ke=ai(ce,P,Y,se,o,Z,K,n,C,w,H);if(!ke)return{notEnoughRoom:!0};var Pe=Jt(ke.first.point,S).point,Ne=Jt(ke.last.point,S).point;if(c&&!o){var Je=Di(n.writingMode,Pe,Ne,re);if(Je)return Je}te=[ke.first];for(var Xe=n.glyphStartIndex+1;Xe<fe-1;Xe++)te.push(qr(ce*P.getoffsetX(Xe),Y,se,o,Z,K,n.segment,ve,Ie,C,w,H));te.push(ke.last)}else{if(c&&!o){var ct=Jt(K,_).point,Et=n.lineStartIndex+n.segment+1,Ct=new a.Point(C.getx(Et),C.gety(Et)),At=Jt(Ct,_),yr=At.signedDistanceFromCamera>0?At.point:va(K,Ct,ct,1,_),ht=Di(n.writingMode,ct,yr,re);if(ht)return ht}var Ut=qr(ce*P.getoffsetX(n.glyphStartIndex),Y,se,o,Z,K,n.segment,n.lineStartIndex,n.lineStartIndex+n.lineLength,C,w,H);if(!Ut)return{notEnoughRoom:!0};te=[Ut]}for(var Yt=0,Ot=te;Yt<Ot.length;Yt+=1){var Ft=Ot[Yt];a.addDynamicAttributes(O,Ft.point,Ft.angle)}return{}}function va(n,s,o,c,_){var w=Jt(n.add(n.sub(s)._unit()),_).point,S=o.sub(w);return o.add(S._mult(c/S.mag()))}function qr(n,s,o,c,_,w,S,P,C,O,Z,K){var H=c?n-s:n+s,re=H>0?1:-1,te=0;c&&(re*=-1,te=Math.PI),re<0&&(te+=Math.PI);for(var ce=re>0?P+S:P+S+1,Y=_,se=_,fe=0,ve=0,Ie=Math.abs(H),ke=[];fe+ve<=Ie;){if((ce+=re)<P||ce>=C)return null;if(se=Y,ke.push(Y),(Y=K[ce])===void 0){var Pe=new a.Point(O.getx(ce),O.gety(ce)),Ne=Jt(Pe,Z);if(Ne.signedDistanceFromCamera>0)Y=K[ce]=Ne.point;else{var Je=ce-re;Y=va(fe===0?w:new a.Point(O.getx(Je),O.gety(Je)),Pe,se,Ie-fe+1,Z)}}fe+=ve,ve=se.dist(Y)}var Xe=(Ie-fe)/ve,ct=Y.sub(se),Et=ct.mult(Xe)._add(se);Et._add(ct._unit()._perp()._mult(o*re));var Ct=te+Math.atan2(Y.y-se.y,Y.x-se.x);return ke.push(Et),{point:Et,angle:Ct,path:ke}}dr.prototype.keysLength=function(){return this.boxKeys.length+this.circleKeys.length},dr.prototype.insert=function(n,s,o,c,_){this._forEachCell(s,o,c,_,this._insertBoxCell,this.boxUid++),this.boxKeys.push(n),this.bboxes.push(s),this.bboxes.push(o),this.bboxes.push(c),this.bboxes.push(_)},dr.prototype.insertCircle=function(n,s,o,c){this._forEachCell(s-c,o-c,s+c,o+c,this._insertCircleCell,this.circleUid++),this.circleKeys.push(n),this.circles.push(s),this.circles.push(o),this.circles.push(c)},dr.prototype._insertBoxCell=function(n,s,o,c,_,w){this.boxCells[_].push(w)},dr.prototype._insertCircleCell=function(n,s,o,c,_,w){this.circleCells[_].push(w)},dr.prototype._query=function(n,s,o,c,_,w){if(o<0||n>this.width||c<0||s>this.height)return!_&&[];var S=[];if(n<=0&&s<=0&&this.width<=o&&this.height<=c){if(_)return!0;for(var P=0;P<this.boxKeys.length;P++)S.push({key:this.boxKeys[P],x1:this.bboxes[4*P],y1:this.bboxes[4*P+1],x2:this.bboxes[4*P+2],y2:this.bboxes[4*P+3]});for(var C=0;C<this.circleKeys.length;C++){var O=this.circles[3*C],Z=this.circles[3*C+1],K=this.circles[3*C+2];S.push({key:this.circleKeys[C],x1:O-K,y1:Z-K,x2:O+K,y2:Z+K})}return w?S.filter(w):S}return this._forEachCell(n,s,o,c,this._queryCell,S,{hitTest:_,seenUids:{box:{},circle:{}}},w),_?S.length>0:S},dr.prototype._queryCircle=function(n,s,o,c,_){var w=n-o,S=n+o,P=s-o,C=s+o;if(S<0||w>this.width||C<0||P>this.height)return!c&&[];var O=[];return this._forEachCell(w,P,S,C,this._queryCellCircle,O,{hitTest:c,circle:{x:n,y:s,radius:o},seenUids:{box:{},circle:{}}},_),c?O.length>0:O},dr.prototype.query=function(n,s,o,c,_){return this._query(n,s,o,c,!1,_)},dr.prototype.hitTest=function(n,s,o,c,_){return this._query(n,s,o,c,!0,_)},dr.prototype.hitTestCircle=function(n,s,o,c){return this._queryCircle(n,s,o,!0,c)},dr.prototype._queryCell=function(n,s,o,c,_,w,S,P){var C=S.seenUids,O=this.boxCells[_];if(O!==null)for(var Z=this.bboxes,K=0,H=O;K<H.length;K+=1){var re=H[K];if(!C.box[re]){C.box[re]=!0;var te=4*re;if(n<=Z[te+2]&&s<=Z[te+3]&&o>=Z[te+0]&&c>=Z[te+1]&&(!P||P(this.boxKeys[re]))){if(S.hitTest)return w.push(!0),!0;w.push({key:this.boxKeys[re],x1:Z[te],y1:Z[te+1],x2:Z[te+2],y2:Z[te+3]})}}}var ce=this.circleCells[_];if(ce!==null)for(var Y=this.circles,se=0,fe=ce;se<fe.length;se+=1){var ve=fe[se];if(!C.circle[ve]){C.circle[ve]=!0;var Ie=3*ve;if(this._circleAndRectCollide(Y[Ie],Y[Ie+1],Y[Ie+2],n,s,o,c)&&(!P||P(this.circleKeys[ve]))){if(S.hitTest)return w.push(!0),!0;var ke=Y[Ie],Pe=Y[Ie+1],Ne=Y[Ie+2];w.push({key:this.circleKeys[ve],x1:ke-Ne,y1:Pe-Ne,x2:ke+Ne,y2:Pe+Ne})}}}},dr.prototype._queryCellCircle=function(n,s,o,c,_,w,S,P){var C=S.circle,O=S.seenUids,Z=this.boxCells[_];if(Z!==null)for(var K=this.bboxes,H=0,re=Z;H<re.length;H+=1){var te=re[H];if(!O.box[te]){O.box[te]=!0;var ce=4*te;if(this._circleAndRectCollide(C.x,C.y,C.radius,K[ce+0],K[ce+1],K[ce+2],K[ce+3])&&(!P||P(this.boxKeys[te])))return w.push(!0),!0}}var Y=this.circleCells[_];if(Y!==null)for(var se=this.circles,fe=0,ve=Y;fe<ve.length;fe+=1){var Ie=ve[fe];if(!O.circle[Ie]){O.circle[Ie]=!0;var ke=3*Ie;if(this._circlesCollide(se[ke],se[ke+1],se[ke+2],C.x,C.y,C.radius)&&(!P||P(this.circleKeys[Ie])))return w.push(!0),!0}}},dr.prototype._forEachCell=function(n,s,o,c,_,w,S,P){for(var C=this._convertToXCellCoord(n),O=this._convertToYCellCoord(s),Z=this._convertToXCellCoord(o),K=this._convertToYCellCoord(c),H=C;H<=Z;H++)for(var re=O;re<=K;re++)if(_.call(this,n,s,o,c,this.xCellCount*re+H,w,S,P))return},dr.prototype._convertToXCellCoord=function(n){return Math.max(0,Math.min(this.xCellCount-1,Math.floor(n*this.xScale)))},dr.prototype._convertToYCellCoord=function(n){return Math.max(0,Math.min(this.yCellCount-1,Math.floor(n*this.yScale)))},dr.prototype._circlesCollide=function(n,s,o,c,_,w){var S=c-n,P=_-s,C=o+w;return C*C>S*S+P*P},dr.prototype._circleAndRectCollide=function(n,s,o,c,_,w,S){var P=(w-c)/2,C=Math.abs(n-(c+P));if(C>P+o)return!1;var O=(S-_)/2,Z=Math.abs(s-(_+O));if(Z>O+o)return!1;if(C<=P||Z<=O)return!0;var K=C-P,H=Z-O;return K*K+H*H<=o*o};var ba=new Float32Array([-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0]);function ki(n,s){for(var o=0;o<n;o++){var c=s.length;s.resize(c+4),s.float32.set(ba,3*c)}}function oi(n,s,o){var c=s[0],_=s[1];return n[0]=o[0]*c+o[4]*_+o[12],n[1]=o[1]*c+o[5]*_+o[13],n[3]=o[3]*c+o[7]*_+o[15],n}var un=function(n,s,o){s===void 0&&(s=new dr(n.width+200,n.height+200,25)),o===void 0&&(o=new dr(n.width+200,n.height+200,25)),this.transform=n,this.grid=s,this.ignoredGrid=o,this.pitchfactor=Math.cos(n._pitch)*n.cameraToCenterDistance,this.screenRightBoundary=n.width+100,this.screenBottomBoundary=n.height+100,this.gridRightBoundary=n.width+200,this.gridBottomBoundary=n.height+200};function Ar(n,s,o){return s*(a.EXTENT/(n.tileSize*Math.pow(2,o-n.tileID.overscaledZ)))}un.prototype.placeCollisionBox=function(n,s,o,c,_){var w=this.projectAndGetPerspectiveRatio(c,n.anchorPointX,n.anchorPointY),S=o*w.perspectiveRatio,P=n.x1*S+w.point.x,C=n.y1*S+w.point.y,O=n.x2*S+w.point.x,Z=n.y2*S+w.point.y;return!this.isInsideGrid(P,C,O,Z)||!s&&this.grid.hitTest(P,C,O,Z,_)?{box:[],offscreen:!1}:{box:[P,C,O,Z],offscreen:this.isOffscreen(P,C,O,Z)}},un.prototype.placeCollisionCircles=function(n,s,o,c,_,w,S,P,C,O,Z,K,H){var re=[],te=new a.Point(s.anchorX,s.anchorY),ce=Jt(te,w),Y=lr(this.transform.cameraToCenterDistance,ce.signedDistanceFromCamera),se=(O?_/Y:_*Y)/a.ONE_EM,fe=Jt(te,S).point,ve=ai(se,c,s.lineOffsetX*se,s.lineOffsetY*se,!1,fe,te,s,o,S,{}),Ie=!1,ke=!1,Pe=!0;if(ve){for(var Ne=.5*K*Y+H,Je=new a.Point(-100,-100),Xe=new a.Point(this.screenRightBoundary,this.screenBottomBoundary),ct=new _i,Et=ve.first,Ct=ve.last,At=[],yr=Et.path.length-1;yr>=1;yr--)At.push(Et.path[yr]);for(var ht=1;ht<Ct.path.length;ht++)At.push(Ct.path[ht]);var Ut=2.5*Ne;if(P){var Yt=At.map(function(sa){return Jt(sa,P)});At=Yt.some(function(sa){return sa.signedDistanceFromCamera<=0})?[]:Yt.map(function(sa){return sa.point})}var Ot=[];if(At.length>0){for(var Ft=At[0].clone(),Xt=At[0].clone(),Rt=1;Rt<At.length;Rt++)Ft.x=Math.min(Ft.x,At[Rt].x),Ft.y=Math.min(Ft.y,At[Rt].y),Xt.x=Math.max(Xt.x,At[Rt].x),Xt.y=Math.max(Xt.y,At[Rt].y);Ot=Ft.x>=Je.x&&Xt.x<=Xe.x&&Ft.y>=Je.y&&Xt.y<=Xe.y?[At]:Xt.x<Je.x||Ft.x>Xe.x||Xt.y<Je.y||Ft.y>Xe.y?[]:a.clipLine([At],Je.x,Je.y,Xe.x,Xe.y)}for(var Dt=0,Li=Ot;Dt<Li.length;Dt+=1){var si;ct.reset(Li[Dt],.25*Ne),si=ct.length<=.5*Ne?1:Math.ceil(ct.paddedLength/Ut)+1;for(var hn=0;hn<si;hn++){var Ki=hn/Math.max(si-1,1),ri=ct.lerp(Ki),fi=ri.x+100,Hn=ri.y+100;re.push(fi,Hn,Ne,0);var bn=fi-Ne,Qa=Hn-Ne,An=fi+Ne,_a=Hn+Ne;if(Pe=Pe&&this.isOffscreen(bn,Qa,An,_a),ke=ke||this.isInsideGrid(bn,Qa,An,_a),!n&&this.grid.hitTestCircle(fi,Hn,Ne,Z)&&(Ie=!0,!C))return{circles:[],offscreen:!1,collisionDetected:Ie}}}}return{circles:!C&&Ie||!ke?[]:re,offscreen:Pe,collisionDetected:Ie}},un.prototype.queryRenderedSymbols=function(n){if(n.length===0||this.grid.keysLength()===0&&this.ignoredGrid.keysLength()===0)return{};for(var s=[],o=1/0,c=1/0,_=-1/0,w=-1/0,S=0,P=n;S<P.length;S+=1){var C=P[S],O=new a.Point(C.x+100,C.y+100);o=Math.min(o,O.x),c=Math.min(c,O.y),_=Math.max(_,O.x),w=Math.max(w,O.y),s.push(O)}for(var Z={},K={},H=0,re=this.grid.query(o,c,_,w).concat(this.ignoredGrid.query(o,c,_,w));H<re.length;H+=1){var te=re[H],ce=te.key;if(Z[ce.bucketInstanceId]===void 0&&(Z[ce.bucketInstanceId]={}),!Z[ce.bucketInstanceId][ce.featureIndex]){var Y=[new a.Point(te.x1,te.y1),new a.Point(te.x2,te.y1),new a.Point(te.x2,te.y2),new a.Point(te.x1,te.y2)];a.polygonIntersectsPolygon(s,Y)&&(Z[ce.bucketInstanceId][ce.featureIndex]=!0,K[ce.bucketInstanceId]===void 0&&(K[ce.bucketInstanceId]=[]),K[ce.bucketInstanceId].push(ce.featureIndex))}}return K},un.prototype.insertCollisionBox=function(n,s,o,c,_){(s?this.ignoredGrid:this.grid).insert({bucketInstanceId:o,featureIndex:c,collisionGroupID:_},n[0],n[1],n[2],n[3])},un.prototype.insertCollisionCircles=function(n,s,o,c,_){for(var w=s?this.ignoredGrid:this.grid,S={bucketInstanceId:o,featureIndex:c,collisionGroupID:_},P=0;P<n.length;P+=4)w.insertCircle(S,n[P],n[P+1],n[P+2])},un.prototype.projectAndGetPerspectiveRatio=function(n,s,o){var c=[s,o,0,1];return oi(c,c,n),{point:new a.Point((c[0]/c[3]+1)/2*this.transform.width+100,(-c[1]/c[3]+1)/2*this.transform.height+100),perspectiveRatio:.5+this.transform.cameraToCenterDistance/c[3]*.5}},un.prototype.isOffscreen=function(n,s,o,c){return o<100||n>=this.screenRightBoundary||c<100||s>this.screenBottomBoundary},un.prototype.isInsideGrid=function(n,s,o,c){return o>=0&&n<this.gridRightBoundary&&c>=0&&s<this.gridBottomBoundary},un.prototype.getViewportMatrix=function(){var n=a.identity([]);return a.translate(n,n,[-100,-100,0]),n};var Nn=function(n,s,o,c){this.opacity=n?Math.max(0,Math.min(1,n.opacity+(n.placed?s:-s))):c&&o?1:0,this.placed=o};Nn.prototype.isHidden=function(){return this.opacity===0&&!this.placed};var gn=function(n,s,o,c,_){this.text=new Nn(n?n.text:null,s,o,_),this.icon=new Nn(n?n.icon:null,s,c,_)};gn.prototype.isHidden=function(){return this.text.isHidden()&&this.icon.isHidden()};var ns=function(n,s,o){this.text=n,this.icon=s,this.skipFade=o},Ti=function(){this.invProjMatrix=a.create(),this.viewportMatrix=a.create(),this.circles=[]},xa=function(n,s,o,c,_){this.bucketInstanceId=n,this.featureIndex=s,this.sourceLayerIndex=o,this.bucketIndex=c,this.tileID=_},qi=function(n){this.crossSourceCollisions=n,this.maxGroupID=0,this.collisionGroups={}};function Ii(n,s,o,c,_){var w=a.getAnchorAlignment(n),S=-(w.horizontalAlign-.5)*s,P=-(w.verticalAlign-.5)*o,C=a.evaluateVariableOffset(n,c);return new a.Point(S+C[0]*_,P+C[1]*_)}function Qn(n,s,o,c,_,w){var S=n.x1,P=n.x2,C=n.y1,O=n.y2,Z=n.anchorPointX,K=n.anchorPointY,H=new a.Point(s,o);return c&&H._rotate(_?w:-w),{x1:S+H.x,y1:C+H.y,x2:P+H.x,y2:O+H.y,anchorPointX:Z,anchorPointY:K}}qi.prototype.get=function(n){if(this.crossSourceCollisions)return{ID:0,predicate:null};if(!this.collisionGroups[n]){var s=++this.maxGroupID;this.collisionGroups[n]={ID:s,predicate:function(o){return o.collisionGroupID===s}}}return this.collisionGroups[n]};var ji=function(n,s,o,c){this.transform=n.clone(),this.collisionIndex=new un(this.transform),this.placements={},this.opacities={},this.variableOffsets={},this.stale=!1,this.commitTime=0,this.fadeDuration=s,this.retainedQueryData={},this.collisionGroups=new qi(o),this.collisionCircleArrays={},this.prevPlacement=c,c&&(c.prevPlacement=void 0),this.placedOrientations={}};function wa(n,s,o,c,_){n.emplaceBack(s?1:0,o?1:0,c||0,_||0),n.emplaceBack(s?1:0,o?1:0,c||0,_||0),n.emplaceBack(s?1:0,o?1:0,c||0,_||0),n.emplaceBack(s?1:0,o?1:0,c||0,_||0)}ji.prototype.getBucketParts=function(n,s,o,c){var _=o.getBucket(s),w=o.latestFeatureIndex;if(_&&w&&s.id===_.layerIds[0]){var S=o.collisionBoxArray,P=_.layers[0].layout,C=Math.pow(2,this.transform.zoom-o.tileID.overscaledZ),O=o.tileSize/a.EXTENT,Z=this.transform.calculatePosMatrix(o.tileID.toUnwrapped()),K=P.get("text-pitch-alignment")==="map",H=P.get("text-rotation-alignment")==="map",re=Ar(o,1,this.transform.zoom),te=Fr(Z,K,H,this.transform,re),ce=null;if(K){var Y=_r(Z,K,H,this.transform,re);ce=a.multiply([],this.transform.labelPlaneMatrix,Y)}this.retainedQueryData[_.bucketInstanceId]=new xa(_.bucketInstanceId,w,_.sourceLayerIndex,_.index,o.tileID);var se={bucket:_,layout:P,posMatrix:Z,textLabelPlaneMatrix:te,labelToScreenMatrix:ce,scale:C,textPixelRatio:O,holdingForFade:o.holdingForFade(),collisionBoxArray:S,partiallyEvaluatedTextSize:a.evaluateSizeForZoom(_.textSizeData,this.transform.zoom),collisionGroup:this.collisionGroups.get(_.sourceID)};if(c)for(var fe=0,ve=_.sortKeyRanges;fe<ve.length;fe+=1){var Ie=ve[fe];n.push({sortKey:Ie.sortKey,symbolInstanceStart:Ie.symbolInstanceStart,symbolInstanceEnd:Ie.symbolInstanceEnd,parameters:se})}else n.push({symbolInstanceStart:0,symbolInstanceEnd:_.symbolInstances.length,parameters:se})}},ji.prototype.attemptAnchorPlacement=function(n,s,o,c,_,w,S,P,C,O,Z,K,H,re,te){var ce,Y=[K.textOffset0,K.textOffset1],se=Ii(n,o,c,Y,_),fe=this.collisionIndex.placeCollisionBox(Qn(s,se.x,se.y,w,S,this.transform.angle),Z,P,C,O.predicate);if(!te||this.collisionIndex.placeCollisionBox(Qn(te,se.x,se.y,w,S,this.transform.angle),Z,P,C,O.predicate).box.length!==0)return fe.box.length>0?(this.prevPlacement&&this.prevPlacement.variableOffsets[K.crossTileID]&&this.prevPlacement.placements[K.crossTileID]&&this.prevPlacement.placements[K.crossTileID].text&&(ce=this.prevPlacement.variableOffsets[K.crossTileID].anchor),this.variableOffsets[K.crossTileID]={textOffset:Y,width:o,height:c,anchor:n,textBoxScale:_,prevAnchor:ce},this.markUsedJustification(H,n,K,re),H.allowVerticalPlacement&&(this.markUsedOrientation(H,re,K),this.placedOrientations[K.crossTileID]=re),{shift:se,placedGlyphBoxes:fe}):void 0},ji.prototype.placeLayerBucketPart=function(n,s,o){var c=this,_=n.parameters,w=_.bucket,S=_.layout,P=_.posMatrix,C=_.textLabelPlaneMatrix,O=_.labelToScreenMatrix,Z=_.textPixelRatio,K=_.holdingForFade,H=_.collisionBoxArray,re=_.partiallyEvaluatedTextSize,te=_.collisionGroup,ce=S.get("text-optional"),Y=S.get("icon-optional"),se=S.get("text-allow-overlap"),fe=S.get("icon-allow-overlap"),ve=S.get("text-rotation-alignment")==="map",Ie=S.get("text-pitch-alignment")==="map",ke=S.get("icon-text-fit")!=="none",Pe=S.get("symbol-z-order")==="viewport-y",Ne=se&&(fe||!w.hasIconData()||Y),Je=fe&&(se||!w.hasTextData()||ce);!w.collisionArrays&&H&&w.deserializeCollisionBoxes(H);var Xe=function(ht,Ut){if(!s[ht.crossTileID])if(K)c.placements[ht.crossTileID]=new ns(!1,!1,!1);else{var Yt,Ot=!1,Ft=!1,Xt=!0,Rt=null,Dt={box:null,offscreen:null},Li={box:null,offscreen:null},si=null,hn=null,Ki=0,ri=0,fi=0;Ut.textFeatureIndex?Ki=Ut.textFeatureIndex:ht.useRuntimeCollisionCircles&&(Ki=ht.featureIndex),Ut.verticalTextFeatureIndex&&(ri=Ut.verticalTextFeatureIndex);var Hn=Ut.textBox;if(Hn){var bn=function(Er){var ta=a.WritingMode.horizontal;if(w.allowVerticalPlacement&&!Er&&c.prevPlacement){var Cn=c.prevPlacement.placedOrientations[ht.crossTileID];Cn&&(c.placedOrientations[ht.crossTileID]=Cn,c.markUsedOrientation(w,ta=Cn,ht))}return ta},Qa=function(Er,ta){if(w.allowVerticalPlacement&&ht.numVerticalGlyphVertices>0&&Ut.verticalTextBox)for(var Cn=0,Po=w.writingModes;Cn<Po.length&&(Po[Cn]===a.WritingMode.vertical?(Dt=ta(),Li=Dt):Dt=Er(),!(Dt&&Dt.box&&Dt.box.length));Cn+=1);else Dt=Er()};if(S.get("text-variable-anchor")){var An=S.get("text-variable-anchor");if(c.prevPlacement&&c.prevPlacement.variableOffsets[ht.crossTileID]){var _a=c.prevPlacement.variableOffsets[ht.crossTileID];An.indexOf(_a.anchor)>0&&(An=An.filter(function(Er){return Er!==_a.anchor})).unshift(_a.anchor)}var sa=function(Er,ta,Cn){for(var Po=Er.x2-Er.x1,jh=Er.y2-Er.y1,nl=ht.textBoxScale,Gh=ke&&!fe?ta:null,Ts={box:[],offscreen:!1},Ic=se?2*An.length:An.length,Wo=0;Wo<Ic;++Wo){var al=c.attemptAnchorPlacement(An[Wo%An.length],Er,Po,jh,nl,ve,Ie,Z,P,te,Wo>=An.length,ht,w,Cn,Gh);if(al&&(Ts=al.placedGlyphBoxes)&&Ts.box&&Ts.box.length){Ot=!0,Rt=al.shift;break}}return Ts};Qa(function(){return sa(Hn,Ut.iconBox,a.WritingMode.horizontal)},function(){var Er=Ut.verticalTextBox;return w.allowVerticalPlacement&&!(Dt&&Dt.box&&Dt.box.length)&&ht.numVerticalGlyphVertices>0&&Er?sa(Er,Ut.verticalIconBox,a.WritingMode.vertical):{box:null,offscreen:null}}),Dt&&(Ot=Dt.box,Xt=Dt.offscreen);var Ss=bn(Dt&&Dt.box);if(!Ot&&c.prevPlacement){var Ho=c.prevPlacement.variableOffsets[ht.crossTileID];Ho&&(c.variableOffsets[ht.crossTileID]=Ho,c.markUsedJustification(w,Ho.anchor,ht,Ss))}}else{var $a=function(Er,ta){var Cn=c.collisionIndex.placeCollisionBox(Er,se,Z,P,te.predicate);return Cn&&Cn.box&&Cn.box.length&&(c.markUsedOrientation(w,ta,ht),c.placedOrientations[ht.crossTileID]=ta),Cn};Qa(function(){return $a(Hn,a.WritingMode.horizontal)},function(){var Er=Ut.verticalTextBox;return w.allowVerticalPlacement&&ht.numVerticalGlyphVertices>0&&Er?$a(Er,a.WritingMode.vertical):{box:null,offscreen:null}}),bn(Dt&&Dt.box&&Dt.box.length)}}if(Ot=(Yt=Dt)&&Yt.box&&Yt.box.length>0,Xt=Yt&&Yt.offscreen,ht.useRuntimeCollisionCircles){var Xo=w.text.placedSymbolArray.get(ht.centerJustifiedTextSymbolIndex),Es=a.evaluateSizeForFeature(w.textSizeData,re,Xo),Pa=S.get("text-padding");si=c.collisionIndex.placeCollisionCircles(se,Xo,w.lineVertexArray,w.glyphOffsetArray,Es,P,C,O,o,Ie,te.predicate,ht.collisionCircleDiameter,Pa),Ot=se||si.circles.length>0&&!si.collisionDetected,Xt=Xt&&si.offscreen}if(Ut.iconFeatureIndex&&(fi=Ut.iconFeatureIndex),Ut.iconBox){var ks=function(Er){var ta=ke&&Rt?Qn(Er,Rt.x,Rt.y,ve,Ie,c.transform.angle):Er;return c.collisionIndex.placeCollisionBox(ta,fe,Z,P,te.predicate)};Ft=Li&&Li.box&&Li.box.length&&Ut.verticalIconBox?(hn=ks(Ut.verticalIconBox)).box.length>0:(hn=ks(Ut.iconBox)).box.length>0,Xt=Xt&&hn.offscreen}var za=ce||ht.numHorizontalGlyphVertices===0&&ht.numVerticalGlyphVertices===0,Ri=Y||ht.numIconVertices===0;if(za||Ri?Ri?za||(Ft=Ft&&Ot):Ot=Ft&&Ot:Ft=Ot=Ft&&Ot,Ot&&Yt&&Yt.box&&c.collisionIndex.insertCollisionBox(Yt.box,S.get("text-ignore-placement"),w.bucketInstanceId,Li&&Li.box&&ri?ri:Ki,te.ID),Ft&&hn&&c.collisionIndex.insertCollisionBox(hn.box,S.get("icon-ignore-placement"),w.bucketInstanceId,fi,te.ID),si&&(Ot&&c.collisionIndex.insertCollisionCircles(si.circles,S.get("text-ignore-placement"),w.bucketInstanceId,Ki,te.ID),o)){var La=w.bucketInstanceId,eo=c.collisionCircleArrays[La];eo===void 0&&(eo=c.collisionCircleArrays[La]=new Ti);for(var Io=0;Io<si.circles.length;Io+=4)eo.circles.push(si.circles[Io+0]),eo.circles.push(si.circles[Io+1]),eo.circles.push(si.circles[Io+2]),eo.circles.push(si.collisionDetected?1:0)}c.placements[ht.crossTileID]=new ns(Ot||Ne,Ft||Je,Xt||w.justReloaded),s[ht.crossTileID]=!0}};if(Pe)for(var ct=w.getSortedSymbolIndexes(this.transform.angle),Et=ct.length-1;Et>=0;--Et){var Ct=ct[Et];Xe(w.symbolInstances.get(Ct),w.collisionArrays[Ct])}else for(var At=n.symbolInstanceStart;At<n.symbolInstanceEnd;At++)Xe(w.symbolInstances.get(At),w.collisionArrays[At]);if(o&&w.bucketInstanceId in this.collisionCircleArrays){var yr=this.collisionCircleArrays[w.bucketInstanceId];a.invert(yr.invProjMatrix,P),yr.viewportMatrix=this.collisionIndex.getViewportMatrix()}w.justReloaded=!1},ji.prototype.markUsedJustification=function(n,s,o,c){var _;_=c===a.WritingMode.vertical?o.verticalPlacedTextSymbolIndex:{left:o.leftJustifiedTextSymbolIndex,center:o.centerJustifiedTextSymbolIndex,right:o.rightJustifiedTextSymbolIndex}[a.getAnchorJustification(s)];for(var w=0,S=[o.leftJustifiedTextSymbolIndex,o.centerJustifiedTextSymbolIndex,o.rightJustifiedTextSymbolIndex,o.verticalPlacedTextSymbolIndex];w<S.length;w+=1){var P=S[w];P>=0&&(n.text.placedSymbolArray.get(P).crossTileID=_>=0&&P!==_?0:o.crossTileID)}},ji.prototype.markUsedOrientation=function(n,s,o){for(var c=s===a.WritingMode.horizontal||s===a.WritingMode.horizontalOnly?s:0,_=s===a.WritingMode.vertical?s:0,w=0,S=[o.leftJustifiedTextSymbolIndex,o.centerJustifiedTextSymbolIndex,o.rightJustifiedTextSymbolIndex];w<S.length;w+=1)n.text.placedSymbolArray.get(S[w]).placedOrientation=c;o.verticalPlacedTextSymbolIndex&&(n.text.placedSymbolArray.get(o.verticalPlacedTextSymbolIndex).placedOrientation=_)},ji.prototype.commit=function(n){this.commitTime=n,this.zoomAtLastRecencyCheck=this.transform.zoom;var s=this.prevPlacement,o=!1;this.prevZoomAdjustment=s?s.zoomAdjustment(this.transform.zoom):0;var c=s?s.symbolFadeChange(n):1,_=s?s.opacities:{},w=s?s.variableOffsets:{},S=s?s.placedOrientations:{};for(var P in this.placements){var C=this.placements[P],O=_[P];O?(this.opacities[P]=new gn(O,c,C.text,C.icon),o=o||C.text!==O.text.placed||C.icon!==O.icon.placed):(this.opacities[P]=new gn(null,c,C.text,C.icon,C.skipFade),o=o||C.text||C.icon)}for(var Z in _){var K=_[Z];if(!this.opacities[Z]){var H=new gn(K,c,!1,!1);H.isHidden()||(this.opacities[Z]=H,o=o||K.text.placed||K.icon.placed)}}for(var re in w)this.variableOffsets[re]||!this.opacities[re]||this.opacities[re].isHidden()||(this.variableOffsets[re]=w[re]);for(var te in S)this.placedOrientations[te]||!this.opacities[te]||this.opacities[te].isHidden()||(this.placedOrientations[te]=S[te]);o?this.lastPlacementChangeTime=n:typeof this.lastPlacementChangeTime!="number"&&(this.lastPlacementChangeTime=s?s.lastPlacementChangeTime:n)},ji.prototype.updateLayerOpacities=function(n,s){for(var o={},c=0,_=s;c<_.length;c+=1){var w=_[c],S=w.getBucket(n);S&&w.latestFeatureIndex&&n.id===S.layerIds[0]&&this.updateBucketOpacities(S,o,w.collisionBoxArray)}},ji.prototype.updateBucketOpacities=function(n,s,o){var c=this;n.hasTextData()&&n.text.opacityVertexArray.clear(),n.hasIconData()&&n.icon.opacityVertexArray.clear(),n.hasIconCollisionBoxData()&&n.iconCollisionBox.collisionVertexArray.clear(),n.hasTextCollisionBoxData()&&n.textCollisionBox.collisionVertexArray.clear();var _=n.layers[0].layout,w=new gn(null,0,!1,!1,!0),S=_.get("text-allow-overlap"),P=_.get("icon-allow-overlap"),C=_.get("text-variable-anchor"),O=_.get("text-rotation-alignment")==="map",Z=_.get("text-pitch-alignment")==="map",K=_.get("icon-text-fit")!=="none",H=new gn(null,0,S&&(P||!n.hasIconData()||_.get("icon-optional")),P&&(S||!n.hasTextData()||_.get("text-optional")),!0);!n.collisionArrays&&o&&(n.hasIconCollisionBoxData()||n.hasTextCollisionBoxData())&&n.deserializeCollisionBoxes(o);for(var re=function(se,fe,ve){for(var Ie=0;Ie<fe/4;Ie++)se.opacityVertexArray.emplaceBack(ve)},te=function(se){var fe=n.symbolInstances.get(se),ve=fe.numHorizontalGlyphVertices,Ie=fe.numVerticalGlyphVertices,ke=fe.crossTileID,Pe=c.opacities[ke];s[ke]?Pe=w:Pe||(c.opacities[ke]=Pe=H),s[ke]=!0;var Ne=fe.numIconVertices>0,Je=c.placedOrientations[fe.crossTileID],Xe=Je===a.WritingMode.vertical,ct=Je===a.WritingMode.horizontal||Je===a.WritingMode.horizontalOnly;if(ve>0||Ie>0){var Et=Os(Pe.text);re(n.text,ve,Xe?Ua:Et),re(n.text,Ie,ct?Ua:Et);var Ct=Pe.text.isHidden();[fe.rightJustifiedTextSymbolIndex,fe.centerJustifiedTextSymbolIndex,fe.leftJustifiedTextSymbolIndex].forEach(function(Dt){Dt>=0&&(n.text.placedSymbolArray.get(Dt).hidden=Ct||Xe?1:0)}),fe.verticalPlacedTextSymbolIndex>=0&&(n.text.placedSymbolArray.get(fe.verticalPlacedTextSymbolIndex).hidden=Ct||ct?1:0);var At=c.variableOffsets[fe.crossTileID];At&&c.markUsedJustification(n,At.anchor,fe,Je);var yr=c.placedOrientations[fe.crossTileID];yr&&(c.markUsedJustification(n,"left",fe,yr),c.markUsedOrientation(n,yr,fe))}if(Ne){var ht=Os(Pe.icon),Ut=!(K&&fe.verticalPlacedIconSymbolIndex&&Xe);fe.placedIconSymbolIndex>=0&&(re(n.icon,fe.numIconVertices,Ut?ht:Ua),n.icon.placedSymbolArray.get(fe.placedIconSymbolIndex).hidden=Pe.icon.isHidden()),fe.verticalPlacedIconSymbolIndex>=0&&(re(n.icon,fe.numVerticalIconVertices,Ut?Ua:ht),n.icon.placedSymbolArray.get(fe.verticalPlacedIconSymbolIndex).hidden=Pe.icon.isHidden())}if(n.hasIconCollisionBoxData()||n.hasTextCollisionBoxData()){var Yt=n.collisionArrays[se];if(Yt){var Ot=new a.Point(0,0);if(Yt.textBox||Yt.verticalTextBox){var Ft=!0;if(C){var Xt=c.variableOffsets[ke];Xt?(Ot=Ii(Xt.anchor,Xt.width,Xt.height,Xt.textOffset,Xt.textBoxScale),O&&Ot._rotate(Z?c.transform.angle:-c.transform.angle)):Ft=!1}Yt.textBox&&wa(n.textCollisionBox.collisionVertexArray,Pe.text.placed,!Ft||Xe,Ot.x,Ot.y),Yt.verticalTextBox&&wa(n.textCollisionBox.collisionVertexArray,Pe.text.placed,!Ft||ct,Ot.x,Ot.y)}var Rt=!!(!ct&&Yt.verticalIconBox);Yt.iconBox&&wa(n.iconCollisionBox.collisionVertexArray,Pe.icon.placed,Rt,K?Ot.x:0,K?Ot.y:0),Yt.verticalIconBox&&wa(n.iconCollisionBox.collisionVertexArray,Pe.icon.placed,!Rt,K?Ot.x:0,K?Ot.y:0)}}},ce=0;ce<n.symbolInstances.length;ce++)te(ce);if(n.sortFeatures(this.transform.angle),this.retainedQueryData[n.bucketInstanceId]&&(this.retainedQueryData[n.bucketInstanceId].featureSortOrder=n.featureSortOrder),n.hasTextData()&&n.text.opacityVertexBuffer&&n.text.opacityVertexBuffer.updateData(n.text.opacityVertexArray),n.hasIconData()&&n.icon.opacityVertexBuffer&&n.icon.opacityVertexBuffer.updateData(n.icon.opacityVertexArray),n.hasIconCollisionBoxData()&&n.iconCollisionBox.collisionVertexBuffer&&n.iconCollisionBox.collisionVertexBuffer.updateData(n.iconCollisionBox.collisionVertexArray),n.hasTextCollisionBoxData()&&n.textCollisionBox.collisionVertexBuffer&&n.textCollisionBox.collisionVertexBuffer.updateData(n.textCollisionBox.collisionVertexArray),n.bucketInstanceId in this.collisionCircleArrays){var Y=this.collisionCircleArrays[n.bucketInstanceId];n.placementInvProjMatrix=Y.invProjMatrix,n.placementViewportMatrix=Y.viewportMatrix,n.collisionCircleArray=Y.circles,delete this.collisionCircleArrays[n.bucketInstanceId]}},ji.prototype.symbolFadeChange=function(n){return this.fadeDuration===0?1:(n-this.commitTime)/this.fadeDuration+this.prevZoomAdjustment},ji.prototype.zoomAdjustment=function(n){return Math.max(0,(this.transform.zoom-n)/1.5)},ji.prototype.hasTransitions=function(n){return this.stale||n-this.lastPlacementChangeTime<this.fadeDuration},ji.prototype.stillRecent=function(n,s){var o=this.zoomAtLastRecencyCheck===s?1-this.zoomAdjustment(s):1;return this.zoomAtLastRecencyCheck=s,this.commitTime+this.fadeDuration*o>n},ji.prototype.setStale=function(){this.stale=!0};var as=Math.pow(2,25),Ol=Math.pow(2,24),uo=Math.pow(2,17),Nl=Math.pow(2,16),Ro=Math.pow(2,9),Ul=Math.pow(2,8),Bo=Math.pow(2,1);function Os(n){if(n.opacity===0&&!n.placed)return 0;if(n.opacity===1&&n.placed)return 4294967295;var s=n.placed?1:0,o=Math.floor(127*n.opacity);return o*as+s*Ol+o*uo+s*Nl+o*Ro+s*Ul+o*Bo+s}var Ua=0,os=function(n){this._sortAcrossTiles=n.layout.get("symbol-z-order")!=="viewport-y"&&n.layout.get("symbol-sort-key").constantOr(1)!==void 0,this._currentTileIndex=0,this._currentPartIndex=0,this._seenCrossTileIDs={},this._bucketParts=[]};os.prototype.continuePlacement=function(n,s,o,c,_){for(var w=this._bucketParts;this._currentTileIndex<n.length;)if(s.getBucketParts(w,c,n[this._currentTileIndex],this._sortAcrossTiles),this._currentTileIndex++,_())return!0;for(this._sortAcrossTiles&&(this._sortAcrossTiles=!1,w.sort(function(S,P){return S.sortKey-P.sortKey}));this._currentPartIndex<w.length;)if(s.placeLayerBucketPart(w[this._currentPartIndex],this._seenCrossTileIDs,o),this._currentPartIndex++,_())return!0;return!1};var co=function(n,s,o,c,_,w,S){this.placement=new ji(n,_,w,S),this._currentPlacementIndex=s.length-1,this._forceFullPlacement=o,this._showCollisionBoxes=c,this._done=!1};co.prototype.isDone=function(){return this._done},co.prototype.continuePlacement=function(n,s,o){for(var c=this,_=a.browser.now(),w=function(){var C=a.browser.now()-_;return!c._forceFullPlacement&&C>2};this._currentPlacementIndex>=0;){var S=s[n[this._currentPlacementIndex]],P=this.placement.collisionIndex.transform.zoom;if(S.type==="symbol"&&(!S.minzoom||S.minzoom<=P)&&(!S.maxzoom||S.maxzoom>P)){if(this._inProgressLayer||(this._inProgressLayer=new os(S)),this._inProgressLayer.continuePlacement(o[S.source],this.placement,this._showCollisionBoxes,S,w))return;delete this._inProgressLayer}this._currentPlacementIndex--}this._done=!0},co.prototype.commit=function(n){return this.placement.commit(n),this.placement};var Ns=512/a.EXTENT/2,Va=function(n,s,o){this.tileID=n,this.indexedSymbolInstances={},this.bucketInstanceId=o;for(var c=0;c<s.length;c++){var _=s.get(c),w=_.key;this.indexedSymbolInstances[w]||(this.indexedSymbolInstances[w]=[]),this.indexedSymbolInstances[w].push({crossTileID:_.crossTileID,coord:this.getScaledCoordinates(_,n)})}};Va.prototype.getScaledCoordinates=function(n,s){var o=Ns/Math.pow(2,s.canonical.z-this.tileID.canonical.z);return{x:Math.floor((s.canonical.x*a.EXTENT+n.anchorX)*o),y:Math.floor((s.canonical.y*a.EXTENT+n.anchorY)*o)}},Va.prototype.findMatches=function(n,s,o){for(var c=this.tileID.canonical.z<s.canonical.z?1:Math.pow(2,this.tileID.canonical.z-s.canonical.z),_=0;_<n.length;_++){var w=n.get(_);if(!w.crossTileID){var S=this.indexedSymbolInstances[w.key];if(S)for(var P=this.getScaledCoordinates(w,s),C=0,O=S;C<O.length;C+=1){var Z=O[C];if(Math.abs(Z.coord.x-P.x)<=c&&Math.abs(Z.coord.y-P.y)<=c&&!o[Z.crossTileID]){o[Z.crossTileID]=!0,w.crossTileID=Z.crossTileID;break}}}}};var Un=function(){this.maxCrossTileID=0};Un.prototype.generate=function(){return++this.maxCrossTileID};var Sa=function(){this.indexes={},this.usedCrossTileIDs={},this.lng=0};Sa.prototype.handleWrapJump=function(n){var s=Math.round((n-this.lng)/360);if(s!==0)for(var o in this.indexes){var c=this.indexes[o],_={};for(var w in c){var S=c[w];S.tileID=S.tileID.unwrapTo(S.tileID.wrap+s),_[S.tileID.key]=S}this.indexes[o]=_}this.lng=n},Sa.prototype.addBucket=function(n,s,o){if(this.indexes[n.overscaledZ]&&this.indexes[n.overscaledZ][n.key]){if(this.indexes[n.overscaledZ][n.key].bucketInstanceId===s.bucketInstanceId)return!1;this.removeBucketCrossTileIDs(n.overscaledZ,this.indexes[n.overscaledZ][n.key])}for(var c=0;c<s.symbolInstances.length;c++)s.symbolInstances.get(c).crossTileID=0;this.usedCrossTileIDs[n.overscaledZ]||(this.usedCrossTileIDs[n.overscaledZ]={});var _=this.usedCrossTileIDs[n.overscaledZ];for(var w in this.indexes){var S=this.indexes[w];if(Number(w)>n.overscaledZ)for(var P in S){var C=S[P];C.tileID.isChildOf(n)&&C.findMatches(s.symbolInstances,n,_)}else{var O=S[n.scaledTo(Number(w)).key];O&&O.findMatches(s.symbolInstances,n,_)}}for(var Z=0;Z<s.symbolInstances.length;Z++){var K=s.symbolInstances.get(Z);K.crossTileID||(K.crossTileID=o.generate(),_[K.crossTileID]=!0)}return this.indexes[n.overscaledZ]===void 0&&(this.indexes[n.overscaledZ]={}),this.indexes[n.overscaledZ][n.key]=new Va(n,s.symbolInstances,s.bucketInstanceId),!0},Sa.prototype.removeBucketCrossTileIDs=function(n,s){for(var o in s.indexedSymbolInstances)for(var c=0,_=s.indexedSymbolInstances[o];c<_.length;c+=1)delete this.usedCrossTileIDs[n][_[c].crossTileID]},Sa.prototype.removeStaleBuckets=function(n){var s=!1;for(var o in this.indexes){var c=this.indexes[o];for(var _ in c)n[c[_].bucketInstanceId]||(this.removeBucketCrossTileIDs(o,c[_]),delete c[_],s=!0)}return s};var _e=function(){this.layerIndexes={},this.crossTileIDs=new Un,this.maxBucketInstanceId=0,this.bucketsInCurrentPlacement={}};_e.prototype.addLayer=function(n,s,o){var c=this.layerIndexes[n.id];c===void 0&&(c=this.layerIndexes[n.id]=new Sa);var _=!1,w={};c.handleWrapJump(o);for(var S=0,P=s;S<P.length;S+=1){var C=P[S],O=C.getBucket(n);O&&n.id===O.layerIds[0]&&(O.bucketInstanceId||(O.bucketInstanceId=++this.maxBucketInstanceId),c.addBucket(C.tileID,O,this.crossTileIDs)&&(_=!0),w[O.bucketInstanceId]=!0)}return c.removeStaleBuckets(w)&&(_=!0),_},_e.prototype.pruneUnusedLayers=function(n){var s={};for(var o in n.forEach(function(c){s[c]=!0}),this.layerIndexes)s[o]||delete this.layerIndexes[o]};var cn=function(n,s){return a.emitValidationErrors(n,s&&s.filter(function(o){return o.identifier!=="source.canvas"}))},Gi=a.pick(Qe,["addLayer","removeLayer","setPaintProperty","setLayoutProperty","setFilter","addSource","removeSource","setLayerZoomRange","setLight","setTransition","setGeoJSONSourceData"]),jr=a.pick(Qe,["setCenter","setZoom","setBearing","setPitch"]),Ea=function(){var n={},s=a.styleSpec.$version;for(var o in a.styleSpec.$root){var c,_=a.styleSpec.$root[o];_.required&&(c=o==="version"?s:_.type==="array"?[]:{})!=null&&(n[o]=c)}return n}(),Vn=function(n){function s(o,c){var _=this;c===void 0&&(c={}),n.call(this),this.map=o,this.dispatcher=new Bt(Se(),this),this.imageManager=new ge,this.imageManager.setEventedParent(this),this.glyphManager=new je(o._requestManager,c.localIdeographFontFamily),this.lineAtlas=new qe(256,512),this.crossTileSymbolIndex=new _e,this._layers={},this._serializedLayers={},this._order=[],this.sourceCaches={},this.zoomHistory=new a.ZoomHistory,this._loaded=!1,this._availableImages=[],this._resetUpdates(),this.dispatcher.broadcast("setReferrer",a.getReferrer());var w=this;this._rtlTextPluginCallback=s.registerForPluginStateChange(function(S){w.dispatcher.broadcast("syncRTLPluginState",{pluginStatus:S.pluginStatus,pluginURL:S.pluginURL},function(P,C){if(a.triggerPluginCompletionEvent(P),C&&C.every(function(Z){return Z}))for(var O in w.sourceCaches)w.sourceCaches[O].reload()})}),this.on("data",function(S){if(S.dataType==="source"&&S.sourceDataType==="metadata"){var P=_.sourceCaches[S.sourceId];if(P){var C=P.getSource();if(C&&C.vectorLayerIds)for(var O in _._layers){var Z=_._layers[O];Z.source===C.id&&_._validateLayer(Z)}}}})}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype.loadURL=function(o,c){var _=this;c===void 0&&(c={}),this.fire(new a.Event("dataloading",{dataType:"style"}));var w=typeof c.validate=="boolean"?c.validate:!a.isMapboxURL(o);o=this.map._requestManager.normalizeStyleURL(o,c.accessToken);var S=this.map._requestManager.transformRequest(o,a.ResourceType.Style);this._request=a.getJSON(S,function(P,C){_._request=null,P?_.fire(new a.ErrorEvent(P)):C&&_._load(C,w)})},s.prototype.loadJSON=function(o,c){var _=this;c===void 0&&(c={}),this.fire(new a.Event("dataloading",{dataType:"style"})),this._request=a.browser.frame(function(){_._request=null,_._load(o,c.validate!==!1)})},s.prototype.loadEmpty=function(){this.fire(new a.Event("dataloading",{dataType:"style"})),this._load(Ea,!1)},s.prototype._load=function(o,c){if(!c||!cn(this,a.validateStyle(o))){for(var _ in this._loaded=!0,this.stylesheet=o,o.sources)this.addSource(_,o.sources[_],{validate:!1});o.sprite?this._loadSprite(o.sprite):this.imageManager.setLoaded(!0),this.glyphManager.setURL(o.glyphs);var w=Ye(this.stylesheet.layers);this._order=w.map(function(O){return O.id}),this._layers={},this._serializedLayers={};for(var S=0,P=w;S<P.length;S+=1){var C=P[S];(C=a.createStyleLayer(C)).setEventedParent(this,{layer:{id:C.id}}),this._layers[C.id]=C,this._serializedLayers[C.id]=C.serialize()}this.dispatcher.broadcast("setLayers",this._serializeLayers(this._order)),this.light=new nr(this.stylesheet.light),this.fire(new a.Event("data",{dataType:"style"})),this.fire(new a.Event("style.load"))}},s.prototype._loadSprite=function(o){var c=this;this._spriteRequest=function(_,w,S){var P,C,O,Z=a.browser.devicePixelRatio>1?"@2x":"",K=a.getJSON(w.transformRequest(w.normalizeSpriteURL(_,Z,".json"),a.ResourceType.SpriteJSON),function(te,ce){K=null,O||(O=te,P=ce,re())}),H=a.getImage(w.transformRequest(w.normalizeSpriteURL(_,Z,".png"),a.ResourceType.SpriteImage),function(te,ce){H=null,O||(O=te,C=ce,re())});function re(){if(O)S(O);else if(P&&C){var te=a.browser.getImageData(C),ce={};for(var Y in P){var se=P[Y],fe=se.width,ve=se.height,Ie=se.x,ke=se.y,Pe=se.sdf,Ne=se.pixelRatio,Je=se.stretchX,Xe=se.stretchY,ct=se.content,Et=new a.RGBAImage({width:fe,height:ve});a.RGBAImage.copy(te,Et,{x:Ie,y:ke},{x:0,y:0},{width:fe,height:ve}),ce[Y]={data:Et,pixelRatio:Ne,sdf:Pe,stretchX:Je,stretchY:Xe,content:ct}}S(null,ce)}}return{cancel:function(){K&&(K.cancel(),K=null),H&&(H.cancel(),H=null)}}}(o,this.map._requestManager,function(_,w){if(c._spriteRequest=null,_)c.fire(new a.ErrorEvent(_));else if(w)for(var S in w)c.imageManager.addImage(S,w[S]);c.imageManager.setLoaded(!0),c._availableImages=c.imageManager.listImages(),c.dispatcher.broadcast("setImages",c._availableImages),c.fire(new a.Event("data",{dataType:"style"}))})},s.prototype._validateLayer=function(o){var c=this.sourceCaches[o.source];if(c){var _=o.sourceLayer;if(_){var w=c.getSource();(w.type==="geojson"||w.vectorLayerIds&&w.vectorLayerIds.indexOf(_)===-1)&&this.fire(new a.ErrorEvent(new Error('Source layer "'+_+'" does not exist on source "'+w.id+'" as specified by style layer "'+o.id+'"')))}}},s.prototype.loaded=function(){if(!this._loaded||Object.keys(this._updatedSources).length)return!1;for(var o in this.sourceCaches)if(!this.sourceCaches[o].loaded())return!1;return!!this.imageManager.isLoaded()},s.prototype._serializeLayers=function(o){for(var c=[],_=0,w=o;_<w.length;_+=1){var S=this._layers[w[_]];S.type!=="custom"&&c.push(S.serialize())}return c},s.prototype.hasTransitions=function(){if(this.light&&this.light.hasTransition())return!0;for(var o in this.sourceCaches)if(this.sourceCaches[o].hasTransition())return!0;for(var c in this._layers)if(this._layers[c].hasTransition())return!0;return!1},s.prototype._checkLoaded=function(){if(!this._loaded)throw new Error("Style is not done loading")},s.prototype.update=function(o){if(this._loaded){var c=this._changed;if(this._changed){var _=Object.keys(this._updatedLayers),w=Object.keys(this._removedLayers);for(var S in(_.length||w.length)&&this._updateWorkerLayers(_,w),this._updatedSources){var P=this._updatedSources[S];P==="reload"?this._reloadSource(S):P==="clear"&&this._clearSource(S)}for(var C in this._updateTilesForChangedImages(),this._updatedPaintProps)this._layers[C].updateTransitions(o);this.light.updateTransitions(o),this._resetUpdates()}var O={};for(var Z in this.sourceCaches){var K=this.sourceCaches[Z];O[Z]=K.used,K.used=!1}for(var H=0,re=this._order;H<re.length;H+=1){var te=this._layers[re[H]];te.recalculate(o,this._availableImages),!te.isHidden(o.zoom)&&te.source&&(this.sourceCaches[te.source].used=!0)}for(var ce in O){var Y=this.sourceCaches[ce];O[ce]!==Y.used&&Y.fire(new a.Event("data",{sourceDataType:"visibility",dataType:"source",sourceId:ce}))}this.light.recalculate(o),this.z=o.zoom,c&&this.fire(new a.Event("data",{dataType:"style"}))}},s.prototype._updateTilesForChangedImages=function(){var o=Object.keys(this._changedImages);if(o.length){for(var c in this.sourceCaches)this.sourceCaches[c].reloadTilesForDependencies(["icons","patterns"],o);this._changedImages={}}},s.prototype._updateWorkerLayers=function(o,c){this.dispatcher.broadcast("updateLayers",{layers:this._serializeLayers(o),removedIds:c})},s.prototype._resetUpdates=function(){this._changed=!1,this._updatedLayers={},this._removedLayers={},this._updatedSources={},this._updatedPaintProps={},this._changedImages={}},s.prototype.setState=function(o){var c=this;if(this._checkLoaded(),cn(this,a.validateStyle(o)))return!1;(o=a.clone$1(o)).layers=Ye(o.layers);var _=function(S,P){if(!S)return[{command:Qe.setStyle,args:[P]}];var C=[];try{if(!a.deepEqual(S.version,P.version))return[{command:Qe.setStyle,args:[P]}];a.deepEqual(S.center,P.center)||C.push({command:Qe.setCenter,args:[P.center]}),a.deepEqual(S.zoom,P.zoom)||C.push({command:Qe.setZoom,args:[P.zoom]}),a.deepEqual(S.bearing,P.bearing)||C.push({command:Qe.setBearing,args:[P.bearing]}),a.deepEqual(S.pitch,P.pitch)||C.push({command:Qe.setPitch,args:[P.pitch]}),a.deepEqual(S.sprite,P.sprite)||C.push({command:Qe.setSprite,args:[P.sprite]}),a.deepEqual(S.glyphs,P.glyphs)||C.push({command:Qe.setGlyphs,args:[P.glyphs]}),a.deepEqual(S.transition,P.transition)||C.push({command:Qe.setTransition,args:[P.transition]}),a.deepEqual(S.light,P.light)||C.push({command:Qe.setLight,args:[P.light]});var O={},Z=[];(function(H,re,te,ce){var Y;for(Y in re=re||{},H=H||{})H.hasOwnProperty(Y)&&(re.hasOwnProperty(Y)||it(Y,te,ce));for(Y in re)re.hasOwnProperty(Y)&&(H.hasOwnProperty(Y)?a.deepEqual(H[Y],re[Y])||(H[Y].type==="geojson"&&re[Y].type==="geojson"&&jt(H,re,Y)?te.push({command:Qe.setGeoJSONSourceData,args:[Y,re[Y].data]}):Wt(Y,re,te,ce)):Vt(Y,re,te))})(S.sources,P.sources,Z,O);var K=[];S.layers&&S.layers.forEach(function(H){O[H.source]?C.push({command:Qe.removeLayer,args:[H.id]}):K.push(H)}),C=C.concat(Z),function(H,re,te){re=re||[];var ce,Y,se,fe,ve,Ie,ke,Pe=(H=H||[]).map(sr),Ne=re.map(sr),Je=H.reduce(er,{}),Xe=re.reduce(er,{}),ct=Pe.slice(),Et=Object.create(null);for(ce=0,Y=0;ce<Pe.length;ce++)Xe.hasOwnProperty(se=Pe[ce])?Y++:(te.push({command:Qe.removeLayer,args:[se]}),ct.splice(ct.indexOf(se,Y),1));for(ce=0,Y=0;ce<Ne.length;ce++)ct[ct.length-1-ce]!==(se=Ne[Ne.length-1-ce])&&(Je.hasOwnProperty(se)?(te.push({command:Qe.removeLayer,args:[se]}),ct.splice(ct.lastIndexOf(se,ct.length-Y),1)):Y++,te.push({command:Qe.addLayer,args:[Xe[se],Ie=ct[ct.length-ce]]}),ct.splice(ct.length-ce,0,se),Et[se]=!0);for(ce=0;ce<Ne.length;ce++)if(fe=Je[se=Ne[ce]],ve=Xe[se],!Et[se]&&!a.deepEqual(fe,ve))if(a.deepEqual(fe.source,ve.source)&&a.deepEqual(fe["source-layer"],ve["source-layer"])&&a.deepEqual(fe.type,ve.type)){for(ke in Ht(fe.layout,ve.layout,te,se,null,Qe.setLayoutProperty),Ht(fe.paint,ve.paint,te,se,null,Qe.setPaintProperty),a.deepEqual(fe.filter,ve.filter)||te.push({command:Qe.setFilter,args:[se,ve.filter]}),a.deepEqual(fe.minzoom,ve.minzoom)&&a.deepEqual(fe.maxzoom,ve.maxzoom)||te.push({command:Qe.setLayerZoomRange,args:[se,ve.minzoom,ve.maxzoom]}),fe)fe.hasOwnProperty(ke)&&ke!=="layout"&&ke!=="paint"&&ke!=="filter"&&ke!=="metadata"&&ke!=="minzoom"&&ke!=="maxzoom"&&(ke.indexOf("paint.")===0?Ht(fe[ke],ve[ke],te,se,ke.slice(6),Qe.setPaintProperty):a.deepEqual(fe[ke],ve[ke])||te.push({command:Qe.setLayerProperty,args:[se,ke,ve[ke]]}));for(ke in ve)ve.hasOwnProperty(ke)&&!fe.hasOwnProperty(ke)&&ke!=="layout"&&ke!=="paint"&&ke!=="filter"&&ke!=="metadata"&&ke!=="minzoom"&&ke!=="maxzoom"&&(ke.indexOf("paint.")===0?Ht(fe[ke],ve[ke],te,se,ke.slice(6),Qe.setPaintProperty):a.deepEqual(fe[ke],ve[ke])||te.push({command:Qe.setLayerProperty,args:[se,ke,ve[ke]]}))}else te.push({command:Qe.removeLayer,args:[se]}),Ie=ct[ct.lastIndexOf(se)+1],te.push({command:Qe.addLayer,args:[ve,Ie]})}(K,P.layers,C)}catch(H){console.warn("Unable to compute style diff:",H),C=[{command:Qe.setStyle,args:[P]}]}return C}(this.serialize(),o).filter(function(S){return!(S.command in jr)});if(_.length===0)return!1;var w=_.filter(function(S){return!(S.command in Gi)});if(w.length>0)throw new Error("Unimplemented: "+w.map(function(S){return S.command}).join(", ")+".");return _.forEach(function(S){S.command!=="setTransition"&&c[S.command].apply(c,S.args)}),this.stylesheet=o,!0},s.prototype.addImage=function(o,c){if(this.getImage(o))return this.fire(new a.ErrorEvent(new Error("An image with this name already exists.")));this.imageManager.addImage(o,c),this._afterImageUpdated(o)},s.prototype.updateImage=function(o,c){this.imageManager.updateImage(o,c)},s.prototype.getImage=function(o){return this.imageManager.getImage(o)},s.prototype.removeImage=function(o){if(!this.getImage(o))return this.fire(new a.ErrorEvent(new Error("No image with this name exists.")));this.imageManager.removeImage(o),this._afterImageUpdated(o)},s.prototype._afterImageUpdated=function(o){this._availableImages=this.imageManager.listImages(),this._changedImages[o]=!0,this._changed=!0,this.dispatcher.broadcast("setImages",this._availableImages),this.fire(new a.Event("data",{dataType:"style"}))},s.prototype.listImages=function(){return this._checkLoaded(),this.imageManager.listImages()},s.prototype.addSource=function(o,c,_){var w=this;if(_===void 0&&(_={}),this._checkLoaded(),this.sourceCaches[o]!==void 0)throw new Error("There is already a source with this ID");if(!c.type)throw new Error("The type property must be defined, but only the following properties were given: "+Object.keys(c).join(", ")+".");if(!(["vector","raster","geojson","video","image"].indexOf(c.type)>=0&&this._validate(a.validateStyle.source,"sources."+o,c,null,_))){this.map&&this.map._collectResourceTiming&&(c.collectResourceTiming=!0);var S=this.sourceCaches[o]=new $(o,c,this.dispatcher);S.style=this,S.setEventedParent(this,function(){return{isSourceLoaded:w.loaded(),source:S.serialize(),sourceId:o}}),S.onAdd(this.map),this._changed=!0}},s.prototype.removeSource=function(o){if(this._checkLoaded(),this.sourceCaches[o]===void 0)throw new Error("There is no source with this ID");for(var c in this._layers)if(this._layers[c].source===o)return this.fire(new a.ErrorEvent(new Error('Source "'+o+'" cannot be removed while layer "'+c+'" is using it.')));var _=this.sourceCaches[o];delete this.sourceCaches[o],delete this._updatedSources[o],_.fire(new a.Event("data",{sourceDataType:"metadata",dataType:"source",sourceId:o})),_.setEventedParent(null),_.clearTiles(),_.onRemove&&_.onRemove(this.map),this._changed=!0},s.prototype.setGeoJSONSourceData=function(o,c){this._checkLoaded(),this.sourceCaches[o].getSource().setData(c),this._changed=!0},s.prototype.getSource=function(o){return this.sourceCaches[o]&&this.sourceCaches[o].getSource()},s.prototype.addLayer=function(o,c,_){_===void 0&&(_={}),this._checkLoaded();var w=o.id;if(this.getLayer(w))this.fire(new a.ErrorEvent(new Error('Layer with id "'+w+'" already exists on this map')));else{var S;if(o.type==="custom"){if(cn(this,a.validateCustomStyleLayer(o)))return;S=a.createStyleLayer(o)}else{if(typeof o.source=="object"&&(this.addSource(w,o.source),o=a.clone$1(o),o=a.extend(o,{source:w})),this._validate(a.validateStyle.layer,"layers."+w,o,{arrayIndex:-1},_))return;S=a.createStyleLayer(o),this._validateLayer(S),S.setEventedParent(this,{layer:{id:w}}),this._serializedLayers[S.id]=S.serialize()}var P=c?this._order.indexOf(c):this._order.length;if(c&&P===-1)this.fire(new a.ErrorEvent(new Error('Layer with id "'+c+'" does not exist on this map.')));else{if(this._order.splice(P,0,w),this._layerOrderChanged=!0,this._layers[w]=S,this._removedLayers[w]&&S.source&&S.type!=="custom"){var C=this._removedLayers[w];delete this._removedLayers[w],C.type!==S.type?this._updatedSources[S.source]="clear":(this._updatedSources[S.source]="reload",this.sourceCaches[S.source].pause())}this._updateLayer(S),S.onAdd&&S.onAdd(this.map)}}},s.prototype.moveLayer=function(o,c){if(this._checkLoaded(),this._changed=!0,this._layers[o]){if(o!==c){var _=this._order.indexOf(o);this._order.splice(_,1);var w=c?this._order.indexOf(c):this._order.length;c&&w===-1?this.fire(new a.ErrorEvent(new Error('Layer with id "'+c+'" does not exist on this map.'))):(this._order.splice(w,0,o),this._layerOrderChanged=!0)}}else this.fire(new a.ErrorEvent(new Error("The layer '"+o+"' does not exist in the map's style and cannot be moved.")))},s.prototype.removeLayer=function(o){this._checkLoaded();var c=this._layers[o];if(c){c.setEventedParent(null);var _=this._order.indexOf(o);this._order.splice(_,1),this._layerOrderChanged=!0,this._changed=!0,this._removedLayers[o]=c,delete this._layers[o],delete this._serializedLayers[o],delete this._updatedLayers[o],delete this._updatedPaintProps[o],c.onRemove&&c.onRemove(this.map)}else this.fire(new a.ErrorEvent(new Error("The layer '"+o+"' does not exist in the map's style and cannot be removed.")))},s.prototype.getLayer=function(o){return this._layers[o]},s.prototype.hasLayer=function(o){return o in this._layers},s.prototype.setLayerZoomRange=function(o,c,_){this._checkLoaded();var w=this.getLayer(o);w?w.minzoom===c&&w.maxzoom===_||(c!=null&&(w.minzoom=c),_!=null&&(w.maxzoom=_),this._updateLayer(w)):this.fire(new a.ErrorEvent(new Error("The layer '"+o+"' does not exist in the map's style and cannot have zoom extent.")))},s.prototype.setFilter=function(o,c,_){_===void 0&&(_={}),this._checkLoaded();var w=this.getLayer(o);if(w){if(!a.deepEqual(w.filter,c))return c==null?(w.filter=void 0,void this._updateLayer(w)):void(this._validate(a.validateStyle.filter,"layers."+w.id+".filter",c,null,_)||(w.filter=a.clone$1(c),this._updateLayer(w)))}else this.fire(new a.ErrorEvent(new Error("The layer '"+o+"' does not exist in the map's style and cannot be filtered.")))},s.prototype.getFilter=function(o){return a.clone$1(this.getLayer(o).filter)},s.prototype.setLayoutProperty=function(o,c,_,w){w===void 0&&(w={}),this._checkLoaded();var S=this.getLayer(o);S?a.deepEqual(S.getLayoutProperty(c),_)||(S.setLayoutProperty(c,_,w),this._updateLayer(S)):this.fire(new a.ErrorEvent(new Error("The layer '"+o+"' does not exist in the map's style and cannot be styled.")))},s.prototype.getLayoutProperty=function(o,c){var _=this.getLayer(o);if(_)return _.getLayoutProperty(c);this.fire(new a.ErrorEvent(new Error("The layer '"+o+"' does not exist in the map's style.")))},s.prototype.setPaintProperty=function(o,c,_,w){w===void 0&&(w={}),this._checkLoaded();var S=this.getLayer(o);S?a.deepEqual(S.getPaintProperty(c),_)||(S.setPaintProperty(c,_,w)&&this._updateLayer(S),this._changed=!0,this._updatedPaintProps[o]=!0):this.fire(new a.ErrorEvent(new Error("The layer '"+o+"' does not exist in the map's style and cannot be styled.")))},s.prototype.getPaintProperty=function(o,c){return this.getLayer(o).getPaintProperty(c)},s.prototype.setFeatureState=function(o,c){this._checkLoaded();var _=o.source,w=o.sourceLayer,S=this.sourceCaches[_];if(S!==void 0){var P=S.getSource().type;P==="geojson"&&w?this.fire(new a.ErrorEvent(new Error("GeoJSON sources cannot have a sourceLayer parameter."))):P!=="vector"||w?(o.id===void 0&&this.fire(new a.ErrorEvent(new Error("The feature id parameter must be provided."))),S.setFeatureState(w,o.id,c)):this.fire(new a.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")))}else this.fire(new a.ErrorEvent(new Error("The source '"+_+"' does not exist in the map's style.")))},s.prototype.removeFeatureState=function(o,c){this._checkLoaded();var _=o.source,w=this.sourceCaches[_];if(w!==void 0){var S=w.getSource().type,P=S==="vector"?o.sourceLayer:void 0;S!=="vector"||P?c&&typeof o.id!="string"&&typeof o.id!="number"?this.fire(new a.ErrorEvent(new Error("A feature id is required to remove its specific state property."))):w.removeFeatureState(P,o.id,c):this.fire(new a.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")))}else this.fire(new a.ErrorEvent(new Error("The source '"+_+"' does not exist in the map's style.")))},s.prototype.getFeatureState=function(o){this._checkLoaded();var c=o.source,_=o.sourceLayer,w=this.sourceCaches[c];if(w!==void 0){if(w.getSource().type!=="vector"||_)return o.id===void 0&&this.fire(new a.ErrorEvent(new Error("The feature id parameter must be provided."))),w.getFeatureState(_,o.id);this.fire(new a.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")))}else this.fire(new a.ErrorEvent(new Error("The source '"+c+"' does not exist in the map's style.")))},s.prototype.getTransition=function(){return a.extend({duration:300,delay:0},this.stylesheet&&this.stylesheet.transition)},s.prototype.serialize=function(){return a.filterObject({version:this.stylesheet.version,name:this.stylesheet.name,metadata:this.stylesheet.metadata,light:this.stylesheet.light,center:this.stylesheet.center,zoom:this.stylesheet.zoom,bearing:this.stylesheet.bearing,pitch:this.stylesheet.pitch,sprite:this.stylesheet.sprite,glyphs:this.stylesheet.glyphs,transition:this.stylesheet.transition,sources:a.mapObject(this.sourceCaches,function(o){return o.serialize()}),layers:this._serializeLayers(this._order)},function(o){return o!==void 0})},s.prototype._updateLayer=function(o){this._updatedLayers[o.id]=!0,o.source&&!this._updatedSources[o.source]&&this.sourceCaches[o.source].getSource().type!=="raster"&&(this._updatedSources[o.source]="reload",this.sourceCaches[o.source].pause()),this._changed=!0},s.prototype._flattenAndSortRenderedFeatures=function(o){for(var c=this,_=function(Je){return c._layers[Je].type==="fill-extrusion"},w={},S=[],P=this._order.length-1;P>=0;P--){var C=this._order[P];if(_(C)){w[C]=P;for(var O=0,Z=o;O<Z.length;O+=1){var K=Z[O][C];if(K)for(var H=0,re=K;H<re.length;H+=1)S.push(re[H])}}}S.sort(function(Je,Xe){return Xe.intersectionZ-Je.intersectionZ});for(var te=[],ce=this._order.length-1;ce>=0;ce--){var Y=this._order[ce];if(_(Y))for(var se=S.length-1;se>=0;se--){var fe=S[se].feature;if(w[fe.layer.id]<ce)break;te.push(fe),S.pop()}else for(var ve=0,Ie=o;ve<Ie.length;ve+=1){var ke=Ie[ve][Y];if(ke)for(var Pe=0,Ne=ke;Pe<Ne.length;Pe+=1)te.push(Ne[Pe].feature)}}return te},s.prototype.queryRenderedFeatures=function(o,c,_){c&&c.filter&&this._validate(a.validateStyle.filter,"queryRenderedFeatures.filter",c.filter,null,c);var w={};if(c&&c.layers){if(!Array.isArray(c.layers))return this.fire(new a.ErrorEvent(new Error("parameters.layers must be an Array."))),[];for(var S=0,P=c.layers;S<P.length;S+=1){var C=P[S],O=this._layers[C];if(!O)return this.fire(new a.ErrorEvent(new Error("The layer '"+C+"' does not exist in the map's style and cannot be queried for features."))),[];w[O.source]=!0}}var Z=[];for(var K in c.availableImages=this._availableImages,this.sourceCaches)c.layers&&!w[K]||Z.push(ar(this.sourceCaches[K],this._layers,this._serializedLayers,o,c,_));return this.placement&&Z.push(function(H,re,te,ce,Y,se,fe){for(var ve={},Ie=se.queryRenderedSymbols(ce),ke=[],Pe=0,Ne=Object.keys(Ie).map(Number);Pe<Ne.length;Pe+=1)ke.push(fe[Ne[Pe]]);ke.sort(Sr);for(var Je=function(){var At=ct[Xe],yr=At.featureIndex.lookupSymbolFeatures(Ie[At.bucketInstanceId],re,At.bucketIndex,At.sourceLayerIndex,Y.filter,Y.layers,Y.availableImages,H);for(var ht in yr){var Ut=ve[ht]=ve[ht]||[],Yt=yr[ht];Yt.sort(function(Xt,Rt){var Dt=At.featureSortOrder;if(Dt){var Li=Dt.indexOf(Xt.featureIndex);return Dt.indexOf(Rt.featureIndex)-Li}return Rt.featureIndex-Xt.featureIndex});for(var Ot=0,Ft=Yt;Ot<Ft.length;Ot+=1)Ut.push(Ft[Ot])}},Xe=0,ct=ke;Xe<ct.length;Xe+=1)Je();var Et=function(At){ve[At].forEach(function(yr){var ht=yr.feature,Ut=te[H[At].source].getFeatureState(ht.layer["source-layer"],ht.id);ht.source=ht.layer.source,ht.layer["source-layer"]&&(ht.sourceLayer=ht.layer["source-layer"]),ht.state=Ut})};for(var Ct in ve)Et(Ct);return ve}(this._layers,this._serializedLayers,this.sourceCaches,o,c,this.placement.collisionIndex,this.placement.retainedQueryData)),this._flattenAndSortRenderedFeatures(Z)},s.prototype.querySourceFeatures=function(o,c){c&&c.filter&&this._validate(a.validateStyle.filter,"querySourceFeatures.filter",c.filter,null,c);var _=this.sourceCaches[o];return _?function(w,S){for(var P=w.getRenderableIds().map(function(re){return w.getTileByID(re)}),C=[],O={},Z=0;Z<P.length;Z++){var K=P[Z],H=K.tileID.canonical.key;O[H]||(O[H]=!0,K.querySourceFeatures(C,S))}return C}(_,c):[]},s.prototype.addSourceType=function(o,c,_){return s.getSourceType(o)?_(new Error('A source type called "'+o+'" already exists.')):(s.setSourceType(o,c),c.workerSourceURL?void this.dispatcher.broadcast("loadWorkerSource",{name:o,url:c.workerSourceURL},_):_(null,null))},s.prototype.getLight=function(){return this.light.getLight()},s.prototype.setLight=function(o,c){c===void 0&&(c={}),this._checkLoaded();var _=this.light.getLight(),w=!1;for(var S in o)if(!a.deepEqual(o[S],_[S])){w=!0;break}if(w){var P={now:a.browser.now(),transition:a.extend({duration:300,delay:0},this.stylesheet.transition)};this.light.setLight(o,c),this.light.updateTransitions(P)}},s.prototype._validate=function(o,c,_,w,S){return S===void 0&&(S={}),(!S||S.validate!==!1)&&cn(this,o.call(a.validateStyle,a.extend({key:c,style:this.serialize(),value:_,styleSpec:a.styleSpec},w)))},s.prototype._remove=function(){for(var o in this._request&&(this._request.cancel(),this._request=null),this._spriteRequest&&(this._spriteRequest.cancel(),this._spriteRequest=null),a.evented.off("pluginStateChange",this._rtlTextPluginCallback),this._layers)this._layers[o].setEventedParent(null);for(var c in this.sourceCaches)this.sourceCaches[c].clearTiles(),this.sourceCaches[c].setEventedParent(null);this.imageManager.setEventedParent(null),this.setEventedParent(null),this.dispatcher.remove()},s.prototype._clearSource=function(o){this.sourceCaches[o].clearTiles()},s.prototype._reloadSource=function(o){this.sourceCaches[o].resume(),this.sourceCaches[o].reload()},s.prototype._updateSources=function(o){for(var c in this.sourceCaches)this.sourceCaches[c].update(o)},s.prototype._generateCollisionBoxes=function(){for(var o in this.sourceCaches)this._reloadSource(o)},s.prototype._updatePlacement=function(o,c,_,w,S){S===void 0&&(S=!1);for(var P=!1,C=!1,O={},Z=0,K=this._order;Z<K.length;Z+=1){var H=this._layers[K[Z]];if(H.type==="symbol"){if(!O[H.source]){var re=this.sourceCaches[H.source];O[H.source]=re.getRenderableIds(!0).map(function(fe){return re.getTileByID(fe)}).sort(function(fe,ve){return ve.tileID.overscaledZ-fe.tileID.overscaledZ||(fe.tileID.isLessThan(ve.tileID)?-1:1)})}var te=this.crossTileSymbolIndex.addLayer(H,O[H.source],o.center.lng);P=P||te}}if(this.crossTileSymbolIndex.pruneUnusedLayers(this._order),((S=S||this._layerOrderChanged||_===0)||!this.pauseablePlacement||this.pauseablePlacement.isDone()&&!this.placement.stillRecent(a.browser.now(),o.zoom))&&(this.pauseablePlacement=new co(o,this._order,S,c,_,w,this.placement),this._layerOrderChanged=!1),this.pauseablePlacement.isDone()?this.placement.setStale():(this.pauseablePlacement.continuePlacement(this._order,this._layers,O),this.pauseablePlacement.isDone()&&(this.placement=this.pauseablePlacement.commit(a.browser.now()),C=!0),P&&this.pauseablePlacement.placement.setStale()),C||P)for(var ce=0,Y=this._order;ce<Y.length;ce+=1){var se=this._layers[Y[ce]];se.type==="symbol"&&this.placement.updateLayerOpacities(se,O[se.source])}return!this.pauseablePlacement.isDone()||this.placement.hasTransitions(a.browser.now())},s.prototype._releaseSymbolFadeTiles=function(){for(var o in this.sourceCaches)this.sourceCaches[o].releaseSymbolFadeTiles()},s.prototype.getImages=function(o,c,_){this.imageManager.getImages(c.icons,_),this._updateTilesForChangedImages();var w=this.sourceCaches[c.source];w&&w.setDependencies(c.tileID.key,c.type,c.icons)},s.prototype.getGlyphs=function(o,c,_){this.glyphManager.getGlyphs(c.stacks,_)},s.prototype.getResource=function(o,c,_){return a.makeRequest(c,_)},s}(a.Evented);Vn.getSourceType=function(n){return wi[n]},Vn.setSourceType=function(n,s){wi[n]=s},Vn.registerForPluginStateChange=a.registerForPluginStateChange;var vi=a.createLayout([{name:"a_pos",type:"Int16",components:2}]),Fo=Dr(`#ifdef GL_ES
precision mediump float;
#else
#if !defined(lowp)
#define lowp
#endif
#if !defined(mediump)
#define mediump
#endif
#if !defined(highp)
#define highp
#endif
#endif`,`#ifdef GL_ES
precision highp float;
#else
#if !defined(lowp)
#define lowp
#endif
#if !defined(mediump)
#define mediump
#endif
#if !defined(highp)
#define highp
#endif
#endif
vec2 unpack_float(const float packedValue) {int packedIntValue=int(packedValue);int v0=packedIntValue/256;return vec2(v0,packedIntValue-v0*256);}vec2 unpack_opacity(const float packedOpacity) {int intOpacity=int(packedOpacity)/2;return vec2(float(intOpacity)/127.0,mod(packedOpacity,2.0));}vec4 decode_color(const vec2 encodedColor) {return vec4(unpack_float(encodedColor[0])/255.0,unpack_float(encodedColor[1])/255.0
);}float unpack_mix_vec2(const vec2 packedValue,const float t) {return mix(packedValue[0],packedValue[1],t);}vec4 unpack_mix_color(const vec4 packedColors,const float t) {vec4 minColor=decode_color(vec2(packedColors[0],packedColors[1]));vec4 maxColor=decode_color(vec2(packedColors[2],packedColors[3]));return mix(minColor,maxColor,t);}vec2 get_pattern_pos(const vec2 pixel_coord_upper,const vec2 pixel_coord_lower,const vec2 pattern_size,const float tile_units_to_pixels,const vec2 pos) {vec2 offset=mod(mod(mod(pixel_coord_upper,pattern_size)*256.0,pattern_size)*256.0+pixel_coord_lower,pattern_size);return (tile_units_to_pixels*pos+offset)/pattern_size;}`),tc=Dr(`uniform vec4 u_color;uniform float u_opacity;void main() {gl_FragColor=u_color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),Lh=Dr(`uniform vec2 u_pattern_tl_a;uniform vec2 u_pattern_br_a;uniform vec2 u_pattern_tl_b;uniform vec2 u_pattern_br_b;uniform vec2 u_texsize;uniform float u_mix;uniform float u_opacity;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;void main() {vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(u_pattern_tl_a/u_texsize,u_pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(u_pattern_tl_b/u_texsize,u_pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);gl_FragColor=mix(color1,color2,u_mix)*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_pattern_size_a;uniform vec2 u_pattern_size_b;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_scale_a;uniform float u_scale_b;uniform float u_tile_units_to_pixels;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_a*u_pattern_size_a,u_tile_units_to_pixels,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_b*u_pattern_size_b,u_tile_units_to_pixels,a_pos);}"),Rh=Dr(`varying vec3 v_data;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=v_data.xy;float extrude_length=length(extrude);lowp float antialiasblur=v_data.z;float antialiased_blur=-max(blur,antialiasblur);float opacity_t=smoothstep(0.0,antialiased_blur,extrude_length-1.0);float color_t=stroke_width < 0.01 ? 0.0 : smoothstep(antialiased_blur,0.0,extrude_length-radius/(radius+stroke_width));gl_FragColor=opacity_t*mix(color*opacity,stroke_color*stroke_opacity,color_t);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform bool u_scale_with_map;uniform bool u_pitch_with_map;uniform vec2 u_extrude_scale;uniform lowp float u_device_pixel_ratio;uniform highp float u_camera_to_center_distance;attribute vec2 a_pos;varying vec3 v_data;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
void main(void) {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=vec2(mod(a_pos,2.0)*2.0-1.0);vec2 circle_center=floor(a_pos*0.5);if (u_pitch_with_map) {vec2 corner_position=circle_center;if (u_scale_with_map) {corner_position+=extrude*(radius+stroke_width)*u_extrude_scale;} else {vec4 projected_center=u_matrix*vec4(circle_center,0,1);corner_position+=extrude*(radius+stroke_width)*u_extrude_scale*(projected_center.w/u_camera_to_center_distance);}gl_Position=u_matrix*vec4(corner_position,0,1);} else {gl_Position=u_matrix*vec4(circle_center,0,1);if (u_scale_with_map) {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*u_camera_to_center_distance;} else {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*gl_Position.w;}}lowp float antialiasblur=1.0/u_device_pixel_ratio/(radius+stroke_width);v_data=vec3(extrude.x,extrude.y,antialiasblur);}`),Vl=Dr("void main() {gl_FragColor=vec4(1.0);}","attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),ql=Dr(`uniform highp float u_intensity;varying vec2 v_extrude;
#pragma mapbox: define highp float weight
#define GAUSS_COEF 0.3989422804014327
void main() {
#pragma mapbox: initialize highp float weight
float d=-0.5*3.0*3.0*dot(v_extrude,v_extrude);float val=weight*u_intensity*GAUSS_COEF*exp(d);gl_FragColor=vec4(val,1.0,1.0,1.0);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform float u_extrude_scale;uniform float u_opacity;uniform float u_intensity;attribute vec2 a_pos;varying vec2 v_extrude;
#pragma mapbox: define highp float weight
#pragma mapbox: define mediump float radius
const highp float ZERO=1.0/255.0/16.0;
#define GAUSS_COEF 0.3989422804014327
void main(void) {
#pragma mapbox: initialize highp float weight
#pragma mapbox: initialize mediump float radius
vec2 unscaled_extrude=vec2(mod(a_pos,2.0)*2.0-1.0);float S=sqrt(-2.0*log(ZERO/weight/u_intensity/GAUSS_COEF))/3.0;v_extrude=S*unscaled_extrude;vec2 extrude=v_extrude*radius*u_extrude_scale;vec4 pos=vec4(floor(a_pos*0.5)+extrude,0,1);gl_Position=u_matrix*pos;}`),jl=Dr(`uniform sampler2D u_image;uniform sampler2D u_color_ramp;uniform float u_opacity;varying vec2 v_pos;void main() {float t=texture2D(u_image,v_pos).r;vec4 color=texture2D(u_color_ramp,vec2(t,0.5));gl_FragColor=color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(0.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_world;attribute vec2 a_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos*u_world,0,1);v_pos.x=a_pos.x;v_pos.y=1.0-a_pos.y;}"),Gl=Dr("varying float v_placed;varying float v_notUsed;void main() {float alpha=0.5;gl_FragColor=vec4(1.0,0.0,0.0,1.0)*alpha;if (v_placed > 0.5) {gl_FragColor=vec4(0.0,0.0,1.0,0.5)*alpha;}if (v_notUsed > 0.5) {gl_FragColor*=.1;}}","attribute vec2 a_pos;attribute vec2 a_anchor_pos;attribute vec2 a_extrude;attribute vec2 a_placed;attribute vec2 a_shift;uniform mat4 u_matrix;uniform vec2 u_extrude_scale;uniform float u_camera_to_center_distance;varying float v_placed;varying float v_notUsed;void main() {vec4 projectedPoint=u_matrix*vec4(a_anchor_pos,0,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float collision_perspective_ratio=clamp(0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,4.0);gl_Position=u_matrix*vec4(a_pos,0.0,1.0);gl_Position.xy+=(a_extrude+a_shift)*u_extrude_scale*gl_Position.w*collision_perspective_ratio;v_placed=a_placed.x;v_notUsed=a_placed.y;}"),rc=Dr("varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;void main() {float alpha=0.5*min(v_perspective_ratio,1.0);float stroke_radius=0.9*max(v_perspective_ratio,1.0);float distance_to_center=length(v_extrude);float distance_to_edge=abs(distance_to_center-v_radius);float opacity_t=smoothstep(-stroke_radius,0.0,-distance_to_edge);vec4 color=mix(vec4(0.0,0.0,1.0,0.5),vec4(1.0,0.0,0.0,1.0),v_collision);gl_FragColor=color*alpha*opacity_t;}","attribute vec2 a_pos;attribute float a_radius;attribute vec2 a_flags;uniform mat4 u_matrix;uniform mat4 u_inv_matrix;uniform vec2 u_viewport_size;uniform float u_camera_to_center_distance;varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;vec3 toTilePosition(vec2 screenPos) {vec4 rayStart=u_inv_matrix*vec4(screenPos,-1.0,1.0);vec4 rayEnd  =u_inv_matrix*vec4(screenPos, 1.0,1.0);rayStart.xyz/=rayStart.w;rayEnd.xyz  /=rayEnd.w;highp float t=(0.0-rayStart.z)/(rayEnd.z-rayStart.z);return mix(rayStart.xyz,rayEnd.xyz,t);}void main() {vec2 quadCenterPos=a_pos;float radius=a_radius;float collision=a_flags.x;float vertexIdx=a_flags.y;vec2 quadVertexOffset=vec2(mix(-1.0,1.0,float(vertexIdx >=2.0)),mix(-1.0,1.0,float(vertexIdx >=1.0 && vertexIdx <=2.0)));vec2 quadVertexExtent=quadVertexOffset*radius;vec3 tilePos=toTilePosition(quadCenterPos);vec4 clipPos=u_matrix*vec4(tilePos,1.0);highp float camera_to_anchor_distance=clipPos.w;highp float collision_perspective_ratio=clamp(0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,4.0);float padding_factor=1.2;v_radius=radius;v_extrude=quadVertexExtent*padding_factor;v_perspective_ratio=collision_perspective_ratio;v_collision=collision;gl_Position=vec4(clipPos.xyz/clipPos.w,1.0)+vec4(quadVertexExtent*padding_factor/u_viewport_size*2.0,0.0,0.0);}"),ic=Dr("uniform highp vec4 u_color;uniform sampler2D u_overlay;varying vec2 v_uv;void main() {vec4 overlay_color=texture2D(u_overlay,v_uv);gl_FragColor=mix(u_color,overlay_color,overlay_color.a);}","attribute vec2 a_pos;varying vec2 v_uv;uniform mat4 u_matrix;uniform float u_overlay_scale;void main() {v_uv=a_pos/8192.0;gl_Position=u_matrix*vec4(a_pos*u_overlay_scale,0,1);}"),Bh=Dr(`#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
gl_FragColor=color*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec2 a_pos;uniform mat4 u_matrix;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
gl_Position=u_matrix*vec4(a_pos,0,1);}`),ss=Dr(`varying vec2 v_pos;
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);gl_FragColor=outline_color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec2 a_pos;uniform mat4 u_matrix;uniform vec2 u_world;varying vec2 v_pos;
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;}`),ls=Dr(`uniform vec2 u_texsize;uniform sampler2D u_image;uniform float u_fade;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec2 v_pos;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);gl_FragColor=mix(color1,color2,u_fade)*alpha*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_world;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec2 v_pos;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;gl_Position=u_matrix*vec4(a_pos,0,1);vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,a_pos);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;}`),nc=Dr(`uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);gl_FragColor=mix(color1,color2,u_fade)*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;gl_Position=u_matrix*vec4(a_pos,0,1);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileZoomRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileZoomRatio,a_pos);}`),en=Dr(`varying vec4 v_color;void main() {gl_FragColor=v_color;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;uniform float u_vertical_gradient;uniform lowp float u_opacity;attribute vec2 a_pos;attribute vec4 a_normal_ed;varying vec4 v_color;
#pragma mapbox: define highp float base
#pragma mapbox: define highp float height
#pragma mapbox: define highp vec4 color
void main() {
#pragma mapbox: initialize highp float base
#pragma mapbox: initialize highp float height
#pragma mapbox: initialize highp vec4 color
vec3 normal=a_normal_ed.xyz;base=max(0.0,base);height=max(0.0,height);float t=mod(normal.x,2.0);gl_Position=u_matrix*vec4(a_pos,t > 0.0 ? height : base,1);float colorvalue=color.r*0.2126+color.g*0.7152+color.b*0.0722;v_color=vec4(0.0,0.0,0.0,1.0);vec4 ambientlight=vec4(0.03,0.03,0.03,1.0);color+=ambientlight;float directional=clamp(dot(normal/16384.0,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_color.r+=clamp(color.r*directional*u_lightcolor.r,mix(0.0,0.3,1.0-u_lightcolor.r),1.0);v_color.g+=clamp(color.g*directional*u_lightcolor.g,mix(0.0,0.3,1.0-u_lightcolor.g),1.0);v_color.b+=clamp(color.b*directional*u_lightcolor.b,mix(0.0,0.3,1.0-u_lightcolor.b),1.0);v_color*=u_opacity;}`),Zl=Dr(`uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec4 v_lighting;
#pragma mapbox: define lowp float base
#pragma mapbox: define lowp float height
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float base
#pragma mapbox: initialize lowp float height
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);vec4 mixedColor=mix(color1,color2,u_fade);gl_FragColor=mixedColor*v_lighting;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_height_factor;uniform vec3 u_scale;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;attribute vec2 a_pos;attribute vec4 a_normal_ed;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec4 v_lighting;
#pragma mapbox: define lowp float base
#pragma mapbox: define lowp float height
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float base
#pragma mapbox: initialize lowp float height
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec3 normal=a_normal_ed.xyz;float edgedistance=a_normal_ed.w;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;base=max(0.0,base);height=max(0.0,height);float t=mod(normal.x,2.0);float z=t > 0.0 ? height : base;gl_Position=u_matrix*vec4(a_pos,z,1);vec2 pos=normal.x==1.0 && normal.y==0.0 && normal.z==16384.0
? a_pos
: vec2(edgedistance,z*u_height_factor);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,pos);v_lighting=vec4(0.0,0.0,0.0,1.0);float directional=clamp(dot(normal/16383.0,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((0.5+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_lighting.rgb+=clamp(directional*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_lighting*=u_opacity;}`),qa=Dr(`#ifdef GL_ES
precision highp float;
#endif
uniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_dimension;uniform float u_zoom;uniform vec4 u_unpack;float getElevation(vec2 coord,float bias) {vec4 data=texture2D(u_image,coord)*255.0;data.a=-1.0;return dot(data,u_unpack)/4.0;}void main() {vec2 epsilon=1.0/u_dimension;float a=getElevation(v_pos+vec2(-epsilon.x,-epsilon.y),0.0);float b=getElevation(v_pos+vec2(0,-epsilon.y),0.0);float c=getElevation(v_pos+vec2(epsilon.x,-epsilon.y),0.0);float d=getElevation(v_pos+vec2(-epsilon.x,0),0.0);float e=getElevation(v_pos,0.0);float f=getElevation(v_pos+vec2(epsilon.x,0),0.0);float g=getElevation(v_pos+vec2(-epsilon.x,epsilon.y),0.0);float h=getElevation(v_pos+vec2(0,epsilon.y),0.0);float i=getElevation(v_pos+vec2(epsilon.x,epsilon.y),0.0);float exaggerationFactor=u_zoom < 2.0 ? 0.4 : u_zoom < 4.5 ? 0.35 : 0.3;float exaggeration=u_zoom < 15.0 ? (u_zoom-15.0)*exaggerationFactor : 0.0;vec2 deriv=vec2((c+f+f+i)-(a+d+d+g),(g+h+h+i)-(a+b+b+c))/pow(2.0,exaggeration+(19.2562-u_zoom));gl_FragColor=clamp(vec4(deriv.x/2.0+0.5,deriv.y/2.0+0.5,1.0,1.0),0.0,1.0);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_dimension;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);highp vec2 epsilon=1.0/u_dimension;float scale=(u_dimension.x-2.0)/u_dimension.x;v_pos=(a_texture_pos/8192.0)*scale+epsilon;}"),ja=Dr(`uniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_latrange;uniform vec2 u_light;uniform vec4 u_shadow;uniform vec4 u_highlight;uniform vec4 u_accent;
#define PI 3.141592653589793
void main() {vec4 pixel=texture2D(u_image,v_pos);vec2 deriv=((pixel.rg*2.0)-1.0);float scaleFactor=cos(radians((u_latrange[0]-u_latrange[1])*(1.0-v_pos.y)+u_latrange[1]));float slope=atan(1.25*length(deriv)/scaleFactor);float aspect=deriv.x !=0.0 ? atan(deriv.y,-deriv.x) : PI/2.0*(deriv.y > 0.0 ? 1.0 :-1.0);float intensity=u_light.x;float azimuth=u_light.y+PI;float base=1.875-intensity*1.75;float maxValue=0.5*PI;float scaledSlope=intensity !=0.5 ? ((pow(base,slope)-1.0)/(pow(base,maxValue)-1.0))*maxValue : slope;float accent=cos(scaledSlope);vec4 accent_color=(1.0-accent)*u_accent*clamp(intensity*2.0,0.0,1.0);float shade=abs(mod((aspect+azimuth)/PI+0.5,2.0)-1.0);vec4 shade_color=mix(u_shadow,u_highlight,shade)*sin(scaledSlope)*clamp(intensity*2.0,0.0,1.0);gl_FragColor=accent_color*(1.0-shade_color.a)+shade_color;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=a_texture_pos/8192.0;}"),ho=Dr(`uniform lowp float u_device_pixel_ratio;varying vec2 v_width2;varying vec2 v_normal;varying float v_gamma_scale;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);gl_FragColor=color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
attribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform vec2 u_units_to_pixels;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_gamma_scale;varying highp float v_linesofar;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;v_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*2.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;v_width2=vec2(outset,inset);}`),po=Dr(`uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;varying vec2 v_width2;varying vec2 v_normal;varying float v_gamma_scale;varying highp vec2 v_uv;
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);vec4 color=texture2D(u_image,v_uv);gl_FragColor=color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
attribute vec2 a_pos_normal;attribute vec4 a_data;attribute float a_uv_x;attribute float a_split_index;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_units_to_pixels;uniform float u_image_height;varying vec2 v_normal;varying vec2 v_width2;varying float v_gamma_scale;varying highp vec2 v_uv;
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;highp float texel_height=1.0/u_image_height;highp float half_texel_height=0.5*texel_height;v_uv=vec2(a_uv_x,a_split_index*texel_height-half_texel_height);vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;v_width2=vec2(outset,inset);}`),Ga=Dr(`uniform lowp float u_device_pixel_ratio;uniform vec2 u_texsize;uniform float u_fade;uniform mediump vec3 u_scale;uniform sampler2D u_image;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;vec2 pattern_size_a=vec2(display_size_a.x*fromScale/tileZoomRatio,display_size_a.y);vec2 pattern_size_b=vec2(display_size_b.x*toScale/tileZoomRatio,display_size_b.y);float aspect_a=display_size_a.y/v_width;float aspect_b=display_size_b.y/v_width;float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float x_a=mod(v_linesofar/pattern_size_a.x*aspect_a,1.0);float x_b=mod(v_linesofar/pattern_size_b.x*aspect_b,1.0);float y=0.5*v_normal.y+0.5;vec2 texel_size=1.0/u_texsize;vec2 pos_a=mix(pattern_tl_a*texel_size-texel_size,pattern_br_a*texel_size+texel_size,vec2(x_a,y));vec2 pos_b=mix(pattern_tl_b*texel_size-texel_size,pattern_br_b*texel_size+texel_size,vec2(x_b,y));vec4 color=mix(texture2D(u_image,pos_a),texture2D(u_image,pos_b),u_fade);gl_FragColor=color*alpha*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
#define LINE_DISTANCE_SCALE 2.0
attribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform vec2 u_units_to_pixels;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;v_linesofar=a_linesofar;v_width2=vec2(outset,inset);v_width=floorwidth;}`),fo=Dr(`uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;uniform float u_sdfgamma;uniform float u_mix;varying vec2 v_normal;varying vec2 v_width2;varying vec2 v_tex_a;varying vec2 v_tex_b;varying float v_gamma_scale;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float sdfdist_a=texture2D(u_image,v_tex_a).a;float sdfdist_b=texture2D(u_image,v_tex_b).a;float sdfdist=mix(sdfdist_a,sdfdist_b,u_mix);alpha*=smoothstep(0.5-u_sdfgamma/floorwidth,0.5+u_sdfgamma/floorwidth,sdfdist);gl_FragColor=color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
#define LINE_DISTANCE_SCALE 2.0
attribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_patternscale_a;uniform float u_tex_y_a;uniform vec2 u_patternscale_b;uniform float u_tex_y_b;uniform vec2 u_units_to_pixels;varying vec2 v_normal;varying vec2 v_width2;varying vec2 v_tex_a;varying vec2 v_tex_b;varying float v_gamma_scale;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;v_tex_a=vec2(a_linesofar*u_patternscale_a.x/floorwidth,normal.y*u_patternscale_a.y+u_tex_y_a);v_tex_b=vec2(a_linesofar*u_patternscale_b.x/floorwidth,normal.y*u_patternscale_b.y+u_tex_y_b);v_width2=vec2(outset,inset);}`),mo=Dr(`uniform float u_fade_t;uniform float u_opacity;uniform sampler2D u_image0;uniform sampler2D u_image1;varying vec2 v_pos0;varying vec2 v_pos1;uniform float u_brightness_low;uniform float u_brightness_high;uniform float u_saturation_factor;uniform float u_contrast_factor;uniform vec3 u_spin_weights;void main() {vec4 color0=texture2D(u_image0,v_pos0);vec4 color1=texture2D(u_image1,v_pos1);if (color0.a > 0.0) {color0.rgb=color0.rgb/color0.a;}if (color1.a > 0.0) {color1.rgb=color1.rgb/color1.a;}vec4 color=mix(color0,color1,u_fade_t);color.a*=u_opacity;vec3 rgb=color.rgb;rgb=vec3(dot(rgb,u_spin_weights.xyz),dot(rgb,u_spin_weights.zxy),dot(rgb,u_spin_weights.yzx));float average=(color.r+color.g+color.b)/3.0;rgb+=(average-rgb)*u_saturation_factor;rgb=(rgb-0.5)*u_contrast_factor+0.5;vec3 u_high_vec=vec3(u_brightness_low,u_brightness_low,u_brightness_low);vec3 u_low_vec=vec3(u_brightness_high,u_brightness_high,u_brightness_high);gl_FragColor=vec4(mix(u_high_vec,u_low_vec,rgb)*color.a,color.a);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_tl_parent;uniform float u_scale_parent;uniform float u_buffer_scale;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos0;varying vec2 v_pos1;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos0=(((a_texture_pos/8192.0)-0.5)/u_buffer_scale )+0.5;v_pos1=(v_pos0*u_scale_parent)+u_tl_parent;}"),Za=Dr(`uniform sampler2D u_texture;varying vec2 v_tex;varying float v_fade_opacity;
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float opacity
lowp float alpha=opacity*v_fade_opacity;gl_FragColor=texture2D(u_texture,v_tex)*alpha;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`const float PI=3.141592653589793;attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec4 a_pixeloffset;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform highp float u_camera_to_center_distance;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform float u_fade_change;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform vec2 u_texsize;varying vec2 v_tex;varying float v_fade_opacity;
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float opacity
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;vec2 a_minFontScale=a_pixeloffset.zw/256.0;highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec4 projectedPoint=u_matrix*vec4(a_pos,0,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),0,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,0.0,1.0);gl_Position=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*max(a_minFontScale,fontScale)+a_pxoffset/16.0),0.0,1.0);v_tex=a_tex/u_texsize;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;v_fade_opacity=max(0.0,min(1.0,fade_opacity[0]+fade_change));}`),ac=Dr(`#define SDF_PX 8.0
uniform bool u_is_halo;uniform sampler2D u_texture;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;uniform bool u_is_text;varying vec2 v_data0;varying vec3 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
float EDGE_GAMMA=0.105/u_device_pixel_ratio;vec2 tex=v_data0.xy;float gamma_scale=v_data1.x;float size=v_data1.y;float fade_opacity=v_data1[2];float fontScale=u_is_text ? size/24.0 : size;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);gl_FragColor=color*(alpha*opacity*fade_opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`const float PI=3.141592653589793;attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec4 a_pixeloffset;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;varying vec2 v_data0;varying vec3 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec4 projectedPoint=u_matrix*vec4(a_pos,0,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),0,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,0.0,1.0);gl_Position=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale+a_pxoffset),0.0,1.0);float gamma_scale=gl_Position.w;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(1.0,fade_opacity[0]+fade_change));v_data0=a_tex/u_texsize;v_data1=vec3(gamma_scale,size,interpolated_fade_opacity);}`),oc=Dr(`#define SDF_PX 8.0
#define SDF 1.0
#define ICON 0.0
uniform bool u_is_halo;uniform sampler2D u_texture;uniform sampler2D u_texture_icon;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;varying vec4 v_data0;varying vec4 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
float fade_opacity=v_data1[2];if (v_data1.w==ICON) {vec2 tex_icon=v_data0.zw;lowp float alpha=opacity*fade_opacity;gl_FragColor=texture2D(u_texture_icon,tex_icon)*alpha;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
return;}vec2 tex=v_data0.xy;float EDGE_GAMMA=0.105/u_device_pixel_ratio;float gamma_scale=v_data1.x;float size=v_data1.y;float fontScale=size/24.0;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);gl_FragColor=color*(alpha*opacity*fade_opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`const float PI=3.141592653589793;attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec2 u_texsize_icon;varying vec4 v_data0;varying vec4 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);float is_sdf=a_size[0]-2.0*a_size_min;highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec4 projectedPoint=u_matrix*vec4(a_pos,0,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=size/24.0;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),0,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,0.0,1.0);gl_Position=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale),0.0,1.0);float gamma_scale=gl_Position.w;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(1.0,fade_opacity[0]+fade_change));v_data0.xy=a_tex/u_texsize;v_data0.zw=a_tex/u_texsize_icon;v_data1=vec4(gamma_scale,size,interpolated_fade_opacity,is_sdf);}`);function Dr(n,s){var o=/#pragma mapbox: ([\w]+) ([\w]+) ([\w]+) ([\w]+)/g,c=s.match(/attribute ([\w]+) ([\w]+)/g),_=n.match(/uniform ([\w]+) ([\w]+)([\s]*)([\w]*)/g),w=s.match(/uniform ([\w]+) ([\w]+)([\s]*)([\w]*)/g),S=w?w.concat(_):_,P={};return{fragmentSource:n=n.replace(o,function(C,O,Z,K,H){return P[H]=!0,O==="define"?`
#ifndef HAS_UNIFORM_u_`+H+`
varying `+Z+" "+K+" "+H+`;
#else
uniform `+Z+" "+K+" u_"+H+`;
#endif
`:`
#ifdef HAS_UNIFORM_u_`+H+`
    `+Z+" "+K+" "+H+" = u_"+H+`;
#endif
`}),vertexSource:s=s.replace(o,function(C,O,Z,K,H){var re=K==="float"?"vec2":"vec4",te=H.match(/color/)?"color":re;return P[H]?O==="define"?`
#ifndef HAS_UNIFORM_u_`+H+`
uniform lowp float u_`+H+`_t;
attribute `+Z+" "+re+" a_"+H+`;
varying `+Z+" "+K+" "+H+`;
#else
uniform `+Z+" "+K+" u_"+H+`;
#endif
`:te==="vec4"?`
#ifndef HAS_UNIFORM_u_`+H+`
    `+H+" = a_"+H+`;
#else
    `+Z+" "+K+" "+H+" = u_"+H+`;
#endif
`:`
#ifndef HAS_UNIFORM_u_`+H+`
    `+H+" = unpack_mix_"+te+"(a_"+H+", u_"+H+`_t);
#else
    `+Z+" "+K+" "+H+" = u_"+H+`;
#endif
`:O==="define"?`
#ifndef HAS_UNIFORM_u_`+H+`
uniform lowp float u_`+H+`_t;
attribute `+Z+" "+re+" a_"+H+`;
#else
uniform `+Z+" "+K+" u_"+H+`;
#endif
`:te==="vec4"?`
#ifndef HAS_UNIFORM_u_`+H+`
    `+Z+" "+K+" "+H+" = a_"+H+`;
#else
    `+Z+" "+K+" "+H+" = u_"+H+`;
#endif
`:`
#ifndef HAS_UNIFORM_u_`+H+`
    `+Z+" "+K+" "+H+" = unpack_mix_"+te+"(a_"+H+", u_"+H+`_t);
#else
    `+Z+" "+K+" "+H+" = u_"+H+`;
#endif
`}),staticAttributes:c,staticUniforms:S}}var Fh=Object.freeze({__proto__:null,prelude:Fo,background:tc,backgroundPattern:Lh,circle:Rh,clippingMask:Vl,heatmap:ql,heatmapTexture:jl,collisionBox:Gl,collisionCircle:rc,debug:ic,fill:Bh,fillOutline:ss,fillOutlinePattern:ls,fillPattern:nc,fillExtrusion:en,fillExtrusionPattern:Zl,hillshadePrepare:qa,hillshade:ja,line:ho,lineGradient:po,linePattern:Ga,lineSDF:fo,raster:mo,symbolIcon:Za,symbolSDF:ac,symbolTextAndIcon:oc}),Us=function(){this.boundProgram=null,this.boundLayoutVertexBuffer=null,this.boundPaintVertexBuffers=[],this.boundIndexBuffer=null,this.boundVertexOffset=null,this.boundDynamicVertexBuffer=null,this.vao=null};function sc(n){for(var s=[],o=0;o<n.length;o++)if(n[o]!==null){var c=n[o].split(" ");s.push(c.pop())}return s}Us.prototype.bind=function(n,s,o,c,_,w,S,P){this.context=n;for(var C=this.boundPaintVertexBuffers.length!==c.length,O=0;!C&&O<c.length;O++)this.boundPaintVertexBuffers[O]!==c[O]&&(C=!0);n.extVertexArrayObject&&this.vao&&this.boundProgram===s&&this.boundLayoutVertexBuffer===o&&!C&&this.boundIndexBuffer===_&&this.boundVertexOffset===w&&this.boundDynamicVertexBuffer===S&&this.boundDynamicVertexBuffer2===P?(n.bindVertexArrayOES.set(this.vao),S&&S.bind(),_&&_.dynamicDraw&&_.bind(),P&&P.bind()):this.freshBind(s,o,c,_,w,S,P)},Us.prototype.freshBind=function(n,s,o,c,_,w,S){var P,C=n.numAttributes,O=this.context,Z=O.gl;if(O.extVertexArrayObject)this.vao&&this.destroy(),this.vao=O.extVertexArrayObject.createVertexArrayOES(),O.bindVertexArrayOES.set(this.vao),P=0,this.boundProgram=n,this.boundLayoutVertexBuffer=s,this.boundPaintVertexBuffers=o,this.boundIndexBuffer=c,this.boundVertexOffset=_,this.boundDynamicVertexBuffer=w,this.boundDynamicVertexBuffer2=S;else{P=O.currentNumAttributes||0;for(var K=C;K<P;K++)Z.disableVertexAttribArray(K)}s.enableAttributes(Z,n);for(var H=0,re=o;H<re.length;H+=1)re[H].enableAttributes(Z,n);w&&w.enableAttributes(Z,n),S&&S.enableAttributes(Z,n),s.bind(),s.setVertexAttribPointers(Z,n,_);for(var te=0,ce=o;te<ce.length;te+=1){var Y=ce[te];Y.bind(),Y.setVertexAttribPointers(Z,n,_)}w&&(w.bind(),w.setVertexAttribPointers(Z,n,_)),c&&c.bind(),S&&(S.bind(),S.setVertexAttribPointers(Z,n,_)),O.currentNumAttributes=C},Us.prototype.destroy=function(){this.vao&&(this.context.extVertexArrayObject.deleteVertexArrayOES(this.vao),this.vao=null)};var lc=function(n,s,o,c,_,w){var S=n.gl;this.program=S.createProgram();for(var P=sc(o.staticAttributes),C=c?c.getBinderAttributes():[],O=P.concat(C),Z=o.staticUniforms?sc(o.staticUniforms):[],K=c?c.getBinderUniforms():[],H=[],re=0,te=Z.concat(K);re<te.length;re+=1){var ce=te[re];H.indexOf(ce)<0&&H.push(ce)}var Y=c?c.defines():[];w&&Y.push("#define OVERDRAW_INSPECTOR;");var se=Y.concat(Fo.fragmentSource,o.fragmentSource).join(`
`),fe=Y.concat(Fo.vertexSource,o.vertexSource).join(`
`),ve=S.createShader(S.FRAGMENT_SHADER);if(S.isContextLost())this.failedToCreate=!0;else{S.shaderSource(ve,se),S.compileShader(ve),S.attachShader(this.program,ve);var Ie=S.createShader(S.VERTEX_SHADER);if(S.isContextLost())this.failedToCreate=!0;else{S.shaderSource(Ie,fe),S.compileShader(Ie),S.attachShader(this.program,Ie),this.attributes={};var ke={};this.numAttributes=O.length;for(var Pe=0;Pe<this.numAttributes;Pe++)O[Pe]&&(S.bindAttribLocation(this.program,Pe,O[Pe]),this.attributes[O[Pe]]=Pe);S.linkProgram(this.program),S.deleteShader(Ie),S.deleteShader(ve);for(var Ne=0;Ne<H.length;Ne++){var Je=H[Ne];if(Je&&!ke[Je]){var Xe=S.getUniformLocation(this.program,Je);Xe&&(ke[Je]=Xe)}}this.fixedUniforms=_(n,ke),this.binderUniforms=c?c.getUniforms(n,ke):[]}}};function uc(n,s,o){var c=1/Ar(o,1,s.transform.tileZoom),_=Math.pow(2,o.tileID.overscaledZ),w=o.tileSize*Math.pow(2,s.transform.tileZoom)/_,S=w*(o.tileID.canonical.x+o.tileID.wrap*_),P=w*o.tileID.canonical.y;return{u_image:0,u_texsize:o.imageAtlasTexture.size,u_scale:[c,n.fromScale,n.toScale],u_fade:n.t,u_pixel_coord_upper:[S>>16,P>>16],u_pixel_coord_lower:[65535&S,65535&P]}}lc.prototype.draw=function(n,s,o,c,_,w,S,P,C,O,Z,K,H,re,te,ce){var Y,se=n.gl;if(!this.failedToCreate){for(var fe in n.program.set(this.program),n.setDepthMode(o),n.setStencilMode(c),n.setColorMode(_),n.setCullFace(w),this.fixedUniforms)this.fixedUniforms[fe].set(S[fe]);re&&re.setUniforms(n,this.binderUniforms,K,{zoom:H});for(var ve=(Y={},Y[se.LINES]=2,Y[se.TRIANGLES]=3,Y[se.LINE_STRIP]=1,Y)[s],Ie=0,ke=Z.get();Ie<ke.length;Ie+=1){var Pe=ke[Ie],Ne=Pe.vaos||(Pe.vaos={});(Ne[P]||(Ne[P]=new Us)).bind(n,this,C,re?re.getPaintVertexBuffers():[],O,Pe.vertexOffset,te,ce),se.drawElements(s,Pe.primitiveLength*ve,se.UNSIGNED_SHORT,Pe.primitiveOffset*ve*2)}}};var cc=function(n,s,o,c){var _=s.style.light,w=_.properties.get("position"),S=[w.x,w.y,w.z],P=a.create$1();_.properties.get("anchor")==="viewport"&&a.fromRotation(P,-s.transform.angle),a.transformMat3(S,S,P);var C=_.properties.get("color");return{u_matrix:n,u_lightpos:S,u_lightintensity:_.properties.get("intensity"),u_lightcolor:[C.r,C.g,C.b],u_vertical_gradient:+o,u_opacity:c}},yo=function(n,s,o,c,_,w,S){return a.extend(cc(n,s,o,c),uc(w,s,S),{u_height_factor:-Math.pow(2,_.overscaledZ)/S.tileSize/8})},Ka=function(n){return{u_matrix:n}},go=function(n,s,o,c){return a.extend(Ka(n),uc(o,s,c))},hc=function(n,s){return{u_matrix:n,u_world:s}},pc=function(n,s,o,c,_){return a.extend(go(n,s,o,c),{u_world:_})},Kl=function(n,s,o,c){var _,w,S=n.transform;if(c.paint.get("circle-pitch-alignment")==="map"){var P=Ar(o,1,S.zoom);_=!0,w=[P,P]}else _=!1,w=S.pixelsToGLUnits;return{u_camera_to_center_distance:S.cameraToCenterDistance,u_scale_with_map:+(c.paint.get("circle-pitch-scale")==="map"),u_matrix:n.translatePosMatrix(s.posMatrix,o,c.paint.get("circle-translate"),c.paint.get("circle-translate-anchor")),u_pitch_with_map:+_,u_device_pixel_ratio:a.browser.devicePixelRatio,u_extrude_scale:w}},_o=function(n,s,o){var c=Ar(o,1,s.zoom),_=Math.pow(2,s.zoom-o.tileID.overscaledZ),w=o.tileID.overscaleFactor();return{u_matrix:n,u_camera_to_center_distance:s.cameraToCenterDistance,u_pixels_to_tile_units:c,u_extrude_scale:[s.pixelsToGLUnits[0]/(c*_),s.pixelsToGLUnits[1]/(c*_)],u_overscale_factor:w}},fc=function(n,s,o){return{u_matrix:n,u_inv_matrix:s,u_camera_to_center_distance:o.cameraToCenterDistance,u_viewport_size:[o.width,o.height]}},vo=function(n,s,o){return o===void 0&&(o=1),{u_matrix:n,u_color:s,u_overlay:0,u_overlay_scale:o}},bo=function(n){return{u_matrix:n}},dc=function(n,s,o,c){return{u_matrix:n,u_extrude_scale:Ar(s,1,o),u_intensity:c}},us=function(n,s,o){var c=n.transform;return{u_matrix:mc(n,s,o),u_ratio:1/Ar(s,1,c.zoom),u_device_pixel_ratio:a.browser.devicePixelRatio,u_units_to_pixels:[1/c.pixelsToGLUnits[0],1/c.pixelsToGLUnits[1]]}},Or=function(n,s,o,c){return a.extend(us(n,s,o),{u_image:0,u_image_height:c})},Vs=function(n,s,o,c){var _=n.transform,w=Oo(s,_);return{u_matrix:mc(n,s,o),u_texsize:s.imageAtlasTexture.size,u_ratio:1/Ar(s,1,_.zoom),u_device_pixel_ratio:a.browser.devicePixelRatio,u_image:0,u_scale:[w,c.fromScale,c.toScale],u_fade:c.t,u_units_to_pixels:[1/_.pixelsToGLUnits[0],1/_.pixelsToGLUnits[1]]}},Oh=function(n,s,o,c,_){var w=n.lineAtlas,S=Oo(s,n.transform),P=o.layout.get("line-cap")==="round",C=w.getDash(c.from,P),O=w.getDash(c.to,P),Z=C.width*_.fromScale,K=O.width*_.toScale;return a.extend(us(n,s,o),{u_patternscale_a:[S/Z,-C.height/2],u_patternscale_b:[S/K,-O.height/2],u_sdfgamma:w.width/(256*Math.min(Z,K)*a.browser.devicePixelRatio)/2,u_image:0,u_tex_y_a:C.y,u_tex_y_b:O.y,u_mix:_.t})};function Oo(n,s){return 1/Ar(n,1,s.tileZoom)}function mc(n,s,o){return n.translatePosMatrix(s.tileID.posMatrix,s,o.paint.get("line-translate"),o.paint.get("line-translate-anchor"))}var Nh=function(n,s,o,c,_){return{u_matrix:n,u_tl_parent:s,u_scale_parent:o,u_buffer_scale:1,u_fade_t:c.mix,u_opacity:c.opacity*_.paint.get("raster-opacity"),u_image0:0,u_image1:1,u_brightness_low:_.paint.get("raster-brightness-min"),u_brightness_high:_.paint.get("raster-brightness-max"),u_saturation_factor:(S=_.paint.get("raster-saturation"),S>0?1-1/(1.001-S):-S),u_contrast_factor:(w=_.paint.get("raster-contrast"),w>0?1/(1-w):1+w),u_spin_weights:yc(_.paint.get("raster-hue-rotate"))};var w,S};function yc(n){n*=Math.PI/180;var s=Math.sin(n),o=Math.cos(n);return[(2*o+1)/3,(-Math.sqrt(3)*s-o+1)/3,(Math.sqrt(3)*s-o+1)/3]}var qs,No=function(n,s,o,c,_,w,S,P,C,O){var Z=_.transform;return{u_is_size_zoom_constant:+(n==="constant"||n==="source"),u_is_size_feature_constant:+(n==="constant"||n==="camera"),u_size_t:s?s.uSizeT:0,u_size:s?s.uSize:0,u_camera_to_center_distance:Z.cameraToCenterDistance,u_pitch:Z.pitch/360*2*Math.PI,u_rotate_symbol:+o,u_aspect_ratio:Z.width/Z.height,u_fade_change:_.options.fadeDuration?_.symbolFadeChange:1,u_matrix:w,u_label_plane_matrix:S,u_coord_matrix:P,u_is_text:+C,u_pitch_with_map:+c,u_texsize:O,u_texture:0}},cs=function(n,s,o,c,_,w,S,P,C,O,Z){var K=_.transform;return a.extend(No(n,s,o,c,_,w,S,P,C,O),{u_gamma_scale:c?Math.cos(K._pitch)*K.cameraToCenterDistance:1,u_device_pixel_ratio:a.browser.devicePixelRatio,u_is_halo:+Z})},js=function(n,s,o,c,_,w,S,P,C,O){return a.extend(cs(n,s,o,c,_,w,S,P,!0,C,!0),{u_texsize_icon:O,u_texture_icon:1})},hs=function(n,s,o){return{u_matrix:n,u_opacity:s,u_color:o}},Uo=function(n,s,o,c,_,w){return a.extend(function(S,P,C,O){var Z=C.imageManager.getPattern(S.from.toString()),K=C.imageManager.getPattern(S.to.toString()),H=C.imageManager.getPixelSize(),re=H.width,te=H.height,ce=Math.pow(2,O.tileID.overscaledZ),Y=O.tileSize*Math.pow(2,C.transform.tileZoom)/ce,se=Y*(O.tileID.canonical.x+O.tileID.wrap*ce),fe=Y*O.tileID.canonical.y;return{u_image:0,u_pattern_tl_a:Z.tl,u_pattern_br_a:Z.br,u_pattern_tl_b:K.tl,u_pattern_br_b:K.br,u_texsize:[re,te],u_mix:P.t,u_pattern_size_a:Z.displaySize,u_pattern_size_b:K.displaySize,u_scale_a:P.fromScale,u_scale_b:P.toScale,u_tile_units_to_pixels:1/Ar(O,1,C.transform.tileZoom),u_pixel_coord_upper:[se>>16,fe>>16],u_pixel_coord_lower:[65535&se,65535&fe]}}(c,w,o,_),{u_matrix:n,u_opacity:s})},gc={fillExtrusion:function(n,s){return{u_matrix:new a.UniformMatrix4f(n,s.u_matrix),u_lightpos:new a.Uniform3f(n,s.u_lightpos),u_lightintensity:new a.Uniform1f(n,s.u_lightintensity),u_lightcolor:new a.Uniform3f(n,s.u_lightcolor),u_vertical_gradient:new a.Uniform1f(n,s.u_vertical_gradient),u_opacity:new a.Uniform1f(n,s.u_opacity)}},fillExtrusionPattern:function(n,s){return{u_matrix:new a.UniformMatrix4f(n,s.u_matrix),u_lightpos:new a.Uniform3f(n,s.u_lightpos),u_lightintensity:new a.Uniform1f(n,s.u_lightintensity),u_lightcolor:new a.Uniform3f(n,s.u_lightcolor),u_vertical_gradient:new a.Uniform1f(n,s.u_vertical_gradient),u_height_factor:new a.Uniform1f(n,s.u_height_factor),u_image:new a.Uniform1i(n,s.u_image),u_texsize:new a.Uniform2f(n,s.u_texsize),u_pixel_coord_upper:new a.Uniform2f(n,s.u_pixel_coord_upper),u_pixel_coord_lower:new a.Uniform2f(n,s.u_pixel_coord_lower),u_scale:new a.Uniform3f(n,s.u_scale),u_fade:new a.Uniform1f(n,s.u_fade),u_opacity:new a.Uniform1f(n,s.u_opacity)}},fill:function(n,s){return{u_matrix:new a.UniformMatrix4f(n,s.u_matrix)}},fillPattern:function(n,s){return{u_matrix:new a.UniformMatrix4f(n,s.u_matrix),u_image:new a.Uniform1i(n,s.u_image),u_texsize:new a.Uniform2f(n,s.u_texsize),u_pixel_coord_upper:new a.Uniform2f(n,s.u_pixel_coord_upper),u_pixel_coord_lower:new a.Uniform2f(n,s.u_pixel_coord_lower),u_scale:new a.Uniform3f(n,s.u_scale),u_fade:new a.Uniform1f(n,s.u_fade)}},fillOutline:function(n,s){return{u_matrix:new a.UniformMatrix4f(n,s.u_matrix),u_world:new a.Uniform2f(n,s.u_world)}},fillOutlinePattern:function(n,s){return{u_matrix:new a.UniformMatrix4f(n,s.u_matrix),u_world:new a.Uniform2f(n,s.u_world),u_image:new a.Uniform1i(n,s.u_image),u_texsize:new a.Uniform2f(n,s.u_texsize),u_pixel_coord_upper:new a.Uniform2f(n,s.u_pixel_coord_upper),u_pixel_coord_lower:new a.Uniform2f(n,s.u_pixel_coord_lower),u_scale:new a.Uniform3f(n,s.u_scale),u_fade:new a.Uniform1f(n,s.u_fade)}},circle:function(n,s){return{u_camera_to_center_distance:new a.Uniform1f(n,s.u_camera_to_center_distance),u_scale_with_map:new a.Uniform1i(n,s.u_scale_with_map),u_pitch_with_map:new a.Uniform1i(n,s.u_pitch_with_map),u_extrude_scale:new a.Uniform2f(n,s.u_extrude_scale),u_device_pixel_ratio:new a.Uniform1f(n,s.u_device_pixel_ratio),u_matrix:new a.UniformMatrix4f(n,s.u_matrix)}},collisionBox:function(n,s){return{u_matrix:new a.UniformMatrix4f(n,s.u_matrix),u_camera_to_center_distance:new a.Uniform1f(n,s.u_camera_to_center_distance),u_pixels_to_tile_units:new a.Uniform1f(n,s.u_pixels_to_tile_units),u_extrude_scale:new a.Uniform2f(n,s.u_extrude_scale),u_overscale_factor:new a.Uniform1f(n,s.u_overscale_factor)}},collisionCircle:function(n,s){return{u_matrix:new a.UniformMatrix4f(n,s.u_matrix),u_inv_matrix:new a.UniformMatrix4f(n,s.u_inv_matrix),u_camera_to_center_distance:new a.Uniform1f(n,s.u_camera_to_center_distance),u_viewport_size:new a.Uniform2f(n,s.u_viewport_size)}},debug:function(n,s){return{u_color:new a.UniformColor(n,s.u_color),u_matrix:new a.UniformMatrix4f(n,s.u_matrix),u_overlay:new a.Uniform1i(n,s.u_overlay),u_overlay_scale:new a.Uniform1f(n,s.u_overlay_scale)}},clippingMask:function(n,s){return{u_matrix:new a.UniformMatrix4f(n,s.u_matrix)}},heatmap:function(n,s){return{u_extrude_scale:new a.Uniform1f(n,s.u_extrude_scale),u_intensity:new a.Uniform1f(n,s.u_intensity),u_matrix:new a.UniformMatrix4f(n,s.u_matrix)}},heatmapTexture:function(n,s){return{u_matrix:new a.UniformMatrix4f(n,s.u_matrix),u_world:new a.Uniform2f(n,s.u_world),u_image:new a.Uniform1i(n,s.u_image),u_color_ramp:new a.Uniform1i(n,s.u_color_ramp),u_opacity:new a.Uniform1f(n,s.u_opacity)}},hillshade:function(n,s){return{u_matrix:new a.UniformMatrix4f(n,s.u_matrix),u_image:new a.Uniform1i(n,s.u_image),u_latrange:new a.Uniform2f(n,s.u_latrange),u_light:new a.Uniform2f(n,s.u_light),u_shadow:new a.UniformColor(n,s.u_shadow),u_highlight:new a.UniformColor(n,s.u_highlight),u_accent:new a.UniformColor(n,s.u_accent)}},hillshadePrepare:function(n,s){return{u_matrix:new a.UniformMatrix4f(n,s.u_matrix),u_image:new a.Uniform1i(n,s.u_image),u_dimension:new a.Uniform2f(n,s.u_dimension),u_zoom:new a.Uniform1f(n,s.u_zoom),u_unpack:new a.Uniform4f(n,s.u_unpack)}},line:function(n,s){return{u_matrix:new a.UniformMatrix4f(n,s.u_matrix),u_ratio:new a.Uniform1f(n,s.u_ratio),u_device_pixel_ratio:new a.Uniform1f(n,s.u_device_pixel_ratio),u_units_to_pixels:new a.Uniform2f(n,s.u_units_to_pixels)}},lineGradient:function(n,s){return{u_matrix:new a.UniformMatrix4f(n,s.u_matrix),u_ratio:new a.Uniform1f(n,s.u_ratio),u_device_pixel_ratio:new a.Uniform1f(n,s.u_device_pixel_ratio),u_units_to_pixels:new a.Uniform2f(n,s.u_units_to_pixels),u_image:new a.Uniform1i(n,s.u_image),u_image_height:new a.Uniform1f(n,s.u_image_height)}},linePattern:function(n,s){return{u_matrix:new a.UniformMatrix4f(n,s.u_matrix),u_texsize:new a.Uniform2f(n,s.u_texsize),u_ratio:new a.Uniform1f(n,s.u_ratio),u_device_pixel_ratio:new a.Uniform1f(n,s.u_device_pixel_ratio),u_image:new a.Uniform1i(n,s.u_image),u_units_to_pixels:new a.Uniform2f(n,s.u_units_to_pixels),u_scale:new a.Uniform3f(n,s.u_scale),u_fade:new a.Uniform1f(n,s.u_fade)}},lineSDF:function(n,s){return{u_matrix:new a.UniformMatrix4f(n,s.u_matrix),u_ratio:new a.Uniform1f(n,s.u_ratio),u_device_pixel_ratio:new a.Uniform1f(n,s.u_device_pixel_ratio),u_units_to_pixels:new a.Uniform2f(n,s.u_units_to_pixels),u_patternscale_a:new a.Uniform2f(n,s.u_patternscale_a),u_patternscale_b:new a.Uniform2f(n,s.u_patternscale_b),u_sdfgamma:new a.Uniform1f(n,s.u_sdfgamma),u_image:new a.Uniform1i(n,s.u_image),u_tex_y_a:new a.Uniform1f(n,s.u_tex_y_a),u_tex_y_b:new a.Uniform1f(n,s.u_tex_y_b),u_mix:new a.Uniform1f(n,s.u_mix)}},raster:function(n,s){return{u_matrix:new a.UniformMatrix4f(n,s.u_matrix),u_tl_parent:new a.Uniform2f(n,s.u_tl_parent),u_scale_parent:new a.Uniform1f(n,s.u_scale_parent),u_buffer_scale:new a.Uniform1f(n,s.u_buffer_scale),u_fade_t:new a.Uniform1f(n,s.u_fade_t),u_opacity:new a.Uniform1f(n,s.u_opacity),u_image0:new a.Uniform1i(n,s.u_image0),u_image1:new a.Uniform1i(n,s.u_image1),u_brightness_low:new a.Uniform1f(n,s.u_brightness_low),u_brightness_high:new a.Uniform1f(n,s.u_brightness_high),u_saturation_factor:new a.Uniform1f(n,s.u_saturation_factor),u_contrast_factor:new a.Uniform1f(n,s.u_contrast_factor),u_spin_weights:new a.Uniform3f(n,s.u_spin_weights)}},symbolIcon:function(n,s){return{u_is_size_zoom_constant:new a.Uniform1i(n,s.u_is_size_zoom_constant),u_is_size_feature_constant:new a.Uniform1i(n,s.u_is_size_feature_constant),u_size_t:new a.Uniform1f(n,s.u_size_t),u_size:new a.Uniform1f(n,s.u_size),u_camera_to_center_distance:new a.Uniform1f(n,s.u_camera_to_center_distance),u_pitch:new a.Uniform1f(n,s.u_pitch),u_rotate_symbol:new a.Uniform1i(n,s.u_rotate_symbol),u_aspect_ratio:new a.Uniform1f(n,s.u_aspect_ratio),u_fade_change:new a.Uniform1f(n,s.u_fade_change),u_matrix:new a.UniformMatrix4f(n,s.u_matrix),u_label_plane_matrix:new a.UniformMatrix4f(n,s.u_label_plane_matrix),u_coord_matrix:new a.UniformMatrix4f(n,s.u_coord_matrix),u_is_text:new a.Uniform1i(n,s.u_is_text),u_pitch_with_map:new a.Uniform1i(n,s.u_pitch_with_map),u_texsize:new a.Uniform2f(n,s.u_texsize),u_texture:new a.Uniform1i(n,s.u_texture)}},symbolSDF:function(n,s){return{u_is_size_zoom_constant:new a.Uniform1i(n,s.u_is_size_zoom_constant),u_is_size_feature_constant:new a.Uniform1i(n,s.u_is_size_feature_constant),u_size_t:new a.Uniform1f(n,s.u_size_t),u_size:new a.Uniform1f(n,s.u_size),u_camera_to_center_distance:new a.Uniform1f(n,s.u_camera_to_center_distance),u_pitch:new a.Uniform1f(n,s.u_pitch),u_rotate_symbol:new a.Uniform1i(n,s.u_rotate_symbol),u_aspect_ratio:new a.Uniform1f(n,s.u_aspect_ratio),u_fade_change:new a.Uniform1f(n,s.u_fade_change),u_matrix:new a.UniformMatrix4f(n,s.u_matrix),u_label_plane_matrix:new a.UniformMatrix4f(n,s.u_label_plane_matrix),u_coord_matrix:new a.UniformMatrix4f(n,s.u_coord_matrix),u_is_text:new a.Uniform1i(n,s.u_is_text),u_pitch_with_map:new a.Uniform1i(n,s.u_pitch_with_map),u_texsize:new a.Uniform2f(n,s.u_texsize),u_texture:new a.Uniform1i(n,s.u_texture),u_gamma_scale:new a.Uniform1f(n,s.u_gamma_scale),u_device_pixel_ratio:new a.Uniform1f(n,s.u_device_pixel_ratio),u_is_halo:new a.Uniform1i(n,s.u_is_halo)}},symbolTextAndIcon:function(n,s){return{u_is_size_zoom_constant:new a.Uniform1i(n,s.u_is_size_zoom_constant),u_is_size_feature_constant:new a.Uniform1i(n,s.u_is_size_feature_constant),u_size_t:new a.Uniform1f(n,s.u_size_t),u_size:new a.Uniform1f(n,s.u_size),u_camera_to_center_distance:new a.Uniform1f(n,s.u_camera_to_center_distance),u_pitch:new a.Uniform1f(n,s.u_pitch),u_rotate_symbol:new a.Uniform1i(n,s.u_rotate_symbol),u_aspect_ratio:new a.Uniform1f(n,s.u_aspect_ratio),u_fade_change:new a.Uniform1f(n,s.u_fade_change),u_matrix:new a.UniformMatrix4f(n,s.u_matrix),u_label_plane_matrix:new a.UniformMatrix4f(n,s.u_label_plane_matrix),u_coord_matrix:new a.UniformMatrix4f(n,s.u_coord_matrix),u_is_text:new a.Uniform1i(n,s.u_is_text),u_pitch_with_map:new a.Uniform1i(n,s.u_pitch_with_map),u_texsize:new a.Uniform2f(n,s.u_texsize),u_texsize_icon:new a.Uniform2f(n,s.u_texsize_icon),u_texture:new a.Uniform1i(n,s.u_texture),u_texture_icon:new a.Uniform1i(n,s.u_texture_icon),u_gamma_scale:new a.Uniform1f(n,s.u_gamma_scale),u_device_pixel_ratio:new a.Uniform1f(n,s.u_device_pixel_ratio),u_is_halo:new a.Uniform1i(n,s.u_is_halo)}},background:function(n,s){return{u_matrix:new a.UniformMatrix4f(n,s.u_matrix),u_opacity:new a.Uniform1f(n,s.u_opacity),u_color:new a.UniformColor(n,s.u_color)}},backgroundPattern:function(n,s){return{u_matrix:new a.UniformMatrix4f(n,s.u_matrix),u_opacity:new a.Uniform1f(n,s.u_opacity),u_image:new a.Uniform1i(n,s.u_image),u_pattern_tl_a:new a.Uniform2f(n,s.u_pattern_tl_a),u_pattern_br_a:new a.Uniform2f(n,s.u_pattern_br_a),u_pattern_tl_b:new a.Uniform2f(n,s.u_pattern_tl_b),u_pattern_br_b:new a.Uniform2f(n,s.u_pattern_br_b),u_texsize:new a.Uniform2f(n,s.u_texsize),u_mix:new a.Uniform1f(n,s.u_mix),u_pattern_size_a:new a.Uniform2f(n,s.u_pattern_size_a),u_pattern_size_b:new a.Uniform2f(n,s.u_pattern_size_b),u_scale_a:new a.Uniform1f(n,s.u_scale_a),u_scale_b:new a.Uniform1f(n,s.u_scale_b),u_pixel_coord_upper:new a.Uniform2f(n,s.u_pixel_coord_upper),u_pixel_coord_lower:new a.Uniform2f(n,s.u_pixel_coord_lower),u_tile_units_to_pixels:new a.Uniform1f(n,s.u_tile_units_to_pixels)}}};function Vo(n,s,o,c,_,w,S){for(var P=n.context,C=P.gl,O=n.useProgram("collisionBox"),Z=[],K=0,H=0,re=0;re<c.length;re++){var te=c[re],ce=s.getTile(te),Y=ce.getBucket(o);if(Y){var se=te.posMatrix;_[0]===0&&_[1]===0||(se=n.translatePosMatrix(te.posMatrix,ce,_,w));var fe=S?Y.textCollisionBox:Y.iconCollisionBox,ve=Y.collisionCircleArray;if(ve.length>0){var Ie=a.create(),ke=se;a.mul(Ie,Y.placementInvProjMatrix,n.transform.glCoordMatrix),a.mul(Ie,Ie,Y.placementViewportMatrix),Z.push({circleArray:ve,circleOffset:H,transform:ke,invTransform:Ie}),H=K+=ve.length/4}fe&&O.draw(P,C.LINES,V.disabled,W.disabled,n.colorModeForRenderPass(),pe.disabled,_o(se,n.transform,ce),o.id,fe.layoutVertexBuffer,fe.indexBuffer,fe.segments,null,n.transform.zoom,null,null,fe.collisionVertexBuffer)}}if(S&&Z.length){var Pe=n.useProgram("collisionCircle"),Ne=new a.StructArrayLayout2f1f2i16;Ne.resize(4*K),Ne._trim();for(var Je=0,Xe=0,ct=Z;Xe<ct.length;Xe+=1)for(var Et=ct[Xe],Ct=0;Ct<Et.circleArray.length/4;Ct++){var At=4*Ct,yr=Et.circleArray[At+0],ht=Et.circleArray[At+1],Ut=Et.circleArray[At+2],Yt=Et.circleArray[At+3];Ne.emplace(Je++,yr,ht,Ut,Yt,0),Ne.emplace(Je++,yr,ht,Ut,Yt,1),Ne.emplace(Je++,yr,ht,Ut,Yt,2),Ne.emplace(Je++,yr,ht,Ut,Yt,3)}(!qs||qs.length<2*K)&&(qs=function(si){var hn=2*si,Ki=new a.StructArrayLayout3ui6;Ki.resize(hn),Ki._trim();for(var ri=0;ri<hn;ri++){var fi=6*ri;Ki.uint16[fi+0]=4*ri+0,Ki.uint16[fi+1]=4*ri+1,Ki.uint16[fi+2]=4*ri+2,Ki.uint16[fi+3]=4*ri+2,Ki.uint16[fi+4]=4*ri+3,Ki.uint16[fi+5]=4*ri+0}return Ki}(K));for(var Ot=P.createIndexBuffer(qs,!0),Ft=P.createVertexBuffer(Ne,a.collisionCircleLayout.members,!0),Xt=0,Rt=Z;Xt<Rt.length;Xt+=1){var Dt=Rt[Xt],Li=fc(Dt.transform,Dt.invTransform,n.transform);Pe.draw(P,C.TRIANGLES,V.disabled,W.disabled,n.colorModeForRenderPass(),pe.disabled,Li,o.id,Ft,Ot,a.SegmentVector.simpleSegment(0,2*Dt.circleOffset,Dt.circleArray.length,Dt.circleArray.length/2),null,n.transform.zoom,null,null,null)}Ft.destroy(),Ot.destroy()}}var fa=a.identity(new Float32Array(16));function _c(n,s,o,c,_,w){var S=a.getAnchorAlignment(n),P=-(S.horizontalAlign-.5)*s,C=-(S.verticalAlign-.5)*o,O=a.evaluateVariableOffset(n,c);return new a.Point((P/_+O[0])*w,(C/_+O[1])*w)}function vc(n,s,o,c,_,w,S,P,C,O,Z){var K=n.text.placedSymbolArray,H=n.text.dynamicLayoutVertexArray,re=n.icon.dynamicLayoutVertexArray,te={};H.clear();for(var ce=0;ce<K.length;ce++){var Y=K.get(ce),se=Y.hidden||!Y.crossTileID||n.allowVerticalPlacement&&!Y.placedOrientation?null:c[Y.crossTileID];if(se){var fe=new a.Point(Y.anchorX,Y.anchorY),ve=Jt(fe,o?P:S),Ie=lr(w.cameraToCenterDistance,ve.signedDistanceFromCamera),ke=_.evaluateSizeForFeature(n.textSizeData,O,Y)*Ie/a.ONE_EM;o&&(ke*=n.tilePixelRatio/C);for(var Pe=_c(se.anchor,se.width,se.height,se.textOffset,se.textBoxScale,ke),Ne=o?Jt(fe.add(Pe),S).point:ve.point.add(s?Pe.rotate(-w.angle):Pe),Je=n.allowVerticalPlacement&&Y.placedOrientation===a.WritingMode.vertical?Math.PI/2:0,Xe=0;Xe<Y.numGlyphs;Xe++)a.addDynamicAttributes(H,Ne,Je);Z&&Y.associatedIconIndex>=0&&(te[Y.associatedIconIndex]={shiftedAnchor:Ne,angle:Je})}else ki(Y.numGlyphs,H)}if(Z){re.clear();for(var ct=n.icon.placedSymbolArray,Et=0;Et<ct.length;Et++){var Ct=ct.get(Et);if(Ct.hidden)ki(Ct.numGlyphs,re);else{var At=te[Et];if(At)for(var yr=0;yr<Ct.numGlyphs;yr++)a.addDynamicAttributes(re,At.shiftedAnchor,At.angle);else ki(Ct.numGlyphs,re)}}n.icon.dynamicLayoutVertexBuffer.updateData(re)}n.text.dynamicLayoutVertexBuffer.updateData(H)}function bc(n,s,o){return o.iconsInText&&s?"symbolTextAndIcon":n?"symbolSDF":"symbolIcon"}function xo(n,s,o,c,_,w,S,P,C,O,Z,K){for(var H=n.context,re=H.gl,te=n.transform,ce=P==="map",Y=C==="map",se=ce&&o.layout.get("symbol-placement")!=="point",fe=ce&&!Y&&!se,ve=o.layout.get("symbol-sort-key").constantOr(1)!==void 0,Ie=!1,ke=n.depthModeForSublayer(0,V.ReadOnly),Pe=o.layout.get("text-variable-anchor"),Ne=[],Je=0,Xe=c;Je<Xe.length;Je+=1){var ct=Xe[Je],Et=s.getTile(ct),Ct=Et.getBucket(o);if(Ct){var At=_?Ct.text:Ct.icon;if(At&&At.segments.get().length){var yr=At.programConfigurations.get(o.id),ht=_||Ct.sdfIcons,Ut=_?Ct.textSizeData:Ct.iconSizeData,Yt=Y||te.pitch!==0,Ot=n.useProgram(bc(ht,_,Ct),yr),Ft=a.evaluateSizeForZoom(Ut,te.zoom),Xt=void 0,Rt=[0,0],Dt=void 0,Li=void 0,si=null,hn=void 0;if(_)Dt=Et.glyphAtlasTexture,Li=re.LINEAR,Xt=Et.glyphAtlasTexture.size,Ct.iconsInText&&(Rt=Et.imageAtlasTexture.size,si=Et.imageAtlasTexture,hn=Yt||n.options.rotating||n.options.zooming||Ut.kind==="composite"||Ut.kind==="camera"?re.LINEAR:re.NEAREST);else{var Ki=o.layout.get("icon-size").constantOr(0)!==1||Ct.iconsNeedLinear;Dt=Et.imageAtlasTexture,Li=ht||n.options.rotating||n.options.zooming||Ki||Yt?re.LINEAR:re.NEAREST,Xt=Et.imageAtlasTexture.size}var ri=Ar(Et,1,n.transform.zoom),fi=Fr(ct.posMatrix,Y,ce,n.transform,ri),Hn=_r(ct.posMatrix,Y,ce,n.transform,ri),bn=Pe&&Ct.hasTextData(),Qa=o.layout.get("icon-text-fit")!=="none"&&bn&&Ct.hasIconData();se&&pa(Ct,ct.posMatrix,n,_,fi,Hn,Y,O);var An=n.translatePosMatrix(ct.posMatrix,Et,w,S),_a=se||_&&Pe||Qa?fa:fi,sa=n.translatePosMatrix(Hn,Et,w,S,!0),Ss=ht&&o.paint.get(_?"text-halo-width":"icon-halo-width").constantOr(1)!==0,Ho={program:Ot,buffers:At,uniformValues:ht?Ct.iconsInText?js(Ut.kind,Ft,fe,Y,n,An,_a,sa,Xt,Rt):cs(Ut.kind,Ft,fe,Y,n,An,_a,sa,_,Xt,!0):No(Ut.kind,Ft,fe,Y,n,An,_a,sa,_,Xt),atlasTexture:Dt,atlasTextureIcon:si,atlasInterpolation:Li,atlasInterpolationIcon:hn,isSDF:ht,hasHalo:Ss};if(ve&&Ct.canOverlap){Ie=!0;for(var $a=0,Xo=At.segments.get();$a<Xo.length;$a+=1){var Es=Xo[$a];Ne.push({segments:new a.SegmentVector([Es]),sortKey:Es.sortKey,state:Ho})}}else Ne.push({segments:At.segments,sortKey:0,state:Ho})}}}Ie&&Ne.sort(function(eo,Io){return eo.sortKey-Io.sortKey});for(var Pa=0,ks=Ne;Pa<ks.length;Pa+=1){var za=ks[Pa],Ri=za.state;if(H.activeTexture.set(re.TEXTURE0),Ri.atlasTexture.bind(Ri.atlasInterpolation,re.CLAMP_TO_EDGE),Ri.atlasTextureIcon&&(H.activeTexture.set(re.TEXTURE1),Ri.atlasTextureIcon&&Ri.atlasTextureIcon.bind(Ri.atlasInterpolationIcon,re.CLAMP_TO_EDGE)),Ri.isSDF){var La=Ri.uniformValues;Ri.hasHalo&&(La.u_is_halo=1,ps(Ri.buffers,za.segments,o,n,Ri.program,ke,Z,K,La)),La.u_is_halo=0}ps(Ri.buffers,za.segments,o,n,Ri.program,ke,Z,K,Ri.uniformValues)}}function ps(n,s,o,c,_,w,S,P,C){var O=c.context;_.draw(O,O.gl.TRIANGLES,w,S,P,pe.disabled,C,o.id,n.layoutVertexBuffer,n.indexBuffer,s,o.paint,c.transform.zoom,n.programConfigurations.get(o.id),n.dynamicLayoutVertexBuffer,n.opacityVertexBuffer)}function Gs(n,s,o,c,_,w,S){var P,C,O,Z,K,H=n.context.gl,re=o.paint.get("fill-pattern"),te=re&&re.constantOr(1),ce=o.getCrossfadeParameters();S?(C=te&&!o.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline",P=H.LINES):(C=te?"fillPattern":"fill",P=H.TRIANGLES);for(var Y=0,se=c;Y<se.length;Y+=1){var fe=se[Y],ve=s.getTile(fe);if(!te||ve.patternsLoaded()){var Ie=ve.getBucket(o);if(Ie){var ke=Ie.programConfigurations.get(o.id),Pe=n.useProgram(C,ke);te&&(n.context.activeTexture.set(H.TEXTURE0),ve.imageAtlasTexture.bind(H.LINEAR,H.CLAMP_TO_EDGE),ke.updatePaintBuffers(ce));var Ne=re.constantOr(null);if(Ne&&ve.imageAtlas){var Je=ve.imageAtlas,Xe=Je.patternPositions[Ne.to.toString()],ct=Je.patternPositions[Ne.from.toString()];Xe&&ct&&ke.setConstantPatternPositions(Xe,ct)}var Et=n.translatePosMatrix(fe.posMatrix,ve,o.paint.get("fill-translate"),o.paint.get("fill-translate-anchor"));if(S){Z=Ie.indexBuffer2,K=Ie.segments2;var Ct=[H.drawingBufferWidth,H.drawingBufferHeight];O=C==="fillOutlinePattern"&&te?pc(Et,n,ce,ve,Ct):hc(Et,Ct)}else Z=Ie.indexBuffer,K=Ie.segments,O=te?go(Et,n,ce,ve):Ka(Et);Pe.draw(n.context,P,_,n.stencilModeForClipping(fe),w,pe.disabled,O,o.id,Ie.layoutVertexBuffer,Z,K,o.paint,n.transform.zoom,ke)}}}}function Hl(n,s,o,c,_,w,S){for(var P=n.context,C=P.gl,O=o.paint.get("fill-extrusion-pattern"),Z=O.constantOr(1),K=o.getCrossfadeParameters(),H=o.paint.get("fill-extrusion-opacity"),re=0,te=c;re<te.length;re+=1){var ce=te[re],Y=s.getTile(ce),se=Y.getBucket(o);if(se){var fe=se.programConfigurations.get(o.id),ve=n.useProgram(Z?"fillExtrusionPattern":"fillExtrusion",fe);Z&&(n.context.activeTexture.set(C.TEXTURE0),Y.imageAtlasTexture.bind(C.LINEAR,C.CLAMP_TO_EDGE),fe.updatePaintBuffers(K));var Ie=O.constantOr(null);if(Ie&&Y.imageAtlas){var ke=Y.imageAtlas,Pe=ke.patternPositions[Ie.to.toString()],Ne=ke.patternPositions[Ie.from.toString()];Pe&&Ne&&fe.setConstantPatternPositions(Pe,Ne)}var Je=n.translatePosMatrix(ce.posMatrix,Y,o.paint.get("fill-extrusion-translate"),o.paint.get("fill-extrusion-translate-anchor")),Xe=o.paint.get("fill-extrusion-vertical-gradient"),ct=Z?yo(Je,n,Xe,H,ce,K,Y):cc(Je,n,Xe,H);ve.draw(P,P.gl.TRIANGLES,_,w,S,pe.backCCW,ct,o.id,se.layoutVertexBuffer,se.indexBuffer,se.segments,o.paint,n.transform.zoom,fe)}}}function Zs(n,s,o,c,_,w){var S=n.context,P=S.gl,C=s.fbo;if(C){var O=n.useProgram("hillshade");S.activeTexture.set(P.TEXTURE0),P.bindTexture(P.TEXTURE_2D,C.colorAttachment.get());var Z=function(K,H,re){var te=re.paint.get("hillshade-shadow-color"),ce=re.paint.get("hillshade-highlight-color"),Y=re.paint.get("hillshade-accent-color"),se=re.paint.get("hillshade-illumination-direction")*(Math.PI/180);re.paint.get("hillshade-illumination-anchor")==="viewport"&&(se-=K.transform.angle);var fe,ve,Ie,ke=!K.options.moving;return{u_matrix:K.transform.calculatePosMatrix(H.tileID.toUnwrapped(),ke),u_image:0,u_latrange:(fe=H.tileID,ve=Math.pow(2,fe.canonical.z),Ie=fe.canonical.y,[new a.MercatorCoordinate(0,Ie/ve).toLngLat().lat,new a.MercatorCoordinate(0,(Ie+1)/ve).toLngLat().lat]),u_light:[re.paint.get("hillshade-exaggeration"),se],u_shadow:te,u_highlight:ce,u_accent:Y}}(n,s,o);O.draw(S,P.TRIANGLES,c,_,w,pe.disabled,Z,o.id,n.rasterBoundsBuffer,n.quadTriangleIndexBuffer,n.rasterBoundsSegments)}}function Uh(n,s,o,c,_,w){var S=n.context,P=S.gl,C=s.dem;if(C&&C.data){var O=C.dim,Z=C.stride,K=C.getPixels();if(S.activeTexture.set(P.TEXTURE1),S.pixelStoreUnpackPremultiplyAlpha.set(!1),s.demTexture=s.demTexture||n.getTileTexture(Z),s.demTexture){var H=s.demTexture;H.update(K,{premultiply:!1}),H.bind(P.NEAREST,P.CLAMP_TO_EDGE)}else s.demTexture=new a.Texture(S,K,P.RGBA,{premultiply:!1}),s.demTexture.bind(P.NEAREST,P.CLAMP_TO_EDGE);S.activeTexture.set(P.TEXTURE0);var re=s.fbo;if(!re){var te=new a.Texture(S,{width:O,height:O,data:null},P.RGBA);te.bind(P.LINEAR,P.CLAMP_TO_EDGE),(re=s.fbo=S.createFramebuffer(O,O,!0)).colorAttachment.set(te.texture)}S.bindFramebuffer.set(re.framebuffer),S.viewport.set([0,0,O,O]),n.useProgram("hillshadePrepare").draw(S,P.TRIANGLES,c,_,w,pe.disabled,function(ce,Y){var se=Y.stride,fe=a.create();return a.ortho(fe,0,a.EXTENT,-a.EXTENT,0,0,1),a.translate(fe,fe,[0,-a.EXTENT,0]),{u_matrix:fe,u_image:1,u_dimension:[se,se],u_zoom:ce.overscaledZ,u_unpack:Y.getUnpackVector()}}(s.tileID,C),o.id,n.rasterBoundsBuffer,n.quadTriangleIndexBuffer,n.rasterBoundsSegments),s.needsHillshadePrepare=!1}}function Ks(n,s,o,c,_){var w=c.paint.get("raster-fade-duration");if(w>0){var S=a.browser.now(),P=(S-n.timeAdded)/w,C=s?(S-s.timeAdded)/w:-1,O=o.getSource(),Z=_.coveringZoomLevel({tileSize:O.tileSize,roundZoom:O.roundZoom}),K=!s||Math.abs(s.tileID.overscaledZ-Z)>Math.abs(n.tileID.overscaledZ-Z),H=K&&n.refreshedUponExpiration?1:a.clamp(K?P:1-C,0,1);return n.refreshedUponExpiration&&P>=1&&(n.refreshedUponExpiration=!1),s?{opacity:1,mix:1-H}:{opacity:H,mix:0}}return{opacity:1,mix:0}}var Xl=new a.Color(1,0,0,1),xc=new a.Color(0,1,0,1),wc=new a.Color(0,0,1,1),Hs=new a.Color(1,0,1,1),Wl=new a.Color(0,1,1,1);function Yl(n,s,o,c){fs(n,0,s+o/2,n.transform.width,o,c)}function Jl(n,s,o,c){fs(n,s-o/2,0,o,n.transform.height,c)}function fs(n,s,o,c,_,w){var S=n.context,P=S.gl;P.enable(P.SCISSOR_TEST),P.scissor(s*a.browser.devicePixelRatio,o*a.browser.devicePixelRatio,c*a.browser.devicePixelRatio,_*a.browser.devicePixelRatio),S.clear({color:w}),P.disable(P.SCISSOR_TEST)}function Sc(n,s,o){var c=n.context,_=c.gl,w=o.posMatrix,S=n.useProgram("debug"),P=V.disabled,C=W.disabled,O=n.colorModeForRenderPass();c.activeTexture.set(_.TEXTURE0),n.emptyTexture.bind(_.LINEAR,_.CLAMP_TO_EDGE),S.draw(c,_.LINE_STRIP,P,C,O,pe.disabled,vo(w,a.Color.red),"$debug",n.debugBuffer,n.tileBorderIndexBuffer,n.debugSegments);var Z=s.getTileByID(o.key).latestRawTileData,K=Math.floor((Z&&Z.byteLength||0)/1024),H=s.getTile(o).tileSize,re=512/Math.min(H,512)*(o.overscaledZ/n.transform.zoom)*.5,te=o.canonical.toString();o.overscaledZ!==o.canonical.z&&(te+=" => "+o.overscaledZ),function(ce,Y){ce.initDebugOverlayCanvas();var se=ce.debugOverlayCanvas,fe=ce.context.gl,ve=ce.debugOverlayCanvas.getContext("2d");ve.clearRect(0,0,se.width,se.height),ve.shadowColor="white",ve.shadowBlur=2,ve.lineWidth=1.5,ve.strokeStyle="white",ve.textBaseline="top",ve.font="bold 36px Open Sans, sans-serif",ve.fillText(Y,5,5),ve.strokeText(Y,5,5),ce.debugOverlayTexture.update(se),ce.debugOverlayTexture.bind(fe.LINEAR,fe.CLAMP_TO_EDGE)}(n,te+" "+K+"kb"),S.draw(c,_.TRIANGLES,P,C,ue.alphaBlended,pe.disabled,vo(w,a.Color.transparent,re),"$debug",n.debugBuffer,n.quadTriangleIndexBuffer,n.debugSegments)}var wo={symbol:function(n,s,o,c,_){if(n.renderPass==="translucent"){var w=W.disabled,S=n.colorModeForRenderPass();o.layout.get("text-variable-anchor")&&function(P,C,O,Z,K,H,re){for(var te=C.transform,ce=K==="map",Y=H==="map",se=0,fe=P;se<fe.length;se+=1){var ve=fe[se],Ie=Z.getTile(ve),ke=Ie.getBucket(O);if(ke&&ke.text&&ke.text.segments.get().length){var Pe=a.evaluateSizeForZoom(ke.textSizeData,te.zoom),Ne=Ar(Ie,1,C.transform.zoom),Je=Fr(ve.posMatrix,Y,ce,C.transform,Ne),Xe=O.layout.get("icon-text-fit")!=="none"&&ke.hasIconData();if(Pe){var ct=Math.pow(2,te.zoom-Ie.tileID.overscaledZ);vc(ke,ce,Y,re,a.symbolSize,te,Je,ve.posMatrix,ct,Pe,Xe)}}}}(c,n,o,s,o.layout.get("text-rotation-alignment"),o.layout.get("text-pitch-alignment"),_),o.paint.get("icon-opacity").constantOr(1)!==0&&xo(n,s,o,c,!1,o.paint.get("icon-translate"),o.paint.get("icon-translate-anchor"),o.layout.get("icon-rotation-alignment"),o.layout.get("icon-pitch-alignment"),o.layout.get("icon-keep-upright"),w,S),o.paint.get("text-opacity").constantOr(1)!==0&&xo(n,s,o,c,!0,o.paint.get("text-translate"),o.paint.get("text-translate-anchor"),o.layout.get("text-rotation-alignment"),o.layout.get("text-pitch-alignment"),o.layout.get("text-keep-upright"),w,S),s.map.showCollisionBoxes&&(Vo(n,s,o,c,o.paint.get("text-translate"),o.paint.get("text-translate-anchor"),!0),Vo(n,s,o,c,o.paint.get("icon-translate"),o.paint.get("icon-translate-anchor"),!1))}},circle:function(n,s,o,c){if(n.renderPass==="translucent"){var _=o.paint.get("circle-opacity"),w=o.paint.get("circle-stroke-width"),S=o.paint.get("circle-stroke-opacity"),P=o.layout.get("circle-sort-key").constantOr(1)!==void 0;if(_.constantOr(1)!==0||w.constantOr(1)!==0&&S.constantOr(1)!==0){for(var C=n.context,O=C.gl,Z=n.depthModeForSublayer(0,V.ReadOnly),K=W.disabled,H=n.colorModeForRenderPass(),re=[],te=0;te<c.length;te++){var ce=c[te],Y=s.getTile(ce),se=Y.getBucket(o);if(se){var fe=se.programConfigurations.get(o.id),ve={programConfiguration:fe,program:n.useProgram("circle",fe),layoutVertexBuffer:se.layoutVertexBuffer,indexBuffer:se.indexBuffer,uniformValues:Kl(n,ce,Y,o)};if(P)for(var Ie=0,ke=se.segments.get();Ie<ke.length;Ie+=1){var Pe=ke[Ie];re.push({segments:new a.SegmentVector([Pe]),sortKey:Pe.sortKey,state:ve})}else re.push({segments:se.segments,sortKey:0,state:ve})}}P&&re.sort(function(Et,Ct){return Et.sortKey-Ct.sortKey});for(var Ne=0,Je=re;Ne<Je.length;Ne+=1){var Xe=Je[Ne],ct=Xe.state;ct.program.draw(C,O.TRIANGLES,Z,K,H,pe.disabled,ct.uniformValues,o.id,ct.layoutVertexBuffer,ct.indexBuffer,Xe.segments,o.paint,n.transform.zoom,ct.programConfiguration)}}}},heatmap:function(n,s,o,c){if(o.paint.get("heatmap-opacity")!==0)if(n.renderPass==="offscreen"){var _=n.context,w=_.gl,S=W.disabled,P=new ue([w.ONE,w.ONE],a.Color.transparent,[!0,!0,!0,!0]);(function(re,te,ce){var Y=re.gl;re.activeTexture.set(Y.TEXTURE1),re.viewport.set([0,0,te.width/4,te.height/4]);var se=ce.heatmapFbo;if(se)Y.bindTexture(Y.TEXTURE_2D,se.colorAttachment.get()),re.bindFramebuffer.set(se.framebuffer);else{var fe=Y.createTexture();Y.bindTexture(Y.TEXTURE_2D,fe),Y.texParameteri(Y.TEXTURE_2D,Y.TEXTURE_WRAP_S,Y.CLAMP_TO_EDGE),Y.texParameteri(Y.TEXTURE_2D,Y.TEXTURE_WRAP_T,Y.CLAMP_TO_EDGE),Y.texParameteri(Y.TEXTURE_2D,Y.TEXTURE_MIN_FILTER,Y.LINEAR),Y.texParameteri(Y.TEXTURE_2D,Y.TEXTURE_MAG_FILTER,Y.LINEAR),se=ce.heatmapFbo=re.createFramebuffer(te.width/4,te.height/4,!1),function(ve,Ie,ke,Pe){var Ne=ve.gl;Ne.texImage2D(Ne.TEXTURE_2D,0,Ne.RGBA,Ie.width/4,Ie.height/4,0,Ne.RGBA,ve.extRenderToTextureHalfFloat?ve.extTextureHalfFloat.HALF_FLOAT_OES:Ne.UNSIGNED_BYTE,null),Pe.colorAttachment.set(ke)}(re,te,fe,se)}})(_,n,o),_.clear({color:a.Color.transparent});for(var C=0;C<c.length;C++){var O=c[C];if(!s.hasRenderableParent(O)){var Z=s.getTile(O),K=Z.getBucket(o);if(K){var H=K.programConfigurations.get(o.id);n.useProgram("heatmap",H).draw(_,w.TRIANGLES,V.disabled,S,P,pe.disabled,dc(O.posMatrix,Z,n.transform.zoom,o.paint.get("heatmap-intensity")),o.id,K.layoutVertexBuffer,K.indexBuffer,K.segments,o.paint,n.transform.zoom,H)}}}_.viewport.set([0,0,n.width,n.height])}else n.renderPass==="translucent"&&(n.context.setColorMode(n.colorModeForRenderPass()),function(re,te){var ce=re.context,Y=ce.gl,se=te.heatmapFbo;if(se){ce.activeTexture.set(Y.TEXTURE0),Y.bindTexture(Y.TEXTURE_2D,se.colorAttachment.get()),ce.activeTexture.set(Y.TEXTURE1);var fe=te.colorRampTexture;fe||(fe=te.colorRampTexture=new a.Texture(ce,te.colorRamp,Y.RGBA)),fe.bind(Y.LINEAR,Y.CLAMP_TO_EDGE),re.useProgram("heatmapTexture").draw(ce,Y.TRIANGLES,V.disabled,W.disabled,re.colorModeForRenderPass(),pe.disabled,function(ve,Ie,ke,Pe){var Ne=a.create();a.ortho(Ne,0,ve.width,ve.height,0,0,1);var Je=ve.context.gl;return{u_matrix:Ne,u_world:[Je.drawingBufferWidth,Je.drawingBufferHeight],u_image:0,u_color_ramp:1,u_opacity:Ie.paint.get("heatmap-opacity")}}(re,te),te.id,re.viewportBuffer,re.quadTriangleIndexBuffer,re.viewportSegments,te.paint,re.transform.zoom)}}(n,o))},line:function(n,s,o,c){if(n.renderPass==="translucent"){var _=o.paint.get("line-opacity"),w=o.paint.get("line-width");if(_.constantOr(1)!==0&&w.constantOr(1)!==0)for(var S=n.depthModeForSublayer(0,V.ReadOnly),P=n.colorModeForRenderPass(),C=o.paint.get("line-dasharray"),O=o.paint.get("line-pattern"),Z=O.constantOr(1),K=o.paint.get("line-gradient"),H=o.getCrossfadeParameters(),re=Z?"linePattern":C?"lineSDF":K?"lineGradient":"line",te=n.context,ce=te.gl,Y=!0,se=0,fe=c;se<fe.length;se+=1){var ve=fe[se],Ie=s.getTile(ve);if(!Z||Ie.patternsLoaded()){var ke=Ie.getBucket(o);if(ke){var Pe=ke.programConfigurations.get(o.id),Ne=n.context.program.get(),Je=n.useProgram(re,Pe),Xe=Y||Je.program!==Ne,ct=O.constantOr(null);if(ct&&Ie.imageAtlas){var Et=Ie.imageAtlas,Ct=Et.patternPositions[ct.to.toString()],At=Et.patternPositions[ct.from.toString()];Ct&&At&&Pe.setConstantPatternPositions(Ct,At)}var yr=Z?Vs(n,Ie,o,H):C?Oh(n,Ie,o,C,H):K?Or(n,Ie,o,ke.lineClipsArray.length):us(n,Ie,o);if(Z)te.activeTexture.set(ce.TEXTURE0),Ie.imageAtlasTexture.bind(ce.LINEAR,ce.CLAMP_TO_EDGE),Pe.updatePaintBuffers(H);else if(C&&(Xe||n.lineAtlas.dirty))te.activeTexture.set(ce.TEXTURE0),n.lineAtlas.bind(te);else if(K){var ht=ke.gradients[o.id],Ut=ht.texture;if(o.gradientVersion!==ht.version){var Yt=256;if(o.stepInterpolant){var Ot=s.getSource().maxzoom,Ft=ve.canonical.z===Ot?Math.ceil(1<<n.transform.maxZoom-ve.canonical.z):1;Yt=a.clamp(a.nextPowerOfTwo(ke.maxLineLength/a.EXTENT*1024*Ft),256,te.maxTextureSize)}ht.gradient=a.renderColorRamp({expression:o.gradientExpression(),evaluationKey:"lineProgress",resolution:Yt,image:ht.gradient||void 0,clips:ke.lineClipsArray}),ht.texture?ht.texture.update(ht.gradient):ht.texture=new a.Texture(te,ht.gradient,ce.RGBA),ht.version=o.gradientVersion,Ut=ht.texture}te.activeTexture.set(ce.TEXTURE0),Ut.bind(o.stepInterpolant?ce.NEAREST:ce.LINEAR,ce.CLAMP_TO_EDGE)}Je.draw(te,ce.TRIANGLES,S,n.stencilModeForClipping(ve),P,pe.disabled,yr,o.id,ke.layoutVertexBuffer,ke.indexBuffer,ke.segments,o.paint,n.transform.zoom,Pe,ke.layoutVertexBuffer2),Y=!1}}}}},fill:function(n,s,o,c){var _=o.paint.get("fill-color"),w=o.paint.get("fill-opacity");if(w.constantOr(1)!==0){var S=n.colorModeForRenderPass(),P=o.paint.get("fill-pattern"),C=n.opaquePassEnabledForLayer()&&!P.constantOr(1)&&_.constantOr(a.Color.transparent).a===1&&w.constantOr(0)===1?"opaque":"translucent";if(n.renderPass===C){var O=n.depthModeForSublayer(1,n.renderPass==="opaque"?V.ReadWrite:V.ReadOnly);Gs(n,s,o,c,O,S,!1)}if(n.renderPass==="translucent"&&o.paint.get("fill-antialias")){var Z=n.depthModeForSublayer(o.getPaintProperty("fill-outline-color")?2:0,V.ReadOnly);Gs(n,s,o,c,Z,S,!0)}}},"fill-extrusion":function(n,s,o,c){var _=o.paint.get("fill-extrusion-opacity");if(_!==0&&n.renderPass==="translucent"){var w=new V(n.context.gl.LEQUAL,V.ReadWrite,n.depthRangeFor3D);if(_!==1||o.paint.get("fill-extrusion-pattern").constantOr(1))Hl(n,s,o,c,w,W.disabled,ue.disabled),Hl(n,s,o,c,w,n.stencilModeFor3D(),n.colorModeForRenderPass());else{var S=n.colorModeForRenderPass();Hl(n,s,o,c,w,W.disabled,S)}}},hillshade:function(n,s,o,c){if(n.renderPass==="offscreen"||n.renderPass==="translucent"){for(var _=n.context,w=n.depthModeForSublayer(0,V.ReadOnly),S=n.colorModeForRenderPass(),P=n.renderPass==="translucent"?n.stencilConfigForOverlap(c):[{},c],C=P[0],O=0,Z=P[1];O<Z.length;O+=1){var K=Z[O],H=s.getTile(K);H.needsHillshadePrepare&&n.renderPass==="offscreen"?Uh(n,H,o,w,W.disabled,S):n.renderPass==="translucent"&&Zs(n,H,o,w,C[K.overscaledZ],S)}_.viewport.set([0,0,n.width,n.height])}},raster:function(n,s,o,c){if(n.renderPass==="translucent"&&o.paint.get("raster-opacity")!==0&&c.length)for(var _=n.context,w=_.gl,S=s.getSource(),P=n.useProgram("raster"),C=n.colorModeForRenderPass(),O=S instanceof at?[{},c]:n.stencilConfigForOverlap(c),Z=O[0],K=O[1],H=K[K.length-1].overscaledZ,re=!n.options.moving,te=0,ce=K;te<ce.length;te+=1){var Y=ce[te],se=n.depthModeForSublayer(Y.overscaledZ-H,o.paint.get("raster-opacity")===1?V.ReadWrite:V.ReadOnly,w.LESS),fe=s.getTile(Y),ve=n.transform.calculatePosMatrix(Y.toUnwrapped(),re);fe.registerFadeDuration(o.paint.get("raster-fade-duration"));var Ie=s.findLoadedParent(Y,0),ke=Ks(fe,Ie,s,o,n.transform),Pe=void 0,Ne=void 0,Je=o.paint.get("raster-resampling")==="nearest"?w.NEAREST:w.LINEAR;_.activeTexture.set(w.TEXTURE0),fe.texture.bind(Je,w.CLAMP_TO_EDGE,w.LINEAR_MIPMAP_NEAREST),_.activeTexture.set(w.TEXTURE1),Ie?(Ie.texture.bind(Je,w.CLAMP_TO_EDGE,w.LINEAR_MIPMAP_NEAREST),Pe=Math.pow(2,Ie.tileID.overscaledZ-fe.tileID.overscaledZ),Ne=[fe.tileID.canonical.x*Pe%1,fe.tileID.canonical.y*Pe%1]):fe.texture.bind(Je,w.CLAMP_TO_EDGE,w.LINEAR_MIPMAP_NEAREST);var Xe=Nh(ve,Ne||[0,0],Pe||1,ke,o);S instanceof at?P.draw(_,w.TRIANGLES,se,W.disabled,C,pe.disabled,Xe,o.id,S.boundsBuffer,n.quadTriangleIndexBuffer,S.boundsSegments):P.draw(_,w.TRIANGLES,se,Z[Y.overscaledZ],C,pe.disabled,Xe,o.id,n.rasterBoundsBuffer,n.quadTriangleIndexBuffer,n.rasterBoundsSegments)}},background:function(n,s,o){var c=o.paint.get("background-color"),_=o.paint.get("background-opacity");if(_!==0){var w=n.context,S=w.gl,P=n.transform,C=P.tileSize,O=o.paint.get("background-pattern");if(!n.isPatternMissing(O)){var Z=!O&&c.a===1&&_===1&&n.opaquePassEnabledForLayer()?"opaque":"translucent";if(n.renderPass===Z){var K=W.disabled,H=n.depthModeForSublayer(0,Z==="opaque"?V.ReadWrite:V.ReadOnly),re=n.colorModeForRenderPass(),te=n.useProgram(O?"backgroundPattern":"background"),ce=P.coveringTiles({tileSize:C});O&&(w.activeTexture.set(S.TEXTURE0),n.imageManager.bind(n.context));for(var Y=o.getCrossfadeParameters(),se=0,fe=ce;se<fe.length;se+=1){var ve=fe[se],Ie=n.transform.calculatePosMatrix(ve.toUnwrapped()),ke=O?Uo(Ie,_,n,O,{tileID:ve,tileSize:C},Y):hs(Ie,_,c);te.draw(w,S.TRIANGLES,H,K,re,pe.disabled,ke,o.id,n.tileExtentBuffer,n.quadTriangleIndexBuffer,n.tileExtentSegments)}}}}},debug:function(n,s,o){for(var c=0;c<o.length;c++)Sc(n,s,o[c])},custom:function(n,s,o){var c=n.context,_=o.implementation;if(n.renderPass==="offscreen"){var w=_.prerender;w&&(n.setCustomLayerDefaults(),c.setColorMode(n.colorModeForRenderPass()),w.call(_,c.gl,n.transform.customLayerMatrix()),c.setDirty(),n.setBaseState())}else if(n.renderPass==="translucent"){n.setCustomLayerDefaults(),c.setColorMode(n.colorModeForRenderPass()),c.setStencilMode(W.disabled);var S=_.renderingMode==="3d"?new V(n.context.gl.LEQUAL,V.ReadWrite,n.depthRangeFor3D):n.depthModeForSublayer(0,V.ReadOnly);c.setDepthMode(S),_.render(c.gl,n.transform.customLayerMatrix()),c.setDirty(),n.setBaseState(),c.bindFramebuffer.set(null)}}},Hr=function(n,s){this.context=new j(n),this.transform=s,this._tileTextures={},this.setup(),this.numSublayers=$.maxUnderzooming+$.maxOverzooming+1,this.depthEpsilon=1/Math.pow(2,16),this.crossTileSymbolIndex=new _e,this.gpuTimers={}};Hr.prototype.resize=function(n,s){if(this.width=n*a.browser.devicePixelRatio,this.height=s*a.browser.devicePixelRatio,this.context.viewport.set([0,0,this.width,this.height]),this.style)for(var o=0,c=this.style._order;o<c.length;o+=1)this.style._layers[c[o]].resize()},Hr.prototype.setup=function(){var n=this.context,s=new a.StructArrayLayout2i4;s.emplaceBack(0,0),s.emplaceBack(a.EXTENT,0),s.emplaceBack(0,a.EXTENT),s.emplaceBack(a.EXTENT,a.EXTENT),this.tileExtentBuffer=n.createVertexBuffer(s,vi.members),this.tileExtentSegments=a.SegmentVector.simpleSegment(0,0,4,2);var o=new a.StructArrayLayout2i4;o.emplaceBack(0,0),o.emplaceBack(a.EXTENT,0),o.emplaceBack(0,a.EXTENT),o.emplaceBack(a.EXTENT,a.EXTENT),this.debugBuffer=n.createVertexBuffer(o,vi.members),this.debugSegments=a.SegmentVector.simpleSegment(0,0,4,5);var c=new a.StructArrayLayout4i8;c.emplaceBack(0,0,0,0),c.emplaceBack(a.EXTENT,0,a.EXTENT,0),c.emplaceBack(0,a.EXTENT,0,a.EXTENT),c.emplaceBack(a.EXTENT,a.EXTENT,a.EXTENT,a.EXTENT),this.rasterBoundsBuffer=n.createVertexBuffer(c,Ae.members),this.rasterBoundsSegments=a.SegmentVector.simpleSegment(0,0,4,2);var _=new a.StructArrayLayout2i4;_.emplaceBack(0,0),_.emplaceBack(1,0),_.emplaceBack(0,1),_.emplaceBack(1,1),this.viewportBuffer=n.createVertexBuffer(_,vi.members),this.viewportSegments=a.SegmentVector.simpleSegment(0,0,4,2);var w=new a.StructArrayLayout1ui2;w.emplaceBack(0),w.emplaceBack(1),w.emplaceBack(3),w.emplaceBack(2),w.emplaceBack(0),this.tileBorderIndexBuffer=n.createIndexBuffer(w);var S=new a.StructArrayLayout3ui6;S.emplaceBack(0,1,2),S.emplaceBack(2,1,3),this.quadTriangleIndexBuffer=n.createIndexBuffer(S),this.emptyTexture=new a.Texture(n,{width:1,height:1,data:new Uint8Array([0,0,0,0])},n.gl.RGBA);var P=this.context.gl;this.stencilClearMode=new W({func:P.ALWAYS,mask:0},0,255,P.ZERO,P.ZERO,P.ZERO)},Hr.prototype.clearStencil=function(){var n=this.context,s=n.gl;this.nextStencilID=1,this.currentStencilSource=void 0;var o=a.create();a.ortho(o,0,this.width,this.height,0,0,1),a.scale(o,o,[s.drawingBufferWidth,s.drawingBufferHeight,0]),this.useProgram("clippingMask").draw(n,s.TRIANGLES,V.disabled,this.stencilClearMode,ue.disabled,pe.disabled,bo(o),"$clipping",this.viewportBuffer,this.quadTriangleIndexBuffer,this.viewportSegments)},Hr.prototype._renderTileClippingMasks=function(n,s){if(this.currentStencilSource!==n.source&&n.isTileClipped()&&s&&s.length){this.currentStencilSource=n.source;var o=this.context,c=o.gl;this.nextStencilID+s.length>256&&this.clearStencil(),o.setColorMode(ue.disabled),o.setDepthMode(V.disabled);var _=this.useProgram("clippingMask");this._tileClippingMaskIDs={};for(var w=0,S=s;w<S.length;w+=1){var P=S[w],C=this._tileClippingMaskIDs[P.key]=this.nextStencilID++;_.draw(o,c.TRIANGLES,V.disabled,new W({func:c.ALWAYS,mask:0},C,255,c.KEEP,c.KEEP,c.REPLACE),ue.disabled,pe.disabled,bo(P.posMatrix),"$clipping",this.tileExtentBuffer,this.quadTriangleIndexBuffer,this.tileExtentSegments)}}},Hr.prototype.stencilModeFor3D=function(){this.currentStencilSource=void 0,this.nextStencilID+1>256&&this.clearStencil();var n=this.nextStencilID++,s=this.context.gl;return new W({func:s.NOTEQUAL,mask:255},n,255,s.KEEP,s.KEEP,s.REPLACE)},Hr.prototype.stencilModeForClipping=function(n){var s=this.context.gl;return new W({func:s.EQUAL,mask:255},this._tileClippingMaskIDs[n.key],0,s.KEEP,s.KEEP,s.REPLACE)},Hr.prototype.stencilConfigForOverlap=function(n){var s,o=this.context.gl,c=n.sort(function(C,O){return O.overscaledZ-C.overscaledZ}),_=c[c.length-1].overscaledZ,w=c[0].overscaledZ-_+1;if(w>1){this.currentStencilSource=void 0,this.nextStencilID+w>256&&this.clearStencil();for(var S={},P=0;P<w;P++)S[P+_]=new W({func:o.GEQUAL,mask:255},P+this.nextStencilID,255,o.KEEP,o.KEEP,o.REPLACE);return this.nextStencilID+=w,[S,c]}return[(s={},s[_]=W.disabled,s),c]},Hr.prototype.colorModeForRenderPass=function(){var n=this.context.gl;return this._showOverdrawInspector?new ue([n.CONSTANT_COLOR,n.ONE],new a.Color(1/8,1/8,1/8,0),[!0,!0,!0,!0]):this.renderPass==="opaque"?ue.unblended:ue.alphaBlended},Hr.prototype.depthModeForSublayer=function(n,s,o){if(!this.opaquePassEnabledForLayer())return V.disabled;var c=1-((1+this.currentLayer)*this.numSublayers+n)*this.depthEpsilon;return new V(o||this.context.gl.LEQUAL,s,[c,c])},Hr.prototype.opaquePassEnabledForLayer=function(){return this.currentLayer<this.opaquePassCutoff},Hr.prototype.render=function(n,s){var o=this;this.style=n,this.options=s,this.lineAtlas=n.lineAtlas,this.imageManager=n.imageManager,this.glyphManager=n.glyphManager,this.symbolFadeChange=n.placement.symbolFadeChange(a.browser.now()),this.imageManager.beginFrame();var c=this.style._order,_=this.style.sourceCaches;for(var w in _){var S=_[w];S.used&&S.prepare(this.context)}var P,C,O={},Z={},K={};for(var H in _){var re=_[H];O[H]=re.getVisibleCoordinates(),Z[H]=O[H].slice().reverse(),K[H]=re.getVisibleCoordinates(!0).reverse()}this.opaquePassCutoff=1/0;for(var te=0;te<c.length;te++)if(this.style._layers[c[te]].is3D()){this.opaquePassCutoff=te;break}this.renderPass="offscreen";for(var ce=0,Y=c;ce<Y.length;ce+=1){var se=this.style._layers[Y[ce]];if(se.hasOffscreenPass()&&!se.isHidden(this.transform.zoom)){var fe=Z[se.source];(se.type==="custom"||fe.length)&&this.renderLayer(this,_[se.source],se,fe)}}for(this.context.bindFramebuffer.set(null),this.context.clear({color:s.showOverdrawInspector?a.Color.black:a.Color.transparent,depth:1}),this.clearStencil(),this._showOverdrawInspector=s.showOverdrawInspector,this.depthRangeFor3D=[0,1-(n._order.length+2)*this.numSublayers*this.depthEpsilon],this.renderPass="opaque",this.currentLayer=c.length-1;this.currentLayer>=0;this.currentLayer--){var ve=this.style._layers[c[this.currentLayer]],Ie=_[ve.source],ke=O[ve.source];this._renderTileClippingMasks(ve,ke),this.renderLayer(this,Ie,ve,ke)}for(this.renderPass="translucent",this.currentLayer=0;this.currentLayer<c.length;this.currentLayer++){var Pe=this.style._layers[c[this.currentLayer]],Ne=_[Pe.source],Je=(Pe.type==="symbol"?K:Z)[Pe.source];this._renderTileClippingMasks(Pe,O[Pe.source]),this.renderLayer(this,Ne,Pe,Je)}this.options.showTileBoundaries&&(a.values(this.style._layers).forEach(function(Xe){Xe.source&&!Xe.isHidden(o.transform.zoom)&&(Xe.source!==(C&&C.id)&&(C=o.style.sourceCaches[Xe.source]),(!P||P.getSource().maxzoom<C.getSource().maxzoom)&&(P=C))}),P&&wo.debug(this,P,P.getVisibleCoordinates())),this.options.showPadding&&function(Xe){var ct=Xe.transform.padding;Yl(Xe,Xe.transform.height-(ct.top||0),3,Xl),Yl(Xe,ct.bottom||0,3,xc),Jl(Xe,ct.left||0,3,wc),Jl(Xe,Xe.transform.width-(ct.right||0),3,Hs);var Et=Xe.transform.centerPoint;(function(Ct,At,yr,ht){fs(Ct,At-1,yr-10,2,20,ht),fs(Ct,At-10,yr-1,20,2,ht)})(Xe,Et.x,Xe.transform.height-Et.y,Wl)}(this),this.context.setDefault()},Hr.prototype.renderLayer=function(n,s,o,c){o.isHidden(this.transform.zoom)||(o.type==="background"||o.type==="custom"||c.length)&&(this.id=o.id,this.gpuTimingStart(o),wo[o.type](n,s,o,c,this.style.placement.variableOffsets),this.gpuTimingEnd())},Hr.prototype.gpuTimingStart=function(n){if(this.options.gpuTiming){var s=this.context.extTimerQuery,o=this.gpuTimers[n.id];o||(o=this.gpuTimers[n.id]={calls:0,cpuTime:0,query:s.createQueryEXT()}),o.calls++,s.beginQueryEXT(s.TIME_ELAPSED_EXT,o.query)}},Hr.prototype.gpuTimingEnd=function(){if(this.options.gpuTiming){var n=this.context.extTimerQuery;n.endQueryEXT(n.TIME_ELAPSED_EXT)}},Hr.prototype.collectGpuTimers=function(){var n=this.gpuTimers;return this.gpuTimers={},n},Hr.prototype.queryGpuTimers=function(n){var s={};for(var o in n){var c=n[o],_=this.context.extTimerQuery,w=_.getQueryObjectEXT(c.query,_.QUERY_RESULT_EXT)/1e6;_.deleteQueryEXT(c.query),s[o]=w}return s},Hr.prototype.translatePosMatrix=function(n,s,o,c,_){if(!o[0]&&!o[1])return n;var w=_?c==="map"?this.transform.angle:0:c==="viewport"?-this.transform.angle:0;if(w){var S=Math.sin(w),P=Math.cos(w);o=[o[0]*P-o[1]*S,o[0]*S+o[1]*P]}var C=[_?o[0]:Ar(s,o[0],this.transform.zoom),_?o[1]:Ar(s,o[1],this.transform.zoom),0],O=new Float32Array(16);return a.translate(O,n,C),O},Hr.prototype.saveTileTexture=function(n){var s=this._tileTextures[n.size[0]];s?s.push(n):this._tileTextures[n.size[0]]=[n]},Hr.prototype.getTileTexture=function(n){var s=this._tileTextures[n];return s&&s.length>0?s.pop():null},Hr.prototype.isPatternMissing=function(n){if(!n)return!1;if(!n.from||!n.to)return!0;var s=this.imageManager.getPattern(n.from.toString()),o=this.imageManager.getPattern(n.to.toString());return!s||!o},Hr.prototype.useProgram=function(n,s){this.cache=this.cache||{};var o=""+n+(s?s.cacheKey:"")+(this._showOverdrawInspector?"/overdraw":"");return this.cache[o]||(this.cache[o]=new lc(this.context,n,Fh[n],s,gc[n],this._showOverdrawInspector)),this.cache[o]},Hr.prototype.setCustomLayerDefaults=function(){this.context.unbindVAO(),this.context.cullFace.setDefault(),this.context.activeTexture.setDefault(),this.context.pixelStoreUnpack.setDefault(),this.context.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.context.pixelStoreUnpackFlipY.setDefault()},Hr.prototype.setBaseState=function(){var n=this.context.gl;this.context.cullFace.set(!1),this.context.viewport.set([0,0,this.width,this.height]),this.context.blendEquation.set(n.FUNC_ADD)},Hr.prototype.initDebugOverlayCanvas=function(){this.debugOverlayCanvas==null&&(this.debugOverlayCanvas=a.window.document.createElement("canvas"),this.debugOverlayCanvas.width=512,this.debugOverlayCanvas.height=512,this.debugOverlayTexture=new a.Texture(this.context,this.debugOverlayCanvas,this.context.gl.RGBA))},Hr.prototype.destroy=function(){this.emptyTexture.destroy(),this.debugOverlayTexture&&this.debugOverlayTexture.destroy()};var Xs=function(n,s){this.points=n,this.planes=s};Xs.fromInvProjectionMatrix=function(n,s,o){var c=Math.pow(2,o),_=[[-1,1,-1,1],[1,1,-1,1],[1,-1,-1,1],[-1,-1,-1,1],[-1,1,1,1],[1,1,1,1],[1,-1,1,1],[-1,-1,1,1]].map(function(S){return a.transformMat4([],S,n)}).map(function(S){return a.scale$1([],S,1/S[3]/s*c)}),w=[[0,1,2],[6,5,4],[0,3,7],[2,1,5],[3,2,6],[0,4,5]].map(function(S){var P=a.sub([],_[S[0]],_[S[1]]),C=a.sub([],_[S[2]],_[S[1]]),O=a.normalize([],a.cross([],P,C)),Z=-a.dot(O,_[S[1]]);return O.concat(Z)});return new Xs(_,w)};var So=function(n,s){this.min=n,this.max=s,this.center=a.scale$2([],a.add([],this.min,this.max),.5)};So.prototype.quadrant=function(n){for(var s=[n%2==0,n<2],o=a.clone$2(this.min),c=a.clone$2(this.max),_=0;_<s.length;_++)o[_]=s[_]?this.min[_]:this.center[_],c[_]=s[_]?this.center[_]:this.max[_];return c[2]=this.max[2],new So(o,c)},So.prototype.distanceX=function(n){return Math.max(Math.min(this.max[0],n[0]),this.min[0])-n[0]},So.prototype.distanceY=function(n){return Math.max(Math.min(this.max[1],n[1]),this.min[1])-n[1]},So.prototype.intersects=function(n){for(var s=[[this.min[0],this.min[1],0,1],[this.max[0],this.min[1],0,1],[this.max[0],this.max[1],0,1],[this.min[0],this.max[1],0,1]],o=!0,c=0;c<n.planes.length;c++){for(var _=n.planes[c],w=0,S=0;S<s.length;S++)w+=a.dot$1(_,s[S])>=0;if(w===0)return 0;w!==s.length&&(o=!1)}if(o)return 2;for(var P=0;P<3;P++){for(var C=Number.MAX_VALUE,O=-Number.MAX_VALUE,Z=0;Z<n.points.length;Z++){var K=n.points[Z][P]-this.min[P];C=Math.min(C,K),O=Math.max(O,K)}if(O<0||C>this.max[P]-this.min[P])return 0}return 1};var Ha=function(n,s,o,c){if(n===void 0&&(n=0),s===void 0&&(s=0),o===void 0&&(o=0),c===void 0&&(c=0),isNaN(n)||n<0||isNaN(s)||s<0||isNaN(o)||o<0||isNaN(c)||c<0)throw new Error("Invalid value for edge-insets, top, bottom, left and right must all be numbers");this.top=n,this.bottom=s,this.left=o,this.right=c};Ha.prototype.interpolate=function(n,s,o){return s.top!=null&&n.top!=null&&(this.top=a.number(n.top,s.top,o)),s.bottom!=null&&n.bottom!=null&&(this.bottom=a.number(n.bottom,s.bottom,o)),s.left!=null&&n.left!=null&&(this.left=a.number(n.left,s.left,o)),s.right!=null&&n.right!=null&&(this.right=a.number(n.right,s.right,o)),this},Ha.prototype.getCenter=function(n,s){var o=a.clamp((this.left+n-this.right)/2,0,n),c=a.clamp((this.top+s-this.bottom)/2,0,s);return new a.Point(o,c)},Ha.prototype.equals=function(n){return this.top===n.top&&this.bottom===n.bottom&&this.left===n.left&&this.right===n.right},Ha.prototype.clone=function(){return new Ha(this.top,this.bottom,this.left,this.right)},Ha.prototype.toJSON=function(){return{top:this.top,bottom:this.bottom,left:this.left,right:this.right}};var fr=function(n,s,o,c,_){this.tileSize=512,this.maxValidLatitude=85.051129,this._renderWorldCopies=_===void 0||_,this._minZoom=n||0,this._maxZoom=s||22,this._minPitch=o??0,this._maxPitch=c??60,this.setMaxBounds(),this.width=0,this.height=0,this._center=new a.LngLat(0,0),this.zoom=0,this.angle=0,this._fov=.6435011087932844,this._pitch=0,this._unmodified=!0,this._edgeInsets=new Ha,this._posMatrixCache={},this._alignedPosMatrixCache={}},Nr={minZoom:{configurable:!0},maxZoom:{configurable:!0},minPitch:{configurable:!0},maxPitch:{configurable:!0},renderWorldCopies:{configurable:!0},worldSize:{configurable:!0},centerOffset:{configurable:!0},size:{configurable:!0},bearing:{configurable:!0},pitch:{configurable:!0},fov:{configurable:!0},zoom:{configurable:!0},center:{configurable:!0},padding:{configurable:!0},centerPoint:{configurable:!0},unmodified:{configurable:!0},point:{configurable:!0}};fr.prototype.clone=function(){var n=new fr(this._minZoom,this._maxZoom,this._minPitch,this.maxPitch,this._renderWorldCopies);return n.tileSize=this.tileSize,n.latRange=this.latRange,n.width=this.width,n.height=this.height,n._center=this._center,n.zoom=this.zoom,n.angle=this.angle,n._fov=this._fov,n._pitch=this._pitch,n._unmodified=this._unmodified,n._edgeInsets=this._edgeInsets.clone(),n._calcMatrices(),n},Nr.minZoom.get=function(){return this._minZoom},Nr.minZoom.set=function(n){this._minZoom!==n&&(this._minZoom=n,this.zoom=Math.max(this.zoom,n))},Nr.maxZoom.get=function(){return this._maxZoom},Nr.maxZoom.set=function(n){this._maxZoom!==n&&(this._maxZoom=n,this.zoom=Math.min(this.zoom,n))},Nr.minPitch.get=function(){return this._minPitch},Nr.minPitch.set=function(n){this._minPitch!==n&&(this._minPitch=n,this.pitch=Math.max(this.pitch,n))},Nr.maxPitch.get=function(){return this._maxPitch},Nr.maxPitch.set=function(n){this._maxPitch!==n&&(this._maxPitch=n,this.pitch=Math.min(this.pitch,n))},Nr.renderWorldCopies.get=function(){return this._renderWorldCopies},Nr.renderWorldCopies.set=function(n){n===void 0?n=!0:n===null&&(n=!1),this._renderWorldCopies=n},Nr.worldSize.get=function(){return this.tileSize*this.scale},Nr.centerOffset.get=function(){return this.centerPoint._sub(this.size._div(2))},Nr.size.get=function(){return new a.Point(this.width,this.height)},Nr.bearing.get=function(){return-this.angle/Math.PI*180},Nr.bearing.set=function(n){var s=-a.wrap(n,-180,180)*Math.PI/180;this.angle!==s&&(this._unmodified=!1,this.angle=s,this._calcMatrices(),this.rotationMatrix=a.create$2(),a.rotate(this.rotationMatrix,this.rotationMatrix,this.angle))},Nr.pitch.get=function(){return this._pitch/Math.PI*180},Nr.pitch.set=function(n){var s=a.clamp(n,this.minPitch,this.maxPitch)/180*Math.PI;this._pitch!==s&&(this._unmodified=!1,this._pitch=s,this._calcMatrices())},Nr.fov.get=function(){return this._fov/Math.PI*180},Nr.fov.set=function(n){n=Math.max(.01,Math.min(60,n)),this._fov!==n&&(this._unmodified=!1,this._fov=n/180*Math.PI,this._calcMatrices())},Nr.zoom.get=function(){return this._zoom},Nr.zoom.set=function(n){var s=Math.min(Math.max(n,this.minZoom),this.maxZoom);this._zoom!==s&&(this._unmodified=!1,this._zoom=s,this.scale=this.zoomScale(s),this.tileZoom=Math.floor(s),this.zoomFraction=s-this.tileZoom,this._constrain(),this._calcMatrices())},Nr.center.get=function(){return this._center},Nr.center.set=function(n){n.lat===this._center.lat&&n.lng===this._center.lng||(this._unmodified=!1,this._center=n,this._constrain(),this._calcMatrices())},Nr.padding.get=function(){return this._edgeInsets.toJSON()},Nr.padding.set=function(n){this._edgeInsets.equals(n)||(this._unmodified=!1,this._edgeInsets.interpolate(this._edgeInsets,n,1),this._calcMatrices())},Nr.centerPoint.get=function(){return this._edgeInsets.getCenter(this.width,this.height)},fr.prototype.isPaddingEqual=function(n){return this._edgeInsets.equals(n)},fr.prototype.interpolatePadding=function(n,s,o){this._unmodified=!1,this._edgeInsets.interpolate(n,s,o),this._constrain(),this._calcMatrices()},fr.prototype.coveringZoomLevel=function(n){var s=(n.roundZoom?Math.round:Math.floor)(this.zoom+this.scaleZoom(this.tileSize/n.tileSize));return Math.max(0,s)},fr.prototype.getVisibleUnwrappedCoordinates=function(n){var s=[new a.UnwrappedTileID(0,n)];if(this._renderWorldCopies)for(var o=this.pointCoordinate(new a.Point(0,0)),c=this.pointCoordinate(new a.Point(this.width,0)),_=this.pointCoordinate(new a.Point(this.width,this.height)),w=this.pointCoordinate(new a.Point(0,this.height)),S=Math.floor(Math.min(o.x,c.x,_.x,w.x)),P=Math.floor(Math.max(o.x,c.x,_.x,w.x)),C=S-1;C<=P+1;C++)C!==0&&s.push(new a.UnwrappedTileID(C,n));return s},fr.prototype.coveringTiles=function(n){var s=this.coveringZoomLevel(n),o=s;if(n.minzoom!==void 0&&s<n.minzoom)return[];n.maxzoom!==void 0&&s>n.maxzoom&&(s=n.maxzoom);var c=a.MercatorCoordinate.fromLngLat(this.center),_=Math.pow(2,s),w=[_*c.x,_*c.y,0],S=Xs.fromInvProjectionMatrix(this.invProjMatrix,this.worldSize,s),P=n.minzoom||0;this.pitch<=60&&this._edgeInsets.top<.1&&(P=s);var C=function(Xe){return{aabb:new So([Xe*_,0,0],[(Xe+1)*_,_,0]),zoom:0,x:0,y:0,wrap:Xe,fullyVisible:!1}},O=[],Z=[],K=s,H=n.reparseOverscaled?o:s;if(this._renderWorldCopies)for(var re=1;re<=3;re++)O.push(C(-re)),O.push(C(re));for(O.push(C(0));O.length>0;){var te=O.pop(),ce=te.x,Y=te.y,se=te.fullyVisible;if(!se){var fe=te.aabb.intersects(S);if(fe===0)continue;se=fe===2}var ve=te.aabb.distanceX(w),Ie=te.aabb.distanceY(w),ke=Math.max(Math.abs(ve),Math.abs(Ie));if(te.zoom===K||ke>3+(1<<K-te.zoom)-2&&te.zoom>=P)Z.push({tileID:new a.OverscaledTileID(te.zoom===K?H:te.zoom,te.wrap,te.zoom,ce,Y),distanceSq:a.sqrLen([w[0]-.5-ce,w[1]-.5-Y])});else for(var Pe=0;Pe<4;Pe++){var Ne=(ce<<1)+Pe%2,Je=(Y<<1)+(Pe>>1);O.push({aabb:te.aabb.quadrant(Pe),zoom:te.zoom+1,x:Ne,y:Je,wrap:te.wrap,fullyVisible:se})}}return Z.sort(function(Xe,ct){return Xe.distanceSq-ct.distanceSq}).map(function(Xe){return Xe.tileID})},fr.prototype.resize=function(n,s){this.width=n,this.height=s,this.pixelsToGLUnits=[2/n,-2/s],this._constrain(),this._calcMatrices()},Nr.unmodified.get=function(){return this._unmodified},fr.prototype.zoomScale=function(n){return Math.pow(2,n)},fr.prototype.scaleZoom=function(n){return Math.log(n)/Math.LN2},fr.prototype.project=function(n){var s=a.clamp(n.lat,-this.maxValidLatitude,this.maxValidLatitude);return new a.Point(a.mercatorXfromLng(n.lng)*this.worldSize,a.mercatorYfromLat(s)*this.worldSize)},fr.prototype.unproject=function(n){return new a.MercatorCoordinate(n.x/this.worldSize,n.y/this.worldSize).toLngLat()},Nr.point.get=function(){return this.project(this.center)},fr.prototype.setLocationAtPoint=function(n,s){var o=this.pointCoordinate(s),c=this.pointCoordinate(this.centerPoint),_=this.locationCoordinate(n),w=new a.MercatorCoordinate(_.x-(o.x-c.x),_.y-(o.y-c.y));this.center=this.coordinateLocation(w),this._renderWorldCopies&&(this.center=this.center.wrap())},fr.prototype.locationPoint=function(n){return this.coordinatePoint(this.locationCoordinate(n))},fr.prototype.pointLocation=function(n){return this.coordinateLocation(this.pointCoordinate(n))},fr.prototype.locationCoordinate=function(n){return a.MercatorCoordinate.fromLngLat(n)},fr.prototype.coordinateLocation=function(n){return n.toLngLat()},fr.prototype.pointCoordinate=function(n){var s=[n.x,n.y,0,1],o=[n.x,n.y,1,1];a.transformMat4(s,s,this.pixelMatrixInverse),a.transformMat4(o,o,this.pixelMatrixInverse);var c=s[3],_=o[3],w=s[1]/c,S=o[1]/_,P=s[2]/c,C=o[2]/_,O=P===C?0:(0-P)/(C-P);return new a.MercatorCoordinate(a.number(s[0]/c,o[0]/_,O)/this.worldSize,a.number(w,S,O)/this.worldSize)},fr.prototype.coordinatePoint=function(n){var s=[n.x*this.worldSize,n.y*this.worldSize,0,1];return a.transformMat4(s,s,this.pixelMatrix),new a.Point(s[0]/s[3],s[1]/s[3])},fr.prototype.getBounds=function(){return new a.LngLatBounds().extend(this.pointLocation(new a.Point(0,0))).extend(this.pointLocation(new a.Point(this.width,0))).extend(this.pointLocation(new a.Point(this.width,this.height))).extend(this.pointLocation(new a.Point(0,this.height)))},fr.prototype.getMaxBounds=function(){return this.latRange&&this.latRange.length===2&&this.lngRange&&this.lngRange.length===2?new a.LngLatBounds([this.lngRange[0],this.latRange[0]],[this.lngRange[1],this.latRange[1]]):null},fr.prototype.setMaxBounds=function(n){n?(this.lngRange=[n.getWest(),n.getEast()],this.latRange=[n.getSouth(),n.getNorth()],this._constrain()):(this.lngRange=null,this.latRange=[-this.maxValidLatitude,this.maxValidLatitude])},fr.prototype.calculatePosMatrix=function(n,s){s===void 0&&(s=!1);var o=n.key,c=s?this._alignedPosMatrixCache:this._posMatrixCache;if(c[o])return c[o];var _=n.canonical,w=this.worldSize/this.zoomScale(_.z),S=_.x+Math.pow(2,_.z)*n.wrap,P=a.identity(new Float64Array(16));return a.translate(P,P,[S*w,_.y*w,0]),a.scale(P,P,[w/a.EXTENT,w/a.EXTENT,1]),a.multiply(P,s?this.alignedProjMatrix:this.projMatrix,P),c[o]=new Float32Array(P),c[o]},fr.prototype.customLayerMatrix=function(){return this.mercatorMatrix.slice()},fr.prototype._constrain=function(){if(this.center&&this.width&&this.height&&!this._constraining){this._constraining=!0;var n,s,o,c,_=-90,w=90,S=-180,P=180,C=this.size,O=this._unmodified;if(this.latRange){var Z=this.latRange;_=a.mercatorYfromLat(Z[1])*this.worldSize,n=(w=a.mercatorYfromLat(Z[0])*this.worldSize)-_<C.y?C.y/(w-_):0}if(this.lngRange){var K=this.lngRange;S=a.mercatorXfromLng(K[0])*this.worldSize,s=(P=a.mercatorXfromLng(K[1])*this.worldSize)-S<C.x?C.x/(P-S):0}var H=this.point,re=Math.max(s||0,n||0);if(re)return this.center=this.unproject(new a.Point(s?(P+S)/2:H.x,n?(w+_)/2:H.y)),this.zoom+=this.scaleZoom(re),this._unmodified=O,void(this._constraining=!1);if(this.latRange){var te=H.y,ce=C.y/2;te-ce<_&&(c=_+ce),te+ce>w&&(c=w-ce)}if(this.lngRange){var Y=H.x,se=C.x/2;Y-se<S&&(o=S+se),Y+se>P&&(o=P-se)}o===void 0&&c===void 0||(this.center=this.unproject(new a.Point(o!==void 0?o:H.x,c!==void 0?c:H.y))),this._unmodified=O,this._constraining=!1}},fr.prototype._calcMatrices=function(){if(this.height){var n=this.centerOffset;this.cameraToCenterDistance=.5/Math.tan(this._fov/2)*this.height;var s=Math.PI/2+this._pitch,o=this._fov*(.5+n.y/this.height),c=Math.sin(o)*this.cameraToCenterDistance/Math.sin(a.clamp(Math.PI-s-o,.01,Math.PI-.01)),_=this.point,w=_.x,S=_.y,P=1.01*(Math.cos(Math.PI/2-this._pitch)*c+this.cameraToCenterDistance),C=this.height/50,O=new Float64Array(16);a.perspective(O,this._fov,this.width/this.height,C,P),O[8]=2*-n.x/this.width,O[9]=2*n.y/this.height,a.scale(O,O,[1,-1,1]),a.translate(O,O,[0,0,-this.cameraToCenterDistance]),a.rotateX(O,O,this._pitch),a.rotateZ(O,O,this.angle),a.translate(O,O,[-w,-S,0]),this.mercatorMatrix=a.scale([],O,[this.worldSize,this.worldSize,this.worldSize]),a.scale(O,O,[1,1,a.mercatorZfromAltitude(1,this.center.lat)*this.worldSize,1]),this.projMatrix=O,this.invProjMatrix=a.invert([],this.projMatrix);var Z=this.width%2/2,K=this.height%2/2,H=Math.cos(this.angle),re=Math.sin(this.angle),te=w-Math.round(w)+H*Z+re*K,ce=S-Math.round(S)+H*K+re*Z,Y=new Float64Array(O);if(a.translate(Y,Y,[te>.5?te-1:te,ce>.5?ce-1:ce,0]),this.alignedProjMatrix=Y,O=a.create(),a.scale(O,O,[this.width/2,-this.height/2,1]),a.translate(O,O,[1,-1,0]),this.labelPlaneMatrix=O,O=a.create(),a.scale(O,O,[1,-1,1]),a.translate(O,O,[-1,-1,0]),a.scale(O,O,[2/this.width,2/this.height,1]),this.glCoordMatrix=O,this.pixelMatrix=a.multiply(new Float64Array(16),this.labelPlaneMatrix,this.projMatrix),!(O=a.invert(new Float64Array(16),this.pixelMatrix)))throw new Error("failed to invert matrix");this.pixelMatrixInverse=O,this._posMatrixCache={},this._alignedPosMatrixCache={}}},fr.prototype.maxPitchScaleFactor=function(){if(!this.pixelMatrixInverse)return 1;var n=this.pointCoordinate(new a.Point(0,0)),s=[n.x*this.worldSize,n.y*this.worldSize,0,1];return a.transformMat4(s,s,this.pixelMatrix)[3]/this.cameraToCenterDistance},fr.prototype.getCameraPoint=function(){var n=Math.tan(this._pitch)*(this.cameraToCenterDistance||1);return this.centerPoint.add(new a.Point(0,n))},fr.prototype.getCameraQueryGeometry=function(n){var s=this.getCameraPoint();if(n.length===1)return[n[0],s];for(var o=s.x,c=s.y,_=s.x,w=s.y,S=0,P=n;S<P.length;S+=1){var C=P[S];o=Math.min(o,C.x),c=Math.min(c,C.y),_=Math.max(_,C.x),w=Math.max(w,C.y)}return[new a.Point(o,c),new a.Point(_,c),new a.Point(_,w),new a.Point(o,w),new a.Point(o,c)]},Object.defineProperties(fr.prototype,Nr);var $n=function(n){var s,o,c,_;this._hashName=n&&encodeURIComponent(n),a.bindAll(["_getCurrentHash","_onHashChange","_updateHash"],this),this._updateHash=(s=this._updateHashUnthrottled.bind(this),o=!1,c=null,_=function(){c=null,o&&(s(),c=setTimeout(_,300),o=!1)},function(){return o=!0,c||_(),c})};$n.prototype.addTo=function(n){return this._map=n,a.window.addEventListener("hashchange",this._onHashChange,!1),this._map.on("moveend",this._updateHash),this},$n.prototype.remove=function(){return a.window.removeEventListener("hashchange",this._onHashChange,!1),this._map.off("moveend",this._updateHash),clearTimeout(this._updateHash()),delete this._map,this},$n.prototype.getHashString=function(n){var s=this._map.getCenter(),o=Math.round(100*this._map.getZoom())/100,c=Math.ceil((o*Math.LN2+Math.log(512/360/.5))/Math.LN10),_=Math.pow(10,c),w=Math.round(s.lng*_)/_,S=Math.round(s.lat*_)/_,P=this._map.getBearing(),C=this._map.getPitch(),O="";if(O+=n?"/"+w+"/"+S+"/"+o:o+"/"+S+"/"+w,(P||C)&&(O+="/"+Math.round(10*P)/10),C&&(O+="/"+Math.round(C)),this._hashName){var Z=this._hashName,K=!1,H=a.window.location.hash.slice(1).split("&").map(function(re){var te=re.split("=")[0];return te===Z?(K=!0,te+"="+O):re}).filter(function(re){return re});return K||H.push(Z+"="+O),"#"+H.join("&")}return"#"+O},$n.prototype._getCurrentHash=function(){var n,s=this,o=a.window.location.hash.replace("#","");return this._hashName?(o.split("&").map(function(c){return c.split("=")}).forEach(function(c){c[0]===s._hashName&&(n=c)}),(n&&n[1]||"").split("/")):o.split("/")},$n.prototype._onHashChange=function(){var n=this._getCurrentHash();if(n.length>=3&&!n.some(function(o){return isNaN(o)})){var s=this._map.dragRotate.isEnabled()&&this._map.touchZoomRotate.isEnabled()?+(n[3]||0):this._map.getBearing();return this._map.jumpTo({center:[+n[2],+n[1]],zoom:+n[0],bearing:s,pitch:+(n[4]||0)}),!0}return!1},$n.prototype._updateHashUnthrottled=function(){var n=a.window.location.href.replace(/(#.+)?$/,this.getHashString());try{a.window.history.replaceState(a.window.history.state,null,n)}catch{}};var ds={linearity:.3,easing:a.bezier(0,0,.3,1)},qo=a.extend({deceleration:2500,maxSpeed:1400},ds),ms=a.extend({deceleration:20,maxSpeed:1400},ds),Vh=a.extend({deceleration:1e3,maxSpeed:360},ds),qh=a.extend({deceleration:1e3,maxSpeed:90},ds),ys=function(n){this._map=n,this.clear()};function gs(n,s){(!n.duration||n.duration<s.duration)&&(n.duration=s.duration,n.easing=s.easing)}function Ca(n,s,o){var c=o.maxSpeed,_=o.linearity,w=o.deceleration,S=a.clamp(n*_/(s/1e3),-c,c),P=Math.abs(S)/(w*_);return{easing:o.easing,duration:1e3*P,amount:S*(P/2)}}ys.prototype.clear=function(){this._inertiaBuffer=[]},ys.prototype.record=function(n){this._drainInertiaBuffer(),this._inertiaBuffer.push({time:a.browser.now(),settings:n})},ys.prototype._drainInertiaBuffer=function(){for(var n=this._inertiaBuffer,s=a.browser.now();n.length>0&&s-n[0].time>160;)n.shift()},ys.prototype._onMoveEnd=function(n){if(this._drainInertiaBuffer(),!(this._inertiaBuffer.length<2)){for(var s={zoom:0,bearing:0,pitch:0,pan:new a.Point(0,0),pinchAround:void 0,around:void 0},o=0,c=this._inertiaBuffer;o<c.length;o+=1){var _=c[o].settings;s.zoom+=_.zoomDelta||0,s.bearing+=_.bearingDelta||0,s.pitch+=_.pitchDelta||0,_.panDelta&&s.pan._add(_.panDelta),_.around&&(s.around=_.around),_.pinchAround&&(s.pinchAround=_.pinchAround)}var w=this._inertiaBuffer[this._inertiaBuffer.length-1].time-this._inertiaBuffer[0].time,S={};if(s.pan.mag()){var P=Ca(s.pan.mag(),w,a.extend({},qo,n||{}));S.offset=s.pan.mult(P.amount/s.pan.mag()),S.center=this._map.transform.center,gs(S,P)}if(s.zoom){var C=Ca(s.zoom,w,ms);S.zoom=this._map.transform.zoom+C.amount,gs(S,C)}if(s.bearing){var O=Ca(s.bearing,w,Vh);S.bearing=this._map.transform.bearing+a.clamp(O.amount,-179,179),gs(S,O)}if(s.pitch){var Z=Ca(s.pitch,w,qh);S.pitch=this._map.transform.pitch+Z.amount,gs(S,Z)}if(S.zoom||S.bearing){var K=s.pinchAround===void 0?s.around:s.pinchAround;S.around=K?this._map.unproject(K):this._map.getCenter()}return this.clear(),a.extend(S,{noMoveStart:!0})}};var Pi=function(n){function s(c,_,w,S){S===void 0&&(S={});var P=T.mousePos(_.getCanvasContainer(),w),C=_.unproject(P);n.call(this,c,a.extend({point:P,lngLat:C,originalEvent:w},S)),this._defaultPrevented=!1,this.target=_}n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s;var o={defaultPrevented:{configurable:!0}};return s.prototype.preventDefault=function(){this._defaultPrevented=!0},o.defaultPrevented.get=function(){return this._defaultPrevented},Object.defineProperties(s.prototype,o),s}(a.Event),_s=function(n){function s(c,_,w){var S=c==="touchend"?w.changedTouches:w.touches,P=T.touchPos(_.getCanvasContainer(),S),C=P.map(function(K){return _.unproject(K)}),O=P.reduce(function(K,H,re,te){return K.add(H.div(te.length))},new a.Point(0,0)),Z=_.unproject(O);n.call(this,c,{points:P,point:O,lngLats:C,lngLat:Z,originalEvent:w}),this._defaultPrevented=!1}n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s;var o={defaultPrevented:{configurable:!0}};return s.prototype.preventDefault=function(){this._defaultPrevented=!0},o.defaultPrevented.get=function(){return this._defaultPrevented},Object.defineProperties(s.prototype,o),s}(a.Event),Ec=function(n){function s(c,_,w){n.call(this,c,{originalEvent:w}),this._defaultPrevented=!1}n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s;var o={defaultPrevented:{configurable:!0}};return s.prototype.preventDefault=function(){this._defaultPrevented=!0},o.defaultPrevented.get=function(){return this._defaultPrevented},Object.defineProperties(s.prototype,o),s}(a.Event),bi=function(n,s){this._map=n,this._clickTolerance=s.clickTolerance};bi.prototype.reset=function(){delete this._mousedownPos},bi.prototype.wheel=function(n){return this._firePreventable(new Ec(n.type,this._map,n))},bi.prototype.mousedown=function(n,s){return this._mousedownPos=s,this._firePreventable(new Pi(n.type,this._map,n))},bi.prototype.mouseup=function(n){this._map.fire(new Pi(n.type,this._map,n))},bi.prototype.click=function(n,s){this._mousedownPos&&this._mousedownPos.dist(s)>=this._clickTolerance||this._map.fire(new Pi(n.type,this._map,n))},bi.prototype.dblclick=function(n){return this._firePreventable(new Pi(n.type,this._map,n))},bi.prototype.mouseover=function(n){this._map.fire(new Pi(n.type,this._map,n))},bi.prototype.mouseout=function(n){this._map.fire(new Pi(n.type,this._map,n))},bi.prototype.touchstart=function(n){return this._firePreventable(new _s(n.type,this._map,n))},bi.prototype.touchmove=function(n){this._map.fire(new _s(n.type,this._map,n))},bi.prototype.touchend=function(n){this._map.fire(new _s(n.type,this._map,n))},bi.prototype.touchcancel=function(n){this._map.fire(new _s(n.type,this._map,n))},bi.prototype._firePreventable=function(n){if(this._map.fire(n),n.defaultPrevented)return{}},bi.prototype.isEnabled=function(){return!0},bi.prototype.isActive=function(){return!1},bi.prototype.enable=function(){},bi.prototype.disable=function(){};var pt=function(n){this._map=n};pt.prototype.reset=function(){this._delayContextMenu=!1,delete this._contextMenuEvent},pt.prototype.mousemove=function(n){this._map.fire(new Pi(n.type,this._map,n))},pt.prototype.mousedown=function(){this._delayContextMenu=!0},pt.prototype.mouseup=function(){this._delayContextMenu=!1,this._contextMenuEvent&&(this._map.fire(new Pi("contextmenu",this._map,this._contextMenuEvent)),delete this._contextMenuEvent)},pt.prototype.contextmenu=function(n){this._delayContextMenu?this._contextMenuEvent=n:this._map.fire(new Pi(n.type,this._map,n)),this._map.listens("contextmenu")&&n.preventDefault()},pt.prototype.isEnabled=function(){return!0},pt.prototype.isActive=function(){return!1},pt.prototype.enable=function(){},pt.prototype.disable=function(){};var qn=function(n,s){this._map=n,this._el=n.getCanvasContainer(),this._container=n.getContainer(),this._clickTolerance=s.clickTolerance||1};function Ws(n,s){for(var o={},c=0;c<n.length;c++)o[n[c].identifier]=s[c];return o}qn.prototype.isEnabled=function(){return!!this._enabled},qn.prototype.isActive=function(){return!!this._active},qn.prototype.enable=function(){this.isEnabled()||(this._enabled=!0)},qn.prototype.disable=function(){this.isEnabled()&&(this._enabled=!1)},qn.prototype.mousedown=function(n,s){this.isEnabled()&&n.shiftKey&&n.button===0&&(T.disableDrag(),this._startPos=this._lastPos=s,this._active=!0)},qn.prototype.mousemoveWindow=function(n,s){if(this._active){var o=s;if(!(this._lastPos.equals(o)||!this._box&&o.dist(this._startPos)<this._clickTolerance)){var c=this._startPos;this._lastPos=o,this._box||(this._box=T.create("div","mapboxgl-boxzoom",this._container),this._container.classList.add("mapboxgl-crosshair"),this._fireEvent("boxzoomstart",n));var _=Math.min(c.x,o.x),w=Math.max(c.x,o.x),S=Math.min(c.y,o.y),P=Math.max(c.y,o.y);T.setTransform(this._box,"translate("+_+"px,"+S+"px)"),this._box.style.width=w-_+"px",this._box.style.height=P-S+"px"}}},qn.prototype.mouseupWindow=function(n,s){var o=this;if(this._active&&n.button===0){var c=this._startPos,_=s;if(this.reset(),T.suppressClick(),c.x!==_.x||c.y!==_.y)return this._map.fire(new a.Event("boxzoomend",{originalEvent:n})),{cameraAnimation:function(w){return w.fitScreenCoordinates(c,_,o._map.getBearing(),{linear:!0})}};this._fireEvent("boxzoomcancel",n)}},qn.prototype.keydown=function(n){this._active&&n.keyCode===27&&(this.reset(),this._fireEvent("boxzoomcancel",n))},qn.prototype.blur=function(){this.reset()},qn.prototype.reset=function(){this._active=!1,this._container.classList.remove("mapboxgl-crosshair"),this._box&&(T.remove(this._box),this._box=null),T.enableDrag(),delete this._startPos,delete this._lastPos},qn.prototype._fireEvent=function(n,s){return this._map.fire(new a.Event(n,{originalEvent:s}))};var jo=function(n){this.reset(),this.numTouches=n.numTouches};jo.prototype.reset=function(){delete this.centroid,delete this.startTime,delete this.touches,this.aborted=!1},jo.prototype.touchstart=function(n,s,o){(this.centroid||o.length>this.numTouches)&&(this.aborted=!0),this.aborted||(this.startTime===void 0&&(this.startTime=n.timeStamp),o.length===this.numTouches&&(this.centroid=function(c){for(var _=new a.Point(0,0),w=0,S=c;w<S.length;w+=1)_._add(S[w]);return _.div(c.length)}(s),this.touches=Ws(o,s)))},jo.prototype.touchmove=function(n,s,o){if(!this.aborted&&this.centroid){var c=Ws(o,s);for(var _ in this.touches){var w=c[_];(!w||w.dist(this.touches[_])>30)&&(this.aborted=!0)}}},jo.prototype.touchend=function(n,s,o){if((!this.centroid||n.timeStamp-this.startTime>500)&&(this.aborted=!0),o.length===0){var c=!this.aborted&&this.centroid;if(this.reset(),c)return c}};var da=function(n){this.singleTap=new jo(n),this.numTaps=n.numTaps,this.reset()};da.prototype.reset=function(){this.lastTime=1/0,delete this.lastTap,this.count=0,this.singleTap.reset()},da.prototype.touchstart=function(n,s,o){this.singleTap.touchstart(n,s,o)},da.prototype.touchmove=function(n,s,o){this.singleTap.touchmove(n,s,o)},da.prototype.touchend=function(n,s,o){var c=this.singleTap.touchend(n,s,o);if(c){var _=n.timeStamp-this.lastTime<500,w=!this.lastTap||this.lastTap.dist(c)<30;if(_&&w||this.reset(),this.count++,this.lastTime=n.timeStamp,this.lastTap=c,this.count===this.numTaps)return this.reset(),c}};var jn=function(){this._zoomIn=new da({numTouches:1,numTaps:2}),this._zoomOut=new da({numTouches:2,numTaps:1}),this.reset()};jn.prototype.reset=function(){this._active=!1,this._zoomIn.reset(),this._zoomOut.reset()},jn.prototype.touchstart=function(n,s,o){this._zoomIn.touchstart(n,s,o),this._zoomOut.touchstart(n,s,o)},jn.prototype.touchmove=function(n,s,o){this._zoomIn.touchmove(n,s,o),this._zoomOut.touchmove(n,s,o)},jn.prototype.touchend=function(n,s,o){var c=this,_=this._zoomIn.touchend(n,s,o),w=this._zoomOut.touchend(n,s,o);return _?(this._active=!0,n.preventDefault(),setTimeout(function(){return c.reset()},0),{cameraAnimation:function(S){return S.easeTo({duration:300,zoom:S.getZoom()+1,around:S.unproject(_)},{originalEvent:n})}}):w?(this._active=!0,n.preventDefault(),setTimeout(function(){return c.reset()},0),{cameraAnimation:function(S){return S.easeTo({duration:300,zoom:S.getZoom()-1,around:S.unproject(w)},{originalEvent:n})}}):void 0},jn.prototype.touchcancel=function(){this.reset()},jn.prototype.enable=function(){this._enabled=!0},jn.prototype.disable=function(){this._enabled=!1,this.reset()},jn.prototype.isEnabled=function(){return this._enabled},jn.prototype.isActive=function(){return this._active};var Ql={0:1,2:2},nt=function(n){this.reset(),this._clickTolerance=n.clickTolerance||1};nt.prototype.blur=function(){this.reset()},nt.prototype.reset=function(){this._active=!1,this._moved=!1,delete this._lastPoint,delete this._eventButton},nt.prototype._correctButton=function(n,s){return!1},nt.prototype._move=function(n,s){return{}},nt.prototype.mousedown=function(n,s){if(!this._lastPoint){var o=T.mouseButton(n);this._correctButton(n,o)&&(this._lastPoint=s,this._eventButton=o)}},nt.prototype.mousemoveWindow=function(n,s){var o=this._lastPoint;if(o){if(n.preventDefault(),function(c,_){var w=Ql[_];return c.buttons===void 0||(c.buttons&w)!==w}(n,this._eventButton))this.reset();else if(this._moved||!(s.dist(o)<this._clickTolerance))return this._moved=!0,this._lastPoint=s,this._move(o,s)}},nt.prototype.mouseupWindow=function(n){this._lastPoint&&T.mouseButton(n)===this._eventButton&&(this._moved&&T.suppressClick(),this.reset())},nt.prototype.enable=function(){this._enabled=!0},nt.prototype.disable=function(){this._enabled=!1,this.reset()},nt.prototype.isEnabled=function(){return this._enabled},nt.prototype.isActive=function(){return this._active};var $l=function(n){function s(){n.apply(this,arguments)}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype.mousedown=function(o,c){n.prototype.mousedown.call(this,o,c),this._lastPoint&&(this._active=!0)},s.prototype._correctButton=function(o,c){return c===0&&!o.ctrlKey},s.prototype._move=function(o,c){return{around:c,panDelta:c.sub(o)}},s}(nt),Ys=function(n){function s(){n.apply(this,arguments)}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype._correctButton=function(o,c){return c===0&&o.ctrlKey||c===2},s.prototype._move=function(o,c){var _=.8*(c.x-o.x);if(_)return this._active=!0,{bearingDelta:_}},s.prototype.contextmenu=function(o){o.preventDefault()},s}(nt),eu=function(n){function s(){n.apply(this,arguments)}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype._correctButton=function(o,c){return c===0&&o.ctrlKey||c===2},s.prototype._move=function(o,c){var _=-.5*(c.y-o.y);if(_)return this._active=!0,{pitchDelta:_}},s.prototype.contextmenu=function(o){o.preventDefault()},s}(nt),na=function(n){this._minTouches=1,this._clickTolerance=n.clickTolerance||1,this.reset()};na.prototype.reset=function(){this._active=!1,this._touches={},this._sum=new a.Point(0,0)},na.prototype.touchstart=function(n,s,o){return this._calculateTransform(n,s,o)},na.prototype.touchmove=function(n,s,o){if(this._active&&!(o.length<this._minTouches))return n.preventDefault(),this._calculateTransform(n,s,o)},na.prototype.touchend=function(n,s,o){this._calculateTransform(n,s,o),this._active&&o.length<this._minTouches&&this.reset()},na.prototype.touchcancel=function(){this.reset()},na.prototype._calculateTransform=function(n,s,o){o.length>0&&(this._active=!0);var c=Ws(o,s),_=new a.Point(0,0),w=new a.Point(0,0),S=0;for(var P in c){var C=c[P],O=this._touches[P];O&&(_._add(C),w._add(C.sub(O)),S++,c[P]=C)}if(this._touches=c,!(S<this._minTouches)&&w.mag()){var Z=w.div(S);if(this._sum._add(Z),!(this._sum.mag()<this._clickTolerance))return{around:_.div(S),panDelta:Z}}},na.prototype.enable=function(){this._enabled=!0},na.prototype.disable=function(){this._enabled=!1,this.reset()},na.prototype.isEnabled=function(){return this._enabled},na.prototype.isActive=function(){return this._active};var Gn=function(){this.reset()};function Js(n,s,o){for(var c=0;c<n.length;c++)if(n[c].identifier===o)return s[c]}function Qs(n,s){return Math.log(n/s)/Math.LN2}Gn.prototype.reset=function(){this._active=!1,delete this._firstTwoTouches},Gn.prototype._start=function(n){},Gn.prototype._move=function(n,s,o){return{}},Gn.prototype.touchstart=function(n,s,o){this._firstTwoTouches||o.length<2||(this._firstTwoTouches=[o[0].identifier,o[1].identifier],this._start([s[0],s[1]]))},Gn.prototype.touchmove=function(n,s,o){if(this._firstTwoTouches){n.preventDefault();var c=this._firstTwoTouches,_=c[1],w=Js(o,s,c[0]),S=Js(o,s,_);if(w&&S){var P=this._aroundCenter?null:w.add(S).div(2);return this._move([w,S],P,n)}}},Gn.prototype.touchend=function(n,s,o){if(this._firstTwoTouches){var c=this._firstTwoTouches,_=c[1],w=Js(o,s,c[0]),S=Js(o,s,_);w&&S||(this._active&&T.suppressClick(),this.reset())}},Gn.prototype.touchcancel=function(){this.reset()},Gn.prototype.enable=function(n){this._enabled=!0,this._aroundCenter=!!n&&n.around==="center"},Gn.prototype.disable=function(){this._enabled=!1,this.reset()},Gn.prototype.isEnabled=function(){return this._enabled},Gn.prototype.isActive=function(){return this._active};var Zn=function(n){function s(){n.apply(this,arguments)}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype.reset=function(){n.prototype.reset.call(this),delete this._distance,delete this._startDistance},s.prototype._start=function(o){this._startDistance=this._distance=o[0].dist(o[1])},s.prototype._move=function(o,c){var _=this._distance;if(this._distance=o[0].dist(o[1]),this._active||!(Math.abs(Qs(this._distance,this._startDistance))<.1))return this._active=!0,{zoomDelta:Qs(this._distance,_),pinchAround:c}},s}(Gn);function Ma(n,s){return 180*n.angleWith(s)/Math.PI}var kc=function(n){function s(){n.apply(this,arguments)}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype.reset=function(){n.prototype.reset.call(this),delete this._minDiameter,delete this._startVector,delete this._vector},s.prototype._start=function(o){this._startVector=this._vector=o[0].sub(o[1]),this._minDiameter=o[0].dist(o[1])},s.prototype._move=function(o,c){var _=this._vector;if(this._vector=o[0].sub(o[1]),this._active||!this._isBelowThreshold(this._vector))return this._active=!0,{bearingDelta:Ma(this._vector,_),pinchAround:c}},s.prototype._isBelowThreshold=function(o){this._minDiameter=Math.min(this._minDiameter,o.mag());var c=25/(Math.PI*this._minDiameter)*360,_=Ma(o,this._startVector);return Math.abs(_)<c},s}(Gn);function vs(n){return Math.abs(n.y)>Math.abs(n.x)}var tu=function(n){function s(){n.apply(this,arguments)}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype.reset=function(){n.prototype.reset.call(this),this._valid=void 0,delete this._firstMove,delete this._lastPoints},s.prototype._start=function(o){this._lastPoints=o,vs(o[0].sub(o[1]))&&(this._valid=!1)},s.prototype._move=function(o,c,_){var w=o[0].sub(this._lastPoints[0]),S=o[1].sub(this._lastPoints[1]);if(this._valid=this.gestureBeginsVertically(w,S,_.timeStamp),this._valid)return this._lastPoints=o,this._active=!0,{pitchDelta:(w.y+S.y)/2*-.5}},s.prototype.gestureBeginsVertically=function(o,c,_){if(this._valid!==void 0)return this._valid;var w=o.mag()>=2,S=c.mag()>=2;if(w||S){if(!w||!S)return this._firstMove===void 0&&(this._firstMove=_),_-this._firstMove<100&&void 0;var P=o.y>0==c.y>0;return vs(o)&&vs(c)&&P}},s}(Gn),ru={panStep:100,bearingStep:15,pitchStep:10},ma=function(){var n=ru;this._panStep=n.panStep,this._bearingStep=n.bearingStep,this._pitchStep=n.pitchStep,this._rotationDisabled=!1};function ea(n){return n*(2-n)}ma.prototype.blur=function(){this.reset()},ma.prototype.reset=function(){this._active=!1},ma.prototype.keydown=function(n){var s=this;if(!(n.altKey||n.ctrlKey||n.metaKey)){var o=0,c=0,_=0,w=0,S=0;switch(n.keyCode){case 61:case 107:case 171:case 187:o=1;break;case 189:case 109:case 173:o=-1;break;case 37:n.shiftKey?c=-1:(n.preventDefault(),w=-1);break;case 39:n.shiftKey?c=1:(n.preventDefault(),w=1);break;case 38:n.shiftKey?_=1:(n.preventDefault(),S=-1);break;case 40:n.shiftKey?_=-1:(n.preventDefault(),S=1);break;default:return}return this._rotationDisabled&&(c=0,_=0),{cameraAnimation:function(P){var C=P.getZoom();P.easeTo({duration:300,easeId:"keyboardHandler",easing:ea,zoom:o?Math.round(C)+o*(n.shiftKey?2:1):C,bearing:P.getBearing()+c*s._bearingStep,pitch:P.getPitch()+_*s._pitchStep,offset:[-w*s._panStep,-S*s._panStep],center:P.getCenter()},{originalEvent:n})}}}},ma.prototype.enable=function(){this._enabled=!0},ma.prototype.disable=function(){this._enabled=!1,this.reset()},ma.prototype.isEnabled=function(){return this._enabled},ma.prototype.isActive=function(){return this._active},ma.prototype.disableRotation=function(){this._rotationDisabled=!0},ma.prototype.enableRotation=function(){this._rotationDisabled=!1};var rr=function(n,s){this._map=n,this._el=n.getCanvasContainer(),this._handler=s,this._delta=0,this._defaultZoomRate=.01,this._wheelZoomRate=1/450,a.bindAll(["_onTimeout"],this)};rr.prototype.setZoomRate=function(n){this._defaultZoomRate=n},rr.prototype.setWheelZoomRate=function(n){this._wheelZoomRate=n},rr.prototype.isEnabled=function(){return!!this._enabled},rr.prototype.isActive=function(){return!!this._active||this._finishTimeout!==void 0},rr.prototype.isZooming=function(){return!!this._zooming},rr.prototype.enable=function(n){this.isEnabled()||(this._enabled=!0,this._aroundCenter=n&&n.around==="center")},rr.prototype.disable=function(){this.isEnabled()&&(this._enabled=!1)},rr.prototype.wheel=function(n){if(this.isEnabled()){var s=n.deltaMode===a.window.WheelEvent.DOM_DELTA_LINE?40*n.deltaY:n.deltaY,o=a.browser.now(),c=o-(this._lastWheelEventTime||0);this._lastWheelEventTime=o,s!==0&&s%4.000244140625==0?this._type="wheel":s!==0&&Math.abs(s)<4?this._type="trackpad":c>400?(this._type=null,this._lastValue=s,this._timeout=setTimeout(this._onTimeout,40,n)):this._type||(this._type=Math.abs(c*s)<200?"trackpad":"wheel",this._timeout&&(clearTimeout(this._timeout),this._timeout=null,s+=this._lastValue)),n.shiftKey&&s&&(s/=4),this._type&&(this._lastWheelEvent=n,this._delta-=s,this._active||this._start(n)),n.preventDefault()}},rr.prototype._onTimeout=function(n){this._type="wheel",this._delta-=this._lastValue,this._active||this._start(n)},rr.prototype._start=function(n){if(this._delta){this._frameId&&(this._frameId=null),this._active=!0,this.isZooming()||(this._zooming=!0),this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout);var s=T.mousePos(this._el,n);this._around=a.LngLat.convert(this._aroundCenter?this._map.getCenter():this._map.unproject(s)),this._aroundPoint=this._map.transform.locationPoint(this._around),this._frameId||(this._frameId=!0,this._handler._triggerRenderFrame())}},rr.prototype.renderFrame=function(){var n=this;if(this._frameId&&(this._frameId=null,this.isActive())){var s=this._map.transform;if(this._delta!==0){var o=this._type==="wheel"&&Math.abs(this._delta)>4.000244140625?this._wheelZoomRate:this._defaultZoomRate,c=2/(1+Math.exp(-Math.abs(this._delta*o)));this._delta<0&&c!==0&&(c=1/c);var _=typeof this._targetZoom=="number"?s.zoomScale(this._targetZoom):s.scale;this._targetZoom=Math.min(s.maxZoom,Math.max(s.minZoom,s.scaleZoom(_*c))),this._type==="wheel"&&(this._startZoom=s.zoom,this._easing=this._smoothOutEasing(200)),this._delta=0}var w,S=typeof this._targetZoom=="number"?this._targetZoom:s.zoom,P=this._startZoom,C=this._easing,O=!1;if(this._type==="wheel"&&P&&C){var Z=Math.min((a.browser.now()-this._lastWheelEventTime)/200,1),K=C(Z);w=a.number(P,S,K),Z<1?this._frameId||(this._frameId=!0):O=!0}else w=S,O=!0;return this._active=!0,O&&(this._active=!1,this._finishTimeout=setTimeout(function(){n._zooming=!1,n._handler._triggerRenderFrame(),delete n._targetZoom,delete n._finishTimeout},200)),{noInertia:!0,needsRenderFrame:!O,zoomDelta:w-s.zoom,around:this._aroundPoint,originalEvent:this._lastWheelEvent}}},rr.prototype._smoothOutEasing=function(n){var s=a.ease;if(this._prevEase){var o=this._prevEase,c=(a.browser.now()-o.start)/o.duration,_=o.easing(c+.01)-o.easing(c),w=.27/Math.sqrt(_*_+1e-4)*.01,S=Math.sqrt(.0729-w*w);s=a.bezier(w,S,.25,1)}return this._prevEase={start:a.browser.now(),duration:n,easing:s},s},rr.prototype.blur=function(){this.reset()},rr.prototype.reset=function(){this._active=!1};var ka=function(n,s){this._clickZoom=n,this._tapZoom=s};ka.prototype.enable=function(){this._clickZoom.enable(),this._tapZoom.enable()},ka.prototype.disable=function(){this._clickZoom.disable(),this._tapZoom.disable()},ka.prototype.isEnabled=function(){return this._clickZoom.isEnabled()&&this._tapZoom.isEnabled()},ka.prototype.isActive=function(){return this._clickZoom.isActive()||this._tapZoom.isActive()};var aa=function(){this.reset()};aa.prototype.reset=function(){this._active=!1},aa.prototype.blur=function(){this.reset()},aa.prototype.dblclick=function(n,s){return n.preventDefault(),{cameraAnimation:function(o){o.easeTo({duration:300,zoom:o.getZoom()+(n.shiftKey?-1:1),around:o.unproject(s)},{originalEvent:n})}}},aa.prototype.enable=function(){this._enabled=!0},aa.prototype.disable=function(){this._enabled=!1,this.reset()},aa.prototype.isEnabled=function(){return this._enabled},aa.prototype.isActive=function(){return this._active};var tn=function(){this._tap=new da({numTouches:1,numTaps:1}),this.reset()};tn.prototype.reset=function(){this._active=!1,delete this._swipePoint,delete this._swipeTouch,delete this._tapTime,this._tap.reset()},tn.prototype.touchstart=function(n,s,o){this._swipePoint||(this._tapTime&&n.timeStamp-this._tapTime>500&&this.reset(),this._tapTime?o.length>0&&(this._swipePoint=s[0],this._swipeTouch=o[0].identifier):this._tap.touchstart(n,s,o))},tn.prototype.touchmove=function(n,s,o){if(this._tapTime){if(this._swipePoint){if(o[0].identifier!==this._swipeTouch)return;var c=s[0],_=c.y-this._swipePoint.y;return this._swipePoint=c,n.preventDefault(),this._active=!0,{zoomDelta:_/128}}}else this._tap.touchmove(n,s,o)},tn.prototype.touchend=function(n,s,o){this._tapTime?this._swipePoint&&o.length===0&&this.reset():this._tap.touchend(n,s,o)&&(this._tapTime=n.timeStamp)},tn.prototype.touchcancel=function(){this.reset()},tn.prototype.enable=function(){this._enabled=!0},tn.prototype.disable=function(){this._enabled=!1,this.reset()},tn.prototype.isEnabled=function(){return this._enabled},tn.prototype.isActive=function(){return this._active};var Eo=function(n,s,o){this._el=n,this._mousePan=s,this._touchPan=o};Eo.prototype.enable=function(n){this._inertiaOptions=n||{},this._mousePan.enable(),this._touchPan.enable(),this._el.classList.add("mapboxgl-touch-drag-pan")},Eo.prototype.disable=function(){this._mousePan.disable(),this._touchPan.disable(),this._el.classList.remove("mapboxgl-touch-drag-pan")},Eo.prototype.isEnabled=function(){return this._mousePan.isEnabled()&&this._touchPan.isEnabled()},Eo.prototype.isActive=function(){return this._mousePan.isActive()||this._touchPan.isActive()};var Xa=function(n,s,o){this._pitchWithRotate=n.pitchWithRotate,this._mouseRotate=s,this._mousePitch=o};Xa.prototype.enable=function(){this._mouseRotate.enable(),this._pitchWithRotate&&this._mousePitch.enable()},Xa.prototype.disable=function(){this._mouseRotate.disable(),this._mousePitch.disable()},Xa.prototype.isEnabled=function(){return this._mouseRotate.isEnabled()&&(!this._pitchWithRotate||this._mousePitch.isEnabled())},Xa.prototype.isActive=function(){return this._mouseRotate.isActive()||this._mousePitch.isActive()};var ya=function(n,s,o,c){this._el=n,this._touchZoom=s,this._touchRotate=o,this._tapDragZoom=c,this._rotationDisabled=!1,this._enabled=!0};ya.prototype.enable=function(n){this._touchZoom.enable(n),this._rotationDisabled||this._touchRotate.enable(n),this._tapDragZoom.enable(),this._el.classList.add("mapboxgl-touch-zoom-rotate")},ya.prototype.disable=function(){this._touchZoom.disable(),this._touchRotate.disable(),this._tapDragZoom.disable(),this._el.classList.remove("mapboxgl-touch-zoom-rotate")},ya.prototype.isEnabled=function(){return this._touchZoom.isEnabled()&&(this._rotationDisabled||this._touchRotate.isEnabled())&&this._tapDragZoom.isEnabled()},ya.prototype.isActive=function(){return this._touchZoom.isActive()||this._touchRotate.isActive()||this._tapDragZoom.isActive()},ya.prototype.disableRotation=function(){this._rotationDisabled=!0,this._touchRotate.disable()},ya.prototype.enableRotation=function(){this._rotationDisabled=!1,this._touchZoom.isEnabled()&&this._touchRotate.enable()};var _n=function(n){return n.zoom||n.drag||n.pitch||n.rotate},bs=function(n){function s(){n.apply(this,arguments)}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s}(a.Event);function St(n){return n.panDelta&&n.panDelta.mag()||n.zoomDelta||n.bearingDelta||n.pitchDelta}var _t=function(n,s){this._map=n,this._el=this._map.getCanvasContainer(),this._handlers=[],this._handlersById={},this._changes=[],this._inertia=new ys(n),this._bearingSnap=s.bearingSnap,this._previousActiveHandlers={},this._eventsInProgress={},this._addDefaultHandlers(s),a.bindAll(["handleEvent","handleWindowEvent"],this);var o=this._el;this._listeners=[[o,"touchstart",{passive:!0}],[o,"touchmove",{passive:!1}],[o,"touchend",void 0],[o,"touchcancel",void 0],[o,"mousedown",void 0],[o,"mousemove",void 0],[o,"mouseup",void 0],[a.window.document,"mousemove",{capture:!0}],[a.window.document,"mouseup",void 0],[o,"mouseover",void 0],[o,"mouseout",void 0],[o,"dblclick",void 0],[o,"click",void 0],[o,"keydown",{capture:!1}],[o,"keyup",void 0],[o,"wheel",{passive:!1}],[o,"contextmenu",void 0],[a.window,"blur",void 0]];for(var c=0,_=this._listeners;c<_.length;c+=1){var w=_[c],S=w[0];T.addEventListener(S,w[1],S===a.window.document?this.handleWindowEvent:this.handleEvent,w[2])}};_t.prototype.destroy=function(){for(var n=0,s=this._listeners;n<s.length;n+=1){var o=s[n],c=o[0];T.removeEventListener(c,o[1],c===a.window.document?this.handleWindowEvent:this.handleEvent,o[2])}},_t.prototype._addDefaultHandlers=function(n){var s=this._map,o=s.getCanvasContainer();this._add("mapEvent",new bi(s,n));var c=s.boxZoom=new qn(s,n);this._add("boxZoom",c);var _=new jn,w=new aa;s.doubleClickZoom=new ka(w,_),this._add("tapZoom",_),this._add("clickZoom",w);var S=new tn;this._add("tapDragZoom",S);var P=s.touchPitch=new tu;this._add("touchPitch",P);var C=new Ys(n),O=new eu(n);s.dragRotate=new Xa(n,C,O),this._add("mouseRotate",C,["mousePitch"]),this._add("mousePitch",O,["mouseRotate"]);var Z=new $l(n),K=new na(n);s.dragPan=new Eo(o,Z,K),this._add("mousePan",Z),this._add("touchPan",K,["touchZoom","touchRotate"]);var H=new kc,re=new Zn;s.touchZoomRotate=new ya(o,re,H,S),this._add("touchRotate",H,["touchPan","touchZoom"]),this._add("touchZoom",re,["touchPan","touchRotate"]);var te=s.scrollZoom=new rr(s,this);this._add("scrollZoom",te,["mousePan"]);var ce=s.keyboard=new ma;this._add("keyboard",ce),this._add("blockableMapEvent",new pt(s));for(var Y=0,se=["boxZoom","doubleClickZoom","tapDragZoom","touchPitch","dragRotate","dragPan","touchZoomRotate","scrollZoom","keyboard"];Y<se.length;Y+=1){var fe=se[Y];n.interactive&&n[fe]&&s[fe].enable(n[fe])}},_t.prototype._add=function(n,s,o){this._handlers.push({handlerName:n,handler:s,allowed:o}),this._handlersById[n]=s},_t.prototype.stop=function(n){if(!this._updatingCamera){for(var s=0,o=this._handlers;s<o.length;s+=1)o[s].handler.reset();this._inertia.clear(),this._fireEvents({},{},n),this._changes=[]}},_t.prototype.isActive=function(){for(var n=0,s=this._handlers;n<s.length;n+=1)if(s[n].handler.isActive())return!0;return!1},_t.prototype.isZooming=function(){return!!this._eventsInProgress.zoom||this._map.scrollZoom.isZooming()},_t.prototype.isRotating=function(){return!!this._eventsInProgress.rotate},_t.prototype.isMoving=function(){return!!_n(this._eventsInProgress)||this.isZooming()},_t.prototype._blockedByActive=function(n,s,o){for(var c in n)if(c!==o&&(!s||s.indexOf(c)<0))return!0;return!1},_t.prototype.handleWindowEvent=function(n){this.handleEvent(n,n.type+"Window")},_t.prototype._getMapTouches=function(n){for(var s=[],o=0,c=n;o<c.length;o+=1){var _=c[o];this._el.contains(_.target)&&s.push(_)}return s},_t.prototype.handleEvent=function(n,s){this._updatingCamera=!0;for(var o=n.type==="renderFrame"?void 0:n,c={needsRenderFrame:!1},_={},w={},S=n.touches?this._getMapTouches(n.touches):void 0,P=S?T.touchPos(this._el,S):T.mousePos(this._el,n),C=0,O=this._handlers;C<O.length;C+=1){var Z=O[C],K=Z.handlerName,H=Z.handler,re=Z.allowed;if(H.isEnabled()){var te=void 0;this._blockedByActive(w,re,K)?H.reset():H[s||n.type]&&(te=H[s||n.type](n,P,S),this.mergeHandlerResult(c,_,te,K,o),te&&te.needsRenderFrame&&this._triggerRenderFrame()),(te||H.isActive())&&(w[K]=H)}}var ce={};for(var Y in this._previousActiveHandlers)w[Y]||(ce[Y]=o);this._previousActiveHandlers=w,(Object.keys(ce).length||St(c))&&(this._changes.push([c,_,ce]),this._triggerRenderFrame()),(Object.keys(w).length||St(c))&&this._map._stop(!0),this._updatingCamera=!1;var se=c.cameraAnimation;se&&(this._inertia.clear(),this._fireEvents({},{},!0),this._changes=[],se(this._map))},_t.prototype.mergeHandlerResult=function(n,s,o,c,_){if(o){a.extend(n,o);var w={handlerName:c,originalEvent:o.originalEvent||_};o.zoomDelta!==void 0&&(s.zoom=w),o.panDelta!==void 0&&(s.drag=w),o.pitchDelta!==void 0&&(s.pitch=w),o.bearingDelta!==void 0&&(s.rotate=w)}},_t.prototype._applyChanges=function(){for(var n={},s={},o={},c=0,_=this._changes;c<_.length;c+=1){var w=_[c],S=w[0],P=w[1],C=w[2];S.panDelta&&(n.panDelta=(n.panDelta||new a.Point(0,0))._add(S.panDelta)),S.zoomDelta&&(n.zoomDelta=(n.zoomDelta||0)+S.zoomDelta),S.bearingDelta&&(n.bearingDelta=(n.bearingDelta||0)+S.bearingDelta),S.pitchDelta&&(n.pitchDelta=(n.pitchDelta||0)+S.pitchDelta),S.around!==void 0&&(n.around=S.around),S.pinchAround!==void 0&&(n.pinchAround=S.pinchAround),S.noInertia&&(n.noInertia=S.noInertia),a.extend(s,P),a.extend(o,C)}this._updateMapTransform(n,s,o),this._changes=[]},_t.prototype._updateMapTransform=function(n,s,o){var c=this._map,_=c.transform;if(!St(n))return this._fireEvents(s,o,!0);var w=n.panDelta,S=n.zoomDelta,P=n.bearingDelta,C=n.pitchDelta,O=n.around,Z=n.pinchAround;Z!==void 0&&(O=Z),c._stop(!0),O=O||c.transform.centerPoint;var K=_.pointLocation(w?O.sub(w):O);P&&(_.bearing+=P),C&&(_.pitch+=C),S&&(_.zoom+=S),_.setLocationAtPoint(K,O),this._map._update(),n.noInertia||this._inertia.record(n),this._fireEvents(s,o,!0)},_t.prototype._fireEvents=function(n,s,o){var c=this,_=_n(this._eventsInProgress),w=_n(n),S={};for(var P in n)this._eventsInProgress[P]||(S[P+"start"]=n[P].originalEvent),this._eventsInProgress[P]=n[P];for(var C in!_&&w&&this._fireEvent("movestart",w.originalEvent),S)this._fireEvent(C,S[C]);for(var O in w&&this._fireEvent("move",w.originalEvent),n)this._fireEvent(O,n[O].originalEvent);var Z,K={};for(var H in this._eventsInProgress){var re=this._eventsInProgress[H],te=re.handlerName,ce=re.originalEvent;this._handlersById[te].isActive()||(delete this._eventsInProgress[H],K[H+"end"]=Z=s[te]||ce)}for(var Y in K)this._fireEvent(Y,K[Y]);var se=_n(this._eventsInProgress);if(o&&(_||w)&&!se){this._updatingCamera=!0;var fe=this._inertia._onMoveEnd(this._map.dragPan._inertiaOptions),ve=function(Ie){return Ie!==0&&-c._bearingSnap<Ie&&Ie<c._bearingSnap};fe?(ve(fe.bearing||this._map.getBearing())&&(fe.bearing=0),this._map.easeTo(fe,{originalEvent:Z})):(this._map.fire(new a.Event("moveend",{originalEvent:Z})),ve(this._map.getBearing())&&this._map.resetNorth()),this._updatingCamera=!1}},_t.prototype._fireEvent=function(n,s){this._map.fire(new a.Event(n,s?{originalEvent:s}:{}))},_t.prototype._requestFrame=function(){var n=this;return this._map.triggerRepaint(),this._map._renderTaskQueue.add(function(s){delete n._frameId,n.handleEvent(new bs("renderFrame",{timeStamp:s})),n._applyChanges()})},_t.prototype._triggerRenderFrame=function(){this._frameId===void 0&&(this._frameId=this._requestFrame())};var $s=function(n){function s(o,c){n.call(this),this._moving=!1,this._zooming=!1,this.transform=o,this._bearingSnap=c.bearingSnap,a.bindAll(["_renderFrameCallback"],this)}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype.getCenter=function(){return new a.LngLat(this.transform.center.lng,this.transform.center.lat)},s.prototype.setCenter=function(o,c){return this.jumpTo({center:o},c)},s.prototype.panBy=function(o,c,_){return o=a.Point.convert(o).mult(-1),this.panTo(this.transform.center,a.extend({offset:o},c),_)},s.prototype.panTo=function(o,c,_){return this.easeTo(a.extend({center:o},c),_)},s.prototype.getZoom=function(){return this.transform.zoom},s.prototype.setZoom=function(o,c){return this.jumpTo({zoom:o},c),this},s.prototype.zoomTo=function(o,c,_){return this.easeTo(a.extend({zoom:o},c),_)},s.prototype.zoomIn=function(o,c){return this.zoomTo(this.getZoom()+1,o,c),this},s.prototype.zoomOut=function(o,c){return this.zoomTo(this.getZoom()-1,o,c),this},s.prototype.getBearing=function(){return this.transform.bearing},s.prototype.setBearing=function(o,c){return this.jumpTo({bearing:o},c),this},s.prototype.getPadding=function(){return this.transform.padding},s.prototype.setPadding=function(o,c){return this.jumpTo({padding:o},c),this},s.prototype.rotateTo=function(o,c,_){return this.easeTo(a.extend({bearing:o},c),_)},s.prototype.resetNorth=function(o,c){return this.rotateTo(0,a.extend({duration:1e3},o),c),this},s.prototype.resetNorthPitch=function(o,c){return this.easeTo(a.extend({bearing:0,pitch:0,duration:1e3},o),c),this},s.prototype.snapToNorth=function(o,c){return Math.abs(this.getBearing())<this._bearingSnap?this.resetNorth(o,c):this},s.prototype.getPitch=function(){return this.transform.pitch},s.prototype.setPitch=function(o,c){return this.jumpTo({pitch:o},c),this},s.prototype.cameraForBounds=function(o,c){o=a.LngLatBounds.convert(o);var _=c&&c.bearing||0;return this._cameraForBoxAndBearing(o.getNorthWest(),o.getSouthEast(),_,c)},s.prototype._cameraForBoxAndBearing=function(o,c,_,w){var S={top:0,bottom:0,right:0,left:0};if(typeof(w=a.extend({padding:S,offset:[0,0],maxZoom:this.transform.maxZoom},w)).padding=="number"){var P=w.padding;w.padding={top:P,bottom:P,right:P,left:P}}w.padding=a.extend(S,w.padding);var C=this.transform,O=C.padding,Z=C.project(a.LngLat.convert(o)),K=C.project(a.LngLat.convert(c)),H=Z.rotate(-_*Math.PI/180),re=K.rotate(-_*Math.PI/180),te=new a.Point(Math.max(H.x,re.x),Math.max(H.y,re.y)),ce=new a.Point(Math.min(H.x,re.x),Math.min(H.y,re.y)),Y=te.sub(ce),se=(C.width-(O.left+O.right+w.padding.left+w.padding.right))/Y.x,fe=(C.height-(O.top+O.bottom+w.padding.top+w.padding.bottom))/Y.y;if(!(fe<0||se<0)){var ve=Math.min(C.scaleZoom(C.scale*Math.min(se,fe)),w.maxZoom),Ie=typeof w.offset.x=="number"?new a.Point(w.offset.x,w.offset.y):a.Point.convert(w.offset),ke=new a.Point((w.padding.left-w.padding.right)/2,(w.padding.top-w.padding.bottom)/2).rotate(_*Math.PI/180),Pe=Ie.add(ke).mult(C.scale/C.zoomScale(ve));return{center:C.unproject(Z.add(K).div(2).sub(Pe)),zoom:ve,bearing:_}}a.warnOnce("Map cannot fit within canvas with the given bounds, padding, and/or offset.")},s.prototype.fitBounds=function(o,c,_){return this._fitInternal(this.cameraForBounds(o,c),c,_)},s.prototype.fitScreenCoordinates=function(o,c,_,w,S){return this._fitInternal(this._cameraForBoxAndBearing(this.transform.pointLocation(a.Point.convert(o)),this.transform.pointLocation(a.Point.convert(c)),_,w),w,S)},s.prototype._fitInternal=function(o,c,_){return o?(delete(c=a.extend(o,c)).padding,c.linear?this.easeTo(c,_):this.flyTo(c,_)):this},s.prototype.jumpTo=function(o,c){this.stop();var _=this.transform,w=!1,S=!1,P=!1;return"zoom"in o&&_.zoom!==+o.zoom&&(w=!0,_.zoom=+o.zoom),o.center!==void 0&&(_.center=a.LngLat.convert(o.center)),"bearing"in o&&_.bearing!==+o.bearing&&(S=!0,_.bearing=+o.bearing),"pitch"in o&&_.pitch!==+o.pitch&&(P=!0,_.pitch=+o.pitch),o.padding==null||_.isPaddingEqual(o.padding)||(_.padding=o.padding),this.fire(new a.Event("movestart",c)).fire(new a.Event("move",c)),w&&this.fire(new a.Event("zoomstart",c)).fire(new a.Event("zoom",c)).fire(new a.Event("zoomend",c)),S&&this.fire(new a.Event("rotatestart",c)).fire(new a.Event("rotate",c)).fire(new a.Event("rotateend",c)),P&&this.fire(new a.Event("pitchstart",c)).fire(new a.Event("pitch",c)).fire(new a.Event("pitchend",c)),this.fire(new a.Event("moveend",c))},s.prototype.easeTo=function(o,c){var _=this;this._stop(!1,o.easeId),((o=a.extend({offset:[0,0],duration:500,easing:a.ease},o)).animate===!1||!o.essential&&a.browser.prefersReducedMotion)&&(o.duration=0);var w=this.transform,S=this.getZoom(),P=this.getBearing(),C=this.getPitch(),O=this.getPadding(),Z="zoom"in o?+o.zoom:S,K="bearing"in o?this._normalizeBearing(o.bearing,P):P,H="pitch"in o?+o.pitch:C,re="padding"in o?o.padding:w.padding,te=a.Point.convert(o.offset),ce=w.centerPoint.add(te),Y=w.pointLocation(ce),se=a.LngLat.convert(o.center||Y);this._normalizeCenter(se);var fe,ve,Ie=w.project(Y),ke=w.project(se).sub(Ie),Pe=w.zoomScale(Z-S);o.around&&(fe=a.LngLat.convert(o.around),ve=w.locationPoint(fe));var Ne={moving:this._moving,zooming:this._zooming,rotating:this._rotating,pitching:this._pitching};return this._zooming=this._zooming||Z!==S,this._rotating=this._rotating||P!==K,this._pitching=this._pitching||H!==C,this._padding=!w.isPaddingEqual(re),this._easeId=o.easeId,this._prepareEase(c,o.noMoveStart,Ne),this._ease(function(Je){if(_._zooming&&(w.zoom=a.number(S,Z,Je)),_._rotating&&(w.bearing=a.number(P,K,Je)),_._pitching&&(w.pitch=a.number(C,H,Je)),_._padding&&(w.interpolatePadding(O,re,Je),ce=w.centerPoint.add(te)),fe)w.setLocationAtPoint(fe,ve);else{var Xe=w.zoomScale(w.zoom-S),ct=Z>S?Math.min(2,Pe):Math.max(.5,Pe),Et=Math.pow(ct,1-Je),Ct=w.unproject(Ie.add(ke.mult(Je*Et)).mult(Xe));w.setLocationAtPoint(w.renderWorldCopies?Ct.wrap():Ct,ce)}_._fireMoveEvents(c)},function(Je){_._afterEase(c,Je)},o),this},s.prototype._prepareEase=function(o,c,_){_===void 0&&(_={}),this._moving=!0,c||_.moving||this.fire(new a.Event("movestart",o)),this._zooming&&!_.zooming&&this.fire(new a.Event("zoomstart",o)),this._rotating&&!_.rotating&&this.fire(new a.Event("rotatestart",o)),this._pitching&&!_.pitching&&this.fire(new a.Event("pitchstart",o))},s.prototype._fireMoveEvents=function(o){this.fire(new a.Event("move",o)),this._zooming&&this.fire(new a.Event("zoom",o)),this._rotating&&this.fire(new a.Event("rotate",o)),this._pitching&&this.fire(new a.Event("pitch",o))},s.prototype._afterEase=function(o,c){if(!this._easeId||!c||this._easeId!==c){delete this._easeId;var _=this._zooming,w=this._rotating,S=this._pitching;this._moving=!1,this._zooming=!1,this._rotating=!1,this._pitching=!1,this._padding=!1,_&&this.fire(new a.Event("zoomend",o)),w&&this.fire(new a.Event("rotateend",o)),S&&this.fire(new a.Event("pitchend",o)),this.fire(new a.Event("moveend",o))}},s.prototype.flyTo=function(o,c){var _=this;if(!o.essential&&a.browser.prefersReducedMotion){var w=a.pick(o,["center","zoom","bearing","pitch","around"]);return this.jumpTo(w,c)}this.stop(),o=a.extend({offset:[0,0],speed:1.2,curve:1.42,easing:a.ease},o);var S=this.transform,P=this.getZoom(),C=this.getBearing(),O=this.getPitch(),Z=this.getPadding(),K="zoom"in o?a.clamp(+o.zoom,S.minZoom,S.maxZoom):P,H="bearing"in o?this._normalizeBearing(o.bearing,C):C,re="pitch"in o?+o.pitch:O,te="padding"in o?o.padding:S.padding,ce=S.zoomScale(K-P),Y=a.Point.convert(o.offset),se=S.centerPoint.add(Y),fe=S.pointLocation(se),ve=a.LngLat.convert(o.center||fe);this._normalizeCenter(ve);var Ie=S.project(fe),ke=S.project(ve).sub(Ie),Pe=o.curve,Ne=Math.max(S.width,S.height),Je=Ne/ce,Xe=ke.mag();if("minZoom"in o){var ct=a.clamp(Math.min(o.minZoom,P,K),S.minZoom,S.maxZoom),Et=Ne/S.zoomScale(ct-P);Pe=Math.sqrt(Et/Xe*2)}var Ct=Pe*Pe;function At(Rt){var Dt=(Je*Je-Ne*Ne+(Rt?-1:1)*Ct*Ct*Xe*Xe)/(2*(Rt?Je:Ne)*Ct*Xe);return Math.log(Math.sqrt(Dt*Dt+1)-Dt)}function yr(Rt){return(Math.exp(Rt)-Math.exp(-Rt))/2}function ht(Rt){return(Math.exp(Rt)+Math.exp(-Rt))/2}var Ut=At(0),Yt=function(Rt){return ht(Ut)/ht(Ut+Pe*Rt)},Ot=function(Rt){return Ne*((ht(Ut)*(yr(Dt=Ut+Pe*Rt)/ht(Dt))-yr(Ut))/Ct)/Xe;var Dt},Ft=(At(1)-Ut)/Pe;if(Math.abs(Xe)<1e-6||!isFinite(Ft)){if(Math.abs(Ne-Je)<1e-6)return this.easeTo(o,c);var Xt=Je<Ne?-1:1;Ft=Math.abs(Math.log(Je/Ne))/Pe,Ot=function(){return 0},Yt=function(Rt){return Math.exp(Xt*Pe*Rt)}}return o.duration="duration"in o?+o.duration:1e3*Ft/("screenSpeed"in o?+o.screenSpeed/Pe:+o.speed),o.maxDuration&&o.duration>o.maxDuration&&(o.duration=0),this._zooming=!0,this._rotating=C!==H,this._pitching=re!==O,this._padding=!S.isPaddingEqual(te),this._prepareEase(c,!1),this._ease(function(Rt){var Dt=Rt*Ft,Li=1/Yt(Dt);S.zoom=Rt===1?K:P+S.scaleZoom(Li),_._rotating&&(S.bearing=a.number(C,H,Rt)),_._pitching&&(S.pitch=a.number(O,re,Rt)),_._padding&&(S.interpolatePadding(Z,te,Rt),se=S.centerPoint.add(Y));var si=Rt===1?ve:S.unproject(Ie.add(ke.mult(Ot(Dt))).mult(Li));S.setLocationAtPoint(S.renderWorldCopies?si.wrap():si,se),_._fireMoveEvents(c)},function(){return _._afterEase(c)},o),this},s.prototype.isEasing=function(){return!!this._easeFrameId},s.prototype.stop=function(){return this._stop()},s.prototype._stop=function(o,c){if(this._easeFrameId&&(this._cancelRenderFrame(this._easeFrameId),delete this._easeFrameId,delete this._onEaseFrame),this._onEaseEnd){var _=this._onEaseEnd;delete this._onEaseEnd,_.call(this,c)}if(!o){var w=this.handlers;w&&w.stop(!1)}return this},s.prototype._ease=function(o,c,_){_.animate===!1||_.duration===0?(o(1),c()):(this._easeStart=a.browser.now(),this._easeOptions=_,this._onEaseFrame=o,this._onEaseEnd=c,this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback))},s.prototype._renderFrameCallback=function(){var o=Math.min((a.browser.now()-this._easeStart)/this._easeOptions.duration,1);this._onEaseFrame(this._easeOptions.easing(o)),o<1?this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback):this.stop()},s.prototype._normalizeBearing=function(o,c){o=a.wrap(o,-180,180);var _=Math.abs(o-c);return Math.abs(o-360-c)<_&&(o-=360),Math.abs(o+360-c)<_&&(o+=360),o},s.prototype._normalizeCenter=function(o){var c=this.transform;if(c.renderWorldCopies&&!c.lngRange){var _=o.lng-c.center.lng;o.lng+=_>180?-360:_<-180?360:0}},s}(a.Evented),vn=function(n){n===void 0&&(n={}),this.options=n,a.bindAll(["_toggleAttribution","_updateEditLink","_updateData","_updateCompact"],this)};vn.prototype.getDefaultPosition=function(){return"bottom-right"},vn.prototype.onAdd=function(n){var s=this.options&&this.options.compact;return this._map=n,this._container=T.create("div","mapboxgl-ctrl mapboxgl-ctrl-attrib"),this._compactButton=T.create("button","mapboxgl-ctrl-attrib-button",this._container),this._compactButton.addEventListener("click",this._toggleAttribution),this._setElementTitle(this._compactButton,"ToggleAttribution"),this._innerContainer=T.create("div","mapboxgl-ctrl-attrib-inner",this._container),this._innerContainer.setAttribute("role","list"),s&&this._container.classList.add("mapboxgl-compact"),this._updateAttributions(),this._updateEditLink(),this._map.on("styledata",this._updateData),this._map.on("sourcedata",this._updateData),this._map.on("moveend",this._updateEditLink),s===void 0&&(this._map.on("resize",this._updateCompact),this._updateCompact()),this._container},vn.prototype.onRemove=function(){T.remove(this._container),this._map.off("styledata",this._updateData),this._map.off("sourcedata",this._updateData),this._map.off("moveend",this._updateEditLink),this._map.off("resize",this._updateCompact),this._map=void 0,this._attribHTML=void 0},vn.prototype._setElementTitle=function(n,s){var o=this._map._getUIString("AttributionControl."+s);n.title=o,n.setAttribute("aria-label",o)},vn.prototype._toggleAttribution=function(){this._container.classList.contains("mapboxgl-compact-show")?(this._container.classList.remove("mapboxgl-compact-show"),this._compactButton.setAttribute("aria-pressed","false")):(this._container.classList.add("mapboxgl-compact-show"),this._compactButton.setAttribute("aria-pressed","true"))},vn.prototype._updateEditLink=function(){var n=this._editLink;n||(n=this._editLink=this._container.querySelector(".mapbox-improve-map"));var s=[{key:"owner",value:this.styleOwner},{key:"id",value:this.styleId},{key:"access_token",value:this._map._requestManager._customAccessToken||a.config.ACCESS_TOKEN}];if(n){var o=s.reduce(function(c,_,w){return _.value&&(c+=_.key+"="+_.value+(w<s.length-1?"&":"")),c},"?");n.href=a.config.FEEDBACK_URL+"/"+o+(this._map._hash?this._map._hash.getHashString(!0):""),n.rel="noopener nofollow",this._setElementTitle(n,"MapFeedback")}},vn.prototype._updateData=function(n){!n||n.sourceDataType!=="metadata"&&n.sourceDataType!=="visibility"&&n.dataType!=="style"||(this._updateAttributions(),this._updateEditLink())},vn.prototype._updateAttributions=function(){if(this._map.style){var n=[];if(this.options.customAttribution&&(Array.isArray(this.options.customAttribution)?n=n.concat(this.options.customAttribution.map(function(P){return typeof P!="string"?"":P})):typeof this.options.customAttribution=="string"&&n.push(this.options.customAttribution)),this._map.style.stylesheet){var s=this._map.style.stylesheet;this.styleOwner=s.owner,this.styleId=s.id}var o=this._map.style.sourceCaches;for(var c in o){var _=o[c];if(_.used){var w=_.getSource();w.attribution&&n.indexOf(w.attribution)<0&&n.push(w.attribution)}}n.sort(function(P,C){return P.length-C.length});var S=(n=n.filter(function(P,C){for(var O=C+1;O<n.length;O++)if(n[O].indexOf(P)>=0)return!1;return!0})).join(" | ");S!==this._attribHTML&&(this._attribHTML=S,n.length?(this._innerContainer.innerHTML=S,this._container.classList.remove("mapboxgl-attrib-empty")):this._container.classList.add("mapboxgl-attrib-empty"),this._editLink=null)}},vn.prototype._updateCompact=function(){this._map.getCanvasContainer().offsetWidth<=640?this._container.classList.add("mapboxgl-compact"):this._container.classList.remove("mapboxgl-compact","mapboxgl-compact-show")};var ga=function(){a.bindAll(["_updateLogo"],this),a.bindAll(["_updateCompact"],this)};ga.prototype.onAdd=function(n){this._map=n,this._container=T.create("div","mapboxgl-ctrl");var s=T.create("a","mapboxgl-ctrl-logo");return s.target="_blank",s.rel="noopener nofollow",s.href="https://www.mapbox.com/",s.setAttribute("aria-label",this._map._getUIString("LogoControl.Title")),s.setAttribute("rel","noopener nofollow"),this._container.appendChild(s),this._container.style.display="none",this._map.on("sourcedata",this._updateLogo),this._updateLogo(),this._map.on("resize",this._updateCompact),this._updateCompact(),this._container},ga.prototype.onRemove=function(){T.remove(this._container),this._map.off("sourcedata",this._updateLogo),this._map.off("resize",this._updateCompact)},ga.prototype.getDefaultPosition=function(){return"bottom-left"},ga.prototype._updateLogo=function(n){n&&n.sourceDataType!=="metadata"||(this._container.style.display=this._logoRequired()?"block":"none")},ga.prototype._logoRequired=function(){if(this._map.style){var n=this._map.style.sourceCaches;for(var s in n)if(n[s].getSource().mapbox_logo)return!0;return!1}},ga.prototype._updateCompact=function(){var n=this._container.children;if(n.length){var s=n[0];this._map.getCanvasContainer().offsetWidth<250?s.classList.add("mapboxgl-compact"):s.classList.remove("mapboxgl-compact")}};var rn=function(){this._queue=[],this._id=0,this._cleared=!1,this._currentlyRunning=!1};rn.prototype.add=function(n){var s=++this._id;return this._queue.push({callback:n,id:s,cancelled:!1}),s},rn.prototype.remove=function(n){for(var s=this._currentlyRunning,o=0,c=s?this._queue.concat(s):this._queue;o<c.length;o+=1){var _=c[o];if(_.id===n)return void(_.cancelled=!0)}},rn.prototype.run=function(n){n===void 0&&(n=0);var s=this._currentlyRunning=this._queue;this._queue=[];for(var o=0,c=s;o<c.length;o+=1){var _=c[o];if(!_.cancelled&&(_.callback(n),this._cleared))break}this._cleared=!1,this._currentlyRunning=!1},rn.prototype.clear=function(){this._currentlyRunning&&(this._cleared=!0),this._queue=[]};var Ta={"AttributionControl.ToggleAttribution":"Toggle attribution","AttributionControl.MapFeedback":"Map feedback","FullscreenControl.Enter":"Enter fullscreen","FullscreenControl.Exit":"Exit fullscreen","GeolocateControl.FindMyLocation":"Find my location","GeolocateControl.LocationNotAvailable":"Location not available","LogoControl.Title":"Mapbox logo","NavigationControl.ResetBearing":"Reset bearing to north","NavigationControl.ZoomIn":"Zoom in","NavigationControl.ZoomOut":"Zoom out","ScaleControl.Feet":"ft","ScaleControl.Meters":"m","ScaleControl.Kilometers":"km","ScaleControl.Miles":"mi","ScaleControl.NauticalMiles":"nm"},iu=a.window.HTMLImageElement,el=a.window.HTMLElement,Ir=a.window.ImageBitmap,Zi={center:[0,0],zoom:0,bearing:0,pitch:0,minZoom:-2,maxZoom:22,minPitch:0,maxPitch:60,interactive:!0,scrollZoom:!0,boxZoom:!0,dragRotate:!0,dragPan:!0,keyboard:!0,doubleClickZoom:!0,touchZoomRotate:!0,touchPitch:!0,bearingSnap:7,clickTolerance:3,pitchWithRotate:!0,hash:!1,attributionControl:!0,failIfMajorPerformanceCaveat:!1,preserveDrawingBuffer:!1,trackResize:!0,renderWorldCopies:!0,refreshExpiredTiles:!0,maxTileCacheSize:null,localIdeographFontFamily:"sans-serif",transformRequest:null,accessToken:null,fadeDuration:300,crossSourceCollisions:!0},Tc=function(n){function s(c){var _=this;if((c=a.extend({},Zi,c)).minZoom!=null&&c.maxZoom!=null&&c.minZoom>c.maxZoom)throw new Error("maxZoom must be greater than or equal to minZoom");if(c.minPitch!=null&&c.maxPitch!=null&&c.minPitch>c.maxPitch)throw new Error("maxPitch must be greater than or equal to minPitch");if(c.minPitch!=null&&c.minPitch<0)throw new Error("minPitch must be greater than or equal to 0");if(c.maxPitch!=null&&c.maxPitch>60)throw new Error("maxPitch must be less than or equal to 60");var w=new fr(c.minZoom,c.maxZoom,c.minPitch,c.maxPitch,c.renderWorldCopies);if(n.call(this,w,c),this._interactive=c.interactive,this._maxTileCacheSize=c.maxTileCacheSize,this._failIfMajorPerformanceCaveat=c.failIfMajorPerformanceCaveat,this._preserveDrawingBuffer=c.preserveDrawingBuffer,this._antialias=c.antialias,this._trackResize=c.trackResize,this._bearingSnap=c.bearingSnap,this._refreshExpiredTiles=c.refreshExpiredTiles,this._fadeDuration=c.fadeDuration,this._crossSourceCollisions=c.crossSourceCollisions,this._crossFadingFactor=1,this._collectResourceTiming=c.collectResourceTiming,this._renderTaskQueue=new rn,this._controls=[],this._mapId=a.uniqueId(),this._locale=a.extend({},Ta,c.locale),this._clickTolerance=c.clickTolerance,this._requestManager=new a.RequestManager(c.transformRequest,c.accessToken),typeof c.container=="string"){if(this._container=a.window.document.getElementById(c.container),!this._container)throw new Error("Container '"+c.container+"' not found.")}else{if(!(c.container instanceof el))throw new Error("Invalid type: 'container' must be a String or HTMLElement.");this._container=c.container}if(c.maxBounds&&this.setMaxBounds(c.maxBounds),a.bindAll(["_onWindowOnline","_onWindowResize","_onMapScroll","_contextLost","_contextRestored"],this),this._setupContainer(),this._setupPainter(),this.painter===void 0)throw new Error("Failed to initialize WebGL.");this.on("move",function(){return _._update(!1)}),this.on("moveend",function(){return _._update(!1)}),this.on("zoom",function(){return _._update(!0)}),a.window!==void 0&&(a.window.addEventListener("online",this._onWindowOnline,!1),a.window.addEventListener("resize",this._onWindowResize,!1),a.window.addEventListener("orientationchange",this._onWindowResize,!1)),this.handlers=new _t(this,c),this._hash=c.hash&&new $n(typeof c.hash=="string"&&c.hash||void 0).addTo(this),this._hash&&this._hash._onHashChange()||(this.jumpTo({center:c.center,zoom:c.zoom,bearing:c.bearing,pitch:c.pitch}),c.bounds&&(this.resize(),this.fitBounds(c.bounds,a.extend({},c.fitBoundsOptions,{duration:0})))),this.resize(),this._localIdeographFontFamily=c.localIdeographFontFamily,c.style&&this.setStyle(c.style,{localIdeographFontFamily:c.localIdeographFontFamily}),c.attributionControl&&this.addControl(new vn({customAttribution:c.customAttribution})),this.addControl(new ga,c.logoPosition),this.on("style.load",function(){_.transform.unmodified&&_.jumpTo(_.style.stylesheet)}),this.on("data",function(S){_._update(S.dataType==="style"),_.fire(new a.Event(S.dataType+"data",S))}),this.on("dataloading",function(S){_.fire(new a.Event(S.dataType+"dataloading",S))})}n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s;var o={showTileBoundaries:{configurable:!0},showPadding:{configurable:!0},showCollisionBoxes:{configurable:!0},showOverdrawInspector:{configurable:!0},repaint:{configurable:!0},vertices:{configurable:!0},version:{configurable:!0}};return s.prototype._getMapId=function(){return this._mapId},s.prototype.addControl=function(c,_){if(_===void 0&&(_=c.getDefaultPosition?c.getDefaultPosition():"top-right"),!c||!c.onAdd)return this.fire(new a.ErrorEvent(new Error("Invalid argument to map.addControl(). Argument must be a control with onAdd and onRemove methods.")));var w=c.onAdd(this);this._controls.push(c);var S=this._controlPositions[_];return _.indexOf("bottom")!==-1?S.insertBefore(w,S.firstChild):S.appendChild(w),this},s.prototype.removeControl=function(c){if(!c||!c.onRemove)return this.fire(new a.ErrorEvent(new Error("Invalid argument to map.removeControl(). Argument must be a control with onAdd and onRemove methods.")));var _=this._controls.indexOf(c);return _>-1&&this._controls.splice(_,1),c.onRemove(this),this},s.prototype.hasControl=function(c){return this._controls.indexOf(c)>-1},s.prototype.resize=function(c){var _=this._containerDimensions(),w=_[0],S=_[1];if(w===this.transform.width&&S===this.transform.height)return this;this._resizeCanvas(w,S),this.transform.resize(w,S),this.painter.resize(w,S);var P=!this._moving;return P&&this.fire(new a.Event("movestart",c)).fire(new a.Event("move",c)),this.fire(new a.Event("resize",c)),P&&this.fire(new a.Event("moveend",c)),this},s.prototype.getBounds=function(){return this.transform.getBounds()},s.prototype.getMaxBounds=function(){return this.transform.getMaxBounds()},s.prototype.setMaxBounds=function(c){return this.transform.setMaxBounds(a.LngLatBounds.convert(c)),this._update()},s.prototype.setMinZoom=function(c){if((c=c??-2)>=-2&&c<=this.transform.maxZoom)return this.transform.minZoom=c,this._update(),this.getZoom()<c&&this.setZoom(c),this;throw new Error("minZoom must be between -2 and the current maxZoom, inclusive")},s.prototype.getMinZoom=function(){return this.transform.minZoom},s.prototype.setMaxZoom=function(c){if((c=c??22)>=this.transform.minZoom)return this.transform.maxZoom=c,this._update(),this.getZoom()>c&&this.setZoom(c),this;throw new Error("maxZoom must be greater than the current minZoom")},s.prototype.getMaxZoom=function(){return this.transform.maxZoom},s.prototype.setMinPitch=function(c){if((c=c??0)<0)throw new Error("minPitch must be greater than or equal to 0");if(c>=0&&c<=this.transform.maxPitch)return this.transform.minPitch=c,this._update(),this.getPitch()<c&&this.setPitch(c),this;throw new Error("minPitch must be between 0 and the current maxPitch, inclusive")},s.prototype.getMinPitch=function(){return this.transform.minPitch},s.prototype.setMaxPitch=function(c){if((c=c??60)>60)throw new Error("maxPitch must be less than or equal to 60");if(c>=this.transform.minPitch)return this.transform.maxPitch=c,this._update(),this.getPitch()>c&&this.setPitch(c),this;throw new Error("maxPitch must be greater than the current minPitch")},s.prototype.getMaxPitch=function(){return this.transform.maxPitch},s.prototype.getRenderWorldCopies=function(){return this.transform.renderWorldCopies},s.prototype.setRenderWorldCopies=function(c){return this.transform.renderWorldCopies=c,this._update()},s.prototype.project=function(c){return this.transform.locationPoint(a.LngLat.convert(c))},s.prototype.unproject=function(c){return this.transform.pointLocation(a.Point.convert(c))},s.prototype.isMoving=function(){return this._moving||this.handlers.isMoving()},s.prototype.isZooming=function(){return this._zooming||this.handlers.isZooming()},s.prototype.isRotating=function(){return this._rotating||this.handlers.isRotating()},s.prototype._createDelegatedListener=function(c,_,w){var S,P=this;if(c==="mouseenter"||c==="mouseover"){var C=!1;return{layer:_,listener:w,delegates:{mousemove:function(Z){var K=P.getLayer(_)?P.queryRenderedFeatures(Z.point,{layers:[_]}):[];K.length?C||(C=!0,w.call(P,new Pi(c,P,Z.originalEvent,{features:K}))):C=!1},mouseout:function(){C=!1}}}}if(c==="mouseleave"||c==="mouseout"){var O=!1;return{layer:_,listener:w,delegates:{mousemove:function(Z){(P.getLayer(_)?P.queryRenderedFeatures(Z.point,{layers:[_]}):[]).length?O=!0:O&&(O=!1,w.call(P,new Pi(c,P,Z.originalEvent)))},mouseout:function(Z){O&&(O=!1,w.call(P,new Pi(c,P,Z.originalEvent)))}}}}return{layer:_,listener:w,delegates:(S={},S[c]=function(Z){var K=P.getLayer(_)?P.queryRenderedFeatures(Z.point,{layers:[_]}):[];K.length&&(Z.features=K,w.call(P,Z),delete Z.features)},S)}},s.prototype.on=function(c,_,w){if(w===void 0)return n.prototype.on.call(this,c,_);var S=this._createDelegatedListener(c,_,w);for(var P in this._delegatedListeners=this._delegatedListeners||{},this._delegatedListeners[c]=this._delegatedListeners[c]||[],this._delegatedListeners[c].push(S),S.delegates)this.on(P,S.delegates[P]);return this},s.prototype.once=function(c,_,w){if(w===void 0)return n.prototype.once.call(this,c,_);var S=this._createDelegatedListener(c,_,w);for(var P in S.delegates)this.once(P,S.delegates[P]);return this},s.prototype.off=function(c,_,w){var S=this;return w===void 0?n.prototype.off.call(this,c,_):(this._delegatedListeners&&this._delegatedListeners[c]&&function(P){for(var C=P[c],O=0;O<C.length;O++){var Z=C[O];if(Z.layer===_&&Z.listener===w){for(var K in Z.delegates)S.off(K,Z.delegates[K]);return C.splice(O,1),S}}}(this._delegatedListeners),this)},s.prototype.queryRenderedFeatures=function(c,_){if(!this.style)return[];var w;if(_!==void 0||c===void 0||c instanceof a.Point||Array.isArray(c)||(_=c,c=void 0),_=_||{},(c=c||[[0,0],[this.transform.width,this.transform.height]])instanceof a.Point||typeof c[0]=="number")w=[a.Point.convert(c)];else{var S=a.Point.convert(c[0]),P=a.Point.convert(c[1]);w=[S,new a.Point(P.x,S.y),P,new a.Point(S.x,P.y),S]}return this.style.queryRenderedFeatures(w,_,this.transform)},s.prototype.querySourceFeatures=function(c,_){return this.style.querySourceFeatures(c,_)},s.prototype.setStyle=function(c,_){return(_=a.extend({},{localIdeographFontFamily:this._localIdeographFontFamily},_)).diff!==!1&&_.localIdeographFontFamily===this._localIdeographFontFamily&&this.style&&c?(this._diffStyle(c,_),this):(this._localIdeographFontFamily=_.localIdeographFontFamily,this._updateStyle(c,_))},s.prototype._getUIString=function(c){var _=this._locale[c];if(_==null)throw new Error("Missing UI string '"+c+"'");return _},s.prototype._updateStyle=function(c,_){return this.style&&(this.style.setEventedParent(null),this.style._remove()),c?(this.style=new Vn(this,_||{}),this.style.setEventedParent(this,{style:this.style}),typeof c=="string"?this.style.loadURL(c):this.style.loadJSON(c),this):(delete this.style,this)},s.prototype._lazyInitEmptyStyle=function(){this.style||(this.style=new Vn(this,{}),this.style.setEventedParent(this,{style:this.style}),this.style.loadEmpty())},s.prototype._diffStyle=function(c,_){var w=this;if(typeof c=="string"){var S=this._requestManager.normalizeStyleURL(c),P=this._requestManager.transformRequest(S,a.ResourceType.Style);a.getJSON(P,function(C,O){C?w.fire(new a.ErrorEvent(C)):O&&w._updateDiff(O,_)})}else typeof c=="object"&&this._updateDiff(c,_)},s.prototype._updateDiff=function(c,_){try{this.style.setState(c)&&this._update(!0)}catch(w){a.warnOnce("Unable to perform style diff: "+(w.message||w.error||w)+".  Rebuilding the style from scratch."),this._updateStyle(c,_)}},s.prototype.getStyle=function(){if(this.style)return this.style.serialize()},s.prototype.isStyleLoaded=function(){return this.style?this.style.loaded():a.warnOnce("There is no style added to the map.")},s.prototype.addSource=function(c,_){return this._lazyInitEmptyStyle(),this.style.addSource(c,_),this._update(!0)},s.prototype.isSourceLoaded=function(c){var _=this.style&&this.style.sourceCaches[c];if(_!==void 0)return _.loaded();this.fire(new a.ErrorEvent(new Error("There is no source with ID '"+c+"'")))},s.prototype.areTilesLoaded=function(){var c=this.style&&this.style.sourceCaches;for(var _ in c){var w=c[_]._tiles;for(var S in w){var P=w[S];if(P.state!=="loaded"&&P.state!=="errored")return!1}}return!0},s.prototype.addSourceType=function(c,_,w){return this._lazyInitEmptyStyle(),this.style.addSourceType(c,_,w)},s.prototype.removeSource=function(c){return this.style.removeSource(c),this._update(!0)},s.prototype.getSource=function(c){return this.style.getSource(c)},s.prototype.addImage=function(c,_,w){w===void 0&&(w={});var S=w.pixelRatio;S===void 0&&(S=1);var P=w.sdf;P===void 0&&(P=!1);var C=w.stretchX,O=w.stretchY,Z=w.content;if(this._lazyInitEmptyStyle(),_ instanceof iu||Ir&&_ instanceof Ir){var K=a.browser.getImageData(_);this.style.addImage(c,{data:new a.RGBAImage({width:K.width,height:K.height},K.data),pixelRatio:S,stretchX:C,stretchY:O,content:Z,sdf:P,version:0})}else{if(_.width===void 0||_.height===void 0)return this.fire(new a.ErrorEvent(new Error("Invalid arguments to map.addImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));var H=_;this.style.addImage(c,{data:new a.RGBAImage({width:_.width,height:_.height},new Uint8Array(_.data)),pixelRatio:S,stretchX:C,stretchY:O,content:Z,sdf:P,version:0,userImage:H}),H.onAdd&&H.onAdd(this,c)}},s.prototype.updateImage=function(c,_){var w=this.style.getImage(c);if(!w)return this.fire(new a.ErrorEvent(new Error("The map has no image with that id. If you are adding a new image use `map.addImage(...)` instead.")));var S=_ instanceof iu||Ir&&_ instanceof Ir?a.browser.getImageData(_):_,P=S.width,C=S.height,O=S.data;return P===void 0||C===void 0?this.fire(new a.ErrorEvent(new Error("Invalid arguments to map.updateImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`"))):P!==w.data.width||C!==w.data.height?this.fire(new a.ErrorEvent(new Error("The width and height of the updated image must be that same as the previous version of the image"))):(w.data.replace(O,!(_ instanceof iu||Ir&&_ instanceof Ir)),void this.style.updateImage(c,w))},s.prototype.hasImage=function(c){return c?!!this.style.getImage(c):(this.fire(new a.ErrorEvent(new Error("Missing required image id"))),!1)},s.prototype.removeImage=function(c){this.style.removeImage(c)},s.prototype.loadImage=function(c,_){a.getImage(this._requestManager.transformRequest(c,a.ResourceType.Image),_)},s.prototype.listImages=function(){return this.style.listImages()},s.prototype.addLayer=function(c,_){return this._lazyInitEmptyStyle(),this.style.addLayer(c,_),this._update(!0)},s.prototype.moveLayer=function(c,_){return this.style.moveLayer(c,_),this._update(!0)},s.prototype.removeLayer=function(c){return this.style.removeLayer(c),this._update(!0)},s.prototype.getLayer=function(c){return this.style.getLayer(c)},s.prototype.setLayerZoomRange=function(c,_,w){return this.style.setLayerZoomRange(c,_,w),this._update(!0)},s.prototype.setFilter=function(c,_,w){return w===void 0&&(w={}),this.style.setFilter(c,_,w),this._update(!0)},s.prototype.getFilter=function(c){return this.style.getFilter(c)},s.prototype.setPaintProperty=function(c,_,w,S){return S===void 0&&(S={}),this.style.setPaintProperty(c,_,w,S),this._update(!0)},s.prototype.getPaintProperty=function(c,_){return this.style.getPaintProperty(c,_)},s.prototype.setLayoutProperty=function(c,_,w,S){return S===void 0&&(S={}),this.style.setLayoutProperty(c,_,w,S),this._update(!0)},s.prototype.getLayoutProperty=function(c,_){return this.style.getLayoutProperty(c,_)},s.prototype.setLight=function(c,_){return _===void 0&&(_={}),this._lazyInitEmptyStyle(),this.style.setLight(c,_),this._update(!0)},s.prototype.getLight=function(){return this.style.getLight()},s.prototype.setFeatureState=function(c,_){return this.style.setFeatureState(c,_),this._update()},s.prototype.removeFeatureState=function(c,_){return this.style.removeFeatureState(c,_),this._update()},s.prototype.getFeatureState=function(c){return this.style.getFeatureState(c)},s.prototype.getContainer=function(){return this._container},s.prototype.getCanvasContainer=function(){return this._canvasContainer},s.prototype.getCanvas=function(){return this._canvas},s.prototype._containerDimensions=function(){var c=0,_=0;return this._container&&(c=this._container.clientWidth||400,_=this._container.clientHeight||300),[c,_]},s.prototype._detectMissingCSS=function(){a.window.getComputedStyle(this._missingCSSCanary).getPropertyValue("background-color")!=="rgb(250, 128, 114)"&&a.warnOnce("This page appears to be missing CSS declarations for Mapbox GL JS, which may cause the map to display incorrectly. Please ensure your page includes mapbox-gl.css, as described in https://www.mapbox.com/mapbox-gl-js/api/.")},s.prototype._setupContainer=function(){var c=this._container;c.classList.add("mapboxgl-map"),(this._missingCSSCanary=T.create("div","mapboxgl-canary",c)).style.visibility="hidden",this._detectMissingCSS();var _=this._canvasContainer=T.create("div","mapboxgl-canvas-container",c);this._interactive&&_.classList.add("mapboxgl-interactive"),this._canvas=T.create("canvas","mapboxgl-canvas",_),this._canvas.addEventListener("webglcontextlost",this._contextLost,!1),this._canvas.addEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.setAttribute("tabindex","0"),this._canvas.setAttribute("aria-label","Map"),this._canvas.setAttribute("role","region");var w=this._containerDimensions();this._resizeCanvas(w[0],w[1]);var S=this._controlContainer=T.create("div","mapboxgl-control-container",c),P=this._controlPositions={};["top-left","top-right","bottom-left","bottom-right"].forEach(function(C){P[C]=T.create("div","mapboxgl-ctrl-"+C,S)}),this._container.addEventListener("scroll",this._onMapScroll,!1)},s.prototype._resizeCanvas=function(c,_){var w=a.browser.devicePixelRatio||1;this._canvas.width=w*c,this._canvas.height=w*_,this._canvas.style.width=c+"px",this._canvas.style.height=_+"px"},s.prototype._setupPainter=function(){var c=a.extend({},k.webGLContextAttributes,{failIfMajorPerformanceCaveat:this._failIfMajorPerformanceCaveat,preserveDrawingBuffer:this._preserveDrawingBuffer,antialias:this._antialias||!1}),_=this._canvas.getContext("webgl",c)||this._canvas.getContext("experimental-webgl",c);_?(this.painter=new Hr(_,this.transform),a.webpSupported.testSupport(_)):this.fire(new a.ErrorEvent(new Error("Failed to initialize WebGL")))},s.prototype._contextLost=function(c){c.preventDefault(),this._frame&&(this._frame.cancel(),this._frame=null),this.fire(new a.Event("webglcontextlost",{originalEvent:c}))},s.prototype._contextRestored=function(c){this._setupPainter(),this.resize(),this._update(),this.fire(new a.Event("webglcontextrestored",{originalEvent:c}))},s.prototype._onMapScroll=function(c){if(c.target===this._container)return this._container.scrollTop=0,this._container.scrollLeft=0,!1},s.prototype.loaded=function(){return!this._styleDirty&&!this._sourcesDirty&&!!this.style&&this.style.loaded()},s.prototype._update=function(c){return this.style?(this._styleDirty=this._styleDirty||c,this._sourcesDirty=!0,this.triggerRepaint(),this):this},s.prototype._requestRenderFrame=function(c){return this._update(),this._renderTaskQueue.add(c)},s.prototype._cancelRenderFrame=function(c){this._renderTaskQueue.remove(c)},s.prototype._render=function(c){var _,w=this,S=0,P=this.painter.context.extTimerQuery;if(this.listens("gpu-timing-frame")&&(_=P.createQueryEXT(),P.beginQueryEXT(P.TIME_ELAPSED_EXT,_),S=a.browser.now()),this.painter.context.setDirty(),this.painter.setBaseState(),this._renderTaskQueue.run(c),!this._removed){var C=!1;if(this.style&&this._styleDirty){this._styleDirty=!1;var O=this.transform.zoom,Z=a.browser.now();this.style.zoomHistory.update(O,Z);var K=new a.EvaluationParameters(O,{now:Z,fadeDuration:this._fadeDuration,zoomHistory:this.style.zoomHistory,transition:this.style.getTransition()}),H=K.crossFadingFactor();H===1&&H===this._crossFadingFactor||(C=!0,this._crossFadingFactor=H),this.style.update(K)}if(this.style&&this._sourcesDirty&&(this._sourcesDirty=!1,this.style._updateSources(this.transform)),this._placementDirty=this.style&&this.style._updatePlacement(this.painter.transform,this.showCollisionBoxes,this._fadeDuration,this._crossSourceCollisions),this.painter.render(this.style,{showTileBoundaries:this.showTileBoundaries,showOverdrawInspector:this._showOverdrawInspector,rotating:this.isRotating(),zooming:this.isZooming(),moving:this.isMoving(),fadeDuration:this._fadeDuration,showPadding:this.showPadding,gpuTiming:!!this.listens("gpu-timing-layer")}),this.fire(new a.Event("render")),this.loaded()&&!this._loaded&&(this._loaded=!0,this.fire(new a.Event("load"))),this.style&&(this.style.hasTransitions()||C)&&(this._styleDirty=!0),this.style&&!this._placementDirty&&this.style._releaseSymbolFadeTiles(),this.listens("gpu-timing-frame")){var re=a.browser.now()-S;P.endQueryEXT(P.TIME_ELAPSED_EXT,_),setTimeout(function(){var Y=P.getQueryObjectEXT(_,P.QUERY_RESULT_EXT)/1e6;P.deleteQueryEXT(_),w.fire(new a.Event("gpu-timing-frame",{cpuTime:re,gpuTime:Y}))},50)}if(this.listens("gpu-timing-layer")){var te=this.painter.collectGpuTimers();setTimeout(function(){var Y=w.painter.queryGpuTimers(te);w.fire(new a.Event("gpu-timing-layer",{layerTimes:Y}))},50)}var ce=this._sourcesDirty||this._styleDirty||this._placementDirty;return ce||this._repaint?this.triggerRepaint():!this.isMoving()&&this.loaded()&&this.fire(new a.Event("idle")),!this._loaded||this._fullyLoaded||ce||(this._fullyLoaded=!0),this}},s.prototype.remove=function(){this._hash&&this._hash.remove();for(var c=0,_=this._controls;c<_.length;c+=1)_[c].onRemove(this);this._controls=[],this._frame&&(this._frame.cancel(),this._frame=null),this._renderTaskQueue.clear(),this.painter.destroy(),this.handlers.destroy(),delete this.handlers,this.setStyle(null),a.window!==void 0&&(a.window.removeEventListener("resize",this._onWindowResize,!1),a.window.removeEventListener("orientationchange",this._onWindowResize,!1),a.window.removeEventListener("online",this._onWindowOnline,!1));var w=this.painter.context.gl.getExtension("WEBGL_lose_context");w&&w.loseContext(),ko(this._canvasContainer),ko(this._controlContainer),ko(this._missingCSSCanary),this._container.classList.remove("mapboxgl-map"),this._removed=!0,this.fire(new a.Event("remove"))},s.prototype.triggerRepaint=function(){var c=this;this.style&&!this._frame&&(this._frame=a.browser.frame(function(_){c._frame=null,c._render(_)}))},s.prototype._onWindowOnline=function(){this._update()},s.prototype._onWindowResize=function(c){this._trackResize&&this.resize({originalEvent:c})._update()},o.showTileBoundaries.get=function(){return!!this._showTileBoundaries},o.showTileBoundaries.set=function(c){this._showTileBoundaries!==c&&(this._showTileBoundaries=c,this._update())},o.showPadding.get=function(){return!!this._showPadding},o.showPadding.set=function(c){this._showPadding!==c&&(this._showPadding=c,this._update())},o.showCollisionBoxes.get=function(){return!!this._showCollisionBoxes},o.showCollisionBoxes.set=function(c){this._showCollisionBoxes!==c&&(this._showCollisionBoxes=c,c?this.style._generateCollisionBoxes():this._update())},o.showOverdrawInspector.get=function(){return!!this._showOverdrawInspector},o.showOverdrawInspector.set=function(c){this._showOverdrawInspector!==c&&(this._showOverdrawInspector=c,this._update())},o.repaint.get=function(){return!!this._repaint},o.repaint.set=function(c){this._repaint!==c&&(this._repaint=c,this.triggerRepaint())},o.vertices.get=function(){return!!this._vertices},o.vertices.set=function(c){this._vertices=c,this._update()},s.prototype._setCacheLimits=function(c,_){a.setCacheLimits(c,_)},o.version.get=function(){return a.version},Object.defineProperties(s.prototype,o),s}($s);function ko(n){n.parentNode&&n.parentNode.removeChild(n)}var nu={showCompass:!0,showZoom:!0,visualizePitch:!1},Da=function(n){var s=this;this.options=a.extend({},nu,n),this._container=T.create("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._container.addEventListener("contextmenu",function(o){return o.preventDefault()}),this.options.showZoom&&(a.bindAll(["_setButtonTitle","_updateZoomButtons"],this),this._zoomInButton=this._createButton("mapboxgl-ctrl-zoom-in",function(o){return s._map.zoomIn({},{originalEvent:o})}),T.create("span","mapboxgl-ctrl-icon",this._zoomInButton).setAttribute("aria-hidden",!0),this._zoomOutButton=this._createButton("mapboxgl-ctrl-zoom-out",function(o){return s._map.zoomOut({},{originalEvent:o})}),T.create("span","mapboxgl-ctrl-icon",this._zoomOutButton).setAttribute("aria-hidden",!0)),this.options.showCompass&&(a.bindAll(["_rotateCompassArrow"],this),this._compass=this._createButton("mapboxgl-ctrl-compass",function(o){s.options.visualizePitch?s._map.resetNorthPitch({},{originalEvent:o}):s._map.resetNorth({},{originalEvent:o})}),this._compassIcon=T.create("span","mapboxgl-ctrl-icon",this._compass),this._compassIcon.setAttribute("aria-hidden",!0))};Da.prototype._updateZoomButtons=function(){var n=this._map.getZoom(),s=n===this._map.getMaxZoom(),o=n===this._map.getMinZoom();this._zoomInButton.disabled=s,this._zoomOutButton.disabled=o,this._zoomInButton.setAttribute("aria-disabled",s.toString()),this._zoomOutButton.setAttribute("aria-disabled",o.toString())},Da.prototype._rotateCompassArrow=function(){var n=this.options.visualizePitch?"scale("+1/Math.pow(Math.cos(this._map.transform.pitch*(Math.PI/180)),.5)+") rotateX("+this._map.transform.pitch+"deg) rotateZ("+this._map.transform.angle*(180/Math.PI)+"deg)":"rotate("+this._map.transform.angle*(180/Math.PI)+"deg)";this._compassIcon.style.transform=n},Da.prototype.onAdd=function(n){return this._map=n,this.options.showZoom&&(this._setButtonTitle(this._zoomInButton,"ZoomIn"),this._setButtonTitle(this._zoomOutButton,"ZoomOut"),this._map.on("zoom",this._updateZoomButtons),this._updateZoomButtons()),this.options.showCompass&&(this._setButtonTitle(this._compass,"ResetBearing"),this.options.visualizePitch&&this._map.on("pitch",this._rotateCompassArrow),this._map.on("rotate",this._rotateCompassArrow),this._rotateCompassArrow(),this._handler=new Kn(this._map,this._compass,this.options.visualizePitch)),this._container},Da.prototype.onRemove=function(){T.remove(this._container),this.options.showZoom&&this._map.off("zoom",this._updateZoomButtons),this.options.showCompass&&(this.options.visualizePitch&&this._map.off("pitch",this._rotateCompassArrow),this._map.off("rotate",this._rotateCompassArrow),this._handler.off(),delete this._handler),delete this._map},Da.prototype._createButton=function(n,s){var o=T.create("button",n,this._container);return o.type="button",o.addEventListener("click",s),o},Da.prototype._setButtonTitle=function(n,s){var o=this._map._getUIString("NavigationControl."+s);n.title=o,n.setAttribute("aria-label",o)};var Kn=function(n,s,o){o===void 0&&(o=!1),this._clickTolerance=10,this.element=s,this.mouseRotate=new Ys({clickTolerance:n.dragRotate._mouseRotate._clickTolerance}),this.map=n,o&&(this.mousePitch=new eu({clickTolerance:n.dragRotate._mousePitch._clickTolerance})),a.bindAll(["mousedown","mousemove","mouseup","touchstart","touchmove","touchend","reset"],this),T.addEventListener(s,"mousedown",this.mousedown),T.addEventListener(s,"touchstart",this.touchstart,{passive:!1}),T.addEventListener(s,"touchmove",this.touchmove),T.addEventListener(s,"touchend",this.touchend),T.addEventListener(s,"touchcancel",this.reset)};function Go(n,s,o){if(n=new a.LngLat(n.lng,n.lat),s){var c=new a.LngLat(n.lng-360,n.lat),_=new a.LngLat(n.lng+360,n.lat),w=o.locationPoint(n).distSqr(s);o.locationPoint(c).distSqr(s)<w?n=c:o.locationPoint(_).distSqr(s)<w&&(n=_)}for(;Math.abs(n.lng-o.center.lng)>180;){var S=o.locationPoint(n);if(S.x>=0&&S.y>=0&&S.x<=o.width&&S.y<=o.height)break;n.lng>o.center.lng?n.lng-=360:n.lng+=360}return n}Kn.prototype.down=function(n,s){this.mouseRotate.mousedown(n,s),this.mousePitch&&this.mousePitch.mousedown(n,s),T.disableDrag()},Kn.prototype.move=function(n,s){var o=this.map,c=this.mouseRotate.mousemoveWindow(n,s);if(c&&c.bearingDelta&&o.setBearing(o.getBearing()+c.bearingDelta),this.mousePitch){var _=this.mousePitch.mousemoveWindow(n,s);_&&_.pitchDelta&&o.setPitch(o.getPitch()+_.pitchDelta)}},Kn.prototype.off=function(){var n=this.element;T.removeEventListener(n,"mousedown",this.mousedown),T.removeEventListener(n,"touchstart",this.touchstart,{passive:!1}),T.removeEventListener(n,"touchmove",this.touchmove),T.removeEventListener(n,"touchend",this.touchend),T.removeEventListener(n,"touchcancel",this.reset),this.offTemp()},Kn.prototype.offTemp=function(){T.enableDrag(),T.removeEventListener(a.window,"mousemove",this.mousemove),T.removeEventListener(a.window,"mouseup",this.mouseup)},Kn.prototype.mousedown=function(n){this.down(a.extend({},n,{ctrlKey:!0,preventDefault:function(){return n.preventDefault()}}),T.mousePos(this.element,n)),T.addEventListener(a.window,"mousemove",this.mousemove),T.addEventListener(a.window,"mouseup",this.mouseup)},Kn.prototype.mousemove=function(n){this.move(n,T.mousePos(this.element,n))},Kn.prototype.mouseup=function(n){this.mouseRotate.mouseupWindow(n),this.mousePitch&&this.mousePitch.mouseupWindow(n),this.offTemp()},Kn.prototype.touchstart=function(n){n.targetTouches.length!==1?this.reset():(this._startPos=this._lastPos=T.touchPos(this.element,n.targetTouches)[0],this.down({type:"mousedown",button:0,ctrlKey:!0,preventDefault:function(){return n.preventDefault()}},this._startPos))},Kn.prototype.touchmove=function(n){n.targetTouches.length!==1?this.reset():(this._lastPos=T.touchPos(this.element,n.targetTouches)[0],this.move({preventDefault:function(){return n.preventDefault()}},this._lastPos))},Kn.prototype.touchend=function(n){n.targetTouches.length===0&&this._startPos&&this._lastPos&&this._startPos.dist(this._lastPos)<this._clickTolerance&&this.element.click(),this.reset()},Kn.prototype.reset=function(){this.mouseRotate.reset(),this.mousePitch&&this.mousePitch.reset(),delete this._startPos,delete this._lastPos,this.offTemp()};var Ia={center:"translate(-50%,-50%)",top:"translate(-50%,0)","top-left":"translate(0,0)","top-right":"translate(-100%,0)",bottom:"translate(-50%,-100%)","bottom-left":"translate(0,-100%)","bottom-right":"translate(-100%,-100%)",left:"translate(0,-50%)",right:"translate(-100%,-50%)"};function tl(n,s,o){var c=n.classList;for(var _ in Ia)c.remove("mapboxgl-"+o+"-anchor-"+_);c.add("mapboxgl-"+o+"-anchor-"+s)}var Zo,xs=function(n){function s(o,c){if(n.call(this),(o instanceof a.window.HTMLElement||c)&&(o=a.extend({element:o},c)),a.bindAll(["_update","_onMove","_onUp","_addDragHandler","_onMapClick","_onKeyPress"],this),this._anchor=o&&o.anchor||"center",this._color=o&&o.color||"#3FB1CE",this._scale=o&&o.scale||1,this._draggable=o&&o.draggable||!1,this._clickTolerance=o&&o.clickTolerance||0,this._isDragging=!1,this._state="inactive",this._rotation=o&&o.rotation||0,this._rotationAlignment=o&&o.rotationAlignment||"auto",this._pitchAlignment=o&&o.pitchAlignment&&o.pitchAlignment!=="auto"?o.pitchAlignment:this._rotationAlignment,o&&o.element)this._element=o.element,this._offset=a.Point.convert(o&&o.offset||[0,0]);else{this._defaultMarker=!0,this._element=T.create("div"),this._element.setAttribute("aria-label","Map marker");var _=T.createNS("http://www.w3.org/2000/svg","svg");_.setAttributeNS(null,"display","block"),_.setAttributeNS(null,"height","41px"),_.setAttributeNS(null,"width","27px"),_.setAttributeNS(null,"viewBox","0 0 27 41");var w=T.createNS("http://www.w3.org/2000/svg","g");w.setAttributeNS(null,"stroke","none"),w.setAttributeNS(null,"stroke-width","1"),w.setAttributeNS(null,"fill","none"),w.setAttributeNS(null,"fill-rule","evenodd");var S=T.createNS("http://www.w3.org/2000/svg","g");S.setAttributeNS(null,"fill-rule","nonzero");var P=T.createNS("http://www.w3.org/2000/svg","g");P.setAttributeNS(null,"transform","translate(3.0, 29.0)"),P.setAttributeNS(null,"fill","#000000");for(var C=0,O=[{rx:"10.5",ry:"5.25002273"},{rx:"10.5",ry:"5.25002273"},{rx:"9.5",ry:"4.77275007"},{rx:"8.5",ry:"4.29549936"},{rx:"7.5",ry:"3.81822308"},{rx:"6.5",ry:"3.34094679"},{rx:"5.5",ry:"2.86367051"},{rx:"4.5",ry:"2.38636864"}];C<O.length;C+=1){var Z=O[C],K=T.createNS("http://www.w3.org/2000/svg","ellipse");K.setAttributeNS(null,"opacity","0.04"),K.setAttributeNS(null,"cx","10.5"),K.setAttributeNS(null,"cy","5.80029008"),K.setAttributeNS(null,"rx",Z.rx),K.setAttributeNS(null,"ry",Z.ry),P.appendChild(K)}var H=T.createNS("http://www.w3.org/2000/svg","g");H.setAttributeNS(null,"fill",this._color);var re=T.createNS("http://www.w3.org/2000/svg","path");re.setAttributeNS(null,"d","M27,13.5 C27,19.074644 20.250001,27.000002 14.75,34.500002 C14.016665,35.500004 12.983335,35.500004 12.25,34.500002 C6.7499993,27.000002 0,19.222562 0,13.5 C0,6.0441559 6.0441559,0 13.5,0 C20.955844,0 27,6.0441559 27,13.5 Z"),H.appendChild(re);var te=T.createNS("http://www.w3.org/2000/svg","g");te.setAttributeNS(null,"opacity","0.25"),te.setAttributeNS(null,"fill","#000000");var ce=T.createNS("http://www.w3.org/2000/svg","path");ce.setAttributeNS(null,"d","M13.5,0 C6.0441559,0 0,6.0441559 0,13.5 C0,19.222562 6.7499993,27 12.25,34.5 C13,35.522727 14.016664,35.500004 14.75,34.5 C20.250001,27 27,19.074644 27,13.5 C27,6.0441559 20.955844,0 13.5,0 Z M13.5,1 C20.415404,1 26,6.584596 26,13.5 C26,15.898657 24.495584,19.181431 22.220703,22.738281 C19.945823,26.295132 16.705119,30.142167 13.943359,33.908203 C13.743445,34.180814 13.612715,34.322738 13.5,34.441406 C13.387285,34.322738 13.256555,34.180814 13.056641,33.908203 C10.284481,30.127985 7.4148684,26.314159 5.015625,22.773438 C2.6163816,19.232715 1,15.953538 1,13.5 C1,6.584596 6.584596,1 13.5,1 Z"),te.appendChild(ce);var Y=T.createNS("http://www.w3.org/2000/svg","g");Y.setAttributeNS(null,"transform","translate(6.0, 7.0)"),Y.setAttributeNS(null,"fill","#FFFFFF");var se=T.createNS("http://www.w3.org/2000/svg","g");se.setAttributeNS(null,"transform","translate(8.0, 8.0)");var fe=T.createNS("http://www.w3.org/2000/svg","circle");fe.setAttributeNS(null,"fill","#000000"),fe.setAttributeNS(null,"opacity","0.25"),fe.setAttributeNS(null,"cx","5.5"),fe.setAttributeNS(null,"cy","5.5"),fe.setAttributeNS(null,"r","5.4999962");var ve=T.createNS("http://www.w3.org/2000/svg","circle");ve.setAttributeNS(null,"fill","#FFFFFF"),ve.setAttributeNS(null,"cx","5.5"),ve.setAttributeNS(null,"cy","5.5"),ve.setAttributeNS(null,"r","5.4999962"),se.appendChild(fe),se.appendChild(ve),S.appendChild(P),S.appendChild(H),S.appendChild(te),S.appendChild(Y),S.appendChild(se),_.appendChild(S),_.setAttributeNS(null,"height",41*this._scale+"px"),_.setAttributeNS(null,"width",27*this._scale+"px"),this._element.appendChild(_),this._offset=a.Point.convert(o&&o.offset||[0,-14])}this._element.classList.add("mapboxgl-marker"),this._element.addEventListener("dragstart",function(Ie){Ie.preventDefault()}),this._element.addEventListener("mousedown",function(Ie){Ie.preventDefault()}),tl(this._element,this._anchor,"marker"),this._popup=null}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype.addTo=function(o){return this.remove(),this._map=o,o.getCanvasContainer().appendChild(this._element),o.on("move",this._update),o.on("moveend",this._update),this.setDraggable(this._draggable),this._update(),this._map.on("click",this._onMapClick),this},s.prototype.remove=function(){return this._map&&(this._map.off("click",this._onMapClick),this._map.off("move",this._update),this._map.off("moveend",this._update),this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler),this._map.off("mouseup",this._onUp),this._map.off("touchend",this._onUp),this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),delete this._map),T.remove(this._element),this._popup&&this._popup.remove(),this},s.prototype.getLngLat=function(){return this._lngLat},s.prototype.setLngLat=function(o){return this._lngLat=a.LngLat.convert(o),this._pos=null,this._popup&&this._popup.setLngLat(this._lngLat),this._update(),this},s.prototype.getElement=function(){return this._element},s.prototype.setPopup=function(o){if(this._popup&&(this._popup.remove(),this._popup=null,this._element.removeEventListener("keypress",this._onKeyPress),this._originalTabIndex||this._element.removeAttribute("tabindex")),o){if(!("offset"in o.options)){var c=Math.sqrt(Math.pow(13.5,2)/2);o.options.offset=this._defaultMarker?{top:[0,0],"top-left":[0,0],"top-right":[0,0],bottom:[0,-38.1],"bottom-left":[c,-1*(24.6+c)],"bottom-right":[-c,-1*(24.6+c)],left:[13.5,-24.6],right:[-13.5,-24.6]}:this._offset}this._popup=o,this._lngLat&&this._popup.setLngLat(this._lngLat),this._originalTabIndex=this._element.getAttribute("tabindex"),this._originalTabIndex||this._element.setAttribute("tabindex","0"),this._element.addEventListener("keypress",this._onKeyPress)}return this},s.prototype._onKeyPress=function(o){var c=o.code,_=o.charCode||o.keyCode;c!=="Space"&&c!=="Enter"&&_!==32&&_!==13||this.togglePopup()},s.prototype._onMapClick=function(o){var c=o.originalEvent.target,_=this._element;this._popup&&(c===_||_.contains(c))&&this.togglePopup()},s.prototype.getPopup=function(){return this._popup},s.prototype.togglePopup=function(){var o=this._popup;return o?(o.isOpen()?o.remove():o.addTo(this._map),this):this},s.prototype._update=function(o){if(this._map){this._map.transform.renderWorldCopies&&(this._lngLat=Go(this._lngLat,this._pos,this._map.transform)),this._pos=this._map.project(this._lngLat)._add(this._offset);var c="";this._rotationAlignment==="viewport"||this._rotationAlignment==="auto"?c="rotateZ("+this._rotation+"deg)":this._rotationAlignment==="map"&&(c="rotateZ("+(this._rotation-this._map.getBearing())+"deg)");var _="";this._pitchAlignment==="viewport"||this._pitchAlignment==="auto"?_="rotateX(0deg)":this._pitchAlignment==="map"&&(_="rotateX("+this._map.getPitch()+"deg)"),o&&o.type!=="moveend"||(this._pos=this._pos.round()),T.setTransform(this._element,Ia[this._anchor]+" translate("+this._pos.x+"px, "+this._pos.y+"px) "+_+" "+c)}},s.prototype.getOffset=function(){return this._offset},s.prototype.setOffset=function(o){return this._offset=a.Point.convert(o),this._update(),this},s.prototype._onMove=function(o){if(!this._isDragging){var c=this._clickTolerance||this._map._clickTolerance;this._isDragging=o.point.dist(this._pointerdownPos)>=c}this._isDragging&&(this._pos=o.point.sub(this._positionDelta),this._lngLat=this._map.unproject(this._pos),this.setLngLat(this._lngLat),this._element.style.pointerEvents="none",this._state==="pending"&&(this._state="active",this.fire(new a.Event("dragstart"))),this.fire(new a.Event("drag")))},s.prototype._onUp=function(){this._element.style.pointerEvents="auto",this._positionDelta=null,this._pointerdownPos=null,this._isDragging=!1,this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),this._state==="active"&&this.fire(new a.Event("dragend")),this._state="inactive"},s.prototype._addDragHandler=function(o){this._element.contains(o.originalEvent.target)&&(o.preventDefault(),this._positionDelta=o.point.sub(this._pos).add(this._offset),this._pointerdownPos=o.point,this._state="pending",this._map.on("mousemove",this._onMove),this._map.on("touchmove",this._onMove),this._map.once("mouseup",this._onUp),this._map.once("touchend",this._onUp))},s.prototype.setDraggable=function(o){return this._draggable=!!o,this._map&&(o?(this._map.on("mousedown",this._addDragHandler),this._map.on("touchstart",this._addDragHandler)):(this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler))),this},s.prototype.isDraggable=function(){return this._draggable},s.prototype.setRotation=function(o){return this._rotation=o||0,this._update(),this},s.prototype.getRotation=function(){return this._rotation},s.prototype.setRotationAlignment=function(o){return this._rotationAlignment=o||"auto",this._update(),this},s.prototype.getRotationAlignment=function(){return this._rotationAlignment},s.prototype.setPitchAlignment=function(o){return this._pitchAlignment=o&&o!=="auto"?o:this._rotationAlignment,this._update(),this},s.prototype.getPitchAlignment=function(){return this._pitchAlignment},s}(a.Evented),au={positionOptions:{enableHighAccuracy:!1,maximumAge:0,timeout:6e3},fitBoundsOptions:{maxZoom:15},trackUserLocation:!1,showAccuracyCircle:!0,showUserLocation:!0},Ko=0,To=!1,ou=function(n){function s(o){n.call(this),this.options=a.extend({},au,o),a.bindAll(["_onSuccess","_onError","_onZoom","_finish","_setupUI","_updateCamera","_updateMarker"],this)}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype.onAdd=function(o){var c;return this._map=o,this._container=T.create("div","mapboxgl-ctrl mapboxgl-ctrl-group"),c=this._setupUI,Zo!==void 0?c(Zo):a.window.navigator.permissions!==void 0?a.window.navigator.permissions.query({name:"geolocation"}).then(function(_){c(Zo=_.state!=="denied")}):c(Zo=!!a.window.navigator.geolocation),this._container},s.prototype.onRemove=function(){this._geolocationWatchID!==void 0&&(a.window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0),this.options.showUserLocation&&this._userLocationDotMarker&&this._userLocationDotMarker.remove(),this.options.showAccuracyCircle&&this._accuracyCircleMarker&&this._accuracyCircleMarker.remove(),T.remove(this._container),this._map.off("zoom",this._onZoom),this._map=void 0,Ko=0,To=!1},s.prototype._isOutOfMapMaxBounds=function(o){var c=this._map.getMaxBounds(),_=o.coords;return c&&(_.longitude<c.getWest()||_.longitude>c.getEast()||_.latitude<c.getSouth()||_.latitude>c.getNorth())},s.prototype._setErrorState=function(){switch(this._watchState){case"WAITING_ACTIVE":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error");break;case"ACTIVE_LOCK":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting");break;case"BACKGROUND":this._watchState="BACKGROUND_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting")}},s.prototype._onSuccess=function(o){if(this._map){if(this._isOutOfMapMaxBounds(o))return this._setErrorState(),this.fire(new a.Event("outofmaxbounds",o)),this._updateMarker(),void this._finish();if(this.options.trackUserLocation)switch(this._lastKnownPosition=o,this._watchState){case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"BACKGROUND":case"BACKGROUND_ERROR":this._watchState="BACKGROUND",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background")}this.options.showUserLocation&&this._watchState!=="OFF"&&this._updateMarker(o),this.options.trackUserLocation&&this._watchState!=="ACTIVE_LOCK"||this._updateCamera(o),this.options.showUserLocation&&this._dotElement.classList.remove("mapboxgl-user-location-dot-stale"),this.fire(new a.Event("geolocate",o)),this._finish()}},s.prototype._updateCamera=function(o){var c=new a.LngLat(o.coords.longitude,o.coords.latitude),_=o.coords.accuracy,w=this._map.getBearing(),S=a.extend({bearing:w},this.options.fitBoundsOptions);this._map.fitBounds(c.toBounds(_),S,{geolocateSource:!0})},s.prototype._updateMarker=function(o){if(o){var c=new a.LngLat(o.coords.longitude,o.coords.latitude);this._accuracyCircleMarker.setLngLat(c).addTo(this._map),this._userLocationDotMarker.setLngLat(c).addTo(this._map),this._accuracy=o.coords.accuracy,this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}else this._userLocationDotMarker.remove(),this._accuracyCircleMarker.remove()},s.prototype._updateCircleRadius=function(){var o=this._map._container.clientHeight/2,c=this._map.unproject([0,o]),_=this._map.unproject([1,o]),w=c.distanceTo(_),S=Math.ceil(2*this._accuracy/w);this._circleElement.style.width=S+"px",this._circleElement.style.height=S+"px"},s.prototype._onZoom=function(){this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()},s.prototype._onError=function(o){if(this._map){if(this.options.trackUserLocation)if(o.code===1){this._watchState="OFF",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.disabled=!0;var c=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.title=c,this._geolocateButton.setAttribute("aria-label",c),this._geolocationWatchID!==void 0&&this._clearWatch()}else{if(o.code===3&&To)return;this._setErrorState()}this._watchState!=="OFF"&&this.options.showUserLocation&&this._dotElement.classList.add("mapboxgl-user-location-dot-stale"),this.fire(new a.Event("error",o)),this._finish()}},s.prototype._finish=function(){this._timeoutId&&clearTimeout(this._timeoutId),this._timeoutId=void 0},s.prototype._setupUI=function(o){var c=this;if(this._container.addEventListener("contextmenu",function(S){return S.preventDefault()}),this._geolocateButton=T.create("button","mapboxgl-ctrl-geolocate",this._container),T.create("span","mapboxgl-ctrl-icon",this._geolocateButton).setAttribute("aria-hidden",!0),this._geolocateButton.type="button",o===!1){a.warnOnce("Geolocation support is not available so the GeolocateControl will be disabled.");var _=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.disabled=!0,this._geolocateButton.title=_,this._geolocateButton.setAttribute("aria-label",_)}else{var w=this._map._getUIString("GeolocateControl.FindMyLocation");this._geolocateButton.title=w,this._geolocateButton.setAttribute("aria-label",w)}this.options.trackUserLocation&&(this._geolocateButton.setAttribute("aria-pressed","false"),this._watchState="OFF"),this.options.showUserLocation&&(this._dotElement=T.create("div","mapboxgl-user-location-dot"),this._userLocationDotMarker=new xs(this._dotElement),this._circleElement=T.create("div","mapboxgl-user-location-accuracy-circle"),this._accuracyCircleMarker=new xs({element:this._circleElement,pitchAlignment:"map"}),this.options.trackUserLocation&&(this._watchState="OFF"),this._map.on("zoom",this._onZoom)),this._geolocateButton.addEventListener("click",this.trigger.bind(this)),this._setup=!0,this.options.trackUserLocation&&this._map.on("movestart",function(S){S.geolocateSource||c._watchState!=="ACTIVE_LOCK"||S.originalEvent&&S.originalEvent.type==="resize"||(c._watchState="BACKGROUND",c._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background"),c._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),c.fire(new a.Event("trackuserlocationend")))})},s.prototype.trigger=function(){if(!this._setup)return a.warnOnce("Geolocate control triggered before added to a map"),!1;if(this.options.trackUserLocation){switch(this._watchState){case"OFF":this._watchState="WAITING_ACTIVE",this.fire(new a.Event("trackuserlocationstart"));break;case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":case"BACKGROUND_ERROR":Ko--,To=!1,this._watchState="OFF",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this.fire(new a.Event("trackuserlocationend"));break;case"BACKGROUND":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._lastKnownPosition&&this._updateCamera(this._lastKnownPosition),this.fire(new a.Event("trackuserlocationstart"))}switch(this._watchState){case"WAITING_ACTIVE":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"ACTIVE_LOCK":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"ACTIVE_ERROR":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error");break;case"BACKGROUND":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background");break;case"BACKGROUND_ERROR":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background-error")}if(this._watchState==="OFF"&&this._geolocationWatchID!==void 0)this._clearWatch();else if(this._geolocationWatchID===void 0){var o;this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","true"),++Ko>1?(o={maximumAge:6e5,timeout:0},To=!0):(o=this.options.positionOptions,To=!1),this._geolocationWatchID=a.window.navigator.geolocation.watchPosition(this._onSuccess,this._onError,o)}}else a.window.navigator.geolocation.getCurrentPosition(this._onSuccess,this._onError,this.options.positionOptions),this._timeoutId=setTimeout(this._finish,1e4);return!0},s.prototype._clearWatch=function(){a.window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0,this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","false"),this.options.showUserLocation&&this._updateMarker(null)},s}(a.Evented),Wa={maxWidth:100,unit:"metric"},Ya=function(n){this.options=a.extend({},Wa,n),a.bindAll(["_onMove","setUnit"],this)};function rl(n,s,o){var c=o&&o.maxWidth||100,_=n._container.clientHeight/2,w=n.unproject([0,_]),S=n.unproject([c,_]),P=w.distanceTo(S);if(o&&o.unit==="imperial"){var C=3.2808*P;C>5280?Ja(s,c,C/5280,n._getUIString("ScaleControl.Miles")):Ja(s,c,C,n._getUIString("ScaleControl.Feet"))}else o&&o.unit==="nautical"?Ja(s,c,P/1852,n._getUIString("ScaleControl.NauticalMiles")):P>=1e3?Ja(s,c,P/1e3,n._getUIString("ScaleControl.Kilometers")):Ja(s,c,P,n._getUIString("ScaleControl.Meters"))}function Ja(n,s,o,c){var _,w,S,P=(_=o,(w=Math.pow(10,(""+Math.floor(_)).length-1))*(S=(S=_/w)>=10?10:S>=5?5:S>=3?3:S>=2?2:S>=1?1:function(C){var O=Math.pow(10,Math.ceil(-Math.log(C)/Math.LN10));return Math.round(C*O)/O}(S)));n.style.width=s*(P/o)+"px",n.innerHTML=P+"&nbsp;"+c}Ya.prototype.getDefaultPosition=function(){return"bottom-left"},Ya.prototype._onMove=function(){rl(this._map,this._container,this.options)},Ya.prototype.onAdd=function(n){return this._map=n,this._container=T.create("div","mapboxgl-ctrl mapboxgl-ctrl-scale",n.getContainer()),this._map.on("move",this._onMove),this._onMove(),this._container},Ya.prototype.onRemove=function(){T.remove(this._container),this._map.off("move",this._onMove),this._map=void 0},Ya.prototype.setUnit=function(n){this.options.unit=n,rl(this._map,this._container,this.options)};var oa=function(n){this._fullscreen=!1,n&&n.container&&(n.container instanceof a.window.HTMLElement?this._container=n.container:a.warnOnce("Full screen control 'container' must be a DOM element.")),a.bindAll(["_onClickFullscreen","_changeIcon"],this),"onfullscreenchange"in a.window.document?this._fullscreenchange="fullscreenchange":"onmozfullscreenchange"in a.window.document?this._fullscreenchange="mozfullscreenchange":"onwebkitfullscreenchange"in a.window.document?this._fullscreenchange="webkitfullscreenchange":"onmsfullscreenchange"in a.window.document&&(this._fullscreenchange="MSFullscreenChange")};oa.prototype.onAdd=function(n){return this._map=n,this._container||(this._container=this._map.getContainer()),this._controlContainer=T.create("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._checkFullscreenSupport()?this._setupUI():(this._controlContainer.style.display="none",a.warnOnce("This device does not support fullscreen mode.")),this._controlContainer},oa.prototype.onRemove=function(){T.remove(this._controlContainer),this._map=null,a.window.document.removeEventListener(this._fullscreenchange,this._changeIcon)},oa.prototype._checkFullscreenSupport=function(){return!!(a.window.document.fullscreenEnabled||a.window.document.mozFullScreenEnabled||a.window.document.msFullscreenEnabled||a.window.document.webkitFullscreenEnabled)},oa.prototype._setupUI=function(){var n=this._fullscreenButton=T.create("button","mapboxgl-ctrl-fullscreen",this._controlContainer);T.create("span","mapboxgl-ctrl-icon",n).setAttribute("aria-hidden",!0),n.type="button",this._updateTitle(),this._fullscreenButton.addEventListener("click",this._onClickFullscreen),a.window.document.addEventListener(this._fullscreenchange,this._changeIcon)},oa.prototype._updateTitle=function(){var n=this._getTitle();this._fullscreenButton.setAttribute("aria-label",n),this._fullscreenButton.title=n},oa.prototype._getTitle=function(){return this._map._getUIString(this._isFullscreen()?"FullscreenControl.Exit":"FullscreenControl.Enter")},oa.prototype._isFullscreen=function(){return this._fullscreen},oa.prototype._changeIcon=function(){(a.window.document.fullscreenElement||a.window.document.mozFullScreenElement||a.window.document.webkitFullscreenElement||a.window.document.msFullscreenElement)===this._container!==this._fullscreen&&(this._fullscreen=!this._fullscreen,this._fullscreenButton.classList.toggle("mapboxgl-ctrl-shrink"),this._fullscreenButton.classList.toggle("mapboxgl-ctrl-fullscreen"),this._updateTitle())},oa.prototype._onClickFullscreen=function(){this._isFullscreen()?a.window.document.exitFullscreen?a.window.document.exitFullscreen():a.window.document.mozCancelFullScreen?a.window.document.mozCancelFullScreen():a.window.document.msExitFullscreen?a.window.document.msExitFullscreen():a.window.document.webkitCancelFullScreen&&a.window.document.webkitCancelFullScreen():this._container.requestFullscreen?this._container.requestFullscreen():this._container.mozRequestFullScreen?this._container.mozRequestFullScreen():this._container.msRequestFullscreen?this._container.msRequestFullscreen():this._container.webkitRequestFullscreen&&this._container.webkitRequestFullscreen()};var su={closeButton:!0,closeOnClick:!0,focusAfterOpen:!0,className:"",maxWidth:"240px"},ws=["a[href]","[tabindex]:not([tabindex='-1'])","[contenteditable]:not([contenteditable='false'])","button:not([disabled])","input:not([disabled])","select:not([disabled])","textarea:not([disabled])"].join(", "),lu=function(n){function s(o){n.call(this),this.options=a.extend(Object.create(su),o),a.bindAll(["_update","_onClose","remove","_onMouseMove","_onMouseUp","_onDrag"],this)}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype.addTo=function(o){return this._map&&this.remove(),this._map=o,this.options.closeOnClick&&this._map.on("click",this._onClose),this.options.closeOnMove&&this._map.on("move",this._onClose),this._map.on("remove",this.remove),this._update(),this._focusFirstElement(),this._trackPointer?(this._map.on("mousemove",this._onMouseMove),this._map.on("mouseup",this._onMouseUp),this._container&&this._container.classList.add("mapboxgl-popup-track-pointer"),this._map._canvasContainer.classList.add("mapboxgl-track-pointer")):this._map.on("move",this._update),this.fire(new a.Event("open")),this},s.prototype.isOpen=function(){return!!this._map},s.prototype.remove=function(){return this._content&&T.remove(this._content),this._container&&(T.remove(this._container),delete this._container),this._map&&(this._map.off("move",this._update),this._map.off("move",this._onClose),this._map.off("click",this._onClose),this._map.off("remove",this.remove),this._map.off("mousemove",this._onMouseMove),this._map.off("mouseup",this._onMouseUp),this._map.off("drag",this._onDrag),delete this._map),this.fire(new a.Event("close")),this},s.prototype.getLngLat=function(){return this._lngLat},s.prototype.setLngLat=function(o){return this._lngLat=a.LngLat.convert(o),this._pos=null,this._trackPointer=!1,this._update(),this._map&&(this._map.on("move",this._update),this._map.off("mousemove",this._onMouseMove),this._container&&this._container.classList.remove("mapboxgl-popup-track-pointer"),this._map._canvasContainer.classList.remove("mapboxgl-track-pointer")),this},s.prototype.trackPointer=function(){return this._trackPointer=!0,this._pos=null,this._update(),this._map&&(this._map.off("move",this._update),this._map.on("mousemove",this._onMouseMove),this._map.on("drag",this._onDrag),this._container&&this._container.classList.add("mapboxgl-popup-track-pointer"),this._map._canvasContainer.classList.add("mapboxgl-track-pointer")),this},s.prototype.getElement=function(){return this._container},s.prototype.setText=function(o){return this.setDOMContent(a.window.document.createTextNode(o))},s.prototype.setHTML=function(o){var c,_=a.window.document.createDocumentFragment(),w=a.window.document.createElement("body");for(w.innerHTML=o;c=w.firstChild;)_.appendChild(c);return this.setDOMContent(_)},s.prototype.getMaxWidth=function(){return this._container&&this._container.style.maxWidth},s.prototype.setMaxWidth=function(o){return this.options.maxWidth=o,this._update(),this},s.prototype.setDOMContent=function(o){if(this._content)for(;this._content.hasChildNodes();)this._content.firstChild&&this._content.removeChild(this._content.firstChild);else this._content=T.create("div","mapboxgl-popup-content",this._container);return this._content.appendChild(o),this._createCloseButton(),this._update(),this._focusFirstElement(),this},s.prototype.addClassName=function(o){this._container&&this._container.classList.add(o)},s.prototype.removeClassName=function(o){this._container&&this._container.classList.remove(o)},s.prototype.setOffset=function(o){return this.options.offset=o,this._update(),this},s.prototype.toggleClassName=function(o){if(this._container)return this._container.classList.toggle(o)},s.prototype._createCloseButton=function(){this.options.closeButton&&(this._closeButton=T.create("button","mapboxgl-popup-close-button",this._content),this._closeButton.type="button",this._closeButton.setAttribute("aria-label","Close popup"),this._closeButton.innerHTML="&#215;",this._closeButton.addEventListener("click",this._onClose))},s.prototype._onMouseUp=function(o){this._update(o.point)},s.prototype._onMouseMove=function(o){this._update(o.point)},s.prototype._onDrag=function(o){this._update(o.point)},s.prototype._update=function(o){var c=this;if(this._map&&(this._lngLat||this._trackPointer)&&this._content&&(this._container||(this._container=T.create("div","mapboxgl-popup",this._map.getContainer()),this._tip=T.create("div","mapboxgl-popup-tip",this._container),this._container.appendChild(this._content),this.options.className&&this.options.className.split(" ").forEach(function(K){return c._container.classList.add(K)}),this._trackPointer&&this._container.classList.add("mapboxgl-popup-track-pointer")),this.options.maxWidth&&this._container.style.maxWidth!==this.options.maxWidth&&(this._container.style.maxWidth=this.options.maxWidth),this._map.transform.renderWorldCopies&&!this._trackPointer&&(this._lngLat=Go(this._lngLat,this._pos,this._map.transform)),!this._trackPointer||o)){var _=this._pos=this._trackPointer&&o?o:this._map.project(this._lngLat),w=this.options.anchor,S=function K(H){if(H){if(typeof H=="number"){var re=Math.round(Math.sqrt(.5*Math.pow(H,2)));return{center:new a.Point(0,0),top:new a.Point(0,H),"top-left":new a.Point(re,re),"top-right":new a.Point(-re,re),bottom:new a.Point(0,-H),"bottom-left":new a.Point(re,-re),"bottom-right":new a.Point(-re,-re),left:new a.Point(H,0),right:new a.Point(-H,0)}}if(H instanceof a.Point||Array.isArray(H)){var te=a.Point.convert(H);return{center:te,top:te,"top-left":te,"top-right":te,bottom:te,"bottom-left":te,"bottom-right":te,left:te,right:te}}return{center:a.Point.convert(H.center||[0,0]),top:a.Point.convert(H.top||[0,0]),"top-left":a.Point.convert(H["top-left"]||[0,0]),"top-right":a.Point.convert(H["top-right"]||[0,0]),bottom:a.Point.convert(H.bottom||[0,0]),"bottom-left":a.Point.convert(H["bottom-left"]||[0,0]),"bottom-right":a.Point.convert(H["bottom-right"]||[0,0]),left:a.Point.convert(H.left||[0,0]),right:a.Point.convert(H.right||[0,0])}}return K(new a.Point(0,0))}(this.options.offset);if(!w){var P,C=this._container.offsetWidth,O=this._container.offsetHeight;P=_.y+S.bottom.y<O?["top"]:_.y>this._map.transform.height-O?["bottom"]:[],_.x<C/2?P.push("left"):_.x>this._map.transform.width-C/2&&P.push("right"),w=P.length===0?"bottom":P.join("-")}var Z=_.add(S[w]).round();T.setTransform(this._container,Ia[w]+" translate("+Z.x+"px,"+Z.y+"px)"),tl(this._container,w,"popup")}},s.prototype._focusFirstElement=function(){if(this.options.focusAfterOpen&&this._container){var o=this._container.querySelector(ws);o&&o.focus()}},s.prototype._onClose=function(){this.remove()},s}(a.Evented),il={version:a.version,supported:k,setRTLTextPlugin:a.setRTLTextPlugin,getRTLTextPluginStatus:a.getRTLTextPluginStatus,Map:Tc,NavigationControl:Da,GeolocateControl:ou,AttributionControl:vn,ScaleControl:Ya,FullscreenControl:oa,Popup:lu,Marker:xs,Style:Vn,LngLat:a.LngLat,LngLatBounds:a.LngLatBounds,Point:a.Point,MercatorCoordinate:a.MercatorCoordinate,Evented:a.Evented,config:a.config,prewarm:function(){Se().acquire(we)},clearPrewarmedResources:function(){var n=st;n&&(n.isPreloaded()&&n.numActive()===1?(n.release(we),st=null):console.warn("Could not clear WebWorkers since there are active Map instances that still reference it. The pre-warmed WebWorker pool can only be cleared when all map instances have been removed with map.remove()"))},get accessToken(){return a.config.ACCESS_TOKEN},set accessToken(n){a.config.ACCESS_TOKEN=n},get baseApiUrl(){return a.config.API_URL},set baseApiUrl(n){a.config.API_URL=n},get workerCount(){return De.workerCount},set workerCount(n){De.workerCount=n},get maxParallelImageRequests(){return a.config.MAX_PARALLEL_IMAGE_REQUESTS},set maxParallelImageRequests(n){a.config.MAX_PARALLEL_IMAGE_REQUESTS=n},clearStorage:function(n){a.clearTileCache(n)},workerUrl:""};return il}),y})})(cy);var vh=cy.exports;const X_=v_(vh);function Sd(l){let h;const d=l[15].default,p=Fu(d,l,l[14],null);return{c(){p&&p.c()},l(y){p&&p.l(y)},m(y,v){p&&p.m(y,v),h=!0},p(y,v){p&&p.p&&(!h||v&16384)&&Ou(p,d,y,y[14],h?Uu(d,y[14],v,null):Nu(y[14]),null)},i(y){h||(ot(p,y),h=!0)},o(y){ft(p,y),h=!1},d(y){p&&p.d(y)}}}function W_(l){let h,d,p,y=l[0]&&Sd(l);return{c(){h=Ue("div"),y&&y.c(),this.h()},l(v){h=Ve(v,"DIV",{class:!0,id:!0});var a=Be(h);y&&y.l(a),a.forEach(ne),this.h()},h(){ie(h,"class","absolute top-0 bg-grey4 w-full h-full svelte-a65d1y"),ie(h,"id",l[1]),Gu(()=>l[16].call(h))},m(v,a){Le(v,h,a),y&&y.m(h,null),d=Zu(h,l[16].bind(h)),l[17](h),p=!0},p(v,[a]){v[0]?y?(y.p(v,a),a&1&&ot(y,1)):(y=Sd(v),y.c(),ot(y,1),y.m(h,null)):y&&(Ln(),ft(y,1,1,()=>{y=null}),Rn()),(!p||a&2)&&ie(h,"id",v[1])},i(v){p||(ot(y),p=!0)},o(v){ft(y),p=!1},d(v){v&&ne(h),y&&y.d(),d(),l[17](null)}}}function Y_(l,h,d){let{$$slots:p={},$$scope:y}=h,{map:v}=h,{id:a="map"}=h,{location:k={bounds:[[-8.1775,54.02275],[-5.43279,55.31298]]}}=h,{style:T="https://raw.githubusercontent.com/NISRA-Tech-Lab/map_tiles/main/basemap_styles/style-omt.json"}=h,{interactive:F=!0}=h,{minzoom:M=0}=h,{maxzoom:N=14}=h,{zoom:R=null}=h,{scrollzoom:X=!0}=h,{geolocate:Q=!0}=h,{zoomcontrol:ae=!0}=h,{options:le={}}=h,de,ge;ay("map",{getMap:()=>v}),k.bounds?le={...le,bounds:k.bounds}:k.lon&&k.lat&&(le={...le,center:[k.lon,k.lat]},k.zoom&&(le.zoom=k.zoom)),Rp(()=>{const Ge=document.createElement("link");return Ge.rel="stylesheet",Ge.href="https://unpkg.com/mapbox-gl@1.13.0/dist/mapbox-gl.css",Ge.onload=()=>{d(0,v=new vh.Map({container:de,style:T,minZoom:M,maxZoom:N,maxBounds:[[-9.2,53.58],[-4.53,55.72]],interactive:F,...le})),ae&&v.addControl(new vh.NavigationControl({showCompass:!1})),X||v.scrollZoom.disable(),Q&&v.addControl(new vh.GeolocateControl),v.on("load",()=>{d(4,R=v.getZoom())}),v.on("zoom",()=>{d(4,R=v.getZoom())})},document.head.appendChild(Ge),()=>{v.remove(),Ge.parentNode.removeChild(Ge)}});function rt(){let Ge=document.getElementsByClassName("mapboxgl-canvas");Ge[0]&&(Ge[0].style.width="100%",v.resize())}function Fe(){ge=this.clientWidth,d(2,ge)}function ze(Ge){Bs[Ge?"unshift":"push"](()=>{de=Ge,d(3,de)})}return l.$$set=Ge=>{"map"in Ge&&d(0,v=Ge.map),"id"in Ge&&d(1,a=Ge.id),"location"in Ge&&d(6,k=Ge.location),"style"in Ge&&d(7,T=Ge.style),"interactive"in Ge&&d(8,F=Ge.interactive),"minzoom"in Ge&&d(9,M=Ge.minzoom),"maxzoom"in Ge&&d(10,N=Ge.maxzoom),"zoom"in Ge&&d(4,R=Ge.zoom),"scrollzoom"in Ge&&d(11,X=Ge.scrollzoom),"geolocate"in Ge&&d(12,Q=Ge.geolocate),"zoomcontrol"in Ge&&d(13,ae=Ge.zoomcontrol),"options"in Ge&&d(5,le=Ge.options),"$$scope"in Ge&&d(14,y=Ge.$$scope)},l.$$.update=()=>{l.$$.dirty&4&&ge&&rt()},[v,a,ge,de,R,le,k,T,F,M,N,X,Q,ae,y,p,Fe,ze]}class J_ extends an{constructor(h){super(),on(this,h,Y_,W_,sn,{map:0,id:1,location:6,style:7,interactive:8,minzoom:9,maxzoom:10,zoom:4,scrollzoom:11,geolocate:12,zoomcontrol:13,options:5})}}function Ed(l){let h;const d=l[11].default,p=Fu(d,l,l[10],null);return{c(){p&&p.c()},l(y){p&&p.l(y)},m(y,v){p&&p.m(y,v),h=!0},p(y,v){p&&p.p&&(!h||v&1024)&&Ou(p,d,y,y[10],h?Uu(d,y[10],v,null):Nu(y[10]),null)},i(y){h||(ot(p,y),h=!0)},o(y){ft(p,y),h=!1},d(y){p&&p.d(y)}}}function Q_(l){let h,d,p=l[0]&&Ed(l);return{c(){p&&p.c(),h=ir()},l(y){p&&p.l(y),h=ir()},m(y,v){p&&p.m(y,v),Le(y,h,v),d=!0},p(y,[v]){y[0]?p?(p.p(y,v),v&1&&ot(p,1)):(p=Ed(y),p.c(),ot(p,1),p.m(h.parentNode,h)):p&&(Ln(),ft(p,1,1,()=>{p=null}),Rn())},i(y){d||(ot(p),d=!0)},o(y){ft(p),d=!1},d(y){p&&p.d(y),y&&ne(h)}}}function $_(l,h,d){let{$$slots:p={},$$scope:y}=h,{id:v}=h,{type:a}=h,{url:k=null}=h,{props:T={}}=h,{data:F=null}=h,{layer:M=null}=h,{promoteId:N=null}=h,{minzoom:R=null}=h,{maxzoom:X=null}=h,Q=!1;const{getMap:ae}=Ku("map"),le=ae();le.getSource(v)&&le.removeSource(v);function de(){le.isSourceLoaded(v)?(d(0,Q=!0),console.log(v+" loaded!")):setTimeout(()=>{console.log("..."),de()},500)}function ge(){le.isStyleLoaded(v)?(rt(),document.querySelector("#map canvas")&&document.querySelector("#map canvas").tabIndex=="0"&&(document.querySelector("#map canvas").tabIndex="-1")):setTimeout(()=>{console.log("..."),ge()},500)}R&&(T.minzoom=R),X&&(T.maxzoom=X),M&&N?(T.promoteId={},T.promoteId[M]=N):N&&(T.promoteId=N);function rt(){console.log(v+" map source loading..."),a=="geojson"?F?(le.addSource(v,{type:a,data:F,...T}),de()):k&&(le.addSource(v,{type:a,data:k,...T}),de()):a=="vector"&&(le.addSource(v,{type:a,tiles:[k],...T}),de())}ge();function Fe(){le.getSource(v).setData(F)}return l.$$set=ze=>{"id"in ze&&d(2,v=ze.id),"type"in ze&&d(3,a=ze.type),"url"in ze&&d(4,k=ze.url),"props"in ze&&d(1,T=ze.props),"data"in ze&&d(5,F=ze.data),"layer"in ze&&d(6,M=ze.layer),"promoteId"in ze&&d(7,N=ze.promoteId),"minzoom"in ze&&d(8,R=ze.minzoom),"maxzoom"in ze&&d(9,X=ze.maxzoom),"$$scope"in ze&&d(10,y=ze.$$scope)},l.$$.update=()=>{l.$$.dirty&33&&Q&&F&&Fe()},[Q,T,v,a,k,F,M,N,R,X,y,p]}class ev extends an{constructor(h){super(),on(this,h,$_,Q_,sn,{id:2,type:3,url:4,props:1,data:5,layer:6,promoteId:7,minzoom:8,maxzoom:9})}}function tv(l,h,d){const{Popup:p}=X_,y=c_(),v=new p({closeButton:!1,closeOnClick:!1});let{id:a}=h,{source:k}=h,{sourceLayer:T=null}=h,{type:F}=h,{filter:M=null}=h,{layout:N={}}=h,{paint:R={}}=h,{data:X=null}=h,{code:Q=null}=h,{name:ae="name"}=h,{colorCode:le=null}=h,{click:de=!1}=h,{ignoreClick:ge=!1}=h,{clickCenter:rt=!1}=h,{selected:Fe=null}=h,{hover:ze=!1}=h,{hovered:Ge=null}=h,{highlight:zt=!1}=h,{highlightKey:wt="highlighted"}=h,{highlighted:je=[]}=h,{order:Ze=null}=h,{maxzoom:mt=null}=h,{minzoom:nr=null}=h,{isChild:qe=!1}=h;const{getMap:Bt}=Ku("map"),Re=Bt();let et=null,dt=null,qt=[];Re.getLayer(a)&&Re.removeLayer(a);let Mt={id:a,type:F,source:k,paint:R,layout:N};M&&(Mt.filter=M),T&&(Mt["source-layer"]=T),mt&&(Mt.maxzoom=mt),nr&&(Mt.minzoom=nr),Re.addLayer(Mt,Ze);function xt(){console.log("updating colors..."),X.forEach(Ae=>{Re.setFeatureState({source:k,sourceLayer:T,id:Ae[Q]},{color:Ae[le]})})}return de&&Re.on("click",a,Ae=>{if(Ae.features.length>0&&!ge){let at=Ae.features[0].id;if(qe&&je.includes(at)||!qe&&Fe!=at){if(d(0,Fe=at),y("select",{code:Fe}),et&&Re.setFeatureState({source:k,sourceLayer:T,id:et},{selected:!1}),Re.setFeatureState({source:k,sourceLayer:T,id:Fe},{selected:!0}),rt){let Mr=centroid(Ae.features[0].toJSON().geometry);Re.flyTo({center:Mr.geometry.coordinates})}d(24,et=Fe)}}}),ze&&(Re.on("mousemove",a,Ae=>{if(Ae.features.length>0){let at=Ae.features[0].id;Ge&&Re.setFeatureState({source:k,sourceLayer:T,id:Ge},{hovered:!1}),qe&&je.includes(at)||!qe&&Fe!=at?(d(1,Ge=d(25,dt=at)),Re.setFeatureState({source:k,sourceLayer:T,id:Ge},{hovered:!0}),Re.getCanvas().style.cursor="pointer",v.setLngLat(Ae.lngLat).setHTML(`<strong>${Ae.features[0].properties[ae]?Ae.features[0].properties[ae]:Ae.features[0].properties[Q]}</strong>`).addTo(Re)):v.remove()}}),Re.on("mouseleave",a,Ae=>{Ge&&Re.setFeatureState({source:k,sourceLayer:T,id:Ge},{hovered:!1}),d(1,Ge=d(25,dt=null)),Re.getCanvas().style.cursor="",v.remove()})),l.$$set=Ae=>{"id"in Ae&&d(2,a=Ae.id),"source"in Ae&&d(3,k=Ae.source),"sourceLayer"in Ae&&d(4,T=Ae.sourceLayer),"type"in Ae&&d(5,F=Ae.type),"filter"in Ae&&d(6,M=Ae.filter),"layout"in Ae&&d(7,N=Ae.layout),"paint"in Ae&&d(8,R=Ae.paint),"data"in Ae&&d(9,X=Ae.data),"code"in Ae&&d(10,Q=Ae.code),"name"in Ae&&d(11,ae=Ae.name),"colorCode"in Ae&&d(12,le=Ae.colorCode),"click"in Ae&&d(13,de=Ae.click),"ignoreClick"in Ae&&d(14,ge=Ae.ignoreClick),"clickCenter"in Ae&&d(15,rt=Ae.clickCenter),"selected"in Ae&&d(0,Fe=Ae.selected),"hover"in Ae&&d(16,ze=Ae.hover),"hovered"in Ae&&d(1,Ge=Ae.hovered),"highlight"in Ae&&d(17,zt=Ae.highlight),"highlightKey"in Ae&&d(18,wt=Ae.highlightKey),"highlighted"in Ae&&d(19,je=Ae.highlighted),"order"in Ae&&d(20,Ze=Ae.order),"maxzoom"in Ae&&d(21,mt=Ae.maxzoom),"minzoom"in Ae&&d(22,nr=Ae.minzoom),"isChild"in Ae&&d(23,qe=Ae.isChild)},l.$$.update=()=>{l.$$.dirty[0]&4096&&le&&xt(),l.$$.dirty[0]&68026392&&zt&&je!=qt&&(qt[0]&&qt.forEach(Ae=>{let at={};at[wt]=!1,Re.setFeatureState({source:k,sourceLayer:T,id:Ae},at)}),d(26,qt=je),je[0]&&je.forEach(Ae=>{let at={};at[wt]=!0,Re.setFeatureState({source:k,sourceLayer:T,id:Ae},at)})),l.$$.dirty[0]&16777241&&Fe!=et&&(et&&Re.setFeatureState({source:k,sourceLayer:T,id:et},{selected:!1}),Fe&&Re.setFeatureState({source:k,sourceLayer:T,id:Fe},{selected:!0}),d(24,et=Fe)),l.$$.dirty[0]&33619994&&ze&&Ge!=dt&&(dt&&Re.setFeatureState({source:k,sourceLayer:T,id:dt},{hovered:!1}),Ge&&Re.setFeatureState({source:k,sourceLayer:T,id:Ge},{hovered:!0}),d(25,dt=Ge))},[Fe,Ge,a,k,T,F,M,N,R,X,Q,ae,le,de,ge,rt,ze,zt,wt,je,Ze,mt,nr,qe,et,dt,qt]}class Sp extends an{constructor(h){super(),on(this,h,tv,null,sn,{id:2,source:3,sourceLayer:4,type:5,filter:6,layout:7,paint:8,data:9,code:10,name:11,colorCode:12,click:13,ignoreClick:14,clickCenter:15,selected:0,hover:16,hovered:1,highlight:17,highlightKey:18,highlighted:19,order:20,maxzoom:21,minzoom:22,isChild:23},null,[-1,-1])}}function rv(l){return l===0?!0:l}function es(l){return rv(l)?Array.isArray(l)?h=>l.map(d=>typeof d!="function"?h[d]:d(h)):typeof l!="function"?h=>h[l]:l:null}function iv(l){const h={};for(const d of l){if(Object(d)!==d)throw new TypeError("iterable for fromEntries should yield objects");const{"0":p,"1":y}=d;Object.defineProperty(h,p,{configurable:!0,enumerable:!0,writable:!0,value:y})}return h}function Ep(l,h={}){return iv(Object.entries(l).filter(([d,p])=>p!==void 0&&h[d]===void 0))}function nv(l,h){if(!Array.isArray(l))throw new TypeError(`The first argument of calcExtents() must be an array. You passed in a ${typeof l}. Consider passing a flat array to the \`flatData\` prop. More info: https://layercake.graphics/guide/#flatdata`);if(Array.isArray(h)||h===void 0||h===null)throw new TypeError("The second argument of calcExtents() must be an object with field names as keys as accessor functions as values.");const d={},p=Object.keys(h),y=p.length;let v,a,k,T,F,M,N,R;const X=l.length;for(v=0;v<y;v+=1){for(T=p[v],N=h[T],F=null,M=null,a=0;a<X;a+=1)if(R=N(l[a]),Array.isArray(R)){const Q=R.length;for(k=0;k<Q;k+=1)R[k]!==void 0&&R[k]!==null&&Number.isNaN(R[k])===!1&&((F===null||R[k]<F)&&(F=R[k]),(M===null||R[k]>M)&&(M=R[k]))}else R!=null&&Number.isNaN(R)===!1&&((F===null||R<F)&&(F=R),(M===null||R>M)&&(M=R));d[T]=[F,M]}return d}function hy(l=[],h){return Array.isArray(h)===!0?h.map((d,p)=>d===null?l[p]:d):l}function oh(l){return function([d,p]){return d?hy(d[l],p):p}}function bh(l,h){return l==null||h==null?NaN:l<h?-1:l>h?1:l>=h?0:NaN}function av(l,h){return l==null||h==null?NaN:h<l?-1:h>l?1:h>=l?0:NaN}function py(l){let h,d,p;l.length!==2?(h=bh,d=(k,T)=>bh(l(k),T),p=(k,T)=>l(k)-T):(h=l===bh||l===av?l:ov,d=l,p=l);function y(k,T,F=0,M=k.length){if(F<M){if(h(T,T)!==0)return M;do{const N=F+M>>>1;d(k[N],T)<0?F=N+1:M=N}while(F<M)}return F}function v(k,T,F=0,M=k.length){if(F<M){if(h(T,T)!==0)return M;do{const N=F+M>>>1;d(k[N],T)<=0?F=N+1:M=N}while(F<M)}return F}function a(k,T,F=0,M=k.length){const N=y(k,T,F,M-1);return N>F&&p(k[N-1],T)>-p(k[N],T)?N-1:N}return{left:y,center:a,right:v}}function ov(){return 0}function sv(l){return l===null?NaN:+l}const lv=py(bh),uv=lv.right;py(sv).center;const cv=uv;class kd extends Map{constructor(h,d=fv){if(super(),Object.defineProperties(this,{_intern:{value:new Map},_key:{value:d}}),h!=null)for(const[p,y]of h)this.set(p,y)}get(h){return super.get(Td(this,h))}has(h){return super.has(Td(this,h))}set(h,d){return super.set(hv(this,h),d)}delete(h){return super.delete(pv(this,h))}}function Td({_intern:l,_key:h},d){const p=h(d);return l.has(p)?l.get(p):d}function hv({_intern:l,_key:h},d){const p=h(d);return l.has(p)?l.get(p):(l.set(p,d),d)}function pv({_intern:l,_key:h},d){const p=h(d);return l.has(p)&&(d=l.get(p),l.delete(p)),d}function fv(l){return l!==null&&typeof l=="object"?l.valueOf():l}var zp=Math.sqrt(50),Ap=Math.sqrt(10),Cp=Math.sqrt(2);function dv(l,h,d){var p,y=-1,v,a,k;if(h=+h,l=+l,d=+d,l===h&&d>0)return[l];if((p=h<l)&&(v=l,l=h,h=v),(k=fy(l,h,d))===0||!isFinite(k))return[];if(k>0){let T=Math.round(l/k),F=Math.round(h/k);for(T*k<l&&++T,F*k>h&&--F,a=new Array(v=F-T+1);++y<v;)a[y]=(T+y)*k}else{k=-k;let T=Math.round(l*k),F=Math.round(h*k);for(T/k<l&&++T,F/k>h&&--F,a=new Array(v=F-T+1);++y<v;)a[y]=(T+y)/k}return p&&a.reverse(),a}function fy(l,h,d){var p=(h-l)/Math.max(0,d),y=Math.floor(Math.log(p)/Math.LN10),v=p/Math.pow(10,y);return y>=0?(v>=zp?10:v>=Ap?5:v>=Cp?2:1)*Math.pow(10,y):-Math.pow(10,-y)/(v>=zp?10:v>=Ap?5:v>=Cp?2:1)}function mv(l,h,d){var p=Math.abs(h-l)/Math.max(0,d),y=Math.pow(10,Math.floor(Math.log(p)/Math.LN10)),v=p/y;return v>=zp?y*=10:v>=Ap?y*=5:v>=Cp&&(y*=2),h<l?-y:y}function yv(l,h,d){l=+l,h=+h,d=(y=arguments.length)<2?(h=l,l=0,1):y<3?1:+d;for(var p=-1,y=Math.max(0,Math.ceil((h-l)/d))|0,v=new Array(y);++p<y;)v[p]=l+p*d;return v}function Dh(l,h){switch(arguments.length){case 0:break;case 1:this.range(l);break;default:this.range(h).domain(l);break}return this}const Id=Symbol("implicit");function dy(){var l=new kd,h=[],d=[],p=Id;function y(v){let a=l.get(v);if(a===void 0){if(p!==Id)return p;l.set(v,a=h.push(v)-1)}return d[a%d.length]}return y.domain=function(v){if(!arguments.length)return h.slice();h=[],l=new kd;for(const a of v)l.has(a)||l.set(a,h.push(a)-1);return y},y.range=function(v){return arguments.length?(d=Array.from(v),y):d.slice()},y.unknown=function(v){return arguments.length?(p=v,y):p},y.copy=function(){return dy(h,d).unknown(p)},Dh.apply(y,arguments),y}function my(){var l=dy().unknown(void 0),h=l.domain,d=l.range,p=0,y=1,v,a,k=!1,T=0,F=0,M=.5;delete l.unknown;function N(){var R=h().length,X=y<p,Q=X?y:p,ae=X?p:y;v=(ae-Q)/Math.max(1,R-T+F*2),k&&(v=Math.floor(v)),Q+=(ae-Q-v*(R-T))*M,a=v*(1-T),k&&(Q=Math.round(Q),a=Math.round(a));var le=yv(R).map(function(de){return Q+v*de});return d(X?le.reverse():le)}return l.domain=function(R){return arguments.length?(h(R),N()):h()},l.range=function(R){return arguments.length?([p,y]=R,p=+p,y=+y,N()):[p,y]},l.rangeRound=function(R){return[p,y]=R,p=+p,y=+y,k=!0,N()},l.bandwidth=function(){return a},l.step=function(){return v},l.round=function(R){return arguments.length?(k=!!R,N()):k},l.padding=function(R){return arguments.length?(T=Math.min(1,F=+R),N()):T},l.paddingInner=function(R){return arguments.length?(T=Math.min(1,R),N()):T},l.paddingOuter=function(R){return arguments.length?(F=+R,N()):F},l.align=function(R){return arguments.length?(M=Math.max(0,Math.min(1,R)),N()):M},l.copy=function(){return my(h(),[p,y]).round(k).paddingInner(T).paddingOuter(F).align(M)},Dh.apply(N(),arguments)}function Vp(l,h,d){l.prototype=h.prototype=d,d.constructor=l}function yy(l,h){var d=Object.create(l.prototype);for(var p in h)d[p]=h[p];return d}function ec(){}var Vu=.7,Eh=1/Vu,Ll="\\s*([+-]?\\d+)\\s*",qu="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",lo="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",gv=/^#([0-9a-f]{3,8})$/,_v=new RegExp(`^rgb\\(${Ll},${Ll},${Ll}\\)$`),vv=new RegExp(`^rgb\\(${lo},${lo},${lo}\\)$`),bv=new RegExp(`^rgba\\(${Ll},${Ll},${Ll},${qu}\\)$`),xv=new RegExp(`^rgba\\(${lo},${lo},${lo},${qu}\\)$`),wv=new RegExp(`^hsl\\(${qu},${lo},${lo}\\)$`),Sv=new RegExp(`^hsla\\(${qu},${lo},${lo},${qu}\\)$`),Pd={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};Vp(ec,ju,{copy(l){return Object.assign(new this.constructor,this,l)},displayable(){return this.rgb().displayable()},hex:zd,formatHex:zd,formatHex8:Ev,formatHsl:kv,formatRgb:Ad,toString:Ad});function zd(){return this.rgb().formatHex()}function Ev(){return this.rgb().formatHex8()}function kv(){return gy(this).formatHsl()}function Ad(){return this.rgb().formatRgb()}function ju(l){var h,d;return l=(l+"").trim().toLowerCase(),(h=gv.exec(l))?(d=h[1].length,h=parseInt(h[1],16),d===6?Cd(h):d===3?new ha(h>>8&15|h>>4&240,h>>4&15|h&240,(h&15)<<4|h&15,1):d===8?sh(h>>24&255,h>>16&255,h>>8&255,(h&255)/255):d===4?sh(h>>12&15|h>>8&240,h>>8&15|h>>4&240,h>>4&15|h&240,((h&15)<<4|h&15)/255):null):(h=_v.exec(l))?new ha(h[1],h[2],h[3],1):(h=vv.exec(l))?new ha(h[1]*255/100,h[2]*255/100,h[3]*255/100,1):(h=bv.exec(l))?sh(h[1],h[2],h[3],h[4]):(h=xv.exec(l))?sh(h[1]*255/100,h[2]*255/100,h[3]*255/100,h[4]):(h=wv.exec(l))?Ld(h[1],h[2]/100,h[3]/100,1):(h=Sv.exec(l))?Ld(h[1],h[2]/100,h[3]/100,h[4]):Pd.hasOwnProperty(l)?Cd(Pd[l]):l==="transparent"?new ha(NaN,NaN,NaN,0):null}function Cd(l){return new ha(l>>16&255,l>>8&255,l&255,1)}function sh(l,h,d,p){return p<=0&&(l=h=d=NaN),new ha(l,h,d,p)}function Tv(l){return l instanceof ec||(l=ju(l)),l?(l=l.rgb(),new ha(l.r,l.g,l.b,l.opacity)):new ha}function Mp(l,h,d,p){return arguments.length===1?Tv(l):new ha(l,h,d,p??1)}function ha(l,h,d,p){this.r=+l,this.g=+h,this.b=+d,this.opacity=+p}Vp(ha,Mp,yy(ec,{brighter(l){return l=l==null?Eh:Math.pow(Eh,l),new ha(this.r*l,this.g*l,this.b*l,this.opacity)},darker(l){return l=l==null?Vu:Math.pow(Vu,l),new ha(this.r*l,this.g*l,this.b*l,this.opacity)},rgb(){return this},clamp(){return new ha(Rs(this.r),Rs(this.g),Rs(this.b),kh(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:Md,formatHex:Md,formatHex8:Iv,formatRgb:Dd,toString:Dd}));function Md(){return`#${Ls(this.r)}${Ls(this.g)}${Ls(this.b)}`}function Iv(){return`#${Ls(this.r)}${Ls(this.g)}${Ls(this.b)}${Ls((isNaN(this.opacity)?1:this.opacity)*255)}`}function Dd(){const l=kh(this.opacity);return`${l===1?"rgb(":"rgba("}${Rs(this.r)}, ${Rs(this.g)}, ${Rs(this.b)}${l===1?")":`, ${l})`}`}function kh(l){return isNaN(l)?1:Math.max(0,Math.min(1,l))}function Rs(l){return Math.max(0,Math.min(255,Math.round(l)||0))}function Ls(l){return l=Rs(l),(l<16?"0":"")+l.toString(16)}function Ld(l,h,d,p){return p<=0?l=h=d=NaN:d<=0||d>=1?l=h=NaN:h<=0&&(l=NaN),new Oa(l,h,d,p)}function gy(l){if(l instanceof Oa)return new Oa(l.h,l.s,l.l,l.opacity);if(l instanceof ec||(l=ju(l)),!l)return new Oa;if(l instanceof Oa)return l;l=l.rgb();var h=l.r/255,d=l.g/255,p=l.b/255,y=Math.min(h,d,p),v=Math.max(h,d,p),a=NaN,k=v-y,T=(v+y)/2;return k?(h===v?a=(d-p)/k+(d<p)*6:d===v?a=(p-h)/k+2:a=(h-d)/k+4,k/=T<.5?v+y:2-v-y,a*=60):k=T>0&&T<1?0:a,new Oa(a,k,T,l.opacity)}function Pv(l,h,d,p){return arguments.length===1?gy(l):new Oa(l,h,d,p??1)}function Oa(l,h,d,p){this.h=+l,this.s=+h,this.l=+d,this.opacity=+p}Vp(Oa,Pv,yy(ec,{brighter(l){return l=l==null?Eh:Math.pow(Eh,l),new Oa(this.h,this.s,this.l*l,this.opacity)},darker(l){return l=l==null?Vu:Math.pow(Vu,l),new Oa(this.h,this.s,this.l*l,this.opacity)},rgb(){var l=this.h%360+(this.h<0)*360,h=isNaN(l)||isNaN(this.s)?0:this.s,d=this.l,p=d+(d<.5?d:1-d)*h,y=2*d-p;return new ha(kp(l>=240?l-240:l+120,y,p),kp(l,y,p),kp(l<120?l+240:l-120,y,p),this.opacity)},clamp(){return new Oa(Rd(this.h),lh(this.s),lh(this.l),kh(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){const l=kh(this.opacity);return`${l===1?"hsl(":"hsla("}${Rd(this.h)}, ${lh(this.s)*100}%, ${lh(this.l)*100}%${l===1?")":`, ${l})`}`}}));function Rd(l){return l=(l||0)%360,l<0?l+360:l}function lh(l){return Math.max(0,Math.min(1,l||0))}function kp(l,h,d){return(l<60?h+(d-h)*l/60:l<180?d:l<240?h+(d-h)*(240-l)/60:h)*255}const qp=l=>()=>l;function zv(l,h){return function(d){return l+d*h}}function Av(l,h,d){return l=Math.pow(l,d),h=Math.pow(h,d)-l,d=1/d,function(p){return Math.pow(l+p*h,d)}}function Cv(l){return(l=+l)==1?_y:function(h,d){return d-h?Av(h,d,l):qp(isNaN(h)?d:h)}}function _y(l,h){var d=h-l;return d?zv(l,d):qp(isNaN(l)?h:l)}const Bd=function l(h){var d=Cv(h);function p(y,v){var a=d((y=Mp(y)).r,(v=Mp(v)).r),k=d(y.g,v.g),T=d(y.b,v.b),F=_y(y.opacity,v.opacity);return function(M){return y.r=a(M),y.g=k(M),y.b=T(M),y.opacity=F(M),y+""}}return p.gamma=l,p}(1);function Mv(l,h){h||(h=[]);var d=l?Math.min(h.length,l.length):0,p=h.slice(),y;return function(v){for(y=0;y<d;++y)p[y]=l[y]*(1-v)+h[y]*v;return p}}function Dv(l){return ArrayBuffer.isView(l)&&!(l instanceof DataView)}function Lv(l,h){var d=h?h.length:0,p=l?Math.min(d,l.length):0,y=new Array(p),v=new Array(d),a;for(a=0;a<p;++a)y[a]=jp(l[a],h[a]);for(;a<d;++a)v[a]=h[a];return function(k){for(a=0;a<p;++a)v[a]=y[a](k);return v}}function Rv(l,h){var d=new Date;return l=+l,h=+h,function(p){return d.setTime(l*(1-p)+h*p),d}}function Th(l,h){return l=+l,h=+h,function(d){return l*(1-d)+h*d}}function Bv(l,h){var d={},p={},y;(l===null||typeof l!="object")&&(l={}),(h===null||typeof h!="object")&&(h={});for(y in h)y in l?d[y]=jp(l[y],h[y]):p[y]=h[y];return function(v){for(y in d)p[y]=d[y](v);return p}}var Dp=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,Tp=new RegExp(Dp.source,"g");function Fv(l){return function(){return l}}function Ov(l){return function(h){return l(h)+""}}function Nv(l,h){var d=Dp.lastIndex=Tp.lastIndex=0,p,y,v,a=-1,k=[],T=[];for(l=l+"",h=h+"";(p=Dp.exec(l))&&(y=Tp.exec(h));)(v=y.index)>d&&(v=h.slice(d,v),k[a]?k[a]+=v:k[++a]=v),(p=p[0])===(y=y[0])?k[a]?k[a]+=y:k[++a]=y:(k[++a]=null,T.push({i:a,x:Th(p,y)})),d=Tp.lastIndex;return d<h.length&&(v=h.slice(d),k[a]?k[a]+=v:k[++a]=v),k.length<2?T[0]?Ov(T[0].x):Fv(h):(h=T.length,function(F){for(var M=0,N;M<h;++M)k[(N=T[M]).i]=N.x(F);return k.join("")})}function jp(l,h){var d=typeof h,p;return h==null||d==="boolean"?qp(h):(d==="number"?Th:d==="string"?(p=ju(h))?(h=p,Bd):Nv:h instanceof ju?Bd:h instanceof Date?Rv:Dv(h)?Mv:Array.isArray(h)?Lv:typeof h.valueOf!="function"&&typeof h.toString!="function"||isNaN(h)?Bv:Th)(l,h)}function Uv(l,h){return l=+l,h=+h,function(d){return Math.round(l*(1-d)+h*d)}}function Vv(l){return function(){return l}}function qv(l){return+l}var Fd=[0,1];function so(l){return l}function Lp(l,h){return(h-=l=+l)?function(d){return(d-l)/h}:Vv(isNaN(h)?NaN:.5)}function jv(l,h){var d;return l>h&&(d=l,l=h,h=d),function(p){return Math.max(l,Math.min(h,p))}}function Gv(l,h,d){var p=l[0],y=l[1],v=h[0],a=h[1];return y<p?(p=Lp(y,p),v=d(a,v)):(p=Lp(p,y),v=d(v,a)),function(k){return v(p(k))}}function Zv(l,h,d){var p=Math.min(l.length,h.length)-1,y=new Array(p),v=new Array(p),a=-1;for(l[p]<l[0]&&(l=l.slice().reverse(),h=h.slice().reverse());++a<p;)y[a]=Lp(l[a],l[a+1]),v[a]=d(h[a],h[a+1]);return function(k){var T=cv(l,k,1,p)-1;return v[T](y[T](k))}}function vy(l,h){return h.domain(l.domain()).range(l.range()).interpolate(l.interpolate()).clamp(l.clamp()).unknown(l.unknown())}function by(){var l=Fd,h=Fd,d=jp,p,y,v,a=so,k,T,F;function M(){var R=Math.min(l.length,h.length);return a!==so&&(a=jv(l[0],l[R-1])),k=R>2?Zv:Gv,T=F=null,N}function N(R){return R==null||isNaN(R=+R)?v:(T||(T=k(l.map(p),h,d)))(p(a(R)))}return N.invert=function(R){return a(y((F||(F=k(h,l.map(p),Th)))(R)))},N.domain=function(R){return arguments.length?(l=Array.from(R,qv),M()):l.slice()},N.range=function(R){return arguments.length?(h=Array.from(R),M()):h.slice()},N.rangeRound=function(R){return h=Array.from(R),d=Uv,M()},N.clamp=function(R){return arguments.length?(a=R?!0:so,M()):a!==so},N.interpolate=function(R){return arguments.length?(d=R,M()):d},N.unknown=function(R){return arguments.length?(v=R,N):v},function(R,X){return p=R,y=X,M()}}function Kv(){return by()(so,so)}function Hv(l){return Math.abs(l=Math.round(l))>=1e21?l.toLocaleString("en").replace(/,/g,""):l.toString(10)}function Ih(l,h){if((d=(l=h?l.toExponential(h-1):l.toExponential()).indexOf("e"))<0)return null;var d,p=l.slice(0,d);return[p.length>1?p[0]+p.slice(2):p,+l.slice(d+1)]}function Rl(l){return l=Ih(Math.abs(l)),l?l[1]:NaN}function Xv(l,h){return function(d,p){for(var y=d.length,v=[],a=0,k=l[0],T=0;y>0&&k>0&&(T+k+1>p&&(k=Math.max(1,p-T)),v.push(d.substring(y-=k,y+k)),!((T+=k+1)>p));)k=l[a=(a+1)%l.length];return v.reverse().join(h)}}function Wv(l){return function(h){return h.replace(/[0-9]/g,function(d){return l[+d]})}}var Yv=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function Ph(l){if(!(h=Yv.exec(l)))throw new Error("invalid format: "+l);var h;return new Gp({fill:h[1],align:h[2],sign:h[3],symbol:h[4],zero:h[5],width:h[6],comma:h[7],precision:h[8]&&h[8].slice(1),trim:h[9],type:h[10]})}Ph.prototype=Gp.prototype;function Gp(l){this.fill=l.fill===void 0?" ":l.fill+"",this.align=l.align===void 0?">":l.align+"",this.sign=l.sign===void 0?"-":l.sign+"",this.symbol=l.symbol===void 0?"":l.symbol+"",this.zero=!!l.zero,this.width=l.width===void 0?void 0:+l.width,this.comma=!!l.comma,this.precision=l.precision===void 0?void 0:+l.precision,this.trim=!!l.trim,this.type=l.type===void 0?"":l.type+""}Gp.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(this.width===void 0?"":Math.max(1,this.width|0))+(this.comma?",":"")+(this.precision===void 0?"":"."+Math.max(0,this.precision|0))+(this.trim?"~":"")+this.type};function Jv(l){e:for(var h=l.length,d=1,p=-1,y;d<h;++d)switch(l[d]){case".":p=y=d;break;case"0":p===0&&(p=d),y=d;break;default:if(!+l[d])break e;p>0&&(p=0);break}return p>0?l.slice(0,p)+l.slice(y+1):l}var xy;function Qv(l,h){var d=Ih(l,h);if(!d)return l+"";var p=d[0],y=d[1],v=y-(xy=Math.max(-8,Math.min(8,Math.floor(y/3)))*3)+1,a=p.length;return v===a?p:v>a?p+new Array(v-a+1).join("0"):v>0?p.slice(0,v)+"."+p.slice(v):"0."+new Array(1-v).join("0")+Ih(l,Math.max(0,h+v-1))[0]}function Od(l,h){var d=Ih(l,h);if(!d)return l+"";var p=d[0],y=d[1];return y<0?"0."+new Array(-y).join("0")+p:p.length>y+1?p.slice(0,y+1)+"."+p.slice(y+1):p+new Array(y-p.length+2).join("0")}const Nd={"%":(l,h)=>(l*100).toFixed(h),b:l=>Math.round(l).toString(2),c:l=>l+"",d:Hv,e:(l,h)=>l.toExponential(h),f:(l,h)=>l.toFixed(h),g:(l,h)=>l.toPrecision(h),o:l=>Math.round(l).toString(8),p:(l,h)=>Od(l*100,h),r:Od,s:Qv,X:l=>Math.round(l).toString(16).toUpperCase(),x:l=>Math.round(l).toString(16)};function Ud(l){return l}var Vd=Array.prototype.map,qd=["y","z","a","f","p","n","µ","m","","k","M","G","T","P","E","Z","Y"];function $v(l){var h=l.grouping===void 0||l.thousands===void 0?Ud:Xv(Vd.call(l.grouping,Number),l.thousands+""),d=l.currency===void 0?"":l.currency[0]+"",p=l.currency===void 0?"":l.currency[1]+"",y=l.decimal===void 0?".":l.decimal+"",v=l.numerals===void 0?Ud:Wv(Vd.call(l.numerals,String)),a=l.percent===void 0?"%":l.percent+"",k=l.minus===void 0?"−":l.minus+"",T=l.nan===void 0?"NaN":l.nan+"";function F(N){N=Ph(N);var R=N.fill,X=N.align,Q=N.sign,ae=N.symbol,le=N.zero,de=N.width,ge=N.comma,rt=N.precision,Fe=N.trim,ze=N.type;ze==="n"?(ge=!0,ze="g"):Nd[ze]||(rt===void 0&&(rt=12),Fe=!0,ze="g"),(le||R==="0"&&X==="=")&&(le=!0,R="0",X="=");var Ge=ae==="$"?d:ae==="#"&&/[boxX]/.test(ze)?"0"+ze.toLowerCase():"",zt=ae==="$"?p:/[%p]/.test(ze)?a:"",wt=Nd[ze],je=/[defgprs%]/.test(ze);rt=rt===void 0?6:/[gprs]/.test(ze)?Math.max(1,Math.min(21,rt)):Math.max(0,Math.min(20,rt));function Ze(mt){var nr=Ge,qe=zt,Bt,Re,et;if(ze==="c")qe=wt(mt)+qe,mt="";else{mt=+mt;var dt=mt<0||1/mt<0;if(mt=isNaN(mt)?T:wt(Math.abs(mt),rt),Fe&&(mt=Jv(mt)),dt&&+mt==0&&Q!=="+"&&(dt=!1),nr=(dt?Q==="("?Q:k:Q==="-"||Q==="("?"":Q)+nr,qe=(ze==="s"?qd[8+xy/3]:"")+qe+(dt&&Q==="("?")":""),je){for(Bt=-1,Re=mt.length;++Bt<Re;)if(et=mt.charCodeAt(Bt),48>et||et>57){qe=(et===46?y+mt.slice(Bt+1):mt.slice(Bt))+qe,mt=mt.slice(0,Bt);break}}}ge&&!le&&(mt=h(mt,1/0));var qt=nr.length+mt.length+qe.length,Mt=qt<de?new Array(de-qt+1).join(R):"";switch(ge&&le&&(mt=h(Mt+mt,Mt.length?de-qe.length:1/0),Mt=""),X){case"<":mt=nr+mt+qe+Mt;break;case"=":mt=nr+Mt+mt+qe;break;case"^":mt=Mt.slice(0,qt=Mt.length>>1)+nr+mt+qe+Mt.slice(qt);break;default:mt=Mt+nr+mt+qe;break}return v(mt)}return Ze.toString=function(){return N+""},Ze}function M(N,R){var X=F((N=Ph(N),N.type="f",N)),Q=Math.max(-8,Math.min(8,Math.floor(Rl(R)/3)))*3,ae=Math.pow(10,-Q),le=qd[8+Q/3];return function(de){return X(ae*de)+le}}return{format:F,formatPrefix:M}}var uh,wy,Sy;e0({thousands:",",grouping:[3],currency:["$",""]});function e0(l){return uh=$v(l),wy=uh.format,Sy=uh.formatPrefix,uh}function t0(l){return Math.max(0,-Rl(Math.abs(l)))}function r0(l,h){return Math.max(0,Math.max(-8,Math.min(8,Math.floor(Rl(h)/3)))*3-Rl(Math.abs(l)))}function i0(l,h){return l=Math.abs(l),h=Math.abs(h)-l,Math.max(0,Rl(h)-Rl(l))+1}function n0(l,h,d,p){var y=mv(l,h,d),v;switch(p=Ph(p??",f"),p.type){case"s":{var a=Math.max(Math.abs(l),Math.abs(h));return p.precision==null&&!isNaN(v=r0(y,a))&&(p.precision=v),Sy(p,a)}case"":case"e":case"g":case"p":case"r":{p.precision==null&&!isNaN(v=i0(y,Math.max(Math.abs(l),Math.abs(h))))&&(p.precision=v-(p.type==="e"));break}case"f":case"%":{p.precision==null&&!isNaN(v=t0(y))&&(p.precision=v-(p.type==="%")*2);break}}return wy(p)}function Ey(l){var h=l.domain;return l.ticks=function(d){var p=h();return dv(p[0],p[p.length-1],d??10)},l.tickFormat=function(d,p){var y=h();return n0(y[0],y[y.length-1],d??10,p)},l.nice=function(d){d==null&&(d=10);var p=h(),y=0,v=p.length-1,a=p[y],k=p[v],T,F,M=10;for(k<a&&(F=a,a=k,k=F,F=y,y=v,v=F);M-- >0;){if(F=fy(a,k,d),F===T)return p[y]=a,p[v]=k,h(p);if(F>0)a=Math.floor(a/F)*F,k=Math.ceil(k/F)*F;else if(F<0)a=Math.ceil(a*F)/F,k=Math.floor(k*F)/F;else break;T=F}return l},l}function xh(){var l=Kv();return l.copy=function(){return vy(l,xh())},Dh.apply(l,arguments),Ey(l)}function jd(l){return function(h){return h<0?-Math.pow(-h,l):Math.pow(h,l)}}function a0(l){return l<0?-Math.sqrt(-l):Math.sqrt(l)}function o0(l){return l<0?-l*l:l*l}function s0(l){var h=l(so,so),d=1;function p(){return d===1?l(so,so):d===.5?l(a0,o0):l(jd(d),jd(1/d))}return h.exponent=function(y){return arguments.length?(d=+y,p()):d},Ey(h)}function ky(){var l=s0(by());return l.copy=function(){return vy(l,ky()).exponent(l.exponent())},Dh.apply(l,arguments),l}function l0(){return ky.apply(null,arguments).exponent(.5)}const Ru={x:xh,y:xh,z:xh,r:l0};function u0(l){return l.constant?"symlog":l.base?"log":l.exponent?l.exponent()===.5?"sqrt":"pow":"other"}function Gd(l){return l}function c0(l){return h=>Math.log(l*h)}function h0(l){return h=>l*Math.exp(h)}function p0(l){return h=>Math.sign(h)*Math.log1p(Math.abs(h/l))}function f0(l){return h=>Math.sign(h)*Math.expm1(Math.abs(h))*l}function ch(l){return function(d){return d<0?-Math.pow(-d,l):Math.pow(d,l)}}function d0(l){const h=u0(l);if(h==="log"){const d=Math.sign(l.domain()[0]);return{lift:c0(d),ground:h0(d),scaleType:h}}return h==="pow"?{lift:ch(1),ground:ch(1/1),scaleType:h}:h==="sqrt"?{lift:ch(.5),ground:ch(1/.5),scaleType:h}:h==="symlog"?{lift:p0(1),ground:f0(1),scaleType:h}:{lift:Gd,ground:Gd,scaleType:h}}function m0(l,h){if(typeof l.range!="function")throw new Error("Scale method `range` must be a function");if(typeof l.domain!="function")throw new Error("Scale method `domain` must be a function");if(!Array.isArray(h))return l.domain();l.domain().length!==2&&console.warn("[LayerCake] The scale is expected to have a domain of length 2 to use padding. Are you sure you want to use padding? Your scale's domain is:",l.domain()),l.range().length!==2&&console.warn("[LayerCake] The scale is expected to have a range of length 2 to use padding. Are you sure you want to use padding? Your scale's range is:",l.range());const{lift:d,ground:p}=d0(l),y=l.domain()[0],v=Object.prototype.toString.call(y)==="[object Date]",[a,k]=l.domain().map(X=>d(v?X.getTime():X)),[T,F]=l.range(),M=h[0]||0,N=h[1]||0,R=(k-a)/(Math.abs(F-T)-M-N);return[a-M*R,N*R+k].map(X=>p(v?new Date(X):X))}function y0(l,h,d,p,y){let v,a;return y===!0?(v=0,a=100):(v=l==="r"?1:0,a=l==="y"?d:l==="r"?25:h),p===!0?[a,v]:[v,a]}function g0(l,h,d,p,y,v){return y?typeof y=="function"?y({width:h,height:d}):y:y0(l,h,d,p,v)}function hh(l){return function([d,p,y,v,a,k,T,F,M,N]){if(p===null)return null;const R=g0(l,T,F,k,M,N),X=d===Ru[l]?d():d.copy();return X.domain(hy(p[l],y)).range(R),v&&X.domain(m0(X,v)),a===!0&&(typeof X.nice=="function"?X.nice():console.error(`[Layer Cake] You set \`${l}Nice: true\` but the ${l}Scale does not have a \`.nice\` method. Ignoring...`)),X}}function ph([l,h]){return d=>{const p=l(d);return Array.isArray(p)?p.map(y=>h(y)):h(p)}}function fh([l]){if(typeof l=="function"){if(typeof l.range=="function")return l.range();console.error("[LayerCake] Your scale doesn't have a `.range` method?")}return null}const dh={x:!1,y:!0,z:!1,r:!1};const _0=l=>({element:l[0]&4,width:l[0]&256,height:l[0]&512,aspectRatio:l[0]&1024,containerWidth:l[0]&128,containerHeight:l[0]&64}),Zd=l=>({element:l[2],width:l[8],height:l[9],aspectRatio:l[10],containerWidth:l[7],containerHeight:l[6]});function Kd(l){let h,d,p;const y=l[90].default,v=Fu(y,l,l[89],Zd);return{c(){h=Ue("div"),v&&v.c(),this.h()},l(a){h=Ve(a,"DIV",{class:!0});var k=Be(h);v&&v.l(k),k.forEach(ne),this.h()},h(){ie(h,"class","layercake-container svelte-vhzpsp"),Gu(()=>l[92].call(h)),We(h,"position",l[5]),We(h,"top",l[5]==="absolute"?"0":null),We(h,"right",l[5]==="absolute"?"0":null),We(h,"bottom",l[5]==="absolute"?"0":null),We(h,"left",l[5]==="absolute"?"0":null),We(h,"pointer-events",l[4]===!1?"none":null)},m(a,k){Le(a,h,k),v&&v.m(h,null),l[91](h),d=Zu(h,l[92].bind(h)),p=!0},p(a,k){v&&v.p&&(!p||k[0]&1988|k[2]&134217728)&&Ou(v,y,a,a[89],p?Uu(y,a[89],k,_0):Nu(a[89]),Zd),k[0]&32&&We(h,"position",a[5]),k[0]&32&&We(h,"top",a[5]==="absolute"?"0":null),k[0]&32&&We(h,"right",a[5]==="absolute"?"0":null),k[0]&32&&We(h,"bottom",a[5]==="absolute"?"0":null),k[0]&32&&We(h,"left",a[5]==="absolute"?"0":null),k[0]&16&&We(h,"pointer-events",a[4]===!1?"none":null)},i(a){p||(ot(v,a),p=!0)},o(a){ft(v,a),p=!1},d(a){a&&ne(h),v&&v.d(a),l[91](null),d()}}}function v0(l){let h,d,p=(l[3]===!0||typeof window<"u")&&Kd(l);return{c(){p&&p.c(),h=ir()},l(y){p&&p.l(y),h=ir()},m(y,v){p&&p.m(y,v),Le(y,h,v),d=!0},p(y,v){y[3]===!0||typeof window<"u"?p?(p.p(y,v),v[0]&8&&ot(p,1)):(p=Kd(y),p.c(),ot(p,1),p.m(h.parentNode,h)):p&&(Ln(),ft(p,1,1,()=>{p=null}),Rn())},i(y){d||(ot(p),d=!0)},o(y){ft(p),d=!1},d(y){p&&p.d(y),y&&ne(h)}}}function b0(l,h,d){let p,y,v,a,k,T,F,M,N,R,X,Q,ae,le,de,ge,rt,Fe,ze,Ge,zt,wt,je,Ze,mt,nr,qe,Bt,Re,et,dt,qt,Mt,xt,Ae,at,Mr,Zr,wi,Rr,ar,{$$slots:Sr={},$$scope:Gt}=h,{ssr:Si=!1}=h,{pointerEvents:Jn=!0}=h,{position:ti="relative"}=h,{percentRange:Nt=!1}=h,{width:dn=void 0}=h,{height:ci=void 0}=h,{containerWidth:Jr=dn||100}=h,{containerHeight:Bn=ci||100}=h,{element:hi=void 0}=h,{x:Tn=void 0}=h,{y:ni=void 0}=h,{z:vr=void 0}=h,{r:gi=void 0}=h,{data:pi=[]}=h,{xDomain:Vr=void 0}=h,{yDomain:Ji=void 0}=h,{zDomain:Kr=void 0}=h,{rDomain:In=void 0}=h,{xNice:Qi=!1}=h,{yNice:Fn=!1}=h,{zNice:Oi=!1}=h,{rNice:Pn=!1}=h,{xReverse:$i=dh.x}=h,{yReverse:zn=dh.y}=h,{zReverse:Ni=dh.z}=h,{rReverse:mn=dh.r}=h,{xPadding:Ui=void 0}=h,{yPadding:Vi=void 0}=h,{zPadding:Qr=void 0}=h,{rPadding:ia=void 0}=h,{xScale:ln=Ru.x}=h,{yScale:$r=Ru.y}=h,{zScale:yn=Ru.z}=h,{rScale:On=Ru.r}=h,{xRange:Br=void 0}=h,{yRange:Pr=void 0}=h,{zRange:L=void 0}=h,{rRange:U=void 0}=h,{padding:I={}}=h,{extents:V={}}=h,{flatData:W=void 0}=h,{custom:ue={}}=h,pe=!1;Rp(()=>{pe=!0});const j={},$=Tr(Nt);Kt(l,$,_e=>d(128,Zr=_e));const me=Tr(Jr);Kt(l,me,_e=>d(7,Mr=_e));const Ce=Tr(Bn);Kt(l,Ce,_e=>d(6,at=_e));const Oe=Tr(Ep(V));Kt(l,Oe,_e=>d(127,Ae=_e));const we=Tr(pi);Kt(l,we,_e=>d(126,xt=_e));const De=Tr(W||pi);Kt(l,De,_e=>d(125,Mt=_e));const st=Tr(I);Kt(l,st,_e=>d(124,qt=_e));const tt=Tr(es(Tn));Kt(l,tt,_e=>d(123,dt=_e));const Se=Tr(es(ni));Kt(l,Se,_e=>d(122,et=_e));const He=Tr(es(vr));Kt(l,He,_e=>d(121,Re=_e));const Ye=Tr(es(gi));Kt(l,Ye,_e=>d(120,Bt=_e));const Qe=Tr(Vr);Kt(l,Qe,_e=>d(119,qe=_e));const Vt=Tr(Ji);Kt(l,Vt,_e=>d(118,nr=_e));const it=Tr(Kr);Kt(l,it,_e=>d(117,mt=_e));const Wt=Tr(In);Kt(l,Wt,_e=>d(116,Ze=_e));const jt=Tr(Qi);Kt(l,jt,_e=>d(115,je=_e));const Ht=Tr(Fn);Kt(l,Ht,_e=>d(114,wt=_e));const sr=Tr(Oi);Kt(l,sr,_e=>d(113,zt=_e));const er=Tr(Pn);Kt(l,er,_e=>d(112,Ge=_e));const _i=Tr($i);Kt(l,_i,_e=>d(111,ze=_e));const dr=Tr(zn);Kt(l,dr,_e=>d(110,Fe=_e));const Fr=Tr(Ni);Kt(l,Fr,_e=>d(109,rt=_e));const _r=Tr(mn);Kt(l,_r,_e=>d(108,ge=_e));const Jt=Tr(Ui);Kt(l,Jt,_e=>d(107,de=_e));const lr=Tr(Vi);Kt(l,lr,_e=>d(106,le=_e));const Ei=Tr(Qr);Kt(l,Ei,_e=>d(105,ae=_e));const pa=Tr(ia);Kt(l,pa,_e=>d(104,Q=_e));const ai=Tr(Br);Kt(l,ai,_e=>d(103,X=_e));const Di=Tr(Pr);Kt(l,Di,_e=>d(102,R=_e));const Na=Tr(L);Kt(l,Na,_e=>d(101,N=_e));const va=Tr(U);Kt(l,va,_e=>d(100,M=_e));const qr=Tr(ln);Kt(l,qr,_e=>d(99,F=_e));const ba=Tr($r);Kt(l,ba,_e=>d(98,T=_e));const ki=Tr(yn);Kt(l,ki,_e=>d(97,k=_e));const oi=Tr(On);Kt(l,oi,_e=>d(96,a=_e));const un=Tr(j);Kt(l,un,_e=>d(94,y=_e));const Ar=Tr(ue);Kt(l,Ar,_e=>d(95,v=_e));const Nn=Mi([tt,Se,He,Ye],([_e,cn,Gi,jr])=>{const Ea={};return _e&&(Ea.x=_e),cn&&(Ea.y=cn),Gi&&(Ea.z=Gi),jr&&(Ea.r=jr),Ea}),gn=Mi([st,me,Ce],([_e])=>Object.assign({top:0,right:0,bottom:0,left:0},_e)),ns=Mi([me,Ce,gn],([_e,cn,Gi])=>{const jr={};return jr.top=Gi.top,jr.right=_e-Gi.right,jr.bottom=cn-Gi.bottom,jr.left=Gi.left,jr.width=jr.right-jr.left,jr.height=jr.bottom-jr.top,jr.width<=0&&pe===!0&&console.warn("[LayerCake] Target div has zero or negative width. Did you forget to set an explicit width in CSS on the container?"),jr.height<=0&&pe===!0&&console.warn("[LayerCake] Target div has zero or negative height. Did you forget to set an explicit height in CSS on the container?"),jr}),Ti=Mi([ns],([_e])=>_e.width);Kt(l,Ti,_e=>d(8,wi=_e));const xa=Mi([ns],([_e])=>_e.height);Kt(l,xa,_e=>d(9,Rr=_e));const qi=Mi([De,Nn,Oe],([_e,cn,Gi])=>{const jr=Ep(cn,Gi);return Object.keys(jr).length>0?{...nv(_e,jr),...Gi}:{}}),Ii=Mi([qi,Qe],oh("x")),Qn=Mi([qi,Vt],oh("y")),ji=Mi([qi,it],oh("z")),wa=Mi([qi,Wt],oh("r")),as=Mi([qr,qi,Ii,Jt,jt,_i,Ti,xa,ai,$],hh("x")),Ol=Mi([tt,as],ph),uo=Mi([ba,qi,Qn,lr,Ht,dr,Ti,xa,Di,$],hh("y")),Nl=Mi([Se,uo],ph),Ro=Mi([ki,qi,ji,Ei,sr,Fr,Ti,xa,Na,$],hh("z")),Ul=Mi([He,Ro],ph),Bo=Mi([oi,qi,wa,pa,er,_r,Ti,xa,va,$],hh("r")),Os=Mi([Ye,Bo],ph),Ua=Mi([as],fh),os=Mi([uo],fh),co=Mi([Ro],fh),Ns=Mi([Bo],fh),Va=Mi([Ti,xa],([_e,cn])=>_e/cn);Kt(l,Va,_e=>d(10,ar=_e));function Un(_e){Bs[_e?"unshift":"push"](()=>{hi=_e,d(2,hi)})}function Sa(){Jr=this.clientWidth,Bn=this.clientHeight,d(0,Jr),d(1,Bn)}return l.$$set=_e=>{"ssr"in _e&&d(3,Si=_e.ssr),"pointerEvents"in _e&&d(4,Jn=_e.pointerEvents),"position"in _e&&d(5,ti=_e.position),"percentRange"in _e&&d(51,Nt=_e.percentRange),"width"in _e&&d(52,dn=_e.width),"height"in _e&&d(53,ci=_e.height),"containerWidth"in _e&&d(0,Jr=_e.containerWidth),"containerHeight"in _e&&d(1,Bn=_e.containerHeight),"element"in _e&&d(2,hi=_e.element),"x"in _e&&d(54,Tn=_e.x),"y"in _e&&d(55,ni=_e.y),"z"in _e&&d(56,vr=_e.z),"r"in _e&&d(57,gi=_e.r),"data"in _e&&d(58,pi=_e.data),"xDomain"in _e&&d(59,Vr=_e.xDomain),"yDomain"in _e&&d(60,Ji=_e.yDomain),"zDomain"in _e&&d(61,Kr=_e.zDomain),"rDomain"in _e&&d(62,In=_e.rDomain),"xNice"in _e&&d(63,Qi=_e.xNice),"yNice"in _e&&d(64,Fn=_e.yNice),"zNice"in _e&&d(65,Oi=_e.zNice),"rNice"in _e&&d(66,Pn=_e.rNice),"xReverse"in _e&&d(67,$i=_e.xReverse),"yReverse"in _e&&d(68,zn=_e.yReverse),"zReverse"in _e&&d(69,Ni=_e.zReverse),"rReverse"in _e&&d(70,mn=_e.rReverse),"xPadding"in _e&&d(71,Ui=_e.xPadding),"yPadding"in _e&&d(72,Vi=_e.yPadding),"zPadding"in _e&&d(73,Qr=_e.zPadding),"rPadding"in _e&&d(74,ia=_e.rPadding),"xScale"in _e&&d(75,ln=_e.xScale),"yScale"in _e&&d(76,$r=_e.yScale),"zScale"in _e&&d(77,yn=_e.zScale),"rScale"in _e&&d(78,On=_e.rScale),"xRange"in _e&&d(79,Br=_e.xRange),"yRange"in _e&&d(80,Pr=_e.yRange),"zRange"in _e&&d(81,L=_e.zRange),"rRange"in _e&&d(82,U=_e.rRange),"padding"in _e&&d(83,I=_e.padding),"extents"in _e&&d(84,V=_e.extents),"flatData"in _e&&d(85,W=_e.flatData),"custom"in _e&&d(86,ue=_e.custom),"$$scope"in _e&&d(89,Gt=_e.$$scope)},l.$$.update=()=>{l.$$.dirty[1]&8388608&&Tn&&d(87,j.x=Tn,j),l.$$.dirty[1]&16777216&&ni&&d(87,j.y=ni,j),l.$$.dirty[1]&33554432&&vr&&d(87,j.z=vr,j),l.$$.dirty[1]&67108864&&gi&&d(87,j.r=gi,j),l.$$.dirty[1]&268435456&&Vr&&d(87,j.xDomain=Vr,j),l.$$.dirty[1]&536870912&&Ji&&d(87,j.yDomain=Ji,j),l.$$.dirty[1]&1073741824&&Kr&&d(87,j.zDomain=Kr,j),l.$$.dirty[2]&1&&In&&d(87,j.rDomain=In,j),l.$$.dirty[2]&131072&&Br&&d(87,j.xRange=Br,j),l.$$.dirty[2]&262144&&Pr&&d(87,j.yRange=Pr,j),l.$$.dirty[2]&524288&&L&&d(87,j.zRange=L,j),l.$$.dirty[2]&1048576&&U&&d(87,j.rRange=U,j),l.$$.dirty[1]&1048576&&kr($,Zr=Nt,Zr),l.$$.dirty[0]&1&&kr(me,Mr=Jr,Mr),l.$$.dirty[0]&2&&kr(Ce,at=Bn,at),l.$$.dirty[2]&4194304&&kr(Oe,Ae=Ep(V),Ae),l.$$.dirty[1]&134217728&&kr(we,xt=pi,xt),l.$$.dirty[1]&134217728|l.$$.dirty[2]&8388608&&kr(De,Mt=W||pi,Mt),l.$$.dirty[2]&2097152&&kr(st,qt=I,qt),l.$$.dirty[1]&8388608&&kr(tt,dt=es(Tn),dt),l.$$.dirty[1]&16777216&&kr(Se,et=es(ni),et),l.$$.dirty[1]&33554432&&kr(He,Re=es(vr),Re),l.$$.dirty[1]&67108864&&kr(Ye,Bt=es(gi),Bt),l.$$.dirty[1]&268435456&&kr(Qe,qe=Vr,qe),l.$$.dirty[1]&536870912&&kr(Vt,nr=Ji,nr),l.$$.dirty[1]&1073741824&&kr(it,mt=Kr,mt),l.$$.dirty[2]&1&&kr(Wt,Ze=In,Ze),l.$$.dirty[2]&2&&kr(jt,je=Qi,je),l.$$.dirty[2]&4&&kr(Ht,wt=Fn,wt),l.$$.dirty[2]&8&&kr(sr,zt=Oi,zt),l.$$.dirty[2]&16&&kr(er,Ge=Pn,Ge),l.$$.dirty[2]&32&&kr(_i,ze=$i,ze),l.$$.dirty[2]&64&&kr(dr,Fe=zn,Fe),l.$$.dirty[2]&128&&kr(Fr,rt=Ni,rt),l.$$.dirty[2]&256&&kr(_r,ge=mn,ge),l.$$.dirty[2]&512&&kr(Jt,de=Ui,de),l.$$.dirty[2]&1024&&kr(lr,le=Vi,le),l.$$.dirty[2]&2048&&kr(Ei,ae=Qr,ae),l.$$.dirty[2]&4096&&kr(pa,Q=ia,Q),l.$$.dirty[2]&131072&&kr(ai,X=Br,X),l.$$.dirty[2]&262144&&kr(Di,R=Pr,R),l.$$.dirty[2]&524288&&kr(Na,N=L,N),l.$$.dirty[2]&1048576&&kr(va,M=U,M),l.$$.dirty[2]&8192&&kr(qr,F=ln,F),l.$$.dirty[2]&16384&&kr(ba,T=$r,T),l.$$.dirty[2]&32768&&kr(ki,k=yn,k),l.$$.dirty[2]&65536&&kr(oi,a=On,a),l.$$.dirty[2]&16777216&&kr(Ar,v=ue,v),l.$$.dirty[2]&33554432&&kr(un,y=j,y),l.$$.dirty[2]&67108864&&ay("LayerCake",p)},d(88,p={activeGetters:Nn,width:Ti,height:xa,percentRange:$,aspectRatio:Va,containerWidth:me,containerHeight:Ce,x:tt,y:Se,z:He,r:Ye,custom:Ar,data:we,xNice:jt,yNice:Ht,zNice:sr,rNice:er,xReverse:_i,yReverse:dr,zReverse:Fr,rReverse:_r,xPadding:Jt,yPadding:lr,zPadding:Ei,rPadding:pa,padding:gn,flatData:De,extents:qi,xDomain:Ii,yDomain:Qn,zDomain:ji,rDomain:wa,xRange:Ua,yRange:os,zRange:co,rRange:Ns,config:un,xScale:as,xGet:Ol,yScale:uo,yGet:Nl,zScale:Ro,zGet:Ul,rScale:Bo,rGet:Os}),[Jr,Bn,hi,Si,Jn,ti,at,Mr,wi,Rr,ar,$,me,Ce,Oe,we,De,st,tt,Se,He,Ye,Qe,Vt,it,Wt,jt,Ht,sr,er,_i,dr,Fr,_r,Jt,lr,Ei,pa,ai,Di,Na,va,qr,ba,ki,oi,un,Ar,Ti,xa,Va,Nt,dn,ci,Tn,ni,vr,gi,pi,Vr,Ji,Kr,In,Qi,Fn,Oi,Pn,$i,zn,Ni,mn,Ui,Vi,Qr,ia,ln,$r,yn,On,Br,Pr,L,U,I,V,W,ue,j,p,Gt,Sr,Un,Sa]}class x0 extends an{constructor(h){super(),on(this,h,b0,v0,sn,{ssr:3,pointerEvents:4,position:5,percentRange:51,width:52,height:53,containerWidth:0,containerHeight:1,element:2,x:54,y:55,z:56,r:57,data:58,xDomain:59,yDomain:60,zDomain:61,rDomain:62,xNice:63,yNice:64,zNice:65,rNice:66,xReverse:67,yReverse:68,zReverse:69,rReverse:70,xPadding:71,yPadding:72,zPadding:73,rPadding:74,xScale:75,yScale:76,zScale:77,rScale:78,xRange:79,yRange:80,zRange:81,rRange:82,padding:83,extents:84,flatData:85,custom:86},null,[-1,-1,-1,-1,-1])}}const w0=l=>({element:l&1}),Hd=l=>({element:l[0]}),S0=l=>({element:l&1}),Xd=l=>({element:l[0]});function E0(l){let h,d,p,y,v;const a=l[12].defs,k=Fu(a,l,l[11],Xd),T=l[12].default,F=Fu(T,l,l[11],Hd);return{c(){h=Wn("svg"),d=Wn("defs"),k&&k.c(),p=Wn("g"),F&&F.c(),this.h()},l(M){h=Yn(M,"svg",{class:!0,viewBox:!0,width:!0,height:!0});var N=Be(h);d=Yn(N,"defs",{});var R=Be(d);k&&k.l(R),R.forEach(ne),p=Yn(N,"g",{class:!0,transform:!0});var X=Be(p);F&&F.l(X),X.forEach(ne),N.forEach(ne),this.h()},h(){ie(p,"class","layercake-layout-svg_g"),ie(p,"transform",y="translate("+l[7].left+", "+l[7].top+")"),ie(h,"class","layercake-layout-svg svelte-u84d8d"),ie(h,"viewBox",l[4]),ie(h,"width",l[5]),ie(h,"height",l[6]),We(h,"z-index",l[2]),We(h,"pointer-events",l[3]===!1?"none":null)},m(M,N){Le(M,h,N),xe(h,d),k&&k.m(d,null),xe(h,p),F&&F.m(p,null),l[13](p),l[14](h),v=!0},p(M,[N]){k&&k.p&&(!v||N&2049)&&Ou(k,a,M,M[11],v?Uu(a,M[11],N,S0):Nu(M[11]),Xd),F&&F.p&&(!v||N&2049)&&Ou(F,T,M,M[11],v?Uu(T,M[11],N,w0):Nu(M[11]),Hd),(!v||N&128&&y!==(y="translate("+M[7].left+", "+M[7].top+")"))&&ie(p,"transform",y),(!v||N&16)&&ie(h,"viewBox",M[4]),(!v||N&32)&&ie(h,"width",M[5]),(!v||N&64)&&ie(h,"height",M[6]),N&4&&We(h,"z-index",M[2]),N&8&&We(h,"pointer-events",M[3]===!1?"none":null)},i(M){v||(ot(k,M),ot(F,M),v=!0)},o(M){ft(k,M),ft(F,M),v=!1},d(M){M&&ne(h),k&&k.d(M),F&&F.d(M),l[13](null),l[14](null)}}}function k0(l,h,d){let p,y,v,{$$slots:a={},$$scope:k}=h,{element:T=void 0}=h,{innerElement:F=void 0}=h,{zIndex:M=void 0}=h,{pointerEvents:N=void 0}=h,{viewBox:R=void 0}=h;const{containerWidth:X,containerHeight:Q,padding:ae}=Ku("LayerCake");Kt(l,X,ge=>d(5,p=ge)),Kt(l,Q,ge=>d(6,y=ge)),Kt(l,ae,ge=>d(7,v=ge));function le(ge){Bs[ge?"unshift":"push"](()=>{F=ge,d(1,F)})}function de(ge){Bs[ge?"unshift":"push"](()=>{T=ge,d(0,T)})}return l.$$set=ge=>{"element"in ge&&d(0,T=ge.element),"innerElement"in ge&&d(1,F=ge.innerElement),"zIndex"in ge&&d(2,M=ge.zIndex),"pointerEvents"in ge&&d(3,N=ge.pointerEvents),"viewBox"in ge&&d(4,R=ge.viewBox),"$$scope"in ge&&d(11,k=ge.$$scope)},[T,F,M,N,R,p,y,v,X,Q,ae,k,a,le,de]}class T0 extends an{constructor(h){super(),on(this,h,k0,E0,sn,{element:0,innerElement:1,zIndex:2,pointerEvents:3,viewBox:4})}}function Wd(l,h,d){const p=l.slice();return p[23]=h[d],p[25]=d,p}function Yd(l){let h,d,p,y;return{c(){h=Wn("rect"),this.h()},l(v){h=Yn(v,"rect",{class:!0,"data-id":!0,x:!0,y:!0,width:!0,height:!0,fill:!0,stroke:!0,"stroke-width":!0}),Be(h).forEach(ne),this.h()},h(){ie(h,"class","group-rect"),ie(h,"data-id",l[25]),ie(h,"x",d=l[11].bandwidth?l[7](l[23]):l[7](l[23])[0]),ie(h,"y",p=l[13](l[12](l[23]))-1),ie(h,"width",y=l[11].bandwidth?l[11].bandwidth():l[9](l[23])),ie(h,"height","3"),ie(h,"fill","#308182"),ie(h,"stroke",l[0]),ie(h,"stroke-width",l[1])},m(v,a){Le(v,h,a)},p(v,a){a&3200&&d!==(d=v[11].bandwidth?v[7](v[23]):v[7](v[23])[0])&&ie(h,"x",d),a&13312&&p!==(p=v[13](v[12](v[23]))-1)&&ie(h,"y",p),a&3584&&y!==(y=v[11].bandwidth?v[11].bandwidth():v[9](v[23]))&&ie(h,"width",y),a&1&&ie(h,"stroke",v[0]),a&2&&ie(h,"stroke-width",v[1])},d(v){v&&ne(h)}}}function Jd(l){let h,d,p,y,v,a,k,T,F=l[12]&&Yd(l);return{c(){h=Wn("rect"),F&&F.c(),a=Wn("text"),this.h()},l(M){h=Yn(M,"rect",{class:!0,"data-id":!0,x:!0,y:!0,width:!0,height:!0,fill:!0,stroke:!0,"stroke-width":!0}),Be(h).forEach(ne),F&&F.l(M),a=Yn(M,"text",{x:!0,y:!0,dx:!0,dy:!0,"text-anchor":!0}),Be(a).forEach(ne),this.h()},h(){ie(h,"class","group-rect"),ie(h,"data-id",l[25]),ie(h,"x",d=l[11].bandwidth?l[7](l[23]):l[7](l[23])[0]),ie(h,"y",p=l[6](l[23])),ie(h,"width",y=l[11].bandwidth?l[11].bandwidth():l[9](l[23])),ie(h,"height",v=l[8](l[23])),ie(h,"fill",l[4]),ie(h,"stroke",l[0]),ie(h,"stroke-width",l[1]),ie(a,"x",k=l[11].bandwidth?l[7](l[23])+l[11].bandwidth()/2:l[7](l[23])[0]),ie(a,"y",T=l[6](l[23])-4),ie(a,"dx",l[2]),ie(a,"dy",l[3]),ie(a,"text-anchor",l[5])},m(M,N){Le(M,h,N),F&&F.m(M,N),Le(M,a,N)},p(M,N){N&3200&&d!==(d=M[11].bandwidth?M[7](M[23]):M[7](M[23])[0])&&ie(h,"x",d),N&1088&&p!==(p=M[6](M[23]))&&ie(h,"y",p),N&3584&&y!==(y=M[11].bandwidth?M[11].bandwidth():M[9](M[23]))&&ie(h,"width",y),N&1280&&v!==(v=M[8](M[23]))&&ie(h,"height",v),N&16&&ie(h,"fill",M[4]),N&1&&ie(h,"stroke",M[0]),N&2&&ie(h,"stroke-width",M[1]),M[12]?F?F.p(M,N):(F=Yd(M),F.c(),F.m(a.parentNode,a)):F&&(F.d(1),F=null),N&3200&&k!==(k=M[11].bandwidth?M[7](M[23])+M[11].bandwidth()/2:M[7](M[23])[0])&&ie(a,"x",k),N&1088&&T!==(T=M[6](M[23])-4)&&ie(a,"y",T),N&4&&ie(a,"dx",M[2]),N&8&&ie(a,"dy",M[3]),N&32&&ie(a,"text-anchor",M[5])},d(M){M&&ne(h),F&&F.d(M),M&&ne(a)}}}function I0(l){let h,d=l[10],p=[];for(let y=0;y<d.length;y+=1)p[y]=Jd(Wd(l,d,y));return{c(){h=Wn("g");for(let y=0;y<p.length;y+=1)p[y].c();this.h()},l(y){h=Yn(y,"g",{class:!0});var v=Be(h);for(let a=0;a<p.length;a+=1)p[a].l(v);v.forEach(ne),this.h()},h(){ie(h,"class","column-group svelte-wgzwsk")},m(y,v){Le(y,h,v);for(let a=0;a<p.length;a+=1)p[a]&&p[a].m(h,null)},p(y,[v]){if(v&16383){d=y[10];let a;for(a=0;a<d.length;a+=1){const k=Wd(y,d,a);p[a]?p[a].p(k,v):(p[a]=Jd(k),p[a].c(),p[a].m(h,null))}for(;a<p.length;a+=1)p[a].d(1);p.length=d.length}},i:ei,o:ei,d(y){y&&ne(h),nn(p,y)}}}function P0(l,h,d){let p,y,v,a,k,T,F,M,N;const{data:R,xGet:X,yGet:Q,yRange:ae,xScale:le,yScale:de,y:ge,z:rt}=Ku("LayerCake");Kt(l,R,Ze=>d(10,T=Ze)),Kt(l,X,Ze=>d(7,k=Ze)),Kt(l,Q,Ze=>d(6,v=Ze)),Kt(l,ae,Ze=>d(21,a=Ze)),Kt(l,le,Ze=>d(11,F=Ze)),Kt(l,de,Ze=>d(13,N=Ze)),Kt(l,rt,Ze=>d(12,M=Ze));let{stroke:Fe=""}=h,{strokeWidth:ze=0}=h,{dxTick:Ge=0}=h,{dyTick:zt=0}=h,{fill:wt="#00205b"}=h,{textAnchor:je="middle"}=h;return l.$$set=Ze=>{"stroke"in Ze&&d(0,Fe=Ze.stroke),"strokeWidth"in Ze&&d(1,ze=Ze.strokeWidth),"dxTick"in Ze&&d(2,Ge=Ze.dxTick),"dyTick"in Ze&&d(3,zt=Ze.dyTick),"fill"in Ze&&d(4,wt=Ze.fill),"textAnchor"in Ze&&d(5,je=Ze.textAnchor)},l.$$.update=()=>{l.$$.dirty&128&&d(9,p=Ze=>{const mt=k(Ze);return Math.max(0,mt[1]-mt[0])}),l.$$.dirty&2097216&&d(8,y=Ze=>a[0]-v(Ze))},[Fe,ze,Ge,zt,wt,je,v,k,y,p,T,F,M,N,R,X,Q,ae,le,de,rt,a]}class z0 extends an{constructor(h){super(),on(this,h,P0,I0,sn,{stroke:0,strokeWidth:1,dxTick:2,dyTick:3,fill:4,textAnchor:5})}}function Qd(l,h,d){const p=l.slice();return p[28]=h[d],p[30]=d,p}function $d(l){let h,d,p,y;return{c(){h=Wn("line"),this.h()},l(v){h=Yn(v,"line",{y1:!0,y2:!0,x1:!0,x2:!0,stroke:!0,"stroke-width":!0,class:!0}),Be(h).forEach(ne),this.h()},h(){ie(h,"y1",d=l[20]*-1),ie(h,"y2",p=l[14]&&l[30]%2==0?l[10]+l[8]+2:l[10]+l[8]-13),ie(h,"x1","0"),ie(h,"x2","0"),ie(h,"stroke",l[11]),ie(h,"stroke-width",y=l[15]&&Array.isArray(l[4])&&l[30]==Math.floor(l[4].length/2)?2:1),ie(h,"class","svelte-fwjh80"),is(h,"baseline",l[13])},m(v,a){Le(v,h,a)},p(v,a){a&1048576&&d!==(d=v[20]*-1)&&ie(h,"y1",d),a&17664&&p!==(p=v[14]&&v[30]%2==0?v[10]+v[8]+2:v[10]+v[8]-13)&&ie(h,"y2",p),a&2048&&ie(h,"stroke",v[11]),a&32784&&y!==(y=v[15]&&Array.isArray(v[4])&&v[30]==Math.floor(v[4].length/2)?2:1)&&ie(h,"stroke-width",y),a&8192&&is(h,"baseline",v[13])},d(v){v&&ne(h)}}}function A0(l){let h=l[1](l[28])+"",d;return{c(){d=Tt(h)},l(p){d=It(p,h)},m(p,y){Le(p,d,y)},p(p,y){y&262146&&h!==(h=p[1](p[28])+"")&&wr(d,h)},d(p){p&&ne(d)}}}function C0(l){let h,d=l[1](l[28])+"",p,y;return{c(){h=Tt(l[5]),p=Tt(d),y=Tt(l[6])},l(v){h=It(v,l[5]),p=It(v,d),y=It(v,l[6])},m(v,a){Le(v,h,a),Le(v,p,a),Le(v,y,a)},p(v,a){a&32&&wr(h,v[5]),a&262146&&d!==(d=v[1](v[28])+"")&&wr(p,d),a&64&&wr(y,v[6])},d(v){v&&ne(h),v&&ne(p),v&&ne(y)}}}function em(l){let h,d,p,y,v,a,k,T=l[0]!==!1&&$d(l);function F(R,X){return R[30]==R[18].length-1?C0:A0}let M=F(l),N=M(l);return{c(){h=Wn("g"),T&&T.c(),d=Wn("text"),N.c(),this.h()},l(R){h=Yn(R,"g",{class:!0,transform:!0});var X=Be(h);T&&T.l(X),d=Yn(X,"text",{x:!0,y:!0,dx:!0,dy:!0,"text-anchor":!0,fill:!0,class:!0});var Q=Be(d);N.l(Q),Q.forEach(ne),X.forEach(ne),this.h()},h(){ie(d,"x",p=l[7]||l[16]?l[17].bandwidth()/2:0),ie(d,"y",y=l[3]?l[20]*-1-6:l[14]&&l[30]%2==0?l[8]+15:l[8]),ie(d,"dx",v=l[24](l[30])=="start"?l[9]-2:l[24](l[30])=="end"?l[9]+2:l[9]),ie(d,"dy",l[10]),ie(d,"text-anchor",l[24](l[30])),ie(d,"fill",l[12]),ie(d,"class","svelte-fwjh80"),is(d,"bold",l[15]&&Array.isArray(l[4])&&l[30]==Math.floor(l[4].length/2)),ie(h,"class",a="tick tick-"+l[28]+" svelte-fwjh80"),ie(h,"transform",k="translate("+l[17](l[28])+","+l[19][0]+")")},m(R,X){Le(R,h,X),T&&T.m(h,null),xe(h,d),N.m(d,null)},p(R,X){R[0]!==!1?T?T.p(R,X):(T=$d(R),T.c(),T.m(h,d)):T&&(T.d(1),T=null),M===(M=F(R))&&N?N.p(R,X):(N.d(1),N=M(R),N&&(N.c(),N.m(d,null))),X&196736&&p!==(p=R[7]||R[16]?R[17].bandwidth()/2:0)&&ie(d,"x",p),X&1065224&&y!==(y=R[3]?R[20]*-1-6:R[14]&&R[30]%2==0?R[8]+15:R[8])&&ie(d,"y",y),X&512&&v!==(v=R[24](R[30])=="start"?R[9]-2:R[24](R[30])=="end"?R[9]+2:R[9])&&ie(d,"dx",v),X&1024&&ie(d,"dy",R[10]),X&4096&&ie(d,"fill",R[12]),X&32784&&is(d,"bold",R[15]&&Array.isArray(R[4])&&R[30]==Math.floor(R[4].length/2)),X&262144&&a!==(a="tick tick-"+R[28]+" svelte-fwjh80")&&ie(h,"class",a),X&917504&&k!==(k="translate("+R[17](R[28])+","+R[19][0]+")")&&ie(h,"transform",k)},d(R){R&&ne(h),T&&T.d(),N.d()}}}function tm(l){let h,d,p;return{c(){h=Wn("line"),this.h()},l(y){h=Yn(y,"line",{class:!0,y1:!0,y2:!0,x1:!0,x2:!0,stroke:!0}),Be(h).forEach(ne),this.h()},h(){ie(h,"class","baseline svelte-fwjh80"),ie(h,"y1",l[20]),ie(h,"y2","0"),ie(h,"x1",d=l[17](0)),ie(h,"x2",p=l[17](0)),ie(h,"stroke",l[11])},m(y,v){Le(y,h,v)},p(y,v){v&1048576&&ie(h,"y1",y[20]),v&131072&&d!==(d=y[17](0))&&ie(h,"x1",d),v&131072&&p!==(p=y[17](0))&&ie(h,"x2",p),v&2048&&ie(h,"stroke",y[11])},d(y){y&&ne(h)}}}function M0(l){let h,d,p=l[18],y=[];for(let a=0;a<p.length;a+=1)y[a]=em(Qd(l,p,a));let v=l[2]===!0&&tm(l);return{c(){h=Wn("g");for(let a=0;a<y.length;a+=1)y[a].c();d=ir(),v&&v.c(),this.h()},l(a){h=Yn(a,"g",{class:!0});var k=Be(h);for(let T=0;T<y.length;T+=1)y[T].l(k);d=ir(),v&&v.l(k),k.forEach(ne),this.h()},h(){ie(h,"class","axis x-axis")},m(a,k){Le(a,h,k);for(let T=0;T<y.length;T+=1)y[T]&&y[T].m(h,null);xe(h,d),v&&v.m(h,null)},p(a,[k]){if(k&18874363){p=a[18];let T;for(T=0;T<p.length;T+=1){const F=Qd(a,p,T);y[T]?y[T].p(F,k):(y[T]=em(F),y[T].c(),y[T].m(h,d))}for(;T<y.length;T+=1)y[T].d(1);y.length=p.length}a[2]===!0?v?v.p(a,k):(v=tm(a),v.c(),v.m(h,null)):v&&(v.d(1),v=null)},i:ei,o:ei,d(a){a&&ne(h),nn(y,a),v&&v.d()}}}function D0(l,h,d){let p,y,v,a,k;const{width:T,height:F,xScale:M,yScale:N,yRange:R}=Ku("LayerCake");Kt(l,F,Re=>d(20,k=Re)),Kt(l,M,Re=>d(17,v=Re)),Kt(l,R,Re=>d(19,a=Re));let{gridlines:X=!0}=h,{formatTick:Q=Re=>Re}=h,{baseline:ae=!1}=h,{flipped:le=!1}=h,{snapTicks:de=!1}=h,{ticks:ge=void 0}=h,{prefix:rt=""}=h,{suffix:Fe=""}=h,{xTick:ze=void 0}=h,{yTick:Ge=15}=h,{dxTick:zt=0}=h,{dyTick:wt=0}=h,{lineColor:je="#999"}=h,{textColor:Ze="#555"}=h,{solid:mt=!1}=h,{stagger:nr=!1}=h,{median:qe=!0}=h;function Bt(Re){if(de===!0){if(Re===0)return"start";if(Re===y.length-1)return"end"}return"middle"}return l.$$set=Re=>{"gridlines"in Re&&d(0,X=Re.gridlines),"formatTick"in Re&&d(1,Q=Re.formatTick),"baseline"in Re&&d(2,ae=Re.baseline),"flipped"in Re&&d(3,le=Re.flipped),"snapTicks"in Re&&d(25,de=Re.snapTicks),"ticks"in Re&&d(4,ge=Re.ticks),"prefix"in Re&&d(5,rt=Re.prefix),"suffix"in Re&&d(6,Fe=Re.suffix),"xTick"in Re&&d(7,ze=Re.xTick),"yTick"in Re&&d(8,Ge=Re.yTick),"dxTick"in Re&&d(9,zt=Re.dxTick),"dyTick"in Re&&d(10,wt=Re.dyTick),"lineColor"in Re&&d(11,je=Re.lineColor),"textColor"in Re&&d(12,Ze=Re.textColor),"solid"in Re&&d(13,mt=Re.solid),"stagger"in Re&&d(14,nr=Re.stagger),"median"in Re&&d(15,qe=Re.median)},l.$$.update=()=>{l.$$.dirty&131072&&d(16,p=typeof v.bandwidth=="function"),l.$$.dirty&196624&&d(18,y=Array.isArray(ge)?ge:p?v.domain():v.ticks(ge))},[X,Q,ae,le,ge,rt,Fe,ze,Ge,zt,wt,je,Ze,mt,nr,qe,p,v,y,a,k,F,M,R,Bt,de]}class L0 extends an{constructor(h){super(),on(this,h,D0,M0,sn,{gridlines:0,formatTick:1,baseline:2,flipped:3,snapTicks:25,ticks:4,prefix:5,suffix:6,xTick:7,yTick:8,dxTick:9,dyTick:10,lineColor:11,textColor:12,solid:13,stagger:14,median:15})}}function R0(l){let h,d,p,y;return h=new z0({props:{fill:l[1],formatVal:l[5]}}),p=new L0({props:{gridlines:!1}}),{c(){ur(h.$$.fragment),d=yt(),ur(p.$$.fragment)},l(v){cr(h.$$.fragment,v),d=gt(v),cr(p.$$.fragment,v)},m(v,a){hr(h,v,a),Le(v,d,a),hr(p,v,a),y=!0},p(v,a){const k={};a&2&&(k.fill=v[1]),a&32&&(k.formatVal=v[5]),h.$set(k)},i(v){y||(ot(h.$$.fragment,v),ot(p.$$.fragment,v),y=!0)},o(v){ft(h.$$.fragment,v),ft(p.$$.fragment,v),y=!1},d(v){pr(h,v),v&&ne(d),pr(p,v)}}}function B0(l){let h,d;return h=new T0({props:{$$slots:{default:[R0]},$$scope:{ctx:l}}}),{c(){ur(h.$$.fragment)},l(p){cr(h.$$.fragment,p)},m(p,y){hr(h,p,y),d=!0},p(p,y){const v={};y&1058&&(v.$$scope={dirty:y,ctx:p}),h.$set(v)},i(p){d||(ot(h.$$.fragment,p),d=!0)},o(p){ft(h.$$.fragment,p),d=!1},d(p){pr(h,p)}}}function F0(l){let h,d,p;return d=new x0({props:{padding:{top:15,right:0,bottom:20,left:0},x:l[2],y:l[3],z:l[4],xScale:my().paddingInner([.02]).round(!0),xDomain:l[7],yDomain:l[6],zDomain:l[6],data:l[0],$$slots:{default:[B0]},$$scope:{ctx:l}}}),{c(){h=Ue("div"),ur(d.$$.fragment),this.h()},l(y){h=Ve(y,"DIV",{class:!0});var v=Be(h);cr(d.$$.fragment,v),v.forEach(ne),this.h()},h(){ie(h,"class","chart-container svelte-1i1qsul")},m(y,v){Le(y,h,v),hr(d,h,null),p=!0},p(y,[v]){const a={};v&4&&(a.x=y[2]),v&8&&(a.y=y[3]),v&16&&(a.z=y[4]),v&128&&(a.xDomain=y[7]),v&64&&(a.yDomain=y[6]),v&64&&(a.zDomain=y[6]),v&1&&(a.data=y[0]),v&1058&&(a.$$scope={dirty:v,ctx:y}),d.$set(a)},i(y){p||(ot(d.$$.fragment,y),p=!0)},o(y){ft(d.$$.fragment,y),p=!1},d(y){y&&ne(h),pr(d)}}}function O0(l,h,d){let p,y,v,{data:a}=h,{suffix:k="%"}=h,{decimals:T=null}=h,{fill:F="#00205B"}=h,{xKey:M="x"}=h,{yKey:N="y"}=h,{zKey:R=null}=h;return l.$$set=X=>{"data"in X&&d(0,a=X.data),"suffix"in X&&d(8,k=X.suffix),"decimals"in X&&d(9,T=X.decimals),"fill"in X&&d(1,F=X.fill),"xKey"in X&&d(2,M=X.xKey),"yKey"in X&&d(3,N=X.yKey),"zKey"in X&&d(4,R=X.zKey)},l.$$.update=()=>{l.$$.dirty&5&&d(7,p=a.map(X=>X[M])),l.$$.dirty&9&&d(6,y=[0,Math.max(...a.map(X=>X[N]))]),l.$$.dirty&768&&d(5,v=X=>X.toFixed(T)+k)},[a,F,M,N,R,v,y,p,k,T]}class Zp extends an{constructor(h){super(),on(this,h,O0,F0,sn,{data:0,suffix:8,decimals:9,fill:1,xKey:2,yKey:3,zKey:4})}}function rm(l,h,d){const p=l.slice();return p[6]=h[d],p[8]=d,p}function im(l){let h,d=l[0],p=[];for(let y=0;y<d.length;y+=1)p[y]=nm(rm(l,d,y));return{c(){h=Wn("svg");for(let y=0;y<p.length;y+=1)p[y].c();this.h()},l(y){h=Yn(y,"svg",{class:!0});var v=Be(h);for(let a=0;a<p.length;a+=1)p[a].l(v);v.forEach(ne),this.h()},h(){ie(h,"class","stack svelte-pzvhwz")},m(y,v){Le(y,h,v);for(let a=0;a<p.length;a+=1)p[a]&&p[a].m(h,null)},p(y,v){if(v&31){d=y[0];let a;for(a=0;a<d.length;a+=1){const k=rm(y,d,a);p[a]?p[a].p(k,v):(p[a]=nm(k),p[a].c(),p[a].m(h,null))}for(;a<p.length;a+=1)p[a].d(1);p.length=d.length}},d(y){y&&ne(h),nn(p,y)}}}function nm(l){let h,d;return{c(){h=Wn("rect"),this.h()},l(p){h=Yn(p,"rect",{class:!0,x:!0,style:!0}),Be(h).forEach(ne),this.h()},h(){ie(h,"class","cell svelte-pzvhwz"),ie(h,"x",d=l[4][l[8]]/l[3]*100+"%"),We(h,"width",l[6][l[1]]/l[3]*100+"%"),We(h,"fill",l[2][l[8]])},m(p,y){Le(p,h,y)},p(p,y){y&24&&d!==(d=p[4][p[8]]/p[3]*100+"%")&&ie(h,"x",d),y&11&&We(h,"width",p[6][p[1]]/p[3]*100+"%"),y&4&&We(h,"fill",p[2][p[8]])},d(p){p&&ne(h)}}}function N0(l){let h,d=l[3]&&l[4]&&im(l);return{c(){d&&d.c(),h=ir()},l(p){d&&d.l(p),h=ir()},m(p,y){d&&d.m(p,y),Le(p,h,y)},p(p,[y]){p[3]&&p[4]?d?d.p(p,y):(d=im(p),d.c(),d.m(h.parentNode,h)):d&&(d.d(1),d=null)},i:ei,o:ei,d(p){d&&d.d(p),p&&ne(h)}}}function U0(l,h,d){let{data:p}=h,{yKey:y="y"}=h,{colors:v=["#00205B","#308182","#002417","#BD00BD","lightgrey"]}=h,a,k;function T(){d(3,a=p.map(M=>M[y]).reduce((M,N)=>M+N,0));let F=[0];p.forEach(M=>F.push(F[F.length-1]+M[y])),d(4,k=F)}return l.$$set=F=>{"data"in F&&d(0,p=F.data),"yKey"in F&&d(1,y=F.yKey),"colors"in F&&d(2,v=F.colors)},l.$$.update=()=>{l.$$.dirty&3&&(p||y)&&T()},[p,y,v,a,k]}class Kp extends an{constructor(h){super(),on(this,h,U0,N0,sn,{data:0,yKey:1,colors:2})}}function am(l,h,d){const p=l.slice();return p[10]=h[d],p[12]=d,p}function V0(l){let h,d,p=l[6](l[10][l[3]])+"",y,v;return{c(){h=Ue("span"),d=Tt("(NI "),y=Tt(p),v=Tt(")"),this.h()},l(a){h=Ve(a,"SPAN",{class:!0,style:!0});var k=Be(h);d=It(k,"(NI "),y=It(k,p),v=It(k,")"),k.forEach(ne),this.h()},h(){ie(h,"class",""),We(h,"color","#1460aa")},m(a,k){Le(a,h,k),xe(h,d),xe(h,y),xe(h,v)},p(a,k){k&9&&p!==(p=a[6](a[10][a[3]])+"")&&wr(y,p)},d(a){a&&ne(h)}}}function q0(l){let h;return{c(){h=Ue("span"),this.h()},l(d){h=Ve(d,"SPAN",{class:!0,style:!0}),Be(h).forEach(ne),this.h()},h(){ie(h,"class",""),We(h,"color","#1460aa")},m(d,p){Le(d,h,p)},p:ei,d(d){d&&ne(h)}}}function j0(l){let h,d,p=gd(Math.round(l[10][l[3]]),"%)")+"",y;return{c(){h=Ue("span"),d=Tt("(2011 "),y=Tt(p),this.h()},l(v){h=Ve(v,"SPAN",{class:!0,style:!0});var a=Be(h);d=It(a,"(2011 "),y=It(a,p),a.forEach(ne),this.h()},h(){ie(h,"class",""),We(h,"color","#1460aa")},m(v,a){Le(v,h,a),xe(h,d),xe(h,y)},p(v,a){a&9&&p!==(p=gd(Math.round(v[10][v[3]]),"%)")+"")&&wr(y,p)},d(v){v&&ne(h)}}}function om(l){let h,d,p,y,v,a=l[10][l[1]]+"",k,T,F,M=l[6](l[10][l[2]])+"",N,R,X;function Q(de,ge){if(de[3]=="prev"&&de[4])return j0;if(de[3]=="prev"&&!de[4])return q0;if(de[3])return V0}let ae=Q(l),le=ae&&ae(l);return{c(){h=Ue("tr"),d=Ue("td"),p=Wn("svg"),y=Wn("rect"),v=yt(),k=Tt(a),T=yt(),F=Ue("td"),N=Tt(M),R=yt(),le&&le.c(),X=yt(),this.h()},l(de){h=Ve(de,"TR",{});var ge=Be(h);d=Ve(ge,"TD",{class:!0});var rt=Be(d);p=Yn(rt,"svg",{width:!0,height:!0,class:!0});var Fe=Be(p);y=Yn(Fe,"rect",{width:!0,height:!0,style:!0}),Be(y).forEach(ne),Fe.forEach(ne),v=gt(rt),k=It(rt,a),rt.forEach(ne),T=gt(ge),F=Ve(ge,"TD",{class:!0,style:!0});var ze=Be(F);N=It(ze,M),R=gt(ze),le&&le.l(ze),ze.forEach(ne),X=gt(ge),ge.forEach(ne),this.h()},h(){ie(y,"width","20"),ie(y,"height","30"),We(y,"fill",l[5][l[12]]),ie(p,"width","20"),ie(p,"height","30"),ie(p,"class","bullet svelte-1gvovsq"),ie(d,"class","svelte-1gvovsq"),ie(F,"class","cell-right svelte-1gvovsq"),We(F,"vertical-align","top")},m(de,ge){Le(de,h,ge),xe(h,d),xe(d,p),xe(p,y),xe(d,v),xe(d,k),xe(h,T),xe(h,F),xe(F,N),xe(F,R),le&&le.m(F,null),xe(h,X)},p(de,ge){ge&32&&We(y,"fill",de[5][de[12]]),ge&3&&a!==(a=de[10][de[1]]+"")&&wr(k,a),ge&5&&M!==(M=de[6](de[10][de[2]])+"")&&wr(N,M),ae===(ae=Q(de))&&le?le.p(de,ge):(le&&le.d(1),le=ae&&ae(de),le&&(le.c(),le.m(F,null)))},d(de){de&&ne(h),le&&le.d()}}}function G0(l){let h,d,p=l[0],y=[];for(let v=0;v<p.length;v+=1)y[v]=om(am(l,p,v));return{c(){h=Ue("table"),d=Ue("tbody");for(let v=0;v<y.length;v+=1)y[v].c();this.h()},l(v){h=Ve(v,"TABLE",{class:!0});var a=Be(h);d=Ve(a,"TBODY",{});var k=Be(d);for(let T=0;T<y.length;T+=1)y[T].l(k);k.forEach(ne),a.forEach(ne),this.h()},h(){ie(h,"class","legend svelte-1gvovsq")},m(v,a){Le(v,h,a),xe(h,d);for(let k=0;k<y.length;k+=1)y[k]&&y[k].m(d,null)},p(v,[a]){if(a&127){p=v[0];let k;for(k=0;k<p.length;k+=1){const T=am(v,p,k);y[k]?y[k].p(T,a):(y[k]=om(T),y[k].c(),y[k].m(d,null))}for(;k<y.length;k+=1)y[k].d(1);y.length=p.length}},i:ei,o:ei,d(v){v&&ne(h),nn(y,v)}}}function Z0(l,h,d){let p,{data:y}=h,{xKey:v="x"}=h,{yKey:a="y"}=h,{zKey:k="ni"}=h,{topic_prev_available:T=!0}=h,{colors:F=["#3878c5","#00205B","#308182","#002417","#BD00BD","lightgrey"]}=h,{decimals:M=null}=h;function N(R){let X;return M?X=(R/p*100).toFixed(M)+"%":R/p*100<1?X="<1%":X=(R/p*100).toFixed(0)+"%",X}return l.$$set=R=>{"data"in R&&d(0,y=R.data),"xKey"in R&&d(1,v=R.xKey),"yKey"in R&&d(2,a=R.yKey),"zKey"in R&&d(3,k=R.zKey),"topic_prev_available"in R&&d(4,T=R.topic_prev_available),"colors"in R&&d(5,F=R.colors),"decimals"in R&&d(7,M=R.decimals)},l.$$.update=()=>{l.$$.dirty&5&&(p=y.map(R=>R[a]).reduce((R,X)=>R+X,0)),l.$$.dirty&9&&y.map(R=>R[k]).reduce((R,X)=>R+X,0)},[y,v,a,k,T,F,N,M]}class K0 extends an{constructor(h){super(),on(this,h,Z0,G0,sn,{data:0,xKey:1,yKey:2,zKey:3,topic_prev_available:4,colors:5,decimals:7})}}function sm(l){let h,d,p,y;d=new Kp({props:{data:l[0],yKey:l[4],colors:l[6]}});let v=l[8]&&lm(l);return{c(){h=Ue("div"),ur(d.$$.fragment),p=yt(),v&&v.c(),this.h()},l(a){h=Ve(a,"DIV",{class:!0,style:!0});var k=Be(h);cr(d.$$.fragment,k),p=gt(k),v&&v.l(k),k.forEach(ne),this.h()},h(){ie(h,"class","chart svelte-1tebgpk"),We(h,"height",l[1]*.28+"px")},m(a,k){Le(a,h,k),hr(d,h,null),xe(h,p),v&&v.m(h,null),y=!0},p(a,k){const T={};k&1&&(T.data=a[0]),k&16&&(T.yKey=a[4]),k&64&&(T.colors=a[6]),d.$set(T),a[8]?v?v.p(a,k):(v=lm(a),v.c(),v.m(h,null)):v&&(v.d(1),v=null),(!y||k&2)&&We(h,"height",a[1]*.28+"px")},i(a){y||(ot(d.$$.fragment,a),y=!0)},o(a){ft(d.$$.fragment,a),y=!1},d(a){a&&ne(h),pr(d),v&&v.d()}}}function lm(l){let h,d;return{c(){h=Ue("div"),d=Tt(l[8]),this.h()},l(p){h=Ve(p,"DIV",{class:!0});var y=Be(h);d=It(y,l[8]),y.forEach(ne),this.h()},h(){ie(h,"class","label svelte-1tebgpk")},m(p,y){Le(p,h,y),xe(h,d)},p(p,y){y&256&&wr(d,p[8])},d(p){p&&ne(h)}}}function um(l){let h,d,p,y,v,a;return d=new Kp({props:{data:l[0],yKey:l[4],colors:l[6]}}),{c(){h=Ue("div"),ur(d.$$.fragment),p=yt(),y=Ue("div"),v=Tt("2011 comparison not available"),this.h()},l(k){h=Ve(k,"DIV",{class:!0,style:!0});var T=Be(h);cr(d.$$.fragment,T),p=gt(T),y=Ve(T,"DIV",{class:!0,style:!0});var F=Be(y);v=It(F,"2011 comparison not available"),F.forEach(ne),T.forEach(ne),this.h()},h(){ie(y,"class","label svelte-1tebgpk"),We(y,"background-color","#d8d8d8 "),We(y,"color","#000000"),ie(h,"class","chart svelte-1tebgpk"),We(h,"height",l[1]*.28+"px")},m(k,T){Le(k,h,T),hr(d,h,null),xe(h,p),xe(h,y),xe(y,v),a=!0},p(k,T){const F={};T&1&&(F.data=k[0]),T&16&&(F.yKey=k[4]),T&64&&(F.colors=k[6]),d.$set(F),(!a||T&2)&&We(h,"height",k[1]*.28+"px")},i(k){a||(ot(d.$$.fragment,k),a=!0)},o(k){ft(d.$$.fragment,k),a=!1},d(k){k&&ne(h),pr(d)}}}function H0(l){let h,d,p,y,v,a,k,T;d=new Kp({props:{data:l[0],yKey:l[3],colors:l[6]}});let F=(l[4]&&l[5]||l[4]=="ni")&&sm(l),M=l[4]=="prev"&&!l[5]&&um(l);return k=new K0({props:{data:l[0],xKey:l[2],yKey:l[3],zKey:l[4],topic_prev_available:l[5],decimals:l[7],colors:l[6]}}),{c(){h=Ue("div"),ur(d.$$.fragment),p=yt(),F&&F.c(),y=yt(),M&&M.c(),v=yt(),a=Ue("div"),ur(k.$$.fragment),this.h()},l(N){h=Ve(N,"DIV",{class:!0,style:!0});var R=Be(h);cr(d.$$.fragment,R),R.forEach(ne),p=gt(N),F&&F.l(N),y=gt(N),M&&M.l(N),v=gt(N),a=Ve(N,"DIV",{class:!0});var X=Be(a);cr(k.$$.fragment,X),X.forEach(ne),this.h()},h(){ie(h,"class","chart svelte-1tebgpk"),We(h,"padding-top","3px"),We(h,"height",(l[4]?l[1]*.72:l[1])+"px"),ie(a,"class","legend svelte-1tebgpk")},m(N,R){Le(N,h,R),hr(d,h,null),Le(N,p,R),F&&F.m(N,R),Le(N,y,R),M&&M.m(N,R),Le(N,v,R),Le(N,a,R),hr(k,a,null),T=!0},p(N,[R]){const X={};R&1&&(X.data=N[0]),R&8&&(X.yKey=N[3]),R&64&&(X.colors=N[6]),d.$set(X),(!T||R&18)&&We(h,"height",(N[4]?N[1]*.72:N[1])+"px"),N[4]&&N[5]||N[4]=="ni"?F?(F.p(N,R),R&48&&ot(F,1)):(F=sm(N),F.c(),ot(F,1),F.m(y.parentNode,y)):F&&(Ln(),ft(F,1,1,()=>{F=null}),Rn()),N[4]=="prev"&&!N[5]?M?(M.p(N,R),R&48&&ot(M,1)):(M=um(N),M.c(),ot(M,1),M.m(v.parentNode,v)):M&&(Ln(),ft(M,1,1,()=>{M=null}),Rn());const Q={};R&1&&(Q.data=N[0]),R&4&&(Q.xKey=N[2]),R&8&&(Q.yKey=N[3]),R&16&&(Q.zKey=N[4]),R&32&&(Q.topic_prev_available=N[5]),R&128&&(Q.decimals=N[7]),R&64&&(Q.colors=N[6]),k.$set(Q)},i(N){T||(ot(d.$$.fragment,N),ot(F),ot(M),ot(k.$$.fragment,N),T=!0)},o(N){ft(d.$$.fragment,N),ft(F),ft(M),ft(k.$$.fragment,N),T=!1},d(N){N&&ne(h),pr(d),N&&ne(p),F&&F.d(N),N&&ne(y),M&&M.d(N),N&&ne(v),N&&ne(a),pr(k)}}}function X0(l,h,d){let{data:p}=h,{height:y=80}=h,{xKey:v="x"}=h,{yKey:a="y"}=h,{zKey:k="ni"}=h,{topic_prev_available:T=!0}=h,{colors:F=["#8268b6","#00205B","#308182","#3d007a","#3878c5","lightgrey"]}=h,{decimals:M=null}=h,{label:N=null}=h;return l.$$set=R=>{"data"in R&&d(0,p=R.data),"height"in R&&d(1,y=R.height),"xKey"in R&&d(2,v=R.xKey),"yKey"in R&&d(3,a=R.yKey),"zKey"in R&&d(4,k=R.zKey),"topic_prev_available"in R&&d(5,T=R.topic_prev_available),"colors"in R&&d(6,F=R.colors),"decimals"in R&&d(7,M=R.decimals),"label"in R&&d(8,N=R.label)},[p,y,v,a,k,T,F,M,N]}class Hp extends an{constructor(h){super(),on(this,h,X0,H0,sn,{data:0,height:1,xKey:2,yKey:3,zKey:4,topic_prev_available:5,colors:6,decimals:7,label:8})}}function cm(l,h,d){const p=l.slice();return p[15]=h[d],p}function hm(l,h,d){const p=l.slice();return p[18]=h[d],p[19]=h,p[20]=d,p}function pm(l,h,d){const p=l.slice();return p[15]=h[d],p[20]=d,p}function fm(l){let h,d=l[5],p=[];for(let y=0;y<d.length;y+=1)p[y]=dm(pm(l,d,y));return{c(){h=Ue("ul");for(let y=0;y<p.length;y+=1)p[y].c();this.h()},l(y){h=Ve(y,"UL",{class:!0});var v=Be(h);for(let a=0;a<p.length;a+=1)p[a].l(v);v.forEach(ne),this.h()},h(){ie(h,"class","legend-block svelte-sk00pb")},m(y,v){Le(y,h,v);for(let a=0;a<p.length;a+=1)p[a]&&p[a].m(h,null)},p(y,v){if(v&32){d=y[5];let a;for(a=0;a<d.length;a+=1){const k=pm(y,d,a);p[a]?p[a].p(k,v):(p[a]=dm(k),p[a].c(),p[a].m(h,null))}for(;a<p.length;a+=1)p[a].d(1);p.length=d.length}},d(y){y&&ne(h),nn(p,y)}}}function dm(l){let h,d,p,y,v=l[15]+"",a,k;return{c(){h=Ue("li"),d=Ue("div"),p=yt(),y=Ue("span"),a=Tt(v),k=yt(),this.h()},l(T){h=Ve(T,"LI",{class:!0});var F=Be(h);d=Ve(F,"DIV",{class:!0}),Be(d).forEach(ne),p=gt(F),y=Ve(F,"SPAN",{});var M=Be(y);a=It(M,v),M.forEach(ne),k=gt(F),F.forEach(ne),this.h()},h(){ie(d,"class","legend-vis "+(l[20]==0?"bar":"bar2")+" svelte-sk00pb"),ie(h,"class","svelte-sk00pb")},m(T,F){Le(T,h,F),xe(h,d),xe(h,p),xe(h,y),xe(y,a),xe(h,k)},p(T,F){F&32&&v!==(v=T[15]+"")&&wr(a,v)},d(T){T&&ne(h)}}}function mm(l){let h,d=`${l[4](l[18][l[0]])}%`,p,y,v=gm(l[18][l[0]])+"",a,k,T=`calc(${l[4](l[18][l[0]])}% + 2px)`;function F(){l[12].call(y,l[19],l[20])}return{c(){h=Ue("div"),p=yt(),y=Ue("div"),a=Tt(v),this.h()},l(M){h=Ve(M,"DIV",{class:!0}),Be(h).forEach(ne),p=gt(M),y=Ve(M,"DIV",{class:!0});var N=Be(y);a=It(N,v),N.forEach(ne),this.h()},h(){ie(h,"class",zh(l[20]==0?"bar":"bar2")+" svelte-sk00pb"),We(h,"left","0"),We(h,"width",d),We(h,"top",l[20]==0?"0":"50%"),We(h,"height",l[5][1]?"50%":"100%"),ie(y,"class","label svelte-sk00pb"),Gu(()=>F.call(y)),We(y,"left",T),We(y,"top",l[20]==0?"0":"50%"),We(y,"height","50%")},m(M,N){Le(M,h,N),Le(M,p,N),Le(M,y,N),xe(y,a),k=Zu(y,F.bind(y))},p(M,N){l=M,N&25&&d!==(d=`${l[4](l[18][l[0]])}%`)&&We(h,"width",d),N&32&&We(h,"height",l[5][1]?"50%":"100%"),N&9&&v!==(v=gm(l[18][l[0]])+"")&&wr(a,v),N&25&&T!==(T=`calc(${l[4](l[18][l[0]])}% + 2px)`)&&We(y,"left",T)},d(M){M&&ne(h),M&&ne(p),M&&ne(y),k()}}}function ym(l){let h,d=l[15].label+"",p,y,v,a,k=`${l[5][1]?l[1]*2:l[1]}px`,T=`calc(100% - ${l[2]}px)`,F=l[15].values,M=[];for(let N=0;N<F.length;N+=1)M[N]=mm(hm(l,F,N));return{c(){h=Ue("div"),p=Tt(d),y=yt(),v=Ue("div");for(let N=0;N<M.length;N+=1)M[N].c();a=yt(),this.h()},l(N){h=Ve(N,"DIV",{class:!0});var R=Be(h);p=It(R,d),R.forEach(ne),y=gt(N),v=Ve(N,"DIV",{class:!0});var X=Be(v);for(let Q=0;Q<M.length;Q+=1)M[Q].l(X);a=gt(X),X.forEach(ne),this.h()},h(){ie(h,"class","label-group svelte-sk00pb"),ie(v,"class","bar-group svelte-sk00pb"),We(v,"height",k),We(v,"width",T)},m(N,R){Le(N,h,R),xe(h,p),Le(N,y,R),Le(N,v,R);for(let X=0;X<M.length;X+=1)M[X]&&M[X].m(v,null);xe(v,a)},p(N,R){if(R&8&&d!==(d=N[15].label+"")&&wr(p,d),R&57){F=N[15].values;let X;for(X=0;X<F.length;X+=1){const Q=hm(N,F,X);M[X]?M[X].p(Q,R):(M[X]=mm(Q),M[X].c(),M[X].m(v,a))}for(;X<M.length;X+=1)M[X].d(1);M.length=F.length}R&34&&k!==(k=`${N[5][1]?N[1]*2:N[1]}px`)&&We(v,"height",k),R&4&&T!==(T=`calc(100% - ${N[2]}px)`)&&We(v,"width",T)},d(N){N&&ne(h),N&&ne(y),N&&ne(v),nn(M,N)}}}function W0(l){let h,d,p=l[5][1]&&fm(l),y=l[3],v=[];for(let a=0;a<y.length;a+=1)v[a]=ym(cm(l,y,a));return{c(){p&&p.c(),h=yt();for(let a=0;a<v.length;a+=1)v[a].c();d=ir()},l(a){p&&p.l(a),h=gt(a);for(let k=0;k<v.length;k+=1)v[k].l(a);d=ir()},m(a,k){p&&p.m(a,k),Le(a,h,k);for(let T=0;T<v.length;T+=1)v[T]&&v[T].m(a,k);Le(a,d,k)},p(a,[k]){if(a[5][1]?p?p.p(a,k):(p=fm(a),p.c(),p.m(h.parentNode,h)):p&&(p.d(1),p=null),k&63){y=a[3];let T;for(T=0;T<y.length;T+=1){const F=cm(a,y,T);v[T]?v[T].p(F,k):(v[T]=ym(F),v[T].c(),v[T].m(d.parentNode,d))}for(;T<v.length;T+=1)v[T].d(1);v.length=y.length}},i:ei,o:ei,d(a){p&&p.d(a),a&&ne(h),nn(v,a),a&&ne(d)}}}function gm(l){let h;return l==null?h="Not available":l<1?h="<1%":h=l.toFixed(0)+"%",h}function Y0(l,h,d){let p,y,v,a,{data:k}=h,{xKey:T="perc"}=h,{yKey:F="category"}=h,{zKey:M="ni"}=h,{formatTick:N=de=>Math.round(de)}=h,{suffix:R="%"}=h,{barHeight:X=20}=h,{margin:Q=30}=h;function ae(de,ge){let rt={};for(const ze of de)rt[ze[ge]]||(rt[ze[ge]]={label:ze[ge],values:[]}),rt[ze[ge]].values.push(ze);let Fe=[];for(const ze in rt)Fe.push(rt[ze]);return Fe}function le(de,ge){de[ge].width=this.clientWidth,d(3,a),d(6,k),d(7,F)}return l.$$set=de=>{"data"in de&&d(6,k=de.data),"xKey"in de&&d(0,T=de.xKey),"yKey"in de&&d(7,F=de.yKey),"zKey"in de&&d(8,M=de.zKey),"formatTick"in de&&d(9,N=de.formatTick),"suffix"in de&&d(10,R=de.suffix),"barHeight"in de&&d(1,X=de.barHeight),"margin"in de&&d(2,Q=de.margin)},l.$$.update=()=>{l.$$.dirty&65&&d(11,p=[0,Math.max(...k.map(de=>de[T]))]),l.$$.dirty&192&&k.map(de=>de[F]).filter((de,ge,rt)=>rt.indexOf(de)===ge),l.$$.dirty&320&&d(5,y=k.map(de=>de[M]).filter((de,ge,rt)=>rt.indexOf(de)===ge)),l.$$.dirty&2048&&d(4,v=de=>de/p[1]*100),l.$$.dirty&192&&d(3,a=ae(k,F))},[T,X,Q,a,v,y,k,F,M,N,R,p,le]}class J0 extends an{constructor(h){super(),on(this,h,Y0,W0,sn,{data:6,xKey:0,yKey:7,zKey:8,formatTick:9,suffix:10,barHeight:1,margin:2})}}function _m(l,h,d){const p=l.slice();return p[14]=h[d],p}function vm(l,h,d){const p=l.slice();return p[17]=h[d],p[19]=d,p}function bm(l,h,d){const p=l.slice();return p[17]=h[d],p[19]=d,p}function xm(l,h,d){const p=l.slice();return p[14]=h[d],p[19]=d,p}function wm(l){let h,d=l[7],p=[];for(let y=0;y<d.length;y+=1)p[y]=Sm(xm(l,d,y));return{c(){h=Ue("ul");for(let y=0;y<p.length;y+=1)p[y].c();this.h()},l(y){h=Ve(y,"UL",{class:!0});var v=Be(h);for(let a=0;a<p.length;a+=1)p[a].l(v);v.forEach(ne),this.h()},h(){ie(h,"class","legend svelte-1hk4284")},m(y,v){Le(y,h,v);for(let a=0;a<p.length;a+=1)p[a]&&p[a].m(h,null)},p(y,v){if(v&144){d=y[7];let a;for(a=0;a<d.length;a+=1){const k=xm(y,d,a);p[a]?p[a].p(k,v):(p[a]=Sm(k),p[a].c(),p[a].m(h,null))}for(;a<p.length;a+=1)p[a].d(1);p.length=d.length}},d(y){y&&ne(h),nn(p,y)}}}function Sm(l){let h,d,p,y,v=l[14]+"",a,k;return{c(){h=Ue("li"),d=Ue("div"),p=yt(),y=Ue("span"),a=Tt(v),k=yt(),this.h()},l(T){h=Ve(T,"LI",{class:!0});var F=Be(h);d=Ve(F,"DIV",{class:!0}),Be(d).forEach(ne),p=gt(F),y=Ve(F,"SPAN",{class:!0});var M=Be(y);a=It(M,v),M.forEach(ne),k=gt(F),F.forEach(ne),this.h()},h(){ie(d,"class","legend-vis "+(l[19]==0?"bar":"marker")+" svelte-1hk4284"),We(d,"height","1rem"),We(d,"width",l[19]==0?"1rem":l[4]+"px"),ie(y,"class",zh(l[19]==0?"bold":"brackets")+" svelte-1hk4284"),ie(h,"class","svelte-1hk4284")},m(T,F){Le(T,h,F),xe(h,d),xe(h,p),xe(h,y),xe(y,a),xe(h,k)},p(T,F){F&16&&We(d,"width",T[19]==0?"1rem":T[4]+"px"),F&128&&v!==(v=T[14]+"")&&wr(a,v)},d(T){T&&ne(h)}}}function Em(l){let h,d=l[1](l[17].perc/100)+"",p,y;return{c(){h=Ue("span"),p=Tt(d),y=Tt(l[2]),this.h()},l(v){h=Ve(v,"SPAN",{class:!0,style:!0});var a=Be(h);p=It(a,d),y=It(a,l[2]),a.forEach(ne),this.h()},h(){ie(h,"class",zh(l[19]==0?"bold":"sml brackets")+" svelte-1hk4284"),We(h,"color",l[19]==0?"#000000":"#1460aa")},m(v,a){Le(v,h,a),xe(h,p),xe(h,y)},p(v,a){a&34&&d!==(d=v[1](v[17].perc/100)+"")&&wr(p,d),a&4&&wr(y,v[2])},d(v){v&&ne(h)}}}function Q0(l){let h,d=`calc(${l[6](l[17][l[0]])}% - ${l[4]/2}px)`,p=`${l[4]}px`;return{c(){h=Ue("div"),this.h()},l(y){h=Ve(y,"DIV",{class:!0}),Be(h).forEach(ne),this.h()},h(){ie(h,"class","marker svelte-1hk4284"),We(h,"left",d),We(h,"border-left-width",p)},m(y,v){Le(y,h,v)},p(y,v){v&113&&d!==(d=`calc(${y[6](y[17][y[0]])}% - ${y[4]/2}px)`)&&We(h,"left",d),v&16&&p!==(p=`${y[4]}px`)&&We(h,"border-left-width",p)},d(y){y&&ne(h)}}}function $0(l){let h,d=`${l[6](l[17][l[0]])}%`;return{c(){h=Ue("div"),this.h()},l(p){h=Ve(p,"DIV",{class:!0}),Be(h).forEach(ne),this.h()},h(){ie(h,"class","bar svelte-1hk4284"),We(h,"left","0"),We(h,"width",d)},m(p,y){Le(p,h,y)},p(p,y){y&97&&d!==(d=`${p[6](p[17][p[0]])}%`)&&We(h,"width",d)},d(p){p&&ne(h)}}}function km(l){let h;function d(v,a){return v[19]==0?$0:Q0}let y=d(l)(l);return{c(){y.c(),h=ir()},l(v){y.l(v),h=ir()},m(v,a){y.m(v,a),Le(v,h,a)},p(v,a){y.p(v,a)},d(v){y.d(v),v&&ne(h)}}}function Tm(l){let h,d=l[14].label+"",p,y,v,a,k,T=`${l[3]}px`,F=l[14].values,M=[];for(let X=0;X<F.length;X+=1)M[X]=Em(bm(l,F,X));let N=l[14].values,R=[];for(let X=0;X<N.length;X+=1)R[X]=km(vm(l,N,X));return{c(){h=Ue("div"),p=Tt(d),y=yt();for(let X=0;X<M.length;X+=1)M[X].c();v=yt(),a=Ue("div");for(let X=0;X<R.length;X+=1)R[X].c();k=yt(),this.h()},l(X){h=Ve(X,"DIV",{class:!0});var Q=Be(h);p=It(Q,d),y=gt(Q);for(let le=0;le<M.length;le+=1)M[le].l(Q);Q.forEach(ne),v=gt(X),a=Ve(X,"DIV",{class:!0});var ae=Be(a);for(let le=0;le<R.length;le+=1)R[le].l(ae);k=gt(ae),ae.forEach(ne),this.h()},h(){ie(h,"class","label-group svelte-1hk4284"),ie(a,"class","bar-group svelte-1hk4284"),We(a,"height",T)},m(X,Q){Le(X,h,Q),xe(h,p),xe(h,y);for(let ae=0;ae<M.length;ae+=1)M[ae]&&M[ae].m(h,null);Le(X,v,Q),Le(X,a,Q);for(let ae=0;ae<R.length;ae+=1)R[ae]&&R[ae].m(a,null);xe(a,k)},p(X,Q){if(Q&32&&d!==(d=X[14].label+"")&&wr(p,d),Q&38){F=X[14].values;let ae;for(ae=0;ae<F.length;ae+=1){const le=bm(X,F,ae);M[ae]?M[ae].p(le,Q):(M[ae]=Em(le),M[ae].c(),M[ae].m(h,null))}for(;ae<M.length;ae+=1)M[ae].d(1);M.length=F.length}if(Q&113){N=X[14].values;let ae;for(ae=0;ae<N.length;ae+=1){const le=vm(X,N,ae);R[ae]?R[ae].p(le,Q):(R[ae]=km(le),R[ae].c(),R[ae].m(a,k))}for(;ae<R.length;ae+=1)R[ae].d(1);R.length=N.length}Q&8&&T!==(T=`${X[3]}px`)&&We(a,"height",T)},d(X){X&&ne(h),nn(M,X),X&&ne(v),X&&ne(a),nn(R,X)}}}function e1(l){let h,d,p=l[7][1]&&wm(l),y=l[5],v=[];for(let a=0;a<y.length;a+=1)v[a]=Tm(_m(l,y,a));return{c(){p&&p.c(),h=yt();for(let a=0;a<v.length;a+=1)v[a].c();d=ir()},l(a){p&&p.l(a),h=gt(a);for(let k=0;k<v.length;k+=1)v[k].l(a);d=ir()},m(a,k){p&&p.m(a,k),Le(a,h,k);for(let T=0;T<v.length;T+=1)v[T]&&v[T].m(a,k);Le(a,d,k)},p(a,[k]){if(a[7][1]?p?p.p(a,k):(p=wm(a),p.c(),p.m(h.parentNode,h)):p&&(p.d(1),p=null),k&127){y=a[5];let T;for(T=0;T<y.length;T+=1){const F=_m(a,y,T);v[T]?v[T].p(F,k):(v[T]=Tm(F),v[T].c(),v[T].m(d.parentNode,d))}for(;T<v.length;T+=1)v[T].d(1);v.length=y.length}},i:ei,o:ei,d(a){p&&p.d(a),a&&ne(h),nn(v,a),a&&ne(d)}}}function t1(l,h,d){let p,y,v,a,{data:k}=h,{xKey:T="perc"}=h,{yKey:F="category"}=h,{zKey:M="group"}=h,{formatTick:N=le=>Math.round(100*le)}=h,{suffix:R="%"}=h,{barHeight:X=25}=h,{markerWidth:Q=3}=h;function ae(le,de){let ge={};for(const Fe of le)ge[Fe[de]]||(ge[Fe[de]]={label:Fe[de],values:[]}),ge[Fe[de]].values.push(Fe);let rt=[];for(const Fe in ge)rt.push(ge[Fe]);return rt}return l.$$set=le=>{"data"in le&&d(8,k=le.data),"xKey"in le&&d(0,T=le.xKey),"yKey"in le&&d(9,F=le.yKey),"zKey"in le&&d(10,M=le.zKey),"formatTick"in le&&d(1,N=le.formatTick),"suffix"in le&&d(2,R=le.suffix),"barHeight"in le&&d(3,X=le.barHeight),"markerWidth"in le&&d(4,Q=le.markerWidth)},l.$$.update=()=>{l.$$.dirty&257&&d(11,p=[0,Math.max(...k.map(le=>le[T]))]),l.$$.dirty&768&&k.map(le=>le[F]).filter((le,de,ge)=>ge.indexOf(le)===de),l.$$.dirty&1280&&d(7,y=k.map(le=>le[M]).filter((le,de,ge)=>ge.indexOf(le)===de)),l.$$.dirty&2048&&d(6,v=le=>le/p[1]*100),l.$$.dirty&768&&d(5,a=ae(k,F))},[T,N,R,X,Q,a,v,y,k,F,M,p]}class Xp extends an{constructor(h){super(),on(this,h,t1,e1,sn,{data:8,xKey:0,yKey:9,zKey:10,formatTick:1,suffix:2,barHeight:3,markerWidth:4})}}function Im(l,h,d){const p=l.slice();return p[12]=h[d],p[14]=d,p}function Pm(l,h,d){const p=l.slice();return p[15]=h[d],p[17]=d,p}function zm(l,h,d){const p=l.slice();return p[15]=h[d],p[17]=d,p}function Am(l,h,d){const p=l.slice();return p[19]=h[d],p[14]=d,p}function Cm(l){let h,d=l[5],p=[];for(let y=0;y<d.length;y+=1)p[y]=Mm(Am(l,d,y));return{c(){h=Ue("ul");for(let y=0;y<p.length;y+=1)p[y].c();this.h()},l(y){h=Ve(y,"UL",{class:!0});var v=Be(h);for(let a=0;a<p.length;a+=1)p[a].l(v);v.forEach(ne),this.h()},h(){ie(h,"class","legend svelte-pmaxst")},m(y,v){Le(y,h,v);for(let a=0;a<p.length;a+=1)p[a]&&p[a].m(h,null)},p(y,v){if(v&36){d=y[5];let a;for(a=0;a<d.length;a+=1){const k=Am(y,d,a);p[a]?p[a].p(k,v):(p[a]=Mm(k),p[a].c(),p[a].m(h,null))}for(;a<p.length;a+=1)p[a].d(1);p.length=d.length}},d(y){y&&ne(h),nn(p,y)}}}function Mm(l){let h,d,p,y,v=l[19]+"",a,k;return{c(){h=Ue("li"),d=Ue("div"),p=yt(),y=Ue("span"),a=Tt(v),k=yt(),this.h()},l(T){h=Ve(T,"LI",{class:!0});var F=Be(h);d=Ve(F,"DIV",{class:!0}),Be(d).forEach(ne),p=gt(F),y=Ve(F,"SPAN",{class:!0});var M=Be(y);a=It(M,v),M.forEach(ne),k=gt(F),F.forEach(ne),this.h()},h(){ie(d,"class","legend-vis "+(l[14]==0?"bar":"markerSmall")+" svelte-pmaxst"),We(d,"height","1rem"),We(d,"width",l[14]==0?"1rem":l[2]+"px"),ie(y,"class",zh(l[14]==0?"bold":"brackets")+" svelte-pmaxst"),ie(h,"class","svelte-pmaxst")},m(T,F){Le(T,h,F),xe(h,d),xe(h,p),xe(h,y),xe(y,a),xe(h,k)},p(T,F){F&4&&We(d,"width",T[14]==0?"1rem":T[2]+"px"),F&32&&v!==(v=T[19]+"")&&wr(a,v)},d(T){T&&ne(h)}}}function r1(l){let h,d=l[12].values,p=[];for(let y=0;y<d.length;y+=1)p[y]=Dm(Pm(l,d,y));return{c(){for(let y=0;y<p.length;y+=1)p[y].c();h=ir()},l(y){for(let v=0;v<p.length;v+=1)p[v].l(y);h=ir()},m(y,v){for(let a=0;a<p.length;a+=1)p[a]&&p[a].m(y,v);Le(y,h,v)},p(y,v){if(v&89){d=y[12].values;let a;for(a=0;a<d.length;a+=1){const k=Pm(y,d,a);p[a]?p[a].p(k,v):(p[a]=Dm(k),p[a].c(),p[a].m(h.parentNode,h))}for(;a<p.length;a+=1)p[a].d(1);p.length=d.length}},d(y){nn(p,y),y&&ne(h)}}}function i1(l){let h,d=l[12].values,p=[];for(let y=0;y<d.length;y+=1)p[y]=Lm(zm(l,d,y));return{c(){for(let y=0;y<p.length;y+=1)p[y].c();h=ir()},l(y){for(let v=0;v<p.length;v+=1)p[v].l(y);h=ir()},m(y,v){for(let a=0;a<p.length;a+=1)p[a]&&p[a].m(y,v);Le(y,h,v)},p(y,v){if(v&89){d=y[12].values;let a;for(a=0;a<d.length;a+=1){const k=zm(y,d,a);p[a]?p[a].p(k,v):(p[a]=Lm(k),p[a].c(),p[a].m(h.parentNode,h))}for(;a<p.length;a+=1)p[a].d(1);p.length=d.length}},d(y){nn(p,y),y&&ne(h)}}}function Dm(l){let h,d,p=`calc(100% - ${l[15].offset<0?l[4](l[15][l[0]]-l[15].offset):l[4](l[15][l[0]])}%)`,y=`${l[4](l[15].offset)}%`,v=`${l[17]/l[6].length*100}%`,a=`${1/l[6].length*100}%`;return{c(){h=Ue("div"),this.h()},l(k){h=Ve(k,"DIV",{class:!0,style:!0}),Be(h).forEach(ne),this.h()},h(){ie(h,"class","marker svelte-pmaxst"),ie(h,"style",d="border-"+(l[15].offset<0?"top":"bottom")+": none"),We(h,"top",p),We(h,"height",y),We(h,"left",v),We(h,"width",a)},m(k,T){Le(k,h,T)},p(k,T){T&8&&d!==(d="border-"+(k[15].offset<0?"top":"bottom")+": none")&&ie(h,"style",d);const F=T&8;(F||T&25&&p!==(p=`calc(100% - ${k[15].offset<0?k[4](k[15][k[0]]-k[15].offset):k[4](k[15][k[0]])}%)`))&&We(h,"top",p),(F||T&24&&y!==(y=`${k[4](k[15].offset)}%`))&&We(h,"height",y),(F||T&72&&v!==(v=`${k[17]/k[6].length*100}%`))&&We(h,"left",v),(F||T&72&&a!==(a=`${1/k[6].length*100}%`))&&We(h,"width",a)},d(k){k&&ne(h)}}}function Lm(l){let h,d=`${100-l[4](l[15][l[0]])}%`,p=`${l[4](l[15][l[0]])}%`,y=`${l[17]/l[6].length*100}%`,v=`calc(${1/l[6].length*100}% - 2px)`;return{c(){h=Ue("div"),this.h()},l(a){h=Ve(a,"DIV",{class:!0}),Be(h).forEach(ne),this.h()},h(){ie(h,"class","bar svelte-pmaxst"),We(h,"top",d),We(h,"height",p),We(h,"left",y),We(h,"width",v)},m(a,k){Le(a,h,k)},p(a,k){k&25&&d!==(d=`${100-a[4](a[15][a[0]])}%`)&&We(h,"top",d),k&25&&p!==(p=`${a[4](a[15][a[0]])}%`)&&We(h,"height",p),k&64&&y!==(y=`${a[17]/a[6].length*100}%`)&&We(h,"left",y),k&64&&v!==(v=`calc(${1/a[6].length*100}% - 2px)`)&&We(h,"width",v)},d(a){a&&ne(h)}}}function Rm(l){let h;function d(v,a){return v[14]==0?i1:r1}let y=d(l)(l);return{c(){y.c(),h=ir()},l(v){y.l(v),h=ir()},m(v,a){y.m(v,a),Le(v,h,a)},p(v,a){y.p(v,a)},d(v){y.d(v),v&&ne(h)}}}function n1(l){let h,d,p=`${l[1]}px`,y,v,a,k,T,F,M,N,R,X,Q,ae,le,de,ge=l[5][1]&&Cm(l),rt=l[3],Fe=[];for(let ze=0;ze<rt.length;ze+=1)Fe[ze]=Rm(Im(l,rt,ze));return{c(){ge&&ge.c(),h=yt(),d=Ue("div");for(let ze=0;ze<Fe.length;ze+=1)Fe[ze].c();y=yt(),v=Ue("div"),a=Ue("div"),k=Ue("div"),T=Tt("0-14"),F=yt(),M=Ue("div"),N=Tt("15-39"),R=yt(),X=Ue("div"),Q=Tt("40-64"),ae=yt(),le=Ue("div"),de=Tt("65+"),this.h()},l(ze){ge&&ge.l(ze),h=gt(ze),d=Ve(ze,"DIV",{class:!0});var Ge=Be(d);for(let qe=0;qe<Fe.length;qe+=1)Fe[qe].l(Ge);Ge.forEach(ne),y=gt(ze),v=Ve(ze,"DIV",{class:!0});var zt=Be(v);a=Ve(zt,"DIV",{class:!0});var wt=Be(a);k=Ve(wt,"DIV",{class:!0});var je=Be(k);T=It(je,"0-14"),je.forEach(ne),F=gt(wt),M=Ve(wt,"DIV",{class:!0});var Ze=Be(M);N=It(Ze,"15-39"),Ze.forEach(ne),R=gt(wt),X=Ve(wt,"DIV",{class:!0});var mt=Be(X);Q=It(mt,"40-64"),mt.forEach(ne),ae=gt(wt),le=Ve(wt,"DIV",{class:!0});var nr=Be(le);de=It(nr,"65+"),nr.forEach(ne),wt.forEach(ne),zt.forEach(ne),this.h()},h(){ie(d,"class","bar-group svelte-pmaxst"),We(d,"height",p),ie(k,"class","column svelte-pmaxst"),ie(M,"class","column svelte-pmaxst"),ie(X,"class","column svelte-pmaxst"),ie(le,"class","column svelte-pmaxst"),ie(a,"class","row svelte-pmaxst"),We(a,"width","100%"),ie(v,"class","x-scale svelte-pmaxst")},m(ze,Ge){ge&&ge.m(ze,Ge),Le(ze,h,Ge),Le(ze,d,Ge);for(let zt=0;zt<Fe.length;zt+=1)Fe[zt]&&Fe[zt].m(d,null);Le(ze,y,Ge),Le(ze,v,Ge),xe(v,a),xe(a,k),xe(k,T),xe(a,F),xe(a,M),xe(M,N),xe(a,R),xe(a,X),xe(X,Q),xe(a,ae),xe(a,le),xe(le,de)},p(ze,[Ge]){if(ze[5][1]?ge?ge.p(ze,Ge):(ge=Cm(ze),ge.c(),ge.m(h.parentNode,h)):ge&&(ge.d(1),ge=null),Ge&89){rt=ze[3];let zt;for(zt=0;zt<rt.length;zt+=1){const wt=Im(ze,rt,zt);Fe[zt]?Fe[zt].p(wt,Ge):(Fe[zt]=Rm(wt),Fe[zt].c(),Fe[zt].m(d,null))}for(;zt<Fe.length;zt+=1)Fe[zt].d(1);Fe.length=rt.length}Ge&2&&p!==(p=`${ze[1]}px`)&&We(d,"height",p)},i:ei,o:ei,d(ze){ge&&ge.d(ze),ze&&ne(h),ze&&ne(d),nn(Fe,ze),ze&&ne(y),ze&&ne(v)}}}function a1(l,h,d){let p,y,v,a,k,{data:T}=h,{xKey:F="category"}=h,{yKey:M="perc"}=h,{zKey:N="group"}=h,{height:R=100}=h,{markerWidth:X=3}=h;function Q(ae,le){let de={};for(const rt of ae){de[rt[le]]||(de[rt[le]]={label:rt[le],values:[]});let Fe=de[rt[le]].values.length,ze=Fe==0?0:rt[M]-de[rt[le]].values[Fe-1][M];de[rt[le]].values.push({...rt,offset:ze})}let ge=[];for(const rt in de)ge.push(de[rt]);return console.log(ge),ge}return l.$$set=ae=>{"data"in ae&&d(7,T=ae.data),"xKey"in ae&&d(8,F=ae.xKey),"yKey"in ae&&d(0,M=ae.yKey),"zKey"in ae&&d(9,N=ae.zKey),"height"in ae&&d(1,R=ae.height),"markerWidth"in ae&&d(2,X=ae.markerWidth)},l.$$.update=()=>{l.$$.dirty&384&&d(6,p=T.map(ae=>ae[F]).filter((ae,le,de)=>de.indexOf(ae)===le)),l.$$.dirty&129&&d(10,y=[0,Math.max(...T.map(ae=>ae[M]))]),l.$$.dirty&640&&d(5,v=T.map(ae=>ae[N]).filter((ae,le,de)=>de.indexOf(ae)===le)),l.$$.dirty&1024&&d(4,a=ae=>Math.abs(ae/y[1])*100),l.$$.dirty&640&&d(3,k=Q(T,N))},[M,R,X,k,a,v,p,T,F,N,y]}class Wp extends an{constructor(h){super(),on(this,h,a1,n1,sn,{data:7,xKey:8,yKey:0,zKey:9,height:1,markerWidth:2})}}function o1(l){let h,d,p,y,v;return{c(){h=Ue("div"),d=Ue("a"),p=Tt("Back to top"),this.h()},l(a){h=Ve(a,"DIV",{role:!0,class:!0});var k=Be(h);d=Ve(k,"A",{href:!0,tabindex:!0,class:!0});var T=Be(d);p=It(T,"Back to top"),T.forEach(ne),k.forEach(ne),this.h()},h(){ie(d,"href","#"),ie(d,"tabindex","0"),ie(d,"class","svelte-pkmw6o"),ie(h,"role","region"),ie(h,"class","back_to_start svelte-pkmw6o"),is(h,"hidden",l[0])},m(a,k){Le(a,h,k),xe(h,d),xe(d,p),y||(v=[Ip(window,"scroll",l[2]),Ip(h,"click",l[1])],y=!0)},p(a,[k]){k&1&&is(h,"hidden",a[0])},i:ei,o:ei,d(a){a&&ne(h),y=!1,h_(v)}}}function s1(l,h,d){let{buttonVisibleOnPX:p=200}=h,y=!0;const v=()=>{document.body.scrollIntoView()},a=()=>document.documentElement||document.body,k=()=>{a().scrollTop>p?d(0,y=!1):d(0,y=!0)};return l.$$set=T=>{"buttonVisibleOnPX"in T&&d(3,p=T.buttonVisibleOnPX)},[y,v,k,p]}class l1 extends an{constructor(h){super(),on(this,h,s1,o1,sn,{buttonVisibleOnPX:3})}}function u1(l){let h,d,p=l[4][l[0]].title+"",y,v,a,k,T,F,M,N,R,X=l[4][l[0]].info+"",Q,ae,le;return{c(){h=Ue("div"),d=Ue("div"),y=Tt(p),v=yt(),a=Ue("img"),M=yt(),N=Ue("div"),R=Ue("div"),this.h()},l(de){h=Ve(de,"DIV",{class:!0,style:!0,"data-bs-toggle":!0,"data-bs-target":!0,"aria-expanded":!0,"aria-controls":!0});var ge=Be(h);d=Ve(ge,"DIV",{class:!0,style:!0});var rt=Be(d);y=It(rt,p),v=gt(rt),a=Ve(rt,"IMG",{class:!0,src:!0,alt:!0}),rt.forEach(ne),ge.forEach(ne),M=gt(de),N=Ve(de,"DIV",{class:!0,id:!0});var Fe=Be(N);R=Ve(Fe,"DIV",{class:!0,"aria-hidden":!0});var ze=Be(R);ze.forEach(ne),Fe.forEach(ne),this.h()},h(){ie(a,"class","i-button"),Sh(a.src,k=kn+"\\img\\i-button.svg")||ie(a,"src",k),ie(a,"alt","Information button"),ie(d,"class","blocktitle"),We(d,"margin","0"),We(d,"width","100%"),ie(h,"class","row"),We(h,"display","flex"),We(h,"cursor","pointer"),ie(h,"data-bs-toggle","collapse"),ie(h,"data-bs-target",T="#"+l[0]+"-info"),ie(h,"aria-expanded","false"),ie(h,"aria-controls",F=l[0]+"-info"),ie(R,"class","card card-body svelte-1qrf6oz"),ie(R,"aria-hidden","true"),ie(N,"class","collapse svelte-1qrf6oz"),ie(N,"id",Q=l[0]+"-info")},m(de,ge){Le(de,h,ge),xe(h,d),xe(d,y),xe(d,v),xe(d,a),l[6](h),Le(de,M,ge),Le(de,N,ge),xe(N,R),R.innerHTML=X,l[7](R),ae||(le=Ip(d,"click",l[3]),ae=!0)},p(de,[ge]){ge&1&&p!==(p=de[4][de[0]].title+"")&&wr(y,p),ge&1&&T!==(T="#"+de[0]+"-info")&&ie(h,"data-bs-target",T),ge&1&&F!==(F=de[0]+"-info")&&ie(h,"aria-controls",F),ge&1&&X!==(X=de[4][de[0]].info+"")&&(R.innerHTML=X),ge&1&&Q!==(Q=de[0]+"-info")&&ie(N,"id",Q)},i:ei,o:ei,d(de){de&&ne(h),l[6](null),de&&ne(M),de&&ne(N),l[7](null),ae=!1,le()}}}function c1(l,h,d){let{id:p}=h,{place:y}=h,v,a;function k(R){let Q=R.replaceAll("[",".").replaceAll("]","").split("."),ae=y.meta_data;for(let le=0;le<Q.length;le++)if(ae.hasOwnProperty(Q[le])&&(ae=ae[Q[le]],Q[le]=="last_updated")){let de=ae.split("-");ae=de[2]+"/"+de[1]+"/"+de[0]}return ae}function T(){d(1,v.ariaHidden=!a.ariaExpanded,v)}let F={popden:{title:"Population density",info:"Population density is the number of usual residents per square kilometer. A square kilometer is approximately equivalent to the floor space of 8 Titanics. It is rounded to 1 decimal place. <p class = 'pibutton'>Access data at: <a href='"+k("MYETotal[0].dataset_url")+"'>"+k("MYETotal[0].title")+"</a></p><p class = 'pibutton'>Last updated: "+k("MYETotal[0].last_updated")+"</p> <p class = 'pibutton'><a href='mailto:"+k("MYETotal[0].email")+"'>Email for more information</a> </p>"},pop:{title:"Population",info:"Population is based on the number of usual residents.  <p class = 'pibutton'>Access data at: <a href='"+k("MYETotal[0].dataset_url")+"'>"+k("MYETotal[0].title")+"</a></p><p class = 'pibutton'>Last updated: "+k("MYETotal[0].last_updated")+"</p> <p class = 'pibutton'><a href='mailto:"+k("MYETotal[0].email")+"'>Email for more information</a> </p>"},generalhealth:{title:"General health",info:"<p>From Census 2021 data - <a href='https://explore.nisra.gov.uk/area-explorer-2021/'><strong>Census Area Explorer</strong></a></p>General health is a self-assessment of a person's general state of health. It is not based over any specified period of time. <a href='https://www.nisra.gov.uk/publications/census-2021-statistical-bulletins'><strong>Statistical bulletins</strong></a>"},wellbeing:{title:"Personal wellbeing",info:"Average Happiness score out of 10 for people aged 16+</p>Average Life satisfaction score out of 10 for people aged 16+</p><p class = 'pibutton'>Access data at: <a href='"+k("wellbeing[0].dataset_url")+"'>"+k("wellbeing[0].title")+"</a></p><p class = 'pibutton'>Last updated: "+k("wellbeing[0].last_updated")+"</p> <p class = 'pibutton'><a href='mailto:"+k("wellbeing[0].email")+"'>Email for more information</a> </p>"},lifeexpectancy:{title:"Life expectancy at birth",info:"<p class = 'pibutton'>Access data at: <a href='"+k("LE[0].dataset_url")+"'>"+k("LE[0].title")+"</a></p><p class = 'pibutton'>Last updated: "+k("LE[0].last_updated")+"</p> <p class = 'pibutton'><a href='mailto:"+k("LE[0].email")+"'>Email for more information</a> </p>"},carers:{title:"Unpaid care giving",info:"<p>From Census 2021 data - <a href='https://explore.nisra.gov.uk/area-explorer-2021/'><strong>Census Area Explorer</strong></a></p>Unpaid care covers looking after giving help or support to anyone because they have long-term physical or mental health conditions or illnesses, or problems related to old age. It does not include any activities as part of paid employment. All unpaid care statistics are restricted to persons aged 5 and over. <a href='https://www.nisra.gov.uk/publications/census-2021-statistical-bulletins'><strong>Statistical bulletins</strong></a>"},hospitalactivity:{title:"Annual admissions to hospital",info:"<p class = 'pibutton'>Access data at: <a href='"+k("Admiss[0].dataset_url")+"'>"+k("Admiss[0].title")+"</a></p><p class = 'pibutton'>Last updated: "+k("Admiss[0].last_updated")+"</p> <p class = 'pibutton'><a href='mailto:"+k("Admiss[0].email")+"'>Email for more information</a> </p>"},primarycare:{title:"Primary care providers",info:"<p class = 'pibutton'>Access data at: <a href='"+k("GP[0].dataset_url")+"'>"+k("GP[0].title")+"</a>, <a href='"+k("DEN[0].dataset_url")+"'>"+k("DEN[0].title")+"</a> and <a href='"+k("DEN_REG[0].dataset_url")+"'>"+k("DEN_REG[0].title")+"</a></p>"},employmentrates:{title:"Work status of adults",info:"<p class = 'pibutton'>Access data at: <a href='"+k("LMS[0].dataset_url")+"'>"+k("LMS[0].title")+"</a></p><p class = 'pibutton'>Last updated: "+k("LMS[0].last_updated")+"</p> <p class = 'pibutton'><a href='mailto:"+k("LMS[0].email")+"'>Email for more information</a> </p><p>Inactive includes students, early retirees, or people looking after a home, who are long-term sick or disabled. </p>"},employed:{title:"Work and wages",info:"<p class = 'pibutton'>Access data on number employed at: <a href='"+k("LMS[0].dataset_url")+"'>"+k("LMS[0].title")+"</a></p><p class = 'pibutton'>Last updated: "+k("LMS[0].last_updated")+"</p><p class = 'pibutton'><a href='mailto:"+k("LMS[0].email")+"'>Email for more information</a> </p><p >Access wages data at: <a href='"+k("ASHE[0].dataset_url")+"'>"+k("ASHE[0].title")+"</a></p><p class = 'pibutton'>Last updated: "+k("ASHE[0].last_updated")+"</p> <p class = 'pibutton'><a href='mailto:"+k("ASHE[0].email")+"'>Email for more information</a> </p><p>Median is the ..... </p>"},wages:{title:"Average annual wage",info:"<p class = 'pibutton'>Access data at: <a href='"+k("ASHE[0].dataset_url")+"'>"+k("ASHE[0].title")+"</a></p><p class = 'pibutton'>Last updated: "+k("ASHE[0].last_updated")+"</p> <p class = 'pibutton'><a href='mailto:"+k("ASHE[0].email")+"'>Email for more information</a> </p><p>Median is the ..... </p>"},bres:{title:"Type of work",info:"<p class = 'pibutton'>Access data at: <a href='"+k("BRES[0].dataset_url")+"'>"+k("BRES[0].title")+"</a></p><p class = 'pibutton'>Last updated: "+k("BRES[0].last_updated")+"</p><p class = 'pibutton'><a href='mailto:"+k("BRES[0].email")+"'>Email for more information</a> </p>"},pensionagebenefits:{title:"State Pension",info:"<p class = 'pibutton'>Access data at: <a href='"+k("BS[0].dataset_url")+"'>"+k("BS[0].title")+"</a></p><p class = 'pibutton'>Last updated: "+k("BS[0].last_updated")+"</p> <p class = 'pibutton'><a href='mailto:"+k("BS[0].email")+"'>Email for more information</a> </p>"},ucbenefits:{title:"Universal Credit",info:"<p class = 'pibutton'>Access data at: <a href='"+k("BS[0].dataset_url")+"'>"+k("BS[0].title")+"</a></p><p class = 'pibutton'>Last updated: "+k("BS[0].last_updated")+"</p> <p class = 'pibutton'><a href='mailto:"+k("BS[0].email")+"'>Email for more information</a> </p>"},pipbenefits:{title:"Personal Independence Payment",info:"<p class = 'pibutton'>Access data at:  <a href='"+k("BS[0].dataset_url")+"'>"+k("BS[0].title")+"</a></p><p class = 'pibutton'>Last updated: "+k("BS[0].last_updated")+"</p> <p class = 'pibutton'><a href='mailto:"+k("BS[0].email")+"'>Email for more information</a> </p>"},enrollments:{title:"People in education",info:"<p class = 'pibutton'>Access data at: <a href='"+k("Primary[0].dataset_url")+"'>"+k("Primary[0].title")+"</a>, <a href='"+k("PostPrimary[0].dataset_url")+"'>"+k("PostPrimary[0].title")+"</a>,  <a href='"+k("FE[0].dataset_url")+"'>"+k("FE[0].title")+"</a> and <a href='"+k("HE[0].dataset_url")+"'>"+k("HE[0].title")+"</a></p>"},fsme:{title:"Pupils entitled to free school meals",info:"<p class = 'pibutton'>Access data at: <a href='"+k("Primary[0].dataset_url")+"'>"+k("Primary[0].title")+"</a> and <a href='"+k("PostPrimary[0].dataset_url")+"'>"+k("PostPrimary[0].title")+"</a></p><p class = 'pibutton'>Last updated: "+k("Primary[0].last_updated")+"</p> <p class = 'pibutton'><a href='mailto:"+k("Primary[0].email")+"'>Email for more information</a> </p>"},teachers:{title:"School class size",info:"<p class = 'pibutton'>Access data at: <a href='"+k("ClassSize[0].dataset_url")+"'>"+k("ClassSize[0].title")+"</a></p><p class = 'pibutton'>Last updated: "+k("ClassSize[0].last_updated")+"</p> <p class = 'pibutton'><a href='mailto:"+k("ClassSize[0].email")+"'>Email for more information</a> </p>"},qualifications:{title:"Highest level of qualifications in the population",info:"<p>From Census 2021 data - <a href='https://explore.nisra.gov.uk/area-explorer-2021/'><strong>Census Area Explorer</strong></a></p>Needs tidied up with proper CSS.   The highest level of qualification categories are as follows:No qualifications;Level 1: 1 to 4 GCSEs, O levels, CSEs (any grades); 1 AS Level; NVQ level 1; or equivalent;Level 2: 5 or more GCSEs (A*-C or 9-4), O levels (passes) CSEs (grade 1); 1 A level, 2-3 AS Levels; NVQ level 2, BTEC General, City and Guilds Craft; or equivalent;Apprenticeship; Level 3: 2 or more A Levels, 4 or more AS Levels; NVQ Level 3, BTEC National, OND, ONC, City and Guilds Advanced Craft; or equivalent; Level 4 and above: Degree (BA, BSc), foundation degree, NVQ Level 4 and above, HND, HNC, professional qualifications (teaching or nursing, for example), or equivalent; and Other: Other qualifications, equivalent unknown.Highest level of qualification is derived from the question asking people aged 16 years and over to indicate all qualifications held. For qualifications gained outside Northern Ireland, respondents were directed to select the nearest equivalent."},attainment:{title:"GCSEs for school leavers",info:" <p class = 'pibutton'>Access data at: <a href='"+k("Attainment[0].dataset_url")+"'>"+k("Attainment[0].title")+"</a></p><p class = 'pibutton'>Last updated: "+k("Attainment[0].last_updated")+"</p><p class = 'pibutton'><a href='mailto:"+k("Attainment[0].email")+"'>Email for more information</a> </p>"},empty:{title:"",info:""},destination:{title:"Next steps for school leavers",info:" <p class = 'pibutton'>Access data at: <a href='"+k("Destination[0].dataset_url")+"'>"+k("Destination[0].title")+"</a></p><p class = 'pibutton'>Last updated: "+k("Destination[0].last_updated")+"</p> <p class = 'pibutton'><a href='mailto:"+k("Destination[0].email")+"'>Email for more information</a> </p>"},popchange:{title:"Population change",info:" <p class = 'pibutton'>Access data at: <a href='"+k("PopChange[0].dataset_url")+"'>"+k("PopChange[0].title")+"</a></p><p class = 'pibutton'>Last updated: "+k("PopChange[0].last_updated")+"</p> <p class = 'pibutton'><a href='mailto:"+k("PopChange[0].email")+"'>Email for more information</a> </p>"},broadage:{title:"Age",info:" <p class = 'pibutton'>Access data at: <a href='"+k("BroadAge[0].dataset_url")+"'>"+k("BroadAge[0].title")+"</a></p><p class = 'pibutton'>Last updated: "+k("BroadAge[0].last_updated")+"</p> <p class = 'pibutton'><a href='mailto:"+k("BroadAge[0].email")+"'>Email for more information</a> </p>"},hhsize:{title:"Household size",info:"<p>From Census 2021 data - <a href='https://explore.nisra.gov.uk/area-explorer-2021/'><strong>Census Area Explorer</strong></a></p>The number of usual residents in the household.      <a href='https://www.nisra.gov.uk/publications/census-2021-statistical-bulletins'><strong>Statistical bulletins</strong></a>"},religion:{title:"Religion, Religion brought up in",info:"<p>From Census 2021 data - <a href='https://explore.nisra.gov.uk/area-explorer-2021/'><strong>Census Area Explorer</strong></a></p>The religious group the person belongs to or for people with no current religion their religious group of upbringing.People with no current religion and no religion of upbringing are labelled 'None'.<a href='https://www.nisra.gov.uk/publications/census-2021-statistical-bulletins'><strong>Statistical bulletins</strong></a>"},language:{title:"Main language",info:"<p>From Census 2021 data - <a href='https://explore.nisra.gov.uk/area-explorer-2021/'><strong>Census Area Explorer</strong></a></p>Person's main language as declared in the Census.Statistics for all language questions are restrictedto persons aged 3 and over. <ahref='https://www.nisra.gov.uk/publications/census-2021-statistical-bulletins'><strong>Statistical bulletins</strong></a>"},households:{title:"Households - box with numbers",info:"<p>From Census 2021 data - <a href='https://explore.nisra.gov.uk/area-explorer-2021/'><strong>Census Area Explorer</strong></a></p>A household is either one person living alone or a group of people living at the same address who share cooking facilities and share a living room, sitting room or dining area. <a href='https://www.nisra.gov.uk/publications/census-2021-statistical-bulletins'><strong>Statistical bulletins</strong></a>"},SEN:{title:"Special educational needs",info:" <p class = 'pibutton'>Access data at:</p><p class = 'pibutton'><a href='"+k("SEN[0].dataset_url")+"'>"+k("SEN[0].title")+"</a></p><p class = 'pibutton'><a href='"+k("Primary[0].dataset_url")+"'>"+k("Primary[0].title")+"</a></p><p class = 'pibutton'><a href='"+k("PostPrimary[0].dataset_url")+"'>"+k("PostPrimary[0].title")+"</a></p><p class = 'pibutton'>Last updated: "+k("SEN[0].last_updated")+"</p><p class = 'pibutton'><a href='mailto:"+k("SEN[0].email")+"'>Email for more information</a> </p><p class = 'pibutton'>These figures include SEN pupils enrolled in Special Education Schools, Primary Schools and Post-Primary Schools.</p>"}};function M(R){Bs[R?"unshift":"push"](()=>{a=R,d(2,a)})}function N(R){Bs[R?"unshift":"push"](()=>{v=R,d(1,v)})}return l.$$set=R=>{"id"in R&&d(0,p=R.id),"place"in R&&d(5,y=R.place)},[p,v,a,T,F,y,M,N]}class h1 extends an{constructor(h){super(),on(this,h,c1,u1,sn,{id:0,place:5})}}function p1(l){let h;return{c(){h=Ue("h3"),this.h()},l(d){h=Ve(d,"H3",{style:!0});var p=Be(h);p.forEach(ne),this.h()},h(){We(h,"margin","0 0 10px 0")},m(d,p){Le(d,h,p),h.innerHTML=l[9]},p(d,p){p&512&&(h.innerHTML=d[9])},i:ei,o:ei,d(d){d&&ne(h)}}}function f1(l){let h,d;return h=new h1({props:{id:l[0],place:l[2]}}),{c(){ur(h.$$.fragment)},l(p){cr(h.$$.fragment,p)},m(p,y){hr(h,p,y),d=!0},p(p,y){const v={};y&1&&(v.id=p[0]),y&4&&(v.place=p[2]),h.$set(v)},i(p){d||(ot(h.$$.fragment,p),d=!0)},o(p){ft(h.$$.fragment,p),d=!1},d(p){pr(h,p)}}}function Bm(l){let h,d;return{c(){h=Ue("div"),d=Tt(l[12]),this.h()},l(p){h=Ve(p,"DIV",{class:!0});var y=Be(h);d=It(y,l[12]),y.forEach(ne),this.h()},h(){ie(h,"class","text-small")},m(p,y){Le(p,h,y),xe(h,d)},p(p,y){y&4096&&wr(d,p[12])},d(p){p&&ne(h)}}}function d1(l){let h,d;return{c(){h=new Bl(!1),d=ir(),this.h()},l(p){h=Fl(p,!1),d=ir(),this.h()},h(){h.a=d},m(p,y){h.m(l[3],p,y),Le(p,d,y)},p(p,y){y&8&&h.p(p[3])},i:ei,o:ei,d(p){p&&ne(d),p&&h.d()}}}function m1(l){let h,d=l[3][l[2].type]+"",p;return{c(){h=new Bl(!1),p=ir(),this.h()},l(y){h=Fl(y,!1),p=ir(),this.h()},h(){h.a=p},m(y,v){h.m(d,y,v),Le(y,p,v)},p(y,v){v&12&&d!==(d=y[3][y[2].type]+"")&&h.p(d)},i:ei,o:ei,d(y){y&&ne(p),y&&h.d()}}}function y1(l){let h,d,p,y,v,a;const k=[S1,w1,x1],T=[];function F(M,N){return N&1040&&(h=null),N&1040&&(d=null),h==null&&(h=!!(M[4].hasOwnProperty("none")&M[10]==null)),h?0:(d==null&&(d=!!(M[4].hasOwnProperty("ni")&M[10]=="ni")),d?1:2)}return p=F(l,-1),y=T[p]=k[p](l),{c(){y.c(),v=ir()},l(M){y.l(M),v=ir()},m(M,N){T[p].m(M,N),Le(M,v,N),a=!0},p(M,N){let R=p;p=F(M,N),p===R?T[p].p(M,N):(Ln(),ft(T[R],1,1,()=>{T[R]=null}),Rn(),y=T[p],y?y.p(M,N):(y=T[p]=k[p](M),y.c()),ot(y,1),y.m(v.parentNode,v))},i(M){a||(ot(y),a=!0)},o(M){ft(y),a=!1},d(M){T[p].d(M),M&&ne(v)}}}function g1(l){let h,d,p,y,v,a;const k=[T1,k1,E1],T=[];function F(M,N){return N&1040&&(h=null),N&1040&&(d=null),h==null&&(h=!!(M[4].hasOwnProperty("none")&M[10]==null)),h?0:(d==null&&(d=!!(M[4].hasOwnProperty("ni")&M[10]=="ni")),d?1:2)}return p=F(l,-1),y=T[p]=k[p](l),{c(){y.c(),v=ir()},l(M){y.l(M),v=ir()},m(M,N){T[p].m(M,N),Le(M,v,N),a=!0},p(M,N){let R=p;p=F(M,N),p===R?T[p].p(M,N):(Ln(),ft(T[R],1,1,()=>{T[R]=null}),Rn(),y=T[p],y?y.p(M,N):(y=T[p]=k[p](M),y.c()),ot(y,1),y.m(v.parentNode,v))},i(M){a||(ot(y),a=!0)},o(M){ft(y),a=!1},d(M){T[p].d(M),M&&ne(v)}}}function _1(l){let h,d,p,y,v,a;const k=[z1,P1,I1],T=[];function F(M,N){return N&1040&&(h=null),N&1040&&(d=null),h==null&&(h=!!(M[4].hasOwnProperty("none")&M[10]==null)),h?0:(d==null&&(d=!!(M[4].hasOwnProperty("ni")&M[10]=="ni")),d?1:2)}return p=F(l,-1),y=T[p]=k[p](l),{c(){y.c(),v=ir()},l(M){y.l(M),v=ir()},m(M,N){T[p].m(M,N),Le(M,v,N),a=!0},p(M,N){let R=p;p=F(M,N),p===R?T[p].p(M,N):(Ln(),ft(T[R],1,1,()=>{T[R]=null}),Rn(),y=T[p],y?y.p(M,N):(y=T[p]=k[p](M),y.c()),ot(y,1),y.m(v.parentNode,v))},i(M){a||(ot(y),a=!0)},o(M){ft(y),a=!1},d(M){T[p].d(M),M&&ne(v)}}}function v1(l){let h,d;return h=new J0({props:{data:l[4],zKey:"group"}}),{c(){ur(h.$$.fragment)},l(p){cr(h.$$.fragment,p)},m(p,y){hr(h,p,y),d=!0},p(p,y){const v={};y&16&&(v.data=p[4]),h.$set(v)},i(p){d||(ot(h.$$.fragment,p),d=!0)},o(p){ft(h.$$.fragment,p),d=!1},d(p){pr(h,p)}}}function b1(l){let h,d,p,y,v,a;const k=[M1,C1,A1],T=[];function F(M,N){return N&1040&&(h=null),N&1040&&(d=null),h==null&&(h=!!(M[4].hasOwnProperty("none")&M[10]==null)),h?0:(d==null&&(d=!!(M[4].hasOwnProperty("ni")&M[10]=="ni")),d?1:2)}return p=F(l,-1),y=T[p]=k[p](l),{c(){y.c(),v=ir()},l(M){y.l(M),v=ir()},m(M,N){T[p].m(M,N),Le(M,v,N),a=!0},p(M,N){let R=p;p=F(M,N),p===R?T[p].p(M,N):(Ln(),ft(T[R],1,1,()=>{T[R]=null}),Rn(),y=T[p],y?y.p(M,N):(y=T[p]=k[p](M),y.c()),ot(y,1),y.m(v.parentNode,v))},i(M){a||(ot(y),a=!0)},o(M){ft(y),a=!1},d(M){T[p].d(M),M&&ne(v)}}}function x1(l){let h,d;return h=new Zp({props:{data:l[4],zKey:l[5]}}),{c(){ur(h.$$.fragment)},l(p){cr(h.$$.fragment,p)},m(p,y){hr(h,p,y),d=!0},p(p,y){const v={};y&16&&(v.data=p[4]),y&32&&(v.zKey=p[5]),h.$set(v)},i(p){d||(ot(h.$$.fragment,p),d=!0)},o(p){ft(h.$$.fragment,p),d=!1},d(p){pr(h,p)}}}function w1(l){let h,d;return h=new Zp({props:{data:l[4].ni,zKey:l[5]}}),{c(){ur(h.$$.fragment)},l(p){cr(h.$$.fragment,p)},m(p,y){hr(h,p,y),d=!0},p(p,y){const v={};y&16&&(v.data=p[4].ni),y&32&&(v.zKey=p[5]),h.$set(v)},i(p){d||(ot(h.$$.fragment,p),d=!0)},o(p){ft(h.$$.fragment,p),d=!1},d(p){pr(h,p)}}}function S1(l){let h,d;return h=new Zp({props:{data:l[4].none,zKey:l[5]}}),{c(){ur(h.$$.fragment)},l(p){cr(h.$$.fragment,p)},m(p,y){hr(h,p,y),d=!0},p(p,y){const v={};y&16&&(v.data=p[4].none),y&32&&(v.zKey=p[5]),h.$set(v)},i(p){d||(ot(h.$$.fragment,p),d=!0)},o(p){ft(h.$$.fragment,p),d=!1},d(p){pr(h,p)}}}function E1(l){let h,d;return h=new Xp({props:{data:l[4],zKey:l[5],label:l[6]}}),{c(){ur(h.$$.fragment)},l(p){cr(h.$$.fragment,p)},m(p,y){hr(h,p,y),d=!0},p(p,y){const v={};y&16&&(v.data=p[4]),y&32&&(v.zKey=p[5]),y&64&&(v.label=p[6]),h.$set(v)},i(p){d||(ot(h.$$.fragment,p),d=!0)},o(p){ft(h.$$.fragment,p),d=!1},d(p){pr(h,p)}}}function k1(l){let h,d;return h=new Xp({props:{data:l[4].ni,zKey:l[5],label:l[6]}}),{c(){ur(h.$$.fragment)},l(p){cr(h.$$.fragment,p)},m(p,y){hr(h,p,y),d=!0},p(p,y){const v={};y&16&&(v.data=p[4].ni),y&32&&(v.zKey=p[5]),y&64&&(v.label=p[6]),h.$set(v)},i(p){d||(ot(h.$$.fragment,p),d=!0)},o(p){ft(h.$$.fragment,p),d=!1},d(p){pr(h,p)}}}function T1(l){let h,d;return h=new Xp({props:{data:l[4].none,zKey:l[5],label:l[6]}}),{c(){ur(h.$$.fragment)},l(p){cr(h.$$.fragment,p)},m(p,y){hr(h,p,y),d=!0},p(p,y){const v={};y&16&&(v.data=p[4].none),y&32&&(v.zKey=p[5]),y&64&&(v.label=p[6]),h.$set(v)},i(p){d||(ot(h.$$.fragment,p),d=!0)},o(p){ft(h.$$.fragment,p),d=!1},d(p){pr(h,p)}}}function I1(l){let h,d;return h=new Wp({props:{data:l[4],zKey:l[5],label:l[6]}}),{c(){ur(h.$$.fragment)},l(p){cr(h.$$.fragment,p)},m(p,y){hr(h,p,y),d=!0},p(p,y){const v={};y&16&&(v.data=p[4]),y&32&&(v.zKey=p[5]),y&64&&(v.label=p[6]),h.$set(v)},i(p){d||(ot(h.$$.fragment,p),d=!0)},o(p){ft(h.$$.fragment,p),d=!1},d(p){pr(h,p)}}}function P1(l){let h,d;return h=new Wp({props:{data:l[4].ni,zKey:l[5],label:l[6]}}),{c(){ur(h.$$.fragment)},l(p){cr(h.$$.fragment,p)},m(p,y){hr(h,p,y),d=!0},p(p,y){const v={};y&16&&(v.data=p[4].ni),y&32&&(v.zKey=p[5]),y&64&&(v.label=p[6]),h.$set(v)},i(p){d||(ot(h.$$.fragment,p),d=!0)},o(p){ft(h.$$.fragment,p),d=!1},d(p){pr(h,p)}}}function z1(l){let h,d;return h=new Wp({props:{data:l[4].none,zKey:l[5],label:l[6]}}),{c(){ur(h.$$.fragment)},l(p){cr(h.$$.fragment,p)},m(p,y){hr(h,p,y),d=!0},p(p,y){const v={};y&16&&(v.data=p[4].none),y&32&&(v.zKey=p[5]),y&64&&(v.label=p[6]),h.$set(v)},i(p){d||(ot(h.$$.fragment,p),d=!0)},o(p){ft(h.$$.fragment,p),d=!1},d(p){pr(h,p)}}}function A1(l){let h,d;return h=new Hp({props:{data:l[4],zKey:l[5],label:l[6],topic_prev_available:l[7]}}),{c(){ur(h.$$.fragment)},l(p){cr(h.$$.fragment,p)},m(p,y){hr(h,p,y),d=!0},p(p,y){const v={};y&16&&(v.data=p[4]),y&32&&(v.zKey=p[5]),y&64&&(v.label=p[6]),y&128&&(v.topic_prev_available=p[7]),h.$set(v)},i(p){d||(ot(h.$$.fragment,p),d=!0)},o(p){ft(h.$$.fragment,p),d=!1},d(p){pr(h,p)}}}function C1(l){let h,d;return h=new Hp({props:{data:l[4].ni,zKey:l[5],label:l[6],topic_prev_available:l[7]}}),{c(){ur(h.$$.fragment)},l(p){cr(h.$$.fragment,p)},m(p,y){hr(h,p,y),d=!0},p(p,y){const v={};y&16&&(v.data=p[4].ni),y&32&&(v.zKey=p[5]),y&64&&(v.label=p[6]),y&128&&(v.topic_prev_available=p[7]),h.$set(v)},i(p){d||(ot(h.$$.fragment,p),d=!0)},o(p){ft(h.$$.fragment,p),d=!1},d(p){pr(h,p)}}}function M1(l){let h,d;return h=new Hp({props:{data:l[4].none,zKey:l[5],label:l[6],topic_prev_available:l[7]}}),{c(){ur(h.$$.fragment)},l(p){cr(h.$$.fragment,p)},m(p,y){hr(h,p,y),d=!0},p(p,y){const v={};y&16&&(v.data=p[4].none),y&32&&(v.zKey=p[5]),y&64&&(v.label=p[6]),y&128&&(v.topic_prev_available=p[7]),h.$set(v)},i(p){d||(ot(h.$$.fragment,p),d=!0)},o(p){ft(h.$$.fragment,p),d=!1},d(p){pr(h,p)}}}function Fm(l){let h,d,p,y=l[11][l[2].type]+"";return{c(){h=Ue("br"),d=yt(),p=Ue("span"),this.h()},l(v){h=Ve(v,"BR",{}),d=gt(v),p=Ve(v,"SPAN",{class:!0});var a=Be(p);a.forEach(ne),this.h()},h(){ie(p,"class","text-small")},m(v,a){Le(v,h,a),Le(v,d,a),Le(v,p,a),p.innerHTML=y},p(v,a){a&2052&&y!==(y=v[11][v[2].type]+"")&&(p.innerHTML=y)},d(v){v&&ne(h),v&&ne(d),v&&ne(p)}}}function D1(l){let h,d,p,y,v,a,k,T,F,M,N,R,X,Q,ae,le;const de=[f1,p1],ge=[];function rt(je,Ze){return je[8]==!0|je[8]==null?0:1}d=rt(l),p=ge[d]=de[d](l);let Fe=l[12]!=null&&Bm(l);const ze=[b1,v1,_1,g1,y1,m1,d1],Ge=[];function zt(je,Ze){return Ze&12&&(a=null),Ze&12&&(k=null),Ze&12&&(T=null),Ze&12&&(F=null),Ze&12&&(M=null),Ze&12&&(N=null),a==null&&(a=!!(je[3]=="StackedBarChart"|je[3].hasOwnProperty(je[2].type)&je[3][je[2].type]=="StackedBarChart")),a?0:(k==null&&(k=!!(je[3]=="GroupChart"|je[3].hasOwnProperty(je[2].type)&je[3][je[2].type]=="GroupChart")),k?1:(T==null&&(T=!!(je[3]=="ProfileChart"|je[3].hasOwnProperty(je[2].type)&je[3][je[2].type]=="ProfileChart")),T?2:(F==null&&(F=!!(je[3]=="BarChart"|je[3].hasOwnProperty(je[2].type)&je[3][je[2].type]=="BarChart")),F?3:(M==null&&(M=!!(je[3]=="ColChart"|je[3].hasOwnProperty(je[2].type)&je[3][je[2].type]=="ColChart")),M?4:(N==null&&(N=!!je[3].hasOwnProperty(je[2].type)),N?5:6)))))}R=zt(l,-1),X=Ge[R]=ze[R](l);let wt=l[11]!=null&l[10]!=null&&Fm(l);return{c(){h=Ue("div"),p.c(),y=yt(),Fe&&Fe.c(),v=yt(),X.c(),Q=yt(),wt&&wt.c(),this.h()},l(je){h=Ve(je,"DIV",{class:!0,style:!0});var Ze=Be(h);p.l(Ze),y=gt(Ze),Fe&&Fe.l(Ze),v=gt(Ze),X.l(Ze),Q=gt(Ze),wt&&wt.l(Ze),Ze.forEach(ne),this.h()},h(){ie(h,"class",ae=Om(l[0])),ie(h,"style",l[1])},m(je,Ze){Le(je,h,Ze),ge[d].m(h,null),xe(h,y),Fe&&Fe.m(h,null),xe(h,v),Ge[R].m(h,null),xe(h,Q),wt&&wt.m(h,null),le=!0},p(je,[Ze]){let mt=d;d=rt(je),d===mt?ge[d].p(je,Ze):(Ln(),ft(ge[mt],1,1,()=>{ge[mt]=null}),Rn(),p=ge[d],p?p.p(je,Ze):(p=ge[d]=de[d](je),p.c()),ot(p,1),p.m(h,y)),je[12]!=null?Fe?Fe.p(je,Ze):(Fe=Bm(je),Fe.c(),Fe.m(h,v)):Fe&&(Fe.d(1),Fe=null);let nr=R;R=zt(je,Ze),R===nr?Ge[R].p(je,Ze):(Ln(),ft(Ge[nr],1,1,()=>{Ge[nr]=null}),Rn(),X=Ge[R],X?X.p(je,Ze):(X=Ge[R]=ze[R](je),X.c()),ot(X,1),X.m(h,Q)),je[11]!=null&je[10]!=null?wt?wt.p(je,Ze):(wt=Fm(je),wt.c(),wt.m(h,null)):wt&&(wt.d(1),wt=null),(!le||Ze&1&&ae!==(ae=Om(je[0])))&&ie(h,"class",ae),(!le||Ze&2)&&ie(h,"style",je[1])},i(je){le||(ot(p),ot(X),le=!0)},o(je){ft(p),ft(X),le=!1},d(je){je&&ne(h),ge[d].d(),Fe&&Fe.d(),Ge[R].d(),wt&&wt.d()}}}function Om(l){return l=="empty"?"":"div-grey-box"}function L1(l,h,d){let{id:p}=h,{style:y=""}=h,{place:v}=h,{content:a}=h,{chart_data:k=null}=h,{zKey:T="ni"}=h,{label:F=null}=h,{topic_prev_available:M=!0}=h,{i_button:N=!0}=h,{heading:R=null}=h,{chart_compare_type:X}=h,{compare_content:Q=null}=h,{year:ae=null}=h;return l.$$set=le=>{"id"in le&&d(0,p=le.id),"style"in le&&d(1,y=le.style),"place"in le&&d(2,v=le.place),"content"in le&&d(3,a=le.content),"chart_data"in le&&d(4,k=le.chart_data),"zKey"in le&&d(5,T=le.zKey),"label"in le&&d(6,F=le.label),"topic_prev_available"in le&&d(7,M=le.topic_prev_available),"i_button"in le&&d(8,N=le.i_button),"heading"in le&&d(9,R=le.heading),"chart_compare_type"in le&&d(10,X=le.chart_compare_type),"compare_content"in le&&d(11,Q=le.compare_content),"year"in le&&d(12,ae=le.year)},[p,y,v,a,k,T,F,M,N,R,X,Q,ae]}class Bu extends an{constructor(h){super(),on(this,h,L1,D1,sn,{id:0,style:1,place:2,content:3,chart_data:4,zKey:5,label:6,topic_prev_available:7,i_button:8,heading:9,chart_compare_type:10,compare_content:11,year:12})}}function Nm(l,h,d){const p=l.slice();return p[13]=h[d],p[15]=d,p}function Um(l){let h=l[6][l[10][l[15]]].show.includes(l[3].type),d,p,y=h&&Vm(l);return{c(){y&&y.c(),d=ir()},l(v){y&&y.l(v),d=ir()},m(v,a){y&&y.m(v,a),Le(v,d,a),p=!0},p(v,a){a&72&&(h=v[6][v[10][v[15]]].show.includes(v[3].type)),h?y?(y.p(v,a),a&72&&ot(y,1)):(y=Vm(v),y.c(),ot(y,1),y.m(d.parentNode,d)):y&&(Ln(),ft(y,1,1,()=>{y=null}),Rn())},i(v){p||(ot(y),p=!0)},o(v){ft(y),p=!1},d(v){y&&y.d(v),v&&ne(d)}}}function Vm(l){let h,d;return h=new Bu({props:{id:l[6][l[10][l[15]]].id,style:l[6][l[10][l[15]]].style,place:l[3],year:l[6][l[10][l[15]]].year,content:l[6][l[10][l[15]]].content,chart_data:l[6][l[10][l[15]]].chart_data,zKey:l[6][l[10][l[15]]].zKey,label:l[6][l[10][l[15]]].label,topic_prev_available:l[6][l[10][l[15]]].topic_prev_available,chart_compare_type:l[8],i_button:l[6][l[10][l[15]]].i_button,compare_content:l[6][l[10][l[15]]].compare_content}}),{c(){ur(h.$$.fragment)},l(p){cr(h.$$.fragment,p)},m(p,y){hr(h,p,y),d=!0},p(p,y){const v={};y&64&&(v.id=p[6][p[10][p[15]]].id),y&64&&(v.style=p[6][p[10][p[15]]].style),y&8&&(v.place=p[3]),y&64&&(v.year=p[6][p[10][p[15]]].year),y&64&&(v.content=p[6][p[10][p[15]]].content),y&64&&(v.chart_data=p[6][p[10][p[15]]].chart_data),y&64&&(v.zKey=p[6][p[10][p[15]]].zKey),y&64&&(v.label=p[6][p[10][p[15]]].label),y&64&&(v.topic_prev_available=p[6][p[10][p[15]]].topic_prev_available),y&256&&(v.chart_compare_type=p[8]),y&64&&(v.i_button=p[6][p[10][p[15]]].i_button),y&64&&(v.compare_content=p[6][p[10][p[15]]].compare_content),h.$set(v)},i(p){d||(ot(h.$$.fragment,p),d=!0)},o(p){ft(h.$$.fragment,p),d=!1},d(p){pr(h,p)}}}function qm(l){let h,d;return h=new Bu({props:{id:l[6][l[10][l[15]]].id,style:l[6][l[10][l[15]]].style,place:l[3],year:l[6][l[10][l[15]]].year,content:l[6][l[10][l[15]]].content,chart_data:l[6][l[10][l[15]]].chart_data,zKey:l[6][l[10][l[15]]].zKey,label:l[6][l[10][l[15]]].label,topic_prev_available:l[6][l[10][l[15]]].topic_prev_available,chart_compare_type:l[8],i_button:l[6][l[10][l[15]]].i_button,compare_content:l[6][l[10][l[15]]].compare_content}}),{c(){ur(h.$$.fragment)},l(p){cr(h.$$.fragment,p)},m(p,y){hr(h,p,y),d=!0},p(p,y){const v={};y&64&&(v.id=p[6][p[10][p[15]]].id),y&64&&(v.style=p[6][p[10][p[15]]].style),y&8&&(v.place=p[3]),y&64&&(v.year=p[6][p[10][p[15]]].year),y&64&&(v.content=p[6][p[10][p[15]]].content),y&64&&(v.chart_data=p[6][p[10][p[15]]].chart_data),y&64&&(v.zKey=p[6][p[10][p[15]]].zKey),y&64&&(v.label=p[6][p[10][p[15]]].label),y&64&&(v.topic_prev_available=p[6][p[10][p[15]]].topic_prev_available),y&256&&(v.chart_compare_type=p[8]),y&64&&(v.i_button=p[6][p[10][p[15]]].i_button),y&64&&(v.compare_content=p[6][p[10][p[15]]].compare_content),h.$set(v)},i(p){d||(ot(h.$$.fragment,p),d=!0)},o(p){ft(h.$$.fragment,p),d=!1},d(p){pr(h,p)}}}function jm(l){let h=l[6][l[10][l[15]]].hasOwnProperty("show"),d,p=!l[6][l[10][l[15]]].hasOwnProperty("show"),y,v,a=h&&Um(l),k=p&&qm(l);return{c(){a&&a.c(),d=yt(),k&&k.c(),y=ir()},l(T){a&&a.l(T),d=gt(T),k&&k.l(T),y=ir()},m(T,F){a&&a.m(T,F),Le(T,d,F),k&&k.m(T,F),Le(T,y,F),v=!0},p(T,F){F&64&&(h=T[6][T[10][T[15]]].hasOwnProperty("show")),h?a?(a.p(T,F),F&64&&ot(a,1)):(a=Um(T),a.c(),ot(a,1),a.m(d.parentNode,d)):a&&(Ln(),ft(a,1,1,()=>{a=null}),Rn()),F&64&&(p=!T[6][T[10][T[15]]].hasOwnProperty("show")),p?k?(k.p(T,F),F&64&&ot(k,1)):(k=qm(T),k.c(),ot(k,1),k.m(y.parentNode,y)):k&&(Ln(),ft(k,1,1,()=>{k=null}),Rn())},i(T){v||(ot(a),ot(k),v=!0)},o(T){ft(a),ft(k),v=!1},d(T){a&&a.d(T),T&&ne(d),k&&k.d(T),T&&ne(y)}}}function Gm(l){let h,d,p,y;return{c(){h=Ue("h3"),d=Tt("More Statistics"),p=yt(),y=Ue("div"),this.h()},l(v){h=Ve(v,"H3",{});var a=Be(h);d=It(a,"More Statistics"),a.forEach(ne),p=gt(v),y=Ve(v,"DIV",{class:!0});var k=Be(y);k.forEach(ne),this.h()},h(){ie(y,"class","accordion-more svelte-9ol09s")},m(v,a){Le(v,h,a),xe(h,d),Le(v,p,a),Le(v,y,a),y.innerHTML=l[7]},p(v,a){a&128&&(y.innerHTML=v[7])},d(v){v&&ne(h),v&&ne(p),v&&ne(y)}}}function R1(l){let h,d,p,y,v,a,k,T,F,M,N,R,X,Q,ae=l[3].name+"",le,de,ge=l[3].type.toLocaleUpperCase()+"",rt,Fe,ze,Ge,zt,wt,je,Ze,mt,nr,qe,Bt,Re,et={length:l[10].length},dt=[];for(let xt=0;xt<et.length;xt+=1)dt[xt]=jm(Nm(l,et,xt));const qt=xt=>ft(dt[xt],1,1,()=>{dt[xt]=null});let Mt=l[7]!=""&&Gm(l);return{c(){h=Ue("div"),d=Ue("h2"),p=Ue("button"),y=Ue("span"),v=Ue("img"),k=yt(),T=Tt(l[2]),R=yt(),X=Ue("div"),Q=Ue("div"),le=Tt(ae),de=yt(),rt=Tt(ge),Fe=Tt(" - "),ze=new Bl(!1),Ge=yt(),zt=Ue("span"),wt=Tt(l[5]),je=yt(),Ze=Ue("div");for(let xt=0;xt<dt.length;xt+=1)dt[xt].c();nr=yt(),Mt&&Mt.c(),this.h()},l(xt){h=Ve(xt,"DIV",{class:!0});var Ae=Be(h);d=Ve(Ae,"H2",{class:!0,id:!0});var at=Be(d);p=Ve(at,"BUTTON",{class:!0,type:!0,"data-bs-toggle":!0,"data-bs-target":!0,"aria-expanded":!0,"aria-controls":!0});var Mr=Be(p);y=Ve(Mr,"SPAN",{class:!0});var Zr=Be(y);v=Ve(Zr,"IMG",{src:!0,alt:!0,height:!0,class:!0}),k=gt(Zr),T=It(Zr,l[2]),Zr.forEach(ne),Mr.forEach(ne),at.forEach(ne),R=gt(Ae),X=Ve(Ae,"DIV",{id:!0,class:!0,"aria-labelledby":!0});var wi=Be(X);Q=Ve(wi,"DIV",{class:!0});var Rr=Be(Q);le=It(Rr,ae),de=gt(Rr),rt=It(Rr,ge),Fe=It(Rr," - "),ze=Fl(Rr,!1),Ge=gt(Rr),zt=Ve(Rr,"SPAN",{class:!0});var ar=Be(zt);wt=It(ar,l[5]),ar.forEach(ne),je=gt(Rr),Ze=Ve(Rr,"DIV",{class:!0});var Sr=Be(Ze);for(let Gt=0;Gt<dt.length;Gt+=1)dt[Gt].l(Sr);Sr.forEach(ne),nr=gt(Rr),Mt&&Mt.l(Rr),Rr.forEach(ne),wi.forEach(ne),Ae.forEach(ne),this.h()},h(){Sh(v.src,a=kn+"/img/"+l[1])||ie(v,"src",a),ie(v,"alt","logo"),ie(v,"height","40"),ie(v,"class","accordion-dept-logo"),ie(y,"class","accordion-button-title svelte-9ol09s"),ie(p,"class","accordion-button collapsed svelte-9ol09s"),ie(p,"type","button"),ie(p,"data-bs-toggle","collapse"),ie(p,"data-bs-target",F="#panelsStayOpen-collapse"+l[0]),ie(p,"aria-expanded","false"),ie(p,"aria-controls",M="panelsStayOpen-collapse"+l[0]),ie(d,"class","accordion-header svelte-9ol09s"),ie(d,"id",N="panelsStayOpen-heading"+l[0]),ze.a=Ge,ie(zt,"class","accordion-button-title-sub svelte-9ol09s"),ie(Ze,"class","grid mt svelte-9ol09s"),Gu(()=>l[11].call(Ze)),ie(Q,"class","accordion-body svelte-9ol09s"),ie(X,"id",qe="panelsStayOpen-collapse"+l[0]),ie(X,"class","accordion-collapse collapse svelte-9ol09s"),ie(X,"aria-labelledby",Bt="panelsStayOpen-heading"+l[0]),ie(h,"class","accordion-item svelte-9ol09s")},m(xt,Ae){Le(xt,h,Ae),xe(h,d),xe(d,p),xe(p,y),xe(y,v),xe(y,k),xe(y,T),xe(h,R),xe(h,X),xe(X,Q),xe(Q,le),xe(Q,de),xe(Q,rt),xe(Q,Fe),ze.m(l[4],Q),xe(Q,Ge),xe(Q,zt),xe(zt,wt),xe(Q,je),xe(Q,Ze);for(let at=0;at<dt.length;at+=1)dt[at]&&dt[at].m(Ze,null);mt=Zu(Ze,l[11].bind(Ze)),xe(Q,nr),Mt&&Mt.m(Q,null),Re=!0},p(xt,[Ae]){if((!Re||Ae&2&&!Sh(v.src,a=kn+"/img/"+xt[1]))&&ie(v,"src",a),(!Re||Ae&4)&&wr(T,xt[2]),(!Re||Ae&1&&F!==(F="#panelsStayOpen-collapse"+xt[0]))&&ie(p,"data-bs-target",F),(!Re||Ae&1&&M!==(M="panelsStayOpen-collapse"+xt[0]))&&ie(p,"aria-controls",M),(!Re||Ae&1&&N!==(N="panelsStayOpen-heading"+xt[0]))&&ie(d,"id",N),(!Re||Ae&8)&&ae!==(ae=xt[3].name+"")&&wr(le,ae),(!Re||Ae&8)&&ge!==(ge=xt[3].type.toLocaleUpperCase()+"")&&wr(rt,ge),(!Re||Ae&16)&&ze.p(xt[4]),(!Re||Ae&32)&&wr(wt,xt[5]),Ae&1352){et={length:xt[10].length};let at;for(at=0;at<et.length;at+=1){const Mr=Nm(xt,et,at);dt[at]?(dt[at].p(Mr,Ae),ot(dt[at],1)):(dt[at]=jm(Mr),dt[at].c(),ot(dt[at],1),dt[at].m(Ze,null))}for(Ln(),at=et.length;at<dt.length;at+=1)qt(at);Rn()}xt[7]!=""?Mt?Mt.p(xt,Ae):(Mt=Gm(xt),Mt.c(),Mt.m(Q,null)):Mt&&(Mt.d(1),Mt=null),(!Re||Ae&1&&qe!==(qe="panelsStayOpen-collapse"+xt[0]))&&ie(X,"id",qe),(!Re||Ae&1&&Bt!==(Bt="panelsStayOpen-heading"+xt[0]))&&ie(X,"aria-labelledby",Bt)},i(xt){if(!Re){for(let Ae=0;Ae<et.length;Ae+=1)ot(dt[Ae]);Re=!0}},o(xt){dt=dt.filter(Boolean);for(let Ae=0;Ae<dt.length;Ae+=1)ft(dt[Ae]);Re=!1},d(xt){xt&&ne(h),nn(dt,xt),mt(),Mt&&Mt.d()}}}function B1(l,h,d){let{id:p}=h,{img:y}=h,{heading:v}=h,{place:a}=h,{sub_heading:k}=h,{description:T}=h,{boxes:F}=h,{more:M}=h,{chart_compare_type:N}=h,R=Object.keys(F),X;function Q(){X=this.clientWidth,d(9,X)}return l.$$set=ae=>{"id"in ae&&d(0,p=ae.id),"img"in ae&&d(1,y=ae.img),"heading"in ae&&d(2,v=ae.heading),"place"in ae&&d(3,a=ae.place),"sub_heading"in ae&&d(4,k=ae.sub_heading),"description"in ae&&d(5,T=ae.description),"boxes"in ae&&d(6,F=ae.boxes),"more"in ae&&d(7,M=ae.more),"chart_compare_type"in ae&&d(8,N=ae.chart_compare_type)},[p,y,v,a,k,T,F,M,N,X,R,Q]}class ts extends an{constructor(h){super(),on(this,h,B1,R1,sn,{id:0,img:1,heading:2,place:3,sub_heading:4,description:5,boxes:6,more:7,chart_compare_type:8})}}function Zm(l){let h,d,p,y,v,a,k,T,F,M=l[2].substr(0,2).toUpperCase()=="BT"&l[9](l[2]),N=M&&Km(l);return{c(){h=Ue("div"),d=Ue("div"),p=Ue("img"),v=Tt("You searched for "),a=Ue("strong"),k=Tt(l[2]),T=Tt("."),F=yt(),N&&N.c(),this.h()},l(R){h=Ve(R,"DIV",{id:!0,class:!0});var X=Be(h);d=Ve(X,"DIV",{});var Q=Be(d);p=Ve(Q,"IMG",{src:!0,alt:!0,class:!0}),v=It(Q,"You searched for "),a=Ve(Q,"STRONG",{});var ae=Be(a);k=It(ae,l[2]),ae.forEach(ne),T=It(Q,"."),Q.forEach(ne),F=gt(X),N&&N.l(X),X.forEach(ne),this.h()},h(){Sh(p.src,y=m_+"/img/search.svg")||ie(p,"src",y),ie(p,"alt","search-symbol"),ie(p,"class","svelte-19iexfz"),ie(h,"id","search-result"),ie(h,"class","svelte-19iexfz")},m(R,X){Le(R,h,X),xe(h,d),xe(d,p),xe(d,v),xe(d,a),xe(a,k),xe(d,T),xe(h,F),N&&N.m(h,null)},p(R,X){X&4&&wr(k,R[2]),X&4&&(M=R[2].substr(0,2).toUpperCase()=="BT"&R[9](R[2])),M?N?N.p(R,X):(N=Km(R),N.c(),N.m(h,null)):N&&(N.d(1),N=null)},d(R){R&&ne(h),N&&N.d()}}}function Km(l){let h,d,p,y=l[0].name+"",v,a,k,T,F,M,N,R,X,Q,ae,le,de,ge,rt;return{c(){h=Ue("div"),d=Tt("This postcode is located within the "),p=Ue("strong"),v=Tt(y),a=Tt(" District Electoral Area."),k=yt(),T=Ue("div"),F=Tt("You can view more localised information for this postcode at Super Data Zone level by selecting "),M=Ue("strong"),N=Ue("a"),R=Tt(l[3]),Q=Tt(" or at Data Zone level by selecting "),ae=Ue("strong"),le=Ue("a"),de=Tt(l[5]),rt=Tt(". Note that many of the statistics produced are not broken down to these smaller geography levels."),this.h()},l(Fe){h=Ve(Fe,"DIV",{style:!0});var ze=Be(h);d=It(ze,"This postcode is located within the "),p=Ve(ze,"STRONG",{});var Ge=Be(p);v=It(Ge,y),Ge.forEach(ne),a=It(ze," District Electoral Area."),ze.forEach(ne),k=gt(Fe),T=Ve(Fe,"DIV",{style:!0});var zt=Be(T);F=It(zt,"You can view more localised information for this postcode at Super Data Zone level by selecting "),M=Ve(zt,"STRONG",{});var wt=Be(M);N=Ve(wt,"A",{href:!0});var je=Be(N);R=It(je,l[3]),je.forEach(ne),wt.forEach(ne),Q=It(zt," or at Data Zone level by selecting "),ae=Ve(zt,"STRONG",{});var Ze=Be(ae);le=Ve(Ze,"A",{href:!0});var mt=Be(le);de=It(mt,l[5]),mt.forEach(ne),Ze.forEach(ne),rt=It(zt,". Note that many of the statistics produced are not broken down to these smaller geography levels."),zt.forEach(ne),this.h()},h(){We(h,"margin-left","1em"),ie(N,"href",X=kn+"/"+l[4]),ie(le,"href",ge=kn+"/"+l[6]),We(T,"margin-left","1em")},m(Fe,ze){Le(Fe,h,ze),xe(h,d),xe(h,p),xe(p,v),xe(h,a),Le(Fe,k,ze),Le(Fe,T,ze),xe(T,F),xe(T,M),xe(M,N),xe(N,R),xe(T,Q),xe(T,ae),xe(ae,le),xe(le,de),xe(T,rt)},p(Fe,ze){ze&1&&y!==(y=Fe[0].name+"")&&wr(v,y),ze&8&&wr(R,Fe[3]),ze&16&&X!==(X=kn+"/"+Fe[4])&&ie(N,"href",X),ze&32&&wr(de,Fe[5]),ze&64&&ge!==(ge=kn+"/"+Fe[6])&&ie(le,"href",ge)},d(Fe){Fe&&ne(h),Fe&&ne(k),Fe&&ne(T)}}}function F1(l){let h=l[7]()&l[1].search_code==l[0].code&l[8](),d,p=h&&Zm(l);return{c(){p&&p.c(),d=ir()},l(y){p&&p.l(y),d=ir()},m(y,v){p&&p.m(y,v),Le(y,d,v)},p(y,[v]){v&3&&(h=y[7]()&y[1].search_code==y[0].code&y[8]()),h?p?p.p(y,v):(p=Zm(y),p.c(),p.m(d.parentNode,d)):p&&(p.d(1),p=null)},i:ei,o:ei,d(y){p&&p.d(y),y&&ne(d)}}}function O1(l,h,d){let{place:p}=h,{storage:y=localStorage}=h,v;function a(){return y.hasOwnProperty("search_name")}function k(){return d(2,v=y.search_name),y.removeItem("search_name"),!0}let T,F,M,N;Rp(()=>{setInterval(function(){a()&y.search_code==p.code&&(d(2,v=y.search_name),k())},500)});function R(X){let Q=X.replaceAll(" ","");return fetch("https://raw.githubusercontent.com/NISRA-Tech-Lab/nisra-geog-explorer/main/search_data/cpd_light_with_lat_long_2.csv").then(ae=>ae.text()).then(ae=>{const le=ae.split(`
`);let de;for(let ge=0;ge<le.length;ge++){let rt=le[ge].split(",");if(rt[0]==Q){de=rt;break}}d(3,T=de[21]),d(4,F=de[20]),d(5,M=de[19]),d(6,N=de[18])}),!0}return l.$$set=X=>{"place"in X&&d(0,p=X.place),"storage"in X&&d(1,y=X.storage)},[p,y,v,T,F,M,N,a,k,R]}class N1 extends an{constructor(h){super(),on(this,h,O1,F1,sn,{place:0,storage:1})}}function Hm(l,h,d){const p=l.slice();return p[29]=h[d],p[31]=d,p}function Xm(l,h,d){const p=l.slice();return p[32]=h[d],p[31]=d,p}function Wm(l,h,d){const p=l.slice();return p[34]=h[d],p}function Ym(l,h,d){const p=l.slice();return p[32]=h[d],p[31]=d,p}function Jm(l){let h,d,p,y,v,a,k=" &gt; ",T,F,M,N,R=l[0].place.name+"",X,Q,ae,le,de,ge,rt,Fe,ze,Ge,zt,wt,je,Ze,mt,nr,qe,Bt,Re,et,dt,qt,Mt,xt,Ae,at,Mr,Zr,wi,Rr,ar,Sr,Gt,Si,Jn,ti,Nt,dn,ci,Jr,Bn,hi,Tn,ni,vr,gi,pi,Vr,Ji,Kr,In,Qi,Fn,Oi,Pn,$i,zn,Ni,mn,Ui,Vi,Qr=l[0].place.type!="ni"&&Qm(l);Fe=new l_({props:{search_data:l[0].search_data,group:"typestr",search:!0}}),Fe.$on("select",l[11]),Mt=new N1({props:{place:l[0].place}}),at=new Bu({props:{id:"overview",i_button:!1,heading:"About "+l[0].place.name,place:l[0].place,style:"line-height: 1.3;",content:{ni:"Northern Ireland has 11 Local Government Districts (LGDs),  which can be subdivided into District Electoral Areas (DEAs), then further into Super Data Zones and Data Zones. Statistics can be viewed for these smaller areas.",lgd:l[0].place.name+" is one of "+l[0].place.count.toLocaleString()+" "+En[l[0].place.type].pl+".  It includes the larger settlements of "+l[0].place.lgd_location_description,dea:l[0].place.name+" is one of "+l[0].place.count.toLocaleString()+" "+En[l[0].place.type].pl+" in Northern Ireland.  It is within <a href = '/"+l[0].place.parents[0].code+"/' data-sveltekit-noscroll data-sveltekit-keepfocus>"+l[0].place.parents[0].name+" </a> and covers "+l[0].place.dea_location_description+".",sdz:l[0].place.name+" is one of "+l[0].place.count.toLocaleString()+" "+En[l[0].place.type].pl+". Super Data Zones are new statistical areas developed for census. They are broadly similar in population size and housing type.",dz:l[0].place.name+" is one of "+l[0].place.count.toLocaleString()+" "+En[l[0].place.type].pl+".  Data Zones are smaller divisions of Super Data Zones. There are on average 4 in each Super Data Zone."},chart_compare_type:l[6]}}),Zr=new Bu({props:{id:"pop",place:l[0].place,year:$t("MYETotal",l[0].place),content:'<span class="text-big" style="font-size: 2.8em;">'+l[0].place.data.MYETotal.value.toLocaleString()+"</span>",chart_compare_type:l[6],compare_content:{ni:"",lgd:'<span class = "em" style = "background-color: lightgrey">'+mh(l[0].place.data.population.value[2021].all/l[0].ni.data.population.value[2021].all)+"</span> of Northern Ireland population<br>The "+l[12](l[0].place.data.population.value_rank[2021].all)+" population of 11 Local Government Districts",dea:'<span class = "em" style = "background-color: lightgrey">'+mh(l[0].place.data.population.value[2021].all/l[0].ni.data.population.value[2021].all)+"</span> of Northern Ireland population",sdz:"Data not available for area comparison",dz:" Data not available for area comparison"}}}),Rr=new Bu({props:{id:"popden",place:l[0].place,year:$t("MYETotal",l[0].place),content:'<div class = "row" style = "display: flex; align-items: center"><div style="font-weight: bold; font-size: 2.8em;">'+ny(l[0].place)+'</div><div style = "margin-left: 10px; line-height: 1.25em;"> people per square kilometer</div></div>',chart_compare_type:l[6],compare_content:{ni:"",lgd:l[18](l[0].place),dea:l[18](l[0].place),sdz:l[18](l[0].place),dz:l[18](l[0].place)}}});function ia(I,V){return I[0].place.type!="ni"?V1:U1}let ln=ia(l),$r=ln(l);function yn(I){l[20](I)}let On={location:{bounds:l[0].place.bounds},options:{fitBoundsOptions:{padding:20}},style:u_,$$slots:{default:[j1]},$$scope:{ctx:l}};l[3]!==void 0&&(On.map=l[3]),Nt=new J_({props:On}),Bs.push(()=>f_(Nt,"map",yn));let Br=l[0].place.type!="ni"&&ty(l);function Pr(I,V){return I[0].place.children[0]?Z1:G1}let L=Pr(l),U=L(l);return gi=new ts({props:{id:"people",img:"nisra-taxonomy-icon-census.png",heading:"People and households",place:l[0].place,sub_heading:l[17]("People and households",l[0].place),description:"",chart_compare_type:l[6],boxes:{box_1:{id:"popchange",content:l[13](l[0].place),show:["ni","lgd"]},box_2:{id:"broadage",year:$t("BroadAge",l[0].place),content:"GroupChart",chart_data:l[9]("BroadAge"),show:["ni","lgd","dea","sdz"]},box_4:{id:"hhsize",year:l[16]("hh_size"),content:"GroupChart",chart_data:l[9]("hh_size")},box_5:{id:"religion",year:l[16]("religion_or_religion_brought_up_in"),content:"GroupChart",chart_data:l[9]("religion_or_religion_brought_up_in")},box_7:{id:"language",year:l[16]("mainlang"),content:"StackedBarChart",chart_data:l[0].place&&l[8](["mainlang"],["2011"],["2021"]),zKey:l[6],label:l[7],topic_prev_available:!0}},more:`More information on the size of the population is available in the latest <a href='https://www.nisra.gov.uk/publications/2022-mid-year-population-estimates-northern-ireland'>mid-year estimates release</a>, \r
					which includes an <a href='https://www.nisra.gov.uk/system/files/statistics/MYE22-summary.pdf'>infographic</a>, \r
					<a href='https://www.nisra.gov.uk/system/files/statistics/MYE22-Factsheets.pdf'>Fact Sheets</a>, \r
					a <a href='https://www.nisra.gov.uk/system/files/statistics/Statistical%20Bulletin%20-%202022%20Mid-year%20Population%20Estimates%20for%20Northern%20Ireland.pdf'>publication</a> \r
					and statistical tables. Population characteristics are from the census data which can be explored further in the <a href='https://explore.nisra.gov.uk/area-explorer-2021/N92000002/'>Census Area Explorer</a>, \r
					bespoke tables can be created using the <a href='https://build.nisra.gov.uk/en/'>Flexible Table Builder</a> and the NISRA website has \r
					<a href='https://www.nisra.gov.uk/publications/census-2021-statistical-bulletins'>statistical bulletins</a> providing commentary on a range of census population characteristics.`}}),Vr=new ts({props:{id:"health",img:"nisra-taxonomy-icon-health.png",heading:"Health and social care",place:l[0].place,sub_heading:l[17]("Health and social care",l[0].place),description:" ",chart_compare_type:l[6],boxes:{box_0:{id:"generalhealth",year:l[16]("general_health"),content:"GroupChart",chart_data:l[9]("general_health")},box_2a:{id:"wellbeing",year:$t("Happy",l[0].place),content:"<p>Happiness</p><span class='text-big'>"+l[14]("Happy.value").toLocaleString()+"</span>/ 10 <p>Life Satisfaction</p><span class='text-big'>"+l[14]("Satisfy.value").toLocaleString()+"</span>/ 10 ",show:["ni"]},box_2b:{id:"wellbeing",year:$t("Happy",l[0].place),content:"<p>Happiness</p><span class='text-big'>"+l[14]("Happy.value").toLocaleString()+"</span>/ 10 <span style='color: #1460aa'> (NI "+l[0].ni.data.Happy.value+"/10) </span></p><p>Life Satisfaction</p><span class='text-big'>"+l[14]("Satisfy.value").toLocaleString()+"</span>/ 10 <span style='color: #1460aa'> (NI "+l[0].ni.data.Satisfy.value+"/10) </span></p>",show:["lgd"]},box_3a:{id:"lifeexpectancy",year:$t("LE",l[0].place),content:"<p>Male</p> <span class='text-big'>"+l[14]("LE.value.Males").toLocaleString()+"</span> years<p>Female</p> <span class='text-big'>"+l[14]("LE.value.Females").toLocaleString()+"</span> years",show:["ni"]},box_3b:{id:"lifeexpectancy",year:$t("LE",l[0].place),content:"<p>Male</p> <span class='text-big'>"+l[14]("LE.value.Males").toLocaleString()+"</span> years<span style='color: #1460aa'> (NI "+l[0].ni.data.LE.value.Males+") </span></p><p>Female</p> <span class='text-big'>"+l[14]("LE.value.Females").toLocaleString()+"</span> years<span style='color: #1460aa'> (NI "+l[0].ni.data.LE.value.Females+") </span></p>",show:["lgd","dea"]},box_4:{id:"carers",content:"GroupChart",year:l[16]("provision_care"),chart_data:l[9]("provision_care")},box_5:{id:"hospitalactivity",year:$t("Admiss",l[0].place),content:"<p><span class='text-big'>"+l[14]("Admiss.value").toLocaleString()+"</span> hospital admissions</p><p>The most frequent primary reason was for </p><span class='text-bold' >"+l[14]("Admiss.text")+"</span>",show:["ni","dea"]},box_6:{id:"primarycare",year:$t("GP",l[0].place),content:"<p><span class='text-big'>"+l[14]("GP.value.PRACS").toLocaleString()+"</span> GP practices with an average of <span class='text-big'>"+l[14]("GP.value.PRACLIST").toLocaleString()+"</span> patients per practice</p><p><span class='text-big'>"+l[14]("DEN.value.GDSDSSurgeries").toLocaleString()+"</span> dental surgeries</span> with an average of <span class='text-big'>"+(l[14]("DEN_REG.value.Dental_Registrations")/l[14]("DEN.value.GDSDSSurgeries")).toLocaleString(void 0,{minimumFractionDigits:0,maximumFractionDigits:0})+"</span> patients per surgery</p>",show:["ni"]},box_6a:{id:"primarycare",year:$t("GP",l[0].place),content:"<p><span class='text-big'>"+l[14]("GP.value.PRACS").toLocaleString()+"</span> GP practices with an average of <span class='text-big'>"+l[14]("GP.value.PRACLIST").toLocaleString()+"</span> patients per practice</p><p>"+l[15]("GP.value.PRACLIST").toLocaleString()+"<span style='color: #1460aa'> (NI "+l[0].ni.data.GP.value.PRACLIST.toLocaleString()+" patients per practice) </span></p><p><span class='text-big'>"+l[14]("DEN.value.GDSDSSurgeries").toLocaleString()+"</span> dental surgeries</span> with an average of <span class='text-big'>"+(l[14]("DEN_REG.value.Dental_Registrations")/l[14]("DEN.value.GDSDSSurgeries")).toLocaleString(void 0,{minimumFractionDigits:0,maximumFractionDigits:0})+"</span> patients per surgery</p>",show:["lgd"]},box_6b:{id:"primarycare",year:$t("DEN",l[0].place),content:"<p><span class='text-big'>"+l[14]("DEN.value.GDSDSSurgeries").toLocaleString()+"</span> dental surgeries</span> with an average of <span class='text-big'>"+(l[14]("DEN_REG.value.Dental_Registrations")/l[14]("DEN.value.GDSDSSurgeries")).toLocaleString(void 0,{minimumFractionDigits:0,maximumFractionDigits:0})+"</span> patients per surgery</p>",show:["dea"]},box_6c:{id:"empty",i_button:!1,content:"",show:["sdz","dz"]}},more:`<p>Significant volumes of information are prepared by the <a href='https://www.health-ni.gov.uk/topics/doh-statistics-and-research'>Department of Health</a> \r
				and the <a href='https://bso.hscni.net/directorates/operations/family-practitioner-services/directorates-operations-family-practitioner-services-information-unit/general-ophthalmic-services-statistics/'>\r
				Business Services Organisation</a>, including statistics on <a href='https://www.health-ni.gov.uk/topics/dhssps-statistics-and-research/health-inequalities-statistics'>Health inequalities</a>, \r
				Primary care (including <a href='https://bso.hscni.net/directorates/operations/family-practitioner-services/directorates-operations-family-practitioner-services-information-unit/1776-2/'>Medical</a>, \r
				<a href='https://bso.hscni.net/directorates/operations/family-practitioner-services/directorates-operations-family-practitioner-services-information-unit/general-dental-services-statistics/'>Dental</a>, \r
				<a href='https://bso.hscni.net/directorates/operations/family-practitioner-services/directorates-operations-family-practitioner-services-information-unit/general-pharmaceutical-services-and-prescribing-statistics/'>\r
				Pharmaceutical</a> and <a href='https://bso.hscni.net/directorates/operations/family-practitioner-services/directorates-operations-family-practitioner-services-information-unit/general-ophthalmic-services-statistics/'>\r
				Ophthalmic</a>), <a href='https://www.health-ni.gov.uk/topics/dhssps-statistics-and-research/family-health-services-statistics'>\r
				Family health services</a>, <a href='https://www.health-ni.gov.uk/topics/doh-statistics-and-research/hospital-waiting-times-statistics'>\r
				Hospital waiting times statistics</a>, <a href='https://www.health-ni.gov.uk/topics/doh-statistics-and-research-mental-health-and-learning-disabilities/mental-health-learning-disability-and-autism-statistics'>\r
				Mental health, learning disability and autism</a>, <a href='https://www.health-ni.gov.uk/topics/dhssps-statistics-and-research-social-services/social-care-statistics'>\r
				Social care</a>, <a href='https://www.health-ni.gov.uk/topics/dhssps-statistics-and-research/workforce-statistics'>Workforce</a>, and <u>COVID-19</u>.\r
				A number of <a href='https://visual.nisra.gov.uk/?body=entity/health'>interactive dashboards</a> are available and a compendium dashboard for <a href='https://visual.nisra.gov.uk/?body=entity/las'>\r
				Making Life Better</a>.\r
				The <a href='https://www.nisra.gov.uk/statistics/census'>2021 census</a> collected data on general health, long-term conditions and carers which can \r
				be explored in the <a href='https://explore.nisra.gov.uk/area-explorer-2021/N92000002/'>Census Area Explorer</a> and the <a href='https://build.nisra.gov.uk/en/'>Flexible Table Builder</a>.</p><p></p>`}}),Kr=new ts({props:{id:"work",img:"nisra-taxonomy-icon-labour-market.png",heading:"Work and welfare",place:l[0].place,sub_heading:l[17]("Work and welfare",l[0].place),description:" ",chart_compare_type:l[6],boxes:{box_1:{id:"employmentrates",year:$t("LMS",l[0].place),content:"GroupChart",chart_data:l[9]("LMS"),show:["ni","lgd"]},box_2a:{id:"employed",year:$t("LMS",l[0].place),content:"<p>People employed</p> <span class='text-big'>"+l[14]("LMS.value.EMPN").toLocaleString()+'</span> </p><p>Median salary</p> <span class="text-big">£'+l[14]("ASHE.value").toLocaleString()+"</span> ",show:["ni"]},box_2b:{id:"employed",year:$t("LMS",l[0].place),content:"<p>People employed</p> <span class='text-big'>"+l[14]("LMS.value.EMPN").toLocaleString()+'</span> </p><p>Median salary</p> <span class="text-big">£'+l[14]("ASHE.value").toLocaleString()+"</span> <span style='color: #1460aa'> (NI £"+l[0].ni.data.ASHE.value.toLocaleString()+") </span></p>",show:["lgd"]},box_3b:{id:"bres",year:$t("BRES",l[0].place),content:"GroupChart",chart_data:l[9]("BRES"),show:["ni","lgd"]},box_4:{id:"ucbenefits",year:$t("BS",l[0].place),content:'<span class="text-big">'+l[0].place.data.BS.value.UC.toLocaleString()+'</span> claimants<br><span class="text-big">'+(l[0].place.data.BS.value.UC/l[0].place.data.MYETotal.value*100).toFixed(1)+"%</span> of population",compare_content:{ni:"",lgd:"<span style='color: #1460aa; font-size: 12pt;'>(NI: <b>"+l[0].ni.data.BS.value.UC.toLocaleString()+"</b> claimants, <b>"+(l[0].ni.data.BS.value.UC/l[0].ni.data.MYETotal.value*100).toFixed(1)+"%</b> of population)</span>",dea:"<span style='color: #1460aa; font-size: 12pt;'>(NI: <b>"+l[0].ni.data.BS.value.UC.toLocaleString()+"</b> claimants, <b>"+(l[0].ni.data.BS.value.UC/l[0].ni.data.MYETotal.value*100).toFixed(1)+"%</b> of population)</span>",sdz:"<span style='color: #1460aa; font-size: 12pt;'>(NI: <b>"+l[0].ni.data.BS.value.UC.toLocaleString()+"</b> claimants, <b>"+(l[0].ni.data.BS.value.UC/l[0].ni.data.MYETotal.value*100).toFixed(1)+"%</b> of population)</span>",dz:"<span style='color: #1460aa; font-size: 12pt;'>(NI: <b>"+l[0].ni.data.BS.value.UC.toLocaleString()+"</b> claimants, <b>"+(l[0].ni.data.BS.value.UC/l[0].ni.data.MYETotal.value*100).toFixed(1)+"%</b> of population)</span>"}},box_5:{id:"pipbenefits",year:$t("BS",l[0].place),content:'<span class="text-big">'+l[0].place.data.BS.value.PIP.toLocaleString()+'</span> claimants<br><span class="text-big">'+(l[0].place.data.BS.value.PIP/l[0].place.data.MYETotal.value*100).toFixed(1)+"%</span> of population",compare_content:{ni:"",lgd:"<span style='color: #1460aa; font-size: 12pt;'>(NI: <b>"+l[0].ni.data.BS.value.PIP.toLocaleString()+"</b> claimants, <b>"+(l[0].ni.data.BS.value.PIP/l[0].ni.data.MYETotal.value*100).toFixed(1)+"%</b> of population)</span>",dea:"<span style='color: #1460aa; font-size: 12pt;'>(NI: <b>"+l[0].ni.data.BS.value.PIP.toLocaleString()+"</b> claimants, <b>"+(l[0].ni.data.BS.value.PIP/l[0].ni.data.MYETotal.value*100).toFixed(1)+"%</b> of population)</span>",sdz:"<span style='color: #1460aa; font-size: 12pt;'>(NI: <b>"+l[0].ni.data.BS.value.PIP.toLocaleString()+"</b> claimants, <b>"+(l[0].ni.data.BS.value.PIP/l[0].ni.data.MYETotal.value*100).toFixed(1)+"%</b> of population)</span>",dz:"<span style='color: #1460aa; font-size: 12pt;'>(NI: <b>"+l[0].ni.data.BS.value.PIP.toLocaleString()+"</b> claimants, <b>"+(l[0].ni.data.BS.value.PIP/l[0].ni.data.MYETotal.value*100).toFixed(1)+"%</b> of population)</span>"}},box_6:{id:"pensionagebenefits",year:$t("BS",l[0].place),content:'<span class="text-big">'+l[0].place.data.BS.value.RP.toLocaleString()+'</span> claimants<br><span class="text-big">'+(l[0].place.data.BS.value.RP/l[0].place.data.MYETotal.value*100).toFixed(1)+"%</span> of population",compare_content:{ni:"",lgd:"<span style='color: #1460aa; font-size: 12pt;'>(NI: <b>"+l[0].ni.data.BS.value.RP.toLocaleString()+"</b> claimants, <b>"+(l[0].ni.data.BS.value.RP/l[0].ni.data.MYETotal.value*100).toFixed(1)+"%</b> of population)</span>",dea:"<span style='color: #1460aa; font-size: 12pt;'>(NI: <b>"+l[0].ni.data.BS.value.RP.toLocaleString()+"</b> claimants, <b>"+(l[0].ni.data.BS.value.RP/l[0].ni.data.MYETotal.value*100).toFixed(1)+"%</b> of population)</span>",sdz:"<span style='color: #1460aa; font-size: 12pt;'>(NI: <b>"+l[0].ni.data.BS.value.RP.toLocaleString()+"</b> claimants, <b>"+(l[0].ni.data.BS.value.RP/l[0].ni.data.MYETotal.value*100).toFixed(1)+"%</b> of population)</span>",dz:"<span style='color: #1460aa; font-size: 12pt;'>(NI: <b>"+l[0].ni.data.BS.value.RP.toLocaleString()+"</b> claimants, <b>"+(l[0].ni.data.BS.value.RP/l[0].ni.data.MYETotal.value*100).toFixed(1)+"%</b> of population)</span>"}}},more:`<p>The monthly <a href='https://www.nisra.gov.uk/statistics/labour-market-and-social-welfare/labour-market-overview'>Labour Market Report</a>\r
				contains the most up to date labour market statistics. The <a href='https://www.nisra.gov.uk/statistics/labour-market-and-social-welfare/annual-survey-hours-and-earnings'>\r
				Annual Survey of Hours and Earnings</a> provides data on hourly, weekly and annual earnings. The <a href='https://www.nisra.gov.uk/statistics/labour-market-and-social-welfare/quarterly-employment-survey'>\r
				Quarterly Employment Survey</a> provides short-term employee jobs estimates for NI. Further information is available for the \r
				unemployed <a href='https://www.nisra.gov.uk/statistics/labour-market-and-social-welfare/claimant-count'>Claimant Count</a>, \r
				claimant numbers for <a href='https://www.nisra.gov.uk/statistics/labour-market-and-social-welfare/disability-benefits'>Disability Benefits</a>, \r
				and <a href='https://www.nisra.gov.uk/statistics/labour-market-and-social-welfare/work-related-benefits'>Work Related Benefits</a>. \r
				Statistics on <a href='https://www.nisra.gov.uk/statistics/labour-market-and-social-welfare/redundancies'>Redundancies</a> \r
				and <a href='https://www.nisra.gov.uk/statistics/labour-market-and-social-welfare/job-vacancies'>Job Vacancies</a> are also available. \r
				A number of <a href='https://visual.nisra.gov.uk/?body=entity/lm'>interactive dashboards</a> are available. \r
				The <a href='https://www.nisra.gov.uk/statistics/census'>2021 census</a> collected data on occupations, industry and number of hours worked which can be \r
				explored in the <a href='https://explore.nisra.gov.uk/area-explorer-2021/N92000002/'>Census Area Explorer</a> and the <a href='https://build.nisra.gov.uk/en/'>Flexible Table Builder</a>.</p>`}}),Qi=new ts({props:{id:"education",img:"nisra-taxonomy-icon-child-education-skills.png",heading:"Education and skills",place:l[0].place,sub_heading:l[17]("Schools, colleges and universities",l[0].place),description:"",chart_compare_type:l[6],boxes:{box_1:{id:"enrollments",content:"<p style='margin:0'>Primary school <span class='text-big'>"+l[14]("Primary.value.All").toLocaleString()+"</span> <p style='margin:0'>Post primary school <span class='text-big'>"+l[14]("PostPrimary.value.All").toLocaleString()+" </span><p style='margin:0'>NI Further education colleges <span class='text-big'>"+l[14]("FE.value").toLocaleString()+"</span><p style='margin:0'>UK Higher education institutions <span class='text-big'>"+l[14]("HE.value").toLocaleString()+" </span>",year:$t("Primary",l[0].place),show:["ni","lgd","dea"]},box_2a:{id:"fsme",content:"<p style='margin:0'>Primary school <span class='text-big'> "+Number(l[14]("Primary.perc.FSME")).toFixed(0)+"% </span><p style='margin:0'>Post primary school <span class='text-big'>"+Number(l[14]("PostPrimary.perc.FSME")).toFixed(0)+"% </span>",year:$t("Primary",l[0].place),show:["ni"]},box_2b:{id:"fsme",content:"<p style='margin:0'>Primary school <span class='text-big'> "+Number(l[14]("Primary.perc.FSME")).toFixed(0)+"% </span><span style='color: #1460aa'> (NI "+l[0].ni.data.Primary.perc.FSME.toFixed(0)+"%) </span></p><p style='margin:0'>Post primary school <span class='text-big'>"+Number(l[14]("Primary.perc.FSME")).toFixed(0)+"% </span><span style='color: #1460aa'> (NI "+l[0].ni.data.PostPrimary.perc.FSME.toFixed(0)+"%) </span></p>",year:$t("Primary",l[0].place),show:["lgd","dea"]},box_3:{id:"SEN",year:$t("SEN",l[0].place),content:"<p>Non statemented <span class='text-big'>"+(l[14]("SEN.value.SENNonStatemented")+l[14]("Primary.value.SENNonStatemented")+l[14]("PostPrimary.value.SENNonStatemented")).toLocaleString()+"</span> pupils</p><p>Statemented <span class='text-big'>"+(l[14]("SEN.value.SENStatement")+l[14]("Primary.value.SENStatement")+l[14]("PostPrimary.value.SENStatement")).toLocaleString()+"</span> pupils</p>",show:["ni","lgd","dea"]},box_4:{id:"qualifications",content:"GroupChart",year:l[16]("highest_level_of_qualifications"),chart_data:l[9]("highest_level_of_qualifications")},box_5a:{id:"attainment",year:$t("Attainment",l[0].place),content:"<p>Pupils who left school with 5 or more GCSEs (or equivalents) grades A*-C</p><p> <span class='text-big'>"+l[14]("Attainment.value").toLocaleString()+"%</span> <p>including GCSE English and maths</p>",show:["ni"]},box_5b:{id:"attainment",year:$t("Attainment",l[0].place),content:"Pupils who left school with 5 or more GCSEs (or equivalents) grades A*-C:<br><span class='text-big'>"+l[14]("Attainment.value").toLocaleString()+"%</span> <span style='color: #1460aa'>(NI "+l[0].ni.data.Attainment.value.toLocaleString(void 0,{minimumFractionDigits:1})+"%) </span><br>including GCSE English and maths"+l[15]("Attainment.value").toLocaleString(),show:["lgd"]},box_6:{id:"destination",year:$t("Destination",l[0].place),content:"GroupChart",chart_data:l[9]("Destination"),show:["ni","lgd","dea"]},box_6a:{id:"empty",i_button:!1,content:"",show:["sdz","dz"]},box_6b:{id:"empty",i_button:!1,content:"",show:["sdz","dz"]}},more:"<p>The <a href='https://www.nisra.gov.uk/statistics/children-education-and-skills/school-education-statistics'>Department of Education</a> publishes statistics on <a href='https://www.education-ni.gov.uk/articles/school-enrolments-overview'>school enrolments</a>, <a href='https://www.education-ni.gov.uk/articles/school-performance'>school performance</a>, <a href='https://www.education-ni.gov.uk/articles/school-leavers'>school leavers</a>, qualifications and destinations, <a href='https://www.education-ni.gov.uk/articles/pupil-attendance'>pupil attendance</a>, suspensions and expulsions, school meals and <a href='https://www.education-ni.gov.uk/articles/education-workforce'>education workforce</a>. The <a href='https://www.nisra.gov.uk/statistics/children-education-and-skills/higher-and-further-education-and-training-statistics'>Department for the Economy</a> publishes <a href='https://www.economy-ni.gov.uk/topics/statistics-and-economic-research/higher-education-statistics-and-research'>Higher</a> and <a href='https://www.economy-ni.gov.uk/topics/statistics-and-economic-research/further-education-statistics-and-research'>Further</a> education and <a href='https://www.economy-ni.gov.uk/articles/training-success-statistics'>training</a> statistics. The <a href='https://www.nisra.gov.uk/statistics/census'>2021 census</a> collected data on qualifications which can be explored in the <a href='https://explore.nisra.gov.uk/area-explorer-2021/N92000002/'>Census Area Explorer</a> and the <a href='https://build.nisra.gov.uk/en/'>Flexible Table Builder</a>.</p>"}}),Oi=new ts({props:{id:"crime",img:"nisra-taxonomy-icon-crime-justice.png",heading:"Crime and justice",place:l[0].place,sub_heading:l[17]("Crime and Court Activity",l[0].place),description:" ",chart_compare_type:l[6],boxes:{},more:""}}),$i=new ts({props:{id:"travel",img:"nisra-taxonomy-icon-travel-transport.png",heading:"Travel and Transport",place:l[0].place,sub_heading:l[17]("Travel and transport",l[0].place),description:" ",chart_compare_type:l[6],boxes:{},more:""}}),Ni=new ts({props:{id:"economy",img:"nisra-taxonomy-icon-economy.png",heading:"Economy",place:l[0].place,sub_heading:l[17]("Economy",l[0].place),description:" ",chart_compare_type:l[6],boxes:{},more:""}}),Ui=new ts({props:{id:"environment",img:"nisra-taxonomy-icon-agriculture.png",heading:"Environment",place:l[0].place,sub_heading:l[17]("Environment",l[0].place),description:" ",chart_compare_type:l[6],boxes:{},more:""}}),{c(){h=Ue("div"),d=Ue("div"),p=Ue("span"),y=Ue("a"),v=Tt("Home"),a=new Bl(!1),T=yt(),Qr&&Qr.c(),F=yt(),M=Ue("br"),N=Ue("span"),X=Tt(R),Q=yt(),ae=Ue("div"),le=Ue("div"),de=Ue("b"),ge=Tt("Search for your area:"),rt=yt(),ur(Fe.$$.fragment),ze=yt(),Ge=Ue("script"),zt=Tt(`// Share button\r
						// Possible tooltip: https://stackoverflow.com/questions/37798967/tooltip-on-click-of-a-button\r
\r
						function copyToClipboard(text) {\r
							var inputc = document.body.appendChild(\r
								document.createElement("input"),\r
							);\r
							inputc.value = window.location.href;\r
							inputc.select();\r
							document.execCommand("copy");\r
							inputc.parentNode.removeChild(inputc);\r
							alert("URL Copied.");\r
						}\r
\r
						(function (win, doc) {\r
							const testButton = doc.createElement("button");\r
							testButton.setAttribute("type", "share");\r
							if (testButton.type != "share") {\r
								win.addEventListener("click", function (ev) {\r
									ev = ev || win.event;\r
									let target = ev.target;\r
									let button = target.closest(\r
										'button[type="share"]',\r
									);\r
									if (button) {\r
										const title = "Share URL";\r
										const url = win.location.href;\r
										if (navigator.share) {\r
											navigator.share({\r
												title: title,\r
												url: url,\r
											});\r
										} else {\r
											copyToClipboard();\r
										}\r
									}\r
								});\r
							}\r
						})(this, this.document);`),wt=yt(),je=Ue("div"),Ze=Ue("button"),mt=Tt("About"),nr=yt(),qe=Ue("button"),Bt=Tt("Print / PDF"),Re=yt(),et=Ue("button"),dt=Tt("Share"),qt=yt(),ur(Mt.$$.fragment),xt=yt(),Ae=Ue("div"),ur(at.$$.fragment),Mr=yt(),ur(Zr.$$.fragment),wi=yt(),ur(Rr.$$.fragment),ar=yt(),Sr=Ue("div"),Gt=Ue("div"),Si=Ue("h3"),$r.c(),Jn=yt(),ti=Ue("div"),ur(Nt.$$.fragment),ci=yt(),Jr=Ue("div"),Br&&Br.c(),Bn=yt(),hi=Ue("div"),U.c(),ni=yt(),vr=Ue("div"),ur(gi.$$.fragment),pi=yt(),ur(Vr.$$.fragment),Ji=yt(),ur(Kr.$$.fragment),In=yt(),ur(Qi.$$.fragment),Fn=yt(),ur(Oi.$$.fragment),Pn=yt(),ur($i.$$.fragment),zn=yt(),ur(Ni.$$.fragment),mn=yt(),ur(Ui.$$.fragment),this.h()},l(I){h=Ve(I,"DIV",{class:!0});var V=Be(h);d=Ve(V,"DIV",{});var W=Be(d);p=Ve(W,"SPAN",{class:!0});var ue=Be(p);y=Ve(ue,"A",{href:!0,"data-sveltekit-noscroll":!0,"data-sveltekit-keepfocus":!0,class:!0});var pe=Be(y);v=It(pe,"Home"),pe.forEach(ne),a=Fl(ue,!1),T=gt(ue),Qr&&Qr.l(ue),ue.forEach(ne),F=gt(W),M=Ve(W,"BR",{}),N=Ve(W,"SPAN",{class:!0,style:!0});var j=Be(N);X=It(j,R),j.forEach(ne),W.forEach(ne),Q=gt(V),ae=Ve(V,"DIV",{});var $=Be(ae);le=Ve($,"DIV",{style:!0,class:!0});var me=Be(le);de=Ve(me,"B",{});var Ce=Be(de);ge=It(Ce,"Search for your area:"),Ce.forEach(ne),rt=gt(me),cr(Fe.$$.fragment,me),ze=gt(me),Ge=Ve(me,"SCRIPT",{});var Oe=Be(Ge);zt=It(Oe,`// Share button\r
						// Possible tooltip: https://stackoverflow.com/questions/37798967/tooltip-on-click-of-a-button\r
\r
						function copyToClipboard(text) {\r
							var inputc = document.body.appendChild(\r
								document.createElement("input"),\r
							);\r
							inputc.value = window.location.href;\r
							inputc.select();\r
							document.execCommand("copy");\r
							inputc.parentNode.removeChild(inputc);\r
							alert("URL Copied.");\r
						}\r
\r
						(function (win, doc) {\r
							const testButton = doc.createElement("button");\r
							testButton.setAttribute("type", "share");\r
							if (testButton.type != "share") {\r
								win.addEventListener("click", function (ev) {\r
									ev = ev || win.event;\r
									let target = ev.target;\r
									let button = target.closest(\r
										'button[type="share"]',\r
									);\r
									if (button) {\r
										const title = "Share URL";\r
										const url = win.location.href;\r
										if (navigator.share) {\r
											navigator.share({\r
												title: title,\r
												url: url,\r
											});\r
										} else {\r
											copyToClipboard();\r
										}\r
									}\r
								});\r
							}\r
						})(this, this.document);`),Oe.forEach(ne),wt=gt(me),je=Ve(me,"DIV",{width:!0});var we=Be(je);Ze=Ve(we,"BUTTON",{class:!0,style:!0,alt:!0,onclick:!0});var De=Be(Ze);mt=It(De,"About"),De.forEach(ne),nr=gt(we),qe=Ve(we,"BUTTON",{class:!0,style:!0,title:!0,onclick:!0});var st=Be(qe);Bt=It(st,"Print / PDF"),st.forEach(ne),Re=gt(we),et=Ve(we,"BUTTON",{class:!0,style:!0,type:!0,alt:!0});var tt=Be(et);dt=It(tt,"Share"),tt.forEach(ne),we.forEach(ne),me.forEach(ne),$.forEach(ne),V.forEach(ne),qt=gt(I),cr(Mt.$$.fragment,I),xt=gt(I),Ae=Ve(I,"DIV",{id:!0,class:!0});var Se=Be(Ae);cr(at.$$.fragment,Se),Mr=gt(Se),cr(Zr.$$.fragment,Se),wi=gt(Se),cr(Rr.$$.fragment,Se),Se.forEach(ne),ar=gt(I),Sr=Ve(I,"DIV",{class:!0});var He=Be(Sr);Gt=Ve(He,"DIV",{style:!0});var Ye=Be(Gt);Si=Ve(Ye,"H3",{class:!0});var Qe=Be(Si);$r.l(Qe),Qe.forEach(ne),Ye.forEach(ne),Jn=gt(He),ti=Ve(He,"DIV",{id:!0,style:!0,class:!0});var Vt=Be(ti);cr(Nt.$$.fragment,Vt),Vt.forEach(ne),ci=gt(He),Jr=Ve(He,"DIV",{});var it=Be(Jr);Br&&Br.l(it),it.forEach(ne),Bn=gt(He),hi=Ve(He,"DIV",{});var Wt=Be(hi);U.l(Wt),Wt.forEach(ne),He.forEach(ne),ni=gt(I),vr=Ve(I,"DIV",{class:!0,id:!0});var jt=Be(vr);cr(gi.$$.fragment,jt),pi=gt(jt),cr(Vr.$$.fragment,jt),Ji=gt(jt),cr(Kr.$$.fragment,jt),In=gt(jt),cr(Qi.$$.fragment,jt),Fn=gt(jt),cr(Oi.$$.fragment,jt),Pn=gt(jt),cr($i.$$.fragment,jt),zn=gt(jt),cr(Ni.$$.fragment,jt),mn=gt(jt),cr(Ui.$$.fragment,jt),jt.forEach(ne),this.h()},h(){ie(y,"href",kn+"/"),ie(y,"data-sveltekit-noscroll",""),ie(y,"data-sveltekit-keepfocus",""),ie(y,"class","svelte-hmrro5"),a.a=T,ie(p,"class","text-small"),ie(N,"class","text-big title svelte-hmrro5"),We(N,"font-size","2.5em"),We(N,"line-height","1em"),ie(Ze,"class","btn svelte-hmrro5"),We(Ze,"width","33%"),ie(Ze,"alt","Opens the About page"),ie(Ze,"onclick","window.location.href='"+kn+"/about';"),ie(qe,"class","btn svelte-hmrro5"),We(qe,"width","33%"),ie(qe,"title","Click to print this page to pdf or printer"),ie(qe,"onclick","window.print();return false;"),ie(et,"class","btn svelte-hmrro5"),We(et,"width","30%"),ie(et,"type","share"),ie(et,"alt","Share this page"),ie(je,"width","100%"),We(le,"width","350px"),We(le,"padding-top","5px"),ie(le,"class","svelte-hmrro5"),is(le,"float-right",l[2]>1),ie(h,"class","grid mtl svelte-hmrro5"),ie(Ae,"id","grid"),ie(Ae,"class","grid mt svelte-hmrro5"),ie(Si,"class","svelte-hmrro5"),We(Gt,"grid-column","span "+l[2]),ie(ti,"id","map"),We(ti,"padding-right","45px"),We(ti,"grid-column","span "+(l[2]==2?2:l[2]&&l[2]>2?l[2]-1:1)),ie(ti,"class","svelte-hmrro5"),ie(Sr,"class","grid mt svelte-hmrro5"),Gu(()=>l[21].call(Sr)),ie(vr,"class","accordion"),ie(vr,"id","accordionPanelsStayOpenExample")},m(I,V){Le(I,h,V),xe(h,d),xe(d,p),xe(p,y),xe(y,v),a.m(k,p),xe(p,T),Qr&&Qr.m(p,null),xe(d,F),xe(d,M),xe(d,N),xe(N,X),xe(h,Q),xe(h,ae),xe(ae,le),xe(le,de),xe(de,ge),xe(le,rt),hr(Fe,le,null),xe(le,ze),xe(le,Ge),xe(Ge,zt),xe(le,wt),xe(le,je),xe(je,Ze),xe(Ze,mt),xe(je,nr),xe(je,qe),xe(qe,Bt),xe(je,Re),xe(je,et),xe(et,dt),Le(I,qt,V),hr(Mt,I,V),Le(I,xt,V),Le(I,Ae,V),hr(at,Ae,null),xe(Ae,Mr),hr(Zr,Ae,null),xe(Ae,wi),hr(Rr,Ae,null),Le(I,ar,V),Le(I,Sr,V),xe(Sr,Gt),xe(Gt,Si),$r.m(Si,null),xe(Sr,Jn),xe(Sr,ti),hr(Nt,ti,null),xe(Sr,ci),xe(Sr,Jr),Br&&Br.m(Jr,null),xe(Sr,Bn),xe(Sr,hi),U.m(hi,null),Tn=Zu(Sr,l[21].bind(Sr)),Le(I,ni,V),Le(I,vr,V),hr(gi,vr,null),xe(vr,pi),hr(Vr,vr,null),xe(vr,Ji),hr(Kr,vr,null),xe(vr,In),hr(Qi,vr,null),xe(vr,Fn),hr(Oi,vr,null),xe(vr,Pn),hr($i,vr,null),xe(vr,zn),hr(Ni,vr,null),xe(vr,mn),hr(Ui,vr,null),Vi=!0},p(I,V){I[0].place.type!="ni"?Qr?Qr.p(I,V):(Qr=Qm(I),Qr.c(),Qr.m(p,null)):Qr&&(Qr.d(1),Qr=null),(!Vi||V[0]&1)&&R!==(R=I[0].place.name+"")&&wr(X,R);const W={};V[0]&1&&(W.search_data=I[0].search_data),Fe.$set(W),(!Vi||V[0]&4)&&is(le,"float-right",I[2]>1);const ue={};V[0]&1&&(ue.place=I[0].place),Mt.$set(ue);const pe={};V[0]&1&&(pe.heading="About "+I[0].place.name),V[0]&1&&(pe.place=I[0].place),V[0]&1&&(pe.content={ni:"Northern Ireland has 11 Local Government Districts (LGDs),  which can be subdivided into District Electoral Areas (DEAs), then further into Super Data Zones and Data Zones. Statistics can be viewed for these smaller areas.",lgd:I[0].place.name+" is one of "+I[0].place.count.toLocaleString()+" "+En[I[0].place.type].pl+".  It includes the larger settlements of "+I[0].place.lgd_location_description,dea:I[0].place.name+" is one of "+I[0].place.count.toLocaleString()+" "+En[I[0].place.type].pl+" in Northern Ireland.  It is within <a href = '/"+I[0].place.parents[0].code+"/' data-sveltekit-noscroll data-sveltekit-keepfocus>"+I[0].place.parents[0].name+" </a> and covers "+I[0].place.dea_location_description+".",sdz:I[0].place.name+" is one of "+I[0].place.count.toLocaleString()+" "+En[I[0].place.type].pl+". Super Data Zones are new statistical areas developed for census. They are broadly similar in population size and housing type.",dz:I[0].place.name+" is one of "+I[0].place.count.toLocaleString()+" "+En[I[0].place.type].pl+".  Data Zones are smaller divisions of Super Data Zones. There are on average 4 in each Super Data Zone."}),V[0]&64&&(pe.chart_compare_type=I[6]),at.$set(pe);const j={};V[0]&1&&(j.place=I[0].place),V[0]&1&&(j.year=$t("MYETotal",I[0].place)),V[0]&1&&(j.content='<span class="text-big" style="font-size: 2.8em;">'+I[0].place.data.MYETotal.value.toLocaleString()+"</span>"),V[0]&64&&(j.chart_compare_type=I[6]),V[0]&1&&(j.compare_content={ni:"",lgd:'<span class = "em" style = "background-color: lightgrey">'+mh(I[0].place.data.population.value[2021].all/I[0].ni.data.population.value[2021].all)+"</span> of Northern Ireland population<br>The "+I[12](I[0].place.data.population.value_rank[2021].all)+" population of 11 Local Government Districts",dea:'<span class = "em" style = "background-color: lightgrey">'+mh(I[0].place.data.population.value[2021].all/I[0].ni.data.population.value[2021].all)+"</span> of Northern Ireland population",sdz:"Data not available for area comparison",dz:" Data not available for area comparison"}),Zr.$set(j);const $={};V[0]&1&&($.place=I[0].place),V[0]&1&&($.year=$t("MYETotal",I[0].place)),V[0]&1&&($.content='<div class = "row" style = "display: flex; align-items: center"><div style="font-weight: bold; font-size: 2.8em;">'+ny(I[0].place)+'</div><div style = "margin-left: 10px; line-height: 1.25em;"> people per square kilometer</div></div>'),V[0]&64&&($.chart_compare_type=I[6]),V[0]&1&&($.compare_content={ni:"",lgd:I[18](I[0].place),dea:I[18](I[0].place),sdz:I[18](I[0].place),dz:I[18](I[0].place)}),Rr.$set($),ln===(ln=ia(I))&&$r?$r.p(I,V):($r.d(1),$r=ln(I),$r&&($r.c(),$r.m(Si,null))),(!Vi||V[0]&4)&&We(Gt,"grid-column","span "+I[2]);const me={};V[0]&1&&(me.location={bounds:I[0].place.bounds}),V[0]&48|V[1]&128&&(me.$$scope={dirty:V,ctx:I}),!dn&&V[0]&8&&(dn=!0,me.map=I[3],d_(()=>dn=!1)),Nt.$set(me),(!Vi||V[0]&4)&&We(ti,"grid-column","span "+(I[2]==2?2:I[2]&&I[2]>2?I[2]-1:1)),I[0].place.type!="ni"?Br?Br.p(I,V):(Br=ty(I),Br.c(),Br.m(Jr,null)):Br&&(Br.d(1),Br=null),L===(L=Pr(I))&&U?U.p(I,V):(U.d(1),U=L(I),U&&(U.c(),U.m(hi,null)));const Ce={};V[0]&1&&(Ce.place=I[0].place),V[0]&1&&(Ce.sub_heading=I[17]("People and households",I[0].place)),V[0]&64&&(Ce.chart_compare_type=I[6]),V[0]&193&&(Ce.boxes={box_1:{id:"popchange",content:I[13](I[0].place),show:["ni","lgd"]},box_2:{id:"broadage",year:$t("BroadAge",I[0].place),content:"GroupChart",chart_data:I[9]("BroadAge"),show:["ni","lgd","dea","sdz"]},box_4:{id:"hhsize",year:I[16]("hh_size"),content:"GroupChart",chart_data:I[9]("hh_size")},box_5:{id:"religion",year:I[16]("religion_or_religion_brought_up_in"),content:"GroupChart",chart_data:I[9]("religion_or_religion_brought_up_in")},box_7:{id:"language",year:I[16]("mainlang"),content:"StackedBarChart",chart_data:I[0].place&&I[8](["mainlang"],["2011"],["2021"]),zKey:I[6],label:I[7],topic_prev_available:!0}}),gi.$set(Ce);const Oe={};V[0]&1&&(Oe.place=I[0].place),V[0]&1&&(Oe.sub_heading=I[17]("Health and social care",I[0].place)),V[0]&64&&(Oe.chart_compare_type=I[6]),V[0]&1&&(Oe.boxes={box_0:{id:"generalhealth",year:I[16]("general_health"),content:"GroupChart",chart_data:I[9]("general_health")},box_2a:{id:"wellbeing",year:$t("Happy",I[0].place),content:"<p>Happiness</p><span class='text-big'>"+I[14]("Happy.value").toLocaleString()+"</span>/ 10 <p>Life Satisfaction</p><span class='text-big'>"+I[14]("Satisfy.value").toLocaleString()+"</span>/ 10 ",show:["ni"]},box_2b:{id:"wellbeing",year:$t("Happy",I[0].place),content:"<p>Happiness</p><span class='text-big'>"+I[14]("Happy.value").toLocaleString()+"</span>/ 10 <span style='color: #1460aa'> (NI "+I[0].ni.data.Happy.value+"/10) </span></p><p>Life Satisfaction</p><span class='text-big'>"+I[14]("Satisfy.value").toLocaleString()+"</span>/ 10 <span style='color: #1460aa'> (NI "+I[0].ni.data.Satisfy.value+"/10) </span></p>",show:["lgd"]},box_3a:{id:"lifeexpectancy",year:$t("LE",I[0].place),content:"<p>Male</p> <span class='text-big'>"+I[14]("LE.value.Males").toLocaleString()+"</span> years<p>Female</p> <span class='text-big'>"+I[14]("LE.value.Females").toLocaleString()+"</span> years",show:["ni"]},box_3b:{id:"lifeexpectancy",year:$t("LE",I[0].place),content:"<p>Male</p> <span class='text-big'>"+I[14]("LE.value.Males").toLocaleString()+"</span> years<span style='color: #1460aa'> (NI "+I[0].ni.data.LE.value.Males+") </span></p><p>Female</p> <span class='text-big'>"+I[14]("LE.value.Females").toLocaleString()+"</span> years<span style='color: #1460aa'> (NI "+I[0].ni.data.LE.value.Females+") </span></p>",show:["lgd","dea"]},box_4:{id:"carers",content:"GroupChart",year:I[16]("provision_care"),chart_data:I[9]("provision_care")},box_5:{id:"hospitalactivity",year:$t("Admiss",I[0].place),content:"<p><span class='text-big'>"+I[14]("Admiss.value").toLocaleString()+"</span> hospital admissions</p><p>The most frequent primary reason was for </p><span class='text-bold' >"+I[14]("Admiss.text")+"</span>",show:["ni","dea"]},box_6:{id:"primarycare",year:$t("GP",I[0].place),content:"<p><span class='text-big'>"+I[14]("GP.value.PRACS").toLocaleString()+"</span> GP practices with an average of <span class='text-big'>"+I[14]("GP.value.PRACLIST").toLocaleString()+"</span> patients per practice</p><p><span class='text-big'>"+I[14]("DEN.value.GDSDSSurgeries").toLocaleString()+"</span> dental surgeries</span> with an average of <span class='text-big'>"+(I[14]("DEN_REG.value.Dental_Registrations")/I[14]("DEN.value.GDSDSSurgeries")).toLocaleString(void 0,{minimumFractionDigits:0,maximumFractionDigits:0})+"</span> patients per surgery</p>",show:["ni"]},box_6a:{id:"primarycare",year:$t("GP",I[0].place),content:"<p><span class='text-big'>"+I[14]("GP.value.PRACS").toLocaleString()+"</span> GP practices with an average of <span class='text-big'>"+I[14]("GP.value.PRACLIST").toLocaleString()+"</span> patients per practice</p><p>"+I[15]("GP.value.PRACLIST").toLocaleString()+"<span style='color: #1460aa'> (NI "+I[0].ni.data.GP.value.PRACLIST.toLocaleString()+" patients per practice) </span></p><p><span class='text-big'>"+I[14]("DEN.value.GDSDSSurgeries").toLocaleString()+"</span> dental surgeries</span> with an average of <span class='text-big'>"+(I[14]("DEN_REG.value.Dental_Registrations")/I[14]("DEN.value.GDSDSSurgeries")).toLocaleString(void 0,{minimumFractionDigits:0,maximumFractionDigits:0})+"</span> patients per surgery</p>",show:["lgd"]},box_6b:{id:"primarycare",year:$t("DEN",I[0].place),content:"<p><span class='text-big'>"+I[14]("DEN.value.GDSDSSurgeries").toLocaleString()+"</span> dental surgeries</span> with an average of <span class='text-big'>"+(I[14]("DEN_REG.value.Dental_Registrations")/I[14]("DEN.value.GDSDSSurgeries")).toLocaleString(void 0,{minimumFractionDigits:0,maximumFractionDigits:0})+"</span> patients per surgery</p>",show:["dea"]},box_6c:{id:"empty",i_button:!1,content:"",show:["sdz","dz"]}}),Vr.$set(Oe);const we={};V[0]&1&&(we.place=I[0].place),V[0]&1&&(we.sub_heading=I[17]("Work and welfare",I[0].place)),V[0]&64&&(we.chart_compare_type=I[6]),V[0]&1&&(we.boxes={box_1:{id:"employmentrates",year:$t("LMS",I[0].place),content:"GroupChart",chart_data:I[9]("LMS"),show:["ni","lgd"]},box_2a:{id:"employed",year:$t("LMS",I[0].place),content:"<p>People employed</p> <span class='text-big'>"+I[14]("LMS.value.EMPN").toLocaleString()+'</span> </p><p>Median salary</p> <span class="text-big">£'+I[14]("ASHE.value").toLocaleString()+"</span> ",show:["ni"]},box_2b:{id:"employed",year:$t("LMS",I[0].place),content:"<p>People employed</p> <span class='text-big'>"+I[14]("LMS.value.EMPN").toLocaleString()+'</span> </p><p>Median salary</p> <span class="text-big">£'+I[14]("ASHE.value").toLocaleString()+"</span> <span style='color: #1460aa'> (NI £"+I[0].ni.data.ASHE.value.toLocaleString()+") </span></p>",show:["lgd"]},box_3b:{id:"bres",year:$t("BRES",I[0].place),content:"GroupChart",chart_data:I[9]("BRES"),show:["ni","lgd"]},box_4:{id:"ucbenefits",year:$t("BS",I[0].place),content:'<span class="text-big">'+I[0].place.data.BS.value.UC.toLocaleString()+'</span> claimants<br><span class="text-big">'+(I[0].place.data.BS.value.UC/I[0].place.data.MYETotal.value*100).toFixed(1)+"%</span> of population",compare_content:{ni:"",lgd:"<span style='color: #1460aa; font-size: 12pt;'>(NI: <b>"+I[0].ni.data.BS.value.UC.toLocaleString()+"</b> claimants, <b>"+(I[0].ni.data.BS.value.UC/I[0].ni.data.MYETotal.value*100).toFixed(1)+"%</b> of population)</span>",dea:"<span style='color: #1460aa; font-size: 12pt;'>(NI: <b>"+I[0].ni.data.BS.value.UC.toLocaleString()+"</b> claimants, <b>"+(I[0].ni.data.BS.value.UC/I[0].ni.data.MYETotal.value*100).toFixed(1)+"%</b> of population)</span>",sdz:"<span style='color: #1460aa; font-size: 12pt;'>(NI: <b>"+I[0].ni.data.BS.value.UC.toLocaleString()+"</b> claimants, <b>"+(I[0].ni.data.BS.value.UC/I[0].ni.data.MYETotal.value*100).toFixed(1)+"%</b> of population)</span>",dz:"<span style='color: #1460aa; font-size: 12pt;'>(NI: <b>"+I[0].ni.data.BS.value.UC.toLocaleString()+"</b> claimants, <b>"+(I[0].ni.data.BS.value.UC/I[0].ni.data.MYETotal.value*100).toFixed(1)+"%</b> of population)</span>"}},box_5:{id:"pipbenefits",year:$t("BS",I[0].place),content:'<span class="text-big">'+I[0].place.data.BS.value.PIP.toLocaleString()+'</span> claimants<br><span class="text-big">'+(I[0].place.data.BS.value.PIP/I[0].place.data.MYETotal.value*100).toFixed(1)+"%</span> of population",compare_content:{ni:"",lgd:"<span style='color: #1460aa; font-size: 12pt;'>(NI: <b>"+I[0].ni.data.BS.value.PIP.toLocaleString()+"</b> claimants, <b>"+(I[0].ni.data.BS.value.PIP/I[0].ni.data.MYETotal.value*100).toFixed(1)+"%</b> of population)</span>",dea:"<span style='color: #1460aa; font-size: 12pt;'>(NI: <b>"+I[0].ni.data.BS.value.PIP.toLocaleString()+"</b> claimants, <b>"+(I[0].ni.data.BS.value.PIP/I[0].ni.data.MYETotal.value*100).toFixed(1)+"%</b> of population)</span>",sdz:"<span style='color: #1460aa; font-size: 12pt;'>(NI: <b>"+I[0].ni.data.BS.value.PIP.toLocaleString()+"</b> claimants, <b>"+(I[0].ni.data.BS.value.PIP/I[0].ni.data.MYETotal.value*100).toFixed(1)+"%</b> of population)</span>",dz:"<span style='color: #1460aa; font-size: 12pt;'>(NI: <b>"+I[0].ni.data.BS.value.PIP.toLocaleString()+"</b> claimants, <b>"+(I[0].ni.data.BS.value.PIP/I[0].ni.data.MYETotal.value*100).toFixed(1)+"%</b> of population)</span>"}},box_6:{id:"pensionagebenefits",year:$t("BS",I[0].place),content:'<span class="text-big">'+I[0].place.data.BS.value.RP.toLocaleString()+'</span> claimants<br><span class="text-big">'+(I[0].place.data.BS.value.RP/I[0].place.data.MYETotal.value*100).toFixed(1)+"%</span> of population",compare_content:{ni:"",lgd:"<span style='color: #1460aa; font-size: 12pt;'>(NI: <b>"+I[0].ni.data.BS.value.RP.toLocaleString()+"</b> claimants, <b>"+(I[0].ni.data.BS.value.RP/I[0].ni.data.MYETotal.value*100).toFixed(1)+"%</b> of population)</span>",dea:"<span style='color: #1460aa; font-size: 12pt;'>(NI: <b>"+I[0].ni.data.BS.value.RP.toLocaleString()+"</b> claimants, <b>"+(I[0].ni.data.BS.value.RP/I[0].ni.data.MYETotal.value*100).toFixed(1)+"%</b> of population)</span>",sdz:"<span style='color: #1460aa; font-size: 12pt;'>(NI: <b>"+I[0].ni.data.BS.value.RP.toLocaleString()+"</b> claimants, <b>"+(I[0].ni.data.BS.value.RP/I[0].ni.data.MYETotal.value*100).toFixed(1)+"%</b> of population)</span>",dz:"<span style='color: #1460aa; font-size: 12pt;'>(NI: <b>"+I[0].ni.data.BS.value.RP.toLocaleString()+"</b> claimants, <b>"+(I[0].ni.data.BS.value.RP/I[0].ni.data.MYETotal.value*100).toFixed(1)+"%</b> of population)</span>"}}}),Kr.$set(we);const De={};V[0]&1&&(De.place=I[0].place),V[0]&1&&(De.sub_heading=I[17]("Schools, colleges and universities",I[0].place)),V[0]&64&&(De.chart_compare_type=I[6]),V[0]&1&&(De.boxes={box_1:{id:"enrollments",content:"<p style='margin:0'>Primary school <span class='text-big'>"+I[14]("Primary.value.All").toLocaleString()+"</span> <p style='margin:0'>Post primary school <span class='text-big'>"+I[14]("PostPrimary.value.All").toLocaleString()+" </span><p style='margin:0'>NI Further education colleges <span class='text-big'>"+I[14]("FE.value").toLocaleString()+"</span><p style='margin:0'>UK Higher education institutions <span class='text-big'>"+I[14]("HE.value").toLocaleString()+" </span>",year:$t("Primary",I[0].place),show:["ni","lgd","dea"]},box_2a:{id:"fsme",content:"<p style='margin:0'>Primary school <span class='text-big'> "+Number(I[14]("Primary.perc.FSME")).toFixed(0)+"% </span><p style='margin:0'>Post primary school <span class='text-big'>"+Number(I[14]("PostPrimary.perc.FSME")).toFixed(0)+"% </span>",year:$t("Primary",I[0].place),show:["ni"]},box_2b:{id:"fsme",content:"<p style='margin:0'>Primary school <span class='text-big'> "+Number(I[14]("Primary.perc.FSME")).toFixed(0)+"% </span><span style='color: #1460aa'> (NI "+I[0].ni.data.Primary.perc.FSME.toFixed(0)+"%) </span></p><p style='margin:0'>Post primary school <span class='text-big'>"+Number(I[14]("Primary.perc.FSME")).toFixed(0)+"% </span><span style='color: #1460aa'> (NI "+I[0].ni.data.PostPrimary.perc.FSME.toFixed(0)+"%) </span></p>",year:$t("Primary",I[0].place),show:["lgd","dea"]},box_3:{id:"SEN",year:$t("SEN",I[0].place),content:"<p>Non statemented <span class='text-big'>"+(I[14]("SEN.value.SENNonStatemented")+I[14]("Primary.value.SENNonStatemented")+I[14]("PostPrimary.value.SENNonStatemented")).toLocaleString()+"</span> pupils</p><p>Statemented <span class='text-big'>"+(I[14]("SEN.value.SENStatement")+I[14]("Primary.value.SENStatement")+I[14]("PostPrimary.value.SENStatement")).toLocaleString()+"</span> pupils</p>",show:["ni","lgd","dea"]},box_4:{id:"qualifications",content:"GroupChart",year:I[16]("highest_level_of_qualifications"),chart_data:I[9]("highest_level_of_qualifications")},box_5a:{id:"attainment",year:$t("Attainment",I[0].place),content:"<p>Pupils who left school with 5 or more GCSEs (or equivalents) grades A*-C</p><p> <span class='text-big'>"+I[14]("Attainment.value").toLocaleString()+"%</span> <p>including GCSE English and maths</p>",show:["ni"]},box_5b:{id:"attainment",year:$t("Attainment",I[0].place),content:"Pupils who left school with 5 or more GCSEs (or equivalents) grades A*-C:<br><span class='text-big'>"+I[14]("Attainment.value").toLocaleString()+"%</span> <span style='color: #1460aa'>(NI "+I[0].ni.data.Attainment.value.toLocaleString(void 0,{minimumFractionDigits:1})+"%) </span><br>including GCSE English and maths"+I[15]("Attainment.value").toLocaleString(),show:["lgd"]},box_6:{id:"destination",year:$t("Destination",I[0].place),content:"GroupChart",chart_data:I[9]("Destination"),show:["ni","lgd","dea"]},box_6a:{id:"empty",i_button:!1,content:"",show:["sdz","dz"]},box_6b:{id:"empty",i_button:!1,content:"",show:["sdz","dz"]}}),Qi.$set(De);const st={};V[0]&1&&(st.place=I[0].place),V[0]&1&&(st.sub_heading=I[17]("Crime and Court Activity",I[0].place)),V[0]&64&&(st.chart_compare_type=I[6]),Oi.$set(st);const tt={};V[0]&1&&(tt.place=I[0].place),V[0]&1&&(tt.sub_heading=I[17]("Travel and transport",I[0].place)),V[0]&64&&(tt.chart_compare_type=I[6]),$i.$set(tt);const Se={};V[0]&1&&(Se.place=I[0].place),V[0]&1&&(Se.sub_heading=I[17]("Economy",I[0].place)),V[0]&64&&(Se.chart_compare_type=I[6]),Ni.$set(Se);const He={};V[0]&1&&(He.place=I[0].place),V[0]&1&&(He.sub_heading=I[17]("Environment",I[0].place)),V[0]&64&&(He.chart_compare_type=I[6]),Ui.$set(He)},i(I){Vi||(ot(Fe.$$.fragment,I),ot(Mt.$$.fragment,I),ot(at.$$.fragment,I),ot(Zr.$$.fragment,I),ot(Rr.$$.fragment,I),ot(Nt.$$.fragment,I),ot(gi.$$.fragment,I),ot(Vr.$$.fragment,I),ot(Kr.$$.fragment,I),ot(Qi.$$.fragment,I),ot(Oi.$$.fragment,I),ot($i.$$.fragment,I),ot(Ni.$$.fragment,I),ot(Ui.$$.fragment,I),Vi=!0)},o(I){ft(Fe.$$.fragment,I),ft(Mt.$$.fragment,I),ft(at.$$.fragment,I),ft(Zr.$$.fragment,I),ft(Rr.$$.fragment,I),ft(Nt.$$.fragment,I),ft(gi.$$.fragment,I),ft(Vr.$$.fragment,I),ft(Kr.$$.fragment,I),ft(Qi.$$.fragment,I),ft(Oi.$$.fragment,I),ft($i.$$.fragment,I),ft(Ni.$$.fragment,I),ft(Ui.$$.fragment,I),Vi=!1},d(I){I&&ne(h),Qr&&Qr.d(),pr(Fe),I&&ne(qt),pr(Mt,I),I&&ne(xt),I&&ne(Ae),pr(at),pr(Zr),pr(Rr),I&&ne(ar),I&&ne(Sr),$r.d(),pr(Nt),Br&&Br.d(),U.d(),Tn(),I&&ne(ni),I&&ne(vr),pr(gi),pr(Vr),pr(Kr),pr(Qi),pr(Oi),pr($i),pr(Ni),pr(Ui)}}}function Qm(l){let h,d=[...l[0].place.parents].reverse(),p=[];for(let y=0;y<d.length;y+=1)p[y]=$m(Ym(l,d,y));return{c(){for(let y=0;y<p.length;y+=1)p[y].c();h=ir()},l(y){for(let v=0;v<p.length;v+=1)p[v].l(y);h=ir()},m(y,v){for(let a=0;a<p.length;a+=1)p[a]&&p[a].m(y,v);Le(y,h,v)},p(y,v){if(v[0]&1){d=[...y[0].place.parents].reverse();let a;for(a=0;a<d.length;a+=1){const k=Ym(y,d,a);p[a]?p[a].p(k,v):(p[a]=$m(k),p[a].c(),p[a].m(h.parentNode,h))}for(;a<p.length;a+=1)p[a].d(1);p.length=d.length}},d(y){nn(p,y),y&&ne(h)}}}function $m(l){let h,d=l[32].name+"",p,y,v,a=" &gt; ",k;return{c(){h=Ue("a"),p=Tt(d),v=new Bl(!1),k=ir(),this.h()},l(T){h=Ve(T,"A",{href:!0,"data-sveltekit-noscroll":!0,"data-sveltekit-keepfocus":!0,class:!0});var F=Be(h);p=It(F,d),F.forEach(ne),v=Fl(T,!1),k=ir(),this.h()},h(){ie(h,"href",y=kn+"/"+l[32].code+"/"),ie(h,"data-sveltekit-noscroll",""),ie(h,"data-sveltekit-keepfocus",""),ie(h,"class","svelte-hmrro5"),v.a=k},m(T,F){Le(T,h,F),xe(h,p),v.m(a,T,F),Le(T,k,F)},p(T,F){F[0]&1&&d!==(d=T[32].name+"")&&wr(p,d),F[0]&1&&y!==(y=kn+"/"+T[32].code+"/")&&ie(h,"href",y)},d(T){T&&ne(h),T&&ne(k),T&&v.d()}}}function U1(l){let h,d;return{c(){h=Ue("p"),d=Tt("Zoom and click on map to explore other areas"),this.h()},l(p){h=Ve(p,"P",{class:!0});var y=Be(h);d=It(y,"Zoom and click on map to explore other areas"),y.forEach(ne),this.h()},h(){ie(h,"class","text-bold")},m(p,y){Le(p,h,y),xe(h,d)},p:ei,d(p){p&&ne(h)}}}function V1(l){let h,d,p=l[0].place.name+"",y,v,a=En[l[0].place.type].name+"",k,T,F,M,N,R,X;return{c(){h=Tt("You are currently viewing "),d=Ue("span"),y=Tt(p),v=yt(),k=Tt(a),T=yt(),F=Ue("span"),M=yt(),N=Ue("p"),R=Ue("span"),X=Tt("Zoom and click on map to explore other areas"),this.h()},l(Q){h=It(Q,"You are currently viewing "),d=Ve(Q,"SPAN",{style:!0});var ae=Be(d);y=It(ae,p),ae.forEach(ne),v=gt(Q),k=It(Q,a),T=gt(Q),F=Ve(Q,"SPAN",{style:!0});var le=Be(F);le.forEach(ne),M=gt(Q),N=Ve(Q,"P",{});var de=Be(N);R=Ve(de,"SPAN",{class:!0});var ge=Be(R);X=It(ge,"Zoom and click on map to explore other areas"),ge.forEach(ne),de.forEach(ne),this.h()},h(){We(d,"color","#3878c5"),We(F,"color","#00205b"),ie(R,"class","text-bold")},m(Q,ae){Le(Q,h,ae),Le(Q,d,ae),xe(d,y),Le(Q,v,ae),Le(Q,k,ae),Le(Q,T,ae),Le(Q,F,ae),Le(Q,M,ae),Le(Q,N,ae),xe(N,R),xe(R,X)},p(Q,ae){ae[0]&1&&p!==(p=Q[0].place.name+"")&&wr(y,p),ae[0]&1&&a!==(a=En[Q[0].place.type].name+"")&&wr(k,a)},d(Q){Q&&ne(h),Q&&ne(d),Q&&ne(v),Q&&ne(k),Q&&ne(T),Q&&ne(F),Q&&ne(M),Q&&ne(N)}}}function q1(l){let h,d,p,y,v,a,k;const T=[rs[l[34]],{id:l[34]+"-fill"},{type:"fill"},{isChild:l[5][l[34]]},{click:!0},{selected:l[4].selected},{highlight:!0},{highlighted:l[4].highlighted},{hover:!0},{hovered:l[4].hovered},{layout:{visibility:l[4].type==l[34]||l[4].childType==l[34]?"visible":"none"}},{paint:l[4].type==l[34]?Yi["fill-self"]:l[4].childType==l[34]?Yi["fill-child"]:Yi.fill}];let F={};for(let Q=0;Q<T.length;Q+=1)F=yh(F,T[Q]);h=new Sp({props:F}),h.$on("select",l[10]);const M=[rs[l[34]],{id:l[34]+"-bounds"},{type:"line"},{selected:l[4].selected},{highlight:!0},{highlighted:l[4].highlighted},{layout:{visibility:l[4].type==l[34]||l[4].childType==l[34]?"visible":"none"}},{paint:l[4].type==l[34]?Yi["line-active"]:l[4].childType==l[34]?Yi["line-child"]:Yi.line}];let N={};for(let Q=0;Q<M.length;Q+=1)N=yh(N,M[Q]);p=new Sp({props:N});const R=[rs[l[34]],{id:l[34]+"-self"},{type:"line"},{selected:l[4].selected},{layout:{visibility:l[4].type==l[34]?"visible":"none"}},{paint:l[4].type==l[34]?Yi["line-self"]:Yi.line}];let X={};for(let Q=0;Q<R.length;Q+=1)X=yh(X,R[Q]);return v=new Sp({props:X}),{c(){ur(h.$$.fragment),d=yt(),ur(p.$$.fragment),y=yt(),ur(v.$$.fragment),a=yt()},l(Q){cr(h.$$.fragment,Q),d=gt(Q),cr(p.$$.fragment,Q),y=gt(Q),cr(v.$$.fragment,Q),a=gt(Q)},m(Q,ae){hr(h,Q,ae),Le(Q,d,ae),hr(p,Q,ae),Le(Q,y,ae),hr(v,Q,ae),Le(Q,a,ae),k=!0},p(Q,ae){const le=ae[0]&48?gh(T,[ae&0&&_h(rs[Q[34]]),T[1],T[2],ae[0]&32&&{isChild:Q[5][Q[34]]},T[4],ae[0]&16&&{selected:Q[4].selected},T[6],ae[0]&16&&{highlighted:Q[4].highlighted},T[8],ae[0]&16&&{hovered:Q[4].hovered},ae[0]&16&&{layout:{visibility:Q[4].type==Q[34]||Q[4].childType==Q[34]?"visible":"none"}},ae[0]&16&&{paint:Q[4].type==Q[34]?Yi["fill-self"]:Q[4].childType==Q[34]?Yi["fill-child"]:Yi.fill}]):{};h.$set(le);const de=ae[0]&16?gh(M,[ae&0&&_h(rs[Q[34]]),M[1],M[2],ae[0]&16&&{selected:Q[4].selected},M[4],ae[0]&16&&{highlighted:Q[4].highlighted},ae[0]&16&&{layout:{visibility:Q[4].type==Q[34]||Q[4].childType==Q[34]?"visible":"none"}},ae[0]&16&&{paint:Q[4].type==Q[34]?Yi["line-active"]:Q[4].childType==Q[34]?Yi["line-child"]:Yi.line}]):{};p.$set(de);const ge=ae[0]&16?gh(R,[ae&0&&_h(rs[Q[34]]),R[1],R[2],ae[0]&16&&{selected:Q[4].selected},ae[0]&16&&{layout:{visibility:Q[4].type==Q[34]?"visible":"none"}},ae[0]&16&&{paint:Q[4].type==Q[34]?Yi["line-self"]:Yi.line}]):{};v.$set(ge)},i(Q){k||(ot(h.$$.fragment,Q),ot(p.$$.fragment,Q),ot(v.$$.fragment,Q),k=!0)},o(Q){ft(h.$$.fragment,Q),ft(p.$$.fragment,Q),ft(v.$$.fragment,Q),k=!1},d(Q){pr(h,Q),Q&&ne(d),pr(p,Q),Q&&ne(y),pr(v,Q),Q&&ne(a)}}}function ey(l){let h,d;const p=[vd[l[34]]];let y={$$slots:{default:[q1]},$$scope:{ctx:l}};for(let v=0;v<p.length;v+=1)y=yh(y,p[v]);return h=new ev({props:y}),{c(){ur(h.$$.fragment)},l(v){cr(h.$$.fragment,v)},m(v,a){hr(h,v,a),d=!0},p(v,a){const k=a&0?gh(p,[_h(vd[v[34]])]):{};a[0]&48|a[1]&128&&(k.$$scope={dirty:a,ctx:v}),h.$set(k)},i(v){d||(ot(h.$$.fragment,v),d=!0)},o(v){ft(h.$$.fragment,v),d=!1},d(v){pr(h,v)}}}function j1(l){let h,d,p=["dz","sdz","dea","lgd"],y=[];for(let a=0;a<4;a+=1)y[a]=ey(Wm(l,p,a));const v=a=>ft(y[a],1,1,()=>{y[a]=null});return{c(){for(let a=0;a<4;a+=1)y[a].c();h=ir()},l(a){for(let k=0;k<4;k+=1)y[k].l(a);h=ir()},m(a,k){for(let T=0;T<4;T+=1)y[T]&&y[T].m(a,k);Le(a,h,k),d=!0},p(a,k){if(k[0]&1072){p=["dz","sdz","dea","lgd"];let T;for(T=0;T<4;T+=1){const F=Wm(a,p,T);y[T]?(y[T].p(F,k),ot(y[T],1)):(y[T]=ey(F),y[T].c(),ot(y[T],1),y[T].m(h.parentNode,h))}for(Ln(),T=4;T<4;T+=1)v(T);Rn()}},i(a){if(!d){for(let k=0;k<4;k+=1)ot(y[k]);d=!0}},o(a){y=y.filter(Boolean);for(let k=0;k<4;k+=1)ft(y[k]);d=!1},d(a){nn(y,a),a&&ne(h)}}}function ty(l){let h,d,p=l[0].place.name+"",y,v,a,k=[...l[0].place.parents].reverse(),T=[];for(let F=0;F<k.length;F+=1)T[F]=ry(Xm(l,k,F));return{c(){h=Ue("span"),d=Tt("Select a larger area containing "),y=Tt(p),v=yt(),a=Ue("span");for(let F=0;F<T.length;F+=1)T[F].c();this.h()},l(F){h=Ve(F,"SPAN",{class:!0});var M=Be(h);d=It(M,"Select a larger area containing "),y=It(M,p),M.forEach(ne),v=gt(F),a=Ve(F,"SPAN",{class:!0});var N=Be(a);for(let R=0;R<T.length;R+=1)T[R].l(N);N.forEach(ne),this.h()},h(){ie(h,"class","text-bold"),ie(a,"class","text-small")},m(F,M){Le(F,h,M),xe(h,d),xe(h,y),Le(F,v,M),Le(F,a,M);for(let N=0;N<T.length;N+=1)T[N]&&T[N].m(a,null)},p(F,M){if(M[0]&1&&p!==(p=F[0].place.name+"")&&wr(y,p),M[0]&1){k=[...F[0].place.parents].reverse();let N;for(N=0;N<k.length;N+=1){const R=Xm(F,k,N);T[N]?T[N].p(R,M):(T[N]=ry(R),T[N].c(),T[N].m(a,null))}for(;N<T.length;N+=1)T[N].d(1);T.length=k.length}},d(F){F&&ne(h),F&&ne(v),F&&ne(a),nn(T,F)}}}function ry(l){let h,d,p=l[31]>0?"↳ ":"",y,v=l[32].name+"",a,k;return{c(){h=Ue("span"),d=new Bl(!1),y=Ue("a"),a=Tt(v),this.h()},l(T){h=Ve(T,"SPAN",{style:!0});var F=Be(h);d=Fl(F,!1),y=Ve(F,"A",{href:!0,"data-sveltekit-noscroll":!0,"data-sveltekit-keepfocus":!0,class:!0});var M=Be(y);a=It(M,v),M.forEach(ne),F.forEach(ne),this.h()},h(){d.a=y,ie(y,"href",k=kn+"/"+l[32].code),ie(y,"data-sveltekit-noscroll",""),ie(y,"data-sveltekit-keepfocus",""),ie(y,"class","svelte-hmrro5"),We(h,"display","block"),We(h,"margin-left",(l[31]>0?(l[31]-1)*15:0)+"px")},m(T,F){Le(T,h,F),d.m(p,h),xe(h,y),xe(y,a)},p(T,F){F[0]&1&&v!==(v=T[32].name+"")&&wr(a,v),F[0]&1&&k!==(k=kn+"/"+T[32].code)&&ie(y,"href",k)},d(T){T&&ne(h)}}}function G1(l){let h,d,p=l[0].place.name+"",y,v,a=En[l[0].place.type].name+"",k;return{c(){h=Ue("span"),d=Tt("No areas below "),y=Tt(p),v=yt(),k=Tt(a),this.h()},l(T){h=Ve(T,"SPAN",{class:!0});var F=Be(h);d=It(F,"No areas below "),y=It(F,p),v=gt(F),k=It(F,a),F.forEach(ne),this.h()},h(){ie(h,"class","muted")},m(T,F){Le(T,h,F),xe(h,d),xe(h,y),xe(h,v),xe(h,k)},p(T,F){F[0]&1&&p!==(p=T[0].place.name+"")&&wr(y,p),F[0]&1&&a!==(a=En[T[0].place.type].name+"")&&wr(k,a)},d(T){T&&ne(h)}}}function Z1(l){let h,d,p=(l[0].place.children[0]?En[l[0].place.children[0].type].name:"Areas")+"",y,v,a=l[0].place.name+"",k,T,F,M,N=l[0].place.children,R=[];for(let X=0;X<N.length;X+=1)R[X]=iy(Hm(l,N,X));return{c(){h=Ue("span"),d=Tt("Select a "),y=Tt(p),v=Tt(" within "),k=Tt(a),T=Ue("br"),F=yt(),M=Ue("span");for(let X=0;X<R.length;X+=1)R[X].c();this.h()},l(X){h=Ve(X,"SPAN",{class:!0});var Q=Be(h);d=It(Q,"Select a "),y=It(Q,p),v=It(Q," within "),k=It(Q,a),Q.forEach(ne),T=Ve(X,"BR",{}),F=gt(X),M=Ve(X,"SPAN",{class:!0});var ae=Be(M);for(let le=0;le<R.length;le+=1)R[le].l(ae);ae.forEach(ne),this.h()},h(){ie(h,"class","text-bold"),ie(M,"class","text-small")},m(X,Q){Le(X,h,Q),xe(h,d),xe(h,y),xe(h,v),xe(h,k),Le(X,T,Q),Le(X,F,Q),Le(X,M,Q);for(let ae=0;ae<R.length;ae+=1)R[ae]&&R[ae].m(M,null)},p(X,Q){if(Q[0]&1&&p!==(p=(X[0].place.children[0]?En[X[0].place.children[0].type].name:"Areas")+"")&&wr(y,p),Q[0]&1&&a!==(a=X[0].place.name+"")&&wr(k,a),Q[0]&1){N=X[0].place.children;let ae;for(ae=0;ae<N.length;ae+=1){const le=Hm(X,N,ae);R[ae]?R[ae].p(le,Q):(R[ae]=iy(le),R[ae].c(),R[ae].m(M,null))}for(;ae<R.length;ae+=1)R[ae].d(1);R.length=N.length}},d(X){X&&ne(h),X&&ne(T),X&&ne(F),X&&ne(M),nn(R,X)}}}function iy(l){let h,d=l[29].name+"",p,y,v=l[31]<l[0].place.children.length-1?", ":"",a;return{c(){h=Ue("a"),p=Tt(d),a=Tt(v),this.h()},l(k){h=Ve(k,"A",{href:!0,"data-sveltekit-noscroll":!0,"data-sveltekit-keepfocus":!0,class:!0});var T=Be(h);p=It(T,d),T.forEach(ne),a=It(k,v),this.h()},h(){ie(h,"href",y=kn+"/"+l[29].code),ie(h,"data-sveltekit-noscroll",""),ie(h,"data-sveltekit-keepfocus",""),ie(h,"class","svelte-hmrro5")},m(k,T){Le(k,h,T),xe(h,p),Le(k,a,T)},p(k,T){T[0]&1&&d!==(d=k[29].name+"")&&wr(p,d),T[0]&1&&y!==(y=kn+"/"+k[29].code)&&ie(h,"href",y),T[0]&1&&v!==(v=k[31]<k[0].place.children.length-1?", ":"")&&wr(a,v)},d(k){k&&ne(h),k&&ne(a)}}}function K1(l){let h,d,p=l[0].place&&l[0].ni&&Jm(l);return{c(){p&&p.c(),h=ir()},l(y){p&&p.l(y),h=ir()},m(y,v){p&&p.m(y,v),Le(y,h,v),d=!0},p(y,v){y[0].place&&y[0].ni?p?(p.p(y,v),v[0]&1&&ot(p,1)):(p=Jm(y),p.c(),ot(p,1),p.m(h.parentNode,h)):p&&(Ln(),ft(p,1,1,()=>{p=null}),Rn())},i(y){d||(ot(p),d=!0)},o(y){ft(p),d=!1},d(y){p&&p.d(y),y&&ne(h)}}}function H1(l){let h,d,p,y,v,a,k,T,F,M,N,R,X,Q,ae,le;return document.title=h=l[0].place.name+" Local Statistics Explorer",X=new l1({}),ae=new y_({props:{column:"wide",$$slots:{default:[K1]},$$scope:{ctx:l}}}),{c(){d=Ue("meta"),p=Ue("meta"),v=Ue("meta"),a=Ue("meta"),T=Ue("meta"),M=Ue("meta"),R=yt(),ur(X.$$.fragment),Q=yt(),ur(ae.$$.fragment),this.h()},l(de){const ge=p_("svelte-ovl3z1",document.head);d=Ve(ge,"META",{name:!0,content:!0}),p=Ve(ge,"META",{property:!0,content:!0}),v=Ve(ge,"META",{property:!0,content:!0}),a=Ve(ge,"META",{property:!0,content:!0}),T=Ve(ge,"META",{property:!0,content:!0}),M=Ve(ge,"META",{name:!0,content:!0}),ge.forEach(ne),R=gt(de),cr(X.$$.fragment,de),Q=gt(de),cr(ae.$$.fragment,de),this.h()},h(){ie(d,"name","description"),ie(d,"content",""),ie(p,"property","og:title"),ie(p,"content",y=l[0].place.name+" Local Statistics"),ie(v,"property","og:type"),ie(v,"content","website"),ie(a,"property","og:url"),ie(a,"content",k=wh.base+"/"+l[0].place.code+"/"),ie(T,"property","og:description"),ie(T,"content",F="Explore NISRA Statistics for "+l[0].place.name+"."),ie(M,"name","description"),ie(M,"content",N="Explore NISRA Statistics for "+l[0].place.name+".")},m(de,ge){xe(document.head,d),xe(document.head,p),xe(document.head,v),xe(document.head,a),xe(document.head,T),xe(document.head,M),Le(de,R,ge),hr(X,de,ge),Le(de,Q,ge),hr(ae,de,ge),le=!0},p(de,ge){(!le||ge[0]&1)&&h!==(h=de[0].place.name+" Local Statistics Explorer")&&(document.title=h),(!le||ge[0]&1&&y!==(y=de[0].place.name+" Local Statistics"))&&ie(p,"content",y),(!le||ge[0]&1&&k!==(k=wh.base+"/"+de[0].place.code+"/"))&&ie(a,"content",k),(!le||ge[0]&1&&F!==(F="Explore NISRA Statistics for "+de[0].place.name+"."))&&ie(T,"content",F),(!le||ge[0]&1&&N!==(N="Explore NISRA Statistics for "+de[0].place.name+"."))&&ie(M,"content",N);const rt={};ge[0]&255|ge[1]&128&&(rt.$$scope={dirty:ge,ctx:de}),ae.$set(rt)},i(de){le||(ot(X.$$.fragment,de),ot(ae.$$.fragment,de),le=!0)},o(de){ft(X.$$.fragment,de),ft(ae.$$.fragment,de),le=!1},d(de){ne(d),ne(p),ne(v),ne(a),ne(T),ne(M),de&&ne(R),pr(X,de),de&&ne(Q),pr(ae,de)}}}function mh(l){let h=(l*100).toFixed(1);return h<.1?"<0.1%":h+"%"}function $t(l,h){return h.meta_data.hasOwnProperty(l)?h.meta_data[l][0].year:null}function ny(l){let h=l.data.MYETotal.value/(l.hectares/100);return h<10?h="<10":h=(Math.round(h*10)/10).toLocaleString(void 0,{minimumFractionDigits:1}),h}function X1(l,h,d){let p,y,v,{data:a}=h,k,T,F=null,M={selected:null,type:null,childType:null,highlighted:[],hovered:null},N={};Object.keys(rs).forEach(qe=>d(5,N[qe]=!1,N));function R(qe,Bt,Re){const et=(ar,Sr)=>ar+Sr;let dt=qe[0],qt=Re[0],Mt=Bt[0],xt="perc",Ae=a.place.data[dt][xt][qt],at=a.place.data[dt][xt][Mt],Mr=a.ni.data[dt][xt][qt],Zr=Ml[dt].map(ar=>ar.category),wi=Ml[dt].map(ar=>ar.label?ar.label:ar.category);return Zr.map((ar,Sr)=>Array.isArray(ar)?{x:wi[Sr],y:ar.map(Gt=>Ae[Gt]).reduce(et,0),ni:ar.map(Gt=>Mr[Gt]).reduce(et,0),prev:ar.map(Gt=>at[Gt]).reduce(et,0)}:{x:wi[Sr],y:Ae[ar],ni:Mr[ar],prev:at[ar]})}function X(qe){let Bt=[];if(a.place.data.hasOwnProperty(qe)){let Re=a.place.data[qe].perc,et,dt;Re.hasOwnProperty("2021")?(et=Re[2021],dt=a.ni.data[qe].perc[2021]):(et=Re,dt=a.ni.data[qe].perc);let qt,Mt,xt=Object.keys(Ml[qe]);for(let Ae=0;Ae<xt.length;Ae++){for(let at=0;at<Object.keys(et).length;at++)if(Ml[qe][xt[Ae]].category==Object.keys(et)[at]){qt=Ml[qe][xt[Ae]].category,Mt=Ml[qe][xt[Ae]].label;break}et[qt]<=100&&(Bt.push({group:"Northern Ireland",category:Mt,perc:dt[qt],width:0}),a.place.name!="Northern Ireland"&&Bt.push({group:a.place.name,category:Mt,perc:et[qt],width:0}))}}return Bt}function Q(qe){F&&F.fitBounds(qe,{padding:20})}function ae(qe){let Bt=JSON.parse(JSON.stringify(M)),Re=a.place.code,et=a.place.type,dt=a.place.children[0]?a.place.children.map(at=>at.code):[],qt=a.place.type=="rgn"?"cty":dt[0]?a.place.children[0].type:null;d(4,M.selected=Re,M),d(4,M.type=et,M),d(4,M.childType=qt,M),d(4,M.highlighted=dt,M);let Mt=Object.keys(rs),xt=["fill-color","fill-opacity"],Ae=["line-color","line-width","line-opacity"];F&&(M.type!=Bt.type||M.childType!=Bt.childType)&&(Mt.forEach(at=>{let Mr=at==et||qt&&at==qt?"visible":"none";F.setLayoutProperty(at+"-fill","visibility",Mr),F.setLayoutProperty(at+"-bounds","visibility",Mr),a.place.type!="ni"&&F.setLayoutProperty(at+"-self","visibility",Mr),d(5,N[at]=at==qt,N)}),a.place.type!="ni"&&(xt.forEach(at=>F.setPaintProperty(et+"-fill",at,Yi[dt[0]?"fill-active":"fill-self"][at])),Ae.forEach(at=>{F.setPaintProperty(et+"-bounds",at,Yi["line-active"][at]),F.setPaintProperty(et+"-self",at,Yi["line-self"][at])})),qt&&(xt.forEach(at=>F.setPaintProperty(qt+"-fill",at,Yi["fill-child"][at])),Ae.forEach(at=>F.setPaintProperty(qt+"-bounds",at,Yi["line-child"][at]))))}function le(qe){ae(),Q(a.place.bounds)}function de(qe){_d(`${kn}/${qe.detail.code}/`,{noScroll:!0,keepFocus:!0})}function ge(qe){_d(`${kn}/${qe.detail.value}/`,{noScroll:!0,keepFocus:!0})}function rt(){d(2,T=k<575?1:window.getComputedStyle(grid).getPropertyValue("grid-template-columns").split(" ").length)}function Fe(qe){return qe==1?"largest":qe==a.place.count?"smallest":qe+a_(qe)+" largest"}function ze(qe){let Bt="";if(qe.data.hasOwnProperty("PopChange")){let Re=qe.data.PopChange.value,et=Object.keys(Re).slice(-1),dt=et-10,qt=(Re[et]-Re[dt])/Re[dt]*100,Mt;qt<0?Mt="Down":qt>0&&(Mt="Up"),Bt="<p>The population of "+qe.name+" in "+dt+' was <span class="text-big">'+Re[dt].toLocaleString()+"</span> and in "+et+' was <span class="text-big">'+Re[et].toLocaleString()+'</span><p><span class="em '+o_(qt)+'">'+Mt+" "+s_(qt,"%",1)+"</span> since "+dt+" Mid-Year Population Estimate</p>"}return Bt}function Ge(qe){let Re=qe.replaceAll("[",".").replaceAll("]","").split("."),et=a.place.data;for(let dt=0;dt<Re.length;dt++)et.hasOwnProperty(Re[dt])?et=et[Re[dt]]:et=[];return et}function zt(qe){let Re=qe.replaceAll("[",".").replaceAll("]","").split("."),et=a.ni.data,dt=Ge(qe);Re[0]=="grouped_data_nocompare"|Re[0]=="grouped_data_areacompare"&&(et=a.ni);for(let qt=0;qt<Re.length;qt++)et.hasOwnProperty(Re[qt])?et=et[Re[qt]]:et=[];return dt>et+2?et="<p>This is higher than the NI value</p>":dt<et-2?et="<p>This is lower than the NI value</p>":et="<p>This is similar to the NI value</p>",et}function wt(qe){return a.place.data.hasOwnProperty(qe)?"Census "+Object.keys(a.place.data[qe].perc).slice(-1):null}function je(qe,Bt){return Bt.type!="ni"?"You can also explore "+qe+" data for <a href = '"+kn+"/"+Bt.parents[0].code+"/' data-sveltekit-noscroll data-sveltekit-keepfocus>"+Bt.parents[0].name+" </a>":""}function Ze(qe){let Bt=qe.data.MYETotal.value/(qe.hectares/100),Re=a.ni.data.MYETotal.value/(a.ni.hectares/100),et=Bt/Re;return Math.round(et)==1?et='Approximately <span class = "em" style = "background-color: lightgrey">the same density level</span> as the Northern Ireland average':et>1?et='Approximately <span class = "em" style = "background-color: lightgrey">'+et.toFixed(0)+" times more dense</span> than the Northern Ireland average":et='Approximately <span class = "em" style = "background-color: lightgrey">1/'+(1/et).toFixed(0)+" as dense</span> as the Northern Ireland average",et}function mt(qe){F=qe,d(3,F)}function nr(){k=this.clientWidth,d(1,k)}return l.$$set=qe=>{"data"in qe&&d(0,a=qe.data)},l.$$.update=()=>{l.$$.dirty[0]&2&&k&&rt(),l.$$.dirty[0]&1&&d(7,p=a.place&&a.place.type!="ni"?"NI 2021":null),l.$$.dirty[0]&524289&&d(6,y=v?null:a.place.type!="ni"?"ni":null),l.$$.dirty[0]&1&&a.place&&le(a.place)},d(19,v=!1),[a,k,T,F,M,N,y,p,R,X,de,ge,Fe,ze,Ge,zt,wt,je,Ze,v,mt,nr]}class ib extends an{constructor(h){super(),on(this,h,X1,H1,sn,{data:0},null,[-1,-1])}}export{ib as component,rb as universal};
