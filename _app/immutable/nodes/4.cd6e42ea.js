import{g as $_,c as gd,a as vd,s as eg,S as tg,b as Pa,d as Ca}from"../chunks/navigation.13e84d92.js";import{g as Ua,a as Sh,m as as,b as Ip,c as rg,d as Yi,e as bd}from"../chunks/config.c24437b0.js";import{S as mn,i as yn,s as _n,k as Ne,l as Ue,m as Be,h as oe,n as ne,R as qu,b as Le,T as Zu,g as it,v as ta,d as lt,f as ra,P as $m,o as ey,K as Ru,M as Bu,N as Ou,O as Fu,w as Nu,e as br,E as Gu,U as ig,Q as Xt,V as Tr,p as Ke,W as Wn,X as Hn,C as Ee,D as vi,Y as on,Z as Xn,q as St,r as Et,u as Er,y as ir,z as nr,A as ar,B as or,a as ft,c as dt,_ as Ph,G as ha,I as Ku,$ as Xu,a0 as Wu,F as xd,L as ng,a1 as ag,a2 as og,a3 as _h,a4 as gh,a5 as vh}from"../chunks/index.baf6a862.js";import{b as Ma}from"../chunks/paths.d886ab7f.js";import{S as sg}from"../chunks/Section.6106804d.js";/* empty css                                                              */import{w as Ir,h as Ci}from"../chunks/singletons.17e85dbd.js";async function wd(h,c){return await(await c(Sh.app_json_data+h+".json")).json()}async function lg({params:h,fetch:c}){let d=h.code,f=await $_(Sh.search_data,c),_={};f.forEach(T=>_[T.code]=T.name),f.forEach(T=>{T.typepl=Ua[T.type].pl,T.typenm=Ua[T.type].name,T.typestr=_[T.parent]&&T.parent==T.code?`${Ua[T.type].name} is within  ${_[T.parent]}
        ${Ua[T.parent_type].name}  `:_[T.parent]&&T.parent!=T.code?`${Ua[T.type].name} `:""});let v=f.sort((T,M)=>T.name.localeCompare(M.name)),a=await wd("N92000002",c),I=await wd(d,c);return{search_data:v,place:I,ni:a}}const tb=Object.freeze(Object.defineProperty({__proto__:null,load:lg},Symbol.toStringTag,{value:"Module"}));var ug=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function cg(h){return h&&h.__esModule&&Object.prototype.hasOwnProperty.call(h,"default")?h.default:h}var hg={rgb2hsl:Hu,rgb2hsv:Ch,rgb2hwb:Ju,rgb2cmyk:Yu,rgb2keyword:Qu,rgb2xyz:Vp,rgb2lab:jp,rgb2lch:pg,hsl2rgb:Mh,hsl2hsv:fg,hsl2hwb:dg,hsl2cmyk:mg,hsl2keyword:yg,hsv2rgb:Dh,hsv2hsl:_g,hsv2hwb:gg,hsv2cmyk:vg,hsv2keyword:bg,hwb2rgb:$u,hwb2hsl:xg,hwb2hsv:wg,hwb2cmyk:kg,hwb2keyword:Sg,cmyk2rgb:ec,cmyk2hsl:Eg,cmyk2hsv:Tg,cmyk2hwb:Ig,cmyk2keyword:zg,keyword2rgb:Fs,keyword2hsl:Mg,keyword2hsv:Dg,keyword2hwb:Lg,keyword2cmyk:Rg,keyword2lab:Bg,keyword2xyz:Og,xyz2rgb:ty,xyz2lab:ry,xyz2lch:Ag,lab2xyz:qp,lab2rgb:iy,lab2lch:Zp,lch2lab:Gp,lch2xyz:Pg,lch2rgb:Cg};function Hu(h){var c=h[0]/255,d=h[1]/255,f=h[2]/255,_=Math.min(c,d,f),v=Math.max(c,d,f),a=v-_,I,T,M;return v==_?I=0:c==v?I=(d-f)/a:d==v?I=2+(f-c)/a:f==v&&(I=4+(c-d)/a),I=Math.min(I*60,360),I<0&&(I+=360),M=(_+v)/2,v==_?T=0:M<=.5?T=a/(v+_):T=a/(2-v-_),[I,T*100,M*100]}function Ch(h){var c=h[0],d=h[1],f=h[2],_=Math.min(c,d,f),v=Math.max(c,d,f),a=v-_,I,T,M;return v==0?T=0:T=a/v*1e3/10,v==_?I=0:c==v?I=(d-f)/a:d==v?I=2+(f-c)/a:f==v&&(I=4+(c-d)/a),I=Math.min(I*60,360),I<0&&(I+=360),M=v/255*1e3/10,[I,T,M]}function Ju(h){var c=h[0],d=h[1],v=h[2],f=Hu(h)[0],_=1/255*Math.min(c,Math.min(d,v)),v=1-1/255*Math.max(c,Math.max(d,v));return[f,_*100,v*100]}function Yu(h){var c=h[0]/255,d=h[1]/255,f=h[2]/255,_,v,a,I;return I=Math.min(1-c,1-d,1-f),_=(1-c-I)/(1-I)||0,v=(1-d-I)/(1-I)||0,a=(1-f-I)/(1-I)||0,[_*100,v*100,a*100,I*100]}function Qu(h){return ny[JSON.stringify(h)]}function Vp(h){var c=h[0]/255,d=h[1]/255,f=h[2]/255;c=c>.04045?Math.pow((c+.055)/1.055,2.4):c/12.92,d=d>.04045?Math.pow((d+.055)/1.055,2.4):d/12.92,f=f>.04045?Math.pow((f+.055)/1.055,2.4):f/12.92;var _=c*.4124+d*.3576+f*.1805,v=c*.2126+d*.7152+f*.0722,a=c*.0193+d*.1192+f*.9505;return[_*100,v*100,a*100]}function jp(h){var c=Vp(h),d=c[0],f=c[1],_=c[2],v,a,I;return d/=95.047,f/=100,_/=108.883,d=d>.008856?Math.pow(d,1/3):7.787*d+16/116,f=f>.008856?Math.pow(f,1/3):7.787*f+16/116,_=_>.008856?Math.pow(_,1/3):7.787*_+16/116,v=116*f-16,a=500*(d-f),I=200*(f-_),[v,a,I]}function pg(h){return Zp(jp(h))}function Mh(h){var c=h[0]/360,d=h[1]/100,f=h[2]/100,_,v,a,I,T;if(d==0)return T=f*255,[T,T,T];f<.5?v=f*(1+d):v=f+d-f*d,_=2*f-v,I=[0,0,0];for(var M=0;M<3;M++)a=c+1/3*-(M-1),a<0&&a++,a>1&&a--,6*a<1?T=_+(v-_)*6*a:2*a<1?T=v:3*a<2?T=_+(v-_)*(2/3-a)*6:T=_,I[M]=T*255;return I}function fg(h){var c=h[0],d=h[1]/100,f=h[2]/100,_,v;return f===0?[0,0,0]:(f*=2,d*=f<=1?f:2-f,v=(f+d)/2,_=2*d/(f+d),[c,_*100,v*100])}function dg(h){return Ju(Mh(h))}function mg(h){return Yu(Mh(h))}function yg(h){return Qu(Mh(h))}function Dh(h){var c=h[0]/60,d=h[1]/100,T=h[2]/100,f=Math.floor(c)%6,_=c-Math.floor(c),v=255*T*(1-d),a=255*T*(1-d*_),I=255*T*(1-d*(1-_)),T=255*T;switch(f){case 0:return[T,I,v];case 1:return[a,T,v];case 2:return[v,T,I];case 3:return[v,a,T];case 4:return[I,v,T];case 5:return[T,v,a]}}function _g(h){var c=h[0],d=h[1]/100,f=h[2]/100,_,v;return v=(2-d)*f,_=d*f,_/=v<=1?v:2-v,_=_||0,v/=2,[c,_*100,v*100]}function gg(h){return Ju(Dh(h))}function vg(h){return Yu(Dh(h))}function bg(h){return Qu(Dh(h))}function $u(h){var c=h[0]/360,d=h[1]/100,f=h[2]/100,_=d+f,v,a,I,T;switch(_>1&&(d/=_,f/=_),v=Math.floor(6*c),a=1-f,I=6*c-v,v&1&&(I=1-I),T=d+I*(a-d),v){default:case 6:case 0:r=a,g=T,b=d;break;case 1:r=T,g=a,b=d;break;case 2:r=d,g=a,b=T;break;case 3:r=d,g=T,b=a;break;case 4:r=T,g=d,b=a;break;case 5:r=a,g=d,b=T;break}return[r*255,g*255,b*255]}function xg(h){return Hu($u(h))}function wg(h){return Ch($u(h))}function kg(h){return Yu($u(h))}function Sg(h){return Qu($u(h))}function ec(h){var c=h[0]/100,d=h[1]/100,f=h[2]/100,_=h[3]/100,v,a,I;return v=1-Math.min(1,c*(1-_)+_),a=1-Math.min(1,d*(1-_)+_),I=1-Math.min(1,f*(1-_)+_),[v*255,a*255,I*255]}function Eg(h){return Hu(ec(h))}function Tg(h){return Ch(ec(h))}function Ig(h){return Ju(ec(h))}function zg(h){return Qu(ec(h))}function ty(h){var c=h[0]/100,d=h[1]/100,f=h[2]/100,_,v,a;return _=c*3.2406+d*-1.5372+f*-.4986,v=c*-.9689+d*1.8758+f*.0415,a=c*.0557+d*-.204+f*1.057,_=_>.0031308?1.055*Math.pow(_,1/2.4)-.055:_=_*12.92,v=v>.0031308?1.055*Math.pow(v,1/2.4)-.055:v=v*12.92,a=a>.0031308?1.055*Math.pow(a,1/2.4)-.055:a=a*12.92,_=Math.min(Math.max(0,_),1),v=Math.min(Math.max(0,v),1),a=Math.min(Math.max(0,a),1),[_*255,v*255,a*255]}function ry(h){var c=h[0],d=h[1],f=h[2],_,v,a;return c/=95.047,d/=100,f/=108.883,c=c>.008856?Math.pow(c,1/3):7.787*c+16/116,d=d>.008856?Math.pow(d,1/3):7.787*d+16/116,f=f>.008856?Math.pow(f,1/3):7.787*f+16/116,_=116*d-16,v=500*(c-d),a=200*(d-f),[_,v,a]}function Ag(h){return Zp(ry(h))}function qp(h){var c=h[0],d=h[1],f=h[2],_,v,a,I;return c<=8?(v=c*100/903.3,I=7.787*(v/100)+16/116):(v=100*Math.pow((c+16)/116,3),I=Math.pow(v/100,1/3)),_=_/95.047<=.008856?_=95.047*(d/500+I-16/116)/7.787:95.047*Math.pow(d/500+I,3),a=a/108.883<=.008859?a=108.883*(I-f/200-16/116)/7.787:108.883*Math.pow(I-f/200,3),[_,v,a]}function Zp(h){var c=h[0],d=h[1],f=h[2],_,v,a;return _=Math.atan2(f,d),v=_*360/2/Math.PI,v<0&&(v+=360),a=Math.sqrt(d*d+f*f),[c,a,v]}function iy(h){return ty(qp(h))}function Gp(h){var c=h[0],d=h[1],f=h[2],_,v,a;return a=f/360*2*Math.PI,_=d*Math.cos(a),v=d*Math.sin(a),[c,_,v]}function Pg(h){return qp(Gp(h))}function Cg(h){return iy(Gp(h))}function Fs(h){return Lp[h]}function Mg(h){return Hu(Fs(h))}function Dg(h){return Ch(Fs(h))}function Lg(h){return Ju(Fs(h))}function Rg(h){return Yu(Fs(h))}function Bg(h){return jp(Fs(h))}function Og(h){return Vp(Fs(h))}var Lp={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,134,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,250,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,221],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[112,128,144],slategrey:[112,128,144],snow:[255,250,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,50]},ny={};for(var kd in Lp)ny[JSON.stringify(Lp[kd])]=kd;var zp=hg,Ll=function(){return new tc};for(var Du in zp){Ll[Du+"Raw"]=function(h){return function(c){return typeof c=="number"&&(c=Array.prototype.slice.call(arguments)),zp[h](c)}}(Du);var Sd=/(\w+)2(\w+)/.exec(Du),Ap=Sd[1],Fg=Sd[2];Ll[Ap]=Ll[Ap]||{},Ll[Ap][Fg]=Ll[Du]=function(h){return function(c){typeof c=="number"&&(c=Array.prototype.slice.call(arguments));var d=zp[h](c);if(typeof d=="string"||d===void 0)return d;for(var f=0;f<d.length;f++)d[f]=Math.round(d[f]);return d}}(Du)}var tc=function(){this.convs={}};tc.prototype.routeSpace=function(h,c){var d=c[0];return d===void 0?this.getValues(h):(typeof d=="number"&&(d=Array.prototype.slice.call(c)),this.setValues(h,d))};tc.prototype.setValues=function(h,c){return this.space=h,this.convs={},this.convs[h]=c,this};tc.prototype.getValues=function(h){var c=this.convs[h];if(!c){var d=this.space,f=this.convs[d];c=Ll[d][h](f),this.convs[h]=c}return c};["rgb","hsl","hsv","cmyk","keyword"].forEach(function(h){tc.prototype[h]=function(c){return this.routeSpace(h,arguments)}});var ay={exports:{}};(function(h,c){(function(d,f){h.exports=f()})(ug,function(){var d,f,_;function v(a,I){if(!d)d=I;else if(!f)f=I;else{var T="var sharedChunk = {}; ("+d+")(sharedChunk); ("+f+")(sharedChunk);",M={};d(M),_=I(M),typeof window<"u"&&(_.workerUrl=window.URL.createObjectURL(new Blob([T],{type:"text/javascript"})))}}return v(["exports"],function(a){function I(e,t){return e(t={exports:{}},t.exports),t.exports}var T=M;function M(e,t,i,l){this.cx=3*e,this.bx=3*(i-e)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*t,this.by=3*(l-t)-this.cy,this.ay=1-this.cy-this.by,this.p1x=e,this.p1y=l,this.p2x=i,this.p2y=l}M.prototype.sampleCurveX=function(e){return((this.ax*e+this.bx)*e+this.cx)*e},M.prototype.sampleCurveY=function(e){return((this.ay*e+this.by)*e+this.cy)*e},M.prototype.sampleCurveDerivativeX=function(e){return(3*this.ax*e+2*this.bx)*e+this.cx},M.prototype.solveCurveX=function(e,t){var i,l,p,m,x;for(t===void 0&&(t=1e-6),p=e,x=0;x<8;x++){if(m=this.sampleCurveX(p)-e,Math.abs(m)<t)return p;var S=this.sampleCurveDerivativeX(p);if(Math.abs(S)<1e-6)break;p-=m/S}if((p=e)<(i=0))return i;if(p>(l=1))return l;for(;i<l;){if(m=this.sampleCurveX(p),Math.abs(m-e)<t)return p;e>m?i=p:l=p,p=.5*(l-i)+i}return p},M.prototype.solve=function(e,t){return this.sampleCurveY(this.solveCurveX(e,t))};var F=R;function R(e,t){this.x=e,this.y=t}R.prototype={clone:function(){return new R(this.x,this.y)},add:function(e){return this.clone()._add(e)},sub:function(e){return this.clone()._sub(e)},multByPoint:function(e){return this.clone()._multByPoint(e)},divByPoint:function(e){return this.clone()._divByPoint(e)},mult:function(e){return this.clone()._mult(e)},div:function(e){return this.clone()._div(e)},rotate:function(e){return this.clone()._rotate(e)},rotateAround:function(e,t){return this.clone()._rotateAround(e,t)},matMult:function(e){return this.clone()._matMult(e)},unit:function(){return this.clone()._unit()},perp:function(){return this.clone()._perp()},round:function(){return this.clone()._round()},mag:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals:function(e){return this.x===e.x&&this.y===e.y},dist:function(e){return Math.sqrt(this.distSqr(e))},distSqr:function(e){var t=e.x-this.x,i=e.y-this.y;return t*t+i*i},angle:function(){return Math.atan2(this.y,this.x)},angleTo:function(e){return Math.atan2(this.y-e.y,this.x-e.x)},angleWith:function(e){return this.angleWithSep(e.x,e.y)},angleWithSep:function(e,t){return Math.atan2(this.x*t-this.y*e,this.x*e+this.y*t)},_matMult:function(e){var t=e[2]*this.x+e[3]*this.y;return this.x=e[0]*this.x+e[1]*this.y,this.y=t,this},_add:function(e){return this.x+=e.x,this.y+=e.y,this},_sub:function(e){return this.x-=e.x,this.y-=e.y,this},_mult:function(e){return this.x*=e,this.y*=e,this},_div:function(e){return this.x/=e,this.y/=e,this},_multByPoint:function(e){return this.x*=e.x,this.y*=e.y,this},_divByPoint:function(e){return this.x/=e.x,this.y/=e.y,this},_unit:function(){return this._div(this.mag()),this},_perp:function(){var e=this.y;return this.y=this.x,this.x=-e,this},_rotate:function(e){var t=Math.cos(e),i=Math.sin(e),l=i*this.x+t*this.y;return this.x=t*this.x-i*this.y,this.y=l,this},_rotateAround:function(e,t){var i=Math.cos(e),l=Math.sin(e),p=t.y+l*(this.x-t.x)+i*(this.y-t.y);return this.x=t.x+i*(this.x-t.x)-l*(this.y-t.y),this.y=p,this},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}},R.convert=function(e){return e instanceof R?e:Array.isArray(e)?new R(e[0],e[1]):e};var D=typeof self<"u"?self:{},H=Math.pow(2,53)-1;function ae(e,t,i,l){var p=new T(e,t,i,l);return function(m){return p.solve(m)}}var de=ae(.25,.1,.25,1);function fe(e,t,i){return Math.min(i,Math.max(t,e))}function we(e,t,i){var l=i-t,p=((e-t)%l+l)%l+t;return p===t?i:p}function xe(e){for(var t=[],i=arguments.length-1;i-- >0;)t[i]=arguments[i+1];for(var l=0,p=t;l<p.length;l+=1){var m=p[l];for(var x in m)e[x]=m[x]}return e}var Ve=1;function Oe(){return Ve++}function De(){return function e(t){return t?(t^16*Math.random()>>t/4).toString(16):([1e7]+-[1e3]+-4e3+-8e3+-1e11).replace(/[018]/g,e)}()}function He(e){return!!e&&/^[0-9a-f]{8}-[0-9a-f]{4}-[4][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i.test(e)}function Tt(e,t){e.forEach(function(i){t[i]&&(t[i]=t[i].bind(t))})}function Lt(e,t){return e.indexOf(t,e.length-t.length)!==-1}function qt(e,t,i){var l={};for(var p in e)l[p]=t.call(i||this,e[p],p,e);return l}function _t(e,t,i){var l={};for(var p in e)t.call(i||this,e[p],p,e)&&(l[p]=e[p]);return l}function ht(e){return Array.isArray(e)?e.map(ht):typeof e=="object"&&e?qt(e,ht):e}var Ft={};function yt(e){Ft[e]||(typeof console<"u"&&console.warn(e),Ft[e]=!0)}function It(e,t,i){return(i.y-e.y)*(t.x-e.x)>(t.y-e.y)*(i.x-e.x)}function tt(e){for(var t=0,i=0,l=e.length,p=l-1,m=void 0,x=void 0;i<l;p=i++)t+=((x=e[p]).x-(m=e[i]).x)*(m.y+x.y);return t}function Zt(){return typeof WorkerGlobalScope<"u"&&typeof self<"u"&&self instanceof WorkerGlobalScope}function pt(e){var t={};if(e.replace(/(?:^|(?:\s*\,\s*))([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)(?:\=(?:([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)|(?:\"((?:[^"\\]|\\.)*)\")))?/g,function(l,p,m,x){var S=m||x;return t[p]=!S||S.toLowerCase(),""}),t["max-age"]){var i=parseInt(t["max-age"],10);isNaN(i)?delete t["max-age"]:t["max-age"]=i}return t}var zt=null;function Ut(e){if(zt==null){var t=e.navigator?e.navigator.userAgent:null;zt=!!e.safari||!(!t||!(/\b(iPad|iPhone|iPod)\b/.test(t)||t.match("Safari")&&!t.match("Chrome")))}return zt}function ei(e){try{var t=D[e];return t.setItem("_mapbox_test_",1),t.removeItem("_mapbox_test_"),!0}catch{return!1}}var Je,At,pr,Fr,Mr=D.performance&&D.performance.now?D.performance.now.bind(D.performance):Date.now.bind(Date),Zr=D.requestAnimationFrame||D.mozRequestAnimationFrame||D.webkitRequestAnimationFrame||D.msRequestAnimationFrame,sr=D.cancelAnimationFrame||D.mozCancelAnimationFrame||D.webkitCancelAnimationFrame||D.msCancelAnimationFrame,ti={now:Mr,frame:function(e){var t=Zr(e);return{cancel:function(){return sr(t)}}},getImageData:function(e,t){t===void 0&&(t=0);var i=D.document.createElement("canvas"),l=i.getContext("2d");if(!l)throw new Error("failed to create canvas 2d context");return i.width=e.width,i.height=e.height,l.drawImage(e,0,0,e.width,e.height),l.getImageData(-t,-t,e.width+2*t,e.height+2*t)},resolveURL:function(e){return Je||(Je=D.document.createElement("a")),Je.href=e,Je.href},hardwareConcurrency:D.navigator&&D.navigator.hardwareConcurrency||4,get devicePixelRatio(){return D.devicePixelRatio},get prefersReducedMotion(){return!!D.matchMedia&&(At==null&&(At=D.matchMedia("(prefers-reduced-motion: reduce)")),At.matches)}},Wt={API_URL:"https://api.mapbox.com",get EVENTS_URL(){return this.API_URL?this.API_URL.indexOf("https://api.mapbox.cn")===0?"https://events.mapbox.cn/events/v2":this.API_URL.indexOf("https://api.mapbox.com")===0?"https://events.mapbox.com/events/v2":null:null},FEEDBACK_URL:"https://apps.mapbox.com/feedback",REQUIRE_ACCESS_TOKEN:!0,ACCESS_TOKEN:null,MAX_PARALLEL_IMAGE_REQUESTS:16},Gr={supported:!1,testSupport:function(e){!mr&&Fr&&(Nr?jt(e):pr=e)}},mr=!1,Nr=!1;function jt(e){var t=e.createTexture();e.bindTexture(e.TEXTURE_2D,t);try{if(e.texImage2D(e.TEXTURE_2D,0,e.RGBA,e.RGBA,e.UNSIGNED_BYTE,Fr),e.isContextLost())return;Gr.supported=!0}catch{}e.deleteTexture(t),mr=!0}D.document&&((Fr=D.document.createElement("img")).onload=function(){pr&&jt(pr),pr=null,Nr=!0},Fr.onerror=function(){mr=!0,pr=null},Fr.src="data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAQAAAAfQ//73v/+BiOh/AAA=");var Dr="01",Kr=function(e,t){this._transformRequestFn=e,this._customAccessToken=t,this._createSkuToken()};function cr(e){return e.indexOf("mapbox:")===0}Kr.prototype._createSkuToken=function(){var e=function(){for(var t="",i=0;i<10;i++)t+="0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ"[Math.floor(62*Math.random())];return{token:["1",Dr,t].join(""),tokenExpiresAt:Date.now()+432e5}}();this._skuToken=e.token,this._skuTokenExpiresAt=e.tokenExpiresAt},Kr.prototype._isSkuTokenExpired=function(){return Date.now()>this._skuTokenExpiresAt},Kr.prototype.transformRequest=function(e,t){return this._transformRequestFn&&this._transformRequestFn(e,t)||{url:e}},Kr.prototype.normalizeStyleURL=function(e,t){if(!cr(e))return e;var i=pi(e);return i.path="/styles/v1"+i.path,this._makeAPIURL(i,this._customAccessToken||t)},Kr.prototype.normalizeGlyphsURL=function(e,t){if(!cr(e))return e;var i=pi(e);return i.path="/fonts/v1"+i.path,this._makeAPIURL(i,this._customAccessToken||t)},Kr.prototype.normalizeSourceURL=function(e,t){if(!cr(e))return e;var i=pi(e);return i.path="/v4/"+i.authority+".json",i.params.push("secure"),this._makeAPIURL(i,this._customAccessToken||t)},Kr.prototype.normalizeSpriteURL=function(e,t,i,l){var p=pi(e);return cr(e)?(p.path="/styles/v1"+p.path+"/sprite"+t+i,this._makeAPIURL(p,this._customAccessToken||l)):(p.path+=""+t+i,Qi(p))},Kr.prototype.normalizeTileURL=function(e,t){if(this._isSkuTokenExpired()&&this._createSkuToken(),e&&!cr(e))return e;var i=pi(e);i.path=i.path.replace(/(\.(png|jpg)\d*)(?=$)/,(ti.devicePixelRatio>=2||t===512?"@2x":"")+(Gr.supported?".webp":"$1")),i.path=i.path.replace(/^.+\/v4\//,"/"),i.path="/v4"+i.path;var l=this._customAccessToken||function(p){for(var m=0,x=p;m<x.length;m+=1){var S=x[m].match(/^access_token=(.*)$/);if(S)return S[1]}return null}(i.params)||Wt.ACCESS_TOKEN;return Wt.REQUIRE_ACCESS_TOKEN&&l&&this._skuToken&&i.params.push("sku="+this._skuToken),this._makeAPIURL(i,l)},Kr.prototype.canonicalizeTileURL=function(e,t){var i=pi(e);if(!i.path.match(/(^\/v4\/)/)||!i.path.match(/\.[\w]+$/))return e;var l="mapbox://tiles/";l+=i.path.replace("/v4/","");var p=i.params;return t&&(p=p.filter(function(m){return!m.match(/^access_token=/)})),p.length&&(l+="?"+p.join("&")),l},Kr.prototype.canonicalizeTileset=function(e,t){for(var i=!!t&&cr(t),l=[],p=0,m=e.tiles||[];p<m.length;p+=1){var x=m[p];Ar(x)?l.push(this.canonicalizeTileURL(x,i)):l.push(x)}return l},Kr.prototype._makeAPIURL=function(e,t){var i="See https://www.mapbox.com/api-documentation/#access-tokens-and-token-scopes",l=pi(Wt.API_URL);if(e.protocol=l.protocol,e.authority=l.authority,e.protocol==="http"){var p=e.params.indexOf("secure");p>=0&&e.params.splice(p,1)}if(l.path!=="/"&&(e.path=""+l.path+e.path),!Wt.REQUIRE_ACCESS_TOKEN)return Qi(e);if(!(t=t||Wt.ACCESS_TOKEN))throw new Error("An API access token is required to use Mapbox GL. "+i);if(t[0]==="s")throw new Error("Use a public access token (pk.*) with Mapbox GL, not a secret access token (sk.*). "+i);return e.params=e.params.filter(function(m){return m.indexOf("access_token")===-1}),e.params.push("access_token="+t),Qi(e)};var Fi=/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/|\?|$)/i;function Ar(e){return Fi.test(e)}var bi=/^(\w+):\/\/([^/?]*)(\/[^?]+)?\??(.+)?/;function pi(e){var t=e.match(bi);if(!t)throw new Error("Unable to parse URL object");return{protocol:t[1],authority:t[2],path:t[3]||"/",params:t[4]?t[4].split("&"):[]}}function Qi(e){var t=e.params.length?"?"+e.params.join("&"):"";return e.protocol+"://"+e.authority+e.path+t}function Mi(e){if(!e)return null;var t=e.split(".");if(!t||t.length!==3)return null;try{return JSON.parse(decodeURIComponent(D.atob(t[1]).split("").map(function(i){return"%"+("00"+i.charCodeAt(0).toString(16)).slice(-2)}).join("")))}catch{return null}}var fi=function(e){this.type=e,this.anonId=null,this.eventData={},this.queue=[],this.pendingRequest=null};fi.prototype.getStorageKey=function(e){var t,i=Mi(Wt.ACCESS_TOKEN);return t=i&&i.u?D.btoa(encodeURIComponent(i.u).replace(/%([0-9A-F]{2})/g,function(l,p){return String.fromCharCode(+("0x"+p))})):Wt.ACCESS_TOKEN||"",e?"mapbox.eventData."+e+":"+t:"mapbox.eventData:"+t},fi.prototype.fetchEventData=function(){var e=ei("localStorage"),t=this.getStorageKey(),i=this.getStorageKey("uuid");if(e)try{var l=D.localStorage.getItem(t);l&&(this.eventData=JSON.parse(l));var p=D.localStorage.getItem(i);p&&(this.anonId=p)}catch{yt("Unable to read from LocalStorage")}},fi.prototype.saveEventData=function(){var e=ei("localStorage"),t=this.getStorageKey(),i=this.getStorageKey("uuid");if(e)try{D.localStorage.setItem(i,this.anonId),Object.keys(this.eventData).length>=1&&D.localStorage.setItem(t,JSON.stringify(this.eventData))}catch{yt("Unable to write to LocalStorage")}},fi.prototype.processRequests=function(e){},fi.prototype.postEvent=function(e,t,i,l){var p=this;if(Wt.EVENTS_URL){var m=pi(Wt.EVENTS_URL);m.params.push("access_token="+(l||Wt.ACCESS_TOKEN||""));var x={event:this.type,created:new Date(e).toISOString(),sdkIdentifier:"mapbox-gl-js",sdkVersion:"1.13.2",skuId:Dr,userId:this.anonId},S=t?xe(x,t):x,z={url:Qi(m),headers:{"Content-Type":"text/plain"},body:JSON.stringify([S])};this.pendingRequest=Pr(z,function(A){p.pendingRequest=null,i(A),p.saveEventData(),p.processRequests(l)})}},fi.prototype.queueRequest=function(e,t){this.queue.push(e),this.processRequests(t)};var ri,sn,di=function(e){function t(){e.call(this,"map.load"),this.success={},this.skuToken=""}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.postMapLoadEvent=function(i,l,p,m){this.skuToken=p,(Wt.EVENTS_URL&&m||Wt.ACCESS_TOKEN&&Array.isArray(i)&&i.some(function(x){return cr(x)||Ar(x)}))&&this.queueRequest({id:l,timestamp:Date.now()},m)},t.prototype.processRequests=function(i){var l=this;if(!this.pendingRequest&&this.queue.length!==0){var p=this.queue.shift(),m=p.id,x=p.timestamp;m&&this.success[m]||(this.anonId||this.fetchEventData(),He(this.anonId)||(this.anonId=De()),this.postEvent(x,{skuToken:this.skuToken},function(S){S||m&&(l.success[m]=!0)},i))}},t}(fi),Ur=new(function(e){function t(i){e.call(this,"appUserTurnstile"),this._customAccessToken=i}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.postTurnstileEvent=function(i,l){Wt.EVENTS_URL&&Wt.ACCESS_TOKEN&&Array.isArray(i)&&i.some(function(p){return cr(p)||Ar(p)})&&this.queueRequest(Date.now(),l)},t.prototype.processRequests=function(i){var l=this;if(!this.pendingRequest&&this.queue.length!==0){this.anonId&&this.eventData.lastSuccess&&this.eventData.tokenU||this.fetchEventData();var p=Mi(Wt.ACCESS_TOKEN),m=p?p.u:Wt.ACCESS_TOKEN,x=m!==this.eventData.tokenU;He(this.anonId)||(this.anonId=De(),x=!0);var S=this.queue.shift();if(this.eventData.lastSuccess){var z=new Date(this.eventData.lastSuccess),A=new Date(S),C=(S-this.eventData.lastSuccess)/864e5;x=x||C>=1||C<-1||z.getDate()!==A.getDate()}else x=!0;if(!x)return this.processRequests();this.postEvent(S,{"enabled.telemetry":!1},function(B){B||(l.eventData.lastSuccess=S,l.eventData.tokenU=m)},i)}},t}(fi)),$i=Ur.postTurnstileEvent.bind(Ur),Ln=new di,Ni=Ln.postMapLoadEvent.bind(Ln),zn=500,en=50;function An(){D.caches&&!ri&&(ri=D.caches.open("mapbox-tiles"))}function Ui(e){var t=e.indexOf("?");return t<0?e:e.slice(0,t)}var gn,Vi=1/0;function Rn(){return gn==null&&(gn=D.OffscreenCanvas&&new D.OffscreenCanvas(1,1).getContext("2d")&&typeof D.createImageBitmap=="function"),gn}var tn={Unknown:"Unknown",Style:"Style",Source:"Source",Tile:"Tile",Glyphs:"Glyphs",SpriteImage:"SpriteImage",SpriteJSON:"SpriteJSON",Image:"Image"};typeof Object.freeze=="function"&&Object.freeze(tn);var ji=function(e){function t(i,l,p){l===401&&Ar(p)&&(i+=": you may have provided an invalid Mapbox access token. See https://www.mapbox.com/api-documentation/#access-tokens-and-token-scopes"),e.call(this,i),this.status=l,this.url=p,this.name=this.constructor.name,this.message=i}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.toString=function(){return this.name+": "+this.message+" ("+this.status+"): "+this.url},t}(Error),vn=Zt()?function(){return self.worker&&self.worker.referrer}:function(){return(D.location.protocol==="blob:"?D.parent:D).location.href},ln,un,bn=function(e,t){if(!(/^file:/.test(i=e.url)||/^file:/.test(vn())&&!/^\w+:/.test(i))){if(D.fetch&&D.Request&&D.AbortController&&D.Request.prototype.hasOwnProperty("signal"))return function(l,p){var m,x=new D.AbortController,S=new D.Request(l.url,{method:l.method||"GET",body:l.body,credentials:l.credentials,headers:l.headers,referrer:vn(),signal:x.signal}),z=!1,A=!1,C=(m=S.url).indexOf("sku=")>0&&Ar(m);l.type==="json"&&S.headers.set("Accept","application/json");var B=function(q,Q,ee){if(!A){if(q&&q.message!=="SecurityError"&&yt(q),Q&&ee)return U(Q);var ce=Date.now();D.fetch(S).then(function(ie){if(ie.ok){var me=C?ie.clone():null;return U(ie,me,ce)}return p(new ji(ie.statusText,ie.status,l.url))}).catch(function(ie){ie.code!==20&&p(new Error(ie.message))})}},U=function(q,Q,ee){(l.type==="arrayBuffer"?q.arrayBuffer():l.type==="json"?q.json():q.text()).then(function(ce){A||(Q&&ee&&function(ie,me,be){if(An(),ri){var ke={status:me.status,statusText:me.statusText,headers:new D.Headers};me.headers.forEach(function(Pe,je){return ke.headers.set(je,Pe)});var Ie=pt(me.headers.get("Cache-Control")||"");Ie["no-store"]||(Ie["max-age"]&&ke.headers.set("Expires",new Date(be+1e3*Ie["max-age"]).toUTCString()),new Date(ke.headers.get("Expires")).getTime()-be<42e4||function(Pe,je){if(sn===void 0)try{new Response(new ReadableStream),sn=!0}catch{sn=!1}sn?je(Pe.body):Pe.blob().then(je)}(me,function(Pe){var je=new D.Response(Pe,ke);An(),ri&&ri.then(function(Qe){return Qe.put(Ui(ie.url),je)}).catch(function(Qe){return yt(Qe.message)})}))}}(S,Q,ee),z=!0,p(null,ce,q.headers.get("Cache-Control"),q.headers.get("Expires")))}).catch(function(ce){A||p(new Error(ce.message))})};return C?function(q,Q){if(An(),!ri)return Q(null);var ee=Ui(q.url);ri.then(function(ce){ce.match(ee).then(function(ie){var me=function(be){if(!be)return!1;var ke=new Date(be.headers.get("Expires")||0),Ie=pt(be.headers.get("Cache-Control")||"");return ke>Date.now()&&!Ie["no-cache"]}(ie);ce.delete(ee),me&&ce.put(ee,ie.clone()),Q(null,ie,me)}).catch(Q)}).catch(Q)}(S,B):B(null,null),{cancel:function(){A=!0,z||x.abort()}}}(e,t);if(Zt()&&self.worker&&self.worker.actor)return self.worker.actor.send("getResource",e,t,void 0,!0)}var i;return function(l,p){var m=new D.XMLHttpRequest;for(var x in m.open(l.method||"GET",l.url,!0),l.type==="arrayBuffer"&&(m.responseType="arraybuffer"),l.headers)m.setRequestHeader(x,l.headers[x]);return l.type==="json"&&(m.responseType="text",m.setRequestHeader("Accept","application/json")),m.withCredentials=l.credentials==="include",m.onerror=function(){p(new Error(m.statusText))},m.onload=function(){if((m.status>=200&&m.status<300||m.status===0)&&m.response!==null){var S=m.response;if(l.type==="json")try{S=JSON.parse(m.response)}catch(z){return p(z)}p(null,S,m.getResponseHeader("Cache-Control"),m.getResponseHeader("Expires"))}else p(new ji(m.statusText,m.status,l.url))},m.send(l.body),{cancel:function(){return m.abort()}}}(e,t)},oi=function(e,t){return bn(xe(e,{type:"arrayBuffer"}),t)},Pr=function(e,t){return bn(xe(e,{method:"POST"}),t)},L="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAC0lEQVQYV2NgAAIAAAUAAarVyFEAAAAASUVORK5CYII=";ln=[],un=0;var N=function(e,t){if(Gr.supported&&(e.headers||(e.headers={}),e.headers.accept="image/webp,*/*"),un>=Wt.MAX_PARALLEL_IMAGE_REQUESTS){var i={requestParameters:e,callback:t,cancelled:!1,cancel:function(){this.cancelled=!0}};return ln.push(i),i}un++;var l=!1,p=function(){if(!l)for(l=!0,un--;ln.length&&un<Wt.MAX_PARALLEL_IMAGE_REQUESTS;){var x=ln.shift();x.cancelled||(x.cancel=N(x.requestParameters,x.callback).cancel)}},m=oi(e,function(x,S,z,A){p(),x?t(x):S&&(Rn()?function(C,B){var U=new D.Blob([new Uint8Array(C)],{type:"image/png"});D.createImageBitmap(U).then(function(q){B(null,q)}).catch(function(q){B(new Error("Could not load image because of "+q.message+". Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."))})}(S,t):function(C,B,U,q){var Q=new D.Image,ee=D.URL;Q.onload=function(){B(null,Q),ee.revokeObjectURL(Q.src),Q.onload=null,D.requestAnimationFrame(function(){Q.src=L})},Q.onerror=function(){return B(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."))};var ce=new D.Blob([new Uint8Array(C)],{type:"image/png"});Q.cacheControl=U,Q.expires=q,Q.src=C.byteLength?ee.createObjectURL(ce):L}(S,t,z,A))});return{cancel:function(){m.cancel(),p()}}};function V(e,t,i){i[e]&&i[e].indexOf(t)!==-1||(i[e]=i[e]||[],i[e].push(t))}function W(e,t,i){if(i&&i[e]){var l=i[e].indexOf(t);l!==-1&&i[e].splice(l,1)}}var $=function(e,t){t===void 0&&(t={}),xe(this,t),this.type=e},se=function(e){function t(i,l){l===void 0&&(l={}),e.call(this,"error",xe({error:i},l))}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t}($),he=function(){};he.prototype.on=function(e,t){return this._listeners=this._listeners||{},V(e,t,this._listeners),this},he.prototype.off=function(e,t){return W(e,t,this._listeners),W(e,t,this._oneTimeListeners),this},he.prototype.once=function(e,t){return this._oneTimeListeners=this._oneTimeListeners||{},V(e,t,this._oneTimeListeners),this},he.prototype.fire=function(e,t){typeof e=="string"&&(e=new $(e,t||{}));var i=e.type;if(this.listens(i)){e.target=this;for(var l=0,p=this._listeners&&this._listeners[i]?this._listeners[i].slice():[];l<p.length;l+=1)p[l].call(this,e);for(var m=0,x=this._oneTimeListeners&&this._oneTimeListeners[i]?this._oneTimeListeners[i].slice():[];m<x.length;m+=1){var S=x[m];W(i,S,this._oneTimeListeners),S.call(this,e)}var z=this._eventedParent;z&&(xe(e,typeof this._eventedParentData=="function"?this._eventedParentData():this._eventedParentData),z.fire(e))}else e instanceof se&&console.error(e.error);return this},he.prototype.listens=function(e){return this._listeners&&this._listeners[e]&&this._listeners[e].length>0||this._oneTimeListeners&&this._oneTimeListeners[e]&&this._oneTimeListeners[e].length>0||this._eventedParent&&this._eventedParent.listens(e)},he.prototype.setEventedParent=function(e,t){return this._eventedParent=e,this._eventedParentData=t,this};var j={$version:8,$root:{version:{required:!0,type:"enum",values:[8]},name:{type:"string"},metadata:{type:"*"},center:{type:"array",value:"number"},zoom:{type:"number"},bearing:{type:"number",default:0,period:360,units:"degrees"},pitch:{type:"number",default:0,units:"degrees"},light:{type:"light"},sources:{required:!0,type:"sources"},sprite:{type:"string"},glyphs:{type:"string"},transition:{type:"transition"},layers:{required:!0,type:"array",value:"layer"}},sources:{"*":{type:"source"}},source:["source_vector","source_raster","source_raster_dem","source_geojson","source_video","source_image"],source_vector:{type:{required:!0,type:"enum",values:{vector:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},attribution:{type:"string"},promoteId:{type:"promoteId"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_raster:{type:{required:!0,type:"enum",values:{raster:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},attribution:{type:"string"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_raster_dem:{type:{required:!0,type:"enum",values:{"raster-dem":{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},attribution:{type:"string"},encoding:{type:"enum",values:{terrarium:{},mapbox:{}},default:"mapbox"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_geojson:{type:{required:!0,type:"enum",values:{geojson:{}}},data:{type:"*"},maxzoom:{type:"number",default:18},attribution:{type:"string"},buffer:{type:"number",default:128,maximum:512,minimum:0},filter:{type:"*"},tolerance:{type:"number",default:.375},cluster:{type:"boolean",default:!1},clusterRadius:{type:"number",default:50,minimum:0},clusterMaxZoom:{type:"number"},clusterMinPoints:{type:"number"},clusterProperties:{type:"*"},lineMetrics:{type:"boolean",default:!1},generateId:{type:"boolean",default:!1},promoteId:{type:"promoteId"}},source_video:{type:{required:!0,type:"enum",values:{video:{}}},urls:{required:!0,type:"array",value:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},source_image:{type:{required:!0,type:"enum",values:{image:{}}},url:{required:!0,type:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},layer:{id:{type:"string",required:!0},type:{type:"enum",values:{fill:{},line:{},symbol:{},circle:{},heatmap:{},"fill-extrusion":{},raster:{},hillshade:{},background:{}},required:!0},metadata:{type:"*"},source:{type:"string"},"source-layer":{type:"string"},minzoom:{type:"number",minimum:0,maximum:24},maxzoom:{type:"number",minimum:0,maximum:24},filter:{type:"filter"},layout:{type:"layout"},paint:{type:"paint"}},layout:["layout_fill","layout_line","layout_circle","layout_heatmap","layout_fill-extrusion","layout_symbol","layout_raster","layout_hillshade","layout_background"],layout_background:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_fill:{"fill-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_circle:{"circle-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_heatmap:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},"layout_fill-extrusion":{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_line:{"line-cap":{type:"enum",values:{butt:{},round:{},square:{}},default:"butt",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-join":{type:"enum",values:{bevel:{},round:{},miter:{}},default:"miter",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"line-miter-limit":{type:"number",default:2,requires:[{"line-join":"miter"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-round-limit":{type:"number",default:1.05,requires:[{"line-join":"round"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_symbol:{"symbol-placement":{type:"enum",values:{point:{},line:{},"line-center":{}},default:"point",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-spacing":{type:"number",default:250,minimum:1,units:"pixels",requires:[{"symbol-placement":"line"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"symbol-avoid-edges":{type:"boolean",default:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"symbol-z-order":{type:"enum",values:{auto:{},"viewport-y":{},source:{}},default:"auto",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-allow-overlap":{type:"boolean",default:!1,requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-ignore-placement":{type:"boolean",default:!1,requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-optional":{type:"boolean",default:!1,requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-rotation-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-size":{type:"number",default:1,minimum:0,units:"factor of the original icon size",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-text-fit":{type:"enum",values:{none:{},width:{},height:{},both:{}},default:"none",requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-text-fit-padding":{type:"array",value:"number",length:4,default:[0,0,0,0],units:"pixels",requires:["icon-image","text-field",{"icon-text-fit":["both","width","height"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-image":{type:"resolvedImage",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-padding":{type:"number",default:2,minimum:0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-keep-upright":{type:"boolean",default:!1,requires:["icon-image",{"icon-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-offset":{type:"array",value:"number",length:2,default:[0,0],requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotation-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-field":{type:"formatted",default:"",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-font":{type:"array",value:"string",default:["Open Sans Regular","Arial Unicode MS Regular"],requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-size":{type:"number",default:16,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-width":{type:"number",default:10,minimum:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-line-height":{type:"number",default:1.2,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-letter-spacing":{type:"number",default:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-justify":{type:"enum",values:{auto:{},left:{},center:{},right:{}},default:"center",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-radial-offset":{type:"number",units:"ems",default:0,requires:["text-field"],"property-type":"data-driven",expression:{interpolated:!0,parameters:["zoom","feature"]}},"text-variable-anchor":{type:"array",value:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["text-field",{"!":"text-variable-anchor"}],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-angle":{type:"number",default:45,units:"degrees",requires:["text-field",{"symbol-placement":["line","line-center"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-writing-mode":{type:"array",value:"enum",values:{horizontal:{},vertical:{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-padding":{type:"number",default:2,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-keep-upright":{type:"boolean",default:!0,requires:["text-field",{"text-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-transform":{type:"enum",values:{none:{},uppercase:{},lowercase:{}},default:"none",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-offset":{type:"array",value:"number",units:"ems",length:2,default:[0,0],requires:["text-field",{"!":"text-radial-offset"}],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-allow-overlap":{type:"boolean",default:!1,requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-ignore-placement":{type:"boolean",default:!1,requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-optional":{type:"boolean",default:!1,requires:["text-field","icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_raster:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_hillshade:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},filter:{type:"array",value:"*"},filter_operator:{type:"enum",values:{"==":{},"!=":{},">":{},">=":{},"<":{},"<=":{},in:{},"!in":{},all:{},any:{},none:{},has:{},"!has":{},within:{}}},geometry_type:{type:"enum",values:{Point:{},LineString:{},Polygon:{}}},function:{expression:{type:"expression"},stops:{type:"array",value:"function_stop"},base:{type:"number",default:1,minimum:0},property:{type:"string",default:"$zoom"},type:{type:"enum",values:{identity:{},exponential:{},interval:{},categorical:{}},default:"exponential"},colorSpace:{type:"enum",values:{rgb:{},lab:{},hcl:{}},default:"rgb"},default:{type:"*",required:!1}},function_stop:{type:"array",minimum:0,maximum:24,value:["number","color"],length:2},expression:{type:"array",value:"*",minimum:1},light:{anchor:{type:"enum",default:"viewport",values:{map:{},viewport:{}},"property-type":"data-constant",transition:!1,expression:{interpolated:!1,parameters:["zoom"]}},position:{type:"array",default:[1.15,210,30],length:3,value:"number","property-type":"data-constant",transition:!0,expression:{interpolated:!0,parameters:["zoom"]}},color:{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},intensity:{type:"number","property-type":"data-constant",default:.5,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0}},paint:["paint_fill","paint_line","paint_circle","paint_heatmap","paint_fill-extrusion","paint_symbol","paint_raster","paint_hillshade","paint_background"],paint_fill:{"fill-antialias":{type:"boolean",default:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-outline-color":{type:"color",transition:!0,requires:[{"!":"fill-pattern"},{"fill-antialias":!0}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"}},"paint_fill-extrusion":{"fill-extrusion-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-extrusion-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-extrusion-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"fill-extrusion-height":{type:"number",default:0,minimum:0,units:"meters",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-base":{type:"number",default:0,minimum:0,units:"meters",transition:!0,requires:["fill-extrusion-height"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-vertical-gradient":{type:"boolean",default:!0,transition:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_line:{"line-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"line-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["line-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-width":{type:"number",default:1,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-gap-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-offset":{type:"number",default:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-dasharray":{type:"array",value:"number",minimum:0,transition:!0,units:"line widths",requires:[{"!":"line-pattern"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"line-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"line-gradient":{type:"color",transition:!1,requires:[{"!":"line-dasharray"},{"!":"line-pattern"},{source:"geojson",has:{lineMetrics:!0}}],expression:{interpolated:!0,parameters:["line-progress"]},"property-type":"color-ramp"}},paint_circle:{"circle-radius":{type:"number",default:5,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-blur":{type:"number",default:0,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"circle-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["circle-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-scale":{type:"enum",values:{map:{},viewport:{}},default:"map",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-alignment":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-stroke-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"}},paint_heatmap:{"heatmap-radius":{type:"number",default:30,minimum:1,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-weight":{type:"number",default:1,minimum:0,transition:!1,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-intensity":{type:"number",default:1,minimum:0,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"heatmap-color":{type:"color",default:["interpolate",["linear"],["heatmap-density"],0,"rgba(0, 0, 255, 0)",.1,"royalblue",.3,"cyan",.5,"lime",.7,"yellow",1,"red"],transition:!1,expression:{interpolated:!0,parameters:["heatmap-density"]},"property-type":"color-ramp"},"heatmap-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_symbol:{"icon-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-color":{type:"color",default:"#000000",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["icon-image","icon-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-color":{type:"color",default:"#000000",transition:!0,overridable:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["text-field","text-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_raster:{"raster-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-hue-rotate":{type:"number",default:0,period:360,transition:!0,units:"degrees",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-min":{type:"number",default:0,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-max":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-saturation":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-contrast":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-resampling":{type:"enum",values:{linear:{},nearest:{}},default:"linear",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"raster-fade-duration":{type:"number",default:300,minimum:0,transition:!1,units:"milliseconds",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_hillshade:{"hillshade-illumination-direction":{type:"number",default:335,minimum:0,maximum:359,transition:!1,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-illumination-anchor":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-exaggeration":{type:"number",default:.5,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-shadow-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-highlight-color":{type:"color",default:"#FFFFFF",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-accent-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_background:{"background-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"background-pattern"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"background-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"background-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},transition:{duration:{type:"number",default:300,minimum:0,units:"milliseconds"},delay:{type:"number",default:0,minimum:0,units:"milliseconds"}},"property-type":{"data-driven":{type:"property-type"},"cross-faded":{type:"property-type"},"cross-faded-data-driven":{type:"property-type"},"color-ramp":{type:"property-type"},"data-constant":{type:"property-type"},constant:{type:"property-type"}},promoteId:{"*":{type:"string"}}},J=function(e,t,i,l){this.message=(e?e+": ":"")+i,l&&(this.identifier=l),t!=null&&t.__line__&&(this.line=t.__line__)};function _e(e){var t=e.value;return t?[new J(e.key,t,"constants have been deprecated as of v8")]:[]}function Ce(e){for(var t=[],i=arguments.length-1;i-- >0;)t[i]=arguments[i+1];for(var l=0,p=t;l<p.length;l+=1){var m=p[l];for(var x in m)e[x]=m[x]}return e}function Me(e){return e instanceof Number||e instanceof String||e instanceof Boolean?e.valueOf():e}function K(e){if(Array.isArray(e))return e.map(K);if(e instanceof Object&&!(e instanceof Number||e instanceof String||e instanceof Boolean)){var t={};for(var i in e)t[i]=K(e[i]);return t}return Me(e)}var ve=function(e){function t(i,l){e.call(this,l),this.message=l,this.key=i}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t}(Error),et=function(e,t){t===void 0&&(t=[]),this.parent=e,this.bindings={};for(var i=0,l=t;i<l.length;i+=1){var p=l[i];this.bindings[p[0]]=p[1]}};et.prototype.concat=function(e){return new et(this,e)},et.prototype.get=function(e){if(this.bindings[e])return this.bindings[e];if(this.parent)return this.parent.get(e);throw new Error(e+" not found in scope.")},et.prototype.has=function(e){return!!this.bindings[e]||!!this.parent&&this.parent.has(e)};var Ye={kind:"null"},Se={kind:"number"},We={kind:"string"},Fe={kind:"boolean"},qe={kind:"color"},Mt={kind:"object"},Ze={kind:"value"},Vt={kind:"collator"},lr={kind:"formatted"},Pt={kind:"resolvedImage"};function er(e,t){return{kind:"array",itemType:e,N:t}}function Jt(e){if(e.kind==="array"){var t=Jt(e.itemType);return typeof e.N=="number"?"array<"+t+", "+e.N+">":e.itemType.kind==="value"?"array":"array<"+t+">"}return e.kind}var ii=[Ye,Se,We,Fe,qe,lr,Mt,er(Ze),Pt];function $t(e,t){if(t.kind==="error")return null;if(e.kind==="array"){if(t.kind==="array"&&(t.N===0&&t.itemType.kind==="value"||!$t(e.itemType,t.itemType))&&(typeof e.N!="number"||e.N===t.N))return null}else{if(e.kind===t.kind)return null;if(e.kind==="value"){for(var i=0,l=ii;i<l.length;i+=1)if(!$t(l[i],t))return null}}return"Expected "+Jt(e)+" but found "+Jt(t)+" instead."}function vr(e,t){return t.some(function(i){return i.kind===e.kind})}function fr(e,t){return t.some(function(i){return i==="null"?e===null:i==="array"?Array.isArray(e):i==="object"?e&&!Array.isArray(e)&&typeof e=="object":i===typeof e})}var Gt=I(function(e,t){var i={transparent:[0,0,0,0],aliceblue:[240,248,255,1],antiquewhite:[250,235,215,1],aqua:[0,255,255,1],aquamarine:[127,255,212,1],azure:[240,255,255,1],beige:[245,245,220,1],bisque:[255,228,196,1],black:[0,0,0,1],blanchedalmond:[255,235,205,1],blue:[0,0,255,1],blueviolet:[138,43,226,1],brown:[165,42,42,1],burlywood:[222,184,135,1],cadetblue:[95,158,160,1],chartreuse:[127,255,0,1],chocolate:[210,105,30,1],coral:[255,127,80,1],cornflowerblue:[100,149,237,1],cornsilk:[255,248,220,1],crimson:[220,20,60,1],cyan:[0,255,255,1],darkblue:[0,0,139,1],darkcyan:[0,139,139,1],darkgoldenrod:[184,134,11,1],darkgray:[169,169,169,1],darkgreen:[0,100,0,1],darkgrey:[169,169,169,1],darkkhaki:[189,183,107,1],darkmagenta:[139,0,139,1],darkolivegreen:[85,107,47,1],darkorange:[255,140,0,1],darkorchid:[153,50,204,1],darkred:[139,0,0,1],darksalmon:[233,150,122,1],darkseagreen:[143,188,143,1],darkslateblue:[72,61,139,1],darkslategray:[47,79,79,1],darkslategrey:[47,79,79,1],darkturquoise:[0,206,209,1],darkviolet:[148,0,211,1],deeppink:[255,20,147,1],deepskyblue:[0,191,255,1],dimgray:[105,105,105,1],dimgrey:[105,105,105,1],dodgerblue:[30,144,255,1],firebrick:[178,34,34,1],floralwhite:[255,250,240,1],forestgreen:[34,139,34,1],fuchsia:[255,0,255,1],gainsboro:[220,220,220,1],ghostwhite:[248,248,255,1],gold:[255,215,0,1],goldenrod:[218,165,32,1],gray:[128,128,128,1],green:[0,128,0,1],greenyellow:[173,255,47,1],grey:[128,128,128,1],honeydew:[240,255,240,1],hotpink:[255,105,180,1],indianred:[205,92,92,1],indigo:[75,0,130,1],ivory:[255,255,240,1],khaki:[240,230,140,1],lavender:[230,230,250,1],lavenderblush:[255,240,245,1],lawngreen:[124,252,0,1],lemonchiffon:[255,250,205,1],lightblue:[173,216,230,1],lightcoral:[240,128,128,1],lightcyan:[224,255,255,1],lightgoldenrodyellow:[250,250,210,1],lightgray:[211,211,211,1],lightgreen:[144,238,144,1],lightgrey:[211,211,211,1],lightpink:[255,182,193,1],lightsalmon:[255,160,122,1],lightseagreen:[32,178,170,1],lightskyblue:[135,206,250,1],lightslategray:[119,136,153,1],lightslategrey:[119,136,153,1],lightsteelblue:[176,196,222,1],lightyellow:[255,255,224,1],lime:[0,255,0,1],limegreen:[50,205,50,1],linen:[250,240,230,1],magenta:[255,0,255,1],maroon:[128,0,0,1],mediumaquamarine:[102,205,170,1],mediumblue:[0,0,205,1],mediumorchid:[186,85,211,1],mediumpurple:[147,112,219,1],mediumseagreen:[60,179,113,1],mediumslateblue:[123,104,238,1],mediumspringgreen:[0,250,154,1],mediumturquoise:[72,209,204,1],mediumvioletred:[199,21,133,1],midnightblue:[25,25,112,1],mintcream:[245,255,250,1],mistyrose:[255,228,225,1],moccasin:[255,228,181,1],navajowhite:[255,222,173,1],navy:[0,0,128,1],oldlace:[253,245,230,1],olive:[128,128,0,1],olivedrab:[107,142,35,1],orange:[255,165,0,1],orangered:[255,69,0,1],orchid:[218,112,214,1],palegoldenrod:[238,232,170,1],palegreen:[152,251,152,1],paleturquoise:[175,238,238,1],palevioletred:[219,112,147,1],papayawhip:[255,239,213,1],peachpuff:[255,218,185,1],peru:[205,133,63,1],pink:[255,192,203,1],plum:[221,160,221,1],powderblue:[176,224,230,1],purple:[128,0,128,1],rebeccapurple:[102,51,153,1],red:[255,0,0,1],rosybrown:[188,143,143,1],royalblue:[65,105,225,1],saddlebrown:[139,69,19,1],salmon:[250,128,114,1],sandybrown:[244,164,96,1],seagreen:[46,139,87,1],seashell:[255,245,238,1],sienna:[160,82,45,1],silver:[192,192,192,1],skyblue:[135,206,235,1],slateblue:[106,90,205,1],slategray:[112,128,144,1],slategrey:[112,128,144,1],snow:[255,250,250,1],springgreen:[0,255,127,1],steelblue:[70,130,180,1],tan:[210,180,140,1],teal:[0,128,128,1],thistle:[216,191,216,1],tomato:[255,99,71,1],turquoise:[64,224,208,1],violet:[238,130,238,1],wheat:[245,222,179,1],white:[255,255,255,1],whitesmoke:[245,245,245,1],yellow:[255,255,0,1],yellowgreen:[154,205,50,1]};function l(S){return(S=Math.round(S))<0?0:S>255?255:S}function p(S){return l(S[S.length-1]==="%"?parseFloat(S)/100*255:parseInt(S))}function m(S){return(z=S[S.length-1]==="%"?parseFloat(S)/100:parseFloat(S))<0?0:z>1?1:z;var z}function x(S,z,A){return A<0?A+=1:A>1&&(A-=1),6*A<1?S+(z-S)*A*6:2*A<1?z:3*A<2?S+(z-S)*(2/3-A)*6:S}try{t.parseCSSColor=function(S){var z,A=S.replace(/ /g,"").toLowerCase();if(A in i)return i[A].slice();if(A[0]==="#")return A.length===4?(z=parseInt(A.substr(1),16))>=0&&z<=4095?[(3840&z)>>4|(3840&z)>>8,240&z|(240&z)>>4,15&z|(15&z)<<4,1]:null:A.length===7&&(z=parseInt(A.substr(1),16))>=0&&z<=16777215?[(16711680&z)>>16,(65280&z)>>8,255&z,1]:null;var C=A.indexOf("("),B=A.indexOf(")");if(C!==-1&&B+1===A.length){var U=A.substr(0,C),q=A.substr(C+1,B-(C+1)).split(","),Q=1;switch(U){case"rgba":if(q.length!==4)return null;Q=m(q.pop());case"rgb":return q.length!==3?null:[p(q[0]),p(q[1]),p(q[2]),Q];case"hsla":if(q.length!==4)return null;Q=m(q.pop());case"hsl":if(q.length!==3)return null;var ee=(parseFloat(q[0])%360+360)%360/360,ce=m(q[1]),ie=m(q[2]),me=ie<=.5?ie*(ce+1):ie+ce-ie*ce,be=2*ie-me;return[l(255*x(be,me,ee+1/3)),l(255*x(be,me,ee)),l(255*x(be,me,ee-1/3)),Q];default:return null}}return null}}catch{}}).parseCSSColor,tr=function(e,t,i,l){l===void 0&&(l=1),this.r=e,this.g=t,this.b=i,this.a=l};tr.parse=function(e){if(e){if(e instanceof tr)return e;if(typeof e=="string"){var t=Gt(e);if(t)return new tr(t[0]/255*t[3],t[1]/255*t[3],t[2]/255*t[3],t[3])}}},tr.prototype.toString=function(){var e=this.toArray(),t=e[1],i=e[2],l=e[3];return"rgba("+Math.round(e[0])+","+Math.round(t)+","+Math.round(i)+","+l+")"},tr.prototype.toArray=function(){var e=this.a;return e===0?[0,0,0,0]:[255*this.r/e,255*this.g/e,255*this.b/e,e]},tr.black=new tr(0,0,0,1),tr.white=new tr(1,1,1,1),tr.transparent=new tr(0,0,0,0),tr.red=new tr(1,0,0,1);var si=function(e,t,i){this.sensitivity=e?t?"variant":"case":t?"accent":"base",this.locale=i,this.collator=new Intl.Collator(this.locale?this.locale:[],{sensitivity:this.sensitivity,usage:"search"})};si.prototype.compare=function(e,t){return this.collator.compare(e,t)},si.prototype.resolvedLocale=function(){return new Intl.Collator(this.locale?this.locale:[]).resolvedOptions().locale};var Bn=function(e,t,i,l,p){this.text=e,this.image=t,this.scale=i,this.fontStack=l,this.textColor=p},xr=function(e){this.sections=e};xr.fromString=function(e){return new xr([new Bn(e,null,null,null,null)])},xr.prototype.isEmpty=function(){return this.sections.length===0||!this.sections.some(function(e){return e.text.length!==0||e.image&&e.image.name.length!==0})},xr.factory=function(e){return e instanceof xr?e:xr.fromString(e)},xr.prototype.toString=function(){return this.sections.length===0?"":this.sections.map(function(e){return e.text}).join("")},xr.prototype.serialize=function(){for(var e=["format"],t=0,i=this.sections;t<i.length;t+=1){var l=i[t];if(l.image)e.push(["image",l.image.name]);else{e.push(l.text);var p={};l.fontStack&&(p["text-font"]=["literal",l.fontStack.split(",")]),l.scale&&(p["font-scale"]=l.scale),l.textColor&&(p["text-color"]=["rgba"].concat(l.textColor.toArray())),e.push(p)}}return e};var Di=function(e){this.name=e.name,this.available=e.available};function ja(e,t,i,l){return typeof e=="number"&&e>=0&&e<=255&&typeof t=="number"&&t>=0&&t<=255&&typeof i=="number"&&i>=0&&i<=255?l===void 0||typeof l=="number"&&l>=0&&l<=1?null:"Invalid rgba value ["+[e,t,i,l].join(", ")+"]: 'a' must be between 0 and 1.":"Invalid rgba value ["+(typeof l=="number"?[e,t,i,l]:[e,t,i]).join(", ")+"]: 'r', 'g', and 'b' must be between 0 and 255."}function ga(e){if(e===null||typeof e=="string"||typeof e=="boolean"||typeof e=="number"||e instanceof tr||e instanceof si||e instanceof xr||e instanceof Di)return!0;if(Array.isArray(e)){for(var t=0,i=e;t<i.length;t+=1)if(!ga(i[t]))return!1;return!0}if(typeof e=="object"){for(var l in e)if(!ga(e[l]))return!1;return!0}return!1}function Xr(e){if(e===null)return Ye;if(typeof e=="string")return We;if(typeof e=="boolean")return Fe;if(typeof e=="number")return Se;if(e instanceof tr)return qe;if(e instanceof si)return Vt;if(e instanceof xr)return lr;if(e instanceof Di)return Pt;if(Array.isArray(e)){for(var t,i=e.length,l=0,p=e;l<p.length;l+=1){var m=Xr(p[l]);if(t){if(t===m)continue;t=Ze;break}t=m}return er(t||Ze,i)}return Mt}function va(e){var t=typeof e;return e===null?"":t==="string"||t==="number"||t==="boolean"?String(e):e instanceof tr||e instanceof xr||e instanceof Di?e.toString():JSON.stringify(e)}Di.prototype.toString=function(){return this.name},Di.fromString=function(e){return e?new Di({name:e,available:!1}):null},Di.prototype.serialize=function(){return["image",this.name]};var Si=function(e,t){this.type=e,this.value=t};Si.parse=function(e,t){if(e.length!==2)return t.error("'literal' expression requires exactly one argument, but found "+(e.length-1)+" instead.");if(!ga(e[1]))return t.error("invalid value");var i=e[1],l=Xr(i),p=t.expectedType;return l.kind!=="array"||l.N!==0||!p||p.kind!=="array"||typeof p.N=="number"&&p.N!==0||(l=p),new Si(l,i)},Si.prototype.evaluate=function(){return this.value},Si.prototype.eachChild=function(){},Si.prototype.outputDefined=function(){return!0},Si.prototype.serialize=function(){return this.type.kind==="array"||this.type.kind==="object"?["literal",this.value]:this.value instanceof tr?["rgba"].concat(this.value.toArray()):this.value instanceof xr?this.value.serialize():this.value};var li=function(e){this.name="ExpressionEvaluationError",this.message=e};li.prototype.toJSON=function(){return this.message};var cn={string:We,number:Se,boolean:Fe,object:Mt},Lr=function(e,t){this.type=e,this.args=t};Lr.parse=function(e,t){if(e.length<2)return t.error("Expected at least one argument.");var i,l=1,p=e[0];if(p==="array"){var m,x;if(e.length>2){var S=e[1];if(typeof S!="string"||!(S in cn)||S==="object")return t.error('The item type argument of "array" must be one of string, number, boolean',1);m=cn[S],l++}else m=Ze;if(e.length>3){if(e[2]!==null&&(typeof e[2]!="number"||e[2]<0||e[2]!==Math.floor(e[2])))return t.error('The length argument to "array" must be a positive integer literal',2);x=e[2],l++}i=er(m,x)}else i=cn[p];for(var z=[];l<e.length;l++){var A=t.parse(e[l],l,Ze);if(!A)return null;z.push(A)}return new Lr(i,z)},Lr.prototype.evaluate=function(e){for(var t=0;t<this.args.length;t++){var i=this.args[t].evaluate(e);if(!$t(this.type,Xr(i)))return i;if(t===this.args.length-1)throw new li("Expected value to be of type "+Jt(this.type)+", but found "+Jt(Xr(i))+" instead.")}return null},Lr.prototype.eachChild=function(e){this.args.forEach(e)},Lr.prototype.outputDefined=function(){return this.args.every(function(e){return e.outputDefined()})},Lr.prototype.serialize=function(){var e=this.type,t=[e.kind];if(e.kind==="array"){var i=e.itemType;if(i.kind==="string"||i.kind==="number"||i.kind==="boolean"){t.push(i.kind);var l=e.N;(typeof l=="number"||this.args.length>1)&&t.push(l)}}return t.concat(this.args.map(function(p){return p.serialize()}))};var On=function(e){this.type=lr,this.sections=e};On.parse=function(e,t){if(e.length<2)return t.error("Expected at least one argument.");var i=e[1];if(!Array.isArray(i)&&typeof i=="object")return t.error("First argument must be an image or text section.");for(var l=[],p=!1,m=1;m<=e.length-1;++m){var x=e[m];if(p&&typeof x=="object"&&!Array.isArray(x)){p=!1;var S=null;if(x["font-scale"]&&!(S=t.parse(x["font-scale"],1,Se)))return null;var z=null;if(x["text-font"]&&!(z=t.parse(x["text-font"],1,er(We))))return null;var A=null;if(x["text-color"]&&!(A=t.parse(x["text-color"],1,qe)))return null;var C=l[l.length-1];C.scale=S,C.font=z,C.textColor=A}else{var B=t.parse(e[m],1,Ze);if(!B)return null;var U=B.type.kind;if(U!=="string"&&U!=="value"&&U!=="null"&&U!=="resolvedImage")return t.error("Formatted text type must be 'string', 'value', 'image' or 'null'.");p=!0,l.push({content:B,scale:null,font:null,textColor:null})}}return new On(l)},On.prototype.evaluate=function(e){return new xr(this.sections.map(function(t){var i=t.content.evaluate(e);return Xr(i)===Pt?new Bn("",i,null,null,null):new Bn(va(i),null,t.scale?t.scale.evaluate(e):null,t.font?t.font.evaluate(e).join(","):null,t.textColor?t.textColor.evaluate(e):null)}))},On.prototype.eachChild=function(e){for(var t=0,i=this.sections;t<i.length;t+=1){var l=i[t];e(l.content),l.scale&&e(l.scale),l.font&&e(l.font),l.textColor&&e(l.textColor)}},On.prototype.outputDefined=function(){return!1},On.prototype.serialize=function(){for(var e=["format"],t=0,i=this.sections;t<i.length;t+=1){var l=i[t];e.push(l.content.serialize());var p={};l.scale&&(p["font-scale"]=l.scale.serialize()),l.font&&(p["text-font"]=l.font.serialize()),l.textColor&&(p["text-color"]=l.textColor.serialize()),e.push(p)}return e};var xn=function(e){this.type=Pt,this.input=e};xn.parse=function(e,t){if(e.length!==2)return t.error("Expected two arguments.");var i=t.parse(e[1],1,We);return i?new xn(i):t.error("No image name provided.")},xn.prototype.evaluate=function(e){var t=this.input.evaluate(e),i=Di.fromString(t);return i&&e.availableImages&&(i.available=e.availableImages.indexOf(t)>-1),i},xn.prototype.eachChild=function(e){e(this.input)},xn.prototype.outputDefined=function(){return!1},xn.prototype.serialize=function(){return["image",this.input.serialize()]};var os={"to-boolean":Fe,"to-color":qe,"to-number":Se,"to-string":We},Ei=function(e,t){this.type=e,this.args=t};Ei.parse=function(e,t){if(e.length<2)return t.error("Expected at least one argument.");var i=e[0];if((i==="to-boolean"||i==="to-string")&&e.length!==2)return t.error("Expected one argument.");for(var l=os[i],p=[],m=1;m<e.length;m++){var x=t.parse(e[m],m,Ze);if(!x)return null;p.push(x)}return new Ei(l,p)},Ei.prototype.evaluate=function(e){if(this.type.kind==="boolean")return!!this.args[0].evaluate(e);if(this.type.kind==="color"){for(var t,i,l=0,p=this.args;l<p.length;l+=1){if(i=null,(t=p[l].evaluate(e))instanceof tr)return t;if(typeof t=="string"){var m=e.parseColor(t);if(m)return m}else if(Array.isArray(t)&&!(i=t.length<3||t.length>4?"Invalid rbga value "+JSON.stringify(t)+": expected an array containing either three or four numeric values.":ja(t[0],t[1],t[2],t[3])))return new tr(t[0]/255,t[1]/255,t[2]/255,t[3])}throw new li(i||"Could not parse color from value '"+(typeof t=="string"?t:String(JSON.stringify(t)))+"'")}if(this.type.kind==="number"){for(var x=null,S=0,z=this.args;S<z.length;S+=1){if((x=z[S].evaluate(e))===null)return 0;var A=Number(x);if(!isNaN(A))return A}throw new li("Could not convert "+JSON.stringify(x)+" to number.")}return this.type.kind==="formatted"?xr.fromString(va(this.args[0].evaluate(e))):this.type.kind==="resolvedImage"?Di.fromString(va(this.args[0].evaluate(e))):va(this.args[0].evaluate(e))},Ei.prototype.eachChild=function(e){this.args.forEach(e)},Ei.prototype.outputDefined=function(){return this.args.every(function(e){return e.outputDefined()})},Ei.prototype.serialize=function(){if(this.type.kind==="formatted")return new On([{content:this.args[0],scale:null,font:null,textColor:null}]).serialize();if(this.type.kind==="resolvedImage")return new xn(this.args[0]).serialize();var e=["to-"+this.type.kind];return this.eachChild(function(t){e.push(t.serialize())}),e};var ba=["Unknown","Point","LineString","Polygon"],qi=function(){this.globals=null,this.feature=null,this.featureState=null,this.formattedSection=null,this._parseColorCache={},this.availableImages=null,this.canonical=null};qi.prototype.id=function(){return this.feature&&"id"in this.feature?this.feature.id:null},qi.prototype.geometryType=function(){return this.feature?typeof this.feature.type=="number"?ba[this.feature.type]:this.feature.type:null},qi.prototype.geometry=function(){return this.feature&&"geometry"in this.feature?this.feature.geometry:null},qi.prototype.canonicalID=function(){return this.canonical},qi.prototype.properties=function(){return this.feature&&this.feature.properties||{}},qi.prototype.parseColor=function(e){var t=this._parseColorCache[e];return t||(t=this._parseColorCache[e]=tr.parse(e)),t};var Ti=function(e,t,i,l){this.name=e,this.type=t,this._evaluate=i,this.args=l};Ti.prototype.evaluate=function(e){return this._evaluate(e,this.args)},Ti.prototype.eachChild=function(e){this.args.forEach(e)},Ti.prototype.outputDefined=function(){return!1},Ti.prototype.serialize=function(){return[this.name].concat(this.args.map(function(e){return e.serialize()}))},Ti.parse=function(e,t){var i,l=e[0],p=Ti.definitions[l];if(!p)return t.error('Unknown expression "'+l+'". If you wanted a literal array, use ["literal", [...]].',0);for(var m=Array.isArray(p)?p[0]:p.type,x=Array.isArray(p)?[[p[1],p[2]]]:p.overloads,S=x.filter(function(bt){var nt=bt[0];return!Array.isArray(nt)||nt.length===e.length-1}),z=null,A=0,C=S;A<C.length;A+=1){var B=C[A],U=B[0],q=B[1];z=new Wr(t.registry,t.path,null,t.scope);for(var Q=[],ee=!1,ce=1;ce<e.length;ce++){var ie=e[ce],me=Array.isArray(U)?U[ce-1]:U.type,be=z.parse(ie,1+Q.length,me);if(!be){ee=!0;break}Q.push(be)}if(!ee)if(Array.isArray(U)&&U.length!==Q.length)z.error("Expected "+U.length+" arguments, but found "+Q.length+" instead.");else{for(var ke=0;ke<Q.length;ke++){var Ie=Array.isArray(U)?U[ke]:U.type,Pe=Q[ke];z.concat(ke+1).checkSubtype(Ie,Pe.type)}if(z.errors.length===0)return new Ti(l,m,q,Q)}}if(S.length===1)(i=t.errors).push.apply(i,z.errors);else{for(var je=(S.length?S:x).map(function(bt){var nt;return nt=bt[0],Array.isArray(nt)?"("+nt.map(Jt).join(", ")+")":"("+Jt(nt.type)+"...)"}).join(" | "),Qe=[],mt=1;mt<e.length;mt++){var rt=t.parse(e[mt],1+Qe.length);if(!rt)return null;Qe.push(Jt(rt.type))}t.error("Expected arguments of type "+je+", but found ("+Qe.join(", ")+") instead.")}return null},Ti.register=function(e,t){for(var i in Ti.definitions=t,t)e[i]=Ti};var Jn=function(e,t,i){this.type=Vt,this.locale=i,this.caseSensitive=e,this.diacriticSensitive=t};function Zi(e,t){e[0]=Math.min(e[0],t[0]),e[1]=Math.min(e[1],t[1]),e[2]=Math.max(e[2],t[0]),e[3]=Math.max(e[3],t[1])}function xa(e,t){return!(e[0]<=t[0]||e[2]>=t[2]||e[1]<=t[1]||e[3]>=t[3])}function ss(e,t){var i=(180+e[0])/360,l=(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+e[1]*Math.PI/360)))/360,p=Math.pow(2,t.z);return[Math.round(i*p*8192),Math.round(l*p*8192)]}function Ol(e,t,i){return t[1]>e[1]!=i[1]>e[1]&&e[0]<(i[0]-t[0])*(e[1]-t[1])/(i[1]-t[1])+t[0]}function po(e,t){for(var i,l,p,m,x,S,z,A=!1,C=0,B=t.length;C<B;C++)for(var U=t[C],q=0,Q=U.length;q<Q-1;q++){if((m=(i=e)[0]-(l=U[q])[0])*(z=i[1]-(p=U[q+1])[1])-(S=i[0]-p[0])*(x=i[1]-l[1])==0&&m*S<=0&&x*z<=0)return!1;Ol(e,U[q],U[q+1])&&(A=!A)}return A}function Fl(e,t){for(var i=0;i<t.length;i++)if(po(e,t[i]))return!0;return!1}function Fo(e,t,i,l){var p=l[0]-i[0],m=l[1]-i[1],x=(e[0]-i[0])*m-p*(e[1]-i[1]),S=(t[0]-i[0])*m-p*(t[1]-i[1]);return x>0&&S<0||x<0&&S>0}function Nl(e,t,i){for(var l=0,p=i;l<p.length;l+=1)for(var m=p[l],x=0;x<m.length-1;++x)if((B=[(C=m[x+1])[0]-(A=m[x])[0],C[1]-A[1]])[0]*(U=[(z=t)[0]-(S=e)[0],z[1]-S[1]])[1]-B[1]*U[0]!=0&&Fo(S,z,A,C)&&Fo(A,C,S,z))return!0;var S,z,A,C,B,U;return!1}function No(e,t){for(var i=0;i<e.length;++i)if(!po(e[i],t))return!1;for(var l=0;l<e.length-1;++l)if(Nl(e[l],e[l+1],t))return!1;return!0}function Ns(e,t){for(var i=0;i<t.length;i++)if(No(e,t[i]))return!0;return!1}function qa(e,t,i){for(var l=[],p=0;p<e.length;p++){for(var m=[],x=0;x<e[p].length;x++){var S=ss(e[p][x],i);Zi(t,S),m.push(S)}l.push(m)}return l}function ls(e,t,i){for(var l=[],p=0;p<e.length;p++){var m=qa(e[p],t,i);l.push(m)}return l}function fo(e,t,i,l){if(e[0]<i[0]||e[0]>i[2]){var p=.5*l,m=e[0]-i[0]>p?-l:i[0]-e[0]>p?l:0;m===0&&(m=e[0]-i[2]>p?-l:i[2]-e[0]>p?l:0),e[0]+=m}Zi(t,e)}function Us(e,t,i,l){for(var p=8192*Math.pow(2,l.z),m=[8192*l.x,8192*l.y],x=[],S=0,z=e;S<z.length;S+=1)for(var A=0,C=z[S];A<C.length;A+=1){var B=C[A],U=[B.x+m[0],B.y+m[1]];fo(U,t,i,p),x.push(U)}return x}function Za(e,t,i,l){for(var p,m=8192*Math.pow(2,l.z),x=[8192*l.x,8192*l.y],S=[],z=0,A=e;z<A.length;z+=1){for(var C=[],B=0,U=A[z];B<U.length;B+=1){var q=U[B],Q=[q.x+x[0],q.y+x[1]];Zi(t,Q),C.push(Q)}S.push(C)}if(t[2]-t[0]<=m/2){(p=t)[0]=p[1]=1/0,p[2]=p[3]=-1/0;for(var ee=0,ce=S;ee<ce.length;ee+=1)for(var ie=0,me=ce[ee];ie<me.length;ie+=1)fo(me[ie],t,i,m)}return S}Jn.parse=function(e,t){if(e.length!==2)return t.error("Expected one argument.");var i=e[1];if(typeof i!="object"||Array.isArray(i))return t.error("Collator options argument must be an object.");var l=t.parse(i["case-sensitive"]!==void 0&&i["case-sensitive"],1,Fe);if(!l)return null;var p=t.parse(i["diacritic-sensitive"]!==void 0&&i["diacritic-sensitive"],1,Fe);if(!p)return null;var m=null;return i.locale&&!(m=t.parse(i.locale,1,We))?null:new Jn(l,p,m)},Jn.prototype.evaluate=function(e){return new si(this.caseSensitive.evaluate(e),this.diacriticSensitive.evaluate(e),this.locale?this.locale.evaluate(e):null)},Jn.prototype.eachChild=function(e){e(this.caseSensitive),e(this.diacriticSensitive),this.locale&&e(this.locale)},Jn.prototype.outputDefined=function(){return!1},Jn.prototype.serialize=function(){var e={};return e["case-sensitive"]=this.caseSensitive.serialize(),e["diacritic-sensitive"]=this.diacriticSensitive.serialize(),this.locale&&(e.locale=this.locale.serialize()),["collator",e]};var Fn=function(e,t){this.type=Fe,this.geojson=e,this.geometries=t};function wa(e){if(e instanceof Ti&&(e.name==="get"&&e.args.length===1||e.name==="feature-state"||e.name==="has"&&e.args.length===1||e.name==="properties"||e.name==="geometry-type"||e.name==="id"||/^filter-/.test(e.name))||e instanceof Fn)return!1;var t=!0;return e.eachChild(function(i){t&&!wa(i)&&(t=!1)}),t}function ye(e){if(e instanceof Ti&&e.name==="feature-state")return!1;var t=!0;return e.eachChild(function(i){t&&!ye(i)&&(t=!1)}),t}function hn(e,t){if(e instanceof Ti&&t.indexOf(e.name)>=0)return!1;var i=!0;return e.eachChild(function(l){i&&!hn(l,t)&&(i=!1)}),i}Fn.parse=function(e,t){if(e.length!==2)return t.error("'within' expression requires exactly one argument, but found "+(e.length-1)+" instead.");if(ga(e[1])){var i=e[1];if(i.type==="FeatureCollection")for(var l=0;l<i.features.length;++l){var p=i.features[l].geometry.type;if(p==="Polygon"||p==="MultiPolygon")return new Fn(i,i.features[l].geometry)}else if(i.type==="Feature"){var m=i.geometry.type;if(m==="Polygon"||m==="MultiPolygon")return new Fn(i,i.geometry)}else if(i.type==="Polygon"||i.type==="MultiPolygon")return new Fn(i,i)}return t.error("'within' expression requires valid geojson object that contains polygon geometry type.")},Fn.prototype.evaluate=function(e){if(e.geometry()!=null&&e.canonicalID()!=null){if(e.geometryType()==="Point")return function(t,i){var l=[1/0,1/0,-1/0,-1/0],p=[1/0,1/0,-1/0,-1/0],m=t.canonicalID();if(i.type==="Polygon"){var x=qa(i.coordinates,p,m),S=Us(t.geometry(),l,p,m);if(!xa(l,p))return!1;for(var z=0,A=S;z<A.length;z+=1)if(!po(A[z],x))return!1}if(i.type==="MultiPolygon"){var C=ls(i.coordinates,p,m),B=Us(t.geometry(),l,p,m);if(!xa(l,p))return!1;for(var U=0,q=B;U<q.length;U+=1)if(!Fl(q[U],C))return!1}return!0}(e,this.geometries);if(e.geometryType()==="LineString")return function(t,i){var l=[1/0,1/0,-1/0,-1/0],p=[1/0,1/0,-1/0,-1/0],m=t.canonicalID();if(i.type==="Polygon"){var x=qa(i.coordinates,p,m),S=Za(t.geometry(),l,p,m);if(!xa(l,p))return!1;for(var z=0,A=S;z<A.length;z+=1)if(!No(A[z],x))return!1}if(i.type==="MultiPolygon"){var C=ls(i.coordinates,p,m),B=Za(t.geometry(),l,p,m);if(!xa(l,p))return!1;for(var U=0,q=B;U<q.length;U+=1)if(!Ns(q[U],C))return!1}return!0}(e,this.geometries)}return!1},Fn.prototype.eachChild=function(){},Fn.prototype.outputDefined=function(){return!0},Fn.prototype.serialize=function(){return["within",this.geojson]};var Gi=function(e,t){this.type=t.type,this.name=e,this.boundExpression=t};Gi.parse=function(e,t){if(e.length!==2||typeof e[1]!="string")return t.error("'var' expression requires exactly one string literal argument.");var i=e[1];return t.scope.has(i)?new Gi(i,t.scope.get(i)):t.error('Unknown variable "'+i+'". Make sure "'+i+'" has been bound in an enclosing "let" expression before using it.',1)},Gi.prototype.evaluate=function(e){return this.boundExpression.evaluate(e)},Gi.prototype.eachChild=function(){},Gi.prototype.outputDefined=function(){return!1},Gi.prototype.serialize=function(){return["var",this.name]};var Wr=function(e,t,i,l,p){t===void 0&&(t=[]),l===void 0&&(l=new et),p===void 0&&(p=[]),this.registry=e,this.path=t,this.key=t.map(function(m){return"["+m+"]"}).join(""),this.scope=l,this.errors=p,this.expectedType=i};function ka(e,t){for(var i,l=e.length-1,p=0,m=l,x=0;p<=m;)if((i=e[x=Math.floor((p+m)/2)])<=t){if(x===l||t<e[x+1])return x;p=x+1}else{if(!(i>t))throw new li("Input is not a number.");m=x-1}return 0}Wr.prototype.parse=function(e,t,i,l,p){return p===void 0&&(p={}),t?this.concat(t,i,l)._parse(e,p):this._parse(e,p)},Wr.prototype._parse=function(e,t){function i(A,C,B){return B==="assert"?new Lr(C,[A]):B==="coerce"?new Ei(C,[A]):A}if(e!==null&&typeof e!="string"&&typeof e!="boolean"&&typeof e!="number"||(e=["literal",e]),Array.isArray(e)){if(e.length===0)return this.error('Expected an array with at least one element. If you wanted a literal array, use ["literal", []].');var l=e[0];if(typeof l!="string")return this.error("Expression name must be a string, but found "+typeof l+' instead. If you wanted a literal array, use ["literal", [...]].',0),null;var p=this.registry[l];if(p){var m=p.parse(e,this);if(!m)return null;if(this.expectedType){var x=this.expectedType,S=m.type;if(x.kind!=="string"&&x.kind!=="number"&&x.kind!=="boolean"&&x.kind!=="object"&&x.kind!=="array"||S.kind!=="value")if(x.kind!=="color"&&x.kind!=="formatted"&&x.kind!=="resolvedImage"||S.kind!=="value"&&S.kind!=="string"){if(this.checkSubtype(x,S))return null}else m=i(m,x,t.typeAnnotation||"coerce");else m=i(m,x,t.typeAnnotation||"assert")}if(!(m instanceof Si)&&m.type.kind!=="resolvedImage"&&function A(C){if(C instanceof Gi)return A(C.boundExpression);if(C instanceof Ti&&C.name==="error"||C instanceof Jn||C instanceof Fn)return!1;var B=C instanceof Ei||C instanceof Lr,U=!0;return C.eachChild(function(q){U=B?U&&A(q):U&&q instanceof Si}),!!U&&wa(C)&&hn(C,["zoom","heatmap-density","line-progress","accumulated","is-supported-script"])}(m)){var z=new qi;try{m=new Si(m.type,m.evaluate(z))}catch(A){return this.error(A.message),null}}return m}return this.error('Unknown expression "'+l+'". If you wanted a literal array, use ["literal", [...]].',0)}return this.error(e===void 0?"'undefined' value invalid. Use null instead.":typeof e=="object"?'Bare objects invalid. Use ["literal", {...}] instead.':"Expected an array, but found "+typeof e+" instead.")},Wr.prototype.concat=function(e,t,i){var l=typeof e=="number"?this.path.concat(e):this.path,p=i?this.scope.concat(i):this.scope;return new Wr(this.registry,l,t||null,p,this.errors)},Wr.prototype.error=function(e){for(var t=[],i=arguments.length-1;i-- >0;)t[i]=arguments[i+1];var l=""+this.key+t.map(function(p){return"["+p+"]"}).join("");this.errors.push(new ve(l,e))},Wr.prototype.checkSubtype=function(e,t){var i=$t(e,t);return i&&this.error(i),i};var Nn=function(e,t,i){this.type=e,this.input=t,this.labels=[],this.outputs=[];for(var l=0,p=i;l<p.length;l+=1){var m=p[l],x=m[1];this.labels.push(m[0]),this.outputs.push(x)}};function xi(e,t,i){return e*(1-i)+t*i}Nn.parse=function(e,t){if(e.length-1<4)return t.error("Expected at least 4 arguments, but found only "+(e.length-1)+".");if((e.length-1)%2!=0)return t.error("Expected an even number of arguments.");var i=t.parse(e[1],1,Se);if(!i)return null;var l=[],p=null;t.expectedType&&t.expectedType.kind!=="value"&&(p=t.expectedType);for(var m=1;m<e.length;m+=2){var x=m===1?-1/0:e[m],S=e[m+1],z=m,A=m+1;if(typeof x!="number")return t.error('Input/output pairs for "step" expressions must be defined using literal numeric values (not computed expressions) for the input values.',z);if(l.length&&l[l.length-1][0]>=x)return t.error('Input/output pairs for "step" expressions must be arranged with input values in strictly ascending order.',z);var C=t.parse(S,A,p);if(!C)return null;p=p||C.type,l.push([x,C])}return new Nn(p,i,l)},Nn.prototype.evaluate=function(e){var t=this.labels,i=this.outputs;if(t.length===1)return i[0].evaluate(e);var l=this.input.evaluate(e);if(l<=t[0])return i[0].evaluate(e);var p=t.length;return l>=t[p-1]?i[p-1].evaluate(e):i[ka(t,l)].evaluate(e)},Nn.prototype.eachChild=function(e){e(this.input);for(var t=0,i=this.outputs;t<i.length;t+=1)e(i[t])},Nn.prototype.outputDefined=function(){return this.outputs.every(function(e){return e.outputDefined()})},Nn.prototype.serialize=function(){for(var e=["step",this.input.serialize()],t=0;t<this.labels.length;t++)t>0&&e.push(this.labels[t]),e.push(this.outputs[t].serialize());return e};var Uo=Object.freeze({__proto__:null,number:xi,color:function(e,t,i){return new tr(xi(e.r,t.r,i),xi(e.g,t.g,i),xi(e.b,t.b,i),xi(e.a,t.a,i))},array:function(e,t,i){return e.map(function(l,p){return xi(l,t[p],i)})}}),ic=6/29*3*(6/29),Uh=Math.PI/180,Vh=180/Math.PI;function Ul(e){return e>.008856451679035631?Math.pow(e,1/3):e/ic+4/29}function Vl(e){return e>6/29?e*e*e:ic*(e-4/29)}function jl(e){return 255*(e<=.0031308?12.92*e:1.055*Math.pow(e,1/2.4)-.055)}function ql(e){return(e/=255)<=.04045?e/12.92:Math.pow((e+.055)/1.055,2.4)}function nc(e){var t=ql(e.r),i=ql(e.g),l=ql(e.b),p=Ul((.4124564*t+.3575761*i+.1804375*l)/.95047),m=Ul((.2126729*t+.7151522*i+.072175*l)/1);return{l:116*m-16,a:500*(p-m),b:200*(m-Ul((.0193339*t+.119192*i+.9503041*l)/1.08883)),alpha:e.a}}function ac(e){var t=(e.l+16)/116,i=isNaN(e.a)?t:t+e.a/500,l=isNaN(e.b)?t:t-e.b/200;return t=1*Vl(t),i=.95047*Vl(i),l=1.08883*Vl(l),new tr(jl(3.2404542*i-1.5371385*t-.4985314*l),jl(-.969266*i+1.8760108*t+.041556*l),jl(.0556434*i-.2040259*t+1.0572252*l),e.alpha)}function jh(e,t,i){var l=t-e;return e+i*(l>180||l<-180?l-360*Math.round(l/360):l)}var us={forward:nc,reverse:ac,interpolate:function(e,t,i){return{l:xi(e.l,t.l,i),a:xi(e.a,t.a,i),b:xi(e.b,t.b,i),alpha:xi(e.alpha,t.alpha,i)}}},cs={forward:function(e){var t=nc(e),i=t.l,l=t.a,p=t.b,m=Math.atan2(p,l)*Vh;return{h:m<0?m+360:m,c:Math.sqrt(l*l+p*p),l:i,alpha:e.a}},reverse:function(e){var t=e.h*Uh,i=e.c;return ac({l:e.l,a:Math.cos(t)*i,b:Math.sin(t)*i,alpha:e.alpha})},interpolate:function(e,t,i){return{h:jh(e.h,t.h,i),c:xi(e.c,t.c,i),l:xi(e.l,t.l,i),alpha:xi(e.alpha,t.alpha,i)}}},oc=Object.freeze({__proto__:null,lab:us,hcl:cs}),rn=function(e,t,i,l,p){this.type=e,this.operator=t,this.interpolation=i,this.input=l,this.labels=[],this.outputs=[];for(var m=0,x=p;m<x.length;m+=1){var S=x[m],z=S[1];this.labels.push(S[0]),this.outputs.push(z)}};function Zl(e,t,i,l){var p=l-i,m=e-i;return p===0?0:t===1?m/p:(Math.pow(t,m)-1)/(Math.pow(t,p)-1)}rn.interpolationFactor=function(e,t,i,l){var p=0;if(e.name==="exponential")p=Zl(t,e.base,i,l);else if(e.name==="linear")p=Zl(t,1,i,l);else if(e.name==="cubic-bezier"){var m=e.controlPoints;p=new T(m[0],m[1],m[2],m[3]).solve(Zl(t,1,i,l))}return p},rn.parse=function(e,t){var i=e[0],l=e[1],p=e[2],m=e.slice(3);if(!Array.isArray(l)||l.length===0)return t.error("Expected an interpolation type expression.",1);if(l[0]==="linear")l={name:"linear"};else if(l[0]==="exponential"){var x=l[1];if(typeof x!="number")return t.error("Exponential interpolation requires a numeric base.",1,1);l={name:"exponential",base:x}}else{if(l[0]!=="cubic-bezier")return t.error("Unknown interpolation type "+String(l[0]),1,0);var S=l.slice(1);if(S.length!==4||S.some(function(ce){return typeof ce!="number"||ce<0||ce>1}))return t.error("Cubic bezier interpolation requires four numeric arguments with values between 0 and 1.",1);l={name:"cubic-bezier",controlPoints:S}}if(e.length-1<4)return t.error("Expected at least 4 arguments, but found only "+(e.length-1)+".");if((e.length-1)%2!=0)return t.error("Expected an even number of arguments.");if(!(p=t.parse(p,2,Se)))return null;var z=[],A=null;i==="interpolate-hcl"||i==="interpolate-lab"?A=qe:t.expectedType&&t.expectedType.kind!=="value"&&(A=t.expectedType);for(var C=0;C<m.length;C+=2){var B=m[C],U=m[C+1],q=C+3,Q=C+4;if(typeof B!="number")return t.error('Input/output pairs for "interpolate" expressions must be defined using literal numeric values (not computed expressions) for the input values.',q);if(z.length&&z[z.length-1][0]>=B)return t.error('Input/output pairs for "interpolate" expressions must be arranged with input values in strictly ascending order.',q);var ee=t.parse(U,Q,A);if(!ee)return null;A=A||ee.type,z.push([B,ee])}return A.kind==="number"||A.kind==="color"||A.kind==="array"&&A.itemType.kind==="number"&&typeof A.N=="number"?new rn(A,i,l,p,z):t.error("Type "+Jt(A)+" is not interpolatable.")},rn.prototype.evaluate=function(e){var t=this.labels,i=this.outputs;if(t.length===1)return i[0].evaluate(e);var l=this.input.evaluate(e);if(l<=t[0])return i[0].evaluate(e);var p=t.length;if(l>=t[p-1])return i[p-1].evaluate(e);var m=ka(t,l),x=rn.interpolationFactor(this.interpolation,l,t[m],t[m+1]),S=i[m].evaluate(e),z=i[m+1].evaluate(e);return this.operator==="interpolate"?Uo[this.type.kind.toLowerCase()](S,z,x):this.operator==="interpolate-hcl"?cs.reverse(cs.interpolate(cs.forward(S),cs.forward(z),x)):us.reverse(us.interpolate(us.forward(S),us.forward(z),x))},rn.prototype.eachChild=function(e){e(this.input);for(var t=0,i=this.outputs;t<i.length;t+=1)e(i[t])},rn.prototype.outputDefined=function(){return this.outputs.every(function(e){return e.outputDefined()})},rn.prototype.serialize=function(){var e;e=this.interpolation.name==="linear"?["linear"]:this.interpolation.name==="exponential"?this.interpolation.base===1?["linear"]:["exponential",this.interpolation.base]:["cubic-bezier"].concat(this.interpolation.controlPoints);for(var t=[this.operator,e,this.input.serialize()],i=0;i<this.labels.length;i++)t.push(this.labels[i],this.outputs[i].serialize());return t};var Ga=function(e,t){this.type=e,this.args=t};Ga.parse=function(e,t){if(e.length<2)return t.error("Expectected at least one argument.");var i=null,l=t.expectedType;l&&l.kind!=="value"&&(i=l);for(var p=[],m=0,x=e.slice(1);m<x.length;m+=1){var S=t.parse(x[m],1+p.length,i,void 0,{typeAnnotation:"omit"});if(!S)return null;i=i||S.type,p.push(S)}var z=l&&p.some(function(A){return $t(l,A.type)});return new Ga(z?Ze:i,p)},Ga.prototype.evaluate=function(e){for(var t,i=null,l=0,p=0,m=this.args;p<m.length&&(l++,(i=m[p].evaluate(e))&&i instanceof Di&&!i.available&&(t||(t=i.name),i=null,l===this.args.length&&(i=t)),i===null);p+=1);return i},Ga.prototype.eachChild=function(e){this.args.forEach(e)},Ga.prototype.outputDefined=function(){return this.args.every(function(e){return e.outputDefined()})},Ga.prototype.serialize=function(){var e=["coalesce"];return this.eachChild(function(t){e.push(t.serialize())}),e};var Ka=function(e,t){this.type=t.type,this.bindings=[].concat(e),this.result=t};Ka.prototype.evaluate=function(e){return this.result.evaluate(e)},Ka.prototype.eachChild=function(e){for(var t=0,i=this.bindings;t<i.length;t+=1)e(i[t][1]);e(this.result)},Ka.parse=function(e,t){if(e.length<4)return t.error("Expected at least 3 arguments, but found "+(e.length-1)+" instead.");for(var i=[],l=1;l<e.length-1;l+=2){var p=e[l];if(typeof p!="string")return t.error("Expected string, but found "+typeof p+" instead.",l);if(/[^a-zA-Z0-9_]/.test(p))return t.error("Variable names must contain only alphanumeric characters or '_'.",l);var m=t.parse(e[l+1],l+1);if(!m)return null;i.push([p,m])}var x=t.parse(e[e.length-1],e.length-1,t.expectedType,i);return x?new Ka(i,x):null},Ka.prototype.outputDefined=function(){return this.result.outputDefined()},Ka.prototype.serialize=function(){for(var e=["let"],t=0,i=this.bindings;t<i.length;t+=1){var l=i[t];e.push(l[0],l[1].serialize())}return e.push(this.result.serialize()),e};var mo=function(e,t,i){this.type=e,this.index=t,this.input=i};mo.parse=function(e,t){if(e.length!==3)return t.error("Expected 2 arguments, but found "+(e.length-1)+" instead.");var i=t.parse(e[1],1,Se),l=t.parse(e[2],2,er(t.expectedType||Ze));return i&&l?new mo(l.type.itemType,i,l):null},mo.prototype.evaluate=function(e){var t=this.index.evaluate(e),i=this.input.evaluate(e);if(t<0)throw new li("Array index out of bounds: "+t+" < 0.");if(t>=i.length)throw new li("Array index out of bounds: "+t+" > "+(i.length-1)+".");if(t!==Math.floor(t))throw new li("Array index must be an integer, but found "+t+" instead.");return i[t]},mo.prototype.eachChild=function(e){e(this.index),e(this.input)},mo.prototype.outputDefined=function(){return!1},mo.prototype.serialize=function(){return["at",this.index.serialize(),this.input.serialize()]};var yo=function(e,t){this.type=Fe,this.needle=e,this.haystack=t};yo.parse=function(e,t){if(e.length!==3)return t.error("Expected 2 arguments, but found "+(e.length-1)+" instead.");var i=t.parse(e[1],1,Ze),l=t.parse(e[2],2,Ze);return i&&l?vr(i.type,[Fe,We,Se,Ye,Ze])?new yo(i,l):t.error("Expected first argument to be of type boolean, string, number or null, but found "+Jt(i.type)+" instead"):null},yo.prototype.evaluate=function(e){var t=this.needle.evaluate(e),i=this.haystack.evaluate(e);if(!i)return!1;if(!fr(t,["boolean","string","number","null"]))throw new li("Expected first argument to be of type boolean, string, number or null, but found "+Jt(Xr(t))+" instead.");if(!fr(i,["string","array"]))throw new li("Expected second argument to be of type array or string, but found "+Jt(Xr(i))+" instead.");return i.indexOf(t)>=0},yo.prototype.eachChild=function(e){e(this.needle),e(this.haystack)},yo.prototype.outputDefined=function(){return!0},yo.prototype.serialize=function(){return["in",this.needle.serialize(),this.haystack.serialize()]};var Xa=function(e,t,i){this.type=Se,this.needle=e,this.haystack=t,this.fromIndex=i};Xa.parse=function(e,t){if(e.length<=2||e.length>=5)return t.error("Expected 3 or 4 arguments, but found "+(e.length-1)+" instead.");var i=t.parse(e[1],1,Ze),l=t.parse(e[2],2,Ze);if(!i||!l)return null;if(!vr(i.type,[Fe,We,Se,Ye,Ze]))return t.error("Expected first argument to be of type boolean, string, number or null, but found "+Jt(i.type)+" instead");if(e.length===4){var p=t.parse(e[3],3,Se);return p?new Xa(i,l,p):null}return new Xa(i,l)},Xa.prototype.evaluate=function(e){var t=this.needle.evaluate(e),i=this.haystack.evaluate(e);if(!fr(t,["boolean","string","number","null"]))throw new li("Expected first argument to be of type boolean, string, number or null, but found "+Jt(Xr(t))+" instead.");if(!fr(i,["string","array"]))throw new li("Expected second argument to be of type array or string, but found "+Jt(Xr(i))+" instead.");if(this.fromIndex){var l=this.fromIndex.evaluate(e);return i.indexOf(t,l)}return i.indexOf(t)},Xa.prototype.eachChild=function(e){e(this.needle),e(this.haystack),this.fromIndex&&e(this.fromIndex)},Xa.prototype.outputDefined=function(){return!1},Xa.prototype.serialize=function(){if(this.fromIndex!=null&&this.fromIndex!==void 0){var e=this.fromIndex.serialize();return["index-of",this.needle.serialize(),this.haystack.serialize(),e]}return["index-of",this.needle.serialize(),this.haystack.serialize()]};var _o=function(e,t,i,l,p,m){this.inputType=e,this.type=t,this.input=i,this.cases=l,this.outputs=p,this.otherwise=m};_o.parse=function(e,t){if(e.length<5)return t.error("Expected at least 4 arguments, but found only "+(e.length-1)+".");if(e.length%2!=1)return t.error("Expected an even number of arguments.");var i,l;t.expectedType&&t.expectedType.kind!=="value"&&(l=t.expectedType);for(var p={},m=[],x=2;x<e.length-1;x+=2){var S=e[x],z=e[x+1];Array.isArray(S)||(S=[S]);var A=t.concat(x);if(S.length===0)return A.error("Expected at least one branch label.");for(var C=0,B=S;C<B.length;C+=1){var U=B[C];if(typeof U!="number"&&typeof U!="string")return A.error("Branch labels must be numbers or strings.");if(typeof U=="number"&&Math.abs(U)>Number.MAX_SAFE_INTEGER)return A.error("Branch labels must be integers no larger than "+Number.MAX_SAFE_INTEGER+".");if(typeof U=="number"&&Math.floor(U)!==U)return A.error("Numeric branch labels must be integer values.");if(i){if(A.checkSubtype(i,Xr(U)))return null}else i=Xr(U);if(p[String(U)]!==void 0)return A.error("Branch labels must be unique.");p[String(U)]=m.length}var q=t.parse(z,x,l);if(!q)return null;l=l||q.type,m.push(q)}var Q=t.parse(e[1],1,Ze);if(!Q)return null;var ee=t.parse(e[e.length-1],e.length-1,l);return ee?Q.type.kind!=="value"&&t.concat(1).checkSubtype(i,Q.type)?null:new _o(i,l,Q,p,m,ee):null},_o.prototype.evaluate=function(e){var t=this.input.evaluate(e);return(Xr(t)===this.inputType&&this.outputs[this.cases[t]]||this.otherwise).evaluate(e)},_o.prototype.eachChild=function(e){e(this.input),this.outputs.forEach(e),e(this.otherwise)},_o.prototype.outputDefined=function(){return this.outputs.every(function(e){return e.outputDefined()})&&this.otherwise.outputDefined()},_o.prototype.serialize=function(){for(var e=this,t=["match",this.input.serialize()],i=[],l={},p=0,m=Object.keys(this.cases).sort();p<m.length;p+=1){var x=m[p];(B=l[this.cases[x]])===void 0?(l[this.cases[x]]=i.length,i.push([this.cases[x],[x]])):i[B][1].push(x)}for(var S=function(q){return e.inputType.kind==="number"?Number(q):q},z=0,A=i;z<A.length;z+=1){var C=A[z],B=C[0],U=C[1];t.push(U.length===1?S(U[0]):U.map(S)),t.push(this.outputs[outputIndex$1].serialize())}return t.push(this.otherwise.serialize()),t};var go=function(e,t,i){this.type=e,this.branches=t,this.otherwise=i};go.parse=function(e,t){if(e.length<4)return t.error("Expected at least 3 arguments, but found only "+(e.length-1)+".");if(e.length%2!=0)return t.error("Expected an odd number of arguments.");var i;t.expectedType&&t.expectedType.kind!=="value"&&(i=t.expectedType);for(var l=[],p=1;p<e.length-1;p+=2){var m=t.parse(e[p],p,Fe);if(!m)return null;var x=t.parse(e[p+1],p+1,i);if(!x)return null;l.push([m,x]),i=i||x.type}var S=t.parse(e[e.length-1],e.length-1,i);return S?new go(i,l,S):null},go.prototype.evaluate=function(e){for(var t=0,i=this.branches;t<i.length;t+=1){var l=i[t],p=l[1];if(l[0].evaluate(e))return p.evaluate(e)}return this.otherwise.evaluate(e)},go.prototype.eachChild=function(e){for(var t=0,i=this.branches;t<i.length;t+=1){var l=i[t],p=l[1];e(l[0]),e(p)}e(this.otherwise)},go.prototype.outputDefined=function(){return this.branches.every(function(e){return e[1].outputDefined()})&&this.otherwise.outputDefined()},go.prototype.serialize=function(){var e=["case"];return this.eachChild(function(t){e.push(t.serialize())}),e};var Wa=function(e,t,i,l){this.type=e,this.input=t,this.beginIndex=i,this.endIndex=l};function sc(e,t){return e==="=="||e==="!="?t.kind==="boolean"||t.kind==="string"||t.kind==="number"||t.kind==="null"||t.kind==="value":t.kind==="string"||t.kind==="number"||t.kind==="value"}function lc(e,t,i,l){return l.compare(t,i)===0}function Br(e,t,i){var l=e!=="=="&&e!=="!=";return function(){function p(m,x,S){this.type=Fe,this.lhs=m,this.rhs=x,this.collator=S,this.hasUntypedArgument=m.type.kind==="value"||x.type.kind==="value"}return p.parse=function(m,x){if(m.length!==3&&m.length!==4)return x.error("Expected two or three arguments.");var S=m[0],z=x.parse(m[1],1,Ze);if(!z)return null;if(!sc(S,z.type))return x.concat(1).error('"'+S+`" comparisons are not supported for type '`+Jt(z.type)+"'.");var A=x.parse(m[2],2,Ze);if(!A)return null;if(!sc(S,A.type))return x.concat(2).error('"'+S+`" comparisons are not supported for type '`+Jt(A.type)+"'.");if(z.type.kind!==A.type.kind&&z.type.kind!=="value"&&A.type.kind!=="value")return x.error("Cannot compare types '"+Jt(z.type)+"' and '"+Jt(A.type)+"'.");l&&(z.type.kind==="value"&&A.type.kind!=="value"?z=new Lr(A.type,[z]):z.type.kind!=="value"&&A.type.kind==="value"&&(A=new Lr(z.type,[A])));var C=null;if(m.length===4){if(z.type.kind!=="string"&&A.type.kind!=="string"&&z.type.kind!=="value"&&A.type.kind!=="value")return x.error("Cannot use collator to compare non-string types.");if(!(C=x.parse(m[3],3,Vt)))return null}return new p(z,A,C)},p.prototype.evaluate=function(m){var x=this.lhs.evaluate(m),S=this.rhs.evaluate(m);if(l&&this.hasUntypedArgument){var z=Xr(x),A=Xr(S);if(z.kind!==A.kind||z.kind!=="string"&&z.kind!=="number")throw new li('Expected arguments for "'+e+'" to be (string, string) or (number, number), but found ('+z.kind+", "+A.kind+") instead.")}if(this.collator&&!l&&this.hasUntypedArgument){var C=Xr(x),B=Xr(S);if(C.kind!=="string"||B.kind!=="string")return t(m,x,S)}return this.collator?i(m,x,S,this.collator.evaluate(m)):t(m,x,S)},p.prototype.eachChild=function(m){m(this.lhs),m(this.rhs),this.collator&&m(this.collator)},p.prototype.outputDefined=function(){return!0},p.prototype.serialize=function(){var m=[e];return this.eachChild(function(x){m.push(x.serialize())}),m},p}()}Wa.parse=function(e,t){if(e.length<=2||e.length>=5)return t.error("Expected 3 or 4 arguments, but found "+(e.length-1)+" instead.");var i=t.parse(e[1],1,Ze),l=t.parse(e[2],2,Se);if(!i||!l)return null;if(!vr(i.type,[er(Ze),We,Ze]))return t.error("Expected first argument to be of type array or string, but found "+Jt(i.type)+" instead");if(e.length===4){var p=t.parse(e[3],3,Se);return p?new Wa(i.type,i,l,p):null}return new Wa(i.type,i,l)},Wa.prototype.evaluate=function(e){var t=this.input.evaluate(e),i=this.beginIndex.evaluate(e);if(!fr(t,["string","array"]))throw new li("Expected first argument to be of type array or string, but found "+Jt(Xr(t))+" instead.");if(this.endIndex){var l=this.endIndex.evaluate(e);return t.slice(i,l)}return t.slice(i)},Wa.prototype.eachChild=function(e){e(this.input),e(this.beginIndex),this.endIndex&&e(this.endIndex)},Wa.prototype.outputDefined=function(){return!1},Wa.prototype.serialize=function(){if(this.endIndex!=null&&this.endIndex!==void 0){var e=this.endIndex.serialize();return["slice",this.input.serialize(),this.beginIndex.serialize(),e]}return["slice",this.input.serialize(),this.beginIndex.serialize()]};var qh=Br("==",function(e,t,i){return t===i},lc),Vs=Br("!=",function(e,t,i){return t!==i},function(e,t,i,l){return!lc(0,t,i,l)}),uc=Br("<",function(e,t,i){return t<i},function(e,t,i,l){return l.compare(t,i)<0}),cc=Br(">",function(e,t,i){return t>i},function(e,t,i,l){return l.compare(t,i)>0}),hc=Br("<=",function(e,t,i){return t<=i},function(e,t,i,l){return l.compare(t,i)<=0}),pc=Br(">=",function(e,t,i){return t>=i},function(e,t,i,l){return l.compare(t,i)>=0}),vo=function(e,t,i,l,p){this.type=We,this.number=e,this.locale=t,this.currency=i,this.minFractionDigits=l,this.maxFractionDigits=p};vo.parse=function(e,t){if(e.length!==3)return t.error("Expected two arguments.");var i=t.parse(e[1],1,Se);if(!i)return null;var l=e[2];if(typeof l!="object"||Array.isArray(l))return t.error("NumberFormat options argument must be an object.");var p=null;if(l.locale&&!(p=t.parse(l.locale,1,We)))return null;var m=null;if(l.currency&&!(m=t.parse(l.currency,1,We)))return null;var x=null;if(l["min-fraction-digits"]&&!(x=t.parse(l["min-fraction-digits"],1,Se)))return null;var S=null;return l["max-fraction-digits"]&&!(S=t.parse(l["max-fraction-digits"],1,Se))?null:new vo(i,p,m,x,S)},vo.prototype.evaluate=function(e){return new Intl.NumberFormat(this.locale?this.locale.evaluate(e):[],{style:this.currency?"currency":"decimal",currency:this.currency?this.currency.evaluate(e):void 0,minimumFractionDigits:this.minFractionDigits?this.minFractionDigits.evaluate(e):void 0,maximumFractionDigits:this.maxFractionDigits?this.maxFractionDigits.evaluate(e):void 0}).format(this.number.evaluate(e))},vo.prototype.eachChild=function(e){e(this.number),this.locale&&e(this.locale),this.currency&&e(this.currency),this.minFractionDigits&&e(this.minFractionDigits),this.maxFractionDigits&&e(this.maxFractionDigits)},vo.prototype.outputDefined=function(){return!1},vo.prototype.serialize=function(){var e={};return this.locale&&(e.locale=this.locale.serialize()),this.currency&&(e.currency=this.currency.serialize()),this.minFractionDigits&&(e["min-fraction-digits"]=this.minFractionDigits.serialize()),this.maxFractionDigits&&(e["max-fraction-digits"]=this.maxFractionDigits.serialize()),["number-format",this.number.serialize(),e]};var Ha=function(e){this.type=Se,this.input=e};Ha.parse=function(e,t){if(e.length!==2)return t.error("Expected 1 argument, but found "+(e.length-1)+" instead.");var i=t.parse(e[1],1);return i?i.type.kind!=="array"&&i.type.kind!=="string"&&i.type.kind!=="value"?t.error("Expected argument of type string or array, but found "+Jt(i.type)+" instead."):new Ha(i):null},Ha.prototype.evaluate=function(e){var t=this.input.evaluate(e);if(typeof t=="string"||Array.isArray(t))return t.length;throw new li("Expected value to be of type string or array, but found "+Jt(Xr(t))+" instead.")},Ha.prototype.eachChild=function(e){e(this.input)},Ha.prototype.outputDefined=function(){return!1},Ha.prototype.serialize=function(){var e=["length"];return this.eachChild(function(t){e.push(t.serialize())}),e};var bo={"==":qh,"!=":Vs,">":cc,"<":uc,">=":pc,"<=":hc,array:Lr,at:mo,boolean:Lr,case:go,coalesce:Ga,collator:Jn,format:On,image:xn,in:yo,"index-of":Xa,interpolate:rn,"interpolate-hcl":rn,"interpolate-lab":rn,length:Ha,let:Ka,literal:Si,match:_o,number:Lr,"number-format":vo,object:Lr,slice:Wa,step:Nn,string:Lr,"to-boolean":Ei,"to-color":Ei,"to-number":Ei,"to-string":Ei,var:Gi,within:Fn};function fc(e,t){var i=t[0],l=t[1],p=t[2],m=t[3];i=i.evaluate(e),l=l.evaluate(e),p=p.evaluate(e);var x=m?m.evaluate(e):1,S=ja(i,l,p,x);if(S)throw new li(S);return new tr(i/255*x,l/255*x,p/255*x,x)}function dc(e,t){return e in t}function Gl(e,t){var i=t[e];return i===void 0?null:i}function xo(e){return{type:e}}function mc(e){return{result:"success",value:e}}function wo(e){return{result:"error",value:e}}function ko(e){return e["property-type"]==="data-driven"||e["property-type"]==="cross-faded-data-driven"}function yc(e){return!!e.expression&&e.expression.parameters.indexOf("zoom")>-1}function hs(e){return!!e.expression&&e.expression.interpolated}function Vr(e){return e instanceof Number?"number":e instanceof String?"string":e instanceof Boolean?"boolean":Array.isArray(e)?"array":e===null?"null":typeof e}function js(e){return typeof e=="object"&&e!==null&&!Array.isArray(e)}function Zh(e){return e}function Vo(e,t,i){return e!==void 0?e:t!==void 0?t:i!==void 0?i:void 0}function _c(e,t,i,l,p){return Vo(typeof i===p?l[i]:void 0,e.default,t.default)}function Gh(e,t,i){if(Vr(i)!=="number")return Vo(e.default,t.default);var l=e.stops.length;if(l===1||i<=e.stops[0][0])return e.stops[0][1];if(i>=e.stops[l-1][0])return e.stops[l-1][1];var p=ka(e.stops.map(function(m){return m[0]}),i);return e.stops[p][1]}function gc(e,t,i){var l=e.base!==void 0?e.base:1;if(Vr(i)!=="number")return Vo(e.default,t.default);var p=e.stops.length;if(p===1||i<=e.stops[0][0])return e.stops[0][1];if(i>=e.stops[p-1][0])return e.stops[p-1][1];var m=ka(e.stops.map(function(B){return B[0]}),i),x=function(B,U,q,Q){var ee=Q-q,ce=B-q;return ee===0?0:U===1?ce/ee:(Math.pow(U,ce)-1)/(Math.pow(U,ee)-1)}(i,l,e.stops[m][0],e.stops[m+1][0]),S=e.stops[m][1],z=e.stops[m+1][1],A=Uo[t.type]||Zh;if(e.colorSpace&&e.colorSpace!=="rgb"){var C=oc[e.colorSpace];A=function(B,U){return C.reverse(C.interpolate(C.forward(B),C.forward(U),x))}}return typeof S.evaluate=="function"?{evaluate:function(){for(var B=[],U=arguments.length;U--;)B[U]=arguments[U];var q=S.evaluate.apply(void 0,B),Q=z.evaluate.apply(void 0,B);if(q!==void 0&&Q!==void 0)return A(q,Q,x)}}:A(S,z,x)}function qs(e,t,i){return t.type==="color"?i=tr.parse(i):t.type==="formatted"?i=xr.fromString(i.toString()):t.type==="resolvedImage"?i=Di.fromString(i.toString()):Vr(i)===t.type||t.type==="enum"&&t.values[i]||(i=void 0),Vo(i,e.default,t.default)}Ti.register(bo,{error:[{kind:"error"},[We],function(e,t){throw new li(t[0].evaluate(e))}],typeof:[We,[Ze],function(e,t){return Jt(Xr(t[0].evaluate(e)))}],"to-rgba":[er(Se,4),[qe],function(e,t){return t[0].evaluate(e).toArray()}],rgb:[qe,[Se,Se,Se],fc],rgba:[qe,[Se,Se,Se,Se],fc],has:{type:Fe,overloads:[[[We],function(e,t){return dc(t[0].evaluate(e),e.properties())}],[[We,Mt],function(e,t){var i=t[1];return dc(t[0].evaluate(e),i.evaluate(e))}]]},get:{type:Ze,overloads:[[[We],function(e,t){return Gl(t[0].evaluate(e),e.properties())}],[[We,Mt],function(e,t){var i=t[1];return Gl(t[0].evaluate(e),i.evaluate(e))}]]},"feature-state":[Ze,[We],function(e,t){return Gl(t[0].evaluate(e),e.featureState||{})}],properties:[Mt,[],function(e){return e.properties()}],"geometry-type":[We,[],function(e){return e.geometryType()}],id:[Ze,[],function(e){return e.id()}],zoom:[Se,[],function(e){return e.globals.zoom}],"heatmap-density":[Se,[],function(e){return e.globals.heatmapDensity||0}],"line-progress":[Se,[],function(e){return e.globals.lineProgress||0}],accumulated:[Ze,[],function(e){return e.globals.accumulated===void 0?null:e.globals.accumulated}],"+":[Se,xo(Se),function(e,t){for(var i=0,l=0,p=t;l<p.length;l+=1)i+=p[l].evaluate(e);return i}],"*":[Se,xo(Se),function(e,t){for(var i=1,l=0,p=t;l<p.length;l+=1)i*=p[l].evaluate(e);return i}],"-":{type:Se,overloads:[[[Se,Se],function(e,t){var i=t[1];return t[0].evaluate(e)-i.evaluate(e)}],[[Se],function(e,t){return-t[0].evaluate(e)}]]},"/":[Se,[Se,Se],function(e,t){var i=t[1];return t[0].evaluate(e)/i.evaluate(e)}],"%":[Se,[Se,Se],function(e,t){var i=t[1];return t[0].evaluate(e)%i.evaluate(e)}],ln2:[Se,[],function(){return Math.LN2}],pi:[Se,[],function(){return Math.PI}],e:[Se,[],function(){return Math.E}],"^":[Se,[Se,Se],function(e,t){var i=t[1];return Math.pow(t[0].evaluate(e),i.evaluate(e))}],sqrt:[Se,[Se],function(e,t){return Math.sqrt(t[0].evaluate(e))}],log10:[Se,[Se],function(e,t){return Math.log(t[0].evaluate(e))/Math.LN10}],ln:[Se,[Se],function(e,t){return Math.log(t[0].evaluate(e))}],log2:[Se,[Se],function(e,t){return Math.log(t[0].evaluate(e))/Math.LN2}],sin:[Se,[Se],function(e,t){return Math.sin(t[0].evaluate(e))}],cos:[Se,[Se],function(e,t){return Math.cos(t[0].evaluate(e))}],tan:[Se,[Se],function(e,t){return Math.tan(t[0].evaluate(e))}],asin:[Se,[Se],function(e,t){return Math.asin(t[0].evaluate(e))}],acos:[Se,[Se],function(e,t){return Math.acos(t[0].evaluate(e))}],atan:[Se,[Se],function(e,t){return Math.atan(t[0].evaluate(e))}],min:[Se,xo(Se),function(e,t){return Math.min.apply(Math,t.map(function(i){return i.evaluate(e)}))}],max:[Se,xo(Se),function(e,t){return Math.max.apply(Math,t.map(function(i){return i.evaluate(e)}))}],abs:[Se,[Se],function(e,t){return Math.abs(t[0].evaluate(e))}],round:[Se,[Se],function(e,t){var i=t[0].evaluate(e);return i<0?-Math.round(-i):Math.round(i)}],floor:[Se,[Se],function(e,t){return Math.floor(t[0].evaluate(e))}],ceil:[Se,[Se],function(e,t){return Math.ceil(t[0].evaluate(e))}],"filter-==":[Fe,[We,Ze],function(e,t){var i=t[0],l=t[1];return e.properties()[i.value]===l.value}],"filter-id-==":[Fe,[Ze],function(e,t){var i=t[0];return e.id()===i.value}],"filter-type-==":[Fe,[We],function(e,t){var i=t[0];return e.geometryType()===i.value}],"filter-<":[Fe,[We,Ze],function(e,t){var i=t[0],l=t[1],p=e.properties()[i.value],m=l.value;return typeof p==typeof m&&p<m}],"filter-id-<":[Fe,[Ze],function(e,t){var i=t[0],l=e.id(),p=i.value;return typeof l==typeof p&&l<p}],"filter->":[Fe,[We,Ze],function(e,t){var i=t[0],l=t[1],p=e.properties()[i.value],m=l.value;return typeof p==typeof m&&p>m}],"filter-id->":[Fe,[Ze],function(e,t){var i=t[0],l=e.id(),p=i.value;return typeof l==typeof p&&l>p}],"filter-<=":[Fe,[We,Ze],function(e,t){var i=t[0],l=t[1],p=e.properties()[i.value],m=l.value;return typeof p==typeof m&&p<=m}],"filter-id-<=":[Fe,[Ze],function(e,t){var i=t[0],l=e.id(),p=i.value;return typeof l==typeof p&&l<=p}],"filter->=":[Fe,[We,Ze],function(e,t){var i=t[0],l=t[1],p=e.properties()[i.value],m=l.value;return typeof p==typeof m&&p>=m}],"filter-id->=":[Fe,[Ze],function(e,t){var i=t[0],l=e.id(),p=i.value;return typeof l==typeof p&&l>=p}],"filter-has":[Fe,[Ze],function(e,t){return t[0].value in e.properties()}],"filter-has-id":[Fe,[],function(e){return e.id()!==null&&e.id()!==void 0}],"filter-type-in":[Fe,[er(We)],function(e,t){return t[0].value.indexOf(e.geometryType())>=0}],"filter-id-in":[Fe,[er(Ze)],function(e,t){return t[0].value.indexOf(e.id())>=0}],"filter-in-small":[Fe,[We,er(Ze)],function(e,t){var i=t[0];return t[1].value.indexOf(e.properties()[i.value])>=0}],"filter-in-large":[Fe,[We,er(Ze)],function(e,t){var i=t[0],l=t[1];return function(p,m,x,S){for(;x<=S;){var z=x+S>>1;if(m[z]===p)return!0;m[z]>p?S=z-1:x=z+1}return!1}(e.properties()[i.value],l.value,0,l.value.length-1)}],all:{type:Fe,overloads:[[[Fe,Fe],function(e,t){var i=t[1];return t[0].evaluate(e)&&i.evaluate(e)}],[xo(Fe),function(e,t){for(var i=0,l=t;i<l.length;i+=1)if(!l[i].evaluate(e))return!1;return!0}]]},any:{type:Fe,overloads:[[[Fe,Fe],function(e,t){var i=t[1];return t[0].evaluate(e)||i.evaluate(e)}],[xo(Fe),function(e,t){for(var i=0,l=t;i<l.length;i+=1)if(l[i].evaluate(e))return!0;return!1}]]},"!":[Fe,[Fe],function(e,t){return!t[0].evaluate(e)}],"is-supported-script":[Fe,[We],function(e,t){var i=e.globals&&e.globals.isSupportedScript;return!i||i(t[0].evaluate(e))}],upcase:[We,[We],function(e,t){return t[0].evaluate(e).toUpperCase()}],downcase:[We,[We],function(e,t){return t[0].evaluate(e).toLowerCase()}],concat:[We,xo(Ze),function(e,t){return t.map(function(i){return va(i.evaluate(e))}).join("")}],"resolved-locale":[We,[Vt],function(e,t){return t[0].evaluate(e).resolvedLocale()}]});var jo=function(e,t){this.expression=e,this._warningHistory={},this._evaluator=new qi,this._defaultValue=t?function(i){return i.type==="color"&&js(i.default)?new tr(0,0,0,0):i.type==="color"?tr.parse(i.default)||null:i.default===void 0?null:i.default}(t):null,this._enumValues=t&&t.type==="enum"?t.values:null};function ps(e){return Array.isArray(e)&&e.length>0&&typeof e[0]=="string"&&e[0]in bo}function Zs(e,t){var i=new Wr(bo,[],t?function(p){var m={color:qe,string:We,number:Se,enum:We,boolean:Fe,formatted:lr,resolvedImage:Pt};return p.type==="array"?er(m[p.value]||Ze,p.length):m[p.type]}(t):void 0),l=i.parse(e,void 0,void 0,void 0,t&&t.type==="string"?{typeAnnotation:"coerce"}:void 0);return l?mc(new jo(l,t)):wo(i.errors)}jo.prototype.evaluateWithoutErrorHandling=function(e,t,i,l,p,m){return this._evaluator.globals=e,this._evaluator.feature=t,this._evaluator.featureState=i,this._evaluator.canonical=l,this._evaluator.availableImages=p||null,this._evaluator.formattedSection=m,this.expression.evaluate(this._evaluator)},jo.prototype.evaluate=function(e,t,i,l,p,m){this._evaluator.globals=e,this._evaluator.feature=t||null,this._evaluator.featureState=i||null,this._evaluator.canonical=l,this._evaluator.availableImages=p||null,this._evaluator.formattedSection=m||null;try{var x=this.expression.evaluate(this._evaluator);if(x==null||typeof x=="number"&&x!=x)return this._defaultValue;if(this._enumValues&&!(x in this._enumValues))throw new li("Expected value to be one of "+Object.keys(this._enumValues).map(function(S){return JSON.stringify(S)}).join(", ")+", but found "+JSON.stringify(x)+" instead.");return x}catch(S){return this._warningHistory[S.message]||(this._warningHistory[S.message]=!0,typeof console<"u"&&console.warn(S.message)),this._defaultValue}};var fs=function(e,t){this.kind=e,this._styleExpression=t,this.isStateDependent=e!=="constant"&&!ye(t.expression)};fs.prototype.evaluateWithoutErrorHandling=function(e,t,i,l,p,m){return this._styleExpression.evaluateWithoutErrorHandling(e,t,i,l,p,m)},fs.prototype.evaluate=function(e,t,i,l,p,m){return this._styleExpression.evaluate(e,t,i,l,p,m)};var qo=function(e,t,i,l){this.kind=e,this.zoomStops=i,this._styleExpression=t,this.isStateDependent=e!=="camera"&&!ye(t.expression),this.interpolationType=l};function vc(e,t){if((e=Zs(e,t)).result==="error")return e;var i=e.value.expression,l=wa(i);if(!l&&!ko(t))return wo([new ve("","data expressions not supported")]);var p=hn(i,["zoom"]);if(!p&&!yc(t))return wo([new ve("","zoom expressions not supported")]);var m=function x(S){var z=null;if(S instanceof Ka)z=x(S.result);else if(S instanceof Ga)for(var A=0,C=S.args;A<C.length&&!(z=x(C[A]));A+=1);else(S instanceof Nn||S instanceof rn)&&S.input instanceof Ti&&S.input.name==="zoom"&&(z=S);return z instanceof ve||S.eachChild(function(B){var U=x(B);U instanceof ve?z=U:!z&&U?z=new ve("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.'):z&&U&&z!==U&&(z=new ve("",'Only one zoom-based "step" or "interpolate" subexpression may be used in an expression.'))}),z}(i);return m||p?m instanceof ve?wo([m]):m instanceof rn&&!hs(t)?wo([new ve("",'"interpolate" expressions cannot be used with this property')]):mc(m?new qo(l?"camera":"composite",e.value,m.labels,m instanceof rn?m.interpolation:void 0):new fs(l?"constant":"source",e.value)):wo([new ve("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.')])}qo.prototype.evaluateWithoutErrorHandling=function(e,t,i,l,p,m){return this._styleExpression.evaluateWithoutErrorHandling(e,t,i,l,p,m)},qo.prototype.evaluate=function(e,t,i,l,p,m){return this._styleExpression.evaluate(e,t,i,l,p,m)},qo.prototype.interpolationFactor=function(e,t,i){return this.interpolationType?rn.interpolationFactor(this.interpolationType,e,t,i):0};var Zo=function(e,t){this._parameters=e,this._specification=t,Ce(this,function i(l,p){var m,x,S,z=p.type==="color",A=l.stops&&typeof l.stops[0][0]=="object",C=A||!(A||l.property!==void 0),B=l.type||(hs(p)?"exponential":"interval");if(z&&((l=Ce({},l)).stops&&(l.stops=l.stops.map(function(rt){return[rt[0],tr.parse(rt[1])]})),l.default=tr.parse(l.default?l.default:p.default)),l.colorSpace&&l.colorSpace!=="rgb"&&!oc[l.colorSpace])throw new Error("Unknown color space: "+l.colorSpace);if(B==="exponential")m=gc;else if(B==="interval")m=Gh;else if(B==="categorical"){m=_c,x=Object.create(null);for(var U=0,q=l.stops;U<q.length;U+=1){var Q=q[U];x[Q[0]]=Q[1]}S=typeof l.stops[0][0]}else{if(B!=="identity")throw new Error('Unknown function type "'+B+'"');m=qs}if(A){for(var ee={},ce=[],ie=0;ie<l.stops.length;ie++){var me=l.stops[ie],be=me[0].zoom;ee[be]===void 0&&(ee[be]={zoom:be,type:l.type,property:l.property,default:l.default,stops:[]},ce.push(be)),ee[be].stops.push([me[0].value,me[1]])}for(var ke=[],Ie=0,Pe=ce;Ie<Pe.length;Ie+=1){var je=Pe[Ie];ke.push([ee[je].zoom,i(ee[je],p)])}var Qe={name:"linear"};return{kind:"composite",interpolationType:Qe,interpolationFactor:rn.interpolationFactor.bind(void 0,Qe),zoomStops:ke.map(function(rt){return rt[0]}),evaluate:function(rt,bt){var nt=rt.zoom;return gc({stops:ke,base:l.base},p,nt).evaluate(nt,bt)}}}if(C){var mt=B==="exponential"?{name:"exponential",base:l.base!==void 0?l.base:1}:null;return{kind:"camera",interpolationType:mt,interpolationFactor:rn.interpolationFactor.bind(void 0,mt),zoomStops:l.stops.map(function(rt){return rt[0]}),evaluate:function(rt){return m(l,p,rt.zoom,x,S)}}}return{kind:"source",evaluate:function(rt,bt){var nt=bt&&bt.properties?bt.properties[l.property]:void 0;return nt===void 0?Vo(l.default,p.default):m(l,p,nt,x,S)}}}(this._parameters,this._specification))};function pa(e){var t=e.key,i=e.value,l=e.valueSpec||{},p=e.objectElementValidators||{},m=e.style,x=e.styleSpec,S=[],z=Vr(i);if(z!=="object")return[new J(t,i,"object expected, "+z+" found")];for(var A in i){var C=A.split(".")[0],B=l[C]||l["*"],U=void 0;if(p[C])U=p[C];else if(l[C])U=dr;else if(p["*"])U=p["*"];else{if(!l["*"]){S.push(new J(t,i[A],'unknown property "'+A+'"'));continue}U=dr}S=S.concat(U({key:(t&&t+".")+A,value:i[A],valueSpec:B,style:m,styleSpec:x,object:i,objectKey:A},i))}for(var q in l)p[q]||l[q].required&&l[q].default===void 0&&i[q]===void 0&&S.push(new J(t,i,'missing required property "'+q+'"'));return S}function bc(e){var t=e.value,i=e.valueSpec,l=e.style,p=e.styleSpec,m=e.key,x=e.arrayElementValidator||dr;if(Vr(t)!=="array")return[new J(m,t,"array expected, "+Vr(t)+" found")];if(i.length&&t.length!==i.length)return[new J(m,t,"array length "+i.length+" expected, length "+t.length+" found")];if(i["min-length"]&&t.length<i["min-length"])return[new J(m,t,"array length at least "+i["min-length"]+" expected, length "+t.length+" found")];var S={type:i.value,values:i.values};p.$version<7&&(S.function=i.function),Vr(i.value)==="object"&&(S=i.value);for(var z=[],A=0;A<t.length;A++)z=z.concat(x({array:t,arrayIndex:A,value:t[A],valueSpec:S,style:l,styleSpec:p,key:m+"["+A+"]"}));return z}function xc(e){var t=e.key,i=e.value,l=e.valueSpec,p=Vr(i);return p==="number"&&i!=i&&(p="NaN"),p!=="number"?[new J(t,i,"number expected, "+p+" found")]:"minimum"in l&&i<l.minimum?[new J(t,i,i+" is less than the minimum value "+l.minimum)]:"maximum"in l&&i>l.maximum?[new J(t,i,i+" is greater than the maximum value "+l.maximum)]:[]}function wc(e){var t,i,l,p=e.valueSpec,m=Me(e.value.type),x={},S=m!=="categorical"&&e.value.property===void 0,z=!S,A=Vr(e.value.stops)==="array"&&Vr(e.value.stops[0])==="array"&&Vr(e.value.stops[0][0])==="object",C=pa({key:e.key,value:e.value,valueSpec:e.styleSpec.function,style:e.style,styleSpec:e.styleSpec,objectElementValidators:{stops:function(q){if(m==="identity")return[new J(q.key,q.value,'identity function may not have a "stops" property')];var Q=[],ee=q.value;return Q=Q.concat(bc({key:q.key,value:ee,valueSpec:q.valueSpec,style:q.style,styleSpec:q.styleSpec,arrayElementValidator:B})),Vr(ee)==="array"&&ee.length===0&&Q.push(new J(q.key,ee,"array must have at least one stop")),Q},default:function(q){return dr({key:q.key,value:q.value,valueSpec:p,style:q.style,styleSpec:q.styleSpec})}}});return m==="identity"&&S&&C.push(new J(e.key,e.value,'missing required property "property"')),m==="identity"||e.value.stops||C.push(new J(e.key,e.value,'missing required property "stops"')),m==="exponential"&&e.valueSpec.expression&&!hs(e.valueSpec)&&C.push(new J(e.key,e.value,"exponential functions not supported")),e.styleSpec.$version>=8&&(z&&!ko(e.valueSpec)?C.push(new J(e.key,e.value,"property functions not supported")):S&&!yc(e.valueSpec)&&C.push(new J(e.key,e.value,"zoom functions not supported"))),m!=="categorical"&&!A||e.value.property!==void 0||C.push(new J(e.key,e.value,'"property" property is required')),C;function B(q){var Q=[],ee=q.value,ce=q.key;if(Vr(ee)!=="array")return[new J(ce,ee,"array expected, "+Vr(ee)+" found")];if(ee.length!==2)return[new J(ce,ee,"array length 2 expected, length "+ee.length+" found")];if(A){if(Vr(ee[0])!=="object")return[new J(ce,ee,"object expected, "+Vr(ee[0])+" found")];if(ee[0].zoom===void 0)return[new J(ce,ee,"object stop key must have zoom")];if(ee[0].value===void 0)return[new J(ce,ee,"object stop key must have value")];if(l&&l>Me(ee[0].zoom))return[new J(ce,ee[0].zoom,"stop zoom values must appear in ascending order")];Me(ee[0].zoom)!==l&&(l=Me(ee[0].zoom),i=void 0,x={}),Q=Q.concat(pa({key:ce+"[0]",value:ee[0],valueSpec:{zoom:{}},style:q.style,styleSpec:q.styleSpec,objectElementValidators:{zoom:xc,value:U}}))}else Q=Q.concat(U({key:ce+"[0]",value:ee[0],valueSpec:{},style:q.style,styleSpec:q.styleSpec},ee));return ps(K(ee[1]))?Q.concat([new J(ce+"[1]",ee[1],"expressions are not allowed in function stops.")]):Q.concat(dr({key:ce+"[1]",value:ee[1],valueSpec:p,style:q.style,styleSpec:q.styleSpec}))}function U(q,Q){var ee=Vr(q.value),ce=Me(q.value),ie=q.value!==null?q.value:Q;if(t){if(ee!==t)return[new J(q.key,ie,ee+" stop domain type must match previous stop domain type "+t)]}else t=ee;if(ee!=="number"&&ee!=="string"&&ee!=="boolean")return[new J(q.key,ie,"stop domain value must be a number, string, or boolean")];if(ee!=="number"&&m!=="categorical"){var me="number expected, "+ee+" found";return ko(p)&&m===void 0&&(me+='\nIf you intended to use a categorical function, specify `"type": "categorical"`.'),[new J(q.key,ie,me)]}return m!=="categorical"||ee!=="number"||isFinite(ce)&&Math.floor(ce)===ce?m!=="categorical"&&ee==="number"&&i!==void 0&&ce<i?[new J(q.key,ie,"stop domain values must appear in ascending order")]:(i=ce,m==="categorical"&&ce in x?[new J(q.key,ie,"stop domain values must be unique")]:(x[ce]=!0,[])):[new J(q.key,ie,"integer expected, found "+ce)]}}function So(e){var t=(e.expressionContext==="property"?vc:Zs)(K(e.value),e.valueSpec);if(t.result==="error")return t.value.map(function(l){return new J(""+e.key+l.key,e.value,l.message)});var i=t.value.expression||t.value._styleExpression.expression;if(e.expressionContext==="property"&&e.propertyKey==="text-font"&&!i.outputDefined())return[new J(e.key,e.value,'Invalid data expression for "'+e.propertyKey+'". Output values must be contained as literals within the expression.')];if(e.expressionContext==="property"&&e.propertyType==="layout"&&!ye(i))return[new J(e.key,e.value,'"feature-state" data expressions are not supported with layout properties.')];if(e.expressionContext==="filter"&&!ye(i))return[new J(e.key,e.value,'"feature-state" data expressions are not supported with filters.')];if(e.expressionContext&&e.expressionContext.indexOf("cluster")===0){if(!hn(i,["zoom","feature-state"]))return[new J(e.key,e.value,'"zoom" and "feature-state" expressions are not supported with cluster properties.')];if(e.expressionContext==="cluster-initial"&&!wa(i))return[new J(e.key,e.value,"Feature data expressions are not supported with initial expression part of cluster properties.")]}return[]}function ds(e){var t=e.key,i=e.value,l=e.valueSpec,p=[];return Array.isArray(l.values)?l.values.indexOf(Me(i))===-1&&p.push(new J(t,i,"expected one of ["+l.values.join(", ")+"], "+JSON.stringify(i)+" found")):Object.keys(l.values).indexOf(Me(i))===-1&&p.push(new J(t,i,"expected one of ["+Object.keys(l.values).join(", ")+"], "+JSON.stringify(i)+" found")),p}function Gs(e){if(e===!0||e===!1)return!0;if(!Array.isArray(e)||e.length===0)return!1;switch(e[0]){case"has":return e.length>=2&&e[1]!=="$id"&&e[1]!=="$type";case"in":return e.length>=3&&(typeof e[1]!="string"||Array.isArray(e[2]));case"!in":case"!has":case"none":return!1;case"==":case"!=":case">":case">=":case"<":case"<=":return e.length!==3||Array.isArray(e[1])||Array.isArray(e[2]);case"any":case"all":for(var t=0,i=e.slice(1);t<i.length;t+=1){var l=i[t];if(!Gs(l)&&typeof l!="boolean")return!1}return!0;default:return!0}}Zo.deserialize=function(e){return new Zo(e._parameters,e._specification)},Zo.serialize=function(e){return{_parameters:e._parameters,_specification:e._specification}};var Kl={type:"boolean",default:!1,transition:!1,"property-type":"data-driven",expression:{interpolated:!1,parameters:["zoom","feature"]}};function Ks(e){if(e==null)return{filter:function(){return!0},needGeometry:!1};Gs(e)||(e=Xs(e));var t=Zs(e,Kl);if(t.result==="error")throw new Error(t.value.map(function(i){return i.key+": "+i.message}).join(", "));return{filter:function(i,l,p){return t.value.evaluate(i,l,{},p)},needGeometry:function i(l){if(!Array.isArray(l))return!1;if(l[0]==="within")return!0;for(var p=1;p<l.length;p++)if(i(l[p]))return!0;return!1}(e)}}function Kh(e,t){return e<t?-1:e>t?1:0}function Xs(e){if(!e)return!0;var t,i=e[0];return e.length<=1?i!=="any":i==="=="?Xl(e[1],e[2],"=="):i==="!="?Ws(Xl(e[1],e[2],"==")):i==="<"||i===">"||i==="<="||i===">="?Xl(e[1],e[2],i):i==="any"?(t=e.slice(1),["any"].concat(t.map(Xs))):i==="all"?["all"].concat(e.slice(1).map(Xs)):i==="none"?["all"].concat(e.slice(1).map(Xs).map(Ws)):i==="in"?kc(e[1],e.slice(2)):i==="!in"?Ws(kc(e[1],e.slice(2))):i==="has"?Sc(e[1]):i==="!has"?Ws(Sc(e[1])):i!=="within"||e}function Xl(e,t,i){switch(e){case"$type":return["filter-type-"+i,t];case"$id":return["filter-id-"+i,t];default:return["filter-"+i,e,t]}}function kc(e,t){if(t.length===0)return!1;switch(e){case"$type":return["filter-type-in",["literal",t]];case"$id":return["filter-id-in",["literal",t]];default:return t.length>200&&!t.some(function(i){return typeof i!=typeof t[0]})?["filter-in-large",e,["literal",t.sort(Kh)]]:["filter-in-small",e,["literal",t]]}}function Sc(e){switch(e){case"$type":return!0;case"$id":return["filter-has-id"];default:return["filter-has",e]}}function Ws(e){return["!",e]}function Wl(e){return Gs(K(e.value))?So(Ce({},e,{expressionContext:"filter",valueSpec:{value:"boolean"}})):function t(i){var l=i.value,p=i.key;if(Vr(l)!=="array")return[new J(p,l,"array expected, "+Vr(l)+" found")];var m,x=i.styleSpec,S=[];if(l.length<1)return[new J(p,l,"filter array must have at least 1 element")];switch(S=S.concat(ds({key:p+"[0]",value:l[0],valueSpec:x.filter_operator,style:i.style,styleSpec:i.styleSpec})),Me(l[0])){case"<":case"<=":case">":case">=":l.length>=2&&Me(l[1])==="$type"&&S.push(new J(p,l,'"$type" cannot be use with operator "'+l[0]+'"'));case"==":case"!=":l.length!==3&&S.push(new J(p,l,'filter array for operator "'+l[0]+'" must have 3 elements'));case"in":case"!in":l.length>=2&&(m=Vr(l[1]))!=="string"&&S.push(new J(p+"[1]",l[1],"string expected, "+m+" found"));for(var z=2;z<l.length;z++)m=Vr(l[z]),Me(l[1])==="$type"?S=S.concat(ds({key:p+"["+z+"]",value:l[z],valueSpec:x.geometry_type,style:i.style,styleSpec:i.styleSpec})):m!=="string"&&m!=="number"&&m!=="boolean"&&S.push(new J(p+"["+z+"]",l[z],"string, number, or boolean expected, "+m+" found"));break;case"any":case"all":case"none":for(var A=1;A<l.length;A++)S=S.concat(t({key:p+"["+A+"]",value:l[A],style:i.style,styleSpec:i.styleSpec}));break;case"has":case"!has":m=Vr(l[1]),l.length!==2?S.push(new J(p,l,'filter array for "'+l[0]+'" operator must have 2 elements')):m!=="string"&&S.push(new J(p+"[1]",l[1],"string expected, "+m+" found"));break;case"within":m=Vr(l[1]),l.length!==2?S.push(new J(p,l,'filter array for "'+l[0]+'" operator must have 2 elements')):m!=="object"&&S.push(new J(p+"[1]",l[1],"object expected, "+m+" found"))}return S}(e)}function Hl(e,t){var i=e.key,l=e.style,p=e.styleSpec,m=e.value,x=e.objectKey,S=p[t+"_"+e.layerType];if(!S)return[];var z=x.match(/^(.*)-transition$/);if(t==="paint"&&z&&S[z[1]]&&S[z[1]].transition)return dr({key:i,value:m,valueSpec:p.transition,style:l,styleSpec:p});var A,C=e.valueSpec||S[x];if(!C)return[new J(i,m,'unknown property "'+x+'"')];if(Vr(m)==="string"&&ko(C)&&!C.tokens&&(A=/^{([^}]+)}$/.exec(m)))return[new J(i,m,'"'+x+'" does not support interpolation syntax\nUse an identity property function instead: `{ "type": "identity", "property": '+JSON.stringify(A[1])+" }`.")];var B=[];return e.layerType==="symbol"&&(x==="text-field"&&l&&!l.glyphs&&B.push(new J(i,m,'use of "text-field" requires a style "glyphs" property')),x==="text-font"&&js(K(m))&&Me(m.type)==="identity"&&B.push(new J(i,m,'"text-font" does not support identity functions'))),B.concat(dr({key:e.key,value:m,valueSpec:C,style:l,styleSpec:p,expressionContext:"property",propertyType:t,propertyKey:x}))}function Jl(e){return Hl(e,"paint")}function ms(e){return Hl(e,"layout")}function Ec(e){var t=[],i=e.value,l=e.key,p=e.style,m=e.styleSpec;i.type||i.ref||t.push(new J(l,i,'either "type" or "ref" is required'));var x,S=Me(i.type),z=Me(i.ref);if(i.id)for(var A=Me(i.id),C=0;C<e.arrayIndex;C++){var B=p.layers[C];Me(B.id)===A&&t.push(new J(l,i.id,'duplicate layer id "'+i.id+'", previously used at line '+B.id.__line__))}if("ref"in i)["type","source","source-layer","filter","layout"].forEach(function(Q){Q in i&&t.push(new J(l,i[Q],'"'+Q+'" is prohibited for ref layers'))}),p.layers.forEach(function(Q){Me(Q.id)===z&&(x=Q)}),x?x.ref?t.push(new J(l,i.ref,"ref cannot reference another ref layer")):S=Me(x.type):t.push(new J(l,i.ref,'ref layer "'+z+'" not found'));else if(S!=="background")if(i.source){var U=p.sources&&p.sources[i.source],q=U&&Me(U.type);U?q==="vector"&&S==="raster"?t.push(new J(l,i.source,'layer "'+i.id+'" requires a raster source')):q==="raster"&&S!=="raster"?t.push(new J(l,i.source,'layer "'+i.id+'" requires a vector source')):q!=="vector"||i["source-layer"]?q==="raster-dem"&&S!=="hillshade"?t.push(new J(l,i.source,"raster-dem source can only be used with layer type 'hillshade'.")):S!=="line"||!i.paint||!i.paint["line-gradient"]||q==="geojson"&&U.lineMetrics||t.push(new J(l,i,'layer "'+i.id+'" specifies a line-gradient, which requires a GeoJSON source with `lineMetrics` enabled.')):t.push(new J(l,i,'layer "'+i.id+'" must specify a "source-layer"')):t.push(new J(l,i.source,'source "'+i.source+'" not found'))}else t.push(new J(l,i,'missing required property "source"'));return t=t.concat(pa({key:l,value:i,valueSpec:m.layer,style:e.style,styleSpec:e.styleSpec,objectElementValidators:{"*":function(){return[]},type:function(){return dr({key:l+".type",value:i.type,valueSpec:m.layer.type,style:e.style,styleSpec:e.styleSpec,object:i,objectKey:"type"})},filter:Wl,layout:function(Q){return pa({layer:i,key:Q.key,value:Q.value,style:Q.style,styleSpec:Q.styleSpec,objectElementValidators:{"*":function(ee){return ms(Ce({layerType:S},ee))}}})},paint:function(Q){return pa({layer:i,key:Q.key,value:Q.value,style:Q.style,styleSpec:Q.styleSpec,objectElementValidators:{"*":function(ee){return Jl(Ce({layerType:S},ee))}}})}}}))}function Eo(e){var t=e.value,i=e.key,l=Vr(t);return l!=="string"?[new J(i,t,"string expected, "+l+" found")]:[]}var Jr={promoteId:function(e){var t=e.key,i=e.value;if(Vr(i)==="string")return Eo({key:t,value:i});var l=[];for(var p in i)l.push.apply(l,Eo({key:t+"."+p,value:i[p]}));return l}};function Hs(e){var t=e.value,i=e.key,l=e.styleSpec,p=e.style;if(!t.type)return[new J(i,t,'"type" is required')];var m,x=Me(t.type);switch(x){case"vector":case"raster":case"raster-dem":return pa({key:i,value:t,valueSpec:l["source_"+x.replace("-","_")],style:e.style,styleSpec:l,objectElementValidators:Jr});case"geojson":if(m=pa({key:i,value:t,valueSpec:l.source_geojson,style:p,styleSpec:l,objectElementValidators:Jr}),t.cluster)for(var S in t.clusterProperties){var z=t.clusterProperties[S],A=z[0],C=typeof A=="string"?[A,["accumulated"],["get",S]]:A;m.push.apply(m,So({key:i+"."+S+".map",value:z[1],expressionContext:"cluster-map"})),m.push.apply(m,So({key:i+"."+S+".reduce",value:C,expressionContext:"cluster-reduce"}))}return m;case"video":return pa({key:i,value:t,valueSpec:l.source_video,style:p,styleSpec:l});case"image":return pa({key:i,value:t,valueSpec:l.source_image,style:p,styleSpec:l});case"canvas":return[new J(i,null,"Please use runtime APIs to add canvas sources, rather than including them in stylesheets.","source.canvas")];default:return ds({key:i+".type",value:t.type,valueSpec:{values:["vector","raster","raster-dem","geojson","video","image"]},style:p,styleSpec:l})}}function To(e){var t=e.value,i=e.styleSpec,l=i.light,p=e.style,m=[],x=Vr(t);if(t===void 0)return m;if(x!=="object")return m.concat([new J("light",t,"object expected, "+x+" found")]);for(var S in t){var z=S.match(/^(.*)-transition$/);m=m.concat(z&&l[z[1]]&&l[z[1]].transition?dr({key:S,value:t[S],valueSpec:i.transition,style:p,styleSpec:i}):l[S]?dr({key:S,value:t[S],valueSpec:l[S],style:p,styleSpec:i}):[new J(S,t[S],'unknown property "'+S+'"')])}return m}var Ja={"*":function(){return[]},array:bc,boolean:function(e){var t=e.value,i=e.key,l=Vr(t);return l!=="boolean"?[new J(i,t,"boolean expected, "+l+" found")]:[]},number:xc,color:function(e){var t=e.key,i=e.value,l=Vr(i);return l!=="string"?[new J(t,i,"color expected, "+l+" found")]:Gt(i)===null?[new J(t,i,'color expected, "'+i+'" found')]:[]},constants:_e,enum:ds,filter:Wl,function:wc,layer:Ec,object:pa,source:Hs,light:To,string:Eo,formatted:function(e){return Eo(e).length===0?[]:So(e)},resolvedImage:function(e){return Eo(e).length===0?[]:So(e)}};function dr(e){var t=e.value,i=e.valueSpec,l=e.styleSpec;return i.expression&&js(Me(t))?wc(e):i.expression&&ps(K(t))?So(e):i.type&&Ja[i.type]?Ja[i.type](e):pa(Ce({},e,{valueSpec:i.type?l[i.type]:i}))}function jr(e){var t=e.value,i=e.key,l=Eo(e);return l.length||(t.indexOf("{fontstack}")===-1&&l.push(new J(i,t,'"glyphs" url must include a "{fontstack}" token')),t.indexOf("{range}")===-1&&l.push(new J(i,t,'"glyphs" url must include a "{range}" token'))),l}function Yn(e,t){t===void 0&&(t=j);var i=[];return i=i.concat(dr({key:"",value:e,valueSpec:t.$root,styleSpec:t,style:e,objectElementValidators:{glyphs:jr,"*":function(){return[]}}})),e.constants&&(i=i.concat(_e({key:"constants",value:e.constants,style:e,styleSpec:t}))),ys(i)}function ys(e){return[].concat(e).sort(function(t,i){return t.line-i.line})}function Go(e){return function(){for(var t=[],i=arguments.length;i--;)t[i]=arguments[i];return ys(e.apply(this,t))}}Yn.source=Go(Hs),Yn.light=Go(To),Yn.layer=Go(Ec),Yn.filter=Go(Wl),Yn.paintProperty=Go(Jl),Yn.layoutProperty=Go(ms);var _s=Yn,Xh=_s.light,Wh=_s.paintProperty,gs=_s.layoutProperty;function vs(e,t){var i=!1;if(t&&t.length)for(var l=0,p=t;l<p.length;l+=1)e.fire(new se(new Error(p[l].message))),i=!0;return i}var Da=Ii;function Ii(e,t,i){var l=this.cells=[];if(e instanceof ArrayBuffer){this.arrayBuffer=e;var p=new Int32Array(this.arrayBuffer);e=p[0],this.d=(t=p[1])+2*(i=p[2]);for(var m=0;m<this.d*this.d;m++){var x=p[3+m],S=p[3+m+1];l.push(x===S?null:p.subarray(x,S))}var z=p[3+l.length+1];this.keys=p.subarray(p[3+l.length],z),this.bboxes=p.subarray(z),this.insert=this._insertReadonly}else{this.d=t+2*i;for(var A=0;A<this.d*this.d;A++)l.push([]);this.keys=[],this.bboxes=[]}this.n=t,this.extent=e,this.padding=i,this.scale=t/e,this.uid=0;var C=i/t*e;this.min=-C,this.max=e+C}Ii.prototype.insert=function(e,t,i,l,p){this._forEachCell(t,i,l,p,this._insertCell,this.uid++),this.keys.push(e),this.bboxes.push(t),this.bboxes.push(i),this.bboxes.push(l),this.bboxes.push(p)},Ii.prototype._insertReadonly=function(){throw"Cannot insert into a GridIndex created from an ArrayBuffer."},Ii.prototype._insertCell=function(e,t,i,l,p,m){this.cells[p].push(m)},Ii.prototype.query=function(e,t,i,l,p){var m=this.min,x=this.max;if(e<=m&&t<=m&&x<=i&&x<=l&&!p)return Array.prototype.slice.call(this.keys);var S=[];return this._forEachCell(e,t,i,l,this._queryCell,S,{},p),S},Ii.prototype._queryCell=function(e,t,i,l,p,m,x,S){var z=this.cells[p];if(z!==null)for(var A=this.keys,C=this.bboxes,B=0;B<z.length;B++){var U=z[B];if(x[U]===void 0){var q=4*U;(S?S(C[q+0],C[q+1],C[q+2],C[q+3]):e<=C[q+2]&&t<=C[q+3]&&i>=C[q+0]&&l>=C[q+1])?(x[U]=!0,m.push(A[U])):x[U]=!1}}},Ii.prototype._forEachCell=function(e,t,i,l,p,m,x,S){for(var z=this._convertToCellCoord(e),A=this._convertToCellCoord(t),C=this._convertToCellCoord(i),B=this._convertToCellCoord(l),U=z;U<=C;U++)for(var q=A;q<=B;q++){var Q=this.d*q+U;if((!S||S(this._convertFromCellCoord(U),this._convertFromCellCoord(q),this._convertFromCellCoord(U+1),this._convertFromCellCoord(q+1)))&&p.call(this,e,t,i,l,Q,m,x,S))return}},Ii.prototype._convertFromCellCoord=function(e){return(e-this.padding)/this.scale},Ii.prototype._convertToCellCoord=function(e){return Math.max(0,Math.min(this.d-1,Math.floor(e*this.scale)+this.padding))},Ii.prototype.toArrayBuffer=function(){if(this.arrayBuffer)return this.arrayBuffer;for(var e=this.cells,t=3+this.cells.length+1+1,i=0,l=0;l<this.cells.length;l++)i+=this.cells[l].length;var p=new Int32Array(t+i+this.keys.length+this.bboxes.length);p[0]=this.extent,p[1]=this.n,p[2]=this.padding;for(var m=t,x=0;x<e.length;x++){var S=e[x];p[3+x]=m,p.set(S,m),m+=S.length}return p[3+e.length]=m,p.set(this.keys,m),p[3+e.length+1]=m+=this.keys.length,p.set(this.bboxes,m),m+=this.bboxes.length,p.buffer};var bs=D.ImageData,Tc=D.ImageBitmap,wi={};function st(e,t,i){i===void 0&&(i={}),Object.defineProperty(t,"_classRegistryKey",{value:e,writeable:!1}),wi[e]={klass:t,omit:i.omit||[],shallow:i.shallow||[]}}for(var Un in st("Object",Object),Da.serialize=function(e,t){var i=e.toArrayBuffer();return t&&t.push(i),{buffer:i}},Da.deserialize=function(e){return new Da(e.buffer)},st("Grid",Da),st("Color",tr),st("Error",Error),st("ResolvedImage",Di),st("StylePropertyFunction",Zo),st("StyleExpression",jo,{omit:["_evaluator"]}),st("ZoomDependentExpression",qo),st("ZoomConstantExpression",fs),st("CompoundExpression",Ti,{omit:["_evaluate"]}),bo)bo[Un]._classRegistryKey||st("Expression_"+Un,bo[Un]);function Js(e){return e&&typeof ArrayBuffer<"u"&&(e instanceof ArrayBuffer||e.constructor&&e.constructor.name==="ArrayBuffer")}function Ko(e){return Tc&&e instanceof Tc}function fa(e,t){if(e==null||typeof e=="boolean"||typeof e=="number"||typeof e=="string"||e instanceof Boolean||e instanceof Number||e instanceof String||e instanceof Date||e instanceof RegExp)return e;if(Js(e)||Ko(e))return t&&t.push(e),e;if(ArrayBuffer.isView(e)){var i=e;return t&&t.push(i.buffer),i}if(e instanceof bs)return t&&t.push(e.data.buffer),e;if(Array.isArray(e)){for(var l=[],p=0,m=e;p<m.length;p+=1)l.push(fa(m[p],t));return l}if(typeof e=="object"){var x=e.constructor,S=x._classRegistryKey;if(!S)throw new Error("can't serialize object of unregistered class");var z=x.serialize?x.serialize(e,t):{};if(!x.serialize){for(var A in e)if(e.hasOwnProperty(A)&&!(wi[S].omit.indexOf(A)>=0)){var C=e[A];z[A]=wi[S].shallow.indexOf(A)>=0?C:fa(C,t)}e instanceof Error&&(z.message=e.message)}if(z.$name)throw new Error("$name property is reserved for worker serialization logic.");return S!=="Object"&&(z.$name=S),z}throw new Error("can't serialize object of type "+typeof e)}function Vn(e){if(e==null||typeof e=="boolean"||typeof e=="number"||typeof e=="string"||e instanceof Boolean||e instanceof Number||e instanceof String||e instanceof Date||e instanceof RegExp||Js(e)||Ko(e)||ArrayBuffer.isView(e)||e instanceof bs)return e;if(Array.isArray(e))return e.map(Vn);if(typeof e=="object"){var t=e.$name||"Object",i=wi[t].klass;if(!i)throw new Error("can't deserialize unregistered class "+t);if(i.deserialize)return i.deserialize(e);for(var l=Object.create(i.prototype),p=0,m=Object.keys(e);p<m.length;p+=1){var x=m[p];if(x!=="$name"){var S=e[x];l[x]=wi[t].shallow.indexOf(x)>=0?S:Vn(S)}}return l}throw new Error("can't deserialize object of type "+typeof e)}var Yl=function(){this.first=!0};Yl.prototype.update=function(e,t){var i=Math.floor(e);return this.first?(this.first=!1,this.lastIntegerZoom=i,this.lastIntegerZoomTime=0,this.lastZoom=e,this.lastFloorZoom=i,!0):(this.lastFloorZoom>i?(this.lastIntegerZoom=i+1,this.lastIntegerZoomTime=t):this.lastFloorZoom<i&&(this.lastIntegerZoom=i,this.lastIntegerZoomTime=t),e!==this.lastZoom&&(this.lastZoom=e,this.lastFloorZoom=i,!0))};var $e={"Latin-1 Supplement":function(e){return e>=128&&e<=255},Arabic:function(e){return e>=1536&&e<=1791},"Arabic Supplement":function(e){return e>=1872&&e<=1919},"Arabic Extended-A":function(e){return e>=2208&&e<=2303},"Hangul Jamo":function(e){return e>=4352&&e<=4607},"Unified Canadian Aboriginal Syllabics":function(e){return e>=5120&&e<=5759},Khmer:function(e){return e>=6016&&e<=6143},"Unified Canadian Aboriginal Syllabics Extended":function(e){return e>=6320&&e<=6399},"General Punctuation":function(e){return e>=8192&&e<=8303},"Letterlike Symbols":function(e){return e>=8448&&e<=8527},"Number Forms":function(e){return e>=8528&&e<=8591},"Miscellaneous Technical":function(e){return e>=8960&&e<=9215},"Control Pictures":function(e){return e>=9216&&e<=9279},"Optical Character Recognition":function(e){return e>=9280&&e<=9311},"Enclosed Alphanumerics":function(e){return e>=9312&&e<=9471},"Geometric Shapes":function(e){return e>=9632&&e<=9727},"Miscellaneous Symbols":function(e){return e>=9728&&e<=9983},"Miscellaneous Symbols and Arrows":function(e){return e>=11008&&e<=11263},"CJK Radicals Supplement":function(e){return e>=11904&&e<=12031},"Kangxi Radicals":function(e){return e>=12032&&e<=12255},"Ideographic Description Characters":function(e){return e>=12272&&e<=12287},"CJK Symbols and Punctuation":function(e){return e>=12288&&e<=12351},Hiragana:function(e){return e>=12352&&e<=12447},Katakana:function(e){return e>=12448&&e<=12543},Bopomofo:function(e){return e>=12544&&e<=12591},"Hangul Compatibility Jamo":function(e){return e>=12592&&e<=12687},Kanbun:function(e){return e>=12688&&e<=12703},"Bopomofo Extended":function(e){return e>=12704&&e<=12735},"CJK Strokes":function(e){return e>=12736&&e<=12783},"Katakana Phonetic Extensions":function(e){return e>=12784&&e<=12799},"Enclosed CJK Letters and Months":function(e){return e>=12800&&e<=13055},"CJK Compatibility":function(e){return e>=13056&&e<=13311},"CJK Unified Ideographs Extension A":function(e){return e>=13312&&e<=19903},"Yijing Hexagram Symbols":function(e){return e>=19904&&e<=19967},"CJK Unified Ideographs":function(e){return e>=19968&&e<=40959},"Yi Syllables":function(e){return e>=40960&&e<=42127},"Yi Radicals":function(e){return e>=42128&&e<=42191},"Hangul Jamo Extended-A":function(e){return e>=43360&&e<=43391},"Hangul Syllables":function(e){return e>=44032&&e<=55215},"Hangul Jamo Extended-B":function(e){return e>=55216&&e<=55295},"Private Use Area":function(e){return e>=57344&&e<=63743},"CJK Compatibility Ideographs":function(e){return e>=63744&&e<=64255},"Arabic Presentation Forms-A":function(e){return e>=64336&&e<=65023},"Vertical Forms":function(e){return e>=65040&&e<=65055},"CJK Compatibility Forms":function(e){return e>=65072&&e<=65103},"Small Form Variants":function(e){return e>=65104&&e<=65135},"Arabic Presentation Forms-B":function(e){return e>=65136&&e<=65279},"Halfwidth and Fullwidth Forms":function(e){return e>=65280&&e<=65519}};function Ql(e){for(var t=0,i=e;t<i.length;t+=1)if(Ys(i[t].charCodeAt(0)))return!0;return!1}function Ys(e){return!(e!==746&&e!==747&&(e<4352||!($e["Bopomofo Extended"](e)||$e.Bopomofo(e)||$e["CJK Compatibility Forms"](e)&&!(e>=65097&&e<=65103)||$e["CJK Compatibility Ideographs"](e)||$e["CJK Compatibility"](e)||$e["CJK Radicals Supplement"](e)||$e["CJK Strokes"](e)||!(!$e["CJK Symbols and Punctuation"](e)||e>=12296&&e<=12305||e>=12308&&e<=12319||e===12336)||$e["CJK Unified Ideographs Extension A"](e)||$e["CJK Unified Ideographs"](e)||$e["Enclosed CJK Letters and Months"](e)||$e["Hangul Compatibility Jamo"](e)||$e["Hangul Jamo Extended-A"](e)||$e["Hangul Jamo Extended-B"](e)||$e["Hangul Jamo"](e)||$e["Hangul Syllables"](e)||$e.Hiragana(e)||$e["Ideographic Description Characters"](e)||$e.Kanbun(e)||$e["Kangxi Radicals"](e)||$e["Katakana Phonetic Extensions"](e)||$e.Katakana(e)&&e!==12540||!(!$e["Halfwidth and Fullwidth Forms"](e)||e===65288||e===65289||e===65293||e>=65306&&e<=65310||e===65339||e===65341||e===65343||e>=65371&&e<=65503||e===65507||e>=65512&&e<=65519)||!(!$e["Small Form Variants"](e)||e>=65112&&e<=65118||e>=65123&&e<=65126)||$e["Unified Canadian Aboriginal Syllabics"](e)||$e["Unified Canadian Aboriginal Syllabics Extended"](e)||$e["Vertical Forms"](e)||$e["Yijing Hexagram Symbols"](e)||$e["Yi Syllables"](e)||$e["Yi Radicals"](e))))}function $l(e){return!(Ys(e)||function(t){return!!($e["Latin-1 Supplement"](t)&&(t===167||t===169||t===174||t===177||t===188||t===189||t===190||t===215||t===247)||$e["General Punctuation"](t)&&(t===8214||t===8224||t===8225||t===8240||t===8241||t===8251||t===8252||t===8258||t===8263||t===8264||t===8265||t===8273)||$e["Letterlike Symbols"](t)||$e["Number Forms"](t)||$e["Miscellaneous Technical"](t)&&(t>=8960&&t<=8967||t>=8972&&t<=8991||t>=8996&&t<=9e3||t===9003||t>=9085&&t<=9114||t>=9150&&t<=9165||t===9167||t>=9169&&t<=9179||t>=9186&&t<=9215)||$e["Control Pictures"](t)&&t!==9251||$e["Optical Character Recognition"](t)||$e["Enclosed Alphanumerics"](t)||$e["Geometric Shapes"](t)||$e["Miscellaneous Symbols"](t)&&!(t>=9754&&t<=9759)||$e["Miscellaneous Symbols and Arrows"](t)&&(t>=11026&&t<=11055||t>=11088&&t<=11097||t>=11192&&t<=11243)||$e["CJK Symbols and Punctuation"](t)||$e.Katakana(t)||$e["Private Use Area"](t)||$e["CJK Compatibility Forms"](t)||$e["Small Form Variants"](t)||$e["Halfwidth and Fullwidth Forms"](t)||t===8734||t===8756||t===8757||t>=9984&&t<=10087||t>=10102&&t<=10131||t===65532||t===65533)}(e))}function ia(e){return e>=1424&&e<=2303||$e["Arabic Presentation Forms-A"](e)||$e["Arabic Presentation Forms-B"](e)}function jn(e,t){return!(!t&&ia(e)||e>=2304&&e<=3583||e>=3840&&e<=4255||$e.Khmer(e))}function Qs(e){for(var t=0,i=e;t<i.length;t+=1)if(ia(i[t].charCodeAt(0)))return!0;return!1}var $s=null,qn="unavailable",La=null,Ic=function(e){e&&typeof e=="string"&&e.indexOf("NetworkError")>-1&&(qn="error"),$s&&$s(e)};function xs(){eu.fire(new $("pluginStateChange",{pluginStatus:qn,pluginURL:La}))}var eu=new he,tu=function(){return qn},da=function(){if(qn!=="deferred"||!La)throw new Error("rtl-text-plugin cannot be downloaded unless a pluginURL is specified");qn="loading",xs(),La&&oi({url:La},function(e){e?Ic(e):(qn="loaded",xs())})},Qn={applyArabicShaping:null,processBidirectionalText:null,processStyledBidirectionalText:null,isLoaded:function(){return qn==="loaded"||Qn.applyArabicShaping!=null},isLoading:function(){return qn==="loading"},setState:function(e){qn=e.pluginStatus,La=e.pluginURL},isParsed:function(){return Qn.applyArabicShaping!=null&&Qn.processBidirectionalText!=null&&Qn.processStyledBidirectionalText!=null},getPluginURL:function(){return La}},ur=function(e,t){this.zoom=e,t?(this.now=t.now,this.fadeDuration=t.fadeDuration,this.zoomHistory=t.zoomHistory,this.transition=t.transition):(this.now=0,this.fadeDuration=0,this.zoomHistory=new Yl,this.transition={})};ur.prototype.isSupportedScript=function(e){return function(t,i){for(var l=0,p=t;l<p.length;l+=1)if(!jn(p[l].charCodeAt(0),i))return!1;return!0}(e,Qn.isLoaded())},ur.prototype.crossFadingFactor=function(){return this.fadeDuration===0?1:Math.min((this.now-this.zoomHistory.lastIntegerZoomTime)/this.fadeDuration,1)},ur.prototype.getCrossfadeParameters=function(){var e=this.zoom,t=e-Math.floor(e),i=this.crossFadingFactor();return e>this.zoomHistory.lastIntegerZoom?{fromScale:2,toScale:1,t:t+(1-t)*i}:{fromScale:.5,toScale:1,t:1-(1-i)*t}};var Sa=function(e,t){this.property=e,this.value=t,this.expression=function(i,l){if(js(i))return new Zo(i,l);if(ps(i)){var p=vc(i,l);if(p.result==="error")throw new Error(p.value.map(function(x){return x.key+": "+x.message}).join(", "));return p.value}var m=i;return typeof i=="string"&&l.type==="color"&&(m=tr.parse(i)),{kind:"constant",evaluate:function(){return m}}}(t===void 0?e.specification.default:t,e.specification)};Sa.prototype.isDataDriven=function(){return this.expression.kind==="source"||this.expression.kind==="composite"},Sa.prototype.possiblyEvaluate=function(e,t,i){return this.property.possiblyEvaluate(this,e,t,i)};var na=function(e){this.property=e,this.value=new Sa(e,void 0)};na.prototype.transitioned=function(e,t){return new Io(this.property,this.value,t,xe({},e.transition,this.transition),e.now)},na.prototype.untransitioned=function(){return new Io(this.property,this.value,null,{},0)};var nn=function(e){this._properties=e,this._values=Object.create(e.defaultTransitionablePropertyValues)};nn.prototype.getValue=function(e){return ht(this._values[e].value.value)},nn.prototype.setValue=function(e,t){this._values.hasOwnProperty(e)||(this._values[e]=new na(this._values[e].property)),this._values[e].value=new Sa(this._values[e].property,t===null?void 0:ht(t))},nn.prototype.getTransition=function(e){return ht(this._values[e].transition)},nn.prototype.setTransition=function(e,t){this._values.hasOwnProperty(e)||(this._values[e]=new na(this._values[e].property)),this._values[e].transition=ht(t)||void 0},nn.prototype.serialize=function(){for(var e={},t=0,i=Object.keys(this._values);t<i.length;t+=1){var l=i[t],p=this.getValue(l);p!==void 0&&(e[l]=p);var m=this.getTransition(l);m!==void 0&&(e[l+"-transition"]=m)}return e},nn.prototype.transitioned=function(e,t){for(var i=new Ya(this._properties),l=0,p=Object.keys(this._values);l<p.length;l+=1){var m=p[l];i._values[m]=this._values[m].transitioned(e,t._values[m])}return i},nn.prototype.untransitioned=function(){for(var e=new Ya(this._properties),t=0,i=Object.keys(this._values);t<i.length;t+=1){var l=i[t];e._values[l]=this._values[l].untransitioned()}return e};var Io=function(e,t,i,l,p){this.property=e,this.value=t,this.begin=p+l.delay||0,this.end=this.begin+l.duration||0,e.specification.transition&&(l.delay||l.duration)&&(this.prior=i)};Io.prototype.possiblyEvaluate=function(e,t,i){var l=e.now||0,p=this.value.possiblyEvaluate(e,t,i),m=this.prior;if(m){if(l>this.end)return this.prior=null,p;if(this.value.isDataDriven())return this.prior=null,p;if(l<this.begin)return m.possiblyEvaluate(e,t,i);var x=(l-this.begin)/(this.end-this.begin);return this.property.interpolate(m.possiblyEvaluate(e,t,i),p,function(S){if(S<=0)return 0;if(S>=1)return 1;var z=S*S,A=z*S;return 4*(S<.5?A:3*(S-z)+A-.75)}(x))}return p};var Ya=function(e){this._properties=e,this._values=Object.create(e.defaultTransitioningPropertyValues)};Ya.prototype.possiblyEvaluate=function(e,t,i){for(var l=new ws(this._properties),p=0,m=Object.keys(this._values);p<m.length;p+=1){var x=m[p];l._values[x]=this._values[x].possiblyEvaluate(e,t,i)}return l},Ya.prototype.hasTransition=function(){for(var e=0,t=Object.keys(this._values);e<t.length;e+=1)if(this._values[t[e]].prior)return!0;return!1};var ma=function(e){this._properties=e,this._values=Object.create(e.defaultPropertyValues)};ma.prototype.getValue=function(e){return ht(this._values[e].value)},ma.prototype.setValue=function(e,t){this._values[e]=new Sa(this._values[e].property,t===null?void 0:ht(t))},ma.prototype.serialize=function(){for(var e={},t=0,i=Object.keys(this._values);t<i.length;t+=1){var l=i[t],p=this.getValue(l);p!==void 0&&(e[l]=p)}return e},ma.prototype.possiblyEvaluate=function(e,t,i){for(var l=new ws(this._properties),p=0,m=Object.keys(this._values);p<m.length;p+=1){var x=m[p];l._values[x]=this._values[x].possiblyEvaluate(e,t,i)}return l};var wn=function(e,t,i){this.property=e,this.value=t,this.parameters=i};wn.prototype.isConstant=function(){return this.value.kind==="constant"},wn.prototype.constantOr=function(e){return this.value.kind==="constant"?this.value.value:e},wn.prototype.evaluate=function(e,t,i,l){return this.property.evaluate(this.value,this.parameters,e,t,i,l)};var ws=function(e){this._properties=e,this._values=Object.create(e.defaultPossiblyEvaluatedValues)};ws.prototype.get=function(e){return this._values[e]};var gt=function(e){this.specification=e};gt.prototype.possiblyEvaluate=function(e,t){return e.expression.evaluate(t)},gt.prototype.interpolate=function(e,t,i){var l=Uo[this.specification.type];return l?l(e,t,i):e};var ut=function(e,t){this.specification=e,this.overrides=t};ut.prototype.possiblyEvaluate=function(e,t,i,l){return new wn(this,e.expression.kind==="constant"||e.expression.kind==="camera"?{kind:"constant",value:e.expression.evaluate(t,null,{},i,l)}:e.expression,t)},ut.prototype.interpolate=function(e,t,i){if(e.value.kind!=="constant"||t.value.kind!=="constant")return e;if(e.value.value===void 0||t.value.value===void 0)return new wn(this,{kind:"constant",value:void 0},e.parameters);var l=Uo[this.specification.type];return l?new wn(this,{kind:"constant",value:l(e.value.value,t.value.value,i)},e.parameters):e},ut.prototype.evaluate=function(e,t,i,l,p,m){return e.kind==="constant"?e.value:e.evaluate(t,i,l,p,m)};var el=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.possiblyEvaluate=function(i,l,p,m){if(i.value===void 0)return new wn(this,{kind:"constant",value:void 0},l);if(i.expression.kind==="constant"){var x=i.expression.evaluate(l,null,{},p,m),S=i.property.specification.type==="resolvedImage"&&typeof x!="string"?x.name:x,z=this._calculate(S,S,S,l);return new wn(this,{kind:"constant",value:z},l)}if(i.expression.kind==="camera"){var A=this._calculate(i.expression.evaluate({zoom:l.zoom-1}),i.expression.evaluate({zoom:l.zoom}),i.expression.evaluate({zoom:l.zoom+1}),l);return new wn(this,{kind:"constant",value:A},l)}return new wn(this,i.expression,l)},t.prototype.evaluate=function(i,l,p,m,x,S){if(i.kind==="source"){var z=i.evaluate(l,p,m,x,S);return this._calculate(z,z,z,l)}return i.kind==="composite"?this._calculate(i.evaluate({zoom:Math.floor(l.zoom)-1},p,m),i.evaluate({zoom:Math.floor(l.zoom)},p,m),i.evaluate({zoom:Math.floor(l.zoom)+1},p,m),l):i.value},t.prototype._calculate=function(i,l,p,m){return m.zoom>m.zoomHistory.lastIntegerZoom?{from:i,to:l}:{from:p,to:l}},t.prototype.interpolate=function(i){return i},t}(ut),kn=function(e){this.specification=e};kn.prototype.possiblyEvaluate=function(e,t,i,l){if(e.value!==void 0){if(e.expression.kind==="constant"){var p=e.expression.evaluate(t,null,{},i,l);return this._calculate(p,p,p,t)}return this._calculate(e.expression.evaluate(new ur(Math.floor(t.zoom-1),t)),e.expression.evaluate(new ur(Math.floor(t.zoom),t)),e.expression.evaluate(new ur(Math.floor(t.zoom+1),t)),t)}},kn.prototype._calculate=function(e,t,i,l){return l.zoom>l.zoomHistory.lastIntegerZoom?{from:e,to:t}:{from:i,to:t}},kn.prototype.interpolate=function(e){return e};var ya=function(e){this.specification=e};ya.prototype.possiblyEvaluate=function(e,t,i,l){return!!e.expression.evaluate(t,null,{},i,l)},ya.prototype.interpolate=function(){return!1};var an=function(e){for(var t in this.properties=e,this.defaultPropertyValues={},this.defaultTransitionablePropertyValues={},this.defaultTransitioningPropertyValues={},this.defaultPossiblyEvaluatedValues={},this.overridableProperties=[],e){var i=e[t];i.specification.overridable&&this.overridableProperties.push(t);var l=this.defaultPropertyValues[t]=new Sa(i,void 0),p=this.defaultTransitionablePropertyValues[t]=new na(i);this.defaultTransitioningPropertyValues[t]=p.untransitioned(),this.defaultPossiblyEvaluatedValues[t]=l.possiblyEvaluate({})}};st("DataDrivenProperty",ut),st("DataConstantProperty",gt),st("CrossFadedDataDrivenProperty",el),st("CrossFadedProperty",kn),st("ColorRampProperty",ya);var Ea=function(e){function t(i,l){if(e.call(this),this.id=i.id,this.type=i.type,this._featureFilter={filter:function(){return!0},needGeometry:!1},i.type!=="custom"&&(this.metadata=(i=i).metadata,this.minzoom=i.minzoom,this.maxzoom=i.maxzoom,i.type!=="background"&&(this.source=i.source,this.sourceLayer=i["source-layer"],this.filter=i.filter),l.layout&&(this._unevaluatedLayout=new ma(l.layout)),l.paint)){for(var p in this._transitionablePaint=new nn(l.paint),i.paint)this.setPaintProperty(p,i.paint[p],{validate:!1});for(var m in i.layout)this.setLayoutProperty(m,i.layout[m],{validate:!1});this._transitioningPaint=this._transitionablePaint.untransitioned(),this.paint=new ws(l.paint)}}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.getCrossfadeParameters=function(){return this._crossfadeParameters},t.prototype.getLayoutProperty=function(i){return i==="visibility"?this.visibility:this._unevaluatedLayout.getValue(i)},t.prototype.setLayoutProperty=function(i,l,p){p===void 0&&(p={}),l!=null&&this._validate(gs,"layers."+this.id+".layout."+i,i,l,p)||(i!=="visibility"?this._unevaluatedLayout.setValue(i,l):this.visibility=l)},t.prototype.getPaintProperty=function(i){return Lt(i,"-transition")?this._transitionablePaint.getTransition(i.slice(0,-11)):this._transitionablePaint.getValue(i)},t.prototype.setPaintProperty=function(i,l,p){if(p===void 0&&(p={}),l!=null&&this._validate(Wh,"layers."+this.id+".paint."+i,i,l,p))return!1;if(Lt(i,"-transition"))return this._transitionablePaint.setTransition(i.slice(0,-11),l||void 0),!1;var m=this._transitionablePaint._values[i],x=m.property.specification["property-type"]==="cross-faded-data-driven",S=m.value.isDataDriven(),z=m.value;this._transitionablePaint.setValue(i,l),this._handleSpecialPaintPropertyUpdate(i);var A=this._transitionablePaint._values[i].value;return A.isDataDriven()||S||x||this._handleOverridablePaintPropertyUpdate(i,z,A)},t.prototype._handleSpecialPaintPropertyUpdate=function(i){},t.prototype._handleOverridablePaintPropertyUpdate=function(i,l,p){return!1},t.prototype.isHidden=function(i){return!!(this.minzoom&&i<this.minzoom)||!!(this.maxzoom&&i>=this.maxzoom)||this.visibility==="none"},t.prototype.updateTransitions=function(i){this._transitioningPaint=this._transitionablePaint.transitioned(i,this._transitioningPaint)},t.prototype.hasTransition=function(){return this._transitioningPaint.hasTransition()},t.prototype.recalculate=function(i,l){i.getCrossfadeParameters&&(this._crossfadeParameters=i.getCrossfadeParameters()),this._unevaluatedLayout&&(this.layout=this._unevaluatedLayout.possiblyEvaluate(i,void 0,l)),this.paint=this._transitioningPaint.possiblyEvaluate(i,void 0,l)},t.prototype.serialize=function(){var i={id:this.id,type:this.type,source:this.source,"source-layer":this.sourceLayer,metadata:this.metadata,minzoom:this.minzoom,maxzoom:this.maxzoom,filter:this.filter,layout:this._unevaluatedLayout&&this._unevaluatedLayout.serialize(),paint:this._transitionablePaint&&this._transitionablePaint.serialize()};return this.visibility&&(i.layout=i.layout||{},i.layout.visibility=this.visibility),_t(i,function(l,p){return!(l===void 0||p==="layout"&&!Object.keys(l).length||p==="paint"&&!Object.keys(l).length)})},t.prototype._validate=function(i,l,p,m,x){return x===void 0&&(x={}),(!x||x.validate!==!1)&&vs(this,i.call(_s,{key:l,layerType:this.type,objectKey:p,value:m,styleSpec:j,style:{glyphs:!0,sprite:!0}}))},t.prototype.is3D=function(){return!1},t.prototype.isTileClipped=function(){return!1},t.prototype.hasOffscreenPass=function(){return!1},t.prototype.resize=function(){},t.prototype.isStateDependent=function(){for(var i in this.paint._values){var l=this.paint.get(i);if(l instanceof wn&&ko(l.property.specification)&&(l.value.kind==="source"||l.value.kind==="composite")&&l.value.isStateDependent)return!0}return!1},t}(he),ru={Int8:Int8Array,Uint8:Uint8Array,Int16:Int16Array,Uint16:Uint16Array,Int32:Int32Array,Uint32:Uint32Array,Float32:Float32Array},tl=function(e,t){this._structArray=e,this._pos1=t*this.size,this._pos2=this._pos1/2,this._pos4=this._pos1/4,this._pos8=this._pos1/8},zr=function(){this.isTransferred=!1,this.capacity=-1,this.resize(0)};function Ki(e,t){t===void 0&&(t=1);var i=0,l=0;return{members:e.map(function(p){var m=ru[p.type].BYTES_PER_ELEMENT,x=i=zc(i,Math.max(t,m)),S=p.components||1;return l=Math.max(l,m),i+=m*S,{name:p.name,type:p.type,components:S,offset:x}}),size:zc(i,Math.max(l,t)),alignment:t}}function zc(e,t){return Math.ceil(e/t)*t}zr.serialize=function(e,t){return e._trim(),t&&(e.isTransferred=!0,t.push(e.arrayBuffer)),{length:e.length,arrayBuffer:e.arrayBuffer}},zr.deserialize=function(e){var t=Object.create(this.prototype);return t.arrayBuffer=e.arrayBuffer,t.length=e.length,t.capacity=e.arrayBuffer.byteLength/t.bytesPerElement,t._refreshViews(),t},zr.prototype._trim=function(){this.length!==this.capacity&&(this.capacity=this.length,this.arrayBuffer=this.arrayBuffer.slice(0,this.length*this.bytesPerElement),this._refreshViews())},zr.prototype.clear=function(){this.length=0},zr.prototype.resize=function(e){this.reserve(e),this.length=e},zr.prototype.reserve=function(e){if(e>this.capacity){this.capacity=Math.max(e,Math.floor(5*this.capacity),128),this.arrayBuffer=new ArrayBuffer(this.capacity*this.bytesPerElement);var t=this.uint8;this._refreshViews(),t&&this.uint8.set(t)}},zr.prototype._refreshViews=function(){throw new Error("_refreshViews() must be implemented by each concrete StructArray layout")};var zo=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},t.prototype.emplaceBack=function(i,l){var p=this.length;return this.resize(p+1),this.emplace(p,i,l)},t.prototype.emplace=function(i,l,p){var m=2*i;return this.int16[m+0]=l,this.int16[m+1]=p,i},t}(zr);zo.prototype.bytesPerElement=4,st("StructArrayLayout2i4",zo);var iu=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},t.prototype.emplaceBack=function(i,l,p,m){var x=this.length;return this.resize(x+1),this.emplace(x,i,l,p,m)},t.prototype.emplace=function(i,l,p,m,x){var S=4*i;return this.int16[S+0]=l,this.int16[S+1]=p,this.int16[S+2]=m,this.int16[S+3]=x,i},t}(zr);iu.prototype.bytesPerElement=8,st("StructArrayLayout4i8",iu);var Ra=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},t.prototype.emplaceBack=function(i,l,p,m,x,S){var z=this.length;return this.resize(z+1),this.emplace(z,i,l,p,m,x,S)},t.prototype.emplace=function(i,l,p,m,x,S,z){var A=6*i;return this.int16[A+0]=l,this.int16[A+1]=p,this.int16[A+2]=m,this.int16[A+3]=x,this.int16[A+4]=S,this.int16[A+5]=z,i},t}(zr);Ra.prototype.bytesPerElement=12,st("StructArrayLayout2i4i12",Ra);var Zn=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},t.prototype.emplaceBack=function(i,l,p,m,x,S){var z=this.length;return this.resize(z+1),this.emplace(z,i,l,p,m,x,S)},t.prototype.emplace=function(i,l,p,m,x,S,z){var A=4*i,C=8*i;return this.int16[A+0]=l,this.int16[A+1]=p,this.uint8[C+4]=m,this.uint8[C+5]=x,this.uint8[C+6]=S,this.uint8[C+7]=z,i},t}(zr);Zn.prototype.bytesPerElement=8,st("StructArrayLayout2i4ub8",Zn);var Xo=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},t.prototype.emplaceBack=function(i,l){var p=this.length;return this.resize(p+1),this.emplace(p,i,l)},t.prototype.emplace=function(i,l,p){var m=2*i;return this.float32[m+0]=l,this.float32[m+1]=p,i},t}(zr);Xo.prototype.bytesPerElement=8,st("StructArrayLayout2f8",Xo);var Ta=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},t.prototype.emplaceBack=function(i,l,p,m,x,S,z,A,C,B){var U=this.length;return this.resize(U+1),this.emplace(U,i,l,p,m,x,S,z,A,C,B)},t.prototype.emplace=function(i,l,p,m,x,S,z,A,C,B,U){var q=10*i;return this.uint16[q+0]=l,this.uint16[q+1]=p,this.uint16[q+2]=m,this.uint16[q+3]=x,this.uint16[q+4]=S,this.uint16[q+5]=z,this.uint16[q+6]=A,this.uint16[q+7]=C,this.uint16[q+8]=B,this.uint16[q+9]=U,i},t}(zr);Ta.prototype.bytesPerElement=20,st("StructArrayLayout10ui20",Ta);var rl=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},t.prototype.emplaceBack=function(i,l,p,m,x,S,z,A,C,B,U,q){var Q=this.length;return this.resize(Q+1),this.emplace(Q,i,l,p,m,x,S,z,A,C,B,U,q)},t.prototype.emplace=function(i,l,p,m,x,S,z,A,C,B,U,q,Q){var ee=12*i;return this.int16[ee+0]=l,this.int16[ee+1]=p,this.int16[ee+2]=m,this.int16[ee+3]=x,this.uint16[ee+4]=S,this.uint16[ee+5]=z,this.uint16[ee+6]=A,this.uint16[ee+7]=C,this.int16[ee+8]=B,this.int16[ee+9]=U,this.int16[ee+10]=q,this.int16[ee+11]=Q,i},t}(zr);rl.prototype.bytesPerElement=24,st("StructArrayLayout4i4ui4i24",rl);var Wo=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},t.prototype.emplaceBack=function(i,l,p){var m=this.length;return this.resize(m+1),this.emplace(m,i,l,p)},t.prototype.emplace=function(i,l,p,m){var x=3*i;return this.float32[x+0]=l,this.float32[x+1]=p,this.float32[x+2]=m,i},t}(zr);Wo.prototype.bytesPerElement=12,st("StructArrayLayout3f12",Wo);var ks=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)},t.prototype.emplaceBack=function(i){var l=this.length;return this.resize(l+1),this.emplace(l,i)},t.prototype.emplace=function(i,l){return this.uint32[1*i+0]=l,i},t}(zr);ks.prototype.bytesPerElement=4,st("StructArrayLayout1ul4",ks);var nu=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},t.prototype.emplaceBack=function(i,l,p,m,x,S,z,A,C){var B=this.length;return this.resize(B+1),this.emplace(B,i,l,p,m,x,S,z,A,C)},t.prototype.emplace=function(i,l,p,m,x,S,z,A,C,B){var U=10*i,q=5*i;return this.int16[U+0]=l,this.int16[U+1]=p,this.int16[U+2]=m,this.int16[U+3]=x,this.int16[U+4]=S,this.int16[U+5]=z,this.uint32[q+3]=A,this.uint16[U+8]=C,this.uint16[U+9]=B,i},t}(zr);nu.prototype.bytesPerElement=20,st("StructArrayLayout6i1ul2ui20",nu);var Ho=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},t.prototype.emplaceBack=function(i,l,p,m,x,S){var z=this.length;return this.resize(z+1),this.emplace(z,i,l,p,m,x,S)},t.prototype.emplace=function(i,l,p,m,x,S,z){var A=6*i;return this.int16[A+0]=l,this.int16[A+1]=p,this.int16[A+2]=m,this.int16[A+3]=x,this.int16[A+4]=S,this.int16[A+5]=z,i},t}(zr);Ho.prototype.bytesPerElement=12,st("StructArrayLayout2i2i2i12",Ho);var Ao=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},t.prototype.emplaceBack=function(i,l,p,m,x){var S=this.length;return this.resize(S+1),this.emplace(S,i,l,p,m,x)},t.prototype.emplace=function(i,l,p,m,x,S){var z=4*i,A=8*i;return this.float32[z+0]=l,this.float32[z+1]=p,this.float32[z+2]=m,this.int16[A+6]=x,this.int16[A+7]=S,i},t}(zr);Ao.prototype.bytesPerElement=16,st("StructArrayLayout2f1f2i16",Ao);var au=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},t.prototype.emplaceBack=function(i,l,p,m){var x=this.length;return this.resize(x+1),this.emplace(x,i,l,p,m)},t.prototype.emplace=function(i,l,p,m,x){var S=12*i,z=3*i;return this.uint8[S+0]=l,this.uint8[S+1]=p,this.float32[z+1]=m,this.float32[z+2]=x,i},t}(zr);au.prototype.bytesPerElement=12,st("StructArrayLayout2ub2f12",au);var Qa=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},t.prototype.emplaceBack=function(i,l,p){var m=this.length;return this.resize(m+1),this.emplace(m,i,l,p)},t.prototype.emplace=function(i,l,p,m){var x=3*i;return this.uint16[x+0]=l,this.uint16[x+1]=p,this.uint16[x+2]=m,i},t}(zr);Qa.prototype.bytesPerElement=6,st("StructArrayLayout3ui6",Qa);var $a=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},t.prototype.emplaceBack=function(i,l,p,m,x,S,z,A,C,B,U,q,Q,ee,ce,ie,me){var be=this.length;return this.resize(be+1),this.emplace(be,i,l,p,m,x,S,z,A,C,B,U,q,Q,ee,ce,ie,me)},t.prototype.emplace=function(i,l,p,m,x,S,z,A,C,B,U,q,Q,ee,ce,ie,me,be){var ke=24*i,Ie=12*i,Pe=48*i;return this.int16[ke+0]=l,this.int16[ke+1]=p,this.uint16[ke+2]=m,this.uint16[ke+3]=x,this.uint32[Ie+2]=S,this.uint32[Ie+3]=z,this.uint32[Ie+4]=A,this.uint16[ke+10]=C,this.uint16[ke+11]=B,this.uint16[ke+12]=U,this.float32[Ie+7]=q,this.float32[Ie+8]=Q,this.uint8[Pe+36]=ee,this.uint8[Pe+37]=ce,this.uint8[Pe+38]=ie,this.uint32[Ie+10]=me,this.int16[ke+22]=be,i},t}(zr);$a.prototype.bytesPerElement=48,st("StructArrayLayout2i2ui3ul3ui2f3ub1ul1i48",$a);var il=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},t.prototype.emplaceBack=function(i,l,p,m,x,S,z,A,C,B,U,q,Q,ee,ce,ie,me,be,ke,Ie,Pe,je,Qe,mt,rt,bt,nt,Qt){var Dt=this.length;return this.resize(Dt+1),this.emplace(Dt,i,l,p,m,x,S,z,A,C,B,U,q,Q,ee,ce,ie,me,be,ke,Ie,Pe,je,Qe,mt,rt,bt,nt,Qt)},t.prototype.emplace=function(i,l,p,m,x,S,z,A,C,B,U,q,Q,ee,ce,ie,me,be,ke,Ie,Pe,je,Qe,mt,rt,bt,nt,Qt,Dt){var ct=34*i,rr=17*i;return this.int16[ct+0]=l,this.int16[ct+1]=p,this.int16[ct+2]=m,this.int16[ct+3]=x,this.int16[ct+4]=S,this.int16[ct+5]=z,this.int16[ct+6]=A,this.int16[ct+7]=C,this.uint16[ct+8]=B,this.uint16[ct+9]=U,this.uint16[ct+10]=q,this.uint16[ct+11]=Q,this.uint16[ct+12]=ee,this.uint16[ct+13]=ce,this.uint16[ct+14]=ie,this.uint16[ct+15]=me,this.uint16[ct+16]=be,this.uint16[ct+17]=ke,this.uint16[ct+18]=Ie,this.uint16[ct+19]=Pe,this.uint16[ct+20]=je,this.uint16[ct+21]=Qe,this.uint16[ct+22]=mt,this.uint32[rr+12]=rt,this.float32[rr+13]=bt,this.float32[rr+14]=nt,this.float32[rr+15]=Qt,this.float32[rr+16]=Dt,i},t}(zr);il.prototype.bytesPerElement=68,st("StructArrayLayout8i15ui1ul4f68",il);var eo=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},t.prototype.emplaceBack=function(i){var l=this.length;return this.resize(l+1),this.emplace(l,i)},t.prototype.emplace=function(i,l){return this.float32[1*i+0]=l,i},t}(zr);eo.prototype.bytesPerElement=4,st("StructArrayLayout1f4",eo);var aa=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},t.prototype.emplaceBack=function(i,l,p){var m=this.length;return this.resize(m+1),this.emplace(m,i,l,p)},t.prototype.emplace=function(i,l,p,m){var x=3*i;return this.int16[x+0]=l,this.int16[x+1]=p,this.int16[x+2]=m,i},t}(zr);aa.prototype.bytesPerElement=6,st("StructArrayLayout3i6",aa);var ou=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},t.prototype.emplaceBack=function(i,l,p){var m=this.length;return this.resize(m+1),this.emplace(m,i,l,p)},t.prototype.emplace=function(i,l,p,m){var x=4*i;return this.uint32[2*i+0]=l,this.uint16[x+2]=p,this.uint16[x+3]=m,i},t}(zr);ou.prototype.bytesPerElement=8,st("StructArrayLayout1ul2ui8",ou);var Ss=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},t.prototype.emplaceBack=function(i,l){var p=this.length;return this.resize(p+1),this.emplace(p,i,l)},t.prototype.emplace=function(i,l,p){var m=2*i;return this.uint16[m+0]=l,this.uint16[m+1]=p,i},t}(zr);Ss.prototype.bytesPerElement=4,st("StructArrayLayout2ui4",Ss);var su=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},t.prototype.emplaceBack=function(i){var l=this.length;return this.resize(l+1),this.emplace(l,i)},t.prototype.emplace=function(i,l){return this.uint16[1*i+0]=l,i},t}(zr);su.prototype.bytesPerElement=2,st("StructArrayLayout1ui2",su);var nl=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},t.prototype.emplaceBack=function(i,l,p,m){var x=this.length;return this.resize(x+1),this.emplace(x,i,l,p,m)},t.prototype.emplace=function(i,l,p,m,x){var S=4*i;return this.float32[S+0]=l,this.float32[S+1]=p,this.float32[S+2]=m,this.float32[S+3]=x,i},t}(zr);nl.prototype.bytesPerElement=16,st("StructArrayLayout4f16",nl);var n=function(e){function t(){e.apply(this,arguments)}e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t;var i={anchorPointX:{configurable:!0},anchorPointY:{configurable:!0},x1:{configurable:!0},y1:{configurable:!0},x2:{configurable:!0},y2:{configurable:!0},featureIndex:{configurable:!0},sourceLayerIndex:{configurable:!0},bucketIndex:{configurable:!0},anchorPoint:{configurable:!0}};return i.anchorPointX.get=function(){return this._structArray.int16[this._pos2+0]},i.anchorPointY.get=function(){return this._structArray.int16[this._pos2+1]},i.x1.get=function(){return this._structArray.int16[this._pos2+2]},i.y1.get=function(){return this._structArray.int16[this._pos2+3]},i.x2.get=function(){return this._structArray.int16[this._pos2+4]},i.y2.get=function(){return this._structArray.int16[this._pos2+5]},i.featureIndex.get=function(){return this._structArray.uint32[this._pos4+3]},i.sourceLayerIndex.get=function(){return this._structArray.uint16[this._pos2+8]},i.bucketIndex.get=function(){return this._structArray.uint16[this._pos2+9]},i.anchorPoint.get=function(){return new F(this.anchorPointX,this.anchorPointY)},Object.defineProperties(t.prototype,i),t}(tl);n.prototype.size=20;var s=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.get=function(i){return new n(this,i)},t}(nu);st("CollisionBoxArray",s);var o=function(e){function t(){e.apply(this,arguments)}e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t;var i={anchorX:{configurable:!0},anchorY:{configurable:!0},glyphStartIndex:{configurable:!0},numGlyphs:{configurable:!0},vertexStartIndex:{configurable:!0},lineStartIndex:{configurable:!0},lineLength:{configurable:!0},segment:{configurable:!0},lowerSize:{configurable:!0},upperSize:{configurable:!0},lineOffsetX:{configurable:!0},lineOffsetY:{configurable:!0},writingMode:{configurable:!0},placedOrientation:{configurable:!0},hidden:{configurable:!0},crossTileID:{configurable:!0},associatedIconIndex:{configurable:!0}};return i.anchorX.get=function(){return this._structArray.int16[this._pos2+0]},i.anchorY.get=function(){return this._structArray.int16[this._pos2+1]},i.glyphStartIndex.get=function(){return this._structArray.uint16[this._pos2+2]},i.numGlyphs.get=function(){return this._structArray.uint16[this._pos2+3]},i.vertexStartIndex.get=function(){return this._structArray.uint32[this._pos4+2]},i.lineStartIndex.get=function(){return this._structArray.uint32[this._pos4+3]},i.lineLength.get=function(){return this._structArray.uint32[this._pos4+4]},i.segment.get=function(){return this._structArray.uint16[this._pos2+10]},i.lowerSize.get=function(){return this._structArray.uint16[this._pos2+11]},i.upperSize.get=function(){return this._structArray.uint16[this._pos2+12]},i.lineOffsetX.get=function(){return this._structArray.float32[this._pos4+7]},i.lineOffsetY.get=function(){return this._structArray.float32[this._pos4+8]},i.writingMode.get=function(){return this._structArray.uint8[this._pos1+36]},i.placedOrientation.get=function(){return this._structArray.uint8[this._pos1+37]},i.placedOrientation.set=function(l){this._structArray.uint8[this._pos1+37]=l},i.hidden.get=function(){return this._structArray.uint8[this._pos1+38]},i.hidden.set=function(l){this._structArray.uint8[this._pos1+38]=l},i.crossTileID.get=function(){return this._structArray.uint32[this._pos4+10]},i.crossTileID.set=function(l){this._structArray.uint32[this._pos4+10]=l},i.associatedIconIndex.get=function(){return this._structArray.int16[this._pos2+22]},Object.defineProperties(t.prototype,i),t}(tl);o.prototype.size=48;var u=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.get=function(i){return new o(this,i)},t}($a);st("PlacedSymbolArray",u);var y=function(e){function t(){e.apply(this,arguments)}e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t;var i={anchorX:{configurable:!0},anchorY:{configurable:!0},rightJustifiedTextSymbolIndex:{configurable:!0},centerJustifiedTextSymbolIndex:{configurable:!0},leftJustifiedTextSymbolIndex:{configurable:!0},verticalPlacedTextSymbolIndex:{configurable:!0},placedIconSymbolIndex:{configurable:!0},verticalPlacedIconSymbolIndex:{configurable:!0},key:{configurable:!0},textBoxStartIndex:{configurable:!0},textBoxEndIndex:{configurable:!0},verticalTextBoxStartIndex:{configurable:!0},verticalTextBoxEndIndex:{configurable:!0},iconBoxStartIndex:{configurable:!0},iconBoxEndIndex:{configurable:!0},verticalIconBoxStartIndex:{configurable:!0},verticalIconBoxEndIndex:{configurable:!0},featureIndex:{configurable:!0},numHorizontalGlyphVertices:{configurable:!0},numVerticalGlyphVertices:{configurable:!0},numIconVertices:{configurable:!0},numVerticalIconVertices:{configurable:!0},useRuntimeCollisionCircles:{configurable:!0},crossTileID:{configurable:!0},textBoxScale:{configurable:!0},textOffset0:{configurable:!0},textOffset1:{configurable:!0},collisionCircleDiameter:{configurable:!0}};return i.anchorX.get=function(){return this._structArray.int16[this._pos2+0]},i.anchorY.get=function(){return this._structArray.int16[this._pos2+1]},i.rightJustifiedTextSymbolIndex.get=function(){return this._structArray.int16[this._pos2+2]},i.centerJustifiedTextSymbolIndex.get=function(){return this._structArray.int16[this._pos2+3]},i.leftJustifiedTextSymbolIndex.get=function(){return this._structArray.int16[this._pos2+4]},i.verticalPlacedTextSymbolIndex.get=function(){return this._structArray.int16[this._pos2+5]},i.placedIconSymbolIndex.get=function(){return this._structArray.int16[this._pos2+6]},i.verticalPlacedIconSymbolIndex.get=function(){return this._structArray.int16[this._pos2+7]},i.key.get=function(){return this._structArray.uint16[this._pos2+8]},i.textBoxStartIndex.get=function(){return this._structArray.uint16[this._pos2+9]},i.textBoxEndIndex.get=function(){return this._structArray.uint16[this._pos2+10]},i.verticalTextBoxStartIndex.get=function(){return this._structArray.uint16[this._pos2+11]},i.verticalTextBoxEndIndex.get=function(){return this._structArray.uint16[this._pos2+12]},i.iconBoxStartIndex.get=function(){return this._structArray.uint16[this._pos2+13]},i.iconBoxEndIndex.get=function(){return this._structArray.uint16[this._pos2+14]},i.verticalIconBoxStartIndex.get=function(){return this._structArray.uint16[this._pos2+15]},i.verticalIconBoxEndIndex.get=function(){return this._structArray.uint16[this._pos2+16]},i.featureIndex.get=function(){return this._structArray.uint16[this._pos2+17]},i.numHorizontalGlyphVertices.get=function(){return this._structArray.uint16[this._pos2+18]},i.numVerticalGlyphVertices.get=function(){return this._structArray.uint16[this._pos2+19]},i.numIconVertices.get=function(){return this._structArray.uint16[this._pos2+20]},i.numVerticalIconVertices.get=function(){return this._structArray.uint16[this._pos2+21]},i.useRuntimeCollisionCircles.get=function(){return this._structArray.uint16[this._pos2+22]},i.crossTileID.get=function(){return this._structArray.uint32[this._pos4+12]},i.crossTileID.set=function(l){this._structArray.uint32[this._pos4+12]=l},i.textBoxScale.get=function(){return this._structArray.float32[this._pos4+13]},i.textOffset0.get=function(){return this._structArray.float32[this._pos4+14]},i.textOffset1.get=function(){return this._structArray.float32[this._pos4+15]},i.collisionCircleDiameter.get=function(){return this._structArray.float32[this._pos4+16]},Object.defineProperties(t.prototype,i),t}(tl);y.prototype.size=68;var w=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.get=function(i){return new y(this,i)},t}(il);st("SymbolInstanceArray",w);var k=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.getoffsetX=function(i){return this.float32[1*i+0]},t}(eo);st("GlyphOffsetArray",k);var E=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.getx=function(i){return this.int16[3*i+0]},t.prototype.gety=function(i){return this.int16[3*i+1]},t.prototype.gettileUnitDistanceFromAnchor=function(i){return this.int16[3*i+2]},t}(aa);st("SymbolLineVertexArray",E);var P=function(e){function t(){e.apply(this,arguments)}e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t;var i={featureIndex:{configurable:!0},sourceLayerIndex:{configurable:!0},bucketIndex:{configurable:!0}};return i.featureIndex.get=function(){return this._structArray.uint32[this._pos4+0]},i.sourceLayerIndex.get=function(){return this._structArray.uint16[this._pos2+2]},i.bucketIndex.get=function(){return this._structArray.uint16[this._pos2+3]},Object.defineProperties(t.prototype,i),t}(tl);P.prototype.size=8;var O=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.get=function(i){return new P(this,i)},t}(ou);st("FeatureIndexArray",O);var Z=Ki([{name:"a_pos",components:2,type:"Int16"}],4).members,G=function(e){e===void 0&&(e=[]),this.segments=e};function X(e,t){return 256*(e=fe(Math.floor(e),0,255))+fe(Math.floor(t),0,255)}G.prototype.prepareSegment=function(e,t,i,l){var p=this.segments[this.segments.length-1];return e>G.MAX_VERTEX_ARRAY_LENGTH&&yt("Max vertices per segment is "+G.MAX_VERTEX_ARRAY_LENGTH+": bucket requested "+e),(!p||p.vertexLength+e>G.MAX_VERTEX_ARRAY_LENGTH||p.sortKey!==l)&&(p={vertexOffset:t.length,primitiveOffset:i.length,vertexLength:0,primitiveLength:0},l!==void 0&&(p.sortKey=l),this.segments.push(p)),p},G.prototype.get=function(){return this.segments},G.prototype.destroy=function(){for(var e=0,t=this.segments;e<t.length;e+=1){var i=t[e];for(var l in i.vaos)i.vaos[l].destroy()}},G.simpleSegment=function(e,t,i,l){return new G([{vertexOffset:e,primitiveOffset:t,vertexLength:i,primitiveLength:l,vaos:{},sortKey:0}])},G.MAX_VERTEX_ARRAY_LENGTH=Math.pow(2,16)-1,st("SegmentVector",G);var re=Ki([{name:"a_pattern_from",components:4,type:"Uint16"},{name:"a_pattern_to",components:4,type:"Uint16"},{name:"a_pixel_ratio_from",components:1,type:"Uint16"},{name:"a_pixel_ratio_to",components:1,type:"Uint16"}]),te=I(function(e){e.exports=function(t,i){var l,p,m,x,S,z,A,C;for(p=t.length-(l=3&t.length),m=i,S=3432918353,z=461845907,C=0;C<p;)A=255&t.charCodeAt(C)|(255&t.charCodeAt(++C))<<8|(255&t.charCodeAt(++C))<<16|(255&t.charCodeAt(++C))<<24,++C,m=27492+(65535&(x=5*(65535&(m=(m^=A=(65535&(A=(A=(65535&A)*S+(((A>>>16)*S&65535)<<16)&4294967295)<<15|A>>>17))*z+(((A>>>16)*z&65535)<<16)&4294967295)<<13|m>>>19))+((5*(m>>>16)&65535)<<16)&4294967295))+((58964+(x>>>16)&65535)<<16);switch(A=0,l){case 3:A^=(255&t.charCodeAt(C+2))<<16;case 2:A^=(255&t.charCodeAt(C+1))<<8;case 1:m^=A=(65535&(A=(A=(65535&(A^=255&t.charCodeAt(C)))*S+(((A>>>16)*S&65535)<<16)&4294967295)<<15|A>>>17))*z+(((A>>>16)*z&65535)<<16)&4294967295}return m^=t.length,m=2246822507*(65535&(m^=m>>>16))+((2246822507*(m>>>16)&65535)<<16)&4294967295,m=3266489909*(65535&(m^=m>>>13))+((3266489909*(m>>>16)&65535)<<16)&4294967295,(m^=m>>>16)>>>0}}),ue=I(function(e){e.exports=function(t,i){for(var l,p=t.length,m=i^p,x=0;p>=4;)l=1540483477*(65535&(l=255&t.charCodeAt(x)|(255&t.charCodeAt(++x))<<8|(255&t.charCodeAt(++x))<<16|(255&t.charCodeAt(++x))<<24))+((1540483477*(l>>>16)&65535)<<16),m=1540483477*(65535&m)+((1540483477*(m>>>16)&65535)<<16)^(l=1540483477*(65535&(l^=l>>>24))+((1540483477*(l>>>16)&65535)<<16)),p-=4,++x;switch(p){case 3:m^=(255&t.charCodeAt(x+2))<<16;case 2:m^=(255&t.charCodeAt(x+1))<<8;case 1:m=1540483477*(65535&(m^=255&t.charCodeAt(x)))+((1540483477*(m>>>16)&65535)<<16)}return m=1540483477*(65535&(m^=m>>>13))+((1540483477*(m>>>16)&65535)<<16),(m^=m>>>15)>>>0}}),Y=te,le=ue;Y.murmur3=te,Y.murmur2=le;var pe=function(){this.ids=[],this.positions=[],this.indexed=!1};pe.prototype.add=function(e,t,i,l){this.ids.push(ze(e)),this.positions.push(t,i,l)},pe.prototype.getPositions=function(e){for(var t=ze(e),i=0,l=this.ids.length-1;i<l;){var p=i+l>>1;this.ids[p]>=t?l=p:i=p+1}for(var m=[];this.ids[i]===t;)m.push({index:this.positions[3*i],start:this.positions[3*i+1],end:this.positions[3*i+2]}),i++;return m},pe.serialize=function(e,t){var i=new Float64Array(e.ids),l=new Uint32Array(e.positions);return function p(m,x,S,z){for(;S<z;){for(var A=m[S+z>>1],C=S-1,B=z+1;;){do C++;while(m[C]<A);do B--;while(m[B]>A);if(C>=B)break;Te(m,C,B),Te(x,3*C,3*B),Te(x,3*C+1,3*B+1),Te(x,3*C+2,3*B+2)}B-S<z-B?(p(m,x,S,B),S=B+1):(p(m,x,B+1,z),z=B)}}(i,l,0,i.length-1),t&&t.push(i.buffer,l.buffer),{ids:i,positions:l}},pe.deserialize=function(e){var t=new pe;return t.ids=e.ids,t.positions=e.positions,t.indexed=!0,t};var ge=Math.pow(2,53)-1;function ze(e){var t=+e;return!isNaN(t)&&t<=ge?t:Y(String(e))}function Te(e,t,i){var l=e[t];e[t]=e[i],e[i]=l}st("FeaturePositionMap",pe);var Ae=function(e,t){this.gl=e.gl,this.location=t},Re=function(e){function t(i,l){e.call(this,i,l),this.current=0}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.set=function(i){this.current!==i&&(this.current=i,this.gl.uniform1i(this.location,i))},t}(Ae),Xe=function(e){function t(i,l){e.call(this,i,l),this.current=0}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.set=function(i){this.current!==i&&(this.current=i,this.gl.uniform1f(this.location,i))},t}(Ae),Ge=function(e){function t(i,l){e.call(this,i,l),this.current=[0,0]}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.set=function(i){i[0]===this.current[0]&&i[1]===this.current[1]||(this.current=i,this.gl.uniform2f(this.location,i[0],i[1]))},t}(Ae),at=function(e){function t(i,l){e.call(this,i,l),this.current=[0,0,0]}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.set=function(i){i[0]===this.current[0]&&i[1]===this.current[1]&&i[2]===this.current[2]||(this.current=i,this.gl.uniform3f(this.location,i[0],i[1],i[2]))},t}(Ae),vt=function(e){function t(i,l){e.call(this,i,l),this.current=[0,0,0,0]}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.set=function(i){i[0]===this.current[0]&&i[1]===this.current[1]&&i[2]===this.current[2]&&i[3]===this.current[3]||(this.current=i,this.gl.uniform4f(this.location,i[0],i[1],i[2],i[3]))},t}(Ae),kt=function(e){function t(i,l){e.call(this,i,l),this.current=tr.transparent}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.set=function(i){i.r===this.current.r&&i.g===this.current.g&&i.b===this.current.b&&i.a===this.current.a||(this.current=i,this.gl.uniform4f(this.location,i.r,i.g,i.b,i.a))},t}(Ae),wt=new Float32Array(16),_r=function(e){function t(i,l){e.call(this,i,l),this.current=wt}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.set=function(i){if(i[12]!==this.current[12]||i[0]!==this.current[0])return this.current=i,void this.gl.uniformMatrix4fv(this.location,!1,i);for(var l=1;l<16;l++)if(i[l]!==this.current[l]){this.current=i,this.gl.uniformMatrix4fv(this.location,!1,i);break}},t}(Ae);function ot(e){return[X(255*e.r,255*e.g),X(255*e.b,255*e.a)]}var Nt=function(e,t,i){this.value=e,this.uniformNames=t.map(function(l){return"u_"+l}),this.type=i};Nt.prototype.setUniform=function(e,t,i){e.set(i.constantOr(this.value))},Nt.prototype.getBinding=function(e,t,i){return this.type==="color"?new kt(e,t):new Xe(e,t)};var Yt=function(e,t){this.uniformNames=t.map(function(i){return"u_"+i}),this.patternFrom=null,this.patternTo=null,this.pixelRatioFrom=1,this.pixelRatioTo=1};Yt.prototype.setConstantPatternPositions=function(e,t){this.pixelRatioFrom=t.pixelRatio,this.pixelRatioTo=e.pixelRatio,this.patternFrom=t.tlbr,this.patternTo=e.tlbr},Yt.prototype.setUniform=function(e,t,i,l){var p=l==="u_pattern_to"?this.patternTo:l==="u_pattern_from"?this.patternFrom:l==="u_pixel_ratio_to"?this.pixelRatioTo:l==="u_pixel_ratio_from"?this.pixelRatioFrom:null;p&&e.set(p)},Yt.prototype.getBinding=function(e,t,i){return i.substr(0,9)==="u_pattern"?new vt(e,t):new Xe(e,t)};var Ot=function(e,t,i,l){this.expression=e,this.type=i,this.maxValue=0,this.paintVertexAttributes=t.map(function(p){return{name:"a_"+p,type:"Float32",components:i==="color"?2:1,offset:0}}),this.paintVertexArray=new l};Ot.prototype.populatePaintArray=function(e,t,i,l,p){var m=this.paintVertexArray.length,x=this.expression.evaluate(new ur(0),t,{},l,[],p);this.paintVertexArray.resize(e),this._setPaintValue(m,e,x)},Ot.prototype.updatePaintArray=function(e,t,i,l){var p=this.expression.evaluate({zoom:0},i,l);this._setPaintValue(e,t,p)},Ot.prototype._setPaintValue=function(e,t,i){if(this.type==="color")for(var l=ot(i),p=e;p<t;p++)this.paintVertexArray.emplace(p,l[0],l[1]);else{for(var m=e;m<t;m++)this.paintVertexArray.emplace(m,i);this.maxValue=Math.max(this.maxValue,Math.abs(i))}},Ot.prototype.upload=function(e){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=e.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))},Ot.prototype.destroy=function(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()};var Bt=function(e,t,i,l,p,m){this.expression=e,this.uniformNames=t.map(function(x){return"u_"+x+"_t"}),this.type=i,this.useIntegerZoom=l,this.zoom=p,this.maxValue=0,this.paintVertexAttributes=t.map(function(x){return{name:"a_"+x,type:"Float32",components:i==="color"?4:2,offset:0}}),this.paintVertexArray=new m};Bt.prototype.populatePaintArray=function(e,t,i,l,p){var m=this.expression.evaluate(new ur(this.zoom),t,{},l,[],p),x=this.expression.evaluate(new ur(this.zoom+1),t,{},l,[],p),S=this.paintVertexArray.length;this.paintVertexArray.resize(e),this._setPaintValue(S,e,m,x)},Bt.prototype.updatePaintArray=function(e,t,i,l){var p=this.expression.evaluate({zoom:this.zoom},i,l),m=this.expression.evaluate({zoom:this.zoom+1},i,l);this._setPaintValue(e,t,p,m)},Bt.prototype._setPaintValue=function(e,t,i,l){if(this.type==="color")for(var p=ot(i),m=ot(l),x=e;x<t;x++)this.paintVertexArray.emplace(x,p[0],p[1],m[0],m[1]);else{for(var S=e;S<t;S++)this.paintVertexArray.emplace(S,i,l);this.maxValue=Math.max(this.maxValue,Math.abs(i),Math.abs(l))}},Bt.prototype.upload=function(e){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=e.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))},Bt.prototype.destroy=function(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()},Bt.prototype.setUniform=function(e,t){var i=this.useIntegerZoom?Math.floor(t.zoom):t.zoom,l=fe(this.expression.interpolationFactor(i,this.zoom,this.zoom+1),0,1);e.set(l)},Bt.prototype.getBinding=function(e,t,i){return new Xe(e,t)};var Ht=function(e,t,i,l,p,m){this.expression=e,this.type=t,this.useIntegerZoom=i,this.zoom=l,this.layerId=m,this.zoomInPaintVertexArray=new p,this.zoomOutPaintVertexArray=new p};Ht.prototype.populatePaintArray=function(e,t,i){var l=this.zoomInPaintVertexArray.length;this.zoomInPaintVertexArray.resize(e),this.zoomOutPaintVertexArray.resize(e),this._setPaintValues(l,e,t.patterns&&t.patterns[this.layerId],i)},Ht.prototype.updatePaintArray=function(e,t,i,l,p){this._setPaintValues(e,t,i.patterns&&i.patterns[this.layerId],p)},Ht.prototype._setPaintValues=function(e,t,i,l){if(l&&i){var p=l[i.min],m=l[i.mid],x=l[i.max];if(p&&m&&x)for(var S=e;S<t;S++)this.zoomInPaintVertexArray.emplace(S,m.tl[0],m.tl[1],m.br[0],m.br[1],p.tl[0],p.tl[1],p.br[0],p.br[1],m.pixelRatio,p.pixelRatio),this.zoomOutPaintVertexArray.emplace(S,m.tl[0],m.tl[1],m.br[0],m.br[1],x.tl[0],x.tl[1],x.br[0],x.br[1],m.pixelRatio,x.pixelRatio)}},Ht.prototype.upload=function(e){this.zoomInPaintVertexArray&&this.zoomInPaintVertexArray.arrayBuffer&&this.zoomOutPaintVertexArray&&this.zoomOutPaintVertexArray.arrayBuffer&&(this.zoomInPaintVertexBuffer=e.createVertexBuffer(this.zoomInPaintVertexArray,re.members,this.expression.isStateDependent),this.zoomOutPaintVertexBuffer=e.createVertexBuffer(this.zoomOutPaintVertexArray,re.members,this.expression.isStateDependent))},Ht.prototype.destroy=function(){this.zoomOutPaintVertexBuffer&&this.zoomOutPaintVertexBuffer.destroy(),this.zoomInPaintVertexBuffer&&this.zoomInPaintVertexBuffer.destroy()};var Rt=function(e,t,i){this.binders={},this._buffers=[];var l=[];for(var p in e.paint._values)if(i(p)){var m=e.paint.get(p);if(m instanceof wn&&ko(m.property.specification)){var x=Li(p,e.type),S=m.value,z=m.property.specification.type,A=m.property.useIntegerZoom,C=m.property.specification["property-type"],B=C==="cross-faded"||C==="cross-faded-data-driven";if(S.kind==="constant")this.binders[p]=B?new Yt(S.value,x):new Nt(S.value,x,z),l.push("/u_"+p);else if(S.kind==="source"||B){var U=ui(p,z,"source");this.binders[p]=B?new Ht(S,z,A,t,U,e.id):new Ot(S,x,z,U),l.push("/a_"+p)}else{var q=ui(p,z,"composite");this.binders[p]=new Bt(S,x,z,A,t,q),l.push("/z_"+p)}}}this.cacheKey=l.sort().join("")};Rt.prototype.getMaxValue=function(e){var t=this.binders[e];return t instanceof Ot||t instanceof Bt?t.maxValue:0},Rt.prototype.populatePaintArrays=function(e,t,i,l,p){for(var m in this.binders){var x=this.binders[m];(x instanceof Ot||x instanceof Bt||x instanceof Ht)&&x.populatePaintArray(e,t,i,l,p)}},Rt.prototype.setConstantPatternPositions=function(e,t){for(var i in this.binders){var l=this.binders[i];l instanceof Yt&&l.setConstantPatternPositions(e,t)}},Rt.prototype.updatePaintArrays=function(e,t,i,l,p){var m=!1;for(var x in e)for(var S=0,z=t.getPositions(x);S<z.length;S+=1){var A=z[S],C=i.feature(A.index);for(var B in this.binders){var U=this.binders[B];if((U instanceof Ot||U instanceof Bt||U instanceof Ht)&&U.expression.isStateDependent===!0){var q=l.paint.get(B);U.expression=q.value,U.updatePaintArray(A.start,A.end,C,e[x],p),m=!0}}}return m},Rt.prototype.defines=function(){var e=[];for(var t in this.binders){var i=this.binders[t];(i instanceof Nt||i instanceof Yt)&&e.push.apply(e,i.uniformNames.map(function(l){return"#define HAS_UNIFORM_"+l}))}return e},Rt.prototype.getBinderAttributes=function(){var e=[];for(var t in this.binders){var i=this.binders[t];if(i instanceof Ot||i instanceof Bt)for(var l=0;l<i.paintVertexAttributes.length;l++)e.push(i.paintVertexAttributes[l].name);else if(i instanceof Ht)for(var p=0;p<re.members.length;p++)e.push(re.members[p].name)}return e},Rt.prototype.getBinderUniforms=function(){var e=[];for(var t in this.binders){var i=this.binders[t];if(i instanceof Nt||i instanceof Yt||i instanceof Bt)for(var l=0,p=i.uniformNames;l<p.length;l+=1)e.push(p[l])}return e},Rt.prototype.getPaintVertexBuffers=function(){return this._buffers},Rt.prototype.getUniforms=function(e,t){var i=[];for(var l in this.binders){var p=this.binders[l];if(p instanceof Nt||p instanceof Yt||p instanceof Bt)for(var m=0,x=p.uniformNames;m<x.length;m+=1){var S=x[m];if(t[S]){var z=p.getBinding(e,t[S],S);i.push({name:S,property:l,binding:z})}}}return i},Rt.prototype.setUniforms=function(e,t,i,l){for(var p=0,m=t;p<m.length;p+=1){var x=m[p],S=x.name,z=x.property;this.binders[z].setUniform(x.binding,l,i.get(z),S)}},Rt.prototype.updatePaintBuffers=function(e){for(var t in this._buffers=[],this.binders){var i=this.binders[t];if(e&&i instanceof Ht){var l=e.fromScale===2?i.zoomInPaintVertexBuffer:i.zoomOutPaintVertexBuffer;l&&this._buffers.push(l)}else(i instanceof Ot||i instanceof Bt)&&i.paintVertexBuffer&&this._buffers.push(i.paintVertexBuffer)}},Rt.prototype.upload=function(e){for(var t in this.binders){var i=this.binders[t];(i instanceof Ot||i instanceof Bt||i instanceof Ht)&&i.upload(e)}this.updatePaintBuffers()},Rt.prototype.destroy=function(){for(var e in this.binders){var t=this.binders[e];(t instanceof Ot||t instanceof Bt||t instanceof Ht)&&t.destroy()}};var Ct=function(e,t,i){i===void 0&&(i=function(){return!0}),this.programConfigurations={};for(var l=0,p=e;l<p.length;l+=1){var m=p[l];this.programConfigurations[m.id]=new Rt(m,t,i)}this.needsUpload=!1,this._featureMap=new pe,this._bufferOffset=0};function Li(e,t){return{"text-opacity":["opacity"],"icon-opacity":["opacity"],"text-color":["fill_color"],"icon-color":["fill_color"],"text-halo-color":["halo_color"],"icon-halo-color":["halo_color"],"text-halo-blur":["halo_blur"],"icon-halo-blur":["halo_blur"],"text-halo-width":["halo_width"],"icon-halo-width":["halo_width"],"line-gap-width":["gapwidth"],"line-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-extrusion-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"]}[e]||[e.replace(t+"-","").replace(/-/g,"_")]}function ui(e,t,i){var l={color:{source:Xo,composite:nl},number:{source:eo,composite:Xo}},p=function(m){return{"line-pattern":{source:Ta,composite:Ta},"fill-pattern":{source:Ta,composite:Ta},"fill-extrusion-pattern":{source:Ta,composite:Ta}}[m]}(e);return p&&p[i]||l[t][i]}Ct.prototype.populatePaintArrays=function(e,t,i,l,p,m){for(var x in this.programConfigurations)this.programConfigurations[x].populatePaintArrays(e,t,l,p,m);t.id!==void 0&&this._featureMap.add(t.id,i,this._bufferOffset,e),this._bufferOffset=e,this.needsUpload=!0},Ct.prototype.updatePaintArrays=function(e,t,i,l){for(var p=0,m=i;p<m.length;p+=1){var x=m[p];this.needsUpload=this.programConfigurations[x.id].updatePaintArrays(e,this._featureMap,t,x,l)||this.needsUpload}},Ct.prototype.get=function(e){return this.programConfigurations[e]},Ct.prototype.upload=function(e){if(this.needsUpload){for(var t in this.programConfigurations)this.programConfigurations[t].upload(e);this.needsUpload=!1}},Ct.prototype.destroy=function(){for(var e in this.programConfigurations)this.programConfigurations[e].destroy()},st("ConstantBinder",Nt),st("CrossFadedConstantBinder",Yt),st("SourceExpressionBinder",Ot),st("CrossFadedCompositeBinder",Ht),st("CompositeExpressionBinder",Bt),st("ProgramConfiguration",Rt,{omit:["_buffers"]}),st("ProgramConfigurationSet",Ct);var pn=Math.pow(2,14)-1,Xi=-pn-1;function ni(e){for(var t=8192/e.extent,i=e.loadGeometry(),l=0;l<i.length;l++)for(var p=i[l],m=0;m<p.length;m++){var x=p[m],S=Math.round(x.x*t),z=Math.round(x.y*t);x.x=fe(S,Xi,pn),x.y=fe(z,Xi,pn),(S<x.x||S>x.x+1||z<x.y||z>x.y+1)&&yt("Geometry exceeds allowed extent, reduce your vector tile buffer size")}return i}function mi(e,t){return{type:e.type,id:e.id,properties:e.properties,geometry:t?ni(e):[]}}function Gn(e,t,i,l,p){e.emplaceBack(2*t+(l+1)/2,2*i+(p+1)/2)}var Sn=function(e){this.zoom=e.zoom,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map(function(t){return t.id}),this.index=e.index,this.hasPattern=!1,this.layoutVertexArray=new zo,this.indexArray=new Qa,this.segments=new G,this.programConfigurations=new Ct(e.layers,e.zoom),this.stateDependentLayerIds=this.layers.filter(function(t){return t.isStateDependent()}).map(function(t){return t.id})};function to(e,t){for(var i=0;i<e.length;i++)if(Ia(t,e[i]))return!0;for(var l=0;l<t.length;l++)if(Ia(e,t[l]))return!0;return!!Es(e,t)}function Pn(e,t,i){return!!Ia(e,t)||!!ro(t,e,i)}function _a(e,t){if(e.length===1)return Ts(t,e[0]);for(var i=0;i<t.length;i++)for(var l=t[i],p=0;p<l.length;p++)if(Ia(e,l[p]))return!0;for(var m=0;m<e.length;m++)if(Ts(t,e[m]))return!0;for(var x=0;x<t.length;x++)if(Es(e,t[x]))return!0;return!1}function oa(e,t,i){if(e.length>1){if(Es(e,t))return!0;for(var l=0;l<t.length;l++)if(ro(t[l],e,i))return!0}for(var p=0;p<e.length;p++)if(ro(e[p],t,i))return!0;return!1}function Es(e,t){if(e.length===0||t.length===0)return!1;for(var i=0;i<e.length-1;i++)for(var l=e[i],p=e[i+1],m=0;m<t.length-1;m++)if(Jo(l,p,t[m],t[m+1]))return!0;return!1}function Jo(e,t,i,l){return It(e,i,l)!==It(t,i,l)&&It(e,t,i)!==It(e,t,l)}function ro(e,t,i){var l=i*i;if(t.length===1)return e.distSqr(t[0])<l;for(var p=1;p<t.length;p++)if(Yo(e,t[p-1],t[p])<l)return!0;return!1}function Yo(e,t,i){var l=t.distSqr(i);if(l===0)return e.distSqr(t);var p=((e.x-t.x)*(i.x-t.x)+(e.y-t.y)*(i.y-t.y))/l;return e.distSqr(p<0?t:p>1?i:i.sub(t)._mult(p)._add(t))}function Ts(e,t){for(var i,l,p,m=!1,x=0;x<e.length;x++)for(var S=0,z=(i=e[x]).length-1;S<i.length;z=S++)(l=i[S]).y>t.y!=(p=i[z]).y>t.y&&t.x<(p.x-l.x)*(t.y-l.y)/(p.y-l.y)+l.x&&(m=!m);return m}function Ia(e,t){for(var i=!1,l=0,p=e.length-1;l<e.length;p=l++){var m=e[l],x=e[p];m.y>t.y!=x.y>t.y&&t.x<(x.x-m.x)*(t.y-m.y)/(x.y-m.y)+m.x&&(i=!i)}return i}function Is(e,t,i){var l=i[0],p=i[2];if(e.x<l.x&&t.x<l.x||e.x>p.x&&t.x>p.x||e.y<l.y&&t.y<l.y||e.y>p.y&&t.y>p.y)return!1;var m=It(e,t,i[0]);return m!==It(e,t,i[1])||m!==It(e,t,i[2])||m!==It(e,t,i[3])}function za(e,t,i){var l=t.paint.get(e).value;return l.kind==="constant"?l.value:i.programConfigurations.get(t.id).getMaxValue(e)}function Ri(e){return Math.sqrt(e[0]*e[0]+e[1]*e[1])}function Ba(e,t,i,l,p){if(!t[0]&&!t[1])return e;var m=F.convert(t)._mult(p);i==="viewport"&&m._rotate(-l);for(var x=[],S=0;S<e.length;S++)x.push(e[S].sub(m));return x}Sn.prototype.populate=function(e,t,i){var l=this.layers[0],p=[],m=null;l.type==="circle"&&(m=l.layout.get("circle-sort-key"));for(var x=0,S=e;x<S.length;x+=1){var z=S[x],A=z.feature,C=z.id,B=z.index,U=z.sourceLayerIndex,q=this.layers[0]._featureFilter.needGeometry,Q=mi(A,q);if(this.layers[0]._featureFilter.filter(new ur(this.zoom),Q,i)){var ee=m?m.evaluate(Q,{},i):void 0,ce={id:C,properties:A.properties,type:A.type,sourceLayerIndex:U,index:B,geometry:q?Q.geometry:ni(A),patterns:{},sortKey:ee};p.push(ce)}}m&&p.sort(function(Qe,mt){return Qe.sortKey-mt.sortKey});for(var ie=0,me=p;ie<me.length;ie+=1){var be=me[ie],ke=be.geometry,Ie=be.index,Pe=be.sourceLayerIndex,je=e[Ie].feature;this.addFeature(be,ke,Ie,i),t.featureIndex.insert(je,ke,Ie,Pe,this.index)}},Sn.prototype.update=function(e,t,i){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(e,t,this.stateDependentLayers,i)},Sn.prototype.isEmpty=function(){return this.layoutVertexArray.length===0},Sn.prototype.uploadPending=function(){return!this.uploaded||this.programConfigurations.needsUpload},Sn.prototype.upload=function(e){this.uploaded||(this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,Z),this.indexBuffer=e.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(e),this.uploaded=!0},Sn.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())},Sn.prototype.addFeature=function(e,t,i,l){for(var p=0,m=t;p<m.length;p+=1)for(var x=0,S=m[p];x<S.length;x+=1){var z=S[x],A=z.x,C=z.y;if(!(A<0||A>=8192||C<0||C>=8192)){var B=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray,e.sortKey),U=B.vertexLength;Gn(this.layoutVertexArray,A,C,-1,-1),Gn(this.layoutVertexArray,A,C,1,-1),Gn(this.layoutVertexArray,A,C,1,1),Gn(this.layoutVertexArray,A,C,-1,1),this.indexArray.emplaceBack(U,U+1,U+2),this.indexArray.emplaceBack(U,U+3,U+2),B.vertexLength+=4,B.primitiveLength+=2}}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,e,i,{},l)},st("CircleBucket",Sn,{omit:["layers"]});var io=new an({"circle-sort-key":new ut(j.layout_circle["circle-sort-key"])}),Po={paint:new an({"circle-radius":new ut(j.paint_circle["circle-radius"]),"circle-color":new ut(j.paint_circle["circle-color"]),"circle-blur":new ut(j.paint_circle["circle-blur"]),"circle-opacity":new ut(j.paint_circle["circle-opacity"]),"circle-translate":new gt(j.paint_circle["circle-translate"]),"circle-translate-anchor":new gt(j.paint_circle["circle-translate-anchor"]),"circle-pitch-scale":new gt(j.paint_circle["circle-pitch-scale"]),"circle-pitch-alignment":new gt(j.paint_circle["circle-pitch-alignment"]),"circle-stroke-width":new ut(j.paint_circle["circle-stroke-width"]),"circle-stroke-color":new ut(j.paint_circle["circle-stroke-color"]),"circle-stroke-opacity":new ut(j.paint_circle["circle-stroke-opacity"])}),layout:io},Sr=typeof Float32Array<"u"?Float32Array:Array;function $n(e){return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}function Cn(e,t,i){var l=t[0],p=t[1],m=t[2],x=t[3],S=t[4],z=t[5],A=t[6],C=t[7],B=t[8],U=t[9],q=t[10],Q=t[11],ee=t[12],ce=t[13],ie=t[14],me=t[15],be=i[0],ke=i[1],Ie=i[2],Pe=i[3];return e[0]=be*l+ke*S+Ie*B+Pe*ee,e[1]=be*p+ke*z+Ie*U+Pe*ce,e[2]=be*m+ke*A+Ie*q+Pe*ie,e[3]=be*x+ke*C+Ie*Q+Pe*me,e[4]=(be=i[4])*l+(ke=i[5])*S+(Ie=i[6])*B+(Pe=i[7])*ee,e[5]=be*p+ke*z+Ie*U+Pe*ce,e[6]=be*m+ke*A+Ie*q+Pe*ie,e[7]=be*x+ke*C+Ie*Q+Pe*me,e[8]=(be=i[8])*l+(ke=i[9])*S+(Ie=i[10])*B+(Pe=i[11])*ee,e[9]=be*p+ke*z+Ie*U+Pe*ce,e[10]=be*m+ke*A+Ie*q+Pe*ie,e[11]=be*x+ke*C+Ie*Q+Pe*me,e[12]=(be=i[12])*l+(ke=i[13])*S+(Ie=i[14])*B+(Pe=i[15])*ee,e[13]=be*p+ke*z+Ie*U+Pe*ce,e[14]=be*m+ke*A+Ie*q+Pe*ie,e[15]=be*x+ke*C+Ie*Q+Pe*me,e}Math.hypot||(Math.hypot=function(){for(var e=arguments,t=0,i=arguments.length;i--;)t+=e[i]*e[i];return Math.sqrt(t)});var Co,Hh=Cn;function al(e,t,i){var l=t[0],p=t[1],m=t[2],x=t[3];return e[0]=i[0]*l+i[4]*p+i[8]*m+i[12]*x,e[1]=i[1]*l+i[5]*p+i[9]*m+i[13]*x,e[2]=i[2]*l+i[6]*p+i[10]*m+i[14]*x,e[3]=i[3]*l+i[7]*p+i[11]*m+i[15]*x,e}Co=new Sr(3),Sr!=Float32Array&&(Co[0]=0,Co[1]=0,Co[2]=0),function(){var e=new Sr(4);Sr!=Float32Array&&(e[0]=0,e[1]=0,e[2]=0,e[3]=0)}();var Jh=(function(){var e=new Sr(2);Sr!=Float32Array&&(e[0]=0,e[1]=0)}(),function(e){function t(i){e.call(this,i,Po)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.createBucket=function(i){return new Sn(i)},t.prototype.queryRadius=function(i){var l=i;return za("circle-radius",this,l)+za("circle-stroke-width",this,l)+Ri(this.paint.get("circle-translate"))},t.prototype.queryIntersectsFeature=function(i,l,p,m,x,S,z,A){for(var C=Ba(i,this.paint.get("circle-translate"),this.paint.get("circle-translate-anchor"),S.angle,z),B=this.paint.get("circle-radius").evaluate(l,p)+this.paint.get("circle-stroke-width").evaluate(l,p),U=this.paint.get("circle-pitch-alignment")==="map",q=U?C:function(je,Qe){return je.map(function(mt){return zs(mt,Qe)})}(C,A),Q=U?B*z:B,ee=0,ce=m;ee<ce.length;ee+=1)for(var ie=0,me=ce[ee];ie<me.length;ie+=1){var be=me[ie],ke=U?be:zs(be,A),Ie=Q,Pe=al([],[be.x,be.y,0,1],A);if(this.paint.get("circle-pitch-scale")==="viewport"&&this.paint.get("circle-pitch-alignment")==="map"?Ie*=Pe[3]/S.cameraToCenterDistance:this.paint.get("circle-pitch-scale")==="map"&&this.paint.get("circle-pitch-alignment")==="viewport"&&(Ie*=S.cameraToCenterDistance/Pe[3]),Pn(q,ke,Ie))return!0}return!1},t}(Ea));function zs(e,t){var i=al([],[e.x,e.y,0,1],t);return new F(i[0]/i[3],i[1]/i[3])}var Ac=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t}(Sn);function Qo(e,t,i,l){var p=t.width,m=t.height;if(l){if(l instanceof Uint8ClampedArray)l=new Uint8Array(l.buffer);else if(l.length!==p*m*i)throw new RangeError("mismatched image size")}else l=new Uint8Array(p*m*i);return e.width=p,e.height=m,e.data=l,e}function ol(e,t,i){var l=t.width,p=t.height;if(l!==e.width||p!==e.height){var m=Qo({},{width:l,height:p},i);Yh(e,m,{x:0,y:0},{x:0,y:0},{width:Math.min(e.width,l),height:Math.min(e.height,p)},i),e.width=l,e.height=p,e.data=m.data}}function Yh(e,t,i,l,p,m){if(p.width===0||p.height===0)return t;if(p.width>e.width||p.height>e.height||i.x>e.width-p.width||i.y>e.height-p.height)throw new RangeError("out of range source coordinates for image copy");if(p.width>t.width||p.height>t.height||l.x>t.width-p.width||l.y>t.height-p.height)throw new RangeError("out of range destination coordinates for image copy");for(var x=e.data,S=t.data,z=0;z<p.height;z++)for(var A=((i.y+z)*e.width+i.x)*m,C=((l.y+z)*t.width+l.x)*m,B=0;B<p.width*m;B++)S[C+B]=x[A+B];return t}st("HeatmapBucket",Ac,{omit:["layers"]});var As=function(e,t){Qo(this,e,1,t)};As.prototype.resize=function(e){ol(this,e,1)},As.prototype.clone=function(){return new As({width:this.width,height:this.height},new Uint8Array(this.data))},As.copy=function(e,t,i,l,p){Yh(e,t,i,l,p,1)};var Kn=function(e,t){Qo(this,e,4,t)};Kn.prototype.resize=function(e){ol(this,e,4)},Kn.prototype.replace=function(e,t){t?this.data.set(e):this.data=e instanceof Uint8ClampedArray?new Uint8Array(e.buffer):e},Kn.prototype.clone=function(){return new Kn({width:this.width,height:this.height},new Uint8Array(this.data))},Kn.copy=function(e,t,i,l,p){Yh(e,t,i,l,p,4)},st("AlphaImage",As),st("RGBAImage",Kn);var xy={paint:new an({"heatmap-radius":new ut(j.paint_heatmap["heatmap-radius"]),"heatmap-weight":new ut(j.paint_heatmap["heatmap-weight"]),"heatmap-intensity":new gt(j.paint_heatmap["heatmap-intensity"]),"heatmap-color":new ya(j.paint_heatmap["heatmap-color"]),"heatmap-opacity":new gt(j.paint_heatmap["heatmap-opacity"])})};function Yp(e){var t={},i=e.resolution||256,l=e.clips?e.clips.length:1,p=e.image||new Kn({width:i,height:l}),m=function(Q,ee,ce){t[e.evaluationKey]=ce;var ie=e.expression.evaluate(t);p.data[Q+ee+0]=Math.floor(255*ie.r/ie.a),p.data[Q+ee+1]=Math.floor(255*ie.g/ie.a),p.data[Q+ee+2]=Math.floor(255*ie.b/ie.a),p.data[Q+ee+3]=Math.floor(255*ie.a)};if(e.clips)for(var x=0,S=0;x<l;++x,S+=4*i)for(var z=0,A=0;z<i;z++,A+=4){var C=z/(i-1),B=e.clips[x];m(S,A,B.start*(1-C)+B.end*C)}else for(var U=0,q=0;U<i;U++,q+=4)m(0,q,U/(i-1));return p}var wy=function(e){function t(i){e.call(this,i,xy),this._updateColorRamp()}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.createBucket=function(i){return new Ac(i)},t.prototype._handleSpecialPaintPropertyUpdate=function(i){i==="heatmap-color"&&this._updateColorRamp()},t.prototype._updateColorRamp=function(){this.colorRamp=Yp({expression:this._transitionablePaint._values["heatmap-color"].value.expression,evaluationKey:"heatmapDensity",image:this.colorRamp}),this.colorRampTexture=null},t.prototype.resize=function(){this.heatmapFbo&&(this.heatmapFbo.destroy(),this.heatmapFbo=null)},t.prototype.queryRadius=function(){return 0},t.prototype.queryIntersectsFeature=function(){return!1},t.prototype.hasOffscreenPass=function(){return this.paint.get("heatmap-opacity")!==0&&this.visibility!=="none"},t}(Ea),ky={paint:new an({"hillshade-illumination-direction":new gt(j.paint_hillshade["hillshade-illumination-direction"]),"hillshade-illumination-anchor":new gt(j.paint_hillshade["hillshade-illumination-anchor"]),"hillshade-exaggeration":new gt(j.paint_hillshade["hillshade-exaggeration"]),"hillshade-shadow-color":new gt(j.paint_hillshade["hillshade-shadow-color"]),"hillshade-highlight-color":new gt(j.paint_hillshade["hillshade-highlight-color"]),"hillshade-accent-color":new gt(j.paint_hillshade["hillshade-accent-color"])})},Sy=function(e){function t(i){e.call(this,i,ky)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.hasOffscreenPass=function(){return this.paint.get("hillshade-exaggeration")!==0&&this.visibility!=="none"},t}(Ea),Ey=Ki([{name:"a_pos",components:2,type:"Int16"}],4).members,Qh=Pc,Ty=Pc;function Pc(e,t,i){i=i||2;var l,p,m,x,S,z,A,C=t&&t.length,B=C?t[0]*i:e.length,U=Qp(e,0,B,i,!0),q=[];if(!U||U.next===U.prev)return q;if(C&&(U=function(ee,ce,ie,me){var be,ke,Ie,Pe=[];for(be=0,ke=ce.length;be<ke;be++)(Ie=Qp(ee,ce[be]*me,be<ke-1?ce[be+1]*me:ee.length,me,!1))===Ie.next&&(Ie.steiner=!0),Pe.push(Ly(Ie));for(Pe.sort(Cy),be=0;be<Pe.length;be++)My(Pe[be],ie),ie=$o(ie,ie.next);return ie}(e,t,U,i)),e.length>80*i){l=m=e[0],p=x=e[1];for(var Q=i;Q<B;Q+=i)(S=e[Q])<l&&(l=S),(z=e[Q+1])<p&&(p=z),S>m&&(m=S),z>x&&(x=z);A=(A=Math.max(m-l,x-p))!==0?1/A:0}return lu(U,q,i,l,p,A),q}function Qp(e,t,i,l,p){var m,x;if(p===tp(e,t,i,l)>0)for(m=t;m<i;m+=l)x=tf(m,e[m],e[m+1],x);else for(m=i-l;m>=t;m-=l)x=tf(m,e[m],e[m+1],x);return x&&Cc(x,x.next)&&(cu(x),x=x.next),x}function $o(e,t){if(!e)return e;t||(t=e);var i,l=e;do if(i=!1,l.steiner||!Cc(l,l.next)&&zi(l.prev,l,l.next)!==0)l=l.next;else{if(cu(l),(l=t=l.prev)===l.next)break;i=!0}while(i||l!==t);return t}function lu(e,t,i,l,p,m,x){if(e){!x&&m&&function(C,B,U,q){var Q=C;do Q.z===null&&(Q.z=$h(Q.x,Q.y,B,U,q)),Q.prevZ=Q.prev,Q.nextZ=Q.next,Q=Q.next;while(Q!==C);Q.prevZ.nextZ=null,Q.prevZ=null,function(ee){var ce,ie,me,be,ke,Ie,Pe,je,Qe=1;do{for(ie=ee,ee=null,ke=null,Ie=0;ie;){for(Ie++,me=ie,Pe=0,ce=0;ce<Qe&&(Pe++,me=me.nextZ);ce++);for(je=Qe;Pe>0||je>0&&me;)Pe!==0&&(je===0||!me||ie.z<=me.z)?(be=ie,ie=ie.nextZ,Pe--):(be=me,me=me.nextZ,je--),ke?ke.nextZ=be:ee=be,be.prevZ=ke,ke=be;ie=me}ke.nextZ=null,Qe*=2}while(Ie>1)}(Q)}(e,l,p,m);for(var S,z,A=e;e.prev!==e.next;)if(S=e.prev,z=e.next,m?zy(e,l,p,m):Iy(e))t.push(S.i/i),t.push(e.i/i),t.push(z.i/i),cu(e),e=z.next,A=z.next;else if((e=z)===A){x?x===1?lu(e=Ay($o(e),t,i),t,i,l,p,m,2):x===2&&Py(e,t,i,l,p,m):lu($o(e),t,i,l,p,m,1);break}}}function Iy(e){var t=e.prev,i=e,l=e.next;if(zi(t,i,l)>=0)return!1;for(var p=e.next.next;p!==e.prev;){if(sl(t.x,t.y,i.x,i.y,l.x,l.y,p.x,p.y)&&zi(p.prev,p,p.next)>=0)return!1;p=p.next}return!0}function zy(e,t,i,l){var p=e.prev,m=e,x=e.next;if(zi(p,m,x)>=0)return!1;for(var S=p.x>m.x?p.x>x.x?p.x:x.x:m.x>x.x?m.x:x.x,z=p.y>m.y?p.y>x.y?p.y:x.y:m.y>x.y?m.y:x.y,A=$h(p.x<m.x?p.x<x.x?p.x:x.x:m.x<x.x?m.x:x.x,p.y<m.y?p.y<x.y?p.y:x.y:m.y<x.y?m.y:x.y,t,i,l),C=$h(S,z,t,i,l),B=e.prevZ,U=e.nextZ;B&&B.z>=A&&U&&U.z<=C;){if(B!==e.prev&&B!==e.next&&sl(p.x,p.y,m.x,m.y,x.x,x.y,B.x,B.y)&&zi(B.prev,B,B.next)>=0||(B=B.prevZ,U!==e.prev&&U!==e.next&&sl(p.x,p.y,m.x,m.y,x.x,x.y,U.x,U.y)&&zi(U.prev,U,U.next)>=0))return!1;U=U.nextZ}for(;B&&B.z>=A;){if(B!==e.prev&&B!==e.next&&sl(p.x,p.y,m.x,m.y,x.x,x.y,B.x,B.y)&&zi(B.prev,B,B.next)>=0)return!1;B=B.prevZ}for(;U&&U.z<=C;){if(U!==e.prev&&U!==e.next&&sl(p.x,p.y,m.x,m.y,x.x,x.y,U.x,U.y)&&zi(U.prev,U,U.next)>=0)return!1;U=U.nextZ}return!0}function Ay(e,t,i){var l=e;do{var p=l.prev,m=l.next.next;!Cc(p,m)&&$p(p,l,l.next,m)&&uu(p,m)&&uu(m,p)&&(t.push(p.i/i),t.push(l.i/i),t.push(m.i/i),cu(l),cu(l.next),l=e=m),l=l.next}while(l!==e);return $o(l)}function Py(e,t,i,l,p,m){var x=e;do{for(var S=x.next.next;S!==x.prev;){if(x.i!==S.i&&Ry(x,S)){var z=ef(x,S);return x=$o(x,x.next),z=$o(z,z.next),lu(x,t,i,l,p,m),void lu(z,t,i,l,p,m)}S=S.next}x=x.next}while(x!==e)}function Cy(e,t){return e.x-t.x}function My(e,t){if(t=function(l,p){var m,x=p,S=l.x,z=l.y,A=-1/0;do{if(z<=x.y&&z>=x.next.y&&x.next.y!==x.y){var C=x.x+(z-x.y)*(x.next.x-x.x)/(x.next.y-x.y);if(C<=S&&C>A){if(A=C,C===S){if(z===x.y)return x;if(z===x.next.y)return x.next}m=x.x<x.next.x?x:x.next}}x=x.next}while(x!==p);if(!m)return null;if(S===A)return m;var B,U=m,q=m.x,Q=m.y,ee=1/0;x=m;do S>=x.x&&x.x>=q&&S!==x.x&&sl(z<Q?S:A,z,q,Q,z<Q?A:S,z,x.x,x.y)&&(B=Math.abs(z-x.y)/(S-x.x),uu(x,l)&&(B<ee||B===ee&&(x.x>m.x||x.x===m.x&&Dy(m,x)))&&(m=x,ee=B)),x=x.next;while(x!==U);return m}(e,t)){var i=ef(t,e);$o(t,t.next),$o(i,i.next)}}function Dy(e,t){return zi(e.prev,e,t.prev)<0&&zi(t.next,e,e.next)<0}function $h(e,t,i,l,p){return(e=1431655765&((e=858993459&((e=252645135&((e=16711935&((e=32767*(e-i)*p)|e<<8))|e<<4))|e<<2))|e<<1))|(t=1431655765&((t=858993459&((t=252645135&((t=16711935&((t=32767*(t-l)*p)|t<<8))|t<<4))|t<<2))|t<<1))<<1}function Ly(e){var t=e,i=e;do(t.x<i.x||t.x===i.x&&t.y<i.y)&&(i=t),t=t.next;while(t!==e);return i}function sl(e,t,i,l,p,m,x,S){return(p-x)*(t-S)-(e-x)*(m-S)>=0&&(e-x)*(l-S)-(i-x)*(t-S)>=0&&(i-x)*(m-S)-(p-x)*(l-S)>=0}function Ry(e,t){return e.next.i!==t.i&&e.prev.i!==t.i&&!function(i,l){var p=i;do{if(p.i!==i.i&&p.next.i!==i.i&&p.i!==l.i&&p.next.i!==l.i&&$p(p,p.next,i,l))return!0;p=p.next}while(p!==i);return!1}(e,t)&&(uu(e,t)&&uu(t,e)&&function(i,l){var p=i,m=!1,x=(i.x+l.x)/2,S=(i.y+l.y)/2;do p.y>S!=p.next.y>S&&p.next.y!==p.y&&x<(p.next.x-p.x)*(S-p.y)/(p.next.y-p.y)+p.x&&(m=!m),p=p.next;while(p!==i);return m}(e,t)&&(zi(e.prev,e,t.prev)||zi(e,t.prev,t))||Cc(e,t)&&zi(e.prev,e,e.next)>0&&zi(t.prev,t,t.next)>0)}function zi(e,t,i){return(t.y-e.y)*(i.x-t.x)-(t.x-e.x)*(i.y-t.y)}function Cc(e,t){return e.x===t.x&&e.y===t.y}function $p(e,t,i,l){var p=Dc(zi(e,t,i)),m=Dc(zi(e,t,l)),x=Dc(zi(i,l,e)),S=Dc(zi(i,l,t));return p!==m&&x!==S||!(p!==0||!Mc(e,i,t))||!(m!==0||!Mc(e,l,t))||!(x!==0||!Mc(i,e,l))||!(S!==0||!Mc(i,t,l))}function Mc(e,t,i){return t.x<=Math.max(e.x,i.x)&&t.x>=Math.min(e.x,i.x)&&t.y<=Math.max(e.y,i.y)&&t.y>=Math.min(e.y,i.y)}function Dc(e){return e>0?1:e<0?-1:0}function uu(e,t){return zi(e.prev,e,e.next)<0?zi(e,t,e.next)>=0&&zi(e,e.prev,t)>=0:zi(e,t,e.prev)<0||zi(e,e.next,t)<0}function ef(e,t){var i=new ep(e.i,e.x,e.y),l=new ep(t.i,t.x,t.y),p=e.next,m=t.prev;return e.next=t,t.prev=e,i.next=p,p.prev=i,l.next=i,i.prev=l,m.next=l,l.prev=m,l}function tf(e,t,i,l){var p=new ep(e,t,i);return l?(p.next=l.next,p.prev=l,l.next.prev=p,l.next=p):(p.prev=p,p.next=p),p}function cu(e){e.next.prev=e.prev,e.prev.next=e.next,e.prevZ&&(e.prevZ.nextZ=e.nextZ),e.nextZ&&(e.nextZ.prevZ=e.prevZ)}function ep(e,t,i){this.i=e,this.x=t,this.y=i,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}function tp(e,t,i,l){for(var p=0,m=t,x=i-l;m<i;m+=l)p+=(e[x]-e[m])*(e[m+1]+e[x+1]),x=m;return p}function By(e,t,i,l,p){(function m(x,S,z,A,C){for(;A>z;){if(A-z>600){var B=A-z+1,U=S-z+1,q=Math.log(B),Q=.5*Math.exp(2*q/3),ee=.5*Math.sqrt(q*Q*(B-Q)/B)*(U-B/2<0?-1:1);m(x,S,Math.max(z,Math.floor(S-U*Q/B+ee)),Math.min(A,Math.floor(S+(B-U)*Q/B+ee)),C)}var ce=x[S],ie=z,me=A;for(hu(x,z,S),C(x[A],ce)>0&&hu(x,z,A);ie<me;){for(hu(x,ie,me),ie++,me--;C(x[ie],ce)<0;)ie++;for(;C(x[me],ce)>0;)me--}C(x[z],ce)===0?hu(x,z,me):hu(x,++me,A),me<=S&&(z=me+1),S<=me&&(A=me-1)}})(e,t,i||0,l||e.length-1,p||Oy)}function hu(e,t,i){var l=e[t];e[t]=e[i],e[i]=l}function Oy(e,t){return e<t?-1:e>t?1:0}function rp(e,t){var i=e.length;if(i<=1)return[e];for(var l,p,m=[],x=0;x<i;x++){var S=tt(e[x]);S!==0&&(e[x].area=Math.abs(S),p===void 0&&(p=S<0),p===S<0?(l&&m.push(l),l=[e[x]]):l.push(e[x]))}if(l&&m.push(l),t>1)for(var z=0;z<m.length;z++)m[z].length<=t||(By(m[z],t,1,m[z].length-1,Fy),m[z]=m[z].slice(0,t));return m}function Fy(e,t){return t.area-e.area}function ip(e,t,i){for(var l=i.patternDependencies,p=!1,m=0,x=t;m<x.length;m+=1){var S=x[m].paint.get(e+"-pattern");S.isConstant()||(p=!0);var z=S.constantOr(null);z&&(p=!0,l[z.to]=!0,l[z.from]=!0)}return p}function np(e,t,i,l,p){for(var m=p.patternDependencies,x=0,S=t;x<S.length;x+=1){var z=S[x],A=z.paint.get(e+"-pattern").value;if(A.kind!=="constant"){var C=A.evaluate({zoom:l-1},i,{},p.availableImages),B=A.evaluate({zoom:l},i,{},p.availableImages),U=A.evaluate({zoom:l+1},i,{},p.availableImages);B=B&&B.name?B.name:B,U=U&&U.name?U.name:U,m[C=C&&C.name?C.name:C]=!0,m[B]=!0,m[U]=!0,i.patterns[z.id]={min:C,mid:B,max:U}}}return i}Pc.deviation=function(e,t,i,l){var p=t&&t.length,m=Math.abs(tp(e,0,p?t[0]*i:e.length,i));if(p)for(var x=0,S=t.length;x<S;x++)m-=Math.abs(tp(e,t[x]*i,x<S-1?t[x+1]*i:e.length,i));var z=0;for(x=0;x<l.length;x+=3){var A=l[x]*i,C=l[x+1]*i,B=l[x+2]*i;z+=Math.abs((e[A]-e[B])*(e[C+1]-e[A+1])-(e[A]-e[C])*(e[B+1]-e[A+1]))}return m===0&&z===0?0:Math.abs((z-m)/m)},Pc.flatten=function(e){for(var t=e[0][0].length,i={vertices:[],holes:[],dimensions:t},l=0,p=0;p<e.length;p++){for(var m=0;m<e[p].length;m++)for(var x=0;x<t;x++)i.vertices.push(e[p][m][x]);p>0&&i.holes.push(l+=e[p-1].length)}return i},Qh.default=Ty;var Oa=function(e){this.zoom=e.zoom,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map(function(t){return t.id}),this.index=e.index,this.hasPattern=!1,this.patternFeatures=[],this.layoutVertexArray=new zo,this.indexArray=new Qa,this.indexArray2=new Ss,this.programConfigurations=new Ct(e.layers,e.zoom),this.segments=new G,this.segments2=new G,this.stateDependentLayerIds=this.layers.filter(function(t){return t.isStateDependent()}).map(function(t){return t.id})};Oa.prototype.populate=function(e,t,i){this.hasPattern=ip("fill",this.layers,t);for(var l=this.layers[0].layout.get("fill-sort-key"),p=[],m=0,x=e;m<x.length;m+=1){var S=x[m],z=S.feature,A=S.id,C=S.index,B=S.sourceLayerIndex,U=this.layers[0]._featureFilter.needGeometry,q=mi(z,U);if(this.layers[0]._featureFilter.filter(new ur(this.zoom),q,i)){var Q=l?l.evaluate(q,{},i,t.availableImages):void 0,ee={id:A,properties:z.properties,type:z.type,sourceLayerIndex:B,index:C,geometry:U?q.geometry:ni(z),patterns:{},sortKey:Q};p.push(ee)}}l&&p.sort(function(je,Qe){return je.sortKey-Qe.sortKey});for(var ce=0,ie=p;ce<ie.length;ce+=1){var me=ie[ce],be=me.geometry,ke=me.index,Ie=me.sourceLayerIndex;if(this.hasPattern){var Pe=np("fill",this.layers,me,this.zoom,t);this.patternFeatures.push(Pe)}else this.addFeature(me,be,ke,i,{});t.featureIndex.insert(e[ke].feature,be,ke,Ie,this.index)}},Oa.prototype.update=function(e,t,i){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(e,t,this.stateDependentLayers,i)},Oa.prototype.addFeatures=function(e,t,i){for(var l=0,p=this.patternFeatures;l<p.length;l+=1){var m=p[l];this.addFeature(m,m.geometry,m.index,t,i)}},Oa.prototype.isEmpty=function(){return this.layoutVertexArray.length===0},Oa.prototype.uploadPending=function(){return!this.uploaded||this.programConfigurations.needsUpload},Oa.prototype.upload=function(e){this.uploaded||(this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,Ey),this.indexBuffer=e.createIndexBuffer(this.indexArray),this.indexBuffer2=e.createIndexBuffer(this.indexArray2)),this.programConfigurations.upload(e),this.uploaded=!0},Oa.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.indexBuffer2.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.segments2.destroy())},Oa.prototype.addFeature=function(e,t,i,l,p){for(var m=0,x=rp(t,500);m<x.length;m+=1){for(var S=x[m],z=0,A=0,C=S;A<C.length;A+=1)z+=C[A].length;for(var B=this.segments.prepareSegment(z,this.layoutVertexArray,this.indexArray),U=B.vertexLength,q=[],Q=[],ee=0,ce=S;ee<ce.length;ee+=1){var ie=ce[ee];if(ie.length!==0){ie!==S[0]&&Q.push(q.length/2);var me=this.segments2.prepareSegment(ie.length,this.layoutVertexArray,this.indexArray2),be=me.vertexLength;this.layoutVertexArray.emplaceBack(ie[0].x,ie[0].y),this.indexArray2.emplaceBack(be+ie.length-1,be),q.push(ie[0].x),q.push(ie[0].y);for(var ke=1;ke<ie.length;ke++)this.layoutVertexArray.emplaceBack(ie[ke].x,ie[ke].y),this.indexArray2.emplaceBack(be+ke-1,be+ke),q.push(ie[ke].x),q.push(ie[ke].y);me.vertexLength+=ie.length,me.primitiveLength+=ie.length}}for(var Ie=Qh(q,Q),Pe=0;Pe<Ie.length;Pe+=3)this.indexArray.emplaceBack(U+Ie[Pe],U+Ie[Pe+1],U+Ie[Pe+2]);B.vertexLength+=z,B.primitiveLength+=Ie.length/3}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,e,i,p,l)},st("FillBucket",Oa,{omit:["layers","patternFeatures"]});var Ny=new an({"fill-sort-key":new ut(j.layout_fill["fill-sort-key"])}),Uy={paint:new an({"fill-antialias":new gt(j.paint_fill["fill-antialias"]),"fill-opacity":new ut(j.paint_fill["fill-opacity"]),"fill-color":new ut(j.paint_fill["fill-color"]),"fill-outline-color":new ut(j.paint_fill["fill-outline-color"]),"fill-translate":new gt(j.paint_fill["fill-translate"]),"fill-translate-anchor":new gt(j.paint_fill["fill-translate-anchor"]),"fill-pattern":new el(j.paint_fill["fill-pattern"])}),layout:Ny},Vy=function(e){function t(i){e.call(this,i,Uy)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.recalculate=function(i,l){e.prototype.recalculate.call(this,i,l);var p=this.paint._values["fill-outline-color"];p.value.kind==="constant"&&p.value.value===void 0&&(this.paint._values["fill-outline-color"]=this.paint._values["fill-color"])},t.prototype.createBucket=function(i){return new Oa(i)},t.prototype.queryRadius=function(){return Ri(this.paint.get("fill-translate"))},t.prototype.queryIntersectsFeature=function(i,l,p,m,x,S,z){return _a(Ba(i,this.paint.get("fill-translate"),this.paint.get("fill-translate-anchor"),S.angle,z),m)},t.prototype.isTileClipped=function(){return!0},t}(Ea),jy=Ki([{name:"a_pos",components:2,type:"Int16"},{name:"a_normal_ed",components:4,type:"Int16"}],4).members,rf=ll;function ll(e,t,i,l,p){this.properties={},this.extent=i,this.type=0,this._pbf=e,this._geometry=-1,this._keys=l,this._values=p,e.readFields(qy,this,t)}function qy(e,t,i){e==1?t.id=i.readVarint():e==2?function(l,p){for(var m=l.readVarint()+l.pos;l.pos<m;){var x=p._keys[l.readVarint()],S=p._values[l.readVarint()];p.properties[x]=S}}(i,t):e==3?t.type=i.readVarint():e==4&&(t._geometry=i.pos)}function Zy(e){for(var t,i,l=0,p=0,m=e.length,x=m-1;p<m;x=p++)l+=((i=e[x]).x-(t=e[p]).x)*(t.y+i.y);return l}ll.types=["Unknown","Point","LineString","Polygon"],ll.prototype.loadGeometry=function(){var e=this._pbf;e.pos=this._geometry;for(var t,i=e.readVarint()+e.pos,l=1,p=0,m=0,x=0,S=[];e.pos<i;){if(p<=0){var z=e.readVarint();l=7&z,p=z>>3}if(p--,l===1||l===2)m+=e.readSVarint(),x+=e.readSVarint(),l===1&&(t&&S.push(t),t=[]),t.push(new F(m,x));else{if(l!==7)throw new Error("unknown command "+l);t&&t.push(t[0].clone())}}return t&&S.push(t),S},ll.prototype.bbox=function(){var e=this._pbf;e.pos=this._geometry;for(var t=e.readVarint()+e.pos,i=1,l=0,p=0,m=0,x=1/0,S=-1/0,z=1/0,A=-1/0;e.pos<t;){if(l<=0){var C=e.readVarint();i=7&C,l=C>>3}if(l--,i===1||i===2)(p+=e.readSVarint())<x&&(x=p),p>S&&(S=p),(m+=e.readSVarint())<z&&(z=m),m>A&&(A=m);else if(i!==7)throw new Error("unknown command "+i)}return[x,z,S,A]},ll.prototype.toGeoJSON=function(e,t,i){var l,p,m=this.extent*Math.pow(2,i),x=this.extent*e,S=this.extent*t,z=this.loadGeometry(),A=ll.types[this.type];function C(q){for(var Q=0;Q<q.length;Q++){var ee=q[Q];q[Q]=[360*(ee.x+x)/m-180,360/Math.PI*Math.atan(Math.exp((180-360*(ee.y+S)/m)*Math.PI/180))-90]}}switch(this.type){case 1:var B=[];for(l=0;l<z.length;l++)B[l]=z[l][0];C(z=B);break;case 2:for(l=0;l<z.length;l++)C(z[l]);break;case 3:for(z=function(q){var Q=q.length;if(Q<=1)return[q];for(var ee,ce,ie=[],me=0;me<Q;me++){var be=Zy(q[me]);be!==0&&(ce===void 0&&(ce=be<0),ce===be<0?(ee&&ie.push(ee),ee=[q[me]]):ee.push(q[me]))}return ee&&ie.push(ee),ie}(z),l=0;l<z.length;l++)for(p=0;p<z[l].length;p++)C(z[l][p])}z.length===1?z=z[0]:A="Multi"+A;var U={type:"Feature",geometry:{type:A,coordinates:z},properties:this.properties};return"id"in this&&(U.id=this.id),U};var nf=af;function af(e,t){this.version=1,this.name=null,this.extent=4096,this.length=0,this._pbf=e,this._keys=[],this._values=[],this._features=[],e.readFields(Gy,this,t),this.length=this._features.length}function Gy(e,t,i){e===15?t.version=i.readVarint():e===1?t.name=i.readString():e===5?t.extent=i.readVarint():e===2?t._features.push(i.pos):e===3?t._keys.push(i.readString()):e===4&&t._values.push(function(l){for(var p=null,m=l.readVarint()+l.pos;l.pos<m;){var x=l.readVarint()>>3;p=x===1?l.readString():x===2?l.readFloat():x===3?l.readDouble():x===4?l.readVarint64():x===5?l.readVarint():x===6?l.readSVarint():x===7?l.readBoolean():null}return p}(i))}function Ky(e,t,i){if(e===3){var l=new nf(i,i.readVarint()+i.pos);l.length&&(t[l.name]=l)}}af.prototype.feature=function(e){if(e<0||e>=this._features.length)throw new Error("feature index out of bounds");this._pbf.pos=this._features[e];var t=this._pbf.readVarint()+this._pbf.pos;return new rf(this._pbf,t,this.extent,this._keys,this._values)};var ul={VectorTile:function(e,t){this.layers=e.readFields(Ky,{},t)},VectorTileFeature:rf,VectorTileLayer:nf},Xy=ul.VectorTileFeature.types,ap=Math.pow(2,13);function pu(e,t,i,l,p,m,x,S){e.emplaceBack(t,i,2*Math.floor(l*ap)+x,p*ap*2,m*ap*2,Math.round(S))}var Fa=function(e){this.zoom=e.zoom,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map(function(t){return t.id}),this.index=e.index,this.hasPattern=!1,this.layoutVertexArray=new Ra,this.indexArray=new Qa,this.programConfigurations=new Ct(e.layers,e.zoom),this.segments=new G,this.stateDependentLayerIds=this.layers.filter(function(t){return t.isStateDependent()}).map(function(t){return t.id})};function Wy(e,t){return e.x===t.x&&(e.x<0||e.x>8192)||e.y===t.y&&(e.y<0||e.y>8192)}Fa.prototype.populate=function(e,t,i){this.features=[],this.hasPattern=ip("fill-extrusion",this.layers,t);for(var l=0,p=e;l<p.length;l+=1){var m=p[l],x=m.feature,S=m.id,z=m.index,A=m.sourceLayerIndex,C=this.layers[0]._featureFilter.needGeometry,B=mi(x,C);if(this.layers[0]._featureFilter.filter(new ur(this.zoom),B,i)){var U={id:S,sourceLayerIndex:A,index:z,geometry:C?B.geometry:ni(x),properties:x.properties,type:x.type,patterns:{}};this.hasPattern?this.features.push(np("fill-extrusion",this.layers,U,this.zoom,t)):this.addFeature(U,U.geometry,z,i,{}),t.featureIndex.insert(x,U.geometry,z,A,this.index,!0)}}},Fa.prototype.addFeatures=function(e,t,i){for(var l=0,p=this.features;l<p.length;l+=1){var m=p[l];this.addFeature(m,m.geometry,m.index,t,i)}},Fa.prototype.update=function(e,t,i){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(e,t,this.stateDependentLayers,i)},Fa.prototype.isEmpty=function(){return this.layoutVertexArray.length===0},Fa.prototype.uploadPending=function(){return!this.uploaded||this.programConfigurations.needsUpload},Fa.prototype.upload=function(e){this.uploaded||(this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,jy),this.indexBuffer=e.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(e),this.uploaded=!0},Fa.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())},Fa.prototype.addFeature=function(e,t,i,l,p){for(var m=0,x=rp(t,500);m<x.length;m+=1){for(var S=x[m],z=0,A=0,C=S;A<C.length;A+=1)z+=C[A].length;for(var B=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray),U=0,q=S;U<q.length;U+=1){var Q=q[U];if(Q.length!==0&&!((rr=Q).every(function(Kt){return Kt.x<0})||rr.every(function(Kt){return Kt.x>8192})||rr.every(function(Kt){return Kt.y<0})||rr.every(function(Kt){return Kt.y>8192})))for(var ee=0,ce=0;ce<Q.length;ce++){var ie=Q[ce];if(ce>=1){var me=Q[ce-1];if(!Wy(ie,me)){B.vertexLength+4>G.MAX_VERTEX_ARRAY_LENGTH&&(B=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray));var be=ie.sub(me)._perp()._unit(),ke=me.dist(ie);ee+ke>32768&&(ee=0),pu(this.layoutVertexArray,ie.x,ie.y,be.x,be.y,0,0,ee),pu(this.layoutVertexArray,ie.x,ie.y,be.x,be.y,0,1,ee),pu(this.layoutVertexArray,me.x,me.y,be.x,be.y,0,0,ee+=ke),pu(this.layoutVertexArray,me.x,me.y,be.x,be.y,0,1,ee);var Ie=B.vertexLength;this.indexArray.emplaceBack(Ie,Ie+2,Ie+1),this.indexArray.emplaceBack(Ie+1,Ie+2,Ie+3),B.vertexLength+=4,B.primitiveLength+=2}}}}if(B.vertexLength+z>G.MAX_VERTEX_ARRAY_LENGTH&&(B=this.segments.prepareSegment(z,this.layoutVertexArray,this.indexArray)),Xy[e.type]==="Polygon"){for(var Pe=[],je=[],Qe=B.vertexLength,mt=0,rt=S;mt<rt.length;mt+=1){var bt=rt[mt];if(bt.length!==0){bt!==S[0]&&je.push(Pe.length/2);for(var nt=0;nt<bt.length;nt++){var Qt=bt[nt];pu(this.layoutVertexArray,Qt.x,Qt.y,0,0,1,1,0),Pe.push(Qt.x),Pe.push(Qt.y)}}}for(var Dt=Qh(Pe,je),ct=0;ct<Dt.length;ct+=3)this.indexArray.emplaceBack(Qe+Dt[ct],Qe+Dt[ct+2],Qe+Dt[ct+1]);B.primitiveLength+=Dt.length/3,B.vertexLength+=z}}var rr;this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,e,i,p,l)},st("FillExtrusionBucket",Fa,{omit:["layers","features"]});var Hy={paint:new an({"fill-extrusion-opacity":new gt(j["paint_fill-extrusion"]["fill-extrusion-opacity"]),"fill-extrusion-color":new ut(j["paint_fill-extrusion"]["fill-extrusion-color"]),"fill-extrusion-translate":new gt(j["paint_fill-extrusion"]["fill-extrusion-translate"]),"fill-extrusion-translate-anchor":new gt(j["paint_fill-extrusion"]["fill-extrusion-translate-anchor"]),"fill-extrusion-pattern":new el(j["paint_fill-extrusion"]["fill-extrusion-pattern"]),"fill-extrusion-height":new ut(j["paint_fill-extrusion"]["fill-extrusion-height"]),"fill-extrusion-base":new ut(j["paint_fill-extrusion"]["fill-extrusion-base"]),"fill-extrusion-vertical-gradient":new gt(j["paint_fill-extrusion"]["fill-extrusion-vertical-gradient"])})},Jy=function(e){function t(i){e.call(this,i,Hy)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.createBucket=function(i){return new Fa(i)},t.prototype.queryRadius=function(){return Ri(this.paint.get("fill-extrusion-translate"))},t.prototype.is3D=function(){return!0},t.prototype.queryIntersectsFeature=function(i,l,p,m,x,S,z,A){var C=Ba(i,this.paint.get("fill-extrusion-translate"),this.paint.get("fill-extrusion-translate-anchor"),S.angle,z),B=this.paint.get("fill-extrusion-height").evaluate(l,p),U=this.paint.get("fill-extrusion-base").evaluate(l,p),q=function(ee,ce,ie,me){for(var be=[],ke=0,Ie=ee;ke<Ie.length;ke+=1){var Pe=Ie[ke],je=[Pe.x,Pe.y,0,1];al(je,je,ce),be.push(new F(je[0]/je[3],je[1]/je[3]))}return be}(C,A),Q=function(ee,ce,ie,me){for(var be=[],ke=[],Ie=me[8]*ce,Pe=me[9]*ce,je=me[10]*ce,Qe=me[11]*ce,mt=me[8]*ie,rt=me[9]*ie,bt=me[10]*ie,nt=me[11]*ie,Qt=0,Dt=ee;Qt<Dt.length;Qt+=1){for(var ct=[],rr=[],Kt=0,yr=Dt[Qt];Kt<yr.length;Kt+=1){var xt=yr[Kt],wr=xt.x,Qr=xt.y,ci=me[0]*wr+me[4]*Qr+me[12],ai=me[1]*wr+me[5]*Qr+me[13],$r=me[2]*wr+me[6]*Qr+me[14],hi=me[3]*wr+me[7]*Qr+me[15],Bi=$r+je,Oi=hi+Qe,Tn=ci+mt,Hi=ai+rt,In=$r+bt,yi=hi+nt,Ji=new F((ci+Ie)/Oi,(ai+Pe)/Oi);Ji.z=Bi/Oi,ct.push(Ji);var hr=new F(Tn/yi,Hi/yi);hr.z=In/yi,rr.push(hr)}be.push(ct),ke.push(rr)}return[be,ke]}(m,U,B,A);return function(ee,ce,ie){var me=1/0;_a(ie,ce)&&(me=of(ie,ce[0]));for(var be=0;be<ce.length;be++)for(var ke=ce[be],Ie=ee[be],Pe=0;Pe<ke.length-1;Pe++){var je=ke[Pe],Qe=[je,ke[Pe+1],Ie[Pe+1],Ie[Pe],je];to(ie,Qe)&&(me=Math.min(me,of(ie,Qe)))}return me!==1/0&&me}(Q[0],Q[1],q)},t}(Ea);function fu(e,t){return e.x*t.x+e.y*t.y}function of(e,t){if(e.length===1){for(var i,l=0,p=t[l++];!i||p.equals(i);)if(!(i=t[l++]))return 1/0;for(;l<t.length;l++){var m=t[l],x=e[0],S=i.sub(p),z=m.sub(p),A=x.sub(p),C=fu(S,S),B=fu(S,z),U=fu(z,z),q=fu(A,S),Q=fu(A,z),ee=C*U-B*B,ce=(U*q-B*Q)/ee,ie=(C*Q-B*q)/ee,me=p.z*(1-ce-ie)+i.z*ce+m.z*ie;if(isFinite(me))return me}return 1/0}for(var be=1/0,ke=0,Ie=t;ke<Ie.length;ke+=1)be=Math.min(be,Ie[ke].z);return be}var Yy=Ki([{name:"a_pos_normal",components:2,type:"Int16"},{name:"a_data",components:4,type:"Uint8"}],4).members,Qy=Ki([{name:"a_uv_x",components:1,type:"Float32"},{name:"a_split_index",components:1,type:"Float32"}]).members,$y=ul.VectorTileFeature.types,e_=Math.cos(Math.PI/180*37.5),sf=Math.pow(2,14)/.5,Mn=function(e){var t=this;this.zoom=e.zoom,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map(function(i){return i.id}),this.index=e.index,this.hasPattern=!1,this.patternFeatures=[],this.lineClipsArray=[],this.gradients={},this.layers.forEach(function(i){t.gradients[i.id]={}}),this.layoutVertexArray=new Zn,this.layoutVertexArray2=new Xo,this.indexArray=new Qa,this.programConfigurations=new Ct(e.layers,e.zoom),this.segments=new G,this.maxLineLength=0,this.stateDependentLayerIds=this.layers.filter(function(i){return i.isStateDependent()}).map(function(i){return i.id})};Mn.prototype.populate=function(e,t,i){this.hasPattern=ip("line",this.layers,t);for(var l=this.layers[0].layout.get("line-sort-key"),p=[],m=0,x=e;m<x.length;m+=1){var S=x[m],z=S.feature,A=S.id,C=S.index,B=S.sourceLayerIndex,U=this.layers[0]._featureFilter.needGeometry,q=mi(z,U);if(this.layers[0]._featureFilter.filter(new ur(this.zoom),q,i)){var Q=l?l.evaluate(q,{},i):void 0,ee={id:A,properties:z.properties,type:z.type,sourceLayerIndex:B,index:C,geometry:U?q.geometry:ni(z),patterns:{},sortKey:Q};p.push(ee)}}l&&p.sort(function(je,Qe){return je.sortKey-Qe.sortKey});for(var ce=0,ie=p;ce<ie.length;ce+=1){var me=ie[ce],be=me.geometry,ke=me.index,Ie=me.sourceLayerIndex;if(this.hasPattern){var Pe=np("line",this.layers,me,this.zoom,t);this.patternFeatures.push(Pe)}else this.addFeature(me,be,ke,i,{});t.featureIndex.insert(e[ke].feature,be,ke,Ie,this.index)}},Mn.prototype.update=function(e,t,i){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(e,t,this.stateDependentLayers,i)},Mn.prototype.addFeatures=function(e,t,i){for(var l=0,p=this.patternFeatures;l<p.length;l+=1){var m=p[l];this.addFeature(m,m.geometry,m.index,t,i)}},Mn.prototype.isEmpty=function(){return this.layoutVertexArray.length===0},Mn.prototype.uploadPending=function(){return!this.uploaded||this.programConfigurations.needsUpload},Mn.prototype.upload=function(e){this.uploaded||(this.layoutVertexArray2.length!==0&&(this.layoutVertexBuffer2=e.createVertexBuffer(this.layoutVertexArray2,Qy)),this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,Yy),this.indexBuffer=e.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(e),this.uploaded=!0},Mn.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())},Mn.prototype.lineFeatureClips=function(e){if(e.properties&&e.properties.hasOwnProperty("mapbox_clip_start")&&e.properties.hasOwnProperty("mapbox_clip_end"))return{start:+e.properties.mapbox_clip_start,end:+e.properties.mapbox_clip_end}},Mn.prototype.addFeature=function(e,t,i,l,p){var m=this.layers[0].layout,x=m.get("line-join").evaluate(e,{}),S=m.get("line-cap"),z=m.get("line-miter-limit"),A=m.get("line-round-limit");this.lineClips=this.lineFeatureClips(e);for(var C=0,B=t;C<B.length;C+=1)this.addLine(B[C],e,x,S,z,A);this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,e,i,p,l)},Mn.prototype.addLine=function(e,t,i,l,p,m){if(this.distance=0,this.scaledDistance=0,this.totalDistance=0,this.lineClips){this.lineClipsArray.push(this.lineClips);for(var x=0;x<e.length-1;x++)this.totalDistance+=e[x].dist(e[x+1]);this.updateScaledDistance(),this.maxLineLength=Math.max(this.maxLineLength,this.totalDistance)}for(var S=$y[t.type]==="Polygon",z=e.length;z>=2&&e[z-1].equals(e[z-2]);)z--;for(var A=0;A<z-1&&e[A].equals(e[A+1]);)A++;if(!(z<(S?3:2))){i==="bevel"&&(p=1.05);var C,B=this.overscaling<=16?122880/(512*this.overscaling):0,U=this.segments.prepareSegment(10*z,this.layoutVertexArray,this.indexArray),q=void 0,Q=void 0,ee=void 0,ce=void 0;this.e1=this.e2=-1,S&&(ce=e[A].sub(C=e[z-2])._unit()._perp());for(var ie=A;ie<z;ie++)if(!(Q=ie===z-1?S?e[A+1]:void 0:e[ie+1])||!e[ie].equals(Q)){ce&&(ee=ce),C&&(q=C),C=e[ie],ce=Q?Q.sub(C)._unit()._perp():ee;var me=(ee=ee||ce).add(ce);me.x===0&&me.y===0||me._unit();var be=ee.x*ce.x+ee.y*ce.y,ke=me.x*ce.x+me.y*ce.y,Ie=ke!==0?1/ke:1/0,Pe=2*Math.sqrt(2-2*ke),je=ke<e_&&q&&Q,Qe=ee.x*ce.y-ee.y*ce.x>0;if(je&&ie>A){var mt=C.dist(q);if(mt>2*B){var rt=C.sub(C.sub(q)._mult(B/mt)._round());this.updateDistance(q,rt),this.addCurrentVertex(rt,ee,0,0,U),q=rt}}var bt=q&&Q,nt=bt?i:S?"butt":l;if(bt&&nt==="round"&&(Ie<m?nt="miter":Ie<=2&&(nt="fakeround")),nt==="miter"&&Ie>p&&(nt="bevel"),nt==="bevel"&&(Ie>2&&(nt="flipbevel"),Ie<p&&(nt="miter")),q&&this.updateDistance(q,C),nt==="miter")me._mult(Ie),this.addCurrentVertex(C,me,0,0,U);else if(nt==="flipbevel"){if(Ie>100)me=ce.mult(-1);else{var Qt=Ie*ee.add(ce).mag()/ee.sub(ce).mag();me._perp()._mult(Qt*(Qe?-1:1))}this.addCurrentVertex(C,me,0,0,U),this.addCurrentVertex(C,me.mult(-1),0,0,U)}else if(nt==="bevel"||nt==="fakeround"){var Dt=-Math.sqrt(Ie*Ie-1),ct=Qe?Dt:0,rr=Qe?0:Dt;if(q&&this.addCurrentVertex(C,ee,ct,rr,U),nt==="fakeround")for(var Kt=Math.round(180*Pe/Math.PI/20),yr=1;yr<Kt;yr++){var xt=yr/Kt;if(xt!==.5){var wr=xt-.5;xt+=xt*wr*(xt-1)*((1.0904+be*(be*(3.55645-1.43519*be)-3.2452))*wr*wr+(.848013+be*(.215638*be-1.06021)))}var Qr=ce.sub(ee)._mult(xt)._add(ee)._unit()._mult(Qe?-1:1);this.addHalfVertex(C,Qr.x,Qr.y,!1,Qe,0,U)}Q&&this.addCurrentVertex(C,ce,-ct,-rr,U)}else if(nt==="butt")this.addCurrentVertex(C,me,0,0,U);else if(nt==="square"){var ci=q?1:-1;this.addCurrentVertex(C,me,ci,ci,U)}else nt==="round"&&(q&&(this.addCurrentVertex(C,ee,0,0,U),this.addCurrentVertex(C,ee,1,1,U,!0)),Q&&(this.addCurrentVertex(C,ce,-1,-1,U,!0),this.addCurrentVertex(C,ce,0,0,U)));if(je&&ie<z-1){var ai=C.dist(Q);if(ai>2*B){var $r=C.add(Q.sub(C)._mult(B/ai)._round());this.updateDistance(C,$r),this.addCurrentVertex($r,ce,0,0,U),C=$r}}}}},Mn.prototype.addCurrentVertex=function(e,t,i,l,p,m){m===void 0&&(m=!1);var x=t.y*l-t.x,S=-t.y-t.x*l;this.addHalfVertex(e,t.x+t.y*i,t.y-t.x*i,m,!1,i,p),this.addHalfVertex(e,x,S,m,!0,-l,p),this.distance>sf/2&&this.totalDistance===0&&(this.distance=0,this.addCurrentVertex(e,t,i,l,p,m))},Mn.prototype.addHalfVertex=function(e,t,i,l,p,m,x){var S=.5*(this.lineClips?this.scaledDistance*(sf-1):this.scaledDistance);this.layoutVertexArray.emplaceBack((e.x<<1)+(l?1:0),(e.y<<1)+(p?1:0),Math.round(63*t)+128,Math.round(63*i)+128,1+(m===0?0:m<0?-1:1)|(63&S)<<2,S>>6),this.lineClips&&this.layoutVertexArray2.emplaceBack((this.scaledDistance-this.lineClips.start)/(this.lineClips.end-this.lineClips.start),this.lineClipsArray.length);var z=x.vertexLength++;this.e1>=0&&this.e2>=0&&(this.indexArray.emplaceBack(this.e1,this.e2,z),x.primitiveLength++),p?this.e2=z:this.e1=z},Mn.prototype.updateScaledDistance=function(){this.scaledDistance=this.lineClips?this.lineClips.start+(this.lineClips.end-this.lineClips.start)*this.distance/this.totalDistance:this.distance},Mn.prototype.updateDistance=function(e,t){this.distance+=e.dist(t),this.updateScaledDistance()},st("LineBucket",Mn,{omit:["layers","patternFeatures"]});var t_=new an({"line-cap":new gt(j.layout_line["line-cap"]),"line-join":new ut(j.layout_line["line-join"]),"line-miter-limit":new gt(j.layout_line["line-miter-limit"]),"line-round-limit":new gt(j.layout_line["line-round-limit"]),"line-sort-key":new ut(j.layout_line["line-sort-key"])}),lf={paint:new an({"line-opacity":new ut(j.paint_line["line-opacity"]),"line-color":new ut(j.paint_line["line-color"]),"line-translate":new gt(j.paint_line["line-translate"]),"line-translate-anchor":new gt(j.paint_line["line-translate-anchor"]),"line-width":new ut(j.paint_line["line-width"]),"line-gap-width":new ut(j.paint_line["line-gap-width"]),"line-offset":new ut(j.paint_line["line-offset"]),"line-blur":new ut(j.paint_line["line-blur"]),"line-dasharray":new kn(j.paint_line["line-dasharray"]),"line-pattern":new el(j.paint_line["line-pattern"]),"line-gradient":new ya(j.paint_line["line-gradient"])}),layout:t_},uf=new(function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.possiblyEvaluate=function(i,l){return l=new ur(Math.floor(l.zoom),{now:l.now,fadeDuration:l.fadeDuration,zoomHistory:l.zoomHistory,transition:l.transition}),e.prototype.possiblyEvaluate.call(this,i,l)},t.prototype.evaluate=function(i,l,p,m){return l=xe({},l,{zoom:Math.floor(l.zoom)}),e.prototype.evaluate.call(this,i,l,p,m)},t}(ut))(lf.paint.properties["line-width"].specification);uf.useIntegerZoom=!0;var r_=function(e){function t(i){e.call(this,i,lf),this.gradientVersion=0}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._handleSpecialPaintPropertyUpdate=function(i){i==="line-gradient"&&(this.stepInterpolant=this._transitionablePaint._values["line-gradient"].value.expression._styleExpression.expression instanceof Nn,this.gradientVersion=(this.gradientVersion+1)%H)},t.prototype.gradientExpression=function(){return this._transitionablePaint._values["line-gradient"].value.expression},t.prototype.recalculate=function(i,l){e.prototype.recalculate.call(this,i,l),this.paint._values["line-floorwidth"]=uf.possiblyEvaluate(this._transitioningPaint._values["line-width"].value,i)},t.prototype.createBucket=function(i){return new Mn(i)},t.prototype.queryRadius=function(i){var l=i,p=cf(za("line-width",this,l),za("line-gap-width",this,l)),m=za("line-offset",this,l);return p/2+Math.abs(m)+Ri(this.paint.get("line-translate"))},t.prototype.queryIntersectsFeature=function(i,l,p,m,x,S,z){var A=Ba(i,this.paint.get("line-translate"),this.paint.get("line-translate-anchor"),S.angle,z),C=z/2*cf(this.paint.get("line-width").evaluate(l,p),this.paint.get("line-gap-width").evaluate(l,p)),B=this.paint.get("line-offset").evaluate(l,p);return B&&(m=function(U,q){for(var Q=[],ee=new F(0,0),ce=0;ce<U.length;ce++){for(var ie=U[ce],me=[],be=0;be<ie.length;be++){var ke=ie[be],Ie=ie[be+1],Pe=be===0?ee:ke.sub(ie[be-1])._unit()._perp(),je=be===ie.length-1?ee:Ie.sub(ke)._unit()._perp(),Qe=Pe._add(je)._unit();Qe._mult(1/(Qe.x*je.x+Qe.y*je.y)),me.push(Qe._mult(q)._add(ke))}Q.push(me)}return Q}(m,B*z)),function(U,q,Q){for(var ee=0;ee<q.length;ee++){var ce=q[ee];if(U.length>=3){for(var ie=0;ie<ce.length;ie++)if(Ia(U,ce[ie]))return!0}if(oa(U,ce,Q))return!0}return!1}(A,m,C)},t.prototype.isTileClipped=function(){return!0},t}(Ea);function cf(e,t){return t>0?t+2*e:e}var i_=Ki([{name:"a_pos_offset",components:4,type:"Int16"},{name:"a_data",components:4,type:"Uint16"},{name:"a_pixeloffset",components:4,type:"Int16"}],4),n_=Ki([{name:"a_projected_pos",components:3,type:"Float32"}],4),a_=(Ki([{name:"a_fade_opacity",components:1,type:"Uint32"}],4),Ki([{name:"a_placed",components:2,type:"Uint8"},{name:"a_shift",components:2,type:"Float32"}])),hf=(Ki([{type:"Int16",name:"anchorPointX"},{type:"Int16",name:"anchorPointY"},{type:"Int16",name:"x1"},{type:"Int16",name:"y1"},{type:"Int16",name:"x2"},{type:"Int16",name:"y2"},{type:"Uint32",name:"featureIndex"},{type:"Uint16",name:"sourceLayerIndex"},{type:"Uint16",name:"bucketIndex"}]),Ki([{name:"a_pos",components:2,type:"Int16"},{name:"a_anchor_pos",components:2,type:"Int16"},{name:"a_extrude",components:2,type:"Int16"}],4)),o_=Ki([{name:"a_pos",components:2,type:"Float32"},{name:"a_radius",components:1,type:"Float32"},{name:"a_flags",components:2,type:"Int16"}],4);function s_(e,t,i){return e.sections.forEach(function(l){l.text=function(p,m,x){var S=m.layout.get("text-transform").evaluate(x,{});return S==="uppercase"?p=p.toLocaleUpperCase():S==="lowercase"&&(p=p.toLocaleLowerCase()),Qn.applyArabicShaping&&(p=Qn.applyArabicShaping(p)),p}(l.text,t,i)}),e}Ki([{name:"triangle",components:3,type:"Uint16"}]),Ki([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Uint16",name:"glyphStartIndex"},{type:"Uint16",name:"numGlyphs"},{type:"Uint32",name:"vertexStartIndex"},{type:"Uint32",name:"lineStartIndex"},{type:"Uint32",name:"lineLength"},{type:"Uint16",name:"segment"},{type:"Uint16",name:"lowerSize"},{type:"Uint16",name:"upperSize"},{type:"Float32",name:"lineOffsetX"},{type:"Float32",name:"lineOffsetY"},{type:"Uint8",name:"writingMode"},{type:"Uint8",name:"placedOrientation"},{type:"Uint8",name:"hidden"},{type:"Uint32",name:"crossTileID"},{type:"Int16",name:"associatedIconIndex"}]),Ki([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Int16",name:"rightJustifiedTextSymbolIndex"},{type:"Int16",name:"centerJustifiedTextSymbolIndex"},{type:"Int16",name:"leftJustifiedTextSymbolIndex"},{type:"Int16",name:"verticalPlacedTextSymbolIndex"},{type:"Int16",name:"placedIconSymbolIndex"},{type:"Int16",name:"verticalPlacedIconSymbolIndex"},{type:"Uint16",name:"key"},{type:"Uint16",name:"textBoxStartIndex"},{type:"Uint16",name:"textBoxEndIndex"},{type:"Uint16",name:"verticalTextBoxStartIndex"},{type:"Uint16",name:"verticalTextBoxEndIndex"},{type:"Uint16",name:"iconBoxStartIndex"},{type:"Uint16",name:"iconBoxEndIndex"},{type:"Uint16",name:"verticalIconBoxStartIndex"},{type:"Uint16",name:"verticalIconBoxEndIndex"},{type:"Uint16",name:"featureIndex"},{type:"Uint16",name:"numHorizontalGlyphVertices"},{type:"Uint16",name:"numVerticalGlyphVertices"},{type:"Uint16",name:"numIconVertices"},{type:"Uint16",name:"numVerticalIconVertices"},{type:"Uint16",name:"useRuntimeCollisionCircles"},{type:"Uint32",name:"crossTileID"},{type:"Float32",name:"textBoxScale"},{type:"Float32",components:2,name:"textOffset"},{type:"Float32",name:"collisionCircleDiameter"}]),Ki([{type:"Float32",name:"offsetX"}]),Ki([{type:"Int16",name:"x"},{type:"Int16",name:"y"},{type:"Int16",name:"tileUnitDistanceFromAnchor"}]);var du={"!":"","#":"",$:"","%":"","&":"","(":"",")":"","*":"","+":"",",":"","-":"",".":"","/":"",":":"",";":"","<":"","=":"",">":"","?":"","@":"","[":"","\\":"","]":"","^":"",_:"","`":"","{":"","|":"","}":"","~":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":""},pf=function(e,t,i,l,p){var m,x,S=8*p-l-1,z=(1<<S)-1,A=z>>1,C=-7,B=i?p-1:0,U=i?-1:1,q=e[t+B];for(B+=U,m=q&(1<<-C)-1,q>>=-C,C+=S;C>0;m=256*m+e[t+B],B+=U,C-=8);for(x=m&(1<<-C)-1,m>>=-C,C+=l;C>0;x=256*x+e[t+B],B+=U,C-=8);if(m===0)m=1-A;else{if(m===z)return x?NaN:1/0*(q?-1:1);x+=Math.pow(2,l),m-=A}return(q?-1:1)*x*Math.pow(2,m-l)},ff=function(e,t,i,l,p,m){var x,S,z,A=8*m-p-1,C=(1<<A)-1,B=C>>1,U=p===23?Math.pow(2,-24)-Math.pow(2,-77):0,q=l?0:m-1,Q=l?1:-1,ee=t<0||t===0&&1/t<0?1:0;for(t=Math.abs(t),isNaN(t)||t===1/0?(S=isNaN(t)?1:0,x=C):(x=Math.floor(Math.log(t)/Math.LN2),t*(z=Math.pow(2,-x))<1&&(x--,z*=2),(t+=x+B>=1?U/z:U*Math.pow(2,1-B))*z>=2&&(x++,z/=2),x+B>=C?(S=0,x=C):x+B>=1?(S=(t*z-1)*Math.pow(2,p),x+=B):(S=t*Math.pow(2,B-1)*Math.pow(2,p),x=0));p>=8;e[i+q]=255&S,q+=Q,S/=256,p-=8);for(x=x<<p|S,A+=p;A>0;e[i+q]=255&x,q+=Q,x/=256,A-=8);e[i+q-Q]|=128*ee},Lc=qr;function qr(e){this.buf=ArrayBuffer.isView&&ArrayBuffer.isView(e)?e:new Uint8Array(e||0),this.pos=0,this.type=0,this.length=this.buf.length}qr.Varint=0,qr.Fixed64=1,qr.Bytes=2,qr.Fixed32=5;var df=typeof TextDecoder>"u"?null:new TextDecoder("utf8");function Mo(e){return e.type===qr.Bytes?e.readVarint()+e.pos:e.pos+1}function cl(e,t,i){return i?4294967296*t+(e>>>0):4294967296*(t>>>0)+(e>>>0)}function mf(e,t,i){var l=t<=16383?1:t<=2097151?2:t<=268435455?3:Math.floor(Math.log(t)/(7*Math.LN2));i.realloc(l);for(var p=i.pos-1;p>=e;p--)i.buf[p+l]=i.buf[p]}function l_(e,t){for(var i=0;i<e.length;i++)t.writeVarint(e[i])}function u_(e,t){for(var i=0;i<e.length;i++)t.writeSVarint(e[i])}function c_(e,t){for(var i=0;i<e.length;i++)t.writeFloat(e[i])}function h_(e,t){for(var i=0;i<e.length;i++)t.writeDouble(e[i])}function p_(e,t){for(var i=0;i<e.length;i++)t.writeBoolean(e[i])}function f_(e,t){for(var i=0;i<e.length;i++)t.writeFixed32(e[i])}function d_(e,t){for(var i=0;i<e.length;i++)t.writeSFixed32(e[i])}function m_(e,t){for(var i=0;i<e.length;i++)t.writeFixed64(e[i])}function y_(e,t){for(var i=0;i<e.length;i++)t.writeSFixed64(e[i])}function Rc(e,t){return(e[t]|e[t+1]<<8|e[t+2]<<16)+16777216*e[t+3]}function hl(e,t,i){e[i]=t,e[i+1]=t>>>8,e[i+2]=t>>>16,e[i+3]=t>>>24}function yf(e,t){return(e[t]|e[t+1]<<8|e[t+2]<<16)+(e[t+3]<<24)}function __(e,t,i){e===1&&i.readMessage(g_,t)}function g_(e,t,i){if(e===3){var l=i.readMessage(v_,{}),p=l.width,m=l.height,x=l.left,S=l.top,z=l.advance;t.push({id:l.id,bitmap:new As({width:p+6,height:m+6},l.bitmap),metrics:{width:p,height:m,left:x,top:S,advance:z}})}}function v_(e,t,i){e===1?t.id=i.readVarint():e===2?t.bitmap=i.readBytes():e===3?t.width=i.readVarint():e===4?t.height=i.readVarint():e===5?t.left=i.readSVarint():e===6?t.top=i.readSVarint():e===7&&(t.advance=i.readVarint())}function _f(e){for(var t=0,i=0,l=0,p=e;l<p.length;l+=1){var m=p[l];t+=m.w*m.h,i=Math.max(i,m.w)}e.sort(function(ee,ce){return ce.h-ee.h});for(var x=[{x:0,y:0,w:Math.max(Math.ceil(Math.sqrt(t/.95)),i),h:1/0}],S=0,z=0,A=0,C=e;A<C.length;A+=1)for(var B=C[A],U=x.length-1;U>=0;U--){var q=x[U];if(!(B.w>q.w||B.h>q.h)){if(B.x=q.x,B.y=q.y,z=Math.max(z,B.y+B.h),S=Math.max(S,B.x+B.w),B.w===q.w&&B.h===q.h){var Q=x.pop();U<x.length&&(x[U]=Q)}else B.h===q.h?(q.x+=B.w,q.w-=B.w):B.w===q.w?(q.y+=B.h,q.h-=B.h):(x.push({x:q.x+B.w,y:q.y,w:q.w-B.w,h:B.h}),q.y+=B.h,q.h-=B.h);break}}return{w:S,h:z,fill:t/(S*z)||0}}qr.prototype={destroy:function(){this.buf=null},readFields:function(e,t,i){for(i=i||this.length;this.pos<i;){var l=this.readVarint(),p=l>>3,m=this.pos;this.type=7&l,e(p,t,this),this.pos===m&&this.skip(l)}return t},readMessage:function(e,t){return this.readFields(e,t,this.readVarint()+this.pos)},readFixed32:function(){var e=Rc(this.buf,this.pos);return this.pos+=4,e},readSFixed32:function(){var e=yf(this.buf,this.pos);return this.pos+=4,e},readFixed64:function(){var e=Rc(this.buf,this.pos)+4294967296*Rc(this.buf,this.pos+4);return this.pos+=8,e},readSFixed64:function(){var e=Rc(this.buf,this.pos)+4294967296*yf(this.buf,this.pos+4);return this.pos+=8,e},readFloat:function(){var e=pf(this.buf,this.pos,!0,23,4);return this.pos+=4,e},readDouble:function(){var e=pf(this.buf,this.pos,!0,52,8);return this.pos+=8,e},readVarint:function(e){var t,i,l=this.buf;return t=127&(i=l[this.pos++]),i<128?t:(t|=(127&(i=l[this.pos++]))<<7,i<128?t:(t|=(127&(i=l[this.pos++]))<<14,i<128?t:(t|=(127&(i=l[this.pos++]))<<21,i<128?t:function(p,m,x){var S,z,A=x.buf;if(S=(112&(z=A[x.pos++]))>>4,z<128||(S|=(127&(z=A[x.pos++]))<<3,z<128)||(S|=(127&(z=A[x.pos++]))<<10,z<128)||(S|=(127&(z=A[x.pos++]))<<17,z<128)||(S|=(127&(z=A[x.pos++]))<<24,z<128)||(S|=(1&(z=A[x.pos++]))<<31,z<128))return cl(p,S,m);throw new Error("Expected varint not more than 10 bytes")}(t|=(15&(i=l[this.pos]))<<28,e,this))))},readVarint64:function(){return this.readVarint(!0)},readSVarint:function(){var e=this.readVarint();return e%2==1?(e+1)/-2:e/2},readBoolean:function(){return!!this.readVarint()},readString:function(){var e=this.readVarint()+this.pos,t=this.pos;return this.pos=e,e-t>=12&&df?function(i,l,p){return df.decode(i.subarray(l,p))}(this.buf,t,e):function(i,l,p){for(var m="",x=l;x<p;){var S,z,A,C=i[x],B=null,U=C>239?4:C>223?3:C>191?2:1;if(x+U>p)break;U===1?C<128&&(B=C):U===2?(192&(S=i[x+1]))==128&&(B=(31&C)<<6|63&S)<=127&&(B=null):U===3?(z=i[x+2],(192&(S=i[x+1]))==128&&(192&z)==128&&((B=(15&C)<<12|(63&S)<<6|63&z)<=2047||B>=55296&&B<=57343)&&(B=null)):U===4&&(z=i[x+2],A=i[x+3],(192&(S=i[x+1]))==128&&(192&z)==128&&(192&A)==128&&((B=(15&C)<<18|(63&S)<<12|(63&z)<<6|63&A)<=65535||B>=1114112)&&(B=null)),B===null?(B=65533,U=1):B>65535&&(B-=65536,m+=String.fromCharCode(B>>>10&1023|55296),B=56320|1023&B),m+=String.fromCharCode(B),x+=U}return m}(this.buf,t,e)},readBytes:function(){var e=this.readVarint()+this.pos,t=this.buf.subarray(this.pos,e);return this.pos=e,t},readPackedVarint:function(e,t){if(this.type!==qr.Bytes)return e.push(this.readVarint(t));var i=Mo(this);for(e=e||[];this.pos<i;)e.push(this.readVarint(t));return e},readPackedSVarint:function(e){if(this.type!==qr.Bytes)return e.push(this.readSVarint());var t=Mo(this);for(e=e||[];this.pos<t;)e.push(this.readSVarint());return e},readPackedBoolean:function(e){if(this.type!==qr.Bytes)return e.push(this.readBoolean());var t=Mo(this);for(e=e||[];this.pos<t;)e.push(this.readBoolean());return e},readPackedFloat:function(e){if(this.type!==qr.Bytes)return e.push(this.readFloat());var t=Mo(this);for(e=e||[];this.pos<t;)e.push(this.readFloat());return e},readPackedDouble:function(e){if(this.type!==qr.Bytes)return e.push(this.readDouble());var t=Mo(this);for(e=e||[];this.pos<t;)e.push(this.readDouble());return e},readPackedFixed32:function(e){if(this.type!==qr.Bytes)return e.push(this.readFixed32());var t=Mo(this);for(e=e||[];this.pos<t;)e.push(this.readFixed32());return e},readPackedSFixed32:function(e){if(this.type!==qr.Bytes)return e.push(this.readSFixed32());var t=Mo(this);for(e=e||[];this.pos<t;)e.push(this.readSFixed32());return e},readPackedFixed64:function(e){if(this.type!==qr.Bytes)return e.push(this.readFixed64());var t=Mo(this);for(e=e||[];this.pos<t;)e.push(this.readFixed64());return e},readPackedSFixed64:function(e){if(this.type!==qr.Bytes)return e.push(this.readSFixed64());var t=Mo(this);for(e=e||[];this.pos<t;)e.push(this.readSFixed64());return e},skip:function(e){var t=7&e;if(t===qr.Varint)for(;this.buf[this.pos++]>127;);else if(t===qr.Bytes)this.pos=this.readVarint()+this.pos;else if(t===qr.Fixed32)this.pos+=4;else{if(t!==qr.Fixed64)throw new Error("Unimplemented type: "+t);this.pos+=8}},writeTag:function(e,t){this.writeVarint(e<<3|t)},realloc:function(e){for(var t=this.length||16;t<this.pos+e;)t*=2;if(t!==this.length){var i=new Uint8Array(t);i.set(this.buf),this.buf=i,this.length=t}},finish:function(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)},writeFixed32:function(e){this.realloc(4),hl(this.buf,e,this.pos),this.pos+=4},writeSFixed32:function(e){this.realloc(4),hl(this.buf,e,this.pos),this.pos+=4},writeFixed64:function(e){this.realloc(8),hl(this.buf,-1&e,this.pos),hl(this.buf,Math.floor(e*(1/4294967296)),this.pos+4),this.pos+=8},writeSFixed64:function(e){this.realloc(8),hl(this.buf,-1&e,this.pos),hl(this.buf,Math.floor(e*(1/4294967296)),this.pos+4),this.pos+=8},writeVarint:function(e){(e=+e||0)>268435455||e<0?function(t,i){var l,p;if(t>=0?(l=t%4294967296|0,p=t/4294967296|0):(p=~(-t/4294967296),4294967295^(l=~(-t%4294967296))?l=l+1|0:(l=0,p=p+1|0)),t>=18446744073709552e3||t<-18446744073709552e3)throw new Error("Given varint doesn't fit into 10 bytes");i.realloc(10),function(m,x,S){S.buf[S.pos++]=127&m|128,m>>>=7,S.buf[S.pos++]=127&m|128,m>>>=7,S.buf[S.pos++]=127&m|128,m>>>=7,S.buf[S.pos++]=127&m|128,S.buf[S.pos]=127&(m>>>=7)}(l,0,i),function(m,x){var S=(7&m)<<4;x.buf[x.pos++]|=S|((m>>>=3)?128:0),m&&(x.buf[x.pos++]=127&m|((m>>>=7)?128:0),m&&(x.buf[x.pos++]=127&m|((m>>>=7)?128:0),m&&(x.buf[x.pos++]=127&m|((m>>>=7)?128:0),m&&(x.buf[x.pos++]=127&m|((m>>>=7)?128:0),m&&(x.buf[x.pos++]=127&m)))))}(p,i)}(e,this):(this.realloc(4),this.buf[this.pos++]=127&e|(e>127?128:0),e<=127||(this.buf[this.pos++]=127&(e>>>=7)|(e>127?128:0),e<=127||(this.buf[this.pos++]=127&(e>>>=7)|(e>127?128:0),e<=127||(this.buf[this.pos++]=e>>>7&127))))},writeSVarint:function(e){this.writeVarint(e<0?2*-e-1:2*e)},writeBoolean:function(e){this.writeVarint(!!e)},writeString:function(e){e=String(e),this.realloc(4*e.length),this.pos++;var t=this.pos;this.pos=function(l,p,m){for(var x,S,z=0;z<p.length;z++){if((x=p.charCodeAt(z))>55295&&x<57344){if(!S){x>56319||z+1===p.length?(l[m++]=239,l[m++]=191,l[m++]=189):S=x;continue}if(x<56320){l[m++]=239,l[m++]=191,l[m++]=189,S=x;continue}x=S-55296<<10|x-56320|65536,S=null}else S&&(l[m++]=239,l[m++]=191,l[m++]=189,S=null);x<128?l[m++]=x:(x<2048?l[m++]=x>>6|192:(x<65536?l[m++]=x>>12|224:(l[m++]=x>>18|240,l[m++]=x>>12&63|128),l[m++]=x>>6&63|128),l[m++]=63&x|128)}return m}(this.buf,e,this.pos);var i=this.pos-t;i>=128&&mf(t,i,this),this.pos=t-1,this.writeVarint(i),this.pos+=i},writeFloat:function(e){this.realloc(4),ff(this.buf,e,this.pos,!0,23,4),this.pos+=4},writeDouble:function(e){this.realloc(8),ff(this.buf,e,this.pos,!0,52,8),this.pos+=8},writeBytes:function(e){var t=e.length;this.writeVarint(t),this.realloc(t);for(var i=0;i<t;i++)this.buf[this.pos++]=e[i]},writeRawMessage:function(e,t){this.pos++;var i=this.pos;e(t,this);var l=this.pos-i;l>=128&&mf(i,l,this),this.pos=i-1,this.writeVarint(l),this.pos+=l},writeMessage:function(e,t,i){this.writeTag(e,qr.Bytes),this.writeRawMessage(t,i)},writePackedVarint:function(e,t){t.length&&this.writeMessage(e,l_,t)},writePackedSVarint:function(e,t){t.length&&this.writeMessage(e,u_,t)},writePackedBoolean:function(e,t){t.length&&this.writeMessage(e,p_,t)},writePackedFloat:function(e,t){t.length&&this.writeMessage(e,c_,t)},writePackedDouble:function(e,t){t.length&&this.writeMessage(e,h_,t)},writePackedFixed32:function(e,t){t.length&&this.writeMessage(e,f_,t)},writePackedSFixed32:function(e,t){t.length&&this.writeMessage(e,d_,t)},writePackedFixed64:function(e,t){t.length&&this.writeMessage(e,m_,t)},writePackedSFixed64:function(e,t){t.length&&this.writeMessage(e,y_,t)},writeBytesField:function(e,t){this.writeTag(e,qr.Bytes),this.writeBytes(t)},writeFixed32Field:function(e,t){this.writeTag(e,qr.Fixed32),this.writeFixed32(t)},writeSFixed32Field:function(e,t){this.writeTag(e,qr.Fixed32),this.writeSFixed32(t)},writeFixed64Field:function(e,t){this.writeTag(e,qr.Fixed64),this.writeFixed64(t)},writeSFixed64Field:function(e,t){this.writeTag(e,qr.Fixed64),this.writeSFixed64(t)},writeVarintField:function(e,t){this.writeTag(e,qr.Varint),this.writeVarint(t)},writeSVarintField:function(e,t){this.writeTag(e,qr.Varint),this.writeSVarint(t)},writeStringField:function(e,t){this.writeTag(e,qr.Bytes),this.writeString(t)},writeFloatField:function(e,t){this.writeTag(e,qr.Fixed32),this.writeFloat(t)},writeDoubleField:function(e,t){this.writeTag(e,qr.Fixed64),this.writeDouble(t)},writeBooleanField:function(e,t){this.writeVarintField(e,!!t)}};var Bc=function(e,t){var i=t.pixelRatio,l=t.version,p=t.stretchX,m=t.stretchY,x=t.content;this.paddedRect=e,this.pixelRatio=i,this.stretchX=p,this.stretchY=m,this.content=x,this.version=l},mu={tl:{configurable:!0},br:{configurable:!0},tlbr:{configurable:!0},displaySize:{configurable:!0}};mu.tl.get=function(){return[this.paddedRect.x+1,this.paddedRect.y+1]},mu.br.get=function(){return[this.paddedRect.x+this.paddedRect.w-1,this.paddedRect.y+this.paddedRect.h-1]},mu.tlbr.get=function(){return this.tl.concat(this.br)},mu.displaySize.get=function(){return[(this.paddedRect.w-2)/this.pixelRatio,(this.paddedRect.h-2)/this.pixelRatio]},Object.defineProperties(Bc.prototype,mu);var yu=function(e,t){var i={},l={};this.haveRenderCallbacks=[];var p=[];this.addImages(e,i,p),this.addImages(t,l,p);var m=_f(p),x=new Kn({width:m.w||1,height:m.h||1});for(var S in e){var z=e[S],A=i[S].paddedRect;Kn.copy(z.data,x,{x:0,y:0},{x:A.x+1,y:A.y+1},z.data)}for(var C in t){var B=t[C],U=l[C].paddedRect,q=U.x+1,Q=U.y+1,ee=B.data.width,ce=B.data.height;Kn.copy(B.data,x,{x:0,y:0},{x:q,y:Q},B.data),Kn.copy(B.data,x,{x:0,y:ce-1},{x:q,y:Q-1},{width:ee,height:1}),Kn.copy(B.data,x,{x:0,y:0},{x:q,y:Q+ce},{width:ee,height:1}),Kn.copy(B.data,x,{x:ee-1,y:0},{x:q-1,y:Q},{width:1,height:ce}),Kn.copy(B.data,x,{x:0,y:0},{x:q+ee,y:Q},{width:1,height:ce})}this.image=x,this.iconPositions=i,this.patternPositions=l};yu.prototype.addImages=function(e,t,i){for(var l in e){var p=e[l],m={x:0,y:0,w:p.data.width+2,h:p.data.height+2};i.push(m),t[l]=new Bc(m,p),p.hasRenderCallback&&this.haveRenderCallbacks.push(l)}},yu.prototype.patchUpdatedImages=function(e,t){for(var i in e.dispatchRenderCallbacks(this.haveRenderCallbacks),e.updatedImages)this.patchUpdatedImage(this.iconPositions[i],e.getImage(i),t),this.patchUpdatedImage(this.patternPositions[i],e.getImage(i),t)},yu.prototype.patchUpdatedImage=function(e,t,i){if(e&&t&&e.version!==t.version){e.version=t.version;var l=e.tl;i.update(t.data,void 0,{x:l[0],y:l[1]})}},st("ImagePosition",Bc),st("ImageAtlas",yu);var sa={horizontal:1,vertical:2,horizontalOnly:3},pl=function(){this.scale=1,this.fontStack="",this.imageName=null};pl.forText=function(e,t){var i=new pl;return i.scale=e||1,i.fontStack=t,i},pl.forImage=function(e){var t=new pl;return t.imageName=e,t};var En=function(){this.text="",this.sectionIndex=[],this.sections=[],this.imageSectionID=null};function Oc(e,t,i,l,p,m,x,S,z,A,C,B,U,q,Q,ee){var ce,ie=En.fromFeature(e,p);B===sa.vertical&&ie.verticalizePunctuation();var me=Qn.processBidirectionalText,be=Qn.processStyledBidirectionalText;if(me&&ie.sections.length===1){ce=[];for(var ke=0,Ie=me(ie.toString(),op(ie,A,m,t,l,q,Q));ke<Ie.length;ke+=1){var Pe=Ie[ke],je=new En;je.text=Pe,je.sections=ie.sections;for(var Qe=0;Qe<Pe.length;Qe++)je.sectionIndex.push(0);ce.push(je)}}else if(be){ce=[];for(var mt=0,rt=be(ie.text,ie.sectionIndex,op(ie,A,m,t,l,q,Q));mt<rt.length;mt+=1){var bt=rt[mt],nt=new En;nt.text=bt[0],nt.sectionIndex=bt[1],nt.sections=ie.sections,ce.push(nt)}}else ce=function(ct,rr){for(var Kt=[],yr=ct.text,xt=0,wr=0,Qr=rr;wr<Qr.length;wr+=1){var ci=Qr[wr];Kt.push(ct.substring(xt,ci)),xt=ci}return xt<yr.length&&Kt.push(ct.substring(xt,yr.length)),Kt}(ie,op(ie,A,m,t,l,q,Q));var Qt=[],Dt={positionedLines:Qt,text:ie.toString(),top:C[1],bottom:C[1],left:C[0],right:C[0],writingMode:B,iconsInText:!1,verticalizable:!1};return function(ct,rr,Kt,yr,xt,wr,Qr,ci,ai,$r,hi,Bi){for(var Oi=0,Tn=-17,Hi=0,In=0,yi=ci==="right"?1:ci==="left"?0:.5,Ji=0,hr=0,Or=xt;hr<Or.length;hr+=1){var Cr=Or[hr];Cr.trim();var gr=Cr.getMaxScale(),Dn=24*(gr-1),fn={positionedGlyphs:[],lineOffset:0};ct.positionedLines[Ji]=fn;var Hr=fn.positionedGlyphs,ki=0;if(Cr.length()){for(var dn=0;dn<Cr.length();dn++){var kr=Cr.getSection(dn),no=Cr.getSectionIndex(dn),la=Cr.getCharCode(dn),ao=0,_i=null,oo=null,Aa=null,bl=24,Ds=!(ai===sa.horizontal||!hi&&!Ys(la)||hi&&(Fc[la]||(Bo=la,$e.Arabic(Bo)||$e["Arabic Supplement"](Bo)||$e["Arabic Extended-A"](Bo)||$e["Arabic Presentation Forms-A"](Bo)||$e["Arabic Presentation Forms-B"](Bo))));if(kr.imageName){var xl=yr[kr.imageName];if(!xl)continue;Aa=kr.imageName,ct.iconsInText=ct.iconsInText||!0,oo=xl.paddedRect;var Ro=xl.displaySize;kr.scale=24*kr.scale/Bi,ao=Dn+(24-Ro[1]*kr.scale),bl=(_i={width:Ro[0],height:Ro[1],left:1,top:-3,advance:Ds?Ro[1]:Ro[0]}).advance;var wl=Ds?Ro[0]*kr.scale-24*gr:Ro[1]*kr.scale-24*gr;wl>0&&wl>ki&&(ki=wl)}else{var Xc=Kt[kr.fontStack],kl=Xc&&Xc[la];if(kl&&kl.rect)oo=kl.rect,_i=kl.metrics;else{var vu=rr[kr.fontStack],Wc=vu&&vu[la];if(!Wc)continue;_i=Wc.metrics}ao=24*(gr-kr.scale)}Ds?(ct.verticalizable=!0,Hr.push({glyph:la,imageName:Aa,x:Oi,y:Tn+ao,vertical:Ds,scale:kr.scale,fontStack:kr.fontStack,sectionIndex:no,metrics:_i,rect:oo}),Oi+=bl*kr.scale+$r):(Hr.push({glyph:la,imageName:Aa,x:Oi,y:Tn+ao,vertical:Ds,scale:kr.scale,fontStack:kr.fontStack,sectionIndex:no,metrics:_i,rect:oo}),Oi+=_i.advance*kr.scale+$r)}Hr.length!==0&&(Hi=Math.max(Oi-$r,Hi),x_(Hr,0,Hr.length-1,yi,ki)),Oi=0;var Hc=wr*gr+ki;fn.lineOffset=Math.max(ki,Dn),Tn+=Hc,In=Math.max(Hc,In),++Ji}else Tn+=wr,++Ji}var Bo,bu=Tn- -17,Sl=sp(Qr),ts=Sl.horizontalAlign,El=Sl.verticalAlign;(function(Jc,Yc,xu,wu,Qc,ku,Su,Eu,$c){var Tl,eh=(Yc-xu)*Qc;Tl=ku!==Su?-Eu*wu- -17:(-wu*$c+.5)*Su;for(var Il=0,Tu=Jc;Il<Tu.length;Il+=1)for(var Ls=0,Iu=Tu[Il].positionedGlyphs;Ls<Iu.length;Ls+=1){var zl=Iu[Ls];zl.x+=eh,zl.y+=Tl}})(ct.positionedLines,yi,ts,El,Hi,In,wr,bu,xt.length),ct.top+=-El*bu,ct.bottom=ct.top+bu,ct.left+=-ts*Hi,ct.right=ct.left+Hi}(Dt,t,i,l,ce,x,S,z,B,A,U,ee),!function(ct){for(var rr=0,Kt=ct;rr<Kt.length;rr+=1)if(Kt[rr].positionedGlyphs.length!==0)return!1;return!0}(Qt)&&Dt}En.fromFeature=function(e,t){for(var i=new En,l=0;l<e.sections.length;l++){var p=e.sections[l];p.image?i.addImageSection(p):i.addTextSection(p,t)}return i},En.prototype.length=function(){return this.text.length},En.prototype.getSection=function(e){return this.sections[this.sectionIndex[e]]},En.prototype.getSectionIndex=function(e){return this.sectionIndex[e]},En.prototype.getCharCode=function(e){return this.text.charCodeAt(e)},En.prototype.verticalizePunctuation=function(){this.text=function(e){for(var t="",i=0;i<e.length;i++){var l=e.charCodeAt(i+1)||null,p=e.charCodeAt(i-1)||null;t+=l&&$l(l)&&!du[e[i+1]]||p&&$l(p)&&!du[e[i-1]]||!du[e[i]]?e[i]:du[e[i]]}return t}(this.text)},En.prototype.trim=function(){for(var e=0,t=0;t<this.text.length&&Fc[this.text.charCodeAt(t)];t++)e++;for(var i=this.text.length,l=this.text.length-1;l>=0&&l>=e&&Fc[this.text.charCodeAt(l)];l--)i--;this.text=this.text.substring(e,i),this.sectionIndex=this.sectionIndex.slice(e,i)},En.prototype.substring=function(e,t){var i=new En;return i.text=this.text.substring(e,t),i.sectionIndex=this.sectionIndex.slice(e,t),i.sections=this.sections,i},En.prototype.toString=function(){return this.text},En.prototype.getMaxScale=function(){var e=this;return this.sectionIndex.reduce(function(t,i){return Math.max(t,e.sections[i].scale)},0)},En.prototype.addTextSection=function(e,t){this.text+=e.text,this.sections.push(pl.forText(e.scale,e.fontStack||t));for(var i=this.sections.length-1,l=0;l<e.text.length;++l)this.sectionIndex.push(i)},En.prototype.addImageSection=function(e){var t=e.image?e.image.name:"";if(t.length!==0){var i=this.getNextImageSectionCharCode();i?(this.text+=String.fromCharCode(i),this.sections.push(pl.forImage(t)),this.sectionIndex.push(this.sections.length-1)):yt("Reached maximum number of images 6401")}else yt("Can't add FormattedSection with an empty image.")},En.prototype.getNextImageSectionCharCode=function(){return this.imageSectionID?this.imageSectionID>=63743?null:++this.imageSectionID:(this.imageSectionID=57344,this.imageSectionID)};var Fc={9:!0,10:!0,11:!0,12:!0,13:!0,32:!0},ea={};function gf(e,t,i,l,p,m){if(t.imageName){var x=l[t.imageName];return x?x.displaySize[0]*t.scale*24/m+p:0}var S=i[t.fontStack],z=S&&S[e];return z?z.metrics.advance*t.scale+p:0}function vf(e,t,i,l){var p=Math.pow(e-t,2);return l?e<t?p/2:2*p:p+Math.abs(i)*i}function b_(e,t,i){var l=0;return e===10&&(l-=1e4),i&&(l+=150),e!==40&&e!==65288||(l+=50),t!==41&&t!==65289||(l+=50),l}function bf(e,t,i,l,p,m){for(var x=null,S=vf(t,i,p,m),z=0,A=l;z<A.length;z+=1){var C=A[z],B=vf(t-C.x,i,p,m)+C.badness;B<=S&&(x=C,S=B)}return{index:e,x:t,priorBreak:x,badness:S}}function op(e,t,i,l,p,m,x){if(m!=="point")return[];if(!e)return[];for(var S,z=[],A=function(ce,ie,me,be,ke,Ie){for(var Pe=0,je=0;je<ce.length();je++){var Qe=ce.getSection(je);Pe+=gf(ce.getCharCode(je),Qe,be,ke,ie,Ie)}return Pe/Math.max(1,Math.ceil(Pe/me))}(e,t,i,l,p,x),C=e.text.indexOf("")>=0,B=0,U=0;U<e.length();U++){var q=e.getSection(U),Q=e.getCharCode(U);if(Fc[Q]||(B+=gf(Q,q,l,p,t,x)),U<e.length()-1){var ee=!((S=Q)<11904||!($e["Bopomofo Extended"](S)||$e.Bopomofo(S)||$e["CJK Compatibility Forms"](S)||$e["CJK Compatibility Ideographs"](S)||$e["CJK Compatibility"](S)||$e["CJK Radicals Supplement"](S)||$e["CJK Strokes"](S)||$e["CJK Symbols and Punctuation"](S)||$e["CJK Unified Ideographs Extension A"](S)||$e["CJK Unified Ideographs"](S)||$e["Enclosed CJK Letters and Months"](S)||$e["Halfwidth and Fullwidth Forms"](S)||$e.Hiragana(S)||$e["Ideographic Description Characters"](S)||$e["Kangxi Radicals"](S)||$e["Katakana Phonetic Extensions"](S)||$e.Katakana(S)||$e["Vertical Forms"](S)||$e["Yi Radicals"](S)||$e["Yi Syllables"](S)));(ea[Q]||ee||q.imageName)&&z.push(bf(U+1,B,A,z,b_(Q,e.getCharCode(U+1),ee&&C),!1))}}return function ce(ie){return ie?ce(ie.priorBreak).concat(ie.index):[]}(bf(e.length(),B,A,z,0,!0))}function sp(e){var t=.5,i=.5;switch(e){case"right":case"top-right":case"bottom-right":t=1;break;case"left":case"top-left":case"bottom-left":t=0}switch(e){case"bottom":case"bottom-right":case"bottom-left":i=1;break;case"top":case"top-right":case"top-left":i=0}return{horizontalAlign:t,verticalAlign:i}}function x_(e,t,i,l,p){if(l||p)for(var m=e[i],x=(e[i].x+m.metrics.advance*m.scale)*l,S=t;S<=i;S++)e[S].x-=x,e[S].y+=p}function xf(e,t,i,l,p,m){var x,S=e.image;if(S.content){var z=S.content,A=S.pixelRatio||1;x=[z[0]/A,z[1]/A,S.displaySize[0]-z[2]/A,S.displaySize[1]-z[3]/A]}var C,B,U,q,Q=t.left*m,ee=t.right*m;i==="width"||i==="both"?(q=p[0]+Q-l[3],B=p[0]+ee+l[1]):B=(q=p[0]+(Q+ee-S.displaySize[0])/2)+S.displaySize[0];var ce=t.top*m,ie=t.bottom*m;return i==="height"||i==="both"?(C=p[1]+ce-l[0],U=p[1]+ie+l[2]):U=(C=p[1]+(ce+ie-S.displaySize[1])/2)+S.displaySize[1],{image:S,top:C,right:B,bottom:U,left:q,collisionPadding:x}}ea[10]=!0,ea[32]=!0,ea[38]=!0,ea[40]=!0,ea[41]=!0,ea[43]=!0,ea[45]=!0,ea[47]=!0,ea[173]=!0,ea[183]=!0,ea[8203]=!0,ea[8208]=!0,ea[8211]=!0,ea[8231]=!0;var fl=function(e){function t(i,l,p,m){e.call(this,i,l),this.angle=p,m!==void 0&&(this.segment=m)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.clone=function(){return new t(this.x,this.y,this.angle,this.segment)},t}(F);function lp(e,t){var i=t.expression;if(i.kind==="constant")return{kind:"constant",layoutSize:i.evaluate(new ur(e+1))};if(i.kind==="source")return{kind:"source"};for(var l=i.zoomStops,p=i.interpolationType,m=0;m<l.length&&l[m]<=e;)m++;for(var x=m=Math.max(0,m-1);x<l.length&&l[x]<e+1;)x++;x=Math.min(l.length-1,x);var S=l[m],z=l[x];return i.kind==="composite"?{kind:"composite",minZoom:S,maxZoom:z,interpolationType:p}:{kind:"camera",minZoom:S,maxZoom:z,minSize:i.evaluate(new ur(S)),maxSize:i.evaluate(new ur(z)),interpolationType:p}}function wf(e,t,i){var l=t.uSize,p=i.lowerSize;return e.kind==="source"?p/128:e.kind==="composite"?xi(p/128,i.upperSize/128,t.uSizeT):l}function kf(e,t){var i=0,l=0;if(e.kind==="constant")l=e.layoutSize;else if(e.kind!=="source"){var p=e.interpolationType,m=p?fe(rn.interpolationFactor(p,t,e.minZoom,e.maxZoom),0,1):0;e.kind==="camera"?l=xi(e.minSize,e.maxSize,m):i=m}return{uSizeT:i,uSize:l}}st("Anchor",fl);var w_=Object.freeze({__proto__:null,getSizeData:lp,evaluateSizeForFeature:wf,evaluateSizeForZoom:kf,SIZE_PACK_FACTOR:128});function Sf(e,t,i,l,p){if(t.segment===void 0)return!0;for(var m=t,x=t.segment+1,S=0;S>-i/2;){if(--x<0)return!1;S-=e[x].dist(m),m=e[x]}S+=e[x].dist(e[x+1]),x++;for(var z=[],A=0;S<i/2;){var C=e[x],B=e[x+1];if(!B)return!1;var U=e[x-1].angleTo(C)-C.angleTo(B);for(U=Math.abs((U+3*Math.PI)%(2*Math.PI)-Math.PI),z.push({distance:S,angleDelta:U}),A+=U;S-z[0].distance>l;)A-=z.shift().angleDelta;if(A>p)return!1;x++,S+=C.dist(B)}return!0}function Ef(e){for(var t=0,i=0;i<e.length-1;i++)t+=e[i].dist(e[i+1]);return t}function Tf(e,t,i){return e?.6*t*i:0}function If(e,t){return Math.max(e?e.right-e.left:0,t?t.right-t.left:0)}function k_(e,t,i,l,p,m){for(var x=Tf(i,p,m),S=If(i,l)*m,z=0,A=Ef(e)/2,C=0;C<e.length-1;C++){var B=e[C],U=e[C+1],q=B.dist(U);if(z+q>A){var Q=(A-z)/q,ee=xi(B.x,U.x,Q),ce=xi(B.y,U.y,Q),ie=new fl(ee,ce,U.angleTo(B),C);return ie._round(),!x||Sf(e,ie,S,x,t)?ie:void 0}z+=q}}function S_(e,t,i,l,p,m,x,S,z){var A=Tf(l,m,x),C=If(l,p),B=C*x,U=e[0].x===0||e[0].x===z||e[0].y===0||e[0].y===z;return t-B<t/4&&(t=B+t/4),function q(Q,ee,ce,ie,me,be,ke,Ie,Pe){for(var je=be/2,Qe=Ef(Q),mt=0,rt=ee-ce,bt=[],nt=0;nt<Q.length-1;nt++){for(var Qt=Q[nt],Dt=Q[nt+1],ct=Qt.dist(Dt),rr=Dt.angleTo(Qt);rt+ce<mt+ct;){var Kt=((rt+=ce)-mt)/ct,yr=xi(Qt.x,Dt.x,Kt),xt=xi(Qt.y,Dt.y,Kt);if(yr>=0&&yr<Pe&&xt>=0&&xt<Pe&&rt-je>=0&&rt+je<=Qe){var wr=new fl(yr,xt,rr,nt);wr._round(),ie&&!Sf(Q,wr,be,ie,me)||bt.push(wr)}}mt+=ct}return Ie||bt.length||ke||(bt=q(Q,mt/2,ce,ie,me,be,ke,!0,Pe)),bt}(e,U?t/2*S%t:(C/2+2*m)*x*S%t,t,A,i,B,U,!1,z)}function zf(e,t,i,l,p){for(var m=[],x=0;x<e.length;x++)for(var S=e[x],z=void 0,A=0;A<S.length-1;A++){var C=S[A],B=S[A+1];C.x<t&&B.x<t||(C.x<t?C=new F(t,C.y+(t-C.x)/(B.x-C.x)*(B.y-C.y))._round():B.x<t&&(B=new F(t,C.y+(t-C.x)/(B.x-C.x)*(B.y-C.y))._round()),C.y<i&&B.y<i||(C.y<i?C=new F(C.x+(i-C.y)/(B.y-C.y)*(B.x-C.x),i)._round():B.y<i&&(B=new F(C.x+(i-C.y)/(B.y-C.y)*(B.x-C.x),i)._round()),C.x>=l&&B.x>=l||(C.x>=l?C=new F(l,C.y+(l-C.x)/(B.x-C.x)*(B.y-C.y))._round():B.x>=l&&(B=new F(l,C.y+(l-C.x)/(B.x-C.x)*(B.y-C.y))._round()),C.y>=p&&B.y>=p||(C.y>=p?C=new F(C.x+(p-C.y)/(B.y-C.y)*(B.x-C.x),p)._round():B.y>=p&&(B=new F(C.x+(p-C.y)/(B.y-C.y)*(B.x-C.x),p)._round()),z&&C.equals(z[z.length-1])||m.push(z=[C]),z.push(B)))))}return m}function Af(e,t,i,l){var p=[],m=e.image,x=m.pixelRatio,S=m.paddedRect.w-2,z=m.paddedRect.h-2,A=e.right-e.left,C=e.bottom-e.top,B=m.stretchX||[[0,S]],U=m.stretchY||[[0,z]],q=function(yr,xt){return yr+xt[1]-xt[0]},Q=B.reduce(q,0),ee=U.reduce(q,0),ce=S-Q,ie=z-ee,me=0,be=Q,ke=0,Ie=ee,Pe=0,je=ce,Qe=0,mt=ie;if(m.content&&l){var rt=m.content;me=Nc(B,0,rt[0]),ke=Nc(U,0,rt[1]),be=Nc(B,rt[0],rt[2]),Ie=Nc(U,rt[1],rt[3]),Pe=rt[0]-me,Qe=rt[1]-ke,je=rt[2]-rt[0]-be,mt=rt[3]-rt[1]-Ie}var bt=function(yr,xt,wr,Qr){var ci=Uc(yr.stretch-me,be,A,e.left),ai=Vc(yr.fixed-Pe,je,yr.stretch,Q),$r=Uc(xt.stretch-ke,Ie,C,e.top),hi=Vc(xt.fixed-Qe,mt,xt.stretch,ee),Bi=Uc(wr.stretch-me,be,A,e.left),Oi=Vc(wr.fixed-Pe,je,wr.stretch,Q),Tn=Uc(Qr.stretch-ke,Ie,C,e.top),Hi=Vc(Qr.fixed-Qe,mt,Qr.stretch,ee),In=new F(ci,$r),yi=new F(Bi,$r),Ji=new F(Bi,Tn),hr=new F(ci,Tn),Or=new F(ai/x,hi/x),Cr=new F(Oi/x,Hi/x),gr=t*Math.PI/180;if(gr){var Dn=Math.sin(gr),fn=Math.cos(gr),Hr=[fn,-Dn,Dn,fn];In._matMult(Hr),yi._matMult(Hr),hr._matMult(Hr),Ji._matMult(Hr)}var ki=yr.stretch+yr.fixed,dn=xt.stretch+xt.fixed;return{tl:In,tr:yi,bl:hr,br:Ji,tex:{x:m.paddedRect.x+1+ki,y:m.paddedRect.y+1+dn,w:wr.stretch+wr.fixed-ki,h:Qr.stretch+Qr.fixed-dn},writingMode:void 0,glyphOffset:[0,0],sectionIndex:0,pixelOffsetTL:Or,pixelOffsetBR:Cr,minFontScaleX:je/x/A,minFontScaleY:mt/x/C,isSDF:i}};if(l&&(m.stretchX||m.stretchY))for(var nt=Pf(B,ce,Q),Qt=Pf(U,ie,ee),Dt=0;Dt<nt.length-1;Dt++)for(var ct=nt[Dt],rr=nt[Dt+1],Kt=0;Kt<Qt.length-1;Kt++)p.push(bt(ct,Qt[Kt],rr,Qt[Kt+1]));else p.push(bt({fixed:0,stretch:-1},{fixed:0,stretch:-1},{fixed:0,stretch:S+1},{fixed:0,stretch:z+1}));return p}function Nc(e,t,i){for(var l=0,p=0,m=e;p<m.length;p+=1){var x=m[p];l+=Math.max(t,Math.min(i,x[1]))-Math.max(t,Math.min(i,x[0]))}return l}function Pf(e,t,i){for(var l=[{fixed:-1,stretch:0}],p=0,m=e;p<m.length;p+=1){var x=m[p],S=x[0],z=x[1],A=l[l.length-1];l.push({fixed:S-A.stretch,stretch:A.stretch}),l.push({fixed:S-A.stretch,stretch:A.stretch+(z-S)})}return l.push({fixed:t+1,stretch:i}),l}function Uc(e,t,i,l){return e/t*i+l}function Vc(e,t,i,l){return e-t*i/l}var jc=function(e,t,i,l,p,m,x,S,z,A){if(this.boxStartIndex=e.length,z){var C=m.top,B=m.bottom,U=m.collisionPadding;U&&(C-=U[1],B+=U[3]);var q=B-C;q>0&&(q=Math.max(10,q),this.circleDiameter=q)}else{var Q=m.top*x-S,ee=m.bottom*x+S,ce=m.left*x-S,ie=m.right*x+S,me=m.collisionPadding;if(me&&(ce-=me[0]*x,Q-=me[1]*x,ie+=me[2]*x,ee+=me[3]*x),A){var be=new F(ce,Q),ke=new F(ie,Q),Ie=new F(ce,ee),Pe=new F(ie,ee),je=A*Math.PI/180;be._rotate(je),ke._rotate(je),Ie._rotate(je),Pe._rotate(je),ce=Math.min(be.x,ke.x,Ie.x,Pe.x),ie=Math.max(be.x,ke.x,Ie.x,Pe.x),Q=Math.min(be.y,ke.y,Ie.y,Pe.y),ee=Math.max(be.y,ke.y,Ie.y,Pe.y)}e.emplaceBack(t.x,t.y,ce,Q,ie,ee,i,l,p)}this.boxEndIndex=e.length},dl=function(e,t){if(e===void 0&&(e=[]),t===void 0&&(t=E_),this.data=e,this.length=this.data.length,this.compare=t,this.length>0)for(var i=(this.length>>1)-1;i>=0;i--)this._down(i)};function E_(e,t){return e<t?-1:e>t?1:0}function T_(e,t,i){t===void 0&&(t=1),i===void 0&&(i=!1);for(var l=1/0,p=1/0,m=-1/0,x=-1/0,S=e[0],z=0;z<S.length;z++){var A=S[z];(!z||A.x<l)&&(l=A.x),(!z||A.y<p)&&(p=A.y),(!z||A.x>m)&&(m=A.x),(!z||A.y>x)&&(x=A.y)}var C=Math.min(m-l,x-p),B=C/2,U=new dl([],I_);if(C===0)return new F(l,p);for(var q=l;q<m;q+=C)for(var Q=p;Q<x;Q+=C)U.push(new ml(q+B,Q+B,B,e));for(var ee=function(me){for(var be=0,ke=0,Ie=0,Pe=me[0],je=0,Qe=Pe.length,mt=Qe-1;je<Qe;mt=je++){var rt=Pe[je],bt=Pe[mt],nt=rt.x*bt.y-bt.x*rt.y;ke+=(rt.x+bt.x)*nt,Ie+=(rt.y+bt.y)*nt,be+=3*nt}return new ml(ke/be,Ie/be,0,me)}(e),ce=U.length;U.length;){var ie=U.pop();(ie.d>ee.d||!ee.d)&&(ee=ie,i&&console.log("found best %d after %d probes",Math.round(1e4*ie.d)/1e4,ce)),ie.max-ee.d<=t||(U.push(new ml(ie.p.x-(B=ie.h/2),ie.p.y-B,B,e)),U.push(new ml(ie.p.x+B,ie.p.y-B,B,e)),U.push(new ml(ie.p.x-B,ie.p.y+B,B,e)),U.push(new ml(ie.p.x+B,ie.p.y+B,B,e)),ce+=4)}return i&&(console.log("num probes: "+ce),console.log("best distance: "+ee.d)),ee.p}function I_(e,t){return t.max-e.max}function ml(e,t,i,l){this.p=new F(e,t),this.h=i,this.d=function(p,m){for(var x=!1,S=1/0,z=0;z<m.length;z++)for(var A=m[z],C=0,B=A.length,U=B-1;C<B;U=C++){var q=A[C],Q=A[U];q.y>p.y!=Q.y>p.y&&p.x<(Q.x-q.x)*(p.y-q.y)/(Q.y-q.y)+q.x&&(x=!x),S=Math.min(S,Yo(p,q,Q))}return(x?1:-1)*Math.sqrt(S)}(this.p,l),this.max=this.d+this.h*Math.SQRT2}dl.prototype.push=function(e){this.data.push(e),this.length++,this._up(this.length-1)},dl.prototype.pop=function(){if(this.length!==0){var e=this.data[0],t=this.data.pop();return this.length--,this.length>0&&(this.data[0]=t,this._down(0)),e}},dl.prototype.peek=function(){return this.data[0]},dl.prototype._up=function(e){for(var t=this.data,i=this.compare,l=t[e];e>0;){var p=e-1>>1,m=t[p];if(i(l,m)>=0)break;t[e]=m,e=p}t[e]=l},dl.prototype._down=function(e){for(var t=this.data,i=this.compare,l=this.length>>1,p=t[e];e<l;){var m=1+(e<<1),x=t[m],S=m+1;if(S<this.length&&i(t[S],x)<0&&(m=S,x=t[S]),i(x,p)>=0)break;t[e]=x,e=m}t[e]=p};var up=Number.POSITIVE_INFINITY;function Cf(e,t){return t[1]!==up?function(i,l,p){var m=0,x=0;switch(l=Math.abs(l),p=Math.abs(p),i){case"top-right":case"top-left":case"top":x=p-7;break;case"bottom-right":case"bottom-left":case"bottom":x=7-p}switch(i){case"top-right":case"bottom-right":case"right":m=-l;break;case"top-left":case"bottom-left":case"left":m=l}return[m,x]}(e,t[0],t[1]):function(i,l){var p=0,m=0;l<0&&(l=0);var x=l/Math.sqrt(2);switch(i){case"top-right":case"top-left":m=x-7;break;case"bottom-right":case"bottom-left":m=7-x;break;case"bottom":m=7-l;break;case"top":m=l-7}switch(i){case"top-right":case"bottom-right":p=-x;break;case"top-left":case"bottom-left":p=x;break;case"left":p=l;break;case"right":p=-l}return[p,m]}(e,t[0])}function cp(e){switch(e){case"right":case"top-right":case"bottom-right":return"right";case"left":case"top-left":case"bottom-left":return"left"}return"center"}function Mf(e,t,i,l,p,m,x,S,z,A,C,B,U,q,Q){var ee=function(ke,Ie,Pe,je,Qe,mt,rt,bt){for(var nt=je.layout.get("text-rotate").evaluate(mt,{})*Math.PI/180,Qt=[],Dt=0,ct=Ie.positionedLines;Dt<ct.length;Dt+=1)for(var rr=ct[Dt],Kt=0,yr=rr.positionedGlyphs;Kt<yr.length;Kt+=1){var xt=yr[Kt];if(xt.rect){var wr=xt.rect||{},Qr=4,ci=!0,ai=1,$r=0,hi=(Qe||bt)&&xt.vertical,Bi=xt.metrics.advance*xt.scale/2;if(bt&&Ie.verticalizable&&($r=rr.lineOffset/2-(xt.imageName?-(24-xt.metrics.width*xt.scale)/2:24*(xt.scale-1))),xt.imageName){var Oi=rt[xt.imageName];ci=Oi.sdf,Qr=1/(ai=Oi.pixelRatio)}var Tn=Qe?[xt.x+Bi,xt.y]:[0,0],Hi=Qe?[0,0]:[xt.x+Bi+Pe[0],xt.y+Pe[1]-$r],In=[0,0];hi&&(In=Hi,Hi=[0,0]);var yi=(xt.metrics.left-Qr)*xt.scale-Bi+Hi[0],Ji=(-xt.metrics.top-Qr)*xt.scale+Hi[1],hr=yi+wr.w*xt.scale/ai,Or=Ji+wr.h*xt.scale/ai,Cr=new F(yi,Ji),gr=new F(hr,Ji),Dn=new F(yi,Or),fn=new F(hr,Or);if(hi){var Hr=new F(-Bi,Bi- -17),ki=-Math.PI/2,dn=12-Bi,kr=new F(22-dn,-(xt.imageName?dn:0)),no=new(Function.prototype.bind.apply(F,[null].concat(In)));Cr._rotateAround(ki,Hr)._add(kr)._add(no),gr._rotateAround(ki,Hr)._add(kr)._add(no),Dn._rotateAround(ki,Hr)._add(kr)._add(no),fn._rotateAround(ki,Hr)._add(kr)._add(no)}if(nt){var la=Math.sin(nt),ao=Math.cos(nt),_i=[ao,-la,la,ao];Cr._matMult(_i),gr._matMult(_i),Dn._matMult(_i),fn._matMult(_i)}var oo=new F(0,0),Aa=new F(0,0);Qt.push({tl:Cr,tr:gr,bl:Dn,br:fn,tex:wr,writingMode:Ie.writingMode,glyphOffset:Tn,sectionIndex:xt.sectionIndex,isSDF:ci,pixelOffsetTL:oo,pixelOffsetBR:Aa,minFontScaleX:0,minFontScaleY:0})}}return Qt}(0,i,S,p,m,x,l,e.allowVerticalPlacement),ce=e.textSizeData,ie=null;ce.kind==="source"?(ie=[128*p.layout.get("text-size").evaluate(x,{})])[0]>32640&&yt(e.layerIds[0]+': Value for "text-size" is >= 255. Reduce your "text-size".'):ce.kind==="composite"&&((ie=[128*q.compositeTextSizes[0].evaluate(x,{},Q),128*q.compositeTextSizes[1].evaluate(x,{},Q)])[0]>32640||ie[1]>32640)&&yt(e.layerIds[0]+': Value for "text-size" is >= 255. Reduce your "text-size".'),e.addSymbols(e.text,ee,ie,S,m,x,A,t,z.lineStartIndex,z.lineLength,U,Q);for(var me=0,be=C;me<be.length;me+=1)B[be[me]]=e.text.placedSymbolArray.length-1;return 4*ee.length}function Df(e){for(var t in e)return e[t];return null}function z_(e,t,i,l){var p=e.compareText;if(t in p){for(var m=p[t],x=m.length-1;x>=0;x--)if(l.dist(m[x])<i)return!0}else p[t]=[];return p[t].push(l),!1}var A_=ul.VectorTileFeature.types,P_=[{name:"a_fade_opacity",components:1,type:"Uint8",offset:0}];function qc(e,t,i,l,p,m,x,S,z,A,C,B,U){var q=S?Math.min(32640,Math.round(S[0])):0,Q=S?Math.min(32640,Math.round(S[1])):0;e.emplaceBack(t,i,Math.round(32*l),Math.round(32*p),m,x,(q<<1)+(z?1:0),Q,16*A,16*C,256*B,256*U)}function hp(e,t,i){e.emplaceBack(t.x,t.y,i),e.emplaceBack(t.x,t.y,i),e.emplaceBack(t.x,t.y,i),e.emplaceBack(t.x,t.y,i)}function C_(e){for(var t=0,i=e.sections;t<i.length;t+=1)if(Qs(i[t].text))return!0;return!1}var yl=function(e){this.layoutVertexArray=new rl,this.indexArray=new Qa,this.programConfigurations=e,this.segments=new G,this.dynamicLayoutVertexArray=new Wo,this.opacityVertexArray=new ks,this.placedSymbolArray=new u};yl.prototype.isEmpty=function(){return this.layoutVertexArray.length===0&&this.indexArray.length===0&&this.dynamicLayoutVertexArray.length===0&&this.opacityVertexArray.length===0},yl.prototype.upload=function(e,t,i,l){this.isEmpty()||(i&&(this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,i_.members),this.indexBuffer=e.createIndexBuffer(this.indexArray,t),this.dynamicLayoutVertexBuffer=e.createVertexBuffer(this.dynamicLayoutVertexArray,n_.members,!0),this.opacityVertexBuffer=e.createVertexBuffer(this.opacityVertexArray,P_,!0),this.opacityVertexBuffer.itemSize=1),(i||l)&&this.programConfigurations.upload(e))},yl.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.dynamicLayoutVertexBuffer.destroy(),this.opacityVertexBuffer.destroy())},st("SymbolBuffers",yl);var _u=function(e,t,i){this.layoutVertexArray=new e,this.layoutAttributes=t,this.indexArray=new i,this.segments=new G,this.collisionVertexArray=new au};_u.prototype.upload=function(e){this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,this.layoutAttributes),this.indexBuffer=e.createIndexBuffer(this.indexArray),this.collisionVertexBuffer=e.createVertexBuffer(this.collisionVertexArray,a_.members,!0)},_u.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.collisionVertexBuffer.destroy())},st("CollisionBuffers",_u);var Rr=function(e){this.collisionBoxArray=e.collisionBoxArray,this.zoom=e.zoom,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map(function(m){return m.id}),this.index=e.index,this.pixelRatio=e.pixelRatio,this.sourceLayerIndex=e.sourceLayerIndex,this.hasPattern=!1,this.hasRTLText=!1,this.sortKeyRanges=[],this.collisionCircleArray=[],this.placementInvProjMatrix=$n([]),this.placementViewportMatrix=$n([]);var t=this.layers[0]._unevaluatedLayout._values;this.textSizeData=lp(this.zoom,t["text-size"]),this.iconSizeData=lp(this.zoom,t["icon-size"]);var i=this.layers[0].layout,l=i.get("symbol-sort-key"),p=i.get("symbol-z-order");this.canOverlap=i.get("text-allow-overlap")||i.get("icon-allow-overlap")||i.get("text-ignore-placement")||i.get("icon-ignore-placement"),this.sortFeaturesByKey=p!=="viewport-y"&&l.constantOr(1)!==void 0,this.sortFeaturesByY=(p==="viewport-y"||p==="auto"&&!this.sortFeaturesByKey)&&this.canOverlap,i.get("symbol-placement")==="point"&&(this.writingModes=i.get("text-writing-mode").map(function(m){return sa[m]})),this.stateDependentLayerIds=this.layers.filter(function(m){return m.isStateDependent()}).map(function(m){return m.id}),this.sourceID=e.sourceID};Rr.prototype.createArrays=function(){this.text=new yl(new Ct(this.layers,this.zoom,function(e){return/^text/.test(e)})),this.icon=new yl(new Ct(this.layers,this.zoom,function(e){return/^icon/.test(e)})),this.glyphOffsetArray=new k,this.lineVertexArray=new E,this.symbolInstances=new w},Rr.prototype.calculateGlyphDependencies=function(e,t,i,l,p){for(var m=0;m<e.length;m++)if(t[e.charCodeAt(m)]=!0,(i||l)&&p){var x=du[e.charAt(m)];x&&(t[x.charCodeAt(0)]=!0)}},Rr.prototype.populate=function(e,t,i){var l=this.layers[0],p=l.layout,m=p.get("text-font"),x=p.get("text-field"),S=p.get("icon-image"),z=(x.value.kind!=="constant"||x.value.value instanceof xr&&!x.value.value.isEmpty()||x.value.value.toString().length>0)&&(m.value.kind!=="constant"||m.value.value.length>0),A=S.value.kind!=="constant"||!!S.value.value||Object.keys(S.parameters).length>0,C=p.get("symbol-sort-key");if(this.features=[],z||A){for(var B=t.iconDependencies,U=t.glyphDependencies,q=t.availableImages,Q=new ur(this.zoom),ee=0,ce=e;ee<ce.length;ee+=1){var ie=ce[ee],me=ie.feature,be=ie.id,ke=ie.index,Ie=ie.sourceLayerIndex,Pe=l._featureFilter.needGeometry,je=mi(me,Pe);if(l._featureFilter.filter(Q,je,i)){Pe||(je.geometry=ni(me));var Qe=void 0;if(z){var mt=l.getValueAndResolveTokens("text-field",je,i,q),rt=xr.factory(mt);C_(rt)&&(this.hasRTLText=!0),(!this.hasRTLText||tu()==="unavailable"||this.hasRTLText&&Qn.isParsed())&&(Qe=s_(rt,l,je))}var bt=void 0;if(A){var nt=l.getValueAndResolveTokens("icon-image",je,i,q);bt=nt instanceof Di?nt:Di.fromString(nt)}if(Qe||bt){var Qt=this.sortFeaturesByKey?C.evaluate(je,{},i):void 0;if(this.features.push({id:be,text:Qe,icon:bt,index:ke,sourceLayerIndex:Ie,geometry:je.geometry,properties:me.properties,type:A_[me.type],sortKey:Qt}),bt&&(B[bt.name]=!0),Qe){var Dt=m.evaluate(je,{},i).join(","),ct=p.get("text-rotation-alignment")==="map"&&p.get("symbol-placement")!=="point";this.allowVerticalPlacement=this.writingModes&&this.writingModes.indexOf(sa.vertical)>=0;for(var rr=0,Kt=Qe.sections;rr<Kt.length;rr+=1){var yr=Kt[rr];if(yr.image)B[yr.image.name]=!0;else{var xt=Ql(Qe.toString()),wr=yr.fontStack||Dt,Qr=U[wr]=U[wr]||{};this.calculateGlyphDependencies(yr.text,Qr,ct,this.allowVerticalPlacement,xt)}}}}}}p.get("symbol-placement")==="line"&&(this.features=function(ci){var ai={},$r={},hi=[],Bi=0;function Oi(Hr){hi.push(ci[Hr]),Bi++}function Tn(Hr,ki,dn){var kr=$r[Hr];return delete $r[Hr],$r[ki]=kr,hi[kr].geometry[0].pop(),hi[kr].geometry[0]=hi[kr].geometry[0].concat(dn[0]),kr}function Hi(Hr,ki,dn){var kr=ai[ki];return delete ai[ki],ai[Hr]=kr,hi[kr].geometry[0].shift(),hi[kr].geometry[0]=dn[0].concat(hi[kr].geometry[0]),kr}function In(Hr,ki,dn){var kr=dn?ki[0][ki[0].length-1]:ki[0][0];return Hr+":"+kr.x+":"+kr.y}for(var yi=0;yi<ci.length;yi++){var Ji=ci[yi],hr=Ji.geometry,Or=Ji.text?Ji.text.toString():null;if(Or){var Cr=In(Or,hr),gr=In(Or,hr,!0);if(Cr in $r&&gr in ai&&$r[Cr]!==ai[gr]){var Dn=Hi(Cr,gr,hr),fn=Tn(Cr,gr,hi[Dn].geometry);delete ai[Cr],delete $r[gr],$r[In(Or,hi[fn].geometry,!0)]=fn,hi[Dn].geometry=null}else Cr in $r?Tn(Cr,gr,hr):gr in ai?Hi(Cr,gr,hr):(Oi(yi),ai[Cr]=Bi-1,$r[gr]=Bi-1)}else Oi(yi)}return hi.filter(function(Hr){return Hr.geometry})}(this.features)),this.sortFeaturesByKey&&this.features.sort(function(ci,ai){return ci.sortKey-ai.sortKey})}},Rr.prototype.update=function(e,t,i){this.stateDependentLayers.length&&(this.text.programConfigurations.updatePaintArrays(e,t,this.layers,i),this.icon.programConfigurations.updatePaintArrays(e,t,this.layers,i))},Rr.prototype.isEmpty=function(){return this.symbolInstances.length===0&&!this.hasRTLText},Rr.prototype.uploadPending=function(){return!this.uploaded||this.text.programConfigurations.needsUpload||this.icon.programConfigurations.needsUpload},Rr.prototype.upload=function(e){!this.uploaded&&this.hasDebugData()&&(this.textCollisionBox.upload(e),this.iconCollisionBox.upload(e)),this.text.upload(e,this.sortFeaturesByY,!this.uploaded,this.text.programConfigurations.needsUpload),this.icon.upload(e,this.sortFeaturesByY,!this.uploaded,this.icon.programConfigurations.needsUpload),this.uploaded=!0},Rr.prototype.destroyDebugData=function(){this.textCollisionBox.destroy(),this.iconCollisionBox.destroy()},Rr.prototype.destroy=function(){this.text.destroy(),this.icon.destroy(),this.hasDebugData()&&this.destroyDebugData()},Rr.prototype.addToLineVertexArray=function(e,t){var i=this.lineVertexArray.length;if(e.segment!==void 0){for(var l=e.dist(t[e.segment+1]),p=e.dist(t[e.segment]),m={},x=e.segment+1;x<t.length;x++)m[x]={x:t[x].x,y:t[x].y,tileUnitDistanceFromAnchor:l},x<t.length-1&&(l+=t[x+1].dist(t[x]));for(var S=e.segment||0;S>=0;S--)m[S]={x:t[S].x,y:t[S].y,tileUnitDistanceFromAnchor:p},S>0&&(p+=t[S-1].dist(t[S]));for(var z=0;z<t.length;z++){var A=m[z];this.lineVertexArray.emplaceBack(A.x,A.y,A.tileUnitDistanceFromAnchor)}}return{lineStartIndex:i,lineLength:this.lineVertexArray.length-i}},Rr.prototype.addSymbols=function(e,t,i,l,p,m,x,S,z,A,C,B){for(var U=e.indexArray,q=e.layoutVertexArray,Q=e.segments.prepareSegment(4*t.length,q,U,this.canOverlap?m.sortKey:void 0),ee=this.glyphOffsetArray.length,ce=Q.vertexLength,ie=this.allowVerticalPlacement&&x===sa.vertical?Math.PI/2:0,me=m.text&&m.text.sections,be=0;be<t.length;be++){var ke=t[be],Ie=ke.tl,Pe=ke.tr,je=ke.bl,Qe=ke.br,mt=ke.tex,rt=ke.pixelOffsetTL,bt=ke.pixelOffsetBR,nt=ke.minFontScaleX,Qt=ke.minFontScaleY,Dt=ke.glyphOffset,ct=ke.isSDF,rr=ke.sectionIndex,Kt=Q.vertexLength,yr=Dt[1];qc(q,S.x,S.y,Ie.x,yr+Ie.y,mt.x,mt.y,i,ct,rt.x,rt.y,nt,Qt),qc(q,S.x,S.y,Pe.x,yr+Pe.y,mt.x+mt.w,mt.y,i,ct,bt.x,rt.y,nt,Qt),qc(q,S.x,S.y,je.x,yr+je.y,mt.x,mt.y+mt.h,i,ct,rt.x,bt.y,nt,Qt),qc(q,S.x,S.y,Qe.x,yr+Qe.y,mt.x+mt.w,mt.y+mt.h,i,ct,bt.x,bt.y,nt,Qt),hp(e.dynamicLayoutVertexArray,S,ie),U.emplaceBack(Kt,Kt+1,Kt+2),U.emplaceBack(Kt+1,Kt+2,Kt+3),Q.vertexLength+=4,Q.primitiveLength+=2,this.glyphOffsetArray.emplaceBack(Dt[0]),be!==t.length-1&&rr===t[be+1].sectionIndex||e.programConfigurations.populatePaintArrays(q.length,m,m.index,{},B,me&&me[rr])}e.placedSymbolArray.emplaceBack(S.x,S.y,ee,this.glyphOffsetArray.length-ee,ce,z,A,S.segment,i?i[0]:0,i?i[1]:0,l[0],l[1],x,0,!1,0,C)},Rr.prototype._addCollisionDebugVertex=function(e,t,i,l,p,m){return t.emplaceBack(0,0),e.emplaceBack(i.x,i.y,l,p,Math.round(m.x),Math.round(m.y))},Rr.prototype.addCollisionDebugVertices=function(e,t,i,l,p,m,x){var S=p.segments.prepareSegment(4,p.layoutVertexArray,p.indexArray),z=S.vertexLength,A=p.layoutVertexArray,C=p.collisionVertexArray,B=x.anchorX,U=x.anchorY;this._addCollisionDebugVertex(A,C,m,B,U,new F(e,t)),this._addCollisionDebugVertex(A,C,m,B,U,new F(i,t)),this._addCollisionDebugVertex(A,C,m,B,U,new F(i,l)),this._addCollisionDebugVertex(A,C,m,B,U,new F(e,l)),S.vertexLength+=4;var q=p.indexArray;q.emplaceBack(z,z+1),q.emplaceBack(z+1,z+2),q.emplaceBack(z+2,z+3),q.emplaceBack(z+3,z),S.primitiveLength+=4},Rr.prototype.addDebugCollisionBoxes=function(e,t,i,l){for(var p=e;p<t;p++){var m=this.collisionBoxArray.get(p);this.addCollisionDebugVertices(m.x1,m.y1,m.x2,m.y2,l?this.textCollisionBox:this.iconCollisionBox,m.anchorPoint,i)}},Rr.prototype.generateCollisionDebugBuffers=function(){this.hasDebugData()&&this.destroyDebugData(),this.textCollisionBox=new _u(Ho,hf.members,Ss),this.iconCollisionBox=new _u(Ho,hf.members,Ss);for(var e=0;e<this.symbolInstances.length;e++){var t=this.symbolInstances.get(e);this.addDebugCollisionBoxes(t.textBoxStartIndex,t.textBoxEndIndex,t,!0),this.addDebugCollisionBoxes(t.verticalTextBoxStartIndex,t.verticalTextBoxEndIndex,t,!0),this.addDebugCollisionBoxes(t.iconBoxStartIndex,t.iconBoxEndIndex,t,!1),this.addDebugCollisionBoxes(t.verticalIconBoxStartIndex,t.verticalIconBoxEndIndex,t,!1)}},Rr.prototype._deserializeCollisionBoxesForSymbol=function(e,t,i,l,p,m,x,S,z){for(var A={},C=t;C<i;C++){var B=e.get(C);A.textBox={x1:B.x1,y1:B.y1,x2:B.x2,y2:B.y2,anchorPointX:B.anchorPointX,anchorPointY:B.anchorPointY},A.textFeatureIndex=B.featureIndex;break}for(var U=l;U<p;U++){var q=e.get(U);A.verticalTextBox={x1:q.x1,y1:q.y1,x2:q.x2,y2:q.y2,anchorPointX:q.anchorPointX,anchorPointY:q.anchorPointY},A.verticalTextFeatureIndex=q.featureIndex;break}for(var Q=m;Q<x;Q++){var ee=e.get(Q);A.iconBox={x1:ee.x1,y1:ee.y1,x2:ee.x2,y2:ee.y2,anchorPointX:ee.anchorPointX,anchorPointY:ee.anchorPointY},A.iconFeatureIndex=ee.featureIndex;break}for(var ce=S;ce<z;ce++){var ie=e.get(ce);A.verticalIconBox={x1:ie.x1,y1:ie.y1,x2:ie.x2,y2:ie.y2,anchorPointX:ie.anchorPointX,anchorPointY:ie.anchorPointY},A.verticalIconFeatureIndex=ie.featureIndex;break}return A},Rr.prototype.deserializeCollisionBoxes=function(e){this.collisionArrays=[];for(var t=0;t<this.symbolInstances.length;t++){var i=this.symbolInstances.get(t);this.collisionArrays.push(this._deserializeCollisionBoxesForSymbol(e,i.textBoxStartIndex,i.textBoxEndIndex,i.verticalTextBoxStartIndex,i.verticalTextBoxEndIndex,i.iconBoxStartIndex,i.iconBoxEndIndex,i.verticalIconBoxStartIndex,i.verticalIconBoxEndIndex))}},Rr.prototype.hasTextData=function(){return this.text.segments.get().length>0},Rr.prototype.hasIconData=function(){return this.icon.segments.get().length>0},Rr.prototype.hasDebugData=function(){return this.textCollisionBox&&this.iconCollisionBox},Rr.prototype.hasTextCollisionBoxData=function(){return this.hasDebugData()&&this.textCollisionBox.segments.get().length>0},Rr.prototype.hasIconCollisionBoxData=function(){return this.hasDebugData()&&this.iconCollisionBox.segments.get().length>0},Rr.prototype.addIndicesForPlacedSymbol=function(e,t){for(var i=e.placedSymbolArray.get(t),l=i.vertexStartIndex+4*i.numGlyphs,p=i.vertexStartIndex;p<l;p+=4)e.indexArray.emplaceBack(p,p+1,p+2),e.indexArray.emplaceBack(p+1,p+2,p+3)},Rr.prototype.getSortedSymbolIndexes=function(e){if(this.sortedAngle===e&&this.symbolInstanceIndexes!==void 0)return this.symbolInstanceIndexes;for(var t=Math.sin(e),i=Math.cos(e),l=[],p=[],m=[],x=0;x<this.symbolInstances.length;++x){m.push(x);var S=this.symbolInstances.get(x);l.push(0|Math.round(t*S.anchorX+i*S.anchorY)),p.push(S.featureIndex)}return m.sort(function(z,A){return l[z]-l[A]||p[A]-p[z]}),m},Rr.prototype.addToSortKeyRanges=function(e,t){var i=this.sortKeyRanges[this.sortKeyRanges.length-1];i&&i.sortKey===t?i.symbolInstanceEnd=e+1:this.sortKeyRanges.push({sortKey:t,symbolInstanceStart:e,symbolInstanceEnd:e+1})},Rr.prototype.sortFeatures=function(e){var t=this;if(this.sortFeaturesByY&&this.sortedAngle!==e&&!(this.text.segments.get().length>1||this.icon.segments.get().length>1)){this.symbolInstanceIndexes=this.getSortedSymbolIndexes(e),this.sortedAngle=e,this.text.indexArray.clear(),this.icon.indexArray.clear(),this.featureSortOrder=[];for(var i=0,l=this.symbolInstanceIndexes;i<l.length;i+=1){var p=this.symbolInstances.get(l[i]);this.featureSortOrder.push(p.featureIndex),[p.rightJustifiedTextSymbolIndex,p.centerJustifiedTextSymbolIndex,p.leftJustifiedTextSymbolIndex].forEach(function(m,x,S){m>=0&&S.indexOf(m)===x&&t.addIndicesForPlacedSymbol(t.text,m)}),p.verticalPlacedTextSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.text,p.verticalPlacedTextSymbolIndex),p.placedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,p.placedIconSymbolIndex),p.verticalPlacedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,p.verticalPlacedIconSymbolIndex)}this.text.indexBuffer&&this.text.indexBuffer.updateData(this.text.indexArray),this.icon.indexBuffer&&this.icon.indexBuffer.updateData(this.icon.indexArray)}},st("SymbolBucket",Rr,{omit:["layers","collisionBoxArray","features","compareText"]}),Rr.MAX_GLYPHS=65535,Rr.addDynamicAttributes=hp;var M_=new an({"symbol-placement":new gt(j.layout_symbol["symbol-placement"]),"symbol-spacing":new gt(j.layout_symbol["symbol-spacing"]),"symbol-avoid-edges":new gt(j.layout_symbol["symbol-avoid-edges"]),"symbol-sort-key":new ut(j.layout_symbol["symbol-sort-key"]),"symbol-z-order":new gt(j.layout_symbol["symbol-z-order"]),"icon-allow-overlap":new gt(j.layout_symbol["icon-allow-overlap"]),"icon-ignore-placement":new gt(j.layout_symbol["icon-ignore-placement"]),"icon-optional":new gt(j.layout_symbol["icon-optional"]),"icon-rotation-alignment":new gt(j.layout_symbol["icon-rotation-alignment"]),"icon-size":new ut(j.layout_symbol["icon-size"]),"icon-text-fit":new gt(j.layout_symbol["icon-text-fit"]),"icon-text-fit-padding":new gt(j.layout_symbol["icon-text-fit-padding"]),"icon-image":new ut(j.layout_symbol["icon-image"]),"icon-rotate":new ut(j.layout_symbol["icon-rotate"]),"icon-padding":new gt(j.layout_symbol["icon-padding"]),"icon-keep-upright":new gt(j.layout_symbol["icon-keep-upright"]),"icon-offset":new ut(j.layout_symbol["icon-offset"]),"icon-anchor":new ut(j.layout_symbol["icon-anchor"]),"icon-pitch-alignment":new gt(j.layout_symbol["icon-pitch-alignment"]),"text-pitch-alignment":new gt(j.layout_symbol["text-pitch-alignment"]),"text-rotation-alignment":new gt(j.layout_symbol["text-rotation-alignment"]),"text-field":new ut(j.layout_symbol["text-field"]),"text-font":new ut(j.layout_symbol["text-font"]),"text-size":new ut(j.layout_symbol["text-size"]),"text-max-width":new ut(j.layout_symbol["text-max-width"]),"text-line-height":new gt(j.layout_symbol["text-line-height"]),"text-letter-spacing":new ut(j.layout_symbol["text-letter-spacing"]),"text-justify":new ut(j.layout_symbol["text-justify"]),"text-radial-offset":new ut(j.layout_symbol["text-radial-offset"]),"text-variable-anchor":new gt(j.layout_symbol["text-variable-anchor"]),"text-anchor":new ut(j.layout_symbol["text-anchor"]),"text-max-angle":new gt(j.layout_symbol["text-max-angle"]),"text-writing-mode":new gt(j.layout_symbol["text-writing-mode"]),"text-rotate":new ut(j.layout_symbol["text-rotate"]),"text-padding":new gt(j.layout_symbol["text-padding"]),"text-keep-upright":new gt(j.layout_symbol["text-keep-upright"]),"text-transform":new ut(j.layout_symbol["text-transform"]),"text-offset":new ut(j.layout_symbol["text-offset"]),"text-allow-overlap":new gt(j.layout_symbol["text-allow-overlap"]),"text-ignore-placement":new gt(j.layout_symbol["text-ignore-placement"]),"text-optional":new gt(j.layout_symbol["text-optional"])}),pp={paint:new an({"icon-opacity":new ut(j.paint_symbol["icon-opacity"]),"icon-color":new ut(j.paint_symbol["icon-color"]),"icon-halo-color":new ut(j.paint_symbol["icon-halo-color"]),"icon-halo-width":new ut(j.paint_symbol["icon-halo-width"]),"icon-halo-blur":new ut(j.paint_symbol["icon-halo-blur"]),"icon-translate":new gt(j.paint_symbol["icon-translate"]),"icon-translate-anchor":new gt(j.paint_symbol["icon-translate-anchor"]),"text-opacity":new ut(j.paint_symbol["text-opacity"]),"text-color":new ut(j.paint_symbol["text-color"],{runtimeType:qe,getOverride:function(e){return e.textColor},hasOverride:function(e){return!!e.textColor}}),"text-halo-color":new ut(j.paint_symbol["text-halo-color"]),"text-halo-width":new ut(j.paint_symbol["text-halo-width"]),"text-halo-blur":new ut(j.paint_symbol["text-halo-blur"]),"text-translate":new gt(j.paint_symbol["text-translate"]),"text-translate-anchor":new gt(j.paint_symbol["text-translate-anchor"])}),layout:M_},_l=function(e){this.type=e.property.overrides?e.property.overrides.runtimeType:Ye,this.defaultValue=e};_l.prototype.evaluate=function(e){if(e.formattedSection){var t=this.defaultValue.property.overrides;if(t&&t.hasOverride(e.formattedSection))return t.getOverride(e.formattedSection)}return e.feature&&e.featureState?this.defaultValue.evaluate(e.feature,e.featureState):this.defaultValue.property.specification.default},_l.prototype.eachChild=function(e){this.defaultValue.isConstant()||e(this.defaultValue.value._styleExpression.expression)},_l.prototype.outputDefined=function(){return!1},_l.prototype.serialize=function(){return null},st("FormatSectionOverride",_l,{omit:["defaultValue"]});var D_=function(e){function t(i){e.call(this,i,pp)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.recalculate=function(i,l){if(e.prototype.recalculate.call(this,i,l),this.layout.get("icon-rotation-alignment")==="auto"&&(this.layout._values["icon-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-rotation-alignment")==="auto"&&(this.layout._values["text-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-pitch-alignment")==="auto"&&(this.layout._values["text-pitch-alignment"]=this.layout.get("text-rotation-alignment")),this.layout.get("icon-pitch-alignment")==="auto"&&(this.layout._values["icon-pitch-alignment"]=this.layout.get("icon-rotation-alignment")),this.layout.get("symbol-placement")==="point"){var p=this.layout.get("text-writing-mode");if(p){for(var m=[],x=0,S=p;x<S.length;x+=1){var z=S[x];m.indexOf(z)<0&&m.push(z)}this.layout._values["text-writing-mode"]=m}else this.layout._values["text-writing-mode"]=["horizontal"]}this._setPaintOverrides()},t.prototype.getValueAndResolveTokens=function(i,l,p,m){var x=this.layout.get(i).evaluate(l,{},p,m),S=this._unevaluatedLayout._values[i];return S.isDataDriven()||ps(S.value)||!x?x:function(z,A){return A.replace(/{([^{}]+)}/g,function(C,B){return B in z?String(z[B]):""})}(l.properties,x)},t.prototype.createBucket=function(i){return new Rr(i)},t.prototype.queryRadius=function(){return 0},t.prototype.queryIntersectsFeature=function(){return!1},t.prototype._setPaintOverrides=function(){for(var i=0,l=pp.paint.overridableProperties;i<l.length;i+=1){var p=l[i];if(t.hasPaintOverride(this.layout,p)){var m,x=this.paint.get(p),S=new _l(x),z=new jo(S,x.property.specification);m=x.value.kind==="constant"||x.value.kind==="source"?new fs("source",z):new qo("composite",z,x.value.zoomStops,x.value._interpolationType),this.paint._values[p]=new wn(x.property,m,x.parameters)}}},t.prototype._handleOverridablePaintPropertyUpdate=function(i,l,p){return!(!this.layout||l.isDataDriven()||p.isDataDriven())&&t.hasPaintOverride(this.layout,i)},t.hasPaintOverride=function(i,l){var p=i.get("text-field"),m=pp.paint.properties[l],x=!1,S=function(C){for(var B=0,U=C;B<U.length;B+=1)if(m.overrides&&m.overrides.hasOverride(U[B]))return void(x=!0)};if(p.value.kind==="constant"&&p.value.value instanceof xr)S(p.value.value.sections);else if(p.value.kind==="source"){var z=function(C){x||(C instanceof Si&&Xr(C.value)===lr?S(C.value.sections):C instanceof On?S(C.sections):C.eachChild(z))},A=p.value;A._styleExpression&&z(A._styleExpression.expression)}return x},t}(Ea),L_={paint:new an({"background-color":new gt(j.paint_background["background-color"]),"background-pattern":new kn(j.paint_background["background-pattern"]),"background-opacity":new gt(j.paint_background["background-opacity"])})},R_=function(e){function t(i){e.call(this,i,L_)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t}(Ea),B_={paint:new an({"raster-opacity":new gt(j.paint_raster["raster-opacity"]),"raster-hue-rotate":new gt(j.paint_raster["raster-hue-rotate"]),"raster-brightness-min":new gt(j.paint_raster["raster-brightness-min"]),"raster-brightness-max":new gt(j.paint_raster["raster-brightness-max"]),"raster-saturation":new gt(j.paint_raster["raster-saturation"]),"raster-contrast":new gt(j.paint_raster["raster-contrast"]),"raster-resampling":new gt(j.paint_raster["raster-resampling"]),"raster-fade-duration":new gt(j.paint_raster["raster-fade-duration"])})},O_=function(e){function t(i){e.call(this,i,B_)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t}(Ea),F_=function(e){function t(i){e.call(this,i,{}),this.implementation=i}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.is3D=function(){return this.implementation.renderingMode==="3d"},t.prototype.hasOffscreenPass=function(){return this.implementation.prerender!==void 0},t.prototype.recalculate=function(){},t.prototype.updateTransitions=function(){},t.prototype.hasTransition=function(){},t.prototype.serialize=function(){},t.prototype.onAdd=function(i){this.implementation.onAdd&&this.implementation.onAdd(i,i.painter.context.gl)},t.prototype.onRemove=function(i){this.implementation.onRemove&&this.implementation.onRemove(i,i.painter.context.gl)},t}(Ea),N_={circle:Jh,heatmap:wy,hillshade:Sy,fill:Vy,"fill-extrusion":Jy,line:r_,symbol:D_,background:R_,raster:O_},Lf=D.HTMLImageElement,Rf=D.HTMLCanvasElement,Bf=D.HTMLVideoElement,Of=D.ImageData,Zc=D.ImageBitmap,Ps=function(e,t,i,l){this.context=e,this.format=i,this.texture=e.gl.createTexture(),this.update(t,l)};Ps.prototype.update=function(e,t,i){var l=e.width,p=e.height,m=!(this.size&&this.size[0]===l&&this.size[1]===p||i),x=this.context,S=x.gl;if(this.useMipmap=!!(t&&t.useMipmap),S.bindTexture(S.TEXTURE_2D,this.texture),x.pixelStoreUnpackFlipY.set(!1),x.pixelStoreUnpack.set(1),x.pixelStoreUnpackPremultiplyAlpha.set(this.format===S.RGBA&&(!t||t.premultiply!==!1)),m)this.size=[l,p],e instanceof Lf||e instanceof Rf||e instanceof Bf||e instanceof Of||Zc&&e instanceof Zc?S.texImage2D(S.TEXTURE_2D,0,this.format,this.format,S.UNSIGNED_BYTE,e):S.texImage2D(S.TEXTURE_2D,0,this.format,l,p,0,this.format,S.UNSIGNED_BYTE,e.data);else{var z=i||{x:0,y:0},A=z.x,C=z.y;e instanceof Lf||e instanceof Rf||e instanceof Bf||e instanceof Of||Zc&&e instanceof Zc?S.texSubImage2D(S.TEXTURE_2D,0,A,C,S.RGBA,S.UNSIGNED_BYTE,e):S.texSubImage2D(S.TEXTURE_2D,0,A,C,l,p,S.RGBA,S.UNSIGNED_BYTE,e.data)}this.useMipmap&&this.isSizePowerOfTwo()&&S.generateMipmap(S.TEXTURE_2D)},Ps.prototype.bind=function(e,t,i){var l=this.context.gl;l.bindTexture(l.TEXTURE_2D,this.texture),i!==l.LINEAR_MIPMAP_NEAREST||this.isSizePowerOfTwo()||(i=l.LINEAR),e!==this.filter&&(l.texParameteri(l.TEXTURE_2D,l.TEXTURE_MAG_FILTER,e),l.texParameteri(l.TEXTURE_2D,l.TEXTURE_MIN_FILTER,i||e),this.filter=e),t!==this.wrap&&(l.texParameteri(l.TEXTURE_2D,l.TEXTURE_WRAP_S,t),l.texParameteri(l.TEXTURE_2D,l.TEXTURE_WRAP_T,t),this.wrap=t)},Ps.prototype.isSizePowerOfTwo=function(){return this.size[0]===this.size[1]&&Math.log(this.size[0])/Math.LN2%1==0},Ps.prototype.destroy=function(){this.context.gl.deleteTexture(this.texture),this.texture=null};var fp=function(e){var t=this;this._callback=e,this._triggered=!1,typeof MessageChannel<"u"&&(this._channel=new MessageChannel,this._channel.port2.onmessage=function(){t._triggered=!1,t._callback()})};fp.prototype.trigger=function(){var e=this;this._triggered||(this._triggered=!0,this._channel?this._channel.port1.postMessage(!0):setTimeout(function(){e._triggered=!1,e._callback()},0))},fp.prototype.remove=function(){delete this._channel,this._callback=function(){}};var gl=function(e,t,i){this.target=e,this.parent=t,this.mapId=i,this.callbacks={},this.tasks={},this.taskQueue=[],this.cancelCallbacks={},Tt(["receive","process"],this),this.invoker=new fp(this.process),this.target.addEventListener("message",this.receive,!1),this.globalScope=Zt()?e:D};function Ff(e,t,i){var l=2*Math.PI*6378137/256/Math.pow(2,i);return[e*l-2*Math.PI*6378137/2,t*l-2*Math.PI*6378137/2]}gl.prototype.send=function(e,t,i,l,p){var m=this;p===void 0&&(p=!1);var x=Math.round(1e18*Math.random()).toString(36).substring(0,10);i&&(this.callbacks[x]=i);var S=Ut(this.globalScope)?void 0:[];return this.target.postMessage({id:x,type:e,hasCallback:!!i,targetMapId:l,mustQueue:p,sourceMapId:this.mapId,data:fa(t,S)},S),{cancel:function(){i&&delete m.callbacks[x],m.target.postMessage({id:x,type:"<cancel>",targetMapId:l,sourceMapId:m.mapId})}}},gl.prototype.receive=function(e){var t=e.data,i=t.id;if(i&&(!t.targetMapId||this.mapId===t.targetMapId))if(t.type==="<cancel>"){delete this.tasks[i];var l=this.cancelCallbacks[i];delete this.cancelCallbacks[i],l&&l()}else Zt()||t.mustQueue?(this.tasks[i]=t,this.taskQueue.push(i),this.invoker.trigger()):this.processTask(i,t)},gl.prototype.process=function(){if(this.taskQueue.length){var e=this.taskQueue.shift(),t=this.tasks[e];delete this.tasks[e],this.taskQueue.length&&this.invoker.trigger(),t&&this.processTask(e,t)}},gl.prototype.processTask=function(e,t){var i=this;if(t.type==="<response>"){var l=this.callbacks[e];delete this.callbacks[e],l&&(t.error?l(Vn(t.error)):l(null,Vn(t.data)))}else{var p=!1,m=Ut(this.globalScope)?void 0:[],x=t.hasCallback?function(C,B){p=!0,delete i.cancelCallbacks[e],i.target.postMessage({id:e,type:"<response>",sourceMapId:i.mapId,error:C?fa(C):null,data:fa(B,m)},m)}:function(C){p=!0},S=null,z=Vn(t.data);if(this.parent[t.type])S=this.parent[t.type](t.sourceMapId,z,x);else if(this.parent.getWorkerSource){var A=t.type.split(".");S=this.parent.getWorkerSource(t.sourceMapId,A[0],z.source)[A[1]](z,x)}else x(new Error("Could not find function "+t.type));!p&&S&&S.cancel&&(this.cancelCallbacks[e]=S.cancel)}},gl.prototype.remove=function(){this.invoker.remove(),this.target.removeEventListener("message",this.receive,!1)};var Ai=function(e,t){e&&(t?this.setSouthWest(e).setNorthEast(t):e.length===4?this.setSouthWest([e[0],e[1]]).setNorthEast([e[2],e[3]]):this.setSouthWest(e[0]).setNorthEast(e[1]))};Ai.prototype.setNorthEast=function(e){return this._ne=e instanceof Yr?new Yr(e.lng,e.lat):Yr.convert(e),this},Ai.prototype.setSouthWest=function(e){return this._sw=e instanceof Yr?new Yr(e.lng,e.lat):Yr.convert(e),this},Ai.prototype.extend=function(e){var t,i,l=this._sw,p=this._ne;if(e instanceof Yr)t=e,i=e;else{if(!(e instanceof Ai))return Array.isArray(e)?e.length===4||e.every(Array.isArray)?this.extend(Ai.convert(e)):this.extend(Yr.convert(e)):this;if(i=e._ne,!(t=e._sw)||!i)return this}return l||p?(l.lng=Math.min(t.lng,l.lng),l.lat=Math.min(t.lat,l.lat),p.lng=Math.max(i.lng,p.lng),p.lat=Math.max(i.lat,p.lat)):(this._sw=new Yr(t.lng,t.lat),this._ne=new Yr(i.lng,i.lat)),this},Ai.prototype.getCenter=function(){return new Yr((this._sw.lng+this._ne.lng)/2,(this._sw.lat+this._ne.lat)/2)},Ai.prototype.getSouthWest=function(){return this._sw},Ai.prototype.getNorthEast=function(){return this._ne},Ai.prototype.getNorthWest=function(){return new Yr(this.getWest(),this.getNorth())},Ai.prototype.getSouthEast=function(){return new Yr(this.getEast(),this.getSouth())},Ai.prototype.getWest=function(){return this._sw.lng},Ai.prototype.getSouth=function(){return this._sw.lat},Ai.prototype.getEast=function(){return this._ne.lng},Ai.prototype.getNorth=function(){return this._ne.lat},Ai.prototype.toArray=function(){return[this._sw.toArray(),this._ne.toArray()]},Ai.prototype.toString=function(){return"LngLatBounds("+this._sw.toString()+", "+this._ne.toString()+")"},Ai.prototype.isEmpty=function(){return!(this._sw&&this._ne)},Ai.prototype.contains=function(e){var t=Yr.convert(e),i=t.lng,l=t.lat,p=this._sw.lng<=i&&i<=this._ne.lng;return this._sw.lng>this._ne.lng&&(p=this._sw.lng>=i&&i>=this._ne.lng),this._sw.lat<=l&&l<=this._ne.lat&&p},Ai.convert=function(e){return!e||e instanceof Ai?e:new Ai(e)};var Yr=function(e,t){if(isNaN(e)||isNaN(t))throw new Error("Invalid LngLat object: ("+e+", "+t+")");if(this.lng=+e,this.lat=+t,this.lat>90||this.lat<-90)throw new Error("Invalid LngLat latitude value: must be between -90 and 90")};Yr.prototype.wrap=function(){return new Yr(we(this.lng,-180,180),this.lat)},Yr.prototype.toArray=function(){return[this.lng,this.lat]},Yr.prototype.toString=function(){return"LngLat("+this.lng+", "+this.lat+")"},Yr.prototype.distanceTo=function(e){var t=Math.PI/180,i=this.lat*t,l=e.lat*t,p=Math.sin(i)*Math.sin(l)+Math.cos(i)*Math.cos(l)*Math.cos((e.lng-this.lng)*t);return 63710088e-1*Math.acos(Math.min(p,1))},Yr.prototype.toBounds=function(e){e===void 0&&(e=0);var t=360*e/40075017,i=t/Math.cos(Math.PI/180*this.lat);return new Ai(new Yr(this.lng-i,this.lat-t),new Yr(this.lng+i,this.lat+t))},Yr.convert=function(e){if(e instanceof Yr)return e;if(Array.isArray(e)&&(e.length===2||e.length===3))return new Yr(Number(e[0]),Number(e[1]));if(!Array.isArray(e)&&typeof e=="object"&&e!==null)return new Yr(Number("lng"in e?e.lng:e.lon),Number(e.lat));throw new Error("`LngLatLike` argument must be specified as a LngLat instance, an object {lng: <lng>, lat: <lat>}, an object {lon: <lng>, lat: <lat>}, or an array of [<lng>, <lat>]")};var Nf=2*Math.PI*63710088e-1;function Uf(e){return Nf*Math.cos(e*Math.PI/180)}function Vf(e){return(180+e)/360}function jf(e){return(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+e*Math.PI/360)))/360}function qf(e,t){return e/Uf(t)}function dp(e){return 360/Math.PI*Math.atan(Math.exp((180-360*e)*Math.PI/180))-90}var Cs=function(e,t,i){i===void 0&&(i=0),this.x=+e,this.y=+t,this.z=+i};Cs.fromLngLat=function(e,t){t===void 0&&(t=0);var i=Yr.convert(e);return new Cs(Vf(i.lng),jf(i.lat),qf(t,i.lat))},Cs.prototype.toLngLat=function(){return new Yr(360*this.x-180,dp(this.y))},Cs.prototype.toAltitude=function(){return this.z*Uf(dp(this.y))},Cs.prototype.meterInMercatorCoordinateUnits=function(){return 1/Nf*(e=dp(this.y),1/Math.cos(e*Math.PI/180));var e};var Ms=function(e,t,i){this.z=e,this.x=t,this.y=i,this.key=gu(0,e,e,t,i)};Ms.prototype.equals=function(e){return this.z===e.z&&this.x===e.x&&this.y===e.y},Ms.prototype.url=function(e,t){var i,l,p,m,x,S=(l=this.y,p=this.z,m=Ff(256*(i=this.x),256*(l=Math.pow(2,p)-l-1),p),x=Ff(256*(i+1),256*(l+1),p),m[0]+","+m[1]+","+x[0]+","+x[1]),z=function(A,C,B){for(var U,q="",Q=A;Q>0;Q--)q+=(C&(U=1<<Q-1)?1:0)+(B&U?2:0);return q}(this.z,this.x,this.y);return e[(this.x+this.y)%e.length].replace("{prefix}",(this.x%16).toString(16)+(this.y%16).toString(16)).replace("{z}",String(this.z)).replace("{x}",String(this.x)).replace("{y}",String(t==="tms"?Math.pow(2,this.z)-this.y-1:this.y)).replace("{quadkey}",z).replace("{bbox-epsg-3857}",S)},Ms.prototype.getTilePoint=function(e){var t=Math.pow(2,this.z);return new F(8192*(e.x*t-this.x),8192*(e.y*t-this.y))},Ms.prototype.toString=function(){return this.z+"/"+this.x+"/"+this.y};var Zf=function(e,t){this.wrap=e,this.canonical=t,this.key=gu(e,t.z,t.z,t.x,t.y)},Pi=function(e,t,i,l,p){this.overscaledZ=e,this.wrap=t,this.canonical=new Ms(i,+l,+p),this.key=gu(t,e,i,l,p)};function gu(e,t,i,l,p){(e*=2)<0&&(e=-1*e-1);var m=1<<i;return(m*m*e+m*p+l).toString(36)+i.toString(36)+t.toString(36)}Pi.prototype.equals=function(e){return this.overscaledZ===e.overscaledZ&&this.wrap===e.wrap&&this.canonical.equals(e.canonical)},Pi.prototype.scaledTo=function(e){var t=this.canonical.z-e;return e>this.canonical.z?new Pi(e,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y):new Pi(e,this.wrap,e,this.canonical.x>>t,this.canonical.y>>t)},Pi.prototype.calculateScaledKey=function(e,t){var i=this.canonical.z-e;return e>this.canonical.z?gu(this.wrap*+t,e,this.canonical.z,this.canonical.x,this.canonical.y):gu(this.wrap*+t,e,e,this.canonical.x>>i,this.canonical.y>>i)},Pi.prototype.isChildOf=function(e){if(e.wrap!==this.wrap)return!1;var t=this.canonical.z-e.canonical.z;return e.overscaledZ===0||e.overscaledZ<this.overscaledZ&&e.canonical.x===this.canonical.x>>t&&e.canonical.y===this.canonical.y>>t},Pi.prototype.children=function(e){if(this.overscaledZ>=e)return[new Pi(this.overscaledZ+1,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)];var t=this.canonical.z+1,i=2*this.canonical.x,l=2*this.canonical.y;return[new Pi(t,this.wrap,t,i,l),new Pi(t,this.wrap,t,i+1,l),new Pi(t,this.wrap,t,i,l+1),new Pi(t,this.wrap,t,i+1,l+1)]},Pi.prototype.isLessThan=function(e){return this.wrap<e.wrap||!(this.wrap>e.wrap)&&(this.overscaledZ<e.overscaledZ||!(this.overscaledZ>e.overscaledZ)&&(this.canonical.x<e.canonical.x||!(this.canonical.x>e.canonical.x)&&this.canonical.y<e.canonical.y))},Pi.prototype.wrapped=function(){return new Pi(this.overscaledZ,0,this.canonical.z,this.canonical.x,this.canonical.y)},Pi.prototype.unwrapTo=function(e){return new Pi(this.overscaledZ,e,this.canonical.z,this.canonical.x,this.canonical.y)},Pi.prototype.overscaleFactor=function(){return Math.pow(2,this.overscaledZ-this.canonical.z)},Pi.prototype.toUnwrapped=function(){return new Zf(this.wrap,this.canonical)},Pi.prototype.toString=function(){return this.overscaledZ+"/"+this.canonical.x+"/"+this.canonical.y},Pi.prototype.getTilePoint=function(e){return this.canonical.getTilePoint(new Cs(e.x-this.wrap,e.y))},st("CanonicalTileID",Ms),st("OverscaledTileID",Pi,{omit:["posMatrix"]});var Do=function(e,t,i){if(this.uid=e,t.height!==t.width)throw new RangeError("DEM tiles must be square");if(i&&i!=="mapbox"&&i!=="terrarium")return yt('"'+i+'" is not a valid encoding type. Valid types include "mapbox" and "terrarium".');this.stride=t.height;var l=this.dim=t.height-2;this.data=new Uint32Array(t.data.buffer),this.encoding=i||"mapbox";for(var p=0;p<l;p++)this.data[this._idx(-1,p)]=this.data[this._idx(0,p)],this.data[this._idx(l,p)]=this.data[this._idx(l-1,p)],this.data[this._idx(p,-1)]=this.data[this._idx(p,0)],this.data[this._idx(p,l)]=this.data[this._idx(p,l-1)];this.data[this._idx(-1,-1)]=this.data[this._idx(0,0)],this.data[this._idx(l,-1)]=this.data[this._idx(l-1,0)],this.data[this._idx(-1,l)]=this.data[this._idx(0,l-1)],this.data[this._idx(l,l)]=this.data[this._idx(l-1,l-1)]};Do.prototype.get=function(e,t){var i=new Uint8Array(this.data.buffer),l=4*this._idx(e,t);return(this.encoding==="terrarium"?this._unpackTerrarium:this._unpackMapbox)(i[l],i[l+1],i[l+2])},Do.prototype.getUnpackVector=function(){return this.encoding==="terrarium"?[256,1,1/256,32768]:[6553.6,25.6,.1,1e4]},Do.prototype._idx=function(e,t){if(e<-1||e>=this.dim+1||t<-1||t>=this.dim+1)throw new RangeError("out of range source coordinates for DEM data");return(t+1)*this.stride+(e+1)},Do.prototype._unpackMapbox=function(e,t,i){return(256*e*256+256*t+i)/10-1e4},Do.prototype._unpackTerrarium=function(e,t,i){return 256*e+t+i/256-32768},Do.prototype.getPixels=function(){return new Kn({width:this.stride,height:this.stride},new Uint8Array(this.data.buffer))},Do.prototype.backfillBorder=function(e,t,i){if(this.dim!==e.dim)throw new Error("dem dimension mismatch");var l=t*this.dim,p=t*this.dim+this.dim,m=i*this.dim,x=i*this.dim+this.dim;switch(t){case-1:l=p-1;break;case 1:p=l+1}switch(i){case-1:m=x-1;break;case 1:x=m+1}for(var S=-t*this.dim,z=-i*this.dim,A=m;A<x;A++)for(var C=l;C<p;C++)this.data[this._idx(C,A)]=e.data[this._idx(C+S,A+z)]},st("DEMData",Do);var Gc=function(e){this._stringToNumber={},this._numberToString=[];for(var t=0;t<e.length;t++){var i=e[t];this._stringToNumber[i]=t,this._numberToString[t]=i}};Gc.prototype.encode=function(e){return this._stringToNumber[e]},Gc.prototype.decode=function(e){return this._numberToString[e]};var Kc=function(e,t,i,l,p){this.type="Feature",this._vectorTileFeature=e,e._z=t,e._x=i,e._y=l,this.properties=e.properties,this.id=p},mp={geometry:{configurable:!0}};mp.geometry.get=function(){return this._geometry===void 0&&(this._geometry=this._vectorTileFeature.toGeoJSON(this._vectorTileFeature._x,this._vectorTileFeature._y,this._vectorTileFeature._z).geometry),this._geometry},mp.geometry.set=function(e){this._geometry=e},Kc.prototype.toJSON=function(){var e={geometry:this.geometry};for(var t in this)t!=="_geometry"&&t!=="_vectorTileFeature"&&(e[t]=this[t]);return e},Object.defineProperties(Kc.prototype,mp);var vl=function(){this.state={},this.stateChanges={},this.deletedStates={}};vl.prototype.updateState=function(e,t,i){var l=String(t);if(this.stateChanges[e]=this.stateChanges[e]||{},this.stateChanges[e][l]=this.stateChanges[e][l]||{},xe(this.stateChanges[e][l],i),this.deletedStates[e]===null)for(var p in this.deletedStates[e]={},this.state[e])p!==l&&(this.deletedStates[e][p]=null);else if(this.deletedStates[e]&&this.deletedStates[e][l]===null)for(var m in this.deletedStates[e][l]={},this.state[e][l])i[m]||(this.deletedStates[e][l][m]=null);else for(var x in i)this.deletedStates[e]&&this.deletedStates[e][l]&&this.deletedStates[e][l][x]===null&&delete this.deletedStates[e][l][x]},vl.prototype.removeFeatureState=function(e,t,i){if(this.deletedStates[e]!==null){var l=String(t);if(this.deletedStates[e]=this.deletedStates[e]||{},i&&t!==void 0)this.deletedStates[e][l]!==null&&(this.deletedStates[e][l]=this.deletedStates[e][l]||{},this.deletedStates[e][l][i]=null);else if(t!==void 0)if(this.stateChanges[e]&&this.stateChanges[e][l])for(i in this.deletedStates[e][l]={},this.stateChanges[e][l])this.deletedStates[e][l][i]=null;else this.deletedStates[e][l]=null;else this.deletedStates[e]=null}},vl.prototype.getState=function(e,t){var i=String(t),l=xe({},(this.state[e]||{})[i],(this.stateChanges[e]||{})[i]);if(this.deletedStates[e]===null)return{};if(this.deletedStates[e]){var p=this.deletedStates[e][t];if(p===null)return{};for(var m in p)delete l[m]}return l},vl.prototype.initializeTileState=function(e,t){e.setFeatureState(this.state,t)},vl.prototype.coalesceChanges=function(e,t){var i={};for(var l in this.stateChanges){this.state[l]=this.state[l]||{};var p={};for(var m in this.stateChanges[l])this.state[l][m]||(this.state[l][m]={}),xe(this.state[l][m],this.stateChanges[l][m]),p[m]=this.state[l][m];i[l]=p}for(var x in this.deletedStates){this.state[x]=this.state[x]||{};var S={};if(this.deletedStates[x]===null)for(var z in this.state[x])S[z]={},this.state[x][z]={};else for(var A in this.deletedStates[x]){if(this.deletedStates[x][A]===null)this.state[x][A]={};else for(var C=0,B=Object.keys(this.deletedStates[x][A]);C<B.length;C+=1)delete this.state[x][A][B[C]];S[A]=this.state[x][A]}i[x]=i[x]||{},xe(i[x],S)}if(this.stateChanges={},this.deletedStates={},Object.keys(i).length!==0)for(var U in e)e[U].setFeatureState(i,t)};var Lo=function(e,t){this.tileID=e,this.x=e.canonical.x,this.y=e.canonical.y,this.z=e.canonical.z,this.grid=new Da(8192,16,0),this.grid3D=new Da(8192,16,0),this.featureIndexArray=new O,this.promoteId=t};function Gf(e,t,i,l,p){return qt(e,function(m,x){var S=t instanceof ws?t.get(x):null;return S&&S.evaluate?S.evaluate(i,l,p):S})}function Kf(e){for(var t=1/0,i=1/0,l=-1/0,p=-1/0,m=0,x=e;m<x.length;m+=1){var S=x[m];t=Math.min(t,S.x),i=Math.min(i,S.y),l=Math.max(l,S.x),p=Math.max(p,S.y)}return{minX:t,minY:i,maxX:l,maxY:p}}function U_(e,t){return t-e}Lo.prototype.insert=function(e,t,i,l,p,m){var x=this.featureIndexArray.length;this.featureIndexArray.emplaceBack(i,l,p);for(var S=m?this.grid3D:this.grid,z=0;z<t.length;z++){for(var A=t[z],C=[1/0,1/0,-1/0,-1/0],B=0;B<A.length;B++){var U=A[B];C[0]=Math.min(C[0],U.x),C[1]=Math.min(C[1],U.y),C[2]=Math.max(C[2],U.x),C[3]=Math.max(C[3],U.y)}C[0]<8192&&C[1]<8192&&C[2]>=0&&C[3]>=0&&S.insert(x,C[0],C[1],C[2],C[3])}},Lo.prototype.loadVTLayers=function(){return this.vtLayers||(this.vtLayers=new ul.VectorTile(new Lc(this.rawTileData)).layers,this.sourceLayerCoder=new Gc(this.vtLayers?Object.keys(this.vtLayers).sort():["_geojsonTileLayer"])),this.vtLayers},Lo.prototype.query=function(e,t,i,l){var p=this;this.loadVTLayers();for(var m=e.params||{},x=8192/e.tileSize/e.scale,S=Ks(m.filter),z=e.queryGeometry,A=e.queryPadding*x,C=Kf(z),B=this.grid.query(C.minX-A,C.minY-A,C.maxX+A,C.maxY+A),U=Kf(e.cameraQueryGeometry),q=this.grid3D.query(U.minX-A,U.minY-A,U.maxX+A,U.maxY+A,function(ke,Ie,Pe,je){return function(Qe,mt,rt,bt,nt){for(var Qt=0,Dt=Qe;Qt<Dt.length;Qt+=1){var ct=Dt[Qt];if(mt<=ct.x&&rt<=ct.y&&bt>=ct.x&&nt>=ct.y)return!0}var rr=[new F(mt,rt),new F(mt,nt),new F(bt,nt),new F(bt,rt)];if(Qe.length>2){for(var Kt=0,yr=rr;Kt<yr.length;Kt+=1)if(Ia(Qe,yr[Kt]))return!0}for(var xt=0;xt<Qe.length-1;xt++)if(Is(Qe[xt],Qe[xt+1],rr))return!0;return!1}(e.cameraQueryGeometry,ke-A,Ie-A,Pe+A,je+A)}),Q=0,ee=q;Q<ee.length;Q+=1)B.push(ee[Q]);B.sort(U_);for(var ce,ie={},me=function(ke){var Ie=B[ke];if(Ie!==ce){ce=Ie;var Pe=p.featureIndexArray.get(Ie),je=null;p.loadMatchingFeature(ie,Pe.bucketIndex,Pe.sourceLayerIndex,Pe.featureIndex,S,m.layers,m.availableImages,t,i,l,function(Qe,mt,rt){return je||(je=ni(Qe)),mt.queryIntersectsFeature(z,Qe,rt,je,p.z,e.transform,x,e.pixelPosMatrix)})}},be=0;be<B.length;be++)me(be);return ie},Lo.prototype.loadMatchingFeature=function(e,t,i,l,p,m,x,S,z,A,C){var B=this.bucketLayerIDs[t];if(!m||function(Qe,mt){for(var rt=0;rt<Qe.length;rt++)if(mt.indexOf(Qe[rt])>=0)return!0;return!1}(m,B)){var U=this.sourceLayerCoder.decode(i),q=this.vtLayers[U].feature(l);if(p.needGeometry){var Q=mi(q,!0);if(!p.filter(new ur(this.tileID.overscaledZ),Q,this.tileID.canonical))return}else if(!p.filter(new ur(this.tileID.overscaledZ),q))return;for(var ee=this.getId(q,U),ce=0;ce<B.length;ce++){var ie=B[ce];if(!(m&&m.indexOf(ie)<0)){var me=S[ie];if(me){var be={};ee!==void 0&&A&&(be=A.getState(me.sourceLayer||"_geojsonTileLayer",ee));var ke=xe({},z[ie]);ke.paint=Gf(ke.paint,me.paint,q,be,x),ke.layout=Gf(ke.layout,me.layout,q,be,x);var Ie=!C||C(q,me,be);if(Ie){var Pe=new Kc(q,this.z,this.x,this.y,ee);Pe.layer=ke;var je=e[ie];je===void 0&&(je=e[ie]=[]),je.push({featureIndex:l,feature:Pe,intersectionZ:Ie})}}}}}},Lo.prototype.lookupSymbolFeatures=function(e,t,i,l,p,m,x,S){var z={};this.loadVTLayers();for(var A=Ks(p),C=0,B=e;C<B.length;C+=1)this.loadMatchingFeature(z,i,l,B[C],A,m,x,S,t);return z},Lo.prototype.hasLayer=function(e){for(var t=0,i=this.bucketLayerIDs;t<i.length;t+=1)for(var l=0,p=i[t];l<p.length;l+=1)if(e===p[l])return!0;return!1},Lo.prototype.getId=function(e,t){var i=e.id;return this.promoteId&&typeof(i=e.properties[typeof this.promoteId=="string"?this.promoteId:this.promoteId[t]])=="boolean"&&(i=Number(i)),i},st("FeatureIndex",Lo,{omit:["rawTileData","sourceLayerCoder"]});var Wi=function(e,t){this.tileID=e,this.uid=Oe(),this.uses=0,this.tileSize=t,this.buckets={},this.expirationTime=null,this.queryPadding=0,this.hasSymbolBuckets=!1,this.hasRTLText=!1,this.dependencies={},this.expiredRequestCount=0,this.state="loading"};Wi.prototype.registerFadeDuration=function(e){var t=e+this.timeAdded;t<ti.now()||this.fadeEndTime&&t<this.fadeEndTime||(this.fadeEndTime=t)},Wi.prototype.wasRequested=function(){return this.state==="errored"||this.state==="loaded"||this.state==="reloading"},Wi.prototype.loadVectorData=function(e,t,i){if(this.hasData()&&this.unloadVectorData(),this.state="loaded",e){for(var l in e.featureIndex&&(this.latestFeatureIndex=e.featureIndex,e.rawTileData?(this.latestRawTileData=e.rawTileData,this.latestFeatureIndex.rawTileData=e.rawTileData):this.latestRawTileData&&(this.latestFeatureIndex.rawTileData=this.latestRawTileData)),this.collisionBoxArray=e.collisionBoxArray,this.buckets=function(A,C){var B={};if(!C)return B;for(var U=function(){var ee=Q[q],ce=ee.layerIds.map(function(be){return C.getLayer(be)}).filter(Boolean);if(ce.length!==0){ee.layers=ce,ee.stateDependentLayerIds&&(ee.stateDependentLayers=ee.stateDependentLayerIds.map(function(be){return ce.filter(function(ke){return ke.id===be})[0]}));for(var ie=0,me=ce;ie<me.length;ie+=1)B[me[ie].id]=ee}},q=0,Q=A;q<Q.length;q+=1)U();return B}(e.buckets,t.style),this.hasSymbolBuckets=!1,this.buckets){var p=this.buckets[l];if(p instanceof Rr){if(this.hasSymbolBuckets=!0,!i)break;p.justReloaded=!0}}if(this.hasRTLText=!1,this.hasSymbolBuckets)for(var m in this.buckets){var x=this.buckets[m];if(x instanceof Rr&&x.hasRTLText){this.hasRTLText=!0,Qn.isLoading()||Qn.isLoaded()||tu()!=="deferred"||da();break}}for(var S in this.queryPadding=0,this.buckets){var z=this.buckets[S];this.queryPadding=Math.max(this.queryPadding,t.style.getLayer(S).queryRadius(z))}e.imageAtlas&&(this.imageAtlas=e.imageAtlas),e.glyphAtlasImage&&(this.glyphAtlasImage=e.glyphAtlasImage)}else this.collisionBoxArray=new s},Wi.prototype.unloadVectorData=function(){for(var e in this.buckets)this.buckets[e].destroy();this.buckets={},this.imageAtlasTexture&&this.imageAtlasTexture.destroy(),this.imageAtlas&&(this.imageAtlas=null),this.glyphAtlasTexture&&this.glyphAtlasTexture.destroy(),this.latestFeatureIndex=null,this.state="unloaded"},Wi.prototype.getBucket=function(e){return this.buckets[e.id]},Wi.prototype.upload=function(e){for(var t in this.buckets){var i=this.buckets[t];i.uploadPending()&&i.upload(e)}var l=e.gl;this.imageAtlas&&!this.imageAtlas.uploaded&&(this.imageAtlasTexture=new Ps(e,this.imageAtlas.image,l.RGBA),this.imageAtlas.uploaded=!0),this.glyphAtlasImage&&(this.glyphAtlasTexture=new Ps(e,this.glyphAtlasImage,l.ALPHA),this.glyphAtlasImage=null)},Wi.prototype.prepare=function(e){this.imageAtlas&&this.imageAtlas.patchUpdatedImages(e,this.imageAtlasTexture)},Wi.prototype.queryRenderedFeatures=function(e,t,i,l,p,m,x,S,z,A){return this.latestFeatureIndex&&this.latestFeatureIndex.rawTileData?this.latestFeatureIndex.query({queryGeometry:l,cameraQueryGeometry:p,scale:m,tileSize:this.tileSize,pixelPosMatrix:A,transform:S,params:x,queryPadding:this.queryPadding*z},e,t,i):{}},Wi.prototype.querySourceFeatures=function(e,t){var i=this.latestFeatureIndex;if(i&&i.rawTileData){var l=i.loadVTLayers(),p=t?t.sourceLayer:"",m=l._geojsonTileLayer||l[p];if(m)for(var x=Ks(t&&t.filter),S=this.tileID.canonical,z=S.z,A=S.x,C=S.y,B={z,x:A,y:C},U=0;U<m.length;U++){var q=m.feature(U);if(x.needGeometry){var Q=mi(q,!0);if(!x.filter(new ur(this.tileID.overscaledZ),Q,this.tileID.canonical))continue}else if(!x.filter(new ur(this.tileID.overscaledZ),q))continue;var ee=i.getId(q,p),ce=new Kc(q,z,A,C,ee);ce.tile=B,e.push(ce)}}},Wi.prototype.hasData=function(){return this.state==="loaded"||this.state==="reloading"||this.state==="expired"},Wi.prototype.patternsLoaded=function(){return this.imageAtlas&&!!Object.keys(this.imageAtlas.patternPositions).length},Wi.prototype.setExpiryData=function(e){var t=this.expirationTime;if(e.cacheControl){var i=pt(e.cacheControl);i["max-age"]&&(this.expirationTime=Date.now()+1e3*i["max-age"])}else e.expires&&(this.expirationTime=new Date(e.expires).getTime());if(this.expirationTime){var l=Date.now(),p=!1;if(this.expirationTime>l)p=!1;else if(t)if(this.expirationTime<t)p=!0;else{var m=this.expirationTime-t;m?this.expirationTime=l+Math.max(m,3e4):p=!0}else p=!0;p?(this.expiredRequestCount++,this.state="expired"):this.expiredRequestCount=0}},Wi.prototype.getExpiryTimeout=function(){if(this.expirationTime)return this.expiredRequestCount?1e3*(1<<Math.min(this.expiredRequestCount-1,31)):Math.min(this.expirationTime-new Date().getTime(),Math.pow(2,31)-1)},Wi.prototype.setFeatureState=function(e,t){if(this.latestFeatureIndex&&this.latestFeatureIndex.rawTileData&&Object.keys(e).length!==0){var i=this.latestFeatureIndex.loadVTLayers();for(var l in this.buckets)if(t.style.hasLayer(l)){var p=this.buckets[l],m=p.layers[0].sourceLayer||"_geojsonTileLayer",x=i[m],S=e[m];if(x&&S&&Object.keys(S).length!==0){p.update(S,x,this.imageAtlas&&this.imageAtlas.patternPositions||{});var z=t&&t.style&&t.style.getLayer(l);z&&(this.queryPadding=Math.max(this.queryPadding,z.queryRadius(p)))}}}},Wi.prototype.holdingForFade=function(){return this.symbolFadeHoldUntil!==void 0},Wi.prototype.symbolFadeFinished=function(){return!this.symbolFadeHoldUntil||this.symbolFadeHoldUntil<ti.now()},Wi.prototype.clearFadeHold=function(){this.symbolFadeHoldUntil=void 0},Wi.prototype.setHoldDuration=function(e){this.symbolFadeHoldUntil=ti.now()+e},Wi.prototype.setDependencies=function(e,t){for(var i={},l=0,p=t;l<p.length;l+=1)i[p[l]]=!0;this.dependencies[e]=i},Wi.prototype.hasDependency=function(e,t){for(var i=0,l=e;i<l.length;i+=1){var p=this.dependencies[l[i]];if(p){for(var m=0,x=t;m<x.length;m+=1)if(p[x[m]])return!0}}return!1};var es=D.performance,Xf=function(e){this._marks={start:[e.url,"start"].join("#"),end:[e.url,"end"].join("#"),measure:e.url.toString()},es.mark(this._marks.start)};Xf.prototype.finish=function(){es.mark(this._marks.end);var e=es.getEntriesByName(this._marks.measure);return e.length===0&&(es.measure(this._marks.measure,this._marks.start,this._marks.end),e=es.getEntriesByName(this._marks.measure),es.clearMarks(this._marks.start),es.clearMarks(this._marks.end),es.clearMeasures(this._marks.measure)),e},a.Actor=gl,a.AlphaImage=As,a.CanonicalTileID=Ms,a.CollisionBoxArray=s,a.Color=tr,a.DEMData=Do,a.DataConstantProperty=gt,a.DictionaryCoder=Gc,a.EXTENT=8192,a.ErrorEvent=se,a.EvaluationParameters=ur,a.Event=$,a.Evented=he,a.FeatureIndex=Lo,a.FillBucket=Oa,a.FillExtrusionBucket=Fa,a.ImageAtlas=yu,a.ImagePosition=Bc,a.LineBucket=Mn,a.LngLat=Yr,a.LngLatBounds=Ai,a.MercatorCoordinate=Cs,a.ONE_EM=24,a.OverscaledTileID=Pi,a.Point=F,a.Point$1=F,a.Properties=an,a.Protobuf=Lc,a.RGBAImage=Kn,a.RequestManager=Kr,a.RequestPerformance=Xf,a.ResourceType=tn,a.SegmentVector=G,a.SourceFeatureState=vl,a.StructArrayLayout1ui2=su,a.StructArrayLayout2f1f2i16=Ao,a.StructArrayLayout2i4=zo,a.StructArrayLayout3ui6=Qa,a.StructArrayLayout4i8=iu,a.SymbolBucket=Rr,a.Texture=Ps,a.Tile=Wi,a.Transitionable=nn,a.Uniform1f=Xe,a.Uniform1i=Re,a.Uniform2f=Ge,a.Uniform3f=at,a.Uniform4f=vt,a.UniformColor=kt,a.UniformMatrix4f=_r,a.UnwrappedTileID=Zf,a.ValidationError=J,a.WritingMode=sa,a.ZoomHistory=Yl,a.add=function(e,t,i){return e[0]=t[0]+i[0],e[1]=t[1]+i[1],e[2]=t[2]+i[2],e},a.addDynamicAttributes=hp,a.asyncAll=function(e,t,i){if(!e.length)return i(null,[]);var l=e.length,p=new Array(e.length),m=null;e.forEach(function(x,S){t(x,function(z,A){z&&(m=z),p[S]=A,--l==0&&i(m,p)})})},a.bezier=ae,a.bindAll=Tt,a.browser=ti,a.cacheEntryPossiblyAdded=function(e){++Vi>en&&(e.getActor().send("enforceCacheSizeLimit",zn),Vi=0)},a.clamp=fe,a.clearTileCache=function(e){var t=D.caches.delete("mapbox-tiles");e&&t.catch(e).then(function(){return e()})},a.clipLine=zf,a.clone=function(e){var t=new Sr(16);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t},a.clone$1=ht,a.clone$2=function(e){var t=new Sr(3);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t},a.collisionCircleLayout=o_,a.config=Wt,a.create=function(){var e=new Sr(16);return Sr!=Float32Array&&(e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[11]=0,e[12]=0,e[13]=0,e[14]=0),e[0]=1,e[5]=1,e[10]=1,e[15]=1,e},a.create$1=function(){var e=new Sr(9);return Sr!=Float32Array&&(e[1]=0,e[2]=0,e[3]=0,e[5]=0,e[6]=0,e[7]=0),e[0]=1,e[4]=1,e[8]=1,e},a.create$2=function(){var e=new Sr(4);return Sr!=Float32Array&&(e[1]=0,e[2]=0),e[0]=1,e[3]=1,e},a.createCommonjsModule=I,a.createExpression=Zs,a.createLayout=Ki,a.createStyleLayer=function(e){return e.type==="custom"?new F_(e):new N_[e.type](e)},a.cross=function(e,t,i){var l=t[0],p=t[1],m=t[2],x=i[0],S=i[1],z=i[2];return e[0]=p*z-m*S,e[1]=m*x-l*z,e[2]=l*S-p*x,e},a.deepEqual=function e(t,i){if(Array.isArray(t)){if(!Array.isArray(i)||t.length!==i.length)return!1;for(var l=0;l<t.length;l++)if(!e(t[l],i[l]))return!1;return!0}if(typeof t=="object"&&t!==null&&i!==null){if(typeof i!="object"||Object.keys(t).length!==Object.keys(i).length)return!1;for(var p in t)if(!e(t[p],i[p]))return!1;return!0}return t===i},a.dot=function(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]},a.dot$1=function(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]+e[3]*t[3]},a.ease=de,a.emitValidationErrors=vs,a.endsWith=Lt,a.enforceCacheSizeLimit=function(e){An(),ri&&ri.then(function(t){t.keys().then(function(i){for(var l=0;l<i.length-e;l++)t.delete(i[l])})})},a.evaluateSizeForFeature=wf,a.evaluateSizeForZoom=kf,a.evaluateVariableOffset=Cf,a.evented=eu,a.extend=xe,a.featureFilter=Ks,a.filterObject=_t,a.fromRotation=function(e,t){var i=Math.sin(t),l=Math.cos(t);return e[0]=l,e[1]=i,e[2]=0,e[3]=-i,e[4]=l,e[5]=0,e[6]=0,e[7]=0,e[8]=1,e},a.getAnchorAlignment=sp,a.getAnchorJustification=cp,a.getArrayBuffer=oi,a.getImage=N,a.getJSON=function(e,t){return bn(xe(e,{type:"json"}),t)},a.getRTLTextPluginStatus=tu,a.getReferrer=vn,a.getVideo=function(e,t){var i,l,p=D.document.createElement("video");p.muted=!0,p.onloadstart=function(){t(null,p)};for(var m=0;m<e.length;m++){var x=D.document.createElement("source");i=e[m],l=void 0,(l=D.document.createElement("a")).href=i,(l.protocol!==D.document.location.protocol||l.host!==D.document.location.host)&&(p.crossOrigin="Anonymous"),x.src=e[m],p.appendChild(x)}return{cancel:function(){}}},a.identity=$n,a.invert=function(e,t){var i=t[0],l=t[1],p=t[2],m=t[3],x=t[4],S=t[5],z=t[6],A=t[7],C=t[8],B=t[9],U=t[10],q=t[11],Q=t[12],ee=t[13],ce=t[14],ie=t[15],me=i*S-l*x,be=i*z-p*x,ke=i*A-m*x,Ie=l*z-p*S,Pe=l*A-m*S,je=p*A-m*z,Qe=C*ee-B*Q,mt=C*ce-U*Q,rt=C*ie-q*Q,bt=B*ce-U*ee,nt=B*ie-q*ee,Qt=U*ie-q*ce,Dt=me*Qt-be*nt+ke*bt+Ie*rt-Pe*mt+je*Qe;return Dt?(e[0]=(S*Qt-z*nt+A*bt)*(Dt=1/Dt),e[1]=(p*nt-l*Qt-m*bt)*Dt,e[2]=(ee*je-ce*Pe+ie*Ie)*Dt,e[3]=(U*Pe-B*je-q*Ie)*Dt,e[4]=(z*rt-x*Qt-A*mt)*Dt,e[5]=(i*Qt-p*rt+m*mt)*Dt,e[6]=(ce*ke-Q*je-ie*be)*Dt,e[7]=(C*je-U*ke+q*be)*Dt,e[8]=(x*nt-S*rt+A*Qe)*Dt,e[9]=(l*rt-i*nt-m*Qe)*Dt,e[10]=(Q*Pe-ee*ke+ie*me)*Dt,e[11]=(B*ke-C*Pe-q*me)*Dt,e[12]=(S*mt-x*bt-z*Qe)*Dt,e[13]=(i*bt-l*mt+p*Qe)*Dt,e[14]=(ee*be-Q*Ie-ce*me)*Dt,e[15]=(C*Ie-B*be+U*me)*Dt,e):null},a.isChar=$e,a.isMapboxURL=cr,a.keysDifference=function(e,t){var i=[];for(var l in e)l in t||i.push(l);return i},a.makeRequest=bn,a.mapObject=qt,a.mercatorXfromLng=Vf,a.mercatorYfromLat=jf,a.mercatorZfromAltitude=qf,a.mul=Hh,a.multiply=Cn,a.mvt=ul,a.nextPowerOfTwo=function(e){return e<=1?1:Math.pow(2,Math.ceil(Math.log(e)/Math.LN2))},a.normalize=function(e,t){var i=t[0],l=t[1],p=t[2],m=i*i+l*l+p*p;return m>0&&(m=1/Math.sqrt(m)),e[0]=t[0]*m,e[1]=t[1]*m,e[2]=t[2]*m,e},a.number=xi,a.offscreenCanvasSupported=Rn,a.ortho=function(e,t,i,l,p,m,x){var S=1/(t-i),z=1/(l-p),A=1/(m-x);return e[0]=-2*S,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=-2*z,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=2*A,e[11]=0,e[12]=(t+i)*S,e[13]=(p+l)*z,e[14]=(x+m)*A,e[15]=1,e},a.parseGlyphPBF=function(e){return new Lc(e).readFields(__,[])},a.pbf=Lc,a.performSymbolLayout=function(e,t,i,l,p,m,x){e.createArrays(),e.tilePixelRatio=8192/(512*e.overscaling),e.compareText={},e.iconsNeedLinear=!1;var S=e.layers[0].layout,z=e.layers[0]._unevaluatedLayout._values,A={};if(e.textSizeData.kind==="composite"){var C=e.textSizeData,B=C.maxZoom;A.compositeTextSizes=[z["text-size"].possiblyEvaluate(new ur(C.minZoom),x),z["text-size"].possiblyEvaluate(new ur(B),x)]}if(e.iconSizeData.kind==="composite"){var U=e.iconSizeData,q=U.maxZoom;A.compositeIconSizes=[z["icon-size"].possiblyEvaluate(new ur(U.minZoom),x),z["icon-size"].possiblyEvaluate(new ur(q),x)]}A.layoutTextSize=z["text-size"].possiblyEvaluate(new ur(e.zoom+1),x),A.layoutIconSize=z["icon-size"].possiblyEvaluate(new ur(e.zoom+1),x),A.textMaxSize=z["text-size"].possiblyEvaluate(new ur(18));for(var Q=24*S.get("text-line-height"),ee=S.get("text-rotation-alignment")==="map"&&S.get("symbol-placement")!=="point",ce=S.get("text-keep-upright"),ie=S.get("text-size"),me=function(){var Ie=ke[be],Pe=S.get("text-font").evaluate(Ie,{},x).join(","),je=ie.evaluate(Ie,{},x),Qe=A.layoutTextSize.evaluate(Ie,{},x),mt=A.layoutIconSize.evaluate(Ie,{},x),rt={horizontal:{},vertical:void 0},bt=Ie.text,nt=[0,0];if(bt){var Qt=bt.toString(),Dt=24*S.get("text-letter-spacing").evaluate(Ie,{},x),ct=function(hr){for(var Or=0,Cr=hr;Or<Cr.length;Or+=1)if(gr=Cr[Or].charCodeAt(0),$e.Arabic(gr)||$e["Arabic Supplement"](gr)||$e["Arabic Extended-A"](gr)||$e["Arabic Presentation Forms-A"](gr)||$e["Arabic Presentation Forms-B"](gr))return!1;var gr;return!0}(Qt)?Dt:0,rr=S.get("text-anchor").evaluate(Ie,{},x),Kt=S.get("text-variable-anchor");if(!Kt){var yr=S.get("text-radial-offset").evaluate(Ie,{},x);nt=yr?Cf(rr,[24*yr,up]):S.get("text-offset").evaluate(Ie,{},x).map(function(hr){return 24*hr})}var xt=ee?"center":S.get("text-justify").evaluate(Ie,{},x),wr=S.get("symbol-placement"),Qr=wr==="point"?24*S.get("text-max-width").evaluate(Ie,{},x):0,ci=function(){e.allowVerticalPlacement&&Ql(Qt)&&(rt.vertical=Oc(bt,t,i,p,Pe,Qr,Q,rr,"left",ct,nt,sa.vertical,!0,wr,Qe,je))};if(!ee&&Kt){for(var ai=xt==="auto"?Kt.map(function(hr){return cp(hr)}):[xt],$r=!1,hi=0;hi<ai.length;hi++){var Bi=ai[hi];if(!rt.horizontal[Bi])if($r)rt.horizontal[Bi]=rt.horizontal[0];else{var Oi=Oc(bt,t,i,p,Pe,Qr,Q,"center",Bi,ct,nt,sa.horizontal,!1,wr,Qe,je);Oi&&(rt.horizontal[Bi]=Oi,$r=Oi.positionedLines.length===1)}}ci()}else{xt==="auto"&&(xt=cp(rr));var Tn=Oc(bt,t,i,p,Pe,Qr,Q,rr,xt,ct,nt,sa.horizontal,!1,wr,Qe,je);Tn&&(rt.horizontal[xt]=Tn),ci(),Ql(Qt)&&ee&&ce&&(rt.vertical=Oc(bt,t,i,p,Pe,Qr,Q,rr,xt,ct,nt,sa.vertical,!1,wr,Qe,je))}}var Hi=void 0,In=!1;if(Ie.icon&&Ie.icon.name){var yi=l[Ie.icon.name];yi&&(Hi=function(hr,Or,Cr){var gr=sp(Cr),Dn=Or[0]-hr.displaySize[0]*gr.horizontalAlign,fn=Or[1]-hr.displaySize[1]*gr.verticalAlign;return{image:hr,top:fn,bottom:fn+hr.displaySize[1],left:Dn,right:Dn+hr.displaySize[0]}}(p[Ie.icon.name],S.get("icon-offset").evaluate(Ie,{},x),S.get("icon-anchor").evaluate(Ie,{},x)),In=yi.sdf,e.sdfIcons===void 0?e.sdfIcons=yi.sdf:e.sdfIcons!==yi.sdf&&yt("Style sheet warning: Cannot mix SDF and non-SDF icons in one buffer"),(yi.pixelRatio!==e.pixelRatio||S.get("icon-rotate").constantOr(1)!==0)&&(e.iconsNeedLinear=!0))}var Ji=Df(rt.horizontal)||rt.vertical;e.iconsInText=!!Ji&&Ji.iconsInText,(Ji||Hi)&&function(hr,Or,Cr,gr,Dn,fn,Hr,ki,dn,kr,no){var la=fn.textMaxSize.evaluate(Or,{});la===void 0&&(la=Hr);var ao,_i=hr.layers[0].layout,oo=_i.get("icon-offset").evaluate(Or,{},no),Aa=Df(Cr.horizontal),bl=Hr/24,Ds=hr.tilePixelRatio*bl,xl=hr.tilePixelRatio*la/24,Ro=hr.tilePixelRatio*ki,wl=hr.tilePixelRatio*_i.get("symbol-spacing"),Xc=_i.get("text-padding")*hr.tilePixelRatio,kl=_i.get("icon-padding")*hr.tilePixelRatio,vu=_i.get("text-max-angle")/180*Math.PI,Wc=_i.get("text-rotation-alignment")==="map"&&_i.get("symbol-placement")!=="point",Hc=_i.get("icon-rotation-alignment")==="map"&&_i.get("symbol-placement")!=="point",Bo=_i.get("symbol-placement"),bu=wl/2,Sl=_i.get("icon-text-fit");gr&&Sl!=="none"&&(hr.allowVerticalPlacement&&Cr.vertical&&(ao=xf(gr,Cr.vertical,Sl,_i.get("icon-text-fit-padding"),oo,bl)),Aa&&(gr=xf(gr,Aa,Sl,_i.get("icon-text-fit-padding"),oo,bl)));var ts=function(V_,zu){zu.x<0||zu.x>=8192||zu.y<0||zu.y>=8192||function(gi,Na,j_,rs,vp,Jf,th,so,rh,Au,ih,nh,bp,Yf,Pu,Qf,$f,ed,td,rd,ua,ah,id,lo,q_){var nd,Rs,Al,Pl,Cl,Ml=gi.addToLineVertexArray(Na,j_),ad=0,od=0,sd=0,ld=0,xp=-1,wp=-1,Oo={},ud=Y(""),kp=0,Sp=0;if(so._unevaluatedLayout.getValue("text-radial-offset")===void 0?(kp=(nd=so.layout.get("text-offset").evaluate(ua,{},lo).map(function(Mu){return 24*Mu}))[0],Sp=nd[1]):(kp=24*so.layout.get("text-radial-offset").evaluate(ua,{},lo),Sp=up),gi.allowVerticalPlacement&&rs.vertical){var cd=so.layout.get("text-rotate").evaluate(ua,{},lo)+90;Pl=new jc(rh,Na,Au,ih,nh,rs.vertical,bp,Yf,Pu,cd),th&&(Cl=new jc(rh,Na,Au,ih,nh,th,$f,ed,Pu,cd))}if(vp){var Ep=so.layout.get("icon-rotate").evaluate(ua,{}),hd=so.layout.get("icon-text-fit")!=="none",pd=Af(vp,Ep,id,hd),Tp=th?Af(th,Ep,id,hd):void 0;Al=new jc(rh,Na,Au,ih,nh,vp,$f,ed,!1,Ep),ad=4*pd.length;var fd=gi.iconSizeData,Cu=null;fd.kind==="source"?(Cu=[128*so.layout.get("icon-size").evaluate(ua,{})])[0]>32640&&yt(gi.layerIds[0]+': Value for "icon-size" is >= 255. Reduce your "icon-size".'):fd.kind==="composite"&&((Cu=[128*ah.compositeIconSizes[0].evaluate(ua,{},lo),128*ah.compositeIconSizes[1].evaluate(ua,{},lo)])[0]>32640||Cu[1]>32640)&&yt(gi.layerIds[0]+': Value for "icon-size" is >= 255. Reduce your "icon-size".'),gi.addSymbols(gi.icon,pd,Cu,rd,td,ua,!1,Na,Ml.lineStartIndex,Ml.lineLength,-1,lo),xp=gi.icon.placedSymbolArray.length-1,Tp&&(od=4*Tp.length,gi.addSymbols(gi.icon,Tp,Cu,rd,td,ua,sa.vertical,Na,Ml.lineStartIndex,Ml.lineLength,-1,lo),wp=gi.icon.placedSymbolArray.length-1)}for(var dd in rs.horizontal){var oh=rs.horizontal[dd];if(!Rs){ud=Y(oh.text);var Z_=so.layout.get("text-rotate").evaluate(ua,{},lo);Rs=new jc(rh,Na,Au,ih,nh,oh,bp,Yf,Pu,Z_)}var md=oh.positionedLines.length===1;if(sd+=Mf(gi,Na,oh,Jf,so,Pu,ua,Qf,Ml,rs.vertical?sa.horizontal:sa.horizontalOnly,md?Object.keys(rs.horizontal):[dd],Oo,xp,ah,lo),md)break}rs.vertical&&(ld+=Mf(gi,Na,rs.vertical,Jf,so,Pu,ua,Qf,Ml,sa.vertical,["vertical"],Oo,wp,ah,lo));var G_=Rs?Rs.boxStartIndex:gi.collisionBoxArray.length,K_=Rs?Rs.boxEndIndex:gi.collisionBoxArray.length,X_=Pl?Pl.boxStartIndex:gi.collisionBoxArray.length,W_=Pl?Pl.boxEndIndex:gi.collisionBoxArray.length,H_=Al?Al.boxStartIndex:gi.collisionBoxArray.length,J_=Al?Al.boxEndIndex:gi.collisionBoxArray.length,Y_=Cl?Cl.boxStartIndex:gi.collisionBoxArray.length,Q_=Cl?Cl.boxEndIndex:gi.collisionBoxArray.length,uo=-1,sh=function(Mu,_d){return Mu&&Mu.circleDiameter?Math.max(Mu.circleDiameter,_d):_d};uo=sh(Rs,uo),uo=sh(Pl,uo),uo=sh(Al,uo);var yd=(uo=sh(Cl,uo))>-1?1:0;yd&&(uo*=q_/24),gi.glyphOffsetArray.length>=Rr.MAX_GLYPHS&&yt("Too many glyphs being rendered in a tile. See https://github.com/mapbox/mapbox-gl-js/issues/2907"),ua.sortKey!==void 0&&gi.addToSortKeyRanges(gi.symbolInstances.length,ua.sortKey),gi.symbolInstances.emplaceBack(Na.x,Na.y,Oo.right>=0?Oo.right:-1,Oo.center>=0?Oo.center:-1,Oo.left>=0?Oo.left:-1,Oo.vertical||-1,xp,wp,ud,G_,K_,X_,W_,H_,J_,Y_,Q_,Au,sd,ld,ad,od,yd,0,bp,kp,Sp,uo)}(hr,zu,V_,Cr,gr,Dn,ao,hr.layers[0],hr.collisionBoxArray,Or.index,Or.sourceLayerIndex,hr.index,Ds,Xc,Wc,dn,Ro,kl,Hc,oo,Or,fn,kr,no,Hr)};if(Bo==="line")for(var El=0,Jc=zf(Or.geometry,0,0,8192,8192);El<Jc.length;El+=1)for(var Yc=Jc[El],xu=0,wu=S_(Yc,wl,vu,Cr.vertical||Aa,gr,24,xl,hr.overscaling,8192);xu<wu.length;xu+=1){var Qc=wu[xu];Aa&&z_(hr,Aa.text,bu,Qc)||ts(Yc,Qc)}else if(Bo==="line-center")for(var ku=0,Su=Or.geometry;ku<Su.length;ku+=1){var Eu=Su[ku];if(Eu.length>1){var $c=k_(Eu,vu,Cr.vertical||Aa,gr,24,xl);$c&&ts(Eu,$c)}}else if(Or.type==="Polygon")for(var Tl=0,eh=rp(Or.geometry,0);Tl<eh.length;Tl+=1){var Il=eh[Tl],Tu=T_(Il,16);ts(Il[0],new fl(Tu.x,Tu.y,0))}else if(Or.type==="LineString")for(var Ls=0,Iu=Or.geometry;Ls<Iu.length;Ls+=1){var zl=Iu[Ls];ts(zl,new fl(zl[0].x,zl[0].y,0))}else if(Or.type==="Point")for(var yp=0,Wf=Or.geometry;yp<Wf.length;yp+=1)for(var _p=0,Hf=Wf[yp];_p<Hf.length;_p+=1){var gp=Hf[_p];ts([gp],new fl(gp.x,gp.y,0))}}(e,Ie,rt,Hi,l,A,Qe,mt,nt,In,x)},be=0,ke=e.features;be<ke.length;be+=1)me();m&&e.generateCollisionDebugBuffers()},a.perspective=function(e,t,i,l,p){var m,x=1/Math.tan(t/2);return e[0]=x/i,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=x,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[11]=-1,e[12]=0,e[13]=0,e[15]=0,p!=null&&p!==1/0?(e[10]=(p+l)*(m=1/(l-p)),e[14]=2*p*l*m):(e[10]=-1,e[14]=-2*l),e},a.pick=function(e,t){for(var i={},l=0;l<t.length;l++){var p=t[l];p in e&&(i[p]=e[p])}return i},a.plugin=Qn,a.polygonIntersectsPolygon=to,a.postMapLoadEvent=Ni,a.postTurnstileEvent=$i,a.potpack=_f,a.refProperties=["type","source","source-layer","minzoom","maxzoom","filter","layout"],a.register=st,a.registerForPluginStateChange=function(e){return e({pluginStatus:qn,pluginURL:La}),eu.on("pluginStateChange",e),e},a.renderColorRamp=Yp,a.rotate=function(e,t,i){var l=t[0],p=t[1],m=t[2],x=t[3],S=Math.sin(i),z=Math.cos(i);return e[0]=l*z+m*S,e[1]=p*z+x*S,e[2]=l*-S+m*z,e[3]=p*-S+x*z,e},a.rotateX=function(e,t,i){var l=Math.sin(i),p=Math.cos(i),m=t[4],x=t[5],S=t[6],z=t[7],A=t[8],C=t[9],B=t[10],U=t[11];return t!==e&&(e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e[4]=m*p+A*l,e[5]=x*p+C*l,e[6]=S*p+B*l,e[7]=z*p+U*l,e[8]=A*p-m*l,e[9]=C*p-x*l,e[10]=B*p-S*l,e[11]=U*p-z*l,e},a.rotateZ=function(e,t,i){var l=Math.sin(i),p=Math.cos(i),m=t[0],x=t[1],S=t[2],z=t[3],A=t[4],C=t[5],B=t[6],U=t[7];return t!==e&&(e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e[0]=m*p+A*l,e[1]=x*p+C*l,e[2]=S*p+B*l,e[3]=z*p+U*l,e[4]=A*p-m*l,e[5]=C*p-x*l,e[6]=B*p-S*l,e[7]=U*p-z*l,e},a.scale=function(e,t,i){var l=i[0],p=i[1],m=i[2];return e[0]=t[0]*l,e[1]=t[1]*l,e[2]=t[2]*l,e[3]=t[3]*l,e[4]=t[4]*p,e[5]=t[5]*p,e[6]=t[6]*p,e[7]=t[7]*p,e[8]=t[8]*m,e[9]=t[9]*m,e[10]=t[10]*m,e[11]=t[11]*m,e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15],e},a.scale$1=function(e,t,i){return e[0]=t[0]*i,e[1]=t[1]*i,e[2]=t[2]*i,e[3]=t[3]*i,e},a.scale$2=function(e,t,i){return e[0]=t[0]*i,e[1]=t[1]*i,e[2]=t[2]*i,e},a.setCacheLimits=function(e,t){zn=e,en=t},a.setRTLTextPlugin=function(e,t,i){if(i===void 0&&(i=!1),qn==="deferred"||qn==="loading"||qn==="loaded")throw new Error("setRTLTextPlugin cannot be called multiple times.");La=ti.resolveURL(e),qn="deferred",$s=t,xs(),i||da()},a.sphericalToCartesian=function(e){var t=e[0],i=e[1],l=e[2];return i+=90,i*=Math.PI/180,l*=Math.PI/180,{x:t*Math.cos(i)*Math.sin(l),y:t*Math.sin(i)*Math.sin(l),z:t*Math.cos(l)}},a.sqrLen=function(e){var t=e[0],i=e[1];return t*t+i*i},a.styleSpec=j,a.sub=function(e,t,i){return e[0]=t[0]-i[0],e[1]=t[1]-i[1],e[2]=t[2]-i[2],e},a.symbolSize=w_,a.transformMat3=function(e,t,i){var l=t[0],p=t[1],m=t[2];return e[0]=l*i[0]+p*i[3]+m*i[6],e[1]=l*i[1]+p*i[4]+m*i[7],e[2]=l*i[2]+p*i[5]+m*i[8],e},a.transformMat4=al,a.translate=function(e,t,i){var l,p,m,x,S,z,A,C,B,U,q,Q,ee=i[0],ce=i[1],ie=i[2];return t===e?(e[12]=t[0]*ee+t[4]*ce+t[8]*ie+t[12],e[13]=t[1]*ee+t[5]*ce+t[9]*ie+t[13],e[14]=t[2]*ee+t[6]*ce+t[10]*ie+t[14],e[15]=t[3]*ee+t[7]*ce+t[11]*ie+t[15]):(p=t[1],m=t[2],x=t[3],S=t[4],z=t[5],A=t[6],C=t[7],B=t[8],U=t[9],q=t[10],Q=t[11],e[0]=l=t[0],e[1]=p,e[2]=m,e[3]=x,e[4]=S,e[5]=z,e[6]=A,e[7]=C,e[8]=B,e[9]=U,e[10]=q,e[11]=Q,e[12]=l*ee+S*ce+B*ie+t[12],e[13]=p*ee+z*ce+U*ie+t[13],e[14]=m*ee+A*ce+q*ie+t[14],e[15]=x*ee+C*ce+Q*ie+t[15]),e},a.triggerPluginCompletionEvent=Ic,a.uniqueId=Oe,a.validateCustomStyleLayer=function(e){var t=[],i=e.id;return i===void 0&&t.push({message:"layers."+i+': missing required property "id"'}),e.render===void 0&&t.push({message:"layers."+i+': missing required method "render"'}),e.renderingMode&&e.renderingMode!=="2d"&&e.renderingMode!=="3d"&&t.push({message:"layers."+i+': property "renderingMode" must be either "2d" or "3d"'}),t},a.validateLight=Xh,a.validateStyle=_s,a.values=function(e){var t=[];for(var i in e)t.push(e[i]);return t},a.vectorTile=ul,a.version="1.13.2",a.warnOnce=yt,a.webpSupported=Gr,a.window=D,a.wrap=we}),v(["./shared"],function(a){function I(L){var N=typeof L;if(N==="number"||N==="boolean"||N==="string"||L==null)return JSON.stringify(L);if(Array.isArray(L)){for(var V="[",W=0,$=L;W<$.length;W+=1)V+=I($[W])+",";return V+"]"}for(var se=Object.keys(L).sort(),he="{",j=0;j<se.length;j++)he+=JSON.stringify(se[j])+":"+I(L[se[j]])+",";return he+"}"}function T(L){for(var N="",V=0,W=a.refProperties;V<W.length;V+=1)N+="/"+I(L[W[V]]);return N}var M=function(L){this.keyCache={},L&&this.replace(L)};M.prototype.replace=function(L){this._layerConfigs={},this._layers={},this.update(L,[])},M.prototype.update=function(L,N){for(var V=this,W=0,$=L;W<$.length;W+=1){var se=$[W];this._layerConfigs[se.id]=se;var he=this._layers[se.id]=a.createStyleLayer(se);he._featureFilter=a.featureFilter(he.filter),this.keyCache[se.id]&&delete this.keyCache[se.id]}for(var j=0,J=N;j<J.length;j+=1){var _e=J[j];delete this.keyCache[_e],delete this._layerConfigs[_e],delete this._layers[_e]}this.familiesBySource={};for(var Ce=0,Me=function(Fe,qe){for(var Mt={},Ze=0;Ze<Fe.length;Ze++){var Vt=qe&&qe[Fe[Ze].id]||T(Fe[Ze]);qe&&(qe[Fe[Ze].id]=Vt);var lr=Mt[Vt];lr||(lr=Mt[Vt]=[]),lr.push(Fe[Ze])}var Pt=[];for(var er in Mt)Pt.push(Mt[er]);return Pt}(a.values(this._layerConfigs),this.keyCache);Ce<Me.length;Ce+=1){var K=Me[Ce].map(function(Fe){return V._layers[Fe.id]}),ve=K[0];if(ve.visibility!=="none"){var et=ve.source||"",Ye=this.familiesBySource[et];Ye||(Ye=this.familiesBySource[et]={});var Se=ve.sourceLayer||"_geojsonTileLayer",We=Ye[Se];We||(We=Ye[Se]=[]),We.push(K)}}};var F=function(L){var N={},V=[];for(var W in L){var $=L[W],se=N[W]={};for(var he in $){var j=$[+he];if(j&&j.bitmap.width!==0&&j.bitmap.height!==0){var J={x:0,y:0,w:j.bitmap.width+2,h:j.bitmap.height+2};V.push(J),se[he]={rect:J,metrics:j.metrics}}}}var _e=a.potpack(V),Ce=new a.AlphaImage({width:_e.w||1,height:_e.h||1});for(var Me in L){var K=L[Me];for(var ve in K){var et=K[+ve];if(et&&et.bitmap.width!==0&&et.bitmap.height!==0){var Ye=N[Me][ve].rect;a.AlphaImage.copy(et.bitmap,Ce,{x:0,y:0},{x:Ye.x+1,y:Ye.y+1},et.bitmap)}}}this.image=Ce,this.positions=N};a.register("GlyphAtlas",F);var R=function(L){this.tileID=new a.OverscaledTileID(L.tileID.overscaledZ,L.tileID.wrap,L.tileID.canonical.z,L.tileID.canonical.x,L.tileID.canonical.y),this.uid=L.uid,this.zoom=L.zoom,this.pixelRatio=L.pixelRatio,this.tileSize=L.tileSize,this.source=L.source,this.overscaling=this.tileID.overscaleFactor(),this.showCollisionBoxes=L.showCollisionBoxes,this.collectResourceTiming=!!L.collectResourceTiming,this.returnDependencies=!!L.returnDependencies,this.promoteId=L.promoteId};function D(L,N,V){for(var W=new a.EvaluationParameters(N),$=0,se=L;$<se.length;$+=1)se[$].recalculate(W,V)}function H(L,N){var V=a.getArrayBuffer(L.request,function(W,$,se,he){W?N(W):$&&N(null,{vectorTile:new a.vectorTile.VectorTile(new a.pbf($)),rawData:$,cacheControl:se,expires:he})});return function(){V.cancel(),N()}}R.prototype.parse=function(L,N,V,W,$){var se=this;this.status="parsing",this.data=L,this.collisionBoxArray=new a.CollisionBoxArray;var he=new a.DictionaryCoder(Object.keys(L.layers).sort()),j=new a.FeatureIndex(this.tileID,this.promoteId);j.bucketLayerIDs=[];var J,_e,Ce,Me,K={},ve={featureIndex:j,iconDependencies:{},patternDependencies:{},glyphDependencies:{},availableImages:V},et=N.familiesBySource[this.source];for(var Ye in et){var Se=L.layers[Ye];if(Se){Se.version===1&&a.warnOnce('Vector tile source "'+this.source+'" layer "'+Ye+'" does not use vector tile spec v2 and therefore may have some rendering errors.');for(var We=he.encode(Ye),Fe=[],qe=0;qe<Se.length;qe++){var Mt=Se.feature(qe),Ze=j.getId(Mt,Ye);Fe.push({feature:Mt,id:Ze,index:qe,sourceLayerIndex:We})}for(var Vt=0,lr=et[Ye];Vt<lr.length;Vt+=1){var Pt=lr[Vt],er=Pt[0];er.minzoom&&this.zoom<Math.floor(er.minzoom)||er.maxzoom&&this.zoom>=er.maxzoom||er.visibility!=="none"&&(D(Pt,this.zoom,V),(K[er.id]=er.createBucket({index:j.bucketLayerIDs.length,layers:Pt,zoom:this.zoom,pixelRatio:this.pixelRatio,overscaling:this.overscaling,collisionBoxArray:this.collisionBoxArray,sourceLayerIndex:We,sourceID:this.source})).populate(Fe,ve,this.tileID.canonical),j.bucketLayerIDs.push(Pt.map(function(fr){return fr.id})))}}}var Jt=a.mapObject(ve.glyphDependencies,function(fr){return Object.keys(fr).map(Number)});Object.keys(Jt).length?W.send("getGlyphs",{uid:this.uid,stacks:Jt},function(fr,Gt){J||(J=fr,_e=Gt,vr.call(se))}):_e={};var ii=Object.keys(ve.iconDependencies);ii.length?W.send("getImages",{icons:ii,source:this.source,tileID:this.tileID,type:"icons"},function(fr,Gt){J||(J=fr,Ce=Gt,vr.call(se))}):Ce={};var $t=Object.keys(ve.patternDependencies);function vr(){if(J)return $(J);if(_e&&Ce&&Me){var fr=new F(_e),Gt=new a.ImageAtlas(Ce,Me);for(var tr in K){var si=K[tr];si instanceof a.SymbolBucket?(D(si.layers,this.zoom,V),a.performSymbolLayout(si,_e,fr.positions,Ce,Gt.iconPositions,this.showCollisionBoxes,this.tileID.canonical)):si.hasPattern&&(si instanceof a.LineBucket||si instanceof a.FillBucket||si instanceof a.FillExtrusionBucket)&&(D(si.layers,this.zoom,V),si.addFeatures(ve,this.tileID.canonical,Gt.patternPositions))}this.status="done",$(null,{buckets:a.values(K).filter(function(Bn){return!Bn.isEmpty()}),featureIndex:j,collisionBoxArray:this.collisionBoxArray,glyphAtlasImage:fr.image,imageAtlas:Gt,glyphMap:this.returnDependencies?_e:null,iconMap:this.returnDependencies?Ce:null,glyphPositions:this.returnDependencies?fr.positions:null})}}$t.length?W.send("getImages",{icons:$t,source:this.source,tileID:this.tileID,type:"patterns"},function(fr,Gt){J||(J=fr,Me=Gt,vr.call(se))}):Me={},vr.call(this)};var ae=function(L,N,V,W){this.actor=L,this.layerIndex=N,this.availableImages=V,this.loadVectorData=W||H,this.loading={},this.loaded={}};ae.prototype.loadTile=function(L,N){var V=this,W=L.uid;this.loading||(this.loading={});var $=!!(L&&L.request&&L.request.collectResourceTiming)&&new a.RequestPerformance(L.request),se=this.loading[W]=new R(L);se.abort=this.loadVectorData(L,function(he,j){if(delete V.loading[W],he||!j)return se.status="done",V.loaded[W]=se,N(he);var J=j.rawData,_e={};j.expires&&(_e.expires=j.expires),j.cacheControl&&(_e.cacheControl=j.cacheControl);var Ce={};if($){var Me=$.finish();Me&&(Ce.resourceTiming=JSON.parse(JSON.stringify(Me)))}se.vectorTile=j.vectorTile,se.parse(j.vectorTile,V.layerIndex,V.availableImages,V.actor,function(K,ve){if(K||!ve)return N(K);N(null,a.extend({rawTileData:J.slice(0)},ve,_e,Ce))}),V.loaded=V.loaded||{},V.loaded[W]=se})},ae.prototype.reloadTile=function(L,N){var V=this,W=this.loaded,$=L.uid,se=this;if(W&&W[$]){var he=W[$];he.showCollisionBoxes=L.showCollisionBoxes;var j=function(J,_e){var Ce=he.reloadCallback;Ce&&(delete he.reloadCallback,he.parse(he.vectorTile,se.layerIndex,V.availableImages,se.actor,Ce)),N(J,_e)};he.status==="parsing"?he.reloadCallback=j:he.status==="done"&&(he.vectorTile?he.parse(he.vectorTile,this.layerIndex,this.availableImages,this.actor,j):j())}},ae.prototype.abortTile=function(L,N){var V=this.loading,W=L.uid;V&&V[W]&&V[W].abort&&(V[W].abort(),delete V[W]),N()},ae.prototype.removeTile=function(L,N){var V=this.loaded,W=L.uid;V&&V[W]&&delete V[W],N()};var de=a.window.ImageBitmap,fe=function(){this.loaded={}};function we(L,N){if(L.length!==0){xe(L[0],N);for(var V=1;V<L.length;V++)xe(L[V],!N)}}function xe(L,N){for(var V=0,W=0,$=L.length,se=$-1;W<$;se=W++)V+=(L[W][0]-L[se][0])*(L[se][1]+L[W][1]);V>=0!=!!N&&L.reverse()}fe.prototype.loadTile=function(L,N){var V=L.uid,W=L.encoding,$=L.rawImageData,se=de&&$ instanceof de?this.getImageData($):$,he=new a.DEMData(V,se,W);this.loaded=this.loaded||{},this.loaded[V]=he,N(null,he)},fe.prototype.getImageData=function(L){this.offscreenCanvas&&this.offscreenCanvasContext||(this.offscreenCanvas=new OffscreenCanvas(L.width,L.height),this.offscreenCanvasContext=this.offscreenCanvas.getContext("2d")),this.offscreenCanvas.width=L.width,this.offscreenCanvas.height=L.height,this.offscreenCanvasContext.drawImage(L,0,0,L.width,L.height);var N=this.offscreenCanvasContext.getImageData(-1,-1,L.width+2,L.height+2);return this.offscreenCanvasContext.clearRect(0,0,this.offscreenCanvas.width,this.offscreenCanvas.height),new a.RGBAImage({width:N.width,height:N.height},N.data)},fe.prototype.removeTile=function(L){var N=this.loaded,V=L.uid;N&&N[V]&&delete N[V]};var Ve=a.vectorTile.VectorTileFeature.prototype.toGeoJSON,Oe=function(L){this._feature=L,this.extent=a.EXTENT,this.type=L.type,this.properties=L.tags,"id"in L&&!isNaN(L.id)&&(this.id=parseInt(L.id,10))};Oe.prototype.loadGeometry=function(){if(this._feature.type===1){for(var L=[],N=0,V=this._feature.geometry;N<V.length;N+=1){var W=V[N];L.push([new a.Point$1(W[0],W[1])])}return L}for(var $=[],se=0,he=this._feature.geometry;se<he.length;se+=1){for(var j=[],J=0,_e=he[se];J<_e.length;J+=1){var Ce=_e[J];j.push(new a.Point$1(Ce[0],Ce[1]))}$.push(j)}return $},Oe.prototype.toGeoJSON=function(L,N,V){return Ve.call(this,L,N,V)};var De=function(L){this.layers={_geojsonTileLayer:this},this.name="_geojsonTileLayer",this.extent=a.EXTENT,this.length=L.length,this._features=L};De.prototype.feature=function(L){return new Oe(this._features[L])};var He=a.vectorTile.VectorTileFeature,Tt=Lt;function Lt(L,N){this.options=N||{},this.features=L,this.length=L.length}function qt(L,N){this.id=typeof L.id=="number"?L.id:void 0,this.type=L.type,this.rawGeometry=L.type===1?[L.geometry]:L.geometry,this.properties=L.tags,this.extent=N||4096}Lt.prototype.feature=function(L){return new qt(this.features[L],this.options.extent)},qt.prototype.loadGeometry=function(){var L=this.rawGeometry;this.geometry=[];for(var N=0;N<L.length;N++){for(var V=L[N],W=[],$=0;$<V.length;$++)W.push(new a.Point$1(V[$][0],V[$][1]));this.geometry.push(W)}return this.geometry},qt.prototype.bbox=function(){this.geometry||this.loadGeometry();for(var L=this.geometry,N=1/0,V=-1/0,W=1/0,$=-1/0,se=0;se<L.length;se++)for(var he=L[se],j=0;j<he.length;j++){var J=he[j];N=Math.min(N,J.x),V=Math.max(V,J.x),W=Math.min(W,J.y),$=Math.max($,J.y)}return[N,W,V,$]},qt.prototype.toGeoJSON=He.prototype.toGeoJSON;var _t=Ft,ht=Tt;function Ft(L){var N=new a.pbf;return function(V,W){for(var $ in V.layers)W.writeMessage(3,yt,V.layers[$])}(L,N),N.finish()}function yt(L,N){var V;N.writeVarintField(15,L.version||1),N.writeStringField(1,L.name||""),N.writeVarintField(5,L.extent||4096);var W={keys:[],values:[],keycache:{},valuecache:{}};for(V=0;V<L.length;V++)W.feature=L.feature(V),N.writeMessage(2,It,W);var $=W.keys;for(V=0;V<$.length;V++)N.writeStringField(3,$[V]);var se=W.values;for(V=0;V<se.length;V++)N.writeMessage(4,Ut,se[V])}function It(L,N){var V=L.feature;V.id!==void 0&&N.writeVarintField(1,V.id),N.writeMessage(2,tt,L),N.writeVarintField(3,V.type),N.writeMessage(4,zt,V)}function tt(L,N){var V=L.feature,W=L.keys,$=L.values,se=L.keycache,he=L.valuecache;for(var j in V.properties){var J=se[j];J===void 0&&(W.push(j),se[j]=J=W.length-1),N.writeVarint(J);var _e=V.properties[j],Ce=typeof _e;Ce!=="string"&&Ce!=="boolean"&&Ce!=="number"&&(_e=JSON.stringify(_e));var Me=Ce+":"+_e,K=he[Me];K===void 0&&($.push(_e),he[Me]=K=$.length-1),N.writeVarint(K)}}function Zt(L,N){return(N<<3)+(7&L)}function pt(L){return L<<1^L>>31}function zt(L,N){for(var V=L.loadGeometry(),W=L.type,$=0,se=0,he=V.length,j=0;j<he;j++){var J=V[j],_e=1;W===1&&(_e=J.length),N.writeVarint(Zt(1,_e));for(var Ce=W===3?J.length-1:J.length,Me=0;Me<Ce;Me++){Me===1&&W!==1&&N.writeVarint(Zt(2,Ce-1));var K=J[Me].x-$,ve=J[Me].y-se;N.writeVarint(pt(K)),N.writeVarint(pt(ve)),$+=K,se+=ve}W===3&&N.writeVarint(Zt(7,1))}}function Ut(L,N){var V=typeof L;V==="string"?N.writeStringField(1,L):V==="boolean"?N.writeBooleanField(7,L):V==="number"&&(L%1!=0?N.writeDoubleField(3,L):L<0?N.writeSVarintField(6,L):N.writeVarintField(5,L))}function ei(L,N,V,W){Je(L,V,W),Je(N,2*V,2*W),Je(N,2*V+1,2*W+1)}function Je(L,N,V){var W=L[N];L[N]=L[V],L[V]=W}function At(L,N,V,W){var $=L-V,se=N-W;return $*$+se*se}_t.fromVectorTileJs=Ft,_t.fromGeojsonVt=function(L,N){N=N||{};var V={};for(var W in L)V[W]=new Tt(L[W].features,N),V[W].name=W,V[W].version=N.version,V[W].extent=N.extent;return Ft({layers:V})},_t.GeoJSONWrapper=ht;var pr=function(L){return L[0]},Fr=function(L){return L[1]},Mr=function(L,N,V,W,$){N===void 0&&(N=pr),V===void 0&&(V=Fr),W===void 0&&(W=64),$===void 0&&($=Float64Array),this.nodeSize=W,this.points=L;for(var se=L.length<65536?Uint16Array:Uint32Array,he=this.ids=new se(L.length),j=this.coords=new $(2*L.length),J=0;J<L.length;J++)he[J]=J,j[2*J]=N(L[J]),j[2*J+1]=V(L[J]);(function _e(Ce,Me,K,ve,et,Ye){if(!(et-ve<=K)){var Se=ve+et>>1;(function We(Fe,qe,Mt,Ze,Vt,lr){for(;Vt>Ze;){if(Vt-Ze>600){var Pt=Vt-Ze+1,er=Mt-Ze+1,Jt=Math.log(Pt),ii=.5*Math.exp(2*Jt/3),$t=.5*Math.sqrt(Jt*ii*(Pt-ii)/Pt)*(er-Pt/2<0?-1:1);We(Fe,qe,Mt,Math.max(Ze,Math.floor(Mt-er*ii/Pt+$t)),Math.min(Vt,Math.floor(Mt+(Pt-er)*ii/Pt+$t)),lr)}var vr=qe[2*Mt+lr],fr=Ze,Gt=Vt;for(ei(Fe,qe,Ze,Mt),qe[2*Vt+lr]>vr&&ei(Fe,qe,Ze,Vt);fr<Gt;){for(ei(Fe,qe,fr,Gt),fr++,Gt--;qe[2*fr+lr]<vr;)fr++;for(;qe[2*Gt+lr]>vr;)Gt--}qe[2*Ze+lr]===vr?ei(Fe,qe,Ze,Gt):ei(Fe,qe,++Gt,Vt),Gt<=Mt&&(Ze=Gt+1),Mt<=Gt&&(Vt=Gt-1)}})(Ce,Me,Se,ve,et,Ye%2),_e(Ce,Me,K,ve,Se-1,Ye+1),_e(Ce,Me,K,Se+1,et,Ye+1)}})(he,j,W,0,he.length-1,0)};Mr.prototype.range=function(L,N,V,W){return function($,se,he,j,J,_e,Ce){for(var Me,K,ve=[0,$.length-1,0],et=[];ve.length;){var Ye=ve.pop(),Se=ve.pop(),We=ve.pop();if(Se-We<=Ce)for(var Fe=We;Fe<=Se;Fe++)K=se[2*Fe+1],(Me=se[2*Fe])>=he&&Me<=J&&K>=j&&K<=_e&&et.push($[Fe]);else{var qe=Math.floor((We+Se)/2);K=se[2*qe+1],(Me=se[2*qe])>=he&&Me<=J&&K>=j&&K<=_e&&et.push($[qe]);var Mt=(Ye+1)%2;(Ye===0?he<=Me:j<=K)&&(ve.push(We),ve.push(qe-1),ve.push(Mt)),(Ye===0?J>=Me:_e>=K)&&(ve.push(qe+1),ve.push(Se),ve.push(Mt))}}return et}(this.ids,this.coords,L,N,V,W,this.nodeSize)},Mr.prototype.within=function(L,N,V){return function(W,$,se,he,j,J){for(var _e=[0,W.length-1,0],Ce=[],Me=j*j;_e.length;){var K=_e.pop(),ve=_e.pop(),et=_e.pop();if(ve-et<=J)for(var Ye=et;Ye<=ve;Ye++)At($[2*Ye],$[2*Ye+1],se,he)<=Me&&Ce.push(W[Ye]);else{var Se=Math.floor((et+ve)/2),We=$[2*Se],Fe=$[2*Se+1];At(We,Fe,se,he)<=Me&&Ce.push(W[Se]);var qe=(K+1)%2;(K===0?se-j<=We:he-j<=Fe)&&(_e.push(et),_e.push(Se-1),_e.push(qe)),(K===0?se+j>=We:he+j>=Fe)&&(_e.push(Se+1),_e.push(ve),_e.push(qe))}}return Ce}(this.ids,this.coords,L,N,V,this.nodeSize)};var Zr={minZoom:0,maxZoom:16,minPoints:2,radius:40,extent:512,nodeSize:64,log:!1,generateId:!1,reduce:null,map:function(L){return L}},sr=function(L){this.options=Dr(Object.create(Zr),L),this.trees=new Array(this.options.maxZoom+1)};function ti(L,N,V,W,$){return{x:L,y:N,zoom:1/0,id:V,parentId:-1,numPoints:W,properties:$}}function Wt(L,N){var V=L.geometry.coordinates,W=V[1];return{x:Nr(V[0]),y:jt(W),zoom:1/0,index:N,parentId:-1}}function Gr(L){return{type:"Feature",id:L.id,properties:mr(L),geometry:{type:"Point",coordinates:[(W=L.x,360*(W-.5)),(N=L.y,V=(180-360*N)*Math.PI/180,360*Math.atan(Math.exp(V))/Math.PI-90)]}};var N,V,W}function mr(L){var N=L.numPoints,V=N>=1e4?Math.round(N/1e3)+"k":N>=1e3?Math.round(N/100)/10+"k":N;return Dr(Dr({},L.properties),{cluster:!0,cluster_id:L.id,point_count:N,point_count_abbreviated:V})}function Nr(L){return L/360+.5}function jt(L){var N=Math.sin(L*Math.PI/180),V=.5-.25*Math.log((1+N)/(1-N))/Math.PI;return V<0?0:V>1?1:V}function Dr(L,N){for(var V in N)L[V]=N[V];return L}function Kr(L){return L.x}function cr(L){return L.y}function Fi(L,N,V,W,$,se){var he=$-V,j=se-W;if(he!==0||j!==0){var J=((L-V)*he+(N-W)*j)/(he*he+j*j);J>1?(V=$,W=se):J>0&&(V+=he*J,W+=j*J)}return(he=L-V)*he+(j=N-W)*j}function Ar(L,N,V,W){var $={id:L===void 0?null:L,type:N,geometry:V,tags:W,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0};return function(se){var he=se.geometry,j=se.type;if(j==="Point"||j==="MultiPoint"||j==="LineString")bi(se,he);else if(j==="Polygon"||j==="MultiLineString")for(var J=0;J<he.length;J++)bi(se,he[J]);else if(j==="MultiPolygon")for(J=0;J<he.length;J++)for(var _e=0;_e<he[J].length;_e++)bi(se,he[J][_e])}($),$}function bi(L,N){for(var V=0;V<N.length;V+=3)L.minX=Math.min(L.minX,N[V]),L.minY=Math.min(L.minY,N[V+1]),L.maxX=Math.max(L.maxX,N[V]),L.maxY=Math.max(L.maxY,N[V+1])}function pi(L,N,V,W){if(N.geometry){var $=N.geometry.coordinates,se=N.geometry.type,he=Math.pow(V.tolerance/((1<<V.maxZoom)*V.extent),2),j=[],J=N.id;if(V.promoteId?J=N.properties[V.promoteId]:V.generateId&&(J=W||0),se==="Point")Qi($,j);else if(se==="MultiPoint")for(var _e=0;_e<$.length;_e++)Qi($[_e],j);else if(se==="LineString")Mi($,j,he,!1);else if(se==="MultiLineString"){if(V.lineMetrics){for(_e=0;_e<$.length;_e++)Mi($[_e],j=[],he,!1),L.push(Ar(J,"LineString",j,N.properties));return}fi($,j,he,!1)}else if(se==="Polygon")fi($,j,he,!0);else{if(se!=="MultiPolygon"){if(se==="GeometryCollection"){for(_e=0;_e<N.geometry.geometries.length;_e++)pi(L,{id:J,geometry:N.geometry.geometries[_e],properties:N.properties},V,W);return}throw new Error("Input data is not a valid GeoJSON object.")}for(_e=0;_e<$.length;_e++){var Ce=[];fi($[_e],Ce,he,!0),j.push(Ce)}}L.push(Ar(J,se,j,N.properties))}}function Qi(L,N){N.push(ri(L[0])),N.push(sn(L[1])),N.push(0)}function Mi(L,N,V,W){for(var $,se,he=0,j=0;j<L.length;j++){var J=ri(L[j][0]),_e=sn(L[j][1]);N.push(J),N.push(_e),N.push(0),j>0&&(he+=W?($*_e-J*se)/2:Math.sqrt(Math.pow(J-$,2)+Math.pow(_e-se,2))),$=J,se=_e}var Ce=N.length-3;N[2]=1,function Me(K,ve,et,Ye){for(var Se,We=Ye,Fe=et-ve>>1,qe=et-ve,Mt=K[ve],Ze=K[ve+1],Vt=K[et],lr=K[et+1],Pt=ve+3;Pt<et;Pt+=3){var er=Fi(K[Pt],K[Pt+1],Mt,Ze,Vt,lr);if(er>We)Se=Pt,We=er;else if(er===We){var Jt=Math.abs(Pt-Fe);Jt<qe&&(Se=Pt,qe=Jt)}}We>Ye&&(Se-ve>3&&Me(K,ve,Se,Ye),K[Se+2]=We,et-Se>3&&Me(K,Se,et,Ye))}(N,0,Ce,V),N[Ce+2]=1,N.size=Math.abs(he),N.start=0,N.end=N.size}function fi(L,N,V,W){for(var $=0;$<L.length;$++){var se=[];Mi(L[$],se,V,W),N.push(se)}}function ri(L){return L/360+.5}function sn(L){var N=Math.sin(L*Math.PI/180),V=.5-.25*Math.log((1+N)/(1-N))/Math.PI;return V<0?0:V>1?1:V}function di(L,N,V,W,$,se,he,j){if(W/=N,se>=(V/=N)&&he<W)return L;if(he<V||se>=W)return null;for(var J=[],_e=0;_e<L.length;_e++){var Ce=L[_e],Me=Ce.geometry,K=Ce.type,ve=$===0?Ce.minX:Ce.minY,et=$===0?Ce.maxX:Ce.maxY;if(ve>=V&&et<W)J.push(Ce);else if(!(et<V||ve>=W)){var Ye=[];if(K==="Point"||K==="MultiPoint")Ur(Me,Ye,V,W,$);else if(K==="LineString")$i(Me,Ye,V,W,$,!1,j.lineMetrics);else if(K==="MultiLineString")Ni(Me,Ye,V,W,$,!1);else if(K==="Polygon")Ni(Me,Ye,V,W,$,!0);else if(K==="MultiPolygon")for(var Se=0;Se<Me.length;Se++){var We=[];Ni(Me[Se],We,V,W,$,!0),We.length&&Ye.push(We)}if(Ye.length){if(j.lineMetrics&&K==="LineString"){for(Se=0;Se<Ye.length;Se++)J.push(Ar(Ce.id,K,Ye[Se],Ce.tags));continue}K!=="LineString"&&K!=="MultiLineString"||(Ye.length===1?(K="LineString",Ye=Ye[0]):K="MultiLineString"),K!=="Point"&&K!=="MultiPoint"||(K=Ye.length===3?"Point":"MultiPoint"),J.push(Ar(Ce.id,K,Ye,Ce.tags))}}}return J.length?J:null}function Ur(L,N,V,W,$){for(var se=0;se<L.length;se+=3){var he=L[se+$];he>=V&&he<=W&&(N.push(L[se]),N.push(L[se+1]),N.push(L[se+2]))}}function $i(L,N,V,W,$,se,he){for(var j,J,_e=Ln(L),Ce=$===0?en:An,Me=L.start,K=0;K<L.length-3;K+=3){var ve=L[K],et=L[K+1],Ye=L[K+2],Se=L[K+3],We=L[K+4],Fe=$===0?ve:et,qe=$===0?Se:We,Mt=!1;he&&(j=Math.sqrt(Math.pow(ve-Se,2)+Math.pow(et-We,2))),Fe<V?qe>V&&(J=Ce(_e,ve,et,Se,We,V),he&&(_e.start=Me+j*J)):Fe>W?qe<W&&(J=Ce(_e,ve,et,Se,We,W),he&&(_e.start=Me+j*J)):zn(_e,ve,et,Ye),qe<V&&Fe>=V&&(J=Ce(_e,ve,et,Se,We,V),Mt=!0),qe>W&&Fe<=W&&(J=Ce(_e,ve,et,Se,We,W),Mt=!0),!se&&Mt&&(he&&(_e.end=Me+j*J),N.push(_e),_e=Ln(L)),he&&(Me+=j)}var Ze=L.length-3;ve=L[Ze],et=L[Ze+1],Ye=L[Ze+2],(Fe=$===0?ve:et)>=V&&Fe<=W&&zn(_e,ve,et,Ye),Ze=_e.length-3,se&&Ze>=3&&(_e[Ze]!==_e[0]||_e[Ze+1]!==_e[1])&&zn(_e,_e[0],_e[1],_e[2]),_e.length&&N.push(_e)}function Ln(L){var N=[];return N.size=L.size,N.start=L.start,N.end=L.end,N}function Ni(L,N,V,W,$,se){for(var he=0;he<L.length;he++)$i(L[he],N,V,W,$,se,!1)}function zn(L,N,V,W){L.push(N),L.push(V),L.push(W)}function en(L,N,V,W,$,se){var he=(se-N)/(W-N);return L.push(se),L.push(V+($-V)*he),L.push(1),he}function An(L,N,V,W,$,se){var he=(se-V)/($-V);return L.push(N+(W-N)*he),L.push(se),L.push(1),he}function Ui(L,N){for(var V=[],W=0;W<L.length;W++){var $,se=L[W],he=se.type;if(he==="Point"||he==="MultiPoint"||he==="LineString")$=gn(se.geometry,N);else if(he==="MultiLineString"||he==="Polygon"){$=[];for(var j=0;j<se.geometry.length;j++)$.push(gn(se.geometry[j],N))}else if(he==="MultiPolygon")for($=[],j=0;j<se.geometry.length;j++){for(var J=[],_e=0;_e<se.geometry[j].length;_e++)J.push(gn(se.geometry[j][_e],N));$.push(J)}V.push(Ar(se.id,he,$,se.tags))}return V}function gn(L,N){var V=[];V.size=L.size,L.start!==void 0&&(V.start=L.start,V.end=L.end);for(var W=0;W<L.length;W+=3)V.push(L[W]+N,L[W+1],L[W+2]);return V}function Vi(L,N){if(L.transformed)return L;var V,W,$,se=1<<L.z,he=L.x,j=L.y;for(V=0;V<L.features.length;V++){var J=L.features[V],_e=J.geometry,Ce=J.type;if(J.geometry=[],Ce===1)for(W=0;W<_e.length;W+=2)J.geometry.push(Rn(_e[W],_e[W+1],N,se,he,j));else for(W=0;W<_e.length;W++){var Me=[];for($=0;$<_e[W].length;$+=2)Me.push(Rn(_e[W][$],_e[W][$+1],N,se,he,j));J.geometry.push(Me)}}return L.transformed=!0,L}function Rn(L,N,V,W,$,se){return[Math.round(V*(L*W-$)),Math.round(V*(N*W-se))]}function tn(L,N,V,W,$){for(var se=N===$.maxZoom?0:$.tolerance/((1<<N)*$.extent),he={features:[],numPoints:0,numSimplified:0,numFeatures:0,source:null,x:V,y:W,z:N,transformed:!1,minX:2,minY:1,maxX:-1,maxY:0},j=0;j<L.length;j++){he.numFeatures++,ji(he,L[j],se,$);var J=L[j].minX,_e=L[j].minY,Ce=L[j].maxX,Me=L[j].maxY;J<he.minX&&(he.minX=J),_e<he.minY&&(he.minY=_e),Ce>he.maxX&&(he.maxX=Ce),Me>he.maxY&&(he.maxY=Me)}return he}function ji(L,N,V,W){var $=N.geometry,se=N.type,he=[];if(se==="Point"||se==="MultiPoint")for(var j=0;j<$.length;j+=3)he.push($[j]),he.push($[j+1]),L.numPoints++,L.numSimplified++;else if(se==="LineString")vn(he,$,L,V,!1,!1);else if(se==="MultiLineString"||se==="Polygon")for(j=0;j<$.length;j++)vn(he,$[j],L,V,se==="Polygon",j===0);else if(se==="MultiPolygon")for(var J=0;J<$.length;J++){var _e=$[J];for(j=0;j<_e.length;j++)vn(he,_e[j],L,V,!0,j===0)}if(he.length){var Ce=N.tags||null;if(se==="LineString"&&W.lineMetrics){for(var Me in Ce={},N.tags)Ce[Me]=N.tags[Me];Ce.mapbox_clip_start=$.start/$.size,Ce.mapbox_clip_end=$.end/$.size}var K={geometry:he,type:se==="Polygon"||se==="MultiPolygon"?3:se==="LineString"||se==="MultiLineString"?2:1,tags:Ce};N.id!==null&&(K.id=N.id),L.features.push(K)}}function vn(L,N,V,W,$,se){var he=W*W;if(W>0&&N.size<($?he:W))V.numPoints+=N.length/3;else{for(var j=[],J=0;J<N.length;J+=3)(W===0||N[J+2]>he)&&(V.numSimplified++,j.push(N[J]),j.push(N[J+1])),V.numPoints++;$&&function(_e,Ce){for(var Me=0,K=0,ve=_e.length,et=ve-2;K<ve;et=K,K+=2)Me+=(_e[K]-_e[et])*(_e[K+1]+_e[et+1]);if(Me>0===Ce)for(K=0,ve=_e.length;K<ve/2;K+=2){var Ye=_e[K],Se=_e[K+1];_e[K]=_e[ve-2-K],_e[K+1]=_e[ve-1-K],_e[ve-2-K]=Ye,_e[ve-1-K]=Se}}(j,se),L.push(j)}}function ln(L,N){var V=(N=this.options=function($,se){for(var he in se)$[he]=se[he];return $}(Object.create(this.options),N)).debug;if(V&&console.time("preprocess data"),N.maxZoom<0||N.maxZoom>24)throw new Error("maxZoom should be in the 0-24 range");if(N.promoteId&&N.generateId)throw new Error("promoteId and generateId cannot be used together.");var W=function($,se){var he=[];if($.type==="FeatureCollection")for(var j=0;j<$.features.length;j++)pi(he,$.features[j],se,j);else pi(he,$.type==="Feature"?$:{geometry:$},se);return he}(L,N);this.tiles={},this.tileCoords=[],V&&(console.timeEnd("preprocess data"),console.log("index: maxZoom: %d, maxPoints: %d",N.indexMaxZoom,N.indexMaxPoints),console.time("generate tiles"),this.stats={},this.total=0),(W=function($,se){var he=se.buffer/se.extent,j=$,J=di($,1,-1-he,he,0,-1,2,se),_e=di($,1,1-he,2+he,0,-1,2,se);return(J||_e)&&(j=di($,1,-he,1+he,0,-1,2,se)||[],J&&(j=Ui(J,1).concat(j)),_e&&(j=j.concat(Ui(_e,-1)))),j}(W,N)).length&&this.splitTile(W,0,0,0),V&&(W.length&&console.log("features: %d, points: %d",this.tiles[0].numFeatures,this.tiles[0].numPoints),console.timeEnd("generate tiles"),console.log("tiles generated:",this.total,JSON.stringify(this.stats)))}function un(L,N,V){return 32*((1<<L)*V+N)+L}function bn(L,N){var V=L.tileID.canonical;if(!this._geoJSONIndex)return N(null,null);var W=this._geoJSONIndex.getTile(V.z,V.x,V.y);if(!W)return N(null,null);var $=new De(W.features),se=_t($);se.byteOffset===0&&se.byteLength===se.buffer.byteLength||(se=new Uint8Array(se)),N(null,{vectorTile:$,rawData:se.buffer})}sr.prototype.load=function(L){var N=this.options,V=N.log,W=N.minZoom,$=N.maxZoom,se=N.nodeSize;V&&console.time("total time");var he="prepare "+L.length+" points";V&&console.time(he),this.points=L;for(var j=[],J=0;J<L.length;J++)L[J].geometry&&j.push(Wt(L[J],J));this.trees[$+1]=new Mr(j,Kr,cr,se,Float32Array),V&&console.timeEnd(he);for(var _e=$;_e>=W;_e--){var Ce=+Date.now();j=this._cluster(j,_e),this.trees[_e]=new Mr(j,Kr,cr,se,Float32Array),V&&console.log("z%d: %d clusters in %dms",_e,j.length,+Date.now()-Ce)}return V&&console.timeEnd("total time"),this},sr.prototype.getClusters=function(L,N){var V=((L[0]+180)%360+360)%360-180,W=Math.max(-90,Math.min(90,L[1])),$=L[2]===180?180:((L[2]+180)%360+360)%360-180,se=Math.max(-90,Math.min(90,L[3]));if(L[2]-L[0]>=360)V=-180,$=180;else if(V>$){var he=this.getClusters([V,W,180,se],N),j=this.getClusters([-180,W,$,se],N);return he.concat(j)}for(var J=this.trees[this._limitZoom(N)],_e=[],Ce=0,Me=J.range(Nr(V),jt(se),Nr($),jt(W));Ce<Me.length;Ce+=1){var K=J.points[Me[Ce]];_e.push(K.numPoints?Gr(K):this.points[K.index])}return _e},sr.prototype.getChildren=function(L){var N=this._getOriginId(L),V=this._getOriginZoom(L),W="No cluster with the specified id.",$=this.trees[V];if(!$)throw new Error(W);var se=$.points[N];if(!se)throw new Error(W);for(var he=this.options.radius/(this.options.extent*Math.pow(2,V-1)),j=[],J=0,_e=$.within(se.x,se.y,he);J<_e.length;J+=1){var Ce=$.points[_e[J]];Ce.parentId===L&&j.push(Ce.numPoints?Gr(Ce):this.points[Ce.index])}if(j.length===0)throw new Error(W);return j},sr.prototype.getLeaves=function(L,N,V){var W=[];return this._appendLeaves(W,L,N=N||10,V=V||0,0),W},sr.prototype.getTile=function(L,N,V){var W=this.trees[this._limitZoom(L)],$=Math.pow(2,L),se=this.options,he=se.radius/se.extent,j=(V-he)/$,J=(V+1+he)/$,_e={features:[]};return this._addTileFeatures(W.range((N-he)/$,j,(N+1+he)/$,J),W.points,N,V,$,_e),N===0&&this._addTileFeatures(W.range(1-he/$,j,1,J),W.points,$,V,$,_e),N===$-1&&this._addTileFeatures(W.range(0,j,he/$,J),W.points,-1,V,$,_e),_e.features.length?_e:null},sr.prototype.getClusterExpansionZoom=function(L){for(var N=this._getOriginZoom(L)-1;N<=this.options.maxZoom;){var V=this.getChildren(L);if(N++,V.length!==1)break;L=V[0].properties.cluster_id}return N},sr.prototype._appendLeaves=function(L,N,V,W,$){for(var se=0,he=this.getChildren(N);se<he.length;se+=1){var j=he[se],J=j.properties;if(J&&J.cluster?$+J.point_count<=W?$+=J.point_count:$=this._appendLeaves(L,J.cluster_id,V,W,$):$<W?$++:L.push(j),L.length===V)break}return $},sr.prototype._addTileFeatures=function(L,N,V,W,$,se){for(var he=0,j=L;he<j.length;he+=1){var J=N[j[he]],_e=J.numPoints,Ce={type:1,geometry:[[Math.round(this.options.extent*(J.x*$-V)),Math.round(this.options.extent*(J.y*$-W))]],tags:_e?mr(J):this.points[J.index].properties},Me=void 0;_e?Me=J.id:this.options.generateId?Me=J.index:this.points[J.index].id&&(Me=this.points[J.index].id),Me!==void 0&&(Ce.id=Me),se.features.push(Ce)}},sr.prototype._limitZoom=function(L){return Math.max(this.options.minZoom,Math.min(+L,this.options.maxZoom+1))},sr.prototype._cluster=function(L,N){for(var V=[],W=this.options,$=W.reduce,se=W.minPoints,he=W.radius/(W.extent*Math.pow(2,N)),j=0;j<L.length;j++){var J=L[j];if(!(J.zoom<=N)){J.zoom=N;for(var _e=this.trees[N+1],Ce=_e.within(J.x,J.y,he),Me=J.numPoints||1,K=Me,ve=0,et=Ce;ve<et.length;ve+=1){var Ye=_e.points[et[ve]];Ye.zoom>N&&(K+=Ye.numPoints||1)}if(K>=se){for(var Se=J.x*Me,We=J.y*Me,Fe=$&&Me>1?this._map(J,!0):null,qe=(j<<5)+(N+1)+this.points.length,Mt=0,Ze=Ce;Mt<Ze.length;Mt+=1){var Vt=_e.points[Ze[Mt]];if(!(Vt.zoom<=N)){Vt.zoom=N;var lr=Vt.numPoints||1;Se+=Vt.x*lr,We+=Vt.y*lr,Vt.parentId=qe,$&&(Fe||(Fe=this._map(J,!0)),$(Fe,this._map(Vt)))}}J.parentId=qe,V.push(ti(Se/K,We/K,qe,K,Fe))}else if(V.push(J),K>1)for(var Pt=0,er=Ce;Pt<er.length;Pt+=1){var Jt=_e.points[er[Pt]];Jt.zoom<=N||(Jt.zoom=N,V.push(Jt))}}}return V},sr.prototype._getOriginId=function(L){return L-this.points.length>>5},sr.prototype._getOriginZoom=function(L){return(L-this.points.length)%32},sr.prototype._map=function(L,N){if(L.numPoints)return N?Dr({},L.properties):L.properties;var V=this.points[L.index].properties,W=this.options.map(V);return N&&W===V?Dr({},W):W},ln.prototype.options={maxZoom:14,indexMaxZoom:5,indexMaxPoints:1e5,tolerance:3,extent:4096,buffer:64,lineMetrics:!1,promoteId:null,generateId:!1,debug:0},ln.prototype.splitTile=function(L,N,V,W,$,se,he){for(var j=[L,N,V,W],J=this.options,_e=J.debug;j.length;){W=j.pop(),V=j.pop(),N=j.pop(),L=j.pop();var Ce=1<<N,Me=un(N,V,W),K=this.tiles[Me];if(!K&&(_e>1&&console.time("creation"),K=this.tiles[Me]=tn(L,N,V,W,J),this.tileCoords.push({z:N,x:V,y:W}),_e)){_e>1&&(console.log("tile z%d-%d-%d (features: %d, points: %d, simplified: %d)",N,V,W,K.numFeatures,K.numPoints,K.numSimplified),console.timeEnd("creation"));var ve="z"+N;this.stats[ve]=(this.stats[ve]||0)+1,this.total++}if(K.source=L,$){if(N===J.maxZoom||N===$)continue;var et=1<<$-N;if(V!==Math.floor(se/et)||W!==Math.floor(he/et))continue}else if(N===J.indexMaxZoom||K.numPoints<=J.indexMaxPoints)continue;if(K.source=null,L.length!==0){_e>1&&console.time("clipping");var Ye,Se,We,Fe,qe,Mt,Ze=.5*J.buffer/J.extent,Vt=.5-Ze,lr=.5+Ze,Pt=1+Ze;Ye=Se=We=Fe=null,qe=di(L,Ce,V-Ze,V+lr,0,K.minX,K.maxX,J),Mt=di(L,Ce,V+Vt,V+Pt,0,K.minX,K.maxX,J),L=null,qe&&(Ye=di(qe,Ce,W-Ze,W+lr,1,K.minY,K.maxY,J),Se=di(qe,Ce,W+Vt,W+Pt,1,K.minY,K.maxY,J),qe=null),Mt&&(We=di(Mt,Ce,W-Ze,W+lr,1,K.minY,K.maxY,J),Fe=di(Mt,Ce,W+Vt,W+Pt,1,K.minY,K.maxY,J),Mt=null),_e>1&&console.timeEnd("clipping"),j.push(Ye||[],N+1,2*V,2*W),j.push(Se||[],N+1,2*V,2*W+1),j.push(We||[],N+1,2*V+1,2*W),j.push(Fe||[],N+1,2*V+1,2*W+1)}}},ln.prototype.getTile=function(L,N,V){var W=this.options,$=W.extent,se=W.debug;if(L<0||L>24)return null;var he=1<<L,j=un(L,N=(N%he+he)%he,V);if(this.tiles[j])return Vi(this.tiles[j],$);se>1&&console.log("drilling down to z%d-%d-%d",L,N,V);for(var J,_e=L,Ce=N,Me=V;!J&&_e>0;)_e--,Ce=Math.floor(Ce/2),Me=Math.floor(Me/2),J=this.tiles[un(_e,Ce,Me)];return J&&J.source?(se>1&&console.log("found parent tile z%d-%d-%d",_e,Ce,Me),se>1&&console.time("drilling down"),this.splitTile(J.source,_e,Ce,Me,L,N,V),se>1&&console.timeEnd("drilling down"),this.tiles[j]?Vi(this.tiles[j],$):null):null};var oi=function(L){function N(V,W,$,se){L.call(this,V,W,$,bn),se&&(this.loadGeoJSON=se)}return L&&(N.__proto__=L),(N.prototype=Object.create(L&&L.prototype)).constructor=N,N.prototype.loadData=function(V,W){this._pendingCallback&&this._pendingCallback(null,{abandoned:!0}),this._pendingCallback=W,this._pendingLoadDataParams=V,this._state&&this._state!=="Idle"?this._state="NeedsLoadData":(this._state="Coalescing",this._loadData())},N.prototype._loadData=function(){var V=this;if(this._pendingCallback&&this._pendingLoadDataParams){var W=this._pendingCallback,$=this._pendingLoadDataParams;delete this._pendingCallback,delete this._pendingLoadDataParams;var se=!!($&&$.request&&$.request.collectResourceTiming)&&new a.RequestPerformance($.request);this.loadGeoJSON($,function(he,j){if(he||!j)return W(he);if(typeof j!="object")return W(new Error("Input data given to '"+$.source+"' is not a valid GeoJSON object."));(function K(ve,et){var Ye,Se=ve&&ve.type;if(Se==="FeatureCollection")for(Ye=0;Ye<ve.features.length;Ye++)K(ve.features[Ye],et);else if(Se==="GeometryCollection")for(Ye=0;Ye<ve.geometries.length;Ye++)K(ve.geometries[Ye],et);else if(Se==="Feature")K(ve.geometry,et);else if(Se==="Polygon")we(ve.coordinates,et);else if(Se==="MultiPolygon")for(Ye=0;Ye<ve.coordinates.length;Ye++)we(ve.coordinates[Ye],et);return ve})(j,!0);try{if($.filter){var J=a.createExpression($.filter,{type:"boolean","property-type":"data-driven",overridable:!1,transition:!1});if(J.result==="error")throw new Error(J.value.map(function(K){return K.key+": "+K.message}).join(", "));var _e=j.features.filter(function(K){return J.value.evaluate({zoom:0},K)});j={type:"FeatureCollection",features:_e}}V._geoJSONIndex=$.cluster?new sr(function(K){var ve=K.superclusterOptions,et=K.clusterProperties;if(!et||!ve)return ve;for(var Ye={},Se={},We={accumulated:null,zoom:0},Fe={properties:null},qe=Object.keys(et),Mt=0,Ze=qe;Mt<Ze.length;Mt+=1){var Vt=Ze[Mt],lr=et[Vt],Pt=lr[0],er=a.createExpression(lr[1]),Jt=a.createExpression(typeof Pt=="string"?[Pt,["accumulated"],["get",Vt]]:Pt);Ye[Vt]=er.value,Se[Vt]=Jt.value}return ve.map=function(ii){Fe.properties=ii;for(var $t={},vr=0,fr=qe;vr<fr.length;vr+=1){var Gt=fr[vr];$t[Gt]=Ye[Gt].evaluate(We,Fe)}return $t},ve.reduce=function(ii,$t){Fe.properties=$t;for(var vr=0,fr=qe;vr<fr.length;vr+=1){var Gt=fr[vr];We.accumulated=ii[Gt],ii[Gt]=Se[Gt].evaluate(We,Fe)}},ve}($)).load(j.features):function(K,ve){return new ln(K,ve)}(j,$.geojsonVtOptions)}catch(K){return W(K)}V.loaded={};var Ce={};if(se){var Me=se.finish();Me&&(Ce.resourceTiming={},Ce.resourceTiming[$.source]=JSON.parse(JSON.stringify(Me)))}W(null,Ce)})}},N.prototype.coalesce=function(){this._state==="Coalescing"?this._state="Idle":this._state==="NeedsLoadData"&&(this._state="Coalescing",this._loadData())},N.prototype.reloadTile=function(V,W){var $=this.loaded;return $&&$[V.uid]?L.prototype.reloadTile.call(this,V,W):this.loadTile(V,W)},N.prototype.loadGeoJSON=function(V,W){if(V.request)a.getJSON(V.request,W);else{if(typeof V.data!="string")return W(new Error("Input data given to '"+V.source+"' is not a valid GeoJSON object."));try{return W(null,JSON.parse(V.data))}catch{return W(new Error("Input data given to '"+V.source+"' is not a valid GeoJSON object."))}}},N.prototype.removeSource=function(V,W){this._pendingCallback&&this._pendingCallback(null,{abandoned:!0}),W()},N.prototype.getClusterExpansionZoom=function(V,W){try{W(null,this._geoJSONIndex.getClusterExpansionZoom(V.clusterId))}catch($){W($)}},N.prototype.getClusterChildren=function(V,W){try{W(null,this._geoJSONIndex.getChildren(V.clusterId))}catch($){W($)}},N.prototype.getClusterLeaves=function(V,W){try{W(null,this._geoJSONIndex.getLeaves(V.clusterId,V.limit,V.offset))}catch($){W($)}},N}(ae),Pr=function(L){var N=this;this.self=L,this.actor=new a.Actor(L,this),this.layerIndexes={},this.availableImages={},this.workerSourceTypes={vector:ae,geojson:oi},this.workerSources={},this.demWorkerSources={},this.self.registerWorkerSource=function(V,W){if(N.workerSourceTypes[V])throw new Error('Worker source with name "'+V+'" already registered.');N.workerSourceTypes[V]=W},this.self.registerRTLTextPlugin=function(V){if(a.plugin.isParsed())throw new Error("RTL text plugin already registered.");a.plugin.applyArabicShaping=V.applyArabicShaping,a.plugin.processBidirectionalText=V.processBidirectionalText,a.plugin.processStyledBidirectionalText=V.processStyledBidirectionalText}};return Pr.prototype.setReferrer=function(L,N){this.referrer=N},Pr.prototype.setImages=function(L,N,V){for(var W in this.availableImages[L]=N,this.workerSources[L]){var $=this.workerSources[L][W];for(var se in $)$[se].availableImages=N}V()},Pr.prototype.setLayers=function(L,N,V){this.getLayerIndex(L).replace(N),V()},Pr.prototype.updateLayers=function(L,N,V){this.getLayerIndex(L).update(N.layers,N.removedIds),V()},Pr.prototype.loadTile=function(L,N,V){this.getWorkerSource(L,N.type,N.source).loadTile(N,V)},Pr.prototype.loadDEMTile=function(L,N,V){this.getDEMWorkerSource(L,N.source).loadTile(N,V)},Pr.prototype.reloadTile=function(L,N,V){this.getWorkerSource(L,N.type,N.source).reloadTile(N,V)},Pr.prototype.abortTile=function(L,N,V){this.getWorkerSource(L,N.type,N.source).abortTile(N,V)},Pr.prototype.removeTile=function(L,N,V){this.getWorkerSource(L,N.type,N.source).removeTile(N,V)},Pr.prototype.removeDEMTile=function(L,N){this.getDEMWorkerSource(L,N.source).removeTile(N)},Pr.prototype.removeSource=function(L,N,V){if(this.workerSources[L]&&this.workerSources[L][N.type]&&this.workerSources[L][N.type][N.source]){var W=this.workerSources[L][N.type][N.source];delete this.workerSources[L][N.type][N.source],W.removeSource!==void 0?W.removeSource(N,V):V()}},Pr.prototype.loadWorkerSource=function(L,N,V){try{this.self.importScripts(N.url),V()}catch(W){V(W.toString())}},Pr.prototype.syncRTLPluginState=function(L,N,V){try{a.plugin.setState(N);var W=a.plugin.getPluginURL();if(a.plugin.isLoaded()&&!a.plugin.isParsed()&&W!=null){this.self.importScripts(W);var $=a.plugin.isParsed();V($?void 0:new Error("RTL Text Plugin failed to import scripts from "+W),$)}}catch(se){V(se.toString())}},Pr.prototype.getAvailableImages=function(L){var N=this.availableImages[L];return N||(N=[]),N},Pr.prototype.getLayerIndex=function(L){var N=this.layerIndexes[L];return N||(N=this.layerIndexes[L]=new M),N},Pr.prototype.getWorkerSource=function(L,N,V){var W=this;return this.workerSources[L]||(this.workerSources[L]={}),this.workerSources[L][N]||(this.workerSources[L][N]={}),this.workerSources[L][N][V]||(this.workerSources[L][N][V]=new this.workerSourceTypes[N]({send:function($,se,he){W.actor.send($,se,he,L)}},this.getLayerIndex(L),this.getAvailableImages(L))),this.workerSources[L][N][V]},Pr.prototype.getDEMWorkerSource=function(L,N){return this.demWorkerSources[L]||(this.demWorkerSources[L]={}),this.demWorkerSources[L][N]||(this.demWorkerSources[L][N]=new fe),this.demWorkerSources[L][N]},Pr.prototype.enforceCacheSizeLimit=function(L,N){a.enforceCacheSizeLimit(N)},typeof WorkerGlobalScope<"u"&&typeof self<"u"&&self instanceof WorkerGlobalScope&&(self.worker=new Pr(self)),Pr}),v(["./shared"],function(a){var I=a.createCommonjsModule(function(n){function s(y){return!o(y)}function o(y){return typeof window>"u"||typeof document>"u"?"not a browser":Array.prototype&&Array.prototype.every&&Array.prototype.filter&&Array.prototype.forEach&&Array.prototype.indexOf&&Array.prototype.lastIndexOf&&Array.prototype.map&&Array.prototype.some&&Array.prototype.reduce&&Array.prototype.reduceRight&&Array.isArray?Function.prototype&&Function.prototype.bind?Object.keys&&Object.create&&Object.getPrototypeOf&&Object.getOwnPropertyNames&&Object.isSealed&&Object.isFrozen&&Object.isExtensible&&Object.getOwnPropertyDescriptor&&Object.defineProperty&&Object.defineProperties&&Object.seal&&Object.freeze&&Object.preventExtensions?"JSON"in window&&"parse"in JSON&&"stringify"in JSON?function(){if(!("Worker"in window&&"Blob"in window&&"URL"in window))return!1;var k,E,P=new Blob([""],{type:"text/javascript"}),O=URL.createObjectURL(P);try{E=new Worker(O),k=!0}catch{k=!1}return E&&E.terminate(),URL.revokeObjectURL(O),k}()?"Uint8ClampedArray"in window?ArrayBuffer.isView?function(){var k=document.createElement("canvas");k.width=k.height=1;var E=k.getContext("2d");if(!E)return!1;var P=E.getImageData(0,0,1,1);return P&&P.width===k.width}()?(u[w=y&&y.failIfMajorPerformanceCaveat]===void 0&&(u[w]=function(k){var E=function(O){var Z=document.createElement("canvas"),G=Object.create(s.webGLContextAttributes);return G.failIfMajorPerformanceCaveat=O,Z.probablySupportsContext?Z.probablySupportsContext("webgl",G)||Z.probablySupportsContext("experimental-webgl",G):Z.supportsContext?Z.supportsContext("webgl",G)||Z.supportsContext("experimental-webgl",G):Z.getContext("webgl",G)||Z.getContext("experimental-webgl",G)}(k);if(!E)return!1;var P=E.createShader(E.VERTEX_SHADER);return!(!P||E.isContextLost())&&(E.shaderSource(P,"void main() {}"),E.compileShader(P),E.getShaderParameter(P,E.COMPILE_STATUS)===!0)}(w)),u[w]?void 0:"insufficient WebGL support"):"insufficient Canvas/getImageData support":"insufficient ArrayBuffer support":"insufficient Uint8ClampedArray support":"insufficient worker support":"insufficient JSON support":"insufficient Object support":"insufficient Function support":"insufficent Array support";var w}n.exports?n.exports=s:window&&(window.mapboxgl=window.mapboxgl||{},window.mapboxgl.supported=s,window.mapboxgl.notSupportedReason=o);var u={};s.webGLContextAttributes={antialias:!1,alpha:!0,stencil:!0,depth:!0}}),T={create:function(n,s,o){var u=a.window.document.createElement(n);return s!==void 0&&(u.className=s),o&&o.appendChild(u),u},createNS:function(n,s){return a.window.document.createElementNS(n,s)}},M=a.window.document&&a.window.document.documentElement.style;function F(n){if(!M)return n[0];for(var s=0;s<n.length;s++)if(n[s]in M)return n[s];return n[0]}var R,D=F(["userSelect","MozUserSelect","WebkitUserSelect","msUserSelect"]);T.disableDrag=function(){M&&D&&(R=M[D],M[D]="none")},T.enableDrag=function(){M&&D&&(M[D]=R)};var H=F(["transform","WebkitTransform"]);T.setTransform=function(n,s){n.style[H]=s};var ae=!1;try{var de=Object.defineProperty({},"passive",{get:function(){ae=!0}});a.window.addEventListener("test",de,de),a.window.removeEventListener("test",de,de)}catch{ae=!1}T.addEventListener=function(n,s,o,u){u===void 0&&(u={}),n.addEventListener(s,o,"passive"in u&&ae?u:u.capture)},T.removeEventListener=function(n,s,o,u){u===void 0&&(u={}),n.removeEventListener(s,o,"passive"in u&&ae?u:u.capture)};var fe=function(n){n.preventDefault(),n.stopPropagation(),a.window.removeEventListener("click",fe,!0)};function we(n){var s=n.userImage;return!!(s&&s.render&&s.render())&&(n.data.replace(new Uint8Array(s.data.buffer)),!0)}T.suppressClick=function(){a.window.addEventListener("click",fe,!0),a.window.setTimeout(function(){a.window.removeEventListener("click",fe,!0)},0)},T.mousePos=function(n,s){var o=n.getBoundingClientRect();return new a.Point(s.clientX-o.left-n.clientLeft,s.clientY-o.top-n.clientTop)},T.touchPos=function(n,s){for(var o=n.getBoundingClientRect(),u=[],y=0;y<s.length;y++)u.push(new a.Point(s[y].clientX-o.left-n.clientLeft,s[y].clientY-o.top-n.clientTop));return u},T.mouseButton=function(n){return a.window.InstallTrigger!==void 0&&n.button===2&&n.ctrlKey&&a.window.navigator.platform.toUpperCase().indexOf("MAC")>=0?0:n.button},T.remove=function(n){n.parentNode&&n.parentNode.removeChild(n)};var xe=function(n){function s(){n.call(this),this.images={},this.updatedImages={},this.callbackDispatchedThisFrame={},this.loaded=!1,this.requestors=[],this.patterns={},this.atlasImage=new a.RGBAImage({width:1,height:1}),this.dirty=!0}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype.isLoaded=function(){return this.loaded},s.prototype.setLoaded=function(o){if(this.loaded!==o&&(this.loaded=o,o)){for(var u=0,y=this.requestors;u<y.length;u+=1){var w=y[u];this._notify(w.ids,w.callback)}this.requestors=[]}},s.prototype.getImage=function(o){return this.images[o]},s.prototype.addImage=function(o,u){this._validate(o,u)&&(this.images[o]=u)},s.prototype._validate=function(o,u){var y=!0;return this._validateStretch(u.stretchX,u.data&&u.data.width)||(this.fire(new a.ErrorEvent(new Error('Image "'+o+'" has invalid "stretchX" value'))),y=!1),this._validateStretch(u.stretchY,u.data&&u.data.height)||(this.fire(new a.ErrorEvent(new Error('Image "'+o+'" has invalid "stretchY" value'))),y=!1),this._validateContent(u.content,u)||(this.fire(new a.ErrorEvent(new Error('Image "'+o+'" has invalid "content" value'))),y=!1),y},s.prototype._validateStretch=function(o,u){if(!o)return!0;for(var y=0,w=0,k=o;w<k.length;w+=1){var E=k[w];if(E[0]<y||E[1]<E[0]||u<E[1])return!1;y=E[1]}return!0},s.prototype._validateContent=function(o,u){return!(o&&(o.length!==4||o[0]<0||u.data.width<o[0]||o[1]<0||u.data.height<o[1]||o[2]<0||u.data.width<o[2]||o[3]<0||u.data.height<o[3]||o[2]<o[0]||o[3]<o[1]))},s.prototype.updateImage=function(o,u){u.version=this.images[o].version+1,this.images[o]=u,this.updatedImages[o]=!0},s.prototype.removeImage=function(o){var u=this.images[o];delete this.images[o],delete this.patterns[o],u.userImage&&u.userImage.onRemove&&u.userImage.onRemove()},s.prototype.listImages=function(){return Object.keys(this.images)},s.prototype.getImages=function(o,u){var y=!0;if(!this.isLoaded())for(var w=0,k=o;w<k.length;w+=1)this.images[k[w]]||(y=!1);this.isLoaded()||y?this._notify(o,u):this.requestors.push({ids:o,callback:u})},s.prototype._notify=function(o,u){for(var y={},w=0,k=o;w<k.length;w+=1){var E=k[w];this.images[E]||this.fire(new a.Event("styleimagemissing",{id:E}));var P=this.images[E];P?y[E]={data:P.data.clone(),pixelRatio:P.pixelRatio,sdf:P.sdf,version:P.version,stretchX:P.stretchX,stretchY:P.stretchY,content:P.content,hasRenderCallback:!!(P.userImage&&P.userImage.render)}:a.warnOnce('Image "'+E+'" could not be loaded. Please make sure you have added the image with map.addImage() or a "sprite" property in your style. You can provide missing images by listening for the "styleimagemissing" map event.')}u(null,y)},s.prototype.getPixelSize=function(){var o=this.atlasImage;return{width:o.width,height:o.height}},s.prototype.getPattern=function(o){var u=this.patterns[o],y=this.getImage(o);if(!y)return null;if(u&&u.position.version===y.version)return u.position;if(u)u.position.version=y.version;else{var w={w:y.data.width+2,h:y.data.height+2,x:0,y:0},k=new a.ImagePosition(w,y);this.patterns[o]={bin:w,position:k}}return this._updatePatternAtlas(),this.patterns[o].position},s.prototype.bind=function(o){var u=o.gl;this.atlasTexture?this.dirty&&(this.atlasTexture.update(this.atlasImage),this.dirty=!1):this.atlasTexture=new a.Texture(o,this.atlasImage,u.RGBA),this.atlasTexture.bind(u.LINEAR,u.CLAMP_TO_EDGE)},s.prototype._updatePatternAtlas=function(){var o=[];for(var u in this.patterns)o.push(this.patterns[u].bin);var y=a.potpack(o),w=y.w,k=y.h,E=this.atlasImage;for(var P in E.resize({width:w||1,height:k||1}),this.patterns){var O=this.patterns[P].bin,Z=O.x+1,G=O.y+1,X=this.images[P].data,re=X.width,te=X.height;a.RGBAImage.copy(X,E,{x:0,y:0},{x:Z,y:G},{width:re,height:te}),a.RGBAImage.copy(X,E,{x:0,y:te-1},{x:Z,y:G-1},{width:re,height:1}),a.RGBAImage.copy(X,E,{x:0,y:0},{x:Z,y:G+te},{width:re,height:1}),a.RGBAImage.copy(X,E,{x:re-1,y:0},{x:Z-1,y:G},{width:1,height:te}),a.RGBAImage.copy(X,E,{x:0,y:0},{x:Z+re,y:G},{width:1,height:te})}this.dirty=!0},s.prototype.beginFrame=function(){this.callbackDispatchedThisFrame={}},s.prototype.dispatchRenderCallbacks=function(o){for(var u=0,y=o;u<y.length;u+=1){var w=y[u];if(!this.callbackDispatchedThisFrame[w]){this.callbackDispatchedThisFrame[w]=!0;var k=this.images[w];we(k)&&this.updateImage(w,k)}}},s}(a.Evented),Ve=He,Oe=He,De=1e20;function He(n,s,o,u,y,w){this.fontSize=n||24,this.buffer=s===void 0?3:s,this.cutoff=u||.25,this.fontFamily=y||"sans-serif",this.fontWeight=w||"normal",this.radius=o||8;var k=this.size=this.fontSize+2*this.buffer;this.canvas=document.createElement("canvas"),this.canvas.width=this.canvas.height=k,this.ctx=this.canvas.getContext("2d"),this.ctx.font=this.fontWeight+" "+this.fontSize+"px "+this.fontFamily,this.ctx.textBaseline="middle",this.ctx.fillStyle="black",this.gridOuter=new Float64Array(k*k),this.gridInner=new Float64Array(k*k),this.f=new Float64Array(k),this.d=new Float64Array(k),this.z=new Float64Array(k+1),this.v=new Int16Array(k),this.middle=Math.round(k/2*(navigator.userAgent.indexOf("Gecko/")>=0?1.2:1))}function Tt(n,s,o,u,y,w,k){for(var E=0;E<s;E++){for(var P=0;P<o;P++)u[P]=n[P*s+E];for(Lt(u,y,w,k,o),P=0;P<o;P++)n[P*s+E]=y[P]}for(P=0;P<o;P++){for(E=0;E<s;E++)u[E]=n[P*s+E];for(Lt(u,y,w,k,s),E=0;E<s;E++)n[P*s+E]=Math.sqrt(y[E])}}function Lt(n,s,o,u,y){o[0]=0,u[0]=-De,u[1]=+De;for(var w=1,k=0;w<y;w++){for(var E=(n[w]+w*w-(n[o[k]]+o[k]*o[k]))/(2*w-2*o[k]);E<=u[k];)k--,E=(n[w]+w*w-(n[o[k]]+o[k]*o[k]))/(2*w-2*o[k]);o[++k]=w,u[k]=E,u[k+1]=+De}for(w=0,k=0;w<y;w++){for(;u[k+1]<w;)k++;s[w]=(w-o[k])*(w-o[k])+n[o[k]]}}He.prototype.draw=function(n){this.ctx.clearRect(0,0,this.size,this.size),this.ctx.fillText(n,this.buffer,this.middle);for(var s=this.ctx.getImageData(0,0,this.size,this.size),o=new Uint8ClampedArray(this.size*this.size),u=0;u<this.size*this.size;u++){var y=s.data[4*u+3]/255;this.gridOuter[u]=y===1?0:y===0?De:Math.pow(Math.max(0,.5-y),2),this.gridInner[u]=y===1?De:y===0?0:Math.pow(Math.max(0,y-.5),2)}for(Tt(this.gridOuter,this.size,this.size,this.f,this.d,this.v,this.z),Tt(this.gridInner,this.size,this.size,this.f,this.d,this.v,this.z),u=0;u<this.size*this.size;u++)o[u]=Math.max(0,Math.min(255,Math.round(255-255*((this.gridOuter[u]-this.gridInner[u])/this.radius+this.cutoff))));return o},Ve.default=Oe;var qt=function(n,s){this.requestManager=n,this.localIdeographFontFamily=s,this.entries={}};qt.prototype.setURL=function(n){this.url=n},qt.prototype.getGlyphs=function(n,s){var o=this,u=[];for(var y in n)for(var w=0,k=n[y];w<k.length;w+=1)u.push({stack:y,id:k[w]});a.asyncAll(u,function(E,P){var O=E.stack,Z=E.id,G=o.entries[O];G||(G=o.entries[O]={glyphs:{},requests:{},ranges:{}});var X=G.glyphs[Z];if(X===void 0){if(X=o._tinySDF(G,O,Z))return G.glyphs[Z]=X,void P(null,{stack:O,id:Z,glyph:X});var re=Math.floor(Z/256);if(256*re>65535)P(new Error("glyphs > 65535 not supported"));else if(G.ranges[re])P(null,{stack:O,id:Z,glyph:X});else{var te=G.requests[re];te||(te=G.requests[re]=[],qt.loadGlyphRange(O,re,o.url,o.requestManager,function(ue,Y){if(Y){for(var le in Y)o._doesCharSupportLocalGlyph(+le)||(G.glyphs[+le]=Y[+le]);G.ranges[re]=!0}for(var pe=0,ge=te;pe<ge.length;pe+=1)(0,ge[pe])(ue,Y);delete G.requests[re]})),te.push(function(ue,Y){ue?P(ue):Y&&P(null,{stack:O,id:Z,glyph:Y[Z]||null})})}}else P(null,{stack:O,id:Z,glyph:X})},function(E,P){if(E)s(E);else if(P){for(var O={},Z=0,G=P;Z<G.length;Z+=1){var X=G[Z],re=X.stack,te=X.id,ue=X.glyph;(O[re]||(O[re]={}))[te]=ue&&{id:ue.id,bitmap:ue.bitmap.clone(),metrics:ue.metrics}}s(null,O)}})},qt.prototype._doesCharSupportLocalGlyph=function(n){return!!this.localIdeographFontFamily&&(a.isChar["CJK Unified Ideographs"](n)||a.isChar["Hangul Syllables"](n)||a.isChar.Hiragana(n)||a.isChar.Katakana(n))},qt.prototype._tinySDF=function(n,s,o){var u=this.localIdeographFontFamily;if(u&&this._doesCharSupportLocalGlyph(o)){var y=n.tinySDF;if(!y){var w="400";/bold/i.test(s)?w="900":/medium/i.test(s)?w="500":/light/i.test(s)&&(w="200"),y=n.tinySDF=new qt.TinySDF(24,3,8,.25,u,w)}return{id:o,bitmap:new a.AlphaImage({width:30,height:30},y.draw(String.fromCharCode(o))),metrics:{width:24,height:24,left:0,top:-8,advance:24}}}},qt.loadGlyphRange=function(n,s,o,u,y){var w=256*s,k=w+255,E=u.transformRequest(u.normalizeGlyphsURL(o).replace("{fontstack}",n).replace("{range}",w+"-"+k),a.ResourceType.Glyphs);a.getArrayBuffer(E,function(P,O){if(P)y(P);else if(O){for(var Z={},G=0,X=a.parseGlyphPBF(O);G<X.length;G+=1){var re=X[G];Z[re.id]=re}y(null,Z)}})},qt.TinySDF=Ve;var _t=function(){this.specification=a.styleSpec.light.position};_t.prototype.possiblyEvaluate=function(n,s){return a.sphericalToCartesian(n.expression.evaluate(s))},_t.prototype.interpolate=function(n,s,o){return{x:a.number(n.x,s.x,o),y:a.number(n.y,s.y,o),z:a.number(n.z,s.z,o)}};var ht=new a.Properties({anchor:new a.DataConstantProperty(a.styleSpec.light.anchor),position:new _t,color:new a.DataConstantProperty(a.styleSpec.light.color),intensity:new a.DataConstantProperty(a.styleSpec.light.intensity)}),Ft=function(n){function s(o){n.call(this),this._transitionable=new a.Transitionable(ht),this.setLight(o),this._transitioning=this._transitionable.untransitioned()}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype.getLight=function(){return this._transitionable.serialize()},s.prototype.setLight=function(o,u){if(u===void 0&&(u={}),!this._validate(a.validateLight,o,u))for(var y in o){var w=o[y];a.endsWith(y,"-transition")?this._transitionable.setTransition(y.slice(0,-11),w):this._transitionable.setValue(y,w)}},s.prototype.updateTransitions=function(o){this._transitioning=this._transitionable.transitioned(o,this._transitioning)},s.prototype.hasTransition=function(){return this._transitioning.hasTransition()},s.prototype.recalculate=function(o){this.properties=this._transitioning.possiblyEvaluate(o)},s.prototype._validate=function(o,u,y){return(!y||y.validate!==!1)&&a.emitValidationErrors(this,o.call(a.validateStyle,a.extend({value:u,style:{glyphs:!0,sprite:!0},styleSpec:a.styleSpec})))},s}(a.Evented),yt=function(n,s){this.width=n,this.height=s,this.nextRow=0,this.data=new Uint8Array(this.width*this.height),this.dashEntry={}};yt.prototype.getDash=function(n,s){var o=n.join(",")+String(s);return this.dashEntry[o]||(this.dashEntry[o]=this.addDash(n,s)),this.dashEntry[o]},yt.prototype.getDashRanges=function(n,s,o){var u=[],y=n.length%2==1?-n[n.length-1]*o:0,w=n[0]*o,k=!0;u.push({left:y,right:w,isDash:k,zeroLength:n[0]===0});for(var E=n[0],P=1;P<n.length;P++){var O=n[P];u.push({left:y=E*o,right:w=(E+=O)*o,isDash:k=!k,zeroLength:O===0})}return u},yt.prototype.addRoundDash=function(n,s,o){for(var u=s/2,y=-o;y<=o;y++)for(var w=this.width*(this.nextRow+o+y),k=0,E=n[k],P=0;P<this.width;P++){P/E.right>1&&(E=n[++k]);var O=Math.abs(P-E.left),Z=Math.abs(P-E.right),G=Math.min(O,Z),X=void 0,re=y/o*(u+1);if(E.isDash){var te=u-Math.abs(re);X=Math.sqrt(G*G+te*te)}else X=u-Math.sqrt(G*G+re*re);this.data[w+P]=Math.max(0,Math.min(255,X+128))}},yt.prototype.addRegularDash=function(n){for(var s=n.length-1;s>=0;--s){var o=n[s],u=n[s+1];o.zeroLength?n.splice(s,1):u&&u.isDash===o.isDash&&(u.left=o.left,n.splice(s,1))}var y=n[0],w=n[n.length-1];y.isDash===w.isDash&&(y.left=w.left-this.width,w.right=y.right+this.width);for(var k=this.width*this.nextRow,E=0,P=n[E],O=0;O<this.width;O++){O/P.right>1&&(P=n[++E]);var Z=Math.abs(O-P.left),G=Math.abs(O-P.right),X=Math.min(Z,G);this.data[k+O]=Math.max(0,Math.min(255,(P.isDash?X:-X)+128))}},yt.prototype.addDash=function(n,s){var o=s?7:0,u=2*o+1;if(this.nextRow+u>this.height)return a.warnOnce("LineAtlas out of space"),null;for(var y=0,w=0;w<n.length;w++)y+=n[w];if(y!==0){var k=this.width/y,E=this.getDashRanges(n,this.width,k);s?this.addRoundDash(E,k,o):this.addRegularDash(E)}var P={y:(this.nextRow+o+.5)/this.height,height:2*o/this.height,width:y};return this.nextRow+=u,this.dirty=!0,P},yt.prototype.bind=function(n){var s=n.gl;this.texture?(s.bindTexture(s.TEXTURE_2D,this.texture),this.dirty&&(this.dirty=!1,s.texSubImage2D(s.TEXTURE_2D,0,0,0,this.width,this.height,s.ALPHA,s.UNSIGNED_BYTE,this.data))):(this.texture=s.createTexture(),s.bindTexture(s.TEXTURE_2D,this.texture),s.texParameteri(s.TEXTURE_2D,s.TEXTURE_WRAP_S,s.REPEAT),s.texParameteri(s.TEXTURE_2D,s.TEXTURE_WRAP_T,s.REPEAT),s.texParameteri(s.TEXTURE_2D,s.TEXTURE_MIN_FILTER,s.LINEAR),s.texParameteri(s.TEXTURE_2D,s.TEXTURE_MAG_FILTER,s.LINEAR),s.texImage2D(s.TEXTURE_2D,0,s.ALPHA,this.width,this.height,0,s.ALPHA,s.UNSIGNED_BYTE,this.data))};var It=function n(s,o){this.workerPool=s,this.actors=[],this.currentActor=0,this.id=a.uniqueId();for(var u=this.workerPool.acquire(this.id),y=0;y<u.length;y++){var w=new n.Actor(u[y],o,this.id);w.name="Worker "+y,this.actors.push(w)}};function tt(n,s,o){var u=function(y,w){if(y)return o(y);if(w){var k=a.pick(a.extend(w,n),["tiles","minzoom","maxzoom","attribution","mapbox_logo","bounds","scheme","tileSize","encoding"]);w.vector_layers&&(k.vectorLayers=w.vector_layers,k.vectorLayerIds=k.vectorLayers.map(function(E){return E.id})),k.tiles=s.canonicalizeTileset(k,n.url),o(null,k)}};return n.url?a.getJSON(s.transformRequest(s.normalizeSourceURL(n.url),a.ResourceType.Source),u):a.browser.frame(function(){return u(null,n)})}It.prototype.broadcast=function(n,s,o){a.asyncAll(this.actors,function(u,y){u.send(n,s,y)},o=o||function(){})},It.prototype.getActor=function(){return this.currentActor=(this.currentActor+1)%this.actors.length,this.actors[this.currentActor]},It.prototype.remove=function(){this.actors.forEach(function(n){n.remove()}),this.actors=[],this.workerPool.release(this.id)},It.Actor=a.Actor;var Zt=function(n,s,o){this.bounds=a.LngLatBounds.convert(this.validateBounds(n)),this.minzoom=s||0,this.maxzoom=o||24};Zt.prototype.validateBounds=function(n){return Array.isArray(n)&&n.length===4?[Math.max(-180,n[0]),Math.max(-90,n[1]),Math.min(180,n[2]),Math.min(90,n[3])]:[-180,-90,180,90]},Zt.prototype.contains=function(n){var s=Math.pow(2,n.z),o=Math.floor(a.mercatorXfromLng(this.bounds.getWest())*s),u=Math.floor(a.mercatorYfromLat(this.bounds.getNorth())*s),y=Math.ceil(a.mercatorXfromLng(this.bounds.getEast())*s),w=Math.ceil(a.mercatorYfromLat(this.bounds.getSouth())*s);return n.x>=o&&n.x<y&&n.y>=u&&n.y<w};var pt=function(n){function s(o,u,y,w){if(n.call(this),this.id=o,this.dispatcher=y,this.type="vector",this.minzoom=0,this.maxzoom=22,this.scheme="xyz",this.tileSize=512,this.reparseOverscaled=!0,this.isTileClipped=!0,this._loaded=!1,a.extend(this,a.pick(u,["url","scheme","tileSize","promoteId"])),this._options=a.extend({type:"vector"},u),this._collectResourceTiming=u.collectResourceTiming,this.tileSize!==512)throw new Error("vector tile sources must have a tileSize of 512");this.setEventedParent(w)}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype.load=function(){var o=this;this._loaded=!1,this.fire(new a.Event("dataloading",{dataType:"source"})),this._tileJSONRequest=tt(this._options,this.map._requestManager,function(u,y){o._tileJSONRequest=null,o._loaded=!0,u?o.fire(new a.ErrorEvent(u)):y&&(a.extend(o,y),y.bounds&&(o.tileBounds=new Zt(y.bounds,o.minzoom,o.maxzoom)),a.postTurnstileEvent(y.tiles,o.map._requestManager._customAccessToken),a.postMapLoadEvent(y.tiles,o.map._getMapId(),o.map._requestManager._skuToken,o.map._requestManager._customAccessToken),o.fire(new a.Event("data",{dataType:"source",sourceDataType:"metadata"})),o.fire(new a.Event("data",{dataType:"source",sourceDataType:"content"})))})},s.prototype.loaded=function(){return this._loaded},s.prototype.hasTile=function(o){return!this.tileBounds||this.tileBounds.contains(o.canonical)},s.prototype.onAdd=function(o){this.map=o,this.load()},s.prototype.setSourceProperty=function(o){this._tileJSONRequest&&this._tileJSONRequest.cancel(),o(),this.map.style.sourceCaches[this.id].clearTiles(),this.load()},s.prototype.setTiles=function(o){var u=this;return this.setSourceProperty(function(){u._options.tiles=o}),this},s.prototype.setUrl=function(o){var u=this;return this.setSourceProperty(function(){u.url=o,u._options.url=o}),this},s.prototype.onRemove=function(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)},s.prototype.serialize=function(){return a.extend({},this._options)},s.prototype.loadTile=function(o,u){var y=this.map._requestManager.normalizeTileURL(o.tileID.canonical.url(this.tiles,this.scheme)),w={request:this.map._requestManager.transformRequest(y,a.ResourceType.Tile),uid:o.uid,tileID:o.tileID,zoom:o.tileID.overscaledZ,tileSize:this.tileSize*o.tileID.overscaleFactor(),type:this.type,source:this.id,pixelRatio:a.browser.devicePixelRatio,showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId};function k(E,P){return delete o.request,o.aborted?u(null):E&&E.status!==404?u(E):(P&&P.resourceTiming&&(o.resourceTiming=P.resourceTiming),this.map._refreshExpiredTiles&&P&&o.setExpiryData(P),o.loadVectorData(P,this.map.painter),a.cacheEntryPossiblyAdded(this.dispatcher),u(null),void(o.reloadCallback&&(this.loadTile(o,o.reloadCallback),o.reloadCallback=null)))}w.request.collectResourceTiming=this._collectResourceTiming,o.actor&&o.state!=="expired"?o.state==="loading"?o.reloadCallback=u:o.request=o.actor.send("reloadTile",w,k.bind(this)):(o.actor=this.dispatcher.getActor(),o.request=o.actor.send("loadTile",w,k.bind(this)))},s.prototype.abortTile=function(o){o.request&&(o.request.cancel(),delete o.request),o.actor&&o.actor.send("abortTile",{uid:o.uid,type:this.type,source:this.id},void 0)},s.prototype.unloadTile=function(o){o.unloadVectorData(),o.actor&&o.actor.send("removeTile",{uid:o.uid,type:this.type,source:this.id},void 0)},s.prototype.hasTransition=function(){return!1},s}(a.Evented),zt=function(n){function s(o,u,y,w){n.call(this),this.id=o,this.dispatcher=y,this.setEventedParent(w),this.type="raster",this.minzoom=0,this.maxzoom=22,this.roundZoom=!0,this.scheme="xyz",this.tileSize=512,this._loaded=!1,this._options=a.extend({type:"raster"},u),a.extend(this,a.pick(u,["url","scheme","tileSize"]))}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype.load=function(){var o=this;this._loaded=!1,this.fire(new a.Event("dataloading",{dataType:"source"})),this._tileJSONRequest=tt(this._options,this.map._requestManager,function(u,y){o._tileJSONRequest=null,o._loaded=!0,u?o.fire(new a.ErrorEvent(u)):y&&(a.extend(o,y),y.bounds&&(o.tileBounds=new Zt(y.bounds,o.minzoom,o.maxzoom)),a.postTurnstileEvent(y.tiles),a.postMapLoadEvent(y.tiles,o.map._getMapId(),o.map._requestManager._skuToken),o.fire(new a.Event("data",{dataType:"source",sourceDataType:"metadata"})),o.fire(new a.Event("data",{dataType:"source",sourceDataType:"content"})))})},s.prototype.loaded=function(){return this._loaded},s.prototype.onAdd=function(o){this.map=o,this.load()},s.prototype.onRemove=function(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)},s.prototype.serialize=function(){return a.extend({},this._options)},s.prototype.hasTile=function(o){return!this.tileBounds||this.tileBounds.contains(o.canonical)},s.prototype.loadTile=function(o,u){var y=this,w=this.map._requestManager.normalizeTileURL(o.tileID.canonical.url(this.tiles,this.scheme),this.tileSize);o.request=a.getImage(this.map._requestManager.transformRequest(w,a.ResourceType.Tile),function(k,E){if(delete o.request,o.aborted)o.state="unloaded",u(null);else if(k)o.state="errored",u(k);else if(E){y.map._refreshExpiredTiles&&o.setExpiryData(E),delete E.cacheControl,delete E.expires;var P=y.map.painter.context,O=P.gl;o.texture=y.map.painter.getTileTexture(E.width),o.texture?o.texture.update(E,{useMipmap:!0}):(o.texture=new a.Texture(P,E,O.RGBA,{useMipmap:!0}),o.texture.bind(O.LINEAR,O.CLAMP_TO_EDGE,O.LINEAR_MIPMAP_NEAREST),P.extTextureFilterAnisotropic&&O.texParameterf(O.TEXTURE_2D,P.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,P.extTextureFilterAnisotropicMax)),o.state="loaded",a.cacheEntryPossiblyAdded(y.dispatcher),u(null)}})},s.prototype.abortTile=function(o,u){o.request&&(o.request.cancel(),delete o.request),u()},s.prototype.unloadTile=function(o,u){o.texture&&this.map.painter.saveTileTexture(o.texture),u()},s.prototype.hasTransition=function(){return!1},s}(a.Evented),Ut=function(n){function s(o,u,y,w){n.call(this,o,u,y,w),this.type="raster-dem",this.maxzoom=22,this._options=a.extend({type:"raster-dem"},u),this.encoding=u.encoding||"mapbox"}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype.serialize=function(){return{type:"raster-dem",url:this.url,tileSize:this.tileSize,tiles:this.tiles,bounds:this.bounds,encoding:this.encoding}},s.prototype.loadTile=function(o,u){var y=this.map._requestManager.normalizeTileURL(o.tileID.canonical.url(this.tiles,this.scheme),this.tileSize);function w(k,E){k&&(o.state="errored",u(k)),E&&(o.dem=E,o.needsHillshadePrepare=!0,o.state="loaded",u(null))}o.request=a.getImage(this.map._requestManager.transformRequest(y,a.ResourceType.Tile),(function(k,E){if(delete o.request,o.aborted)o.state="unloaded",u(null);else if(k)o.state="errored",u(k);else if(E){this.map._refreshExpiredTiles&&o.setExpiryData(E),delete E.cacheControl,delete E.expires;var P=a.window.ImageBitmap&&E instanceof a.window.ImageBitmap&&a.offscreenCanvasSupported()?E:a.browser.getImageData(E,1),O={uid:o.uid,coord:o.tileID,source:this.id,rawImageData:P,encoding:this.encoding};o.actor&&o.state!=="expired"||(o.actor=this.dispatcher.getActor(),o.actor.send("loadDEMTile",O,w.bind(this)))}}).bind(this)),o.neighboringTiles=this._getNeighboringTiles(o.tileID)},s.prototype._getNeighboringTiles=function(o){var u=o.canonical,y=Math.pow(2,u.z),w=(u.x-1+y)%y,k=u.x===0?o.wrap-1:o.wrap,E=(u.x+1+y)%y,P=u.x+1===y?o.wrap+1:o.wrap,O={};return O[new a.OverscaledTileID(o.overscaledZ,k,u.z,w,u.y).key]={backfilled:!1},O[new a.OverscaledTileID(o.overscaledZ,P,u.z,E,u.y).key]={backfilled:!1},u.y>0&&(O[new a.OverscaledTileID(o.overscaledZ,k,u.z,w,u.y-1).key]={backfilled:!1},O[new a.OverscaledTileID(o.overscaledZ,o.wrap,u.z,u.x,u.y-1).key]={backfilled:!1},O[new a.OverscaledTileID(o.overscaledZ,P,u.z,E,u.y-1).key]={backfilled:!1}),u.y+1<y&&(O[new a.OverscaledTileID(o.overscaledZ,k,u.z,w,u.y+1).key]={backfilled:!1},O[new a.OverscaledTileID(o.overscaledZ,o.wrap,u.z,u.x,u.y+1).key]={backfilled:!1},O[new a.OverscaledTileID(o.overscaledZ,P,u.z,E,u.y+1).key]={backfilled:!1}),O},s.prototype.unloadTile=function(o){o.demTexture&&this.map.painter.saveTileTexture(o.demTexture),o.fbo&&(o.fbo.destroy(),delete o.fbo),o.dem&&delete o.dem,delete o.neighboringTiles,o.state="unloaded",o.actor&&o.actor.send("removeDEMTile",{uid:o.uid,source:this.id})},s}(zt),ei=function(n){function s(o,u,y,w){n.call(this),this.id=o,this.type="geojson",this.minzoom=0,this.maxzoom=18,this.tileSize=512,this.isTileClipped=!0,this.reparseOverscaled=!0,this._removed=!1,this._loaded=!1,this.actor=y.getActor(),this.setEventedParent(w),this._data=u.data,this._options=a.extend({},u),this._collectResourceTiming=u.collectResourceTiming,this._resourceTiming=[],u.maxzoom!==void 0&&(this.maxzoom=u.maxzoom),u.type&&(this.type=u.type),u.attribution&&(this.attribution=u.attribution),this.promoteId=u.promoteId;var k=a.EXTENT/this.tileSize;this.workerOptions=a.extend({source:this.id,cluster:u.cluster||!1,geojsonVtOptions:{buffer:(u.buffer!==void 0?u.buffer:128)*k,tolerance:(u.tolerance!==void 0?u.tolerance:.375)*k,extent:a.EXTENT,maxZoom:this.maxzoom,lineMetrics:u.lineMetrics||!1,generateId:u.generateId||!1},superclusterOptions:{maxZoom:u.clusterMaxZoom!==void 0?Math.min(u.clusterMaxZoom,this.maxzoom-1):this.maxzoom-1,minPoints:Math.max(2,u.clusterMinPoints||2),extent:a.EXTENT,radius:(u.clusterRadius||50)*k,log:!1,generateId:u.generateId||!1},clusterProperties:u.clusterProperties,filter:u.filter},u.workerOptions)}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype.load=function(){var o=this;this.fire(new a.Event("dataloading",{dataType:"source"})),this._updateWorkerData(function(u){if(u)o.fire(new a.ErrorEvent(u));else{var y={dataType:"source",sourceDataType:"metadata"};o._collectResourceTiming&&o._resourceTiming&&o._resourceTiming.length>0&&(y.resourceTiming=o._resourceTiming,o._resourceTiming=[]),o.fire(new a.Event("data",y))}})},s.prototype.onAdd=function(o){this.map=o,this.load()},s.prototype.setData=function(o){var u=this;return this._data=o,this.fire(new a.Event("dataloading",{dataType:"source"})),this._updateWorkerData(function(y){if(y)u.fire(new a.ErrorEvent(y));else{var w={dataType:"source",sourceDataType:"content"};u._collectResourceTiming&&u._resourceTiming&&u._resourceTiming.length>0&&(w.resourceTiming=u._resourceTiming,u._resourceTiming=[]),u.fire(new a.Event("data",w))}}),this},s.prototype.getClusterExpansionZoom=function(o,u){return this.actor.send("geojson.getClusterExpansionZoom",{clusterId:o,source:this.id},u),this},s.prototype.getClusterChildren=function(o,u){return this.actor.send("geojson.getClusterChildren",{clusterId:o,source:this.id},u),this},s.prototype.getClusterLeaves=function(o,u,y,w){return this.actor.send("geojson.getClusterLeaves",{source:this.id,clusterId:o,limit:u,offset:y},w),this},s.prototype._updateWorkerData=function(o){var u=this;this._loaded=!1;var y=a.extend({},this.workerOptions),w=this._data;typeof w=="string"?(y.request=this.map._requestManager.transformRequest(a.browser.resolveURL(w),a.ResourceType.Source),y.request.collectResourceTiming=this._collectResourceTiming):y.data=JSON.stringify(w),this.actor.send(this.type+".loadData",y,function(k,E){u._removed||E&&E.abandoned||(u._loaded=!0,E&&E.resourceTiming&&E.resourceTiming[u.id]&&(u._resourceTiming=E.resourceTiming[u.id].slice(0)),u.actor.send(u.type+".coalesce",{source:y.source},null),o(k))})},s.prototype.loaded=function(){return this._loaded},s.prototype.loadTile=function(o,u){var y=this,w=o.actor?"reloadTile":"loadTile";o.actor=this.actor,o.request=this.actor.send(w,{type:this.type,uid:o.uid,tileID:o.tileID,zoom:o.tileID.overscaledZ,maxZoom:this.maxzoom,tileSize:this.tileSize,source:this.id,pixelRatio:a.browser.devicePixelRatio,showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId},function(k,E){return delete o.request,o.unloadVectorData(),o.aborted?u(null):k?u(k):(o.loadVectorData(E,y.map.painter,w==="reloadTile"),u(null))})},s.prototype.abortTile=function(o){o.request&&(o.request.cancel(),delete o.request),o.aborted=!0},s.prototype.unloadTile=function(o){o.unloadVectorData(),this.actor.send("removeTile",{uid:o.uid,type:this.type,source:this.id})},s.prototype.onRemove=function(){this._removed=!0,this.actor.send("removeSource",{type:this.type,source:this.id})},s.prototype.serialize=function(){return a.extend({},this._options,{type:this.type,data:this._data})},s.prototype.hasTransition=function(){return!1},s}(a.Evented),Je=a.createLayout([{name:"a_pos",type:"Int16",components:2},{name:"a_texture_pos",type:"Int16",components:2}]),At=function(n){function s(o,u,y,w){n.call(this),this.id=o,this.dispatcher=y,this.coordinates=u.coordinates,this.type="image",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this.tiles={},this._loaded=!1,this.setEventedParent(w),this.options=u}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype.load=function(o,u){var y=this;this._loaded=!1,this.fire(new a.Event("dataloading",{dataType:"source"})),this.url=this.options.url,a.getImage(this.map._requestManager.transformRequest(this.url,a.ResourceType.Image),function(w,k){y._loaded=!0,w?y.fire(new a.ErrorEvent(w)):k&&(y.image=k,o&&(y.coordinates=o),u&&u(),y._finishLoading())})},s.prototype.loaded=function(){return this._loaded},s.prototype.updateImage=function(o){var u=this;return this.image&&o.url?(this.options.url=o.url,this.load(o.coordinates,function(){u.texture=null}),this):this},s.prototype._finishLoading=function(){this.map&&(this.setCoordinates(this.coordinates),this.fire(new a.Event("data",{dataType:"source",sourceDataType:"metadata"})))},s.prototype.onAdd=function(o){this.map=o,this.load()},s.prototype.setCoordinates=function(o){var u=this;this.coordinates=o;var y=o.map(a.MercatorCoordinate.fromLngLat);this.tileID=function(k){for(var E=1/0,P=1/0,O=-1/0,Z=-1/0,G=0,X=k;G<X.length;G+=1){var re=X[G];E=Math.min(E,re.x),P=Math.min(P,re.y),O=Math.max(O,re.x),Z=Math.max(Z,re.y)}var te=Math.max(O-E,Z-P),ue=Math.max(0,Math.floor(-Math.log(te)/Math.LN2)),Y=Math.pow(2,ue);return new a.CanonicalTileID(ue,Math.floor((E+O)/2*Y),Math.floor((P+Z)/2*Y))}(y),this.minzoom=this.maxzoom=this.tileID.z;var w=y.map(function(k){return u.tileID.getTilePoint(k)._round()});return this._boundsArray=new a.StructArrayLayout4i8,this._boundsArray.emplaceBack(w[0].x,w[0].y,0,0),this._boundsArray.emplaceBack(w[1].x,w[1].y,a.EXTENT,0),this._boundsArray.emplaceBack(w[3].x,w[3].y,0,a.EXTENT),this._boundsArray.emplaceBack(w[2].x,w[2].y,a.EXTENT,a.EXTENT),this.boundsBuffer&&(this.boundsBuffer.destroy(),delete this.boundsBuffer),this.fire(new a.Event("data",{dataType:"source",sourceDataType:"content"})),this},s.prototype.prepare=function(){if(Object.keys(this.tiles).length!==0&&this.image){var o=this.map.painter.context,u=o.gl;for(var y in this.boundsBuffer||(this.boundsBuffer=o.createVertexBuffer(this._boundsArray,Je.members)),this.boundsSegments||(this.boundsSegments=a.SegmentVector.simpleSegment(0,0,4,2)),this.texture||(this.texture=new a.Texture(o,this.image,u.RGBA),this.texture.bind(u.LINEAR,u.CLAMP_TO_EDGE)),this.tiles){var w=this.tiles[y];w.state!=="loaded"&&(w.state="loaded",w.texture=this.texture)}}},s.prototype.loadTile=function(o,u){this.tileID&&this.tileID.equals(o.tileID.canonical)?(this.tiles[String(o.tileID.wrap)]=o,o.buckets={},u(null)):(o.state="errored",u(null))},s.prototype.serialize=function(){return{type:"image",url:this.options.url,coordinates:this.coordinates}},s.prototype.hasTransition=function(){return!1},s}(a.Evented),pr=function(n){function s(o,u,y,w){n.call(this,o,u,y,w),this.roundZoom=!0,this.type="video",this.options=u}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype.load=function(){var o=this;this._loaded=!1;var u=this.options;this.urls=[];for(var y=0,w=u.urls;y<w.length;y+=1)this.urls.push(this.map._requestManager.transformRequest(w[y],a.ResourceType.Source).url);a.getVideo(this.urls,function(k,E){o._loaded=!0,k?o.fire(new a.ErrorEvent(k)):E&&(o.video=E,o.video.loop=!0,o.video.addEventListener("playing",function(){o.map.triggerRepaint()}),o.map&&o.video.play(),o._finishLoading())})},s.prototype.pause=function(){this.video&&this.video.pause()},s.prototype.play=function(){this.video&&this.video.play()},s.prototype.seek=function(o){if(this.video){var u=this.video.seekable;o<u.start(0)||o>u.end(0)?this.fire(new a.ErrorEvent(new a.ValidationError("sources."+this.id,null,"Playback for this video can be set only between the "+u.start(0)+" and "+u.end(0)+"-second mark."))):this.video.currentTime=o}},s.prototype.getVideo=function(){return this.video},s.prototype.onAdd=function(o){this.map||(this.map=o,this.load(),this.video&&(this.video.play(),this.setCoordinates(this.coordinates)))},s.prototype.prepare=function(){if(!(Object.keys(this.tiles).length===0||this.video.readyState<2)){var o=this.map.painter.context,u=o.gl;for(var y in this.boundsBuffer||(this.boundsBuffer=o.createVertexBuffer(this._boundsArray,Je.members)),this.boundsSegments||(this.boundsSegments=a.SegmentVector.simpleSegment(0,0,4,2)),this.texture?this.video.paused||(this.texture.bind(u.LINEAR,u.CLAMP_TO_EDGE),u.texSubImage2D(u.TEXTURE_2D,0,0,0,u.RGBA,u.UNSIGNED_BYTE,this.video)):(this.texture=new a.Texture(o,this.video,u.RGBA),this.texture.bind(u.LINEAR,u.CLAMP_TO_EDGE)),this.tiles){var w=this.tiles[y];w.state!=="loaded"&&(w.state="loaded",w.texture=this.texture)}}},s.prototype.serialize=function(){return{type:"video",urls:this.urls,coordinates:this.coordinates}},s.prototype.hasTransition=function(){return this.video&&!this.video.paused},s}(At),Fr=function(n){function s(o,u,y,w){n.call(this,o,u,y,w),u.coordinates?Array.isArray(u.coordinates)&&u.coordinates.length===4&&!u.coordinates.some(function(k){return!Array.isArray(k)||k.length!==2||k.some(function(E){return typeof E!="number"})})||this.fire(new a.ErrorEvent(new a.ValidationError("sources."+o,null,'"coordinates" property must be an array of 4 longitude/latitude array pairs'))):this.fire(new a.ErrorEvent(new a.ValidationError("sources."+o,null,'missing required property "coordinates"'))),u.animate&&typeof u.animate!="boolean"&&this.fire(new a.ErrorEvent(new a.ValidationError("sources."+o,null,'optional "animate" property must be a boolean value'))),u.canvas?typeof u.canvas=="string"||u.canvas instanceof a.window.HTMLCanvasElement||this.fire(new a.ErrorEvent(new a.ValidationError("sources."+o,null,'"canvas" must be either a string representing the ID of the canvas element from which to read, or an HTMLCanvasElement instance'))):this.fire(new a.ErrorEvent(new a.ValidationError("sources."+o,null,'missing required property "canvas"'))),this.options=u,this.animate=u.animate===void 0||u.animate}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype.load=function(){this._loaded=!0,this.canvas||(this.canvas=this.options.canvas instanceof a.window.HTMLCanvasElement?this.options.canvas:a.window.document.getElementById(this.options.canvas)),this.width=this.canvas.width,this.height=this.canvas.height,this._hasInvalidDimensions()?this.fire(new a.ErrorEvent(new Error("Canvas dimensions cannot be less than or equal to zero."))):(this.play=function(){this._playing=!0,this.map.triggerRepaint()},this.pause=function(){this._playing&&(this.prepare(),this._playing=!1)},this._finishLoading())},s.prototype.getCanvas=function(){return this.canvas},s.prototype.onAdd=function(o){this.map=o,this.load(),this.canvas&&this.animate&&this.play()},s.prototype.onRemove=function(){this.pause()},s.prototype.prepare=function(){var o=!1;if(this.canvas.width!==this.width&&(this.width=this.canvas.width,o=!0),this.canvas.height!==this.height&&(this.height=this.canvas.height,o=!0),!this._hasInvalidDimensions()&&Object.keys(this.tiles).length!==0){var u=this.map.painter.context,y=u.gl;for(var w in this.boundsBuffer||(this.boundsBuffer=u.createVertexBuffer(this._boundsArray,Je.members)),this.boundsSegments||(this.boundsSegments=a.SegmentVector.simpleSegment(0,0,4,2)),this.texture?(o||this._playing)&&this.texture.update(this.canvas,{premultiply:!0}):this.texture=new a.Texture(u,this.canvas,y.RGBA,{premultiply:!0}),this.tiles){var k=this.tiles[w];k.state!=="loaded"&&(k.state="loaded",k.texture=this.texture)}}},s.prototype.serialize=function(){return{type:"canvas",coordinates:this.coordinates}},s.prototype.hasTransition=function(){return this._playing},s.prototype._hasInvalidDimensions=function(){for(var o=0,u=[this.canvas.width,this.canvas.height];o<u.length;o+=1){var y=u[o];if(isNaN(y)||y<=0)return!0}return!1},s}(At),Mr={vector:pt,raster:zt,"raster-dem":Ut,geojson:ei,video:pr,image:At,canvas:Fr};function Zr(n,s){var o=a.identity([]);return a.translate(o,o,[1,1,0]),a.scale(o,o,[.5*n.width,.5*n.height,1]),a.multiply(o,o,n.calculatePosMatrix(s.toUnwrapped()))}function sr(n,s,o,u,y,w){var k=function(ue,Y,le){if(ue)for(var pe=0,ge=ue;pe<ge.length;pe+=1){var ze=Y[ge[pe]];if(ze&&ze.source===le&&ze.type==="fill-extrusion")return!0}else for(var Te in Y){var Ae=Y[Te];if(Ae.source===le&&Ae.type==="fill-extrusion")return!0}return!1}(y&&y.layers,s,n.id),E=w.maxPitchScaleFactor(),P=n.tilesIn(u,E,k);P.sort(ti);for(var O=[],Z=0,G=P;Z<G.length;Z+=1){var X=G[Z];O.push({wrappedTileID:X.tileID.wrapped().key,queryResults:X.tile.queryRenderedFeatures(s,o,n._state,X.queryGeometry,X.cameraQueryGeometry,X.scale,y,w,E,Zr(n.transform,X.tileID))})}var re=function(ue){for(var Y={},le={},pe=0,ge=ue;pe<ge.length;pe+=1){var ze=ge[pe],Te=ze.queryResults,Ae=ze.wrappedTileID,Re=le[Ae]=le[Ae]||{};for(var Xe in Te)for(var Ge=Te[Xe],at=Re[Xe]=Re[Xe]||{},vt=Y[Xe]=Y[Xe]||[],kt=0,wt=Ge;kt<wt.length;kt+=1){var _r=wt[kt];at[_r.featureIndex]||(at[_r.featureIndex]=!0,vt.push(_r))}}return Y}(O);for(var te in re)re[te].forEach(function(ue){var Y=ue.feature,le=n.getFeatureState(Y.layer["source-layer"],Y.id);Y.source=Y.layer.source,Y.layer["source-layer"]&&(Y.sourceLayer=Y.layer["source-layer"]),Y.state=le});return re}function ti(n,s){var o=n.tileID,u=s.tileID;return o.overscaledZ-u.overscaledZ||o.canonical.y-u.canonical.y||o.wrap-u.wrap||o.canonical.x-u.canonical.x}var Wt=function(n,s){this.max=n,this.onRemove=s,this.reset()};Wt.prototype.reset=function(){for(var n in this.data)for(var s=0,o=this.data[n];s<o.length;s+=1){var u=o[s];u.timeout&&clearTimeout(u.timeout),this.onRemove(u.value)}return this.data={},this.order=[],this},Wt.prototype.add=function(n,s,o){var u=this,y=n.wrapped().key;this.data[y]===void 0&&(this.data[y]=[]);var w={value:s,timeout:void 0};if(o!==void 0&&(w.timeout=setTimeout(function(){u.remove(n,w)},o)),this.data[y].push(w),this.order.push(y),this.order.length>this.max){var k=this._getAndRemoveByKey(this.order[0]);k&&this.onRemove(k)}return this},Wt.prototype.has=function(n){return n.wrapped().key in this.data},Wt.prototype.getAndRemove=function(n){return this.has(n)?this._getAndRemoveByKey(n.wrapped().key):null},Wt.prototype._getAndRemoveByKey=function(n){var s=this.data[n].shift();return s.timeout&&clearTimeout(s.timeout),this.data[n].length===0&&delete this.data[n],this.order.splice(this.order.indexOf(n),1),s.value},Wt.prototype.getByKey=function(n){var s=this.data[n];return s?s[0].value:null},Wt.prototype.get=function(n){return this.has(n)?this.data[n.wrapped().key][0].value:null},Wt.prototype.remove=function(n,s){if(!this.has(n))return this;var o=n.wrapped().key,u=s===void 0?0:this.data[o].indexOf(s),y=this.data[o][u];return this.data[o].splice(u,1),y.timeout&&clearTimeout(y.timeout),this.data[o].length===0&&delete this.data[o],this.onRemove(y.value),this.order.splice(this.order.indexOf(o),1),this},Wt.prototype.setMaxSize=function(n){for(this.max=n;this.order.length>this.max;){var s=this._getAndRemoveByKey(this.order[0]);s&&this.onRemove(s)}return this},Wt.prototype.filter=function(n){var s=[];for(var o in this.data)for(var u=0,y=this.data[o];u<y.length;u+=1){var w=y[u];n(w.value)||s.push(w)}for(var k=0,E=s;k<E.length;k+=1){var P=E[k];this.remove(P.value.tileID,P)}};var Gr=function(n,s,o){this.context=n;var u=n.gl;this.buffer=u.createBuffer(),this.dynamicDraw=!!o,this.context.unbindVAO(),n.bindElementBuffer.set(this.buffer),u.bufferData(u.ELEMENT_ARRAY_BUFFER,s.arrayBuffer,this.dynamicDraw?u.DYNAMIC_DRAW:u.STATIC_DRAW),this.dynamicDraw||delete s.arrayBuffer};Gr.prototype.bind=function(){this.context.bindElementBuffer.set(this.buffer)},Gr.prototype.updateData=function(n){var s=this.context.gl;this.context.unbindVAO(),this.bind(),s.bufferSubData(s.ELEMENT_ARRAY_BUFFER,0,n.arrayBuffer)},Gr.prototype.destroy=function(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)};var mr={Int8:"BYTE",Uint8:"UNSIGNED_BYTE",Int16:"SHORT",Uint16:"UNSIGNED_SHORT",Int32:"INT",Uint32:"UNSIGNED_INT",Float32:"FLOAT"},Nr=function(n,s,o,u){this.length=s.length,this.attributes=o,this.itemSize=s.bytesPerElement,this.dynamicDraw=u,this.context=n;var y=n.gl;this.buffer=y.createBuffer(),n.bindVertexBuffer.set(this.buffer),y.bufferData(y.ARRAY_BUFFER,s.arrayBuffer,this.dynamicDraw?y.DYNAMIC_DRAW:y.STATIC_DRAW),this.dynamicDraw||delete s.arrayBuffer};Nr.prototype.bind=function(){this.context.bindVertexBuffer.set(this.buffer)},Nr.prototype.updateData=function(n){var s=this.context.gl;this.bind(),s.bufferSubData(s.ARRAY_BUFFER,0,n.arrayBuffer)},Nr.prototype.enableAttributes=function(n,s){for(var o=0;o<this.attributes.length;o++){var u=s.attributes[this.attributes[o].name];u!==void 0&&n.enableVertexAttribArray(u)}},Nr.prototype.setVertexAttribPointers=function(n,s,o){for(var u=0;u<this.attributes.length;u++){var y=this.attributes[u],w=s.attributes[y.name];w!==void 0&&n.vertexAttribPointer(w,y.components,n[mr[y.type]],!1,this.itemSize,y.offset+this.itemSize*(o||0))}},Nr.prototype.destroy=function(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)};var jt=function(n){this.gl=n.gl,this.default=this.getDefault(),this.current=this.default,this.dirty=!1};jt.prototype.get=function(){return this.current},jt.prototype.set=function(n){},jt.prototype.getDefault=function(){return this.default},jt.prototype.setDefault=function(){this.set(this.default)};var Dr=function(n){function s(){n.apply(this,arguments)}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype.getDefault=function(){return a.Color.transparent},s.prototype.set=function(o){var u=this.current;(o.r!==u.r||o.g!==u.g||o.b!==u.b||o.a!==u.a||this.dirty)&&(this.gl.clearColor(o.r,o.g,o.b,o.a),this.current=o,this.dirty=!1)},s}(jt),Kr=function(n){function s(){n.apply(this,arguments)}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype.getDefault=function(){return 1},s.prototype.set=function(o){(o!==this.current||this.dirty)&&(this.gl.clearDepth(o),this.current=o,this.dirty=!1)},s}(jt),cr=function(n){function s(){n.apply(this,arguments)}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype.getDefault=function(){return 0},s.prototype.set=function(o){(o!==this.current||this.dirty)&&(this.gl.clearStencil(o),this.current=o,this.dirty=!1)},s}(jt),Fi=function(n){function s(){n.apply(this,arguments)}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype.getDefault=function(){return[!0,!0,!0,!0]},s.prototype.set=function(o){var u=this.current;(o[0]!==u[0]||o[1]!==u[1]||o[2]!==u[2]||o[3]!==u[3]||this.dirty)&&(this.gl.colorMask(o[0],o[1],o[2],o[3]),this.current=o,this.dirty=!1)},s}(jt),Ar=function(n){function s(){n.apply(this,arguments)}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype.getDefault=function(){return!0},s.prototype.set=function(o){(o!==this.current||this.dirty)&&(this.gl.depthMask(o),this.current=o,this.dirty=!1)},s}(jt),bi=function(n){function s(){n.apply(this,arguments)}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype.getDefault=function(){return 255},s.prototype.set=function(o){(o!==this.current||this.dirty)&&(this.gl.stencilMask(o),this.current=o,this.dirty=!1)},s}(jt),pi=function(n){function s(){n.apply(this,arguments)}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype.getDefault=function(){return{func:this.gl.ALWAYS,ref:0,mask:255}},s.prototype.set=function(o){var u=this.current;(o.func!==u.func||o.ref!==u.ref||o.mask!==u.mask||this.dirty)&&(this.gl.stencilFunc(o.func,o.ref,o.mask),this.current=o,this.dirty=!1)},s}(jt),Qi=function(n){function s(){n.apply(this,arguments)}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype.getDefault=function(){var o=this.gl;return[o.KEEP,o.KEEP,o.KEEP]},s.prototype.set=function(o){var u=this.current;(o[0]!==u[0]||o[1]!==u[1]||o[2]!==u[2]||this.dirty)&&(this.gl.stencilOp(o[0],o[1],o[2]),this.current=o,this.dirty=!1)},s}(jt),Mi=function(n){function s(){n.apply(this,arguments)}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype.getDefault=function(){return!1},s.prototype.set=function(o){if(o!==this.current||this.dirty){var u=this.gl;o?u.enable(u.STENCIL_TEST):u.disable(u.STENCIL_TEST),this.current=o,this.dirty=!1}},s}(jt),fi=function(n){function s(){n.apply(this,arguments)}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype.getDefault=function(){return[0,1]},s.prototype.set=function(o){var u=this.current;(o[0]!==u[0]||o[1]!==u[1]||this.dirty)&&(this.gl.depthRange(o[0],o[1]),this.current=o,this.dirty=!1)},s}(jt),ri=function(n){function s(){n.apply(this,arguments)}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype.getDefault=function(){return!1},s.prototype.set=function(o){if(o!==this.current||this.dirty){var u=this.gl;o?u.enable(u.DEPTH_TEST):u.disable(u.DEPTH_TEST),this.current=o,this.dirty=!1}},s}(jt),sn=function(n){function s(){n.apply(this,arguments)}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype.getDefault=function(){return this.gl.LESS},s.prototype.set=function(o){(o!==this.current||this.dirty)&&(this.gl.depthFunc(o),this.current=o,this.dirty=!1)},s}(jt),di=function(n){function s(){n.apply(this,arguments)}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype.getDefault=function(){return!1},s.prototype.set=function(o){if(o!==this.current||this.dirty){var u=this.gl;o?u.enable(u.BLEND):u.disable(u.BLEND),this.current=o,this.dirty=!1}},s}(jt),Ur=function(n){function s(){n.apply(this,arguments)}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype.getDefault=function(){var o=this.gl;return[o.ONE,o.ZERO]},s.prototype.set=function(o){var u=this.current;(o[0]!==u[0]||o[1]!==u[1]||this.dirty)&&(this.gl.blendFunc(o[0],o[1]),this.current=o,this.dirty=!1)},s}(jt),$i=function(n){function s(){n.apply(this,arguments)}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype.getDefault=function(){return a.Color.transparent},s.prototype.set=function(o){var u=this.current;(o.r!==u.r||o.g!==u.g||o.b!==u.b||o.a!==u.a||this.dirty)&&(this.gl.blendColor(o.r,o.g,o.b,o.a),this.current=o,this.dirty=!1)},s}(jt),Ln=function(n){function s(){n.apply(this,arguments)}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype.getDefault=function(){return this.gl.FUNC_ADD},s.prototype.set=function(o){(o!==this.current||this.dirty)&&(this.gl.blendEquation(o),this.current=o,this.dirty=!1)},s}(jt),Ni=function(n){function s(){n.apply(this,arguments)}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype.getDefault=function(){return!1},s.prototype.set=function(o){if(o!==this.current||this.dirty){var u=this.gl;o?u.enable(u.CULL_FACE):u.disable(u.CULL_FACE),this.current=o,this.dirty=!1}},s}(jt),zn=function(n){function s(){n.apply(this,arguments)}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype.getDefault=function(){return this.gl.BACK},s.prototype.set=function(o){(o!==this.current||this.dirty)&&(this.gl.cullFace(o),this.current=o,this.dirty=!1)},s}(jt),en=function(n){function s(){n.apply(this,arguments)}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype.getDefault=function(){return this.gl.CCW},s.prototype.set=function(o){(o!==this.current||this.dirty)&&(this.gl.frontFace(o),this.current=o,this.dirty=!1)},s}(jt),An=function(n){function s(){n.apply(this,arguments)}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype.getDefault=function(){return null},s.prototype.set=function(o){(o!==this.current||this.dirty)&&(this.gl.useProgram(o),this.current=o,this.dirty=!1)},s}(jt),Ui=function(n){function s(){n.apply(this,arguments)}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype.getDefault=function(){return this.gl.TEXTURE0},s.prototype.set=function(o){(o!==this.current||this.dirty)&&(this.gl.activeTexture(o),this.current=o,this.dirty=!1)},s}(jt),gn=function(n){function s(){n.apply(this,arguments)}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype.getDefault=function(){var o=this.gl;return[0,0,o.drawingBufferWidth,o.drawingBufferHeight]},s.prototype.set=function(o){var u=this.current;(o[0]!==u[0]||o[1]!==u[1]||o[2]!==u[2]||o[3]!==u[3]||this.dirty)&&(this.gl.viewport(o[0],o[1],o[2],o[3]),this.current=o,this.dirty=!1)},s}(jt),Vi=function(n){function s(){n.apply(this,arguments)}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype.getDefault=function(){return null},s.prototype.set=function(o){if(o!==this.current||this.dirty){var u=this.gl;u.bindFramebuffer(u.FRAMEBUFFER,o),this.current=o,this.dirty=!1}},s}(jt),Rn=function(n){function s(){n.apply(this,arguments)}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype.getDefault=function(){return null},s.prototype.set=function(o){if(o!==this.current||this.dirty){var u=this.gl;u.bindRenderbuffer(u.RENDERBUFFER,o),this.current=o,this.dirty=!1}},s}(jt),tn=function(n){function s(){n.apply(this,arguments)}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype.getDefault=function(){return null},s.prototype.set=function(o){if(o!==this.current||this.dirty){var u=this.gl;u.bindTexture(u.TEXTURE_2D,o),this.current=o,this.dirty=!1}},s}(jt),ji=function(n){function s(){n.apply(this,arguments)}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype.getDefault=function(){return null},s.prototype.set=function(o){if(o!==this.current||this.dirty){var u=this.gl;u.bindBuffer(u.ARRAY_BUFFER,o),this.current=o,this.dirty=!1}},s}(jt),vn=function(n){function s(){n.apply(this,arguments)}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype.getDefault=function(){return null},s.prototype.set=function(o){var u=this.gl;u.bindBuffer(u.ELEMENT_ARRAY_BUFFER,o),this.current=o,this.dirty=!1},s}(jt),ln=function(n){function s(o){n.call(this,o),this.vao=o.extVertexArrayObject}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype.getDefault=function(){return null},s.prototype.set=function(o){this.vao&&(o!==this.current||this.dirty)&&(this.vao.bindVertexArrayOES(o),this.current=o,this.dirty=!1)},s}(jt),un=function(n){function s(){n.apply(this,arguments)}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype.getDefault=function(){return 4},s.prototype.set=function(o){if(o!==this.current||this.dirty){var u=this.gl;u.pixelStorei(u.UNPACK_ALIGNMENT,o),this.current=o,this.dirty=!1}},s}(jt),bn=function(n){function s(){n.apply(this,arguments)}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype.getDefault=function(){return!1},s.prototype.set=function(o){if(o!==this.current||this.dirty){var u=this.gl;u.pixelStorei(u.UNPACK_PREMULTIPLY_ALPHA_WEBGL,o),this.current=o,this.dirty=!1}},s}(jt),oi=function(n){function s(){n.apply(this,arguments)}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype.getDefault=function(){return!1},s.prototype.set=function(o){if(o!==this.current||this.dirty){var u=this.gl;u.pixelStorei(u.UNPACK_FLIP_Y_WEBGL,o),this.current=o,this.dirty=!1}},s}(jt),Pr=function(n){function s(o,u){n.call(this,o),this.context=o,this.parent=u}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype.getDefault=function(){return null},s}(jt),L=function(n){function s(){n.apply(this,arguments)}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype.setDirty=function(){this.dirty=!0},s.prototype.set=function(o){if(o!==this.current||this.dirty){this.context.bindFramebuffer.set(this.parent);var u=this.gl;u.framebufferTexture2D(u.FRAMEBUFFER,u.COLOR_ATTACHMENT0,u.TEXTURE_2D,o,0),this.current=o,this.dirty=!1}},s}(Pr),N=function(n){function s(){n.apply(this,arguments)}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype.set=function(o){if(o!==this.current||this.dirty){this.context.bindFramebuffer.set(this.parent);var u=this.gl;u.framebufferRenderbuffer(u.FRAMEBUFFER,u.DEPTH_ATTACHMENT,u.RENDERBUFFER,o),this.current=o,this.dirty=!1}},s}(Pr),V=function(n,s,o,u){this.context=n,this.width=s,this.height=o;var y=this.framebuffer=n.gl.createFramebuffer();this.colorAttachment=new L(n,y),u&&(this.depthAttachment=new N(n,y))};V.prototype.destroy=function(){var n=this.context.gl,s=this.colorAttachment.get();if(s&&n.deleteTexture(s),this.depthAttachment){var o=this.depthAttachment.get();o&&n.deleteRenderbuffer(o)}n.deleteFramebuffer(this.framebuffer)};var W=function(n,s,o){this.func=n,this.mask=s,this.range=o};W.ReadOnly=!1,W.ReadWrite=!0,W.disabled=new W(519,W.ReadOnly,[0,1]);var $=function(n,s,o,u,y,w){this.test=n,this.ref=s,this.mask=o,this.fail=u,this.depthFail=y,this.pass=w};$.disabled=new $({func:519,mask:0},0,0,7680,7680,7680);var se=function(n,s,o){this.blendFunction=n,this.blendColor=s,this.mask=o};se.disabled=new se(se.Replace=[1,0],a.Color.transparent,[!1,!1,!1,!1]),se.unblended=new se(se.Replace,a.Color.transparent,[!0,!0,!0,!0]),se.alphaBlended=new se([1,771],a.Color.transparent,[!0,!0,!0,!0]);var he=function(n,s,o){this.enable=n,this.mode=s,this.frontFace=o};he.disabled=new he(!1,1029,2305),he.backCCW=new he(!0,1029,2305);var j=function(n){this.gl=n,this.extVertexArrayObject=this.gl.getExtension("OES_vertex_array_object"),this.clearColor=new Dr(this),this.clearDepth=new Kr(this),this.clearStencil=new cr(this),this.colorMask=new Fi(this),this.depthMask=new Ar(this),this.stencilMask=new bi(this),this.stencilFunc=new pi(this),this.stencilOp=new Qi(this),this.stencilTest=new Mi(this),this.depthRange=new fi(this),this.depthTest=new ri(this),this.depthFunc=new sn(this),this.blend=new di(this),this.blendFunc=new Ur(this),this.blendColor=new $i(this),this.blendEquation=new Ln(this),this.cullFace=new Ni(this),this.cullFaceSide=new zn(this),this.frontFace=new en(this),this.program=new An(this),this.activeTexture=new Ui(this),this.viewport=new gn(this),this.bindFramebuffer=new Vi(this),this.bindRenderbuffer=new Rn(this),this.bindTexture=new tn(this),this.bindVertexBuffer=new ji(this),this.bindElementBuffer=new vn(this),this.bindVertexArrayOES=this.extVertexArrayObject&&new ln(this),this.pixelStoreUnpack=new un(this),this.pixelStoreUnpackPremultiplyAlpha=new bn(this),this.pixelStoreUnpackFlipY=new oi(this),this.extTextureFilterAnisotropic=n.getExtension("EXT_texture_filter_anisotropic")||n.getExtension("MOZ_EXT_texture_filter_anisotropic")||n.getExtension("WEBKIT_EXT_texture_filter_anisotropic"),this.extTextureFilterAnisotropic&&(this.extTextureFilterAnisotropicMax=n.getParameter(this.extTextureFilterAnisotropic.MAX_TEXTURE_MAX_ANISOTROPY_EXT)),this.extTextureHalfFloat=n.getExtension("OES_texture_half_float"),this.extTextureHalfFloat&&(n.getExtension("OES_texture_half_float_linear"),this.extRenderToTextureHalfFloat=n.getExtension("EXT_color_buffer_half_float")),this.extTimerQuery=n.getExtension("EXT_disjoint_timer_query"),this.maxTextureSize=n.getParameter(n.MAX_TEXTURE_SIZE)};j.prototype.setDefault=function(){this.unbindVAO(),this.clearColor.setDefault(),this.clearDepth.setDefault(),this.clearStencil.setDefault(),this.colorMask.setDefault(),this.depthMask.setDefault(),this.stencilMask.setDefault(),this.stencilFunc.setDefault(),this.stencilOp.setDefault(),this.stencilTest.setDefault(),this.depthRange.setDefault(),this.depthTest.setDefault(),this.depthFunc.setDefault(),this.blend.setDefault(),this.blendFunc.setDefault(),this.blendColor.setDefault(),this.blendEquation.setDefault(),this.cullFace.setDefault(),this.cullFaceSide.setDefault(),this.frontFace.setDefault(),this.program.setDefault(),this.activeTexture.setDefault(),this.bindFramebuffer.setDefault(),this.pixelStoreUnpack.setDefault(),this.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.pixelStoreUnpackFlipY.setDefault()},j.prototype.setDirty=function(){this.clearColor.dirty=!0,this.clearDepth.dirty=!0,this.clearStencil.dirty=!0,this.colorMask.dirty=!0,this.depthMask.dirty=!0,this.stencilMask.dirty=!0,this.stencilFunc.dirty=!0,this.stencilOp.dirty=!0,this.stencilTest.dirty=!0,this.depthRange.dirty=!0,this.depthTest.dirty=!0,this.depthFunc.dirty=!0,this.blend.dirty=!0,this.blendFunc.dirty=!0,this.blendColor.dirty=!0,this.blendEquation.dirty=!0,this.cullFace.dirty=!0,this.cullFaceSide.dirty=!0,this.frontFace.dirty=!0,this.program.dirty=!0,this.activeTexture.dirty=!0,this.viewport.dirty=!0,this.bindFramebuffer.dirty=!0,this.bindRenderbuffer.dirty=!0,this.bindTexture.dirty=!0,this.bindVertexBuffer.dirty=!0,this.bindElementBuffer.dirty=!0,this.extVertexArrayObject&&(this.bindVertexArrayOES.dirty=!0),this.pixelStoreUnpack.dirty=!0,this.pixelStoreUnpackPremultiplyAlpha.dirty=!0,this.pixelStoreUnpackFlipY.dirty=!0},j.prototype.createIndexBuffer=function(n,s){return new Gr(this,n,s)},j.prototype.createVertexBuffer=function(n,s,o){return new Nr(this,n,s,o)},j.prototype.createRenderbuffer=function(n,s,o){var u=this.gl,y=u.createRenderbuffer();return this.bindRenderbuffer.set(y),u.renderbufferStorage(u.RENDERBUFFER,n,s,o),this.bindRenderbuffer.set(null),y},j.prototype.createFramebuffer=function(n,s,o){return new V(this,n,s,o)},j.prototype.clear=function(n){var s=n.color,o=n.depth,u=this.gl,y=0;s&&(y|=u.COLOR_BUFFER_BIT,this.clearColor.set(s),this.colorMask.set([!0,!0,!0,!0])),o!==void 0&&(y|=u.DEPTH_BUFFER_BIT,this.depthRange.set([0,1]),this.clearDepth.set(o),this.depthMask.set(!0)),u.clear(y)},j.prototype.setCullFace=function(n){n.enable===!1?this.cullFace.set(!1):(this.cullFace.set(!0),this.cullFaceSide.set(n.mode),this.frontFace.set(n.frontFace))},j.prototype.setDepthMode=function(n){n.func!==this.gl.ALWAYS||n.mask?(this.depthTest.set(!0),this.depthFunc.set(n.func),this.depthMask.set(n.mask),this.depthRange.set(n.range)):this.depthTest.set(!1)},j.prototype.setStencilMode=function(n){n.test.func!==this.gl.ALWAYS||n.mask?(this.stencilTest.set(!0),this.stencilMask.set(n.mask),this.stencilOp.set([n.fail,n.depthFail,n.pass]),this.stencilFunc.set({func:n.test.func,ref:n.ref,mask:n.test.mask})):this.stencilTest.set(!1)},j.prototype.setColorMode=function(n){a.deepEqual(n.blendFunction,se.Replace)?this.blend.set(!1):(this.blend.set(!0),this.blendFunc.set(n.blendFunction),this.blendColor.set(n.blendColor)),this.colorMask.set(n.mask)},j.prototype.unbindVAO=function(){this.extVertexArrayObject&&this.bindVertexArrayOES.set(null)};var J=function(n){function s(o,u,y){var w=this;n.call(this),this.id=o,this.dispatcher=y,this.on("data",function(k){k.dataType==="source"&&k.sourceDataType==="metadata"&&(w._sourceLoaded=!0),w._sourceLoaded&&!w._paused&&k.dataType==="source"&&k.sourceDataType==="content"&&(w.reload(),w.transform&&w.update(w.transform))}),this.on("error",function(){w._sourceErrored=!0}),this._source=function(k,E,P,O){var Z=new Mr[E.type](k,E,P,O);if(Z.id!==k)throw new Error("Expected Source id to be "+k+" instead of "+Z.id);return a.bindAll(["load","abort","unload","serialize","prepare"],Z),Z}(o,u,y,this),this._tiles={},this._cache=new Wt(0,this._unloadTile.bind(this)),this._timers={},this._cacheTimers={},this._maxTileCacheSize=null,this._loadedParentTiles={},this._coveredTiles={},this._state=new a.SourceFeatureState}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype.onAdd=function(o){this.map=o,this._maxTileCacheSize=o?o._maxTileCacheSize:null,this._source&&this._source.onAdd&&this._source.onAdd(o)},s.prototype.onRemove=function(o){this._source&&this._source.onRemove&&this._source.onRemove(o)},s.prototype.loaded=function(){if(this._sourceErrored)return!0;if(!this._sourceLoaded||!this._source.loaded())return!1;for(var o in this._tiles){var u=this._tiles[o];if(u.state!=="loaded"&&u.state!=="errored")return!1}return!0},s.prototype.getSource=function(){return this._source},s.prototype.pause=function(){this._paused=!0},s.prototype.resume=function(){if(this._paused){var o=this._shouldReloadOnResume;this._paused=!1,this._shouldReloadOnResume=!1,o&&this.reload(),this.transform&&this.update(this.transform)}},s.prototype._loadTile=function(o,u){return this._source.loadTile(o,u)},s.prototype._unloadTile=function(o){if(this._source.unloadTile)return this._source.unloadTile(o,function(){})},s.prototype._abortTile=function(o){if(this._source.abortTile)return this._source.abortTile(o,function(){})},s.prototype.serialize=function(){return this._source.serialize()},s.prototype.prepare=function(o){for(var u in this._source.prepare&&this._source.prepare(),this._state.coalesceChanges(this._tiles,this.map?this.map.painter:null),this._tiles){var y=this._tiles[u];y.upload(o),y.prepare(this.map.style.imageManager)}},s.prototype.getIds=function(){return a.values(this._tiles).map(function(o){return o.tileID}).sort(_e).map(function(o){return o.key})},s.prototype.getRenderableIds=function(o){var u=this,y=[];for(var w in this._tiles)this._isIdRenderable(w,o)&&y.push(this._tiles[w]);return o?y.sort(function(k,E){var P=k.tileID,O=E.tileID,Z=new a.Point(P.canonical.x,P.canonical.y)._rotate(u.transform.angle),G=new a.Point(O.canonical.x,O.canonical.y)._rotate(u.transform.angle);return P.overscaledZ-O.overscaledZ||G.y-Z.y||G.x-Z.x}).map(function(k){return k.tileID.key}):y.map(function(k){return k.tileID}).sort(_e).map(function(k){return k.key})},s.prototype.hasRenderableParent=function(o){var u=this.findLoadedParent(o,0);return!!u&&this._isIdRenderable(u.tileID.key)},s.prototype._isIdRenderable=function(o,u){return this._tiles[o]&&this._tiles[o].hasData()&&!this._coveredTiles[o]&&(u||!this._tiles[o].holdingForFade())},s.prototype.reload=function(){if(this._paused)this._shouldReloadOnResume=!0;else for(var o in this._cache.reset(),this._tiles)this._tiles[o].state!=="errored"&&this._reloadTile(o,"reloading")},s.prototype._reloadTile=function(o,u){var y=this._tiles[o];y&&(y.state!=="loading"&&(y.state=u),this._loadTile(y,this._tileLoaded.bind(this,y,o,u)))},s.prototype._tileLoaded=function(o,u,y,w){if(w)return o.state="errored",void(w.status!==404?this._source.fire(new a.ErrorEvent(w,{tile:o})):this.update(this.transform));o.timeAdded=a.browser.now(),y==="expired"&&(o.refreshedUponExpiration=!0),this._setTileReloadTimer(u,o),this.getSource().type==="raster-dem"&&o.dem&&this._backfillDEM(o),this._state.initializeTileState(o,this.map?this.map.painter:null),this._source.fire(new a.Event("data",{dataType:"source",tile:o,coord:o.tileID}))},s.prototype._backfillDEM=function(o){for(var u=this.getRenderableIds(),y=0;y<u.length;y++){var w=u[y];if(o.neighboringTiles&&o.neighboringTiles[w]){var k=this.getTileByID(w);E(o,k),E(k,o)}}function E(P,O){P.needsHillshadePrepare=!0;var Z=O.tileID.canonical.x-P.tileID.canonical.x,G=O.tileID.canonical.y-P.tileID.canonical.y,X=Math.pow(2,P.tileID.canonical.z),re=O.tileID.key;Z===0&&G===0||Math.abs(G)>1||(Math.abs(Z)>1&&(Math.abs(Z+X)===1?Z+=X:Math.abs(Z-X)===1&&(Z-=X)),O.dem&&P.dem&&(P.dem.backfillBorder(O.dem,Z,G),P.neighboringTiles&&P.neighboringTiles[re]&&(P.neighboringTiles[re].backfilled=!0)))}},s.prototype.getTile=function(o){return this.getTileByID(o.key)},s.prototype.getTileByID=function(o){return this._tiles[o]},s.prototype._retainLoadedChildren=function(o,u,y,w){for(var k in this._tiles){var E=this._tiles[k];if(!(w[k]||!E.hasData()||E.tileID.overscaledZ<=u||E.tileID.overscaledZ>y)){for(var P=E.tileID;E&&E.tileID.overscaledZ>u+1;){var O=E.tileID.scaledTo(E.tileID.overscaledZ-1);(E=this._tiles[O.key])&&E.hasData()&&(P=O)}for(var Z=P;Z.overscaledZ>u;)if(o[(Z=Z.scaledTo(Z.overscaledZ-1)).key]){w[P.key]=P;break}}}},s.prototype.findLoadedParent=function(o,u){if(o.key in this._loadedParentTiles){var y=this._loadedParentTiles[o.key];return y&&y.tileID.overscaledZ>=u?y:null}for(var w=o.overscaledZ-1;w>=u;w--){var k=o.scaledTo(w),E=this._getLoadedTile(k);if(E)return E}},s.prototype._getLoadedTile=function(o){var u=this._tiles[o.key];return u&&u.hasData()?u:this._cache.getByKey(o.wrapped().key)},s.prototype.updateCacheSize=function(o){var u=Math.ceil(o.width/this._source.tileSize)+1,y=Math.ceil(o.height/this._source.tileSize)+1,w=Math.floor(u*y*5),k=typeof this._maxTileCacheSize=="number"?Math.min(this._maxTileCacheSize,w):w;this._cache.setMaxSize(k)},s.prototype.handleWrapJump=function(o){var u=Math.round((o-(this._prevLng===void 0?o:this._prevLng))/360);if(this._prevLng=o,u){var y={};for(var w in this._tiles){var k=this._tiles[w];k.tileID=k.tileID.unwrapTo(k.tileID.wrap+u),y[k.tileID.key]=k}for(var E in this._tiles=y,this._timers)clearTimeout(this._timers[E]),delete this._timers[E];for(var P in this._tiles)this._setTileReloadTimer(P,this._tiles[P])}},s.prototype.update=function(o){var u=this;if(this.transform=o,this._sourceLoaded&&!this._paused){var y;this.updateCacheSize(o),this.handleWrapJump(this.transform.center.lng),this._coveredTiles={},this.used?this._source.tileID?y=o.getVisibleUnwrappedCoordinates(this._source.tileID).map(function(Re){return new a.OverscaledTileID(Re.canonical.z,Re.wrap,Re.canonical.z,Re.canonical.x,Re.canonical.y)}):(y=o.coveringTiles({tileSize:this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this._source.roundZoom,reparseOverscaled:this._source.reparseOverscaled}),this._source.hasTile&&(y=y.filter(function(Re){return u._source.hasTile(Re)}))):y=[];var w=o.coveringZoomLevel(this._source),k=Math.max(w-s.maxOverzooming,this._source.minzoom),E=Math.max(w+s.maxUnderzooming,this._source.minzoom),P=this._updateRetainedTiles(y,w);if(Ce(this._source.type)){for(var O={},Z={},G=0,X=Object.keys(P);G<X.length;G+=1){var re=X[G],te=P[re],ue=this._tiles[re];if(ue&&!(ue.fadeEndTime&&ue.fadeEndTime<=a.browser.now())){var Y=this.findLoadedParent(te,k);Y&&(this._addTile(Y.tileID),O[Y.tileID.key]=Y.tileID),Z[re]=te}}for(var le in this._retainLoadedChildren(Z,w,E,P),O)P[le]||(this._coveredTiles[le]=!0,P[le]=O[le])}for(var pe in P)this._tiles[pe].clearFadeHold();for(var ge=0,ze=a.keysDifference(this._tiles,P);ge<ze.length;ge+=1){var Te=ze[ge],Ae=this._tiles[Te];Ae.hasSymbolBuckets&&!Ae.holdingForFade()?Ae.setHoldDuration(this.map._fadeDuration):Ae.hasSymbolBuckets&&!Ae.symbolFadeFinished()||this._removeTile(Te)}this._updateLoadedParentTileCache()}},s.prototype.releaseSymbolFadeTiles=function(){for(var o in this._tiles)this._tiles[o].holdingForFade()&&this._removeTile(o)},s.prototype._updateRetainedTiles=function(o,u){for(var y={},w={},k=Math.max(u-s.maxOverzooming,this._source.minzoom),E=Math.max(u+s.maxUnderzooming,this._source.minzoom),P={},O=0,Z=o;O<Z.length;O+=1){var G=Z[O],X=this._addTile(G);y[G.key]=G,X.hasData()||u<this._source.maxzoom&&(P[G.key]=G)}this._retainLoadedChildren(P,u,E,y);for(var re=0,te=o;re<te.length;re+=1){var ue=te[re],Y=this._tiles[ue.key];if(!Y.hasData()){if(u+1>this._source.maxzoom){var le=ue.children(this._source.maxzoom)[0],pe=this.getTile(le);if(pe&&pe.hasData()){y[le.key]=le;continue}}else{var ge=ue.children(this._source.maxzoom);if(y[ge[0].key]&&y[ge[1].key]&&y[ge[2].key]&&y[ge[3].key])continue}for(var ze=Y.wasRequested(),Te=ue.overscaledZ-1;Te>=k;--Te){var Ae=ue.scaledTo(Te);if(w[Ae.key]||(w[Ae.key]=!0,!(Y=this.getTile(Ae))&&ze&&(Y=this._addTile(Ae)),Y&&(y[Ae.key]=Ae,ze=Y.wasRequested(),Y.hasData())))break}}}return y},s.prototype._updateLoadedParentTileCache=function(){for(var o in this._loadedParentTiles={},this._tiles){for(var u=[],y=void 0,w=this._tiles[o].tileID;w.overscaledZ>0;){if(w.key in this._loadedParentTiles){y=this._loadedParentTiles[w.key];break}u.push(w.key);var k=w.scaledTo(w.overscaledZ-1);if(y=this._getLoadedTile(k))break;w=k}for(var E=0,P=u;E<P.length;E+=1)this._loadedParentTiles[P[E]]=y}},s.prototype._addTile=function(o){var u=this._tiles[o.key];if(u)return u;(u=this._cache.getAndRemove(o))&&(this._setTileReloadTimer(o.key,u),u.tileID=o,this._state.initializeTileState(u,this.map?this.map.painter:null),this._cacheTimers[o.key]&&(clearTimeout(this._cacheTimers[o.key]),delete this._cacheTimers[o.key],this._setTileReloadTimer(o.key,u)));var y=!!u;return y||(u=new a.Tile(o,this._source.tileSize*o.overscaleFactor()),this._loadTile(u,this._tileLoaded.bind(this,u,o.key,u.state))),u?(u.uses++,this._tiles[o.key]=u,y||this._source.fire(new a.Event("dataloading",{tile:u,coord:u.tileID,dataType:"source"})),u):null},s.prototype._setTileReloadTimer=function(o,u){var y=this;o in this._timers&&(clearTimeout(this._timers[o]),delete this._timers[o]);var w=u.getExpiryTimeout();w&&(this._timers[o]=setTimeout(function(){y._reloadTile(o,"expired"),delete y._timers[o]},w))},s.prototype._removeTile=function(o){var u=this._tiles[o];u&&(u.uses--,delete this._tiles[o],this._timers[o]&&(clearTimeout(this._timers[o]),delete this._timers[o]),u.uses>0||(u.hasData()&&u.state!=="reloading"?this._cache.add(u.tileID,u,u.getExpiryTimeout()):(u.aborted=!0,this._abortTile(u),this._unloadTile(u))))},s.prototype.clearTiles=function(){for(var o in this._shouldReloadOnResume=!1,this._paused=!1,this._tiles)this._removeTile(o);this._cache.reset()},s.prototype.tilesIn=function(o,u,y){var w=this,k=[],E=this.transform;if(!E)return k;for(var P=y?E.getCameraQueryGeometry(o):o,O=o.map(function(Te){return E.pointCoordinate(Te)}),Z=P.map(function(Te){return E.pointCoordinate(Te)}),G=this.getIds(),X=1/0,re=1/0,te=-1/0,ue=-1/0,Y=0,le=Z;Y<le.length;Y+=1){var pe=le[Y];X=Math.min(X,pe.x),re=Math.min(re,pe.y),te=Math.max(te,pe.x),ue=Math.max(ue,pe.y)}for(var ge=function(Te){var Ae=w._tiles[G[Te]];if(!Ae.holdingForFade()){var Re=Ae.tileID,Xe=Math.pow(2,E.zoom-Ae.tileID.overscaledZ),Ge=u*Ae.queryPadding*a.EXTENT/Ae.tileSize/Xe,at=[Re.getTilePoint(new a.MercatorCoordinate(X,re)),Re.getTilePoint(new a.MercatorCoordinate(te,ue))];if(at[0].x-Ge<a.EXTENT&&at[0].y-Ge<a.EXTENT&&at[1].x+Ge>=0&&at[1].y+Ge>=0){var vt=O.map(function(wt){return Re.getTilePoint(wt)}),kt=Z.map(function(wt){return Re.getTilePoint(wt)});k.push({tile:Ae,tileID:Re,queryGeometry:vt,cameraQueryGeometry:kt,scale:Xe})}}},ze=0;ze<G.length;ze++)ge(ze);return k},s.prototype.getVisibleCoordinates=function(o){for(var u=this,y=this.getRenderableIds(o).map(function(P){return u._tiles[P].tileID}),w=0,k=y;w<k.length;w+=1){var E=k[w];E.posMatrix=this.transform.calculatePosMatrix(E.toUnwrapped())}return y},s.prototype.hasTransition=function(){if(this._source.hasTransition())return!0;if(Ce(this._source.type))for(var o in this._tiles){var u=this._tiles[o];if(u.fadeEndTime!==void 0&&u.fadeEndTime>=a.browser.now())return!0}return!1},s.prototype.setFeatureState=function(o,u,y){this._state.updateState(o=o||"_geojsonTileLayer",u,y)},s.prototype.removeFeatureState=function(o,u,y){this._state.removeFeatureState(o=o||"_geojsonTileLayer",u,y)},s.prototype.getFeatureState=function(o,u){return this._state.getState(o=o||"_geojsonTileLayer",u)},s.prototype.setDependencies=function(o,u,y){var w=this._tiles[o];w&&w.setDependencies(u,y)},s.prototype.reloadTilesForDependencies=function(o,u){for(var y in this._tiles)this._tiles[y].hasDependency(o,u)&&this._reloadTile(y,"reloading");this._cache.filter(function(w){return!w.hasDependency(o,u)})},s}(a.Evented);function _e(n,s){var o=Math.abs(2*n.wrap)-+(n.wrap<0),u=Math.abs(2*s.wrap)-+(s.wrap<0);return n.overscaledZ-s.overscaledZ||u-o||s.canonical.y-n.canonical.y||s.canonical.x-n.canonical.x}function Ce(n){return n==="raster"||n==="image"||n==="video"}function Me(){return new a.window.Worker(nl.workerUrl)}J.maxOverzooming=10,J.maxUnderzooming=3;var K="mapboxgl_preloaded_worker_pool",ve=function(){this.active={}};ve.prototype.acquire=function(n){if(!this.workers)for(this.workers=[];this.workers.length<ve.workerCount;)this.workers.push(new Me);return this.active[n]=!0,this.workers.slice()},ve.prototype.release=function(n){delete this.active[n],this.numActive()===0&&(this.workers.forEach(function(s){s.terminate()}),this.workers=null)},ve.prototype.isPreloaded=function(){return!!this.active[K]},ve.prototype.numActive=function(){return Object.keys(this.active).length};var et,Ye=Math.floor(a.browser.hardwareConcurrency/2);function Se(){return et||(et=new ve),et}function We(n,s){var o={};for(var u in n)u!=="ref"&&(o[u]=n[u]);return a.refProperties.forEach(function(y){y in s&&(o[y]=s[y])}),o}function Fe(n){n=n.slice();for(var s=Object.create(null),o=0;o<n.length;o++)s[n[o].id]=n[o];for(var u=0;u<n.length;u++)"ref"in n[u]&&(n[u]=We(n[u],s[n[u].ref]));return n}ve.workerCount=Math.max(Math.min(Ye,6),1);var qe={setStyle:"setStyle",addLayer:"addLayer",removeLayer:"removeLayer",setPaintProperty:"setPaintProperty",setLayoutProperty:"setLayoutProperty",setFilter:"setFilter",addSource:"addSource",removeSource:"removeSource",setGeoJSONSourceData:"setGeoJSONSourceData",setLayerZoomRange:"setLayerZoomRange",setLayerProperty:"setLayerProperty",setCenter:"setCenter",setZoom:"setZoom",setBearing:"setBearing",setPitch:"setPitch",setSprite:"setSprite",setGlyphs:"setGlyphs",setTransition:"setTransition",setLight:"setLight"};function Mt(n,s,o){o.push({command:qe.addSource,args:[n,s[n]]})}function Ze(n,s,o){s.push({command:qe.removeSource,args:[n]}),o[n]=!0}function Vt(n,s,o,u){Ze(n,o,u),Mt(n,s,o)}function lr(n,s,o){var u;for(u in n[o])if(n[o].hasOwnProperty(u)&&u!=="data"&&!a.deepEqual(n[o][u],s[o][u]))return!1;for(u in s[o])if(s[o].hasOwnProperty(u)&&u!=="data"&&!a.deepEqual(n[o][u],s[o][u]))return!1;return!0}function Pt(n,s,o,u,y,w){var k;for(k in s=s||{},n=n||{})n.hasOwnProperty(k)&&(a.deepEqual(n[k],s[k])||o.push({command:w,args:[u,k,s[k],y]}));for(k in s)s.hasOwnProperty(k)&&!n.hasOwnProperty(k)&&(a.deepEqual(n[k],s[k])||o.push({command:w,args:[u,k,s[k],y]}))}function er(n){return n.id}function Jt(n,s){return n[s.id]=s,n}var ii=function(n,s){this.reset(n,s)};ii.prototype.reset=function(n,s){this.points=n||[],this._distances=[0];for(var o=1;o<this.points.length;o++)this._distances[o]=this._distances[o-1]+this.points[o].dist(this.points[o-1]);this.length=this._distances[this._distances.length-1],this.padding=Math.min(s||0,.5*this.length),this.paddedLength=this.length-2*this.padding},ii.prototype.lerp=function(n){if(this.points.length===1)return this.points[0];n=a.clamp(n,0,1);for(var s=1,o=this._distances[s],u=n*this.paddedLength+this.padding;o<u&&s<this._distances.length;)o=this._distances[++s];var y=s-1,w=this._distances[y],k=o-w,E=k>0?(u-w)/k:0;return this.points[y].mult(1-E).add(this.points[s].mult(E))};var $t=function(n,s,o){var u=this.boxCells=[],y=this.circleCells=[];this.xCellCount=Math.ceil(n/o),this.yCellCount=Math.ceil(s/o);for(var w=0;w<this.xCellCount*this.yCellCount;w++)u.push([]),y.push([]);this.circleKeys=[],this.boxKeys=[],this.bboxes=[],this.circles=[],this.width=n,this.height=s,this.xScale=this.xCellCount/n,this.yScale=this.yCellCount/s,this.boxUid=0,this.circleUid=0};function vr(n,s,o,u,y){var w=a.create();return s?(a.scale(w,w,[1/y,1/y,1]),o||a.rotateZ(w,w,u.angle)):a.multiply(w,u.labelPlaneMatrix,n),w}function fr(n,s,o,u,y){if(s){var w=a.clone(n);return a.scale(w,w,[y,y,1]),o||a.rotateZ(w,w,-u.angle),w}return u.glCoordMatrix}function Gt(n,s){var o=[n.x,n.y,0,1];li(o,o,s);var u=o[3];return{point:new a.Point(o[0]/u,o[1]/u),signedDistanceFromCamera:u}}function tr(n,s){return .5+n/s*.5}function si(n,s){var o=n[0]/n[3],u=n[1]/n[3];return o>=-s[0]&&o<=s[0]&&u>=-s[1]&&u<=s[1]}function Bn(n,s,o,u,y,w,k,E){var P=u?n.textSizeData:n.iconSizeData,O=a.evaluateSizeForZoom(P,o.transform.zoom),Z=[256/o.width*2+1,256/o.height*2+1],G=u?n.text.dynamicLayoutVertexArray:n.icon.dynamicLayoutVertexArray;G.clear();for(var X=n.lineVertexArray,re=u?n.text.placedSymbolArray:n.icon.placedSymbolArray,te=o.transform.width/o.transform.height,ue=!1,Y=0;Y<re.length;Y++){var le=re.get(Y);if(le.hidden||le.writingMode===a.WritingMode.vertical&&!ue)Si(le.numGlyphs,G);else{ue=!1;var pe=[le.anchorX,le.anchorY,0,1];if(a.transformMat4(pe,pe,s),si(pe,Z)){var ge=tr(o.transform.cameraToCenterDistance,pe[3]),ze=a.evaluateSizeForFeature(P,O,le),Te=k?ze/ge:ze*ge,Ae=new a.Point(le.anchorX,le.anchorY),Re=Gt(Ae,y).point,Xe={},Ge=ja(le,Te,!1,E,s,y,w,n.glyphOffsetArray,X,G,Re,Ae,Xe,te);ue=Ge.useVertical,(Ge.notEnoughRoom||ue||Ge.needsFlipping&&ja(le,Te,!0,E,s,y,w,n.glyphOffsetArray,X,G,Re,Ae,Xe,te).notEnoughRoom)&&Si(le.numGlyphs,G)}else Si(le.numGlyphs,G)}}u?n.text.dynamicLayoutVertexBuffer.updateData(G):n.icon.dynamicLayoutVertexBuffer.updateData(G)}function xr(n,s,o,u,y,w,k,E,P,O,Z){var G=E.glyphStartIndex+E.numGlyphs,X=E.lineStartIndex,re=E.lineStartIndex+E.lineLength,te=s.getoffsetX(E.glyphStartIndex),ue=s.getoffsetX(G-1),Y=Xr(n*te,o,u,y,w,k,E.segment,X,re,P,O,Z);if(!Y)return null;var le=Xr(n*ue,o,u,y,w,k,E.segment,X,re,P,O,Z);return le?{first:Y,last:le}:null}function Di(n,s,o,u){return n===a.WritingMode.horizontal&&Math.abs(o.y-s.y)>Math.abs(o.x-s.x)*u?{useVertical:!0}:(n===a.WritingMode.vertical?s.y<o.y:s.x>o.x)?{needsFlipping:!0}:null}function ja(n,s,o,u,y,w,k,E,P,O,Z,G,X,re){var te,ue=s/24,Y=n.lineOffsetX*ue,le=n.lineOffsetY*ue;if(n.numGlyphs>1){var pe=n.glyphStartIndex+n.numGlyphs,ge=n.lineStartIndex,ze=n.lineStartIndex+n.lineLength,Te=xr(ue,E,Y,le,o,Z,G,n,P,w,X);if(!Te)return{notEnoughRoom:!0};var Ae=Gt(Te.first.point,k).point,Re=Gt(Te.last.point,k).point;if(u&&!o){var Xe=Di(n.writingMode,Ae,Re,re);if(Xe)return Xe}te=[Te.first];for(var Ge=n.glyphStartIndex+1;Ge<pe-1;Ge++)te.push(Xr(ue*E.getoffsetX(Ge),Y,le,o,Z,G,n.segment,ge,ze,P,w,X));te.push(Te.last)}else{if(u&&!o){var at=Gt(G,y).point,vt=n.lineStartIndex+n.segment+1,kt=new a.Point(P.getx(vt),P.gety(vt)),wt=Gt(kt,y),_r=wt.signedDistanceFromCamera>0?wt.point:ga(G,kt,at,1,y),ot=Di(n.writingMode,at,_r,re);if(ot)return ot}var Nt=Xr(ue*E.getoffsetX(n.glyphStartIndex),Y,le,o,Z,G,n.segment,n.lineStartIndex,n.lineStartIndex+n.lineLength,P,w,X);if(!Nt)return{notEnoughRoom:!0};te=[Nt]}for(var Yt=0,Ot=te;Yt<Ot.length;Yt+=1){var Bt=Ot[Yt];a.addDynamicAttributes(O,Bt.point,Bt.angle)}return{}}function ga(n,s,o,u,y){var w=Gt(n.add(n.sub(s)._unit()),y).point,k=o.sub(w);return o.add(k._mult(u/k.mag()))}function Xr(n,s,o,u,y,w,k,E,P,O,Z,G){var X=u?n-s:n+s,re=X>0?1:-1,te=0;u&&(re*=-1,te=Math.PI),re<0&&(te+=Math.PI);for(var ue=re>0?E+k:E+k+1,Y=y,le=y,pe=0,ge=0,ze=Math.abs(X),Te=[];pe+ge<=ze;){if((ue+=re)<E||ue>=P)return null;if(le=Y,Te.push(Y),(Y=G[ue])===void 0){var Ae=new a.Point(O.getx(ue),O.gety(ue)),Re=Gt(Ae,Z);if(Re.signedDistanceFromCamera>0)Y=G[ue]=Re.point;else{var Xe=ue-re;Y=ga(pe===0?w:new a.Point(O.getx(Xe),O.gety(Xe)),Ae,le,ze-pe+1,Z)}}pe+=ge,ge=le.dist(Y)}var Ge=(ze-pe)/ge,at=Y.sub(le),vt=at.mult(Ge)._add(le);vt._add(at._unit()._perp()._mult(o*re));var kt=te+Math.atan2(Y.y-le.y,Y.x-le.x);return Te.push(vt),{point:vt,angle:kt,path:Te}}$t.prototype.keysLength=function(){return this.boxKeys.length+this.circleKeys.length},$t.prototype.insert=function(n,s,o,u,y){this._forEachCell(s,o,u,y,this._insertBoxCell,this.boxUid++),this.boxKeys.push(n),this.bboxes.push(s),this.bboxes.push(o),this.bboxes.push(u),this.bboxes.push(y)},$t.prototype.insertCircle=function(n,s,o,u){this._forEachCell(s-u,o-u,s+u,o+u,this._insertCircleCell,this.circleUid++),this.circleKeys.push(n),this.circles.push(s),this.circles.push(o),this.circles.push(u)},$t.prototype._insertBoxCell=function(n,s,o,u,y,w){this.boxCells[y].push(w)},$t.prototype._insertCircleCell=function(n,s,o,u,y,w){this.circleCells[y].push(w)},$t.prototype._query=function(n,s,o,u,y,w){if(o<0||n>this.width||u<0||s>this.height)return!y&&[];var k=[];if(n<=0&&s<=0&&this.width<=o&&this.height<=u){if(y)return!0;for(var E=0;E<this.boxKeys.length;E++)k.push({key:this.boxKeys[E],x1:this.bboxes[4*E],y1:this.bboxes[4*E+1],x2:this.bboxes[4*E+2],y2:this.bboxes[4*E+3]});for(var P=0;P<this.circleKeys.length;P++){var O=this.circles[3*P],Z=this.circles[3*P+1],G=this.circles[3*P+2];k.push({key:this.circleKeys[P],x1:O-G,y1:Z-G,x2:O+G,y2:Z+G})}return w?k.filter(w):k}return this._forEachCell(n,s,o,u,this._queryCell,k,{hitTest:y,seenUids:{box:{},circle:{}}},w),y?k.length>0:k},$t.prototype._queryCircle=function(n,s,o,u,y){var w=n-o,k=n+o,E=s-o,P=s+o;if(k<0||w>this.width||P<0||E>this.height)return!u&&[];var O=[];return this._forEachCell(w,E,k,P,this._queryCellCircle,O,{hitTest:u,circle:{x:n,y:s,radius:o},seenUids:{box:{},circle:{}}},y),u?O.length>0:O},$t.prototype.query=function(n,s,o,u,y){return this._query(n,s,o,u,!1,y)},$t.prototype.hitTest=function(n,s,o,u,y){return this._query(n,s,o,u,!0,y)},$t.prototype.hitTestCircle=function(n,s,o,u){return this._queryCircle(n,s,o,!0,u)},$t.prototype._queryCell=function(n,s,o,u,y,w,k,E){var P=k.seenUids,O=this.boxCells[y];if(O!==null)for(var Z=this.bboxes,G=0,X=O;G<X.length;G+=1){var re=X[G];if(!P.box[re]){P.box[re]=!0;var te=4*re;if(n<=Z[te+2]&&s<=Z[te+3]&&o>=Z[te+0]&&u>=Z[te+1]&&(!E||E(this.boxKeys[re]))){if(k.hitTest)return w.push(!0),!0;w.push({key:this.boxKeys[re],x1:Z[te],y1:Z[te+1],x2:Z[te+2],y2:Z[te+3]})}}}var ue=this.circleCells[y];if(ue!==null)for(var Y=this.circles,le=0,pe=ue;le<pe.length;le+=1){var ge=pe[le];if(!P.circle[ge]){P.circle[ge]=!0;var ze=3*ge;if(this._circleAndRectCollide(Y[ze],Y[ze+1],Y[ze+2],n,s,o,u)&&(!E||E(this.circleKeys[ge]))){if(k.hitTest)return w.push(!0),!0;var Te=Y[ze],Ae=Y[ze+1],Re=Y[ze+2];w.push({key:this.circleKeys[ge],x1:Te-Re,y1:Ae-Re,x2:Te+Re,y2:Ae+Re})}}}},$t.prototype._queryCellCircle=function(n,s,o,u,y,w,k,E){var P=k.circle,O=k.seenUids,Z=this.boxCells[y];if(Z!==null)for(var G=this.bboxes,X=0,re=Z;X<re.length;X+=1){var te=re[X];if(!O.box[te]){O.box[te]=!0;var ue=4*te;if(this._circleAndRectCollide(P.x,P.y,P.radius,G[ue+0],G[ue+1],G[ue+2],G[ue+3])&&(!E||E(this.boxKeys[te])))return w.push(!0),!0}}var Y=this.circleCells[y];if(Y!==null)for(var le=this.circles,pe=0,ge=Y;pe<ge.length;pe+=1){var ze=ge[pe];if(!O.circle[ze]){O.circle[ze]=!0;var Te=3*ze;if(this._circlesCollide(le[Te],le[Te+1],le[Te+2],P.x,P.y,P.radius)&&(!E||E(this.circleKeys[ze])))return w.push(!0),!0}}},$t.prototype._forEachCell=function(n,s,o,u,y,w,k,E){for(var P=this._convertToXCellCoord(n),O=this._convertToYCellCoord(s),Z=this._convertToXCellCoord(o),G=this._convertToYCellCoord(u),X=P;X<=Z;X++)for(var re=O;re<=G;re++)if(y.call(this,n,s,o,u,this.xCellCount*re+X,w,k,E))return},$t.prototype._convertToXCellCoord=function(n){return Math.max(0,Math.min(this.xCellCount-1,Math.floor(n*this.xScale)))},$t.prototype._convertToYCellCoord=function(n){return Math.max(0,Math.min(this.yCellCount-1,Math.floor(n*this.yScale)))},$t.prototype._circlesCollide=function(n,s,o,u,y,w){var k=u-n,E=y-s,P=o+w;return P*P>k*k+E*E},$t.prototype._circleAndRectCollide=function(n,s,o,u,y,w,k){var E=(w-u)/2,P=Math.abs(n-(u+E));if(P>E+o)return!1;var O=(k-y)/2,Z=Math.abs(s-(y+O));if(Z>O+o)return!1;if(P<=E||Z<=O)return!0;var G=P-E,X=Z-O;return G*G+X*X<=o*o};var va=new Float32Array([-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0]);function Si(n,s){for(var o=0;o<n;o++){var u=s.length;s.resize(u+4),s.float32.set(va,3*u)}}function li(n,s,o){var u=s[0],y=s[1];return n[0]=o[0]*u+o[4]*y+o[12],n[1]=o[1]*u+o[5]*y+o[13],n[3]=o[3]*u+o[7]*y+o[15],n}var cn=function(n,s,o){s===void 0&&(s=new $t(n.width+200,n.height+200,25)),o===void 0&&(o=new $t(n.width+200,n.height+200,25)),this.transform=n,this.grid=s,this.ignoredGrid=o,this.pitchfactor=Math.cos(n._pitch)*n.cameraToCenterDistance,this.screenRightBoundary=n.width+100,this.screenBottomBoundary=n.height+100,this.gridRightBoundary=n.width+200,this.gridBottomBoundary=n.height+200};function Lr(n,s,o){return s*(a.EXTENT/(n.tileSize*Math.pow(2,o-n.tileID.overscaledZ)))}cn.prototype.placeCollisionBox=function(n,s,o,u,y){var w=this.projectAndGetPerspectiveRatio(u,n.anchorPointX,n.anchorPointY),k=o*w.perspectiveRatio,E=n.x1*k+w.point.x,P=n.y1*k+w.point.y,O=n.x2*k+w.point.x,Z=n.y2*k+w.point.y;return!this.isInsideGrid(E,P,O,Z)||!s&&this.grid.hitTest(E,P,O,Z,y)?{box:[],offscreen:!1}:{box:[E,P,O,Z],offscreen:this.isOffscreen(E,P,O,Z)}},cn.prototype.placeCollisionCircles=function(n,s,o,u,y,w,k,E,P,O,Z,G,X){var re=[],te=new a.Point(s.anchorX,s.anchorY),ue=Gt(te,w),Y=tr(this.transform.cameraToCenterDistance,ue.signedDistanceFromCamera),le=(O?y/Y:y*Y)/a.ONE_EM,pe=Gt(te,k).point,ge=xr(le,u,s.lineOffsetX*le,s.lineOffsetY*le,!1,pe,te,s,o,k,{}),ze=!1,Te=!1,Ae=!0;if(ge){for(var Re=.5*G*Y+X,Xe=new a.Point(-100,-100),Ge=new a.Point(this.screenRightBoundary,this.screenBottomBoundary),at=new ii,vt=ge.first,kt=ge.last,wt=[],_r=vt.path.length-1;_r>=1;_r--)wt.push(vt.path[_r]);for(var ot=1;ot<kt.path.length;ot++)wt.push(kt.path[ot]);var Nt=2.5*Re;if(E){var Yt=wt.map(function(oa){return Gt(oa,E)});wt=Yt.some(function(oa){return oa.signedDistanceFromCamera<=0})?[]:Yt.map(function(oa){return oa.point})}var Ot=[];if(wt.length>0){for(var Bt=wt[0].clone(),Ht=wt[0].clone(),Rt=1;Rt<wt.length;Rt++)Bt.x=Math.min(Bt.x,wt[Rt].x),Bt.y=Math.min(Bt.y,wt[Rt].y),Ht.x=Math.max(Ht.x,wt[Rt].x),Ht.y=Math.max(Ht.y,wt[Rt].y);Ot=Bt.x>=Xe.x&&Ht.x<=Ge.x&&Bt.y>=Xe.y&&Ht.y<=Ge.y?[wt]:Ht.x<Xe.x||Bt.x>Ge.x||Ht.y<Xe.y||Bt.y>Ge.y?[]:a.clipLine([wt],Xe.x,Xe.y,Ge.x,Ge.y)}for(var Ct=0,Li=Ot;Ct<Li.length;Ct+=1){var ui;at.reset(Li[Ct],.25*Re),ui=at.length<=.5*Re?1:Math.ceil(at.paddedLength/Nt)+1;for(var pn=0;pn<ui;pn++){var Xi=pn/Math.max(ui-1,1),ni=at.lerp(Xi),mi=ni.x+100,Gn=ni.y+100;re.push(mi,Gn,Re,0);var Sn=mi-Re,to=Gn-Re,Pn=mi+Re,_a=Gn+Re;if(Ae=Ae&&this.isOffscreen(Sn,to,Pn,_a),Te=Te||this.isInsideGrid(Sn,to,Pn,_a),!n&&this.grid.hitTestCircle(mi,Gn,Re,Z)&&(ze=!0,!P))return{circles:[],offscreen:!1,collisionDetected:ze}}}}return{circles:!P&&ze||!Te?[]:re,offscreen:Ae,collisionDetected:ze}},cn.prototype.queryRenderedSymbols=function(n){if(n.length===0||this.grid.keysLength()===0&&this.ignoredGrid.keysLength()===0)return{};for(var s=[],o=1/0,u=1/0,y=-1/0,w=-1/0,k=0,E=n;k<E.length;k+=1){var P=E[k],O=new a.Point(P.x+100,P.y+100);o=Math.min(o,O.x),u=Math.min(u,O.y),y=Math.max(y,O.x),w=Math.max(w,O.y),s.push(O)}for(var Z={},G={},X=0,re=this.grid.query(o,u,y,w).concat(this.ignoredGrid.query(o,u,y,w));X<re.length;X+=1){var te=re[X],ue=te.key;if(Z[ue.bucketInstanceId]===void 0&&(Z[ue.bucketInstanceId]={}),!Z[ue.bucketInstanceId][ue.featureIndex]){var Y=[new a.Point(te.x1,te.y1),new a.Point(te.x2,te.y1),new a.Point(te.x2,te.y2),new a.Point(te.x1,te.y2)];a.polygonIntersectsPolygon(s,Y)&&(Z[ue.bucketInstanceId][ue.featureIndex]=!0,G[ue.bucketInstanceId]===void 0&&(G[ue.bucketInstanceId]=[]),G[ue.bucketInstanceId].push(ue.featureIndex))}}return G},cn.prototype.insertCollisionBox=function(n,s,o,u,y){(s?this.ignoredGrid:this.grid).insert({bucketInstanceId:o,featureIndex:u,collisionGroupID:y},n[0],n[1],n[2],n[3])},cn.prototype.insertCollisionCircles=function(n,s,o,u,y){for(var w=s?this.ignoredGrid:this.grid,k={bucketInstanceId:o,featureIndex:u,collisionGroupID:y},E=0;E<n.length;E+=4)w.insertCircle(k,n[E],n[E+1],n[E+2])},cn.prototype.projectAndGetPerspectiveRatio=function(n,s,o){var u=[s,o,0,1];return li(u,u,n),{point:new a.Point((u[0]/u[3]+1)/2*this.transform.width+100,(-u[1]/u[3]+1)/2*this.transform.height+100),perspectiveRatio:.5+this.transform.cameraToCenterDistance/u[3]*.5}},cn.prototype.isOffscreen=function(n,s,o,u){return o<100||n>=this.screenRightBoundary||u<100||s>this.screenBottomBoundary},cn.prototype.isInsideGrid=function(n,s,o,u){return o>=0&&n<this.gridRightBoundary&&u>=0&&s<this.gridBottomBoundary},cn.prototype.getViewportMatrix=function(){var n=a.identity([]);return a.translate(n,n,[-100,-100,0]),n};var On=function(n,s,o,u){this.opacity=n?Math.max(0,Math.min(1,n.opacity+(n.placed?s:-s))):u&&o?1:0,this.placed=o};On.prototype.isHidden=function(){return this.opacity===0&&!this.placed};var xn=function(n,s,o,u,y){this.text=new On(n?n.text:null,s,o,y),this.icon=new On(n?n.icon:null,s,u,y)};xn.prototype.isHidden=function(){return this.text.isHidden()&&this.icon.isHidden()};var os=function(n,s,o){this.text=n,this.icon=s,this.skipFade=o},Ei=function(){this.invProjMatrix=a.create(),this.viewportMatrix=a.create(),this.circles=[]},ba=function(n,s,o,u,y){this.bucketInstanceId=n,this.featureIndex=s,this.sourceLayerIndex=o,this.bucketIndex=u,this.tileID=y},qi=function(n){this.crossSourceCollisions=n,this.maxGroupID=0,this.collisionGroups={}};function Ti(n,s,o,u,y){var w=a.getAnchorAlignment(n),k=-(w.horizontalAlign-.5)*s,E=-(w.verticalAlign-.5)*o,P=a.evaluateVariableOffset(n,u);return new a.Point(k+P[0]*y,E+P[1]*y)}function Jn(n,s,o,u,y,w){var k=n.x1,E=n.x2,P=n.y1,O=n.y2,Z=n.anchorPointX,G=n.anchorPointY,X=new a.Point(s,o);return u&&X._rotate(y?w:-w),{x1:k+X.x,y1:P+X.y,x2:E+X.x,y2:O+X.y,anchorPointX:Z,anchorPointY:G}}qi.prototype.get=function(n){if(this.crossSourceCollisions)return{ID:0,predicate:null};if(!this.collisionGroups[n]){var s=++this.maxGroupID;this.collisionGroups[n]={ID:s,predicate:function(o){return o.collisionGroupID===s}}}return this.collisionGroups[n]};var Zi=function(n,s,o,u){this.transform=n.clone(),this.collisionIndex=new cn(this.transform),this.placements={},this.opacities={},this.variableOffsets={},this.stale=!1,this.commitTime=0,this.fadeDuration=s,this.retainedQueryData={},this.collisionGroups=new qi(o),this.collisionCircleArrays={},this.prevPlacement=u,u&&(u.prevPlacement=void 0),this.placedOrientations={}};function xa(n,s,o,u,y){n.emplaceBack(s?1:0,o?1:0,u||0,y||0),n.emplaceBack(s?1:0,o?1:0,u||0,y||0),n.emplaceBack(s?1:0,o?1:0,u||0,y||0),n.emplaceBack(s?1:0,o?1:0,u||0,y||0)}Zi.prototype.getBucketParts=function(n,s,o,u){var y=o.getBucket(s),w=o.latestFeatureIndex;if(y&&w&&s.id===y.layerIds[0]){var k=o.collisionBoxArray,E=y.layers[0].layout,P=Math.pow(2,this.transform.zoom-o.tileID.overscaledZ),O=o.tileSize/a.EXTENT,Z=this.transform.calculatePosMatrix(o.tileID.toUnwrapped()),G=E.get("text-pitch-alignment")==="map",X=E.get("text-rotation-alignment")==="map",re=Lr(o,1,this.transform.zoom),te=vr(Z,G,X,this.transform,re),ue=null;if(G){var Y=fr(Z,G,X,this.transform,re);ue=a.multiply([],this.transform.labelPlaneMatrix,Y)}this.retainedQueryData[y.bucketInstanceId]=new ba(y.bucketInstanceId,w,y.sourceLayerIndex,y.index,o.tileID);var le={bucket:y,layout:E,posMatrix:Z,textLabelPlaneMatrix:te,labelToScreenMatrix:ue,scale:P,textPixelRatio:O,holdingForFade:o.holdingForFade(),collisionBoxArray:k,partiallyEvaluatedTextSize:a.evaluateSizeForZoom(y.textSizeData,this.transform.zoom),collisionGroup:this.collisionGroups.get(y.sourceID)};if(u)for(var pe=0,ge=y.sortKeyRanges;pe<ge.length;pe+=1){var ze=ge[pe];n.push({sortKey:ze.sortKey,symbolInstanceStart:ze.symbolInstanceStart,symbolInstanceEnd:ze.symbolInstanceEnd,parameters:le})}else n.push({symbolInstanceStart:0,symbolInstanceEnd:y.symbolInstances.length,parameters:le})}},Zi.prototype.attemptAnchorPlacement=function(n,s,o,u,y,w,k,E,P,O,Z,G,X,re,te){var ue,Y=[G.textOffset0,G.textOffset1],le=Ti(n,o,u,Y,y),pe=this.collisionIndex.placeCollisionBox(Jn(s,le.x,le.y,w,k,this.transform.angle),Z,E,P,O.predicate);if(!te||this.collisionIndex.placeCollisionBox(Jn(te,le.x,le.y,w,k,this.transform.angle),Z,E,P,O.predicate).box.length!==0)return pe.box.length>0?(this.prevPlacement&&this.prevPlacement.variableOffsets[G.crossTileID]&&this.prevPlacement.placements[G.crossTileID]&&this.prevPlacement.placements[G.crossTileID].text&&(ue=this.prevPlacement.variableOffsets[G.crossTileID].anchor),this.variableOffsets[G.crossTileID]={textOffset:Y,width:o,height:u,anchor:n,textBoxScale:y,prevAnchor:ue},this.markUsedJustification(X,n,G,re),X.allowVerticalPlacement&&(this.markUsedOrientation(X,re,G),this.placedOrientations[G.crossTileID]=re),{shift:le,placedGlyphBoxes:pe}):void 0},Zi.prototype.placeLayerBucketPart=function(n,s,o){var u=this,y=n.parameters,w=y.bucket,k=y.layout,E=y.posMatrix,P=y.textLabelPlaneMatrix,O=y.labelToScreenMatrix,Z=y.textPixelRatio,G=y.holdingForFade,X=y.collisionBoxArray,re=y.partiallyEvaluatedTextSize,te=y.collisionGroup,ue=k.get("text-optional"),Y=k.get("icon-optional"),le=k.get("text-allow-overlap"),pe=k.get("icon-allow-overlap"),ge=k.get("text-rotation-alignment")==="map",ze=k.get("text-pitch-alignment")==="map",Te=k.get("icon-text-fit")!=="none",Ae=k.get("symbol-z-order")==="viewport-y",Re=le&&(pe||!w.hasIconData()||Y),Xe=pe&&(le||!w.hasTextData()||ue);!w.collisionArrays&&X&&w.deserializeCollisionBoxes(X);var Ge=function(ot,Nt){if(!s[ot.crossTileID])if(G)u.placements[ot.crossTileID]=new os(!1,!1,!1);else{var Yt,Ot=!1,Bt=!1,Ht=!0,Rt=null,Ct={box:null,offscreen:null},Li={box:null,offscreen:null},ui=null,pn=null,Xi=0,ni=0,mi=0;Nt.textFeatureIndex?Xi=Nt.textFeatureIndex:ot.useRuntimeCollisionCircles&&(Xi=ot.featureIndex),Nt.verticalTextFeatureIndex&&(ni=Nt.verticalTextFeatureIndex);var Gn=Nt.textBox;if(Gn){var Sn=function(Sr){var $n=a.WritingMode.horizontal;if(w.allowVerticalPlacement&&!Sr&&u.prevPlacement){var Cn=u.prevPlacement.placedOrientations[ot.crossTileID];Cn&&(u.placedOrientations[ot.crossTileID]=Cn,u.markUsedOrientation(w,$n=Cn,ot))}return $n},to=function(Sr,$n){if(w.allowVerticalPlacement&&ot.numVerticalGlyphVertices>0&&Nt.verticalTextBox)for(var Cn=0,Co=w.writingModes;Cn<Co.length&&(Co[Cn]===a.WritingMode.vertical?(Ct=$n(),Li=Ct):Ct=Sr(),!(Ct&&Ct.box&&Ct.box.length));Cn+=1);else Ct=Sr()};if(k.get("text-variable-anchor")){var Pn=k.get("text-variable-anchor");if(u.prevPlacement&&u.prevPlacement.variableOffsets[ot.crossTileID]){var _a=u.prevPlacement.variableOffsets[ot.crossTileID];Pn.indexOf(_a.anchor)>0&&(Pn=Pn.filter(function(Sr){return Sr!==_a.anchor})).unshift(_a.anchor)}var oa=function(Sr,$n,Cn){for(var Co=Sr.x2-Sr.x1,Hh=Sr.y2-Sr.y1,al=ot.textBoxScale,Jh=Te&&!pe?$n:null,zs={box:[],offscreen:!1},Ac=le?2*Pn.length:Pn.length,Qo=0;Qo<Ac;++Qo){var ol=u.attemptAnchorPlacement(Pn[Qo%Pn.length],Sr,Co,Hh,al,ge,ze,Z,E,te,Qo>=Pn.length,ot,w,Cn,Jh);if(ol&&(zs=ol.placedGlyphBoxes)&&zs.box&&zs.box.length){Ot=!0,Rt=ol.shift;break}}return zs};to(function(){return oa(Gn,Nt.iconBox,a.WritingMode.horizontal)},function(){var Sr=Nt.verticalTextBox;return w.allowVerticalPlacement&&!(Ct&&Ct.box&&Ct.box.length)&&ot.numVerticalGlyphVertices>0&&Sr?oa(Sr,Nt.verticalIconBox,a.WritingMode.vertical):{box:null,offscreen:null}}),Ct&&(Ot=Ct.box,Ht=Ct.offscreen);var Es=Sn(Ct&&Ct.box);if(!Ot&&u.prevPlacement){var Jo=u.prevPlacement.variableOffsets[ot.crossTileID];Jo&&(u.variableOffsets[ot.crossTileID]=Jo,u.markUsedJustification(w,Jo.anchor,ot,Es))}}else{var ro=function(Sr,$n){var Cn=u.collisionIndex.placeCollisionBox(Sr,le,Z,E,te.predicate);return Cn&&Cn.box&&Cn.box.length&&(u.markUsedOrientation(w,$n,ot),u.placedOrientations[ot.crossTileID]=$n),Cn};to(function(){return ro(Gn,a.WritingMode.horizontal)},function(){var Sr=Nt.verticalTextBox;return w.allowVerticalPlacement&&ot.numVerticalGlyphVertices>0&&Sr?ro(Sr,a.WritingMode.vertical):{box:null,offscreen:null}}),Sn(Ct&&Ct.box&&Ct.box.length)}}if(Ot=(Yt=Ct)&&Yt.box&&Yt.box.length>0,Ht=Yt&&Yt.offscreen,ot.useRuntimeCollisionCircles){var Yo=w.text.placedSymbolArray.get(ot.centerJustifiedTextSymbolIndex),Ts=a.evaluateSizeForFeature(w.textSizeData,re,Yo),Ia=k.get("text-padding");ui=u.collisionIndex.placeCollisionCircles(le,Yo,w.lineVertexArray,w.glyphOffsetArray,Ts,E,P,O,o,ze,te.predicate,ot.collisionCircleDiameter,Ia),Ot=le||ui.circles.length>0&&!ui.collisionDetected,Ht=Ht&&ui.offscreen}if(Nt.iconFeatureIndex&&(mi=Nt.iconFeatureIndex),Nt.iconBox){var Is=function(Sr){var $n=Te&&Rt?Jn(Sr,Rt.x,Rt.y,ge,ze,u.transform.angle):Sr;return u.collisionIndex.placeCollisionBox($n,pe,Z,E,te.predicate)};Bt=Li&&Li.box&&Li.box.length&&Nt.verticalIconBox?(pn=Is(Nt.verticalIconBox)).box.length>0:(pn=Is(Nt.iconBox)).box.length>0,Ht=Ht&&pn.offscreen}var za=ue||ot.numHorizontalGlyphVertices===0&&ot.numVerticalGlyphVertices===0,Ri=Y||ot.numIconVertices===0;if(za||Ri?Ri?za||(Bt=Bt&&Ot):Ot=Bt&&Ot:Bt=Ot=Bt&&Ot,Ot&&Yt&&Yt.box&&u.collisionIndex.insertCollisionBox(Yt.box,k.get("text-ignore-placement"),w.bucketInstanceId,Li&&Li.box&&ni?ni:Xi,te.ID),Bt&&pn&&u.collisionIndex.insertCollisionBox(pn.box,k.get("icon-ignore-placement"),w.bucketInstanceId,mi,te.ID),ui&&(Ot&&u.collisionIndex.insertCollisionCircles(ui.circles,k.get("text-ignore-placement"),w.bucketInstanceId,Xi,te.ID),o)){var Ba=w.bucketInstanceId,io=u.collisionCircleArrays[Ba];io===void 0&&(io=u.collisionCircleArrays[Ba]=new Ei);for(var Po=0;Po<ui.circles.length;Po+=4)io.circles.push(ui.circles[Po+0]),io.circles.push(ui.circles[Po+1]),io.circles.push(ui.circles[Po+2]),io.circles.push(ui.collisionDetected?1:0)}u.placements[ot.crossTileID]=new os(Ot||Re,Bt||Xe,Ht||w.justReloaded),s[ot.crossTileID]=!0}};if(Ae)for(var at=w.getSortedSymbolIndexes(this.transform.angle),vt=at.length-1;vt>=0;--vt){var kt=at[vt];Ge(w.symbolInstances.get(kt),w.collisionArrays[kt])}else for(var wt=n.symbolInstanceStart;wt<n.symbolInstanceEnd;wt++)Ge(w.symbolInstances.get(wt),w.collisionArrays[wt]);if(o&&w.bucketInstanceId in this.collisionCircleArrays){var _r=this.collisionCircleArrays[w.bucketInstanceId];a.invert(_r.invProjMatrix,E),_r.viewportMatrix=this.collisionIndex.getViewportMatrix()}w.justReloaded=!1},Zi.prototype.markUsedJustification=function(n,s,o,u){var y;y=u===a.WritingMode.vertical?o.verticalPlacedTextSymbolIndex:{left:o.leftJustifiedTextSymbolIndex,center:o.centerJustifiedTextSymbolIndex,right:o.rightJustifiedTextSymbolIndex}[a.getAnchorJustification(s)];for(var w=0,k=[o.leftJustifiedTextSymbolIndex,o.centerJustifiedTextSymbolIndex,o.rightJustifiedTextSymbolIndex,o.verticalPlacedTextSymbolIndex];w<k.length;w+=1){var E=k[w];E>=0&&(n.text.placedSymbolArray.get(E).crossTileID=y>=0&&E!==y?0:o.crossTileID)}},Zi.prototype.markUsedOrientation=function(n,s,o){for(var u=s===a.WritingMode.horizontal||s===a.WritingMode.horizontalOnly?s:0,y=s===a.WritingMode.vertical?s:0,w=0,k=[o.leftJustifiedTextSymbolIndex,o.centerJustifiedTextSymbolIndex,o.rightJustifiedTextSymbolIndex];w<k.length;w+=1)n.text.placedSymbolArray.get(k[w]).placedOrientation=u;o.verticalPlacedTextSymbolIndex&&(n.text.placedSymbolArray.get(o.verticalPlacedTextSymbolIndex).placedOrientation=y)},Zi.prototype.commit=function(n){this.commitTime=n,this.zoomAtLastRecencyCheck=this.transform.zoom;var s=this.prevPlacement,o=!1;this.prevZoomAdjustment=s?s.zoomAdjustment(this.transform.zoom):0;var u=s?s.symbolFadeChange(n):1,y=s?s.opacities:{},w=s?s.variableOffsets:{},k=s?s.placedOrientations:{};for(var E in this.placements){var P=this.placements[E],O=y[E];O?(this.opacities[E]=new xn(O,u,P.text,P.icon),o=o||P.text!==O.text.placed||P.icon!==O.icon.placed):(this.opacities[E]=new xn(null,u,P.text,P.icon,P.skipFade),o=o||P.text||P.icon)}for(var Z in y){var G=y[Z];if(!this.opacities[Z]){var X=new xn(G,u,!1,!1);X.isHidden()||(this.opacities[Z]=X,o=o||G.text.placed||G.icon.placed)}}for(var re in w)this.variableOffsets[re]||!this.opacities[re]||this.opacities[re].isHidden()||(this.variableOffsets[re]=w[re]);for(var te in k)this.placedOrientations[te]||!this.opacities[te]||this.opacities[te].isHidden()||(this.placedOrientations[te]=k[te]);o?this.lastPlacementChangeTime=n:typeof this.lastPlacementChangeTime!="number"&&(this.lastPlacementChangeTime=s?s.lastPlacementChangeTime:n)},Zi.prototype.updateLayerOpacities=function(n,s){for(var o={},u=0,y=s;u<y.length;u+=1){var w=y[u],k=w.getBucket(n);k&&w.latestFeatureIndex&&n.id===k.layerIds[0]&&this.updateBucketOpacities(k,o,w.collisionBoxArray)}},Zi.prototype.updateBucketOpacities=function(n,s,o){var u=this;n.hasTextData()&&n.text.opacityVertexArray.clear(),n.hasIconData()&&n.icon.opacityVertexArray.clear(),n.hasIconCollisionBoxData()&&n.iconCollisionBox.collisionVertexArray.clear(),n.hasTextCollisionBoxData()&&n.textCollisionBox.collisionVertexArray.clear();var y=n.layers[0].layout,w=new xn(null,0,!1,!1,!0),k=y.get("text-allow-overlap"),E=y.get("icon-allow-overlap"),P=y.get("text-variable-anchor"),O=y.get("text-rotation-alignment")==="map",Z=y.get("text-pitch-alignment")==="map",G=y.get("icon-text-fit")!=="none",X=new xn(null,0,k&&(E||!n.hasIconData()||y.get("icon-optional")),E&&(k||!n.hasTextData()||y.get("text-optional")),!0);!n.collisionArrays&&o&&(n.hasIconCollisionBoxData()||n.hasTextCollisionBoxData())&&n.deserializeCollisionBoxes(o);for(var re=function(le,pe,ge){for(var ze=0;ze<pe/4;ze++)le.opacityVertexArray.emplaceBack(ge)},te=function(le){var pe=n.symbolInstances.get(le),ge=pe.numHorizontalGlyphVertices,ze=pe.numVerticalGlyphVertices,Te=pe.crossTileID,Ae=u.opacities[Te];s[Te]?Ae=w:Ae||(u.opacities[Te]=Ae=X),s[Te]=!0;var Re=pe.numIconVertices>0,Xe=u.placedOrientations[pe.crossTileID],Ge=Xe===a.WritingMode.vertical,at=Xe===a.WritingMode.horizontal||Xe===a.WritingMode.horizontalOnly;if(ge>0||ze>0){var vt=Ns(Ae.text);re(n.text,ge,Ge?qa:vt),re(n.text,ze,at?qa:vt);var kt=Ae.text.isHidden();[pe.rightJustifiedTextSymbolIndex,pe.centerJustifiedTextSymbolIndex,pe.leftJustifiedTextSymbolIndex].forEach(function(Ct){Ct>=0&&(n.text.placedSymbolArray.get(Ct).hidden=kt||Ge?1:0)}),pe.verticalPlacedTextSymbolIndex>=0&&(n.text.placedSymbolArray.get(pe.verticalPlacedTextSymbolIndex).hidden=kt||at?1:0);var wt=u.variableOffsets[pe.crossTileID];wt&&u.markUsedJustification(n,wt.anchor,pe,Xe);var _r=u.placedOrientations[pe.crossTileID];_r&&(u.markUsedJustification(n,"left",pe,_r),u.markUsedOrientation(n,_r,pe))}if(Re){var ot=Ns(Ae.icon),Nt=!(G&&pe.verticalPlacedIconSymbolIndex&&Ge);pe.placedIconSymbolIndex>=0&&(re(n.icon,pe.numIconVertices,Nt?ot:qa),n.icon.placedSymbolArray.get(pe.placedIconSymbolIndex).hidden=Ae.icon.isHidden()),pe.verticalPlacedIconSymbolIndex>=0&&(re(n.icon,pe.numVerticalIconVertices,Nt?qa:ot),n.icon.placedSymbolArray.get(pe.verticalPlacedIconSymbolIndex).hidden=Ae.icon.isHidden())}if(n.hasIconCollisionBoxData()||n.hasTextCollisionBoxData()){var Yt=n.collisionArrays[le];if(Yt){var Ot=new a.Point(0,0);if(Yt.textBox||Yt.verticalTextBox){var Bt=!0;if(P){var Ht=u.variableOffsets[Te];Ht?(Ot=Ti(Ht.anchor,Ht.width,Ht.height,Ht.textOffset,Ht.textBoxScale),O&&Ot._rotate(Z?u.transform.angle:-u.transform.angle)):Bt=!1}Yt.textBox&&xa(n.textCollisionBox.collisionVertexArray,Ae.text.placed,!Bt||Ge,Ot.x,Ot.y),Yt.verticalTextBox&&xa(n.textCollisionBox.collisionVertexArray,Ae.text.placed,!Bt||at,Ot.x,Ot.y)}var Rt=!!(!at&&Yt.verticalIconBox);Yt.iconBox&&xa(n.iconCollisionBox.collisionVertexArray,Ae.icon.placed,Rt,G?Ot.x:0,G?Ot.y:0),Yt.verticalIconBox&&xa(n.iconCollisionBox.collisionVertexArray,Ae.icon.placed,!Rt,G?Ot.x:0,G?Ot.y:0)}}},ue=0;ue<n.symbolInstances.length;ue++)te(ue);if(n.sortFeatures(this.transform.angle),this.retainedQueryData[n.bucketInstanceId]&&(this.retainedQueryData[n.bucketInstanceId].featureSortOrder=n.featureSortOrder),n.hasTextData()&&n.text.opacityVertexBuffer&&n.text.opacityVertexBuffer.updateData(n.text.opacityVertexArray),n.hasIconData()&&n.icon.opacityVertexBuffer&&n.icon.opacityVertexBuffer.updateData(n.icon.opacityVertexArray),n.hasIconCollisionBoxData()&&n.iconCollisionBox.collisionVertexBuffer&&n.iconCollisionBox.collisionVertexBuffer.updateData(n.iconCollisionBox.collisionVertexArray),n.hasTextCollisionBoxData()&&n.textCollisionBox.collisionVertexBuffer&&n.textCollisionBox.collisionVertexBuffer.updateData(n.textCollisionBox.collisionVertexArray),n.bucketInstanceId in this.collisionCircleArrays){var Y=this.collisionCircleArrays[n.bucketInstanceId];n.placementInvProjMatrix=Y.invProjMatrix,n.placementViewportMatrix=Y.viewportMatrix,n.collisionCircleArray=Y.circles,delete this.collisionCircleArrays[n.bucketInstanceId]}},Zi.prototype.symbolFadeChange=function(n){return this.fadeDuration===0?1:(n-this.commitTime)/this.fadeDuration+this.prevZoomAdjustment},Zi.prototype.zoomAdjustment=function(n){return Math.max(0,(this.transform.zoom-n)/1.5)},Zi.prototype.hasTransitions=function(n){return this.stale||n-this.lastPlacementChangeTime<this.fadeDuration},Zi.prototype.stillRecent=function(n,s){var o=this.zoomAtLastRecencyCheck===s?1-this.zoomAdjustment(s):1;return this.zoomAtLastRecencyCheck=s,this.commitTime+this.fadeDuration*o>n},Zi.prototype.setStale=function(){this.stale=!0};var ss=Math.pow(2,25),Ol=Math.pow(2,24),po=Math.pow(2,17),Fl=Math.pow(2,16),Fo=Math.pow(2,9),Nl=Math.pow(2,8),No=Math.pow(2,1);function Ns(n){if(n.opacity===0&&!n.placed)return 0;if(n.opacity===1&&n.placed)return 4294967295;var s=n.placed?1:0,o=Math.floor(127*n.opacity);return o*ss+s*Ol+o*po+s*Fl+o*Fo+s*Nl+o*No+s}var qa=0,ls=function(n){this._sortAcrossTiles=n.layout.get("symbol-z-order")!=="viewport-y"&&n.layout.get("symbol-sort-key").constantOr(1)!==void 0,this._currentTileIndex=0,this._currentPartIndex=0,this._seenCrossTileIDs={},this._bucketParts=[]};ls.prototype.continuePlacement=function(n,s,o,u,y){for(var w=this._bucketParts;this._currentTileIndex<n.length;)if(s.getBucketParts(w,u,n[this._currentTileIndex],this._sortAcrossTiles),this._currentTileIndex++,y())return!0;for(this._sortAcrossTiles&&(this._sortAcrossTiles=!1,w.sort(function(k,E){return k.sortKey-E.sortKey}));this._currentPartIndex<w.length;)if(s.placeLayerBucketPart(w[this._currentPartIndex],this._seenCrossTileIDs,o),this._currentPartIndex++,y())return!0;return!1};var fo=function(n,s,o,u,y,w,k){this.placement=new Zi(n,y,w,k),this._currentPlacementIndex=s.length-1,this._forceFullPlacement=o,this._showCollisionBoxes=u,this._done=!1};fo.prototype.isDone=function(){return this._done},fo.prototype.continuePlacement=function(n,s,o){for(var u=this,y=a.browser.now(),w=function(){var P=a.browser.now()-y;return!u._forceFullPlacement&&P>2};this._currentPlacementIndex>=0;){var k=s[n[this._currentPlacementIndex]],E=this.placement.collisionIndex.transform.zoom;if(k.type==="symbol"&&(!k.minzoom||k.minzoom<=E)&&(!k.maxzoom||k.maxzoom>E)){if(this._inProgressLayer||(this._inProgressLayer=new ls(k)),this._inProgressLayer.continuePlacement(o[k.source],this.placement,this._showCollisionBoxes,k,w))return;delete this._inProgressLayer}this._currentPlacementIndex--}this._done=!0},fo.prototype.commit=function(n){return this.placement.commit(n),this.placement};var Us=512/a.EXTENT/2,Za=function(n,s,o){this.tileID=n,this.indexedSymbolInstances={},this.bucketInstanceId=o;for(var u=0;u<s.length;u++){var y=s.get(u),w=y.key;this.indexedSymbolInstances[w]||(this.indexedSymbolInstances[w]=[]),this.indexedSymbolInstances[w].push({crossTileID:y.crossTileID,coord:this.getScaledCoordinates(y,n)})}};Za.prototype.getScaledCoordinates=function(n,s){var o=Us/Math.pow(2,s.canonical.z-this.tileID.canonical.z);return{x:Math.floor((s.canonical.x*a.EXTENT+n.anchorX)*o),y:Math.floor((s.canonical.y*a.EXTENT+n.anchorY)*o)}},Za.prototype.findMatches=function(n,s,o){for(var u=this.tileID.canonical.z<s.canonical.z?1:Math.pow(2,this.tileID.canonical.z-s.canonical.z),y=0;y<n.length;y++){var w=n.get(y);if(!w.crossTileID){var k=this.indexedSymbolInstances[w.key];if(k)for(var E=this.getScaledCoordinates(w,s),P=0,O=k;P<O.length;P+=1){var Z=O[P];if(Math.abs(Z.coord.x-E.x)<=u&&Math.abs(Z.coord.y-E.y)<=u&&!o[Z.crossTileID]){o[Z.crossTileID]=!0,w.crossTileID=Z.crossTileID;break}}}}};var Fn=function(){this.maxCrossTileID=0};Fn.prototype.generate=function(){return++this.maxCrossTileID};var wa=function(){this.indexes={},this.usedCrossTileIDs={},this.lng=0};wa.prototype.handleWrapJump=function(n){var s=Math.round((n-this.lng)/360);if(s!==0)for(var o in this.indexes){var u=this.indexes[o],y={};for(var w in u){var k=u[w];k.tileID=k.tileID.unwrapTo(k.tileID.wrap+s),y[k.tileID.key]=k}this.indexes[o]=y}this.lng=n},wa.prototype.addBucket=function(n,s,o){if(this.indexes[n.overscaledZ]&&this.indexes[n.overscaledZ][n.key]){if(this.indexes[n.overscaledZ][n.key].bucketInstanceId===s.bucketInstanceId)return!1;this.removeBucketCrossTileIDs(n.overscaledZ,this.indexes[n.overscaledZ][n.key])}for(var u=0;u<s.symbolInstances.length;u++)s.symbolInstances.get(u).crossTileID=0;this.usedCrossTileIDs[n.overscaledZ]||(this.usedCrossTileIDs[n.overscaledZ]={});var y=this.usedCrossTileIDs[n.overscaledZ];for(var w in this.indexes){var k=this.indexes[w];if(Number(w)>n.overscaledZ)for(var E in k){var P=k[E];P.tileID.isChildOf(n)&&P.findMatches(s.symbolInstances,n,y)}else{var O=k[n.scaledTo(Number(w)).key];O&&O.findMatches(s.symbolInstances,n,y)}}for(var Z=0;Z<s.symbolInstances.length;Z++){var G=s.symbolInstances.get(Z);G.crossTileID||(G.crossTileID=o.generate(),y[G.crossTileID]=!0)}return this.indexes[n.overscaledZ]===void 0&&(this.indexes[n.overscaledZ]={}),this.indexes[n.overscaledZ][n.key]=new Za(n,s.symbolInstances,s.bucketInstanceId),!0},wa.prototype.removeBucketCrossTileIDs=function(n,s){for(var o in s.indexedSymbolInstances)for(var u=0,y=s.indexedSymbolInstances[o];u<y.length;u+=1)delete this.usedCrossTileIDs[n][y[u].crossTileID]},wa.prototype.removeStaleBuckets=function(n){var s=!1;for(var o in this.indexes){var u=this.indexes[o];for(var y in u)n[u[y].bucketInstanceId]||(this.removeBucketCrossTileIDs(o,u[y]),delete u[y],s=!0)}return s};var ye=function(){this.layerIndexes={},this.crossTileIDs=new Fn,this.maxBucketInstanceId=0,this.bucketsInCurrentPlacement={}};ye.prototype.addLayer=function(n,s,o){var u=this.layerIndexes[n.id];u===void 0&&(u=this.layerIndexes[n.id]=new wa);var y=!1,w={};u.handleWrapJump(o);for(var k=0,E=s;k<E.length;k+=1){var P=E[k],O=P.getBucket(n);O&&n.id===O.layerIds[0]&&(O.bucketInstanceId||(O.bucketInstanceId=++this.maxBucketInstanceId),u.addBucket(P.tileID,O,this.crossTileIDs)&&(y=!0),w[O.bucketInstanceId]=!0)}return u.removeStaleBuckets(w)&&(y=!0),y},ye.prototype.pruneUnusedLayers=function(n){var s={};for(var o in n.forEach(function(u){s[u]=!0}),this.layerIndexes)s[o]||delete this.layerIndexes[o]};var hn=function(n,s){return a.emitValidationErrors(n,s&&s.filter(function(o){return o.identifier!=="source.canvas"}))},Gi=a.pick(qe,["addLayer","removeLayer","setPaintProperty","setLayoutProperty","setFilter","addSource","removeSource","setLayerZoomRange","setLight","setTransition","setGeoJSONSourceData"]),Wr=a.pick(qe,["setCenter","setZoom","setBearing","setPitch"]),ka=function(){var n={},s=a.styleSpec.$version;for(var o in a.styleSpec.$root){var u,y=a.styleSpec.$root[o];y.required&&(u=o==="version"?s:y.type==="array"?[]:{})!=null&&(n[o]=u)}return n}(),Nn=function(n){function s(o,u){var y=this;u===void 0&&(u={}),n.call(this),this.map=o,this.dispatcher=new It(Se(),this),this.imageManager=new xe,this.imageManager.setEventedParent(this),this.glyphManager=new qt(o._requestManager,u.localIdeographFontFamily),this.lineAtlas=new yt(256,512),this.crossTileSymbolIndex=new ye,this._layers={},this._serializedLayers={},this._order=[],this.sourceCaches={},this.zoomHistory=new a.ZoomHistory,this._loaded=!1,this._availableImages=[],this._resetUpdates(),this.dispatcher.broadcast("setReferrer",a.getReferrer());var w=this;this._rtlTextPluginCallback=s.registerForPluginStateChange(function(k){w.dispatcher.broadcast("syncRTLPluginState",{pluginStatus:k.pluginStatus,pluginURL:k.pluginURL},function(E,P){if(a.triggerPluginCompletionEvent(E),P&&P.every(function(Z){return Z}))for(var O in w.sourceCaches)w.sourceCaches[O].reload()})}),this.on("data",function(k){if(k.dataType==="source"&&k.sourceDataType==="metadata"){var E=y.sourceCaches[k.sourceId];if(E){var P=E.getSource();if(P&&P.vectorLayerIds)for(var O in y._layers){var Z=y._layers[O];Z.source===P.id&&y._validateLayer(Z)}}}})}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype.loadURL=function(o,u){var y=this;u===void 0&&(u={}),this.fire(new a.Event("dataloading",{dataType:"style"}));var w=typeof u.validate=="boolean"?u.validate:!a.isMapboxURL(o);o=this.map._requestManager.normalizeStyleURL(o,u.accessToken);var k=this.map._requestManager.transformRequest(o,a.ResourceType.Style);this._request=a.getJSON(k,function(E,P){y._request=null,E?y.fire(new a.ErrorEvent(E)):P&&y._load(P,w)})},s.prototype.loadJSON=function(o,u){var y=this;u===void 0&&(u={}),this.fire(new a.Event("dataloading",{dataType:"style"})),this._request=a.browser.frame(function(){y._request=null,y._load(o,u.validate!==!1)})},s.prototype.loadEmpty=function(){this.fire(new a.Event("dataloading",{dataType:"style"})),this._load(ka,!1)},s.prototype._load=function(o,u){if(!u||!hn(this,a.validateStyle(o))){for(var y in this._loaded=!0,this.stylesheet=o,o.sources)this.addSource(y,o.sources[y],{validate:!1});o.sprite?this._loadSprite(o.sprite):this.imageManager.setLoaded(!0),this.glyphManager.setURL(o.glyphs);var w=Fe(this.stylesheet.layers);this._order=w.map(function(O){return O.id}),this._layers={},this._serializedLayers={};for(var k=0,E=w;k<E.length;k+=1){var P=E[k];(P=a.createStyleLayer(P)).setEventedParent(this,{layer:{id:P.id}}),this._layers[P.id]=P,this._serializedLayers[P.id]=P.serialize()}this.dispatcher.broadcast("setLayers",this._serializeLayers(this._order)),this.light=new Ft(this.stylesheet.light),this.fire(new a.Event("data",{dataType:"style"})),this.fire(new a.Event("style.load"))}},s.prototype._loadSprite=function(o){var u=this;this._spriteRequest=function(y,w,k){var E,P,O,Z=a.browser.devicePixelRatio>1?"@2x":"",G=a.getJSON(w.transformRequest(w.normalizeSpriteURL(y,Z,".json"),a.ResourceType.SpriteJSON),function(te,ue){G=null,O||(O=te,E=ue,re())}),X=a.getImage(w.transformRequest(w.normalizeSpriteURL(y,Z,".png"),a.ResourceType.SpriteImage),function(te,ue){X=null,O||(O=te,P=ue,re())});function re(){if(O)k(O);else if(E&&P){var te=a.browser.getImageData(P),ue={};for(var Y in E){var le=E[Y],pe=le.width,ge=le.height,ze=le.x,Te=le.y,Ae=le.sdf,Re=le.pixelRatio,Xe=le.stretchX,Ge=le.stretchY,at=le.content,vt=new a.RGBAImage({width:pe,height:ge});a.RGBAImage.copy(te,vt,{x:ze,y:Te},{x:0,y:0},{width:pe,height:ge}),ue[Y]={data:vt,pixelRatio:Re,sdf:Ae,stretchX:Xe,stretchY:Ge,content:at}}k(null,ue)}}return{cancel:function(){G&&(G.cancel(),G=null),X&&(X.cancel(),X=null)}}}(o,this.map._requestManager,function(y,w){if(u._spriteRequest=null,y)u.fire(new a.ErrorEvent(y));else if(w)for(var k in w)u.imageManager.addImage(k,w[k]);u.imageManager.setLoaded(!0),u._availableImages=u.imageManager.listImages(),u.dispatcher.broadcast("setImages",u._availableImages),u.fire(new a.Event("data",{dataType:"style"}))})},s.prototype._validateLayer=function(o){var u=this.sourceCaches[o.source];if(u){var y=o.sourceLayer;if(y){var w=u.getSource();(w.type==="geojson"||w.vectorLayerIds&&w.vectorLayerIds.indexOf(y)===-1)&&this.fire(new a.ErrorEvent(new Error('Source layer "'+y+'" does not exist on source "'+w.id+'" as specified by style layer "'+o.id+'"')))}}},s.prototype.loaded=function(){if(!this._loaded||Object.keys(this._updatedSources).length)return!1;for(var o in this.sourceCaches)if(!this.sourceCaches[o].loaded())return!1;return!!this.imageManager.isLoaded()},s.prototype._serializeLayers=function(o){for(var u=[],y=0,w=o;y<w.length;y+=1){var k=this._layers[w[y]];k.type!=="custom"&&u.push(k.serialize())}return u},s.prototype.hasTransitions=function(){if(this.light&&this.light.hasTransition())return!0;for(var o in this.sourceCaches)if(this.sourceCaches[o].hasTransition())return!0;for(var u in this._layers)if(this._layers[u].hasTransition())return!0;return!1},s.prototype._checkLoaded=function(){if(!this._loaded)throw new Error("Style is not done loading")},s.prototype.update=function(o){if(this._loaded){var u=this._changed;if(this._changed){var y=Object.keys(this._updatedLayers),w=Object.keys(this._removedLayers);for(var k in(y.length||w.length)&&this._updateWorkerLayers(y,w),this._updatedSources){var E=this._updatedSources[k];E==="reload"?this._reloadSource(k):E==="clear"&&this._clearSource(k)}for(var P in this._updateTilesForChangedImages(),this._updatedPaintProps)this._layers[P].updateTransitions(o);this.light.updateTransitions(o),this._resetUpdates()}var O={};for(var Z in this.sourceCaches){var G=this.sourceCaches[Z];O[Z]=G.used,G.used=!1}for(var X=0,re=this._order;X<re.length;X+=1){var te=this._layers[re[X]];te.recalculate(o,this._availableImages),!te.isHidden(o.zoom)&&te.source&&(this.sourceCaches[te.source].used=!0)}for(var ue in O){var Y=this.sourceCaches[ue];O[ue]!==Y.used&&Y.fire(new a.Event("data",{sourceDataType:"visibility",dataType:"source",sourceId:ue}))}this.light.recalculate(o),this.z=o.zoom,u&&this.fire(new a.Event("data",{dataType:"style"}))}},s.prototype._updateTilesForChangedImages=function(){var o=Object.keys(this._changedImages);if(o.length){for(var u in this.sourceCaches)this.sourceCaches[u].reloadTilesForDependencies(["icons","patterns"],o);this._changedImages={}}},s.prototype._updateWorkerLayers=function(o,u){this.dispatcher.broadcast("updateLayers",{layers:this._serializeLayers(o),removedIds:u})},s.prototype._resetUpdates=function(){this._changed=!1,this._updatedLayers={},this._removedLayers={},this._updatedSources={},this._updatedPaintProps={},this._changedImages={}},s.prototype.setState=function(o){var u=this;if(this._checkLoaded(),hn(this,a.validateStyle(o)))return!1;(o=a.clone$1(o)).layers=Fe(o.layers);var y=function(k,E){if(!k)return[{command:qe.setStyle,args:[E]}];var P=[];try{if(!a.deepEqual(k.version,E.version))return[{command:qe.setStyle,args:[E]}];a.deepEqual(k.center,E.center)||P.push({command:qe.setCenter,args:[E.center]}),a.deepEqual(k.zoom,E.zoom)||P.push({command:qe.setZoom,args:[E.zoom]}),a.deepEqual(k.bearing,E.bearing)||P.push({command:qe.setBearing,args:[E.bearing]}),a.deepEqual(k.pitch,E.pitch)||P.push({command:qe.setPitch,args:[E.pitch]}),a.deepEqual(k.sprite,E.sprite)||P.push({command:qe.setSprite,args:[E.sprite]}),a.deepEqual(k.glyphs,E.glyphs)||P.push({command:qe.setGlyphs,args:[E.glyphs]}),a.deepEqual(k.transition,E.transition)||P.push({command:qe.setTransition,args:[E.transition]}),a.deepEqual(k.light,E.light)||P.push({command:qe.setLight,args:[E.light]});var O={},Z=[];(function(X,re,te,ue){var Y;for(Y in re=re||{},X=X||{})X.hasOwnProperty(Y)&&(re.hasOwnProperty(Y)||Ze(Y,te,ue));for(Y in re)re.hasOwnProperty(Y)&&(X.hasOwnProperty(Y)?a.deepEqual(X[Y],re[Y])||(X[Y].type==="geojson"&&re[Y].type==="geojson"&&lr(X,re,Y)?te.push({command:qe.setGeoJSONSourceData,args:[Y,re[Y].data]}):Vt(Y,re,te,ue)):Mt(Y,re,te))})(k.sources,E.sources,Z,O);var G=[];k.layers&&k.layers.forEach(function(X){O[X.source]?P.push({command:qe.removeLayer,args:[X.id]}):G.push(X)}),P=P.concat(Z),function(X,re,te){re=re||[];var ue,Y,le,pe,ge,ze,Te,Ae=(X=X||[]).map(er),Re=re.map(er),Xe=X.reduce(Jt,{}),Ge=re.reduce(Jt,{}),at=Ae.slice(),vt=Object.create(null);for(ue=0,Y=0;ue<Ae.length;ue++)Ge.hasOwnProperty(le=Ae[ue])?Y++:(te.push({command:qe.removeLayer,args:[le]}),at.splice(at.indexOf(le,Y),1));for(ue=0,Y=0;ue<Re.length;ue++)at[at.length-1-ue]!==(le=Re[Re.length-1-ue])&&(Xe.hasOwnProperty(le)?(te.push({command:qe.removeLayer,args:[le]}),at.splice(at.lastIndexOf(le,at.length-Y),1)):Y++,te.push({command:qe.addLayer,args:[Ge[le],ze=at[at.length-ue]]}),at.splice(at.length-ue,0,le),vt[le]=!0);for(ue=0;ue<Re.length;ue++)if(pe=Xe[le=Re[ue]],ge=Ge[le],!vt[le]&&!a.deepEqual(pe,ge))if(a.deepEqual(pe.source,ge.source)&&a.deepEqual(pe["source-layer"],ge["source-layer"])&&a.deepEqual(pe.type,ge.type)){for(Te in Pt(pe.layout,ge.layout,te,le,null,qe.setLayoutProperty),Pt(pe.paint,ge.paint,te,le,null,qe.setPaintProperty),a.deepEqual(pe.filter,ge.filter)||te.push({command:qe.setFilter,args:[le,ge.filter]}),a.deepEqual(pe.minzoom,ge.minzoom)&&a.deepEqual(pe.maxzoom,ge.maxzoom)||te.push({command:qe.setLayerZoomRange,args:[le,ge.minzoom,ge.maxzoom]}),pe)pe.hasOwnProperty(Te)&&Te!=="layout"&&Te!=="paint"&&Te!=="filter"&&Te!=="metadata"&&Te!=="minzoom"&&Te!=="maxzoom"&&(Te.indexOf("paint.")===0?Pt(pe[Te],ge[Te],te,le,Te.slice(6),qe.setPaintProperty):a.deepEqual(pe[Te],ge[Te])||te.push({command:qe.setLayerProperty,args:[le,Te,ge[Te]]}));for(Te in ge)ge.hasOwnProperty(Te)&&!pe.hasOwnProperty(Te)&&Te!=="layout"&&Te!=="paint"&&Te!=="filter"&&Te!=="metadata"&&Te!=="minzoom"&&Te!=="maxzoom"&&(Te.indexOf("paint.")===0?Pt(pe[Te],ge[Te],te,le,Te.slice(6),qe.setPaintProperty):a.deepEqual(pe[Te],ge[Te])||te.push({command:qe.setLayerProperty,args:[le,Te,ge[Te]]}))}else te.push({command:qe.removeLayer,args:[le]}),ze=at[at.lastIndexOf(le)+1],te.push({command:qe.addLayer,args:[ge,ze]})}(G,E.layers,P)}catch(X){console.warn("Unable to compute style diff:",X),P=[{command:qe.setStyle,args:[E]}]}return P}(this.serialize(),o).filter(function(k){return!(k.command in Wr)});if(y.length===0)return!1;var w=y.filter(function(k){return!(k.command in Gi)});if(w.length>0)throw new Error("Unimplemented: "+w.map(function(k){return k.command}).join(", ")+".");return y.forEach(function(k){k.command!=="setTransition"&&u[k.command].apply(u,k.args)}),this.stylesheet=o,!0},s.prototype.addImage=function(o,u){if(this.getImage(o))return this.fire(new a.ErrorEvent(new Error("An image with this name already exists.")));this.imageManager.addImage(o,u),this._afterImageUpdated(o)},s.prototype.updateImage=function(o,u){this.imageManager.updateImage(o,u)},s.prototype.getImage=function(o){return this.imageManager.getImage(o)},s.prototype.removeImage=function(o){if(!this.getImage(o))return this.fire(new a.ErrorEvent(new Error("No image with this name exists.")));this.imageManager.removeImage(o),this._afterImageUpdated(o)},s.prototype._afterImageUpdated=function(o){this._availableImages=this.imageManager.listImages(),this._changedImages[o]=!0,this._changed=!0,this.dispatcher.broadcast("setImages",this._availableImages),this.fire(new a.Event("data",{dataType:"style"}))},s.prototype.listImages=function(){return this._checkLoaded(),this.imageManager.listImages()},s.prototype.addSource=function(o,u,y){var w=this;if(y===void 0&&(y={}),this._checkLoaded(),this.sourceCaches[o]!==void 0)throw new Error("There is already a source with this ID");if(!u.type)throw new Error("The type property must be defined, but only the following properties were given: "+Object.keys(u).join(", ")+".");if(!(["vector","raster","geojson","video","image"].indexOf(u.type)>=0&&this._validate(a.validateStyle.source,"sources."+o,u,null,y))){this.map&&this.map._collectResourceTiming&&(u.collectResourceTiming=!0);var k=this.sourceCaches[o]=new J(o,u,this.dispatcher);k.style=this,k.setEventedParent(this,function(){return{isSourceLoaded:w.loaded(),source:k.serialize(),sourceId:o}}),k.onAdd(this.map),this._changed=!0}},s.prototype.removeSource=function(o){if(this._checkLoaded(),this.sourceCaches[o]===void 0)throw new Error("There is no source with this ID");for(var u in this._layers)if(this._layers[u].source===o)return this.fire(new a.ErrorEvent(new Error('Source "'+o+'" cannot be removed while layer "'+u+'" is using it.')));var y=this.sourceCaches[o];delete this.sourceCaches[o],delete this._updatedSources[o],y.fire(new a.Event("data",{sourceDataType:"metadata",dataType:"source",sourceId:o})),y.setEventedParent(null),y.clearTiles(),y.onRemove&&y.onRemove(this.map),this._changed=!0},s.prototype.setGeoJSONSourceData=function(o,u){this._checkLoaded(),this.sourceCaches[o].getSource().setData(u),this._changed=!0},s.prototype.getSource=function(o){return this.sourceCaches[o]&&this.sourceCaches[o].getSource()},s.prototype.addLayer=function(o,u,y){y===void 0&&(y={}),this._checkLoaded();var w=o.id;if(this.getLayer(w))this.fire(new a.ErrorEvent(new Error('Layer with id "'+w+'" already exists on this map')));else{var k;if(o.type==="custom"){if(hn(this,a.validateCustomStyleLayer(o)))return;k=a.createStyleLayer(o)}else{if(typeof o.source=="object"&&(this.addSource(w,o.source),o=a.clone$1(o),o=a.extend(o,{source:w})),this._validate(a.validateStyle.layer,"layers."+w,o,{arrayIndex:-1},y))return;k=a.createStyleLayer(o),this._validateLayer(k),k.setEventedParent(this,{layer:{id:w}}),this._serializedLayers[k.id]=k.serialize()}var E=u?this._order.indexOf(u):this._order.length;if(u&&E===-1)this.fire(new a.ErrorEvent(new Error('Layer with id "'+u+'" does not exist on this map.')));else{if(this._order.splice(E,0,w),this._layerOrderChanged=!0,this._layers[w]=k,this._removedLayers[w]&&k.source&&k.type!=="custom"){var P=this._removedLayers[w];delete this._removedLayers[w],P.type!==k.type?this._updatedSources[k.source]="clear":(this._updatedSources[k.source]="reload",this.sourceCaches[k.source].pause())}this._updateLayer(k),k.onAdd&&k.onAdd(this.map)}}},s.prototype.moveLayer=function(o,u){if(this._checkLoaded(),this._changed=!0,this._layers[o]){if(o!==u){var y=this._order.indexOf(o);this._order.splice(y,1);var w=u?this._order.indexOf(u):this._order.length;u&&w===-1?this.fire(new a.ErrorEvent(new Error('Layer with id "'+u+'" does not exist on this map.'))):(this._order.splice(w,0,o),this._layerOrderChanged=!0)}}else this.fire(new a.ErrorEvent(new Error("The layer '"+o+"' does not exist in the map's style and cannot be moved.")))},s.prototype.removeLayer=function(o){this._checkLoaded();var u=this._layers[o];if(u){u.setEventedParent(null);var y=this._order.indexOf(o);this._order.splice(y,1),this._layerOrderChanged=!0,this._changed=!0,this._removedLayers[o]=u,delete this._layers[o],delete this._serializedLayers[o],delete this._updatedLayers[o],delete this._updatedPaintProps[o],u.onRemove&&u.onRemove(this.map)}else this.fire(new a.ErrorEvent(new Error("The layer '"+o+"' does not exist in the map's style and cannot be removed.")))},s.prototype.getLayer=function(o){return this._layers[o]},s.prototype.hasLayer=function(o){return o in this._layers},s.prototype.setLayerZoomRange=function(o,u,y){this._checkLoaded();var w=this.getLayer(o);w?w.minzoom===u&&w.maxzoom===y||(u!=null&&(w.minzoom=u),y!=null&&(w.maxzoom=y),this._updateLayer(w)):this.fire(new a.ErrorEvent(new Error("The layer '"+o+"' does not exist in the map's style and cannot have zoom extent.")))},s.prototype.setFilter=function(o,u,y){y===void 0&&(y={}),this._checkLoaded();var w=this.getLayer(o);if(w){if(!a.deepEqual(w.filter,u))return u==null?(w.filter=void 0,void this._updateLayer(w)):void(this._validate(a.validateStyle.filter,"layers."+w.id+".filter",u,null,y)||(w.filter=a.clone$1(u),this._updateLayer(w)))}else this.fire(new a.ErrorEvent(new Error("The layer '"+o+"' does not exist in the map's style and cannot be filtered.")))},s.prototype.getFilter=function(o){return a.clone$1(this.getLayer(o).filter)},s.prototype.setLayoutProperty=function(o,u,y,w){w===void 0&&(w={}),this._checkLoaded();var k=this.getLayer(o);k?a.deepEqual(k.getLayoutProperty(u),y)||(k.setLayoutProperty(u,y,w),this._updateLayer(k)):this.fire(new a.ErrorEvent(new Error("The layer '"+o+"' does not exist in the map's style and cannot be styled.")))},s.prototype.getLayoutProperty=function(o,u){var y=this.getLayer(o);if(y)return y.getLayoutProperty(u);this.fire(new a.ErrorEvent(new Error("The layer '"+o+"' does not exist in the map's style.")))},s.prototype.setPaintProperty=function(o,u,y,w){w===void 0&&(w={}),this._checkLoaded();var k=this.getLayer(o);k?a.deepEqual(k.getPaintProperty(u),y)||(k.setPaintProperty(u,y,w)&&this._updateLayer(k),this._changed=!0,this._updatedPaintProps[o]=!0):this.fire(new a.ErrorEvent(new Error("The layer '"+o+"' does not exist in the map's style and cannot be styled.")))},s.prototype.getPaintProperty=function(o,u){return this.getLayer(o).getPaintProperty(u)},s.prototype.setFeatureState=function(o,u){this._checkLoaded();var y=o.source,w=o.sourceLayer,k=this.sourceCaches[y];if(k!==void 0){var E=k.getSource().type;E==="geojson"&&w?this.fire(new a.ErrorEvent(new Error("GeoJSON sources cannot have a sourceLayer parameter."))):E!=="vector"||w?(o.id===void 0&&this.fire(new a.ErrorEvent(new Error("The feature id parameter must be provided."))),k.setFeatureState(w,o.id,u)):this.fire(new a.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")))}else this.fire(new a.ErrorEvent(new Error("The source '"+y+"' does not exist in the map's style.")))},s.prototype.removeFeatureState=function(o,u){this._checkLoaded();var y=o.source,w=this.sourceCaches[y];if(w!==void 0){var k=w.getSource().type,E=k==="vector"?o.sourceLayer:void 0;k!=="vector"||E?u&&typeof o.id!="string"&&typeof o.id!="number"?this.fire(new a.ErrorEvent(new Error("A feature id is required to remove its specific state property."))):w.removeFeatureState(E,o.id,u):this.fire(new a.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")))}else this.fire(new a.ErrorEvent(new Error("The source '"+y+"' does not exist in the map's style.")))},s.prototype.getFeatureState=function(o){this._checkLoaded();var u=o.source,y=o.sourceLayer,w=this.sourceCaches[u];if(w!==void 0){if(w.getSource().type!=="vector"||y)return o.id===void 0&&this.fire(new a.ErrorEvent(new Error("The feature id parameter must be provided."))),w.getFeatureState(y,o.id);this.fire(new a.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")))}else this.fire(new a.ErrorEvent(new Error("The source '"+u+"' does not exist in the map's style.")))},s.prototype.getTransition=function(){return a.extend({duration:300,delay:0},this.stylesheet&&this.stylesheet.transition)},s.prototype.serialize=function(){return a.filterObject({version:this.stylesheet.version,name:this.stylesheet.name,metadata:this.stylesheet.metadata,light:this.stylesheet.light,center:this.stylesheet.center,zoom:this.stylesheet.zoom,bearing:this.stylesheet.bearing,pitch:this.stylesheet.pitch,sprite:this.stylesheet.sprite,glyphs:this.stylesheet.glyphs,transition:this.stylesheet.transition,sources:a.mapObject(this.sourceCaches,function(o){return o.serialize()}),layers:this._serializeLayers(this._order)},function(o){return o!==void 0})},s.prototype._updateLayer=function(o){this._updatedLayers[o.id]=!0,o.source&&!this._updatedSources[o.source]&&this.sourceCaches[o.source].getSource().type!=="raster"&&(this._updatedSources[o.source]="reload",this.sourceCaches[o.source].pause()),this._changed=!0},s.prototype._flattenAndSortRenderedFeatures=function(o){for(var u=this,y=function(Xe){return u._layers[Xe].type==="fill-extrusion"},w={},k=[],E=this._order.length-1;E>=0;E--){var P=this._order[E];if(y(P)){w[P]=E;for(var O=0,Z=o;O<Z.length;O+=1){var G=Z[O][P];if(G)for(var X=0,re=G;X<re.length;X+=1)k.push(re[X])}}}k.sort(function(Xe,Ge){return Ge.intersectionZ-Xe.intersectionZ});for(var te=[],ue=this._order.length-1;ue>=0;ue--){var Y=this._order[ue];if(y(Y))for(var le=k.length-1;le>=0;le--){var pe=k[le].feature;if(w[pe.layer.id]<ue)break;te.push(pe),k.pop()}else for(var ge=0,ze=o;ge<ze.length;ge+=1){var Te=ze[ge][Y];if(Te)for(var Ae=0,Re=Te;Ae<Re.length;Ae+=1)te.push(Re[Ae].feature)}}return te},s.prototype.queryRenderedFeatures=function(o,u,y){u&&u.filter&&this._validate(a.validateStyle.filter,"queryRenderedFeatures.filter",u.filter,null,u);var w={};if(u&&u.layers){if(!Array.isArray(u.layers))return this.fire(new a.ErrorEvent(new Error("parameters.layers must be an Array."))),[];for(var k=0,E=u.layers;k<E.length;k+=1){var P=E[k],O=this._layers[P];if(!O)return this.fire(new a.ErrorEvent(new Error("The layer '"+P+"' does not exist in the map's style and cannot be queried for features."))),[];w[O.source]=!0}}var Z=[];for(var G in u.availableImages=this._availableImages,this.sourceCaches)u.layers&&!w[G]||Z.push(sr(this.sourceCaches[G],this._layers,this._serializedLayers,o,u,y));return this.placement&&Z.push(function(X,re,te,ue,Y,le,pe){for(var ge={},ze=le.queryRenderedSymbols(ue),Te=[],Ae=0,Re=Object.keys(ze).map(Number);Ae<Re.length;Ae+=1)Te.push(pe[Re[Ae]]);Te.sort(ti);for(var Xe=function(){var wt=at[Ge],_r=wt.featureIndex.lookupSymbolFeatures(ze[wt.bucketInstanceId],re,wt.bucketIndex,wt.sourceLayerIndex,Y.filter,Y.layers,Y.availableImages,X);for(var ot in _r){var Nt=ge[ot]=ge[ot]||[],Yt=_r[ot];Yt.sort(function(Ht,Rt){var Ct=wt.featureSortOrder;if(Ct){var Li=Ct.indexOf(Ht.featureIndex);return Ct.indexOf(Rt.featureIndex)-Li}return Rt.featureIndex-Ht.featureIndex});for(var Ot=0,Bt=Yt;Ot<Bt.length;Ot+=1)Nt.push(Bt[Ot])}},Ge=0,at=Te;Ge<at.length;Ge+=1)Xe();var vt=function(wt){ge[wt].forEach(function(_r){var ot=_r.feature,Nt=te[X[wt].source].getFeatureState(ot.layer["source-layer"],ot.id);ot.source=ot.layer.source,ot.layer["source-layer"]&&(ot.sourceLayer=ot.layer["source-layer"]),ot.state=Nt})};for(var kt in ge)vt(kt);return ge}(this._layers,this._serializedLayers,this.sourceCaches,o,u,this.placement.collisionIndex,this.placement.retainedQueryData)),this._flattenAndSortRenderedFeatures(Z)},s.prototype.querySourceFeatures=function(o,u){u&&u.filter&&this._validate(a.validateStyle.filter,"querySourceFeatures.filter",u.filter,null,u);var y=this.sourceCaches[o];return y?function(w,k){for(var E=w.getRenderableIds().map(function(re){return w.getTileByID(re)}),P=[],O={},Z=0;Z<E.length;Z++){var G=E[Z],X=G.tileID.canonical.key;O[X]||(O[X]=!0,G.querySourceFeatures(P,k))}return P}(y,u):[]},s.prototype.addSourceType=function(o,u,y){return s.getSourceType(o)?y(new Error('A source type called "'+o+'" already exists.')):(s.setSourceType(o,u),u.workerSourceURL?void this.dispatcher.broadcast("loadWorkerSource",{name:o,url:u.workerSourceURL},y):y(null,null))},s.prototype.getLight=function(){return this.light.getLight()},s.prototype.setLight=function(o,u){u===void 0&&(u={}),this._checkLoaded();var y=this.light.getLight(),w=!1;for(var k in o)if(!a.deepEqual(o[k],y[k])){w=!0;break}if(w){var E={now:a.browser.now(),transition:a.extend({duration:300,delay:0},this.stylesheet.transition)};this.light.setLight(o,u),this.light.updateTransitions(E)}},s.prototype._validate=function(o,u,y,w,k){return k===void 0&&(k={}),(!k||k.validate!==!1)&&hn(this,o.call(a.validateStyle,a.extend({key:u,style:this.serialize(),value:y,styleSpec:a.styleSpec},w)))},s.prototype._remove=function(){for(var o in this._request&&(this._request.cancel(),this._request=null),this._spriteRequest&&(this._spriteRequest.cancel(),this._spriteRequest=null),a.evented.off("pluginStateChange",this._rtlTextPluginCallback),this._layers)this._layers[o].setEventedParent(null);for(var u in this.sourceCaches)this.sourceCaches[u].clearTiles(),this.sourceCaches[u].setEventedParent(null);this.imageManager.setEventedParent(null),this.setEventedParent(null),this.dispatcher.remove()},s.prototype._clearSource=function(o){this.sourceCaches[o].clearTiles()},s.prototype._reloadSource=function(o){this.sourceCaches[o].resume(),this.sourceCaches[o].reload()},s.prototype._updateSources=function(o){for(var u in this.sourceCaches)this.sourceCaches[u].update(o)},s.prototype._generateCollisionBoxes=function(){for(var o in this.sourceCaches)this._reloadSource(o)},s.prototype._updatePlacement=function(o,u,y,w,k){k===void 0&&(k=!1);for(var E=!1,P=!1,O={},Z=0,G=this._order;Z<G.length;Z+=1){var X=this._layers[G[Z]];if(X.type==="symbol"){if(!O[X.source]){var re=this.sourceCaches[X.source];O[X.source]=re.getRenderableIds(!0).map(function(pe){return re.getTileByID(pe)}).sort(function(pe,ge){return ge.tileID.overscaledZ-pe.tileID.overscaledZ||(pe.tileID.isLessThan(ge.tileID)?-1:1)})}var te=this.crossTileSymbolIndex.addLayer(X,O[X.source],o.center.lng);E=E||te}}if(this.crossTileSymbolIndex.pruneUnusedLayers(this._order),((k=k||this._layerOrderChanged||y===0)||!this.pauseablePlacement||this.pauseablePlacement.isDone()&&!this.placement.stillRecent(a.browser.now(),o.zoom))&&(this.pauseablePlacement=new fo(o,this._order,k,u,y,w,this.placement),this._layerOrderChanged=!1),this.pauseablePlacement.isDone()?this.placement.setStale():(this.pauseablePlacement.continuePlacement(this._order,this._layers,O),this.pauseablePlacement.isDone()&&(this.placement=this.pauseablePlacement.commit(a.browser.now()),P=!0),E&&this.pauseablePlacement.placement.setStale()),P||E)for(var ue=0,Y=this._order;ue<Y.length;ue+=1){var le=this._layers[Y[ue]];le.type==="symbol"&&this.placement.updateLayerOpacities(le,O[le.source])}return!this.pauseablePlacement.isDone()||this.placement.hasTransitions(a.browser.now())},s.prototype._releaseSymbolFadeTiles=function(){for(var o in this.sourceCaches)this.sourceCaches[o].releaseSymbolFadeTiles()},s.prototype.getImages=function(o,u,y){this.imageManager.getImages(u.icons,y),this._updateTilesForChangedImages();var w=this.sourceCaches[u.source];w&&w.setDependencies(u.tileID.key,u.type,u.icons)},s.prototype.getGlyphs=function(o,u,y){this.glyphManager.getGlyphs(u.stacks,y)},s.prototype.getResource=function(o,u,y){return a.makeRequest(u,y)},s}(a.Evented);Nn.getSourceType=function(n){return Mr[n]},Nn.setSourceType=function(n,s){Mr[n]=s},Nn.registerForPluginStateChange=a.registerForPluginStateChange;var xi=a.createLayout([{name:"a_pos",type:"Int16",components:2}]),Uo=Br(`#ifdef GL_ES
precision mediump float;
#else
#if !defined(lowp)
#define lowp
#endif
#if !defined(mediump)
#define mediump
#endif
#if !defined(highp)
#define highp
#endif
#endif`,`#ifdef GL_ES
precision highp float;
#else
#if !defined(lowp)
#define lowp
#endif
#if !defined(mediump)
#define mediump
#endif
#if !defined(highp)
#define highp
#endif
#endif
vec2 unpack_float(const float packedValue) {int packedIntValue=int(packedValue);int v0=packedIntValue/256;return vec2(v0,packedIntValue-v0*256);}vec2 unpack_opacity(const float packedOpacity) {int intOpacity=int(packedOpacity)/2;return vec2(float(intOpacity)/127.0,mod(packedOpacity,2.0));}vec4 decode_color(const vec2 encodedColor) {return vec4(unpack_float(encodedColor[0])/255.0,unpack_float(encodedColor[1])/255.0
);}float unpack_mix_vec2(const vec2 packedValue,const float t) {return mix(packedValue[0],packedValue[1],t);}vec4 unpack_mix_color(const vec4 packedColors,const float t) {vec4 minColor=decode_color(vec2(packedColors[0],packedColors[1]));vec4 maxColor=decode_color(vec2(packedColors[2],packedColors[3]));return mix(minColor,maxColor,t);}vec2 get_pattern_pos(const vec2 pixel_coord_upper,const vec2 pixel_coord_lower,const vec2 pattern_size,const float tile_units_to_pixels,const vec2 pos) {vec2 offset=mod(mod(mod(pixel_coord_upper,pattern_size)*256.0,pattern_size)*256.0+pixel_coord_lower,pattern_size);return (tile_units_to_pixels*pos+offset)/pattern_size;}`),ic=Br(`uniform vec4 u_color;uniform float u_opacity;void main() {gl_FragColor=u_color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),Uh=Br(`uniform vec2 u_pattern_tl_a;uniform vec2 u_pattern_br_a;uniform vec2 u_pattern_tl_b;uniform vec2 u_pattern_br_b;uniform vec2 u_texsize;uniform float u_mix;uniform float u_opacity;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;void main() {vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(u_pattern_tl_a/u_texsize,u_pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(u_pattern_tl_b/u_texsize,u_pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);gl_FragColor=mix(color1,color2,u_mix)*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_pattern_size_a;uniform vec2 u_pattern_size_b;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_scale_a;uniform float u_scale_b;uniform float u_tile_units_to_pixels;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_a*u_pattern_size_a,u_tile_units_to_pixels,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_b*u_pattern_size_b,u_tile_units_to_pixels,a_pos);}"),Vh=Br(`varying vec3 v_data;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=v_data.xy;float extrude_length=length(extrude);lowp float antialiasblur=v_data.z;float antialiased_blur=-max(blur,antialiasblur);float opacity_t=smoothstep(0.0,antialiased_blur,extrude_length-1.0);float color_t=stroke_width < 0.01 ? 0.0 : smoothstep(antialiased_blur,0.0,extrude_length-radius/(radius+stroke_width));gl_FragColor=opacity_t*mix(color*opacity,stroke_color*stroke_opacity,color_t);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform bool u_scale_with_map;uniform bool u_pitch_with_map;uniform vec2 u_extrude_scale;uniform lowp float u_device_pixel_ratio;uniform highp float u_camera_to_center_distance;attribute vec2 a_pos;varying vec3 v_data;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
void main(void) {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=vec2(mod(a_pos,2.0)*2.0-1.0);vec2 circle_center=floor(a_pos*0.5);if (u_pitch_with_map) {vec2 corner_position=circle_center;if (u_scale_with_map) {corner_position+=extrude*(radius+stroke_width)*u_extrude_scale;} else {vec4 projected_center=u_matrix*vec4(circle_center,0,1);corner_position+=extrude*(radius+stroke_width)*u_extrude_scale*(projected_center.w/u_camera_to_center_distance);}gl_Position=u_matrix*vec4(corner_position,0,1);} else {gl_Position=u_matrix*vec4(circle_center,0,1);if (u_scale_with_map) {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*u_camera_to_center_distance;} else {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*gl_Position.w;}}lowp float antialiasblur=1.0/u_device_pixel_ratio/(radius+stroke_width);v_data=vec3(extrude.x,extrude.y,antialiasblur);}`),Ul=Br("void main() {gl_FragColor=vec4(1.0);}","attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),Vl=Br(`uniform highp float u_intensity;varying vec2 v_extrude;
#pragma mapbox: define highp float weight
#define GAUSS_COEF 0.3989422804014327
void main() {
#pragma mapbox: initialize highp float weight
float d=-0.5*3.0*3.0*dot(v_extrude,v_extrude);float val=weight*u_intensity*GAUSS_COEF*exp(d);gl_FragColor=vec4(val,1.0,1.0,1.0);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform float u_extrude_scale;uniform float u_opacity;uniform float u_intensity;attribute vec2 a_pos;varying vec2 v_extrude;
#pragma mapbox: define highp float weight
#pragma mapbox: define mediump float radius
const highp float ZERO=1.0/255.0/16.0;
#define GAUSS_COEF 0.3989422804014327
void main(void) {
#pragma mapbox: initialize highp float weight
#pragma mapbox: initialize mediump float radius
vec2 unscaled_extrude=vec2(mod(a_pos,2.0)*2.0-1.0);float S=sqrt(-2.0*log(ZERO/weight/u_intensity/GAUSS_COEF))/3.0;v_extrude=S*unscaled_extrude;vec2 extrude=v_extrude*radius*u_extrude_scale;vec4 pos=vec4(floor(a_pos*0.5)+extrude,0,1);gl_Position=u_matrix*pos;}`),jl=Br(`uniform sampler2D u_image;uniform sampler2D u_color_ramp;uniform float u_opacity;varying vec2 v_pos;void main() {float t=texture2D(u_image,v_pos).r;vec4 color=texture2D(u_color_ramp,vec2(t,0.5));gl_FragColor=color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(0.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_world;attribute vec2 a_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos*u_world,0,1);v_pos.x=a_pos.x;v_pos.y=1.0-a_pos.y;}"),ql=Br("varying float v_placed;varying float v_notUsed;void main() {float alpha=0.5;gl_FragColor=vec4(1.0,0.0,0.0,1.0)*alpha;if (v_placed > 0.5) {gl_FragColor=vec4(0.0,0.0,1.0,0.5)*alpha;}if (v_notUsed > 0.5) {gl_FragColor*=.1;}}","attribute vec2 a_pos;attribute vec2 a_anchor_pos;attribute vec2 a_extrude;attribute vec2 a_placed;attribute vec2 a_shift;uniform mat4 u_matrix;uniform vec2 u_extrude_scale;uniform float u_camera_to_center_distance;varying float v_placed;varying float v_notUsed;void main() {vec4 projectedPoint=u_matrix*vec4(a_anchor_pos,0,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float collision_perspective_ratio=clamp(0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,4.0);gl_Position=u_matrix*vec4(a_pos,0.0,1.0);gl_Position.xy+=(a_extrude+a_shift)*u_extrude_scale*gl_Position.w*collision_perspective_ratio;v_placed=a_placed.x;v_notUsed=a_placed.y;}"),nc=Br("varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;void main() {float alpha=0.5*min(v_perspective_ratio,1.0);float stroke_radius=0.9*max(v_perspective_ratio,1.0);float distance_to_center=length(v_extrude);float distance_to_edge=abs(distance_to_center-v_radius);float opacity_t=smoothstep(-stroke_radius,0.0,-distance_to_edge);vec4 color=mix(vec4(0.0,0.0,1.0,0.5),vec4(1.0,0.0,0.0,1.0),v_collision);gl_FragColor=color*alpha*opacity_t;}","attribute vec2 a_pos;attribute float a_radius;attribute vec2 a_flags;uniform mat4 u_matrix;uniform mat4 u_inv_matrix;uniform vec2 u_viewport_size;uniform float u_camera_to_center_distance;varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;vec3 toTilePosition(vec2 screenPos) {vec4 rayStart=u_inv_matrix*vec4(screenPos,-1.0,1.0);vec4 rayEnd  =u_inv_matrix*vec4(screenPos, 1.0,1.0);rayStart.xyz/=rayStart.w;rayEnd.xyz  /=rayEnd.w;highp float t=(0.0-rayStart.z)/(rayEnd.z-rayStart.z);return mix(rayStart.xyz,rayEnd.xyz,t);}void main() {vec2 quadCenterPos=a_pos;float radius=a_radius;float collision=a_flags.x;float vertexIdx=a_flags.y;vec2 quadVertexOffset=vec2(mix(-1.0,1.0,float(vertexIdx >=2.0)),mix(-1.0,1.0,float(vertexIdx >=1.0 && vertexIdx <=2.0)));vec2 quadVertexExtent=quadVertexOffset*radius;vec3 tilePos=toTilePosition(quadCenterPos);vec4 clipPos=u_matrix*vec4(tilePos,1.0);highp float camera_to_anchor_distance=clipPos.w;highp float collision_perspective_ratio=clamp(0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,4.0);float padding_factor=1.2;v_radius=radius;v_extrude=quadVertexExtent*padding_factor;v_perspective_ratio=collision_perspective_ratio;v_collision=collision;gl_Position=vec4(clipPos.xyz/clipPos.w,1.0)+vec4(quadVertexExtent*padding_factor/u_viewport_size*2.0,0.0,0.0);}"),ac=Br("uniform highp vec4 u_color;uniform sampler2D u_overlay;varying vec2 v_uv;void main() {vec4 overlay_color=texture2D(u_overlay,v_uv);gl_FragColor=mix(u_color,overlay_color,overlay_color.a);}","attribute vec2 a_pos;varying vec2 v_uv;uniform mat4 u_matrix;uniform float u_overlay_scale;void main() {v_uv=a_pos/8192.0;gl_Position=u_matrix*vec4(a_pos*u_overlay_scale,0,1);}"),jh=Br(`#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
gl_FragColor=color*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec2 a_pos;uniform mat4 u_matrix;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
gl_Position=u_matrix*vec4(a_pos,0,1);}`),us=Br(`varying vec2 v_pos;
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);gl_FragColor=outline_color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec2 a_pos;uniform mat4 u_matrix;uniform vec2 u_world;varying vec2 v_pos;
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;}`),cs=Br(`uniform vec2 u_texsize;uniform sampler2D u_image;uniform float u_fade;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec2 v_pos;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);gl_FragColor=mix(color1,color2,u_fade)*alpha*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_world;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec2 v_pos;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;gl_Position=u_matrix*vec4(a_pos,0,1);vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,a_pos);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;}`),oc=Br(`uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);gl_FragColor=mix(color1,color2,u_fade)*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;gl_Position=u_matrix*vec4(a_pos,0,1);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileZoomRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileZoomRatio,a_pos);}`),rn=Br(`varying vec4 v_color;void main() {gl_FragColor=v_color;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;uniform float u_vertical_gradient;uniform lowp float u_opacity;attribute vec2 a_pos;attribute vec4 a_normal_ed;varying vec4 v_color;
#pragma mapbox: define highp float base
#pragma mapbox: define highp float height
#pragma mapbox: define highp vec4 color
void main() {
#pragma mapbox: initialize highp float base
#pragma mapbox: initialize highp float height
#pragma mapbox: initialize highp vec4 color
vec3 normal=a_normal_ed.xyz;base=max(0.0,base);height=max(0.0,height);float t=mod(normal.x,2.0);gl_Position=u_matrix*vec4(a_pos,t > 0.0 ? height : base,1);float colorvalue=color.r*0.2126+color.g*0.7152+color.b*0.0722;v_color=vec4(0.0,0.0,0.0,1.0);vec4 ambientlight=vec4(0.03,0.03,0.03,1.0);color+=ambientlight;float directional=clamp(dot(normal/16384.0,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_color.r+=clamp(color.r*directional*u_lightcolor.r,mix(0.0,0.3,1.0-u_lightcolor.r),1.0);v_color.g+=clamp(color.g*directional*u_lightcolor.g,mix(0.0,0.3,1.0-u_lightcolor.g),1.0);v_color.b+=clamp(color.b*directional*u_lightcolor.b,mix(0.0,0.3,1.0-u_lightcolor.b),1.0);v_color*=u_opacity;}`),Zl=Br(`uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec4 v_lighting;
#pragma mapbox: define lowp float base
#pragma mapbox: define lowp float height
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float base
#pragma mapbox: initialize lowp float height
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);vec4 mixedColor=mix(color1,color2,u_fade);gl_FragColor=mixedColor*v_lighting;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_height_factor;uniform vec3 u_scale;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;attribute vec2 a_pos;attribute vec4 a_normal_ed;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec4 v_lighting;
#pragma mapbox: define lowp float base
#pragma mapbox: define lowp float height
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float base
#pragma mapbox: initialize lowp float height
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec3 normal=a_normal_ed.xyz;float edgedistance=a_normal_ed.w;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;base=max(0.0,base);height=max(0.0,height);float t=mod(normal.x,2.0);float z=t > 0.0 ? height : base;gl_Position=u_matrix*vec4(a_pos,z,1);vec2 pos=normal.x==1.0 && normal.y==0.0 && normal.z==16384.0
? a_pos
: vec2(edgedistance,z*u_height_factor);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,pos);v_lighting=vec4(0.0,0.0,0.0,1.0);float directional=clamp(dot(normal/16383.0,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((0.5+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_lighting.rgb+=clamp(directional*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_lighting*=u_opacity;}`),Ga=Br(`#ifdef GL_ES
precision highp float;
#endif
uniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_dimension;uniform float u_zoom;uniform vec4 u_unpack;float getElevation(vec2 coord,float bias) {vec4 data=texture2D(u_image,coord)*255.0;data.a=-1.0;return dot(data,u_unpack)/4.0;}void main() {vec2 epsilon=1.0/u_dimension;float a=getElevation(v_pos+vec2(-epsilon.x,-epsilon.y),0.0);float b=getElevation(v_pos+vec2(0,-epsilon.y),0.0);float c=getElevation(v_pos+vec2(epsilon.x,-epsilon.y),0.0);float d=getElevation(v_pos+vec2(-epsilon.x,0),0.0);float e=getElevation(v_pos,0.0);float f=getElevation(v_pos+vec2(epsilon.x,0),0.0);float g=getElevation(v_pos+vec2(-epsilon.x,epsilon.y),0.0);float h=getElevation(v_pos+vec2(0,epsilon.y),0.0);float i=getElevation(v_pos+vec2(epsilon.x,epsilon.y),0.0);float exaggerationFactor=u_zoom < 2.0 ? 0.4 : u_zoom < 4.5 ? 0.35 : 0.3;float exaggeration=u_zoom < 15.0 ? (u_zoom-15.0)*exaggerationFactor : 0.0;vec2 deriv=vec2((c+f+f+i)-(a+d+d+g),(g+h+h+i)-(a+b+b+c))/pow(2.0,exaggeration+(19.2562-u_zoom));gl_FragColor=clamp(vec4(deriv.x/2.0+0.5,deriv.y/2.0+0.5,1.0,1.0),0.0,1.0);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_dimension;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);highp vec2 epsilon=1.0/u_dimension;float scale=(u_dimension.x-2.0)/u_dimension.x;v_pos=(a_texture_pos/8192.0)*scale+epsilon;}"),Ka=Br(`uniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_latrange;uniform vec2 u_light;uniform vec4 u_shadow;uniform vec4 u_highlight;uniform vec4 u_accent;
#define PI 3.141592653589793
void main() {vec4 pixel=texture2D(u_image,v_pos);vec2 deriv=((pixel.rg*2.0)-1.0);float scaleFactor=cos(radians((u_latrange[0]-u_latrange[1])*(1.0-v_pos.y)+u_latrange[1]));float slope=atan(1.25*length(deriv)/scaleFactor);float aspect=deriv.x !=0.0 ? atan(deriv.y,-deriv.x) : PI/2.0*(deriv.y > 0.0 ? 1.0 :-1.0);float intensity=u_light.x;float azimuth=u_light.y+PI;float base=1.875-intensity*1.75;float maxValue=0.5*PI;float scaledSlope=intensity !=0.5 ? ((pow(base,slope)-1.0)/(pow(base,maxValue)-1.0))*maxValue : slope;float accent=cos(scaledSlope);vec4 accent_color=(1.0-accent)*u_accent*clamp(intensity*2.0,0.0,1.0);float shade=abs(mod((aspect+azimuth)/PI+0.5,2.0)-1.0);vec4 shade_color=mix(u_shadow,u_highlight,shade)*sin(scaledSlope)*clamp(intensity*2.0,0.0,1.0);gl_FragColor=accent_color*(1.0-shade_color.a)+shade_color;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=a_texture_pos/8192.0;}"),mo=Br(`uniform lowp float u_device_pixel_ratio;varying vec2 v_width2;varying vec2 v_normal;varying float v_gamma_scale;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);gl_FragColor=color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
attribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform vec2 u_units_to_pixels;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_gamma_scale;varying highp float v_linesofar;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;v_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*2.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;v_width2=vec2(outset,inset);}`),yo=Br(`uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;varying vec2 v_width2;varying vec2 v_normal;varying float v_gamma_scale;varying highp vec2 v_uv;
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);vec4 color=texture2D(u_image,v_uv);gl_FragColor=color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
attribute vec2 a_pos_normal;attribute vec4 a_data;attribute float a_uv_x;attribute float a_split_index;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_units_to_pixels;uniform float u_image_height;varying vec2 v_normal;varying vec2 v_width2;varying float v_gamma_scale;varying highp vec2 v_uv;
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;highp float texel_height=1.0/u_image_height;highp float half_texel_height=0.5*texel_height;v_uv=vec2(a_uv_x,a_split_index*texel_height-half_texel_height);vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;v_width2=vec2(outset,inset);}`),Xa=Br(`uniform lowp float u_device_pixel_ratio;uniform vec2 u_texsize;uniform float u_fade;uniform mediump vec3 u_scale;uniform sampler2D u_image;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;vec2 pattern_size_a=vec2(display_size_a.x*fromScale/tileZoomRatio,display_size_a.y);vec2 pattern_size_b=vec2(display_size_b.x*toScale/tileZoomRatio,display_size_b.y);float aspect_a=display_size_a.y/v_width;float aspect_b=display_size_b.y/v_width;float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float x_a=mod(v_linesofar/pattern_size_a.x*aspect_a,1.0);float x_b=mod(v_linesofar/pattern_size_b.x*aspect_b,1.0);float y=0.5*v_normal.y+0.5;vec2 texel_size=1.0/u_texsize;vec2 pos_a=mix(pattern_tl_a*texel_size-texel_size,pattern_br_a*texel_size+texel_size,vec2(x_a,y));vec2 pos_b=mix(pattern_tl_b*texel_size-texel_size,pattern_br_b*texel_size+texel_size,vec2(x_b,y));vec4 color=mix(texture2D(u_image,pos_a),texture2D(u_image,pos_b),u_fade);gl_FragColor=color*alpha*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
#define LINE_DISTANCE_SCALE 2.0
attribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform vec2 u_units_to_pixels;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;v_linesofar=a_linesofar;v_width2=vec2(outset,inset);v_width=floorwidth;}`),_o=Br(`uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;uniform float u_sdfgamma;uniform float u_mix;varying vec2 v_normal;varying vec2 v_width2;varying vec2 v_tex_a;varying vec2 v_tex_b;varying float v_gamma_scale;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float sdfdist_a=texture2D(u_image,v_tex_a).a;float sdfdist_b=texture2D(u_image,v_tex_b).a;float sdfdist=mix(sdfdist_a,sdfdist_b,u_mix);alpha*=smoothstep(0.5-u_sdfgamma/floorwidth,0.5+u_sdfgamma/floorwidth,sdfdist);gl_FragColor=color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
#define LINE_DISTANCE_SCALE 2.0
attribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_patternscale_a;uniform float u_tex_y_a;uniform vec2 u_patternscale_b;uniform float u_tex_y_b;uniform vec2 u_units_to_pixels;varying vec2 v_normal;varying vec2 v_width2;varying vec2 v_tex_a;varying vec2 v_tex_b;varying float v_gamma_scale;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;v_tex_a=vec2(a_linesofar*u_patternscale_a.x/floorwidth,normal.y*u_patternscale_a.y+u_tex_y_a);v_tex_b=vec2(a_linesofar*u_patternscale_b.x/floorwidth,normal.y*u_patternscale_b.y+u_tex_y_b);v_width2=vec2(outset,inset);}`),go=Br(`uniform float u_fade_t;uniform float u_opacity;uniform sampler2D u_image0;uniform sampler2D u_image1;varying vec2 v_pos0;varying vec2 v_pos1;uniform float u_brightness_low;uniform float u_brightness_high;uniform float u_saturation_factor;uniform float u_contrast_factor;uniform vec3 u_spin_weights;void main() {vec4 color0=texture2D(u_image0,v_pos0);vec4 color1=texture2D(u_image1,v_pos1);if (color0.a > 0.0) {color0.rgb=color0.rgb/color0.a;}if (color1.a > 0.0) {color1.rgb=color1.rgb/color1.a;}vec4 color=mix(color0,color1,u_fade_t);color.a*=u_opacity;vec3 rgb=color.rgb;rgb=vec3(dot(rgb,u_spin_weights.xyz),dot(rgb,u_spin_weights.zxy),dot(rgb,u_spin_weights.yzx));float average=(color.r+color.g+color.b)/3.0;rgb+=(average-rgb)*u_saturation_factor;rgb=(rgb-0.5)*u_contrast_factor+0.5;vec3 u_high_vec=vec3(u_brightness_low,u_brightness_low,u_brightness_low);vec3 u_low_vec=vec3(u_brightness_high,u_brightness_high,u_brightness_high);gl_FragColor=vec4(mix(u_high_vec,u_low_vec,rgb)*color.a,color.a);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_tl_parent;uniform float u_scale_parent;uniform float u_buffer_scale;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos0;varying vec2 v_pos1;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos0=(((a_texture_pos/8192.0)-0.5)/u_buffer_scale )+0.5;v_pos1=(v_pos0*u_scale_parent)+u_tl_parent;}"),Wa=Br(`uniform sampler2D u_texture;varying vec2 v_tex;varying float v_fade_opacity;
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float opacity
lowp float alpha=opacity*v_fade_opacity;gl_FragColor=texture2D(u_texture,v_tex)*alpha;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`const float PI=3.141592653589793;attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec4 a_pixeloffset;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform highp float u_camera_to_center_distance;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform float u_fade_change;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform vec2 u_texsize;varying vec2 v_tex;varying float v_fade_opacity;
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float opacity
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;vec2 a_minFontScale=a_pixeloffset.zw/256.0;highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec4 projectedPoint=u_matrix*vec4(a_pos,0,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),0,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,0.0,1.0);gl_Position=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*max(a_minFontScale,fontScale)+a_pxoffset/16.0),0.0,1.0);v_tex=a_tex/u_texsize;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;v_fade_opacity=max(0.0,min(1.0,fade_opacity[0]+fade_change));}`),sc=Br(`#define SDF_PX 8.0
uniform bool u_is_halo;uniform sampler2D u_texture;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;uniform bool u_is_text;varying vec2 v_data0;varying vec3 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
float EDGE_GAMMA=0.105/u_device_pixel_ratio;vec2 tex=v_data0.xy;float gamma_scale=v_data1.x;float size=v_data1.y;float fade_opacity=v_data1[2];float fontScale=u_is_text ? size/24.0 : size;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);gl_FragColor=color*(alpha*opacity*fade_opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`const float PI=3.141592653589793;attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec4 a_pixeloffset;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;varying vec2 v_data0;varying vec3 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec4 projectedPoint=u_matrix*vec4(a_pos,0,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),0,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,0.0,1.0);gl_Position=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale+a_pxoffset),0.0,1.0);float gamma_scale=gl_Position.w;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(1.0,fade_opacity[0]+fade_change));v_data0=a_tex/u_texsize;v_data1=vec3(gamma_scale,size,interpolated_fade_opacity);}`),lc=Br(`#define SDF_PX 8.0
#define SDF 1.0
#define ICON 0.0
uniform bool u_is_halo;uniform sampler2D u_texture;uniform sampler2D u_texture_icon;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;varying vec4 v_data0;varying vec4 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
float fade_opacity=v_data1[2];if (v_data1.w==ICON) {vec2 tex_icon=v_data0.zw;lowp float alpha=opacity*fade_opacity;gl_FragColor=texture2D(u_texture_icon,tex_icon)*alpha;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
return;}vec2 tex=v_data0.xy;float EDGE_GAMMA=0.105/u_device_pixel_ratio;float gamma_scale=v_data1.x;float size=v_data1.y;float fontScale=size/24.0;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);gl_FragColor=color*(alpha*opacity*fade_opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`const float PI=3.141592653589793;attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec2 u_texsize_icon;varying vec4 v_data0;varying vec4 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);float is_sdf=a_size[0]-2.0*a_size_min;highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec4 projectedPoint=u_matrix*vec4(a_pos,0,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=size/24.0;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),0,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,0.0,1.0);gl_Position=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale),0.0,1.0);float gamma_scale=gl_Position.w;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(1.0,fade_opacity[0]+fade_change));v_data0.xy=a_tex/u_texsize;v_data0.zw=a_tex/u_texsize_icon;v_data1=vec4(gamma_scale,size,interpolated_fade_opacity,is_sdf);}`);function Br(n,s){var o=/#pragma mapbox: ([\w]+) ([\w]+) ([\w]+) ([\w]+)/g,u=s.match(/attribute ([\w]+) ([\w]+)/g),y=n.match(/uniform ([\w]+) ([\w]+)([\s]*)([\w]*)/g),w=s.match(/uniform ([\w]+) ([\w]+)([\s]*)([\w]*)/g),k=w?w.concat(y):y,E={};return{fragmentSource:n=n.replace(o,function(P,O,Z,G,X){return E[X]=!0,O==="define"?`
#ifndef HAS_UNIFORM_u_`+X+`
varying `+Z+" "+G+" "+X+`;
#else
uniform `+Z+" "+G+" u_"+X+`;
#endif
`:`
#ifdef HAS_UNIFORM_u_`+X+`
    `+Z+" "+G+" "+X+" = u_"+X+`;
#endif
`}),vertexSource:s=s.replace(o,function(P,O,Z,G,X){var re=G==="float"?"vec2":"vec4",te=X.match(/color/)?"color":re;return E[X]?O==="define"?`
#ifndef HAS_UNIFORM_u_`+X+`
uniform lowp float u_`+X+`_t;
attribute `+Z+" "+re+" a_"+X+`;
varying `+Z+" "+G+" "+X+`;
#else
uniform `+Z+" "+G+" u_"+X+`;
#endif
`:te==="vec4"?`
#ifndef HAS_UNIFORM_u_`+X+`
    `+X+" = a_"+X+`;
#else
    `+Z+" "+G+" "+X+" = u_"+X+`;
#endif
`:`
#ifndef HAS_UNIFORM_u_`+X+`
    `+X+" = unpack_mix_"+te+"(a_"+X+", u_"+X+`_t);
#else
    `+Z+" "+G+" "+X+" = u_"+X+`;
#endif
`:O==="define"?`
#ifndef HAS_UNIFORM_u_`+X+`
uniform lowp float u_`+X+`_t;
attribute `+Z+" "+re+" a_"+X+`;
#else
uniform `+Z+" "+G+" u_"+X+`;
#endif
`:te==="vec4"?`
#ifndef HAS_UNIFORM_u_`+X+`
    `+Z+" "+G+" "+X+" = a_"+X+`;
#else
    `+Z+" "+G+" "+X+" = u_"+X+`;
#endif
`:`
#ifndef HAS_UNIFORM_u_`+X+`
    `+Z+" "+G+" "+X+" = unpack_mix_"+te+"(a_"+X+", u_"+X+`_t);
#else
    `+Z+" "+G+" "+X+" = u_"+X+`;
#endif
`}),staticAttributes:u,staticUniforms:k}}var qh=Object.freeze({__proto__:null,prelude:Uo,background:ic,backgroundPattern:Uh,circle:Vh,clippingMask:Ul,heatmap:Vl,heatmapTexture:jl,collisionBox:ql,collisionCircle:nc,debug:ac,fill:jh,fillOutline:us,fillOutlinePattern:cs,fillPattern:oc,fillExtrusion:rn,fillExtrusionPattern:Zl,hillshadePrepare:Ga,hillshade:Ka,line:mo,lineGradient:yo,linePattern:Xa,lineSDF:_o,raster:go,symbolIcon:Wa,symbolSDF:sc,symbolTextAndIcon:lc}),Vs=function(){this.boundProgram=null,this.boundLayoutVertexBuffer=null,this.boundPaintVertexBuffers=[],this.boundIndexBuffer=null,this.boundVertexOffset=null,this.boundDynamicVertexBuffer=null,this.vao=null};function uc(n){for(var s=[],o=0;o<n.length;o++)if(n[o]!==null){var u=n[o].split(" ");s.push(u.pop())}return s}Vs.prototype.bind=function(n,s,o,u,y,w,k,E){this.context=n;for(var P=this.boundPaintVertexBuffers.length!==u.length,O=0;!P&&O<u.length;O++)this.boundPaintVertexBuffers[O]!==u[O]&&(P=!0);n.extVertexArrayObject&&this.vao&&this.boundProgram===s&&this.boundLayoutVertexBuffer===o&&!P&&this.boundIndexBuffer===y&&this.boundVertexOffset===w&&this.boundDynamicVertexBuffer===k&&this.boundDynamicVertexBuffer2===E?(n.bindVertexArrayOES.set(this.vao),k&&k.bind(),y&&y.dynamicDraw&&y.bind(),E&&E.bind()):this.freshBind(s,o,u,y,w,k,E)},Vs.prototype.freshBind=function(n,s,o,u,y,w,k){var E,P=n.numAttributes,O=this.context,Z=O.gl;if(O.extVertexArrayObject)this.vao&&this.destroy(),this.vao=O.extVertexArrayObject.createVertexArrayOES(),O.bindVertexArrayOES.set(this.vao),E=0,this.boundProgram=n,this.boundLayoutVertexBuffer=s,this.boundPaintVertexBuffers=o,this.boundIndexBuffer=u,this.boundVertexOffset=y,this.boundDynamicVertexBuffer=w,this.boundDynamicVertexBuffer2=k;else{E=O.currentNumAttributes||0;for(var G=P;G<E;G++)Z.disableVertexAttribArray(G)}s.enableAttributes(Z,n);for(var X=0,re=o;X<re.length;X+=1)re[X].enableAttributes(Z,n);w&&w.enableAttributes(Z,n),k&&k.enableAttributes(Z,n),s.bind(),s.setVertexAttribPointers(Z,n,y);for(var te=0,ue=o;te<ue.length;te+=1){var Y=ue[te];Y.bind(),Y.setVertexAttribPointers(Z,n,y)}w&&(w.bind(),w.setVertexAttribPointers(Z,n,y)),u&&u.bind(),k&&(k.bind(),k.setVertexAttribPointers(Z,n,y)),O.currentNumAttributes=P},Vs.prototype.destroy=function(){this.vao&&(this.context.extVertexArrayObject.deleteVertexArrayOES(this.vao),this.vao=null)};var cc=function(n,s,o,u,y,w){var k=n.gl;this.program=k.createProgram();for(var E=uc(o.staticAttributes),P=u?u.getBinderAttributes():[],O=E.concat(P),Z=o.staticUniforms?uc(o.staticUniforms):[],G=u?u.getBinderUniforms():[],X=[],re=0,te=Z.concat(G);re<te.length;re+=1){var ue=te[re];X.indexOf(ue)<0&&X.push(ue)}var Y=u?u.defines():[];w&&Y.push("#define OVERDRAW_INSPECTOR;");var le=Y.concat(Uo.fragmentSource,o.fragmentSource).join(`
`),pe=Y.concat(Uo.vertexSource,o.vertexSource).join(`
`),ge=k.createShader(k.FRAGMENT_SHADER);if(k.isContextLost())this.failedToCreate=!0;else{k.shaderSource(ge,le),k.compileShader(ge),k.attachShader(this.program,ge);var ze=k.createShader(k.VERTEX_SHADER);if(k.isContextLost())this.failedToCreate=!0;else{k.shaderSource(ze,pe),k.compileShader(ze),k.attachShader(this.program,ze),this.attributes={};var Te={};this.numAttributes=O.length;for(var Ae=0;Ae<this.numAttributes;Ae++)O[Ae]&&(k.bindAttribLocation(this.program,Ae,O[Ae]),this.attributes[O[Ae]]=Ae);k.linkProgram(this.program),k.deleteShader(ze),k.deleteShader(ge);for(var Re=0;Re<X.length;Re++){var Xe=X[Re];if(Xe&&!Te[Xe]){var Ge=k.getUniformLocation(this.program,Xe);Ge&&(Te[Xe]=Ge)}}this.fixedUniforms=y(n,Te),this.binderUniforms=u?u.getUniforms(n,Te):[]}}};function hc(n,s,o){var u=1/Lr(o,1,s.transform.tileZoom),y=Math.pow(2,o.tileID.overscaledZ),w=o.tileSize*Math.pow(2,s.transform.tileZoom)/y,k=w*(o.tileID.canonical.x+o.tileID.wrap*y),E=w*o.tileID.canonical.y;return{u_image:0,u_texsize:o.imageAtlasTexture.size,u_scale:[u,n.fromScale,n.toScale],u_fade:n.t,u_pixel_coord_upper:[k>>16,E>>16],u_pixel_coord_lower:[65535&k,65535&E]}}cc.prototype.draw=function(n,s,o,u,y,w,k,E,P,O,Z,G,X,re,te,ue){var Y,le=n.gl;if(!this.failedToCreate){for(var pe in n.program.set(this.program),n.setDepthMode(o),n.setStencilMode(u),n.setColorMode(y),n.setCullFace(w),this.fixedUniforms)this.fixedUniforms[pe].set(k[pe]);re&&re.setUniforms(n,this.binderUniforms,G,{zoom:X});for(var ge=(Y={},Y[le.LINES]=2,Y[le.TRIANGLES]=3,Y[le.LINE_STRIP]=1,Y)[s],ze=0,Te=Z.get();ze<Te.length;ze+=1){var Ae=Te[ze],Re=Ae.vaos||(Ae.vaos={});(Re[E]||(Re[E]=new Vs)).bind(n,this,P,re?re.getPaintVertexBuffers():[],O,Ae.vertexOffset,te,ue),le.drawElements(s,Ae.primitiveLength*ge,le.UNSIGNED_SHORT,Ae.primitiveOffset*ge*2)}}};var pc=function(n,s,o,u){var y=s.style.light,w=y.properties.get("position"),k=[w.x,w.y,w.z],E=a.create$1();y.properties.get("anchor")==="viewport"&&a.fromRotation(E,-s.transform.angle),a.transformMat3(k,k,E);var P=y.properties.get("color");return{u_matrix:n,u_lightpos:k,u_lightintensity:y.properties.get("intensity"),u_lightcolor:[P.r,P.g,P.b],u_vertical_gradient:+o,u_opacity:u}},vo=function(n,s,o,u,y,w,k){return a.extend(pc(n,s,o,u),hc(w,s,k),{u_height_factor:-Math.pow(2,y.overscaledZ)/k.tileSize/8})},Ha=function(n){return{u_matrix:n}},bo=function(n,s,o,u){return a.extend(Ha(n),hc(o,s,u))},fc=function(n,s){return{u_matrix:n,u_world:s}},dc=function(n,s,o,u,y){return a.extend(bo(n,s,o,u),{u_world:y})},Gl=function(n,s,o,u){var y,w,k=n.transform;if(u.paint.get("circle-pitch-alignment")==="map"){var E=Lr(o,1,k.zoom);y=!0,w=[E,E]}else y=!1,w=k.pixelsToGLUnits;return{u_camera_to_center_distance:k.cameraToCenterDistance,u_scale_with_map:+(u.paint.get("circle-pitch-scale")==="map"),u_matrix:n.translatePosMatrix(s.posMatrix,o,u.paint.get("circle-translate"),u.paint.get("circle-translate-anchor")),u_pitch_with_map:+y,u_device_pixel_ratio:a.browser.devicePixelRatio,u_extrude_scale:w}},xo=function(n,s,o){var u=Lr(o,1,s.zoom),y=Math.pow(2,s.zoom-o.tileID.overscaledZ),w=o.tileID.overscaleFactor();return{u_matrix:n,u_camera_to_center_distance:s.cameraToCenterDistance,u_pixels_to_tile_units:u,u_extrude_scale:[s.pixelsToGLUnits[0]/(u*y),s.pixelsToGLUnits[1]/(u*y)],u_overscale_factor:w}},mc=function(n,s,o){return{u_matrix:n,u_inv_matrix:s,u_camera_to_center_distance:o.cameraToCenterDistance,u_viewport_size:[o.width,o.height]}},wo=function(n,s,o){return o===void 0&&(o=1),{u_matrix:n,u_color:s,u_overlay:0,u_overlay_scale:o}},ko=function(n){return{u_matrix:n}},yc=function(n,s,o,u){return{u_matrix:n,u_extrude_scale:Lr(s,1,o),u_intensity:u}},hs=function(n,s,o){var u=n.transform;return{u_matrix:_c(n,s,o),u_ratio:1/Lr(s,1,u.zoom),u_device_pixel_ratio:a.browser.devicePixelRatio,u_units_to_pixels:[1/u.pixelsToGLUnits[0],1/u.pixelsToGLUnits[1]]}},Vr=function(n,s,o,u){return a.extend(hs(n,s,o),{u_image:0,u_image_height:u})},js=function(n,s,o,u){var y=n.transform,w=Vo(s,y);return{u_matrix:_c(n,s,o),u_texsize:s.imageAtlasTexture.size,u_ratio:1/Lr(s,1,y.zoom),u_device_pixel_ratio:a.browser.devicePixelRatio,u_image:0,u_scale:[w,u.fromScale,u.toScale],u_fade:u.t,u_units_to_pixels:[1/y.pixelsToGLUnits[0],1/y.pixelsToGLUnits[1]]}},Zh=function(n,s,o,u,y){var w=n.lineAtlas,k=Vo(s,n.transform),E=o.layout.get("line-cap")==="round",P=w.getDash(u.from,E),O=w.getDash(u.to,E),Z=P.width*y.fromScale,G=O.width*y.toScale;return a.extend(hs(n,s,o),{u_patternscale_a:[k/Z,-P.height/2],u_patternscale_b:[k/G,-O.height/2],u_sdfgamma:w.width/(256*Math.min(Z,G)*a.browser.devicePixelRatio)/2,u_image:0,u_tex_y_a:P.y,u_tex_y_b:O.y,u_mix:y.t})};function Vo(n,s){return 1/Lr(n,1,s.tileZoom)}function _c(n,s,o){return n.translatePosMatrix(s.tileID.posMatrix,s,o.paint.get("line-translate"),o.paint.get("line-translate-anchor"))}var Gh=function(n,s,o,u,y){return{u_matrix:n,u_tl_parent:s,u_scale_parent:o,u_buffer_scale:1,u_fade_t:u.mix,u_opacity:u.opacity*y.paint.get("raster-opacity"),u_image0:0,u_image1:1,u_brightness_low:y.paint.get("raster-brightness-min"),u_brightness_high:y.paint.get("raster-brightness-max"),u_saturation_factor:(k=y.paint.get("raster-saturation"),k>0?1-1/(1.001-k):-k),u_contrast_factor:(w=y.paint.get("raster-contrast"),w>0?1/(1-w):1+w),u_spin_weights:gc(y.paint.get("raster-hue-rotate"))};var w,k};function gc(n){n*=Math.PI/180;var s=Math.sin(n),o=Math.cos(n);return[(2*o+1)/3,(-Math.sqrt(3)*s-o+1)/3,(Math.sqrt(3)*s-o+1)/3]}var qs,jo=function(n,s,o,u,y,w,k,E,P,O){var Z=y.transform;return{u_is_size_zoom_constant:+(n==="constant"||n==="source"),u_is_size_feature_constant:+(n==="constant"||n==="camera"),u_size_t:s?s.uSizeT:0,u_size:s?s.uSize:0,u_camera_to_center_distance:Z.cameraToCenterDistance,u_pitch:Z.pitch/360*2*Math.PI,u_rotate_symbol:+o,u_aspect_ratio:Z.width/Z.height,u_fade_change:y.options.fadeDuration?y.symbolFadeChange:1,u_matrix:w,u_label_plane_matrix:k,u_coord_matrix:E,u_is_text:+P,u_pitch_with_map:+u,u_texsize:O,u_texture:0}},ps=function(n,s,o,u,y,w,k,E,P,O,Z){var G=y.transform;return a.extend(jo(n,s,o,u,y,w,k,E,P,O),{u_gamma_scale:u?Math.cos(G._pitch)*G.cameraToCenterDistance:1,u_device_pixel_ratio:a.browser.devicePixelRatio,u_is_halo:+Z})},Zs=function(n,s,o,u,y,w,k,E,P,O){return a.extend(ps(n,s,o,u,y,w,k,E,!0,P,!0),{u_texsize_icon:O,u_texture_icon:1})},fs=function(n,s,o){return{u_matrix:n,u_opacity:s,u_color:o}},qo=function(n,s,o,u,y,w){return a.extend(function(k,E,P,O){var Z=P.imageManager.getPattern(k.from.toString()),G=P.imageManager.getPattern(k.to.toString()),X=P.imageManager.getPixelSize(),re=X.width,te=X.height,ue=Math.pow(2,O.tileID.overscaledZ),Y=O.tileSize*Math.pow(2,P.transform.tileZoom)/ue,le=Y*(O.tileID.canonical.x+O.tileID.wrap*ue),pe=Y*O.tileID.canonical.y;return{u_image:0,u_pattern_tl_a:Z.tl,u_pattern_br_a:Z.br,u_pattern_tl_b:G.tl,u_pattern_br_b:G.br,u_texsize:[re,te],u_mix:E.t,u_pattern_size_a:Z.displaySize,u_pattern_size_b:G.displaySize,u_scale_a:E.fromScale,u_scale_b:E.toScale,u_tile_units_to_pixels:1/Lr(O,1,P.transform.tileZoom),u_pixel_coord_upper:[le>>16,pe>>16],u_pixel_coord_lower:[65535&le,65535&pe]}}(u,w,o,y),{u_matrix:n,u_opacity:s})},vc={fillExtrusion:function(n,s){return{u_matrix:new a.UniformMatrix4f(n,s.u_matrix),u_lightpos:new a.Uniform3f(n,s.u_lightpos),u_lightintensity:new a.Uniform1f(n,s.u_lightintensity),u_lightcolor:new a.Uniform3f(n,s.u_lightcolor),u_vertical_gradient:new a.Uniform1f(n,s.u_vertical_gradient),u_opacity:new a.Uniform1f(n,s.u_opacity)}},fillExtrusionPattern:function(n,s){return{u_matrix:new a.UniformMatrix4f(n,s.u_matrix),u_lightpos:new a.Uniform3f(n,s.u_lightpos),u_lightintensity:new a.Uniform1f(n,s.u_lightintensity),u_lightcolor:new a.Uniform3f(n,s.u_lightcolor),u_vertical_gradient:new a.Uniform1f(n,s.u_vertical_gradient),u_height_factor:new a.Uniform1f(n,s.u_height_factor),u_image:new a.Uniform1i(n,s.u_image),u_texsize:new a.Uniform2f(n,s.u_texsize),u_pixel_coord_upper:new a.Uniform2f(n,s.u_pixel_coord_upper),u_pixel_coord_lower:new a.Uniform2f(n,s.u_pixel_coord_lower),u_scale:new a.Uniform3f(n,s.u_scale),u_fade:new a.Uniform1f(n,s.u_fade),u_opacity:new a.Uniform1f(n,s.u_opacity)}},fill:function(n,s){return{u_matrix:new a.UniformMatrix4f(n,s.u_matrix)}},fillPattern:function(n,s){return{u_matrix:new a.UniformMatrix4f(n,s.u_matrix),u_image:new a.Uniform1i(n,s.u_image),u_texsize:new a.Uniform2f(n,s.u_texsize),u_pixel_coord_upper:new a.Uniform2f(n,s.u_pixel_coord_upper),u_pixel_coord_lower:new a.Uniform2f(n,s.u_pixel_coord_lower),u_scale:new a.Uniform3f(n,s.u_scale),u_fade:new a.Uniform1f(n,s.u_fade)}},fillOutline:function(n,s){return{u_matrix:new a.UniformMatrix4f(n,s.u_matrix),u_world:new a.Uniform2f(n,s.u_world)}},fillOutlinePattern:function(n,s){return{u_matrix:new a.UniformMatrix4f(n,s.u_matrix),u_world:new a.Uniform2f(n,s.u_world),u_image:new a.Uniform1i(n,s.u_image),u_texsize:new a.Uniform2f(n,s.u_texsize),u_pixel_coord_upper:new a.Uniform2f(n,s.u_pixel_coord_upper),u_pixel_coord_lower:new a.Uniform2f(n,s.u_pixel_coord_lower),u_scale:new a.Uniform3f(n,s.u_scale),u_fade:new a.Uniform1f(n,s.u_fade)}},circle:function(n,s){return{u_camera_to_center_distance:new a.Uniform1f(n,s.u_camera_to_center_distance),u_scale_with_map:new a.Uniform1i(n,s.u_scale_with_map),u_pitch_with_map:new a.Uniform1i(n,s.u_pitch_with_map),u_extrude_scale:new a.Uniform2f(n,s.u_extrude_scale),u_device_pixel_ratio:new a.Uniform1f(n,s.u_device_pixel_ratio),u_matrix:new a.UniformMatrix4f(n,s.u_matrix)}},collisionBox:function(n,s){return{u_matrix:new a.UniformMatrix4f(n,s.u_matrix),u_camera_to_center_distance:new a.Uniform1f(n,s.u_camera_to_center_distance),u_pixels_to_tile_units:new a.Uniform1f(n,s.u_pixels_to_tile_units),u_extrude_scale:new a.Uniform2f(n,s.u_extrude_scale),u_overscale_factor:new a.Uniform1f(n,s.u_overscale_factor)}},collisionCircle:function(n,s){return{u_matrix:new a.UniformMatrix4f(n,s.u_matrix),u_inv_matrix:new a.UniformMatrix4f(n,s.u_inv_matrix),u_camera_to_center_distance:new a.Uniform1f(n,s.u_camera_to_center_distance),u_viewport_size:new a.Uniform2f(n,s.u_viewport_size)}},debug:function(n,s){return{u_color:new a.UniformColor(n,s.u_color),u_matrix:new a.UniformMatrix4f(n,s.u_matrix),u_overlay:new a.Uniform1i(n,s.u_overlay),u_overlay_scale:new a.Uniform1f(n,s.u_overlay_scale)}},clippingMask:function(n,s){return{u_matrix:new a.UniformMatrix4f(n,s.u_matrix)}},heatmap:function(n,s){return{u_extrude_scale:new a.Uniform1f(n,s.u_extrude_scale),u_intensity:new a.Uniform1f(n,s.u_intensity),u_matrix:new a.UniformMatrix4f(n,s.u_matrix)}},heatmapTexture:function(n,s){return{u_matrix:new a.UniformMatrix4f(n,s.u_matrix),u_world:new a.Uniform2f(n,s.u_world),u_image:new a.Uniform1i(n,s.u_image),u_color_ramp:new a.Uniform1i(n,s.u_color_ramp),u_opacity:new a.Uniform1f(n,s.u_opacity)}},hillshade:function(n,s){return{u_matrix:new a.UniformMatrix4f(n,s.u_matrix),u_image:new a.Uniform1i(n,s.u_image),u_latrange:new a.Uniform2f(n,s.u_latrange),u_light:new a.Uniform2f(n,s.u_light),u_shadow:new a.UniformColor(n,s.u_shadow),u_highlight:new a.UniformColor(n,s.u_highlight),u_accent:new a.UniformColor(n,s.u_accent)}},hillshadePrepare:function(n,s){return{u_matrix:new a.UniformMatrix4f(n,s.u_matrix),u_image:new a.Uniform1i(n,s.u_image),u_dimension:new a.Uniform2f(n,s.u_dimension),u_zoom:new a.Uniform1f(n,s.u_zoom),u_unpack:new a.Uniform4f(n,s.u_unpack)}},line:function(n,s){return{u_matrix:new a.UniformMatrix4f(n,s.u_matrix),u_ratio:new a.Uniform1f(n,s.u_ratio),u_device_pixel_ratio:new a.Uniform1f(n,s.u_device_pixel_ratio),u_units_to_pixels:new a.Uniform2f(n,s.u_units_to_pixels)}},lineGradient:function(n,s){return{u_matrix:new a.UniformMatrix4f(n,s.u_matrix),u_ratio:new a.Uniform1f(n,s.u_ratio),u_device_pixel_ratio:new a.Uniform1f(n,s.u_device_pixel_ratio),u_units_to_pixels:new a.Uniform2f(n,s.u_units_to_pixels),u_image:new a.Uniform1i(n,s.u_image),u_image_height:new a.Uniform1f(n,s.u_image_height)}},linePattern:function(n,s){return{u_matrix:new a.UniformMatrix4f(n,s.u_matrix),u_texsize:new a.Uniform2f(n,s.u_texsize),u_ratio:new a.Uniform1f(n,s.u_ratio),u_device_pixel_ratio:new a.Uniform1f(n,s.u_device_pixel_ratio),u_image:new a.Uniform1i(n,s.u_image),u_units_to_pixels:new a.Uniform2f(n,s.u_units_to_pixels),u_scale:new a.Uniform3f(n,s.u_scale),u_fade:new a.Uniform1f(n,s.u_fade)}},lineSDF:function(n,s){return{u_matrix:new a.UniformMatrix4f(n,s.u_matrix),u_ratio:new a.Uniform1f(n,s.u_ratio),u_device_pixel_ratio:new a.Uniform1f(n,s.u_device_pixel_ratio),u_units_to_pixels:new a.Uniform2f(n,s.u_units_to_pixels),u_patternscale_a:new a.Uniform2f(n,s.u_patternscale_a),u_patternscale_b:new a.Uniform2f(n,s.u_patternscale_b),u_sdfgamma:new a.Uniform1f(n,s.u_sdfgamma),u_image:new a.Uniform1i(n,s.u_image),u_tex_y_a:new a.Uniform1f(n,s.u_tex_y_a),u_tex_y_b:new a.Uniform1f(n,s.u_tex_y_b),u_mix:new a.Uniform1f(n,s.u_mix)}},raster:function(n,s){return{u_matrix:new a.UniformMatrix4f(n,s.u_matrix),u_tl_parent:new a.Uniform2f(n,s.u_tl_parent),u_scale_parent:new a.Uniform1f(n,s.u_scale_parent),u_buffer_scale:new a.Uniform1f(n,s.u_buffer_scale),u_fade_t:new a.Uniform1f(n,s.u_fade_t),u_opacity:new a.Uniform1f(n,s.u_opacity),u_image0:new a.Uniform1i(n,s.u_image0),u_image1:new a.Uniform1i(n,s.u_image1),u_brightness_low:new a.Uniform1f(n,s.u_brightness_low),u_brightness_high:new a.Uniform1f(n,s.u_brightness_high),u_saturation_factor:new a.Uniform1f(n,s.u_saturation_factor),u_contrast_factor:new a.Uniform1f(n,s.u_contrast_factor),u_spin_weights:new a.Uniform3f(n,s.u_spin_weights)}},symbolIcon:function(n,s){return{u_is_size_zoom_constant:new a.Uniform1i(n,s.u_is_size_zoom_constant),u_is_size_feature_constant:new a.Uniform1i(n,s.u_is_size_feature_constant),u_size_t:new a.Uniform1f(n,s.u_size_t),u_size:new a.Uniform1f(n,s.u_size),u_camera_to_center_distance:new a.Uniform1f(n,s.u_camera_to_center_distance),u_pitch:new a.Uniform1f(n,s.u_pitch),u_rotate_symbol:new a.Uniform1i(n,s.u_rotate_symbol),u_aspect_ratio:new a.Uniform1f(n,s.u_aspect_ratio),u_fade_change:new a.Uniform1f(n,s.u_fade_change),u_matrix:new a.UniformMatrix4f(n,s.u_matrix),u_label_plane_matrix:new a.UniformMatrix4f(n,s.u_label_plane_matrix),u_coord_matrix:new a.UniformMatrix4f(n,s.u_coord_matrix),u_is_text:new a.Uniform1i(n,s.u_is_text),u_pitch_with_map:new a.Uniform1i(n,s.u_pitch_with_map),u_texsize:new a.Uniform2f(n,s.u_texsize),u_texture:new a.Uniform1i(n,s.u_texture)}},symbolSDF:function(n,s){return{u_is_size_zoom_constant:new a.Uniform1i(n,s.u_is_size_zoom_constant),u_is_size_feature_constant:new a.Uniform1i(n,s.u_is_size_feature_constant),u_size_t:new a.Uniform1f(n,s.u_size_t),u_size:new a.Uniform1f(n,s.u_size),u_camera_to_center_distance:new a.Uniform1f(n,s.u_camera_to_center_distance),u_pitch:new a.Uniform1f(n,s.u_pitch),u_rotate_symbol:new a.Uniform1i(n,s.u_rotate_symbol),u_aspect_ratio:new a.Uniform1f(n,s.u_aspect_ratio),u_fade_change:new a.Uniform1f(n,s.u_fade_change),u_matrix:new a.UniformMatrix4f(n,s.u_matrix),u_label_plane_matrix:new a.UniformMatrix4f(n,s.u_label_plane_matrix),u_coord_matrix:new a.UniformMatrix4f(n,s.u_coord_matrix),u_is_text:new a.Uniform1i(n,s.u_is_text),u_pitch_with_map:new a.Uniform1i(n,s.u_pitch_with_map),u_texsize:new a.Uniform2f(n,s.u_texsize),u_texture:new a.Uniform1i(n,s.u_texture),u_gamma_scale:new a.Uniform1f(n,s.u_gamma_scale),u_device_pixel_ratio:new a.Uniform1f(n,s.u_device_pixel_ratio),u_is_halo:new a.Uniform1i(n,s.u_is_halo)}},symbolTextAndIcon:function(n,s){return{u_is_size_zoom_constant:new a.Uniform1i(n,s.u_is_size_zoom_constant),u_is_size_feature_constant:new a.Uniform1i(n,s.u_is_size_feature_constant),u_size_t:new a.Uniform1f(n,s.u_size_t),u_size:new a.Uniform1f(n,s.u_size),u_camera_to_center_distance:new a.Uniform1f(n,s.u_camera_to_center_distance),u_pitch:new a.Uniform1f(n,s.u_pitch),u_rotate_symbol:new a.Uniform1i(n,s.u_rotate_symbol),u_aspect_ratio:new a.Uniform1f(n,s.u_aspect_ratio),u_fade_change:new a.Uniform1f(n,s.u_fade_change),u_matrix:new a.UniformMatrix4f(n,s.u_matrix),u_label_plane_matrix:new a.UniformMatrix4f(n,s.u_label_plane_matrix),u_coord_matrix:new a.UniformMatrix4f(n,s.u_coord_matrix),u_is_text:new a.Uniform1i(n,s.u_is_text),u_pitch_with_map:new a.Uniform1i(n,s.u_pitch_with_map),u_texsize:new a.Uniform2f(n,s.u_texsize),u_texsize_icon:new a.Uniform2f(n,s.u_texsize_icon),u_texture:new a.Uniform1i(n,s.u_texture),u_texture_icon:new a.Uniform1i(n,s.u_texture_icon),u_gamma_scale:new a.Uniform1f(n,s.u_gamma_scale),u_device_pixel_ratio:new a.Uniform1f(n,s.u_device_pixel_ratio),u_is_halo:new a.Uniform1i(n,s.u_is_halo)}},background:function(n,s){return{u_matrix:new a.UniformMatrix4f(n,s.u_matrix),u_opacity:new a.Uniform1f(n,s.u_opacity),u_color:new a.UniformColor(n,s.u_color)}},backgroundPattern:function(n,s){return{u_matrix:new a.UniformMatrix4f(n,s.u_matrix),u_opacity:new a.Uniform1f(n,s.u_opacity),u_image:new a.Uniform1i(n,s.u_image),u_pattern_tl_a:new a.Uniform2f(n,s.u_pattern_tl_a),u_pattern_br_a:new a.Uniform2f(n,s.u_pattern_br_a),u_pattern_tl_b:new a.Uniform2f(n,s.u_pattern_tl_b),u_pattern_br_b:new a.Uniform2f(n,s.u_pattern_br_b),u_texsize:new a.Uniform2f(n,s.u_texsize),u_mix:new a.Uniform1f(n,s.u_mix),u_pattern_size_a:new a.Uniform2f(n,s.u_pattern_size_a),u_pattern_size_b:new a.Uniform2f(n,s.u_pattern_size_b),u_scale_a:new a.Uniform1f(n,s.u_scale_a),u_scale_b:new a.Uniform1f(n,s.u_scale_b),u_pixel_coord_upper:new a.Uniform2f(n,s.u_pixel_coord_upper),u_pixel_coord_lower:new a.Uniform2f(n,s.u_pixel_coord_lower),u_tile_units_to_pixels:new a.Uniform1f(n,s.u_tile_units_to_pixels)}}};function Zo(n,s,o,u,y,w,k){for(var E=n.context,P=E.gl,O=n.useProgram("collisionBox"),Z=[],G=0,X=0,re=0;re<u.length;re++){var te=u[re],ue=s.getTile(te),Y=ue.getBucket(o);if(Y){var le=te.posMatrix;y[0]===0&&y[1]===0||(le=n.translatePosMatrix(te.posMatrix,ue,y,w));var pe=k?Y.textCollisionBox:Y.iconCollisionBox,ge=Y.collisionCircleArray;if(ge.length>0){var ze=a.create(),Te=le;a.mul(ze,Y.placementInvProjMatrix,n.transform.glCoordMatrix),a.mul(ze,ze,Y.placementViewportMatrix),Z.push({circleArray:ge,circleOffset:X,transform:Te,invTransform:ze}),X=G+=ge.length/4}pe&&O.draw(E,P.LINES,W.disabled,$.disabled,n.colorModeForRenderPass(),he.disabled,xo(le,n.transform,ue),o.id,pe.layoutVertexBuffer,pe.indexBuffer,pe.segments,null,n.transform.zoom,null,null,pe.collisionVertexBuffer)}}if(k&&Z.length){var Ae=n.useProgram("collisionCircle"),Re=new a.StructArrayLayout2f1f2i16;Re.resize(4*G),Re._trim();for(var Xe=0,Ge=0,at=Z;Ge<at.length;Ge+=1)for(var vt=at[Ge],kt=0;kt<vt.circleArray.length/4;kt++){var wt=4*kt,_r=vt.circleArray[wt+0],ot=vt.circleArray[wt+1],Nt=vt.circleArray[wt+2],Yt=vt.circleArray[wt+3];Re.emplace(Xe++,_r,ot,Nt,Yt,0),Re.emplace(Xe++,_r,ot,Nt,Yt,1),Re.emplace(Xe++,_r,ot,Nt,Yt,2),Re.emplace(Xe++,_r,ot,Nt,Yt,3)}(!qs||qs.length<2*G)&&(qs=function(ui){var pn=2*ui,Xi=new a.StructArrayLayout3ui6;Xi.resize(pn),Xi._trim();for(var ni=0;ni<pn;ni++){var mi=6*ni;Xi.uint16[mi+0]=4*ni+0,Xi.uint16[mi+1]=4*ni+1,Xi.uint16[mi+2]=4*ni+2,Xi.uint16[mi+3]=4*ni+2,Xi.uint16[mi+4]=4*ni+3,Xi.uint16[mi+5]=4*ni+0}return Xi}(G));for(var Ot=E.createIndexBuffer(qs,!0),Bt=E.createVertexBuffer(Re,a.collisionCircleLayout.members,!0),Ht=0,Rt=Z;Ht<Rt.length;Ht+=1){var Ct=Rt[Ht],Li=mc(Ct.transform,Ct.invTransform,n.transform);Ae.draw(E,P.TRIANGLES,W.disabled,$.disabled,n.colorModeForRenderPass(),he.disabled,Li,o.id,Bt,Ot,a.SegmentVector.simpleSegment(0,2*Ct.circleOffset,Ct.circleArray.length,Ct.circleArray.length/2),null,n.transform.zoom,null,null,null)}Bt.destroy(),Ot.destroy()}}var pa=a.identity(new Float32Array(16));function bc(n,s,o,u,y,w){var k=a.getAnchorAlignment(n),E=-(k.horizontalAlign-.5)*s,P=-(k.verticalAlign-.5)*o,O=a.evaluateVariableOffset(n,u);return new a.Point((E/y+O[0])*w,(P/y+O[1])*w)}function xc(n,s,o,u,y,w,k,E,P,O,Z){var G=n.text.placedSymbolArray,X=n.text.dynamicLayoutVertexArray,re=n.icon.dynamicLayoutVertexArray,te={};X.clear();for(var ue=0;ue<G.length;ue++){var Y=G.get(ue),le=Y.hidden||!Y.crossTileID||n.allowVerticalPlacement&&!Y.placedOrientation?null:u[Y.crossTileID];if(le){var pe=new a.Point(Y.anchorX,Y.anchorY),ge=Gt(pe,o?E:k),ze=tr(w.cameraToCenterDistance,ge.signedDistanceFromCamera),Te=y.evaluateSizeForFeature(n.textSizeData,O,Y)*ze/a.ONE_EM;o&&(Te*=n.tilePixelRatio/P);for(var Ae=bc(le.anchor,le.width,le.height,le.textOffset,le.textBoxScale,Te),Re=o?Gt(pe.add(Ae),k).point:ge.point.add(s?Ae.rotate(-w.angle):Ae),Xe=n.allowVerticalPlacement&&Y.placedOrientation===a.WritingMode.vertical?Math.PI/2:0,Ge=0;Ge<Y.numGlyphs;Ge++)a.addDynamicAttributes(X,Re,Xe);Z&&Y.associatedIconIndex>=0&&(te[Y.associatedIconIndex]={shiftedAnchor:Re,angle:Xe})}else Si(Y.numGlyphs,X)}if(Z){re.clear();for(var at=n.icon.placedSymbolArray,vt=0;vt<at.length;vt++){var kt=at.get(vt);if(kt.hidden)Si(kt.numGlyphs,re);else{var wt=te[vt];if(wt)for(var _r=0;_r<kt.numGlyphs;_r++)a.addDynamicAttributes(re,wt.shiftedAnchor,wt.angle);else Si(kt.numGlyphs,re)}}n.icon.dynamicLayoutVertexBuffer.updateData(re)}n.text.dynamicLayoutVertexBuffer.updateData(X)}function wc(n,s,o){return o.iconsInText&&s?"symbolTextAndIcon":n?"symbolSDF":"symbolIcon"}function So(n,s,o,u,y,w,k,E,P,O,Z,G){for(var X=n.context,re=X.gl,te=n.transform,ue=E==="map",Y=P==="map",le=ue&&o.layout.get("symbol-placement")!=="point",pe=ue&&!Y&&!le,ge=o.layout.get("symbol-sort-key").constantOr(1)!==void 0,ze=!1,Te=n.depthModeForSublayer(0,W.ReadOnly),Ae=o.layout.get("text-variable-anchor"),Re=[],Xe=0,Ge=u;Xe<Ge.length;Xe+=1){var at=Ge[Xe],vt=s.getTile(at),kt=vt.getBucket(o);if(kt){var wt=y?kt.text:kt.icon;if(wt&&wt.segments.get().length){var _r=wt.programConfigurations.get(o.id),ot=y||kt.sdfIcons,Nt=y?kt.textSizeData:kt.iconSizeData,Yt=Y||te.pitch!==0,Ot=n.useProgram(wc(ot,y,kt),_r),Bt=a.evaluateSizeForZoom(Nt,te.zoom),Ht=void 0,Rt=[0,0],Ct=void 0,Li=void 0,ui=null,pn=void 0;if(y)Ct=vt.glyphAtlasTexture,Li=re.LINEAR,Ht=vt.glyphAtlasTexture.size,kt.iconsInText&&(Rt=vt.imageAtlasTexture.size,ui=vt.imageAtlasTexture,pn=Yt||n.options.rotating||n.options.zooming||Nt.kind==="composite"||Nt.kind==="camera"?re.LINEAR:re.NEAREST);else{var Xi=o.layout.get("icon-size").constantOr(0)!==1||kt.iconsNeedLinear;Ct=vt.imageAtlasTexture,Li=ot||n.options.rotating||n.options.zooming||Xi||Yt?re.LINEAR:re.NEAREST,Ht=vt.imageAtlasTexture.size}var ni=Lr(vt,1,n.transform.zoom),mi=vr(at.posMatrix,Y,ue,n.transform,ni),Gn=fr(at.posMatrix,Y,ue,n.transform,ni),Sn=Ae&&kt.hasTextData(),to=o.layout.get("icon-text-fit")!=="none"&&Sn&&kt.hasIconData();le&&Bn(kt,at.posMatrix,n,y,mi,Gn,Y,O);var Pn=n.translatePosMatrix(at.posMatrix,vt,w,k),_a=le||y&&Ae||to?pa:mi,oa=n.translatePosMatrix(Gn,vt,w,k,!0),Es=ot&&o.paint.get(y?"text-halo-width":"icon-halo-width").constantOr(1)!==0,Jo={program:Ot,buffers:wt,uniformValues:ot?kt.iconsInText?Zs(Nt.kind,Bt,pe,Y,n,Pn,_a,oa,Ht,Rt):ps(Nt.kind,Bt,pe,Y,n,Pn,_a,oa,y,Ht,!0):jo(Nt.kind,Bt,pe,Y,n,Pn,_a,oa,y,Ht),atlasTexture:Ct,atlasTextureIcon:ui,atlasInterpolation:Li,atlasInterpolationIcon:pn,isSDF:ot,hasHalo:Es};if(ge&&kt.canOverlap){ze=!0;for(var ro=0,Yo=wt.segments.get();ro<Yo.length;ro+=1){var Ts=Yo[ro];Re.push({segments:new a.SegmentVector([Ts]),sortKey:Ts.sortKey,state:Jo})}}else Re.push({segments:wt.segments,sortKey:0,state:Jo})}}}ze&&Re.sort(function(io,Po){return io.sortKey-Po.sortKey});for(var Ia=0,Is=Re;Ia<Is.length;Ia+=1){var za=Is[Ia],Ri=za.state;if(X.activeTexture.set(re.TEXTURE0),Ri.atlasTexture.bind(Ri.atlasInterpolation,re.CLAMP_TO_EDGE),Ri.atlasTextureIcon&&(X.activeTexture.set(re.TEXTURE1),Ri.atlasTextureIcon&&Ri.atlasTextureIcon.bind(Ri.atlasInterpolationIcon,re.CLAMP_TO_EDGE)),Ri.isSDF){var Ba=Ri.uniformValues;Ri.hasHalo&&(Ba.u_is_halo=1,ds(Ri.buffers,za.segments,o,n,Ri.program,Te,Z,G,Ba)),Ba.u_is_halo=0}ds(Ri.buffers,za.segments,o,n,Ri.program,Te,Z,G,Ri.uniformValues)}}function ds(n,s,o,u,y,w,k,E,P){var O=u.context;y.draw(O,O.gl.TRIANGLES,w,k,E,he.disabled,P,o.id,n.layoutVertexBuffer,n.indexBuffer,s,o.paint,u.transform.zoom,n.programConfigurations.get(o.id),n.dynamicLayoutVertexBuffer,n.opacityVertexBuffer)}function Gs(n,s,o,u,y,w,k){var E,P,O,Z,G,X=n.context.gl,re=o.paint.get("fill-pattern"),te=re&&re.constantOr(1),ue=o.getCrossfadeParameters();k?(P=te&&!o.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline",E=X.LINES):(P=te?"fillPattern":"fill",E=X.TRIANGLES);for(var Y=0,le=u;Y<le.length;Y+=1){var pe=le[Y],ge=s.getTile(pe);if(!te||ge.patternsLoaded()){var ze=ge.getBucket(o);if(ze){var Te=ze.programConfigurations.get(o.id),Ae=n.useProgram(P,Te);te&&(n.context.activeTexture.set(X.TEXTURE0),ge.imageAtlasTexture.bind(X.LINEAR,X.CLAMP_TO_EDGE),Te.updatePaintBuffers(ue));var Re=re.constantOr(null);if(Re&&ge.imageAtlas){var Xe=ge.imageAtlas,Ge=Xe.patternPositions[Re.to.toString()],at=Xe.patternPositions[Re.from.toString()];Ge&&at&&Te.setConstantPatternPositions(Ge,at)}var vt=n.translatePosMatrix(pe.posMatrix,ge,o.paint.get("fill-translate"),o.paint.get("fill-translate-anchor"));if(k){Z=ze.indexBuffer2,G=ze.segments2;var kt=[X.drawingBufferWidth,X.drawingBufferHeight];O=P==="fillOutlinePattern"&&te?dc(vt,n,ue,ge,kt):fc(vt,kt)}else Z=ze.indexBuffer,G=ze.segments,O=te?bo(vt,n,ue,ge):Ha(vt);Ae.draw(n.context,E,y,n.stencilModeForClipping(pe),w,he.disabled,O,o.id,ze.layoutVertexBuffer,Z,G,o.paint,n.transform.zoom,Te)}}}}function Kl(n,s,o,u,y,w,k){for(var E=n.context,P=E.gl,O=o.paint.get("fill-extrusion-pattern"),Z=O.constantOr(1),G=o.getCrossfadeParameters(),X=o.paint.get("fill-extrusion-opacity"),re=0,te=u;re<te.length;re+=1){var ue=te[re],Y=s.getTile(ue),le=Y.getBucket(o);if(le){var pe=le.programConfigurations.get(o.id),ge=n.useProgram(Z?"fillExtrusionPattern":"fillExtrusion",pe);Z&&(n.context.activeTexture.set(P.TEXTURE0),Y.imageAtlasTexture.bind(P.LINEAR,P.CLAMP_TO_EDGE),pe.updatePaintBuffers(G));var ze=O.constantOr(null);if(ze&&Y.imageAtlas){var Te=Y.imageAtlas,Ae=Te.patternPositions[ze.to.toString()],Re=Te.patternPositions[ze.from.toString()];Ae&&Re&&pe.setConstantPatternPositions(Ae,Re)}var Xe=n.translatePosMatrix(ue.posMatrix,Y,o.paint.get("fill-extrusion-translate"),o.paint.get("fill-extrusion-translate-anchor")),Ge=o.paint.get("fill-extrusion-vertical-gradient"),at=Z?vo(Xe,n,Ge,X,ue,G,Y):pc(Xe,n,Ge,X);ge.draw(E,E.gl.TRIANGLES,y,w,k,he.backCCW,at,o.id,le.layoutVertexBuffer,le.indexBuffer,le.segments,o.paint,n.transform.zoom,pe)}}}function Ks(n,s,o,u,y,w){var k=n.context,E=k.gl,P=s.fbo;if(P){var O=n.useProgram("hillshade");k.activeTexture.set(E.TEXTURE0),E.bindTexture(E.TEXTURE_2D,P.colorAttachment.get());var Z=function(G,X,re){var te=re.paint.get("hillshade-shadow-color"),ue=re.paint.get("hillshade-highlight-color"),Y=re.paint.get("hillshade-accent-color"),le=re.paint.get("hillshade-illumination-direction")*(Math.PI/180);re.paint.get("hillshade-illumination-anchor")==="viewport"&&(le-=G.transform.angle);var pe,ge,ze,Te=!G.options.moving;return{u_matrix:G.transform.calculatePosMatrix(X.tileID.toUnwrapped(),Te),u_image:0,u_latrange:(pe=X.tileID,ge=Math.pow(2,pe.canonical.z),ze=pe.canonical.y,[new a.MercatorCoordinate(0,ze/ge).toLngLat().lat,new a.MercatorCoordinate(0,(ze+1)/ge).toLngLat().lat]),u_light:[re.paint.get("hillshade-exaggeration"),le],u_shadow:te,u_highlight:ue,u_accent:Y}}(n,s,o);O.draw(k,E.TRIANGLES,u,y,w,he.disabled,Z,o.id,n.rasterBoundsBuffer,n.quadTriangleIndexBuffer,n.rasterBoundsSegments)}}function Kh(n,s,o,u,y,w){var k=n.context,E=k.gl,P=s.dem;if(P&&P.data){var O=P.dim,Z=P.stride,G=P.getPixels();if(k.activeTexture.set(E.TEXTURE1),k.pixelStoreUnpackPremultiplyAlpha.set(!1),s.demTexture=s.demTexture||n.getTileTexture(Z),s.demTexture){var X=s.demTexture;X.update(G,{premultiply:!1}),X.bind(E.NEAREST,E.CLAMP_TO_EDGE)}else s.demTexture=new a.Texture(k,G,E.RGBA,{premultiply:!1}),s.demTexture.bind(E.NEAREST,E.CLAMP_TO_EDGE);k.activeTexture.set(E.TEXTURE0);var re=s.fbo;if(!re){var te=new a.Texture(k,{width:O,height:O,data:null},E.RGBA);te.bind(E.LINEAR,E.CLAMP_TO_EDGE),(re=s.fbo=k.createFramebuffer(O,O,!0)).colorAttachment.set(te.texture)}k.bindFramebuffer.set(re.framebuffer),k.viewport.set([0,0,O,O]),n.useProgram("hillshadePrepare").draw(k,E.TRIANGLES,u,y,w,he.disabled,function(ue,Y){var le=Y.stride,pe=a.create();return a.ortho(pe,0,a.EXTENT,-a.EXTENT,0,0,1),a.translate(pe,pe,[0,-a.EXTENT,0]),{u_matrix:pe,u_image:1,u_dimension:[le,le],u_zoom:ue.overscaledZ,u_unpack:Y.getUnpackVector()}}(s.tileID,P),o.id,n.rasterBoundsBuffer,n.quadTriangleIndexBuffer,n.rasterBoundsSegments),s.needsHillshadePrepare=!1}}function Xs(n,s,o,u,y){var w=u.paint.get("raster-fade-duration");if(w>0){var k=a.browser.now(),E=(k-n.timeAdded)/w,P=s?(k-s.timeAdded)/w:-1,O=o.getSource(),Z=y.coveringZoomLevel({tileSize:O.tileSize,roundZoom:O.roundZoom}),G=!s||Math.abs(s.tileID.overscaledZ-Z)>Math.abs(n.tileID.overscaledZ-Z),X=G&&n.refreshedUponExpiration?1:a.clamp(G?E:1-P,0,1);return n.refreshedUponExpiration&&E>=1&&(n.refreshedUponExpiration=!1),s?{opacity:1,mix:1-X}:{opacity:X,mix:0}}return{opacity:1,mix:0}}var Xl=new a.Color(1,0,0,1),kc=new a.Color(0,1,0,1),Sc=new a.Color(0,0,1,1),Ws=new a.Color(1,0,1,1),Wl=new a.Color(0,1,1,1);function Hl(n,s,o,u){ms(n,0,s+o/2,n.transform.width,o,u)}function Jl(n,s,o,u){ms(n,s-o/2,0,o,n.transform.height,u)}function ms(n,s,o,u,y,w){var k=n.context,E=k.gl;E.enable(E.SCISSOR_TEST),E.scissor(s*a.browser.devicePixelRatio,o*a.browser.devicePixelRatio,u*a.browser.devicePixelRatio,y*a.browser.devicePixelRatio),k.clear({color:w}),E.disable(E.SCISSOR_TEST)}function Ec(n,s,o){var u=n.context,y=u.gl,w=o.posMatrix,k=n.useProgram("debug"),E=W.disabled,P=$.disabled,O=n.colorModeForRenderPass();u.activeTexture.set(y.TEXTURE0),n.emptyTexture.bind(y.LINEAR,y.CLAMP_TO_EDGE),k.draw(u,y.LINE_STRIP,E,P,O,he.disabled,wo(w,a.Color.red),"$debug",n.debugBuffer,n.tileBorderIndexBuffer,n.debugSegments);var Z=s.getTileByID(o.key).latestRawTileData,G=Math.floor((Z&&Z.byteLength||0)/1024),X=s.getTile(o).tileSize,re=512/Math.min(X,512)*(o.overscaledZ/n.transform.zoom)*.5,te=o.canonical.toString();o.overscaledZ!==o.canonical.z&&(te+=" => "+o.overscaledZ),function(ue,Y){ue.initDebugOverlayCanvas();var le=ue.debugOverlayCanvas,pe=ue.context.gl,ge=ue.debugOverlayCanvas.getContext("2d");ge.clearRect(0,0,le.width,le.height),ge.shadowColor="white",ge.shadowBlur=2,ge.lineWidth=1.5,ge.strokeStyle="white",ge.textBaseline="top",ge.font="bold 36px Open Sans, sans-serif",ge.fillText(Y,5,5),ge.strokeText(Y,5,5),ue.debugOverlayTexture.update(le),ue.debugOverlayTexture.bind(pe.LINEAR,pe.CLAMP_TO_EDGE)}(n,te+" "+G+"kb"),k.draw(u,y.TRIANGLES,E,P,se.alphaBlended,he.disabled,wo(w,a.Color.transparent,re),"$debug",n.debugBuffer,n.quadTriangleIndexBuffer,n.debugSegments)}var Eo={symbol:function(n,s,o,u,y){if(n.renderPass==="translucent"){var w=$.disabled,k=n.colorModeForRenderPass();o.layout.get("text-variable-anchor")&&function(E,P,O,Z,G,X,re){for(var te=P.transform,ue=G==="map",Y=X==="map",le=0,pe=E;le<pe.length;le+=1){var ge=pe[le],ze=Z.getTile(ge),Te=ze.getBucket(O);if(Te&&Te.text&&Te.text.segments.get().length){var Ae=a.evaluateSizeForZoom(Te.textSizeData,te.zoom),Re=Lr(ze,1,P.transform.zoom),Xe=vr(ge.posMatrix,Y,ue,P.transform,Re),Ge=O.layout.get("icon-text-fit")!=="none"&&Te.hasIconData();if(Ae){var at=Math.pow(2,te.zoom-ze.tileID.overscaledZ);xc(Te,ue,Y,re,a.symbolSize,te,Xe,ge.posMatrix,at,Ae,Ge)}}}}(u,n,o,s,o.layout.get("text-rotation-alignment"),o.layout.get("text-pitch-alignment"),y),o.paint.get("icon-opacity").constantOr(1)!==0&&So(n,s,o,u,!1,o.paint.get("icon-translate"),o.paint.get("icon-translate-anchor"),o.layout.get("icon-rotation-alignment"),o.layout.get("icon-pitch-alignment"),o.layout.get("icon-keep-upright"),w,k),o.paint.get("text-opacity").constantOr(1)!==0&&So(n,s,o,u,!0,o.paint.get("text-translate"),o.paint.get("text-translate-anchor"),o.layout.get("text-rotation-alignment"),o.layout.get("text-pitch-alignment"),o.layout.get("text-keep-upright"),w,k),s.map.showCollisionBoxes&&(Zo(n,s,o,u,o.paint.get("text-translate"),o.paint.get("text-translate-anchor"),!0),Zo(n,s,o,u,o.paint.get("icon-translate"),o.paint.get("icon-translate-anchor"),!1))}},circle:function(n,s,o,u){if(n.renderPass==="translucent"){var y=o.paint.get("circle-opacity"),w=o.paint.get("circle-stroke-width"),k=o.paint.get("circle-stroke-opacity"),E=o.layout.get("circle-sort-key").constantOr(1)!==void 0;if(y.constantOr(1)!==0||w.constantOr(1)!==0&&k.constantOr(1)!==0){for(var P=n.context,O=P.gl,Z=n.depthModeForSublayer(0,W.ReadOnly),G=$.disabled,X=n.colorModeForRenderPass(),re=[],te=0;te<u.length;te++){var ue=u[te],Y=s.getTile(ue),le=Y.getBucket(o);if(le){var pe=le.programConfigurations.get(o.id),ge={programConfiguration:pe,program:n.useProgram("circle",pe),layoutVertexBuffer:le.layoutVertexBuffer,indexBuffer:le.indexBuffer,uniformValues:Gl(n,ue,Y,o)};if(E)for(var ze=0,Te=le.segments.get();ze<Te.length;ze+=1){var Ae=Te[ze];re.push({segments:new a.SegmentVector([Ae]),sortKey:Ae.sortKey,state:ge})}else re.push({segments:le.segments,sortKey:0,state:ge})}}E&&re.sort(function(vt,kt){return vt.sortKey-kt.sortKey});for(var Re=0,Xe=re;Re<Xe.length;Re+=1){var Ge=Xe[Re],at=Ge.state;at.program.draw(P,O.TRIANGLES,Z,G,X,he.disabled,at.uniformValues,o.id,at.layoutVertexBuffer,at.indexBuffer,Ge.segments,o.paint,n.transform.zoom,at.programConfiguration)}}}},heatmap:function(n,s,o,u){if(o.paint.get("heatmap-opacity")!==0)if(n.renderPass==="offscreen"){var y=n.context,w=y.gl,k=$.disabled,E=new se([w.ONE,w.ONE],a.Color.transparent,[!0,!0,!0,!0]);(function(re,te,ue){var Y=re.gl;re.activeTexture.set(Y.TEXTURE1),re.viewport.set([0,0,te.width/4,te.height/4]);var le=ue.heatmapFbo;if(le)Y.bindTexture(Y.TEXTURE_2D,le.colorAttachment.get()),re.bindFramebuffer.set(le.framebuffer);else{var pe=Y.createTexture();Y.bindTexture(Y.TEXTURE_2D,pe),Y.texParameteri(Y.TEXTURE_2D,Y.TEXTURE_WRAP_S,Y.CLAMP_TO_EDGE),Y.texParameteri(Y.TEXTURE_2D,Y.TEXTURE_WRAP_T,Y.CLAMP_TO_EDGE),Y.texParameteri(Y.TEXTURE_2D,Y.TEXTURE_MIN_FILTER,Y.LINEAR),Y.texParameteri(Y.TEXTURE_2D,Y.TEXTURE_MAG_FILTER,Y.LINEAR),le=ue.heatmapFbo=re.createFramebuffer(te.width/4,te.height/4,!1),function(ge,ze,Te,Ae){var Re=ge.gl;Re.texImage2D(Re.TEXTURE_2D,0,Re.RGBA,ze.width/4,ze.height/4,0,Re.RGBA,ge.extRenderToTextureHalfFloat?ge.extTextureHalfFloat.HALF_FLOAT_OES:Re.UNSIGNED_BYTE,null),Ae.colorAttachment.set(Te)}(re,te,pe,le)}})(y,n,o),y.clear({color:a.Color.transparent});for(var P=0;P<u.length;P++){var O=u[P];if(!s.hasRenderableParent(O)){var Z=s.getTile(O),G=Z.getBucket(o);if(G){var X=G.programConfigurations.get(o.id);n.useProgram("heatmap",X).draw(y,w.TRIANGLES,W.disabled,k,E,he.disabled,yc(O.posMatrix,Z,n.transform.zoom,o.paint.get("heatmap-intensity")),o.id,G.layoutVertexBuffer,G.indexBuffer,G.segments,o.paint,n.transform.zoom,X)}}}y.viewport.set([0,0,n.width,n.height])}else n.renderPass==="translucent"&&(n.context.setColorMode(n.colorModeForRenderPass()),function(re,te){var ue=re.context,Y=ue.gl,le=te.heatmapFbo;if(le){ue.activeTexture.set(Y.TEXTURE0),Y.bindTexture(Y.TEXTURE_2D,le.colorAttachment.get()),ue.activeTexture.set(Y.TEXTURE1);var pe=te.colorRampTexture;pe||(pe=te.colorRampTexture=new a.Texture(ue,te.colorRamp,Y.RGBA)),pe.bind(Y.LINEAR,Y.CLAMP_TO_EDGE),re.useProgram("heatmapTexture").draw(ue,Y.TRIANGLES,W.disabled,$.disabled,re.colorModeForRenderPass(),he.disabled,function(ge,ze,Te,Ae){var Re=a.create();a.ortho(Re,0,ge.width,ge.height,0,0,1);var Xe=ge.context.gl;return{u_matrix:Re,u_world:[Xe.drawingBufferWidth,Xe.drawingBufferHeight],u_image:0,u_color_ramp:1,u_opacity:ze.paint.get("heatmap-opacity")}}(re,te),te.id,re.viewportBuffer,re.quadTriangleIndexBuffer,re.viewportSegments,te.paint,re.transform.zoom)}}(n,o))},line:function(n,s,o,u){if(n.renderPass==="translucent"){var y=o.paint.get("line-opacity"),w=o.paint.get("line-width");if(y.constantOr(1)!==0&&w.constantOr(1)!==0)for(var k=n.depthModeForSublayer(0,W.ReadOnly),E=n.colorModeForRenderPass(),P=o.paint.get("line-dasharray"),O=o.paint.get("line-pattern"),Z=O.constantOr(1),G=o.paint.get("line-gradient"),X=o.getCrossfadeParameters(),re=Z?"linePattern":P?"lineSDF":G?"lineGradient":"line",te=n.context,ue=te.gl,Y=!0,le=0,pe=u;le<pe.length;le+=1){var ge=pe[le],ze=s.getTile(ge);if(!Z||ze.patternsLoaded()){var Te=ze.getBucket(o);if(Te){var Ae=Te.programConfigurations.get(o.id),Re=n.context.program.get(),Xe=n.useProgram(re,Ae),Ge=Y||Xe.program!==Re,at=O.constantOr(null);if(at&&ze.imageAtlas){var vt=ze.imageAtlas,kt=vt.patternPositions[at.to.toString()],wt=vt.patternPositions[at.from.toString()];kt&&wt&&Ae.setConstantPatternPositions(kt,wt)}var _r=Z?js(n,ze,o,X):P?Zh(n,ze,o,P,X):G?Vr(n,ze,o,Te.lineClipsArray.length):hs(n,ze,o);if(Z)te.activeTexture.set(ue.TEXTURE0),ze.imageAtlasTexture.bind(ue.LINEAR,ue.CLAMP_TO_EDGE),Ae.updatePaintBuffers(X);else if(P&&(Ge||n.lineAtlas.dirty))te.activeTexture.set(ue.TEXTURE0),n.lineAtlas.bind(te);else if(G){var ot=Te.gradients[o.id],Nt=ot.texture;if(o.gradientVersion!==ot.version){var Yt=256;if(o.stepInterpolant){var Ot=s.getSource().maxzoom,Bt=ge.canonical.z===Ot?Math.ceil(1<<n.transform.maxZoom-ge.canonical.z):1;Yt=a.clamp(a.nextPowerOfTwo(Te.maxLineLength/a.EXTENT*1024*Bt),256,te.maxTextureSize)}ot.gradient=a.renderColorRamp({expression:o.gradientExpression(),evaluationKey:"lineProgress",resolution:Yt,image:ot.gradient||void 0,clips:Te.lineClipsArray}),ot.texture?ot.texture.update(ot.gradient):ot.texture=new a.Texture(te,ot.gradient,ue.RGBA),ot.version=o.gradientVersion,Nt=ot.texture}te.activeTexture.set(ue.TEXTURE0),Nt.bind(o.stepInterpolant?ue.NEAREST:ue.LINEAR,ue.CLAMP_TO_EDGE)}Xe.draw(te,ue.TRIANGLES,k,n.stencilModeForClipping(ge),E,he.disabled,_r,o.id,Te.layoutVertexBuffer,Te.indexBuffer,Te.segments,o.paint,n.transform.zoom,Ae,Te.layoutVertexBuffer2),Y=!1}}}}},fill:function(n,s,o,u){var y=o.paint.get("fill-color"),w=o.paint.get("fill-opacity");if(w.constantOr(1)!==0){var k=n.colorModeForRenderPass(),E=o.paint.get("fill-pattern"),P=n.opaquePassEnabledForLayer()&&!E.constantOr(1)&&y.constantOr(a.Color.transparent).a===1&&w.constantOr(0)===1?"opaque":"translucent";if(n.renderPass===P){var O=n.depthModeForSublayer(1,n.renderPass==="opaque"?W.ReadWrite:W.ReadOnly);Gs(n,s,o,u,O,k,!1)}if(n.renderPass==="translucent"&&o.paint.get("fill-antialias")){var Z=n.depthModeForSublayer(o.getPaintProperty("fill-outline-color")?2:0,W.ReadOnly);Gs(n,s,o,u,Z,k,!0)}}},"fill-extrusion":function(n,s,o,u){var y=o.paint.get("fill-extrusion-opacity");if(y!==0&&n.renderPass==="translucent"){var w=new W(n.context.gl.LEQUAL,W.ReadWrite,n.depthRangeFor3D);if(y!==1||o.paint.get("fill-extrusion-pattern").constantOr(1))Kl(n,s,o,u,w,$.disabled,se.disabled),Kl(n,s,o,u,w,n.stencilModeFor3D(),n.colorModeForRenderPass());else{var k=n.colorModeForRenderPass();Kl(n,s,o,u,w,$.disabled,k)}}},hillshade:function(n,s,o,u){if(n.renderPass==="offscreen"||n.renderPass==="translucent"){for(var y=n.context,w=n.depthModeForSublayer(0,W.ReadOnly),k=n.colorModeForRenderPass(),E=n.renderPass==="translucent"?n.stencilConfigForOverlap(u):[{},u],P=E[0],O=0,Z=E[1];O<Z.length;O+=1){var G=Z[O],X=s.getTile(G);X.needsHillshadePrepare&&n.renderPass==="offscreen"?Kh(n,X,o,w,$.disabled,k):n.renderPass==="translucent"&&Ks(n,X,o,w,P[G.overscaledZ],k)}y.viewport.set([0,0,n.width,n.height])}},raster:function(n,s,o,u){if(n.renderPass==="translucent"&&o.paint.get("raster-opacity")!==0&&u.length)for(var y=n.context,w=y.gl,k=s.getSource(),E=n.useProgram("raster"),P=n.colorModeForRenderPass(),O=k instanceof At?[{},u]:n.stencilConfigForOverlap(u),Z=O[0],G=O[1],X=G[G.length-1].overscaledZ,re=!n.options.moving,te=0,ue=G;te<ue.length;te+=1){var Y=ue[te],le=n.depthModeForSublayer(Y.overscaledZ-X,o.paint.get("raster-opacity")===1?W.ReadWrite:W.ReadOnly,w.LESS),pe=s.getTile(Y),ge=n.transform.calculatePosMatrix(Y.toUnwrapped(),re);pe.registerFadeDuration(o.paint.get("raster-fade-duration"));var ze=s.findLoadedParent(Y,0),Te=Xs(pe,ze,s,o,n.transform),Ae=void 0,Re=void 0,Xe=o.paint.get("raster-resampling")==="nearest"?w.NEAREST:w.LINEAR;y.activeTexture.set(w.TEXTURE0),pe.texture.bind(Xe,w.CLAMP_TO_EDGE,w.LINEAR_MIPMAP_NEAREST),y.activeTexture.set(w.TEXTURE1),ze?(ze.texture.bind(Xe,w.CLAMP_TO_EDGE,w.LINEAR_MIPMAP_NEAREST),Ae=Math.pow(2,ze.tileID.overscaledZ-pe.tileID.overscaledZ),Re=[pe.tileID.canonical.x*Ae%1,pe.tileID.canonical.y*Ae%1]):pe.texture.bind(Xe,w.CLAMP_TO_EDGE,w.LINEAR_MIPMAP_NEAREST);var Ge=Gh(ge,Re||[0,0],Ae||1,Te,o);k instanceof At?E.draw(y,w.TRIANGLES,le,$.disabled,P,he.disabled,Ge,o.id,k.boundsBuffer,n.quadTriangleIndexBuffer,k.boundsSegments):E.draw(y,w.TRIANGLES,le,Z[Y.overscaledZ],P,he.disabled,Ge,o.id,n.rasterBoundsBuffer,n.quadTriangleIndexBuffer,n.rasterBoundsSegments)}},background:function(n,s,o){var u=o.paint.get("background-color"),y=o.paint.get("background-opacity");if(y!==0){var w=n.context,k=w.gl,E=n.transform,P=E.tileSize,O=o.paint.get("background-pattern");if(!n.isPatternMissing(O)){var Z=!O&&u.a===1&&y===1&&n.opaquePassEnabledForLayer()?"opaque":"translucent";if(n.renderPass===Z){var G=$.disabled,X=n.depthModeForSublayer(0,Z==="opaque"?W.ReadWrite:W.ReadOnly),re=n.colorModeForRenderPass(),te=n.useProgram(O?"backgroundPattern":"background"),ue=E.coveringTiles({tileSize:P});O&&(w.activeTexture.set(k.TEXTURE0),n.imageManager.bind(n.context));for(var Y=o.getCrossfadeParameters(),le=0,pe=ue;le<pe.length;le+=1){var ge=pe[le],ze=n.transform.calculatePosMatrix(ge.toUnwrapped()),Te=O?qo(ze,y,n,O,{tileID:ge,tileSize:P},Y):fs(ze,y,u);te.draw(w,k.TRIANGLES,X,G,re,he.disabled,Te,o.id,n.tileExtentBuffer,n.quadTriangleIndexBuffer,n.tileExtentSegments)}}}}},debug:function(n,s,o){for(var u=0;u<o.length;u++)Ec(n,s,o[u])},custom:function(n,s,o){var u=n.context,y=o.implementation;if(n.renderPass==="offscreen"){var w=y.prerender;w&&(n.setCustomLayerDefaults(),u.setColorMode(n.colorModeForRenderPass()),w.call(y,u.gl,n.transform.customLayerMatrix()),u.setDirty(),n.setBaseState())}else if(n.renderPass==="translucent"){n.setCustomLayerDefaults(),u.setColorMode(n.colorModeForRenderPass()),u.setStencilMode($.disabled);var k=y.renderingMode==="3d"?new W(n.context.gl.LEQUAL,W.ReadWrite,n.depthRangeFor3D):n.depthModeForSublayer(0,W.ReadOnly);u.setDepthMode(k),y.render(u.gl,n.transform.customLayerMatrix()),u.setDirty(),n.setBaseState(),u.bindFramebuffer.set(null)}}},Jr=function(n,s){this.context=new j(n),this.transform=s,this._tileTextures={},this.setup(),this.numSublayers=J.maxUnderzooming+J.maxOverzooming+1,this.depthEpsilon=1/Math.pow(2,16),this.crossTileSymbolIndex=new ye,this.gpuTimers={}};Jr.prototype.resize=function(n,s){if(this.width=n*a.browser.devicePixelRatio,this.height=s*a.browser.devicePixelRatio,this.context.viewport.set([0,0,this.width,this.height]),this.style)for(var o=0,u=this.style._order;o<u.length;o+=1)this.style._layers[u[o]].resize()},Jr.prototype.setup=function(){var n=this.context,s=new a.StructArrayLayout2i4;s.emplaceBack(0,0),s.emplaceBack(a.EXTENT,0),s.emplaceBack(0,a.EXTENT),s.emplaceBack(a.EXTENT,a.EXTENT),this.tileExtentBuffer=n.createVertexBuffer(s,xi.members),this.tileExtentSegments=a.SegmentVector.simpleSegment(0,0,4,2);var o=new a.StructArrayLayout2i4;o.emplaceBack(0,0),o.emplaceBack(a.EXTENT,0),o.emplaceBack(0,a.EXTENT),o.emplaceBack(a.EXTENT,a.EXTENT),this.debugBuffer=n.createVertexBuffer(o,xi.members),this.debugSegments=a.SegmentVector.simpleSegment(0,0,4,5);var u=new a.StructArrayLayout4i8;u.emplaceBack(0,0,0,0),u.emplaceBack(a.EXTENT,0,a.EXTENT,0),u.emplaceBack(0,a.EXTENT,0,a.EXTENT),u.emplaceBack(a.EXTENT,a.EXTENT,a.EXTENT,a.EXTENT),this.rasterBoundsBuffer=n.createVertexBuffer(u,Je.members),this.rasterBoundsSegments=a.SegmentVector.simpleSegment(0,0,4,2);var y=new a.StructArrayLayout2i4;y.emplaceBack(0,0),y.emplaceBack(1,0),y.emplaceBack(0,1),y.emplaceBack(1,1),this.viewportBuffer=n.createVertexBuffer(y,xi.members),this.viewportSegments=a.SegmentVector.simpleSegment(0,0,4,2);var w=new a.StructArrayLayout1ui2;w.emplaceBack(0),w.emplaceBack(1),w.emplaceBack(3),w.emplaceBack(2),w.emplaceBack(0),this.tileBorderIndexBuffer=n.createIndexBuffer(w);var k=new a.StructArrayLayout3ui6;k.emplaceBack(0,1,2),k.emplaceBack(2,1,3),this.quadTriangleIndexBuffer=n.createIndexBuffer(k),this.emptyTexture=new a.Texture(n,{width:1,height:1,data:new Uint8Array([0,0,0,0])},n.gl.RGBA);var E=this.context.gl;this.stencilClearMode=new $({func:E.ALWAYS,mask:0},0,255,E.ZERO,E.ZERO,E.ZERO)},Jr.prototype.clearStencil=function(){var n=this.context,s=n.gl;this.nextStencilID=1,this.currentStencilSource=void 0;var o=a.create();a.ortho(o,0,this.width,this.height,0,0,1),a.scale(o,o,[s.drawingBufferWidth,s.drawingBufferHeight,0]),this.useProgram("clippingMask").draw(n,s.TRIANGLES,W.disabled,this.stencilClearMode,se.disabled,he.disabled,ko(o),"$clipping",this.viewportBuffer,this.quadTriangleIndexBuffer,this.viewportSegments)},Jr.prototype._renderTileClippingMasks=function(n,s){if(this.currentStencilSource!==n.source&&n.isTileClipped()&&s&&s.length){this.currentStencilSource=n.source;var o=this.context,u=o.gl;this.nextStencilID+s.length>256&&this.clearStencil(),o.setColorMode(se.disabled),o.setDepthMode(W.disabled);var y=this.useProgram("clippingMask");this._tileClippingMaskIDs={};for(var w=0,k=s;w<k.length;w+=1){var E=k[w],P=this._tileClippingMaskIDs[E.key]=this.nextStencilID++;y.draw(o,u.TRIANGLES,W.disabled,new $({func:u.ALWAYS,mask:0},P,255,u.KEEP,u.KEEP,u.REPLACE),se.disabled,he.disabled,ko(E.posMatrix),"$clipping",this.tileExtentBuffer,this.quadTriangleIndexBuffer,this.tileExtentSegments)}}},Jr.prototype.stencilModeFor3D=function(){this.currentStencilSource=void 0,this.nextStencilID+1>256&&this.clearStencil();var n=this.nextStencilID++,s=this.context.gl;return new $({func:s.NOTEQUAL,mask:255},n,255,s.KEEP,s.KEEP,s.REPLACE)},Jr.prototype.stencilModeForClipping=function(n){var s=this.context.gl;return new $({func:s.EQUAL,mask:255},this._tileClippingMaskIDs[n.key],0,s.KEEP,s.KEEP,s.REPLACE)},Jr.prototype.stencilConfigForOverlap=function(n){var s,o=this.context.gl,u=n.sort(function(P,O){return O.overscaledZ-P.overscaledZ}),y=u[u.length-1].overscaledZ,w=u[0].overscaledZ-y+1;if(w>1){this.currentStencilSource=void 0,this.nextStencilID+w>256&&this.clearStencil();for(var k={},E=0;E<w;E++)k[E+y]=new $({func:o.GEQUAL,mask:255},E+this.nextStencilID,255,o.KEEP,o.KEEP,o.REPLACE);return this.nextStencilID+=w,[k,u]}return[(s={},s[y]=$.disabled,s),u]},Jr.prototype.colorModeForRenderPass=function(){var n=this.context.gl;return this._showOverdrawInspector?new se([n.CONSTANT_COLOR,n.ONE],new a.Color(1/8,1/8,1/8,0),[!0,!0,!0,!0]):this.renderPass==="opaque"?se.unblended:se.alphaBlended},Jr.prototype.depthModeForSublayer=function(n,s,o){if(!this.opaquePassEnabledForLayer())return W.disabled;var u=1-((1+this.currentLayer)*this.numSublayers+n)*this.depthEpsilon;return new W(o||this.context.gl.LEQUAL,s,[u,u])},Jr.prototype.opaquePassEnabledForLayer=function(){return this.currentLayer<this.opaquePassCutoff},Jr.prototype.render=function(n,s){var o=this;this.style=n,this.options=s,this.lineAtlas=n.lineAtlas,this.imageManager=n.imageManager,this.glyphManager=n.glyphManager,this.symbolFadeChange=n.placement.symbolFadeChange(a.browser.now()),this.imageManager.beginFrame();var u=this.style._order,y=this.style.sourceCaches;for(var w in y){var k=y[w];k.used&&k.prepare(this.context)}var E,P,O={},Z={},G={};for(var X in y){var re=y[X];O[X]=re.getVisibleCoordinates(),Z[X]=O[X].slice().reverse(),G[X]=re.getVisibleCoordinates(!0).reverse()}this.opaquePassCutoff=1/0;for(var te=0;te<u.length;te++)if(this.style._layers[u[te]].is3D()){this.opaquePassCutoff=te;break}this.renderPass="offscreen";for(var ue=0,Y=u;ue<Y.length;ue+=1){var le=this.style._layers[Y[ue]];if(le.hasOffscreenPass()&&!le.isHidden(this.transform.zoom)){var pe=Z[le.source];(le.type==="custom"||pe.length)&&this.renderLayer(this,y[le.source],le,pe)}}for(this.context.bindFramebuffer.set(null),this.context.clear({color:s.showOverdrawInspector?a.Color.black:a.Color.transparent,depth:1}),this.clearStencil(),this._showOverdrawInspector=s.showOverdrawInspector,this.depthRangeFor3D=[0,1-(n._order.length+2)*this.numSublayers*this.depthEpsilon],this.renderPass="opaque",this.currentLayer=u.length-1;this.currentLayer>=0;this.currentLayer--){var ge=this.style._layers[u[this.currentLayer]],ze=y[ge.source],Te=O[ge.source];this._renderTileClippingMasks(ge,Te),this.renderLayer(this,ze,ge,Te)}for(this.renderPass="translucent",this.currentLayer=0;this.currentLayer<u.length;this.currentLayer++){var Ae=this.style._layers[u[this.currentLayer]],Re=y[Ae.source],Xe=(Ae.type==="symbol"?G:Z)[Ae.source];this._renderTileClippingMasks(Ae,O[Ae.source]),this.renderLayer(this,Re,Ae,Xe)}this.options.showTileBoundaries&&(a.values(this.style._layers).forEach(function(Ge){Ge.source&&!Ge.isHidden(o.transform.zoom)&&(Ge.source!==(P&&P.id)&&(P=o.style.sourceCaches[Ge.source]),(!E||E.getSource().maxzoom<P.getSource().maxzoom)&&(E=P))}),E&&Eo.debug(this,E,E.getVisibleCoordinates())),this.options.showPadding&&function(Ge){var at=Ge.transform.padding;Hl(Ge,Ge.transform.height-(at.top||0),3,Xl),Hl(Ge,at.bottom||0,3,kc),Jl(Ge,at.left||0,3,Sc),Jl(Ge,Ge.transform.width-(at.right||0),3,Ws);var vt=Ge.transform.centerPoint;(function(kt,wt,_r,ot){ms(kt,wt-1,_r-10,2,20,ot),ms(kt,wt-10,_r-1,20,2,ot)})(Ge,vt.x,Ge.transform.height-vt.y,Wl)}(this),this.context.setDefault()},Jr.prototype.renderLayer=function(n,s,o,u){o.isHidden(this.transform.zoom)||(o.type==="background"||o.type==="custom"||u.length)&&(this.id=o.id,this.gpuTimingStart(o),Eo[o.type](n,s,o,u,this.style.placement.variableOffsets),this.gpuTimingEnd())},Jr.prototype.gpuTimingStart=function(n){if(this.options.gpuTiming){var s=this.context.extTimerQuery,o=this.gpuTimers[n.id];o||(o=this.gpuTimers[n.id]={calls:0,cpuTime:0,query:s.createQueryEXT()}),o.calls++,s.beginQueryEXT(s.TIME_ELAPSED_EXT,o.query)}},Jr.prototype.gpuTimingEnd=function(){if(this.options.gpuTiming){var n=this.context.extTimerQuery;n.endQueryEXT(n.TIME_ELAPSED_EXT)}},Jr.prototype.collectGpuTimers=function(){var n=this.gpuTimers;return this.gpuTimers={},n},Jr.prototype.queryGpuTimers=function(n){var s={};for(var o in n){var u=n[o],y=this.context.extTimerQuery,w=y.getQueryObjectEXT(u.query,y.QUERY_RESULT_EXT)/1e6;y.deleteQueryEXT(u.query),s[o]=w}return s},Jr.prototype.translatePosMatrix=function(n,s,o,u,y){if(!o[0]&&!o[1])return n;var w=y?u==="map"?this.transform.angle:0:u==="viewport"?-this.transform.angle:0;if(w){var k=Math.sin(w),E=Math.cos(w);o=[o[0]*E-o[1]*k,o[0]*k+o[1]*E]}var P=[y?o[0]:Lr(s,o[0],this.transform.zoom),y?o[1]:Lr(s,o[1],this.transform.zoom),0],O=new Float32Array(16);return a.translate(O,n,P),O},Jr.prototype.saveTileTexture=function(n){var s=this._tileTextures[n.size[0]];s?s.push(n):this._tileTextures[n.size[0]]=[n]},Jr.prototype.getTileTexture=function(n){var s=this._tileTextures[n];return s&&s.length>0?s.pop():null},Jr.prototype.isPatternMissing=function(n){if(!n)return!1;if(!n.from||!n.to)return!0;var s=this.imageManager.getPattern(n.from.toString()),o=this.imageManager.getPattern(n.to.toString());return!s||!o},Jr.prototype.useProgram=function(n,s){this.cache=this.cache||{};var o=""+n+(s?s.cacheKey:"")+(this._showOverdrawInspector?"/overdraw":"");return this.cache[o]||(this.cache[o]=new cc(this.context,n,qh[n],s,vc[n],this._showOverdrawInspector)),this.cache[o]},Jr.prototype.setCustomLayerDefaults=function(){this.context.unbindVAO(),this.context.cullFace.setDefault(),this.context.activeTexture.setDefault(),this.context.pixelStoreUnpack.setDefault(),this.context.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.context.pixelStoreUnpackFlipY.setDefault()},Jr.prototype.setBaseState=function(){var n=this.context.gl;this.context.cullFace.set(!1),this.context.viewport.set([0,0,this.width,this.height]),this.context.blendEquation.set(n.FUNC_ADD)},Jr.prototype.initDebugOverlayCanvas=function(){this.debugOverlayCanvas==null&&(this.debugOverlayCanvas=a.window.document.createElement("canvas"),this.debugOverlayCanvas.width=512,this.debugOverlayCanvas.height=512,this.debugOverlayTexture=new a.Texture(this.context,this.debugOverlayCanvas,this.context.gl.RGBA))},Jr.prototype.destroy=function(){this.emptyTexture.destroy(),this.debugOverlayTexture&&this.debugOverlayTexture.destroy()};var Hs=function(n,s){this.points=n,this.planes=s};Hs.fromInvProjectionMatrix=function(n,s,o){var u=Math.pow(2,o),y=[[-1,1,-1,1],[1,1,-1,1],[1,-1,-1,1],[-1,-1,-1,1],[-1,1,1,1],[1,1,1,1],[1,-1,1,1],[-1,-1,1,1]].map(function(k){return a.transformMat4([],k,n)}).map(function(k){return a.scale$1([],k,1/k[3]/s*u)}),w=[[0,1,2],[6,5,4],[0,3,7],[2,1,5],[3,2,6],[0,4,5]].map(function(k){var E=a.sub([],y[k[0]],y[k[1]]),P=a.sub([],y[k[2]],y[k[1]]),O=a.normalize([],a.cross([],E,P)),Z=-a.dot(O,y[k[1]]);return O.concat(Z)});return new Hs(y,w)};var To=function(n,s){this.min=n,this.max=s,this.center=a.scale$2([],a.add([],this.min,this.max),.5)};To.prototype.quadrant=function(n){for(var s=[n%2==0,n<2],o=a.clone$2(this.min),u=a.clone$2(this.max),y=0;y<s.length;y++)o[y]=s[y]?this.min[y]:this.center[y],u[y]=s[y]?this.center[y]:this.max[y];return u[2]=this.max[2],new To(o,u)},To.prototype.distanceX=function(n){return Math.max(Math.min(this.max[0],n[0]),this.min[0])-n[0]},To.prototype.distanceY=function(n){return Math.max(Math.min(this.max[1],n[1]),this.min[1])-n[1]},To.prototype.intersects=function(n){for(var s=[[this.min[0],this.min[1],0,1],[this.max[0],this.min[1],0,1],[this.max[0],this.max[1],0,1],[this.min[0],this.max[1],0,1]],o=!0,u=0;u<n.planes.length;u++){for(var y=n.planes[u],w=0,k=0;k<s.length;k++)w+=a.dot$1(y,s[k])>=0;if(w===0)return 0;w!==s.length&&(o=!1)}if(o)return 2;for(var E=0;E<3;E++){for(var P=Number.MAX_VALUE,O=-Number.MAX_VALUE,Z=0;Z<n.points.length;Z++){var G=n.points[Z][E]-this.min[E];P=Math.min(P,G),O=Math.max(O,G)}if(O<0||P>this.max[E]-this.min[E])return 0}return 1};var Ja=function(n,s,o,u){if(n===void 0&&(n=0),s===void 0&&(s=0),o===void 0&&(o=0),u===void 0&&(u=0),isNaN(n)||n<0||isNaN(s)||s<0||isNaN(o)||o<0||isNaN(u)||u<0)throw new Error("Invalid value for edge-insets, top, bottom, left and right must all be numbers");this.top=n,this.bottom=s,this.left=o,this.right=u};Ja.prototype.interpolate=function(n,s,o){return s.top!=null&&n.top!=null&&(this.top=a.number(n.top,s.top,o)),s.bottom!=null&&n.bottom!=null&&(this.bottom=a.number(n.bottom,s.bottom,o)),s.left!=null&&n.left!=null&&(this.left=a.number(n.left,s.left,o)),s.right!=null&&n.right!=null&&(this.right=a.number(n.right,s.right,o)),this},Ja.prototype.getCenter=function(n,s){var o=a.clamp((this.left+n-this.right)/2,0,n),u=a.clamp((this.top+s-this.bottom)/2,0,s);return new a.Point(o,u)},Ja.prototype.equals=function(n){return this.top===n.top&&this.bottom===n.bottom&&this.left===n.left&&this.right===n.right},Ja.prototype.clone=function(){return new Ja(this.top,this.bottom,this.left,this.right)},Ja.prototype.toJSON=function(){return{top:this.top,bottom:this.bottom,left:this.left,right:this.right}};var dr=function(n,s,o,u,y){this.tileSize=512,this.maxValidLatitude=85.051129,this._renderWorldCopies=y===void 0||y,this._minZoom=n||0,this._maxZoom=s||22,this._minPitch=o??0,this._maxPitch=u??60,this.setMaxBounds(),this.width=0,this.height=0,this._center=new a.LngLat(0,0),this.zoom=0,this.angle=0,this._fov=.6435011087932844,this._pitch=0,this._unmodified=!0,this._edgeInsets=new Ja,this._posMatrixCache={},this._alignedPosMatrixCache={}},jr={minZoom:{configurable:!0},maxZoom:{configurable:!0},minPitch:{configurable:!0},maxPitch:{configurable:!0},renderWorldCopies:{configurable:!0},worldSize:{configurable:!0},centerOffset:{configurable:!0},size:{configurable:!0},bearing:{configurable:!0},pitch:{configurable:!0},fov:{configurable:!0},zoom:{configurable:!0},center:{configurable:!0},padding:{configurable:!0},centerPoint:{configurable:!0},unmodified:{configurable:!0},point:{configurable:!0}};dr.prototype.clone=function(){var n=new dr(this._minZoom,this._maxZoom,this._minPitch,this.maxPitch,this._renderWorldCopies);return n.tileSize=this.tileSize,n.latRange=this.latRange,n.width=this.width,n.height=this.height,n._center=this._center,n.zoom=this.zoom,n.angle=this.angle,n._fov=this._fov,n._pitch=this._pitch,n._unmodified=this._unmodified,n._edgeInsets=this._edgeInsets.clone(),n._calcMatrices(),n},jr.minZoom.get=function(){return this._minZoom},jr.minZoom.set=function(n){this._minZoom!==n&&(this._minZoom=n,this.zoom=Math.max(this.zoom,n))},jr.maxZoom.get=function(){return this._maxZoom},jr.maxZoom.set=function(n){this._maxZoom!==n&&(this._maxZoom=n,this.zoom=Math.min(this.zoom,n))},jr.minPitch.get=function(){return this._minPitch},jr.minPitch.set=function(n){this._minPitch!==n&&(this._minPitch=n,this.pitch=Math.max(this.pitch,n))},jr.maxPitch.get=function(){return this._maxPitch},jr.maxPitch.set=function(n){this._maxPitch!==n&&(this._maxPitch=n,this.pitch=Math.min(this.pitch,n))},jr.renderWorldCopies.get=function(){return this._renderWorldCopies},jr.renderWorldCopies.set=function(n){n===void 0?n=!0:n===null&&(n=!1),this._renderWorldCopies=n},jr.worldSize.get=function(){return this.tileSize*this.scale},jr.centerOffset.get=function(){return this.centerPoint._sub(this.size._div(2))},jr.size.get=function(){return new a.Point(this.width,this.height)},jr.bearing.get=function(){return-this.angle/Math.PI*180},jr.bearing.set=function(n){var s=-a.wrap(n,-180,180)*Math.PI/180;this.angle!==s&&(this._unmodified=!1,this.angle=s,this._calcMatrices(),this.rotationMatrix=a.create$2(),a.rotate(this.rotationMatrix,this.rotationMatrix,this.angle))},jr.pitch.get=function(){return this._pitch/Math.PI*180},jr.pitch.set=function(n){var s=a.clamp(n,this.minPitch,this.maxPitch)/180*Math.PI;this._pitch!==s&&(this._unmodified=!1,this._pitch=s,this._calcMatrices())},jr.fov.get=function(){return this._fov/Math.PI*180},jr.fov.set=function(n){n=Math.max(.01,Math.min(60,n)),this._fov!==n&&(this._unmodified=!1,this._fov=n/180*Math.PI,this._calcMatrices())},jr.zoom.get=function(){return this._zoom},jr.zoom.set=function(n){var s=Math.min(Math.max(n,this.minZoom),this.maxZoom);this._zoom!==s&&(this._unmodified=!1,this._zoom=s,this.scale=this.zoomScale(s),this.tileZoom=Math.floor(s),this.zoomFraction=s-this.tileZoom,this._constrain(),this._calcMatrices())},jr.center.get=function(){return this._center},jr.center.set=function(n){n.lat===this._center.lat&&n.lng===this._center.lng||(this._unmodified=!1,this._center=n,this._constrain(),this._calcMatrices())},jr.padding.get=function(){return this._edgeInsets.toJSON()},jr.padding.set=function(n){this._edgeInsets.equals(n)||(this._unmodified=!1,this._edgeInsets.interpolate(this._edgeInsets,n,1),this._calcMatrices())},jr.centerPoint.get=function(){return this._edgeInsets.getCenter(this.width,this.height)},dr.prototype.isPaddingEqual=function(n){return this._edgeInsets.equals(n)},dr.prototype.interpolatePadding=function(n,s,o){this._unmodified=!1,this._edgeInsets.interpolate(n,s,o),this._constrain(),this._calcMatrices()},dr.prototype.coveringZoomLevel=function(n){var s=(n.roundZoom?Math.round:Math.floor)(this.zoom+this.scaleZoom(this.tileSize/n.tileSize));return Math.max(0,s)},dr.prototype.getVisibleUnwrappedCoordinates=function(n){var s=[new a.UnwrappedTileID(0,n)];if(this._renderWorldCopies)for(var o=this.pointCoordinate(new a.Point(0,0)),u=this.pointCoordinate(new a.Point(this.width,0)),y=this.pointCoordinate(new a.Point(this.width,this.height)),w=this.pointCoordinate(new a.Point(0,this.height)),k=Math.floor(Math.min(o.x,u.x,y.x,w.x)),E=Math.floor(Math.max(o.x,u.x,y.x,w.x)),P=k-1;P<=E+1;P++)P!==0&&s.push(new a.UnwrappedTileID(P,n));return s},dr.prototype.coveringTiles=function(n){var s=this.coveringZoomLevel(n),o=s;if(n.minzoom!==void 0&&s<n.minzoom)return[];n.maxzoom!==void 0&&s>n.maxzoom&&(s=n.maxzoom);var u=a.MercatorCoordinate.fromLngLat(this.center),y=Math.pow(2,s),w=[y*u.x,y*u.y,0],k=Hs.fromInvProjectionMatrix(this.invProjMatrix,this.worldSize,s),E=n.minzoom||0;this.pitch<=60&&this._edgeInsets.top<.1&&(E=s);var P=function(Ge){return{aabb:new To([Ge*y,0,0],[(Ge+1)*y,y,0]),zoom:0,x:0,y:0,wrap:Ge,fullyVisible:!1}},O=[],Z=[],G=s,X=n.reparseOverscaled?o:s;if(this._renderWorldCopies)for(var re=1;re<=3;re++)O.push(P(-re)),O.push(P(re));for(O.push(P(0));O.length>0;){var te=O.pop(),ue=te.x,Y=te.y,le=te.fullyVisible;if(!le){var pe=te.aabb.intersects(k);if(pe===0)continue;le=pe===2}var ge=te.aabb.distanceX(w),ze=te.aabb.distanceY(w),Te=Math.max(Math.abs(ge),Math.abs(ze));if(te.zoom===G||Te>3+(1<<G-te.zoom)-2&&te.zoom>=E)Z.push({tileID:new a.OverscaledTileID(te.zoom===G?X:te.zoom,te.wrap,te.zoom,ue,Y),distanceSq:a.sqrLen([w[0]-.5-ue,w[1]-.5-Y])});else for(var Ae=0;Ae<4;Ae++){var Re=(ue<<1)+Ae%2,Xe=(Y<<1)+(Ae>>1);O.push({aabb:te.aabb.quadrant(Ae),zoom:te.zoom+1,x:Re,y:Xe,wrap:te.wrap,fullyVisible:le})}}return Z.sort(function(Ge,at){return Ge.distanceSq-at.distanceSq}).map(function(Ge){return Ge.tileID})},dr.prototype.resize=function(n,s){this.width=n,this.height=s,this.pixelsToGLUnits=[2/n,-2/s],this._constrain(),this._calcMatrices()},jr.unmodified.get=function(){return this._unmodified},dr.prototype.zoomScale=function(n){return Math.pow(2,n)},dr.prototype.scaleZoom=function(n){return Math.log(n)/Math.LN2},dr.prototype.project=function(n){var s=a.clamp(n.lat,-this.maxValidLatitude,this.maxValidLatitude);return new a.Point(a.mercatorXfromLng(n.lng)*this.worldSize,a.mercatorYfromLat(s)*this.worldSize)},dr.prototype.unproject=function(n){return new a.MercatorCoordinate(n.x/this.worldSize,n.y/this.worldSize).toLngLat()},jr.point.get=function(){return this.project(this.center)},dr.prototype.setLocationAtPoint=function(n,s){var o=this.pointCoordinate(s),u=this.pointCoordinate(this.centerPoint),y=this.locationCoordinate(n),w=new a.MercatorCoordinate(y.x-(o.x-u.x),y.y-(o.y-u.y));this.center=this.coordinateLocation(w),this._renderWorldCopies&&(this.center=this.center.wrap())},dr.prototype.locationPoint=function(n){return this.coordinatePoint(this.locationCoordinate(n))},dr.prototype.pointLocation=function(n){return this.coordinateLocation(this.pointCoordinate(n))},dr.prototype.locationCoordinate=function(n){return a.MercatorCoordinate.fromLngLat(n)},dr.prototype.coordinateLocation=function(n){return n.toLngLat()},dr.prototype.pointCoordinate=function(n){var s=[n.x,n.y,0,1],o=[n.x,n.y,1,1];a.transformMat4(s,s,this.pixelMatrixInverse),a.transformMat4(o,o,this.pixelMatrixInverse);var u=s[3],y=o[3],w=s[1]/u,k=o[1]/y,E=s[2]/u,P=o[2]/y,O=E===P?0:(0-E)/(P-E);return new a.MercatorCoordinate(a.number(s[0]/u,o[0]/y,O)/this.worldSize,a.number(w,k,O)/this.worldSize)},dr.prototype.coordinatePoint=function(n){var s=[n.x*this.worldSize,n.y*this.worldSize,0,1];return a.transformMat4(s,s,this.pixelMatrix),new a.Point(s[0]/s[3],s[1]/s[3])},dr.prototype.getBounds=function(){return new a.LngLatBounds().extend(this.pointLocation(new a.Point(0,0))).extend(this.pointLocation(new a.Point(this.width,0))).extend(this.pointLocation(new a.Point(this.width,this.height))).extend(this.pointLocation(new a.Point(0,this.height)))},dr.prototype.getMaxBounds=function(){return this.latRange&&this.latRange.length===2&&this.lngRange&&this.lngRange.length===2?new a.LngLatBounds([this.lngRange[0],this.latRange[0]],[this.lngRange[1],this.latRange[1]]):null},dr.prototype.setMaxBounds=function(n){n?(this.lngRange=[n.getWest(),n.getEast()],this.latRange=[n.getSouth(),n.getNorth()],this._constrain()):(this.lngRange=null,this.latRange=[-this.maxValidLatitude,this.maxValidLatitude])},dr.prototype.calculatePosMatrix=function(n,s){s===void 0&&(s=!1);var o=n.key,u=s?this._alignedPosMatrixCache:this._posMatrixCache;if(u[o])return u[o];var y=n.canonical,w=this.worldSize/this.zoomScale(y.z),k=y.x+Math.pow(2,y.z)*n.wrap,E=a.identity(new Float64Array(16));return a.translate(E,E,[k*w,y.y*w,0]),a.scale(E,E,[w/a.EXTENT,w/a.EXTENT,1]),a.multiply(E,s?this.alignedProjMatrix:this.projMatrix,E),u[o]=new Float32Array(E),u[o]},dr.prototype.customLayerMatrix=function(){return this.mercatorMatrix.slice()},dr.prototype._constrain=function(){if(this.center&&this.width&&this.height&&!this._constraining){this._constraining=!0;var n,s,o,u,y=-90,w=90,k=-180,E=180,P=this.size,O=this._unmodified;if(this.latRange){var Z=this.latRange;y=a.mercatorYfromLat(Z[1])*this.worldSize,n=(w=a.mercatorYfromLat(Z[0])*this.worldSize)-y<P.y?P.y/(w-y):0}if(this.lngRange){var G=this.lngRange;k=a.mercatorXfromLng(G[0])*this.worldSize,s=(E=a.mercatorXfromLng(G[1])*this.worldSize)-k<P.x?P.x/(E-k):0}var X=this.point,re=Math.max(s||0,n||0);if(re)return this.center=this.unproject(new a.Point(s?(E+k)/2:X.x,n?(w+y)/2:X.y)),this.zoom+=this.scaleZoom(re),this._unmodified=O,void(this._constraining=!1);if(this.latRange){var te=X.y,ue=P.y/2;te-ue<y&&(u=y+ue),te+ue>w&&(u=w-ue)}if(this.lngRange){var Y=X.x,le=P.x/2;Y-le<k&&(o=k+le),Y+le>E&&(o=E-le)}o===void 0&&u===void 0||(this.center=this.unproject(new a.Point(o!==void 0?o:X.x,u!==void 0?u:X.y))),this._unmodified=O,this._constraining=!1}},dr.prototype._calcMatrices=function(){if(this.height){var n=this.centerOffset;this.cameraToCenterDistance=.5/Math.tan(this._fov/2)*this.height;var s=Math.PI/2+this._pitch,o=this._fov*(.5+n.y/this.height),u=Math.sin(o)*this.cameraToCenterDistance/Math.sin(a.clamp(Math.PI-s-o,.01,Math.PI-.01)),y=this.point,w=y.x,k=y.y,E=1.01*(Math.cos(Math.PI/2-this._pitch)*u+this.cameraToCenterDistance),P=this.height/50,O=new Float64Array(16);a.perspective(O,this._fov,this.width/this.height,P,E),O[8]=2*-n.x/this.width,O[9]=2*n.y/this.height,a.scale(O,O,[1,-1,1]),a.translate(O,O,[0,0,-this.cameraToCenterDistance]),a.rotateX(O,O,this._pitch),a.rotateZ(O,O,this.angle),a.translate(O,O,[-w,-k,0]),this.mercatorMatrix=a.scale([],O,[this.worldSize,this.worldSize,this.worldSize]),a.scale(O,O,[1,1,a.mercatorZfromAltitude(1,this.center.lat)*this.worldSize,1]),this.projMatrix=O,this.invProjMatrix=a.invert([],this.projMatrix);var Z=this.width%2/2,G=this.height%2/2,X=Math.cos(this.angle),re=Math.sin(this.angle),te=w-Math.round(w)+X*Z+re*G,ue=k-Math.round(k)+X*G+re*Z,Y=new Float64Array(O);if(a.translate(Y,Y,[te>.5?te-1:te,ue>.5?ue-1:ue,0]),this.alignedProjMatrix=Y,O=a.create(),a.scale(O,O,[this.width/2,-this.height/2,1]),a.translate(O,O,[1,-1,0]),this.labelPlaneMatrix=O,O=a.create(),a.scale(O,O,[1,-1,1]),a.translate(O,O,[-1,-1,0]),a.scale(O,O,[2/this.width,2/this.height,1]),this.glCoordMatrix=O,this.pixelMatrix=a.multiply(new Float64Array(16),this.labelPlaneMatrix,this.projMatrix),!(O=a.invert(new Float64Array(16),this.pixelMatrix)))throw new Error("failed to invert matrix");this.pixelMatrixInverse=O,this._posMatrixCache={},this._alignedPosMatrixCache={}}},dr.prototype.maxPitchScaleFactor=function(){if(!this.pixelMatrixInverse)return 1;var n=this.pointCoordinate(new a.Point(0,0)),s=[n.x*this.worldSize,n.y*this.worldSize,0,1];return a.transformMat4(s,s,this.pixelMatrix)[3]/this.cameraToCenterDistance},dr.prototype.getCameraPoint=function(){var n=Math.tan(this._pitch)*(this.cameraToCenterDistance||1);return this.centerPoint.add(new a.Point(0,n))},dr.prototype.getCameraQueryGeometry=function(n){var s=this.getCameraPoint();if(n.length===1)return[n[0],s];for(var o=s.x,u=s.y,y=s.x,w=s.y,k=0,E=n;k<E.length;k+=1){var P=E[k];o=Math.min(o,P.x),u=Math.min(u,P.y),y=Math.max(y,P.x),w=Math.max(w,P.y)}return[new a.Point(o,u),new a.Point(y,u),new a.Point(y,w),new a.Point(o,w),new a.Point(o,u)]},Object.defineProperties(dr.prototype,jr);var Yn=function(n){var s,o,u,y;this._hashName=n&&encodeURIComponent(n),a.bindAll(["_getCurrentHash","_onHashChange","_updateHash"],this),this._updateHash=(s=this._updateHashUnthrottled.bind(this),o=!1,u=null,y=function(){u=null,o&&(s(),u=setTimeout(y,300),o=!1)},function(){return o=!0,u||y(),u})};Yn.prototype.addTo=function(n){return this._map=n,a.window.addEventListener("hashchange",this._onHashChange,!1),this._map.on("moveend",this._updateHash),this},Yn.prototype.remove=function(){return a.window.removeEventListener("hashchange",this._onHashChange,!1),this._map.off("moveend",this._updateHash),clearTimeout(this._updateHash()),delete this._map,this},Yn.prototype.getHashString=function(n){var s=this._map.getCenter(),o=Math.round(100*this._map.getZoom())/100,u=Math.ceil((o*Math.LN2+Math.log(512/360/.5))/Math.LN10),y=Math.pow(10,u),w=Math.round(s.lng*y)/y,k=Math.round(s.lat*y)/y,E=this._map.getBearing(),P=this._map.getPitch(),O="";if(O+=n?"/"+w+"/"+k+"/"+o:o+"/"+k+"/"+w,(E||P)&&(O+="/"+Math.round(10*E)/10),P&&(O+="/"+Math.round(P)),this._hashName){var Z=this._hashName,G=!1,X=a.window.location.hash.slice(1).split("&").map(function(re){var te=re.split("=")[0];return te===Z?(G=!0,te+"="+O):re}).filter(function(re){return re});return G||X.push(Z+"="+O),"#"+X.join("&")}return"#"+O},Yn.prototype._getCurrentHash=function(){var n,s=this,o=a.window.location.hash.replace("#","");return this._hashName?(o.split("&").map(function(u){return u.split("=")}).forEach(function(u){u[0]===s._hashName&&(n=u)}),(n&&n[1]||"").split("/")):o.split("/")},Yn.prototype._onHashChange=function(){var n=this._getCurrentHash();if(n.length>=3&&!n.some(function(o){return isNaN(o)})){var s=this._map.dragRotate.isEnabled()&&this._map.touchZoomRotate.isEnabled()?+(n[3]||0):this._map.getBearing();return this._map.jumpTo({center:[+n[2],+n[1]],zoom:+n[0],bearing:s,pitch:+(n[4]||0)}),!0}return!1},Yn.prototype._updateHashUnthrottled=function(){var n=a.window.location.href.replace(/(#.+)?$/,this.getHashString());try{a.window.history.replaceState(a.window.history.state,null,n)}catch{}};var ys={linearity:.3,easing:a.bezier(0,0,.3,1)},Go=a.extend({deceleration:2500,maxSpeed:1400},ys),_s=a.extend({deceleration:20,maxSpeed:1400},ys),Xh=a.extend({deceleration:1e3,maxSpeed:360},ys),Wh=a.extend({deceleration:1e3,maxSpeed:90},ys),gs=function(n){this._map=n,this.clear()};function vs(n,s){(!n.duration||n.duration<s.duration)&&(n.duration=s.duration,n.easing=s.easing)}function Da(n,s,o){var u=o.maxSpeed,y=o.linearity,w=o.deceleration,k=a.clamp(n*y/(s/1e3),-u,u),E=Math.abs(k)/(w*y);return{easing:o.easing,duration:1e3*E,amount:k*(E/2)}}gs.prototype.clear=function(){this._inertiaBuffer=[]},gs.prototype.record=function(n){this._drainInertiaBuffer(),this._inertiaBuffer.push({time:a.browser.now(),settings:n})},gs.prototype._drainInertiaBuffer=function(){for(var n=this._inertiaBuffer,s=a.browser.now();n.length>0&&s-n[0].time>160;)n.shift()},gs.prototype._onMoveEnd=function(n){if(this._drainInertiaBuffer(),!(this._inertiaBuffer.length<2)){for(var s={zoom:0,bearing:0,pitch:0,pan:new a.Point(0,0),pinchAround:void 0,around:void 0},o=0,u=this._inertiaBuffer;o<u.length;o+=1){var y=u[o].settings;s.zoom+=y.zoomDelta||0,s.bearing+=y.bearingDelta||0,s.pitch+=y.pitchDelta||0,y.panDelta&&s.pan._add(y.panDelta),y.around&&(s.around=y.around),y.pinchAround&&(s.pinchAround=y.pinchAround)}var w=this._inertiaBuffer[this._inertiaBuffer.length-1].time-this._inertiaBuffer[0].time,k={};if(s.pan.mag()){var E=Da(s.pan.mag(),w,a.extend({},Go,n||{}));k.offset=s.pan.mult(E.amount/s.pan.mag()),k.center=this._map.transform.center,vs(k,E)}if(s.zoom){var P=Da(s.zoom,w,_s);k.zoom=this._map.transform.zoom+P.amount,vs(k,P)}if(s.bearing){var O=Da(s.bearing,w,Xh);k.bearing=this._map.transform.bearing+a.clamp(O.amount,-179,179),vs(k,O)}if(s.pitch){var Z=Da(s.pitch,w,Wh);k.pitch=this._map.transform.pitch+Z.amount,vs(k,Z)}if(k.zoom||k.bearing){var G=s.pinchAround===void 0?s.around:s.pinchAround;k.around=G?this._map.unproject(G):this._map.getCenter()}return this.clear(),a.extend(k,{noMoveStart:!0})}};var Ii=function(n){function s(u,y,w,k){k===void 0&&(k={});var E=T.mousePos(y.getCanvasContainer(),w),P=y.unproject(E);n.call(this,u,a.extend({point:E,lngLat:P,originalEvent:w},k)),this._defaultPrevented=!1,this.target=y}n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s;var o={defaultPrevented:{configurable:!0}};return s.prototype.preventDefault=function(){this._defaultPrevented=!0},o.defaultPrevented.get=function(){return this._defaultPrevented},Object.defineProperties(s.prototype,o),s}(a.Event),bs=function(n){function s(u,y,w){var k=u==="touchend"?w.changedTouches:w.touches,E=T.touchPos(y.getCanvasContainer(),k),P=E.map(function(G){return y.unproject(G)}),O=E.reduce(function(G,X,re,te){return G.add(X.div(te.length))},new a.Point(0,0)),Z=y.unproject(O);n.call(this,u,{points:E,point:O,lngLats:P,lngLat:Z,originalEvent:w}),this._defaultPrevented=!1}n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s;var o={defaultPrevented:{configurable:!0}};return s.prototype.preventDefault=function(){this._defaultPrevented=!0},o.defaultPrevented.get=function(){return this._defaultPrevented},Object.defineProperties(s.prototype,o),s}(a.Event),Tc=function(n){function s(u,y,w){n.call(this,u,{originalEvent:w}),this._defaultPrevented=!1}n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s;var o={defaultPrevented:{configurable:!0}};return s.prototype.preventDefault=function(){this._defaultPrevented=!0},o.defaultPrevented.get=function(){return this._defaultPrevented},Object.defineProperties(s.prototype,o),s}(a.Event),wi=function(n,s){this._map=n,this._clickTolerance=s.clickTolerance};wi.prototype.reset=function(){delete this._mousedownPos},wi.prototype.wheel=function(n){return this._firePreventable(new Tc(n.type,this._map,n))},wi.prototype.mousedown=function(n,s){return this._mousedownPos=s,this._firePreventable(new Ii(n.type,this._map,n))},wi.prototype.mouseup=function(n){this._map.fire(new Ii(n.type,this._map,n))},wi.prototype.click=function(n,s){this._mousedownPos&&this._mousedownPos.dist(s)>=this._clickTolerance||this._map.fire(new Ii(n.type,this._map,n))},wi.prototype.dblclick=function(n){return this._firePreventable(new Ii(n.type,this._map,n))},wi.prototype.mouseover=function(n){this._map.fire(new Ii(n.type,this._map,n))},wi.prototype.mouseout=function(n){this._map.fire(new Ii(n.type,this._map,n))},wi.prototype.touchstart=function(n){return this._firePreventable(new bs(n.type,this._map,n))},wi.prototype.touchmove=function(n){this._map.fire(new bs(n.type,this._map,n))},wi.prototype.touchend=function(n){this._map.fire(new bs(n.type,this._map,n))},wi.prototype.touchcancel=function(n){this._map.fire(new bs(n.type,this._map,n))},wi.prototype._firePreventable=function(n){if(this._map.fire(n),n.defaultPrevented)return{}},wi.prototype.isEnabled=function(){return!0},wi.prototype.isActive=function(){return!1},wi.prototype.enable=function(){},wi.prototype.disable=function(){};var st=function(n){this._map=n};st.prototype.reset=function(){this._delayContextMenu=!1,delete this._contextMenuEvent},st.prototype.mousemove=function(n){this._map.fire(new Ii(n.type,this._map,n))},st.prototype.mousedown=function(){this._delayContextMenu=!0},st.prototype.mouseup=function(){this._delayContextMenu=!1,this._contextMenuEvent&&(this._map.fire(new Ii("contextmenu",this._map,this._contextMenuEvent)),delete this._contextMenuEvent)},st.prototype.contextmenu=function(n){this._delayContextMenu?this._contextMenuEvent=n:this._map.fire(new Ii(n.type,this._map,n)),this._map.listens("contextmenu")&&n.preventDefault()},st.prototype.isEnabled=function(){return!0},st.prototype.isActive=function(){return!1},st.prototype.enable=function(){},st.prototype.disable=function(){};var Un=function(n,s){this._map=n,this._el=n.getCanvasContainer(),this._container=n.getContainer(),this._clickTolerance=s.clickTolerance||1};function Js(n,s){for(var o={},u=0;u<n.length;u++)o[n[u].identifier]=s[u];return o}Un.prototype.isEnabled=function(){return!!this._enabled},Un.prototype.isActive=function(){return!!this._active},Un.prototype.enable=function(){this.isEnabled()||(this._enabled=!0)},Un.prototype.disable=function(){this.isEnabled()&&(this._enabled=!1)},Un.prototype.mousedown=function(n,s){this.isEnabled()&&n.shiftKey&&n.button===0&&(T.disableDrag(),this._startPos=this._lastPos=s,this._active=!0)},Un.prototype.mousemoveWindow=function(n,s){if(this._active){var o=s;if(!(this._lastPos.equals(o)||!this._box&&o.dist(this._startPos)<this._clickTolerance)){var u=this._startPos;this._lastPos=o,this._box||(this._box=T.create("div","mapboxgl-boxzoom",this._container),this._container.classList.add("mapboxgl-crosshair"),this._fireEvent("boxzoomstart",n));var y=Math.min(u.x,o.x),w=Math.max(u.x,o.x),k=Math.min(u.y,o.y),E=Math.max(u.y,o.y);T.setTransform(this._box,"translate("+y+"px,"+k+"px)"),this._box.style.width=w-y+"px",this._box.style.height=E-k+"px"}}},Un.prototype.mouseupWindow=function(n,s){var o=this;if(this._active&&n.button===0){var u=this._startPos,y=s;if(this.reset(),T.suppressClick(),u.x!==y.x||u.y!==y.y)return this._map.fire(new a.Event("boxzoomend",{originalEvent:n})),{cameraAnimation:function(w){return w.fitScreenCoordinates(u,y,o._map.getBearing(),{linear:!0})}};this._fireEvent("boxzoomcancel",n)}},Un.prototype.keydown=function(n){this._active&&n.keyCode===27&&(this.reset(),this._fireEvent("boxzoomcancel",n))},Un.prototype.blur=function(){this.reset()},Un.prototype.reset=function(){this._active=!1,this._container.classList.remove("mapboxgl-crosshair"),this._box&&(T.remove(this._box),this._box=null),T.enableDrag(),delete this._startPos,delete this._lastPos},Un.prototype._fireEvent=function(n,s){return this._map.fire(new a.Event(n,{originalEvent:s}))};var Ko=function(n){this.reset(),this.numTouches=n.numTouches};Ko.prototype.reset=function(){delete this.centroid,delete this.startTime,delete this.touches,this.aborted=!1},Ko.prototype.touchstart=function(n,s,o){(this.centroid||o.length>this.numTouches)&&(this.aborted=!0),this.aborted||(this.startTime===void 0&&(this.startTime=n.timeStamp),o.length===this.numTouches&&(this.centroid=function(u){for(var y=new a.Point(0,0),w=0,k=u;w<k.length;w+=1)y._add(k[w]);return y.div(u.length)}(s),this.touches=Js(o,s)))},Ko.prototype.touchmove=function(n,s,o){if(!this.aborted&&this.centroid){var u=Js(o,s);for(var y in this.touches){var w=u[y];(!w||w.dist(this.touches[y])>30)&&(this.aborted=!0)}}},Ko.prototype.touchend=function(n,s,o){if((!this.centroid||n.timeStamp-this.startTime>500)&&(this.aborted=!0),o.length===0){var u=!this.aborted&&this.centroid;if(this.reset(),u)return u}};var fa=function(n){this.singleTap=new Ko(n),this.numTaps=n.numTaps,this.reset()};fa.prototype.reset=function(){this.lastTime=1/0,delete this.lastTap,this.count=0,this.singleTap.reset()},fa.prototype.touchstart=function(n,s,o){this.singleTap.touchstart(n,s,o)},fa.prototype.touchmove=function(n,s,o){this.singleTap.touchmove(n,s,o)},fa.prototype.touchend=function(n,s,o){var u=this.singleTap.touchend(n,s,o);if(u){var y=n.timeStamp-this.lastTime<500,w=!this.lastTap||this.lastTap.dist(u)<30;if(y&&w||this.reset(),this.count++,this.lastTime=n.timeStamp,this.lastTap=u,this.count===this.numTaps)return this.reset(),u}};var Vn=function(){this._zoomIn=new fa({numTouches:1,numTaps:2}),this._zoomOut=new fa({numTouches:2,numTaps:1}),this.reset()};Vn.prototype.reset=function(){this._active=!1,this._zoomIn.reset(),this._zoomOut.reset()},Vn.prototype.touchstart=function(n,s,o){this._zoomIn.touchstart(n,s,o),this._zoomOut.touchstart(n,s,o)},Vn.prototype.touchmove=function(n,s,o){this._zoomIn.touchmove(n,s,o),this._zoomOut.touchmove(n,s,o)},Vn.prototype.touchend=function(n,s,o){var u=this,y=this._zoomIn.touchend(n,s,o),w=this._zoomOut.touchend(n,s,o);return y?(this._active=!0,n.preventDefault(),setTimeout(function(){return u.reset()},0),{cameraAnimation:function(k){return k.easeTo({duration:300,zoom:k.getZoom()+1,around:k.unproject(y)},{originalEvent:n})}}):w?(this._active=!0,n.preventDefault(),setTimeout(function(){return u.reset()},0),{cameraAnimation:function(k){return k.easeTo({duration:300,zoom:k.getZoom()-1,around:k.unproject(w)},{originalEvent:n})}}):void 0},Vn.prototype.touchcancel=function(){this.reset()},Vn.prototype.enable=function(){this._enabled=!0},Vn.prototype.disable=function(){this._enabled=!1,this.reset()},Vn.prototype.isEnabled=function(){return this._enabled},Vn.prototype.isActive=function(){return this._active};var Yl={0:1,2:2},$e=function(n){this.reset(),this._clickTolerance=n.clickTolerance||1};$e.prototype.blur=function(){this.reset()},$e.prototype.reset=function(){this._active=!1,this._moved=!1,delete this._lastPoint,delete this._eventButton},$e.prototype._correctButton=function(n,s){return!1},$e.prototype._move=function(n,s){return{}},$e.prototype.mousedown=function(n,s){if(!this._lastPoint){var o=T.mouseButton(n);this._correctButton(n,o)&&(this._lastPoint=s,this._eventButton=o)}},$e.prototype.mousemoveWindow=function(n,s){var o=this._lastPoint;if(o){if(n.preventDefault(),function(u,y){var w=Yl[y];return u.buttons===void 0||(u.buttons&w)!==w}(n,this._eventButton))this.reset();else if(this._moved||!(s.dist(o)<this._clickTolerance))return this._moved=!0,this._lastPoint=s,this._move(o,s)}},$e.prototype.mouseupWindow=function(n){this._lastPoint&&T.mouseButton(n)===this._eventButton&&(this._moved&&T.suppressClick(),this.reset())},$e.prototype.enable=function(){this._enabled=!0},$e.prototype.disable=function(){this._enabled=!1,this.reset()},$e.prototype.isEnabled=function(){return this._enabled},$e.prototype.isActive=function(){return this._active};var Ql=function(n){function s(){n.apply(this,arguments)}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype.mousedown=function(o,u){n.prototype.mousedown.call(this,o,u),this._lastPoint&&(this._active=!0)},s.prototype._correctButton=function(o,u){return u===0&&!o.ctrlKey},s.prototype._move=function(o,u){return{around:u,panDelta:u.sub(o)}},s}($e),Ys=function(n){function s(){n.apply(this,arguments)}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype._correctButton=function(o,u){return u===0&&o.ctrlKey||u===2},s.prototype._move=function(o,u){var y=.8*(u.x-o.x);if(y)return this._active=!0,{bearingDelta:y}},s.prototype.contextmenu=function(o){o.preventDefault()},s}($e),$l=function(n){function s(){n.apply(this,arguments)}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype._correctButton=function(o,u){return u===0&&o.ctrlKey||u===2},s.prototype._move=function(o,u){var y=-.5*(u.y-o.y);if(y)return this._active=!0,{pitchDelta:y}},s.prototype.contextmenu=function(o){o.preventDefault()},s}($e),ia=function(n){this._minTouches=1,this._clickTolerance=n.clickTolerance||1,this.reset()};ia.prototype.reset=function(){this._active=!1,this._touches={},this._sum=new a.Point(0,0)},ia.prototype.touchstart=function(n,s,o){return this._calculateTransform(n,s,o)},ia.prototype.touchmove=function(n,s,o){if(this._active&&!(o.length<this._minTouches))return n.preventDefault(),this._calculateTransform(n,s,o)},ia.prototype.touchend=function(n,s,o){this._calculateTransform(n,s,o),this._active&&o.length<this._minTouches&&this.reset()},ia.prototype.touchcancel=function(){this.reset()},ia.prototype._calculateTransform=function(n,s,o){o.length>0&&(this._active=!0);var u=Js(o,s),y=new a.Point(0,0),w=new a.Point(0,0),k=0;for(var E in u){var P=u[E],O=this._touches[E];O&&(y._add(P),w._add(P.sub(O)),k++,u[E]=P)}if(this._touches=u,!(k<this._minTouches)&&w.mag()){var Z=w.div(k);if(this._sum._add(Z),!(this._sum.mag()<this._clickTolerance))return{around:y.div(k),panDelta:Z}}},ia.prototype.enable=function(){this._enabled=!0},ia.prototype.disable=function(){this._enabled=!1,this.reset()},ia.prototype.isEnabled=function(){return this._enabled},ia.prototype.isActive=function(){return this._active};var jn=function(){this.reset()};function Qs(n,s,o){for(var u=0;u<n.length;u++)if(n[u].identifier===o)return s[u]}function $s(n,s){return Math.log(n/s)/Math.LN2}jn.prototype.reset=function(){this._active=!1,delete this._firstTwoTouches},jn.prototype._start=function(n){},jn.prototype._move=function(n,s,o){return{}},jn.prototype.touchstart=function(n,s,o){this._firstTwoTouches||o.length<2||(this._firstTwoTouches=[o[0].identifier,o[1].identifier],this._start([s[0],s[1]]))},jn.prototype.touchmove=function(n,s,o){if(this._firstTwoTouches){n.preventDefault();var u=this._firstTwoTouches,y=u[1],w=Qs(o,s,u[0]),k=Qs(o,s,y);if(w&&k){var E=this._aroundCenter?null:w.add(k).div(2);return this._move([w,k],E,n)}}},jn.prototype.touchend=function(n,s,o){if(this._firstTwoTouches){var u=this._firstTwoTouches,y=u[1],w=Qs(o,s,u[0]),k=Qs(o,s,y);w&&k||(this._active&&T.suppressClick(),this.reset())}},jn.prototype.touchcancel=function(){this.reset()},jn.prototype.enable=function(n){this._enabled=!0,this._aroundCenter=!!n&&n.around==="center"},jn.prototype.disable=function(){this._enabled=!1,this.reset()},jn.prototype.isEnabled=function(){return this._enabled},jn.prototype.isActive=function(){return this._active};var qn=function(n){function s(){n.apply(this,arguments)}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype.reset=function(){n.prototype.reset.call(this),delete this._distance,delete this._startDistance},s.prototype._start=function(o){this._startDistance=this._distance=o[0].dist(o[1])},s.prototype._move=function(o,u){var y=this._distance;if(this._distance=o[0].dist(o[1]),this._active||!(Math.abs($s(this._distance,this._startDistance))<.1))return this._active=!0,{zoomDelta:$s(this._distance,y),pinchAround:u}},s}(jn);function La(n,s){return 180*n.angleWith(s)/Math.PI}var Ic=function(n){function s(){n.apply(this,arguments)}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype.reset=function(){n.prototype.reset.call(this),delete this._minDiameter,delete this._startVector,delete this._vector},s.prototype._start=function(o){this._startVector=this._vector=o[0].sub(o[1]),this._minDiameter=o[0].dist(o[1])},s.prototype._move=function(o,u){var y=this._vector;if(this._vector=o[0].sub(o[1]),this._active||!this._isBelowThreshold(this._vector))return this._active=!0,{bearingDelta:La(this._vector,y),pinchAround:u}},s.prototype._isBelowThreshold=function(o){this._minDiameter=Math.min(this._minDiameter,o.mag());var u=25/(Math.PI*this._minDiameter)*360,y=La(o,this._startVector);return Math.abs(y)<u},s}(jn);function xs(n){return Math.abs(n.y)>Math.abs(n.x)}var eu=function(n){function s(){n.apply(this,arguments)}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype.reset=function(){n.prototype.reset.call(this),this._valid=void 0,delete this._firstMove,delete this._lastPoints},s.prototype._start=function(o){this._lastPoints=o,xs(o[0].sub(o[1]))&&(this._valid=!1)},s.prototype._move=function(o,u,y){var w=o[0].sub(this._lastPoints[0]),k=o[1].sub(this._lastPoints[1]);if(this._valid=this.gestureBeginsVertically(w,k,y.timeStamp),this._valid)return this._lastPoints=o,this._active=!0,{pitchDelta:(w.y+k.y)/2*-.5}},s.prototype.gestureBeginsVertically=function(o,u,y){if(this._valid!==void 0)return this._valid;var w=o.mag()>=2,k=u.mag()>=2;if(w||k){if(!w||!k)return this._firstMove===void 0&&(this._firstMove=y),y-this._firstMove<100&&void 0;var E=o.y>0==u.y>0;return xs(o)&&xs(u)&&E}},s}(jn),tu={panStep:100,bearingStep:15,pitchStep:10},da=function(){var n=tu;this._panStep=n.panStep,this._bearingStep=n.bearingStep,this._pitchStep=n.pitchStep,this._rotationDisabled=!1};function Qn(n){return n*(2-n)}da.prototype.blur=function(){this.reset()},da.prototype.reset=function(){this._active=!1},da.prototype.keydown=function(n){var s=this;if(!(n.altKey||n.ctrlKey||n.metaKey)){var o=0,u=0,y=0,w=0,k=0;switch(n.keyCode){case 61:case 107:case 171:case 187:o=1;break;case 189:case 109:case 173:o=-1;break;case 37:n.shiftKey?u=-1:(n.preventDefault(),w=-1);break;case 39:n.shiftKey?u=1:(n.preventDefault(),w=1);break;case 38:n.shiftKey?y=1:(n.preventDefault(),k=-1);break;case 40:n.shiftKey?y=-1:(n.preventDefault(),k=1);break;default:return}return this._rotationDisabled&&(u=0,y=0),{cameraAnimation:function(E){var P=E.getZoom();E.easeTo({duration:300,easeId:"keyboardHandler",easing:Qn,zoom:o?Math.round(P)+o*(n.shiftKey?2:1):P,bearing:E.getBearing()+u*s._bearingStep,pitch:E.getPitch()+y*s._pitchStep,offset:[-w*s._panStep,-k*s._panStep],center:E.getCenter()},{originalEvent:n})}}}},da.prototype.enable=function(){this._enabled=!0},da.prototype.disable=function(){this._enabled=!1,this.reset()},da.prototype.isEnabled=function(){return this._enabled},da.prototype.isActive=function(){return this._active},da.prototype.disableRotation=function(){this._rotationDisabled=!0},da.prototype.enableRotation=function(){this._rotationDisabled=!1};var ur=function(n,s){this._map=n,this._el=n.getCanvasContainer(),this._handler=s,this._delta=0,this._defaultZoomRate=.01,this._wheelZoomRate=1/450,a.bindAll(["_onTimeout"],this)};ur.prototype.setZoomRate=function(n){this._defaultZoomRate=n},ur.prototype.setWheelZoomRate=function(n){this._wheelZoomRate=n},ur.prototype.isEnabled=function(){return!!this._enabled},ur.prototype.isActive=function(){return!!this._active||this._finishTimeout!==void 0},ur.prototype.isZooming=function(){return!!this._zooming},ur.prototype.enable=function(n){this.isEnabled()||(this._enabled=!0,this._aroundCenter=n&&n.around==="center")},ur.prototype.disable=function(){this.isEnabled()&&(this._enabled=!1)},ur.prototype.wheel=function(n){if(this.isEnabled()){var s=n.deltaMode===a.window.WheelEvent.DOM_DELTA_LINE?40*n.deltaY:n.deltaY,o=a.browser.now(),u=o-(this._lastWheelEventTime||0);this._lastWheelEventTime=o,s!==0&&s%4.000244140625==0?this._type="wheel":s!==0&&Math.abs(s)<4?this._type="trackpad":u>400?(this._type=null,this._lastValue=s,this._timeout=setTimeout(this._onTimeout,40,n)):this._type||(this._type=Math.abs(u*s)<200?"trackpad":"wheel",this._timeout&&(clearTimeout(this._timeout),this._timeout=null,s+=this._lastValue)),n.shiftKey&&s&&(s/=4),this._type&&(this._lastWheelEvent=n,this._delta-=s,this._active||this._start(n)),n.preventDefault()}},ur.prototype._onTimeout=function(n){this._type="wheel",this._delta-=this._lastValue,this._active||this._start(n)},ur.prototype._start=function(n){if(this._delta){this._frameId&&(this._frameId=null),this._active=!0,this.isZooming()||(this._zooming=!0),this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout);var s=T.mousePos(this._el,n);this._around=a.LngLat.convert(this._aroundCenter?this._map.getCenter():this._map.unproject(s)),this._aroundPoint=this._map.transform.locationPoint(this._around),this._frameId||(this._frameId=!0,this._handler._triggerRenderFrame())}},ur.prototype.renderFrame=function(){var n=this;if(this._frameId&&(this._frameId=null,this.isActive())){var s=this._map.transform;if(this._delta!==0){var o=this._type==="wheel"&&Math.abs(this._delta)>4.000244140625?this._wheelZoomRate:this._defaultZoomRate,u=2/(1+Math.exp(-Math.abs(this._delta*o)));this._delta<0&&u!==0&&(u=1/u);var y=typeof this._targetZoom=="number"?s.zoomScale(this._targetZoom):s.scale;this._targetZoom=Math.min(s.maxZoom,Math.max(s.minZoom,s.scaleZoom(y*u))),this._type==="wheel"&&(this._startZoom=s.zoom,this._easing=this._smoothOutEasing(200)),this._delta=0}var w,k=typeof this._targetZoom=="number"?this._targetZoom:s.zoom,E=this._startZoom,P=this._easing,O=!1;if(this._type==="wheel"&&E&&P){var Z=Math.min((a.browser.now()-this._lastWheelEventTime)/200,1),G=P(Z);w=a.number(E,k,G),Z<1?this._frameId||(this._frameId=!0):O=!0}else w=k,O=!0;return this._active=!0,O&&(this._active=!1,this._finishTimeout=setTimeout(function(){n._zooming=!1,n._handler._triggerRenderFrame(),delete n._targetZoom,delete n._finishTimeout},200)),{noInertia:!0,needsRenderFrame:!O,zoomDelta:w-s.zoom,around:this._aroundPoint,originalEvent:this._lastWheelEvent}}},ur.prototype._smoothOutEasing=function(n){var s=a.ease;if(this._prevEase){var o=this._prevEase,u=(a.browser.now()-o.start)/o.duration,y=o.easing(u+.01)-o.easing(u),w=.27/Math.sqrt(y*y+1e-4)*.01,k=Math.sqrt(.0729-w*w);s=a.bezier(w,k,.25,1)}return this._prevEase={start:a.browser.now(),duration:n,easing:s},s},ur.prototype.blur=function(){this.reset()},ur.prototype.reset=function(){this._active=!1};var Sa=function(n,s){this._clickZoom=n,this._tapZoom=s};Sa.prototype.enable=function(){this._clickZoom.enable(),this._tapZoom.enable()},Sa.prototype.disable=function(){this._clickZoom.disable(),this._tapZoom.disable()},Sa.prototype.isEnabled=function(){return this._clickZoom.isEnabled()&&this._tapZoom.isEnabled()},Sa.prototype.isActive=function(){return this._clickZoom.isActive()||this._tapZoom.isActive()};var na=function(){this.reset()};na.prototype.reset=function(){this._active=!1},na.prototype.blur=function(){this.reset()},na.prototype.dblclick=function(n,s){return n.preventDefault(),{cameraAnimation:function(o){o.easeTo({duration:300,zoom:o.getZoom()+(n.shiftKey?-1:1),around:o.unproject(s)},{originalEvent:n})}}},na.prototype.enable=function(){this._enabled=!0},na.prototype.disable=function(){this._enabled=!1,this.reset()},na.prototype.isEnabled=function(){return this._enabled},na.prototype.isActive=function(){return this._active};var nn=function(){this._tap=new fa({numTouches:1,numTaps:1}),this.reset()};nn.prototype.reset=function(){this._active=!1,delete this._swipePoint,delete this._swipeTouch,delete this._tapTime,this._tap.reset()},nn.prototype.touchstart=function(n,s,o){this._swipePoint||(this._tapTime&&n.timeStamp-this._tapTime>500&&this.reset(),this._tapTime?o.length>0&&(this._swipePoint=s[0],this._swipeTouch=o[0].identifier):this._tap.touchstart(n,s,o))},nn.prototype.touchmove=function(n,s,o){if(this._tapTime){if(this._swipePoint){if(o[0].identifier!==this._swipeTouch)return;var u=s[0],y=u.y-this._swipePoint.y;return this._swipePoint=u,n.preventDefault(),this._active=!0,{zoomDelta:y/128}}}else this._tap.touchmove(n,s,o)},nn.prototype.touchend=function(n,s,o){this._tapTime?this._swipePoint&&o.length===0&&this.reset():this._tap.touchend(n,s,o)&&(this._tapTime=n.timeStamp)},nn.prototype.touchcancel=function(){this.reset()},nn.prototype.enable=function(){this._enabled=!0},nn.prototype.disable=function(){this._enabled=!1,this.reset()},nn.prototype.isEnabled=function(){return this._enabled},nn.prototype.isActive=function(){return this._active};var Io=function(n,s,o){this._el=n,this._mousePan=s,this._touchPan=o};Io.prototype.enable=function(n){this._inertiaOptions=n||{},this._mousePan.enable(),this._touchPan.enable(),this._el.classList.add("mapboxgl-touch-drag-pan")},Io.prototype.disable=function(){this._mousePan.disable(),this._touchPan.disable(),this._el.classList.remove("mapboxgl-touch-drag-pan")},Io.prototype.isEnabled=function(){return this._mousePan.isEnabled()&&this._touchPan.isEnabled()},Io.prototype.isActive=function(){return this._mousePan.isActive()||this._touchPan.isActive()};var Ya=function(n,s,o){this._pitchWithRotate=n.pitchWithRotate,this._mouseRotate=s,this._mousePitch=o};Ya.prototype.enable=function(){this._mouseRotate.enable(),this._pitchWithRotate&&this._mousePitch.enable()},Ya.prototype.disable=function(){this._mouseRotate.disable(),this._mousePitch.disable()},Ya.prototype.isEnabled=function(){return this._mouseRotate.isEnabled()&&(!this._pitchWithRotate||this._mousePitch.isEnabled())},Ya.prototype.isActive=function(){return this._mouseRotate.isActive()||this._mousePitch.isActive()};var ma=function(n,s,o,u){this._el=n,this._touchZoom=s,this._touchRotate=o,this._tapDragZoom=u,this._rotationDisabled=!1,this._enabled=!0};ma.prototype.enable=function(n){this._touchZoom.enable(n),this._rotationDisabled||this._touchRotate.enable(n),this._tapDragZoom.enable(),this._el.classList.add("mapboxgl-touch-zoom-rotate")},ma.prototype.disable=function(){this._touchZoom.disable(),this._touchRotate.disable(),this._tapDragZoom.disable(),this._el.classList.remove("mapboxgl-touch-zoom-rotate")},ma.prototype.isEnabled=function(){return this._touchZoom.isEnabled()&&(this._rotationDisabled||this._touchRotate.isEnabled())&&this._tapDragZoom.isEnabled()},ma.prototype.isActive=function(){return this._touchZoom.isActive()||this._touchRotate.isActive()||this._tapDragZoom.isActive()},ma.prototype.disableRotation=function(){this._rotationDisabled=!0,this._touchRotate.disable()},ma.prototype.enableRotation=function(){this._rotationDisabled=!1,this._touchZoom.isEnabled()&&this._touchRotate.enable()};var wn=function(n){return n.zoom||n.drag||n.pitch||n.rotate},ws=function(n){function s(){n.apply(this,arguments)}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s}(a.Event);function gt(n){return n.panDelta&&n.panDelta.mag()||n.zoomDelta||n.bearingDelta||n.pitchDelta}var ut=function(n,s){this._map=n,this._el=this._map.getCanvasContainer(),this._handlers=[],this._handlersById={},this._changes=[],this._inertia=new gs(n),this._bearingSnap=s.bearingSnap,this._previousActiveHandlers={},this._eventsInProgress={},this._addDefaultHandlers(s),a.bindAll(["handleEvent","handleWindowEvent"],this);var o=this._el;this._listeners=[[o,"touchstart",{passive:!0}],[o,"touchmove",{passive:!1}],[o,"touchend",void 0],[o,"touchcancel",void 0],[o,"mousedown",void 0],[o,"mousemove",void 0],[o,"mouseup",void 0],[a.window.document,"mousemove",{capture:!0}],[a.window.document,"mouseup",void 0],[o,"mouseover",void 0],[o,"mouseout",void 0],[o,"dblclick",void 0],[o,"click",void 0],[o,"keydown",{capture:!1}],[o,"keyup",void 0],[o,"wheel",{passive:!1}],[o,"contextmenu",void 0],[a.window,"blur",void 0]];for(var u=0,y=this._listeners;u<y.length;u+=1){var w=y[u],k=w[0];T.addEventListener(k,w[1],k===a.window.document?this.handleWindowEvent:this.handleEvent,w[2])}};ut.prototype.destroy=function(){for(var n=0,s=this._listeners;n<s.length;n+=1){var o=s[n],u=o[0];T.removeEventListener(u,o[1],u===a.window.document?this.handleWindowEvent:this.handleEvent,o[2])}},ut.prototype._addDefaultHandlers=function(n){var s=this._map,o=s.getCanvasContainer();this._add("mapEvent",new wi(s,n));var u=s.boxZoom=new Un(s,n);this._add("boxZoom",u);var y=new Vn,w=new na;s.doubleClickZoom=new Sa(w,y),this._add("tapZoom",y),this._add("clickZoom",w);var k=new nn;this._add("tapDragZoom",k);var E=s.touchPitch=new eu;this._add("touchPitch",E);var P=new Ys(n),O=new $l(n);s.dragRotate=new Ya(n,P,O),this._add("mouseRotate",P,["mousePitch"]),this._add("mousePitch",O,["mouseRotate"]);var Z=new Ql(n),G=new ia(n);s.dragPan=new Io(o,Z,G),this._add("mousePan",Z),this._add("touchPan",G,["touchZoom","touchRotate"]);var X=new Ic,re=new qn;s.touchZoomRotate=new ma(o,re,X,k),this._add("touchRotate",X,["touchPan","touchZoom"]),this._add("touchZoom",re,["touchPan","touchRotate"]);var te=s.scrollZoom=new ur(s,this);this._add("scrollZoom",te,["mousePan"]);var ue=s.keyboard=new da;this._add("keyboard",ue),this._add("blockableMapEvent",new st(s));for(var Y=0,le=["boxZoom","doubleClickZoom","tapDragZoom","touchPitch","dragRotate","dragPan","touchZoomRotate","scrollZoom","keyboard"];Y<le.length;Y+=1){var pe=le[Y];n.interactive&&n[pe]&&s[pe].enable(n[pe])}},ut.prototype._add=function(n,s,o){this._handlers.push({handlerName:n,handler:s,allowed:o}),this._handlersById[n]=s},ut.prototype.stop=function(n){if(!this._updatingCamera){for(var s=0,o=this._handlers;s<o.length;s+=1)o[s].handler.reset();this._inertia.clear(),this._fireEvents({},{},n),this._changes=[]}},ut.prototype.isActive=function(){for(var n=0,s=this._handlers;n<s.length;n+=1)if(s[n].handler.isActive())return!0;return!1},ut.prototype.isZooming=function(){return!!this._eventsInProgress.zoom||this._map.scrollZoom.isZooming()},ut.prototype.isRotating=function(){return!!this._eventsInProgress.rotate},ut.prototype.isMoving=function(){return!!wn(this._eventsInProgress)||this.isZooming()},ut.prototype._blockedByActive=function(n,s,o){for(var u in n)if(u!==o&&(!s||s.indexOf(u)<0))return!0;return!1},ut.prototype.handleWindowEvent=function(n){this.handleEvent(n,n.type+"Window")},ut.prototype._getMapTouches=function(n){for(var s=[],o=0,u=n;o<u.length;o+=1){var y=u[o];this._el.contains(y.target)&&s.push(y)}return s},ut.prototype.handleEvent=function(n,s){this._updatingCamera=!0;for(var o=n.type==="renderFrame"?void 0:n,u={needsRenderFrame:!1},y={},w={},k=n.touches?this._getMapTouches(n.touches):void 0,E=k?T.touchPos(this._el,k):T.mousePos(this._el,n),P=0,O=this._handlers;P<O.length;P+=1){var Z=O[P],G=Z.handlerName,X=Z.handler,re=Z.allowed;if(X.isEnabled()){var te=void 0;this._blockedByActive(w,re,G)?X.reset():X[s||n.type]&&(te=X[s||n.type](n,E,k),this.mergeHandlerResult(u,y,te,G,o),te&&te.needsRenderFrame&&this._triggerRenderFrame()),(te||X.isActive())&&(w[G]=X)}}var ue={};for(var Y in this._previousActiveHandlers)w[Y]||(ue[Y]=o);this._previousActiveHandlers=w,(Object.keys(ue).length||gt(u))&&(this._changes.push([u,y,ue]),this._triggerRenderFrame()),(Object.keys(w).length||gt(u))&&this._map._stop(!0),this._updatingCamera=!1;var le=u.cameraAnimation;le&&(this._inertia.clear(),this._fireEvents({},{},!0),this._changes=[],le(this._map))},ut.prototype.mergeHandlerResult=function(n,s,o,u,y){if(o){a.extend(n,o);var w={handlerName:u,originalEvent:o.originalEvent||y};o.zoomDelta!==void 0&&(s.zoom=w),o.panDelta!==void 0&&(s.drag=w),o.pitchDelta!==void 0&&(s.pitch=w),o.bearingDelta!==void 0&&(s.rotate=w)}},ut.prototype._applyChanges=function(){for(var n={},s={},o={},u=0,y=this._changes;u<y.length;u+=1){var w=y[u],k=w[0],E=w[1],P=w[2];k.panDelta&&(n.panDelta=(n.panDelta||new a.Point(0,0))._add(k.panDelta)),k.zoomDelta&&(n.zoomDelta=(n.zoomDelta||0)+k.zoomDelta),k.bearingDelta&&(n.bearingDelta=(n.bearingDelta||0)+k.bearingDelta),k.pitchDelta&&(n.pitchDelta=(n.pitchDelta||0)+k.pitchDelta),k.around!==void 0&&(n.around=k.around),k.pinchAround!==void 0&&(n.pinchAround=k.pinchAround),k.noInertia&&(n.noInertia=k.noInertia),a.extend(s,E),a.extend(o,P)}this._updateMapTransform(n,s,o),this._changes=[]},ut.prototype._updateMapTransform=function(n,s,o){var u=this._map,y=u.transform;if(!gt(n))return this._fireEvents(s,o,!0);var w=n.panDelta,k=n.zoomDelta,E=n.bearingDelta,P=n.pitchDelta,O=n.around,Z=n.pinchAround;Z!==void 0&&(O=Z),u._stop(!0),O=O||u.transform.centerPoint;var G=y.pointLocation(w?O.sub(w):O);E&&(y.bearing+=E),P&&(y.pitch+=P),k&&(y.zoom+=k),y.setLocationAtPoint(G,O),this._map._update(),n.noInertia||this._inertia.record(n),this._fireEvents(s,o,!0)},ut.prototype._fireEvents=function(n,s,o){var u=this,y=wn(this._eventsInProgress),w=wn(n),k={};for(var E in n)this._eventsInProgress[E]||(k[E+"start"]=n[E].originalEvent),this._eventsInProgress[E]=n[E];for(var P in!y&&w&&this._fireEvent("movestart",w.originalEvent),k)this._fireEvent(P,k[P]);for(var O in w&&this._fireEvent("move",w.originalEvent),n)this._fireEvent(O,n[O].originalEvent);var Z,G={};for(var X in this._eventsInProgress){var re=this._eventsInProgress[X],te=re.handlerName,ue=re.originalEvent;this._handlersById[te].isActive()||(delete this._eventsInProgress[X],G[X+"end"]=Z=s[te]||ue)}for(var Y in G)this._fireEvent(Y,G[Y]);var le=wn(this._eventsInProgress);if(o&&(y||w)&&!le){this._updatingCamera=!0;var pe=this._inertia._onMoveEnd(this._map.dragPan._inertiaOptions),ge=function(ze){return ze!==0&&-u._bearingSnap<ze&&ze<u._bearingSnap};pe?(ge(pe.bearing||this._map.getBearing())&&(pe.bearing=0),this._map.easeTo(pe,{originalEvent:Z})):(this._map.fire(new a.Event("moveend",{originalEvent:Z})),ge(this._map.getBearing())&&this._map.resetNorth()),this._updatingCamera=!1}},ut.prototype._fireEvent=function(n,s){this._map.fire(new a.Event(n,s?{originalEvent:s}:{}))},ut.prototype._requestFrame=function(){var n=this;return this._map.triggerRepaint(),this._map._renderTaskQueue.add(function(s){delete n._frameId,n.handleEvent(new ws("renderFrame",{timeStamp:s})),n._applyChanges()})},ut.prototype._triggerRenderFrame=function(){this._frameId===void 0&&(this._frameId=this._requestFrame())};var el=function(n){function s(o,u){n.call(this),this._moving=!1,this._zooming=!1,this.transform=o,this._bearingSnap=u.bearingSnap,a.bindAll(["_renderFrameCallback"],this)}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype.getCenter=function(){return new a.LngLat(this.transform.center.lng,this.transform.center.lat)},s.prototype.setCenter=function(o,u){return this.jumpTo({center:o},u)},s.prototype.panBy=function(o,u,y){return o=a.Point.convert(o).mult(-1),this.panTo(this.transform.center,a.extend({offset:o},u),y)},s.prototype.panTo=function(o,u,y){return this.easeTo(a.extend({center:o},u),y)},s.prototype.getZoom=function(){return this.transform.zoom},s.prototype.setZoom=function(o,u){return this.jumpTo({zoom:o},u),this},s.prototype.zoomTo=function(o,u,y){return this.easeTo(a.extend({zoom:o},u),y)},s.prototype.zoomIn=function(o,u){return this.zoomTo(this.getZoom()+1,o,u),this},s.prototype.zoomOut=function(o,u){return this.zoomTo(this.getZoom()-1,o,u),this},s.prototype.getBearing=function(){return this.transform.bearing},s.prototype.setBearing=function(o,u){return this.jumpTo({bearing:o},u),this},s.prototype.getPadding=function(){return this.transform.padding},s.prototype.setPadding=function(o,u){return this.jumpTo({padding:o},u),this},s.prototype.rotateTo=function(o,u,y){return this.easeTo(a.extend({bearing:o},u),y)},s.prototype.resetNorth=function(o,u){return this.rotateTo(0,a.extend({duration:1e3},o),u),this},s.prototype.resetNorthPitch=function(o,u){return this.easeTo(a.extend({bearing:0,pitch:0,duration:1e3},o),u),this},s.prototype.snapToNorth=function(o,u){return Math.abs(this.getBearing())<this._bearingSnap?this.resetNorth(o,u):this},s.prototype.getPitch=function(){return this.transform.pitch},s.prototype.setPitch=function(o,u){return this.jumpTo({pitch:o},u),this},s.prototype.cameraForBounds=function(o,u){o=a.LngLatBounds.convert(o);var y=u&&u.bearing||0;return this._cameraForBoxAndBearing(o.getNorthWest(),o.getSouthEast(),y,u)},s.prototype._cameraForBoxAndBearing=function(o,u,y,w){var k={top:0,bottom:0,right:0,left:0};if(typeof(w=a.extend({padding:k,offset:[0,0],maxZoom:this.transform.maxZoom},w)).padding=="number"){var E=w.padding;w.padding={top:E,bottom:E,right:E,left:E}}w.padding=a.extend(k,w.padding);var P=this.transform,O=P.padding,Z=P.project(a.LngLat.convert(o)),G=P.project(a.LngLat.convert(u)),X=Z.rotate(-y*Math.PI/180),re=G.rotate(-y*Math.PI/180),te=new a.Point(Math.max(X.x,re.x),Math.max(X.y,re.y)),ue=new a.Point(Math.min(X.x,re.x),Math.min(X.y,re.y)),Y=te.sub(ue),le=(P.width-(O.left+O.right+w.padding.left+w.padding.right))/Y.x,pe=(P.height-(O.top+O.bottom+w.padding.top+w.padding.bottom))/Y.y;if(!(pe<0||le<0)){var ge=Math.min(P.scaleZoom(P.scale*Math.min(le,pe)),w.maxZoom),ze=typeof w.offset.x=="number"?new a.Point(w.offset.x,w.offset.y):a.Point.convert(w.offset),Te=new a.Point((w.padding.left-w.padding.right)/2,(w.padding.top-w.padding.bottom)/2).rotate(y*Math.PI/180),Ae=ze.add(Te).mult(P.scale/P.zoomScale(ge));return{center:P.unproject(Z.add(G).div(2).sub(Ae)),zoom:ge,bearing:y}}a.warnOnce("Map cannot fit within canvas with the given bounds, padding, and/or offset.")},s.prototype.fitBounds=function(o,u,y){return this._fitInternal(this.cameraForBounds(o,u),u,y)},s.prototype.fitScreenCoordinates=function(o,u,y,w,k){return this._fitInternal(this._cameraForBoxAndBearing(this.transform.pointLocation(a.Point.convert(o)),this.transform.pointLocation(a.Point.convert(u)),y,w),w,k)},s.prototype._fitInternal=function(o,u,y){return o?(delete(u=a.extend(o,u)).padding,u.linear?this.easeTo(u,y):this.flyTo(u,y)):this},s.prototype.jumpTo=function(o,u){this.stop();var y=this.transform,w=!1,k=!1,E=!1;return"zoom"in o&&y.zoom!==+o.zoom&&(w=!0,y.zoom=+o.zoom),o.center!==void 0&&(y.center=a.LngLat.convert(o.center)),"bearing"in o&&y.bearing!==+o.bearing&&(k=!0,y.bearing=+o.bearing),"pitch"in o&&y.pitch!==+o.pitch&&(E=!0,y.pitch=+o.pitch),o.padding==null||y.isPaddingEqual(o.padding)||(y.padding=o.padding),this.fire(new a.Event("movestart",u)).fire(new a.Event("move",u)),w&&this.fire(new a.Event("zoomstart",u)).fire(new a.Event("zoom",u)).fire(new a.Event("zoomend",u)),k&&this.fire(new a.Event("rotatestart",u)).fire(new a.Event("rotate",u)).fire(new a.Event("rotateend",u)),E&&this.fire(new a.Event("pitchstart",u)).fire(new a.Event("pitch",u)).fire(new a.Event("pitchend",u)),this.fire(new a.Event("moveend",u))},s.prototype.easeTo=function(o,u){var y=this;this._stop(!1,o.easeId),((o=a.extend({offset:[0,0],duration:500,easing:a.ease},o)).animate===!1||!o.essential&&a.browser.prefersReducedMotion)&&(o.duration=0);var w=this.transform,k=this.getZoom(),E=this.getBearing(),P=this.getPitch(),O=this.getPadding(),Z="zoom"in o?+o.zoom:k,G="bearing"in o?this._normalizeBearing(o.bearing,E):E,X="pitch"in o?+o.pitch:P,re="padding"in o?o.padding:w.padding,te=a.Point.convert(o.offset),ue=w.centerPoint.add(te),Y=w.pointLocation(ue),le=a.LngLat.convert(o.center||Y);this._normalizeCenter(le);var pe,ge,ze=w.project(Y),Te=w.project(le).sub(ze),Ae=w.zoomScale(Z-k);o.around&&(pe=a.LngLat.convert(o.around),ge=w.locationPoint(pe));var Re={moving:this._moving,zooming:this._zooming,rotating:this._rotating,pitching:this._pitching};return this._zooming=this._zooming||Z!==k,this._rotating=this._rotating||E!==G,this._pitching=this._pitching||X!==P,this._padding=!w.isPaddingEqual(re),this._easeId=o.easeId,this._prepareEase(u,o.noMoveStart,Re),this._ease(function(Xe){if(y._zooming&&(w.zoom=a.number(k,Z,Xe)),y._rotating&&(w.bearing=a.number(E,G,Xe)),y._pitching&&(w.pitch=a.number(P,X,Xe)),y._padding&&(w.interpolatePadding(O,re,Xe),ue=w.centerPoint.add(te)),pe)w.setLocationAtPoint(pe,ge);else{var Ge=w.zoomScale(w.zoom-k),at=Z>k?Math.min(2,Ae):Math.max(.5,Ae),vt=Math.pow(at,1-Xe),kt=w.unproject(ze.add(Te.mult(Xe*vt)).mult(Ge));w.setLocationAtPoint(w.renderWorldCopies?kt.wrap():kt,ue)}y._fireMoveEvents(u)},function(Xe){y._afterEase(u,Xe)},o),this},s.prototype._prepareEase=function(o,u,y){y===void 0&&(y={}),this._moving=!0,u||y.moving||this.fire(new a.Event("movestart",o)),this._zooming&&!y.zooming&&this.fire(new a.Event("zoomstart",o)),this._rotating&&!y.rotating&&this.fire(new a.Event("rotatestart",o)),this._pitching&&!y.pitching&&this.fire(new a.Event("pitchstart",o))},s.prototype._fireMoveEvents=function(o){this.fire(new a.Event("move",o)),this._zooming&&this.fire(new a.Event("zoom",o)),this._rotating&&this.fire(new a.Event("rotate",o)),this._pitching&&this.fire(new a.Event("pitch",o))},s.prototype._afterEase=function(o,u){if(!this._easeId||!u||this._easeId!==u){delete this._easeId;var y=this._zooming,w=this._rotating,k=this._pitching;this._moving=!1,this._zooming=!1,this._rotating=!1,this._pitching=!1,this._padding=!1,y&&this.fire(new a.Event("zoomend",o)),w&&this.fire(new a.Event("rotateend",o)),k&&this.fire(new a.Event("pitchend",o)),this.fire(new a.Event("moveend",o))}},s.prototype.flyTo=function(o,u){var y=this;if(!o.essential&&a.browser.prefersReducedMotion){var w=a.pick(o,["center","zoom","bearing","pitch","around"]);return this.jumpTo(w,u)}this.stop(),o=a.extend({offset:[0,0],speed:1.2,curve:1.42,easing:a.ease},o);var k=this.transform,E=this.getZoom(),P=this.getBearing(),O=this.getPitch(),Z=this.getPadding(),G="zoom"in o?a.clamp(+o.zoom,k.minZoom,k.maxZoom):E,X="bearing"in o?this._normalizeBearing(o.bearing,P):P,re="pitch"in o?+o.pitch:O,te="padding"in o?o.padding:k.padding,ue=k.zoomScale(G-E),Y=a.Point.convert(o.offset),le=k.centerPoint.add(Y),pe=k.pointLocation(le),ge=a.LngLat.convert(o.center||pe);this._normalizeCenter(ge);var ze=k.project(pe),Te=k.project(ge).sub(ze),Ae=o.curve,Re=Math.max(k.width,k.height),Xe=Re/ue,Ge=Te.mag();if("minZoom"in o){var at=a.clamp(Math.min(o.minZoom,E,G),k.minZoom,k.maxZoom),vt=Re/k.zoomScale(at-E);Ae=Math.sqrt(vt/Ge*2)}var kt=Ae*Ae;function wt(Rt){var Ct=(Xe*Xe-Re*Re+(Rt?-1:1)*kt*kt*Ge*Ge)/(2*(Rt?Xe:Re)*kt*Ge);return Math.log(Math.sqrt(Ct*Ct+1)-Ct)}function _r(Rt){return(Math.exp(Rt)-Math.exp(-Rt))/2}function ot(Rt){return(Math.exp(Rt)+Math.exp(-Rt))/2}var Nt=wt(0),Yt=function(Rt){return ot(Nt)/ot(Nt+Ae*Rt)},Ot=function(Rt){return Re*((ot(Nt)*(_r(Ct=Nt+Ae*Rt)/ot(Ct))-_r(Nt))/kt)/Ge;var Ct},Bt=(wt(1)-Nt)/Ae;if(Math.abs(Ge)<1e-6||!isFinite(Bt)){if(Math.abs(Re-Xe)<1e-6)return this.easeTo(o,u);var Ht=Xe<Re?-1:1;Bt=Math.abs(Math.log(Xe/Re))/Ae,Ot=function(){return 0},Yt=function(Rt){return Math.exp(Ht*Ae*Rt)}}return o.duration="duration"in o?+o.duration:1e3*Bt/("screenSpeed"in o?+o.screenSpeed/Ae:+o.speed),o.maxDuration&&o.duration>o.maxDuration&&(o.duration=0),this._zooming=!0,this._rotating=P!==X,this._pitching=re!==O,this._padding=!k.isPaddingEqual(te),this._prepareEase(u,!1),this._ease(function(Rt){var Ct=Rt*Bt,Li=1/Yt(Ct);k.zoom=Rt===1?G:E+k.scaleZoom(Li),y._rotating&&(k.bearing=a.number(P,X,Rt)),y._pitching&&(k.pitch=a.number(O,re,Rt)),y._padding&&(k.interpolatePadding(Z,te,Rt),le=k.centerPoint.add(Y));var ui=Rt===1?ge:k.unproject(ze.add(Te.mult(Ot(Ct))).mult(Li));k.setLocationAtPoint(k.renderWorldCopies?ui.wrap():ui,le),y._fireMoveEvents(u)},function(){return y._afterEase(u)},o),this},s.prototype.isEasing=function(){return!!this._easeFrameId},s.prototype.stop=function(){return this._stop()},s.prototype._stop=function(o,u){if(this._easeFrameId&&(this._cancelRenderFrame(this._easeFrameId),delete this._easeFrameId,delete this._onEaseFrame),this._onEaseEnd){var y=this._onEaseEnd;delete this._onEaseEnd,y.call(this,u)}if(!o){var w=this.handlers;w&&w.stop(!1)}return this},s.prototype._ease=function(o,u,y){y.animate===!1||y.duration===0?(o(1),u()):(this._easeStart=a.browser.now(),this._easeOptions=y,this._onEaseFrame=o,this._onEaseEnd=u,this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback))},s.prototype._renderFrameCallback=function(){var o=Math.min((a.browser.now()-this._easeStart)/this._easeOptions.duration,1);this._onEaseFrame(this._easeOptions.easing(o)),o<1?this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback):this.stop()},s.prototype._normalizeBearing=function(o,u){o=a.wrap(o,-180,180);var y=Math.abs(o-u);return Math.abs(o-360-u)<y&&(o-=360),Math.abs(o+360-u)<y&&(o+=360),o},s.prototype._normalizeCenter=function(o){var u=this.transform;if(u.renderWorldCopies&&!u.lngRange){var y=o.lng-u.center.lng;o.lng+=y>180?-360:y<-180?360:0}},s}(a.Evented),kn=function(n){n===void 0&&(n={}),this.options=n,a.bindAll(["_toggleAttribution","_updateEditLink","_updateData","_updateCompact"],this)};kn.prototype.getDefaultPosition=function(){return"bottom-right"},kn.prototype.onAdd=function(n){var s=this.options&&this.options.compact;return this._map=n,this._container=T.create("div","mapboxgl-ctrl mapboxgl-ctrl-attrib"),this._compactButton=T.create("button","mapboxgl-ctrl-attrib-button",this._container),this._compactButton.addEventListener("click",this._toggleAttribution),this._setElementTitle(this._compactButton,"ToggleAttribution"),this._innerContainer=T.create("div","mapboxgl-ctrl-attrib-inner",this._container),this._innerContainer.setAttribute("role","list"),s&&this._container.classList.add("mapboxgl-compact"),this._updateAttributions(),this._updateEditLink(),this._map.on("styledata",this._updateData),this._map.on("sourcedata",this._updateData),this._map.on("moveend",this._updateEditLink),s===void 0&&(this._map.on("resize",this._updateCompact),this._updateCompact()),this._container},kn.prototype.onRemove=function(){T.remove(this._container),this._map.off("styledata",this._updateData),this._map.off("sourcedata",this._updateData),this._map.off("moveend",this._updateEditLink),this._map.off("resize",this._updateCompact),this._map=void 0,this._attribHTML=void 0},kn.prototype._setElementTitle=function(n,s){var o=this._map._getUIString("AttributionControl."+s);n.title=o,n.setAttribute("aria-label",o)},kn.prototype._toggleAttribution=function(){this._container.classList.contains("mapboxgl-compact-show")?(this._container.classList.remove("mapboxgl-compact-show"),this._compactButton.setAttribute("aria-pressed","false")):(this._container.classList.add("mapboxgl-compact-show"),this._compactButton.setAttribute("aria-pressed","true"))},kn.prototype._updateEditLink=function(){var n=this._editLink;n||(n=this._editLink=this._container.querySelector(".mapbox-improve-map"));var s=[{key:"owner",value:this.styleOwner},{key:"id",value:this.styleId},{key:"access_token",value:this._map._requestManager._customAccessToken||a.config.ACCESS_TOKEN}];if(n){var o=s.reduce(function(u,y,w){return y.value&&(u+=y.key+"="+y.value+(w<s.length-1?"&":"")),u},"?");n.href=a.config.FEEDBACK_URL+"/"+o+(this._map._hash?this._map._hash.getHashString(!0):""),n.rel="noopener nofollow",this._setElementTitle(n,"MapFeedback")}},kn.prototype._updateData=function(n){!n||n.sourceDataType!=="metadata"&&n.sourceDataType!=="visibility"&&n.dataType!=="style"||(this._updateAttributions(),this._updateEditLink())},kn.prototype._updateAttributions=function(){if(this._map.style){var n=[];if(this.options.customAttribution&&(Array.isArray(this.options.customAttribution)?n=n.concat(this.options.customAttribution.map(function(E){return typeof E!="string"?"":E})):typeof this.options.customAttribution=="string"&&n.push(this.options.customAttribution)),this._map.style.stylesheet){var s=this._map.style.stylesheet;this.styleOwner=s.owner,this.styleId=s.id}var o=this._map.style.sourceCaches;for(var u in o){var y=o[u];if(y.used){var w=y.getSource();w.attribution&&n.indexOf(w.attribution)<0&&n.push(w.attribution)}}n.sort(function(E,P){return E.length-P.length});var k=(n=n.filter(function(E,P){for(var O=P+1;O<n.length;O++)if(n[O].indexOf(E)>=0)return!1;return!0})).join(" | ");k!==this._attribHTML&&(this._attribHTML=k,n.length?(this._innerContainer.innerHTML=k,this._container.classList.remove("mapboxgl-attrib-empty")):this._container.classList.add("mapboxgl-attrib-empty"),this._editLink=null)}},kn.prototype._updateCompact=function(){this._map.getCanvasContainer().offsetWidth<=640?this._container.classList.add("mapboxgl-compact"):this._container.classList.remove("mapboxgl-compact","mapboxgl-compact-show")};var ya=function(){a.bindAll(["_updateLogo"],this),a.bindAll(["_updateCompact"],this)};ya.prototype.onAdd=function(n){this._map=n,this._container=T.create("div","mapboxgl-ctrl");var s=T.create("a","mapboxgl-ctrl-logo");return s.target="_blank",s.rel="noopener nofollow",s.href="https://www.mapbox.com/",s.setAttribute("aria-label",this._map._getUIString("LogoControl.Title")),s.setAttribute("rel","noopener nofollow"),this._container.appendChild(s),this._container.style.display="none",this._map.on("sourcedata",this._updateLogo),this._updateLogo(),this._map.on("resize",this._updateCompact),this._updateCompact(),this._container},ya.prototype.onRemove=function(){T.remove(this._container),this._map.off("sourcedata",this._updateLogo),this._map.off("resize",this._updateCompact)},ya.prototype.getDefaultPosition=function(){return"bottom-left"},ya.prototype._updateLogo=function(n){n&&n.sourceDataType!=="metadata"||(this._container.style.display=this._logoRequired()?"block":"none")},ya.prototype._logoRequired=function(){if(this._map.style){var n=this._map.style.sourceCaches;for(var s in n)if(n[s].getSource().mapbox_logo)return!0;return!1}},ya.prototype._updateCompact=function(){var n=this._container.children;if(n.length){var s=n[0];this._map.getCanvasContainer().offsetWidth<250?s.classList.add("mapboxgl-compact"):s.classList.remove("mapboxgl-compact")}};var an=function(){this._queue=[],this._id=0,this._cleared=!1,this._currentlyRunning=!1};an.prototype.add=function(n){var s=++this._id;return this._queue.push({callback:n,id:s,cancelled:!1}),s},an.prototype.remove=function(n){for(var s=this._currentlyRunning,o=0,u=s?this._queue.concat(s):this._queue;o<u.length;o+=1){var y=u[o];if(y.id===n)return void(y.cancelled=!0)}},an.prototype.run=function(n){n===void 0&&(n=0);var s=this._currentlyRunning=this._queue;this._queue=[];for(var o=0,u=s;o<u.length;o+=1){var y=u[o];if(!y.cancelled&&(y.callback(n),this._cleared))break}this._cleared=!1,this._currentlyRunning=!1},an.prototype.clear=function(){this._currentlyRunning&&(this._cleared=!0),this._queue=[]};var Ea={"AttributionControl.ToggleAttribution":"Toggle attribution","AttributionControl.MapFeedback":"Map feedback","FullscreenControl.Enter":"Enter fullscreen","FullscreenControl.Exit":"Exit fullscreen","GeolocateControl.FindMyLocation":"Find my location","GeolocateControl.LocationNotAvailable":"Location not available","LogoControl.Title":"Mapbox logo","NavigationControl.ResetBearing":"Reset bearing to north","NavigationControl.ZoomIn":"Zoom in","NavigationControl.ZoomOut":"Zoom out","ScaleControl.Feet":"ft","ScaleControl.Meters":"m","ScaleControl.Kilometers":"km","ScaleControl.Miles":"mi","ScaleControl.NauticalMiles":"nm"},ru=a.window.HTMLImageElement,tl=a.window.HTMLElement,zr=a.window.ImageBitmap,Ki={center:[0,0],zoom:0,bearing:0,pitch:0,minZoom:-2,maxZoom:22,minPitch:0,maxPitch:60,interactive:!0,scrollZoom:!0,boxZoom:!0,dragRotate:!0,dragPan:!0,keyboard:!0,doubleClickZoom:!0,touchZoomRotate:!0,touchPitch:!0,bearingSnap:7,clickTolerance:3,pitchWithRotate:!0,hash:!1,attributionControl:!0,failIfMajorPerformanceCaveat:!1,preserveDrawingBuffer:!1,trackResize:!0,renderWorldCopies:!0,refreshExpiredTiles:!0,maxTileCacheSize:null,localIdeographFontFamily:"sans-serif",transformRequest:null,accessToken:null,fadeDuration:300,crossSourceCollisions:!0},zc=function(n){function s(u){var y=this;if((u=a.extend({},Ki,u)).minZoom!=null&&u.maxZoom!=null&&u.minZoom>u.maxZoom)throw new Error("maxZoom must be greater than or equal to minZoom");if(u.minPitch!=null&&u.maxPitch!=null&&u.minPitch>u.maxPitch)throw new Error("maxPitch must be greater than or equal to minPitch");if(u.minPitch!=null&&u.minPitch<0)throw new Error("minPitch must be greater than or equal to 0");if(u.maxPitch!=null&&u.maxPitch>60)throw new Error("maxPitch must be less than or equal to 60");var w=new dr(u.minZoom,u.maxZoom,u.minPitch,u.maxPitch,u.renderWorldCopies);if(n.call(this,w,u),this._interactive=u.interactive,this._maxTileCacheSize=u.maxTileCacheSize,this._failIfMajorPerformanceCaveat=u.failIfMajorPerformanceCaveat,this._preserveDrawingBuffer=u.preserveDrawingBuffer,this._antialias=u.antialias,this._trackResize=u.trackResize,this._bearingSnap=u.bearingSnap,this._refreshExpiredTiles=u.refreshExpiredTiles,this._fadeDuration=u.fadeDuration,this._crossSourceCollisions=u.crossSourceCollisions,this._crossFadingFactor=1,this._collectResourceTiming=u.collectResourceTiming,this._renderTaskQueue=new an,this._controls=[],this._mapId=a.uniqueId(),this._locale=a.extend({},Ea,u.locale),this._clickTolerance=u.clickTolerance,this._requestManager=new a.RequestManager(u.transformRequest,u.accessToken),typeof u.container=="string"){if(this._container=a.window.document.getElementById(u.container),!this._container)throw new Error("Container '"+u.container+"' not found.")}else{if(!(u.container instanceof tl))throw new Error("Invalid type: 'container' must be a String or HTMLElement.");this._container=u.container}if(u.maxBounds&&this.setMaxBounds(u.maxBounds),a.bindAll(["_onWindowOnline","_onWindowResize","_onMapScroll","_contextLost","_contextRestored"],this),this._setupContainer(),this._setupPainter(),this.painter===void 0)throw new Error("Failed to initialize WebGL.");this.on("move",function(){return y._update(!1)}),this.on("moveend",function(){return y._update(!1)}),this.on("zoom",function(){return y._update(!0)}),a.window!==void 0&&(a.window.addEventListener("online",this._onWindowOnline,!1),a.window.addEventListener("resize",this._onWindowResize,!1),a.window.addEventListener("orientationchange",this._onWindowResize,!1)),this.handlers=new ut(this,u),this._hash=u.hash&&new Yn(typeof u.hash=="string"&&u.hash||void 0).addTo(this),this._hash&&this._hash._onHashChange()||(this.jumpTo({center:u.center,zoom:u.zoom,bearing:u.bearing,pitch:u.pitch}),u.bounds&&(this.resize(),this.fitBounds(u.bounds,a.extend({},u.fitBoundsOptions,{duration:0})))),this.resize(),this._localIdeographFontFamily=u.localIdeographFontFamily,u.style&&this.setStyle(u.style,{localIdeographFontFamily:u.localIdeographFontFamily}),u.attributionControl&&this.addControl(new kn({customAttribution:u.customAttribution})),this.addControl(new ya,u.logoPosition),this.on("style.load",function(){y.transform.unmodified&&y.jumpTo(y.style.stylesheet)}),this.on("data",function(k){y._update(k.dataType==="style"),y.fire(new a.Event(k.dataType+"data",k))}),this.on("dataloading",function(k){y.fire(new a.Event(k.dataType+"dataloading",k))})}n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s;var o={showTileBoundaries:{configurable:!0},showPadding:{configurable:!0},showCollisionBoxes:{configurable:!0},showOverdrawInspector:{configurable:!0},repaint:{configurable:!0},vertices:{configurable:!0},version:{configurable:!0}};return s.prototype._getMapId=function(){return this._mapId},s.prototype.addControl=function(u,y){if(y===void 0&&(y=u.getDefaultPosition?u.getDefaultPosition():"top-right"),!u||!u.onAdd)return this.fire(new a.ErrorEvent(new Error("Invalid argument to map.addControl(). Argument must be a control with onAdd and onRemove methods.")));var w=u.onAdd(this);this._controls.push(u);var k=this._controlPositions[y];return y.indexOf("bottom")!==-1?k.insertBefore(w,k.firstChild):k.appendChild(w),this},s.prototype.removeControl=function(u){if(!u||!u.onRemove)return this.fire(new a.ErrorEvent(new Error("Invalid argument to map.removeControl(). Argument must be a control with onAdd and onRemove methods.")));var y=this._controls.indexOf(u);return y>-1&&this._controls.splice(y,1),u.onRemove(this),this},s.prototype.hasControl=function(u){return this._controls.indexOf(u)>-1},s.prototype.resize=function(u){var y=this._containerDimensions(),w=y[0],k=y[1];if(w===this.transform.width&&k===this.transform.height)return this;this._resizeCanvas(w,k),this.transform.resize(w,k),this.painter.resize(w,k);var E=!this._moving;return E&&this.fire(new a.Event("movestart",u)).fire(new a.Event("move",u)),this.fire(new a.Event("resize",u)),E&&this.fire(new a.Event("moveend",u)),this},s.prototype.getBounds=function(){return this.transform.getBounds()},s.prototype.getMaxBounds=function(){return this.transform.getMaxBounds()},s.prototype.setMaxBounds=function(u){return this.transform.setMaxBounds(a.LngLatBounds.convert(u)),this._update()},s.prototype.setMinZoom=function(u){if((u=u??-2)>=-2&&u<=this.transform.maxZoom)return this.transform.minZoom=u,this._update(),this.getZoom()<u&&this.setZoom(u),this;throw new Error("minZoom must be between -2 and the current maxZoom, inclusive")},s.prototype.getMinZoom=function(){return this.transform.minZoom},s.prototype.setMaxZoom=function(u){if((u=u??22)>=this.transform.minZoom)return this.transform.maxZoom=u,this._update(),this.getZoom()>u&&this.setZoom(u),this;throw new Error("maxZoom must be greater than the current minZoom")},s.prototype.getMaxZoom=function(){return this.transform.maxZoom},s.prototype.setMinPitch=function(u){if((u=u??0)<0)throw new Error("minPitch must be greater than or equal to 0");if(u>=0&&u<=this.transform.maxPitch)return this.transform.minPitch=u,this._update(),this.getPitch()<u&&this.setPitch(u),this;throw new Error("minPitch must be between 0 and the current maxPitch, inclusive")},s.prototype.getMinPitch=function(){return this.transform.minPitch},s.prototype.setMaxPitch=function(u){if((u=u??60)>60)throw new Error("maxPitch must be less than or equal to 60");if(u>=this.transform.minPitch)return this.transform.maxPitch=u,this._update(),this.getPitch()>u&&this.setPitch(u),this;throw new Error("maxPitch must be greater than the current minPitch")},s.prototype.getMaxPitch=function(){return this.transform.maxPitch},s.prototype.getRenderWorldCopies=function(){return this.transform.renderWorldCopies},s.prototype.setRenderWorldCopies=function(u){return this.transform.renderWorldCopies=u,this._update()},s.prototype.project=function(u){return this.transform.locationPoint(a.LngLat.convert(u))},s.prototype.unproject=function(u){return this.transform.pointLocation(a.Point.convert(u))},s.prototype.isMoving=function(){return this._moving||this.handlers.isMoving()},s.prototype.isZooming=function(){return this._zooming||this.handlers.isZooming()},s.prototype.isRotating=function(){return this._rotating||this.handlers.isRotating()},s.prototype._createDelegatedListener=function(u,y,w){var k,E=this;if(u==="mouseenter"||u==="mouseover"){var P=!1;return{layer:y,listener:w,delegates:{mousemove:function(Z){var G=E.getLayer(y)?E.queryRenderedFeatures(Z.point,{layers:[y]}):[];G.length?P||(P=!0,w.call(E,new Ii(u,E,Z.originalEvent,{features:G}))):P=!1},mouseout:function(){P=!1}}}}if(u==="mouseleave"||u==="mouseout"){var O=!1;return{layer:y,listener:w,delegates:{mousemove:function(Z){(E.getLayer(y)?E.queryRenderedFeatures(Z.point,{layers:[y]}):[]).length?O=!0:O&&(O=!1,w.call(E,new Ii(u,E,Z.originalEvent)))},mouseout:function(Z){O&&(O=!1,w.call(E,new Ii(u,E,Z.originalEvent)))}}}}return{layer:y,listener:w,delegates:(k={},k[u]=function(Z){var G=E.getLayer(y)?E.queryRenderedFeatures(Z.point,{layers:[y]}):[];G.length&&(Z.features=G,w.call(E,Z),delete Z.features)},k)}},s.prototype.on=function(u,y,w){if(w===void 0)return n.prototype.on.call(this,u,y);var k=this._createDelegatedListener(u,y,w);for(var E in this._delegatedListeners=this._delegatedListeners||{},this._delegatedListeners[u]=this._delegatedListeners[u]||[],this._delegatedListeners[u].push(k),k.delegates)this.on(E,k.delegates[E]);return this},s.prototype.once=function(u,y,w){if(w===void 0)return n.prototype.once.call(this,u,y);var k=this._createDelegatedListener(u,y,w);for(var E in k.delegates)this.once(E,k.delegates[E]);return this},s.prototype.off=function(u,y,w){var k=this;return w===void 0?n.prototype.off.call(this,u,y):(this._delegatedListeners&&this._delegatedListeners[u]&&function(E){for(var P=E[u],O=0;O<P.length;O++){var Z=P[O];if(Z.layer===y&&Z.listener===w){for(var G in Z.delegates)k.off(G,Z.delegates[G]);return P.splice(O,1),k}}}(this._delegatedListeners),this)},s.prototype.queryRenderedFeatures=function(u,y){if(!this.style)return[];var w;if(y!==void 0||u===void 0||u instanceof a.Point||Array.isArray(u)||(y=u,u=void 0),y=y||{},(u=u||[[0,0],[this.transform.width,this.transform.height]])instanceof a.Point||typeof u[0]=="number")w=[a.Point.convert(u)];else{var k=a.Point.convert(u[0]),E=a.Point.convert(u[1]);w=[k,new a.Point(E.x,k.y),E,new a.Point(k.x,E.y),k]}return this.style.queryRenderedFeatures(w,y,this.transform)},s.prototype.querySourceFeatures=function(u,y){return this.style.querySourceFeatures(u,y)},s.prototype.setStyle=function(u,y){return(y=a.extend({},{localIdeographFontFamily:this._localIdeographFontFamily},y)).diff!==!1&&y.localIdeographFontFamily===this._localIdeographFontFamily&&this.style&&u?(this._diffStyle(u,y),this):(this._localIdeographFontFamily=y.localIdeographFontFamily,this._updateStyle(u,y))},s.prototype._getUIString=function(u){var y=this._locale[u];if(y==null)throw new Error("Missing UI string '"+u+"'");return y},s.prototype._updateStyle=function(u,y){return this.style&&(this.style.setEventedParent(null),this.style._remove()),u?(this.style=new Nn(this,y||{}),this.style.setEventedParent(this,{style:this.style}),typeof u=="string"?this.style.loadURL(u):this.style.loadJSON(u),this):(delete this.style,this)},s.prototype._lazyInitEmptyStyle=function(){this.style||(this.style=new Nn(this,{}),this.style.setEventedParent(this,{style:this.style}),this.style.loadEmpty())},s.prototype._diffStyle=function(u,y){var w=this;if(typeof u=="string"){var k=this._requestManager.normalizeStyleURL(u),E=this._requestManager.transformRequest(k,a.ResourceType.Style);a.getJSON(E,function(P,O){P?w.fire(new a.ErrorEvent(P)):O&&w._updateDiff(O,y)})}else typeof u=="object"&&this._updateDiff(u,y)},s.prototype._updateDiff=function(u,y){try{this.style.setState(u)&&this._update(!0)}catch(w){a.warnOnce("Unable to perform style diff: "+(w.message||w.error||w)+".  Rebuilding the style from scratch."),this._updateStyle(u,y)}},s.prototype.getStyle=function(){if(this.style)return this.style.serialize()},s.prototype.isStyleLoaded=function(){return this.style?this.style.loaded():a.warnOnce("There is no style added to the map.")},s.prototype.addSource=function(u,y){return this._lazyInitEmptyStyle(),this.style.addSource(u,y),this._update(!0)},s.prototype.isSourceLoaded=function(u){var y=this.style&&this.style.sourceCaches[u];if(y!==void 0)return y.loaded();this.fire(new a.ErrorEvent(new Error("There is no source with ID '"+u+"'")))},s.prototype.areTilesLoaded=function(){var u=this.style&&this.style.sourceCaches;for(var y in u){var w=u[y]._tiles;for(var k in w){var E=w[k];if(E.state!=="loaded"&&E.state!=="errored")return!1}}return!0},s.prototype.addSourceType=function(u,y,w){return this._lazyInitEmptyStyle(),this.style.addSourceType(u,y,w)},s.prototype.removeSource=function(u){return this.style.removeSource(u),this._update(!0)},s.prototype.getSource=function(u){return this.style.getSource(u)},s.prototype.addImage=function(u,y,w){w===void 0&&(w={});var k=w.pixelRatio;k===void 0&&(k=1);var E=w.sdf;E===void 0&&(E=!1);var P=w.stretchX,O=w.stretchY,Z=w.content;if(this._lazyInitEmptyStyle(),y instanceof ru||zr&&y instanceof zr){var G=a.browser.getImageData(y);this.style.addImage(u,{data:new a.RGBAImage({width:G.width,height:G.height},G.data),pixelRatio:k,stretchX:P,stretchY:O,content:Z,sdf:E,version:0})}else{if(y.width===void 0||y.height===void 0)return this.fire(new a.ErrorEvent(new Error("Invalid arguments to map.addImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));var X=y;this.style.addImage(u,{data:new a.RGBAImage({width:y.width,height:y.height},new Uint8Array(y.data)),pixelRatio:k,stretchX:P,stretchY:O,content:Z,sdf:E,version:0,userImage:X}),X.onAdd&&X.onAdd(this,u)}},s.prototype.updateImage=function(u,y){var w=this.style.getImage(u);if(!w)return this.fire(new a.ErrorEvent(new Error("The map has no image with that id. If you are adding a new image use `map.addImage(...)` instead.")));var k=y instanceof ru||zr&&y instanceof zr?a.browser.getImageData(y):y,E=k.width,P=k.height,O=k.data;return E===void 0||P===void 0?this.fire(new a.ErrorEvent(new Error("Invalid arguments to map.updateImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`"))):E!==w.data.width||P!==w.data.height?this.fire(new a.ErrorEvent(new Error("The width and height of the updated image must be that same as the previous version of the image"))):(w.data.replace(O,!(y instanceof ru||zr&&y instanceof zr)),void this.style.updateImage(u,w))},s.prototype.hasImage=function(u){return u?!!this.style.getImage(u):(this.fire(new a.ErrorEvent(new Error("Missing required image id"))),!1)},s.prototype.removeImage=function(u){this.style.removeImage(u)},s.prototype.loadImage=function(u,y){a.getImage(this._requestManager.transformRequest(u,a.ResourceType.Image),y)},s.prototype.listImages=function(){return this.style.listImages()},s.prototype.addLayer=function(u,y){return this._lazyInitEmptyStyle(),this.style.addLayer(u,y),this._update(!0)},s.prototype.moveLayer=function(u,y){return this.style.moveLayer(u,y),this._update(!0)},s.prototype.removeLayer=function(u){return this.style.removeLayer(u),this._update(!0)},s.prototype.getLayer=function(u){return this.style.getLayer(u)},s.prototype.setLayerZoomRange=function(u,y,w){return this.style.setLayerZoomRange(u,y,w),this._update(!0)},s.prototype.setFilter=function(u,y,w){return w===void 0&&(w={}),this.style.setFilter(u,y,w),this._update(!0)},s.prototype.getFilter=function(u){return this.style.getFilter(u)},s.prototype.setPaintProperty=function(u,y,w,k){return k===void 0&&(k={}),this.style.setPaintProperty(u,y,w,k),this._update(!0)},s.prototype.getPaintProperty=function(u,y){return this.style.getPaintProperty(u,y)},s.prototype.setLayoutProperty=function(u,y,w,k){return k===void 0&&(k={}),this.style.setLayoutProperty(u,y,w,k),this._update(!0)},s.prototype.getLayoutProperty=function(u,y){return this.style.getLayoutProperty(u,y)},s.prototype.setLight=function(u,y){return y===void 0&&(y={}),this._lazyInitEmptyStyle(),this.style.setLight(u,y),this._update(!0)},s.prototype.getLight=function(){return this.style.getLight()},s.prototype.setFeatureState=function(u,y){return this.style.setFeatureState(u,y),this._update()},s.prototype.removeFeatureState=function(u,y){return this.style.removeFeatureState(u,y),this._update()},s.prototype.getFeatureState=function(u){return this.style.getFeatureState(u)},s.prototype.getContainer=function(){return this._container},s.prototype.getCanvasContainer=function(){return this._canvasContainer},s.prototype.getCanvas=function(){return this._canvas},s.prototype._containerDimensions=function(){var u=0,y=0;return this._container&&(u=this._container.clientWidth||400,y=this._container.clientHeight||300),[u,y]},s.prototype._detectMissingCSS=function(){a.window.getComputedStyle(this._missingCSSCanary).getPropertyValue("background-color")!=="rgb(250, 128, 114)"&&a.warnOnce("This page appears to be missing CSS declarations for Mapbox GL JS, which may cause the map to display incorrectly. Please ensure your page includes mapbox-gl.css, as described in https://www.mapbox.com/mapbox-gl-js/api/.")},s.prototype._setupContainer=function(){var u=this._container;u.classList.add("mapboxgl-map"),(this._missingCSSCanary=T.create("div","mapboxgl-canary",u)).style.visibility="hidden",this._detectMissingCSS();var y=this._canvasContainer=T.create("div","mapboxgl-canvas-container",u);this._interactive&&y.classList.add("mapboxgl-interactive"),this._canvas=T.create("canvas","mapboxgl-canvas",y),this._canvas.addEventListener("webglcontextlost",this._contextLost,!1),this._canvas.addEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.setAttribute("tabindex","0"),this._canvas.setAttribute("aria-label","Map"),this._canvas.setAttribute("role","region");var w=this._containerDimensions();this._resizeCanvas(w[0],w[1]);var k=this._controlContainer=T.create("div","mapboxgl-control-container",u),E=this._controlPositions={};["top-left","top-right","bottom-left","bottom-right"].forEach(function(P){E[P]=T.create("div","mapboxgl-ctrl-"+P,k)}),this._container.addEventListener("scroll",this._onMapScroll,!1)},s.prototype._resizeCanvas=function(u,y){var w=a.browser.devicePixelRatio||1;this._canvas.width=w*u,this._canvas.height=w*y,this._canvas.style.width=u+"px",this._canvas.style.height=y+"px"},s.prototype._setupPainter=function(){var u=a.extend({},I.webGLContextAttributes,{failIfMajorPerformanceCaveat:this._failIfMajorPerformanceCaveat,preserveDrawingBuffer:this._preserveDrawingBuffer,antialias:this._antialias||!1}),y=this._canvas.getContext("webgl",u)||this._canvas.getContext("experimental-webgl",u);y?(this.painter=new Jr(y,this.transform),a.webpSupported.testSupport(y)):this.fire(new a.ErrorEvent(new Error("Failed to initialize WebGL")))},s.prototype._contextLost=function(u){u.preventDefault(),this._frame&&(this._frame.cancel(),this._frame=null),this.fire(new a.Event("webglcontextlost",{originalEvent:u}))},s.prototype._contextRestored=function(u){this._setupPainter(),this.resize(),this._update(),this.fire(new a.Event("webglcontextrestored",{originalEvent:u}))},s.prototype._onMapScroll=function(u){if(u.target===this._container)return this._container.scrollTop=0,this._container.scrollLeft=0,!1},s.prototype.loaded=function(){return!this._styleDirty&&!this._sourcesDirty&&!!this.style&&this.style.loaded()},s.prototype._update=function(u){return this.style?(this._styleDirty=this._styleDirty||u,this._sourcesDirty=!0,this.triggerRepaint(),this):this},s.prototype._requestRenderFrame=function(u){return this._update(),this._renderTaskQueue.add(u)},s.prototype._cancelRenderFrame=function(u){this._renderTaskQueue.remove(u)},s.prototype._render=function(u){var y,w=this,k=0,E=this.painter.context.extTimerQuery;if(this.listens("gpu-timing-frame")&&(y=E.createQueryEXT(),E.beginQueryEXT(E.TIME_ELAPSED_EXT,y),k=a.browser.now()),this.painter.context.setDirty(),this.painter.setBaseState(),this._renderTaskQueue.run(u),!this._removed){var P=!1;if(this.style&&this._styleDirty){this._styleDirty=!1;var O=this.transform.zoom,Z=a.browser.now();this.style.zoomHistory.update(O,Z);var G=new a.EvaluationParameters(O,{now:Z,fadeDuration:this._fadeDuration,zoomHistory:this.style.zoomHistory,transition:this.style.getTransition()}),X=G.crossFadingFactor();X===1&&X===this._crossFadingFactor||(P=!0,this._crossFadingFactor=X),this.style.update(G)}if(this.style&&this._sourcesDirty&&(this._sourcesDirty=!1,this.style._updateSources(this.transform)),this._placementDirty=this.style&&this.style._updatePlacement(this.painter.transform,this.showCollisionBoxes,this._fadeDuration,this._crossSourceCollisions),this.painter.render(this.style,{showTileBoundaries:this.showTileBoundaries,showOverdrawInspector:this._showOverdrawInspector,rotating:this.isRotating(),zooming:this.isZooming(),moving:this.isMoving(),fadeDuration:this._fadeDuration,showPadding:this.showPadding,gpuTiming:!!this.listens("gpu-timing-layer")}),this.fire(new a.Event("render")),this.loaded()&&!this._loaded&&(this._loaded=!0,this.fire(new a.Event("load"))),this.style&&(this.style.hasTransitions()||P)&&(this._styleDirty=!0),this.style&&!this._placementDirty&&this.style._releaseSymbolFadeTiles(),this.listens("gpu-timing-frame")){var re=a.browser.now()-k;E.endQueryEXT(E.TIME_ELAPSED_EXT,y),setTimeout(function(){var Y=E.getQueryObjectEXT(y,E.QUERY_RESULT_EXT)/1e6;E.deleteQueryEXT(y),w.fire(new a.Event("gpu-timing-frame",{cpuTime:re,gpuTime:Y}))},50)}if(this.listens("gpu-timing-layer")){var te=this.painter.collectGpuTimers();setTimeout(function(){var Y=w.painter.queryGpuTimers(te);w.fire(new a.Event("gpu-timing-layer",{layerTimes:Y}))},50)}var ue=this._sourcesDirty||this._styleDirty||this._placementDirty;return ue||this._repaint?this.triggerRepaint():!this.isMoving()&&this.loaded()&&this.fire(new a.Event("idle")),!this._loaded||this._fullyLoaded||ue||(this._fullyLoaded=!0),this}},s.prototype.remove=function(){this._hash&&this._hash.remove();for(var u=0,y=this._controls;u<y.length;u+=1)y[u].onRemove(this);this._controls=[],this._frame&&(this._frame.cancel(),this._frame=null),this._renderTaskQueue.clear(),this.painter.destroy(),this.handlers.destroy(),delete this.handlers,this.setStyle(null),a.window!==void 0&&(a.window.removeEventListener("resize",this._onWindowResize,!1),a.window.removeEventListener("orientationchange",this._onWindowResize,!1),a.window.removeEventListener("online",this._onWindowOnline,!1));var w=this.painter.context.gl.getExtension("WEBGL_lose_context");w&&w.loseContext(),zo(this._canvasContainer),zo(this._controlContainer),zo(this._missingCSSCanary),this._container.classList.remove("mapboxgl-map"),this._removed=!0,this.fire(new a.Event("remove"))},s.prototype.triggerRepaint=function(){var u=this;this.style&&!this._frame&&(this._frame=a.browser.frame(function(y){u._frame=null,u._render(y)}))},s.prototype._onWindowOnline=function(){this._update()},s.prototype._onWindowResize=function(u){this._trackResize&&this.resize({originalEvent:u})._update()},o.showTileBoundaries.get=function(){return!!this._showTileBoundaries},o.showTileBoundaries.set=function(u){this._showTileBoundaries!==u&&(this._showTileBoundaries=u,this._update())},o.showPadding.get=function(){return!!this._showPadding},o.showPadding.set=function(u){this._showPadding!==u&&(this._showPadding=u,this._update())},o.showCollisionBoxes.get=function(){return!!this._showCollisionBoxes},o.showCollisionBoxes.set=function(u){this._showCollisionBoxes!==u&&(this._showCollisionBoxes=u,u?this.style._generateCollisionBoxes():this._update())},o.showOverdrawInspector.get=function(){return!!this._showOverdrawInspector},o.showOverdrawInspector.set=function(u){this._showOverdrawInspector!==u&&(this._showOverdrawInspector=u,this._update())},o.repaint.get=function(){return!!this._repaint},o.repaint.set=function(u){this._repaint!==u&&(this._repaint=u,this.triggerRepaint())},o.vertices.get=function(){return!!this._vertices},o.vertices.set=function(u){this._vertices=u,this._update()},s.prototype._setCacheLimits=function(u,y){a.setCacheLimits(u,y)},o.version.get=function(){return a.version},Object.defineProperties(s.prototype,o),s}(el);function zo(n){n.parentNode&&n.parentNode.removeChild(n)}var iu={showCompass:!0,showZoom:!0,visualizePitch:!1},Ra=function(n){var s=this;this.options=a.extend({},iu,n),this._container=T.create("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._container.addEventListener("contextmenu",function(o){return o.preventDefault()}),this.options.showZoom&&(a.bindAll(["_setButtonTitle","_updateZoomButtons"],this),this._zoomInButton=this._createButton("mapboxgl-ctrl-zoom-in",function(o){return s._map.zoomIn({},{originalEvent:o})}),T.create("span","mapboxgl-ctrl-icon",this._zoomInButton).setAttribute("aria-hidden",!0),this._zoomOutButton=this._createButton("mapboxgl-ctrl-zoom-out",function(o){return s._map.zoomOut({},{originalEvent:o})}),T.create("span","mapboxgl-ctrl-icon",this._zoomOutButton).setAttribute("aria-hidden",!0)),this.options.showCompass&&(a.bindAll(["_rotateCompassArrow"],this),this._compass=this._createButton("mapboxgl-ctrl-compass",function(o){s.options.visualizePitch?s._map.resetNorthPitch({},{originalEvent:o}):s._map.resetNorth({},{originalEvent:o})}),this._compassIcon=T.create("span","mapboxgl-ctrl-icon",this._compass),this._compassIcon.setAttribute("aria-hidden",!0))};Ra.prototype._updateZoomButtons=function(){var n=this._map.getZoom(),s=n===this._map.getMaxZoom(),o=n===this._map.getMinZoom();this._zoomInButton.disabled=s,this._zoomOutButton.disabled=o,this._zoomInButton.setAttribute("aria-disabled",s.toString()),this._zoomOutButton.setAttribute("aria-disabled",o.toString())},Ra.prototype._rotateCompassArrow=function(){var n=this.options.visualizePitch?"scale("+1/Math.pow(Math.cos(this._map.transform.pitch*(Math.PI/180)),.5)+") rotateX("+this._map.transform.pitch+"deg) rotateZ("+this._map.transform.angle*(180/Math.PI)+"deg)":"rotate("+this._map.transform.angle*(180/Math.PI)+"deg)";this._compassIcon.style.transform=n},Ra.prototype.onAdd=function(n){return this._map=n,this.options.showZoom&&(this._setButtonTitle(this._zoomInButton,"ZoomIn"),this._setButtonTitle(this._zoomOutButton,"ZoomOut"),this._map.on("zoom",this._updateZoomButtons),this._updateZoomButtons()),this.options.showCompass&&(this._setButtonTitle(this._compass,"ResetBearing"),this.options.visualizePitch&&this._map.on("pitch",this._rotateCompassArrow),this._map.on("rotate",this._rotateCompassArrow),this._rotateCompassArrow(),this._handler=new Zn(this._map,this._compass,this.options.visualizePitch)),this._container},Ra.prototype.onRemove=function(){T.remove(this._container),this.options.showZoom&&this._map.off("zoom",this._updateZoomButtons),this.options.showCompass&&(this.options.visualizePitch&&this._map.off("pitch",this._rotateCompassArrow),this._map.off("rotate",this._rotateCompassArrow),this._handler.off(),delete this._handler),delete this._map},Ra.prototype._createButton=function(n,s){var o=T.create("button",n,this._container);return o.type="button",o.addEventListener("click",s),o},Ra.prototype._setButtonTitle=function(n,s){var o=this._map._getUIString("NavigationControl."+s);n.title=o,n.setAttribute("aria-label",o)};var Zn=function(n,s,o){o===void 0&&(o=!1),this._clickTolerance=10,this.element=s,this.mouseRotate=new Ys({clickTolerance:n.dragRotate._mouseRotate._clickTolerance}),this.map=n,o&&(this.mousePitch=new $l({clickTolerance:n.dragRotate._mousePitch._clickTolerance})),a.bindAll(["mousedown","mousemove","mouseup","touchstart","touchmove","touchend","reset"],this),T.addEventListener(s,"mousedown",this.mousedown),T.addEventListener(s,"touchstart",this.touchstart,{passive:!1}),T.addEventListener(s,"touchmove",this.touchmove),T.addEventListener(s,"touchend",this.touchend),T.addEventListener(s,"touchcancel",this.reset)};function Xo(n,s,o){if(n=new a.LngLat(n.lng,n.lat),s){var u=new a.LngLat(n.lng-360,n.lat),y=new a.LngLat(n.lng+360,n.lat),w=o.locationPoint(n).distSqr(s);o.locationPoint(u).distSqr(s)<w?n=u:o.locationPoint(y).distSqr(s)<w&&(n=y)}for(;Math.abs(n.lng-o.center.lng)>180;){var k=o.locationPoint(n);if(k.x>=0&&k.y>=0&&k.x<=o.width&&k.y<=o.height)break;n.lng>o.center.lng?n.lng-=360:n.lng+=360}return n}Zn.prototype.down=function(n,s){this.mouseRotate.mousedown(n,s),this.mousePitch&&this.mousePitch.mousedown(n,s),T.disableDrag()},Zn.prototype.move=function(n,s){var o=this.map,u=this.mouseRotate.mousemoveWindow(n,s);if(u&&u.bearingDelta&&o.setBearing(o.getBearing()+u.bearingDelta),this.mousePitch){var y=this.mousePitch.mousemoveWindow(n,s);y&&y.pitchDelta&&o.setPitch(o.getPitch()+y.pitchDelta)}},Zn.prototype.off=function(){var n=this.element;T.removeEventListener(n,"mousedown",this.mousedown),T.removeEventListener(n,"touchstart",this.touchstart,{passive:!1}),T.removeEventListener(n,"touchmove",this.touchmove),T.removeEventListener(n,"touchend",this.touchend),T.removeEventListener(n,"touchcancel",this.reset),this.offTemp()},Zn.prototype.offTemp=function(){T.enableDrag(),T.removeEventListener(a.window,"mousemove",this.mousemove),T.removeEventListener(a.window,"mouseup",this.mouseup)},Zn.prototype.mousedown=function(n){this.down(a.extend({},n,{ctrlKey:!0,preventDefault:function(){return n.preventDefault()}}),T.mousePos(this.element,n)),T.addEventListener(a.window,"mousemove",this.mousemove),T.addEventListener(a.window,"mouseup",this.mouseup)},Zn.prototype.mousemove=function(n){this.move(n,T.mousePos(this.element,n))},Zn.prototype.mouseup=function(n){this.mouseRotate.mouseupWindow(n),this.mousePitch&&this.mousePitch.mouseupWindow(n),this.offTemp()},Zn.prototype.touchstart=function(n){n.targetTouches.length!==1?this.reset():(this._startPos=this._lastPos=T.touchPos(this.element,n.targetTouches)[0],this.down({type:"mousedown",button:0,ctrlKey:!0,preventDefault:function(){return n.preventDefault()}},this._startPos))},Zn.prototype.touchmove=function(n){n.targetTouches.length!==1?this.reset():(this._lastPos=T.touchPos(this.element,n.targetTouches)[0],this.move({preventDefault:function(){return n.preventDefault()}},this._lastPos))},Zn.prototype.touchend=function(n){n.targetTouches.length===0&&this._startPos&&this._lastPos&&this._startPos.dist(this._lastPos)<this._clickTolerance&&this.element.click(),this.reset()},Zn.prototype.reset=function(){this.mouseRotate.reset(),this.mousePitch&&this.mousePitch.reset(),delete this._startPos,delete this._lastPos,this.offTemp()};var Ta={center:"translate(-50%,-50%)",top:"translate(-50%,0)","top-left":"translate(0,0)","top-right":"translate(-100%,0)",bottom:"translate(-50%,-100%)","bottom-left":"translate(0,-100%)","bottom-right":"translate(-100%,-100%)",left:"translate(0,-50%)",right:"translate(-100%,-50%)"};function rl(n,s,o){var u=n.classList;for(var y in Ta)u.remove("mapboxgl-"+o+"-anchor-"+y);u.add("mapboxgl-"+o+"-anchor-"+s)}var Wo,ks=function(n){function s(o,u){if(n.call(this),(o instanceof a.window.HTMLElement||u)&&(o=a.extend({element:o},u)),a.bindAll(["_update","_onMove","_onUp","_addDragHandler","_onMapClick","_onKeyPress"],this),this._anchor=o&&o.anchor||"center",this._color=o&&o.color||"#3FB1CE",this._scale=o&&o.scale||1,this._draggable=o&&o.draggable||!1,this._clickTolerance=o&&o.clickTolerance||0,this._isDragging=!1,this._state="inactive",this._rotation=o&&o.rotation||0,this._rotationAlignment=o&&o.rotationAlignment||"auto",this._pitchAlignment=o&&o.pitchAlignment&&o.pitchAlignment!=="auto"?o.pitchAlignment:this._rotationAlignment,o&&o.element)this._element=o.element,this._offset=a.Point.convert(o&&o.offset||[0,0]);else{this._defaultMarker=!0,this._element=T.create("div"),this._element.setAttribute("aria-label","Map marker");var y=T.createNS("http://www.w3.org/2000/svg","svg");y.setAttributeNS(null,"display","block"),y.setAttributeNS(null,"height","41px"),y.setAttributeNS(null,"width","27px"),y.setAttributeNS(null,"viewBox","0 0 27 41");var w=T.createNS("http://www.w3.org/2000/svg","g");w.setAttributeNS(null,"stroke","none"),w.setAttributeNS(null,"stroke-width","1"),w.setAttributeNS(null,"fill","none"),w.setAttributeNS(null,"fill-rule","evenodd");var k=T.createNS("http://www.w3.org/2000/svg","g");k.setAttributeNS(null,"fill-rule","nonzero");var E=T.createNS("http://www.w3.org/2000/svg","g");E.setAttributeNS(null,"transform","translate(3.0, 29.0)"),E.setAttributeNS(null,"fill","#000000");for(var P=0,O=[{rx:"10.5",ry:"5.25002273"},{rx:"10.5",ry:"5.25002273"},{rx:"9.5",ry:"4.77275007"},{rx:"8.5",ry:"4.29549936"},{rx:"7.5",ry:"3.81822308"},{rx:"6.5",ry:"3.34094679"},{rx:"5.5",ry:"2.86367051"},{rx:"4.5",ry:"2.38636864"}];P<O.length;P+=1){var Z=O[P],G=T.createNS("http://www.w3.org/2000/svg","ellipse");G.setAttributeNS(null,"opacity","0.04"),G.setAttributeNS(null,"cx","10.5"),G.setAttributeNS(null,"cy","5.80029008"),G.setAttributeNS(null,"rx",Z.rx),G.setAttributeNS(null,"ry",Z.ry),E.appendChild(G)}var X=T.createNS("http://www.w3.org/2000/svg","g");X.setAttributeNS(null,"fill",this._color);var re=T.createNS("http://www.w3.org/2000/svg","path");re.setAttributeNS(null,"d","M27,13.5 C27,19.074644 20.250001,27.000002 14.75,34.500002 C14.016665,35.500004 12.983335,35.500004 12.25,34.500002 C6.7499993,27.000002 0,19.222562 0,13.5 C0,6.0441559 6.0441559,0 13.5,0 C20.955844,0 27,6.0441559 27,13.5 Z"),X.appendChild(re);var te=T.createNS("http://www.w3.org/2000/svg","g");te.setAttributeNS(null,"opacity","0.25"),te.setAttributeNS(null,"fill","#000000");var ue=T.createNS("http://www.w3.org/2000/svg","path");ue.setAttributeNS(null,"d","M13.5,0 C6.0441559,0 0,6.0441559 0,13.5 C0,19.222562 6.7499993,27 12.25,34.5 C13,35.522727 14.016664,35.500004 14.75,34.5 C20.250001,27 27,19.074644 27,13.5 C27,6.0441559 20.955844,0 13.5,0 Z M13.5,1 C20.415404,1 26,6.584596 26,13.5 C26,15.898657 24.495584,19.181431 22.220703,22.738281 C19.945823,26.295132 16.705119,30.142167 13.943359,33.908203 C13.743445,34.180814 13.612715,34.322738 13.5,34.441406 C13.387285,34.322738 13.256555,34.180814 13.056641,33.908203 C10.284481,30.127985 7.4148684,26.314159 5.015625,22.773438 C2.6163816,19.232715 1,15.953538 1,13.5 C1,6.584596 6.584596,1 13.5,1 Z"),te.appendChild(ue);var Y=T.createNS("http://www.w3.org/2000/svg","g");Y.setAttributeNS(null,"transform","translate(6.0, 7.0)"),Y.setAttributeNS(null,"fill","#FFFFFF");var le=T.createNS("http://www.w3.org/2000/svg","g");le.setAttributeNS(null,"transform","translate(8.0, 8.0)");var pe=T.createNS("http://www.w3.org/2000/svg","circle");pe.setAttributeNS(null,"fill","#000000"),pe.setAttributeNS(null,"opacity","0.25"),pe.setAttributeNS(null,"cx","5.5"),pe.setAttributeNS(null,"cy","5.5"),pe.setAttributeNS(null,"r","5.4999962");var ge=T.createNS("http://www.w3.org/2000/svg","circle");ge.setAttributeNS(null,"fill","#FFFFFF"),ge.setAttributeNS(null,"cx","5.5"),ge.setAttributeNS(null,"cy","5.5"),ge.setAttributeNS(null,"r","5.4999962"),le.appendChild(pe),le.appendChild(ge),k.appendChild(E),k.appendChild(X),k.appendChild(te),k.appendChild(Y),k.appendChild(le),y.appendChild(k),y.setAttributeNS(null,"height",41*this._scale+"px"),y.setAttributeNS(null,"width",27*this._scale+"px"),this._element.appendChild(y),this._offset=a.Point.convert(o&&o.offset||[0,-14])}this._element.classList.add("mapboxgl-marker"),this._element.addEventListener("dragstart",function(ze){ze.preventDefault()}),this._element.addEventListener("mousedown",function(ze){ze.preventDefault()}),rl(this._element,this._anchor,"marker"),this._popup=null}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype.addTo=function(o){return this.remove(),this._map=o,o.getCanvasContainer().appendChild(this._element),o.on("move",this._update),o.on("moveend",this._update),this.setDraggable(this._draggable),this._update(),this._map.on("click",this._onMapClick),this},s.prototype.remove=function(){return this._map&&(this._map.off("click",this._onMapClick),this._map.off("move",this._update),this._map.off("moveend",this._update),this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler),this._map.off("mouseup",this._onUp),this._map.off("touchend",this._onUp),this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),delete this._map),T.remove(this._element),this._popup&&this._popup.remove(),this},s.prototype.getLngLat=function(){return this._lngLat},s.prototype.setLngLat=function(o){return this._lngLat=a.LngLat.convert(o),this._pos=null,this._popup&&this._popup.setLngLat(this._lngLat),this._update(),this},s.prototype.getElement=function(){return this._element},s.prototype.setPopup=function(o){if(this._popup&&(this._popup.remove(),this._popup=null,this._element.removeEventListener("keypress",this._onKeyPress),this._originalTabIndex||this._element.removeAttribute("tabindex")),o){if(!("offset"in o.options)){var u=Math.sqrt(Math.pow(13.5,2)/2);o.options.offset=this._defaultMarker?{top:[0,0],"top-left":[0,0],"top-right":[0,0],bottom:[0,-38.1],"bottom-left":[u,-1*(24.6+u)],"bottom-right":[-u,-1*(24.6+u)],left:[13.5,-24.6],right:[-13.5,-24.6]}:this._offset}this._popup=o,this._lngLat&&this._popup.setLngLat(this._lngLat),this._originalTabIndex=this._element.getAttribute("tabindex"),this._originalTabIndex||this._element.setAttribute("tabindex","0"),this._element.addEventListener("keypress",this._onKeyPress)}return this},s.prototype._onKeyPress=function(o){var u=o.code,y=o.charCode||o.keyCode;u!=="Space"&&u!=="Enter"&&y!==32&&y!==13||this.togglePopup()},s.prototype._onMapClick=function(o){var u=o.originalEvent.target,y=this._element;this._popup&&(u===y||y.contains(u))&&this.togglePopup()},s.prototype.getPopup=function(){return this._popup},s.prototype.togglePopup=function(){var o=this._popup;return o?(o.isOpen()?o.remove():o.addTo(this._map),this):this},s.prototype._update=function(o){if(this._map){this._map.transform.renderWorldCopies&&(this._lngLat=Xo(this._lngLat,this._pos,this._map.transform)),this._pos=this._map.project(this._lngLat)._add(this._offset);var u="";this._rotationAlignment==="viewport"||this._rotationAlignment==="auto"?u="rotateZ("+this._rotation+"deg)":this._rotationAlignment==="map"&&(u="rotateZ("+(this._rotation-this._map.getBearing())+"deg)");var y="";this._pitchAlignment==="viewport"||this._pitchAlignment==="auto"?y="rotateX(0deg)":this._pitchAlignment==="map"&&(y="rotateX("+this._map.getPitch()+"deg)"),o&&o.type!=="moveend"||(this._pos=this._pos.round()),T.setTransform(this._element,Ta[this._anchor]+" translate("+this._pos.x+"px, "+this._pos.y+"px) "+y+" "+u)}},s.prototype.getOffset=function(){return this._offset},s.prototype.setOffset=function(o){return this._offset=a.Point.convert(o),this._update(),this},s.prototype._onMove=function(o){if(!this._isDragging){var u=this._clickTolerance||this._map._clickTolerance;this._isDragging=o.point.dist(this._pointerdownPos)>=u}this._isDragging&&(this._pos=o.point.sub(this._positionDelta),this._lngLat=this._map.unproject(this._pos),this.setLngLat(this._lngLat),this._element.style.pointerEvents="none",this._state==="pending"&&(this._state="active",this.fire(new a.Event("dragstart"))),this.fire(new a.Event("drag")))},s.prototype._onUp=function(){this._element.style.pointerEvents="auto",this._positionDelta=null,this._pointerdownPos=null,this._isDragging=!1,this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),this._state==="active"&&this.fire(new a.Event("dragend")),this._state="inactive"},s.prototype._addDragHandler=function(o){this._element.contains(o.originalEvent.target)&&(o.preventDefault(),this._positionDelta=o.point.sub(this._pos).add(this._offset),this._pointerdownPos=o.point,this._state="pending",this._map.on("mousemove",this._onMove),this._map.on("touchmove",this._onMove),this._map.once("mouseup",this._onUp),this._map.once("touchend",this._onUp))},s.prototype.setDraggable=function(o){return this._draggable=!!o,this._map&&(o?(this._map.on("mousedown",this._addDragHandler),this._map.on("touchstart",this._addDragHandler)):(this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler))),this},s.prototype.isDraggable=function(){return this._draggable},s.prototype.setRotation=function(o){return this._rotation=o||0,this._update(),this},s.prototype.getRotation=function(){return this._rotation},s.prototype.setRotationAlignment=function(o){return this._rotationAlignment=o||"auto",this._update(),this},s.prototype.getRotationAlignment=function(){return this._rotationAlignment},s.prototype.setPitchAlignment=function(o){return this._pitchAlignment=o&&o!=="auto"?o:this._rotationAlignment,this._update(),this},s.prototype.getPitchAlignment=function(){return this._pitchAlignment},s}(a.Evented),nu={positionOptions:{enableHighAccuracy:!1,maximumAge:0,timeout:6e3},fitBoundsOptions:{maxZoom:15},trackUserLocation:!1,showAccuracyCircle:!0,showUserLocation:!0},Ho=0,Ao=!1,au=function(n){function s(o){n.call(this),this.options=a.extend({},nu,o),a.bindAll(["_onSuccess","_onError","_onZoom","_finish","_setupUI","_updateCamera","_updateMarker"],this)}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype.onAdd=function(o){var u;return this._map=o,this._container=T.create("div","mapboxgl-ctrl mapboxgl-ctrl-group"),u=this._setupUI,Wo!==void 0?u(Wo):a.window.navigator.permissions!==void 0?a.window.navigator.permissions.query({name:"geolocation"}).then(function(y){u(Wo=y.state!=="denied")}):u(Wo=!!a.window.navigator.geolocation),this._container},s.prototype.onRemove=function(){this._geolocationWatchID!==void 0&&(a.window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0),this.options.showUserLocation&&this._userLocationDotMarker&&this._userLocationDotMarker.remove(),this.options.showAccuracyCircle&&this._accuracyCircleMarker&&this._accuracyCircleMarker.remove(),T.remove(this._container),this._map.off("zoom",this._onZoom),this._map=void 0,Ho=0,Ao=!1},s.prototype._isOutOfMapMaxBounds=function(o){var u=this._map.getMaxBounds(),y=o.coords;return u&&(y.longitude<u.getWest()||y.longitude>u.getEast()||y.latitude<u.getSouth()||y.latitude>u.getNorth())},s.prototype._setErrorState=function(){switch(this._watchState){case"WAITING_ACTIVE":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error");break;case"ACTIVE_LOCK":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting");break;case"BACKGROUND":this._watchState="BACKGROUND_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting")}},s.prototype._onSuccess=function(o){if(this._map){if(this._isOutOfMapMaxBounds(o))return this._setErrorState(),this.fire(new a.Event("outofmaxbounds",o)),this._updateMarker(),void this._finish();if(this.options.trackUserLocation)switch(this._lastKnownPosition=o,this._watchState){case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"BACKGROUND":case"BACKGROUND_ERROR":this._watchState="BACKGROUND",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background")}this.options.showUserLocation&&this._watchState!=="OFF"&&this._updateMarker(o),this.options.trackUserLocation&&this._watchState!=="ACTIVE_LOCK"||this._updateCamera(o),this.options.showUserLocation&&this._dotElement.classList.remove("mapboxgl-user-location-dot-stale"),this.fire(new a.Event("geolocate",o)),this._finish()}},s.prototype._updateCamera=function(o){var u=new a.LngLat(o.coords.longitude,o.coords.latitude),y=o.coords.accuracy,w=this._map.getBearing(),k=a.extend({bearing:w},this.options.fitBoundsOptions);this._map.fitBounds(u.toBounds(y),k,{geolocateSource:!0})},s.prototype._updateMarker=function(o){if(o){var u=new a.LngLat(o.coords.longitude,o.coords.latitude);this._accuracyCircleMarker.setLngLat(u).addTo(this._map),this._userLocationDotMarker.setLngLat(u).addTo(this._map),this._accuracy=o.coords.accuracy,this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}else this._userLocationDotMarker.remove(),this._accuracyCircleMarker.remove()},s.prototype._updateCircleRadius=function(){var o=this._map._container.clientHeight/2,u=this._map.unproject([0,o]),y=this._map.unproject([1,o]),w=u.distanceTo(y),k=Math.ceil(2*this._accuracy/w);this._circleElement.style.width=k+"px",this._circleElement.style.height=k+"px"},s.prototype._onZoom=function(){this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()},s.prototype._onError=function(o){if(this._map){if(this.options.trackUserLocation)if(o.code===1){this._watchState="OFF",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.disabled=!0;var u=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.title=u,this._geolocateButton.setAttribute("aria-label",u),this._geolocationWatchID!==void 0&&this._clearWatch()}else{if(o.code===3&&Ao)return;this._setErrorState()}this._watchState!=="OFF"&&this.options.showUserLocation&&this._dotElement.classList.add("mapboxgl-user-location-dot-stale"),this.fire(new a.Event("error",o)),this._finish()}},s.prototype._finish=function(){this._timeoutId&&clearTimeout(this._timeoutId),this._timeoutId=void 0},s.prototype._setupUI=function(o){var u=this;if(this._container.addEventListener("contextmenu",function(k){return k.preventDefault()}),this._geolocateButton=T.create("button","mapboxgl-ctrl-geolocate",this._container),T.create("span","mapboxgl-ctrl-icon",this._geolocateButton).setAttribute("aria-hidden",!0),this._geolocateButton.type="button",o===!1){a.warnOnce("Geolocation support is not available so the GeolocateControl will be disabled.");var y=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.disabled=!0,this._geolocateButton.title=y,this._geolocateButton.setAttribute("aria-label",y)}else{var w=this._map._getUIString("GeolocateControl.FindMyLocation");this._geolocateButton.title=w,this._geolocateButton.setAttribute("aria-label",w)}this.options.trackUserLocation&&(this._geolocateButton.setAttribute("aria-pressed","false"),this._watchState="OFF"),this.options.showUserLocation&&(this._dotElement=T.create("div","mapboxgl-user-location-dot"),this._userLocationDotMarker=new ks(this._dotElement),this._circleElement=T.create("div","mapboxgl-user-location-accuracy-circle"),this._accuracyCircleMarker=new ks({element:this._circleElement,pitchAlignment:"map"}),this.options.trackUserLocation&&(this._watchState="OFF"),this._map.on("zoom",this._onZoom)),this._geolocateButton.addEventListener("click",this.trigger.bind(this)),this._setup=!0,this.options.trackUserLocation&&this._map.on("movestart",function(k){k.geolocateSource||u._watchState!=="ACTIVE_LOCK"||k.originalEvent&&k.originalEvent.type==="resize"||(u._watchState="BACKGROUND",u._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background"),u._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),u.fire(new a.Event("trackuserlocationend")))})},s.prototype.trigger=function(){if(!this._setup)return a.warnOnce("Geolocate control triggered before added to a map"),!1;if(this.options.trackUserLocation){switch(this._watchState){case"OFF":this._watchState="WAITING_ACTIVE",this.fire(new a.Event("trackuserlocationstart"));break;case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":case"BACKGROUND_ERROR":Ho--,Ao=!1,this._watchState="OFF",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this.fire(new a.Event("trackuserlocationend"));break;case"BACKGROUND":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._lastKnownPosition&&this._updateCamera(this._lastKnownPosition),this.fire(new a.Event("trackuserlocationstart"))}switch(this._watchState){case"WAITING_ACTIVE":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"ACTIVE_LOCK":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"ACTIVE_ERROR":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error");break;case"BACKGROUND":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background");break;case"BACKGROUND_ERROR":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background-error")}if(this._watchState==="OFF"&&this._geolocationWatchID!==void 0)this._clearWatch();else if(this._geolocationWatchID===void 0){var o;this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","true"),++Ho>1?(o={maximumAge:6e5,timeout:0},Ao=!0):(o=this.options.positionOptions,Ao=!1),this._geolocationWatchID=a.window.navigator.geolocation.watchPosition(this._onSuccess,this._onError,o)}}else a.window.navigator.geolocation.getCurrentPosition(this._onSuccess,this._onError,this.options.positionOptions),this._timeoutId=setTimeout(this._finish,1e4);return!0},s.prototype._clearWatch=function(){a.window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0,this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","false"),this.options.showUserLocation&&this._updateMarker(null)},s}(a.Evented),Qa={maxWidth:100,unit:"metric"},$a=function(n){this.options=a.extend({},Qa,n),a.bindAll(["_onMove","setUnit"],this)};function il(n,s,o){var u=o&&o.maxWidth||100,y=n._container.clientHeight/2,w=n.unproject([0,y]),k=n.unproject([u,y]),E=w.distanceTo(k);if(o&&o.unit==="imperial"){var P=3.2808*E;P>5280?eo(s,u,P/5280,n._getUIString("ScaleControl.Miles")):eo(s,u,P,n._getUIString("ScaleControl.Feet"))}else o&&o.unit==="nautical"?eo(s,u,E/1852,n._getUIString("ScaleControl.NauticalMiles")):E>=1e3?eo(s,u,E/1e3,n._getUIString("ScaleControl.Kilometers")):eo(s,u,E,n._getUIString("ScaleControl.Meters"))}function eo(n,s,o,u){var y,w,k,E=(y=o,(w=Math.pow(10,(""+Math.floor(y)).length-1))*(k=(k=y/w)>=10?10:k>=5?5:k>=3?3:k>=2?2:k>=1?1:function(P){var O=Math.pow(10,Math.ceil(-Math.log(P)/Math.LN10));return Math.round(P*O)/O}(k)));n.style.width=s*(E/o)+"px",n.innerHTML=E+"&nbsp;"+u}$a.prototype.getDefaultPosition=function(){return"bottom-left"},$a.prototype._onMove=function(){il(this._map,this._container,this.options)},$a.prototype.onAdd=function(n){return this._map=n,this._container=T.create("div","mapboxgl-ctrl mapboxgl-ctrl-scale",n.getContainer()),this._map.on("move",this._onMove),this._onMove(),this._container},$a.prototype.onRemove=function(){T.remove(this._container),this._map.off("move",this._onMove),this._map=void 0},$a.prototype.setUnit=function(n){this.options.unit=n,il(this._map,this._container,this.options)};var aa=function(n){this._fullscreen=!1,n&&n.container&&(n.container instanceof a.window.HTMLElement?this._container=n.container:a.warnOnce("Full screen control 'container' must be a DOM element.")),a.bindAll(["_onClickFullscreen","_changeIcon"],this),"onfullscreenchange"in a.window.document?this._fullscreenchange="fullscreenchange":"onmozfullscreenchange"in a.window.document?this._fullscreenchange="mozfullscreenchange":"onwebkitfullscreenchange"in a.window.document?this._fullscreenchange="webkitfullscreenchange":"onmsfullscreenchange"in a.window.document&&(this._fullscreenchange="MSFullscreenChange")};aa.prototype.onAdd=function(n){return this._map=n,this._container||(this._container=this._map.getContainer()),this._controlContainer=T.create("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._checkFullscreenSupport()?this._setupUI():(this._controlContainer.style.display="none",a.warnOnce("This device does not support fullscreen mode.")),this._controlContainer},aa.prototype.onRemove=function(){T.remove(this._controlContainer),this._map=null,a.window.document.removeEventListener(this._fullscreenchange,this._changeIcon)},aa.prototype._checkFullscreenSupport=function(){return!!(a.window.document.fullscreenEnabled||a.window.document.mozFullScreenEnabled||a.window.document.msFullscreenEnabled||a.window.document.webkitFullscreenEnabled)},aa.prototype._setupUI=function(){var n=this._fullscreenButton=T.create("button","mapboxgl-ctrl-fullscreen",this._controlContainer);T.create("span","mapboxgl-ctrl-icon",n).setAttribute("aria-hidden",!0),n.type="button",this._updateTitle(),this._fullscreenButton.addEventListener("click",this._onClickFullscreen),a.window.document.addEventListener(this._fullscreenchange,this._changeIcon)},aa.prototype._updateTitle=function(){var n=this._getTitle();this._fullscreenButton.setAttribute("aria-label",n),this._fullscreenButton.title=n},aa.prototype._getTitle=function(){return this._map._getUIString(this._isFullscreen()?"FullscreenControl.Exit":"FullscreenControl.Enter")},aa.prototype._isFullscreen=function(){return this._fullscreen},aa.prototype._changeIcon=function(){(a.window.document.fullscreenElement||a.window.document.mozFullScreenElement||a.window.document.webkitFullscreenElement||a.window.document.msFullscreenElement)===this._container!==this._fullscreen&&(this._fullscreen=!this._fullscreen,this._fullscreenButton.classList.toggle("mapboxgl-ctrl-shrink"),this._fullscreenButton.classList.toggle("mapboxgl-ctrl-fullscreen"),this._updateTitle())},aa.prototype._onClickFullscreen=function(){this._isFullscreen()?a.window.document.exitFullscreen?a.window.document.exitFullscreen():a.window.document.mozCancelFullScreen?a.window.document.mozCancelFullScreen():a.window.document.msExitFullscreen?a.window.document.msExitFullscreen():a.window.document.webkitCancelFullScreen&&a.window.document.webkitCancelFullScreen():this._container.requestFullscreen?this._container.requestFullscreen():this._container.mozRequestFullScreen?this._container.mozRequestFullScreen():this._container.msRequestFullscreen?this._container.msRequestFullscreen():this._container.webkitRequestFullscreen&&this._container.webkitRequestFullscreen()};var ou={closeButton:!0,closeOnClick:!0,focusAfterOpen:!0,className:"",maxWidth:"240px"},Ss=["a[href]","[tabindex]:not([tabindex='-1'])","[contenteditable]:not([contenteditable='false'])","button:not([disabled])","input:not([disabled])","select:not([disabled])","textarea:not([disabled])"].join(", "),su=function(n){function s(o){n.call(this),this.options=a.extend(Object.create(ou),o),a.bindAll(["_update","_onClose","remove","_onMouseMove","_onMouseUp","_onDrag"],this)}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype.addTo=function(o){return this._map&&this.remove(),this._map=o,this.options.closeOnClick&&this._map.on("click",this._onClose),this.options.closeOnMove&&this._map.on("move",this._onClose),this._map.on("remove",this.remove),this._update(),this._focusFirstElement(),this._trackPointer?(this._map.on("mousemove",this._onMouseMove),this._map.on("mouseup",this._onMouseUp),this._container&&this._container.classList.add("mapboxgl-popup-track-pointer"),this._map._canvasContainer.classList.add("mapboxgl-track-pointer")):this._map.on("move",this._update),this.fire(new a.Event("open")),this},s.prototype.isOpen=function(){return!!this._map},s.prototype.remove=function(){return this._content&&T.remove(this._content),this._container&&(T.remove(this._container),delete this._container),this._map&&(this._map.off("move",this._update),this._map.off("move",this._onClose),this._map.off("click",this._onClose),this._map.off("remove",this.remove),this._map.off("mousemove",this._onMouseMove),this._map.off("mouseup",this._onMouseUp),this._map.off("drag",this._onDrag),delete this._map),this.fire(new a.Event("close")),this},s.prototype.getLngLat=function(){return this._lngLat},s.prototype.setLngLat=function(o){return this._lngLat=a.LngLat.convert(o),this._pos=null,this._trackPointer=!1,this._update(),this._map&&(this._map.on("move",this._update),this._map.off("mousemove",this._onMouseMove),this._container&&this._container.classList.remove("mapboxgl-popup-track-pointer"),this._map._canvasContainer.classList.remove("mapboxgl-track-pointer")),this},s.prototype.trackPointer=function(){return this._trackPointer=!0,this._pos=null,this._update(),this._map&&(this._map.off("move",this._update),this._map.on("mousemove",this._onMouseMove),this._map.on("drag",this._onDrag),this._container&&this._container.classList.add("mapboxgl-popup-track-pointer"),this._map._canvasContainer.classList.add("mapboxgl-track-pointer")),this},s.prototype.getElement=function(){return this._container},s.prototype.setText=function(o){return this.setDOMContent(a.window.document.createTextNode(o))},s.prototype.setHTML=function(o){var u,y=a.window.document.createDocumentFragment(),w=a.window.document.createElement("body");for(w.innerHTML=o;u=w.firstChild;)y.appendChild(u);return this.setDOMContent(y)},s.prototype.getMaxWidth=function(){return this._container&&this._container.style.maxWidth},s.prototype.setMaxWidth=function(o){return this.options.maxWidth=o,this._update(),this},s.prototype.setDOMContent=function(o){if(this._content)for(;this._content.hasChildNodes();)this._content.firstChild&&this._content.removeChild(this._content.firstChild);else this._content=T.create("div","mapboxgl-popup-content",this._container);return this._content.appendChild(o),this._createCloseButton(),this._update(),this._focusFirstElement(),this},s.prototype.addClassName=function(o){this._container&&this._container.classList.add(o)},s.prototype.removeClassName=function(o){this._container&&this._container.classList.remove(o)},s.prototype.setOffset=function(o){return this.options.offset=o,this._update(),this},s.prototype.toggleClassName=function(o){if(this._container)return this._container.classList.toggle(o)},s.prototype._createCloseButton=function(){this.options.closeButton&&(this._closeButton=T.create("button","mapboxgl-popup-close-button",this._content),this._closeButton.type="button",this._closeButton.setAttribute("aria-label","Close popup"),this._closeButton.innerHTML="&#215;",this._closeButton.addEventListener("click",this._onClose))},s.prototype._onMouseUp=function(o){this._update(o.point)},s.prototype._onMouseMove=function(o){this._update(o.point)},s.prototype._onDrag=function(o){this._update(o.point)},s.prototype._update=function(o){var u=this;if(this._map&&(this._lngLat||this._trackPointer)&&this._content&&(this._container||(this._container=T.create("div","mapboxgl-popup",this._map.getContainer()),this._tip=T.create("div","mapboxgl-popup-tip",this._container),this._container.appendChild(this._content),this.options.className&&this.options.className.split(" ").forEach(function(G){return u._container.classList.add(G)}),this._trackPointer&&this._container.classList.add("mapboxgl-popup-track-pointer")),this.options.maxWidth&&this._container.style.maxWidth!==this.options.maxWidth&&(this._container.style.maxWidth=this.options.maxWidth),this._map.transform.renderWorldCopies&&!this._trackPointer&&(this._lngLat=Xo(this._lngLat,this._pos,this._map.transform)),!this._trackPointer||o)){var y=this._pos=this._trackPointer&&o?o:this._map.project(this._lngLat),w=this.options.anchor,k=function G(X){if(X){if(typeof X=="number"){var re=Math.round(Math.sqrt(.5*Math.pow(X,2)));return{center:new a.Point(0,0),top:new a.Point(0,X),"top-left":new a.Point(re,re),"top-right":new a.Point(-re,re),bottom:new a.Point(0,-X),"bottom-left":new a.Point(re,-re),"bottom-right":new a.Point(-re,-re),left:new a.Point(X,0),right:new a.Point(-X,0)}}if(X instanceof a.Point||Array.isArray(X)){var te=a.Point.convert(X);return{center:te,top:te,"top-left":te,"top-right":te,bottom:te,"bottom-left":te,"bottom-right":te,left:te,right:te}}return{center:a.Point.convert(X.center||[0,0]),top:a.Point.convert(X.top||[0,0]),"top-left":a.Point.convert(X["top-left"]||[0,0]),"top-right":a.Point.convert(X["top-right"]||[0,0]),bottom:a.Point.convert(X.bottom||[0,0]),"bottom-left":a.Point.convert(X["bottom-left"]||[0,0]),"bottom-right":a.Point.convert(X["bottom-right"]||[0,0]),left:a.Point.convert(X.left||[0,0]),right:a.Point.convert(X.right||[0,0])}}return G(new a.Point(0,0))}(this.options.offset);if(!w){var E,P=this._container.offsetWidth,O=this._container.offsetHeight;E=y.y+k.bottom.y<O?["top"]:y.y>this._map.transform.height-O?["bottom"]:[],y.x<P/2?E.push("left"):y.x>this._map.transform.width-P/2&&E.push("right"),w=E.length===0?"bottom":E.join("-")}var Z=y.add(k[w]).round();T.setTransform(this._container,Ta[w]+" translate("+Z.x+"px,"+Z.y+"px)"),rl(this._container,w,"popup")}},s.prototype._focusFirstElement=function(){if(this.options.focusAfterOpen&&this._container){var o=this._container.querySelector(Ss);o&&o.focus()}},s.prototype._onClose=function(){this.remove()},s}(a.Evented),nl={version:a.version,supported:I,setRTLTextPlugin:a.setRTLTextPlugin,getRTLTextPluginStatus:a.getRTLTextPluginStatus,Map:zc,NavigationControl:Ra,GeolocateControl:au,AttributionControl:kn,ScaleControl:$a,FullscreenControl:aa,Popup:su,Marker:ks,Style:Nn,LngLat:a.LngLat,LngLatBounds:a.LngLatBounds,Point:a.Point,MercatorCoordinate:a.MercatorCoordinate,Evented:a.Evented,config:a.config,prewarm:function(){Se().acquire(K)},clearPrewarmedResources:function(){var n=et;n&&(n.isPreloaded()&&n.numActive()===1?(n.release(K),et=null):console.warn("Could not clear WebWorkers since there are active Map instances that still reference it. The pre-warmed WebWorker pool can only be cleared when all map instances have been removed with map.remove()"))},get accessToken(){return a.config.ACCESS_TOKEN},set accessToken(n){a.config.ACCESS_TOKEN=n},get baseApiUrl(){return a.config.API_URL},set baseApiUrl(n){a.config.API_URL=n},get workerCount(){return ve.workerCount},set workerCount(n){ve.workerCount=n},get maxParallelImageRequests(){return a.config.MAX_PARALLEL_IMAGE_REQUESTS},set maxParallelImageRequests(n){a.config.MAX_PARALLEL_IMAGE_REQUESTS=n},clearStorage:function(n){a.clearTileCache(n)},workerUrl:""};return nl}),_})})(ay);var bh=ay.exports;const Ng=cg(bh);function Ed(h){let c;const d=h[15].default,f=Ru(d,h,h[14],null);return{c(){f&&f.c()},l(_){f&&f.l(_)},m(_,v){f&&f.m(_,v),c=!0},p(_,v){f&&f.p&&(!c||v&16384)&&Bu(f,d,_,_[14],c?Fu(d,_[14],v,null):Ou(_[14]),null)},i(_){c||(it(f,_),c=!0)},o(_){lt(f,_),c=!1},d(_){f&&f.d(_)}}}function Ug(h){let c,d,f,_=h[0]&&Ed(h);return{c(){c=Ne("div"),_&&_.c(),this.h()},l(v){c=Ue(v,"DIV",{class:!0,id:!0});var a=Be(c);_&&_.l(a),a.forEach(oe),this.h()},h(){ne(c,"class","absolute top-0 bg-grey4 w-full h-full svelte-a65d1y"),ne(c,"id",h[1]),qu(()=>h[16].call(c))},m(v,a){Le(v,c,a),_&&_.m(c,null),d=Zu(c,h[16].bind(c)),h[17](c),f=!0},p(v,[a]){v[0]?_?(_.p(v,a),a&1&&it(_,1)):(_=Ed(v),_.c(),it(_,1),_.m(c,null)):_&&(ta(),lt(_,1,1,()=>{_=null}),ra()),(!f||a&2)&&ne(c,"id",v[1])},i(v){f||(it(_),f=!0)},o(v){lt(_),f=!1},d(v){v&&oe(c),_&&_.d(),d(),h[17](null)}}}function Vg(h,c,d){let{$$slots:f={},$$scope:_}=c,{map:v}=c,{id:a="map"}=c,{location:I={bounds:[[-8.1775,54.02275],[-5.43279,55.31298]]}}=c,{style:T="https://raw.githubusercontent.com/nisra-explore/map_tiles/main/basemap_styles/style-omt.json"}=c,{interactive:M=!0}=c,{minzoom:F=0}=c,{maxzoom:R=14}=c,{zoom:D=null}=c,{scrollzoom:H=!0}=c,{geolocate:ae=!0}=c,{zoomcontrol:de=!0}=c,{options:fe={}}=c,we,xe;$m("map",{getMap:()=>v}),I.bounds?fe={...fe,bounds:I.bounds}:I.lon&&I.lat&&(fe={...fe,center:[I.lon,I.lat]},I.zoom&&(fe.zoom=I.zoom)),ey(()=>{const He=document.createElement("link");return He.rel="stylesheet",He.href="https://unpkg.com/mapbox-gl@1.13.0/dist/mapbox-gl.css",He.onload=()=>{d(0,v=new bh.Map({container:we,style:T,minZoom:F,maxZoom:R,maxBounds:[[-9.2,53.58],[-4.53,55.72]],interactive:M,...fe})),de&&v.addControl(new bh.NavigationControl({showCompass:!1})),H||v.scrollZoom.disable(),ae&&v.addControl(new bh.GeolocateControl),v.on("load",()=>{d(4,D=v.getZoom())}),v.on("zoom",()=>{d(4,D=v.getZoom())})},document.head.appendChild(He),()=>{v.remove(),He.parentNode.removeChild(He)}});function Ve(){let He=document.getElementsByClassName("mapboxgl-canvas");He[0]&&(He[0].style.width="100%",v.resize())}function Oe(){xe=this.clientWidth,d(2,xe)}function De(He){Nu[He?"unshift":"push"](()=>{we=He,d(3,we)})}return h.$$set=He=>{"map"in He&&d(0,v=He.map),"id"in He&&d(1,a=He.id),"location"in He&&d(6,I=He.location),"style"in He&&d(7,T=He.style),"interactive"in He&&d(8,M=He.interactive),"minzoom"in He&&d(9,F=He.minzoom),"maxzoom"in He&&d(10,R=He.maxzoom),"zoom"in He&&d(4,D=He.zoom),"scrollzoom"in He&&d(11,H=He.scrollzoom),"geolocate"in He&&d(12,ae=He.geolocate),"zoomcontrol"in He&&d(13,de=He.zoomcontrol),"options"in He&&d(5,fe=He.options),"$$scope"in He&&d(14,_=He.$$scope)},h.$$.update=()=>{h.$$.dirty&4&&xe&&Ve()},[v,a,xe,we,D,fe,I,T,M,F,R,H,ae,de,_,f,Oe,De]}class jg extends mn{constructor(c){super(),yn(this,c,Vg,Ug,_n,{map:0,id:1,location:6,style:7,interactive:8,minzoom:9,maxzoom:10,zoom:4,scrollzoom:11,geolocate:12,zoomcontrol:13,options:5})}}function Td(h){let c;const d=h[11].default,f=Ru(d,h,h[10],null);return{c(){f&&f.c()},l(_){f&&f.l(_)},m(_,v){f&&f.m(_,v),c=!0},p(_,v){f&&f.p&&(!c||v&1024)&&Bu(f,d,_,_[10],c?Fu(d,_[10],v,null):Ou(_[10]),null)},i(_){c||(it(f,_),c=!0)},o(_){lt(f,_),c=!1},d(_){f&&f.d(_)}}}function qg(h){let c,d,f=h[0]&&Td(h);return{c(){f&&f.c(),c=br()},l(_){f&&f.l(_),c=br()},m(_,v){f&&f.m(_,v),Le(_,c,v),d=!0},p(_,[v]){_[0]?f?(f.p(_,v),v&1&&it(f,1)):(f=Td(_),f.c(),it(f,1),f.m(c.parentNode,c)):f&&(ta(),lt(f,1,1,()=>{f=null}),ra())},i(_){d||(it(f),d=!0)},o(_){lt(f),d=!1},d(_){f&&f.d(_),_&&oe(c)}}}function Zg(h,c,d){let{$$slots:f={},$$scope:_}=c,{id:v}=c,{type:a}=c,{url:I=null}=c,{props:T={}}=c,{data:M=null}=c,{layer:F=null}=c,{promoteId:R=null}=c,{minzoom:D=null}=c,{maxzoom:H=null}=c,ae=!1;const{getMap:de}=Gu("map"),fe=de();fe.getSource(v)&&fe.removeSource(v);function we(){fe.isSourceLoaded(v)?(d(0,ae=!0),console.log(v+" loaded!")):setTimeout(()=>{console.log("..."),we()},500)}function xe(){fe.isStyleLoaded(v)?(Ve(),document.querySelector("#map canvas")&&document.querySelector("#map canvas").tabIndex=="0"&&(document.querySelector("#map canvas").tabIndex="-1")):setTimeout(()=>{console.log("..."),xe()},500)}D&&(T.minzoom=D),H&&(T.maxzoom=H),F&&R?(T.promoteId={},T.promoteId[F]=R):R&&(T.promoteId=R);function Ve(){console.log(v+" map source loading..."),a=="geojson"?M?(fe.addSource(v,{type:a,data:M,...T}),we()):I&&(fe.addSource(v,{type:a,data:I,...T}),we()):a=="vector"&&(fe.addSource(v,{type:a,tiles:[I],...T}),we())}xe();function Oe(){fe.getSource(v).setData(M)}return h.$$set=De=>{"id"in De&&d(2,v=De.id),"type"in De&&d(3,a=De.type),"url"in De&&d(4,I=De.url),"props"in De&&d(1,T=De.props),"data"in De&&d(5,M=De.data),"layer"in De&&d(6,F=De.layer),"promoteId"in De&&d(7,R=De.promoteId),"minzoom"in De&&d(8,D=De.minzoom),"maxzoom"in De&&d(9,H=De.maxzoom),"$$scope"in De&&d(10,_=De.$$scope)},h.$$.update=()=>{h.$$.dirty&33&&ae&&M&&Oe()},[ae,T,v,a,I,M,F,R,D,H,_,f]}class Gg extends mn{constructor(c){super(),yn(this,c,Zg,qg,_n,{id:2,type:3,url:4,props:1,data:5,layer:6,promoteId:7,minzoom:8,maxzoom:9})}}function Kg(h,c,d){const{Popup:f}=Ng,_=ig(),v=new f({closeButton:!1,closeOnClick:!1});let{id:a}=c,{source:I}=c,{sourceLayer:T=null}=c,{type:M}=c,{filter:F=null}=c,{layout:R={}}=c,{paint:D={}}=c,{data:H=null}=c,{code:ae=null}=c,{name:de="name"}=c,{colorCode:fe=null}=c,{click:we=!1}=c,{ignoreClick:xe=!1}=c,{clickCenter:Ve=!1}=c,{selected:Oe=null}=c,{hover:De=!1}=c,{hovered:He=null}=c,{highlight:Tt=!1}=c,{highlightKey:Lt="highlighted"}=c,{highlighted:qt=[]}=c,{order:_t=null}=c,{maxzoom:ht=null}=c,{minzoom:Ft=null}=c,{isChild:yt=!1}=c;const{getMap:It}=Gu("map"),tt=It();let Zt=null,pt=null,zt=[];tt.getLayer(a)&&tt.removeLayer(a);let Ut={id:a,type:M,source:I,paint:D,layout:R};F&&(Ut.filter=F),T&&(Ut["source-layer"]=T),ht&&(Ut.maxzoom=ht),Ft&&(Ut.minzoom=Ft),tt.addLayer(Ut,_t);function ei(){console.log("updating colors..."),H.forEach(Je=>{tt.setFeatureState({source:I,sourceLayer:T,id:Je[ae]},{color:Je[fe]})})}return we&&tt.on("click",a,Je=>{if(Je.features.length>0&&!xe){let At=Je.features[0].id;if(yt&&qt.includes(At)||!yt&&Oe!=At){if(d(0,Oe=At),_("select",{code:Oe}),Zt&&tt.setFeatureState({source:I,sourceLayer:T,id:Zt},{selected:!1}),tt.setFeatureState({source:I,sourceLayer:T,id:Oe},{selected:!0}),Ve){let pr=centroid(Je.features[0].toJSON().geometry);tt.flyTo({center:pr.geometry.coordinates})}d(24,Zt=Oe)}}}),De&&(tt.on("mousemove",a,Je=>{if(Je.features.length>0){let At=Je.features[0].id;He&&tt.setFeatureState({source:I,sourceLayer:T,id:He},{hovered:!1}),yt&&qt.includes(At)||!yt&&Oe!=At?(d(1,He=d(25,pt=At)),tt.setFeatureState({source:I,sourceLayer:T,id:He},{hovered:!0}),tt.getCanvas().style.cursor="pointer",v.setLngLat(Je.lngLat).setHTML(`<strong>${Je.features[0].properties[de]?Je.features[0].properties[de]:Je.features[0].properties[ae]}</strong>`).addTo(tt)):v.remove()}}),tt.on("mouseleave",a,Je=>{He&&tt.setFeatureState({source:I,sourceLayer:T,id:He},{hovered:!1}),d(1,He=d(25,pt=null)),tt.getCanvas().style.cursor="",v.remove()})),h.$$set=Je=>{"id"in Je&&d(2,a=Je.id),"source"in Je&&d(3,I=Je.source),"sourceLayer"in Je&&d(4,T=Je.sourceLayer),"type"in Je&&d(5,M=Je.type),"filter"in Je&&d(6,F=Je.filter),"layout"in Je&&d(7,R=Je.layout),"paint"in Je&&d(8,D=Je.paint),"data"in Je&&d(9,H=Je.data),"code"in Je&&d(10,ae=Je.code),"name"in Je&&d(11,de=Je.name),"colorCode"in Je&&d(12,fe=Je.colorCode),"click"in Je&&d(13,we=Je.click),"ignoreClick"in Je&&d(14,xe=Je.ignoreClick),"clickCenter"in Je&&d(15,Ve=Je.clickCenter),"selected"in Je&&d(0,Oe=Je.selected),"hover"in Je&&d(16,De=Je.hover),"hovered"in Je&&d(1,He=Je.hovered),"highlight"in Je&&d(17,Tt=Je.highlight),"highlightKey"in Je&&d(18,Lt=Je.highlightKey),"highlighted"in Je&&d(19,qt=Je.highlighted),"order"in Je&&d(20,_t=Je.order),"maxzoom"in Je&&d(21,ht=Je.maxzoom),"minzoom"in Je&&d(22,Ft=Je.minzoom),"isChild"in Je&&d(23,yt=Je.isChild)},h.$$.update=()=>{h.$$.dirty[0]&4096&&fe&&ei(),h.$$.dirty[0]&68026392&&Tt&&qt!=zt&&(zt[0]&&zt.forEach(Je=>{let At={};At[Lt]=!1,tt.setFeatureState({source:I,sourceLayer:T,id:Je},At)}),d(26,zt=qt),qt[0]&&qt.forEach(Je=>{let At={};At[Lt]=!0,tt.setFeatureState({source:I,sourceLayer:T,id:Je},At)})),h.$$.dirty[0]&16777241&&Oe!=Zt&&(Zt&&tt.setFeatureState({source:I,sourceLayer:T,id:Zt},{selected:!1}),Oe&&tt.setFeatureState({source:I,sourceLayer:T,id:Oe},{selected:!0}),d(24,Zt=Oe)),h.$$.dirty[0]&33619994&&De&&He!=pt&&(pt&&tt.setFeatureState({source:I,sourceLayer:T,id:pt},{hovered:!1}),He&&tt.setFeatureState({source:I,sourceLayer:T,id:He},{hovered:!0}),d(25,pt=He))},[Oe,He,a,I,T,M,F,R,D,H,ae,de,fe,we,xe,Ve,De,Tt,Lt,qt,_t,ht,Ft,yt,Zt,pt,zt]}class Pp extends mn{constructor(c){super(),yn(this,c,Kg,null,_n,{id:2,source:3,sourceLayer:4,type:5,filter:6,layout:7,paint:8,data:9,code:10,name:11,colorCode:12,click:13,ignoreClick:14,clickCenter:15,selected:0,hover:16,hovered:1,highlight:17,highlightKey:18,highlighted:19,order:20,maxzoom:21,minzoom:22,isChild:23},null,[-1,-1])}}function Xg(h){return h===0?!0:h}function is(h){return Xg(h)?Array.isArray(h)?c=>h.map(d=>typeof d!="function"?c[d]:d(c)):typeof h!="function"?c=>c[h]:h:null}function Wg(h){const c={};for(const d of h){if(Object(d)!==d)throw new TypeError("iterable for fromEntries should yield objects");const{"0":f,"1":_}=d;Object.defineProperty(c,f,{configurable:!0,enumerable:!0,writable:!0,value:_})}return c}function Cp(h,c={}){return Wg(Object.entries(h).filter(([d,f])=>f!==void 0&&c[d]===void 0))}function Hg(h,c){if(!Array.isArray(h))throw new TypeError(`The first argument of calcExtents() must be an array. You passed in a ${typeof h}. Consider passing a flat array to the \`flatData\` prop. More info: https://layercake.graphics/guide/#flatdata`);if(Array.isArray(c)||c===void 0||c===null)throw new TypeError("The second argument of calcExtents() must be an object with field names as keys as accessor functions as values.");const d={},f=Object.keys(c),_=f.length;let v,a,I,T,M,F,R,D;const H=h.length;for(v=0;v<_;v+=1){for(T=f[v],R=c[T],M=null,F=null,a=0;a<H;a+=1)if(D=R(h[a]),Array.isArray(D)){const ae=D.length;for(I=0;I<ae;I+=1)D[I]!==void 0&&D[I]!==null&&Number.isNaN(D[I])===!1&&((M===null||D[I]<M)&&(M=D[I]),(F===null||D[I]>F)&&(F=D[I]))}else D!=null&&Number.isNaN(D)===!1&&((M===null||D<M)&&(M=D),(F===null||D>F)&&(F=D));d[T]=[M,F]}return d}function oy(h=[],c){return Array.isArray(c)===!0?c.map((d,f)=>d===null?h[f]:d):h}function lh(h){return function([d,f]){return d?oy(d[h],f):f}}function xh(h,c){return h==null||c==null?NaN:h<c?-1:h>c?1:h>=c?0:NaN}function Jg(h,c){return h==null||c==null?NaN:c<h?-1:c>h?1:c>=h?0:NaN}function sy(h){let c,d,f;h.length!==2?(c=xh,d=(I,T)=>xh(h(I),T),f=(I,T)=>h(I)-T):(c=h===xh||h===Jg?h:Yg,d=h,f=h);function _(I,T,M=0,F=I.length){if(M<F){if(c(T,T)!==0)return F;do{const R=M+F>>>1;d(I[R],T)<0?M=R+1:F=R}while(M<F)}return M}function v(I,T,M=0,F=I.length){if(M<F){if(c(T,T)!==0)return F;do{const R=M+F>>>1;d(I[R],T)<=0?M=R+1:F=R}while(M<F)}return M}function a(I,T,M=0,F=I.length){const R=_(I,T,M,F-1);return R>M&&f(I[R-1],T)>-f(I[R],T)?R-1:R}return{left:_,center:a,right:v}}function Yg(){return 0}function Qg(h){return h===null?NaN:+h}const $g=sy(xh),ev=$g.right;sy(Qg).center;const tv=ev;class Id extends Map{constructor(c,d=nv){if(super(),Object.defineProperties(this,{_intern:{value:new Map},_key:{value:d}}),c!=null)for(const[f,_]of c)this.set(f,_)}get(c){return super.get(zd(this,c))}has(c){return super.has(zd(this,c))}set(c,d){return super.set(rv(this,c),d)}delete(c){return super.delete(iv(this,c))}}function zd({_intern:h,_key:c},d){const f=c(d);return h.has(f)?h.get(f):d}function rv({_intern:h,_key:c},d){const f=c(d);return h.has(f)?h.get(f):(h.set(f,d),d)}function iv({_intern:h,_key:c},d){const f=c(d);return h.has(f)&&(d=h.get(f),h.delete(f)),d}function nv(h){return h!==null&&typeof h=="object"?h.valueOf():h}var Rp=Math.sqrt(50),Bp=Math.sqrt(10),Op=Math.sqrt(2);function av(h,c,d){var f,_=-1,v,a,I;if(c=+c,h=+h,d=+d,h===c&&d>0)return[h];if((f=c<h)&&(v=h,h=c,c=v),(I=ly(h,c,d))===0||!isFinite(I))return[];if(I>0){let T=Math.round(h/I),M=Math.round(c/I);for(T*I<h&&++T,M*I>c&&--M,a=new Array(v=M-T+1);++_<v;)a[_]=(T+_)*I}else{I=-I;let T=Math.round(h*I),M=Math.round(c*I);for(T/I<h&&++T,M/I>c&&--M,a=new Array(v=M-T+1);++_<v;)a[_]=(T+_)/I}return f&&a.reverse(),a}function ly(h,c,d){var f=(c-h)/Math.max(0,d),_=Math.floor(Math.log(f)/Math.LN10),v=f/Math.pow(10,_);return _>=0?(v>=Rp?10:v>=Bp?5:v>=Op?2:1)*Math.pow(10,_):-Math.pow(10,-_)/(v>=Rp?10:v>=Bp?5:v>=Op?2:1)}function ov(h,c,d){var f=Math.abs(c-h)/Math.max(0,d),_=Math.pow(10,Math.floor(Math.log(f)/Math.LN10)),v=f/_;return v>=Rp?_*=10:v>=Bp?_*=5:v>=Op&&(_*=2),c<h?-_:_}function sv(h,c,d){h=+h,c=+c,d=(_=arguments.length)<2?(c=h,h=0,1):_<3?1:+d;for(var f=-1,_=Math.max(0,Math.ceil((c-h)/d))|0,v=new Array(_);++f<_;)v[f]=h+f*d;return v}function Lh(h,c){switch(arguments.length){case 0:break;case 1:this.range(h);break;default:this.range(c).domain(h);break}return this}const Ad=Symbol("implicit");function uy(){var h=new Id,c=[],d=[],f=Ad;function _(v){let a=h.get(v);if(a===void 0){if(f!==Ad)return f;h.set(v,a=c.push(v)-1)}return d[a%d.length]}return _.domain=function(v){if(!arguments.length)return c.slice();c=[],h=new Id;for(const a of v)h.has(a)||h.set(a,c.push(a)-1);return _},_.range=function(v){return arguments.length?(d=Array.from(v),_):d.slice()},_.unknown=function(v){return arguments.length?(f=v,_):f},_.copy=function(){return uy(c,d).unknown(f)},Lh.apply(_,arguments),_}function cy(){var h=uy().unknown(void 0),c=h.domain,d=h.range,f=0,_=1,v,a,I=!1,T=0,M=0,F=.5;delete h.unknown;function R(){var D=c().length,H=_<f,ae=H?_:f,de=H?f:_;v=(de-ae)/Math.max(1,D-T+M*2),I&&(v=Math.floor(v)),ae+=(de-ae-v*(D-T))*F,a=v*(1-T),I&&(ae=Math.round(ae),a=Math.round(a));var fe=sv(D).map(function(we){return ae+v*we});return d(H?fe.reverse():fe)}return h.domain=function(D){return arguments.length?(c(D),R()):c()},h.range=function(D){return arguments.length?([f,_]=D,f=+f,_=+_,R()):[f,_]},h.rangeRound=function(D){return[f,_]=D,f=+f,_=+_,I=!0,R()},h.bandwidth=function(){return a},h.step=function(){return v},h.round=function(D){return arguments.length?(I=!!D,R()):I},h.padding=function(D){return arguments.length?(T=Math.min(1,M=+D),R()):T},h.paddingInner=function(D){return arguments.length?(T=Math.min(1,D),R()):T},h.paddingOuter=function(D){return arguments.length?(M=+D,R()):M},h.align=function(D){return arguments.length?(F=Math.max(0,Math.min(1,D)),R()):F},h.copy=function(){return cy(c(),[f,_]).round(I).paddingInner(T).paddingOuter(M).align(F)},Lh.apply(R(),arguments)}function Kp(h,c,d){h.prototype=c.prototype=d,d.constructor=h}function hy(h,c){var d=Object.create(h.prototype);for(var f in c)d[f]=c[f];return d}function rc(){}var Uu=.7,Eh=1/Uu,Rl="\\s*([+-]?\\d+)\\s*",Vu="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",ho="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",lv=/^#([0-9a-f]{3,8})$/,uv=new RegExp(`^rgb\\(${Rl},${Rl},${Rl}\\)$`),cv=new RegExp(`^rgb\\(${ho},${ho},${ho}\\)$`),hv=new RegExp(`^rgba\\(${Rl},${Rl},${Rl},${Vu}\\)$`),pv=new RegExp(`^rgba\\(${ho},${ho},${ho},${Vu}\\)$`),fv=new RegExp(`^hsl\\(${Vu},${ho},${ho}\\)$`),dv=new RegExp(`^hsla\\(${Vu},${ho},${ho},${Vu}\\)$`),Pd={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};Kp(rc,ju,{copy(h){return Object.assign(new this.constructor,this,h)},displayable(){return this.rgb().displayable()},hex:Cd,formatHex:Cd,formatHex8:mv,formatHsl:yv,formatRgb:Md,toString:Md});function Cd(){return this.rgb().formatHex()}function mv(){return this.rgb().formatHex8()}function yv(){return py(this).formatHsl()}function Md(){return this.rgb().formatRgb()}function ju(h){var c,d;return h=(h+"").trim().toLowerCase(),(c=lv.exec(h))?(d=c[1].length,c=parseInt(c[1],16),d===6?Dd(c):d===3?new ca(c>>8&15|c>>4&240,c>>4&15|c&240,(c&15)<<4|c&15,1):d===8?uh(c>>24&255,c>>16&255,c>>8&255,(c&255)/255):d===4?uh(c>>12&15|c>>8&240,c>>8&15|c>>4&240,c>>4&15|c&240,((c&15)<<4|c&15)/255):null):(c=uv.exec(h))?new ca(c[1],c[2],c[3],1):(c=cv.exec(h))?new ca(c[1]*255/100,c[2]*255/100,c[3]*255/100,1):(c=hv.exec(h))?uh(c[1],c[2],c[3],c[4]):(c=pv.exec(h))?uh(c[1]*255/100,c[2]*255/100,c[3]*255/100,c[4]):(c=fv.exec(h))?Bd(c[1],c[2]/100,c[3]/100,1):(c=dv.exec(h))?Bd(c[1],c[2]/100,c[3]/100,c[4]):Pd.hasOwnProperty(h)?Dd(Pd[h]):h==="transparent"?new ca(NaN,NaN,NaN,0):null}function Dd(h){return new ca(h>>16&255,h>>8&255,h&255,1)}function uh(h,c,d,f){return f<=0&&(h=c=d=NaN),new ca(h,c,d,f)}function _v(h){return h instanceof rc||(h=ju(h)),h?(h=h.rgb(),new ca(h.r,h.g,h.b,h.opacity)):new ca}function Fp(h,c,d,f){return arguments.length===1?_v(h):new ca(h,c,d,f??1)}function ca(h,c,d,f){this.r=+h,this.g=+c,this.b=+d,this.opacity=+f}Kp(ca,Fp,hy(rc,{brighter(h){return h=h==null?Eh:Math.pow(Eh,h),new ca(this.r*h,this.g*h,this.b*h,this.opacity)},darker(h){return h=h==null?Uu:Math.pow(Uu,h),new ca(this.r*h,this.g*h,this.b*h,this.opacity)},rgb(){return this},clamp(){return new ca(Os(this.r),Os(this.g),Os(this.b),Th(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:Ld,formatHex:Ld,formatHex8:gv,formatRgb:Rd,toString:Rd}));function Ld(){return`#${Bs(this.r)}${Bs(this.g)}${Bs(this.b)}`}function gv(){return`#${Bs(this.r)}${Bs(this.g)}${Bs(this.b)}${Bs((isNaN(this.opacity)?1:this.opacity)*255)}`}function Rd(){const h=Th(this.opacity);return`${h===1?"rgb(":"rgba("}${Os(this.r)}, ${Os(this.g)}, ${Os(this.b)}${h===1?")":`, ${h})`}`}function Th(h){return isNaN(h)?1:Math.max(0,Math.min(1,h))}function Os(h){return Math.max(0,Math.min(255,Math.round(h)||0))}function Bs(h){return h=Os(h),(h<16?"0":"")+h.toString(16)}function Bd(h,c,d,f){return f<=0?h=c=d=NaN:d<=0||d>=1?h=c=NaN:c<=0&&(h=NaN),new Va(h,c,d,f)}function py(h){if(h instanceof Va)return new Va(h.h,h.s,h.l,h.opacity);if(h instanceof rc||(h=ju(h)),!h)return new Va;if(h instanceof Va)return h;h=h.rgb();var c=h.r/255,d=h.g/255,f=h.b/255,_=Math.min(c,d,f),v=Math.max(c,d,f),a=NaN,I=v-_,T=(v+_)/2;return I?(c===v?a=(d-f)/I+(d<f)*6:d===v?a=(f-c)/I+2:a=(c-d)/I+4,I/=T<.5?v+_:2-v-_,a*=60):I=T>0&&T<1?0:a,new Va(a,I,T,h.opacity)}function vv(h,c,d,f){return arguments.length===1?py(h):new Va(h,c,d,f??1)}function Va(h,c,d,f){this.h=+h,this.s=+c,this.l=+d,this.opacity=+f}Kp(Va,vv,hy(rc,{brighter(h){return h=h==null?Eh:Math.pow(Eh,h),new Va(this.h,this.s,this.l*h,this.opacity)},darker(h){return h=h==null?Uu:Math.pow(Uu,h),new Va(this.h,this.s,this.l*h,this.opacity)},rgb(){var h=this.h%360+(this.h<0)*360,c=isNaN(h)||isNaN(this.s)?0:this.s,d=this.l,f=d+(d<.5?d:1-d)*c,_=2*d-f;return new ca(Mp(h>=240?h-240:h+120,_,f),Mp(h,_,f),Mp(h<120?h+240:h-120,_,f),this.opacity)},clamp(){return new Va(Od(this.h),ch(this.s),ch(this.l),Th(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){const h=Th(this.opacity);return`${h===1?"hsl(":"hsla("}${Od(this.h)}, ${ch(this.s)*100}%, ${ch(this.l)*100}%${h===1?")":`, ${h})`}`}}));function Od(h){return h=(h||0)%360,h<0?h+360:h}function ch(h){return Math.max(0,Math.min(1,h||0))}function Mp(h,c,d){return(h<60?c+(d-c)*h/60:h<180?d:h<240?c+(d-c)*(240-h)/60:c)*255}const Xp=h=>()=>h;function bv(h,c){return function(d){return h+d*c}}function xv(h,c,d){return h=Math.pow(h,d),c=Math.pow(c,d)-h,d=1/d,function(f){return Math.pow(h+f*c,d)}}function wv(h){return(h=+h)==1?fy:function(c,d){return d-c?xv(c,d,h):Xp(isNaN(c)?d:c)}}function fy(h,c){var d=c-h;return d?bv(h,d):Xp(isNaN(h)?c:h)}const Fd=function h(c){var d=wv(c);function f(_,v){var a=d((_=Fp(_)).r,(v=Fp(v)).r),I=d(_.g,v.g),T=d(_.b,v.b),M=fy(_.opacity,v.opacity);return function(F){return _.r=a(F),_.g=I(F),_.b=T(F),_.opacity=M(F),_+""}}return f.gamma=h,f}(1);function kv(h,c){c||(c=[]);var d=h?Math.min(c.length,h.length):0,f=c.slice(),_;return function(v){for(_=0;_<d;++_)f[_]=h[_]*(1-v)+c[_]*v;return f}}function Sv(h){return ArrayBuffer.isView(h)&&!(h instanceof DataView)}function Ev(h,c){var d=c?c.length:0,f=h?Math.min(d,h.length):0,_=new Array(f),v=new Array(d),a;for(a=0;a<f;++a)_[a]=Wp(h[a],c[a]);for(;a<d;++a)v[a]=c[a];return function(I){for(a=0;a<f;++a)v[a]=_[a](I);return v}}function Tv(h,c){var d=new Date;return h=+h,c=+c,function(f){return d.setTime(h*(1-f)+c*f),d}}function Ih(h,c){return h=+h,c=+c,function(d){return h*(1-d)+c*d}}function Iv(h,c){var d={},f={},_;(h===null||typeof h!="object")&&(h={}),(c===null||typeof c!="object")&&(c={});for(_ in c)_ in h?d[_]=Wp(h[_],c[_]):f[_]=c[_];return function(v){for(_ in d)f[_]=d[_](v);return f}}var Np=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,Dp=new RegExp(Np.source,"g");function zv(h){return function(){return h}}function Av(h){return function(c){return h(c)+""}}function Pv(h,c){var d=Np.lastIndex=Dp.lastIndex=0,f,_,v,a=-1,I=[],T=[];for(h=h+"",c=c+"";(f=Np.exec(h))&&(_=Dp.exec(c));)(v=_.index)>d&&(v=c.slice(d,v),I[a]?I[a]+=v:I[++a]=v),(f=f[0])===(_=_[0])?I[a]?I[a]+=_:I[++a]=_:(I[++a]=null,T.push({i:a,x:Ih(f,_)})),d=Dp.lastIndex;return d<c.length&&(v=c.slice(d),I[a]?I[a]+=v:I[++a]=v),I.length<2?T[0]?Av(T[0].x):zv(c):(c=T.length,function(M){for(var F=0,R;F<c;++F)I[(R=T[F]).i]=R.x(M);return I.join("")})}function Wp(h,c){var d=typeof c,f;return c==null||d==="boolean"?Xp(c):(d==="number"?Ih:d==="string"?(f=ju(c))?(c=f,Fd):Pv:c instanceof ju?Fd:c instanceof Date?Tv:Sv(c)?kv:Array.isArray(c)?Ev:typeof c.valueOf!="function"&&typeof c.toString!="function"||isNaN(c)?Iv:Ih)(h,c)}function Cv(h,c){return h=+h,c=+c,function(d){return Math.round(h*(1-d)+c*d)}}function Mv(h){return function(){return h}}function Dv(h){return+h}var Nd=[0,1];function co(h){return h}function Up(h,c){return(c-=h=+h)?function(d){return(d-h)/c}:Mv(isNaN(c)?NaN:.5)}function Lv(h,c){var d;return h>c&&(d=h,h=c,c=d),function(f){return Math.max(h,Math.min(c,f))}}function Rv(h,c,d){var f=h[0],_=h[1],v=c[0],a=c[1];return _<f?(f=Up(_,f),v=d(a,v)):(f=Up(f,_),v=d(v,a)),function(I){return v(f(I))}}function Bv(h,c,d){var f=Math.min(h.length,c.length)-1,_=new Array(f),v=new Array(f),a=-1;for(h[f]<h[0]&&(h=h.slice().reverse(),c=c.slice().reverse());++a<f;)_[a]=Up(h[a],h[a+1]),v[a]=d(c[a],c[a+1]);return function(I){var T=tv(h,I,1,f)-1;return v[T](_[T](I))}}function dy(h,c){return c.domain(h.domain()).range(h.range()).interpolate(h.interpolate()).clamp(h.clamp()).unknown(h.unknown())}function my(){var h=Nd,c=Nd,d=Wp,f,_,v,a=co,I,T,M;function F(){var D=Math.min(h.length,c.length);return a!==co&&(a=Lv(h[0],h[D-1])),I=D>2?Bv:Rv,T=M=null,R}function R(D){return D==null||isNaN(D=+D)?v:(T||(T=I(h.map(f),c,d)))(f(a(D)))}return R.invert=function(D){return a(_((M||(M=I(c,h.map(f),Ih)))(D)))},R.domain=function(D){return arguments.length?(h=Array.from(D,Dv),F()):h.slice()},R.range=function(D){return arguments.length?(c=Array.from(D),F()):c.slice()},R.rangeRound=function(D){return c=Array.from(D),d=Cv,F()},R.clamp=function(D){return arguments.length?(a=D?!0:co,F()):a!==co},R.interpolate=function(D){return arguments.length?(d=D,F()):d},R.unknown=function(D){return arguments.length?(v=D,R):v},function(D,H){return f=D,_=H,F()}}function Ov(){return my()(co,co)}function Fv(h){return Math.abs(h=Math.round(h))>=1e21?h.toLocaleString("en").replace(/,/g,""):h.toString(10)}function zh(h,c){if((d=(h=c?h.toExponential(c-1):h.toExponential()).indexOf("e"))<0)return null;var d,f=h.slice(0,d);return[f.length>1?f[0]+f.slice(2):f,+h.slice(d+1)]}function Bl(h){return h=zh(Math.abs(h)),h?h[1]:NaN}function Nv(h,c){return function(d,f){for(var _=d.length,v=[],a=0,I=h[0],T=0;_>0&&I>0&&(T+I+1>f&&(I=Math.max(1,f-T)),v.push(d.substring(_-=I,_+I)),!((T+=I+1)>f));)I=h[a=(a+1)%h.length];return v.reverse().join(c)}}function Uv(h){return function(c){return c.replace(/[0-9]/g,function(d){return h[+d]})}}var Vv=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function Ah(h){if(!(c=Vv.exec(h)))throw new Error("invalid format: "+h);var c;return new Hp({fill:c[1],align:c[2],sign:c[3],symbol:c[4],zero:c[5],width:c[6],comma:c[7],precision:c[8]&&c[8].slice(1),trim:c[9],type:c[10]})}Ah.prototype=Hp.prototype;function Hp(h){this.fill=h.fill===void 0?" ":h.fill+"",this.align=h.align===void 0?">":h.align+"",this.sign=h.sign===void 0?"-":h.sign+"",this.symbol=h.symbol===void 0?"":h.symbol+"",this.zero=!!h.zero,this.width=h.width===void 0?void 0:+h.width,this.comma=!!h.comma,this.precision=h.precision===void 0?void 0:+h.precision,this.trim=!!h.trim,this.type=h.type===void 0?"":h.type+""}Hp.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(this.width===void 0?"":Math.max(1,this.width|0))+(this.comma?",":"")+(this.precision===void 0?"":"."+Math.max(0,this.precision|0))+(this.trim?"~":"")+this.type};function jv(h){e:for(var c=h.length,d=1,f=-1,_;d<c;++d)switch(h[d]){case".":f=_=d;break;case"0":f===0&&(f=d),_=d;break;default:if(!+h[d])break e;f>0&&(f=0);break}return f>0?h.slice(0,f)+h.slice(_+1):h}var yy;function qv(h,c){var d=zh(h,c);if(!d)return h+"";var f=d[0],_=d[1],v=_-(yy=Math.max(-8,Math.min(8,Math.floor(_/3)))*3)+1,a=f.length;return v===a?f:v>a?f+new Array(v-a+1).join("0"):v>0?f.slice(0,v)+"."+f.slice(v):"0."+new Array(1-v).join("0")+zh(h,Math.max(0,c+v-1))[0]}function Ud(h,c){var d=zh(h,c);if(!d)return h+"";var f=d[0],_=d[1];return _<0?"0."+new Array(-_).join("0")+f:f.length>_+1?f.slice(0,_+1)+"."+f.slice(_+1):f+new Array(_-f.length+2).join("0")}const Vd={"%":(h,c)=>(h*100).toFixed(c),b:h=>Math.round(h).toString(2),c:h=>h+"",d:Fv,e:(h,c)=>h.toExponential(c),f:(h,c)=>h.toFixed(c),g:(h,c)=>h.toPrecision(c),o:h=>Math.round(h).toString(8),p:(h,c)=>Ud(h*100,c),r:Ud,s:qv,X:h=>Math.round(h).toString(16).toUpperCase(),x:h=>Math.round(h).toString(16)};function jd(h){return h}var qd=Array.prototype.map,Zd=["y","z","a","f","p","n","","m","","k","M","G","T","P","E","Z","Y"];function Zv(h){var c=h.grouping===void 0||h.thousands===void 0?jd:Nv(qd.call(h.grouping,Number),h.thousands+""),d=h.currency===void 0?"":h.currency[0]+"",f=h.currency===void 0?"":h.currency[1]+"",_=h.decimal===void 0?".":h.decimal+"",v=h.numerals===void 0?jd:Uv(qd.call(h.numerals,String)),a=h.percent===void 0?"%":h.percent+"",I=h.minus===void 0?"":h.minus+"",T=h.nan===void 0?"NaN":h.nan+"";function M(R){R=Ah(R);var D=R.fill,H=R.align,ae=R.sign,de=R.symbol,fe=R.zero,we=R.width,xe=R.comma,Ve=R.precision,Oe=R.trim,De=R.type;De==="n"?(xe=!0,De="g"):Vd[De]||(Ve===void 0&&(Ve=12),Oe=!0,De="g"),(fe||D==="0"&&H==="=")&&(fe=!0,D="0",H="=");var He=de==="$"?d:de==="#"&&/[boxX]/.test(De)?"0"+De.toLowerCase():"",Tt=de==="$"?f:/[%p]/.test(De)?a:"",Lt=Vd[De],qt=/[defgprs%]/.test(De);Ve=Ve===void 0?6:/[gprs]/.test(De)?Math.max(1,Math.min(21,Ve)):Math.max(0,Math.min(20,Ve));function _t(ht){var Ft=He,yt=Tt,It,tt,Zt;if(De==="c")yt=Lt(ht)+yt,ht="";else{ht=+ht;var pt=ht<0||1/ht<0;if(ht=isNaN(ht)?T:Lt(Math.abs(ht),Ve),Oe&&(ht=jv(ht)),pt&&+ht==0&&ae!=="+"&&(pt=!1),Ft=(pt?ae==="("?ae:I:ae==="-"||ae==="("?"":ae)+Ft,yt=(De==="s"?Zd[8+yy/3]:"")+yt+(pt&&ae==="("?")":""),qt){for(It=-1,tt=ht.length;++It<tt;)if(Zt=ht.charCodeAt(It),48>Zt||Zt>57){yt=(Zt===46?_+ht.slice(It+1):ht.slice(It))+yt,ht=ht.slice(0,It);break}}}xe&&!fe&&(ht=c(ht,1/0));var zt=Ft.length+ht.length+yt.length,Ut=zt<we?new Array(we-zt+1).join(D):"";switch(xe&&fe&&(ht=c(Ut+ht,Ut.length?we-yt.length:1/0),Ut=""),H){case"<":ht=Ft+ht+yt+Ut;break;case"=":ht=Ft+Ut+ht+yt;break;case"^":ht=Ut.slice(0,zt=Ut.length>>1)+Ft+ht+yt+Ut.slice(zt);break;default:ht=Ut+Ft+ht+yt;break}return v(ht)}return _t.toString=function(){return R+""},_t}function F(R,D){var H=M((R=Ah(R),R.type="f",R)),ae=Math.max(-8,Math.min(8,Math.floor(Bl(D)/3)))*3,de=Math.pow(10,-ae),fe=Zd[8+ae/3];return function(we){return H(de*we)+fe}}return{format:M,formatPrefix:F}}var hh,_y,gy;Gv({thousands:",",grouping:[3],currency:["$",""]});function Gv(h){return hh=Zv(h),_y=hh.format,gy=hh.formatPrefix,hh}function Kv(h){return Math.max(0,-Bl(Math.abs(h)))}function Xv(h,c){return Math.max(0,Math.max(-8,Math.min(8,Math.floor(Bl(c)/3)))*3-Bl(Math.abs(h)))}function Wv(h,c){return h=Math.abs(h),c=Math.abs(c)-h,Math.max(0,Bl(c)-Bl(h))+1}function Hv(h,c,d,f){var _=ov(h,c,d),v;switch(f=Ah(f??",f"),f.type){case"s":{var a=Math.max(Math.abs(h),Math.abs(c));return f.precision==null&&!isNaN(v=Xv(_,a))&&(f.precision=v),gy(f,a)}case"":case"e":case"g":case"p":case"r":{f.precision==null&&!isNaN(v=Wv(_,Math.max(Math.abs(h),Math.abs(c))))&&(f.precision=v-(f.type==="e"));break}case"f":case"%":{f.precision==null&&!isNaN(v=Kv(_))&&(f.precision=v-(f.type==="%")*2);break}}return _y(f)}function vy(h){var c=h.domain;return h.ticks=function(d){var f=c();return av(f[0],f[f.length-1],d??10)},h.tickFormat=function(d,f){var _=c();return Hv(_[0],_[_.length-1],d??10,f)},h.nice=function(d){d==null&&(d=10);var f=c(),_=0,v=f.length-1,a=f[_],I=f[v],T,M,F=10;for(I<a&&(M=a,a=I,I=M,M=_,_=v,v=M);F-- >0;){if(M=ly(a,I,d),M===T)return f[_]=a,f[v]=I,c(f);if(M>0)a=Math.floor(a/M)*M,I=Math.ceil(I/M)*M;else if(M<0)a=Math.ceil(a*M)/M,I=Math.floor(I*M)/M;else break;T=M}return h},h}function wh(){var h=Ov();return h.copy=function(){return dy(h,wh())},Lh.apply(h,arguments),vy(h)}function Gd(h){return function(c){return c<0?-Math.pow(-c,h):Math.pow(c,h)}}function Jv(h){return h<0?-Math.sqrt(-h):Math.sqrt(h)}function Yv(h){return h<0?-h*h:h*h}function Qv(h){var c=h(co,co),d=1;function f(){return d===1?h(co,co):d===.5?h(Jv,Yv):h(Gd(d),Gd(1/d))}return c.exponent=function(_){return arguments.length?(d=+_,f()):d},vy(c)}function by(){var h=Qv(my());return h.copy=function(){return dy(h,by()).exponent(h.exponent())},Lh.apply(h,arguments),h}function $v(){return by.apply(null,arguments).exponent(.5)}const Lu={x:wh,y:wh,z:wh,r:$v};function e0(h){return h.constant?"symlog":h.base?"log":h.exponent?h.exponent()===.5?"sqrt":"pow":"other"}function Kd(h){return h}function t0(h){return c=>Math.log(h*c)}function r0(h){return c=>h*Math.exp(c)}function i0(h){return c=>Math.sign(c)*Math.log1p(Math.abs(c/h))}function n0(h){return c=>Math.sign(c)*Math.expm1(Math.abs(c))*h}function ph(h){return function(d){return d<0?-Math.pow(-d,h):Math.pow(d,h)}}function a0(h){const c=e0(h);if(c==="log"){const d=Math.sign(h.domain()[0]);return{lift:t0(d),ground:r0(d),scaleType:c}}return c==="pow"?{lift:ph(1),ground:ph(1/1),scaleType:c}:c==="sqrt"?{lift:ph(.5),ground:ph(1/.5),scaleType:c}:c==="symlog"?{lift:i0(1),ground:n0(1),scaleType:c}:{lift:Kd,ground:Kd,scaleType:c}}function o0(h,c){if(typeof h.range!="function")throw new Error("Scale method `range` must be a function");if(typeof h.domain!="function")throw new Error("Scale method `domain` must be a function");if(!Array.isArray(c))return h.domain();h.domain().length!==2&&console.warn("[LayerCake] The scale is expected to have a domain of length 2 to use padding. Are you sure you want to use padding? Your scale's domain is:",h.domain()),h.range().length!==2&&console.warn("[LayerCake] The scale is expected to have a range of length 2 to use padding. Are you sure you want to use padding? Your scale's range is:",h.range());const{lift:d,ground:f}=a0(h),_=h.domain()[0],v=Object.prototype.toString.call(_)==="[object Date]",[a,I]=h.domain().map(H=>d(v?H.getTime():H)),[T,M]=h.range(),F=c[0]||0,R=c[1]||0,D=(I-a)/(Math.abs(M-T)-F-R);return[a-F*D,R*D+I].map(H=>f(v?new Date(H):H))}function s0(h,c,d,f,_){let v,a;return _===!0?(v=0,a=100):(v=h==="r"?1:0,a=h==="y"?d:h==="r"?25:c),f===!0?[a,v]:[v,a]}function l0(h,c,d,f,_,v){return _?typeof _=="function"?_({width:c,height:d}):_:s0(h,c,d,f,v)}function fh(h){return function([d,f,_,v,a,I,T,M,F,R]){if(f===null)return null;const D=l0(h,T,M,I,F,R),H=d===Lu[h]?d():d.copy();return H.domain(oy(f[h],_)).range(D),v&&H.domain(o0(H,v)),a===!0&&(typeof H.nice=="function"?H.nice():console.error(`[Layer Cake] You set \`${h}Nice: true\` but the ${h}Scale does not have a \`.nice\` method. Ignoring...`)),H}}function dh([h,c]){return d=>{const f=h(d);return Array.isArray(f)?f.map(_=>c(_)):c(f)}}function mh([h]){if(typeof h=="function"){if(typeof h.range=="function")return h.range();console.error("[LayerCake] Your scale doesn't have a `.range` method?")}return null}const yh={x:!1,y:!0,z:!1,r:!1};const u0=h=>({element:h[0]&4,width:h[0]&256,height:h[0]&512,aspectRatio:h[0]&1024,containerWidth:h[0]&128,containerHeight:h[0]&64}),Xd=h=>({element:h[2],width:h[8],height:h[9],aspectRatio:h[10],containerWidth:h[7],containerHeight:h[6]});function Wd(h){let c,d,f;const _=h[90].default,v=Ru(_,h,h[89],Xd);return{c(){c=Ne("div"),v&&v.c(),this.h()},l(a){c=Ue(a,"DIV",{class:!0});var I=Be(c);v&&v.l(I),I.forEach(oe),this.h()},h(){ne(c,"class","layercake-container svelte-vhzpsp"),qu(()=>h[92].call(c)),Ke(c,"position",h[5]),Ke(c,"top",h[5]==="absolute"?"0":null),Ke(c,"right",h[5]==="absolute"?"0":null),Ke(c,"bottom",h[5]==="absolute"?"0":null),Ke(c,"left",h[5]==="absolute"?"0":null),Ke(c,"pointer-events",h[4]===!1?"none":null)},m(a,I){Le(a,c,I),v&&v.m(c,null),h[91](c),d=Zu(c,h[92].bind(c)),f=!0},p(a,I){v&&v.p&&(!f||I[0]&1988|I[2]&134217728)&&Bu(v,_,a,a[89],f?Fu(_,a[89],I,u0):Ou(a[89]),Xd),I[0]&32&&Ke(c,"position",a[5]),I[0]&32&&Ke(c,"top",a[5]==="absolute"?"0":null),I[0]&32&&Ke(c,"right",a[5]==="absolute"?"0":null),I[0]&32&&Ke(c,"bottom",a[5]==="absolute"?"0":null),I[0]&32&&Ke(c,"left",a[5]==="absolute"?"0":null),I[0]&16&&Ke(c,"pointer-events",a[4]===!1?"none":null)},i(a){f||(it(v,a),f=!0)},o(a){lt(v,a),f=!1},d(a){a&&oe(c),v&&v.d(a),h[91](null),d()}}}function c0(h){let c,d,f=(h[3]===!0||typeof window<"u")&&Wd(h);return{c(){f&&f.c(),c=br()},l(_){f&&f.l(_),c=br()},m(_,v){f&&f.m(_,v),Le(_,c,v),d=!0},p(_,v){_[3]===!0||typeof window<"u"?f?(f.p(_,v),v[0]&8&&it(f,1)):(f=Wd(_),f.c(),it(f,1),f.m(c.parentNode,c)):f&&(ta(),lt(f,1,1,()=>{f=null}),ra())},i(_){d||(it(f),d=!0)},o(_){lt(f),d=!1},d(_){f&&f.d(_),_&&oe(c)}}}function h0(h,c,d){let f,_,v,a,I,T,M,F,R,D,H,ae,de,fe,we,xe,Ve,Oe,De,He,Tt,Lt,qt,_t,ht,Ft,yt,It,tt,Zt,pt,zt,Ut,ei,Je,At,pr,Fr,Mr,Zr,sr,{$$slots:ti={},$$scope:Wt}=c,{ssr:Gr=!1}=c,{pointerEvents:mr=!0}=c,{position:Nr="relative"}=c,{percentRange:jt=!1}=c,{width:Dr=void 0}=c,{height:Kr=void 0}=c,{containerWidth:cr=Dr||100}=c,{containerHeight:Fi=Kr||100}=c,{element:Ar=void 0}=c,{x:bi=void 0}=c,{y:pi=void 0}=c,{z:Qi=void 0}=c,{r:Mi=void 0}=c,{data:fi=[]}=c,{xDomain:ri=void 0}=c,{yDomain:sn=void 0}=c,{zDomain:di=void 0}=c,{rDomain:Ur=void 0}=c,{xNice:$i=!1}=c,{yNice:Ln=!1}=c,{zNice:Ni=!1}=c,{rNice:zn=!1}=c,{xReverse:en=yh.x}=c,{yReverse:An=yh.y}=c,{zReverse:Ui=yh.z}=c,{rReverse:gn=yh.r}=c,{xPadding:Vi=void 0}=c,{yPadding:Rn=void 0}=c,{zPadding:tn=void 0}=c,{rPadding:ji=void 0}=c,{xScale:vn=Lu.x}=c,{yScale:ln=Lu.y}=c,{zScale:un=Lu.z}=c,{rScale:bn=Lu.r}=c,{xRange:oi=void 0}=c,{yRange:Pr=void 0}=c,{zRange:L=void 0}=c,{rRange:N=void 0}=c,{padding:V={}}=c,{extents:W={}}=c,{flatData:$=void 0}=c,{custom:se={}}=c,he=!1;ey(()=>{he=!0});const j={},J=Ir(jt);Xt(h,J,ye=>d(128,Fr=ye));const _e=Ir(cr);Xt(h,_e,ye=>d(7,pr=ye));const Ce=Ir(Fi);Xt(h,Ce,ye=>d(6,At=ye));const Me=Ir(Cp(W));Xt(h,Me,ye=>d(127,Je=ye));const K=Ir(fi);Xt(h,K,ye=>d(126,ei=ye));const ve=Ir($||fi);Xt(h,ve,ye=>d(125,Ut=ye));const et=Ir(V);Xt(h,et,ye=>d(124,zt=ye));const Ye=Ir(is(bi));Xt(h,Ye,ye=>d(123,pt=ye));const Se=Ir(is(pi));Xt(h,Se,ye=>d(122,Zt=ye));const We=Ir(is(Qi));Xt(h,We,ye=>d(121,tt=ye));const Fe=Ir(is(Mi));Xt(h,Fe,ye=>d(120,It=ye));const qe=Ir(ri);Xt(h,qe,ye=>d(119,yt=ye));const Mt=Ir(sn);Xt(h,Mt,ye=>d(118,Ft=ye));const Ze=Ir(di);Xt(h,Ze,ye=>d(117,ht=ye));const Vt=Ir(Ur);Xt(h,Vt,ye=>d(116,_t=ye));const lr=Ir($i);Xt(h,lr,ye=>d(115,qt=ye));const Pt=Ir(Ln);Xt(h,Pt,ye=>d(114,Lt=ye));const er=Ir(Ni);Xt(h,er,ye=>d(113,Tt=ye));const Jt=Ir(zn);Xt(h,Jt,ye=>d(112,He=ye));const ii=Ir(en);Xt(h,ii,ye=>d(111,De=ye));const $t=Ir(An);Xt(h,$t,ye=>d(110,Oe=ye));const vr=Ir(Ui);Xt(h,vr,ye=>d(109,Ve=ye));const fr=Ir(gn);Xt(h,fr,ye=>d(108,xe=ye));const Gt=Ir(Vi);Xt(h,Gt,ye=>d(107,we=ye));const tr=Ir(Rn);Xt(h,tr,ye=>d(106,fe=ye));const si=Ir(tn);Xt(h,si,ye=>d(105,de=ye));const Bn=Ir(ji);Xt(h,Bn,ye=>d(104,ae=ye));const xr=Ir(oi);Xt(h,xr,ye=>d(103,H=ye));const Di=Ir(Pr);Xt(h,Di,ye=>d(102,D=ye));const ja=Ir(L);Xt(h,ja,ye=>d(101,R=ye));const ga=Ir(N);Xt(h,ga,ye=>d(100,F=ye));const Xr=Ir(vn);Xt(h,Xr,ye=>d(99,M=ye));const va=Ir(ln);Xt(h,va,ye=>d(98,T=ye));const Si=Ir(un);Xt(h,Si,ye=>d(97,I=ye));const li=Ir(bn);Xt(h,li,ye=>d(96,a=ye));const cn=Ir(j);Xt(h,cn,ye=>d(94,_=ye));const Lr=Ir(se);Xt(h,Lr,ye=>d(95,v=ye));const On=Ci([Ye,Se,We,Fe],([ye,hn,Gi,Wr])=>{const ka={};return ye&&(ka.x=ye),hn&&(ka.y=hn),Gi&&(ka.z=Gi),Wr&&(ka.r=Wr),ka}),xn=Ci([et,_e,Ce],([ye])=>Object.assign({top:0,right:0,bottom:0,left:0},ye)),os=Ci([_e,Ce,xn],([ye,hn,Gi])=>{const Wr={};return Wr.top=Gi.top,Wr.right=ye-Gi.right,Wr.bottom=hn-Gi.bottom,Wr.left=Gi.left,Wr.width=Wr.right-Wr.left,Wr.height=Wr.bottom-Wr.top,Wr.width<=0&&he===!0&&console.warn("[LayerCake] Target div has zero or negative width. Did you forget to set an explicit width in CSS on the container?"),Wr.height<=0&&he===!0&&console.warn("[LayerCake] Target div has zero or negative height. Did you forget to set an explicit height in CSS on the container?"),Wr}),Ei=Ci([os],([ye])=>ye.width);Xt(h,Ei,ye=>d(8,Mr=ye));const ba=Ci([os],([ye])=>ye.height);Xt(h,ba,ye=>d(9,Zr=ye));const qi=Ci([ve,On,Me],([ye,hn,Gi])=>{const Wr=Cp(hn,Gi);return Object.keys(Wr).length>0?{...Hg(ye,Wr),...Gi}:{}}),Ti=Ci([qi,qe],lh("x")),Jn=Ci([qi,Mt],lh("y")),Zi=Ci([qi,Ze],lh("z")),xa=Ci([qi,Vt],lh("r")),ss=Ci([Xr,qi,Ti,Gt,lr,ii,Ei,ba,xr,J],fh("x")),Ol=Ci([Ye,ss],dh),po=Ci([va,qi,Jn,tr,Pt,$t,Ei,ba,Di,J],fh("y")),Fl=Ci([Se,po],dh),Fo=Ci([Si,qi,Zi,si,er,vr,Ei,ba,ja,J],fh("z")),Nl=Ci([We,Fo],dh),No=Ci([li,qi,xa,Bn,Jt,fr,Ei,ba,ga,J],fh("r")),Ns=Ci([Fe,No],dh),qa=Ci([ss],mh),ls=Ci([po],mh),fo=Ci([Fo],mh),Us=Ci([No],mh),Za=Ci([Ei,ba],([ye,hn])=>ye/hn);Xt(h,Za,ye=>d(10,sr=ye));function Fn(ye){Nu[ye?"unshift":"push"](()=>{Ar=ye,d(2,Ar)})}function wa(){cr=this.clientWidth,Fi=this.clientHeight,d(0,cr),d(1,Fi)}return h.$$set=ye=>{"ssr"in ye&&d(3,Gr=ye.ssr),"pointerEvents"in ye&&d(4,mr=ye.pointerEvents),"position"in ye&&d(5,Nr=ye.position),"percentRange"in ye&&d(51,jt=ye.percentRange),"width"in ye&&d(52,Dr=ye.width),"height"in ye&&d(53,Kr=ye.height),"containerWidth"in ye&&d(0,cr=ye.containerWidth),"containerHeight"in ye&&d(1,Fi=ye.containerHeight),"element"in ye&&d(2,Ar=ye.element),"x"in ye&&d(54,bi=ye.x),"y"in ye&&d(55,pi=ye.y),"z"in ye&&d(56,Qi=ye.z),"r"in ye&&d(57,Mi=ye.r),"data"in ye&&d(58,fi=ye.data),"xDomain"in ye&&d(59,ri=ye.xDomain),"yDomain"in ye&&d(60,sn=ye.yDomain),"zDomain"in ye&&d(61,di=ye.zDomain),"rDomain"in ye&&d(62,Ur=ye.rDomain),"xNice"in ye&&d(63,$i=ye.xNice),"yNice"in ye&&d(64,Ln=ye.yNice),"zNice"in ye&&d(65,Ni=ye.zNice),"rNice"in ye&&d(66,zn=ye.rNice),"xReverse"in ye&&d(67,en=ye.xReverse),"yReverse"in ye&&d(68,An=ye.yReverse),"zReverse"in ye&&d(69,Ui=ye.zReverse),"rReverse"in ye&&d(70,gn=ye.rReverse),"xPadding"in ye&&d(71,Vi=ye.xPadding),"yPadding"in ye&&d(72,Rn=ye.yPadding),"zPadding"in ye&&d(73,tn=ye.zPadding),"rPadding"in ye&&d(74,ji=ye.rPadding),"xScale"in ye&&d(75,vn=ye.xScale),"yScale"in ye&&d(76,ln=ye.yScale),"zScale"in ye&&d(77,un=ye.zScale),"rScale"in ye&&d(78,bn=ye.rScale),"xRange"in ye&&d(79,oi=ye.xRange),"yRange"in ye&&d(80,Pr=ye.yRange),"zRange"in ye&&d(81,L=ye.zRange),"rRange"in ye&&d(82,N=ye.rRange),"padding"in ye&&d(83,V=ye.padding),"extents"in ye&&d(84,W=ye.extents),"flatData"in ye&&d(85,$=ye.flatData),"custom"in ye&&d(86,se=ye.custom),"$$scope"in ye&&d(89,Wt=ye.$$scope)},h.$$.update=()=>{h.$$.dirty[1]&8388608&&bi&&d(87,j.x=bi,j),h.$$.dirty[1]&16777216&&pi&&d(87,j.y=pi,j),h.$$.dirty[1]&33554432&&Qi&&d(87,j.z=Qi,j),h.$$.dirty[1]&67108864&&Mi&&d(87,j.r=Mi,j),h.$$.dirty[1]&268435456&&ri&&d(87,j.xDomain=ri,j),h.$$.dirty[1]&536870912&&sn&&d(87,j.yDomain=sn,j),h.$$.dirty[1]&1073741824&&di&&d(87,j.zDomain=di,j),h.$$.dirty[2]&1&&Ur&&d(87,j.rDomain=Ur,j),h.$$.dirty[2]&131072&&oi&&d(87,j.xRange=oi,j),h.$$.dirty[2]&262144&&Pr&&d(87,j.yRange=Pr,j),h.$$.dirty[2]&524288&&L&&d(87,j.zRange=L,j),h.$$.dirty[2]&1048576&&N&&d(87,j.rRange=N,j),h.$$.dirty[1]&1048576&&Tr(J,Fr=jt,Fr),h.$$.dirty[0]&1&&Tr(_e,pr=cr,pr),h.$$.dirty[0]&2&&Tr(Ce,At=Fi,At),h.$$.dirty[2]&4194304&&Tr(Me,Je=Cp(W),Je),h.$$.dirty[1]&134217728&&Tr(K,ei=fi,ei),h.$$.dirty[1]&134217728|h.$$.dirty[2]&8388608&&Tr(ve,Ut=$||fi,Ut),h.$$.dirty[2]&2097152&&Tr(et,zt=V,zt),h.$$.dirty[1]&8388608&&Tr(Ye,pt=is(bi),pt),h.$$.dirty[1]&16777216&&Tr(Se,Zt=is(pi),Zt),h.$$.dirty[1]&33554432&&Tr(We,tt=is(Qi),tt),h.$$.dirty[1]&67108864&&Tr(Fe,It=is(Mi),It),h.$$.dirty[1]&268435456&&Tr(qe,yt=ri,yt),h.$$.dirty[1]&536870912&&Tr(Mt,Ft=sn,Ft),h.$$.dirty[1]&1073741824&&Tr(Ze,ht=di,ht),h.$$.dirty[2]&1&&Tr(Vt,_t=Ur,_t),h.$$.dirty[2]&2&&Tr(lr,qt=$i,qt),h.$$.dirty[2]&4&&Tr(Pt,Lt=Ln,Lt),h.$$.dirty[2]&8&&Tr(er,Tt=Ni,Tt),h.$$.dirty[2]&16&&Tr(Jt,He=zn,He),h.$$.dirty[2]&32&&Tr(ii,De=en,De),h.$$.dirty[2]&64&&Tr($t,Oe=An,Oe),h.$$.dirty[2]&128&&Tr(vr,Ve=Ui,Ve),h.$$.dirty[2]&256&&Tr(fr,xe=gn,xe),h.$$.dirty[2]&512&&Tr(Gt,we=Vi,we),h.$$.dirty[2]&1024&&Tr(tr,fe=Rn,fe),h.$$.dirty[2]&2048&&Tr(si,de=tn,de),h.$$.dirty[2]&4096&&Tr(Bn,ae=ji,ae),h.$$.dirty[2]&131072&&Tr(xr,H=oi,H),h.$$.dirty[2]&262144&&Tr(Di,D=Pr,D),h.$$.dirty[2]&524288&&Tr(ja,R=L,R),h.$$.dirty[2]&1048576&&Tr(ga,F=N,F),h.$$.dirty[2]&8192&&Tr(Xr,M=vn,M),h.$$.dirty[2]&16384&&Tr(va,T=ln,T),h.$$.dirty[2]&32768&&Tr(Si,I=un,I),h.$$.dirty[2]&65536&&Tr(li,a=bn,a),h.$$.dirty[2]&16777216&&Tr(Lr,v=se,v),h.$$.dirty[2]&33554432&&Tr(cn,_=j,_),h.$$.dirty[2]&67108864&&$m("LayerCake",f)},d(88,f={activeGetters:On,width:Ei,height:ba,percentRange:J,aspectRatio:Za,containerWidth:_e,containerHeight:Ce,x:Ye,y:Se,z:We,r:Fe,custom:Lr,data:K,xNice:lr,yNice:Pt,zNice:er,rNice:Jt,xReverse:ii,yReverse:$t,zReverse:vr,rReverse:fr,xPadding:Gt,yPadding:tr,zPadding:si,rPadding:Bn,padding:xn,flatData:ve,extents:qi,xDomain:Ti,yDomain:Jn,zDomain:Zi,rDomain:xa,xRange:qa,yRange:ls,zRange:fo,rRange:Us,config:cn,xScale:ss,xGet:Ol,yScale:po,yGet:Fl,zScale:Fo,zGet:Nl,rScale:No,rGet:Ns}),[cr,Fi,Ar,Gr,mr,Nr,At,pr,Mr,Zr,sr,J,_e,Ce,Me,K,ve,et,Ye,Se,We,Fe,qe,Mt,Ze,Vt,lr,Pt,er,Jt,ii,$t,vr,fr,Gt,tr,si,Bn,xr,Di,ja,ga,Xr,va,Si,li,cn,Lr,Ei,ba,Za,jt,Dr,Kr,bi,pi,Qi,Mi,fi,ri,sn,di,Ur,$i,Ln,Ni,zn,en,An,Ui,gn,Vi,Rn,tn,ji,vn,ln,un,bn,oi,Pr,L,N,V,W,$,se,j,f,Wt,ti,Fn,wa]}class p0 extends mn{constructor(c){super(),yn(this,c,h0,c0,_n,{ssr:3,pointerEvents:4,position:5,percentRange:51,width:52,height:53,containerWidth:0,containerHeight:1,element:2,x:54,y:55,z:56,r:57,data:58,xDomain:59,yDomain:60,zDomain:61,rDomain:62,xNice:63,yNice:64,zNice:65,rNice:66,xReverse:67,yReverse:68,zReverse:69,rReverse:70,xPadding:71,yPadding:72,zPadding:73,rPadding:74,xScale:75,yScale:76,zScale:77,rScale:78,xRange:79,yRange:80,zRange:81,rRange:82,padding:83,extents:84,flatData:85,custom:86},null,[-1,-1,-1,-1,-1])}}const f0=h=>({element:h&1}),Hd=h=>({element:h[0]}),d0=h=>({element:h&1}),Jd=h=>({element:h[0]});function m0(h){let c,d,f,_,v;const a=h[12].defs,I=Ru(a,h,h[11],Jd),T=h[12].default,M=Ru(T,h,h[11],Hd);return{c(){c=Wn("svg"),d=Wn("defs"),I&&I.c(),f=Wn("g"),M&&M.c(),this.h()},l(F){c=Hn(F,"svg",{class:!0,viewBox:!0,width:!0,height:!0});var R=Be(c);d=Hn(R,"defs",{});var D=Be(d);I&&I.l(D),D.forEach(oe),f=Hn(R,"g",{class:!0,transform:!0});var H=Be(f);M&&M.l(H),H.forEach(oe),R.forEach(oe),this.h()},h(){ne(f,"class","layercake-layout-svg_g"),ne(f,"transform",_="translate("+h[7].left+", "+h[7].top+")"),ne(c,"class","layercake-layout-svg svelte-u84d8d"),ne(c,"viewBox",h[4]),ne(c,"width",h[5]),ne(c,"height",h[6]),Ke(c,"z-index",h[2]),Ke(c,"pointer-events",h[3]===!1?"none":null)},m(F,R){Le(F,c,R),Ee(c,d),I&&I.m(d,null),Ee(c,f),M&&M.m(f,null),h[13](f),h[14](c),v=!0},p(F,[R]){I&&I.p&&(!v||R&2049)&&Bu(I,a,F,F[11],v?Fu(a,F[11],R,d0):Ou(F[11]),Jd),M&&M.p&&(!v||R&2049)&&Bu(M,T,F,F[11],v?Fu(T,F[11],R,f0):Ou(F[11]),Hd),(!v||R&128&&_!==(_="translate("+F[7].left+", "+F[7].top+")"))&&ne(f,"transform",_),(!v||R&16)&&ne(c,"viewBox",F[4]),(!v||R&32)&&ne(c,"width",F[5]),(!v||R&64)&&ne(c,"height",F[6]),R&4&&Ke(c,"z-index",F[2]),R&8&&Ke(c,"pointer-events",F[3]===!1?"none":null)},i(F){v||(it(I,F),it(M,F),v=!0)},o(F){lt(I,F),lt(M,F),v=!1},d(F){F&&oe(c),I&&I.d(F),M&&M.d(F),h[13](null),h[14](null)}}}function y0(h,c,d){let f,_,v,{$$slots:a={},$$scope:I}=c,{element:T=void 0}=c,{innerElement:M=void 0}=c,{zIndex:F=void 0}=c,{pointerEvents:R=void 0}=c,{viewBox:D=void 0}=c;const{containerWidth:H,containerHeight:ae,padding:de}=Gu("LayerCake");Xt(h,H,xe=>d(5,f=xe)),Xt(h,ae,xe=>d(6,_=xe)),Xt(h,de,xe=>d(7,v=xe));function fe(xe){Nu[xe?"unshift":"push"](()=>{M=xe,d(1,M)})}function we(xe){Nu[xe?"unshift":"push"](()=>{T=xe,d(0,T)})}return h.$$set=xe=>{"element"in xe&&d(0,T=xe.element),"innerElement"in xe&&d(1,M=xe.innerElement),"zIndex"in xe&&d(2,F=xe.zIndex),"pointerEvents"in xe&&d(3,R=xe.pointerEvents),"viewBox"in xe&&d(4,D=xe.viewBox),"$$scope"in xe&&d(11,I=xe.$$scope)},[T,M,F,R,D,f,_,v,H,ae,de,I,a,fe,we]}class _0 extends mn{constructor(c){super(),yn(this,c,y0,m0,_n,{element:0,innerElement:1,zIndex:2,pointerEvents:3,viewBox:4})}}function Yd(h,c,d){const f=h.slice();return f[23]=c[d],f[25]=d,f}function Qd(h){let c,d,f,_;return{c(){c=Wn("rect"),this.h()},l(v){c=Hn(v,"rect",{class:!0,"data-id":!0,x:!0,y:!0,width:!0,height:!0,fill:!0,stroke:!0,"stroke-width":!0}),Be(c).forEach(oe),this.h()},h(){ne(c,"class","group-rect"),ne(c,"data-id",h[25]),ne(c,"x",d=h[11].bandwidth?h[7](h[23]):h[7](h[23])[0]),ne(c,"y",f=h[13](h[12](h[23]))-1),ne(c,"width",_=h[11].bandwidth?h[11].bandwidth():h[9](h[23])),ne(c,"height","3"),ne(c,"fill","#308182"),ne(c,"stroke",h[0]),ne(c,"stroke-width",h[1])},m(v,a){Le(v,c,a)},p(v,a){a&3200&&d!==(d=v[11].bandwidth?v[7](v[23]):v[7](v[23])[0])&&ne(c,"x",d),a&13312&&f!==(f=v[13](v[12](v[23]))-1)&&ne(c,"y",f),a&3584&&_!==(_=v[11].bandwidth?v[11].bandwidth():v[9](v[23]))&&ne(c,"width",_),a&1&&ne(c,"stroke",v[0]),a&2&&ne(c,"stroke-width",v[1])},d(v){v&&oe(c)}}}function $d(h){let c,d,f,_,v,a,I,T,M=h[12]&&Qd(h);return{c(){c=Wn("rect"),M&&M.c(),a=Wn("text"),this.h()},l(F){c=Hn(F,"rect",{class:!0,"data-id":!0,x:!0,y:!0,width:!0,height:!0,fill:!0,stroke:!0,"stroke-width":!0}),Be(c).forEach(oe),M&&M.l(F),a=Hn(F,"text",{x:!0,y:!0,dx:!0,dy:!0,"text-anchor":!0}),Be(a).forEach(oe),this.h()},h(){ne(c,"class","group-rect"),ne(c,"data-id",h[25]),ne(c,"x",d=h[11].bandwidth?h[7](h[23]):h[7](h[23])[0]),ne(c,"y",f=h[6](h[23])),ne(c,"width",_=h[11].bandwidth?h[11].bandwidth():h[9](h[23])),ne(c,"height",v=h[8](h[23])),ne(c,"fill",h[4]),ne(c,"stroke",h[0]),ne(c,"stroke-width",h[1]),ne(a,"x",I=h[11].bandwidth?h[7](h[23])+h[11].bandwidth()/2:h[7](h[23])[0]),ne(a,"y",T=h[6](h[23])-4),ne(a,"dx",h[2]),ne(a,"dy",h[3]),ne(a,"text-anchor",h[5])},m(F,R){Le(F,c,R),M&&M.m(F,R),Le(F,a,R)},p(F,R){R&3200&&d!==(d=F[11].bandwidth?F[7](F[23]):F[7](F[23])[0])&&ne(c,"x",d),R&1088&&f!==(f=F[6](F[23]))&&ne(c,"y",f),R&3584&&_!==(_=F[11].bandwidth?F[11].bandwidth():F[9](F[23]))&&ne(c,"width",_),R&1280&&v!==(v=F[8](F[23]))&&ne(c,"height",v),R&16&&ne(c,"fill",F[4]),R&1&&ne(c,"stroke",F[0]),R&2&&ne(c,"stroke-width",F[1]),F[12]?M?M.p(F,R):(M=Qd(F),M.c(),M.m(a.parentNode,a)):M&&(M.d(1),M=null),R&3200&&I!==(I=F[11].bandwidth?F[7](F[23])+F[11].bandwidth()/2:F[7](F[23])[0])&&ne(a,"x",I),R&1088&&T!==(T=F[6](F[23])-4)&&ne(a,"y",T),R&4&&ne(a,"dx",F[2]),R&8&&ne(a,"dy",F[3]),R&32&&ne(a,"text-anchor",F[5])},d(F){F&&oe(c),M&&M.d(F),F&&oe(a)}}}function g0(h){let c,d=h[10],f=[];for(let _=0;_<d.length;_+=1)f[_]=$d(Yd(h,d,_));return{c(){c=Wn("g");for(let _=0;_<f.length;_+=1)f[_].c();this.h()},l(_){c=Hn(_,"g",{class:!0});var v=Be(c);for(let a=0;a<f.length;a+=1)f[a].l(v);v.forEach(oe),this.h()},h(){ne(c,"class","column-group svelte-wgzwsk")},m(_,v){Le(_,c,v);for(let a=0;a<f.length;a+=1)f[a]&&f[a].m(c,null)},p(_,[v]){if(v&16383){d=_[10];let a;for(a=0;a<d.length;a+=1){const I=Yd(_,d,a);f[a]?f[a].p(I,v):(f[a]=$d(I),f[a].c(),f[a].m(c,null))}for(;a<f.length;a+=1)f[a].d(1);f.length=d.length}},i:vi,o:vi,d(_){_&&oe(c),on(f,_)}}}function v0(h,c,d){let f,_,v,a,I,T,M,F,R;const{data:D,xGet:H,yGet:ae,yRange:de,xScale:fe,yScale:we,y:xe,z:Ve}=Gu("LayerCake");Xt(h,D,_t=>d(10,T=_t)),Xt(h,H,_t=>d(7,I=_t)),Xt(h,ae,_t=>d(6,v=_t)),Xt(h,de,_t=>d(21,a=_t)),Xt(h,fe,_t=>d(11,M=_t)),Xt(h,we,_t=>d(13,R=_t)),Xt(h,Ve,_t=>d(12,F=_t));let{stroke:Oe=""}=c,{strokeWidth:De=0}=c,{dxTick:He=0}=c,{dyTick:Tt=0}=c,{fill:Lt="#00205b"}=c,{textAnchor:qt="middle"}=c;return h.$$set=_t=>{"stroke"in _t&&d(0,Oe=_t.stroke),"strokeWidth"in _t&&d(1,De=_t.strokeWidth),"dxTick"in _t&&d(2,He=_t.dxTick),"dyTick"in _t&&d(3,Tt=_t.dyTick),"fill"in _t&&d(4,Lt=_t.fill),"textAnchor"in _t&&d(5,qt=_t.textAnchor)},h.$$.update=()=>{h.$$.dirty&128&&d(9,f=_t=>{const ht=I(_t);return Math.max(0,ht[1]-ht[0])}),h.$$.dirty&2097216&&d(8,_=_t=>a[0]-v(_t))},[Oe,De,He,Tt,Lt,qt,v,I,_,f,T,M,F,R,D,H,ae,de,fe,we,Ve,a]}class b0 extends mn{constructor(c){super(),yn(this,c,v0,g0,_n,{stroke:0,strokeWidth:1,dxTick:2,dyTick:3,fill:4,textAnchor:5})}}function em(h,c,d){const f=h.slice();return f[28]=c[d],f[30]=d,f}function tm(h){let c,d,f,_;return{c(){c=Wn("line"),this.h()},l(v){c=Hn(v,"line",{y1:!0,y2:!0,x1:!0,x2:!0,stroke:!0,"stroke-width":!0,class:!0}),Be(c).forEach(oe),this.h()},h(){ne(c,"y1",d=h[20]*-1),ne(c,"y2",f=h[14]&&h[30]%2==0?h[10]+h[8]+2:h[10]+h[8]-13),ne(c,"x1","0"),ne(c,"x2","0"),ne(c,"stroke",h[11]),ne(c,"stroke-width",_=h[15]&&Array.isArray(h[4])&&h[30]==Math.floor(h[4].length/2)?2:1),ne(c,"class","svelte-fwjh80"),Xn(c,"baseline",h[13])},m(v,a){Le(v,c,a)},p(v,a){a&1048576&&d!==(d=v[20]*-1)&&ne(c,"y1",d),a&17664&&f!==(f=v[14]&&v[30]%2==0?v[10]+v[8]+2:v[10]+v[8]-13)&&ne(c,"y2",f),a&2048&&ne(c,"stroke",v[11]),a&32784&&_!==(_=v[15]&&Array.isArray(v[4])&&v[30]==Math.floor(v[4].length/2)?2:1)&&ne(c,"stroke-width",_),a&8192&&Xn(c,"baseline",v[13])},d(v){v&&oe(c)}}}function x0(h){let c=h[1](h[28])+"",d;return{c(){d=St(c)},l(f){d=Et(f,c)},m(f,_){Le(f,d,_)},p(f,_){_&262146&&c!==(c=f[1](f[28])+"")&&Er(d,c)},d(f){f&&oe(d)}}}function w0(h){let c,d=h[1](h[28])+"",f,_;return{c(){c=St(h[5]),f=St(d),_=St(h[6])},l(v){c=Et(v,h[5]),f=Et(v,d),_=Et(v,h[6])},m(v,a){Le(v,c,a),Le(v,f,a),Le(v,_,a)},p(v,a){a&32&&Er(c,v[5]),a&262146&&d!==(d=v[1](v[28])+"")&&Er(f,d),a&64&&Er(_,v[6])},d(v){v&&oe(c),v&&oe(f),v&&oe(_)}}}function rm(h){let c,d,f,_,v,a,I,T=h[0]!==!1&&tm(h);function M(D,H){return D[30]==D[18].length-1?w0:x0}let F=M(h),R=F(h);return{c(){c=Wn("g"),T&&T.c(),d=Wn("text"),R.c(),this.h()},l(D){c=Hn(D,"g",{class:!0,transform:!0});var H=Be(c);T&&T.l(H),d=Hn(H,"text",{x:!0,y:!0,dx:!0,dy:!0,"text-anchor":!0,fill:!0,class:!0});var ae=Be(d);R.l(ae),ae.forEach(oe),H.forEach(oe),this.h()},h(){ne(d,"x",f=h[7]||h[16]?h[17].bandwidth()/2:0),ne(d,"y",_=h[3]?h[20]*-1-6:h[14]&&h[30]%2==0?h[8]+15:h[8]),ne(d,"dx",v=h[24](h[30])=="start"?h[9]-2:h[24](h[30])=="end"?h[9]+2:h[9]),ne(d,"dy",h[10]),ne(d,"text-anchor",h[24](h[30])),ne(d,"fill",h[12]),ne(d,"class","svelte-fwjh80"),Xn(d,"bold",h[15]&&Array.isArray(h[4])&&h[30]==Math.floor(h[4].length/2)),ne(c,"class",a="tick tick-"+h[28]+" svelte-fwjh80"),ne(c,"transform",I="translate("+h[17](h[28])+","+h[19][0]+")")},m(D,H){Le(D,c,H),T&&T.m(c,null),Ee(c,d),R.m(d,null)},p(D,H){D[0]!==!1?T?T.p(D,H):(T=tm(D),T.c(),T.m(c,d)):T&&(T.d(1),T=null),F===(F=M(D))&&R?R.p(D,H):(R.d(1),R=F(D),R&&(R.c(),R.m(d,null))),H&196736&&f!==(f=D[7]||D[16]?D[17].bandwidth()/2:0)&&ne(d,"x",f),H&1065224&&_!==(_=D[3]?D[20]*-1-6:D[14]&&D[30]%2==0?D[8]+15:D[8])&&ne(d,"y",_),H&512&&v!==(v=D[24](D[30])=="start"?D[9]-2:D[24](D[30])=="end"?D[9]+2:D[9])&&ne(d,"dx",v),H&1024&&ne(d,"dy",D[10]),H&4096&&ne(d,"fill",D[12]),H&32784&&Xn(d,"bold",D[15]&&Array.isArray(D[4])&&D[30]==Math.floor(D[4].length/2)),H&262144&&a!==(a="tick tick-"+D[28]+" svelte-fwjh80")&&ne(c,"class",a),H&917504&&I!==(I="translate("+D[17](D[28])+","+D[19][0]+")")&&ne(c,"transform",I)},d(D){D&&oe(c),T&&T.d(),R.d()}}}function im(h){let c,d,f;return{c(){c=Wn("line"),this.h()},l(_){c=Hn(_,"line",{class:!0,y1:!0,y2:!0,x1:!0,x2:!0,stroke:!0}),Be(c).forEach(oe),this.h()},h(){ne(c,"class","baseline svelte-fwjh80"),ne(c,"y1",h[20]),ne(c,"y2","0"),ne(c,"x1",d=h[17](0)),ne(c,"x2",f=h[17](0)),ne(c,"stroke",h[11])},m(_,v){Le(_,c,v)},p(_,v){v&1048576&&ne(c,"y1",_[20]),v&131072&&d!==(d=_[17](0))&&ne(c,"x1",d),v&131072&&f!==(f=_[17](0))&&ne(c,"x2",f),v&2048&&ne(c,"stroke",_[11])},d(_){_&&oe(c)}}}function k0(h){let c,d,f=h[18],_=[];for(let a=0;a<f.length;a+=1)_[a]=rm(em(h,f,a));let v=h[2]===!0&&im(h);return{c(){c=Wn("g");for(let a=0;a<_.length;a+=1)_[a].c();d=br(),v&&v.c(),this.h()},l(a){c=Hn(a,"g",{class:!0});var I=Be(c);for(let T=0;T<_.length;T+=1)_[T].l(I);d=br(),v&&v.l(I),I.forEach(oe),this.h()},h(){ne(c,"class","axis x-axis")},m(a,I){Le(a,c,I);for(let T=0;T<_.length;T+=1)_[T]&&_[T].m(c,null);Ee(c,d),v&&v.m(c,null)},p(a,[I]){if(I&18874363){f=a[18];let T;for(T=0;T<f.length;T+=1){const M=em(a,f,T);_[T]?_[T].p(M,I):(_[T]=rm(M),_[T].c(),_[T].m(c,d))}for(;T<_.length;T+=1)_[T].d(1);_.length=f.length}a[2]===!0?v?v.p(a,I):(v=im(a),v.c(),v.m(c,null)):v&&(v.d(1),v=null)},i:vi,o:vi,d(a){a&&oe(c),on(_,a),v&&v.d()}}}function S0(h,c,d){let f,_,v,a,I;const{width:T,height:M,xScale:F,yScale:R,yRange:D}=Gu("LayerCake");Xt(h,M,tt=>d(20,I=tt)),Xt(h,F,tt=>d(17,v=tt)),Xt(h,D,tt=>d(19,a=tt));let{gridlines:H=!0}=c,{formatTick:ae=tt=>tt}=c,{baseline:de=!1}=c,{flipped:fe=!1}=c,{snapTicks:we=!1}=c,{ticks:xe=void 0}=c,{prefix:Ve=""}=c,{suffix:Oe=""}=c,{xTick:De=void 0}=c,{yTick:He=15}=c,{dxTick:Tt=0}=c,{dyTick:Lt=0}=c,{lineColor:qt="#999"}=c,{textColor:_t="#555"}=c,{solid:ht=!1}=c,{stagger:Ft=!1}=c,{median:yt=!0}=c;function It(tt){if(we===!0){if(tt===0)return"start";if(tt===_.length-1)return"end"}return"middle"}return h.$$set=tt=>{"gridlines"in tt&&d(0,H=tt.gridlines),"formatTick"in tt&&d(1,ae=tt.formatTick),"baseline"in tt&&d(2,de=tt.baseline),"flipped"in tt&&d(3,fe=tt.flipped),"snapTicks"in tt&&d(25,we=tt.snapTicks),"ticks"in tt&&d(4,xe=tt.ticks),"prefix"in tt&&d(5,Ve=tt.prefix),"suffix"in tt&&d(6,Oe=tt.suffix),"xTick"in tt&&d(7,De=tt.xTick),"yTick"in tt&&d(8,He=tt.yTick),"dxTick"in tt&&d(9,Tt=tt.dxTick),"dyTick"in tt&&d(10,Lt=tt.dyTick),"lineColor"in tt&&d(11,qt=tt.lineColor),"textColor"in tt&&d(12,_t=tt.textColor),"solid"in tt&&d(13,ht=tt.solid),"stagger"in tt&&d(14,Ft=tt.stagger),"median"in tt&&d(15,yt=tt.median)},h.$$.update=()=>{h.$$.dirty&131072&&d(16,f=typeof v.bandwidth=="function"),h.$$.dirty&196624&&d(18,_=Array.isArray(xe)?xe:f?v.domain():v.ticks(xe))},[H,ae,de,fe,xe,Ve,Oe,De,He,Tt,Lt,qt,_t,ht,Ft,yt,f,v,_,a,I,M,F,D,It,we]}class E0 extends mn{constructor(c){super(),yn(this,c,S0,k0,_n,{gridlines:0,formatTick:1,baseline:2,flipped:3,snapTicks:25,ticks:4,prefix:5,suffix:6,xTick:7,yTick:8,dxTick:9,dyTick:10,lineColor:11,textColor:12,solid:13,stagger:14,median:15})}}function T0(h){let c,d,f,_;return c=new b0({props:{fill:h[1],formatVal:h[5]}}),f=new E0({props:{gridlines:!1}}),{c(){ir(c.$$.fragment),d=ft(),ir(f.$$.fragment)},l(v){nr(c.$$.fragment,v),d=dt(v),nr(f.$$.fragment,v)},m(v,a){ar(c,v,a),Le(v,d,a),ar(f,v,a),_=!0},p(v,a){const I={};a&2&&(I.fill=v[1]),a&32&&(I.formatVal=v[5]),c.$set(I)},i(v){_||(it(c.$$.fragment,v),it(f.$$.fragment,v),_=!0)},o(v){lt(c.$$.fragment,v),lt(f.$$.fragment,v),_=!1},d(v){or(c,v),v&&oe(d),or(f,v)}}}function I0(h){let c,d;return c=new _0({props:{$$slots:{default:[T0]},$$scope:{ctx:h}}}),{c(){ir(c.$$.fragment)},l(f){nr(c.$$.fragment,f)},m(f,_){ar(c,f,_),d=!0},p(f,_){const v={};_&1058&&(v.$$scope={dirty:_,ctx:f}),c.$set(v)},i(f){d||(it(c.$$.fragment,f),d=!0)},o(f){lt(c.$$.fragment,f),d=!1},d(f){or(c,f)}}}function z0(h){let c,d,f;return d=new p0({props:{padding:{top:15,right:0,bottom:20,left:0},x:h[2],y:h[3],z:h[4],xScale:cy().paddingInner([.02]).round(!0),xDomain:h[7],yDomain:h[6],zDomain:h[6],data:h[0],$$slots:{default:[I0]},$$scope:{ctx:h}}}),{c(){c=Ne("div"),ir(d.$$.fragment),this.h()},l(_){c=Ue(_,"DIV",{class:!0});var v=Be(c);nr(d.$$.fragment,v),v.forEach(oe),this.h()},h(){ne(c,"class","chart-container svelte-1i1qsul")},m(_,v){Le(_,c,v),ar(d,c,null),f=!0},p(_,[v]){const a={};v&4&&(a.x=_[2]),v&8&&(a.y=_[3]),v&16&&(a.z=_[4]),v&128&&(a.xDomain=_[7]),v&64&&(a.yDomain=_[6]),v&64&&(a.zDomain=_[6]),v&1&&(a.data=_[0]),v&1058&&(a.$$scope={dirty:v,ctx:_}),d.$set(a)},i(_){f||(it(d.$$.fragment,_),f=!0)},o(_){lt(d.$$.fragment,_),f=!1},d(_){_&&oe(c),or(d)}}}function A0(h,c,d){let f,_,v,{data:a}=c,{suffix:I="%"}=c,{decimals:T=null}=c,{fill:M="#00205B"}=c,{xKey:F="x"}=c,{yKey:R="y"}=c,{zKey:D=null}=c;return h.$$set=H=>{"data"in H&&d(0,a=H.data),"suffix"in H&&d(8,I=H.suffix),"decimals"in H&&d(9,T=H.decimals),"fill"in H&&d(1,M=H.fill),"xKey"in H&&d(2,F=H.xKey),"yKey"in H&&d(3,R=H.yKey),"zKey"in H&&d(4,D=H.zKey)},h.$$.update=()=>{h.$$.dirty&5&&d(7,f=a.map(H=>H[F])),h.$$.dirty&9&&d(6,_=[0,Math.max(...a.map(H=>H[R]))]),h.$$.dirty&768&&d(5,v=H=>H.toFixed(T)+I)},[a,M,F,R,D,v,_,f,I,T]}class Rh extends mn{constructor(c){super(),yn(this,c,A0,z0,_n,{data:0,suffix:8,decimals:9,fill:1,xKey:2,yKey:3,zKey:4})}}function nm(h,c,d){const f=h.slice();return f[6]=c[d],f[8]=d,f}function am(h){let c,d=h[0],f=[];for(let _=0;_<d.length;_+=1)f[_]=om(nm(h,d,_));return{c(){c=Wn("svg");for(let _=0;_<f.length;_+=1)f[_].c();this.h()},l(_){c=Hn(_,"svg",{class:!0});var v=Be(c);for(let a=0;a<f.length;a+=1)f[a].l(v);v.forEach(oe),this.h()},h(){ne(c,"class","stack svelte-pzvhwz")},m(_,v){Le(_,c,v);for(let a=0;a<f.length;a+=1)f[a]&&f[a].m(c,null)},p(_,v){if(v&31){d=_[0];let a;for(a=0;a<d.length;a+=1){const I=nm(_,d,a);f[a]?f[a].p(I,v):(f[a]=om(I),f[a].c(),f[a].m(c,null))}for(;a<f.length;a+=1)f[a].d(1);f.length=d.length}},d(_){_&&oe(c),on(f,_)}}}function om(h){let c,d;return{c(){c=Wn("rect"),this.h()},l(f){c=Hn(f,"rect",{class:!0,x:!0,style:!0}),Be(c).forEach(oe),this.h()},h(){ne(c,"class","cell svelte-pzvhwz"),ne(c,"x",d=h[4][h[8]]/h[3]*100+"%"),Ke(c,"width",h[6][h[1]]/h[3]*100+"%"),Ke(c,"fill",h[2][h[8]])},m(f,_){Le(f,c,_)},p(f,_){_&24&&d!==(d=f[4][f[8]]/f[3]*100+"%")&&ne(c,"x",d),_&11&&Ke(c,"width",f[6][f[1]]/f[3]*100+"%"),_&4&&Ke(c,"fill",f[2][f[8]])},d(f){f&&oe(c)}}}function P0(h){let c,d=h[3]&&h[4]&&am(h);return{c(){d&&d.c(),c=br()},l(f){d&&d.l(f),c=br()},m(f,_){d&&d.m(f,_),Le(f,c,_)},p(f,[_]){f[3]&&f[4]?d?d.p(f,_):(d=am(f),d.c(),d.m(c.parentNode,c)):d&&(d.d(1),d=null)},i:vi,o:vi,d(f){d&&d.d(f),f&&oe(c)}}}function C0(h,c,d){let{data:f}=c,{yKey:_="y"}=c,{colors:v=["#00205B","#308182","#002417","#BD00BD","lightgrey"]}=c,a,I;function T(){d(3,a=f.map(F=>F[_]).reduce((F,R)=>F+R,0));let M=[0];f.forEach(F=>M.push(M[M.length-1]+F[_])),d(4,I=M)}return h.$$set=M=>{"data"in M&&d(0,f=M.data),"yKey"in M&&d(1,_=M.yKey),"colors"in M&&d(2,v=M.colors)},h.$$.update=()=>{h.$$.dirty&3&&(f||_)&&T()},[f,_,v,a,I]}class Jp extends mn{constructor(c){super(),yn(this,c,C0,P0,_n,{data:0,yKey:1,colors:2})}}function sm(h,c,d){const f=h.slice();return f[10]=c[d],f[12]=d,f}function M0(h){let c,d,f=h[6](h[10][h[3]])+"",_,v;return{c(){c=Ne("span"),d=St("(NI "),_=St(f),v=St(")"),this.h()},l(a){c=Ue(a,"SPAN",{class:!0,style:!0});var I=Be(c);d=Et(I,"(NI "),_=Et(I,f),v=Et(I,")"),I.forEach(oe),this.h()},h(){ne(c,"class",""),Ke(c,"color","#1460aa")},m(a,I){Le(a,c,I),Ee(c,d),Ee(c,_),Ee(c,v)},p(a,I){I&9&&f!==(f=a[6](a[10][a[3]])+"")&&Er(_,f)},d(a){a&&oe(c)}}}function D0(h){let c;return{c(){c=Ne("span"),this.h()},l(d){c=Ue(d,"SPAN",{class:!0,style:!0}),Be(c).forEach(oe),this.h()},h(){ne(c,"class",""),Ke(c,"color","#1460aa")},m(d,f){Le(d,c,f)},p:vi,d(d){d&&oe(c)}}}function L0(h){let c,d,f=gd(Math.round(h[10][h[3]]),"%)")+"",_;return{c(){c=Ne("span"),d=St("(2011 "),_=St(f),this.h()},l(v){c=Ue(v,"SPAN",{class:!0,style:!0});var a=Be(c);d=Et(a,"(2011 "),_=Et(a,f),a.forEach(oe),this.h()},h(){ne(c,"class",""),Ke(c,"color","#1460aa")},m(v,a){Le(v,c,a),Ee(c,d),Ee(c,_)},p(v,a){a&9&&f!==(f=gd(Math.round(v[10][v[3]]),"%)")+"")&&Er(_,f)},d(v){v&&oe(c)}}}function lm(h){let c,d,f,_,v,a=h[10][h[1]]+"",I,T,M,F=h[6](h[10][h[2]])+"",R,D,H;function ae(we,xe){if(we[3]=="prev"&&we[4])return L0;if(we[3]=="prev"&&!we[4])return D0;if(we[3])return M0}let de=ae(h),fe=de&&de(h);return{c(){c=Ne("tr"),d=Ne("td"),f=Wn("svg"),_=Wn("rect"),v=ft(),I=St(a),T=ft(),M=Ne("td"),R=St(F),D=ft(),fe&&fe.c(),H=ft(),this.h()},l(we){c=Ue(we,"TR",{});var xe=Be(c);d=Ue(xe,"TD",{class:!0});var Ve=Be(d);f=Hn(Ve,"svg",{width:!0,height:!0,class:!0});var Oe=Be(f);_=Hn(Oe,"rect",{width:!0,height:!0,style:!0}),Be(_).forEach(oe),Oe.forEach(oe),v=dt(Ve),I=Et(Ve,a),Ve.forEach(oe),T=dt(xe),M=Ue(xe,"TD",{class:!0,style:!0});var De=Be(M);R=Et(De,F),D=dt(De),fe&&fe.l(De),De.forEach(oe),H=dt(xe),xe.forEach(oe),this.h()},h(){ne(_,"width","20"),ne(_,"height","30"),Ke(_,"fill",h[5][h[12]]),ne(f,"width","20"),ne(f,"height","30"),ne(f,"class","bullet svelte-1gvovsq"),ne(d,"class","svelte-1gvovsq"),ne(M,"class","cell-right svelte-1gvovsq"),Ke(M,"vertical-align","top")},m(we,xe){Le(we,c,xe),Ee(c,d),Ee(d,f),Ee(f,_),Ee(d,v),Ee(d,I),Ee(c,T),Ee(c,M),Ee(M,R),Ee(M,D),fe&&fe.m(M,null),Ee(c,H)},p(we,xe){xe&32&&Ke(_,"fill",we[5][we[12]]),xe&3&&a!==(a=we[10][we[1]]+"")&&Er(I,a),xe&5&&F!==(F=we[6](we[10][we[2]])+"")&&Er(R,F),de===(de=ae(we))&&fe?fe.p(we,xe):(fe&&fe.d(1),fe=de&&de(we),fe&&(fe.c(),fe.m(M,null)))},d(we){we&&oe(c),fe&&fe.d()}}}function R0(h){let c,d,f=h[0],_=[];for(let v=0;v<f.length;v+=1)_[v]=lm(sm(h,f,v));return{c(){c=Ne("table"),d=Ne("tbody");for(let v=0;v<_.length;v+=1)_[v].c();this.h()},l(v){c=Ue(v,"TABLE",{class:!0});var a=Be(c);d=Ue(a,"TBODY",{});var I=Be(d);for(let T=0;T<_.length;T+=1)_[T].l(I);I.forEach(oe),a.forEach(oe),this.h()},h(){ne(c,"class","legend svelte-1gvovsq")},m(v,a){Le(v,c,a),Ee(c,d);for(let I=0;I<_.length;I+=1)_[I]&&_[I].m(d,null)},p(v,[a]){if(a&127){f=v[0];let I;for(I=0;I<f.length;I+=1){const T=sm(v,f,I);_[I]?_[I].p(T,a):(_[I]=lm(T),_[I].c(),_[I].m(d,null))}for(;I<_.length;I+=1)_[I].d(1);_.length=f.length}},i:vi,o:vi,d(v){v&&oe(c),on(_,v)}}}function B0(h,c,d){let f,{data:_}=c,{xKey:v="x"}=c,{yKey:a="y"}=c,{zKey:I="ni"}=c,{topic_prev_available:T=!0}=c,{colors:M=["#3878c5","#00205B","#308182","#002417","#BD00BD","lightgrey"]}=c,{decimals:F=null}=c;function R(D){let H;return F?H=(D/f*100).toFixed(F)+"%":D/f*100<1?H="<1%":H=(D/f*100).toFixed(0)+"%",H}return h.$$set=D=>{"data"in D&&d(0,_=D.data),"xKey"in D&&d(1,v=D.xKey),"yKey"in D&&d(2,a=D.yKey),"zKey"in D&&d(3,I=D.zKey),"topic_prev_available"in D&&d(4,T=D.topic_prev_available),"colors"in D&&d(5,M=D.colors),"decimals"in D&&d(7,F=D.decimals)},h.$$.update=()=>{h.$$.dirty&5&&(f=_.map(D=>D[a]).reduce((D,H)=>D+H,0)),h.$$.dirty&9&&_.map(D=>D[I]).reduce((D,H)=>D+H,0)},[_,v,a,I,T,M,R,F]}class O0 extends mn{constructor(c){super(),yn(this,c,B0,R0,_n,{data:0,xKey:1,yKey:2,zKey:3,topic_prev_available:4,colors:5,decimals:7})}}function um(h){let c,d,f,_;d=new Jp({props:{data:h[0],yKey:h[4],colors:h[6]}});let v=h[8]&&cm(h);return{c(){c=Ne("div"),ir(d.$$.fragment),f=ft(),v&&v.c(),this.h()},l(a){c=Ue(a,"DIV",{class:!0,style:!0});var I=Be(c);nr(d.$$.fragment,I),f=dt(I),v&&v.l(I),I.forEach(oe),this.h()},h(){ne(c,"class","chart svelte-1tebgpk"),Ke(c,"height",h[1]*.28+"px")},m(a,I){Le(a,c,I),ar(d,c,null),Ee(c,f),v&&v.m(c,null),_=!0},p(a,I){const T={};I&1&&(T.data=a[0]),I&16&&(T.yKey=a[4]),I&64&&(T.colors=a[6]),d.$set(T),a[8]?v?v.p(a,I):(v=cm(a),v.c(),v.m(c,null)):v&&(v.d(1),v=null),(!_||I&2)&&Ke(c,"height",a[1]*.28+"px")},i(a){_||(it(d.$$.fragment,a),_=!0)},o(a){lt(d.$$.fragment,a),_=!1},d(a){a&&oe(c),or(d),v&&v.d()}}}function cm(h){let c,d;return{c(){c=Ne("div"),d=St(h[8]),this.h()},l(f){c=Ue(f,"DIV",{class:!0});var _=Be(c);d=Et(_,h[8]),_.forEach(oe),this.h()},h(){ne(c,"class","label svelte-1tebgpk")},m(f,_){Le(f,c,_),Ee(c,d)},p(f,_){_&256&&Er(d,f[8])},d(f){f&&oe(c)}}}function hm(h){let c,d,f,_,v,a;return d=new Jp({props:{data:h[0],yKey:h[4],colors:h[6]}}),{c(){c=Ne("div"),ir(d.$$.fragment),f=ft(),_=Ne("div"),v=St("2011 comparison not available"),this.h()},l(I){c=Ue(I,"DIV",{class:!0,style:!0});var T=Be(c);nr(d.$$.fragment,T),f=dt(T),_=Ue(T,"DIV",{class:!0,style:!0});var M=Be(_);v=Et(M,"2011 comparison not available"),M.forEach(oe),T.forEach(oe),this.h()},h(){ne(_,"class","label svelte-1tebgpk"),Ke(_,"background-color","#d8d8d8 "),Ke(_,"color","#000000"),ne(c,"class","chart svelte-1tebgpk"),Ke(c,"height",h[1]*.28+"px")},m(I,T){Le(I,c,T),ar(d,c,null),Ee(c,f),Ee(c,_),Ee(_,v),a=!0},p(I,T){const M={};T&1&&(M.data=I[0]),T&16&&(M.yKey=I[4]),T&64&&(M.colors=I[6]),d.$set(M),(!a||T&2)&&Ke(c,"height",I[1]*.28+"px")},i(I){a||(it(d.$$.fragment,I),a=!0)},o(I){lt(d.$$.fragment,I),a=!1},d(I){I&&oe(c),or(d)}}}function F0(h){let c,d,f,_,v,a,I,T;d=new Jp({props:{data:h[0],yKey:h[3],colors:h[6]}});let M=(h[4]&&h[5]||h[4]=="ni")&&um(h),F=h[4]=="prev"&&!h[5]&&hm(h);return I=new O0({props:{data:h[0],xKey:h[2],yKey:h[3],zKey:h[4],topic_prev_available:h[5],decimals:h[7],colors:h[6]}}),{c(){c=Ne("div"),ir(d.$$.fragment),f=ft(),M&&M.c(),_=ft(),F&&F.c(),v=ft(),a=Ne("div"),ir(I.$$.fragment),this.h()},l(R){c=Ue(R,"DIV",{class:!0,style:!0});var D=Be(c);nr(d.$$.fragment,D),D.forEach(oe),f=dt(R),M&&M.l(R),_=dt(R),F&&F.l(R),v=dt(R),a=Ue(R,"DIV",{class:!0});var H=Be(a);nr(I.$$.fragment,H),H.forEach(oe),this.h()},h(){ne(c,"class","chart svelte-1tebgpk"),Ke(c,"padding-top","3px"),Ke(c,"height",(h[4]?h[1]*.72:h[1])+"px"),ne(a,"class","legend svelte-1tebgpk")},m(R,D){Le(R,c,D),ar(d,c,null),Le(R,f,D),M&&M.m(R,D),Le(R,_,D),F&&F.m(R,D),Le(R,v,D),Le(R,a,D),ar(I,a,null),T=!0},p(R,[D]){const H={};D&1&&(H.data=R[0]),D&8&&(H.yKey=R[3]),D&64&&(H.colors=R[6]),d.$set(H),(!T||D&18)&&Ke(c,"height",(R[4]?R[1]*.72:R[1])+"px"),R[4]&&R[5]||R[4]=="ni"?M?(M.p(R,D),D&48&&it(M,1)):(M=um(R),M.c(),it(M,1),M.m(_.parentNode,_)):M&&(ta(),lt(M,1,1,()=>{M=null}),ra()),R[4]=="prev"&&!R[5]?F?(F.p(R,D),D&48&&it(F,1)):(F=hm(R),F.c(),it(F,1),F.m(v.parentNode,v)):F&&(ta(),lt(F,1,1,()=>{F=null}),ra());const ae={};D&1&&(ae.data=R[0]),D&4&&(ae.xKey=R[2]),D&8&&(ae.yKey=R[3]),D&16&&(ae.zKey=R[4]),D&32&&(ae.topic_prev_available=R[5]),D&128&&(ae.decimals=R[7]),D&64&&(ae.colors=R[6]),I.$set(ae)},i(R){T||(it(d.$$.fragment,R),it(M),it(F),it(I.$$.fragment,R),T=!0)},o(R){lt(d.$$.fragment,R),lt(M),lt(F),lt(I.$$.fragment,R),T=!1},d(R){R&&oe(c),or(d),R&&oe(f),M&&M.d(R),R&&oe(_),F&&F.d(R),R&&oe(v),R&&oe(a),or(I)}}}function N0(h,c,d){let{data:f}=c,{height:_=80}=c,{xKey:v="x"}=c,{yKey:a="y"}=c,{zKey:I="ni"}=c,{topic_prev_available:T=!0}=c,{colors:M=["#8268b6","#00205B","#308182","#3d007a","#3878c5","lightgrey"]}=c,{decimals:F=null}=c,{label:R=null}=c;return h.$$set=D=>{"data"in D&&d(0,f=D.data),"height"in D&&d(1,_=D.height),"xKey"in D&&d(2,v=D.xKey),"yKey"in D&&d(3,a=D.yKey),"zKey"in D&&d(4,I=D.zKey),"topic_prev_available"in D&&d(5,T=D.topic_prev_available),"colors"in D&&d(6,M=D.colors),"decimals"in D&&d(7,F=D.decimals),"label"in D&&d(8,R=D.label)},[f,_,v,a,I,T,M,F,R]}class Bh extends mn{constructor(c){super(),yn(this,c,N0,F0,_n,{data:0,height:1,xKey:2,yKey:3,zKey:4,topic_prev_available:5,colors:6,decimals:7,label:8})}}function pm(h,c,d){const f=h.slice();return f[15]=c[d],f}function fm(h,c,d){const f=h.slice();return f[18]=c[d],f[19]=c,f[20]=d,f}function dm(h,c,d){const f=h.slice();return f[15]=c[d],f[20]=d,f}function mm(h){let c,d=h[5],f=[];for(let _=0;_<d.length;_+=1)f[_]=ym(dm(h,d,_));return{c(){c=Ne("ul");for(let _=0;_<f.length;_+=1)f[_].c();this.h()},l(_){c=Ue(_,"UL",{class:!0});var v=Be(c);for(let a=0;a<f.length;a+=1)f[a].l(v);v.forEach(oe),this.h()},h(){ne(c,"class","legend-block svelte-sk00pb")},m(_,v){Le(_,c,v);for(let a=0;a<f.length;a+=1)f[a]&&f[a].m(c,null)},p(_,v){if(v&32){d=_[5];let a;for(a=0;a<d.length;a+=1){const I=dm(_,d,a);f[a]?f[a].p(I,v):(f[a]=ym(I),f[a].c(),f[a].m(c,null))}for(;a<f.length;a+=1)f[a].d(1);f.length=d.length}},d(_){_&&oe(c),on(f,_)}}}function ym(h){let c,d,f,_,v=h[15]+"",a,I;return{c(){c=Ne("li"),d=Ne("div"),f=ft(),_=Ne("span"),a=St(v),I=ft(),this.h()},l(T){c=Ue(T,"LI",{class:!0});var M=Be(c);d=Ue(M,"DIV",{class:!0}),Be(d).forEach(oe),f=dt(M),_=Ue(M,"SPAN",{});var F=Be(_);a=Et(F,v),F.forEach(oe),I=dt(M),M.forEach(oe),this.h()},h(){ne(d,"class","legend-vis "+(h[20]==0?"bar":"bar2")+" svelte-sk00pb"),ne(c,"class","svelte-sk00pb")},m(T,M){Le(T,c,M),Ee(c,d),Ee(c,f),Ee(c,_),Ee(_,a),Ee(c,I)},p(T,M){M&32&&v!==(v=T[15]+"")&&Er(a,v)},d(T){T&&oe(c)}}}function _m(h){let c,d=`${h[4](h[18][h[0]])}%`,f,_,v=vm(h[18][h[0]])+"",a,I,T=`calc(${h[4](h[18][h[0]])}% + 2px)`;function M(){h[12].call(_,h[19],h[20])}return{c(){c=Ne("div"),f=ft(),_=Ne("div"),a=St(v),this.h()},l(F){c=Ue(F,"DIV",{class:!0}),Be(c).forEach(oe),f=dt(F),_=Ue(F,"DIV",{class:!0});var R=Be(_);a=Et(R,v),R.forEach(oe),this.h()},h(){ne(c,"class",Ph(h[20]==0?"bar":"bar2")+" svelte-sk00pb"),Ke(c,"left","0"),Ke(c,"width",d),Ke(c,"top",h[20]==0?"0":"50%"),Ke(c,"height",h[5][1]?"50%":"100%"),ne(_,"class","label svelte-sk00pb"),qu(()=>M.call(_)),Ke(_,"left",T),Ke(_,"top",h[20]==0?"0":"50%"),Ke(_,"height","50%")},m(F,R){Le(F,c,R),Le(F,f,R),Le(F,_,R),Ee(_,a),I=Zu(_,M.bind(_))},p(F,R){h=F,R&25&&d!==(d=`${h[4](h[18][h[0]])}%`)&&Ke(c,"width",d),R&32&&Ke(c,"height",h[5][1]?"50%":"100%"),R&9&&v!==(v=vm(h[18][h[0]])+"")&&Er(a,v),R&25&&T!==(T=`calc(${h[4](h[18][h[0]])}% + 2px)`)&&Ke(_,"left",T)},d(F){F&&oe(c),F&&oe(f),F&&oe(_),I()}}}function gm(h){let c,d=h[15].label+"",f,_,v,a,I=`${h[5][1]?h[1]*2:h[1]}px`,T=`calc(100% - ${h[2]}px)`,M=h[15].values,F=[];for(let R=0;R<M.length;R+=1)F[R]=_m(fm(h,M,R));return{c(){c=Ne("div"),f=St(d),_=ft(),v=Ne("div");for(let R=0;R<F.length;R+=1)F[R].c();a=ft(),this.h()},l(R){c=Ue(R,"DIV",{class:!0});var D=Be(c);f=Et(D,d),D.forEach(oe),_=dt(R),v=Ue(R,"DIV",{class:!0});var H=Be(v);for(let ae=0;ae<F.length;ae+=1)F[ae].l(H);a=dt(H),H.forEach(oe),this.h()},h(){ne(c,"class","label-group svelte-sk00pb"),ne(v,"class","bar-group svelte-sk00pb"),Ke(v,"height",I),Ke(v,"width",T)},m(R,D){Le(R,c,D),Ee(c,f),Le(R,_,D),Le(R,v,D);for(let H=0;H<F.length;H+=1)F[H]&&F[H].m(v,null);Ee(v,a)},p(R,D){if(D&8&&d!==(d=R[15].label+"")&&Er(f,d),D&57){M=R[15].values;let H;for(H=0;H<M.length;H+=1){const ae=fm(R,M,H);F[H]?F[H].p(ae,D):(F[H]=_m(ae),F[H].c(),F[H].m(v,a))}for(;H<F.length;H+=1)F[H].d(1);F.length=M.length}D&34&&I!==(I=`${R[5][1]?R[1]*2:R[1]}px`)&&Ke(v,"height",I),D&4&&T!==(T=`calc(100% - ${R[2]}px)`)&&Ke(v,"width",T)},d(R){R&&oe(c),R&&oe(_),R&&oe(v),on(F,R)}}}function U0(h){let c,d,f=h[5][1]&&mm(h),_=h[3],v=[];for(let a=0;a<_.length;a+=1)v[a]=gm(pm(h,_,a));return{c(){f&&f.c(),c=ft();for(let a=0;a<v.length;a+=1)v[a].c();d=br()},l(a){f&&f.l(a),c=dt(a);for(let I=0;I<v.length;I+=1)v[I].l(a);d=br()},m(a,I){f&&f.m(a,I),Le(a,c,I);for(let T=0;T<v.length;T+=1)v[T]&&v[T].m(a,I);Le(a,d,I)},p(a,[I]){if(a[5][1]?f?f.p(a,I):(f=mm(a),f.c(),f.m(c.parentNode,c)):f&&(f.d(1),f=null),I&63){_=a[3];let T;for(T=0;T<_.length;T+=1){const M=pm(a,_,T);v[T]?v[T].p(M,I):(v[T]=gm(M),v[T].c(),v[T].m(d.parentNode,d))}for(;T<v.length;T+=1)v[T].d(1);v.length=_.length}},i:vi,o:vi,d(a){f&&f.d(a),a&&oe(c),on(v,a),a&&oe(d)}}}function vm(h){let c;return h<1?c="<1%":c=h.toFixed(0)+"%",c}function V0(h,c,d){let f,_,v,a,{data:I}=c,{xKey:T="perc"}=c,{yKey:M="category"}=c,{zKey:F="ni"}=c,{formatTick:R=we=>Math.round(we)}=c,{suffix:D="%"}=c,{barHeight:H=20}=c,{margin:ae=30}=c;function de(we,xe){let Ve={};for(const De of we)Ve[De[xe]]||(Ve[De[xe]]={label:De[xe],values:[]}),Ve[De[xe]].values.push(De);let Oe=[];for(const De in Ve)Oe.push(Ve[De]);return Oe}function fe(we,xe){we[xe].width=this.clientWidth,d(3,a),d(6,I),d(7,M)}return h.$$set=we=>{"data"in we&&d(6,I=we.data),"xKey"in we&&d(0,T=we.xKey),"yKey"in we&&d(7,M=we.yKey),"zKey"in we&&d(8,F=we.zKey),"formatTick"in we&&d(9,R=we.formatTick),"suffix"in we&&d(10,D=we.suffix),"barHeight"in we&&d(1,H=we.barHeight),"margin"in we&&d(2,ae=we.margin)},h.$$.update=()=>{h.$$.dirty&65&&d(11,f=[0,Math.max(...I.map(we=>we[T]))]),h.$$.dirty&192&&I.map(we=>we[M]).filter((we,xe,Ve)=>Ve.indexOf(we)===xe),h.$$.dirty&320&&d(5,_=I.map(we=>we[F]).filter((we,xe,Ve)=>Ve.indexOf(we)===xe)),h.$$.dirty&2048&&d(4,v=we=>we/f[1]*100),h.$$.dirty&192&&d(3,a=de(I,M))},[T,H,ae,a,v,_,I,M,F,R,D,f,fe]}class Oh extends mn{constructor(c){super(),yn(this,c,V0,U0,_n,{data:6,xKey:0,yKey:7,zKey:8,formatTick:9,suffix:10,barHeight:1,margin:2})}}function bm(h,c,d){const f=h.slice();return f[14]=c[d],f}function xm(h,c,d){const f=h.slice();return f[17]=c[d],f[19]=d,f}function wm(h,c,d){const f=h.slice();return f[17]=c[d],f[19]=d,f}function km(h,c,d){const f=h.slice();return f[14]=c[d],f[19]=d,f}function Sm(h){let c,d=h[7],f=[];for(let _=0;_<d.length;_+=1)f[_]=Em(km(h,d,_));return{c(){c=Ne("ul");for(let _=0;_<f.length;_+=1)f[_].c();this.h()},l(_){c=Ue(_,"UL",{class:!0});var v=Be(c);for(let a=0;a<f.length;a+=1)f[a].l(v);v.forEach(oe),this.h()},h(){ne(c,"class","legend svelte-1hk4284")},m(_,v){Le(_,c,v);for(let a=0;a<f.length;a+=1)f[a]&&f[a].m(c,null)},p(_,v){if(v&144){d=_[7];let a;for(a=0;a<d.length;a+=1){const I=km(_,d,a);f[a]?f[a].p(I,v):(f[a]=Em(I),f[a].c(),f[a].m(c,null))}for(;a<f.length;a+=1)f[a].d(1);f.length=d.length}},d(_){_&&oe(c),on(f,_)}}}function Em(h){let c,d,f,_,v=h[14]+"",a,I;return{c(){c=Ne("li"),d=Ne("div"),f=ft(),_=Ne("span"),a=St(v),I=ft(),this.h()},l(T){c=Ue(T,"LI",{class:!0});var M=Be(c);d=Ue(M,"DIV",{class:!0}),Be(d).forEach(oe),f=dt(M),_=Ue(M,"SPAN",{class:!0});var F=Be(_);a=Et(F,v),F.forEach(oe),I=dt(M),M.forEach(oe),this.h()},h(){ne(d,"class","legend-vis "+(h[19]==0?"bar":"marker")+" svelte-1hk4284"),Ke(d,"height","1rem"),Ke(d,"width",h[19]==0?"1rem":h[4]+"px"),ne(_,"class",Ph(h[19]==0?"bold":"brackets")+" svelte-1hk4284"),ne(c,"class","svelte-1hk4284")},m(T,M){Le(T,c,M),Ee(c,d),Ee(c,f),Ee(c,_),Ee(_,a),Ee(c,I)},p(T,M){M&16&&Ke(d,"width",T[19]==0?"1rem":T[4]+"px"),M&128&&v!==(v=T[14]+"")&&Er(a,v)},d(T){T&&oe(c)}}}function Tm(h){let c,d=h[1](h[17].perc/100)+"",f,_;return{c(){c=Ne("span"),f=St(d),_=St(h[2]),this.h()},l(v){c=Ue(v,"SPAN",{class:!0,style:!0});var a=Be(c);f=Et(a,d),_=Et(a,h[2]),a.forEach(oe),this.h()},h(){ne(c,"class",Ph(h[19]==0?"bold":"sml brackets")+" svelte-1hk4284"),Ke(c,"color",h[19]==0?"#000000":"#1460aa")},m(v,a){Le(v,c,a),Ee(c,f),Ee(c,_)},p(v,a){a&34&&d!==(d=v[1](v[17].perc/100)+"")&&Er(f,d),a&4&&Er(_,v[2])},d(v){v&&oe(c)}}}function j0(h){let c,d=`calc(${h[6](h[17][h[0]])}% - ${h[4]/2}px)`,f=`${h[4]}px`;return{c(){c=Ne("div"),this.h()},l(_){c=Ue(_,"DIV",{class:!0}),Be(c).forEach(oe),this.h()},h(){ne(c,"class","marker svelte-1hk4284"),Ke(c,"left",d),Ke(c,"border-left-width",f)},m(_,v){Le(_,c,v)},p(_,v){v&113&&d!==(d=`calc(${_[6](_[17][_[0]])}% - ${_[4]/2}px)`)&&Ke(c,"left",d),v&16&&f!==(f=`${_[4]}px`)&&Ke(c,"border-left-width",f)},d(_){_&&oe(c)}}}function q0(h){let c,d=`${h[6](h[17][h[0]])}%`;return{c(){c=Ne("div"),this.h()},l(f){c=Ue(f,"DIV",{class:!0}),Be(c).forEach(oe),this.h()},h(){ne(c,"class","bar svelte-1hk4284"),Ke(c,"left","0"),Ke(c,"width",d)},m(f,_){Le(f,c,_)},p(f,_){_&97&&d!==(d=`${f[6](f[17][f[0]])}%`)&&Ke(c,"width",d)},d(f){f&&oe(c)}}}function Im(h){let c;function d(v,a){return v[19]==0?q0:j0}let _=d(h)(h);return{c(){_.c(),c=br()},l(v){_.l(v),c=br()},m(v,a){_.m(v,a),Le(v,c,a)},p(v,a){_.p(v,a)},d(v){_.d(v),v&&oe(c)}}}function zm(h){let c,d=h[14].label+"",f,_,v,a,I,T=`${h[3]}px`,M=h[14].values,F=[];for(let H=0;H<M.length;H+=1)F[H]=Tm(wm(h,M,H));let R=h[14].values,D=[];for(let H=0;H<R.length;H+=1)D[H]=Im(xm(h,R,H));return{c(){c=Ne("div"),f=St(d),_=ft();for(let H=0;H<F.length;H+=1)F[H].c();v=ft(),a=Ne("div");for(let H=0;H<D.length;H+=1)D[H].c();I=ft(),this.h()},l(H){c=Ue(H,"DIV",{class:!0});var ae=Be(c);f=Et(ae,d),_=dt(ae);for(let fe=0;fe<F.length;fe+=1)F[fe].l(ae);ae.forEach(oe),v=dt(H),a=Ue(H,"DIV",{class:!0});var de=Be(a);for(let fe=0;fe<D.length;fe+=1)D[fe].l(de);I=dt(de),de.forEach(oe),this.h()},h(){ne(c,"class","label-group svelte-1hk4284"),ne(a,"class","bar-group svelte-1hk4284"),Ke(a,"height",T)},m(H,ae){Le(H,c,ae),Ee(c,f),Ee(c,_);for(let de=0;de<F.length;de+=1)F[de]&&F[de].m(c,null);Le(H,v,ae),Le(H,a,ae);for(let de=0;de<D.length;de+=1)D[de]&&D[de].m(a,null);Ee(a,I)},p(H,ae){if(ae&32&&d!==(d=H[14].label+"")&&Er(f,d),ae&38){M=H[14].values;let de;for(de=0;de<M.length;de+=1){const fe=wm(H,M,de);F[de]?F[de].p(fe,ae):(F[de]=Tm(fe),F[de].c(),F[de].m(c,null))}for(;de<F.length;de+=1)F[de].d(1);F.length=M.length}if(ae&113){R=H[14].values;let de;for(de=0;de<R.length;de+=1){const fe=xm(H,R,de);D[de]?D[de].p(fe,ae):(D[de]=Im(fe),D[de].c(),D[de].m(a,I))}for(;de<D.length;de+=1)D[de].d(1);D.length=R.length}ae&8&&T!==(T=`${H[3]}px`)&&Ke(a,"height",T)},d(H){H&&oe(c),on(F,H),H&&oe(v),H&&oe(a),on(D,H)}}}function Z0(h){let c,d,f=h[7][1]&&Sm(h),_=h[5],v=[];for(let a=0;a<_.length;a+=1)v[a]=zm(bm(h,_,a));return{c(){f&&f.c(),c=ft();for(let a=0;a<v.length;a+=1)v[a].c();d=br()},l(a){f&&f.l(a),c=dt(a);for(let I=0;I<v.length;I+=1)v[I].l(a);d=br()},m(a,I){f&&f.m(a,I),Le(a,c,I);for(let T=0;T<v.length;T+=1)v[T]&&v[T].m(a,I);Le(a,d,I)},p(a,[I]){if(a[7][1]?f?f.p(a,I):(f=Sm(a),f.c(),f.m(c.parentNode,c)):f&&(f.d(1),f=null),I&127){_=a[5];let T;for(T=0;T<_.length;T+=1){const M=bm(a,_,T);v[T]?v[T].p(M,I):(v[T]=zm(M),v[T].c(),v[T].m(d.parentNode,d))}for(;T<v.length;T+=1)v[T].d(1);v.length=_.length}},i:vi,o:vi,d(a){f&&f.d(a),a&&oe(c),on(v,a),a&&oe(d)}}}function G0(h,c,d){let f,_,v,a,{data:I}=c,{xKey:T="perc"}=c,{yKey:M="category"}=c,{zKey:F="group"}=c,{formatTick:R=fe=>Math.round(100*fe)}=c,{suffix:D="%"}=c,{barHeight:H=25}=c,{markerWidth:ae=3}=c;function de(fe,we){let xe={};for(const Oe of fe)xe[Oe[we]]||(xe[Oe[we]]={label:Oe[we],values:[]}),xe[Oe[we]].values.push(Oe);let Ve=[];for(const Oe in xe)Ve.push(xe[Oe]);return Ve}return h.$$set=fe=>{"data"in fe&&d(8,I=fe.data),"xKey"in fe&&d(0,T=fe.xKey),"yKey"in fe&&d(9,M=fe.yKey),"zKey"in fe&&d(10,F=fe.zKey),"formatTick"in fe&&d(1,R=fe.formatTick),"suffix"in fe&&d(2,D=fe.suffix),"barHeight"in fe&&d(3,H=fe.barHeight),"markerWidth"in fe&&d(4,ae=fe.markerWidth)},h.$$.update=()=>{h.$$.dirty&257&&d(11,f=[0,Math.max(...I.map(fe=>fe[T]))]),h.$$.dirty&768&&I.map(fe=>fe[M]).filter((fe,we,xe)=>xe.indexOf(fe)===we),h.$$.dirty&1280&&d(7,_=I.map(fe=>fe[F]).filter((fe,we,xe)=>xe.indexOf(fe)===we)),h.$$.dirty&2048&&d(6,v=fe=>fe/f[1]*100),h.$$.dirty&768&&d(5,a=de(I,M))},[T,R,D,H,ae,a,v,_,I,M,F,f]}class Fh extends mn{constructor(c){super(),yn(this,c,G0,Z0,_n,{data:8,xKey:0,yKey:9,zKey:10,formatTick:1,suffix:2,barHeight:3,markerWidth:4})}}function Am(h,c,d){const f=h.slice();return f[12]=c[d],f[14]=d,f}function Pm(h,c,d){const f=h.slice();return f[15]=c[d],f[17]=d,f}function Cm(h,c,d){const f=h.slice();return f[15]=c[d],f[17]=d,f}function Mm(h,c,d){const f=h.slice();return f[19]=c[d],f[14]=d,f}function Dm(h){let c,d=h[5],f=[];for(let _=0;_<d.length;_+=1)f[_]=Lm(Mm(h,d,_));return{c(){c=Ne("ul");for(let _=0;_<f.length;_+=1)f[_].c();this.h()},l(_){c=Ue(_,"UL",{class:!0});var v=Be(c);for(let a=0;a<f.length;a+=1)f[a].l(v);v.forEach(oe),this.h()},h(){ne(c,"class","legend svelte-pmaxst")},m(_,v){Le(_,c,v);for(let a=0;a<f.length;a+=1)f[a]&&f[a].m(c,null)},p(_,v){if(v&36){d=_[5];let a;for(a=0;a<d.length;a+=1){const I=Mm(_,d,a);f[a]?f[a].p(I,v):(f[a]=Lm(I),f[a].c(),f[a].m(c,null))}for(;a<f.length;a+=1)f[a].d(1);f.length=d.length}},d(_){_&&oe(c),on(f,_)}}}function Lm(h){let c,d,f,_,v=h[19]+"",a,I;return{c(){c=Ne("li"),d=Ne("div"),f=ft(),_=Ne("span"),a=St(v),I=ft(),this.h()},l(T){c=Ue(T,"LI",{class:!0});var M=Be(c);d=Ue(M,"DIV",{class:!0}),Be(d).forEach(oe),f=dt(M),_=Ue(M,"SPAN",{class:!0});var F=Be(_);a=Et(F,v),F.forEach(oe),I=dt(M),M.forEach(oe),this.h()},h(){ne(d,"class","legend-vis "+(h[14]==0?"bar":"markerSmall")+" svelte-pmaxst"),Ke(d,"height","1rem"),Ke(d,"width",h[14]==0?"1rem":h[2]+"px"),ne(_,"class",Ph(h[14]==0?"bold":"brackets")+" svelte-pmaxst"),ne(c,"class","svelte-pmaxst")},m(T,M){Le(T,c,M),Ee(c,d),Ee(c,f),Ee(c,_),Ee(_,a),Ee(c,I)},p(T,M){M&4&&Ke(d,"width",T[14]==0?"1rem":T[2]+"px"),M&32&&v!==(v=T[19]+"")&&Er(a,v)},d(T){T&&oe(c)}}}function K0(h){let c,d=h[12].values,f=[];for(let _=0;_<d.length;_+=1)f[_]=Rm(Pm(h,d,_));return{c(){for(let _=0;_<f.length;_+=1)f[_].c();c=br()},l(_){for(let v=0;v<f.length;v+=1)f[v].l(_);c=br()},m(_,v){for(let a=0;a<f.length;a+=1)f[a]&&f[a].m(_,v);Le(_,c,v)},p(_,v){if(v&89){d=_[12].values;let a;for(a=0;a<d.length;a+=1){const I=Pm(_,d,a);f[a]?f[a].p(I,v):(f[a]=Rm(I),f[a].c(),f[a].m(c.parentNode,c))}for(;a<f.length;a+=1)f[a].d(1);f.length=d.length}},d(_){on(f,_),_&&oe(c)}}}function X0(h){let c,d=h[12].values,f=[];for(let _=0;_<d.length;_+=1)f[_]=Bm(Cm(h,d,_));return{c(){for(let _=0;_<f.length;_+=1)f[_].c();c=br()},l(_){for(let v=0;v<f.length;v+=1)f[v].l(_);c=br()},m(_,v){for(let a=0;a<f.length;a+=1)f[a]&&f[a].m(_,v);Le(_,c,v)},p(_,v){if(v&89){d=_[12].values;let a;for(a=0;a<d.length;a+=1){const I=Cm(_,d,a);f[a]?f[a].p(I,v):(f[a]=Bm(I),f[a].c(),f[a].m(c.parentNode,c))}for(;a<f.length;a+=1)f[a].d(1);f.length=d.length}},d(_){on(f,_),_&&oe(c)}}}function Rm(h){let c,d,f=`calc(100% - ${h[15].offset<0?h[4](h[15][h[0]]-h[15].offset):h[4](h[15][h[0]])}%)`,_=`${h[4](h[15].offset)}%`,v=`${h[17]/h[6].length*100}%`,a=`${1/h[6].length*100}%`;return{c(){c=Ne("div"),this.h()},l(I){c=Ue(I,"DIV",{class:!0,style:!0}),Be(c).forEach(oe),this.h()},h(){ne(c,"class","marker svelte-pmaxst"),ne(c,"style",d="border-"+(h[15].offset<0?"top":"bottom")+": none"),Ke(c,"top",f),Ke(c,"height",_),Ke(c,"left",v),Ke(c,"width",a)},m(I,T){Le(I,c,T)},p(I,T){T&8&&d!==(d="border-"+(I[15].offset<0?"top":"bottom")+": none")&&ne(c,"style",d);const M=T&8;(M||T&25&&f!==(f=`calc(100% - ${I[15].offset<0?I[4](I[15][I[0]]-I[15].offset):I[4](I[15][I[0]])}%)`))&&Ke(c,"top",f),(M||T&24&&_!==(_=`${I[4](I[15].offset)}%`))&&Ke(c,"height",_),(M||T&72&&v!==(v=`${I[17]/I[6].length*100}%`))&&Ke(c,"left",v),(M||T&72&&a!==(a=`${1/I[6].length*100}%`))&&Ke(c,"width",a)},d(I){I&&oe(c)}}}function Bm(h){let c,d=`${100-h[4](h[15][h[0]])}%`,f=`${h[4](h[15][h[0]])}%`,_=`${h[17]/h[6].length*100}%`,v=`calc(${1/h[6].length*100}% - 2px)`;return{c(){c=Ne("div"),this.h()},l(a){c=Ue(a,"DIV",{class:!0}),Be(c).forEach(oe),this.h()},h(){ne(c,"class","bar svelte-pmaxst"),Ke(c,"top",d),Ke(c,"height",f),Ke(c,"left",_),Ke(c,"width",v)},m(a,I){Le(a,c,I)},p(a,I){I&25&&d!==(d=`${100-a[4](a[15][a[0]])}%`)&&Ke(c,"top",d),I&25&&f!==(f=`${a[4](a[15][a[0]])}%`)&&Ke(c,"height",f),I&64&&_!==(_=`${a[17]/a[6].length*100}%`)&&Ke(c,"left",_),I&64&&v!==(v=`calc(${1/a[6].length*100}% - 2px)`)&&Ke(c,"width",v)},d(a){a&&oe(c)}}}function Om(h){let c;function d(v,a){return v[14]==0?X0:K0}let _=d(h)(h);return{c(){_.c(),c=br()},l(v){_.l(v),c=br()},m(v,a){_.m(v,a),Le(v,c,a)},p(v,a){_.p(v,a)},d(v){_.d(v),v&&oe(c)}}}function W0(h){let c,d,f=`${h[1]}px`,_,v,a,I,T,M,F,R,D,H,ae,de,fe,we,xe=h[5][1]&&Dm(h),Ve=h[3],Oe=[];for(let De=0;De<Ve.length;De+=1)Oe[De]=Om(Am(h,Ve,De));return{c(){xe&&xe.c(),c=ft(),d=Ne("div");for(let De=0;De<Oe.length;De+=1)Oe[De].c();_=ft(),v=Ne("div"),a=Ne("div"),I=Ne("div"),T=St("0-14"),M=ft(),F=Ne("div"),R=St("15-39"),D=ft(),H=Ne("div"),ae=St("40-64"),de=ft(),fe=Ne("div"),we=St("65+"),this.h()},l(De){xe&&xe.l(De),c=dt(De),d=Ue(De,"DIV",{class:!0});var He=Be(d);for(let yt=0;yt<Oe.length;yt+=1)Oe[yt].l(He);He.forEach(oe),_=dt(De),v=Ue(De,"DIV",{class:!0});var Tt=Be(v);a=Ue(Tt,"DIV",{class:!0});var Lt=Be(a);I=Ue(Lt,"DIV",{class:!0});var qt=Be(I);T=Et(qt,"0-14"),qt.forEach(oe),M=dt(Lt),F=Ue(Lt,"DIV",{class:!0});var _t=Be(F);R=Et(_t,"15-39"),_t.forEach(oe),D=dt(Lt),H=Ue(Lt,"DIV",{class:!0});var ht=Be(H);ae=Et(ht,"40-64"),ht.forEach(oe),de=dt(Lt),fe=Ue(Lt,"DIV",{class:!0});var Ft=Be(fe);we=Et(Ft,"65+"),Ft.forEach(oe),Lt.forEach(oe),Tt.forEach(oe),this.h()},h(){ne(d,"class","bar-group svelte-pmaxst"),Ke(d,"height",f),ne(I,"class","column svelte-pmaxst"),ne(F,"class","column svelte-pmaxst"),ne(H,"class","column svelte-pmaxst"),ne(fe,"class","column svelte-pmaxst"),ne(a,"class","row svelte-pmaxst"),Ke(a,"width","100%"),ne(v,"class","x-scale svelte-pmaxst")},m(De,He){xe&&xe.m(De,He),Le(De,c,He),Le(De,d,He);for(let Tt=0;Tt<Oe.length;Tt+=1)Oe[Tt]&&Oe[Tt].m(d,null);Le(De,_,He),Le(De,v,He),Ee(v,a),Ee(a,I),Ee(I,T),Ee(a,M),Ee(a,F),Ee(F,R),Ee(a,D),Ee(a,H),Ee(H,ae),Ee(a,de),Ee(a,fe),Ee(fe,we)},p(De,[He]){if(De[5][1]?xe?xe.p(De,He):(xe=Dm(De),xe.c(),xe.m(c.parentNode,c)):xe&&(xe.d(1),xe=null),He&89){Ve=De[3];let Tt;for(Tt=0;Tt<Ve.length;Tt+=1){const Lt=Am(De,Ve,Tt);Oe[Tt]?Oe[Tt].p(Lt,He):(Oe[Tt]=Om(Lt),Oe[Tt].c(),Oe[Tt].m(d,null))}for(;Tt<Oe.length;Tt+=1)Oe[Tt].d(1);Oe.length=Ve.length}He&2&&f!==(f=`${De[1]}px`)&&Ke(d,"height",f)},i:vi,o:vi,d(De){xe&&xe.d(De),De&&oe(c),De&&oe(d),on(Oe,De),De&&oe(_),De&&oe(v)}}}function H0(h,c,d){let f,_,v,a,I,{data:T}=c,{xKey:M="category"}=c,{yKey:F="perc"}=c,{zKey:R="group"}=c,{height:D=100}=c,{markerWidth:H=3}=c;function ae(de,fe){let we={};for(const Ve of de){we[Ve[fe]]||(we[Ve[fe]]={label:Ve[fe],values:[]});let Oe=we[Ve[fe]].values.length,De=Oe==0?0:Ve[F]-we[Ve[fe]].values[Oe-1][F];we[Ve[fe]].values.push({...Ve,offset:De})}let xe=[];for(const Ve in we)xe.push(we[Ve]);return console.log(xe),xe}return h.$$set=de=>{"data"in de&&d(7,T=de.data),"xKey"in de&&d(8,M=de.xKey),"yKey"in de&&d(0,F=de.yKey),"zKey"in de&&d(9,R=de.zKey),"height"in de&&d(1,D=de.height),"markerWidth"in de&&d(2,H=de.markerWidth)},h.$$.update=()=>{h.$$.dirty&384&&d(6,f=T.map(de=>de[M]).filter((de,fe,we)=>we.indexOf(de)===fe)),h.$$.dirty&129&&d(10,_=[0,Math.max(...T.map(de=>de[F]))]),h.$$.dirty&640&&d(5,v=T.map(de=>de[R]).filter((de,fe,we)=>we.indexOf(de)===fe)),h.$$.dirty&1024&&d(4,a=de=>Math.abs(de/_[1])*100),h.$$.dirty&640&&d(3,I=ae(T,R))},[F,D,H,I,a,v,f,T,M,R,_]}class Nh extends mn{constructor(c){super(),yn(this,c,H0,W0,_n,{data:7,xKey:8,yKey:0,zKey:9,height:1,markerWidth:2})}}function J0(h){let c,d,f,_;return{c(){c=Ne("div"),d=St("Back to top"),this.h()},l(v){c=Ue(v,"DIV",{class:!0});var a=Be(c);d=Et(a,"Back to top"),a.forEach(oe),this.h()},h(){ne(c,"class","back_to_start svelte-11zibd5"),Xn(c,"hidden",h[0])},m(v,a){Le(v,c,a),Ee(c,d),f||(_=[ha(window,"scroll",h[2]),ha(c,"click",h[1])],f=!0)},p(v,[a]){a&1&&Xn(c,"hidden",v[0])},i:vi,o:vi,d(v){v&&oe(c),f=!1,Ku(_)}}}function Y0(h,c,d){let{buttonVisibleOnPX:f=200}=c,_=!0;const v=()=>{document.body.scrollIntoView()},a=()=>document.documentElement||document.body,I=()=>{a().scrollTop>f?d(0,_=!1):d(0,_=!0)};return h.$$set=T=>{"buttonVisibleOnPX"in T&&d(3,f=T.buttonVisibleOnPX)},[_,v,I,f]}class Q0 extends mn{constructor(c){super(),yn(this,c,Y0,J0,_n,{buttonVisibleOnPX:3})}}function $0(h){let c,d,f=h[1][h[0]].title+"",_,v,a,I,T,M,F,R=h[1][h[0]].info+"",D;return{c(){c=Ne("div"),d=Ne("div"),_=St(f),v=Ne("span"),T=ft(),M=Ne("div"),F=Ne("div"),this.h()},l(H){c=Ue(H,"DIV",{class:!0,style:!0,"data-bs-toggle":!0,"data-bs-target":!0,"aria-expanded":!0,"aria-controls":!0});var ae=Be(c);d=Ue(ae,"DIV",{class:!0,style:!0});var de=Be(d);_=Et(de,f),v=Ue(de,"SPAN",{class:!0}),Be(v).forEach(oe),de.forEach(oe),ae.forEach(oe),T=dt(H),M=Ue(H,"DIV",{class:!0,id:!0});var fe=Be(M);F=Ue(fe,"DIV",{class:!0});var we=Be(F);we.forEach(oe),fe.forEach(oe),this.h()},h(){ne(v,"class","i-button"),ne(d,"class","blocktitle"),Ke(d,"margin","0"),Ke(d,"width","100%"),ne(c,"class","row"),Ke(c,"display","flex"),Ke(c,"cursor","pointer"),ne(c,"data-bs-toggle","collapse"),ne(c,"data-bs-target",a="#"+h[0]+"-info"),ne(c,"aria-expanded","false"),ne(c,"aria-controls",I=h[0]+"-info"),ne(F,"class","card card-body svelte-1qrf6oz"),ne(M,"class","collapse svelte-1qrf6oz"),ne(M,"id",D=h[0]+"-info")},m(H,ae){Le(H,c,ae),Ee(c,d),Ee(d,_),Ee(d,v),Le(H,T,ae),Le(H,M,ae),Ee(M,F),F.innerHTML=R},p(H,[ae]){ae&1&&f!==(f=H[1][H[0]].title+"")&&Er(_,f),ae&1&&a!==(a="#"+H[0]+"-info")&&ne(c,"data-bs-target",a),ae&1&&I!==(I=H[0]+"-info")&&ne(c,"aria-controls",I),ae&1&&R!==(R=H[1][H[0]].info+"")&&(F.innerHTML=R),ae&1&&D!==(D=H[0]+"-info")&&ne(M,"id",D)},i:vi,o:vi,d(H){H&&oe(c),H&&oe(T),H&&oe(M)}}}function e1(h,c,d){let{id:f}=c,{place:_}=c,v={location:{title:"About the area",info:"Information about the area including its geographical hierarchy."},area:{title:"Area",info:"Area is measured in hectares (ha), it is rounded to the nearest whole number."},popden:{title:"Population density",info:"Population density is the number of usual residents per hectare. It is rounded to 1 d.p."},pop:{title:"Population",info:"Population is based on the number of usual residents. A usual resident is anyone who, on 21 March 2021 is in the UK, and staying in the UK for a period of 3 months or more; or has a permanent UK address and is outside the UK and is staying outside the UK for less than 12 months. <a href='https://www.nisra.gov.uk/publications/census-2021-statistical-bulletins'><strong>Statistical bulletins</strong></a>"},generalhealth:{title:"General Health",info:"General health is a self-assessment of a persons general state of health. It is not based over any specified period of time. <a href='https://www.nisra.gov.uk/publications/census-2021-statistical-bulletins'><strong>Statistical bulletins</strong></a>"},wellbeing:{title:"Happiness",info:"Average Happiness score out of 10 for people aged 16+</p><p>source:</p><p>Last Updated:</p><p>Further Information:</p>"},lifeexpectancy:{title:"Life Expectancy at birth",info:"words to be added"},carers:{title:"Unpaid care",info:"'Unpaid care' covers looking after, giving help or support to anyone because they have long-term physical or mental health conditions or illnesses, or problems related to old age. It does not include any activities as part of paid employment. All unpaid care statistics are restricted to persons aged 5 and over. <a href='https://www.nisra.gov.uk/publications/census-2021-statistical-bulletins'><strong>Statistical bulletins</strong></a>"},hospitalactivity:{title:"Activity in hospitals / waiting lists",info:"words to be added"},primarycare:{title:"Primary care providers",info:"words to be added"},employmentrates:{title:"Employment rates",info:"words to be added"},employed:{title:"Number of people employed",info:"words to be added"},wages:{title:"Average wages",info:"words to be added"},benefits:{title:"Number of people on work-related benefits",info:"words to be added"},enrollments:{title:"Number of enrolled in schools and colleges",info:"words to be added"},fsme:{title:"Entitlement to Free School Meals",info:"words to be added"},teachers:{title:"Teachers",info:"words to be added"},qualifications:{title:"Highest level of Qualifications",info:"words to be added"},attainment:{title:"Attainment of Qualifications",info:"words to be added"},popchange:{title:"Population change",info:"words to be added"},age:{title:"Broad age bands",info:"A grouping of ages where a persons age is their age at their last birthday on or prior to census day. <a href='https://www.nisra.gov.uk/publications/census-2021-statistical-bulletins'><strong>Statistical bulletins</strong></a>"},sex:{title:"Sex",info:"words to be added"},hhsize:{title:"Household size",info:"The number of usual residents in the household.      <a href='https://www.nisra.gov.uk/publications/census-2021-statistical-bulletins'><strong>Statistical bulletins</strong></a>"},religion:{title:"Religion, Religion brought up",info:"The religious group the person belongs to or for people with no current religion their religious group of upbringing.People with no current religion and no religion of upbringing are labelled 'None'.<a href='https://www.nisra.gov.uk/publications/census-2021-statistical-bulletins'><strong>Statistical bulletins</strong></a>"},language:{title:"Main language",info:"Person's main language as declared in the Census.Statistics for all language questions are restrictedto persons aged 3 and over. <ahref='https://www.nisra.gov.uk/publications/census-2021-statistical-bulletins'><strong>Statistical bulletins</strong></a>"},households:{title:"Households - box with numbers",info:"A household is either one person living alone or a group of people living at the same address who share cooking facilities and share a living room, sitting room or dining area. <a href='https://www.nisra.gov.uk/publications/census-2021-statistical-bulletins'><strong>Statistical bulletins</strong></a>"},dentalreg:{title:"Number of dental registrations",info:"<a href='mailto:"+_.meta_data.FPSGDSDR.email+"'>Email for more information</a> Last updated: "+_.meta_data.FPSGDSDR.last_updated+" Access data at: <a href='"+_.meta_data.FPSGDSDR.dataset_url+"'>"+_.meta_data.FPSGDSDR.title+"</a>"}};return h.$$set=a=>{"id"in a&&d(0,f=a.id),"place"in a&&d(2,_=a.place)},[f,v,_]}class t1 extends mn{constructor(c){super(),yn(this,c,e1,$0,_n,{id:0,place:2})}}function r1(h){let c,d;return{c(){c=Ne("h3"),d=St(h[9]),this.h()},l(f){c=Ue(f,"H3",{style:!0});var _=Be(c);d=Et(_,h[9]),_.forEach(oe),this.h()},h(){Ke(c,"margin","0 0 10px 0"),Ke(c,"line-height","1.78")},m(f,_){Le(f,c,_),Ee(c,d)},p(f,_){_&512&&Er(d,f[9])},i:vi,o:vi,d(f){f&&oe(c)}}}function i1(h){let c,d;return c=new t1({props:{id:h[1],place:h[3]}}),{c(){ir(c.$$.fragment)},l(f){nr(c.$$.fragment,f)},m(f,_){ar(c,f,_),d=!0},p(f,_){const v={};_&2&&(v.id=f[1]),_&8&&(v.place=f[3]),c.$set(v)},i(f){d||(it(c.$$.fragment,f),d=!0)},o(f){lt(c.$$.fragment,f),d=!1},d(f){or(c,f)}}}function n1(h){let c,d;return{c(){c=new Xu(!1),d=br(),this.h()},l(f){c=Wu(f,!1),d=br(),this.h()},h(){c.a=d},m(f,_){c.m(h[4],f,_),Le(f,d,_)},p(f,_){_&16&&c.p(f[4])},i:vi,o:vi,d(f){f&&oe(d),f&&c.d()}}}function a1(h){let c,d=h[4][h[3].type]+"",f;return{c(){c=new Xu(!1),f=br(),this.h()},l(_){c=Wu(_,!1),f=br(),this.h()},h(){c.a=f},m(_,v){c.m(d,_,v),Le(_,f,v)},p(_,v){v&24&&d!==(d=_[4][_[3].type]+"")&&c.p(d)},i:vi,o:vi,d(_){_&&oe(f),_&&c.d()}}}function o1(h){let c,d,f,_,v,a,I;const T=[d1,f1,p1,h1],M=[];function F(R,D){return D&1056&&(c=null),D&1056&&(d=null),D&1056&&(f=null),c==null&&(c=!!(R[5].hasOwnProperty("none")&R[10]==null)),c?0:(d==null&&(d=!!(R[5].hasOwnProperty("prev")&R[10]=="prev")),d?1:(f==null&&(f=!!(R[5].hasOwnProperty("ni")&R[10]=="ni")),f?2:3))}return _=F(h,-1),v=M[_]=T[_](h),{c(){v.c(),a=br()},l(R){v.l(R),a=br()},m(R,D){M[_].m(R,D),Le(R,a,D),I=!0},p(R,D){let H=_;_=F(R,D),_===H?M[_].p(R,D):(ta(),lt(M[H],1,1,()=>{M[H]=null}),ra(),v=M[_],v?v.p(R,D):(v=M[_]=T[_](R),v.c()),it(v,1),v.m(a.parentNode,a))},i(R){I||(it(v),I=!0)},o(R){lt(v),I=!1},d(R){M[_].d(R),R&&oe(a)}}}function s1(h){let c,d,f,_,v,a,I;const T=[g1,_1,y1,m1],M=[];function F(R,D){return D&1056&&(c=null),D&1056&&(d=null),D&1056&&(f=null),c==null&&(c=!!(R[5].hasOwnProperty("none")&R[10]==null)),c?0:(d==null&&(d=!!(R[5].hasOwnProperty("prev")&R[10]=="prev")),d?1:(f==null&&(f=!!(R[5].hasOwnProperty("ni")&R[10]=="ni")),f?2:3))}return _=F(h,-1),v=M[_]=T[_](h),{c(){v.c(),a=br()},l(R){v.l(R),a=br()},m(R,D){M[_].m(R,D),Le(R,a,D),I=!0},p(R,D){let H=_;_=F(R,D),_===H?M[_].p(R,D):(ta(),lt(M[H],1,1,()=>{M[H]=null}),ra(),v=M[_],v?v.p(R,D):(v=M[_]=T[_](R),v.c()),it(v,1),v.m(a.parentNode,a))},i(R){I||(it(v),I=!0)},o(R){lt(v),I=!1},d(R){M[_].d(R),R&&oe(a)}}}function l1(h){let c,d,f,_,v,a,I;const T=[w1,x1,b1,v1],M=[];function F(R,D){return D&1056&&(c=null),D&1056&&(d=null),D&1056&&(f=null),c==null&&(c=!!(R[5].hasOwnProperty("none")&R[10]==null)),c?0:(d==null&&(d=!!(R[5].hasOwnProperty("prev")&R[10]=="prev")),d?1:(f==null&&(f=!!(R[5].hasOwnProperty("ni")&R[10]=="ni")),f?2:3))}return _=F(h,-1),v=M[_]=T[_](h),{c(){v.c(),a=br()},l(R){v.l(R),a=br()},m(R,D){M[_].m(R,D),Le(R,a,D),I=!0},p(R,D){let H=_;_=F(R,D),_===H?M[_].p(R,D):(ta(),lt(M[H],1,1,()=>{M[H]=null}),ra(),v=M[_],v?v.p(R,D):(v=M[_]=T[_](R),v.c()),it(v,1),v.m(a.parentNode,a))},i(R){I||(it(v),I=!0)},o(R){lt(v),I=!1},d(R){M[_].d(R),R&&oe(a)}}}function u1(h){let c,d,f,_,v,a,I;const T=[T1,E1,S1,k1],M=[];function F(R,D){return D&1056&&(c=null),D&1056&&(d=null),D&1056&&(f=null),c==null&&(c=!!(R[5].hasOwnProperty("none")&R[10]==null)),c?0:(d==null&&(d=!!(R[5].hasOwnProperty("prev")&R[10]=="prev")),d?1:(f==null&&(f=!!(R[5].hasOwnProperty("ni")&R[10]=="ni")),f?2:3))}return _=F(h,-1),v=M[_]=T[_](h),{c(){v.c(),a=br()},l(R){v.l(R),a=br()},m(R,D){M[_].m(R,D),Le(R,a,D),I=!0},p(R,D){let H=_;_=F(R,D),_===H?M[_].p(R,D):(ta(),lt(M[H],1,1,()=>{M[H]=null}),ra(),v=M[_],v?v.p(R,D):(v=M[_]=T[_](R),v.c()),it(v,1),v.m(a.parentNode,a))},i(R){I||(it(v),I=!0)},o(R){lt(v),I=!1},d(R){M[_].d(R),R&&oe(a)}}}function c1(h){let c,d,f,_,v,a,I;const T=[P1,A1,z1,I1],M=[];function F(R,D){return D&1056&&(c=null),D&1056&&(d=null),D&1056&&(f=null),c==null&&(c=!!(R[5].hasOwnProperty("none")&R[10]==null)),c?0:(d==null&&(d=!!(R[5].hasOwnProperty("prev")&R[10]=="prev")),d?1:(f==null&&(f=!!(R[5].hasOwnProperty("ni")&R[10]=="ni")),f?2:3))}return _=F(h,-1),v=M[_]=T[_](h),{c(){v.c(),a=br()},l(R){v.l(R),a=br()},m(R,D){M[_].m(R,D),Le(R,a,D),I=!0},p(R,D){let H=_;_=F(R,D),_===H?M[_].p(R,D):(ta(),lt(M[H],1,1,()=>{M[H]=null}),ra(),v=M[_],v?v.p(R,D):(v=M[_]=T[_](R),v.c()),it(v,1),v.m(a.parentNode,a))},i(R){I||(it(v),I=!0)},o(R){lt(v),I=!1},d(R){M[_].d(R),R&&oe(a)}}}function h1(h){let c,d;return c=new Rh({props:{data:h[5],zKey:h[6]}}),{c(){ir(c.$$.fragment)},l(f){nr(c.$$.fragment,f)},m(f,_){ar(c,f,_),d=!0},p(f,_){const v={};_&32&&(v.data=f[5]),_&64&&(v.zKey=f[6]),c.$set(v)},i(f){d||(it(c.$$.fragment,f),d=!0)},o(f){lt(c.$$.fragment,f),d=!1},d(f){or(c,f)}}}function p1(h){let c,d;return c=new Rh({props:{data:h[5].ni,zKey:h[6]}}),{c(){ir(c.$$.fragment)},l(f){nr(c.$$.fragment,f)},m(f,_){ar(c,f,_),d=!0},p(f,_){const v={};_&32&&(v.data=f[5].ni),_&64&&(v.zKey=f[6]),c.$set(v)},i(f){d||(it(c.$$.fragment,f),d=!0)},o(f){lt(c.$$.fragment,f),d=!1},d(f){or(c,f)}}}function f1(h){let c,d;return c=new Rh({props:{data:h[5].prev,zKey:h[6]}}),{c(){ir(c.$$.fragment)},l(f){nr(c.$$.fragment,f)},m(f,_){ar(c,f,_),d=!0},p(f,_){const v={};_&32&&(v.data=f[5].prev),_&64&&(v.zKey=f[6]),c.$set(v)},i(f){d||(it(c.$$.fragment,f),d=!0)},o(f){lt(c.$$.fragment,f),d=!1},d(f){or(c,f)}}}function d1(h){let c,d;return c=new Rh({props:{data:h[5].none,zKey:h[6]}}),{c(){ir(c.$$.fragment)},l(f){nr(c.$$.fragment,f)},m(f,_){ar(c,f,_),d=!0},p(f,_){const v={};_&32&&(v.data=f[5].none),_&64&&(v.zKey=f[6]),c.$set(v)},i(f){d||(it(c.$$.fragment,f),d=!0)},o(f){lt(c.$$.fragment,f),d=!1},d(f){or(c,f)}}}function m1(h){let c,d;return c=new Fh({props:{data:h[5],zKey:h[6],label:h[7]}}),{c(){ir(c.$$.fragment)},l(f){nr(c.$$.fragment,f)},m(f,_){ar(c,f,_),d=!0},p(f,_){const v={};_&32&&(v.data=f[5]),_&64&&(v.zKey=f[6]),_&128&&(v.label=f[7]),c.$set(v)},i(f){d||(it(c.$$.fragment,f),d=!0)},o(f){lt(c.$$.fragment,f),d=!1},d(f){or(c,f)}}}function y1(h){let c,d;return c=new Fh({props:{data:h[5].ni,zKey:h[6],label:h[7]}}),{c(){ir(c.$$.fragment)},l(f){nr(c.$$.fragment,f)},m(f,_){ar(c,f,_),d=!0},p(f,_){const v={};_&32&&(v.data=f[5].ni),_&64&&(v.zKey=f[6]),_&128&&(v.label=f[7]),c.$set(v)},i(f){d||(it(c.$$.fragment,f),d=!0)},o(f){lt(c.$$.fragment,f),d=!1},d(f){or(c,f)}}}function _1(h){let c,d;return c=new Fh({props:{data:h[5].prev,zKey:h[6],label:h[7]}}),{c(){ir(c.$$.fragment)},l(f){nr(c.$$.fragment,f)},m(f,_){ar(c,f,_),d=!0},p(f,_){const v={};_&32&&(v.data=f[5].prev),_&64&&(v.zKey=f[6]),_&128&&(v.label=f[7]),c.$set(v)},i(f){d||(it(c.$$.fragment,f),d=!0)},o(f){lt(c.$$.fragment,f),d=!1},d(f){or(c,f)}}}function g1(h){let c,d;return c=new Fh({props:{data:h[5].none,zKey:h[6],label:h[7]}}),{c(){ir(c.$$.fragment)},l(f){nr(c.$$.fragment,f)},m(f,_){ar(c,f,_),d=!0},p(f,_){const v={};_&32&&(v.data=f[5].none),_&64&&(v.zKey=f[6]),_&128&&(v.label=f[7]),c.$set(v)},i(f){d||(it(c.$$.fragment,f),d=!0)},o(f){lt(c.$$.fragment,f),d=!1},d(f){or(c,f)}}}function v1(h){let c,d;return c=new Nh({props:{data:h[5],zKey:h[6],label:h[7]}}),{c(){ir(c.$$.fragment)},l(f){nr(c.$$.fragment,f)},m(f,_){ar(c,f,_),d=!0},p(f,_){const v={};_&32&&(v.data=f[5]),_&64&&(v.zKey=f[6]),_&128&&(v.label=f[7]),c.$set(v)},i(f){d||(it(c.$$.fragment,f),d=!0)},o(f){lt(c.$$.fragment,f),d=!1},d(f){or(c,f)}}}function b1(h){let c,d;return c=new Nh({props:{data:h[5].ni,zKey:h[6],label:h[7]}}),{c(){ir(c.$$.fragment)},l(f){nr(c.$$.fragment,f)},m(f,_){ar(c,f,_),d=!0},p(f,_){const v={};_&32&&(v.data=f[5].ni),_&64&&(v.zKey=f[6]),_&128&&(v.label=f[7]),c.$set(v)},i(f){d||(it(c.$$.fragment,f),d=!0)},o(f){lt(c.$$.fragment,f),d=!1},d(f){or(c,f)}}}function x1(h){let c,d;return c=new Nh({props:{data:h[5].prev,zKey:h[6],label:h[7]}}),{c(){ir(c.$$.fragment)},l(f){nr(c.$$.fragment,f)},m(f,_){ar(c,f,_),d=!0},p(f,_){const v={};_&32&&(v.data=f[5].prev),_&64&&(v.zKey=f[6]),_&128&&(v.label=f[7]),c.$set(v)},i(f){d||(it(c.$$.fragment,f),d=!0)},o(f){lt(c.$$.fragment,f),d=!1},d(f){or(c,f)}}}function w1(h){let c,d;return c=new Nh({props:{data:h[5].none,zKey:h[6],label:h[7]}}),{c(){ir(c.$$.fragment)},l(f){nr(c.$$.fragment,f)},m(f,_){ar(c,f,_),d=!0},p(f,_){const v={};_&32&&(v.data=f[5].none),_&64&&(v.zKey=f[6]),_&128&&(v.label=f[7]),c.$set(v)},i(f){d||(it(c.$$.fragment,f),d=!0)},o(f){lt(c.$$.fragment,f),d=!1},d(f){or(c,f)}}}function k1(h){let c,d;return c=new Oh({props:{data:h[5],zKey:h[6],label:h[7]}}),{c(){ir(c.$$.fragment)},l(f){nr(c.$$.fragment,f)},m(f,_){ar(c,f,_),d=!0},p(f,_){const v={};_&32&&(v.data=f[5]),_&64&&(v.zKey=f[6]),_&128&&(v.label=f[7]),c.$set(v)},i(f){d||(it(c.$$.fragment,f),d=!0)},o(f){lt(c.$$.fragment,f),d=!1},d(f){or(c,f)}}}function S1(h){let c,d;return c=new Oh({props:{data:h[5].ni,zKey:h[6],label:h[7]}}),{c(){ir(c.$$.fragment)},l(f){nr(c.$$.fragment,f)},m(f,_){ar(c,f,_),d=!0},p(f,_){const v={};_&32&&(v.data=f[5].ni),_&64&&(v.zKey=f[6]),_&128&&(v.label=f[7]),c.$set(v)},i(f){d||(it(c.$$.fragment,f),d=!0)},o(f){lt(c.$$.fragment,f),d=!1},d(f){or(c,f)}}}function E1(h){let c,d;return c=new Oh({props:{data:h[5].prev,zKey:h[6],label:h[7]}}),{c(){ir(c.$$.fragment)},l(f){nr(c.$$.fragment,f)},m(f,_){ar(c,f,_),d=!0},p(f,_){const v={};_&32&&(v.data=f[5].prev),_&64&&(v.zKey=f[6]),_&128&&(v.label=f[7]),c.$set(v)},i(f){d||(it(c.$$.fragment,f),d=!0)},o(f){lt(c.$$.fragment,f),d=!1},d(f){or(c,f)}}}function T1(h){let c,d;return c=new Oh({props:{data:h[5].none,zKey:h[6],label:h[7]}}),{c(){ir(c.$$.fragment)},l(f){nr(c.$$.fragment,f)},m(f,_){ar(c,f,_),d=!0},p(f,_){const v={};_&32&&(v.data=f[5].none),_&64&&(v.zKey=f[6]),_&128&&(v.label=f[7]),c.$set(v)},i(f){d||(it(c.$$.fragment,f),d=!0)},o(f){lt(c.$$.fragment,f),d=!1},d(f){or(c,f)}}}function I1(h){let c,d;return c=new Bh({props:{data:h[5],zKey:h[6],label:h[7],topic_prev_available:h[0]}}),{c(){ir(c.$$.fragment)},l(f){nr(c.$$.fragment,f)},m(f,_){ar(c,f,_),d=!0},p(f,_){const v={};_&32&&(v.data=f[5]),_&64&&(v.zKey=f[6]),_&128&&(v.label=f[7]),_&1&&(v.topic_prev_available=f[0]),c.$set(v)},i(f){d||(it(c.$$.fragment,f),d=!0)},o(f){lt(c.$$.fragment,f),d=!1},d(f){or(c,f)}}}function z1(h){let c,d;return c=new Bh({props:{data:h[5].ni,zKey:h[6],label:h[7],topic_prev_available:h[0]}}),{c(){ir(c.$$.fragment)},l(f){nr(c.$$.fragment,f)},m(f,_){ar(c,f,_),d=!0},p(f,_){const v={};_&32&&(v.data=f[5].ni),_&64&&(v.zKey=f[6]),_&128&&(v.label=f[7]),_&1&&(v.topic_prev_available=f[0]),c.$set(v)},i(f){d||(it(c.$$.fragment,f),d=!0)},o(f){lt(c.$$.fragment,f),d=!1},d(f){or(c,f)}}}function A1(h){let c,d;return c=new Bh({props:{data:h[5].prev,zKey:h[6],label:h[7],topic_prev_available:h[0]}}),{c(){ir(c.$$.fragment)},l(f){nr(c.$$.fragment,f)},m(f,_){ar(c,f,_),d=!0},p(f,_){const v={};_&32&&(v.data=f[5].prev),_&64&&(v.zKey=f[6]),_&128&&(v.label=f[7]),_&1&&(v.topic_prev_available=f[0]),c.$set(v)},i(f){d||(it(c.$$.fragment,f),d=!0)},o(f){lt(c.$$.fragment,f),d=!1},d(f){or(c,f)}}}function P1(h){let c,d;return c=new Bh({props:{data:h[5].none,zKey:h[6],label:h[7],topic_prev_available:h[0]}}),{c(){ir(c.$$.fragment)},l(f){nr(c.$$.fragment,f)},m(f,_){ar(c,f,_),d=!0},p(f,_){const v={};_&32&&(v.data=f[5].none),_&64&&(v.zKey=f[6]),_&128&&(v.label=f[7]),_&1&&(v.topic_prev_available=f[0]),c.$set(v)},i(f){d||(it(c.$$.fragment,f),d=!0)},o(f){lt(c.$$.fragment,f),d=!1},d(f){or(c,f)}}}function Fm(h){let c,d,f,_=h[11][h[3].type][h[10]]+"";return{c(){c=Ne("br"),d=ft(),f=Ne("span"),this.h()},l(v){c=Ue(v,"BR",{}),d=dt(v),f=Ue(v,"SPAN",{class:!0});var a=Be(f);a.forEach(oe),this.h()},h(){ne(f,"class","text-small")},m(v,a){Le(v,c,a),Le(v,d,a),Le(v,f,a),f.innerHTML=_},p(v,a){a&3080&&_!==(_=v[11][v[3].type][v[10]]+"")&&(f.innerHTML=_)},d(v){v&&oe(c),v&&oe(d),v&&oe(f)}}}function C1(h){let c,d,f,_,v,a,I,T,M,F,R;const D=[i1,r1],H=[];function ae(Ve,Oe){return Ve[8]?0:1}d=ae(h),f=H[d]=D[d](h);const de=[c1,u1,l1,s1,o1,a1,n1],fe=[];function we(Ve,Oe){return Oe&24&&(I=null),Ve[4]=="StackedBarChart"?0:Ve[4]=="GroupChart"?1:Ve[4]=="ProfileChart"?2:Ve[4]=="BarChart"?3:Ve[4]=="ColChart"?4:(I==null&&(I=!!Ve[4].hasOwnProperty(Ve[3].type)),I?5:6)}T=we(h,-1),M=fe[T]=de[T](h);let xe=h[11]!=null&h[10]!=null&&Fm(h);return{c(){c=Ne("div"),f.c(),_=ft(),v=Ne("br"),a=ft(),M.c(),F=ft(),xe&&xe.c(),this.h()},l(Ve){c=Ue(Ve,"DIV",{class:!0,style:!0});var Oe=Be(c);f.l(Oe),_=dt(Oe),v=Ue(Oe,"BR",{}),a=dt(Oe),M.l(Oe),F=dt(Oe),xe&&xe.l(Oe),Oe.forEach(oe),this.h()},h(){ne(c,"class","div-grey-box svelte-1mdbgz6"),ne(c,"style",h[2])},m(Ve,Oe){Le(Ve,c,Oe),H[d].m(c,null),Ee(c,_),Ee(c,v),Ee(c,a),fe[T].m(c,null),Ee(c,F),xe&&xe.m(c,null),R=!0},p(Ve,[Oe]){let De=d;d=ae(Ve),d===De?H[d].p(Ve,Oe):(ta(),lt(H[De],1,1,()=>{H[De]=null}),ra(),f=H[d],f?f.p(Ve,Oe):(f=H[d]=D[d](Ve),f.c()),it(f,1),f.m(c,_));let He=T;T=we(Ve,Oe),T===He?fe[T].p(Ve,Oe):(ta(),lt(fe[He],1,1,()=>{fe[He]=null}),ra(),M=fe[T],M?M.p(Ve,Oe):(M=fe[T]=de[T](Ve),M.c()),it(M,1),M.m(c,F)),Ve[11]!=null&Ve[10]!=null?xe?xe.p(Ve,Oe):(xe=Fm(Ve),xe.c(),xe.m(c,null)):xe&&(xe.d(1),xe=null),(!R||Oe&4)&&ne(c,"style",Ve[2])},i(Ve){R||(it(f),it(M),R=!0)},o(Ve){lt(f),lt(M),R=!1},d(Ve){Ve&&oe(c),H[d].d(),fe[T].d(),xe&&xe.d()}}}function M1(h,c,d){let{id:f}=c,{style:_=null}=c,{place:v}=c,{content:a}=c,{chart_data:I=null}=c,{zKey:T="ni"}=c,{label:M=null}=c,{topic_prev_available:F=null}=c,{topic_boolean:R=null}=c,{i_button:D=!0}=c,{heading:H=null}=c,{chart_compare_type:ae}=c,{compare_content:de=null}=c;return F=="false"?R=!1:R=!0,h.$$set=fe=>{"id"in fe&&d(1,f=fe.id),"style"in fe&&d(2,_=fe.style),"place"in fe&&d(3,v=fe.place),"content"in fe&&d(4,a=fe.content),"chart_data"in fe&&d(5,I=fe.chart_data),"zKey"in fe&&d(6,T=fe.zKey),"label"in fe&&d(7,M=fe.label),"topic_prev_available"in fe&&d(12,F=fe.topic_prev_available),"topic_boolean"in fe&&d(0,R=fe.topic_boolean),"i_button"in fe&&d(8,D=fe.i_button),"heading"in fe&&d(9,H=fe.heading),"chart_compare_type"in fe&&d(10,ae=fe.chart_compare_type),"compare_content"in fe&&d(11,de=fe.compare_content)},[R,f,_,v,a,I,T,M,D,H,ae,de,F]}class kh extends mn{constructor(c){super(),yn(this,c,M1,C1,_n,{id:1,style:2,place:3,content:4,chart_data:5,zKey:6,label:7,topic_prev_available:12,topic_boolean:0,i_button:8,heading:9,chart_compare_type:10,compare_content:11})}}function Nm(h,c,d){const f=h.slice();return f[13]=c[d],f[15]=d,f}function Um(h){let c,d;return c=new kh({props:{id:h[6][h[10][h[15]]].id,style:h[6][h[10][h[15]]].style,place:h[3],content:h[6][h[10][h[15]]].content,chart_data:h[6][h[10][h[15]]].chart_data,zKey:h[6][h[10][h[15]]].zKey,label:h[6][h[10][h[15]]].label,topic_prev_available:h[6][h[10][h[15]]].topic_prev_available,chart_compare_type:h[8]}}),{c(){ir(c.$$.fragment)},l(f){nr(c.$$.fragment,f)},m(f,_){ar(c,f,_),d=!0},p(f,_){const v={};_&64&&(v.id=f[6][f[10][f[15]]].id),_&64&&(v.style=f[6][f[10][f[15]]].style),_&8&&(v.place=f[3]),_&64&&(v.content=f[6][f[10][f[15]]].content),_&64&&(v.chart_data=f[6][f[10][f[15]]].chart_data),_&64&&(v.zKey=f[6][f[10][f[15]]].zKey),_&64&&(v.label=f[6][f[10][f[15]]].label),_&64&&(v.topic_prev_available=f[6][f[10][f[15]]].topic_prev_available),_&256&&(v.chart_compare_type=f[8]),c.$set(v)},i(f){d||(it(c.$$.fragment,f),d=!0)},o(f){lt(c.$$.fragment,f),d=!1},d(f){or(c,f)}}}function Vm(h){let c,d,f,_;return{c(){c=Ne("h3"),d=St("More Statistics"),f=ft(),_=Ne("div"),this.h()},l(v){c=Ue(v,"H3",{});var a=Be(c);d=Et(a,"More Statistics"),a.forEach(oe),f=dt(v),_=Ue(v,"DIV",{class:!0});var I=Be(_);I.forEach(oe),this.h()},h(){ne(_,"class","accordion-more svelte-1jaw0n6")},m(v,a){Le(v,c,a),Ee(c,d),Le(v,f,a),Le(v,_,a),_.innerHTML=h[7]},p(v,a){a&128&&(_.innerHTML=v[7])},d(v){v&&oe(c),v&&oe(f),v&&oe(_)}}}function D1(h){let c,d,f,_,v,a,I,T,M,F,R,D,H,ae,de,fe,we=h[3].name+"",xe,Ve,Oe,De,He,Tt,Lt,qt,_t,ht,Ft,yt={length:h[10].length},It=[];for(let pt=0;pt<yt.length;pt+=1)It[pt]=Um(Nm(h,yt,pt));const tt=pt=>lt(It[pt],1,1,()=>{It[pt]=null});let Zt=h[7]!=""&&Vm(h);return{c(){c=Ne("div"),d=Ne("h2"),f=Ne("button"),_=Ne("span"),v=Ne("img"),I=ft(),T=St(h[2]),D=ft(),H=Ne("div"),ae=Ne("div"),de=St(h[4]),fe=St(" - "),xe=St(we),Ve=St(` -\r
            `),Oe=Ne("span"),De=St(h[5]),He=ft(),Tt=Ne("div");for(let pt=0;pt<It.length;pt+=1)It[pt].c();qt=ft(),Zt&&Zt.c(),this.h()},l(pt){c=Ue(pt,"DIV",{class:!0});var zt=Be(c);d=Ue(zt,"H2",{class:!0,id:!0});var Ut=Be(d);f=Ue(Ut,"BUTTON",{class:!0,type:!0,"data-bs-toggle":!0,"data-bs-target":!0,"aria-expanded":!0,"aria-controls":!0});var ei=Be(f);_=Ue(ei,"SPAN",{class:!0});var Je=Be(_);v=Ue(Je,"IMG",{src:!0,alt:!0,height:!0,class:!0}),I=dt(Je),T=Et(Je,h[2]),Je.forEach(oe),ei.forEach(oe),Ut.forEach(oe),D=dt(zt),H=Ue(zt,"DIV",{id:!0,class:!0,"aria-labelledby":!0});var At=Be(H);ae=Ue(At,"DIV",{class:!0});var pr=Be(ae);de=Et(pr,h[4]),fe=Et(pr," - "),xe=Et(pr,we),Ve=Et(pr,` -\r
            `),Oe=Ue(pr,"SPAN",{class:!0});var Fr=Be(Oe);De=Et(Fr,h[5]),Fr.forEach(oe),He=dt(pr),Tt=Ue(pr,"DIV",{class:!0});var Mr=Be(Tt);for(let Zr=0;Zr<It.length;Zr+=1)It[Zr].l(Mr);Mr.forEach(oe),qt=dt(pr),Zt&&Zt.l(pr),pr.forEach(oe),At.forEach(oe),zt.forEach(oe),this.h()},h(){xd(v.src,a=Ma+"/img/"+h[1])||ne(v,"src",a),ne(v,"alt","logo"),ne(v,"height","40"),ne(v,"class","accordion-dept-logo"),ne(_,"class","accordion-button-title"),ne(f,"class","accordion-button collapsed"),ne(f,"type","button"),ne(f,"data-bs-toggle","collapse"),ne(f,"data-bs-target",M="#panelsStayOpen-collapse"+h[0]),ne(f,"aria-expanded","false"),ne(f,"aria-controls",F="panelsStayOpen-collapse"+h[0]),ne(d,"class","accordion-header"),ne(d,"id",R="panelsStayOpen-heading"+h[0]),ne(Oe,"class","accordion-button-title-sub"),ne(Tt,"class","grid mt svelte-1jaw0n6"),qu(()=>h[11].call(Tt)),ne(ae,"class","accordion-body"),ne(H,"id",_t="panelsStayOpen-collapse"+h[0]),ne(H,"class","accordion-collapse collapse"),ne(H,"aria-labelledby",ht="panelsStayOpen-heading"+h[0]),ne(c,"class","accordion-item")},m(pt,zt){Le(pt,c,zt),Ee(c,d),Ee(d,f),Ee(f,_),Ee(_,v),Ee(_,I),Ee(_,T),Ee(c,D),Ee(c,H),Ee(H,ae),Ee(ae,de),Ee(ae,fe),Ee(ae,xe),Ee(ae,Ve),Ee(ae,Oe),Ee(Oe,De),Ee(ae,He),Ee(ae,Tt);for(let Ut=0;Ut<It.length;Ut+=1)It[Ut]&&It[Ut].m(Tt,null);Lt=Zu(Tt,h[11].bind(Tt)),Ee(ae,qt),Zt&&Zt.m(ae,null),Ft=!0},p(pt,[zt]){if((!Ft||zt&2&&!xd(v.src,a=Ma+"/img/"+pt[1]))&&ne(v,"src",a),(!Ft||zt&4)&&Er(T,pt[2]),(!Ft||zt&1&&M!==(M="#panelsStayOpen-collapse"+pt[0]))&&ne(f,"data-bs-target",M),(!Ft||zt&1&&F!==(F="panelsStayOpen-collapse"+pt[0]))&&ne(f,"aria-controls",F),(!Ft||zt&1&&R!==(R="panelsStayOpen-heading"+pt[0]))&&ne(d,"id",R),(!Ft||zt&16)&&Er(de,pt[4]),(!Ft||zt&8)&&we!==(we=pt[3].name+"")&&Er(xe,we),(!Ft||zt&32)&&Er(De,pt[5]),zt&1352){yt={length:pt[10].length};let Ut;for(Ut=0;Ut<yt.length;Ut+=1){const ei=Nm(pt,yt,Ut);It[Ut]?(It[Ut].p(ei,zt),it(It[Ut],1)):(It[Ut]=Um(ei),It[Ut].c(),it(It[Ut],1),It[Ut].m(Tt,null))}for(ta(),Ut=yt.length;Ut<It.length;Ut+=1)tt(Ut);ra()}pt[7]!=""?Zt?Zt.p(pt,zt):(Zt=Vm(pt),Zt.c(),Zt.m(ae,null)):Zt&&(Zt.d(1),Zt=null),(!Ft||zt&1&&_t!==(_t="panelsStayOpen-collapse"+pt[0]))&&ne(H,"id",_t),(!Ft||zt&1&&ht!==(ht="panelsStayOpen-heading"+pt[0]))&&ne(H,"aria-labelledby",ht)},i(pt){if(!Ft){for(let zt=0;zt<yt.length;zt+=1)it(It[zt]);Ft=!0}},o(pt){It=It.filter(Boolean);for(let zt=0;zt<It.length;zt+=1)lt(It[zt]);Ft=!1},d(pt){pt&&oe(c),on(It,pt),Lt(),Zt&&Zt.d()}}}function L1(h,c,d){let{id:f}=c,{img:_}=c,{heading:v}=c,{place:a}=c,{sub_heading:I}=c,{description:T}=c,{boxes:M}=c,{more:F}=c,{chart_compare_type:R}=c,D=Object.keys(M),H;function ae(){H=this.clientWidth,d(9,H)}return h.$$set=de=>{"id"in de&&d(0,f=de.id),"img"in de&&d(1,_=de.img),"heading"in de&&d(2,v=de.heading),"place"in de&&d(3,a=de.place),"sub_heading"in de&&d(4,I=de.sub_heading),"description"in de&&d(5,T=de.description),"boxes"in de&&d(6,M=de.boxes),"more"in de&&d(7,F=de.more),"chart_compare_type"in de&&d(8,R=de.chart_compare_type)},[f,_,v,a,I,T,M,F,R,H,D,ae]}class Dl extends mn{constructor(c){super(),yn(this,c,L1,D1,_n,{id:0,img:1,heading:2,place:3,sub_heading:4,description:5,boxes:6,more:7,chart_compare_type:8})}}function jm(h,c,d){const f=h.slice();return f[35]=c[d],f[37]=d,f}function qm(h,c,d){const f=h.slice();return f[38]=c[d],f[37]=d,f}function Zm(h,c,d){const f=h.slice();return f[40]=c[d],f}function Gm(h,c,d){const f=h.slice();return f[38]=c[d],f[37]=d,f}function Km(h){let c,d,f,_,v,a,I=" &gt; ",T,M,F,R,D,H=h[0].place.name+"",ae,de,fe,we,xe,Ve,Oe,De,He,Tt,Lt,qt,_t,ht,Ft,yt,It,tt,Zt,pt,zt,Ut,ei,Je,At,pr,Fr,Mr,Zr,sr,ti,Wt,Gr,mr,Nr,jt,Dr,Kr,cr,Fi,Ar,bi,pi,Qi,Mi,fi,ri,sn,di,Ur,$i,Ln,Ni,zn,en,An,Ui,gn,Vi,Rn,tn,ji,vn,ln;function un(K,ve){return K[0].place.type!="ni"?B1:R1}let bn=un(h),oi=bn(h);function Pr(K,ve){return K[0].place.type=="ni"?F1:O1}let L=Pr(h),N=L(h),V=h[0].place.type!="ni"&&Wm(h);Ft=new tg({props:{search_data:h[0].search_data,group:"typestr",search:!0}}),Ft.$on("select",h[14]),ti=new kh({props:{id:"overview",i_button:!1,heading:"Overview - box with words",place:h[0].place,style:"line-height: 1.3;",content:{ni:"The population of "+h[0].place.name+" was "+h[0].place.data.population.value[2021].all.toLocaleString()+" at the time of the 2021 Census. "+h[16](h[0].place.data.population.value.change.all),lgd:"The population of "+h[0].place.name+" was "+h[0].place.data.population.value[2021].all.toLocaleString()+" at the time of the 2021 Census, which made it the "+h[15](h[0].place.data.population.value_rank[2021].all)+" Local Government District. "+h[16](h[0].place.data.population.value.change.all),dea:"The population of "+h[0].place.name+" was "+h[0].place.data.population.value[2021].all.toLocaleString()+" at the time of the 2021 Census, which made it the "+h[15](h[0].place.data.population.value_rank[2021].all)+" District Electoral Area."},chart_compare_type:h[9]}}),Gr=new kh({props:{id:"pop",place:h[0].place,content:'<span class="text-big" style="font-size: 2.8em;">'+h[0].place.data.population.value[2021].all.toLocaleString()+"</span>",chart_compare_type:h[9],compare_content:{ni:{prev:'<span class="em '+Pa(h[0].place.data.population.value.change.all)+'">'+Ca(h[0].place.data.population.value.change.all,"%",1)+"</span> since 2011 Census"},lgd:{prev:'<span class="em '+Pa(h[0].place.data.population.value.change.all)+'">'+Ca(h[0].place.data.population.value.change.all,"%",1)+"</span> since 2011 Census",ni:'<span class = "em" style = "background-color: lightgrey">'+ns(h[0].place.data.population.value[2021].all/h[0].ni.data.population.value[2021].all)+"</span> of Northern Ireland population<br>The "+h[15](h[0].place.data.population.value_rank[2021].all)+" population of 11 Local Government Districts"},dea:{prev:'<span class="em '+Pa(h[0].place.data.population.value.change.all)+'">'+Ca(h[0].place.data.population.value.change.all,"%",1)+"</span> since 2011 Census",ni:'<span class = "em" style = "background-color: lightgrey">'+ns(h[0].place.data.population.value[2021].all/h[0].ni.data.population.value[2021].all)+"</span> of Northern Ireland population"}}}}),Nr=new kh({props:{id:"popden",place:h[0].place,content:'<span class="text-big" style="font-size: 2.8em;">'+h[0].place.data.households.value[2021].all_households.toLocaleString()+"</span>",chart_compare_type:h[9],compare_content:{ni:{prev:'<span class="em '+Pa(h[0].place.data.households.value.change.all_households)+'">'+Ca(h[0].place.data.households.value.change.all_households,"%",1)+"</span> since 2011 Census"},lgd:{prev:'<span class="em '+Pa(h[0].place.data.households.value.change.all_households)+'">'+Ca(h[0].place.data.households.value.change.all_households,"%",1)+"</span> since 2011 Census",ni:'<span class = "em" style = "background-color: lightgrey">'+ns(h[0].place.data.households.value[2021].all_households/h[0].ni.data.households.value[2021].all_households)+"</span> of Northern Ireland households"},dea:{prev:'<span class="em '+Pa(h[0].place.data.households.value.change.all_households)+'">'+Ca(h[0].place.data.households.value.change.all_households,"%",1)+"</span> since 2011 Census",ni:'<span class = "em" style = "background-color: lightgrey">'+ns(h[0].place.data.households.value[2021].all_households/h[0].ni.data.households.value[2021].all_households)+"</span> of Northern Ireland households"}}}});function W(K,ve){return K[0].place.type!="ni"?U1:N1}let $=W(h),se=$(h);function he(K){h[29](K)}let j={location:{bounds:h[0].place.bounds},options:{fitBoundsOptions:{padding:20}},style:rg,$$slots:{default:[j1]},$$scope:{ctx:h}};h[5]!==void 0&&(j.map=h[5]),bi=new jg({props:j}),Nu.push(()=>ag(bi,"map",he));let J=h[0].place.type!="ni"&&Jm(h);function _e(K,ve){return K[0].place.children[0]?Z1:q1}let Ce=_e(h),Me=Ce(h);return $i=new Dl({props:{id:"people",img:"nisra-taxonomy-icon-census.png",heading:"People and Households",place:h[0].place,sub_heading:"",description:"",chart_compare_type:h[9],boxes:{box_1:{id:"popchange",content:"<span > population growth/shrink to be added</span>"},box_2:{id:"age",content:"GroupChart",chart_data:{none:h[12](h[0].place.grouped_data_nocompare.age,"age"),prev:h[12](h[0].place.grouped_data_timecompare.age,"age"),ni:h[12](h[0].place.grouped_data_areacompare.age,"age")},zKey:"group",label:h[10],topic_prev_available:"true"},box_3:{id:"sex",content:"<span > sex split to be added</span>"},box_4:{id:"hhsize",content:"GroupChart",chart_data:{none:h[12](h[0].place.grouped_data_nocompare.hh_size,"hh_size"),prev:h[12](h[0].place.grouped_data_timecompare.hh_size,"hh_size"),ni:h[12](h[0].place.grouped_data_areacompare.hh_size,"hh_size")},zKey:"group",label:h[10],topic_prev_available:"true"},box_5:{id:"religion",content:"GroupChart",chart_data:{none:h[12](h[0].place.grouped_data_nocompare.religion_or_religion_brought_up_in,"religion_or_religion_brought_up_in"),prev:h[12](h[0].place.grouped_data_timecompare.religion_or_religion_brought_up_in,"religion_or_religion_brought_up_in"),ni:h[12](h[0].place.grouped_data_areacompare.religion_or_religion_brought_up_in,"religion_or_religion_brought_up_in")},zKey:"group",label:h[10],topic_prev_available:"true"},box_6:{id:"language",content:"GroupChart",chart_data:{none:h[12](h[0].place.grouped_data_nocompare.mainlang,"mainlang"),prev:h[12](h[0].place.grouped_data_timecompare.mainlang,"mainlang"),ni:h[12](h[0].place.grouped_data_areacompare.mainlang,"mainlang")},zKey:"group",label:h[10],topic_prev_available:"true"}},more:`More information on the size of the population is available in the latest <a href='https://www.nisra.gov.uk/publications/2022-mid-year-population-estimates-northern-ireland'>mid-year estimates release</a>, \r
					which includes an <a href='https://www.nisra.gov.uk/system/files/statistics/MYE22-summary.pdf'>infographic</a>, \r
					<a href='https://www.nisra.gov.uk/system/files/statistics/MYE22-Factsheets.pdf'>Fact Sheets</a>, \r
					a <a href='https://www.nisra.gov.uk/system/files/statistics/Statistical%20Bulletin%20-%202022%20Mid-year%20Population%20Estimates%20for%20Northern%20Ireland.pdf'>publication</a> \r
					and statistical tables. Population characteristics are from the census data which can be explored further in the <a href='https://explore.nisra.gov.uk/area-explorer-2021/N92000002/'>Census Area Explorer</a>, \r
					bespoke tables can be created using the <a href='https://build.nisra.gov.uk/en/'>Flexible Table Builder</a> and the NISRA website has \r
					<a href='https://www.nisra.gov.uk/publications/census-2021-statistical-bulletins'>statistical bulletins</a> providing commentary on a range of census population characteristics.\r
					`}}),Ni=new Dl({props:{id:"health",img:"nisra-taxonomy-icon-health.png",heading:"Health and Social Care",place:h[0].place,sub_heading:"Health",description:"xxxx",chart_compare_type:h[9],boxes:{box_1:{id:"generalhealth",content:"StackedBarChart",chart_data:h[0].place&&h[11](["general_health"],["2011"],["2021"]),zKey:h[9],label:h[10],topic_prev_available:"true"},box_2:{id:"wellbeing",content:"<p><span class='text-big' style='font-size: 2.8em'>7.5</span> / 10 </p>"},box_3:{id:"lifeexpectancy",content:"<p>Males <span class='text-big' style='font-size: 1.8em'>78.6 years</span></p><p>Female <span class='text-big' style='font-size: 1.8em'>82.7 years</span></p>"},box_4:{id:"carers",content:"GroupChart",chart_data:{none:h[12](h[0].place.grouped_data_nocompare.provision_care,"provision_care"),prev:h[12](h[0].place.grouped_data_timecompare.provision_care,"provision_care"),ni:h[12](h[0].place.grouped_data_areacompare.provision_care,"provision_care")},zKey:"group",label:h[10],topic_prev_available:"true"},box_5:{id:"hospitalactivity",content:"<span > hospital activity to be added</span>"},box_6:{id:"primarycare",content:"<span > primary care to be added</span>"}},more:`<p>Significant volumes of information are prepared by the <a href='https://www.health-ni.gov.uk/topics/doh-statistics-and-research'>Department of Health</a> \r
			and the <a href='https://bso.hscni.net/directorates/operations/family-practitioner-services/directorates-operations-family-practitioner-services-information-unit/general-ophthalmic-services-statistics/'>\r
				Business Services Organisation</a>, including statistics on <a href='https://www.health-ni.gov.uk/topics/dhssps-statistics-and-research/health-inequalities-statistics'>Health inequalities</a>, \r
				Primary care (including <a href='https://bso.hscni.net/directorates/operations/family-practitioner-services/directorates-operations-family-practitioner-services-information-unit/1776-2/'>Medical</a>, \r
				<a href='https://bso.hscni.net/directorates/operations/family-practitioner-services/directorates-operations-family-practitioner-services-information-unit/general-dental-services-statistics/'>Dental</a>, \r
				<a href='https://bso.hscni.net/directorates/operations/family-practitioner-services/directorates-operations-family-practitioner-services-information-unit/general-pharmaceutical-services-and-prescribing-statistics/'>\r
				Pharmaceutical</a> and <a href='https://bso.hscni.net/directorates/operations/family-practitioner-services/directorates-operations-family-practitioner-services-information-unit/general-ophthalmic-services-statistics/'>\r
				Ophthalmic</a>), <a href='https://www.health-ni.gov.uk/topics/dhssps-statistics-and-research/family-health-services-statistics'>\r
				Family health services</a>, <a href='https://www.health-ni.gov.uk/topics/doh-statistics-and-research-mental-health-and-learning-disabilities/mental-health-learning-disability-and-autism-statistics'>\r
				Mental health, learning disability and autism</a>, <a href='https://www.health-ni.gov.uk/topics/dhssps-statistics-and-research-social-services/social-care-statistics'>\r
				Social care</a>, <a href='https://www.health-ni.gov.uk/topics/dhssps-statistics-and-research/workforce-statistics'>Workforce</a>, and <u>COVID-19</u>.\r
				A number of <a href='https://visual.nisra.gov.uk/?body=entity/health'>interactive dashboards</a> are available and a compendium dashboard for <a href='https://visual.nisra.gov.uk/?body=entity/las'>\r
				Making Life Better</a>.\r
				The <a href='https://www.nisra.gov.uk/statistics/census'>2021 census</a> collected data on general health, long-term conditions and carers which can \r
				be explored in the <a href='https://explore.nisra.gov.uk/area-explorer-2021/N92000002/'>Census Area Explorer</a> and the <a href='https://build.nisra.gov.uk/en/'>Flexible Table Builder</a>.</p><p></p>`}}),en=new Dl({props:{id:"work",img:"nisra-taxonomy-icon-labour-market.png",heading:"Work and Welfare",place:h[0].place,sub_heading:"Work and welfare",description:"xxxx",chart_compare_type:h[9],boxes:{box_1:{id:"employmentrates",content:"<span > employment to be added</span>"},box_2:{id:"employed",content:"<span > numbers employed to be added</span>"},box_3:{id:"wages",content:"<p><span class='text-big' style='font-size: 1.8em'>26,531</span> annual median salary</p>"},box_4:{id:"benefits",content:"<span > benefits claimants to be added</span>"}},more:`<p>The monthly <a href='https://www.nisra.gov.uk/statistics/labour-market-and-social-welfare/labour-market-overview'>Labour Market Report</a>\r
			 contains the most up to date labour market statistics. The <a href='https://www.nisra.gov.uk/statistics/labour-market-and-social-welfare/annual-survey-hours-and-earnings'>\r
				Annual Survey of Hours and Earnings</a> providesdata on hourly, weekly and annual earnings. The <a href='https://www.nisra.gov.uk/statistics/labour-market-and-social-welfare/quarterly-employment-survey'>\r
					Quarterly Employment Survey</a> provides short-term employee jobs estimates for NI. Further information is available for the \r
					unemployed <a href='https://www.nisra.gov.uk/statistics/labour-market-and-social-welfare/claimant-count'>Claimant Count</a>, \r
					claimant numbers for <a href='https://www.nisra.gov.uk/statistics/labour-market-and-social-welfare/disability-benefits'>Disability Benefits</a>, \r
					and <a href='https://www.nisra.gov.uk/statistics/labour-market-and-social-welfare/work-related-benefits'>Work Related Benefits</a>. \r
					Statistics on <a href='https://www.nisra.gov.uk/statistics/labour-market-and-social-welfare/redundancies'>Redundancies</a> \r
					and <a href='https://www.nisra.gov.uk/statistics/labour-market-and-social-welfare/job-vacancies'>Job Vacancies</a> are also available. \r
					A number of <a href='https://visual.nisra.gov.uk/?body=entity/lm'>interactive dashboards</a> are available. \r
					The <a href='https://www.nisra.gov.uk/statistics/census'>2021 census</a> collected data on occupations, industry and number of hours worked which can be \r
					explored in the <a href='https://explore.nisra.gov.uk/area-explorer-2021/N92000002/'>Census Area Explorer</a> and the <a href='https://build.nisra.gov.uk/en/'>Flexible Table Builder</a>.</p>`}}),Ui=new Dl({props:{id:"education",img:"nisra-taxonomy-icon-child-education-skills.png",heading:"Education",place:h[0].place,sub_heading:"Schools, colleges and universities",description:"",chart_compare_type:h[9],boxes:{box_1:{id:"enrollments",content:"<p>Primary school <span class='text-big' style='font-size: 1.2em'>500 </span></p><p>Secondary school <span class='text-big' style='font-size: 1.2em'>320 </span></p><p>Further education colleges <span class='text-big' style='font-size: 1.2em'>45 </span></p><p>University <span class='text-big' style='font-size: 1.2em'>200 </span></p>"},box_2:{id:"fsme",content:"<p>Primary school <span class='text-big' style='font-size: 1.8em'>33.2%</span></p><p>Secondary school <span class='text-big' style='font-size: 1.8em'>25.2%</span></p>"},box_3:{id:"teachers",content:"<span > teachers to be added</span>"},box_4:{id:"qualifications",content:"GroupChart",chart_data:{none:h[12](h[0].place.grouped_data_nocompare.highest_level_of_qualifications,"highest_level_of_qualifications"),prev:h[12](h[0].place.grouped_data_timecompare.highest_level_of_qualifications,"highest_level_of_qualifications"),ni:h[12](h[0].place.grouped_data_areacompare.highest_level_of_qualifications,"highest_level_of_qualifications")},zKey:"group",label:h[10],topic_prev_available:"true"},box_5:{id:"attainment",content:"<span > attainment to be added</span>"}},more:"<p>The <a href='https://www.nisra.gov.uk/statistics/children-education-and-skills/school-education-statistics'>Department of Education</a> publishes statistics on <a href='https://www.education-ni.gov.uk/articles/school-enrolments-overview'>school enrolments</a>, <a href='https://www.education-ni.gov.uk/articles/school-performance'>school performance</a>, <a href='https://www.education-ni.gov.uk/articles/school-leavers'>school leavers</a>, qualifications and destinations, <a href='https://www.education-ni.gov.uk/articles/pupil-attendance'>pupil attendance</a>, suspensions and expulsions, school meals and <a href='https://www.education-ni.gov.uk/articles/education-workforce'>education workforce</a>. The <a href='https://www.nisra.gov.uk/statistics/children-education-and-skills/higher-and-further-education-and-training-statistics'>Department for the Economy</a> publishes <a href='https://www.economy-ni.gov.uk/topics/statistics-and-economic-research/higher-education-statistics-and-research'>Higher</a> and <a href='https://www.economy-ni.gov.uk/topics/statistics-and-economic-research/further-education-statistics-and-research'>Further</a> education and <a href='https://www.economy-ni.gov.uk/articles/training-success-statistics'>training</a> statistics. The <a href='https://www.nisra.gov.uk/statistics/census'>2021 census</a> collected data on qualifications which can be explored in the <a href='https://explore.nisra.gov.uk/area-explorer-2021/N92000002/'>Census Area Explorer</a> and the <a href='https://build.nisra.gov.uk/en/'>Flexible Table Builder</a>.</p>"}}),Vi=new Dl({props:{id:"crime",img:"nisra-taxonomy-icon-crime-justice.png",heading:"Crime and Justice",place:h[0].place,sub_heading:"Crime and court activity",description:"xxxx",chart_compare_type:h[9],boxes:{},more:""}}),tn=new Dl({props:{id:"travel",img:"nisra-taxonomy-icon-travel-transport.png",heading:"Travel and Transport",place:h[0].place,sub_heading:"Travel and transport .... ",description:"xxxx",chart_compare_type:h[9],boxes:{},more:""}}),{c(){c=Ne("div"),d=Ne("div"),f=Ne("span"),_=Ne("a"),v=St("Home"),a=new Xu(!1),T=ft(),oi.c(),M=ft(),F=Ne("br"),R=ft(),D=Ne("span"),ae=St(H),de=ft(),fe=Ne("div"),we=St(`Click for:\r
\r
					`),N.c(),xe=ft(),V&&V.c(),Ve=ft(),Oe=Ne("button"),De=St("Same area - previous"),He=ft(),Tt=Ne("div"),Lt=Ne("div"),qt=Ne("b"),_t=St("Search for your area:"),ht=ft(),ir(Ft.$$.fragment),yt=ft(),It=Ne("script"),tt=St(`// Share button\r
						// Possible tooltip: https://stackoverflow.com/questions/37798967/tooltip-on-click-of-a-button\r
\r
						function copyToClipboard(text) {\r
							var inputc = document.body.appendChild(\r
								document.createElement("input"),\r
							);\r
							inputc.value = window.location.href;\r
							inputc.select();\r
							document.execCommand("copy");\r
							inputc.parentNode.removeChild(inputc);\r
							alert("URL Copied.");\r
						}\r
\r
						(function (win, doc) {\r
							const testButton = doc.createElement("button");\r
							testButton.setAttribute("type", "share");\r
							if (testButton.type != "share") {\r
								win.addEventListener("click", function (ev) {\r
									ev = ev || win.event;\r
									let target = ev.target;\r
									let button = target.closest(\r
										'button[type="share"]',\r
									);\r
									if (button) {\r
										const title = "Share URL";\r
										const url = win.location.href;\r
										if (navigator.share) {\r
											navigator.share({\r
												title: title,\r
												url: url,\r
											});\r
										} else {\r
											copyToClipboard();\r
										}\r
									}\r
								});\r
							}\r
						})(this, this.document);`),Zt=ft(),pt=Ne("div"),zt=Ne("button"),Ut=St("Print / PDF"),ei=ft(),Je=Ne("button"),At=St("Menu"),pr=ft(),Fr=Ne("button"),Mr=St("Share"),Zr=ft(),sr=Ne("div"),ir(ti.$$.fragment),Wt=ft(),ir(Gr.$$.fragment),mr=ft(),ir(Nr.$$.fragment),jt=ft(),Dr=Ne("div"),Kr=Ne("div"),cr=Ne("h3"),se.c(),Fi=ft(),Ar=Ne("div"),ir(bi.$$.fragment),Qi=ft(),Mi=Ne("div"),J&&J.c(),fi=ft(),ri=Ne("div"),Me.c(),di=ft(),Ur=Ne("div"),ir($i.$$.fragment),Ln=ft(),ir(Ni.$$.fragment),zn=ft(),ir(en.$$.fragment),An=ft(),ir(Ui.$$.fragment),gn=ft(),ir(Vi.$$.fragment),Rn=ft(),ir(tn.$$.fragment),this.h()},l(K){c=Ue(K,"DIV",{class:!0});var ve=Be(c);d=Ue(ve,"DIV",{});var et=Be(d);f=Ue(et,"SPAN",{class:!0});var Ye=Be(f);_=Ue(Ye,"A",{href:!0,"sveltekit:noscroll":!0,class:!0});var Se=Be(_);v=Et(Se,"Home"),Se.forEach(oe),a=Wu(Ye,!1),T=dt(Ye),oi.l(Ye),M=dt(Ye),Ye.forEach(oe),F=Ue(et,"BR",{}),R=dt(et),D=Ue(et,"SPAN",{class:!0});var We=Be(D);ae=Et(We,H),We.forEach(oe),de=dt(et),fe=Ue(et,"DIV",{class:!0,style:!0});var Fe=Be(fe);we=Et(Fe,`Click for:\r
\r
					`),N.l(Fe),xe=dt(Fe),V&&V.l(Fe),Ve=dt(Fe),Oe=Ue(Fe,"BUTTON",{class:!0});var qe=Be(Oe);De=Et(qe,"Same area - previous"),qe.forEach(oe),Fe.forEach(oe),et.forEach(oe),He=dt(ve),Tt=Ue(ve,"DIV",{});var Mt=Be(Tt);Lt=Ue(Mt,"DIV",{style:!0,class:!0});var Ze=Be(Lt);qt=Ue(Ze,"B",{});var Vt=Be(qt);_t=Et(Vt,"Search for your area:"),Vt.forEach(oe),ht=dt(Ze),nr(Ft.$$.fragment,Ze),yt=dt(Ze),It=Ue(Ze,"SCRIPT",{});var lr=Be(It);tt=Et(lr,`// Share button\r
						// Possible tooltip: https://stackoverflow.com/questions/37798967/tooltip-on-click-of-a-button\r
\r
						function copyToClipboard(text) {\r
							var inputc = document.body.appendChild(\r
								document.createElement("input"),\r
							);\r
							inputc.value = window.location.href;\r
							inputc.select();\r
							document.execCommand("copy");\r
							inputc.parentNode.removeChild(inputc);\r
							alert("URL Copied.");\r
						}\r
\r
						(function (win, doc) {\r
							const testButton = doc.createElement("button");\r
							testButton.setAttribute("type", "share");\r
							if (testButton.type != "share") {\r
								win.addEventListener("click", function (ev) {\r
									ev = ev || win.event;\r
									let target = ev.target;\r
									let button = target.closest(\r
										'button[type="share"]',\r
									);\r
									if (button) {\r
										const title = "Share URL";\r
										const url = win.location.href;\r
										if (navigator.share) {\r
											navigator.share({\r
												title: title,\r
												url: url,\r
											});\r
										} else {\r
											copyToClipboard();\r
										}\r
									}\r
								});\r
							}\r
						})(this, this.document);`),lr.forEach(oe),Zt=dt(Ze),pt=Ue(Ze,"DIV",{width:!0});var Pt=Be(pt);zt=Ue(Pt,"BUTTON",{class:!0,style:!0,title:!0,onclick:!0});var er=Be(zt);Ut=Et(er,"Print / PDF"),er.forEach(oe),ei=dt(Pt),Je=Ue(Pt,"BUTTON",{class:!0,style:!0,alt:!0,onclick:!0});var Jt=Be(Je);At=Et(Jt,"Menu"),Jt.forEach(oe),pr=dt(Pt),Fr=Ue(Pt,"BUTTON",{class:!0,style:!0,type:!0,alt:!0});var ii=Be(Fr);Mr=Et(ii,"Share"),ii.forEach(oe),Pt.forEach(oe),Ze.forEach(oe),Mt.forEach(oe),ve.forEach(oe),Zr=dt(K),sr=Ue(K,"DIV",{id:!0,class:!0});var $t=Be(sr);nr(ti.$$.fragment,$t),Wt=dt($t),nr(Gr.$$.fragment,$t),mr=dt($t),nr(Nr.$$.fragment,$t),$t.forEach(oe),jt=dt(K),Dr=Ue(K,"DIV",{class:!0});var vr=Be(Dr);Kr=Ue(vr,"DIV",{style:!0});var fr=Be(Kr);cr=Ue(fr,"H3",{class:!0});var Gt=Be(cr);se.l(Gt),Gt.forEach(oe),fr.forEach(oe),Fi=dt(vr),Ar=Ue(vr,"DIV",{id:!0,style:!0,class:!0});var tr=Be(Ar);nr(bi.$$.fragment,tr),tr.forEach(oe),Qi=dt(vr),Mi=Ue(vr,"DIV",{});var si=Be(Mi);J&&J.l(si),si.forEach(oe),fi=dt(vr),ri=Ue(vr,"DIV",{});var Bn=Be(ri);Me.l(Bn),Bn.forEach(oe),vr.forEach(oe),di=dt(K),Ur=Ue(K,"DIV",{class:!0,id:!0});var xr=Be(Ur);nr($i.$$.fragment,xr),Ln=dt(xr),nr(Ni.$$.fragment,xr),zn=dt(xr),nr(en.$$.fragment,xr),An=dt(xr),nr(Ui.$$.fragment,xr),gn=dt(xr),nr(Vi.$$.fragment,xr),Rn=dt(xr),nr(tn.$$.fragment,xr),xr.forEach(oe),this.h()},h(){ne(_,"href",Ma+"/"),ne(_,"sveltekit:noscroll",""),ne(_,"class","svelte-hmrro5"),a.a=T,ne(f,"class","text-small"),ne(D,"class","text-big title svelte-hmrro5"),ne(Oe,"class","btn svelte-hmrro5"),Xn(Oe,"btn-active",h[2]&!h[3]&!h[8]),ne(fe,"class","text-bold"),Ke(fe,"font-size","0.85em"),ne(zt,"class","btn svelte-hmrro5"),Ke(zt,"width","33%"),ne(zt,"title","Click to print this page to pdf or printer"),ne(zt,"onclick","window.print();return false;"),ne(Je,"class","btn svelte-hmrro5"),Ke(Je,"width","33%"),ne(Je,"alt","Return to the landing page"),ne(Je,"onclick","window.location.href='"+Ma+"';"),ne(Fr,"class","btn svelte-hmrro5"),Ke(Fr,"width","30%"),ne(Fr,"type","share"),ne(Fr,"alt","Share this page"),ne(pt,"width","100%"),Ke(Lt,"width","350px"),Ke(Lt,"padding-top","5px"),ne(Lt,"class","svelte-hmrro5"),Xn(Lt,"float-right",h[4]>1),ne(c,"class","grid mtl svelte-hmrro5"),ne(sr,"id","grid"),ne(sr,"class","grid mt svelte-hmrro5"),ne(cr,"class","svelte-hmrro5"),Ke(Kr,"grid-column","span "+h[4]),ne(Ar,"id","map"),Ke(Ar,"padding-right","45px"),Ke(Ar,"grid-column","span "+(h[4]==2?2:h[4]&&h[4]>2?h[4]-1:1)),ne(Ar,"class","svelte-hmrro5"),ne(Dr,"class","grid mt svelte-hmrro5"),qu(()=>h[30].call(Dr)),ne(Ur,"class","accordion"),ne(Ur,"id","accordionPanelsStayOpenExample")},m(K,ve){Le(K,c,ve),Ee(c,d),Ee(d,f),Ee(f,_),Ee(_,v),a.m(I,f),Ee(f,T),oi.m(f,null),Ee(f,M),Ee(d,F),Ee(d,R),Ee(d,D),Ee(D,ae),Ee(d,de),Ee(d,fe),Ee(fe,we),N.m(fe,null),Ee(fe,xe),V&&V.m(fe,null),Ee(fe,Ve),Ee(fe,Oe),Ee(Oe,De),Ee(c,He),Ee(c,Tt),Ee(Tt,Lt),Ee(Lt,qt),Ee(qt,_t),Ee(Lt,ht),ar(Ft,Lt,null),Ee(Lt,yt),Ee(Lt,It),Ee(It,tt),Ee(Lt,Zt),Ee(Lt,pt),Ee(pt,zt),Ee(zt,Ut),Ee(pt,ei),Ee(pt,Je),Ee(Je,At),Ee(pt,pr),Ee(pt,Fr),Ee(Fr,Mr),Le(K,Zr,ve),Le(K,sr,ve),ar(ti,sr,null),Ee(sr,Wt),ar(Gr,sr,null),Ee(sr,mr),ar(Nr,sr,null),Le(K,jt,ve),Le(K,Dr,ve),Ee(Dr,Kr),Ee(Kr,cr),se.m(cr,null),Ee(Dr,Fi),Ee(Dr,Ar),ar(bi,Ar,null),Ee(Dr,Qi),Ee(Dr,Mi),J&&J.m(Mi,null),Ee(Dr,fi),Ee(Dr,ri),Me.m(ri,null),sn=Zu(Dr,h[30].bind(Dr)),Le(K,di,ve),Le(K,Ur,ve),ar($i,Ur,null),Ee(Ur,Ln),ar(Ni,Ur,null),Ee(Ur,zn),ar(en,Ur,null),Ee(Ur,An),ar(Ui,Ur,null),Ee(Ur,gn),ar(Vi,Ur,null),Ee(Ur,Rn),ar(tn,Ur,null),ji=!0,vn||(ln=[ha(Oe,"click",h[26]),ha(Oe,"click",h[27]),ha(Oe,"click",h[28])],vn=!0)},p(K,ve){bn===(bn=un(K))&&oi?oi.p(K,ve):(oi.d(1),oi=bn(K),oi&&(oi.c(),oi.m(f,M))),(!ji||ve[0]&1)&&H!==(H=K[0].place.name+"")&&Er(ae,H),L===(L=Pr(K))&&N?N.p(K,ve):(N.d(1),N=L(K),N&&(N.c(),N.m(fe,xe))),K[0].place.type!="ni"?V?V.p(K,ve):(V=Wm(K),V.c(),V.m(fe,Ve)):V&&(V.d(1),V=null),(!ji||ve[0]&268)&&Xn(Oe,"btn-active",K[2]&!K[3]&!K[8]);const et={};ve[0]&1&&(et.search_data=K[0].search_data),Ft.$set(et),(!ji||ve[0]&16)&&Xn(Lt,"float-right",K[4]>1);const Ye={};ve[0]&1&&(Ye.place=K[0].place),ve[0]&1&&(Ye.content={ni:"The population of "+K[0].place.name+" was "+K[0].place.data.population.value[2021].all.toLocaleString()+" at the time of the 2021 Census. "+K[16](K[0].place.data.population.value.change.all),lgd:"The population of "+K[0].place.name+" was "+K[0].place.data.population.value[2021].all.toLocaleString()+" at the time of the 2021 Census, which made it the "+K[15](K[0].place.data.population.value_rank[2021].all)+" Local Government District. "+K[16](K[0].place.data.population.value.change.all),dea:"The population of "+K[0].place.name+" was "+K[0].place.data.population.value[2021].all.toLocaleString()+" at the time of the 2021 Census, which made it the "+K[15](K[0].place.data.population.value_rank[2021].all)+" District Electoral Area."}),ve[0]&512&&(Ye.chart_compare_type=K[9]),ti.$set(Ye);const Se={};ve[0]&1&&(Se.place=K[0].place),ve[0]&1&&(Se.content='<span class="text-big" style="font-size: 2.8em;">'+K[0].place.data.population.value[2021].all.toLocaleString()+"</span>"),ve[0]&512&&(Se.chart_compare_type=K[9]),ve[0]&1&&(Se.compare_content={ni:{prev:'<span class="em '+Pa(K[0].place.data.population.value.change.all)+'">'+Ca(K[0].place.data.population.value.change.all,"%",1)+"</span> since 2011 Census"},lgd:{prev:'<span class="em '+Pa(K[0].place.data.population.value.change.all)+'">'+Ca(K[0].place.data.population.value.change.all,"%",1)+"</span> since 2011 Census",ni:'<span class = "em" style = "background-color: lightgrey">'+ns(K[0].place.data.population.value[2021].all/K[0].ni.data.population.value[2021].all)+"</span> of Northern Ireland population<br>The "+K[15](K[0].place.data.population.value_rank[2021].all)+" population of 11 Local Government Districts"},dea:{prev:'<span class="em '+Pa(K[0].place.data.population.value.change.all)+'">'+Ca(K[0].place.data.population.value.change.all,"%",1)+"</span> since 2011 Census",ni:'<span class = "em" style = "background-color: lightgrey">'+ns(K[0].place.data.population.value[2021].all/K[0].ni.data.population.value[2021].all)+"</span> of Northern Ireland population"}}),Gr.$set(Se);const We={};ve[0]&1&&(We.place=K[0].place),ve[0]&1&&(We.content='<span class="text-big" style="font-size: 2.8em;">'+K[0].place.data.households.value[2021].all_households.toLocaleString()+"</span>"),ve[0]&512&&(We.chart_compare_type=K[9]),ve[0]&1&&(We.compare_content={ni:{prev:'<span class="em '+Pa(K[0].place.data.households.value.change.all_households)+'">'+Ca(K[0].place.data.households.value.change.all_households,"%",1)+"</span> since 2011 Census"},lgd:{prev:'<span class="em '+Pa(K[0].place.data.households.value.change.all_households)+'">'+Ca(K[0].place.data.households.value.change.all_households,"%",1)+"</span> since 2011 Census",ni:'<span class = "em" style = "background-color: lightgrey">'+ns(K[0].place.data.households.value[2021].all_households/K[0].ni.data.households.value[2021].all_households)+"</span> of Northern Ireland households"},dea:{prev:'<span class="em '+Pa(K[0].place.data.households.value.change.all_households)+'">'+Ca(K[0].place.data.households.value.change.all_households,"%",1)+"</span> since 2011 Census",ni:'<span class = "em" style = "background-color: lightgrey">'+ns(K[0].place.data.households.value[2021].all_households/K[0].ni.data.households.value[2021].all_households)+"</span> of Northern Ireland households"}}),Nr.$set(We),$===($=W(K))&&se?se.p(K,ve):(se.d(1),se=$(K),se&&(se.c(),se.m(cr,null))),(!ji||ve[0]&16)&&Ke(Kr,"grid-column","span "+K[4]);const Fe={};ve[0]&1&&(Fe.location={bounds:K[0].place.bounds}),ve[0]&192|ve[1]&8192&&(Fe.$$scope={dirty:ve,ctx:K}),!pi&&ve[0]&32&&(pi=!0,Fe.map=K[5],og(()=>pi=!1)),bi.$set(Fe),(!ji||ve[0]&16)&&Ke(Ar,"grid-column","span "+(K[4]==2?2:K[4]&&K[4]>2?K[4]-1:1)),K[0].place.type!="ni"?J?J.p(K,ve):(J=Jm(K),J.c(),J.m(Mi,null)):J&&(J.d(1),J=null),Ce===(Ce=_e(K))&&Me?Me.p(K,ve):(Me.d(1),Me=Ce(K),Me&&(Me.c(),Me.m(ri,null)));const qe={};ve[0]&1&&(qe.place=K[0].place),ve[0]&512&&(qe.chart_compare_type=K[9]),ve[0]&1025&&(qe.boxes={box_1:{id:"popchange",content:"<span > population growth/shrink to be added</span>"},box_2:{id:"age",content:"GroupChart",chart_data:{none:K[12](K[0].place.grouped_data_nocompare.age,"age"),prev:K[12](K[0].place.grouped_data_timecompare.age,"age"),ni:K[12](K[0].place.grouped_data_areacompare.age,"age")},zKey:"group",label:K[10],topic_prev_available:"true"},box_3:{id:"sex",content:"<span > sex split to be added</span>"},box_4:{id:"hhsize",content:"GroupChart",chart_data:{none:K[12](K[0].place.grouped_data_nocompare.hh_size,"hh_size"),prev:K[12](K[0].place.grouped_data_timecompare.hh_size,"hh_size"),ni:K[12](K[0].place.grouped_data_areacompare.hh_size,"hh_size")},zKey:"group",label:K[10],topic_prev_available:"true"},box_5:{id:"religion",content:"GroupChart",chart_data:{none:K[12](K[0].place.grouped_data_nocompare.religion_or_religion_brought_up_in,"religion_or_religion_brought_up_in"),prev:K[12](K[0].place.grouped_data_timecompare.religion_or_religion_brought_up_in,"religion_or_religion_brought_up_in"),ni:K[12](K[0].place.grouped_data_areacompare.religion_or_religion_brought_up_in,"religion_or_religion_brought_up_in")},zKey:"group",label:K[10],topic_prev_available:"true"},box_6:{id:"language",content:"GroupChart",chart_data:{none:K[12](K[0].place.grouped_data_nocompare.mainlang,"mainlang"),prev:K[12](K[0].place.grouped_data_timecompare.mainlang,"mainlang"),ni:K[12](K[0].place.grouped_data_areacompare.mainlang,"mainlang")},zKey:"group",label:K[10],topic_prev_available:"true"}}),$i.$set(qe);const Mt={};ve[0]&1&&(Mt.place=K[0].place),ve[0]&512&&(Mt.chart_compare_type=K[9]),ve[0]&1537&&(Mt.boxes={box_1:{id:"generalhealth",content:"StackedBarChart",chart_data:K[0].place&&K[11](["general_health"],["2011"],["2021"]),zKey:K[9],label:K[10],topic_prev_available:"true"},box_2:{id:"wellbeing",content:"<p><span class='text-big' style='font-size: 2.8em'>7.5</span> / 10 </p>"},box_3:{id:"lifeexpectancy",content:"<p>Males <span class='text-big' style='font-size: 1.8em'>78.6 years</span></p><p>Female <span class='text-big' style='font-size: 1.8em'>82.7 years</span></p>"},box_4:{id:"carers",content:"GroupChart",chart_data:{none:K[12](K[0].place.grouped_data_nocompare.provision_care,"provision_care"),prev:K[12](K[0].place.grouped_data_timecompare.provision_care,"provision_care"),ni:K[12](K[0].place.grouped_data_areacompare.provision_care,"provision_care")},zKey:"group",label:K[10],topic_prev_available:"true"},box_5:{id:"hospitalactivity",content:"<span > hospital activity to be added</span>"},box_6:{id:"primarycare",content:"<span > primary care to be added</span>"}}),Ni.$set(Mt);const Ze={};ve[0]&1&&(Ze.place=K[0].place),ve[0]&512&&(Ze.chart_compare_type=K[9]),en.$set(Ze);const Vt={};ve[0]&1&&(Vt.place=K[0].place),ve[0]&512&&(Vt.chart_compare_type=K[9]),ve[0]&1025&&(Vt.boxes={box_1:{id:"enrollments",content:"<p>Primary school <span class='text-big' style='font-size: 1.2em'>500 </span></p><p>Secondary school <span class='text-big' style='font-size: 1.2em'>320 </span></p><p>Further education colleges <span class='text-big' style='font-size: 1.2em'>45 </span></p><p>University <span class='text-big' style='font-size: 1.2em'>200 </span></p>"},box_2:{id:"fsme",content:"<p>Primary school <span class='text-big' style='font-size: 1.8em'>33.2%</span></p><p>Secondary school <span class='text-big' style='font-size: 1.8em'>25.2%</span></p>"},box_3:{id:"teachers",content:"<span > teachers to be added</span>"},box_4:{id:"qualifications",content:"GroupChart",chart_data:{none:K[12](K[0].place.grouped_data_nocompare.highest_level_of_qualifications,"highest_level_of_qualifications"),prev:K[12](K[0].place.grouped_data_timecompare.highest_level_of_qualifications,"highest_level_of_qualifications"),ni:K[12](K[0].place.grouped_data_areacompare.highest_level_of_qualifications,"highest_level_of_qualifications")},zKey:"group",label:K[10],topic_prev_available:"true"},box_5:{id:"attainment",content:"<span > attainment to be added</span>"}}),Ui.$set(Vt);const lr={};ve[0]&1&&(lr.place=K[0].place),ve[0]&512&&(lr.chart_compare_type=K[9]),Vi.$set(lr);const Pt={};ve[0]&1&&(Pt.place=K[0].place),ve[0]&512&&(Pt.chart_compare_type=K[9]),tn.$set(Pt)},i(K){ji||(it(Ft.$$.fragment,K),it(ti.$$.fragment,K),it(Gr.$$.fragment,K),it(Nr.$$.fragment,K),it(bi.$$.fragment,K),it($i.$$.fragment,K),it(Ni.$$.fragment,K),it(en.$$.fragment,K),it(Ui.$$.fragment,K),it(Vi.$$.fragment,K),it(tn.$$.fragment,K),ji=!0)},o(K){lt(Ft.$$.fragment,K),lt(ti.$$.fragment,K),lt(Gr.$$.fragment,K),lt(Nr.$$.fragment,K),lt(bi.$$.fragment,K),lt($i.$$.fragment,K),lt(Ni.$$.fragment,K),lt(en.$$.fragment,K),lt(Ui.$$.fragment,K),lt(Vi.$$.fragment,K),lt(tn.$$.fragment,K),ji=!1},d(K){K&&oe(c),oi.d(),N.d(),V&&V.d(),or(Ft),K&&oe(Zr),K&&oe(sr),or(ti),or(Gr),or(Nr),K&&oe(jt),K&&oe(Dr),se.d(),or(bi),J&&J.d(),Me.d(),sn(),K&&oe(di),K&&oe(Ur),or($i),or(Ni),or(en),or(Ui),or(Vi),or(tn),vn=!1,Ku(ln)}}}function R1(h){let c=h[0].place.name+"",d;return{c(){d=St(c)},l(f){d=Et(f,c)},m(f,_){Le(f,d,_)},p(f,_){_[0]&1&&c!==(c=f[0].place.name+"")&&Er(d,c)},d(f){f&&oe(d)}}}function B1(h){let c,d=h[0].place.name+"",f,_=[...h[0].place.parents].reverse(),v=[];for(let a=0;a<_.length;a+=1)v[a]=Xm(Gm(h,_,a));return{c(){for(let a=0;a<v.length;a+=1)v[a].c();c=ft(),f=St(d)},l(a){for(let I=0;I<v.length;I+=1)v[I].l(a);c=dt(a),f=Et(a,d)},m(a,I){for(let T=0;T<v.length;T+=1)v[T]&&v[T].m(a,I);Le(a,c,I),Le(a,f,I)},p(a,I){if(I[0]&1){_=[...a[0].place.parents].reverse();let T;for(T=0;T<_.length;T+=1){const M=Gm(a,_,T);v[T]?v[T].p(M,I):(v[T]=Xm(M),v[T].c(),v[T].m(c.parentNode,c))}for(;T<v.length;T+=1)v[T].d(1);v.length=_.length}I[0]&1&&d!==(d=a[0].place.name+"")&&Er(f,d)},d(a){on(v,a),a&&oe(c),a&&oe(f)}}}function Xm(h){let c,d=h[38].name+"",f,_,v,a=" &gt; ",I;return{c(){c=Ne("a"),f=St(d),v=new Xu(!1),I=br(),this.h()},l(T){c=Ue(T,"A",{href:!0,"sveltekit:noscroll":!0,class:!0});var M=Be(c);f=Et(M,d),M.forEach(oe),v=Wu(T,!1),I=br(),this.h()},h(){ne(c,"href",_=Ma+"/"+h[38].code+"/"),ne(c,"sveltekit:noscroll",""),ne(c,"class","svelte-hmrro5"),v.a=I},m(T,M){Le(T,c,M),Ee(c,f),v.m(a,T,M),Le(T,I,M)},p(T,M){M[0]&1&&d!==(d=T[38].name+"")&&Er(f,d),M[0]&1&&_!==(_=Ma+"/"+T[38].code+"/")&&ne(c,"href",_)},d(T){T&&oe(c),T&&oe(I),T&&v.d()}}}function O1(h){let c,d,f,_;return{c(){c=Ne("button"),d=St("No comparison"),this.h()},l(v){c=Ue(v,"BUTTON",{class:!0});var a=Be(c);d=Et(a,"No comparison"),a.forEach(oe),this.h()},h(){ne(c,"class","btn svelte-hmrro5"),Xn(c,"btn-active",h[3])},m(v,a){Le(v,c,a),Ee(c,d),f||(_=[ha(c,"click",h[20]),ha(c,"click",h[21]),ha(c,"click",h[22])],f=!0)},p(v,a){a[0]&8&&Xn(c,"btn-active",v[3])},d(v){v&&oe(c),f=!1,Ku(_)}}}function F1(h){let c,d,f,_;return{c(){c=Ne("button"),d=St("No comparison"),this.h()},l(v){c=Ue(v,"BUTTON",{class:!0});var a=Be(c);d=Et(a,"No comparison"),a.forEach(oe),this.h()},h(){ne(c,"class","btn svelte-hmrro5"),Xn(c,"btn-active",!h[2])},m(v,a){Le(v,c,a),Ee(c,d),f||(_=[ha(c,"click",h[17]),ha(c,"click",h[18]),ha(c,"click",h[19])],f=!0)},p(v,a){a[0]&4&&Xn(c,"btn-active",!v[2])},d(v){v&&oe(c),f=!1,Ku(_)}}}function Wm(h){let c,d,f,_;return{c(){c=Ne("button"),d=St("NI compare"),this.h()},l(v){c=Ue(v,"BUTTON",{class:!0});var a=Be(c);d=Et(a,"NI compare"),a.forEach(oe),this.h()},h(){ne(c,"class","btn svelte-hmrro5"),Xn(c,"btn-active",h[8]&!h[3]&!h[2])},m(v,a){Le(v,c,a),Ee(c,d),f||(_=[ha(c,"click",h[23]),ha(c,"click",h[24]),ha(c,"click",h[25])],f=!0)},p(v,a){a[0]&268&&Xn(c,"btn-active",v[8]&!v[3]&!v[2])},d(v){v&&oe(c),f=!1,Ku(_)}}}function N1(h){let c,d,f=h[0].place.name+"",_;return{c(){c=St("Explore "),d=Ne("span"),_=St(f),this.h()},l(v){c=Et(v,"Explore "),d=Ue(v,"SPAN",{style:!0});var a=Be(d);_=Et(a,f),a.forEach(oe),this.h()},h(){Ke(d,"color","#3878c5")},m(v,a){Le(v,c,a),Le(v,d,a),Ee(d,_)},p(v,a){a[0]&1&&f!==(f=v[0].place.name+"")&&Er(_,f)},d(v){v&&oe(c),v&&oe(d)}}}function U1(h){let c,d,f=h[0].place.name+"",_,v,a,I=Ua[h[0].place.type].name+"",T;return{c(){c=St(`Explore \r
					`),d=Ne("span"),_=St(f),v=ft(),a=Ne("span"),T=St(I),this.h()},l(M){c=Et(M,`Explore \r
					`),d=Ue(M,"SPAN",{style:!0});var F=Be(d);_=Et(F,f),F.forEach(oe),v=dt(M),a=Ue(M,"SPAN",{style:!0});var R=Be(a);T=Et(R,I),R.forEach(oe),this.h()},h(){Ke(d,"color","#3878c5"),Ke(a,"color","#00205b")},m(M,F){Le(M,c,F),Le(M,d,F),Ee(d,_),Le(M,v,F),Le(M,a,F),Ee(a,T)},p(M,F){F[0]&1&&f!==(f=M[0].place.name+"")&&Er(_,f),F[0]&1&&I!==(I=Ua[M[0].place.type].name+"")&&Er(T,I)},d(M){M&&oe(c),M&&oe(d),M&&oe(v),M&&oe(a)}}}function V1(h){let c,d,f,_,v,a,I;const T=[as[h[40]],{id:h[40]+"-fill"},{type:"fill"},{isChild:h[7][h[40]]},{click:!0},{selected:h[6].selected},{highlight:!0},{highlighted:h[6].highlighted},{hover:!0},{hovered:h[6].hovered},{layout:{visibility:h[6].type==h[40]||h[6].childType==h[40]?"visible":"none"}},{paint:h[6].type==h[40]?Yi["fill-self"]:h[6].childType==h[40]?Yi["fill-child"]:Yi.fill}];let M={};for(let ae=0;ae<T.length;ae+=1)M=_h(M,T[ae]);c=new Pp({props:M}),c.$on("select",h[13]);const F=[as[h[40]],{id:h[40]+"-bounds"},{type:"line"},{selected:h[6].selected},{highlight:!0},{highlighted:h[6].highlighted},{layout:{visibility:h[6].type==h[40]||h[6].childType==h[40]?"visible":"none"}},{paint:h[6].type==h[40]?Yi["line-active"]:h[6].childType==h[40]?Yi["line-child"]:Yi.line}];let R={};for(let ae=0;ae<F.length;ae+=1)R=_h(R,F[ae]);f=new Pp({props:R});const D=[as[h[40]],{id:h[40]+"-self"},{type:"line"},{selected:h[6].selected},{layout:{visibility:h[6].type==h[40]?"visible":"none"}},{paint:h[6].type==h[40]?Yi["line-self"]:Yi.line}];let H={};for(let ae=0;ae<D.length;ae+=1)H=_h(H,D[ae]);return v=new Pp({props:H}),{c(){ir(c.$$.fragment),d=ft(),ir(f.$$.fragment),_=ft(),ir(v.$$.fragment),a=ft()},l(ae){nr(c.$$.fragment,ae),d=dt(ae),nr(f.$$.fragment,ae),_=dt(ae),nr(v.$$.fragment,ae),a=dt(ae)},m(ae,de){ar(c,ae,de),Le(ae,d,de),ar(f,ae,de),Le(ae,_,de),ar(v,ae,de),Le(ae,a,de),I=!0},p(ae,de){const fe=de[0]&192?gh(T,[de&0&&vh(as[ae[40]]),T[1],T[2],de[0]&128&&{isChild:ae[7][ae[40]]},T[4],de[0]&64&&{selected:ae[6].selected},T[6],de[0]&64&&{highlighted:ae[6].highlighted},T[8],de[0]&64&&{hovered:ae[6].hovered},de[0]&64&&{layout:{visibility:ae[6].type==ae[40]||ae[6].childType==ae[40]?"visible":"none"}},de[0]&64&&{paint:ae[6].type==ae[40]?Yi["fill-self"]:ae[6].childType==ae[40]?Yi["fill-child"]:Yi.fill}]):{};c.$set(fe);const we=de[0]&64?gh(F,[de&0&&vh(as[ae[40]]),F[1],F[2],de[0]&64&&{selected:ae[6].selected},F[4],de[0]&64&&{highlighted:ae[6].highlighted},de[0]&64&&{layout:{visibility:ae[6].type==ae[40]||ae[6].childType==ae[40]?"visible":"none"}},de[0]&64&&{paint:ae[6].type==ae[40]?Yi["line-active"]:ae[6].childType==ae[40]?Yi["line-child"]:Yi.line}]):{};f.$set(we);const xe=de[0]&64?gh(D,[de&0&&vh(as[ae[40]]),D[1],D[2],de[0]&64&&{selected:ae[6].selected},de[0]&64&&{layout:{visibility:ae[6].type==ae[40]?"visible":"none"}},de[0]&64&&{paint:ae[6].type==ae[40]?Yi["line-self"]:Yi.line}]):{};v.$set(xe)},i(ae){I||(it(c.$$.fragment,ae),it(f.$$.fragment,ae),it(v.$$.fragment,ae),I=!0)},o(ae){lt(c.$$.fragment,ae),lt(f.$$.fragment,ae),lt(v.$$.fragment,ae),I=!1},d(ae){or(c,ae),ae&&oe(d),or(f,ae),ae&&oe(_),or(v,ae),ae&&oe(a)}}}function Hm(h){let c,d;const f=[bd[h[40]]];let _={$$slots:{default:[V1]},$$scope:{ctx:h}};for(let v=0;v<f.length;v+=1)_=_h(_,f[v]);return c=new Gg({props:_}),{c(){ir(c.$$.fragment)},l(v){nr(c.$$.fragment,v)},m(v,a){ar(c,v,a),d=!0},p(v,a){const I=a&0?gh(f,[vh(bd[v[40]])]):{};a[0]&192|a[1]&8192&&(I.$$scope={dirty:a,ctx:v}),c.$set(I)},i(v){d||(it(c.$$.fragment,v),d=!0)},o(v){lt(c.$$.fragment,v),d=!1},d(v){or(c,v)}}}function j1(h){let c,d,f=["dz","sdz","ward","dea","lgd"],_=[];for(let a=0;a<5;a+=1)_[a]=Hm(Zm(h,f,a));const v=a=>lt(_[a],1,1,()=>{_[a]=null});return{c(){for(let a=0;a<5;a+=1)_[a].c();c=br()},l(a){for(let I=0;I<5;I+=1)_[I].l(a);c=br()},m(a,I){for(let T=0;T<5;T+=1)_[T]&&_[T].m(a,I);Le(a,c,I),d=!0},p(a,I){if(I[0]&8384){f=["dz","sdz","ward","dea","lgd"];let T;for(T=0;T<5;T+=1){const M=Zm(a,f,T);_[T]?(_[T].p(M,I),it(_[T],1)):(_[T]=Hm(M),_[T].c(),it(_[T],1),_[T].m(c.parentNode,c))}for(ta(),T=5;T<5;T+=1)v(T);ra()}},i(a){if(!d){for(let I=0;I<5;I+=1)it(_[I]);d=!0}},o(a){_=_.filter(Boolean);for(let I=0;I<5;I+=1)lt(_[I]);d=!1},d(a){on(_,a),a&&oe(c)}}}function Jm(h){let c,d,f=h[0].place.name+"",_,v,a,I=[...h[0].place.parents].reverse(),T=[];for(let M=0;M<I.length;M+=1)T[M]=Ym(qm(h,I,M));return{c(){c=Ne("span"),d=St("Parents of "),_=St(f),v=ft(),a=Ne("span");for(let M=0;M<T.length;M+=1)T[M].c();this.h()},l(M){c=Ue(M,"SPAN",{class:!0});var F=Be(c);d=Et(F,"Parents of "),_=Et(F,f),F.forEach(oe),v=dt(M),a=Ue(M,"SPAN",{class:!0});var R=Be(a);for(let D=0;D<T.length;D+=1)T[D].l(R);R.forEach(oe),this.h()},h(){ne(c,"class","text-bold"),ne(a,"class","text-small")},m(M,F){Le(M,c,F),Ee(c,d),Ee(c,_),Le(M,v,F),Le(M,a,F);for(let R=0;R<T.length;R+=1)T[R]&&T[R].m(a,null)},p(M,F){if(F[0]&1&&f!==(f=M[0].place.name+"")&&Er(_,f),F[0]&1){I=[...M[0].place.parents].reverse();let R;for(R=0;R<I.length;R+=1){const D=qm(M,I,R);T[R]?T[R].p(D,F):(T[R]=Ym(D),T[R].c(),T[R].m(a,null))}for(;R<T.length;R+=1)T[R].d(1);T.length=I.length}},d(M){M&&oe(c),M&&oe(v),M&&oe(a),on(T,M)}}}function Ym(h){let c,d,f=h[37]>0?" ":"",_,v=h[38].name+"",a,I;return{c(){c=Ne("span"),d=new Xu(!1),_=Ne("a"),a=St(v),this.h()},l(T){c=Ue(T,"SPAN",{style:!0});var M=Be(c);d=Wu(M,!1),_=Ue(M,"A",{href:!0,"sveltekit:noscroll":!0,class:!0});var F=Be(_);a=Et(F,v),F.forEach(oe),M.forEach(oe),this.h()},h(){d.a=_,ne(_,"href",I=Ma+"/"+h[38].code),ne(_,"sveltekit:noscroll",""),ne(_,"class","svelte-hmrro5"),Ke(c,"display","block"),Ke(c,"margin-left",(h[37]>0?(h[37]-1)*15:0)+"px")},m(T,M){Le(T,c,M),d.m(f,c),Ee(c,_),Ee(_,a)},p(T,M){M[0]&1&&v!==(v=T[38].name+"")&&Er(a,v),M[0]&1&&I!==(I=Ma+"/"+T[38].code)&&ne(_,"href",I)},d(T){T&&oe(c)}}}function q1(h){let c,d,f=h[0].place.name+"",_,v,a=Ua[h[0].place.type].name+"",I;return{c(){c=Ne("span"),d=St("No areas below "),_=St(f),v=ft(),I=St(a),this.h()},l(T){c=Ue(T,"SPAN",{class:!0});var M=Be(c);d=Et(M,"No areas below "),_=Et(M,f),v=dt(M),I=Et(M,a),M.forEach(oe),this.h()},h(){ne(c,"class","muted")},m(T,M){Le(T,c,M),Ee(c,d),Ee(c,_),Ee(c,v),Ee(c,I)},p(T,M){M[0]&1&&f!==(f=T[0].place.name+"")&&Er(_,f),M[0]&1&&a!==(a=Ua[T[0].place.type].name+"")&&Er(I,a)},d(T){T&&oe(c)}}}function Z1(h){let c,d=(h[0].place.children[0]?Ua[h[0].place.children[0].type].pl:"Areas")+"",f,_,v=h[0].place.name+"",a,I,T,M,F=h[0].place.children,R=[];for(let D=0;D<F.length;D+=1)R[D]=Qm(jm(h,F,D));return{c(){c=Ne("span"),f=St(d),_=St(" within "),a=St(v),I=Ne("br"),T=ft(),M=Ne("span");for(let D=0;D<R.length;D+=1)R[D].c();this.h()},l(D){c=Ue(D,"SPAN",{class:!0});var H=Be(c);f=Et(H,d),_=Et(H," within "),a=Et(H,v),H.forEach(oe),I=Ue(D,"BR",{}),T=dt(D),M=Ue(D,"SPAN",{class:!0});var ae=Be(M);for(let de=0;de<R.length;de+=1)R[de].l(ae);ae.forEach(oe),this.h()},h(){ne(c,"class","text-bold"),ne(M,"class","text-small")},m(D,H){Le(D,c,H),Ee(c,f),Ee(c,_),Ee(c,a),Le(D,I,H),Le(D,T,H),Le(D,M,H);for(let ae=0;ae<R.length;ae+=1)R[ae]&&R[ae].m(M,null)},p(D,H){if(H[0]&1&&d!==(d=(D[0].place.children[0]?Ua[D[0].place.children[0].type].pl:"Areas")+"")&&Er(f,d),H[0]&1&&v!==(v=D[0].place.name+"")&&Er(a,v),H[0]&1){F=D[0].place.children;let ae;for(ae=0;ae<F.length;ae+=1){const de=jm(D,F,ae);R[ae]?R[ae].p(de,H):(R[ae]=Qm(de),R[ae].c(),R[ae].m(M,null))}for(;ae<R.length;ae+=1)R[ae].d(1);R.length=F.length}},d(D){D&&oe(c),D&&oe(I),D&&oe(T),D&&oe(M),on(R,D)}}}function Qm(h){let c,d=h[35].name+"",f,_,v=h[37]<h[0].place.children.length-1?", ":"",a;return{c(){c=Ne("a"),f=St(d),a=St(v),this.h()},l(I){c=Ue(I,"A",{href:!0,"sveltekit:noscroll":!0,class:!0});var T=Be(c);f=Et(T,d),T.forEach(oe),a=Et(I,v),this.h()},h(){ne(c,"href",_=Ma+"/"+h[35].code),ne(c,"sveltekit:noscroll",""),ne(c,"class","svelte-hmrro5")},m(I,T){Le(I,c,T),Ee(c,f),Le(I,a,T)},p(I,T){T[0]&1&&d!==(d=I[35].name+"")&&Er(f,d),T[0]&1&&_!==(_=Ma+"/"+I[35].code)&&ne(c,"href",_),T[0]&1&&v!==(v=I[37]<I[0].place.children.length-1?", ":"")&&Er(a,v)},d(I){I&&oe(c),I&&oe(a)}}}function G1(h){let c,d,f=h[0].place&&h[0].ni&&Km(h);return{c(){f&&f.c(),c=br()},l(_){f&&f.l(_),c=br()},m(_,v){f&&f.m(_,v),Le(_,c,v),d=!0},p(_,v){_[0].place&&_[0].ni?f?(f.p(_,v),v[0]&1&&it(f,1)):(f=Km(_),f.c(),it(f,1),f.m(c.parentNode,c)):f&&(ta(),lt(f,1,1,()=>{f=null}),ra())},i(_){d||(it(f),d=!0)},o(_){lt(f),d=!1},d(_){f&&f.d(_),_&&oe(c)}}}function K1(h){let c,d,f,_,v,a,I,T,M,F,R,D,H,ae,de,fe;return document.title=c=h[0].place.name+" NISRA Key Statistics",H=new Q0({}),de=new sg({props:{column:"wide",$$slots:{default:[G1]},$$scope:{ctx:h}}}),{c(){d=Ne("meta"),f=Ne("meta"),v=Ne("meta"),a=Ne("meta"),T=Ne("meta"),F=Ne("meta"),D=ft(),ir(H.$$.fragment),ae=ft(),ir(de.$$.fragment),this.h()},l(we){const xe=ng("svelte-12i6502",document.head);d=Ue(xe,"META",{name:!0,content:!0}),f=Ue(xe,"META",{property:!0,content:!0}),v=Ue(xe,"META",{property:!0,content:!0}),a=Ue(xe,"META",{property:!0,content:!0}),T=Ue(xe,"META",{property:!0,content:!0}),F=Ue(xe,"META",{name:!0,content:!0}),xe.forEach(oe),D=dt(we),nr(H.$$.fragment,we),ae=dt(we),nr(de.$$.fragment,we),this.h()},h(){ne(d,"name","description"),ne(d,"content",""),ne(f,"property","og:title"),ne(f,"content",_=h[0].place.name+" Census Data"),ne(v,"property","og:type"),ne(v,"content","website"),ne(a,"property","og:url"),ne(a,"content",I=Sh.base+"/"+h[0].place.code+"/"),ne(T,"property","og:description"),ne(T,"content",M="Explore NISRA Statistics for "+h[0].place.name+"."),ne(F,"name","description"),ne(F,"content",R="Explore NISRA Statistics for "+h[0].place.name+".")},m(we,xe){Ee(document.head,d),Ee(document.head,f),Ee(document.head,v),Ee(document.head,a),Ee(document.head,T),Ee(document.head,F),Le(we,D,xe),ar(H,we,xe),Le(we,ae,xe),ar(de,we,xe),fe=!0},p(we,xe){(!fe||xe[0]&1)&&c!==(c=we[0].place.name+" NISRA Key Statistics")&&(document.title=c),(!fe||xe[0]&1&&_!==(_=we[0].place.name+" Census Data"))&&ne(f,"content",_),(!fe||xe[0]&1&&I!==(I=Sh.base+"/"+we[0].place.code+"/"))&&ne(a,"content",I),(!fe||xe[0]&1&&M!==(M="Explore NISRA Statistics for "+we[0].place.name+"."))&&ne(T,"content",M),(!fe||xe[0]&1&&R!==(R="Explore NISRA Statistics for "+we[0].place.name+"."))&&ne(F,"content",R);const Ve={};xe[0]&2047|xe[1]&8192&&(Ve.$$scope={dirty:xe,ctx:we}),de.$set(Ve)},i(we){fe||(it(H.$$.fragment,we),it(de.$$.fragment,we),fe=!0)},o(we){lt(H.$$.fragment,we),lt(de.$$.fragment,we),fe=!1},d(we){oe(d),oe(f),oe(v),oe(a),oe(T),oe(F),we&&oe(D),or(H,we),we&&oe(ae),or(de,we)}}}function ns(h){let c=(h*100).toFixed(1);return c<.1?"<0.1%":c+"%"}function X1(h,c,d){let f,_,v,a,{data:I}=c,T,M,F=null,R=!1,D={selected:null,type:null,childType:null,highlighted:[],hovered:null},H={};Object.keys(as).forEach(At=>d(7,H[At]=!1,H));function ae(At,pr,Fr){const Mr=(cr,Fi)=>cr+Fi;let Zr=At[0],sr=Fr[0],ti=pr[0],Wt="perc",Gr=I.place.data[Zr][Wt][sr],mr=I.place.data[Zr][Wt][ti],Nr=I.ni.data[Zr][Wt][sr],jt=Ip[Zr].map(cr=>cr.category),Dr=Ip[Zr].map(cr=>cr.label?cr.label:cr.category);return jt.map((cr,Fi)=>Array.isArray(cr)?{x:Dr[Fi],y:cr.map(Ar=>Gr[Ar]).reduce(Mr,0),ni:cr.map(Ar=>Nr[Ar]).reduce(Mr,0),prev:cr.map(Ar=>mr[Ar]).reduce(Mr,0)}:{x:Dr[Fi],y:Gr[cr],ni:Nr[cr],prev:mr[cr]})}function de(At,pr){const Fr=Ip[pr];let Mr=[];return Fr.forEach(Zr=>{let ti=At.filter(Wt=>Wt.category===Zr.category).map(Wt=>({group:Wt.group,category:Zr.label,perc:Wt.perc}));Mr=[...Mr,...ti]}),Mr}function fe(At){F&&F.fitBounds(At,{padding:20})}function we(At){let pr=JSON.parse(JSON.stringify(D)),Fr=I.place.code,Mr=I.place.type,Zr=I.place.children[0]?I.place.children.map(mr=>mr.code):[],sr=I.place.type=="rgn"?"cty":Zr[0]?I.place.children[0].type:null;d(6,D.selected=Fr,D),d(6,D.type=Mr,D),d(6,D.childType=sr,D),d(6,D.highlighted=Zr,D);let ti=Object.keys(as),Wt=["fill-color","fill-opacity"],Gr=["line-color","line-width","line-opacity"];F&&(D.type!=pr.type||D.childType!=pr.childType)&&(ti.forEach(mr=>{let Nr=mr==Mr||sr&&mr==sr?"visible":"none";F.setLayoutProperty(mr+"-fill","visibility",Nr),F.setLayoutProperty(mr+"-bounds","visibility",Nr),I.place.type!="ni"&&F.setLayoutProperty(mr+"-self","visibility",Nr),d(7,H[mr]=mr==sr,H)}),I.place.type!="ni"&&(Wt.forEach(mr=>F.setPaintProperty(Mr+"-fill",mr,Yi[Zr[0]?"fill-active":"fill-self"][mr])),Gr.forEach(mr=>{F.setPaintProperty(Mr+"-bounds",mr,Yi["line-active"][mr]),F.setPaintProperty(Mr+"-self",mr,Yi["line-self"][mr])})),sr&&(Wt.forEach(mr=>F.setPaintProperty(sr+"-fill",mr,Yi["fill-child"][mr])),Gr.forEach(mr=>F.setPaintProperty(sr+"-bounds",mr,Yi["line-child"][mr]))))}function xe(At){we(),fe(I.place.bounds)}function Ve(At){vd(`${Ma}/${At.detail.code}/`,{noscroll:!0})}function Oe(At){vd(`${Ma}/${At.detail.value}/`,{noscroll:!0})}function De(){d(4,M=T<575?1:window.getComputedStyle(grid).getPropertyValue("grid-template-columns").split(" ").length)}function He(At){return At==1?"largest":At==I.place.count?"smallest":At+eg(At)+" largest"}function Tt(At){if(I.place.type!="dea"){let pr=At.toFixed(1);return pr>0?"An increase of "+pr+"% since the 2011 Census.":pr<0?"A decrease of "+pr+"% since the 2011 Census.":"No change since the 2011 Census."}}const Lt=()=>d(3,a=!0),qt=()=>d(2,R=!1),_t=()=>d(8,v=!1),ht=()=>d(3,a=!0),Ft=()=>d(2,R=!1),yt=()=>d(8,v=!1),It=()=>d(8,v=!0),tt=()=>d(3,a=!1),Zt=()=>d(2,R=!1),pt=()=>d(2,R=!0),zt=()=>d(3,a=!1),Ut=()=>d(8,v=!1);function ei(At){F=At,d(5,F)}function Je(){T=this.clientWidth,d(1,T)}return h.$$set=At=>{"data"in At&&d(0,I=At.data)},h.$$.update=()=>{h.$$.dirty[0]&2&&T&&De(),h.$$.dirty[0]&5&&d(10,f=R?"Same area 2011":I.place&&I.place.type!="ni"?"NI 2021":null),h.$$.dirty[0]&13&&d(9,_=a?null:R?"prev":!R&&I.place.type!="ni"?"ni":null),h.$$.dirty[0]&1&&I.place&&xe(I.place)},d(3,a=!0),d(8,v=!1),[I,T,R,a,M,F,D,H,v,_,f,ae,de,Ve,Oe,He,Tt,Lt,qt,_t,ht,Ft,yt,It,tt,Zt,pt,zt,Ut,ei,Je]}class rb extends mn{constructor(c){super(),yn(this,c,X1,K1,_n,{data:0},null,[-1,-1])}}export{rb as component,tb as universal};
