import{g as a_,c as gd,a as _d,s as o_,S as s_,b as es,d as ts}from"../chunks/navigation.bfc1e68d.js";import{g as Zn,a as Sh,m as is,b as zp,c as l_,d as $i,e as vd}from"../chunks/config.1f593336.js";import{S as fn,i as dn,s as mn,k as qe,l as je,m as Ne,h as ae,n as oe,R as Gu,b as Be,T as Ku,g as Qe,v as En,d as ot,f as zn,P as ay,o as oy,K as Ou,M as Fu,N as Nu,O as Uu,w as Vu,e as sr,E as Hu,U as u_,Q as Kt,V as zr,p as Xe,W as Gn,X as Kn,C as Ie,D as li,Y as on,Z as ns,q as Vt,r as qt,u as Rr,y as ir,z as nr,A as ar,B as or,a as xt,c as wt,_ as Ah,G as bd,I as c_,$ as Bl,a0 as Ol,F as xd,L as h_,a1 as p_,a2 as f_,a3 as gh,a4 as _h,a5 as vh}from"../chunks/index.baf6a862.js";import{b as _a}from"../chunks/paths.34f7de3d.js";import{S as d_}from"../chunks/Section.6106804d.js";/* empty css                                                              */import{w as Tr,h as Ri}from"../chunks/singletons.3e6fce25.js";async function wd(u,h){return await(await h(Sh.app_json_data+u+".json")).json()}async function m_({params:u,fetch:h}){let d=u.code,p=await a_(Sh.search_data,h),y={};p.forEach(z=>y[z.code]=z.name),p.forEach(z=>{z.typepl=Zn[z.type].pl,z.typenm=Zn[z.type].name,z.typestr=y[z.parent]&&z.parent==z.code?`View:  ${y[z.parent]}
        ${Zn[z.parent_type].name}  `:y[z.parent]&&z.parent!=z.code?`${Zn[z.type].name} `:""});let v=p.sort((z,M)=>z.name.localeCompare(M.name)),a=await wd("N92000002",h),T=await wd(d,h);return{search_data:v,place:T,ni:a}}const nb=Object.freeze(Object.defineProperty({__proto__:null,load:m_},Symbol.toStringTag,{value:"Module"}));var y_=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function g_(u){return u&&u.__esModule&&Object.prototype.hasOwnProperty.call(u,"default")?u.default:u}var __={rgb2hsl:Xu,rgb2hsv:Ph,rgb2hwb:Wu,rgb2cmyk:Yu,rgb2keyword:Ju,rgb2xyz:Up,rgb2lab:Vp,rgb2lch:v_,hsl2rgb:Ch,hsl2hsv:b_,hsl2hwb:x_,hsl2cmyk:w_,hsl2keyword:S_,hsv2rgb:Mh,hsv2hsl:k_,hsv2hwb:E_,hsv2cmyk:z_,hsv2keyword:T_,hwb2rgb:Qu,hwb2hsl:I_,hwb2hsv:A_,hwb2cmyk:P_,hwb2keyword:C_,cmyk2rgb:$u,cmyk2hsl:M_,cmyk2hsv:D_,cmyk2hwb:L_,cmyk2keyword:R_,keyword2rgb:Os,keyword2hsl:N_,keyword2hsv:U_,keyword2hwb:V_,keyword2cmyk:q_,keyword2lab:j_,keyword2xyz:Z_,xyz2rgb:sy,xyz2lab:ly,xyz2lch:B_,lab2xyz:qp,lab2rgb:uy,lab2lch:jp,lch2lab:Zp,lch2xyz:O_,lch2rgb:F_};function Xu(u){var h=u[0]/255,d=u[1]/255,p=u[2]/255,y=Math.min(h,d,p),v=Math.max(h,d,p),a=v-y,T,z,M;return v==y?T=0:h==v?T=(d-p)/a:d==v?T=2+(p-h)/a:p==v&&(T=4+(h-d)/a),T=Math.min(T*60,360),T<0&&(T+=360),M=(y+v)/2,v==y?z=0:M<=.5?z=a/(v+y):z=a/(2-v-y),[T,z*100,M*100]}function Ph(u){var h=u[0],d=u[1],p=u[2],y=Math.min(h,d,p),v=Math.max(h,d,p),a=v-y,T,z,M;return v==0?z=0:z=a/v*1e3/10,v==y?T=0:h==v?T=(d-p)/a:d==v?T=2+(p-h)/a:p==v&&(T=4+(h-d)/a),T=Math.min(T*60,360),T<0&&(T+=360),M=v/255*1e3/10,[T,z,M]}function Wu(u){var h=u[0],d=u[1],v=u[2],p=Xu(u)[0],y=1/255*Math.min(h,Math.min(d,v)),v=1-1/255*Math.max(h,Math.max(d,v));return[p,y*100,v*100]}function Yu(u){var h=u[0]/255,d=u[1]/255,p=u[2]/255,y,v,a,T;return T=Math.min(1-h,1-d,1-p),y=(1-h-T)/(1-T)||0,v=(1-d-T)/(1-T)||0,a=(1-p-T)/(1-T)||0,[y*100,v*100,a*100,T*100]}function Ju(u){return cy[JSON.stringify(u)]}function Up(u){var h=u[0]/255,d=u[1]/255,p=u[2]/255;h=h>.04045?Math.pow((h+.055)/1.055,2.4):h/12.92,d=d>.04045?Math.pow((d+.055)/1.055,2.4):d/12.92,p=p>.04045?Math.pow((p+.055)/1.055,2.4):p/12.92;var y=h*.4124+d*.3576+p*.1805,v=h*.2126+d*.7152+p*.0722,a=h*.0193+d*.1192+p*.9505;return[y*100,v*100,a*100]}function Vp(u){var h=Up(u),d=h[0],p=h[1],y=h[2],v,a,T;return d/=95.047,p/=100,y/=108.883,d=d>.008856?Math.pow(d,1/3):7.787*d+16/116,p=p>.008856?Math.pow(p,1/3):7.787*p+16/116,y=y>.008856?Math.pow(y,1/3):7.787*y+16/116,v=116*p-16,a=500*(d-p),T=200*(p-y),[v,a,T]}function v_(u){return jp(Vp(u))}function Ch(u){var h=u[0]/360,d=u[1]/100,p=u[2]/100,y,v,a,T,z;if(d==0)return z=p*255,[z,z,z];p<.5?v=p*(1+d):v=p+d-p*d,y=2*p-v,T=[0,0,0];for(var M=0;M<3;M++)a=h+1/3*-(M-1),a<0&&a++,a>1&&a--,6*a<1?z=y+(v-y)*6*a:2*a<1?z=v:3*a<2?z=y+(v-y)*(2/3-a)*6:z=y,T[M]=z*255;return T}function b_(u){var h=u[0],d=u[1]/100,p=u[2]/100,y,v;return p===0?[0,0,0]:(p*=2,d*=p<=1?p:2-p,v=(p+d)/2,y=2*d/(p+d),[h,y*100,v*100])}function x_(u){return Wu(Ch(u))}function w_(u){return Yu(Ch(u))}function S_(u){return Ju(Ch(u))}function Mh(u){var h=u[0]/60,d=u[1]/100,z=u[2]/100,p=Math.floor(h)%6,y=h-Math.floor(h),v=255*z*(1-d),a=255*z*(1-d*y),T=255*z*(1-d*(1-y)),z=255*z;switch(p){case 0:return[z,T,v];case 1:return[a,z,v];case 2:return[v,z,T];case 3:return[v,a,z];case 4:return[T,v,z];case 5:return[z,v,a]}}function k_(u){var h=u[0],d=u[1]/100,p=u[2]/100,y,v;return v=(2-d)*p,y=d*p,y/=v<=1?v:2-v,y=y||0,v/=2,[h,y*100,v*100]}function E_(u){return Wu(Mh(u))}function z_(u){return Yu(Mh(u))}function T_(u){return Ju(Mh(u))}function Qu(u){var h=u[0]/360,d=u[1]/100,p=u[2]/100,y=d+p,v,a,T,z;switch(y>1&&(d/=y,p/=y),v=Math.floor(6*h),a=1-p,T=6*h-v,v&1&&(T=1-T),z=d+T*(a-d),v){default:case 6:case 0:r=a,g=z,b=d;break;case 1:r=z,g=a,b=d;break;case 2:r=d,g=a,b=z;break;case 3:r=d,g=z,b=a;break;case 4:r=z,g=d,b=a;break;case 5:r=a,g=d,b=z;break}return[r*255,g*255,b*255]}function I_(u){return Xu(Qu(u))}function A_(u){return Ph(Qu(u))}function P_(u){return Yu(Qu(u))}function C_(u){return Ju(Qu(u))}function $u(u){var h=u[0]/100,d=u[1]/100,p=u[2]/100,y=u[3]/100,v,a,T;return v=1-Math.min(1,h*(1-y)+y),a=1-Math.min(1,d*(1-y)+y),T=1-Math.min(1,p*(1-y)+y),[v*255,a*255,T*255]}function M_(u){return Xu($u(u))}function D_(u){return Ph($u(u))}function L_(u){return Wu($u(u))}function R_(u){return Ju($u(u))}function sy(u){var h=u[0]/100,d=u[1]/100,p=u[2]/100,y,v,a;return y=h*3.2406+d*-1.5372+p*-.4986,v=h*-.9689+d*1.8758+p*.0415,a=h*.0557+d*-.204+p*1.057,y=y>.0031308?1.055*Math.pow(y,1/2.4)-.055:y=y*12.92,v=v>.0031308?1.055*Math.pow(v,1/2.4)-.055:v=v*12.92,a=a>.0031308?1.055*Math.pow(a,1/2.4)-.055:a=a*12.92,y=Math.min(Math.max(0,y),1),v=Math.min(Math.max(0,v),1),a=Math.min(Math.max(0,a),1),[y*255,v*255,a*255]}function ly(u){var h=u[0],d=u[1],p=u[2],y,v,a;return h/=95.047,d/=100,p/=108.883,h=h>.008856?Math.pow(h,1/3):7.787*h+16/116,d=d>.008856?Math.pow(d,1/3):7.787*d+16/116,p=p>.008856?Math.pow(p,1/3):7.787*p+16/116,y=116*d-16,v=500*(h-d),a=200*(d-p),[y,v,a]}function B_(u){return jp(ly(u))}function qp(u){var h=u[0],d=u[1],p=u[2],y,v,a,T;return h<=8?(v=h*100/903.3,T=7.787*(v/100)+16/116):(v=100*Math.pow((h+16)/116,3),T=Math.pow(v/100,1/3)),y=y/95.047<=.008856?y=95.047*(d/500+T-16/116)/7.787:95.047*Math.pow(d/500+T,3),a=a/108.883<=.008859?a=108.883*(T-p/200-16/116)/7.787:108.883*Math.pow(T-p/200,3),[y,v,a]}function jp(u){var h=u[0],d=u[1],p=u[2],y,v,a;return y=Math.atan2(p,d),v=y*360/2/Math.PI,v<0&&(v+=360),a=Math.sqrt(d*d+p*p),[h,a,v]}function uy(u){return sy(qp(u))}function Zp(u){var h=u[0],d=u[1],p=u[2],y,v,a;return a=p/360*2*Math.PI,y=d*Math.cos(a),v=d*Math.sin(a),[h,y,v]}function O_(u){return qp(Zp(u))}function F_(u){return uy(Zp(u))}function Os(u){return Dp[u]}function N_(u){return Xu(Os(u))}function U_(u){return Ph(Os(u))}function V_(u){return Wu(Os(u))}function q_(u){return Yu(Os(u))}function j_(u){return Vp(Os(u))}function Z_(u){return Up(Os(u))}var Dp={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,134,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,250,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,221],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[112,128,144],slategrey:[112,128,144],snow:[255,250,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,50]},cy={};for(var Sd in Dp)cy[JSON.stringify(Dp[Sd])]=Sd;var Tp=__,Dl=function(){return new ec};for(var Lu in Tp){Dl[Lu+"Raw"]=function(u){return function(h){return typeof h=="number"&&(h=Array.prototype.slice.call(arguments)),Tp[u](h)}}(Lu);var kd=/(\w+)2(\w+)/.exec(Lu),Ip=kd[1],G_=kd[2];Dl[Ip]=Dl[Ip]||{},Dl[Ip][G_]=Dl[Lu]=function(u){return function(h){typeof h=="number"&&(h=Array.prototype.slice.call(arguments));var d=Tp[u](h);if(typeof d=="string"||d===void 0)return d;for(var p=0;p<d.length;p++)d[p]=Math.round(d[p]);return d}}(Lu)}var ec=function(){this.convs={}};ec.prototype.routeSpace=function(u,h){var d=h[0];return d===void 0?this.getValues(u):(typeof d=="number"&&(d=Array.prototype.slice.call(h)),this.setValues(u,d))};ec.prototype.setValues=function(u,h){return this.space=u,this.convs={},this.convs[u]=h,this};ec.prototype.getValues=function(u){var h=this.convs[u];if(!h){var d=this.space,p=this.convs[d];h=Dl[d][u](p),this.convs[u]=h}return h};["rgb","hsl","hsv","cmyk","keyword"].forEach(function(u){ec.prototype[u]=function(h){return this.routeSpace(u,arguments)}});var hy={exports:{}};(function(u,h){(function(d,p){u.exports=p()})(y_,function(){var d,p,y;function v(a,T){if(!d)d=T;else if(!p)p=T;else{var z="var sharedChunk = {}; ("+d+")(sharedChunk); ("+p+")(sharedChunk);",M={};d(M),y=T(M),typeof window<"u"&&(y.workerUrl=window.URL.createObjectURL(new Blob([z],{type:"text/javascript"})))}}return v(["exports"],function(a){function T(e,t){return e(t={exports:{}},t.exports),t.exports}var z=M;function M(e,t,i,l){this.cx=3*e,this.bx=3*(i-e)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*t,this.by=3*(l-t)-this.cy,this.ay=1-this.cy-this.by,this.p1x=e,this.p1y=l,this.p2x=i,this.p2y=l}M.prototype.sampleCurveX=function(e){return((this.ax*e+this.bx)*e+this.cx)*e},M.prototype.sampleCurveY=function(e){return((this.ay*e+this.by)*e+this.cy)*e},M.prototype.sampleCurveDerivativeX=function(e){return(3*this.ax*e+2*this.bx)*e+this.cx},M.prototype.solveCurveX=function(e,t){var i,l,f,m,x;for(t===void 0&&(t=1e-6),f=e,x=0;x<8;x++){if(m=this.sampleCurveX(f)-e,Math.abs(m)<t)return f;var k=this.sampleCurveDerivativeX(f);if(Math.abs(k)<1e-6)break;f-=m/k}if((f=e)<(i=0))return i;if(f>(l=1))return l;for(;i<l;){if(m=this.sampleCurveX(f),Math.abs(m-e)<t)return f;e>m?i=f:l=f,f=.5*(l-i)+i}return f},M.prototype.solve=function(e,t){return this.sampleCurveY(this.solveCurveX(e,t))};var F=D;function D(e,t){this.x=e,this.y=t}D.prototype={clone:function(){return new D(this.x,this.y)},add:function(e){return this.clone()._add(e)},sub:function(e){return this.clone()._sub(e)},multByPoint:function(e){return this.clone()._multByPoint(e)},divByPoint:function(e){return this.clone()._divByPoint(e)},mult:function(e){return this.clone()._mult(e)},div:function(e){return this.clone()._div(e)},rotate:function(e){return this.clone()._rotate(e)},rotateAround:function(e,t){return this.clone()._rotateAround(e,t)},matMult:function(e){return this.clone()._matMult(e)},unit:function(){return this.clone()._unit()},perp:function(){return this.clone()._perp()},round:function(){return this.clone()._round()},mag:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals:function(e){return this.x===e.x&&this.y===e.y},dist:function(e){return Math.sqrt(this.distSqr(e))},distSqr:function(e){var t=e.x-this.x,i=e.y-this.y;return t*t+i*i},angle:function(){return Math.atan2(this.y,this.x)},angleTo:function(e){return Math.atan2(this.y-e.y,this.x-e.x)},angleWith:function(e){return this.angleWithSep(e.x,e.y)},angleWithSep:function(e,t){return Math.atan2(this.x*t-this.y*e,this.x*e+this.y*t)},_matMult:function(e){var t=e[2]*this.x+e[3]*this.y;return this.x=e[0]*this.x+e[1]*this.y,this.y=t,this},_add:function(e){return this.x+=e.x,this.y+=e.y,this},_sub:function(e){return this.x-=e.x,this.y-=e.y,this},_mult:function(e){return this.x*=e,this.y*=e,this},_div:function(e){return this.x/=e,this.y/=e,this},_multByPoint:function(e){return this.x*=e.x,this.y*=e.y,this},_divByPoint:function(e){return this.x/=e.x,this.y/=e.y,this},_unit:function(){return this._div(this.mag()),this},_perp:function(){var e=this.y;return this.y=this.x,this.x=-e,this},_rotate:function(e){var t=Math.cos(e),i=Math.sin(e),l=i*this.x+t*this.y;return this.x=t*this.x-i*this.y,this.y=l,this},_rotateAround:function(e,t){var i=Math.cos(e),l=Math.sin(e),f=t.y+l*(this.x-t.x)+i*(this.y-t.y);return this.x=t.x+i*(this.x-t.x)-l*(this.y-t.y),this.y=f,this},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}},D.convert=function(e){return e instanceof D?e:Array.isArray(e)?new D(e[0],e[1]):e};var L=typeof self<"u"?self:{},X=Math.pow(2,53)-1;function ne(e,t,i,l){var f=new z(e,t,i,l);return function(m){return f.solve(m)}}var ce=ne(.25,.1,.25,1);function ve(e,t,i){return Math.min(i,Math.max(t,e))}function de(e,t,i){var l=i-t,f=((e-t)%l+l)%l+t;return f===t?i:f}function we(e){for(var t=[],i=arguments.length-1;i-- >0;)t[i]=arguments[i+1];for(var l=0,f=t;l<f.length;l+=1){var m=f[l];for(var x in m)e[x]=m[x]}return e}var Ke=1;function ut(){return Ke++}function Me(){return function e(t){return t?(t^16*Math.random()>>t/4).toString(16):([1e7]+-[1e3]+-4e3+-8e3+-1e11).replace(/[018]/g,e)}()}function Ye(e){return!!e&&/^[0-9a-f]{8}-[0-9a-f]{4}-[4][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i.test(e)}function vt(e,t){e.forEach(function(i){t[i]&&(t[i]=t[i].bind(t))})}function Ue(e,t){return e.indexOf(t,e.length-t.length)!==-1}function ct(e,t,i){var l={};for(var f in e)l[f]=t.call(i||this,e[f],f,e);return l}function mt(e,t,i){var l={};for(var f in e)t.call(i||this,e[f],f,e)&&(l[f]=e[f]);return l}function Ze(e){return Array.isArray(e)?e.map(Ze):typeof e=="object"&&e?ct(e,Ze):e}var Ft={};function yt(e){Ft[e]||(typeof console<"u"&&console.warn(e),Ft[e]=!0)}function Ct(e,t,i){return(i.y-e.y)*(t.x-e.x)>(t.y-e.y)*(i.x-e.x)}function Le(e){for(var t=0,i=0,l=e.length,f=l-1,m=void 0,x=void 0;i<l;f=i++)t+=((x=e[f]).x-(m=e[i]).x)*(m.y+x.y);return t}function Pt(){return typeof WorkerGlobalScope<"u"&&typeof self<"u"&&self instanceof WorkerGlobalScope}function At(e){var t={};if(e.replace(/(?:^|(?:\s*\,\s*))([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)(?:\=(?:([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)|(?:\"((?:[^"\\]|\\.)*)\")))?/g,function(l,f,m,x){var k=m||x;return t[f]=!k||k.toLowerCase(),""}),t["max-age"]){var i=parseInt(t["max-age"],10);isNaN(i)?delete t["max-age"]:t["max-age"]=i}return t}var Jt=null;function Nt(e){if(Jt==null){var t=e.navigator?e.navigator.userAgent:null;Jt=!!e.safari||!(!t||!(/\b(iPad|iPhone|iPod)\b/.test(t)||t.match("Safari")&&!t.match("Chrome")))}return Jt}function ht(e){try{var t=L[e];return t.setItem("_mapbox_test_",1),t.removeItem("_mapbox_test_"),!0}catch{return!1}}var De,Lt,Cr,_i,er=L.performance&&L.performance.now?L.performance.now.bind(L.performance):Date.now.bind(Date),Mr=L.requestAnimationFrame||L.mozRequestAnimationFrame||L.webkitRequestAnimationFrame||L.msRequestAnimationFrame,Sr=L.cancelAnimationFrame||L.mozCancelAnimationFrame||L.webkitCancelAnimationFrame||L.msCancelAnimationFrame,en={now:er,frame:function(e){var t=Mr(e);return{cancel:function(){return Sr(t)}}},getImageData:function(e,t){t===void 0&&(t=0);var i=L.document.createElement("canvas"),l=i.getContext("2d");if(!l)throw new Error("failed to create canvas 2d context");return i.width=e.width,i.height=e.height,l.drawImage(e,0,0,e.width,e.height),l.getImageData(-t,-t,e.width+2*t,e.height+2*t)},resolveURL:function(e){return De||(De=L.document.createElement("a")),De.href=e,De.href},hardwareConcurrency:L.navigator&&L.navigator.hardwareConcurrency||4,get devicePixelRatio(){return L.devicePixelRatio},get prefersReducedMotion(){return!!L.matchMedia&&(Lt==null&&(Lt=L.matchMedia("(prefers-reduced-motion: reduce)")),Lt.matches)}},Wt={API_URL:"https://api.mapbox.com",get EVENTS_URL(){return this.API_URL?this.API_URL.indexOf("https://api.mapbox.cn")===0?"https://events.mapbox.cn/events/v2":this.API_URL.indexOf("https://api.mapbox.com")===0?"https://events.mapbox.com/events/v2":null:null},FEEDBACK_URL:"https://apps.mapbox.com/feedback",REQUIRE_ACCESS_TOKEN:!0,ACCESS_TOKEN:null,MAX_PARALLEL_IMAGE_REQUESTS:16},ui={supported:!1,testSupport:function(e){!Hn&&_i&&(tn?jt(e):Cr=e)}},Hn=!1,tn=!1;function jt(e){var t=e.createTexture();e.bindTexture(e.TEXTURE_2D,t);try{if(e.texImage2D(e.TEXTURE_2D,0,e.RGBA,e.RGBA,e.UNSIGNED_BYTE,_i),e.isContextLost())return;ui.supported=!0}catch{}e.deleteTexture(t),Hn=!0}L.document&&((_i=L.document.createElement("img")).onload=function(){Cr&&jt(Cr),Cr=null,tn=!0},_i.onerror=function(){Hn=!0,Cr=null},_i.src="data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAQAAAAfQ//73v/+BiOh/AAA=");var yn="01",Qr=function(e,t){this._transformRequestFn=e,this._customAccessToken=t,this._createSkuToken()};function vi(e){return e.indexOf("mapbox:")===0}Qr.prototype._createSkuToken=function(){var e=function(){for(var t="",i=0;i<10;i++)t+="0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ"[Math.floor(62*Math.random())];return{token:["1",yn,t].join(""),tokenExpiresAt:Date.now()+432e5}}();this._skuToken=e.token,this._skuTokenExpiresAt=e.tokenExpiresAt},Qr.prototype._isSkuTokenExpired=function(){return Date.now()>this._skuTokenExpiresAt},Qr.prototype.transformRequest=function(e,t){return this._transformRequestFn&&this._transformRequestFn(e,t)||{url:e}},Qr.prototype.normalizeStyleURL=function(e,t){if(!vi(e))return e;var i=ci(e);return i.path="/styles/v1"+i.path,this._makeAPIURL(i,this._customAccessToken||t)},Qr.prototype.normalizeGlyphsURL=function(e,t){if(!vi(e))return e;var i=ci(e);return i.path="/fonts/v1"+i.path,this._makeAPIURL(i,this._customAccessToken||t)},Qr.prototype.normalizeSourceURL=function(e,t){if(!vi(e))return e;var i=ci(e);return i.path="/v4/"+i.authority+".json",i.params.push("secure"),this._makeAPIURL(i,this._customAccessToken||t)},Qr.prototype.normalizeSpriteURL=function(e,t,i,l){var f=ci(e);return vi(e)?(f.path="/styles/v1"+f.path+"/sprite"+t+i,this._makeAPIURL(f,this._customAccessToken||l)):(f.path+=""+t+i,hi(f))},Qr.prototype.normalizeTileURL=function(e,t){if(this._isSkuTokenExpired()&&this._createSkuToken(),e&&!vi(e))return e;var i=ci(e);i.path=i.path.replace(/(\.(png|jpg)\d*)(?=$)/,(en.devicePixelRatio>=2||t===512?"@2x":"")+(ui.supported?".webp":"$1")),i.path=i.path.replace(/^.+\/v4\//,"/"),i.path="/v4"+i.path;var l=this._customAccessToken||function(f){for(var m=0,x=f;m<x.length;m+=1){var k=x[m].match(/^access_token=(.*)$/);if(k)return k[1]}return null}(i.params)||Wt.ACCESS_TOKEN;return Wt.REQUIRE_ACCESS_TOKEN&&l&&this._skuToken&&i.params.push("sku="+this._skuToken),this._makeAPIURL(i,l)},Qr.prototype.canonicalizeTileURL=function(e,t){var i=ci(e);if(!i.path.match(/(^\/v4\/)/)||!i.path.match(/\.[\w]+$/))return e;var l="mapbox://tiles/";l+=i.path.replace("/v4/","");var f=i.params;return t&&(f=f.filter(function(m){return!m.match(/^access_token=/)})),f.length&&(l+="?"+f.join("&")),l},Qr.prototype.canonicalizeTileset=function(e,t){for(var i=!!t&&vi(t),l=[],f=0,m=e.tiles||[];f<m.length;f+=1){var x=m[f];Er(x)?l.push(this.canonicalizeTileURL(x,i)):l.push(x)}return l},Qr.prototype._makeAPIURL=function(e,t){var i="See https://www.mapbox.com/api-documentation/#access-tokens-and-token-scopes",l=ci(Wt.API_URL);if(e.protocol=l.protocol,e.authority=l.authority,e.protocol==="http"){var f=e.params.indexOf("secure");f>=0&&e.params.splice(f,1)}if(l.path!=="/"&&(e.path=""+l.path+e.path),!Wt.REQUIRE_ACCESS_TOKEN)return hi(e);if(!(t=t||Wt.ACCESS_TOKEN))throw new Error("An API access token is required to use Mapbox GL. "+i);if(t[0]==="s")throw new Error("Use a public access token (pk.*) with Mapbox GL, not a secret access token (sk.*). "+i);return e.params=e.params.filter(function(m){return m.indexOf("access_token")===-1}),e.params.push("access_token="+t),hi(e)};var Tn=/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/|\?|$)/i;function Er(e){return Tn.test(e)}var zi=/^(\w+):\/\/([^/?]*)(\/[^?]+)?\??(.+)?/;function ci(e){var t=e.match(zi);if(!t)throw new Error("Unable to parse URL object");return{protocol:t[1],authority:t[2],path:t[3]||"/",params:t[4]?t[4].split("&"):[]}}function hi(e){var t=e.params.length?"?"+e.params.join("&"):"";return e.protocol+"://"+e.authority+e.path+t}function sn(e){if(!e)return null;var t=e.split(".");if(!t||t.length!==3)return null;try{return JSON.parse(decodeURIComponent(L.atob(t[1]).split("").map(function(i){return"%"+("00"+i.charCodeAt(0).toString(16)).slice(-2)}).join("")))}catch{return null}}var qr=function(e){this.type=e,this.anonId=null,this.eventData={},this.queue=[],this.pendingRequest=null};qr.prototype.getStorageKey=function(e){var t,i=sn(Wt.ACCESS_TOKEN);return t=i&&i.u?L.btoa(encodeURIComponent(i.u).replace(/%([0-9A-F]{2})/g,function(l,f){return String.fromCharCode(+("0x"+f))})):Wt.ACCESS_TOKEN||"",e?"mapbox.eventData."+e+":"+t:"mapbox.eventData:"+t},qr.prototype.fetchEventData=function(){var e=ht("localStorage"),t=this.getStorageKey(),i=this.getStorageKey("uuid");if(e)try{var l=L.localStorage.getItem(t);l&&(this.eventData=JSON.parse(l));var f=L.localStorage.getItem(i);f&&(this.anonId=f)}catch{yt("Unable to read from LocalStorage")}},qr.prototype.saveEventData=function(){var e=ht("localStorage"),t=this.getStorageKey(),i=this.getStorageKey("uuid");if(e)try{L.localStorage.setItem(i,this.anonId),Object.keys(this.eventData).length>=1&&L.localStorage.setItem(t,JSON.stringify(this.eventData))}catch{yt("Unable to write to LocalStorage")}},qr.prototype.processRequests=function(e){},qr.prototype.postEvent=function(e,t,i,l){var f=this;if(Wt.EVENTS_URL){var m=ci(Wt.EVENTS_URL);m.params.push("access_token="+(l||Wt.ACCESS_TOKEN||""));var x={event:this.type,created:new Date(e).toISOString(),sdkIdentifier:"mapbox-gl-js",sdkVersion:"1.13.2",skuId:yn,userId:this.anonId},k=t?we(x,t):x,I={url:hi(m),headers:{"Content-Type":"text/plain"},body:JSON.stringify([k])};this.pendingRequest=dr(I,function(A){f.pendingRequest=null,i(A),f.saveEventData(),f.processRequests(l)})}},qr.prototype.queueRequest=function(e,t){this.queue.push(e),this.processRequests(t)};var pi,fi,bi=function(e){function t(){e.call(this,"map.load"),this.success={},this.skuToken=""}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.postMapLoadEvent=function(i,l,f,m){this.skuToken=f,(Wt.EVENTS_URL&&m||Wt.ACCESS_TOKEN&&Array.isArray(i)&&i.some(function(x){return vi(x)||Er(x)}))&&this.queueRequest({id:l,timestamp:Date.now()},m)},t.prototype.processRequests=function(i){var l=this;if(!this.pendingRequest&&this.queue.length!==0){var f=this.queue.shift(),m=f.id,x=f.timestamp;m&&this.success[m]||(this.anonId||this.fetchEventData(),Ye(this.anonId)||(this.anonId=Me()),this.postEvent(x,{skuToken:this.skuToken},function(k){k||m&&(l.success[m]=!0)},i))}},t}(qr),Bi=new(function(e){function t(i){e.call(this,"appUserTurnstile"),this._customAccessToken=i}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.postTurnstileEvent=function(i,l){Wt.EVENTS_URL&&Wt.ACCESS_TOKEN&&Array.isArray(i)&&i.some(function(f){return vi(f)||Er(f)})&&this.queueRequest(Date.now(),l)},t.prototype.processRequests=function(i){var l=this;if(!this.pendingRequest&&this.queue.length!==0){this.anonId&&this.eventData.lastSuccess&&this.eventData.tokenU||this.fetchEventData();var f=sn(Wt.ACCESS_TOKEN),m=f?f.u:Wt.ACCESS_TOKEN,x=m!==this.eventData.tokenU;Ye(this.anonId)||(this.anonId=Me(),x=!0);var k=this.queue.shift();if(this.eventData.lastSuccess){var I=new Date(this.eventData.lastSuccess),A=new Date(k),C=(k-this.eventData.lastSuccess)/864e5;x=x||C>=1||C<-1||I.getDate()!==A.getDate()}else x=!0;if(!x)return this.processRequests();this.postEvent(k,{"enabled.telemetry":!1},function(B){B||(l.eventData.lastSuccess=k,l.eventData.tokenU=m)},i)}},t}(qr)),Xn=Bi.postTurnstileEvent.bind(Bi),qi=new bi,ji=qi.postMapLoadEvent.bind(qi),jr=500,ta=50;function gn(){L.caches&&!pi&&(pi=L.caches.open("mapbox-tiles"))}function xi(e){var t=e.indexOf("?");return t<0?e:e.slice(0,t)}var Mn,Wn=1/0;function Hr(){return Mn==null&&(Mn=L.OffscreenCanvas&&new L.OffscreenCanvas(1,1).getContext("2d")&&typeof L.createImageBitmap=="function"),Mn}var ra={Unknown:"Unknown",Style:"Style",Source:"Source",Tile:"Tile",Glyphs:"Glyphs",SpriteImage:"SpriteImage",SpriteJSON:"SpriteJSON",Image:"Image"};typeof Object.freeze=="function"&&Object.freeze(ra);var Dn=function(e){function t(i,l,f){l===401&&Er(f)&&(i+=": you may have provided an invalid Mapbox access token. See https://www.mapbox.com/api-documentation/#access-tokens-and-token-scopes"),e.call(this,i),this.status=l,this.url=f,this.name=this.constructor.name,this.message=i}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.toString=function(){return this.name+": "+this.message+" ("+this.status+"): "+this.url},t}(Error),ti=Pt()?function(){return self.worker&&self.worker.referrer}:function(){return(L.location.protocol==="blob:"?L.parent:L).location.href},re,dt,Zi=function(e,t){if(!(/^file:/.test(i=e.url)||/^file:/.test(ti())&&!/^\w+:/.test(i))){if(L.fetch&&L.Request&&L.AbortController&&L.Request.prototype.hasOwnProperty("signal"))return function(l,f){var m,x=new L.AbortController,k=new L.Request(l.url,{method:l.method||"GET",body:l.body,credentials:l.credentials,headers:l.headers,referrer:ti(),signal:x.signal}),I=!1,A=!1,C=(m=k.url).indexOf("sku=")>0&&Er(m);l.type==="json"&&k.headers.set("Accept","application/json");var B=function(j,J,Q){if(!A){if(j&&j.message!=="SecurityError"&&yt(j),J&&Q)return U(J);var he=Date.now();L.fetch(k).then(function(ie){if(ie.ok){var me=C?ie.clone():null;return U(ie,me,he)}return f(new Dn(ie.statusText,ie.status,l.url))}).catch(function(ie){ie.code!==20&&f(new Error(ie.message))})}},U=function(j,J,Q){(l.type==="arrayBuffer"?j.arrayBuffer():l.type==="json"?j.json():j.text()).then(function(he){A||(J&&Q&&function(ie,me,be){if(gn(),pi){var Se={status:me.status,statusText:me.statusText,headers:new L.Headers};me.headers.forEach(function(Ce,Ve){return Se.headers.set(Ve,Ce)});var Ee=At(me.headers.get("Cache-Control")||"");Ee["no-store"]||(Ee["max-age"]&&Se.headers.set("Expires",new Date(be+1e3*Ee["max-age"]).toUTCString()),new Date(Se.headers.get("Expires")).getTime()-be<42e4||function(Ce,Ve){if(fi===void 0)try{new Response(new ReadableStream),fi=!0}catch{fi=!1}fi?Ve(Ce.body):Ce.blob().then(Ve)}(me,function(Ce){var Ve=new L.Response(Ce,Se);gn(),pi&&pi.then(function(Je){return Je.put(xi(ie.url),Ve)}).catch(function(Je){return yt(Je.message)})}))}}(k,J,Q),I=!0,f(null,he,j.headers.get("Cache-Control"),j.headers.get("Expires")))}).catch(function(he){A||f(new Error(he.message))})};return C?function(j,J){if(gn(),!pi)return J(null);var Q=xi(j.url);pi.then(function(he){he.match(Q).then(function(ie){var me=function(be){if(!be)return!1;var Se=new Date(be.headers.get("Expires")||0),Ee=At(be.headers.get("Cache-Control")||"");return Se>Date.now()&&!Ee["no-cache"]}(ie);he.delete(Q),me&&he.put(Q,ie.clone()),J(null,ie,me)}).catch(J)}).catch(J)}(k,B):B(null,null),{cancel:function(){A=!0,I||x.abort()}}}(e,t);if(Pt()&&self.worker&&self.worker.actor)return self.worker.actor.send("getResource",e,t,void 0,!0)}var i;return function(l,f){var m=new L.XMLHttpRequest;for(var x in m.open(l.method||"GET",l.url,!0),l.type==="arrayBuffer"&&(m.responseType="arraybuffer"),l.headers)m.setRequestHeader(x,l.headers[x]);return l.type==="json"&&(m.responseType="text",m.setRequestHeader("Accept","application/json")),m.withCredentials=l.credentials==="include",m.onerror=function(){f(new Error(m.statusText))},m.onload=function(){if((m.status>=200&&m.status<300||m.status===0)&&m.response!==null){var k=m.response;if(l.type==="json")try{k=JSON.parse(m.response)}catch(I){return f(I)}f(null,k,m.getResponseHeader("Cache-Control"),m.getResponseHeader("Expires"))}else f(new Dn(m.statusText,m.status,l.url))},m.send(l.body),{cancel:function(){return m.abort()}}}(e,t)},ri=function(e,t){return Zi(we(e,{type:"arrayBuffer"}),t)},dr=function(e,t){return Zi(we(e,{method:"POST"}),t)},R="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAC0lEQVQYV2NgAAIAAAUAAarVyFEAAAAASUVORK5CYII=";re=[],dt=0;var N=function(e,t){if(ui.supported&&(e.headers||(e.headers={}),e.headers.accept="image/webp,*/*"),dt>=Wt.MAX_PARALLEL_IMAGE_REQUESTS){var i={requestParameters:e,callback:t,cancelled:!1,cancel:function(){this.cancelled=!0}};return re.push(i),i}dt++;var l=!1,f=function(){if(!l)for(l=!0,dt--;re.length&&dt<Wt.MAX_PARALLEL_IMAGE_REQUESTS;){var x=re.shift();x.cancelled||(x.cancel=N(x.requestParameters,x.callback).cancel)}},m=ri(e,function(x,k,I,A){f(),x?t(x):k&&(Hr()?function(C,B){var U=new L.Blob([new Uint8Array(C)],{type:"image/png"});L.createImageBitmap(U).then(function(j){B(null,j)}).catch(function(j){B(new Error("Could not load image because of "+j.message+". Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."))})}(k,t):function(C,B,U,j){var J=new L.Image,Q=L.URL;J.onload=function(){B(null,J),Q.revokeObjectURL(J.src),J.onload=null,L.requestAnimationFrame(function(){J.src=R})},J.onerror=function(){return B(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."))};var he=new L.Blob([new Uint8Array(C)],{type:"image/png"});J.cacheControl=U,J.expires=j,J.src=C.byteLength?Q.createObjectURL(he):R}(k,t,I,A))});return{cancel:function(){m.cancel(),f()}}};function V(e,t,i){i[e]&&i[e].indexOf(t)!==-1||(i[e]=i[e]||[],i[e].push(t))}function K(e,t,i){if(i&&i[e]){var l=i[e].indexOf(t);l!==-1&&i[e].splice(l,1)}}var W=function(e,t){t===void 0&&(t={}),we(this,t),this.type=e},se=function(e){function t(i,l){l===void 0&&(l={}),e.call(this,"error",we({error:i},l))}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t}(W),pe=function(){};pe.prototype.on=function(e,t){return this._listeners=this._listeners||{},V(e,t,this._listeners),this},pe.prototype.off=function(e,t){return K(e,t,this._listeners),K(e,t,this._oneTimeListeners),this},pe.prototype.once=function(e,t){return this._oneTimeListeners=this._oneTimeListeners||{},V(e,t,this._oneTimeListeners),this},pe.prototype.fire=function(e,t){typeof e=="string"&&(e=new W(e,t||{}));var i=e.type;if(this.listens(i)){e.target=this;for(var l=0,f=this._listeners&&this._listeners[i]?this._listeners[i].slice():[];l<f.length;l+=1)f[l].call(this,e);for(var m=0,x=this._oneTimeListeners&&this._oneTimeListeners[i]?this._oneTimeListeners[i].slice():[];m<x.length;m+=1){var k=x[m];K(i,k,this._oneTimeListeners),k.call(this,e)}var I=this._eventedParent;I&&(we(e,typeof this._eventedParentData=="function"?this._eventedParentData():this._eventedParentData),I.fire(e))}else e instanceof se&&console.error(e.error);return this},pe.prototype.listens=function(e){return this._listeners&&this._listeners[e]&&this._listeners[e].length>0||this._oneTimeListeners&&this._oneTimeListeners[e]&&this._oneTimeListeners[e].length>0||this._eventedParent&&this._eventedParent.listens(e)},pe.prototype.setEventedParent=function(e,t){return this._eventedParent=e,this._eventedParentData=t,this};var q={$version:8,$root:{version:{required:!0,type:"enum",values:[8]},name:{type:"string"},metadata:{type:"*"},center:{type:"array",value:"number"},zoom:{type:"number"},bearing:{type:"number",default:0,period:360,units:"degrees"},pitch:{type:"number",default:0,units:"degrees"},light:{type:"light"},sources:{required:!0,type:"sources"},sprite:{type:"string"},glyphs:{type:"string"},transition:{type:"transition"},layers:{required:!0,type:"array",value:"layer"}},sources:{"*":{type:"source"}},source:["source_vector","source_raster","source_raster_dem","source_geojson","source_video","source_image"],source_vector:{type:{required:!0,type:"enum",values:{vector:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},attribution:{type:"string"},promoteId:{type:"promoteId"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_raster:{type:{required:!0,type:"enum",values:{raster:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},attribution:{type:"string"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_raster_dem:{type:{required:!0,type:"enum",values:{"raster-dem":{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},attribution:{type:"string"},encoding:{type:"enum",values:{terrarium:{},mapbox:{}},default:"mapbox"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_geojson:{type:{required:!0,type:"enum",values:{geojson:{}}},data:{type:"*"},maxzoom:{type:"number",default:18},attribution:{type:"string"},buffer:{type:"number",default:128,maximum:512,minimum:0},filter:{type:"*"},tolerance:{type:"number",default:.375},cluster:{type:"boolean",default:!1},clusterRadius:{type:"number",default:50,minimum:0},clusterMaxZoom:{type:"number"},clusterMinPoints:{type:"number"},clusterProperties:{type:"*"},lineMetrics:{type:"boolean",default:!1},generateId:{type:"boolean",default:!1},promoteId:{type:"promoteId"}},source_video:{type:{required:!0,type:"enum",values:{video:{}}},urls:{required:!0,type:"array",value:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},source_image:{type:{required:!0,type:"enum",values:{image:{}}},url:{required:!0,type:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},layer:{id:{type:"string",required:!0},type:{type:"enum",values:{fill:{},line:{},symbol:{},circle:{},heatmap:{},"fill-extrusion":{},raster:{},hillshade:{},background:{}},required:!0},metadata:{type:"*"},source:{type:"string"},"source-layer":{type:"string"},minzoom:{type:"number",minimum:0,maximum:24},maxzoom:{type:"number",minimum:0,maximum:24},filter:{type:"filter"},layout:{type:"layout"},paint:{type:"paint"}},layout:["layout_fill","layout_line","layout_circle","layout_heatmap","layout_fill-extrusion","layout_symbol","layout_raster","layout_hillshade","layout_background"],layout_background:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_fill:{"fill-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_circle:{"circle-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_heatmap:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},"layout_fill-extrusion":{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_line:{"line-cap":{type:"enum",values:{butt:{},round:{},square:{}},default:"butt",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-join":{type:"enum",values:{bevel:{},round:{},miter:{}},default:"miter",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"line-miter-limit":{type:"number",default:2,requires:[{"line-join":"miter"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-round-limit":{type:"number",default:1.05,requires:[{"line-join":"round"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_symbol:{"symbol-placement":{type:"enum",values:{point:{},line:{},"line-center":{}},default:"point",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-spacing":{type:"number",default:250,minimum:1,units:"pixels",requires:[{"symbol-placement":"line"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"symbol-avoid-edges":{type:"boolean",default:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"symbol-z-order":{type:"enum",values:{auto:{},"viewport-y":{},source:{}},default:"auto",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-allow-overlap":{type:"boolean",default:!1,requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-ignore-placement":{type:"boolean",default:!1,requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-optional":{type:"boolean",default:!1,requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-rotation-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-size":{type:"number",default:1,minimum:0,units:"factor of the original icon size",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-text-fit":{type:"enum",values:{none:{},width:{},height:{},both:{}},default:"none",requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-text-fit-padding":{type:"array",value:"number",length:4,default:[0,0,0,0],units:"pixels",requires:["icon-image","text-field",{"icon-text-fit":["both","width","height"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-image":{type:"resolvedImage",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-padding":{type:"number",default:2,minimum:0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-keep-upright":{type:"boolean",default:!1,requires:["icon-image",{"icon-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-offset":{type:"array",value:"number",length:2,default:[0,0],requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotation-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-field":{type:"formatted",default:"",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-font":{type:"array",value:"string",default:["Open Sans Regular","Arial Unicode MS Regular"],requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-size":{type:"number",default:16,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-width":{type:"number",default:10,minimum:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-line-height":{type:"number",default:1.2,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-letter-spacing":{type:"number",default:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-justify":{type:"enum",values:{auto:{},left:{},center:{},right:{}},default:"center",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-radial-offset":{type:"number",units:"ems",default:0,requires:["text-field"],"property-type":"data-driven",expression:{interpolated:!0,parameters:["zoom","feature"]}},"text-variable-anchor":{type:"array",value:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["text-field",{"!":"text-variable-anchor"}],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-angle":{type:"number",default:45,units:"degrees",requires:["text-field",{"symbol-placement":["line","line-center"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-writing-mode":{type:"array",value:"enum",values:{horizontal:{},vertical:{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-padding":{type:"number",default:2,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-keep-upright":{type:"boolean",default:!0,requires:["text-field",{"text-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-transform":{type:"enum",values:{none:{},uppercase:{},lowercase:{}},default:"none",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-offset":{type:"array",value:"number",units:"ems",length:2,default:[0,0],requires:["text-field",{"!":"text-radial-offset"}],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-allow-overlap":{type:"boolean",default:!1,requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-ignore-placement":{type:"boolean",default:!1,requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-optional":{type:"boolean",default:!1,requires:["text-field","icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_raster:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_hillshade:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},filter:{type:"array",value:"*"},filter_operator:{type:"enum",values:{"==":{},"!=":{},">":{},">=":{},"<":{},"<=":{},in:{},"!in":{},all:{},any:{},none:{},has:{},"!has":{},within:{}}},geometry_type:{type:"enum",values:{Point:{},LineString:{},Polygon:{}}},function:{expression:{type:"expression"},stops:{type:"array",value:"function_stop"},base:{type:"number",default:1,minimum:0},property:{type:"string",default:"$zoom"},type:{type:"enum",values:{identity:{},exponential:{},interval:{},categorical:{}},default:"exponential"},colorSpace:{type:"enum",values:{rgb:{},lab:{},hcl:{}},default:"rgb"},default:{type:"*",required:!1}},function_stop:{type:"array",minimum:0,maximum:24,value:["number","color"],length:2},expression:{type:"array",value:"*",minimum:1},light:{anchor:{type:"enum",default:"viewport",values:{map:{},viewport:{}},"property-type":"data-constant",transition:!1,expression:{interpolated:!1,parameters:["zoom"]}},position:{type:"array",default:[1.15,210,30],length:3,value:"number","property-type":"data-constant",transition:!0,expression:{interpolated:!0,parameters:["zoom"]}},color:{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},intensity:{type:"number","property-type":"data-constant",default:.5,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0}},paint:["paint_fill","paint_line","paint_circle","paint_heatmap","paint_fill-extrusion","paint_symbol","paint_raster","paint_hillshade","paint_background"],paint_fill:{"fill-antialias":{type:"boolean",default:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-outline-color":{type:"color",transition:!0,requires:[{"!":"fill-pattern"},{"fill-antialias":!0}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"}},"paint_fill-extrusion":{"fill-extrusion-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-extrusion-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-extrusion-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"fill-extrusion-height":{type:"number",default:0,minimum:0,units:"meters",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-base":{type:"number",default:0,minimum:0,units:"meters",transition:!0,requires:["fill-extrusion-height"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-vertical-gradient":{type:"boolean",default:!0,transition:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_line:{"line-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"line-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["line-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-width":{type:"number",default:1,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-gap-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-offset":{type:"number",default:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-dasharray":{type:"array",value:"number",minimum:0,transition:!0,units:"line widths",requires:[{"!":"line-pattern"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"line-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"line-gradient":{type:"color",transition:!1,requires:[{"!":"line-dasharray"},{"!":"line-pattern"},{source:"geojson",has:{lineMetrics:!0}}],expression:{interpolated:!0,parameters:["line-progress"]},"property-type":"color-ramp"}},paint_circle:{"circle-radius":{type:"number",default:5,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-blur":{type:"number",default:0,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"circle-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["circle-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-scale":{type:"enum",values:{map:{},viewport:{}},default:"map",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-alignment":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-stroke-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"}},paint_heatmap:{"heatmap-radius":{type:"number",default:30,minimum:1,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-weight":{type:"number",default:1,minimum:0,transition:!1,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-intensity":{type:"number",default:1,minimum:0,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"heatmap-color":{type:"color",default:["interpolate",["linear"],["heatmap-density"],0,"rgba(0, 0, 255, 0)",.1,"royalblue",.3,"cyan",.5,"lime",.7,"yellow",1,"red"],transition:!1,expression:{interpolated:!0,parameters:["heatmap-density"]},"property-type":"color-ramp"},"heatmap-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_symbol:{"icon-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-color":{type:"color",default:"#000000",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["icon-image","icon-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-color":{type:"color",default:"#000000",transition:!0,overridable:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["text-field","text-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_raster:{"raster-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-hue-rotate":{type:"number",default:0,period:360,transition:!0,units:"degrees",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-min":{type:"number",default:0,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-max":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-saturation":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-contrast":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-resampling":{type:"enum",values:{linear:{},nearest:{}},default:"linear",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"raster-fade-duration":{type:"number",default:300,minimum:0,transition:!1,units:"milliseconds",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_hillshade:{"hillshade-illumination-direction":{type:"number",default:335,minimum:0,maximum:359,transition:!1,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-illumination-anchor":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-exaggeration":{type:"number",default:.5,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-shadow-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-highlight-color":{type:"color",default:"#FFFFFF",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-accent-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_background:{"background-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"background-pattern"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"background-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"background-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},transition:{duration:{type:"number",default:300,minimum:0,units:"milliseconds"},delay:{type:"number",default:0,minimum:0,units:"milliseconds"}},"property-type":{"data-driven":{type:"property-type"},"cross-faded":{type:"property-type"},"cross-faded-data-driven":{type:"property-type"},"color-ramp":{type:"property-type"},"data-constant":{type:"property-type"},constant:{type:"property-type"}},promoteId:{"*":{type:"string"}}},ee=function(e,t,i,l){this.message=(e?e+": ":"")+i,l&&(this.identifier=l),t!=null&&t.__line__&&(this.line=t.__line__)};function ye(e){var t=e.value;return t?[new ee(e.key,t,"constants have been deprecated as of v8")]:[]}function Pe(e){for(var t=[],i=arguments.length-1;i-- >0;)t[i]=arguments[i+1];for(var l=0,f=t;l<f.length;l+=1){var m=f[l];for(var x in m)e[x]=m[x]}return e}function Fe(e){return e instanceof Number||e instanceof String||e instanceof Boolean?e.valueOf():e}function ze(e){if(Array.isArray(e))return e.map(ze);if(e instanceof Object&&!(e instanceof Number||e instanceof String||e instanceof Boolean)){var t={};for(var i in e)t[i]=ze(e[i]);return t}return Fe(e)}var Re=function(e){function t(i,l){e.call(this,l),this.message=l,this.key=i}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t}(Error),st=function(e,t){t===void 0&&(t=[]),this.parent=e,this.bindings={};for(var i=0,l=t;i<l.length;i+=1){var f=l[i];this.bindings[f[0]]=f[1]}};st.prototype.concat=function(e){return new st(this,e)},st.prototype.get=function(e){if(this.bindings[e])return this.bindings[e];if(this.parent)return this.parent.get(e);throw new Error(e+" not found in scope.")},st.prototype.has=function(e){return!!this.bindings[e]||!!this.parent&&this.parent.has(e)};var it={kind:"null"},xe={kind:"number"},tt={kind:"string"},We={kind:"boolean"},$e={kind:"color"},Zt={kind:"object"},rt={kind:"value"},tr={kind:"collator"},br={kind:"formatted"},Ht={kind:"resolvedImage"};function hr(e,t){return{kind:"array",itemType:e,N:t}}function rr(e){if(e.kind==="array"){var t=rr(e.itemType);return typeof e.N=="number"?"array<"+t+", "+e.N+">":e.itemType.kind==="value"?"array":"array<"+t+">"}return e.kind}var wi=[it,xe,tt,We,$e,br,Zt,hr(rt),Ht];function mr(e,t){if(t.kind==="error")return null;if(e.kind==="array"){if(t.kind==="array"&&(t.N===0&&t.itemType.kind==="value"||!mr(e.itemType,t.itemType))&&(typeof e.N!="number"||e.N===t.N))return null}else{if(e.kind===t.kind)return null;if(e.kind==="value"){for(var i=0,l=wi;i<l.length;i+=1)if(!mr(l[i],t))return null}}return"Expected "+rr(e)+" but found "+rr(t)+" instead."}function Fr(e,t){return t.some(function(i){return i.kind===e.kind})}function vr(e,t){return t.some(function(i){return i==="null"?e===null:i==="array"?Array.isArray(e):i==="object"?e&&!Array.isArray(e)&&typeof e=="object":i===typeof e})}var Qt=T(function(e,t){var i={transparent:[0,0,0,0],aliceblue:[240,248,255,1],antiquewhite:[250,235,215,1],aqua:[0,255,255,1],aquamarine:[127,255,212,1],azure:[240,255,255,1],beige:[245,245,220,1],bisque:[255,228,196,1],black:[0,0,0,1],blanchedalmond:[255,235,205,1],blue:[0,0,255,1],blueviolet:[138,43,226,1],brown:[165,42,42,1],burlywood:[222,184,135,1],cadetblue:[95,158,160,1],chartreuse:[127,255,0,1],chocolate:[210,105,30,1],coral:[255,127,80,1],cornflowerblue:[100,149,237,1],cornsilk:[255,248,220,1],crimson:[220,20,60,1],cyan:[0,255,255,1],darkblue:[0,0,139,1],darkcyan:[0,139,139,1],darkgoldenrod:[184,134,11,1],darkgray:[169,169,169,1],darkgreen:[0,100,0,1],darkgrey:[169,169,169,1],darkkhaki:[189,183,107,1],darkmagenta:[139,0,139,1],darkolivegreen:[85,107,47,1],darkorange:[255,140,0,1],darkorchid:[153,50,204,1],darkred:[139,0,0,1],darksalmon:[233,150,122,1],darkseagreen:[143,188,143,1],darkslateblue:[72,61,139,1],darkslategray:[47,79,79,1],darkslategrey:[47,79,79,1],darkturquoise:[0,206,209,1],darkviolet:[148,0,211,1],deeppink:[255,20,147,1],deepskyblue:[0,191,255,1],dimgray:[105,105,105,1],dimgrey:[105,105,105,1],dodgerblue:[30,144,255,1],firebrick:[178,34,34,1],floralwhite:[255,250,240,1],forestgreen:[34,139,34,1],fuchsia:[255,0,255,1],gainsboro:[220,220,220,1],ghostwhite:[248,248,255,1],gold:[255,215,0,1],goldenrod:[218,165,32,1],gray:[128,128,128,1],green:[0,128,0,1],greenyellow:[173,255,47,1],grey:[128,128,128,1],honeydew:[240,255,240,1],hotpink:[255,105,180,1],indianred:[205,92,92,1],indigo:[75,0,130,1],ivory:[255,255,240,1],khaki:[240,230,140,1],lavender:[230,230,250,1],lavenderblush:[255,240,245,1],lawngreen:[124,252,0,1],lemonchiffon:[255,250,205,1],lightblue:[173,216,230,1],lightcoral:[240,128,128,1],lightcyan:[224,255,255,1],lightgoldenrodyellow:[250,250,210,1],lightgray:[211,211,211,1],lightgreen:[144,238,144,1],lightgrey:[211,211,211,1],lightpink:[255,182,193,1],lightsalmon:[255,160,122,1],lightseagreen:[32,178,170,1],lightskyblue:[135,206,250,1],lightslategray:[119,136,153,1],lightslategrey:[119,136,153,1],lightsteelblue:[176,196,222,1],lightyellow:[255,255,224,1],lime:[0,255,0,1],limegreen:[50,205,50,1],linen:[250,240,230,1],magenta:[255,0,255,1],maroon:[128,0,0,1],mediumaquamarine:[102,205,170,1],mediumblue:[0,0,205,1],mediumorchid:[186,85,211,1],mediumpurple:[147,112,219,1],mediumseagreen:[60,179,113,1],mediumslateblue:[123,104,238,1],mediumspringgreen:[0,250,154,1],mediumturquoise:[72,209,204,1],mediumvioletred:[199,21,133,1],midnightblue:[25,25,112,1],mintcream:[245,255,250,1],mistyrose:[255,228,225,1],moccasin:[255,228,181,1],navajowhite:[255,222,173,1],navy:[0,0,128,1],oldlace:[253,245,230,1],olive:[128,128,0,1],olivedrab:[107,142,35,1],orange:[255,165,0,1],orangered:[255,69,0,1],orchid:[218,112,214,1],palegoldenrod:[238,232,170,1],palegreen:[152,251,152,1],paleturquoise:[175,238,238,1],palevioletred:[219,112,147,1],papayawhip:[255,239,213,1],peachpuff:[255,218,185,1],peru:[205,133,63,1],pink:[255,192,203,1],plum:[221,160,221,1],powderblue:[176,224,230,1],purple:[128,0,128,1],rebeccapurple:[102,51,153,1],red:[255,0,0,1],rosybrown:[188,143,143,1],royalblue:[65,105,225,1],saddlebrown:[139,69,19,1],salmon:[250,128,114,1],sandybrown:[244,164,96,1],seagreen:[46,139,87,1],seashell:[255,245,238,1],sienna:[160,82,45,1],silver:[192,192,192,1],skyblue:[135,206,235,1],slateblue:[106,90,205,1],slategray:[112,128,144,1],slategrey:[112,128,144,1],snow:[255,250,250,1],springgreen:[0,255,127,1],steelblue:[70,130,180,1],tan:[210,180,140,1],teal:[0,128,128,1],thistle:[216,191,216,1],tomato:[255,99,71,1],turquoise:[64,224,208,1],violet:[238,130,238,1],wheat:[245,222,179,1],white:[255,255,255,1],whitesmoke:[245,245,245,1],yellow:[255,255,0,1],yellowgreen:[154,205,50,1]};function l(k){return(k=Math.round(k))<0?0:k>255?255:k}function f(k){return l(k[k.length-1]==="%"?parseFloat(k)/100*255:parseInt(k))}function m(k){return(I=k[k.length-1]==="%"?parseFloat(k)/100:parseFloat(k))<0?0:I>1?1:I;var I}function x(k,I,A){return A<0?A+=1:A>1&&(A-=1),6*A<1?k+(I-k)*A*6:2*A<1?I:3*A<2?k+(I-k)*(2/3-A)*6:k}try{t.parseCSSColor=function(k){var I,A=k.replace(/ /g,"").toLowerCase();if(A in i)return i[A].slice();if(A[0]==="#")return A.length===4?(I=parseInt(A.substr(1),16))>=0&&I<=4095?[(3840&I)>>4|(3840&I)>>8,240&I|(240&I)>>4,15&I|(15&I)<<4,1]:null:A.length===7&&(I=parseInt(A.substr(1),16))>=0&&I<=16777215?[(16711680&I)>>16,(65280&I)>>8,255&I,1]:null;var C=A.indexOf("("),B=A.indexOf(")");if(C!==-1&&B+1===A.length){var U=A.substr(0,C),j=A.substr(C+1,B-(C+1)).split(","),J=1;switch(U){case"rgba":if(j.length!==4)return null;J=m(j.pop());case"rgb":return j.length!==3?null:[f(j[0]),f(j[1]),f(j[2]),J];case"hsla":if(j.length!==4)return null;J=m(j.pop());case"hsl":if(j.length!==3)return null;var Q=(parseFloat(j[0])%360+360)%360/360,he=m(j[1]),ie=m(j[2]),me=ie<=.5?ie*(he+1):ie+he-ie*he,be=2*ie-me;return[l(255*x(be,me,Q+1/3)),l(255*x(be,me,Q)),l(255*x(be,me,Q-1/3)),J];default:return null}}return null}}catch{}}).parseCSSColor,pr=function(e,t,i,l){l===void 0&&(l=1),this.r=e,this.g=t,this.b=i,this.a=l};pr.parse=function(e){if(e){if(e instanceof pr)return e;if(typeof e=="string"){var t=Qt(e);if(t)return new pr(t[0]/255*t[3],t[1]/255*t[3],t[2]/255*t[3],t[3])}}},pr.prototype.toString=function(){var e=this.toArray(),t=e[1],i=e[2],l=e[3];return"rgba("+Math.round(e[0])+","+Math.round(t)+","+Math.round(i)+","+l+")"},pr.prototype.toArray=function(){var e=this.a;return e===0?[0,0,0,0]:[255*this.r/e,255*this.g/e,255*this.b/e,e]},pr.black=new pr(0,0,0,1),pr.white=new pr(1,1,1,1),pr.transparent=new pr(0,0,0,0),pr.red=new pr(1,0,0,1);var Ti=function(e,t,i){this.sensitivity=e?t?"variant":"case":t?"accent":"base",this.locale=i,this.collator=new Intl.Collator(this.locale?this.locale:[],{sensitivity:this.sensitivity,usage:"search"})};Ti.prototype.compare=function(e,t){return this.collator.compare(e,t)},Ti.prototype.resolvedLocale=function(){return new Intl.Collator(this.locale?this.locale:[]).resolvedOptions().locale};var ha=function(e,t,i,l,f){this.text=e,this.image=t,this.scale=i,this.fontStack=l,this.textColor=f},ii=function(e){this.sections=e};ii.fromString=function(e){return new ii([new ha(e,null,null,null,null)])},ii.prototype.isEmpty=function(){return this.sections.length===0||!this.sections.some(function(e){return e.text.length!==0||e.image&&e.image.name.length!==0})},ii.factory=function(e){return e instanceof ii?e:ii.fromString(e)},ii.prototype.toString=function(){return this.sections.length===0?"":this.sections.map(function(e){return e.text}).join("")},ii.prototype.serialize=function(){for(var e=["format"],t=0,i=this.sections;t<i.length;t+=1){var l=i[t];if(l.image)e.push(["image",l.image.name]);else{e.push(l.text);var f={};l.fontStack&&(f["text-font"]=["literal",l.fontStack.split(",")]),l.scale&&(f["font-scale"]=l.scale),l.textColor&&(f["text-color"]=["rgba"].concat(l.textColor.toArray())),e.push(f)}}return e};var Oi=function(e){this.name=e.name,this.available=e.available};function Na(e,t,i,l){return typeof e=="number"&&e>=0&&e<=255&&typeof t=="number"&&t>=0&&t<=255&&typeof i=="number"&&i>=0&&i<=255?l===void 0||typeof l=="number"&&l>=0&&l<=1?null:"Invalid rgba value ["+[e,t,i,l].join(", ")+"]: 'a' must be between 0 and 1.":"Invalid rgba value ["+(typeof l=="number"?[e,t,i,l]:[e,t,i]).join(", ")+"]: 'r', 'g', and 'b' must be between 0 and 255."}function va(e){if(e===null||typeof e=="string"||typeof e=="boolean"||typeof e=="number"||e instanceof pr||e instanceof Ti||e instanceof ii||e instanceof Oi)return!0;if(Array.isArray(e)){for(var t=0,i=e;t<i.length;t+=1)if(!va(i[t]))return!1;return!0}if(typeof e=="object"){for(var l in e)if(!va(e[l]))return!1;return!0}return!1}function Zr(e){if(e===null)return it;if(typeof e=="string")return tt;if(typeof e=="boolean")return We;if(typeof e=="number")return xe;if(e instanceof pr)return $e;if(e instanceof Ti)return tr;if(e instanceof ii)return br;if(e instanceof Oi)return Ht;if(Array.isArray(e)){for(var t,i=e.length,l=0,f=e;l<f.length;l+=1){var m=Zr(f[l]);if(t){if(t===m)continue;t=rt;break}t=m}return hr(t||rt,i)}return Zt}function ba(e){var t=typeof e;return e===null?"":t==="string"||t==="number"||t==="boolean"?String(e):e instanceof pr||e instanceof ii||e instanceof Oi?e.toString():JSON.stringify(e)}Oi.prototype.toString=function(){return this.name},Oi.fromString=function(e){return e?new Oi({name:e,available:!1}):null},Oi.prototype.serialize=function(){return["image",this.name]};var Ii=function(e,t){this.type=e,this.value=t};Ii.parse=function(e,t){if(e.length!==2)return t.error("'literal' expression requires exactly one argument, but found "+(e.length-1)+" instead.");if(!va(e[1]))return t.error("invalid value");var i=e[1],l=Zr(i),f=t.expectedType;return l.kind!=="array"||l.N!==0||!f||f.kind!=="array"||typeof f.N=="number"&&f.N!==0||(l=f),new Ii(l,i)},Ii.prototype.evaluate=function(){return this.value},Ii.prototype.eachChild=function(){},Ii.prototype.outputDefined=function(){return!0},Ii.prototype.serialize=function(){return this.type.kind==="array"||this.type.kind==="object"?["literal",this.value]:this.value instanceof pr?["rgba"].concat(this.value.toArray()):this.value instanceof ii?this.value.serialize():this.value};var ni=function(e){this.name="ExpressionEvaluationError",this.message=e};ni.prototype.toJSON=function(){return this.message};var ln={string:tt,number:xe,boolean:We,object:Zt},Dr=function(e,t){this.type=e,this.args=t};Dr.parse=function(e,t){if(e.length<2)return t.error("Expected at least one argument.");var i,l=1,f=e[0];if(f==="array"){var m,x;if(e.length>2){var k=e[1];if(typeof k!="string"||!(k in ln)||k==="object")return t.error('The item type argument of "array" must be one of string, number, boolean',1);m=ln[k],l++}else m=rt;if(e.length>3){if(e[2]!==null&&(typeof e[2]!="number"||e[2]<0||e[2]!==Math.floor(e[2])))return t.error('The length argument to "array" must be a positive integer literal',2);x=e[2],l++}i=hr(m,x)}else i=ln[f];for(var I=[];l<e.length;l++){var A=t.parse(e[l],l,rt);if(!A)return null;I.push(A)}return new Dr(i,I)},Dr.prototype.evaluate=function(e){for(var t=0;t<this.args.length;t++){var i=this.args[t].evaluate(e);if(!mr(this.type,Zr(i)))return i;if(t===this.args.length-1)throw new ni("Expected value to be of type "+rr(this.type)+", but found "+rr(Zr(i))+" instead.")}return null},Dr.prototype.eachChild=function(e){this.args.forEach(e)},Dr.prototype.outputDefined=function(){return this.args.every(function(e){return e.outputDefined()})},Dr.prototype.serialize=function(){var e=this.type,t=[e.kind];if(e.kind==="array"){var i=e.itemType;if(i.kind==="string"||i.kind==="number"||i.kind==="boolean"){t.push(i.kind);var l=e.N;(typeof l=="number"||this.args.length>1)&&t.push(l)}}return t.concat(this.args.map(function(f){return f.serialize()}))};var Ln=function(e){this.type=br,this.sections=e};Ln.parse=function(e,t){if(e.length<2)return t.error("Expected at least one argument.");var i=e[1];if(!Array.isArray(i)&&typeof i=="object")return t.error("First argument must be an image or text section.");for(var l=[],f=!1,m=1;m<=e.length-1;++m){var x=e[m];if(f&&typeof x=="object"&&!Array.isArray(x)){f=!1;var k=null;if(x["font-scale"]&&!(k=t.parse(x["font-scale"],1,xe)))return null;var I=null;if(x["text-font"]&&!(I=t.parse(x["text-font"],1,hr(tt))))return null;var A=null;if(x["text-color"]&&!(A=t.parse(x["text-color"],1,$e)))return null;var C=l[l.length-1];C.scale=k,C.font=I,C.textColor=A}else{var B=t.parse(e[m],1,rt);if(!B)return null;var U=B.type.kind;if(U!=="string"&&U!=="value"&&U!=="null"&&U!=="resolvedImage")return t.error("Formatted text type must be 'string', 'value', 'image' or 'null'.");f=!0,l.push({content:B,scale:null,font:null,textColor:null})}}return new Ln(l)},Ln.prototype.evaluate=function(e){return new ii(this.sections.map(function(t){var i=t.content.evaluate(e);return Zr(i)===Ht?new ha("",i,null,null,null):new ha(ba(i),null,t.scale?t.scale.evaluate(e):null,t.font?t.font.evaluate(e).join(","):null,t.textColor?t.textColor.evaluate(e):null)}))},Ln.prototype.eachChild=function(e){for(var t=0,i=this.sections;t<i.length;t+=1){var l=i[t];e(l.content),l.scale&&e(l.scale),l.font&&e(l.font),l.textColor&&e(l.textColor)}},Ln.prototype.outputDefined=function(){return!1},Ln.prototype.serialize=function(){for(var e=["format"],t=0,i=this.sections;t<i.length;t+=1){var l=i[t];e.push(l.content.serialize());var f={};l.scale&&(f["font-scale"]=l.scale.serialize()),l.font&&(f["text-font"]=l.font.serialize()),l.textColor&&(f["text-color"]=l.textColor.serialize()),e.push(f)}return e};var _n=function(e){this.type=Ht,this.input=e};_n.parse=function(e,t){if(e.length!==2)return t.error("Expected two arguments.");var i=t.parse(e[1],1,tt);return i?new _n(i):t.error("No image name provided.")},_n.prototype.evaluate=function(e){var t=this.input.evaluate(e),i=Oi.fromString(t);return i&&e.availableImages&&(i.available=e.availableImages.indexOf(t)>-1),i},_n.prototype.eachChild=function(e){e(this.input)},_n.prototype.outputDefined=function(){return!1},_n.prototype.serialize=function(){return["image",this.input.serialize()]};var as={"to-boolean":We,"to-color":$e,"to-number":xe,"to-string":tt},Ai=function(e,t){this.type=e,this.args=t};Ai.parse=function(e,t){if(e.length<2)return t.error("Expected at least one argument.");var i=e[0];if((i==="to-boolean"||i==="to-string")&&e.length!==2)return t.error("Expected one argument.");for(var l=as[i],f=[],m=1;m<e.length;m++){var x=t.parse(e[m],m,rt);if(!x)return null;f.push(x)}return new Ai(l,f)},Ai.prototype.evaluate=function(e){if(this.type.kind==="boolean")return!!this.args[0].evaluate(e);if(this.type.kind==="color"){for(var t,i,l=0,f=this.args;l<f.length;l+=1){if(i=null,(t=f[l].evaluate(e))instanceof pr)return t;if(typeof t=="string"){var m=e.parseColor(t);if(m)return m}else if(Array.isArray(t)&&!(i=t.length<3||t.length>4?"Invalid rbga value "+JSON.stringify(t)+": expected an array containing either three or four numeric values.":Na(t[0],t[1],t[2],t[3])))return new pr(t[0]/255,t[1]/255,t[2]/255,t[3])}throw new ni(i||"Could not parse color from value '"+(typeof t=="string"?t:String(JSON.stringify(t)))+"'")}if(this.type.kind==="number"){for(var x=null,k=0,I=this.args;k<I.length;k+=1){if((x=I[k].evaluate(e))===null)return 0;var A=Number(x);if(!isNaN(A))return A}throw new ni("Could not convert "+JSON.stringify(x)+" to number.")}return this.type.kind==="formatted"?ii.fromString(ba(this.args[0].evaluate(e))):this.type.kind==="resolvedImage"?Oi.fromString(ba(this.args[0].evaluate(e))):ba(this.args[0].evaluate(e))},Ai.prototype.eachChild=function(e){this.args.forEach(e)},Ai.prototype.outputDefined=function(){return this.args.every(function(e){return e.outputDefined()})},Ai.prototype.serialize=function(){if(this.type.kind==="formatted")return new Ln([{content:this.args[0],scale:null,font:null,textColor:null}]).serialize();if(this.type.kind==="resolvedImage")return new _n(this.args[0]).serialize();var e=["to-"+this.type.kind];return this.eachChild(function(t){e.push(t.serialize())}),e};var xa=["Unknown","Point","LineString","Polygon"],Gi=function(){this.globals=null,this.feature=null,this.featureState=null,this.formattedSection=null,this._parseColorCache={},this.availableImages=null,this.canonical=null};Gi.prototype.id=function(){return this.feature&&"id"in this.feature?this.feature.id:null},Gi.prototype.geometryType=function(){return this.feature?typeof this.feature.type=="number"?xa[this.feature.type]:this.feature.type:null},Gi.prototype.geometry=function(){return this.feature&&"geometry"in this.feature?this.feature.geometry:null},Gi.prototype.canonicalID=function(){return this.canonical},Gi.prototype.properties=function(){return this.feature&&this.feature.properties||{}},Gi.prototype.parseColor=function(e){var t=this._parseColorCache[e];return t||(t=this._parseColorCache[e]=pr.parse(e)),t};var Pi=function(e,t,i,l){this.name=e,this.type=t,this._evaluate=i,this.args=l};Pi.prototype.evaluate=function(e){return this._evaluate(e,this.args)},Pi.prototype.eachChild=function(e){this.args.forEach(e)},Pi.prototype.outputDefined=function(){return!1},Pi.prototype.serialize=function(){return[this.name].concat(this.args.map(function(e){return e.serialize()}))},Pi.parse=function(e,t){var i,l=e[0],f=Pi.definitions[l];if(!f)return t.error('Unknown expression "'+l+'". If you wanted a literal array, use ["literal", [...]].',0);for(var m=Array.isArray(f)?f[0]:f.type,x=Array.isArray(f)?[[f[1],f[2]]]:f.overloads,k=x.filter(function(Et){var at=Et[0];return!Array.isArray(at)||at.length===e.length-1}),I=null,A=0,C=k;A<C.length;A+=1){var B=C[A],U=B[0],j=B[1];I=new Gr(t.registry,t.path,null,t.scope);for(var J=[],Q=!1,he=1;he<e.length;he++){var ie=e[he],me=Array.isArray(U)?U[he-1]:U.type,be=I.parse(ie,1+J.length,me);if(!be){Q=!0;break}J.push(be)}if(!Q)if(Array.isArray(U)&&U.length!==J.length)I.error("Expected "+U.length+" arguments, but found "+J.length+" instead.");else{for(var Se=0;Se<J.length;Se++){var Ee=Array.isArray(U)?U[Se]:U.type,Ce=J[Se];I.concat(Se+1).checkSubtype(Ee,Ce.type)}if(I.errors.length===0)return new Pi(l,m,j,J)}}if(k.length===1)(i=t.errors).push.apply(i,I.errors);else{for(var Ve=(k.length?k:x).map(function(Et){var at;return at=Et[0],Array.isArray(at)?"("+at.map(rr).join(", ")+")":"("+rr(at.type)+"...)"}).join(" | "),Je=[],bt=1;bt<e.length;bt++){var nt=t.parse(e[bt],1+Je.length);if(!nt)return null;Je.push(rr(nt.type))}t.error("Expected arguments of type "+Ve+", but found ("+Je.join(", ")+") instead.")}return null},Pi.register=function(e,t){for(var i in Pi.definitions=t,t)e[i]=Pi};var Yn=function(e,t,i){this.type=tr,this.locale=i,this.caseSensitive=e,this.diacriticSensitive=t};function Ki(e,t){e[0]=Math.min(e[0],t[0]),e[1]=Math.min(e[1],t[1]),e[2]=Math.max(e[2],t[0]),e[3]=Math.max(e[3],t[1])}function wa(e,t){return!(e[0]<=t[0]||e[2]>=t[2]||e[1]<=t[1]||e[3]>=t[3])}function os(e,t){var i=(180+e[0])/360,l=(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+e[1]*Math.PI/360)))/360,f=Math.pow(2,t.z);return[Math.round(i*f*8192),Math.round(l*f*8192)]}function Fl(e,t,i){return t[1]>e[1]!=i[1]>e[1]&&e[0]<(i[0]-t[0])*(e[1]-t[1])/(i[1]-t[1])+t[0]}function uo(e,t){for(var i,l,f,m,x,k,I,A=!1,C=0,B=t.length;C<B;C++)for(var U=t[C],j=0,J=U.length;j<J-1;j++){if((m=(i=e)[0]-(l=U[j])[0])*(I=i[1]-(f=U[j+1])[1])-(k=i[0]-f[0])*(x=i[1]-l[1])==0&&m*k<=0&&x*I<=0)return!1;Fl(e,U[j],U[j+1])&&(A=!A)}return A}function Nl(e,t){for(var i=0;i<t.length;i++)if(uo(e,t[i]))return!0;return!1}function Ro(e,t,i,l){var f=l[0]-i[0],m=l[1]-i[1],x=(e[0]-i[0])*m-f*(e[1]-i[1]),k=(t[0]-i[0])*m-f*(t[1]-i[1]);return x>0&&k<0||x<0&&k>0}function Ul(e,t,i){for(var l=0,f=i;l<f.length;l+=1)for(var m=f[l],x=0;x<m.length-1;++x)if((B=[(C=m[x+1])[0]-(A=m[x])[0],C[1]-A[1]])[0]*(U=[(I=t)[0]-(k=e)[0],I[1]-k[1]])[1]-B[1]*U[0]!=0&&Ro(k,I,A,C)&&Ro(A,C,k,I))return!0;var k,I,A,C,B,U;return!1}function Bo(e,t){for(var i=0;i<e.length;++i)if(!uo(e[i],t))return!1;for(var l=0;l<e.length-1;++l)if(Ul(e[l],e[l+1],t))return!1;return!0}function Fs(e,t){for(var i=0;i<t.length;i++)if(Bo(e,t[i]))return!0;return!1}function Ua(e,t,i){for(var l=[],f=0;f<e.length;f++){for(var m=[],x=0;x<e[f].length;x++){var k=os(e[f][x],i);Ki(t,k),m.push(k)}l.push(m)}return l}function ss(e,t,i){for(var l=[],f=0;f<e.length;f++){var m=Ua(e[f],t,i);l.push(m)}return l}function co(e,t,i,l){if(e[0]<i[0]||e[0]>i[2]){var f=.5*l,m=e[0]-i[0]>f?-l:i[0]-e[0]>f?l:0;m===0&&(m=e[0]-i[2]>f?-l:i[2]-e[0]>f?l:0),e[0]+=m}Ki(t,e)}function Ns(e,t,i,l){for(var f=8192*Math.pow(2,l.z),m=[8192*l.x,8192*l.y],x=[],k=0,I=e;k<I.length;k+=1)for(var A=0,C=I[k];A<C.length;A+=1){var B=C[A],U=[B.x+m[0],B.y+m[1]];co(U,t,i,f),x.push(U)}return x}function Va(e,t,i,l){for(var f,m=8192*Math.pow(2,l.z),x=[8192*l.x,8192*l.y],k=[],I=0,A=e;I<A.length;I+=1){for(var C=[],B=0,U=A[I];B<U.length;B+=1){var j=U[B],J=[j.x+x[0],j.y+x[1]];Ki(t,J),C.push(J)}k.push(C)}if(t[2]-t[0]<=m/2){(f=t)[0]=f[1]=1/0,f[2]=f[3]=-1/0;for(var Q=0,he=k;Q<he.length;Q+=1)for(var ie=0,me=he[Q];ie<me.length;ie+=1)co(me[ie],t,i,m)}return k}Yn.parse=function(e,t){if(e.length!==2)return t.error("Expected one argument.");var i=e[1];if(typeof i!="object"||Array.isArray(i))return t.error("Collator options argument must be an object.");var l=t.parse(i["case-sensitive"]!==void 0&&i["case-sensitive"],1,We);if(!l)return null;var f=t.parse(i["diacritic-sensitive"]!==void 0&&i["diacritic-sensitive"],1,We);if(!f)return null;var m=null;return i.locale&&!(m=t.parse(i.locale,1,tt))?null:new Yn(l,f,m)},Yn.prototype.evaluate=function(e){return new Ti(this.caseSensitive.evaluate(e),this.diacriticSensitive.evaluate(e),this.locale?this.locale.evaluate(e):null)},Yn.prototype.eachChild=function(e){e(this.caseSensitive),e(this.diacriticSensitive),this.locale&&e(this.locale)},Yn.prototype.outputDefined=function(){return!1},Yn.prototype.serialize=function(){var e={};return e["case-sensitive"]=this.caseSensitive.serialize(),e["diacritic-sensitive"]=this.diacriticSensitive.serialize(),this.locale&&(e.locale=this.locale.serialize()),["collator",e]};var Rn=function(e,t){this.type=We,this.geojson=e,this.geometries=t};function Sa(e){if(e instanceof Pi&&(e.name==="get"&&e.args.length===1||e.name==="feature-state"||e.name==="has"&&e.args.length===1||e.name==="properties"||e.name==="geometry-type"||e.name==="id"||/^filter-/.test(e.name))||e instanceof Rn)return!1;var t=!0;return e.eachChild(function(i){t&&!Sa(i)&&(t=!1)}),t}function ge(e){if(e instanceof Pi&&e.name==="feature-state")return!1;var t=!0;return e.eachChild(function(i){t&&!ge(i)&&(t=!1)}),t}function un(e,t){if(e instanceof Pi&&t.indexOf(e.name)>=0)return!1;var i=!0;return e.eachChild(function(l){i&&!un(l,t)&&(i=!1)}),i}Rn.parse=function(e,t){if(e.length!==2)return t.error("'within' expression requires exactly one argument, but found "+(e.length-1)+" instead.");if(va(e[1])){var i=e[1];if(i.type==="FeatureCollection")for(var l=0;l<i.features.length;++l){var f=i.features[l].geometry.type;if(f==="Polygon"||f==="MultiPolygon")return new Rn(i,i.features[l].geometry)}else if(i.type==="Feature"){var m=i.geometry.type;if(m==="Polygon"||m==="MultiPolygon")return new Rn(i,i.geometry)}else if(i.type==="Polygon"||i.type==="MultiPolygon")return new Rn(i,i)}return t.error("'within' expression requires valid geojson object that contains polygon geometry type.")},Rn.prototype.evaluate=function(e){if(e.geometry()!=null&&e.canonicalID()!=null){if(e.geometryType()==="Point")return function(t,i){var l=[1/0,1/0,-1/0,-1/0],f=[1/0,1/0,-1/0,-1/0],m=t.canonicalID();if(i.type==="Polygon"){var x=Ua(i.coordinates,f,m),k=Ns(t.geometry(),l,f,m);if(!wa(l,f))return!1;for(var I=0,A=k;I<A.length;I+=1)if(!uo(A[I],x))return!1}if(i.type==="MultiPolygon"){var C=ss(i.coordinates,f,m),B=Ns(t.geometry(),l,f,m);if(!wa(l,f))return!1;for(var U=0,j=B;U<j.length;U+=1)if(!Nl(j[U],C))return!1}return!0}(e,this.geometries);if(e.geometryType()==="LineString")return function(t,i){var l=[1/0,1/0,-1/0,-1/0],f=[1/0,1/0,-1/0,-1/0],m=t.canonicalID();if(i.type==="Polygon"){var x=Ua(i.coordinates,f,m),k=Va(t.geometry(),l,f,m);if(!wa(l,f))return!1;for(var I=0,A=k;I<A.length;I+=1)if(!Bo(A[I],x))return!1}if(i.type==="MultiPolygon"){var C=ss(i.coordinates,f,m),B=Va(t.geometry(),l,f,m);if(!wa(l,f))return!1;for(var U=0,j=B;U<j.length;U+=1)if(!Fs(j[U],C))return!1}return!0}(e,this.geometries)}return!1},Rn.prototype.eachChild=function(){},Rn.prototype.outputDefined=function(){return!0},Rn.prototype.serialize=function(){return["within",this.geojson]};var Hi=function(e,t){this.type=t.type,this.name=e,this.boundExpression=t};Hi.parse=function(e,t){if(e.length!==2||typeof e[1]!="string")return t.error("'var' expression requires exactly one string literal argument.");var i=e[1];return t.scope.has(i)?new Hi(i,t.scope.get(i)):t.error('Unknown variable "'+i+'". Make sure "'+i+'" has been bound in an enclosing "let" expression before using it.',1)},Hi.prototype.evaluate=function(e){return this.boundExpression.evaluate(e)},Hi.prototype.eachChild=function(){},Hi.prototype.outputDefined=function(){return!1},Hi.prototype.serialize=function(){return["var",this.name]};var Gr=function(e,t,i,l,f){t===void 0&&(t=[]),l===void 0&&(l=new st),f===void 0&&(f=[]),this.registry=e,this.path=t,this.key=t.map(function(m){return"["+m+"]"}).join(""),this.scope=l,this.errors=f,this.expectedType=i};function ka(e,t){for(var i,l=e.length-1,f=0,m=l,x=0;f<=m;)if((i=e[x=Math.floor((f+m)/2)])<=t){if(x===l||t<e[x+1])return x;f=x+1}else{if(!(i>t))throw new ni("Input is not a number.");m=x-1}return 0}Gr.prototype.parse=function(e,t,i,l,f){return f===void 0&&(f={}),t?this.concat(t,i,l)._parse(e,f):this._parse(e,f)},Gr.prototype._parse=function(e,t){function i(A,C,B){return B==="assert"?new Dr(C,[A]):B==="coerce"?new Ai(C,[A]):A}if(e!==null&&typeof e!="string"&&typeof e!="boolean"&&typeof e!="number"||(e=["literal",e]),Array.isArray(e)){if(e.length===0)return this.error('Expected an array with at least one element. If you wanted a literal array, use ["literal", []].');var l=e[0];if(typeof l!="string")return this.error("Expression name must be a string, but found "+typeof l+' instead. If you wanted a literal array, use ["literal", [...]].',0),null;var f=this.registry[l];if(f){var m=f.parse(e,this);if(!m)return null;if(this.expectedType){var x=this.expectedType,k=m.type;if(x.kind!=="string"&&x.kind!=="number"&&x.kind!=="boolean"&&x.kind!=="object"&&x.kind!=="array"||k.kind!=="value")if(x.kind!=="color"&&x.kind!=="formatted"&&x.kind!=="resolvedImage"||k.kind!=="value"&&k.kind!=="string"){if(this.checkSubtype(x,k))return null}else m=i(m,x,t.typeAnnotation||"coerce");else m=i(m,x,t.typeAnnotation||"assert")}if(!(m instanceof Ii)&&m.type.kind!=="resolvedImage"&&function A(C){if(C instanceof Hi)return A(C.boundExpression);if(C instanceof Pi&&C.name==="error"||C instanceof Yn||C instanceof Rn)return!1;var B=C instanceof Ai||C instanceof Dr,U=!0;return C.eachChild(function(j){U=B?U&&A(j):U&&j instanceof Ii}),!!U&&Sa(C)&&un(C,["zoom","heatmap-density","line-progress","accumulated","is-supported-script"])}(m)){var I=new Gi;try{m=new Ii(m.type,m.evaluate(I))}catch(A){return this.error(A.message),null}}return m}return this.error('Unknown expression "'+l+'". If you wanted a literal array, use ["literal", [...]].',0)}return this.error(e===void 0?"'undefined' value invalid. Use null instead.":typeof e=="object"?'Bare objects invalid. Use ["literal", {...}] instead.':"Expected an array, but found "+typeof e+" instead.")},Gr.prototype.concat=function(e,t,i){var l=typeof e=="number"?this.path.concat(e):this.path,f=i?this.scope.concat(i):this.scope;return new Gr(this.registry,l,t||null,f,this.errors)},Gr.prototype.error=function(e){for(var t=[],i=arguments.length-1;i-- >0;)t[i]=arguments[i+1];var l=""+this.key+t.map(function(f){return"["+f+"]"}).join("");this.errors.push(new Re(l,e))},Gr.prototype.checkSubtype=function(e,t){var i=mr(e,t);return i&&this.error(i),i};var Bn=function(e,t,i){this.type=e,this.input=t,this.labels=[],this.outputs=[];for(var l=0,f=i;l<f.length;l+=1){var m=f[l],x=m[1];this.labels.push(m[0]),this.outputs.push(x)}};function Si(e,t,i){return e*(1-i)+t*i}Bn.parse=function(e,t){if(e.length-1<4)return t.error("Expected at least 4 arguments, but found only "+(e.length-1)+".");if((e.length-1)%2!=0)return t.error("Expected an even number of arguments.");var i=t.parse(e[1],1,xe);if(!i)return null;var l=[],f=null;t.expectedType&&t.expectedType.kind!=="value"&&(f=t.expectedType);for(var m=1;m<e.length;m+=2){var x=m===1?-1/0:e[m],k=e[m+1],I=m,A=m+1;if(typeof x!="number")return t.error('Input/output pairs for "step" expressions must be defined using literal numeric values (not computed expressions) for the input values.',I);if(l.length&&l[l.length-1][0]>=x)return t.error('Input/output pairs for "step" expressions must be arranged with input values in strictly ascending order.',I);var C=t.parse(k,A,f);if(!C)return null;f=f||C.type,l.push([x,C])}return new Bn(f,i,l)},Bn.prototype.evaluate=function(e){var t=this.labels,i=this.outputs;if(t.length===1)return i[0].evaluate(e);var l=this.input.evaluate(e);if(l<=t[0])return i[0].evaluate(e);var f=t.length;return l>=t[f-1]?i[f-1].evaluate(e):i[ka(t,l)].evaluate(e)},Bn.prototype.eachChild=function(e){e(this.input);for(var t=0,i=this.outputs;t<i.length;t+=1)e(i[t])},Bn.prototype.outputDefined=function(){return this.outputs.every(function(e){return e.outputDefined()})},Bn.prototype.serialize=function(){for(var e=["step",this.input.serialize()],t=0;t<this.labels.length;t++)t>0&&e.push(this.labels[t]),e.push(this.outputs[t].serialize());return e};var Oo=Object.freeze({__proto__:null,number:Si,color:function(e,t,i){return new pr(Si(e.r,t.r,i),Si(e.g,t.g,i),Si(e.b,t.b,i),Si(e.a,t.a,i))},array:function(e,t,i){return e.map(function(l,f){return Si(l,t[f],i)})}}),rc=6/29*3*(6/29),Nh=Math.PI/180,Uh=180/Math.PI;function Vl(e){return e>.008856451679035631?Math.pow(e,1/3):e/rc+4/29}function ql(e){return e>6/29?e*e*e:rc*(e-4/29)}function jl(e){return 255*(e<=.0031308?12.92*e:1.055*Math.pow(e,1/2.4)-.055)}function Zl(e){return(e/=255)<=.04045?e/12.92:Math.pow((e+.055)/1.055,2.4)}function ic(e){var t=Zl(e.r),i=Zl(e.g),l=Zl(e.b),f=Vl((.4124564*t+.3575761*i+.1804375*l)/.95047),m=Vl((.2126729*t+.7151522*i+.072175*l)/1);return{l:116*m-16,a:500*(f-m),b:200*(m-Vl((.0193339*t+.119192*i+.9503041*l)/1.08883)),alpha:e.a}}function nc(e){var t=(e.l+16)/116,i=isNaN(e.a)?t:t+e.a/500,l=isNaN(e.b)?t:t-e.b/200;return t=1*ql(t),i=.95047*ql(i),l=1.08883*ql(l),new pr(jl(3.2404542*i-1.5371385*t-.4985314*l),jl(-.969266*i+1.8760108*t+.041556*l),jl(.0556434*i-.2040259*t+1.0572252*l),e.alpha)}function Vh(e,t,i){var l=t-e;return e+i*(l>180||l<-180?l-360*Math.round(l/360):l)}var ls={forward:ic,reverse:nc,interpolate:function(e,t,i){return{l:Si(e.l,t.l,i),a:Si(e.a,t.a,i),b:Si(e.b,t.b,i),alpha:Si(e.alpha,t.alpha,i)}}},us={forward:function(e){var t=ic(e),i=t.l,l=t.a,f=t.b,m=Math.atan2(f,l)*Uh;return{h:m<0?m+360:m,c:Math.sqrt(l*l+f*f),l:i,alpha:e.a}},reverse:function(e){var t=e.h*Nh,i=e.c;return nc({l:e.l,a:Math.cos(t)*i,b:Math.sin(t)*i,alpha:e.alpha})},interpolate:function(e,t,i){return{h:Vh(e.h,t.h,i),c:Si(e.c,t.c,i),l:Si(e.l,t.l,i),alpha:Si(e.alpha,t.alpha,i)}}},ac=Object.freeze({__proto__:null,lab:ls,hcl:us}),rn=function(e,t,i,l,f){this.type=e,this.operator=t,this.interpolation=i,this.input=l,this.labels=[],this.outputs=[];for(var m=0,x=f;m<x.length;m+=1){var k=x[m],I=k[1];this.labels.push(k[0]),this.outputs.push(I)}};function Gl(e,t,i,l){var f=l-i,m=e-i;return f===0?0:t===1?m/f:(Math.pow(t,m)-1)/(Math.pow(t,f)-1)}rn.interpolationFactor=function(e,t,i,l){var f=0;if(e.name==="exponential")f=Gl(t,e.base,i,l);else if(e.name==="linear")f=Gl(t,1,i,l);else if(e.name==="cubic-bezier"){var m=e.controlPoints;f=new z(m[0],m[1],m[2],m[3]).solve(Gl(t,1,i,l))}return f},rn.parse=function(e,t){var i=e[0],l=e[1],f=e[2],m=e.slice(3);if(!Array.isArray(l)||l.length===0)return t.error("Expected an interpolation type expression.",1);if(l[0]==="linear")l={name:"linear"};else if(l[0]==="exponential"){var x=l[1];if(typeof x!="number")return t.error("Exponential interpolation requires a numeric base.",1,1);l={name:"exponential",base:x}}else{if(l[0]!=="cubic-bezier")return t.error("Unknown interpolation type "+String(l[0]),1,0);var k=l.slice(1);if(k.length!==4||k.some(function(he){return typeof he!="number"||he<0||he>1}))return t.error("Cubic bezier interpolation requires four numeric arguments with values between 0 and 1.",1);l={name:"cubic-bezier",controlPoints:k}}if(e.length-1<4)return t.error("Expected at least 4 arguments, but found only "+(e.length-1)+".");if((e.length-1)%2!=0)return t.error("Expected an even number of arguments.");if(!(f=t.parse(f,2,xe)))return null;var I=[],A=null;i==="interpolate-hcl"||i==="interpolate-lab"?A=$e:t.expectedType&&t.expectedType.kind!=="value"&&(A=t.expectedType);for(var C=0;C<m.length;C+=2){var B=m[C],U=m[C+1],j=C+3,J=C+4;if(typeof B!="number")return t.error('Input/output pairs for "interpolate" expressions must be defined using literal numeric values (not computed expressions) for the input values.',j);if(I.length&&I[I.length-1][0]>=B)return t.error('Input/output pairs for "interpolate" expressions must be arranged with input values in strictly ascending order.',j);var Q=t.parse(U,J,A);if(!Q)return null;A=A||Q.type,I.push([B,Q])}return A.kind==="number"||A.kind==="color"||A.kind==="array"&&A.itemType.kind==="number"&&typeof A.N=="number"?new rn(A,i,l,f,I):t.error("Type "+rr(A)+" is not interpolatable.")},rn.prototype.evaluate=function(e){var t=this.labels,i=this.outputs;if(t.length===1)return i[0].evaluate(e);var l=this.input.evaluate(e);if(l<=t[0])return i[0].evaluate(e);var f=t.length;if(l>=t[f-1])return i[f-1].evaluate(e);var m=ka(t,l),x=rn.interpolationFactor(this.interpolation,l,t[m],t[m+1]),k=i[m].evaluate(e),I=i[m+1].evaluate(e);return this.operator==="interpolate"?Oo[this.type.kind.toLowerCase()](k,I,x):this.operator==="interpolate-hcl"?us.reverse(us.interpolate(us.forward(k),us.forward(I),x)):ls.reverse(ls.interpolate(ls.forward(k),ls.forward(I),x))},rn.prototype.eachChild=function(e){e(this.input);for(var t=0,i=this.outputs;t<i.length;t+=1)e(i[t])},rn.prototype.outputDefined=function(){return this.outputs.every(function(e){return e.outputDefined()})},rn.prototype.serialize=function(){var e;e=this.interpolation.name==="linear"?["linear"]:this.interpolation.name==="exponential"?this.interpolation.base===1?["linear"]:["exponential",this.interpolation.base]:["cubic-bezier"].concat(this.interpolation.controlPoints);for(var t=[this.operator,e,this.input.serialize()],i=0;i<this.labels.length;i++)t.push(this.labels[i],this.outputs[i].serialize());return t};var qa=function(e,t){this.type=e,this.args=t};qa.parse=function(e,t){if(e.length<2)return t.error("Expectected at least one argument.");var i=null,l=t.expectedType;l&&l.kind!=="value"&&(i=l);for(var f=[],m=0,x=e.slice(1);m<x.length;m+=1){var k=t.parse(x[m],1+f.length,i,void 0,{typeAnnotation:"omit"});if(!k)return null;i=i||k.type,f.push(k)}var I=l&&f.some(function(A){return mr(l,A.type)});return new qa(I?rt:i,f)},qa.prototype.evaluate=function(e){for(var t,i=null,l=0,f=0,m=this.args;f<m.length&&(l++,(i=m[f].evaluate(e))&&i instanceof Oi&&!i.available&&(t||(t=i.name),i=null,l===this.args.length&&(i=t)),i===null);f+=1);return i},qa.prototype.eachChild=function(e){this.args.forEach(e)},qa.prototype.outputDefined=function(){return this.args.every(function(e){return e.outputDefined()})},qa.prototype.serialize=function(){var e=["coalesce"];return this.eachChild(function(t){e.push(t.serialize())}),e};var ja=function(e,t){this.type=t.type,this.bindings=[].concat(e),this.result=t};ja.prototype.evaluate=function(e){return this.result.evaluate(e)},ja.prototype.eachChild=function(e){for(var t=0,i=this.bindings;t<i.length;t+=1)e(i[t][1]);e(this.result)},ja.parse=function(e,t){if(e.length<4)return t.error("Expected at least 3 arguments, but found "+(e.length-1)+" instead.");for(var i=[],l=1;l<e.length-1;l+=2){var f=e[l];if(typeof f!="string")return t.error("Expected string, but found "+typeof f+" instead.",l);if(/[^a-zA-Z0-9_]/.test(f))return t.error("Variable names must contain only alphanumeric characters or '_'.",l);var m=t.parse(e[l+1],l+1);if(!m)return null;i.push([f,m])}var x=t.parse(e[e.length-1],e.length-1,t.expectedType,i);return x?new ja(i,x):null},ja.prototype.outputDefined=function(){return this.result.outputDefined()},ja.prototype.serialize=function(){for(var e=["let"],t=0,i=this.bindings;t<i.length;t+=1){var l=i[t];e.push(l[0],l[1].serialize())}return e.push(this.result.serialize()),e};var ho=function(e,t,i){this.type=e,this.index=t,this.input=i};ho.parse=function(e,t){if(e.length!==3)return t.error("Expected 2 arguments, but found "+(e.length-1)+" instead.");var i=t.parse(e[1],1,xe),l=t.parse(e[2],2,hr(t.expectedType||rt));return i&&l?new ho(l.type.itemType,i,l):null},ho.prototype.evaluate=function(e){var t=this.index.evaluate(e),i=this.input.evaluate(e);if(t<0)throw new ni("Array index out of bounds: "+t+" < 0.");if(t>=i.length)throw new ni("Array index out of bounds: "+t+" > "+(i.length-1)+".");if(t!==Math.floor(t))throw new ni("Array index must be an integer, but found "+t+" instead.");return i[t]},ho.prototype.eachChild=function(e){e(this.index),e(this.input)},ho.prototype.outputDefined=function(){return!1},ho.prototype.serialize=function(){return["at",this.index.serialize(),this.input.serialize()]};var po=function(e,t){this.type=We,this.needle=e,this.haystack=t};po.parse=function(e,t){if(e.length!==3)return t.error("Expected 2 arguments, but found "+(e.length-1)+" instead.");var i=t.parse(e[1],1,rt),l=t.parse(e[2],2,rt);return i&&l?Fr(i.type,[We,tt,xe,it,rt])?new po(i,l):t.error("Expected first argument to be of type boolean, string, number or null, but found "+rr(i.type)+" instead"):null},po.prototype.evaluate=function(e){var t=this.needle.evaluate(e),i=this.haystack.evaluate(e);if(!i)return!1;if(!vr(t,["boolean","string","number","null"]))throw new ni("Expected first argument to be of type boolean, string, number or null, but found "+rr(Zr(t))+" instead.");if(!vr(i,["string","array"]))throw new ni("Expected second argument to be of type array or string, but found "+rr(Zr(i))+" instead.");return i.indexOf(t)>=0},po.prototype.eachChild=function(e){e(this.needle),e(this.haystack)},po.prototype.outputDefined=function(){return!0},po.prototype.serialize=function(){return["in",this.needle.serialize(),this.haystack.serialize()]};var Za=function(e,t,i){this.type=xe,this.needle=e,this.haystack=t,this.fromIndex=i};Za.parse=function(e,t){if(e.length<=2||e.length>=5)return t.error("Expected 3 or 4 arguments, but found "+(e.length-1)+" instead.");var i=t.parse(e[1],1,rt),l=t.parse(e[2],2,rt);if(!i||!l)return null;if(!Fr(i.type,[We,tt,xe,it,rt]))return t.error("Expected first argument to be of type boolean, string, number or null, but found "+rr(i.type)+" instead");if(e.length===4){var f=t.parse(e[3],3,xe);return f?new Za(i,l,f):null}return new Za(i,l)},Za.prototype.evaluate=function(e){var t=this.needle.evaluate(e),i=this.haystack.evaluate(e);if(!vr(t,["boolean","string","number","null"]))throw new ni("Expected first argument to be of type boolean, string, number or null, but found "+rr(Zr(t))+" instead.");if(!vr(i,["string","array"]))throw new ni("Expected second argument to be of type array or string, but found "+rr(Zr(i))+" instead.");if(this.fromIndex){var l=this.fromIndex.evaluate(e);return i.indexOf(t,l)}return i.indexOf(t)},Za.prototype.eachChild=function(e){e(this.needle),e(this.haystack),this.fromIndex&&e(this.fromIndex)},Za.prototype.outputDefined=function(){return!1},Za.prototype.serialize=function(){if(this.fromIndex!=null&&this.fromIndex!==void 0){var e=this.fromIndex.serialize();return["index-of",this.needle.serialize(),this.haystack.serialize(),e]}return["index-of",this.needle.serialize(),this.haystack.serialize()]};var fo=function(e,t,i,l,f,m){this.inputType=e,this.type=t,this.input=i,this.cases=l,this.outputs=f,this.otherwise=m};fo.parse=function(e,t){if(e.length<5)return t.error("Expected at least 4 arguments, but found only "+(e.length-1)+".");if(e.length%2!=1)return t.error("Expected an even number of arguments.");var i,l;t.expectedType&&t.expectedType.kind!=="value"&&(l=t.expectedType);for(var f={},m=[],x=2;x<e.length-1;x+=2){var k=e[x],I=e[x+1];Array.isArray(k)||(k=[k]);var A=t.concat(x);if(k.length===0)return A.error("Expected at least one branch label.");for(var C=0,B=k;C<B.length;C+=1){var U=B[C];if(typeof U!="number"&&typeof U!="string")return A.error("Branch labels must be numbers or strings.");if(typeof U=="number"&&Math.abs(U)>Number.MAX_SAFE_INTEGER)return A.error("Branch labels must be integers no larger than "+Number.MAX_SAFE_INTEGER+".");if(typeof U=="number"&&Math.floor(U)!==U)return A.error("Numeric branch labels must be integer values.");if(i){if(A.checkSubtype(i,Zr(U)))return null}else i=Zr(U);if(f[String(U)]!==void 0)return A.error("Branch labels must be unique.");f[String(U)]=m.length}var j=t.parse(I,x,l);if(!j)return null;l=l||j.type,m.push(j)}var J=t.parse(e[1],1,rt);if(!J)return null;var Q=t.parse(e[e.length-1],e.length-1,l);return Q?J.type.kind!=="value"&&t.concat(1).checkSubtype(i,J.type)?null:new fo(i,l,J,f,m,Q):null},fo.prototype.evaluate=function(e){var t=this.input.evaluate(e);return(Zr(t)===this.inputType&&this.outputs[this.cases[t]]||this.otherwise).evaluate(e)},fo.prototype.eachChild=function(e){e(this.input),this.outputs.forEach(e),e(this.otherwise)},fo.prototype.outputDefined=function(){return this.outputs.every(function(e){return e.outputDefined()})&&this.otherwise.outputDefined()},fo.prototype.serialize=function(){for(var e=this,t=["match",this.input.serialize()],i=[],l={},f=0,m=Object.keys(this.cases).sort();f<m.length;f+=1){var x=m[f];(B=l[this.cases[x]])===void 0?(l[this.cases[x]]=i.length,i.push([this.cases[x],[x]])):i[B][1].push(x)}for(var k=function(j){return e.inputType.kind==="number"?Number(j):j},I=0,A=i;I<A.length;I+=1){var C=A[I],B=C[0],U=C[1];t.push(U.length===1?k(U[0]):U.map(k)),t.push(this.outputs[outputIndex$1].serialize())}return t.push(this.otherwise.serialize()),t};var mo=function(e,t,i){this.type=e,this.branches=t,this.otherwise=i};mo.parse=function(e,t){if(e.length<4)return t.error("Expected at least 3 arguments, but found only "+(e.length-1)+".");if(e.length%2!=0)return t.error("Expected an odd number of arguments.");var i;t.expectedType&&t.expectedType.kind!=="value"&&(i=t.expectedType);for(var l=[],f=1;f<e.length-1;f+=2){var m=t.parse(e[f],f,We);if(!m)return null;var x=t.parse(e[f+1],f+1,i);if(!x)return null;l.push([m,x]),i=i||x.type}var k=t.parse(e[e.length-1],e.length-1,i);return k?new mo(i,l,k):null},mo.prototype.evaluate=function(e){for(var t=0,i=this.branches;t<i.length;t+=1){var l=i[t],f=l[1];if(l[0].evaluate(e))return f.evaluate(e)}return this.otherwise.evaluate(e)},mo.prototype.eachChild=function(e){for(var t=0,i=this.branches;t<i.length;t+=1){var l=i[t],f=l[1];e(l[0]),e(f)}e(this.otherwise)},mo.prototype.outputDefined=function(){return this.branches.every(function(e){return e[1].outputDefined()})&&this.otherwise.outputDefined()},mo.prototype.serialize=function(){var e=["case"];return this.eachChild(function(t){e.push(t.serialize())}),e};var Ga=function(e,t,i,l){this.type=e,this.input=t,this.beginIndex=i,this.endIndex=l};function oc(e,t){return e==="=="||e==="!="?t.kind==="boolean"||t.kind==="string"||t.kind==="number"||t.kind==="null"||t.kind==="value":t.kind==="string"||t.kind==="number"||t.kind==="value"}function sc(e,t,i,l){return l.compare(t,i)===0}function Br(e,t,i){var l=e!=="=="&&e!=="!=";return function(){function f(m,x,k){this.type=We,this.lhs=m,this.rhs=x,this.collator=k,this.hasUntypedArgument=m.type.kind==="value"||x.type.kind==="value"}return f.parse=function(m,x){if(m.length!==3&&m.length!==4)return x.error("Expected two or three arguments.");var k=m[0],I=x.parse(m[1],1,rt);if(!I)return null;if(!oc(k,I.type))return x.concat(1).error('"'+k+`" comparisons are not supported for type '`+rr(I.type)+"'.");var A=x.parse(m[2],2,rt);if(!A)return null;if(!oc(k,A.type))return x.concat(2).error('"'+k+`" comparisons are not supported for type '`+rr(A.type)+"'.");if(I.type.kind!==A.type.kind&&I.type.kind!=="value"&&A.type.kind!=="value")return x.error("Cannot compare types '"+rr(I.type)+"' and '"+rr(A.type)+"'.");l&&(I.type.kind==="value"&&A.type.kind!=="value"?I=new Dr(A.type,[I]):I.type.kind!=="value"&&A.type.kind==="value"&&(A=new Dr(I.type,[A])));var C=null;if(m.length===4){if(I.type.kind!=="string"&&A.type.kind!=="string"&&I.type.kind!=="value"&&A.type.kind!=="value")return x.error("Cannot use collator to compare non-string types.");if(!(C=x.parse(m[3],3,tr)))return null}return new f(I,A,C)},f.prototype.evaluate=function(m){var x=this.lhs.evaluate(m),k=this.rhs.evaluate(m);if(l&&this.hasUntypedArgument){var I=Zr(x),A=Zr(k);if(I.kind!==A.kind||I.kind!=="string"&&I.kind!=="number")throw new ni('Expected arguments for "'+e+'" to be (string, string) or (number, number), but found ('+I.kind+", "+A.kind+") instead.")}if(this.collator&&!l&&this.hasUntypedArgument){var C=Zr(x),B=Zr(k);if(C.kind!=="string"||B.kind!=="string")return t(m,x,k)}return this.collator?i(m,x,k,this.collator.evaluate(m)):t(m,x,k)},f.prototype.eachChild=function(m){m(this.lhs),m(this.rhs),this.collator&&m(this.collator)},f.prototype.outputDefined=function(){return!0},f.prototype.serialize=function(){var m=[e];return this.eachChild(function(x){m.push(x.serialize())}),m},f}()}Ga.parse=function(e,t){if(e.length<=2||e.length>=5)return t.error("Expected 3 or 4 arguments, but found "+(e.length-1)+" instead.");var i=t.parse(e[1],1,rt),l=t.parse(e[2],2,xe);if(!i||!l)return null;if(!Fr(i.type,[hr(rt),tt,rt]))return t.error("Expected first argument to be of type array or string, but found "+rr(i.type)+" instead");if(e.length===4){var f=t.parse(e[3],3,xe);return f?new Ga(i.type,i,l,f):null}return new Ga(i.type,i,l)},Ga.prototype.evaluate=function(e){var t=this.input.evaluate(e),i=this.beginIndex.evaluate(e);if(!vr(t,["string","array"]))throw new ni("Expected first argument to be of type array or string, but found "+rr(Zr(t))+" instead.");if(this.endIndex){var l=this.endIndex.evaluate(e);return t.slice(i,l)}return t.slice(i)},Ga.prototype.eachChild=function(e){e(this.input),e(this.beginIndex),this.endIndex&&e(this.endIndex)},Ga.prototype.outputDefined=function(){return!1},Ga.prototype.serialize=function(){if(this.endIndex!=null&&this.endIndex!==void 0){var e=this.endIndex.serialize();return["slice",this.input.serialize(),this.beginIndex.serialize(),e]}return["slice",this.input.serialize(),this.beginIndex.serialize()]};var qh=Br("==",function(e,t,i){return t===i},sc),Us=Br("!=",function(e,t,i){return t!==i},function(e,t,i,l){return!sc(0,t,i,l)}),lc=Br("<",function(e,t,i){return t<i},function(e,t,i,l){return l.compare(t,i)<0}),uc=Br(">",function(e,t,i){return t>i},function(e,t,i,l){return l.compare(t,i)>0}),cc=Br("<=",function(e,t,i){return t<=i},function(e,t,i,l){return l.compare(t,i)<=0}),hc=Br(">=",function(e,t,i){return t>=i},function(e,t,i,l){return l.compare(t,i)>=0}),yo=function(e,t,i,l,f){this.type=tt,this.number=e,this.locale=t,this.currency=i,this.minFractionDigits=l,this.maxFractionDigits=f};yo.parse=function(e,t){if(e.length!==3)return t.error("Expected two arguments.");var i=t.parse(e[1],1,xe);if(!i)return null;var l=e[2];if(typeof l!="object"||Array.isArray(l))return t.error("NumberFormat options argument must be an object.");var f=null;if(l.locale&&!(f=t.parse(l.locale,1,tt)))return null;var m=null;if(l.currency&&!(m=t.parse(l.currency,1,tt)))return null;var x=null;if(l["min-fraction-digits"]&&!(x=t.parse(l["min-fraction-digits"],1,xe)))return null;var k=null;return l["max-fraction-digits"]&&!(k=t.parse(l["max-fraction-digits"],1,xe))?null:new yo(i,f,m,x,k)},yo.prototype.evaluate=function(e){return new Intl.NumberFormat(this.locale?this.locale.evaluate(e):[],{style:this.currency?"currency":"decimal",currency:this.currency?this.currency.evaluate(e):void 0,minimumFractionDigits:this.minFractionDigits?this.minFractionDigits.evaluate(e):void 0,maximumFractionDigits:this.maxFractionDigits?this.maxFractionDigits.evaluate(e):void 0}).format(this.number.evaluate(e))},yo.prototype.eachChild=function(e){e(this.number),this.locale&&e(this.locale),this.currency&&e(this.currency),this.minFractionDigits&&e(this.minFractionDigits),this.maxFractionDigits&&e(this.maxFractionDigits)},yo.prototype.outputDefined=function(){return!1},yo.prototype.serialize=function(){var e={};return this.locale&&(e.locale=this.locale.serialize()),this.currency&&(e.currency=this.currency.serialize()),this.minFractionDigits&&(e["min-fraction-digits"]=this.minFractionDigits.serialize()),this.maxFractionDigits&&(e["max-fraction-digits"]=this.maxFractionDigits.serialize()),["number-format",this.number.serialize(),e]};var Ka=function(e){this.type=xe,this.input=e};Ka.parse=function(e,t){if(e.length!==2)return t.error("Expected 1 argument, but found "+(e.length-1)+" instead.");var i=t.parse(e[1],1);return i?i.type.kind!=="array"&&i.type.kind!=="string"&&i.type.kind!=="value"?t.error("Expected argument of type string or array, but found "+rr(i.type)+" instead."):new Ka(i):null},Ka.prototype.evaluate=function(e){var t=this.input.evaluate(e);if(typeof t=="string"||Array.isArray(t))return t.length;throw new ni("Expected value to be of type string or array, but found "+rr(Zr(t))+" instead.")},Ka.prototype.eachChild=function(e){e(this.input)},Ka.prototype.outputDefined=function(){return!1},Ka.prototype.serialize=function(){var e=["length"];return this.eachChild(function(t){e.push(t.serialize())}),e};var go={"==":qh,"!=":Us,">":uc,"<":lc,">=":hc,"<=":cc,array:Dr,at:ho,boolean:Dr,case:mo,coalesce:qa,collator:Yn,format:Ln,image:_n,in:po,"index-of":Za,interpolate:rn,"interpolate-hcl":rn,"interpolate-lab":rn,length:Ka,let:ja,literal:Ii,match:fo,number:Dr,"number-format":yo,object:Dr,slice:Ga,step:Bn,string:Dr,"to-boolean":Ai,"to-color":Ai,"to-number":Ai,"to-string":Ai,var:Hi,within:Rn};function pc(e,t){var i=t[0],l=t[1],f=t[2],m=t[3];i=i.evaluate(e),l=l.evaluate(e),f=f.evaluate(e);var x=m?m.evaluate(e):1,k=Na(i,l,f,x);if(k)throw new ni(k);return new pr(i/255*x,l/255*x,f/255*x,x)}function fc(e,t){return e in t}function Kl(e,t){var i=t[e];return i===void 0?null:i}function _o(e){return{type:e}}function dc(e){return{result:"success",value:e}}function vo(e){return{result:"error",value:e}}function bo(e){return e["property-type"]==="data-driven"||e["property-type"]==="cross-faded-data-driven"}function mc(e){return!!e.expression&&e.expression.parameters.indexOf("zoom")>-1}function cs(e){return!!e.expression&&e.expression.interpolated}function Nr(e){return e instanceof Number?"number":e instanceof String?"string":e instanceof Boolean?"boolean":Array.isArray(e)?"array":e===null?"null":typeof e}function Vs(e){return typeof e=="object"&&e!==null&&!Array.isArray(e)}function jh(e){return e}function Fo(e,t,i){return e!==void 0?e:t!==void 0?t:i!==void 0?i:void 0}function yc(e,t,i,l,f){return Fo(typeof i===f?l[i]:void 0,e.default,t.default)}function Zh(e,t,i){if(Nr(i)!=="number")return Fo(e.default,t.default);var l=e.stops.length;if(l===1||i<=e.stops[0][0])return e.stops[0][1];if(i>=e.stops[l-1][0])return e.stops[l-1][1];var f=ka(e.stops.map(function(m){return m[0]}),i);return e.stops[f][1]}function gc(e,t,i){var l=e.base!==void 0?e.base:1;if(Nr(i)!=="number")return Fo(e.default,t.default);var f=e.stops.length;if(f===1||i<=e.stops[0][0])return e.stops[0][1];if(i>=e.stops[f-1][0])return e.stops[f-1][1];var m=ka(e.stops.map(function(B){return B[0]}),i),x=function(B,U,j,J){var Q=J-j,he=B-j;return Q===0?0:U===1?he/Q:(Math.pow(U,he)-1)/(Math.pow(U,Q)-1)}(i,l,e.stops[m][0],e.stops[m+1][0]),k=e.stops[m][1],I=e.stops[m+1][1],A=Oo[t.type]||jh;if(e.colorSpace&&e.colorSpace!=="rgb"){var C=ac[e.colorSpace];A=function(B,U){return C.reverse(C.interpolate(C.forward(B),C.forward(U),x))}}return typeof k.evaluate=="function"?{evaluate:function(){for(var B=[],U=arguments.length;U--;)B[U]=arguments[U];var j=k.evaluate.apply(void 0,B),J=I.evaluate.apply(void 0,B);if(j!==void 0&&J!==void 0)return A(j,J,x)}}:A(k,I,x)}function qs(e,t,i){return t.type==="color"?i=pr.parse(i):t.type==="formatted"?i=ii.fromString(i.toString()):t.type==="resolvedImage"?i=Oi.fromString(i.toString()):Nr(i)===t.type||t.type==="enum"&&t.values[i]||(i=void 0),Fo(i,e.default,t.default)}Pi.register(go,{error:[{kind:"error"},[tt],function(e,t){throw new ni(t[0].evaluate(e))}],typeof:[tt,[rt],function(e,t){return rr(Zr(t[0].evaluate(e)))}],"to-rgba":[hr(xe,4),[$e],function(e,t){return t[0].evaluate(e).toArray()}],rgb:[$e,[xe,xe,xe],pc],rgba:[$e,[xe,xe,xe,xe],pc],has:{type:We,overloads:[[[tt],function(e,t){return fc(t[0].evaluate(e),e.properties())}],[[tt,Zt],function(e,t){var i=t[1];return fc(t[0].evaluate(e),i.evaluate(e))}]]},get:{type:rt,overloads:[[[tt],function(e,t){return Kl(t[0].evaluate(e),e.properties())}],[[tt,Zt],function(e,t){var i=t[1];return Kl(t[0].evaluate(e),i.evaluate(e))}]]},"feature-state":[rt,[tt],function(e,t){return Kl(t[0].evaluate(e),e.featureState||{})}],properties:[Zt,[],function(e){return e.properties()}],"geometry-type":[tt,[],function(e){return e.geometryType()}],id:[rt,[],function(e){return e.id()}],zoom:[xe,[],function(e){return e.globals.zoom}],"heatmap-density":[xe,[],function(e){return e.globals.heatmapDensity||0}],"line-progress":[xe,[],function(e){return e.globals.lineProgress||0}],accumulated:[rt,[],function(e){return e.globals.accumulated===void 0?null:e.globals.accumulated}],"+":[xe,_o(xe),function(e,t){for(var i=0,l=0,f=t;l<f.length;l+=1)i+=f[l].evaluate(e);return i}],"*":[xe,_o(xe),function(e,t){for(var i=1,l=0,f=t;l<f.length;l+=1)i*=f[l].evaluate(e);return i}],"-":{type:xe,overloads:[[[xe,xe],function(e,t){var i=t[1];return t[0].evaluate(e)-i.evaluate(e)}],[[xe],function(e,t){return-t[0].evaluate(e)}]]},"/":[xe,[xe,xe],function(e,t){var i=t[1];return t[0].evaluate(e)/i.evaluate(e)}],"%":[xe,[xe,xe],function(e,t){var i=t[1];return t[0].evaluate(e)%i.evaluate(e)}],ln2:[xe,[],function(){return Math.LN2}],pi:[xe,[],function(){return Math.PI}],e:[xe,[],function(){return Math.E}],"^":[xe,[xe,xe],function(e,t){var i=t[1];return Math.pow(t[0].evaluate(e),i.evaluate(e))}],sqrt:[xe,[xe],function(e,t){return Math.sqrt(t[0].evaluate(e))}],log10:[xe,[xe],function(e,t){return Math.log(t[0].evaluate(e))/Math.LN10}],ln:[xe,[xe],function(e,t){return Math.log(t[0].evaluate(e))}],log2:[xe,[xe],function(e,t){return Math.log(t[0].evaluate(e))/Math.LN2}],sin:[xe,[xe],function(e,t){return Math.sin(t[0].evaluate(e))}],cos:[xe,[xe],function(e,t){return Math.cos(t[0].evaluate(e))}],tan:[xe,[xe],function(e,t){return Math.tan(t[0].evaluate(e))}],asin:[xe,[xe],function(e,t){return Math.asin(t[0].evaluate(e))}],acos:[xe,[xe],function(e,t){return Math.acos(t[0].evaluate(e))}],atan:[xe,[xe],function(e,t){return Math.atan(t[0].evaluate(e))}],min:[xe,_o(xe),function(e,t){return Math.min.apply(Math,t.map(function(i){return i.evaluate(e)}))}],max:[xe,_o(xe),function(e,t){return Math.max.apply(Math,t.map(function(i){return i.evaluate(e)}))}],abs:[xe,[xe],function(e,t){return Math.abs(t[0].evaluate(e))}],round:[xe,[xe],function(e,t){var i=t[0].evaluate(e);return i<0?-Math.round(-i):Math.round(i)}],floor:[xe,[xe],function(e,t){return Math.floor(t[0].evaluate(e))}],ceil:[xe,[xe],function(e,t){return Math.ceil(t[0].evaluate(e))}],"filter-==":[We,[tt,rt],function(e,t){var i=t[0],l=t[1];return e.properties()[i.value]===l.value}],"filter-id-==":[We,[rt],function(e,t){var i=t[0];return e.id()===i.value}],"filter-type-==":[We,[tt],function(e,t){var i=t[0];return e.geometryType()===i.value}],"filter-<":[We,[tt,rt],function(e,t){var i=t[0],l=t[1],f=e.properties()[i.value],m=l.value;return typeof f==typeof m&&f<m}],"filter-id-<":[We,[rt],function(e,t){var i=t[0],l=e.id(),f=i.value;return typeof l==typeof f&&l<f}],"filter->":[We,[tt,rt],function(e,t){var i=t[0],l=t[1],f=e.properties()[i.value],m=l.value;return typeof f==typeof m&&f>m}],"filter-id->":[We,[rt],function(e,t){var i=t[0],l=e.id(),f=i.value;return typeof l==typeof f&&l>f}],"filter-<=":[We,[tt,rt],function(e,t){var i=t[0],l=t[1],f=e.properties()[i.value],m=l.value;return typeof f==typeof m&&f<=m}],"filter-id-<=":[We,[rt],function(e,t){var i=t[0],l=e.id(),f=i.value;return typeof l==typeof f&&l<=f}],"filter->=":[We,[tt,rt],function(e,t){var i=t[0],l=t[1],f=e.properties()[i.value],m=l.value;return typeof f==typeof m&&f>=m}],"filter-id->=":[We,[rt],function(e,t){var i=t[0],l=e.id(),f=i.value;return typeof l==typeof f&&l>=f}],"filter-has":[We,[rt],function(e,t){return t[0].value in e.properties()}],"filter-has-id":[We,[],function(e){return e.id()!==null&&e.id()!==void 0}],"filter-type-in":[We,[hr(tt)],function(e,t){return t[0].value.indexOf(e.geometryType())>=0}],"filter-id-in":[We,[hr(rt)],function(e,t){return t[0].value.indexOf(e.id())>=0}],"filter-in-small":[We,[tt,hr(rt)],function(e,t){var i=t[0];return t[1].value.indexOf(e.properties()[i.value])>=0}],"filter-in-large":[We,[tt,hr(rt)],function(e,t){var i=t[0],l=t[1];return function(f,m,x,k){for(;x<=k;){var I=x+k>>1;if(m[I]===f)return!0;m[I]>f?k=I-1:x=I+1}return!1}(e.properties()[i.value],l.value,0,l.value.length-1)}],all:{type:We,overloads:[[[We,We],function(e,t){var i=t[1];return t[0].evaluate(e)&&i.evaluate(e)}],[_o(We),function(e,t){for(var i=0,l=t;i<l.length;i+=1)if(!l[i].evaluate(e))return!1;return!0}]]},any:{type:We,overloads:[[[We,We],function(e,t){var i=t[1];return t[0].evaluate(e)||i.evaluate(e)}],[_o(We),function(e,t){for(var i=0,l=t;i<l.length;i+=1)if(l[i].evaluate(e))return!0;return!1}]]},"!":[We,[We],function(e,t){return!t[0].evaluate(e)}],"is-supported-script":[We,[tt],function(e,t){var i=e.globals&&e.globals.isSupportedScript;return!i||i(t[0].evaluate(e))}],upcase:[tt,[tt],function(e,t){return t[0].evaluate(e).toUpperCase()}],downcase:[tt,[tt],function(e,t){return t[0].evaluate(e).toLowerCase()}],concat:[tt,_o(rt),function(e,t){return t.map(function(i){return ba(i.evaluate(e))}).join("")}],"resolved-locale":[tt,[tr],function(e,t){return t[0].evaluate(e).resolvedLocale()}]});var No=function(e,t){this.expression=e,this._warningHistory={},this._evaluator=new Gi,this._defaultValue=t?function(i){return i.type==="color"&&Vs(i.default)?new pr(0,0,0,0):i.type==="color"?pr.parse(i.default)||null:i.default===void 0?null:i.default}(t):null,this._enumValues=t&&t.type==="enum"?t.values:null};function hs(e){return Array.isArray(e)&&e.length>0&&typeof e[0]=="string"&&e[0]in go}function js(e,t){var i=new Gr(go,[],t?function(f){var m={color:$e,string:tt,number:xe,enum:tt,boolean:We,formatted:br,resolvedImage:Ht};return f.type==="array"?hr(m[f.value]||rt,f.length):m[f.type]}(t):void 0),l=i.parse(e,void 0,void 0,void 0,t&&t.type==="string"?{typeAnnotation:"coerce"}:void 0);return l?dc(new No(l,t)):vo(i.errors)}No.prototype.evaluateWithoutErrorHandling=function(e,t,i,l,f,m){return this._evaluator.globals=e,this._evaluator.feature=t,this._evaluator.featureState=i,this._evaluator.canonical=l,this._evaluator.availableImages=f||null,this._evaluator.formattedSection=m,this.expression.evaluate(this._evaluator)},No.prototype.evaluate=function(e,t,i,l,f,m){this._evaluator.globals=e,this._evaluator.feature=t||null,this._evaluator.featureState=i||null,this._evaluator.canonical=l,this._evaluator.availableImages=f||null,this._evaluator.formattedSection=m||null;try{var x=this.expression.evaluate(this._evaluator);if(x==null||typeof x=="number"&&x!=x)return this._defaultValue;if(this._enumValues&&!(x in this._enumValues))throw new ni("Expected value to be one of "+Object.keys(this._enumValues).map(function(k){return JSON.stringify(k)}).join(", ")+", but found "+JSON.stringify(x)+" instead.");return x}catch(k){return this._warningHistory[k.message]||(this._warningHistory[k.message]=!0,typeof console<"u"&&console.warn(k.message)),this._defaultValue}};var ps=function(e,t){this.kind=e,this._styleExpression=t,this.isStateDependent=e!=="constant"&&!ge(t.expression)};ps.prototype.evaluateWithoutErrorHandling=function(e,t,i,l,f,m){return this._styleExpression.evaluateWithoutErrorHandling(e,t,i,l,f,m)},ps.prototype.evaluate=function(e,t,i,l,f,m){return this._styleExpression.evaluate(e,t,i,l,f,m)};var Uo=function(e,t,i,l){this.kind=e,this.zoomStops=i,this._styleExpression=t,this.isStateDependent=e!=="camera"&&!ge(t.expression),this.interpolationType=l};function _c(e,t){if((e=js(e,t)).result==="error")return e;var i=e.value.expression,l=Sa(i);if(!l&&!bo(t))return vo([new Re("","data expressions not supported")]);var f=un(i,["zoom"]);if(!f&&!mc(t))return vo([new Re("","zoom expressions not supported")]);var m=function x(k){var I=null;if(k instanceof ja)I=x(k.result);else if(k instanceof qa)for(var A=0,C=k.args;A<C.length&&!(I=x(C[A]));A+=1);else(k instanceof Bn||k instanceof rn)&&k.input instanceof Pi&&k.input.name==="zoom"&&(I=k);return I instanceof Re||k.eachChild(function(B){var U=x(B);U instanceof Re?I=U:!I&&U?I=new Re("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.'):I&&U&&I!==U&&(I=new Re("",'Only one zoom-based "step" or "interpolate" subexpression may be used in an expression.'))}),I}(i);return m||f?m instanceof Re?vo([m]):m instanceof rn&&!cs(t)?vo([new Re("",'"interpolate" expressions cannot be used with this property')]):dc(m?new Uo(l?"camera":"composite",e.value,m.labels,m instanceof rn?m.interpolation:void 0):new ps(l?"constant":"source",e.value)):vo([new Re("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.')])}Uo.prototype.evaluateWithoutErrorHandling=function(e,t,i,l,f,m){return this._styleExpression.evaluateWithoutErrorHandling(e,t,i,l,f,m)},Uo.prototype.evaluate=function(e,t,i,l,f,m){return this._styleExpression.evaluate(e,t,i,l,f,m)},Uo.prototype.interpolationFactor=function(e,t,i){return this.interpolationType?rn.interpolationFactor(this.interpolationType,e,t,i):0};var Vo=function(e,t){this._parameters=e,this._specification=t,Pe(this,function i(l,f){var m,x,k,I=f.type==="color",A=l.stops&&typeof l.stops[0][0]=="object",C=A||!(A||l.property!==void 0),B=l.type||(cs(f)?"exponential":"interval");if(I&&((l=Pe({},l)).stops&&(l.stops=l.stops.map(function(nt){return[nt[0],pr.parse(nt[1])]})),l.default=pr.parse(l.default?l.default:f.default)),l.colorSpace&&l.colorSpace!=="rgb"&&!ac[l.colorSpace])throw new Error("Unknown color space: "+l.colorSpace);if(B==="exponential")m=gc;else if(B==="interval")m=Zh;else if(B==="categorical"){m=yc,x=Object.create(null);for(var U=0,j=l.stops;U<j.length;U+=1){var J=j[U];x[J[0]]=J[1]}k=typeof l.stops[0][0]}else{if(B!=="identity")throw new Error('Unknown function type "'+B+'"');m=qs}if(A){for(var Q={},he=[],ie=0;ie<l.stops.length;ie++){var me=l.stops[ie],be=me[0].zoom;Q[be]===void 0&&(Q[be]={zoom:be,type:l.type,property:l.property,default:l.default,stops:[]},he.push(be)),Q[be].stops.push([me[0].value,me[1]])}for(var Se=[],Ee=0,Ce=he;Ee<Ce.length;Ee+=1){var Ve=Ce[Ee];Se.push([Q[Ve].zoom,i(Q[Ve],f)])}var Je={name:"linear"};return{kind:"composite",interpolationType:Je,interpolationFactor:rn.interpolationFactor.bind(void 0,Je),zoomStops:Se.map(function(nt){return nt[0]}),evaluate:function(nt,Et){var at=nt.zoom;return gc({stops:Se,base:l.base},f,at).evaluate(at,Et)}}}if(C){var bt=B==="exponential"?{name:"exponential",base:l.base!==void 0?l.base:1}:null;return{kind:"camera",interpolationType:bt,interpolationFactor:rn.interpolationFactor.bind(void 0,bt),zoomStops:l.stops.map(function(nt){return nt[0]}),evaluate:function(nt){return m(l,f,nt.zoom,x,k)}}}return{kind:"source",evaluate:function(nt,Et){var at=Et&&Et.properties?Et.properties[l.property]:void 0;return at===void 0?Fo(l.default,f.default):m(l,f,at,x,k)}}}(this._parameters,this._specification))};function pa(e){var t=e.key,i=e.value,l=e.valueSpec||{},f=e.objectElementValidators||{},m=e.style,x=e.styleSpec,k=[],I=Nr(i);if(I!=="object")return[new ee(t,i,"object expected, "+I+" found")];for(var A in i){var C=A.split(".")[0],B=l[C]||l["*"],U=void 0;if(f[C])U=f[C];else if(l[C])U=fr;else if(f["*"])U=f["*"];else{if(!l["*"]){k.push(new ee(t,i[A],'unknown property "'+A+'"'));continue}U=fr}k=k.concat(U({key:(t&&t+".")+A,value:i[A],valueSpec:B,style:m,styleSpec:x,object:i,objectKey:A},i))}for(var j in l)f[j]||l[j].required&&l[j].default===void 0&&i[j]===void 0&&k.push(new ee(t,i,'missing required property "'+j+'"'));return k}function vc(e){var t=e.value,i=e.valueSpec,l=e.style,f=e.styleSpec,m=e.key,x=e.arrayElementValidator||fr;if(Nr(t)!=="array")return[new ee(m,t,"array expected, "+Nr(t)+" found")];if(i.length&&t.length!==i.length)return[new ee(m,t,"array length "+i.length+" expected, length "+t.length+" found")];if(i["min-length"]&&t.length<i["min-length"])return[new ee(m,t,"array length at least "+i["min-length"]+" expected, length "+t.length+" found")];var k={type:i.value,values:i.values};f.$version<7&&(k.function=i.function),Nr(i.value)==="object"&&(k=i.value);for(var I=[],A=0;A<t.length;A++)I=I.concat(x({array:t,arrayIndex:A,value:t[A],valueSpec:k,style:l,styleSpec:f,key:m+"["+A+"]"}));return I}function bc(e){var t=e.key,i=e.value,l=e.valueSpec,f=Nr(i);return f==="number"&&i!=i&&(f="NaN"),f!=="number"?[new ee(t,i,"number expected, "+f+" found")]:"minimum"in l&&i<l.minimum?[new ee(t,i,i+" is less than the minimum value "+l.minimum)]:"maximum"in l&&i>l.maximum?[new ee(t,i,i+" is greater than the maximum value "+l.maximum)]:[]}function xc(e){var t,i,l,f=e.valueSpec,m=Fe(e.value.type),x={},k=m!=="categorical"&&e.value.property===void 0,I=!k,A=Nr(e.value.stops)==="array"&&Nr(e.value.stops[0])==="array"&&Nr(e.value.stops[0][0])==="object",C=pa({key:e.key,value:e.value,valueSpec:e.styleSpec.function,style:e.style,styleSpec:e.styleSpec,objectElementValidators:{stops:function(j){if(m==="identity")return[new ee(j.key,j.value,'identity function may not have a "stops" property')];var J=[],Q=j.value;return J=J.concat(vc({key:j.key,value:Q,valueSpec:j.valueSpec,style:j.style,styleSpec:j.styleSpec,arrayElementValidator:B})),Nr(Q)==="array"&&Q.length===0&&J.push(new ee(j.key,Q,"array must have at least one stop")),J},default:function(j){return fr({key:j.key,value:j.value,valueSpec:f,style:j.style,styleSpec:j.styleSpec})}}});return m==="identity"&&k&&C.push(new ee(e.key,e.value,'missing required property "property"')),m==="identity"||e.value.stops||C.push(new ee(e.key,e.value,'missing required property "stops"')),m==="exponential"&&e.valueSpec.expression&&!cs(e.valueSpec)&&C.push(new ee(e.key,e.value,"exponential functions not supported")),e.styleSpec.$version>=8&&(I&&!bo(e.valueSpec)?C.push(new ee(e.key,e.value,"property functions not supported")):k&&!mc(e.valueSpec)&&C.push(new ee(e.key,e.value,"zoom functions not supported"))),m!=="categorical"&&!A||e.value.property!==void 0||C.push(new ee(e.key,e.value,'"property" property is required')),C;function B(j){var J=[],Q=j.value,he=j.key;if(Nr(Q)!=="array")return[new ee(he,Q,"array expected, "+Nr(Q)+" found")];if(Q.length!==2)return[new ee(he,Q,"array length 2 expected, length "+Q.length+" found")];if(A){if(Nr(Q[0])!=="object")return[new ee(he,Q,"object expected, "+Nr(Q[0])+" found")];if(Q[0].zoom===void 0)return[new ee(he,Q,"object stop key must have zoom")];if(Q[0].value===void 0)return[new ee(he,Q,"object stop key must have value")];if(l&&l>Fe(Q[0].zoom))return[new ee(he,Q[0].zoom,"stop zoom values must appear in ascending order")];Fe(Q[0].zoom)!==l&&(l=Fe(Q[0].zoom),i=void 0,x={}),J=J.concat(pa({key:he+"[0]",value:Q[0],valueSpec:{zoom:{}},style:j.style,styleSpec:j.styleSpec,objectElementValidators:{zoom:bc,value:U}}))}else J=J.concat(U({key:he+"[0]",value:Q[0],valueSpec:{},style:j.style,styleSpec:j.styleSpec},Q));return hs(ze(Q[1]))?J.concat([new ee(he+"[1]",Q[1],"expressions are not allowed in function stops.")]):J.concat(fr({key:he+"[1]",value:Q[1],valueSpec:f,style:j.style,styleSpec:j.styleSpec}))}function U(j,J){var Q=Nr(j.value),he=Fe(j.value),ie=j.value!==null?j.value:J;if(t){if(Q!==t)return[new ee(j.key,ie,Q+" stop domain type must match previous stop domain type "+t)]}else t=Q;if(Q!=="number"&&Q!=="string"&&Q!=="boolean")return[new ee(j.key,ie,"stop domain value must be a number, string, or boolean")];if(Q!=="number"&&m!=="categorical"){var me="number expected, "+Q+" found";return bo(f)&&m===void 0&&(me+='\nIf you intended to use a categorical function, specify `"type": "categorical"`.'),[new ee(j.key,ie,me)]}return m!=="categorical"||Q!=="number"||isFinite(he)&&Math.floor(he)===he?m!=="categorical"&&Q==="number"&&i!==void 0&&he<i?[new ee(j.key,ie,"stop domain values must appear in ascending order")]:(i=he,m==="categorical"&&he in x?[new ee(j.key,ie,"stop domain values must be unique")]:(x[he]=!0,[])):[new ee(j.key,ie,"integer expected, found "+he)]}}function xo(e){var t=(e.expressionContext==="property"?_c:js)(ze(e.value),e.valueSpec);if(t.result==="error")return t.value.map(function(l){return new ee(""+e.key+l.key,e.value,l.message)});var i=t.value.expression||t.value._styleExpression.expression;if(e.expressionContext==="property"&&e.propertyKey==="text-font"&&!i.outputDefined())return[new ee(e.key,e.value,'Invalid data expression for "'+e.propertyKey+'". Output values must be contained as literals within the expression.')];if(e.expressionContext==="property"&&e.propertyType==="layout"&&!ge(i))return[new ee(e.key,e.value,'"feature-state" data expressions are not supported with layout properties.')];if(e.expressionContext==="filter"&&!ge(i))return[new ee(e.key,e.value,'"feature-state" data expressions are not supported with filters.')];if(e.expressionContext&&e.expressionContext.indexOf("cluster")===0){if(!un(i,["zoom","feature-state"]))return[new ee(e.key,e.value,'"zoom" and "feature-state" expressions are not supported with cluster properties.')];if(e.expressionContext==="cluster-initial"&&!Sa(i))return[new ee(e.key,e.value,"Feature data expressions are not supported with initial expression part of cluster properties.")]}return[]}function fs(e){var t=e.key,i=e.value,l=e.valueSpec,f=[];return Array.isArray(l.values)?l.values.indexOf(Fe(i))===-1&&f.push(new ee(t,i,"expected one of ["+l.values.join(", ")+"], "+JSON.stringify(i)+" found")):Object.keys(l.values).indexOf(Fe(i))===-1&&f.push(new ee(t,i,"expected one of ["+Object.keys(l.values).join(", ")+"], "+JSON.stringify(i)+" found")),f}function Zs(e){if(e===!0||e===!1)return!0;if(!Array.isArray(e)||e.length===0)return!1;switch(e[0]){case"has":return e.length>=2&&e[1]!=="$id"&&e[1]!=="$type";case"in":return e.length>=3&&(typeof e[1]!="string"||Array.isArray(e[2]));case"!in":case"!has":case"none":return!1;case"==":case"!=":case">":case">=":case"<":case"<=":return e.length!==3||Array.isArray(e[1])||Array.isArray(e[2]);case"any":case"all":for(var t=0,i=e.slice(1);t<i.length;t+=1){var l=i[t];if(!Zs(l)&&typeof l!="boolean")return!1}return!0;default:return!0}}Vo.deserialize=function(e){return new Vo(e._parameters,e._specification)},Vo.serialize=function(e){return{_parameters:e._parameters,_specification:e._specification}};var Hl={type:"boolean",default:!1,transition:!1,"property-type":"data-driven",expression:{interpolated:!1,parameters:["zoom","feature"]}};function Gs(e){if(e==null)return{filter:function(){return!0},needGeometry:!1};Zs(e)||(e=Ks(e));var t=js(e,Hl);if(t.result==="error")throw new Error(t.value.map(function(i){return i.key+": "+i.message}).join(", "));return{filter:function(i,l,f){return t.value.evaluate(i,l,{},f)},needGeometry:function i(l){if(!Array.isArray(l))return!1;if(l[0]==="within")return!0;for(var f=1;f<l.length;f++)if(i(l[f]))return!0;return!1}(e)}}function Gh(e,t){return e<t?-1:e>t?1:0}function Ks(e){if(!e)return!0;var t,i=e[0];return e.length<=1?i!=="any":i==="=="?Xl(e[1],e[2],"=="):i==="!="?Hs(Xl(e[1],e[2],"==")):i==="<"||i===">"||i==="<="||i===">="?Xl(e[1],e[2],i):i==="any"?(t=e.slice(1),["any"].concat(t.map(Ks))):i==="all"?["all"].concat(e.slice(1).map(Ks)):i==="none"?["all"].concat(e.slice(1).map(Ks).map(Hs)):i==="in"?wc(e[1],e.slice(2)):i==="!in"?Hs(wc(e[1],e.slice(2))):i==="has"?Sc(e[1]):i==="!has"?Hs(Sc(e[1])):i!=="within"||e}function Xl(e,t,i){switch(e){case"$type":return["filter-type-"+i,t];case"$id":return["filter-id-"+i,t];default:return["filter-"+i,e,t]}}function wc(e,t){if(t.length===0)return!1;switch(e){case"$type":return["filter-type-in",["literal",t]];case"$id":return["filter-id-in",["literal",t]];default:return t.length>200&&!t.some(function(i){return typeof i!=typeof t[0]})?["filter-in-large",e,["literal",t.sort(Gh)]]:["filter-in-small",e,["literal",t]]}}function Sc(e){switch(e){case"$type":return!0;case"$id":return["filter-has-id"];default:return["filter-has",e]}}function Hs(e){return["!",e]}function Wl(e){return Zs(ze(e.value))?xo(Pe({},e,{expressionContext:"filter",valueSpec:{value:"boolean"}})):function t(i){var l=i.value,f=i.key;if(Nr(l)!=="array")return[new ee(f,l,"array expected, "+Nr(l)+" found")];var m,x=i.styleSpec,k=[];if(l.length<1)return[new ee(f,l,"filter array must have at least 1 element")];switch(k=k.concat(fs({key:f+"[0]",value:l[0],valueSpec:x.filter_operator,style:i.style,styleSpec:i.styleSpec})),Fe(l[0])){case"<":case"<=":case">":case">=":l.length>=2&&Fe(l[1])==="$type"&&k.push(new ee(f,l,'"$type" cannot be use with operator "'+l[0]+'"'));case"==":case"!=":l.length!==3&&k.push(new ee(f,l,'filter array for operator "'+l[0]+'" must have 3 elements'));case"in":case"!in":l.length>=2&&(m=Nr(l[1]))!=="string"&&k.push(new ee(f+"[1]",l[1],"string expected, "+m+" found"));for(var I=2;I<l.length;I++)m=Nr(l[I]),Fe(l[1])==="$type"?k=k.concat(fs({key:f+"["+I+"]",value:l[I],valueSpec:x.geometry_type,style:i.style,styleSpec:i.styleSpec})):m!=="string"&&m!=="number"&&m!=="boolean"&&k.push(new ee(f+"["+I+"]",l[I],"string, number, or boolean expected, "+m+" found"));break;case"any":case"all":case"none":for(var A=1;A<l.length;A++)k=k.concat(t({key:f+"["+A+"]",value:l[A],style:i.style,styleSpec:i.styleSpec}));break;case"has":case"!has":m=Nr(l[1]),l.length!==2?k.push(new ee(f,l,'filter array for "'+l[0]+'" operator must have 2 elements')):m!=="string"&&k.push(new ee(f+"[1]",l[1],"string expected, "+m+" found"));break;case"within":m=Nr(l[1]),l.length!==2?k.push(new ee(f,l,'filter array for "'+l[0]+'" operator must have 2 elements')):m!=="object"&&k.push(new ee(f+"[1]",l[1],"object expected, "+m+" found"))}return k}(e)}function Yl(e,t){var i=e.key,l=e.style,f=e.styleSpec,m=e.value,x=e.objectKey,k=f[t+"_"+e.layerType];if(!k)return[];var I=x.match(/^(.*)-transition$/);if(t==="paint"&&I&&k[I[1]]&&k[I[1]].transition)return fr({key:i,value:m,valueSpec:f.transition,style:l,styleSpec:f});var A,C=e.valueSpec||k[x];if(!C)return[new ee(i,m,'unknown property "'+x+'"')];if(Nr(m)==="string"&&bo(C)&&!C.tokens&&(A=/^{([^}]+)}$/.exec(m)))return[new ee(i,m,'"'+x+'" does not support interpolation syntax\nUse an identity property function instead: `{ "type": "identity", "property": '+JSON.stringify(A[1])+" }`.")];var B=[];return e.layerType==="symbol"&&(x==="text-field"&&l&&!l.glyphs&&B.push(new ee(i,m,'use of "text-field" requires a style "glyphs" property')),x==="text-font"&&Vs(ze(m))&&Fe(m.type)==="identity"&&B.push(new ee(i,m,'"text-font" does not support identity functions'))),B.concat(fr({key:e.key,value:m,valueSpec:C,style:l,styleSpec:f,expressionContext:"property",propertyType:t,propertyKey:x}))}function Jl(e){return Yl(e,"paint")}function ds(e){return Yl(e,"layout")}function kc(e){var t=[],i=e.value,l=e.key,f=e.style,m=e.styleSpec;i.type||i.ref||t.push(new ee(l,i,'either "type" or "ref" is required'));var x,k=Fe(i.type),I=Fe(i.ref);if(i.id)for(var A=Fe(i.id),C=0;C<e.arrayIndex;C++){var B=f.layers[C];Fe(B.id)===A&&t.push(new ee(l,i.id,'duplicate layer id "'+i.id+'", previously used at line '+B.id.__line__))}if("ref"in i)["type","source","source-layer","filter","layout"].forEach(function(J){J in i&&t.push(new ee(l,i[J],'"'+J+'" is prohibited for ref layers'))}),f.layers.forEach(function(J){Fe(J.id)===I&&(x=J)}),x?x.ref?t.push(new ee(l,i.ref,"ref cannot reference another ref layer")):k=Fe(x.type):t.push(new ee(l,i.ref,'ref layer "'+I+'" not found'));else if(k!=="background")if(i.source){var U=f.sources&&f.sources[i.source],j=U&&Fe(U.type);U?j==="vector"&&k==="raster"?t.push(new ee(l,i.source,'layer "'+i.id+'" requires a raster source')):j==="raster"&&k!=="raster"?t.push(new ee(l,i.source,'layer "'+i.id+'" requires a vector source')):j!=="vector"||i["source-layer"]?j==="raster-dem"&&k!=="hillshade"?t.push(new ee(l,i.source,"raster-dem source can only be used with layer type 'hillshade'.")):k!=="line"||!i.paint||!i.paint["line-gradient"]||j==="geojson"&&U.lineMetrics||t.push(new ee(l,i,'layer "'+i.id+'" specifies a line-gradient, which requires a GeoJSON source with `lineMetrics` enabled.')):t.push(new ee(l,i,'layer "'+i.id+'" must specify a "source-layer"')):t.push(new ee(l,i.source,'source "'+i.source+'" not found'))}else t.push(new ee(l,i,'missing required property "source"'));return t=t.concat(pa({key:l,value:i,valueSpec:m.layer,style:e.style,styleSpec:e.styleSpec,objectElementValidators:{"*":function(){return[]},type:function(){return fr({key:l+".type",value:i.type,valueSpec:m.layer.type,style:e.style,styleSpec:e.styleSpec,object:i,objectKey:"type"})},filter:Wl,layout:function(J){return pa({layer:i,key:J.key,value:J.value,style:J.style,styleSpec:J.styleSpec,objectElementValidators:{"*":function(Q){return ds(Pe({layerType:k},Q))}}})},paint:function(J){return pa({layer:i,key:J.key,value:J.value,style:J.style,styleSpec:J.styleSpec,objectElementValidators:{"*":function(Q){return Jl(Pe({layerType:k},Q))}}})}}}))}function wo(e){var t=e.value,i=e.key,l=Nr(t);return l!=="string"?[new ee(i,t,"string expected, "+l+" found")]:[]}var Xr={promoteId:function(e){var t=e.key,i=e.value;if(Nr(i)==="string")return wo({key:t,value:i});var l=[];for(var f in i)l.push.apply(l,wo({key:t+"."+f,value:i[f]}));return l}};function Xs(e){var t=e.value,i=e.key,l=e.styleSpec,f=e.style;if(!t.type)return[new ee(i,t,'"type" is required')];var m,x=Fe(t.type);switch(x){case"vector":case"raster":case"raster-dem":return pa({key:i,value:t,valueSpec:l["source_"+x.replace("-","_")],style:e.style,styleSpec:l,objectElementValidators:Xr});case"geojson":if(m=pa({key:i,value:t,valueSpec:l.source_geojson,style:f,styleSpec:l,objectElementValidators:Xr}),t.cluster)for(var k in t.clusterProperties){var I=t.clusterProperties[k],A=I[0],C=typeof A=="string"?[A,["accumulated"],["get",k]]:A;m.push.apply(m,xo({key:i+"."+k+".map",value:I[1],expressionContext:"cluster-map"})),m.push.apply(m,xo({key:i+"."+k+".reduce",value:C,expressionContext:"cluster-reduce"}))}return m;case"video":return pa({key:i,value:t,valueSpec:l.source_video,style:f,styleSpec:l});case"image":return pa({key:i,value:t,valueSpec:l.source_image,style:f,styleSpec:l});case"canvas":return[new ee(i,null,"Please use runtime APIs to add canvas sources, rather than including them in stylesheets.","source.canvas")];default:return fs({key:i+".type",value:t.type,valueSpec:{values:["vector","raster","raster-dem","geojson","video","image"]},style:f,styleSpec:l})}}function So(e){var t=e.value,i=e.styleSpec,l=i.light,f=e.style,m=[],x=Nr(t);if(t===void 0)return m;if(x!=="object")return m.concat([new ee("light",t,"object expected, "+x+" found")]);for(var k in t){var I=k.match(/^(.*)-transition$/);m=m.concat(I&&l[I[1]]&&l[I[1]].transition?fr({key:k,value:t[k],valueSpec:i.transition,style:f,styleSpec:i}):l[k]?fr({key:k,value:t[k],valueSpec:l[k],style:f,styleSpec:i}):[new ee(k,t[k],'unknown property "'+k+'"')])}return m}var Ha={"*":function(){return[]},array:vc,boolean:function(e){var t=e.value,i=e.key,l=Nr(t);return l!=="boolean"?[new ee(i,t,"boolean expected, "+l+" found")]:[]},number:bc,color:function(e){var t=e.key,i=e.value,l=Nr(i);return l!=="string"?[new ee(t,i,"color expected, "+l+" found")]:Qt(i)===null?[new ee(t,i,'color expected, "'+i+'" found')]:[]},constants:ye,enum:fs,filter:Wl,function:xc,layer:kc,object:pa,source:Xs,light:So,string:wo,formatted:function(e){return wo(e).length===0?[]:xo(e)},resolvedImage:function(e){return wo(e).length===0?[]:xo(e)}};function fr(e){var t=e.value,i=e.valueSpec,l=e.styleSpec;return i.expression&&Vs(Fe(t))?xc(e):i.expression&&hs(ze(t))?xo(e):i.type&&Ha[i.type]?Ha[i.type](e):pa(Pe({},e,{valueSpec:i.type?l[i.type]:i}))}function Ur(e){var t=e.value,i=e.key,l=wo(e);return l.length||(t.indexOf("{fontstack}")===-1&&l.push(new ee(i,t,'"glyphs" url must include a "{fontstack}" token')),t.indexOf("{range}")===-1&&l.push(new ee(i,t,'"glyphs" url must include a "{range}" token'))),l}function Jn(e,t){t===void 0&&(t=q);var i=[];return i=i.concat(fr({key:"",value:e,valueSpec:t.$root,styleSpec:t,style:e,objectElementValidators:{glyphs:Ur,"*":function(){return[]}}})),e.constants&&(i=i.concat(ye({key:"constants",value:e.constants,style:e,styleSpec:t}))),ms(i)}function ms(e){return[].concat(e).sort(function(t,i){return t.line-i.line})}function qo(e){return function(){for(var t=[],i=arguments.length;i--;)t[i]=arguments[i];return ms(e.apply(this,t))}}Jn.source=qo(Xs),Jn.light=qo(So),Jn.layer=qo(kc),Jn.filter=qo(Wl),Jn.paintProperty=qo(Jl),Jn.layoutProperty=qo(ds);var ys=Jn,Kh=ys.light,Hh=ys.paintProperty,gs=ys.layoutProperty;function _s(e,t){var i=!1;if(t&&t.length)for(var l=0,f=t;l<f.length;l+=1)e.fire(new se(new Error(f[l].message))),i=!0;return i}var Ca=Ci;function Ci(e,t,i){var l=this.cells=[];if(e instanceof ArrayBuffer){this.arrayBuffer=e;var f=new Int32Array(this.arrayBuffer);e=f[0],this.d=(t=f[1])+2*(i=f[2]);for(var m=0;m<this.d*this.d;m++){var x=f[3+m],k=f[3+m+1];l.push(x===k?null:f.subarray(x,k))}var I=f[3+l.length+1];this.keys=f.subarray(f[3+l.length],I),this.bboxes=f.subarray(I),this.insert=this._insertReadonly}else{this.d=t+2*i;for(var A=0;A<this.d*this.d;A++)l.push([]);this.keys=[],this.bboxes=[]}this.n=t,this.extent=e,this.padding=i,this.scale=t/e,this.uid=0;var C=i/t*e;this.min=-C,this.max=e+C}Ci.prototype.insert=function(e,t,i,l,f){this._forEachCell(t,i,l,f,this._insertCell,this.uid++),this.keys.push(e),this.bboxes.push(t),this.bboxes.push(i),this.bboxes.push(l),this.bboxes.push(f)},Ci.prototype._insertReadonly=function(){throw"Cannot insert into a GridIndex created from an ArrayBuffer."},Ci.prototype._insertCell=function(e,t,i,l,f,m){this.cells[f].push(m)},Ci.prototype.query=function(e,t,i,l,f){var m=this.min,x=this.max;if(e<=m&&t<=m&&x<=i&&x<=l&&!f)return Array.prototype.slice.call(this.keys);var k=[];return this._forEachCell(e,t,i,l,this._queryCell,k,{},f),k},Ci.prototype._queryCell=function(e,t,i,l,f,m,x,k){var I=this.cells[f];if(I!==null)for(var A=this.keys,C=this.bboxes,B=0;B<I.length;B++){var U=I[B];if(x[U]===void 0){var j=4*U;(k?k(C[j+0],C[j+1],C[j+2],C[j+3]):e<=C[j+2]&&t<=C[j+3]&&i>=C[j+0]&&l>=C[j+1])?(x[U]=!0,m.push(A[U])):x[U]=!1}}},Ci.prototype._forEachCell=function(e,t,i,l,f,m,x,k){for(var I=this._convertToCellCoord(e),A=this._convertToCellCoord(t),C=this._convertToCellCoord(i),B=this._convertToCellCoord(l),U=I;U<=C;U++)for(var j=A;j<=B;j++){var J=this.d*j+U;if((!k||k(this._convertFromCellCoord(U),this._convertFromCellCoord(j),this._convertFromCellCoord(U+1),this._convertFromCellCoord(j+1)))&&f.call(this,e,t,i,l,J,m,x,k))return}},Ci.prototype._convertFromCellCoord=function(e){return(e-this.padding)/this.scale},Ci.prototype._convertToCellCoord=function(e){return Math.max(0,Math.min(this.d-1,Math.floor(e*this.scale)+this.padding))},Ci.prototype.toArrayBuffer=function(){if(this.arrayBuffer)return this.arrayBuffer;for(var e=this.cells,t=3+this.cells.length+1+1,i=0,l=0;l<this.cells.length;l++)i+=this.cells[l].length;var f=new Int32Array(t+i+this.keys.length+this.bboxes.length);f[0]=this.extent,f[1]=this.n,f[2]=this.padding;for(var m=t,x=0;x<e.length;x++){var k=e[x];f[3+x]=m,f.set(k,m),m+=k.length}return f[3+e.length]=m,f.set(this.keys,m),f[3+e.length+1]=m+=this.keys.length,f.set(this.bboxes,m),m+=this.bboxes.length,f.buffer};var vs=L.ImageData,Ec=L.ImageBitmap,ki={};function ft(e,t,i){i===void 0&&(i={}),Object.defineProperty(t,"_classRegistryKey",{value:e,writeable:!1}),ki[e]={klass:t,omit:i.omit||[],shallow:i.shallow||[]}}for(var On in ft("Object",Object),Ca.serialize=function(e,t){var i=e.toArrayBuffer();return t&&t.push(i),{buffer:i}},Ca.deserialize=function(e){return new Ca(e.buffer)},ft("Grid",Ca),ft("Color",pr),ft("Error",Error),ft("ResolvedImage",Oi),ft("StylePropertyFunction",Vo),ft("StyleExpression",No,{omit:["_evaluator"]}),ft("ZoomDependentExpression",Uo),ft("ZoomConstantExpression",ps),ft("CompoundExpression",Pi,{omit:["_evaluate"]}),go)go[On]._classRegistryKey||ft("Expression_"+On,go[On]);function Ws(e){return e&&typeof ArrayBuffer<"u"&&(e instanceof ArrayBuffer||e.constructor&&e.constructor.name==="ArrayBuffer")}function jo(e){return Ec&&e instanceof Ec}function fa(e,t){if(e==null||typeof e=="boolean"||typeof e=="number"||typeof e=="string"||e instanceof Boolean||e instanceof Number||e instanceof String||e instanceof Date||e instanceof RegExp)return e;if(Ws(e)||jo(e))return t&&t.push(e),e;if(ArrayBuffer.isView(e)){var i=e;return t&&t.push(i.buffer),i}if(e instanceof vs)return t&&t.push(e.data.buffer),e;if(Array.isArray(e)){for(var l=[],f=0,m=e;f<m.length;f+=1)l.push(fa(m[f],t));return l}if(typeof e=="object"){var x=e.constructor,k=x._classRegistryKey;if(!k)throw new Error("can't serialize object of unregistered class");var I=x.serialize?x.serialize(e,t):{};if(!x.serialize){for(var A in e)if(e.hasOwnProperty(A)&&!(ki[k].omit.indexOf(A)>=0)){var C=e[A];I[A]=ki[k].shallow.indexOf(A)>=0?C:fa(C,t)}e instanceof Error&&(I.message=e.message)}if(I.$name)throw new Error("$name property is reserved for worker serialization logic.");return k!=="Object"&&(I.$name=k),I}throw new Error("can't serialize object of type "+typeof e)}function Fn(e){if(e==null||typeof e=="boolean"||typeof e=="number"||typeof e=="string"||e instanceof Boolean||e instanceof Number||e instanceof String||e instanceof Date||e instanceof RegExp||Ws(e)||jo(e)||ArrayBuffer.isView(e)||e instanceof vs)return e;if(Array.isArray(e))return e.map(Fn);if(typeof e=="object"){var t=e.$name||"Object",i=ki[t].klass;if(!i)throw new Error("can't deserialize unregistered class "+t);if(i.deserialize)return i.deserialize(e);for(var l=Object.create(i.prototype),f=0,m=Object.keys(e);f<m.length;f+=1){var x=m[f];if(x!=="$name"){var k=e[x];l[x]=ki[t].shallow.indexOf(x)>=0?k:Fn(k)}}return l}throw new Error("can't deserialize object of type "+typeof e)}var Ql=function(){this.first=!0};Ql.prototype.update=function(e,t){var i=Math.floor(e);return this.first?(this.first=!1,this.lastIntegerZoom=i,this.lastIntegerZoomTime=0,this.lastZoom=e,this.lastFloorZoom=i,!0):(this.lastFloorZoom>i?(this.lastIntegerZoom=i+1,this.lastIntegerZoomTime=t):this.lastFloorZoom<i&&(this.lastIntegerZoom=i,this.lastIntegerZoomTime=t),e!==this.lastZoom&&(this.lastZoom=e,this.lastFloorZoom=i,!0))};var et={"Latin-1 Supplement":function(e){return e>=128&&e<=255},Arabic:function(e){return e>=1536&&e<=1791},"Arabic Supplement":function(e){return e>=1872&&e<=1919},"Arabic Extended-A":function(e){return e>=2208&&e<=2303},"Hangul Jamo":function(e){return e>=4352&&e<=4607},"Unified Canadian Aboriginal Syllabics":function(e){return e>=5120&&e<=5759},Khmer:function(e){return e>=6016&&e<=6143},"Unified Canadian Aboriginal Syllabics Extended":function(e){return e>=6320&&e<=6399},"General Punctuation":function(e){return e>=8192&&e<=8303},"Letterlike Symbols":function(e){return e>=8448&&e<=8527},"Number Forms":function(e){return e>=8528&&e<=8591},"Miscellaneous Technical":function(e){return e>=8960&&e<=9215},"Control Pictures":function(e){return e>=9216&&e<=9279},"Optical Character Recognition":function(e){return e>=9280&&e<=9311},"Enclosed Alphanumerics":function(e){return e>=9312&&e<=9471},"Geometric Shapes":function(e){return e>=9632&&e<=9727},"Miscellaneous Symbols":function(e){return e>=9728&&e<=9983},"Miscellaneous Symbols and Arrows":function(e){return e>=11008&&e<=11263},"CJK Radicals Supplement":function(e){return e>=11904&&e<=12031},"Kangxi Radicals":function(e){return e>=12032&&e<=12255},"Ideographic Description Characters":function(e){return e>=12272&&e<=12287},"CJK Symbols and Punctuation":function(e){return e>=12288&&e<=12351},Hiragana:function(e){return e>=12352&&e<=12447},Katakana:function(e){return e>=12448&&e<=12543},Bopomofo:function(e){return e>=12544&&e<=12591},"Hangul Compatibility Jamo":function(e){return e>=12592&&e<=12687},Kanbun:function(e){return e>=12688&&e<=12703},"Bopomofo Extended":function(e){return e>=12704&&e<=12735},"CJK Strokes":function(e){return e>=12736&&e<=12783},"Katakana Phonetic Extensions":function(e){return e>=12784&&e<=12799},"Enclosed CJK Letters and Months":function(e){return e>=12800&&e<=13055},"CJK Compatibility":function(e){return e>=13056&&e<=13311},"CJK Unified Ideographs Extension A":function(e){return e>=13312&&e<=19903},"Yijing Hexagram Symbols":function(e){return e>=19904&&e<=19967},"CJK Unified Ideographs":function(e){return e>=19968&&e<=40959},"Yi Syllables":function(e){return e>=40960&&e<=42127},"Yi Radicals":function(e){return e>=42128&&e<=42191},"Hangul Jamo Extended-A":function(e){return e>=43360&&e<=43391},"Hangul Syllables":function(e){return e>=44032&&e<=55215},"Hangul Jamo Extended-B":function(e){return e>=55216&&e<=55295},"Private Use Area":function(e){return e>=57344&&e<=63743},"CJK Compatibility Ideographs":function(e){return e>=63744&&e<=64255},"Arabic Presentation Forms-A":function(e){return e>=64336&&e<=65023},"Vertical Forms":function(e){return e>=65040&&e<=65055},"CJK Compatibility Forms":function(e){return e>=65072&&e<=65103},"Small Form Variants":function(e){return e>=65104&&e<=65135},"Arabic Presentation Forms-B":function(e){return e>=65136&&e<=65279},"Halfwidth and Fullwidth Forms":function(e){return e>=65280&&e<=65519}};function $l(e){for(var t=0,i=e;t<i.length;t+=1)if(Ys(i[t].charCodeAt(0)))return!0;return!1}function Ys(e){return!(e!==746&&e!==747&&(e<4352||!(et["Bopomofo Extended"](e)||et.Bopomofo(e)||et["CJK Compatibility Forms"](e)&&!(e>=65097&&e<=65103)||et["CJK Compatibility Ideographs"](e)||et["CJK Compatibility"](e)||et["CJK Radicals Supplement"](e)||et["CJK Strokes"](e)||!(!et["CJK Symbols and Punctuation"](e)||e>=12296&&e<=12305||e>=12308&&e<=12319||e===12336)||et["CJK Unified Ideographs Extension A"](e)||et["CJK Unified Ideographs"](e)||et["Enclosed CJK Letters and Months"](e)||et["Hangul Compatibility Jamo"](e)||et["Hangul Jamo Extended-A"](e)||et["Hangul Jamo Extended-B"](e)||et["Hangul Jamo"](e)||et["Hangul Syllables"](e)||et.Hiragana(e)||et["Ideographic Description Characters"](e)||et.Kanbun(e)||et["Kangxi Radicals"](e)||et["Katakana Phonetic Extensions"](e)||et.Katakana(e)&&e!==12540||!(!et["Halfwidth and Fullwidth Forms"](e)||e===65288||e===65289||e===65293||e>=65306&&e<=65310||e===65339||e===65341||e===65343||e>=65371&&e<=65503||e===65507||e>=65512&&e<=65519)||!(!et["Small Form Variants"](e)||e>=65112&&e<=65118||e>=65123&&e<=65126)||et["Unified Canadian Aboriginal Syllabics"](e)||et["Unified Canadian Aboriginal Syllabics Extended"](e)||et["Vertical Forms"](e)||et["Yijing Hexagram Symbols"](e)||et["Yi Syllables"](e)||et["Yi Radicals"](e))))}function eu(e){return!(Ys(e)||function(t){return!!(et["Latin-1 Supplement"](t)&&(t===167||t===169||t===174||t===177||t===188||t===189||t===190||t===215||t===247)||et["General Punctuation"](t)&&(t===8214||t===8224||t===8225||t===8240||t===8241||t===8251||t===8252||t===8258||t===8263||t===8264||t===8265||t===8273)||et["Letterlike Symbols"](t)||et["Number Forms"](t)||et["Miscellaneous Technical"](t)&&(t>=8960&&t<=8967||t>=8972&&t<=8991||t>=8996&&t<=9e3||t===9003||t>=9085&&t<=9114||t>=9150&&t<=9165||t===9167||t>=9169&&t<=9179||t>=9186&&t<=9215)||et["Control Pictures"](t)&&t!==9251||et["Optical Character Recognition"](t)||et["Enclosed Alphanumerics"](t)||et["Geometric Shapes"](t)||et["Miscellaneous Symbols"](t)&&!(t>=9754&&t<=9759)||et["Miscellaneous Symbols and Arrows"](t)&&(t>=11026&&t<=11055||t>=11088&&t<=11097||t>=11192&&t<=11243)||et["CJK Symbols and Punctuation"](t)||et.Katakana(t)||et["Private Use Area"](t)||et["CJK Compatibility Forms"](t)||et["Small Form Variants"](t)||et["Halfwidth and Fullwidth Forms"](t)||t===8734||t===8756||t===8757||t>=9984&&t<=10087||t>=10102&&t<=10131||t===65532||t===65533)}(e))}function ia(e){return e>=1424&&e<=2303||et["Arabic Presentation Forms-A"](e)||et["Arabic Presentation Forms-B"](e)}function Nn(e,t){return!(!t&&ia(e)||e>=2304&&e<=3583||e>=3840&&e<=4255||et.Khmer(e))}function Js(e){for(var t=0,i=e;t<i.length;t+=1)if(ia(i[t].charCodeAt(0)))return!0;return!1}var Qs=null,Un="unavailable",Ma=null,zc=function(e){e&&typeof e=="string"&&e.indexOf("NetworkError")>-1&&(Un="error"),Qs&&Qs(e)};function bs(){tu.fire(new W("pluginStateChange",{pluginStatus:Un,pluginURL:Ma}))}var tu=new pe,ru=function(){return Un},da=function(){if(Un!=="deferred"||!Ma)throw new Error("rtl-text-plugin cannot be downloaded unless a pluginURL is specified");Un="loading",bs(),Ma&&ri({url:Ma},function(e){e?zc(e):(Un="loaded",bs())})},Qn={applyArabicShaping:null,processBidirectionalText:null,processStyledBidirectionalText:null,isLoaded:function(){return Un==="loaded"||Qn.applyArabicShaping!=null},isLoading:function(){return Un==="loading"},setState:function(e){Un=e.pluginStatus,Ma=e.pluginURL},isParsed:function(){return Qn.applyArabicShaping!=null&&Qn.processBidirectionalText!=null&&Qn.processStyledBidirectionalText!=null},getPluginURL:function(){return Ma}},ur=function(e,t){this.zoom=e,t?(this.now=t.now,this.fadeDuration=t.fadeDuration,this.zoomHistory=t.zoomHistory,this.transition=t.transition):(this.now=0,this.fadeDuration=0,this.zoomHistory=new Ql,this.transition={})};ur.prototype.isSupportedScript=function(e){return function(t,i){for(var l=0,f=t;l<f.length;l+=1)if(!Nn(f[l].charCodeAt(0),i))return!1;return!0}(e,Qn.isLoaded())},ur.prototype.crossFadingFactor=function(){return this.fadeDuration===0?1:Math.min((this.now-this.zoomHistory.lastIntegerZoomTime)/this.fadeDuration,1)},ur.prototype.getCrossfadeParameters=function(){var e=this.zoom,t=e-Math.floor(e),i=this.crossFadingFactor();return e>this.zoomHistory.lastIntegerZoom?{fromScale:2,toScale:1,t:t+(1-t)*i}:{fromScale:.5,toScale:1,t:1-(1-i)*t}};var Ea=function(e,t){this.property=e,this.value=t,this.expression=function(i,l){if(Vs(i))return new Vo(i,l);if(hs(i)){var f=_c(i,l);if(f.result==="error")throw new Error(f.value.map(function(x){return x.key+": "+x.message}).join(", "));return f.value}var m=i;return typeof i=="string"&&l.type==="color"&&(m=pr.parse(i)),{kind:"constant",evaluate:function(){return m}}}(t===void 0?e.specification.default:t,e.specification)};Ea.prototype.isDataDriven=function(){return this.expression.kind==="source"||this.expression.kind==="composite"},Ea.prototype.possiblyEvaluate=function(e,t,i){return this.property.possiblyEvaluate(this,e,t,i)};var na=function(e){this.property=e,this.value=new Ea(e,void 0)};na.prototype.transitioned=function(e,t){return new ko(this.property,this.value,t,we({},e.transition,this.transition),e.now)},na.prototype.untransitioned=function(){return new ko(this.property,this.value,null,{},0)};var nn=function(e){this._properties=e,this._values=Object.create(e.defaultTransitionablePropertyValues)};nn.prototype.getValue=function(e){return Ze(this._values[e].value.value)},nn.prototype.setValue=function(e,t){this._values.hasOwnProperty(e)||(this._values[e]=new na(this._values[e].property)),this._values[e].value=new Ea(this._values[e].property,t===null?void 0:Ze(t))},nn.prototype.getTransition=function(e){return Ze(this._values[e].transition)},nn.prototype.setTransition=function(e,t){this._values.hasOwnProperty(e)||(this._values[e]=new na(this._values[e].property)),this._values[e].transition=Ze(t)||void 0},nn.prototype.serialize=function(){for(var e={},t=0,i=Object.keys(this._values);t<i.length;t+=1){var l=i[t],f=this.getValue(l);f!==void 0&&(e[l]=f);var m=this.getTransition(l);m!==void 0&&(e[l+"-transition"]=m)}return e},nn.prototype.transitioned=function(e,t){for(var i=new Xa(this._properties),l=0,f=Object.keys(this._values);l<f.length;l+=1){var m=f[l];i._values[m]=this._values[m].transitioned(e,t._values[m])}return i},nn.prototype.untransitioned=function(){for(var e=new Xa(this._properties),t=0,i=Object.keys(this._values);t<i.length;t+=1){var l=i[t];e._values[l]=this._values[l].untransitioned()}return e};var ko=function(e,t,i,l,f){this.property=e,this.value=t,this.begin=f+l.delay||0,this.end=this.begin+l.duration||0,e.specification.transition&&(l.delay||l.duration)&&(this.prior=i)};ko.prototype.possiblyEvaluate=function(e,t,i){var l=e.now||0,f=this.value.possiblyEvaluate(e,t,i),m=this.prior;if(m){if(l>this.end)return this.prior=null,f;if(this.value.isDataDriven())return this.prior=null,f;if(l<this.begin)return m.possiblyEvaluate(e,t,i);var x=(l-this.begin)/(this.end-this.begin);return this.property.interpolate(m.possiblyEvaluate(e,t,i),f,function(k){if(k<=0)return 0;if(k>=1)return 1;var I=k*k,A=I*k;return 4*(k<.5?A:3*(k-I)+A-.75)}(x))}return f};var Xa=function(e){this._properties=e,this._values=Object.create(e.defaultTransitioningPropertyValues)};Xa.prototype.possiblyEvaluate=function(e,t,i){for(var l=new xs(this._properties),f=0,m=Object.keys(this._values);f<m.length;f+=1){var x=m[f];l._values[x]=this._values[x].possiblyEvaluate(e,t,i)}return l},Xa.prototype.hasTransition=function(){for(var e=0,t=Object.keys(this._values);e<t.length;e+=1)if(this._values[t[e]].prior)return!0;return!1};var ma=function(e){this._properties=e,this._values=Object.create(e.defaultPropertyValues)};ma.prototype.getValue=function(e){return Ze(this._values[e].value)},ma.prototype.setValue=function(e,t){this._values[e]=new Ea(this._values[e].property,t===null?void 0:Ze(t))},ma.prototype.serialize=function(){for(var e={},t=0,i=Object.keys(this._values);t<i.length;t+=1){var l=i[t],f=this.getValue(l);f!==void 0&&(e[l]=f)}return e},ma.prototype.possiblyEvaluate=function(e,t,i){for(var l=new xs(this._properties),f=0,m=Object.keys(this._values);f<m.length;f+=1){var x=m[f];l._values[x]=this._values[x].possiblyEvaluate(e,t,i)}return l};var vn=function(e,t,i){this.property=e,this.value=t,this.parameters=i};vn.prototype.isConstant=function(){return this.value.kind==="constant"},vn.prototype.constantOr=function(e){return this.value.kind==="constant"?this.value.value:e},vn.prototype.evaluate=function(e,t,i,l){return this.property.evaluate(this.value,this.parameters,e,t,i,l)};var xs=function(e){this._properties=e,this._values=Object.create(e.defaultPossiblyEvaluatedValues)};xs.prototype.get=function(e){return this._values[e]};var St=function(e){this.specification=e};St.prototype.possiblyEvaluate=function(e,t){return e.expression.evaluate(t)},St.prototype.interpolate=function(e,t,i){var l=Oo[this.specification.type];return l?l(e,t,i):e};var gt=function(e,t){this.specification=e,this.overrides=t};gt.prototype.possiblyEvaluate=function(e,t,i,l){return new vn(this,e.expression.kind==="constant"||e.expression.kind==="camera"?{kind:"constant",value:e.expression.evaluate(t,null,{},i,l)}:e.expression,t)},gt.prototype.interpolate=function(e,t,i){if(e.value.kind!=="constant"||t.value.kind!=="constant")return e;if(e.value.value===void 0||t.value.value===void 0)return new vn(this,{kind:"constant",value:void 0},e.parameters);var l=Oo[this.specification.type];return l?new vn(this,{kind:"constant",value:l(e.value.value,t.value.value,i)},e.parameters):e},gt.prototype.evaluate=function(e,t,i,l,f,m){return e.kind==="constant"?e.value:e.evaluate(t,i,l,f,m)};var $s=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.possiblyEvaluate=function(i,l,f,m){if(i.value===void 0)return new vn(this,{kind:"constant",value:void 0},l);if(i.expression.kind==="constant"){var x=i.expression.evaluate(l,null,{},f,m),k=i.property.specification.type==="resolvedImage"&&typeof x!="string"?x.name:x,I=this._calculate(k,k,k,l);return new vn(this,{kind:"constant",value:I},l)}if(i.expression.kind==="camera"){var A=this._calculate(i.expression.evaluate({zoom:l.zoom-1}),i.expression.evaluate({zoom:l.zoom}),i.expression.evaluate({zoom:l.zoom+1}),l);return new vn(this,{kind:"constant",value:A},l)}return new vn(this,i.expression,l)},t.prototype.evaluate=function(i,l,f,m,x,k){if(i.kind==="source"){var I=i.evaluate(l,f,m,x,k);return this._calculate(I,I,I,l)}return i.kind==="composite"?this._calculate(i.evaluate({zoom:Math.floor(l.zoom)-1},f,m),i.evaluate({zoom:Math.floor(l.zoom)},f,m),i.evaluate({zoom:Math.floor(l.zoom)+1},f,m),l):i.value},t.prototype._calculate=function(i,l,f,m){return m.zoom>m.zoomHistory.lastIntegerZoom?{from:i,to:l}:{from:f,to:l}},t.prototype.interpolate=function(i){return i},t}(gt),bn=function(e){this.specification=e};bn.prototype.possiblyEvaluate=function(e,t,i,l){if(e.value!==void 0){if(e.expression.kind==="constant"){var f=e.expression.evaluate(t,null,{},i,l);return this._calculate(f,f,f,t)}return this._calculate(e.expression.evaluate(new ur(Math.floor(t.zoom-1),t)),e.expression.evaluate(new ur(Math.floor(t.zoom),t)),e.expression.evaluate(new ur(Math.floor(t.zoom+1),t)),t)}},bn.prototype._calculate=function(e,t,i,l){return l.zoom>l.zoomHistory.lastIntegerZoom?{from:e,to:t}:{from:i,to:t}},bn.prototype.interpolate=function(e){return e};var ya=function(e){this.specification=e};ya.prototype.possiblyEvaluate=function(e,t,i,l){return!!e.expression.evaluate(t,null,{},i,l)},ya.prototype.interpolate=function(){return!1};var an=function(e){for(var t in this.properties=e,this.defaultPropertyValues={},this.defaultTransitionablePropertyValues={},this.defaultTransitioningPropertyValues={},this.defaultPossiblyEvaluatedValues={},this.overridableProperties=[],e){var i=e[t];i.specification.overridable&&this.overridableProperties.push(t);var l=this.defaultPropertyValues[t]=new Ea(i,void 0),f=this.defaultTransitionablePropertyValues[t]=new na(i);this.defaultTransitioningPropertyValues[t]=f.untransitioned(),this.defaultPossiblyEvaluatedValues[t]=l.possiblyEvaluate({})}};ft("DataDrivenProperty",gt),ft("DataConstantProperty",St),ft("CrossFadedDataDrivenProperty",$s),ft("CrossFadedProperty",bn),ft("ColorRampProperty",ya);var za=function(e){function t(i,l){if(e.call(this),this.id=i.id,this.type=i.type,this._featureFilter={filter:function(){return!0},needGeometry:!1},i.type!=="custom"&&(this.metadata=(i=i).metadata,this.minzoom=i.minzoom,this.maxzoom=i.maxzoom,i.type!=="background"&&(this.source=i.source,this.sourceLayer=i["source-layer"],this.filter=i.filter),l.layout&&(this._unevaluatedLayout=new ma(l.layout)),l.paint)){for(var f in this._transitionablePaint=new nn(l.paint),i.paint)this.setPaintProperty(f,i.paint[f],{validate:!1});for(var m in i.layout)this.setLayoutProperty(m,i.layout[m],{validate:!1});this._transitioningPaint=this._transitionablePaint.untransitioned(),this.paint=new xs(l.paint)}}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.getCrossfadeParameters=function(){return this._crossfadeParameters},t.prototype.getLayoutProperty=function(i){return i==="visibility"?this.visibility:this._unevaluatedLayout.getValue(i)},t.prototype.setLayoutProperty=function(i,l,f){f===void 0&&(f={}),l!=null&&this._validate(gs,"layers."+this.id+".layout."+i,i,l,f)||(i!=="visibility"?this._unevaluatedLayout.setValue(i,l):this.visibility=l)},t.prototype.getPaintProperty=function(i){return Ue(i,"-transition")?this._transitionablePaint.getTransition(i.slice(0,-11)):this._transitionablePaint.getValue(i)},t.prototype.setPaintProperty=function(i,l,f){if(f===void 0&&(f={}),l!=null&&this._validate(Hh,"layers."+this.id+".paint."+i,i,l,f))return!1;if(Ue(i,"-transition"))return this._transitionablePaint.setTransition(i.slice(0,-11),l||void 0),!1;var m=this._transitionablePaint._values[i],x=m.property.specification["property-type"]==="cross-faded-data-driven",k=m.value.isDataDriven(),I=m.value;this._transitionablePaint.setValue(i,l),this._handleSpecialPaintPropertyUpdate(i);var A=this._transitionablePaint._values[i].value;return A.isDataDriven()||k||x||this._handleOverridablePaintPropertyUpdate(i,I,A)},t.prototype._handleSpecialPaintPropertyUpdate=function(i){},t.prototype._handleOverridablePaintPropertyUpdate=function(i,l,f){return!1},t.prototype.isHidden=function(i){return!!(this.minzoom&&i<this.minzoom)||!!(this.maxzoom&&i>=this.maxzoom)||this.visibility==="none"},t.prototype.updateTransitions=function(i){this._transitioningPaint=this._transitionablePaint.transitioned(i,this._transitioningPaint)},t.prototype.hasTransition=function(){return this._transitioningPaint.hasTransition()},t.prototype.recalculate=function(i,l){i.getCrossfadeParameters&&(this._crossfadeParameters=i.getCrossfadeParameters()),this._unevaluatedLayout&&(this.layout=this._unevaluatedLayout.possiblyEvaluate(i,void 0,l)),this.paint=this._transitioningPaint.possiblyEvaluate(i,void 0,l)},t.prototype.serialize=function(){var i={id:this.id,type:this.type,source:this.source,"source-layer":this.sourceLayer,metadata:this.metadata,minzoom:this.minzoom,maxzoom:this.maxzoom,filter:this.filter,layout:this._unevaluatedLayout&&this._unevaluatedLayout.serialize(),paint:this._transitionablePaint&&this._transitionablePaint.serialize()};return this.visibility&&(i.layout=i.layout||{},i.layout.visibility=this.visibility),mt(i,function(l,f){return!(l===void 0||f==="layout"&&!Object.keys(l).length||f==="paint"&&!Object.keys(l).length)})},t.prototype._validate=function(i,l,f,m,x){return x===void 0&&(x={}),(!x||x.validate!==!1)&&_s(this,i.call(ys,{key:l,layerType:this.type,objectKey:f,value:m,styleSpec:q,style:{glyphs:!0,sprite:!0}}))},t.prototype.is3D=function(){return!1},t.prototype.isTileClipped=function(){return!1},t.prototype.hasOffscreenPass=function(){return!1},t.prototype.resize=function(){},t.prototype.isStateDependent=function(){for(var i in this.paint._values){var l=this.paint.get(i);if(l instanceof vn&&bo(l.property.specification)&&(l.value.kind==="source"||l.value.kind==="composite")&&l.value.isStateDependent)return!0}return!1},t}(pe),iu={Int8:Int8Array,Uint8:Uint8Array,Int16:Int16Array,Uint16:Uint16Array,Int32:Int32Array,Uint32:Uint32Array,Float32:Float32Array},el=function(e,t){this._structArray=e,this._pos1=t*this.size,this._pos2=this._pos1/2,this._pos4=this._pos1/4,this._pos8=this._pos1/8},Ir=function(){this.isTransferred=!1,this.capacity=-1,this.resize(0)};function Xi(e,t){t===void 0&&(t=1);var i=0,l=0;return{members:e.map(function(f){var m=iu[f.type].BYTES_PER_ELEMENT,x=i=Tc(i,Math.max(t,m)),k=f.components||1;return l=Math.max(l,m),i+=m*k,{name:f.name,type:f.type,components:k,offset:x}}),size:Tc(i,Math.max(l,t)),alignment:t}}function Tc(e,t){return Math.ceil(e/t)*t}Ir.serialize=function(e,t){return e._trim(),t&&(e.isTransferred=!0,t.push(e.arrayBuffer)),{length:e.length,arrayBuffer:e.arrayBuffer}},Ir.deserialize=function(e){var t=Object.create(this.prototype);return t.arrayBuffer=e.arrayBuffer,t.length=e.length,t.capacity=e.arrayBuffer.byteLength/t.bytesPerElement,t._refreshViews(),t},Ir.prototype._trim=function(){this.length!==this.capacity&&(this.capacity=this.length,this.arrayBuffer=this.arrayBuffer.slice(0,this.length*this.bytesPerElement),this._refreshViews())},Ir.prototype.clear=function(){this.length=0},Ir.prototype.resize=function(e){this.reserve(e),this.length=e},Ir.prototype.reserve=function(e){if(e>this.capacity){this.capacity=Math.max(e,Math.floor(5*this.capacity),128),this.arrayBuffer=new ArrayBuffer(this.capacity*this.bytesPerElement);var t=this.uint8;this._refreshViews(),t&&this.uint8.set(t)}},Ir.prototype._refreshViews=function(){throw new Error("_refreshViews() must be implemented by each concrete StructArray layout")};var Eo=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},t.prototype.emplaceBack=function(i,l){var f=this.length;return this.resize(f+1),this.emplace(f,i,l)},t.prototype.emplace=function(i,l,f){var m=2*i;return this.int16[m+0]=l,this.int16[m+1]=f,i},t}(Ir);Eo.prototype.bytesPerElement=4,ft("StructArrayLayout2i4",Eo);var nu=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},t.prototype.emplaceBack=function(i,l,f,m){var x=this.length;return this.resize(x+1),this.emplace(x,i,l,f,m)},t.prototype.emplace=function(i,l,f,m,x){var k=4*i;return this.int16[k+0]=l,this.int16[k+1]=f,this.int16[k+2]=m,this.int16[k+3]=x,i},t}(Ir);nu.prototype.bytesPerElement=8,ft("StructArrayLayout4i8",nu);var Da=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},t.prototype.emplaceBack=function(i,l,f,m,x,k){var I=this.length;return this.resize(I+1),this.emplace(I,i,l,f,m,x,k)},t.prototype.emplace=function(i,l,f,m,x,k,I){var A=6*i;return this.int16[A+0]=l,this.int16[A+1]=f,this.int16[A+2]=m,this.int16[A+3]=x,this.int16[A+4]=k,this.int16[A+5]=I,i},t}(Ir);Da.prototype.bytesPerElement=12,ft("StructArrayLayout2i4i12",Da);var Vn=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},t.prototype.emplaceBack=function(i,l,f,m,x,k){var I=this.length;return this.resize(I+1),this.emplace(I,i,l,f,m,x,k)},t.prototype.emplace=function(i,l,f,m,x,k,I){var A=4*i,C=8*i;return this.int16[A+0]=l,this.int16[A+1]=f,this.uint8[C+4]=m,this.uint8[C+5]=x,this.uint8[C+6]=k,this.uint8[C+7]=I,i},t}(Ir);Vn.prototype.bytesPerElement=8,ft("StructArrayLayout2i4ub8",Vn);var Zo=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},t.prototype.emplaceBack=function(i,l){var f=this.length;return this.resize(f+1),this.emplace(f,i,l)},t.prototype.emplace=function(i,l,f){var m=2*i;return this.float32[m+0]=l,this.float32[m+1]=f,i},t}(Ir);Zo.prototype.bytesPerElement=8,ft("StructArrayLayout2f8",Zo);var Ta=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},t.prototype.emplaceBack=function(i,l,f,m,x,k,I,A,C,B){var U=this.length;return this.resize(U+1),this.emplace(U,i,l,f,m,x,k,I,A,C,B)},t.prototype.emplace=function(i,l,f,m,x,k,I,A,C,B,U){var j=10*i;return this.uint16[j+0]=l,this.uint16[j+1]=f,this.uint16[j+2]=m,this.uint16[j+3]=x,this.uint16[j+4]=k,this.uint16[j+5]=I,this.uint16[j+6]=A,this.uint16[j+7]=C,this.uint16[j+8]=B,this.uint16[j+9]=U,i},t}(Ir);Ta.prototype.bytesPerElement=20,ft("StructArrayLayout10ui20",Ta);var tl=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},t.prototype.emplaceBack=function(i,l,f,m,x,k,I,A,C,B,U,j){var J=this.length;return this.resize(J+1),this.emplace(J,i,l,f,m,x,k,I,A,C,B,U,j)},t.prototype.emplace=function(i,l,f,m,x,k,I,A,C,B,U,j,J){var Q=12*i;return this.int16[Q+0]=l,this.int16[Q+1]=f,this.int16[Q+2]=m,this.int16[Q+3]=x,this.uint16[Q+4]=k,this.uint16[Q+5]=I,this.uint16[Q+6]=A,this.uint16[Q+7]=C,this.int16[Q+8]=B,this.int16[Q+9]=U,this.int16[Q+10]=j,this.int16[Q+11]=J,i},t}(Ir);tl.prototype.bytesPerElement=24,ft("StructArrayLayout4i4ui4i24",tl);var Go=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},t.prototype.emplaceBack=function(i,l,f){var m=this.length;return this.resize(m+1),this.emplace(m,i,l,f)},t.prototype.emplace=function(i,l,f,m){var x=3*i;return this.float32[x+0]=l,this.float32[x+1]=f,this.float32[x+2]=m,i},t}(Ir);Go.prototype.bytesPerElement=12,ft("StructArrayLayout3f12",Go);var ws=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)},t.prototype.emplaceBack=function(i){var l=this.length;return this.resize(l+1),this.emplace(l,i)},t.prototype.emplace=function(i,l){return this.uint32[1*i+0]=l,i},t}(Ir);ws.prototype.bytesPerElement=4,ft("StructArrayLayout1ul4",ws);var au=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},t.prototype.emplaceBack=function(i,l,f,m,x,k,I,A,C){var B=this.length;return this.resize(B+1),this.emplace(B,i,l,f,m,x,k,I,A,C)},t.prototype.emplace=function(i,l,f,m,x,k,I,A,C,B){var U=10*i,j=5*i;return this.int16[U+0]=l,this.int16[U+1]=f,this.int16[U+2]=m,this.int16[U+3]=x,this.int16[U+4]=k,this.int16[U+5]=I,this.uint32[j+3]=A,this.uint16[U+8]=C,this.uint16[U+9]=B,i},t}(Ir);au.prototype.bytesPerElement=20,ft("StructArrayLayout6i1ul2ui20",au);var Ko=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},t.prototype.emplaceBack=function(i,l,f,m,x,k){var I=this.length;return this.resize(I+1),this.emplace(I,i,l,f,m,x,k)},t.prototype.emplace=function(i,l,f,m,x,k,I){var A=6*i;return this.int16[A+0]=l,this.int16[A+1]=f,this.int16[A+2]=m,this.int16[A+3]=x,this.int16[A+4]=k,this.int16[A+5]=I,i},t}(Ir);Ko.prototype.bytesPerElement=12,ft("StructArrayLayout2i2i2i12",Ko);var zo=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},t.prototype.emplaceBack=function(i,l,f,m,x){var k=this.length;return this.resize(k+1),this.emplace(k,i,l,f,m,x)},t.prototype.emplace=function(i,l,f,m,x,k){var I=4*i,A=8*i;return this.float32[I+0]=l,this.float32[I+1]=f,this.float32[I+2]=m,this.int16[A+6]=x,this.int16[A+7]=k,i},t}(Ir);zo.prototype.bytesPerElement=16,ft("StructArrayLayout2f1f2i16",zo);var ou=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},t.prototype.emplaceBack=function(i,l,f,m){var x=this.length;return this.resize(x+1),this.emplace(x,i,l,f,m)},t.prototype.emplace=function(i,l,f,m,x){var k=12*i,I=3*i;return this.uint8[k+0]=l,this.uint8[k+1]=f,this.float32[I+1]=m,this.float32[I+2]=x,i},t}(Ir);ou.prototype.bytesPerElement=12,ft("StructArrayLayout2ub2f12",ou);var Wa=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},t.prototype.emplaceBack=function(i,l,f){var m=this.length;return this.resize(m+1),this.emplace(m,i,l,f)},t.prototype.emplace=function(i,l,f,m){var x=3*i;return this.uint16[x+0]=l,this.uint16[x+1]=f,this.uint16[x+2]=m,i},t}(Ir);Wa.prototype.bytesPerElement=6,ft("StructArrayLayout3ui6",Wa);var Ya=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},t.prototype.emplaceBack=function(i,l,f,m,x,k,I,A,C,B,U,j,J,Q,he,ie,me){var be=this.length;return this.resize(be+1),this.emplace(be,i,l,f,m,x,k,I,A,C,B,U,j,J,Q,he,ie,me)},t.prototype.emplace=function(i,l,f,m,x,k,I,A,C,B,U,j,J,Q,he,ie,me,be){var Se=24*i,Ee=12*i,Ce=48*i;return this.int16[Se+0]=l,this.int16[Se+1]=f,this.uint16[Se+2]=m,this.uint16[Se+3]=x,this.uint32[Ee+2]=k,this.uint32[Ee+3]=I,this.uint32[Ee+4]=A,this.uint16[Se+10]=C,this.uint16[Se+11]=B,this.uint16[Se+12]=U,this.float32[Ee+7]=j,this.float32[Ee+8]=J,this.uint8[Ce+36]=Q,this.uint8[Ce+37]=he,this.uint8[Ce+38]=ie,this.uint32[Ee+10]=me,this.int16[Se+22]=be,i},t}(Ir);Ya.prototype.bytesPerElement=48,ft("StructArrayLayout2i2ui3ul3ui2f3ub1ul1i48",Ya);var rl=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},t.prototype.emplaceBack=function(i,l,f,m,x,k,I,A,C,B,U,j,J,Q,he,ie,me,be,Se,Ee,Ce,Ve,Je,bt,nt,Et,at,$t){var Dt=this.length;return this.resize(Dt+1),this.emplace(Dt,i,l,f,m,x,k,I,A,C,B,U,j,J,Q,he,ie,me,be,Se,Ee,Ce,Ve,Je,bt,nt,Et,at,$t)},t.prototype.emplace=function(i,l,f,m,x,k,I,A,C,B,U,j,J,Q,he,ie,me,be,Se,Ee,Ce,Ve,Je,bt,nt,Et,at,$t,Dt){var _t=34*i,lr=17*i;return this.int16[_t+0]=l,this.int16[_t+1]=f,this.int16[_t+2]=m,this.int16[_t+3]=x,this.int16[_t+4]=k,this.int16[_t+5]=I,this.int16[_t+6]=A,this.int16[_t+7]=C,this.uint16[_t+8]=B,this.uint16[_t+9]=U,this.uint16[_t+10]=j,this.uint16[_t+11]=J,this.uint16[_t+12]=Q,this.uint16[_t+13]=he,this.uint16[_t+14]=ie,this.uint16[_t+15]=me,this.uint16[_t+16]=be,this.uint16[_t+17]=Se,this.uint16[_t+18]=Ee,this.uint16[_t+19]=Ce,this.uint16[_t+20]=Ve,this.uint16[_t+21]=Je,this.uint16[_t+22]=bt,this.uint32[lr+12]=nt,this.float32[lr+13]=Et,this.float32[lr+14]=at,this.float32[lr+15]=$t,this.float32[lr+16]=Dt,i},t}(Ir);rl.prototype.bytesPerElement=68,ft("StructArrayLayout8i15ui1ul4f68",rl);var Ja=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},t.prototype.emplaceBack=function(i){var l=this.length;return this.resize(l+1),this.emplace(l,i)},t.prototype.emplace=function(i,l){return this.float32[1*i+0]=l,i},t}(Ir);Ja.prototype.bytesPerElement=4,ft("StructArrayLayout1f4",Ja);var aa=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},t.prototype.emplaceBack=function(i,l,f){var m=this.length;return this.resize(m+1),this.emplace(m,i,l,f)},t.prototype.emplace=function(i,l,f,m){var x=3*i;return this.int16[x+0]=l,this.int16[x+1]=f,this.int16[x+2]=m,i},t}(Ir);aa.prototype.bytesPerElement=6,ft("StructArrayLayout3i6",aa);var su=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},t.prototype.emplaceBack=function(i,l,f){var m=this.length;return this.resize(m+1),this.emplace(m,i,l,f)},t.prototype.emplace=function(i,l,f,m){var x=4*i;return this.uint32[2*i+0]=l,this.uint16[x+2]=f,this.uint16[x+3]=m,i},t}(Ir);su.prototype.bytesPerElement=8,ft("StructArrayLayout1ul2ui8",su);var Ss=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},t.prototype.emplaceBack=function(i,l){var f=this.length;return this.resize(f+1),this.emplace(f,i,l)},t.prototype.emplace=function(i,l,f){var m=2*i;return this.uint16[m+0]=l,this.uint16[m+1]=f,i},t}(Ir);Ss.prototype.bytesPerElement=4,ft("StructArrayLayout2ui4",Ss);var lu=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},t.prototype.emplaceBack=function(i){var l=this.length;return this.resize(l+1),this.emplace(l,i)},t.prototype.emplace=function(i,l){return this.uint16[1*i+0]=l,i},t}(Ir);lu.prototype.bytesPerElement=2,ft("StructArrayLayout1ui2",lu);var il=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},t.prototype.emplaceBack=function(i,l,f,m){var x=this.length;return this.resize(x+1),this.emplace(x,i,l,f,m)},t.prototype.emplace=function(i,l,f,m,x){var k=4*i;return this.float32[k+0]=l,this.float32[k+1]=f,this.float32[k+2]=m,this.float32[k+3]=x,i},t}(Ir);il.prototype.bytesPerElement=16,ft("StructArrayLayout4f16",il);var n=function(e){function t(){e.apply(this,arguments)}e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t;var i={anchorPointX:{configurable:!0},anchorPointY:{configurable:!0},x1:{configurable:!0},y1:{configurable:!0},x2:{configurable:!0},y2:{configurable:!0},featureIndex:{configurable:!0},sourceLayerIndex:{configurable:!0},bucketIndex:{configurable:!0},anchorPoint:{configurable:!0}};return i.anchorPointX.get=function(){return this._structArray.int16[this._pos2+0]},i.anchorPointY.get=function(){return this._structArray.int16[this._pos2+1]},i.x1.get=function(){return this._structArray.int16[this._pos2+2]},i.y1.get=function(){return this._structArray.int16[this._pos2+3]},i.x2.get=function(){return this._structArray.int16[this._pos2+4]},i.y2.get=function(){return this._structArray.int16[this._pos2+5]},i.featureIndex.get=function(){return this._structArray.uint32[this._pos4+3]},i.sourceLayerIndex.get=function(){return this._structArray.uint16[this._pos2+8]},i.bucketIndex.get=function(){return this._structArray.uint16[this._pos2+9]},i.anchorPoint.get=function(){return new F(this.anchorPointX,this.anchorPointY)},Object.defineProperties(t.prototype,i),t}(el);n.prototype.size=20;var s=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.get=function(i){return new n(this,i)},t}(au);ft("CollisionBoxArray",s);var o=function(e){function t(){e.apply(this,arguments)}e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t;var i={anchorX:{configurable:!0},anchorY:{configurable:!0},glyphStartIndex:{configurable:!0},numGlyphs:{configurable:!0},vertexStartIndex:{configurable:!0},lineStartIndex:{configurable:!0},lineLength:{configurable:!0},segment:{configurable:!0},lowerSize:{configurable:!0},upperSize:{configurable:!0},lineOffsetX:{configurable:!0},lineOffsetY:{configurable:!0},writingMode:{configurable:!0},placedOrientation:{configurable:!0},hidden:{configurable:!0},crossTileID:{configurable:!0},associatedIconIndex:{configurable:!0}};return i.anchorX.get=function(){return this._structArray.int16[this._pos2+0]},i.anchorY.get=function(){return this._structArray.int16[this._pos2+1]},i.glyphStartIndex.get=function(){return this._structArray.uint16[this._pos2+2]},i.numGlyphs.get=function(){return this._structArray.uint16[this._pos2+3]},i.vertexStartIndex.get=function(){return this._structArray.uint32[this._pos4+2]},i.lineStartIndex.get=function(){return this._structArray.uint32[this._pos4+3]},i.lineLength.get=function(){return this._structArray.uint32[this._pos4+4]},i.segment.get=function(){return this._structArray.uint16[this._pos2+10]},i.lowerSize.get=function(){return this._structArray.uint16[this._pos2+11]},i.upperSize.get=function(){return this._structArray.uint16[this._pos2+12]},i.lineOffsetX.get=function(){return this._structArray.float32[this._pos4+7]},i.lineOffsetY.get=function(){return this._structArray.float32[this._pos4+8]},i.writingMode.get=function(){return this._structArray.uint8[this._pos1+36]},i.placedOrientation.get=function(){return this._structArray.uint8[this._pos1+37]},i.placedOrientation.set=function(l){this._structArray.uint8[this._pos1+37]=l},i.hidden.get=function(){return this._structArray.uint8[this._pos1+38]},i.hidden.set=function(l){this._structArray.uint8[this._pos1+38]=l},i.crossTileID.get=function(){return this._structArray.uint32[this._pos4+10]},i.crossTileID.set=function(l){this._structArray.uint32[this._pos4+10]=l},i.associatedIconIndex.get=function(){return this._structArray.int16[this._pos2+22]},Object.defineProperties(t.prototype,i),t}(el);o.prototype.size=48;var c=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.get=function(i){return new o(this,i)},t}(Ya);ft("PlacedSymbolArray",c);var _=function(e){function t(){e.apply(this,arguments)}e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t;var i={anchorX:{configurable:!0},anchorY:{configurable:!0},rightJustifiedTextSymbolIndex:{configurable:!0},centerJustifiedTextSymbolIndex:{configurable:!0},leftJustifiedTextSymbolIndex:{configurable:!0},verticalPlacedTextSymbolIndex:{configurable:!0},placedIconSymbolIndex:{configurable:!0},verticalPlacedIconSymbolIndex:{configurable:!0},key:{configurable:!0},textBoxStartIndex:{configurable:!0},textBoxEndIndex:{configurable:!0},verticalTextBoxStartIndex:{configurable:!0},verticalTextBoxEndIndex:{configurable:!0},iconBoxStartIndex:{configurable:!0},iconBoxEndIndex:{configurable:!0},verticalIconBoxStartIndex:{configurable:!0},verticalIconBoxEndIndex:{configurable:!0},featureIndex:{configurable:!0},numHorizontalGlyphVertices:{configurable:!0},numVerticalGlyphVertices:{configurable:!0},numIconVertices:{configurable:!0},numVerticalIconVertices:{configurable:!0},useRuntimeCollisionCircles:{configurable:!0},crossTileID:{configurable:!0},textBoxScale:{configurable:!0},textOffset0:{configurable:!0},textOffset1:{configurable:!0},collisionCircleDiameter:{configurable:!0}};return i.anchorX.get=function(){return this._structArray.int16[this._pos2+0]},i.anchorY.get=function(){return this._structArray.int16[this._pos2+1]},i.rightJustifiedTextSymbolIndex.get=function(){return this._structArray.int16[this._pos2+2]},i.centerJustifiedTextSymbolIndex.get=function(){return this._structArray.int16[this._pos2+3]},i.leftJustifiedTextSymbolIndex.get=function(){return this._structArray.int16[this._pos2+4]},i.verticalPlacedTextSymbolIndex.get=function(){return this._structArray.int16[this._pos2+5]},i.placedIconSymbolIndex.get=function(){return this._structArray.int16[this._pos2+6]},i.verticalPlacedIconSymbolIndex.get=function(){return this._structArray.int16[this._pos2+7]},i.key.get=function(){return this._structArray.uint16[this._pos2+8]},i.textBoxStartIndex.get=function(){return this._structArray.uint16[this._pos2+9]},i.textBoxEndIndex.get=function(){return this._structArray.uint16[this._pos2+10]},i.verticalTextBoxStartIndex.get=function(){return this._structArray.uint16[this._pos2+11]},i.verticalTextBoxEndIndex.get=function(){return this._structArray.uint16[this._pos2+12]},i.iconBoxStartIndex.get=function(){return this._structArray.uint16[this._pos2+13]},i.iconBoxEndIndex.get=function(){return this._structArray.uint16[this._pos2+14]},i.verticalIconBoxStartIndex.get=function(){return this._structArray.uint16[this._pos2+15]},i.verticalIconBoxEndIndex.get=function(){return this._structArray.uint16[this._pos2+16]},i.featureIndex.get=function(){return this._structArray.uint16[this._pos2+17]},i.numHorizontalGlyphVertices.get=function(){return this._structArray.uint16[this._pos2+18]},i.numVerticalGlyphVertices.get=function(){return this._structArray.uint16[this._pos2+19]},i.numIconVertices.get=function(){return this._structArray.uint16[this._pos2+20]},i.numVerticalIconVertices.get=function(){return this._structArray.uint16[this._pos2+21]},i.useRuntimeCollisionCircles.get=function(){return this._structArray.uint16[this._pos2+22]},i.crossTileID.get=function(){return this._structArray.uint32[this._pos4+12]},i.crossTileID.set=function(l){this._structArray.uint32[this._pos4+12]=l},i.textBoxScale.get=function(){return this._structArray.float32[this._pos4+13]},i.textOffset0.get=function(){return this._structArray.float32[this._pos4+14]},i.textOffset1.get=function(){return this._structArray.float32[this._pos4+15]},i.collisionCircleDiameter.get=function(){return this._structArray.float32[this._pos4+16]},Object.defineProperties(t.prototype,i),t}(el);_.prototype.size=68;var w=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.get=function(i){return new _(this,i)},t}(rl);ft("SymbolInstanceArray",w);var S=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.getoffsetX=function(i){return this.float32[1*i+0]},t}(Ja);ft("GlyphOffsetArray",S);var E=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.getx=function(i){return this.int16[3*i+0]},t.prototype.gety=function(i){return this.int16[3*i+1]},t.prototype.gettileUnitDistanceFromAnchor=function(i){return this.int16[3*i+2]},t}(aa);ft("SymbolLineVertexArray",E);var P=function(e){function t(){e.apply(this,arguments)}e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t;var i={featureIndex:{configurable:!0},sourceLayerIndex:{configurable:!0},bucketIndex:{configurable:!0}};return i.featureIndex.get=function(){return this._structArray.uint32[this._pos4+0]},i.sourceLayerIndex.get=function(){return this._structArray.uint16[this._pos2+2]},i.bucketIndex.get=function(){return this._structArray.uint16[this._pos2+3]},Object.defineProperties(t.prototype,i),t}(el);P.prototype.size=8;var O=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.get=function(i){return new P(this,i)},t}(su);ft("FeatureIndexArray",O);var Z=Xi([{name:"a_pos",components:2,type:"Int16"}],4).members,G=function(e){e===void 0&&(e=[]),this.segments=e};function H(e,t){return 256*(e=ve(Math.floor(e),0,255))+ve(Math.floor(t),0,255)}G.prototype.prepareSegment=function(e,t,i,l){var f=this.segments[this.segments.length-1];return e>G.MAX_VERTEX_ARRAY_LENGTH&&yt("Max vertices per segment is "+G.MAX_VERTEX_ARRAY_LENGTH+": bucket requested "+e),(!f||f.vertexLength+e>G.MAX_VERTEX_ARRAY_LENGTH||f.sortKey!==l)&&(f={vertexOffset:t.length,primitiveOffset:i.length,vertexLength:0,primitiveLength:0},l!==void 0&&(f.sortKey=l),this.segments.push(f)),f},G.prototype.get=function(){return this.segments},G.prototype.destroy=function(){for(var e=0,t=this.segments;e<t.length;e+=1){var i=t[e];for(var l in i.vaos)i.vaos[l].destroy()}},G.simpleSegment=function(e,t,i,l){return new G([{vertexOffset:e,primitiveOffset:t,vertexLength:i,primitiveLength:l,vaos:{},sortKey:0}])},G.MAX_VERTEX_ARRAY_LENGTH=Math.pow(2,16)-1,ft("SegmentVector",G);var te=Xi([{name:"a_pattern_from",components:4,type:"Uint16"},{name:"a_pattern_to",components:4,type:"Uint16"},{name:"a_pixel_ratio_from",components:1,type:"Uint16"},{name:"a_pixel_ratio_to",components:1,type:"Uint16"}]),$=T(function(e){e.exports=function(t,i){var l,f,m,x,k,I,A,C;for(f=t.length-(l=3&t.length),m=i,k=3432918353,I=461845907,C=0;C<f;)A=255&t.charCodeAt(C)|(255&t.charCodeAt(++C))<<8|(255&t.charCodeAt(++C))<<16|(255&t.charCodeAt(++C))<<24,++C,m=27492+(65535&(x=5*(65535&(m=(m^=A=(65535&(A=(A=(65535&A)*k+(((A>>>16)*k&65535)<<16)&4294967295)<<15|A>>>17))*I+(((A>>>16)*I&65535)<<16)&4294967295)<<13|m>>>19))+((5*(m>>>16)&65535)<<16)&4294967295))+((58964+(x>>>16)&65535)<<16);switch(A=0,l){case 3:A^=(255&t.charCodeAt(C+2))<<16;case 2:A^=(255&t.charCodeAt(C+1))<<8;case 1:m^=A=(65535&(A=(A=(65535&(A^=255&t.charCodeAt(C)))*k+(((A>>>16)*k&65535)<<16)&4294967295)<<15|A>>>17))*I+(((A>>>16)*I&65535)<<16)&4294967295}return m^=t.length,m=2246822507*(65535&(m^=m>>>16))+((2246822507*(m>>>16)&65535)<<16)&4294967295,m=3266489909*(65535&(m^=m>>>13))+((3266489909*(m>>>16)&65535)<<16)&4294967295,(m^=m>>>16)>>>0}}),ue=T(function(e){e.exports=function(t,i){for(var l,f=t.length,m=i^f,x=0;f>=4;)l=1540483477*(65535&(l=255&t.charCodeAt(x)|(255&t.charCodeAt(++x))<<8|(255&t.charCodeAt(++x))<<16|(255&t.charCodeAt(++x))<<24))+((1540483477*(l>>>16)&65535)<<16),m=1540483477*(65535&m)+((1540483477*(m>>>16)&65535)<<16)^(l=1540483477*(65535&(l^=l>>>24))+((1540483477*(l>>>16)&65535)<<16)),f-=4,++x;switch(f){case 3:m^=(255&t.charCodeAt(x+2))<<16;case 2:m^=(255&t.charCodeAt(x+1))<<8;case 1:m=1540483477*(65535&(m^=255&t.charCodeAt(x)))+((1540483477*(m>>>16)&65535)<<16)}return m=1540483477*(65535&(m^=m>>>13))+((1540483477*(m>>>16)&65535)<<16),(m^=m>>>15)>>>0}}),Y=$,le=ue;Y.murmur3=$,Y.murmur2=le;var fe=function(){this.ids=[],this.positions=[],this.indexed=!1};fe.prototype.add=function(e,t,i,l){this.ids.push(Te(e)),this.positions.push(t,i,l)},fe.prototype.getPositions=function(e){for(var t=Te(e),i=0,l=this.ids.length-1;i<l;){var f=i+l>>1;this.ids[f]>=t?l=f:i=f+1}for(var m=[];this.ids[i]===t;)m.push({index:this.positions[3*i],start:this.positions[3*i+1],end:this.positions[3*i+2]}),i++;return m},fe.serialize=function(e,t){var i=new Float64Array(e.ids),l=new Uint32Array(e.positions);return function f(m,x,k,I){for(;k<I;){for(var A=m[k+I>>1],C=k-1,B=I+1;;){do C++;while(m[C]<A);do B--;while(m[B]>A);if(C>=B)break;ke(m,C,B),ke(x,3*C,3*B),ke(x,3*C+1,3*B+1),ke(x,3*C+2,3*B+2)}B-k<I-B?(f(m,x,k,B),k=B+1):(f(m,x,B+1,I),I=B)}}(i,l,0,i.length-1),t&&t.push(i.buffer,l.buffer),{ids:i,positions:l}},fe.deserialize=function(e){var t=new fe;return t.ids=e.ids,t.positions=e.positions,t.indexed=!0,t};var _e=Math.pow(2,53)-1;function Te(e){var t=+e;return!isNaN(t)&&t<=_e?t:Y(String(e))}function ke(e,t,i){var l=e[t];e[t]=e[i],e[i]=l}ft("FeaturePositionMap",fe);var Ae=function(e,t){this.gl=e.gl,this.location=t},Oe=function(e){function t(i,l){e.call(this,i,l),this.current=0}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.set=function(i){this.current!==i&&(this.current=i,this.gl.uniform1i(this.location,i))},t}(Ae),He=function(e){function t(i,l){e.call(this,i,l),this.current=0}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.set=function(i){this.current!==i&&(this.current=i,this.gl.uniform1f(this.location,i))},t}(Ae),Ge=function(e){function t(i,l){e.call(this,i,l),this.current=[0,0]}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.set=function(i){i[0]===this.current[0]&&i[1]===this.current[1]||(this.current=i,this.gl.uniform2f(this.location,i[0],i[1]))},t}(Ae),lt=function(e){function t(i,l){e.call(this,i,l),this.current=[0,0,0]}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.set=function(i){i[0]===this.current[0]&&i[1]===this.current[1]&&i[2]===this.current[2]||(this.current=i,this.gl.uniform3f(this.location,i[0],i[1],i[2]))},t}(Ae),kt=function(e){function t(i,l){e.call(this,i,l),this.current=[0,0,0,0]}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.set=function(i){i[0]===this.current[0]&&i[1]===this.current[1]&&i[2]===this.current[2]&&i[3]===this.current[3]||(this.current=i,this.gl.uniform4f(this.location,i[0],i[1],i[2],i[3]))},t}(Ae),It=function(e){function t(i,l){e.call(this,i,l),this.current=pr.transparent}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.set=function(i){i.r===this.current.r&&i.g===this.current.g&&i.b===this.current.b&&i.a===this.current.a||(this.current=i,this.gl.uniform4f(this.location,i.r,i.g,i.b,i.a))},t}(Ae),Tt=new Float32Array(16),gr=function(e){function t(i,l){e.call(this,i,l),this.current=Tt}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.set=function(i){if(i[12]!==this.current[12]||i[0]!==this.current[0])return this.current=i,void this.gl.uniformMatrix4fv(this.location,!1,i);for(var l=1;l<16;l++)if(i[l]!==this.current[l]){this.current=i,this.gl.uniformMatrix4fv(this.location,!1,i);break}},t}(Ae);function pt(e){return[H(255*e.r,255*e.g),H(255*e.b,255*e.a)]}var Ut=function(e,t,i){this.value=e,this.uniformNames=t.map(function(l){return"u_"+l}),this.type=i};Ut.prototype.setUniform=function(e,t,i){e.set(i.constantOr(this.value))},Ut.prototype.getBinding=function(e,t,i){return this.type==="color"?new It(e,t):new He(e,t)};var Yt=function(e,t){this.uniformNames=t.map(function(i){return"u_"+i}),this.patternFrom=null,this.patternTo=null,this.pixelRatioFrom=1,this.pixelRatioTo=1};Yt.prototype.setConstantPatternPositions=function(e,t){this.pixelRatioFrom=t.pixelRatio,this.pixelRatioTo=e.pixelRatio,this.patternFrom=t.tlbr,this.patternTo=e.tlbr},Yt.prototype.setUniform=function(e,t,i,l){var f=l==="u_pattern_to"?this.patternTo:l==="u_pattern_from"?this.patternFrom:l==="u_pixel_ratio_to"?this.pixelRatioTo:l==="u_pixel_ratio_from"?this.pixelRatioFrom:null;f&&e.set(f)},Yt.prototype.getBinding=function(e,t,i){return i.substr(0,9)==="u_pattern"?new kt(e,t):new He(e,t)};var Ot=function(e,t,i,l){this.expression=e,this.type=i,this.maxValue=0,this.paintVertexAttributes=t.map(function(f){return{name:"a_"+f,type:"Float32",components:i==="color"?2:1,offset:0}}),this.paintVertexArray=new l};Ot.prototype.populatePaintArray=function(e,t,i,l,f){var m=this.paintVertexArray.length,x=this.expression.evaluate(new ur(0),t,{},l,[],f);this.paintVertexArray.resize(e),this._setPaintValue(m,e,x)},Ot.prototype.updatePaintArray=function(e,t,i,l){var f=this.expression.evaluate({zoom:0},i,l);this._setPaintValue(e,t,f)},Ot.prototype._setPaintValue=function(e,t,i){if(this.type==="color")for(var l=pt(i),f=e;f<t;f++)this.paintVertexArray.emplace(f,l[0],l[1]);else{for(var m=e;m<t;m++)this.paintVertexArray.emplace(m,i);this.maxValue=Math.max(this.maxValue,Math.abs(i))}},Ot.prototype.upload=function(e){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=e.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))},Ot.prototype.destroy=function(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()};var Bt=function(e,t,i,l,f,m){this.expression=e,this.uniformNames=t.map(function(x){return"u_"+x+"_t"}),this.type=i,this.useIntegerZoom=l,this.zoom=f,this.maxValue=0,this.paintVertexAttributes=t.map(function(x){return{name:"a_"+x,type:"Float32",components:i==="color"?4:2,offset:0}}),this.paintVertexArray=new m};Bt.prototype.populatePaintArray=function(e,t,i,l,f){var m=this.expression.evaluate(new ur(this.zoom),t,{},l,[],f),x=this.expression.evaluate(new ur(this.zoom+1),t,{},l,[],f),k=this.paintVertexArray.length;this.paintVertexArray.resize(e),this._setPaintValue(k,e,m,x)},Bt.prototype.updatePaintArray=function(e,t,i,l){var f=this.expression.evaluate({zoom:this.zoom},i,l),m=this.expression.evaluate({zoom:this.zoom+1},i,l);this._setPaintValue(e,t,f,m)},Bt.prototype._setPaintValue=function(e,t,i,l){if(this.type==="color")for(var f=pt(i),m=pt(l),x=e;x<t;x++)this.paintVertexArray.emplace(x,f[0],f[1],m[0],m[1]);else{for(var k=e;k<t;k++)this.paintVertexArray.emplace(k,i,l);this.maxValue=Math.max(this.maxValue,Math.abs(i),Math.abs(l))}},Bt.prototype.upload=function(e){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=e.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))},Bt.prototype.destroy=function(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()},Bt.prototype.setUniform=function(e,t){var i=this.useIntegerZoom?Math.floor(t.zoom):t.zoom,l=ve(this.expression.interpolationFactor(i,this.zoom,this.zoom+1),0,1);e.set(l)},Bt.prototype.getBinding=function(e,t,i){return new He(e,t)};var Xt=function(e,t,i,l,f,m){this.expression=e,this.type=t,this.useIntegerZoom=i,this.zoom=l,this.layerId=m,this.zoomInPaintVertexArray=new f,this.zoomOutPaintVertexArray=new f};Xt.prototype.populatePaintArray=function(e,t,i){var l=this.zoomInPaintVertexArray.length;this.zoomInPaintVertexArray.resize(e),this.zoomOutPaintVertexArray.resize(e),this._setPaintValues(l,e,t.patterns&&t.patterns[this.layerId],i)},Xt.prototype.updatePaintArray=function(e,t,i,l,f){this._setPaintValues(e,t,i.patterns&&i.patterns[this.layerId],f)},Xt.prototype._setPaintValues=function(e,t,i,l){if(l&&i){var f=l[i.min],m=l[i.mid],x=l[i.max];if(f&&m&&x)for(var k=e;k<t;k++)this.zoomInPaintVertexArray.emplace(k,m.tl[0],m.tl[1],m.br[0],m.br[1],f.tl[0],f.tl[1],f.br[0],f.br[1],m.pixelRatio,f.pixelRatio),this.zoomOutPaintVertexArray.emplace(k,m.tl[0],m.tl[1],m.br[0],m.br[1],x.tl[0],x.tl[1],x.br[0],x.br[1],m.pixelRatio,x.pixelRatio)}},Xt.prototype.upload=function(e){this.zoomInPaintVertexArray&&this.zoomInPaintVertexArray.arrayBuffer&&this.zoomOutPaintVertexArray&&this.zoomOutPaintVertexArray.arrayBuffer&&(this.zoomInPaintVertexBuffer=e.createVertexBuffer(this.zoomInPaintVertexArray,te.members,this.expression.isStateDependent),this.zoomOutPaintVertexBuffer=e.createVertexBuffer(this.zoomOutPaintVertexArray,te.members,this.expression.isStateDependent))},Xt.prototype.destroy=function(){this.zoomOutPaintVertexBuffer&&this.zoomOutPaintVertexBuffer.destroy(),this.zoomInPaintVertexBuffer&&this.zoomInPaintVertexBuffer.destroy()};var Rt=function(e,t,i){this.binders={},this._buffers=[];var l=[];for(var f in e.paint._values)if(i(f)){var m=e.paint.get(f);if(m instanceof vn&&bo(m.property.specification)){var x=Fi(f,e.type),k=m.value,I=m.property.specification.type,A=m.property.useIntegerZoom,C=m.property.specification["property-type"],B=C==="cross-faded"||C==="cross-faded-data-driven";if(k.kind==="constant")this.binders[f]=B?new Yt(k.value,x):new Ut(k.value,x,I),l.push("/u_"+f);else if(k.kind==="source"||B){var U=ai(f,I,"source");this.binders[f]=B?new Xt(k,I,A,t,U,e.id):new Ot(k,x,I,U),l.push("/a_"+f)}else{var j=ai(f,I,"composite");this.binders[f]=new Bt(k,x,I,A,t,j),l.push("/z_"+f)}}}this.cacheKey=l.sort().join("")};Rt.prototype.getMaxValue=function(e){var t=this.binders[e];return t instanceof Ot||t instanceof Bt?t.maxValue:0},Rt.prototype.populatePaintArrays=function(e,t,i,l,f){for(var m in this.binders){var x=this.binders[m];(x instanceof Ot||x instanceof Bt||x instanceof Xt)&&x.populatePaintArray(e,t,i,l,f)}},Rt.prototype.setConstantPatternPositions=function(e,t){for(var i in this.binders){var l=this.binders[i];l instanceof Yt&&l.setConstantPatternPositions(e,t)}},Rt.prototype.updatePaintArrays=function(e,t,i,l,f){var m=!1;for(var x in e)for(var k=0,I=t.getPositions(x);k<I.length;k+=1){var A=I[k],C=i.feature(A.index);for(var B in this.binders){var U=this.binders[B];if((U instanceof Ot||U instanceof Bt||U instanceof Xt)&&U.expression.isStateDependent===!0){var j=l.paint.get(B);U.expression=j.value,U.updatePaintArray(A.start,A.end,C,e[x],f),m=!0}}}return m},Rt.prototype.defines=function(){var e=[];for(var t in this.binders){var i=this.binders[t];(i instanceof Ut||i instanceof Yt)&&e.push.apply(e,i.uniformNames.map(function(l){return"#define HAS_UNIFORM_"+l}))}return e},Rt.prototype.getBinderAttributes=function(){var e=[];for(var t in this.binders){var i=this.binders[t];if(i instanceof Ot||i instanceof Bt)for(var l=0;l<i.paintVertexAttributes.length;l++)e.push(i.paintVertexAttributes[l].name);else if(i instanceof Xt)for(var f=0;f<te.members.length;f++)e.push(te.members[f].name)}return e},Rt.prototype.getBinderUniforms=function(){var e=[];for(var t in this.binders){var i=this.binders[t];if(i instanceof Ut||i instanceof Yt||i instanceof Bt)for(var l=0,f=i.uniformNames;l<f.length;l+=1)e.push(f[l])}return e},Rt.prototype.getPaintVertexBuffers=function(){return this._buffers},Rt.prototype.getUniforms=function(e,t){var i=[];for(var l in this.binders){var f=this.binders[l];if(f instanceof Ut||f instanceof Yt||f instanceof Bt)for(var m=0,x=f.uniformNames;m<x.length;m+=1){var k=x[m];if(t[k]){var I=f.getBinding(e,t[k],k);i.push({name:k,property:l,binding:I})}}}return i},Rt.prototype.setUniforms=function(e,t,i,l){for(var f=0,m=t;f<m.length;f+=1){var x=m[f],k=x.name,I=x.property;this.binders[I].setUniform(x.binding,l,i.get(I),k)}},Rt.prototype.updatePaintBuffers=function(e){for(var t in this._buffers=[],this.binders){var i=this.binders[t];if(e&&i instanceof Xt){var l=e.fromScale===2?i.zoomInPaintVertexBuffer:i.zoomOutPaintVertexBuffer;l&&this._buffers.push(l)}else(i instanceof Ot||i instanceof Bt)&&i.paintVertexBuffer&&this._buffers.push(i.paintVertexBuffer)}},Rt.prototype.upload=function(e){for(var t in this.binders){var i=this.binders[t];(i instanceof Ot||i instanceof Bt||i instanceof Xt)&&i.upload(e)}this.updatePaintBuffers()},Rt.prototype.destroy=function(){for(var e in this.binders){var t=this.binders[e];(t instanceof Ot||t instanceof Bt||t instanceof Xt)&&t.destroy()}};var Mt=function(e,t,i){i===void 0&&(i=function(){return!0}),this.programConfigurations={};for(var l=0,f=e;l<f.length;l+=1){var m=f[l];this.programConfigurations[m.id]=new Rt(m,t,i)}this.needsUpload=!1,this._featureMap=new fe,this._bufferOffset=0};function Fi(e,t){return{"text-opacity":["opacity"],"icon-opacity":["opacity"],"text-color":["fill_color"],"icon-color":["fill_color"],"text-halo-color":["halo_color"],"icon-halo-color":["halo_color"],"text-halo-blur":["halo_blur"],"icon-halo-blur":["halo_blur"],"text-halo-width":["halo_width"],"icon-halo-width":["halo_width"],"line-gap-width":["gapwidth"],"line-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-extrusion-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"]}[e]||[e.replace(t+"-","").replace(/-/g,"_")]}function ai(e,t,i){var l={color:{source:Zo,composite:il},number:{source:Ja,composite:Zo}},f=function(m){return{"line-pattern":{source:Ta,composite:Ta},"fill-pattern":{source:Ta,composite:Ta},"fill-extrusion-pattern":{source:Ta,composite:Ta}}[m]}(e);return f&&f[i]||l[t][i]}Mt.prototype.populatePaintArrays=function(e,t,i,l,f,m){for(var x in this.programConfigurations)this.programConfigurations[x].populatePaintArrays(e,t,l,f,m);t.id!==void 0&&this._featureMap.add(t.id,i,this._bufferOffset,e),this._bufferOffset=e,this.needsUpload=!0},Mt.prototype.updatePaintArrays=function(e,t,i,l){for(var f=0,m=i;f<m.length;f+=1){var x=m[f];this.needsUpload=this.programConfigurations[x.id].updatePaintArrays(e,this._featureMap,t,x,l)||this.needsUpload}},Mt.prototype.get=function(e){return this.programConfigurations[e]},Mt.prototype.upload=function(e){if(this.needsUpload){for(var t in this.programConfigurations)this.programConfigurations[t].upload(e);this.needsUpload=!1}},Mt.prototype.destroy=function(){for(var e in this.programConfigurations)this.programConfigurations[e].destroy()},ft("ConstantBinder",Ut),ft("CrossFadedConstantBinder",Yt),ft("SourceExpressionBinder",Ot),ft("CrossFadedCompositeBinder",Xt),ft("CompositeExpressionBinder",Bt),ft("ProgramConfiguration",Rt,{omit:["_buffers"]}),ft("ProgramConfigurationSet",Mt);var cn=Math.pow(2,14)-1,Wi=-cn-1;function $r(e){for(var t=8192/e.extent,i=e.loadGeometry(),l=0;l<i.length;l++)for(var f=i[l],m=0;m<f.length;m++){var x=f[m],k=Math.round(x.x*t),I=Math.round(x.y*t);x.x=ve(k,Wi,cn),x.y=ve(I,Wi,cn),(k<x.x||k>x.x+1||I<x.y||I>x.y+1)&&yt("Geometry exceeds allowed extent, reduce your vector tile buffer size")}return i}function di(e,t){return{type:e.type,id:e.id,properties:e.properties,geometry:t?$r(e):[]}}function qn(e,t,i,l,f){e.emplaceBack(2*t+(l+1)/2,2*i+(f+1)/2)}var xn=function(e){this.zoom=e.zoom,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map(function(t){return t.id}),this.index=e.index,this.hasPattern=!1,this.layoutVertexArray=new Eo,this.indexArray=new Wa,this.segments=new G,this.programConfigurations=new Mt(e.layers,e.zoom),this.stateDependentLayerIds=this.layers.filter(function(t){return t.isStateDependent()}).map(function(t){return t.id})};function Qa(e,t){for(var i=0;i<e.length;i++)if(Ia(t,e[i]))return!0;for(var l=0;l<t.length;l++)if(Ia(e,t[l]))return!0;return!!ks(e,t)}function In(e,t,i){return!!Ia(e,t)||!!$a(t,e,i)}function ga(e,t){if(e.length===1)return Es(t,e[0]);for(var i=0;i<t.length;i++)for(var l=t[i],f=0;f<l.length;f++)if(Ia(e,l[f]))return!0;for(var m=0;m<e.length;m++)if(Es(t,e[m]))return!0;for(var x=0;x<t.length;x++)if(ks(e,t[x]))return!0;return!1}function oa(e,t,i){if(e.length>1){if(ks(e,t))return!0;for(var l=0;l<t.length;l++)if($a(t[l],e,i))return!0}for(var f=0;f<e.length;f++)if($a(e[f],t,i))return!0;return!1}function ks(e,t){if(e.length===0||t.length===0)return!1;for(var i=0;i<e.length-1;i++)for(var l=e[i],f=e[i+1],m=0;m<t.length-1;m++)if(Ho(l,f,t[m],t[m+1]))return!0;return!1}function Ho(e,t,i,l){return Ct(e,i,l)!==Ct(t,i,l)&&Ct(e,t,i)!==Ct(e,t,l)}function $a(e,t,i){var l=i*i;if(t.length===1)return e.distSqr(t[0])<l;for(var f=1;f<t.length;f++)if(Xo(e,t[f-1],t[f])<l)return!0;return!1}function Xo(e,t,i){var l=t.distSqr(i);if(l===0)return e.distSqr(t);var f=((e.x-t.x)*(i.x-t.x)+(e.y-t.y)*(i.y-t.y))/l;return e.distSqr(f<0?t:f>1?i:i.sub(t)._mult(f)._add(t))}function Es(e,t){for(var i,l,f,m=!1,x=0;x<e.length;x++)for(var k=0,I=(i=e[x]).length-1;k<i.length;I=k++)(l=i[k]).y>t.y!=(f=i[I]).y>t.y&&t.x<(f.x-l.x)*(t.y-l.y)/(f.y-l.y)+l.x&&(m=!m);return m}function Ia(e,t){for(var i=!1,l=0,f=e.length-1;l<e.length;f=l++){var m=e[l],x=e[f];m.y>t.y!=x.y>t.y&&t.x<(x.x-m.x)*(t.y-m.y)/(x.y-m.y)+m.x&&(i=!i)}return i}function zs(e,t,i){var l=i[0],f=i[2];if(e.x<l.x&&t.x<l.x||e.x>f.x&&t.x>f.x||e.y<l.y&&t.y<l.y||e.y>f.y&&t.y>f.y)return!1;var m=Ct(e,t,i[0]);return m!==Ct(e,t,i[1])||m!==Ct(e,t,i[2])||m!==Ct(e,t,i[3])}function Aa(e,t,i){var l=t.paint.get(e).value;return l.kind==="constant"?l.value:i.programConfigurations.get(t.id).getMaxValue(e)}function Ni(e){return Math.sqrt(e[0]*e[0]+e[1]*e[1])}function La(e,t,i,l,f){if(!t[0]&&!t[1])return e;var m=F.convert(t)._mult(f);i==="viewport"&&m._rotate(-l);for(var x=[],k=0;k<e.length;k++)x.push(e[k].sub(m));return x}xn.prototype.populate=function(e,t,i){var l=this.layers[0],f=[],m=null;l.type==="circle"&&(m=l.layout.get("circle-sort-key"));for(var x=0,k=e;x<k.length;x+=1){var I=k[x],A=I.feature,C=I.id,B=I.index,U=I.sourceLayerIndex,j=this.layers[0]._featureFilter.needGeometry,J=di(A,j);if(this.layers[0]._featureFilter.filter(new ur(this.zoom),J,i)){var Q=m?m.evaluate(J,{},i):void 0,he={id:C,properties:A.properties,type:A.type,sourceLayerIndex:U,index:B,geometry:j?J.geometry:$r(A),patterns:{},sortKey:Q};f.push(he)}}m&&f.sort(function(Je,bt){return Je.sortKey-bt.sortKey});for(var ie=0,me=f;ie<me.length;ie+=1){var be=me[ie],Se=be.geometry,Ee=be.index,Ce=be.sourceLayerIndex,Ve=e[Ee].feature;this.addFeature(be,Se,Ee,i),t.featureIndex.insert(Ve,Se,Ee,Ce,this.index)}},xn.prototype.update=function(e,t,i){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(e,t,this.stateDependentLayers,i)},xn.prototype.isEmpty=function(){return this.layoutVertexArray.length===0},xn.prototype.uploadPending=function(){return!this.uploaded||this.programConfigurations.needsUpload},xn.prototype.upload=function(e){this.uploaded||(this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,Z),this.indexBuffer=e.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(e),this.uploaded=!0},xn.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())},xn.prototype.addFeature=function(e,t,i,l){for(var f=0,m=t;f<m.length;f+=1)for(var x=0,k=m[f];x<k.length;x+=1){var I=k[x],A=I.x,C=I.y;if(!(A<0||A>=8192||C<0||C>=8192)){var B=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray,e.sortKey),U=B.vertexLength;qn(this.layoutVertexArray,A,C,-1,-1),qn(this.layoutVertexArray,A,C,1,-1),qn(this.layoutVertexArray,A,C,1,1),qn(this.layoutVertexArray,A,C,-1,1),this.indexArray.emplaceBack(U,U+1,U+2),this.indexArray.emplaceBack(U,U+3,U+2),B.vertexLength+=4,B.primitiveLength+=2}}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,e,i,{},l)},ft("CircleBucket",xn,{omit:["layers"]});var eo=new an({"circle-sort-key":new gt(q.layout_circle["circle-sort-key"])}),To={paint:new an({"circle-radius":new gt(q.paint_circle["circle-radius"]),"circle-color":new gt(q.paint_circle["circle-color"]),"circle-blur":new gt(q.paint_circle["circle-blur"]),"circle-opacity":new gt(q.paint_circle["circle-opacity"]),"circle-translate":new St(q.paint_circle["circle-translate"]),"circle-translate-anchor":new St(q.paint_circle["circle-translate-anchor"]),"circle-pitch-scale":new St(q.paint_circle["circle-pitch-scale"]),"circle-pitch-alignment":new St(q.paint_circle["circle-pitch-alignment"]),"circle-stroke-width":new gt(q.paint_circle["circle-stroke-width"]),"circle-stroke-color":new gt(q.paint_circle["circle-stroke-color"]),"circle-stroke-opacity":new gt(q.paint_circle["circle-stroke-opacity"])}),layout:eo},kr=typeof Float32Array<"u"?Float32Array:Array;function $n(e){return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}function An(e,t,i){var l=t[0],f=t[1],m=t[2],x=t[3],k=t[4],I=t[5],A=t[6],C=t[7],B=t[8],U=t[9],j=t[10],J=t[11],Q=t[12],he=t[13],ie=t[14],me=t[15],be=i[0],Se=i[1],Ee=i[2],Ce=i[3];return e[0]=be*l+Se*k+Ee*B+Ce*Q,e[1]=be*f+Se*I+Ee*U+Ce*he,e[2]=be*m+Se*A+Ee*j+Ce*ie,e[3]=be*x+Se*C+Ee*J+Ce*me,e[4]=(be=i[4])*l+(Se=i[5])*k+(Ee=i[6])*B+(Ce=i[7])*Q,e[5]=be*f+Se*I+Ee*U+Ce*he,e[6]=be*m+Se*A+Ee*j+Ce*ie,e[7]=be*x+Se*C+Ee*J+Ce*me,e[8]=(be=i[8])*l+(Se=i[9])*k+(Ee=i[10])*B+(Ce=i[11])*Q,e[9]=be*f+Se*I+Ee*U+Ce*he,e[10]=be*m+Se*A+Ee*j+Ce*ie,e[11]=be*x+Se*C+Ee*J+Ce*me,e[12]=(be=i[12])*l+(Se=i[13])*k+(Ee=i[14])*B+(Ce=i[15])*Q,e[13]=be*f+Se*I+Ee*U+Ce*he,e[14]=be*m+Se*A+Ee*j+Ce*ie,e[15]=be*x+Se*C+Ee*J+Ce*me,e}Math.hypot||(Math.hypot=function(){for(var e=arguments,t=0,i=arguments.length;i--;)t+=e[i]*e[i];return Math.sqrt(t)});var Io,Xh=An;function nl(e,t,i){var l=t[0],f=t[1],m=t[2],x=t[3];return e[0]=i[0]*l+i[4]*f+i[8]*m+i[12]*x,e[1]=i[1]*l+i[5]*f+i[9]*m+i[13]*x,e[2]=i[2]*l+i[6]*f+i[10]*m+i[14]*x,e[3]=i[3]*l+i[7]*f+i[11]*m+i[15]*x,e}Io=new kr(3),kr!=Float32Array&&(Io[0]=0,Io[1]=0,Io[2]=0),function(){var e=new kr(4);kr!=Float32Array&&(e[0]=0,e[1]=0,e[2]=0,e[3]=0)}();var Wh=(function(){var e=new kr(2);kr!=Float32Array&&(e[0]=0,e[1]=0)}(),function(e){function t(i){e.call(this,i,To)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.createBucket=function(i){return new xn(i)},t.prototype.queryRadius=function(i){var l=i;return Aa("circle-radius",this,l)+Aa("circle-stroke-width",this,l)+Ni(this.paint.get("circle-translate"))},t.prototype.queryIntersectsFeature=function(i,l,f,m,x,k,I,A){for(var C=La(i,this.paint.get("circle-translate"),this.paint.get("circle-translate-anchor"),k.angle,I),B=this.paint.get("circle-radius").evaluate(l,f)+this.paint.get("circle-stroke-width").evaluate(l,f),U=this.paint.get("circle-pitch-alignment")==="map",j=U?C:function(Ve,Je){return Ve.map(function(bt){return Ts(bt,Je)})}(C,A),J=U?B*I:B,Q=0,he=m;Q<he.length;Q+=1)for(var ie=0,me=he[Q];ie<me.length;ie+=1){var be=me[ie],Se=U?be:Ts(be,A),Ee=J,Ce=nl([],[be.x,be.y,0,1],A);if(this.paint.get("circle-pitch-scale")==="viewport"&&this.paint.get("circle-pitch-alignment")==="map"?Ee*=Ce[3]/k.cameraToCenterDistance:this.paint.get("circle-pitch-scale")==="map"&&this.paint.get("circle-pitch-alignment")==="viewport"&&(Ee*=k.cameraToCenterDistance/Ce[3]),In(j,Se,Ee))return!0}return!1},t}(za));function Ts(e,t){var i=nl([],[e.x,e.y,0,1],t);return new F(i[0]/i[3],i[1]/i[3])}var Ic=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t}(xn);function Wo(e,t,i,l){var f=t.width,m=t.height;if(l){if(l instanceof Uint8ClampedArray)l=new Uint8Array(l.buffer);else if(l.length!==f*m*i)throw new RangeError("mismatched image size")}else l=new Uint8Array(f*m*i);return e.width=f,e.height=m,e.data=l,e}function al(e,t,i){var l=t.width,f=t.height;if(l!==e.width||f!==e.height){var m=Wo({},{width:l,height:f},i);Yh(e,m,{x:0,y:0},{x:0,y:0},{width:Math.min(e.width,l),height:Math.min(e.height,f)},i),e.width=l,e.height=f,e.data=m.data}}function Yh(e,t,i,l,f,m){if(f.width===0||f.height===0)return t;if(f.width>e.width||f.height>e.height||i.x>e.width-f.width||i.y>e.height-f.height)throw new RangeError("out of range source coordinates for image copy");if(f.width>t.width||f.height>t.height||l.x>t.width-f.width||l.y>t.height-f.height)throw new RangeError("out of range destination coordinates for image copy");for(var x=e.data,k=t.data,I=0;I<f.height;I++)for(var A=((i.y+I)*e.width+i.x)*m,C=((l.y+I)*t.width+l.x)*m,B=0;B<f.width*m;B++)k[C+B]=x[A+B];return t}ft("HeatmapBucket",Ic,{omit:["layers"]});var Is=function(e,t){Wo(this,e,1,t)};Is.prototype.resize=function(e){al(this,e,1)},Is.prototype.clone=function(){return new Is({width:this.width,height:this.height},new Uint8Array(this.data))},Is.copy=function(e,t,i,l,f){Yh(e,t,i,l,f,1)};var jn=function(e,t){Wo(this,e,4,t)};jn.prototype.resize=function(e){al(this,e,4)},jn.prototype.replace=function(e,t){t?this.data.set(e):this.data=e instanceof Uint8ClampedArray?new Uint8Array(e.buffer):e},jn.prototype.clone=function(){return new jn({width:this.width,height:this.height},new Uint8Array(this.data))},jn.copy=function(e,t,i,l,f){Yh(e,t,i,l,f,4)},ft("AlphaImage",Is),ft("RGBAImage",jn);var Ty={paint:new an({"heatmap-radius":new gt(q.paint_heatmap["heatmap-radius"]),"heatmap-weight":new gt(q.paint_heatmap["heatmap-weight"]),"heatmap-intensity":new St(q.paint_heatmap["heatmap-intensity"]),"heatmap-color":new ya(q.paint_heatmap["heatmap-color"]),"heatmap-opacity":new St(q.paint_heatmap["heatmap-opacity"])})};function Yp(e){var t={},i=e.resolution||256,l=e.clips?e.clips.length:1,f=e.image||new jn({width:i,height:l}),m=function(J,Q,he){t[e.evaluationKey]=he;var ie=e.expression.evaluate(t);f.data[J+Q+0]=Math.floor(255*ie.r/ie.a),f.data[J+Q+1]=Math.floor(255*ie.g/ie.a),f.data[J+Q+2]=Math.floor(255*ie.b/ie.a),f.data[J+Q+3]=Math.floor(255*ie.a)};if(e.clips)for(var x=0,k=0;x<l;++x,k+=4*i)for(var I=0,A=0;I<i;I++,A+=4){var C=I/(i-1),B=e.clips[x];m(k,A,B.start*(1-C)+B.end*C)}else for(var U=0,j=0;U<i;U++,j+=4)m(0,j,U/(i-1));return f}var Iy=function(e){function t(i){e.call(this,i,Ty),this._updateColorRamp()}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.createBucket=function(i){return new Ic(i)},t.prototype._handleSpecialPaintPropertyUpdate=function(i){i==="heatmap-color"&&this._updateColorRamp()},t.prototype._updateColorRamp=function(){this.colorRamp=Yp({expression:this._transitionablePaint._values["heatmap-color"].value.expression,evaluationKey:"heatmapDensity",image:this.colorRamp}),this.colorRampTexture=null},t.prototype.resize=function(){this.heatmapFbo&&(this.heatmapFbo.destroy(),this.heatmapFbo=null)},t.prototype.queryRadius=function(){return 0},t.prototype.queryIntersectsFeature=function(){return!1},t.prototype.hasOffscreenPass=function(){return this.paint.get("heatmap-opacity")!==0&&this.visibility!=="none"},t}(za),Ay={paint:new an({"hillshade-illumination-direction":new St(q.paint_hillshade["hillshade-illumination-direction"]),"hillshade-illumination-anchor":new St(q.paint_hillshade["hillshade-illumination-anchor"]),"hillshade-exaggeration":new St(q.paint_hillshade["hillshade-exaggeration"]),"hillshade-shadow-color":new St(q.paint_hillshade["hillshade-shadow-color"]),"hillshade-highlight-color":new St(q.paint_hillshade["hillshade-highlight-color"]),"hillshade-accent-color":new St(q.paint_hillshade["hillshade-accent-color"])})},Py=function(e){function t(i){e.call(this,i,Ay)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.hasOffscreenPass=function(){return this.paint.get("hillshade-exaggeration")!==0&&this.visibility!=="none"},t}(za),Cy=Xi([{name:"a_pos",components:2,type:"Int16"}],4).members,Jh=Ac,My=Ac;function Ac(e,t,i){i=i||2;var l,f,m,x,k,I,A,C=t&&t.length,B=C?t[0]*i:e.length,U=Jp(e,0,B,i,!0),j=[];if(!U||U.next===U.prev)return j;if(C&&(U=function(Q,he,ie,me){var be,Se,Ee,Ce=[];for(be=0,Se=he.length;be<Se;be++)(Ee=Jp(Q,he[be]*me,be<Se-1?he[be+1]*me:Q.length,me,!1))===Ee.next&&(Ee.steiner=!0),Ce.push(Uy(Ee));for(Ce.sort(Oy),be=0;be<Ce.length;be++)Fy(Ce[be],ie),ie=Yo(ie,ie.next);return ie}(e,t,U,i)),e.length>80*i){l=m=e[0],f=x=e[1];for(var J=i;J<B;J+=i)(k=e[J])<l&&(l=k),(I=e[J+1])<f&&(f=I),k>m&&(m=k),I>x&&(x=I);A=(A=Math.max(m-l,x-f))!==0?1/A:0}return uu(U,j,i,l,f,A),j}function Jp(e,t,i,l,f){var m,x;if(f===ep(e,t,i,l)>0)for(m=t;m<i;m+=l)x=ef(m,e[m],e[m+1],x);else for(m=i-l;m>=t;m-=l)x=ef(m,e[m],e[m+1],x);return x&&Pc(x,x.next)&&(hu(x),x=x.next),x}function Yo(e,t){if(!e)return e;t||(t=e);var i,l=e;do if(i=!1,l.steiner||!Pc(l,l.next)&&Mi(l.prev,l,l.next)!==0)l=l.next;else{if(hu(l),(l=t=l.prev)===l.next)break;i=!0}while(i||l!==t);return t}function uu(e,t,i,l,f,m,x){if(e){!x&&m&&function(C,B,U,j){var J=C;do J.z===null&&(J.z=Qh(J.x,J.y,B,U,j)),J.prevZ=J.prev,J.nextZ=J.next,J=J.next;while(J!==C);J.prevZ.nextZ=null,J.prevZ=null,function(Q){var he,ie,me,be,Se,Ee,Ce,Ve,Je=1;do{for(ie=Q,Q=null,Se=null,Ee=0;ie;){for(Ee++,me=ie,Ce=0,he=0;he<Je&&(Ce++,me=me.nextZ);he++);for(Ve=Je;Ce>0||Ve>0&&me;)Ce!==0&&(Ve===0||!me||ie.z<=me.z)?(be=ie,ie=ie.nextZ,Ce--):(be=me,me=me.nextZ,Ve--),Se?Se.nextZ=be:Q=be,be.prevZ=Se,Se=be;ie=me}Se.nextZ=null,Je*=2}while(Ee>1)}(J)}(e,l,f,m);for(var k,I,A=e;e.prev!==e.next;)if(k=e.prev,I=e.next,m?Ly(e,l,f,m):Dy(e))t.push(k.i/i),t.push(e.i/i),t.push(I.i/i),hu(e),e=I.next,A=I.next;else if((e=I)===A){x?x===1?uu(e=Ry(Yo(e),t,i),t,i,l,f,m,2):x===2&&By(e,t,i,l,f,m):uu(Yo(e),t,i,l,f,m,1);break}}}function Dy(e){var t=e.prev,i=e,l=e.next;if(Mi(t,i,l)>=0)return!1;for(var f=e.next.next;f!==e.prev;){if(ol(t.x,t.y,i.x,i.y,l.x,l.y,f.x,f.y)&&Mi(f.prev,f,f.next)>=0)return!1;f=f.next}return!0}function Ly(e,t,i,l){var f=e.prev,m=e,x=e.next;if(Mi(f,m,x)>=0)return!1;for(var k=f.x>m.x?f.x>x.x?f.x:x.x:m.x>x.x?m.x:x.x,I=f.y>m.y?f.y>x.y?f.y:x.y:m.y>x.y?m.y:x.y,A=Qh(f.x<m.x?f.x<x.x?f.x:x.x:m.x<x.x?m.x:x.x,f.y<m.y?f.y<x.y?f.y:x.y:m.y<x.y?m.y:x.y,t,i,l),C=Qh(k,I,t,i,l),B=e.prevZ,U=e.nextZ;B&&B.z>=A&&U&&U.z<=C;){if(B!==e.prev&&B!==e.next&&ol(f.x,f.y,m.x,m.y,x.x,x.y,B.x,B.y)&&Mi(B.prev,B,B.next)>=0||(B=B.prevZ,U!==e.prev&&U!==e.next&&ol(f.x,f.y,m.x,m.y,x.x,x.y,U.x,U.y)&&Mi(U.prev,U,U.next)>=0))return!1;U=U.nextZ}for(;B&&B.z>=A;){if(B!==e.prev&&B!==e.next&&ol(f.x,f.y,m.x,m.y,x.x,x.y,B.x,B.y)&&Mi(B.prev,B,B.next)>=0)return!1;B=B.prevZ}for(;U&&U.z<=C;){if(U!==e.prev&&U!==e.next&&ol(f.x,f.y,m.x,m.y,x.x,x.y,U.x,U.y)&&Mi(U.prev,U,U.next)>=0)return!1;U=U.nextZ}return!0}function Ry(e,t,i){var l=e;do{var f=l.prev,m=l.next.next;!Pc(f,m)&&Qp(f,l,l.next,m)&&cu(f,m)&&cu(m,f)&&(t.push(f.i/i),t.push(l.i/i),t.push(m.i/i),hu(l),hu(l.next),l=e=m),l=l.next}while(l!==e);return Yo(l)}function By(e,t,i,l,f,m){var x=e;do{for(var k=x.next.next;k!==x.prev;){if(x.i!==k.i&&Vy(x,k)){var I=$p(x,k);return x=Yo(x,x.next),I=Yo(I,I.next),uu(x,t,i,l,f,m),void uu(I,t,i,l,f,m)}k=k.next}x=x.next}while(x!==e)}function Oy(e,t){return e.x-t.x}function Fy(e,t){if(t=function(l,f){var m,x=f,k=l.x,I=l.y,A=-1/0;do{if(I<=x.y&&I>=x.next.y&&x.next.y!==x.y){var C=x.x+(I-x.y)*(x.next.x-x.x)/(x.next.y-x.y);if(C<=k&&C>A){if(A=C,C===k){if(I===x.y)return x;if(I===x.next.y)return x.next}m=x.x<x.next.x?x:x.next}}x=x.next}while(x!==f);if(!m)return null;if(k===A)return m;var B,U=m,j=m.x,J=m.y,Q=1/0;x=m;do k>=x.x&&x.x>=j&&k!==x.x&&ol(I<J?k:A,I,j,J,I<J?A:k,I,x.x,x.y)&&(B=Math.abs(I-x.y)/(k-x.x),cu(x,l)&&(B<Q||B===Q&&(x.x>m.x||x.x===m.x&&Ny(m,x)))&&(m=x,Q=B)),x=x.next;while(x!==U);return m}(e,t)){var i=$p(t,e);Yo(t,t.next),Yo(i,i.next)}}function Ny(e,t){return Mi(e.prev,e,t.prev)<0&&Mi(t.next,e,e.next)<0}function Qh(e,t,i,l,f){return(e=1431655765&((e=858993459&((e=252645135&((e=16711935&((e=32767*(e-i)*f)|e<<8))|e<<4))|e<<2))|e<<1))|(t=1431655765&((t=858993459&((t=252645135&((t=16711935&((t=32767*(t-l)*f)|t<<8))|t<<4))|t<<2))|t<<1))<<1}function Uy(e){var t=e,i=e;do(t.x<i.x||t.x===i.x&&t.y<i.y)&&(i=t),t=t.next;while(t!==e);return i}function ol(e,t,i,l,f,m,x,k){return(f-x)*(t-k)-(e-x)*(m-k)>=0&&(e-x)*(l-k)-(i-x)*(t-k)>=0&&(i-x)*(m-k)-(f-x)*(l-k)>=0}function Vy(e,t){return e.next.i!==t.i&&e.prev.i!==t.i&&!function(i,l){var f=i;do{if(f.i!==i.i&&f.next.i!==i.i&&f.i!==l.i&&f.next.i!==l.i&&Qp(f,f.next,i,l))return!0;f=f.next}while(f!==i);return!1}(e,t)&&(cu(e,t)&&cu(t,e)&&function(i,l){var f=i,m=!1,x=(i.x+l.x)/2,k=(i.y+l.y)/2;do f.y>k!=f.next.y>k&&f.next.y!==f.y&&x<(f.next.x-f.x)*(k-f.y)/(f.next.y-f.y)+f.x&&(m=!m),f=f.next;while(f!==i);return m}(e,t)&&(Mi(e.prev,e,t.prev)||Mi(e,t.prev,t))||Pc(e,t)&&Mi(e.prev,e,e.next)>0&&Mi(t.prev,t,t.next)>0)}function Mi(e,t,i){return(t.y-e.y)*(i.x-t.x)-(t.x-e.x)*(i.y-t.y)}function Pc(e,t){return e.x===t.x&&e.y===t.y}function Qp(e,t,i,l){var f=Mc(Mi(e,t,i)),m=Mc(Mi(e,t,l)),x=Mc(Mi(i,l,e)),k=Mc(Mi(i,l,t));return f!==m&&x!==k||!(f!==0||!Cc(e,i,t))||!(m!==0||!Cc(e,l,t))||!(x!==0||!Cc(i,e,l))||!(k!==0||!Cc(i,t,l))}function Cc(e,t,i){return t.x<=Math.max(e.x,i.x)&&t.x>=Math.min(e.x,i.x)&&t.y<=Math.max(e.y,i.y)&&t.y>=Math.min(e.y,i.y)}function Mc(e){return e>0?1:e<0?-1:0}function cu(e,t){return Mi(e.prev,e,e.next)<0?Mi(e,t,e.next)>=0&&Mi(e,e.prev,t)>=0:Mi(e,t,e.prev)<0||Mi(e,e.next,t)<0}function $p(e,t){var i=new $h(e.i,e.x,e.y),l=new $h(t.i,t.x,t.y),f=e.next,m=t.prev;return e.next=t,t.prev=e,i.next=f,f.prev=i,l.next=i,i.prev=l,m.next=l,l.prev=m,l}function ef(e,t,i,l){var f=new $h(e,t,i);return l?(f.next=l.next,f.prev=l,l.next.prev=f,l.next=f):(f.prev=f,f.next=f),f}function hu(e){e.next.prev=e.prev,e.prev.next=e.next,e.prevZ&&(e.prevZ.nextZ=e.nextZ),e.nextZ&&(e.nextZ.prevZ=e.prevZ)}function $h(e,t,i){this.i=e,this.x=t,this.y=i,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}function ep(e,t,i,l){for(var f=0,m=t,x=i-l;m<i;m+=l)f+=(e[x]-e[m])*(e[m+1]+e[x+1]),x=m;return f}function qy(e,t,i,l,f){(function m(x,k,I,A,C){for(;A>I;){if(A-I>600){var B=A-I+1,U=k-I+1,j=Math.log(B),J=.5*Math.exp(2*j/3),Q=.5*Math.sqrt(j*J*(B-J)/B)*(U-B/2<0?-1:1);m(x,k,Math.max(I,Math.floor(k-U*J/B+Q)),Math.min(A,Math.floor(k+(B-U)*J/B+Q)),C)}var he=x[k],ie=I,me=A;for(pu(x,I,k),C(x[A],he)>0&&pu(x,I,A);ie<me;){for(pu(x,ie,me),ie++,me--;C(x[ie],he)<0;)ie++;for(;C(x[me],he)>0;)me--}C(x[I],he)===0?pu(x,I,me):pu(x,++me,A),me<=k&&(I=me+1),k<=me&&(A=me-1)}})(e,t,i||0,l||e.length-1,f||jy)}function pu(e,t,i){var l=e[t];e[t]=e[i],e[i]=l}function jy(e,t){return e<t?-1:e>t?1:0}function tp(e,t){var i=e.length;if(i<=1)return[e];for(var l,f,m=[],x=0;x<i;x++){var k=Le(e[x]);k!==0&&(e[x].area=Math.abs(k),f===void 0&&(f=k<0),f===k<0?(l&&m.push(l),l=[e[x]]):l.push(e[x]))}if(l&&m.push(l),t>1)for(var I=0;I<m.length;I++)m[I].length<=t||(qy(m[I],t,1,m[I].length-1,Zy),m[I]=m[I].slice(0,t));return m}function Zy(e,t){return t.area-e.area}function rp(e,t,i){for(var l=i.patternDependencies,f=!1,m=0,x=t;m<x.length;m+=1){var k=x[m].paint.get(e+"-pattern");k.isConstant()||(f=!0);var I=k.constantOr(null);I&&(f=!0,l[I.to]=!0,l[I.from]=!0)}return f}function ip(e,t,i,l,f){for(var m=f.patternDependencies,x=0,k=t;x<k.length;x+=1){var I=k[x],A=I.paint.get(e+"-pattern").value;if(A.kind!=="constant"){var C=A.evaluate({zoom:l-1},i,{},f.availableImages),B=A.evaluate({zoom:l},i,{},f.availableImages),U=A.evaluate({zoom:l+1},i,{},f.availableImages);B=B&&B.name?B.name:B,U=U&&U.name?U.name:U,m[C=C&&C.name?C.name:C]=!0,m[B]=!0,m[U]=!0,i.patterns[I.id]={min:C,mid:B,max:U}}}return i}Ac.deviation=function(e,t,i,l){var f=t&&t.length,m=Math.abs(ep(e,0,f?t[0]*i:e.length,i));if(f)for(var x=0,k=t.length;x<k;x++)m-=Math.abs(ep(e,t[x]*i,x<k-1?t[x+1]*i:e.length,i));var I=0;for(x=0;x<l.length;x+=3){var A=l[x]*i,C=l[x+1]*i,B=l[x+2]*i;I+=Math.abs((e[A]-e[B])*(e[C+1]-e[A+1])-(e[A]-e[C])*(e[B+1]-e[A+1]))}return m===0&&I===0?0:Math.abs((I-m)/m)},Ac.flatten=function(e){for(var t=e[0][0].length,i={vertices:[],holes:[],dimensions:t},l=0,f=0;f<e.length;f++){for(var m=0;m<e[f].length;m++)for(var x=0;x<t;x++)i.vertices.push(e[f][m][x]);f>0&&i.holes.push(l+=e[f-1].length)}return i},Jh.default=My;var Ra=function(e){this.zoom=e.zoom,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map(function(t){return t.id}),this.index=e.index,this.hasPattern=!1,this.patternFeatures=[],this.layoutVertexArray=new Eo,this.indexArray=new Wa,this.indexArray2=new Ss,this.programConfigurations=new Mt(e.layers,e.zoom),this.segments=new G,this.segments2=new G,this.stateDependentLayerIds=this.layers.filter(function(t){return t.isStateDependent()}).map(function(t){return t.id})};Ra.prototype.populate=function(e,t,i){this.hasPattern=rp("fill",this.layers,t);for(var l=this.layers[0].layout.get("fill-sort-key"),f=[],m=0,x=e;m<x.length;m+=1){var k=x[m],I=k.feature,A=k.id,C=k.index,B=k.sourceLayerIndex,U=this.layers[0]._featureFilter.needGeometry,j=di(I,U);if(this.layers[0]._featureFilter.filter(new ur(this.zoom),j,i)){var J=l?l.evaluate(j,{},i,t.availableImages):void 0,Q={id:A,properties:I.properties,type:I.type,sourceLayerIndex:B,index:C,geometry:U?j.geometry:$r(I),patterns:{},sortKey:J};f.push(Q)}}l&&f.sort(function(Ve,Je){return Ve.sortKey-Je.sortKey});for(var he=0,ie=f;he<ie.length;he+=1){var me=ie[he],be=me.geometry,Se=me.index,Ee=me.sourceLayerIndex;if(this.hasPattern){var Ce=ip("fill",this.layers,me,this.zoom,t);this.patternFeatures.push(Ce)}else this.addFeature(me,be,Se,i,{});t.featureIndex.insert(e[Se].feature,be,Se,Ee,this.index)}},Ra.prototype.update=function(e,t,i){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(e,t,this.stateDependentLayers,i)},Ra.prototype.addFeatures=function(e,t,i){for(var l=0,f=this.patternFeatures;l<f.length;l+=1){var m=f[l];this.addFeature(m,m.geometry,m.index,t,i)}},Ra.prototype.isEmpty=function(){return this.layoutVertexArray.length===0},Ra.prototype.uploadPending=function(){return!this.uploaded||this.programConfigurations.needsUpload},Ra.prototype.upload=function(e){this.uploaded||(this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,Cy),this.indexBuffer=e.createIndexBuffer(this.indexArray),this.indexBuffer2=e.createIndexBuffer(this.indexArray2)),this.programConfigurations.upload(e),this.uploaded=!0},Ra.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.indexBuffer2.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.segments2.destroy())},Ra.prototype.addFeature=function(e,t,i,l,f){for(var m=0,x=tp(t,500);m<x.length;m+=1){for(var k=x[m],I=0,A=0,C=k;A<C.length;A+=1)I+=C[A].length;for(var B=this.segments.prepareSegment(I,this.layoutVertexArray,this.indexArray),U=B.vertexLength,j=[],J=[],Q=0,he=k;Q<he.length;Q+=1){var ie=he[Q];if(ie.length!==0){ie!==k[0]&&J.push(j.length/2);var me=this.segments2.prepareSegment(ie.length,this.layoutVertexArray,this.indexArray2),be=me.vertexLength;this.layoutVertexArray.emplaceBack(ie[0].x,ie[0].y),this.indexArray2.emplaceBack(be+ie.length-1,be),j.push(ie[0].x),j.push(ie[0].y);for(var Se=1;Se<ie.length;Se++)this.layoutVertexArray.emplaceBack(ie[Se].x,ie[Se].y),this.indexArray2.emplaceBack(be+Se-1,be+Se),j.push(ie[Se].x),j.push(ie[Se].y);me.vertexLength+=ie.length,me.primitiveLength+=ie.length}}for(var Ee=Jh(j,J),Ce=0;Ce<Ee.length;Ce+=3)this.indexArray.emplaceBack(U+Ee[Ce],U+Ee[Ce+1],U+Ee[Ce+2]);B.vertexLength+=I,B.primitiveLength+=Ee.length/3}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,e,i,f,l)},ft("FillBucket",Ra,{omit:["layers","patternFeatures"]});var Gy=new an({"fill-sort-key":new gt(q.layout_fill["fill-sort-key"])}),Ky={paint:new an({"fill-antialias":new St(q.paint_fill["fill-antialias"]),"fill-opacity":new gt(q.paint_fill["fill-opacity"]),"fill-color":new gt(q.paint_fill["fill-color"]),"fill-outline-color":new gt(q.paint_fill["fill-outline-color"]),"fill-translate":new St(q.paint_fill["fill-translate"]),"fill-translate-anchor":new St(q.paint_fill["fill-translate-anchor"]),"fill-pattern":new $s(q.paint_fill["fill-pattern"])}),layout:Gy},Hy=function(e){function t(i){e.call(this,i,Ky)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.recalculate=function(i,l){e.prototype.recalculate.call(this,i,l);var f=this.paint._values["fill-outline-color"];f.value.kind==="constant"&&f.value.value===void 0&&(this.paint._values["fill-outline-color"]=this.paint._values["fill-color"])},t.prototype.createBucket=function(i){return new Ra(i)},t.prototype.queryRadius=function(){return Ni(this.paint.get("fill-translate"))},t.prototype.queryIntersectsFeature=function(i,l,f,m,x,k,I){return ga(La(i,this.paint.get("fill-translate"),this.paint.get("fill-translate-anchor"),k.angle,I),m)},t.prototype.isTileClipped=function(){return!0},t}(za),Xy=Xi([{name:"a_pos",components:2,type:"Int16"},{name:"a_normal_ed",components:4,type:"Int16"}],4).members,tf=sl;function sl(e,t,i,l,f){this.properties={},this.extent=i,this.type=0,this._pbf=e,this._geometry=-1,this._keys=l,this._values=f,e.readFields(Wy,this,t)}function Wy(e,t,i){e==1?t.id=i.readVarint():e==2?function(l,f){for(var m=l.readVarint()+l.pos;l.pos<m;){var x=f._keys[l.readVarint()],k=f._values[l.readVarint()];f.properties[x]=k}}(i,t):e==3?t.type=i.readVarint():e==4&&(t._geometry=i.pos)}function Yy(e){for(var t,i,l=0,f=0,m=e.length,x=m-1;f<m;x=f++)l+=((i=e[x]).x-(t=e[f]).x)*(t.y+i.y);return l}sl.types=["Unknown","Point","LineString","Polygon"],sl.prototype.loadGeometry=function(){var e=this._pbf;e.pos=this._geometry;for(var t,i=e.readVarint()+e.pos,l=1,f=0,m=0,x=0,k=[];e.pos<i;){if(f<=0){var I=e.readVarint();l=7&I,f=I>>3}if(f--,l===1||l===2)m+=e.readSVarint(),x+=e.readSVarint(),l===1&&(t&&k.push(t),t=[]),t.push(new F(m,x));else{if(l!==7)throw new Error("unknown command "+l);t&&t.push(t[0].clone())}}return t&&k.push(t),k},sl.prototype.bbox=function(){var e=this._pbf;e.pos=this._geometry;for(var t=e.readVarint()+e.pos,i=1,l=0,f=0,m=0,x=1/0,k=-1/0,I=1/0,A=-1/0;e.pos<t;){if(l<=0){var C=e.readVarint();i=7&C,l=C>>3}if(l--,i===1||i===2)(f+=e.readSVarint())<x&&(x=f),f>k&&(k=f),(m+=e.readSVarint())<I&&(I=m),m>A&&(A=m);else if(i!==7)throw new Error("unknown command "+i)}return[x,I,k,A]},sl.prototype.toGeoJSON=function(e,t,i){var l,f,m=this.extent*Math.pow(2,i),x=this.extent*e,k=this.extent*t,I=this.loadGeometry(),A=sl.types[this.type];function C(j){for(var J=0;J<j.length;J++){var Q=j[J];j[J]=[360*(Q.x+x)/m-180,360/Math.PI*Math.atan(Math.exp((180-360*(Q.y+k)/m)*Math.PI/180))-90]}}switch(this.type){case 1:var B=[];for(l=0;l<I.length;l++)B[l]=I[l][0];C(I=B);break;case 2:for(l=0;l<I.length;l++)C(I[l]);break;case 3:for(I=function(j){var J=j.length;if(J<=1)return[j];for(var Q,he,ie=[],me=0;me<J;me++){var be=Yy(j[me]);be!==0&&(he===void 0&&(he=be<0),he===be<0?(Q&&ie.push(Q),Q=[j[me]]):Q.push(j[me]))}return Q&&ie.push(Q),ie}(I),l=0;l<I.length;l++)for(f=0;f<I[l].length;f++)C(I[l][f])}I.length===1?I=I[0]:A="Multi"+A;var U={type:"Feature",geometry:{type:A,coordinates:I},properties:this.properties};return"id"in this&&(U.id=this.id),U};var rf=nf;function nf(e,t){this.version=1,this.name=null,this.extent=4096,this.length=0,this._pbf=e,this._keys=[],this._values=[],this._features=[],e.readFields(Jy,this,t),this.length=this._features.length}function Jy(e,t,i){e===15?t.version=i.readVarint():e===1?t.name=i.readString():e===5?t.extent=i.readVarint():e===2?t._features.push(i.pos):e===3?t._keys.push(i.readString()):e===4&&t._values.push(function(l){for(var f=null,m=l.readVarint()+l.pos;l.pos<m;){var x=l.readVarint()>>3;f=x===1?l.readString():x===2?l.readFloat():x===3?l.readDouble():x===4?l.readVarint64():x===5?l.readVarint():x===6?l.readSVarint():x===7?l.readBoolean():null}return f}(i))}function Qy(e,t,i){if(e===3){var l=new rf(i,i.readVarint()+i.pos);l.length&&(t[l.name]=l)}}nf.prototype.feature=function(e){if(e<0||e>=this._features.length)throw new Error("feature index out of bounds");this._pbf.pos=this._features[e];var t=this._pbf.readVarint()+this._pbf.pos;return new tf(this._pbf,t,this.extent,this._keys,this._values)};var ll={VectorTile:function(e,t){this.layers=e.readFields(Qy,{},t)},VectorTileFeature:tf,VectorTileLayer:rf},$y=ll.VectorTileFeature.types,np=Math.pow(2,13);function fu(e,t,i,l,f,m,x,k){e.emplaceBack(t,i,2*Math.floor(l*np)+x,f*np*2,m*np*2,Math.round(k))}var Ba=function(e){this.zoom=e.zoom,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map(function(t){return t.id}),this.index=e.index,this.hasPattern=!1,this.layoutVertexArray=new Da,this.indexArray=new Wa,this.programConfigurations=new Mt(e.layers,e.zoom),this.segments=new G,this.stateDependentLayerIds=this.layers.filter(function(t){return t.isStateDependent()}).map(function(t){return t.id})};function eg(e,t){return e.x===t.x&&(e.x<0||e.x>8192)||e.y===t.y&&(e.y<0||e.y>8192)}Ba.prototype.populate=function(e,t,i){this.features=[],this.hasPattern=rp("fill-extrusion",this.layers,t);for(var l=0,f=e;l<f.length;l+=1){var m=f[l],x=m.feature,k=m.id,I=m.index,A=m.sourceLayerIndex,C=this.layers[0]._featureFilter.needGeometry,B=di(x,C);if(this.layers[0]._featureFilter.filter(new ur(this.zoom),B,i)){var U={id:k,sourceLayerIndex:A,index:I,geometry:C?B.geometry:$r(x),properties:x.properties,type:x.type,patterns:{}};this.hasPattern?this.features.push(ip("fill-extrusion",this.layers,U,this.zoom,t)):this.addFeature(U,U.geometry,I,i,{}),t.featureIndex.insert(x,U.geometry,I,A,this.index,!0)}}},Ba.prototype.addFeatures=function(e,t,i){for(var l=0,f=this.features;l<f.length;l+=1){var m=f[l];this.addFeature(m,m.geometry,m.index,t,i)}},Ba.prototype.update=function(e,t,i){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(e,t,this.stateDependentLayers,i)},Ba.prototype.isEmpty=function(){return this.layoutVertexArray.length===0},Ba.prototype.uploadPending=function(){return!this.uploaded||this.programConfigurations.needsUpload},Ba.prototype.upload=function(e){this.uploaded||(this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,Xy),this.indexBuffer=e.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(e),this.uploaded=!0},Ba.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())},Ba.prototype.addFeature=function(e,t,i,l,f){for(var m=0,x=tp(t,500);m<x.length;m+=1){for(var k=x[m],I=0,A=0,C=k;A<C.length;A+=1)I+=C[A].length;for(var B=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray),U=0,j=k;U<j.length;U+=1){var J=j[U];if(J.length!==0&&!((lr=J).every(function(Gt){return Gt.x<0})||lr.every(function(Gt){return Gt.x>8192})||lr.every(function(Gt){return Gt.y<0})||lr.every(function(Gt){return Gt.y>8192})))for(var Q=0,he=0;he<J.length;he++){var ie=J[he];if(he>=1){var me=J[he-1];if(!eg(ie,me)){B.vertexLength+4>G.MAX_VERTEX_ARRAY_LENGTH&&(B=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray));var be=ie.sub(me)._perp()._unit(),Se=me.dist(ie);Q+Se>32768&&(Q=0),fu(this.layoutVertexArray,ie.x,ie.y,be.x,be.y,0,0,Q),fu(this.layoutVertexArray,ie.x,ie.y,be.x,be.y,0,1,Q),fu(this.layoutVertexArray,me.x,me.y,be.x,be.y,0,0,Q+=Se),fu(this.layoutVertexArray,me.x,me.y,be.x,be.y,0,1,Q);var Ee=B.vertexLength;this.indexArray.emplaceBack(Ee,Ee+2,Ee+1),this.indexArray.emplaceBack(Ee+1,Ee+2,Ee+3),B.vertexLength+=4,B.primitiveLength+=2}}}}if(B.vertexLength+I>G.MAX_VERTEX_ARRAY_LENGTH&&(B=this.segments.prepareSegment(I,this.layoutVertexArray,this.indexArray)),$y[e.type]==="Polygon"){for(var Ce=[],Ve=[],Je=B.vertexLength,bt=0,nt=k;bt<nt.length;bt+=1){var Et=nt[bt];if(Et.length!==0){Et!==k[0]&&Ve.push(Ce.length/2);for(var at=0;at<Et.length;at++){var $t=Et[at];fu(this.layoutVertexArray,$t.x,$t.y,0,0,1,1,0),Ce.push($t.x),Ce.push($t.y)}}}for(var Dt=Jh(Ce,Ve),_t=0;_t<Dt.length;_t+=3)this.indexArray.emplaceBack(Je+Dt[_t],Je+Dt[_t+2],Je+Dt[_t+1]);B.primitiveLength+=Dt.length/3,B.vertexLength+=I}}var lr;this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,e,i,f,l)},ft("FillExtrusionBucket",Ba,{omit:["layers","features"]});var tg={paint:new an({"fill-extrusion-opacity":new St(q["paint_fill-extrusion"]["fill-extrusion-opacity"]),"fill-extrusion-color":new gt(q["paint_fill-extrusion"]["fill-extrusion-color"]),"fill-extrusion-translate":new St(q["paint_fill-extrusion"]["fill-extrusion-translate"]),"fill-extrusion-translate-anchor":new St(q["paint_fill-extrusion"]["fill-extrusion-translate-anchor"]),"fill-extrusion-pattern":new $s(q["paint_fill-extrusion"]["fill-extrusion-pattern"]),"fill-extrusion-height":new gt(q["paint_fill-extrusion"]["fill-extrusion-height"]),"fill-extrusion-base":new gt(q["paint_fill-extrusion"]["fill-extrusion-base"]),"fill-extrusion-vertical-gradient":new St(q["paint_fill-extrusion"]["fill-extrusion-vertical-gradient"])})},rg=function(e){function t(i){e.call(this,i,tg)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.createBucket=function(i){return new Ba(i)},t.prototype.queryRadius=function(){return Ni(this.paint.get("fill-extrusion-translate"))},t.prototype.is3D=function(){return!0},t.prototype.queryIntersectsFeature=function(i,l,f,m,x,k,I,A){var C=La(i,this.paint.get("fill-extrusion-translate"),this.paint.get("fill-extrusion-translate-anchor"),k.angle,I),B=this.paint.get("fill-extrusion-height").evaluate(l,f),U=this.paint.get("fill-extrusion-base").evaluate(l,f),j=function(Q,he,ie,me){for(var be=[],Se=0,Ee=Q;Se<Ee.length;Se+=1){var Ce=Ee[Se],Ve=[Ce.x,Ce.y,0,1];nl(Ve,Ve,he),be.push(new F(Ve[0]/Ve[3],Ve[1]/Ve[3]))}return be}(C,A),J=function(Q,he,ie,me){for(var be=[],Se=[],Ee=me[8]*he,Ce=me[9]*he,Ve=me[10]*he,Je=me[11]*he,bt=me[8]*ie,nt=me[9]*ie,Et=me[10]*ie,at=me[11]*ie,$t=0,Dt=Q;$t<Dt.length;$t+=1){for(var _t=[],lr=[],Gt=0,yr=Dt[$t];Gt<yr.length;Gt+=1){var zt=yr[Gt],xr=zt.x,Yr=zt.y,oi=me[0]*xr+me[4]*Yr+me[12],ei=me[1]*xr+me[5]*Yr+me[13],Jr=me[2]*xr+me[6]*Yr+me[14],si=me[3]*xr+me[7]*Yr+me[15],Ui=Jr+Ve,Vi=si+Je,Sn=oi+bt,Ji=ei+nt,kn=Jr+Et,mi=si+at,Qi=new F((oi+Ee)/Vi,(ei+Ce)/Vi);Qi.z=Ui/Vi,_t.push(Qi);var cr=new F(Sn/mi,Ji/mi);cr.z=kn/mi,lr.push(cr)}be.push(_t),Se.push(lr)}return[be,Se]}(m,U,B,A);return function(Q,he,ie){var me=1/0;ga(ie,he)&&(me=af(ie,he[0]));for(var be=0;be<he.length;be++)for(var Se=he[be],Ee=Q[be],Ce=0;Ce<Se.length-1;Ce++){var Ve=Se[Ce],Je=[Ve,Se[Ce+1],Ee[Ce+1],Ee[Ce],Ve];Qa(ie,Je)&&(me=Math.min(me,af(ie,Je)))}return me!==1/0&&me}(J[0],J[1],j)},t}(za);function du(e,t){return e.x*t.x+e.y*t.y}function af(e,t){if(e.length===1){for(var i,l=0,f=t[l++];!i||f.equals(i);)if(!(i=t[l++]))return 1/0;for(;l<t.length;l++){var m=t[l],x=e[0],k=i.sub(f),I=m.sub(f),A=x.sub(f),C=du(k,k),B=du(k,I),U=du(I,I),j=du(A,k),J=du(A,I),Q=C*U-B*B,he=(U*j-B*J)/Q,ie=(C*J-B*j)/Q,me=f.z*(1-he-ie)+i.z*he+m.z*ie;if(isFinite(me))return me}return 1/0}for(var be=1/0,Se=0,Ee=t;Se<Ee.length;Se+=1)be=Math.min(be,Ee[Se].z);return be}var ig=Xi([{name:"a_pos_normal",components:2,type:"Int16"},{name:"a_data",components:4,type:"Uint8"}],4).members,ng=Xi([{name:"a_uv_x",components:1,type:"Float32"},{name:"a_split_index",components:1,type:"Float32"}]).members,ag=ll.VectorTileFeature.types,og=Math.cos(Math.PI/180*37.5),of=Math.pow(2,14)/.5,Pn=function(e){var t=this;this.zoom=e.zoom,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map(function(i){return i.id}),this.index=e.index,this.hasPattern=!1,this.patternFeatures=[],this.lineClipsArray=[],this.gradients={},this.layers.forEach(function(i){t.gradients[i.id]={}}),this.layoutVertexArray=new Vn,this.layoutVertexArray2=new Zo,this.indexArray=new Wa,this.programConfigurations=new Mt(e.layers,e.zoom),this.segments=new G,this.maxLineLength=0,this.stateDependentLayerIds=this.layers.filter(function(i){return i.isStateDependent()}).map(function(i){return i.id})};Pn.prototype.populate=function(e,t,i){this.hasPattern=rp("line",this.layers,t);for(var l=this.layers[0].layout.get("line-sort-key"),f=[],m=0,x=e;m<x.length;m+=1){var k=x[m],I=k.feature,A=k.id,C=k.index,B=k.sourceLayerIndex,U=this.layers[0]._featureFilter.needGeometry,j=di(I,U);if(this.layers[0]._featureFilter.filter(new ur(this.zoom),j,i)){var J=l?l.evaluate(j,{},i):void 0,Q={id:A,properties:I.properties,type:I.type,sourceLayerIndex:B,index:C,geometry:U?j.geometry:$r(I),patterns:{},sortKey:J};f.push(Q)}}l&&f.sort(function(Ve,Je){return Ve.sortKey-Je.sortKey});for(var he=0,ie=f;he<ie.length;he+=1){var me=ie[he],be=me.geometry,Se=me.index,Ee=me.sourceLayerIndex;if(this.hasPattern){var Ce=ip("line",this.layers,me,this.zoom,t);this.patternFeatures.push(Ce)}else this.addFeature(me,be,Se,i,{});t.featureIndex.insert(e[Se].feature,be,Se,Ee,this.index)}},Pn.prototype.update=function(e,t,i){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(e,t,this.stateDependentLayers,i)},Pn.prototype.addFeatures=function(e,t,i){for(var l=0,f=this.patternFeatures;l<f.length;l+=1){var m=f[l];this.addFeature(m,m.geometry,m.index,t,i)}},Pn.prototype.isEmpty=function(){return this.layoutVertexArray.length===0},Pn.prototype.uploadPending=function(){return!this.uploaded||this.programConfigurations.needsUpload},Pn.prototype.upload=function(e){this.uploaded||(this.layoutVertexArray2.length!==0&&(this.layoutVertexBuffer2=e.createVertexBuffer(this.layoutVertexArray2,ng)),this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,ig),this.indexBuffer=e.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(e),this.uploaded=!0},Pn.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())},Pn.prototype.lineFeatureClips=function(e){if(e.properties&&e.properties.hasOwnProperty("mapbox_clip_start")&&e.properties.hasOwnProperty("mapbox_clip_end"))return{start:+e.properties.mapbox_clip_start,end:+e.properties.mapbox_clip_end}},Pn.prototype.addFeature=function(e,t,i,l,f){var m=this.layers[0].layout,x=m.get("line-join").evaluate(e,{}),k=m.get("line-cap"),I=m.get("line-miter-limit"),A=m.get("line-round-limit");this.lineClips=this.lineFeatureClips(e);for(var C=0,B=t;C<B.length;C+=1)this.addLine(B[C],e,x,k,I,A);this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,e,i,f,l)},Pn.prototype.addLine=function(e,t,i,l,f,m){if(this.distance=0,this.scaledDistance=0,this.totalDistance=0,this.lineClips){this.lineClipsArray.push(this.lineClips);for(var x=0;x<e.length-1;x++)this.totalDistance+=e[x].dist(e[x+1]);this.updateScaledDistance(),this.maxLineLength=Math.max(this.maxLineLength,this.totalDistance)}for(var k=ag[t.type]==="Polygon",I=e.length;I>=2&&e[I-1].equals(e[I-2]);)I--;for(var A=0;A<I-1&&e[A].equals(e[A+1]);)A++;if(!(I<(k?3:2))){i==="bevel"&&(f=1.05);var C,B=this.overscaling<=16?122880/(512*this.overscaling):0,U=this.segments.prepareSegment(10*I,this.layoutVertexArray,this.indexArray),j=void 0,J=void 0,Q=void 0,he=void 0;this.e1=this.e2=-1,k&&(he=e[A].sub(C=e[I-2])._unit()._perp());for(var ie=A;ie<I;ie++)if(!(J=ie===I-1?k?e[A+1]:void 0:e[ie+1])||!e[ie].equals(J)){he&&(Q=he),C&&(j=C),C=e[ie],he=J?J.sub(C)._unit()._perp():Q;var me=(Q=Q||he).add(he);me.x===0&&me.y===0||me._unit();var be=Q.x*he.x+Q.y*he.y,Se=me.x*he.x+me.y*he.y,Ee=Se!==0?1/Se:1/0,Ce=2*Math.sqrt(2-2*Se),Ve=Se<og&&j&&J,Je=Q.x*he.y-Q.y*he.x>0;if(Ve&&ie>A){var bt=C.dist(j);if(bt>2*B){var nt=C.sub(C.sub(j)._mult(B/bt)._round());this.updateDistance(j,nt),this.addCurrentVertex(nt,Q,0,0,U),j=nt}}var Et=j&&J,at=Et?i:k?"butt":l;if(Et&&at==="round"&&(Ee<m?at="miter":Ee<=2&&(at="fakeround")),at==="miter"&&Ee>f&&(at="bevel"),at==="bevel"&&(Ee>2&&(at="flipbevel"),Ee<f&&(at="miter")),j&&this.updateDistance(j,C),at==="miter")me._mult(Ee),this.addCurrentVertex(C,me,0,0,U);else if(at==="flipbevel"){if(Ee>100)me=he.mult(-1);else{var $t=Ee*Q.add(he).mag()/Q.sub(he).mag();me._perp()._mult($t*(Je?-1:1))}this.addCurrentVertex(C,me,0,0,U),this.addCurrentVertex(C,me.mult(-1),0,0,U)}else if(at==="bevel"||at==="fakeround"){var Dt=-Math.sqrt(Ee*Ee-1),_t=Je?Dt:0,lr=Je?0:Dt;if(j&&this.addCurrentVertex(C,Q,_t,lr,U),at==="fakeround")for(var Gt=Math.round(180*Ce/Math.PI/20),yr=1;yr<Gt;yr++){var zt=yr/Gt;if(zt!==.5){var xr=zt-.5;zt+=zt*xr*(zt-1)*((1.0904+be*(be*(3.55645-1.43519*be)-3.2452))*xr*xr+(.848013+be*(.215638*be-1.06021)))}var Yr=he.sub(Q)._mult(zt)._add(Q)._unit()._mult(Je?-1:1);this.addHalfVertex(C,Yr.x,Yr.y,!1,Je,0,U)}J&&this.addCurrentVertex(C,he,-_t,-lr,U)}else if(at==="butt")this.addCurrentVertex(C,me,0,0,U);else if(at==="square"){var oi=j?1:-1;this.addCurrentVertex(C,me,oi,oi,U)}else at==="round"&&(j&&(this.addCurrentVertex(C,Q,0,0,U),this.addCurrentVertex(C,Q,1,1,U,!0)),J&&(this.addCurrentVertex(C,he,-1,-1,U,!0),this.addCurrentVertex(C,he,0,0,U)));if(Ve&&ie<I-1){var ei=C.dist(J);if(ei>2*B){var Jr=C.add(J.sub(C)._mult(B/ei)._round());this.updateDistance(C,Jr),this.addCurrentVertex(Jr,he,0,0,U),C=Jr}}}}},Pn.prototype.addCurrentVertex=function(e,t,i,l,f,m){m===void 0&&(m=!1);var x=t.y*l-t.x,k=-t.y-t.x*l;this.addHalfVertex(e,t.x+t.y*i,t.y-t.x*i,m,!1,i,f),this.addHalfVertex(e,x,k,m,!0,-l,f),this.distance>of/2&&this.totalDistance===0&&(this.distance=0,this.addCurrentVertex(e,t,i,l,f,m))},Pn.prototype.addHalfVertex=function(e,t,i,l,f,m,x){var k=.5*(this.lineClips?this.scaledDistance*(of-1):this.scaledDistance);this.layoutVertexArray.emplaceBack((e.x<<1)+(l?1:0),(e.y<<1)+(f?1:0),Math.round(63*t)+128,Math.round(63*i)+128,1+(m===0?0:m<0?-1:1)|(63&k)<<2,k>>6),this.lineClips&&this.layoutVertexArray2.emplaceBack((this.scaledDistance-this.lineClips.start)/(this.lineClips.end-this.lineClips.start),this.lineClipsArray.length);var I=x.vertexLength++;this.e1>=0&&this.e2>=0&&(this.indexArray.emplaceBack(this.e1,this.e2,I),x.primitiveLength++),f?this.e2=I:this.e1=I},Pn.prototype.updateScaledDistance=function(){this.scaledDistance=this.lineClips?this.lineClips.start+(this.lineClips.end-this.lineClips.start)*this.distance/this.totalDistance:this.distance},Pn.prototype.updateDistance=function(e,t){this.distance+=e.dist(t),this.updateScaledDistance()},ft("LineBucket",Pn,{omit:["layers","patternFeatures"]});var sg=new an({"line-cap":new St(q.layout_line["line-cap"]),"line-join":new gt(q.layout_line["line-join"]),"line-miter-limit":new St(q.layout_line["line-miter-limit"]),"line-round-limit":new St(q.layout_line["line-round-limit"]),"line-sort-key":new gt(q.layout_line["line-sort-key"])}),sf={paint:new an({"line-opacity":new gt(q.paint_line["line-opacity"]),"line-color":new gt(q.paint_line["line-color"]),"line-translate":new St(q.paint_line["line-translate"]),"line-translate-anchor":new St(q.paint_line["line-translate-anchor"]),"line-width":new gt(q.paint_line["line-width"]),"line-gap-width":new gt(q.paint_line["line-gap-width"]),"line-offset":new gt(q.paint_line["line-offset"]),"line-blur":new gt(q.paint_line["line-blur"]),"line-dasharray":new bn(q.paint_line["line-dasharray"]),"line-pattern":new $s(q.paint_line["line-pattern"]),"line-gradient":new ya(q.paint_line["line-gradient"])}),layout:sg},lf=new(function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.possiblyEvaluate=function(i,l){return l=new ur(Math.floor(l.zoom),{now:l.now,fadeDuration:l.fadeDuration,zoomHistory:l.zoomHistory,transition:l.transition}),e.prototype.possiblyEvaluate.call(this,i,l)},t.prototype.evaluate=function(i,l,f,m){return l=we({},l,{zoom:Math.floor(l.zoom)}),e.prototype.evaluate.call(this,i,l,f,m)},t}(gt))(sf.paint.properties["line-width"].specification);lf.useIntegerZoom=!0;var lg=function(e){function t(i){e.call(this,i,sf),this.gradientVersion=0}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._handleSpecialPaintPropertyUpdate=function(i){i==="line-gradient"&&(this.stepInterpolant=this._transitionablePaint._values["line-gradient"].value.expression._styleExpression.expression instanceof Bn,this.gradientVersion=(this.gradientVersion+1)%X)},t.prototype.gradientExpression=function(){return this._transitionablePaint._values["line-gradient"].value.expression},t.prototype.recalculate=function(i,l){e.prototype.recalculate.call(this,i,l),this.paint._values["line-floorwidth"]=lf.possiblyEvaluate(this._transitioningPaint._values["line-width"].value,i)},t.prototype.createBucket=function(i){return new Pn(i)},t.prototype.queryRadius=function(i){var l=i,f=uf(Aa("line-width",this,l),Aa("line-gap-width",this,l)),m=Aa("line-offset",this,l);return f/2+Math.abs(m)+Ni(this.paint.get("line-translate"))},t.prototype.queryIntersectsFeature=function(i,l,f,m,x,k,I){var A=La(i,this.paint.get("line-translate"),this.paint.get("line-translate-anchor"),k.angle,I),C=I/2*uf(this.paint.get("line-width").evaluate(l,f),this.paint.get("line-gap-width").evaluate(l,f)),B=this.paint.get("line-offset").evaluate(l,f);return B&&(m=function(U,j){for(var J=[],Q=new F(0,0),he=0;he<U.length;he++){for(var ie=U[he],me=[],be=0;be<ie.length;be++){var Se=ie[be],Ee=ie[be+1],Ce=be===0?Q:Se.sub(ie[be-1])._unit()._perp(),Ve=be===ie.length-1?Q:Ee.sub(Se)._unit()._perp(),Je=Ce._add(Ve)._unit();Je._mult(1/(Je.x*Ve.x+Je.y*Ve.y)),me.push(Je._mult(j)._add(Se))}J.push(me)}return J}(m,B*I)),function(U,j,J){for(var Q=0;Q<j.length;Q++){var he=j[Q];if(U.length>=3){for(var ie=0;ie<he.length;ie++)if(Ia(U,he[ie]))return!0}if(oa(U,he,J))return!0}return!1}(A,m,C)},t.prototype.isTileClipped=function(){return!0},t}(za);function uf(e,t){return t>0?t+2*e:e}var ug=Xi([{name:"a_pos_offset",components:4,type:"Int16"},{name:"a_data",components:4,type:"Uint16"},{name:"a_pixeloffset",components:4,type:"Int16"}],4),cg=Xi([{name:"a_projected_pos",components:3,type:"Float32"}],4),hg=(Xi([{name:"a_fade_opacity",components:1,type:"Uint32"}],4),Xi([{name:"a_placed",components:2,type:"Uint8"},{name:"a_shift",components:2,type:"Float32"}])),cf=(Xi([{type:"Int16",name:"anchorPointX"},{type:"Int16",name:"anchorPointY"},{type:"Int16",name:"x1"},{type:"Int16",name:"y1"},{type:"Int16",name:"x2"},{type:"Int16",name:"y2"},{type:"Uint32",name:"featureIndex"},{type:"Uint16",name:"sourceLayerIndex"},{type:"Uint16",name:"bucketIndex"}]),Xi([{name:"a_pos",components:2,type:"Int16"},{name:"a_anchor_pos",components:2,type:"Int16"},{name:"a_extrude",components:2,type:"Int16"}],4)),pg=Xi([{name:"a_pos",components:2,type:"Float32"},{name:"a_radius",components:1,type:"Float32"},{name:"a_flags",components:2,type:"Int16"}],4);function fg(e,t,i){return e.sections.forEach(function(l){l.text=function(f,m,x){var k=m.layout.get("text-transform").evaluate(x,{});return k==="uppercase"?f=f.toLocaleUpperCase():k==="lowercase"&&(f=f.toLocaleLowerCase()),Qn.applyArabicShaping&&(f=Qn.applyArabicShaping(f)),f}(l.text,t,i)}),e}Xi([{name:"triangle",components:3,type:"Uint16"}]),Xi([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Uint16",name:"glyphStartIndex"},{type:"Uint16",name:"numGlyphs"},{type:"Uint32",name:"vertexStartIndex"},{type:"Uint32",name:"lineStartIndex"},{type:"Uint32",name:"lineLength"},{type:"Uint16",name:"segment"},{type:"Uint16",name:"lowerSize"},{type:"Uint16",name:"upperSize"},{type:"Float32",name:"lineOffsetX"},{type:"Float32",name:"lineOffsetY"},{type:"Uint8",name:"writingMode"},{type:"Uint8",name:"placedOrientation"},{type:"Uint8",name:"hidden"},{type:"Uint32",name:"crossTileID"},{type:"Int16",name:"associatedIconIndex"}]),Xi([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Int16",name:"rightJustifiedTextSymbolIndex"},{type:"Int16",name:"centerJustifiedTextSymbolIndex"},{type:"Int16",name:"leftJustifiedTextSymbolIndex"},{type:"Int16",name:"verticalPlacedTextSymbolIndex"},{type:"Int16",name:"placedIconSymbolIndex"},{type:"Int16",name:"verticalPlacedIconSymbolIndex"},{type:"Uint16",name:"key"},{type:"Uint16",name:"textBoxStartIndex"},{type:"Uint16",name:"textBoxEndIndex"},{type:"Uint16",name:"verticalTextBoxStartIndex"},{type:"Uint16",name:"verticalTextBoxEndIndex"},{type:"Uint16",name:"iconBoxStartIndex"},{type:"Uint16",name:"iconBoxEndIndex"},{type:"Uint16",name:"verticalIconBoxStartIndex"},{type:"Uint16",name:"verticalIconBoxEndIndex"},{type:"Uint16",name:"featureIndex"},{type:"Uint16",name:"numHorizontalGlyphVertices"},{type:"Uint16",name:"numVerticalGlyphVertices"},{type:"Uint16",name:"numIconVertices"},{type:"Uint16",name:"numVerticalIconVertices"},{type:"Uint16",name:"useRuntimeCollisionCircles"},{type:"Uint32",name:"crossTileID"},{type:"Float32",name:"textBoxScale"},{type:"Float32",components:2,name:"textOffset"},{type:"Float32",name:"collisionCircleDiameter"}]),Xi([{type:"Float32",name:"offsetX"}]),Xi([{type:"Int16",name:"x"},{type:"Int16",name:"y"},{type:"Int16",name:"tileUnitDistanceFromAnchor"}]);var mu={"!":"","#":"",$:"","%":"","&":"","(":"",")":"","*":"","+":"",",":"","-":"",".":"","/":"",":":"",";":"","<":"","=":"",">":"","?":"","@":"","[":"","\\":"","]":"","^":"",_:"","`":"","{":"","|":"","}":"","~":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":""},hf=function(e,t,i,l,f){var m,x,k=8*f-l-1,I=(1<<k)-1,A=I>>1,C=-7,B=i?f-1:0,U=i?-1:1,j=e[t+B];for(B+=U,m=j&(1<<-C)-1,j>>=-C,C+=k;C>0;m=256*m+e[t+B],B+=U,C-=8);for(x=m&(1<<-C)-1,m>>=-C,C+=l;C>0;x=256*x+e[t+B],B+=U,C-=8);if(m===0)m=1-A;else{if(m===I)return x?NaN:1/0*(j?-1:1);x+=Math.pow(2,l),m-=A}return(j?-1:1)*x*Math.pow(2,m-l)},pf=function(e,t,i,l,f,m){var x,k,I,A=8*m-f-1,C=(1<<A)-1,B=C>>1,U=f===23?Math.pow(2,-24)-Math.pow(2,-77):0,j=l?0:m-1,J=l?1:-1,Q=t<0||t===0&&1/t<0?1:0;for(t=Math.abs(t),isNaN(t)||t===1/0?(k=isNaN(t)?1:0,x=C):(x=Math.floor(Math.log(t)/Math.LN2),t*(I=Math.pow(2,-x))<1&&(x--,I*=2),(t+=x+B>=1?U/I:U*Math.pow(2,1-B))*I>=2&&(x++,I/=2),x+B>=C?(k=0,x=C):x+B>=1?(k=(t*I-1)*Math.pow(2,f),x+=B):(k=t*Math.pow(2,B-1)*Math.pow(2,f),x=0));f>=8;e[i+j]=255&k,j+=J,k/=256,f-=8);for(x=x<<f|k,A+=f;A>0;e[i+j]=255&x,j+=J,x/=256,A-=8);e[i+j-J]|=128*Q},Dc=Vr;function Vr(e){this.buf=ArrayBuffer.isView&&ArrayBuffer.isView(e)?e:new Uint8Array(e||0),this.pos=0,this.type=0,this.length=this.buf.length}Vr.Varint=0,Vr.Fixed64=1,Vr.Bytes=2,Vr.Fixed32=5;var ff=typeof TextDecoder>"u"?null:new TextDecoder("utf8");function Ao(e){return e.type===Vr.Bytes?e.readVarint()+e.pos:e.pos+1}function ul(e,t,i){return i?4294967296*t+(e>>>0):4294967296*(t>>>0)+(e>>>0)}function df(e,t,i){var l=t<=16383?1:t<=2097151?2:t<=268435455?3:Math.floor(Math.log(t)/(7*Math.LN2));i.realloc(l);for(var f=i.pos-1;f>=e;f--)i.buf[f+l]=i.buf[f]}function dg(e,t){for(var i=0;i<e.length;i++)t.writeVarint(e[i])}function mg(e,t){for(var i=0;i<e.length;i++)t.writeSVarint(e[i])}function yg(e,t){for(var i=0;i<e.length;i++)t.writeFloat(e[i])}function gg(e,t){for(var i=0;i<e.length;i++)t.writeDouble(e[i])}function _g(e,t){for(var i=0;i<e.length;i++)t.writeBoolean(e[i])}function vg(e,t){for(var i=0;i<e.length;i++)t.writeFixed32(e[i])}function bg(e,t){for(var i=0;i<e.length;i++)t.writeSFixed32(e[i])}function xg(e,t){for(var i=0;i<e.length;i++)t.writeFixed64(e[i])}function wg(e,t){for(var i=0;i<e.length;i++)t.writeSFixed64(e[i])}function Lc(e,t){return(e[t]|e[t+1]<<8|e[t+2]<<16)+16777216*e[t+3]}function cl(e,t,i){e[i]=t,e[i+1]=t>>>8,e[i+2]=t>>>16,e[i+3]=t>>>24}function mf(e,t){return(e[t]|e[t+1]<<8|e[t+2]<<16)+(e[t+3]<<24)}function Sg(e,t,i){e===1&&i.readMessage(kg,t)}function kg(e,t,i){if(e===3){var l=i.readMessage(Eg,{}),f=l.width,m=l.height,x=l.left,k=l.top,I=l.advance;t.push({id:l.id,bitmap:new Is({width:f+6,height:m+6},l.bitmap),metrics:{width:f,height:m,left:x,top:k,advance:I}})}}function Eg(e,t,i){e===1?t.id=i.readVarint():e===2?t.bitmap=i.readBytes():e===3?t.width=i.readVarint():e===4?t.height=i.readVarint():e===5?t.left=i.readSVarint():e===6?t.top=i.readSVarint():e===7&&(t.advance=i.readVarint())}function yf(e){for(var t=0,i=0,l=0,f=e;l<f.length;l+=1){var m=f[l];t+=m.w*m.h,i=Math.max(i,m.w)}e.sort(function(Q,he){return he.h-Q.h});for(var x=[{x:0,y:0,w:Math.max(Math.ceil(Math.sqrt(t/.95)),i),h:1/0}],k=0,I=0,A=0,C=e;A<C.length;A+=1)for(var B=C[A],U=x.length-1;U>=0;U--){var j=x[U];if(!(B.w>j.w||B.h>j.h)){if(B.x=j.x,B.y=j.y,I=Math.max(I,B.y+B.h),k=Math.max(k,B.x+B.w),B.w===j.w&&B.h===j.h){var J=x.pop();U<x.length&&(x[U]=J)}else B.h===j.h?(j.x+=B.w,j.w-=B.w):B.w===j.w?(j.y+=B.h,j.h-=B.h):(x.push({x:j.x+B.w,y:j.y,w:j.w-B.w,h:B.h}),j.y+=B.h,j.h-=B.h);break}}return{w:k,h:I,fill:t/(k*I)||0}}Vr.prototype={destroy:function(){this.buf=null},readFields:function(e,t,i){for(i=i||this.length;this.pos<i;){var l=this.readVarint(),f=l>>3,m=this.pos;this.type=7&l,e(f,t,this),this.pos===m&&this.skip(l)}return t},readMessage:function(e,t){return this.readFields(e,t,this.readVarint()+this.pos)},readFixed32:function(){var e=Lc(this.buf,this.pos);return this.pos+=4,e},readSFixed32:function(){var e=mf(this.buf,this.pos);return this.pos+=4,e},readFixed64:function(){var e=Lc(this.buf,this.pos)+4294967296*Lc(this.buf,this.pos+4);return this.pos+=8,e},readSFixed64:function(){var e=Lc(this.buf,this.pos)+4294967296*mf(this.buf,this.pos+4);return this.pos+=8,e},readFloat:function(){var e=hf(this.buf,this.pos,!0,23,4);return this.pos+=4,e},readDouble:function(){var e=hf(this.buf,this.pos,!0,52,8);return this.pos+=8,e},readVarint:function(e){var t,i,l=this.buf;return t=127&(i=l[this.pos++]),i<128?t:(t|=(127&(i=l[this.pos++]))<<7,i<128?t:(t|=(127&(i=l[this.pos++]))<<14,i<128?t:(t|=(127&(i=l[this.pos++]))<<21,i<128?t:function(f,m,x){var k,I,A=x.buf;if(k=(112&(I=A[x.pos++]))>>4,I<128||(k|=(127&(I=A[x.pos++]))<<3,I<128)||(k|=(127&(I=A[x.pos++]))<<10,I<128)||(k|=(127&(I=A[x.pos++]))<<17,I<128)||(k|=(127&(I=A[x.pos++]))<<24,I<128)||(k|=(1&(I=A[x.pos++]))<<31,I<128))return ul(f,k,m);throw new Error("Expected varint not more than 10 bytes")}(t|=(15&(i=l[this.pos]))<<28,e,this))))},readVarint64:function(){return this.readVarint(!0)},readSVarint:function(){var e=this.readVarint();return e%2==1?(e+1)/-2:e/2},readBoolean:function(){return!!this.readVarint()},readString:function(){var e=this.readVarint()+this.pos,t=this.pos;return this.pos=e,e-t>=12&&ff?function(i,l,f){return ff.decode(i.subarray(l,f))}(this.buf,t,e):function(i,l,f){for(var m="",x=l;x<f;){var k,I,A,C=i[x],B=null,U=C>239?4:C>223?3:C>191?2:1;if(x+U>f)break;U===1?C<128&&(B=C):U===2?(192&(k=i[x+1]))==128&&(B=(31&C)<<6|63&k)<=127&&(B=null):U===3?(I=i[x+2],(192&(k=i[x+1]))==128&&(192&I)==128&&((B=(15&C)<<12|(63&k)<<6|63&I)<=2047||B>=55296&&B<=57343)&&(B=null)):U===4&&(I=i[x+2],A=i[x+3],(192&(k=i[x+1]))==128&&(192&I)==128&&(192&A)==128&&((B=(15&C)<<18|(63&k)<<12|(63&I)<<6|63&A)<=65535||B>=1114112)&&(B=null)),B===null?(B=65533,U=1):B>65535&&(B-=65536,m+=String.fromCharCode(B>>>10&1023|55296),B=56320|1023&B),m+=String.fromCharCode(B),x+=U}return m}(this.buf,t,e)},readBytes:function(){var e=this.readVarint()+this.pos,t=this.buf.subarray(this.pos,e);return this.pos=e,t},readPackedVarint:function(e,t){if(this.type!==Vr.Bytes)return e.push(this.readVarint(t));var i=Ao(this);for(e=e||[];this.pos<i;)e.push(this.readVarint(t));return e},readPackedSVarint:function(e){if(this.type!==Vr.Bytes)return e.push(this.readSVarint());var t=Ao(this);for(e=e||[];this.pos<t;)e.push(this.readSVarint());return e},readPackedBoolean:function(e){if(this.type!==Vr.Bytes)return e.push(this.readBoolean());var t=Ao(this);for(e=e||[];this.pos<t;)e.push(this.readBoolean());return e},readPackedFloat:function(e){if(this.type!==Vr.Bytes)return e.push(this.readFloat());var t=Ao(this);for(e=e||[];this.pos<t;)e.push(this.readFloat());return e},readPackedDouble:function(e){if(this.type!==Vr.Bytes)return e.push(this.readDouble());var t=Ao(this);for(e=e||[];this.pos<t;)e.push(this.readDouble());return e},readPackedFixed32:function(e){if(this.type!==Vr.Bytes)return e.push(this.readFixed32());var t=Ao(this);for(e=e||[];this.pos<t;)e.push(this.readFixed32());return e},readPackedSFixed32:function(e){if(this.type!==Vr.Bytes)return e.push(this.readSFixed32());var t=Ao(this);for(e=e||[];this.pos<t;)e.push(this.readSFixed32());return e},readPackedFixed64:function(e){if(this.type!==Vr.Bytes)return e.push(this.readFixed64());var t=Ao(this);for(e=e||[];this.pos<t;)e.push(this.readFixed64());return e},readPackedSFixed64:function(e){if(this.type!==Vr.Bytes)return e.push(this.readSFixed64());var t=Ao(this);for(e=e||[];this.pos<t;)e.push(this.readSFixed64());return e},skip:function(e){var t=7&e;if(t===Vr.Varint)for(;this.buf[this.pos++]>127;);else if(t===Vr.Bytes)this.pos=this.readVarint()+this.pos;else if(t===Vr.Fixed32)this.pos+=4;else{if(t!==Vr.Fixed64)throw new Error("Unimplemented type: "+t);this.pos+=8}},writeTag:function(e,t){this.writeVarint(e<<3|t)},realloc:function(e){for(var t=this.length||16;t<this.pos+e;)t*=2;if(t!==this.length){var i=new Uint8Array(t);i.set(this.buf),this.buf=i,this.length=t}},finish:function(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)},writeFixed32:function(e){this.realloc(4),cl(this.buf,e,this.pos),this.pos+=4},writeSFixed32:function(e){this.realloc(4),cl(this.buf,e,this.pos),this.pos+=4},writeFixed64:function(e){this.realloc(8),cl(this.buf,-1&e,this.pos),cl(this.buf,Math.floor(e*(1/4294967296)),this.pos+4),this.pos+=8},writeSFixed64:function(e){this.realloc(8),cl(this.buf,-1&e,this.pos),cl(this.buf,Math.floor(e*(1/4294967296)),this.pos+4),this.pos+=8},writeVarint:function(e){(e=+e||0)>268435455||e<0?function(t,i){var l,f;if(t>=0?(l=t%4294967296|0,f=t/4294967296|0):(f=~(-t/4294967296),4294967295^(l=~(-t%4294967296))?l=l+1|0:(l=0,f=f+1|0)),t>=18446744073709552e3||t<-18446744073709552e3)throw new Error("Given varint doesn't fit into 10 bytes");i.realloc(10),function(m,x,k){k.buf[k.pos++]=127&m|128,m>>>=7,k.buf[k.pos++]=127&m|128,m>>>=7,k.buf[k.pos++]=127&m|128,m>>>=7,k.buf[k.pos++]=127&m|128,k.buf[k.pos]=127&(m>>>=7)}(l,0,i),function(m,x){var k=(7&m)<<4;x.buf[x.pos++]|=k|((m>>>=3)?128:0),m&&(x.buf[x.pos++]=127&m|((m>>>=7)?128:0),m&&(x.buf[x.pos++]=127&m|((m>>>=7)?128:0),m&&(x.buf[x.pos++]=127&m|((m>>>=7)?128:0),m&&(x.buf[x.pos++]=127&m|((m>>>=7)?128:0),m&&(x.buf[x.pos++]=127&m)))))}(f,i)}(e,this):(this.realloc(4),this.buf[this.pos++]=127&e|(e>127?128:0),e<=127||(this.buf[this.pos++]=127&(e>>>=7)|(e>127?128:0),e<=127||(this.buf[this.pos++]=127&(e>>>=7)|(e>127?128:0),e<=127||(this.buf[this.pos++]=e>>>7&127))))},writeSVarint:function(e){this.writeVarint(e<0?2*-e-1:2*e)},writeBoolean:function(e){this.writeVarint(!!e)},writeString:function(e){e=String(e),this.realloc(4*e.length),this.pos++;var t=this.pos;this.pos=function(l,f,m){for(var x,k,I=0;I<f.length;I++){if((x=f.charCodeAt(I))>55295&&x<57344){if(!k){x>56319||I+1===f.length?(l[m++]=239,l[m++]=191,l[m++]=189):k=x;continue}if(x<56320){l[m++]=239,l[m++]=191,l[m++]=189,k=x;continue}x=k-55296<<10|x-56320|65536,k=null}else k&&(l[m++]=239,l[m++]=191,l[m++]=189,k=null);x<128?l[m++]=x:(x<2048?l[m++]=x>>6|192:(x<65536?l[m++]=x>>12|224:(l[m++]=x>>18|240,l[m++]=x>>12&63|128),l[m++]=x>>6&63|128),l[m++]=63&x|128)}return m}(this.buf,e,this.pos);var i=this.pos-t;i>=128&&df(t,i,this),this.pos=t-1,this.writeVarint(i),this.pos+=i},writeFloat:function(e){this.realloc(4),pf(this.buf,e,this.pos,!0,23,4),this.pos+=4},writeDouble:function(e){this.realloc(8),pf(this.buf,e,this.pos,!0,52,8),this.pos+=8},writeBytes:function(e){var t=e.length;this.writeVarint(t),this.realloc(t);for(var i=0;i<t;i++)this.buf[this.pos++]=e[i]},writeRawMessage:function(e,t){this.pos++;var i=this.pos;e(t,this);var l=this.pos-i;l>=128&&df(i,l,this),this.pos=i-1,this.writeVarint(l),this.pos+=l},writeMessage:function(e,t,i){this.writeTag(e,Vr.Bytes),this.writeRawMessage(t,i)},writePackedVarint:function(e,t){t.length&&this.writeMessage(e,dg,t)},writePackedSVarint:function(e,t){t.length&&this.writeMessage(e,mg,t)},writePackedBoolean:function(e,t){t.length&&this.writeMessage(e,_g,t)},writePackedFloat:function(e,t){t.length&&this.writeMessage(e,yg,t)},writePackedDouble:function(e,t){t.length&&this.writeMessage(e,gg,t)},writePackedFixed32:function(e,t){t.length&&this.writeMessage(e,vg,t)},writePackedSFixed32:function(e,t){t.length&&this.writeMessage(e,bg,t)},writePackedFixed64:function(e,t){t.length&&this.writeMessage(e,xg,t)},writePackedSFixed64:function(e,t){t.length&&this.writeMessage(e,wg,t)},writeBytesField:function(e,t){this.writeTag(e,Vr.Bytes),this.writeBytes(t)},writeFixed32Field:function(e,t){this.writeTag(e,Vr.Fixed32),this.writeFixed32(t)},writeSFixed32Field:function(e,t){this.writeTag(e,Vr.Fixed32),this.writeSFixed32(t)},writeFixed64Field:function(e,t){this.writeTag(e,Vr.Fixed64),this.writeFixed64(t)},writeSFixed64Field:function(e,t){this.writeTag(e,Vr.Fixed64),this.writeSFixed64(t)},writeVarintField:function(e,t){this.writeTag(e,Vr.Varint),this.writeVarint(t)},writeSVarintField:function(e,t){this.writeTag(e,Vr.Varint),this.writeSVarint(t)},writeStringField:function(e,t){this.writeTag(e,Vr.Bytes),this.writeString(t)},writeFloatField:function(e,t){this.writeTag(e,Vr.Fixed32),this.writeFloat(t)},writeDoubleField:function(e,t){this.writeTag(e,Vr.Fixed64),this.writeDouble(t)},writeBooleanField:function(e,t){this.writeVarintField(e,!!t)}};var Rc=function(e,t){var i=t.pixelRatio,l=t.version,f=t.stretchX,m=t.stretchY,x=t.content;this.paddedRect=e,this.pixelRatio=i,this.stretchX=f,this.stretchY=m,this.content=x,this.version=l},yu={tl:{configurable:!0},br:{configurable:!0},tlbr:{configurable:!0},displaySize:{configurable:!0}};yu.tl.get=function(){return[this.paddedRect.x+1,this.paddedRect.y+1]},yu.br.get=function(){return[this.paddedRect.x+this.paddedRect.w-1,this.paddedRect.y+this.paddedRect.h-1]},yu.tlbr.get=function(){return this.tl.concat(this.br)},yu.displaySize.get=function(){return[(this.paddedRect.w-2)/this.pixelRatio,(this.paddedRect.h-2)/this.pixelRatio]},Object.defineProperties(Rc.prototype,yu);var gu=function(e,t){var i={},l={};this.haveRenderCallbacks=[];var f=[];this.addImages(e,i,f),this.addImages(t,l,f);var m=yf(f),x=new jn({width:m.w||1,height:m.h||1});for(var k in e){var I=e[k],A=i[k].paddedRect;jn.copy(I.data,x,{x:0,y:0},{x:A.x+1,y:A.y+1},I.data)}for(var C in t){var B=t[C],U=l[C].paddedRect,j=U.x+1,J=U.y+1,Q=B.data.width,he=B.data.height;jn.copy(B.data,x,{x:0,y:0},{x:j,y:J},B.data),jn.copy(B.data,x,{x:0,y:he-1},{x:j,y:J-1},{width:Q,height:1}),jn.copy(B.data,x,{x:0,y:0},{x:j,y:J+he},{width:Q,height:1}),jn.copy(B.data,x,{x:Q-1,y:0},{x:j-1,y:J},{width:1,height:he}),jn.copy(B.data,x,{x:0,y:0},{x:j+Q,y:J},{width:1,height:he})}this.image=x,this.iconPositions=i,this.patternPositions=l};gu.prototype.addImages=function(e,t,i){for(var l in e){var f=e[l],m={x:0,y:0,w:f.data.width+2,h:f.data.height+2};i.push(m),t[l]=new Rc(m,f),f.hasRenderCallback&&this.haveRenderCallbacks.push(l)}},gu.prototype.patchUpdatedImages=function(e,t){for(var i in e.dispatchRenderCallbacks(this.haveRenderCallbacks),e.updatedImages)this.patchUpdatedImage(this.iconPositions[i],e.getImage(i),t),this.patchUpdatedImage(this.patternPositions[i],e.getImage(i),t)},gu.prototype.patchUpdatedImage=function(e,t,i){if(e&&t&&e.version!==t.version){e.version=t.version;var l=e.tl;i.update(t.data,void 0,{x:l[0],y:l[1]})}},ft("ImagePosition",Rc),ft("ImageAtlas",gu);var sa={horizontal:1,vertical:2,horizontalOnly:3},hl=function(){this.scale=1,this.fontStack="",this.imageName=null};hl.forText=function(e,t){var i=new hl;return i.scale=e||1,i.fontStack=t,i},hl.forImage=function(e){var t=new hl;return t.imageName=e,t};var wn=function(){this.text="",this.sectionIndex=[],this.sections=[],this.imageSectionID=null};function Bc(e,t,i,l,f,m,x,k,I,A,C,B,U,j,J,Q){var he,ie=wn.fromFeature(e,f);B===sa.vertical&&ie.verticalizePunctuation();var me=Qn.processBidirectionalText,be=Qn.processStyledBidirectionalText;if(me&&ie.sections.length===1){he=[];for(var Se=0,Ee=me(ie.toString(),ap(ie,A,m,t,l,j,J));Se<Ee.length;Se+=1){var Ce=Ee[Se],Ve=new wn;Ve.text=Ce,Ve.sections=ie.sections;for(var Je=0;Je<Ce.length;Je++)Ve.sectionIndex.push(0);he.push(Ve)}}else if(be){he=[];for(var bt=0,nt=be(ie.text,ie.sectionIndex,ap(ie,A,m,t,l,j,J));bt<nt.length;bt+=1){var Et=nt[bt],at=new wn;at.text=Et[0],at.sectionIndex=Et[1],at.sections=ie.sections,he.push(at)}}else he=function(_t,lr){for(var Gt=[],yr=_t.text,zt=0,xr=0,Yr=lr;xr<Yr.length;xr+=1){var oi=Yr[xr];Gt.push(_t.substring(zt,oi)),zt=oi}return zt<yr.length&&Gt.push(_t.substring(zt,yr.length)),Gt}(ie,ap(ie,A,m,t,l,j,J));var $t=[],Dt={positionedLines:$t,text:ie.toString(),top:C[1],bottom:C[1],left:C[0],right:C[0],writingMode:B,iconsInText:!1,verticalizable:!1};return function(_t,lr,Gt,yr,zt,xr,Yr,oi,ei,Jr,si,Ui){for(var Vi=0,Sn=-17,Ji=0,kn=0,mi=oi==="right"?1:oi==="left"?0:.5,Qi=0,cr=0,Or=zt;cr<Or.length;cr+=1){var Pr=Or[cr];Pr.trim();var _r=Pr.getMaxScale(),Cn=24*(_r-1),hn={positionedGlyphs:[],lineOffset:0};_t.positionedLines[Qi]=hn;var Kr=hn.positionedGlyphs,Ei=0;if(Pr.length()){for(var pn=0;pn<Pr.length();pn++){var wr=Pr.getSection(pn),to=Pr.getSectionIndex(pn),la=Pr.getCharCode(pn),ro=0,yi=null,io=null,Pa=null,vl=24,Ms=!(ei===sa.horizontal||!si&&!Ys(la)||si&&(Oc[la]||(Do=la,et.Arabic(Do)||et["Arabic Supplement"](Do)||et["Arabic Extended-A"](Do)||et["Arabic Presentation Forms-A"](Do)||et["Arabic Presentation Forms-B"](Do))));if(wr.imageName){var bl=yr[wr.imageName];if(!bl)continue;Pa=wr.imageName,_t.iconsInText=_t.iconsInText||!0,io=bl.paddedRect;var Mo=bl.displaySize;wr.scale=24*wr.scale/Ui,ro=Cn+(24-Mo[1]*wr.scale),vl=(yi={width:Mo[0],height:Mo[1],left:1,top:-3,advance:Ms?Mo[1]:Mo[0]}).advance;var xl=Ms?Mo[0]*wr.scale-24*_r:Mo[1]*wr.scale-24*_r;xl>0&&xl>Ei&&(Ei=xl)}else{var Kc=Gt[wr.fontStack],wl=Kc&&Kc[la];if(wl&&wl.rect)io=wl.rect,yi=wl.metrics;else{var bu=lr[wr.fontStack],Hc=bu&&bu[la];if(!Hc)continue;yi=Hc.metrics}ro=24*(_r-wr.scale)}Ms?(_t.verticalizable=!0,Kr.push({glyph:la,imageName:Pa,x:Vi,y:Sn+ro,vertical:Ms,scale:wr.scale,fontStack:wr.fontStack,sectionIndex:to,metrics:yi,rect:io}),Vi+=vl*wr.scale+Jr):(Kr.push({glyph:la,imageName:Pa,x:Vi,y:Sn+ro,vertical:Ms,scale:wr.scale,fontStack:wr.fontStack,sectionIndex:to,metrics:yi,rect:io}),Vi+=yi.advance*wr.scale+Jr)}Kr.length!==0&&(Ji=Math.max(Vi-Jr,Ji),Tg(Kr,0,Kr.length-1,mi,Ei)),Vi=0;var Xc=xr*_r+Ei;hn.lineOffset=Math.max(Ei,Cn),Sn+=Xc,kn=Math.max(Xc,kn),++Qi}else Sn+=xr,++Qi}var Do,xu=Sn- -17,Sl=op(Yr),Qo=Sl.horizontalAlign,kl=Sl.verticalAlign;(function(Wc,Yc,wu,Su,Jc,ku,Eu,zu,Qc){var El,$c=(Yc-wu)*Jc;El=ku!==Eu?-zu*Su- -17:(-Su*Qc+.5)*Eu;for(var zl=0,Tu=Wc;zl<Tu.length;zl+=1)for(var Ds=0,Iu=Tu[zl].positionedGlyphs;Ds<Iu.length;Ds+=1){var Tl=Iu[Ds];Tl.x+=$c,Tl.y+=El}})(_t.positionedLines,mi,Qo,kl,Ji,kn,xr,xu,zt.length),_t.top+=-kl*xu,_t.bottom=_t.top+xu,_t.left+=-Qo*Ji,_t.right=_t.left+Ji}(Dt,t,i,l,he,x,k,I,B,A,U,Q),!function(_t){for(var lr=0,Gt=_t;lr<Gt.length;lr+=1)if(Gt[lr].positionedGlyphs.length!==0)return!1;return!0}($t)&&Dt}wn.fromFeature=function(e,t){for(var i=new wn,l=0;l<e.sections.length;l++){var f=e.sections[l];f.image?i.addImageSection(f):i.addTextSection(f,t)}return i},wn.prototype.length=function(){return this.text.length},wn.prototype.getSection=function(e){return this.sections[this.sectionIndex[e]]},wn.prototype.getSectionIndex=function(e){return this.sectionIndex[e]},wn.prototype.getCharCode=function(e){return this.text.charCodeAt(e)},wn.prototype.verticalizePunctuation=function(){this.text=function(e){for(var t="",i=0;i<e.length;i++){var l=e.charCodeAt(i+1)||null,f=e.charCodeAt(i-1)||null;t+=l&&eu(l)&&!mu[e[i+1]]||f&&eu(f)&&!mu[e[i-1]]||!mu[e[i]]?e[i]:mu[e[i]]}return t}(this.text)},wn.prototype.trim=function(){for(var e=0,t=0;t<this.text.length&&Oc[this.text.charCodeAt(t)];t++)e++;for(var i=this.text.length,l=this.text.length-1;l>=0&&l>=e&&Oc[this.text.charCodeAt(l)];l--)i--;this.text=this.text.substring(e,i),this.sectionIndex=this.sectionIndex.slice(e,i)},wn.prototype.substring=function(e,t){var i=new wn;return i.text=this.text.substring(e,t),i.sectionIndex=this.sectionIndex.slice(e,t),i.sections=this.sections,i},wn.prototype.toString=function(){return this.text},wn.prototype.getMaxScale=function(){var e=this;return this.sectionIndex.reduce(function(t,i){return Math.max(t,e.sections[i].scale)},0)},wn.prototype.addTextSection=function(e,t){this.text+=e.text,this.sections.push(hl.forText(e.scale,e.fontStack||t));for(var i=this.sections.length-1,l=0;l<e.text.length;++l)this.sectionIndex.push(i)},wn.prototype.addImageSection=function(e){var t=e.image?e.image.name:"";if(t.length!==0){var i=this.getNextImageSectionCharCode();i?(this.text+=String.fromCharCode(i),this.sections.push(hl.forImage(t)),this.sectionIndex.push(this.sections.length-1)):yt("Reached maximum number of images 6401")}else yt("Can't add FormattedSection with an empty image.")},wn.prototype.getNextImageSectionCharCode=function(){return this.imageSectionID?this.imageSectionID>=63743?null:++this.imageSectionID:(this.imageSectionID=57344,this.imageSectionID)};var Oc={9:!0,10:!0,11:!0,12:!0,13:!0,32:!0},ea={};function gf(e,t,i,l,f,m){if(t.imageName){var x=l[t.imageName];return x?x.displaySize[0]*t.scale*24/m+f:0}var k=i[t.fontStack],I=k&&k[e];return I?I.metrics.advance*t.scale+f:0}function _f(e,t,i,l){var f=Math.pow(e-t,2);return l?e<t?f/2:2*f:f+Math.abs(i)*i}function zg(e,t,i){var l=0;return e===10&&(l-=1e4),i&&(l+=150),e!==40&&e!==65288||(l+=50),t!==41&&t!==65289||(l+=50),l}function vf(e,t,i,l,f,m){for(var x=null,k=_f(t,i,f,m),I=0,A=l;I<A.length;I+=1){var C=A[I],B=_f(t-C.x,i,f,m)+C.badness;B<=k&&(x=C,k=B)}return{index:e,x:t,priorBreak:x,badness:k}}function ap(e,t,i,l,f,m,x){if(m!=="point")return[];if(!e)return[];for(var k,I=[],A=function(he,ie,me,be,Se,Ee){for(var Ce=0,Ve=0;Ve<he.length();Ve++){var Je=he.getSection(Ve);Ce+=gf(he.getCharCode(Ve),Je,be,Se,ie,Ee)}return Ce/Math.max(1,Math.ceil(Ce/me))}(e,t,i,l,f,x),C=e.text.indexOf("")>=0,B=0,U=0;U<e.length();U++){var j=e.getSection(U),J=e.getCharCode(U);if(Oc[J]||(B+=gf(J,j,l,f,t,x)),U<e.length()-1){var Q=!((k=J)<11904||!(et["Bopomofo Extended"](k)||et.Bopomofo(k)||et["CJK Compatibility Forms"](k)||et["CJK Compatibility Ideographs"](k)||et["CJK Compatibility"](k)||et["CJK Radicals Supplement"](k)||et["CJK Strokes"](k)||et["CJK Symbols and Punctuation"](k)||et["CJK Unified Ideographs Extension A"](k)||et["CJK Unified Ideographs"](k)||et["Enclosed CJK Letters and Months"](k)||et["Halfwidth and Fullwidth Forms"](k)||et.Hiragana(k)||et["Ideographic Description Characters"](k)||et["Kangxi Radicals"](k)||et["Katakana Phonetic Extensions"](k)||et.Katakana(k)||et["Vertical Forms"](k)||et["Yi Radicals"](k)||et["Yi Syllables"](k)));(ea[J]||Q||j.imageName)&&I.push(vf(U+1,B,A,I,zg(J,e.getCharCode(U+1),Q&&C),!1))}}return function he(ie){return ie?he(ie.priorBreak).concat(ie.index):[]}(vf(e.length(),B,A,I,0,!0))}function op(e){var t=.5,i=.5;switch(e){case"right":case"top-right":case"bottom-right":t=1;break;case"left":case"top-left":case"bottom-left":t=0}switch(e){case"bottom":case"bottom-right":case"bottom-left":i=1;break;case"top":case"top-right":case"top-left":i=0}return{horizontalAlign:t,verticalAlign:i}}function Tg(e,t,i,l,f){if(l||f)for(var m=e[i],x=(e[i].x+m.metrics.advance*m.scale)*l,k=t;k<=i;k++)e[k].x-=x,e[k].y+=f}function bf(e,t,i,l,f,m){var x,k=e.image;if(k.content){var I=k.content,A=k.pixelRatio||1;x=[I[0]/A,I[1]/A,k.displaySize[0]-I[2]/A,k.displaySize[1]-I[3]/A]}var C,B,U,j,J=t.left*m,Q=t.right*m;i==="width"||i==="both"?(j=f[0]+J-l[3],B=f[0]+Q+l[1]):B=(j=f[0]+(J+Q-k.displaySize[0])/2)+k.displaySize[0];var he=t.top*m,ie=t.bottom*m;return i==="height"||i==="both"?(C=f[1]+he-l[0],U=f[1]+ie+l[2]):U=(C=f[1]+(he+ie-k.displaySize[1])/2)+k.displaySize[1],{image:k,top:C,right:B,bottom:U,left:j,collisionPadding:x}}ea[10]=!0,ea[32]=!0,ea[38]=!0,ea[40]=!0,ea[41]=!0,ea[43]=!0,ea[45]=!0,ea[47]=!0,ea[173]=!0,ea[183]=!0,ea[8203]=!0,ea[8208]=!0,ea[8211]=!0,ea[8231]=!0;var pl=function(e){function t(i,l,f,m){e.call(this,i,l),this.angle=f,m!==void 0&&(this.segment=m)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.clone=function(){return new t(this.x,this.y,this.angle,this.segment)},t}(F);function sp(e,t){var i=t.expression;if(i.kind==="constant")return{kind:"constant",layoutSize:i.evaluate(new ur(e+1))};if(i.kind==="source")return{kind:"source"};for(var l=i.zoomStops,f=i.interpolationType,m=0;m<l.length&&l[m]<=e;)m++;for(var x=m=Math.max(0,m-1);x<l.length&&l[x]<e+1;)x++;x=Math.min(l.length-1,x);var k=l[m],I=l[x];return i.kind==="composite"?{kind:"composite",minZoom:k,maxZoom:I,interpolationType:f}:{kind:"camera",minZoom:k,maxZoom:I,minSize:i.evaluate(new ur(k)),maxSize:i.evaluate(new ur(I)),interpolationType:f}}function xf(e,t,i){var l=t.uSize,f=i.lowerSize;return e.kind==="source"?f/128:e.kind==="composite"?Si(f/128,i.upperSize/128,t.uSizeT):l}function wf(e,t){var i=0,l=0;if(e.kind==="constant")l=e.layoutSize;else if(e.kind!=="source"){var f=e.interpolationType,m=f?ve(rn.interpolationFactor(f,t,e.minZoom,e.maxZoom),0,1):0;e.kind==="camera"?l=Si(e.minSize,e.maxSize,m):i=m}return{uSizeT:i,uSize:l}}ft("Anchor",pl);var Ig=Object.freeze({__proto__:null,getSizeData:sp,evaluateSizeForFeature:xf,evaluateSizeForZoom:wf,SIZE_PACK_FACTOR:128});function Sf(e,t,i,l,f){if(t.segment===void 0)return!0;for(var m=t,x=t.segment+1,k=0;k>-i/2;){if(--x<0)return!1;k-=e[x].dist(m),m=e[x]}k+=e[x].dist(e[x+1]),x++;for(var I=[],A=0;k<i/2;){var C=e[x],B=e[x+1];if(!B)return!1;var U=e[x-1].angleTo(C)-C.angleTo(B);for(U=Math.abs((U+3*Math.PI)%(2*Math.PI)-Math.PI),I.push({distance:k,angleDelta:U}),A+=U;k-I[0].distance>l;)A-=I.shift().angleDelta;if(A>f)return!1;x++,k+=C.dist(B)}return!0}function kf(e){for(var t=0,i=0;i<e.length-1;i++)t+=e[i].dist(e[i+1]);return t}function Ef(e,t,i){return e?.6*t*i:0}function zf(e,t){return Math.max(e?e.right-e.left:0,t?t.right-t.left:0)}function Ag(e,t,i,l,f,m){for(var x=Ef(i,f,m),k=zf(i,l)*m,I=0,A=kf(e)/2,C=0;C<e.length-1;C++){var B=e[C],U=e[C+1],j=B.dist(U);if(I+j>A){var J=(A-I)/j,Q=Si(B.x,U.x,J),he=Si(B.y,U.y,J),ie=new pl(Q,he,U.angleTo(B),C);return ie._round(),!x||Sf(e,ie,k,x,t)?ie:void 0}I+=j}}function Pg(e,t,i,l,f,m,x,k,I){var A=Ef(l,m,x),C=zf(l,f),B=C*x,U=e[0].x===0||e[0].x===I||e[0].y===0||e[0].y===I;return t-B<t/4&&(t=B+t/4),function j(J,Q,he,ie,me,be,Se,Ee,Ce){for(var Ve=be/2,Je=kf(J),bt=0,nt=Q-he,Et=[],at=0;at<J.length-1;at++){for(var $t=J[at],Dt=J[at+1],_t=$t.dist(Dt),lr=Dt.angleTo($t);nt+he<bt+_t;){var Gt=((nt+=he)-bt)/_t,yr=Si($t.x,Dt.x,Gt),zt=Si($t.y,Dt.y,Gt);if(yr>=0&&yr<Ce&&zt>=0&&zt<Ce&&nt-Ve>=0&&nt+Ve<=Je){var xr=new pl(yr,zt,lr,at);xr._round(),ie&&!Sf(J,xr,be,ie,me)||Et.push(xr)}}bt+=_t}return Ee||Et.length||Se||(Et=j(J,bt/2,he,ie,me,be,Se,!0,Ce)),Et}(e,U?t/2*k%t:(C/2+2*m)*x*k%t,t,A,i,B,U,!1,I)}function Tf(e,t,i,l,f){for(var m=[],x=0;x<e.length;x++)for(var k=e[x],I=void 0,A=0;A<k.length-1;A++){var C=k[A],B=k[A+1];C.x<t&&B.x<t||(C.x<t?C=new F(t,C.y+(t-C.x)/(B.x-C.x)*(B.y-C.y))._round():B.x<t&&(B=new F(t,C.y+(t-C.x)/(B.x-C.x)*(B.y-C.y))._round()),C.y<i&&B.y<i||(C.y<i?C=new F(C.x+(i-C.y)/(B.y-C.y)*(B.x-C.x),i)._round():B.y<i&&(B=new F(C.x+(i-C.y)/(B.y-C.y)*(B.x-C.x),i)._round()),C.x>=l&&B.x>=l||(C.x>=l?C=new F(l,C.y+(l-C.x)/(B.x-C.x)*(B.y-C.y))._round():B.x>=l&&(B=new F(l,C.y+(l-C.x)/(B.x-C.x)*(B.y-C.y))._round()),C.y>=f&&B.y>=f||(C.y>=f?C=new F(C.x+(f-C.y)/(B.y-C.y)*(B.x-C.x),f)._round():B.y>=f&&(B=new F(C.x+(f-C.y)/(B.y-C.y)*(B.x-C.x),f)._round()),I&&C.equals(I[I.length-1])||m.push(I=[C]),I.push(B)))))}return m}function If(e,t,i,l){var f=[],m=e.image,x=m.pixelRatio,k=m.paddedRect.w-2,I=m.paddedRect.h-2,A=e.right-e.left,C=e.bottom-e.top,B=m.stretchX||[[0,k]],U=m.stretchY||[[0,I]],j=function(yr,zt){return yr+zt[1]-zt[0]},J=B.reduce(j,0),Q=U.reduce(j,0),he=k-J,ie=I-Q,me=0,be=J,Se=0,Ee=Q,Ce=0,Ve=he,Je=0,bt=ie;if(m.content&&l){var nt=m.content;me=Fc(B,0,nt[0]),Se=Fc(U,0,nt[1]),be=Fc(B,nt[0],nt[2]),Ee=Fc(U,nt[1],nt[3]),Ce=nt[0]-me,Je=nt[1]-Se,Ve=nt[2]-nt[0]-be,bt=nt[3]-nt[1]-Ee}var Et=function(yr,zt,xr,Yr){var oi=Nc(yr.stretch-me,be,A,e.left),ei=Uc(yr.fixed-Ce,Ve,yr.stretch,J),Jr=Nc(zt.stretch-Se,Ee,C,e.top),si=Uc(zt.fixed-Je,bt,zt.stretch,Q),Ui=Nc(xr.stretch-me,be,A,e.left),Vi=Uc(xr.fixed-Ce,Ve,xr.stretch,J),Sn=Nc(Yr.stretch-Se,Ee,C,e.top),Ji=Uc(Yr.fixed-Je,bt,Yr.stretch,Q),kn=new F(oi,Jr),mi=new F(Ui,Jr),Qi=new F(Ui,Sn),cr=new F(oi,Sn),Or=new F(ei/x,si/x),Pr=new F(Vi/x,Ji/x),_r=t*Math.PI/180;if(_r){var Cn=Math.sin(_r),hn=Math.cos(_r),Kr=[hn,-Cn,Cn,hn];kn._matMult(Kr),mi._matMult(Kr),cr._matMult(Kr),Qi._matMult(Kr)}var Ei=yr.stretch+yr.fixed,pn=zt.stretch+zt.fixed;return{tl:kn,tr:mi,bl:cr,br:Qi,tex:{x:m.paddedRect.x+1+Ei,y:m.paddedRect.y+1+pn,w:xr.stretch+xr.fixed-Ei,h:Yr.stretch+Yr.fixed-pn},writingMode:void 0,glyphOffset:[0,0],sectionIndex:0,pixelOffsetTL:Or,pixelOffsetBR:Pr,minFontScaleX:Ve/x/A,minFontScaleY:bt/x/C,isSDF:i}};if(l&&(m.stretchX||m.stretchY))for(var at=Af(B,he,J),$t=Af(U,ie,Q),Dt=0;Dt<at.length-1;Dt++)for(var _t=at[Dt],lr=at[Dt+1],Gt=0;Gt<$t.length-1;Gt++)f.push(Et(_t,$t[Gt],lr,$t[Gt+1]));else f.push(Et({fixed:0,stretch:-1},{fixed:0,stretch:-1},{fixed:0,stretch:k+1},{fixed:0,stretch:I+1}));return f}function Fc(e,t,i){for(var l=0,f=0,m=e;f<m.length;f+=1){var x=m[f];l+=Math.max(t,Math.min(i,x[1]))-Math.max(t,Math.min(i,x[0]))}return l}function Af(e,t,i){for(var l=[{fixed:-1,stretch:0}],f=0,m=e;f<m.length;f+=1){var x=m[f],k=x[0],I=x[1],A=l[l.length-1];l.push({fixed:k-A.stretch,stretch:A.stretch}),l.push({fixed:k-A.stretch,stretch:A.stretch+(I-k)})}return l.push({fixed:t+1,stretch:i}),l}function Nc(e,t,i,l){return e/t*i+l}function Uc(e,t,i,l){return e-t*i/l}var Vc=function(e,t,i,l,f,m,x,k,I,A){if(this.boxStartIndex=e.length,I){var C=m.top,B=m.bottom,U=m.collisionPadding;U&&(C-=U[1],B+=U[3]);var j=B-C;j>0&&(j=Math.max(10,j),this.circleDiameter=j)}else{var J=m.top*x-k,Q=m.bottom*x+k,he=m.left*x-k,ie=m.right*x+k,me=m.collisionPadding;if(me&&(he-=me[0]*x,J-=me[1]*x,ie+=me[2]*x,Q+=me[3]*x),A){var be=new F(he,J),Se=new F(ie,J),Ee=new F(he,Q),Ce=new F(ie,Q),Ve=A*Math.PI/180;be._rotate(Ve),Se._rotate(Ve),Ee._rotate(Ve),Ce._rotate(Ve),he=Math.min(be.x,Se.x,Ee.x,Ce.x),ie=Math.max(be.x,Se.x,Ee.x,Ce.x),J=Math.min(be.y,Se.y,Ee.y,Ce.y),Q=Math.max(be.y,Se.y,Ee.y,Ce.y)}e.emplaceBack(t.x,t.y,he,J,ie,Q,i,l,f)}this.boxEndIndex=e.length},fl=function(e,t){if(e===void 0&&(e=[]),t===void 0&&(t=Cg),this.data=e,this.length=this.data.length,this.compare=t,this.length>0)for(var i=(this.length>>1)-1;i>=0;i--)this._down(i)};function Cg(e,t){return e<t?-1:e>t?1:0}function Mg(e,t,i){t===void 0&&(t=1),i===void 0&&(i=!1);for(var l=1/0,f=1/0,m=-1/0,x=-1/0,k=e[0],I=0;I<k.length;I++){var A=k[I];(!I||A.x<l)&&(l=A.x),(!I||A.y<f)&&(f=A.y),(!I||A.x>m)&&(m=A.x),(!I||A.y>x)&&(x=A.y)}var C=Math.min(m-l,x-f),B=C/2,U=new fl([],Dg);if(C===0)return new F(l,f);for(var j=l;j<m;j+=C)for(var J=f;J<x;J+=C)U.push(new dl(j+B,J+B,B,e));for(var Q=function(me){for(var be=0,Se=0,Ee=0,Ce=me[0],Ve=0,Je=Ce.length,bt=Je-1;Ve<Je;bt=Ve++){var nt=Ce[Ve],Et=Ce[bt],at=nt.x*Et.y-Et.x*nt.y;Se+=(nt.x+Et.x)*at,Ee+=(nt.y+Et.y)*at,be+=3*at}return new dl(Se/be,Ee/be,0,me)}(e),he=U.length;U.length;){var ie=U.pop();(ie.d>Q.d||!Q.d)&&(Q=ie,i&&console.log("found best %d after %d probes",Math.round(1e4*ie.d)/1e4,he)),ie.max-Q.d<=t||(U.push(new dl(ie.p.x-(B=ie.h/2),ie.p.y-B,B,e)),U.push(new dl(ie.p.x+B,ie.p.y-B,B,e)),U.push(new dl(ie.p.x-B,ie.p.y+B,B,e)),U.push(new dl(ie.p.x+B,ie.p.y+B,B,e)),he+=4)}return i&&(console.log("num probes: "+he),console.log("best distance: "+Q.d)),Q.p}function Dg(e,t){return t.max-e.max}function dl(e,t,i,l){this.p=new F(e,t),this.h=i,this.d=function(f,m){for(var x=!1,k=1/0,I=0;I<m.length;I++)for(var A=m[I],C=0,B=A.length,U=B-1;C<B;U=C++){var j=A[C],J=A[U];j.y>f.y!=J.y>f.y&&f.x<(J.x-j.x)*(f.y-j.y)/(J.y-j.y)+j.x&&(x=!x),k=Math.min(k,Xo(f,j,J))}return(x?1:-1)*Math.sqrt(k)}(this.p,l),this.max=this.d+this.h*Math.SQRT2}fl.prototype.push=function(e){this.data.push(e),this.length++,this._up(this.length-1)},fl.prototype.pop=function(){if(this.length!==0){var e=this.data[0],t=this.data.pop();return this.length--,this.length>0&&(this.data[0]=t,this._down(0)),e}},fl.prototype.peek=function(){return this.data[0]},fl.prototype._up=function(e){for(var t=this.data,i=this.compare,l=t[e];e>0;){var f=e-1>>1,m=t[f];if(i(l,m)>=0)break;t[e]=m,e=f}t[e]=l},fl.prototype._down=function(e){for(var t=this.data,i=this.compare,l=this.length>>1,f=t[e];e<l;){var m=1+(e<<1),x=t[m],k=m+1;if(k<this.length&&i(t[k],x)<0&&(m=k,x=t[k]),i(x,f)>=0)break;t[e]=x,e=m}t[e]=f};var lp=Number.POSITIVE_INFINITY;function Pf(e,t){return t[1]!==lp?function(i,l,f){var m=0,x=0;switch(l=Math.abs(l),f=Math.abs(f),i){case"top-right":case"top-left":case"top":x=f-7;break;case"bottom-right":case"bottom-left":case"bottom":x=7-f}switch(i){case"top-right":case"bottom-right":case"right":m=-l;break;case"top-left":case"bottom-left":case"left":m=l}return[m,x]}(e,t[0],t[1]):function(i,l){var f=0,m=0;l<0&&(l=0);var x=l/Math.sqrt(2);switch(i){case"top-right":case"top-left":m=x-7;break;case"bottom-right":case"bottom-left":m=7-x;break;case"bottom":m=7-l;break;case"top":m=l-7}switch(i){case"top-right":case"bottom-right":f=-x;break;case"top-left":case"bottom-left":f=x;break;case"left":f=l;break;case"right":f=-l}return[f,m]}(e,t[0])}function up(e){switch(e){case"right":case"top-right":case"bottom-right":return"right";case"left":case"top-left":case"bottom-left":return"left"}return"center"}function Cf(e,t,i,l,f,m,x,k,I,A,C,B,U,j,J){var Q=function(Se,Ee,Ce,Ve,Je,bt,nt,Et){for(var at=Ve.layout.get("text-rotate").evaluate(bt,{})*Math.PI/180,$t=[],Dt=0,_t=Ee.positionedLines;Dt<_t.length;Dt+=1)for(var lr=_t[Dt],Gt=0,yr=lr.positionedGlyphs;Gt<yr.length;Gt+=1){var zt=yr[Gt];if(zt.rect){var xr=zt.rect||{},Yr=4,oi=!0,ei=1,Jr=0,si=(Je||Et)&&zt.vertical,Ui=zt.metrics.advance*zt.scale/2;if(Et&&Ee.verticalizable&&(Jr=lr.lineOffset/2-(zt.imageName?-(24-zt.metrics.width*zt.scale)/2:24*(zt.scale-1))),zt.imageName){var Vi=nt[zt.imageName];oi=Vi.sdf,Yr=1/(ei=Vi.pixelRatio)}var Sn=Je?[zt.x+Ui,zt.y]:[0,0],Ji=Je?[0,0]:[zt.x+Ui+Ce[0],zt.y+Ce[1]-Jr],kn=[0,0];si&&(kn=Ji,Ji=[0,0]);var mi=(zt.metrics.left-Yr)*zt.scale-Ui+Ji[0],Qi=(-zt.metrics.top-Yr)*zt.scale+Ji[1],cr=mi+xr.w*zt.scale/ei,Or=Qi+xr.h*zt.scale/ei,Pr=new F(mi,Qi),_r=new F(cr,Qi),Cn=new F(mi,Or),hn=new F(cr,Or);if(si){var Kr=new F(-Ui,Ui- -17),Ei=-Math.PI/2,pn=12-Ui,wr=new F(22-pn,-(zt.imageName?pn:0)),to=new(Function.prototype.bind.apply(F,[null].concat(kn)));Pr._rotateAround(Ei,Kr)._add(wr)._add(to),_r._rotateAround(Ei,Kr)._add(wr)._add(to),Cn._rotateAround(Ei,Kr)._add(wr)._add(to),hn._rotateAround(Ei,Kr)._add(wr)._add(to)}if(at){var la=Math.sin(at),ro=Math.cos(at),yi=[ro,-la,la,ro];Pr._matMult(yi),_r._matMult(yi),Cn._matMult(yi),hn._matMult(yi)}var io=new F(0,0),Pa=new F(0,0);$t.push({tl:Pr,tr:_r,bl:Cn,br:hn,tex:xr,writingMode:Ee.writingMode,glyphOffset:Sn,sectionIndex:zt.sectionIndex,isSDF:oi,pixelOffsetTL:io,pixelOffsetBR:Pa,minFontScaleX:0,minFontScaleY:0})}}return $t}(0,i,k,f,m,x,l,e.allowVerticalPlacement),he=e.textSizeData,ie=null;he.kind==="source"?(ie=[128*f.layout.get("text-size").evaluate(x,{})])[0]>32640&&yt(e.layerIds[0]+': Value for "text-size" is >= 255. Reduce your "text-size".'):he.kind==="composite"&&((ie=[128*j.compositeTextSizes[0].evaluate(x,{},J),128*j.compositeTextSizes[1].evaluate(x,{},J)])[0]>32640||ie[1]>32640)&&yt(e.layerIds[0]+': Value for "text-size" is >= 255. Reduce your "text-size".'),e.addSymbols(e.text,Q,ie,k,m,x,A,t,I.lineStartIndex,I.lineLength,U,J);for(var me=0,be=C;me<be.length;me+=1)B[be[me]]=e.text.placedSymbolArray.length-1;return 4*Q.length}function Mf(e){for(var t in e)return e[t];return null}function Lg(e,t,i,l){var f=e.compareText;if(t in f){for(var m=f[t],x=m.length-1;x>=0;x--)if(l.dist(m[x])<i)return!0}else f[t]=[];return f[t].push(l),!1}var Rg=ll.VectorTileFeature.types,Bg=[{name:"a_fade_opacity",components:1,type:"Uint8",offset:0}];function qc(e,t,i,l,f,m,x,k,I,A,C,B,U){var j=k?Math.min(32640,Math.round(k[0])):0,J=k?Math.min(32640,Math.round(k[1])):0;e.emplaceBack(t,i,Math.round(32*l),Math.round(32*f),m,x,(j<<1)+(I?1:0),J,16*A,16*C,256*B,256*U)}function cp(e,t,i){e.emplaceBack(t.x,t.y,i),e.emplaceBack(t.x,t.y,i),e.emplaceBack(t.x,t.y,i),e.emplaceBack(t.x,t.y,i)}function Og(e){for(var t=0,i=e.sections;t<i.length;t+=1)if(Js(i[t].text))return!0;return!1}var ml=function(e){this.layoutVertexArray=new tl,this.indexArray=new Wa,this.programConfigurations=e,this.segments=new G,this.dynamicLayoutVertexArray=new Go,this.opacityVertexArray=new ws,this.placedSymbolArray=new c};ml.prototype.isEmpty=function(){return this.layoutVertexArray.length===0&&this.indexArray.length===0&&this.dynamicLayoutVertexArray.length===0&&this.opacityVertexArray.length===0},ml.prototype.upload=function(e,t,i,l){this.isEmpty()||(i&&(this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,ug.members),this.indexBuffer=e.createIndexBuffer(this.indexArray,t),this.dynamicLayoutVertexBuffer=e.createVertexBuffer(this.dynamicLayoutVertexArray,cg.members,!0),this.opacityVertexBuffer=e.createVertexBuffer(this.opacityVertexArray,Bg,!0),this.opacityVertexBuffer.itemSize=1),(i||l)&&this.programConfigurations.upload(e))},ml.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.dynamicLayoutVertexBuffer.destroy(),this.opacityVertexBuffer.destroy())},ft("SymbolBuffers",ml);var _u=function(e,t,i){this.layoutVertexArray=new e,this.layoutAttributes=t,this.indexArray=new i,this.segments=new G,this.collisionVertexArray=new ou};_u.prototype.upload=function(e){this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,this.layoutAttributes),this.indexBuffer=e.createIndexBuffer(this.indexArray),this.collisionVertexBuffer=e.createVertexBuffer(this.collisionVertexArray,hg.members,!0)},_u.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.collisionVertexBuffer.destroy())},ft("CollisionBuffers",_u);var Lr=function(e){this.collisionBoxArray=e.collisionBoxArray,this.zoom=e.zoom,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map(function(m){return m.id}),this.index=e.index,this.pixelRatio=e.pixelRatio,this.sourceLayerIndex=e.sourceLayerIndex,this.hasPattern=!1,this.hasRTLText=!1,this.sortKeyRanges=[],this.collisionCircleArray=[],this.placementInvProjMatrix=$n([]),this.placementViewportMatrix=$n([]);var t=this.layers[0]._unevaluatedLayout._values;this.textSizeData=sp(this.zoom,t["text-size"]),this.iconSizeData=sp(this.zoom,t["icon-size"]);var i=this.layers[0].layout,l=i.get("symbol-sort-key"),f=i.get("symbol-z-order");this.canOverlap=i.get("text-allow-overlap")||i.get("icon-allow-overlap")||i.get("text-ignore-placement")||i.get("icon-ignore-placement"),this.sortFeaturesByKey=f!=="viewport-y"&&l.constantOr(1)!==void 0,this.sortFeaturesByY=(f==="viewport-y"||f==="auto"&&!this.sortFeaturesByKey)&&this.canOverlap,i.get("symbol-placement")==="point"&&(this.writingModes=i.get("text-writing-mode").map(function(m){return sa[m]})),this.stateDependentLayerIds=this.layers.filter(function(m){return m.isStateDependent()}).map(function(m){return m.id}),this.sourceID=e.sourceID};Lr.prototype.createArrays=function(){this.text=new ml(new Mt(this.layers,this.zoom,function(e){return/^text/.test(e)})),this.icon=new ml(new Mt(this.layers,this.zoom,function(e){return/^icon/.test(e)})),this.glyphOffsetArray=new S,this.lineVertexArray=new E,this.symbolInstances=new w},Lr.prototype.calculateGlyphDependencies=function(e,t,i,l,f){for(var m=0;m<e.length;m++)if(t[e.charCodeAt(m)]=!0,(i||l)&&f){var x=mu[e.charAt(m)];x&&(t[x.charCodeAt(0)]=!0)}},Lr.prototype.populate=function(e,t,i){var l=this.layers[0],f=l.layout,m=f.get("text-font"),x=f.get("text-field"),k=f.get("icon-image"),I=(x.value.kind!=="constant"||x.value.value instanceof ii&&!x.value.value.isEmpty()||x.value.value.toString().length>0)&&(m.value.kind!=="constant"||m.value.value.length>0),A=k.value.kind!=="constant"||!!k.value.value||Object.keys(k.parameters).length>0,C=f.get("symbol-sort-key");if(this.features=[],I||A){for(var B=t.iconDependencies,U=t.glyphDependencies,j=t.availableImages,J=new ur(this.zoom),Q=0,he=e;Q<he.length;Q+=1){var ie=he[Q],me=ie.feature,be=ie.id,Se=ie.index,Ee=ie.sourceLayerIndex,Ce=l._featureFilter.needGeometry,Ve=di(me,Ce);if(l._featureFilter.filter(J,Ve,i)){Ce||(Ve.geometry=$r(me));var Je=void 0;if(I){var bt=l.getValueAndResolveTokens("text-field",Ve,i,j),nt=ii.factory(bt);Og(nt)&&(this.hasRTLText=!0),(!this.hasRTLText||ru()==="unavailable"||this.hasRTLText&&Qn.isParsed())&&(Je=fg(nt,l,Ve))}var Et=void 0;if(A){var at=l.getValueAndResolveTokens("icon-image",Ve,i,j);Et=at instanceof Oi?at:Oi.fromString(at)}if(Je||Et){var $t=this.sortFeaturesByKey?C.evaluate(Ve,{},i):void 0;if(this.features.push({id:be,text:Je,icon:Et,index:Se,sourceLayerIndex:Ee,geometry:Ve.geometry,properties:me.properties,type:Rg[me.type],sortKey:$t}),Et&&(B[Et.name]=!0),Je){var Dt=m.evaluate(Ve,{},i).join(","),_t=f.get("text-rotation-alignment")==="map"&&f.get("symbol-placement")!=="point";this.allowVerticalPlacement=this.writingModes&&this.writingModes.indexOf(sa.vertical)>=0;for(var lr=0,Gt=Je.sections;lr<Gt.length;lr+=1){var yr=Gt[lr];if(yr.image)B[yr.image.name]=!0;else{var zt=$l(Je.toString()),xr=yr.fontStack||Dt,Yr=U[xr]=U[xr]||{};this.calculateGlyphDependencies(yr.text,Yr,_t,this.allowVerticalPlacement,zt)}}}}}}f.get("symbol-placement")==="line"&&(this.features=function(oi){var ei={},Jr={},si=[],Ui=0;function Vi(Kr){si.push(oi[Kr]),Ui++}function Sn(Kr,Ei,pn){var wr=Jr[Kr];return delete Jr[Kr],Jr[Ei]=wr,si[wr].geometry[0].pop(),si[wr].geometry[0]=si[wr].geometry[0].concat(pn[0]),wr}function Ji(Kr,Ei,pn){var wr=ei[Ei];return delete ei[Ei],ei[Kr]=wr,si[wr].geometry[0].shift(),si[wr].geometry[0]=pn[0].concat(si[wr].geometry[0]),wr}function kn(Kr,Ei,pn){var wr=pn?Ei[0][Ei[0].length-1]:Ei[0][0];return Kr+":"+wr.x+":"+wr.y}for(var mi=0;mi<oi.length;mi++){var Qi=oi[mi],cr=Qi.geometry,Or=Qi.text?Qi.text.toString():null;if(Or){var Pr=kn(Or,cr),_r=kn(Or,cr,!0);if(Pr in Jr&&_r in ei&&Jr[Pr]!==ei[_r]){var Cn=Ji(Pr,_r,cr),hn=Sn(Pr,_r,si[Cn].geometry);delete ei[Pr],delete Jr[_r],Jr[kn(Or,si[hn].geometry,!0)]=hn,si[Cn].geometry=null}else Pr in Jr?Sn(Pr,_r,cr):_r in ei?Ji(Pr,_r,cr):(Vi(mi),ei[Pr]=Ui-1,Jr[_r]=Ui-1)}else Vi(mi)}return si.filter(function(Kr){return Kr.geometry})}(this.features)),this.sortFeaturesByKey&&this.features.sort(function(oi,ei){return oi.sortKey-ei.sortKey})}},Lr.prototype.update=function(e,t,i){this.stateDependentLayers.length&&(this.text.programConfigurations.updatePaintArrays(e,t,this.layers,i),this.icon.programConfigurations.updatePaintArrays(e,t,this.layers,i))},Lr.prototype.isEmpty=function(){return this.symbolInstances.length===0&&!this.hasRTLText},Lr.prototype.uploadPending=function(){return!this.uploaded||this.text.programConfigurations.needsUpload||this.icon.programConfigurations.needsUpload},Lr.prototype.upload=function(e){!this.uploaded&&this.hasDebugData()&&(this.textCollisionBox.upload(e),this.iconCollisionBox.upload(e)),this.text.upload(e,this.sortFeaturesByY,!this.uploaded,this.text.programConfigurations.needsUpload),this.icon.upload(e,this.sortFeaturesByY,!this.uploaded,this.icon.programConfigurations.needsUpload),this.uploaded=!0},Lr.prototype.destroyDebugData=function(){this.textCollisionBox.destroy(),this.iconCollisionBox.destroy()},Lr.prototype.destroy=function(){this.text.destroy(),this.icon.destroy(),this.hasDebugData()&&this.destroyDebugData()},Lr.prototype.addToLineVertexArray=function(e,t){var i=this.lineVertexArray.length;if(e.segment!==void 0){for(var l=e.dist(t[e.segment+1]),f=e.dist(t[e.segment]),m={},x=e.segment+1;x<t.length;x++)m[x]={x:t[x].x,y:t[x].y,tileUnitDistanceFromAnchor:l},x<t.length-1&&(l+=t[x+1].dist(t[x]));for(var k=e.segment||0;k>=0;k--)m[k]={x:t[k].x,y:t[k].y,tileUnitDistanceFromAnchor:f},k>0&&(f+=t[k-1].dist(t[k]));for(var I=0;I<t.length;I++){var A=m[I];this.lineVertexArray.emplaceBack(A.x,A.y,A.tileUnitDistanceFromAnchor)}}return{lineStartIndex:i,lineLength:this.lineVertexArray.length-i}},Lr.prototype.addSymbols=function(e,t,i,l,f,m,x,k,I,A,C,B){for(var U=e.indexArray,j=e.layoutVertexArray,J=e.segments.prepareSegment(4*t.length,j,U,this.canOverlap?m.sortKey:void 0),Q=this.glyphOffsetArray.length,he=J.vertexLength,ie=this.allowVerticalPlacement&&x===sa.vertical?Math.PI/2:0,me=m.text&&m.text.sections,be=0;be<t.length;be++){var Se=t[be],Ee=Se.tl,Ce=Se.tr,Ve=Se.bl,Je=Se.br,bt=Se.tex,nt=Se.pixelOffsetTL,Et=Se.pixelOffsetBR,at=Se.minFontScaleX,$t=Se.minFontScaleY,Dt=Se.glyphOffset,_t=Se.isSDF,lr=Se.sectionIndex,Gt=J.vertexLength,yr=Dt[1];qc(j,k.x,k.y,Ee.x,yr+Ee.y,bt.x,bt.y,i,_t,nt.x,nt.y,at,$t),qc(j,k.x,k.y,Ce.x,yr+Ce.y,bt.x+bt.w,bt.y,i,_t,Et.x,nt.y,at,$t),qc(j,k.x,k.y,Ve.x,yr+Ve.y,bt.x,bt.y+bt.h,i,_t,nt.x,Et.y,at,$t),qc(j,k.x,k.y,Je.x,yr+Je.y,bt.x+bt.w,bt.y+bt.h,i,_t,Et.x,Et.y,at,$t),cp(e.dynamicLayoutVertexArray,k,ie),U.emplaceBack(Gt,Gt+1,Gt+2),U.emplaceBack(Gt+1,Gt+2,Gt+3),J.vertexLength+=4,J.primitiveLength+=2,this.glyphOffsetArray.emplaceBack(Dt[0]),be!==t.length-1&&lr===t[be+1].sectionIndex||e.programConfigurations.populatePaintArrays(j.length,m,m.index,{},B,me&&me[lr])}e.placedSymbolArray.emplaceBack(k.x,k.y,Q,this.glyphOffsetArray.length-Q,he,I,A,k.segment,i?i[0]:0,i?i[1]:0,l[0],l[1],x,0,!1,0,C)},Lr.prototype._addCollisionDebugVertex=function(e,t,i,l,f,m){return t.emplaceBack(0,0),e.emplaceBack(i.x,i.y,l,f,Math.round(m.x),Math.round(m.y))},Lr.prototype.addCollisionDebugVertices=function(e,t,i,l,f,m,x){var k=f.segments.prepareSegment(4,f.layoutVertexArray,f.indexArray),I=k.vertexLength,A=f.layoutVertexArray,C=f.collisionVertexArray,B=x.anchorX,U=x.anchorY;this._addCollisionDebugVertex(A,C,m,B,U,new F(e,t)),this._addCollisionDebugVertex(A,C,m,B,U,new F(i,t)),this._addCollisionDebugVertex(A,C,m,B,U,new F(i,l)),this._addCollisionDebugVertex(A,C,m,B,U,new F(e,l)),k.vertexLength+=4;var j=f.indexArray;j.emplaceBack(I,I+1),j.emplaceBack(I+1,I+2),j.emplaceBack(I+2,I+3),j.emplaceBack(I+3,I),k.primitiveLength+=4},Lr.prototype.addDebugCollisionBoxes=function(e,t,i,l){for(var f=e;f<t;f++){var m=this.collisionBoxArray.get(f);this.addCollisionDebugVertices(m.x1,m.y1,m.x2,m.y2,l?this.textCollisionBox:this.iconCollisionBox,m.anchorPoint,i)}},Lr.prototype.generateCollisionDebugBuffers=function(){this.hasDebugData()&&this.destroyDebugData(),this.textCollisionBox=new _u(Ko,cf.members,Ss),this.iconCollisionBox=new _u(Ko,cf.members,Ss);for(var e=0;e<this.symbolInstances.length;e++){var t=this.symbolInstances.get(e);this.addDebugCollisionBoxes(t.textBoxStartIndex,t.textBoxEndIndex,t,!0),this.addDebugCollisionBoxes(t.verticalTextBoxStartIndex,t.verticalTextBoxEndIndex,t,!0),this.addDebugCollisionBoxes(t.iconBoxStartIndex,t.iconBoxEndIndex,t,!1),this.addDebugCollisionBoxes(t.verticalIconBoxStartIndex,t.verticalIconBoxEndIndex,t,!1)}},Lr.prototype._deserializeCollisionBoxesForSymbol=function(e,t,i,l,f,m,x,k,I){for(var A={},C=t;C<i;C++){var B=e.get(C);A.textBox={x1:B.x1,y1:B.y1,x2:B.x2,y2:B.y2,anchorPointX:B.anchorPointX,anchorPointY:B.anchorPointY},A.textFeatureIndex=B.featureIndex;break}for(var U=l;U<f;U++){var j=e.get(U);A.verticalTextBox={x1:j.x1,y1:j.y1,x2:j.x2,y2:j.y2,anchorPointX:j.anchorPointX,anchorPointY:j.anchorPointY},A.verticalTextFeatureIndex=j.featureIndex;break}for(var J=m;J<x;J++){var Q=e.get(J);A.iconBox={x1:Q.x1,y1:Q.y1,x2:Q.x2,y2:Q.y2,anchorPointX:Q.anchorPointX,anchorPointY:Q.anchorPointY},A.iconFeatureIndex=Q.featureIndex;break}for(var he=k;he<I;he++){var ie=e.get(he);A.verticalIconBox={x1:ie.x1,y1:ie.y1,x2:ie.x2,y2:ie.y2,anchorPointX:ie.anchorPointX,anchorPointY:ie.anchorPointY},A.verticalIconFeatureIndex=ie.featureIndex;break}return A},Lr.prototype.deserializeCollisionBoxes=function(e){this.collisionArrays=[];for(var t=0;t<this.symbolInstances.length;t++){var i=this.symbolInstances.get(t);this.collisionArrays.push(this._deserializeCollisionBoxesForSymbol(e,i.textBoxStartIndex,i.textBoxEndIndex,i.verticalTextBoxStartIndex,i.verticalTextBoxEndIndex,i.iconBoxStartIndex,i.iconBoxEndIndex,i.verticalIconBoxStartIndex,i.verticalIconBoxEndIndex))}},Lr.prototype.hasTextData=function(){return this.text.segments.get().length>0},Lr.prototype.hasIconData=function(){return this.icon.segments.get().length>0},Lr.prototype.hasDebugData=function(){return this.textCollisionBox&&this.iconCollisionBox},Lr.prototype.hasTextCollisionBoxData=function(){return this.hasDebugData()&&this.textCollisionBox.segments.get().length>0},Lr.prototype.hasIconCollisionBoxData=function(){return this.hasDebugData()&&this.iconCollisionBox.segments.get().length>0},Lr.prototype.addIndicesForPlacedSymbol=function(e,t){for(var i=e.placedSymbolArray.get(t),l=i.vertexStartIndex+4*i.numGlyphs,f=i.vertexStartIndex;f<l;f+=4)e.indexArray.emplaceBack(f,f+1,f+2),e.indexArray.emplaceBack(f+1,f+2,f+3)},Lr.prototype.getSortedSymbolIndexes=function(e){if(this.sortedAngle===e&&this.symbolInstanceIndexes!==void 0)return this.symbolInstanceIndexes;for(var t=Math.sin(e),i=Math.cos(e),l=[],f=[],m=[],x=0;x<this.symbolInstances.length;++x){m.push(x);var k=this.symbolInstances.get(x);l.push(0|Math.round(t*k.anchorX+i*k.anchorY)),f.push(k.featureIndex)}return m.sort(function(I,A){return l[I]-l[A]||f[A]-f[I]}),m},Lr.prototype.addToSortKeyRanges=function(e,t){var i=this.sortKeyRanges[this.sortKeyRanges.length-1];i&&i.sortKey===t?i.symbolInstanceEnd=e+1:this.sortKeyRanges.push({sortKey:t,symbolInstanceStart:e,symbolInstanceEnd:e+1})},Lr.prototype.sortFeatures=function(e){var t=this;if(this.sortFeaturesByY&&this.sortedAngle!==e&&!(this.text.segments.get().length>1||this.icon.segments.get().length>1)){this.symbolInstanceIndexes=this.getSortedSymbolIndexes(e),this.sortedAngle=e,this.text.indexArray.clear(),this.icon.indexArray.clear(),this.featureSortOrder=[];for(var i=0,l=this.symbolInstanceIndexes;i<l.length;i+=1){var f=this.symbolInstances.get(l[i]);this.featureSortOrder.push(f.featureIndex),[f.rightJustifiedTextSymbolIndex,f.centerJustifiedTextSymbolIndex,f.leftJustifiedTextSymbolIndex].forEach(function(m,x,k){m>=0&&k.indexOf(m)===x&&t.addIndicesForPlacedSymbol(t.text,m)}),f.verticalPlacedTextSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.text,f.verticalPlacedTextSymbolIndex),f.placedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,f.placedIconSymbolIndex),f.verticalPlacedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,f.verticalPlacedIconSymbolIndex)}this.text.indexBuffer&&this.text.indexBuffer.updateData(this.text.indexArray),this.icon.indexBuffer&&this.icon.indexBuffer.updateData(this.icon.indexArray)}},ft("SymbolBucket",Lr,{omit:["layers","collisionBoxArray","features","compareText"]}),Lr.MAX_GLYPHS=65535,Lr.addDynamicAttributes=cp;var Fg=new an({"symbol-placement":new St(q.layout_symbol["symbol-placement"]),"symbol-spacing":new St(q.layout_symbol["symbol-spacing"]),"symbol-avoid-edges":new St(q.layout_symbol["symbol-avoid-edges"]),"symbol-sort-key":new gt(q.layout_symbol["symbol-sort-key"]),"symbol-z-order":new St(q.layout_symbol["symbol-z-order"]),"icon-allow-overlap":new St(q.layout_symbol["icon-allow-overlap"]),"icon-ignore-placement":new St(q.layout_symbol["icon-ignore-placement"]),"icon-optional":new St(q.layout_symbol["icon-optional"]),"icon-rotation-alignment":new St(q.layout_symbol["icon-rotation-alignment"]),"icon-size":new gt(q.layout_symbol["icon-size"]),"icon-text-fit":new St(q.layout_symbol["icon-text-fit"]),"icon-text-fit-padding":new St(q.layout_symbol["icon-text-fit-padding"]),"icon-image":new gt(q.layout_symbol["icon-image"]),"icon-rotate":new gt(q.layout_symbol["icon-rotate"]),"icon-padding":new St(q.layout_symbol["icon-padding"]),"icon-keep-upright":new St(q.layout_symbol["icon-keep-upright"]),"icon-offset":new gt(q.layout_symbol["icon-offset"]),"icon-anchor":new gt(q.layout_symbol["icon-anchor"]),"icon-pitch-alignment":new St(q.layout_symbol["icon-pitch-alignment"]),"text-pitch-alignment":new St(q.layout_symbol["text-pitch-alignment"]),"text-rotation-alignment":new St(q.layout_symbol["text-rotation-alignment"]),"text-field":new gt(q.layout_symbol["text-field"]),"text-font":new gt(q.layout_symbol["text-font"]),"text-size":new gt(q.layout_symbol["text-size"]),"text-max-width":new gt(q.layout_symbol["text-max-width"]),"text-line-height":new St(q.layout_symbol["text-line-height"]),"text-letter-spacing":new gt(q.layout_symbol["text-letter-spacing"]),"text-justify":new gt(q.layout_symbol["text-justify"]),"text-radial-offset":new gt(q.layout_symbol["text-radial-offset"]),"text-variable-anchor":new St(q.layout_symbol["text-variable-anchor"]),"text-anchor":new gt(q.layout_symbol["text-anchor"]),"text-max-angle":new St(q.layout_symbol["text-max-angle"]),"text-writing-mode":new St(q.layout_symbol["text-writing-mode"]),"text-rotate":new gt(q.layout_symbol["text-rotate"]),"text-padding":new St(q.layout_symbol["text-padding"]),"text-keep-upright":new St(q.layout_symbol["text-keep-upright"]),"text-transform":new gt(q.layout_symbol["text-transform"]),"text-offset":new gt(q.layout_symbol["text-offset"]),"text-allow-overlap":new St(q.layout_symbol["text-allow-overlap"]),"text-ignore-placement":new St(q.layout_symbol["text-ignore-placement"]),"text-optional":new St(q.layout_symbol["text-optional"])}),hp={paint:new an({"icon-opacity":new gt(q.paint_symbol["icon-opacity"]),"icon-color":new gt(q.paint_symbol["icon-color"]),"icon-halo-color":new gt(q.paint_symbol["icon-halo-color"]),"icon-halo-width":new gt(q.paint_symbol["icon-halo-width"]),"icon-halo-blur":new gt(q.paint_symbol["icon-halo-blur"]),"icon-translate":new St(q.paint_symbol["icon-translate"]),"icon-translate-anchor":new St(q.paint_symbol["icon-translate-anchor"]),"text-opacity":new gt(q.paint_symbol["text-opacity"]),"text-color":new gt(q.paint_symbol["text-color"],{runtimeType:$e,getOverride:function(e){return e.textColor},hasOverride:function(e){return!!e.textColor}}),"text-halo-color":new gt(q.paint_symbol["text-halo-color"]),"text-halo-width":new gt(q.paint_symbol["text-halo-width"]),"text-halo-blur":new gt(q.paint_symbol["text-halo-blur"]),"text-translate":new St(q.paint_symbol["text-translate"]),"text-translate-anchor":new St(q.paint_symbol["text-translate-anchor"])}),layout:Fg},yl=function(e){this.type=e.property.overrides?e.property.overrides.runtimeType:it,this.defaultValue=e};yl.prototype.evaluate=function(e){if(e.formattedSection){var t=this.defaultValue.property.overrides;if(t&&t.hasOverride(e.formattedSection))return t.getOverride(e.formattedSection)}return e.feature&&e.featureState?this.defaultValue.evaluate(e.feature,e.featureState):this.defaultValue.property.specification.default},yl.prototype.eachChild=function(e){this.defaultValue.isConstant()||e(this.defaultValue.value._styleExpression.expression)},yl.prototype.outputDefined=function(){return!1},yl.prototype.serialize=function(){return null},ft("FormatSectionOverride",yl,{omit:["defaultValue"]});var Ng=function(e){function t(i){e.call(this,i,hp)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.recalculate=function(i,l){if(e.prototype.recalculate.call(this,i,l),this.layout.get("icon-rotation-alignment")==="auto"&&(this.layout._values["icon-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-rotation-alignment")==="auto"&&(this.layout._values["text-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-pitch-alignment")==="auto"&&(this.layout._values["text-pitch-alignment"]=this.layout.get("text-rotation-alignment")),this.layout.get("icon-pitch-alignment")==="auto"&&(this.layout._values["icon-pitch-alignment"]=this.layout.get("icon-rotation-alignment")),this.layout.get("symbol-placement")==="point"){var f=this.layout.get("text-writing-mode");if(f){for(var m=[],x=0,k=f;x<k.length;x+=1){var I=k[x];m.indexOf(I)<0&&m.push(I)}this.layout._values["text-writing-mode"]=m}else this.layout._values["text-writing-mode"]=["horizontal"]}this._setPaintOverrides()},t.prototype.getValueAndResolveTokens=function(i,l,f,m){var x=this.layout.get(i).evaluate(l,{},f,m),k=this._unevaluatedLayout._values[i];return k.isDataDriven()||hs(k.value)||!x?x:function(I,A){return A.replace(/{([^{}]+)}/g,function(C,B){return B in I?String(I[B]):""})}(l.properties,x)},t.prototype.createBucket=function(i){return new Lr(i)},t.prototype.queryRadius=function(){return 0},t.prototype.queryIntersectsFeature=function(){return!1},t.prototype._setPaintOverrides=function(){for(var i=0,l=hp.paint.overridableProperties;i<l.length;i+=1){var f=l[i];if(t.hasPaintOverride(this.layout,f)){var m,x=this.paint.get(f),k=new yl(x),I=new No(k,x.property.specification);m=x.value.kind==="constant"||x.value.kind==="source"?new ps("source",I):new Uo("composite",I,x.value.zoomStops,x.value._interpolationType),this.paint._values[f]=new vn(x.property,m,x.parameters)}}},t.prototype._handleOverridablePaintPropertyUpdate=function(i,l,f){return!(!this.layout||l.isDataDriven()||f.isDataDriven())&&t.hasPaintOverride(this.layout,i)},t.hasPaintOverride=function(i,l){var f=i.get("text-field"),m=hp.paint.properties[l],x=!1,k=function(C){for(var B=0,U=C;B<U.length;B+=1)if(m.overrides&&m.overrides.hasOverride(U[B]))return void(x=!0)};if(f.value.kind==="constant"&&f.value.value instanceof ii)k(f.value.value.sections);else if(f.value.kind==="source"){var I=function(C){x||(C instanceof Ii&&Zr(C.value)===br?k(C.value.sections):C instanceof Ln?k(C.sections):C.eachChild(I))},A=f.value;A._styleExpression&&I(A._styleExpression.expression)}return x},t}(za),Ug={paint:new an({"background-color":new St(q.paint_background["background-color"]),"background-pattern":new bn(q.paint_background["background-pattern"]),"background-opacity":new St(q.paint_background["background-opacity"])})},Vg=function(e){function t(i){e.call(this,i,Ug)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t}(za),qg={paint:new an({"raster-opacity":new St(q.paint_raster["raster-opacity"]),"raster-hue-rotate":new St(q.paint_raster["raster-hue-rotate"]),"raster-brightness-min":new St(q.paint_raster["raster-brightness-min"]),"raster-brightness-max":new St(q.paint_raster["raster-brightness-max"]),"raster-saturation":new St(q.paint_raster["raster-saturation"]),"raster-contrast":new St(q.paint_raster["raster-contrast"]),"raster-resampling":new St(q.paint_raster["raster-resampling"]),"raster-fade-duration":new St(q.paint_raster["raster-fade-duration"])})},jg=function(e){function t(i){e.call(this,i,qg)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t}(za),Zg=function(e){function t(i){e.call(this,i,{}),this.implementation=i}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.is3D=function(){return this.implementation.renderingMode==="3d"},t.prototype.hasOffscreenPass=function(){return this.implementation.prerender!==void 0},t.prototype.recalculate=function(){},t.prototype.updateTransitions=function(){},t.prototype.hasTransition=function(){},t.prototype.serialize=function(){},t.prototype.onAdd=function(i){this.implementation.onAdd&&this.implementation.onAdd(i,i.painter.context.gl)},t.prototype.onRemove=function(i){this.implementation.onRemove&&this.implementation.onRemove(i,i.painter.context.gl)},t}(za),Gg={circle:Wh,heatmap:Iy,hillshade:Py,fill:Hy,"fill-extrusion":rg,line:lg,symbol:Ng,background:Vg,raster:jg},Df=L.HTMLImageElement,Lf=L.HTMLCanvasElement,Rf=L.HTMLVideoElement,Bf=L.ImageData,jc=L.ImageBitmap,As=function(e,t,i,l){this.context=e,this.format=i,this.texture=e.gl.createTexture(),this.update(t,l)};As.prototype.update=function(e,t,i){var l=e.width,f=e.height,m=!(this.size&&this.size[0]===l&&this.size[1]===f||i),x=this.context,k=x.gl;if(this.useMipmap=!!(t&&t.useMipmap),k.bindTexture(k.TEXTURE_2D,this.texture),x.pixelStoreUnpackFlipY.set(!1),x.pixelStoreUnpack.set(1),x.pixelStoreUnpackPremultiplyAlpha.set(this.format===k.RGBA&&(!t||t.premultiply!==!1)),m)this.size=[l,f],e instanceof Df||e instanceof Lf||e instanceof Rf||e instanceof Bf||jc&&e instanceof jc?k.texImage2D(k.TEXTURE_2D,0,this.format,this.format,k.UNSIGNED_BYTE,e):k.texImage2D(k.TEXTURE_2D,0,this.format,l,f,0,this.format,k.UNSIGNED_BYTE,e.data);else{var I=i||{x:0,y:0},A=I.x,C=I.y;e instanceof Df||e instanceof Lf||e instanceof Rf||e instanceof Bf||jc&&e instanceof jc?k.texSubImage2D(k.TEXTURE_2D,0,A,C,k.RGBA,k.UNSIGNED_BYTE,e):k.texSubImage2D(k.TEXTURE_2D,0,A,C,l,f,k.RGBA,k.UNSIGNED_BYTE,e.data)}this.useMipmap&&this.isSizePowerOfTwo()&&k.generateMipmap(k.TEXTURE_2D)},As.prototype.bind=function(e,t,i){var l=this.context.gl;l.bindTexture(l.TEXTURE_2D,this.texture),i!==l.LINEAR_MIPMAP_NEAREST||this.isSizePowerOfTwo()||(i=l.LINEAR),e!==this.filter&&(l.texParameteri(l.TEXTURE_2D,l.TEXTURE_MAG_FILTER,e),l.texParameteri(l.TEXTURE_2D,l.TEXTURE_MIN_FILTER,i||e),this.filter=e),t!==this.wrap&&(l.texParameteri(l.TEXTURE_2D,l.TEXTURE_WRAP_S,t),l.texParameteri(l.TEXTURE_2D,l.TEXTURE_WRAP_T,t),this.wrap=t)},As.prototype.isSizePowerOfTwo=function(){return this.size[0]===this.size[1]&&Math.log(this.size[0])/Math.LN2%1==0},As.prototype.destroy=function(){this.context.gl.deleteTexture(this.texture),this.texture=null};var pp=function(e){var t=this;this._callback=e,this._triggered=!1,typeof MessageChannel<"u"&&(this._channel=new MessageChannel,this._channel.port2.onmessage=function(){t._triggered=!1,t._callback()})};pp.prototype.trigger=function(){var e=this;this._triggered||(this._triggered=!0,this._channel?this._channel.port1.postMessage(!0):setTimeout(function(){e._triggered=!1,e._callback()},0))},pp.prototype.remove=function(){delete this._channel,this._callback=function(){}};var gl=function(e,t,i){this.target=e,this.parent=t,this.mapId=i,this.callbacks={},this.tasks={},this.taskQueue=[],this.cancelCallbacks={},vt(["receive","process"],this),this.invoker=new pp(this.process),this.target.addEventListener("message",this.receive,!1),this.globalScope=Pt()?e:L};function Of(e,t,i){var l=2*Math.PI*6378137/256/Math.pow(2,i);return[e*l-2*Math.PI*6378137/2,t*l-2*Math.PI*6378137/2]}gl.prototype.send=function(e,t,i,l,f){var m=this;f===void 0&&(f=!1);var x=Math.round(1e18*Math.random()).toString(36).substring(0,10);i&&(this.callbacks[x]=i);var k=Nt(this.globalScope)?void 0:[];return this.target.postMessage({id:x,type:e,hasCallback:!!i,targetMapId:l,mustQueue:f,sourceMapId:this.mapId,data:fa(t,k)},k),{cancel:function(){i&&delete m.callbacks[x],m.target.postMessage({id:x,type:"<cancel>",targetMapId:l,sourceMapId:m.mapId})}}},gl.prototype.receive=function(e){var t=e.data,i=t.id;if(i&&(!t.targetMapId||this.mapId===t.targetMapId))if(t.type==="<cancel>"){delete this.tasks[i];var l=this.cancelCallbacks[i];delete this.cancelCallbacks[i],l&&l()}else Pt()||t.mustQueue?(this.tasks[i]=t,this.taskQueue.push(i),this.invoker.trigger()):this.processTask(i,t)},gl.prototype.process=function(){if(this.taskQueue.length){var e=this.taskQueue.shift(),t=this.tasks[e];delete this.tasks[e],this.taskQueue.length&&this.invoker.trigger(),t&&this.processTask(e,t)}},gl.prototype.processTask=function(e,t){var i=this;if(t.type==="<response>"){var l=this.callbacks[e];delete this.callbacks[e],l&&(t.error?l(Fn(t.error)):l(null,Fn(t.data)))}else{var f=!1,m=Nt(this.globalScope)?void 0:[],x=t.hasCallback?function(C,B){f=!0,delete i.cancelCallbacks[e],i.target.postMessage({id:e,type:"<response>",sourceMapId:i.mapId,error:C?fa(C):null,data:fa(B,m)},m)}:function(C){f=!0},k=null,I=Fn(t.data);if(this.parent[t.type])k=this.parent[t.type](t.sourceMapId,I,x);else if(this.parent.getWorkerSource){var A=t.type.split(".");k=this.parent.getWorkerSource(t.sourceMapId,A[0],I.source)[A[1]](I,x)}else x(new Error("Could not find function "+t.type));!f&&k&&k.cancel&&(this.cancelCallbacks[e]=k.cancel)}},gl.prototype.remove=function(){this.invoker.remove(),this.target.removeEventListener("message",this.receive,!1)};var Di=function(e,t){e&&(t?this.setSouthWest(e).setNorthEast(t):e.length===4?this.setSouthWest([e[0],e[1]]).setNorthEast([e[2],e[3]]):this.setSouthWest(e[0]).setNorthEast(e[1]))};Di.prototype.setNorthEast=function(e){return this._ne=e instanceof Wr?new Wr(e.lng,e.lat):Wr.convert(e),this},Di.prototype.setSouthWest=function(e){return this._sw=e instanceof Wr?new Wr(e.lng,e.lat):Wr.convert(e),this},Di.prototype.extend=function(e){var t,i,l=this._sw,f=this._ne;if(e instanceof Wr)t=e,i=e;else{if(!(e instanceof Di))return Array.isArray(e)?e.length===4||e.every(Array.isArray)?this.extend(Di.convert(e)):this.extend(Wr.convert(e)):this;if(i=e._ne,!(t=e._sw)||!i)return this}return l||f?(l.lng=Math.min(t.lng,l.lng),l.lat=Math.min(t.lat,l.lat),f.lng=Math.max(i.lng,f.lng),f.lat=Math.max(i.lat,f.lat)):(this._sw=new Wr(t.lng,t.lat),this._ne=new Wr(i.lng,i.lat)),this},Di.prototype.getCenter=function(){return new Wr((this._sw.lng+this._ne.lng)/2,(this._sw.lat+this._ne.lat)/2)},Di.prototype.getSouthWest=function(){return this._sw},Di.prototype.getNorthEast=function(){return this._ne},Di.prototype.getNorthWest=function(){return new Wr(this.getWest(),this.getNorth())},Di.prototype.getSouthEast=function(){return new Wr(this.getEast(),this.getSouth())},Di.prototype.getWest=function(){return this._sw.lng},Di.prototype.getSouth=function(){return this._sw.lat},Di.prototype.getEast=function(){return this._ne.lng},Di.prototype.getNorth=function(){return this._ne.lat},Di.prototype.toArray=function(){return[this._sw.toArray(),this._ne.toArray()]},Di.prototype.toString=function(){return"LngLatBounds("+this._sw.toString()+", "+this._ne.toString()+")"},Di.prototype.isEmpty=function(){return!(this._sw&&this._ne)},Di.prototype.contains=function(e){var t=Wr.convert(e),i=t.lng,l=t.lat,f=this._sw.lng<=i&&i<=this._ne.lng;return this._sw.lng>this._ne.lng&&(f=this._sw.lng>=i&&i>=this._ne.lng),this._sw.lat<=l&&l<=this._ne.lat&&f},Di.convert=function(e){return!e||e instanceof Di?e:new Di(e)};var Wr=function(e,t){if(isNaN(e)||isNaN(t))throw new Error("Invalid LngLat object: ("+e+", "+t+")");if(this.lng=+e,this.lat=+t,this.lat>90||this.lat<-90)throw new Error("Invalid LngLat latitude value: must be between -90 and 90")};Wr.prototype.wrap=function(){return new Wr(de(this.lng,-180,180),this.lat)},Wr.prototype.toArray=function(){return[this.lng,this.lat]},Wr.prototype.toString=function(){return"LngLat("+this.lng+", "+this.lat+")"},Wr.prototype.distanceTo=function(e){var t=Math.PI/180,i=this.lat*t,l=e.lat*t,f=Math.sin(i)*Math.sin(l)+Math.cos(i)*Math.cos(l)*Math.cos((e.lng-this.lng)*t);return 63710088e-1*Math.acos(Math.min(f,1))},Wr.prototype.toBounds=function(e){e===void 0&&(e=0);var t=360*e/40075017,i=t/Math.cos(Math.PI/180*this.lat);return new Di(new Wr(this.lng-i,this.lat-t),new Wr(this.lng+i,this.lat+t))},Wr.convert=function(e){if(e instanceof Wr)return e;if(Array.isArray(e)&&(e.length===2||e.length===3))return new Wr(Number(e[0]),Number(e[1]));if(!Array.isArray(e)&&typeof e=="object"&&e!==null)return new Wr(Number("lng"in e?e.lng:e.lon),Number(e.lat));throw new Error("`LngLatLike` argument must be specified as a LngLat instance, an object {lng: <lng>, lat: <lat>}, an object {lon: <lng>, lat: <lat>}, or an array of [<lng>, <lat>]")};var Ff=2*Math.PI*63710088e-1;function Nf(e){return Ff*Math.cos(e*Math.PI/180)}function Uf(e){return(180+e)/360}function Vf(e){return(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+e*Math.PI/360)))/360}function qf(e,t){return e/Nf(t)}function fp(e){return 360/Math.PI*Math.atan(Math.exp((180-360*e)*Math.PI/180))-90}var Ps=function(e,t,i){i===void 0&&(i=0),this.x=+e,this.y=+t,this.z=+i};Ps.fromLngLat=function(e,t){t===void 0&&(t=0);var i=Wr.convert(e);return new Ps(Uf(i.lng),Vf(i.lat),qf(t,i.lat))},Ps.prototype.toLngLat=function(){return new Wr(360*this.x-180,fp(this.y))},Ps.prototype.toAltitude=function(){return this.z*Nf(fp(this.y))},Ps.prototype.meterInMercatorCoordinateUnits=function(){return 1/Ff*(e=fp(this.y),1/Math.cos(e*Math.PI/180));var e};var Cs=function(e,t,i){this.z=e,this.x=t,this.y=i,this.key=vu(0,e,e,t,i)};Cs.prototype.equals=function(e){return this.z===e.z&&this.x===e.x&&this.y===e.y},Cs.prototype.url=function(e,t){var i,l,f,m,x,k=(l=this.y,f=this.z,m=Of(256*(i=this.x),256*(l=Math.pow(2,f)-l-1),f),x=Of(256*(i+1),256*(l+1),f),m[0]+","+m[1]+","+x[0]+","+x[1]),I=function(A,C,B){for(var U,j="",J=A;J>0;J--)j+=(C&(U=1<<J-1)?1:0)+(B&U?2:0);return j}(this.z,this.x,this.y);return e[(this.x+this.y)%e.length].replace("{prefix}",(this.x%16).toString(16)+(this.y%16).toString(16)).replace("{z}",String(this.z)).replace("{x}",String(this.x)).replace("{y}",String(t==="tms"?Math.pow(2,this.z)-this.y-1:this.y)).replace("{quadkey}",I).replace("{bbox-epsg-3857}",k)},Cs.prototype.getTilePoint=function(e){var t=Math.pow(2,this.z);return new F(8192*(e.x*t-this.x),8192*(e.y*t-this.y))},Cs.prototype.toString=function(){return this.z+"/"+this.x+"/"+this.y};var jf=function(e,t){this.wrap=e,this.canonical=t,this.key=vu(e,t.z,t.z,t.x,t.y)},Li=function(e,t,i,l,f){this.overscaledZ=e,this.wrap=t,this.canonical=new Cs(i,+l,+f),this.key=vu(t,e,i,l,f)};function vu(e,t,i,l,f){(e*=2)<0&&(e=-1*e-1);var m=1<<i;return(m*m*e+m*f+l).toString(36)+i.toString(36)+t.toString(36)}Li.prototype.equals=function(e){return this.overscaledZ===e.overscaledZ&&this.wrap===e.wrap&&this.canonical.equals(e.canonical)},Li.prototype.scaledTo=function(e){var t=this.canonical.z-e;return e>this.canonical.z?new Li(e,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y):new Li(e,this.wrap,e,this.canonical.x>>t,this.canonical.y>>t)},Li.prototype.calculateScaledKey=function(e,t){var i=this.canonical.z-e;return e>this.canonical.z?vu(this.wrap*+t,e,this.canonical.z,this.canonical.x,this.canonical.y):vu(this.wrap*+t,e,e,this.canonical.x>>i,this.canonical.y>>i)},Li.prototype.isChildOf=function(e){if(e.wrap!==this.wrap)return!1;var t=this.canonical.z-e.canonical.z;return e.overscaledZ===0||e.overscaledZ<this.overscaledZ&&e.canonical.x===this.canonical.x>>t&&e.canonical.y===this.canonical.y>>t},Li.prototype.children=function(e){if(this.overscaledZ>=e)return[new Li(this.overscaledZ+1,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)];var t=this.canonical.z+1,i=2*this.canonical.x,l=2*this.canonical.y;return[new Li(t,this.wrap,t,i,l),new Li(t,this.wrap,t,i+1,l),new Li(t,this.wrap,t,i,l+1),new Li(t,this.wrap,t,i+1,l+1)]},Li.prototype.isLessThan=function(e){return this.wrap<e.wrap||!(this.wrap>e.wrap)&&(this.overscaledZ<e.overscaledZ||!(this.overscaledZ>e.overscaledZ)&&(this.canonical.x<e.canonical.x||!(this.canonical.x>e.canonical.x)&&this.canonical.y<e.canonical.y))},Li.prototype.wrapped=function(){return new Li(this.overscaledZ,0,this.canonical.z,this.canonical.x,this.canonical.y)},Li.prototype.unwrapTo=function(e){return new Li(this.overscaledZ,e,this.canonical.z,this.canonical.x,this.canonical.y)},Li.prototype.overscaleFactor=function(){return Math.pow(2,this.overscaledZ-this.canonical.z)},Li.prototype.toUnwrapped=function(){return new jf(this.wrap,this.canonical)},Li.prototype.toString=function(){return this.overscaledZ+"/"+this.canonical.x+"/"+this.canonical.y},Li.prototype.getTilePoint=function(e){return this.canonical.getTilePoint(new Ps(e.x-this.wrap,e.y))},ft("CanonicalTileID",Cs),ft("OverscaledTileID",Li,{omit:["posMatrix"]});var Po=function(e,t,i){if(this.uid=e,t.height!==t.width)throw new RangeError("DEM tiles must be square");if(i&&i!=="mapbox"&&i!=="terrarium")return yt('"'+i+'" is not a valid encoding type. Valid types include "mapbox" and "terrarium".');this.stride=t.height;var l=this.dim=t.height-2;this.data=new Uint32Array(t.data.buffer),this.encoding=i||"mapbox";for(var f=0;f<l;f++)this.data[this._idx(-1,f)]=this.data[this._idx(0,f)],this.data[this._idx(l,f)]=this.data[this._idx(l-1,f)],this.data[this._idx(f,-1)]=this.data[this._idx(f,0)],this.data[this._idx(f,l)]=this.data[this._idx(f,l-1)];this.data[this._idx(-1,-1)]=this.data[this._idx(0,0)],this.data[this._idx(l,-1)]=this.data[this._idx(l-1,0)],this.data[this._idx(-1,l)]=this.data[this._idx(0,l-1)],this.data[this._idx(l,l)]=this.data[this._idx(l-1,l-1)]};Po.prototype.get=function(e,t){var i=new Uint8Array(this.data.buffer),l=4*this._idx(e,t);return(this.encoding==="terrarium"?this._unpackTerrarium:this._unpackMapbox)(i[l],i[l+1],i[l+2])},Po.prototype.getUnpackVector=function(){return this.encoding==="terrarium"?[256,1,1/256,32768]:[6553.6,25.6,.1,1e4]},Po.prototype._idx=function(e,t){if(e<-1||e>=this.dim+1||t<-1||t>=this.dim+1)throw new RangeError("out of range source coordinates for DEM data");return(t+1)*this.stride+(e+1)},Po.prototype._unpackMapbox=function(e,t,i){return(256*e*256+256*t+i)/10-1e4},Po.prototype._unpackTerrarium=function(e,t,i){return 256*e+t+i/256-32768},Po.prototype.getPixels=function(){return new jn({width:this.stride,height:this.stride},new Uint8Array(this.data.buffer))},Po.prototype.backfillBorder=function(e,t,i){if(this.dim!==e.dim)throw new Error("dem dimension mismatch");var l=t*this.dim,f=t*this.dim+this.dim,m=i*this.dim,x=i*this.dim+this.dim;switch(t){case-1:l=f-1;break;case 1:f=l+1}switch(i){case-1:m=x-1;break;case 1:x=m+1}for(var k=-t*this.dim,I=-i*this.dim,A=m;A<x;A++)for(var C=l;C<f;C++)this.data[this._idx(C,A)]=e.data[this._idx(C+k,A+I)]},ft("DEMData",Po);var Zc=function(e){this._stringToNumber={},this._numberToString=[];for(var t=0;t<e.length;t++){var i=e[t];this._stringToNumber[i]=t,this._numberToString[t]=i}};Zc.prototype.encode=function(e){return this._stringToNumber[e]},Zc.prototype.decode=function(e){return this._numberToString[e]};var Gc=function(e,t,i,l,f){this.type="Feature",this._vectorTileFeature=e,e._z=t,e._x=i,e._y=l,this.properties=e.properties,this.id=f},dp={geometry:{configurable:!0}};dp.geometry.get=function(){return this._geometry===void 0&&(this._geometry=this._vectorTileFeature.toGeoJSON(this._vectorTileFeature._x,this._vectorTileFeature._y,this._vectorTileFeature._z).geometry),this._geometry},dp.geometry.set=function(e){this._geometry=e},Gc.prototype.toJSON=function(){var e={geometry:this.geometry};for(var t in this)t!=="_geometry"&&t!=="_vectorTileFeature"&&(e[t]=this[t]);return e},Object.defineProperties(Gc.prototype,dp);var _l=function(){this.state={},this.stateChanges={},this.deletedStates={}};_l.prototype.updateState=function(e,t,i){var l=String(t);if(this.stateChanges[e]=this.stateChanges[e]||{},this.stateChanges[e][l]=this.stateChanges[e][l]||{},we(this.stateChanges[e][l],i),this.deletedStates[e]===null)for(var f in this.deletedStates[e]={},this.state[e])f!==l&&(this.deletedStates[e][f]=null);else if(this.deletedStates[e]&&this.deletedStates[e][l]===null)for(var m in this.deletedStates[e][l]={},this.state[e][l])i[m]||(this.deletedStates[e][l][m]=null);else for(var x in i)this.deletedStates[e]&&this.deletedStates[e][l]&&this.deletedStates[e][l][x]===null&&delete this.deletedStates[e][l][x]},_l.prototype.removeFeatureState=function(e,t,i){if(this.deletedStates[e]!==null){var l=String(t);if(this.deletedStates[e]=this.deletedStates[e]||{},i&&t!==void 0)this.deletedStates[e][l]!==null&&(this.deletedStates[e][l]=this.deletedStates[e][l]||{},this.deletedStates[e][l][i]=null);else if(t!==void 0)if(this.stateChanges[e]&&this.stateChanges[e][l])for(i in this.deletedStates[e][l]={},this.stateChanges[e][l])this.deletedStates[e][l][i]=null;else this.deletedStates[e][l]=null;else this.deletedStates[e]=null}},_l.prototype.getState=function(e,t){var i=String(t),l=we({},(this.state[e]||{})[i],(this.stateChanges[e]||{})[i]);if(this.deletedStates[e]===null)return{};if(this.deletedStates[e]){var f=this.deletedStates[e][t];if(f===null)return{};for(var m in f)delete l[m]}return l},_l.prototype.initializeTileState=function(e,t){e.setFeatureState(this.state,t)},_l.prototype.coalesceChanges=function(e,t){var i={};for(var l in this.stateChanges){this.state[l]=this.state[l]||{};var f={};for(var m in this.stateChanges[l])this.state[l][m]||(this.state[l][m]={}),we(this.state[l][m],this.stateChanges[l][m]),f[m]=this.state[l][m];i[l]=f}for(var x in this.deletedStates){this.state[x]=this.state[x]||{};var k={};if(this.deletedStates[x]===null)for(var I in this.state[x])k[I]={},this.state[x][I]={};else for(var A in this.deletedStates[x]){if(this.deletedStates[x][A]===null)this.state[x][A]={};else for(var C=0,B=Object.keys(this.deletedStates[x][A]);C<B.length;C+=1)delete this.state[x][A][B[C]];k[A]=this.state[x][A]}i[x]=i[x]||{},we(i[x],k)}if(this.stateChanges={},this.deletedStates={},Object.keys(i).length!==0)for(var U in e)e[U].setFeatureState(i,t)};var Co=function(e,t){this.tileID=e,this.x=e.canonical.x,this.y=e.canonical.y,this.z=e.canonical.z,this.grid=new Ca(8192,16,0),this.grid3D=new Ca(8192,16,0),this.featureIndexArray=new O,this.promoteId=t};function Zf(e,t,i,l,f){return ct(e,function(m,x){var k=t instanceof xs?t.get(x):null;return k&&k.evaluate?k.evaluate(i,l,f):k})}function Gf(e){for(var t=1/0,i=1/0,l=-1/0,f=-1/0,m=0,x=e;m<x.length;m+=1){var k=x[m];t=Math.min(t,k.x),i=Math.min(i,k.y),l=Math.max(l,k.x),f=Math.max(f,k.y)}return{minX:t,minY:i,maxX:l,maxY:f}}function Kg(e,t){return t-e}Co.prototype.insert=function(e,t,i,l,f,m){var x=this.featureIndexArray.length;this.featureIndexArray.emplaceBack(i,l,f);for(var k=m?this.grid3D:this.grid,I=0;I<t.length;I++){for(var A=t[I],C=[1/0,1/0,-1/0,-1/0],B=0;B<A.length;B++){var U=A[B];C[0]=Math.min(C[0],U.x),C[1]=Math.min(C[1],U.y),C[2]=Math.max(C[2],U.x),C[3]=Math.max(C[3],U.y)}C[0]<8192&&C[1]<8192&&C[2]>=0&&C[3]>=0&&k.insert(x,C[0],C[1],C[2],C[3])}},Co.prototype.loadVTLayers=function(){return this.vtLayers||(this.vtLayers=new ll.VectorTile(new Dc(this.rawTileData)).layers,this.sourceLayerCoder=new Zc(this.vtLayers?Object.keys(this.vtLayers).sort():["_geojsonTileLayer"])),this.vtLayers},Co.prototype.query=function(e,t,i,l){var f=this;this.loadVTLayers();for(var m=e.params||{},x=8192/e.tileSize/e.scale,k=Gs(m.filter),I=e.queryGeometry,A=e.queryPadding*x,C=Gf(I),B=this.grid.query(C.minX-A,C.minY-A,C.maxX+A,C.maxY+A),U=Gf(e.cameraQueryGeometry),j=this.grid3D.query(U.minX-A,U.minY-A,U.maxX+A,U.maxY+A,function(Se,Ee,Ce,Ve){return function(Je,bt,nt,Et,at){for(var $t=0,Dt=Je;$t<Dt.length;$t+=1){var _t=Dt[$t];if(bt<=_t.x&&nt<=_t.y&&Et>=_t.x&&at>=_t.y)return!0}var lr=[new F(bt,nt),new F(bt,at),new F(Et,at),new F(Et,nt)];if(Je.length>2){for(var Gt=0,yr=lr;Gt<yr.length;Gt+=1)if(Ia(Je,yr[Gt]))return!0}for(var zt=0;zt<Je.length-1;zt++)if(zs(Je[zt],Je[zt+1],lr))return!0;return!1}(e.cameraQueryGeometry,Se-A,Ee-A,Ce+A,Ve+A)}),J=0,Q=j;J<Q.length;J+=1)B.push(Q[J]);B.sort(Kg);for(var he,ie={},me=function(Se){var Ee=B[Se];if(Ee!==he){he=Ee;var Ce=f.featureIndexArray.get(Ee),Ve=null;f.loadMatchingFeature(ie,Ce.bucketIndex,Ce.sourceLayerIndex,Ce.featureIndex,k,m.layers,m.availableImages,t,i,l,function(Je,bt,nt){return Ve||(Ve=$r(Je)),bt.queryIntersectsFeature(I,Je,nt,Ve,f.z,e.transform,x,e.pixelPosMatrix)})}},be=0;be<B.length;be++)me(be);return ie},Co.prototype.loadMatchingFeature=function(e,t,i,l,f,m,x,k,I,A,C){var B=this.bucketLayerIDs[t];if(!m||function(Je,bt){for(var nt=0;nt<Je.length;nt++)if(bt.indexOf(Je[nt])>=0)return!0;return!1}(m,B)){var U=this.sourceLayerCoder.decode(i),j=this.vtLayers[U].feature(l);if(f.needGeometry){var J=di(j,!0);if(!f.filter(new ur(this.tileID.overscaledZ),J,this.tileID.canonical))return}else if(!f.filter(new ur(this.tileID.overscaledZ),j))return;for(var Q=this.getId(j,U),he=0;he<B.length;he++){var ie=B[he];if(!(m&&m.indexOf(ie)<0)){var me=k[ie];if(me){var be={};Q!==void 0&&A&&(be=A.getState(me.sourceLayer||"_geojsonTileLayer",Q));var Se=we({},I[ie]);Se.paint=Zf(Se.paint,me.paint,j,be,x),Se.layout=Zf(Se.layout,me.layout,j,be,x);var Ee=!C||C(j,me,be);if(Ee){var Ce=new Gc(j,this.z,this.x,this.y,Q);Ce.layer=Se;var Ve=e[ie];Ve===void 0&&(Ve=e[ie]=[]),Ve.push({featureIndex:l,feature:Ce,intersectionZ:Ee})}}}}}},Co.prototype.lookupSymbolFeatures=function(e,t,i,l,f,m,x,k){var I={};this.loadVTLayers();for(var A=Gs(f),C=0,B=e;C<B.length;C+=1)this.loadMatchingFeature(I,i,l,B[C],A,m,x,k,t);return I},Co.prototype.hasLayer=function(e){for(var t=0,i=this.bucketLayerIDs;t<i.length;t+=1)for(var l=0,f=i[t];l<f.length;l+=1)if(e===f[l])return!0;return!1},Co.prototype.getId=function(e,t){var i=e.id;return this.promoteId&&typeof(i=e.properties[typeof this.promoteId=="string"?this.promoteId:this.promoteId[t]])=="boolean"&&(i=Number(i)),i},ft("FeatureIndex",Co,{omit:["rawTileData","sourceLayerCoder"]});var Yi=function(e,t){this.tileID=e,this.uid=ut(),this.uses=0,this.tileSize=t,this.buckets={},this.expirationTime=null,this.queryPadding=0,this.hasSymbolBuckets=!1,this.hasRTLText=!1,this.dependencies={},this.expiredRequestCount=0,this.state="loading"};Yi.prototype.registerFadeDuration=function(e){var t=e+this.timeAdded;t<en.now()||this.fadeEndTime&&t<this.fadeEndTime||(this.fadeEndTime=t)},Yi.prototype.wasRequested=function(){return this.state==="errored"||this.state==="loaded"||this.state==="reloading"},Yi.prototype.loadVectorData=function(e,t,i){if(this.hasData()&&this.unloadVectorData(),this.state="loaded",e){for(var l in e.featureIndex&&(this.latestFeatureIndex=e.featureIndex,e.rawTileData?(this.latestRawTileData=e.rawTileData,this.latestFeatureIndex.rawTileData=e.rawTileData):this.latestRawTileData&&(this.latestFeatureIndex.rawTileData=this.latestRawTileData)),this.collisionBoxArray=e.collisionBoxArray,this.buckets=function(A,C){var B={};if(!C)return B;for(var U=function(){var Q=J[j],he=Q.layerIds.map(function(be){return C.getLayer(be)}).filter(Boolean);if(he.length!==0){Q.layers=he,Q.stateDependentLayerIds&&(Q.stateDependentLayers=Q.stateDependentLayerIds.map(function(be){return he.filter(function(Se){return Se.id===be})[0]}));for(var ie=0,me=he;ie<me.length;ie+=1)B[me[ie].id]=Q}},j=0,J=A;j<J.length;j+=1)U();return B}(e.buckets,t.style),this.hasSymbolBuckets=!1,this.buckets){var f=this.buckets[l];if(f instanceof Lr){if(this.hasSymbolBuckets=!0,!i)break;f.justReloaded=!0}}if(this.hasRTLText=!1,this.hasSymbolBuckets)for(var m in this.buckets){var x=this.buckets[m];if(x instanceof Lr&&x.hasRTLText){this.hasRTLText=!0,Qn.isLoading()||Qn.isLoaded()||ru()!=="deferred"||da();break}}for(var k in this.queryPadding=0,this.buckets){var I=this.buckets[k];this.queryPadding=Math.max(this.queryPadding,t.style.getLayer(k).queryRadius(I))}e.imageAtlas&&(this.imageAtlas=e.imageAtlas),e.glyphAtlasImage&&(this.glyphAtlasImage=e.glyphAtlasImage)}else this.collisionBoxArray=new s},Yi.prototype.unloadVectorData=function(){for(var e in this.buckets)this.buckets[e].destroy();this.buckets={},this.imageAtlasTexture&&this.imageAtlasTexture.destroy(),this.imageAtlas&&(this.imageAtlas=null),this.glyphAtlasTexture&&this.glyphAtlasTexture.destroy(),this.latestFeatureIndex=null,this.state="unloaded"},Yi.prototype.getBucket=function(e){return this.buckets[e.id]},Yi.prototype.upload=function(e){for(var t in this.buckets){var i=this.buckets[t];i.uploadPending()&&i.upload(e)}var l=e.gl;this.imageAtlas&&!this.imageAtlas.uploaded&&(this.imageAtlasTexture=new As(e,this.imageAtlas.image,l.RGBA),this.imageAtlas.uploaded=!0),this.glyphAtlasImage&&(this.glyphAtlasTexture=new As(e,this.glyphAtlasImage,l.ALPHA),this.glyphAtlasImage=null)},Yi.prototype.prepare=function(e){this.imageAtlas&&this.imageAtlas.patchUpdatedImages(e,this.imageAtlasTexture)},Yi.prototype.queryRenderedFeatures=function(e,t,i,l,f,m,x,k,I,A){return this.latestFeatureIndex&&this.latestFeatureIndex.rawTileData?this.latestFeatureIndex.query({queryGeometry:l,cameraQueryGeometry:f,scale:m,tileSize:this.tileSize,pixelPosMatrix:A,transform:k,params:x,queryPadding:this.queryPadding*I},e,t,i):{}},Yi.prototype.querySourceFeatures=function(e,t){var i=this.latestFeatureIndex;if(i&&i.rawTileData){var l=i.loadVTLayers(),f=t?t.sourceLayer:"",m=l._geojsonTileLayer||l[f];if(m)for(var x=Gs(t&&t.filter),k=this.tileID.canonical,I=k.z,A=k.x,C=k.y,B={z:I,x:A,y:C},U=0;U<m.length;U++){var j=m.feature(U);if(x.needGeometry){var J=di(j,!0);if(!x.filter(new ur(this.tileID.overscaledZ),J,this.tileID.canonical))continue}else if(!x.filter(new ur(this.tileID.overscaledZ),j))continue;var Q=i.getId(j,f),he=new Gc(j,I,A,C,Q);he.tile=B,e.push(he)}}},Yi.prototype.hasData=function(){return this.state==="loaded"||this.state==="reloading"||this.state==="expired"},Yi.prototype.patternsLoaded=function(){return this.imageAtlas&&!!Object.keys(this.imageAtlas.patternPositions).length},Yi.prototype.setExpiryData=function(e){var t=this.expirationTime;if(e.cacheControl){var i=At(e.cacheControl);i["max-age"]&&(this.expirationTime=Date.now()+1e3*i["max-age"])}else e.expires&&(this.expirationTime=new Date(e.expires).getTime());if(this.expirationTime){var l=Date.now(),f=!1;if(this.expirationTime>l)f=!1;else if(t)if(this.expirationTime<t)f=!0;else{var m=this.expirationTime-t;m?this.expirationTime=l+Math.max(m,3e4):f=!0}else f=!0;f?(this.expiredRequestCount++,this.state="expired"):this.expiredRequestCount=0}},Yi.prototype.getExpiryTimeout=function(){if(this.expirationTime)return this.expiredRequestCount?1e3*(1<<Math.min(this.expiredRequestCount-1,31)):Math.min(this.expirationTime-new Date().getTime(),Math.pow(2,31)-1)},Yi.prototype.setFeatureState=function(e,t){if(this.latestFeatureIndex&&this.latestFeatureIndex.rawTileData&&Object.keys(e).length!==0){var i=this.latestFeatureIndex.loadVTLayers();for(var l in this.buckets)if(t.style.hasLayer(l)){var f=this.buckets[l],m=f.layers[0].sourceLayer||"_geojsonTileLayer",x=i[m],k=e[m];if(x&&k&&Object.keys(k).length!==0){f.update(k,x,this.imageAtlas&&this.imageAtlas.patternPositions||{});var I=t&&t.style&&t.style.getLayer(l);I&&(this.queryPadding=Math.max(this.queryPadding,I.queryRadius(f)))}}}},Yi.prototype.holdingForFade=function(){return this.symbolFadeHoldUntil!==void 0},Yi.prototype.symbolFadeFinished=function(){return!this.symbolFadeHoldUntil||this.symbolFadeHoldUntil<en.now()},Yi.prototype.clearFadeHold=function(){this.symbolFadeHoldUntil=void 0},Yi.prototype.setHoldDuration=function(e){this.symbolFadeHoldUntil=en.now()+e},Yi.prototype.setDependencies=function(e,t){for(var i={},l=0,f=t;l<f.length;l+=1)i[f[l]]=!0;this.dependencies[e]=i},Yi.prototype.hasDependency=function(e,t){for(var i=0,l=e;i<l.length;i+=1){var f=this.dependencies[l[i]];if(f){for(var m=0,x=t;m<x.length;m+=1)if(f[x[m]])return!0}}return!1};var Jo=L.performance,Kf=function(e){this._marks={start:[e.url,"start"].join("#"),end:[e.url,"end"].join("#"),measure:e.url.toString()},Jo.mark(this._marks.start)};Kf.prototype.finish=function(){Jo.mark(this._marks.end);var e=Jo.getEntriesByName(this._marks.measure);return e.length===0&&(Jo.measure(this._marks.measure,this._marks.start,this._marks.end),e=Jo.getEntriesByName(this._marks.measure),Jo.clearMarks(this._marks.start),Jo.clearMarks(this._marks.end),Jo.clearMeasures(this._marks.measure)),e},a.Actor=gl,a.AlphaImage=Is,a.CanonicalTileID=Cs,a.CollisionBoxArray=s,a.Color=pr,a.DEMData=Po,a.DataConstantProperty=St,a.DictionaryCoder=Zc,a.EXTENT=8192,a.ErrorEvent=se,a.EvaluationParameters=ur,a.Event=W,a.Evented=pe,a.FeatureIndex=Co,a.FillBucket=Ra,a.FillExtrusionBucket=Ba,a.ImageAtlas=gu,a.ImagePosition=Rc,a.LineBucket=Pn,a.LngLat=Wr,a.LngLatBounds=Di,a.MercatorCoordinate=Ps,a.ONE_EM=24,a.OverscaledTileID=Li,a.Point=F,a.Point$1=F,a.Properties=an,a.Protobuf=Dc,a.RGBAImage=jn,a.RequestManager=Qr,a.RequestPerformance=Kf,a.ResourceType=ra,a.SegmentVector=G,a.SourceFeatureState=_l,a.StructArrayLayout1ui2=lu,a.StructArrayLayout2f1f2i16=zo,a.StructArrayLayout2i4=Eo,a.StructArrayLayout3ui6=Wa,a.StructArrayLayout4i8=nu,a.SymbolBucket=Lr,a.Texture=As,a.Tile=Yi,a.Transitionable=nn,a.Uniform1f=He,a.Uniform1i=Oe,a.Uniform2f=Ge,a.Uniform3f=lt,a.Uniform4f=kt,a.UniformColor=It,a.UniformMatrix4f=gr,a.UnwrappedTileID=jf,a.ValidationError=ee,a.WritingMode=sa,a.ZoomHistory=Ql,a.add=function(e,t,i){return e[0]=t[0]+i[0],e[1]=t[1]+i[1],e[2]=t[2]+i[2],e},a.addDynamicAttributes=cp,a.asyncAll=function(e,t,i){if(!e.length)return i(null,[]);var l=e.length,f=new Array(e.length),m=null;e.forEach(function(x,k){t(x,function(I,A){I&&(m=I),f[k]=A,--l==0&&i(m,f)})})},a.bezier=ne,a.bindAll=vt,a.browser=en,a.cacheEntryPossiblyAdded=function(e){++Wn>ta&&(e.getActor().send("enforceCacheSizeLimit",jr),Wn=0)},a.clamp=ve,a.clearTileCache=function(e){var t=L.caches.delete("mapbox-tiles");e&&t.catch(e).then(function(){return e()})},a.clipLine=Tf,a.clone=function(e){var t=new kr(16);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t},a.clone$1=Ze,a.clone$2=function(e){var t=new kr(3);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t},a.collisionCircleLayout=pg,a.config=Wt,a.create=function(){var e=new kr(16);return kr!=Float32Array&&(e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[11]=0,e[12]=0,e[13]=0,e[14]=0),e[0]=1,e[5]=1,e[10]=1,e[15]=1,e},a.create$1=function(){var e=new kr(9);return kr!=Float32Array&&(e[1]=0,e[2]=0,e[3]=0,e[5]=0,e[6]=0,e[7]=0),e[0]=1,e[4]=1,e[8]=1,e},a.create$2=function(){var e=new kr(4);return kr!=Float32Array&&(e[1]=0,e[2]=0),e[0]=1,e[3]=1,e},a.createCommonjsModule=T,a.createExpression=js,a.createLayout=Xi,a.createStyleLayer=function(e){return e.type==="custom"?new Zg(e):new Gg[e.type](e)},a.cross=function(e,t,i){var l=t[0],f=t[1],m=t[2],x=i[0],k=i[1],I=i[2];return e[0]=f*I-m*k,e[1]=m*x-l*I,e[2]=l*k-f*x,e},a.deepEqual=function e(t,i){if(Array.isArray(t)){if(!Array.isArray(i)||t.length!==i.length)return!1;for(var l=0;l<t.length;l++)if(!e(t[l],i[l]))return!1;return!0}if(typeof t=="object"&&t!==null&&i!==null){if(typeof i!="object"||Object.keys(t).length!==Object.keys(i).length)return!1;for(var f in t)if(!e(t[f],i[f]))return!1;return!0}return t===i},a.dot=function(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]},a.dot$1=function(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]+e[3]*t[3]},a.ease=ce,a.emitValidationErrors=_s,a.endsWith=Ue,a.enforceCacheSizeLimit=function(e){gn(),pi&&pi.then(function(t){t.keys().then(function(i){for(var l=0;l<i.length-e;l++)t.delete(i[l])})})},a.evaluateSizeForFeature=xf,a.evaluateSizeForZoom=wf,a.evaluateVariableOffset=Pf,a.evented=tu,a.extend=we,a.featureFilter=Gs,a.filterObject=mt,a.fromRotation=function(e,t){var i=Math.sin(t),l=Math.cos(t);return e[0]=l,e[1]=i,e[2]=0,e[3]=-i,e[4]=l,e[5]=0,e[6]=0,e[7]=0,e[8]=1,e},a.getAnchorAlignment=op,a.getAnchorJustification=up,a.getArrayBuffer=ri,a.getImage=N,a.getJSON=function(e,t){return Zi(we(e,{type:"json"}),t)},a.getRTLTextPluginStatus=ru,a.getReferrer=ti,a.getVideo=function(e,t){var i,l,f=L.document.createElement("video");f.muted=!0,f.onloadstart=function(){t(null,f)};for(var m=0;m<e.length;m++){var x=L.document.createElement("source");i=e[m],l=void 0,(l=L.document.createElement("a")).href=i,(l.protocol!==L.document.location.protocol||l.host!==L.document.location.host)&&(f.crossOrigin="Anonymous"),x.src=e[m],f.appendChild(x)}return{cancel:function(){}}},a.identity=$n,a.invert=function(e,t){var i=t[0],l=t[1],f=t[2],m=t[3],x=t[4],k=t[5],I=t[6],A=t[7],C=t[8],B=t[9],U=t[10],j=t[11],J=t[12],Q=t[13],he=t[14],ie=t[15],me=i*k-l*x,be=i*I-f*x,Se=i*A-m*x,Ee=l*I-f*k,Ce=l*A-m*k,Ve=f*A-m*I,Je=C*Q-B*J,bt=C*he-U*J,nt=C*ie-j*J,Et=B*he-U*Q,at=B*ie-j*Q,$t=U*ie-j*he,Dt=me*$t-be*at+Se*Et+Ee*nt-Ce*bt+Ve*Je;return Dt?(e[0]=(k*$t-I*at+A*Et)*(Dt=1/Dt),e[1]=(f*at-l*$t-m*Et)*Dt,e[2]=(Q*Ve-he*Ce+ie*Ee)*Dt,e[3]=(U*Ce-B*Ve-j*Ee)*Dt,e[4]=(I*nt-x*$t-A*bt)*Dt,e[5]=(i*$t-f*nt+m*bt)*Dt,e[6]=(he*Se-J*Ve-ie*be)*Dt,e[7]=(C*Ve-U*Se+j*be)*Dt,e[8]=(x*at-k*nt+A*Je)*Dt,e[9]=(l*nt-i*at-m*Je)*Dt,e[10]=(J*Ce-Q*Se+ie*me)*Dt,e[11]=(B*Se-C*Ce-j*me)*Dt,e[12]=(k*bt-x*Et-I*Je)*Dt,e[13]=(i*Et-l*bt+f*Je)*Dt,e[14]=(Q*be-J*Ee-he*me)*Dt,e[15]=(C*Ee-B*be+U*me)*Dt,e):null},a.isChar=et,a.isMapboxURL=vi,a.keysDifference=function(e,t){var i=[];for(var l in e)l in t||i.push(l);return i},a.makeRequest=Zi,a.mapObject=ct,a.mercatorXfromLng=Uf,a.mercatorYfromLat=Vf,a.mercatorZfromAltitude=qf,a.mul=Xh,a.multiply=An,a.mvt=ll,a.nextPowerOfTwo=function(e){return e<=1?1:Math.pow(2,Math.ceil(Math.log(e)/Math.LN2))},a.normalize=function(e,t){var i=t[0],l=t[1],f=t[2],m=i*i+l*l+f*f;return m>0&&(m=1/Math.sqrt(m)),e[0]=t[0]*m,e[1]=t[1]*m,e[2]=t[2]*m,e},a.number=Si,a.offscreenCanvasSupported=Hr,a.ortho=function(e,t,i,l,f,m,x){var k=1/(t-i),I=1/(l-f),A=1/(m-x);return e[0]=-2*k,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=-2*I,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=2*A,e[11]=0,e[12]=(t+i)*k,e[13]=(f+l)*I,e[14]=(x+m)*A,e[15]=1,e},a.parseGlyphPBF=function(e){return new Dc(e).readFields(Sg,[])},a.pbf=Dc,a.performSymbolLayout=function(e,t,i,l,f,m,x){e.createArrays(),e.tilePixelRatio=8192/(512*e.overscaling),e.compareText={},e.iconsNeedLinear=!1;var k=e.layers[0].layout,I=e.layers[0]._unevaluatedLayout._values,A={};if(e.textSizeData.kind==="composite"){var C=e.textSizeData,B=C.maxZoom;A.compositeTextSizes=[I["text-size"].possiblyEvaluate(new ur(C.minZoom),x),I["text-size"].possiblyEvaluate(new ur(B),x)]}if(e.iconSizeData.kind==="composite"){var U=e.iconSizeData,j=U.maxZoom;A.compositeIconSizes=[I["icon-size"].possiblyEvaluate(new ur(U.minZoom),x),I["icon-size"].possiblyEvaluate(new ur(j),x)]}A.layoutTextSize=I["text-size"].possiblyEvaluate(new ur(e.zoom+1),x),A.layoutIconSize=I["icon-size"].possiblyEvaluate(new ur(e.zoom+1),x),A.textMaxSize=I["text-size"].possiblyEvaluate(new ur(18));for(var J=24*k.get("text-line-height"),Q=k.get("text-rotation-alignment")==="map"&&k.get("symbol-placement")!=="point",he=k.get("text-keep-upright"),ie=k.get("text-size"),me=function(){var Ee=Se[be],Ce=k.get("text-font").evaluate(Ee,{},x).join(","),Ve=ie.evaluate(Ee,{},x),Je=A.layoutTextSize.evaluate(Ee,{},x),bt=A.layoutIconSize.evaluate(Ee,{},x),nt={horizontal:{},vertical:void 0},Et=Ee.text,at=[0,0];if(Et){var $t=Et.toString(),Dt=24*k.get("text-letter-spacing").evaluate(Ee,{},x),_t=function(cr){for(var Or=0,Pr=cr;Or<Pr.length;Or+=1)if(_r=Pr[Or].charCodeAt(0),et.Arabic(_r)||et["Arabic Supplement"](_r)||et["Arabic Extended-A"](_r)||et["Arabic Presentation Forms-A"](_r)||et["Arabic Presentation Forms-B"](_r))return!1;var _r;return!0}($t)?Dt:0,lr=k.get("text-anchor").evaluate(Ee,{},x),Gt=k.get("text-variable-anchor");if(!Gt){var yr=k.get("text-radial-offset").evaluate(Ee,{},x);at=yr?Pf(lr,[24*yr,lp]):k.get("text-offset").evaluate(Ee,{},x).map(function(cr){return 24*cr})}var zt=Q?"center":k.get("text-justify").evaluate(Ee,{},x),xr=k.get("symbol-placement"),Yr=xr==="point"?24*k.get("text-max-width").evaluate(Ee,{},x):0,oi=function(){e.allowVerticalPlacement&&$l($t)&&(nt.vertical=Bc(Et,t,i,f,Ce,Yr,J,lr,"left",_t,at,sa.vertical,!0,xr,Je,Ve))};if(!Q&&Gt){for(var ei=zt==="auto"?Gt.map(function(cr){return up(cr)}):[zt],Jr=!1,si=0;si<ei.length;si++){var Ui=ei[si];if(!nt.horizontal[Ui])if(Jr)nt.horizontal[Ui]=nt.horizontal[0];else{var Vi=Bc(Et,t,i,f,Ce,Yr,J,"center",Ui,_t,at,sa.horizontal,!1,xr,Je,Ve);Vi&&(nt.horizontal[Ui]=Vi,Jr=Vi.positionedLines.length===1)}}oi()}else{zt==="auto"&&(zt=up(lr));var Sn=Bc(Et,t,i,f,Ce,Yr,J,lr,zt,_t,at,sa.horizontal,!1,xr,Je,Ve);Sn&&(nt.horizontal[zt]=Sn),oi(),$l($t)&&Q&&he&&(nt.vertical=Bc(Et,t,i,f,Ce,Yr,J,lr,zt,_t,at,sa.vertical,!1,xr,Je,Ve))}}var Ji=void 0,kn=!1;if(Ee.icon&&Ee.icon.name){var mi=l[Ee.icon.name];mi&&(Ji=function(cr,Or,Pr){var _r=op(Pr),Cn=Or[0]-cr.displaySize[0]*_r.horizontalAlign,hn=Or[1]-cr.displaySize[1]*_r.verticalAlign;return{image:cr,top:hn,bottom:hn+cr.displaySize[1],left:Cn,right:Cn+cr.displaySize[0]}}(f[Ee.icon.name],k.get("icon-offset").evaluate(Ee,{},x),k.get("icon-anchor").evaluate(Ee,{},x)),kn=mi.sdf,e.sdfIcons===void 0?e.sdfIcons=mi.sdf:e.sdfIcons!==mi.sdf&&yt("Style sheet warning: Cannot mix SDF and non-SDF icons in one buffer"),(mi.pixelRatio!==e.pixelRatio||k.get("icon-rotate").constantOr(1)!==0)&&(e.iconsNeedLinear=!0))}var Qi=Mf(nt.horizontal)||nt.vertical;e.iconsInText=!!Qi&&Qi.iconsInText,(Qi||Ji)&&function(cr,Or,Pr,_r,Cn,hn,Kr,Ei,pn,wr,to){var la=hn.textMaxSize.evaluate(Or,{});la===void 0&&(la=Kr);var ro,yi=cr.layers[0].layout,io=yi.get("icon-offset").evaluate(Or,{},to),Pa=Mf(Pr.horizontal),vl=Kr/24,Ms=cr.tilePixelRatio*vl,bl=cr.tilePixelRatio*la/24,Mo=cr.tilePixelRatio*Ei,xl=cr.tilePixelRatio*yi.get("symbol-spacing"),Kc=yi.get("text-padding")*cr.tilePixelRatio,wl=yi.get("icon-padding")*cr.tilePixelRatio,bu=yi.get("text-max-angle")/180*Math.PI,Hc=yi.get("text-rotation-alignment")==="map"&&yi.get("symbol-placement")!=="point",Xc=yi.get("icon-rotation-alignment")==="map"&&yi.get("symbol-placement")!=="point",Do=yi.get("symbol-placement"),xu=xl/2,Sl=yi.get("icon-text-fit");_r&&Sl!=="none"&&(cr.allowVerticalPlacement&&Pr.vertical&&(ro=bf(_r,Pr.vertical,Sl,yi.get("icon-text-fit-padding"),io,vl)),Pa&&(_r=bf(_r,Pa,Sl,yi.get("icon-text-fit-padding"),io,vl)));var Qo=function(Hg,Au){Au.x<0||Au.x>=8192||Au.y<0||Au.y>=8192||function(gi,Oa,Xg,$o,_p,Wf,eh,no,th,Pu,rh,ih,vp,Yf,Cu,Jf,Qf,$f,ed,td,ua,nh,rd,ao,Wg){var id,Ls,Il,Al,Pl,Cl=gi.addToLineVertexArray(Oa,Xg),nd=0,ad=0,od=0,sd=0,bp=-1,xp=-1,Lo={},ld=Y(""),wp=0,Sp=0;if(no._unevaluatedLayout.getValue("text-radial-offset")===void 0?(wp=(id=no.layout.get("text-offset").evaluate(ua,{},ao).map(function(Du){return 24*Du}))[0],Sp=id[1]):(wp=24*no.layout.get("text-radial-offset").evaluate(ua,{},ao),Sp=lp),gi.allowVerticalPlacement&&$o.vertical){var ud=no.layout.get("text-rotate").evaluate(ua,{},ao)+90;Al=new Vc(th,Oa,Pu,rh,ih,$o.vertical,vp,Yf,Cu,ud),eh&&(Pl=new Vc(th,Oa,Pu,rh,ih,eh,Qf,$f,Cu,ud))}if(_p){var kp=no.layout.get("icon-rotate").evaluate(ua,{}),cd=no.layout.get("icon-text-fit")!=="none",hd=If(_p,kp,rd,cd),Ep=eh?If(eh,kp,rd,cd):void 0;Il=new Vc(th,Oa,Pu,rh,ih,_p,Qf,$f,!1,kp),nd=4*hd.length;var pd=gi.iconSizeData,Mu=null;pd.kind==="source"?(Mu=[128*no.layout.get("icon-size").evaluate(ua,{})])[0]>32640&&yt(gi.layerIds[0]+': Value for "icon-size" is >= 255. Reduce your "icon-size".'):pd.kind==="composite"&&((Mu=[128*nh.compositeIconSizes[0].evaluate(ua,{},ao),128*nh.compositeIconSizes[1].evaluate(ua,{},ao)])[0]>32640||Mu[1]>32640)&&yt(gi.layerIds[0]+': Value for "icon-size" is >= 255. Reduce your "icon-size".'),gi.addSymbols(gi.icon,hd,Mu,td,ed,ua,!1,Oa,Cl.lineStartIndex,Cl.lineLength,-1,ao),bp=gi.icon.placedSymbolArray.length-1,Ep&&(ad=4*Ep.length,gi.addSymbols(gi.icon,Ep,Mu,td,ed,ua,sa.vertical,Oa,Cl.lineStartIndex,Cl.lineLength,-1,ao),xp=gi.icon.placedSymbolArray.length-1)}for(var fd in $o.horizontal){var ah=$o.horizontal[fd];if(!Ls){ld=Y(ah.text);var Yg=no.layout.get("text-rotate").evaluate(ua,{},ao);Ls=new Vc(th,Oa,Pu,rh,ih,ah,vp,Yf,Cu,Yg)}var dd=ah.positionedLines.length===1;if(od+=Cf(gi,Oa,ah,Wf,no,Cu,ua,Jf,Cl,$o.vertical?sa.horizontal:sa.horizontalOnly,dd?Object.keys($o.horizontal):[fd],Lo,bp,nh,ao),dd)break}$o.vertical&&(sd+=Cf(gi,Oa,$o.vertical,Wf,no,Cu,ua,Jf,Cl,sa.vertical,["vertical"],Lo,xp,nh,ao));var Jg=Ls?Ls.boxStartIndex:gi.collisionBoxArray.length,Qg=Ls?Ls.boxEndIndex:gi.collisionBoxArray.length,$g=Al?Al.boxStartIndex:gi.collisionBoxArray.length,e_=Al?Al.boxEndIndex:gi.collisionBoxArray.length,t_=Il?Il.boxStartIndex:gi.collisionBoxArray.length,r_=Il?Il.boxEndIndex:gi.collisionBoxArray.length,i_=Pl?Pl.boxStartIndex:gi.collisionBoxArray.length,n_=Pl?Pl.boxEndIndex:gi.collisionBoxArray.length,oo=-1,oh=function(Du,yd){return Du&&Du.circleDiameter?Math.max(Du.circleDiameter,yd):yd};oo=oh(Ls,oo),oo=oh(Al,oo),oo=oh(Il,oo);var md=(oo=oh(Pl,oo))>-1?1:0;md&&(oo*=Wg/24),gi.glyphOffsetArray.length>=Lr.MAX_GLYPHS&&yt("Too many glyphs being rendered in a tile. See https://github.com/mapbox/mapbox-gl-js/issues/2907"),ua.sortKey!==void 0&&gi.addToSortKeyRanges(gi.symbolInstances.length,ua.sortKey),gi.symbolInstances.emplaceBack(Oa.x,Oa.y,Lo.right>=0?Lo.right:-1,Lo.center>=0?Lo.center:-1,Lo.left>=0?Lo.left:-1,Lo.vertical||-1,bp,xp,ld,Jg,Qg,$g,e_,t_,r_,i_,n_,Pu,od,sd,nd,ad,md,0,vp,wp,Sp,oo)}(cr,Au,Hg,Pr,_r,Cn,ro,cr.layers[0],cr.collisionBoxArray,Or.index,Or.sourceLayerIndex,cr.index,Ms,Kc,Hc,pn,Mo,wl,Xc,io,Or,hn,wr,to,Kr)};if(Do==="line")for(var kl=0,Wc=Tf(Or.geometry,0,0,8192,8192);kl<Wc.length;kl+=1)for(var Yc=Wc[kl],wu=0,Su=Pg(Yc,xl,bu,Pr.vertical||Pa,_r,24,bl,cr.overscaling,8192);wu<Su.length;wu+=1){var Jc=Su[wu];Pa&&Lg(cr,Pa.text,xu,Jc)||Qo(Yc,Jc)}else if(Do==="line-center")for(var ku=0,Eu=Or.geometry;ku<Eu.length;ku+=1){var zu=Eu[ku];if(zu.length>1){var Qc=Ag(zu,bu,Pr.vertical||Pa,_r,24,bl);Qc&&Qo(zu,Qc)}}else if(Or.type==="Polygon")for(var El=0,$c=tp(Or.geometry,0);El<$c.length;El+=1){var zl=$c[El],Tu=Mg(zl,16);Qo(zl[0],new pl(Tu.x,Tu.y,0))}else if(Or.type==="LineString")for(var Ds=0,Iu=Or.geometry;Ds<Iu.length;Ds+=1){var Tl=Iu[Ds];Qo(Tl,new pl(Tl[0].x,Tl[0].y,0))}else if(Or.type==="Point")for(var mp=0,Hf=Or.geometry;mp<Hf.length;mp+=1)for(var yp=0,Xf=Hf[mp];yp<Xf.length;yp+=1){var gp=Xf[yp];Qo([gp],new pl(gp.x,gp.y,0))}}(e,Ee,nt,Ji,l,A,Je,bt,at,kn,x)},be=0,Se=e.features;be<Se.length;be+=1)me();m&&e.generateCollisionDebugBuffers()},a.perspective=function(e,t,i,l,f){var m,x=1/Math.tan(t/2);return e[0]=x/i,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=x,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[11]=-1,e[12]=0,e[13]=0,e[15]=0,f!=null&&f!==1/0?(e[10]=(f+l)*(m=1/(l-f)),e[14]=2*f*l*m):(e[10]=-1,e[14]=-2*l),e},a.pick=function(e,t){for(var i={},l=0;l<t.length;l++){var f=t[l];f in e&&(i[f]=e[f])}return i},a.plugin=Qn,a.polygonIntersectsPolygon=Qa,a.postMapLoadEvent=ji,a.postTurnstileEvent=Xn,a.potpack=yf,a.refProperties=["type","source","source-layer","minzoom","maxzoom","filter","layout"],a.register=ft,a.registerForPluginStateChange=function(e){return e({pluginStatus:Un,pluginURL:Ma}),tu.on("pluginStateChange",e),e},a.renderColorRamp=Yp,a.rotate=function(e,t,i){var l=t[0],f=t[1],m=t[2],x=t[3],k=Math.sin(i),I=Math.cos(i);return e[0]=l*I+m*k,e[1]=f*I+x*k,e[2]=l*-k+m*I,e[3]=f*-k+x*I,e},a.rotateX=function(e,t,i){var l=Math.sin(i),f=Math.cos(i),m=t[4],x=t[5],k=t[6],I=t[7],A=t[8],C=t[9],B=t[10],U=t[11];return t!==e&&(e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e[4]=m*f+A*l,e[5]=x*f+C*l,e[6]=k*f+B*l,e[7]=I*f+U*l,e[8]=A*f-m*l,e[9]=C*f-x*l,e[10]=B*f-k*l,e[11]=U*f-I*l,e},a.rotateZ=function(e,t,i){var l=Math.sin(i),f=Math.cos(i),m=t[0],x=t[1],k=t[2],I=t[3],A=t[4],C=t[5],B=t[6],U=t[7];return t!==e&&(e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e[0]=m*f+A*l,e[1]=x*f+C*l,e[2]=k*f+B*l,e[3]=I*f+U*l,e[4]=A*f-m*l,e[5]=C*f-x*l,e[6]=B*f-k*l,e[7]=U*f-I*l,e},a.scale=function(e,t,i){var l=i[0],f=i[1],m=i[2];return e[0]=t[0]*l,e[1]=t[1]*l,e[2]=t[2]*l,e[3]=t[3]*l,e[4]=t[4]*f,e[5]=t[5]*f,e[6]=t[6]*f,e[7]=t[7]*f,e[8]=t[8]*m,e[9]=t[9]*m,e[10]=t[10]*m,e[11]=t[11]*m,e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15],e},a.scale$1=function(e,t,i){return e[0]=t[0]*i,e[1]=t[1]*i,e[2]=t[2]*i,e[3]=t[3]*i,e},a.scale$2=function(e,t,i){return e[0]=t[0]*i,e[1]=t[1]*i,e[2]=t[2]*i,e},a.setCacheLimits=function(e,t){jr=e,ta=t},a.setRTLTextPlugin=function(e,t,i){if(i===void 0&&(i=!1),Un==="deferred"||Un==="loading"||Un==="loaded")throw new Error("setRTLTextPlugin cannot be called multiple times.");Ma=en.resolveURL(e),Un="deferred",Qs=t,bs(),i||da()},a.sphericalToCartesian=function(e){var t=e[0],i=e[1],l=e[2];return i+=90,i*=Math.PI/180,l*=Math.PI/180,{x:t*Math.cos(i)*Math.sin(l),y:t*Math.sin(i)*Math.sin(l),z:t*Math.cos(l)}},a.sqrLen=function(e){var t=e[0],i=e[1];return t*t+i*i},a.styleSpec=q,a.sub=function(e,t,i){return e[0]=t[0]-i[0],e[1]=t[1]-i[1],e[2]=t[2]-i[2],e},a.symbolSize=Ig,a.transformMat3=function(e,t,i){var l=t[0],f=t[1],m=t[2];return e[0]=l*i[0]+f*i[3]+m*i[6],e[1]=l*i[1]+f*i[4]+m*i[7],e[2]=l*i[2]+f*i[5]+m*i[8],e},a.transformMat4=nl,a.translate=function(e,t,i){var l,f,m,x,k,I,A,C,B,U,j,J,Q=i[0],he=i[1],ie=i[2];return t===e?(e[12]=t[0]*Q+t[4]*he+t[8]*ie+t[12],e[13]=t[1]*Q+t[5]*he+t[9]*ie+t[13],e[14]=t[2]*Q+t[6]*he+t[10]*ie+t[14],e[15]=t[3]*Q+t[7]*he+t[11]*ie+t[15]):(f=t[1],m=t[2],x=t[3],k=t[4],I=t[5],A=t[6],C=t[7],B=t[8],U=t[9],j=t[10],J=t[11],e[0]=l=t[0],e[1]=f,e[2]=m,e[3]=x,e[4]=k,e[5]=I,e[6]=A,e[7]=C,e[8]=B,e[9]=U,e[10]=j,e[11]=J,e[12]=l*Q+k*he+B*ie+t[12],e[13]=f*Q+I*he+U*ie+t[13],e[14]=m*Q+A*he+j*ie+t[14],e[15]=x*Q+C*he+J*ie+t[15]),e},a.triggerPluginCompletionEvent=zc,a.uniqueId=ut,a.validateCustomStyleLayer=function(e){var t=[],i=e.id;return i===void 0&&t.push({message:"layers."+i+': missing required property "id"'}),e.render===void 0&&t.push({message:"layers."+i+': missing required method "render"'}),e.renderingMode&&e.renderingMode!=="2d"&&e.renderingMode!=="3d"&&t.push({message:"layers."+i+': property "renderingMode" must be either "2d" or "3d"'}),t},a.validateLight=Kh,a.validateStyle=ys,a.values=function(e){var t=[];for(var i in e)t.push(e[i]);return t},a.vectorTile=ll,a.version="1.13.2",a.warnOnce=yt,a.webpSupported=ui,a.window=L,a.wrap=de}),v(["./shared"],function(a){function T(R){var N=typeof R;if(N==="number"||N==="boolean"||N==="string"||R==null)return JSON.stringify(R);if(Array.isArray(R)){for(var V="[",K=0,W=R;K<W.length;K+=1)V+=T(W[K])+",";return V+"]"}for(var se=Object.keys(R).sort(),pe="{",q=0;q<se.length;q++)pe+=JSON.stringify(se[q])+":"+T(R[se[q]])+",";return pe+"}"}function z(R){for(var N="",V=0,K=a.refProperties;V<K.length;V+=1)N+="/"+T(R[K[V]]);return N}var M=function(R){this.keyCache={},R&&this.replace(R)};M.prototype.replace=function(R){this._layerConfigs={},this._layers={},this.update(R,[])},M.prototype.update=function(R,N){for(var V=this,K=0,W=R;K<W.length;K+=1){var se=W[K];this._layerConfigs[se.id]=se;var pe=this._layers[se.id]=a.createStyleLayer(se);pe._featureFilter=a.featureFilter(pe.filter),this.keyCache[se.id]&&delete this.keyCache[se.id]}for(var q=0,ee=N;q<ee.length;q+=1){var ye=ee[q];delete this.keyCache[ye],delete this._layerConfigs[ye],delete this._layers[ye]}this.familiesBySource={};for(var Pe=0,Fe=function(We,$e){for(var Zt={},rt=0;rt<We.length;rt++){var tr=$e&&$e[We[rt].id]||z(We[rt]);$e&&($e[We[rt].id]=tr);var br=Zt[tr];br||(br=Zt[tr]=[]),br.push(We[rt])}var Ht=[];for(var hr in Zt)Ht.push(Zt[hr]);return Ht}(a.values(this._layerConfigs),this.keyCache);Pe<Fe.length;Pe+=1){var ze=Fe[Pe].map(function(We){return V._layers[We.id]}),Re=ze[0];if(Re.visibility!=="none"){var st=Re.source||"",it=this.familiesBySource[st];it||(it=this.familiesBySource[st]={});var xe=Re.sourceLayer||"_geojsonTileLayer",tt=it[xe];tt||(tt=it[xe]=[]),tt.push(ze)}}};var F=function(R){var N={},V=[];for(var K in R){var W=R[K],se=N[K]={};for(var pe in W){var q=W[+pe];if(q&&q.bitmap.width!==0&&q.bitmap.height!==0){var ee={x:0,y:0,w:q.bitmap.width+2,h:q.bitmap.height+2};V.push(ee),se[pe]={rect:ee,metrics:q.metrics}}}}var ye=a.potpack(V),Pe=new a.AlphaImage({width:ye.w||1,height:ye.h||1});for(var Fe in R){var ze=R[Fe];for(var Re in ze){var st=ze[+Re];if(st&&st.bitmap.width!==0&&st.bitmap.height!==0){var it=N[Fe][Re].rect;a.AlphaImage.copy(st.bitmap,Pe,{x:0,y:0},{x:it.x+1,y:it.y+1},st.bitmap)}}}this.image=Pe,this.positions=N};a.register("GlyphAtlas",F);var D=function(R){this.tileID=new a.OverscaledTileID(R.tileID.overscaledZ,R.tileID.wrap,R.tileID.canonical.z,R.tileID.canonical.x,R.tileID.canonical.y),this.uid=R.uid,this.zoom=R.zoom,this.pixelRatio=R.pixelRatio,this.tileSize=R.tileSize,this.source=R.source,this.overscaling=this.tileID.overscaleFactor(),this.showCollisionBoxes=R.showCollisionBoxes,this.collectResourceTiming=!!R.collectResourceTiming,this.returnDependencies=!!R.returnDependencies,this.promoteId=R.promoteId};function L(R,N,V){for(var K=new a.EvaluationParameters(N),W=0,se=R;W<se.length;W+=1)se[W].recalculate(K,V)}function X(R,N){var V=a.getArrayBuffer(R.request,function(K,W,se,pe){K?N(K):W&&N(null,{vectorTile:new a.vectorTile.VectorTile(new a.pbf(W)),rawData:W,cacheControl:se,expires:pe})});return function(){V.cancel(),N()}}D.prototype.parse=function(R,N,V,K,W){var se=this;this.status="parsing",this.data=R,this.collisionBoxArray=new a.CollisionBoxArray;var pe=new a.DictionaryCoder(Object.keys(R.layers).sort()),q=new a.FeatureIndex(this.tileID,this.promoteId);q.bucketLayerIDs=[];var ee,ye,Pe,Fe,ze={},Re={featureIndex:q,iconDependencies:{},patternDependencies:{},glyphDependencies:{},availableImages:V},st=N.familiesBySource[this.source];for(var it in st){var xe=R.layers[it];if(xe){xe.version===1&&a.warnOnce('Vector tile source "'+this.source+'" layer "'+it+'" does not use vector tile spec v2 and therefore may have some rendering errors.');for(var tt=pe.encode(it),We=[],$e=0;$e<xe.length;$e++){var Zt=xe.feature($e),rt=q.getId(Zt,it);We.push({feature:Zt,id:rt,index:$e,sourceLayerIndex:tt})}for(var tr=0,br=st[it];tr<br.length;tr+=1){var Ht=br[tr],hr=Ht[0];hr.minzoom&&this.zoom<Math.floor(hr.minzoom)||hr.maxzoom&&this.zoom>=hr.maxzoom||hr.visibility!=="none"&&(L(Ht,this.zoom,V),(ze[hr.id]=hr.createBucket({index:q.bucketLayerIDs.length,layers:Ht,zoom:this.zoom,pixelRatio:this.pixelRatio,overscaling:this.overscaling,collisionBoxArray:this.collisionBoxArray,sourceLayerIndex:tt,sourceID:this.source})).populate(We,Re,this.tileID.canonical),q.bucketLayerIDs.push(Ht.map(function(vr){return vr.id})))}}}var rr=a.mapObject(Re.glyphDependencies,function(vr){return Object.keys(vr).map(Number)});Object.keys(rr).length?K.send("getGlyphs",{uid:this.uid,stacks:rr},function(vr,Qt){ee||(ee=vr,ye=Qt,Fr.call(se))}):ye={};var wi=Object.keys(Re.iconDependencies);wi.length?K.send("getImages",{icons:wi,source:this.source,tileID:this.tileID,type:"icons"},function(vr,Qt){ee||(ee=vr,Pe=Qt,Fr.call(se))}):Pe={};var mr=Object.keys(Re.patternDependencies);function Fr(){if(ee)return W(ee);if(ye&&Pe&&Fe){var vr=new F(ye),Qt=new a.ImageAtlas(Pe,Fe);for(var pr in ze){var Ti=ze[pr];Ti instanceof a.SymbolBucket?(L(Ti.layers,this.zoom,V),a.performSymbolLayout(Ti,ye,vr.positions,Pe,Qt.iconPositions,this.showCollisionBoxes,this.tileID.canonical)):Ti.hasPattern&&(Ti instanceof a.LineBucket||Ti instanceof a.FillBucket||Ti instanceof a.FillExtrusionBucket)&&(L(Ti.layers,this.zoom,V),Ti.addFeatures(Re,this.tileID.canonical,Qt.patternPositions))}this.status="done",W(null,{buckets:a.values(ze).filter(function(ha){return!ha.isEmpty()}),featureIndex:q,collisionBoxArray:this.collisionBoxArray,glyphAtlasImage:vr.image,imageAtlas:Qt,glyphMap:this.returnDependencies?ye:null,iconMap:this.returnDependencies?Pe:null,glyphPositions:this.returnDependencies?vr.positions:null})}}mr.length?K.send("getImages",{icons:mr,source:this.source,tileID:this.tileID,type:"patterns"},function(vr,Qt){ee||(ee=vr,Fe=Qt,Fr.call(se))}):Fe={},Fr.call(this)};var ne=function(R,N,V,K){this.actor=R,this.layerIndex=N,this.availableImages=V,this.loadVectorData=K||X,this.loading={},this.loaded={}};ne.prototype.loadTile=function(R,N){var V=this,K=R.uid;this.loading||(this.loading={});var W=!!(R&&R.request&&R.request.collectResourceTiming)&&new a.RequestPerformance(R.request),se=this.loading[K]=new D(R);se.abort=this.loadVectorData(R,function(pe,q){if(delete V.loading[K],pe||!q)return se.status="done",V.loaded[K]=se,N(pe);var ee=q.rawData,ye={};q.expires&&(ye.expires=q.expires),q.cacheControl&&(ye.cacheControl=q.cacheControl);var Pe={};if(W){var Fe=W.finish();Fe&&(Pe.resourceTiming=JSON.parse(JSON.stringify(Fe)))}se.vectorTile=q.vectorTile,se.parse(q.vectorTile,V.layerIndex,V.availableImages,V.actor,function(ze,Re){if(ze||!Re)return N(ze);N(null,a.extend({rawTileData:ee.slice(0)},Re,ye,Pe))}),V.loaded=V.loaded||{},V.loaded[K]=se})},ne.prototype.reloadTile=function(R,N){var V=this,K=this.loaded,W=R.uid,se=this;if(K&&K[W]){var pe=K[W];pe.showCollisionBoxes=R.showCollisionBoxes;var q=function(ee,ye){var Pe=pe.reloadCallback;Pe&&(delete pe.reloadCallback,pe.parse(pe.vectorTile,se.layerIndex,V.availableImages,se.actor,Pe)),N(ee,ye)};pe.status==="parsing"?pe.reloadCallback=q:pe.status==="done"&&(pe.vectorTile?pe.parse(pe.vectorTile,this.layerIndex,this.availableImages,this.actor,q):q())}},ne.prototype.abortTile=function(R,N){var V=this.loading,K=R.uid;V&&V[K]&&V[K].abort&&(V[K].abort(),delete V[K]),N()},ne.prototype.removeTile=function(R,N){var V=this.loaded,K=R.uid;V&&V[K]&&delete V[K],N()};var ce=a.window.ImageBitmap,ve=function(){this.loaded={}};function de(R,N){if(R.length!==0){we(R[0],N);for(var V=1;V<R.length;V++)we(R[V],!N)}}function we(R,N){for(var V=0,K=0,W=R.length,se=W-1;K<W;se=K++)V+=(R[K][0]-R[se][0])*(R[se][1]+R[K][1]);V>=0!=!!N&&R.reverse()}ve.prototype.loadTile=function(R,N){var V=R.uid,K=R.encoding,W=R.rawImageData,se=ce&&W instanceof ce?this.getImageData(W):W,pe=new a.DEMData(V,se,K);this.loaded=this.loaded||{},this.loaded[V]=pe,N(null,pe)},ve.prototype.getImageData=function(R){this.offscreenCanvas&&this.offscreenCanvasContext||(this.offscreenCanvas=new OffscreenCanvas(R.width,R.height),this.offscreenCanvasContext=this.offscreenCanvas.getContext("2d")),this.offscreenCanvas.width=R.width,this.offscreenCanvas.height=R.height,this.offscreenCanvasContext.drawImage(R,0,0,R.width,R.height);var N=this.offscreenCanvasContext.getImageData(-1,-1,R.width+2,R.height+2);return this.offscreenCanvasContext.clearRect(0,0,this.offscreenCanvas.width,this.offscreenCanvas.height),new a.RGBAImage({width:N.width,height:N.height},N.data)},ve.prototype.removeTile=function(R){var N=this.loaded,V=R.uid;N&&N[V]&&delete N[V]};var Ke=a.vectorTile.VectorTileFeature.prototype.toGeoJSON,ut=function(R){this._feature=R,this.extent=a.EXTENT,this.type=R.type,this.properties=R.tags,"id"in R&&!isNaN(R.id)&&(this.id=parseInt(R.id,10))};ut.prototype.loadGeometry=function(){if(this._feature.type===1){for(var R=[],N=0,V=this._feature.geometry;N<V.length;N+=1){var K=V[N];R.push([new a.Point$1(K[0],K[1])])}return R}for(var W=[],se=0,pe=this._feature.geometry;se<pe.length;se+=1){for(var q=[],ee=0,ye=pe[se];ee<ye.length;ee+=1){var Pe=ye[ee];q.push(new a.Point$1(Pe[0],Pe[1]))}W.push(q)}return W},ut.prototype.toGeoJSON=function(R,N,V){return Ke.call(this,R,N,V)};var Me=function(R){this.layers={_geojsonTileLayer:this},this.name="_geojsonTileLayer",this.extent=a.EXTENT,this.length=R.length,this._features=R};Me.prototype.feature=function(R){return new ut(this._features[R])};var Ye=a.vectorTile.VectorTileFeature,vt=Ue;function Ue(R,N){this.options=N||{},this.features=R,this.length=R.length}function ct(R,N){this.id=typeof R.id=="number"?R.id:void 0,this.type=R.type,this.rawGeometry=R.type===1?[R.geometry]:R.geometry,this.properties=R.tags,this.extent=N||4096}Ue.prototype.feature=function(R){return new ct(this.features[R],this.options.extent)},ct.prototype.loadGeometry=function(){var R=this.rawGeometry;this.geometry=[];for(var N=0;N<R.length;N++){for(var V=R[N],K=[],W=0;W<V.length;W++)K.push(new a.Point$1(V[W][0],V[W][1]));this.geometry.push(K)}return this.geometry},ct.prototype.bbox=function(){this.geometry||this.loadGeometry();for(var R=this.geometry,N=1/0,V=-1/0,K=1/0,W=-1/0,se=0;se<R.length;se++)for(var pe=R[se],q=0;q<pe.length;q++){var ee=pe[q];N=Math.min(N,ee.x),V=Math.max(V,ee.x),K=Math.min(K,ee.y),W=Math.max(W,ee.y)}return[N,K,V,W]},ct.prototype.toGeoJSON=Ye.prototype.toGeoJSON;var mt=Ft,Ze=vt;function Ft(R){var N=new a.pbf;return function(V,K){for(var W in V.layers)K.writeMessage(3,yt,V.layers[W])}(R,N),N.finish()}function yt(R,N){var V;N.writeVarintField(15,R.version||1),N.writeStringField(1,R.name||""),N.writeVarintField(5,R.extent||4096);var K={keys:[],values:[],keycache:{},valuecache:{}};for(V=0;V<R.length;V++)K.feature=R.feature(V),N.writeMessage(2,Ct,K);var W=K.keys;for(V=0;V<W.length;V++)N.writeStringField(3,W[V]);var se=K.values;for(V=0;V<se.length;V++)N.writeMessage(4,Nt,se[V])}function Ct(R,N){var V=R.feature;V.id!==void 0&&N.writeVarintField(1,V.id),N.writeMessage(2,Le,R),N.writeVarintField(3,V.type),N.writeMessage(4,Jt,V)}function Le(R,N){var V=R.feature,K=R.keys,W=R.values,se=R.keycache,pe=R.valuecache;for(var q in V.properties){var ee=se[q];ee===void 0&&(K.push(q),se[q]=ee=K.length-1),N.writeVarint(ee);var ye=V.properties[q],Pe=typeof ye;Pe!=="string"&&Pe!=="boolean"&&Pe!=="number"&&(ye=JSON.stringify(ye));var Fe=Pe+":"+ye,ze=pe[Fe];ze===void 0&&(W.push(ye),pe[Fe]=ze=W.length-1),N.writeVarint(ze)}}function Pt(R,N){return(N<<3)+(7&R)}function At(R){return R<<1^R>>31}function Jt(R,N){for(var V=R.loadGeometry(),K=R.type,W=0,se=0,pe=V.length,q=0;q<pe;q++){var ee=V[q],ye=1;K===1&&(ye=ee.length),N.writeVarint(Pt(1,ye));for(var Pe=K===3?ee.length-1:ee.length,Fe=0;Fe<Pe;Fe++){Fe===1&&K!==1&&N.writeVarint(Pt(2,Pe-1));var ze=ee[Fe].x-W,Re=ee[Fe].y-se;N.writeVarint(At(ze)),N.writeVarint(At(Re)),W+=ze,se+=Re}K===3&&N.writeVarint(Pt(7,1))}}function Nt(R,N){var V=typeof R;V==="string"?N.writeStringField(1,R):V==="boolean"?N.writeBooleanField(7,R):V==="number"&&(R%1!=0?N.writeDoubleField(3,R):R<0?N.writeSVarintField(6,R):N.writeVarintField(5,R))}function ht(R,N,V,K){De(R,V,K),De(N,2*V,2*K),De(N,2*V+1,2*K+1)}function De(R,N,V){var K=R[N];R[N]=R[V],R[V]=K}function Lt(R,N,V,K){var W=R-V,se=N-K;return W*W+se*se}mt.fromVectorTileJs=Ft,mt.fromGeojsonVt=function(R,N){N=N||{};var V={};for(var K in R)V[K]=new vt(R[K].features,N),V[K].name=K,V[K].version=N.version,V[K].extent=N.extent;return Ft({layers:V})},mt.GeoJSONWrapper=Ze;var Cr=function(R){return R[0]},_i=function(R){return R[1]},er=function(R,N,V,K,W){N===void 0&&(N=Cr),V===void 0&&(V=_i),K===void 0&&(K=64),W===void 0&&(W=Float64Array),this.nodeSize=K,this.points=R;for(var se=R.length<65536?Uint16Array:Uint32Array,pe=this.ids=new se(R.length),q=this.coords=new W(2*R.length),ee=0;ee<R.length;ee++)pe[ee]=ee,q[2*ee]=N(R[ee]),q[2*ee+1]=V(R[ee]);(function ye(Pe,Fe,ze,Re,st,it){if(!(st-Re<=ze)){var xe=Re+st>>1;(function tt(We,$e,Zt,rt,tr,br){for(;tr>rt;){if(tr-rt>600){var Ht=tr-rt+1,hr=Zt-rt+1,rr=Math.log(Ht),wi=.5*Math.exp(2*rr/3),mr=.5*Math.sqrt(rr*wi*(Ht-wi)/Ht)*(hr-Ht/2<0?-1:1);tt(We,$e,Zt,Math.max(rt,Math.floor(Zt-hr*wi/Ht+mr)),Math.min(tr,Math.floor(Zt+(Ht-hr)*wi/Ht+mr)),br)}var Fr=$e[2*Zt+br],vr=rt,Qt=tr;for(ht(We,$e,rt,Zt),$e[2*tr+br]>Fr&&ht(We,$e,rt,tr);vr<Qt;){for(ht(We,$e,vr,Qt),vr++,Qt--;$e[2*vr+br]<Fr;)vr++;for(;$e[2*Qt+br]>Fr;)Qt--}$e[2*rt+br]===Fr?ht(We,$e,rt,Qt):ht(We,$e,++Qt,tr),Qt<=Zt&&(rt=Qt+1),Zt<=Qt&&(tr=Qt-1)}})(Pe,Fe,xe,Re,st,it%2),ye(Pe,Fe,ze,Re,xe-1,it+1),ye(Pe,Fe,ze,xe+1,st,it+1)}})(pe,q,K,0,pe.length-1,0)};er.prototype.range=function(R,N,V,K){return function(W,se,pe,q,ee,ye,Pe){for(var Fe,ze,Re=[0,W.length-1,0],st=[];Re.length;){var it=Re.pop(),xe=Re.pop(),tt=Re.pop();if(xe-tt<=Pe)for(var We=tt;We<=xe;We++)ze=se[2*We+1],(Fe=se[2*We])>=pe&&Fe<=ee&&ze>=q&&ze<=ye&&st.push(W[We]);else{var $e=Math.floor((tt+xe)/2);ze=se[2*$e+1],(Fe=se[2*$e])>=pe&&Fe<=ee&&ze>=q&&ze<=ye&&st.push(W[$e]);var Zt=(it+1)%2;(it===0?pe<=Fe:q<=ze)&&(Re.push(tt),Re.push($e-1),Re.push(Zt)),(it===0?ee>=Fe:ye>=ze)&&(Re.push($e+1),Re.push(xe),Re.push(Zt))}}return st}(this.ids,this.coords,R,N,V,K,this.nodeSize)},er.prototype.within=function(R,N,V){return function(K,W,se,pe,q,ee){for(var ye=[0,K.length-1,0],Pe=[],Fe=q*q;ye.length;){var ze=ye.pop(),Re=ye.pop(),st=ye.pop();if(Re-st<=ee)for(var it=st;it<=Re;it++)Lt(W[2*it],W[2*it+1],se,pe)<=Fe&&Pe.push(K[it]);else{var xe=Math.floor((st+Re)/2),tt=W[2*xe],We=W[2*xe+1];Lt(tt,We,se,pe)<=Fe&&Pe.push(K[xe]);var $e=(ze+1)%2;(ze===0?se-q<=tt:pe-q<=We)&&(ye.push(st),ye.push(xe-1),ye.push($e)),(ze===0?se+q>=tt:pe+q>=We)&&(ye.push(xe+1),ye.push(Re),ye.push($e))}}return Pe}(this.ids,this.coords,R,N,V,this.nodeSize)};var Mr={minZoom:0,maxZoom:16,minPoints:2,radius:40,extent:512,nodeSize:64,log:!1,generateId:!1,reduce:null,map:function(R){return R}},Sr=function(R){this.options=yn(Object.create(Mr),R),this.trees=new Array(this.options.maxZoom+1)};function en(R,N,V,K,W){return{x:R,y:N,zoom:1/0,id:V,parentId:-1,numPoints:K,properties:W}}function Wt(R,N){var V=R.geometry.coordinates,K=V[1];return{x:tn(V[0]),y:jt(K),zoom:1/0,index:N,parentId:-1}}function ui(R){return{type:"Feature",id:R.id,properties:Hn(R),geometry:{type:"Point",coordinates:[(K=R.x,360*(K-.5)),(N=R.y,V=(180-360*N)*Math.PI/180,360*Math.atan(Math.exp(V))/Math.PI-90)]}};var N,V,K}function Hn(R){var N=R.numPoints,V=N>=1e4?Math.round(N/1e3)+"k":N>=1e3?Math.round(N/100)/10+"k":N;return yn(yn({},R.properties),{cluster:!0,cluster_id:R.id,point_count:N,point_count_abbreviated:V})}function tn(R){return R/360+.5}function jt(R){var N=Math.sin(R*Math.PI/180),V=.5-.25*Math.log((1+N)/(1-N))/Math.PI;return V<0?0:V>1?1:V}function yn(R,N){for(var V in N)R[V]=N[V];return R}function Qr(R){return R.x}function vi(R){return R.y}function Tn(R,N,V,K,W,se){var pe=W-V,q=se-K;if(pe!==0||q!==0){var ee=((R-V)*pe+(N-K)*q)/(pe*pe+q*q);ee>1?(V=W,K=se):ee>0&&(V+=pe*ee,K+=q*ee)}return(pe=R-V)*pe+(q=N-K)*q}function Er(R,N,V,K){var W={id:R===void 0?null:R,type:N,geometry:V,tags:K,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0};return function(se){var pe=se.geometry,q=se.type;if(q==="Point"||q==="MultiPoint"||q==="LineString")zi(se,pe);else if(q==="Polygon"||q==="MultiLineString")for(var ee=0;ee<pe.length;ee++)zi(se,pe[ee]);else if(q==="MultiPolygon")for(ee=0;ee<pe.length;ee++)for(var ye=0;ye<pe[ee].length;ye++)zi(se,pe[ee][ye])}(W),W}function zi(R,N){for(var V=0;V<N.length;V+=3)R.minX=Math.min(R.minX,N[V]),R.minY=Math.min(R.minY,N[V+1]),R.maxX=Math.max(R.maxX,N[V]),R.maxY=Math.max(R.maxY,N[V+1])}function ci(R,N,V,K){if(N.geometry){var W=N.geometry.coordinates,se=N.geometry.type,pe=Math.pow(V.tolerance/((1<<V.maxZoom)*V.extent),2),q=[],ee=N.id;if(V.promoteId?ee=N.properties[V.promoteId]:V.generateId&&(ee=K||0),se==="Point")hi(W,q);else if(se==="MultiPoint")for(var ye=0;ye<W.length;ye++)hi(W[ye],q);else if(se==="LineString")sn(W,q,pe,!1);else if(se==="MultiLineString"){if(V.lineMetrics){for(ye=0;ye<W.length;ye++)sn(W[ye],q=[],pe,!1),R.push(Er(ee,"LineString",q,N.properties));return}qr(W,q,pe,!1)}else if(se==="Polygon")qr(W,q,pe,!0);else{if(se!=="MultiPolygon"){if(se==="GeometryCollection"){for(ye=0;ye<N.geometry.geometries.length;ye++)ci(R,{id:ee,geometry:N.geometry.geometries[ye],properties:N.properties},V,K);return}throw new Error("Input data is not a valid GeoJSON object.")}for(ye=0;ye<W.length;ye++){var Pe=[];qr(W[ye],Pe,pe,!0),q.push(Pe)}}R.push(Er(ee,se,q,N.properties))}}function hi(R,N){N.push(pi(R[0])),N.push(fi(R[1])),N.push(0)}function sn(R,N,V,K){for(var W,se,pe=0,q=0;q<R.length;q++){var ee=pi(R[q][0]),ye=fi(R[q][1]);N.push(ee),N.push(ye),N.push(0),q>0&&(pe+=K?(W*ye-ee*se)/2:Math.sqrt(Math.pow(ee-W,2)+Math.pow(ye-se,2))),W=ee,se=ye}var Pe=N.length-3;N[2]=1,function Fe(ze,Re,st,it){for(var xe,tt=it,We=st-Re>>1,$e=st-Re,Zt=ze[Re],rt=ze[Re+1],tr=ze[st],br=ze[st+1],Ht=Re+3;Ht<st;Ht+=3){var hr=Tn(ze[Ht],ze[Ht+1],Zt,rt,tr,br);if(hr>tt)xe=Ht,tt=hr;else if(hr===tt){var rr=Math.abs(Ht-We);rr<$e&&(xe=Ht,$e=rr)}}tt>it&&(xe-Re>3&&Fe(ze,Re,xe,it),ze[xe+2]=tt,st-xe>3&&Fe(ze,xe,st,it))}(N,0,Pe,V),N[Pe+2]=1,N.size=Math.abs(pe),N.start=0,N.end=N.size}function qr(R,N,V,K){for(var W=0;W<R.length;W++){var se=[];sn(R[W],se,V,K),N.push(se)}}function pi(R){return R/360+.5}function fi(R){var N=Math.sin(R*Math.PI/180),V=.5-.25*Math.log((1+N)/(1-N))/Math.PI;return V<0?0:V>1?1:V}function bi(R,N,V,K,W,se,pe,q){if(K/=N,se>=(V/=N)&&pe<K)return R;if(pe<V||se>=K)return null;for(var ee=[],ye=0;ye<R.length;ye++){var Pe=R[ye],Fe=Pe.geometry,ze=Pe.type,Re=W===0?Pe.minX:Pe.minY,st=W===0?Pe.maxX:Pe.maxY;if(Re>=V&&st<K)ee.push(Pe);else if(!(st<V||Re>=K)){var it=[];if(ze==="Point"||ze==="MultiPoint")Bi(Fe,it,V,K,W);else if(ze==="LineString")Xn(Fe,it,V,K,W,!1,q.lineMetrics);else if(ze==="MultiLineString")ji(Fe,it,V,K,W,!1);else if(ze==="Polygon")ji(Fe,it,V,K,W,!0);else if(ze==="MultiPolygon")for(var xe=0;xe<Fe.length;xe++){var tt=[];ji(Fe[xe],tt,V,K,W,!0),tt.length&&it.push(tt)}if(it.length){if(q.lineMetrics&&ze==="LineString"){for(xe=0;xe<it.length;xe++)ee.push(Er(Pe.id,ze,it[xe],Pe.tags));continue}ze!=="LineString"&&ze!=="MultiLineString"||(it.length===1?(ze="LineString",it=it[0]):ze="MultiLineString"),ze!=="Point"&&ze!=="MultiPoint"||(ze=it.length===3?"Point":"MultiPoint"),ee.push(Er(Pe.id,ze,it,Pe.tags))}}}return ee.length?ee:null}function Bi(R,N,V,K,W){for(var se=0;se<R.length;se+=3){var pe=R[se+W];pe>=V&&pe<=K&&(N.push(R[se]),N.push(R[se+1]),N.push(R[se+2]))}}function Xn(R,N,V,K,W,se,pe){for(var q,ee,ye=qi(R),Pe=W===0?ta:gn,Fe=R.start,ze=0;ze<R.length-3;ze+=3){var Re=R[ze],st=R[ze+1],it=R[ze+2],xe=R[ze+3],tt=R[ze+4],We=W===0?Re:st,$e=W===0?xe:tt,Zt=!1;pe&&(q=Math.sqrt(Math.pow(Re-xe,2)+Math.pow(st-tt,2))),We<V?$e>V&&(ee=Pe(ye,Re,st,xe,tt,V),pe&&(ye.start=Fe+q*ee)):We>K?$e<K&&(ee=Pe(ye,Re,st,xe,tt,K),pe&&(ye.start=Fe+q*ee)):jr(ye,Re,st,it),$e<V&&We>=V&&(ee=Pe(ye,Re,st,xe,tt,V),Zt=!0),$e>K&&We<=K&&(ee=Pe(ye,Re,st,xe,tt,K),Zt=!0),!se&&Zt&&(pe&&(ye.end=Fe+q*ee),N.push(ye),ye=qi(R)),pe&&(Fe+=q)}var rt=R.length-3;Re=R[rt],st=R[rt+1],it=R[rt+2],(We=W===0?Re:st)>=V&&We<=K&&jr(ye,Re,st,it),rt=ye.length-3,se&&rt>=3&&(ye[rt]!==ye[0]||ye[rt+1]!==ye[1])&&jr(ye,ye[0],ye[1],ye[2]),ye.length&&N.push(ye)}function qi(R){var N=[];return N.size=R.size,N.start=R.start,N.end=R.end,N}function ji(R,N,V,K,W,se){for(var pe=0;pe<R.length;pe++)Xn(R[pe],N,V,K,W,se,!1)}function jr(R,N,V,K){R.push(N),R.push(V),R.push(K)}function ta(R,N,V,K,W,se){var pe=(se-N)/(K-N);return R.push(se),R.push(V+(W-V)*pe),R.push(1),pe}function gn(R,N,V,K,W,se){var pe=(se-V)/(W-V);return R.push(N+(K-N)*pe),R.push(se),R.push(1),pe}function xi(R,N){for(var V=[],K=0;K<R.length;K++){var W,se=R[K],pe=se.type;if(pe==="Point"||pe==="MultiPoint"||pe==="LineString")W=Mn(se.geometry,N);else if(pe==="MultiLineString"||pe==="Polygon"){W=[];for(var q=0;q<se.geometry.length;q++)W.push(Mn(se.geometry[q],N))}else if(pe==="MultiPolygon")for(W=[],q=0;q<se.geometry.length;q++){for(var ee=[],ye=0;ye<se.geometry[q].length;ye++)ee.push(Mn(se.geometry[q][ye],N));W.push(ee)}V.push(Er(se.id,pe,W,se.tags))}return V}function Mn(R,N){var V=[];V.size=R.size,R.start!==void 0&&(V.start=R.start,V.end=R.end);for(var K=0;K<R.length;K+=3)V.push(R[K]+N,R[K+1],R[K+2]);return V}function Wn(R,N){if(R.transformed)return R;var V,K,W,se=1<<R.z,pe=R.x,q=R.y;for(V=0;V<R.features.length;V++){var ee=R.features[V],ye=ee.geometry,Pe=ee.type;if(ee.geometry=[],Pe===1)for(K=0;K<ye.length;K+=2)ee.geometry.push(Hr(ye[K],ye[K+1],N,se,pe,q));else for(K=0;K<ye.length;K++){var Fe=[];for(W=0;W<ye[K].length;W+=2)Fe.push(Hr(ye[K][W],ye[K][W+1],N,se,pe,q));ee.geometry.push(Fe)}}return R.transformed=!0,R}function Hr(R,N,V,K,W,se){return[Math.round(V*(R*K-W)),Math.round(V*(N*K-se))]}function ra(R,N,V,K,W){for(var se=N===W.maxZoom?0:W.tolerance/((1<<N)*W.extent),pe={features:[],numPoints:0,numSimplified:0,numFeatures:0,source:null,x:V,y:K,z:N,transformed:!1,minX:2,minY:1,maxX:-1,maxY:0},q=0;q<R.length;q++){pe.numFeatures++,Dn(pe,R[q],se,W);var ee=R[q].minX,ye=R[q].minY,Pe=R[q].maxX,Fe=R[q].maxY;ee<pe.minX&&(pe.minX=ee),ye<pe.minY&&(pe.minY=ye),Pe>pe.maxX&&(pe.maxX=Pe),Fe>pe.maxY&&(pe.maxY=Fe)}return pe}function Dn(R,N,V,K){var W=N.geometry,se=N.type,pe=[];if(se==="Point"||se==="MultiPoint")for(var q=0;q<W.length;q+=3)pe.push(W[q]),pe.push(W[q+1]),R.numPoints++,R.numSimplified++;else if(se==="LineString")ti(pe,W,R,V,!1,!1);else if(se==="MultiLineString"||se==="Polygon")for(q=0;q<W.length;q++)ti(pe,W[q],R,V,se==="Polygon",q===0);else if(se==="MultiPolygon")for(var ee=0;ee<W.length;ee++){var ye=W[ee];for(q=0;q<ye.length;q++)ti(pe,ye[q],R,V,!0,q===0)}if(pe.length){var Pe=N.tags||null;if(se==="LineString"&&K.lineMetrics){for(var Fe in Pe={},N.tags)Pe[Fe]=N.tags[Fe];Pe.mapbox_clip_start=W.start/W.size,Pe.mapbox_clip_end=W.end/W.size}var ze={geometry:pe,type:se==="Polygon"||se==="MultiPolygon"?3:se==="LineString"||se==="MultiLineString"?2:1,tags:Pe};N.id!==null&&(ze.id=N.id),R.features.push(ze)}}function ti(R,N,V,K,W,se){var pe=K*K;if(K>0&&N.size<(W?pe:K))V.numPoints+=N.length/3;else{for(var q=[],ee=0;ee<N.length;ee+=3)(K===0||N[ee+2]>pe)&&(V.numSimplified++,q.push(N[ee]),q.push(N[ee+1])),V.numPoints++;W&&function(ye,Pe){for(var Fe=0,ze=0,Re=ye.length,st=Re-2;ze<Re;st=ze,ze+=2)Fe+=(ye[ze]-ye[st])*(ye[ze+1]+ye[st+1]);if(Fe>0===Pe)for(ze=0,Re=ye.length;ze<Re/2;ze+=2){var it=ye[ze],xe=ye[ze+1];ye[ze]=ye[Re-2-ze],ye[ze+1]=ye[Re-1-ze],ye[Re-2-ze]=it,ye[Re-1-ze]=xe}}(q,se),R.push(q)}}function re(R,N){var V=(N=this.options=function(W,se){for(var pe in se)W[pe]=se[pe];return W}(Object.create(this.options),N)).debug;if(V&&console.time("preprocess data"),N.maxZoom<0||N.maxZoom>24)throw new Error("maxZoom should be in the 0-24 range");if(N.promoteId&&N.generateId)throw new Error("promoteId and generateId cannot be used together.");var K=function(W,se){var pe=[];if(W.type==="FeatureCollection")for(var q=0;q<W.features.length;q++)ci(pe,W.features[q],se,q);else ci(pe,W.type==="Feature"?W:{geometry:W},se);return pe}(R,N);this.tiles={},this.tileCoords=[],V&&(console.timeEnd("preprocess data"),console.log("index: maxZoom: %d, maxPoints: %d",N.indexMaxZoom,N.indexMaxPoints),console.time("generate tiles"),this.stats={},this.total=0),(K=function(W,se){var pe=se.buffer/se.extent,q=W,ee=bi(W,1,-1-pe,pe,0,-1,2,se),ye=bi(W,1,1-pe,2+pe,0,-1,2,se);return(ee||ye)&&(q=bi(W,1,-pe,1+pe,0,-1,2,se)||[],ee&&(q=xi(ee,1).concat(q)),ye&&(q=q.concat(xi(ye,-1)))),q}(K,N)).length&&this.splitTile(K,0,0,0),V&&(K.length&&console.log("features: %d, points: %d",this.tiles[0].numFeatures,this.tiles[0].numPoints),console.timeEnd("generate tiles"),console.log("tiles generated:",this.total,JSON.stringify(this.stats)))}function dt(R,N,V){return 32*((1<<R)*V+N)+R}function Zi(R,N){var V=R.tileID.canonical;if(!this._geoJSONIndex)return N(null,null);var K=this._geoJSONIndex.getTile(V.z,V.x,V.y);if(!K)return N(null,null);var W=new Me(K.features),se=mt(W);se.byteOffset===0&&se.byteLength===se.buffer.byteLength||(se=new Uint8Array(se)),N(null,{vectorTile:W,rawData:se.buffer})}Sr.prototype.load=function(R){var N=this.options,V=N.log,K=N.minZoom,W=N.maxZoom,se=N.nodeSize;V&&console.time("total time");var pe="prepare "+R.length+" points";V&&console.time(pe),this.points=R;for(var q=[],ee=0;ee<R.length;ee++)R[ee].geometry&&q.push(Wt(R[ee],ee));this.trees[W+1]=new er(q,Qr,vi,se,Float32Array),V&&console.timeEnd(pe);for(var ye=W;ye>=K;ye--){var Pe=+Date.now();q=this._cluster(q,ye),this.trees[ye]=new er(q,Qr,vi,se,Float32Array),V&&console.log("z%d: %d clusters in %dms",ye,q.length,+Date.now()-Pe)}return V&&console.timeEnd("total time"),this},Sr.prototype.getClusters=function(R,N){var V=((R[0]+180)%360+360)%360-180,K=Math.max(-90,Math.min(90,R[1])),W=R[2]===180?180:((R[2]+180)%360+360)%360-180,se=Math.max(-90,Math.min(90,R[3]));if(R[2]-R[0]>=360)V=-180,W=180;else if(V>W){var pe=this.getClusters([V,K,180,se],N),q=this.getClusters([-180,K,W,se],N);return pe.concat(q)}for(var ee=this.trees[this._limitZoom(N)],ye=[],Pe=0,Fe=ee.range(tn(V),jt(se),tn(W),jt(K));Pe<Fe.length;Pe+=1){var ze=ee.points[Fe[Pe]];ye.push(ze.numPoints?ui(ze):this.points[ze.index])}return ye},Sr.prototype.getChildren=function(R){var N=this._getOriginId(R),V=this._getOriginZoom(R),K="No cluster with the specified id.",W=this.trees[V];if(!W)throw new Error(K);var se=W.points[N];if(!se)throw new Error(K);for(var pe=this.options.radius/(this.options.extent*Math.pow(2,V-1)),q=[],ee=0,ye=W.within(se.x,se.y,pe);ee<ye.length;ee+=1){var Pe=W.points[ye[ee]];Pe.parentId===R&&q.push(Pe.numPoints?ui(Pe):this.points[Pe.index])}if(q.length===0)throw new Error(K);return q},Sr.prototype.getLeaves=function(R,N,V){var K=[];return this._appendLeaves(K,R,N=N||10,V=V||0,0),K},Sr.prototype.getTile=function(R,N,V){var K=this.trees[this._limitZoom(R)],W=Math.pow(2,R),se=this.options,pe=se.radius/se.extent,q=(V-pe)/W,ee=(V+1+pe)/W,ye={features:[]};return this._addTileFeatures(K.range((N-pe)/W,q,(N+1+pe)/W,ee),K.points,N,V,W,ye),N===0&&this._addTileFeatures(K.range(1-pe/W,q,1,ee),K.points,W,V,W,ye),N===W-1&&this._addTileFeatures(K.range(0,q,pe/W,ee),K.points,-1,V,W,ye),ye.features.length?ye:null},Sr.prototype.getClusterExpansionZoom=function(R){for(var N=this._getOriginZoom(R)-1;N<=this.options.maxZoom;){var V=this.getChildren(R);if(N++,V.length!==1)break;R=V[0].properties.cluster_id}return N},Sr.prototype._appendLeaves=function(R,N,V,K,W){for(var se=0,pe=this.getChildren(N);se<pe.length;se+=1){var q=pe[se],ee=q.properties;if(ee&&ee.cluster?W+ee.point_count<=K?W+=ee.point_count:W=this._appendLeaves(R,ee.cluster_id,V,K,W):W<K?W++:R.push(q),R.length===V)break}return W},Sr.prototype._addTileFeatures=function(R,N,V,K,W,se){for(var pe=0,q=R;pe<q.length;pe+=1){var ee=N[q[pe]],ye=ee.numPoints,Pe={type:1,geometry:[[Math.round(this.options.extent*(ee.x*W-V)),Math.round(this.options.extent*(ee.y*W-K))]],tags:ye?Hn(ee):this.points[ee.index].properties},Fe=void 0;ye?Fe=ee.id:this.options.generateId?Fe=ee.index:this.points[ee.index].id&&(Fe=this.points[ee.index].id),Fe!==void 0&&(Pe.id=Fe),se.features.push(Pe)}},Sr.prototype._limitZoom=function(R){return Math.max(this.options.minZoom,Math.min(+R,this.options.maxZoom+1))},Sr.prototype._cluster=function(R,N){for(var V=[],K=this.options,W=K.reduce,se=K.minPoints,pe=K.radius/(K.extent*Math.pow(2,N)),q=0;q<R.length;q++){var ee=R[q];if(!(ee.zoom<=N)){ee.zoom=N;for(var ye=this.trees[N+1],Pe=ye.within(ee.x,ee.y,pe),Fe=ee.numPoints||1,ze=Fe,Re=0,st=Pe;Re<st.length;Re+=1){var it=ye.points[st[Re]];it.zoom>N&&(ze+=it.numPoints||1)}if(ze>=se){for(var xe=ee.x*Fe,tt=ee.y*Fe,We=W&&Fe>1?this._map(ee,!0):null,$e=(q<<5)+(N+1)+this.points.length,Zt=0,rt=Pe;Zt<rt.length;Zt+=1){var tr=ye.points[rt[Zt]];if(!(tr.zoom<=N)){tr.zoom=N;var br=tr.numPoints||1;xe+=tr.x*br,tt+=tr.y*br,tr.parentId=$e,W&&(We||(We=this._map(ee,!0)),W(We,this._map(tr)))}}ee.parentId=$e,V.push(en(xe/ze,tt/ze,$e,ze,We))}else if(V.push(ee),ze>1)for(var Ht=0,hr=Pe;Ht<hr.length;Ht+=1){var rr=ye.points[hr[Ht]];rr.zoom<=N||(rr.zoom=N,V.push(rr))}}}return V},Sr.prototype._getOriginId=function(R){return R-this.points.length>>5},Sr.prototype._getOriginZoom=function(R){return(R-this.points.length)%32},Sr.prototype._map=function(R,N){if(R.numPoints)return N?yn({},R.properties):R.properties;var V=this.points[R.index].properties,K=this.options.map(V);return N&&K===V?yn({},K):K},re.prototype.options={maxZoom:14,indexMaxZoom:5,indexMaxPoints:1e5,tolerance:3,extent:4096,buffer:64,lineMetrics:!1,promoteId:null,generateId:!1,debug:0},re.prototype.splitTile=function(R,N,V,K,W,se,pe){for(var q=[R,N,V,K],ee=this.options,ye=ee.debug;q.length;){K=q.pop(),V=q.pop(),N=q.pop(),R=q.pop();var Pe=1<<N,Fe=dt(N,V,K),ze=this.tiles[Fe];if(!ze&&(ye>1&&console.time("creation"),ze=this.tiles[Fe]=ra(R,N,V,K,ee),this.tileCoords.push({z:N,x:V,y:K}),ye)){ye>1&&(console.log("tile z%d-%d-%d (features: %d, points: %d, simplified: %d)",N,V,K,ze.numFeatures,ze.numPoints,ze.numSimplified),console.timeEnd("creation"));var Re="z"+N;this.stats[Re]=(this.stats[Re]||0)+1,this.total++}if(ze.source=R,W){if(N===ee.maxZoom||N===W)continue;var st=1<<W-N;if(V!==Math.floor(se/st)||K!==Math.floor(pe/st))continue}else if(N===ee.indexMaxZoom||ze.numPoints<=ee.indexMaxPoints)continue;if(ze.source=null,R.length!==0){ye>1&&console.time("clipping");var it,xe,tt,We,$e,Zt,rt=.5*ee.buffer/ee.extent,tr=.5-rt,br=.5+rt,Ht=1+rt;it=xe=tt=We=null,$e=bi(R,Pe,V-rt,V+br,0,ze.minX,ze.maxX,ee),Zt=bi(R,Pe,V+tr,V+Ht,0,ze.minX,ze.maxX,ee),R=null,$e&&(it=bi($e,Pe,K-rt,K+br,1,ze.minY,ze.maxY,ee),xe=bi($e,Pe,K+tr,K+Ht,1,ze.minY,ze.maxY,ee),$e=null),Zt&&(tt=bi(Zt,Pe,K-rt,K+br,1,ze.minY,ze.maxY,ee),We=bi(Zt,Pe,K+tr,K+Ht,1,ze.minY,ze.maxY,ee),Zt=null),ye>1&&console.timeEnd("clipping"),q.push(it||[],N+1,2*V,2*K),q.push(xe||[],N+1,2*V,2*K+1),q.push(tt||[],N+1,2*V+1,2*K),q.push(We||[],N+1,2*V+1,2*K+1)}}},re.prototype.getTile=function(R,N,V){var K=this.options,W=K.extent,se=K.debug;if(R<0||R>24)return null;var pe=1<<R,q=dt(R,N=(N%pe+pe)%pe,V);if(this.tiles[q])return Wn(this.tiles[q],W);se>1&&console.log("drilling down to z%d-%d-%d",R,N,V);for(var ee,ye=R,Pe=N,Fe=V;!ee&&ye>0;)ye--,Pe=Math.floor(Pe/2),Fe=Math.floor(Fe/2),ee=this.tiles[dt(ye,Pe,Fe)];return ee&&ee.source?(se>1&&console.log("found parent tile z%d-%d-%d",ye,Pe,Fe),se>1&&console.time("drilling down"),this.splitTile(ee.source,ye,Pe,Fe,R,N,V),se>1&&console.timeEnd("drilling down"),this.tiles[q]?Wn(this.tiles[q],W):null):null};var ri=function(R){function N(V,K,W,se){R.call(this,V,K,W,Zi),se&&(this.loadGeoJSON=se)}return R&&(N.__proto__=R),(N.prototype=Object.create(R&&R.prototype)).constructor=N,N.prototype.loadData=function(V,K){this._pendingCallback&&this._pendingCallback(null,{abandoned:!0}),this._pendingCallback=K,this._pendingLoadDataParams=V,this._state&&this._state!=="Idle"?this._state="NeedsLoadData":(this._state="Coalescing",this._loadData())},N.prototype._loadData=function(){var V=this;if(this._pendingCallback&&this._pendingLoadDataParams){var K=this._pendingCallback,W=this._pendingLoadDataParams;delete this._pendingCallback,delete this._pendingLoadDataParams;var se=!!(W&&W.request&&W.request.collectResourceTiming)&&new a.RequestPerformance(W.request);this.loadGeoJSON(W,function(pe,q){if(pe||!q)return K(pe);if(typeof q!="object")return K(new Error("Input data given to '"+W.source+"' is not a valid GeoJSON object."));(function ze(Re,st){var it,xe=Re&&Re.type;if(xe==="FeatureCollection")for(it=0;it<Re.features.length;it++)ze(Re.features[it],st);else if(xe==="GeometryCollection")for(it=0;it<Re.geometries.length;it++)ze(Re.geometries[it],st);else if(xe==="Feature")ze(Re.geometry,st);else if(xe==="Polygon")de(Re.coordinates,st);else if(xe==="MultiPolygon")for(it=0;it<Re.coordinates.length;it++)de(Re.coordinates[it],st);return Re})(q,!0);try{if(W.filter){var ee=a.createExpression(W.filter,{type:"boolean","property-type":"data-driven",overridable:!1,transition:!1});if(ee.result==="error")throw new Error(ee.value.map(function(ze){return ze.key+": "+ze.message}).join(", "));var ye=q.features.filter(function(ze){return ee.value.evaluate({zoom:0},ze)});q={type:"FeatureCollection",features:ye}}V._geoJSONIndex=W.cluster?new Sr(function(ze){var Re=ze.superclusterOptions,st=ze.clusterProperties;if(!st||!Re)return Re;for(var it={},xe={},tt={accumulated:null,zoom:0},We={properties:null},$e=Object.keys(st),Zt=0,rt=$e;Zt<rt.length;Zt+=1){var tr=rt[Zt],br=st[tr],Ht=br[0],hr=a.createExpression(br[1]),rr=a.createExpression(typeof Ht=="string"?[Ht,["accumulated"],["get",tr]]:Ht);it[tr]=hr.value,xe[tr]=rr.value}return Re.map=function(wi){We.properties=wi;for(var mr={},Fr=0,vr=$e;Fr<vr.length;Fr+=1){var Qt=vr[Fr];mr[Qt]=it[Qt].evaluate(tt,We)}return mr},Re.reduce=function(wi,mr){We.properties=mr;for(var Fr=0,vr=$e;Fr<vr.length;Fr+=1){var Qt=vr[Fr];tt.accumulated=wi[Qt],wi[Qt]=xe[Qt].evaluate(tt,We)}},Re}(W)).load(q.features):function(ze,Re){return new re(ze,Re)}(q,W.geojsonVtOptions)}catch(ze){return K(ze)}V.loaded={};var Pe={};if(se){var Fe=se.finish();Fe&&(Pe.resourceTiming={},Pe.resourceTiming[W.source]=JSON.parse(JSON.stringify(Fe)))}K(null,Pe)})}},N.prototype.coalesce=function(){this._state==="Coalescing"?this._state="Idle":this._state==="NeedsLoadData"&&(this._state="Coalescing",this._loadData())},N.prototype.reloadTile=function(V,K){var W=this.loaded;return W&&W[V.uid]?R.prototype.reloadTile.call(this,V,K):this.loadTile(V,K)},N.prototype.loadGeoJSON=function(V,K){if(V.request)a.getJSON(V.request,K);else{if(typeof V.data!="string")return K(new Error("Input data given to '"+V.source+"' is not a valid GeoJSON object."));try{return K(null,JSON.parse(V.data))}catch{return K(new Error("Input data given to '"+V.source+"' is not a valid GeoJSON object."))}}},N.prototype.removeSource=function(V,K){this._pendingCallback&&this._pendingCallback(null,{abandoned:!0}),K()},N.prototype.getClusterExpansionZoom=function(V,K){try{K(null,this._geoJSONIndex.getClusterExpansionZoom(V.clusterId))}catch(W){K(W)}},N.prototype.getClusterChildren=function(V,K){try{K(null,this._geoJSONIndex.getChildren(V.clusterId))}catch(W){K(W)}},N.prototype.getClusterLeaves=function(V,K){try{K(null,this._geoJSONIndex.getLeaves(V.clusterId,V.limit,V.offset))}catch(W){K(W)}},N}(ne),dr=function(R){var N=this;this.self=R,this.actor=new a.Actor(R,this),this.layerIndexes={},this.availableImages={},this.workerSourceTypes={vector:ne,geojson:ri},this.workerSources={},this.demWorkerSources={},this.self.registerWorkerSource=function(V,K){if(N.workerSourceTypes[V])throw new Error('Worker source with name "'+V+'" already registered.');N.workerSourceTypes[V]=K},this.self.registerRTLTextPlugin=function(V){if(a.plugin.isParsed())throw new Error("RTL text plugin already registered.");a.plugin.applyArabicShaping=V.applyArabicShaping,a.plugin.processBidirectionalText=V.processBidirectionalText,a.plugin.processStyledBidirectionalText=V.processStyledBidirectionalText}};return dr.prototype.setReferrer=function(R,N){this.referrer=N},dr.prototype.setImages=function(R,N,V){for(var K in this.availableImages[R]=N,this.workerSources[R]){var W=this.workerSources[R][K];for(var se in W)W[se].availableImages=N}V()},dr.prototype.setLayers=function(R,N,V){this.getLayerIndex(R).replace(N),V()},dr.prototype.updateLayers=function(R,N,V){this.getLayerIndex(R).update(N.layers,N.removedIds),V()},dr.prototype.loadTile=function(R,N,V){this.getWorkerSource(R,N.type,N.source).loadTile(N,V)},dr.prototype.loadDEMTile=function(R,N,V){this.getDEMWorkerSource(R,N.source).loadTile(N,V)},dr.prototype.reloadTile=function(R,N,V){this.getWorkerSource(R,N.type,N.source).reloadTile(N,V)},dr.prototype.abortTile=function(R,N,V){this.getWorkerSource(R,N.type,N.source).abortTile(N,V)},dr.prototype.removeTile=function(R,N,V){this.getWorkerSource(R,N.type,N.source).removeTile(N,V)},dr.prototype.removeDEMTile=function(R,N){this.getDEMWorkerSource(R,N.source).removeTile(N)},dr.prototype.removeSource=function(R,N,V){if(this.workerSources[R]&&this.workerSources[R][N.type]&&this.workerSources[R][N.type][N.source]){var K=this.workerSources[R][N.type][N.source];delete this.workerSources[R][N.type][N.source],K.removeSource!==void 0?K.removeSource(N,V):V()}},dr.prototype.loadWorkerSource=function(R,N,V){try{this.self.importScripts(N.url),V()}catch(K){V(K.toString())}},dr.prototype.syncRTLPluginState=function(R,N,V){try{a.plugin.setState(N);var K=a.plugin.getPluginURL();if(a.plugin.isLoaded()&&!a.plugin.isParsed()&&K!=null){this.self.importScripts(K);var W=a.plugin.isParsed();V(W?void 0:new Error("RTL Text Plugin failed to import scripts from "+K),W)}}catch(se){V(se.toString())}},dr.prototype.getAvailableImages=function(R){var N=this.availableImages[R];return N||(N=[]),N},dr.prototype.getLayerIndex=function(R){var N=this.layerIndexes[R];return N||(N=this.layerIndexes[R]=new M),N},dr.prototype.getWorkerSource=function(R,N,V){var K=this;return this.workerSources[R]||(this.workerSources[R]={}),this.workerSources[R][N]||(this.workerSources[R][N]={}),this.workerSources[R][N][V]||(this.workerSources[R][N][V]=new this.workerSourceTypes[N]({send:function(W,se,pe){K.actor.send(W,se,pe,R)}},this.getLayerIndex(R),this.getAvailableImages(R))),this.workerSources[R][N][V]},dr.prototype.getDEMWorkerSource=function(R,N){return this.demWorkerSources[R]||(this.demWorkerSources[R]={}),this.demWorkerSources[R][N]||(this.demWorkerSources[R][N]=new ve),this.demWorkerSources[R][N]},dr.prototype.enforceCacheSizeLimit=function(R,N){a.enforceCacheSizeLimit(N)},typeof WorkerGlobalScope<"u"&&typeof self<"u"&&self instanceof WorkerGlobalScope&&(self.worker=new dr(self)),dr}),v(["./shared"],function(a){var T=a.createCommonjsModule(function(n){function s(_){return!o(_)}function o(_){return typeof window>"u"||typeof document>"u"?"not a browser":Array.prototype&&Array.prototype.every&&Array.prototype.filter&&Array.prototype.forEach&&Array.prototype.indexOf&&Array.prototype.lastIndexOf&&Array.prototype.map&&Array.prototype.some&&Array.prototype.reduce&&Array.prototype.reduceRight&&Array.isArray?Function.prototype&&Function.prototype.bind?Object.keys&&Object.create&&Object.getPrototypeOf&&Object.getOwnPropertyNames&&Object.isSealed&&Object.isFrozen&&Object.isExtensible&&Object.getOwnPropertyDescriptor&&Object.defineProperty&&Object.defineProperties&&Object.seal&&Object.freeze&&Object.preventExtensions?"JSON"in window&&"parse"in JSON&&"stringify"in JSON?function(){if(!("Worker"in window&&"Blob"in window&&"URL"in window))return!1;var S,E,P=new Blob([""],{type:"text/javascript"}),O=URL.createObjectURL(P);try{E=new Worker(O),S=!0}catch{S=!1}return E&&E.terminate(),URL.revokeObjectURL(O),S}()?"Uint8ClampedArray"in window?ArrayBuffer.isView?function(){var S=document.createElement("canvas");S.width=S.height=1;var E=S.getContext("2d");if(!E)return!1;var P=E.getImageData(0,0,1,1);return P&&P.width===S.width}()?(c[w=_&&_.failIfMajorPerformanceCaveat]===void 0&&(c[w]=function(S){var E=function(O){var Z=document.createElement("canvas"),G=Object.create(s.webGLContextAttributes);return G.failIfMajorPerformanceCaveat=O,Z.probablySupportsContext?Z.probablySupportsContext("webgl",G)||Z.probablySupportsContext("experimental-webgl",G):Z.supportsContext?Z.supportsContext("webgl",G)||Z.supportsContext("experimental-webgl",G):Z.getContext("webgl",G)||Z.getContext("experimental-webgl",G)}(S);if(!E)return!1;var P=E.createShader(E.VERTEX_SHADER);return!(!P||E.isContextLost())&&(E.shaderSource(P,"void main() {}"),E.compileShader(P),E.getShaderParameter(P,E.COMPILE_STATUS)===!0)}(w)),c[w]?void 0:"insufficient WebGL support"):"insufficient Canvas/getImageData support":"insufficient ArrayBuffer support":"insufficient Uint8ClampedArray support":"insufficient worker support":"insufficient JSON support":"insufficient Object support":"insufficient Function support":"insufficent Array support";var w}n.exports?n.exports=s:window&&(window.mapboxgl=window.mapboxgl||{},window.mapboxgl.supported=s,window.mapboxgl.notSupportedReason=o);var c={};s.webGLContextAttributes={antialias:!1,alpha:!0,stencil:!0,depth:!0}}),z={create:function(n,s,o){var c=a.window.document.createElement(n);return s!==void 0&&(c.className=s),o&&o.appendChild(c),c},createNS:function(n,s){return a.window.document.createElementNS(n,s)}},M=a.window.document&&a.window.document.documentElement.style;function F(n){if(!M)return n[0];for(var s=0;s<n.length;s++)if(n[s]in M)return n[s];return n[0]}var D,L=F(["userSelect","MozUserSelect","WebkitUserSelect","msUserSelect"]);z.disableDrag=function(){M&&L&&(D=M[L],M[L]="none")},z.enableDrag=function(){M&&L&&(M[L]=D)};var X=F(["transform","WebkitTransform"]);z.setTransform=function(n,s){n.style[X]=s};var ne=!1;try{var ce=Object.defineProperty({},"passive",{get:function(){ne=!0}});a.window.addEventListener("test",ce,ce),a.window.removeEventListener("test",ce,ce)}catch{ne=!1}z.addEventListener=function(n,s,o,c){c===void 0&&(c={}),n.addEventListener(s,o,"passive"in c&&ne?c:c.capture)},z.removeEventListener=function(n,s,o,c){c===void 0&&(c={}),n.removeEventListener(s,o,"passive"in c&&ne?c:c.capture)};var ve=function(n){n.preventDefault(),n.stopPropagation(),a.window.removeEventListener("click",ve,!0)};function de(n){var s=n.userImage;return!!(s&&s.render&&s.render())&&(n.data.replace(new Uint8Array(s.data.buffer)),!0)}z.suppressClick=function(){a.window.addEventListener("click",ve,!0),a.window.setTimeout(function(){a.window.removeEventListener("click",ve,!0)},0)},z.mousePos=function(n,s){var o=n.getBoundingClientRect();return new a.Point(s.clientX-o.left-n.clientLeft,s.clientY-o.top-n.clientTop)},z.touchPos=function(n,s){for(var o=n.getBoundingClientRect(),c=[],_=0;_<s.length;_++)c.push(new a.Point(s[_].clientX-o.left-n.clientLeft,s[_].clientY-o.top-n.clientTop));return c},z.mouseButton=function(n){return a.window.InstallTrigger!==void 0&&n.button===2&&n.ctrlKey&&a.window.navigator.platform.toUpperCase().indexOf("MAC")>=0?0:n.button},z.remove=function(n){n.parentNode&&n.parentNode.removeChild(n)};var we=function(n){function s(){n.call(this),this.images={},this.updatedImages={},this.callbackDispatchedThisFrame={},this.loaded=!1,this.requestors=[],this.patterns={},this.atlasImage=new a.RGBAImage({width:1,height:1}),this.dirty=!0}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype.isLoaded=function(){return this.loaded},s.prototype.setLoaded=function(o){if(this.loaded!==o&&(this.loaded=o,o)){for(var c=0,_=this.requestors;c<_.length;c+=1){var w=_[c];this._notify(w.ids,w.callback)}this.requestors=[]}},s.prototype.getImage=function(o){return this.images[o]},s.prototype.addImage=function(o,c){this._validate(o,c)&&(this.images[o]=c)},s.prototype._validate=function(o,c){var _=!0;return this._validateStretch(c.stretchX,c.data&&c.data.width)||(this.fire(new a.ErrorEvent(new Error('Image "'+o+'" has invalid "stretchX" value'))),_=!1),this._validateStretch(c.stretchY,c.data&&c.data.height)||(this.fire(new a.ErrorEvent(new Error('Image "'+o+'" has invalid "stretchY" value'))),_=!1),this._validateContent(c.content,c)||(this.fire(new a.ErrorEvent(new Error('Image "'+o+'" has invalid "content" value'))),_=!1),_},s.prototype._validateStretch=function(o,c){if(!o)return!0;for(var _=0,w=0,S=o;w<S.length;w+=1){var E=S[w];if(E[0]<_||E[1]<E[0]||c<E[1])return!1;_=E[1]}return!0},s.prototype._validateContent=function(o,c){return!(o&&(o.length!==4||o[0]<0||c.data.width<o[0]||o[1]<0||c.data.height<o[1]||o[2]<0||c.data.width<o[2]||o[3]<0||c.data.height<o[3]||o[2]<o[0]||o[3]<o[1]))},s.prototype.updateImage=function(o,c){c.version=this.images[o].version+1,this.images[o]=c,this.updatedImages[o]=!0},s.prototype.removeImage=function(o){var c=this.images[o];delete this.images[o],delete this.patterns[o],c.userImage&&c.userImage.onRemove&&c.userImage.onRemove()},s.prototype.listImages=function(){return Object.keys(this.images)},s.prototype.getImages=function(o,c){var _=!0;if(!this.isLoaded())for(var w=0,S=o;w<S.length;w+=1)this.images[S[w]]||(_=!1);this.isLoaded()||_?this._notify(o,c):this.requestors.push({ids:o,callback:c})},s.prototype._notify=function(o,c){for(var _={},w=0,S=o;w<S.length;w+=1){var E=S[w];this.images[E]||this.fire(new a.Event("styleimagemissing",{id:E}));var P=this.images[E];P?_[E]={data:P.data.clone(),pixelRatio:P.pixelRatio,sdf:P.sdf,version:P.version,stretchX:P.stretchX,stretchY:P.stretchY,content:P.content,hasRenderCallback:!!(P.userImage&&P.userImage.render)}:a.warnOnce('Image "'+E+'" could not be loaded. Please make sure you have added the image with map.addImage() or a "sprite" property in your style. You can provide missing images by listening for the "styleimagemissing" map event.')}c(null,_)},s.prototype.getPixelSize=function(){var o=this.atlasImage;return{width:o.width,height:o.height}},s.prototype.getPattern=function(o){var c=this.patterns[o],_=this.getImage(o);if(!_)return null;if(c&&c.position.version===_.version)return c.position;if(c)c.position.version=_.version;else{var w={w:_.data.width+2,h:_.data.height+2,x:0,y:0},S=new a.ImagePosition(w,_);this.patterns[o]={bin:w,position:S}}return this._updatePatternAtlas(),this.patterns[o].position},s.prototype.bind=function(o){var c=o.gl;this.atlasTexture?this.dirty&&(this.atlasTexture.update(this.atlasImage),this.dirty=!1):this.atlasTexture=new a.Texture(o,this.atlasImage,c.RGBA),this.atlasTexture.bind(c.LINEAR,c.CLAMP_TO_EDGE)},s.prototype._updatePatternAtlas=function(){var o=[];for(var c in this.patterns)o.push(this.patterns[c].bin);var _=a.potpack(o),w=_.w,S=_.h,E=this.atlasImage;for(var P in E.resize({width:w||1,height:S||1}),this.patterns){var O=this.patterns[P].bin,Z=O.x+1,G=O.y+1,H=this.images[P].data,te=H.width,$=H.height;a.RGBAImage.copy(H,E,{x:0,y:0},{x:Z,y:G},{width:te,height:$}),a.RGBAImage.copy(H,E,{x:0,y:$-1},{x:Z,y:G-1},{width:te,height:1}),a.RGBAImage.copy(H,E,{x:0,y:0},{x:Z,y:G+$},{width:te,height:1}),a.RGBAImage.copy(H,E,{x:te-1,y:0},{x:Z-1,y:G},{width:1,height:$}),a.RGBAImage.copy(H,E,{x:0,y:0},{x:Z+te,y:G},{width:1,height:$})}this.dirty=!0},s.prototype.beginFrame=function(){this.callbackDispatchedThisFrame={}},s.prototype.dispatchRenderCallbacks=function(o){for(var c=0,_=o;c<_.length;c+=1){var w=_[c];if(!this.callbackDispatchedThisFrame[w]){this.callbackDispatchedThisFrame[w]=!0;var S=this.images[w];de(S)&&this.updateImage(w,S)}}},s}(a.Evented),Ke=Ye,ut=Ye,Me=1e20;function Ye(n,s,o,c,_,w){this.fontSize=n||24,this.buffer=s===void 0?3:s,this.cutoff=c||.25,this.fontFamily=_||"sans-serif",this.fontWeight=w||"normal",this.radius=o||8;var S=this.size=this.fontSize+2*this.buffer;this.canvas=document.createElement("canvas"),this.canvas.width=this.canvas.height=S,this.ctx=this.canvas.getContext("2d"),this.ctx.font=this.fontWeight+" "+this.fontSize+"px "+this.fontFamily,this.ctx.textBaseline="middle",this.ctx.fillStyle="black",this.gridOuter=new Float64Array(S*S),this.gridInner=new Float64Array(S*S),this.f=new Float64Array(S),this.d=new Float64Array(S),this.z=new Float64Array(S+1),this.v=new Int16Array(S),this.middle=Math.round(S/2*(navigator.userAgent.indexOf("Gecko/")>=0?1.2:1))}function vt(n,s,o,c,_,w,S){for(var E=0;E<s;E++){for(var P=0;P<o;P++)c[P]=n[P*s+E];for(Ue(c,_,w,S,o),P=0;P<o;P++)n[P*s+E]=_[P]}for(P=0;P<o;P++){for(E=0;E<s;E++)c[E]=n[P*s+E];for(Ue(c,_,w,S,s),E=0;E<s;E++)n[P*s+E]=Math.sqrt(_[E])}}function Ue(n,s,o,c,_){o[0]=0,c[0]=-Me,c[1]=+Me;for(var w=1,S=0;w<_;w++){for(var E=(n[w]+w*w-(n[o[S]]+o[S]*o[S]))/(2*w-2*o[S]);E<=c[S];)S--,E=(n[w]+w*w-(n[o[S]]+o[S]*o[S]))/(2*w-2*o[S]);o[++S]=w,c[S]=E,c[S+1]=+Me}for(w=0,S=0;w<_;w++){for(;c[S+1]<w;)S++;s[w]=(w-o[S])*(w-o[S])+n[o[S]]}}Ye.prototype.draw=function(n){this.ctx.clearRect(0,0,this.size,this.size),this.ctx.fillText(n,this.buffer,this.middle);for(var s=this.ctx.getImageData(0,0,this.size,this.size),o=new Uint8ClampedArray(this.size*this.size),c=0;c<this.size*this.size;c++){var _=s.data[4*c+3]/255;this.gridOuter[c]=_===1?0:_===0?Me:Math.pow(Math.max(0,.5-_),2),this.gridInner[c]=_===1?Me:_===0?0:Math.pow(Math.max(0,_-.5),2)}for(vt(this.gridOuter,this.size,this.size,this.f,this.d,this.v,this.z),vt(this.gridInner,this.size,this.size,this.f,this.d,this.v,this.z),c=0;c<this.size*this.size;c++)o[c]=Math.max(0,Math.min(255,Math.round(255-255*((this.gridOuter[c]-this.gridInner[c])/this.radius+this.cutoff))));return o},Ke.default=ut;var ct=function(n,s){this.requestManager=n,this.localIdeographFontFamily=s,this.entries={}};ct.prototype.setURL=function(n){this.url=n},ct.prototype.getGlyphs=function(n,s){var o=this,c=[];for(var _ in n)for(var w=0,S=n[_];w<S.length;w+=1)c.push({stack:_,id:S[w]});a.asyncAll(c,function(E,P){var O=E.stack,Z=E.id,G=o.entries[O];G||(G=o.entries[O]={glyphs:{},requests:{},ranges:{}});var H=G.glyphs[Z];if(H===void 0){if(H=o._tinySDF(G,O,Z))return G.glyphs[Z]=H,void P(null,{stack:O,id:Z,glyph:H});var te=Math.floor(Z/256);if(256*te>65535)P(new Error("glyphs > 65535 not supported"));else if(G.ranges[te])P(null,{stack:O,id:Z,glyph:H});else{var $=G.requests[te];$||($=G.requests[te]=[],ct.loadGlyphRange(O,te,o.url,o.requestManager,function(ue,Y){if(Y){for(var le in Y)o._doesCharSupportLocalGlyph(+le)||(G.glyphs[+le]=Y[+le]);G.ranges[te]=!0}for(var fe=0,_e=$;fe<_e.length;fe+=1)(0,_e[fe])(ue,Y);delete G.requests[te]})),$.push(function(ue,Y){ue?P(ue):Y&&P(null,{stack:O,id:Z,glyph:Y[Z]||null})})}}else P(null,{stack:O,id:Z,glyph:H})},function(E,P){if(E)s(E);else if(P){for(var O={},Z=0,G=P;Z<G.length;Z+=1){var H=G[Z],te=H.stack,$=H.id,ue=H.glyph;(O[te]||(O[te]={}))[$]=ue&&{id:ue.id,bitmap:ue.bitmap.clone(),metrics:ue.metrics}}s(null,O)}})},ct.prototype._doesCharSupportLocalGlyph=function(n){return!!this.localIdeographFontFamily&&(a.isChar["CJK Unified Ideographs"](n)||a.isChar["Hangul Syllables"](n)||a.isChar.Hiragana(n)||a.isChar.Katakana(n))},ct.prototype._tinySDF=function(n,s,o){var c=this.localIdeographFontFamily;if(c&&this._doesCharSupportLocalGlyph(o)){var _=n.tinySDF;if(!_){var w="400";/bold/i.test(s)?w="900":/medium/i.test(s)?w="500":/light/i.test(s)&&(w="200"),_=n.tinySDF=new ct.TinySDF(24,3,8,.25,c,w)}return{id:o,bitmap:new a.AlphaImage({width:30,height:30},_.draw(String.fromCharCode(o))),metrics:{width:24,height:24,left:0,top:-8,advance:24}}}},ct.loadGlyphRange=function(n,s,o,c,_){var w=256*s,S=w+255,E=c.transformRequest(c.normalizeGlyphsURL(o).replace("{fontstack}",n).replace("{range}",w+"-"+S),a.ResourceType.Glyphs);a.getArrayBuffer(E,function(P,O){if(P)_(P);else if(O){for(var Z={},G=0,H=a.parseGlyphPBF(O);G<H.length;G+=1){var te=H[G];Z[te.id]=te}_(null,Z)}})},ct.TinySDF=Ke;var mt=function(){this.specification=a.styleSpec.light.position};mt.prototype.possiblyEvaluate=function(n,s){return a.sphericalToCartesian(n.expression.evaluate(s))},mt.prototype.interpolate=function(n,s,o){return{x:a.number(n.x,s.x,o),y:a.number(n.y,s.y,o),z:a.number(n.z,s.z,o)}};var Ze=new a.Properties({anchor:new a.DataConstantProperty(a.styleSpec.light.anchor),position:new mt,color:new a.DataConstantProperty(a.styleSpec.light.color),intensity:new a.DataConstantProperty(a.styleSpec.light.intensity)}),Ft=function(n){function s(o){n.call(this),this._transitionable=new a.Transitionable(Ze),this.setLight(o),this._transitioning=this._transitionable.untransitioned()}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype.getLight=function(){return this._transitionable.serialize()},s.prototype.setLight=function(o,c){if(c===void 0&&(c={}),!this._validate(a.validateLight,o,c))for(var _ in o){var w=o[_];a.endsWith(_,"-transition")?this._transitionable.setTransition(_.slice(0,-11),w):this._transitionable.setValue(_,w)}},s.prototype.updateTransitions=function(o){this._transitioning=this._transitionable.transitioned(o,this._transitioning)},s.prototype.hasTransition=function(){return this._transitioning.hasTransition()},s.prototype.recalculate=function(o){this.properties=this._transitioning.possiblyEvaluate(o)},s.prototype._validate=function(o,c,_){return(!_||_.validate!==!1)&&a.emitValidationErrors(this,o.call(a.validateStyle,a.extend({value:c,style:{glyphs:!0,sprite:!0},styleSpec:a.styleSpec})))},s}(a.Evented),yt=function(n,s){this.width=n,this.height=s,this.nextRow=0,this.data=new Uint8Array(this.width*this.height),this.dashEntry={}};yt.prototype.getDash=function(n,s){var o=n.join(",")+String(s);return this.dashEntry[o]||(this.dashEntry[o]=this.addDash(n,s)),this.dashEntry[o]},yt.prototype.getDashRanges=function(n,s,o){var c=[],_=n.length%2==1?-n[n.length-1]*o:0,w=n[0]*o,S=!0;c.push({left:_,right:w,isDash:S,zeroLength:n[0]===0});for(var E=n[0],P=1;P<n.length;P++){var O=n[P];c.push({left:_=E*o,right:w=(E+=O)*o,isDash:S=!S,zeroLength:O===0})}return c},yt.prototype.addRoundDash=function(n,s,o){for(var c=s/2,_=-o;_<=o;_++)for(var w=this.width*(this.nextRow+o+_),S=0,E=n[S],P=0;P<this.width;P++){P/E.right>1&&(E=n[++S]);var O=Math.abs(P-E.left),Z=Math.abs(P-E.right),G=Math.min(O,Z),H=void 0,te=_/o*(c+1);if(E.isDash){var $=c-Math.abs(te);H=Math.sqrt(G*G+$*$)}else H=c-Math.sqrt(G*G+te*te);this.data[w+P]=Math.max(0,Math.min(255,H+128))}},yt.prototype.addRegularDash=function(n){for(var s=n.length-1;s>=0;--s){var o=n[s],c=n[s+1];o.zeroLength?n.splice(s,1):c&&c.isDash===o.isDash&&(c.left=o.left,n.splice(s,1))}var _=n[0],w=n[n.length-1];_.isDash===w.isDash&&(_.left=w.left-this.width,w.right=_.right+this.width);for(var S=this.width*this.nextRow,E=0,P=n[E],O=0;O<this.width;O++){O/P.right>1&&(P=n[++E]);var Z=Math.abs(O-P.left),G=Math.abs(O-P.right),H=Math.min(Z,G);this.data[S+O]=Math.max(0,Math.min(255,(P.isDash?H:-H)+128))}},yt.prototype.addDash=function(n,s){var o=s?7:0,c=2*o+1;if(this.nextRow+c>this.height)return a.warnOnce("LineAtlas out of space"),null;for(var _=0,w=0;w<n.length;w++)_+=n[w];if(_!==0){var S=this.width/_,E=this.getDashRanges(n,this.width,S);s?this.addRoundDash(E,S,o):this.addRegularDash(E)}var P={y:(this.nextRow+o+.5)/this.height,height:2*o/this.height,width:_};return this.nextRow+=c,this.dirty=!0,P},yt.prototype.bind=function(n){var s=n.gl;this.texture?(s.bindTexture(s.TEXTURE_2D,this.texture),this.dirty&&(this.dirty=!1,s.texSubImage2D(s.TEXTURE_2D,0,0,0,this.width,this.height,s.ALPHA,s.UNSIGNED_BYTE,this.data))):(this.texture=s.createTexture(),s.bindTexture(s.TEXTURE_2D,this.texture),s.texParameteri(s.TEXTURE_2D,s.TEXTURE_WRAP_S,s.REPEAT),s.texParameteri(s.TEXTURE_2D,s.TEXTURE_WRAP_T,s.REPEAT),s.texParameteri(s.TEXTURE_2D,s.TEXTURE_MIN_FILTER,s.LINEAR),s.texParameteri(s.TEXTURE_2D,s.TEXTURE_MAG_FILTER,s.LINEAR),s.texImage2D(s.TEXTURE_2D,0,s.ALPHA,this.width,this.height,0,s.ALPHA,s.UNSIGNED_BYTE,this.data))};var Ct=function n(s,o){this.workerPool=s,this.actors=[],this.currentActor=0,this.id=a.uniqueId();for(var c=this.workerPool.acquire(this.id),_=0;_<c.length;_++){var w=new n.Actor(c[_],o,this.id);w.name="Worker "+_,this.actors.push(w)}};function Le(n,s,o){var c=function(_,w){if(_)return o(_);if(w){var S=a.pick(a.extend(w,n),["tiles","minzoom","maxzoom","attribution","mapbox_logo","bounds","scheme","tileSize","encoding"]);w.vector_layers&&(S.vectorLayers=w.vector_layers,S.vectorLayerIds=S.vectorLayers.map(function(E){return E.id})),S.tiles=s.canonicalizeTileset(S,n.url),o(null,S)}};return n.url?a.getJSON(s.transformRequest(s.normalizeSourceURL(n.url),a.ResourceType.Source),c):a.browser.frame(function(){return c(null,n)})}Ct.prototype.broadcast=function(n,s,o){a.asyncAll(this.actors,function(c,_){c.send(n,s,_)},o=o||function(){})},Ct.prototype.getActor=function(){return this.currentActor=(this.currentActor+1)%this.actors.length,this.actors[this.currentActor]},Ct.prototype.remove=function(){this.actors.forEach(function(n){n.remove()}),this.actors=[],this.workerPool.release(this.id)},Ct.Actor=a.Actor;var Pt=function(n,s,o){this.bounds=a.LngLatBounds.convert(this.validateBounds(n)),this.minzoom=s||0,this.maxzoom=o||24};Pt.prototype.validateBounds=function(n){return Array.isArray(n)&&n.length===4?[Math.max(-180,n[0]),Math.max(-90,n[1]),Math.min(180,n[2]),Math.min(90,n[3])]:[-180,-90,180,90]},Pt.prototype.contains=function(n){var s=Math.pow(2,n.z),o=Math.floor(a.mercatorXfromLng(this.bounds.getWest())*s),c=Math.floor(a.mercatorYfromLat(this.bounds.getNorth())*s),_=Math.ceil(a.mercatorXfromLng(this.bounds.getEast())*s),w=Math.ceil(a.mercatorYfromLat(this.bounds.getSouth())*s);return n.x>=o&&n.x<_&&n.y>=c&&n.y<w};var At=function(n){function s(o,c,_,w){if(n.call(this),this.id=o,this.dispatcher=_,this.type="vector",this.minzoom=0,this.maxzoom=22,this.scheme="xyz",this.tileSize=512,this.reparseOverscaled=!0,this.isTileClipped=!0,this._loaded=!1,a.extend(this,a.pick(c,["url","scheme","tileSize","promoteId"])),this._options=a.extend({type:"vector"},c),this._collectResourceTiming=c.collectResourceTiming,this.tileSize!==512)throw new Error("vector tile sources must have a tileSize of 512");this.setEventedParent(w)}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype.load=function(){var o=this;this._loaded=!1,this.fire(new a.Event("dataloading",{dataType:"source"})),this._tileJSONRequest=Le(this._options,this.map._requestManager,function(c,_){o._tileJSONRequest=null,o._loaded=!0,c?o.fire(new a.ErrorEvent(c)):_&&(a.extend(o,_),_.bounds&&(o.tileBounds=new Pt(_.bounds,o.minzoom,o.maxzoom)),a.postTurnstileEvent(_.tiles,o.map._requestManager._customAccessToken),a.postMapLoadEvent(_.tiles,o.map._getMapId(),o.map._requestManager._skuToken,o.map._requestManager._customAccessToken),o.fire(new a.Event("data",{dataType:"source",sourceDataType:"metadata"})),o.fire(new a.Event("data",{dataType:"source",sourceDataType:"content"})))})},s.prototype.loaded=function(){return this._loaded},s.prototype.hasTile=function(o){return!this.tileBounds||this.tileBounds.contains(o.canonical)},s.prototype.onAdd=function(o){this.map=o,this.load()},s.prototype.setSourceProperty=function(o){this._tileJSONRequest&&this._tileJSONRequest.cancel(),o(),this.map.style.sourceCaches[this.id].clearTiles(),this.load()},s.prototype.setTiles=function(o){var c=this;return this.setSourceProperty(function(){c._options.tiles=o}),this},s.prototype.setUrl=function(o){var c=this;return this.setSourceProperty(function(){c.url=o,c._options.url=o}),this},s.prototype.onRemove=function(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)},s.prototype.serialize=function(){return a.extend({},this._options)},s.prototype.loadTile=function(o,c){var _=this.map._requestManager.normalizeTileURL(o.tileID.canonical.url(this.tiles,this.scheme)),w={request:this.map._requestManager.transformRequest(_,a.ResourceType.Tile),uid:o.uid,tileID:o.tileID,zoom:o.tileID.overscaledZ,tileSize:this.tileSize*o.tileID.overscaleFactor(),type:this.type,source:this.id,pixelRatio:a.browser.devicePixelRatio,showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId};function S(E,P){return delete o.request,o.aborted?c(null):E&&E.status!==404?c(E):(P&&P.resourceTiming&&(o.resourceTiming=P.resourceTiming),this.map._refreshExpiredTiles&&P&&o.setExpiryData(P),o.loadVectorData(P,this.map.painter),a.cacheEntryPossiblyAdded(this.dispatcher),c(null),void(o.reloadCallback&&(this.loadTile(o,o.reloadCallback),o.reloadCallback=null)))}w.request.collectResourceTiming=this._collectResourceTiming,o.actor&&o.state!=="expired"?o.state==="loading"?o.reloadCallback=c:o.request=o.actor.send("reloadTile",w,S.bind(this)):(o.actor=this.dispatcher.getActor(),o.request=o.actor.send("loadTile",w,S.bind(this)))},s.prototype.abortTile=function(o){o.request&&(o.request.cancel(),delete o.request),o.actor&&o.actor.send("abortTile",{uid:o.uid,type:this.type,source:this.id},void 0)},s.prototype.unloadTile=function(o){o.unloadVectorData(),o.actor&&o.actor.send("removeTile",{uid:o.uid,type:this.type,source:this.id},void 0)},s.prototype.hasTransition=function(){return!1},s}(a.Evented),Jt=function(n){function s(o,c,_,w){n.call(this),this.id=o,this.dispatcher=_,this.setEventedParent(w),this.type="raster",this.minzoom=0,this.maxzoom=22,this.roundZoom=!0,this.scheme="xyz",this.tileSize=512,this._loaded=!1,this._options=a.extend({type:"raster"},c),a.extend(this,a.pick(c,["url","scheme","tileSize"]))}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype.load=function(){var o=this;this._loaded=!1,this.fire(new a.Event("dataloading",{dataType:"source"})),this._tileJSONRequest=Le(this._options,this.map._requestManager,function(c,_){o._tileJSONRequest=null,o._loaded=!0,c?o.fire(new a.ErrorEvent(c)):_&&(a.extend(o,_),_.bounds&&(o.tileBounds=new Pt(_.bounds,o.minzoom,o.maxzoom)),a.postTurnstileEvent(_.tiles),a.postMapLoadEvent(_.tiles,o.map._getMapId(),o.map._requestManager._skuToken),o.fire(new a.Event("data",{dataType:"source",sourceDataType:"metadata"})),o.fire(new a.Event("data",{dataType:"source",sourceDataType:"content"})))})},s.prototype.loaded=function(){return this._loaded},s.prototype.onAdd=function(o){this.map=o,this.load()},s.prototype.onRemove=function(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)},s.prototype.serialize=function(){return a.extend({},this._options)},s.prototype.hasTile=function(o){return!this.tileBounds||this.tileBounds.contains(o.canonical)},s.prototype.loadTile=function(o,c){var _=this,w=this.map._requestManager.normalizeTileURL(o.tileID.canonical.url(this.tiles,this.scheme),this.tileSize);o.request=a.getImage(this.map._requestManager.transformRequest(w,a.ResourceType.Tile),function(S,E){if(delete o.request,o.aborted)o.state="unloaded",c(null);else if(S)o.state="errored",c(S);else if(E){_.map._refreshExpiredTiles&&o.setExpiryData(E),delete E.cacheControl,delete E.expires;var P=_.map.painter.context,O=P.gl;o.texture=_.map.painter.getTileTexture(E.width),o.texture?o.texture.update(E,{useMipmap:!0}):(o.texture=new a.Texture(P,E,O.RGBA,{useMipmap:!0}),o.texture.bind(O.LINEAR,O.CLAMP_TO_EDGE,O.LINEAR_MIPMAP_NEAREST),P.extTextureFilterAnisotropic&&O.texParameterf(O.TEXTURE_2D,P.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,P.extTextureFilterAnisotropicMax)),o.state="loaded",a.cacheEntryPossiblyAdded(_.dispatcher),c(null)}})},s.prototype.abortTile=function(o,c){o.request&&(o.request.cancel(),delete o.request),c()},s.prototype.unloadTile=function(o,c){o.texture&&this.map.painter.saveTileTexture(o.texture),c()},s.prototype.hasTransition=function(){return!1},s}(a.Evented),Nt=function(n){function s(o,c,_,w){n.call(this,o,c,_,w),this.type="raster-dem",this.maxzoom=22,this._options=a.extend({type:"raster-dem"},c),this.encoding=c.encoding||"mapbox"}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype.serialize=function(){return{type:"raster-dem",url:this.url,tileSize:this.tileSize,tiles:this.tiles,bounds:this.bounds,encoding:this.encoding}},s.prototype.loadTile=function(o,c){var _=this.map._requestManager.normalizeTileURL(o.tileID.canonical.url(this.tiles,this.scheme),this.tileSize);function w(S,E){S&&(o.state="errored",c(S)),E&&(o.dem=E,o.needsHillshadePrepare=!0,o.state="loaded",c(null))}o.request=a.getImage(this.map._requestManager.transformRequest(_,a.ResourceType.Tile),(function(S,E){if(delete o.request,o.aborted)o.state="unloaded",c(null);else if(S)o.state="errored",c(S);else if(E){this.map._refreshExpiredTiles&&o.setExpiryData(E),delete E.cacheControl,delete E.expires;var P=a.window.ImageBitmap&&E instanceof a.window.ImageBitmap&&a.offscreenCanvasSupported()?E:a.browser.getImageData(E,1),O={uid:o.uid,coord:o.tileID,source:this.id,rawImageData:P,encoding:this.encoding};o.actor&&o.state!=="expired"||(o.actor=this.dispatcher.getActor(),o.actor.send("loadDEMTile",O,w.bind(this)))}}).bind(this)),o.neighboringTiles=this._getNeighboringTiles(o.tileID)},s.prototype._getNeighboringTiles=function(o){var c=o.canonical,_=Math.pow(2,c.z),w=(c.x-1+_)%_,S=c.x===0?o.wrap-1:o.wrap,E=(c.x+1+_)%_,P=c.x+1===_?o.wrap+1:o.wrap,O={};return O[new a.OverscaledTileID(o.overscaledZ,S,c.z,w,c.y).key]={backfilled:!1},O[new a.OverscaledTileID(o.overscaledZ,P,c.z,E,c.y).key]={backfilled:!1},c.y>0&&(O[new a.OverscaledTileID(o.overscaledZ,S,c.z,w,c.y-1).key]={backfilled:!1},O[new a.OverscaledTileID(o.overscaledZ,o.wrap,c.z,c.x,c.y-1).key]={backfilled:!1},O[new a.OverscaledTileID(o.overscaledZ,P,c.z,E,c.y-1).key]={backfilled:!1}),c.y+1<_&&(O[new a.OverscaledTileID(o.overscaledZ,S,c.z,w,c.y+1).key]={backfilled:!1},O[new a.OverscaledTileID(o.overscaledZ,o.wrap,c.z,c.x,c.y+1).key]={backfilled:!1},O[new a.OverscaledTileID(o.overscaledZ,P,c.z,E,c.y+1).key]={backfilled:!1}),O},s.prototype.unloadTile=function(o){o.demTexture&&this.map.painter.saveTileTexture(o.demTexture),o.fbo&&(o.fbo.destroy(),delete o.fbo),o.dem&&delete o.dem,delete o.neighboringTiles,o.state="unloaded",o.actor&&o.actor.send("removeDEMTile",{uid:o.uid,source:this.id})},s}(Jt),ht=function(n){function s(o,c,_,w){n.call(this),this.id=o,this.type="geojson",this.minzoom=0,this.maxzoom=18,this.tileSize=512,this.isTileClipped=!0,this.reparseOverscaled=!0,this._removed=!1,this._loaded=!1,this.actor=_.getActor(),this.setEventedParent(w),this._data=c.data,this._options=a.extend({},c),this._collectResourceTiming=c.collectResourceTiming,this._resourceTiming=[],c.maxzoom!==void 0&&(this.maxzoom=c.maxzoom),c.type&&(this.type=c.type),c.attribution&&(this.attribution=c.attribution),this.promoteId=c.promoteId;var S=a.EXTENT/this.tileSize;this.workerOptions=a.extend({source:this.id,cluster:c.cluster||!1,geojsonVtOptions:{buffer:(c.buffer!==void 0?c.buffer:128)*S,tolerance:(c.tolerance!==void 0?c.tolerance:.375)*S,extent:a.EXTENT,maxZoom:this.maxzoom,lineMetrics:c.lineMetrics||!1,generateId:c.generateId||!1},superclusterOptions:{maxZoom:c.clusterMaxZoom!==void 0?Math.min(c.clusterMaxZoom,this.maxzoom-1):this.maxzoom-1,minPoints:Math.max(2,c.clusterMinPoints||2),extent:a.EXTENT,radius:(c.clusterRadius||50)*S,log:!1,generateId:c.generateId||!1},clusterProperties:c.clusterProperties,filter:c.filter},c.workerOptions)}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype.load=function(){var o=this;this.fire(new a.Event("dataloading",{dataType:"source"})),this._updateWorkerData(function(c){if(c)o.fire(new a.ErrorEvent(c));else{var _={dataType:"source",sourceDataType:"metadata"};o._collectResourceTiming&&o._resourceTiming&&o._resourceTiming.length>0&&(_.resourceTiming=o._resourceTiming,o._resourceTiming=[]),o.fire(new a.Event("data",_))}})},s.prototype.onAdd=function(o){this.map=o,this.load()},s.prototype.setData=function(o){var c=this;return this._data=o,this.fire(new a.Event("dataloading",{dataType:"source"})),this._updateWorkerData(function(_){if(_)c.fire(new a.ErrorEvent(_));else{var w={dataType:"source",sourceDataType:"content"};c._collectResourceTiming&&c._resourceTiming&&c._resourceTiming.length>0&&(w.resourceTiming=c._resourceTiming,c._resourceTiming=[]),c.fire(new a.Event("data",w))}}),this},s.prototype.getClusterExpansionZoom=function(o,c){return this.actor.send("geojson.getClusterExpansionZoom",{clusterId:o,source:this.id},c),this},s.prototype.getClusterChildren=function(o,c){return this.actor.send("geojson.getClusterChildren",{clusterId:o,source:this.id},c),this},s.prototype.getClusterLeaves=function(o,c,_,w){return this.actor.send("geojson.getClusterLeaves",{source:this.id,clusterId:o,limit:c,offset:_},w),this},s.prototype._updateWorkerData=function(o){var c=this;this._loaded=!1;var _=a.extend({},this.workerOptions),w=this._data;typeof w=="string"?(_.request=this.map._requestManager.transformRequest(a.browser.resolveURL(w),a.ResourceType.Source),_.request.collectResourceTiming=this._collectResourceTiming):_.data=JSON.stringify(w),this.actor.send(this.type+".loadData",_,function(S,E){c._removed||E&&E.abandoned||(c._loaded=!0,E&&E.resourceTiming&&E.resourceTiming[c.id]&&(c._resourceTiming=E.resourceTiming[c.id].slice(0)),c.actor.send(c.type+".coalesce",{source:_.source},null),o(S))})},s.prototype.loaded=function(){return this._loaded},s.prototype.loadTile=function(o,c){var _=this,w=o.actor?"reloadTile":"loadTile";o.actor=this.actor,o.request=this.actor.send(w,{type:this.type,uid:o.uid,tileID:o.tileID,zoom:o.tileID.overscaledZ,maxZoom:this.maxzoom,tileSize:this.tileSize,source:this.id,pixelRatio:a.browser.devicePixelRatio,showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId},function(S,E){return delete o.request,o.unloadVectorData(),o.aborted?c(null):S?c(S):(o.loadVectorData(E,_.map.painter,w==="reloadTile"),c(null))})},s.prototype.abortTile=function(o){o.request&&(o.request.cancel(),delete o.request),o.aborted=!0},s.prototype.unloadTile=function(o){o.unloadVectorData(),this.actor.send("removeTile",{uid:o.uid,type:this.type,source:this.id})},s.prototype.onRemove=function(){this._removed=!0,this.actor.send("removeSource",{type:this.type,source:this.id})},s.prototype.serialize=function(){return a.extend({},this._options,{type:this.type,data:this._data})},s.prototype.hasTransition=function(){return!1},s}(a.Evented),De=a.createLayout([{name:"a_pos",type:"Int16",components:2},{name:"a_texture_pos",type:"Int16",components:2}]),Lt=function(n){function s(o,c,_,w){n.call(this),this.id=o,this.dispatcher=_,this.coordinates=c.coordinates,this.type="image",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this.tiles={},this._loaded=!1,this.setEventedParent(w),this.options=c}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype.load=function(o,c){var _=this;this._loaded=!1,this.fire(new a.Event("dataloading",{dataType:"source"})),this.url=this.options.url,a.getImage(this.map._requestManager.transformRequest(this.url,a.ResourceType.Image),function(w,S){_._loaded=!0,w?_.fire(new a.ErrorEvent(w)):S&&(_.image=S,o&&(_.coordinates=o),c&&c(),_._finishLoading())})},s.prototype.loaded=function(){return this._loaded},s.prototype.updateImage=function(o){var c=this;return this.image&&o.url?(this.options.url=o.url,this.load(o.coordinates,function(){c.texture=null}),this):this},s.prototype._finishLoading=function(){this.map&&(this.setCoordinates(this.coordinates),this.fire(new a.Event("data",{dataType:"source",sourceDataType:"metadata"})))},s.prototype.onAdd=function(o){this.map=o,this.load()},s.prototype.setCoordinates=function(o){var c=this;this.coordinates=o;var _=o.map(a.MercatorCoordinate.fromLngLat);this.tileID=function(S){for(var E=1/0,P=1/0,O=-1/0,Z=-1/0,G=0,H=S;G<H.length;G+=1){var te=H[G];E=Math.min(E,te.x),P=Math.min(P,te.y),O=Math.max(O,te.x),Z=Math.max(Z,te.y)}var $=Math.max(O-E,Z-P),ue=Math.max(0,Math.floor(-Math.log($)/Math.LN2)),Y=Math.pow(2,ue);return new a.CanonicalTileID(ue,Math.floor((E+O)/2*Y),Math.floor((P+Z)/2*Y))}(_),this.minzoom=this.maxzoom=this.tileID.z;var w=_.map(function(S){return c.tileID.getTilePoint(S)._round()});return this._boundsArray=new a.StructArrayLayout4i8,this._boundsArray.emplaceBack(w[0].x,w[0].y,0,0),this._boundsArray.emplaceBack(w[1].x,w[1].y,a.EXTENT,0),this._boundsArray.emplaceBack(w[3].x,w[3].y,0,a.EXTENT),this._boundsArray.emplaceBack(w[2].x,w[2].y,a.EXTENT,a.EXTENT),this.boundsBuffer&&(this.boundsBuffer.destroy(),delete this.boundsBuffer),this.fire(new a.Event("data",{dataType:"source",sourceDataType:"content"})),this},s.prototype.prepare=function(){if(Object.keys(this.tiles).length!==0&&this.image){var o=this.map.painter.context,c=o.gl;for(var _ in this.boundsBuffer||(this.boundsBuffer=o.createVertexBuffer(this._boundsArray,De.members)),this.boundsSegments||(this.boundsSegments=a.SegmentVector.simpleSegment(0,0,4,2)),this.texture||(this.texture=new a.Texture(o,this.image,c.RGBA),this.texture.bind(c.LINEAR,c.CLAMP_TO_EDGE)),this.tiles){var w=this.tiles[_];w.state!=="loaded"&&(w.state="loaded",w.texture=this.texture)}}},s.prototype.loadTile=function(o,c){this.tileID&&this.tileID.equals(o.tileID.canonical)?(this.tiles[String(o.tileID.wrap)]=o,o.buckets={},c(null)):(o.state="errored",c(null))},s.prototype.serialize=function(){return{type:"image",url:this.options.url,coordinates:this.coordinates}},s.prototype.hasTransition=function(){return!1},s}(a.Evented),Cr=function(n){function s(o,c,_,w){n.call(this,o,c,_,w),this.roundZoom=!0,this.type="video",this.options=c}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype.load=function(){var o=this;this._loaded=!1;var c=this.options;this.urls=[];for(var _=0,w=c.urls;_<w.length;_+=1)this.urls.push(this.map._requestManager.transformRequest(w[_],a.ResourceType.Source).url);a.getVideo(this.urls,function(S,E){o._loaded=!0,S?o.fire(new a.ErrorEvent(S)):E&&(o.video=E,o.video.loop=!0,o.video.addEventListener("playing",function(){o.map.triggerRepaint()}),o.map&&o.video.play(),o._finishLoading())})},s.prototype.pause=function(){this.video&&this.video.pause()},s.prototype.play=function(){this.video&&this.video.play()},s.prototype.seek=function(o){if(this.video){var c=this.video.seekable;o<c.start(0)||o>c.end(0)?this.fire(new a.ErrorEvent(new a.ValidationError("sources."+this.id,null,"Playback for this video can be set only between the "+c.start(0)+" and "+c.end(0)+"-second mark."))):this.video.currentTime=o}},s.prototype.getVideo=function(){return this.video},s.prototype.onAdd=function(o){this.map||(this.map=o,this.load(),this.video&&(this.video.play(),this.setCoordinates(this.coordinates)))},s.prototype.prepare=function(){if(!(Object.keys(this.tiles).length===0||this.video.readyState<2)){var o=this.map.painter.context,c=o.gl;for(var _ in this.boundsBuffer||(this.boundsBuffer=o.createVertexBuffer(this._boundsArray,De.members)),this.boundsSegments||(this.boundsSegments=a.SegmentVector.simpleSegment(0,0,4,2)),this.texture?this.video.paused||(this.texture.bind(c.LINEAR,c.CLAMP_TO_EDGE),c.texSubImage2D(c.TEXTURE_2D,0,0,0,c.RGBA,c.UNSIGNED_BYTE,this.video)):(this.texture=new a.Texture(o,this.video,c.RGBA),this.texture.bind(c.LINEAR,c.CLAMP_TO_EDGE)),this.tiles){var w=this.tiles[_];w.state!=="loaded"&&(w.state="loaded",w.texture=this.texture)}}},s.prototype.serialize=function(){return{type:"video",urls:this.urls,coordinates:this.coordinates}},s.prototype.hasTransition=function(){return this.video&&!this.video.paused},s}(Lt),_i=function(n){function s(o,c,_,w){n.call(this,o,c,_,w),c.coordinates?Array.isArray(c.coordinates)&&c.coordinates.length===4&&!c.coordinates.some(function(S){return!Array.isArray(S)||S.length!==2||S.some(function(E){return typeof E!="number"})})||this.fire(new a.ErrorEvent(new a.ValidationError("sources."+o,null,'"coordinates" property must be an array of 4 longitude/latitude array pairs'))):this.fire(new a.ErrorEvent(new a.ValidationError("sources."+o,null,'missing required property "coordinates"'))),c.animate&&typeof c.animate!="boolean"&&this.fire(new a.ErrorEvent(new a.ValidationError("sources."+o,null,'optional "animate" property must be a boolean value'))),c.canvas?typeof c.canvas=="string"||c.canvas instanceof a.window.HTMLCanvasElement||this.fire(new a.ErrorEvent(new a.ValidationError("sources."+o,null,'"canvas" must be either a string representing the ID of the canvas element from which to read, or an HTMLCanvasElement instance'))):this.fire(new a.ErrorEvent(new a.ValidationError("sources."+o,null,'missing required property "canvas"'))),this.options=c,this.animate=c.animate===void 0||c.animate}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype.load=function(){this._loaded=!0,this.canvas||(this.canvas=this.options.canvas instanceof a.window.HTMLCanvasElement?this.options.canvas:a.window.document.getElementById(this.options.canvas)),this.width=this.canvas.width,this.height=this.canvas.height,this._hasInvalidDimensions()?this.fire(new a.ErrorEvent(new Error("Canvas dimensions cannot be less than or equal to zero."))):(this.play=function(){this._playing=!0,this.map.triggerRepaint()},this.pause=function(){this._playing&&(this.prepare(),this._playing=!1)},this._finishLoading())},s.prototype.getCanvas=function(){return this.canvas},s.prototype.onAdd=function(o){this.map=o,this.load(),this.canvas&&this.animate&&this.play()},s.prototype.onRemove=function(){this.pause()},s.prototype.prepare=function(){var o=!1;if(this.canvas.width!==this.width&&(this.width=this.canvas.width,o=!0),this.canvas.height!==this.height&&(this.height=this.canvas.height,o=!0),!this._hasInvalidDimensions()&&Object.keys(this.tiles).length!==0){var c=this.map.painter.context,_=c.gl;for(var w in this.boundsBuffer||(this.boundsBuffer=c.createVertexBuffer(this._boundsArray,De.members)),this.boundsSegments||(this.boundsSegments=a.SegmentVector.simpleSegment(0,0,4,2)),this.texture?(o||this._playing)&&this.texture.update(this.canvas,{premultiply:!0}):this.texture=new a.Texture(c,this.canvas,_.RGBA,{premultiply:!0}),this.tiles){var S=this.tiles[w];S.state!=="loaded"&&(S.state="loaded",S.texture=this.texture)}}},s.prototype.serialize=function(){return{type:"canvas",coordinates:this.coordinates}},s.prototype.hasTransition=function(){return this._playing},s.prototype._hasInvalidDimensions=function(){for(var o=0,c=[this.canvas.width,this.canvas.height];o<c.length;o+=1){var _=c[o];if(isNaN(_)||_<=0)return!0}return!1},s}(Lt),er={vector:At,raster:Jt,"raster-dem":Nt,geojson:ht,video:Cr,image:Lt,canvas:_i};function Mr(n,s){var o=a.identity([]);return a.translate(o,o,[1,1,0]),a.scale(o,o,[.5*n.width,.5*n.height,1]),a.multiply(o,o,n.calculatePosMatrix(s.toUnwrapped()))}function Sr(n,s,o,c,_,w){var S=function(ue,Y,le){if(ue)for(var fe=0,_e=ue;fe<_e.length;fe+=1){var Te=Y[_e[fe]];if(Te&&Te.source===le&&Te.type==="fill-extrusion")return!0}else for(var ke in Y){var Ae=Y[ke];if(Ae.source===le&&Ae.type==="fill-extrusion")return!0}return!1}(_&&_.layers,s,n.id),E=w.maxPitchScaleFactor(),P=n.tilesIn(c,E,S);P.sort(en);for(var O=[],Z=0,G=P;Z<G.length;Z+=1){var H=G[Z];O.push({wrappedTileID:H.tileID.wrapped().key,queryResults:H.tile.queryRenderedFeatures(s,o,n._state,H.queryGeometry,H.cameraQueryGeometry,H.scale,_,w,E,Mr(n.transform,H.tileID))})}var te=function(ue){for(var Y={},le={},fe=0,_e=ue;fe<_e.length;fe+=1){var Te=_e[fe],ke=Te.queryResults,Ae=Te.wrappedTileID,Oe=le[Ae]=le[Ae]||{};for(var He in ke)for(var Ge=ke[He],lt=Oe[He]=Oe[He]||{},kt=Y[He]=Y[He]||[],It=0,Tt=Ge;It<Tt.length;It+=1){var gr=Tt[It];lt[gr.featureIndex]||(lt[gr.featureIndex]=!0,kt.push(gr))}}return Y}(O);for(var $ in te)te[$].forEach(function(ue){var Y=ue.feature,le=n.getFeatureState(Y.layer["source-layer"],Y.id);Y.source=Y.layer.source,Y.layer["source-layer"]&&(Y.sourceLayer=Y.layer["source-layer"]),Y.state=le});return te}function en(n,s){var o=n.tileID,c=s.tileID;return o.overscaledZ-c.overscaledZ||o.canonical.y-c.canonical.y||o.wrap-c.wrap||o.canonical.x-c.canonical.x}var Wt=function(n,s){this.max=n,this.onRemove=s,this.reset()};Wt.prototype.reset=function(){for(var n in this.data)for(var s=0,o=this.data[n];s<o.length;s+=1){var c=o[s];c.timeout&&clearTimeout(c.timeout),this.onRemove(c.value)}return this.data={},this.order=[],this},Wt.prototype.add=function(n,s,o){var c=this,_=n.wrapped().key;this.data[_]===void 0&&(this.data[_]=[]);var w={value:s,timeout:void 0};if(o!==void 0&&(w.timeout=setTimeout(function(){c.remove(n,w)},o)),this.data[_].push(w),this.order.push(_),this.order.length>this.max){var S=this._getAndRemoveByKey(this.order[0]);S&&this.onRemove(S)}return this},Wt.prototype.has=function(n){return n.wrapped().key in this.data},Wt.prototype.getAndRemove=function(n){return this.has(n)?this._getAndRemoveByKey(n.wrapped().key):null},Wt.prototype._getAndRemoveByKey=function(n){var s=this.data[n].shift();return s.timeout&&clearTimeout(s.timeout),this.data[n].length===0&&delete this.data[n],this.order.splice(this.order.indexOf(n),1),s.value},Wt.prototype.getByKey=function(n){var s=this.data[n];return s?s[0].value:null},Wt.prototype.get=function(n){return this.has(n)?this.data[n.wrapped().key][0].value:null},Wt.prototype.remove=function(n,s){if(!this.has(n))return this;var o=n.wrapped().key,c=s===void 0?0:this.data[o].indexOf(s),_=this.data[o][c];return this.data[o].splice(c,1),_.timeout&&clearTimeout(_.timeout),this.data[o].length===0&&delete this.data[o],this.onRemove(_.value),this.order.splice(this.order.indexOf(o),1),this},Wt.prototype.setMaxSize=function(n){for(this.max=n;this.order.length>this.max;){var s=this._getAndRemoveByKey(this.order[0]);s&&this.onRemove(s)}return this},Wt.prototype.filter=function(n){var s=[];for(var o in this.data)for(var c=0,_=this.data[o];c<_.length;c+=1){var w=_[c];n(w.value)||s.push(w)}for(var S=0,E=s;S<E.length;S+=1){var P=E[S];this.remove(P.value.tileID,P)}};var ui=function(n,s,o){this.context=n;var c=n.gl;this.buffer=c.createBuffer(),this.dynamicDraw=!!o,this.context.unbindVAO(),n.bindElementBuffer.set(this.buffer),c.bufferData(c.ELEMENT_ARRAY_BUFFER,s.arrayBuffer,this.dynamicDraw?c.DYNAMIC_DRAW:c.STATIC_DRAW),this.dynamicDraw||delete s.arrayBuffer};ui.prototype.bind=function(){this.context.bindElementBuffer.set(this.buffer)},ui.prototype.updateData=function(n){var s=this.context.gl;this.context.unbindVAO(),this.bind(),s.bufferSubData(s.ELEMENT_ARRAY_BUFFER,0,n.arrayBuffer)},ui.prototype.destroy=function(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)};var Hn={Int8:"BYTE",Uint8:"UNSIGNED_BYTE",Int16:"SHORT",Uint16:"UNSIGNED_SHORT",Int32:"INT",Uint32:"UNSIGNED_INT",Float32:"FLOAT"},tn=function(n,s,o,c){this.length=s.length,this.attributes=o,this.itemSize=s.bytesPerElement,this.dynamicDraw=c,this.context=n;var _=n.gl;this.buffer=_.createBuffer(),n.bindVertexBuffer.set(this.buffer),_.bufferData(_.ARRAY_BUFFER,s.arrayBuffer,this.dynamicDraw?_.DYNAMIC_DRAW:_.STATIC_DRAW),this.dynamicDraw||delete s.arrayBuffer};tn.prototype.bind=function(){this.context.bindVertexBuffer.set(this.buffer)},tn.prototype.updateData=function(n){var s=this.context.gl;this.bind(),s.bufferSubData(s.ARRAY_BUFFER,0,n.arrayBuffer)},tn.prototype.enableAttributes=function(n,s){for(var o=0;o<this.attributes.length;o++){var c=s.attributes[this.attributes[o].name];c!==void 0&&n.enableVertexAttribArray(c)}},tn.prototype.setVertexAttribPointers=function(n,s,o){for(var c=0;c<this.attributes.length;c++){var _=this.attributes[c],w=s.attributes[_.name];w!==void 0&&n.vertexAttribPointer(w,_.components,n[Hn[_.type]],!1,this.itemSize,_.offset+this.itemSize*(o||0))}},tn.prototype.destroy=function(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)};var jt=function(n){this.gl=n.gl,this.default=this.getDefault(),this.current=this.default,this.dirty=!1};jt.prototype.get=function(){return this.current},jt.prototype.set=function(n){},jt.prototype.getDefault=function(){return this.default},jt.prototype.setDefault=function(){this.set(this.default)};var yn=function(n){function s(){n.apply(this,arguments)}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype.getDefault=function(){return a.Color.transparent},s.prototype.set=function(o){var c=this.current;(o.r!==c.r||o.g!==c.g||o.b!==c.b||o.a!==c.a||this.dirty)&&(this.gl.clearColor(o.r,o.g,o.b,o.a),this.current=o,this.dirty=!1)},s}(jt),Qr=function(n){function s(){n.apply(this,arguments)}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype.getDefault=function(){return 1},s.prototype.set=function(o){(o!==this.current||this.dirty)&&(this.gl.clearDepth(o),this.current=o,this.dirty=!1)},s}(jt),vi=function(n){function s(){n.apply(this,arguments)}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype.getDefault=function(){return 0},s.prototype.set=function(o){(o!==this.current||this.dirty)&&(this.gl.clearStencil(o),this.current=o,this.dirty=!1)},s}(jt),Tn=function(n){function s(){n.apply(this,arguments)}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype.getDefault=function(){return[!0,!0,!0,!0]},s.prototype.set=function(o){var c=this.current;(o[0]!==c[0]||o[1]!==c[1]||o[2]!==c[2]||o[3]!==c[3]||this.dirty)&&(this.gl.colorMask(o[0],o[1],o[2],o[3]),this.current=o,this.dirty=!1)},s}(jt),Er=function(n){function s(){n.apply(this,arguments)}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype.getDefault=function(){return!0},s.prototype.set=function(o){(o!==this.current||this.dirty)&&(this.gl.depthMask(o),this.current=o,this.dirty=!1)},s}(jt),zi=function(n){function s(){n.apply(this,arguments)}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype.getDefault=function(){return 255},s.prototype.set=function(o){(o!==this.current||this.dirty)&&(this.gl.stencilMask(o),this.current=o,this.dirty=!1)},s}(jt),ci=function(n){function s(){n.apply(this,arguments)}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype.getDefault=function(){return{func:this.gl.ALWAYS,ref:0,mask:255}},s.prototype.set=function(o){var c=this.current;(o.func!==c.func||o.ref!==c.ref||o.mask!==c.mask||this.dirty)&&(this.gl.stencilFunc(o.func,o.ref,o.mask),this.current=o,this.dirty=!1)},s}(jt),hi=function(n){function s(){n.apply(this,arguments)}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype.getDefault=function(){var o=this.gl;return[o.KEEP,o.KEEP,o.KEEP]},s.prototype.set=function(o){var c=this.current;(o[0]!==c[0]||o[1]!==c[1]||o[2]!==c[2]||this.dirty)&&(this.gl.stencilOp(o[0],o[1],o[2]),this.current=o,this.dirty=!1)},s}(jt),sn=function(n){function s(){n.apply(this,arguments)}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype.getDefault=function(){return!1},s.prototype.set=function(o){if(o!==this.current||this.dirty){var c=this.gl;o?c.enable(c.STENCIL_TEST):c.disable(c.STENCIL_TEST),this.current=o,this.dirty=!1}},s}(jt),qr=function(n){function s(){n.apply(this,arguments)}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype.getDefault=function(){return[0,1]},s.prototype.set=function(o){var c=this.current;(o[0]!==c[0]||o[1]!==c[1]||this.dirty)&&(this.gl.depthRange(o[0],o[1]),this.current=o,this.dirty=!1)},s}(jt),pi=function(n){function s(){n.apply(this,arguments)}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype.getDefault=function(){return!1},s.prototype.set=function(o){if(o!==this.current||this.dirty){var c=this.gl;o?c.enable(c.DEPTH_TEST):c.disable(c.DEPTH_TEST),this.current=o,this.dirty=!1}},s}(jt),fi=function(n){function s(){n.apply(this,arguments)}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype.getDefault=function(){return this.gl.LESS},s.prototype.set=function(o){(o!==this.current||this.dirty)&&(this.gl.depthFunc(o),this.current=o,this.dirty=!1)},s}(jt),bi=function(n){function s(){n.apply(this,arguments)}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype.getDefault=function(){return!1},s.prototype.set=function(o){if(o!==this.current||this.dirty){var c=this.gl;o?c.enable(c.BLEND):c.disable(c.BLEND),this.current=o,this.dirty=!1}},s}(jt),Bi=function(n){function s(){n.apply(this,arguments)}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype.getDefault=function(){var o=this.gl;return[o.ONE,o.ZERO]},s.prototype.set=function(o){var c=this.current;(o[0]!==c[0]||o[1]!==c[1]||this.dirty)&&(this.gl.blendFunc(o[0],o[1]),this.current=o,this.dirty=!1)},s}(jt),Xn=function(n){function s(){n.apply(this,arguments)}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype.getDefault=function(){return a.Color.transparent},s.prototype.set=function(o){var c=this.current;(o.r!==c.r||o.g!==c.g||o.b!==c.b||o.a!==c.a||this.dirty)&&(this.gl.blendColor(o.r,o.g,o.b,o.a),this.current=o,this.dirty=!1)},s}(jt),qi=function(n){function s(){n.apply(this,arguments)}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype.getDefault=function(){return this.gl.FUNC_ADD},s.prototype.set=function(o){(o!==this.current||this.dirty)&&(this.gl.blendEquation(o),this.current=o,this.dirty=!1)},s}(jt),ji=function(n){function s(){n.apply(this,arguments)}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype.getDefault=function(){return!1},s.prototype.set=function(o){if(o!==this.current||this.dirty){var c=this.gl;o?c.enable(c.CULL_FACE):c.disable(c.CULL_FACE),this.current=o,this.dirty=!1}},s}(jt),jr=function(n){function s(){n.apply(this,arguments)}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype.getDefault=function(){return this.gl.BACK},s.prototype.set=function(o){(o!==this.current||this.dirty)&&(this.gl.cullFace(o),this.current=o,this.dirty=!1)},s}(jt),ta=function(n){function s(){n.apply(this,arguments)}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype.getDefault=function(){return this.gl.CCW},s.prototype.set=function(o){(o!==this.current||this.dirty)&&(this.gl.frontFace(o),this.current=o,this.dirty=!1)},s}(jt),gn=function(n){function s(){n.apply(this,arguments)}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype.getDefault=function(){return null},s.prototype.set=function(o){(o!==this.current||this.dirty)&&(this.gl.useProgram(o),this.current=o,this.dirty=!1)},s}(jt),xi=function(n){function s(){n.apply(this,arguments)}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype.getDefault=function(){return this.gl.TEXTURE0},s.prototype.set=function(o){(o!==this.current||this.dirty)&&(this.gl.activeTexture(o),this.current=o,this.dirty=!1)},s}(jt),Mn=function(n){function s(){n.apply(this,arguments)}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype.getDefault=function(){var o=this.gl;return[0,0,o.drawingBufferWidth,o.drawingBufferHeight]},s.prototype.set=function(o){var c=this.current;(o[0]!==c[0]||o[1]!==c[1]||o[2]!==c[2]||o[3]!==c[3]||this.dirty)&&(this.gl.viewport(o[0],o[1],o[2],o[3]),this.current=o,this.dirty=!1)},s}(jt),Wn=function(n){function s(){n.apply(this,arguments)}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype.getDefault=function(){return null},s.prototype.set=function(o){if(o!==this.current||this.dirty){var c=this.gl;c.bindFramebuffer(c.FRAMEBUFFER,o),this.current=o,this.dirty=!1}},s}(jt),Hr=function(n){function s(){n.apply(this,arguments)}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype.getDefault=function(){return null},s.prototype.set=function(o){if(o!==this.current||this.dirty){var c=this.gl;c.bindRenderbuffer(c.RENDERBUFFER,o),this.current=o,this.dirty=!1}},s}(jt),ra=function(n){function s(){n.apply(this,arguments)}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype.getDefault=function(){return null},s.prototype.set=function(o){if(o!==this.current||this.dirty){var c=this.gl;c.bindTexture(c.TEXTURE_2D,o),this.current=o,this.dirty=!1}},s}(jt),Dn=function(n){function s(){n.apply(this,arguments)}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype.getDefault=function(){return null},s.prototype.set=function(o){if(o!==this.current||this.dirty){var c=this.gl;c.bindBuffer(c.ARRAY_BUFFER,o),this.current=o,this.dirty=!1}},s}(jt),ti=function(n){function s(){n.apply(this,arguments)}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype.getDefault=function(){return null},s.prototype.set=function(o){var c=this.gl;c.bindBuffer(c.ELEMENT_ARRAY_BUFFER,o),this.current=o,this.dirty=!1},s}(jt),re=function(n){function s(o){n.call(this,o),this.vao=o.extVertexArrayObject}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype.getDefault=function(){return null},s.prototype.set=function(o){this.vao&&(o!==this.current||this.dirty)&&(this.vao.bindVertexArrayOES(o),this.current=o,this.dirty=!1)},s}(jt),dt=function(n){function s(){n.apply(this,arguments)}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype.getDefault=function(){return 4},s.prototype.set=function(o){if(o!==this.current||this.dirty){var c=this.gl;c.pixelStorei(c.UNPACK_ALIGNMENT,o),this.current=o,this.dirty=!1}},s}(jt),Zi=function(n){function s(){n.apply(this,arguments)}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype.getDefault=function(){return!1},s.prototype.set=function(o){if(o!==this.current||this.dirty){var c=this.gl;c.pixelStorei(c.UNPACK_PREMULTIPLY_ALPHA_WEBGL,o),this.current=o,this.dirty=!1}},s}(jt),ri=function(n){function s(){n.apply(this,arguments)}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype.getDefault=function(){return!1},s.prototype.set=function(o){if(o!==this.current||this.dirty){var c=this.gl;c.pixelStorei(c.UNPACK_FLIP_Y_WEBGL,o),this.current=o,this.dirty=!1}},s}(jt),dr=function(n){function s(o,c){n.call(this,o),this.context=o,this.parent=c}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype.getDefault=function(){return null},s}(jt),R=function(n){function s(){n.apply(this,arguments)}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype.setDirty=function(){this.dirty=!0},s.prototype.set=function(o){if(o!==this.current||this.dirty){this.context.bindFramebuffer.set(this.parent);var c=this.gl;c.framebufferTexture2D(c.FRAMEBUFFER,c.COLOR_ATTACHMENT0,c.TEXTURE_2D,o,0),this.current=o,this.dirty=!1}},s}(dr),N=function(n){function s(){n.apply(this,arguments)}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype.set=function(o){if(o!==this.current||this.dirty){this.context.bindFramebuffer.set(this.parent);var c=this.gl;c.framebufferRenderbuffer(c.FRAMEBUFFER,c.DEPTH_ATTACHMENT,c.RENDERBUFFER,o),this.current=o,this.dirty=!1}},s}(dr),V=function(n,s,o,c){this.context=n,this.width=s,this.height=o;var _=this.framebuffer=n.gl.createFramebuffer();this.colorAttachment=new R(n,_),c&&(this.depthAttachment=new N(n,_))};V.prototype.destroy=function(){var n=this.context.gl,s=this.colorAttachment.get();if(s&&n.deleteTexture(s),this.depthAttachment){var o=this.depthAttachment.get();o&&n.deleteRenderbuffer(o)}n.deleteFramebuffer(this.framebuffer)};var K=function(n,s,o){this.func=n,this.mask=s,this.range=o};K.ReadOnly=!1,K.ReadWrite=!0,K.disabled=new K(519,K.ReadOnly,[0,1]);var W=function(n,s,o,c,_,w){this.test=n,this.ref=s,this.mask=o,this.fail=c,this.depthFail=_,this.pass=w};W.disabled=new W({func:519,mask:0},0,0,7680,7680,7680);var se=function(n,s,o){this.blendFunction=n,this.blendColor=s,this.mask=o};se.disabled=new se(se.Replace=[1,0],a.Color.transparent,[!1,!1,!1,!1]),se.unblended=new se(se.Replace,a.Color.transparent,[!0,!0,!0,!0]),se.alphaBlended=new se([1,771],a.Color.transparent,[!0,!0,!0,!0]);var pe=function(n,s,o){this.enable=n,this.mode=s,this.frontFace=o};pe.disabled=new pe(!1,1029,2305),pe.backCCW=new pe(!0,1029,2305);var q=function(n){this.gl=n,this.extVertexArrayObject=this.gl.getExtension("OES_vertex_array_object"),this.clearColor=new yn(this),this.clearDepth=new Qr(this),this.clearStencil=new vi(this),this.colorMask=new Tn(this),this.depthMask=new Er(this),this.stencilMask=new zi(this),this.stencilFunc=new ci(this),this.stencilOp=new hi(this),this.stencilTest=new sn(this),this.depthRange=new qr(this),this.depthTest=new pi(this),this.depthFunc=new fi(this),this.blend=new bi(this),this.blendFunc=new Bi(this),this.blendColor=new Xn(this),this.blendEquation=new qi(this),this.cullFace=new ji(this),this.cullFaceSide=new jr(this),this.frontFace=new ta(this),this.program=new gn(this),this.activeTexture=new xi(this),this.viewport=new Mn(this),this.bindFramebuffer=new Wn(this),this.bindRenderbuffer=new Hr(this),this.bindTexture=new ra(this),this.bindVertexBuffer=new Dn(this),this.bindElementBuffer=new ti(this),this.bindVertexArrayOES=this.extVertexArrayObject&&new re(this),this.pixelStoreUnpack=new dt(this),this.pixelStoreUnpackPremultiplyAlpha=new Zi(this),this.pixelStoreUnpackFlipY=new ri(this),this.extTextureFilterAnisotropic=n.getExtension("EXT_texture_filter_anisotropic")||n.getExtension("MOZ_EXT_texture_filter_anisotropic")||n.getExtension("WEBKIT_EXT_texture_filter_anisotropic"),this.extTextureFilterAnisotropic&&(this.extTextureFilterAnisotropicMax=n.getParameter(this.extTextureFilterAnisotropic.MAX_TEXTURE_MAX_ANISOTROPY_EXT)),this.extTextureHalfFloat=n.getExtension("OES_texture_half_float"),this.extTextureHalfFloat&&(n.getExtension("OES_texture_half_float_linear"),this.extRenderToTextureHalfFloat=n.getExtension("EXT_color_buffer_half_float")),this.extTimerQuery=n.getExtension("EXT_disjoint_timer_query"),this.maxTextureSize=n.getParameter(n.MAX_TEXTURE_SIZE)};q.prototype.setDefault=function(){this.unbindVAO(),this.clearColor.setDefault(),this.clearDepth.setDefault(),this.clearStencil.setDefault(),this.colorMask.setDefault(),this.depthMask.setDefault(),this.stencilMask.setDefault(),this.stencilFunc.setDefault(),this.stencilOp.setDefault(),this.stencilTest.setDefault(),this.depthRange.setDefault(),this.depthTest.setDefault(),this.depthFunc.setDefault(),this.blend.setDefault(),this.blendFunc.setDefault(),this.blendColor.setDefault(),this.blendEquation.setDefault(),this.cullFace.setDefault(),this.cullFaceSide.setDefault(),this.frontFace.setDefault(),this.program.setDefault(),this.activeTexture.setDefault(),this.bindFramebuffer.setDefault(),this.pixelStoreUnpack.setDefault(),this.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.pixelStoreUnpackFlipY.setDefault()},q.prototype.setDirty=function(){this.clearColor.dirty=!0,this.clearDepth.dirty=!0,this.clearStencil.dirty=!0,this.colorMask.dirty=!0,this.depthMask.dirty=!0,this.stencilMask.dirty=!0,this.stencilFunc.dirty=!0,this.stencilOp.dirty=!0,this.stencilTest.dirty=!0,this.depthRange.dirty=!0,this.depthTest.dirty=!0,this.depthFunc.dirty=!0,this.blend.dirty=!0,this.blendFunc.dirty=!0,this.blendColor.dirty=!0,this.blendEquation.dirty=!0,this.cullFace.dirty=!0,this.cullFaceSide.dirty=!0,this.frontFace.dirty=!0,this.program.dirty=!0,this.activeTexture.dirty=!0,this.viewport.dirty=!0,this.bindFramebuffer.dirty=!0,this.bindRenderbuffer.dirty=!0,this.bindTexture.dirty=!0,this.bindVertexBuffer.dirty=!0,this.bindElementBuffer.dirty=!0,this.extVertexArrayObject&&(this.bindVertexArrayOES.dirty=!0),this.pixelStoreUnpack.dirty=!0,this.pixelStoreUnpackPremultiplyAlpha.dirty=!0,this.pixelStoreUnpackFlipY.dirty=!0},q.prototype.createIndexBuffer=function(n,s){return new ui(this,n,s)},q.prototype.createVertexBuffer=function(n,s,o){return new tn(this,n,s,o)},q.prototype.createRenderbuffer=function(n,s,o){var c=this.gl,_=c.createRenderbuffer();return this.bindRenderbuffer.set(_),c.renderbufferStorage(c.RENDERBUFFER,n,s,o),this.bindRenderbuffer.set(null),_},q.prototype.createFramebuffer=function(n,s,o){return new V(this,n,s,o)},q.prototype.clear=function(n){var s=n.color,o=n.depth,c=this.gl,_=0;s&&(_|=c.COLOR_BUFFER_BIT,this.clearColor.set(s),this.colorMask.set([!0,!0,!0,!0])),o!==void 0&&(_|=c.DEPTH_BUFFER_BIT,this.depthRange.set([0,1]),this.clearDepth.set(o),this.depthMask.set(!0)),c.clear(_)},q.prototype.setCullFace=function(n){n.enable===!1?this.cullFace.set(!1):(this.cullFace.set(!0),this.cullFaceSide.set(n.mode),this.frontFace.set(n.frontFace))},q.prototype.setDepthMode=function(n){n.func!==this.gl.ALWAYS||n.mask?(this.depthTest.set(!0),this.depthFunc.set(n.func),this.depthMask.set(n.mask),this.depthRange.set(n.range)):this.depthTest.set(!1)},q.prototype.setStencilMode=function(n){n.test.func!==this.gl.ALWAYS||n.mask?(this.stencilTest.set(!0),this.stencilMask.set(n.mask),this.stencilOp.set([n.fail,n.depthFail,n.pass]),this.stencilFunc.set({func:n.test.func,ref:n.ref,mask:n.test.mask})):this.stencilTest.set(!1)},q.prototype.setColorMode=function(n){a.deepEqual(n.blendFunction,se.Replace)?this.blend.set(!1):(this.blend.set(!0),this.blendFunc.set(n.blendFunction),this.blendColor.set(n.blendColor)),this.colorMask.set(n.mask)},q.prototype.unbindVAO=function(){this.extVertexArrayObject&&this.bindVertexArrayOES.set(null)};var ee=function(n){function s(o,c,_){var w=this;n.call(this),this.id=o,this.dispatcher=_,this.on("data",function(S){S.dataType==="source"&&S.sourceDataType==="metadata"&&(w._sourceLoaded=!0),w._sourceLoaded&&!w._paused&&S.dataType==="source"&&S.sourceDataType==="content"&&(w.reload(),w.transform&&w.update(w.transform))}),this.on("error",function(){w._sourceErrored=!0}),this._source=function(S,E,P,O){var Z=new er[E.type](S,E,P,O);if(Z.id!==S)throw new Error("Expected Source id to be "+S+" instead of "+Z.id);return a.bindAll(["load","abort","unload","serialize","prepare"],Z),Z}(o,c,_,this),this._tiles={},this._cache=new Wt(0,this._unloadTile.bind(this)),this._timers={},this._cacheTimers={},this._maxTileCacheSize=null,this._loadedParentTiles={},this._coveredTiles={},this._state=new a.SourceFeatureState}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype.onAdd=function(o){this.map=o,this._maxTileCacheSize=o?o._maxTileCacheSize:null,this._source&&this._source.onAdd&&this._source.onAdd(o)},s.prototype.onRemove=function(o){this._source&&this._source.onRemove&&this._source.onRemove(o)},s.prototype.loaded=function(){if(this._sourceErrored)return!0;if(!this._sourceLoaded||!this._source.loaded())return!1;for(var o in this._tiles){var c=this._tiles[o];if(c.state!=="loaded"&&c.state!=="errored")return!1}return!0},s.prototype.getSource=function(){return this._source},s.prototype.pause=function(){this._paused=!0},s.prototype.resume=function(){if(this._paused){var o=this._shouldReloadOnResume;this._paused=!1,this._shouldReloadOnResume=!1,o&&this.reload(),this.transform&&this.update(this.transform)}},s.prototype._loadTile=function(o,c){return this._source.loadTile(o,c)},s.prototype._unloadTile=function(o){if(this._source.unloadTile)return this._source.unloadTile(o,function(){})},s.prototype._abortTile=function(o){if(this._source.abortTile)return this._source.abortTile(o,function(){})},s.prototype.serialize=function(){return this._source.serialize()},s.prototype.prepare=function(o){for(var c in this._source.prepare&&this._source.prepare(),this._state.coalesceChanges(this._tiles,this.map?this.map.painter:null),this._tiles){var _=this._tiles[c];_.upload(o),_.prepare(this.map.style.imageManager)}},s.prototype.getIds=function(){return a.values(this._tiles).map(function(o){return o.tileID}).sort(ye).map(function(o){return o.key})},s.prototype.getRenderableIds=function(o){var c=this,_=[];for(var w in this._tiles)this._isIdRenderable(w,o)&&_.push(this._tiles[w]);return o?_.sort(function(S,E){var P=S.tileID,O=E.tileID,Z=new a.Point(P.canonical.x,P.canonical.y)._rotate(c.transform.angle),G=new a.Point(O.canonical.x,O.canonical.y)._rotate(c.transform.angle);return P.overscaledZ-O.overscaledZ||G.y-Z.y||G.x-Z.x}).map(function(S){return S.tileID.key}):_.map(function(S){return S.tileID}).sort(ye).map(function(S){return S.key})},s.prototype.hasRenderableParent=function(o){var c=this.findLoadedParent(o,0);return!!c&&this._isIdRenderable(c.tileID.key)},s.prototype._isIdRenderable=function(o,c){return this._tiles[o]&&this._tiles[o].hasData()&&!this._coveredTiles[o]&&(c||!this._tiles[o].holdingForFade())},s.prototype.reload=function(){if(this._paused)this._shouldReloadOnResume=!0;else for(var o in this._cache.reset(),this._tiles)this._tiles[o].state!=="errored"&&this._reloadTile(o,"reloading")},s.prototype._reloadTile=function(o,c){var _=this._tiles[o];_&&(_.state!=="loading"&&(_.state=c),this._loadTile(_,this._tileLoaded.bind(this,_,o,c)))},s.prototype._tileLoaded=function(o,c,_,w){if(w)return o.state="errored",void(w.status!==404?this._source.fire(new a.ErrorEvent(w,{tile:o})):this.update(this.transform));o.timeAdded=a.browser.now(),_==="expired"&&(o.refreshedUponExpiration=!0),this._setTileReloadTimer(c,o),this.getSource().type==="raster-dem"&&o.dem&&this._backfillDEM(o),this._state.initializeTileState(o,this.map?this.map.painter:null),this._source.fire(new a.Event("data",{dataType:"source",tile:o,coord:o.tileID}))},s.prototype._backfillDEM=function(o){for(var c=this.getRenderableIds(),_=0;_<c.length;_++){var w=c[_];if(o.neighboringTiles&&o.neighboringTiles[w]){var S=this.getTileByID(w);E(o,S),E(S,o)}}function E(P,O){P.needsHillshadePrepare=!0;var Z=O.tileID.canonical.x-P.tileID.canonical.x,G=O.tileID.canonical.y-P.tileID.canonical.y,H=Math.pow(2,P.tileID.canonical.z),te=O.tileID.key;Z===0&&G===0||Math.abs(G)>1||(Math.abs(Z)>1&&(Math.abs(Z+H)===1?Z+=H:Math.abs(Z-H)===1&&(Z-=H)),O.dem&&P.dem&&(P.dem.backfillBorder(O.dem,Z,G),P.neighboringTiles&&P.neighboringTiles[te]&&(P.neighboringTiles[te].backfilled=!0)))}},s.prototype.getTile=function(o){return this.getTileByID(o.key)},s.prototype.getTileByID=function(o){return this._tiles[o]},s.prototype._retainLoadedChildren=function(o,c,_,w){for(var S in this._tiles){var E=this._tiles[S];if(!(w[S]||!E.hasData()||E.tileID.overscaledZ<=c||E.tileID.overscaledZ>_)){for(var P=E.tileID;E&&E.tileID.overscaledZ>c+1;){var O=E.tileID.scaledTo(E.tileID.overscaledZ-1);(E=this._tiles[O.key])&&E.hasData()&&(P=O)}for(var Z=P;Z.overscaledZ>c;)if(o[(Z=Z.scaledTo(Z.overscaledZ-1)).key]){w[P.key]=P;break}}}},s.prototype.findLoadedParent=function(o,c){if(o.key in this._loadedParentTiles){var _=this._loadedParentTiles[o.key];return _&&_.tileID.overscaledZ>=c?_:null}for(var w=o.overscaledZ-1;w>=c;w--){var S=o.scaledTo(w),E=this._getLoadedTile(S);if(E)return E}},s.prototype._getLoadedTile=function(o){var c=this._tiles[o.key];return c&&c.hasData()?c:this._cache.getByKey(o.wrapped().key)},s.prototype.updateCacheSize=function(o){var c=Math.ceil(o.width/this._source.tileSize)+1,_=Math.ceil(o.height/this._source.tileSize)+1,w=Math.floor(c*_*5),S=typeof this._maxTileCacheSize=="number"?Math.min(this._maxTileCacheSize,w):w;this._cache.setMaxSize(S)},s.prototype.handleWrapJump=function(o){var c=Math.round((o-(this._prevLng===void 0?o:this._prevLng))/360);if(this._prevLng=o,c){var _={};for(var w in this._tiles){var S=this._tiles[w];S.tileID=S.tileID.unwrapTo(S.tileID.wrap+c),_[S.tileID.key]=S}for(var E in this._tiles=_,this._timers)clearTimeout(this._timers[E]),delete this._timers[E];for(var P in this._tiles)this._setTileReloadTimer(P,this._tiles[P])}},s.prototype.update=function(o){var c=this;if(this.transform=o,this._sourceLoaded&&!this._paused){var _;this.updateCacheSize(o),this.handleWrapJump(this.transform.center.lng),this._coveredTiles={},this.used?this._source.tileID?_=o.getVisibleUnwrappedCoordinates(this._source.tileID).map(function(Oe){return new a.OverscaledTileID(Oe.canonical.z,Oe.wrap,Oe.canonical.z,Oe.canonical.x,Oe.canonical.y)}):(_=o.coveringTiles({tileSize:this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this._source.roundZoom,reparseOverscaled:this._source.reparseOverscaled}),this._source.hasTile&&(_=_.filter(function(Oe){return c._source.hasTile(Oe)}))):_=[];var w=o.coveringZoomLevel(this._source),S=Math.max(w-s.maxOverzooming,this._source.minzoom),E=Math.max(w+s.maxUnderzooming,this._source.minzoom),P=this._updateRetainedTiles(_,w);if(Pe(this._source.type)){for(var O={},Z={},G=0,H=Object.keys(P);G<H.length;G+=1){var te=H[G],$=P[te],ue=this._tiles[te];if(ue&&!(ue.fadeEndTime&&ue.fadeEndTime<=a.browser.now())){var Y=this.findLoadedParent($,S);Y&&(this._addTile(Y.tileID),O[Y.tileID.key]=Y.tileID),Z[te]=$}}for(var le in this._retainLoadedChildren(Z,w,E,P),O)P[le]||(this._coveredTiles[le]=!0,P[le]=O[le])}for(var fe in P)this._tiles[fe].clearFadeHold();for(var _e=0,Te=a.keysDifference(this._tiles,P);_e<Te.length;_e+=1){var ke=Te[_e],Ae=this._tiles[ke];Ae.hasSymbolBuckets&&!Ae.holdingForFade()?Ae.setHoldDuration(this.map._fadeDuration):Ae.hasSymbolBuckets&&!Ae.symbolFadeFinished()||this._removeTile(ke)}this._updateLoadedParentTileCache()}},s.prototype.releaseSymbolFadeTiles=function(){for(var o in this._tiles)this._tiles[o].holdingForFade()&&this._removeTile(o)},s.prototype._updateRetainedTiles=function(o,c){for(var _={},w={},S=Math.max(c-s.maxOverzooming,this._source.minzoom),E=Math.max(c+s.maxUnderzooming,this._source.minzoom),P={},O=0,Z=o;O<Z.length;O+=1){var G=Z[O],H=this._addTile(G);_[G.key]=G,H.hasData()||c<this._source.maxzoom&&(P[G.key]=G)}this._retainLoadedChildren(P,c,E,_);for(var te=0,$=o;te<$.length;te+=1){var ue=$[te],Y=this._tiles[ue.key];if(!Y.hasData()){if(c+1>this._source.maxzoom){var le=ue.children(this._source.maxzoom)[0],fe=this.getTile(le);if(fe&&fe.hasData()){_[le.key]=le;continue}}else{var _e=ue.children(this._source.maxzoom);if(_[_e[0].key]&&_[_e[1].key]&&_[_e[2].key]&&_[_e[3].key])continue}for(var Te=Y.wasRequested(),ke=ue.overscaledZ-1;ke>=S;--ke){var Ae=ue.scaledTo(ke);if(w[Ae.key]||(w[Ae.key]=!0,!(Y=this.getTile(Ae))&&Te&&(Y=this._addTile(Ae)),Y&&(_[Ae.key]=Ae,Te=Y.wasRequested(),Y.hasData())))break}}}return _},s.prototype._updateLoadedParentTileCache=function(){for(var o in this._loadedParentTiles={},this._tiles){for(var c=[],_=void 0,w=this._tiles[o].tileID;w.overscaledZ>0;){if(w.key in this._loadedParentTiles){_=this._loadedParentTiles[w.key];break}c.push(w.key);var S=w.scaledTo(w.overscaledZ-1);if(_=this._getLoadedTile(S))break;w=S}for(var E=0,P=c;E<P.length;E+=1)this._loadedParentTiles[P[E]]=_}},s.prototype._addTile=function(o){var c=this._tiles[o.key];if(c)return c;(c=this._cache.getAndRemove(o))&&(this._setTileReloadTimer(o.key,c),c.tileID=o,this._state.initializeTileState(c,this.map?this.map.painter:null),this._cacheTimers[o.key]&&(clearTimeout(this._cacheTimers[o.key]),delete this._cacheTimers[o.key],this._setTileReloadTimer(o.key,c)));var _=!!c;return _||(c=new a.Tile(o,this._source.tileSize*o.overscaleFactor()),this._loadTile(c,this._tileLoaded.bind(this,c,o.key,c.state))),c?(c.uses++,this._tiles[o.key]=c,_||this._source.fire(new a.Event("dataloading",{tile:c,coord:c.tileID,dataType:"source"})),c):null},s.prototype._setTileReloadTimer=function(o,c){var _=this;o in this._timers&&(clearTimeout(this._timers[o]),delete this._timers[o]);var w=c.getExpiryTimeout();w&&(this._timers[o]=setTimeout(function(){_._reloadTile(o,"expired"),delete _._timers[o]},w))},s.prototype._removeTile=function(o){var c=this._tiles[o];c&&(c.uses--,delete this._tiles[o],this._timers[o]&&(clearTimeout(this._timers[o]),delete this._timers[o]),c.uses>0||(c.hasData()&&c.state!=="reloading"?this._cache.add(c.tileID,c,c.getExpiryTimeout()):(c.aborted=!0,this._abortTile(c),this._unloadTile(c))))},s.prototype.clearTiles=function(){for(var o in this._shouldReloadOnResume=!1,this._paused=!1,this._tiles)this._removeTile(o);this._cache.reset()},s.prototype.tilesIn=function(o,c,_){var w=this,S=[],E=this.transform;if(!E)return S;for(var P=_?E.getCameraQueryGeometry(o):o,O=o.map(function(ke){return E.pointCoordinate(ke)}),Z=P.map(function(ke){return E.pointCoordinate(ke)}),G=this.getIds(),H=1/0,te=1/0,$=-1/0,ue=-1/0,Y=0,le=Z;Y<le.length;Y+=1){var fe=le[Y];H=Math.min(H,fe.x),te=Math.min(te,fe.y),$=Math.max($,fe.x),ue=Math.max(ue,fe.y)}for(var _e=function(ke){var Ae=w._tiles[G[ke]];if(!Ae.holdingForFade()){var Oe=Ae.tileID,He=Math.pow(2,E.zoom-Ae.tileID.overscaledZ),Ge=c*Ae.queryPadding*a.EXTENT/Ae.tileSize/He,lt=[Oe.getTilePoint(new a.MercatorCoordinate(H,te)),Oe.getTilePoint(new a.MercatorCoordinate($,ue))];if(lt[0].x-Ge<a.EXTENT&&lt[0].y-Ge<a.EXTENT&&lt[1].x+Ge>=0&&lt[1].y+Ge>=0){var kt=O.map(function(Tt){return Oe.getTilePoint(Tt)}),It=Z.map(function(Tt){return Oe.getTilePoint(Tt)});S.push({tile:Ae,tileID:Oe,queryGeometry:kt,cameraQueryGeometry:It,scale:He})}}},Te=0;Te<G.length;Te++)_e(Te);return S},s.prototype.getVisibleCoordinates=function(o){for(var c=this,_=this.getRenderableIds(o).map(function(P){return c._tiles[P].tileID}),w=0,S=_;w<S.length;w+=1){var E=S[w];E.posMatrix=this.transform.calculatePosMatrix(E.toUnwrapped())}return _},s.prototype.hasTransition=function(){if(this._source.hasTransition())return!0;if(Pe(this._source.type))for(var o in this._tiles){var c=this._tiles[o];if(c.fadeEndTime!==void 0&&c.fadeEndTime>=a.browser.now())return!0}return!1},s.prototype.setFeatureState=function(o,c,_){this._state.updateState(o=o||"_geojsonTileLayer",c,_)},s.prototype.removeFeatureState=function(o,c,_){this._state.removeFeatureState(o=o||"_geojsonTileLayer",c,_)},s.prototype.getFeatureState=function(o,c){return this._state.getState(o=o||"_geojsonTileLayer",c)},s.prototype.setDependencies=function(o,c,_){var w=this._tiles[o];w&&w.setDependencies(c,_)},s.prototype.reloadTilesForDependencies=function(o,c){for(var _ in this._tiles)this._tiles[_].hasDependency(o,c)&&this._reloadTile(_,"reloading");this._cache.filter(function(w){return!w.hasDependency(o,c)})},s}(a.Evented);function ye(n,s){var o=Math.abs(2*n.wrap)-+(n.wrap<0),c=Math.abs(2*s.wrap)-+(s.wrap<0);return n.overscaledZ-s.overscaledZ||c-o||s.canonical.y-n.canonical.y||s.canonical.x-n.canonical.x}function Pe(n){return n==="raster"||n==="image"||n==="video"}function Fe(){return new a.window.Worker(il.workerUrl)}ee.maxOverzooming=10,ee.maxUnderzooming=3;var ze="mapboxgl_preloaded_worker_pool",Re=function(){this.active={}};Re.prototype.acquire=function(n){if(!this.workers)for(this.workers=[];this.workers.length<Re.workerCount;)this.workers.push(new Fe);return this.active[n]=!0,this.workers.slice()},Re.prototype.release=function(n){delete this.active[n],this.numActive()===0&&(this.workers.forEach(function(s){s.terminate()}),this.workers=null)},Re.prototype.isPreloaded=function(){return!!this.active[ze]},Re.prototype.numActive=function(){return Object.keys(this.active).length};var st,it=Math.floor(a.browser.hardwareConcurrency/2);function xe(){return st||(st=new Re),st}function tt(n,s){var o={};for(var c in n)c!=="ref"&&(o[c]=n[c]);return a.refProperties.forEach(function(_){_ in s&&(o[_]=s[_])}),o}function We(n){n=n.slice();for(var s=Object.create(null),o=0;o<n.length;o++)s[n[o].id]=n[o];for(var c=0;c<n.length;c++)"ref"in n[c]&&(n[c]=tt(n[c],s[n[c].ref]));return n}Re.workerCount=Math.max(Math.min(it,6),1);var $e={setStyle:"setStyle",addLayer:"addLayer",removeLayer:"removeLayer",setPaintProperty:"setPaintProperty",setLayoutProperty:"setLayoutProperty",setFilter:"setFilter",addSource:"addSource",removeSource:"removeSource",setGeoJSONSourceData:"setGeoJSONSourceData",setLayerZoomRange:"setLayerZoomRange",setLayerProperty:"setLayerProperty",setCenter:"setCenter",setZoom:"setZoom",setBearing:"setBearing",setPitch:"setPitch",setSprite:"setSprite",setGlyphs:"setGlyphs",setTransition:"setTransition",setLight:"setLight"};function Zt(n,s,o){o.push({command:$e.addSource,args:[n,s[n]]})}function rt(n,s,o){s.push({command:$e.removeSource,args:[n]}),o[n]=!0}function tr(n,s,o,c){rt(n,o,c),Zt(n,s,o)}function br(n,s,o){var c;for(c in n[o])if(n[o].hasOwnProperty(c)&&c!=="data"&&!a.deepEqual(n[o][c],s[o][c]))return!1;for(c in s[o])if(s[o].hasOwnProperty(c)&&c!=="data"&&!a.deepEqual(n[o][c],s[o][c]))return!1;return!0}function Ht(n,s,o,c,_,w){var S;for(S in s=s||{},n=n||{})n.hasOwnProperty(S)&&(a.deepEqual(n[S],s[S])||o.push({command:w,args:[c,S,s[S],_]}));for(S in s)s.hasOwnProperty(S)&&!n.hasOwnProperty(S)&&(a.deepEqual(n[S],s[S])||o.push({command:w,args:[c,S,s[S],_]}))}function hr(n){return n.id}function rr(n,s){return n[s.id]=s,n}var wi=function(n,s){this.reset(n,s)};wi.prototype.reset=function(n,s){this.points=n||[],this._distances=[0];for(var o=1;o<this.points.length;o++)this._distances[o]=this._distances[o-1]+this.points[o].dist(this.points[o-1]);this.length=this._distances[this._distances.length-1],this.padding=Math.min(s||0,.5*this.length),this.paddedLength=this.length-2*this.padding},wi.prototype.lerp=function(n){if(this.points.length===1)return this.points[0];n=a.clamp(n,0,1);for(var s=1,o=this._distances[s],c=n*this.paddedLength+this.padding;o<c&&s<this._distances.length;)o=this._distances[++s];var _=s-1,w=this._distances[_],S=o-w,E=S>0?(c-w)/S:0;return this.points[_].mult(1-E).add(this.points[s].mult(E))};var mr=function(n,s,o){var c=this.boxCells=[],_=this.circleCells=[];this.xCellCount=Math.ceil(n/o),this.yCellCount=Math.ceil(s/o);for(var w=0;w<this.xCellCount*this.yCellCount;w++)c.push([]),_.push([]);this.circleKeys=[],this.boxKeys=[],this.bboxes=[],this.circles=[],this.width=n,this.height=s,this.xScale=this.xCellCount/n,this.yScale=this.yCellCount/s,this.boxUid=0,this.circleUid=0};function Fr(n,s,o,c,_){var w=a.create();return s?(a.scale(w,w,[1/_,1/_,1]),o||a.rotateZ(w,w,c.angle)):a.multiply(w,c.labelPlaneMatrix,n),w}function vr(n,s,o,c,_){if(s){var w=a.clone(n);return a.scale(w,w,[_,_,1]),o||a.rotateZ(w,w,-c.angle),w}return c.glCoordMatrix}function Qt(n,s){var o=[n.x,n.y,0,1];ni(o,o,s);var c=o[3];return{point:new a.Point(o[0]/c,o[1]/c),signedDistanceFromCamera:c}}function pr(n,s){return .5+n/s*.5}function Ti(n,s){var o=n[0]/n[3],c=n[1]/n[3];return o>=-s[0]&&o<=s[0]&&c>=-s[1]&&c<=s[1]}function ha(n,s,o,c,_,w,S,E){var P=c?n.textSizeData:n.iconSizeData,O=a.evaluateSizeForZoom(P,o.transform.zoom),Z=[256/o.width*2+1,256/o.height*2+1],G=c?n.text.dynamicLayoutVertexArray:n.icon.dynamicLayoutVertexArray;G.clear();for(var H=n.lineVertexArray,te=c?n.text.placedSymbolArray:n.icon.placedSymbolArray,$=o.transform.width/o.transform.height,ue=!1,Y=0;Y<te.length;Y++){var le=te.get(Y);if(le.hidden||le.writingMode===a.WritingMode.vertical&&!ue)Ii(le.numGlyphs,G);else{ue=!1;var fe=[le.anchorX,le.anchorY,0,1];if(a.transformMat4(fe,fe,s),Ti(fe,Z)){var _e=pr(o.transform.cameraToCenterDistance,fe[3]),Te=a.evaluateSizeForFeature(P,O,le),ke=S?Te/_e:Te*_e,Ae=new a.Point(le.anchorX,le.anchorY),Oe=Qt(Ae,_).point,He={},Ge=Na(le,ke,!1,E,s,_,w,n.glyphOffsetArray,H,G,Oe,Ae,He,$);ue=Ge.useVertical,(Ge.notEnoughRoom||ue||Ge.needsFlipping&&Na(le,ke,!0,E,s,_,w,n.glyphOffsetArray,H,G,Oe,Ae,He,$).notEnoughRoom)&&Ii(le.numGlyphs,G)}else Ii(le.numGlyphs,G)}}c?n.text.dynamicLayoutVertexBuffer.updateData(G):n.icon.dynamicLayoutVertexBuffer.updateData(G)}function ii(n,s,o,c,_,w,S,E,P,O,Z){var G=E.glyphStartIndex+E.numGlyphs,H=E.lineStartIndex,te=E.lineStartIndex+E.lineLength,$=s.getoffsetX(E.glyphStartIndex),ue=s.getoffsetX(G-1),Y=Zr(n*$,o,c,_,w,S,E.segment,H,te,P,O,Z);if(!Y)return null;var le=Zr(n*ue,o,c,_,w,S,E.segment,H,te,P,O,Z);return le?{first:Y,last:le}:null}function Oi(n,s,o,c){return n===a.WritingMode.horizontal&&Math.abs(o.y-s.y)>Math.abs(o.x-s.x)*c?{useVertical:!0}:(n===a.WritingMode.vertical?s.y<o.y:s.x>o.x)?{needsFlipping:!0}:null}function Na(n,s,o,c,_,w,S,E,P,O,Z,G,H,te){var $,ue=s/24,Y=n.lineOffsetX*ue,le=n.lineOffsetY*ue;if(n.numGlyphs>1){var fe=n.glyphStartIndex+n.numGlyphs,_e=n.lineStartIndex,Te=n.lineStartIndex+n.lineLength,ke=ii(ue,E,Y,le,o,Z,G,n,P,w,H);if(!ke)return{notEnoughRoom:!0};var Ae=Qt(ke.first.point,S).point,Oe=Qt(ke.last.point,S).point;if(c&&!o){var He=Oi(n.writingMode,Ae,Oe,te);if(He)return He}$=[ke.first];for(var Ge=n.glyphStartIndex+1;Ge<fe-1;Ge++)$.push(Zr(ue*E.getoffsetX(Ge),Y,le,o,Z,G,n.segment,_e,Te,P,w,H));$.push(ke.last)}else{if(c&&!o){var lt=Qt(G,_).point,kt=n.lineStartIndex+n.segment+1,It=new a.Point(P.getx(kt),P.gety(kt)),Tt=Qt(It,_),gr=Tt.signedDistanceFromCamera>0?Tt.point:va(G,It,lt,1,_),pt=Oi(n.writingMode,lt,gr,te);if(pt)return pt}var Ut=Zr(ue*E.getoffsetX(n.glyphStartIndex),Y,le,o,Z,G,n.segment,n.lineStartIndex,n.lineStartIndex+n.lineLength,P,w,H);if(!Ut)return{notEnoughRoom:!0};$=[Ut]}for(var Yt=0,Ot=$;Yt<Ot.length;Yt+=1){var Bt=Ot[Yt];a.addDynamicAttributes(O,Bt.point,Bt.angle)}return{}}function va(n,s,o,c,_){var w=Qt(n.add(n.sub(s)._unit()),_).point,S=o.sub(w);return o.add(S._mult(c/S.mag()))}function Zr(n,s,o,c,_,w,S,E,P,O,Z,G){var H=c?n-s:n+s,te=H>0?1:-1,$=0;c&&(te*=-1,$=Math.PI),te<0&&($+=Math.PI);for(var ue=te>0?E+S:E+S+1,Y=_,le=_,fe=0,_e=0,Te=Math.abs(H),ke=[];fe+_e<=Te;){if((ue+=te)<E||ue>=P)return null;if(le=Y,ke.push(Y),(Y=G[ue])===void 0){var Ae=new a.Point(O.getx(ue),O.gety(ue)),Oe=Qt(Ae,Z);if(Oe.signedDistanceFromCamera>0)Y=G[ue]=Oe.point;else{var He=ue-te;Y=va(fe===0?w:new a.Point(O.getx(He),O.gety(He)),Ae,le,Te-fe+1,Z)}}fe+=_e,_e=le.dist(Y)}var Ge=(Te-fe)/_e,lt=Y.sub(le),kt=lt.mult(Ge)._add(le);kt._add(lt._unit()._perp()._mult(o*te));var It=$+Math.atan2(Y.y-le.y,Y.x-le.x);return ke.push(kt),{point:kt,angle:It,path:ke}}mr.prototype.keysLength=function(){return this.boxKeys.length+this.circleKeys.length},mr.prototype.insert=function(n,s,o,c,_){this._forEachCell(s,o,c,_,this._insertBoxCell,this.boxUid++),this.boxKeys.push(n),this.bboxes.push(s),this.bboxes.push(o),this.bboxes.push(c),this.bboxes.push(_)},mr.prototype.insertCircle=function(n,s,o,c){this._forEachCell(s-c,o-c,s+c,o+c,this._insertCircleCell,this.circleUid++),this.circleKeys.push(n),this.circles.push(s),this.circles.push(o),this.circles.push(c)},mr.prototype._insertBoxCell=function(n,s,o,c,_,w){this.boxCells[_].push(w)},mr.prototype._insertCircleCell=function(n,s,o,c,_,w){this.circleCells[_].push(w)},mr.prototype._query=function(n,s,o,c,_,w){if(o<0||n>this.width||c<0||s>this.height)return!_&&[];var S=[];if(n<=0&&s<=0&&this.width<=o&&this.height<=c){if(_)return!0;for(var E=0;E<this.boxKeys.length;E++)S.push({key:this.boxKeys[E],x1:this.bboxes[4*E],y1:this.bboxes[4*E+1],x2:this.bboxes[4*E+2],y2:this.bboxes[4*E+3]});for(var P=0;P<this.circleKeys.length;P++){var O=this.circles[3*P],Z=this.circles[3*P+1],G=this.circles[3*P+2];S.push({key:this.circleKeys[P],x1:O-G,y1:Z-G,x2:O+G,y2:Z+G})}return w?S.filter(w):S}return this._forEachCell(n,s,o,c,this._queryCell,S,{hitTest:_,seenUids:{box:{},circle:{}}},w),_?S.length>0:S},mr.prototype._queryCircle=function(n,s,o,c,_){var w=n-o,S=n+o,E=s-o,P=s+o;if(S<0||w>this.width||P<0||E>this.height)return!c&&[];var O=[];return this._forEachCell(w,E,S,P,this._queryCellCircle,O,{hitTest:c,circle:{x:n,y:s,radius:o},seenUids:{box:{},circle:{}}},_),c?O.length>0:O},mr.prototype.query=function(n,s,o,c,_){return this._query(n,s,o,c,!1,_)},mr.prototype.hitTest=function(n,s,o,c,_){return this._query(n,s,o,c,!0,_)},mr.prototype.hitTestCircle=function(n,s,o,c){return this._queryCircle(n,s,o,!0,c)},mr.prototype._queryCell=function(n,s,o,c,_,w,S,E){var P=S.seenUids,O=this.boxCells[_];if(O!==null)for(var Z=this.bboxes,G=0,H=O;G<H.length;G+=1){var te=H[G];if(!P.box[te]){P.box[te]=!0;var $=4*te;if(n<=Z[$+2]&&s<=Z[$+3]&&o>=Z[$+0]&&c>=Z[$+1]&&(!E||E(this.boxKeys[te]))){if(S.hitTest)return w.push(!0),!0;w.push({key:this.boxKeys[te],x1:Z[$],y1:Z[$+1],x2:Z[$+2],y2:Z[$+3]})}}}var ue=this.circleCells[_];if(ue!==null)for(var Y=this.circles,le=0,fe=ue;le<fe.length;le+=1){var _e=fe[le];if(!P.circle[_e]){P.circle[_e]=!0;var Te=3*_e;if(this._circleAndRectCollide(Y[Te],Y[Te+1],Y[Te+2],n,s,o,c)&&(!E||E(this.circleKeys[_e]))){if(S.hitTest)return w.push(!0),!0;var ke=Y[Te],Ae=Y[Te+1],Oe=Y[Te+2];w.push({key:this.circleKeys[_e],x1:ke-Oe,y1:Ae-Oe,x2:ke+Oe,y2:Ae+Oe})}}}},mr.prototype._queryCellCircle=function(n,s,o,c,_,w,S,E){var P=S.circle,O=S.seenUids,Z=this.boxCells[_];if(Z!==null)for(var G=this.bboxes,H=0,te=Z;H<te.length;H+=1){var $=te[H];if(!O.box[$]){O.box[$]=!0;var ue=4*$;if(this._circleAndRectCollide(P.x,P.y,P.radius,G[ue+0],G[ue+1],G[ue+2],G[ue+3])&&(!E||E(this.boxKeys[$])))return w.push(!0),!0}}var Y=this.circleCells[_];if(Y!==null)for(var le=this.circles,fe=0,_e=Y;fe<_e.length;fe+=1){var Te=_e[fe];if(!O.circle[Te]){O.circle[Te]=!0;var ke=3*Te;if(this._circlesCollide(le[ke],le[ke+1],le[ke+2],P.x,P.y,P.radius)&&(!E||E(this.circleKeys[Te])))return w.push(!0),!0}}},mr.prototype._forEachCell=function(n,s,o,c,_,w,S,E){for(var P=this._convertToXCellCoord(n),O=this._convertToYCellCoord(s),Z=this._convertToXCellCoord(o),G=this._convertToYCellCoord(c),H=P;H<=Z;H++)for(var te=O;te<=G;te++)if(_.call(this,n,s,o,c,this.xCellCount*te+H,w,S,E))return},mr.prototype._convertToXCellCoord=function(n){return Math.max(0,Math.min(this.xCellCount-1,Math.floor(n*this.xScale)))},mr.prototype._convertToYCellCoord=function(n){return Math.max(0,Math.min(this.yCellCount-1,Math.floor(n*this.yScale)))},mr.prototype._circlesCollide=function(n,s,o,c,_,w){var S=c-n,E=_-s,P=o+w;return P*P>S*S+E*E},mr.prototype._circleAndRectCollide=function(n,s,o,c,_,w,S){var E=(w-c)/2,P=Math.abs(n-(c+E));if(P>E+o)return!1;var O=(S-_)/2,Z=Math.abs(s-(_+O));if(Z>O+o)return!1;if(P<=E||Z<=O)return!0;var G=P-E,H=Z-O;return G*G+H*H<=o*o};var ba=new Float32Array([-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0]);function Ii(n,s){for(var o=0;o<n;o++){var c=s.length;s.resize(c+4),s.float32.set(ba,3*c)}}function ni(n,s,o){var c=s[0],_=s[1];return n[0]=o[0]*c+o[4]*_+o[12],n[1]=o[1]*c+o[5]*_+o[13],n[3]=o[3]*c+o[7]*_+o[15],n}var ln=function(n,s,o){s===void 0&&(s=new mr(n.width+200,n.height+200,25)),o===void 0&&(o=new mr(n.width+200,n.height+200,25)),this.transform=n,this.grid=s,this.ignoredGrid=o,this.pitchfactor=Math.cos(n._pitch)*n.cameraToCenterDistance,this.screenRightBoundary=n.width+100,this.screenBottomBoundary=n.height+100,this.gridRightBoundary=n.width+200,this.gridBottomBoundary=n.height+200};function Dr(n,s,o){return s*(a.EXTENT/(n.tileSize*Math.pow(2,o-n.tileID.overscaledZ)))}ln.prototype.placeCollisionBox=function(n,s,o,c,_){var w=this.projectAndGetPerspectiveRatio(c,n.anchorPointX,n.anchorPointY),S=o*w.perspectiveRatio,E=n.x1*S+w.point.x,P=n.y1*S+w.point.y,O=n.x2*S+w.point.x,Z=n.y2*S+w.point.y;return!this.isInsideGrid(E,P,O,Z)||!s&&this.grid.hitTest(E,P,O,Z,_)?{box:[],offscreen:!1}:{box:[E,P,O,Z],offscreen:this.isOffscreen(E,P,O,Z)}},ln.prototype.placeCollisionCircles=function(n,s,o,c,_,w,S,E,P,O,Z,G,H){var te=[],$=new a.Point(s.anchorX,s.anchorY),ue=Qt($,w),Y=pr(this.transform.cameraToCenterDistance,ue.signedDistanceFromCamera),le=(O?_/Y:_*Y)/a.ONE_EM,fe=Qt($,S).point,_e=ii(le,c,s.lineOffsetX*le,s.lineOffsetY*le,!1,fe,$,s,o,S,{}),Te=!1,ke=!1,Ae=!0;if(_e){for(var Oe=.5*G*Y+H,He=new a.Point(-100,-100),Ge=new a.Point(this.screenRightBoundary,this.screenBottomBoundary),lt=new wi,kt=_e.first,It=_e.last,Tt=[],gr=kt.path.length-1;gr>=1;gr--)Tt.push(kt.path[gr]);for(var pt=1;pt<It.path.length;pt++)Tt.push(It.path[pt]);var Ut=2.5*Oe;if(E){var Yt=Tt.map(function(oa){return Qt(oa,E)});Tt=Yt.some(function(oa){return oa.signedDistanceFromCamera<=0})?[]:Yt.map(function(oa){return oa.point})}var Ot=[];if(Tt.length>0){for(var Bt=Tt[0].clone(),Xt=Tt[0].clone(),Rt=1;Rt<Tt.length;Rt++)Bt.x=Math.min(Bt.x,Tt[Rt].x),Bt.y=Math.min(Bt.y,Tt[Rt].y),Xt.x=Math.max(Xt.x,Tt[Rt].x),Xt.y=Math.max(Xt.y,Tt[Rt].y);Ot=Bt.x>=He.x&&Xt.x<=Ge.x&&Bt.y>=He.y&&Xt.y<=Ge.y?[Tt]:Xt.x<He.x||Bt.x>Ge.x||Xt.y<He.y||Bt.y>Ge.y?[]:a.clipLine([Tt],He.x,He.y,Ge.x,Ge.y)}for(var Mt=0,Fi=Ot;Mt<Fi.length;Mt+=1){var ai;lt.reset(Fi[Mt],.25*Oe),ai=lt.length<=.5*Oe?1:Math.ceil(lt.paddedLength/Ut)+1;for(var cn=0;cn<ai;cn++){var Wi=cn/Math.max(ai-1,1),$r=lt.lerp(Wi),di=$r.x+100,qn=$r.y+100;te.push(di,qn,Oe,0);var xn=di-Oe,Qa=qn-Oe,In=di+Oe,ga=qn+Oe;if(Ae=Ae&&this.isOffscreen(xn,Qa,In,ga),ke=ke||this.isInsideGrid(xn,Qa,In,ga),!n&&this.grid.hitTestCircle(di,qn,Oe,Z)&&(Te=!0,!P))return{circles:[],offscreen:!1,collisionDetected:Te}}}}return{circles:!P&&Te||!ke?[]:te,offscreen:Ae,collisionDetected:Te}},ln.prototype.queryRenderedSymbols=function(n){if(n.length===0||this.grid.keysLength()===0&&this.ignoredGrid.keysLength()===0)return{};for(var s=[],o=1/0,c=1/0,_=-1/0,w=-1/0,S=0,E=n;S<E.length;S+=1){var P=E[S],O=new a.Point(P.x+100,P.y+100);o=Math.min(o,O.x),c=Math.min(c,O.y),_=Math.max(_,O.x),w=Math.max(w,O.y),s.push(O)}for(var Z={},G={},H=0,te=this.grid.query(o,c,_,w).concat(this.ignoredGrid.query(o,c,_,w));H<te.length;H+=1){var $=te[H],ue=$.key;if(Z[ue.bucketInstanceId]===void 0&&(Z[ue.bucketInstanceId]={}),!Z[ue.bucketInstanceId][ue.featureIndex]){var Y=[new a.Point($.x1,$.y1),new a.Point($.x2,$.y1),new a.Point($.x2,$.y2),new a.Point($.x1,$.y2)];a.polygonIntersectsPolygon(s,Y)&&(Z[ue.bucketInstanceId][ue.featureIndex]=!0,G[ue.bucketInstanceId]===void 0&&(G[ue.bucketInstanceId]=[]),G[ue.bucketInstanceId].push(ue.featureIndex))}}return G},ln.prototype.insertCollisionBox=function(n,s,o,c,_){(s?this.ignoredGrid:this.grid).insert({bucketInstanceId:o,featureIndex:c,collisionGroupID:_},n[0],n[1],n[2],n[3])},ln.prototype.insertCollisionCircles=function(n,s,o,c,_){for(var w=s?this.ignoredGrid:this.grid,S={bucketInstanceId:o,featureIndex:c,collisionGroupID:_},E=0;E<n.length;E+=4)w.insertCircle(S,n[E],n[E+1],n[E+2])},ln.prototype.projectAndGetPerspectiveRatio=function(n,s,o){var c=[s,o,0,1];return ni(c,c,n),{point:new a.Point((c[0]/c[3]+1)/2*this.transform.width+100,(-c[1]/c[3]+1)/2*this.transform.height+100),perspectiveRatio:.5+this.transform.cameraToCenterDistance/c[3]*.5}},ln.prototype.isOffscreen=function(n,s,o,c){return o<100||n>=this.screenRightBoundary||c<100||s>this.screenBottomBoundary},ln.prototype.isInsideGrid=function(n,s,o,c){return o>=0&&n<this.gridRightBoundary&&c>=0&&s<this.gridBottomBoundary},ln.prototype.getViewportMatrix=function(){var n=a.identity([]);return a.translate(n,n,[-100,-100,0]),n};var Ln=function(n,s,o,c){this.opacity=n?Math.max(0,Math.min(1,n.opacity+(n.placed?s:-s))):c&&o?1:0,this.placed=o};Ln.prototype.isHidden=function(){return this.opacity===0&&!this.placed};var _n=function(n,s,o,c,_){this.text=new Ln(n?n.text:null,s,o,_),this.icon=new Ln(n?n.icon:null,s,c,_)};_n.prototype.isHidden=function(){return this.text.isHidden()&&this.icon.isHidden()};var as=function(n,s,o){this.text=n,this.icon=s,this.skipFade=o},Ai=function(){this.invProjMatrix=a.create(),this.viewportMatrix=a.create(),this.circles=[]},xa=function(n,s,o,c,_){this.bucketInstanceId=n,this.featureIndex=s,this.sourceLayerIndex=o,this.bucketIndex=c,this.tileID=_},Gi=function(n){this.crossSourceCollisions=n,this.maxGroupID=0,this.collisionGroups={}};function Pi(n,s,o,c,_){var w=a.getAnchorAlignment(n),S=-(w.horizontalAlign-.5)*s,E=-(w.verticalAlign-.5)*o,P=a.evaluateVariableOffset(n,c);return new a.Point(S+P[0]*_,E+P[1]*_)}function Yn(n,s,o,c,_,w){var S=n.x1,E=n.x2,P=n.y1,O=n.y2,Z=n.anchorPointX,G=n.anchorPointY,H=new a.Point(s,o);return c&&H._rotate(_?w:-w),{x1:S+H.x,y1:P+H.y,x2:E+H.x,y2:O+H.y,anchorPointX:Z,anchorPointY:G}}Gi.prototype.get=function(n){if(this.crossSourceCollisions)return{ID:0,predicate:null};if(!this.collisionGroups[n]){var s=++this.maxGroupID;this.collisionGroups[n]={ID:s,predicate:function(o){return o.collisionGroupID===s}}}return this.collisionGroups[n]};var Ki=function(n,s,o,c){this.transform=n.clone(),this.collisionIndex=new ln(this.transform),this.placements={},this.opacities={},this.variableOffsets={},this.stale=!1,this.commitTime=0,this.fadeDuration=s,this.retainedQueryData={},this.collisionGroups=new Gi(o),this.collisionCircleArrays={},this.prevPlacement=c,c&&(c.prevPlacement=void 0),this.placedOrientations={}};function wa(n,s,o,c,_){n.emplaceBack(s?1:0,o?1:0,c||0,_||0),n.emplaceBack(s?1:0,o?1:0,c||0,_||0),n.emplaceBack(s?1:0,o?1:0,c||0,_||0),n.emplaceBack(s?1:0,o?1:0,c||0,_||0)}Ki.prototype.getBucketParts=function(n,s,o,c){var _=o.getBucket(s),w=o.latestFeatureIndex;if(_&&w&&s.id===_.layerIds[0]){var S=o.collisionBoxArray,E=_.layers[0].layout,P=Math.pow(2,this.transform.zoom-o.tileID.overscaledZ),O=o.tileSize/a.EXTENT,Z=this.transform.calculatePosMatrix(o.tileID.toUnwrapped()),G=E.get("text-pitch-alignment")==="map",H=E.get("text-rotation-alignment")==="map",te=Dr(o,1,this.transform.zoom),$=Fr(Z,G,H,this.transform,te),ue=null;if(G){var Y=vr(Z,G,H,this.transform,te);ue=a.multiply([],this.transform.labelPlaneMatrix,Y)}this.retainedQueryData[_.bucketInstanceId]=new xa(_.bucketInstanceId,w,_.sourceLayerIndex,_.index,o.tileID);var le={bucket:_,layout:E,posMatrix:Z,textLabelPlaneMatrix:$,labelToScreenMatrix:ue,scale:P,textPixelRatio:O,holdingForFade:o.holdingForFade(),collisionBoxArray:S,partiallyEvaluatedTextSize:a.evaluateSizeForZoom(_.textSizeData,this.transform.zoom),collisionGroup:this.collisionGroups.get(_.sourceID)};if(c)for(var fe=0,_e=_.sortKeyRanges;fe<_e.length;fe+=1){var Te=_e[fe];n.push({sortKey:Te.sortKey,symbolInstanceStart:Te.symbolInstanceStart,symbolInstanceEnd:Te.symbolInstanceEnd,parameters:le})}else n.push({symbolInstanceStart:0,symbolInstanceEnd:_.symbolInstances.length,parameters:le})}},Ki.prototype.attemptAnchorPlacement=function(n,s,o,c,_,w,S,E,P,O,Z,G,H,te,$){var ue,Y=[G.textOffset0,G.textOffset1],le=Pi(n,o,c,Y,_),fe=this.collisionIndex.placeCollisionBox(Yn(s,le.x,le.y,w,S,this.transform.angle),Z,E,P,O.predicate);if(!$||this.collisionIndex.placeCollisionBox(Yn($,le.x,le.y,w,S,this.transform.angle),Z,E,P,O.predicate).box.length!==0)return fe.box.length>0?(this.prevPlacement&&this.prevPlacement.variableOffsets[G.crossTileID]&&this.prevPlacement.placements[G.crossTileID]&&this.prevPlacement.placements[G.crossTileID].text&&(ue=this.prevPlacement.variableOffsets[G.crossTileID].anchor),this.variableOffsets[G.crossTileID]={textOffset:Y,width:o,height:c,anchor:n,textBoxScale:_,prevAnchor:ue},this.markUsedJustification(H,n,G,te),H.allowVerticalPlacement&&(this.markUsedOrientation(H,te,G),this.placedOrientations[G.crossTileID]=te),{shift:le,placedGlyphBoxes:fe}):void 0},Ki.prototype.placeLayerBucketPart=function(n,s,o){var c=this,_=n.parameters,w=_.bucket,S=_.layout,E=_.posMatrix,P=_.textLabelPlaneMatrix,O=_.labelToScreenMatrix,Z=_.textPixelRatio,G=_.holdingForFade,H=_.collisionBoxArray,te=_.partiallyEvaluatedTextSize,$=_.collisionGroup,ue=S.get("text-optional"),Y=S.get("icon-optional"),le=S.get("text-allow-overlap"),fe=S.get("icon-allow-overlap"),_e=S.get("text-rotation-alignment")==="map",Te=S.get("text-pitch-alignment")==="map",ke=S.get("icon-text-fit")!=="none",Ae=S.get("symbol-z-order")==="viewport-y",Oe=le&&(fe||!w.hasIconData()||Y),He=fe&&(le||!w.hasTextData()||ue);!w.collisionArrays&&H&&w.deserializeCollisionBoxes(H);var Ge=function(pt,Ut){if(!s[pt.crossTileID])if(G)c.placements[pt.crossTileID]=new as(!1,!1,!1);else{var Yt,Ot=!1,Bt=!1,Xt=!0,Rt=null,Mt={box:null,offscreen:null},Fi={box:null,offscreen:null},ai=null,cn=null,Wi=0,$r=0,di=0;Ut.textFeatureIndex?Wi=Ut.textFeatureIndex:pt.useRuntimeCollisionCircles&&(Wi=pt.featureIndex),Ut.verticalTextFeatureIndex&&($r=Ut.verticalTextFeatureIndex);var qn=Ut.textBox;if(qn){var xn=function(kr){var $n=a.WritingMode.horizontal;if(w.allowVerticalPlacement&&!kr&&c.prevPlacement){var An=c.prevPlacement.placedOrientations[pt.crossTileID];An&&(c.placedOrientations[pt.crossTileID]=An,c.markUsedOrientation(w,$n=An,pt))}return $n},Qa=function(kr,$n){if(w.allowVerticalPlacement&&pt.numVerticalGlyphVertices>0&&Ut.verticalTextBox)for(var An=0,Io=w.writingModes;An<Io.length&&(Io[An]===a.WritingMode.vertical?(Mt=$n(),Fi=Mt):Mt=kr(),!(Mt&&Mt.box&&Mt.box.length));An+=1);else Mt=kr()};if(S.get("text-variable-anchor")){var In=S.get("text-variable-anchor");if(c.prevPlacement&&c.prevPlacement.variableOffsets[pt.crossTileID]){var ga=c.prevPlacement.variableOffsets[pt.crossTileID];In.indexOf(ga.anchor)>0&&(In=In.filter(function(kr){return kr!==ga.anchor})).unshift(ga.anchor)}var oa=function(kr,$n,An){for(var Io=kr.x2-kr.x1,Xh=kr.y2-kr.y1,nl=pt.textBoxScale,Wh=ke&&!fe?$n:null,Ts={box:[],offscreen:!1},Ic=le?2*In.length:In.length,Wo=0;Wo<Ic;++Wo){var al=c.attemptAnchorPlacement(In[Wo%In.length],kr,Io,Xh,nl,_e,Te,Z,E,$,Wo>=In.length,pt,w,An,Wh);if(al&&(Ts=al.placedGlyphBoxes)&&Ts.box&&Ts.box.length){Ot=!0,Rt=al.shift;break}}return Ts};Qa(function(){return oa(qn,Ut.iconBox,a.WritingMode.horizontal)},function(){var kr=Ut.verticalTextBox;return w.allowVerticalPlacement&&!(Mt&&Mt.box&&Mt.box.length)&&pt.numVerticalGlyphVertices>0&&kr?oa(kr,Ut.verticalIconBox,a.WritingMode.vertical):{box:null,offscreen:null}}),Mt&&(Ot=Mt.box,Xt=Mt.offscreen);var ks=xn(Mt&&Mt.box);if(!Ot&&c.prevPlacement){var Ho=c.prevPlacement.variableOffsets[pt.crossTileID];Ho&&(c.variableOffsets[pt.crossTileID]=Ho,c.markUsedJustification(w,Ho.anchor,pt,ks))}}else{var $a=function(kr,$n){var An=c.collisionIndex.placeCollisionBox(kr,le,Z,E,$.predicate);return An&&An.box&&An.box.length&&(c.markUsedOrientation(w,$n,pt),c.placedOrientations[pt.crossTileID]=$n),An};Qa(function(){return $a(qn,a.WritingMode.horizontal)},function(){var kr=Ut.verticalTextBox;return w.allowVerticalPlacement&&pt.numVerticalGlyphVertices>0&&kr?$a(kr,a.WritingMode.vertical):{box:null,offscreen:null}}),xn(Mt&&Mt.box&&Mt.box.length)}}if(Ot=(Yt=Mt)&&Yt.box&&Yt.box.length>0,Xt=Yt&&Yt.offscreen,pt.useRuntimeCollisionCircles){var Xo=w.text.placedSymbolArray.get(pt.centerJustifiedTextSymbolIndex),Es=a.evaluateSizeForFeature(w.textSizeData,te,Xo),Ia=S.get("text-padding");ai=c.collisionIndex.placeCollisionCircles(le,Xo,w.lineVertexArray,w.glyphOffsetArray,Es,E,P,O,o,Te,$.predicate,pt.collisionCircleDiameter,Ia),Ot=le||ai.circles.length>0&&!ai.collisionDetected,Xt=Xt&&ai.offscreen}if(Ut.iconFeatureIndex&&(di=Ut.iconFeatureIndex),Ut.iconBox){var zs=function(kr){var $n=ke&&Rt?Yn(kr,Rt.x,Rt.y,_e,Te,c.transform.angle):kr;return c.collisionIndex.placeCollisionBox($n,fe,Z,E,$.predicate)};Bt=Fi&&Fi.box&&Fi.box.length&&Ut.verticalIconBox?(cn=zs(Ut.verticalIconBox)).box.length>0:(cn=zs(Ut.iconBox)).box.length>0,Xt=Xt&&cn.offscreen}var Aa=ue||pt.numHorizontalGlyphVertices===0&&pt.numVerticalGlyphVertices===0,Ni=Y||pt.numIconVertices===0;if(Aa||Ni?Ni?Aa||(Bt=Bt&&Ot):Ot=Bt&&Ot:Bt=Ot=Bt&&Ot,Ot&&Yt&&Yt.box&&c.collisionIndex.insertCollisionBox(Yt.box,S.get("text-ignore-placement"),w.bucketInstanceId,Fi&&Fi.box&&$r?$r:Wi,$.ID),Bt&&cn&&c.collisionIndex.insertCollisionBox(cn.box,S.get("icon-ignore-placement"),w.bucketInstanceId,di,$.ID),ai&&(Ot&&c.collisionIndex.insertCollisionCircles(ai.circles,S.get("text-ignore-placement"),w.bucketInstanceId,Wi,$.ID),o)){var La=w.bucketInstanceId,eo=c.collisionCircleArrays[La];eo===void 0&&(eo=c.collisionCircleArrays[La]=new Ai);for(var To=0;To<ai.circles.length;To+=4)eo.circles.push(ai.circles[To+0]),eo.circles.push(ai.circles[To+1]),eo.circles.push(ai.circles[To+2]),eo.circles.push(ai.collisionDetected?1:0)}c.placements[pt.crossTileID]=new as(Ot||Oe,Bt||He,Xt||w.justReloaded),s[pt.crossTileID]=!0}};if(Ae)for(var lt=w.getSortedSymbolIndexes(this.transform.angle),kt=lt.length-1;kt>=0;--kt){var It=lt[kt];Ge(w.symbolInstances.get(It),w.collisionArrays[It])}else for(var Tt=n.symbolInstanceStart;Tt<n.symbolInstanceEnd;Tt++)Ge(w.symbolInstances.get(Tt),w.collisionArrays[Tt]);if(o&&w.bucketInstanceId in this.collisionCircleArrays){var gr=this.collisionCircleArrays[w.bucketInstanceId];a.invert(gr.invProjMatrix,E),gr.viewportMatrix=this.collisionIndex.getViewportMatrix()}w.justReloaded=!1},Ki.prototype.markUsedJustification=function(n,s,o,c){var _;_=c===a.WritingMode.vertical?o.verticalPlacedTextSymbolIndex:{left:o.leftJustifiedTextSymbolIndex,center:o.centerJustifiedTextSymbolIndex,right:o.rightJustifiedTextSymbolIndex}[a.getAnchorJustification(s)];for(var w=0,S=[o.leftJustifiedTextSymbolIndex,o.centerJustifiedTextSymbolIndex,o.rightJustifiedTextSymbolIndex,o.verticalPlacedTextSymbolIndex];w<S.length;w+=1){var E=S[w];E>=0&&(n.text.placedSymbolArray.get(E).crossTileID=_>=0&&E!==_?0:o.crossTileID)}},Ki.prototype.markUsedOrientation=function(n,s,o){for(var c=s===a.WritingMode.horizontal||s===a.WritingMode.horizontalOnly?s:0,_=s===a.WritingMode.vertical?s:0,w=0,S=[o.leftJustifiedTextSymbolIndex,o.centerJustifiedTextSymbolIndex,o.rightJustifiedTextSymbolIndex];w<S.length;w+=1)n.text.placedSymbolArray.get(S[w]).placedOrientation=c;o.verticalPlacedTextSymbolIndex&&(n.text.placedSymbolArray.get(o.verticalPlacedTextSymbolIndex).placedOrientation=_)},Ki.prototype.commit=function(n){this.commitTime=n,this.zoomAtLastRecencyCheck=this.transform.zoom;var s=this.prevPlacement,o=!1;this.prevZoomAdjustment=s?s.zoomAdjustment(this.transform.zoom):0;var c=s?s.symbolFadeChange(n):1,_=s?s.opacities:{},w=s?s.variableOffsets:{},S=s?s.placedOrientations:{};for(var E in this.placements){var P=this.placements[E],O=_[E];O?(this.opacities[E]=new _n(O,c,P.text,P.icon),o=o||P.text!==O.text.placed||P.icon!==O.icon.placed):(this.opacities[E]=new _n(null,c,P.text,P.icon,P.skipFade),o=o||P.text||P.icon)}for(var Z in _){var G=_[Z];if(!this.opacities[Z]){var H=new _n(G,c,!1,!1);H.isHidden()||(this.opacities[Z]=H,o=o||G.text.placed||G.icon.placed)}}for(var te in w)this.variableOffsets[te]||!this.opacities[te]||this.opacities[te].isHidden()||(this.variableOffsets[te]=w[te]);for(var $ in S)this.placedOrientations[$]||!this.opacities[$]||this.opacities[$].isHidden()||(this.placedOrientations[$]=S[$]);o?this.lastPlacementChangeTime=n:typeof this.lastPlacementChangeTime!="number"&&(this.lastPlacementChangeTime=s?s.lastPlacementChangeTime:n)},Ki.prototype.updateLayerOpacities=function(n,s){for(var o={},c=0,_=s;c<_.length;c+=1){var w=_[c],S=w.getBucket(n);S&&w.latestFeatureIndex&&n.id===S.layerIds[0]&&this.updateBucketOpacities(S,o,w.collisionBoxArray)}},Ki.prototype.updateBucketOpacities=function(n,s,o){var c=this;n.hasTextData()&&n.text.opacityVertexArray.clear(),n.hasIconData()&&n.icon.opacityVertexArray.clear(),n.hasIconCollisionBoxData()&&n.iconCollisionBox.collisionVertexArray.clear(),n.hasTextCollisionBoxData()&&n.textCollisionBox.collisionVertexArray.clear();var _=n.layers[0].layout,w=new _n(null,0,!1,!1,!0),S=_.get("text-allow-overlap"),E=_.get("icon-allow-overlap"),P=_.get("text-variable-anchor"),O=_.get("text-rotation-alignment")==="map",Z=_.get("text-pitch-alignment")==="map",G=_.get("icon-text-fit")!=="none",H=new _n(null,0,S&&(E||!n.hasIconData()||_.get("icon-optional")),E&&(S||!n.hasTextData()||_.get("text-optional")),!0);!n.collisionArrays&&o&&(n.hasIconCollisionBoxData()||n.hasTextCollisionBoxData())&&n.deserializeCollisionBoxes(o);for(var te=function(le,fe,_e){for(var Te=0;Te<fe/4;Te++)le.opacityVertexArray.emplaceBack(_e)},$=function(le){var fe=n.symbolInstances.get(le),_e=fe.numHorizontalGlyphVertices,Te=fe.numVerticalGlyphVertices,ke=fe.crossTileID,Ae=c.opacities[ke];s[ke]?Ae=w:Ae||(c.opacities[ke]=Ae=H),s[ke]=!0;var Oe=fe.numIconVertices>0,He=c.placedOrientations[fe.crossTileID],Ge=He===a.WritingMode.vertical,lt=He===a.WritingMode.horizontal||He===a.WritingMode.horizontalOnly;if(_e>0||Te>0){var kt=Fs(Ae.text);te(n.text,_e,Ge?Ua:kt),te(n.text,Te,lt?Ua:kt);var It=Ae.text.isHidden();[fe.rightJustifiedTextSymbolIndex,fe.centerJustifiedTextSymbolIndex,fe.leftJustifiedTextSymbolIndex].forEach(function(Mt){Mt>=0&&(n.text.placedSymbolArray.get(Mt).hidden=It||Ge?1:0)}),fe.verticalPlacedTextSymbolIndex>=0&&(n.text.placedSymbolArray.get(fe.verticalPlacedTextSymbolIndex).hidden=It||lt?1:0);var Tt=c.variableOffsets[fe.crossTileID];Tt&&c.markUsedJustification(n,Tt.anchor,fe,He);var gr=c.placedOrientations[fe.crossTileID];gr&&(c.markUsedJustification(n,"left",fe,gr),c.markUsedOrientation(n,gr,fe))}if(Oe){var pt=Fs(Ae.icon),Ut=!(G&&fe.verticalPlacedIconSymbolIndex&&Ge);fe.placedIconSymbolIndex>=0&&(te(n.icon,fe.numIconVertices,Ut?pt:Ua),n.icon.placedSymbolArray.get(fe.placedIconSymbolIndex).hidden=Ae.icon.isHidden()),fe.verticalPlacedIconSymbolIndex>=0&&(te(n.icon,fe.numVerticalIconVertices,Ut?Ua:pt),n.icon.placedSymbolArray.get(fe.verticalPlacedIconSymbolIndex).hidden=Ae.icon.isHidden())}if(n.hasIconCollisionBoxData()||n.hasTextCollisionBoxData()){var Yt=n.collisionArrays[le];if(Yt){var Ot=new a.Point(0,0);if(Yt.textBox||Yt.verticalTextBox){var Bt=!0;if(P){var Xt=c.variableOffsets[ke];Xt?(Ot=Pi(Xt.anchor,Xt.width,Xt.height,Xt.textOffset,Xt.textBoxScale),O&&Ot._rotate(Z?c.transform.angle:-c.transform.angle)):Bt=!1}Yt.textBox&&wa(n.textCollisionBox.collisionVertexArray,Ae.text.placed,!Bt||Ge,Ot.x,Ot.y),Yt.verticalTextBox&&wa(n.textCollisionBox.collisionVertexArray,Ae.text.placed,!Bt||lt,Ot.x,Ot.y)}var Rt=!!(!lt&&Yt.verticalIconBox);Yt.iconBox&&wa(n.iconCollisionBox.collisionVertexArray,Ae.icon.placed,Rt,G?Ot.x:0,G?Ot.y:0),Yt.verticalIconBox&&wa(n.iconCollisionBox.collisionVertexArray,Ae.icon.placed,!Rt,G?Ot.x:0,G?Ot.y:0)}}},ue=0;ue<n.symbolInstances.length;ue++)$(ue);if(n.sortFeatures(this.transform.angle),this.retainedQueryData[n.bucketInstanceId]&&(this.retainedQueryData[n.bucketInstanceId].featureSortOrder=n.featureSortOrder),n.hasTextData()&&n.text.opacityVertexBuffer&&n.text.opacityVertexBuffer.updateData(n.text.opacityVertexArray),n.hasIconData()&&n.icon.opacityVertexBuffer&&n.icon.opacityVertexBuffer.updateData(n.icon.opacityVertexArray),n.hasIconCollisionBoxData()&&n.iconCollisionBox.collisionVertexBuffer&&n.iconCollisionBox.collisionVertexBuffer.updateData(n.iconCollisionBox.collisionVertexArray),n.hasTextCollisionBoxData()&&n.textCollisionBox.collisionVertexBuffer&&n.textCollisionBox.collisionVertexBuffer.updateData(n.textCollisionBox.collisionVertexArray),n.bucketInstanceId in this.collisionCircleArrays){var Y=this.collisionCircleArrays[n.bucketInstanceId];n.placementInvProjMatrix=Y.invProjMatrix,n.placementViewportMatrix=Y.viewportMatrix,n.collisionCircleArray=Y.circles,delete this.collisionCircleArrays[n.bucketInstanceId]}},Ki.prototype.symbolFadeChange=function(n){return this.fadeDuration===0?1:(n-this.commitTime)/this.fadeDuration+this.prevZoomAdjustment},Ki.prototype.zoomAdjustment=function(n){return Math.max(0,(this.transform.zoom-n)/1.5)},Ki.prototype.hasTransitions=function(n){return this.stale||n-this.lastPlacementChangeTime<this.fadeDuration},Ki.prototype.stillRecent=function(n,s){var o=this.zoomAtLastRecencyCheck===s?1-this.zoomAdjustment(s):1;return this.zoomAtLastRecencyCheck=s,this.commitTime+this.fadeDuration*o>n},Ki.prototype.setStale=function(){this.stale=!0};var os=Math.pow(2,25),Fl=Math.pow(2,24),uo=Math.pow(2,17),Nl=Math.pow(2,16),Ro=Math.pow(2,9),Ul=Math.pow(2,8),Bo=Math.pow(2,1);function Fs(n){if(n.opacity===0&&!n.placed)return 0;if(n.opacity===1&&n.placed)return 4294967295;var s=n.placed?1:0,o=Math.floor(127*n.opacity);return o*os+s*Fl+o*uo+s*Nl+o*Ro+s*Ul+o*Bo+s}var Ua=0,ss=function(n){this._sortAcrossTiles=n.layout.get("symbol-z-order")!=="viewport-y"&&n.layout.get("symbol-sort-key").constantOr(1)!==void 0,this._currentTileIndex=0,this._currentPartIndex=0,this._seenCrossTileIDs={},this._bucketParts=[]};ss.prototype.continuePlacement=function(n,s,o,c,_){for(var w=this._bucketParts;this._currentTileIndex<n.length;)if(s.getBucketParts(w,c,n[this._currentTileIndex],this._sortAcrossTiles),this._currentTileIndex++,_())return!0;for(this._sortAcrossTiles&&(this._sortAcrossTiles=!1,w.sort(function(S,E){return S.sortKey-E.sortKey}));this._currentPartIndex<w.length;)if(s.placeLayerBucketPart(w[this._currentPartIndex],this._seenCrossTileIDs,o),this._currentPartIndex++,_())return!0;return!1};var co=function(n,s,o,c,_,w,S){this.placement=new Ki(n,_,w,S),this._currentPlacementIndex=s.length-1,this._forceFullPlacement=o,this._showCollisionBoxes=c,this._done=!1};co.prototype.isDone=function(){return this._done},co.prototype.continuePlacement=function(n,s,o){for(var c=this,_=a.browser.now(),w=function(){var P=a.browser.now()-_;return!c._forceFullPlacement&&P>2};this._currentPlacementIndex>=0;){var S=s[n[this._currentPlacementIndex]],E=this.placement.collisionIndex.transform.zoom;if(S.type==="symbol"&&(!S.minzoom||S.minzoom<=E)&&(!S.maxzoom||S.maxzoom>E)){if(this._inProgressLayer||(this._inProgressLayer=new ss(S)),this._inProgressLayer.continuePlacement(o[S.source],this.placement,this._showCollisionBoxes,S,w))return;delete this._inProgressLayer}this._currentPlacementIndex--}this._done=!0},co.prototype.commit=function(n){return this.placement.commit(n),this.placement};var Ns=512/a.EXTENT/2,Va=function(n,s,o){this.tileID=n,this.indexedSymbolInstances={},this.bucketInstanceId=o;for(var c=0;c<s.length;c++){var _=s.get(c),w=_.key;this.indexedSymbolInstances[w]||(this.indexedSymbolInstances[w]=[]),this.indexedSymbolInstances[w].push({crossTileID:_.crossTileID,coord:this.getScaledCoordinates(_,n)})}};Va.prototype.getScaledCoordinates=function(n,s){var o=Ns/Math.pow(2,s.canonical.z-this.tileID.canonical.z);return{x:Math.floor((s.canonical.x*a.EXTENT+n.anchorX)*o),y:Math.floor((s.canonical.y*a.EXTENT+n.anchorY)*o)}},Va.prototype.findMatches=function(n,s,o){for(var c=this.tileID.canonical.z<s.canonical.z?1:Math.pow(2,this.tileID.canonical.z-s.canonical.z),_=0;_<n.length;_++){var w=n.get(_);if(!w.crossTileID){var S=this.indexedSymbolInstances[w.key];if(S)for(var E=this.getScaledCoordinates(w,s),P=0,O=S;P<O.length;P+=1){var Z=O[P];if(Math.abs(Z.coord.x-E.x)<=c&&Math.abs(Z.coord.y-E.y)<=c&&!o[Z.crossTileID]){o[Z.crossTileID]=!0,w.crossTileID=Z.crossTileID;break}}}}};var Rn=function(){this.maxCrossTileID=0};Rn.prototype.generate=function(){return++this.maxCrossTileID};var Sa=function(){this.indexes={},this.usedCrossTileIDs={},this.lng=0};Sa.prototype.handleWrapJump=function(n){var s=Math.round((n-this.lng)/360);if(s!==0)for(var o in this.indexes){var c=this.indexes[o],_={};for(var w in c){var S=c[w];S.tileID=S.tileID.unwrapTo(S.tileID.wrap+s),_[S.tileID.key]=S}this.indexes[o]=_}this.lng=n},Sa.prototype.addBucket=function(n,s,o){if(this.indexes[n.overscaledZ]&&this.indexes[n.overscaledZ][n.key]){if(this.indexes[n.overscaledZ][n.key].bucketInstanceId===s.bucketInstanceId)return!1;this.removeBucketCrossTileIDs(n.overscaledZ,this.indexes[n.overscaledZ][n.key])}for(var c=0;c<s.symbolInstances.length;c++)s.symbolInstances.get(c).crossTileID=0;this.usedCrossTileIDs[n.overscaledZ]||(this.usedCrossTileIDs[n.overscaledZ]={});var _=this.usedCrossTileIDs[n.overscaledZ];for(var w in this.indexes){var S=this.indexes[w];if(Number(w)>n.overscaledZ)for(var E in S){var P=S[E];P.tileID.isChildOf(n)&&P.findMatches(s.symbolInstances,n,_)}else{var O=S[n.scaledTo(Number(w)).key];O&&O.findMatches(s.symbolInstances,n,_)}}for(var Z=0;Z<s.symbolInstances.length;Z++){var G=s.symbolInstances.get(Z);G.crossTileID||(G.crossTileID=o.generate(),_[G.crossTileID]=!0)}return this.indexes[n.overscaledZ]===void 0&&(this.indexes[n.overscaledZ]={}),this.indexes[n.overscaledZ][n.key]=new Va(n,s.symbolInstances,s.bucketInstanceId),!0},Sa.prototype.removeBucketCrossTileIDs=function(n,s){for(var o in s.indexedSymbolInstances)for(var c=0,_=s.indexedSymbolInstances[o];c<_.length;c+=1)delete this.usedCrossTileIDs[n][_[c].crossTileID]},Sa.prototype.removeStaleBuckets=function(n){var s=!1;for(var o in this.indexes){var c=this.indexes[o];for(var _ in c)n[c[_].bucketInstanceId]||(this.removeBucketCrossTileIDs(o,c[_]),delete c[_],s=!0)}return s};var ge=function(){this.layerIndexes={},this.crossTileIDs=new Rn,this.maxBucketInstanceId=0,this.bucketsInCurrentPlacement={}};ge.prototype.addLayer=function(n,s,o){var c=this.layerIndexes[n.id];c===void 0&&(c=this.layerIndexes[n.id]=new Sa);var _=!1,w={};c.handleWrapJump(o);for(var S=0,E=s;S<E.length;S+=1){var P=E[S],O=P.getBucket(n);O&&n.id===O.layerIds[0]&&(O.bucketInstanceId||(O.bucketInstanceId=++this.maxBucketInstanceId),c.addBucket(P.tileID,O,this.crossTileIDs)&&(_=!0),w[O.bucketInstanceId]=!0)}return c.removeStaleBuckets(w)&&(_=!0),_},ge.prototype.pruneUnusedLayers=function(n){var s={};for(var o in n.forEach(function(c){s[c]=!0}),this.layerIndexes)s[o]||delete this.layerIndexes[o]};var un=function(n,s){return a.emitValidationErrors(n,s&&s.filter(function(o){return o.identifier!=="source.canvas"}))},Hi=a.pick($e,["addLayer","removeLayer","setPaintProperty","setLayoutProperty","setFilter","addSource","removeSource","setLayerZoomRange","setLight","setTransition","setGeoJSONSourceData"]),Gr=a.pick($e,["setCenter","setZoom","setBearing","setPitch"]),ka=function(){var n={},s=a.styleSpec.$version;for(var o in a.styleSpec.$root){var c,_=a.styleSpec.$root[o];_.required&&(c=o==="version"?s:_.type==="array"?[]:{})!=null&&(n[o]=c)}return n}(),Bn=function(n){function s(o,c){var _=this;c===void 0&&(c={}),n.call(this),this.map=o,this.dispatcher=new Ct(xe(),this),this.imageManager=new we,this.imageManager.setEventedParent(this),this.glyphManager=new ct(o._requestManager,c.localIdeographFontFamily),this.lineAtlas=new yt(256,512),this.crossTileSymbolIndex=new ge,this._layers={},this._serializedLayers={},this._order=[],this.sourceCaches={},this.zoomHistory=new a.ZoomHistory,this._loaded=!1,this._availableImages=[],this._resetUpdates(),this.dispatcher.broadcast("setReferrer",a.getReferrer());var w=this;this._rtlTextPluginCallback=s.registerForPluginStateChange(function(S){w.dispatcher.broadcast("syncRTLPluginState",{pluginStatus:S.pluginStatus,pluginURL:S.pluginURL},function(E,P){if(a.triggerPluginCompletionEvent(E),P&&P.every(function(Z){return Z}))for(var O in w.sourceCaches)w.sourceCaches[O].reload()})}),this.on("data",function(S){if(S.dataType==="source"&&S.sourceDataType==="metadata"){var E=_.sourceCaches[S.sourceId];if(E){var P=E.getSource();if(P&&P.vectorLayerIds)for(var O in _._layers){var Z=_._layers[O];Z.source===P.id&&_._validateLayer(Z)}}}})}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype.loadURL=function(o,c){var _=this;c===void 0&&(c={}),this.fire(new a.Event("dataloading",{dataType:"style"}));var w=typeof c.validate=="boolean"?c.validate:!a.isMapboxURL(o);o=this.map._requestManager.normalizeStyleURL(o,c.accessToken);var S=this.map._requestManager.transformRequest(o,a.ResourceType.Style);this._request=a.getJSON(S,function(E,P){_._request=null,E?_.fire(new a.ErrorEvent(E)):P&&_._load(P,w)})},s.prototype.loadJSON=function(o,c){var _=this;c===void 0&&(c={}),this.fire(new a.Event("dataloading",{dataType:"style"})),this._request=a.browser.frame(function(){_._request=null,_._load(o,c.validate!==!1)})},s.prototype.loadEmpty=function(){this.fire(new a.Event("dataloading",{dataType:"style"})),this._load(ka,!1)},s.prototype._load=function(o,c){if(!c||!un(this,a.validateStyle(o))){for(var _ in this._loaded=!0,this.stylesheet=o,o.sources)this.addSource(_,o.sources[_],{validate:!1});o.sprite?this._loadSprite(o.sprite):this.imageManager.setLoaded(!0),this.glyphManager.setURL(o.glyphs);var w=We(this.stylesheet.layers);this._order=w.map(function(O){return O.id}),this._layers={},this._serializedLayers={};for(var S=0,E=w;S<E.length;S+=1){var P=E[S];(P=a.createStyleLayer(P)).setEventedParent(this,{layer:{id:P.id}}),this._layers[P.id]=P,this._serializedLayers[P.id]=P.serialize()}this.dispatcher.broadcast("setLayers",this._serializeLayers(this._order)),this.light=new Ft(this.stylesheet.light),this.fire(new a.Event("data",{dataType:"style"})),this.fire(new a.Event("style.load"))}},s.prototype._loadSprite=function(o){var c=this;this._spriteRequest=function(_,w,S){var E,P,O,Z=a.browser.devicePixelRatio>1?"@2x":"",G=a.getJSON(w.transformRequest(w.normalizeSpriteURL(_,Z,".json"),a.ResourceType.SpriteJSON),function($,ue){G=null,O||(O=$,E=ue,te())}),H=a.getImage(w.transformRequest(w.normalizeSpriteURL(_,Z,".png"),a.ResourceType.SpriteImage),function($,ue){H=null,O||(O=$,P=ue,te())});function te(){if(O)S(O);else if(E&&P){var $=a.browser.getImageData(P),ue={};for(var Y in E){var le=E[Y],fe=le.width,_e=le.height,Te=le.x,ke=le.y,Ae=le.sdf,Oe=le.pixelRatio,He=le.stretchX,Ge=le.stretchY,lt=le.content,kt=new a.RGBAImage({width:fe,height:_e});a.RGBAImage.copy($,kt,{x:Te,y:ke},{x:0,y:0},{width:fe,height:_e}),ue[Y]={data:kt,pixelRatio:Oe,sdf:Ae,stretchX:He,stretchY:Ge,content:lt}}S(null,ue)}}return{cancel:function(){G&&(G.cancel(),G=null),H&&(H.cancel(),H=null)}}}(o,this.map._requestManager,function(_,w){if(c._spriteRequest=null,_)c.fire(new a.ErrorEvent(_));else if(w)for(var S in w)c.imageManager.addImage(S,w[S]);c.imageManager.setLoaded(!0),c._availableImages=c.imageManager.listImages(),c.dispatcher.broadcast("setImages",c._availableImages),c.fire(new a.Event("data",{dataType:"style"}))})},s.prototype._validateLayer=function(o){var c=this.sourceCaches[o.source];if(c){var _=o.sourceLayer;if(_){var w=c.getSource();(w.type==="geojson"||w.vectorLayerIds&&w.vectorLayerIds.indexOf(_)===-1)&&this.fire(new a.ErrorEvent(new Error('Source layer "'+_+'" does not exist on source "'+w.id+'" as specified by style layer "'+o.id+'"')))}}},s.prototype.loaded=function(){if(!this._loaded||Object.keys(this._updatedSources).length)return!1;for(var o in this.sourceCaches)if(!this.sourceCaches[o].loaded())return!1;return!!this.imageManager.isLoaded()},s.prototype._serializeLayers=function(o){for(var c=[],_=0,w=o;_<w.length;_+=1){var S=this._layers[w[_]];S.type!=="custom"&&c.push(S.serialize())}return c},s.prototype.hasTransitions=function(){if(this.light&&this.light.hasTransition())return!0;for(var o in this.sourceCaches)if(this.sourceCaches[o].hasTransition())return!0;for(var c in this._layers)if(this._layers[c].hasTransition())return!0;return!1},s.prototype._checkLoaded=function(){if(!this._loaded)throw new Error("Style is not done loading")},s.prototype.update=function(o){if(this._loaded){var c=this._changed;if(this._changed){var _=Object.keys(this._updatedLayers),w=Object.keys(this._removedLayers);for(var S in(_.length||w.length)&&this._updateWorkerLayers(_,w),this._updatedSources){var E=this._updatedSources[S];E==="reload"?this._reloadSource(S):E==="clear"&&this._clearSource(S)}for(var P in this._updateTilesForChangedImages(),this._updatedPaintProps)this._layers[P].updateTransitions(o);this.light.updateTransitions(o),this._resetUpdates()}var O={};for(var Z in this.sourceCaches){var G=this.sourceCaches[Z];O[Z]=G.used,G.used=!1}for(var H=0,te=this._order;H<te.length;H+=1){var $=this._layers[te[H]];$.recalculate(o,this._availableImages),!$.isHidden(o.zoom)&&$.source&&(this.sourceCaches[$.source].used=!0)}for(var ue in O){var Y=this.sourceCaches[ue];O[ue]!==Y.used&&Y.fire(new a.Event("data",{sourceDataType:"visibility",dataType:"source",sourceId:ue}))}this.light.recalculate(o),this.z=o.zoom,c&&this.fire(new a.Event("data",{dataType:"style"}))}},s.prototype._updateTilesForChangedImages=function(){var o=Object.keys(this._changedImages);if(o.length){for(var c in this.sourceCaches)this.sourceCaches[c].reloadTilesForDependencies(["icons","patterns"],o);this._changedImages={}}},s.prototype._updateWorkerLayers=function(o,c){this.dispatcher.broadcast("updateLayers",{layers:this._serializeLayers(o),removedIds:c})},s.prototype._resetUpdates=function(){this._changed=!1,this._updatedLayers={},this._removedLayers={},this._updatedSources={},this._updatedPaintProps={},this._changedImages={}},s.prototype.setState=function(o){var c=this;if(this._checkLoaded(),un(this,a.validateStyle(o)))return!1;(o=a.clone$1(o)).layers=We(o.layers);var _=function(S,E){if(!S)return[{command:$e.setStyle,args:[E]}];var P=[];try{if(!a.deepEqual(S.version,E.version))return[{command:$e.setStyle,args:[E]}];a.deepEqual(S.center,E.center)||P.push({command:$e.setCenter,args:[E.center]}),a.deepEqual(S.zoom,E.zoom)||P.push({command:$e.setZoom,args:[E.zoom]}),a.deepEqual(S.bearing,E.bearing)||P.push({command:$e.setBearing,args:[E.bearing]}),a.deepEqual(S.pitch,E.pitch)||P.push({command:$e.setPitch,args:[E.pitch]}),a.deepEqual(S.sprite,E.sprite)||P.push({command:$e.setSprite,args:[E.sprite]}),a.deepEqual(S.glyphs,E.glyphs)||P.push({command:$e.setGlyphs,args:[E.glyphs]}),a.deepEqual(S.transition,E.transition)||P.push({command:$e.setTransition,args:[E.transition]}),a.deepEqual(S.light,E.light)||P.push({command:$e.setLight,args:[E.light]});var O={},Z=[];(function(H,te,$,ue){var Y;for(Y in te=te||{},H=H||{})H.hasOwnProperty(Y)&&(te.hasOwnProperty(Y)||rt(Y,$,ue));for(Y in te)te.hasOwnProperty(Y)&&(H.hasOwnProperty(Y)?a.deepEqual(H[Y],te[Y])||(H[Y].type==="geojson"&&te[Y].type==="geojson"&&br(H,te,Y)?$.push({command:$e.setGeoJSONSourceData,args:[Y,te[Y].data]}):tr(Y,te,$,ue)):Zt(Y,te,$))})(S.sources,E.sources,Z,O);var G=[];S.layers&&S.layers.forEach(function(H){O[H.source]?P.push({command:$e.removeLayer,args:[H.id]}):G.push(H)}),P=P.concat(Z),function(H,te,$){te=te||[];var ue,Y,le,fe,_e,Te,ke,Ae=(H=H||[]).map(hr),Oe=te.map(hr),He=H.reduce(rr,{}),Ge=te.reduce(rr,{}),lt=Ae.slice(),kt=Object.create(null);for(ue=0,Y=0;ue<Ae.length;ue++)Ge.hasOwnProperty(le=Ae[ue])?Y++:($.push({command:$e.removeLayer,args:[le]}),lt.splice(lt.indexOf(le,Y),1));for(ue=0,Y=0;ue<Oe.length;ue++)lt[lt.length-1-ue]!==(le=Oe[Oe.length-1-ue])&&(He.hasOwnProperty(le)?($.push({command:$e.removeLayer,args:[le]}),lt.splice(lt.lastIndexOf(le,lt.length-Y),1)):Y++,$.push({command:$e.addLayer,args:[Ge[le],Te=lt[lt.length-ue]]}),lt.splice(lt.length-ue,0,le),kt[le]=!0);for(ue=0;ue<Oe.length;ue++)if(fe=He[le=Oe[ue]],_e=Ge[le],!kt[le]&&!a.deepEqual(fe,_e))if(a.deepEqual(fe.source,_e.source)&&a.deepEqual(fe["source-layer"],_e["source-layer"])&&a.deepEqual(fe.type,_e.type)){for(ke in Ht(fe.layout,_e.layout,$,le,null,$e.setLayoutProperty),Ht(fe.paint,_e.paint,$,le,null,$e.setPaintProperty),a.deepEqual(fe.filter,_e.filter)||$.push({command:$e.setFilter,args:[le,_e.filter]}),a.deepEqual(fe.minzoom,_e.minzoom)&&a.deepEqual(fe.maxzoom,_e.maxzoom)||$.push({command:$e.setLayerZoomRange,args:[le,_e.minzoom,_e.maxzoom]}),fe)fe.hasOwnProperty(ke)&&ke!=="layout"&&ke!=="paint"&&ke!=="filter"&&ke!=="metadata"&&ke!=="minzoom"&&ke!=="maxzoom"&&(ke.indexOf("paint.")===0?Ht(fe[ke],_e[ke],$,le,ke.slice(6),$e.setPaintProperty):a.deepEqual(fe[ke],_e[ke])||$.push({command:$e.setLayerProperty,args:[le,ke,_e[ke]]}));for(ke in _e)_e.hasOwnProperty(ke)&&!fe.hasOwnProperty(ke)&&ke!=="layout"&&ke!=="paint"&&ke!=="filter"&&ke!=="metadata"&&ke!=="minzoom"&&ke!=="maxzoom"&&(ke.indexOf("paint.")===0?Ht(fe[ke],_e[ke],$,le,ke.slice(6),$e.setPaintProperty):a.deepEqual(fe[ke],_e[ke])||$.push({command:$e.setLayerProperty,args:[le,ke,_e[ke]]}))}else $.push({command:$e.removeLayer,args:[le]}),Te=lt[lt.lastIndexOf(le)+1],$.push({command:$e.addLayer,args:[_e,Te]})}(G,E.layers,P)}catch(H){console.warn("Unable to compute style diff:",H),P=[{command:$e.setStyle,args:[E]}]}return P}(this.serialize(),o).filter(function(S){return!(S.command in Gr)});if(_.length===0)return!1;var w=_.filter(function(S){return!(S.command in Hi)});if(w.length>0)throw new Error("Unimplemented: "+w.map(function(S){return S.command}).join(", ")+".");return _.forEach(function(S){S.command!=="setTransition"&&c[S.command].apply(c,S.args)}),this.stylesheet=o,!0},s.prototype.addImage=function(o,c){if(this.getImage(o))return this.fire(new a.ErrorEvent(new Error("An image with this name already exists.")));this.imageManager.addImage(o,c),this._afterImageUpdated(o)},s.prototype.updateImage=function(o,c){this.imageManager.updateImage(o,c)},s.prototype.getImage=function(o){return this.imageManager.getImage(o)},s.prototype.removeImage=function(o){if(!this.getImage(o))return this.fire(new a.ErrorEvent(new Error("No image with this name exists.")));this.imageManager.removeImage(o),this._afterImageUpdated(o)},s.prototype._afterImageUpdated=function(o){this._availableImages=this.imageManager.listImages(),this._changedImages[o]=!0,this._changed=!0,this.dispatcher.broadcast("setImages",this._availableImages),this.fire(new a.Event("data",{dataType:"style"}))},s.prototype.listImages=function(){return this._checkLoaded(),this.imageManager.listImages()},s.prototype.addSource=function(o,c,_){var w=this;if(_===void 0&&(_={}),this._checkLoaded(),this.sourceCaches[o]!==void 0)throw new Error("There is already a source with this ID");if(!c.type)throw new Error("The type property must be defined, but only the following properties were given: "+Object.keys(c).join(", ")+".");if(!(["vector","raster","geojson","video","image"].indexOf(c.type)>=0&&this._validate(a.validateStyle.source,"sources."+o,c,null,_))){this.map&&this.map._collectResourceTiming&&(c.collectResourceTiming=!0);var S=this.sourceCaches[o]=new ee(o,c,this.dispatcher);S.style=this,S.setEventedParent(this,function(){return{isSourceLoaded:w.loaded(),source:S.serialize(),sourceId:o}}),S.onAdd(this.map),this._changed=!0}},s.prototype.removeSource=function(o){if(this._checkLoaded(),this.sourceCaches[o]===void 0)throw new Error("There is no source with this ID");for(var c in this._layers)if(this._layers[c].source===o)return this.fire(new a.ErrorEvent(new Error('Source "'+o+'" cannot be removed while layer "'+c+'" is using it.')));var _=this.sourceCaches[o];delete this.sourceCaches[o],delete this._updatedSources[o],_.fire(new a.Event("data",{sourceDataType:"metadata",dataType:"source",sourceId:o})),_.setEventedParent(null),_.clearTiles(),_.onRemove&&_.onRemove(this.map),this._changed=!0},s.prototype.setGeoJSONSourceData=function(o,c){this._checkLoaded(),this.sourceCaches[o].getSource().setData(c),this._changed=!0},s.prototype.getSource=function(o){return this.sourceCaches[o]&&this.sourceCaches[o].getSource()},s.prototype.addLayer=function(o,c,_){_===void 0&&(_={}),this._checkLoaded();var w=o.id;if(this.getLayer(w))this.fire(new a.ErrorEvent(new Error('Layer with id "'+w+'" already exists on this map')));else{var S;if(o.type==="custom"){if(un(this,a.validateCustomStyleLayer(o)))return;S=a.createStyleLayer(o)}else{if(typeof o.source=="object"&&(this.addSource(w,o.source),o=a.clone$1(o),o=a.extend(o,{source:w})),this._validate(a.validateStyle.layer,"layers."+w,o,{arrayIndex:-1},_))return;S=a.createStyleLayer(o),this._validateLayer(S),S.setEventedParent(this,{layer:{id:w}}),this._serializedLayers[S.id]=S.serialize()}var E=c?this._order.indexOf(c):this._order.length;if(c&&E===-1)this.fire(new a.ErrorEvent(new Error('Layer with id "'+c+'" does not exist on this map.')));else{if(this._order.splice(E,0,w),this._layerOrderChanged=!0,this._layers[w]=S,this._removedLayers[w]&&S.source&&S.type!=="custom"){var P=this._removedLayers[w];delete this._removedLayers[w],P.type!==S.type?this._updatedSources[S.source]="clear":(this._updatedSources[S.source]="reload",this.sourceCaches[S.source].pause())}this._updateLayer(S),S.onAdd&&S.onAdd(this.map)}}},s.prototype.moveLayer=function(o,c){if(this._checkLoaded(),this._changed=!0,this._layers[o]){if(o!==c){var _=this._order.indexOf(o);this._order.splice(_,1);var w=c?this._order.indexOf(c):this._order.length;c&&w===-1?this.fire(new a.ErrorEvent(new Error('Layer with id "'+c+'" does not exist on this map.'))):(this._order.splice(w,0,o),this._layerOrderChanged=!0)}}else this.fire(new a.ErrorEvent(new Error("The layer '"+o+"' does not exist in the map's style and cannot be moved.")))},s.prototype.removeLayer=function(o){this._checkLoaded();var c=this._layers[o];if(c){c.setEventedParent(null);var _=this._order.indexOf(o);this._order.splice(_,1),this._layerOrderChanged=!0,this._changed=!0,this._removedLayers[o]=c,delete this._layers[o],delete this._serializedLayers[o],delete this._updatedLayers[o],delete this._updatedPaintProps[o],c.onRemove&&c.onRemove(this.map)}else this.fire(new a.ErrorEvent(new Error("The layer '"+o+"' does not exist in the map's style and cannot be removed.")))},s.prototype.getLayer=function(o){return this._layers[o]},s.prototype.hasLayer=function(o){return o in this._layers},s.prototype.setLayerZoomRange=function(o,c,_){this._checkLoaded();var w=this.getLayer(o);w?w.minzoom===c&&w.maxzoom===_||(c!=null&&(w.minzoom=c),_!=null&&(w.maxzoom=_),this._updateLayer(w)):this.fire(new a.ErrorEvent(new Error("The layer '"+o+"' does not exist in the map's style and cannot have zoom extent.")))},s.prototype.setFilter=function(o,c,_){_===void 0&&(_={}),this._checkLoaded();var w=this.getLayer(o);if(w){if(!a.deepEqual(w.filter,c))return c==null?(w.filter=void 0,void this._updateLayer(w)):void(this._validate(a.validateStyle.filter,"layers."+w.id+".filter",c,null,_)||(w.filter=a.clone$1(c),this._updateLayer(w)))}else this.fire(new a.ErrorEvent(new Error("The layer '"+o+"' does not exist in the map's style and cannot be filtered.")))},s.prototype.getFilter=function(o){return a.clone$1(this.getLayer(o).filter)},s.prototype.setLayoutProperty=function(o,c,_,w){w===void 0&&(w={}),this._checkLoaded();var S=this.getLayer(o);S?a.deepEqual(S.getLayoutProperty(c),_)||(S.setLayoutProperty(c,_,w),this._updateLayer(S)):this.fire(new a.ErrorEvent(new Error("The layer '"+o+"' does not exist in the map's style and cannot be styled.")))},s.prototype.getLayoutProperty=function(o,c){var _=this.getLayer(o);if(_)return _.getLayoutProperty(c);this.fire(new a.ErrorEvent(new Error("The layer '"+o+"' does not exist in the map's style.")))},s.prototype.setPaintProperty=function(o,c,_,w){w===void 0&&(w={}),this._checkLoaded();var S=this.getLayer(o);S?a.deepEqual(S.getPaintProperty(c),_)||(S.setPaintProperty(c,_,w)&&this._updateLayer(S),this._changed=!0,this._updatedPaintProps[o]=!0):this.fire(new a.ErrorEvent(new Error("The layer '"+o+"' does not exist in the map's style and cannot be styled.")))},s.prototype.getPaintProperty=function(o,c){return this.getLayer(o).getPaintProperty(c)},s.prototype.setFeatureState=function(o,c){this._checkLoaded();var _=o.source,w=o.sourceLayer,S=this.sourceCaches[_];if(S!==void 0){var E=S.getSource().type;E==="geojson"&&w?this.fire(new a.ErrorEvent(new Error("GeoJSON sources cannot have a sourceLayer parameter."))):E!=="vector"||w?(o.id===void 0&&this.fire(new a.ErrorEvent(new Error("The feature id parameter must be provided."))),S.setFeatureState(w,o.id,c)):this.fire(new a.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")))}else this.fire(new a.ErrorEvent(new Error("The source '"+_+"' does not exist in the map's style.")))},s.prototype.removeFeatureState=function(o,c){this._checkLoaded();var _=o.source,w=this.sourceCaches[_];if(w!==void 0){var S=w.getSource().type,E=S==="vector"?o.sourceLayer:void 0;S!=="vector"||E?c&&typeof o.id!="string"&&typeof o.id!="number"?this.fire(new a.ErrorEvent(new Error("A feature id is required to remove its specific state property."))):w.removeFeatureState(E,o.id,c):this.fire(new a.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")))}else this.fire(new a.ErrorEvent(new Error("The source '"+_+"' does not exist in the map's style.")))},s.prototype.getFeatureState=function(o){this._checkLoaded();var c=o.source,_=o.sourceLayer,w=this.sourceCaches[c];if(w!==void 0){if(w.getSource().type!=="vector"||_)return o.id===void 0&&this.fire(new a.ErrorEvent(new Error("The feature id parameter must be provided."))),w.getFeatureState(_,o.id);this.fire(new a.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")))}else this.fire(new a.ErrorEvent(new Error("The source '"+c+"' does not exist in the map's style.")))},s.prototype.getTransition=function(){return a.extend({duration:300,delay:0},this.stylesheet&&this.stylesheet.transition)},s.prototype.serialize=function(){return a.filterObject({version:this.stylesheet.version,name:this.stylesheet.name,metadata:this.stylesheet.metadata,light:this.stylesheet.light,center:this.stylesheet.center,zoom:this.stylesheet.zoom,bearing:this.stylesheet.bearing,pitch:this.stylesheet.pitch,sprite:this.stylesheet.sprite,glyphs:this.stylesheet.glyphs,transition:this.stylesheet.transition,sources:a.mapObject(this.sourceCaches,function(o){return o.serialize()}),layers:this._serializeLayers(this._order)},function(o){return o!==void 0})},s.prototype._updateLayer=function(o){this._updatedLayers[o.id]=!0,o.source&&!this._updatedSources[o.source]&&this.sourceCaches[o.source].getSource().type!=="raster"&&(this._updatedSources[o.source]="reload",this.sourceCaches[o.source].pause()),this._changed=!0},s.prototype._flattenAndSortRenderedFeatures=function(o){for(var c=this,_=function(He){return c._layers[He].type==="fill-extrusion"},w={},S=[],E=this._order.length-1;E>=0;E--){var P=this._order[E];if(_(P)){w[P]=E;for(var O=0,Z=o;O<Z.length;O+=1){var G=Z[O][P];if(G)for(var H=0,te=G;H<te.length;H+=1)S.push(te[H])}}}S.sort(function(He,Ge){return Ge.intersectionZ-He.intersectionZ});for(var $=[],ue=this._order.length-1;ue>=0;ue--){var Y=this._order[ue];if(_(Y))for(var le=S.length-1;le>=0;le--){var fe=S[le].feature;if(w[fe.layer.id]<ue)break;$.push(fe),S.pop()}else for(var _e=0,Te=o;_e<Te.length;_e+=1){var ke=Te[_e][Y];if(ke)for(var Ae=0,Oe=ke;Ae<Oe.length;Ae+=1)$.push(Oe[Ae].feature)}}return $},s.prototype.queryRenderedFeatures=function(o,c,_){c&&c.filter&&this._validate(a.validateStyle.filter,"queryRenderedFeatures.filter",c.filter,null,c);var w={};if(c&&c.layers){if(!Array.isArray(c.layers))return this.fire(new a.ErrorEvent(new Error("parameters.layers must be an Array."))),[];for(var S=0,E=c.layers;S<E.length;S+=1){var P=E[S],O=this._layers[P];if(!O)return this.fire(new a.ErrorEvent(new Error("The layer '"+P+"' does not exist in the map's style and cannot be queried for features."))),[];w[O.source]=!0}}var Z=[];for(var G in c.availableImages=this._availableImages,this.sourceCaches)c.layers&&!w[G]||Z.push(Sr(this.sourceCaches[G],this._layers,this._serializedLayers,o,c,_));return this.placement&&Z.push(function(H,te,$,ue,Y,le,fe){for(var _e={},Te=le.queryRenderedSymbols(ue),ke=[],Ae=0,Oe=Object.keys(Te).map(Number);Ae<Oe.length;Ae+=1)ke.push(fe[Oe[Ae]]);ke.sort(en);for(var He=function(){var Tt=lt[Ge],gr=Tt.featureIndex.lookupSymbolFeatures(Te[Tt.bucketInstanceId],te,Tt.bucketIndex,Tt.sourceLayerIndex,Y.filter,Y.layers,Y.availableImages,H);for(var pt in gr){var Ut=_e[pt]=_e[pt]||[],Yt=gr[pt];Yt.sort(function(Xt,Rt){var Mt=Tt.featureSortOrder;if(Mt){var Fi=Mt.indexOf(Xt.featureIndex);return Mt.indexOf(Rt.featureIndex)-Fi}return Rt.featureIndex-Xt.featureIndex});for(var Ot=0,Bt=Yt;Ot<Bt.length;Ot+=1)Ut.push(Bt[Ot])}},Ge=0,lt=ke;Ge<lt.length;Ge+=1)He();var kt=function(Tt){_e[Tt].forEach(function(gr){var pt=gr.feature,Ut=$[H[Tt].source].getFeatureState(pt.layer["source-layer"],pt.id);pt.source=pt.layer.source,pt.layer["source-layer"]&&(pt.sourceLayer=pt.layer["source-layer"]),pt.state=Ut})};for(var It in _e)kt(It);return _e}(this._layers,this._serializedLayers,this.sourceCaches,o,c,this.placement.collisionIndex,this.placement.retainedQueryData)),this._flattenAndSortRenderedFeatures(Z)},s.prototype.querySourceFeatures=function(o,c){c&&c.filter&&this._validate(a.validateStyle.filter,"querySourceFeatures.filter",c.filter,null,c);var _=this.sourceCaches[o];return _?function(w,S){for(var E=w.getRenderableIds().map(function(te){return w.getTileByID(te)}),P=[],O={},Z=0;Z<E.length;Z++){var G=E[Z],H=G.tileID.canonical.key;O[H]||(O[H]=!0,G.querySourceFeatures(P,S))}return P}(_,c):[]},s.prototype.addSourceType=function(o,c,_){return s.getSourceType(o)?_(new Error('A source type called "'+o+'" already exists.')):(s.setSourceType(o,c),c.workerSourceURL?void this.dispatcher.broadcast("loadWorkerSource",{name:o,url:c.workerSourceURL},_):_(null,null))},s.prototype.getLight=function(){return this.light.getLight()},s.prototype.setLight=function(o,c){c===void 0&&(c={}),this._checkLoaded();var _=this.light.getLight(),w=!1;for(var S in o)if(!a.deepEqual(o[S],_[S])){w=!0;break}if(w){var E={now:a.browser.now(),transition:a.extend({duration:300,delay:0},this.stylesheet.transition)};this.light.setLight(o,c),this.light.updateTransitions(E)}},s.prototype._validate=function(o,c,_,w,S){return S===void 0&&(S={}),(!S||S.validate!==!1)&&un(this,o.call(a.validateStyle,a.extend({key:c,style:this.serialize(),value:_,styleSpec:a.styleSpec},w)))},s.prototype._remove=function(){for(var o in this._request&&(this._request.cancel(),this._request=null),this._spriteRequest&&(this._spriteRequest.cancel(),this._spriteRequest=null),a.evented.off("pluginStateChange",this._rtlTextPluginCallback),this._layers)this._layers[o].setEventedParent(null);for(var c in this.sourceCaches)this.sourceCaches[c].clearTiles(),this.sourceCaches[c].setEventedParent(null);this.imageManager.setEventedParent(null),this.setEventedParent(null),this.dispatcher.remove()},s.prototype._clearSource=function(o){this.sourceCaches[o].clearTiles()},s.prototype._reloadSource=function(o){this.sourceCaches[o].resume(),this.sourceCaches[o].reload()},s.prototype._updateSources=function(o){for(var c in this.sourceCaches)this.sourceCaches[c].update(o)},s.prototype._generateCollisionBoxes=function(){for(var o in this.sourceCaches)this._reloadSource(o)},s.prototype._updatePlacement=function(o,c,_,w,S){S===void 0&&(S=!1);for(var E=!1,P=!1,O={},Z=0,G=this._order;Z<G.length;Z+=1){var H=this._layers[G[Z]];if(H.type==="symbol"){if(!O[H.source]){var te=this.sourceCaches[H.source];O[H.source]=te.getRenderableIds(!0).map(function(fe){return te.getTileByID(fe)}).sort(function(fe,_e){return _e.tileID.overscaledZ-fe.tileID.overscaledZ||(fe.tileID.isLessThan(_e.tileID)?-1:1)})}var $=this.crossTileSymbolIndex.addLayer(H,O[H.source],o.center.lng);E=E||$}}if(this.crossTileSymbolIndex.pruneUnusedLayers(this._order),((S=S||this._layerOrderChanged||_===0)||!this.pauseablePlacement||this.pauseablePlacement.isDone()&&!this.placement.stillRecent(a.browser.now(),o.zoom))&&(this.pauseablePlacement=new co(o,this._order,S,c,_,w,this.placement),this._layerOrderChanged=!1),this.pauseablePlacement.isDone()?this.placement.setStale():(this.pauseablePlacement.continuePlacement(this._order,this._layers,O),this.pauseablePlacement.isDone()&&(this.placement=this.pauseablePlacement.commit(a.browser.now()),P=!0),E&&this.pauseablePlacement.placement.setStale()),P||E)for(var ue=0,Y=this._order;ue<Y.length;ue+=1){var le=this._layers[Y[ue]];le.type==="symbol"&&this.placement.updateLayerOpacities(le,O[le.source])}return!this.pauseablePlacement.isDone()||this.placement.hasTransitions(a.browser.now())},s.prototype._releaseSymbolFadeTiles=function(){for(var o in this.sourceCaches)this.sourceCaches[o].releaseSymbolFadeTiles()},s.prototype.getImages=function(o,c,_){this.imageManager.getImages(c.icons,_),this._updateTilesForChangedImages();var w=this.sourceCaches[c.source];w&&w.setDependencies(c.tileID.key,c.type,c.icons)},s.prototype.getGlyphs=function(o,c,_){this.glyphManager.getGlyphs(c.stacks,_)},s.prototype.getResource=function(o,c,_){return a.makeRequest(c,_)},s}(a.Evented);Bn.getSourceType=function(n){return er[n]},Bn.setSourceType=function(n,s){er[n]=s},Bn.registerForPluginStateChange=a.registerForPluginStateChange;var Si=a.createLayout([{name:"a_pos",type:"Int16",components:2}]),Oo=Br(`#ifdef GL_ES
precision mediump float;
#else
#if !defined(lowp)
#define lowp
#endif
#if !defined(mediump)
#define mediump
#endif
#if !defined(highp)
#define highp
#endif
#endif`,`#ifdef GL_ES
precision highp float;
#else
#if !defined(lowp)
#define lowp
#endif
#if !defined(mediump)
#define mediump
#endif
#if !defined(highp)
#define highp
#endif
#endif
vec2 unpack_float(const float packedValue) {int packedIntValue=int(packedValue);int v0=packedIntValue/256;return vec2(v0,packedIntValue-v0*256);}vec2 unpack_opacity(const float packedOpacity) {int intOpacity=int(packedOpacity)/2;return vec2(float(intOpacity)/127.0,mod(packedOpacity,2.0));}vec4 decode_color(const vec2 encodedColor) {return vec4(unpack_float(encodedColor[0])/255.0,unpack_float(encodedColor[1])/255.0
);}float unpack_mix_vec2(const vec2 packedValue,const float t) {return mix(packedValue[0],packedValue[1],t);}vec4 unpack_mix_color(const vec4 packedColors,const float t) {vec4 minColor=decode_color(vec2(packedColors[0],packedColors[1]));vec4 maxColor=decode_color(vec2(packedColors[2],packedColors[3]));return mix(minColor,maxColor,t);}vec2 get_pattern_pos(const vec2 pixel_coord_upper,const vec2 pixel_coord_lower,const vec2 pattern_size,const float tile_units_to_pixels,const vec2 pos) {vec2 offset=mod(mod(mod(pixel_coord_upper,pattern_size)*256.0,pattern_size)*256.0+pixel_coord_lower,pattern_size);return (tile_units_to_pixels*pos+offset)/pattern_size;}`),rc=Br(`uniform vec4 u_color;uniform float u_opacity;void main() {gl_FragColor=u_color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),Nh=Br(`uniform vec2 u_pattern_tl_a;uniform vec2 u_pattern_br_a;uniform vec2 u_pattern_tl_b;uniform vec2 u_pattern_br_b;uniform vec2 u_texsize;uniform float u_mix;uniform float u_opacity;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;void main() {vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(u_pattern_tl_a/u_texsize,u_pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(u_pattern_tl_b/u_texsize,u_pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);gl_FragColor=mix(color1,color2,u_mix)*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_pattern_size_a;uniform vec2 u_pattern_size_b;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_scale_a;uniform float u_scale_b;uniform float u_tile_units_to_pixels;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_a*u_pattern_size_a,u_tile_units_to_pixels,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_b*u_pattern_size_b,u_tile_units_to_pixels,a_pos);}"),Uh=Br(`varying vec3 v_data;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=v_data.xy;float extrude_length=length(extrude);lowp float antialiasblur=v_data.z;float antialiased_blur=-max(blur,antialiasblur);float opacity_t=smoothstep(0.0,antialiased_blur,extrude_length-1.0);float color_t=stroke_width < 0.01 ? 0.0 : smoothstep(antialiased_blur,0.0,extrude_length-radius/(radius+stroke_width));gl_FragColor=opacity_t*mix(color*opacity,stroke_color*stroke_opacity,color_t);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform bool u_scale_with_map;uniform bool u_pitch_with_map;uniform vec2 u_extrude_scale;uniform lowp float u_device_pixel_ratio;uniform highp float u_camera_to_center_distance;attribute vec2 a_pos;varying vec3 v_data;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
void main(void) {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=vec2(mod(a_pos,2.0)*2.0-1.0);vec2 circle_center=floor(a_pos*0.5);if (u_pitch_with_map) {vec2 corner_position=circle_center;if (u_scale_with_map) {corner_position+=extrude*(radius+stroke_width)*u_extrude_scale;} else {vec4 projected_center=u_matrix*vec4(circle_center,0,1);corner_position+=extrude*(radius+stroke_width)*u_extrude_scale*(projected_center.w/u_camera_to_center_distance);}gl_Position=u_matrix*vec4(corner_position,0,1);} else {gl_Position=u_matrix*vec4(circle_center,0,1);if (u_scale_with_map) {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*u_camera_to_center_distance;} else {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*gl_Position.w;}}lowp float antialiasblur=1.0/u_device_pixel_ratio/(radius+stroke_width);v_data=vec3(extrude.x,extrude.y,antialiasblur);}`),Vl=Br("void main() {gl_FragColor=vec4(1.0);}","attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),ql=Br(`uniform highp float u_intensity;varying vec2 v_extrude;
#pragma mapbox: define highp float weight
#define GAUSS_COEF 0.3989422804014327
void main() {
#pragma mapbox: initialize highp float weight
float d=-0.5*3.0*3.0*dot(v_extrude,v_extrude);float val=weight*u_intensity*GAUSS_COEF*exp(d);gl_FragColor=vec4(val,1.0,1.0,1.0);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform float u_extrude_scale;uniform float u_opacity;uniform float u_intensity;attribute vec2 a_pos;varying vec2 v_extrude;
#pragma mapbox: define highp float weight
#pragma mapbox: define mediump float radius
const highp float ZERO=1.0/255.0/16.0;
#define GAUSS_COEF 0.3989422804014327
void main(void) {
#pragma mapbox: initialize highp float weight
#pragma mapbox: initialize mediump float radius
vec2 unscaled_extrude=vec2(mod(a_pos,2.0)*2.0-1.0);float S=sqrt(-2.0*log(ZERO/weight/u_intensity/GAUSS_COEF))/3.0;v_extrude=S*unscaled_extrude;vec2 extrude=v_extrude*radius*u_extrude_scale;vec4 pos=vec4(floor(a_pos*0.5)+extrude,0,1);gl_Position=u_matrix*pos;}`),jl=Br(`uniform sampler2D u_image;uniform sampler2D u_color_ramp;uniform float u_opacity;varying vec2 v_pos;void main() {float t=texture2D(u_image,v_pos).r;vec4 color=texture2D(u_color_ramp,vec2(t,0.5));gl_FragColor=color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(0.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_world;attribute vec2 a_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos*u_world,0,1);v_pos.x=a_pos.x;v_pos.y=1.0-a_pos.y;}"),Zl=Br("varying float v_placed;varying float v_notUsed;void main() {float alpha=0.5;gl_FragColor=vec4(1.0,0.0,0.0,1.0)*alpha;if (v_placed > 0.5) {gl_FragColor=vec4(0.0,0.0,1.0,0.5)*alpha;}if (v_notUsed > 0.5) {gl_FragColor*=.1;}}","attribute vec2 a_pos;attribute vec2 a_anchor_pos;attribute vec2 a_extrude;attribute vec2 a_placed;attribute vec2 a_shift;uniform mat4 u_matrix;uniform vec2 u_extrude_scale;uniform float u_camera_to_center_distance;varying float v_placed;varying float v_notUsed;void main() {vec4 projectedPoint=u_matrix*vec4(a_anchor_pos,0,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float collision_perspective_ratio=clamp(0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,4.0);gl_Position=u_matrix*vec4(a_pos,0.0,1.0);gl_Position.xy+=(a_extrude+a_shift)*u_extrude_scale*gl_Position.w*collision_perspective_ratio;v_placed=a_placed.x;v_notUsed=a_placed.y;}"),ic=Br("varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;void main() {float alpha=0.5*min(v_perspective_ratio,1.0);float stroke_radius=0.9*max(v_perspective_ratio,1.0);float distance_to_center=length(v_extrude);float distance_to_edge=abs(distance_to_center-v_radius);float opacity_t=smoothstep(-stroke_radius,0.0,-distance_to_edge);vec4 color=mix(vec4(0.0,0.0,1.0,0.5),vec4(1.0,0.0,0.0,1.0),v_collision);gl_FragColor=color*alpha*opacity_t;}","attribute vec2 a_pos;attribute float a_radius;attribute vec2 a_flags;uniform mat4 u_matrix;uniform mat4 u_inv_matrix;uniform vec2 u_viewport_size;uniform float u_camera_to_center_distance;varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;vec3 toTilePosition(vec2 screenPos) {vec4 rayStart=u_inv_matrix*vec4(screenPos,-1.0,1.0);vec4 rayEnd  =u_inv_matrix*vec4(screenPos, 1.0,1.0);rayStart.xyz/=rayStart.w;rayEnd.xyz  /=rayEnd.w;highp float t=(0.0-rayStart.z)/(rayEnd.z-rayStart.z);return mix(rayStart.xyz,rayEnd.xyz,t);}void main() {vec2 quadCenterPos=a_pos;float radius=a_radius;float collision=a_flags.x;float vertexIdx=a_flags.y;vec2 quadVertexOffset=vec2(mix(-1.0,1.0,float(vertexIdx >=2.0)),mix(-1.0,1.0,float(vertexIdx >=1.0 && vertexIdx <=2.0)));vec2 quadVertexExtent=quadVertexOffset*radius;vec3 tilePos=toTilePosition(quadCenterPos);vec4 clipPos=u_matrix*vec4(tilePos,1.0);highp float camera_to_anchor_distance=clipPos.w;highp float collision_perspective_ratio=clamp(0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,4.0);float padding_factor=1.2;v_radius=radius;v_extrude=quadVertexExtent*padding_factor;v_perspective_ratio=collision_perspective_ratio;v_collision=collision;gl_Position=vec4(clipPos.xyz/clipPos.w,1.0)+vec4(quadVertexExtent*padding_factor/u_viewport_size*2.0,0.0,0.0);}"),nc=Br("uniform highp vec4 u_color;uniform sampler2D u_overlay;varying vec2 v_uv;void main() {vec4 overlay_color=texture2D(u_overlay,v_uv);gl_FragColor=mix(u_color,overlay_color,overlay_color.a);}","attribute vec2 a_pos;varying vec2 v_uv;uniform mat4 u_matrix;uniform float u_overlay_scale;void main() {v_uv=a_pos/8192.0;gl_Position=u_matrix*vec4(a_pos*u_overlay_scale,0,1);}"),Vh=Br(`#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
gl_FragColor=color*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec2 a_pos;uniform mat4 u_matrix;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
gl_Position=u_matrix*vec4(a_pos,0,1);}`),ls=Br(`varying vec2 v_pos;
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);gl_FragColor=outline_color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec2 a_pos;uniform mat4 u_matrix;uniform vec2 u_world;varying vec2 v_pos;
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;}`),us=Br(`uniform vec2 u_texsize;uniform sampler2D u_image;uniform float u_fade;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec2 v_pos;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);gl_FragColor=mix(color1,color2,u_fade)*alpha*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_world;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec2 v_pos;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;gl_Position=u_matrix*vec4(a_pos,0,1);vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,a_pos);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;}`),ac=Br(`uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);gl_FragColor=mix(color1,color2,u_fade)*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;gl_Position=u_matrix*vec4(a_pos,0,1);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileZoomRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileZoomRatio,a_pos);}`),rn=Br(`varying vec4 v_color;void main() {gl_FragColor=v_color;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;uniform float u_vertical_gradient;uniform lowp float u_opacity;attribute vec2 a_pos;attribute vec4 a_normal_ed;varying vec4 v_color;
#pragma mapbox: define highp float base
#pragma mapbox: define highp float height
#pragma mapbox: define highp vec4 color
void main() {
#pragma mapbox: initialize highp float base
#pragma mapbox: initialize highp float height
#pragma mapbox: initialize highp vec4 color
vec3 normal=a_normal_ed.xyz;base=max(0.0,base);height=max(0.0,height);float t=mod(normal.x,2.0);gl_Position=u_matrix*vec4(a_pos,t > 0.0 ? height : base,1);float colorvalue=color.r*0.2126+color.g*0.7152+color.b*0.0722;v_color=vec4(0.0,0.0,0.0,1.0);vec4 ambientlight=vec4(0.03,0.03,0.03,1.0);color+=ambientlight;float directional=clamp(dot(normal/16384.0,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_color.r+=clamp(color.r*directional*u_lightcolor.r,mix(0.0,0.3,1.0-u_lightcolor.r),1.0);v_color.g+=clamp(color.g*directional*u_lightcolor.g,mix(0.0,0.3,1.0-u_lightcolor.g),1.0);v_color.b+=clamp(color.b*directional*u_lightcolor.b,mix(0.0,0.3,1.0-u_lightcolor.b),1.0);v_color*=u_opacity;}`),Gl=Br(`uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec4 v_lighting;
#pragma mapbox: define lowp float base
#pragma mapbox: define lowp float height
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float base
#pragma mapbox: initialize lowp float height
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);vec4 mixedColor=mix(color1,color2,u_fade);gl_FragColor=mixedColor*v_lighting;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_height_factor;uniform vec3 u_scale;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;attribute vec2 a_pos;attribute vec4 a_normal_ed;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec4 v_lighting;
#pragma mapbox: define lowp float base
#pragma mapbox: define lowp float height
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float base
#pragma mapbox: initialize lowp float height
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec3 normal=a_normal_ed.xyz;float edgedistance=a_normal_ed.w;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;base=max(0.0,base);height=max(0.0,height);float t=mod(normal.x,2.0);float z=t > 0.0 ? height : base;gl_Position=u_matrix*vec4(a_pos,z,1);vec2 pos=normal.x==1.0 && normal.y==0.0 && normal.z==16384.0
? a_pos
: vec2(edgedistance,z*u_height_factor);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,pos);v_lighting=vec4(0.0,0.0,0.0,1.0);float directional=clamp(dot(normal/16383.0,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((0.5+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_lighting.rgb+=clamp(directional*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_lighting*=u_opacity;}`),qa=Br(`#ifdef GL_ES
precision highp float;
#endif
uniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_dimension;uniform float u_zoom;uniform vec4 u_unpack;float getElevation(vec2 coord,float bias) {vec4 data=texture2D(u_image,coord)*255.0;data.a=-1.0;return dot(data,u_unpack)/4.0;}void main() {vec2 epsilon=1.0/u_dimension;float a=getElevation(v_pos+vec2(-epsilon.x,-epsilon.y),0.0);float b=getElevation(v_pos+vec2(0,-epsilon.y),0.0);float c=getElevation(v_pos+vec2(epsilon.x,-epsilon.y),0.0);float d=getElevation(v_pos+vec2(-epsilon.x,0),0.0);float e=getElevation(v_pos,0.0);float f=getElevation(v_pos+vec2(epsilon.x,0),0.0);float g=getElevation(v_pos+vec2(-epsilon.x,epsilon.y),0.0);float h=getElevation(v_pos+vec2(0,epsilon.y),0.0);float i=getElevation(v_pos+vec2(epsilon.x,epsilon.y),0.0);float exaggerationFactor=u_zoom < 2.0 ? 0.4 : u_zoom < 4.5 ? 0.35 : 0.3;float exaggeration=u_zoom < 15.0 ? (u_zoom-15.0)*exaggerationFactor : 0.0;vec2 deriv=vec2((c+f+f+i)-(a+d+d+g),(g+h+h+i)-(a+b+b+c))/pow(2.0,exaggeration+(19.2562-u_zoom));gl_FragColor=clamp(vec4(deriv.x/2.0+0.5,deriv.y/2.0+0.5,1.0,1.0),0.0,1.0);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_dimension;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);highp vec2 epsilon=1.0/u_dimension;float scale=(u_dimension.x-2.0)/u_dimension.x;v_pos=(a_texture_pos/8192.0)*scale+epsilon;}"),ja=Br(`uniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_latrange;uniform vec2 u_light;uniform vec4 u_shadow;uniform vec4 u_highlight;uniform vec4 u_accent;
#define PI 3.141592653589793
void main() {vec4 pixel=texture2D(u_image,v_pos);vec2 deriv=((pixel.rg*2.0)-1.0);float scaleFactor=cos(radians((u_latrange[0]-u_latrange[1])*(1.0-v_pos.y)+u_latrange[1]));float slope=atan(1.25*length(deriv)/scaleFactor);float aspect=deriv.x !=0.0 ? atan(deriv.y,-deriv.x) : PI/2.0*(deriv.y > 0.0 ? 1.0 :-1.0);float intensity=u_light.x;float azimuth=u_light.y+PI;float base=1.875-intensity*1.75;float maxValue=0.5*PI;float scaledSlope=intensity !=0.5 ? ((pow(base,slope)-1.0)/(pow(base,maxValue)-1.0))*maxValue : slope;float accent=cos(scaledSlope);vec4 accent_color=(1.0-accent)*u_accent*clamp(intensity*2.0,0.0,1.0);float shade=abs(mod((aspect+azimuth)/PI+0.5,2.0)-1.0);vec4 shade_color=mix(u_shadow,u_highlight,shade)*sin(scaledSlope)*clamp(intensity*2.0,0.0,1.0);gl_FragColor=accent_color*(1.0-shade_color.a)+shade_color;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=a_texture_pos/8192.0;}"),ho=Br(`uniform lowp float u_device_pixel_ratio;varying vec2 v_width2;varying vec2 v_normal;varying float v_gamma_scale;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);gl_FragColor=color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
attribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform vec2 u_units_to_pixels;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_gamma_scale;varying highp float v_linesofar;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;v_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*2.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;v_width2=vec2(outset,inset);}`),po=Br(`uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;varying vec2 v_width2;varying vec2 v_normal;varying float v_gamma_scale;varying highp vec2 v_uv;
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);vec4 color=texture2D(u_image,v_uv);gl_FragColor=color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
attribute vec2 a_pos_normal;attribute vec4 a_data;attribute float a_uv_x;attribute float a_split_index;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_units_to_pixels;uniform float u_image_height;varying vec2 v_normal;varying vec2 v_width2;varying float v_gamma_scale;varying highp vec2 v_uv;
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;highp float texel_height=1.0/u_image_height;highp float half_texel_height=0.5*texel_height;v_uv=vec2(a_uv_x,a_split_index*texel_height-half_texel_height);vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;v_width2=vec2(outset,inset);}`),Za=Br(`uniform lowp float u_device_pixel_ratio;uniform vec2 u_texsize;uniform float u_fade;uniform mediump vec3 u_scale;uniform sampler2D u_image;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;vec2 pattern_size_a=vec2(display_size_a.x*fromScale/tileZoomRatio,display_size_a.y);vec2 pattern_size_b=vec2(display_size_b.x*toScale/tileZoomRatio,display_size_b.y);float aspect_a=display_size_a.y/v_width;float aspect_b=display_size_b.y/v_width;float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float x_a=mod(v_linesofar/pattern_size_a.x*aspect_a,1.0);float x_b=mod(v_linesofar/pattern_size_b.x*aspect_b,1.0);float y=0.5*v_normal.y+0.5;vec2 texel_size=1.0/u_texsize;vec2 pos_a=mix(pattern_tl_a*texel_size-texel_size,pattern_br_a*texel_size+texel_size,vec2(x_a,y));vec2 pos_b=mix(pattern_tl_b*texel_size-texel_size,pattern_br_b*texel_size+texel_size,vec2(x_b,y));vec4 color=mix(texture2D(u_image,pos_a),texture2D(u_image,pos_b),u_fade);gl_FragColor=color*alpha*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
#define LINE_DISTANCE_SCALE 2.0
attribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform vec2 u_units_to_pixels;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;v_linesofar=a_linesofar;v_width2=vec2(outset,inset);v_width=floorwidth;}`),fo=Br(`uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;uniform float u_sdfgamma;uniform float u_mix;varying vec2 v_normal;varying vec2 v_width2;varying vec2 v_tex_a;varying vec2 v_tex_b;varying float v_gamma_scale;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float sdfdist_a=texture2D(u_image,v_tex_a).a;float sdfdist_b=texture2D(u_image,v_tex_b).a;float sdfdist=mix(sdfdist_a,sdfdist_b,u_mix);alpha*=smoothstep(0.5-u_sdfgamma/floorwidth,0.5+u_sdfgamma/floorwidth,sdfdist);gl_FragColor=color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
#define LINE_DISTANCE_SCALE 2.0
attribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_patternscale_a;uniform float u_tex_y_a;uniform vec2 u_patternscale_b;uniform float u_tex_y_b;uniform vec2 u_units_to_pixels;varying vec2 v_normal;varying vec2 v_width2;varying vec2 v_tex_a;varying vec2 v_tex_b;varying float v_gamma_scale;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;v_tex_a=vec2(a_linesofar*u_patternscale_a.x/floorwidth,normal.y*u_patternscale_a.y+u_tex_y_a);v_tex_b=vec2(a_linesofar*u_patternscale_b.x/floorwidth,normal.y*u_patternscale_b.y+u_tex_y_b);v_width2=vec2(outset,inset);}`),mo=Br(`uniform float u_fade_t;uniform float u_opacity;uniform sampler2D u_image0;uniform sampler2D u_image1;varying vec2 v_pos0;varying vec2 v_pos1;uniform float u_brightness_low;uniform float u_brightness_high;uniform float u_saturation_factor;uniform float u_contrast_factor;uniform vec3 u_spin_weights;void main() {vec4 color0=texture2D(u_image0,v_pos0);vec4 color1=texture2D(u_image1,v_pos1);if (color0.a > 0.0) {color0.rgb=color0.rgb/color0.a;}if (color1.a > 0.0) {color1.rgb=color1.rgb/color1.a;}vec4 color=mix(color0,color1,u_fade_t);color.a*=u_opacity;vec3 rgb=color.rgb;rgb=vec3(dot(rgb,u_spin_weights.xyz),dot(rgb,u_spin_weights.zxy),dot(rgb,u_spin_weights.yzx));float average=(color.r+color.g+color.b)/3.0;rgb+=(average-rgb)*u_saturation_factor;rgb=(rgb-0.5)*u_contrast_factor+0.5;vec3 u_high_vec=vec3(u_brightness_low,u_brightness_low,u_brightness_low);vec3 u_low_vec=vec3(u_brightness_high,u_brightness_high,u_brightness_high);gl_FragColor=vec4(mix(u_high_vec,u_low_vec,rgb)*color.a,color.a);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_tl_parent;uniform float u_scale_parent;uniform float u_buffer_scale;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos0;varying vec2 v_pos1;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos0=(((a_texture_pos/8192.0)-0.5)/u_buffer_scale )+0.5;v_pos1=(v_pos0*u_scale_parent)+u_tl_parent;}"),Ga=Br(`uniform sampler2D u_texture;varying vec2 v_tex;varying float v_fade_opacity;
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float opacity
lowp float alpha=opacity*v_fade_opacity;gl_FragColor=texture2D(u_texture,v_tex)*alpha;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`const float PI=3.141592653589793;attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec4 a_pixeloffset;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform highp float u_camera_to_center_distance;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform float u_fade_change;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform vec2 u_texsize;varying vec2 v_tex;varying float v_fade_opacity;
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float opacity
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;vec2 a_minFontScale=a_pixeloffset.zw/256.0;highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec4 projectedPoint=u_matrix*vec4(a_pos,0,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),0,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,0.0,1.0);gl_Position=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*max(a_minFontScale,fontScale)+a_pxoffset/16.0),0.0,1.0);v_tex=a_tex/u_texsize;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;v_fade_opacity=max(0.0,min(1.0,fade_opacity[0]+fade_change));}`),oc=Br(`#define SDF_PX 8.0
uniform bool u_is_halo;uniform sampler2D u_texture;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;uniform bool u_is_text;varying vec2 v_data0;varying vec3 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
float EDGE_GAMMA=0.105/u_device_pixel_ratio;vec2 tex=v_data0.xy;float gamma_scale=v_data1.x;float size=v_data1.y;float fade_opacity=v_data1[2];float fontScale=u_is_text ? size/24.0 : size;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);gl_FragColor=color*(alpha*opacity*fade_opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`const float PI=3.141592653589793;attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec4 a_pixeloffset;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;varying vec2 v_data0;varying vec3 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec4 projectedPoint=u_matrix*vec4(a_pos,0,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),0,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,0.0,1.0);gl_Position=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale+a_pxoffset),0.0,1.0);float gamma_scale=gl_Position.w;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(1.0,fade_opacity[0]+fade_change));v_data0=a_tex/u_texsize;v_data1=vec3(gamma_scale,size,interpolated_fade_opacity);}`),sc=Br(`#define SDF_PX 8.0
#define SDF 1.0
#define ICON 0.0
uniform bool u_is_halo;uniform sampler2D u_texture;uniform sampler2D u_texture_icon;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;varying vec4 v_data0;varying vec4 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
float fade_opacity=v_data1[2];if (v_data1.w==ICON) {vec2 tex_icon=v_data0.zw;lowp float alpha=opacity*fade_opacity;gl_FragColor=texture2D(u_texture_icon,tex_icon)*alpha;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
return;}vec2 tex=v_data0.xy;float EDGE_GAMMA=0.105/u_device_pixel_ratio;float gamma_scale=v_data1.x;float size=v_data1.y;float fontScale=size/24.0;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);gl_FragColor=color*(alpha*opacity*fade_opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`const float PI=3.141592653589793;attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec2 u_texsize_icon;varying vec4 v_data0;varying vec4 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);float is_sdf=a_size[0]-2.0*a_size_min;highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec4 projectedPoint=u_matrix*vec4(a_pos,0,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=size/24.0;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),0,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,0.0,1.0);gl_Position=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale),0.0,1.0);float gamma_scale=gl_Position.w;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(1.0,fade_opacity[0]+fade_change));v_data0.xy=a_tex/u_texsize;v_data0.zw=a_tex/u_texsize_icon;v_data1=vec4(gamma_scale,size,interpolated_fade_opacity,is_sdf);}`);function Br(n,s){var o=/#pragma mapbox: ([\w]+) ([\w]+) ([\w]+) ([\w]+)/g,c=s.match(/attribute ([\w]+) ([\w]+)/g),_=n.match(/uniform ([\w]+) ([\w]+)([\s]*)([\w]*)/g),w=s.match(/uniform ([\w]+) ([\w]+)([\s]*)([\w]*)/g),S=w?w.concat(_):_,E={};return{fragmentSource:n=n.replace(o,function(P,O,Z,G,H){return E[H]=!0,O==="define"?`
#ifndef HAS_UNIFORM_u_`+H+`
varying `+Z+" "+G+" "+H+`;
#else
uniform `+Z+" "+G+" u_"+H+`;
#endif
`:`
#ifdef HAS_UNIFORM_u_`+H+`
    `+Z+" "+G+" "+H+" = u_"+H+`;
#endif
`}),vertexSource:s=s.replace(o,function(P,O,Z,G,H){var te=G==="float"?"vec2":"vec4",$=H.match(/color/)?"color":te;return E[H]?O==="define"?`
#ifndef HAS_UNIFORM_u_`+H+`
uniform lowp float u_`+H+`_t;
attribute `+Z+" "+te+" a_"+H+`;
varying `+Z+" "+G+" "+H+`;
#else
uniform `+Z+" "+G+" u_"+H+`;
#endif
`:$==="vec4"?`
#ifndef HAS_UNIFORM_u_`+H+`
    `+H+" = a_"+H+`;
#else
    `+Z+" "+G+" "+H+" = u_"+H+`;
#endif
`:`
#ifndef HAS_UNIFORM_u_`+H+`
    `+H+" = unpack_mix_"+$+"(a_"+H+", u_"+H+`_t);
#else
    `+Z+" "+G+" "+H+" = u_"+H+`;
#endif
`:O==="define"?`
#ifndef HAS_UNIFORM_u_`+H+`
uniform lowp float u_`+H+`_t;
attribute `+Z+" "+te+" a_"+H+`;
#else
uniform `+Z+" "+G+" u_"+H+`;
#endif
`:$==="vec4"?`
#ifndef HAS_UNIFORM_u_`+H+`
    `+Z+" "+G+" "+H+" = a_"+H+`;
#else
    `+Z+" "+G+" "+H+" = u_"+H+`;
#endif
`:`
#ifndef HAS_UNIFORM_u_`+H+`
    `+Z+" "+G+" "+H+" = unpack_mix_"+$+"(a_"+H+", u_"+H+`_t);
#else
    `+Z+" "+G+" "+H+" = u_"+H+`;
#endif
`}),staticAttributes:c,staticUniforms:S}}var qh=Object.freeze({__proto__:null,prelude:Oo,background:rc,backgroundPattern:Nh,circle:Uh,clippingMask:Vl,heatmap:ql,heatmapTexture:jl,collisionBox:Zl,collisionCircle:ic,debug:nc,fill:Vh,fillOutline:ls,fillOutlinePattern:us,fillPattern:ac,fillExtrusion:rn,fillExtrusionPattern:Gl,hillshadePrepare:qa,hillshade:ja,line:ho,lineGradient:po,linePattern:Za,lineSDF:fo,raster:mo,symbolIcon:Ga,symbolSDF:oc,symbolTextAndIcon:sc}),Us=function(){this.boundProgram=null,this.boundLayoutVertexBuffer=null,this.boundPaintVertexBuffers=[],this.boundIndexBuffer=null,this.boundVertexOffset=null,this.boundDynamicVertexBuffer=null,this.vao=null};function lc(n){for(var s=[],o=0;o<n.length;o++)if(n[o]!==null){var c=n[o].split(" ");s.push(c.pop())}return s}Us.prototype.bind=function(n,s,o,c,_,w,S,E){this.context=n;for(var P=this.boundPaintVertexBuffers.length!==c.length,O=0;!P&&O<c.length;O++)this.boundPaintVertexBuffers[O]!==c[O]&&(P=!0);n.extVertexArrayObject&&this.vao&&this.boundProgram===s&&this.boundLayoutVertexBuffer===o&&!P&&this.boundIndexBuffer===_&&this.boundVertexOffset===w&&this.boundDynamicVertexBuffer===S&&this.boundDynamicVertexBuffer2===E?(n.bindVertexArrayOES.set(this.vao),S&&S.bind(),_&&_.dynamicDraw&&_.bind(),E&&E.bind()):this.freshBind(s,o,c,_,w,S,E)},Us.prototype.freshBind=function(n,s,o,c,_,w,S){var E,P=n.numAttributes,O=this.context,Z=O.gl;if(O.extVertexArrayObject)this.vao&&this.destroy(),this.vao=O.extVertexArrayObject.createVertexArrayOES(),O.bindVertexArrayOES.set(this.vao),E=0,this.boundProgram=n,this.boundLayoutVertexBuffer=s,this.boundPaintVertexBuffers=o,this.boundIndexBuffer=c,this.boundVertexOffset=_,this.boundDynamicVertexBuffer=w,this.boundDynamicVertexBuffer2=S;else{E=O.currentNumAttributes||0;for(var G=P;G<E;G++)Z.disableVertexAttribArray(G)}s.enableAttributes(Z,n);for(var H=0,te=o;H<te.length;H+=1)te[H].enableAttributes(Z,n);w&&w.enableAttributes(Z,n),S&&S.enableAttributes(Z,n),s.bind(),s.setVertexAttribPointers(Z,n,_);for(var $=0,ue=o;$<ue.length;$+=1){var Y=ue[$];Y.bind(),Y.setVertexAttribPointers(Z,n,_)}w&&(w.bind(),w.setVertexAttribPointers(Z,n,_)),c&&c.bind(),S&&(S.bind(),S.setVertexAttribPointers(Z,n,_)),O.currentNumAttributes=P},Us.prototype.destroy=function(){this.vao&&(this.context.extVertexArrayObject.deleteVertexArrayOES(this.vao),this.vao=null)};var uc=function(n,s,o,c,_,w){var S=n.gl;this.program=S.createProgram();for(var E=lc(o.staticAttributes),P=c?c.getBinderAttributes():[],O=E.concat(P),Z=o.staticUniforms?lc(o.staticUniforms):[],G=c?c.getBinderUniforms():[],H=[],te=0,$=Z.concat(G);te<$.length;te+=1){var ue=$[te];H.indexOf(ue)<0&&H.push(ue)}var Y=c?c.defines():[];w&&Y.push("#define OVERDRAW_INSPECTOR;");var le=Y.concat(Oo.fragmentSource,o.fragmentSource).join(`
`),fe=Y.concat(Oo.vertexSource,o.vertexSource).join(`
`),_e=S.createShader(S.FRAGMENT_SHADER);if(S.isContextLost())this.failedToCreate=!0;else{S.shaderSource(_e,le),S.compileShader(_e),S.attachShader(this.program,_e);var Te=S.createShader(S.VERTEX_SHADER);if(S.isContextLost())this.failedToCreate=!0;else{S.shaderSource(Te,fe),S.compileShader(Te),S.attachShader(this.program,Te),this.attributes={};var ke={};this.numAttributes=O.length;for(var Ae=0;Ae<this.numAttributes;Ae++)O[Ae]&&(S.bindAttribLocation(this.program,Ae,O[Ae]),this.attributes[O[Ae]]=Ae);S.linkProgram(this.program),S.deleteShader(Te),S.deleteShader(_e);for(var Oe=0;Oe<H.length;Oe++){var He=H[Oe];if(He&&!ke[He]){var Ge=S.getUniformLocation(this.program,He);Ge&&(ke[He]=Ge)}}this.fixedUniforms=_(n,ke),this.binderUniforms=c?c.getUniforms(n,ke):[]}}};function cc(n,s,o){var c=1/Dr(o,1,s.transform.tileZoom),_=Math.pow(2,o.tileID.overscaledZ),w=o.tileSize*Math.pow(2,s.transform.tileZoom)/_,S=w*(o.tileID.canonical.x+o.tileID.wrap*_),E=w*o.tileID.canonical.y;return{u_image:0,u_texsize:o.imageAtlasTexture.size,u_scale:[c,n.fromScale,n.toScale],u_fade:n.t,u_pixel_coord_upper:[S>>16,E>>16],u_pixel_coord_lower:[65535&S,65535&E]}}uc.prototype.draw=function(n,s,o,c,_,w,S,E,P,O,Z,G,H,te,$,ue){var Y,le=n.gl;if(!this.failedToCreate){for(var fe in n.program.set(this.program),n.setDepthMode(o),n.setStencilMode(c),n.setColorMode(_),n.setCullFace(w),this.fixedUniforms)this.fixedUniforms[fe].set(S[fe]);te&&te.setUniforms(n,this.binderUniforms,G,{zoom:H});for(var _e=(Y={},Y[le.LINES]=2,Y[le.TRIANGLES]=3,Y[le.LINE_STRIP]=1,Y)[s],Te=0,ke=Z.get();Te<ke.length;Te+=1){var Ae=ke[Te],Oe=Ae.vaos||(Ae.vaos={});(Oe[E]||(Oe[E]=new Us)).bind(n,this,P,te?te.getPaintVertexBuffers():[],O,Ae.vertexOffset,$,ue),le.drawElements(s,Ae.primitiveLength*_e,le.UNSIGNED_SHORT,Ae.primitiveOffset*_e*2)}}};var hc=function(n,s,o,c){var _=s.style.light,w=_.properties.get("position"),S=[w.x,w.y,w.z],E=a.create$1();_.properties.get("anchor")==="viewport"&&a.fromRotation(E,-s.transform.angle),a.transformMat3(S,S,E);var P=_.properties.get("color");return{u_matrix:n,u_lightpos:S,u_lightintensity:_.properties.get("intensity"),u_lightcolor:[P.r,P.g,P.b],u_vertical_gradient:+o,u_opacity:c}},yo=function(n,s,o,c,_,w,S){return a.extend(hc(n,s,o,c),cc(w,s,S),{u_height_factor:-Math.pow(2,_.overscaledZ)/S.tileSize/8})},Ka=function(n){return{u_matrix:n}},go=function(n,s,o,c){return a.extend(Ka(n),cc(o,s,c))},pc=function(n,s){return{u_matrix:n,u_world:s}},fc=function(n,s,o,c,_){return a.extend(go(n,s,o,c),{u_world:_})},Kl=function(n,s,o,c){var _,w,S=n.transform;if(c.paint.get("circle-pitch-alignment")==="map"){var E=Dr(o,1,S.zoom);_=!0,w=[E,E]}else _=!1,w=S.pixelsToGLUnits;return{u_camera_to_center_distance:S.cameraToCenterDistance,u_scale_with_map:+(c.paint.get("circle-pitch-scale")==="map"),u_matrix:n.translatePosMatrix(s.posMatrix,o,c.paint.get("circle-translate"),c.paint.get("circle-translate-anchor")),u_pitch_with_map:+_,u_device_pixel_ratio:a.browser.devicePixelRatio,u_extrude_scale:w}},_o=function(n,s,o){var c=Dr(o,1,s.zoom),_=Math.pow(2,s.zoom-o.tileID.overscaledZ),w=o.tileID.overscaleFactor();return{u_matrix:n,u_camera_to_center_distance:s.cameraToCenterDistance,u_pixels_to_tile_units:c,u_extrude_scale:[s.pixelsToGLUnits[0]/(c*_),s.pixelsToGLUnits[1]/(c*_)],u_overscale_factor:w}},dc=function(n,s,o){return{u_matrix:n,u_inv_matrix:s,u_camera_to_center_distance:o.cameraToCenterDistance,u_viewport_size:[o.width,o.height]}},vo=function(n,s,o){return o===void 0&&(o=1),{u_matrix:n,u_color:s,u_overlay:0,u_overlay_scale:o}},bo=function(n){return{u_matrix:n}},mc=function(n,s,o,c){return{u_matrix:n,u_extrude_scale:Dr(s,1,o),u_intensity:c}},cs=function(n,s,o){var c=n.transform;return{u_matrix:yc(n,s,o),u_ratio:1/Dr(s,1,c.zoom),u_device_pixel_ratio:a.browser.devicePixelRatio,u_units_to_pixels:[1/c.pixelsToGLUnits[0],1/c.pixelsToGLUnits[1]]}},Nr=function(n,s,o,c){return a.extend(cs(n,s,o),{u_image:0,u_image_height:c})},Vs=function(n,s,o,c){var _=n.transform,w=Fo(s,_);return{u_matrix:yc(n,s,o),u_texsize:s.imageAtlasTexture.size,u_ratio:1/Dr(s,1,_.zoom),u_device_pixel_ratio:a.browser.devicePixelRatio,u_image:0,u_scale:[w,c.fromScale,c.toScale],u_fade:c.t,u_units_to_pixels:[1/_.pixelsToGLUnits[0],1/_.pixelsToGLUnits[1]]}},jh=function(n,s,o,c,_){var w=n.lineAtlas,S=Fo(s,n.transform),E=o.layout.get("line-cap")==="round",P=w.getDash(c.from,E),O=w.getDash(c.to,E),Z=P.width*_.fromScale,G=O.width*_.toScale;return a.extend(cs(n,s,o),{u_patternscale_a:[S/Z,-P.height/2],u_patternscale_b:[S/G,-O.height/2],u_sdfgamma:w.width/(256*Math.min(Z,G)*a.browser.devicePixelRatio)/2,u_image:0,u_tex_y_a:P.y,u_tex_y_b:O.y,u_mix:_.t})};function Fo(n,s){return 1/Dr(n,1,s.tileZoom)}function yc(n,s,o){return n.translatePosMatrix(s.tileID.posMatrix,s,o.paint.get("line-translate"),o.paint.get("line-translate-anchor"))}var Zh=function(n,s,o,c,_){return{u_matrix:n,u_tl_parent:s,u_scale_parent:o,u_buffer_scale:1,u_fade_t:c.mix,u_opacity:c.opacity*_.paint.get("raster-opacity"),u_image0:0,u_image1:1,u_brightness_low:_.paint.get("raster-brightness-min"),u_brightness_high:_.paint.get("raster-brightness-max"),u_saturation_factor:(S=_.paint.get("raster-saturation"),S>0?1-1/(1.001-S):-S),u_contrast_factor:(w=_.paint.get("raster-contrast"),w>0?1/(1-w):1+w),u_spin_weights:gc(_.paint.get("raster-hue-rotate"))};var w,S};function gc(n){n*=Math.PI/180;var s=Math.sin(n),o=Math.cos(n);return[(2*o+1)/3,(-Math.sqrt(3)*s-o+1)/3,(Math.sqrt(3)*s-o+1)/3]}var qs,No=function(n,s,o,c,_,w,S,E,P,O){var Z=_.transform;return{u_is_size_zoom_constant:+(n==="constant"||n==="source"),u_is_size_feature_constant:+(n==="constant"||n==="camera"),u_size_t:s?s.uSizeT:0,u_size:s?s.uSize:0,u_camera_to_center_distance:Z.cameraToCenterDistance,u_pitch:Z.pitch/360*2*Math.PI,u_rotate_symbol:+o,u_aspect_ratio:Z.width/Z.height,u_fade_change:_.options.fadeDuration?_.symbolFadeChange:1,u_matrix:w,u_label_plane_matrix:S,u_coord_matrix:E,u_is_text:+P,u_pitch_with_map:+c,u_texsize:O,u_texture:0}},hs=function(n,s,o,c,_,w,S,E,P,O,Z){var G=_.transform;return a.extend(No(n,s,o,c,_,w,S,E,P,O),{u_gamma_scale:c?Math.cos(G._pitch)*G.cameraToCenterDistance:1,u_device_pixel_ratio:a.browser.devicePixelRatio,u_is_halo:+Z})},js=function(n,s,o,c,_,w,S,E,P,O){return a.extend(hs(n,s,o,c,_,w,S,E,!0,P,!0),{u_texsize_icon:O,u_texture_icon:1})},ps=function(n,s,o){return{u_matrix:n,u_opacity:s,u_color:o}},Uo=function(n,s,o,c,_,w){return a.extend(function(S,E,P,O){var Z=P.imageManager.getPattern(S.from.toString()),G=P.imageManager.getPattern(S.to.toString()),H=P.imageManager.getPixelSize(),te=H.width,$=H.height,ue=Math.pow(2,O.tileID.overscaledZ),Y=O.tileSize*Math.pow(2,P.transform.tileZoom)/ue,le=Y*(O.tileID.canonical.x+O.tileID.wrap*ue),fe=Y*O.tileID.canonical.y;return{u_image:0,u_pattern_tl_a:Z.tl,u_pattern_br_a:Z.br,u_pattern_tl_b:G.tl,u_pattern_br_b:G.br,u_texsize:[te,$],u_mix:E.t,u_pattern_size_a:Z.displaySize,u_pattern_size_b:G.displaySize,u_scale_a:E.fromScale,u_scale_b:E.toScale,u_tile_units_to_pixels:1/Dr(O,1,P.transform.tileZoom),u_pixel_coord_upper:[le>>16,fe>>16],u_pixel_coord_lower:[65535&le,65535&fe]}}(c,w,o,_),{u_matrix:n,u_opacity:s})},_c={fillExtrusion:function(n,s){return{u_matrix:new a.UniformMatrix4f(n,s.u_matrix),u_lightpos:new a.Uniform3f(n,s.u_lightpos),u_lightintensity:new a.Uniform1f(n,s.u_lightintensity),u_lightcolor:new a.Uniform3f(n,s.u_lightcolor),u_vertical_gradient:new a.Uniform1f(n,s.u_vertical_gradient),u_opacity:new a.Uniform1f(n,s.u_opacity)}},fillExtrusionPattern:function(n,s){return{u_matrix:new a.UniformMatrix4f(n,s.u_matrix),u_lightpos:new a.Uniform3f(n,s.u_lightpos),u_lightintensity:new a.Uniform1f(n,s.u_lightintensity),u_lightcolor:new a.Uniform3f(n,s.u_lightcolor),u_vertical_gradient:new a.Uniform1f(n,s.u_vertical_gradient),u_height_factor:new a.Uniform1f(n,s.u_height_factor),u_image:new a.Uniform1i(n,s.u_image),u_texsize:new a.Uniform2f(n,s.u_texsize),u_pixel_coord_upper:new a.Uniform2f(n,s.u_pixel_coord_upper),u_pixel_coord_lower:new a.Uniform2f(n,s.u_pixel_coord_lower),u_scale:new a.Uniform3f(n,s.u_scale),u_fade:new a.Uniform1f(n,s.u_fade),u_opacity:new a.Uniform1f(n,s.u_opacity)}},fill:function(n,s){return{u_matrix:new a.UniformMatrix4f(n,s.u_matrix)}},fillPattern:function(n,s){return{u_matrix:new a.UniformMatrix4f(n,s.u_matrix),u_image:new a.Uniform1i(n,s.u_image),u_texsize:new a.Uniform2f(n,s.u_texsize),u_pixel_coord_upper:new a.Uniform2f(n,s.u_pixel_coord_upper),u_pixel_coord_lower:new a.Uniform2f(n,s.u_pixel_coord_lower),u_scale:new a.Uniform3f(n,s.u_scale),u_fade:new a.Uniform1f(n,s.u_fade)}},fillOutline:function(n,s){return{u_matrix:new a.UniformMatrix4f(n,s.u_matrix),u_world:new a.Uniform2f(n,s.u_world)}},fillOutlinePattern:function(n,s){return{u_matrix:new a.UniformMatrix4f(n,s.u_matrix),u_world:new a.Uniform2f(n,s.u_world),u_image:new a.Uniform1i(n,s.u_image),u_texsize:new a.Uniform2f(n,s.u_texsize),u_pixel_coord_upper:new a.Uniform2f(n,s.u_pixel_coord_upper),u_pixel_coord_lower:new a.Uniform2f(n,s.u_pixel_coord_lower),u_scale:new a.Uniform3f(n,s.u_scale),u_fade:new a.Uniform1f(n,s.u_fade)}},circle:function(n,s){return{u_camera_to_center_distance:new a.Uniform1f(n,s.u_camera_to_center_distance),u_scale_with_map:new a.Uniform1i(n,s.u_scale_with_map),u_pitch_with_map:new a.Uniform1i(n,s.u_pitch_with_map),u_extrude_scale:new a.Uniform2f(n,s.u_extrude_scale),u_device_pixel_ratio:new a.Uniform1f(n,s.u_device_pixel_ratio),u_matrix:new a.UniformMatrix4f(n,s.u_matrix)}},collisionBox:function(n,s){return{u_matrix:new a.UniformMatrix4f(n,s.u_matrix),u_camera_to_center_distance:new a.Uniform1f(n,s.u_camera_to_center_distance),u_pixels_to_tile_units:new a.Uniform1f(n,s.u_pixels_to_tile_units),u_extrude_scale:new a.Uniform2f(n,s.u_extrude_scale),u_overscale_factor:new a.Uniform1f(n,s.u_overscale_factor)}},collisionCircle:function(n,s){return{u_matrix:new a.UniformMatrix4f(n,s.u_matrix),u_inv_matrix:new a.UniformMatrix4f(n,s.u_inv_matrix),u_camera_to_center_distance:new a.Uniform1f(n,s.u_camera_to_center_distance),u_viewport_size:new a.Uniform2f(n,s.u_viewport_size)}},debug:function(n,s){return{u_color:new a.UniformColor(n,s.u_color),u_matrix:new a.UniformMatrix4f(n,s.u_matrix),u_overlay:new a.Uniform1i(n,s.u_overlay),u_overlay_scale:new a.Uniform1f(n,s.u_overlay_scale)}},clippingMask:function(n,s){return{u_matrix:new a.UniformMatrix4f(n,s.u_matrix)}},heatmap:function(n,s){return{u_extrude_scale:new a.Uniform1f(n,s.u_extrude_scale),u_intensity:new a.Uniform1f(n,s.u_intensity),u_matrix:new a.UniformMatrix4f(n,s.u_matrix)}},heatmapTexture:function(n,s){return{u_matrix:new a.UniformMatrix4f(n,s.u_matrix),u_world:new a.Uniform2f(n,s.u_world),u_image:new a.Uniform1i(n,s.u_image),u_color_ramp:new a.Uniform1i(n,s.u_color_ramp),u_opacity:new a.Uniform1f(n,s.u_opacity)}},hillshade:function(n,s){return{u_matrix:new a.UniformMatrix4f(n,s.u_matrix),u_image:new a.Uniform1i(n,s.u_image),u_latrange:new a.Uniform2f(n,s.u_latrange),u_light:new a.Uniform2f(n,s.u_light),u_shadow:new a.UniformColor(n,s.u_shadow),u_highlight:new a.UniformColor(n,s.u_highlight),u_accent:new a.UniformColor(n,s.u_accent)}},hillshadePrepare:function(n,s){return{u_matrix:new a.UniformMatrix4f(n,s.u_matrix),u_image:new a.Uniform1i(n,s.u_image),u_dimension:new a.Uniform2f(n,s.u_dimension),u_zoom:new a.Uniform1f(n,s.u_zoom),u_unpack:new a.Uniform4f(n,s.u_unpack)}},line:function(n,s){return{u_matrix:new a.UniformMatrix4f(n,s.u_matrix),u_ratio:new a.Uniform1f(n,s.u_ratio),u_device_pixel_ratio:new a.Uniform1f(n,s.u_device_pixel_ratio),u_units_to_pixels:new a.Uniform2f(n,s.u_units_to_pixels)}},lineGradient:function(n,s){return{u_matrix:new a.UniformMatrix4f(n,s.u_matrix),u_ratio:new a.Uniform1f(n,s.u_ratio),u_device_pixel_ratio:new a.Uniform1f(n,s.u_device_pixel_ratio),u_units_to_pixels:new a.Uniform2f(n,s.u_units_to_pixels),u_image:new a.Uniform1i(n,s.u_image),u_image_height:new a.Uniform1f(n,s.u_image_height)}},linePattern:function(n,s){return{u_matrix:new a.UniformMatrix4f(n,s.u_matrix),u_texsize:new a.Uniform2f(n,s.u_texsize),u_ratio:new a.Uniform1f(n,s.u_ratio),u_device_pixel_ratio:new a.Uniform1f(n,s.u_device_pixel_ratio),u_image:new a.Uniform1i(n,s.u_image),u_units_to_pixels:new a.Uniform2f(n,s.u_units_to_pixels),u_scale:new a.Uniform3f(n,s.u_scale),u_fade:new a.Uniform1f(n,s.u_fade)}},lineSDF:function(n,s){return{u_matrix:new a.UniformMatrix4f(n,s.u_matrix),u_ratio:new a.Uniform1f(n,s.u_ratio),u_device_pixel_ratio:new a.Uniform1f(n,s.u_device_pixel_ratio),u_units_to_pixels:new a.Uniform2f(n,s.u_units_to_pixels),u_patternscale_a:new a.Uniform2f(n,s.u_patternscale_a),u_patternscale_b:new a.Uniform2f(n,s.u_patternscale_b),u_sdfgamma:new a.Uniform1f(n,s.u_sdfgamma),u_image:new a.Uniform1i(n,s.u_image),u_tex_y_a:new a.Uniform1f(n,s.u_tex_y_a),u_tex_y_b:new a.Uniform1f(n,s.u_tex_y_b),u_mix:new a.Uniform1f(n,s.u_mix)}},raster:function(n,s){return{u_matrix:new a.UniformMatrix4f(n,s.u_matrix),u_tl_parent:new a.Uniform2f(n,s.u_tl_parent),u_scale_parent:new a.Uniform1f(n,s.u_scale_parent),u_buffer_scale:new a.Uniform1f(n,s.u_buffer_scale),u_fade_t:new a.Uniform1f(n,s.u_fade_t),u_opacity:new a.Uniform1f(n,s.u_opacity),u_image0:new a.Uniform1i(n,s.u_image0),u_image1:new a.Uniform1i(n,s.u_image1),u_brightness_low:new a.Uniform1f(n,s.u_brightness_low),u_brightness_high:new a.Uniform1f(n,s.u_brightness_high),u_saturation_factor:new a.Uniform1f(n,s.u_saturation_factor),u_contrast_factor:new a.Uniform1f(n,s.u_contrast_factor),u_spin_weights:new a.Uniform3f(n,s.u_spin_weights)}},symbolIcon:function(n,s){return{u_is_size_zoom_constant:new a.Uniform1i(n,s.u_is_size_zoom_constant),u_is_size_feature_constant:new a.Uniform1i(n,s.u_is_size_feature_constant),u_size_t:new a.Uniform1f(n,s.u_size_t),u_size:new a.Uniform1f(n,s.u_size),u_camera_to_center_distance:new a.Uniform1f(n,s.u_camera_to_center_distance),u_pitch:new a.Uniform1f(n,s.u_pitch),u_rotate_symbol:new a.Uniform1i(n,s.u_rotate_symbol),u_aspect_ratio:new a.Uniform1f(n,s.u_aspect_ratio),u_fade_change:new a.Uniform1f(n,s.u_fade_change),u_matrix:new a.UniformMatrix4f(n,s.u_matrix),u_label_plane_matrix:new a.UniformMatrix4f(n,s.u_label_plane_matrix),u_coord_matrix:new a.UniformMatrix4f(n,s.u_coord_matrix),u_is_text:new a.Uniform1i(n,s.u_is_text),u_pitch_with_map:new a.Uniform1i(n,s.u_pitch_with_map),u_texsize:new a.Uniform2f(n,s.u_texsize),u_texture:new a.Uniform1i(n,s.u_texture)}},symbolSDF:function(n,s){return{u_is_size_zoom_constant:new a.Uniform1i(n,s.u_is_size_zoom_constant),u_is_size_feature_constant:new a.Uniform1i(n,s.u_is_size_feature_constant),u_size_t:new a.Uniform1f(n,s.u_size_t),u_size:new a.Uniform1f(n,s.u_size),u_camera_to_center_distance:new a.Uniform1f(n,s.u_camera_to_center_distance),u_pitch:new a.Uniform1f(n,s.u_pitch),u_rotate_symbol:new a.Uniform1i(n,s.u_rotate_symbol),u_aspect_ratio:new a.Uniform1f(n,s.u_aspect_ratio),u_fade_change:new a.Uniform1f(n,s.u_fade_change),u_matrix:new a.UniformMatrix4f(n,s.u_matrix),u_label_plane_matrix:new a.UniformMatrix4f(n,s.u_label_plane_matrix),u_coord_matrix:new a.UniformMatrix4f(n,s.u_coord_matrix),u_is_text:new a.Uniform1i(n,s.u_is_text),u_pitch_with_map:new a.Uniform1i(n,s.u_pitch_with_map),u_texsize:new a.Uniform2f(n,s.u_texsize),u_texture:new a.Uniform1i(n,s.u_texture),u_gamma_scale:new a.Uniform1f(n,s.u_gamma_scale),u_device_pixel_ratio:new a.Uniform1f(n,s.u_device_pixel_ratio),u_is_halo:new a.Uniform1i(n,s.u_is_halo)}},symbolTextAndIcon:function(n,s){return{u_is_size_zoom_constant:new a.Uniform1i(n,s.u_is_size_zoom_constant),u_is_size_feature_constant:new a.Uniform1i(n,s.u_is_size_feature_constant),u_size_t:new a.Uniform1f(n,s.u_size_t),u_size:new a.Uniform1f(n,s.u_size),u_camera_to_center_distance:new a.Uniform1f(n,s.u_camera_to_center_distance),u_pitch:new a.Uniform1f(n,s.u_pitch),u_rotate_symbol:new a.Uniform1i(n,s.u_rotate_symbol),u_aspect_ratio:new a.Uniform1f(n,s.u_aspect_ratio),u_fade_change:new a.Uniform1f(n,s.u_fade_change),u_matrix:new a.UniformMatrix4f(n,s.u_matrix),u_label_plane_matrix:new a.UniformMatrix4f(n,s.u_label_plane_matrix),u_coord_matrix:new a.UniformMatrix4f(n,s.u_coord_matrix),u_is_text:new a.Uniform1i(n,s.u_is_text),u_pitch_with_map:new a.Uniform1i(n,s.u_pitch_with_map),u_texsize:new a.Uniform2f(n,s.u_texsize),u_texsize_icon:new a.Uniform2f(n,s.u_texsize_icon),u_texture:new a.Uniform1i(n,s.u_texture),u_texture_icon:new a.Uniform1i(n,s.u_texture_icon),u_gamma_scale:new a.Uniform1f(n,s.u_gamma_scale),u_device_pixel_ratio:new a.Uniform1f(n,s.u_device_pixel_ratio),u_is_halo:new a.Uniform1i(n,s.u_is_halo)}},background:function(n,s){return{u_matrix:new a.UniformMatrix4f(n,s.u_matrix),u_opacity:new a.Uniform1f(n,s.u_opacity),u_color:new a.UniformColor(n,s.u_color)}},backgroundPattern:function(n,s){return{u_matrix:new a.UniformMatrix4f(n,s.u_matrix),u_opacity:new a.Uniform1f(n,s.u_opacity),u_image:new a.Uniform1i(n,s.u_image),u_pattern_tl_a:new a.Uniform2f(n,s.u_pattern_tl_a),u_pattern_br_a:new a.Uniform2f(n,s.u_pattern_br_a),u_pattern_tl_b:new a.Uniform2f(n,s.u_pattern_tl_b),u_pattern_br_b:new a.Uniform2f(n,s.u_pattern_br_b),u_texsize:new a.Uniform2f(n,s.u_texsize),u_mix:new a.Uniform1f(n,s.u_mix),u_pattern_size_a:new a.Uniform2f(n,s.u_pattern_size_a),u_pattern_size_b:new a.Uniform2f(n,s.u_pattern_size_b),u_scale_a:new a.Uniform1f(n,s.u_scale_a),u_scale_b:new a.Uniform1f(n,s.u_scale_b),u_pixel_coord_upper:new a.Uniform2f(n,s.u_pixel_coord_upper),u_pixel_coord_lower:new a.Uniform2f(n,s.u_pixel_coord_lower),u_tile_units_to_pixels:new a.Uniform1f(n,s.u_tile_units_to_pixels)}}};function Vo(n,s,o,c,_,w,S){for(var E=n.context,P=E.gl,O=n.useProgram("collisionBox"),Z=[],G=0,H=0,te=0;te<c.length;te++){var $=c[te],ue=s.getTile($),Y=ue.getBucket(o);if(Y){var le=$.posMatrix;_[0]===0&&_[1]===0||(le=n.translatePosMatrix($.posMatrix,ue,_,w));var fe=S?Y.textCollisionBox:Y.iconCollisionBox,_e=Y.collisionCircleArray;if(_e.length>0){var Te=a.create(),ke=le;a.mul(Te,Y.placementInvProjMatrix,n.transform.glCoordMatrix),a.mul(Te,Te,Y.placementViewportMatrix),Z.push({circleArray:_e,circleOffset:H,transform:ke,invTransform:Te}),H=G+=_e.length/4}fe&&O.draw(E,P.LINES,K.disabled,W.disabled,n.colorModeForRenderPass(),pe.disabled,_o(le,n.transform,ue),o.id,fe.layoutVertexBuffer,fe.indexBuffer,fe.segments,null,n.transform.zoom,null,null,fe.collisionVertexBuffer)}}if(S&&Z.length){var Ae=n.useProgram("collisionCircle"),Oe=new a.StructArrayLayout2f1f2i16;Oe.resize(4*G),Oe._trim();for(var He=0,Ge=0,lt=Z;Ge<lt.length;Ge+=1)for(var kt=lt[Ge],It=0;It<kt.circleArray.length/4;It++){var Tt=4*It,gr=kt.circleArray[Tt+0],pt=kt.circleArray[Tt+1],Ut=kt.circleArray[Tt+2],Yt=kt.circleArray[Tt+3];Oe.emplace(He++,gr,pt,Ut,Yt,0),Oe.emplace(He++,gr,pt,Ut,Yt,1),Oe.emplace(He++,gr,pt,Ut,Yt,2),Oe.emplace(He++,gr,pt,Ut,Yt,3)}(!qs||qs.length<2*G)&&(qs=function(ai){var cn=2*ai,Wi=new a.StructArrayLayout3ui6;Wi.resize(cn),Wi._trim();for(var $r=0;$r<cn;$r++){var di=6*$r;Wi.uint16[di+0]=4*$r+0,Wi.uint16[di+1]=4*$r+1,Wi.uint16[di+2]=4*$r+2,Wi.uint16[di+3]=4*$r+2,Wi.uint16[di+4]=4*$r+3,Wi.uint16[di+5]=4*$r+0}return Wi}(G));for(var Ot=E.createIndexBuffer(qs,!0),Bt=E.createVertexBuffer(Oe,a.collisionCircleLayout.members,!0),Xt=0,Rt=Z;Xt<Rt.length;Xt+=1){var Mt=Rt[Xt],Fi=dc(Mt.transform,Mt.invTransform,n.transform);Ae.draw(E,P.TRIANGLES,K.disabled,W.disabled,n.colorModeForRenderPass(),pe.disabled,Fi,o.id,Bt,Ot,a.SegmentVector.simpleSegment(0,2*Mt.circleOffset,Mt.circleArray.length,Mt.circleArray.length/2),null,n.transform.zoom,null,null,null)}Bt.destroy(),Ot.destroy()}}var pa=a.identity(new Float32Array(16));function vc(n,s,o,c,_,w){var S=a.getAnchorAlignment(n),E=-(S.horizontalAlign-.5)*s,P=-(S.verticalAlign-.5)*o,O=a.evaluateVariableOffset(n,c);return new a.Point((E/_+O[0])*w,(P/_+O[1])*w)}function bc(n,s,o,c,_,w,S,E,P,O,Z){var G=n.text.placedSymbolArray,H=n.text.dynamicLayoutVertexArray,te=n.icon.dynamicLayoutVertexArray,$={};H.clear();for(var ue=0;ue<G.length;ue++){var Y=G.get(ue),le=Y.hidden||!Y.crossTileID||n.allowVerticalPlacement&&!Y.placedOrientation?null:c[Y.crossTileID];if(le){var fe=new a.Point(Y.anchorX,Y.anchorY),_e=Qt(fe,o?E:S),Te=pr(w.cameraToCenterDistance,_e.signedDistanceFromCamera),ke=_.evaluateSizeForFeature(n.textSizeData,O,Y)*Te/a.ONE_EM;o&&(ke*=n.tilePixelRatio/P);for(var Ae=vc(le.anchor,le.width,le.height,le.textOffset,le.textBoxScale,ke),Oe=o?Qt(fe.add(Ae),S).point:_e.point.add(s?Ae.rotate(-w.angle):Ae),He=n.allowVerticalPlacement&&Y.placedOrientation===a.WritingMode.vertical?Math.PI/2:0,Ge=0;Ge<Y.numGlyphs;Ge++)a.addDynamicAttributes(H,Oe,He);Z&&Y.associatedIconIndex>=0&&($[Y.associatedIconIndex]={shiftedAnchor:Oe,angle:He})}else Ii(Y.numGlyphs,H)}if(Z){te.clear();for(var lt=n.icon.placedSymbolArray,kt=0;kt<lt.length;kt++){var It=lt.get(kt);if(It.hidden)Ii(It.numGlyphs,te);else{var Tt=$[kt];if(Tt)for(var gr=0;gr<It.numGlyphs;gr++)a.addDynamicAttributes(te,Tt.shiftedAnchor,Tt.angle);else Ii(It.numGlyphs,te)}}n.icon.dynamicLayoutVertexBuffer.updateData(te)}n.text.dynamicLayoutVertexBuffer.updateData(H)}function xc(n,s,o){return o.iconsInText&&s?"symbolTextAndIcon":n?"symbolSDF":"symbolIcon"}function xo(n,s,o,c,_,w,S,E,P,O,Z,G){for(var H=n.context,te=H.gl,$=n.transform,ue=E==="map",Y=P==="map",le=ue&&o.layout.get("symbol-placement")!=="point",fe=ue&&!Y&&!le,_e=o.layout.get("symbol-sort-key").constantOr(1)!==void 0,Te=!1,ke=n.depthModeForSublayer(0,K.ReadOnly),Ae=o.layout.get("text-variable-anchor"),Oe=[],He=0,Ge=c;He<Ge.length;He+=1){var lt=Ge[He],kt=s.getTile(lt),It=kt.getBucket(o);if(It){var Tt=_?It.text:It.icon;if(Tt&&Tt.segments.get().length){var gr=Tt.programConfigurations.get(o.id),pt=_||It.sdfIcons,Ut=_?It.textSizeData:It.iconSizeData,Yt=Y||$.pitch!==0,Ot=n.useProgram(xc(pt,_,It),gr),Bt=a.evaluateSizeForZoom(Ut,$.zoom),Xt=void 0,Rt=[0,0],Mt=void 0,Fi=void 0,ai=null,cn=void 0;if(_)Mt=kt.glyphAtlasTexture,Fi=te.LINEAR,Xt=kt.glyphAtlasTexture.size,It.iconsInText&&(Rt=kt.imageAtlasTexture.size,ai=kt.imageAtlasTexture,cn=Yt||n.options.rotating||n.options.zooming||Ut.kind==="composite"||Ut.kind==="camera"?te.LINEAR:te.NEAREST);else{var Wi=o.layout.get("icon-size").constantOr(0)!==1||It.iconsNeedLinear;Mt=kt.imageAtlasTexture,Fi=pt||n.options.rotating||n.options.zooming||Wi||Yt?te.LINEAR:te.NEAREST,Xt=kt.imageAtlasTexture.size}var $r=Dr(kt,1,n.transform.zoom),di=Fr(lt.posMatrix,Y,ue,n.transform,$r),qn=vr(lt.posMatrix,Y,ue,n.transform,$r),xn=Ae&&It.hasTextData(),Qa=o.layout.get("icon-text-fit")!=="none"&&xn&&It.hasIconData();le&&ha(It,lt.posMatrix,n,_,di,qn,Y,O);var In=n.translatePosMatrix(lt.posMatrix,kt,w,S),ga=le||_&&Ae||Qa?pa:di,oa=n.translatePosMatrix(qn,kt,w,S,!0),ks=pt&&o.paint.get(_?"text-halo-width":"icon-halo-width").constantOr(1)!==0,Ho={program:Ot,buffers:Tt,uniformValues:pt?It.iconsInText?js(Ut.kind,Bt,fe,Y,n,In,ga,oa,Xt,Rt):hs(Ut.kind,Bt,fe,Y,n,In,ga,oa,_,Xt,!0):No(Ut.kind,Bt,fe,Y,n,In,ga,oa,_,Xt),atlasTexture:Mt,atlasTextureIcon:ai,atlasInterpolation:Fi,atlasInterpolationIcon:cn,isSDF:pt,hasHalo:ks};if(_e&&It.canOverlap){Te=!0;for(var $a=0,Xo=Tt.segments.get();$a<Xo.length;$a+=1){var Es=Xo[$a];Oe.push({segments:new a.SegmentVector([Es]),sortKey:Es.sortKey,state:Ho})}}else Oe.push({segments:Tt.segments,sortKey:0,state:Ho})}}}Te&&Oe.sort(function(eo,To){return eo.sortKey-To.sortKey});for(var Ia=0,zs=Oe;Ia<zs.length;Ia+=1){var Aa=zs[Ia],Ni=Aa.state;if(H.activeTexture.set(te.TEXTURE0),Ni.atlasTexture.bind(Ni.atlasInterpolation,te.CLAMP_TO_EDGE),Ni.atlasTextureIcon&&(H.activeTexture.set(te.TEXTURE1),Ni.atlasTextureIcon&&Ni.atlasTextureIcon.bind(Ni.atlasInterpolationIcon,te.CLAMP_TO_EDGE)),Ni.isSDF){var La=Ni.uniformValues;Ni.hasHalo&&(La.u_is_halo=1,fs(Ni.buffers,Aa.segments,o,n,Ni.program,ke,Z,G,La)),La.u_is_halo=0}fs(Ni.buffers,Aa.segments,o,n,Ni.program,ke,Z,G,Ni.uniformValues)}}function fs(n,s,o,c,_,w,S,E,P){var O=c.context;_.draw(O,O.gl.TRIANGLES,w,S,E,pe.disabled,P,o.id,n.layoutVertexBuffer,n.indexBuffer,s,o.paint,c.transform.zoom,n.programConfigurations.get(o.id),n.dynamicLayoutVertexBuffer,n.opacityVertexBuffer)}function Zs(n,s,o,c,_,w,S){var E,P,O,Z,G,H=n.context.gl,te=o.paint.get("fill-pattern"),$=te&&te.constantOr(1),ue=o.getCrossfadeParameters();S?(P=$&&!o.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline",E=H.LINES):(P=$?"fillPattern":"fill",E=H.TRIANGLES);for(var Y=0,le=c;Y<le.length;Y+=1){var fe=le[Y],_e=s.getTile(fe);if(!$||_e.patternsLoaded()){var Te=_e.getBucket(o);if(Te){var ke=Te.programConfigurations.get(o.id),Ae=n.useProgram(P,ke);$&&(n.context.activeTexture.set(H.TEXTURE0),_e.imageAtlasTexture.bind(H.LINEAR,H.CLAMP_TO_EDGE),ke.updatePaintBuffers(ue));var Oe=te.constantOr(null);if(Oe&&_e.imageAtlas){var He=_e.imageAtlas,Ge=He.patternPositions[Oe.to.toString()],lt=He.patternPositions[Oe.from.toString()];Ge&&lt&&ke.setConstantPatternPositions(Ge,lt)}var kt=n.translatePosMatrix(fe.posMatrix,_e,o.paint.get("fill-translate"),o.paint.get("fill-translate-anchor"));if(S){Z=Te.indexBuffer2,G=Te.segments2;var It=[H.drawingBufferWidth,H.drawingBufferHeight];O=P==="fillOutlinePattern"&&$?fc(kt,n,ue,_e,It):pc(kt,It)}else Z=Te.indexBuffer,G=Te.segments,O=$?go(kt,n,ue,_e):Ka(kt);Ae.draw(n.context,E,_,n.stencilModeForClipping(fe),w,pe.disabled,O,o.id,Te.layoutVertexBuffer,Z,G,o.paint,n.transform.zoom,ke)}}}}function Hl(n,s,o,c,_,w,S){for(var E=n.context,P=E.gl,O=o.paint.get("fill-extrusion-pattern"),Z=O.constantOr(1),G=o.getCrossfadeParameters(),H=o.paint.get("fill-extrusion-opacity"),te=0,$=c;te<$.length;te+=1){var ue=$[te],Y=s.getTile(ue),le=Y.getBucket(o);if(le){var fe=le.programConfigurations.get(o.id),_e=n.useProgram(Z?"fillExtrusionPattern":"fillExtrusion",fe);Z&&(n.context.activeTexture.set(P.TEXTURE0),Y.imageAtlasTexture.bind(P.LINEAR,P.CLAMP_TO_EDGE),fe.updatePaintBuffers(G));var Te=O.constantOr(null);if(Te&&Y.imageAtlas){var ke=Y.imageAtlas,Ae=ke.patternPositions[Te.to.toString()],Oe=ke.patternPositions[Te.from.toString()];Ae&&Oe&&fe.setConstantPatternPositions(Ae,Oe)}var He=n.translatePosMatrix(ue.posMatrix,Y,o.paint.get("fill-extrusion-translate"),o.paint.get("fill-extrusion-translate-anchor")),Ge=o.paint.get("fill-extrusion-vertical-gradient"),lt=Z?yo(He,n,Ge,H,ue,G,Y):hc(He,n,Ge,H);_e.draw(E,E.gl.TRIANGLES,_,w,S,pe.backCCW,lt,o.id,le.layoutVertexBuffer,le.indexBuffer,le.segments,o.paint,n.transform.zoom,fe)}}}function Gs(n,s,o,c,_,w){var S=n.context,E=S.gl,P=s.fbo;if(P){var O=n.useProgram("hillshade");S.activeTexture.set(E.TEXTURE0),E.bindTexture(E.TEXTURE_2D,P.colorAttachment.get());var Z=function(G,H,te){var $=te.paint.get("hillshade-shadow-color"),ue=te.paint.get("hillshade-highlight-color"),Y=te.paint.get("hillshade-accent-color"),le=te.paint.get("hillshade-illumination-direction")*(Math.PI/180);te.paint.get("hillshade-illumination-anchor")==="viewport"&&(le-=G.transform.angle);var fe,_e,Te,ke=!G.options.moving;return{u_matrix:G.transform.calculatePosMatrix(H.tileID.toUnwrapped(),ke),u_image:0,u_latrange:(fe=H.tileID,_e=Math.pow(2,fe.canonical.z),Te=fe.canonical.y,[new a.MercatorCoordinate(0,Te/_e).toLngLat().lat,new a.MercatorCoordinate(0,(Te+1)/_e).toLngLat().lat]),u_light:[te.paint.get("hillshade-exaggeration"),le],u_shadow:$,u_highlight:ue,u_accent:Y}}(n,s,o);O.draw(S,E.TRIANGLES,c,_,w,pe.disabled,Z,o.id,n.rasterBoundsBuffer,n.quadTriangleIndexBuffer,n.rasterBoundsSegments)}}function Gh(n,s,o,c,_,w){var S=n.context,E=S.gl,P=s.dem;if(P&&P.data){var O=P.dim,Z=P.stride,G=P.getPixels();if(S.activeTexture.set(E.TEXTURE1),S.pixelStoreUnpackPremultiplyAlpha.set(!1),s.demTexture=s.demTexture||n.getTileTexture(Z),s.demTexture){var H=s.demTexture;H.update(G,{premultiply:!1}),H.bind(E.NEAREST,E.CLAMP_TO_EDGE)}else s.demTexture=new a.Texture(S,G,E.RGBA,{premultiply:!1}),s.demTexture.bind(E.NEAREST,E.CLAMP_TO_EDGE);S.activeTexture.set(E.TEXTURE0);var te=s.fbo;if(!te){var $=new a.Texture(S,{width:O,height:O,data:null},E.RGBA);$.bind(E.LINEAR,E.CLAMP_TO_EDGE),(te=s.fbo=S.createFramebuffer(O,O,!0)).colorAttachment.set($.texture)}S.bindFramebuffer.set(te.framebuffer),S.viewport.set([0,0,O,O]),n.useProgram("hillshadePrepare").draw(S,E.TRIANGLES,c,_,w,pe.disabled,function(ue,Y){var le=Y.stride,fe=a.create();return a.ortho(fe,0,a.EXTENT,-a.EXTENT,0,0,1),a.translate(fe,fe,[0,-a.EXTENT,0]),{u_matrix:fe,u_image:1,u_dimension:[le,le],u_zoom:ue.overscaledZ,u_unpack:Y.getUnpackVector()}}(s.tileID,P),o.id,n.rasterBoundsBuffer,n.quadTriangleIndexBuffer,n.rasterBoundsSegments),s.needsHillshadePrepare=!1}}function Ks(n,s,o,c,_){var w=c.paint.get("raster-fade-duration");if(w>0){var S=a.browser.now(),E=(S-n.timeAdded)/w,P=s?(S-s.timeAdded)/w:-1,O=o.getSource(),Z=_.coveringZoomLevel({tileSize:O.tileSize,roundZoom:O.roundZoom}),G=!s||Math.abs(s.tileID.overscaledZ-Z)>Math.abs(n.tileID.overscaledZ-Z),H=G&&n.refreshedUponExpiration?1:a.clamp(G?E:1-P,0,1);return n.refreshedUponExpiration&&E>=1&&(n.refreshedUponExpiration=!1),s?{opacity:1,mix:1-H}:{opacity:H,mix:0}}return{opacity:1,mix:0}}var Xl=new a.Color(1,0,0,1),wc=new a.Color(0,1,0,1),Sc=new a.Color(0,0,1,1),Hs=new a.Color(1,0,1,1),Wl=new a.Color(0,1,1,1);function Yl(n,s,o,c){ds(n,0,s+o/2,n.transform.width,o,c)}function Jl(n,s,o,c){ds(n,s-o/2,0,o,n.transform.height,c)}function ds(n,s,o,c,_,w){var S=n.context,E=S.gl;E.enable(E.SCISSOR_TEST),E.scissor(s*a.browser.devicePixelRatio,o*a.browser.devicePixelRatio,c*a.browser.devicePixelRatio,_*a.browser.devicePixelRatio),S.clear({color:w}),E.disable(E.SCISSOR_TEST)}function kc(n,s,o){var c=n.context,_=c.gl,w=o.posMatrix,S=n.useProgram("debug"),E=K.disabled,P=W.disabled,O=n.colorModeForRenderPass();c.activeTexture.set(_.TEXTURE0),n.emptyTexture.bind(_.LINEAR,_.CLAMP_TO_EDGE),S.draw(c,_.LINE_STRIP,E,P,O,pe.disabled,vo(w,a.Color.red),"$debug",n.debugBuffer,n.tileBorderIndexBuffer,n.debugSegments);var Z=s.getTileByID(o.key).latestRawTileData,G=Math.floor((Z&&Z.byteLength||0)/1024),H=s.getTile(o).tileSize,te=512/Math.min(H,512)*(o.overscaledZ/n.transform.zoom)*.5,$=o.canonical.toString();o.overscaledZ!==o.canonical.z&&($+=" => "+o.overscaledZ),function(ue,Y){ue.initDebugOverlayCanvas();var le=ue.debugOverlayCanvas,fe=ue.context.gl,_e=ue.debugOverlayCanvas.getContext("2d");_e.clearRect(0,0,le.width,le.height),_e.shadowColor="white",_e.shadowBlur=2,_e.lineWidth=1.5,_e.strokeStyle="white",_e.textBaseline="top",_e.font="bold 36px Open Sans, sans-serif",_e.fillText(Y,5,5),_e.strokeText(Y,5,5),ue.debugOverlayTexture.update(le),ue.debugOverlayTexture.bind(fe.LINEAR,fe.CLAMP_TO_EDGE)}(n,$+" "+G+"kb"),S.draw(c,_.TRIANGLES,E,P,se.alphaBlended,pe.disabled,vo(w,a.Color.transparent,te),"$debug",n.debugBuffer,n.quadTriangleIndexBuffer,n.debugSegments)}var wo={symbol:function(n,s,o,c,_){if(n.renderPass==="translucent"){var w=W.disabled,S=n.colorModeForRenderPass();o.layout.get("text-variable-anchor")&&function(E,P,O,Z,G,H,te){for(var $=P.transform,ue=G==="map",Y=H==="map",le=0,fe=E;le<fe.length;le+=1){var _e=fe[le],Te=Z.getTile(_e),ke=Te.getBucket(O);if(ke&&ke.text&&ke.text.segments.get().length){var Ae=a.evaluateSizeForZoom(ke.textSizeData,$.zoom),Oe=Dr(Te,1,P.transform.zoom),He=Fr(_e.posMatrix,Y,ue,P.transform,Oe),Ge=O.layout.get("icon-text-fit")!=="none"&&ke.hasIconData();if(Ae){var lt=Math.pow(2,$.zoom-Te.tileID.overscaledZ);bc(ke,ue,Y,te,a.symbolSize,$,He,_e.posMatrix,lt,Ae,Ge)}}}}(c,n,o,s,o.layout.get("text-rotation-alignment"),o.layout.get("text-pitch-alignment"),_),o.paint.get("icon-opacity").constantOr(1)!==0&&xo(n,s,o,c,!1,o.paint.get("icon-translate"),o.paint.get("icon-translate-anchor"),o.layout.get("icon-rotation-alignment"),o.layout.get("icon-pitch-alignment"),o.layout.get("icon-keep-upright"),w,S),o.paint.get("text-opacity").constantOr(1)!==0&&xo(n,s,o,c,!0,o.paint.get("text-translate"),o.paint.get("text-translate-anchor"),o.layout.get("text-rotation-alignment"),o.layout.get("text-pitch-alignment"),o.layout.get("text-keep-upright"),w,S),s.map.showCollisionBoxes&&(Vo(n,s,o,c,o.paint.get("text-translate"),o.paint.get("text-translate-anchor"),!0),Vo(n,s,o,c,o.paint.get("icon-translate"),o.paint.get("icon-translate-anchor"),!1))}},circle:function(n,s,o,c){if(n.renderPass==="translucent"){var _=o.paint.get("circle-opacity"),w=o.paint.get("circle-stroke-width"),S=o.paint.get("circle-stroke-opacity"),E=o.layout.get("circle-sort-key").constantOr(1)!==void 0;if(_.constantOr(1)!==0||w.constantOr(1)!==0&&S.constantOr(1)!==0){for(var P=n.context,O=P.gl,Z=n.depthModeForSublayer(0,K.ReadOnly),G=W.disabled,H=n.colorModeForRenderPass(),te=[],$=0;$<c.length;$++){var ue=c[$],Y=s.getTile(ue),le=Y.getBucket(o);if(le){var fe=le.programConfigurations.get(o.id),_e={programConfiguration:fe,program:n.useProgram("circle",fe),layoutVertexBuffer:le.layoutVertexBuffer,indexBuffer:le.indexBuffer,uniformValues:Kl(n,ue,Y,o)};if(E)for(var Te=0,ke=le.segments.get();Te<ke.length;Te+=1){var Ae=ke[Te];te.push({segments:new a.SegmentVector([Ae]),sortKey:Ae.sortKey,state:_e})}else te.push({segments:le.segments,sortKey:0,state:_e})}}E&&te.sort(function(kt,It){return kt.sortKey-It.sortKey});for(var Oe=0,He=te;Oe<He.length;Oe+=1){var Ge=He[Oe],lt=Ge.state;lt.program.draw(P,O.TRIANGLES,Z,G,H,pe.disabled,lt.uniformValues,o.id,lt.layoutVertexBuffer,lt.indexBuffer,Ge.segments,o.paint,n.transform.zoom,lt.programConfiguration)}}}},heatmap:function(n,s,o,c){if(o.paint.get("heatmap-opacity")!==0)if(n.renderPass==="offscreen"){var _=n.context,w=_.gl,S=W.disabled,E=new se([w.ONE,w.ONE],a.Color.transparent,[!0,!0,!0,!0]);(function(te,$,ue){var Y=te.gl;te.activeTexture.set(Y.TEXTURE1),te.viewport.set([0,0,$.width/4,$.height/4]);var le=ue.heatmapFbo;if(le)Y.bindTexture(Y.TEXTURE_2D,le.colorAttachment.get()),te.bindFramebuffer.set(le.framebuffer);else{var fe=Y.createTexture();Y.bindTexture(Y.TEXTURE_2D,fe),Y.texParameteri(Y.TEXTURE_2D,Y.TEXTURE_WRAP_S,Y.CLAMP_TO_EDGE),Y.texParameteri(Y.TEXTURE_2D,Y.TEXTURE_WRAP_T,Y.CLAMP_TO_EDGE),Y.texParameteri(Y.TEXTURE_2D,Y.TEXTURE_MIN_FILTER,Y.LINEAR),Y.texParameteri(Y.TEXTURE_2D,Y.TEXTURE_MAG_FILTER,Y.LINEAR),le=ue.heatmapFbo=te.createFramebuffer($.width/4,$.height/4,!1),function(_e,Te,ke,Ae){var Oe=_e.gl;Oe.texImage2D(Oe.TEXTURE_2D,0,Oe.RGBA,Te.width/4,Te.height/4,0,Oe.RGBA,_e.extRenderToTextureHalfFloat?_e.extTextureHalfFloat.HALF_FLOAT_OES:Oe.UNSIGNED_BYTE,null),Ae.colorAttachment.set(ke)}(te,$,fe,le)}})(_,n,o),_.clear({color:a.Color.transparent});for(var P=0;P<c.length;P++){var O=c[P];if(!s.hasRenderableParent(O)){var Z=s.getTile(O),G=Z.getBucket(o);if(G){var H=G.programConfigurations.get(o.id);n.useProgram("heatmap",H).draw(_,w.TRIANGLES,K.disabled,S,E,pe.disabled,mc(O.posMatrix,Z,n.transform.zoom,o.paint.get("heatmap-intensity")),o.id,G.layoutVertexBuffer,G.indexBuffer,G.segments,o.paint,n.transform.zoom,H)}}}_.viewport.set([0,0,n.width,n.height])}else n.renderPass==="translucent"&&(n.context.setColorMode(n.colorModeForRenderPass()),function(te,$){var ue=te.context,Y=ue.gl,le=$.heatmapFbo;if(le){ue.activeTexture.set(Y.TEXTURE0),Y.bindTexture(Y.TEXTURE_2D,le.colorAttachment.get()),ue.activeTexture.set(Y.TEXTURE1);var fe=$.colorRampTexture;fe||(fe=$.colorRampTexture=new a.Texture(ue,$.colorRamp,Y.RGBA)),fe.bind(Y.LINEAR,Y.CLAMP_TO_EDGE),te.useProgram("heatmapTexture").draw(ue,Y.TRIANGLES,K.disabled,W.disabled,te.colorModeForRenderPass(),pe.disabled,function(_e,Te,ke,Ae){var Oe=a.create();a.ortho(Oe,0,_e.width,_e.height,0,0,1);var He=_e.context.gl;return{u_matrix:Oe,u_world:[He.drawingBufferWidth,He.drawingBufferHeight],u_image:0,u_color_ramp:1,u_opacity:Te.paint.get("heatmap-opacity")}}(te,$),$.id,te.viewportBuffer,te.quadTriangleIndexBuffer,te.viewportSegments,$.paint,te.transform.zoom)}}(n,o))},line:function(n,s,o,c){if(n.renderPass==="translucent"){var _=o.paint.get("line-opacity"),w=o.paint.get("line-width");if(_.constantOr(1)!==0&&w.constantOr(1)!==0)for(var S=n.depthModeForSublayer(0,K.ReadOnly),E=n.colorModeForRenderPass(),P=o.paint.get("line-dasharray"),O=o.paint.get("line-pattern"),Z=O.constantOr(1),G=o.paint.get("line-gradient"),H=o.getCrossfadeParameters(),te=Z?"linePattern":P?"lineSDF":G?"lineGradient":"line",$=n.context,ue=$.gl,Y=!0,le=0,fe=c;le<fe.length;le+=1){var _e=fe[le],Te=s.getTile(_e);if(!Z||Te.patternsLoaded()){var ke=Te.getBucket(o);if(ke){var Ae=ke.programConfigurations.get(o.id),Oe=n.context.program.get(),He=n.useProgram(te,Ae),Ge=Y||He.program!==Oe,lt=O.constantOr(null);if(lt&&Te.imageAtlas){var kt=Te.imageAtlas,It=kt.patternPositions[lt.to.toString()],Tt=kt.patternPositions[lt.from.toString()];It&&Tt&&Ae.setConstantPatternPositions(It,Tt)}var gr=Z?Vs(n,Te,o,H):P?jh(n,Te,o,P,H):G?Nr(n,Te,o,ke.lineClipsArray.length):cs(n,Te,o);if(Z)$.activeTexture.set(ue.TEXTURE0),Te.imageAtlasTexture.bind(ue.LINEAR,ue.CLAMP_TO_EDGE),Ae.updatePaintBuffers(H);else if(P&&(Ge||n.lineAtlas.dirty))$.activeTexture.set(ue.TEXTURE0),n.lineAtlas.bind($);else if(G){var pt=ke.gradients[o.id],Ut=pt.texture;if(o.gradientVersion!==pt.version){var Yt=256;if(o.stepInterpolant){var Ot=s.getSource().maxzoom,Bt=_e.canonical.z===Ot?Math.ceil(1<<n.transform.maxZoom-_e.canonical.z):1;Yt=a.clamp(a.nextPowerOfTwo(ke.maxLineLength/a.EXTENT*1024*Bt),256,$.maxTextureSize)}pt.gradient=a.renderColorRamp({expression:o.gradientExpression(),evaluationKey:"lineProgress",resolution:Yt,image:pt.gradient||void 0,clips:ke.lineClipsArray}),pt.texture?pt.texture.update(pt.gradient):pt.texture=new a.Texture($,pt.gradient,ue.RGBA),pt.version=o.gradientVersion,Ut=pt.texture}$.activeTexture.set(ue.TEXTURE0),Ut.bind(o.stepInterpolant?ue.NEAREST:ue.LINEAR,ue.CLAMP_TO_EDGE)}He.draw($,ue.TRIANGLES,S,n.stencilModeForClipping(_e),E,pe.disabled,gr,o.id,ke.layoutVertexBuffer,ke.indexBuffer,ke.segments,o.paint,n.transform.zoom,Ae,ke.layoutVertexBuffer2),Y=!1}}}}},fill:function(n,s,o,c){var _=o.paint.get("fill-color"),w=o.paint.get("fill-opacity");if(w.constantOr(1)!==0){var S=n.colorModeForRenderPass(),E=o.paint.get("fill-pattern"),P=n.opaquePassEnabledForLayer()&&!E.constantOr(1)&&_.constantOr(a.Color.transparent).a===1&&w.constantOr(0)===1?"opaque":"translucent";if(n.renderPass===P){var O=n.depthModeForSublayer(1,n.renderPass==="opaque"?K.ReadWrite:K.ReadOnly);Zs(n,s,o,c,O,S,!1)}if(n.renderPass==="translucent"&&o.paint.get("fill-antialias")){var Z=n.depthModeForSublayer(o.getPaintProperty("fill-outline-color")?2:0,K.ReadOnly);Zs(n,s,o,c,Z,S,!0)}}},"fill-extrusion":function(n,s,o,c){var _=o.paint.get("fill-extrusion-opacity");if(_!==0&&n.renderPass==="translucent"){var w=new K(n.context.gl.LEQUAL,K.ReadWrite,n.depthRangeFor3D);if(_!==1||o.paint.get("fill-extrusion-pattern").constantOr(1))Hl(n,s,o,c,w,W.disabled,se.disabled),Hl(n,s,o,c,w,n.stencilModeFor3D(),n.colorModeForRenderPass());else{var S=n.colorModeForRenderPass();Hl(n,s,o,c,w,W.disabled,S)}}},hillshade:function(n,s,o,c){if(n.renderPass==="offscreen"||n.renderPass==="translucent"){for(var _=n.context,w=n.depthModeForSublayer(0,K.ReadOnly),S=n.colorModeForRenderPass(),E=n.renderPass==="translucent"?n.stencilConfigForOverlap(c):[{},c],P=E[0],O=0,Z=E[1];O<Z.length;O+=1){var G=Z[O],H=s.getTile(G);H.needsHillshadePrepare&&n.renderPass==="offscreen"?Gh(n,H,o,w,W.disabled,S):n.renderPass==="translucent"&&Gs(n,H,o,w,P[G.overscaledZ],S)}_.viewport.set([0,0,n.width,n.height])}},raster:function(n,s,o,c){if(n.renderPass==="translucent"&&o.paint.get("raster-opacity")!==0&&c.length)for(var _=n.context,w=_.gl,S=s.getSource(),E=n.useProgram("raster"),P=n.colorModeForRenderPass(),O=S instanceof Lt?[{},c]:n.stencilConfigForOverlap(c),Z=O[0],G=O[1],H=G[G.length-1].overscaledZ,te=!n.options.moving,$=0,ue=G;$<ue.length;$+=1){var Y=ue[$],le=n.depthModeForSublayer(Y.overscaledZ-H,o.paint.get("raster-opacity")===1?K.ReadWrite:K.ReadOnly,w.LESS),fe=s.getTile(Y),_e=n.transform.calculatePosMatrix(Y.toUnwrapped(),te);fe.registerFadeDuration(o.paint.get("raster-fade-duration"));var Te=s.findLoadedParent(Y,0),ke=Ks(fe,Te,s,o,n.transform),Ae=void 0,Oe=void 0,He=o.paint.get("raster-resampling")==="nearest"?w.NEAREST:w.LINEAR;_.activeTexture.set(w.TEXTURE0),fe.texture.bind(He,w.CLAMP_TO_EDGE,w.LINEAR_MIPMAP_NEAREST),_.activeTexture.set(w.TEXTURE1),Te?(Te.texture.bind(He,w.CLAMP_TO_EDGE,w.LINEAR_MIPMAP_NEAREST),Ae=Math.pow(2,Te.tileID.overscaledZ-fe.tileID.overscaledZ),Oe=[fe.tileID.canonical.x*Ae%1,fe.tileID.canonical.y*Ae%1]):fe.texture.bind(He,w.CLAMP_TO_EDGE,w.LINEAR_MIPMAP_NEAREST);var Ge=Zh(_e,Oe||[0,0],Ae||1,ke,o);S instanceof Lt?E.draw(_,w.TRIANGLES,le,W.disabled,P,pe.disabled,Ge,o.id,S.boundsBuffer,n.quadTriangleIndexBuffer,S.boundsSegments):E.draw(_,w.TRIANGLES,le,Z[Y.overscaledZ],P,pe.disabled,Ge,o.id,n.rasterBoundsBuffer,n.quadTriangleIndexBuffer,n.rasterBoundsSegments)}},background:function(n,s,o){var c=o.paint.get("background-color"),_=o.paint.get("background-opacity");if(_!==0){var w=n.context,S=w.gl,E=n.transform,P=E.tileSize,O=o.paint.get("background-pattern");if(!n.isPatternMissing(O)){var Z=!O&&c.a===1&&_===1&&n.opaquePassEnabledForLayer()?"opaque":"translucent";if(n.renderPass===Z){var G=W.disabled,H=n.depthModeForSublayer(0,Z==="opaque"?K.ReadWrite:K.ReadOnly),te=n.colorModeForRenderPass(),$=n.useProgram(O?"backgroundPattern":"background"),ue=E.coveringTiles({tileSize:P});O&&(w.activeTexture.set(S.TEXTURE0),n.imageManager.bind(n.context));for(var Y=o.getCrossfadeParameters(),le=0,fe=ue;le<fe.length;le+=1){var _e=fe[le],Te=n.transform.calculatePosMatrix(_e.toUnwrapped()),ke=O?Uo(Te,_,n,O,{tileID:_e,tileSize:P},Y):ps(Te,_,c);$.draw(w,S.TRIANGLES,H,G,te,pe.disabled,ke,o.id,n.tileExtentBuffer,n.quadTriangleIndexBuffer,n.tileExtentSegments)}}}}},debug:function(n,s,o){for(var c=0;c<o.length;c++)kc(n,s,o[c])},custom:function(n,s,o){var c=n.context,_=o.implementation;if(n.renderPass==="offscreen"){var w=_.prerender;w&&(n.setCustomLayerDefaults(),c.setColorMode(n.colorModeForRenderPass()),w.call(_,c.gl,n.transform.customLayerMatrix()),c.setDirty(),n.setBaseState())}else if(n.renderPass==="translucent"){n.setCustomLayerDefaults(),c.setColorMode(n.colorModeForRenderPass()),c.setStencilMode(W.disabled);var S=_.renderingMode==="3d"?new K(n.context.gl.LEQUAL,K.ReadWrite,n.depthRangeFor3D):n.depthModeForSublayer(0,K.ReadOnly);c.setDepthMode(S),_.render(c.gl,n.transform.customLayerMatrix()),c.setDirty(),n.setBaseState(),c.bindFramebuffer.set(null)}}},Xr=function(n,s){this.context=new q(n),this.transform=s,this._tileTextures={},this.setup(),this.numSublayers=ee.maxUnderzooming+ee.maxOverzooming+1,this.depthEpsilon=1/Math.pow(2,16),this.crossTileSymbolIndex=new ge,this.gpuTimers={}};Xr.prototype.resize=function(n,s){if(this.width=n*a.browser.devicePixelRatio,this.height=s*a.browser.devicePixelRatio,this.context.viewport.set([0,0,this.width,this.height]),this.style)for(var o=0,c=this.style._order;o<c.length;o+=1)this.style._layers[c[o]].resize()},Xr.prototype.setup=function(){var n=this.context,s=new a.StructArrayLayout2i4;s.emplaceBack(0,0),s.emplaceBack(a.EXTENT,0),s.emplaceBack(0,a.EXTENT),s.emplaceBack(a.EXTENT,a.EXTENT),this.tileExtentBuffer=n.createVertexBuffer(s,Si.members),this.tileExtentSegments=a.SegmentVector.simpleSegment(0,0,4,2);var o=new a.StructArrayLayout2i4;o.emplaceBack(0,0),o.emplaceBack(a.EXTENT,0),o.emplaceBack(0,a.EXTENT),o.emplaceBack(a.EXTENT,a.EXTENT),this.debugBuffer=n.createVertexBuffer(o,Si.members),this.debugSegments=a.SegmentVector.simpleSegment(0,0,4,5);var c=new a.StructArrayLayout4i8;c.emplaceBack(0,0,0,0),c.emplaceBack(a.EXTENT,0,a.EXTENT,0),c.emplaceBack(0,a.EXTENT,0,a.EXTENT),c.emplaceBack(a.EXTENT,a.EXTENT,a.EXTENT,a.EXTENT),this.rasterBoundsBuffer=n.createVertexBuffer(c,De.members),this.rasterBoundsSegments=a.SegmentVector.simpleSegment(0,0,4,2);var _=new a.StructArrayLayout2i4;_.emplaceBack(0,0),_.emplaceBack(1,0),_.emplaceBack(0,1),_.emplaceBack(1,1),this.viewportBuffer=n.createVertexBuffer(_,Si.members),this.viewportSegments=a.SegmentVector.simpleSegment(0,0,4,2);var w=new a.StructArrayLayout1ui2;w.emplaceBack(0),w.emplaceBack(1),w.emplaceBack(3),w.emplaceBack(2),w.emplaceBack(0),this.tileBorderIndexBuffer=n.createIndexBuffer(w);var S=new a.StructArrayLayout3ui6;S.emplaceBack(0,1,2),S.emplaceBack(2,1,3),this.quadTriangleIndexBuffer=n.createIndexBuffer(S),this.emptyTexture=new a.Texture(n,{width:1,height:1,data:new Uint8Array([0,0,0,0])},n.gl.RGBA);var E=this.context.gl;this.stencilClearMode=new W({func:E.ALWAYS,mask:0},0,255,E.ZERO,E.ZERO,E.ZERO)},Xr.prototype.clearStencil=function(){var n=this.context,s=n.gl;this.nextStencilID=1,this.currentStencilSource=void 0;var o=a.create();a.ortho(o,0,this.width,this.height,0,0,1),a.scale(o,o,[s.drawingBufferWidth,s.drawingBufferHeight,0]),this.useProgram("clippingMask").draw(n,s.TRIANGLES,K.disabled,this.stencilClearMode,se.disabled,pe.disabled,bo(o),"$clipping",this.viewportBuffer,this.quadTriangleIndexBuffer,this.viewportSegments)},Xr.prototype._renderTileClippingMasks=function(n,s){if(this.currentStencilSource!==n.source&&n.isTileClipped()&&s&&s.length){this.currentStencilSource=n.source;var o=this.context,c=o.gl;this.nextStencilID+s.length>256&&this.clearStencil(),o.setColorMode(se.disabled),o.setDepthMode(K.disabled);var _=this.useProgram("clippingMask");this._tileClippingMaskIDs={};for(var w=0,S=s;w<S.length;w+=1){var E=S[w],P=this._tileClippingMaskIDs[E.key]=this.nextStencilID++;_.draw(o,c.TRIANGLES,K.disabled,new W({func:c.ALWAYS,mask:0},P,255,c.KEEP,c.KEEP,c.REPLACE),se.disabled,pe.disabled,bo(E.posMatrix),"$clipping",this.tileExtentBuffer,this.quadTriangleIndexBuffer,this.tileExtentSegments)}}},Xr.prototype.stencilModeFor3D=function(){this.currentStencilSource=void 0,this.nextStencilID+1>256&&this.clearStencil();var n=this.nextStencilID++,s=this.context.gl;return new W({func:s.NOTEQUAL,mask:255},n,255,s.KEEP,s.KEEP,s.REPLACE)},Xr.prototype.stencilModeForClipping=function(n){var s=this.context.gl;return new W({func:s.EQUAL,mask:255},this._tileClippingMaskIDs[n.key],0,s.KEEP,s.KEEP,s.REPLACE)},Xr.prototype.stencilConfigForOverlap=function(n){var s,o=this.context.gl,c=n.sort(function(P,O){return O.overscaledZ-P.overscaledZ}),_=c[c.length-1].overscaledZ,w=c[0].overscaledZ-_+1;if(w>1){this.currentStencilSource=void 0,this.nextStencilID+w>256&&this.clearStencil();for(var S={},E=0;E<w;E++)S[E+_]=new W({func:o.GEQUAL,mask:255},E+this.nextStencilID,255,o.KEEP,o.KEEP,o.REPLACE);return this.nextStencilID+=w,[S,c]}return[(s={},s[_]=W.disabled,s),c]},Xr.prototype.colorModeForRenderPass=function(){var n=this.context.gl;return this._showOverdrawInspector?new se([n.CONSTANT_COLOR,n.ONE],new a.Color(1/8,1/8,1/8,0),[!0,!0,!0,!0]):this.renderPass==="opaque"?se.unblended:se.alphaBlended},Xr.prototype.depthModeForSublayer=function(n,s,o){if(!this.opaquePassEnabledForLayer())return K.disabled;var c=1-((1+this.currentLayer)*this.numSublayers+n)*this.depthEpsilon;return new K(o||this.context.gl.LEQUAL,s,[c,c])},Xr.prototype.opaquePassEnabledForLayer=function(){return this.currentLayer<this.opaquePassCutoff},Xr.prototype.render=function(n,s){var o=this;this.style=n,this.options=s,this.lineAtlas=n.lineAtlas,this.imageManager=n.imageManager,this.glyphManager=n.glyphManager,this.symbolFadeChange=n.placement.symbolFadeChange(a.browser.now()),this.imageManager.beginFrame();var c=this.style._order,_=this.style.sourceCaches;for(var w in _){var S=_[w];S.used&&S.prepare(this.context)}var E,P,O={},Z={},G={};for(var H in _){var te=_[H];O[H]=te.getVisibleCoordinates(),Z[H]=O[H].slice().reverse(),G[H]=te.getVisibleCoordinates(!0).reverse()}this.opaquePassCutoff=1/0;for(var $=0;$<c.length;$++)if(this.style._layers[c[$]].is3D()){this.opaquePassCutoff=$;break}this.renderPass="offscreen";for(var ue=0,Y=c;ue<Y.length;ue+=1){var le=this.style._layers[Y[ue]];if(le.hasOffscreenPass()&&!le.isHidden(this.transform.zoom)){var fe=Z[le.source];(le.type==="custom"||fe.length)&&this.renderLayer(this,_[le.source],le,fe)}}for(this.context.bindFramebuffer.set(null),this.context.clear({color:s.showOverdrawInspector?a.Color.black:a.Color.transparent,depth:1}),this.clearStencil(),this._showOverdrawInspector=s.showOverdrawInspector,this.depthRangeFor3D=[0,1-(n._order.length+2)*this.numSublayers*this.depthEpsilon],this.renderPass="opaque",this.currentLayer=c.length-1;this.currentLayer>=0;this.currentLayer--){var _e=this.style._layers[c[this.currentLayer]],Te=_[_e.source],ke=O[_e.source];this._renderTileClippingMasks(_e,ke),this.renderLayer(this,Te,_e,ke)}for(this.renderPass="translucent",this.currentLayer=0;this.currentLayer<c.length;this.currentLayer++){var Ae=this.style._layers[c[this.currentLayer]],Oe=_[Ae.source],He=(Ae.type==="symbol"?G:Z)[Ae.source];this._renderTileClippingMasks(Ae,O[Ae.source]),this.renderLayer(this,Oe,Ae,He)}this.options.showTileBoundaries&&(a.values(this.style._layers).forEach(function(Ge){Ge.source&&!Ge.isHidden(o.transform.zoom)&&(Ge.source!==(P&&P.id)&&(P=o.style.sourceCaches[Ge.source]),(!E||E.getSource().maxzoom<P.getSource().maxzoom)&&(E=P))}),E&&wo.debug(this,E,E.getVisibleCoordinates())),this.options.showPadding&&function(Ge){var lt=Ge.transform.padding;Yl(Ge,Ge.transform.height-(lt.top||0),3,Xl),Yl(Ge,lt.bottom||0,3,wc),Jl(Ge,lt.left||0,3,Sc),Jl(Ge,Ge.transform.width-(lt.right||0),3,Hs);var kt=Ge.transform.centerPoint;(function(It,Tt,gr,pt){ds(It,Tt-1,gr-10,2,20,pt),ds(It,Tt-10,gr-1,20,2,pt)})(Ge,kt.x,Ge.transform.height-kt.y,Wl)}(this),this.context.setDefault()},Xr.prototype.renderLayer=function(n,s,o,c){o.isHidden(this.transform.zoom)||(o.type==="background"||o.type==="custom"||c.length)&&(this.id=o.id,this.gpuTimingStart(o),wo[o.type](n,s,o,c,this.style.placement.variableOffsets),this.gpuTimingEnd())},Xr.prototype.gpuTimingStart=function(n){if(this.options.gpuTiming){var s=this.context.extTimerQuery,o=this.gpuTimers[n.id];o||(o=this.gpuTimers[n.id]={calls:0,cpuTime:0,query:s.createQueryEXT()}),o.calls++,s.beginQueryEXT(s.TIME_ELAPSED_EXT,o.query)}},Xr.prototype.gpuTimingEnd=function(){if(this.options.gpuTiming){var n=this.context.extTimerQuery;n.endQueryEXT(n.TIME_ELAPSED_EXT)}},Xr.prototype.collectGpuTimers=function(){var n=this.gpuTimers;return this.gpuTimers={},n},Xr.prototype.queryGpuTimers=function(n){var s={};for(var o in n){var c=n[o],_=this.context.extTimerQuery,w=_.getQueryObjectEXT(c.query,_.QUERY_RESULT_EXT)/1e6;_.deleteQueryEXT(c.query),s[o]=w}return s},Xr.prototype.translatePosMatrix=function(n,s,o,c,_){if(!o[0]&&!o[1])return n;var w=_?c==="map"?this.transform.angle:0:c==="viewport"?-this.transform.angle:0;if(w){var S=Math.sin(w),E=Math.cos(w);o=[o[0]*E-o[1]*S,o[0]*S+o[1]*E]}var P=[_?o[0]:Dr(s,o[0],this.transform.zoom),_?o[1]:Dr(s,o[1],this.transform.zoom),0],O=new Float32Array(16);return a.translate(O,n,P),O},Xr.prototype.saveTileTexture=function(n){var s=this._tileTextures[n.size[0]];s?s.push(n):this._tileTextures[n.size[0]]=[n]},Xr.prototype.getTileTexture=function(n){var s=this._tileTextures[n];return s&&s.length>0?s.pop():null},Xr.prototype.isPatternMissing=function(n){if(!n)return!1;if(!n.from||!n.to)return!0;var s=this.imageManager.getPattern(n.from.toString()),o=this.imageManager.getPattern(n.to.toString());return!s||!o},Xr.prototype.useProgram=function(n,s){this.cache=this.cache||{};var o=""+n+(s?s.cacheKey:"")+(this._showOverdrawInspector?"/overdraw":"");return this.cache[o]||(this.cache[o]=new uc(this.context,n,qh[n],s,_c[n],this._showOverdrawInspector)),this.cache[o]},Xr.prototype.setCustomLayerDefaults=function(){this.context.unbindVAO(),this.context.cullFace.setDefault(),this.context.activeTexture.setDefault(),this.context.pixelStoreUnpack.setDefault(),this.context.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.context.pixelStoreUnpackFlipY.setDefault()},Xr.prototype.setBaseState=function(){var n=this.context.gl;this.context.cullFace.set(!1),this.context.viewport.set([0,0,this.width,this.height]),this.context.blendEquation.set(n.FUNC_ADD)},Xr.prototype.initDebugOverlayCanvas=function(){this.debugOverlayCanvas==null&&(this.debugOverlayCanvas=a.window.document.createElement("canvas"),this.debugOverlayCanvas.width=512,this.debugOverlayCanvas.height=512,this.debugOverlayTexture=new a.Texture(this.context,this.debugOverlayCanvas,this.context.gl.RGBA))},Xr.prototype.destroy=function(){this.emptyTexture.destroy(),this.debugOverlayTexture&&this.debugOverlayTexture.destroy()};var Xs=function(n,s){this.points=n,this.planes=s};Xs.fromInvProjectionMatrix=function(n,s,o){var c=Math.pow(2,o),_=[[-1,1,-1,1],[1,1,-1,1],[1,-1,-1,1],[-1,-1,-1,1],[-1,1,1,1],[1,1,1,1],[1,-1,1,1],[-1,-1,1,1]].map(function(S){return a.transformMat4([],S,n)}).map(function(S){return a.scale$1([],S,1/S[3]/s*c)}),w=[[0,1,2],[6,5,4],[0,3,7],[2,1,5],[3,2,6],[0,4,5]].map(function(S){var E=a.sub([],_[S[0]],_[S[1]]),P=a.sub([],_[S[2]],_[S[1]]),O=a.normalize([],a.cross([],E,P)),Z=-a.dot(O,_[S[1]]);return O.concat(Z)});return new Xs(_,w)};var So=function(n,s){this.min=n,this.max=s,this.center=a.scale$2([],a.add([],this.min,this.max),.5)};So.prototype.quadrant=function(n){for(var s=[n%2==0,n<2],o=a.clone$2(this.min),c=a.clone$2(this.max),_=0;_<s.length;_++)o[_]=s[_]?this.min[_]:this.center[_],c[_]=s[_]?this.center[_]:this.max[_];return c[2]=this.max[2],new So(o,c)},So.prototype.distanceX=function(n){return Math.max(Math.min(this.max[0],n[0]),this.min[0])-n[0]},So.prototype.distanceY=function(n){return Math.max(Math.min(this.max[1],n[1]),this.min[1])-n[1]},So.prototype.intersects=function(n){for(var s=[[this.min[0],this.min[1],0,1],[this.max[0],this.min[1],0,1],[this.max[0],this.max[1],0,1],[this.min[0],this.max[1],0,1]],o=!0,c=0;c<n.planes.length;c++){for(var _=n.planes[c],w=0,S=0;S<s.length;S++)w+=a.dot$1(_,s[S])>=0;if(w===0)return 0;w!==s.length&&(o=!1)}if(o)return 2;for(var E=0;E<3;E++){for(var P=Number.MAX_VALUE,O=-Number.MAX_VALUE,Z=0;Z<n.points.length;Z++){var G=n.points[Z][E]-this.min[E];P=Math.min(P,G),O=Math.max(O,G)}if(O<0||P>this.max[E]-this.min[E])return 0}return 1};var Ha=function(n,s,o,c){if(n===void 0&&(n=0),s===void 0&&(s=0),o===void 0&&(o=0),c===void 0&&(c=0),isNaN(n)||n<0||isNaN(s)||s<0||isNaN(o)||o<0||isNaN(c)||c<0)throw new Error("Invalid value for edge-insets, top, bottom, left and right must all be numbers");this.top=n,this.bottom=s,this.left=o,this.right=c};Ha.prototype.interpolate=function(n,s,o){return s.top!=null&&n.top!=null&&(this.top=a.number(n.top,s.top,o)),s.bottom!=null&&n.bottom!=null&&(this.bottom=a.number(n.bottom,s.bottom,o)),s.left!=null&&n.left!=null&&(this.left=a.number(n.left,s.left,o)),s.right!=null&&n.right!=null&&(this.right=a.number(n.right,s.right,o)),this},Ha.prototype.getCenter=function(n,s){var o=a.clamp((this.left+n-this.right)/2,0,n),c=a.clamp((this.top+s-this.bottom)/2,0,s);return new a.Point(o,c)},Ha.prototype.equals=function(n){return this.top===n.top&&this.bottom===n.bottom&&this.left===n.left&&this.right===n.right},Ha.prototype.clone=function(){return new Ha(this.top,this.bottom,this.left,this.right)},Ha.prototype.toJSON=function(){return{top:this.top,bottom:this.bottom,left:this.left,right:this.right}};var fr=function(n,s,o,c,_){this.tileSize=512,this.maxValidLatitude=85.051129,this._renderWorldCopies=_===void 0||_,this._minZoom=n||0,this._maxZoom=s||22,this._minPitch=o??0,this._maxPitch=c??60,this.setMaxBounds(),this.width=0,this.height=0,this._center=new a.LngLat(0,0),this.zoom=0,this.angle=0,this._fov=.6435011087932844,this._pitch=0,this._unmodified=!0,this._edgeInsets=new Ha,this._posMatrixCache={},this._alignedPosMatrixCache={}},Ur={minZoom:{configurable:!0},maxZoom:{configurable:!0},minPitch:{configurable:!0},maxPitch:{configurable:!0},renderWorldCopies:{configurable:!0},worldSize:{configurable:!0},centerOffset:{configurable:!0},size:{configurable:!0},bearing:{configurable:!0},pitch:{configurable:!0},fov:{configurable:!0},zoom:{configurable:!0},center:{configurable:!0},padding:{configurable:!0},centerPoint:{configurable:!0},unmodified:{configurable:!0},point:{configurable:!0}};fr.prototype.clone=function(){var n=new fr(this._minZoom,this._maxZoom,this._minPitch,this.maxPitch,this._renderWorldCopies);return n.tileSize=this.tileSize,n.latRange=this.latRange,n.width=this.width,n.height=this.height,n._center=this._center,n.zoom=this.zoom,n.angle=this.angle,n._fov=this._fov,n._pitch=this._pitch,n._unmodified=this._unmodified,n._edgeInsets=this._edgeInsets.clone(),n._calcMatrices(),n},Ur.minZoom.get=function(){return this._minZoom},Ur.minZoom.set=function(n){this._minZoom!==n&&(this._minZoom=n,this.zoom=Math.max(this.zoom,n))},Ur.maxZoom.get=function(){return this._maxZoom},Ur.maxZoom.set=function(n){this._maxZoom!==n&&(this._maxZoom=n,this.zoom=Math.min(this.zoom,n))},Ur.minPitch.get=function(){return this._minPitch},Ur.minPitch.set=function(n){this._minPitch!==n&&(this._minPitch=n,this.pitch=Math.max(this.pitch,n))},Ur.maxPitch.get=function(){return this._maxPitch},Ur.maxPitch.set=function(n){this._maxPitch!==n&&(this._maxPitch=n,this.pitch=Math.min(this.pitch,n))},Ur.renderWorldCopies.get=function(){return this._renderWorldCopies},Ur.renderWorldCopies.set=function(n){n===void 0?n=!0:n===null&&(n=!1),this._renderWorldCopies=n},Ur.worldSize.get=function(){return this.tileSize*this.scale},Ur.centerOffset.get=function(){return this.centerPoint._sub(this.size._div(2))},Ur.size.get=function(){return new a.Point(this.width,this.height)},Ur.bearing.get=function(){return-this.angle/Math.PI*180},Ur.bearing.set=function(n){var s=-a.wrap(n,-180,180)*Math.PI/180;this.angle!==s&&(this._unmodified=!1,this.angle=s,this._calcMatrices(),this.rotationMatrix=a.create$2(),a.rotate(this.rotationMatrix,this.rotationMatrix,this.angle))},Ur.pitch.get=function(){return this._pitch/Math.PI*180},Ur.pitch.set=function(n){var s=a.clamp(n,this.minPitch,this.maxPitch)/180*Math.PI;this._pitch!==s&&(this._unmodified=!1,this._pitch=s,this._calcMatrices())},Ur.fov.get=function(){return this._fov/Math.PI*180},Ur.fov.set=function(n){n=Math.max(.01,Math.min(60,n)),this._fov!==n&&(this._unmodified=!1,this._fov=n/180*Math.PI,this._calcMatrices())},Ur.zoom.get=function(){return this._zoom},Ur.zoom.set=function(n){var s=Math.min(Math.max(n,this.minZoom),this.maxZoom);this._zoom!==s&&(this._unmodified=!1,this._zoom=s,this.scale=this.zoomScale(s),this.tileZoom=Math.floor(s),this.zoomFraction=s-this.tileZoom,this._constrain(),this._calcMatrices())},Ur.center.get=function(){return this._center},Ur.center.set=function(n){n.lat===this._center.lat&&n.lng===this._center.lng||(this._unmodified=!1,this._center=n,this._constrain(),this._calcMatrices())},Ur.padding.get=function(){return this._edgeInsets.toJSON()},Ur.padding.set=function(n){this._edgeInsets.equals(n)||(this._unmodified=!1,this._edgeInsets.interpolate(this._edgeInsets,n,1),this._calcMatrices())},Ur.centerPoint.get=function(){return this._edgeInsets.getCenter(this.width,this.height)},fr.prototype.isPaddingEqual=function(n){return this._edgeInsets.equals(n)},fr.prototype.interpolatePadding=function(n,s,o){this._unmodified=!1,this._edgeInsets.interpolate(n,s,o),this._constrain(),this._calcMatrices()},fr.prototype.coveringZoomLevel=function(n){var s=(n.roundZoom?Math.round:Math.floor)(this.zoom+this.scaleZoom(this.tileSize/n.tileSize));return Math.max(0,s)},fr.prototype.getVisibleUnwrappedCoordinates=function(n){var s=[new a.UnwrappedTileID(0,n)];if(this._renderWorldCopies)for(var o=this.pointCoordinate(new a.Point(0,0)),c=this.pointCoordinate(new a.Point(this.width,0)),_=this.pointCoordinate(new a.Point(this.width,this.height)),w=this.pointCoordinate(new a.Point(0,this.height)),S=Math.floor(Math.min(o.x,c.x,_.x,w.x)),E=Math.floor(Math.max(o.x,c.x,_.x,w.x)),P=S-1;P<=E+1;P++)P!==0&&s.push(new a.UnwrappedTileID(P,n));return s},fr.prototype.coveringTiles=function(n){var s=this.coveringZoomLevel(n),o=s;if(n.minzoom!==void 0&&s<n.minzoom)return[];n.maxzoom!==void 0&&s>n.maxzoom&&(s=n.maxzoom);var c=a.MercatorCoordinate.fromLngLat(this.center),_=Math.pow(2,s),w=[_*c.x,_*c.y,0],S=Xs.fromInvProjectionMatrix(this.invProjMatrix,this.worldSize,s),E=n.minzoom||0;this.pitch<=60&&this._edgeInsets.top<.1&&(E=s);var P=function(Ge){return{aabb:new So([Ge*_,0,0],[(Ge+1)*_,_,0]),zoom:0,x:0,y:0,wrap:Ge,fullyVisible:!1}},O=[],Z=[],G=s,H=n.reparseOverscaled?o:s;if(this._renderWorldCopies)for(var te=1;te<=3;te++)O.push(P(-te)),O.push(P(te));for(O.push(P(0));O.length>0;){var $=O.pop(),ue=$.x,Y=$.y,le=$.fullyVisible;if(!le){var fe=$.aabb.intersects(S);if(fe===0)continue;le=fe===2}var _e=$.aabb.distanceX(w),Te=$.aabb.distanceY(w),ke=Math.max(Math.abs(_e),Math.abs(Te));if($.zoom===G||ke>3+(1<<G-$.zoom)-2&&$.zoom>=E)Z.push({tileID:new a.OverscaledTileID($.zoom===G?H:$.zoom,$.wrap,$.zoom,ue,Y),distanceSq:a.sqrLen([w[0]-.5-ue,w[1]-.5-Y])});else for(var Ae=0;Ae<4;Ae++){var Oe=(ue<<1)+Ae%2,He=(Y<<1)+(Ae>>1);O.push({aabb:$.aabb.quadrant(Ae),zoom:$.zoom+1,x:Oe,y:He,wrap:$.wrap,fullyVisible:le})}}return Z.sort(function(Ge,lt){return Ge.distanceSq-lt.distanceSq}).map(function(Ge){return Ge.tileID})},fr.prototype.resize=function(n,s){this.width=n,this.height=s,this.pixelsToGLUnits=[2/n,-2/s],this._constrain(),this._calcMatrices()},Ur.unmodified.get=function(){return this._unmodified},fr.prototype.zoomScale=function(n){return Math.pow(2,n)},fr.prototype.scaleZoom=function(n){return Math.log(n)/Math.LN2},fr.prototype.project=function(n){var s=a.clamp(n.lat,-this.maxValidLatitude,this.maxValidLatitude);return new a.Point(a.mercatorXfromLng(n.lng)*this.worldSize,a.mercatorYfromLat(s)*this.worldSize)},fr.prototype.unproject=function(n){return new a.MercatorCoordinate(n.x/this.worldSize,n.y/this.worldSize).toLngLat()},Ur.point.get=function(){return this.project(this.center)},fr.prototype.setLocationAtPoint=function(n,s){var o=this.pointCoordinate(s),c=this.pointCoordinate(this.centerPoint),_=this.locationCoordinate(n),w=new a.MercatorCoordinate(_.x-(o.x-c.x),_.y-(o.y-c.y));this.center=this.coordinateLocation(w),this._renderWorldCopies&&(this.center=this.center.wrap())},fr.prototype.locationPoint=function(n){return this.coordinatePoint(this.locationCoordinate(n))},fr.prototype.pointLocation=function(n){return this.coordinateLocation(this.pointCoordinate(n))},fr.prototype.locationCoordinate=function(n){return a.MercatorCoordinate.fromLngLat(n)},fr.prototype.coordinateLocation=function(n){return n.toLngLat()},fr.prototype.pointCoordinate=function(n){var s=[n.x,n.y,0,1],o=[n.x,n.y,1,1];a.transformMat4(s,s,this.pixelMatrixInverse),a.transformMat4(o,o,this.pixelMatrixInverse);var c=s[3],_=o[3],w=s[1]/c,S=o[1]/_,E=s[2]/c,P=o[2]/_,O=E===P?0:(0-E)/(P-E);return new a.MercatorCoordinate(a.number(s[0]/c,o[0]/_,O)/this.worldSize,a.number(w,S,O)/this.worldSize)},fr.prototype.coordinatePoint=function(n){var s=[n.x*this.worldSize,n.y*this.worldSize,0,1];return a.transformMat4(s,s,this.pixelMatrix),new a.Point(s[0]/s[3],s[1]/s[3])},fr.prototype.getBounds=function(){return new a.LngLatBounds().extend(this.pointLocation(new a.Point(0,0))).extend(this.pointLocation(new a.Point(this.width,0))).extend(this.pointLocation(new a.Point(this.width,this.height))).extend(this.pointLocation(new a.Point(0,this.height)))},fr.prototype.getMaxBounds=function(){return this.latRange&&this.latRange.length===2&&this.lngRange&&this.lngRange.length===2?new a.LngLatBounds([this.lngRange[0],this.latRange[0]],[this.lngRange[1],this.latRange[1]]):null},fr.prototype.setMaxBounds=function(n){n?(this.lngRange=[n.getWest(),n.getEast()],this.latRange=[n.getSouth(),n.getNorth()],this._constrain()):(this.lngRange=null,this.latRange=[-this.maxValidLatitude,this.maxValidLatitude])},fr.prototype.calculatePosMatrix=function(n,s){s===void 0&&(s=!1);var o=n.key,c=s?this._alignedPosMatrixCache:this._posMatrixCache;if(c[o])return c[o];var _=n.canonical,w=this.worldSize/this.zoomScale(_.z),S=_.x+Math.pow(2,_.z)*n.wrap,E=a.identity(new Float64Array(16));return a.translate(E,E,[S*w,_.y*w,0]),a.scale(E,E,[w/a.EXTENT,w/a.EXTENT,1]),a.multiply(E,s?this.alignedProjMatrix:this.projMatrix,E),c[o]=new Float32Array(E),c[o]},fr.prototype.customLayerMatrix=function(){return this.mercatorMatrix.slice()},fr.prototype._constrain=function(){if(this.center&&this.width&&this.height&&!this._constraining){this._constraining=!0;var n,s,o,c,_=-90,w=90,S=-180,E=180,P=this.size,O=this._unmodified;if(this.latRange){var Z=this.latRange;_=a.mercatorYfromLat(Z[1])*this.worldSize,n=(w=a.mercatorYfromLat(Z[0])*this.worldSize)-_<P.y?P.y/(w-_):0}if(this.lngRange){var G=this.lngRange;S=a.mercatorXfromLng(G[0])*this.worldSize,s=(E=a.mercatorXfromLng(G[1])*this.worldSize)-S<P.x?P.x/(E-S):0}var H=this.point,te=Math.max(s||0,n||0);if(te)return this.center=this.unproject(new a.Point(s?(E+S)/2:H.x,n?(w+_)/2:H.y)),this.zoom+=this.scaleZoom(te),this._unmodified=O,void(this._constraining=!1);if(this.latRange){var $=H.y,ue=P.y/2;$-ue<_&&(c=_+ue),$+ue>w&&(c=w-ue)}if(this.lngRange){var Y=H.x,le=P.x/2;Y-le<S&&(o=S+le),Y+le>E&&(o=E-le)}o===void 0&&c===void 0||(this.center=this.unproject(new a.Point(o!==void 0?o:H.x,c!==void 0?c:H.y))),this._unmodified=O,this._constraining=!1}},fr.prototype._calcMatrices=function(){if(this.height){var n=this.centerOffset;this.cameraToCenterDistance=.5/Math.tan(this._fov/2)*this.height;var s=Math.PI/2+this._pitch,o=this._fov*(.5+n.y/this.height),c=Math.sin(o)*this.cameraToCenterDistance/Math.sin(a.clamp(Math.PI-s-o,.01,Math.PI-.01)),_=this.point,w=_.x,S=_.y,E=1.01*(Math.cos(Math.PI/2-this._pitch)*c+this.cameraToCenterDistance),P=this.height/50,O=new Float64Array(16);a.perspective(O,this._fov,this.width/this.height,P,E),O[8]=2*-n.x/this.width,O[9]=2*n.y/this.height,a.scale(O,O,[1,-1,1]),a.translate(O,O,[0,0,-this.cameraToCenterDistance]),a.rotateX(O,O,this._pitch),a.rotateZ(O,O,this.angle),a.translate(O,O,[-w,-S,0]),this.mercatorMatrix=a.scale([],O,[this.worldSize,this.worldSize,this.worldSize]),a.scale(O,O,[1,1,a.mercatorZfromAltitude(1,this.center.lat)*this.worldSize,1]),this.projMatrix=O,this.invProjMatrix=a.invert([],this.projMatrix);var Z=this.width%2/2,G=this.height%2/2,H=Math.cos(this.angle),te=Math.sin(this.angle),$=w-Math.round(w)+H*Z+te*G,ue=S-Math.round(S)+H*G+te*Z,Y=new Float64Array(O);if(a.translate(Y,Y,[$>.5?$-1:$,ue>.5?ue-1:ue,0]),this.alignedProjMatrix=Y,O=a.create(),a.scale(O,O,[this.width/2,-this.height/2,1]),a.translate(O,O,[1,-1,0]),this.labelPlaneMatrix=O,O=a.create(),a.scale(O,O,[1,-1,1]),a.translate(O,O,[-1,-1,0]),a.scale(O,O,[2/this.width,2/this.height,1]),this.glCoordMatrix=O,this.pixelMatrix=a.multiply(new Float64Array(16),this.labelPlaneMatrix,this.projMatrix),!(O=a.invert(new Float64Array(16),this.pixelMatrix)))throw new Error("failed to invert matrix");this.pixelMatrixInverse=O,this._posMatrixCache={},this._alignedPosMatrixCache={}}},fr.prototype.maxPitchScaleFactor=function(){if(!this.pixelMatrixInverse)return 1;var n=this.pointCoordinate(new a.Point(0,0)),s=[n.x*this.worldSize,n.y*this.worldSize,0,1];return a.transformMat4(s,s,this.pixelMatrix)[3]/this.cameraToCenterDistance},fr.prototype.getCameraPoint=function(){var n=Math.tan(this._pitch)*(this.cameraToCenterDistance||1);return this.centerPoint.add(new a.Point(0,n))},fr.prototype.getCameraQueryGeometry=function(n){var s=this.getCameraPoint();if(n.length===1)return[n[0],s];for(var o=s.x,c=s.y,_=s.x,w=s.y,S=0,E=n;S<E.length;S+=1){var P=E[S];o=Math.min(o,P.x),c=Math.min(c,P.y),_=Math.max(_,P.x),w=Math.max(w,P.y)}return[new a.Point(o,c),new a.Point(_,c),new a.Point(_,w),new a.Point(o,w),new a.Point(o,c)]},Object.defineProperties(fr.prototype,Ur);var Jn=function(n){var s,o,c,_;this._hashName=n&&encodeURIComponent(n),a.bindAll(["_getCurrentHash","_onHashChange","_updateHash"],this),this._updateHash=(s=this._updateHashUnthrottled.bind(this),o=!1,c=null,_=function(){c=null,o&&(s(),c=setTimeout(_,300),o=!1)},function(){return o=!0,c||_(),c})};Jn.prototype.addTo=function(n){return this._map=n,a.window.addEventListener("hashchange",this._onHashChange,!1),this._map.on("moveend",this._updateHash),this},Jn.prototype.remove=function(){return a.window.removeEventListener("hashchange",this._onHashChange,!1),this._map.off("moveend",this._updateHash),clearTimeout(this._updateHash()),delete this._map,this},Jn.prototype.getHashString=function(n){var s=this._map.getCenter(),o=Math.round(100*this._map.getZoom())/100,c=Math.ceil((o*Math.LN2+Math.log(512/360/.5))/Math.LN10),_=Math.pow(10,c),w=Math.round(s.lng*_)/_,S=Math.round(s.lat*_)/_,E=this._map.getBearing(),P=this._map.getPitch(),O="";if(O+=n?"/"+w+"/"+S+"/"+o:o+"/"+S+"/"+w,(E||P)&&(O+="/"+Math.round(10*E)/10),P&&(O+="/"+Math.round(P)),this._hashName){var Z=this._hashName,G=!1,H=a.window.location.hash.slice(1).split("&").map(function(te){var $=te.split("=")[0];return $===Z?(G=!0,$+"="+O):te}).filter(function(te){return te});return G||H.push(Z+"="+O),"#"+H.join("&")}return"#"+O},Jn.prototype._getCurrentHash=function(){var n,s=this,o=a.window.location.hash.replace("#","");return this._hashName?(o.split("&").map(function(c){return c.split("=")}).forEach(function(c){c[0]===s._hashName&&(n=c)}),(n&&n[1]||"").split("/")):o.split("/")},Jn.prototype._onHashChange=function(){var n=this._getCurrentHash();if(n.length>=3&&!n.some(function(o){return isNaN(o)})){var s=this._map.dragRotate.isEnabled()&&this._map.touchZoomRotate.isEnabled()?+(n[3]||0):this._map.getBearing();return this._map.jumpTo({center:[+n[2],+n[1]],zoom:+n[0],bearing:s,pitch:+(n[4]||0)}),!0}return!1},Jn.prototype._updateHashUnthrottled=function(){var n=a.window.location.href.replace(/(#.+)?$/,this.getHashString());try{a.window.history.replaceState(a.window.history.state,null,n)}catch{}};var ms={linearity:.3,easing:a.bezier(0,0,.3,1)},qo=a.extend({deceleration:2500,maxSpeed:1400},ms),ys=a.extend({deceleration:20,maxSpeed:1400},ms),Kh=a.extend({deceleration:1e3,maxSpeed:360},ms),Hh=a.extend({deceleration:1e3,maxSpeed:90},ms),gs=function(n){this._map=n,this.clear()};function _s(n,s){(!n.duration||n.duration<s.duration)&&(n.duration=s.duration,n.easing=s.easing)}function Ca(n,s,o){var c=o.maxSpeed,_=o.linearity,w=o.deceleration,S=a.clamp(n*_/(s/1e3),-c,c),E=Math.abs(S)/(w*_);return{easing:o.easing,duration:1e3*E,amount:S*(E/2)}}gs.prototype.clear=function(){this._inertiaBuffer=[]},gs.prototype.record=function(n){this._drainInertiaBuffer(),this._inertiaBuffer.push({time:a.browser.now(),settings:n})},gs.prototype._drainInertiaBuffer=function(){for(var n=this._inertiaBuffer,s=a.browser.now();n.length>0&&s-n[0].time>160;)n.shift()},gs.prototype._onMoveEnd=function(n){if(this._drainInertiaBuffer(),!(this._inertiaBuffer.length<2)){for(var s={zoom:0,bearing:0,pitch:0,pan:new a.Point(0,0),pinchAround:void 0,around:void 0},o=0,c=this._inertiaBuffer;o<c.length;o+=1){var _=c[o].settings;s.zoom+=_.zoomDelta||0,s.bearing+=_.bearingDelta||0,s.pitch+=_.pitchDelta||0,_.panDelta&&s.pan._add(_.panDelta),_.around&&(s.around=_.around),_.pinchAround&&(s.pinchAround=_.pinchAround)}var w=this._inertiaBuffer[this._inertiaBuffer.length-1].time-this._inertiaBuffer[0].time,S={};if(s.pan.mag()){var E=Ca(s.pan.mag(),w,a.extend({},qo,n||{}));S.offset=s.pan.mult(E.amount/s.pan.mag()),S.center=this._map.transform.center,_s(S,E)}if(s.zoom){var P=Ca(s.zoom,w,ys);S.zoom=this._map.transform.zoom+P.amount,_s(S,P)}if(s.bearing){var O=Ca(s.bearing,w,Kh);S.bearing=this._map.transform.bearing+a.clamp(O.amount,-179,179),_s(S,O)}if(s.pitch){var Z=Ca(s.pitch,w,Hh);S.pitch=this._map.transform.pitch+Z.amount,_s(S,Z)}if(S.zoom||S.bearing){var G=s.pinchAround===void 0?s.around:s.pinchAround;S.around=G?this._map.unproject(G):this._map.getCenter()}return this.clear(),a.extend(S,{noMoveStart:!0})}};var Ci=function(n){function s(c,_,w,S){S===void 0&&(S={});var E=z.mousePos(_.getCanvasContainer(),w),P=_.unproject(E);n.call(this,c,a.extend({point:E,lngLat:P,originalEvent:w},S)),this._defaultPrevented=!1,this.target=_}n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s;var o={defaultPrevented:{configurable:!0}};return s.prototype.preventDefault=function(){this._defaultPrevented=!0},o.defaultPrevented.get=function(){return this._defaultPrevented},Object.defineProperties(s.prototype,o),s}(a.Event),vs=function(n){function s(c,_,w){var S=c==="touchend"?w.changedTouches:w.touches,E=z.touchPos(_.getCanvasContainer(),S),P=E.map(function(G){return _.unproject(G)}),O=E.reduce(function(G,H,te,$){return G.add(H.div($.length))},new a.Point(0,0)),Z=_.unproject(O);n.call(this,c,{points:E,point:O,lngLats:P,lngLat:Z,originalEvent:w}),this._defaultPrevented=!1}n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s;var o={defaultPrevented:{configurable:!0}};return s.prototype.preventDefault=function(){this._defaultPrevented=!0},o.defaultPrevented.get=function(){return this._defaultPrevented},Object.defineProperties(s.prototype,o),s}(a.Event),Ec=function(n){function s(c,_,w){n.call(this,c,{originalEvent:w}),this._defaultPrevented=!1}n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s;var o={defaultPrevented:{configurable:!0}};return s.prototype.preventDefault=function(){this._defaultPrevented=!0},o.defaultPrevented.get=function(){return this._defaultPrevented},Object.defineProperties(s.prototype,o),s}(a.Event),ki=function(n,s){this._map=n,this._clickTolerance=s.clickTolerance};ki.prototype.reset=function(){delete this._mousedownPos},ki.prototype.wheel=function(n){return this._firePreventable(new Ec(n.type,this._map,n))},ki.prototype.mousedown=function(n,s){return this._mousedownPos=s,this._firePreventable(new Ci(n.type,this._map,n))},ki.prototype.mouseup=function(n){this._map.fire(new Ci(n.type,this._map,n))},ki.prototype.click=function(n,s){this._mousedownPos&&this._mousedownPos.dist(s)>=this._clickTolerance||this._map.fire(new Ci(n.type,this._map,n))},ki.prototype.dblclick=function(n){return this._firePreventable(new Ci(n.type,this._map,n))},ki.prototype.mouseover=function(n){this._map.fire(new Ci(n.type,this._map,n))},ki.prototype.mouseout=function(n){this._map.fire(new Ci(n.type,this._map,n))},ki.prototype.touchstart=function(n){return this._firePreventable(new vs(n.type,this._map,n))},ki.prototype.touchmove=function(n){this._map.fire(new vs(n.type,this._map,n))},ki.prototype.touchend=function(n){this._map.fire(new vs(n.type,this._map,n))},ki.prototype.touchcancel=function(n){this._map.fire(new vs(n.type,this._map,n))},ki.prototype._firePreventable=function(n){if(this._map.fire(n),n.defaultPrevented)return{}},ki.prototype.isEnabled=function(){return!0},ki.prototype.isActive=function(){return!1},ki.prototype.enable=function(){},ki.prototype.disable=function(){};var ft=function(n){this._map=n};ft.prototype.reset=function(){this._delayContextMenu=!1,delete this._contextMenuEvent},ft.prototype.mousemove=function(n){this._map.fire(new Ci(n.type,this._map,n))},ft.prototype.mousedown=function(){this._delayContextMenu=!0},ft.prototype.mouseup=function(){this._delayContextMenu=!1,this._contextMenuEvent&&(this._map.fire(new Ci("contextmenu",this._map,this._contextMenuEvent)),delete this._contextMenuEvent)},ft.prototype.contextmenu=function(n){this._delayContextMenu?this._contextMenuEvent=n:this._map.fire(new Ci(n.type,this._map,n)),this._map.listens("contextmenu")&&n.preventDefault()},ft.prototype.isEnabled=function(){return!0},ft.prototype.isActive=function(){return!1},ft.prototype.enable=function(){},ft.prototype.disable=function(){};var On=function(n,s){this._map=n,this._el=n.getCanvasContainer(),this._container=n.getContainer(),this._clickTolerance=s.clickTolerance||1};function Ws(n,s){for(var o={},c=0;c<n.length;c++)o[n[c].identifier]=s[c];return o}On.prototype.isEnabled=function(){return!!this._enabled},On.prototype.isActive=function(){return!!this._active},On.prototype.enable=function(){this.isEnabled()||(this._enabled=!0)},On.prototype.disable=function(){this.isEnabled()&&(this._enabled=!1)},On.prototype.mousedown=function(n,s){this.isEnabled()&&n.shiftKey&&n.button===0&&(z.disableDrag(),this._startPos=this._lastPos=s,this._active=!0)},On.prototype.mousemoveWindow=function(n,s){if(this._active){var o=s;if(!(this._lastPos.equals(o)||!this._box&&o.dist(this._startPos)<this._clickTolerance)){var c=this._startPos;this._lastPos=o,this._box||(this._box=z.create("div","mapboxgl-boxzoom",this._container),this._container.classList.add("mapboxgl-crosshair"),this._fireEvent("boxzoomstart",n));var _=Math.min(c.x,o.x),w=Math.max(c.x,o.x),S=Math.min(c.y,o.y),E=Math.max(c.y,o.y);z.setTransform(this._box,"translate("+_+"px,"+S+"px)"),this._box.style.width=w-_+"px",this._box.style.height=E-S+"px"}}},On.prototype.mouseupWindow=function(n,s){var o=this;if(this._active&&n.button===0){var c=this._startPos,_=s;if(this.reset(),z.suppressClick(),c.x!==_.x||c.y!==_.y)return this._map.fire(new a.Event("boxzoomend",{originalEvent:n})),{cameraAnimation:function(w){return w.fitScreenCoordinates(c,_,o._map.getBearing(),{linear:!0})}};this._fireEvent("boxzoomcancel",n)}},On.prototype.keydown=function(n){this._active&&n.keyCode===27&&(this.reset(),this._fireEvent("boxzoomcancel",n))},On.prototype.blur=function(){this.reset()},On.prototype.reset=function(){this._active=!1,this._container.classList.remove("mapboxgl-crosshair"),this._box&&(z.remove(this._box),this._box=null),z.enableDrag(),delete this._startPos,delete this._lastPos},On.prototype._fireEvent=function(n,s){return this._map.fire(new a.Event(n,{originalEvent:s}))};var jo=function(n){this.reset(),this.numTouches=n.numTouches};jo.prototype.reset=function(){delete this.centroid,delete this.startTime,delete this.touches,this.aborted=!1},jo.prototype.touchstart=function(n,s,o){(this.centroid||o.length>this.numTouches)&&(this.aborted=!0),this.aborted||(this.startTime===void 0&&(this.startTime=n.timeStamp),o.length===this.numTouches&&(this.centroid=function(c){for(var _=new a.Point(0,0),w=0,S=c;w<S.length;w+=1)_._add(S[w]);return _.div(c.length)}(s),this.touches=Ws(o,s)))},jo.prototype.touchmove=function(n,s,o){if(!this.aborted&&this.centroid){var c=Ws(o,s);for(var _ in this.touches){var w=c[_];(!w||w.dist(this.touches[_])>30)&&(this.aborted=!0)}}},jo.prototype.touchend=function(n,s,o){if((!this.centroid||n.timeStamp-this.startTime>500)&&(this.aborted=!0),o.length===0){var c=!this.aborted&&this.centroid;if(this.reset(),c)return c}};var fa=function(n){this.singleTap=new jo(n),this.numTaps=n.numTaps,this.reset()};fa.prototype.reset=function(){this.lastTime=1/0,delete this.lastTap,this.count=0,this.singleTap.reset()},fa.prototype.touchstart=function(n,s,o){this.singleTap.touchstart(n,s,o)},fa.prototype.touchmove=function(n,s,o){this.singleTap.touchmove(n,s,o)},fa.prototype.touchend=function(n,s,o){var c=this.singleTap.touchend(n,s,o);if(c){var _=n.timeStamp-this.lastTime<500,w=!this.lastTap||this.lastTap.dist(c)<30;if(_&&w||this.reset(),this.count++,this.lastTime=n.timeStamp,this.lastTap=c,this.count===this.numTaps)return this.reset(),c}};var Fn=function(){this._zoomIn=new fa({numTouches:1,numTaps:2}),this._zoomOut=new fa({numTouches:2,numTaps:1}),this.reset()};Fn.prototype.reset=function(){this._active=!1,this._zoomIn.reset(),this._zoomOut.reset()},Fn.prototype.touchstart=function(n,s,o){this._zoomIn.touchstart(n,s,o),this._zoomOut.touchstart(n,s,o)},Fn.prototype.touchmove=function(n,s,o){this._zoomIn.touchmove(n,s,o),this._zoomOut.touchmove(n,s,o)},Fn.prototype.touchend=function(n,s,o){var c=this,_=this._zoomIn.touchend(n,s,o),w=this._zoomOut.touchend(n,s,o);return _?(this._active=!0,n.preventDefault(),setTimeout(function(){return c.reset()},0),{cameraAnimation:function(S){return S.easeTo({duration:300,zoom:S.getZoom()+1,around:S.unproject(_)},{originalEvent:n})}}):w?(this._active=!0,n.preventDefault(),setTimeout(function(){return c.reset()},0),{cameraAnimation:function(S){return S.easeTo({duration:300,zoom:S.getZoom()-1,around:S.unproject(w)},{originalEvent:n})}}):void 0},Fn.prototype.touchcancel=function(){this.reset()},Fn.prototype.enable=function(){this._enabled=!0},Fn.prototype.disable=function(){this._enabled=!1,this.reset()},Fn.prototype.isEnabled=function(){return this._enabled},Fn.prototype.isActive=function(){return this._active};var Ql={0:1,2:2},et=function(n){this.reset(),this._clickTolerance=n.clickTolerance||1};et.prototype.blur=function(){this.reset()},et.prototype.reset=function(){this._active=!1,this._moved=!1,delete this._lastPoint,delete this._eventButton},et.prototype._correctButton=function(n,s){return!1},et.prototype._move=function(n,s){return{}},et.prototype.mousedown=function(n,s){if(!this._lastPoint){var o=z.mouseButton(n);this._correctButton(n,o)&&(this._lastPoint=s,this._eventButton=o)}},et.prototype.mousemoveWindow=function(n,s){var o=this._lastPoint;if(o){if(n.preventDefault(),function(c,_){var w=Ql[_];return c.buttons===void 0||(c.buttons&w)!==w}(n,this._eventButton))this.reset();else if(this._moved||!(s.dist(o)<this._clickTolerance))return this._moved=!0,this._lastPoint=s,this._move(o,s)}},et.prototype.mouseupWindow=function(n){this._lastPoint&&z.mouseButton(n)===this._eventButton&&(this._moved&&z.suppressClick(),this.reset())},et.prototype.enable=function(){this._enabled=!0},et.prototype.disable=function(){this._enabled=!1,this.reset()},et.prototype.isEnabled=function(){return this._enabled},et.prototype.isActive=function(){return this._active};var $l=function(n){function s(){n.apply(this,arguments)}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype.mousedown=function(o,c){n.prototype.mousedown.call(this,o,c),this._lastPoint&&(this._active=!0)},s.prototype._correctButton=function(o,c){return c===0&&!o.ctrlKey},s.prototype._move=function(o,c){return{around:c,panDelta:c.sub(o)}},s}(et),Ys=function(n){function s(){n.apply(this,arguments)}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype._correctButton=function(o,c){return c===0&&o.ctrlKey||c===2},s.prototype._move=function(o,c){var _=.8*(c.x-o.x);if(_)return this._active=!0,{bearingDelta:_}},s.prototype.contextmenu=function(o){o.preventDefault()},s}(et),eu=function(n){function s(){n.apply(this,arguments)}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype._correctButton=function(o,c){return c===0&&o.ctrlKey||c===2},s.prototype._move=function(o,c){var _=-.5*(c.y-o.y);if(_)return this._active=!0,{pitchDelta:_}},s.prototype.contextmenu=function(o){o.preventDefault()},s}(et),ia=function(n){this._minTouches=1,this._clickTolerance=n.clickTolerance||1,this.reset()};ia.prototype.reset=function(){this._active=!1,this._touches={},this._sum=new a.Point(0,0)},ia.prototype.touchstart=function(n,s,o){return this._calculateTransform(n,s,o)},ia.prototype.touchmove=function(n,s,o){if(this._active&&!(o.length<this._minTouches))return n.preventDefault(),this._calculateTransform(n,s,o)},ia.prototype.touchend=function(n,s,o){this._calculateTransform(n,s,o),this._active&&o.length<this._minTouches&&this.reset()},ia.prototype.touchcancel=function(){this.reset()},ia.prototype._calculateTransform=function(n,s,o){o.length>0&&(this._active=!0);var c=Ws(o,s),_=new a.Point(0,0),w=new a.Point(0,0),S=0;for(var E in c){var P=c[E],O=this._touches[E];O&&(_._add(P),w._add(P.sub(O)),S++,c[E]=P)}if(this._touches=c,!(S<this._minTouches)&&w.mag()){var Z=w.div(S);if(this._sum._add(Z),!(this._sum.mag()<this._clickTolerance))return{around:_.div(S),panDelta:Z}}},ia.prototype.enable=function(){this._enabled=!0},ia.prototype.disable=function(){this._enabled=!1,this.reset()},ia.prototype.isEnabled=function(){return this._enabled},ia.prototype.isActive=function(){return this._active};var Nn=function(){this.reset()};function Js(n,s,o){for(var c=0;c<n.length;c++)if(n[c].identifier===o)return s[c]}function Qs(n,s){return Math.log(n/s)/Math.LN2}Nn.prototype.reset=function(){this._active=!1,delete this._firstTwoTouches},Nn.prototype._start=function(n){},Nn.prototype._move=function(n,s,o){return{}},Nn.prototype.touchstart=function(n,s,o){this._firstTwoTouches||o.length<2||(this._firstTwoTouches=[o[0].identifier,o[1].identifier],this._start([s[0],s[1]]))},Nn.prototype.touchmove=function(n,s,o){if(this._firstTwoTouches){n.preventDefault();var c=this._firstTwoTouches,_=c[1],w=Js(o,s,c[0]),S=Js(o,s,_);if(w&&S){var E=this._aroundCenter?null:w.add(S).div(2);return this._move([w,S],E,n)}}},Nn.prototype.touchend=function(n,s,o){if(this._firstTwoTouches){var c=this._firstTwoTouches,_=c[1],w=Js(o,s,c[0]),S=Js(o,s,_);w&&S||(this._active&&z.suppressClick(),this.reset())}},Nn.prototype.touchcancel=function(){this.reset()},Nn.prototype.enable=function(n){this._enabled=!0,this._aroundCenter=!!n&&n.around==="center"},Nn.prototype.disable=function(){this._enabled=!1,this.reset()},Nn.prototype.isEnabled=function(){return this._enabled},Nn.prototype.isActive=function(){return this._active};var Un=function(n){function s(){n.apply(this,arguments)}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype.reset=function(){n.prototype.reset.call(this),delete this._distance,delete this._startDistance},s.prototype._start=function(o){this._startDistance=this._distance=o[0].dist(o[1])},s.prototype._move=function(o,c){var _=this._distance;if(this._distance=o[0].dist(o[1]),this._active||!(Math.abs(Qs(this._distance,this._startDistance))<.1))return this._active=!0,{zoomDelta:Qs(this._distance,_),pinchAround:c}},s}(Nn);function Ma(n,s){return 180*n.angleWith(s)/Math.PI}var zc=function(n){function s(){n.apply(this,arguments)}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype.reset=function(){n.prototype.reset.call(this),delete this._minDiameter,delete this._startVector,delete this._vector},s.prototype._start=function(o){this._startVector=this._vector=o[0].sub(o[1]),this._minDiameter=o[0].dist(o[1])},s.prototype._move=function(o,c){var _=this._vector;if(this._vector=o[0].sub(o[1]),this._active||!this._isBelowThreshold(this._vector))return this._active=!0,{bearingDelta:Ma(this._vector,_),pinchAround:c}},s.prototype._isBelowThreshold=function(o){this._minDiameter=Math.min(this._minDiameter,o.mag());var c=25/(Math.PI*this._minDiameter)*360,_=Ma(o,this._startVector);return Math.abs(_)<c},s}(Nn);function bs(n){return Math.abs(n.y)>Math.abs(n.x)}var tu=function(n){function s(){n.apply(this,arguments)}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype.reset=function(){n.prototype.reset.call(this),this._valid=void 0,delete this._firstMove,delete this._lastPoints},s.prototype._start=function(o){this._lastPoints=o,bs(o[0].sub(o[1]))&&(this._valid=!1)},s.prototype._move=function(o,c,_){var w=o[0].sub(this._lastPoints[0]),S=o[1].sub(this._lastPoints[1]);if(this._valid=this.gestureBeginsVertically(w,S,_.timeStamp),this._valid)return this._lastPoints=o,this._active=!0,{pitchDelta:(w.y+S.y)/2*-.5}},s.prototype.gestureBeginsVertically=function(o,c,_){if(this._valid!==void 0)return this._valid;var w=o.mag()>=2,S=c.mag()>=2;if(w||S){if(!w||!S)return this._firstMove===void 0&&(this._firstMove=_),_-this._firstMove<100&&void 0;var E=o.y>0==c.y>0;return bs(o)&&bs(c)&&E}},s}(Nn),ru={panStep:100,bearingStep:15,pitchStep:10},da=function(){var n=ru;this._panStep=n.panStep,this._bearingStep=n.bearingStep,this._pitchStep=n.pitchStep,this._rotationDisabled=!1};function Qn(n){return n*(2-n)}da.prototype.blur=function(){this.reset()},da.prototype.reset=function(){this._active=!1},da.prototype.keydown=function(n){var s=this;if(!(n.altKey||n.ctrlKey||n.metaKey)){var o=0,c=0,_=0,w=0,S=0;switch(n.keyCode){case 61:case 107:case 171:case 187:o=1;break;case 189:case 109:case 173:o=-1;break;case 37:n.shiftKey?c=-1:(n.preventDefault(),w=-1);break;case 39:n.shiftKey?c=1:(n.preventDefault(),w=1);break;case 38:n.shiftKey?_=1:(n.preventDefault(),S=-1);break;case 40:n.shiftKey?_=-1:(n.preventDefault(),S=1);break;default:return}return this._rotationDisabled&&(c=0,_=0),{cameraAnimation:function(E){var P=E.getZoom();E.easeTo({duration:300,easeId:"keyboardHandler",easing:Qn,zoom:o?Math.round(P)+o*(n.shiftKey?2:1):P,bearing:E.getBearing()+c*s._bearingStep,pitch:E.getPitch()+_*s._pitchStep,offset:[-w*s._panStep,-S*s._panStep],center:E.getCenter()},{originalEvent:n})}}}},da.prototype.enable=function(){this._enabled=!0},da.prototype.disable=function(){this._enabled=!1,this.reset()},da.prototype.isEnabled=function(){return this._enabled},da.prototype.isActive=function(){return this._active},da.prototype.disableRotation=function(){this._rotationDisabled=!0},da.prototype.enableRotation=function(){this._rotationDisabled=!1};var ur=function(n,s){this._map=n,this._el=n.getCanvasContainer(),this._handler=s,this._delta=0,this._defaultZoomRate=.01,this._wheelZoomRate=1/450,a.bindAll(["_onTimeout"],this)};ur.prototype.setZoomRate=function(n){this._defaultZoomRate=n},ur.prototype.setWheelZoomRate=function(n){this._wheelZoomRate=n},ur.prototype.isEnabled=function(){return!!this._enabled},ur.prototype.isActive=function(){return!!this._active||this._finishTimeout!==void 0},ur.prototype.isZooming=function(){return!!this._zooming},ur.prototype.enable=function(n){this.isEnabled()||(this._enabled=!0,this._aroundCenter=n&&n.around==="center")},ur.prototype.disable=function(){this.isEnabled()&&(this._enabled=!1)},ur.prototype.wheel=function(n){if(this.isEnabled()){var s=n.deltaMode===a.window.WheelEvent.DOM_DELTA_LINE?40*n.deltaY:n.deltaY,o=a.browser.now(),c=o-(this._lastWheelEventTime||0);this._lastWheelEventTime=o,s!==0&&s%4.000244140625==0?this._type="wheel":s!==0&&Math.abs(s)<4?this._type="trackpad":c>400?(this._type=null,this._lastValue=s,this._timeout=setTimeout(this._onTimeout,40,n)):this._type||(this._type=Math.abs(c*s)<200?"trackpad":"wheel",this._timeout&&(clearTimeout(this._timeout),this._timeout=null,s+=this._lastValue)),n.shiftKey&&s&&(s/=4),this._type&&(this._lastWheelEvent=n,this._delta-=s,this._active||this._start(n)),n.preventDefault()}},ur.prototype._onTimeout=function(n){this._type="wheel",this._delta-=this._lastValue,this._active||this._start(n)},ur.prototype._start=function(n){if(this._delta){this._frameId&&(this._frameId=null),this._active=!0,this.isZooming()||(this._zooming=!0),this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout);var s=z.mousePos(this._el,n);this._around=a.LngLat.convert(this._aroundCenter?this._map.getCenter():this._map.unproject(s)),this._aroundPoint=this._map.transform.locationPoint(this._around),this._frameId||(this._frameId=!0,this._handler._triggerRenderFrame())}},ur.prototype.renderFrame=function(){var n=this;if(this._frameId&&(this._frameId=null,this.isActive())){var s=this._map.transform;if(this._delta!==0){var o=this._type==="wheel"&&Math.abs(this._delta)>4.000244140625?this._wheelZoomRate:this._defaultZoomRate,c=2/(1+Math.exp(-Math.abs(this._delta*o)));this._delta<0&&c!==0&&(c=1/c);var _=typeof this._targetZoom=="number"?s.zoomScale(this._targetZoom):s.scale;this._targetZoom=Math.min(s.maxZoom,Math.max(s.minZoom,s.scaleZoom(_*c))),this._type==="wheel"&&(this._startZoom=s.zoom,this._easing=this._smoothOutEasing(200)),this._delta=0}var w,S=typeof this._targetZoom=="number"?this._targetZoom:s.zoom,E=this._startZoom,P=this._easing,O=!1;if(this._type==="wheel"&&E&&P){var Z=Math.min((a.browser.now()-this._lastWheelEventTime)/200,1),G=P(Z);w=a.number(E,S,G),Z<1?this._frameId||(this._frameId=!0):O=!0}else w=S,O=!0;return this._active=!0,O&&(this._active=!1,this._finishTimeout=setTimeout(function(){n._zooming=!1,n._handler._triggerRenderFrame(),delete n._targetZoom,delete n._finishTimeout},200)),{noInertia:!0,needsRenderFrame:!O,zoomDelta:w-s.zoom,around:this._aroundPoint,originalEvent:this._lastWheelEvent}}},ur.prototype._smoothOutEasing=function(n){var s=a.ease;if(this._prevEase){var o=this._prevEase,c=(a.browser.now()-o.start)/o.duration,_=o.easing(c+.01)-o.easing(c),w=.27/Math.sqrt(_*_+1e-4)*.01,S=Math.sqrt(.0729-w*w);s=a.bezier(w,S,.25,1)}return this._prevEase={start:a.browser.now(),duration:n,easing:s},s},ur.prototype.blur=function(){this.reset()},ur.prototype.reset=function(){this._active=!1};var Ea=function(n,s){this._clickZoom=n,this._tapZoom=s};Ea.prototype.enable=function(){this._clickZoom.enable(),this._tapZoom.enable()},Ea.prototype.disable=function(){this._clickZoom.disable(),this._tapZoom.disable()},Ea.prototype.isEnabled=function(){return this._clickZoom.isEnabled()&&this._tapZoom.isEnabled()},Ea.prototype.isActive=function(){return this._clickZoom.isActive()||this._tapZoom.isActive()};var na=function(){this.reset()};na.prototype.reset=function(){this._active=!1},na.prototype.blur=function(){this.reset()},na.prototype.dblclick=function(n,s){return n.preventDefault(),{cameraAnimation:function(o){o.easeTo({duration:300,zoom:o.getZoom()+(n.shiftKey?-1:1),around:o.unproject(s)},{originalEvent:n})}}},na.prototype.enable=function(){this._enabled=!0},na.prototype.disable=function(){this._enabled=!1,this.reset()},na.prototype.isEnabled=function(){return this._enabled},na.prototype.isActive=function(){return this._active};var nn=function(){this._tap=new fa({numTouches:1,numTaps:1}),this.reset()};nn.prototype.reset=function(){this._active=!1,delete this._swipePoint,delete this._swipeTouch,delete this._tapTime,this._tap.reset()},nn.prototype.touchstart=function(n,s,o){this._swipePoint||(this._tapTime&&n.timeStamp-this._tapTime>500&&this.reset(),this._tapTime?o.length>0&&(this._swipePoint=s[0],this._swipeTouch=o[0].identifier):this._tap.touchstart(n,s,o))},nn.prototype.touchmove=function(n,s,o){if(this._tapTime){if(this._swipePoint){if(o[0].identifier!==this._swipeTouch)return;var c=s[0],_=c.y-this._swipePoint.y;return this._swipePoint=c,n.preventDefault(),this._active=!0,{zoomDelta:_/128}}}else this._tap.touchmove(n,s,o)},nn.prototype.touchend=function(n,s,o){this._tapTime?this._swipePoint&&o.length===0&&this.reset():this._tap.touchend(n,s,o)&&(this._tapTime=n.timeStamp)},nn.prototype.touchcancel=function(){this.reset()},nn.prototype.enable=function(){this._enabled=!0},nn.prototype.disable=function(){this._enabled=!1,this.reset()},nn.prototype.isEnabled=function(){return this._enabled},nn.prototype.isActive=function(){return this._active};var ko=function(n,s,o){this._el=n,this._mousePan=s,this._touchPan=o};ko.prototype.enable=function(n){this._inertiaOptions=n||{},this._mousePan.enable(),this._touchPan.enable(),this._el.classList.add("mapboxgl-touch-drag-pan")},ko.prototype.disable=function(){this._mousePan.disable(),this._touchPan.disable(),this._el.classList.remove("mapboxgl-touch-drag-pan")},ko.prototype.isEnabled=function(){return this._mousePan.isEnabled()&&this._touchPan.isEnabled()},ko.prototype.isActive=function(){return this._mousePan.isActive()||this._touchPan.isActive()};var Xa=function(n,s,o){this._pitchWithRotate=n.pitchWithRotate,this._mouseRotate=s,this._mousePitch=o};Xa.prototype.enable=function(){this._mouseRotate.enable(),this._pitchWithRotate&&this._mousePitch.enable()},Xa.prototype.disable=function(){this._mouseRotate.disable(),this._mousePitch.disable()},Xa.prototype.isEnabled=function(){return this._mouseRotate.isEnabled()&&(!this._pitchWithRotate||this._mousePitch.isEnabled())},Xa.prototype.isActive=function(){return this._mouseRotate.isActive()||this._mousePitch.isActive()};var ma=function(n,s,o,c){this._el=n,this._touchZoom=s,this._touchRotate=o,this._tapDragZoom=c,this._rotationDisabled=!1,this._enabled=!0};ma.prototype.enable=function(n){this._touchZoom.enable(n),this._rotationDisabled||this._touchRotate.enable(n),this._tapDragZoom.enable(),this._el.classList.add("mapboxgl-touch-zoom-rotate")},ma.prototype.disable=function(){this._touchZoom.disable(),this._touchRotate.disable(),this._tapDragZoom.disable(),this._el.classList.remove("mapboxgl-touch-zoom-rotate")},ma.prototype.isEnabled=function(){return this._touchZoom.isEnabled()&&(this._rotationDisabled||this._touchRotate.isEnabled())&&this._tapDragZoom.isEnabled()},ma.prototype.isActive=function(){return this._touchZoom.isActive()||this._touchRotate.isActive()||this._tapDragZoom.isActive()},ma.prototype.disableRotation=function(){this._rotationDisabled=!0,this._touchRotate.disable()},ma.prototype.enableRotation=function(){this._rotationDisabled=!1,this._touchZoom.isEnabled()&&this._touchRotate.enable()};var vn=function(n){return n.zoom||n.drag||n.pitch||n.rotate},xs=function(n){function s(){n.apply(this,arguments)}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s}(a.Event);function St(n){return n.panDelta&&n.panDelta.mag()||n.zoomDelta||n.bearingDelta||n.pitchDelta}var gt=function(n,s){this._map=n,this._el=this._map.getCanvasContainer(),this._handlers=[],this._handlersById={},this._changes=[],this._inertia=new gs(n),this._bearingSnap=s.bearingSnap,this._previousActiveHandlers={},this._eventsInProgress={},this._addDefaultHandlers(s),a.bindAll(["handleEvent","handleWindowEvent"],this);var o=this._el;this._listeners=[[o,"touchstart",{passive:!0}],[o,"touchmove",{passive:!1}],[o,"touchend",void 0],[o,"touchcancel",void 0],[o,"mousedown",void 0],[o,"mousemove",void 0],[o,"mouseup",void 0],[a.window.document,"mousemove",{capture:!0}],[a.window.document,"mouseup",void 0],[o,"mouseover",void 0],[o,"mouseout",void 0],[o,"dblclick",void 0],[o,"click",void 0],[o,"keydown",{capture:!1}],[o,"keyup",void 0],[o,"wheel",{passive:!1}],[o,"contextmenu",void 0],[a.window,"blur",void 0]];for(var c=0,_=this._listeners;c<_.length;c+=1){var w=_[c],S=w[0];z.addEventListener(S,w[1],S===a.window.document?this.handleWindowEvent:this.handleEvent,w[2])}};gt.prototype.destroy=function(){for(var n=0,s=this._listeners;n<s.length;n+=1){var o=s[n],c=o[0];z.removeEventListener(c,o[1],c===a.window.document?this.handleWindowEvent:this.handleEvent,o[2])}},gt.prototype._addDefaultHandlers=function(n){var s=this._map,o=s.getCanvasContainer();this._add("mapEvent",new ki(s,n));var c=s.boxZoom=new On(s,n);this._add("boxZoom",c);var _=new Fn,w=new na;s.doubleClickZoom=new Ea(w,_),this._add("tapZoom",_),this._add("clickZoom",w);var S=new nn;this._add("tapDragZoom",S);var E=s.touchPitch=new tu;this._add("touchPitch",E);var P=new Ys(n),O=new eu(n);s.dragRotate=new Xa(n,P,O),this._add("mouseRotate",P,["mousePitch"]),this._add("mousePitch",O,["mouseRotate"]);var Z=new $l(n),G=new ia(n);s.dragPan=new ko(o,Z,G),this._add("mousePan",Z),this._add("touchPan",G,["touchZoom","touchRotate"]);var H=new zc,te=new Un;s.touchZoomRotate=new ma(o,te,H,S),this._add("touchRotate",H,["touchPan","touchZoom"]),this._add("touchZoom",te,["touchPan","touchRotate"]);var $=s.scrollZoom=new ur(s,this);this._add("scrollZoom",$,["mousePan"]);var ue=s.keyboard=new da;this._add("keyboard",ue),this._add("blockableMapEvent",new ft(s));for(var Y=0,le=["boxZoom","doubleClickZoom","tapDragZoom","touchPitch","dragRotate","dragPan","touchZoomRotate","scrollZoom","keyboard"];Y<le.length;Y+=1){var fe=le[Y];n.interactive&&n[fe]&&s[fe].enable(n[fe])}},gt.prototype._add=function(n,s,o){this._handlers.push({handlerName:n,handler:s,allowed:o}),this._handlersById[n]=s},gt.prototype.stop=function(n){if(!this._updatingCamera){for(var s=0,o=this._handlers;s<o.length;s+=1)o[s].handler.reset();this._inertia.clear(),this._fireEvents({},{},n),this._changes=[]}},gt.prototype.isActive=function(){for(var n=0,s=this._handlers;n<s.length;n+=1)if(s[n].handler.isActive())return!0;return!1},gt.prototype.isZooming=function(){return!!this._eventsInProgress.zoom||this._map.scrollZoom.isZooming()},gt.prototype.isRotating=function(){return!!this._eventsInProgress.rotate},gt.prototype.isMoving=function(){return!!vn(this._eventsInProgress)||this.isZooming()},gt.prototype._blockedByActive=function(n,s,o){for(var c in n)if(c!==o&&(!s||s.indexOf(c)<0))return!0;return!1},gt.prototype.handleWindowEvent=function(n){this.handleEvent(n,n.type+"Window")},gt.prototype._getMapTouches=function(n){for(var s=[],o=0,c=n;o<c.length;o+=1){var _=c[o];this._el.contains(_.target)&&s.push(_)}return s},gt.prototype.handleEvent=function(n,s){this._updatingCamera=!0;for(var o=n.type==="renderFrame"?void 0:n,c={needsRenderFrame:!1},_={},w={},S=n.touches?this._getMapTouches(n.touches):void 0,E=S?z.touchPos(this._el,S):z.mousePos(this._el,n),P=0,O=this._handlers;P<O.length;P+=1){var Z=O[P],G=Z.handlerName,H=Z.handler,te=Z.allowed;if(H.isEnabled()){var $=void 0;this._blockedByActive(w,te,G)?H.reset():H[s||n.type]&&($=H[s||n.type](n,E,S),this.mergeHandlerResult(c,_,$,G,o),$&&$.needsRenderFrame&&this._triggerRenderFrame()),($||H.isActive())&&(w[G]=H)}}var ue={};for(var Y in this._previousActiveHandlers)w[Y]||(ue[Y]=o);this._previousActiveHandlers=w,(Object.keys(ue).length||St(c))&&(this._changes.push([c,_,ue]),this._triggerRenderFrame()),(Object.keys(w).length||St(c))&&this._map._stop(!0),this._updatingCamera=!1;var le=c.cameraAnimation;le&&(this._inertia.clear(),this._fireEvents({},{},!0),this._changes=[],le(this._map))},gt.prototype.mergeHandlerResult=function(n,s,o,c,_){if(o){a.extend(n,o);var w={handlerName:c,originalEvent:o.originalEvent||_};o.zoomDelta!==void 0&&(s.zoom=w),o.panDelta!==void 0&&(s.drag=w),o.pitchDelta!==void 0&&(s.pitch=w),o.bearingDelta!==void 0&&(s.rotate=w)}},gt.prototype._applyChanges=function(){for(var n={},s={},o={},c=0,_=this._changes;c<_.length;c+=1){var w=_[c],S=w[0],E=w[1],P=w[2];S.panDelta&&(n.panDelta=(n.panDelta||new a.Point(0,0))._add(S.panDelta)),S.zoomDelta&&(n.zoomDelta=(n.zoomDelta||0)+S.zoomDelta),S.bearingDelta&&(n.bearingDelta=(n.bearingDelta||0)+S.bearingDelta),S.pitchDelta&&(n.pitchDelta=(n.pitchDelta||0)+S.pitchDelta),S.around!==void 0&&(n.around=S.around),S.pinchAround!==void 0&&(n.pinchAround=S.pinchAround),S.noInertia&&(n.noInertia=S.noInertia),a.extend(s,E),a.extend(o,P)}this._updateMapTransform(n,s,o),this._changes=[]},gt.prototype._updateMapTransform=function(n,s,o){var c=this._map,_=c.transform;if(!St(n))return this._fireEvents(s,o,!0);var w=n.panDelta,S=n.zoomDelta,E=n.bearingDelta,P=n.pitchDelta,O=n.around,Z=n.pinchAround;Z!==void 0&&(O=Z),c._stop(!0),O=O||c.transform.centerPoint;var G=_.pointLocation(w?O.sub(w):O);E&&(_.bearing+=E),P&&(_.pitch+=P),S&&(_.zoom+=S),_.setLocationAtPoint(G,O),this._map._update(),n.noInertia||this._inertia.record(n),this._fireEvents(s,o,!0)},gt.prototype._fireEvents=function(n,s,o){var c=this,_=vn(this._eventsInProgress),w=vn(n),S={};for(var E in n)this._eventsInProgress[E]||(S[E+"start"]=n[E].originalEvent),this._eventsInProgress[E]=n[E];for(var P in!_&&w&&this._fireEvent("movestart",w.originalEvent),S)this._fireEvent(P,S[P]);for(var O in w&&this._fireEvent("move",w.originalEvent),n)this._fireEvent(O,n[O].originalEvent);var Z,G={};for(var H in this._eventsInProgress){var te=this._eventsInProgress[H],$=te.handlerName,ue=te.originalEvent;this._handlersById[$].isActive()||(delete this._eventsInProgress[H],G[H+"end"]=Z=s[$]||ue)}for(var Y in G)this._fireEvent(Y,G[Y]);var le=vn(this._eventsInProgress);if(o&&(_||w)&&!le){this._updatingCamera=!0;var fe=this._inertia._onMoveEnd(this._map.dragPan._inertiaOptions),_e=function(Te){return Te!==0&&-c._bearingSnap<Te&&Te<c._bearingSnap};fe?(_e(fe.bearing||this._map.getBearing())&&(fe.bearing=0),this._map.easeTo(fe,{originalEvent:Z})):(this._map.fire(new a.Event("moveend",{originalEvent:Z})),_e(this._map.getBearing())&&this._map.resetNorth()),this._updatingCamera=!1}},gt.prototype._fireEvent=function(n,s){this._map.fire(new a.Event(n,s?{originalEvent:s}:{}))},gt.prototype._requestFrame=function(){var n=this;return this._map.triggerRepaint(),this._map._renderTaskQueue.add(function(s){delete n._frameId,n.handleEvent(new xs("renderFrame",{timeStamp:s})),n._applyChanges()})},gt.prototype._triggerRenderFrame=function(){this._frameId===void 0&&(this._frameId=this._requestFrame())};var $s=function(n){function s(o,c){n.call(this),this._moving=!1,this._zooming=!1,this.transform=o,this._bearingSnap=c.bearingSnap,a.bindAll(["_renderFrameCallback"],this)}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype.getCenter=function(){return new a.LngLat(this.transform.center.lng,this.transform.center.lat)},s.prototype.setCenter=function(o,c){return this.jumpTo({center:o},c)},s.prototype.panBy=function(o,c,_){return o=a.Point.convert(o).mult(-1),this.panTo(this.transform.center,a.extend({offset:o},c),_)},s.prototype.panTo=function(o,c,_){return this.easeTo(a.extend({center:o},c),_)},s.prototype.getZoom=function(){return this.transform.zoom},s.prototype.setZoom=function(o,c){return this.jumpTo({zoom:o},c),this},s.prototype.zoomTo=function(o,c,_){return this.easeTo(a.extend({zoom:o},c),_)},s.prototype.zoomIn=function(o,c){return this.zoomTo(this.getZoom()+1,o,c),this},s.prototype.zoomOut=function(o,c){return this.zoomTo(this.getZoom()-1,o,c),this},s.prototype.getBearing=function(){return this.transform.bearing},s.prototype.setBearing=function(o,c){return this.jumpTo({bearing:o},c),this},s.prototype.getPadding=function(){return this.transform.padding},s.prototype.setPadding=function(o,c){return this.jumpTo({padding:o},c),this},s.prototype.rotateTo=function(o,c,_){return this.easeTo(a.extend({bearing:o},c),_)},s.prototype.resetNorth=function(o,c){return this.rotateTo(0,a.extend({duration:1e3},o),c),this},s.prototype.resetNorthPitch=function(o,c){return this.easeTo(a.extend({bearing:0,pitch:0,duration:1e3},o),c),this},s.prototype.snapToNorth=function(o,c){return Math.abs(this.getBearing())<this._bearingSnap?this.resetNorth(o,c):this},s.prototype.getPitch=function(){return this.transform.pitch},s.prototype.setPitch=function(o,c){return this.jumpTo({pitch:o},c),this},s.prototype.cameraForBounds=function(o,c){o=a.LngLatBounds.convert(o);var _=c&&c.bearing||0;return this._cameraForBoxAndBearing(o.getNorthWest(),o.getSouthEast(),_,c)},s.prototype._cameraForBoxAndBearing=function(o,c,_,w){var S={top:0,bottom:0,right:0,left:0};if(typeof(w=a.extend({padding:S,offset:[0,0],maxZoom:this.transform.maxZoom},w)).padding=="number"){var E=w.padding;w.padding={top:E,bottom:E,right:E,left:E}}w.padding=a.extend(S,w.padding);var P=this.transform,O=P.padding,Z=P.project(a.LngLat.convert(o)),G=P.project(a.LngLat.convert(c)),H=Z.rotate(-_*Math.PI/180),te=G.rotate(-_*Math.PI/180),$=new a.Point(Math.max(H.x,te.x),Math.max(H.y,te.y)),ue=new a.Point(Math.min(H.x,te.x),Math.min(H.y,te.y)),Y=$.sub(ue),le=(P.width-(O.left+O.right+w.padding.left+w.padding.right))/Y.x,fe=(P.height-(O.top+O.bottom+w.padding.top+w.padding.bottom))/Y.y;if(!(fe<0||le<0)){var _e=Math.min(P.scaleZoom(P.scale*Math.min(le,fe)),w.maxZoom),Te=typeof w.offset.x=="number"?new a.Point(w.offset.x,w.offset.y):a.Point.convert(w.offset),ke=new a.Point((w.padding.left-w.padding.right)/2,(w.padding.top-w.padding.bottom)/2).rotate(_*Math.PI/180),Ae=Te.add(ke).mult(P.scale/P.zoomScale(_e));return{center:P.unproject(Z.add(G).div(2).sub(Ae)),zoom:_e,bearing:_}}a.warnOnce("Map cannot fit within canvas with the given bounds, padding, and/or offset.")},s.prototype.fitBounds=function(o,c,_){return this._fitInternal(this.cameraForBounds(o,c),c,_)},s.prototype.fitScreenCoordinates=function(o,c,_,w,S){return this._fitInternal(this._cameraForBoxAndBearing(this.transform.pointLocation(a.Point.convert(o)),this.transform.pointLocation(a.Point.convert(c)),_,w),w,S)},s.prototype._fitInternal=function(o,c,_){return o?(delete(c=a.extend(o,c)).padding,c.linear?this.easeTo(c,_):this.flyTo(c,_)):this},s.prototype.jumpTo=function(o,c){this.stop();var _=this.transform,w=!1,S=!1,E=!1;return"zoom"in o&&_.zoom!==+o.zoom&&(w=!0,_.zoom=+o.zoom),o.center!==void 0&&(_.center=a.LngLat.convert(o.center)),"bearing"in o&&_.bearing!==+o.bearing&&(S=!0,_.bearing=+o.bearing),"pitch"in o&&_.pitch!==+o.pitch&&(E=!0,_.pitch=+o.pitch),o.padding==null||_.isPaddingEqual(o.padding)||(_.padding=o.padding),this.fire(new a.Event("movestart",c)).fire(new a.Event("move",c)),w&&this.fire(new a.Event("zoomstart",c)).fire(new a.Event("zoom",c)).fire(new a.Event("zoomend",c)),S&&this.fire(new a.Event("rotatestart",c)).fire(new a.Event("rotate",c)).fire(new a.Event("rotateend",c)),E&&this.fire(new a.Event("pitchstart",c)).fire(new a.Event("pitch",c)).fire(new a.Event("pitchend",c)),this.fire(new a.Event("moveend",c))},s.prototype.easeTo=function(o,c){var _=this;this._stop(!1,o.easeId),((o=a.extend({offset:[0,0],duration:500,easing:a.ease},o)).animate===!1||!o.essential&&a.browser.prefersReducedMotion)&&(o.duration=0);var w=this.transform,S=this.getZoom(),E=this.getBearing(),P=this.getPitch(),O=this.getPadding(),Z="zoom"in o?+o.zoom:S,G="bearing"in o?this._normalizeBearing(o.bearing,E):E,H="pitch"in o?+o.pitch:P,te="padding"in o?o.padding:w.padding,$=a.Point.convert(o.offset),ue=w.centerPoint.add($),Y=w.pointLocation(ue),le=a.LngLat.convert(o.center||Y);this._normalizeCenter(le);var fe,_e,Te=w.project(Y),ke=w.project(le).sub(Te),Ae=w.zoomScale(Z-S);o.around&&(fe=a.LngLat.convert(o.around),_e=w.locationPoint(fe));var Oe={moving:this._moving,zooming:this._zooming,rotating:this._rotating,pitching:this._pitching};return this._zooming=this._zooming||Z!==S,this._rotating=this._rotating||E!==G,this._pitching=this._pitching||H!==P,this._padding=!w.isPaddingEqual(te),this._easeId=o.easeId,this._prepareEase(c,o.noMoveStart,Oe),this._ease(function(He){if(_._zooming&&(w.zoom=a.number(S,Z,He)),_._rotating&&(w.bearing=a.number(E,G,He)),_._pitching&&(w.pitch=a.number(P,H,He)),_._padding&&(w.interpolatePadding(O,te,He),ue=w.centerPoint.add($)),fe)w.setLocationAtPoint(fe,_e);else{var Ge=w.zoomScale(w.zoom-S),lt=Z>S?Math.min(2,Ae):Math.max(.5,Ae),kt=Math.pow(lt,1-He),It=w.unproject(Te.add(ke.mult(He*kt)).mult(Ge));w.setLocationAtPoint(w.renderWorldCopies?It.wrap():It,ue)}_._fireMoveEvents(c)},function(He){_._afterEase(c,He)},o),this},s.prototype._prepareEase=function(o,c,_){_===void 0&&(_={}),this._moving=!0,c||_.moving||this.fire(new a.Event("movestart",o)),this._zooming&&!_.zooming&&this.fire(new a.Event("zoomstart",o)),this._rotating&&!_.rotating&&this.fire(new a.Event("rotatestart",o)),this._pitching&&!_.pitching&&this.fire(new a.Event("pitchstart",o))},s.prototype._fireMoveEvents=function(o){this.fire(new a.Event("move",o)),this._zooming&&this.fire(new a.Event("zoom",o)),this._rotating&&this.fire(new a.Event("rotate",o)),this._pitching&&this.fire(new a.Event("pitch",o))},s.prototype._afterEase=function(o,c){if(!this._easeId||!c||this._easeId!==c){delete this._easeId;var _=this._zooming,w=this._rotating,S=this._pitching;this._moving=!1,this._zooming=!1,this._rotating=!1,this._pitching=!1,this._padding=!1,_&&this.fire(new a.Event("zoomend",o)),w&&this.fire(new a.Event("rotateend",o)),S&&this.fire(new a.Event("pitchend",o)),this.fire(new a.Event("moveend",o))}},s.prototype.flyTo=function(o,c){var _=this;if(!o.essential&&a.browser.prefersReducedMotion){var w=a.pick(o,["center","zoom","bearing","pitch","around"]);return this.jumpTo(w,c)}this.stop(),o=a.extend({offset:[0,0],speed:1.2,curve:1.42,easing:a.ease},o);var S=this.transform,E=this.getZoom(),P=this.getBearing(),O=this.getPitch(),Z=this.getPadding(),G="zoom"in o?a.clamp(+o.zoom,S.minZoom,S.maxZoom):E,H="bearing"in o?this._normalizeBearing(o.bearing,P):P,te="pitch"in o?+o.pitch:O,$="padding"in o?o.padding:S.padding,ue=S.zoomScale(G-E),Y=a.Point.convert(o.offset),le=S.centerPoint.add(Y),fe=S.pointLocation(le),_e=a.LngLat.convert(o.center||fe);this._normalizeCenter(_e);var Te=S.project(fe),ke=S.project(_e).sub(Te),Ae=o.curve,Oe=Math.max(S.width,S.height),He=Oe/ue,Ge=ke.mag();if("minZoom"in o){var lt=a.clamp(Math.min(o.minZoom,E,G),S.minZoom,S.maxZoom),kt=Oe/S.zoomScale(lt-E);Ae=Math.sqrt(kt/Ge*2)}var It=Ae*Ae;function Tt(Rt){var Mt=(He*He-Oe*Oe+(Rt?-1:1)*It*It*Ge*Ge)/(2*(Rt?He:Oe)*It*Ge);return Math.log(Math.sqrt(Mt*Mt+1)-Mt)}function gr(Rt){return(Math.exp(Rt)-Math.exp(-Rt))/2}function pt(Rt){return(Math.exp(Rt)+Math.exp(-Rt))/2}var Ut=Tt(0),Yt=function(Rt){return pt(Ut)/pt(Ut+Ae*Rt)},Ot=function(Rt){return Oe*((pt(Ut)*(gr(Mt=Ut+Ae*Rt)/pt(Mt))-gr(Ut))/It)/Ge;var Mt},Bt=(Tt(1)-Ut)/Ae;if(Math.abs(Ge)<1e-6||!isFinite(Bt)){if(Math.abs(Oe-He)<1e-6)return this.easeTo(o,c);var Xt=He<Oe?-1:1;Bt=Math.abs(Math.log(He/Oe))/Ae,Ot=function(){return 0},Yt=function(Rt){return Math.exp(Xt*Ae*Rt)}}return o.duration="duration"in o?+o.duration:1e3*Bt/("screenSpeed"in o?+o.screenSpeed/Ae:+o.speed),o.maxDuration&&o.duration>o.maxDuration&&(o.duration=0),this._zooming=!0,this._rotating=P!==H,this._pitching=te!==O,this._padding=!S.isPaddingEqual($),this._prepareEase(c,!1),this._ease(function(Rt){var Mt=Rt*Bt,Fi=1/Yt(Mt);S.zoom=Rt===1?G:E+S.scaleZoom(Fi),_._rotating&&(S.bearing=a.number(P,H,Rt)),_._pitching&&(S.pitch=a.number(O,te,Rt)),_._padding&&(S.interpolatePadding(Z,$,Rt),le=S.centerPoint.add(Y));var ai=Rt===1?_e:S.unproject(Te.add(ke.mult(Ot(Mt))).mult(Fi));S.setLocationAtPoint(S.renderWorldCopies?ai.wrap():ai,le),_._fireMoveEvents(c)},function(){return _._afterEase(c)},o),this},s.prototype.isEasing=function(){return!!this._easeFrameId},s.prototype.stop=function(){return this._stop()},s.prototype._stop=function(o,c){if(this._easeFrameId&&(this._cancelRenderFrame(this._easeFrameId),delete this._easeFrameId,delete this._onEaseFrame),this._onEaseEnd){var _=this._onEaseEnd;delete this._onEaseEnd,_.call(this,c)}if(!o){var w=this.handlers;w&&w.stop(!1)}return this},s.prototype._ease=function(o,c,_){_.animate===!1||_.duration===0?(o(1),c()):(this._easeStart=a.browser.now(),this._easeOptions=_,this._onEaseFrame=o,this._onEaseEnd=c,this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback))},s.prototype._renderFrameCallback=function(){var o=Math.min((a.browser.now()-this._easeStart)/this._easeOptions.duration,1);this._onEaseFrame(this._easeOptions.easing(o)),o<1?this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback):this.stop()},s.prototype._normalizeBearing=function(o,c){o=a.wrap(o,-180,180);var _=Math.abs(o-c);return Math.abs(o-360-c)<_&&(o-=360),Math.abs(o+360-c)<_&&(o+=360),o},s.prototype._normalizeCenter=function(o){var c=this.transform;if(c.renderWorldCopies&&!c.lngRange){var _=o.lng-c.center.lng;o.lng+=_>180?-360:_<-180?360:0}},s}(a.Evented),bn=function(n){n===void 0&&(n={}),this.options=n,a.bindAll(["_toggleAttribution","_updateEditLink","_updateData","_updateCompact"],this)};bn.prototype.getDefaultPosition=function(){return"bottom-right"},bn.prototype.onAdd=function(n){var s=this.options&&this.options.compact;return this._map=n,this._container=z.create("div","mapboxgl-ctrl mapboxgl-ctrl-attrib"),this._compactButton=z.create("button","mapboxgl-ctrl-attrib-button",this._container),this._compactButton.addEventListener("click",this._toggleAttribution),this._setElementTitle(this._compactButton,"ToggleAttribution"),this._innerContainer=z.create("div","mapboxgl-ctrl-attrib-inner",this._container),this._innerContainer.setAttribute("role","list"),s&&this._container.classList.add("mapboxgl-compact"),this._updateAttributions(),this._updateEditLink(),this._map.on("styledata",this._updateData),this._map.on("sourcedata",this._updateData),this._map.on("moveend",this._updateEditLink),s===void 0&&(this._map.on("resize",this._updateCompact),this._updateCompact()),this._container},bn.prototype.onRemove=function(){z.remove(this._container),this._map.off("styledata",this._updateData),this._map.off("sourcedata",this._updateData),this._map.off("moveend",this._updateEditLink),this._map.off("resize",this._updateCompact),this._map=void 0,this._attribHTML=void 0},bn.prototype._setElementTitle=function(n,s){var o=this._map._getUIString("AttributionControl."+s);n.title=o,n.setAttribute("aria-label",o)},bn.prototype._toggleAttribution=function(){this._container.classList.contains("mapboxgl-compact-show")?(this._container.classList.remove("mapboxgl-compact-show"),this._compactButton.setAttribute("aria-pressed","false")):(this._container.classList.add("mapboxgl-compact-show"),this._compactButton.setAttribute("aria-pressed","true"))},bn.prototype._updateEditLink=function(){var n=this._editLink;n||(n=this._editLink=this._container.querySelector(".mapbox-improve-map"));var s=[{key:"owner",value:this.styleOwner},{key:"id",value:this.styleId},{key:"access_token",value:this._map._requestManager._customAccessToken||a.config.ACCESS_TOKEN}];if(n){var o=s.reduce(function(c,_,w){return _.value&&(c+=_.key+"="+_.value+(w<s.length-1?"&":"")),c},"?");n.href=a.config.FEEDBACK_URL+"/"+o+(this._map._hash?this._map._hash.getHashString(!0):""),n.rel="noopener nofollow",this._setElementTitle(n,"MapFeedback")}},bn.prototype._updateData=function(n){!n||n.sourceDataType!=="metadata"&&n.sourceDataType!=="visibility"&&n.dataType!=="style"||(this._updateAttributions(),this._updateEditLink())},bn.prototype._updateAttributions=function(){if(this._map.style){var n=[];if(this.options.customAttribution&&(Array.isArray(this.options.customAttribution)?n=n.concat(this.options.customAttribution.map(function(E){return typeof E!="string"?"":E})):typeof this.options.customAttribution=="string"&&n.push(this.options.customAttribution)),this._map.style.stylesheet){var s=this._map.style.stylesheet;this.styleOwner=s.owner,this.styleId=s.id}var o=this._map.style.sourceCaches;for(var c in o){var _=o[c];if(_.used){var w=_.getSource();w.attribution&&n.indexOf(w.attribution)<0&&n.push(w.attribution)}}n.sort(function(E,P){return E.length-P.length});var S=(n=n.filter(function(E,P){for(var O=P+1;O<n.length;O++)if(n[O].indexOf(E)>=0)return!1;return!0})).join(" | ");S!==this._attribHTML&&(this._attribHTML=S,n.length?(this._innerContainer.innerHTML=S,this._container.classList.remove("mapboxgl-attrib-empty")):this._container.classList.add("mapboxgl-attrib-empty"),this._editLink=null)}},bn.prototype._updateCompact=function(){this._map.getCanvasContainer().offsetWidth<=640?this._container.classList.add("mapboxgl-compact"):this._container.classList.remove("mapboxgl-compact","mapboxgl-compact-show")};var ya=function(){a.bindAll(["_updateLogo"],this),a.bindAll(["_updateCompact"],this)};ya.prototype.onAdd=function(n){this._map=n,this._container=z.create("div","mapboxgl-ctrl");var s=z.create("a","mapboxgl-ctrl-logo");return s.target="_blank",s.rel="noopener nofollow",s.href="https://www.mapbox.com/",s.setAttribute("aria-label",this._map._getUIString("LogoControl.Title")),s.setAttribute("rel","noopener nofollow"),this._container.appendChild(s),this._container.style.display="none",this._map.on("sourcedata",this._updateLogo),this._updateLogo(),this._map.on("resize",this._updateCompact),this._updateCompact(),this._container},ya.prototype.onRemove=function(){z.remove(this._container),this._map.off("sourcedata",this._updateLogo),this._map.off("resize",this._updateCompact)},ya.prototype.getDefaultPosition=function(){return"bottom-left"},ya.prototype._updateLogo=function(n){n&&n.sourceDataType!=="metadata"||(this._container.style.display=this._logoRequired()?"block":"none")},ya.prototype._logoRequired=function(){if(this._map.style){var n=this._map.style.sourceCaches;for(var s in n)if(n[s].getSource().mapbox_logo)return!0;return!1}},ya.prototype._updateCompact=function(){var n=this._container.children;if(n.length){var s=n[0];this._map.getCanvasContainer().offsetWidth<250?s.classList.add("mapboxgl-compact"):s.classList.remove("mapboxgl-compact")}};var an=function(){this._queue=[],this._id=0,this._cleared=!1,this._currentlyRunning=!1};an.prototype.add=function(n){var s=++this._id;return this._queue.push({callback:n,id:s,cancelled:!1}),s},an.prototype.remove=function(n){for(var s=this._currentlyRunning,o=0,c=s?this._queue.concat(s):this._queue;o<c.length;o+=1){var _=c[o];if(_.id===n)return void(_.cancelled=!0)}},an.prototype.run=function(n){n===void 0&&(n=0);var s=this._currentlyRunning=this._queue;this._queue=[];for(var o=0,c=s;o<c.length;o+=1){var _=c[o];if(!_.cancelled&&(_.callback(n),this._cleared))break}this._cleared=!1,this._currentlyRunning=!1},an.prototype.clear=function(){this._currentlyRunning&&(this._cleared=!0),this._queue=[]};var za={"AttributionControl.ToggleAttribution":"Toggle attribution","AttributionControl.MapFeedback":"Map feedback","FullscreenControl.Enter":"Enter fullscreen","FullscreenControl.Exit":"Exit fullscreen","GeolocateControl.FindMyLocation":"Find my location","GeolocateControl.LocationNotAvailable":"Location not available","LogoControl.Title":"Mapbox logo","NavigationControl.ResetBearing":"Reset bearing to north","NavigationControl.ZoomIn":"Zoom in","NavigationControl.ZoomOut":"Zoom out","ScaleControl.Feet":"ft","ScaleControl.Meters":"m","ScaleControl.Kilometers":"km","ScaleControl.Miles":"mi","ScaleControl.NauticalMiles":"nm"},iu=a.window.HTMLImageElement,el=a.window.HTMLElement,Ir=a.window.ImageBitmap,Xi={center:[0,0],zoom:0,bearing:0,pitch:0,minZoom:-2,maxZoom:22,minPitch:0,maxPitch:60,interactive:!0,scrollZoom:!0,boxZoom:!0,dragRotate:!0,dragPan:!0,keyboard:!0,doubleClickZoom:!0,touchZoomRotate:!0,touchPitch:!0,bearingSnap:7,clickTolerance:3,pitchWithRotate:!0,hash:!1,attributionControl:!0,failIfMajorPerformanceCaveat:!1,preserveDrawingBuffer:!1,trackResize:!0,renderWorldCopies:!0,refreshExpiredTiles:!0,maxTileCacheSize:null,localIdeographFontFamily:"sans-serif",transformRequest:null,accessToken:null,fadeDuration:300,crossSourceCollisions:!0},Tc=function(n){function s(c){var _=this;if((c=a.extend({},Xi,c)).minZoom!=null&&c.maxZoom!=null&&c.minZoom>c.maxZoom)throw new Error("maxZoom must be greater than or equal to minZoom");if(c.minPitch!=null&&c.maxPitch!=null&&c.minPitch>c.maxPitch)throw new Error("maxPitch must be greater than or equal to minPitch");if(c.minPitch!=null&&c.minPitch<0)throw new Error("minPitch must be greater than or equal to 0");if(c.maxPitch!=null&&c.maxPitch>60)throw new Error("maxPitch must be less than or equal to 60");var w=new fr(c.minZoom,c.maxZoom,c.minPitch,c.maxPitch,c.renderWorldCopies);if(n.call(this,w,c),this._interactive=c.interactive,this._maxTileCacheSize=c.maxTileCacheSize,this._failIfMajorPerformanceCaveat=c.failIfMajorPerformanceCaveat,this._preserveDrawingBuffer=c.preserveDrawingBuffer,this._antialias=c.antialias,this._trackResize=c.trackResize,this._bearingSnap=c.bearingSnap,this._refreshExpiredTiles=c.refreshExpiredTiles,this._fadeDuration=c.fadeDuration,this._crossSourceCollisions=c.crossSourceCollisions,this._crossFadingFactor=1,this._collectResourceTiming=c.collectResourceTiming,this._renderTaskQueue=new an,this._controls=[],this._mapId=a.uniqueId(),this._locale=a.extend({},za,c.locale),this._clickTolerance=c.clickTolerance,this._requestManager=new a.RequestManager(c.transformRequest,c.accessToken),typeof c.container=="string"){if(this._container=a.window.document.getElementById(c.container),!this._container)throw new Error("Container '"+c.container+"' not found.")}else{if(!(c.container instanceof el))throw new Error("Invalid type: 'container' must be a String or HTMLElement.");this._container=c.container}if(c.maxBounds&&this.setMaxBounds(c.maxBounds),a.bindAll(["_onWindowOnline","_onWindowResize","_onMapScroll","_contextLost","_contextRestored"],this),this._setupContainer(),this._setupPainter(),this.painter===void 0)throw new Error("Failed to initialize WebGL.");this.on("move",function(){return _._update(!1)}),this.on("moveend",function(){return _._update(!1)}),this.on("zoom",function(){return _._update(!0)}),a.window!==void 0&&(a.window.addEventListener("online",this._onWindowOnline,!1),a.window.addEventListener("resize",this._onWindowResize,!1),a.window.addEventListener("orientationchange",this._onWindowResize,!1)),this.handlers=new gt(this,c),this._hash=c.hash&&new Jn(typeof c.hash=="string"&&c.hash||void 0).addTo(this),this._hash&&this._hash._onHashChange()||(this.jumpTo({center:c.center,zoom:c.zoom,bearing:c.bearing,pitch:c.pitch}),c.bounds&&(this.resize(),this.fitBounds(c.bounds,a.extend({},c.fitBoundsOptions,{duration:0})))),this.resize(),this._localIdeographFontFamily=c.localIdeographFontFamily,c.style&&this.setStyle(c.style,{localIdeographFontFamily:c.localIdeographFontFamily}),c.attributionControl&&this.addControl(new bn({customAttribution:c.customAttribution})),this.addControl(new ya,c.logoPosition),this.on("style.load",function(){_.transform.unmodified&&_.jumpTo(_.style.stylesheet)}),this.on("data",function(S){_._update(S.dataType==="style"),_.fire(new a.Event(S.dataType+"data",S))}),this.on("dataloading",function(S){_.fire(new a.Event(S.dataType+"dataloading",S))})}n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s;var o={showTileBoundaries:{configurable:!0},showPadding:{configurable:!0},showCollisionBoxes:{configurable:!0},showOverdrawInspector:{configurable:!0},repaint:{configurable:!0},vertices:{configurable:!0},version:{configurable:!0}};return s.prototype._getMapId=function(){return this._mapId},s.prototype.addControl=function(c,_){if(_===void 0&&(_=c.getDefaultPosition?c.getDefaultPosition():"top-right"),!c||!c.onAdd)return this.fire(new a.ErrorEvent(new Error("Invalid argument to map.addControl(). Argument must be a control with onAdd and onRemove methods.")));var w=c.onAdd(this);this._controls.push(c);var S=this._controlPositions[_];return _.indexOf("bottom")!==-1?S.insertBefore(w,S.firstChild):S.appendChild(w),this},s.prototype.removeControl=function(c){if(!c||!c.onRemove)return this.fire(new a.ErrorEvent(new Error("Invalid argument to map.removeControl(). Argument must be a control with onAdd and onRemove methods.")));var _=this._controls.indexOf(c);return _>-1&&this._controls.splice(_,1),c.onRemove(this),this},s.prototype.hasControl=function(c){return this._controls.indexOf(c)>-1},s.prototype.resize=function(c){var _=this._containerDimensions(),w=_[0],S=_[1];if(w===this.transform.width&&S===this.transform.height)return this;this._resizeCanvas(w,S),this.transform.resize(w,S),this.painter.resize(w,S);var E=!this._moving;return E&&this.fire(new a.Event("movestart",c)).fire(new a.Event("move",c)),this.fire(new a.Event("resize",c)),E&&this.fire(new a.Event("moveend",c)),this},s.prototype.getBounds=function(){return this.transform.getBounds()},s.prototype.getMaxBounds=function(){return this.transform.getMaxBounds()},s.prototype.setMaxBounds=function(c){return this.transform.setMaxBounds(a.LngLatBounds.convert(c)),this._update()},s.prototype.setMinZoom=function(c){if((c=c??-2)>=-2&&c<=this.transform.maxZoom)return this.transform.minZoom=c,this._update(),this.getZoom()<c&&this.setZoom(c),this;throw new Error("minZoom must be between -2 and the current maxZoom, inclusive")},s.prototype.getMinZoom=function(){return this.transform.minZoom},s.prototype.setMaxZoom=function(c){if((c=c??22)>=this.transform.minZoom)return this.transform.maxZoom=c,this._update(),this.getZoom()>c&&this.setZoom(c),this;throw new Error("maxZoom must be greater than the current minZoom")},s.prototype.getMaxZoom=function(){return this.transform.maxZoom},s.prototype.setMinPitch=function(c){if((c=c??0)<0)throw new Error("minPitch must be greater than or equal to 0");if(c>=0&&c<=this.transform.maxPitch)return this.transform.minPitch=c,this._update(),this.getPitch()<c&&this.setPitch(c),this;throw new Error("minPitch must be between 0 and the current maxPitch, inclusive")},s.prototype.getMinPitch=function(){return this.transform.minPitch},s.prototype.setMaxPitch=function(c){if((c=c??60)>60)throw new Error("maxPitch must be less than or equal to 60");if(c>=this.transform.minPitch)return this.transform.maxPitch=c,this._update(),this.getPitch()>c&&this.setPitch(c),this;throw new Error("maxPitch must be greater than the current minPitch")},s.prototype.getMaxPitch=function(){return this.transform.maxPitch},s.prototype.getRenderWorldCopies=function(){return this.transform.renderWorldCopies},s.prototype.setRenderWorldCopies=function(c){return this.transform.renderWorldCopies=c,this._update()},s.prototype.project=function(c){return this.transform.locationPoint(a.LngLat.convert(c))},s.prototype.unproject=function(c){return this.transform.pointLocation(a.Point.convert(c))},s.prototype.isMoving=function(){return this._moving||this.handlers.isMoving()},s.prototype.isZooming=function(){return this._zooming||this.handlers.isZooming()},s.prototype.isRotating=function(){return this._rotating||this.handlers.isRotating()},s.prototype._createDelegatedListener=function(c,_,w){var S,E=this;if(c==="mouseenter"||c==="mouseover"){var P=!1;return{layer:_,listener:w,delegates:{mousemove:function(Z){var G=E.getLayer(_)?E.queryRenderedFeatures(Z.point,{layers:[_]}):[];G.length?P||(P=!0,w.call(E,new Ci(c,E,Z.originalEvent,{features:G}))):P=!1},mouseout:function(){P=!1}}}}if(c==="mouseleave"||c==="mouseout"){var O=!1;return{layer:_,listener:w,delegates:{mousemove:function(Z){(E.getLayer(_)?E.queryRenderedFeatures(Z.point,{layers:[_]}):[]).length?O=!0:O&&(O=!1,w.call(E,new Ci(c,E,Z.originalEvent)))},mouseout:function(Z){O&&(O=!1,w.call(E,new Ci(c,E,Z.originalEvent)))}}}}return{layer:_,listener:w,delegates:(S={},S[c]=function(Z){var G=E.getLayer(_)?E.queryRenderedFeatures(Z.point,{layers:[_]}):[];G.length&&(Z.features=G,w.call(E,Z),delete Z.features)},S)}},s.prototype.on=function(c,_,w){if(w===void 0)return n.prototype.on.call(this,c,_);var S=this._createDelegatedListener(c,_,w);for(var E in this._delegatedListeners=this._delegatedListeners||{},this._delegatedListeners[c]=this._delegatedListeners[c]||[],this._delegatedListeners[c].push(S),S.delegates)this.on(E,S.delegates[E]);return this},s.prototype.once=function(c,_,w){if(w===void 0)return n.prototype.once.call(this,c,_);var S=this._createDelegatedListener(c,_,w);for(var E in S.delegates)this.once(E,S.delegates[E]);return this},s.prototype.off=function(c,_,w){var S=this;return w===void 0?n.prototype.off.call(this,c,_):(this._delegatedListeners&&this._delegatedListeners[c]&&function(E){for(var P=E[c],O=0;O<P.length;O++){var Z=P[O];if(Z.layer===_&&Z.listener===w){for(var G in Z.delegates)S.off(G,Z.delegates[G]);return P.splice(O,1),S}}}(this._delegatedListeners),this)},s.prototype.queryRenderedFeatures=function(c,_){if(!this.style)return[];var w;if(_!==void 0||c===void 0||c instanceof a.Point||Array.isArray(c)||(_=c,c=void 0),_=_||{},(c=c||[[0,0],[this.transform.width,this.transform.height]])instanceof a.Point||typeof c[0]=="number")w=[a.Point.convert(c)];else{var S=a.Point.convert(c[0]),E=a.Point.convert(c[1]);w=[S,new a.Point(E.x,S.y),E,new a.Point(S.x,E.y),S]}return this.style.queryRenderedFeatures(w,_,this.transform)},s.prototype.querySourceFeatures=function(c,_){return this.style.querySourceFeatures(c,_)},s.prototype.setStyle=function(c,_){return(_=a.extend({},{localIdeographFontFamily:this._localIdeographFontFamily},_)).diff!==!1&&_.localIdeographFontFamily===this._localIdeographFontFamily&&this.style&&c?(this._diffStyle(c,_),this):(this._localIdeographFontFamily=_.localIdeographFontFamily,this._updateStyle(c,_))},s.prototype._getUIString=function(c){var _=this._locale[c];if(_==null)throw new Error("Missing UI string '"+c+"'");return _},s.prototype._updateStyle=function(c,_){return this.style&&(this.style.setEventedParent(null),this.style._remove()),c?(this.style=new Bn(this,_||{}),this.style.setEventedParent(this,{style:this.style}),typeof c=="string"?this.style.loadURL(c):this.style.loadJSON(c),this):(delete this.style,this)},s.prototype._lazyInitEmptyStyle=function(){this.style||(this.style=new Bn(this,{}),this.style.setEventedParent(this,{style:this.style}),this.style.loadEmpty())},s.prototype._diffStyle=function(c,_){var w=this;if(typeof c=="string"){var S=this._requestManager.normalizeStyleURL(c),E=this._requestManager.transformRequest(S,a.ResourceType.Style);a.getJSON(E,function(P,O){P?w.fire(new a.ErrorEvent(P)):O&&w._updateDiff(O,_)})}else typeof c=="object"&&this._updateDiff(c,_)},s.prototype._updateDiff=function(c,_){try{this.style.setState(c)&&this._update(!0)}catch(w){a.warnOnce("Unable to perform style diff: "+(w.message||w.error||w)+".  Rebuilding the style from scratch."),this._updateStyle(c,_)}},s.prototype.getStyle=function(){if(this.style)return this.style.serialize()},s.prototype.isStyleLoaded=function(){return this.style?this.style.loaded():a.warnOnce("There is no style added to the map.")},s.prototype.addSource=function(c,_){return this._lazyInitEmptyStyle(),this.style.addSource(c,_),this._update(!0)},s.prototype.isSourceLoaded=function(c){var _=this.style&&this.style.sourceCaches[c];if(_!==void 0)return _.loaded();this.fire(new a.ErrorEvent(new Error("There is no source with ID '"+c+"'")))},s.prototype.areTilesLoaded=function(){var c=this.style&&this.style.sourceCaches;for(var _ in c){var w=c[_]._tiles;for(var S in w){var E=w[S];if(E.state!=="loaded"&&E.state!=="errored")return!1}}return!0},s.prototype.addSourceType=function(c,_,w){return this._lazyInitEmptyStyle(),this.style.addSourceType(c,_,w)},s.prototype.removeSource=function(c){return this.style.removeSource(c),this._update(!0)},s.prototype.getSource=function(c){return this.style.getSource(c)},s.prototype.addImage=function(c,_,w){w===void 0&&(w={});var S=w.pixelRatio;S===void 0&&(S=1);var E=w.sdf;E===void 0&&(E=!1);var P=w.stretchX,O=w.stretchY,Z=w.content;if(this._lazyInitEmptyStyle(),_ instanceof iu||Ir&&_ instanceof Ir){var G=a.browser.getImageData(_);this.style.addImage(c,{data:new a.RGBAImage({width:G.width,height:G.height},G.data),pixelRatio:S,stretchX:P,stretchY:O,content:Z,sdf:E,version:0})}else{if(_.width===void 0||_.height===void 0)return this.fire(new a.ErrorEvent(new Error("Invalid arguments to map.addImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));var H=_;this.style.addImage(c,{data:new a.RGBAImage({width:_.width,height:_.height},new Uint8Array(_.data)),pixelRatio:S,stretchX:P,stretchY:O,content:Z,sdf:E,version:0,userImage:H}),H.onAdd&&H.onAdd(this,c)}},s.prototype.updateImage=function(c,_){var w=this.style.getImage(c);if(!w)return this.fire(new a.ErrorEvent(new Error("The map has no image with that id. If you are adding a new image use `map.addImage(...)` instead.")));var S=_ instanceof iu||Ir&&_ instanceof Ir?a.browser.getImageData(_):_,E=S.width,P=S.height,O=S.data;return E===void 0||P===void 0?this.fire(new a.ErrorEvent(new Error("Invalid arguments to map.updateImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`"))):E!==w.data.width||P!==w.data.height?this.fire(new a.ErrorEvent(new Error("The width and height of the updated image must be that same as the previous version of the image"))):(w.data.replace(O,!(_ instanceof iu||Ir&&_ instanceof Ir)),void this.style.updateImage(c,w))},s.prototype.hasImage=function(c){return c?!!this.style.getImage(c):(this.fire(new a.ErrorEvent(new Error("Missing required image id"))),!1)},s.prototype.removeImage=function(c){this.style.removeImage(c)},s.prototype.loadImage=function(c,_){a.getImage(this._requestManager.transformRequest(c,a.ResourceType.Image),_)},s.prototype.listImages=function(){return this.style.listImages()},s.prototype.addLayer=function(c,_){return this._lazyInitEmptyStyle(),this.style.addLayer(c,_),this._update(!0)},s.prototype.moveLayer=function(c,_){return this.style.moveLayer(c,_),this._update(!0)},s.prototype.removeLayer=function(c){return this.style.removeLayer(c),this._update(!0)},s.prototype.getLayer=function(c){return this.style.getLayer(c)},s.prototype.setLayerZoomRange=function(c,_,w){return this.style.setLayerZoomRange(c,_,w),this._update(!0)},s.prototype.setFilter=function(c,_,w){return w===void 0&&(w={}),this.style.setFilter(c,_,w),this._update(!0)},s.prototype.getFilter=function(c){return this.style.getFilter(c)},s.prototype.setPaintProperty=function(c,_,w,S){return S===void 0&&(S={}),this.style.setPaintProperty(c,_,w,S),this._update(!0)},s.prototype.getPaintProperty=function(c,_){return this.style.getPaintProperty(c,_)},s.prototype.setLayoutProperty=function(c,_,w,S){return S===void 0&&(S={}),this.style.setLayoutProperty(c,_,w,S),this._update(!0)},s.prototype.getLayoutProperty=function(c,_){return this.style.getLayoutProperty(c,_)},s.prototype.setLight=function(c,_){return _===void 0&&(_={}),this._lazyInitEmptyStyle(),this.style.setLight(c,_),this._update(!0)},s.prototype.getLight=function(){return this.style.getLight()},s.prototype.setFeatureState=function(c,_){return this.style.setFeatureState(c,_),this._update()},s.prototype.removeFeatureState=function(c,_){return this.style.removeFeatureState(c,_),this._update()},s.prototype.getFeatureState=function(c){return this.style.getFeatureState(c)},s.prototype.getContainer=function(){return this._container},s.prototype.getCanvasContainer=function(){return this._canvasContainer},s.prototype.getCanvas=function(){return this._canvas},s.prototype._containerDimensions=function(){var c=0,_=0;return this._container&&(c=this._container.clientWidth||400,_=this._container.clientHeight||300),[c,_]},s.prototype._detectMissingCSS=function(){a.window.getComputedStyle(this._missingCSSCanary).getPropertyValue("background-color")!=="rgb(250, 128, 114)"&&a.warnOnce("This page appears to be missing CSS declarations for Mapbox GL JS, which may cause the map to display incorrectly. Please ensure your page includes mapbox-gl.css, as described in https://www.mapbox.com/mapbox-gl-js/api/.")},s.prototype._setupContainer=function(){var c=this._container;c.classList.add("mapboxgl-map"),(this._missingCSSCanary=z.create("div","mapboxgl-canary",c)).style.visibility="hidden",this._detectMissingCSS();var _=this._canvasContainer=z.create("div","mapboxgl-canvas-container",c);this._interactive&&_.classList.add("mapboxgl-interactive"),this._canvas=z.create("canvas","mapboxgl-canvas",_),this._canvas.addEventListener("webglcontextlost",this._contextLost,!1),this._canvas.addEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.setAttribute("tabindex","0"),this._canvas.setAttribute("aria-label","Map"),this._canvas.setAttribute("role","region");var w=this._containerDimensions();this._resizeCanvas(w[0],w[1]);var S=this._controlContainer=z.create("div","mapboxgl-control-container",c),E=this._controlPositions={};["top-left","top-right","bottom-left","bottom-right"].forEach(function(P){E[P]=z.create("div","mapboxgl-ctrl-"+P,S)}),this._container.addEventListener("scroll",this._onMapScroll,!1)},s.prototype._resizeCanvas=function(c,_){var w=a.browser.devicePixelRatio||1;this._canvas.width=w*c,this._canvas.height=w*_,this._canvas.style.width=c+"px",this._canvas.style.height=_+"px"},s.prototype._setupPainter=function(){var c=a.extend({},T.webGLContextAttributes,{failIfMajorPerformanceCaveat:this._failIfMajorPerformanceCaveat,preserveDrawingBuffer:this._preserveDrawingBuffer,antialias:this._antialias||!1}),_=this._canvas.getContext("webgl",c)||this._canvas.getContext("experimental-webgl",c);_?(this.painter=new Xr(_,this.transform),a.webpSupported.testSupport(_)):this.fire(new a.ErrorEvent(new Error("Failed to initialize WebGL")))},s.prototype._contextLost=function(c){c.preventDefault(),this._frame&&(this._frame.cancel(),this._frame=null),this.fire(new a.Event("webglcontextlost",{originalEvent:c}))},s.prototype._contextRestored=function(c){this._setupPainter(),this.resize(),this._update(),this.fire(new a.Event("webglcontextrestored",{originalEvent:c}))},s.prototype._onMapScroll=function(c){if(c.target===this._container)return this._container.scrollTop=0,this._container.scrollLeft=0,!1},s.prototype.loaded=function(){return!this._styleDirty&&!this._sourcesDirty&&!!this.style&&this.style.loaded()},s.prototype._update=function(c){return this.style?(this._styleDirty=this._styleDirty||c,this._sourcesDirty=!0,this.triggerRepaint(),this):this},s.prototype._requestRenderFrame=function(c){return this._update(),this._renderTaskQueue.add(c)},s.prototype._cancelRenderFrame=function(c){this._renderTaskQueue.remove(c)},s.prototype._render=function(c){var _,w=this,S=0,E=this.painter.context.extTimerQuery;if(this.listens("gpu-timing-frame")&&(_=E.createQueryEXT(),E.beginQueryEXT(E.TIME_ELAPSED_EXT,_),S=a.browser.now()),this.painter.context.setDirty(),this.painter.setBaseState(),this._renderTaskQueue.run(c),!this._removed){var P=!1;if(this.style&&this._styleDirty){this._styleDirty=!1;var O=this.transform.zoom,Z=a.browser.now();this.style.zoomHistory.update(O,Z);var G=new a.EvaluationParameters(O,{now:Z,fadeDuration:this._fadeDuration,zoomHistory:this.style.zoomHistory,transition:this.style.getTransition()}),H=G.crossFadingFactor();H===1&&H===this._crossFadingFactor||(P=!0,this._crossFadingFactor=H),this.style.update(G)}if(this.style&&this._sourcesDirty&&(this._sourcesDirty=!1,this.style._updateSources(this.transform)),this._placementDirty=this.style&&this.style._updatePlacement(this.painter.transform,this.showCollisionBoxes,this._fadeDuration,this._crossSourceCollisions),this.painter.render(this.style,{showTileBoundaries:this.showTileBoundaries,showOverdrawInspector:this._showOverdrawInspector,rotating:this.isRotating(),zooming:this.isZooming(),moving:this.isMoving(),fadeDuration:this._fadeDuration,showPadding:this.showPadding,gpuTiming:!!this.listens("gpu-timing-layer")}),this.fire(new a.Event("render")),this.loaded()&&!this._loaded&&(this._loaded=!0,this.fire(new a.Event("load"))),this.style&&(this.style.hasTransitions()||P)&&(this._styleDirty=!0),this.style&&!this._placementDirty&&this.style._releaseSymbolFadeTiles(),this.listens("gpu-timing-frame")){var te=a.browser.now()-S;E.endQueryEXT(E.TIME_ELAPSED_EXT,_),setTimeout(function(){var Y=E.getQueryObjectEXT(_,E.QUERY_RESULT_EXT)/1e6;E.deleteQueryEXT(_),w.fire(new a.Event("gpu-timing-frame",{cpuTime:te,gpuTime:Y}))},50)}if(this.listens("gpu-timing-layer")){var $=this.painter.collectGpuTimers();setTimeout(function(){var Y=w.painter.queryGpuTimers($);w.fire(new a.Event("gpu-timing-layer",{layerTimes:Y}))},50)}var ue=this._sourcesDirty||this._styleDirty||this._placementDirty;return ue||this._repaint?this.triggerRepaint():!this.isMoving()&&this.loaded()&&this.fire(new a.Event("idle")),!this._loaded||this._fullyLoaded||ue||(this._fullyLoaded=!0),this}},s.prototype.remove=function(){this._hash&&this._hash.remove();for(var c=0,_=this._controls;c<_.length;c+=1)_[c].onRemove(this);this._controls=[],this._frame&&(this._frame.cancel(),this._frame=null),this._renderTaskQueue.clear(),this.painter.destroy(),this.handlers.destroy(),delete this.handlers,this.setStyle(null),a.window!==void 0&&(a.window.removeEventListener("resize",this._onWindowResize,!1),a.window.removeEventListener("orientationchange",this._onWindowResize,!1),a.window.removeEventListener("online",this._onWindowOnline,!1));var w=this.painter.context.gl.getExtension("WEBGL_lose_context");w&&w.loseContext(),Eo(this._canvasContainer),Eo(this._controlContainer),Eo(this._missingCSSCanary),this._container.classList.remove("mapboxgl-map"),this._removed=!0,this.fire(new a.Event("remove"))},s.prototype.triggerRepaint=function(){var c=this;this.style&&!this._frame&&(this._frame=a.browser.frame(function(_){c._frame=null,c._render(_)}))},s.prototype._onWindowOnline=function(){this._update()},s.prototype._onWindowResize=function(c){this._trackResize&&this.resize({originalEvent:c})._update()},o.showTileBoundaries.get=function(){return!!this._showTileBoundaries},o.showTileBoundaries.set=function(c){this._showTileBoundaries!==c&&(this._showTileBoundaries=c,this._update())},o.showPadding.get=function(){return!!this._showPadding},o.showPadding.set=function(c){this._showPadding!==c&&(this._showPadding=c,this._update())},o.showCollisionBoxes.get=function(){return!!this._showCollisionBoxes},o.showCollisionBoxes.set=function(c){this._showCollisionBoxes!==c&&(this._showCollisionBoxes=c,c?this.style._generateCollisionBoxes():this._update())},o.showOverdrawInspector.get=function(){return!!this._showOverdrawInspector},o.showOverdrawInspector.set=function(c){this._showOverdrawInspector!==c&&(this._showOverdrawInspector=c,this._update())},o.repaint.get=function(){return!!this._repaint},o.repaint.set=function(c){this._repaint!==c&&(this._repaint=c,this.triggerRepaint())},o.vertices.get=function(){return!!this._vertices},o.vertices.set=function(c){this._vertices=c,this._update()},s.prototype._setCacheLimits=function(c,_){a.setCacheLimits(c,_)},o.version.get=function(){return a.version},Object.defineProperties(s.prototype,o),s}($s);function Eo(n){n.parentNode&&n.parentNode.removeChild(n)}var nu={showCompass:!0,showZoom:!0,visualizePitch:!1},Da=function(n){var s=this;this.options=a.extend({},nu,n),this._container=z.create("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._container.addEventListener("contextmenu",function(o){return o.preventDefault()}),this.options.showZoom&&(a.bindAll(["_setButtonTitle","_updateZoomButtons"],this),this._zoomInButton=this._createButton("mapboxgl-ctrl-zoom-in",function(o){return s._map.zoomIn({},{originalEvent:o})}),z.create("span","mapboxgl-ctrl-icon",this._zoomInButton).setAttribute("aria-hidden",!0),this._zoomOutButton=this._createButton("mapboxgl-ctrl-zoom-out",function(o){return s._map.zoomOut({},{originalEvent:o})}),z.create("span","mapboxgl-ctrl-icon",this._zoomOutButton).setAttribute("aria-hidden",!0)),this.options.showCompass&&(a.bindAll(["_rotateCompassArrow"],this),this._compass=this._createButton("mapboxgl-ctrl-compass",function(o){s.options.visualizePitch?s._map.resetNorthPitch({},{originalEvent:o}):s._map.resetNorth({},{originalEvent:o})}),this._compassIcon=z.create("span","mapboxgl-ctrl-icon",this._compass),this._compassIcon.setAttribute("aria-hidden",!0))};Da.prototype._updateZoomButtons=function(){var n=this._map.getZoom(),s=n===this._map.getMaxZoom(),o=n===this._map.getMinZoom();this._zoomInButton.disabled=s,this._zoomOutButton.disabled=o,this._zoomInButton.setAttribute("aria-disabled",s.toString()),this._zoomOutButton.setAttribute("aria-disabled",o.toString())},Da.prototype._rotateCompassArrow=function(){var n=this.options.visualizePitch?"scale("+1/Math.pow(Math.cos(this._map.transform.pitch*(Math.PI/180)),.5)+") rotateX("+this._map.transform.pitch+"deg) rotateZ("+this._map.transform.angle*(180/Math.PI)+"deg)":"rotate("+this._map.transform.angle*(180/Math.PI)+"deg)";this._compassIcon.style.transform=n},Da.prototype.onAdd=function(n){return this._map=n,this.options.showZoom&&(this._setButtonTitle(this._zoomInButton,"ZoomIn"),this._setButtonTitle(this._zoomOutButton,"ZoomOut"),this._map.on("zoom",this._updateZoomButtons),this._updateZoomButtons()),this.options.showCompass&&(this._setButtonTitle(this._compass,"ResetBearing"),this.options.visualizePitch&&this._map.on("pitch",this._rotateCompassArrow),this._map.on("rotate",this._rotateCompassArrow),this._rotateCompassArrow(),this._handler=new Vn(this._map,this._compass,this.options.visualizePitch)),this._container},Da.prototype.onRemove=function(){z.remove(this._container),this.options.showZoom&&this._map.off("zoom",this._updateZoomButtons),this.options.showCompass&&(this.options.visualizePitch&&this._map.off("pitch",this._rotateCompassArrow),this._map.off("rotate",this._rotateCompassArrow),this._handler.off(),delete this._handler),delete this._map},Da.prototype._createButton=function(n,s){var o=z.create("button",n,this._container);return o.type="button",o.addEventListener("click",s),o},Da.prototype._setButtonTitle=function(n,s){var o=this._map._getUIString("NavigationControl."+s);n.title=o,n.setAttribute("aria-label",o)};var Vn=function(n,s,o){o===void 0&&(o=!1),this._clickTolerance=10,this.element=s,this.mouseRotate=new Ys({clickTolerance:n.dragRotate._mouseRotate._clickTolerance}),this.map=n,o&&(this.mousePitch=new eu({clickTolerance:n.dragRotate._mousePitch._clickTolerance})),a.bindAll(["mousedown","mousemove","mouseup","touchstart","touchmove","touchend","reset"],this),z.addEventListener(s,"mousedown",this.mousedown),z.addEventListener(s,"touchstart",this.touchstart,{passive:!1}),z.addEventListener(s,"touchmove",this.touchmove),z.addEventListener(s,"touchend",this.touchend),z.addEventListener(s,"touchcancel",this.reset)};function Zo(n,s,o){if(n=new a.LngLat(n.lng,n.lat),s){var c=new a.LngLat(n.lng-360,n.lat),_=new a.LngLat(n.lng+360,n.lat),w=o.locationPoint(n).distSqr(s);o.locationPoint(c).distSqr(s)<w?n=c:o.locationPoint(_).distSqr(s)<w&&(n=_)}for(;Math.abs(n.lng-o.center.lng)>180;){var S=o.locationPoint(n);if(S.x>=0&&S.y>=0&&S.x<=o.width&&S.y<=o.height)break;n.lng>o.center.lng?n.lng-=360:n.lng+=360}return n}Vn.prototype.down=function(n,s){this.mouseRotate.mousedown(n,s),this.mousePitch&&this.mousePitch.mousedown(n,s),z.disableDrag()},Vn.prototype.move=function(n,s){var o=this.map,c=this.mouseRotate.mousemoveWindow(n,s);if(c&&c.bearingDelta&&o.setBearing(o.getBearing()+c.bearingDelta),this.mousePitch){var _=this.mousePitch.mousemoveWindow(n,s);_&&_.pitchDelta&&o.setPitch(o.getPitch()+_.pitchDelta)}},Vn.prototype.off=function(){var n=this.element;z.removeEventListener(n,"mousedown",this.mousedown),z.removeEventListener(n,"touchstart",this.touchstart,{passive:!1}),z.removeEventListener(n,"touchmove",this.touchmove),z.removeEventListener(n,"touchend",this.touchend),z.removeEventListener(n,"touchcancel",this.reset),this.offTemp()},Vn.prototype.offTemp=function(){z.enableDrag(),z.removeEventListener(a.window,"mousemove",this.mousemove),z.removeEventListener(a.window,"mouseup",this.mouseup)},Vn.prototype.mousedown=function(n){this.down(a.extend({},n,{ctrlKey:!0,preventDefault:function(){return n.preventDefault()}}),z.mousePos(this.element,n)),z.addEventListener(a.window,"mousemove",this.mousemove),z.addEventListener(a.window,"mouseup",this.mouseup)},Vn.prototype.mousemove=function(n){this.move(n,z.mousePos(this.element,n))},Vn.prototype.mouseup=function(n){this.mouseRotate.mouseupWindow(n),this.mousePitch&&this.mousePitch.mouseupWindow(n),this.offTemp()},Vn.prototype.touchstart=function(n){n.targetTouches.length!==1?this.reset():(this._startPos=this._lastPos=z.touchPos(this.element,n.targetTouches)[0],this.down({type:"mousedown",button:0,ctrlKey:!0,preventDefault:function(){return n.preventDefault()}},this._startPos))},Vn.prototype.touchmove=function(n){n.targetTouches.length!==1?this.reset():(this._lastPos=z.touchPos(this.element,n.targetTouches)[0],this.move({preventDefault:function(){return n.preventDefault()}},this._lastPos))},Vn.prototype.touchend=function(n){n.targetTouches.length===0&&this._startPos&&this._lastPos&&this._startPos.dist(this._lastPos)<this._clickTolerance&&this.element.click(),this.reset()},Vn.prototype.reset=function(){this.mouseRotate.reset(),this.mousePitch&&this.mousePitch.reset(),delete this._startPos,delete this._lastPos,this.offTemp()};var Ta={center:"translate(-50%,-50%)",top:"translate(-50%,0)","top-left":"translate(0,0)","top-right":"translate(-100%,0)",bottom:"translate(-50%,-100%)","bottom-left":"translate(0,-100%)","bottom-right":"translate(-100%,-100%)",left:"translate(0,-50%)",right:"translate(-100%,-50%)"};function tl(n,s,o){var c=n.classList;for(var _ in Ta)c.remove("mapboxgl-"+o+"-anchor-"+_);c.add("mapboxgl-"+o+"-anchor-"+s)}var Go,ws=function(n){function s(o,c){if(n.call(this),(o instanceof a.window.HTMLElement||c)&&(o=a.extend({element:o},c)),a.bindAll(["_update","_onMove","_onUp","_addDragHandler","_onMapClick","_onKeyPress"],this),this._anchor=o&&o.anchor||"center",this._color=o&&o.color||"#3FB1CE",this._scale=o&&o.scale||1,this._draggable=o&&o.draggable||!1,this._clickTolerance=o&&o.clickTolerance||0,this._isDragging=!1,this._state="inactive",this._rotation=o&&o.rotation||0,this._rotationAlignment=o&&o.rotationAlignment||"auto",this._pitchAlignment=o&&o.pitchAlignment&&o.pitchAlignment!=="auto"?o.pitchAlignment:this._rotationAlignment,o&&o.element)this._element=o.element,this._offset=a.Point.convert(o&&o.offset||[0,0]);else{this._defaultMarker=!0,this._element=z.create("div"),this._element.setAttribute("aria-label","Map marker");var _=z.createNS("http://www.w3.org/2000/svg","svg");_.setAttributeNS(null,"display","block"),_.setAttributeNS(null,"height","41px"),_.setAttributeNS(null,"width","27px"),_.setAttributeNS(null,"viewBox","0 0 27 41");var w=z.createNS("http://www.w3.org/2000/svg","g");w.setAttributeNS(null,"stroke","none"),w.setAttributeNS(null,"stroke-width","1"),w.setAttributeNS(null,"fill","none"),w.setAttributeNS(null,"fill-rule","evenodd");var S=z.createNS("http://www.w3.org/2000/svg","g");S.setAttributeNS(null,"fill-rule","nonzero");var E=z.createNS("http://www.w3.org/2000/svg","g");E.setAttributeNS(null,"transform","translate(3.0, 29.0)"),E.setAttributeNS(null,"fill","#000000");for(var P=0,O=[{rx:"10.5",ry:"5.25002273"},{rx:"10.5",ry:"5.25002273"},{rx:"9.5",ry:"4.77275007"},{rx:"8.5",ry:"4.29549936"},{rx:"7.5",ry:"3.81822308"},{rx:"6.5",ry:"3.34094679"},{rx:"5.5",ry:"2.86367051"},{rx:"4.5",ry:"2.38636864"}];P<O.length;P+=1){var Z=O[P],G=z.createNS("http://www.w3.org/2000/svg","ellipse");G.setAttributeNS(null,"opacity","0.04"),G.setAttributeNS(null,"cx","10.5"),G.setAttributeNS(null,"cy","5.80029008"),G.setAttributeNS(null,"rx",Z.rx),G.setAttributeNS(null,"ry",Z.ry),E.appendChild(G)}var H=z.createNS("http://www.w3.org/2000/svg","g");H.setAttributeNS(null,"fill",this._color);var te=z.createNS("http://www.w3.org/2000/svg","path");te.setAttributeNS(null,"d","M27,13.5 C27,19.074644 20.250001,27.000002 14.75,34.500002 C14.016665,35.500004 12.983335,35.500004 12.25,34.500002 C6.7499993,27.000002 0,19.222562 0,13.5 C0,6.0441559 6.0441559,0 13.5,0 C20.955844,0 27,6.0441559 27,13.5 Z"),H.appendChild(te);var $=z.createNS("http://www.w3.org/2000/svg","g");$.setAttributeNS(null,"opacity","0.25"),$.setAttributeNS(null,"fill","#000000");var ue=z.createNS("http://www.w3.org/2000/svg","path");ue.setAttributeNS(null,"d","M13.5,0 C6.0441559,0 0,6.0441559 0,13.5 C0,19.222562 6.7499993,27 12.25,34.5 C13,35.522727 14.016664,35.500004 14.75,34.5 C20.250001,27 27,19.074644 27,13.5 C27,6.0441559 20.955844,0 13.5,0 Z M13.5,1 C20.415404,1 26,6.584596 26,13.5 C26,15.898657 24.495584,19.181431 22.220703,22.738281 C19.945823,26.295132 16.705119,30.142167 13.943359,33.908203 C13.743445,34.180814 13.612715,34.322738 13.5,34.441406 C13.387285,34.322738 13.256555,34.180814 13.056641,33.908203 C10.284481,30.127985 7.4148684,26.314159 5.015625,22.773438 C2.6163816,19.232715 1,15.953538 1,13.5 C1,6.584596 6.584596,1 13.5,1 Z"),$.appendChild(ue);var Y=z.createNS("http://www.w3.org/2000/svg","g");Y.setAttributeNS(null,"transform","translate(6.0, 7.0)"),Y.setAttributeNS(null,"fill","#FFFFFF");var le=z.createNS("http://www.w3.org/2000/svg","g");le.setAttributeNS(null,"transform","translate(8.0, 8.0)");var fe=z.createNS("http://www.w3.org/2000/svg","circle");fe.setAttributeNS(null,"fill","#000000"),fe.setAttributeNS(null,"opacity","0.25"),fe.setAttributeNS(null,"cx","5.5"),fe.setAttributeNS(null,"cy","5.5"),fe.setAttributeNS(null,"r","5.4999962");var _e=z.createNS("http://www.w3.org/2000/svg","circle");_e.setAttributeNS(null,"fill","#FFFFFF"),_e.setAttributeNS(null,"cx","5.5"),_e.setAttributeNS(null,"cy","5.5"),_e.setAttributeNS(null,"r","5.4999962"),le.appendChild(fe),le.appendChild(_e),S.appendChild(E),S.appendChild(H),S.appendChild($),S.appendChild(Y),S.appendChild(le),_.appendChild(S),_.setAttributeNS(null,"height",41*this._scale+"px"),_.setAttributeNS(null,"width",27*this._scale+"px"),this._element.appendChild(_),this._offset=a.Point.convert(o&&o.offset||[0,-14])}this._element.classList.add("mapboxgl-marker"),this._element.addEventListener("dragstart",function(Te){Te.preventDefault()}),this._element.addEventListener("mousedown",function(Te){Te.preventDefault()}),tl(this._element,this._anchor,"marker"),this._popup=null}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype.addTo=function(o){return this.remove(),this._map=o,o.getCanvasContainer().appendChild(this._element),o.on("move",this._update),o.on("moveend",this._update),this.setDraggable(this._draggable),this._update(),this._map.on("click",this._onMapClick),this},s.prototype.remove=function(){return this._map&&(this._map.off("click",this._onMapClick),this._map.off("move",this._update),this._map.off("moveend",this._update),this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler),this._map.off("mouseup",this._onUp),this._map.off("touchend",this._onUp),this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),delete this._map),z.remove(this._element),this._popup&&this._popup.remove(),this},s.prototype.getLngLat=function(){return this._lngLat},s.prototype.setLngLat=function(o){return this._lngLat=a.LngLat.convert(o),this._pos=null,this._popup&&this._popup.setLngLat(this._lngLat),this._update(),this},s.prototype.getElement=function(){return this._element},s.prototype.setPopup=function(o){if(this._popup&&(this._popup.remove(),this._popup=null,this._element.removeEventListener("keypress",this._onKeyPress),this._originalTabIndex||this._element.removeAttribute("tabindex")),o){if(!("offset"in o.options)){var c=Math.sqrt(Math.pow(13.5,2)/2);o.options.offset=this._defaultMarker?{top:[0,0],"top-left":[0,0],"top-right":[0,0],bottom:[0,-38.1],"bottom-left":[c,-1*(24.6+c)],"bottom-right":[-c,-1*(24.6+c)],left:[13.5,-24.6],right:[-13.5,-24.6]}:this._offset}this._popup=o,this._lngLat&&this._popup.setLngLat(this._lngLat),this._originalTabIndex=this._element.getAttribute("tabindex"),this._originalTabIndex||this._element.setAttribute("tabindex","0"),this._element.addEventListener("keypress",this._onKeyPress)}return this},s.prototype._onKeyPress=function(o){var c=o.code,_=o.charCode||o.keyCode;c!=="Space"&&c!=="Enter"&&_!==32&&_!==13||this.togglePopup()},s.prototype._onMapClick=function(o){var c=o.originalEvent.target,_=this._element;this._popup&&(c===_||_.contains(c))&&this.togglePopup()},s.prototype.getPopup=function(){return this._popup},s.prototype.togglePopup=function(){var o=this._popup;return o?(o.isOpen()?o.remove():o.addTo(this._map),this):this},s.prototype._update=function(o){if(this._map){this._map.transform.renderWorldCopies&&(this._lngLat=Zo(this._lngLat,this._pos,this._map.transform)),this._pos=this._map.project(this._lngLat)._add(this._offset);var c="";this._rotationAlignment==="viewport"||this._rotationAlignment==="auto"?c="rotateZ("+this._rotation+"deg)":this._rotationAlignment==="map"&&(c="rotateZ("+(this._rotation-this._map.getBearing())+"deg)");var _="";this._pitchAlignment==="viewport"||this._pitchAlignment==="auto"?_="rotateX(0deg)":this._pitchAlignment==="map"&&(_="rotateX("+this._map.getPitch()+"deg)"),o&&o.type!=="moveend"||(this._pos=this._pos.round()),z.setTransform(this._element,Ta[this._anchor]+" translate("+this._pos.x+"px, "+this._pos.y+"px) "+_+" "+c)}},s.prototype.getOffset=function(){return this._offset},s.prototype.setOffset=function(o){return this._offset=a.Point.convert(o),this._update(),this},s.prototype._onMove=function(o){if(!this._isDragging){var c=this._clickTolerance||this._map._clickTolerance;this._isDragging=o.point.dist(this._pointerdownPos)>=c}this._isDragging&&(this._pos=o.point.sub(this._positionDelta),this._lngLat=this._map.unproject(this._pos),this.setLngLat(this._lngLat),this._element.style.pointerEvents="none",this._state==="pending"&&(this._state="active",this.fire(new a.Event("dragstart"))),this.fire(new a.Event("drag")))},s.prototype._onUp=function(){this._element.style.pointerEvents="auto",this._positionDelta=null,this._pointerdownPos=null,this._isDragging=!1,this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),this._state==="active"&&this.fire(new a.Event("dragend")),this._state="inactive"},s.prototype._addDragHandler=function(o){this._element.contains(o.originalEvent.target)&&(o.preventDefault(),this._positionDelta=o.point.sub(this._pos).add(this._offset),this._pointerdownPos=o.point,this._state="pending",this._map.on("mousemove",this._onMove),this._map.on("touchmove",this._onMove),this._map.once("mouseup",this._onUp),this._map.once("touchend",this._onUp))},s.prototype.setDraggable=function(o){return this._draggable=!!o,this._map&&(o?(this._map.on("mousedown",this._addDragHandler),this._map.on("touchstart",this._addDragHandler)):(this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler))),this},s.prototype.isDraggable=function(){return this._draggable},s.prototype.setRotation=function(o){return this._rotation=o||0,this._update(),this},s.prototype.getRotation=function(){return this._rotation},s.prototype.setRotationAlignment=function(o){return this._rotationAlignment=o||"auto",this._update(),this},s.prototype.getRotationAlignment=function(){return this._rotationAlignment},s.prototype.setPitchAlignment=function(o){return this._pitchAlignment=o&&o!=="auto"?o:this._rotationAlignment,this._update(),this},s.prototype.getPitchAlignment=function(){return this._pitchAlignment},s}(a.Evented),au={positionOptions:{enableHighAccuracy:!1,maximumAge:0,timeout:6e3},fitBoundsOptions:{maxZoom:15},trackUserLocation:!1,showAccuracyCircle:!0,showUserLocation:!0},Ko=0,zo=!1,ou=function(n){function s(o){n.call(this),this.options=a.extend({},au,o),a.bindAll(["_onSuccess","_onError","_onZoom","_finish","_setupUI","_updateCamera","_updateMarker"],this)}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype.onAdd=function(o){var c;return this._map=o,this._container=z.create("div","mapboxgl-ctrl mapboxgl-ctrl-group"),c=this._setupUI,Go!==void 0?c(Go):a.window.navigator.permissions!==void 0?a.window.navigator.permissions.query({name:"geolocation"}).then(function(_){c(Go=_.state!=="denied")}):c(Go=!!a.window.navigator.geolocation),this._container},s.prototype.onRemove=function(){this._geolocationWatchID!==void 0&&(a.window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0),this.options.showUserLocation&&this._userLocationDotMarker&&this._userLocationDotMarker.remove(),this.options.showAccuracyCircle&&this._accuracyCircleMarker&&this._accuracyCircleMarker.remove(),z.remove(this._container),this._map.off("zoom",this._onZoom),this._map=void 0,Ko=0,zo=!1},s.prototype._isOutOfMapMaxBounds=function(o){var c=this._map.getMaxBounds(),_=o.coords;return c&&(_.longitude<c.getWest()||_.longitude>c.getEast()||_.latitude<c.getSouth()||_.latitude>c.getNorth())},s.prototype._setErrorState=function(){switch(this._watchState){case"WAITING_ACTIVE":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error");break;case"ACTIVE_LOCK":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting");break;case"BACKGROUND":this._watchState="BACKGROUND_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting")}},s.prototype._onSuccess=function(o){if(this._map){if(this._isOutOfMapMaxBounds(o))return this._setErrorState(),this.fire(new a.Event("outofmaxbounds",o)),this._updateMarker(),void this._finish();if(this.options.trackUserLocation)switch(this._lastKnownPosition=o,this._watchState){case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"BACKGROUND":case"BACKGROUND_ERROR":this._watchState="BACKGROUND",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background")}this.options.showUserLocation&&this._watchState!=="OFF"&&this._updateMarker(o),this.options.trackUserLocation&&this._watchState!=="ACTIVE_LOCK"||this._updateCamera(o),this.options.showUserLocation&&this._dotElement.classList.remove("mapboxgl-user-location-dot-stale"),this.fire(new a.Event("geolocate",o)),this._finish()}},s.prototype._updateCamera=function(o){var c=new a.LngLat(o.coords.longitude,o.coords.latitude),_=o.coords.accuracy,w=this._map.getBearing(),S=a.extend({bearing:w},this.options.fitBoundsOptions);this._map.fitBounds(c.toBounds(_),S,{geolocateSource:!0})},s.prototype._updateMarker=function(o){if(o){var c=new a.LngLat(o.coords.longitude,o.coords.latitude);this._accuracyCircleMarker.setLngLat(c).addTo(this._map),this._userLocationDotMarker.setLngLat(c).addTo(this._map),this._accuracy=o.coords.accuracy,this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}else this._userLocationDotMarker.remove(),this._accuracyCircleMarker.remove()},s.prototype._updateCircleRadius=function(){var o=this._map._container.clientHeight/2,c=this._map.unproject([0,o]),_=this._map.unproject([1,o]),w=c.distanceTo(_),S=Math.ceil(2*this._accuracy/w);this._circleElement.style.width=S+"px",this._circleElement.style.height=S+"px"},s.prototype._onZoom=function(){this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()},s.prototype._onError=function(o){if(this._map){if(this.options.trackUserLocation)if(o.code===1){this._watchState="OFF",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.disabled=!0;var c=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.title=c,this._geolocateButton.setAttribute("aria-label",c),this._geolocationWatchID!==void 0&&this._clearWatch()}else{if(o.code===3&&zo)return;this._setErrorState()}this._watchState!=="OFF"&&this.options.showUserLocation&&this._dotElement.classList.add("mapboxgl-user-location-dot-stale"),this.fire(new a.Event("error",o)),this._finish()}},s.prototype._finish=function(){this._timeoutId&&clearTimeout(this._timeoutId),this._timeoutId=void 0},s.prototype._setupUI=function(o){var c=this;if(this._container.addEventListener("contextmenu",function(S){return S.preventDefault()}),this._geolocateButton=z.create("button","mapboxgl-ctrl-geolocate",this._container),z.create("span","mapboxgl-ctrl-icon",this._geolocateButton).setAttribute("aria-hidden",!0),this._geolocateButton.type="button",o===!1){a.warnOnce("Geolocation support is not available so the GeolocateControl will be disabled.");var _=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.disabled=!0,this._geolocateButton.title=_,this._geolocateButton.setAttribute("aria-label",_)}else{var w=this._map._getUIString("GeolocateControl.FindMyLocation");this._geolocateButton.title=w,this._geolocateButton.setAttribute("aria-label",w)}this.options.trackUserLocation&&(this._geolocateButton.setAttribute("aria-pressed","false"),this._watchState="OFF"),this.options.showUserLocation&&(this._dotElement=z.create("div","mapboxgl-user-location-dot"),this._userLocationDotMarker=new ws(this._dotElement),this._circleElement=z.create("div","mapboxgl-user-location-accuracy-circle"),this._accuracyCircleMarker=new ws({element:this._circleElement,pitchAlignment:"map"}),this.options.trackUserLocation&&(this._watchState="OFF"),this._map.on("zoom",this._onZoom)),this._geolocateButton.addEventListener("click",this.trigger.bind(this)),this._setup=!0,this.options.trackUserLocation&&this._map.on("movestart",function(S){S.geolocateSource||c._watchState!=="ACTIVE_LOCK"||S.originalEvent&&S.originalEvent.type==="resize"||(c._watchState="BACKGROUND",c._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background"),c._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),c.fire(new a.Event("trackuserlocationend")))})},s.prototype.trigger=function(){if(!this._setup)return a.warnOnce("Geolocate control triggered before added to a map"),!1;if(this.options.trackUserLocation){switch(this._watchState){case"OFF":this._watchState="WAITING_ACTIVE",this.fire(new a.Event("trackuserlocationstart"));break;case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":case"BACKGROUND_ERROR":Ko--,zo=!1,this._watchState="OFF",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this.fire(new a.Event("trackuserlocationend"));break;case"BACKGROUND":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._lastKnownPosition&&this._updateCamera(this._lastKnownPosition),this.fire(new a.Event("trackuserlocationstart"))}switch(this._watchState){case"WAITING_ACTIVE":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"ACTIVE_LOCK":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"ACTIVE_ERROR":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error");break;case"BACKGROUND":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background");break;case"BACKGROUND_ERROR":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background-error")}if(this._watchState==="OFF"&&this._geolocationWatchID!==void 0)this._clearWatch();else if(this._geolocationWatchID===void 0){var o;this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","true"),++Ko>1?(o={maximumAge:6e5,timeout:0},zo=!0):(o=this.options.positionOptions,zo=!1),this._geolocationWatchID=a.window.navigator.geolocation.watchPosition(this._onSuccess,this._onError,o)}}else a.window.navigator.geolocation.getCurrentPosition(this._onSuccess,this._onError,this.options.positionOptions),this._timeoutId=setTimeout(this._finish,1e4);return!0},s.prototype._clearWatch=function(){a.window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0,this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","false"),this.options.showUserLocation&&this._updateMarker(null)},s}(a.Evented),Wa={maxWidth:100,unit:"metric"},Ya=function(n){this.options=a.extend({},Wa,n),a.bindAll(["_onMove","setUnit"],this)};function rl(n,s,o){var c=o&&o.maxWidth||100,_=n._container.clientHeight/2,w=n.unproject([0,_]),S=n.unproject([c,_]),E=w.distanceTo(S);if(o&&o.unit==="imperial"){var P=3.2808*E;P>5280?Ja(s,c,P/5280,n._getUIString("ScaleControl.Miles")):Ja(s,c,P,n._getUIString("ScaleControl.Feet"))}else o&&o.unit==="nautical"?Ja(s,c,E/1852,n._getUIString("ScaleControl.NauticalMiles")):E>=1e3?Ja(s,c,E/1e3,n._getUIString("ScaleControl.Kilometers")):Ja(s,c,E,n._getUIString("ScaleControl.Meters"))}function Ja(n,s,o,c){var _,w,S,E=(_=o,(w=Math.pow(10,(""+Math.floor(_)).length-1))*(S=(S=_/w)>=10?10:S>=5?5:S>=3?3:S>=2?2:S>=1?1:function(P){var O=Math.pow(10,Math.ceil(-Math.log(P)/Math.LN10));return Math.round(P*O)/O}(S)));n.style.width=s*(E/o)+"px",n.innerHTML=E+"&nbsp;"+c}Ya.prototype.getDefaultPosition=function(){return"bottom-left"},Ya.prototype._onMove=function(){rl(this._map,this._container,this.options)},Ya.prototype.onAdd=function(n){return this._map=n,this._container=z.create("div","mapboxgl-ctrl mapboxgl-ctrl-scale",n.getContainer()),this._map.on("move",this._onMove),this._onMove(),this._container},Ya.prototype.onRemove=function(){z.remove(this._container),this._map.off("move",this._onMove),this._map=void 0},Ya.prototype.setUnit=function(n){this.options.unit=n,rl(this._map,this._container,this.options)};var aa=function(n){this._fullscreen=!1,n&&n.container&&(n.container instanceof a.window.HTMLElement?this._container=n.container:a.warnOnce("Full screen control 'container' must be a DOM element.")),a.bindAll(["_onClickFullscreen","_changeIcon"],this),"onfullscreenchange"in a.window.document?this._fullscreenchange="fullscreenchange":"onmozfullscreenchange"in a.window.document?this._fullscreenchange="mozfullscreenchange":"onwebkitfullscreenchange"in a.window.document?this._fullscreenchange="webkitfullscreenchange":"onmsfullscreenchange"in a.window.document&&(this._fullscreenchange="MSFullscreenChange")};aa.prototype.onAdd=function(n){return this._map=n,this._container||(this._container=this._map.getContainer()),this._controlContainer=z.create("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._checkFullscreenSupport()?this._setupUI():(this._controlContainer.style.display="none",a.warnOnce("This device does not support fullscreen mode.")),this._controlContainer},aa.prototype.onRemove=function(){z.remove(this._controlContainer),this._map=null,a.window.document.removeEventListener(this._fullscreenchange,this._changeIcon)},aa.prototype._checkFullscreenSupport=function(){return!!(a.window.document.fullscreenEnabled||a.window.document.mozFullScreenEnabled||a.window.document.msFullscreenEnabled||a.window.document.webkitFullscreenEnabled)},aa.prototype._setupUI=function(){var n=this._fullscreenButton=z.create("button","mapboxgl-ctrl-fullscreen",this._controlContainer);z.create("span","mapboxgl-ctrl-icon",n).setAttribute("aria-hidden",!0),n.type="button",this._updateTitle(),this._fullscreenButton.addEventListener("click",this._onClickFullscreen),a.window.document.addEventListener(this._fullscreenchange,this._changeIcon)},aa.prototype._updateTitle=function(){var n=this._getTitle();this._fullscreenButton.setAttribute("aria-label",n),this._fullscreenButton.title=n},aa.prototype._getTitle=function(){return this._map._getUIString(this._isFullscreen()?"FullscreenControl.Exit":"FullscreenControl.Enter")},aa.prototype._isFullscreen=function(){return this._fullscreen},aa.prototype._changeIcon=function(){(a.window.document.fullscreenElement||a.window.document.mozFullScreenElement||a.window.document.webkitFullscreenElement||a.window.document.msFullscreenElement)===this._container!==this._fullscreen&&(this._fullscreen=!this._fullscreen,this._fullscreenButton.classList.toggle("mapboxgl-ctrl-shrink"),this._fullscreenButton.classList.toggle("mapboxgl-ctrl-fullscreen"),this._updateTitle())},aa.prototype._onClickFullscreen=function(){this._isFullscreen()?a.window.document.exitFullscreen?a.window.document.exitFullscreen():a.window.document.mozCancelFullScreen?a.window.document.mozCancelFullScreen():a.window.document.msExitFullscreen?a.window.document.msExitFullscreen():a.window.document.webkitCancelFullScreen&&a.window.document.webkitCancelFullScreen():this._container.requestFullscreen?this._container.requestFullscreen():this._container.mozRequestFullScreen?this._container.mozRequestFullScreen():this._container.msRequestFullscreen?this._container.msRequestFullscreen():this._container.webkitRequestFullscreen&&this._container.webkitRequestFullscreen()};var su={closeButton:!0,closeOnClick:!0,focusAfterOpen:!0,className:"",maxWidth:"240px"},Ss=["a[href]","[tabindex]:not([tabindex='-1'])","[contenteditable]:not([contenteditable='false'])","button:not([disabled])","input:not([disabled])","select:not([disabled])","textarea:not([disabled])"].join(", "),lu=function(n){function s(o){n.call(this),this.options=a.extend(Object.create(su),o),a.bindAll(["_update","_onClose","remove","_onMouseMove","_onMouseUp","_onDrag"],this)}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype.addTo=function(o){return this._map&&this.remove(),this._map=o,this.options.closeOnClick&&this._map.on("click",this._onClose),this.options.closeOnMove&&this._map.on("move",this._onClose),this._map.on("remove",this.remove),this._update(),this._focusFirstElement(),this._trackPointer?(this._map.on("mousemove",this._onMouseMove),this._map.on("mouseup",this._onMouseUp),this._container&&this._container.classList.add("mapboxgl-popup-track-pointer"),this._map._canvasContainer.classList.add("mapboxgl-track-pointer")):this._map.on("move",this._update),this.fire(new a.Event("open")),this},s.prototype.isOpen=function(){return!!this._map},s.prototype.remove=function(){return this._content&&z.remove(this._content),this._container&&(z.remove(this._container),delete this._container),this._map&&(this._map.off("move",this._update),this._map.off("move",this._onClose),this._map.off("click",this._onClose),this._map.off("remove",this.remove),this._map.off("mousemove",this._onMouseMove),this._map.off("mouseup",this._onMouseUp),this._map.off("drag",this._onDrag),delete this._map),this.fire(new a.Event("close")),this},s.prototype.getLngLat=function(){return this._lngLat},s.prototype.setLngLat=function(o){return this._lngLat=a.LngLat.convert(o),this._pos=null,this._trackPointer=!1,this._update(),this._map&&(this._map.on("move",this._update),this._map.off("mousemove",this._onMouseMove),this._container&&this._container.classList.remove("mapboxgl-popup-track-pointer"),this._map._canvasContainer.classList.remove("mapboxgl-track-pointer")),this},s.prototype.trackPointer=function(){return this._trackPointer=!0,this._pos=null,this._update(),this._map&&(this._map.off("move",this._update),this._map.on("mousemove",this._onMouseMove),this._map.on("drag",this._onDrag),this._container&&this._container.classList.add("mapboxgl-popup-track-pointer"),this._map._canvasContainer.classList.add("mapboxgl-track-pointer")),this},s.prototype.getElement=function(){return this._container},s.prototype.setText=function(o){return this.setDOMContent(a.window.document.createTextNode(o))},s.prototype.setHTML=function(o){var c,_=a.window.document.createDocumentFragment(),w=a.window.document.createElement("body");for(w.innerHTML=o;c=w.firstChild;)_.appendChild(c);return this.setDOMContent(_)},s.prototype.getMaxWidth=function(){return this._container&&this._container.style.maxWidth},s.prototype.setMaxWidth=function(o){return this.options.maxWidth=o,this._update(),this},s.prototype.setDOMContent=function(o){if(this._content)for(;this._content.hasChildNodes();)this._content.firstChild&&this._content.removeChild(this._content.firstChild);else this._content=z.create("div","mapboxgl-popup-content",this._container);return this._content.appendChild(o),this._createCloseButton(),this._update(),this._focusFirstElement(),this},s.prototype.addClassName=function(o){this._container&&this._container.classList.add(o)},s.prototype.removeClassName=function(o){this._container&&this._container.classList.remove(o)},s.prototype.setOffset=function(o){return this.options.offset=o,this._update(),this},s.prototype.toggleClassName=function(o){if(this._container)return this._container.classList.toggle(o)},s.prototype._createCloseButton=function(){this.options.closeButton&&(this._closeButton=z.create("button","mapboxgl-popup-close-button",this._content),this._closeButton.type="button",this._closeButton.setAttribute("aria-label","Close popup"),this._closeButton.innerHTML="&#215;",this._closeButton.addEventListener("click",this._onClose))},s.prototype._onMouseUp=function(o){this._update(o.point)},s.prototype._onMouseMove=function(o){this._update(o.point)},s.prototype._onDrag=function(o){this._update(o.point)},s.prototype._update=function(o){var c=this;if(this._map&&(this._lngLat||this._trackPointer)&&this._content&&(this._container||(this._container=z.create("div","mapboxgl-popup",this._map.getContainer()),this._tip=z.create("div","mapboxgl-popup-tip",this._container),this._container.appendChild(this._content),this.options.className&&this.options.className.split(" ").forEach(function(G){return c._container.classList.add(G)}),this._trackPointer&&this._container.classList.add("mapboxgl-popup-track-pointer")),this.options.maxWidth&&this._container.style.maxWidth!==this.options.maxWidth&&(this._container.style.maxWidth=this.options.maxWidth),this._map.transform.renderWorldCopies&&!this._trackPointer&&(this._lngLat=Zo(this._lngLat,this._pos,this._map.transform)),!this._trackPointer||o)){var _=this._pos=this._trackPointer&&o?o:this._map.project(this._lngLat),w=this.options.anchor,S=function G(H){if(H){if(typeof H=="number"){var te=Math.round(Math.sqrt(.5*Math.pow(H,2)));return{center:new a.Point(0,0),top:new a.Point(0,H),"top-left":new a.Point(te,te),"top-right":new a.Point(-te,te),bottom:new a.Point(0,-H),"bottom-left":new a.Point(te,-te),"bottom-right":new a.Point(-te,-te),left:new a.Point(H,0),right:new a.Point(-H,0)}}if(H instanceof a.Point||Array.isArray(H)){var $=a.Point.convert(H);return{center:$,top:$,"top-left":$,"top-right":$,bottom:$,"bottom-left":$,"bottom-right":$,left:$,right:$}}return{center:a.Point.convert(H.center||[0,0]),top:a.Point.convert(H.top||[0,0]),"top-left":a.Point.convert(H["top-left"]||[0,0]),"top-right":a.Point.convert(H["top-right"]||[0,0]),bottom:a.Point.convert(H.bottom||[0,0]),"bottom-left":a.Point.convert(H["bottom-left"]||[0,0]),"bottom-right":a.Point.convert(H["bottom-right"]||[0,0]),left:a.Point.convert(H.left||[0,0]),right:a.Point.convert(H.right||[0,0])}}return G(new a.Point(0,0))}(this.options.offset);if(!w){var E,P=this._container.offsetWidth,O=this._container.offsetHeight;E=_.y+S.bottom.y<O?["top"]:_.y>this._map.transform.height-O?["bottom"]:[],_.x<P/2?E.push("left"):_.x>this._map.transform.width-P/2&&E.push("right"),w=E.length===0?"bottom":E.join("-")}var Z=_.add(S[w]).round();z.setTransform(this._container,Ta[w]+" translate("+Z.x+"px,"+Z.y+"px)"),tl(this._container,w,"popup")}},s.prototype._focusFirstElement=function(){if(this.options.focusAfterOpen&&this._container){var o=this._container.querySelector(Ss);o&&o.focus()}},s.prototype._onClose=function(){this.remove()},s}(a.Evented),il={version:a.version,supported:T,setRTLTextPlugin:a.setRTLTextPlugin,getRTLTextPluginStatus:a.getRTLTextPluginStatus,Map:Tc,NavigationControl:Da,GeolocateControl:ou,AttributionControl:bn,ScaleControl:Ya,FullscreenControl:aa,Popup:lu,Marker:ws,Style:Bn,LngLat:a.LngLat,LngLatBounds:a.LngLatBounds,Point:a.Point,MercatorCoordinate:a.MercatorCoordinate,Evented:a.Evented,config:a.config,prewarm:function(){xe().acquire(ze)},clearPrewarmedResources:function(){var n=st;n&&(n.isPreloaded()&&n.numActive()===1?(n.release(ze),st=null):console.warn("Could not clear WebWorkers since there are active Map instances that still reference it. The pre-warmed WebWorker pool can only be cleared when all map instances have been removed with map.remove()"))},get accessToken(){return a.config.ACCESS_TOKEN},set accessToken(n){a.config.ACCESS_TOKEN=n},get baseApiUrl(){return a.config.API_URL},set baseApiUrl(n){a.config.API_URL=n},get workerCount(){return Re.workerCount},set workerCount(n){Re.workerCount=n},get maxParallelImageRequests(){return a.config.MAX_PARALLEL_IMAGE_REQUESTS},set maxParallelImageRequests(n){a.config.MAX_PARALLEL_IMAGE_REQUESTS=n},clearStorage:function(n){a.clearTileCache(n)},workerUrl:""};return il}),y})})(hy);var bh=hy.exports;const K_=g_(bh);function Ed(u){let h;const d=u[15].default,p=Ou(d,u,u[14],null);return{c(){p&&p.c()},l(y){p&&p.l(y)},m(y,v){p&&p.m(y,v),h=!0},p(y,v){p&&p.p&&(!h||v&16384)&&Fu(p,d,y,y[14],h?Uu(d,y[14],v,null):Nu(y[14]),null)},i(y){h||(Qe(p,y),h=!0)},o(y){ot(p,y),h=!1},d(y){p&&p.d(y)}}}function H_(u){let h,d,p,y=u[0]&&Ed(u);return{c(){h=qe("div"),y&&y.c(),this.h()},l(v){h=je(v,"DIV",{class:!0,id:!0});var a=Ne(h);y&&y.l(a),a.forEach(ae),this.h()},h(){oe(h,"class","absolute top-0 bg-grey4 w-full h-full svelte-a65d1y"),oe(h,"id",u[1]),Gu(()=>u[16].call(h))},m(v,a){Be(v,h,a),y&&y.m(h,null),d=Ku(h,u[16].bind(h)),u[17](h),p=!0},p(v,[a]){v[0]?y?(y.p(v,a),a&1&&Qe(y,1)):(y=Ed(v),y.c(),Qe(y,1),y.m(h,null)):y&&(En(),ot(y,1,1,()=>{y=null}),zn()),(!p||a&2)&&oe(h,"id",v[1])},i(v){p||(Qe(y),p=!0)},o(v){ot(y),p=!1},d(v){v&&ae(h),y&&y.d(),d(),u[17](null)}}}function X_(u,h,d){let{$$slots:p={},$$scope:y}=h,{map:v}=h,{id:a="map"}=h,{location:T={bounds:[[-8.1775,54.02275],[-5.43279,55.31298]]}}=h,{style:z="https://raw.githubusercontent.com/nisra-explore/map_tiles/main/basemap_styles/style-omt.json"}=h,{interactive:M=!0}=h,{minzoom:F=0}=h,{maxzoom:D=14}=h,{zoom:L=null}=h,{scrollzoom:X=!0}=h,{geolocate:ne=!0}=h,{zoomcontrol:ce=!0}=h,{options:ve={}}=h,de,we;ay("map",{getMap:()=>v}),T.bounds?ve={...ve,bounds:T.bounds}:T.lon&&T.lat&&(ve={...ve,center:[T.lon,T.lat]},T.zoom&&(ve.zoom=T.zoom)),oy(()=>{const Ye=document.createElement("link");return Ye.rel="stylesheet",Ye.href="https://unpkg.com/mapbox-gl@1.13.0/dist/mapbox-gl.css",Ye.onload=()=>{d(0,v=new bh.Map({container:de,style:z,minZoom:F,maxZoom:D,maxBounds:[[-9.2,53.58],[-4.53,55.72]],interactive:M,...ve})),ce&&v.addControl(new bh.NavigationControl({showCompass:!1})),X||v.scrollZoom.disable(),ne&&v.addControl(new bh.GeolocateControl),v.on("load",()=>{d(4,L=v.getZoom())}),v.on("zoom",()=>{d(4,L=v.getZoom())})},document.head.appendChild(Ye),()=>{v.remove(),Ye.parentNode.removeChild(Ye)}});function Ke(){let Ye=document.getElementsByClassName("mapboxgl-canvas");Ye[0]&&(Ye[0].style.width="100%",v.resize())}function ut(){we=this.clientWidth,d(2,we)}function Me(Ye){Vu[Ye?"unshift":"push"](()=>{de=Ye,d(3,de)})}return u.$$set=Ye=>{"map"in Ye&&d(0,v=Ye.map),"id"in Ye&&d(1,a=Ye.id),"location"in Ye&&d(6,T=Ye.location),"style"in Ye&&d(7,z=Ye.style),"interactive"in Ye&&d(8,M=Ye.interactive),"minzoom"in Ye&&d(9,F=Ye.minzoom),"maxzoom"in Ye&&d(10,D=Ye.maxzoom),"zoom"in Ye&&d(4,L=Ye.zoom),"scrollzoom"in Ye&&d(11,X=Ye.scrollzoom),"geolocate"in Ye&&d(12,ne=Ye.geolocate),"zoomcontrol"in Ye&&d(13,ce=Ye.zoomcontrol),"options"in Ye&&d(5,ve=Ye.options),"$$scope"in Ye&&d(14,y=Ye.$$scope)},u.$$.update=()=>{u.$$.dirty&4&&we&&Ke()},[v,a,we,de,L,ve,T,z,M,F,D,X,ne,ce,y,p,ut,Me]}class W_ extends fn{constructor(h){super(),dn(this,h,X_,H_,mn,{map:0,id:1,location:6,style:7,interactive:8,minzoom:9,maxzoom:10,zoom:4,scrollzoom:11,geolocate:12,zoomcontrol:13,options:5})}}function zd(u){let h;const d=u[11].default,p=Ou(d,u,u[10],null);return{c(){p&&p.c()},l(y){p&&p.l(y)},m(y,v){p&&p.m(y,v),h=!0},p(y,v){p&&p.p&&(!h||v&1024)&&Fu(p,d,y,y[10],h?Uu(d,y[10],v,null):Nu(y[10]),null)},i(y){h||(Qe(p,y),h=!0)},o(y){ot(p,y),h=!1},d(y){p&&p.d(y)}}}function Y_(u){let h,d,p=u[0]&&zd(u);return{c(){p&&p.c(),h=sr()},l(y){p&&p.l(y),h=sr()},m(y,v){p&&p.m(y,v),Be(y,h,v),d=!0},p(y,[v]){y[0]?p?(p.p(y,v),v&1&&Qe(p,1)):(p=zd(y),p.c(),Qe(p,1),p.m(h.parentNode,h)):p&&(En(),ot(p,1,1,()=>{p=null}),zn())},i(y){d||(Qe(p),d=!0)},o(y){ot(p),d=!1},d(y){p&&p.d(y),y&&ae(h)}}}function J_(u,h,d){let{$$slots:p={},$$scope:y}=h,{id:v}=h,{type:a}=h,{url:T=null}=h,{props:z={}}=h,{data:M=null}=h,{layer:F=null}=h,{promoteId:D=null}=h,{minzoom:L=null}=h,{maxzoom:X=null}=h,ne=!1;const{getMap:ce}=Hu("map"),ve=ce();ve.getSource(v)&&ve.removeSource(v);function de(){ve.isSourceLoaded(v)?(d(0,ne=!0),console.log(v+" loaded!")):setTimeout(()=>{console.log("..."),de()},500)}function we(){ve.isStyleLoaded(v)?(Ke(),document.querySelector("#map canvas")&&document.querySelector("#map canvas").tabIndex=="0"&&(document.querySelector("#map canvas").tabIndex="-1")):setTimeout(()=>{console.log("..."),we()},500)}L&&(z.minzoom=L),X&&(z.maxzoom=X),F&&D?(z.promoteId={},z.promoteId[F]=D):D&&(z.promoteId=D);function Ke(){console.log(v+" map source loading..."),a=="geojson"?M?(ve.addSource(v,{type:a,data:M,...z}),de()):T&&(ve.addSource(v,{type:a,data:T,...z}),de()):a=="vector"&&(ve.addSource(v,{type:a,tiles:[T],...z}),de())}we();function ut(){ve.getSource(v).setData(M)}return u.$$set=Me=>{"id"in Me&&d(2,v=Me.id),"type"in Me&&d(3,a=Me.type),"url"in Me&&d(4,T=Me.url),"props"in Me&&d(1,z=Me.props),"data"in Me&&d(5,M=Me.data),"layer"in Me&&d(6,F=Me.layer),"promoteId"in Me&&d(7,D=Me.promoteId),"minzoom"in Me&&d(8,L=Me.minzoom),"maxzoom"in Me&&d(9,X=Me.maxzoom),"$$scope"in Me&&d(10,y=Me.$$scope)},u.$$.update=()=>{u.$$.dirty&33&&ne&&M&&ut()},[ne,z,v,a,T,M,F,D,L,X,y,p]}class Q_ extends fn{constructor(h){super(),dn(this,h,J_,Y_,mn,{id:2,type:3,url:4,props:1,data:5,layer:6,promoteId:7,minzoom:8,maxzoom:9})}}function $_(u,h,d){const{Popup:p}=K_,y=u_(),v=new p({closeButton:!1,closeOnClick:!1});let{id:a}=h,{source:T}=h,{sourceLayer:z=null}=h,{type:M}=h,{filter:F=null}=h,{layout:D={}}=h,{paint:L={}}=h,{data:X=null}=h,{code:ne=null}=h,{name:ce="name"}=h,{colorCode:ve=null}=h,{click:de=!1}=h,{ignoreClick:we=!1}=h,{clickCenter:Ke=!1}=h,{selected:ut=null}=h,{hover:Me=!1}=h,{hovered:Ye=null}=h,{highlight:vt=!1}=h,{highlightKey:Ue="highlighted"}=h,{highlighted:ct=[]}=h,{order:mt=null}=h,{maxzoom:Ze=null}=h,{minzoom:Ft=null}=h,{isChild:yt=!1}=h;const{getMap:Ct}=Hu("map"),Le=Ct();let Pt=null,At=null,Jt=[];Le.getLayer(a)&&Le.removeLayer(a);let Nt={id:a,type:M,source:T,paint:L,layout:D};F&&(Nt.filter=F),z&&(Nt["source-layer"]=z),Ze&&(Nt.maxzoom=Ze),Ft&&(Nt.minzoom=Ft),Le.addLayer(Nt,mt);function ht(){console.log("updating colors..."),X.forEach(De=>{Le.setFeatureState({source:T,sourceLayer:z,id:De[ne]},{color:De[ve]})})}return de&&Le.on("click",a,De=>{if(De.features.length>0&&!we){let Lt=De.features[0].id;if(yt&&ct.includes(Lt)||!yt&&ut!=Lt){if(d(0,ut=Lt),y("select",{code:ut}),Pt&&Le.setFeatureState({source:T,sourceLayer:z,id:Pt},{selected:!1}),Le.setFeatureState({source:T,sourceLayer:z,id:ut},{selected:!0}),Ke){let Cr=centroid(De.features[0].toJSON().geometry);Le.flyTo({center:Cr.geometry.coordinates})}d(24,Pt=ut)}}}),Me&&(Le.on("mousemove",a,De=>{if(De.features.length>0){let Lt=De.features[0].id;Ye&&Le.setFeatureState({source:T,sourceLayer:z,id:Ye},{hovered:!1}),yt&&ct.includes(Lt)||!yt&&ut!=Lt?(d(1,Ye=d(25,At=Lt)),Le.setFeatureState({source:T,sourceLayer:z,id:Ye},{hovered:!0}),Le.getCanvas().style.cursor="pointer",v.setLngLat(De.lngLat).setHTML(`<strong>${De.features[0].properties[ce]?De.features[0].properties[ce]:De.features[0].properties[ne]}</strong>`).addTo(Le)):v.remove()}}),Le.on("mouseleave",a,De=>{Ye&&Le.setFeatureState({source:T,sourceLayer:z,id:Ye},{hovered:!1}),d(1,Ye=d(25,At=null)),Le.getCanvas().style.cursor="",v.remove()})),u.$$set=De=>{"id"in De&&d(2,a=De.id),"source"in De&&d(3,T=De.source),"sourceLayer"in De&&d(4,z=De.sourceLayer),"type"in De&&d(5,M=De.type),"filter"in De&&d(6,F=De.filter),"layout"in De&&d(7,D=De.layout),"paint"in De&&d(8,L=De.paint),"data"in De&&d(9,X=De.data),"code"in De&&d(10,ne=De.code),"name"in De&&d(11,ce=De.name),"colorCode"in De&&d(12,ve=De.colorCode),"click"in De&&d(13,de=De.click),"ignoreClick"in De&&d(14,we=De.ignoreClick),"clickCenter"in De&&d(15,Ke=De.clickCenter),"selected"in De&&d(0,ut=De.selected),"hover"in De&&d(16,Me=De.hover),"hovered"in De&&d(1,Ye=De.hovered),"highlight"in De&&d(17,vt=De.highlight),"highlightKey"in De&&d(18,Ue=De.highlightKey),"highlighted"in De&&d(19,ct=De.highlighted),"order"in De&&d(20,mt=De.order),"maxzoom"in De&&d(21,Ze=De.maxzoom),"minzoom"in De&&d(22,Ft=De.minzoom),"isChild"in De&&d(23,yt=De.isChild)},u.$$.update=()=>{u.$$.dirty[0]&4096&&ve&&ht(),u.$$.dirty[0]&68026392&&vt&&ct!=Jt&&(Jt[0]&&Jt.forEach(De=>{let Lt={};Lt[Ue]=!1,Le.setFeatureState({source:T,sourceLayer:z,id:De},Lt)}),d(26,Jt=ct),ct[0]&&ct.forEach(De=>{let Lt={};Lt[Ue]=!0,Le.setFeatureState({source:T,sourceLayer:z,id:De},Lt)})),u.$$.dirty[0]&16777241&&ut!=Pt&&(Pt&&Le.setFeatureState({source:T,sourceLayer:z,id:Pt},{selected:!1}),ut&&Le.setFeatureState({source:T,sourceLayer:z,id:ut},{selected:!0}),d(24,Pt=ut)),u.$$.dirty[0]&33619994&&Me&&Ye!=At&&(At&&Le.setFeatureState({source:T,sourceLayer:z,id:At},{hovered:!1}),Ye&&Le.setFeatureState({source:T,sourceLayer:z,id:Ye},{hovered:!0}),d(25,At=Ye))},[ut,Ye,a,T,z,M,F,D,L,X,ne,ce,ve,de,we,Ke,Me,vt,Ue,ct,mt,Ze,Ft,yt,Pt,At,Jt]}class Ap extends fn{constructor(h){super(),dn(this,h,$_,null,mn,{id:2,source:3,sourceLayer:4,type:5,filter:6,layout:7,paint:8,data:9,code:10,name:11,colorCode:12,click:13,ignoreClick:14,clickCenter:15,selected:0,hover:16,hovered:1,highlight:17,highlightKey:18,highlighted:19,order:20,maxzoom:21,minzoom:22,isChild:23},null,[-1,-1])}}function ev(u){return u===0?!0:u}function rs(u){return ev(u)?Array.isArray(u)?h=>u.map(d=>typeof d!="function"?h[d]:d(h)):typeof u!="function"?h=>h[u]:u:null}function tv(u){const h={};for(const d of u){if(Object(d)!==d)throw new TypeError("iterable for fromEntries should yield objects");const{"0":p,"1":y}=d;Object.defineProperty(h,p,{configurable:!0,enumerable:!0,writable:!0,value:y})}return h}function Pp(u,h={}){return tv(Object.entries(u).filter(([d,p])=>p!==void 0&&h[d]===void 0))}function rv(u,h){if(!Array.isArray(u))throw new TypeError(`The first argument of calcExtents() must be an array. You passed in a ${typeof u}. Consider passing a flat array to the \`flatData\` prop. More info: https://layercake.graphics/guide/#flatdata`);if(Array.isArray(h)||h===void 0||h===null)throw new TypeError("The second argument of calcExtents() must be an object with field names as keys as accessor functions as values.");const d={},p=Object.keys(h),y=p.length;let v,a,T,z,M,F,D,L;const X=u.length;for(v=0;v<y;v+=1){for(z=p[v],D=h[z],M=null,F=null,a=0;a<X;a+=1)if(L=D(u[a]),Array.isArray(L)){const ne=L.length;for(T=0;T<ne;T+=1)L[T]!==void 0&&L[T]!==null&&Number.isNaN(L[T])===!1&&((M===null||L[T]<M)&&(M=L[T]),(F===null||L[T]>F)&&(F=L[T]))}else L!=null&&Number.isNaN(L)===!1&&((M===null||L<M)&&(M=L),(F===null||L>F)&&(F=L));d[z]=[M,F]}return d}function py(u=[],h){return Array.isArray(h)===!0?h.map((d,p)=>d===null?u[p]:d):u}function sh(u){return function([d,p]){return d?py(d[u],p):p}}function xh(u,h){return u==null||h==null?NaN:u<h?-1:u>h?1:u>=h?0:NaN}function iv(u,h){return u==null||h==null?NaN:h<u?-1:h>u?1:h>=u?0:NaN}function fy(u){let h,d,p;u.length!==2?(h=xh,d=(T,z)=>xh(u(T),z),p=(T,z)=>u(T)-z):(h=u===xh||u===iv?u:nv,d=u,p=u);function y(T,z,M=0,F=T.length){if(M<F){if(h(z,z)!==0)return F;do{const D=M+F>>>1;d(T[D],z)<0?M=D+1:F=D}while(M<F)}return M}function v(T,z,M=0,F=T.length){if(M<F){if(h(z,z)!==0)return F;do{const D=M+F>>>1;d(T[D],z)<=0?M=D+1:F=D}while(M<F)}return M}function a(T,z,M=0,F=T.length){const D=y(T,z,M,F-1);return D>M&&p(T[D-1],z)>-p(T[D],z)?D-1:D}return{left:y,center:a,right:v}}function nv(){return 0}function av(u){return u===null?NaN:+u}const ov=fy(xh),sv=ov.right;fy(av).center;const lv=sv;class Td extends Map{constructor(h,d=hv){if(super(),Object.defineProperties(this,{_intern:{value:new Map},_key:{value:d}}),h!=null)for(const[p,y]of h)this.set(p,y)}get(h){return super.get(Id(this,h))}has(h){return super.has(Id(this,h))}set(h,d){return super.set(uv(this,h),d)}delete(h){return super.delete(cv(this,h))}}function Id({_intern:u,_key:h},d){const p=h(d);return u.has(p)?u.get(p):d}function uv({_intern:u,_key:h},d){const p=h(d);return u.has(p)?u.get(p):(u.set(p,d),d)}function cv({_intern:u,_key:h},d){const p=h(d);return u.has(p)&&(d=u.get(p),u.delete(p)),d}function hv(u){return u!==null&&typeof u=="object"?u.valueOf():u}var Lp=Math.sqrt(50),Rp=Math.sqrt(10),Bp=Math.sqrt(2);function pv(u,h,d){var p,y=-1,v,a,T;if(h=+h,u=+u,d=+d,u===h&&d>0)return[u];if((p=h<u)&&(v=u,u=h,h=v),(T=dy(u,h,d))===0||!isFinite(T))return[];if(T>0){let z=Math.round(u/T),M=Math.round(h/T);for(z*T<u&&++z,M*T>h&&--M,a=new Array(v=M-z+1);++y<v;)a[y]=(z+y)*T}else{T=-T;let z=Math.round(u*T),M=Math.round(h*T);for(z/T<u&&++z,M/T>h&&--M,a=new Array(v=M-z+1);++y<v;)a[y]=(z+y)/T}return p&&a.reverse(),a}function dy(u,h,d){var p=(h-u)/Math.max(0,d),y=Math.floor(Math.log(p)/Math.LN10),v=p/Math.pow(10,y);return y>=0?(v>=Lp?10:v>=Rp?5:v>=Bp?2:1)*Math.pow(10,y):-Math.pow(10,-y)/(v>=Lp?10:v>=Rp?5:v>=Bp?2:1)}function fv(u,h,d){var p=Math.abs(h-u)/Math.max(0,d),y=Math.pow(10,Math.floor(Math.log(p)/Math.LN10)),v=p/y;return v>=Lp?y*=10:v>=Rp?y*=5:v>=Bp&&(y*=2),h<u?-y:y}function dv(u,h,d){u=+u,h=+h,d=(y=arguments.length)<2?(h=u,u=0,1):y<3?1:+d;for(var p=-1,y=Math.max(0,Math.ceil((h-u)/d))|0,v=new Array(y);++p<y;)v[p]=u+p*d;return v}function Dh(u,h){switch(arguments.length){case 0:break;case 1:this.range(u);break;default:this.range(h).domain(u);break}return this}const Ad=Symbol("implicit");function my(){var u=new Td,h=[],d=[],p=Ad;function y(v){let a=u.get(v);if(a===void 0){if(p!==Ad)return p;u.set(v,a=h.push(v)-1)}return d[a%d.length]}return y.domain=function(v){if(!arguments.length)return h.slice();h=[],u=new Td;for(const a of v)u.has(a)||u.set(a,h.push(a)-1);return y},y.range=function(v){return arguments.length?(d=Array.from(v),y):d.slice()},y.unknown=function(v){return arguments.length?(p=v,y):p},y.copy=function(){return my(h,d).unknown(p)},Dh.apply(y,arguments),y}function yy(){var u=my().unknown(void 0),h=u.domain,d=u.range,p=0,y=1,v,a,T=!1,z=0,M=0,F=.5;delete u.unknown;function D(){var L=h().length,X=y<p,ne=X?y:p,ce=X?p:y;v=(ce-ne)/Math.max(1,L-z+M*2),T&&(v=Math.floor(v)),ne+=(ce-ne-v*(L-z))*F,a=v*(1-z),T&&(ne=Math.round(ne),a=Math.round(a));var ve=dv(L).map(function(de){return ne+v*de});return d(X?ve.reverse():ve)}return u.domain=function(L){return arguments.length?(h(L),D()):h()},u.range=function(L){return arguments.length?([p,y]=L,p=+p,y=+y,D()):[p,y]},u.rangeRound=function(L){return[p,y]=L,p=+p,y=+y,T=!0,D()},u.bandwidth=function(){return a},u.step=function(){return v},u.round=function(L){return arguments.length?(T=!!L,D()):T},u.padding=function(L){return arguments.length?(z=Math.min(1,M=+L),D()):z},u.paddingInner=function(L){return arguments.length?(z=Math.min(1,L),D()):z},u.paddingOuter=function(L){return arguments.length?(M=+L,D()):M},u.align=function(L){return arguments.length?(F=Math.max(0,Math.min(1,L)),D()):F},u.copy=function(){return yy(h(),[p,y]).round(T).paddingInner(z).paddingOuter(M).align(F)},Dh.apply(D(),arguments)}function Gp(u,h,d){u.prototype=h.prototype=d,d.constructor=u}function gy(u,h){var d=Object.create(u.prototype);for(var p in h)d[p]=h[p];return d}function tc(){}var qu=.7,kh=1/qu,Ll="\\s*([+-]?\\d+)\\s*",ju="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",lo="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",mv=/^#([0-9a-f]{3,8})$/,yv=new RegExp(`^rgb\\(${Ll},${Ll},${Ll}\\)$`),gv=new RegExp(`^rgb\\(${lo},${lo},${lo}\\)$`),_v=new RegExp(`^rgba\\(${Ll},${Ll},${Ll},${ju}\\)$`),vv=new RegExp(`^rgba\\(${lo},${lo},${lo},${ju}\\)$`),bv=new RegExp(`^hsl\\(${ju},${lo},${lo}\\)$`),xv=new RegExp(`^hsla\\(${ju},${lo},${lo},${ju}\\)$`),Pd={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};Gp(tc,Zu,{copy(u){return Object.assign(new this.constructor,this,u)},displayable(){return this.rgb().displayable()},hex:Cd,formatHex:Cd,formatHex8:wv,formatHsl:Sv,formatRgb:Md,toString:Md});function Cd(){return this.rgb().formatHex()}function wv(){return this.rgb().formatHex8()}function Sv(){return _y(this).formatHsl()}function Md(){return this.rgb().formatRgb()}function Zu(u){var h,d;return u=(u+"").trim().toLowerCase(),(h=mv.exec(u))?(d=h[1].length,h=parseInt(h[1],16),d===6?Dd(h):d===3?new ca(h>>8&15|h>>4&240,h>>4&15|h&240,(h&15)<<4|h&15,1):d===8?lh(h>>24&255,h>>16&255,h>>8&255,(h&255)/255):d===4?lh(h>>12&15|h>>8&240,h>>8&15|h>>4&240,h>>4&15|h&240,((h&15)<<4|h&15)/255):null):(h=yv.exec(u))?new ca(h[1],h[2],h[3],1):(h=gv.exec(u))?new ca(h[1]*255/100,h[2]*255/100,h[3]*255/100,1):(h=_v.exec(u))?lh(h[1],h[2],h[3],h[4]):(h=vv.exec(u))?lh(h[1]*255/100,h[2]*255/100,h[3]*255/100,h[4]):(h=bv.exec(u))?Bd(h[1],h[2]/100,h[3]/100,1):(h=xv.exec(u))?Bd(h[1],h[2]/100,h[3]/100,h[4]):Pd.hasOwnProperty(u)?Dd(Pd[u]):u==="transparent"?new ca(NaN,NaN,NaN,0):null}function Dd(u){return new ca(u>>16&255,u>>8&255,u&255,1)}function lh(u,h,d,p){return p<=0&&(u=h=d=NaN),new ca(u,h,d,p)}function kv(u){return u instanceof tc||(u=Zu(u)),u?(u=u.rgb(),new ca(u.r,u.g,u.b,u.opacity)):new ca}function Op(u,h,d,p){return arguments.length===1?kv(u):new ca(u,h,d,p??1)}function ca(u,h,d,p){this.r=+u,this.g=+h,this.b=+d,this.opacity=+p}Gp(ca,Op,gy(tc,{brighter(u){return u=u==null?kh:Math.pow(kh,u),new ca(this.r*u,this.g*u,this.b*u,this.opacity)},darker(u){return u=u==null?qu:Math.pow(qu,u),new ca(this.r*u,this.g*u,this.b*u,this.opacity)},rgb(){return this},clamp(){return new ca(Bs(this.r),Bs(this.g),Bs(this.b),Eh(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:Ld,formatHex:Ld,formatHex8:Ev,formatRgb:Rd,toString:Rd}));function Ld(){return`#${Rs(this.r)}${Rs(this.g)}${Rs(this.b)}`}function Ev(){return`#${Rs(this.r)}${Rs(this.g)}${Rs(this.b)}${Rs((isNaN(this.opacity)?1:this.opacity)*255)}`}function Rd(){const u=Eh(this.opacity);return`${u===1?"rgb(":"rgba("}${Bs(this.r)}, ${Bs(this.g)}, ${Bs(this.b)}${u===1?")":`, ${u})`}`}function Eh(u){return isNaN(u)?1:Math.max(0,Math.min(1,u))}function Bs(u){return Math.max(0,Math.min(255,Math.round(u)||0))}function Rs(u){return u=Bs(u),(u<16?"0":"")+u.toString(16)}function Bd(u,h,d,p){return p<=0?u=h=d=NaN:d<=0||d>=1?u=h=NaN:h<=0&&(u=NaN),new Fa(u,h,d,p)}function _y(u){if(u instanceof Fa)return new Fa(u.h,u.s,u.l,u.opacity);if(u instanceof tc||(u=Zu(u)),!u)return new Fa;if(u instanceof Fa)return u;u=u.rgb();var h=u.r/255,d=u.g/255,p=u.b/255,y=Math.min(h,d,p),v=Math.max(h,d,p),a=NaN,T=v-y,z=(v+y)/2;return T?(h===v?a=(d-p)/T+(d<p)*6:d===v?a=(p-h)/T+2:a=(h-d)/T+4,T/=z<.5?v+y:2-v-y,a*=60):T=z>0&&z<1?0:a,new Fa(a,T,z,u.opacity)}function zv(u,h,d,p){return arguments.length===1?_y(u):new Fa(u,h,d,p??1)}function Fa(u,h,d,p){this.h=+u,this.s=+h,this.l=+d,this.opacity=+p}Gp(Fa,zv,gy(tc,{brighter(u){return u=u==null?kh:Math.pow(kh,u),new Fa(this.h,this.s,this.l*u,this.opacity)},darker(u){return u=u==null?qu:Math.pow(qu,u),new Fa(this.h,this.s,this.l*u,this.opacity)},rgb(){var u=this.h%360+(this.h<0)*360,h=isNaN(u)||isNaN(this.s)?0:this.s,d=this.l,p=d+(d<.5?d:1-d)*h,y=2*d-p;return new ca(Cp(u>=240?u-240:u+120,y,p),Cp(u,y,p),Cp(u<120?u+240:u-120,y,p),this.opacity)},clamp(){return new Fa(Od(this.h),uh(this.s),uh(this.l),Eh(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){const u=Eh(this.opacity);return`${u===1?"hsl(":"hsla("}${Od(this.h)}, ${uh(this.s)*100}%, ${uh(this.l)*100}%${u===1?")":`, ${u})`}`}}));function Od(u){return u=(u||0)%360,u<0?u+360:u}function uh(u){return Math.max(0,Math.min(1,u||0))}function Cp(u,h,d){return(u<60?h+(d-h)*u/60:u<180?d:u<240?h+(d-h)*(240-u)/60:h)*255}const Kp=u=>()=>u;function Tv(u,h){return function(d){return u+d*h}}function Iv(u,h,d){return u=Math.pow(u,d),h=Math.pow(h,d)-u,d=1/d,function(p){return Math.pow(u+p*h,d)}}function Av(u){return(u=+u)==1?vy:function(h,d){return d-h?Iv(h,d,u):Kp(isNaN(h)?d:h)}}function vy(u,h){var d=h-u;return d?Tv(u,d):Kp(isNaN(u)?h:u)}const Fd=function u(h){var d=Av(h);function p(y,v){var a=d((y=Op(y)).r,(v=Op(v)).r),T=d(y.g,v.g),z=d(y.b,v.b),M=vy(y.opacity,v.opacity);return function(F){return y.r=a(F),y.g=T(F),y.b=z(F),y.opacity=M(F),y+""}}return p.gamma=u,p}(1);function Pv(u,h){h||(h=[]);var d=u?Math.min(h.length,u.length):0,p=h.slice(),y;return function(v){for(y=0;y<d;++y)p[y]=u[y]*(1-v)+h[y]*v;return p}}function Cv(u){return ArrayBuffer.isView(u)&&!(u instanceof DataView)}function Mv(u,h){var d=h?h.length:0,p=u?Math.min(d,u.length):0,y=new Array(p),v=new Array(d),a;for(a=0;a<p;++a)y[a]=Hp(u[a],h[a]);for(;a<d;++a)v[a]=h[a];return function(T){for(a=0;a<p;++a)v[a]=y[a](T);return v}}function Dv(u,h){var d=new Date;return u=+u,h=+h,function(p){return d.setTime(u*(1-p)+h*p),d}}function zh(u,h){return u=+u,h=+h,function(d){return u*(1-d)+h*d}}function Lv(u,h){var d={},p={},y;(u===null||typeof u!="object")&&(u={}),(h===null||typeof h!="object")&&(h={});for(y in h)y in u?d[y]=Hp(u[y],h[y]):p[y]=h[y];return function(v){for(y in d)p[y]=d[y](v);return p}}var Fp=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,Mp=new RegExp(Fp.source,"g");function Rv(u){return function(){return u}}function Bv(u){return function(h){return u(h)+""}}function Ov(u,h){var d=Fp.lastIndex=Mp.lastIndex=0,p,y,v,a=-1,T=[],z=[];for(u=u+"",h=h+"";(p=Fp.exec(u))&&(y=Mp.exec(h));)(v=y.index)>d&&(v=h.slice(d,v),T[a]?T[a]+=v:T[++a]=v),(p=p[0])===(y=y[0])?T[a]?T[a]+=y:T[++a]=y:(T[++a]=null,z.push({i:a,x:zh(p,y)})),d=Mp.lastIndex;return d<h.length&&(v=h.slice(d),T[a]?T[a]+=v:T[++a]=v),T.length<2?z[0]?Bv(z[0].x):Rv(h):(h=z.length,function(M){for(var F=0,D;F<h;++F)T[(D=z[F]).i]=D.x(M);return T.join("")})}function Hp(u,h){var d=typeof h,p;return h==null||d==="boolean"?Kp(h):(d==="number"?zh:d==="string"?(p=Zu(h))?(h=p,Fd):Ov:h instanceof Zu?Fd:h instanceof Date?Dv:Cv(h)?Pv:Array.isArray(h)?Mv:typeof h.valueOf!="function"&&typeof h.toString!="function"||isNaN(h)?Lv:zh)(u,h)}function Fv(u,h){return u=+u,h=+h,function(d){return Math.round(u*(1-d)+h*d)}}function Nv(u){return function(){return u}}function Uv(u){return+u}var Nd=[0,1];function so(u){return u}function Np(u,h){return(h-=u=+u)?function(d){return(d-u)/h}:Nv(isNaN(h)?NaN:.5)}function Vv(u,h){var d;return u>h&&(d=u,u=h,h=d),function(p){return Math.max(u,Math.min(h,p))}}function qv(u,h,d){var p=u[0],y=u[1],v=h[0],a=h[1];return y<p?(p=Np(y,p),v=d(a,v)):(p=Np(p,y),v=d(v,a)),function(T){return v(p(T))}}function jv(u,h,d){var p=Math.min(u.length,h.length)-1,y=new Array(p),v=new Array(p),a=-1;for(u[p]<u[0]&&(u=u.slice().reverse(),h=h.slice().reverse());++a<p;)y[a]=Np(u[a],u[a+1]),v[a]=d(h[a],h[a+1]);return function(T){var z=lv(u,T,1,p)-1;return v[z](y[z](T))}}function by(u,h){return h.domain(u.domain()).range(u.range()).interpolate(u.interpolate()).clamp(u.clamp()).unknown(u.unknown())}function xy(){var u=Nd,h=Nd,d=Hp,p,y,v,a=so,T,z,M;function F(){var L=Math.min(u.length,h.length);return a!==so&&(a=Vv(u[0],u[L-1])),T=L>2?jv:qv,z=M=null,D}function D(L){return L==null||isNaN(L=+L)?v:(z||(z=T(u.map(p),h,d)))(p(a(L)))}return D.invert=function(L){return a(y((M||(M=T(h,u.map(p),zh)))(L)))},D.domain=function(L){return arguments.length?(u=Array.from(L,Uv),F()):u.slice()},D.range=function(L){return arguments.length?(h=Array.from(L),F()):h.slice()},D.rangeRound=function(L){return h=Array.from(L),d=Fv,F()},D.clamp=function(L){return arguments.length?(a=L?!0:so,F()):a!==so},D.interpolate=function(L){return arguments.length?(d=L,F()):d},D.unknown=function(L){return arguments.length?(v=L,D):v},function(L,X){return p=L,y=X,F()}}function Zv(){return xy()(so,so)}function Gv(u){return Math.abs(u=Math.round(u))>=1e21?u.toLocaleString("en").replace(/,/g,""):u.toString(10)}function Th(u,h){if((d=(u=h?u.toExponential(h-1):u.toExponential()).indexOf("e"))<0)return null;var d,p=u.slice(0,d);return[p.length>1?p[0]+p.slice(2):p,+u.slice(d+1)]}function Rl(u){return u=Th(Math.abs(u)),u?u[1]:NaN}function Kv(u,h){return function(d,p){for(var y=d.length,v=[],a=0,T=u[0],z=0;y>0&&T>0&&(z+T+1>p&&(T=Math.max(1,p-z)),v.push(d.substring(y-=T,y+T)),!((z+=T+1)>p));)T=u[a=(a+1)%u.length];return v.reverse().join(h)}}function Hv(u){return function(h){return h.replace(/[0-9]/g,function(d){return u[+d]})}}var Xv=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function Ih(u){if(!(h=Xv.exec(u)))throw new Error("invalid format: "+u);var h;return new Xp({fill:h[1],align:h[2],sign:h[3],symbol:h[4],zero:h[5],width:h[6],comma:h[7],precision:h[8]&&h[8].slice(1),trim:h[9],type:h[10]})}Ih.prototype=Xp.prototype;function Xp(u){this.fill=u.fill===void 0?" ":u.fill+"",this.align=u.align===void 0?">":u.align+"",this.sign=u.sign===void 0?"-":u.sign+"",this.symbol=u.symbol===void 0?"":u.symbol+"",this.zero=!!u.zero,this.width=u.width===void 0?void 0:+u.width,this.comma=!!u.comma,this.precision=u.precision===void 0?void 0:+u.precision,this.trim=!!u.trim,this.type=u.type===void 0?"":u.type+""}Xp.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(this.width===void 0?"":Math.max(1,this.width|0))+(this.comma?",":"")+(this.precision===void 0?"":"."+Math.max(0,this.precision|0))+(this.trim?"~":"")+this.type};function Wv(u){e:for(var h=u.length,d=1,p=-1,y;d<h;++d)switch(u[d]){case".":p=y=d;break;case"0":p===0&&(p=d),y=d;break;default:if(!+u[d])break e;p>0&&(p=0);break}return p>0?u.slice(0,p)+u.slice(y+1):u}var wy;function Yv(u,h){var d=Th(u,h);if(!d)return u+"";var p=d[0],y=d[1],v=y-(wy=Math.max(-8,Math.min(8,Math.floor(y/3)))*3)+1,a=p.length;return v===a?p:v>a?p+new Array(v-a+1).join("0"):v>0?p.slice(0,v)+"."+p.slice(v):"0."+new Array(1-v).join("0")+Th(u,Math.max(0,h+v-1))[0]}function Ud(u,h){var d=Th(u,h);if(!d)return u+"";var p=d[0],y=d[1];return y<0?"0."+new Array(-y).join("0")+p:p.length>y+1?p.slice(0,y+1)+"."+p.slice(y+1):p+new Array(y-p.length+2).join("0")}const Vd={"%":(u,h)=>(u*100).toFixed(h),b:u=>Math.round(u).toString(2),c:u=>u+"",d:Gv,e:(u,h)=>u.toExponential(h),f:(u,h)=>u.toFixed(h),g:(u,h)=>u.toPrecision(h),o:u=>Math.round(u).toString(8),p:(u,h)=>Ud(u*100,h),r:Ud,s:Yv,X:u=>Math.round(u).toString(16).toUpperCase(),x:u=>Math.round(u).toString(16)};function qd(u){return u}var jd=Array.prototype.map,Zd=["y","z","a","f","p","n","","m","","k","M","G","T","P","E","Z","Y"];function Jv(u){var h=u.grouping===void 0||u.thousands===void 0?qd:Kv(jd.call(u.grouping,Number),u.thousands+""),d=u.currency===void 0?"":u.currency[0]+"",p=u.currency===void 0?"":u.currency[1]+"",y=u.decimal===void 0?".":u.decimal+"",v=u.numerals===void 0?qd:Hv(jd.call(u.numerals,String)),a=u.percent===void 0?"%":u.percent+"",T=u.minus===void 0?"":u.minus+"",z=u.nan===void 0?"NaN":u.nan+"";function M(D){D=Ih(D);var L=D.fill,X=D.align,ne=D.sign,ce=D.symbol,ve=D.zero,de=D.width,we=D.comma,Ke=D.precision,ut=D.trim,Me=D.type;Me==="n"?(we=!0,Me="g"):Vd[Me]||(Ke===void 0&&(Ke=12),ut=!0,Me="g"),(ve||L==="0"&&X==="=")&&(ve=!0,L="0",X="=");var Ye=ce==="$"?d:ce==="#"&&/[boxX]/.test(Me)?"0"+Me.toLowerCase():"",vt=ce==="$"?p:/[%p]/.test(Me)?a:"",Ue=Vd[Me],ct=/[defgprs%]/.test(Me);Ke=Ke===void 0?6:/[gprs]/.test(Me)?Math.max(1,Math.min(21,Ke)):Math.max(0,Math.min(20,Ke));function mt(Ze){var Ft=Ye,yt=vt,Ct,Le,Pt;if(Me==="c")yt=Ue(Ze)+yt,Ze="";else{Ze=+Ze;var At=Ze<0||1/Ze<0;if(Ze=isNaN(Ze)?z:Ue(Math.abs(Ze),Ke),ut&&(Ze=Wv(Ze)),At&&+Ze==0&&ne!=="+"&&(At=!1),Ft=(At?ne==="("?ne:T:ne==="-"||ne==="("?"":ne)+Ft,yt=(Me==="s"?Zd[8+wy/3]:"")+yt+(At&&ne==="("?")":""),ct){for(Ct=-1,Le=Ze.length;++Ct<Le;)if(Pt=Ze.charCodeAt(Ct),48>Pt||Pt>57){yt=(Pt===46?y+Ze.slice(Ct+1):Ze.slice(Ct))+yt,Ze=Ze.slice(0,Ct);break}}}we&&!ve&&(Ze=h(Ze,1/0));var Jt=Ft.length+Ze.length+yt.length,Nt=Jt<de?new Array(de-Jt+1).join(L):"";switch(we&&ve&&(Ze=h(Nt+Ze,Nt.length?de-yt.length:1/0),Nt=""),X){case"<":Ze=Ft+Ze+yt+Nt;break;case"=":Ze=Ft+Nt+Ze+yt;break;case"^":Ze=Nt.slice(0,Jt=Nt.length>>1)+Ft+Ze+yt+Nt.slice(Jt);break;default:Ze=Nt+Ft+Ze+yt;break}return v(Ze)}return mt.toString=function(){return D+""},mt}function F(D,L){var X=M((D=Ih(D),D.type="f",D)),ne=Math.max(-8,Math.min(8,Math.floor(Rl(L)/3)))*3,ce=Math.pow(10,-ne),ve=Zd[8+ne/3];return function(de){return X(ce*de)+ve}}return{format:M,formatPrefix:F}}var ch,Sy,ky;Qv({thousands:",",grouping:[3],currency:["$",""]});function Qv(u){return ch=Jv(u),Sy=ch.format,ky=ch.formatPrefix,ch}function $v(u){return Math.max(0,-Rl(Math.abs(u)))}function e0(u,h){return Math.max(0,Math.max(-8,Math.min(8,Math.floor(Rl(h)/3)))*3-Rl(Math.abs(u)))}function t0(u,h){return u=Math.abs(u),h=Math.abs(h)-u,Math.max(0,Rl(h)-Rl(u))+1}function r0(u,h,d,p){var y=fv(u,h,d),v;switch(p=Ih(p??",f"),p.type){case"s":{var a=Math.max(Math.abs(u),Math.abs(h));return p.precision==null&&!isNaN(v=e0(y,a))&&(p.precision=v),ky(p,a)}case"":case"e":case"g":case"p":case"r":{p.precision==null&&!isNaN(v=t0(y,Math.max(Math.abs(u),Math.abs(h))))&&(p.precision=v-(p.type==="e"));break}case"f":case"%":{p.precision==null&&!isNaN(v=$v(y))&&(p.precision=v-(p.type==="%")*2);break}}return Sy(p)}function Ey(u){var h=u.domain;return u.ticks=function(d){var p=h();return pv(p[0],p[p.length-1],d??10)},u.tickFormat=function(d,p){var y=h();return r0(y[0],y[y.length-1],d??10,p)},u.nice=function(d){d==null&&(d=10);var p=h(),y=0,v=p.length-1,a=p[y],T=p[v],z,M,F=10;for(T<a&&(M=a,a=T,T=M,M=y,y=v,v=M);F-- >0;){if(M=dy(a,T,d),M===z)return p[y]=a,p[v]=T,h(p);if(M>0)a=Math.floor(a/M)*M,T=Math.ceil(T/M)*M;else if(M<0)a=Math.ceil(a*M)/M,T=Math.floor(T*M)/M;else break;z=M}return u},u}function wh(){var u=Zv();return u.copy=function(){return by(u,wh())},Dh.apply(u,arguments),Ey(u)}function Gd(u){return function(h){return h<0?-Math.pow(-h,u):Math.pow(h,u)}}function i0(u){return u<0?-Math.sqrt(-u):Math.sqrt(u)}function n0(u){return u<0?-u*u:u*u}function a0(u){var h=u(so,so),d=1;function p(){return d===1?u(so,so):d===.5?u(i0,n0):u(Gd(d),Gd(1/d))}return h.exponent=function(y){return arguments.length?(d=+y,p()):d},Ey(h)}function zy(){var u=a0(xy());return u.copy=function(){return by(u,zy()).exponent(u.exponent())},Dh.apply(u,arguments),u}function o0(){return zy.apply(null,arguments).exponent(.5)}const Ru={x:wh,y:wh,z:wh,r:o0};function s0(u){return u.constant?"symlog":u.base?"log":u.exponent?u.exponent()===.5?"sqrt":"pow":"other"}function Kd(u){return u}function l0(u){return h=>Math.log(u*h)}function u0(u){return h=>u*Math.exp(h)}function c0(u){return h=>Math.sign(h)*Math.log1p(Math.abs(h/u))}function h0(u){return h=>Math.sign(h)*Math.expm1(Math.abs(h))*u}function hh(u){return function(d){return d<0?-Math.pow(-d,u):Math.pow(d,u)}}function p0(u){const h=s0(u);if(h==="log"){const d=Math.sign(u.domain()[0]);return{lift:l0(d),ground:u0(d),scaleType:h}}return h==="pow"?{lift:hh(1),ground:hh(1/1),scaleType:h}:h==="sqrt"?{lift:hh(.5),ground:hh(1/.5),scaleType:h}:h==="symlog"?{lift:c0(1),ground:h0(1),scaleType:h}:{lift:Kd,ground:Kd,scaleType:h}}function f0(u,h){if(typeof u.range!="function")throw new Error("Scale method `range` must be a function");if(typeof u.domain!="function")throw new Error("Scale method `domain` must be a function");if(!Array.isArray(h))return u.domain();u.domain().length!==2&&console.warn("[LayerCake] The scale is expected to have a domain of length 2 to use padding. Are you sure you want to use padding? Your scale's domain is:",u.domain()),u.range().length!==2&&console.warn("[LayerCake] The scale is expected to have a range of length 2 to use padding. Are you sure you want to use padding? Your scale's range is:",u.range());const{lift:d,ground:p}=p0(u),y=u.domain()[0],v=Object.prototype.toString.call(y)==="[object Date]",[a,T]=u.domain().map(X=>d(v?X.getTime():X)),[z,M]=u.range(),F=h[0]||0,D=h[1]||0,L=(T-a)/(Math.abs(M-z)-F-D);return[a-F*L,D*L+T].map(X=>p(v?new Date(X):X))}function d0(u,h,d,p,y){let v,a;return y===!0?(v=0,a=100):(v=u==="r"?1:0,a=u==="y"?d:u==="r"?25:h),p===!0?[a,v]:[v,a]}function m0(u,h,d,p,y,v){return y?typeof y=="function"?y({width:h,height:d}):y:d0(u,h,d,p,v)}function ph(u){return function([d,p,y,v,a,T,z,M,F,D]){if(p===null)return null;const L=m0(u,z,M,T,F,D),X=d===Ru[u]?d():d.copy();return X.domain(py(p[u],y)).range(L),v&&X.domain(f0(X,v)),a===!0&&(typeof X.nice=="function"?X.nice():console.error(`[Layer Cake] You set \`${u}Nice: true\` but the ${u}Scale does not have a \`.nice\` method. Ignoring...`)),X}}function fh([u,h]){return d=>{const p=u(d);return Array.isArray(p)?p.map(y=>h(y)):h(p)}}function dh([u]){if(typeof u=="function"){if(typeof u.range=="function")return u.range();console.error("[LayerCake] Your scale doesn't have a `.range` method?")}return null}const mh={x:!1,y:!0,z:!1,r:!1};const y0=u=>({element:u[0]&4,width:u[0]&256,height:u[0]&512,aspectRatio:u[0]&1024,containerWidth:u[0]&128,containerHeight:u[0]&64}),Hd=u=>({element:u[2],width:u[8],height:u[9],aspectRatio:u[10],containerWidth:u[7],containerHeight:u[6]});function Xd(u){let h,d,p;const y=u[90].default,v=Ou(y,u,u[89],Hd);return{c(){h=qe("div"),v&&v.c(),this.h()},l(a){h=je(a,"DIV",{class:!0});var T=Ne(h);v&&v.l(T),T.forEach(ae),this.h()},h(){oe(h,"class","layercake-container svelte-vhzpsp"),Gu(()=>u[92].call(h)),Xe(h,"position",u[5]),Xe(h,"top",u[5]==="absolute"?"0":null),Xe(h,"right",u[5]==="absolute"?"0":null),Xe(h,"bottom",u[5]==="absolute"?"0":null),Xe(h,"left",u[5]==="absolute"?"0":null),Xe(h,"pointer-events",u[4]===!1?"none":null)},m(a,T){Be(a,h,T),v&&v.m(h,null),u[91](h),d=Ku(h,u[92].bind(h)),p=!0},p(a,T){v&&v.p&&(!p||T[0]&1988|T[2]&134217728)&&Fu(v,y,a,a[89],p?Uu(y,a[89],T,y0):Nu(a[89]),Hd),T[0]&32&&Xe(h,"position",a[5]),T[0]&32&&Xe(h,"top",a[5]==="absolute"?"0":null),T[0]&32&&Xe(h,"right",a[5]==="absolute"?"0":null),T[0]&32&&Xe(h,"bottom",a[5]==="absolute"?"0":null),T[0]&32&&Xe(h,"left",a[5]==="absolute"?"0":null),T[0]&16&&Xe(h,"pointer-events",a[4]===!1?"none":null)},i(a){p||(Qe(v,a),p=!0)},o(a){ot(v,a),p=!1},d(a){a&&ae(h),v&&v.d(a),u[91](null),d()}}}function g0(u){let h,d,p=(u[3]===!0||typeof window<"u")&&Xd(u);return{c(){p&&p.c(),h=sr()},l(y){p&&p.l(y),h=sr()},m(y,v){p&&p.m(y,v),Be(y,h,v),d=!0},p(y,v){y[3]===!0||typeof window<"u"?p?(p.p(y,v),v[0]&8&&Qe(p,1)):(p=Xd(y),p.c(),Qe(p,1),p.m(h.parentNode,h)):p&&(En(),ot(p,1,1,()=>{p=null}),zn())},i(y){d||(Qe(p),d=!0)},o(y){ot(p),d=!1},d(y){p&&p.d(y),y&&ae(h)}}}function _0(u,h,d){let p,y,v,a,T,z,M,F,D,L,X,ne,ce,ve,de,we,Ke,ut,Me,Ye,vt,Ue,ct,mt,Ze,Ft,yt,Ct,Le,Pt,At,Jt,Nt,ht,De,Lt,Cr,_i,er,Mr,Sr,{$$slots:en={},$$scope:Wt}=h,{ssr:ui=!1}=h,{pointerEvents:Hn=!0}=h,{position:tn="relative"}=h,{percentRange:jt=!1}=h,{width:yn=void 0}=h,{height:Qr=void 0}=h,{containerWidth:vi=yn||100}=h,{containerHeight:Tn=Qr||100}=h,{element:Er=void 0}=h,{x:zi=void 0}=h,{y:ci=void 0}=h,{z:hi=void 0}=h,{r:sn=void 0}=h,{data:qr=[]}=h,{xDomain:pi=void 0}=h,{yDomain:fi=void 0}=h,{zDomain:bi=void 0}=h,{rDomain:Bi=void 0}=h,{xNice:Xn=!1}=h,{yNice:qi=!1}=h,{zNice:ji=!1}=h,{rNice:jr=!1}=h,{xReverse:ta=mh.x}=h,{yReverse:gn=mh.y}=h,{zReverse:xi=mh.z}=h,{rReverse:Mn=mh.r}=h,{xPadding:Wn=void 0}=h,{yPadding:Hr=void 0}=h,{zPadding:ra=void 0}=h,{rPadding:Dn=void 0}=h,{xScale:ti=Ru.x}=h,{yScale:re=Ru.y}=h,{zScale:dt=Ru.z}=h,{rScale:Zi=Ru.r}=h,{xRange:ri=void 0}=h,{yRange:dr=void 0}=h,{zRange:R=void 0}=h,{rRange:N=void 0}=h,{padding:V={}}=h,{extents:K={}}=h,{flatData:W=void 0}=h,{custom:se={}}=h,pe=!1;oy(()=>{pe=!0});const q={},ee=Tr(jt);Kt(u,ee,ge=>d(128,_i=ge));const ye=Tr(vi);Kt(u,ye,ge=>d(7,Cr=ge));const Pe=Tr(Tn);Kt(u,Pe,ge=>d(6,Lt=ge));const Fe=Tr(Pp(K));Kt(u,Fe,ge=>d(127,De=ge));const ze=Tr(qr);Kt(u,ze,ge=>d(126,ht=ge));const Re=Tr(W||qr);Kt(u,Re,ge=>d(125,Nt=ge));const st=Tr(V);Kt(u,st,ge=>d(124,Jt=ge));const it=Tr(rs(zi));Kt(u,it,ge=>d(123,At=ge));const xe=Tr(rs(ci));Kt(u,xe,ge=>d(122,Pt=ge));const tt=Tr(rs(hi));Kt(u,tt,ge=>d(121,Le=ge));const We=Tr(rs(sn));Kt(u,We,ge=>d(120,Ct=ge));const $e=Tr(pi);Kt(u,$e,ge=>d(119,yt=ge));const Zt=Tr(fi);Kt(u,Zt,ge=>d(118,Ft=ge));const rt=Tr(bi);Kt(u,rt,ge=>d(117,Ze=ge));const tr=Tr(Bi);Kt(u,tr,ge=>d(116,mt=ge));const br=Tr(Xn);Kt(u,br,ge=>d(115,ct=ge));const Ht=Tr(qi);Kt(u,Ht,ge=>d(114,Ue=ge));const hr=Tr(ji);Kt(u,hr,ge=>d(113,vt=ge));const rr=Tr(jr);Kt(u,rr,ge=>d(112,Ye=ge));const wi=Tr(ta);Kt(u,wi,ge=>d(111,Me=ge));const mr=Tr(gn);Kt(u,mr,ge=>d(110,ut=ge));const Fr=Tr(xi);Kt(u,Fr,ge=>d(109,Ke=ge));const vr=Tr(Mn);Kt(u,vr,ge=>d(108,we=ge));const Qt=Tr(Wn);Kt(u,Qt,ge=>d(107,de=ge));const pr=Tr(Hr);Kt(u,pr,ge=>d(106,ve=ge));const Ti=Tr(ra);Kt(u,Ti,ge=>d(105,ce=ge));const ha=Tr(Dn);Kt(u,ha,ge=>d(104,ne=ge));const ii=Tr(ri);Kt(u,ii,ge=>d(103,X=ge));const Oi=Tr(dr);Kt(u,Oi,ge=>d(102,L=ge));const Na=Tr(R);Kt(u,Na,ge=>d(101,D=ge));const va=Tr(N);Kt(u,va,ge=>d(100,F=ge));const Zr=Tr(ti);Kt(u,Zr,ge=>d(99,M=ge));const ba=Tr(re);Kt(u,ba,ge=>d(98,z=ge));const Ii=Tr(dt);Kt(u,Ii,ge=>d(97,T=ge));const ni=Tr(Zi);Kt(u,ni,ge=>d(96,a=ge));const ln=Tr(q);Kt(u,ln,ge=>d(94,y=ge));const Dr=Tr(se);Kt(u,Dr,ge=>d(95,v=ge));const Ln=Ri([it,xe,tt,We],([ge,un,Hi,Gr])=>{const ka={};return ge&&(ka.x=ge),un&&(ka.y=un),Hi&&(ka.z=Hi),Gr&&(ka.r=Gr),ka}),_n=Ri([st,ye,Pe],([ge])=>Object.assign({top:0,right:0,bottom:0,left:0},ge)),as=Ri([ye,Pe,_n],([ge,un,Hi])=>{const Gr={};return Gr.top=Hi.top,Gr.right=ge-Hi.right,Gr.bottom=un-Hi.bottom,Gr.left=Hi.left,Gr.width=Gr.right-Gr.left,Gr.height=Gr.bottom-Gr.top,Gr.width<=0&&pe===!0&&console.warn("[LayerCake] Target div has zero or negative width. Did you forget to set an explicit width in CSS on the container?"),Gr.height<=0&&pe===!0&&console.warn("[LayerCake] Target div has zero or negative height. Did you forget to set an explicit height in CSS on the container?"),Gr}),Ai=Ri([as],([ge])=>ge.width);Kt(u,Ai,ge=>d(8,er=ge));const xa=Ri([as],([ge])=>ge.height);Kt(u,xa,ge=>d(9,Mr=ge));const Gi=Ri([Re,Ln,Fe],([ge,un,Hi])=>{const Gr=Pp(un,Hi);return Object.keys(Gr).length>0?{...rv(ge,Gr),...Hi}:{}}),Pi=Ri([Gi,$e],sh("x")),Yn=Ri([Gi,Zt],sh("y")),Ki=Ri([Gi,rt],sh("z")),wa=Ri([Gi,tr],sh("r")),os=Ri([Zr,Gi,Pi,Qt,br,wi,Ai,xa,ii,ee],ph("x")),Fl=Ri([it,os],fh),uo=Ri([ba,Gi,Yn,pr,Ht,mr,Ai,xa,Oi,ee],ph("y")),Nl=Ri([xe,uo],fh),Ro=Ri([Ii,Gi,Ki,Ti,hr,Fr,Ai,xa,Na,ee],ph("z")),Ul=Ri([tt,Ro],fh),Bo=Ri([ni,Gi,wa,ha,rr,vr,Ai,xa,va,ee],ph("r")),Fs=Ri([We,Bo],fh),Ua=Ri([os],dh),ss=Ri([uo],dh),co=Ri([Ro],dh),Ns=Ri([Bo],dh),Va=Ri([Ai,xa],([ge,un])=>ge/un);Kt(u,Va,ge=>d(10,Sr=ge));function Rn(ge){Vu[ge?"unshift":"push"](()=>{Er=ge,d(2,Er)})}function Sa(){vi=this.clientWidth,Tn=this.clientHeight,d(0,vi),d(1,Tn)}return u.$$set=ge=>{"ssr"in ge&&d(3,ui=ge.ssr),"pointerEvents"in ge&&d(4,Hn=ge.pointerEvents),"position"in ge&&d(5,tn=ge.position),"percentRange"in ge&&d(51,jt=ge.percentRange),"width"in ge&&d(52,yn=ge.width),"height"in ge&&d(53,Qr=ge.height),"containerWidth"in ge&&d(0,vi=ge.containerWidth),"containerHeight"in ge&&d(1,Tn=ge.containerHeight),"element"in ge&&d(2,Er=ge.element),"x"in ge&&d(54,zi=ge.x),"y"in ge&&d(55,ci=ge.y),"z"in ge&&d(56,hi=ge.z),"r"in ge&&d(57,sn=ge.r),"data"in ge&&d(58,qr=ge.data),"xDomain"in ge&&d(59,pi=ge.xDomain),"yDomain"in ge&&d(60,fi=ge.yDomain),"zDomain"in ge&&d(61,bi=ge.zDomain),"rDomain"in ge&&d(62,Bi=ge.rDomain),"xNice"in ge&&d(63,Xn=ge.xNice),"yNice"in ge&&d(64,qi=ge.yNice),"zNice"in ge&&d(65,ji=ge.zNice),"rNice"in ge&&d(66,jr=ge.rNice),"xReverse"in ge&&d(67,ta=ge.xReverse),"yReverse"in ge&&d(68,gn=ge.yReverse),"zReverse"in ge&&d(69,xi=ge.zReverse),"rReverse"in ge&&d(70,Mn=ge.rReverse),"xPadding"in ge&&d(71,Wn=ge.xPadding),"yPadding"in ge&&d(72,Hr=ge.yPadding),"zPadding"in ge&&d(73,ra=ge.zPadding),"rPadding"in ge&&d(74,Dn=ge.rPadding),"xScale"in ge&&d(75,ti=ge.xScale),"yScale"in ge&&d(76,re=ge.yScale),"zScale"in ge&&d(77,dt=ge.zScale),"rScale"in ge&&d(78,Zi=ge.rScale),"xRange"in ge&&d(79,ri=ge.xRange),"yRange"in ge&&d(80,dr=ge.yRange),"zRange"in ge&&d(81,R=ge.zRange),"rRange"in ge&&d(82,N=ge.rRange),"padding"in ge&&d(83,V=ge.padding),"extents"in ge&&d(84,K=ge.extents),"flatData"in ge&&d(85,W=ge.flatData),"custom"in ge&&d(86,se=ge.custom),"$$scope"in ge&&d(89,Wt=ge.$$scope)},u.$$.update=()=>{u.$$.dirty[1]&8388608&&zi&&d(87,q.x=zi,q),u.$$.dirty[1]&16777216&&ci&&d(87,q.y=ci,q),u.$$.dirty[1]&33554432&&hi&&d(87,q.z=hi,q),u.$$.dirty[1]&67108864&&sn&&d(87,q.r=sn,q),u.$$.dirty[1]&268435456&&pi&&d(87,q.xDomain=pi,q),u.$$.dirty[1]&536870912&&fi&&d(87,q.yDomain=fi,q),u.$$.dirty[1]&1073741824&&bi&&d(87,q.zDomain=bi,q),u.$$.dirty[2]&1&&Bi&&d(87,q.rDomain=Bi,q),u.$$.dirty[2]&131072&&ri&&d(87,q.xRange=ri,q),u.$$.dirty[2]&262144&&dr&&d(87,q.yRange=dr,q),u.$$.dirty[2]&524288&&R&&d(87,q.zRange=R,q),u.$$.dirty[2]&1048576&&N&&d(87,q.rRange=N,q),u.$$.dirty[1]&1048576&&zr(ee,_i=jt,_i),u.$$.dirty[0]&1&&zr(ye,Cr=vi,Cr),u.$$.dirty[0]&2&&zr(Pe,Lt=Tn,Lt),u.$$.dirty[2]&4194304&&zr(Fe,De=Pp(K),De),u.$$.dirty[1]&134217728&&zr(ze,ht=qr,ht),u.$$.dirty[1]&134217728|u.$$.dirty[2]&8388608&&zr(Re,Nt=W||qr,Nt),u.$$.dirty[2]&2097152&&zr(st,Jt=V,Jt),u.$$.dirty[1]&8388608&&zr(it,At=rs(zi),At),u.$$.dirty[1]&16777216&&zr(xe,Pt=rs(ci),Pt),u.$$.dirty[1]&33554432&&zr(tt,Le=rs(hi),Le),u.$$.dirty[1]&67108864&&zr(We,Ct=rs(sn),Ct),u.$$.dirty[1]&268435456&&zr($e,yt=pi,yt),u.$$.dirty[1]&536870912&&zr(Zt,Ft=fi,Ft),u.$$.dirty[1]&1073741824&&zr(rt,Ze=bi,Ze),u.$$.dirty[2]&1&&zr(tr,mt=Bi,mt),u.$$.dirty[2]&2&&zr(br,ct=Xn,ct),u.$$.dirty[2]&4&&zr(Ht,Ue=qi,Ue),u.$$.dirty[2]&8&&zr(hr,vt=ji,vt),u.$$.dirty[2]&16&&zr(rr,Ye=jr,Ye),u.$$.dirty[2]&32&&zr(wi,Me=ta,Me),u.$$.dirty[2]&64&&zr(mr,ut=gn,ut),u.$$.dirty[2]&128&&zr(Fr,Ke=xi,Ke),u.$$.dirty[2]&256&&zr(vr,we=Mn,we),u.$$.dirty[2]&512&&zr(Qt,de=Wn,de),u.$$.dirty[2]&1024&&zr(pr,ve=Hr,ve),u.$$.dirty[2]&2048&&zr(Ti,ce=ra,ce),u.$$.dirty[2]&4096&&zr(ha,ne=Dn,ne),u.$$.dirty[2]&131072&&zr(ii,X=ri,X),u.$$.dirty[2]&262144&&zr(Oi,L=dr,L),u.$$.dirty[2]&524288&&zr(Na,D=R,D),u.$$.dirty[2]&1048576&&zr(va,F=N,F),u.$$.dirty[2]&8192&&zr(Zr,M=ti,M),u.$$.dirty[2]&16384&&zr(ba,z=re,z),u.$$.dirty[2]&32768&&zr(Ii,T=dt,T),u.$$.dirty[2]&65536&&zr(ni,a=Zi,a),u.$$.dirty[2]&16777216&&zr(Dr,v=se,v),u.$$.dirty[2]&33554432&&zr(ln,y=q,y),u.$$.dirty[2]&67108864&&ay("LayerCake",p)},d(88,p={activeGetters:Ln,width:Ai,height:xa,percentRange:ee,aspectRatio:Va,containerWidth:ye,containerHeight:Pe,x:it,y:xe,z:tt,r:We,custom:Dr,data:ze,xNice:br,yNice:Ht,zNice:hr,rNice:rr,xReverse:wi,yReverse:mr,zReverse:Fr,rReverse:vr,xPadding:Qt,yPadding:pr,zPadding:Ti,rPadding:ha,padding:_n,flatData:Re,extents:Gi,xDomain:Pi,yDomain:Yn,zDomain:Ki,rDomain:wa,xRange:Ua,yRange:ss,zRange:co,rRange:Ns,config:ln,xScale:os,xGet:Fl,yScale:uo,yGet:Nl,zScale:Ro,zGet:Ul,rScale:Bo,rGet:Fs}),[vi,Tn,Er,ui,Hn,tn,Lt,Cr,er,Mr,Sr,ee,ye,Pe,Fe,ze,Re,st,it,xe,tt,We,$e,Zt,rt,tr,br,Ht,hr,rr,wi,mr,Fr,vr,Qt,pr,Ti,ha,ii,Oi,Na,va,Zr,ba,Ii,ni,ln,Dr,Ai,xa,Va,jt,yn,Qr,zi,ci,hi,sn,qr,pi,fi,bi,Bi,Xn,qi,ji,jr,ta,gn,xi,Mn,Wn,Hr,ra,Dn,ti,re,dt,Zi,ri,dr,R,N,V,K,W,se,q,p,Wt,en,Rn,Sa]}class v0 extends fn{constructor(h){super(),dn(this,h,_0,g0,mn,{ssr:3,pointerEvents:4,position:5,percentRange:51,width:52,height:53,containerWidth:0,containerHeight:1,element:2,x:54,y:55,z:56,r:57,data:58,xDomain:59,yDomain:60,zDomain:61,rDomain:62,xNice:63,yNice:64,zNice:65,rNice:66,xReverse:67,yReverse:68,zReverse:69,rReverse:70,xPadding:71,yPadding:72,zPadding:73,rPadding:74,xScale:75,yScale:76,zScale:77,rScale:78,xRange:79,yRange:80,zRange:81,rRange:82,padding:83,extents:84,flatData:85,custom:86},null,[-1,-1,-1,-1,-1])}}const b0=u=>({element:u&1}),Wd=u=>({element:u[0]}),x0=u=>({element:u&1}),Yd=u=>({element:u[0]});function w0(u){let h,d,p,y,v;const a=u[12].defs,T=Ou(a,u,u[11],Yd),z=u[12].default,M=Ou(z,u,u[11],Wd);return{c(){h=Gn("svg"),d=Gn("defs"),T&&T.c(),p=Gn("g"),M&&M.c(),this.h()},l(F){h=Kn(F,"svg",{class:!0,viewBox:!0,width:!0,height:!0});var D=Ne(h);d=Kn(D,"defs",{});var L=Ne(d);T&&T.l(L),L.forEach(ae),p=Kn(D,"g",{class:!0,transform:!0});var X=Ne(p);M&&M.l(X),X.forEach(ae),D.forEach(ae),this.h()},h(){oe(p,"class","layercake-layout-svg_g"),oe(p,"transform",y="translate("+u[7].left+", "+u[7].top+")"),oe(h,"class","layercake-layout-svg svelte-u84d8d"),oe(h,"viewBox",u[4]),oe(h,"width",u[5]),oe(h,"height",u[6]),Xe(h,"z-index",u[2]),Xe(h,"pointer-events",u[3]===!1?"none":null)},m(F,D){Be(F,h,D),Ie(h,d),T&&T.m(d,null),Ie(h,p),M&&M.m(p,null),u[13](p),u[14](h),v=!0},p(F,[D]){T&&T.p&&(!v||D&2049)&&Fu(T,a,F,F[11],v?Uu(a,F[11],D,x0):Nu(F[11]),Yd),M&&M.p&&(!v||D&2049)&&Fu(M,z,F,F[11],v?Uu(z,F[11],D,b0):Nu(F[11]),Wd),(!v||D&128&&y!==(y="translate("+F[7].left+", "+F[7].top+")"))&&oe(p,"transform",y),(!v||D&16)&&oe(h,"viewBox",F[4]),(!v||D&32)&&oe(h,"width",F[5]),(!v||D&64)&&oe(h,"height",F[6]),D&4&&Xe(h,"z-index",F[2]),D&8&&Xe(h,"pointer-events",F[3]===!1?"none":null)},i(F){v||(Qe(T,F),Qe(M,F),v=!0)},o(F){ot(T,F),ot(M,F),v=!1},d(F){F&&ae(h),T&&T.d(F),M&&M.d(F),u[13](null),u[14](null)}}}function S0(u,h,d){let p,y,v,{$$slots:a={},$$scope:T}=h,{element:z=void 0}=h,{innerElement:M=void 0}=h,{zIndex:F=void 0}=h,{pointerEvents:D=void 0}=h,{viewBox:L=void 0}=h;const{containerWidth:X,containerHeight:ne,padding:ce}=Hu("LayerCake");Kt(u,X,we=>d(5,p=we)),Kt(u,ne,we=>d(6,y=we)),Kt(u,ce,we=>d(7,v=we));function ve(we){Vu[we?"unshift":"push"](()=>{M=we,d(1,M)})}function de(we){Vu[we?"unshift":"push"](()=>{z=we,d(0,z)})}return u.$$set=we=>{"element"in we&&d(0,z=we.element),"innerElement"in we&&d(1,M=we.innerElement),"zIndex"in we&&d(2,F=we.zIndex),"pointerEvents"in we&&d(3,D=we.pointerEvents),"viewBox"in we&&d(4,L=we.viewBox),"$$scope"in we&&d(11,T=we.$$scope)},[z,M,F,D,L,p,y,v,X,ne,ce,T,a,ve,de]}class k0 extends fn{constructor(h){super(),dn(this,h,S0,w0,mn,{element:0,innerElement:1,zIndex:2,pointerEvents:3,viewBox:4})}}function Jd(u,h,d){const p=u.slice();return p[23]=h[d],p[25]=d,p}function Qd(u){let h,d,p,y;return{c(){h=Gn("rect"),this.h()},l(v){h=Kn(v,"rect",{class:!0,"data-id":!0,x:!0,y:!0,width:!0,height:!0,fill:!0,stroke:!0,"stroke-width":!0}),Ne(h).forEach(ae),this.h()},h(){oe(h,"class","group-rect"),oe(h,"data-id",u[25]),oe(h,"x",d=u[11].bandwidth?u[7](u[23]):u[7](u[23])[0]),oe(h,"y",p=u[13](u[12](u[23]))-1),oe(h,"width",y=u[11].bandwidth?u[11].bandwidth():u[9](u[23])),oe(h,"height","3"),oe(h,"fill","#308182"),oe(h,"stroke",u[0]),oe(h,"stroke-width",u[1])},m(v,a){Be(v,h,a)},p(v,a){a&3200&&d!==(d=v[11].bandwidth?v[7](v[23]):v[7](v[23])[0])&&oe(h,"x",d),a&13312&&p!==(p=v[13](v[12](v[23]))-1)&&oe(h,"y",p),a&3584&&y!==(y=v[11].bandwidth?v[11].bandwidth():v[9](v[23]))&&oe(h,"width",y),a&1&&oe(h,"stroke",v[0]),a&2&&oe(h,"stroke-width",v[1])},d(v){v&&ae(h)}}}function $d(u){let h,d,p,y,v,a,T,z,M=u[12]&&Qd(u);return{c(){h=Gn("rect"),M&&M.c(),a=Gn("text"),this.h()},l(F){h=Kn(F,"rect",{class:!0,"data-id":!0,x:!0,y:!0,width:!0,height:!0,fill:!0,stroke:!0,"stroke-width":!0}),Ne(h).forEach(ae),M&&M.l(F),a=Kn(F,"text",{x:!0,y:!0,dx:!0,dy:!0,"text-anchor":!0}),Ne(a).forEach(ae),this.h()},h(){oe(h,"class","group-rect"),oe(h,"data-id",u[25]),oe(h,"x",d=u[11].bandwidth?u[7](u[23]):u[7](u[23])[0]),oe(h,"y",p=u[6](u[23])),oe(h,"width",y=u[11].bandwidth?u[11].bandwidth():u[9](u[23])),oe(h,"height",v=u[8](u[23])),oe(h,"fill",u[4]),oe(h,"stroke",u[0]),oe(h,"stroke-width",u[1]),oe(a,"x",T=u[11].bandwidth?u[7](u[23])+u[11].bandwidth()/2:u[7](u[23])[0]),oe(a,"y",z=u[6](u[23])-4),oe(a,"dx",u[2]),oe(a,"dy",u[3]),oe(a,"text-anchor",u[5])},m(F,D){Be(F,h,D),M&&M.m(F,D),Be(F,a,D)},p(F,D){D&3200&&d!==(d=F[11].bandwidth?F[7](F[23]):F[7](F[23])[0])&&oe(h,"x",d),D&1088&&p!==(p=F[6](F[23]))&&oe(h,"y",p),D&3584&&y!==(y=F[11].bandwidth?F[11].bandwidth():F[9](F[23]))&&oe(h,"width",y),D&1280&&v!==(v=F[8](F[23]))&&oe(h,"height",v),D&16&&oe(h,"fill",F[4]),D&1&&oe(h,"stroke",F[0]),D&2&&oe(h,"stroke-width",F[1]),F[12]?M?M.p(F,D):(M=Qd(F),M.c(),M.m(a.parentNode,a)):M&&(M.d(1),M=null),D&3200&&T!==(T=F[11].bandwidth?F[7](F[23])+F[11].bandwidth()/2:F[7](F[23])[0])&&oe(a,"x",T),D&1088&&z!==(z=F[6](F[23])-4)&&oe(a,"y",z),D&4&&oe(a,"dx",F[2]),D&8&&oe(a,"dy",F[3]),D&32&&oe(a,"text-anchor",F[5])},d(F){F&&ae(h),M&&M.d(F),F&&ae(a)}}}function E0(u){let h,d=u[10],p=[];for(let y=0;y<d.length;y+=1)p[y]=$d(Jd(u,d,y));return{c(){h=Gn("g");for(let y=0;y<p.length;y+=1)p[y].c();this.h()},l(y){h=Kn(y,"g",{class:!0});var v=Ne(h);for(let a=0;a<p.length;a+=1)p[a].l(v);v.forEach(ae),this.h()},h(){oe(h,"class","column-group svelte-wgzwsk")},m(y,v){Be(y,h,v);for(let a=0;a<p.length;a+=1)p[a]&&p[a].m(h,null)},p(y,[v]){if(v&16383){d=y[10];let a;for(a=0;a<d.length;a+=1){const T=Jd(y,d,a);p[a]?p[a].p(T,v):(p[a]=$d(T),p[a].c(),p[a].m(h,null))}for(;a<p.length;a+=1)p[a].d(1);p.length=d.length}},i:li,o:li,d(y){y&&ae(h),on(p,y)}}}function z0(u,h,d){let p,y,v,a,T,z,M,F,D;const{data:L,xGet:X,yGet:ne,yRange:ce,xScale:ve,yScale:de,y:we,z:Ke}=Hu("LayerCake");Kt(u,L,mt=>d(10,z=mt)),Kt(u,X,mt=>d(7,T=mt)),Kt(u,ne,mt=>d(6,v=mt)),Kt(u,ce,mt=>d(21,a=mt)),Kt(u,ve,mt=>d(11,M=mt)),Kt(u,de,mt=>d(13,D=mt)),Kt(u,Ke,mt=>d(12,F=mt));let{stroke:ut=""}=h,{strokeWidth:Me=0}=h,{dxTick:Ye=0}=h,{dyTick:vt=0}=h,{fill:Ue="#00205b"}=h,{textAnchor:ct="middle"}=h;return u.$$set=mt=>{"stroke"in mt&&d(0,ut=mt.stroke),"strokeWidth"in mt&&d(1,Me=mt.strokeWidth),"dxTick"in mt&&d(2,Ye=mt.dxTick),"dyTick"in mt&&d(3,vt=mt.dyTick),"fill"in mt&&d(4,Ue=mt.fill),"textAnchor"in mt&&d(5,ct=mt.textAnchor)},u.$$.update=()=>{u.$$.dirty&128&&d(9,p=mt=>{const Ze=T(mt);return Math.max(0,Ze[1]-Ze[0])}),u.$$.dirty&2097216&&d(8,y=mt=>a[0]-v(mt))},[ut,Me,Ye,vt,Ue,ct,v,T,y,p,z,M,F,D,L,X,ne,ce,ve,de,Ke,a]}class T0 extends fn{constructor(h){super(),dn(this,h,z0,E0,mn,{stroke:0,strokeWidth:1,dxTick:2,dyTick:3,fill:4,textAnchor:5})}}function em(u,h,d){const p=u.slice();return p[28]=h[d],p[30]=d,p}function tm(u){let h,d,p,y;return{c(){h=Gn("line"),this.h()},l(v){h=Kn(v,"line",{y1:!0,y2:!0,x1:!0,x2:!0,stroke:!0,"stroke-width":!0,class:!0}),Ne(h).forEach(ae),this.h()},h(){oe(h,"y1",d=u[20]*-1),oe(h,"y2",p=u[14]&&u[30]%2==0?u[10]+u[8]+2:u[10]+u[8]-13),oe(h,"x1","0"),oe(h,"x2","0"),oe(h,"stroke",u[11]),oe(h,"stroke-width",y=u[15]&&Array.isArray(u[4])&&u[30]==Math.floor(u[4].length/2)?2:1),oe(h,"class","svelte-fwjh80"),ns(h,"baseline",u[13])},m(v,a){Be(v,h,a)},p(v,a){a&1048576&&d!==(d=v[20]*-1)&&oe(h,"y1",d),a&17664&&p!==(p=v[14]&&v[30]%2==0?v[10]+v[8]+2:v[10]+v[8]-13)&&oe(h,"y2",p),a&2048&&oe(h,"stroke",v[11]),a&32784&&y!==(y=v[15]&&Array.isArray(v[4])&&v[30]==Math.floor(v[4].length/2)?2:1)&&oe(h,"stroke-width",y),a&8192&&ns(h,"baseline",v[13])},d(v){v&&ae(h)}}}function I0(u){let h=u[1](u[28])+"",d;return{c(){d=Vt(h)},l(p){d=qt(p,h)},m(p,y){Be(p,d,y)},p(p,y){y&262146&&h!==(h=p[1](p[28])+"")&&Rr(d,h)},d(p){p&&ae(d)}}}function A0(u){let h,d=u[1](u[28])+"",p,y;return{c(){h=Vt(u[5]),p=Vt(d),y=Vt(u[6])},l(v){h=qt(v,u[5]),p=qt(v,d),y=qt(v,u[6])},m(v,a){Be(v,h,a),Be(v,p,a),Be(v,y,a)},p(v,a){a&32&&Rr(h,v[5]),a&262146&&d!==(d=v[1](v[28])+"")&&Rr(p,d),a&64&&Rr(y,v[6])},d(v){v&&ae(h),v&&ae(p),v&&ae(y)}}}function rm(u){let h,d,p,y,v,a,T,z=u[0]!==!1&&tm(u);function M(L,X){return L[30]==L[18].length-1?A0:I0}let F=M(u),D=F(u);return{c(){h=Gn("g"),z&&z.c(),d=Gn("text"),D.c(),this.h()},l(L){h=Kn(L,"g",{class:!0,transform:!0});var X=Ne(h);z&&z.l(X),d=Kn(X,"text",{x:!0,y:!0,dx:!0,dy:!0,"text-anchor":!0,fill:!0,class:!0});var ne=Ne(d);D.l(ne),ne.forEach(ae),X.forEach(ae),this.h()},h(){oe(d,"x",p=u[7]||u[16]?u[17].bandwidth()/2:0),oe(d,"y",y=u[3]?u[20]*-1-6:u[14]&&u[30]%2==0?u[8]+15:u[8]),oe(d,"dx",v=u[24](u[30])=="start"?u[9]-2:u[24](u[30])=="end"?u[9]+2:u[9]),oe(d,"dy",u[10]),oe(d,"text-anchor",u[24](u[30])),oe(d,"fill",u[12]),oe(d,"class","svelte-fwjh80"),ns(d,"bold",u[15]&&Array.isArray(u[4])&&u[30]==Math.floor(u[4].length/2)),oe(h,"class",a="tick tick-"+u[28]+" svelte-fwjh80"),oe(h,"transform",T="translate("+u[17](u[28])+","+u[19][0]+")")},m(L,X){Be(L,h,X),z&&z.m(h,null),Ie(h,d),D.m(d,null)},p(L,X){L[0]!==!1?z?z.p(L,X):(z=tm(L),z.c(),z.m(h,d)):z&&(z.d(1),z=null),F===(F=M(L))&&D?D.p(L,X):(D.d(1),D=F(L),D&&(D.c(),D.m(d,null))),X&196736&&p!==(p=L[7]||L[16]?L[17].bandwidth()/2:0)&&oe(d,"x",p),X&1065224&&y!==(y=L[3]?L[20]*-1-6:L[14]&&L[30]%2==0?L[8]+15:L[8])&&oe(d,"y",y),X&512&&v!==(v=L[24](L[30])=="start"?L[9]-2:L[24](L[30])=="end"?L[9]+2:L[9])&&oe(d,"dx",v),X&1024&&oe(d,"dy",L[10]),X&4096&&oe(d,"fill",L[12]),X&32784&&ns(d,"bold",L[15]&&Array.isArray(L[4])&&L[30]==Math.floor(L[4].length/2)),X&262144&&a!==(a="tick tick-"+L[28]+" svelte-fwjh80")&&oe(h,"class",a),X&917504&&T!==(T="translate("+L[17](L[28])+","+L[19][0]+")")&&oe(h,"transform",T)},d(L){L&&ae(h),z&&z.d(),D.d()}}}function im(u){let h,d,p;return{c(){h=Gn("line"),this.h()},l(y){h=Kn(y,"line",{class:!0,y1:!0,y2:!0,x1:!0,x2:!0,stroke:!0}),Ne(h).forEach(ae),this.h()},h(){oe(h,"class","baseline svelte-fwjh80"),oe(h,"y1",u[20]),oe(h,"y2","0"),oe(h,"x1",d=u[17](0)),oe(h,"x2",p=u[17](0)),oe(h,"stroke",u[11])},m(y,v){Be(y,h,v)},p(y,v){v&1048576&&oe(h,"y1",y[20]),v&131072&&d!==(d=y[17](0))&&oe(h,"x1",d),v&131072&&p!==(p=y[17](0))&&oe(h,"x2",p),v&2048&&oe(h,"stroke",y[11])},d(y){y&&ae(h)}}}function P0(u){let h,d,p=u[18],y=[];for(let a=0;a<p.length;a+=1)y[a]=rm(em(u,p,a));let v=u[2]===!0&&im(u);return{c(){h=Gn("g");for(let a=0;a<y.length;a+=1)y[a].c();d=sr(),v&&v.c(),this.h()},l(a){h=Kn(a,"g",{class:!0});var T=Ne(h);for(let z=0;z<y.length;z+=1)y[z].l(T);d=sr(),v&&v.l(T),T.forEach(ae),this.h()},h(){oe(h,"class","axis x-axis")},m(a,T){Be(a,h,T);for(let z=0;z<y.length;z+=1)y[z]&&y[z].m(h,null);Ie(h,d),v&&v.m(h,null)},p(a,[T]){if(T&18874363){p=a[18];let z;for(z=0;z<p.length;z+=1){const M=em(a,p,z);y[z]?y[z].p(M,T):(y[z]=rm(M),y[z].c(),y[z].m(h,d))}for(;z<y.length;z+=1)y[z].d(1);y.length=p.length}a[2]===!0?v?v.p(a,T):(v=im(a),v.c(),v.m(h,null)):v&&(v.d(1),v=null)},i:li,o:li,d(a){a&&ae(h),on(y,a),v&&v.d()}}}function C0(u,h,d){let p,y,v,a,T;const{width:z,height:M,xScale:F,yScale:D,yRange:L}=Hu("LayerCake");Kt(u,M,Le=>d(20,T=Le)),Kt(u,F,Le=>d(17,v=Le)),Kt(u,L,Le=>d(19,a=Le));let{gridlines:X=!0}=h,{formatTick:ne=Le=>Le}=h,{baseline:ce=!1}=h,{flipped:ve=!1}=h,{snapTicks:de=!1}=h,{ticks:we=void 0}=h,{prefix:Ke=""}=h,{suffix:ut=""}=h,{xTick:Me=void 0}=h,{yTick:Ye=15}=h,{dxTick:vt=0}=h,{dyTick:Ue=0}=h,{lineColor:ct="#999"}=h,{textColor:mt="#555"}=h,{solid:Ze=!1}=h,{stagger:Ft=!1}=h,{median:yt=!0}=h;function Ct(Le){if(de===!0){if(Le===0)return"start";if(Le===y.length-1)return"end"}return"middle"}return u.$$set=Le=>{"gridlines"in Le&&d(0,X=Le.gridlines),"formatTick"in Le&&d(1,ne=Le.formatTick),"baseline"in Le&&d(2,ce=Le.baseline),"flipped"in Le&&d(3,ve=Le.flipped),"snapTicks"in Le&&d(25,de=Le.snapTicks),"ticks"in Le&&d(4,we=Le.ticks),"prefix"in Le&&d(5,Ke=Le.prefix),"suffix"in Le&&d(6,ut=Le.suffix),"xTick"in Le&&d(7,Me=Le.xTick),"yTick"in Le&&d(8,Ye=Le.yTick),"dxTick"in Le&&d(9,vt=Le.dxTick),"dyTick"in Le&&d(10,Ue=Le.dyTick),"lineColor"in Le&&d(11,ct=Le.lineColor),"textColor"in Le&&d(12,mt=Le.textColor),"solid"in Le&&d(13,Ze=Le.solid),"stagger"in Le&&d(14,Ft=Le.stagger),"median"in Le&&d(15,yt=Le.median)},u.$$.update=()=>{u.$$.dirty&131072&&d(16,p=typeof v.bandwidth=="function"),u.$$.dirty&196624&&d(18,y=Array.isArray(we)?we:p?v.domain():v.ticks(we))},[X,ne,ce,ve,we,Ke,ut,Me,Ye,vt,Ue,ct,mt,Ze,Ft,yt,p,v,y,a,T,M,F,L,Ct,de]}class M0 extends fn{constructor(h){super(),dn(this,h,C0,P0,mn,{gridlines:0,formatTick:1,baseline:2,flipped:3,snapTicks:25,ticks:4,prefix:5,suffix:6,xTick:7,yTick:8,dxTick:9,dyTick:10,lineColor:11,textColor:12,solid:13,stagger:14,median:15})}}function D0(u){let h,d,p,y;return h=new T0({props:{fill:u[1],formatVal:u[5]}}),p=new M0({props:{gridlines:!1}}),{c(){ir(h.$$.fragment),d=xt(),ir(p.$$.fragment)},l(v){nr(h.$$.fragment,v),d=wt(v),nr(p.$$.fragment,v)},m(v,a){ar(h,v,a),Be(v,d,a),ar(p,v,a),y=!0},p(v,a){const T={};a&2&&(T.fill=v[1]),a&32&&(T.formatVal=v[5]),h.$set(T)},i(v){y||(Qe(h.$$.fragment,v),Qe(p.$$.fragment,v),y=!0)},o(v){ot(h.$$.fragment,v),ot(p.$$.fragment,v),y=!1},d(v){or(h,v),v&&ae(d),or(p,v)}}}function L0(u){let h,d;return h=new k0({props:{$$slots:{default:[D0]},$$scope:{ctx:u}}}),{c(){ir(h.$$.fragment)},l(p){nr(h.$$.fragment,p)},m(p,y){ar(h,p,y),d=!0},p(p,y){const v={};y&1058&&(v.$$scope={dirty:y,ctx:p}),h.$set(v)},i(p){d||(Qe(h.$$.fragment,p),d=!0)},o(p){ot(h.$$.fragment,p),d=!1},d(p){or(h,p)}}}function R0(u){let h,d,p;return d=new v0({props:{padding:{top:15,right:0,bottom:20,left:0},x:u[2],y:u[3],z:u[4],xScale:yy().paddingInner([.02]).round(!0),xDomain:u[7],yDomain:u[6],zDomain:u[6],data:u[0],$$slots:{default:[L0]},$$scope:{ctx:u}}}),{c(){h=qe("div"),ir(d.$$.fragment),this.h()},l(y){h=je(y,"DIV",{class:!0});var v=Ne(h);nr(d.$$.fragment,v),v.forEach(ae),this.h()},h(){oe(h,"class","chart-container svelte-1i1qsul")},m(y,v){Be(y,h,v),ar(d,h,null),p=!0},p(y,[v]){const a={};v&4&&(a.x=y[2]),v&8&&(a.y=y[3]),v&16&&(a.z=y[4]),v&128&&(a.xDomain=y[7]),v&64&&(a.yDomain=y[6]),v&64&&(a.zDomain=y[6]),v&1&&(a.data=y[0]),v&1058&&(a.$$scope={dirty:v,ctx:y}),d.$set(a)},i(y){p||(Qe(d.$$.fragment,y),p=!0)},o(y){ot(d.$$.fragment,y),p=!1},d(y){y&&ae(h),or(d)}}}function B0(u,h,d){let p,y,v,{data:a}=h,{suffix:T="%"}=h,{decimals:z=null}=h,{fill:M="#00205B"}=h,{xKey:F="x"}=h,{yKey:D="y"}=h,{zKey:L=null}=h;return u.$$set=X=>{"data"in X&&d(0,a=X.data),"suffix"in X&&d(8,T=X.suffix),"decimals"in X&&d(9,z=X.decimals),"fill"in X&&d(1,M=X.fill),"xKey"in X&&d(2,F=X.xKey),"yKey"in X&&d(3,D=X.yKey),"zKey"in X&&d(4,L=X.zKey)},u.$$.update=()=>{u.$$.dirty&5&&d(7,p=a.map(X=>X[F])),u.$$.dirty&9&&d(6,y=[0,Math.max(...a.map(X=>X[D]))]),u.$$.dirty&768&&d(5,v=X=>X.toFixed(z)+T)},[a,M,F,D,L,v,y,p,T,z]}class Lh extends fn{constructor(h){super(),dn(this,h,B0,R0,mn,{data:0,suffix:8,decimals:9,fill:1,xKey:2,yKey:3,zKey:4})}}function nm(u,h,d){const p=u.slice();return p[6]=h[d],p[8]=d,p}function am(u){let h,d=u[0],p=[];for(let y=0;y<d.length;y+=1)p[y]=om(nm(u,d,y));return{c(){h=Gn("svg");for(let y=0;y<p.length;y+=1)p[y].c();this.h()},l(y){h=Kn(y,"svg",{class:!0});var v=Ne(h);for(let a=0;a<p.length;a+=1)p[a].l(v);v.forEach(ae),this.h()},h(){oe(h,"class","stack svelte-pzvhwz")},m(y,v){Be(y,h,v);for(let a=0;a<p.length;a+=1)p[a]&&p[a].m(h,null)},p(y,v){if(v&31){d=y[0];let a;for(a=0;a<d.length;a+=1){const T=nm(y,d,a);p[a]?p[a].p(T,v):(p[a]=om(T),p[a].c(),p[a].m(h,null))}for(;a<p.length;a+=1)p[a].d(1);p.length=d.length}},d(y){y&&ae(h),on(p,y)}}}function om(u){let h,d;return{c(){h=Gn("rect"),this.h()},l(p){h=Kn(p,"rect",{class:!0,x:!0,style:!0}),Ne(h).forEach(ae),this.h()},h(){oe(h,"class","cell svelte-pzvhwz"),oe(h,"x",d=u[4][u[8]]/u[3]*100+"%"),Xe(h,"width",u[6][u[1]]/u[3]*100+"%"),Xe(h,"fill",u[2][u[8]])},m(p,y){Be(p,h,y)},p(p,y){y&24&&d!==(d=p[4][p[8]]/p[3]*100+"%")&&oe(h,"x",d),y&11&&Xe(h,"width",p[6][p[1]]/p[3]*100+"%"),y&4&&Xe(h,"fill",p[2][p[8]])},d(p){p&&ae(h)}}}function O0(u){let h,d=u[3]&&u[4]&&am(u);return{c(){d&&d.c(),h=sr()},l(p){d&&d.l(p),h=sr()},m(p,y){d&&d.m(p,y),Be(p,h,y)},p(p,[y]){p[3]&&p[4]?d?d.p(p,y):(d=am(p),d.c(),d.m(h.parentNode,h)):d&&(d.d(1),d=null)},i:li,o:li,d(p){d&&d.d(p),p&&ae(h)}}}function F0(u,h,d){let{data:p}=h,{yKey:y="y"}=h,{colors:v=["#00205B","#308182","#002417","#BD00BD","lightgrey"]}=h,a,T;function z(){d(3,a=p.map(F=>F[y]).reduce((F,D)=>F+D,0));let M=[0];p.forEach(F=>M.push(M[M.length-1]+F[y])),d(4,T=M)}return u.$$set=M=>{"data"in M&&d(0,p=M.data),"yKey"in M&&d(1,y=M.yKey),"colors"in M&&d(2,v=M.colors)},u.$$.update=()=>{u.$$.dirty&3&&(p||y)&&z()},[p,y,v,a,T]}class Wp extends fn{constructor(h){super(),dn(this,h,F0,O0,mn,{data:0,yKey:1,colors:2})}}function sm(u,h,d){const p=u.slice();return p[10]=h[d],p[12]=d,p}function N0(u){let h,d,p=u[6](u[10][u[3]])+"",y,v;return{c(){h=qe("span"),d=Vt("(NI "),y=Vt(p),v=Vt(")"),this.h()},l(a){h=je(a,"SPAN",{class:!0,style:!0});var T=Ne(h);d=qt(T,"(NI "),y=qt(T,p),v=qt(T,")"),T.forEach(ae),this.h()},h(){oe(h,"class",""),Xe(h,"color","#1460aa")},m(a,T){Be(a,h,T),Ie(h,d),Ie(h,y),Ie(h,v)},p(a,T){T&9&&p!==(p=a[6](a[10][a[3]])+"")&&Rr(y,p)},d(a){a&&ae(h)}}}function U0(u){let h;return{c(){h=qe("span"),this.h()},l(d){h=je(d,"SPAN",{class:!0,style:!0}),Ne(h).forEach(ae),this.h()},h(){oe(h,"class",""),Xe(h,"color","#1460aa")},m(d,p){Be(d,h,p)},p:li,d(d){d&&ae(h)}}}function V0(u){let h,d,p=gd(Math.round(u[10][u[3]]),"%)")+"",y;return{c(){h=qe("span"),d=Vt("(2011 "),y=Vt(p),this.h()},l(v){h=je(v,"SPAN",{class:!0,style:!0});var a=Ne(h);d=qt(a,"(2011 "),y=qt(a,p),a.forEach(ae),this.h()},h(){oe(h,"class",""),Xe(h,"color","#1460aa")},m(v,a){Be(v,h,a),Ie(h,d),Ie(h,y)},p(v,a){a&9&&p!==(p=gd(Math.round(v[10][v[3]]),"%)")+"")&&Rr(y,p)},d(v){v&&ae(h)}}}function lm(u){let h,d,p,y,v,a=u[10][u[1]]+"",T,z,M,F=u[6](u[10][u[2]])+"",D,L,X;function ne(de,we){if(de[3]=="prev"&&de[4])return V0;if(de[3]=="prev"&&!de[4])return U0;if(de[3])return N0}let ce=ne(u),ve=ce&&ce(u);return{c(){h=qe("tr"),d=qe("td"),p=Gn("svg"),y=Gn("rect"),v=xt(),T=Vt(a),z=xt(),M=qe("td"),D=Vt(F),L=xt(),ve&&ve.c(),X=xt(),this.h()},l(de){h=je(de,"TR",{});var we=Ne(h);d=je(we,"TD",{class:!0});var Ke=Ne(d);p=Kn(Ke,"svg",{width:!0,height:!0,class:!0});var ut=Ne(p);y=Kn(ut,"rect",{width:!0,height:!0,style:!0}),Ne(y).forEach(ae),ut.forEach(ae),v=wt(Ke),T=qt(Ke,a),Ke.forEach(ae),z=wt(we),M=je(we,"TD",{class:!0,style:!0});var Me=Ne(M);D=qt(Me,F),L=wt(Me),ve&&ve.l(Me),Me.forEach(ae),X=wt(we),we.forEach(ae),this.h()},h(){oe(y,"width","20"),oe(y,"height","30"),Xe(y,"fill",u[5][u[12]]),oe(p,"width","20"),oe(p,"height","30"),oe(p,"class","bullet svelte-1gvovsq"),oe(d,"class","svelte-1gvovsq"),oe(M,"class","cell-right svelte-1gvovsq"),Xe(M,"vertical-align","top")},m(de,we){Be(de,h,we),Ie(h,d),Ie(d,p),Ie(p,y),Ie(d,v),Ie(d,T),Ie(h,z),Ie(h,M),Ie(M,D),Ie(M,L),ve&&ve.m(M,null),Ie(h,X)},p(de,we){we&32&&Xe(y,"fill",de[5][de[12]]),we&3&&a!==(a=de[10][de[1]]+"")&&Rr(T,a),we&5&&F!==(F=de[6](de[10][de[2]])+"")&&Rr(D,F),ce===(ce=ne(de))&&ve?ve.p(de,we):(ve&&ve.d(1),ve=ce&&ce(de),ve&&(ve.c(),ve.m(M,null)))},d(de){de&&ae(h),ve&&ve.d()}}}function q0(u){let h,d,p=u[0],y=[];for(let v=0;v<p.length;v+=1)y[v]=lm(sm(u,p,v));return{c(){h=qe("table"),d=qe("tbody");for(let v=0;v<y.length;v+=1)y[v].c();this.h()},l(v){h=je(v,"TABLE",{class:!0});var a=Ne(h);d=je(a,"TBODY",{});var T=Ne(d);for(let z=0;z<y.length;z+=1)y[z].l(T);T.forEach(ae),a.forEach(ae),this.h()},h(){oe(h,"class","legend svelte-1gvovsq")},m(v,a){Be(v,h,a),Ie(h,d);for(let T=0;T<y.length;T+=1)y[T]&&y[T].m(d,null)},p(v,[a]){if(a&127){p=v[0];let T;for(T=0;T<p.length;T+=1){const z=sm(v,p,T);y[T]?y[T].p(z,a):(y[T]=lm(z),y[T].c(),y[T].m(d,null))}for(;T<y.length;T+=1)y[T].d(1);y.length=p.length}},i:li,o:li,d(v){v&&ae(h),on(y,v)}}}function j0(u,h,d){let p,{data:y}=h,{xKey:v="x"}=h,{yKey:a="y"}=h,{zKey:T="ni"}=h,{topic_prev_available:z=!0}=h,{colors:M=["#3878c5","#00205B","#308182","#002417","#BD00BD","lightgrey"]}=h,{decimals:F=null}=h;function D(L){let X;return F?X=(L/p*100).toFixed(F)+"%":L/p*100<1?X="<1%":X=(L/p*100).toFixed(0)+"%",X}return u.$$set=L=>{"data"in L&&d(0,y=L.data),"xKey"in L&&d(1,v=L.xKey),"yKey"in L&&d(2,a=L.yKey),"zKey"in L&&d(3,T=L.zKey),"topic_prev_available"in L&&d(4,z=L.topic_prev_available),"colors"in L&&d(5,M=L.colors),"decimals"in L&&d(7,F=L.decimals)},u.$$.update=()=>{u.$$.dirty&5&&(p=y.map(L=>L[a]).reduce((L,X)=>L+X,0)),u.$$.dirty&9&&y.map(L=>L[T]).reduce((L,X)=>L+X,0)},[y,v,a,T,z,M,D,F]}class Z0 extends fn{constructor(h){super(),dn(this,h,j0,q0,mn,{data:0,xKey:1,yKey:2,zKey:3,topic_prev_available:4,colors:5,decimals:7})}}function um(u){let h,d,p,y;d=new Wp({props:{data:u[0],yKey:u[4],colors:u[6]}});let v=u[8]&&cm(u);return{c(){h=qe("div"),ir(d.$$.fragment),p=xt(),v&&v.c(),this.h()},l(a){h=je(a,"DIV",{class:!0,style:!0});var T=Ne(h);nr(d.$$.fragment,T),p=wt(T),v&&v.l(T),T.forEach(ae),this.h()},h(){oe(h,"class","chart svelte-1tebgpk"),Xe(h,"height",u[1]*.28+"px")},m(a,T){Be(a,h,T),ar(d,h,null),Ie(h,p),v&&v.m(h,null),y=!0},p(a,T){const z={};T&1&&(z.data=a[0]),T&16&&(z.yKey=a[4]),T&64&&(z.colors=a[6]),d.$set(z),a[8]?v?v.p(a,T):(v=cm(a),v.c(),v.m(h,null)):v&&(v.d(1),v=null),(!y||T&2)&&Xe(h,"height",a[1]*.28+"px")},i(a){y||(Qe(d.$$.fragment,a),y=!0)},o(a){ot(d.$$.fragment,a),y=!1},d(a){a&&ae(h),or(d),v&&v.d()}}}function cm(u){let h,d;return{c(){h=qe("div"),d=Vt(u[8]),this.h()},l(p){h=je(p,"DIV",{class:!0});var y=Ne(h);d=qt(y,u[8]),y.forEach(ae),this.h()},h(){oe(h,"class","label svelte-1tebgpk")},m(p,y){Be(p,h,y),Ie(h,d)},p(p,y){y&256&&Rr(d,p[8])},d(p){p&&ae(h)}}}function hm(u){let h,d,p,y,v,a;return d=new Wp({props:{data:u[0],yKey:u[4],colors:u[6]}}),{c(){h=qe("div"),ir(d.$$.fragment),p=xt(),y=qe("div"),v=Vt("2011 comparison not available"),this.h()},l(T){h=je(T,"DIV",{class:!0,style:!0});var z=Ne(h);nr(d.$$.fragment,z),p=wt(z),y=je(z,"DIV",{class:!0,style:!0});var M=Ne(y);v=qt(M,"2011 comparison not available"),M.forEach(ae),z.forEach(ae),this.h()},h(){oe(y,"class","label svelte-1tebgpk"),Xe(y,"background-color","#d8d8d8 "),Xe(y,"color","#000000"),oe(h,"class","chart svelte-1tebgpk"),Xe(h,"height",u[1]*.28+"px")},m(T,z){Be(T,h,z),ar(d,h,null),Ie(h,p),Ie(h,y),Ie(y,v),a=!0},p(T,z){const M={};z&1&&(M.data=T[0]),z&16&&(M.yKey=T[4]),z&64&&(M.colors=T[6]),d.$set(M),(!a||z&2)&&Xe(h,"height",T[1]*.28+"px")},i(T){a||(Qe(d.$$.fragment,T),a=!0)},o(T){ot(d.$$.fragment,T),a=!1},d(T){T&&ae(h),or(d)}}}function G0(u){let h,d,p,y,v,a,T,z;d=new Wp({props:{data:u[0],yKey:u[3],colors:u[6]}});let M=(u[4]&&u[5]||u[4]=="ni")&&um(u),F=u[4]=="prev"&&!u[5]&&hm(u);return T=new Z0({props:{data:u[0],xKey:u[2],yKey:u[3],zKey:u[4],topic_prev_available:u[5],decimals:u[7],colors:u[6]}}),{c(){h=qe("div"),ir(d.$$.fragment),p=xt(),M&&M.c(),y=xt(),F&&F.c(),v=xt(),a=qe("div"),ir(T.$$.fragment),this.h()},l(D){h=je(D,"DIV",{class:!0,style:!0});var L=Ne(h);nr(d.$$.fragment,L),L.forEach(ae),p=wt(D),M&&M.l(D),y=wt(D),F&&F.l(D),v=wt(D),a=je(D,"DIV",{class:!0});var X=Ne(a);nr(T.$$.fragment,X),X.forEach(ae),this.h()},h(){oe(h,"class","chart svelte-1tebgpk"),Xe(h,"padding-top","3px"),Xe(h,"height",(u[4]?u[1]*.72:u[1])+"px"),oe(a,"class","legend svelte-1tebgpk")},m(D,L){Be(D,h,L),ar(d,h,null),Be(D,p,L),M&&M.m(D,L),Be(D,y,L),F&&F.m(D,L),Be(D,v,L),Be(D,a,L),ar(T,a,null),z=!0},p(D,[L]){const X={};L&1&&(X.data=D[0]),L&8&&(X.yKey=D[3]),L&64&&(X.colors=D[6]),d.$set(X),(!z||L&18)&&Xe(h,"height",(D[4]?D[1]*.72:D[1])+"px"),D[4]&&D[5]||D[4]=="ni"?M?(M.p(D,L),L&48&&Qe(M,1)):(M=um(D),M.c(),Qe(M,1),M.m(y.parentNode,y)):M&&(En(),ot(M,1,1,()=>{M=null}),zn()),D[4]=="prev"&&!D[5]?F?(F.p(D,L),L&48&&Qe(F,1)):(F=hm(D),F.c(),Qe(F,1),F.m(v.parentNode,v)):F&&(En(),ot(F,1,1,()=>{F=null}),zn());const ne={};L&1&&(ne.data=D[0]),L&4&&(ne.xKey=D[2]),L&8&&(ne.yKey=D[3]),L&16&&(ne.zKey=D[4]),L&32&&(ne.topic_prev_available=D[5]),L&128&&(ne.decimals=D[7]),L&64&&(ne.colors=D[6]),T.$set(ne)},i(D){z||(Qe(d.$$.fragment,D),Qe(M),Qe(F),Qe(T.$$.fragment,D),z=!0)},o(D){ot(d.$$.fragment,D),ot(M),ot(F),ot(T.$$.fragment,D),z=!1},d(D){D&&ae(h),or(d),D&&ae(p),M&&M.d(D),D&&ae(y),F&&F.d(D),D&&ae(v),D&&ae(a),or(T)}}}function K0(u,h,d){let{data:p}=h,{height:y=80}=h,{xKey:v="x"}=h,{yKey:a="y"}=h,{zKey:T="ni"}=h,{topic_prev_available:z=!0}=h,{colors:M=["#8268b6","#00205B","#308182","#3d007a","#3878c5","lightgrey"]}=h,{decimals:F=null}=h,{label:D=null}=h;return u.$$set=L=>{"data"in L&&d(0,p=L.data),"height"in L&&d(1,y=L.height),"xKey"in L&&d(2,v=L.xKey),"yKey"in L&&d(3,a=L.yKey),"zKey"in L&&d(4,T=L.zKey),"topic_prev_available"in L&&d(5,z=L.topic_prev_available),"colors"in L&&d(6,M=L.colors),"decimals"in L&&d(7,F=L.decimals),"label"in L&&d(8,D=L.label)},[p,y,v,a,T,z,M,F,D]}class Rh extends fn{constructor(h){super(),dn(this,h,K0,G0,mn,{data:0,height:1,xKey:2,yKey:3,zKey:4,topic_prev_available:5,colors:6,decimals:7,label:8})}}function pm(u,h,d){const p=u.slice();return p[15]=h[d],p}function fm(u,h,d){const p=u.slice();return p[18]=h[d],p[19]=h,p[20]=d,p}function dm(u,h,d){const p=u.slice();return p[15]=h[d],p[20]=d,p}function mm(u){let h,d=u[5],p=[];for(let y=0;y<d.length;y+=1)p[y]=ym(dm(u,d,y));return{c(){h=qe("ul");for(let y=0;y<p.length;y+=1)p[y].c();this.h()},l(y){h=je(y,"UL",{class:!0});var v=Ne(h);for(let a=0;a<p.length;a+=1)p[a].l(v);v.forEach(ae),this.h()},h(){oe(h,"class","legend-block svelte-sk00pb")},m(y,v){Be(y,h,v);for(let a=0;a<p.length;a+=1)p[a]&&p[a].m(h,null)},p(y,v){if(v&32){d=y[5];let a;for(a=0;a<d.length;a+=1){const T=dm(y,d,a);p[a]?p[a].p(T,v):(p[a]=ym(T),p[a].c(),p[a].m(h,null))}for(;a<p.length;a+=1)p[a].d(1);p.length=d.length}},d(y){y&&ae(h),on(p,y)}}}function ym(u){let h,d,p,y,v=u[15]+"",a,T;return{c(){h=qe("li"),d=qe("div"),p=xt(),y=qe("span"),a=Vt(v),T=xt(),this.h()},l(z){h=je(z,"LI",{class:!0});var M=Ne(h);d=je(M,"DIV",{class:!0}),Ne(d).forEach(ae),p=wt(M),y=je(M,"SPAN",{});var F=Ne(y);a=qt(F,v),F.forEach(ae),T=wt(M),M.forEach(ae),this.h()},h(){oe(d,"class","legend-vis "+(u[20]==0?"bar":"bar2")+" svelte-sk00pb"),oe(h,"class","svelte-sk00pb")},m(z,M){Be(z,h,M),Ie(h,d),Ie(h,p),Ie(h,y),Ie(y,a),Ie(h,T)},p(z,M){M&32&&v!==(v=z[15]+"")&&Rr(a,v)},d(z){z&&ae(h)}}}function gm(u){let h,d=`${u[4](u[18][u[0]])}%`,p,y,v=vm(u[18][u[0]])+"",a,T,z=`calc(${u[4](u[18][u[0]])}% + 2px)`;function M(){u[12].call(y,u[19],u[20])}return{c(){h=qe("div"),p=xt(),y=qe("div"),a=Vt(v),this.h()},l(F){h=je(F,"DIV",{class:!0}),Ne(h).forEach(ae),p=wt(F),y=je(F,"DIV",{class:!0});var D=Ne(y);a=qt(D,v),D.forEach(ae),this.h()},h(){oe(h,"class",Ah(u[20]==0?"bar":"bar2")+" svelte-sk00pb"),Xe(h,"left","0"),Xe(h,"width",d),Xe(h,"top",u[20]==0?"0":"50%"),Xe(h,"height",u[5][1]?"50%":"100%"),oe(y,"class","label svelte-sk00pb"),Gu(()=>M.call(y)),Xe(y,"left",z),Xe(y,"top",u[20]==0?"0":"50%"),Xe(y,"height","50%")},m(F,D){Be(F,h,D),Be(F,p,D),Be(F,y,D),Ie(y,a),T=Ku(y,M.bind(y))},p(F,D){u=F,D&25&&d!==(d=`${u[4](u[18][u[0]])}%`)&&Xe(h,"width",d),D&32&&Xe(h,"height",u[5][1]?"50%":"100%"),D&9&&v!==(v=vm(u[18][u[0]])+"")&&Rr(a,v),D&25&&z!==(z=`calc(${u[4](u[18][u[0]])}% + 2px)`)&&Xe(y,"left",z)},d(F){F&&ae(h),F&&ae(p),F&&ae(y),T()}}}function _m(u){let h,d=u[15].label+"",p,y,v,a,T=`${u[5][1]?u[1]*2:u[1]}px`,z=`calc(100% - ${u[2]}px)`,M=u[15].values,F=[];for(let D=0;D<M.length;D+=1)F[D]=gm(fm(u,M,D));return{c(){h=qe("div"),p=Vt(d),y=xt(),v=qe("div");for(let D=0;D<F.length;D+=1)F[D].c();a=xt(),this.h()},l(D){h=je(D,"DIV",{class:!0});var L=Ne(h);p=qt(L,d),L.forEach(ae),y=wt(D),v=je(D,"DIV",{class:!0});var X=Ne(v);for(let ne=0;ne<F.length;ne+=1)F[ne].l(X);a=wt(X),X.forEach(ae),this.h()},h(){oe(h,"class","label-group svelte-sk00pb"),oe(v,"class","bar-group svelte-sk00pb"),Xe(v,"height",T),Xe(v,"width",z)},m(D,L){Be(D,h,L),Ie(h,p),Be(D,y,L),Be(D,v,L);for(let X=0;X<F.length;X+=1)F[X]&&F[X].m(v,null);Ie(v,a)},p(D,L){if(L&8&&d!==(d=D[15].label+"")&&Rr(p,d),L&57){M=D[15].values;let X;for(X=0;X<M.length;X+=1){const ne=fm(D,M,X);F[X]?F[X].p(ne,L):(F[X]=gm(ne),F[X].c(),F[X].m(v,a))}for(;X<F.length;X+=1)F[X].d(1);F.length=M.length}L&34&&T!==(T=`${D[5][1]?D[1]*2:D[1]}px`)&&Xe(v,"height",T),L&4&&z!==(z=`calc(100% - ${D[2]}px)`)&&Xe(v,"width",z)},d(D){D&&ae(h),D&&ae(y),D&&ae(v),on(F,D)}}}function H0(u){let h,d,p=u[5][1]&&mm(u),y=u[3],v=[];for(let a=0;a<y.length;a+=1)v[a]=_m(pm(u,y,a));return{c(){p&&p.c(),h=xt();for(let a=0;a<v.length;a+=1)v[a].c();d=sr()},l(a){p&&p.l(a),h=wt(a);for(let T=0;T<v.length;T+=1)v[T].l(a);d=sr()},m(a,T){p&&p.m(a,T),Be(a,h,T);for(let z=0;z<v.length;z+=1)v[z]&&v[z].m(a,T);Be(a,d,T)},p(a,[T]){if(a[5][1]?p?p.p(a,T):(p=mm(a),p.c(),p.m(h.parentNode,h)):p&&(p.d(1),p=null),T&63){y=a[3];let z;for(z=0;z<y.length;z+=1){const M=pm(a,y,z);v[z]?v[z].p(M,T):(v[z]=_m(M),v[z].c(),v[z].m(d.parentNode,d))}for(;z<v.length;z+=1)v[z].d(1);v.length=y.length}},i:li,o:li,d(a){p&&p.d(a),a&&ae(h),on(v,a),a&&ae(d)}}}function vm(u){let h;return u<1?h="<1%":h=u.toFixed(0)+"%",h}function X0(u,h,d){let p,y,v,a,{data:T}=h,{xKey:z="perc"}=h,{yKey:M="category"}=h,{zKey:F="ni"}=h,{formatTick:D=de=>Math.round(de)}=h,{suffix:L="%"}=h,{barHeight:X=20}=h,{margin:ne=30}=h;function ce(de,we){let Ke={};for(const Me of de)Ke[Me[we]]||(Ke[Me[we]]={label:Me[we],values:[]}),Ke[Me[we]].values.push(Me);let ut=[];for(const Me in Ke)ut.push(Ke[Me]);return ut}function ve(de,we){de[we].width=this.clientWidth,d(3,a),d(6,T),d(7,M)}return u.$$set=de=>{"data"in de&&d(6,T=de.data),"xKey"in de&&d(0,z=de.xKey),"yKey"in de&&d(7,M=de.yKey),"zKey"in de&&d(8,F=de.zKey),"formatTick"in de&&d(9,D=de.formatTick),"suffix"in de&&d(10,L=de.suffix),"barHeight"in de&&d(1,X=de.barHeight),"margin"in de&&d(2,ne=de.margin)},u.$$.update=()=>{u.$$.dirty&65&&d(11,p=[0,Math.max(...T.map(de=>de[z]))]),u.$$.dirty&192&&T.map(de=>de[M]).filter((de,we,Ke)=>Ke.indexOf(de)===we),u.$$.dirty&320&&d(5,y=T.map(de=>de[F]).filter((de,we,Ke)=>Ke.indexOf(de)===we)),u.$$.dirty&2048&&d(4,v=de=>de/p[1]*100),u.$$.dirty&192&&d(3,a=ce(T,M))},[z,X,ne,a,v,y,T,M,F,D,L,p,ve]}class Bh extends fn{constructor(h){super(),dn(this,h,X0,H0,mn,{data:6,xKey:0,yKey:7,zKey:8,formatTick:9,suffix:10,barHeight:1,margin:2})}}function bm(u,h,d){const p=u.slice();return p[14]=h[d],p}function xm(u,h,d){const p=u.slice();return p[17]=h[d],p[19]=d,p}function wm(u,h,d){const p=u.slice();return p[17]=h[d],p[19]=d,p}function Sm(u,h,d){const p=u.slice();return p[14]=h[d],p[19]=d,p}function km(u){let h,d=u[7],p=[];for(let y=0;y<d.length;y+=1)p[y]=Em(Sm(u,d,y));return{c(){h=qe("ul");for(let y=0;y<p.length;y+=1)p[y].c();this.h()},l(y){h=je(y,"UL",{class:!0});var v=Ne(h);for(let a=0;a<p.length;a+=1)p[a].l(v);v.forEach(ae),this.h()},h(){oe(h,"class","legend svelte-1hk4284")},m(y,v){Be(y,h,v);for(let a=0;a<p.length;a+=1)p[a]&&p[a].m(h,null)},p(y,v){if(v&144){d=y[7];let a;for(a=0;a<d.length;a+=1){const T=Sm(y,d,a);p[a]?p[a].p(T,v):(p[a]=Em(T),p[a].c(),p[a].m(h,null))}for(;a<p.length;a+=1)p[a].d(1);p.length=d.length}},d(y){y&&ae(h),on(p,y)}}}function Em(u){let h,d,p,y,v=u[14]+"",a,T;return{c(){h=qe("li"),d=qe("div"),p=xt(),y=qe("span"),a=Vt(v),T=xt(),this.h()},l(z){h=je(z,"LI",{class:!0});var M=Ne(h);d=je(M,"DIV",{class:!0}),Ne(d).forEach(ae),p=wt(M),y=je(M,"SPAN",{class:!0});var F=Ne(y);a=qt(F,v),F.forEach(ae),T=wt(M),M.forEach(ae),this.h()},h(){oe(d,"class","legend-vis "+(u[19]==0?"bar":"marker")+" svelte-1hk4284"),Xe(d,"height","1rem"),Xe(d,"width",u[19]==0?"1rem":u[4]+"px"),oe(y,"class",Ah(u[19]==0?"bold":"brackets")+" svelte-1hk4284"),oe(h,"class","svelte-1hk4284")},m(z,M){Be(z,h,M),Ie(h,d),Ie(h,p),Ie(h,y),Ie(y,a),Ie(h,T)},p(z,M){M&16&&Xe(d,"width",z[19]==0?"1rem":z[4]+"px"),M&128&&v!==(v=z[14]+"")&&Rr(a,v)},d(z){z&&ae(h)}}}function zm(u){let h,d=u[1](u[17].perc/100)+"",p,y;return{c(){h=qe("span"),p=Vt(d),y=Vt(u[2]),this.h()},l(v){h=je(v,"SPAN",{class:!0,style:!0});var a=Ne(h);p=qt(a,d),y=qt(a,u[2]),a.forEach(ae),this.h()},h(){oe(h,"class",Ah(u[19]==0?"bold":"sml brackets")+" svelte-1hk4284"),Xe(h,"color",u[19]==0?"#000000":"#1460aa")},m(v,a){Be(v,h,a),Ie(h,p),Ie(h,y)},p(v,a){a&34&&d!==(d=v[1](v[17].perc/100)+"")&&Rr(p,d),a&4&&Rr(y,v[2])},d(v){v&&ae(h)}}}function W0(u){let h,d=`calc(${u[6](u[17][u[0]])}% - ${u[4]/2}px)`,p=`${u[4]}px`;return{c(){h=qe("div"),this.h()},l(y){h=je(y,"DIV",{class:!0}),Ne(h).forEach(ae),this.h()},h(){oe(h,"class","marker svelte-1hk4284"),Xe(h,"left",d),Xe(h,"border-left-width",p)},m(y,v){Be(y,h,v)},p(y,v){v&113&&d!==(d=`calc(${y[6](y[17][y[0]])}% - ${y[4]/2}px)`)&&Xe(h,"left",d),v&16&&p!==(p=`${y[4]}px`)&&Xe(h,"border-left-width",p)},d(y){y&&ae(h)}}}function Y0(u){let h,d=`${u[6](u[17][u[0]])}%`;return{c(){h=qe("div"),this.h()},l(p){h=je(p,"DIV",{class:!0}),Ne(h).forEach(ae),this.h()},h(){oe(h,"class","bar svelte-1hk4284"),Xe(h,"left","0"),Xe(h,"width",d)},m(p,y){Be(p,h,y)},p(p,y){y&97&&d!==(d=`${p[6](p[17][p[0]])}%`)&&Xe(h,"width",d)},d(p){p&&ae(h)}}}function Tm(u){let h;function d(v,a){return v[19]==0?Y0:W0}let y=d(u)(u);return{c(){y.c(),h=sr()},l(v){y.l(v),h=sr()},m(v,a){y.m(v,a),Be(v,h,a)},p(v,a){y.p(v,a)},d(v){y.d(v),v&&ae(h)}}}function Im(u){let h,d=u[14].label+"",p,y,v,a,T,z=`${u[3]}px`,M=u[14].values,F=[];for(let X=0;X<M.length;X+=1)F[X]=zm(wm(u,M,X));let D=u[14].values,L=[];for(let X=0;X<D.length;X+=1)L[X]=Tm(xm(u,D,X));return{c(){h=qe("div"),p=Vt(d),y=xt();for(let X=0;X<F.length;X+=1)F[X].c();v=xt(),a=qe("div");for(let X=0;X<L.length;X+=1)L[X].c();T=xt(),this.h()},l(X){h=je(X,"DIV",{class:!0});var ne=Ne(h);p=qt(ne,d),y=wt(ne);for(let ve=0;ve<F.length;ve+=1)F[ve].l(ne);ne.forEach(ae),v=wt(X),a=je(X,"DIV",{class:!0});var ce=Ne(a);for(let ve=0;ve<L.length;ve+=1)L[ve].l(ce);T=wt(ce),ce.forEach(ae),this.h()},h(){oe(h,"class","label-group svelte-1hk4284"),oe(a,"class","bar-group svelte-1hk4284"),Xe(a,"height",z)},m(X,ne){Be(X,h,ne),Ie(h,p),Ie(h,y);for(let ce=0;ce<F.length;ce+=1)F[ce]&&F[ce].m(h,null);Be(X,v,ne),Be(X,a,ne);for(let ce=0;ce<L.length;ce+=1)L[ce]&&L[ce].m(a,null);Ie(a,T)},p(X,ne){if(ne&32&&d!==(d=X[14].label+"")&&Rr(p,d),ne&38){M=X[14].values;let ce;for(ce=0;ce<M.length;ce+=1){const ve=wm(X,M,ce);F[ce]?F[ce].p(ve,ne):(F[ce]=zm(ve),F[ce].c(),F[ce].m(h,null))}for(;ce<F.length;ce+=1)F[ce].d(1);F.length=M.length}if(ne&113){D=X[14].values;let ce;for(ce=0;ce<D.length;ce+=1){const ve=xm(X,D,ce);L[ce]?L[ce].p(ve,ne):(L[ce]=Tm(ve),L[ce].c(),L[ce].m(a,T))}for(;ce<L.length;ce+=1)L[ce].d(1);L.length=D.length}ne&8&&z!==(z=`${X[3]}px`)&&Xe(a,"height",z)},d(X){X&&ae(h),on(F,X),X&&ae(v),X&&ae(a),on(L,X)}}}function J0(u){let h,d,p=u[7][1]&&km(u),y=u[5],v=[];for(let a=0;a<y.length;a+=1)v[a]=Im(bm(u,y,a));return{c(){p&&p.c(),h=xt();for(let a=0;a<v.length;a+=1)v[a].c();d=sr()},l(a){p&&p.l(a),h=wt(a);for(let T=0;T<v.length;T+=1)v[T].l(a);d=sr()},m(a,T){p&&p.m(a,T),Be(a,h,T);for(let z=0;z<v.length;z+=1)v[z]&&v[z].m(a,T);Be(a,d,T)},p(a,[T]){if(a[7][1]?p?p.p(a,T):(p=km(a),p.c(),p.m(h.parentNode,h)):p&&(p.d(1),p=null),T&127){y=a[5];let z;for(z=0;z<y.length;z+=1){const M=bm(a,y,z);v[z]?v[z].p(M,T):(v[z]=Im(M),v[z].c(),v[z].m(d.parentNode,d))}for(;z<v.length;z+=1)v[z].d(1);v.length=y.length}},i:li,o:li,d(a){p&&p.d(a),a&&ae(h),on(v,a),a&&ae(d)}}}function Q0(u,h,d){let p,y,v,a,{data:T}=h,{xKey:z="perc"}=h,{yKey:M="category"}=h,{zKey:F="group"}=h,{formatTick:D=ve=>Math.round(100*ve)}=h,{suffix:L="%"}=h,{barHeight:X=25}=h,{markerWidth:ne=3}=h;function ce(ve,de){let we={};for(const ut of ve)we[ut[de]]||(we[ut[de]]={label:ut[de],values:[]}),we[ut[de]].values.push(ut);let Ke=[];for(const ut in we)Ke.push(we[ut]);return Ke}return u.$$set=ve=>{"data"in ve&&d(8,T=ve.data),"xKey"in ve&&d(0,z=ve.xKey),"yKey"in ve&&d(9,M=ve.yKey),"zKey"in ve&&d(10,F=ve.zKey),"formatTick"in ve&&d(1,D=ve.formatTick),"suffix"in ve&&d(2,L=ve.suffix),"barHeight"in ve&&d(3,X=ve.barHeight),"markerWidth"in ve&&d(4,ne=ve.markerWidth)},u.$$.update=()=>{u.$$.dirty&257&&d(11,p=[0,Math.max(...T.map(ve=>ve[z]))]),u.$$.dirty&768&&T.map(ve=>ve[M]).filter((ve,de,we)=>we.indexOf(ve)===de),u.$$.dirty&1280&&d(7,y=T.map(ve=>ve[F]).filter((ve,de,we)=>we.indexOf(ve)===de)),u.$$.dirty&2048&&d(6,v=ve=>ve/p[1]*100),u.$$.dirty&768&&d(5,a=ce(T,M))},[z,D,L,X,ne,a,v,y,T,M,F,p]}class Oh extends fn{constructor(h){super(),dn(this,h,Q0,J0,mn,{data:8,xKey:0,yKey:9,zKey:10,formatTick:1,suffix:2,barHeight:3,markerWidth:4})}}function Am(u,h,d){const p=u.slice();return p[12]=h[d],p[14]=d,p}function Pm(u,h,d){const p=u.slice();return p[15]=h[d],p[17]=d,p}function Cm(u,h,d){const p=u.slice();return p[15]=h[d],p[17]=d,p}function Mm(u,h,d){const p=u.slice();return p[19]=h[d],p[14]=d,p}function Dm(u){let h,d=u[5],p=[];for(let y=0;y<d.length;y+=1)p[y]=Lm(Mm(u,d,y));return{c(){h=qe("ul");for(let y=0;y<p.length;y+=1)p[y].c();this.h()},l(y){h=je(y,"UL",{class:!0});var v=Ne(h);for(let a=0;a<p.length;a+=1)p[a].l(v);v.forEach(ae),this.h()},h(){oe(h,"class","legend svelte-pmaxst")},m(y,v){Be(y,h,v);for(let a=0;a<p.length;a+=1)p[a]&&p[a].m(h,null)},p(y,v){if(v&36){d=y[5];let a;for(a=0;a<d.length;a+=1){const T=Mm(y,d,a);p[a]?p[a].p(T,v):(p[a]=Lm(T),p[a].c(),p[a].m(h,null))}for(;a<p.length;a+=1)p[a].d(1);p.length=d.length}},d(y){y&&ae(h),on(p,y)}}}function Lm(u){let h,d,p,y,v=u[19]+"",a,T;return{c(){h=qe("li"),d=qe("div"),p=xt(),y=qe("span"),a=Vt(v),T=xt(),this.h()},l(z){h=je(z,"LI",{class:!0});var M=Ne(h);d=je(M,"DIV",{class:!0}),Ne(d).forEach(ae),p=wt(M),y=je(M,"SPAN",{class:!0});var F=Ne(y);a=qt(F,v),F.forEach(ae),T=wt(M),M.forEach(ae),this.h()},h(){oe(d,"class","legend-vis "+(u[14]==0?"bar":"markerSmall")+" svelte-pmaxst"),Xe(d,"height","1rem"),Xe(d,"width",u[14]==0?"1rem":u[2]+"px"),oe(y,"class",Ah(u[14]==0?"bold":"brackets")+" svelte-pmaxst"),oe(h,"class","svelte-pmaxst")},m(z,M){Be(z,h,M),Ie(h,d),Ie(h,p),Ie(h,y),Ie(y,a),Ie(h,T)},p(z,M){M&4&&Xe(d,"width",z[14]==0?"1rem":z[2]+"px"),M&32&&v!==(v=z[19]+"")&&Rr(a,v)},d(z){z&&ae(h)}}}function $0(u){let h,d=u[12].values,p=[];for(let y=0;y<d.length;y+=1)p[y]=Rm(Pm(u,d,y));return{c(){for(let y=0;y<p.length;y+=1)p[y].c();h=sr()},l(y){for(let v=0;v<p.length;v+=1)p[v].l(y);h=sr()},m(y,v){for(let a=0;a<p.length;a+=1)p[a]&&p[a].m(y,v);Be(y,h,v)},p(y,v){if(v&89){d=y[12].values;let a;for(a=0;a<d.length;a+=1){const T=Pm(y,d,a);p[a]?p[a].p(T,v):(p[a]=Rm(T),p[a].c(),p[a].m(h.parentNode,h))}for(;a<p.length;a+=1)p[a].d(1);p.length=d.length}},d(y){on(p,y),y&&ae(h)}}}function e1(u){let h,d=u[12].values,p=[];for(let y=0;y<d.length;y+=1)p[y]=Bm(Cm(u,d,y));return{c(){for(let y=0;y<p.length;y+=1)p[y].c();h=sr()},l(y){for(let v=0;v<p.length;v+=1)p[v].l(y);h=sr()},m(y,v){for(let a=0;a<p.length;a+=1)p[a]&&p[a].m(y,v);Be(y,h,v)},p(y,v){if(v&89){d=y[12].values;let a;for(a=0;a<d.length;a+=1){const T=Cm(y,d,a);p[a]?p[a].p(T,v):(p[a]=Bm(T),p[a].c(),p[a].m(h.parentNode,h))}for(;a<p.length;a+=1)p[a].d(1);p.length=d.length}},d(y){on(p,y),y&&ae(h)}}}function Rm(u){let h,d,p=`calc(100% - ${u[15].offset<0?u[4](u[15][u[0]]-u[15].offset):u[4](u[15][u[0]])}%)`,y=`${u[4](u[15].offset)}%`,v=`${u[17]/u[6].length*100}%`,a=`${1/u[6].length*100}%`;return{c(){h=qe("div"),this.h()},l(T){h=je(T,"DIV",{class:!0,style:!0}),Ne(h).forEach(ae),this.h()},h(){oe(h,"class","marker svelte-pmaxst"),oe(h,"style",d="border-"+(u[15].offset<0?"top":"bottom")+": none"),Xe(h,"top",p),Xe(h,"height",y),Xe(h,"left",v),Xe(h,"width",a)},m(T,z){Be(T,h,z)},p(T,z){z&8&&d!==(d="border-"+(T[15].offset<0?"top":"bottom")+": none")&&oe(h,"style",d);const M=z&8;(M||z&25&&p!==(p=`calc(100% - ${T[15].offset<0?T[4](T[15][T[0]]-T[15].offset):T[4](T[15][T[0]])}%)`))&&Xe(h,"top",p),(M||z&24&&y!==(y=`${T[4](T[15].offset)}%`))&&Xe(h,"height",y),(M||z&72&&v!==(v=`${T[17]/T[6].length*100}%`))&&Xe(h,"left",v),(M||z&72&&a!==(a=`${1/T[6].length*100}%`))&&Xe(h,"width",a)},d(T){T&&ae(h)}}}function Bm(u){let h,d=`${100-u[4](u[15][u[0]])}%`,p=`${u[4](u[15][u[0]])}%`,y=`${u[17]/u[6].length*100}%`,v=`calc(${1/u[6].length*100}% - 2px)`;return{c(){h=qe("div"),this.h()},l(a){h=je(a,"DIV",{class:!0}),Ne(h).forEach(ae),this.h()},h(){oe(h,"class","bar svelte-pmaxst"),Xe(h,"top",d),Xe(h,"height",p),Xe(h,"left",y),Xe(h,"width",v)},m(a,T){Be(a,h,T)},p(a,T){T&25&&d!==(d=`${100-a[4](a[15][a[0]])}%`)&&Xe(h,"top",d),T&25&&p!==(p=`${a[4](a[15][a[0]])}%`)&&Xe(h,"height",p),T&64&&y!==(y=`${a[17]/a[6].length*100}%`)&&Xe(h,"left",y),T&64&&v!==(v=`calc(${1/a[6].length*100}% - 2px)`)&&Xe(h,"width",v)},d(a){a&&ae(h)}}}function Om(u){let h;function d(v,a){return v[14]==0?e1:$0}let y=d(u)(u);return{c(){y.c(),h=sr()},l(v){y.l(v),h=sr()},m(v,a){y.m(v,a),Be(v,h,a)},p(v,a){y.p(v,a)},d(v){y.d(v),v&&ae(h)}}}function t1(u){let h,d,p=`${u[1]}px`,y,v,a,T,z,M,F,D,L,X,ne,ce,ve,de,we=u[5][1]&&Dm(u),Ke=u[3],ut=[];for(let Me=0;Me<Ke.length;Me+=1)ut[Me]=Om(Am(u,Ke,Me));return{c(){we&&we.c(),h=xt(),d=qe("div");for(let Me=0;Me<ut.length;Me+=1)ut[Me].c();y=xt(),v=qe("div"),a=qe("div"),T=qe("div"),z=Vt("0-14"),M=xt(),F=qe("div"),D=Vt("15-39"),L=xt(),X=qe("div"),ne=Vt("40-64"),ce=xt(),ve=qe("div"),de=Vt("65+"),this.h()},l(Me){we&&we.l(Me),h=wt(Me),d=je(Me,"DIV",{class:!0});var Ye=Ne(d);for(let yt=0;yt<ut.length;yt+=1)ut[yt].l(Ye);Ye.forEach(ae),y=wt(Me),v=je(Me,"DIV",{class:!0});var vt=Ne(v);a=je(vt,"DIV",{class:!0});var Ue=Ne(a);T=je(Ue,"DIV",{class:!0});var ct=Ne(T);z=qt(ct,"0-14"),ct.forEach(ae),M=wt(Ue),F=je(Ue,"DIV",{class:!0});var mt=Ne(F);D=qt(mt,"15-39"),mt.forEach(ae),L=wt(Ue),X=je(Ue,"DIV",{class:!0});var Ze=Ne(X);ne=qt(Ze,"40-64"),Ze.forEach(ae),ce=wt(Ue),ve=je(Ue,"DIV",{class:!0});var Ft=Ne(ve);de=qt(Ft,"65+"),Ft.forEach(ae),Ue.forEach(ae),vt.forEach(ae),this.h()},h(){oe(d,"class","bar-group svelte-pmaxst"),Xe(d,"height",p),oe(T,"class","column svelte-pmaxst"),oe(F,"class","column svelte-pmaxst"),oe(X,"class","column svelte-pmaxst"),oe(ve,"class","column svelte-pmaxst"),oe(a,"class","row svelte-pmaxst"),Xe(a,"width","100%"),oe(v,"class","x-scale svelte-pmaxst")},m(Me,Ye){we&&we.m(Me,Ye),Be(Me,h,Ye),Be(Me,d,Ye);for(let vt=0;vt<ut.length;vt+=1)ut[vt]&&ut[vt].m(d,null);Be(Me,y,Ye),Be(Me,v,Ye),Ie(v,a),Ie(a,T),Ie(T,z),Ie(a,M),Ie(a,F),Ie(F,D),Ie(a,L),Ie(a,X),Ie(X,ne),Ie(a,ce),Ie(a,ve),Ie(ve,de)},p(Me,[Ye]){if(Me[5][1]?we?we.p(Me,Ye):(we=Dm(Me),we.c(),we.m(h.parentNode,h)):we&&(we.d(1),we=null),Ye&89){Ke=Me[3];let vt;for(vt=0;vt<Ke.length;vt+=1){const Ue=Am(Me,Ke,vt);ut[vt]?ut[vt].p(Ue,Ye):(ut[vt]=Om(Ue),ut[vt].c(),ut[vt].m(d,null))}for(;vt<ut.length;vt+=1)ut[vt].d(1);ut.length=Ke.length}Ye&2&&p!==(p=`${Me[1]}px`)&&Xe(d,"height",p)},i:li,o:li,d(Me){we&&we.d(Me),Me&&ae(h),Me&&ae(d),on(ut,Me),Me&&ae(y),Me&&ae(v)}}}function r1(u,h,d){let p,y,v,a,T,{data:z}=h,{xKey:M="category"}=h,{yKey:F="perc"}=h,{zKey:D="group"}=h,{height:L=100}=h,{markerWidth:X=3}=h;function ne(ce,ve){let de={};for(const Ke of ce){de[Ke[ve]]||(de[Ke[ve]]={label:Ke[ve],values:[]});let ut=de[Ke[ve]].values.length,Me=ut==0?0:Ke[F]-de[Ke[ve]].values[ut-1][F];de[Ke[ve]].values.push({...Ke,offset:Me})}let we=[];for(const Ke in de)we.push(de[Ke]);return console.log(we),we}return u.$$set=ce=>{"data"in ce&&d(7,z=ce.data),"xKey"in ce&&d(8,M=ce.xKey),"yKey"in ce&&d(0,F=ce.yKey),"zKey"in ce&&d(9,D=ce.zKey),"height"in ce&&d(1,L=ce.height),"markerWidth"in ce&&d(2,X=ce.markerWidth)},u.$$.update=()=>{u.$$.dirty&384&&d(6,p=z.map(ce=>ce[M]).filter((ce,ve,de)=>de.indexOf(ce)===ve)),u.$$.dirty&129&&d(10,y=[0,Math.max(...z.map(ce=>ce[F]))]),u.$$.dirty&640&&d(5,v=z.map(ce=>ce[D]).filter((ce,ve,de)=>de.indexOf(ce)===ve)),u.$$.dirty&1024&&d(4,a=ce=>Math.abs(ce/y[1])*100),u.$$.dirty&640&&d(3,T=ne(z,D))},[F,L,X,T,a,v,p,z,M,D,y]}class Fh extends fn{constructor(h){super(),dn(this,h,r1,t1,mn,{data:7,xKey:8,yKey:0,zKey:9,height:1,markerWidth:2})}}function i1(u){let h,d,p,y;return{c(){h=qe("div"),d=Vt("Back to top"),this.h()},l(v){h=je(v,"DIV",{class:!0});var a=Ne(h);d=qt(a,"Back to top"),a.forEach(ae),this.h()},h(){oe(h,"class","back_to_start svelte-11zibd5"),ns(h,"hidden",u[0])},m(v,a){Be(v,h,a),Ie(h,d),p||(y=[bd(window,"scroll",u[2]),bd(h,"click",u[1])],p=!0)},p(v,[a]){a&1&&ns(h,"hidden",v[0])},i:li,o:li,d(v){v&&ae(h),p=!1,c_(y)}}}function n1(u,h,d){let{buttonVisibleOnPX:p=200}=h,y=!0;const v=()=>{document.body.scrollIntoView()},a=()=>document.documentElement||document.body,T=()=>{a().scrollTop>p?d(0,y=!1):d(0,y=!0)};return u.$$set=z=>{"buttonVisibleOnPX"in z&&d(3,p=z.buttonVisibleOnPX)},[y,v,T,p]}class a1 extends fn{constructor(h){super(),dn(this,h,n1,i1,mn,{buttonVisibleOnPX:3})}}function o1(u){let h,d,p=u[1][u[0]].title+"",y,v,a,T,z,M,F,D=u[1][u[0]].info+"",L;return{c(){h=qe("div"),d=qe("div"),y=Vt(p),v=qe("span"),z=xt(),M=qe("div"),F=qe("div"),this.h()},l(X){h=je(X,"DIV",{class:!0,style:!0,"data-bs-toggle":!0,"data-bs-target":!0,"aria-expanded":!0,"aria-controls":!0});var ne=Ne(h);d=je(ne,"DIV",{class:!0,style:!0});var ce=Ne(d);y=qt(ce,p),v=je(ce,"SPAN",{class:!0}),Ne(v).forEach(ae),ce.forEach(ae),ne.forEach(ae),z=wt(X),M=je(X,"DIV",{class:!0,id:!0});var ve=Ne(M);F=je(ve,"DIV",{class:!0});var de=Ne(F);de.forEach(ae),ve.forEach(ae),this.h()},h(){oe(v,"class","i-button"),oe(d,"class","blocktitle"),Xe(d,"margin","0"),Xe(d,"width","100%"),oe(h,"class","row"),Xe(h,"display","flex"),Xe(h,"cursor","pointer"),oe(h,"data-bs-toggle","collapse"),oe(h,"data-bs-target",a="#"+u[0]+"-info"),oe(h,"aria-expanded","false"),oe(h,"aria-controls",T=u[0]+"-info"),oe(F,"class","card card-body svelte-1qrf6oz"),oe(M,"class","collapse svelte-1qrf6oz"),oe(M,"id",L=u[0]+"-info")},m(X,ne){Be(X,h,ne),Ie(h,d),Ie(d,y),Ie(d,v),Be(X,z,ne),Be(X,M,ne),Ie(M,F),F.innerHTML=D},p(X,[ne]){ne&1&&p!==(p=X[1][X[0]].title+"")&&Rr(y,p),ne&1&&a!==(a="#"+X[0]+"-info")&&oe(h,"data-bs-target",a),ne&1&&T!==(T=X[0]+"-info")&&oe(h,"aria-controls",T),ne&1&&D!==(D=X[1][X[0]].info+"")&&(F.innerHTML=D),ne&1&&L!==(L=X[0]+"-info")&&oe(M,"id",L)},i:li,o:li,d(X){X&&ae(h),X&&ae(z),X&&ae(M)}}}function s1(u,h,d){let{id:p}=h,{place:y}=h;function v(T){let M=T.replaceAll("[",".").replaceAll("]","").split("."),F=y.meta_data;for(let D=0;D<M.length;D++)if(F.hasOwnProperty(M[D])&&(F=F[M[D]],M[D]=="last_updated")){let L=F.split("-");F=L[2]+"/"+L[1]+"/"+L[0]}return F}let a={location:{title:"About the area",info:"Information about the area including its geographical hierarchy."},area:{title:"Area",info:"Area is measured in hectares (ha), it is rounded to the nearest whole number."},popden:{title:"Population density",info:"Population density is the number of usual residents per hectare. It is rounded to 1 d.p."},pop:{title:"Population",info:"Population is based on the number of usual residents. <p>From Census 2021 data - <a href='https://explore.nisra.gov.uk/area-explorer-2021/'><strong>Census Area Explorer</strong></a></p>A usual resident is anyone who, on 21 March 2021 is in the UK, and staying in the UK for a period of 3 months or more; or has a permanent UK address and is outside the UK and is staying outside the UK for less than 12 months. <a href='https://www.nisra.gov.uk/publications/census-2021-statistical-bulletins'><strong>Statistical bulletins</strong></a>"},generalhealth:{title:"General Health",info:"<p>From Census 2021 data - <a href='https://explore.nisra.gov.uk/area-explorer-2021/'><strong>Census Area Explorer</strong></a></p>General health is a self-assessment of a person's general state of health. It is not based over any specified period of time. <a href='https://www.nisra.gov.uk/publications/census-2021-statistical-bulletins'><strong>Statistical bulletins</strong></a>"},wellbeing:{title:"Personal Wellbeing",info:"Average Happiness score out of 10 for people aged 16+</p>Average Life satisfaction score out of 10 for people aged 16+</p><p class = 'pibutton'>Access data at: <a href='"+v("Happy[0].dataset_url")+"'>"+v("Happy[0].title")+"</a></p><p class = 'pibutton'>Last updated: "+v("Happy[0].last_updated")+"</p> <p class = 'pibutton'><a href='mailto:"+v("Happy[0].email")+"'>Email for more information</a> </p>"},lifeexpectancy:{title:"Life Expectancy at birth",info:"<p class = 'pibutton'>Access data at: <a href='"+v("LE[0].dataset_url")+"'>"+v("LE[0].title")+"</a></p><p class = 'pibutton'>Last updated: "+v("LE[0].last_updated")+"</p> <p class = 'pibutton'><a href='mailto:"+v("LE[0].email")+"'>Email for more information</a> </p>"},carers:{title:"Unpaid care giving",info:"<p>From Census 2021 data - <a href='https://explore.nisra.gov.uk/area-explorer-2021/'><strong>Census Area Explorer</strong></a></p>Unpaid care covers looking after giving help or support to anyone because they have long-term physical or mental health conditions or illnesses, or problems related to old age. It does not include any activities as part of paid employment. All unpaid care statistics are restricted to persons aged 5 and over. <a href='https://www.nisra.gov.uk/publications/census-2021-statistical-bulletins'><strong>Statistical bulletins</strong></a>"},hospitalactivity:{title:"Annual admissions to hospital",info:"<p class = 'pibutton'>Access data at: <a href='"+v("Admiss[0].dataset_url")+"'>"+v("Admiss[0].title")+"</a></p><p class = 'pibutton'>Last updated: "+v("Admiss[0].last_updated")+"</p> <p class = 'pibutton'><a href='mailto:"+v("Admiss[0].email")+"'>Email for more information</a> </p>"},primarycare:{title:"Primary care providers",info:"<p class = 'pibutton'>Access data at: <a href='"+v("GP[0].dataset_url")+"'>"+v("GP[0].title")+"</a>, <a href='"+v("DEN[0].dataset_url")+"'>"+v("DEN[0].title")+"</a> and <a href='"+v("DEN_REG[0].dataset_url")+"'>"+v("DEN_REG[0].title")+"</a></p>"},employmentrates:{title:"Work status of adults",info:"<p class = 'pibutton'>Access data at: <a href='"+v("LMS[0].dataset_url")+"'>"+v("LMS[0].title")+"</a></p><p class = 'pibutton'>Last updated: "+v("LMS[0].last_updated")+"</p> <p class = 'pibutton'><a href='mailto:"+v("LMS[0].email")+"'>Email for more information</a> </p><p>Inactive includes students, early retirees, or people looking after a home, who are long-term sick or disabled. </p>"},employed:{title:"Number of people employed",info:" <p class = 'pibutton'>Access data at: <a href='"+v("LMS[0].dataset_url")+"'>"+v("LMS[0].title")+"</a></p><p class = 'pibutton'>Last updated: "+v("LMS[0].last_updated")+"</p><p class = 'pibutton'><a href='mailto:"+v("LMS[0].email")+"'>Email for more information</a> </p>"},wages:{title:"Average annual wage",info:"<p class = 'pibutton'>Access data at: <a href='"+v("ASHE[0].dataset_url")+"'>"+v("ASHE[0].title")+"</a></p><p class = 'pibutton'>Last updated: "+v("ASHE[0].last_updated")+"</p> <p class = 'pibutton'><a href='mailto:"+v("ASHE[0].email")+"'>Email for more information</a> </p><p>Median is the ..... </p>"},bres:{title:"Type of work",info:"<p class = 'pibutton'>Access data at: <a href='"+v("BRES[0].dataset_url")+"'>"+v("BRES[0].title")+"</a></p><p class = 'pibutton'>Last updated: "+v("BRES[0].last_updated")+"</p><p class = 'pibutton'><a href='mailto:"+v("BRES[0].email")+"'>Email for more information</a> </p>"},pensionagebenefits:{title:"Pension Age benefits",info:"Benefits included are: SP and PC<p class = 'pibutton'>Access data at: <a href='"+v("BS[0].dataset_url")+"'>"+v("BS[0].title")+"</a></p><p class = 'pibutton'>Last updated: "+v("BS[0].last_updated")+"</p> <p class = 'pibutton'><a href='mailto:"+v("BS[0].email")+"'>Email for more information</a> </p>"},workingagebenefits:{title:"Working Age benefits",info:"Benefits included are: UC, JSA, IS and ESA<p class = 'pibutton'>Access data at: <a href='"+v("BS[0].dataset_url")+"'>"+v("BS[0].title")+"</a></p><p class = 'pibutton'>Last updated: "+v("BS[0].last_updated")+"</p> <p class = 'pibutton'><a href='mailto:"+v("BS[0].email")+"'>Email for more information</a> </p>"},disabilitybenefits:{title:"Disability and Carers benefits",info:"Benefits included are: PIP, CA, AA and DLA<p class = 'pibutton'>Access data at:  <a href='"+v("BS[0].dataset_url")+"'>"+v("BS[0].title")+"</a></p><p class = 'pibutton'>Last updated: "+v("BS[0].last_updated")+"</p> <p class = 'pibutton'><a href='mailto:"+v("BS[0].email")+"'>Email for more information</a> </p>"},enrollments:{title:"People in education",info:"<p class = 'pibutton'>Access data at: <a href='"+v("Primary[0].dataset_url")+"'>"+v("Primary[0].title")+"</a>, <a href='"+v("PostPrimary[0].dataset_url")+"'>"+v("PostPrimary[0].title")+"</a>,  <a href='"+v("FE[0].dataset_url")+"'>"+v("FE[0].title")+"</a> and <a href='"+v("HE[0].dataset_url")+"'>"+v("HE[0].title")+"</a></p>"},fsme:{title:"Pupils entitled to Free School Meals",info:"<p class = 'pibutton'>Access data at: <a href='"+v("Primary[0].dataset_url")+"'>"+v("Primary[0].title")+"</a> and <a href='"+v("PostPrimary[0].dataset_url")+"'>"+v("PostPrimary[0].title")+"</a></p><p class = 'pibutton'>Last updated: "+v("Primary[0].last_updated")+"</p> <p class = 'pibutton'><a href='mailto:"+v("Primary[0].email")+"'>Email for more information</a> </p>"},teachers:{title:"School class size",info:"<p class = 'pibutton'>Access data at: <a href='"+v("ClassSize[0].dataset_url")+"'>"+v("ClassSize[0].title")+"</a></p><p class = 'pibutton'>Last updated: "+v("ClassSize[0].last_updated")+"</p> <p class = 'pibutton'><a href='mailto:"+v("ClassSize[0].email")+"'>Email for more information</a> </p>"},qualifications:{title:"Highest level of qualifications in the population",info:"<p>From Census 2021 data - <a href='https://explore.nisra.gov.uk/area-explorer-2021/'><strong>Census Area Explorer</strong></a></p>Needs tidied up with proper CSS.   The highest level of qualification categories are as follows:No qualifications;Level 1: 1 to 4 GCSEs, O levels, CSEs (any grades); 1 AS Level; NVQ level 1; or equivalent;Level 2: 5 or more GCSEs (A*-C or 9-4), O levels (passes) CSEs (grade 1); 1 A level, 2-3 AS Levels; NVQ level 2, BTEC General, City and Guilds Craft; or equivalent;Apprenticeship; Level 3: 2 or more A Levels, 4 or more AS Levels; NVQ Level 3, BTEC National, OND, ONC, City and Guilds Advanced Craft; or equivalent; Level 4 and above: Degree (BA, BSc), foundation degree, NVQ Level 4 and above, HND, HNC, professional qualifications (teaching or nursing, for example), or equivalent; and Other: Other qualifications, equivalent unknown.Highest level of qualification is derived from the question asking people aged 16 years and over to indicate all qualifications held. For qualifications gained outside Northern Ireland, respondents were directed to select the nearest equivalent."},attainment:{title:"GCSEs for school leavers",info:" <p class = 'pibutton'>Access data at: <a href='"+v("Attainment[0].dataset_url")+"'>"+v("Attainment[0].title")+"</a></p><p class = 'pibutton'>Last updated: "+v("Attainment[0].last_updated")+"</p><p class = 'pibutton'><a href='mailto:"+v("Attainment[0].email")+"'>Email for more information</a> </p>"},empty:{title:"",info:""},destination:{title:"Next steps for school leavers",info:"<p class = 'pibutton'><a href='mailto:"+v("Destination[0].email")+"'>Email for more information</a> </p><p class = 'pibutton'>Last updated: "+v("Destination[0].last_updated")+"</p> <p class = 'pibutton'>Access data at: <a href='"+v("Destination[0].dataset_url")+"'>"+v("Destination[0].title")+"</a></p>"},popchange:{title:"Population change",info:"words to be added"},age:{title:"Age",info:"<p>From Census 2021 data - <a href='https://explore.nisra.gov.uk/area-explorer-2021/'><strong>Census Area Explorer</strong></a></p>A grouping of ages where a person's age is their age at their last birthday on or prior to census day. <a href='https://www.nisra.gov.uk/publications/census-2021-statistical-bulletins'><strong>Statistical bulletins</strong></a>"},sex:{title:"Sex",info:"words to be added"},hhsize:{title:"Household size",info:"<p>From Census 2021 data - <a href='https://explore.nisra.gov.uk/area-explorer-2021/'><strong>Census Area Explorer</strong></a></p>The number of usual residents in the household.      <a href='https://www.nisra.gov.uk/publications/census-2021-statistical-bulletins'><strong>Statistical bulletins</strong></a>"},religion:{title:"Religion, Religion brought up in",info:"<p>From Census 2021 data - <a href='https://explore.nisra.gov.uk/area-explorer-2021/'><strong>Census Area Explorer</strong></a></p>The religious group the person belongs to or for people with no current religion their religious group of upbringing.People with no current religion and no religion of upbringing are labelled 'None'.<a href='https://www.nisra.gov.uk/publications/census-2021-statistical-bulletins'><strong>Statistical bulletins</strong></a>"},language:{title:"Main language",info:"<p>From Census 2021 data - <a href='https://explore.nisra.gov.uk/area-explorer-2021/'><strong>Census Area Explorer</strong></a></p>Person's main language as declared in the Census.Statistics for all language questions are restrictedto persons aged 3 and over. <ahref='https://www.nisra.gov.uk/publications/census-2021-statistical-bulletins'><strong>Statistical bulletins</strong></a>"},households:{title:"Households - box with numbers",info:"<p>From Census 2021 data - <a href='https://explore.nisra.gov.uk/area-explorer-2021/'><strong>Census Area Explorer</strong></a></p>A household is either one person living alone or a group of people living at the same address who share cooking facilities and share a living room, sitting room or dining area. <a href='https://www.nisra.gov.uk/publications/census-2021-statistical-bulletins'><strong>Statistical bulletins</strong></a>"}};return u.$$set=T=>{"id"in T&&d(0,p=T.id),"place"in T&&d(2,y=T.place)},[p,a,y]}class l1 extends fn{constructor(h){super(),dn(this,h,s1,o1,mn,{id:0,place:2})}}function u1(u){let h;return{c(){h=qe("h3"),this.h()},l(d){h=je(d,"H3",{style:!0});var p=Ne(h);p.forEach(ae),this.h()},h(){Xe(h,"margin","0 0 10px 0"),Xe(h,"line-height","1.78")},m(d,p){Be(d,h,p),h.innerHTML=u[9]},p(d,p){p&512&&(h.innerHTML=d[9])},i:li,o:li,d(d){d&&ae(h)}}}function c1(u){let h,d;return h=new l1({props:{id:u[1],place:u[3]}}),{c(){ir(h.$$.fragment)},l(p){nr(h.$$.fragment,p)},m(p,y){ar(h,p,y),d=!0},p(p,y){const v={};y&2&&(v.id=p[1]),y&8&&(v.place=p[3]),h.$set(v)},i(p){d||(Qe(h.$$.fragment,p),d=!0)},o(p){ot(h.$$.fragment,p),d=!1},d(p){or(h,p)}}}function Fm(u){let h,d;return{c(){h=qe("div"),d=Vt(u[12]),this.h()},l(p){h=je(p,"DIV",{class:!0});var y=Ne(h);d=qt(y,u[12]),y.forEach(ae),this.h()},h(){oe(h,"class","text-small")},m(p,y){Be(p,h,y),Ie(h,d)},p(p,y){y&4096&&Rr(d,p[12])},d(p){p&&ae(h)}}}function h1(u){let h,d;return{c(){h=new Bl(!1),d=sr(),this.h()},l(p){h=Ol(p,!1),d=sr(),this.h()},h(){h.a=d},m(p,y){h.m(u[4],p,y),Be(p,d,y)},p(p,y){y&16&&h.p(p[4])},i:li,o:li,d(p){p&&ae(d),p&&h.d()}}}function p1(u){let h,d=u[4][u[3].type]+"",p;return{c(){h=new Bl(!1),p=sr(),this.h()},l(y){h=Ol(y,!1),p=sr(),this.h()},h(){h.a=p},m(y,v){h.m(d,y,v),Be(y,p,v)},p(y,v){v&24&&d!==(d=y[4][y[3].type]+"")&&h.p(d)},i:li,o:li,d(y){y&&ae(p),y&&h.d()}}}function f1(u){let h,d,p,y,v,a,T;const z=[x1,b1,v1,_1],M=[];function F(D,L){return L&1056&&(h=null),L&1056&&(d=null),L&1056&&(p=null),h==null&&(h=!!(D[5].hasOwnProperty("none")&D[10]==null)),h?0:(d==null&&(d=!!(D[5].hasOwnProperty("prev")&D[10]=="prev")),d?1:(p==null&&(p=!!(D[5].hasOwnProperty("ni")&D[10]=="ni")),p?2:3))}return y=F(u,-1),v=M[y]=z[y](u),{c(){v.c(),a=sr()},l(D){v.l(D),a=sr()},m(D,L){M[y].m(D,L),Be(D,a,L),T=!0},p(D,L){let X=y;y=F(D,L),y===X?M[y].p(D,L):(En(),ot(M[X],1,1,()=>{M[X]=null}),zn(),v=M[y],v?v.p(D,L):(v=M[y]=z[y](D),v.c()),Qe(v,1),v.m(a.parentNode,a))},i(D){T||(Qe(v),T=!0)},o(D){ot(v),T=!1},d(D){M[y].d(D),D&&ae(a)}}}function d1(u){let h,d,p,y,v,a,T;const z=[E1,k1,S1,w1],M=[];function F(D,L){return L&1056&&(h=null),L&1056&&(d=null),L&1056&&(p=null),h==null&&(h=!!(D[5].hasOwnProperty("none")&D[10]==null)),h?0:(d==null&&(d=!!(D[5].hasOwnProperty("prev")&D[10]=="prev")),d?1:(p==null&&(p=!!(D[5].hasOwnProperty("ni")&D[10]=="ni")),p?2:3))}return y=F(u,-1),v=M[y]=z[y](u),{c(){v.c(),a=sr()},l(D){v.l(D),a=sr()},m(D,L){M[y].m(D,L),Be(D,a,L),T=!0},p(D,L){let X=y;y=F(D,L),y===X?M[y].p(D,L):(En(),ot(M[X],1,1,()=>{M[X]=null}),zn(),v=M[y],v?v.p(D,L):(v=M[y]=z[y](D),v.c()),Qe(v,1),v.m(a.parentNode,a))},i(D){T||(Qe(v),T=!0)},o(D){ot(v),T=!1},d(D){M[y].d(D),D&&ae(a)}}}function m1(u){let h,d,p,y,v,a,T;const z=[A1,I1,T1,z1],M=[];function F(D,L){return L&1056&&(h=null),L&1056&&(d=null),L&1056&&(p=null),h==null&&(h=!!(D[5].hasOwnProperty("none")&D[10]==null)),h?0:(d==null&&(d=!!(D[5].hasOwnProperty("prev")&D[10]=="prev")),d?1:(p==null&&(p=!!(D[5].hasOwnProperty("ni")&D[10]=="ni")),p?2:3))}return y=F(u,-1),v=M[y]=z[y](u),{c(){v.c(),a=sr()},l(D){v.l(D),a=sr()},m(D,L){M[y].m(D,L),Be(D,a,L),T=!0},p(D,L){let X=y;y=F(D,L),y===X?M[y].p(D,L):(En(),ot(M[X],1,1,()=>{M[X]=null}),zn(),v=M[y],v?v.p(D,L):(v=M[y]=z[y](D),v.c()),Qe(v,1),v.m(a.parentNode,a))},i(D){T||(Qe(v),T=!0)},o(D){ot(v),T=!1},d(D){M[y].d(D),D&&ae(a)}}}function y1(u){let h,d,p,y,v,a,T;const z=[D1,M1,C1,P1],M=[];function F(D,L){return L&1056&&(h=null),L&1056&&(d=null),L&1056&&(p=null),h==null&&(h=!!(D[5].hasOwnProperty("none")&D[10]==null)),h?0:(d==null&&(d=!!(D[5].hasOwnProperty("prev")&D[10]=="prev")),d?1:(p==null&&(p=!!(D[5].hasOwnProperty("ni")&D[10]=="ni")),p?2:3))}return y=F(u,-1),v=M[y]=z[y](u),{c(){v.c(),a=sr()},l(D){v.l(D),a=sr()},m(D,L){M[y].m(D,L),Be(D,a,L),T=!0},p(D,L){let X=y;y=F(D,L),y===X?M[y].p(D,L):(En(),ot(M[X],1,1,()=>{M[X]=null}),zn(),v=M[y],v?v.p(D,L):(v=M[y]=z[y](D),v.c()),Qe(v,1),v.m(a.parentNode,a))},i(D){T||(Qe(v),T=!0)},o(D){ot(v),T=!1},d(D){M[y].d(D),D&&ae(a)}}}function g1(u){let h,d,p,y,v,a,T;const z=[O1,B1,R1,L1],M=[];function F(D,L){return L&1056&&(h=null),L&1056&&(d=null),L&1056&&(p=null),h==null&&(h=!!(D[5].hasOwnProperty("none")&D[10]==null)),h?0:(d==null&&(d=!!(D[5].hasOwnProperty("prev")&D[10]=="prev")),d?1:(p==null&&(p=!!(D[5].hasOwnProperty("ni")&D[10]=="ni")),p?2:3))}return y=F(u,-1),v=M[y]=z[y](u),{c(){v.c(),a=sr()},l(D){v.l(D),a=sr()},m(D,L){M[y].m(D,L),Be(D,a,L),T=!0},p(D,L){let X=y;y=F(D,L),y===X?M[y].p(D,L):(En(),ot(M[X],1,1,()=>{M[X]=null}),zn(),v=M[y],v?v.p(D,L):(v=M[y]=z[y](D),v.c()),Qe(v,1),v.m(a.parentNode,a))},i(D){T||(Qe(v),T=!0)},o(D){ot(v),T=!1},d(D){M[y].d(D),D&&ae(a)}}}function _1(u){let h,d;return h=new Lh({props:{data:u[5],zKey:u[6]}}),{c(){ir(h.$$.fragment)},l(p){nr(h.$$.fragment,p)},m(p,y){ar(h,p,y),d=!0},p(p,y){const v={};y&32&&(v.data=p[5]),y&64&&(v.zKey=p[6]),h.$set(v)},i(p){d||(Qe(h.$$.fragment,p),d=!0)},o(p){ot(h.$$.fragment,p),d=!1},d(p){or(h,p)}}}function v1(u){let h,d;return h=new Lh({props:{data:u[5].ni,zKey:u[6]}}),{c(){ir(h.$$.fragment)},l(p){nr(h.$$.fragment,p)},m(p,y){ar(h,p,y),d=!0},p(p,y){const v={};y&32&&(v.data=p[5].ni),y&64&&(v.zKey=p[6]),h.$set(v)},i(p){d||(Qe(h.$$.fragment,p),d=!0)},o(p){ot(h.$$.fragment,p),d=!1},d(p){or(h,p)}}}function b1(u){let h,d;return h=new Lh({props:{data:u[5].prev,zKey:u[6]}}),{c(){ir(h.$$.fragment)},l(p){nr(h.$$.fragment,p)},m(p,y){ar(h,p,y),d=!0},p(p,y){const v={};y&32&&(v.data=p[5].prev),y&64&&(v.zKey=p[6]),h.$set(v)},i(p){d||(Qe(h.$$.fragment,p),d=!0)},o(p){ot(h.$$.fragment,p),d=!1},d(p){or(h,p)}}}function x1(u){let h,d;return h=new Lh({props:{data:u[5].none,zKey:u[6]}}),{c(){ir(h.$$.fragment)},l(p){nr(h.$$.fragment,p)},m(p,y){ar(h,p,y),d=!0},p(p,y){const v={};y&32&&(v.data=p[5].none),y&64&&(v.zKey=p[6]),h.$set(v)},i(p){d||(Qe(h.$$.fragment,p),d=!0)},o(p){ot(h.$$.fragment,p),d=!1},d(p){or(h,p)}}}function w1(u){let h,d;return h=new Oh({props:{data:u[5],zKey:u[6],label:u[7]}}),{c(){ir(h.$$.fragment)},l(p){nr(h.$$.fragment,p)},m(p,y){ar(h,p,y),d=!0},p(p,y){const v={};y&32&&(v.data=p[5]),y&64&&(v.zKey=p[6]),y&128&&(v.label=p[7]),h.$set(v)},i(p){d||(Qe(h.$$.fragment,p),d=!0)},o(p){ot(h.$$.fragment,p),d=!1},d(p){or(h,p)}}}function S1(u){let h,d;return h=new Oh({props:{data:u[5].ni,zKey:u[6],label:u[7]}}),{c(){ir(h.$$.fragment)},l(p){nr(h.$$.fragment,p)},m(p,y){ar(h,p,y),d=!0},p(p,y){const v={};y&32&&(v.data=p[5].ni),y&64&&(v.zKey=p[6]),y&128&&(v.label=p[7]),h.$set(v)},i(p){d||(Qe(h.$$.fragment,p),d=!0)},o(p){ot(h.$$.fragment,p),d=!1},d(p){or(h,p)}}}function k1(u){let h,d;return h=new Oh({props:{data:u[5].prev,zKey:u[6],label:u[7]}}),{c(){ir(h.$$.fragment)},l(p){nr(h.$$.fragment,p)},m(p,y){ar(h,p,y),d=!0},p(p,y){const v={};y&32&&(v.data=p[5].prev),y&64&&(v.zKey=p[6]),y&128&&(v.label=p[7]),h.$set(v)},i(p){d||(Qe(h.$$.fragment,p),d=!0)},o(p){ot(h.$$.fragment,p),d=!1},d(p){or(h,p)}}}function E1(u){let h,d;return h=new Oh({props:{data:u[5].none,zKey:u[6],label:u[7]}}),{c(){ir(h.$$.fragment)},l(p){nr(h.$$.fragment,p)},m(p,y){ar(h,p,y),d=!0},p(p,y){const v={};y&32&&(v.data=p[5].none),y&64&&(v.zKey=p[6]),y&128&&(v.label=p[7]),h.$set(v)},i(p){d||(Qe(h.$$.fragment,p),d=!0)},o(p){ot(h.$$.fragment,p),d=!1},d(p){or(h,p)}}}function z1(u){let h,d;return h=new Fh({props:{data:u[5],zKey:u[6],label:u[7]}}),{c(){ir(h.$$.fragment)},l(p){nr(h.$$.fragment,p)},m(p,y){ar(h,p,y),d=!0},p(p,y){const v={};y&32&&(v.data=p[5]),y&64&&(v.zKey=p[6]),y&128&&(v.label=p[7]),h.$set(v)},i(p){d||(Qe(h.$$.fragment,p),d=!0)},o(p){ot(h.$$.fragment,p),d=!1},d(p){or(h,p)}}}function T1(u){let h,d;return h=new Fh({props:{data:u[5].ni,zKey:u[6],label:u[7]}}),{c(){ir(h.$$.fragment)},l(p){nr(h.$$.fragment,p)},m(p,y){ar(h,p,y),d=!0},p(p,y){const v={};y&32&&(v.data=p[5].ni),y&64&&(v.zKey=p[6]),y&128&&(v.label=p[7]),h.$set(v)},i(p){d||(Qe(h.$$.fragment,p),d=!0)},o(p){ot(h.$$.fragment,p),d=!1},d(p){or(h,p)}}}function I1(u){let h,d;return h=new Fh({props:{data:u[5].prev,zKey:u[6],label:u[7]}}),{c(){ir(h.$$.fragment)},l(p){nr(h.$$.fragment,p)},m(p,y){ar(h,p,y),d=!0},p(p,y){const v={};y&32&&(v.data=p[5].prev),y&64&&(v.zKey=p[6]),y&128&&(v.label=p[7]),h.$set(v)},i(p){d||(Qe(h.$$.fragment,p),d=!0)},o(p){ot(h.$$.fragment,p),d=!1},d(p){or(h,p)}}}function A1(u){let h,d;return h=new Fh({props:{data:u[5].none,zKey:u[6],label:u[7]}}),{c(){ir(h.$$.fragment)},l(p){nr(h.$$.fragment,p)},m(p,y){ar(h,p,y),d=!0},p(p,y){const v={};y&32&&(v.data=p[5].none),y&64&&(v.zKey=p[6]),y&128&&(v.label=p[7]),h.$set(v)},i(p){d||(Qe(h.$$.fragment,p),d=!0)},o(p){ot(h.$$.fragment,p),d=!1},d(p){or(h,p)}}}function P1(u){let h,d;return h=new Bh({props:{data:u[5],zKey:"group"}}),{c(){ir(h.$$.fragment)},l(p){nr(h.$$.fragment,p)},m(p,y){ar(h,p,y),d=!0},p(p,y){const v={};y&32&&(v.data=p[5]),h.$set(v)},i(p){d||(Qe(h.$$.fragment,p),d=!0)},o(p){ot(h.$$.fragment,p),d=!1},d(p){or(h,p)}}}function C1(u){let h,d;return h=new Bh({props:{data:u[5].ni,zKey:"group"}}),{c(){ir(h.$$.fragment)},l(p){nr(h.$$.fragment,p)},m(p,y){ar(h,p,y),d=!0},p(p,y){const v={};y&32&&(v.data=p[5].ni),h.$set(v)},i(p){d||(Qe(h.$$.fragment,p),d=!0)},o(p){ot(h.$$.fragment,p),d=!1},d(p){or(h,p)}}}function M1(u){let h,d;return h=new Bh({props:{data:u[5].prev,zKey:"group"}}),{c(){ir(h.$$.fragment)},l(p){nr(h.$$.fragment,p)},m(p,y){ar(h,p,y),d=!0},p(p,y){const v={};y&32&&(v.data=p[5].prev),h.$set(v)},i(p){d||(Qe(h.$$.fragment,p),d=!0)},o(p){ot(h.$$.fragment,p),d=!1},d(p){or(h,p)}}}function D1(u){let h,d;return h=new Bh({props:{data:u[5].none,zKey:"group"}}),{c(){ir(h.$$.fragment)},l(p){nr(h.$$.fragment,p)},m(p,y){ar(h,p,y),d=!0},p(p,y){const v={};y&32&&(v.data=p[5].none),h.$set(v)},i(p){d||(Qe(h.$$.fragment,p),d=!0)},o(p){ot(h.$$.fragment,p),d=!1},d(p){or(h,p)}}}function L1(u){let h,d;return h=new Rh({props:{data:u[5],zKey:u[6],label:u[7],topic_prev_available:u[0]}}),{c(){ir(h.$$.fragment)},l(p){nr(h.$$.fragment,p)},m(p,y){ar(h,p,y),d=!0},p(p,y){const v={};y&32&&(v.data=p[5]),y&64&&(v.zKey=p[6]),y&128&&(v.label=p[7]),y&1&&(v.topic_prev_available=p[0]),h.$set(v)},i(p){d||(Qe(h.$$.fragment,p),d=!0)},o(p){ot(h.$$.fragment,p),d=!1},d(p){or(h,p)}}}function R1(u){let h,d;return h=new Rh({props:{data:u[5].ni,zKey:u[6],label:u[7],topic_prev_available:u[0]}}),{c(){ir(h.$$.fragment)},l(p){nr(h.$$.fragment,p)},m(p,y){ar(h,p,y),d=!0},p(p,y){const v={};y&32&&(v.data=p[5].ni),y&64&&(v.zKey=p[6]),y&128&&(v.label=p[7]),y&1&&(v.topic_prev_available=p[0]),h.$set(v)},i(p){d||(Qe(h.$$.fragment,p),d=!0)},o(p){ot(h.$$.fragment,p),d=!1},d(p){or(h,p)}}}function B1(u){let h,d;return h=new Rh({props:{data:u[5].prev,zKey:u[6],label:u[7],topic_prev_available:u[0]}}),{c(){ir(h.$$.fragment)},l(p){nr(h.$$.fragment,p)},m(p,y){ar(h,p,y),d=!0},p(p,y){const v={};y&32&&(v.data=p[5].prev),y&64&&(v.zKey=p[6]),y&128&&(v.label=p[7]),y&1&&(v.topic_prev_available=p[0]),h.$set(v)},i(p){d||(Qe(h.$$.fragment,p),d=!0)},o(p){ot(h.$$.fragment,p),d=!1},d(p){or(h,p)}}}function O1(u){let h,d;return h=new Rh({props:{data:u[5].none,zKey:u[6],label:u[7],topic_prev_available:u[0]}}),{c(){ir(h.$$.fragment)},l(p){nr(h.$$.fragment,p)},m(p,y){ar(h,p,y),d=!0},p(p,y){const v={};y&32&&(v.data=p[5].none),y&64&&(v.zKey=p[6]),y&128&&(v.label=p[7]),y&1&&(v.topic_prev_available=p[0]),h.$set(v)},i(p){d||(Qe(h.$$.fragment,p),d=!0)},o(p){ot(h.$$.fragment,p),d=!1},d(p){or(h,p)}}}function Nm(u){let h=u[11][u[3].type].hasOwnProperty(u[10]),d,p=h&&Um(u);return{c(){p&&p.c(),d=sr()},l(y){p&&p.l(y),d=sr()},m(y,v){p&&p.m(y,v),Be(y,d,v)},p(y,v){v&3080&&(h=y[11][y[3].type].hasOwnProperty(y[10])),h?p?p.p(y,v):(p=Um(y),p.c(),p.m(d.parentNode,d)):p&&(p.d(1),p=null)},d(y){p&&p.d(y),y&&ae(d)}}}function Um(u){let h,d,p,y=u[11][u[3].type][u[10]]+"";return{c(){h=qe("br"),d=xt(),p=qe("span"),this.h()},l(v){h=je(v,"BR",{}),d=wt(v),p=je(v,"SPAN",{class:!0});var a=Ne(p);a.forEach(ae),this.h()},h(){oe(p,"class","text-small")},m(v,a){Be(v,h,a),Be(v,d,a),Be(v,p,a),p.innerHTML=y},p(v,a){a&3080&&y!==(y=v[11][v[3].type][v[10]]+"")&&(p.innerHTML=y)},d(v){v&&ae(h),v&&ae(d),v&&ae(p)}}}function F1(u){let h,d,p,y,v,a,T,z,M,F,D,L,X,ne,ce;const ve=[c1,u1],de=[];function we(Ue,ct){return Ue[8]?0:1}d=we(u),p=de[d]=ve[d](u);let Ke=u[12]!=null&&Fm(u);const ut=[g1,y1,m1,d1,f1,p1,h1],Me=[];function Ye(Ue,ct){return ct&24&&(a=null),ct&24&&(T=null),ct&24&&(z=null),ct&24&&(M=null),ct&24&&(F=null),ct&24&&(D=null),a==null&&(a=!!(Ue[4]=="StackedBarChart"|Ue[4].hasOwnProperty(Ue[3].type)&Ue[4][Ue[3].type]=="StackedBarChart")),a?0:(T==null&&(T=!!(Ue[4]=="GroupChart"|Ue[4].hasOwnProperty(Ue[3].type)&Ue[4][Ue[3].type]=="GroupChart")),T?1:(z==null&&(z=!!(Ue[4]=="ProfileChart"|Ue[4].hasOwnProperty(Ue[3].type)&Ue[4][Ue[3].type]=="ProfileChart")),z?2:(M==null&&(M=!!(Ue[4]=="BarChart"|Ue[4].hasOwnProperty(Ue[3].type)&Ue[4][Ue[3].type]=="BarChart")),M?3:(F==null&&(F=!!(Ue[4]=="ColChart"|Ue[4].hasOwnProperty(Ue[3].type)&Ue[4][Ue[3].type]=="ColChart")),F?4:(D==null&&(D=!!Ue[4].hasOwnProperty(Ue[3].type)),D?5:6)))))}L=Ye(u,-1),X=Me[L]=ut[L](u);let vt=u[11]!=null&u[10]!=null&&Nm(u);return{c(){h=qe("div"),p.c(),y=xt(),Ke&&Ke.c(),v=xt(),X.c(),ne=xt(),vt&&vt.c(),this.h()},l(Ue){h=je(Ue,"DIV",{class:!0,style:!0});var ct=Ne(h);p.l(ct),y=wt(ct),Ke&&Ke.l(ct),v=wt(ct),X.l(ct),ne=wt(ct),vt&&vt.l(ct),ct.forEach(ae),this.h()},h(){oe(h,"class","div-grey-box svelte-1mdbgz6"),oe(h,"style",u[2])},m(Ue,ct){Be(Ue,h,ct),de[d].m(h,null),Ie(h,y),Ke&&Ke.m(h,null),Ie(h,v),Me[L].m(h,null),Ie(h,ne),vt&&vt.m(h,null),ce=!0},p(Ue,[ct]){let mt=d;d=we(Ue),d===mt?de[d].p(Ue,ct):(En(),ot(de[mt],1,1,()=>{de[mt]=null}),zn(),p=de[d],p?p.p(Ue,ct):(p=de[d]=ve[d](Ue),p.c()),Qe(p,1),p.m(h,y)),Ue[12]!=null?Ke?Ke.p(Ue,ct):(Ke=Fm(Ue),Ke.c(),Ke.m(h,v)):Ke&&(Ke.d(1),Ke=null);let Ze=L;L=Ye(Ue,ct),L===Ze?Me[L].p(Ue,ct):(En(),ot(Me[Ze],1,1,()=>{Me[Ze]=null}),zn(),X=Me[L],X?X.p(Ue,ct):(X=Me[L]=ut[L](Ue),X.c()),Qe(X,1),X.m(h,ne)),Ue[11]!=null&Ue[10]!=null?vt?vt.p(Ue,ct):(vt=Nm(Ue),vt.c(),vt.m(h,null)):vt&&(vt.d(1),vt=null),(!ce||ct&4)&&oe(h,"style",Ue[2])},i(Ue){ce||(Qe(p),Qe(X),ce=!0)},o(Ue){ot(p),ot(X),ce=!1},d(Ue){Ue&&ae(h),de[d].d(),Ke&&Ke.d(),Me[L].d(),vt&&vt.d()}}}function N1(u,h,d){let{id:p}=h,{style:y=""}=h,{place:v}=h,{content:a}=h,{chart_data:T=null}=h,{zKey:z="ni"}=h,{label:M=null}=h,{topic_prev_available:F=null}=h,{topic_boolean:D=null}=h,{i_button:L=!0}=h,{heading:X=null}=h,{chart_compare_type:ne}=h,{compare_content:ce=null}=h,{year:ve=null}=h;return F=="false"?D=!1:D=!0,u.$$set=de=>{"id"in de&&d(1,p=de.id),"style"in de&&d(2,y=de.style),"place"in de&&d(3,v=de.place),"content"in de&&d(4,a=de.content),"chart_data"in de&&d(5,T=de.chart_data),"zKey"in de&&d(6,z=de.zKey),"label"in de&&d(7,M=de.label),"topic_prev_available"in de&&d(13,F=de.topic_prev_available),"topic_boolean"in de&&d(0,D=de.topic_boolean),"i_button"in de&&d(8,L=de.i_button),"heading"in de&&d(9,X=de.heading),"chart_compare_type"in de&&d(10,ne=de.chart_compare_type),"compare_content"in de&&d(11,ce=de.compare_content),"year"in de&&d(12,ve=de.year)},[D,p,y,v,a,T,z,M,L,X,ne,ce,ve,F]}class Bu extends fn{constructor(h){super(),dn(this,h,N1,F1,mn,{id:1,style:2,place:3,content:4,chart_data:5,zKey:6,label:7,topic_prev_available:13,topic_boolean:0,i_button:8,heading:9,chart_compare_type:10,compare_content:11,year:12})}}function Vm(u,h,d){const p=u.slice();return p[13]=h[d],p[15]=d,p}function qm(u){let h=u[6][u[10][u[15]]].show.includes(u[3].type),d,p,y=h&&jm(u);return{c(){y&&y.c(),d=sr()},l(v){y&&y.l(v),d=sr()},m(v,a){y&&y.m(v,a),Be(v,d,a),p=!0},p(v,a){a&72&&(h=v[6][v[10][v[15]]].show.includes(v[3].type)),h?y?(y.p(v,a),a&72&&Qe(y,1)):(y=jm(v),y.c(),Qe(y,1),y.m(d.parentNode,d)):y&&(En(),ot(y,1,1,()=>{y=null}),zn())},i(v){p||(Qe(y),p=!0)},o(v){ot(y),p=!1},d(v){y&&y.d(v),v&&ae(d)}}}function jm(u){let h,d;return h=new Bu({props:{id:u[6][u[10][u[15]]].id,style:u[6][u[10][u[15]]].style,place:u[3],year:u[6][u[10][u[15]]].year,content:u[6][u[10][u[15]]].content,chart_data:u[6][u[10][u[15]]].chart_data,zKey:u[6][u[10][u[15]]].zKey,label:u[6][u[10][u[15]]].label,topic_prev_available:u[6][u[10][u[15]]].topic_prev_available,chart_compare_type:u[8]}}),{c(){ir(h.$$.fragment)},l(p){nr(h.$$.fragment,p)},m(p,y){ar(h,p,y),d=!0},p(p,y){const v={};y&64&&(v.id=p[6][p[10][p[15]]].id),y&64&&(v.style=p[6][p[10][p[15]]].style),y&8&&(v.place=p[3]),y&64&&(v.year=p[6][p[10][p[15]]].year),y&64&&(v.content=p[6][p[10][p[15]]].content),y&64&&(v.chart_data=p[6][p[10][p[15]]].chart_data),y&64&&(v.zKey=p[6][p[10][p[15]]].zKey),y&64&&(v.label=p[6][p[10][p[15]]].label),y&64&&(v.topic_prev_available=p[6][p[10][p[15]]].topic_prev_available),y&256&&(v.chart_compare_type=p[8]),h.$set(v)},i(p){d||(Qe(h.$$.fragment,p),d=!0)},o(p){ot(h.$$.fragment,p),d=!1},d(p){or(h,p)}}}function Zm(u){let h,d;return h=new Bu({props:{id:u[6][u[10][u[15]]].id,style:u[6][u[10][u[15]]].style,place:u[3],year:u[6][u[10][u[15]]].year,content:u[6][u[10][u[15]]].content,chart_data:u[6][u[10][u[15]]].chart_data,zKey:u[6][u[10][u[15]]].zKey,label:u[6][u[10][u[15]]].label,topic_prev_available:u[6][u[10][u[15]]].topic_prev_available,chart_compare_type:u[8]}}),{c(){ir(h.$$.fragment)},l(p){nr(h.$$.fragment,p)},m(p,y){ar(h,p,y),d=!0},p(p,y){const v={};y&64&&(v.id=p[6][p[10][p[15]]].id),y&64&&(v.style=p[6][p[10][p[15]]].style),y&8&&(v.place=p[3]),y&64&&(v.year=p[6][p[10][p[15]]].year),y&64&&(v.content=p[6][p[10][p[15]]].content),y&64&&(v.chart_data=p[6][p[10][p[15]]].chart_data),y&64&&(v.zKey=p[6][p[10][p[15]]].zKey),y&64&&(v.label=p[6][p[10][p[15]]].label),y&64&&(v.topic_prev_available=p[6][p[10][p[15]]].topic_prev_available),y&256&&(v.chart_compare_type=p[8]),h.$set(v)},i(p){d||(Qe(h.$$.fragment,p),d=!0)},o(p){ot(h.$$.fragment,p),d=!1},d(p){or(h,p)}}}function Gm(u){let h=u[6][u[10][u[15]]].hasOwnProperty("show"),d,p=!u[6][u[10][u[15]]].hasOwnProperty("show"),y,v,a=h&&qm(u),T=p&&Zm(u);return{c(){a&&a.c(),d=xt(),T&&T.c(),y=sr()},l(z){a&&a.l(z),d=wt(z),T&&T.l(z),y=sr()},m(z,M){a&&a.m(z,M),Be(z,d,M),T&&T.m(z,M),Be(z,y,M),v=!0},p(z,M){M&64&&(h=z[6][z[10][z[15]]].hasOwnProperty("show")),h?a?(a.p(z,M),M&64&&Qe(a,1)):(a=qm(z),a.c(),Qe(a,1),a.m(d.parentNode,d)):a&&(En(),ot(a,1,1,()=>{a=null}),zn()),M&64&&(p=!z[6][z[10][z[15]]].hasOwnProperty("show")),p?T?(T.p(z,M),M&64&&Qe(T,1)):(T=Zm(z),T.c(),Qe(T,1),T.m(y.parentNode,y)):T&&(En(),ot(T,1,1,()=>{T=null}),zn())},i(z){v||(Qe(a),Qe(T),v=!0)},o(z){ot(a),ot(T),v=!1},d(z){a&&a.d(z),z&&ae(d),T&&T.d(z),z&&ae(y)}}}function Km(u){let h,d,p,y;return{c(){h=qe("h3"),d=Vt("More Statistics"),p=xt(),y=qe("div"),this.h()},l(v){h=je(v,"H3",{});var a=Ne(h);d=qt(a,"More Statistics"),a.forEach(ae),p=wt(v),y=je(v,"DIV",{class:!0});var T=Ne(y);T.forEach(ae),this.h()},h(){oe(y,"class","accordion-more svelte-1jaw0n6")},m(v,a){Be(v,h,a),Ie(h,d),Be(v,p,a),Be(v,y,a),y.innerHTML=u[7]},p(v,a){a&128&&(y.innerHTML=v[7])},d(v){v&&ae(h),v&&ae(p),v&&ae(y)}}}function U1(u){let h,d,p,y,v,a,T,z,M,F,D,L,X,ne,ce=u[3].name+"",ve,de,we=u[3].type.toLocaleUpperCase()+"",Ke,ut,Me,Ye,vt,Ue,ct,mt,Ze,Ft,yt,Ct,Le,Pt={length:u[10].length},At=[];for(let ht=0;ht<Pt.length;ht+=1)At[ht]=Gm(Vm(u,Pt,ht));const Jt=ht=>ot(At[ht],1,1,()=>{At[ht]=null});let Nt=u[7]!=""&&Km(u);return{c(){h=qe("div"),d=qe("h2"),p=qe("button"),y=qe("span"),v=qe("img"),T=xt(),z=Vt(u[2]),L=xt(),X=qe("div"),ne=qe("div"),ve=Vt(ce),de=xt(),Ke=Vt(we),ut=Vt(" - "),Me=new Bl(!1),Ye=xt(),vt=qe("span"),Ue=Vt(u[5]),ct=xt(),mt=qe("div");for(let ht=0;ht<At.length;ht+=1)At[ht].c();Ft=xt(),Nt&&Nt.c(),this.h()},l(ht){h=je(ht,"DIV",{class:!0});var De=Ne(h);d=je(De,"H2",{class:!0,id:!0});var Lt=Ne(d);p=je(Lt,"BUTTON",{class:!0,type:!0,"data-bs-toggle":!0,"data-bs-target":!0,"aria-expanded":!0,"aria-controls":!0});var Cr=Ne(p);y=je(Cr,"SPAN",{class:!0});var _i=Ne(y);v=je(_i,"IMG",{src:!0,alt:!0,height:!0,class:!0}),T=wt(_i),z=qt(_i,u[2]),_i.forEach(ae),Cr.forEach(ae),Lt.forEach(ae),L=wt(De),X=je(De,"DIV",{id:!0,class:!0,"aria-labelledby":!0});var er=Ne(X);ne=je(er,"DIV",{class:!0});var Mr=Ne(ne);ve=qt(Mr,ce),de=wt(Mr),Ke=qt(Mr,we),ut=qt(Mr," - "),Me=Ol(Mr,!1),Ye=wt(Mr),vt=je(Mr,"SPAN",{class:!0});var Sr=Ne(vt);Ue=qt(Sr,u[5]),Sr.forEach(ae),ct=wt(Mr),mt=je(Mr,"DIV",{class:!0});var en=Ne(mt);for(let Wt=0;Wt<At.length;Wt+=1)At[Wt].l(en);en.forEach(ae),Ft=wt(Mr),Nt&&Nt.l(Mr),Mr.forEach(ae),er.forEach(ae),De.forEach(ae),this.h()},h(){xd(v.src,a=_a+"/img/"+u[1])||oe(v,"src",a),oe(v,"alt","logo"),oe(v,"height","40"),oe(v,"class","accordion-dept-logo"),oe(y,"class","accordion-button-title"),oe(p,"class","accordion-button collapsed"),oe(p,"type","button"),oe(p,"data-bs-toggle","collapse"),oe(p,"data-bs-target",M="#panelsStayOpen-collapse"+u[0]),oe(p,"aria-expanded","false"),oe(p,"aria-controls",F="panelsStayOpen-collapse"+u[0]),oe(d,"class","accordion-header"),oe(d,"id",D="panelsStayOpen-heading"+u[0]),Me.a=Ye,oe(vt,"class","accordion-button-title-sub"),oe(mt,"class","grid mt svelte-1jaw0n6"),Gu(()=>u[11].call(mt)),oe(ne,"class","accordion-body"),oe(X,"id",yt="panelsStayOpen-collapse"+u[0]),oe(X,"class","accordion-collapse collapse"),oe(X,"aria-labelledby",Ct="panelsStayOpen-heading"+u[0]),oe(h,"class","accordion-item")},m(ht,De){Be(ht,h,De),Ie(h,d),Ie(d,p),Ie(p,y),Ie(y,v),Ie(y,T),Ie(y,z),Ie(h,L),Ie(h,X),Ie(X,ne),Ie(ne,ve),Ie(ne,de),Ie(ne,Ke),Ie(ne,ut),Me.m(u[4],ne),Ie(ne,Ye),Ie(ne,vt),Ie(vt,Ue),Ie(ne,ct),Ie(ne,mt);for(let Lt=0;Lt<At.length;Lt+=1)At[Lt]&&At[Lt].m(mt,null);Ze=Ku(mt,u[11].bind(mt)),Ie(ne,Ft),Nt&&Nt.m(ne,null),Le=!0},p(ht,[De]){if((!Le||De&2&&!xd(v.src,a=_a+"/img/"+ht[1]))&&oe(v,"src",a),(!Le||De&4)&&Rr(z,ht[2]),(!Le||De&1&&M!==(M="#panelsStayOpen-collapse"+ht[0]))&&oe(p,"data-bs-target",M),(!Le||De&1&&F!==(F="panelsStayOpen-collapse"+ht[0]))&&oe(p,"aria-controls",F),(!Le||De&1&&D!==(D="panelsStayOpen-heading"+ht[0]))&&oe(d,"id",D),(!Le||De&8)&&ce!==(ce=ht[3].name+"")&&Rr(ve,ce),(!Le||De&8)&&we!==(we=ht[3].type.toLocaleUpperCase()+"")&&Rr(Ke,we),(!Le||De&16)&&Me.p(ht[4]),(!Le||De&32)&&Rr(Ue,ht[5]),De&1352){Pt={length:ht[10].length};let Lt;for(Lt=0;Lt<Pt.length;Lt+=1){const Cr=Vm(ht,Pt,Lt);At[Lt]?(At[Lt].p(Cr,De),Qe(At[Lt],1)):(At[Lt]=Gm(Cr),At[Lt].c(),Qe(At[Lt],1),At[Lt].m(mt,null))}for(En(),Lt=Pt.length;Lt<At.length;Lt+=1)Jt(Lt);zn()}ht[7]!=""?Nt?Nt.p(ht,De):(Nt=Km(ht),Nt.c(),Nt.m(ne,null)):Nt&&(Nt.d(1),Nt=null),(!Le||De&1&&yt!==(yt="panelsStayOpen-collapse"+ht[0]))&&oe(X,"id",yt),(!Le||De&1&&Ct!==(Ct="panelsStayOpen-heading"+ht[0]))&&oe(X,"aria-labelledby",Ct)},i(ht){if(!Le){for(let De=0;De<Pt.length;De+=1)Qe(At[De]);Le=!0}},o(ht){At=At.filter(Boolean);for(let De=0;De<At.length;De+=1)ot(At[De]);Le=!1},d(ht){ht&&ae(h),on(At,ht),Ze(),Nt&&Nt.d()}}}function V1(u,h,d){let{id:p}=h,{img:y}=h,{heading:v}=h,{place:a}=h,{sub_heading:T}=h,{description:z}=h,{boxes:M}=h,{more:F}=h,{chart_compare_type:D}=h,L=Object.keys(M),X;function ne(){X=this.clientWidth,d(9,X)}return u.$$set=ce=>{"id"in ce&&d(0,p=ce.id),"img"in ce&&d(1,y=ce.img),"heading"in ce&&d(2,v=ce.heading),"place"in ce&&d(3,a=ce.place),"sub_heading"in ce&&d(4,T=ce.sub_heading),"description"in ce&&d(5,z=ce.description),"boxes"in ce&&d(6,M=ce.boxes),"more"in ce&&d(7,F=ce.more),"chart_compare_type"in ce&&d(8,D=ce.chart_compare_type)},[p,y,v,a,T,z,M,F,D,X,L,ne]}class Ml extends fn{constructor(h){super(),dn(this,h,V1,U1,mn,{id:0,img:1,heading:2,place:3,sub_heading:4,description:5,boxes:6,more:7,chart_compare_type:8})}}function Hm(u,h,d){const p=u.slice();return p[26]=h[d],p[28]=d,p}function Xm(u,h,d){const p=u.slice();return p[29]=h[d],p[28]=d,p}function Wm(u,h,d){const p=u.slice();return p[31]=h[d],p}function Ym(u,h,d){const p=u.slice();return p[29]=h[d],p[28]=d,p}function Jm(u){let h,d,p,y,v,a,T=" &gt; ",z,M,F,D=u[0].place.name+"",L,X,ne,ce,ve,de,we,Ke,ut,Me,Ye,vt,Ue,ct,mt,Ze,Ft,yt,Ct,Le,Pt,At,Jt,Nt,ht,De,Lt,Cr,_i,er,Mr,Sr,en,Wt,ui,Hn,tn,jt,yn,Qr,vi,Tn,Er,zi,ci,hi,sn,qr,pi,fi,bi,Bi,Xn,qi,ji,jr=u[0].place.type!="ni"&&Qm(u);Ke=new s_({props:{search_data:u[0].search_data,group:"typestr",search:!0}}),Ke.$on("select",u[11]),Nt=new Bu({props:{id:"overview",i_button:!1,heading:"About "+u[0].place.name,place:u[0].place,style:"line-height: 1.3;",content:{ni:"Northern Ireland has 11 Local Government Districts (LGDs),  which can be subdivided into District Electoral Areas (DEAs), then further into Super Data Zones and Data Zones. Statistics can be viewed for these smaller areas.",lgd:u[0].place.name+" is one of "+u[0].place.count.toLocaleString()+" "+Zn[u[0].place.type].pl+".  It includes the larger settlements of "+u[0].place.lgd_location_description,dea:u[0].place.name+" is one of "+u[0].place.count.toLocaleString()+" "+Zn[u[0].place.type].pl+"in Northern Ireland.  It is within <a href = '/"+u[0].place.parents[0].code+"/' data-sveltekit-noscroll>"+u[0].place.parents[0].name+" </a> and covers "+u[0].place.dea_location_description+".",sdz:u[0].place.name+" is one of "+u[0].place.count.toLocaleString()+" "+Zn[u[0].place.type].pl+". Super Data Zones are are a new statistical output geography that have been created to support the release of local-level statistics.",dz:u[0].place.name+" is one of "+u[0].place.count.toLocaleString()+" "+Zn[u[0].place.type].pl+".  Data Zones are are a new statistical output geography that have been created to support the release of local-level statistics."},chart_compare_type:u[6]}}),De=new Bu({props:{id:"pop",place:u[0].place,year:Ar("MYETotal",u[0].place),content:'<span class="text-big" style="font-size: 2.8em;">'+(Math.round(u[0].place.data.MYETotal.value/1e3)*1e3).toLocaleString()+"</span>",chart_compare_type:u[6],compare_content:{ni:{prev:'<span class="em '+es(u[0].place.data.population.value.change.all)+'">'+ts(u[0].place.data.population.value.change.all,"%",1)+"</span> since 2011 Census"},lgd:{prev:'<span class="em '+es(u[0].place.data.population.value.change.all)+'">'+ts(u[0].place.data.population.value.change.all,"%",1)+"</span> since 2011 Census",ni:'<span class = "em" style = "background-color: lightgrey">'+yh(u[0].place.data.population.value[2021].all/u[0].ni.data.population.value[2021].all)+"</span> of Northern Ireland population<br>The "+u[12](u[0].place.data.population.value_rank[2021].all)+" population of 11 Local Government Districts"},dea:{ni:'<span class = "em" style = "background-color: lightgrey">'+yh(u[0].place.data.population.value[2021].all/u[0].ni.data.population.value[2021].all)+"</span> of Northern Ireland population"},sdz:{prev:" nothing further",ni:" nothing further"},dz:{prev:" no comparisons",ni:" nothing further"}}}}),Cr=new Bu({props:{id:"popden",place:u[0].place,year:u[14]("population"),content:'<span class="text-big" style="font-size: 2.8em;">'+ny(u[0].place)+"</span> people per hectare",chart_compare_type:u[6],compare_content:{ni:{prev:'<span class="em '+es(u[0].place.data.households.value.change.all_households)+'">'+ts(u[0].place.data.households.value.change.all_households,"%",1)+"</span> since 2011 Census"},lgd:{prev:'<span class="em '+es(u[0].place.data.households.value.change.all_households)+'">'+ts(u[0].place.data.households.value.change.all_households,"%",1)+"</span> since 2011 Census",ni:u[16](u[0].place)},dea:{ni:u[16](u[0].place)},sdz:{prev:" nothing further",ni:u[16](u[0].place)},dz:{prev:" no comparisons",ni:u[16](u[0].place)}}}});function ta(re,dt){return re[0].place.type!="ni"?j1:q1}let gn=ta(u),xi=gn(u);function Mn(re){u[18](re)}let Wn={location:{bounds:u[0].place.bounds},options:{fitBoundsOptions:{padding:20}},style:l_,$$slots:{default:[G1]},$$scope:{ctx:u}};u[3]!==void 0&&(Wn.map=u[3]),ui=new W_({props:Wn}),Vu.push(()=>p_(ui,"map",Mn));let Hr=u[0].place.type!="ni"&&ty(u);function ra(re,dt){return re[0].place.children[0]?H1:K1}let Dn=ra(u),ti=Dn(u);return zi=new Ml({props:{id:"people",img:"nisra-taxonomy-icon-census.png",heading:"People and Households",place:u[0].place,sub_heading:u[15]("People and Households",u[0].place),description:"",chart_compare_type:u[6],boxes:{box_1:{id:"popchange",content:"<span > population growth/shrink to be added</span> "},box_2:{id:"age",year:u[14]("age"),content:"GroupChart",chart_data:{none:u[9](u[0].place.grouped_data_nocompare.age,"age"),prev:u[9](u[0].place.grouped_data_timecompare.age,"age"),ni:u[9](u[0].place.grouped_data_areacompare.age,"age")},topic_prev_available:"true"},box_4:{id:"hhsize",year:u[14]("hh_size"),content:"GroupChart",chart_data:{none:u[9](u[0].place.grouped_data_nocompare.hh_size,"hh_size"),prev:u[9](u[0].place.grouped_data_timecompare.hh_size,"hh_size"),ni:u[9](u[0].place.grouped_data_areacompare.hh_size,"hh_size")},topic_prev_available:"true"},box_5:{id:"religion",year:u[14]("religion_or_religion_brought_up_in"),content:"GroupChart",chart_data:{none:u[9](u[0].place.grouped_data_nocompare.religion_or_religion_brought_up_in,"religion_or_religion_brought_up_in"),prev:u[9](u[0].place.grouped_data_timecompare.religion_or_religion_brought_up_in,"religion_or_religion_brought_up_in"),ni:u[9](u[0].place.grouped_data_areacompare.religion_or_religion_brought_up_in,"religion_or_religion_brought_up_in")},topic_prev_available:"true"},box_6:{id:"language",year:u[14]("mainlang"),content:"GroupChart",chart_data:{none:u[9](u[0].place.grouped_data_nocompare.mainlang,"mainlang"),prev:u[9](u[0].place.grouped_data_timecompare.mainlang,"mainlang"),ni:u[9](u[0].place.grouped_data_areacompare.mainlang,"mainlang")},topic_prev_available:"true"}},more:`More information on the size of the population is available in the latest <a href='https://www.nisra.gov.uk/publications/2022-mid-year-population-estimates-northern-ireland'>mid-year estimates release</a>, \r
					which includes an <a href='https://www.nisra.gov.uk/system/files/statistics/MYE22-summary.pdf'>infographic</a>, \r
					<a href='https://www.nisra.gov.uk/system/files/statistics/MYE22-Factsheets.pdf'>Fact Sheets</a>, \r
					a <a href='https://www.nisra.gov.uk/system/files/statistics/Statistical%20Bulletin%20-%202022%20Mid-year%20Population%20Estimates%20for%20Northern%20Ireland.pdf'>publication</a> \r
					and statistical tables. Population characteristics are from the census data which can be explored further in the <a href='https://explore.nisra.gov.uk/area-explorer-2021/N92000002/'>Census Area Explorer</a>, \r
					bespoke tables can be created using the <a href='https://build.nisra.gov.uk/en/'>Flexible Table Builder</a> and the NISRA website has \r
					<a href='https://www.nisra.gov.uk/publications/census-2021-statistical-bulletins'>statistical bulletins</a> providing commentary on a range of census population characteristics.`}}),hi=new Ml({props:{id:"health",img:"nisra-taxonomy-icon-health.png",heading:"Health and Social Care",place:u[0].place,sub_heading:u[15]("Health and Social Care",u[0].place),description:" ",chart_compare_type:u[6],boxes:{box_1:{id:"generalhealth",year:u[14]("general_health"),content:{ni:"StackedBarChart",lgd:"StackedBarChart",dea:"StackedBarChart",sdz:"not available - needs missing 2011",dz:"not available - needs missing 2011"},chart_data:u[0].place&&u[8](["general_health"],["2011"],["2021"]),zKey:u[6],label:u[7],topic_prev_available:"true"},box_2:{id:"wellbeing",year:Ar("Happy",u[0].place),content:"<p><span class='text-big' style='font-size: 1.8em'>"+u[13]("Happy.value").toLocaleString()+"</span> / 10 happiness</p><p><span class='text-big' style='font-size: 1.8em'>"+u[13]("Satisfy.value").toLocaleString()+"</span> / 10 life satisfaction</p>",show:["ni","lgd"]},box_3:{id:"lifeexpectancy",year:Ar("LE",u[0].place),content:"<p>Male <span class='text-big' style='font-size: 1.8em'>"+u[13]("LE.value.Males").toLocaleString()+"</span> years</p><p>Female <span class='text-big' style='font-size: 1.8em'>"+u[13]("LE.value.Females").toLocaleString()+"</span> years</p>",show:["ni","lgd"]},box_4:{id:"carers",content:"GroupChart",year:u[14]("provision_care"),chart_data:{none:u[9](u[0].place.grouped_data_nocompare.provision_care,"provision_care"),prev:u[9](u[0].place.grouped_data_timecompare.provision_care,"provision_care"),ni:u[9](u[0].place.grouped_data_areacompare.provision_care,"provision_care")},label:u[7],topic_prev_available:"true"},box_5:{id:"hospitalactivity",year:Ar("Admiss",u[0].place),content:"<p><span class='text-big' style='font-size: 1.8em'>"+u[13]("Admiss.value").toLocaleString()+"</span> hospital patients</p><p>  The most frequent reason was for </p><span class='text-bold' >"+u[13]("Admiss.text")+"</span>",show:["ni","dea"]},box_6a:{id:"primarycare",year:Ar("GP",u[0].place),content:"<p><span class='text-big' style='font-size: 1.2em'>"+u[13]("GP.value.PRACS").toLocaleString()+"</span> GP practices with an average of <span class='text-big' style='font-size: 1.2em'>"+u[13]("GP.value.PRACLIST").toLocaleString()+"</span> patients per practice</p><p><span class='text-big' style='font-size: 1.2em'>"+ +u[13]("DEN.value.GDSDSSurgeries").toLocaleString()+"</span> dental surgeries</span> with an average of <span class='text-big' style='font-size: 1.2em'>"+(u[13]("DEN_REG.value.Dental_Registrations")/u[13]("DEN.value.GDSDSSurgeries")).toLocaleString(void 0,{minimumFractionDigits:0,maximumFractionDigits:0})+"</span> patients per surgery</p>",show:["ni","lgd"]},box_6b:{id:"primarycare",year:Ar("DEN",u[0].place),content:"<p><span class='text-big' style='font-size: 1.2em'>"+ +u[13]("DEN.value.GDSDSSurgeries").toLocaleString()+"</span> dental surgeries</span> with an average of <span class='text-big' style='font-size: 1.2em'>"+(u[13]("DEN_REG.value.Dental_Registrations")/u[13]("DEN.value.GDSDSSurgeries")).toLocaleString(void 0,{minimumFractionDigits:0,maximumFractionDigits:0})+"</span> patients per surgery</p>",show:["dea"]},box_6c:{id:"empty",content:"",show:["sdz","dz"]}},more:`<p>Significant volumes of information are prepared by the <a href='https://www.health-ni.gov.uk/topics/doh-statistics-and-research'>Department of Health</a> \r
			and the <a href='https://bso.hscni.net/directorates/operations/family-practitioner-services/directorates-operations-family-practitioner-services-information-unit/general-ophthalmic-services-statistics/'>\r
				Business Services Organisation</a>, including statistics on <a href='https://www.health-ni.gov.uk/topics/dhssps-statistics-and-research/health-inequalities-statistics'>Health inequalities</a>, \r
				Primary care (including <a href='https://bso.hscni.net/directorates/operations/family-practitioner-services/directorates-operations-family-practitioner-services-information-unit/1776-2/'>Medical</a>, \r
				<a href='https://bso.hscni.net/directorates/operations/family-practitioner-services/directorates-operations-family-practitioner-services-information-unit/general-dental-services-statistics/'>Dental</a>, \r
				<a href='https://bso.hscni.net/directorates/operations/family-practitioner-services/directorates-operations-family-practitioner-services-information-unit/general-pharmaceutical-services-and-prescribing-statistics/'>\r
				Pharmaceutical</a> and <a href='https://bso.hscni.net/directorates/operations/family-practitioner-services/directorates-operations-family-practitioner-services-information-unit/general-ophthalmic-services-statistics/'>\r
				Ophthalmic</a>), <a href='https://www.health-ni.gov.uk/topics/dhssps-statistics-and-research/family-health-services-statistics'>\r
				Family health services</a>, <a href='https://www.health-ni.gov.uk/topics/doh-statistics-and-research-mental-health-and-learning-disabilities/mental-health-learning-disability-and-autism-statistics'>\r
				Mental health, learning disability and autism</a>, <a href='https://www.health-ni.gov.uk/topics/dhssps-statistics-and-research-social-services/social-care-statistics'>\r
				Social care</a>, <a href='https://www.health-ni.gov.uk/topics/dhssps-statistics-and-research/workforce-statistics'>Workforce</a>, and <u>COVID-19</u>.\r
				A number of <a href='https://visual.nisra.gov.uk/?body=entity/health'>interactive dashboards</a> are available and a compendium dashboard for <a href='https://visual.nisra.gov.uk/?body=entity/las'>\r
				Making Life Better</a>.\r
				The <a href='https://www.nisra.gov.uk/statistics/census'>2021 census</a> collected data on general health, long-term conditions and carers which can \r
				be explored in the <a href='https://explore.nisra.gov.uk/area-explorer-2021/N92000002/'>Census Area Explorer</a> and the <a href='https://build.nisra.gov.uk/en/'>Flexible Table Builder</a>.</p><p></p>`}}),qr=new Ml({props:{id:"work",img:"nisra-taxonomy-icon-labour-market.png",heading:"Work and Welfare",place:u[0].place,sub_heading:u[15]("Work and Welfare",u[0].place),description:" ",chart_compare_type:u[6],boxes:{box_1:{id:"employmentrates",year:Ar("LMS",u[0].place),content:"To be changed to a chart<p style='margin:0'>Employed <span class='text-big' style='font-size: 1.8em'>"+u[13]("LMS.value.EMPR").toLocaleString()+"%</span> </p><p style='margin:0'>Unemployed <span class='text-big' style='font-size: 1.8em'>"+u[13]("LMS.value.UNEMPR").toLocaleString()+"%</span> </p><p style='margin:0'>Inactive <span class='text-big' style='font-size: 1.8em'>"+u[13]("LMS.value.INACTR").toLocaleString()+"%</span></p>",show:["ni","lgd"]},box_2:{id:"employed",year:Ar("LMS",u[0].place),content:"<p><span class='text-big' style='font-size: 1.8em'>"+u[13]("LMS.value.EMPN").toLocaleString()+"</span> employed out of "+u[0].place.data.MYETotal.value.toLocaleString()+" who live in this area (including children and pensioners) possibly add working age number</p>",show:["ni","lgd"]},box_3b:{id:"bres",year:Ar("BRES",u[0].place),content:"To be changed to a chart<p style='margin:0'>Construction <span class='text-big' style='font-size: 1.8em'>"+u[13]("grouped_data_nocompare.BRES[0].perc").toLocaleString()+"</span> </p><p style='margin:0'>Manufacturing <span class='text-big' style='font-size: 1.8em'>"+u[13]("grouped_data_nocompare.BRES[1].perc").toLocaleString()+"</span> </p><p style='margin:0'>Services <span class='text-big' style='font-size: 1.8em'>"+u[13]("grouped_data_nocompare.BRES[2].perc").toLocaleString()+"</span></p><p style='margin:0'>Other <span class='text-big' style='font-size: 1.8em'>"+u[13]("grouped_data_nocompare.BRES[3].perc").toLocaleString()+"</span></p>",show:["ni","lgd"]},box_3:{id:"wages",year:Ar("ASHE",u[0].place),content:'<p><span class="text-big" style="font-size: 1.8em">'+u[13]("ASHE.value").toLocaleString()+"</span> median salary</p>",show:["ni","lgd"]},box_4:{id:"disabilitybenefits",year:Ar("BS",u[0].place),content:'<span class="text-big" style="font-size: 1.8em">'+(u[0].place.data.BS.value.PIP+u[0].place.data.BS.value.DLA+u[0].place.data.BS.value.CA+u[0].place.data.BS.value.AA).toLocaleString()+"</span> claimants"},box_5:{id:"workingagebenefits",year:Ar("BS",u[0].place),content:'<span class="text-big" style="font-size: 1.8em">'+(u[0].place.data.BS.value.UC+u[0].place.data.BS.value.JSA+u[0].place.data.BS.value.IS+u[0].place.data.BS.value.ESA).toLocaleString()+"</span> claimants"},box_6:{id:"pensionagebenefits",year:Ar("BS",u[0].place),content:'<span class="text-big" style="font-size: 1.8em">'+(u[0].place.data.BS.value.RP+u[0].place.data.BS.value.PC).toLocaleString()+"</span> claimants"}},more:`<p>The monthly <a href='https://www.nisra.gov.uk/statistics/labour-market-and-social-welfare/labour-market-overview'>Labour Market Report</a>\r
			contains the most up to date labour market statistics. The <a href='https://www.nisra.gov.uk/statistics/labour-market-and-social-welfare/annual-survey-hours-and-earnings'>\r
				Annual Survey of Hours and Earnings</a> providesdata on hourly, weekly and annual earnings. The <a href='https://www.nisra.gov.uk/statistics/labour-market-and-social-welfare/quarterly-employment-survey'>\r
					Quarterly Employment Survey</a> provides short-term employee jobs estimates for NI. Further information is available for the \r
					unemployed <a href='https://www.nisra.gov.uk/statistics/labour-market-and-social-welfare/claimant-count'>Claimant Count</a>, \r
					claimant numbers for <a href='https://www.nisra.gov.uk/statistics/labour-market-and-social-welfare/disability-benefits'>Disability Benefits</a>, \r
					and <a href='https://www.nisra.gov.uk/statistics/labour-market-and-social-welfare/work-related-benefits'>Work Related Benefits</a>. \r
					Statistics on <a href='https://www.nisra.gov.uk/statistics/labour-market-and-social-welfare/redundancies'>Redundancies</a> \r
					and <a href='https://www.nisra.gov.uk/statistics/labour-market-and-social-welfare/job-vacancies'>Job Vacancies</a> are also available. \r
					A number of <a href='https://visual.nisra.gov.uk/?body=entity/lm'>interactive dashboards</a> are available. \r
					The <a href='https://www.nisra.gov.uk/statistics/census'>2021 census</a> collected data on occupations, industry and number of hours worked which can be \r
					explored in the <a href='https://explore.nisra.gov.uk/area-explorer-2021/N92000002/'>Census Area Explorer</a> and the <a href='https://build.nisra.gov.uk/en/'>Flexible Table Builder</a>.</p>`}}),fi=new Ml({props:{id:"education",img:"nisra-taxonomy-icon-child-education-skills.png",heading:"Education",place:u[0].place,sub_heading:u[15]("Schools, colleges and universities",u[0].place),description:"",chart_compare_type:u[6],boxes:{box_1:{id:"enrollments",content:"<p style='margin:0'>Primary school <span class='text-big' style='font-size: 1.2em'>"+u[13]("Primary.value").toLocaleString()+"</span></p><p style='margin:0'>Secondary school <span class='text-big' style='font-size: 1.2em'>"+u[13]("PostPrimary.value").toLocaleString()+" </span></p><p style='margin:0'>Further education <span class='text-big' style='font-size: 1.2em'>"+u[13]("FE.value").toLocaleString()+"</span></p><p style='margin:0'>Higher education <span class='text-big' style='font-size: 1.2em'>"+u[13]("HE.value").toLocaleString()+" </span></p>",year:Ar("Primary",u[0].place),show:["ni","lgd","dea"]},box_2:{id:"fsme",content:"<p style='margin:0'>Primary school <span class='text-big' style='font-size: 1.8em'> "+u[13]("grouped_data_nocompare.Primary[0].perc")+" </span></p><p style='margin:0'>Secondary school <span class='text-big' style='font-size: 1.8em'>"+u[13]("grouped_data_nocompare.PostPrimary[0].perc")+" </span></p>",year:Ar("Primary",u[0].place),show:["ni","lgd","dea"]},box_3:{id:"teachers",year:Ar("ClassSize",u[0].place),content:"<p><span class='text-big' style='font-size: 1.8em'>"+u[13]("ClassSize.value").toLocaleString()+"</span> pupils per teacher</p>",show:["ni","lgd"]},box_4:{id:"qualifications",content:"GroupChart",year:u[14]("highest_level_of_qualifications"),chart_data:{none:u[9](u[0].place.grouped_data_nocompare.highest_level_of_qualifications,"highest_level_of_qualifications"),prev:u[9](u[0].place.grouped_data_timecompare.highest_level_of_qualifications,"highest_level_of_qualifications"),ni:u[9](u[0].place.grouped_data_areacompare.highest_level_of_qualifications,"highest_level_of_qualifications")},topic_prev_available:"true"},box_5:{id:"attainment",year:Ar("Attainment",u[0].place),content:"<p><span class='text-big' style='font-size: 1.8em'>"+u[13]("Attainment.value").toLocaleString()+"</span>% of pupils left school with 5 or more GCSEs grades A*-C (including Maths and English)</p>",show:["ni","lgd"]},box_6:{id:"destination",year:Ar("Destination",u[0].place),content:"To be changed to a chart<p style='margin:0'> Higher Education <span class='text-big' style='font-size: 1.8em'>"+u[13]("Destination.value.destHEpct").toLocaleString()+"</span> </p><p style='margin:0'> Further Education <span class='text-big' style='font-size: 1.8em'>"+u[13]("Destination.value.destFEpct").toLocaleString()+"</span> </p><p style='margin:0'> Employment <span class='text-big' style='font-size: 1.8em'>"+u[13]("Destination.value.destEmploypct").toLocaleString()+"</span> </p><p style='margin:0'> Training  <span class='text-big' style='font-size: 1.8em'>"+u[13]("Destination.value.destTrainpct").toLocaleString()+"</span> </p><p style='margin:0'> Unemployed  <span class='text-big' style='font-size: 1.8em'>"+u[13]("Destination.value.destUnempUnkpct").toLocaleString()+"</span> </p>",show:["ni","lgd","dea"]},box_6a:{id:"empty",content:"",show:["sdz","dz"]},box_6b:{id:"empty",content:"",show:["sdz","dz"]}},more:"<p>The <a href='https://www.nisra.gov.uk/statistics/children-education-and-skills/school-education-statistics'>Department of Education</a> publishes statistics on <a href='https://www.education-ni.gov.uk/articles/school-enrolments-overview'>school enrolments</a>, <a href='https://www.education-ni.gov.uk/articles/school-performance'>school performance</a>, <a href='https://www.education-ni.gov.uk/articles/school-leavers'>school leavers</a>, qualifications and destinations, <a href='https://www.education-ni.gov.uk/articles/pupil-attendance'>pupil attendance</a>, suspensions and expulsions, school meals and <a href='https://www.education-ni.gov.uk/articles/education-workforce'>education workforce</a>. The <a href='https://www.nisra.gov.uk/statistics/children-education-and-skills/higher-and-further-education-and-training-statistics'>Department for the Economy</a> publishes <a href='https://www.economy-ni.gov.uk/topics/statistics-and-economic-research/higher-education-statistics-and-research'>Higher</a> and <a href='https://www.economy-ni.gov.uk/topics/statistics-and-economic-research/further-education-statistics-and-research'>Further</a> education and <a href='https://www.economy-ni.gov.uk/articles/training-success-statistics'>training</a> statistics. The <a href='https://www.nisra.gov.uk/statistics/census'>2021 census</a> collected data on qualifications which can be explored in the <a href='https://explore.nisra.gov.uk/area-explorer-2021/N92000002/'>Census Area Explorer</a> and the <a href='https://build.nisra.gov.uk/en/'>Flexible Table Builder</a>.</p>"}}),Bi=new Ml({props:{id:"crime",img:"nisra-taxonomy-icon-crime-justice.png",heading:"Crime and Justice",place:u[0].place,sub_heading:u[15]("Crime and Court Activity",u[0].place),description:" ",chart_compare_type:u[6],boxes:{},more:""}}),qi=new Ml({props:{id:"travel",img:"nisra-taxonomy-icon-travel-transport.png",heading:"Travel and Transport",place:u[0].place,sub_heading:u[15]("Travel and transport",u[0].place),description:" ",chart_compare_type:u[6],boxes:{},more:""}}),{c(){h=qe("div"),d=qe("div"),p=qe("span"),y=qe("a"),v=Vt("Home"),a=new Bl(!1),z=xt(),jr&&jr.c(),M=xt(),F=qe("span"),L=Vt(D),X=xt(),ne=qe("div"),ce=qe("div"),ve=qe("b"),de=Vt("Search for your area:"),we=xt(),ir(Ke.$$.fragment),ut=xt(),Me=qe("script"),Ye=Vt(`// Share button\r
						// Possible tooltip: https://stackoverflow.com/questions/37798967/tooltip-on-click-of-a-button\r
\r
						function copyToClipboard(text) {\r
							var inputc = document.body.appendChild(\r
								document.createElement("input"),\r
							);\r
							inputc.value = window.location.href;\r
							inputc.select();\r
							document.execCommand("copy");\r
							inputc.parentNode.removeChild(inputc);\r
							alert("URL Copied.");\r
						}\r
\r
						(function (win, doc) {\r
							const testButton = doc.createElement("button");\r
							testButton.setAttribute("type", "share");\r
							if (testButton.type != "share") {\r
								win.addEventListener("click", function (ev) {\r
									ev = ev || win.event;\r
									let target = ev.target;\r
									let button = target.closest(\r
										'button[type="share"]',\r
									);\r
									if (button) {\r
										const title = "Share URL";\r
										const url = win.location.href;\r
										if (navigator.share) {\r
											navigator.share({\r
												title: title,\r
												url: url,\r
											});\r
										} else {\r
											copyToClipboard();\r
										}\r
									}\r
								});\r
							}\r
						})(this, this.document);`),vt=xt(),Ue=qe("div"),ct=qe("button"),mt=Vt("About"),Ze=xt(),Ft=qe("button"),yt=Vt("Print / PDF"),Ct=xt(),Le=qe("button"),Pt=Vt("Share"),At=xt(),Jt=qe("div"),ir(Nt.$$.fragment),ht=xt(),ir(De.$$.fragment),Lt=xt(),ir(Cr.$$.fragment),_i=xt(),er=qe("div"),Mr=qe("div"),Sr=qe("h3"),xi.c(),en=xt(),Wt=qe("div"),ir(ui.$$.fragment),tn=xt(),jt=qe("div"),Hr&&Hr.c(),yn=xt(),Qr=qe("div"),ti.c(),Tn=xt(),Er=qe("div"),ir(zi.$$.fragment),ci=xt(),ir(hi.$$.fragment),sn=xt(),ir(qr.$$.fragment),pi=xt(),ir(fi.$$.fragment),bi=xt(),ir(Bi.$$.fragment),Xn=xt(),ir(qi.$$.fragment),this.h()},l(re){h=je(re,"DIV",{class:!0});var dt=Ne(h);d=je(dt,"DIV",{});var Zi=Ne(d);p=je(Zi,"SPAN",{class:!0});var ri=Ne(p);y=je(ri,"A",{href:!0,"data-sveltekit-noscroll":!0,class:!0});var dr=Ne(y);v=qt(dr,"Home"),dr.forEach(ae),a=Ol(ri,!1),z=wt(ri),jr&&jr.l(ri),ri.forEach(ae),M=wt(Zi),F=je(Zi,"SPAN",{class:!0});var R=Ne(F);L=qt(R,D),R.forEach(ae),Zi.forEach(ae),X=wt(dt),ne=je(dt,"DIV",{});var N=Ne(ne);ce=je(N,"DIV",{style:!0,class:!0});var V=Ne(ce);ve=je(V,"B",{});var K=Ne(ve);de=qt(K,"Search for your area:"),K.forEach(ae),we=wt(V),nr(Ke.$$.fragment,V),ut=wt(V),Me=je(V,"SCRIPT",{});var W=Ne(Me);Ye=qt(W,`// Share button\r
						// Possible tooltip: https://stackoverflow.com/questions/37798967/tooltip-on-click-of-a-button\r
\r
						function copyToClipboard(text) {\r
							var inputc = document.body.appendChild(\r
								document.createElement("input"),\r
							);\r
							inputc.value = window.location.href;\r
							inputc.select();\r
							document.execCommand("copy");\r
							inputc.parentNode.removeChild(inputc);\r
							alert("URL Copied.");\r
						}\r
\r
						(function (win, doc) {\r
							const testButton = doc.createElement("button");\r
							testButton.setAttribute("type", "share");\r
							if (testButton.type != "share") {\r
								win.addEventListener("click", function (ev) {\r
									ev = ev || win.event;\r
									let target = ev.target;\r
									let button = target.closest(\r
										'button[type="share"]',\r
									);\r
									if (button) {\r
										const title = "Share URL";\r
										const url = win.location.href;\r
										if (navigator.share) {\r
											navigator.share({\r
												title: title,\r
												url: url,\r
											});\r
										} else {\r
											copyToClipboard();\r
										}\r
									}\r
								});\r
							}\r
						})(this, this.document);`),W.forEach(ae),vt=wt(V),Ue=je(V,"DIV",{width:!0});var se=Ne(Ue);ct=je(se,"BUTTON",{class:!0,style:!0,alt:!0,onclick:!0});var pe=Ne(ct);mt=qt(pe,"About"),pe.forEach(ae),Ze=wt(se),Ft=je(se,"BUTTON",{class:!0,style:!0,title:!0,onclick:!0});var q=Ne(Ft);yt=qt(q,"Print / PDF"),q.forEach(ae),Ct=wt(se),Le=je(se,"BUTTON",{class:!0,style:!0,type:!0,alt:!0});var ee=Ne(Le);Pt=qt(ee,"Share"),ee.forEach(ae),se.forEach(ae),V.forEach(ae),N.forEach(ae),dt.forEach(ae),At=wt(re),Jt=je(re,"DIV",{id:!0,class:!0});var ye=Ne(Jt);nr(Nt.$$.fragment,ye),ht=wt(ye),nr(De.$$.fragment,ye),Lt=wt(ye),nr(Cr.$$.fragment,ye),ye.forEach(ae),_i=wt(re),er=je(re,"DIV",{class:!0});var Pe=Ne(er);Mr=je(Pe,"DIV",{style:!0});var Fe=Ne(Mr);Sr=je(Fe,"H3",{class:!0});var ze=Ne(Sr);xi.l(ze),ze.forEach(ae),Fe.forEach(ae),en=wt(Pe),Wt=je(Pe,"DIV",{id:!0,style:!0,class:!0});var Re=Ne(Wt);nr(ui.$$.fragment,Re),Re.forEach(ae),tn=wt(Pe),jt=je(Pe,"DIV",{});var st=Ne(jt);Hr&&Hr.l(st),st.forEach(ae),yn=wt(Pe),Qr=je(Pe,"DIV",{});var it=Ne(Qr);ti.l(it),it.forEach(ae),Pe.forEach(ae),Tn=wt(re),Er=je(re,"DIV",{class:!0,id:!0});var xe=Ne(Er);nr(zi.$$.fragment,xe),ci=wt(xe),nr(hi.$$.fragment,xe),sn=wt(xe),nr(qr.$$.fragment,xe),pi=wt(xe),nr(fi.$$.fragment,xe),bi=wt(xe),nr(Bi.$$.fragment,xe),Xn=wt(xe),nr(qi.$$.fragment,xe),xe.forEach(ae),this.h()},h(){oe(y,"href",_a+"/"),oe(y,"data-sveltekit-noscroll",""),oe(y,"class","svelte-hmrro5"),a.a=z,oe(p,"class","text-small"),oe(F,"class","text-big title svelte-hmrro5"),oe(ct,"class","btn svelte-hmrro5"),Xe(ct,"width","33%"),oe(ct,"alt","Return to the landing page"),oe(ct,"onclick","window.location.href='"+_a+"/about';"),oe(Ft,"class","btn svelte-hmrro5"),Xe(Ft,"width","33%"),oe(Ft,"title","Click to print this page to pdf or printer"),oe(Ft,"onclick","window.print();return false;"),oe(Le,"class","btn svelte-hmrro5"),Xe(Le,"width","30%"),oe(Le,"type","share"),oe(Le,"alt","Share this page"),oe(Ue,"width","100%"),Xe(ce,"width","350px"),Xe(ce,"padding-top","5px"),oe(ce,"class","svelte-hmrro5"),ns(ce,"float-right",u[2]>1),oe(h,"class","grid mtl svelte-hmrro5"),oe(Jt,"id","grid"),oe(Jt,"class","grid mt svelte-hmrro5"),oe(Sr,"class","svelte-hmrro5"),Xe(Mr,"grid-column","span "+u[2]),oe(Wt,"id","map"),Xe(Wt,"padding-right","45px"),Xe(Wt,"grid-column","span "+(u[2]==2?2:u[2]&&u[2]>2?u[2]-1:1)),oe(Wt,"class","svelte-hmrro5"),oe(er,"class","grid mt svelte-hmrro5"),Gu(()=>u[19].call(er)),oe(Er,"class","accordion"),oe(Er,"id","accordionPanelsStayOpenExample")},m(re,dt){Be(re,h,dt),Ie(h,d),Ie(d,p),Ie(p,y),Ie(y,v),a.m(T,p),Ie(p,z),jr&&jr.m(p,null),Ie(d,M),Ie(d,F),Ie(F,L),Ie(h,X),Ie(h,ne),Ie(ne,ce),Ie(ce,ve),Ie(ve,de),Ie(ce,we),ar(Ke,ce,null),Ie(ce,ut),Ie(ce,Me),Ie(Me,Ye),Ie(ce,vt),Ie(ce,Ue),Ie(Ue,ct),Ie(ct,mt),Ie(Ue,Ze),Ie(Ue,Ft),Ie(Ft,yt),Ie(Ue,Ct),Ie(Ue,Le),Ie(Le,Pt),Be(re,At,dt),Be(re,Jt,dt),ar(Nt,Jt,null),Ie(Jt,ht),ar(De,Jt,null),Ie(Jt,Lt),ar(Cr,Jt,null),Be(re,_i,dt),Be(re,er,dt),Ie(er,Mr),Ie(Mr,Sr),xi.m(Sr,null),Ie(er,en),Ie(er,Wt),ar(ui,Wt,null),Ie(er,tn),Ie(er,jt),Hr&&Hr.m(jt,null),Ie(er,yn),Ie(er,Qr),ti.m(Qr,null),vi=Ku(er,u[19].bind(er)),Be(re,Tn,dt),Be(re,Er,dt),ar(zi,Er,null),Ie(Er,ci),ar(hi,Er,null),Ie(Er,sn),ar(qr,Er,null),Ie(Er,pi),ar(fi,Er,null),Ie(Er,bi),ar(Bi,Er,null),Ie(Er,Xn),ar(qi,Er,null),ji=!0},p(re,dt){re[0].place.type!="ni"?jr?jr.p(re,dt):(jr=Qm(re),jr.c(),jr.m(p,null)):jr&&(jr.d(1),jr=null),(!ji||dt[0]&1)&&D!==(D=re[0].place.name+"")&&Rr(L,D);const Zi={};dt[0]&1&&(Zi.search_data=re[0].search_data),Ke.$set(Zi),(!ji||dt[0]&4)&&ns(ce,"float-right",re[2]>1);const ri={};dt[0]&1&&(ri.heading="About "+re[0].place.name),dt[0]&1&&(ri.place=re[0].place),dt[0]&1&&(ri.content={ni:"Northern Ireland has 11 Local Government Districts (LGDs),  which can be subdivided into District Electoral Areas (DEAs), then further into Super Data Zones and Data Zones. Statistics can be viewed for these smaller areas.",lgd:re[0].place.name+" is one of "+re[0].place.count.toLocaleString()+" "+Zn[re[0].place.type].pl+".  It includes the larger settlements of "+re[0].place.lgd_location_description,dea:re[0].place.name+" is one of "+re[0].place.count.toLocaleString()+" "+Zn[re[0].place.type].pl+"in Northern Ireland.  It is within <a href = '/"+re[0].place.parents[0].code+"/' data-sveltekit-noscroll>"+re[0].place.parents[0].name+" </a> and covers "+re[0].place.dea_location_description+".",sdz:re[0].place.name+" is one of "+re[0].place.count.toLocaleString()+" "+Zn[re[0].place.type].pl+". Super Data Zones are are a new statistical output geography that have been created to support the release of local-level statistics.",dz:re[0].place.name+" is one of "+re[0].place.count.toLocaleString()+" "+Zn[re[0].place.type].pl+".  Data Zones are are a new statistical output geography that have been created to support the release of local-level statistics."}),dt[0]&64&&(ri.chart_compare_type=re[6]),Nt.$set(ri);const dr={};dt[0]&1&&(dr.place=re[0].place),dt[0]&1&&(dr.year=Ar("MYETotal",re[0].place)),dt[0]&1&&(dr.content='<span class="text-big" style="font-size: 2.8em;">'+(Math.round(re[0].place.data.MYETotal.value/1e3)*1e3).toLocaleString()+"</span>"),dt[0]&64&&(dr.chart_compare_type=re[6]),dt[0]&1&&(dr.compare_content={ni:{prev:'<span class="em '+es(re[0].place.data.population.value.change.all)+'">'+ts(re[0].place.data.population.value.change.all,"%",1)+"</span> since 2011 Census"},lgd:{prev:'<span class="em '+es(re[0].place.data.population.value.change.all)+'">'+ts(re[0].place.data.population.value.change.all,"%",1)+"</span> since 2011 Census",ni:'<span class = "em" style = "background-color: lightgrey">'+yh(re[0].place.data.population.value[2021].all/re[0].ni.data.population.value[2021].all)+"</span> of Northern Ireland population<br>The "+re[12](re[0].place.data.population.value_rank[2021].all)+" population of 11 Local Government Districts"},dea:{ni:'<span class = "em" style = "background-color: lightgrey">'+yh(re[0].place.data.population.value[2021].all/re[0].ni.data.population.value[2021].all)+"</span> of Northern Ireland population"},sdz:{prev:" nothing further",ni:" nothing further"},dz:{prev:" no comparisons",ni:" nothing further"}}),De.$set(dr);const R={};dt[0]&1&&(R.place=re[0].place),dt[0]&1&&(R.content='<span class="text-big" style="font-size: 2.8em;">'+ny(re[0].place)+"</span> people per hectare"),dt[0]&64&&(R.chart_compare_type=re[6]),dt[0]&1&&(R.compare_content={ni:{prev:'<span class="em '+es(re[0].place.data.households.value.change.all_households)+'">'+ts(re[0].place.data.households.value.change.all_households,"%",1)+"</span> since 2011 Census"},lgd:{prev:'<span class="em '+es(re[0].place.data.households.value.change.all_households)+'">'+ts(re[0].place.data.households.value.change.all_households,"%",1)+"</span> since 2011 Census",ni:re[16](re[0].place)},dea:{ni:re[16](re[0].place)},sdz:{prev:" nothing further",ni:re[16](re[0].place)},dz:{prev:" no comparisons",ni:re[16](re[0].place)}}),Cr.$set(R),gn===(gn=ta(re))&&xi?xi.p(re,dt):(xi.d(1),xi=gn(re),xi&&(xi.c(),xi.m(Sr,null))),(!ji||dt[0]&4)&&Xe(Mr,"grid-column","span "+re[2]);const N={};dt[0]&1&&(N.location={bounds:re[0].place.bounds}),dt[0]&48|dt[1]&16&&(N.$$scope={dirty:dt,ctx:re}),!Hn&&dt[0]&8&&(Hn=!0,N.map=re[3],f_(()=>Hn=!1)),ui.$set(N),(!ji||dt[0]&4)&&Xe(Wt,"grid-column","span "+(re[2]==2?2:re[2]&&re[2]>2?re[2]-1:1)),re[0].place.type!="ni"?Hr?Hr.p(re,dt):(Hr=ty(re),Hr.c(),Hr.m(jt,null)):Hr&&(Hr.d(1),Hr=null),Dn===(Dn=ra(re))&&ti?ti.p(re,dt):(ti.d(1),ti=Dn(re),ti&&(ti.c(),ti.m(Qr,null)));const V={};dt[0]&1&&(V.place=re[0].place),dt[0]&1&&(V.sub_heading=re[15]("People and Households",re[0].place)),dt[0]&64&&(V.chart_compare_type=re[6]),dt[0]&1&&(V.boxes={box_1:{id:"popchange",content:"<span > population growth/shrink to be added</span> "},box_2:{id:"age",year:re[14]("age"),content:"GroupChart",chart_data:{none:re[9](re[0].place.grouped_data_nocompare.age,"age"),prev:re[9](re[0].place.grouped_data_timecompare.age,"age"),ni:re[9](re[0].place.grouped_data_areacompare.age,"age")},topic_prev_available:"true"},box_4:{id:"hhsize",year:re[14]("hh_size"),content:"GroupChart",chart_data:{none:re[9](re[0].place.grouped_data_nocompare.hh_size,"hh_size"),prev:re[9](re[0].place.grouped_data_timecompare.hh_size,"hh_size"),ni:re[9](re[0].place.grouped_data_areacompare.hh_size,"hh_size")},topic_prev_available:"true"},box_5:{id:"religion",year:re[14]("religion_or_religion_brought_up_in"),content:"GroupChart",chart_data:{none:re[9](re[0].place.grouped_data_nocompare.religion_or_religion_brought_up_in,"religion_or_religion_brought_up_in"),prev:re[9](re[0].place.grouped_data_timecompare.religion_or_religion_brought_up_in,"religion_or_religion_brought_up_in"),ni:re[9](re[0].place.grouped_data_areacompare.religion_or_religion_brought_up_in,"religion_or_religion_brought_up_in")},topic_prev_available:"true"},box_6:{id:"language",year:re[14]("mainlang"),content:"GroupChart",chart_data:{none:re[9](re[0].place.grouped_data_nocompare.mainlang,"mainlang"),prev:re[9](re[0].place.grouped_data_timecompare.mainlang,"mainlang"),ni:re[9](re[0].place.grouped_data_areacompare.mainlang,"mainlang")},topic_prev_available:"true"}}),zi.$set(V);const K={};dt[0]&1&&(K.place=re[0].place),dt[0]&1&&(K.sub_heading=re[15]("Health and Social Care",re[0].place)),dt[0]&64&&(K.chart_compare_type=re[6]),dt[0]&193&&(K.boxes={box_1:{id:"generalhealth",year:re[14]("general_health"),content:{ni:"StackedBarChart",lgd:"StackedBarChart",dea:"StackedBarChart",sdz:"not available - needs missing 2011",dz:"not available - needs missing 2011"},chart_data:re[0].place&&re[8](["general_health"],["2011"],["2021"]),zKey:re[6],label:re[7],topic_prev_available:"true"},box_2:{id:"wellbeing",year:Ar("Happy",re[0].place),content:"<p><span class='text-big' style='font-size: 1.8em'>"+re[13]("Happy.value").toLocaleString()+"</span> / 10 happiness</p><p><span class='text-big' style='font-size: 1.8em'>"+re[13]("Satisfy.value").toLocaleString()+"</span> / 10 life satisfaction</p>",show:["ni","lgd"]},box_3:{id:"lifeexpectancy",year:Ar("LE",re[0].place),content:"<p>Male <span class='text-big' style='font-size: 1.8em'>"+re[13]("LE.value.Males").toLocaleString()+"</span> years</p><p>Female <span class='text-big' style='font-size: 1.8em'>"+re[13]("LE.value.Females").toLocaleString()+"</span> years</p>",show:["ni","lgd"]},box_4:{id:"carers",content:"GroupChart",year:re[14]("provision_care"),chart_data:{none:re[9](re[0].place.grouped_data_nocompare.provision_care,"provision_care"),prev:re[9](re[0].place.grouped_data_timecompare.provision_care,"provision_care"),ni:re[9](re[0].place.grouped_data_areacompare.provision_care,"provision_care")},label:re[7],topic_prev_available:"true"},box_5:{id:"hospitalactivity",year:Ar("Admiss",re[0].place),content:"<p><span class='text-big' style='font-size: 1.8em'>"+re[13]("Admiss.value").toLocaleString()+"</span> hospital patients</p><p>  The most frequent reason was for </p><span class='text-bold' >"+re[13]("Admiss.text")+"</span>",show:["ni","dea"]},box_6a:{id:"primarycare",year:Ar("GP",re[0].place),content:"<p><span class='text-big' style='font-size: 1.2em'>"+re[13]("GP.value.PRACS").toLocaleString()+"</span> GP practices with an average of <span class='text-big' style='font-size: 1.2em'>"+re[13]("GP.value.PRACLIST").toLocaleString()+"</span> patients per practice</p><p><span class='text-big' style='font-size: 1.2em'>"+ +re[13]("DEN.value.GDSDSSurgeries").toLocaleString()+"</span> dental surgeries</span> with an average of <span class='text-big' style='font-size: 1.2em'>"+(re[13]("DEN_REG.value.Dental_Registrations")/re[13]("DEN.value.GDSDSSurgeries")).toLocaleString(void 0,{minimumFractionDigits:0,maximumFractionDigits:0})+"</span> patients per surgery</p>",show:["ni","lgd"]},box_6b:{id:"primarycare",year:Ar("DEN",re[0].place),content:"<p><span class='text-big' style='font-size: 1.2em'>"+ +re[13]("DEN.value.GDSDSSurgeries").toLocaleString()+"</span> dental surgeries</span> with an average of <span class='text-big' style='font-size: 1.2em'>"+(re[13]("DEN_REG.value.Dental_Registrations")/re[13]("DEN.value.GDSDSSurgeries")).toLocaleString(void 0,{minimumFractionDigits:0,maximumFractionDigits:0})+"</span> patients per surgery</p>",show:["dea"]},box_6c:{id:"empty",content:"",show:["sdz","dz"]}}),hi.$set(K);const W={};dt[0]&1&&(W.place=re[0].place),dt[0]&1&&(W.sub_heading=re[15]("Work and Welfare",re[0].place)),dt[0]&64&&(W.chart_compare_type=re[6]),dt[0]&1&&(W.boxes={box_1:{id:"employmentrates",year:Ar("LMS",re[0].place),content:"To be changed to a chart<p style='margin:0'>Employed <span class='text-big' style='font-size: 1.8em'>"+re[13]("LMS.value.EMPR").toLocaleString()+"%</span> </p><p style='margin:0'>Unemployed <span class='text-big' style='font-size: 1.8em'>"+re[13]("LMS.value.UNEMPR").toLocaleString()+"%</span> </p><p style='margin:0'>Inactive <span class='text-big' style='font-size: 1.8em'>"+re[13]("LMS.value.INACTR").toLocaleString()+"%</span></p>",show:["ni","lgd"]},box_2:{id:"employed",year:Ar("LMS",re[0].place),content:"<p><span class='text-big' style='font-size: 1.8em'>"+re[13]("LMS.value.EMPN").toLocaleString()+"</span> employed out of "+re[0].place.data.MYETotal.value.toLocaleString()+" who live in this area (including children and pensioners) possibly add working age number</p>",show:["ni","lgd"]},box_3b:{id:"bres",year:Ar("BRES",re[0].place),content:"To be changed to a chart<p style='margin:0'>Construction <span class='text-big' style='font-size: 1.8em'>"+re[13]("grouped_data_nocompare.BRES[0].perc").toLocaleString()+"</span> </p><p style='margin:0'>Manufacturing <span class='text-big' style='font-size: 1.8em'>"+re[13]("grouped_data_nocompare.BRES[1].perc").toLocaleString()+"</span> </p><p style='margin:0'>Services <span class='text-big' style='font-size: 1.8em'>"+re[13]("grouped_data_nocompare.BRES[2].perc").toLocaleString()+"</span></p><p style='margin:0'>Other <span class='text-big' style='font-size: 1.8em'>"+re[13]("grouped_data_nocompare.BRES[3].perc").toLocaleString()+"</span></p>",show:["ni","lgd"]},box_3:{id:"wages",year:Ar("ASHE",re[0].place),content:'<p><span class="text-big" style="font-size: 1.8em">'+re[13]("ASHE.value").toLocaleString()+"</span> median salary</p>",show:["ni","lgd"]},box_4:{id:"disabilitybenefits",year:Ar("BS",re[0].place),content:'<span class="text-big" style="font-size: 1.8em">'+(re[0].place.data.BS.value.PIP+re[0].place.data.BS.value.DLA+re[0].place.data.BS.value.CA+re[0].place.data.BS.value.AA).toLocaleString()+"</span> claimants"},box_5:{id:"workingagebenefits",year:Ar("BS",re[0].place),content:'<span class="text-big" style="font-size: 1.8em">'+(re[0].place.data.BS.value.UC+re[0].place.data.BS.value.JSA+re[0].place.data.BS.value.IS+re[0].place.data.BS.value.ESA).toLocaleString()+"</span> claimants"},box_6:{id:"pensionagebenefits",year:Ar("BS",re[0].place),content:'<span class="text-big" style="font-size: 1.8em">'+(re[0].place.data.BS.value.RP+re[0].place.data.BS.value.PC).toLocaleString()+"</span> claimants"}}),qr.$set(W);const se={};dt[0]&1&&(se.place=re[0].place),dt[0]&1&&(se.sub_heading=re[15]("Schools, colleges and universities",re[0].place)),dt[0]&64&&(se.chart_compare_type=re[6]),dt[0]&1&&(se.boxes={box_1:{id:"enrollments",content:"<p style='margin:0'>Primary school <span class='text-big' style='font-size: 1.2em'>"+re[13]("Primary.value").toLocaleString()+"</span></p><p style='margin:0'>Secondary school <span class='text-big' style='font-size: 1.2em'>"+re[13]("PostPrimary.value").toLocaleString()+" </span></p><p style='margin:0'>Further education <span class='text-big' style='font-size: 1.2em'>"+re[13]("FE.value").toLocaleString()+"</span></p><p style='margin:0'>Higher education <span class='text-big' style='font-size: 1.2em'>"+re[13]("HE.value").toLocaleString()+" </span></p>",year:Ar("Primary",re[0].place),show:["ni","lgd","dea"]},box_2:{id:"fsme",content:"<p style='margin:0'>Primary school <span class='text-big' style='font-size: 1.8em'> "+re[13]("grouped_data_nocompare.Primary[0].perc")+" </span></p><p style='margin:0'>Secondary school <span class='text-big' style='font-size: 1.8em'>"+re[13]("grouped_data_nocompare.PostPrimary[0].perc")+" </span></p>",year:Ar("Primary",re[0].place),show:["ni","lgd","dea"]},box_3:{id:"teachers",year:Ar("ClassSize",re[0].place),content:"<p><span class='text-big' style='font-size: 1.8em'>"+re[13]("ClassSize.value").toLocaleString()+"</span> pupils per teacher</p>",show:["ni","lgd"]},box_4:{id:"qualifications",content:"GroupChart",year:re[14]("highest_level_of_qualifications"),chart_data:{none:re[9](re[0].place.grouped_data_nocompare.highest_level_of_qualifications,"highest_level_of_qualifications"),prev:re[9](re[0].place.grouped_data_timecompare.highest_level_of_qualifications,"highest_level_of_qualifications"),ni:re[9](re[0].place.grouped_data_areacompare.highest_level_of_qualifications,"highest_level_of_qualifications")},topic_prev_available:"true"},box_5:{id:"attainment",year:Ar("Attainment",re[0].place),content:"<p><span class='text-big' style='font-size: 1.8em'>"+re[13]("Attainment.value").toLocaleString()+"</span>% of pupils left school with 5 or more GCSEs grades A*-C (including Maths and English)</p>",show:["ni","lgd"]},box_6:{id:"destination",year:Ar("Destination",re[0].place),content:"To be changed to a chart<p style='margin:0'> Higher Education <span class='text-big' style='font-size: 1.8em'>"+re[13]("Destination.value.destHEpct").toLocaleString()+"</span> </p><p style='margin:0'> Further Education <span class='text-big' style='font-size: 1.8em'>"+re[13]("Destination.value.destFEpct").toLocaleString()+"</span> </p><p style='margin:0'> Employment <span class='text-big' style='font-size: 1.8em'>"+re[13]("Destination.value.destEmploypct").toLocaleString()+"</span> </p><p style='margin:0'> Training  <span class='text-big' style='font-size: 1.8em'>"+re[13]("Destination.value.destTrainpct").toLocaleString()+"</span> </p><p style='margin:0'> Unemployed  <span class='text-big' style='font-size: 1.8em'>"+re[13]("Destination.value.destUnempUnkpct").toLocaleString()+"</span> </p>",show:["ni","lgd","dea"]},box_6a:{id:"empty",content:"",show:["sdz","dz"]},box_6b:{id:"empty",content:"",show:["sdz","dz"]}}),fi.$set(se);const pe={};dt[0]&1&&(pe.place=re[0].place),dt[0]&1&&(pe.sub_heading=re[15]("Crime and Court Activity",re[0].place)),dt[0]&64&&(pe.chart_compare_type=re[6]),Bi.$set(pe);const q={};dt[0]&1&&(q.place=re[0].place),dt[0]&1&&(q.sub_heading=re[15]("Travel and transport",re[0].place)),dt[0]&64&&(q.chart_compare_type=re[6]),qi.$set(q)},i(re){ji||(Qe(Ke.$$.fragment,re),Qe(Nt.$$.fragment,re),Qe(De.$$.fragment,re),Qe(Cr.$$.fragment,re),Qe(ui.$$.fragment,re),Qe(zi.$$.fragment,re),Qe(hi.$$.fragment,re),Qe(qr.$$.fragment,re),Qe(fi.$$.fragment,re),Qe(Bi.$$.fragment,re),Qe(qi.$$.fragment,re),ji=!0)},o(re){ot(Ke.$$.fragment,re),ot(Nt.$$.fragment,re),ot(De.$$.fragment,re),ot(Cr.$$.fragment,re),ot(ui.$$.fragment,re),ot(zi.$$.fragment,re),ot(hi.$$.fragment,re),ot(qr.$$.fragment,re),ot(fi.$$.fragment,re),ot(Bi.$$.fragment,re),ot(qi.$$.fragment,re),ji=!1},d(re){re&&ae(h),jr&&jr.d(),or(Ke),re&&ae(At),re&&ae(Jt),or(Nt),or(De),or(Cr),re&&ae(_i),re&&ae(er),xi.d(),or(ui),Hr&&Hr.d(),ti.d(),vi(),re&&ae(Tn),re&&ae(Er),or(zi),or(hi),or(qr),or(fi),or(Bi),or(qi)}}}function Qm(u){let h,d=[...u[0].place.parents].reverse(),p=[];for(let y=0;y<d.length;y+=1)p[y]=$m(Ym(u,d,y));return{c(){for(let y=0;y<p.length;y+=1)p[y].c();h=sr()},l(y){for(let v=0;v<p.length;v+=1)p[v].l(y);h=sr()},m(y,v){for(let a=0;a<p.length;a+=1)p[a]&&p[a].m(y,v);Be(y,h,v)},p(y,v){if(v[0]&1){d=[...y[0].place.parents].reverse();let a;for(a=0;a<d.length;a+=1){const T=Ym(y,d,a);p[a]?p[a].p(T,v):(p[a]=$m(T),p[a].c(),p[a].m(h.parentNode,h))}for(;a<p.length;a+=1)p[a].d(1);p.length=d.length}},d(y){on(p,y),y&&ae(h)}}}function $m(u){let h,d=u[29].name+"",p,y,v,a=" &gt; ",T;return{c(){h=qe("a"),p=Vt(d),v=new Bl(!1),T=sr(),this.h()},l(z){h=je(z,"A",{href:!0,"data-sveltekit-noscroll":!0,class:!0});var M=Ne(h);p=qt(M,d),M.forEach(ae),v=Ol(z,!1),T=sr(),this.h()},h(){oe(h,"href",y=_a+"/"+u[29].code+"/"),oe(h,"data-sveltekit-noscroll",""),oe(h,"class","svelte-hmrro5"),v.a=T},m(z,M){Be(z,h,M),Ie(h,p),v.m(a,z,M),Be(z,T,M)},p(z,M){M[0]&1&&d!==(d=z[29].name+"")&&Rr(p,d),M[0]&1&&y!==(y=_a+"/"+z[29].code+"/")&&oe(h,"href",y)},d(z){z&&ae(h),z&&ae(T),z&&v.d()}}}function q1(u){let h,d;return{c(){h=qe("p"),d=Vt("Zoom and click on map to explore other areas"),this.h()},l(p){h=je(p,"P",{class:!0});var y=Ne(h);d=qt(y,"Zoom and click on map to explore other areas"),y.forEach(ae),this.h()},h(){oe(h,"class","text-bold")},m(p,y){Be(p,h,y),Ie(h,d)},p:li,d(p){p&&ae(h)}}}function j1(u){let h,d,p=u[0].place.name+"",y,v,a,T,z,M,F;return{c(){h=Vt("You are currently viewing "),d=qe("span"),y=Vt(p),v=xt(),a=qe("span"),T=xt(),z=qe("p"),M=qe("span"),F=Vt("Zoom and click on map to explore other areas"),this.h()},l(D){h=qt(D,"You are currently viewing "),d=je(D,"SPAN",{style:!0});var L=Ne(d);y=qt(L,p),L.forEach(ae),v=wt(D),a=je(D,"SPAN",{style:!0});var X=Ne(a);X.forEach(ae),T=wt(D),z=je(D,"P",{});var ne=Ne(z);M=je(ne,"SPAN",{class:!0});var ce=Ne(M);F=qt(ce,"Zoom and click on map to explore other areas"),ce.forEach(ae),ne.forEach(ae),this.h()},h(){Xe(d,"color","#3878c5"),Xe(a,"color","#00205b"),oe(M,"class","text-bold")},m(D,L){Be(D,h,L),Be(D,d,L),Ie(d,y),Be(D,v,L),Be(D,a,L),Be(D,T,L),Be(D,z,L),Ie(z,M),Ie(M,F)},p(D,L){L[0]&1&&p!==(p=D[0].place.name+"")&&Rr(y,p)},d(D){D&&ae(h),D&&ae(d),D&&ae(v),D&&ae(a),D&&ae(T),D&&ae(z)}}}function Z1(u){let h,d,p,y,v,a,T;const z=[is[u[31]],{id:u[31]+"-fill"},{type:"fill"},{isChild:u[5][u[31]]},{click:!0},{selected:u[4].selected},{highlight:!0},{highlighted:u[4].highlighted},{hover:!0},{hovered:u[4].hovered},{layout:{visibility:u[4].type==u[31]||u[4].childType==u[31]?"visible":"none"}},{paint:u[4].type==u[31]?$i["fill-self"]:u[4].childType==u[31]?$i["fill-child"]:$i.fill}];let M={};for(let ne=0;ne<z.length;ne+=1)M=gh(M,z[ne]);h=new Ap({props:M}),h.$on("select",u[10]);const F=[is[u[31]],{id:u[31]+"-bounds"},{type:"line"},{selected:u[4].selected},{highlight:!0},{highlighted:u[4].highlighted},{layout:{visibility:u[4].type==u[31]||u[4].childType==u[31]?"visible":"none"}},{paint:u[4].type==u[31]?$i["line-active"]:u[4].childType==u[31]?$i["line-child"]:$i.line}];let D={};for(let ne=0;ne<F.length;ne+=1)D=gh(D,F[ne]);p=new Ap({props:D});const L=[is[u[31]],{id:u[31]+"-self"},{type:"line"},{selected:u[4].selected},{layout:{visibility:u[4].type==u[31]?"visible":"none"}},{paint:u[4].type==u[31]?$i["line-self"]:$i.line}];let X={};for(let ne=0;ne<L.length;ne+=1)X=gh(X,L[ne]);return v=new Ap({props:X}),{c(){ir(h.$$.fragment),d=xt(),ir(p.$$.fragment),y=xt(),ir(v.$$.fragment),a=xt()},l(ne){nr(h.$$.fragment,ne),d=wt(ne),nr(p.$$.fragment,ne),y=wt(ne),nr(v.$$.fragment,ne),a=wt(ne)},m(ne,ce){ar(h,ne,ce),Be(ne,d,ce),ar(p,ne,ce),Be(ne,y,ce),ar(v,ne,ce),Be(ne,a,ce),T=!0},p(ne,ce){const ve=ce[0]&48?_h(z,[ce&0&&vh(is[ne[31]]),z[1],z[2],ce[0]&32&&{isChild:ne[5][ne[31]]},z[4],ce[0]&16&&{selected:ne[4].selected},z[6],ce[0]&16&&{highlighted:ne[4].highlighted},z[8],ce[0]&16&&{hovered:ne[4].hovered},ce[0]&16&&{layout:{visibility:ne[4].type==ne[31]||ne[4].childType==ne[31]?"visible":"none"}},ce[0]&16&&{paint:ne[4].type==ne[31]?$i["fill-self"]:ne[4].childType==ne[31]?$i["fill-child"]:$i.fill}]):{};h.$set(ve);const de=ce[0]&16?_h(F,[ce&0&&vh(is[ne[31]]),F[1],F[2],ce[0]&16&&{selected:ne[4].selected},F[4],ce[0]&16&&{highlighted:ne[4].highlighted},ce[0]&16&&{layout:{visibility:ne[4].type==ne[31]||ne[4].childType==ne[31]?"visible":"none"}},ce[0]&16&&{paint:ne[4].type==ne[31]?$i["line-active"]:ne[4].childType==ne[31]?$i["line-child"]:$i.line}]):{};p.$set(de);const we=ce[0]&16?_h(L,[ce&0&&vh(is[ne[31]]),L[1],L[2],ce[0]&16&&{selected:ne[4].selected},ce[0]&16&&{layout:{visibility:ne[4].type==ne[31]?"visible":"none"}},ce[0]&16&&{paint:ne[4].type==ne[31]?$i["line-self"]:$i.line}]):{};v.$set(we)},i(ne){T||(Qe(h.$$.fragment,ne),Qe(p.$$.fragment,ne),Qe(v.$$.fragment,ne),T=!0)},o(ne){ot(h.$$.fragment,ne),ot(p.$$.fragment,ne),ot(v.$$.fragment,ne),T=!1},d(ne){or(h,ne),ne&&ae(d),or(p,ne),ne&&ae(y),or(v,ne),ne&&ae(a)}}}function ey(u){let h,d;const p=[vd[u[31]]];let y={$$slots:{default:[Z1]},$$scope:{ctx:u}};for(let v=0;v<p.length;v+=1)y=gh(y,p[v]);return h=new Q_({props:y}),{c(){ir(h.$$.fragment)},l(v){nr(h.$$.fragment,v)},m(v,a){ar(h,v,a),d=!0},p(v,a){const T=a&0?_h(p,[vh(vd[v[31]])]):{};a[0]&48|a[1]&16&&(T.$$scope={dirty:a,ctx:v}),h.$set(T)},i(v){d||(Qe(h.$$.fragment,v),d=!0)},o(v){ot(h.$$.fragment,v),d=!1},d(v){or(h,v)}}}function G1(u){let h,d,p=["dz","sdz","dea","lgd"],y=[];for(let a=0;a<4;a+=1)y[a]=ey(Wm(u,p,a));const v=a=>ot(y[a],1,1,()=>{y[a]=null});return{c(){for(let a=0;a<4;a+=1)y[a].c();h=sr()},l(a){for(let T=0;T<4;T+=1)y[T].l(a);h=sr()},m(a,T){for(let z=0;z<4;z+=1)y[z]&&y[z].m(a,T);Be(a,h,T),d=!0},p(a,T){if(T[0]&1072){p=["dz","sdz","dea","lgd"];let z;for(z=0;z<4;z+=1){const M=Wm(a,p,z);y[z]?(y[z].p(M,T),Qe(y[z],1)):(y[z]=ey(M),y[z].c(),Qe(y[z],1),y[z].m(h.parentNode,h))}for(En(),z=4;z<4;z+=1)v(z);zn()}},i(a){if(!d){for(let T=0;T<4;T+=1)Qe(y[T]);d=!0}},o(a){y=y.filter(Boolean);for(let T=0;T<4;T+=1)ot(y[T]);d=!1},d(a){on(y,a),a&&ae(h)}}}function ty(u){let h,d,p=u[0].place.name+"",y,v,a,T=[...u[0].place.parents].reverse(),z=[];for(let M=0;M<T.length;M+=1)z[M]=ry(Xm(u,T,M));return{c(){h=qe("span"),d=Vt("Select a larger area containing "),y=Vt(p),v=xt(),a=qe("span");for(let M=0;M<z.length;M+=1)z[M].c();this.h()},l(M){h=je(M,"SPAN",{class:!0});var F=Ne(h);d=qt(F,"Select a larger area containing "),y=qt(F,p),F.forEach(ae),v=wt(M),a=je(M,"SPAN",{class:!0});var D=Ne(a);for(let L=0;L<z.length;L+=1)z[L].l(D);D.forEach(ae),this.h()},h(){oe(h,"class","text-bold"),oe(a,"class","text-small")},m(M,F){Be(M,h,F),Ie(h,d),Ie(h,y),Be(M,v,F),Be(M,a,F);for(let D=0;D<z.length;D+=1)z[D]&&z[D].m(a,null)},p(M,F){if(F[0]&1&&p!==(p=M[0].place.name+"")&&Rr(y,p),F[0]&1){T=[...M[0].place.parents].reverse();let D;for(D=0;D<T.length;D+=1){const L=Xm(M,T,D);z[D]?z[D].p(L,F):(z[D]=ry(L),z[D].c(),z[D].m(a,null))}for(;D<z.length;D+=1)z[D].d(1);z.length=T.length}},d(M){M&&ae(h),M&&ae(v),M&&ae(a),on(z,M)}}}function ry(u){let h,d,p=u[28]>0?" ":"",y,v=u[29].name+"",a,T;return{c(){h=qe("span"),d=new Bl(!1),y=qe("a"),a=Vt(v),this.h()},l(z){h=je(z,"SPAN",{style:!0});var M=Ne(h);d=Ol(M,!1),y=je(M,"A",{href:!0,"data-sveltekit-noscroll":!0,class:!0});var F=Ne(y);a=qt(F,v),F.forEach(ae),M.forEach(ae),this.h()},h(){d.a=y,oe(y,"href",T=_a+"/"+u[29].code),oe(y,"data-sveltekit-noscroll",""),oe(y,"class","svelte-hmrro5"),Xe(h,"display","block"),Xe(h,"margin-left",(u[28]>0?(u[28]-1)*15:0)+"px")},m(z,M){Be(z,h,M),d.m(p,h),Ie(h,y),Ie(y,a)},p(z,M){M[0]&1&&v!==(v=z[29].name+"")&&Rr(a,v),M[0]&1&&T!==(T=_a+"/"+z[29].code)&&oe(y,"href",T)},d(z){z&&ae(h)}}}function K1(u){let h,d,p=u[0].place.name+"",y,v,a=Zn[u[0].place.type].name+"",T;return{c(){h=qe("span"),d=Vt("No areas below "),y=Vt(p),v=xt(),T=Vt(a),this.h()},l(z){h=je(z,"SPAN",{class:!0});var M=Ne(h);d=qt(M,"No areas below "),y=qt(M,p),v=wt(M),T=qt(M,a),M.forEach(ae),this.h()},h(){oe(h,"class","muted")},m(z,M){Be(z,h,M),Ie(h,d),Ie(h,y),Ie(h,v),Ie(h,T)},p(z,M){M[0]&1&&p!==(p=z[0].place.name+"")&&Rr(y,p),M[0]&1&&a!==(a=Zn[z[0].place.type].name+"")&&Rr(T,a)},d(z){z&&ae(h)}}}function H1(u){let h,d,p=(u[0].place.children[0]?Zn[u[0].place.children[0].type].name:"Areas")+"",y,v,a=u[0].place.name+"",T,z,M,F,D=u[0].place.children,L=[];for(let X=0;X<D.length;X+=1)L[X]=iy(Hm(u,D,X));return{c(){h=qe("span"),d=Vt("Select a "),y=Vt(p),v=Vt(" within "),T=Vt(a),z=qe("br"),M=xt(),F=qe("span");for(let X=0;X<L.length;X+=1)L[X].c();this.h()},l(X){h=je(X,"SPAN",{class:!0});var ne=Ne(h);d=qt(ne,"Select a "),y=qt(ne,p),v=qt(ne," within "),T=qt(ne,a),ne.forEach(ae),z=je(X,"BR",{}),M=wt(X),F=je(X,"SPAN",{class:!0});var ce=Ne(F);for(let ve=0;ve<L.length;ve+=1)L[ve].l(ce);ce.forEach(ae),this.h()},h(){oe(h,"class","text-bold"),oe(F,"class","text-small")},m(X,ne){Be(X,h,ne),Ie(h,d),Ie(h,y),Ie(h,v),Ie(h,T),Be(X,z,ne),Be(X,M,ne),Be(X,F,ne);for(let ce=0;ce<L.length;ce+=1)L[ce]&&L[ce].m(F,null)},p(X,ne){if(ne[0]&1&&p!==(p=(X[0].place.children[0]?Zn[X[0].place.children[0].type].name:"Areas")+"")&&Rr(y,p),ne[0]&1&&a!==(a=X[0].place.name+"")&&Rr(T,a),ne[0]&1){D=X[0].place.children;let ce;for(ce=0;ce<D.length;ce+=1){const ve=Hm(X,D,ce);L[ce]?L[ce].p(ve,ne):(L[ce]=iy(ve),L[ce].c(),L[ce].m(F,null))}for(;ce<L.length;ce+=1)L[ce].d(1);L.length=D.length}},d(X){X&&ae(h),X&&ae(z),X&&ae(M),X&&ae(F),on(L,X)}}}function iy(u){let h,d=u[26].name+"",p,y,v=u[28]<u[0].place.children.length-1?", ":"",a;return{c(){h=qe("a"),p=Vt(d),a=Vt(v),this.h()},l(T){h=je(T,"A",{href:!0,"data-sveltekit-noscroll":!0,class:!0});var z=Ne(h);p=qt(z,d),z.forEach(ae),a=qt(T,v),this.h()},h(){oe(h,"href",y=_a+"/"+u[26].code),oe(h,"data-sveltekit-noscroll",""),oe(h,"class","svelte-hmrro5")},m(T,z){Be(T,h,z),Ie(h,p),Be(T,a,z)},p(T,z){z[0]&1&&d!==(d=T[26].name+"")&&Rr(p,d),z[0]&1&&y!==(y=_a+"/"+T[26].code)&&oe(h,"href",y),z[0]&1&&v!==(v=T[28]<T[0].place.children.length-1?", ":"")&&Rr(a,v)},d(T){T&&ae(h),T&&ae(a)}}}function X1(u){let h,d,p=u[0].place&&u[0].ni&&Jm(u);return{c(){p&&p.c(),h=sr()},l(y){p&&p.l(y),h=sr()},m(y,v){p&&p.m(y,v),Be(y,h,v),d=!0},p(y,v){y[0].place&&y[0].ni?p?(p.p(y,v),v[0]&1&&Qe(p,1)):(p=Jm(y),p.c(),Qe(p,1),p.m(h.parentNode,h)):p&&(En(),ot(p,1,1,()=>{p=null}),zn())},i(y){d||(Qe(p),d=!0)},o(y){ot(p),d=!1},d(y){p&&p.d(y),y&&ae(h)}}}function W1(u){let h,d,p,y,v,a,T,z,M,F,D,L,X,ne,ce,ve;return document.title=h=u[0].place.name+" NISRA Key Statistics",X=new a1({}),ce=new d_({props:{column:"wide",$$slots:{default:[X1]},$$scope:{ctx:u}}}),{c(){d=qe("meta"),p=qe("meta"),v=qe("meta"),a=qe("meta"),z=qe("meta"),F=qe("meta"),L=xt(),ir(X.$$.fragment),ne=xt(),ir(ce.$$.fragment),this.h()},l(de){const we=h_("svelte-12i6502",document.head);d=je(we,"META",{name:!0,content:!0}),p=je(we,"META",{property:!0,content:!0}),v=je(we,"META",{property:!0,content:!0}),a=je(we,"META",{property:!0,content:!0}),z=je(we,"META",{property:!0,content:!0}),F=je(we,"META",{name:!0,content:!0}),we.forEach(ae),L=wt(de),nr(X.$$.fragment,de),ne=wt(de),nr(ce.$$.fragment,de),this.h()},h(){oe(d,"name","description"),oe(d,"content",""),oe(p,"property","og:title"),oe(p,"content",y=u[0].place.name+" Census Data"),oe(v,"property","og:type"),oe(v,"content","website"),oe(a,"property","og:url"),oe(a,"content",T=Sh.base+"/"+u[0].place.code+"/"),oe(z,"property","og:description"),oe(z,"content",M="Explore NISRA Statistics for "+u[0].place.name+"."),oe(F,"name","description"),oe(F,"content",D="Explore NISRA Statistics for "+u[0].place.name+".")},m(de,we){Ie(document.head,d),Ie(document.head,p),Ie(document.head,v),Ie(document.head,a),Ie(document.head,z),Ie(document.head,F),Be(de,L,we),ar(X,de,we),Be(de,ne,we),ar(ce,de,we),ve=!0},p(de,we){(!ve||we[0]&1)&&h!==(h=de[0].place.name+" NISRA Key Statistics")&&(document.title=h),(!ve||we[0]&1&&y!==(y=de[0].place.name+" Census Data"))&&oe(p,"content",y),(!ve||we[0]&1&&T!==(T=Sh.base+"/"+de[0].place.code+"/"))&&oe(a,"content",T),(!ve||we[0]&1&&M!==(M="Explore NISRA Statistics for "+de[0].place.name+"."))&&oe(z,"content",M),(!ve||we[0]&1&&D!==(D="Explore NISRA Statistics for "+de[0].place.name+"."))&&oe(F,"content",D);const Ke={};we[0]&255|we[1]&16&&(Ke.$$scope={dirty:we,ctx:de}),ce.$set(Ke)},i(de){ve||(Qe(X.$$.fragment,de),Qe(ce.$$.fragment,de),ve=!0)},o(de){ot(X.$$.fragment,de),ot(ce.$$.fragment,de),ve=!1},d(de){ae(d),ae(p),ae(v),ae(a),ae(z),ae(F),de&&ae(L),or(X,de),de&&ae(ne),or(ce,de)}}}function yh(u){let h=(u*100).toFixed(1);return h<.1?"<0.1%":h+"%"}function Ar(u,h){return h.meta_data.hasOwnProperty(u)?h.meta_data[u][0].year:null}function ny(u){let d=u.data.population.value[Object.keys(u.data.population.value).filter(function(p){return p!="change"}).splice(-1)].all/u.hectares;return d<.1?d="< 0.1":d=d.toFixed(1),d}function Y1(u,h,d){let p,y,v,{data:a}=h,T,z,M=null,F={selected:null,type:null,childType:null,highlighted:[],hovered:null},D={};Object.keys(is).forEach(Ze=>d(5,D[Ze]=!1,D));function L(Ze,Ft,yt){const Ct=(er,Mr)=>er+Mr;let Le=Ze[0],Pt=yt[0],At=Ft[0],Jt="perc",Nt=a.place.data[Le][Jt][Pt],ht=a.place.data[Le][Jt][At],De=a.ni.data[Le][Jt][Pt],Lt=zp[Le].map(er=>er.category),Cr=zp[Le].map(er=>er.label?er.label:er.category);return Lt.map((er,Mr)=>Array.isArray(er)?{x:Cr[Mr],y:er.map(Sr=>Nt[Sr]).reduce(Ct,0),ni:er.map(Sr=>De[Sr]).reduce(Ct,0),prev:er.map(Sr=>ht[Sr]).reduce(Ct,0)}:{x:Cr[Mr],y:Nt[er],ni:De[er],prev:ht[er]})}function X(Ze,Ft){const yt=zp[Ft];let Ct=[];return yt.forEach(Le=>{let At=Ze.filter(Jt=>Jt.category===Le.category).map(Jt=>({group:Jt.group,category:Le.label,perc:Jt.perc}));Ct=[...Ct,...At]}),Ct}function ne(Ze){M&&M.fitBounds(Ze,{padding:20})}function ce(Ze){let Ft=JSON.parse(JSON.stringify(F)),yt=a.place.code,Ct=a.place.type,Le=a.place.children[0]?a.place.children.map(ht=>ht.code):[],Pt=a.place.type=="rgn"?"cty":Le[0]?a.place.children[0].type:null;d(4,F.selected=yt,F),d(4,F.type=Ct,F),d(4,F.childType=Pt,F),d(4,F.highlighted=Le,F);let At=Object.keys(is),Jt=["fill-color","fill-opacity"],Nt=["line-color","line-width","line-opacity"];M&&(F.type!=Ft.type||F.childType!=Ft.childType)&&(At.forEach(ht=>{let De=ht==Ct||Pt&&ht==Pt?"visible":"none";M.setLayoutProperty(ht+"-fill","visibility",De),M.setLayoutProperty(ht+"-bounds","visibility",De),a.place.type!="ni"&&M.setLayoutProperty(ht+"-self","visibility",De),d(5,D[ht]=ht==Pt,D)}),a.place.type!="ni"&&(Jt.forEach(ht=>M.setPaintProperty(Ct+"-fill",ht,$i[Le[0]?"fill-active":"fill-self"][ht])),Nt.forEach(ht=>{M.setPaintProperty(Ct+"-bounds",ht,$i["line-active"][ht]),M.setPaintProperty(Ct+"-self",ht,$i["line-self"][ht])})),Pt&&(Jt.forEach(ht=>M.setPaintProperty(Pt+"-fill",ht,$i["fill-child"][ht])),Nt.forEach(ht=>M.setPaintProperty(Pt+"-bounds",ht,$i["line-child"][ht]))))}function ve(Ze){ce(),ne(a.place.bounds)}function de(Ze){_d(`${_a}/${Ze.detail.code}/`,{noScroll:!0})}function we(Ze){_d(`${_a}/${Ze.detail.value}/`,{noScroll:!0})}function Ke(){d(2,z=T<575?1:window.getComputedStyle(grid).getPropertyValue("grid-template-columns").split(" ").length)}function ut(Ze){return Ze==1?"largest":Ze==a.place.count?"smallest":Ze+o_(Ze)+" largest"}function Me(Ze){let yt=Ze.replaceAll("[",".").replaceAll("]","").split("."),Ct=a.place.data;yt[0]=="grouped_data_nocompare"&&(Ct=a.place);for(let Le=0;Le<yt.length;Le++)Ct.hasOwnProperty(yt[Le])&&(Ct=Ct[yt[Le]],yt[Le]=="perc"&&(Ct=Ct.toFixed(0)+"%"));return Ct}function Ye(Ze){return a.place.data.hasOwnProperty(Ze)?Object.keys(a.place.data[Ze].perc).slice(-1):null}function vt(Ze,Ft){return Ft.type!="ni"?"Also look at  "+Ze+" data for <a href = '"+_a+"/"+Ft.parents[0].code+"/' data-sveltekit-noscroll>"+Ft.parents[0].name+" </a>":""}function Ue(Ze){let yt=Ze.data.population.value[Object.keys(Ze.data.population.value).filter(function(At){return At!="change"}).splice(-1)].all/Ze.hectares,Le=a.ni.data.population.value[Object.keys(a.ni.data.population.value).filter(function(At){return At!="change"}).splice(-1)].all/a.ni.hectares,Pt=yt/Le;return Pt.toFixed(0)=="1"?Pt='Approximately <span class = "em" style = "background-color: lightgrey">the same density level</span> as the Northern Ireland average':Pt>1?Pt='Approximately <span class = "em" style = "background-color: lightgrey">'+Pt.toFixed(0)+" times more dense</span> than the Northern Ireland average":Pt='Approximately <span class = "em" style = "background-color: lightgrey">1/'+(1/Pt).toFixed(0)+" as dense</span> as the Northern Ireland average",Pt}function ct(Ze){M=Ze,d(3,M)}function mt(){T=this.clientWidth,d(1,T)}return u.$$set=Ze=>{"data"in Ze&&d(0,a=Ze.data)},u.$$.update=()=>{u.$$.dirty[0]&2&&T&&Ke(),u.$$.dirty[0]&1&&d(7,p=a.place&&a.place.type!="ni"?"NI 2021":null),u.$$.dirty[0]&131073&&d(6,y=v?null:a.place.type!="ni"?"ni":null),u.$$.dirty[0]&1&&a.place&&ve(a.place)},d(17,v=!1),[a,T,z,M,F,D,y,p,L,X,de,we,ut,Me,Ye,vt,Ue,v,ct,mt]}class ab extends fn{constructor(h){super(),dn(this,h,Y1,W1,mn,{data:0},null,[-1,-1])}}export{ab as component,nb as universal};
