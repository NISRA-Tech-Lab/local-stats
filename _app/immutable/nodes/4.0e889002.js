import{g as H_,c as md,a as yd,S as J_}from"../chunks/navigation.689ed6ec.js";import{g as No,a as xh,m as rs,b as Sp,c as Y_,d as Hi,e as _d}from"../chunks/config.c24437b0.js";import{S as fn,i as dn,s as mn,k as Fe,l as Ne,m as Be,h as ae,n as oe,R as Uu,b as Re,T as Vu,g as rt,v as to,d as lt,f as ro,P as Hm,o as Jm,K as Mu,M as Du,N as Lu,O as Ru,w as Bu,e as br,E as ju,U as Q_,Q as Xt,V as Ir,p as Ge,W as Wn,X as Hn,C as Te,D as _i,Y as nn,Z as Xn,q as Et,r as Tt,u as Tr,y as ir,z as nr,A as or,B as ar,a as dt,c as mt,_ as Ih,G as ho,I as qu,$ as Zu,a0 as Gu,F as gd,L as $_,a1 as eg,a2 as tg,a3 as dh,a4 as mh,a5 as yh}from"../chunks/index.baf6a862.js";import{b as Co}from"../chunks/paths.8328208a.js";import{S as rg}from"../chunks/Section.6106804d.js";/* empty css                                                              */import{w as zr,h as Pi}from"../chunks/singletons.fa912a1c.js";async function vd(h,c){return await(await c(xh.app_json_data+h+".json")).json()}async function ig({params:h,fetch:c}){let d=h.code,f=await H_(xh.search_data,c),_={};f.forEach(T=>_[T.code]=T.name),f.forEach(T=>{T.typepl=No[T.type].pl,T.typenm=No[T.type].name,T.typestr=_[T.parent]&&T.parent==T.code?`${No[T.type].name} is within  ${_[T.parent]}
        ${No[T.parent_type].name}  `:_[T.parent]&&T.parent!=T.code?`${No[T.type].name} `:""});let v=f.sort((T,M)=>T.name.localeCompare(M.name)),o=await vd("N92000002",c),z=await vd(d,c);return{search_data:v,place:z,ni:o}}const J1=Object.freeze(Object.defineProperty({__proto__:null,load:ig},Symbol.toStringTag,{value:"Module"}));var ng=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function og(h){return h&&h.__esModule&&Object.prototype.hasOwnProperty.call(h,"default")?h.default:h}var ag={rgb2hsl:Ku,rgb2hsv:zh,rgb2hwb:Xu,rgb2cmyk:Wu,rgb2keyword:Hu,rgb2xyz:Fp,rgb2lab:Np,rgb2lch:sg,hsl2rgb:Ah,hsl2hsv:lg,hsl2hwb:ug,hsl2cmyk:cg,hsl2keyword:hg,hsv2rgb:Ph,hsv2hsl:pg,hsv2hwb:fg,hsv2cmyk:dg,hsv2keyword:mg,hwb2rgb:Ju,hwb2hsl:yg,hwb2hsv:_g,hwb2cmyk:gg,hwb2keyword:vg,cmyk2rgb:Yu,cmyk2hsl:bg,cmyk2hsv:xg,cmyk2hwb:wg,cmyk2keyword:kg,keyword2rgb:Rs,keyword2hsl:Ig,keyword2hsv:zg,keyword2hwb:Ag,keyword2cmyk:Pg,keyword2lab:Cg,keyword2xyz:Mg,xyz2rgb:Ym,xyz2lab:Qm,xyz2lch:Sg,lab2xyz:Up,lab2rgb:$m,lab2lch:Vp,lch2lab:jp,lch2xyz:Eg,lch2rgb:Tg};function Ku(h){var c=h[0]/255,d=h[1]/255,f=h[2]/255,_=Math.min(c,d,f),v=Math.max(c,d,f),o=v-_,z,T,M;return v==_?z=0:c==v?z=(d-f)/o:d==v?z=2+(f-c)/o:f==v&&(z=4+(c-d)/o),z=Math.min(z*60,360),z<0&&(z+=360),M=(_+v)/2,v==_?T=0:M<=.5?T=o/(v+_):T=o/(2-v-_),[z,T*100,M*100]}function zh(h){var c=h[0],d=h[1],f=h[2],_=Math.min(c,d,f),v=Math.max(c,d,f),o=v-_,z,T,M;return v==0?T=0:T=o/v*1e3/10,v==_?z=0:c==v?z=(d-f)/o:d==v?z=2+(f-c)/o:f==v&&(z=4+(c-d)/o),z=Math.min(z*60,360),z<0&&(z+=360),M=v/255*1e3/10,[z,T,M]}function Xu(h){var c=h[0],d=h[1],v=h[2],f=Ku(h)[0],_=1/255*Math.min(c,Math.min(d,v)),v=1-1/255*Math.max(c,Math.max(d,v));return[f,_*100,v*100]}function Wu(h){var c=h[0]/255,d=h[1]/255,f=h[2]/255,_,v,o,z;return z=Math.min(1-c,1-d,1-f),_=(1-c-z)/(1-z)||0,v=(1-d-z)/(1-z)||0,o=(1-f-z)/(1-z)||0,[_*100,v*100,o*100,z*100]}function Hu(h){return ey[JSON.stringify(h)]}function Fp(h){var c=h[0]/255,d=h[1]/255,f=h[2]/255;c=c>.04045?Math.pow((c+.055)/1.055,2.4):c/12.92,d=d>.04045?Math.pow((d+.055)/1.055,2.4):d/12.92,f=f>.04045?Math.pow((f+.055)/1.055,2.4):f/12.92;var _=c*.4124+d*.3576+f*.1805,v=c*.2126+d*.7152+f*.0722,o=c*.0193+d*.1192+f*.9505;return[_*100,v*100,o*100]}function Np(h){var c=Fp(h),d=c[0],f=c[1],_=c[2],v,o,z;return d/=95.047,f/=100,_/=108.883,d=d>.008856?Math.pow(d,1/3):7.787*d+16/116,f=f>.008856?Math.pow(f,1/3):7.787*f+16/116,_=_>.008856?Math.pow(_,1/3):7.787*_+16/116,v=116*f-16,o=500*(d-f),z=200*(f-_),[v,o,z]}function sg(h){return Vp(Np(h))}function Ah(h){var c=h[0]/360,d=h[1]/100,f=h[2]/100,_,v,o,z,T;if(d==0)return T=f*255,[T,T,T];f<.5?v=f*(1+d):v=f+d-f*d,_=2*f-v,z=[0,0,0];for(var M=0;M<3;M++)o=c+1/3*-(M-1),o<0&&o++,o>1&&o--,6*o<1?T=_+(v-_)*6*o:2*o<1?T=v:3*o<2?T=_+(v-_)*(2/3-o)*6:T=_,z[M]=T*255;return z}function lg(h){var c=h[0],d=h[1]/100,f=h[2]/100,_,v;return f===0?[0,0,0]:(f*=2,d*=f<=1?f:2-f,v=(f+d)/2,_=2*d/(f+d),[c,_*100,v*100])}function ug(h){return Xu(Ah(h))}function cg(h){return Wu(Ah(h))}function hg(h){return Hu(Ah(h))}function Ph(h){var c=h[0]/60,d=h[1]/100,T=h[2]/100,f=Math.floor(c)%6,_=c-Math.floor(c),v=255*T*(1-d),o=255*T*(1-d*_),z=255*T*(1-d*(1-_)),T=255*T;switch(f){case 0:return[T,z,v];case 1:return[o,T,v];case 2:return[v,T,z];case 3:return[v,o,T];case 4:return[z,v,T];case 5:return[T,v,o]}}function pg(h){var c=h[0],d=h[1]/100,f=h[2]/100,_,v;return v=(2-d)*f,_=d*f,_/=v<=1?v:2-v,_=_||0,v/=2,[c,_*100,v*100]}function fg(h){return Xu(Ph(h))}function dg(h){return Wu(Ph(h))}function mg(h){return Hu(Ph(h))}function Ju(h){var c=h[0]/360,d=h[1]/100,f=h[2]/100,_=d+f,v,o,z,T;switch(_>1&&(d/=_,f/=_),v=Math.floor(6*c),o=1-f,z=6*c-v,v&1&&(z=1-z),T=d+z*(o-d),v){default:case 6:case 0:r=o,g=T,b=d;break;case 1:r=T,g=o,b=d;break;case 2:r=d,g=o,b=T;break;case 3:r=d,g=T,b=o;break;case 4:r=T,g=d,b=o;break;case 5:r=o,g=d,b=T;break}return[r*255,g*255,b*255]}function yg(h){return Ku(Ju(h))}function _g(h){return zh(Ju(h))}function gg(h){return Wu(Ju(h))}function vg(h){return Hu(Ju(h))}function Yu(h){var c=h[0]/100,d=h[1]/100,f=h[2]/100,_=h[3]/100,v,o,z;return v=1-Math.min(1,c*(1-_)+_),o=1-Math.min(1,d*(1-_)+_),z=1-Math.min(1,f*(1-_)+_),[v*255,o*255,z*255]}function bg(h){return Ku(Yu(h))}function xg(h){return zh(Yu(h))}function wg(h){return Xu(Yu(h))}function kg(h){return Hu(Yu(h))}function Ym(h){var c=h[0]/100,d=h[1]/100,f=h[2]/100,_,v,o;return _=c*3.2406+d*-1.5372+f*-.4986,v=c*-.9689+d*1.8758+f*.0415,o=c*.0557+d*-.204+f*1.057,_=_>.0031308?1.055*Math.pow(_,1/2.4)-.055:_=_*12.92,v=v>.0031308?1.055*Math.pow(v,1/2.4)-.055:v=v*12.92,o=o>.0031308?1.055*Math.pow(o,1/2.4)-.055:o=o*12.92,_=Math.min(Math.max(0,_),1),v=Math.min(Math.max(0,v),1),o=Math.min(Math.max(0,o),1),[_*255,v*255,o*255]}function Qm(h){var c=h[0],d=h[1],f=h[2],_,v,o;return c/=95.047,d/=100,f/=108.883,c=c>.008856?Math.pow(c,1/3):7.787*c+16/116,d=d>.008856?Math.pow(d,1/3):7.787*d+16/116,f=f>.008856?Math.pow(f,1/3):7.787*f+16/116,_=116*d-16,v=500*(c-d),o=200*(d-f),[_,v,o]}function Sg(h){return Vp(Qm(h))}function Up(h){var c=h[0],d=h[1],f=h[2],_,v,o,z;return c<=8?(v=c*100/903.3,z=7.787*(v/100)+16/116):(v=100*Math.pow((c+16)/116,3),z=Math.pow(v/100,1/3)),_=_/95.047<=.008856?_=95.047*(d/500+z-16/116)/7.787:95.047*Math.pow(d/500+z,3),o=o/108.883<=.008859?o=108.883*(z-f/200-16/116)/7.787:108.883*Math.pow(z-f/200,3),[_,v,o]}function Vp(h){var c=h[0],d=h[1],f=h[2],_,v,o;return _=Math.atan2(f,d),v=_*360/2/Math.PI,v<0&&(v+=360),o=Math.sqrt(d*d+f*f),[c,o,v]}function $m(h){return Ym(Up(h))}function jp(h){var c=h[0],d=h[1],f=h[2],_,v,o;return o=f/360*2*Math.PI,_=d*Math.cos(o),v=d*Math.sin(o),[c,_,v]}function Eg(h){return Up(jp(h))}function Tg(h){return $m(jp(h))}function Rs(h){return Cp[h]}function Ig(h){return Ku(Rs(h))}function zg(h){return zh(Rs(h))}function Ag(h){return Xu(Rs(h))}function Pg(h){return Wu(Rs(h))}function Cg(h){return Np(Rs(h))}function Mg(h){return Fp(Rs(h))}var Cp={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,134,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,250,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,221],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[112,128,144],slategrey:[112,128,144],snow:[255,250,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,50]},ey={};for(var bd in Cp)ey[JSON.stringify(Cp[bd])]=bd;var Ep=ag,Cl=function(){return new Qu};for(var Pu in Ep){Cl[Pu+"Raw"]=function(h){return function(c){return typeof c=="number"&&(c=Array.prototype.slice.call(arguments)),Ep[h](c)}}(Pu);var xd=/(\w+)2(\w+)/.exec(Pu),Tp=xd[1],Dg=xd[2];Cl[Tp]=Cl[Tp]||{},Cl[Tp][Dg]=Cl[Pu]=function(h){return function(c){typeof c=="number"&&(c=Array.prototype.slice.call(arguments));var d=Ep[h](c);if(typeof d=="string"||d===void 0)return d;for(var f=0;f<d.length;f++)d[f]=Math.round(d[f]);return d}}(Pu)}var Qu=function(){this.convs={}};Qu.prototype.routeSpace=function(h,c){var d=c[0];return d===void 0?this.getValues(h):(typeof d=="number"&&(d=Array.prototype.slice.call(c)),this.setValues(h,d))};Qu.prototype.setValues=function(h,c){return this.space=h,this.convs={},this.convs[h]=c,this};Qu.prototype.getValues=function(h){var c=this.convs[h];if(!c){var d=this.space,f=this.convs[d];c=Cl[d][h](f),this.convs[h]=c}return c};["rgb","hsl","hsv","cmyk","keyword"].forEach(function(h){Qu.prototype[h]=function(c){return this.routeSpace(h,arguments)}});var ty={exports:{}};(function(h,c){(function(d,f){h.exports=f()})(ng,function(){var d,f,_;function v(o,z){if(!d)d=z;else if(!f)f=z;else{var T="var sharedChunk = {}; ("+d+")(sharedChunk); ("+f+")(sharedChunk);",M={};d(M),_=z(M),typeof window<"u"&&(_.workerUrl=window.URL.createObjectURL(new Blob([T],{type:"text/javascript"})))}}return v(["exports"],function(o){function z(e,t){return e(t={exports:{}},t.exports),t.exports}var T=M;function M(e,t,i,l){this.cx=3*e,this.bx=3*(i-e)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*t,this.by=3*(l-t)-this.cy,this.ay=1-this.cy-this.by,this.p1x=e,this.p1y=l,this.p2x=i,this.p2y=l}M.prototype.sampleCurveX=function(e){return((this.ax*e+this.bx)*e+this.cx)*e},M.prototype.sampleCurveY=function(e){return((this.ay*e+this.by)*e+this.cy)*e},M.prototype.sampleCurveDerivativeX=function(e){return(3*this.ax*e+2*this.bx)*e+this.cx},M.prototype.solveCurveX=function(e,t){var i,l,p,m,x;for(t===void 0&&(t=1e-6),p=e,x=0;x<8;x++){if(m=this.sampleCurveX(p)-e,Math.abs(m)<t)return p;var S=this.sampleCurveDerivativeX(p);if(Math.abs(S)<1e-6)break;p-=m/S}if((p=e)<(i=0))return i;if(p>(l=1))return l;for(;i<l;){if(m=this.sampleCurveX(p),Math.abs(m-e)<t)return p;e>m?i=p:l=p,p=.5*(l-i)+i}return p},M.prototype.solve=function(e,t){return this.sampleCurveY(this.solveCurveX(e,t))};var F=R;function R(e,t){this.x=e,this.y=t}R.prototype={clone:function(){return new R(this.x,this.y)},add:function(e){return this.clone()._add(e)},sub:function(e){return this.clone()._sub(e)},multByPoint:function(e){return this.clone()._multByPoint(e)},divByPoint:function(e){return this.clone()._divByPoint(e)},mult:function(e){return this.clone()._mult(e)},div:function(e){return this.clone()._div(e)},rotate:function(e){return this.clone()._rotate(e)},rotateAround:function(e,t){return this.clone()._rotateAround(e,t)},matMult:function(e){return this.clone()._matMult(e)},unit:function(){return this.clone()._unit()},perp:function(){return this.clone()._perp()},round:function(){return this.clone()._round()},mag:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals:function(e){return this.x===e.x&&this.y===e.y},dist:function(e){return Math.sqrt(this.distSqr(e))},distSqr:function(e){var t=e.x-this.x,i=e.y-this.y;return t*t+i*i},angle:function(){return Math.atan2(this.y,this.x)},angleTo:function(e){return Math.atan2(this.y-e.y,this.x-e.x)},angleWith:function(e){return this.angleWithSep(e.x,e.y)},angleWithSep:function(e,t){return Math.atan2(this.x*t-this.y*e,this.x*e+this.y*t)},_matMult:function(e){var t=e[2]*this.x+e[3]*this.y;return this.x=e[0]*this.x+e[1]*this.y,this.y=t,this},_add:function(e){return this.x+=e.x,this.y+=e.y,this},_sub:function(e){return this.x-=e.x,this.y-=e.y,this},_mult:function(e){return this.x*=e,this.y*=e,this},_div:function(e){return this.x/=e,this.y/=e,this},_multByPoint:function(e){return this.x*=e.x,this.y*=e.y,this},_divByPoint:function(e){return this.x/=e.x,this.y/=e.y,this},_unit:function(){return this._div(this.mag()),this},_perp:function(){var e=this.y;return this.y=this.x,this.x=-e,this},_rotate:function(e){var t=Math.cos(e),i=Math.sin(e),l=i*this.x+t*this.y;return this.x=t*this.x-i*this.y,this.y=l,this},_rotateAround:function(e,t){var i=Math.cos(e),l=Math.sin(e),p=t.y+l*(this.x-t.x)+i*(this.y-t.y);return this.x=t.x+i*(this.x-t.x)-l*(this.y-t.y),this.y=p,this},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}},R.convert=function(e){return e instanceof R?e:Array.isArray(e)?new R(e[0],e[1]):e};var D=typeof self<"u"?self:{},H=Math.pow(2,53)-1;function ne(e,t,i,l){var p=new T(e,t,i,l);return function(m){return p.solve(m)}}var he=ne(.25,.1,.25,1);function ve(e,t,i){return Math.min(i,Math.max(t,e))}function me(e,t,i){var l=i-t,p=((e-t)%l+l)%l+t;return p===t?i:p}function xe(e){for(var t=[],i=arguments.length-1;i-- >0;)t[i]=arguments[i+1];for(var l=0,p=t;l<p.length;l+=1){var m=p[l];for(var x in m)e[x]=m[x]}return e}var ot=1;function Je(){return ot++}function Le(){return function e(t){return t?(t^16*Math.random()>>t/4).toString(16):([1e7]+-[1e3]+-4e3+-8e3+-1e11).replace(/[018]/g,e)}()}function Ye(e){return!!e&&/^[0-9a-f]{8}-[0-9a-f]{4}-[4][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i.test(e)}function It(e,t){e.forEach(function(i){t[i]&&(t[i]=t[i].bind(t))})}function Lt(e,t){return e.indexOf(t,e.length-t.length)!==-1}function jt(e,t,i){var l={};for(var p in e)l[p]=t.call(i||this,e[p],p,e);return l}function _t(e,t,i){var l={};for(var p in e)t.call(i||this,e[p],p,e)&&(l[p]=e[p]);return l}function ht(e){return Array.isArray(e)?e.map(ht):typeof e=="object"&&e?jt(e,ht):e}var Ft={};function yt(e){Ft[e]||(typeof console<"u"&&console.warn(e),Ft[e]=!0)}function zt(e,t,i){return(i.y-e.y)*(t.x-e.x)>(t.y-e.y)*(i.x-e.x)}function et(e){for(var t=0,i=0,l=e.length,p=l-1,m=void 0,x=void 0;i<l;p=i++)t+=((x=e[p]).x-(m=e[i]).x)*(m.y+x.y);return t}function qt(){return typeof WorkerGlobalScope<"u"&&typeof self<"u"&&self instanceof WorkerGlobalScope}function pt(e){var t={};if(e.replace(/(?:^|(?:\s*\,\s*))([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)(?:\=(?:([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)|(?:\"((?:[^"\\]|\\.)*)\")))?/g,function(l,p,m,x){var S=m||x;return t[p]=!S||S.toLowerCase(),""}),t["max-age"]){var i=parseInt(t["max-age"],10);isNaN(i)?delete t["max-age"]:t["max-age"]=i}return t}var At=null;function Ut(e){if(At==null){var t=e.navigator?e.navigator.userAgent:null;At=!!e.safari||!(!t||!(/\b(iPad|iPhone|iPod)\b/.test(t)||t.match("Safari")&&!t.match("Chrome")))}return At}function cr(e){try{var t=D[e];return t.setItem("_mapbox_test_",1),t.removeItem("_mapbox_test_"),!0}catch{return!1}}var Ve,fr,hr,xr,Fr=D.performance&&D.performance.now?D.performance.now.bind(D.performance):Date.now.bind(Date),wi=D.requestAnimationFrame||D.mozRequestAnimationFrame||D.webkitRequestAnimationFrame||D.msRequestAnimationFrame,sr=D.cancelAnimationFrame||D.mozCancelAnimationFrame||D.webkitCancelAnimationFrame||D.msCancelAnimationFrame,Qr={now:Fr,frame:function(e){var t=wi(e);return{cancel:function(){return sr(t)}}},getImageData:function(e,t){t===void 0&&(t=0);var i=D.document.createElement("canvas"),l=i.getContext("2d");if(!l)throw new Error("failed to create canvas 2d context");return i.width=e.width,i.height=e.height,l.drawImage(e,0,0,e.width,e.height),l.getImageData(-t,-t,e.width+2*t,e.height+2*t)},resolveURL:function(e){return Ve||(Ve=D.document.createElement("a")),Ve.href=e,Ve.href},hardwareConcurrency:D.navigator&&D.navigator.hardwareConcurrency||4,get devicePixelRatio(){return D.devicePixelRatio},get prefersReducedMotion(){return!!D.matchMedia&&(fr==null&&(fr=D.matchMedia("(prefers-reduced-motion: reduce)")),fr.matches)}},kt={API_URL:"https://api.mapbox.com",get EVENTS_URL(){return this.API_URL?this.API_URL.indexOf("https://api.mapbox.cn")===0?"https://events.mapbox.cn/events/v2":this.API_URL.indexOf("https://api.mapbox.com")===0?"https://events.mapbox.com/events/v2":null:null},FEEDBACK_URL:"https://apps.mapbox.com/feedback",REQUIRE_ACCESS_TOKEN:!0,ACCESS_TOKEN:null,MAX_PARALLEL_IMAGE_REQUESTS:16},Ur={supported:!1,testSupport:function(e){!Tn&&xr&&($r?Zt(e):hr=e)}},Tn=!1,$r=!1;function Zt(e){var t=e.createTexture();e.bindTexture(e.TEXTURE_2D,t);try{if(e.texImage2D(e.TEXTURE_2D,0,e.RGBA,e.RGBA,e.UNSIGNED_BYTE,xr),e.isContextLost())return;Ur.supported=!0}catch{}e.deleteTexture(t),Tn=!0}D.document&&((xr=D.document.createElement("img")).onload=function(){hr&&Zt(hr),hr=null,$r=!0},xr.onerror=function(){Tn=!0,hr=null},xr.src="data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAQAAAAfQ//73v/+BiOh/AAA=");var $t="01",Dr=function(e,t){this._transformRequestFn=e,this._customAccessToken=t,this._createSkuToken()};function Pr(e){return e.indexOf("mapbox:")===0}Dr.prototype._createSkuToken=function(){var e=function(){for(var t="",i=0;i<10;i++)t+="0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ"[Math.floor(62*Math.random())];return{token:["1",$t,t].join(""),tokenExpiresAt:Date.now()+432e5}}();this._skuToken=e.token,this._skuTokenExpiresAt=e.tokenExpiresAt},Dr.prototype._isSkuTokenExpired=function(){return Date.now()>this._skuTokenExpiresAt},Dr.prototype.transformRequest=function(e,t){return this._transformRequestFn&&this._transformRequestFn(e,t)||{url:e}},Dr.prototype.normalizeStyleURL=function(e,t){if(!Pr(e))return e;var i=ci(e);return i.path="/styles/v1"+i.path,this._makeAPIURL(i,this._customAccessToken||t)},Dr.prototype.normalizeGlyphsURL=function(e,t){if(!Pr(e))return e;var i=ci(e);return i.path="/fonts/v1"+i.path,this._makeAPIURL(i,this._customAccessToken||t)},Dr.prototype.normalizeSourceURL=function(e,t){if(!Pr(e))return e;var i=ci(e);return i.path="/v4/"+i.authority+".json",i.params.push("secure"),this._makeAPIURL(i,this._customAccessToken||t)},Dr.prototype.normalizeSpriteURL=function(e,t,i,l){var p=ci(e);return Pr(e)?(p.path="/styles/v1"+p.path+"/sprite"+t+i,this._makeAPIURL(p,this._customAccessToken||l)):(p.path+=""+t+i,Ji(p))},Dr.prototype.normalizeTileURL=function(e,t){if(this._isSkuTokenExpired()&&this._createSkuToken(),e&&!Pr(e))return e;var i=ci(e);i.path=i.path.replace(/(\.(png|jpg)\d*)(?=$)/,(Qr.devicePixelRatio>=2||t===512?"@2x":"")+(Ur.supported?".webp":"$1")),i.path=i.path.replace(/^.+\/v4\//,"/"),i.path="/v4"+i.path;var l=this._customAccessToken||function(p){for(var m=0,x=p;m<x.length;m+=1){var S=x[m].match(/^access_token=(.*)$/);if(S)return S[1]}return null}(i.params)||kt.ACCESS_TOKEN;return kt.REQUIRE_ACCESS_TOKEN&&l&&this._skuToken&&i.params.push("sku="+this._skuToken),this._makeAPIURL(i,l)},Dr.prototype.canonicalizeTileURL=function(e,t){var i=ci(e);if(!i.path.match(/(^\/v4\/)/)||!i.path.match(/\.[\w]+$/))return e;var l="mapbox://tiles/";l+=i.path.replace("/v4/","");var p=i.params;return t&&(p=p.filter(function(m){return!m.match(/^access_token=/)})),p.length&&(l+="?"+p.join("&")),l},Dr.prototype.canonicalizeTileset=function(e,t){for(var i=!!t&&Pr(t),l=[],p=0,m=e.tiles||[];p<m.length;p+=1){var x=m[p];Xr(x)?l.push(this.canonicalizeTileURL(x,i)):l.push(x)}return l},Dr.prototype._makeAPIURL=function(e,t){var i="See https://www.mapbox.com/api-documentation/#access-tokens-and-token-scopes",l=ci(kt.API_URL);if(e.protocol=l.protocol,e.authority=l.authority,e.protocol==="http"){var p=e.params.indexOf("secure");p>=0&&e.params.splice(p,1)}if(l.path!=="/"&&(e.path=""+l.path+e.path),!kt.REQUIRE_ACCESS_TOKEN)return Ji(e);if(!(t=t||kt.ACCESS_TOKEN))throw new Error("An API access token is required to use Mapbox GL. "+i);if(t[0]==="s")throw new Error("Use a public access token (pk.*) with Mapbox GL, not a secret access token (sk.*). "+i);return e.params=e.params.filter(function(m){return m.indexOf("access_token")===-1}),e.params.push("access_token="+t),Ji(e)};var Dn=/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/|\?|$)/i;function Xr(e){return Dn.test(e)}var gi=/^(\w+):\/\/([^/?]*)(\/[^?]+)?\??(.+)?/;function ci(e){var t=e.match(gi);if(!t)throw new Error("Unable to parse URL object");return{protocol:t[1],authority:t[2],path:t[3]||"/",params:t[4]?t[4].split("&"):[]}}function Ji(e){var t=e.params.length?"?"+e.params.join("&"):"";return e.protocol+"://"+e.authority+e.path+t}function Ci(e){if(!e)return null;var t=e.split(".");if(!t||t.length!==3)return null;try{return JSON.parse(decodeURIComponent(D.atob(t[1]).split("").map(function(i){return"%"+("00"+i.charCodeAt(0).toString(16)).slice(-2)}).join("")))}catch{return null}}var hi=function(e){this.type=e,this.anonId=null,this.eventData={},this.queue=[],this.pendingRequest=null};hi.prototype.getStorageKey=function(e){var t,i=Ci(kt.ACCESS_TOKEN);return t=i&&i.u?D.btoa(encodeURIComponent(i.u).replace(/%([0-9A-F]{2})/g,function(l,p){return String.fromCharCode(+("0x"+p))})):kt.ACCESS_TOKEN||"",e?"mapbox.eventData."+e+":"+t:"mapbox.eventData:"+t},hi.prototype.fetchEventData=function(){var e=cr("localStorage"),t=this.getStorageKey(),i=this.getStorageKey("uuid");if(e)try{var l=D.localStorage.getItem(t);l&&(this.eventData=JSON.parse(l));var p=D.localStorage.getItem(i);p&&(this.anonId=p)}catch{yt("Unable to read from LocalStorage")}},hi.prototype.saveEventData=function(){var e=cr("localStorage"),t=this.getStorageKey(),i=this.getStorageKey("uuid");if(e)try{D.localStorage.setItem(i,this.anonId),Object.keys(this.eventData).length>=1&&D.localStorage.setItem(t,JSON.stringify(this.eventData))}catch{yt("Unable to write to LocalStorage")}},hi.prototype.processRequests=function(e){},hi.prototype.postEvent=function(e,t,i,l){var p=this;if(kt.EVENTS_URL){var m=ci(kt.EVENTS_URL);m.params.push("access_token="+(l||kt.ACCESS_TOKEN||""));var x={event:this.type,created:new Date(e).toISOString(),sdkIdentifier:"mapbox-gl-js",sdkVersion:"1.13.2",skuId:$t,userId:this.anonId},S=t?xe(x,t):x,I={url:Ji(m),headers:{"Content-Type":"text/plain"},body:JSON.stringify([S])};this.pendingRequest=Cr(I,function(A){p.pendingRequest=null,i(A),p.saveEventData(),p.processRequests(l)})}},hi.prototype.queueRequest=function(e,t){this.queue.push(e),this.processRequests(t)};var ei,on,pi=function(e){function t(){e.call(this,"map.load"),this.success={},this.skuToken=""}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.postMapLoadEvent=function(i,l,p,m){this.skuToken=p,(kt.EVENTS_URL&&m||kt.ACCESS_TOKEN&&Array.isArray(i)&&i.some(function(x){return Pr(x)||Xr(x)}))&&this.queueRequest({id:l,timestamp:Date.now()},m)},t.prototype.processRequests=function(i){var l=this;if(!this.pendingRequest&&this.queue.length!==0){var p=this.queue.shift(),m=p.id,x=p.timestamp;m&&this.success[m]||(this.anonId||this.fetchEventData(),Ye(this.anonId)||(this.anonId=Le()),this.postEvent(x,{skuToken:this.skuToken},function(S){S||m&&(l.success[m]=!0)},i))}},t}(hi),Nr=new(function(e){function t(i){e.call(this,"appUserTurnstile"),this._customAccessToken=i}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.postTurnstileEvent=function(i,l){kt.EVENTS_URL&&kt.ACCESS_TOKEN&&Array.isArray(i)&&i.some(function(p){return Pr(p)||Xr(p)})&&this.queueRequest(Date.now(),l)},t.prototype.processRequests=function(i){var l=this;if(!this.pendingRequest&&this.queue.length!==0){this.anonId&&this.eventData.lastSuccess&&this.eventData.tokenU||this.fetchEventData();var p=Ci(kt.ACCESS_TOKEN),m=p?p.u:kt.ACCESS_TOKEN,x=m!==this.eventData.tokenU;Ye(this.anonId)||(this.anonId=Le(),x=!0);var S=this.queue.shift();if(this.eventData.lastSuccess){var I=new Date(this.eventData.lastSuccess),A=new Date(S),C=(S-this.eventData.lastSuccess)/864e5;x=x||C>=1||C<-1||I.getDate()!==A.getDate()}else x=!0;if(!x)return this.processRequests();this.postEvent(S,{"enabled.telemetry":!1},function(B){B||(l.eventData.lastSuccess=S,l.eventData.tokenU=m)},i)}},t}(hi)),Yi=Nr.postTurnstileEvent.bind(Nr),Ln=new pi,Oi=Ln.postMapLoadEvent.bind(Ln),In=500,Qi=50;function zn(){D.caches&&!ei&&(ei=D.caches.open("mapbox-tiles"))}function Fi(e){var t=e.indexOf("?");return t<0?e:e.slice(0,t)}var yn,Ni=1/0;function Rn(){return yn==null&&(yn=D.OffscreenCanvas&&new D.OffscreenCanvas(1,1).getContext("2d")&&typeof D.createImageBitmap=="function"),yn}var $i={Unknown:"Unknown",Style:"Style",Source:"Source",Tile:"Tile",Glyphs:"Glyphs",SpriteImage:"SpriteImage",SpriteJSON:"SpriteJSON",Image:"Image"};typeof Object.freeze=="function"&&Object.freeze($i);var Ui=function(e){function t(i,l,p){l===401&&Xr(p)&&(i+=": you may have provided an invalid Mapbox access token. See https://www.mapbox.com/api-documentation/#access-tokens-and-token-scopes"),e.call(this,i),this.status=l,this.url=p,this.name=this.constructor.name,this.message=i}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.toString=function(){return this.name+": "+this.message+" ("+this.status+"): "+this.url},t}(Error),_n=qt()?function(){return self.worker&&self.worker.referrer}:function(){return(D.location.protocol==="blob:"?D.parent:D).location.href},an,sn,gn=function(e,t){if(!(/^file:/.test(i=e.url)||/^file:/.test(_n())&&!/^\w+:/.test(i))){if(D.fetch&&D.Request&&D.AbortController&&D.Request.prototype.hasOwnProperty("signal"))return function(l,p){var m,x=new D.AbortController,S=new D.Request(l.url,{method:l.method||"GET",body:l.body,credentials:l.credentials,headers:l.headers,referrer:_n(),signal:x.signal}),I=!1,A=!1,C=(m=S.url).indexOf("sku=")>0&&Xr(m);l.type==="json"&&S.headers.set("Accept","application/json");var B=function(q,Q,ee){if(!A){if(q&&q.message!=="SecurityError"&&yt(q),Q&&ee)return U(Q);var ce=Date.now();D.fetch(S).then(function(ie){if(ie.ok){var de=C?ie.clone():null;return U(ie,de,ce)}return p(new Ui(ie.statusText,ie.status,l.url))}).catch(function(ie){ie.code!==20&&p(new Error(ie.message))})}},U=function(q,Q,ee){(l.type==="arrayBuffer"?q.arrayBuffer():l.type==="json"?q.json():q.text()).then(function(ce){A||(Q&&ee&&function(ie,de,be){if(zn(),ei){var ke={status:de.status,statusText:de.statusText,headers:new D.Headers};de.headers.forEach(function(Pe,Ue){return ke.headers.set(Ue,Pe)});var Ie=pt(de.headers.get("Cache-Control")||"");Ie["no-store"]||(Ie["max-age"]&&ke.headers.set("Expires",new Date(be+1e3*Ie["max-age"]).toUTCString()),new Date(ke.headers.get("Expires")).getTime()-be<42e4||function(Pe,Ue){if(on===void 0)try{new Response(new ReadableStream),on=!0}catch{on=!1}on?Ue(Pe.body):Pe.blob().then(Ue)}(de,function(Pe){var Ue=new D.Response(Pe,ke);zn(),ei&&ei.then(function(He){return He.put(Fi(ie.url),Ue)}).catch(function(He){return yt(He.message)})}))}}(S,Q,ee),I=!0,p(null,ce,q.headers.get("Cache-Control"),q.headers.get("Expires")))}).catch(function(ce){A||p(new Error(ce.message))})};return C?function(q,Q){if(zn(),!ei)return Q(null);var ee=Fi(q.url);ei.then(function(ce){ce.match(ee).then(function(ie){var de=function(be){if(!be)return!1;var ke=new Date(be.headers.get("Expires")||0),Ie=pt(be.headers.get("Cache-Control")||"");return ke>Date.now()&&!Ie["no-cache"]}(ie);ce.delete(ee),de&&ce.put(ee,ie.clone()),Q(null,ie,de)}).catch(Q)}).catch(Q)}(S,B):B(null,null),{cancel:function(){A=!0,I||x.abort()}}}(e,t);if(qt()&&self.worker&&self.worker.actor)return self.worker.actor.send("getResource",e,t,void 0,!0)}var i;return function(l,p){var m=new D.XMLHttpRequest;for(var x in m.open(l.method||"GET",l.url,!0),l.type==="arrayBuffer"&&(m.responseType="arraybuffer"),l.headers)m.setRequestHeader(x,l.headers[x]);return l.type==="json"&&(m.responseType="text",m.setRequestHeader("Accept","application/json")),m.withCredentials=l.credentials==="include",m.onerror=function(){p(new Error(m.statusText))},m.onload=function(){if((m.status>=200&&m.status<300||m.status===0)&&m.response!==null){var S=m.response;if(l.type==="json")try{S=JSON.parse(m.response)}catch(I){return p(I)}p(null,S,m.getResponseHeader("Cache-Control"),m.getResponseHeader("Expires"))}else p(new Ui(m.statusText,m.status,l.url))},m.send(l.body),{cancel:function(){return m.abort()}}}(e,t)},ni=function(e,t){return gn(xe(e,{type:"arrayBuffer"}),t)},Cr=function(e,t){return gn(xe(e,{method:"POST"}),t)},L="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAC0lEQVQYV2NgAAIAAAUAAarVyFEAAAAASUVORK5CYII=";an=[],sn=0;var N=function(e,t){if(Ur.supported&&(e.headers||(e.headers={}),e.headers.accept="image/webp,*/*"),sn>=kt.MAX_PARALLEL_IMAGE_REQUESTS){var i={requestParameters:e,callback:t,cancelled:!1,cancel:function(){this.cancelled=!0}};return an.push(i),i}sn++;var l=!1,p=function(){if(!l)for(l=!0,sn--;an.length&&sn<kt.MAX_PARALLEL_IMAGE_REQUESTS;){var x=an.shift();x.cancelled||(x.cancel=N(x.requestParameters,x.callback).cancel)}},m=ni(e,function(x,S,I,A){p(),x?t(x):S&&(Rn()?function(C,B){var U=new D.Blob([new Uint8Array(C)],{type:"image/png"});D.createImageBitmap(U).then(function(q){B(null,q)}).catch(function(q){B(new Error("Could not load image because of "+q.message+". Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."))})}(S,t):function(C,B,U,q){var Q=new D.Image,ee=D.URL;Q.onload=function(){B(null,Q),ee.revokeObjectURL(Q.src),Q.onload=null,D.requestAnimationFrame(function(){Q.src=L})},Q.onerror=function(){return B(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."))};var ce=new D.Blob([new Uint8Array(C)],{type:"image/png"});Q.cacheControl=U,Q.expires=q,Q.src=C.byteLength?ee.createObjectURL(ce):L}(S,t,I,A))});return{cancel:function(){m.cancel(),p()}}};function V(e,t,i){i[e]&&i[e].indexOf(t)!==-1||(i[e]=i[e]||[],i[e].push(t))}function X(e,t,i){if(i&&i[e]){var l=i[e].indexOf(t);l!==-1&&i[e].splice(l,1)}}var $=function(e,t){t===void 0&&(t={}),xe(this,t),this.type=e},se=function(e){function t(i,l){l===void 0&&(l={}),e.call(this,"error",xe({error:i},l))}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t}($),pe=function(){};pe.prototype.on=function(e,t){return this._listeners=this._listeners||{},V(e,t,this._listeners),this},pe.prototype.off=function(e,t){return X(e,t,this._listeners),X(e,t,this._oneTimeListeners),this},pe.prototype.once=function(e,t){return this._oneTimeListeners=this._oneTimeListeners||{},V(e,t,this._oneTimeListeners),this},pe.prototype.fire=function(e,t){typeof e=="string"&&(e=new $(e,t||{}));var i=e.type;if(this.listens(i)){e.target=this;for(var l=0,p=this._listeners&&this._listeners[i]?this._listeners[i].slice():[];l<p.length;l+=1)p[l].call(this,e);for(var m=0,x=this._oneTimeListeners&&this._oneTimeListeners[i]?this._oneTimeListeners[i].slice():[];m<x.length;m+=1){var S=x[m];X(i,S,this._oneTimeListeners),S.call(this,e)}var I=this._eventedParent;I&&(xe(e,typeof this._eventedParentData=="function"?this._eventedParentData():this._eventedParentData),I.fire(e))}else e instanceof se&&console.error(e.error);return this},pe.prototype.listens=function(e){return this._listeners&&this._listeners[e]&&this._listeners[e].length>0||this._oneTimeListeners&&this._oneTimeListeners[e]&&this._oneTimeListeners[e].length>0||this._eventedParent&&this._eventedParent.listens(e)},pe.prototype.setEventedParent=function(e,t){return this._eventedParent=e,this._eventedParentData=t,this};var j={$version:8,$root:{version:{required:!0,type:"enum",values:[8]},name:{type:"string"},metadata:{type:"*"},center:{type:"array",value:"number"},zoom:{type:"number"},bearing:{type:"number",default:0,period:360,units:"degrees"},pitch:{type:"number",default:0,units:"degrees"},light:{type:"light"},sources:{required:!0,type:"sources"},sprite:{type:"string"},glyphs:{type:"string"},transition:{type:"transition"},layers:{required:!0,type:"array",value:"layer"}},sources:{"*":{type:"source"}},source:["source_vector","source_raster","source_raster_dem","source_geojson","source_video","source_image"],source_vector:{type:{required:!0,type:"enum",values:{vector:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},attribution:{type:"string"},promoteId:{type:"promoteId"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_raster:{type:{required:!0,type:"enum",values:{raster:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},attribution:{type:"string"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_raster_dem:{type:{required:!0,type:"enum",values:{"raster-dem":{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},attribution:{type:"string"},encoding:{type:"enum",values:{terrarium:{},mapbox:{}},default:"mapbox"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_geojson:{type:{required:!0,type:"enum",values:{geojson:{}}},data:{type:"*"},maxzoom:{type:"number",default:18},attribution:{type:"string"},buffer:{type:"number",default:128,maximum:512,minimum:0},filter:{type:"*"},tolerance:{type:"number",default:.375},cluster:{type:"boolean",default:!1},clusterRadius:{type:"number",default:50,minimum:0},clusterMaxZoom:{type:"number"},clusterMinPoints:{type:"number"},clusterProperties:{type:"*"},lineMetrics:{type:"boolean",default:!1},generateId:{type:"boolean",default:!1},promoteId:{type:"promoteId"}},source_video:{type:{required:!0,type:"enum",values:{video:{}}},urls:{required:!0,type:"array",value:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},source_image:{type:{required:!0,type:"enum",values:{image:{}}},url:{required:!0,type:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},layer:{id:{type:"string",required:!0},type:{type:"enum",values:{fill:{},line:{},symbol:{},circle:{},heatmap:{},"fill-extrusion":{},raster:{},hillshade:{},background:{}},required:!0},metadata:{type:"*"},source:{type:"string"},"source-layer":{type:"string"},minzoom:{type:"number",minimum:0,maximum:24},maxzoom:{type:"number",minimum:0,maximum:24},filter:{type:"filter"},layout:{type:"layout"},paint:{type:"paint"}},layout:["layout_fill","layout_line","layout_circle","layout_heatmap","layout_fill-extrusion","layout_symbol","layout_raster","layout_hillshade","layout_background"],layout_background:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_fill:{"fill-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_circle:{"circle-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_heatmap:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},"layout_fill-extrusion":{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_line:{"line-cap":{type:"enum",values:{butt:{},round:{},square:{}},default:"butt",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-join":{type:"enum",values:{bevel:{},round:{},miter:{}},default:"miter",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"line-miter-limit":{type:"number",default:2,requires:[{"line-join":"miter"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-round-limit":{type:"number",default:1.05,requires:[{"line-join":"round"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_symbol:{"symbol-placement":{type:"enum",values:{point:{},line:{},"line-center":{}},default:"point",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-spacing":{type:"number",default:250,minimum:1,units:"pixels",requires:[{"symbol-placement":"line"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"symbol-avoid-edges":{type:"boolean",default:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"symbol-z-order":{type:"enum",values:{auto:{},"viewport-y":{},source:{}},default:"auto",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-allow-overlap":{type:"boolean",default:!1,requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-ignore-placement":{type:"boolean",default:!1,requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-optional":{type:"boolean",default:!1,requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-rotation-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-size":{type:"number",default:1,minimum:0,units:"factor of the original icon size",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-text-fit":{type:"enum",values:{none:{},width:{},height:{},both:{}},default:"none",requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-text-fit-padding":{type:"array",value:"number",length:4,default:[0,0,0,0],units:"pixels",requires:["icon-image","text-field",{"icon-text-fit":["both","width","height"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-image":{type:"resolvedImage",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-padding":{type:"number",default:2,minimum:0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-keep-upright":{type:"boolean",default:!1,requires:["icon-image",{"icon-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-offset":{type:"array",value:"number",length:2,default:[0,0],requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotation-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-field":{type:"formatted",default:"",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-font":{type:"array",value:"string",default:["Open Sans Regular","Arial Unicode MS Regular"],requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-size":{type:"number",default:16,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-width":{type:"number",default:10,minimum:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-line-height":{type:"number",default:1.2,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-letter-spacing":{type:"number",default:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-justify":{type:"enum",values:{auto:{},left:{},center:{},right:{}},default:"center",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-radial-offset":{type:"number",units:"ems",default:0,requires:["text-field"],"property-type":"data-driven",expression:{interpolated:!0,parameters:["zoom","feature"]}},"text-variable-anchor":{type:"array",value:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["text-field",{"!":"text-variable-anchor"}],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-angle":{type:"number",default:45,units:"degrees",requires:["text-field",{"symbol-placement":["line","line-center"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-writing-mode":{type:"array",value:"enum",values:{horizontal:{},vertical:{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-padding":{type:"number",default:2,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-keep-upright":{type:"boolean",default:!0,requires:["text-field",{"text-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-transform":{type:"enum",values:{none:{},uppercase:{},lowercase:{}},default:"none",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-offset":{type:"array",value:"number",units:"ems",length:2,default:[0,0],requires:["text-field",{"!":"text-radial-offset"}],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-allow-overlap":{type:"boolean",default:!1,requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-ignore-placement":{type:"boolean",default:!1,requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-optional":{type:"boolean",default:!1,requires:["text-field","icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_raster:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_hillshade:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},filter:{type:"array",value:"*"},filter_operator:{type:"enum",values:{"==":{},"!=":{},">":{},">=":{},"<":{},"<=":{},in:{},"!in":{},all:{},any:{},none:{},has:{},"!has":{},within:{}}},geometry_type:{type:"enum",values:{Point:{},LineString:{},Polygon:{}}},function:{expression:{type:"expression"},stops:{type:"array",value:"function_stop"},base:{type:"number",default:1,minimum:0},property:{type:"string",default:"$zoom"},type:{type:"enum",values:{identity:{},exponential:{},interval:{},categorical:{}},default:"exponential"},colorSpace:{type:"enum",values:{rgb:{},lab:{},hcl:{}},default:"rgb"},default:{type:"*",required:!1}},function_stop:{type:"array",minimum:0,maximum:24,value:["number","color"],length:2},expression:{type:"array",value:"*",minimum:1},light:{anchor:{type:"enum",default:"viewport",values:{map:{},viewport:{}},"property-type":"data-constant",transition:!1,expression:{interpolated:!1,parameters:["zoom"]}},position:{type:"array",default:[1.15,210,30],length:3,value:"number","property-type":"data-constant",transition:!0,expression:{interpolated:!0,parameters:["zoom"]}},color:{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},intensity:{type:"number","property-type":"data-constant",default:.5,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0}},paint:["paint_fill","paint_line","paint_circle","paint_heatmap","paint_fill-extrusion","paint_symbol","paint_raster","paint_hillshade","paint_background"],paint_fill:{"fill-antialias":{type:"boolean",default:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-outline-color":{type:"color",transition:!0,requires:[{"!":"fill-pattern"},{"fill-antialias":!0}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"}},"paint_fill-extrusion":{"fill-extrusion-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-extrusion-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-extrusion-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"fill-extrusion-height":{type:"number",default:0,minimum:0,units:"meters",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-base":{type:"number",default:0,minimum:0,units:"meters",transition:!0,requires:["fill-extrusion-height"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-vertical-gradient":{type:"boolean",default:!0,transition:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_line:{"line-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"line-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["line-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-width":{type:"number",default:1,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-gap-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-offset":{type:"number",default:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-dasharray":{type:"array",value:"number",minimum:0,transition:!0,units:"line widths",requires:[{"!":"line-pattern"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"line-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"line-gradient":{type:"color",transition:!1,requires:[{"!":"line-dasharray"},{"!":"line-pattern"},{source:"geojson",has:{lineMetrics:!0}}],expression:{interpolated:!0,parameters:["line-progress"]},"property-type":"color-ramp"}},paint_circle:{"circle-radius":{type:"number",default:5,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-blur":{type:"number",default:0,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"circle-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["circle-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-scale":{type:"enum",values:{map:{},viewport:{}},default:"map",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-alignment":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-stroke-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"}},paint_heatmap:{"heatmap-radius":{type:"number",default:30,minimum:1,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-weight":{type:"number",default:1,minimum:0,transition:!1,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-intensity":{type:"number",default:1,minimum:0,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"heatmap-color":{type:"color",default:["interpolate",["linear"],["heatmap-density"],0,"rgba(0, 0, 255, 0)",.1,"royalblue",.3,"cyan",.5,"lime",.7,"yellow",1,"red"],transition:!1,expression:{interpolated:!0,parameters:["heatmap-density"]},"property-type":"color-ramp"},"heatmap-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_symbol:{"icon-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-color":{type:"color",default:"#000000",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["icon-image","icon-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-color":{type:"color",default:"#000000",transition:!0,overridable:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["text-field","text-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_raster:{"raster-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-hue-rotate":{type:"number",default:0,period:360,transition:!0,units:"degrees",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-min":{type:"number",default:0,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-max":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-saturation":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-contrast":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-resampling":{type:"enum",values:{linear:{},nearest:{}},default:"linear",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"raster-fade-duration":{type:"number",default:300,minimum:0,transition:!1,units:"milliseconds",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_hillshade:{"hillshade-illumination-direction":{type:"number",default:335,minimum:0,maximum:359,transition:!1,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-illumination-anchor":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-exaggeration":{type:"number",default:.5,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-shadow-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-highlight-color":{type:"color",default:"#FFFFFF",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-accent-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_background:{"background-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"background-pattern"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"background-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"background-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},transition:{duration:{type:"number",default:300,minimum:0,units:"milliseconds"},delay:{type:"number",default:0,minimum:0,units:"milliseconds"}},"property-type":{"data-driven":{type:"property-type"},"cross-faded":{type:"property-type"},"cross-faded-data-driven":{type:"property-type"},"color-ramp":{type:"property-type"},"data-constant":{type:"property-type"},constant:{type:"property-type"}},promoteId:{"*":{type:"string"}}},J=function(e,t,i,l){this.message=(e?e+": ":"")+i,l&&(this.identifier=l),t!=null&&t.__line__&&(this.line=t.__line__)};function _e(e){var t=e.value;return t?[new J(e.key,t,"constants have been deprecated as of v8")]:[]}function Ce(e){for(var t=[],i=arguments.length-1;i-- >0;)t[i]=arguments[i+1];for(var l=0,p=t;l<p.length;l+=1){var m=p[l];for(var x in m)e[x]=m[x]}return e}function Me(e){return e instanceof Number||e instanceof String||e instanceof Boolean?e.valueOf():e}function W(e){if(Array.isArray(e))return e.map(W);if(e instanceof Object&&!(e instanceof Number||e instanceof String||e instanceof Boolean)){var t={};for(var i in e)t[i]=W(e[i]);return t}return Me(e)}var we=function(e){function t(i,l){e.call(this,l),this.message=l,this.key=i}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t}(Error),$e=function(e,t){t===void 0&&(t=[]),this.parent=e,this.bindings={};for(var i=0,l=t;i<l.length;i+=1){var p=l[i];this.bindings[p[0]]=p[1]}};$e.prototype.concat=function(e){return new $e(this,e)},$e.prototype.get=function(e){if(this.bindings[e])return this.bindings[e];if(this.parent)return this.parent.get(e);throw new Error(e+" not found in scope.")},$e.prototype.has=function(e){return!!this.bindings[e]||!!this.parent&&this.parent.has(e)};var Xe={kind:"null"},Se={kind:"number"},We={kind:"string"},Oe={kind:"boolean"},je={kind:"color"},Mt={kind:"object"},qe={kind:"value"},Vt={kind:"collator"},lr={kind:"formatted"},Pt={kind:"resolvedImage"};function er(e,t){return{kind:"array",itemType:e,N:t}}function Ht(e){if(e.kind==="array"){var t=Ht(e.itemType);return typeof e.N=="number"?"array<"+t+", "+e.N+">":e.itemType.kind==="value"?"array":"array<"+t+">"}return e.kind}var ti=[Xe,Se,We,Oe,je,lr,Mt,er(qe),Pt];function Qt(e,t){if(t.kind==="error")return null;if(e.kind==="array"){if(t.kind==="array"&&(t.N===0&&t.itemType.kind==="value"||!Qt(e.itemType,t.itemType))&&(typeof e.N!="number"||e.N===t.N))return null}else{if(e.kind===t.kind)return null;if(e.kind==="value"){for(var i=0,l=ti;i<l.length;i+=1)if(!Qt(l[i],t))return null}}return"Expected "+Ht(e)+" but found "+Ht(t)+" instead."}function vr(e,t){return t.some(function(i){return i.kind===e.kind})}function dr(e,t){return t.some(function(i){return i==="null"?e===null:i==="array"?Array.isArray(e):i==="object"?e&&!Array.isArray(e)&&typeof e=="object":i===typeof e})}var Gt=z(function(e,t){var i={transparent:[0,0,0,0],aliceblue:[240,248,255,1],antiquewhite:[250,235,215,1],aqua:[0,255,255,1],aquamarine:[127,255,212,1],azure:[240,255,255,1],beige:[245,245,220,1],bisque:[255,228,196,1],black:[0,0,0,1],blanchedalmond:[255,235,205,1],blue:[0,0,255,1],blueviolet:[138,43,226,1],brown:[165,42,42,1],burlywood:[222,184,135,1],cadetblue:[95,158,160,1],chartreuse:[127,255,0,1],chocolate:[210,105,30,1],coral:[255,127,80,1],cornflowerblue:[100,149,237,1],cornsilk:[255,248,220,1],crimson:[220,20,60,1],cyan:[0,255,255,1],darkblue:[0,0,139,1],darkcyan:[0,139,139,1],darkgoldenrod:[184,134,11,1],darkgray:[169,169,169,1],darkgreen:[0,100,0,1],darkgrey:[169,169,169,1],darkkhaki:[189,183,107,1],darkmagenta:[139,0,139,1],darkolivegreen:[85,107,47,1],darkorange:[255,140,0,1],darkorchid:[153,50,204,1],darkred:[139,0,0,1],darksalmon:[233,150,122,1],darkseagreen:[143,188,143,1],darkslateblue:[72,61,139,1],darkslategray:[47,79,79,1],darkslategrey:[47,79,79,1],darkturquoise:[0,206,209,1],darkviolet:[148,0,211,1],deeppink:[255,20,147,1],deepskyblue:[0,191,255,1],dimgray:[105,105,105,1],dimgrey:[105,105,105,1],dodgerblue:[30,144,255,1],firebrick:[178,34,34,1],floralwhite:[255,250,240,1],forestgreen:[34,139,34,1],fuchsia:[255,0,255,1],gainsboro:[220,220,220,1],ghostwhite:[248,248,255,1],gold:[255,215,0,1],goldenrod:[218,165,32,1],gray:[128,128,128,1],green:[0,128,0,1],greenyellow:[173,255,47,1],grey:[128,128,128,1],honeydew:[240,255,240,1],hotpink:[255,105,180,1],indianred:[205,92,92,1],indigo:[75,0,130,1],ivory:[255,255,240,1],khaki:[240,230,140,1],lavender:[230,230,250,1],lavenderblush:[255,240,245,1],lawngreen:[124,252,0,1],lemonchiffon:[255,250,205,1],lightblue:[173,216,230,1],lightcoral:[240,128,128,1],lightcyan:[224,255,255,1],lightgoldenrodyellow:[250,250,210,1],lightgray:[211,211,211,1],lightgreen:[144,238,144,1],lightgrey:[211,211,211,1],lightpink:[255,182,193,1],lightsalmon:[255,160,122,1],lightseagreen:[32,178,170,1],lightskyblue:[135,206,250,1],lightslategray:[119,136,153,1],lightslategrey:[119,136,153,1],lightsteelblue:[176,196,222,1],lightyellow:[255,255,224,1],lime:[0,255,0,1],limegreen:[50,205,50,1],linen:[250,240,230,1],magenta:[255,0,255,1],maroon:[128,0,0,1],mediumaquamarine:[102,205,170,1],mediumblue:[0,0,205,1],mediumorchid:[186,85,211,1],mediumpurple:[147,112,219,1],mediumseagreen:[60,179,113,1],mediumslateblue:[123,104,238,1],mediumspringgreen:[0,250,154,1],mediumturquoise:[72,209,204,1],mediumvioletred:[199,21,133,1],midnightblue:[25,25,112,1],mintcream:[245,255,250,1],mistyrose:[255,228,225,1],moccasin:[255,228,181,1],navajowhite:[255,222,173,1],navy:[0,0,128,1],oldlace:[253,245,230,1],olive:[128,128,0,1],olivedrab:[107,142,35,1],orange:[255,165,0,1],orangered:[255,69,0,1],orchid:[218,112,214,1],palegoldenrod:[238,232,170,1],palegreen:[152,251,152,1],paleturquoise:[175,238,238,1],palevioletred:[219,112,147,1],papayawhip:[255,239,213,1],peachpuff:[255,218,185,1],peru:[205,133,63,1],pink:[255,192,203,1],plum:[221,160,221,1],powderblue:[176,224,230,1],purple:[128,0,128,1],rebeccapurple:[102,51,153,1],red:[255,0,0,1],rosybrown:[188,143,143,1],royalblue:[65,105,225,1],saddlebrown:[139,69,19,1],salmon:[250,128,114,1],sandybrown:[244,164,96,1],seagreen:[46,139,87,1],seashell:[255,245,238,1],sienna:[160,82,45,1],silver:[192,192,192,1],skyblue:[135,206,235,1],slateblue:[106,90,205,1],slategray:[112,128,144,1],slategrey:[112,128,144,1],snow:[255,250,250,1],springgreen:[0,255,127,1],steelblue:[70,130,180,1],tan:[210,180,140,1],teal:[0,128,128,1],thistle:[216,191,216,1],tomato:[255,99,71,1],turquoise:[64,224,208,1],violet:[238,130,238,1],wheat:[245,222,179,1],white:[255,255,255,1],whitesmoke:[245,245,245,1],yellow:[255,255,0,1],yellowgreen:[154,205,50,1]};function l(S){return(S=Math.round(S))<0?0:S>255?255:S}function p(S){return l(S[S.length-1]==="%"?parseFloat(S)/100*255:parseInt(S))}function m(S){return(I=S[S.length-1]==="%"?parseFloat(S)/100:parseFloat(S))<0?0:I>1?1:I;var I}function x(S,I,A){return A<0?A+=1:A>1&&(A-=1),6*A<1?S+(I-S)*A*6:2*A<1?I:3*A<2?S+(I-S)*(2/3-A)*6:S}try{t.parseCSSColor=function(S){var I,A=S.replace(/ /g,"").toLowerCase();if(A in i)return i[A].slice();if(A[0]==="#")return A.length===4?(I=parseInt(A.substr(1),16))>=0&&I<=4095?[(3840&I)>>4|(3840&I)>>8,240&I|(240&I)>>4,15&I|(15&I)<<4,1]:null:A.length===7&&(I=parseInt(A.substr(1),16))>=0&&I<=16777215?[(16711680&I)>>16,(65280&I)>>8,255&I,1]:null;var C=A.indexOf("("),B=A.indexOf(")");if(C!==-1&&B+1===A.length){var U=A.substr(0,C),q=A.substr(C+1,B-(C+1)).split(","),Q=1;switch(U){case"rgba":if(q.length!==4)return null;Q=m(q.pop());case"rgb":return q.length!==3?null:[p(q[0]),p(q[1]),p(q[2]),Q];case"hsla":if(q.length!==4)return null;Q=m(q.pop());case"hsl":if(q.length!==3)return null;var ee=(parseFloat(q[0])%360+360)%360/360,ce=m(q[1]),ie=m(q[2]),de=ie<=.5?ie*(ce+1):ie+ce-ie*ce,be=2*ie-de;return[l(255*x(be,de,ee+1/3)),l(255*x(be,de,ee)),l(255*x(be,de,ee-1/3)),Q];default:return null}}return null}}catch{}}).parseCSSColor,tr=function(e,t,i,l){l===void 0&&(l=1),this.r=e,this.g=t,this.b=i,this.a=l};tr.parse=function(e){if(e){if(e instanceof tr)return e;if(typeof e=="string"){var t=Gt(e);if(t)return new tr(t[0]/255*t[3],t[1]/255*t[3],t[2]/255*t[3],t[3])}}},tr.prototype.toString=function(){var e=this.toArray(),t=e[1],i=e[2],l=e[3];return"rgba("+Math.round(e[0])+","+Math.round(t)+","+Math.round(i)+","+l+")"},tr.prototype.toArray=function(){var e=this.a;return e===0?[0,0,0,0]:[255*this.r/e,255*this.g/e,255*this.b/e,e]},tr.black=new tr(0,0,0,1),tr.white=new tr(1,1,1,1),tr.transparent=new tr(0,0,0,0),tr.red=new tr(1,0,0,1);var oi=function(e,t,i){this.sensitivity=e?t?"variant":"case":t?"accent":"base",this.locale=i,this.collator=new Intl.Collator(this.locale?this.locale:[],{sensitivity:this.sensitivity,usage:"search"})};oi.prototype.compare=function(e,t){return this.collator.compare(e,t)},oi.prototype.resolvedLocale=function(){return new Intl.Collator(this.locale?this.locale:[]).resolvedOptions().locale};var Bn=function(e,t,i,l,p){this.text=e,this.image=t,this.scale=i,this.fontStack=l,this.textColor=p},wr=function(e){this.sections=e};wr.fromString=function(e){return new wr([new Bn(e,null,null,null,null)])},wr.prototype.isEmpty=function(){return this.sections.length===0||!this.sections.some(function(e){return e.text.length!==0||e.image&&e.image.name.length!==0})},wr.factory=function(e){return e instanceof wr?e:wr.fromString(e)},wr.prototype.toString=function(){return this.sections.length===0?"":this.sections.map(function(e){return e.text}).join("")},wr.prototype.serialize=function(){for(var e=["format"],t=0,i=this.sections;t<i.length;t+=1){var l=i[t];if(l.image)e.push(["image",l.image.name]);else{e.push(l.text);var p={};l.fontStack&&(p["text-font"]=["literal",l.fontStack.split(",")]),l.scale&&(p["font-scale"]=l.scale),l.textColor&&(p["text-color"]=["rgba"].concat(l.textColor.toArray())),e.push(p)}}return e};var Mi=function(e){this.name=e.name,this.available=e.available};function Vo(e,t,i,l){return typeof e=="number"&&e>=0&&e<=255&&typeof t=="number"&&t>=0&&t<=255&&typeof i=="number"&&i>=0&&i<=255?l===void 0||typeof l=="number"&&l>=0&&l<=1?null:"Invalid rgba value ["+[e,t,i,l].join(", ")+"]: 'a' must be between 0 and 1.":"Invalid rgba value ["+(typeof l=="number"?[e,t,i,l]:[e,t,i]).join(", ")+"]: 'r', 'g', and 'b' must be between 0 and 255."}function vo(e){if(e===null||typeof e=="string"||typeof e=="boolean"||typeof e=="number"||e instanceof tr||e instanceof oi||e instanceof wr||e instanceof Mi)return!0;if(Array.isArray(e)){for(var t=0,i=e;t<i.length;t+=1)if(!vo(i[t]))return!1;return!0}if(typeof e=="object"){for(var l in e)if(!vo(e[l]))return!1;return!0}return!1}function Zr(e){if(e===null)return Xe;if(typeof e=="string")return We;if(typeof e=="boolean")return Oe;if(typeof e=="number")return Se;if(e instanceof tr)return je;if(e instanceof oi)return Vt;if(e instanceof wr)return lr;if(e instanceof Mi)return Pt;if(Array.isArray(e)){for(var t,i=e.length,l=0,p=e;l<p.length;l+=1){var m=Zr(p[l]);if(t){if(t===m)continue;t=qe;break}t=m}return er(t||qe,i)}return Mt}function bo(e){var t=typeof e;return e===null?"":t==="string"||t==="number"||t==="boolean"?String(e):e instanceof tr||e instanceof wr||e instanceof Mi?e.toString():JSON.stringify(e)}Mi.prototype.toString=function(){return this.name},Mi.fromString=function(e){return e?new Mi({name:e,available:!1}):null},Mi.prototype.serialize=function(){return["image",this.name]};var ki=function(e,t){this.type=e,this.value=t};ki.parse=function(e,t){if(e.length!==2)return t.error("'literal' expression requires exactly one argument, but found "+(e.length-1)+" instead.");if(!vo(e[1]))return t.error("invalid value");var i=e[1],l=Zr(i),p=t.expectedType;return l.kind!=="array"||l.N!==0||!p||p.kind!=="array"||typeof p.N=="number"&&p.N!==0||(l=p),new ki(l,i)},ki.prototype.evaluate=function(){return this.value},ki.prototype.eachChild=function(){},ki.prototype.outputDefined=function(){return!0},ki.prototype.serialize=function(){return this.type.kind==="array"||this.type.kind==="object"?["literal",this.value]:this.value instanceof tr?["rgba"].concat(this.value.toArray()):this.value instanceof wr?this.value.serialize():this.value};var ai=function(e){this.name="ExpressionEvaluationError",this.message=e};ai.prototype.toJSON=function(){return this.message};var ln={string:We,number:Se,boolean:Oe,object:Mt},Lr=function(e,t){this.type=e,this.args=t};Lr.parse=function(e,t){if(e.length<2)return t.error("Expected at least one argument.");var i,l=1,p=e[0];if(p==="array"){var m,x;if(e.length>2){var S=e[1];if(typeof S!="string"||!(S in ln)||S==="object")return t.error('The item type argument of "array" must be one of string, number, boolean',1);m=ln[S],l++}else m=qe;if(e.length>3){if(e[2]!==null&&(typeof e[2]!="number"||e[2]<0||e[2]!==Math.floor(e[2])))return t.error('The length argument to "array" must be a positive integer literal',2);x=e[2],l++}i=er(m,x)}else i=ln[p];for(var I=[];l<e.length;l++){var A=t.parse(e[l],l,qe);if(!A)return null;I.push(A)}return new Lr(i,I)},Lr.prototype.evaluate=function(e){for(var t=0;t<this.args.length;t++){var i=this.args[t].evaluate(e);if(!Qt(this.type,Zr(i)))return i;if(t===this.args.length-1)throw new ai("Expected value to be of type "+Ht(this.type)+", but found "+Ht(Zr(i))+" instead.")}return null},Lr.prototype.eachChild=function(e){this.args.forEach(e)},Lr.prototype.outputDefined=function(){return this.args.every(function(e){return e.outputDefined()})},Lr.prototype.serialize=function(){var e=this.type,t=[e.kind];if(e.kind==="array"){var i=e.itemType;if(i.kind==="string"||i.kind==="number"||i.kind==="boolean"){t.push(i.kind);var l=e.N;(typeof l=="number"||this.args.length>1)&&t.push(l)}}return t.concat(this.args.map(function(p){return p.serialize()}))};var On=function(e){this.type=lr,this.sections=e};On.parse=function(e,t){if(e.length<2)return t.error("Expected at least one argument.");var i=e[1];if(!Array.isArray(i)&&typeof i=="object")return t.error("First argument must be an image or text section.");for(var l=[],p=!1,m=1;m<=e.length-1;++m){var x=e[m];if(p&&typeof x=="object"&&!Array.isArray(x)){p=!1;var S=null;if(x["font-scale"]&&!(S=t.parse(x["font-scale"],1,Se)))return null;var I=null;if(x["text-font"]&&!(I=t.parse(x["text-font"],1,er(We))))return null;var A=null;if(x["text-color"]&&!(A=t.parse(x["text-color"],1,je)))return null;var C=l[l.length-1];C.scale=S,C.font=I,C.textColor=A}else{var B=t.parse(e[m],1,qe);if(!B)return null;var U=B.type.kind;if(U!=="string"&&U!=="value"&&U!=="null"&&U!=="resolvedImage")return t.error("Formatted text type must be 'string', 'value', 'image' or 'null'.");p=!0,l.push({content:B,scale:null,font:null,textColor:null})}}return new On(l)},On.prototype.evaluate=function(e){return new wr(this.sections.map(function(t){var i=t.content.evaluate(e);return Zr(i)===Pt?new Bn("",i,null,null,null):new Bn(bo(i),null,t.scale?t.scale.evaluate(e):null,t.font?t.font.evaluate(e).join(","):null,t.textColor?t.textColor.evaluate(e):null)}))},On.prototype.eachChild=function(e){for(var t=0,i=this.sections;t<i.length;t+=1){var l=i[t];e(l.content),l.scale&&e(l.scale),l.font&&e(l.font),l.textColor&&e(l.textColor)}},On.prototype.outputDefined=function(){return!1},On.prototype.serialize=function(){for(var e=["format"],t=0,i=this.sections;t<i.length;t+=1){var l=i[t];e.push(l.content.serialize());var p={};l.scale&&(p["font-scale"]=l.scale.serialize()),l.font&&(p["text-font"]=l.font.serialize()),l.textColor&&(p["text-color"]=l.textColor.serialize()),e.push(p)}return e};var vn=function(e){this.type=Pt,this.input=e};vn.parse=function(e,t){if(e.length!==2)return t.error("Expected two arguments.");var i=t.parse(e[1],1,We);return i?new vn(i):t.error("No image name provided.")},vn.prototype.evaluate=function(e){var t=this.input.evaluate(e),i=Mi.fromString(t);return i&&e.availableImages&&(i.available=e.availableImages.indexOf(t)>-1),i},vn.prototype.eachChild=function(e){e(this.input)},vn.prototype.outputDefined=function(){return!1},vn.prototype.serialize=function(){return["image",this.input.serialize()]};var is={"to-boolean":Oe,"to-color":je,"to-number":Se,"to-string":We},Si=function(e,t){this.type=e,this.args=t};Si.parse=function(e,t){if(e.length<2)return t.error("Expected at least one argument.");var i=e[0];if((i==="to-boolean"||i==="to-string")&&e.length!==2)return t.error("Expected one argument.");for(var l=is[i],p=[],m=1;m<e.length;m++){var x=t.parse(e[m],m,qe);if(!x)return null;p.push(x)}return new Si(l,p)},Si.prototype.evaluate=function(e){if(this.type.kind==="boolean")return!!this.args[0].evaluate(e);if(this.type.kind==="color"){for(var t,i,l=0,p=this.args;l<p.length;l+=1){if(i=null,(t=p[l].evaluate(e))instanceof tr)return t;if(typeof t=="string"){var m=e.parseColor(t);if(m)return m}else if(Array.isArray(t)&&!(i=t.length<3||t.length>4?"Invalid rbga value "+JSON.stringify(t)+": expected an array containing either three or four numeric values.":Vo(t[0],t[1],t[2],t[3])))return new tr(t[0]/255,t[1]/255,t[2]/255,t[3])}throw new ai(i||"Could not parse color from value '"+(typeof t=="string"?t:String(JSON.stringify(t)))+"'")}if(this.type.kind==="number"){for(var x=null,S=0,I=this.args;S<I.length;S+=1){if((x=I[S].evaluate(e))===null)return 0;var A=Number(x);if(!isNaN(A))return A}throw new ai("Could not convert "+JSON.stringify(x)+" to number.")}return this.type.kind==="formatted"?wr.fromString(bo(this.args[0].evaluate(e))):this.type.kind==="resolvedImage"?Mi.fromString(bo(this.args[0].evaluate(e))):bo(this.args[0].evaluate(e))},Si.prototype.eachChild=function(e){this.args.forEach(e)},Si.prototype.outputDefined=function(){return this.args.every(function(e){return e.outputDefined()})},Si.prototype.serialize=function(){if(this.type.kind==="formatted")return new On([{content:this.args[0],scale:null,font:null,textColor:null}]).serialize();if(this.type.kind==="resolvedImage")return new vn(this.args[0]).serialize();var e=["to-"+this.type.kind];return this.eachChild(function(t){e.push(t.serialize())}),e};var xo=["Unknown","Point","LineString","Polygon"],Vi=function(){this.globals=null,this.feature=null,this.featureState=null,this.formattedSection=null,this._parseColorCache={},this.availableImages=null,this.canonical=null};Vi.prototype.id=function(){return this.feature&&"id"in this.feature?this.feature.id:null},Vi.prototype.geometryType=function(){return this.feature?typeof this.feature.type=="number"?xo[this.feature.type]:this.feature.type:null},Vi.prototype.geometry=function(){return this.feature&&"geometry"in this.feature?this.feature.geometry:null},Vi.prototype.canonicalID=function(){return this.canonical},Vi.prototype.properties=function(){return this.feature&&this.feature.properties||{}},Vi.prototype.parseColor=function(e){var t=this._parseColorCache[e];return t||(t=this._parseColorCache[e]=tr.parse(e)),t};var Ei=function(e,t,i,l){this.name=e,this.type=t,this._evaluate=i,this.args=l};Ei.prototype.evaluate=function(e){return this._evaluate(e,this.args)},Ei.prototype.eachChild=function(e){this.args.forEach(e)},Ei.prototype.outputDefined=function(){return!1},Ei.prototype.serialize=function(){return[this.name].concat(this.args.map(function(e){return e.serialize()}))},Ei.parse=function(e,t){var i,l=e[0],p=Ei.definitions[l];if(!p)return t.error('Unknown expression "'+l+'". If you wanted a literal array, use ["literal", [...]].',0);for(var m=Array.isArray(p)?p[0]:p.type,x=Array.isArray(p)?[[p[1],p[2]]]:p.overloads,S=x.filter(function(bt){var it=bt[0];return!Array.isArray(it)||it.length===e.length-1}),I=null,A=0,C=S;A<C.length;A+=1){var B=C[A],U=B[0],q=B[1];I=new Gr(t.registry,t.path,null,t.scope);for(var Q=[],ee=!1,ce=1;ce<e.length;ce++){var ie=e[ce],de=Array.isArray(U)?U[ce-1]:U.type,be=I.parse(ie,1+Q.length,de);if(!be){ee=!0;break}Q.push(be)}if(!ee)if(Array.isArray(U)&&U.length!==Q.length)I.error("Expected "+U.length+" arguments, but found "+Q.length+" instead.");else{for(var ke=0;ke<Q.length;ke++){var Ie=Array.isArray(U)?U[ke]:U.type,Pe=Q[ke];I.concat(ke+1).checkSubtype(Ie,Pe.type)}if(I.errors.length===0)return new Ei(l,m,q,Q)}}if(S.length===1)(i=t.errors).push.apply(i,I.errors);else{for(var Ue=(S.length?S:x).map(function(bt){var it;return it=bt[0],Array.isArray(it)?"("+it.map(Ht).join(", ")+")":"("+Ht(it.type)+"...)"}).join(" | "),He=[],ft=1;ft<e.length;ft++){var tt=t.parse(e[ft],1+He.length);if(!tt)return null;He.push(Ht(tt.type))}t.error("Expected arguments of type "+Ue+", but found ("+He.join(", ")+") instead.")}return null},Ei.register=function(e,t){for(var i in Ei.definitions=t,t)e[i]=Ei};var Jn=function(e,t,i){this.type=Vt,this.locale=i,this.caseSensitive=e,this.diacriticSensitive=t};function ji(e,t){e[0]=Math.min(e[0],t[0]),e[1]=Math.min(e[1],t[1]),e[2]=Math.max(e[2],t[0]),e[3]=Math.max(e[3],t[1])}function wo(e,t){return!(e[0]<=t[0]||e[2]>=t[2]||e[1]<=t[1]||e[3]>=t[3])}function ns(e,t){var i=(180+e[0])/360,l=(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+e[1]*Math.PI/360)))/360,p=Math.pow(2,t.z);return[Math.round(i*p*8192),Math.round(l*p*8192)]}function Ll(e,t,i){return t[1]>e[1]!=i[1]>e[1]&&e[0]<(i[0]-t[0])*(e[1]-t[1])/(i[1]-t[1])+t[0]}function ha(e,t){for(var i,l,p,m,x,S,I,A=!1,C=0,B=t.length;C<B;C++)for(var U=t[C],q=0,Q=U.length;q<Q-1;q++){if((m=(i=e)[0]-(l=U[q])[0])*(I=i[1]-(p=U[q+1])[1])-(S=i[0]-p[0])*(x=i[1]-l[1])==0&&m*S<=0&&x*I<=0)return!1;Ll(e,U[q],U[q+1])&&(A=!A)}return A}function Rl(e,t){for(var i=0;i<t.length;i++)if(ha(e,t[i]))return!0;return!1}function Ba(e,t,i,l){var p=l[0]-i[0],m=l[1]-i[1],x=(e[0]-i[0])*m-p*(e[1]-i[1]),S=(t[0]-i[0])*m-p*(t[1]-i[1]);return x>0&&S<0||x<0&&S>0}function Bl(e,t,i){for(var l=0,p=i;l<p.length;l+=1)for(var m=p[l],x=0;x<m.length-1;++x)if((B=[(C=m[x+1])[0]-(A=m[x])[0],C[1]-A[1]])[0]*(U=[(I=t)[0]-(S=e)[0],I[1]-S[1]])[1]-B[1]*U[0]!=0&&Ba(S,I,A,C)&&Ba(A,C,S,I))return!0;var S,I,A,C,B,U;return!1}function Oa(e,t){for(var i=0;i<e.length;++i)if(!ha(e[i],t))return!1;for(var l=0;l<e.length-1;++l)if(Bl(e[l],e[l+1],t))return!1;return!0}function Bs(e,t){for(var i=0;i<t.length;i++)if(Oa(e,t[i]))return!0;return!1}function jo(e,t,i){for(var l=[],p=0;p<e.length;p++){for(var m=[],x=0;x<e[p].length;x++){var S=ns(e[p][x],i);ji(t,S),m.push(S)}l.push(m)}return l}function os(e,t,i){for(var l=[],p=0;p<e.length;p++){var m=jo(e[p],t,i);l.push(m)}return l}function pa(e,t,i,l){if(e[0]<i[0]||e[0]>i[2]){var p=.5*l,m=e[0]-i[0]>p?-l:i[0]-e[0]>p?l:0;m===0&&(m=e[0]-i[2]>p?-l:i[2]-e[0]>p?l:0),e[0]+=m}ji(t,e)}function Os(e,t,i,l){for(var p=8192*Math.pow(2,l.z),m=[8192*l.x,8192*l.y],x=[],S=0,I=e;S<I.length;S+=1)for(var A=0,C=I[S];A<C.length;A+=1){var B=C[A],U=[B.x+m[0],B.y+m[1]];pa(U,t,i,p),x.push(U)}return x}function qo(e,t,i,l){for(var p,m=8192*Math.pow(2,l.z),x=[8192*l.x,8192*l.y],S=[],I=0,A=e;I<A.length;I+=1){for(var C=[],B=0,U=A[I];B<U.length;B+=1){var q=U[B],Q=[q.x+x[0],q.y+x[1]];ji(t,Q),C.push(Q)}S.push(C)}if(t[2]-t[0]<=m/2){(p=t)[0]=p[1]=1/0,p[2]=p[3]=-1/0;for(var ee=0,ce=S;ee<ce.length;ee+=1)for(var ie=0,de=ce[ee];ie<de.length;ie+=1)pa(de[ie],t,i,m)}return S}Jn.parse=function(e,t){if(e.length!==2)return t.error("Expected one argument.");var i=e[1];if(typeof i!="object"||Array.isArray(i))return t.error("Collator options argument must be an object.");var l=t.parse(i["case-sensitive"]!==void 0&&i["case-sensitive"],1,Oe);if(!l)return null;var p=t.parse(i["diacritic-sensitive"]!==void 0&&i["diacritic-sensitive"],1,Oe);if(!p)return null;var m=null;return i.locale&&!(m=t.parse(i.locale,1,We))?null:new Jn(l,p,m)},Jn.prototype.evaluate=function(e){return new oi(this.caseSensitive.evaluate(e),this.diacriticSensitive.evaluate(e),this.locale?this.locale.evaluate(e):null)},Jn.prototype.eachChild=function(e){e(this.caseSensitive),e(this.diacriticSensitive),this.locale&&e(this.locale)},Jn.prototype.outputDefined=function(){return!1},Jn.prototype.serialize=function(){var e={};return e["case-sensitive"]=this.caseSensitive.serialize(),e["diacritic-sensitive"]=this.diacriticSensitive.serialize(),this.locale&&(e.locale=this.locale.serialize()),["collator",e]};var Fn=function(e,t){this.type=Oe,this.geojson=e,this.geometries=t};function ko(e){if(e instanceof Ei&&(e.name==="get"&&e.args.length===1||e.name==="feature-state"||e.name==="has"&&e.args.length===1||e.name==="properties"||e.name==="geometry-type"||e.name==="id"||/^filter-/.test(e.name))||e instanceof Fn)return!1;var t=!0;return e.eachChild(function(i){t&&!ko(i)&&(t=!1)}),t}function ye(e){if(e instanceof Ei&&e.name==="feature-state")return!1;var t=!0;return e.eachChild(function(i){t&&!ye(i)&&(t=!1)}),t}function un(e,t){if(e instanceof Ei&&t.indexOf(e.name)>=0)return!1;var i=!0;return e.eachChild(function(l){i&&!un(l,t)&&(i=!1)}),i}Fn.parse=function(e,t){if(e.length!==2)return t.error("'within' expression requires exactly one argument, but found "+(e.length-1)+" instead.");if(vo(e[1])){var i=e[1];if(i.type==="FeatureCollection")for(var l=0;l<i.features.length;++l){var p=i.features[l].geometry.type;if(p==="Polygon"||p==="MultiPolygon")return new Fn(i,i.features[l].geometry)}else if(i.type==="Feature"){var m=i.geometry.type;if(m==="Polygon"||m==="MultiPolygon")return new Fn(i,i.geometry)}else if(i.type==="Polygon"||i.type==="MultiPolygon")return new Fn(i,i)}return t.error("'within' expression requires valid geojson object that contains polygon geometry type.")},Fn.prototype.evaluate=function(e){if(e.geometry()!=null&&e.canonicalID()!=null){if(e.geometryType()==="Point")return function(t,i){var l=[1/0,1/0,-1/0,-1/0],p=[1/0,1/0,-1/0,-1/0],m=t.canonicalID();if(i.type==="Polygon"){var x=jo(i.coordinates,p,m),S=Os(t.geometry(),l,p,m);if(!wo(l,p))return!1;for(var I=0,A=S;I<A.length;I+=1)if(!ha(A[I],x))return!1}if(i.type==="MultiPolygon"){var C=os(i.coordinates,p,m),B=Os(t.geometry(),l,p,m);if(!wo(l,p))return!1;for(var U=0,q=B;U<q.length;U+=1)if(!Rl(q[U],C))return!1}return!0}(e,this.geometries);if(e.geometryType()==="LineString")return function(t,i){var l=[1/0,1/0,-1/0,-1/0],p=[1/0,1/0,-1/0,-1/0],m=t.canonicalID();if(i.type==="Polygon"){var x=jo(i.coordinates,p,m),S=qo(t.geometry(),l,p,m);if(!wo(l,p))return!1;for(var I=0,A=S;I<A.length;I+=1)if(!Oa(A[I],x))return!1}if(i.type==="MultiPolygon"){var C=os(i.coordinates,p,m),B=qo(t.geometry(),l,p,m);if(!wo(l,p))return!1;for(var U=0,q=B;U<q.length;U+=1)if(!Bs(q[U],C))return!1}return!0}(e,this.geometries)}return!1},Fn.prototype.eachChild=function(){},Fn.prototype.outputDefined=function(){return!0},Fn.prototype.serialize=function(){return["within",this.geojson]};var qi=function(e,t){this.type=t.type,this.name=e,this.boundExpression=t};qi.parse=function(e,t){if(e.length!==2||typeof e[1]!="string")return t.error("'var' expression requires exactly one string literal argument.");var i=e[1];return t.scope.has(i)?new qi(i,t.scope.get(i)):t.error('Unknown variable "'+i+'". Make sure "'+i+'" has been bound in an enclosing "let" expression before using it.',1)},qi.prototype.evaluate=function(e){return this.boundExpression.evaluate(e)},qi.prototype.eachChild=function(){},qi.prototype.outputDefined=function(){return!1},qi.prototype.serialize=function(){return["var",this.name]};var Gr=function(e,t,i,l,p){t===void 0&&(t=[]),l===void 0&&(l=new $e),p===void 0&&(p=[]),this.registry=e,this.path=t,this.key=t.map(function(m){return"["+m+"]"}).join(""),this.scope=l,this.errors=p,this.expectedType=i};function So(e,t){for(var i,l=e.length-1,p=0,m=l,x=0;p<=m;)if((i=e[x=Math.floor((p+m)/2)])<=t){if(x===l||t<e[x+1])return x;p=x+1}else{if(!(i>t))throw new ai("Input is not a number.");m=x-1}return 0}Gr.prototype.parse=function(e,t,i,l,p){return p===void 0&&(p={}),t?this.concat(t,i,l)._parse(e,p):this._parse(e,p)},Gr.prototype._parse=function(e,t){function i(A,C,B){return B==="assert"?new Lr(C,[A]):B==="coerce"?new Si(C,[A]):A}if(e!==null&&typeof e!="string"&&typeof e!="boolean"&&typeof e!="number"||(e=["literal",e]),Array.isArray(e)){if(e.length===0)return this.error('Expected an array with at least one element. If you wanted a literal array, use ["literal", []].');var l=e[0];if(typeof l!="string")return this.error("Expression name must be a string, but found "+typeof l+' instead. If you wanted a literal array, use ["literal", [...]].',0),null;var p=this.registry[l];if(p){var m=p.parse(e,this);if(!m)return null;if(this.expectedType){var x=this.expectedType,S=m.type;if(x.kind!=="string"&&x.kind!=="number"&&x.kind!=="boolean"&&x.kind!=="object"&&x.kind!=="array"||S.kind!=="value")if(x.kind!=="color"&&x.kind!=="formatted"&&x.kind!=="resolvedImage"||S.kind!=="value"&&S.kind!=="string"){if(this.checkSubtype(x,S))return null}else m=i(m,x,t.typeAnnotation||"coerce");else m=i(m,x,t.typeAnnotation||"assert")}if(!(m instanceof ki)&&m.type.kind!=="resolvedImage"&&function A(C){if(C instanceof qi)return A(C.boundExpression);if(C instanceof Ei&&C.name==="error"||C instanceof Jn||C instanceof Fn)return!1;var B=C instanceof Si||C instanceof Lr,U=!0;return C.eachChild(function(q){U=B?U&&A(q):U&&q instanceof ki}),!!U&&ko(C)&&un(C,["zoom","heatmap-density","line-progress","accumulated","is-supported-script"])}(m)){var I=new Vi;try{m=new ki(m.type,m.evaluate(I))}catch(A){return this.error(A.message),null}}return m}return this.error('Unknown expression "'+l+'". If you wanted a literal array, use ["literal", [...]].',0)}return this.error(e===void 0?"'undefined' value invalid. Use null instead.":typeof e=="object"?'Bare objects invalid. Use ["literal", {...}] instead.':"Expected an array, but found "+typeof e+" instead.")},Gr.prototype.concat=function(e,t,i){var l=typeof e=="number"?this.path.concat(e):this.path,p=i?this.scope.concat(i):this.scope;return new Gr(this.registry,l,t||null,p,this.errors)},Gr.prototype.error=function(e){for(var t=[],i=arguments.length-1;i-- >0;)t[i]=arguments[i+1];var l=""+this.key+t.map(function(p){return"["+p+"]"}).join("");this.errors.push(new we(l,e))},Gr.prototype.checkSubtype=function(e,t){var i=Qt(e,t);return i&&this.error(i),i};var Nn=function(e,t,i){this.type=e,this.input=t,this.labels=[],this.outputs=[];for(var l=0,p=i;l<p.length;l+=1){var m=p[l],x=m[1];this.labels.push(m[0]),this.outputs.push(x)}};function vi(e,t,i){return e*(1-i)+t*i}Nn.parse=function(e,t){if(e.length-1<4)return t.error("Expected at least 4 arguments, but found only "+(e.length-1)+".");if((e.length-1)%2!=0)return t.error("Expected an even number of arguments.");var i=t.parse(e[1],1,Se);if(!i)return null;var l=[],p=null;t.expectedType&&t.expectedType.kind!=="value"&&(p=t.expectedType);for(var m=1;m<e.length;m+=2){var x=m===1?-1/0:e[m],S=e[m+1],I=m,A=m+1;if(typeof x!="number")return t.error('Input/output pairs for "step" expressions must be defined using literal numeric values (not computed expressions) for the input values.',I);if(l.length&&l[l.length-1][0]>=x)return t.error('Input/output pairs for "step" expressions must be arranged with input values in strictly ascending order.',I);var C=t.parse(S,A,p);if(!C)return null;p=p||C.type,l.push([x,C])}return new Nn(p,i,l)},Nn.prototype.evaluate=function(e){var t=this.labels,i=this.outputs;if(t.length===1)return i[0].evaluate(e);var l=this.input.evaluate(e);if(l<=t[0])return i[0].evaluate(e);var p=t.length;return l>=t[p-1]?i[p-1].evaluate(e):i[So(t,l)].evaluate(e)},Nn.prototype.eachChild=function(e){e(this.input);for(var t=0,i=this.outputs;t<i.length;t+=1)e(i[t])},Nn.prototype.outputDefined=function(){return this.outputs.every(function(e){return e.outputDefined()})},Nn.prototype.serialize=function(){for(var e=["step",this.input.serialize()],t=0;t<this.labels.length;t++)t>0&&e.push(this.labels[t]),e.push(this.outputs[t].serialize());return e};var Fa=Object.freeze({__proto__:null,number:vi,color:function(e,t,i){return new tr(vi(e.r,t.r,i),vi(e.g,t.g,i),vi(e.b,t.b,i),vi(e.a,t.a,i))},array:function(e,t,i){return e.map(function(l,p){return vi(l,t[p],i)})}}),ec=6/29*3*(6/29),Oh=Math.PI/180,Fh=180/Math.PI;function Ol(e){return e>.008856451679035631?Math.pow(e,1/3):e/ec+4/29}function Fl(e){return e>6/29?e*e*e:ec*(e-4/29)}function Nl(e){return 255*(e<=.0031308?12.92*e:1.055*Math.pow(e,1/2.4)-.055)}function Ul(e){return(e/=255)<=.04045?e/12.92:Math.pow((e+.055)/1.055,2.4)}function tc(e){var t=Ul(e.r),i=Ul(e.g),l=Ul(e.b),p=Ol((.4124564*t+.3575761*i+.1804375*l)/.95047),m=Ol((.2126729*t+.7151522*i+.072175*l)/1);return{l:116*m-16,a:500*(p-m),b:200*(m-Ol((.0193339*t+.119192*i+.9503041*l)/1.08883)),alpha:e.a}}function rc(e){var t=(e.l+16)/116,i=isNaN(e.a)?t:t+e.a/500,l=isNaN(e.b)?t:t-e.b/200;return t=1*Fl(t),i=.95047*Fl(i),l=1.08883*Fl(l),new tr(Nl(3.2404542*i-1.5371385*t-.4985314*l),Nl(-.969266*i+1.8760108*t+.041556*l),Nl(.0556434*i-.2040259*t+1.0572252*l),e.alpha)}function Nh(e,t,i){var l=t-e;return e+i*(l>180||l<-180?l-360*Math.round(l/360):l)}var as={forward:tc,reverse:rc,interpolate:function(e,t,i){return{l:vi(e.l,t.l,i),a:vi(e.a,t.a,i),b:vi(e.b,t.b,i),alpha:vi(e.alpha,t.alpha,i)}}},ss={forward:function(e){var t=tc(e),i=t.l,l=t.a,p=t.b,m=Math.atan2(p,l)*Fh;return{h:m<0?m+360:m,c:Math.sqrt(l*l+p*p),l:i,alpha:e.a}},reverse:function(e){var t=e.h*Oh,i=e.c;return rc({l:e.l,a:Math.cos(t)*i,b:Math.sin(t)*i,alpha:e.alpha})},interpolate:function(e,t,i){return{h:Nh(e.h,t.h,i),c:vi(e.c,t.c,i),l:vi(e.l,t.l,i),alpha:vi(e.alpha,t.alpha,i)}}},ic=Object.freeze({__proto__:null,lab:as,hcl:ss}),en=function(e,t,i,l,p){this.type=e,this.operator=t,this.interpolation=i,this.input=l,this.labels=[],this.outputs=[];for(var m=0,x=p;m<x.length;m+=1){var S=x[m],I=S[1];this.labels.push(S[0]),this.outputs.push(I)}};function Vl(e,t,i,l){var p=l-i,m=e-i;return p===0?0:t===1?m/p:(Math.pow(t,m)-1)/(Math.pow(t,p)-1)}en.interpolationFactor=function(e,t,i,l){var p=0;if(e.name==="exponential")p=Vl(t,e.base,i,l);else if(e.name==="linear")p=Vl(t,1,i,l);else if(e.name==="cubic-bezier"){var m=e.controlPoints;p=new T(m[0],m[1],m[2],m[3]).solve(Vl(t,1,i,l))}return p},en.parse=function(e,t){var i=e[0],l=e[1],p=e[2],m=e.slice(3);if(!Array.isArray(l)||l.length===0)return t.error("Expected an interpolation type expression.",1);if(l[0]==="linear")l={name:"linear"};else if(l[0]==="exponential"){var x=l[1];if(typeof x!="number")return t.error("Exponential interpolation requires a numeric base.",1,1);l={name:"exponential",base:x}}else{if(l[0]!=="cubic-bezier")return t.error("Unknown interpolation type "+String(l[0]),1,0);var S=l.slice(1);if(S.length!==4||S.some(function(ce){return typeof ce!="number"||ce<0||ce>1}))return t.error("Cubic bezier interpolation requires four numeric arguments with values between 0 and 1.",1);l={name:"cubic-bezier",controlPoints:S}}if(e.length-1<4)return t.error("Expected at least 4 arguments, but found only "+(e.length-1)+".");if((e.length-1)%2!=0)return t.error("Expected an even number of arguments.");if(!(p=t.parse(p,2,Se)))return null;var I=[],A=null;i==="interpolate-hcl"||i==="interpolate-lab"?A=je:t.expectedType&&t.expectedType.kind!=="value"&&(A=t.expectedType);for(var C=0;C<m.length;C+=2){var B=m[C],U=m[C+1],q=C+3,Q=C+4;if(typeof B!="number")return t.error('Input/output pairs for "interpolate" expressions must be defined using literal numeric values (not computed expressions) for the input values.',q);if(I.length&&I[I.length-1][0]>=B)return t.error('Input/output pairs for "interpolate" expressions must be arranged with input values in strictly ascending order.',q);var ee=t.parse(U,Q,A);if(!ee)return null;A=A||ee.type,I.push([B,ee])}return A.kind==="number"||A.kind==="color"||A.kind==="array"&&A.itemType.kind==="number"&&typeof A.N=="number"?new en(A,i,l,p,I):t.error("Type "+Ht(A)+" is not interpolatable.")},en.prototype.evaluate=function(e){var t=this.labels,i=this.outputs;if(t.length===1)return i[0].evaluate(e);var l=this.input.evaluate(e);if(l<=t[0])return i[0].evaluate(e);var p=t.length;if(l>=t[p-1])return i[p-1].evaluate(e);var m=So(t,l),x=en.interpolationFactor(this.interpolation,l,t[m],t[m+1]),S=i[m].evaluate(e),I=i[m+1].evaluate(e);return this.operator==="interpolate"?Fa[this.type.kind.toLowerCase()](S,I,x):this.operator==="interpolate-hcl"?ss.reverse(ss.interpolate(ss.forward(S),ss.forward(I),x)):as.reverse(as.interpolate(as.forward(S),as.forward(I),x))},en.prototype.eachChild=function(e){e(this.input);for(var t=0,i=this.outputs;t<i.length;t+=1)e(i[t])},en.prototype.outputDefined=function(){return this.outputs.every(function(e){return e.outputDefined()})},en.prototype.serialize=function(){var e;e=this.interpolation.name==="linear"?["linear"]:this.interpolation.name==="exponential"?this.interpolation.base===1?["linear"]:["exponential",this.interpolation.base]:["cubic-bezier"].concat(this.interpolation.controlPoints);for(var t=[this.operator,e,this.input.serialize()],i=0;i<this.labels.length;i++)t.push(this.labels[i],this.outputs[i].serialize());return t};var Zo=function(e,t){this.type=e,this.args=t};Zo.parse=function(e,t){if(e.length<2)return t.error("Expectected at least one argument.");var i=null,l=t.expectedType;l&&l.kind!=="value"&&(i=l);for(var p=[],m=0,x=e.slice(1);m<x.length;m+=1){var S=t.parse(x[m],1+p.length,i,void 0,{typeAnnotation:"omit"});if(!S)return null;i=i||S.type,p.push(S)}var I=l&&p.some(function(A){return Qt(l,A.type)});return new Zo(I?qe:i,p)},Zo.prototype.evaluate=function(e){for(var t,i=null,l=0,p=0,m=this.args;p<m.length&&(l++,(i=m[p].evaluate(e))&&i instanceof Mi&&!i.available&&(t||(t=i.name),i=null,l===this.args.length&&(i=t)),i===null);p+=1);return i},Zo.prototype.eachChild=function(e){this.args.forEach(e)},Zo.prototype.outputDefined=function(){return this.args.every(function(e){return e.outputDefined()})},Zo.prototype.serialize=function(){var e=["coalesce"];return this.eachChild(function(t){e.push(t.serialize())}),e};var Go=function(e,t){this.type=t.type,this.bindings=[].concat(e),this.result=t};Go.prototype.evaluate=function(e){return this.result.evaluate(e)},Go.prototype.eachChild=function(e){for(var t=0,i=this.bindings;t<i.length;t+=1)e(i[t][1]);e(this.result)},Go.parse=function(e,t){if(e.length<4)return t.error("Expected at least 3 arguments, but found "+(e.length-1)+" instead.");for(var i=[],l=1;l<e.length-1;l+=2){var p=e[l];if(typeof p!="string")return t.error("Expected string, but found "+typeof p+" instead.",l);if(/[^a-zA-Z0-9_]/.test(p))return t.error("Variable names must contain only alphanumeric characters or '_'.",l);var m=t.parse(e[l+1],l+1);if(!m)return null;i.push([p,m])}var x=t.parse(e[e.length-1],e.length-1,t.expectedType,i);return x?new Go(i,x):null},Go.prototype.outputDefined=function(){return this.result.outputDefined()},Go.prototype.serialize=function(){for(var e=["let"],t=0,i=this.bindings;t<i.length;t+=1){var l=i[t];e.push(l[0],l[1].serialize())}return e.push(this.result.serialize()),e};var fa=function(e,t,i){this.type=e,this.index=t,this.input=i};fa.parse=function(e,t){if(e.length!==3)return t.error("Expected 2 arguments, but found "+(e.length-1)+" instead.");var i=t.parse(e[1],1,Se),l=t.parse(e[2],2,er(t.expectedType||qe));return i&&l?new fa(l.type.itemType,i,l):null},fa.prototype.evaluate=function(e){var t=this.index.evaluate(e),i=this.input.evaluate(e);if(t<0)throw new ai("Array index out of bounds: "+t+" < 0.");if(t>=i.length)throw new ai("Array index out of bounds: "+t+" > "+(i.length-1)+".");if(t!==Math.floor(t))throw new ai("Array index must be an integer, but found "+t+" instead.");return i[t]},fa.prototype.eachChild=function(e){e(this.index),e(this.input)},fa.prototype.outputDefined=function(){return!1},fa.prototype.serialize=function(){return["at",this.index.serialize(),this.input.serialize()]};var da=function(e,t){this.type=Oe,this.needle=e,this.haystack=t};da.parse=function(e,t){if(e.length!==3)return t.error("Expected 2 arguments, but found "+(e.length-1)+" instead.");var i=t.parse(e[1],1,qe),l=t.parse(e[2],2,qe);return i&&l?vr(i.type,[Oe,We,Se,Xe,qe])?new da(i,l):t.error("Expected first argument to be of type boolean, string, number or null, but found "+Ht(i.type)+" instead"):null},da.prototype.evaluate=function(e){var t=this.needle.evaluate(e),i=this.haystack.evaluate(e);if(!i)return!1;if(!dr(t,["boolean","string","number","null"]))throw new ai("Expected first argument to be of type boolean, string, number or null, but found "+Ht(Zr(t))+" instead.");if(!dr(i,["string","array"]))throw new ai("Expected second argument to be of type array or string, but found "+Ht(Zr(i))+" instead.");return i.indexOf(t)>=0},da.prototype.eachChild=function(e){e(this.needle),e(this.haystack)},da.prototype.outputDefined=function(){return!0},da.prototype.serialize=function(){return["in",this.needle.serialize(),this.haystack.serialize()]};var Ko=function(e,t,i){this.type=Se,this.needle=e,this.haystack=t,this.fromIndex=i};Ko.parse=function(e,t){if(e.length<=2||e.length>=5)return t.error("Expected 3 or 4 arguments, but found "+(e.length-1)+" instead.");var i=t.parse(e[1],1,qe),l=t.parse(e[2],2,qe);if(!i||!l)return null;if(!vr(i.type,[Oe,We,Se,Xe,qe]))return t.error("Expected first argument to be of type boolean, string, number or null, but found "+Ht(i.type)+" instead");if(e.length===4){var p=t.parse(e[3],3,Se);return p?new Ko(i,l,p):null}return new Ko(i,l)},Ko.prototype.evaluate=function(e){var t=this.needle.evaluate(e),i=this.haystack.evaluate(e);if(!dr(t,["boolean","string","number","null"]))throw new ai("Expected first argument to be of type boolean, string, number or null, but found "+Ht(Zr(t))+" instead.");if(!dr(i,["string","array"]))throw new ai("Expected second argument to be of type array or string, but found "+Ht(Zr(i))+" instead.");if(this.fromIndex){var l=this.fromIndex.evaluate(e);return i.indexOf(t,l)}return i.indexOf(t)},Ko.prototype.eachChild=function(e){e(this.needle),e(this.haystack),this.fromIndex&&e(this.fromIndex)},Ko.prototype.outputDefined=function(){return!1},Ko.prototype.serialize=function(){if(this.fromIndex!=null&&this.fromIndex!==void 0){var e=this.fromIndex.serialize();return["index-of",this.needle.serialize(),this.haystack.serialize(),e]}return["index-of",this.needle.serialize(),this.haystack.serialize()]};var ma=function(e,t,i,l,p,m){this.inputType=e,this.type=t,this.input=i,this.cases=l,this.outputs=p,this.otherwise=m};ma.parse=function(e,t){if(e.length<5)return t.error("Expected at least 4 arguments, but found only "+(e.length-1)+".");if(e.length%2!=1)return t.error("Expected an even number of arguments.");var i,l;t.expectedType&&t.expectedType.kind!=="value"&&(l=t.expectedType);for(var p={},m=[],x=2;x<e.length-1;x+=2){var S=e[x],I=e[x+1];Array.isArray(S)||(S=[S]);var A=t.concat(x);if(S.length===0)return A.error("Expected at least one branch label.");for(var C=0,B=S;C<B.length;C+=1){var U=B[C];if(typeof U!="number"&&typeof U!="string")return A.error("Branch labels must be numbers or strings.");if(typeof U=="number"&&Math.abs(U)>Number.MAX_SAFE_INTEGER)return A.error("Branch labels must be integers no larger than "+Number.MAX_SAFE_INTEGER+".");if(typeof U=="number"&&Math.floor(U)!==U)return A.error("Numeric branch labels must be integer values.");if(i){if(A.checkSubtype(i,Zr(U)))return null}else i=Zr(U);if(p[String(U)]!==void 0)return A.error("Branch labels must be unique.");p[String(U)]=m.length}var q=t.parse(I,x,l);if(!q)return null;l=l||q.type,m.push(q)}var Q=t.parse(e[1],1,qe);if(!Q)return null;var ee=t.parse(e[e.length-1],e.length-1,l);return ee?Q.type.kind!=="value"&&t.concat(1).checkSubtype(i,Q.type)?null:new ma(i,l,Q,p,m,ee):null},ma.prototype.evaluate=function(e){var t=this.input.evaluate(e);return(Zr(t)===this.inputType&&this.outputs[this.cases[t]]||this.otherwise).evaluate(e)},ma.prototype.eachChild=function(e){e(this.input),this.outputs.forEach(e),e(this.otherwise)},ma.prototype.outputDefined=function(){return this.outputs.every(function(e){return e.outputDefined()})&&this.otherwise.outputDefined()},ma.prototype.serialize=function(){for(var e=this,t=["match",this.input.serialize()],i=[],l={},p=0,m=Object.keys(this.cases).sort();p<m.length;p+=1){var x=m[p];(B=l[this.cases[x]])===void 0?(l[this.cases[x]]=i.length,i.push([this.cases[x],[x]])):i[B][1].push(x)}for(var S=function(q){return e.inputType.kind==="number"?Number(q):q},I=0,A=i;I<A.length;I+=1){var C=A[I],B=C[0],U=C[1];t.push(U.length===1?S(U[0]):U.map(S)),t.push(this.outputs[outputIndex$1].serialize())}return t.push(this.otherwise.serialize()),t};var ya=function(e,t,i){this.type=e,this.branches=t,this.otherwise=i};ya.parse=function(e,t){if(e.length<4)return t.error("Expected at least 3 arguments, but found only "+(e.length-1)+".");if(e.length%2!=0)return t.error("Expected an odd number of arguments.");var i;t.expectedType&&t.expectedType.kind!=="value"&&(i=t.expectedType);for(var l=[],p=1;p<e.length-1;p+=2){var m=t.parse(e[p],p,Oe);if(!m)return null;var x=t.parse(e[p+1],p+1,i);if(!x)return null;l.push([m,x]),i=i||x.type}var S=t.parse(e[e.length-1],e.length-1,i);return S?new ya(i,l,S):null},ya.prototype.evaluate=function(e){for(var t=0,i=this.branches;t<i.length;t+=1){var l=i[t],p=l[1];if(l[0].evaluate(e))return p.evaluate(e)}return this.otherwise.evaluate(e)},ya.prototype.eachChild=function(e){for(var t=0,i=this.branches;t<i.length;t+=1){var l=i[t],p=l[1];e(l[0]),e(p)}e(this.otherwise)},ya.prototype.outputDefined=function(){return this.branches.every(function(e){return e[1].outputDefined()})&&this.otherwise.outputDefined()},ya.prototype.serialize=function(){var e=["case"];return this.eachChild(function(t){e.push(t.serialize())}),e};var Xo=function(e,t,i,l){this.type=e,this.input=t,this.beginIndex=i,this.endIndex=l};function nc(e,t){return e==="=="||e==="!="?t.kind==="boolean"||t.kind==="string"||t.kind==="number"||t.kind==="null"||t.kind==="value":t.kind==="string"||t.kind==="number"||t.kind==="value"}function oc(e,t,i,l){return l.compare(t,i)===0}function Br(e,t,i){var l=e!=="=="&&e!=="!=";return function(){function p(m,x,S){this.type=Oe,this.lhs=m,this.rhs=x,this.collator=S,this.hasUntypedArgument=m.type.kind==="value"||x.type.kind==="value"}return p.parse=function(m,x){if(m.length!==3&&m.length!==4)return x.error("Expected two or three arguments.");var S=m[0],I=x.parse(m[1],1,qe);if(!I)return null;if(!nc(S,I.type))return x.concat(1).error('"'+S+`" comparisons are not supported for type '`+Ht(I.type)+"'.");var A=x.parse(m[2],2,qe);if(!A)return null;if(!nc(S,A.type))return x.concat(2).error('"'+S+`" comparisons are not supported for type '`+Ht(A.type)+"'.");if(I.type.kind!==A.type.kind&&I.type.kind!=="value"&&A.type.kind!=="value")return x.error("Cannot compare types '"+Ht(I.type)+"' and '"+Ht(A.type)+"'.");l&&(I.type.kind==="value"&&A.type.kind!=="value"?I=new Lr(A.type,[I]):I.type.kind!=="value"&&A.type.kind==="value"&&(A=new Lr(I.type,[A])));var C=null;if(m.length===4){if(I.type.kind!=="string"&&A.type.kind!=="string"&&I.type.kind!=="value"&&A.type.kind!=="value")return x.error("Cannot use collator to compare non-string types.");if(!(C=x.parse(m[3],3,Vt)))return null}return new p(I,A,C)},p.prototype.evaluate=function(m){var x=this.lhs.evaluate(m),S=this.rhs.evaluate(m);if(l&&this.hasUntypedArgument){var I=Zr(x),A=Zr(S);if(I.kind!==A.kind||I.kind!=="string"&&I.kind!=="number")throw new ai('Expected arguments for "'+e+'" to be (string, string) or (number, number), but found ('+I.kind+", "+A.kind+") instead.")}if(this.collator&&!l&&this.hasUntypedArgument){var C=Zr(x),B=Zr(S);if(C.kind!=="string"||B.kind!=="string")return t(m,x,S)}return this.collator?i(m,x,S,this.collator.evaluate(m)):t(m,x,S)},p.prototype.eachChild=function(m){m(this.lhs),m(this.rhs),this.collator&&m(this.collator)},p.prototype.outputDefined=function(){return!0},p.prototype.serialize=function(){var m=[e];return this.eachChild(function(x){m.push(x.serialize())}),m},p}()}Xo.parse=function(e,t){if(e.length<=2||e.length>=5)return t.error("Expected 3 or 4 arguments, but found "+(e.length-1)+" instead.");var i=t.parse(e[1],1,qe),l=t.parse(e[2],2,Se);if(!i||!l)return null;if(!vr(i.type,[er(qe),We,qe]))return t.error("Expected first argument to be of type array or string, but found "+Ht(i.type)+" instead");if(e.length===4){var p=t.parse(e[3],3,Se);return p?new Xo(i.type,i,l,p):null}return new Xo(i.type,i,l)},Xo.prototype.evaluate=function(e){var t=this.input.evaluate(e),i=this.beginIndex.evaluate(e);if(!dr(t,["string","array"]))throw new ai("Expected first argument to be of type array or string, but found "+Ht(Zr(t))+" instead.");if(this.endIndex){var l=this.endIndex.evaluate(e);return t.slice(i,l)}return t.slice(i)},Xo.prototype.eachChild=function(e){e(this.input),e(this.beginIndex),this.endIndex&&e(this.endIndex)},Xo.prototype.outputDefined=function(){return!1},Xo.prototype.serialize=function(){if(this.endIndex!=null&&this.endIndex!==void 0){var e=this.endIndex.serialize();return["slice",this.input.serialize(),this.beginIndex.serialize(),e]}return["slice",this.input.serialize(),this.beginIndex.serialize()]};var Uh=Br("==",function(e,t,i){return t===i},oc),Fs=Br("!=",function(e,t,i){return t!==i},function(e,t,i,l){return!oc(0,t,i,l)}),ac=Br("<",function(e,t,i){return t<i},function(e,t,i,l){return l.compare(t,i)<0}),sc=Br(">",function(e,t,i){return t>i},function(e,t,i,l){return l.compare(t,i)>0}),lc=Br("<=",function(e,t,i){return t<=i},function(e,t,i,l){return l.compare(t,i)<=0}),uc=Br(">=",function(e,t,i){return t>=i},function(e,t,i,l){return l.compare(t,i)>=0}),_a=function(e,t,i,l,p){this.type=We,this.number=e,this.locale=t,this.currency=i,this.minFractionDigits=l,this.maxFractionDigits=p};_a.parse=function(e,t){if(e.length!==3)return t.error("Expected two arguments.");var i=t.parse(e[1],1,Se);if(!i)return null;var l=e[2];if(typeof l!="object"||Array.isArray(l))return t.error("NumberFormat options argument must be an object.");var p=null;if(l.locale&&!(p=t.parse(l.locale,1,We)))return null;var m=null;if(l.currency&&!(m=t.parse(l.currency,1,We)))return null;var x=null;if(l["min-fraction-digits"]&&!(x=t.parse(l["min-fraction-digits"],1,Se)))return null;var S=null;return l["max-fraction-digits"]&&!(S=t.parse(l["max-fraction-digits"],1,Se))?null:new _a(i,p,m,x,S)},_a.prototype.evaluate=function(e){return new Intl.NumberFormat(this.locale?this.locale.evaluate(e):[],{style:this.currency?"currency":"decimal",currency:this.currency?this.currency.evaluate(e):void 0,minimumFractionDigits:this.minFractionDigits?this.minFractionDigits.evaluate(e):void 0,maximumFractionDigits:this.maxFractionDigits?this.maxFractionDigits.evaluate(e):void 0}).format(this.number.evaluate(e))},_a.prototype.eachChild=function(e){e(this.number),this.locale&&e(this.locale),this.currency&&e(this.currency),this.minFractionDigits&&e(this.minFractionDigits),this.maxFractionDigits&&e(this.maxFractionDigits)},_a.prototype.outputDefined=function(){return!1},_a.prototype.serialize=function(){var e={};return this.locale&&(e.locale=this.locale.serialize()),this.currency&&(e.currency=this.currency.serialize()),this.minFractionDigits&&(e["min-fraction-digits"]=this.minFractionDigits.serialize()),this.maxFractionDigits&&(e["max-fraction-digits"]=this.maxFractionDigits.serialize()),["number-format",this.number.serialize(),e]};var Wo=function(e){this.type=Se,this.input=e};Wo.parse=function(e,t){if(e.length!==2)return t.error("Expected 1 argument, but found "+(e.length-1)+" instead.");var i=t.parse(e[1],1);return i?i.type.kind!=="array"&&i.type.kind!=="string"&&i.type.kind!=="value"?t.error("Expected argument of type string or array, but found "+Ht(i.type)+" instead."):new Wo(i):null},Wo.prototype.evaluate=function(e){var t=this.input.evaluate(e);if(typeof t=="string"||Array.isArray(t))return t.length;throw new ai("Expected value to be of type string or array, but found "+Ht(Zr(t))+" instead.")},Wo.prototype.eachChild=function(e){e(this.input)},Wo.prototype.outputDefined=function(){return!1},Wo.prototype.serialize=function(){var e=["length"];return this.eachChild(function(t){e.push(t.serialize())}),e};var ga={"==":Uh,"!=":Fs,">":sc,"<":ac,">=":uc,"<=":lc,array:Lr,at:fa,boolean:Lr,case:ya,coalesce:Zo,collator:Jn,format:On,image:vn,in:da,"index-of":Ko,interpolate:en,"interpolate-hcl":en,"interpolate-lab":en,length:Wo,let:Go,literal:ki,match:ma,number:Lr,"number-format":_a,object:Lr,slice:Xo,step:Nn,string:Lr,"to-boolean":Si,"to-color":Si,"to-number":Si,"to-string":Si,var:qi,within:Fn};function cc(e,t){var i=t[0],l=t[1],p=t[2],m=t[3];i=i.evaluate(e),l=l.evaluate(e),p=p.evaluate(e);var x=m?m.evaluate(e):1,S=Vo(i,l,p,x);if(S)throw new ai(S);return new tr(i/255*x,l/255*x,p/255*x,x)}function hc(e,t){return e in t}function jl(e,t){var i=t[e];return i===void 0?null:i}function va(e){return{type:e}}function pc(e){return{result:"success",value:e}}function ba(e){return{result:"error",value:e}}function xa(e){return e["property-type"]==="data-driven"||e["property-type"]==="cross-faded-data-driven"}function fc(e){return!!e.expression&&e.expression.parameters.indexOf("zoom")>-1}function ls(e){return!!e.expression&&e.expression.interpolated}function Vr(e){return e instanceof Number?"number":e instanceof String?"string":e instanceof Boolean?"boolean":Array.isArray(e)?"array":e===null?"null":typeof e}function Ns(e){return typeof e=="object"&&e!==null&&!Array.isArray(e)}function Vh(e){return e}function Na(e,t,i){return e!==void 0?e:t!==void 0?t:i!==void 0?i:void 0}function dc(e,t,i,l,p){return Na(typeof i===p?l[i]:void 0,e.default,t.default)}function jh(e,t,i){if(Vr(i)!=="number")return Na(e.default,t.default);var l=e.stops.length;if(l===1||i<=e.stops[0][0])return e.stops[0][1];if(i>=e.stops[l-1][0])return e.stops[l-1][1];var p=So(e.stops.map(function(m){return m[0]}),i);return e.stops[p][1]}function mc(e,t,i){var l=e.base!==void 0?e.base:1;if(Vr(i)!=="number")return Na(e.default,t.default);var p=e.stops.length;if(p===1||i<=e.stops[0][0])return e.stops[0][1];if(i>=e.stops[p-1][0])return e.stops[p-1][1];var m=So(e.stops.map(function(B){return B[0]}),i),x=function(B,U,q,Q){var ee=Q-q,ce=B-q;return ee===0?0:U===1?ce/ee:(Math.pow(U,ce)-1)/(Math.pow(U,ee)-1)}(i,l,e.stops[m][0],e.stops[m+1][0]),S=e.stops[m][1],I=e.stops[m+1][1],A=Fa[t.type]||Vh;if(e.colorSpace&&e.colorSpace!=="rgb"){var C=ic[e.colorSpace];A=function(B,U){return C.reverse(C.interpolate(C.forward(B),C.forward(U),x))}}return typeof S.evaluate=="function"?{evaluate:function(){for(var B=[],U=arguments.length;U--;)B[U]=arguments[U];var q=S.evaluate.apply(void 0,B),Q=I.evaluate.apply(void 0,B);if(q!==void 0&&Q!==void 0)return A(q,Q,x)}}:A(S,I,x)}function Us(e,t,i){return t.type==="color"?i=tr.parse(i):t.type==="formatted"?i=wr.fromString(i.toString()):t.type==="resolvedImage"?i=Mi.fromString(i.toString()):Vr(i)===t.type||t.type==="enum"&&t.values[i]||(i=void 0),Na(i,e.default,t.default)}Ei.register(ga,{error:[{kind:"error"},[We],function(e,t){throw new ai(t[0].evaluate(e))}],typeof:[We,[qe],function(e,t){return Ht(Zr(t[0].evaluate(e)))}],"to-rgba":[er(Se,4),[je],function(e,t){return t[0].evaluate(e).toArray()}],rgb:[je,[Se,Se,Se],cc],rgba:[je,[Se,Se,Se,Se],cc],has:{type:Oe,overloads:[[[We],function(e,t){return hc(t[0].evaluate(e),e.properties())}],[[We,Mt],function(e,t){var i=t[1];return hc(t[0].evaluate(e),i.evaluate(e))}]]},get:{type:qe,overloads:[[[We],function(e,t){return jl(t[0].evaluate(e),e.properties())}],[[We,Mt],function(e,t){var i=t[1];return jl(t[0].evaluate(e),i.evaluate(e))}]]},"feature-state":[qe,[We],function(e,t){return jl(t[0].evaluate(e),e.featureState||{})}],properties:[Mt,[],function(e){return e.properties()}],"geometry-type":[We,[],function(e){return e.geometryType()}],id:[qe,[],function(e){return e.id()}],zoom:[Se,[],function(e){return e.globals.zoom}],"heatmap-density":[Se,[],function(e){return e.globals.heatmapDensity||0}],"line-progress":[Se,[],function(e){return e.globals.lineProgress||0}],accumulated:[qe,[],function(e){return e.globals.accumulated===void 0?null:e.globals.accumulated}],"+":[Se,va(Se),function(e,t){for(var i=0,l=0,p=t;l<p.length;l+=1)i+=p[l].evaluate(e);return i}],"*":[Se,va(Se),function(e,t){for(var i=1,l=0,p=t;l<p.length;l+=1)i*=p[l].evaluate(e);return i}],"-":{type:Se,overloads:[[[Se,Se],function(e,t){var i=t[1];return t[0].evaluate(e)-i.evaluate(e)}],[[Se],function(e,t){return-t[0].evaluate(e)}]]},"/":[Se,[Se,Se],function(e,t){var i=t[1];return t[0].evaluate(e)/i.evaluate(e)}],"%":[Se,[Se,Se],function(e,t){var i=t[1];return t[0].evaluate(e)%i.evaluate(e)}],ln2:[Se,[],function(){return Math.LN2}],pi:[Se,[],function(){return Math.PI}],e:[Se,[],function(){return Math.E}],"^":[Se,[Se,Se],function(e,t){var i=t[1];return Math.pow(t[0].evaluate(e),i.evaluate(e))}],sqrt:[Se,[Se],function(e,t){return Math.sqrt(t[0].evaluate(e))}],log10:[Se,[Se],function(e,t){return Math.log(t[0].evaluate(e))/Math.LN10}],ln:[Se,[Se],function(e,t){return Math.log(t[0].evaluate(e))}],log2:[Se,[Se],function(e,t){return Math.log(t[0].evaluate(e))/Math.LN2}],sin:[Se,[Se],function(e,t){return Math.sin(t[0].evaluate(e))}],cos:[Se,[Se],function(e,t){return Math.cos(t[0].evaluate(e))}],tan:[Se,[Se],function(e,t){return Math.tan(t[0].evaluate(e))}],asin:[Se,[Se],function(e,t){return Math.asin(t[0].evaluate(e))}],acos:[Se,[Se],function(e,t){return Math.acos(t[0].evaluate(e))}],atan:[Se,[Se],function(e,t){return Math.atan(t[0].evaluate(e))}],min:[Se,va(Se),function(e,t){return Math.min.apply(Math,t.map(function(i){return i.evaluate(e)}))}],max:[Se,va(Se),function(e,t){return Math.max.apply(Math,t.map(function(i){return i.evaluate(e)}))}],abs:[Se,[Se],function(e,t){return Math.abs(t[0].evaluate(e))}],round:[Se,[Se],function(e,t){var i=t[0].evaluate(e);return i<0?-Math.round(-i):Math.round(i)}],floor:[Se,[Se],function(e,t){return Math.floor(t[0].evaluate(e))}],ceil:[Se,[Se],function(e,t){return Math.ceil(t[0].evaluate(e))}],"filter-==":[Oe,[We,qe],function(e,t){var i=t[0],l=t[1];return e.properties()[i.value]===l.value}],"filter-id-==":[Oe,[qe],function(e,t){var i=t[0];return e.id()===i.value}],"filter-type-==":[Oe,[We],function(e,t){var i=t[0];return e.geometryType()===i.value}],"filter-<":[Oe,[We,qe],function(e,t){var i=t[0],l=t[1],p=e.properties()[i.value],m=l.value;return typeof p==typeof m&&p<m}],"filter-id-<":[Oe,[qe],function(e,t){var i=t[0],l=e.id(),p=i.value;return typeof l==typeof p&&l<p}],"filter->":[Oe,[We,qe],function(e,t){var i=t[0],l=t[1],p=e.properties()[i.value],m=l.value;return typeof p==typeof m&&p>m}],"filter-id->":[Oe,[qe],function(e,t){var i=t[0],l=e.id(),p=i.value;return typeof l==typeof p&&l>p}],"filter-<=":[Oe,[We,qe],function(e,t){var i=t[0],l=t[1],p=e.properties()[i.value],m=l.value;return typeof p==typeof m&&p<=m}],"filter-id-<=":[Oe,[qe],function(e,t){var i=t[0],l=e.id(),p=i.value;return typeof l==typeof p&&l<=p}],"filter->=":[Oe,[We,qe],function(e,t){var i=t[0],l=t[1],p=e.properties()[i.value],m=l.value;return typeof p==typeof m&&p>=m}],"filter-id->=":[Oe,[qe],function(e,t){var i=t[0],l=e.id(),p=i.value;return typeof l==typeof p&&l>=p}],"filter-has":[Oe,[qe],function(e,t){return t[0].value in e.properties()}],"filter-has-id":[Oe,[],function(e){return e.id()!==null&&e.id()!==void 0}],"filter-type-in":[Oe,[er(We)],function(e,t){return t[0].value.indexOf(e.geometryType())>=0}],"filter-id-in":[Oe,[er(qe)],function(e,t){return t[0].value.indexOf(e.id())>=0}],"filter-in-small":[Oe,[We,er(qe)],function(e,t){var i=t[0];return t[1].value.indexOf(e.properties()[i.value])>=0}],"filter-in-large":[Oe,[We,er(qe)],function(e,t){var i=t[0],l=t[1];return function(p,m,x,S){for(;x<=S;){var I=x+S>>1;if(m[I]===p)return!0;m[I]>p?S=I-1:x=I+1}return!1}(e.properties()[i.value],l.value,0,l.value.length-1)}],all:{type:Oe,overloads:[[[Oe,Oe],function(e,t){var i=t[1];return t[0].evaluate(e)&&i.evaluate(e)}],[va(Oe),function(e,t){for(var i=0,l=t;i<l.length;i+=1)if(!l[i].evaluate(e))return!1;return!0}]]},any:{type:Oe,overloads:[[[Oe,Oe],function(e,t){var i=t[1];return t[0].evaluate(e)||i.evaluate(e)}],[va(Oe),function(e,t){for(var i=0,l=t;i<l.length;i+=1)if(l[i].evaluate(e))return!0;return!1}]]},"!":[Oe,[Oe],function(e,t){return!t[0].evaluate(e)}],"is-supported-script":[Oe,[We],function(e,t){var i=e.globals&&e.globals.isSupportedScript;return!i||i(t[0].evaluate(e))}],upcase:[We,[We],function(e,t){return t[0].evaluate(e).toUpperCase()}],downcase:[We,[We],function(e,t){return t[0].evaluate(e).toLowerCase()}],concat:[We,va(qe),function(e,t){return t.map(function(i){return bo(i.evaluate(e))}).join("")}],"resolved-locale":[We,[Vt],function(e,t){return t[0].evaluate(e).resolvedLocale()}]});var Ua=function(e,t){this.expression=e,this._warningHistory={},this._evaluator=new Vi,this._defaultValue=t?function(i){return i.type==="color"&&Ns(i.default)?new tr(0,0,0,0):i.type==="color"?tr.parse(i.default)||null:i.default===void 0?null:i.default}(t):null,this._enumValues=t&&t.type==="enum"?t.values:null};function us(e){return Array.isArray(e)&&e.length>0&&typeof e[0]=="string"&&e[0]in ga}function Vs(e,t){var i=new Gr(ga,[],t?function(p){var m={color:je,string:We,number:Se,enum:We,boolean:Oe,formatted:lr,resolvedImage:Pt};return p.type==="array"?er(m[p.value]||qe,p.length):m[p.type]}(t):void 0),l=i.parse(e,void 0,void 0,void 0,t&&t.type==="string"?{typeAnnotation:"coerce"}:void 0);return l?pc(new Ua(l,t)):ba(i.errors)}Ua.prototype.evaluateWithoutErrorHandling=function(e,t,i,l,p,m){return this._evaluator.globals=e,this._evaluator.feature=t,this._evaluator.featureState=i,this._evaluator.canonical=l,this._evaluator.availableImages=p||null,this._evaluator.formattedSection=m,this.expression.evaluate(this._evaluator)},Ua.prototype.evaluate=function(e,t,i,l,p,m){this._evaluator.globals=e,this._evaluator.feature=t||null,this._evaluator.featureState=i||null,this._evaluator.canonical=l,this._evaluator.availableImages=p||null,this._evaluator.formattedSection=m||null;try{var x=this.expression.evaluate(this._evaluator);if(x==null||typeof x=="number"&&x!=x)return this._defaultValue;if(this._enumValues&&!(x in this._enumValues))throw new ai("Expected value to be one of "+Object.keys(this._enumValues).map(function(S){return JSON.stringify(S)}).join(", ")+", but found "+JSON.stringify(x)+" instead.");return x}catch(S){return this._warningHistory[S.message]||(this._warningHistory[S.message]=!0,typeof console<"u"&&console.warn(S.message)),this._defaultValue}};var cs=function(e,t){this.kind=e,this._styleExpression=t,this.isStateDependent=e!=="constant"&&!ye(t.expression)};cs.prototype.evaluateWithoutErrorHandling=function(e,t,i,l,p,m){return this._styleExpression.evaluateWithoutErrorHandling(e,t,i,l,p,m)},cs.prototype.evaluate=function(e,t,i,l,p,m){return this._styleExpression.evaluate(e,t,i,l,p,m)};var Va=function(e,t,i,l){this.kind=e,this.zoomStops=i,this._styleExpression=t,this.isStateDependent=e!=="camera"&&!ye(t.expression),this.interpolationType=l};function yc(e,t){if((e=Vs(e,t)).result==="error")return e;var i=e.value.expression,l=ko(i);if(!l&&!xa(t))return ba([new we("","data expressions not supported")]);var p=un(i,["zoom"]);if(!p&&!fc(t))return ba([new we("","zoom expressions not supported")]);var m=function x(S){var I=null;if(S instanceof Go)I=x(S.result);else if(S instanceof Zo)for(var A=0,C=S.args;A<C.length&&!(I=x(C[A]));A+=1);else(S instanceof Nn||S instanceof en)&&S.input instanceof Ei&&S.input.name==="zoom"&&(I=S);return I instanceof we||S.eachChild(function(B){var U=x(B);U instanceof we?I=U:!I&&U?I=new we("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.'):I&&U&&I!==U&&(I=new we("",'Only one zoom-based "step" or "interpolate" subexpression may be used in an expression.'))}),I}(i);return m||p?m instanceof we?ba([m]):m instanceof en&&!ls(t)?ba([new we("",'"interpolate" expressions cannot be used with this property')]):pc(m?new Va(l?"camera":"composite",e.value,m.labels,m instanceof en?m.interpolation:void 0):new cs(l?"constant":"source",e.value)):ba([new we("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.')])}Va.prototype.evaluateWithoutErrorHandling=function(e,t,i,l,p,m){return this._styleExpression.evaluateWithoutErrorHandling(e,t,i,l,p,m)},Va.prototype.evaluate=function(e,t,i,l,p,m){return this._styleExpression.evaluate(e,t,i,l,p,m)},Va.prototype.interpolationFactor=function(e,t,i){return this.interpolationType?en.interpolationFactor(this.interpolationType,e,t,i):0};var ja=function(e,t){this._parameters=e,this._specification=t,Ce(this,function i(l,p){var m,x,S,I=p.type==="color",A=l.stops&&typeof l.stops[0][0]=="object",C=A||!(A||l.property!==void 0),B=l.type||(ls(p)?"exponential":"interval");if(I&&((l=Ce({},l)).stops&&(l.stops=l.stops.map(function(tt){return[tt[0],tr.parse(tt[1])]})),l.default=tr.parse(l.default?l.default:p.default)),l.colorSpace&&l.colorSpace!=="rgb"&&!ic[l.colorSpace])throw new Error("Unknown color space: "+l.colorSpace);if(B==="exponential")m=mc;else if(B==="interval")m=jh;else if(B==="categorical"){m=dc,x=Object.create(null);for(var U=0,q=l.stops;U<q.length;U+=1){var Q=q[U];x[Q[0]]=Q[1]}S=typeof l.stops[0][0]}else{if(B!=="identity")throw new Error('Unknown function type "'+B+'"');m=Us}if(A){for(var ee={},ce=[],ie=0;ie<l.stops.length;ie++){var de=l.stops[ie],be=de[0].zoom;ee[be]===void 0&&(ee[be]={zoom:be,type:l.type,property:l.property,default:l.default,stops:[]},ce.push(be)),ee[be].stops.push([de[0].value,de[1]])}for(var ke=[],Ie=0,Pe=ce;Ie<Pe.length;Ie+=1){var Ue=Pe[Ie];ke.push([ee[Ue].zoom,i(ee[Ue],p)])}var He={name:"linear"};return{kind:"composite",interpolationType:He,interpolationFactor:en.interpolationFactor.bind(void 0,He),zoomStops:ke.map(function(tt){return tt[0]}),evaluate:function(tt,bt){var it=tt.zoom;return mc({stops:ke,base:l.base},p,it).evaluate(it,bt)}}}if(C){var ft=B==="exponential"?{name:"exponential",base:l.base!==void 0?l.base:1}:null;return{kind:"camera",interpolationType:ft,interpolationFactor:en.interpolationFactor.bind(void 0,ft),zoomStops:l.stops.map(function(tt){return tt[0]}),evaluate:function(tt){return m(l,p,tt.zoom,x,S)}}}return{kind:"source",evaluate:function(tt,bt){var it=bt&&bt.properties?bt.properties[l.property]:void 0;return it===void 0?Na(l.default,p.default):m(l,p,it,x,S)}}}(this._parameters,this._specification))};function po(e){var t=e.key,i=e.value,l=e.valueSpec||{},p=e.objectElementValidators||{},m=e.style,x=e.styleSpec,S=[],I=Vr(i);if(I!=="object")return[new J(t,i,"object expected, "+I+" found")];for(var A in i){var C=A.split(".")[0],B=l[C]||l["*"],U=void 0;if(p[C])U=p[C];else if(l[C])U=mr;else if(p["*"])U=p["*"];else{if(!l["*"]){S.push(new J(t,i[A],'unknown property "'+A+'"'));continue}U=mr}S=S.concat(U({key:(t&&t+".")+A,value:i[A],valueSpec:B,style:m,styleSpec:x,object:i,objectKey:A},i))}for(var q in l)p[q]||l[q].required&&l[q].default===void 0&&i[q]===void 0&&S.push(new J(t,i,'missing required property "'+q+'"'));return S}function _c(e){var t=e.value,i=e.valueSpec,l=e.style,p=e.styleSpec,m=e.key,x=e.arrayElementValidator||mr;if(Vr(t)!=="array")return[new J(m,t,"array expected, "+Vr(t)+" found")];if(i.length&&t.length!==i.length)return[new J(m,t,"array length "+i.length+" expected, length "+t.length+" found")];if(i["min-length"]&&t.length<i["min-length"])return[new J(m,t,"array length at least "+i["min-length"]+" expected, length "+t.length+" found")];var S={type:i.value,values:i.values};p.$version<7&&(S.function=i.function),Vr(i.value)==="object"&&(S=i.value);for(var I=[],A=0;A<t.length;A++)I=I.concat(x({array:t,arrayIndex:A,value:t[A],valueSpec:S,style:l,styleSpec:p,key:m+"["+A+"]"}));return I}function gc(e){var t=e.key,i=e.value,l=e.valueSpec,p=Vr(i);return p==="number"&&i!=i&&(p="NaN"),p!=="number"?[new J(t,i,"number expected, "+p+" found")]:"minimum"in l&&i<l.minimum?[new J(t,i,i+" is less than the minimum value "+l.minimum)]:"maximum"in l&&i>l.maximum?[new J(t,i,i+" is greater than the maximum value "+l.maximum)]:[]}function vc(e){var t,i,l,p=e.valueSpec,m=Me(e.value.type),x={},S=m!=="categorical"&&e.value.property===void 0,I=!S,A=Vr(e.value.stops)==="array"&&Vr(e.value.stops[0])==="array"&&Vr(e.value.stops[0][0])==="object",C=po({key:e.key,value:e.value,valueSpec:e.styleSpec.function,style:e.style,styleSpec:e.styleSpec,objectElementValidators:{stops:function(q){if(m==="identity")return[new J(q.key,q.value,'identity function may not have a "stops" property')];var Q=[],ee=q.value;return Q=Q.concat(_c({key:q.key,value:ee,valueSpec:q.valueSpec,style:q.style,styleSpec:q.styleSpec,arrayElementValidator:B})),Vr(ee)==="array"&&ee.length===0&&Q.push(new J(q.key,ee,"array must have at least one stop")),Q},default:function(q){return mr({key:q.key,value:q.value,valueSpec:p,style:q.style,styleSpec:q.styleSpec})}}});return m==="identity"&&S&&C.push(new J(e.key,e.value,'missing required property "property"')),m==="identity"||e.value.stops||C.push(new J(e.key,e.value,'missing required property "stops"')),m==="exponential"&&e.valueSpec.expression&&!ls(e.valueSpec)&&C.push(new J(e.key,e.value,"exponential functions not supported")),e.styleSpec.$version>=8&&(I&&!xa(e.valueSpec)?C.push(new J(e.key,e.value,"property functions not supported")):S&&!fc(e.valueSpec)&&C.push(new J(e.key,e.value,"zoom functions not supported"))),m!=="categorical"&&!A||e.value.property!==void 0||C.push(new J(e.key,e.value,'"property" property is required')),C;function B(q){var Q=[],ee=q.value,ce=q.key;if(Vr(ee)!=="array")return[new J(ce,ee,"array expected, "+Vr(ee)+" found")];if(ee.length!==2)return[new J(ce,ee,"array length 2 expected, length "+ee.length+" found")];if(A){if(Vr(ee[0])!=="object")return[new J(ce,ee,"object expected, "+Vr(ee[0])+" found")];if(ee[0].zoom===void 0)return[new J(ce,ee,"object stop key must have zoom")];if(ee[0].value===void 0)return[new J(ce,ee,"object stop key must have value")];if(l&&l>Me(ee[0].zoom))return[new J(ce,ee[0].zoom,"stop zoom values must appear in ascending order")];Me(ee[0].zoom)!==l&&(l=Me(ee[0].zoom),i=void 0,x={}),Q=Q.concat(po({key:ce+"[0]",value:ee[0],valueSpec:{zoom:{}},style:q.style,styleSpec:q.styleSpec,objectElementValidators:{zoom:gc,value:U}}))}else Q=Q.concat(U({key:ce+"[0]",value:ee[0],valueSpec:{},style:q.style,styleSpec:q.styleSpec},ee));return us(W(ee[1]))?Q.concat([new J(ce+"[1]",ee[1],"expressions are not allowed in function stops.")]):Q.concat(mr({key:ce+"[1]",value:ee[1],valueSpec:p,style:q.style,styleSpec:q.styleSpec}))}function U(q,Q){var ee=Vr(q.value),ce=Me(q.value),ie=q.value!==null?q.value:Q;if(t){if(ee!==t)return[new J(q.key,ie,ee+" stop domain type must match previous stop domain type "+t)]}else t=ee;if(ee!=="number"&&ee!=="string"&&ee!=="boolean")return[new J(q.key,ie,"stop domain value must be a number, string, or boolean")];if(ee!=="number"&&m!=="categorical"){var de="number expected, "+ee+" found";return xa(p)&&m===void 0&&(de+='\nIf you intended to use a categorical function, specify `"type": "categorical"`.'),[new J(q.key,ie,de)]}return m!=="categorical"||ee!=="number"||isFinite(ce)&&Math.floor(ce)===ce?m!=="categorical"&&ee==="number"&&i!==void 0&&ce<i?[new J(q.key,ie,"stop domain values must appear in ascending order")]:(i=ce,m==="categorical"&&ce in x?[new J(q.key,ie,"stop domain values must be unique")]:(x[ce]=!0,[])):[new J(q.key,ie,"integer expected, found "+ce)]}}function wa(e){var t=(e.expressionContext==="property"?yc:Vs)(W(e.value),e.valueSpec);if(t.result==="error")return t.value.map(function(l){return new J(""+e.key+l.key,e.value,l.message)});var i=t.value.expression||t.value._styleExpression.expression;if(e.expressionContext==="property"&&e.propertyKey==="text-font"&&!i.outputDefined())return[new J(e.key,e.value,'Invalid data expression for "'+e.propertyKey+'". Output values must be contained as literals within the expression.')];if(e.expressionContext==="property"&&e.propertyType==="layout"&&!ye(i))return[new J(e.key,e.value,'"feature-state" data expressions are not supported with layout properties.')];if(e.expressionContext==="filter"&&!ye(i))return[new J(e.key,e.value,'"feature-state" data expressions are not supported with filters.')];if(e.expressionContext&&e.expressionContext.indexOf("cluster")===0){if(!un(i,["zoom","feature-state"]))return[new J(e.key,e.value,'"zoom" and "feature-state" expressions are not supported with cluster properties.')];if(e.expressionContext==="cluster-initial"&&!ko(i))return[new J(e.key,e.value,"Feature data expressions are not supported with initial expression part of cluster properties.")]}return[]}function hs(e){var t=e.key,i=e.value,l=e.valueSpec,p=[];return Array.isArray(l.values)?l.values.indexOf(Me(i))===-1&&p.push(new J(t,i,"expected one of ["+l.values.join(", ")+"], "+JSON.stringify(i)+" found")):Object.keys(l.values).indexOf(Me(i))===-1&&p.push(new J(t,i,"expected one of ["+Object.keys(l.values).join(", ")+"], "+JSON.stringify(i)+" found")),p}function js(e){if(e===!0||e===!1)return!0;if(!Array.isArray(e)||e.length===0)return!1;switch(e[0]){case"has":return e.length>=2&&e[1]!=="$id"&&e[1]!=="$type";case"in":return e.length>=3&&(typeof e[1]!="string"||Array.isArray(e[2]));case"!in":case"!has":case"none":return!1;case"==":case"!=":case">":case">=":case"<":case"<=":return e.length!==3||Array.isArray(e[1])||Array.isArray(e[2]);case"any":case"all":for(var t=0,i=e.slice(1);t<i.length;t+=1){var l=i[t];if(!js(l)&&typeof l!="boolean")return!1}return!0;default:return!0}}ja.deserialize=function(e){return new ja(e._parameters,e._specification)},ja.serialize=function(e){return{_parameters:e._parameters,_specification:e._specification}};var ql={type:"boolean",default:!1,transition:!1,"property-type":"data-driven",expression:{interpolated:!1,parameters:["zoom","feature"]}};function qs(e){if(e==null)return{filter:function(){return!0},needGeometry:!1};js(e)||(e=Zs(e));var t=Vs(e,ql);if(t.result==="error")throw new Error(t.value.map(function(i){return i.key+": "+i.message}).join(", "));return{filter:function(i,l,p){return t.value.evaluate(i,l,{},p)},needGeometry:function i(l){if(!Array.isArray(l))return!1;if(l[0]==="within")return!0;for(var p=1;p<l.length;p++)if(i(l[p]))return!0;return!1}(e)}}function qh(e,t){return e<t?-1:e>t?1:0}function Zs(e){if(!e)return!0;var t,i=e[0];return e.length<=1?i!=="any":i==="=="?Zl(e[1],e[2],"=="):i==="!="?Gs(Zl(e[1],e[2],"==")):i==="<"||i===">"||i==="<="||i===">="?Zl(e[1],e[2],i):i==="any"?(t=e.slice(1),["any"].concat(t.map(Zs))):i==="all"?["all"].concat(e.slice(1).map(Zs)):i==="none"?["all"].concat(e.slice(1).map(Zs).map(Gs)):i==="in"?bc(e[1],e.slice(2)):i==="!in"?Gs(bc(e[1],e.slice(2))):i==="has"?xc(e[1]):i==="!has"?Gs(xc(e[1])):i!=="within"||e}function Zl(e,t,i){switch(e){case"$type":return["filter-type-"+i,t];case"$id":return["filter-id-"+i,t];default:return["filter-"+i,e,t]}}function bc(e,t){if(t.length===0)return!1;switch(e){case"$type":return["filter-type-in",["literal",t]];case"$id":return["filter-id-in",["literal",t]];default:return t.length>200&&!t.some(function(i){return typeof i!=typeof t[0]})?["filter-in-large",e,["literal",t.sort(qh)]]:["filter-in-small",e,["literal",t]]}}function xc(e){switch(e){case"$type":return!0;case"$id":return["filter-has-id"];default:return["filter-has",e]}}function Gs(e){return["!",e]}function Gl(e){return js(W(e.value))?wa(Ce({},e,{expressionContext:"filter",valueSpec:{value:"boolean"}})):function t(i){var l=i.value,p=i.key;if(Vr(l)!=="array")return[new J(p,l,"array expected, "+Vr(l)+" found")];var m,x=i.styleSpec,S=[];if(l.length<1)return[new J(p,l,"filter array must have at least 1 element")];switch(S=S.concat(hs({key:p+"[0]",value:l[0],valueSpec:x.filter_operator,style:i.style,styleSpec:i.styleSpec})),Me(l[0])){case"<":case"<=":case">":case">=":l.length>=2&&Me(l[1])==="$type"&&S.push(new J(p,l,'"$type" cannot be use with operator "'+l[0]+'"'));case"==":case"!=":l.length!==3&&S.push(new J(p,l,'filter array for operator "'+l[0]+'" must have 3 elements'));case"in":case"!in":l.length>=2&&(m=Vr(l[1]))!=="string"&&S.push(new J(p+"[1]",l[1],"string expected, "+m+" found"));for(var I=2;I<l.length;I++)m=Vr(l[I]),Me(l[1])==="$type"?S=S.concat(hs({key:p+"["+I+"]",value:l[I],valueSpec:x.geometry_type,style:i.style,styleSpec:i.styleSpec})):m!=="string"&&m!=="number"&&m!=="boolean"&&S.push(new J(p+"["+I+"]",l[I],"string, number, or boolean expected, "+m+" found"));break;case"any":case"all":case"none":for(var A=1;A<l.length;A++)S=S.concat(t({key:p+"["+A+"]",value:l[A],style:i.style,styleSpec:i.styleSpec}));break;case"has":case"!has":m=Vr(l[1]),l.length!==2?S.push(new J(p,l,'filter array for "'+l[0]+'" operator must have 2 elements')):m!=="string"&&S.push(new J(p+"[1]",l[1],"string expected, "+m+" found"));break;case"within":m=Vr(l[1]),l.length!==2?S.push(new J(p,l,'filter array for "'+l[0]+'" operator must have 2 elements')):m!=="object"&&S.push(new J(p+"[1]",l[1],"object expected, "+m+" found"))}return S}(e)}function Kl(e,t){var i=e.key,l=e.style,p=e.styleSpec,m=e.value,x=e.objectKey,S=p[t+"_"+e.layerType];if(!S)return[];var I=x.match(/^(.*)-transition$/);if(t==="paint"&&I&&S[I[1]]&&S[I[1]].transition)return mr({key:i,value:m,valueSpec:p.transition,style:l,styleSpec:p});var A,C=e.valueSpec||S[x];if(!C)return[new J(i,m,'unknown property "'+x+'"')];if(Vr(m)==="string"&&xa(C)&&!C.tokens&&(A=/^{([^}]+)}$/.exec(m)))return[new J(i,m,'"'+x+'" does not support interpolation syntax\nUse an identity property function instead: `{ "type": "identity", "property": '+JSON.stringify(A[1])+" }`.")];var B=[];return e.layerType==="symbol"&&(x==="text-field"&&l&&!l.glyphs&&B.push(new J(i,m,'use of "text-field" requires a style "glyphs" property')),x==="text-font"&&Ns(W(m))&&Me(m.type)==="identity"&&B.push(new J(i,m,'"text-font" does not support identity functions'))),B.concat(mr({key:e.key,value:m,valueSpec:C,style:l,styleSpec:p,expressionContext:"property",propertyType:t,propertyKey:x}))}function Xl(e){return Kl(e,"paint")}function ps(e){return Kl(e,"layout")}function wc(e){var t=[],i=e.value,l=e.key,p=e.style,m=e.styleSpec;i.type||i.ref||t.push(new J(l,i,'either "type" or "ref" is required'));var x,S=Me(i.type),I=Me(i.ref);if(i.id)for(var A=Me(i.id),C=0;C<e.arrayIndex;C++){var B=p.layers[C];Me(B.id)===A&&t.push(new J(l,i.id,'duplicate layer id "'+i.id+'", previously used at line '+B.id.__line__))}if("ref"in i)["type","source","source-layer","filter","layout"].forEach(function(Q){Q in i&&t.push(new J(l,i[Q],'"'+Q+'" is prohibited for ref layers'))}),p.layers.forEach(function(Q){Me(Q.id)===I&&(x=Q)}),x?x.ref?t.push(new J(l,i.ref,"ref cannot reference another ref layer")):S=Me(x.type):t.push(new J(l,i.ref,'ref layer "'+I+'" not found'));else if(S!=="background")if(i.source){var U=p.sources&&p.sources[i.source],q=U&&Me(U.type);U?q==="vector"&&S==="raster"?t.push(new J(l,i.source,'layer "'+i.id+'" requires a raster source')):q==="raster"&&S!=="raster"?t.push(new J(l,i.source,'layer "'+i.id+'" requires a vector source')):q!=="vector"||i["source-layer"]?q==="raster-dem"&&S!=="hillshade"?t.push(new J(l,i.source,"raster-dem source can only be used with layer type 'hillshade'.")):S!=="line"||!i.paint||!i.paint["line-gradient"]||q==="geojson"&&U.lineMetrics||t.push(new J(l,i,'layer "'+i.id+'" specifies a line-gradient, which requires a GeoJSON source with `lineMetrics` enabled.')):t.push(new J(l,i,'layer "'+i.id+'" must specify a "source-layer"')):t.push(new J(l,i.source,'source "'+i.source+'" not found'))}else t.push(new J(l,i,'missing required property "source"'));return t=t.concat(po({key:l,value:i,valueSpec:m.layer,style:e.style,styleSpec:e.styleSpec,objectElementValidators:{"*":function(){return[]},type:function(){return mr({key:l+".type",value:i.type,valueSpec:m.layer.type,style:e.style,styleSpec:e.styleSpec,object:i,objectKey:"type"})},filter:Gl,layout:function(Q){return po({layer:i,key:Q.key,value:Q.value,style:Q.style,styleSpec:Q.styleSpec,objectElementValidators:{"*":function(ee){return ps(Ce({layerType:S},ee))}}})},paint:function(Q){return po({layer:i,key:Q.key,value:Q.value,style:Q.style,styleSpec:Q.styleSpec,objectElementValidators:{"*":function(ee){return Xl(Ce({layerType:S},ee))}}})}}}))}function ka(e){var t=e.value,i=e.key,l=Vr(t);return l!=="string"?[new J(i,t,"string expected, "+l+" found")]:[]}var Wr={promoteId:function(e){var t=e.key,i=e.value;if(Vr(i)==="string")return ka({key:t,value:i});var l=[];for(var p in i)l.push.apply(l,ka({key:t+"."+p,value:i[p]}));return l}};function Ks(e){var t=e.value,i=e.key,l=e.styleSpec,p=e.style;if(!t.type)return[new J(i,t,'"type" is required')];var m,x=Me(t.type);switch(x){case"vector":case"raster":case"raster-dem":return po({key:i,value:t,valueSpec:l["source_"+x.replace("-","_")],style:e.style,styleSpec:l,objectElementValidators:Wr});case"geojson":if(m=po({key:i,value:t,valueSpec:l.source_geojson,style:p,styleSpec:l,objectElementValidators:Wr}),t.cluster)for(var S in t.clusterProperties){var I=t.clusterProperties[S],A=I[0],C=typeof A=="string"?[A,["accumulated"],["get",S]]:A;m.push.apply(m,wa({key:i+"."+S+".map",value:I[1],expressionContext:"cluster-map"})),m.push.apply(m,wa({key:i+"."+S+".reduce",value:C,expressionContext:"cluster-reduce"}))}return m;case"video":return po({key:i,value:t,valueSpec:l.source_video,style:p,styleSpec:l});case"image":return po({key:i,value:t,valueSpec:l.source_image,style:p,styleSpec:l});case"canvas":return[new J(i,null,"Please use runtime APIs to add canvas sources, rather than including them in stylesheets.","source.canvas")];default:return hs({key:i+".type",value:t.type,valueSpec:{values:["vector","raster","raster-dem","geojson","video","image"]},style:p,styleSpec:l})}}function Sa(e){var t=e.value,i=e.styleSpec,l=i.light,p=e.style,m=[],x=Vr(t);if(t===void 0)return m;if(x!=="object")return m.concat([new J("light",t,"object expected, "+x+" found")]);for(var S in t){var I=S.match(/^(.*)-transition$/);m=m.concat(I&&l[I[1]]&&l[I[1]].transition?mr({key:S,value:t[S],valueSpec:i.transition,style:p,styleSpec:i}):l[S]?mr({key:S,value:t[S],valueSpec:l[S],style:p,styleSpec:i}):[new J(S,t[S],'unknown property "'+S+'"')])}return m}var Ho={"*":function(){return[]},array:_c,boolean:function(e){var t=e.value,i=e.key,l=Vr(t);return l!=="boolean"?[new J(i,t,"boolean expected, "+l+" found")]:[]},number:gc,color:function(e){var t=e.key,i=e.value,l=Vr(i);return l!=="string"?[new J(t,i,"color expected, "+l+" found")]:Gt(i)===null?[new J(t,i,'color expected, "'+i+'" found')]:[]},constants:_e,enum:hs,filter:Gl,function:vc,layer:wc,object:po,source:Ks,light:Sa,string:ka,formatted:function(e){return ka(e).length===0?[]:wa(e)},resolvedImage:function(e){return ka(e).length===0?[]:wa(e)}};function mr(e){var t=e.value,i=e.valueSpec,l=e.styleSpec;return i.expression&&Ns(Me(t))?vc(e):i.expression&&us(W(t))?wa(e):i.type&&Ho[i.type]?Ho[i.type](e):po(Ce({},e,{valueSpec:i.type?l[i.type]:i}))}function jr(e){var t=e.value,i=e.key,l=ka(e);return l.length||(t.indexOf("{fontstack}")===-1&&l.push(new J(i,t,'"glyphs" url must include a "{fontstack}" token')),t.indexOf("{range}")===-1&&l.push(new J(i,t,'"glyphs" url must include a "{range}" token'))),l}function Yn(e,t){t===void 0&&(t=j);var i=[];return i=i.concat(mr({key:"",value:e,valueSpec:t.$root,styleSpec:t,style:e,objectElementValidators:{glyphs:jr,"*":function(){return[]}}})),e.constants&&(i=i.concat(_e({key:"constants",value:e.constants,style:e,styleSpec:t}))),fs(i)}function fs(e){return[].concat(e).sort(function(t,i){return t.line-i.line})}function qa(e){return function(){for(var t=[],i=arguments.length;i--;)t[i]=arguments[i];return fs(e.apply(this,t))}}Yn.source=qa(Ks),Yn.light=qa(Sa),Yn.layer=qa(wc),Yn.filter=qa(Gl),Yn.paintProperty=qa(Xl),Yn.layoutProperty=qa(ps);var ds=Yn,Zh=ds.light,Gh=ds.paintProperty,ms=ds.layoutProperty;function ys(e,t){var i=!1;if(t&&t.length)for(var l=0,p=t;l<p.length;l+=1)e.fire(new se(new Error(p[l].message))),i=!0;return i}var Mo=Ti;function Ti(e,t,i){var l=this.cells=[];if(e instanceof ArrayBuffer){this.arrayBuffer=e;var p=new Int32Array(this.arrayBuffer);e=p[0],this.d=(t=p[1])+2*(i=p[2]);for(var m=0;m<this.d*this.d;m++){var x=p[3+m],S=p[3+m+1];l.push(x===S?null:p.subarray(x,S))}var I=p[3+l.length+1];this.keys=p.subarray(p[3+l.length],I),this.bboxes=p.subarray(I),this.insert=this._insertReadonly}else{this.d=t+2*i;for(var A=0;A<this.d*this.d;A++)l.push([]);this.keys=[],this.bboxes=[]}this.n=t,this.extent=e,this.padding=i,this.scale=t/e,this.uid=0;var C=i/t*e;this.min=-C,this.max=e+C}Ti.prototype.insert=function(e,t,i,l,p){this._forEachCell(t,i,l,p,this._insertCell,this.uid++),this.keys.push(e),this.bboxes.push(t),this.bboxes.push(i),this.bboxes.push(l),this.bboxes.push(p)},Ti.prototype._insertReadonly=function(){throw"Cannot insert into a GridIndex created from an ArrayBuffer."},Ti.prototype._insertCell=function(e,t,i,l,p,m){this.cells[p].push(m)},Ti.prototype.query=function(e,t,i,l,p){var m=this.min,x=this.max;if(e<=m&&t<=m&&x<=i&&x<=l&&!p)return Array.prototype.slice.call(this.keys);var S=[];return this._forEachCell(e,t,i,l,this._queryCell,S,{},p),S},Ti.prototype._queryCell=function(e,t,i,l,p,m,x,S){var I=this.cells[p];if(I!==null)for(var A=this.keys,C=this.bboxes,B=0;B<I.length;B++){var U=I[B];if(x[U]===void 0){var q=4*U;(S?S(C[q+0],C[q+1],C[q+2],C[q+3]):e<=C[q+2]&&t<=C[q+3]&&i>=C[q+0]&&l>=C[q+1])?(x[U]=!0,m.push(A[U])):x[U]=!1}}},Ti.prototype._forEachCell=function(e,t,i,l,p,m,x,S){for(var I=this._convertToCellCoord(e),A=this._convertToCellCoord(t),C=this._convertToCellCoord(i),B=this._convertToCellCoord(l),U=I;U<=C;U++)for(var q=A;q<=B;q++){var Q=this.d*q+U;if((!S||S(this._convertFromCellCoord(U),this._convertFromCellCoord(q),this._convertFromCellCoord(U+1),this._convertFromCellCoord(q+1)))&&p.call(this,e,t,i,l,Q,m,x,S))return}},Ti.prototype._convertFromCellCoord=function(e){return(e-this.padding)/this.scale},Ti.prototype._convertToCellCoord=function(e){return Math.max(0,Math.min(this.d-1,Math.floor(e*this.scale)+this.padding))},Ti.prototype.toArrayBuffer=function(){if(this.arrayBuffer)return this.arrayBuffer;for(var e=this.cells,t=3+this.cells.length+1+1,i=0,l=0;l<this.cells.length;l++)i+=this.cells[l].length;var p=new Int32Array(t+i+this.keys.length+this.bboxes.length);p[0]=this.extent,p[1]=this.n,p[2]=this.padding;for(var m=t,x=0;x<e.length;x++){var S=e[x];p[3+x]=m,p.set(S,m),m+=S.length}return p[3+e.length]=m,p.set(this.keys,m),p[3+e.length+1]=m+=this.keys.length,p.set(this.bboxes,m),m+=this.bboxes.length,p.buffer};var _s=D.ImageData,kc=D.ImageBitmap,bi={};function st(e,t,i){i===void 0&&(i={}),Object.defineProperty(t,"_classRegistryKey",{value:e,writeable:!1}),bi[e]={klass:t,omit:i.omit||[],shallow:i.shallow||[]}}for(var Un in st("Object",Object),Mo.serialize=function(e,t){var i=e.toArrayBuffer();return t&&t.push(i),{buffer:i}},Mo.deserialize=function(e){return new Mo(e.buffer)},st("Grid",Mo),st("Color",tr),st("Error",Error),st("ResolvedImage",Mi),st("StylePropertyFunction",ja),st("StyleExpression",Ua,{omit:["_evaluator"]}),st("ZoomDependentExpression",Va),st("ZoomConstantExpression",cs),st("CompoundExpression",Ei,{omit:["_evaluate"]}),ga)ga[Un]._classRegistryKey||st("Expression_"+Un,ga[Un]);function Xs(e){return e&&typeof ArrayBuffer<"u"&&(e instanceof ArrayBuffer||e.constructor&&e.constructor.name==="ArrayBuffer")}function Za(e){return kc&&e instanceof kc}function fo(e,t){if(e==null||typeof e=="boolean"||typeof e=="number"||typeof e=="string"||e instanceof Boolean||e instanceof Number||e instanceof String||e instanceof Date||e instanceof RegExp)return e;if(Xs(e)||Za(e))return t&&t.push(e),e;if(ArrayBuffer.isView(e)){var i=e;return t&&t.push(i.buffer),i}if(e instanceof _s)return t&&t.push(e.data.buffer),e;if(Array.isArray(e)){for(var l=[],p=0,m=e;p<m.length;p+=1)l.push(fo(m[p],t));return l}if(typeof e=="object"){var x=e.constructor,S=x._classRegistryKey;if(!S)throw new Error("can't serialize object of unregistered class");var I=x.serialize?x.serialize(e,t):{};if(!x.serialize){for(var A in e)if(e.hasOwnProperty(A)&&!(bi[S].omit.indexOf(A)>=0)){var C=e[A];I[A]=bi[S].shallow.indexOf(A)>=0?C:fo(C,t)}e instanceof Error&&(I.message=e.message)}if(I.$name)throw new Error("$name property is reserved for worker serialization logic.");return S!=="Object"&&(I.$name=S),I}throw new Error("can't serialize object of type "+typeof e)}function Vn(e){if(e==null||typeof e=="boolean"||typeof e=="number"||typeof e=="string"||e instanceof Boolean||e instanceof Number||e instanceof String||e instanceof Date||e instanceof RegExp||Xs(e)||Za(e)||ArrayBuffer.isView(e)||e instanceof _s)return e;if(Array.isArray(e))return e.map(Vn);if(typeof e=="object"){var t=e.$name||"Object",i=bi[t].klass;if(!i)throw new Error("can't deserialize unregistered class "+t);if(i.deserialize)return i.deserialize(e);for(var l=Object.create(i.prototype),p=0,m=Object.keys(e);p<m.length;p+=1){var x=m[p];if(x!=="$name"){var S=e[x];l[x]=bi[t].shallow.indexOf(x)>=0?S:Vn(S)}}return l}throw new Error("can't deserialize object of type "+typeof e)}var Wl=function(){this.first=!0};Wl.prototype.update=function(e,t){var i=Math.floor(e);return this.first?(this.first=!1,this.lastIntegerZoom=i,this.lastIntegerZoomTime=0,this.lastZoom=e,this.lastFloorZoom=i,!0):(this.lastFloorZoom>i?(this.lastIntegerZoom=i+1,this.lastIntegerZoomTime=t):this.lastFloorZoom<i&&(this.lastIntegerZoom=i,this.lastIntegerZoomTime=t),e!==this.lastZoom&&(this.lastZoom=e,this.lastFloorZoom=i,!0))};var Qe={"Latin-1 Supplement":function(e){return e>=128&&e<=255},Arabic:function(e){return e>=1536&&e<=1791},"Arabic Supplement":function(e){return e>=1872&&e<=1919},"Arabic Extended-A":function(e){return e>=2208&&e<=2303},"Hangul Jamo":function(e){return e>=4352&&e<=4607},"Unified Canadian Aboriginal Syllabics":function(e){return e>=5120&&e<=5759},Khmer:function(e){return e>=6016&&e<=6143},"Unified Canadian Aboriginal Syllabics Extended":function(e){return e>=6320&&e<=6399},"General Punctuation":function(e){return e>=8192&&e<=8303},"Letterlike Symbols":function(e){return e>=8448&&e<=8527},"Number Forms":function(e){return e>=8528&&e<=8591},"Miscellaneous Technical":function(e){return e>=8960&&e<=9215},"Control Pictures":function(e){return e>=9216&&e<=9279},"Optical Character Recognition":function(e){return e>=9280&&e<=9311},"Enclosed Alphanumerics":function(e){return e>=9312&&e<=9471},"Geometric Shapes":function(e){return e>=9632&&e<=9727},"Miscellaneous Symbols":function(e){return e>=9728&&e<=9983},"Miscellaneous Symbols and Arrows":function(e){return e>=11008&&e<=11263},"CJK Radicals Supplement":function(e){return e>=11904&&e<=12031},"Kangxi Radicals":function(e){return e>=12032&&e<=12255},"Ideographic Description Characters":function(e){return e>=12272&&e<=12287},"CJK Symbols and Punctuation":function(e){return e>=12288&&e<=12351},Hiragana:function(e){return e>=12352&&e<=12447},Katakana:function(e){return e>=12448&&e<=12543},Bopomofo:function(e){return e>=12544&&e<=12591},"Hangul Compatibility Jamo":function(e){return e>=12592&&e<=12687},Kanbun:function(e){return e>=12688&&e<=12703},"Bopomofo Extended":function(e){return e>=12704&&e<=12735},"CJK Strokes":function(e){return e>=12736&&e<=12783},"Katakana Phonetic Extensions":function(e){return e>=12784&&e<=12799},"Enclosed CJK Letters and Months":function(e){return e>=12800&&e<=13055},"CJK Compatibility":function(e){return e>=13056&&e<=13311},"CJK Unified Ideographs Extension A":function(e){return e>=13312&&e<=19903},"Yijing Hexagram Symbols":function(e){return e>=19904&&e<=19967},"CJK Unified Ideographs":function(e){return e>=19968&&e<=40959},"Yi Syllables":function(e){return e>=40960&&e<=42127},"Yi Radicals":function(e){return e>=42128&&e<=42191},"Hangul Jamo Extended-A":function(e){return e>=43360&&e<=43391},"Hangul Syllables":function(e){return e>=44032&&e<=55215},"Hangul Jamo Extended-B":function(e){return e>=55216&&e<=55295},"Private Use Area":function(e){return e>=57344&&e<=63743},"CJK Compatibility Ideographs":function(e){return e>=63744&&e<=64255},"Arabic Presentation Forms-A":function(e){return e>=64336&&e<=65023},"Vertical Forms":function(e){return e>=65040&&e<=65055},"CJK Compatibility Forms":function(e){return e>=65072&&e<=65103},"Small Form Variants":function(e){return e>=65104&&e<=65135},"Arabic Presentation Forms-B":function(e){return e>=65136&&e<=65279},"Halfwidth and Fullwidth Forms":function(e){return e>=65280&&e<=65519}};function Hl(e){for(var t=0,i=e;t<i.length;t+=1)if(Ws(i[t].charCodeAt(0)))return!0;return!1}function Ws(e){return!(e!==746&&e!==747&&(e<4352||!(Qe["Bopomofo Extended"](e)||Qe.Bopomofo(e)||Qe["CJK Compatibility Forms"](e)&&!(e>=65097&&e<=65103)||Qe["CJK Compatibility Ideographs"](e)||Qe["CJK Compatibility"](e)||Qe["CJK Radicals Supplement"](e)||Qe["CJK Strokes"](e)||!(!Qe["CJK Symbols and Punctuation"](e)||e>=12296&&e<=12305||e>=12308&&e<=12319||e===12336)||Qe["CJK Unified Ideographs Extension A"](e)||Qe["CJK Unified Ideographs"](e)||Qe["Enclosed CJK Letters and Months"](e)||Qe["Hangul Compatibility Jamo"](e)||Qe["Hangul Jamo Extended-A"](e)||Qe["Hangul Jamo Extended-B"](e)||Qe["Hangul Jamo"](e)||Qe["Hangul Syllables"](e)||Qe.Hiragana(e)||Qe["Ideographic Description Characters"](e)||Qe.Kanbun(e)||Qe["Kangxi Radicals"](e)||Qe["Katakana Phonetic Extensions"](e)||Qe.Katakana(e)&&e!==12540||!(!Qe["Halfwidth and Fullwidth Forms"](e)||e===65288||e===65289||e===65293||e>=65306&&e<=65310||e===65339||e===65341||e===65343||e>=65371&&e<=65503||e===65507||e>=65512&&e<=65519)||!(!Qe["Small Form Variants"](e)||e>=65112&&e<=65118||e>=65123&&e<=65126)||Qe["Unified Canadian Aboriginal Syllabics"](e)||Qe["Unified Canadian Aboriginal Syllabics Extended"](e)||Qe["Vertical Forms"](e)||Qe["Yijing Hexagram Symbols"](e)||Qe["Yi Syllables"](e)||Qe["Yi Radicals"](e))))}function Jl(e){return!(Ws(e)||function(t){return!!(Qe["Latin-1 Supplement"](t)&&(t===167||t===169||t===174||t===177||t===188||t===189||t===190||t===215||t===247)||Qe["General Punctuation"](t)&&(t===8214||t===8224||t===8225||t===8240||t===8241||t===8251||t===8252||t===8258||t===8263||t===8264||t===8265||t===8273)||Qe["Letterlike Symbols"](t)||Qe["Number Forms"](t)||Qe["Miscellaneous Technical"](t)&&(t>=8960&&t<=8967||t>=8972&&t<=8991||t>=8996&&t<=9e3||t===9003||t>=9085&&t<=9114||t>=9150&&t<=9165||t===9167||t>=9169&&t<=9179||t>=9186&&t<=9215)||Qe["Control Pictures"](t)&&t!==9251||Qe["Optical Character Recognition"](t)||Qe["Enclosed Alphanumerics"](t)||Qe["Geometric Shapes"](t)||Qe["Miscellaneous Symbols"](t)&&!(t>=9754&&t<=9759)||Qe["Miscellaneous Symbols and Arrows"](t)&&(t>=11026&&t<=11055||t>=11088&&t<=11097||t>=11192&&t<=11243)||Qe["CJK Symbols and Punctuation"](t)||Qe.Katakana(t)||Qe["Private Use Area"](t)||Qe["CJK Compatibility Forms"](t)||Qe["Small Form Variants"](t)||Qe["Halfwidth and Fullwidth Forms"](t)||t===8734||t===8756||t===8757||t>=9984&&t<=10087||t>=10102&&t<=10131||t===65532||t===65533)}(e))}function io(e){return e>=1424&&e<=2303||Qe["Arabic Presentation Forms-A"](e)||Qe["Arabic Presentation Forms-B"](e)}function jn(e,t){return!(!t&&io(e)||e>=2304&&e<=3583||e>=3840&&e<=4255||Qe.Khmer(e))}function Hs(e){for(var t=0,i=e;t<i.length;t+=1)if(io(i[t].charCodeAt(0)))return!0;return!1}var Js=null,qn="unavailable",Do=null,Sc=function(e){e&&typeof e=="string"&&e.indexOf("NetworkError")>-1&&(qn="error"),Js&&Js(e)};function gs(){Yl.fire(new $("pluginStateChange",{pluginStatus:qn,pluginURL:Do}))}var Yl=new pe,Ql=function(){return qn},mo=function(){if(qn!=="deferred"||!Do)throw new Error("rtl-text-plugin cannot be downloaded unless a pluginURL is specified");qn="loading",gs(),Do&&ni({url:Do},function(e){e?Sc(e):(qn="loaded",gs())})},Qn={applyArabicShaping:null,processBidirectionalText:null,processStyledBidirectionalText:null,isLoaded:function(){return qn==="loaded"||Qn.applyArabicShaping!=null},isLoading:function(){return qn==="loading"},setState:function(e){qn=e.pluginStatus,Do=e.pluginURL},isParsed:function(){return Qn.applyArabicShaping!=null&&Qn.processBidirectionalText!=null&&Qn.processStyledBidirectionalText!=null},getPluginURL:function(){return Do}},ur=function(e,t){this.zoom=e,t?(this.now=t.now,this.fadeDuration=t.fadeDuration,this.zoomHistory=t.zoomHistory,this.transition=t.transition):(this.now=0,this.fadeDuration=0,this.zoomHistory=new Wl,this.transition={})};ur.prototype.isSupportedScript=function(e){return function(t,i){for(var l=0,p=t;l<p.length;l+=1)if(!jn(p[l].charCodeAt(0),i))return!1;return!0}(e,Qn.isLoaded())},ur.prototype.crossFadingFactor=function(){return this.fadeDuration===0?1:Math.min((this.now-this.zoomHistory.lastIntegerZoomTime)/this.fadeDuration,1)},ur.prototype.getCrossfadeParameters=function(){var e=this.zoom,t=e-Math.floor(e),i=this.crossFadingFactor();return e>this.zoomHistory.lastIntegerZoom?{fromScale:2,toScale:1,t:t+(1-t)*i}:{fromScale:.5,toScale:1,t:1-(1-i)*t}};var Eo=function(e,t){this.property=e,this.value=t,this.expression=function(i,l){if(Ns(i))return new ja(i,l);if(us(i)){var p=yc(i,l);if(p.result==="error")throw new Error(p.value.map(function(x){return x.key+": "+x.message}).join(", "));return p.value}var m=i;return typeof i=="string"&&l.type==="color"&&(m=tr.parse(i)),{kind:"constant",evaluate:function(){return m}}}(t===void 0?e.specification.default:t,e.specification)};Eo.prototype.isDataDriven=function(){return this.expression.kind==="source"||this.expression.kind==="composite"},Eo.prototype.possiblyEvaluate=function(e,t,i){return this.property.possiblyEvaluate(this,e,t,i)};var no=function(e){this.property=e,this.value=new Eo(e,void 0)};no.prototype.transitioned=function(e,t){return new Ea(this.property,this.value,t,xe({},e.transition,this.transition),e.now)},no.prototype.untransitioned=function(){return new Ea(this.property,this.value,null,{},0)};var tn=function(e){this._properties=e,this._values=Object.create(e.defaultTransitionablePropertyValues)};tn.prototype.getValue=function(e){return ht(this._values[e].value.value)},tn.prototype.setValue=function(e,t){this._values.hasOwnProperty(e)||(this._values[e]=new no(this._values[e].property)),this._values[e].value=new Eo(this._values[e].property,t===null?void 0:ht(t))},tn.prototype.getTransition=function(e){return ht(this._values[e].transition)},tn.prototype.setTransition=function(e,t){this._values.hasOwnProperty(e)||(this._values[e]=new no(this._values[e].property)),this._values[e].transition=ht(t)||void 0},tn.prototype.serialize=function(){for(var e={},t=0,i=Object.keys(this._values);t<i.length;t+=1){var l=i[t],p=this.getValue(l);p!==void 0&&(e[l]=p);var m=this.getTransition(l);m!==void 0&&(e[l+"-transition"]=m)}return e},tn.prototype.transitioned=function(e,t){for(var i=new Jo(this._properties),l=0,p=Object.keys(this._values);l<p.length;l+=1){var m=p[l];i._values[m]=this._values[m].transitioned(e,t._values[m])}return i},tn.prototype.untransitioned=function(){for(var e=new Jo(this._properties),t=0,i=Object.keys(this._values);t<i.length;t+=1){var l=i[t];e._values[l]=this._values[l].untransitioned()}return e};var Ea=function(e,t,i,l,p){this.property=e,this.value=t,this.begin=p+l.delay||0,this.end=this.begin+l.duration||0,e.specification.transition&&(l.delay||l.duration)&&(this.prior=i)};Ea.prototype.possiblyEvaluate=function(e,t,i){var l=e.now||0,p=this.value.possiblyEvaluate(e,t,i),m=this.prior;if(m){if(l>this.end)return this.prior=null,p;if(this.value.isDataDriven())return this.prior=null,p;if(l<this.begin)return m.possiblyEvaluate(e,t,i);var x=(l-this.begin)/(this.end-this.begin);return this.property.interpolate(m.possiblyEvaluate(e,t,i),p,function(S){if(S<=0)return 0;if(S>=1)return 1;var I=S*S,A=I*S;return 4*(S<.5?A:3*(S-I)+A-.75)}(x))}return p};var Jo=function(e){this._properties=e,this._values=Object.create(e.defaultTransitioningPropertyValues)};Jo.prototype.possiblyEvaluate=function(e,t,i){for(var l=new vs(this._properties),p=0,m=Object.keys(this._values);p<m.length;p+=1){var x=m[p];l._values[x]=this._values[x].possiblyEvaluate(e,t,i)}return l},Jo.prototype.hasTransition=function(){for(var e=0,t=Object.keys(this._values);e<t.length;e+=1)if(this._values[t[e]].prior)return!0;return!1};var yo=function(e){this._properties=e,this._values=Object.create(e.defaultPropertyValues)};yo.prototype.getValue=function(e){return ht(this._values[e].value)},yo.prototype.setValue=function(e,t){this._values[e]=new Eo(this._values[e].property,t===null?void 0:ht(t))},yo.prototype.serialize=function(){for(var e={},t=0,i=Object.keys(this._values);t<i.length;t+=1){var l=i[t],p=this.getValue(l);p!==void 0&&(e[l]=p)}return e},yo.prototype.possiblyEvaluate=function(e,t,i){for(var l=new vs(this._properties),p=0,m=Object.keys(this._values);p<m.length;p+=1){var x=m[p];l._values[x]=this._values[x].possiblyEvaluate(e,t,i)}return l};var bn=function(e,t,i){this.property=e,this.value=t,this.parameters=i};bn.prototype.isConstant=function(){return this.value.kind==="constant"},bn.prototype.constantOr=function(e){return this.value.kind==="constant"?this.value.value:e},bn.prototype.evaluate=function(e,t,i,l){return this.property.evaluate(this.value,this.parameters,e,t,i,l)};var vs=function(e){this._properties=e,this._values=Object.create(e.defaultPossiblyEvaluatedValues)};vs.prototype.get=function(e){return this._values[e]};var gt=function(e){this.specification=e};gt.prototype.possiblyEvaluate=function(e,t){return e.expression.evaluate(t)},gt.prototype.interpolate=function(e,t,i){var l=Fa[this.specification.type];return l?l(e,t,i):e};var ut=function(e,t){this.specification=e,this.overrides=t};ut.prototype.possiblyEvaluate=function(e,t,i,l){return new bn(this,e.expression.kind==="constant"||e.expression.kind==="camera"?{kind:"constant",value:e.expression.evaluate(t,null,{},i,l)}:e.expression,t)},ut.prototype.interpolate=function(e,t,i){if(e.value.kind!=="constant"||t.value.kind!=="constant")return e;if(e.value.value===void 0||t.value.value===void 0)return new bn(this,{kind:"constant",value:void 0},e.parameters);var l=Fa[this.specification.type];return l?new bn(this,{kind:"constant",value:l(e.value.value,t.value.value,i)},e.parameters):e},ut.prototype.evaluate=function(e,t,i,l,p,m){return e.kind==="constant"?e.value:e.evaluate(t,i,l,p,m)};var Ys=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.possiblyEvaluate=function(i,l,p,m){if(i.value===void 0)return new bn(this,{kind:"constant",value:void 0},l);if(i.expression.kind==="constant"){var x=i.expression.evaluate(l,null,{},p,m),S=i.property.specification.type==="resolvedImage"&&typeof x!="string"?x.name:x,I=this._calculate(S,S,S,l);return new bn(this,{kind:"constant",value:I},l)}if(i.expression.kind==="camera"){var A=this._calculate(i.expression.evaluate({zoom:l.zoom-1}),i.expression.evaluate({zoom:l.zoom}),i.expression.evaluate({zoom:l.zoom+1}),l);return new bn(this,{kind:"constant",value:A},l)}return new bn(this,i.expression,l)},t.prototype.evaluate=function(i,l,p,m,x,S){if(i.kind==="source"){var I=i.evaluate(l,p,m,x,S);return this._calculate(I,I,I,l)}return i.kind==="composite"?this._calculate(i.evaluate({zoom:Math.floor(l.zoom)-1},p,m),i.evaluate({zoom:Math.floor(l.zoom)},p,m),i.evaluate({zoom:Math.floor(l.zoom)+1},p,m),l):i.value},t.prototype._calculate=function(i,l,p,m){return m.zoom>m.zoomHistory.lastIntegerZoom?{from:i,to:l}:{from:p,to:l}},t.prototype.interpolate=function(i){return i},t}(ut),xn=function(e){this.specification=e};xn.prototype.possiblyEvaluate=function(e,t,i,l){if(e.value!==void 0){if(e.expression.kind==="constant"){var p=e.expression.evaluate(t,null,{},i,l);return this._calculate(p,p,p,t)}return this._calculate(e.expression.evaluate(new ur(Math.floor(t.zoom-1),t)),e.expression.evaluate(new ur(Math.floor(t.zoom),t)),e.expression.evaluate(new ur(Math.floor(t.zoom+1),t)),t)}},xn.prototype._calculate=function(e,t,i,l){return l.zoom>l.zoomHistory.lastIntegerZoom?{from:e,to:t}:{from:i,to:t}},xn.prototype.interpolate=function(e){return e};var _o=function(e){this.specification=e};_o.prototype.possiblyEvaluate=function(e,t,i,l){return!!e.expression.evaluate(t,null,{},i,l)},_o.prototype.interpolate=function(){return!1};var rn=function(e){for(var t in this.properties=e,this.defaultPropertyValues={},this.defaultTransitionablePropertyValues={},this.defaultTransitioningPropertyValues={},this.defaultPossiblyEvaluatedValues={},this.overridableProperties=[],e){var i=e[t];i.specification.overridable&&this.overridableProperties.push(t);var l=this.defaultPropertyValues[t]=new Eo(i,void 0),p=this.defaultTransitionablePropertyValues[t]=new no(i);this.defaultTransitioningPropertyValues[t]=p.untransitioned(),this.defaultPossiblyEvaluatedValues[t]=l.possiblyEvaluate({})}};st("DataDrivenProperty",ut),st("DataConstantProperty",gt),st("CrossFadedDataDrivenProperty",Ys),st("CrossFadedProperty",xn),st("ColorRampProperty",_o);var To=function(e){function t(i,l){if(e.call(this),this.id=i.id,this.type=i.type,this._featureFilter={filter:function(){return!0},needGeometry:!1},i.type!=="custom"&&(this.metadata=(i=i).metadata,this.minzoom=i.minzoom,this.maxzoom=i.maxzoom,i.type!=="background"&&(this.source=i.source,this.sourceLayer=i["source-layer"],this.filter=i.filter),l.layout&&(this._unevaluatedLayout=new yo(l.layout)),l.paint)){for(var p in this._transitionablePaint=new tn(l.paint),i.paint)this.setPaintProperty(p,i.paint[p],{validate:!1});for(var m in i.layout)this.setLayoutProperty(m,i.layout[m],{validate:!1});this._transitioningPaint=this._transitionablePaint.untransitioned(),this.paint=new vs(l.paint)}}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.getCrossfadeParameters=function(){return this._crossfadeParameters},t.prototype.getLayoutProperty=function(i){return i==="visibility"?this.visibility:this._unevaluatedLayout.getValue(i)},t.prototype.setLayoutProperty=function(i,l,p){p===void 0&&(p={}),l!=null&&this._validate(ms,"layers."+this.id+".layout."+i,i,l,p)||(i!=="visibility"?this._unevaluatedLayout.setValue(i,l):this.visibility=l)},t.prototype.getPaintProperty=function(i){return Lt(i,"-transition")?this._transitionablePaint.getTransition(i.slice(0,-11)):this._transitionablePaint.getValue(i)},t.prototype.setPaintProperty=function(i,l,p){if(p===void 0&&(p={}),l!=null&&this._validate(Gh,"layers."+this.id+".paint."+i,i,l,p))return!1;if(Lt(i,"-transition"))return this._transitionablePaint.setTransition(i.slice(0,-11),l||void 0),!1;var m=this._transitionablePaint._values[i],x=m.property.specification["property-type"]==="cross-faded-data-driven",S=m.value.isDataDriven(),I=m.value;this._transitionablePaint.setValue(i,l),this._handleSpecialPaintPropertyUpdate(i);var A=this._transitionablePaint._values[i].value;return A.isDataDriven()||S||x||this._handleOverridablePaintPropertyUpdate(i,I,A)},t.prototype._handleSpecialPaintPropertyUpdate=function(i){},t.prototype._handleOverridablePaintPropertyUpdate=function(i,l,p){return!1},t.prototype.isHidden=function(i){return!!(this.minzoom&&i<this.minzoom)||!!(this.maxzoom&&i>=this.maxzoom)||this.visibility==="none"},t.prototype.updateTransitions=function(i){this._transitioningPaint=this._transitionablePaint.transitioned(i,this._transitioningPaint)},t.prototype.hasTransition=function(){return this._transitioningPaint.hasTransition()},t.prototype.recalculate=function(i,l){i.getCrossfadeParameters&&(this._crossfadeParameters=i.getCrossfadeParameters()),this._unevaluatedLayout&&(this.layout=this._unevaluatedLayout.possiblyEvaluate(i,void 0,l)),this.paint=this._transitioningPaint.possiblyEvaluate(i,void 0,l)},t.prototype.serialize=function(){var i={id:this.id,type:this.type,source:this.source,"source-layer":this.sourceLayer,metadata:this.metadata,minzoom:this.minzoom,maxzoom:this.maxzoom,filter:this.filter,layout:this._unevaluatedLayout&&this._unevaluatedLayout.serialize(),paint:this._transitionablePaint&&this._transitionablePaint.serialize()};return this.visibility&&(i.layout=i.layout||{},i.layout.visibility=this.visibility),_t(i,function(l,p){return!(l===void 0||p==="layout"&&!Object.keys(l).length||p==="paint"&&!Object.keys(l).length)})},t.prototype._validate=function(i,l,p,m,x){return x===void 0&&(x={}),(!x||x.validate!==!1)&&ys(this,i.call(ds,{key:l,layerType:this.type,objectKey:p,value:m,styleSpec:j,style:{glyphs:!0,sprite:!0}}))},t.prototype.is3D=function(){return!1},t.prototype.isTileClipped=function(){return!1},t.prototype.hasOffscreenPass=function(){return!1},t.prototype.resize=function(){},t.prototype.isStateDependent=function(){for(var i in this.paint._values){var l=this.paint.get(i);if(l instanceof bn&&xa(l.property.specification)&&(l.value.kind==="source"||l.value.kind==="composite")&&l.value.isStateDependent)return!0}return!1},t}(pe),$l={Int8:Int8Array,Uint8:Uint8Array,Int16:Int16Array,Uint16:Uint16Array,Int32:Int32Array,Uint32:Uint32Array,Float32:Float32Array},Qs=function(e,t){this._structArray=e,this._pos1=t*this.size,this._pos2=this._pos1/2,this._pos4=this._pos1/4,this._pos8=this._pos1/8},Ar=function(){this.isTransferred=!1,this.capacity=-1,this.resize(0)};function Zi(e,t){t===void 0&&(t=1);var i=0,l=0;return{members:e.map(function(p){var m=$l[p.type].BYTES_PER_ELEMENT,x=i=Ec(i,Math.max(t,m)),S=p.components||1;return l=Math.max(l,m),i+=m*S,{name:p.name,type:p.type,components:S,offset:x}}),size:Ec(i,Math.max(l,t)),alignment:t}}function Ec(e,t){return Math.ceil(e/t)*t}Ar.serialize=function(e,t){return e._trim(),t&&(e.isTransferred=!0,t.push(e.arrayBuffer)),{length:e.length,arrayBuffer:e.arrayBuffer}},Ar.deserialize=function(e){var t=Object.create(this.prototype);return t.arrayBuffer=e.arrayBuffer,t.length=e.length,t.capacity=e.arrayBuffer.byteLength/t.bytesPerElement,t._refreshViews(),t},Ar.prototype._trim=function(){this.length!==this.capacity&&(this.capacity=this.length,this.arrayBuffer=this.arrayBuffer.slice(0,this.length*this.bytesPerElement),this._refreshViews())},Ar.prototype.clear=function(){this.length=0},Ar.prototype.resize=function(e){this.reserve(e),this.length=e},Ar.prototype.reserve=function(e){if(e>this.capacity){this.capacity=Math.max(e,Math.floor(5*this.capacity),128),this.arrayBuffer=new ArrayBuffer(this.capacity*this.bytesPerElement);var t=this.uint8;this._refreshViews(),t&&this.uint8.set(t)}},Ar.prototype._refreshViews=function(){throw new Error("_refreshViews() must be implemented by each concrete StructArray layout")};var Ta=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},t.prototype.emplaceBack=function(i,l){var p=this.length;return this.resize(p+1),this.emplace(p,i,l)},t.prototype.emplace=function(i,l,p){var m=2*i;return this.int16[m+0]=l,this.int16[m+1]=p,i},t}(Ar);Ta.prototype.bytesPerElement=4,st("StructArrayLayout2i4",Ta);var eu=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},t.prototype.emplaceBack=function(i,l,p,m){var x=this.length;return this.resize(x+1),this.emplace(x,i,l,p,m)},t.prototype.emplace=function(i,l,p,m,x){var S=4*i;return this.int16[S+0]=l,this.int16[S+1]=p,this.int16[S+2]=m,this.int16[S+3]=x,i},t}(Ar);eu.prototype.bytesPerElement=8,st("StructArrayLayout4i8",eu);var Lo=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},t.prototype.emplaceBack=function(i,l,p,m,x,S){var I=this.length;return this.resize(I+1),this.emplace(I,i,l,p,m,x,S)},t.prototype.emplace=function(i,l,p,m,x,S,I){var A=6*i;return this.int16[A+0]=l,this.int16[A+1]=p,this.int16[A+2]=m,this.int16[A+3]=x,this.int16[A+4]=S,this.int16[A+5]=I,i},t}(Ar);Lo.prototype.bytesPerElement=12,st("StructArrayLayout2i4i12",Lo);var Zn=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},t.prototype.emplaceBack=function(i,l,p,m,x,S){var I=this.length;return this.resize(I+1),this.emplace(I,i,l,p,m,x,S)},t.prototype.emplace=function(i,l,p,m,x,S,I){var A=4*i,C=8*i;return this.int16[A+0]=l,this.int16[A+1]=p,this.uint8[C+4]=m,this.uint8[C+5]=x,this.uint8[C+6]=S,this.uint8[C+7]=I,i},t}(Ar);Zn.prototype.bytesPerElement=8,st("StructArrayLayout2i4ub8",Zn);var Ga=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},t.prototype.emplaceBack=function(i,l){var p=this.length;return this.resize(p+1),this.emplace(p,i,l)},t.prototype.emplace=function(i,l,p){var m=2*i;return this.float32[m+0]=l,this.float32[m+1]=p,i},t}(Ar);Ga.prototype.bytesPerElement=8,st("StructArrayLayout2f8",Ga);var Io=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},t.prototype.emplaceBack=function(i,l,p,m,x,S,I,A,C,B){var U=this.length;return this.resize(U+1),this.emplace(U,i,l,p,m,x,S,I,A,C,B)},t.prototype.emplace=function(i,l,p,m,x,S,I,A,C,B,U){var q=10*i;return this.uint16[q+0]=l,this.uint16[q+1]=p,this.uint16[q+2]=m,this.uint16[q+3]=x,this.uint16[q+4]=S,this.uint16[q+5]=I,this.uint16[q+6]=A,this.uint16[q+7]=C,this.uint16[q+8]=B,this.uint16[q+9]=U,i},t}(Ar);Io.prototype.bytesPerElement=20,st("StructArrayLayout10ui20",Io);var $s=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},t.prototype.emplaceBack=function(i,l,p,m,x,S,I,A,C,B,U,q){var Q=this.length;return this.resize(Q+1),this.emplace(Q,i,l,p,m,x,S,I,A,C,B,U,q)},t.prototype.emplace=function(i,l,p,m,x,S,I,A,C,B,U,q,Q){var ee=12*i;return this.int16[ee+0]=l,this.int16[ee+1]=p,this.int16[ee+2]=m,this.int16[ee+3]=x,this.uint16[ee+4]=S,this.uint16[ee+5]=I,this.uint16[ee+6]=A,this.uint16[ee+7]=C,this.int16[ee+8]=B,this.int16[ee+9]=U,this.int16[ee+10]=q,this.int16[ee+11]=Q,i},t}(Ar);$s.prototype.bytesPerElement=24,st("StructArrayLayout4i4ui4i24",$s);var Ka=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},t.prototype.emplaceBack=function(i,l,p){var m=this.length;return this.resize(m+1),this.emplace(m,i,l,p)},t.prototype.emplace=function(i,l,p,m){var x=3*i;return this.float32[x+0]=l,this.float32[x+1]=p,this.float32[x+2]=m,i},t}(Ar);Ka.prototype.bytesPerElement=12,st("StructArrayLayout3f12",Ka);var bs=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)},t.prototype.emplaceBack=function(i){var l=this.length;return this.resize(l+1),this.emplace(l,i)},t.prototype.emplace=function(i,l){return this.uint32[1*i+0]=l,i},t}(Ar);bs.prototype.bytesPerElement=4,st("StructArrayLayout1ul4",bs);var tu=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},t.prototype.emplaceBack=function(i,l,p,m,x,S,I,A,C){var B=this.length;return this.resize(B+1),this.emplace(B,i,l,p,m,x,S,I,A,C)},t.prototype.emplace=function(i,l,p,m,x,S,I,A,C,B){var U=10*i,q=5*i;return this.int16[U+0]=l,this.int16[U+1]=p,this.int16[U+2]=m,this.int16[U+3]=x,this.int16[U+4]=S,this.int16[U+5]=I,this.uint32[q+3]=A,this.uint16[U+8]=C,this.uint16[U+9]=B,i},t}(Ar);tu.prototype.bytesPerElement=20,st("StructArrayLayout6i1ul2ui20",tu);var Xa=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},t.prototype.emplaceBack=function(i,l,p,m,x,S){var I=this.length;return this.resize(I+1),this.emplace(I,i,l,p,m,x,S)},t.prototype.emplace=function(i,l,p,m,x,S,I){var A=6*i;return this.int16[A+0]=l,this.int16[A+1]=p,this.int16[A+2]=m,this.int16[A+3]=x,this.int16[A+4]=S,this.int16[A+5]=I,i},t}(Ar);Xa.prototype.bytesPerElement=12,st("StructArrayLayout2i2i2i12",Xa);var Ia=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},t.prototype.emplaceBack=function(i,l,p,m,x){var S=this.length;return this.resize(S+1),this.emplace(S,i,l,p,m,x)},t.prototype.emplace=function(i,l,p,m,x,S){var I=4*i,A=8*i;return this.float32[I+0]=l,this.float32[I+1]=p,this.float32[I+2]=m,this.int16[A+6]=x,this.int16[A+7]=S,i},t}(Ar);Ia.prototype.bytesPerElement=16,st("StructArrayLayout2f1f2i16",Ia);var ru=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},t.prototype.emplaceBack=function(i,l,p,m){var x=this.length;return this.resize(x+1),this.emplace(x,i,l,p,m)},t.prototype.emplace=function(i,l,p,m,x){var S=12*i,I=3*i;return this.uint8[S+0]=l,this.uint8[S+1]=p,this.float32[I+1]=m,this.float32[I+2]=x,i},t}(Ar);ru.prototype.bytesPerElement=12,st("StructArrayLayout2ub2f12",ru);var Yo=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},t.prototype.emplaceBack=function(i,l,p){var m=this.length;return this.resize(m+1),this.emplace(m,i,l,p)},t.prototype.emplace=function(i,l,p,m){var x=3*i;return this.uint16[x+0]=l,this.uint16[x+1]=p,this.uint16[x+2]=m,i},t}(Ar);Yo.prototype.bytesPerElement=6,st("StructArrayLayout3ui6",Yo);var Qo=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},t.prototype.emplaceBack=function(i,l,p,m,x,S,I,A,C,B,U,q,Q,ee,ce,ie,de){var be=this.length;return this.resize(be+1),this.emplace(be,i,l,p,m,x,S,I,A,C,B,U,q,Q,ee,ce,ie,de)},t.prototype.emplace=function(i,l,p,m,x,S,I,A,C,B,U,q,Q,ee,ce,ie,de,be){var ke=24*i,Ie=12*i,Pe=48*i;return this.int16[ke+0]=l,this.int16[ke+1]=p,this.uint16[ke+2]=m,this.uint16[ke+3]=x,this.uint32[Ie+2]=S,this.uint32[Ie+3]=I,this.uint32[Ie+4]=A,this.uint16[ke+10]=C,this.uint16[ke+11]=B,this.uint16[ke+12]=U,this.float32[Ie+7]=q,this.float32[Ie+8]=Q,this.uint8[Pe+36]=ee,this.uint8[Pe+37]=ce,this.uint8[Pe+38]=ie,this.uint32[Ie+10]=de,this.int16[ke+22]=be,i},t}(Ar);Qo.prototype.bytesPerElement=48,st("StructArrayLayout2i2ui3ul3ui2f3ub1ul1i48",Qo);var el=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},t.prototype.emplaceBack=function(i,l,p,m,x,S,I,A,C,B,U,q,Q,ee,ce,ie,de,be,ke,Ie,Pe,Ue,He,ft,tt,bt,it,Yt){var Dt=this.length;return this.resize(Dt+1),this.emplace(Dt,i,l,p,m,x,S,I,A,C,B,U,q,Q,ee,ce,ie,de,be,ke,Ie,Pe,Ue,He,ft,tt,bt,it,Yt)},t.prototype.emplace=function(i,l,p,m,x,S,I,A,C,B,U,q,Q,ee,ce,ie,de,be,ke,Ie,Pe,Ue,He,ft,tt,bt,it,Yt,Dt){var ct=34*i,rr=17*i;return this.int16[ct+0]=l,this.int16[ct+1]=p,this.int16[ct+2]=m,this.int16[ct+3]=x,this.int16[ct+4]=S,this.int16[ct+5]=I,this.int16[ct+6]=A,this.int16[ct+7]=C,this.uint16[ct+8]=B,this.uint16[ct+9]=U,this.uint16[ct+10]=q,this.uint16[ct+11]=Q,this.uint16[ct+12]=ee,this.uint16[ct+13]=ce,this.uint16[ct+14]=ie,this.uint16[ct+15]=de,this.uint16[ct+16]=be,this.uint16[ct+17]=ke,this.uint16[ct+18]=Ie,this.uint16[ct+19]=Pe,this.uint16[ct+20]=Ue,this.uint16[ct+21]=He,this.uint16[ct+22]=ft,this.uint32[rr+12]=tt,this.float32[rr+13]=bt,this.float32[rr+14]=it,this.float32[rr+15]=Yt,this.float32[rr+16]=Dt,i},t}(Ar);el.prototype.bytesPerElement=68,st("StructArrayLayout8i15ui1ul4f68",el);var $o=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},t.prototype.emplaceBack=function(i){var l=this.length;return this.resize(l+1),this.emplace(l,i)},t.prototype.emplace=function(i,l){return this.float32[1*i+0]=l,i},t}(Ar);$o.prototype.bytesPerElement=4,st("StructArrayLayout1f4",$o);var oo=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},t.prototype.emplaceBack=function(i,l,p){var m=this.length;return this.resize(m+1),this.emplace(m,i,l,p)},t.prototype.emplace=function(i,l,p,m){var x=3*i;return this.int16[x+0]=l,this.int16[x+1]=p,this.int16[x+2]=m,i},t}(Ar);oo.prototype.bytesPerElement=6,st("StructArrayLayout3i6",oo);var iu=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},t.prototype.emplaceBack=function(i,l,p){var m=this.length;return this.resize(m+1),this.emplace(m,i,l,p)},t.prototype.emplace=function(i,l,p,m){var x=4*i;return this.uint32[2*i+0]=l,this.uint16[x+2]=p,this.uint16[x+3]=m,i},t}(Ar);iu.prototype.bytesPerElement=8,st("StructArrayLayout1ul2ui8",iu);var xs=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},t.prototype.emplaceBack=function(i,l){var p=this.length;return this.resize(p+1),this.emplace(p,i,l)},t.prototype.emplace=function(i,l,p){var m=2*i;return this.uint16[m+0]=l,this.uint16[m+1]=p,i},t}(Ar);xs.prototype.bytesPerElement=4,st("StructArrayLayout2ui4",xs);var nu=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},t.prototype.emplaceBack=function(i){var l=this.length;return this.resize(l+1),this.emplace(l,i)},t.prototype.emplace=function(i,l){return this.uint16[1*i+0]=l,i},t}(Ar);nu.prototype.bytesPerElement=2,st("StructArrayLayout1ui2",nu);var tl=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},t.prototype.emplaceBack=function(i,l,p,m){var x=this.length;return this.resize(x+1),this.emplace(x,i,l,p,m)},t.prototype.emplace=function(i,l,p,m,x){var S=4*i;return this.float32[S+0]=l,this.float32[S+1]=p,this.float32[S+2]=m,this.float32[S+3]=x,i},t}(Ar);tl.prototype.bytesPerElement=16,st("StructArrayLayout4f16",tl);var n=function(e){function t(){e.apply(this,arguments)}e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t;var i={anchorPointX:{configurable:!0},anchorPointY:{configurable:!0},x1:{configurable:!0},y1:{configurable:!0},x2:{configurable:!0},y2:{configurable:!0},featureIndex:{configurable:!0},sourceLayerIndex:{configurable:!0},bucketIndex:{configurable:!0},anchorPoint:{configurable:!0}};return i.anchorPointX.get=function(){return this._structArray.int16[this._pos2+0]},i.anchorPointY.get=function(){return this._structArray.int16[this._pos2+1]},i.x1.get=function(){return this._structArray.int16[this._pos2+2]},i.y1.get=function(){return this._structArray.int16[this._pos2+3]},i.x2.get=function(){return this._structArray.int16[this._pos2+4]},i.y2.get=function(){return this._structArray.int16[this._pos2+5]},i.featureIndex.get=function(){return this._structArray.uint32[this._pos4+3]},i.sourceLayerIndex.get=function(){return this._structArray.uint16[this._pos2+8]},i.bucketIndex.get=function(){return this._structArray.uint16[this._pos2+9]},i.anchorPoint.get=function(){return new F(this.anchorPointX,this.anchorPointY)},Object.defineProperties(t.prototype,i),t}(Qs);n.prototype.size=20;var s=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.get=function(i){return new n(this,i)},t}(tu);st("CollisionBoxArray",s);var a=function(e){function t(){e.apply(this,arguments)}e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t;var i={anchorX:{configurable:!0},anchorY:{configurable:!0},glyphStartIndex:{configurable:!0},numGlyphs:{configurable:!0},vertexStartIndex:{configurable:!0},lineStartIndex:{configurable:!0},lineLength:{configurable:!0},segment:{configurable:!0},lowerSize:{configurable:!0},upperSize:{configurable:!0},lineOffsetX:{configurable:!0},lineOffsetY:{configurable:!0},writingMode:{configurable:!0},placedOrientation:{configurable:!0},hidden:{configurable:!0},crossTileID:{configurable:!0},associatedIconIndex:{configurable:!0}};return i.anchorX.get=function(){return this._structArray.int16[this._pos2+0]},i.anchorY.get=function(){return this._structArray.int16[this._pos2+1]},i.glyphStartIndex.get=function(){return this._structArray.uint16[this._pos2+2]},i.numGlyphs.get=function(){return this._structArray.uint16[this._pos2+3]},i.vertexStartIndex.get=function(){return this._structArray.uint32[this._pos4+2]},i.lineStartIndex.get=function(){return this._structArray.uint32[this._pos4+3]},i.lineLength.get=function(){return this._structArray.uint32[this._pos4+4]},i.segment.get=function(){return this._structArray.uint16[this._pos2+10]},i.lowerSize.get=function(){return this._structArray.uint16[this._pos2+11]},i.upperSize.get=function(){return this._structArray.uint16[this._pos2+12]},i.lineOffsetX.get=function(){return this._structArray.float32[this._pos4+7]},i.lineOffsetY.get=function(){return this._structArray.float32[this._pos4+8]},i.writingMode.get=function(){return this._structArray.uint8[this._pos1+36]},i.placedOrientation.get=function(){return this._structArray.uint8[this._pos1+37]},i.placedOrientation.set=function(l){this._structArray.uint8[this._pos1+37]=l},i.hidden.get=function(){return this._structArray.uint8[this._pos1+38]},i.hidden.set=function(l){this._structArray.uint8[this._pos1+38]=l},i.crossTileID.get=function(){return this._structArray.uint32[this._pos4+10]},i.crossTileID.set=function(l){this._structArray.uint32[this._pos4+10]=l},i.associatedIconIndex.get=function(){return this._structArray.int16[this._pos2+22]},Object.defineProperties(t.prototype,i),t}(Qs);a.prototype.size=48;var u=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.get=function(i){return new a(this,i)},t}(Qo);st("PlacedSymbolArray",u);var y=function(e){function t(){e.apply(this,arguments)}e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t;var i={anchorX:{configurable:!0},anchorY:{configurable:!0},rightJustifiedTextSymbolIndex:{configurable:!0},centerJustifiedTextSymbolIndex:{configurable:!0},leftJustifiedTextSymbolIndex:{configurable:!0},verticalPlacedTextSymbolIndex:{configurable:!0},placedIconSymbolIndex:{configurable:!0},verticalPlacedIconSymbolIndex:{configurable:!0},key:{configurable:!0},textBoxStartIndex:{configurable:!0},textBoxEndIndex:{configurable:!0},verticalTextBoxStartIndex:{configurable:!0},verticalTextBoxEndIndex:{configurable:!0},iconBoxStartIndex:{configurable:!0},iconBoxEndIndex:{configurable:!0},verticalIconBoxStartIndex:{configurable:!0},verticalIconBoxEndIndex:{configurable:!0},featureIndex:{configurable:!0},numHorizontalGlyphVertices:{configurable:!0},numVerticalGlyphVertices:{configurable:!0},numIconVertices:{configurable:!0},numVerticalIconVertices:{configurable:!0},useRuntimeCollisionCircles:{configurable:!0},crossTileID:{configurable:!0},textBoxScale:{configurable:!0},textOffset0:{configurable:!0},textOffset1:{configurable:!0},collisionCircleDiameter:{configurable:!0}};return i.anchorX.get=function(){return this._structArray.int16[this._pos2+0]},i.anchorY.get=function(){return this._structArray.int16[this._pos2+1]},i.rightJustifiedTextSymbolIndex.get=function(){return this._structArray.int16[this._pos2+2]},i.centerJustifiedTextSymbolIndex.get=function(){return this._structArray.int16[this._pos2+3]},i.leftJustifiedTextSymbolIndex.get=function(){return this._structArray.int16[this._pos2+4]},i.verticalPlacedTextSymbolIndex.get=function(){return this._structArray.int16[this._pos2+5]},i.placedIconSymbolIndex.get=function(){return this._structArray.int16[this._pos2+6]},i.verticalPlacedIconSymbolIndex.get=function(){return this._structArray.int16[this._pos2+7]},i.key.get=function(){return this._structArray.uint16[this._pos2+8]},i.textBoxStartIndex.get=function(){return this._structArray.uint16[this._pos2+9]},i.textBoxEndIndex.get=function(){return this._structArray.uint16[this._pos2+10]},i.verticalTextBoxStartIndex.get=function(){return this._structArray.uint16[this._pos2+11]},i.verticalTextBoxEndIndex.get=function(){return this._structArray.uint16[this._pos2+12]},i.iconBoxStartIndex.get=function(){return this._structArray.uint16[this._pos2+13]},i.iconBoxEndIndex.get=function(){return this._structArray.uint16[this._pos2+14]},i.verticalIconBoxStartIndex.get=function(){return this._structArray.uint16[this._pos2+15]},i.verticalIconBoxEndIndex.get=function(){return this._structArray.uint16[this._pos2+16]},i.featureIndex.get=function(){return this._structArray.uint16[this._pos2+17]},i.numHorizontalGlyphVertices.get=function(){return this._structArray.uint16[this._pos2+18]},i.numVerticalGlyphVertices.get=function(){return this._structArray.uint16[this._pos2+19]},i.numIconVertices.get=function(){return this._structArray.uint16[this._pos2+20]},i.numVerticalIconVertices.get=function(){return this._structArray.uint16[this._pos2+21]},i.useRuntimeCollisionCircles.get=function(){return this._structArray.uint16[this._pos2+22]},i.crossTileID.get=function(){return this._structArray.uint32[this._pos4+12]},i.crossTileID.set=function(l){this._structArray.uint32[this._pos4+12]=l},i.textBoxScale.get=function(){return this._structArray.float32[this._pos4+13]},i.textOffset0.get=function(){return this._structArray.float32[this._pos4+14]},i.textOffset1.get=function(){return this._structArray.float32[this._pos4+15]},i.collisionCircleDiameter.get=function(){return this._structArray.float32[this._pos4+16]},Object.defineProperties(t.prototype,i),t}(Qs);y.prototype.size=68;var w=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.get=function(i){return new y(this,i)},t}(el);st("SymbolInstanceArray",w);var k=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.getoffsetX=function(i){return this.float32[1*i+0]},t}($o);st("GlyphOffsetArray",k);var E=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.getx=function(i){return this.int16[3*i+0]},t.prototype.gety=function(i){return this.int16[3*i+1]},t.prototype.gettileUnitDistanceFromAnchor=function(i){return this.int16[3*i+2]},t}(oo);st("SymbolLineVertexArray",E);var P=function(e){function t(){e.apply(this,arguments)}e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t;var i={featureIndex:{configurable:!0},sourceLayerIndex:{configurable:!0},bucketIndex:{configurable:!0}};return i.featureIndex.get=function(){return this._structArray.uint32[this._pos4+0]},i.sourceLayerIndex.get=function(){return this._structArray.uint16[this._pos2+2]},i.bucketIndex.get=function(){return this._structArray.uint16[this._pos2+3]},Object.defineProperties(t.prototype,i),t}(Qs);P.prototype.size=8;var O=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.get=function(i){return new P(this,i)},t}(iu);st("FeatureIndexArray",O);var Z=Zi([{name:"a_pos",components:2,type:"Int16"}],4).members,G=function(e){e===void 0&&(e=[]),this.segments=e};function K(e,t){return 256*(e=ve(Math.floor(e),0,255))+ve(Math.floor(t),0,255)}G.prototype.prepareSegment=function(e,t,i,l){var p=this.segments[this.segments.length-1];return e>G.MAX_VERTEX_ARRAY_LENGTH&&yt("Max vertices per segment is "+G.MAX_VERTEX_ARRAY_LENGTH+": bucket requested "+e),(!p||p.vertexLength+e>G.MAX_VERTEX_ARRAY_LENGTH||p.sortKey!==l)&&(p={vertexOffset:t.length,primitiveOffset:i.length,vertexLength:0,primitiveLength:0},l!==void 0&&(p.sortKey=l),this.segments.push(p)),p},G.prototype.get=function(){return this.segments},G.prototype.destroy=function(){for(var e=0,t=this.segments;e<t.length;e+=1){var i=t[e];for(var l in i.vaos)i.vaos[l].destroy()}},G.simpleSegment=function(e,t,i,l){return new G([{vertexOffset:e,primitiveOffset:t,vertexLength:i,primitiveLength:l,vaos:{},sortKey:0}])},G.MAX_VERTEX_ARRAY_LENGTH=Math.pow(2,16)-1,st("SegmentVector",G);var re=Zi([{name:"a_pattern_from",components:4,type:"Uint16"},{name:"a_pattern_to",components:4,type:"Uint16"},{name:"a_pixel_ratio_from",components:1,type:"Uint16"},{name:"a_pixel_ratio_to",components:1,type:"Uint16"}]),te=z(function(e){e.exports=function(t,i){var l,p,m,x,S,I,A,C;for(p=t.length-(l=3&t.length),m=i,S=3432918353,I=461845907,C=0;C<p;)A=255&t.charCodeAt(C)|(255&t.charCodeAt(++C))<<8|(255&t.charCodeAt(++C))<<16|(255&t.charCodeAt(++C))<<24,++C,m=27492+(65535&(x=5*(65535&(m=(m^=A=(65535&(A=(A=(65535&A)*S+(((A>>>16)*S&65535)<<16)&4294967295)<<15|A>>>17))*I+(((A>>>16)*I&65535)<<16)&4294967295)<<13|m>>>19))+((5*(m>>>16)&65535)<<16)&4294967295))+((58964+(x>>>16)&65535)<<16);switch(A=0,l){case 3:A^=(255&t.charCodeAt(C+2))<<16;case 2:A^=(255&t.charCodeAt(C+1))<<8;case 1:m^=A=(65535&(A=(A=(65535&(A^=255&t.charCodeAt(C)))*S+(((A>>>16)*S&65535)<<16)&4294967295)<<15|A>>>17))*I+(((A>>>16)*I&65535)<<16)&4294967295}return m^=t.length,m=2246822507*(65535&(m^=m>>>16))+((2246822507*(m>>>16)&65535)<<16)&4294967295,m=3266489909*(65535&(m^=m>>>13))+((3266489909*(m>>>16)&65535)<<16)&4294967295,(m^=m>>>16)>>>0}}),ue=z(function(e){e.exports=function(t,i){for(var l,p=t.length,m=i^p,x=0;p>=4;)l=1540483477*(65535&(l=255&t.charCodeAt(x)|(255&t.charCodeAt(++x))<<8|(255&t.charCodeAt(++x))<<16|(255&t.charCodeAt(++x))<<24))+((1540483477*(l>>>16)&65535)<<16),m=1540483477*(65535&m)+((1540483477*(m>>>16)&65535)<<16)^(l=1540483477*(65535&(l^=l>>>24))+((1540483477*(l>>>16)&65535)<<16)),p-=4,++x;switch(p){case 3:m^=(255&t.charCodeAt(x+2))<<16;case 2:m^=(255&t.charCodeAt(x+1))<<8;case 1:m=1540483477*(65535&(m^=255&t.charCodeAt(x)))+((1540483477*(m>>>16)&65535)<<16)}return m=1540483477*(65535&(m^=m>>>13))+((1540483477*(m>>>16)&65535)<<16),(m^=m>>>15)>>>0}}),Y=te,le=ue;Y.murmur3=te,Y.murmur2=le;var fe=function(){this.ids=[],this.positions=[],this.indexed=!1};fe.prototype.add=function(e,t,i,l){this.ids.push(ze(e)),this.positions.push(t,i,l)},fe.prototype.getPositions=function(e){for(var t=ze(e),i=0,l=this.ids.length-1;i<l;){var p=i+l>>1;this.ids[p]>=t?l=p:i=p+1}for(var m=[];this.ids[i]===t;)m.push({index:this.positions[3*i],start:this.positions[3*i+1],end:this.positions[3*i+2]}),i++;return m},fe.serialize=function(e,t){var i=new Float64Array(e.ids),l=new Uint32Array(e.positions);return function p(m,x,S,I){for(;S<I;){for(var A=m[S+I>>1],C=S-1,B=I+1;;){do C++;while(m[C]<A);do B--;while(m[B]>A);if(C>=B)break;Ee(m,C,B),Ee(x,3*C,3*B),Ee(x,3*C+1,3*B+1),Ee(x,3*C+2,3*B+2)}B-S<I-B?(p(m,x,S,B),S=B+1):(p(m,x,B+1,I),I=B)}}(i,l,0,i.length-1),t&&t.push(i.buffer,l.buffer),{ids:i,positions:l}},fe.deserialize=function(e){var t=new fe;return t.ids=e.ids,t.positions=e.positions,t.indexed=!0,t};var ge=Math.pow(2,53)-1;function ze(e){var t=+e;return!isNaN(t)&&t<=ge?t:Y(String(e))}function Ee(e,t,i){var l=e[t];e[t]=e[i],e[i]=l}st("FeaturePositionMap",fe);var Ae=function(e,t){this.gl=e.gl,this.location=t},De=function(e){function t(i,l){e.call(this,i,l),this.current=0}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.set=function(i){this.current!==i&&(this.current=i,this.gl.uniform1i(this.location,i))},t}(Ae),Ke=function(e){function t(i,l){e.call(this,i,l),this.current=0}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.set=function(i){this.current!==i&&(this.current=i,this.gl.uniform1f(this.location,i))},t}(Ae),Ze=function(e){function t(i,l){e.call(this,i,l),this.current=[0,0]}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.set=function(i){i[0]===this.current[0]&&i[1]===this.current[1]||(this.current=i,this.gl.uniform2f(this.location,i[0],i[1]))},t}(Ae),nt=function(e){function t(i,l){e.call(this,i,l),this.current=[0,0,0]}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.set=function(i){i[0]===this.current[0]&&i[1]===this.current[1]&&i[2]===this.current[2]||(this.current=i,this.gl.uniform3f(this.location,i[0],i[1],i[2]))},t}(Ae),vt=function(e){function t(i,l){e.call(this,i,l),this.current=[0,0,0,0]}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.set=function(i){i[0]===this.current[0]&&i[1]===this.current[1]&&i[2]===this.current[2]&&i[3]===this.current[3]||(this.current=i,this.gl.uniform4f(this.location,i[0],i[1],i[2],i[3]))},t}(Ae),St=function(e){function t(i,l){e.call(this,i,l),this.current=tr.transparent}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.set=function(i){i.r===this.current.r&&i.g===this.current.g&&i.b===this.current.b&&i.a===this.current.a||(this.current=i,this.gl.uniform4f(this.location,i.r,i.g,i.b,i.a))},t}(Ae),wt=new Float32Array(16),_r=function(e){function t(i,l){e.call(this,i,l),this.current=wt}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.set=function(i){if(i[12]!==this.current[12]||i[0]!==this.current[0])return this.current=i,void this.gl.uniformMatrix4fv(this.location,!1,i);for(var l=1;l<16;l++)if(i[l]!==this.current[l]){this.current=i,this.gl.uniformMatrix4fv(this.location,!1,i);break}},t}(Ae);function at(e){return[K(255*e.r,255*e.g),K(255*e.b,255*e.a)]}var Nt=function(e,t,i){this.value=e,this.uniformNames=t.map(function(l){return"u_"+l}),this.type=i};Nt.prototype.setUniform=function(e,t,i){e.set(i.constantOr(this.value))},Nt.prototype.getBinding=function(e,t,i){return this.type==="color"?new St(e,t):new Ke(e,t)};var Jt=function(e,t){this.uniformNames=t.map(function(i){return"u_"+i}),this.patternFrom=null,this.patternTo=null,this.pixelRatioFrom=1,this.pixelRatioTo=1};Jt.prototype.setConstantPatternPositions=function(e,t){this.pixelRatioFrom=t.pixelRatio,this.pixelRatioTo=e.pixelRatio,this.patternFrom=t.tlbr,this.patternTo=e.tlbr},Jt.prototype.setUniform=function(e,t,i,l){var p=l==="u_pattern_to"?this.patternTo:l==="u_pattern_from"?this.patternFrom:l==="u_pixel_ratio_to"?this.pixelRatioTo:l==="u_pixel_ratio_from"?this.pixelRatioFrom:null;p&&e.set(p)},Jt.prototype.getBinding=function(e,t,i){return i.substr(0,9)==="u_pattern"?new vt(e,t):new Ke(e,t)};var Ot=function(e,t,i,l){this.expression=e,this.type=i,this.maxValue=0,this.paintVertexAttributes=t.map(function(p){return{name:"a_"+p,type:"Float32",components:i==="color"?2:1,offset:0}}),this.paintVertexArray=new l};Ot.prototype.populatePaintArray=function(e,t,i,l,p){var m=this.paintVertexArray.length,x=this.expression.evaluate(new ur(0),t,{},l,[],p);this.paintVertexArray.resize(e),this._setPaintValue(m,e,x)},Ot.prototype.updatePaintArray=function(e,t,i,l){var p=this.expression.evaluate({zoom:0},i,l);this._setPaintValue(e,t,p)},Ot.prototype._setPaintValue=function(e,t,i){if(this.type==="color")for(var l=at(i),p=e;p<t;p++)this.paintVertexArray.emplace(p,l[0],l[1]);else{for(var m=e;m<t;m++)this.paintVertexArray.emplace(m,i);this.maxValue=Math.max(this.maxValue,Math.abs(i))}},Ot.prototype.upload=function(e){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=e.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))},Ot.prototype.destroy=function(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()};var Bt=function(e,t,i,l,p,m){this.expression=e,this.uniformNames=t.map(function(x){return"u_"+x+"_t"}),this.type=i,this.useIntegerZoom=l,this.zoom=p,this.maxValue=0,this.paintVertexAttributes=t.map(function(x){return{name:"a_"+x,type:"Float32",components:i==="color"?4:2,offset:0}}),this.paintVertexArray=new m};Bt.prototype.populatePaintArray=function(e,t,i,l,p){var m=this.expression.evaluate(new ur(this.zoom),t,{},l,[],p),x=this.expression.evaluate(new ur(this.zoom+1),t,{},l,[],p),S=this.paintVertexArray.length;this.paintVertexArray.resize(e),this._setPaintValue(S,e,m,x)},Bt.prototype.updatePaintArray=function(e,t,i,l){var p=this.expression.evaluate({zoom:this.zoom},i,l),m=this.expression.evaluate({zoom:this.zoom+1},i,l);this._setPaintValue(e,t,p,m)},Bt.prototype._setPaintValue=function(e,t,i,l){if(this.type==="color")for(var p=at(i),m=at(l),x=e;x<t;x++)this.paintVertexArray.emplace(x,p[0],p[1],m[0],m[1]);else{for(var S=e;S<t;S++)this.paintVertexArray.emplace(S,i,l);this.maxValue=Math.max(this.maxValue,Math.abs(i),Math.abs(l))}},Bt.prototype.upload=function(e){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=e.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))},Bt.prototype.destroy=function(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()},Bt.prototype.setUniform=function(e,t){var i=this.useIntegerZoom?Math.floor(t.zoom):t.zoom,l=ve(this.expression.interpolationFactor(i,this.zoom,this.zoom+1),0,1);e.set(l)},Bt.prototype.getBinding=function(e,t,i){return new Ke(e,t)};var Wt=function(e,t,i,l,p,m){this.expression=e,this.type=t,this.useIntegerZoom=i,this.zoom=l,this.layerId=m,this.zoomInPaintVertexArray=new p,this.zoomOutPaintVertexArray=new p};Wt.prototype.populatePaintArray=function(e,t,i){var l=this.zoomInPaintVertexArray.length;this.zoomInPaintVertexArray.resize(e),this.zoomOutPaintVertexArray.resize(e),this._setPaintValues(l,e,t.patterns&&t.patterns[this.layerId],i)},Wt.prototype.updatePaintArray=function(e,t,i,l,p){this._setPaintValues(e,t,i.patterns&&i.patterns[this.layerId],p)},Wt.prototype._setPaintValues=function(e,t,i,l){if(l&&i){var p=l[i.min],m=l[i.mid],x=l[i.max];if(p&&m&&x)for(var S=e;S<t;S++)this.zoomInPaintVertexArray.emplace(S,m.tl[0],m.tl[1],m.br[0],m.br[1],p.tl[0],p.tl[1],p.br[0],p.br[1],m.pixelRatio,p.pixelRatio),this.zoomOutPaintVertexArray.emplace(S,m.tl[0],m.tl[1],m.br[0],m.br[1],x.tl[0],x.tl[1],x.br[0],x.br[1],m.pixelRatio,x.pixelRatio)}},Wt.prototype.upload=function(e){this.zoomInPaintVertexArray&&this.zoomInPaintVertexArray.arrayBuffer&&this.zoomOutPaintVertexArray&&this.zoomOutPaintVertexArray.arrayBuffer&&(this.zoomInPaintVertexBuffer=e.createVertexBuffer(this.zoomInPaintVertexArray,re.members,this.expression.isStateDependent),this.zoomOutPaintVertexBuffer=e.createVertexBuffer(this.zoomOutPaintVertexArray,re.members,this.expression.isStateDependent))},Wt.prototype.destroy=function(){this.zoomOutPaintVertexBuffer&&this.zoomOutPaintVertexBuffer.destroy(),this.zoomInPaintVertexBuffer&&this.zoomInPaintVertexBuffer.destroy()};var Rt=function(e,t,i){this.binders={},this._buffers=[];var l=[];for(var p in e.paint._values)if(i(p)){var m=e.paint.get(p);if(m instanceof bn&&xa(m.property.specification)){var x=Di(p,e.type),S=m.value,I=m.property.specification.type,A=m.property.useIntegerZoom,C=m.property.specification["property-type"],B=C==="cross-faded"||C==="cross-faded-data-driven";if(S.kind==="constant")this.binders[p]=B?new Jt(S.value,x):new Nt(S.value,x,I),l.push("/u_"+p);else if(S.kind==="source"||B){var U=si(p,I,"source");this.binders[p]=B?new Wt(S,I,A,t,U,e.id):new Ot(S,x,I,U),l.push("/a_"+p)}else{var q=si(p,I,"composite");this.binders[p]=new Bt(S,x,I,A,t,q),l.push("/z_"+p)}}}this.cacheKey=l.sort().join("")};Rt.prototype.getMaxValue=function(e){var t=this.binders[e];return t instanceof Ot||t instanceof Bt?t.maxValue:0},Rt.prototype.populatePaintArrays=function(e,t,i,l,p){for(var m in this.binders){var x=this.binders[m];(x instanceof Ot||x instanceof Bt||x instanceof Wt)&&x.populatePaintArray(e,t,i,l,p)}},Rt.prototype.setConstantPatternPositions=function(e,t){for(var i in this.binders){var l=this.binders[i];l instanceof Jt&&l.setConstantPatternPositions(e,t)}},Rt.prototype.updatePaintArrays=function(e,t,i,l,p){var m=!1;for(var x in e)for(var S=0,I=t.getPositions(x);S<I.length;S+=1){var A=I[S],C=i.feature(A.index);for(var B in this.binders){var U=this.binders[B];if((U instanceof Ot||U instanceof Bt||U instanceof Wt)&&U.expression.isStateDependent===!0){var q=l.paint.get(B);U.expression=q.value,U.updatePaintArray(A.start,A.end,C,e[x],p),m=!0}}}return m},Rt.prototype.defines=function(){var e=[];for(var t in this.binders){var i=this.binders[t];(i instanceof Nt||i instanceof Jt)&&e.push.apply(e,i.uniformNames.map(function(l){return"#define HAS_UNIFORM_"+l}))}return e},Rt.prototype.getBinderAttributes=function(){var e=[];for(var t in this.binders){var i=this.binders[t];if(i instanceof Ot||i instanceof Bt)for(var l=0;l<i.paintVertexAttributes.length;l++)e.push(i.paintVertexAttributes[l].name);else if(i instanceof Wt)for(var p=0;p<re.members.length;p++)e.push(re.members[p].name)}return e},Rt.prototype.getBinderUniforms=function(){var e=[];for(var t in this.binders){var i=this.binders[t];if(i instanceof Nt||i instanceof Jt||i instanceof Bt)for(var l=0,p=i.uniformNames;l<p.length;l+=1)e.push(p[l])}return e},Rt.prototype.getPaintVertexBuffers=function(){return this._buffers},Rt.prototype.getUniforms=function(e,t){var i=[];for(var l in this.binders){var p=this.binders[l];if(p instanceof Nt||p instanceof Jt||p instanceof Bt)for(var m=0,x=p.uniformNames;m<x.length;m+=1){var S=x[m];if(t[S]){var I=p.getBinding(e,t[S],S);i.push({name:S,property:l,binding:I})}}}return i},Rt.prototype.setUniforms=function(e,t,i,l){for(var p=0,m=t;p<m.length;p+=1){var x=m[p],S=x.name,I=x.property;this.binders[I].setUniform(x.binding,l,i.get(I),S)}},Rt.prototype.updatePaintBuffers=function(e){for(var t in this._buffers=[],this.binders){var i=this.binders[t];if(e&&i instanceof Wt){var l=e.fromScale===2?i.zoomInPaintVertexBuffer:i.zoomOutPaintVertexBuffer;l&&this._buffers.push(l)}else(i instanceof Ot||i instanceof Bt)&&i.paintVertexBuffer&&this._buffers.push(i.paintVertexBuffer)}},Rt.prototype.upload=function(e){for(var t in this.binders){var i=this.binders[t];(i instanceof Ot||i instanceof Bt||i instanceof Wt)&&i.upload(e)}this.updatePaintBuffers()},Rt.prototype.destroy=function(){for(var e in this.binders){var t=this.binders[e];(t instanceof Ot||t instanceof Bt||t instanceof Wt)&&t.destroy()}};var Ct=function(e,t,i){i===void 0&&(i=function(){return!0}),this.programConfigurations={};for(var l=0,p=e;l<p.length;l+=1){var m=p[l];this.programConfigurations[m.id]=new Rt(m,t,i)}this.needsUpload=!1,this._featureMap=new fe,this._bufferOffset=0};function Di(e,t){return{"text-opacity":["opacity"],"icon-opacity":["opacity"],"text-color":["fill_color"],"icon-color":["fill_color"],"text-halo-color":["halo_color"],"icon-halo-color":["halo_color"],"text-halo-blur":["halo_blur"],"icon-halo-blur":["halo_blur"],"text-halo-width":["halo_width"],"icon-halo-width":["halo_width"],"line-gap-width":["gapwidth"],"line-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-extrusion-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"]}[e]||[e.replace(t+"-","").replace(/-/g,"_")]}function si(e,t,i){var l={color:{source:Ga,composite:tl},number:{source:$o,composite:Ga}},p=function(m){return{"line-pattern":{source:Io,composite:Io},"fill-pattern":{source:Io,composite:Io},"fill-extrusion-pattern":{source:Io,composite:Io}}[m]}(e);return p&&p[i]||l[t][i]}Ct.prototype.populatePaintArrays=function(e,t,i,l,p,m){for(var x in this.programConfigurations)this.programConfigurations[x].populatePaintArrays(e,t,l,p,m);t.id!==void 0&&this._featureMap.add(t.id,i,this._bufferOffset,e),this._bufferOffset=e,this.needsUpload=!0},Ct.prototype.updatePaintArrays=function(e,t,i,l){for(var p=0,m=i;p<m.length;p+=1){var x=m[p];this.needsUpload=this.programConfigurations[x.id].updatePaintArrays(e,this._featureMap,t,x,l)||this.needsUpload}},Ct.prototype.get=function(e){return this.programConfigurations[e]},Ct.prototype.upload=function(e){if(this.needsUpload){for(var t in this.programConfigurations)this.programConfigurations[t].upload(e);this.needsUpload=!1}},Ct.prototype.destroy=function(){for(var e in this.programConfigurations)this.programConfigurations[e].destroy()},st("ConstantBinder",Nt),st("CrossFadedConstantBinder",Jt),st("SourceExpressionBinder",Ot),st("CrossFadedCompositeBinder",Wt),st("CompositeExpressionBinder",Bt),st("ProgramConfiguration",Rt,{omit:["_buffers"]}),st("ProgramConfigurationSet",Ct);var cn=Math.pow(2,14)-1,Gi=-cn-1;function ri(e){for(var t=8192/e.extent,i=e.loadGeometry(),l=0;l<i.length;l++)for(var p=i[l],m=0;m<p.length;m++){var x=p[m],S=Math.round(x.x*t),I=Math.round(x.y*t);x.x=ve(S,Gi,cn),x.y=ve(I,Gi,cn),(S<x.x||S>x.x+1||I<x.y||I>x.y+1)&&yt("Geometry exceeds allowed extent, reduce your vector tile buffer size")}return i}function fi(e,t){return{type:e.type,id:e.id,properties:e.properties,geometry:t?ri(e):[]}}function Gn(e,t,i,l,p){e.emplaceBack(2*t+(l+1)/2,2*i+(p+1)/2)}var wn=function(e){this.zoom=e.zoom,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map(function(t){return t.id}),this.index=e.index,this.hasPattern=!1,this.layoutVertexArray=new Ta,this.indexArray=new Yo,this.segments=new G,this.programConfigurations=new Ct(e.layers,e.zoom),this.stateDependentLayerIds=this.layers.filter(function(t){return t.isStateDependent()}).map(function(t){return t.id})};function ea(e,t){for(var i=0;i<e.length;i++)if(zo(t,e[i]))return!0;for(var l=0;l<t.length;l++)if(zo(e,t[l]))return!0;return!!ws(e,t)}function An(e,t,i){return!!zo(e,t)||!!ta(t,e,i)}function go(e,t){if(e.length===1)return ks(t,e[0]);for(var i=0;i<t.length;i++)for(var l=t[i],p=0;p<l.length;p++)if(zo(e,l[p]))return!0;for(var m=0;m<e.length;m++)if(ks(t,e[m]))return!0;for(var x=0;x<t.length;x++)if(ws(e,t[x]))return!0;return!1}function ao(e,t,i){if(e.length>1){if(ws(e,t))return!0;for(var l=0;l<t.length;l++)if(ta(t[l],e,i))return!0}for(var p=0;p<e.length;p++)if(ta(e[p],t,i))return!0;return!1}function ws(e,t){if(e.length===0||t.length===0)return!1;for(var i=0;i<e.length-1;i++)for(var l=e[i],p=e[i+1],m=0;m<t.length-1;m++)if(Wa(l,p,t[m],t[m+1]))return!0;return!1}function Wa(e,t,i,l){return zt(e,i,l)!==zt(t,i,l)&&zt(e,t,i)!==zt(e,t,l)}function ta(e,t,i){var l=i*i;if(t.length===1)return e.distSqr(t[0])<l;for(var p=1;p<t.length;p++)if(Ha(e,t[p-1],t[p])<l)return!0;return!1}function Ha(e,t,i){var l=t.distSqr(i);if(l===0)return e.distSqr(t);var p=((e.x-t.x)*(i.x-t.x)+(e.y-t.y)*(i.y-t.y))/l;return e.distSqr(p<0?t:p>1?i:i.sub(t)._mult(p)._add(t))}function ks(e,t){for(var i,l,p,m=!1,x=0;x<e.length;x++)for(var S=0,I=(i=e[x]).length-1;S<i.length;I=S++)(l=i[S]).y>t.y!=(p=i[I]).y>t.y&&t.x<(p.x-l.x)*(t.y-l.y)/(p.y-l.y)+l.x&&(m=!m);return m}function zo(e,t){for(var i=!1,l=0,p=e.length-1;l<e.length;p=l++){var m=e[l],x=e[p];m.y>t.y!=x.y>t.y&&t.x<(x.x-m.x)*(t.y-m.y)/(x.y-m.y)+m.x&&(i=!i)}return i}function Ss(e,t,i){var l=i[0],p=i[2];if(e.x<l.x&&t.x<l.x||e.x>p.x&&t.x>p.x||e.y<l.y&&t.y<l.y||e.y>p.y&&t.y>p.y)return!1;var m=zt(e,t,i[0]);return m!==zt(e,t,i[1])||m!==zt(e,t,i[2])||m!==zt(e,t,i[3])}function Ao(e,t,i){var l=t.paint.get(e).value;return l.kind==="constant"?l.value:i.programConfigurations.get(t.id).getMaxValue(e)}function Li(e){return Math.sqrt(e[0]*e[0]+e[1]*e[1])}function Ro(e,t,i,l,p){if(!t[0]&&!t[1])return e;var m=F.convert(t)._mult(p);i==="viewport"&&m._rotate(-l);for(var x=[],S=0;S<e.length;S++)x.push(e[S].sub(m));return x}wn.prototype.populate=function(e,t,i){var l=this.layers[0],p=[],m=null;l.type==="circle"&&(m=l.layout.get("circle-sort-key"));for(var x=0,S=e;x<S.length;x+=1){var I=S[x],A=I.feature,C=I.id,B=I.index,U=I.sourceLayerIndex,q=this.layers[0]._featureFilter.needGeometry,Q=fi(A,q);if(this.layers[0]._featureFilter.filter(new ur(this.zoom),Q,i)){var ee=m?m.evaluate(Q,{},i):void 0,ce={id:C,properties:A.properties,type:A.type,sourceLayerIndex:U,index:B,geometry:q?Q.geometry:ri(A),patterns:{},sortKey:ee};p.push(ce)}}m&&p.sort(function(He,ft){return He.sortKey-ft.sortKey});for(var ie=0,de=p;ie<de.length;ie+=1){var be=de[ie],ke=be.geometry,Ie=be.index,Pe=be.sourceLayerIndex,Ue=e[Ie].feature;this.addFeature(be,ke,Ie,i),t.featureIndex.insert(Ue,ke,Ie,Pe,this.index)}},wn.prototype.update=function(e,t,i){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(e,t,this.stateDependentLayers,i)},wn.prototype.isEmpty=function(){return this.layoutVertexArray.length===0},wn.prototype.uploadPending=function(){return!this.uploaded||this.programConfigurations.needsUpload},wn.prototype.upload=function(e){this.uploaded||(this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,Z),this.indexBuffer=e.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(e),this.uploaded=!0},wn.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())},wn.prototype.addFeature=function(e,t,i,l){for(var p=0,m=t;p<m.length;p+=1)for(var x=0,S=m[p];x<S.length;x+=1){var I=S[x],A=I.x,C=I.y;if(!(A<0||A>=8192||C<0||C>=8192)){var B=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray,e.sortKey),U=B.vertexLength;Gn(this.layoutVertexArray,A,C,-1,-1),Gn(this.layoutVertexArray,A,C,1,-1),Gn(this.layoutVertexArray,A,C,1,1),Gn(this.layoutVertexArray,A,C,-1,1),this.indexArray.emplaceBack(U,U+1,U+2),this.indexArray.emplaceBack(U,U+3,U+2),B.vertexLength+=4,B.primitiveLength+=2}}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,e,i,{},l)},st("CircleBucket",wn,{omit:["layers"]});var ra=new rn({"circle-sort-key":new ut(j.layout_circle["circle-sort-key"])}),za={paint:new rn({"circle-radius":new ut(j.paint_circle["circle-radius"]),"circle-color":new ut(j.paint_circle["circle-color"]),"circle-blur":new ut(j.paint_circle["circle-blur"]),"circle-opacity":new ut(j.paint_circle["circle-opacity"]),"circle-translate":new gt(j.paint_circle["circle-translate"]),"circle-translate-anchor":new gt(j.paint_circle["circle-translate-anchor"]),"circle-pitch-scale":new gt(j.paint_circle["circle-pitch-scale"]),"circle-pitch-alignment":new gt(j.paint_circle["circle-pitch-alignment"]),"circle-stroke-width":new ut(j.paint_circle["circle-stroke-width"]),"circle-stroke-color":new ut(j.paint_circle["circle-stroke-color"]),"circle-stroke-opacity":new ut(j.paint_circle["circle-stroke-opacity"])}),layout:ra},Er=typeof Float32Array<"u"?Float32Array:Array;function $n(e){return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}function Pn(e,t,i){var l=t[0],p=t[1],m=t[2],x=t[3],S=t[4],I=t[5],A=t[6],C=t[7],B=t[8],U=t[9],q=t[10],Q=t[11],ee=t[12],ce=t[13],ie=t[14],de=t[15],be=i[0],ke=i[1],Ie=i[2],Pe=i[3];return e[0]=be*l+ke*S+Ie*B+Pe*ee,e[1]=be*p+ke*I+Ie*U+Pe*ce,e[2]=be*m+ke*A+Ie*q+Pe*ie,e[3]=be*x+ke*C+Ie*Q+Pe*de,e[4]=(be=i[4])*l+(ke=i[5])*S+(Ie=i[6])*B+(Pe=i[7])*ee,e[5]=be*p+ke*I+Ie*U+Pe*ce,e[6]=be*m+ke*A+Ie*q+Pe*ie,e[7]=be*x+ke*C+Ie*Q+Pe*de,e[8]=(be=i[8])*l+(ke=i[9])*S+(Ie=i[10])*B+(Pe=i[11])*ee,e[9]=be*p+ke*I+Ie*U+Pe*ce,e[10]=be*m+ke*A+Ie*q+Pe*ie,e[11]=be*x+ke*C+Ie*Q+Pe*de,e[12]=(be=i[12])*l+(ke=i[13])*S+(Ie=i[14])*B+(Pe=i[15])*ee,e[13]=be*p+ke*I+Ie*U+Pe*ce,e[14]=be*m+ke*A+Ie*q+Pe*ie,e[15]=be*x+ke*C+Ie*Q+Pe*de,e}Math.hypot||(Math.hypot=function(){for(var e=arguments,t=0,i=arguments.length;i--;)t+=e[i]*e[i];return Math.sqrt(t)});var Aa,Kh=Pn;function rl(e,t,i){var l=t[0],p=t[1],m=t[2],x=t[3];return e[0]=i[0]*l+i[4]*p+i[8]*m+i[12]*x,e[1]=i[1]*l+i[5]*p+i[9]*m+i[13]*x,e[2]=i[2]*l+i[6]*p+i[10]*m+i[14]*x,e[3]=i[3]*l+i[7]*p+i[11]*m+i[15]*x,e}Aa=new Er(3),Er!=Float32Array&&(Aa[0]=0,Aa[1]=0,Aa[2]=0),function(){var e=new Er(4);Er!=Float32Array&&(e[0]=0,e[1]=0,e[2]=0,e[3]=0)}();var Xh=(function(){var e=new Er(2);Er!=Float32Array&&(e[0]=0,e[1]=0)}(),function(e){function t(i){e.call(this,i,za)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.createBucket=function(i){return new wn(i)},t.prototype.queryRadius=function(i){var l=i;return Ao("circle-radius",this,l)+Ao("circle-stroke-width",this,l)+Li(this.paint.get("circle-translate"))},t.prototype.queryIntersectsFeature=function(i,l,p,m,x,S,I,A){for(var C=Ro(i,this.paint.get("circle-translate"),this.paint.get("circle-translate-anchor"),S.angle,I),B=this.paint.get("circle-radius").evaluate(l,p)+this.paint.get("circle-stroke-width").evaluate(l,p),U=this.paint.get("circle-pitch-alignment")==="map",q=U?C:function(Ue,He){return Ue.map(function(ft){return Es(ft,He)})}(C,A),Q=U?B*I:B,ee=0,ce=m;ee<ce.length;ee+=1)for(var ie=0,de=ce[ee];ie<de.length;ie+=1){var be=de[ie],ke=U?be:Es(be,A),Ie=Q,Pe=rl([],[be.x,be.y,0,1],A);if(this.paint.get("circle-pitch-scale")==="viewport"&&this.paint.get("circle-pitch-alignment")==="map"?Ie*=Pe[3]/S.cameraToCenterDistance:this.paint.get("circle-pitch-scale")==="map"&&this.paint.get("circle-pitch-alignment")==="viewport"&&(Ie*=S.cameraToCenterDistance/Pe[3]),An(q,ke,Ie))return!0}return!1},t}(To));function Es(e,t){var i=rl([],[e.x,e.y,0,1],t);return new F(i[0]/i[3],i[1]/i[3])}var Tc=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t}(wn);function Ja(e,t,i,l){var p=t.width,m=t.height;if(l){if(l instanceof Uint8ClampedArray)l=new Uint8Array(l.buffer);else if(l.length!==p*m*i)throw new RangeError("mismatched image size")}else l=new Uint8Array(p*m*i);return e.width=p,e.height=m,e.data=l,e}function il(e,t,i){var l=t.width,p=t.height;if(l!==e.width||p!==e.height){var m=Ja({},{width:l,height:p},i);Wh(e,m,{x:0,y:0},{x:0,y:0},{width:Math.min(e.width,l),height:Math.min(e.height,p)},i),e.width=l,e.height=p,e.data=m.data}}function Wh(e,t,i,l,p,m){if(p.width===0||p.height===0)return t;if(p.width>e.width||p.height>e.height||i.x>e.width-p.width||i.y>e.height-p.height)throw new RangeError("out of range source coordinates for image copy");if(p.width>t.width||p.height>t.height||l.x>t.width-p.width||l.y>t.height-p.height)throw new RangeError("out of range destination coordinates for image copy");for(var x=e.data,S=t.data,I=0;I<p.height;I++)for(var A=((i.y+I)*e.width+i.x)*m,C=((l.y+I)*t.width+l.x)*m,B=0;B<p.width*m;B++)S[C+B]=x[A+B];return t}st("HeatmapBucket",Tc,{omit:["layers"]});var Ts=function(e,t){Ja(this,e,1,t)};Ts.prototype.resize=function(e){il(this,e,1)},Ts.prototype.clone=function(){return new Ts({width:this.width,height:this.height},new Uint8Array(this.data))},Ts.copy=function(e,t,i,l,p){Wh(e,t,i,l,p,1)};var Kn=function(e,t){Ja(this,e,4,t)};Kn.prototype.resize=function(e){il(this,e,4)},Kn.prototype.replace=function(e,t){t?this.data.set(e):this.data=e instanceof Uint8ClampedArray?new Uint8Array(e.buffer):e},Kn.prototype.clone=function(){return new Kn({width:this.width,height:this.height},new Uint8Array(this.data))},Kn.copy=function(e,t,i,l,p){Wh(e,t,i,l,p,4)},st("AlphaImage",Ts),st("RGBAImage",Kn);var _y={paint:new rn({"heatmap-radius":new ut(j.paint_heatmap["heatmap-radius"]),"heatmap-weight":new ut(j.paint_heatmap["heatmap-weight"]),"heatmap-intensity":new gt(j.paint_heatmap["heatmap-intensity"]),"heatmap-color":new _o(j.paint_heatmap["heatmap-color"]),"heatmap-opacity":new gt(j.paint_heatmap["heatmap-opacity"])})};function Wp(e){var t={},i=e.resolution||256,l=e.clips?e.clips.length:1,p=e.image||new Kn({width:i,height:l}),m=function(Q,ee,ce){t[e.evaluationKey]=ce;var ie=e.expression.evaluate(t);p.data[Q+ee+0]=Math.floor(255*ie.r/ie.a),p.data[Q+ee+1]=Math.floor(255*ie.g/ie.a),p.data[Q+ee+2]=Math.floor(255*ie.b/ie.a),p.data[Q+ee+3]=Math.floor(255*ie.a)};if(e.clips)for(var x=0,S=0;x<l;++x,S+=4*i)for(var I=0,A=0;I<i;I++,A+=4){var C=I/(i-1),B=e.clips[x];m(S,A,B.start*(1-C)+B.end*C)}else for(var U=0,q=0;U<i;U++,q+=4)m(0,q,U/(i-1));return p}var gy=function(e){function t(i){e.call(this,i,_y),this._updateColorRamp()}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.createBucket=function(i){return new Tc(i)},t.prototype._handleSpecialPaintPropertyUpdate=function(i){i==="heatmap-color"&&this._updateColorRamp()},t.prototype._updateColorRamp=function(){this.colorRamp=Wp({expression:this._transitionablePaint._values["heatmap-color"].value.expression,evaluationKey:"heatmapDensity",image:this.colorRamp}),this.colorRampTexture=null},t.prototype.resize=function(){this.heatmapFbo&&(this.heatmapFbo.destroy(),this.heatmapFbo=null)},t.prototype.queryRadius=function(){return 0},t.prototype.queryIntersectsFeature=function(){return!1},t.prototype.hasOffscreenPass=function(){return this.paint.get("heatmap-opacity")!==0&&this.visibility!=="none"},t}(To),vy={paint:new rn({"hillshade-illumination-direction":new gt(j.paint_hillshade["hillshade-illumination-direction"]),"hillshade-illumination-anchor":new gt(j.paint_hillshade["hillshade-illumination-anchor"]),"hillshade-exaggeration":new gt(j.paint_hillshade["hillshade-exaggeration"]),"hillshade-shadow-color":new gt(j.paint_hillshade["hillshade-shadow-color"]),"hillshade-highlight-color":new gt(j.paint_hillshade["hillshade-highlight-color"]),"hillshade-accent-color":new gt(j.paint_hillshade["hillshade-accent-color"])})},by=function(e){function t(i){e.call(this,i,vy)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.hasOffscreenPass=function(){return this.paint.get("hillshade-exaggeration")!==0&&this.visibility!=="none"},t}(To),xy=Zi([{name:"a_pos",components:2,type:"Int16"}],4).members,Hh=Ic,wy=Ic;function Ic(e,t,i){i=i||2;var l,p,m,x,S,I,A,C=t&&t.length,B=C?t[0]*i:e.length,U=Hp(e,0,B,i,!0),q=[];if(!U||U.next===U.prev)return q;if(C&&(U=function(ee,ce,ie,de){var be,ke,Ie,Pe=[];for(be=0,ke=ce.length;be<ke;be++)(Ie=Hp(ee,ce[be]*de,be<ke-1?ce[be+1]*de:ee.length,de,!1))===Ie.next&&(Ie.steiner=!0),Pe.push(Py(Ie));for(Pe.sort(Iy),be=0;be<Pe.length;be++)zy(Pe[be],ie),ie=Ya(ie,ie.next);return ie}(e,t,U,i)),e.length>80*i){l=m=e[0],p=x=e[1];for(var Q=i;Q<B;Q+=i)(S=e[Q])<l&&(l=S),(I=e[Q+1])<p&&(p=I),S>m&&(m=S),I>x&&(x=I);A=(A=Math.max(m-l,x-p))!==0?1/A:0}return ou(U,q,i,l,p,A),q}function Hp(e,t,i,l,p){var m,x;if(p===Qh(e,t,i,l)>0)for(m=t;m<i;m+=l)x=Qp(m,e[m],e[m+1],x);else for(m=i-l;m>=t;m-=l)x=Qp(m,e[m],e[m+1],x);return x&&zc(x,x.next)&&(su(x),x=x.next),x}function Ya(e,t){if(!e)return e;t||(t=e);var i,l=e;do if(i=!1,l.steiner||!zc(l,l.next)&&Ii(l.prev,l,l.next)!==0)l=l.next;else{if(su(l),(l=t=l.prev)===l.next)break;i=!0}while(i||l!==t);return t}function ou(e,t,i,l,p,m,x){if(e){!x&&m&&function(C,B,U,q){var Q=C;do Q.z===null&&(Q.z=Jh(Q.x,Q.y,B,U,q)),Q.prevZ=Q.prev,Q.nextZ=Q.next,Q=Q.next;while(Q!==C);Q.prevZ.nextZ=null,Q.prevZ=null,function(ee){var ce,ie,de,be,ke,Ie,Pe,Ue,He=1;do{for(ie=ee,ee=null,ke=null,Ie=0;ie;){for(Ie++,de=ie,Pe=0,ce=0;ce<He&&(Pe++,de=de.nextZ);ce++);for(Ue=He;Pe>0||Ue>0&&de;)Pe!==0&&(Ue===0||!de||ie.z<=de.z)?(be=ie,ie=ie.nextZ,Pe--):(be=de,de=de.nextZ,Ue--),ke?ke.nextZ=be:ee=be,be.prevZ=ke,ke=be;ie=de}ke.nextZ=null,He*=2}while(Ie>1)}(Q)}(e,l,p,m);for(var S,I,A=e;e.prev!==e.next;)if(S=e.prev,I=e.next,m?Sy(e,l,p,m):ky(e))t.push(S.i/i),t.push(e.i/i),t.push(I.i/i),su(e),e=I.next,A=I.next;else if((e=I)===A){x?x===1?ou(e=Ey(Ya(e),t,i),t,i,l,p,m,2):x===2&&Ty(e,t,i,l,p,m):ou(Ya(e),t,i,l,p,m,1);break}}}function ky(e){var t=e.prev,i=e,l=e.next;if(Ii(t,i,l)>=0)return!1;for(var p=e.next.next;p!==e.prev;){if(nl(t.x,t.y,i.x,i.y,l.x,l.y,p.x,p.y)&&Ii(p.prev,p,p.next)>=0)return!1;p=p.next}return!0}function Sy(e,t,i,l){var p=e.prev,m=e,x=e.next;if(Ii(p,m,x)>=0)return!1;for(var S=p.x>m.x?p.x>x.x?p.x:x.x:m.x>x.x?m.x:x.x,I=p.y>m.y?p.y>x.y?p.y:x.y:m.y>x.y?m.y:x.y,A=Jh(p.x<m.x?p.x<x.x?p.x:x.x:m.x<x.x?m.x:x.x,p.y<m.y?p.y<x.y?p.y:x.y:m.y<x.y?m.y:x.y,t,i,l),C=Jh(S,I,t,i,l),B=e.prevZ,U=e.nextZ;B&&B.z>=A&&U&&U.z<=C;){if(B!==e.prev&&B!==e.next&&nl(p.x,p.y,m.x,m.y,x.x,x.y,B.x,B.y)&&Ii(B.prev,B,B.next)>=0||(B=B.prevZ,U!==e.prev&&U!==e.next&&nl(p.x,p.y,m.x,m.y,x.x,x.y,U.x,U.y)&&Ii(U.prev,U,U.next)>=0))return!1;U=U.nextZ}for(;B&&B.z>=A;){if(B!==e.prev&&B!==e.next&&nl(p.x,p.y,m.x,m.y,x.x,x.y,B.x,B.y)&&Ii(B.prev,B,B.next)>=0)return!1;B=B.prevZ}for(;U&&U.z<=C;){if(U!==e.prev&&U!==e.next&&nl(p.x,p.y,m.x,m.y,x.x,x.y,U.x,U.y)&&Ii(U.prev,U,U.next)>=0)return!1;U=U.nextZ}return!0}function Ey(e,t,i){var l=e;do{var p=l.prev,m=l.next.next;!zc(p,m)&&Jp(p,l,l.next,m)&&au(p,m)&&au(m,p)&&(t.push(p.i/i),t.push(l.i/i),t.push(m.i/i),su(l),su(l.next),l=e=m),l=l.next}while(l!==e);return Ya(l)}function Ty(e,t,i,l,p,m){var x=e;do{for(var S=x.next.next;S!==x.prev;){if(x.i!==S.i&&Cy(x,S)){var I=Yp(x,S);return x=Ya(x,x.next),I=Ya(I,I.next),ou(x,t,i,l,p,m),void ou(I,t,i,l,p,m)}S=S.next}x=x.next}while(x!==e)}function Iy(e,t){return e.x-t.x}function zy(e,t){if(t=function(l,p){var m,x=p,S=l.x,I=l.y,A=-1/0;do{if(I<=x.y&&I>=x.next.y&&x.next.y!==x.y){var C=x.x+(I-x.y)*(x.next.x-x.x)/(x.next.y-x.y);if(C<=S&&C>A){if(A=C,C===S){if(I===x.y)return x;if(I===x.next.y)return x.next}m=x.x<x.next.x?x:x.next}}x=x.next}while(x!==p);if(!m)return null;if(S===A)return m;var B,U=m,q=m.x,Q=m.y,ee=1/0;x=m;do S>=x.x&&x.x>=q&&S!==x.x&&nl(I<Q?S:A,I,q,Q,I<Q?A:S,I,x.x,x.y)&&(B=Math.abs(I-x.y)/(S-x.x),au(x,l)&&(B<ee||B===ee&&(x.x>m.x||x.x===m.x&&Ay(m,x)))&&(m=x,ee=B)),x=x.next;while(x!==U);return m}(e,t)){var i=Yp(t,e);Ya(t,t.next),Ya(i,i.next)}}function Ay(e,t){return Ii(e.prev,e,t.prev)<0&&Ii(t.next,e,e.next)<0}function Jh(e,t,i,l,p){return(e=1431655765&((e=858993459&((e=252645135&((e=16711935&((e=32767*(e-i)*p)|e<<8))|e<<4))|e<<2))|e<<1))|(t=1431655765&((t=858993459&((t=252645135&((t=16711935&((t=32767*(t-l)*p)|t<<8))|t<<4))|t<<2))|t<<1))<<1}function Py(e){var t=e,i=e;do(t.x<i.x||t.x===i.x&&t.y<i.y)&&(i=t),t=t.next;while(t!==e);return i}function nl(e,t,i,l,p,m,x,S){return(p-x)*(t-S)-(e-x)*(m-S)>=0&&(e-x)*(l-S)-(i-x)*(t-S)>=0&&(i-x)*(m-S)-(p-x)*(l-S)>=0}function Cy(e,t){return e.next.i!==t.i&&e.prev.i!==t.i&&!function(i,l){var p=i;do{if(p.i!==i.i&&p.next.i!==i.i&&p.i!==l.i&&p.next.i!==l.i&&Jp(p,p.next,i,l))return!0;p=p.next}while(p!==i);return!1}(e,t)&&(au(e,t)&&au(t,e)&&function(i,l){var p=i,m=!1,x=(i.x+l.x)/2,S=(i.y+l.y)/2;do p.y>S!=p.next.y>S&&p.next.y!==p.y&&x<(p.next.x-p.x)*(S-p.y)/(p.next.y-p.y)+p.x&&(m=!m),p=p.next;while(p!==i);return m}(e,t)&&(Ii(e.prev,e,t.prev)||Ii(e,t.prev,t))||zc(e,t)&&Ii(e.prev,e,e.next)>0&&Ii(t.prev,t,t.next)>0)}function Ii(e,t,i){return(t.y-e.y)*(i.x-t.x)-(t.x-e.x)*(i.y-t.y)}function zc(e,t){return e.x===t.x&&e.y===t.y}function Jp(e,t,i,l){var p=Pc(Ii(e,t,i)),m=Pc(Ii(e,t,l)),x=Pc(Ii(i,l,e)),S=Pc(Ii(i,l,t));return p!==m&&x!==S||!(p!==0||!Ac(e,i,t))||!(m!==0||!Ac(e,l,t))||!(x!==0||!Ac(i,e,l))||!(S!==0||!Ac(i,t,l))}function Ac(e,t,i){return t.x<=Math.max(e.x,i.x)&&t.x>=Math.min(e.x,i.x)&&t.y<=Math.max(e.y,i.y)&&t.y>=Math.min(e.y,i.y)}function Pc(e){return e>0?1:e<0?-1:0}function au(e,t){return Ii(e.prev,e,e.next)<0?Ii(e,t,e.next)>=0&&Ii(e,e.prev,t)>=0:Ii(e,t,e.prev)<0||Ii(e,e.next,t)<0}function Yp(e,t){var i=new Yh(e.i,e.x,e.y),l=new Yh(t.i,t.x,t.y),p=e.next,m=t.prev;return e.next=t,t.prev=e,i.next=p,p.prev=i,l.next=i,i.prev=l,m.next=l,l.prev=m,l}function Qp(e,t,i,l){var p=new Yh(e,t,i);return l?(p.next=l.next,p.prev=l,l.next.prev=p,l.next=p):(p.prev=p,p.next=p),p}function su(e){e.next.prev=e.prev,e.prev.next=e.next,e.prevZ&&(e.prevZ.nextZ=e.nextZ),e.nextZ&&(e.nextZ.prevZ=e.prevZ)}function Yh(e,t,i){this.i=e,this.x=t,this.y=i,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}function Qh(e,t,i,l){for(var p=0,m=t,x=i-l;m<i;m+=l)p+=(e[x]-e[m])*(e[m+1]+e[x+1]),x=m;return p}function My(e,t,i,l,p){(function m(x,S,I,A,C){for(;A>I;){if(A-I>600){var B=A-I+1,U=S-I+1,q=Math.log(B),Q=.5*Math.exp(2*q/3),ee=.5*Math.sqrt(q*Q*(B-Q)/B)*(U-B/2<0?-1:1);m(x,S,Math.max(I,Math.floor(S-U*Q/B+ee)),Math.min(A,Math.floor(S+(B-U)*Q/B+ee)),C)}var ce=x[S],ie=I,de=A;for(lu(x,I,S),C(x[A],ce)>0&&lu(x,I,A);ie<de;){for(lu(x,ie,de),ie++,de--;C(x[ie],ce)<0;)ie++;for(;C(x[de],ce)>0;)de--}C(x[I],ce)===0?lu(x,I,de):lu(x,++de,A),de<=S&&(I=de+1),S<=de&&(A=de-1)}})(e,t,i||0,l||e.length-1,p||Dy)}function lu(e,t,i){var l=e[t];e[t]=e[i],e[i]=l}function Dy(e,t){return e<t?-1:e>t?1:0}function $h(e,t){var i=e.length;if(i<=1)return[e];for(var l,p,m=[],x=0;x<i;x++){var S=et(e[x]);S!==0&&(e[x].area=Math.abs(S),p===void 0&&(p=S<0),p===S<0?(l&&m.push(l),l=[e[x]]):l.push(e[x]))}if(l&&m.push(l),t>1)for(var I=0;I<m.length;I++)m[I].length<=t||(My(m[I],t,1,m[I].length-1,Ly),m[I]=m[I].slice(0,t));return m}function Ly(e,t){return t.area-e.area}function ep(e,t,i){for(var l=i.patternDependencies,p=!1,m=0,x=t;m<x.length;m+=1){var S=x[m].paint.get(e+"-pattern");S.isConstant()||(p=!0);var I=S.constantOr(null);I&&(p=!0,l[I.to]=!0,l[I.from]=!0)}return p}function tp(e,t,i,l,p){for(var m=p.patternDependencies,x=0,S=t;x<S.length;x+=1){var I=S[x],A=I.paint.get(e+"-pattern").value;if(A.kind!=="constant"){var C=A.evaluate({zoom:l-1},i,{},p.availableImages),B=A.evaluate({zoom:l},i,{},p.availableImages),U=A.evaluate({zoom:l+1},i,{},p.availableImages);B=B&&B.name?B.name:B,U=U&&U.name?U.name:U,m[C=C&&C.name?C.name:C]=!0,m[B]=!0,m[U]=!0,i.patterns[I.id]={min:C,mid:B,max:U}}}return i}Ic.deviation=function(e,t,i,l){var p=t&&t.length,m=Math.abs(Qh(e,0,p?t[0]*i:e.length,i));if(p)for(var x=0,S=t.length;x<S;x++)m-=Math.abs(Qh(e,t[x]*i,x<S-1?t[x+1]*i:e.length,i));var I=0;for(x=0;x<l.length;x+=3){var A=l[x]*i,C=l[x+1]*i,B=l[x+2]*i;I+=Math.abs((e[A]-e[B])*(e[C+1]-e[A+1])-(e[A]-e[C])*(e[B+1]-e[A+1]))}return m===0&&I===0?0:Math.abs((I-m)/m)},Ic.flatten=function(e){for(var t=e[0][0].length,i={vertices:[],holes:[],dimensions:t},l=0,p=0;p<e.length;p++){for(var m=0;m<e[p].length;m++)for(var x=0;x<t;x++)i.vertices.push(e[p][m][x]);p>0&&i.holes.push(l+=e[p-1].length)}return i},Hh.default=wy;var Bo=function(e){this.zoom=e.zoom,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map(function(t){return t.id}),this.index=e.index,this.hasPattern=!1,this.patternFeatures=[],this.layoutVertexArray=new Ta,this.indexArray=new Yo,this.indexArray2=new xs,this.programConfigurations=new Ct(e.layers,e.zoom),this.segments=new G,this.segments2=new G,this.stateDependentLayerIds=this.layers.filter(function(t){return t.isStateDependent()}).map(function(t){return t.id})};Bo.prototype.populate=function(e,t,i){this.hasPattern=ep("fill",this.layers,t);for(var l=this.layers[0].layout.get("fill-sort-key"),p=[],m=0,x=e;m<x.length;m+=1){var S=x[m],I=S.feature,A=S.id,C=S.index,B=S.sourceLayerIndex,U=this.layers[0]._featureFilter.needGeometry,q=fi(I,U);if(this.layers[0]._featureFilter.filter(new ur(this.zoom),q,i)){var Q=l?l.evaluate(q,{},i,t.availableImages):void 0,ee={id:A,properties:I.properties,type:I.type,sourceLayerIndex:B,index:C,geometry:U?q.geometry:ri(I),patterns:{},sortKey:Q};p.push(ee)}}l&&p.sort(function(Ue,He){return Ue.sortKey-He.sortKey});for(var ce=0,ie=p;ce<ie.length;ce+=1){var de=ie[ce],be=de.geometry,ke=de.index,Ie=de.sourceLayerIndex;if(this.hasPattern){var Pe=tp("fill",this.layers,de,this.zoom,t);this.patternFeatures.push(Pe)}else this.addFeature(de,be,ke,i,{});t.featureIndex.insert(e[ke].feature,be,ke,Ie,this.index)}},Bo.prototype.update=function(e,t,i){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(e,t,this.stateDependentLayers,i)},Bo.prototype.addFeatures=function(e,t,i){for(var l=0,p=this.patternFeatures;l<p.length;l+=1){var m=p[l];this.addFeature(m,m.geometry,m.index,t,i)}},Bo.prototype.isEmpty=function(){return this.layoutVertexArray.length===0},Bo.prototype.uploadPending=function(){return!this.uploaded||this.programConfigurations.needsUpload},Bo.prototype.upload=function(e){this.uploaded||(this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,xy),this.indexBuffer=e.createIndexBuffer(this.indexArray),this.indexBuffer2=e.createIndexBuffer(this.indexArray2)),this.programConfigurations.upload(e),this.uploaded=!0},Bo.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.indexBuffer2.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.segments2.destroy())},Bo.prototype.addFeature=function(e,t,i,l,p){for(var m=0,x=$h(t,500);m<x.length;m+=1){for(var S=x[m],I=0,A=0,C=S;A<C.length;A+=1)I+=C[A].length;for(var B=this.segments.prepareSegment(I,this.layoutVertexArray,this.indexArray),U=B.vertexLength,q=[],Q=[],ee=0,ce=S;ee<ce.length;ee+=1){var ie=ce[ee];if(ie.length!==0){ie!==S[0]&&Q.push(q.length/2);var de=this.segments2.prepareSegment(ie.length,this.layoutVertexArray,this.indexArray2),be=de.vertexLength;this.layoutVertexArray.emplaceBack(ie[0].x,ie[0].y),this.indexArray2.emplaceBack(be+ie.length-1,be),q.push(ie[0].x),q.push(ie[0].y);for(var ke=1;ke<ie.length;ke++)this.layoutVertexArray.emplaceBack(ie[ke].x,ie[ke].y),this.indexArray2.emplaceBack(be+ke-1,be+ke),q.push(ie[ke].x),q.push(ie[ke].y);de.vertexLength+=ie.length,de.primitiveLength+=ie.length}}for(var Ie=Hh(q,Q),Pe=0;Pe<Ie.length;Pe+=3)this.indexArray.emplaceBack(U+Ie[Pe],U+Ie[Pe+1],U+Ie[Pe+2]);B.vertexLength+=I,B.primitiveLength+=Ie.length/3}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,e,i,p,l)},st("FillBucket",Bo,{omit:["layers","patternFeatures"]});var Ry=new rn({"fill-sort-key":new ut(j.layout_fill["fill-sort-key"])}),By={paint:new rn({"fill-antialias":new gt(j.paint_fill["fill-antialias"]),"fill-opacity":new ut(j.paint_fill["fill-opacity"]),"fill-color":new ut(j.paint_fill["fill-color"]),"fill-outline-color":new ut(j.paint_fill["fill-outline-color"]),"fill-translate":new gt(j.paint_fill["fill-translate"]),"fill-translate-anchor":new gt(j.paint_fill["fill-translate-anchor"]),"fill-pattern":new Ys(j.paint_fill["fill-pattern"])}),layout:Ry},Oy=function(e){function t(i){e.call(this,i,By)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.recalculate=function(i,l){e.prototype.recalculate.call(this,i,l);var p=this.paint._values["fill-outline-color"];p.value.kind==="constant"&&p.value.value===void 0&&(this.paint._values["fill-outline-color"]=this.paint._values["fill-color"])},t.prototype.createBucket=function(i){return new Bo(i)},t.prototype.queryRadius=function(){return Li(this.paint.get("fill-translate"))},t.prototype.queryIntersectsFeature=function(i,l,p,m,x,S,I){return go(Ro(i,this.paint.get("fill-translate"),this.paint.get("fill-translate-anchor"),S.angle,I),m)},t.prototype.isTileClipped=function(){return!0},t}(To),Fy=Zi([{name:"a_pos",components:2,type:"Int16"},{name:"a_normal_ed",components:4,type:"Int16"}],4).members,$p=ol;function ol(e,t,i,l,p){this.properties={},this.extent=i,this.type=0,this._pbf=e,this._geometry=-1,this._keys=l,this._values=p,e.readFields(Ny,this,t)}function Ny(e,t,i){e==1?t.id=i.readVarint():e==2?function(l,p){for(var m=l.readVarint()+l.pos;l.pos<m;){var x=p._keys[l.readVarint()],S=p._values[l.readVarint()];p.properties[x]=S}}(i,t):e==3?t.type=i.readVarint():e==4&&(t._geometry=i.pos)}function Uy(e){for(var t,i,l=0,p=0,m=e.length,x=m-1;p<m;x=p++)l+=((i=e[x]).x-(t=e[p]).x)*(t.y+i.y);return l}ol.types=["Unknown","Point","LineString","Polygon"],ol.prototype.loadGeometry=function(){var e=this._pbf;e.pos=this._geometry;for(var t,i=e.readVarint()+e.pos,l=1,p=0,m=0,x=0,S=[];e.pos<i;){if(p<=0){var I=e.readVarint();l=7&I,p=I>>3}if(p--,l===1||l===2)m+=e.readSVarint(),x+=e.readSVarint(),l===1&&(t&&S.push(t),t=[]),t.push(new F(m,x));else{if(l!==7)throw new Error("unknown command "+l);t&&t.push(t[0].clone())}}return t&&S.push(t),S},ol.prototype.bbox=function(){var e=this._pbf;e.pos=this._geometry;for(var t=e.readVarint()+e.pos,i=1,l=0,p=0,m=0,x=1/0,S=-1/0,I=1/0,A=-1/0;e.pos<t;){if(l<=0){var C=e.readVarint();i=7&C,l=C>>3}if(l--,i===1||i===2)(p+=e.readSVarint())<x&&(x=p),p>S&&(S=p),(m+=e.readSVarint())<I&&(I=m),m>A&&(A=m);else if(i!==7)throw new Error("unknown command "+i)}return[x,I,S,A]},ol.prototype.toGeoJSON=function(e,t,i){var l,p,m=this.extent*Math.pow(2,i),x=this.extent*e,S=this.extent*t,I=this.loadGeometry(),A=ol.types[this.type];function C(q){for(var Q=0;Q<q.length;Q++){var ee=q[Q];q[Q]=[360*(ee.x+x)/m-180,360/Math.PI*Math.atan(Math.exp((180-360*(ee.y+S)/m)*Math.PI/180))-90]}}switch(this.type){case 1:var B=[];for(l=0;l<I.length;l++)B[l]=I[l][0];C(I=B);break;case 2:for(l=0;l<I.length;l++)C(I[l]);break;case 3:for(I=function(q){var Q=q.length;if(Q<=1)return[q];for(var ee,ce,ie=[],de=0;de<Q;de++){var be=Uy(q[de]);be!==0&&(ce===void 0&&(ce=be<0),ce===be<0?(ee&&ie.push(ee),ee=[q[de]]):ee.push(q[de]))}return ee&&ie.push(ee),ie}(I),l=0;l<I.length;l++)for(p=0;p<I[l].length;p++)C(I[l][p])}I.length===1?I=I[0]:A="Multi"+A;var U={type:"Feature",geometry:{type:A,coordinates:I},properties:this.properties};return"id"in this&&(U.id=this.id),U};var ef=tf;function tf(e,t){this.version=1,this.name=null,this.extent=4096,this.length=0,this._pbf=e,this._keys=[],this._values=[],this._features=[],e.readFields(Vy,this,t),this.length=this._features.length}function Vy(e,t,i){e===15?t.version=i.readVarint():e===1?t.name=i.readString():e===5?t.extent=i.readVarint():e===2?t._features.push(i.pos):e===3?t._keys.push(i.readString()):e===4&&t._values.push(function(l){for(var p=null,m=l.readVarint()+l.pos;l.pos<m;){var x=l.readVarint()>>3;p=x===1?l.readString():x===2?l.readFloat():x===3?l.readDouble():x===4?l.readVarint64():x===5?l.readVarint():x===6?l.readSVarint():x===7?l.readBoolean():null}return p}(i))}function jy(e,t,i){if(e===3){var l=new ef(i,i.readVarint()+i.pos);l.length&&(t[l.name]=l)}}tf.prototype.feature=function(e){if(e<0||e>=this._features.length)throw new Error("feature index out of bounds");this._pbf.pos=this._features[e];var t=this._pbf.readVarint()+this._pbf.pos;return new $p(this._pbf,t,this.extent,this._keys,this._values)};var al={VectorTile:function(e,t){this.layers=e.readFields(jy,{},t)},VectorTileFeature:$p,VectorTileLayer:ef},qy=al.VectorTileFeature.types,rp=Math.pow(2,13);function uu(e,t,i,l,p,m,x,S){e.emplaceBack(t,i,2*Math.floor(l*rp)+x,p*rp*2,m*rp*2,Math.round(S))}var Oo=function(e){this.zoom=e.zoom,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map(function(t){return t.id}),this.index=e.index,this.hasPattern=!1,this.layoutVertexArray=new Lo,this.indexArray=new Yo,this.programConfigurations=new Ct(e.layers,e.zoom),this.segments=new G,this.stateDependentLayerIds=this.layers.filter(function(t){return t.isStateDependent()}).map(function(t){return t.id})};function Zy(e,t){return e.x===t.x&&(e.x<0||e.x>8192)||e.y===t.y&&(e.y<0||e.y>8192)}Oo.prototype.populate=function(e,t,i){this.features=[],this.hasPattern=ep("fill-extrusion",this.layers,t);for(var l=0,p=e;l<p.length;l+=1){var m=p[l],x=m.feature,S=m.id,I=m.index,A=m.sourceLayerIndex,C=this.layers[0]._featureFilter.needGeometry,B=fi(x,C);if(this.layers[0]._featureFilter.filter(new ur(this.zoom),B,i)){var U={id:S,sourceLayerIndex:A,index:I,geometry:C?B.geometry:ri(x),properties:x.properties,type:x.type,patterns:{}};this.hasPattern?this.features.push(tp("fill-extrusion",this.layers,U,this.zoom,t)):this.addFeature(U,U.geometry,I,i,{}),t.featureIndex.insert(x,U.geometry,I,A,this.index,!0)}}},Oo.prototype.addFeatures=function(e,t,i){for(var l=0,p=this.features;l<p.length;l+=1){var m=p[l];this.addFeature(m,m.geometry,m.index,t,i)}},Oo.prototype.update=function(e,t,i){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(e,t,this.stateDependentLayers,i)},Oo.prototype.isEmpty=function(){return this.layoutVertexArray.length===0},Oo.prototype.uploadPending=function(){return!this.uploaded||this.programConfigurations.needsUpload},Oo.prototype.upload=function(e){this.uploaded||(this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,Fy),this.indexBuffer=e.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(e),this.uploaded=!0},Oo.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())},Oo.prototype.addFeature=function(e,t,i,l,p){for(var m=0,x=$h(t,500);m<x.length;m+=1){for(var S=x[m],I=0,A=0,C=S;A<C.length;A+=1)I+=C[A].length;for(var B=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray),U=0,q=S;U<q.length;U+=1){var Q=q[U];if(Q.length!==0&&!((rr=Q).every(function(Kt){return Kt.x<0})||rr.every(function(Kt){return Kt.x>8192})||rr.every(function(Kt){return Kt.y<0})||rr.every(function(Kt){return Kt.y>8192})))for(var ee=0,ce=0;ce<Q.length;ce++){var ie=Q[ce];if(ce>=1){var de=Q[ce-1];if(!Zy(ie,de)){B.vertexLength+4>G.MAX_VERTEX_ARRAY_LENGTH&&(B=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray));var be=ie.sub(de)._perp()._unit(),ke=de.dist(ie);ee+ke>32768&&(ee=0),uu(this.layoutVertexArray,ie.x,ie.y,be.x,be.y,0,0,ee),uu(this.layoutVertexArray,ie.x,ie.y,be.x,be.y,0,1,ee),uu(this.layoutVertexArray,de.x,de.y,be.x,be.y,0,0,ee+=ke),uu(this.layoutVertexArray,de.x,de.y,be.x,be.y,0,1,ee);var Ie=B.vertexLength;this.indexArray.emplaceBack(Ie,Ie+2,Ie+1),this.indexArray.emplaceBack(Ie+1,Ie+2,Ie+3),B.vertexLength+=4,B.primitiveLength+=2}}}}if(B.vertexLength+I>G.MAX_VERTEX_ARRAY_LENGTH&&(B=this.segments.prepareSegment(I,this.layoutVertexArray,this.indexArray)),qy[e.type]==="Polygon"){for(var Pe=[],Ue=[],He=B.vertexLength,ft=0,tt=S;ft<tt.length;ft+=1){var bt=tt[ft];if(bt.length!==0){bt!==S[0]&&Ue.push(Pe.length/2);for(var it=0;it<bt.length;it++){var Yt=bt[it];uu(this.layoutVertexArray,Yt.x,Yt.y,0,0,1,1,0),Pe.push(Yt.x),Pe.push(Yt.y)}}}for(var Dt=Hh(Pe,Ue),ct=0;ct<Dt.length;ct+=3)this.indexArray.emplaceBack(He+Dt[ct],He+Dt[ct+2],He+Dt[ct+1]);B.primitiveLength+=Dt.length/3,B.vertexLength+=I}}var rr;this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,e,i,p,l)},st("FillExtrusionBucket",Oo,{omit:["layers","features"]});var Gy={paint:new rn({"fill-extrusion-opacity":new gt(j["paint_fill-extrusion"]["fill-extrusion-opacity"]),"fill-extrusion-color":new ut(j["paint_fill-extrusion"]["fill-extrusion-color"]),"fill-extrusion-translate":new gt(j["paint_fill-extrusion"]["fill-extrusion-translate"]),"fill-extrusion-translate-anchor":new gt(j["paint_fill-extrusion"]["fill-extrusion-translate-anchor"]),"fill-extrusion-pattern":new Ys(j["paint_fill-extrusion"]["fill-extrusion-pattern"]),"fill-extrusion-height":new ut(j["paint_fill-extrusion"]["fill-extrusion-height"]),"fill-extrusion-base":new ut(j["paint_fill-extrusion"]["fill-extrusion-base"]),"fill-extrusion-vertical-gradient":new gt(j["paint_fill-extrusion"]["fill-extrusion-vertical-gradient"])})},Ky=function(e){function t(i){e.call(this,i,Gy)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.createBucket=function(i){return new Oo(i)},t.prototype.queryRadius=function(){return Li(this.paint.get("fill-extrusion-translate"))},t.prototype.is3D=function(){return!0},t.prototype.queryIntersectsFeature=function(i,l,p,m,x,S,I,A){var C=Ro(i,this.paint.get("fill-extrusion-translate"),this.paint.get("fill-extrusion-translate-anchor"),S.angle,I),B=this.paint.get("fill-extrusion-height").evaluate(l,p),U=this.paint.get("fill-extrusion-base").evaluate(l,p),q=function(ee,ce,ie,de){for(var be=[],ke=0,Ie=ee;ke<Ie.length;ke+=1){var Pe=Ie[ke],Ue=[Pe.x,Pe.y,0,1];rl(Ue,Ue,ce),be.push(new F(Ue[0]/Ue[3],Ue[1]/Ue[3]))}return be}(C,A),Q=function(ee,ce,ie,de){for(var be=[],ke=[],Ie=de[8]*ce,Pe=de[9]*ce,Ue=de[10]*ce,He=de[11]*ce,ft=de[8]*ie,tt=de[9]*ie,bt=de[10]*ie,it=de[11]*ie,Yt=0,Dt=ee;Yt<Dt.length;Yt+=1){for(var ct=[],rr=[],Kt=0,yr=Dt[Yt];Kt<yr.length;Kt+=1){var xt=yr[Kt],kr=xt.x,Jr=xt.y,li=de[0]*kr+de[4]*Jr+de[12],ii=de[1]*kr+de[5]*Jr+de[13],Yr=de[2]*kr+de[6]*Jr+de[14],ui=de[3]*kr+de[7]*Jr+de[15],Ri=Yr+Ue,Bi=ui+He,Sn=li+ft,Xi=ii+tt,En=Yr+bt,di=ui+it,Wi=new F((li+Ie)/Bi,(ii+Pe)/Bi);Wi.z=Ri/Bi,ct.push(Wi);var pr=new F(Sn/di,Xi/di);pr.z=En/di,rr.push(pr)}be.push(ct),ke.push(rr)}return[be,ke]}(m,U,B,A);return function(ee,ce,ie){var de=1/0;go(ie,ce)&&(de=rf(ie,ce[0]));for(var be=0;be<ce.length;be++)for(var ke=ce[be],Ie=ee[be],Pe=0;Pe<ke.length-1;Pe++){var Ue=ke[Pe],He=[Ue,ke[Pe+1],Ie[Pe+1],Ie[Pe],Ue];ea(ie,He)&&(de=Math.min(de,rf(ie,He)))}return de!==1/0&&de}(Q[0],Q[1],q)},t}(To);function cu(e,t){return e.x*t.x+e.y*t.y}function rf(e,t){if(e.length===1){for(var i,l=0,p=t[l++];!i||p.equals(i);)if(!(i=t[l++]))return 1/0;for(;l<t.length;l++){var m=t[l],x=e[0],S=i.sub(p),I=m.sub(p),A=x.sub(p),C=cu(S,S),B=cu(S,I),U=cu(I,I),q=cu(A,S),Q=cu(A,I),ee=C*U-B*B,ce=(U*q-B*Q)/ee,ie=(C*Q-B*q)/ee,de=p.z*(1-ce-ie)+i.z*ce+m.z*ie;if(isFinite(de))return de}return 1/0}for(var be=1/0,ke=0,Ie=t;ke<Ie.length;ke+=1)be=Math.min(be,Ie[ke].z);return be}var Xy=Zi([{name:"a_pos_normal",components:2,type:"Int16"},{name:"a_data",components:4,type:"Uint8"}],4).members,Wy=Zi([{name:"a_uv_x",components:1,type:"Float32"},{name:"a_split_index",components:1,type:"Float32"}]).members,Hy=al.VectorTileFeature.types,Jy=Math.cos(Math.PI/180*37.5),nf=Math.pow(2,14)/.5,Cn=function(e){var t=this;this.zoom=e.zoom,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map(function(i){return i.id}),this.index=e.index,this.hasPattern=!1,this.patternFeatures=[],this.lineClipsArray=[],this.gradients={},this.layers.forEach(function(i){t.gradients[i.id]={}}),this.layoutVertexArray=new Zn,this.layoutVertexArray2=new Ga,this.indexArray=new Yo,this.programConfigurations=new Ct(e.layers,e.zoom),this.segments=new G,this.maxLineLength=0,this.stateDependentLayerIds=this.layers.filter(function(i){return i.isStateDependent()}).map(function(i){return i.id})};Cn.prototype.populate=function(e,t,i){this.hasPattern=ep("line",this.layers,t);for(var l=this.layers[0].layout.get("line-sort-key"),p=[],m=0,x=e;m<x.length;m+=1){var S=x[m],I=S.feature,A=S.id,C=S.index,B=S.sourceLayerIndex,U=this.layers[0]._featureFilter.needGeometry,q=fi(I,U);if(this.layers[0]._featureFilter.filter(new ur(this.zoom),q,i)){var Q=l?l.evaluate(q,{},i):void 0,ee={id:A,properties:I.properties,type:I.type,sourceLayerIndex:B,index:C,geometry:U?q.geometry:ri(I),patterns:{},sortKey:Q};p.push(ee)}}l&&p.sort(function(Ue,He){return Ue.sortKey-He.sortKey});for(var ce=0,ie=p;ce<ie.length;ce+=1){var de=ie[ce],be=de.geometry,ke=de.index,Ie=de.sourceLayerIndex;if(this.hasPattern){var Pe=tp("line",this.layers,de,this.zoom,t);this.patternFeatures.push(Pe)}else this.addFeature(de,be,ke,i,{});t.featureIndex.insert(e[ke].feature,be,ke,Ie,this.index)}},Cn.prototype.update=function(e,t,i){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(e,t,this.stateDependentLayers,i)},Cn.prototype.addFeatures=function(e,t,i){for(var l=0,p=this.patternFeatures;l<p.length;l+=1){var m=p[l];this.addFeature(m,m.geometry,m.index,t,i)}},Cn.prototype.isEmpty=function(){return this.layoutVertexArray.length===0},Cn.prototype.uploadPending=function(){return!this.uploaded||this.programConfigurations.needsUpload},Cn.prototype.upload=function(e){this.uploaded||(this.layoutVertexArray2.length!==0&&(this.layoutVertexBuffer2=e.createVertexBuffer(this.layoutVertexArray2,Wy)),this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,Xy),this.indexBuffer=e.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(e),this.uploaded=!0},Cn.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())},Cn.prototype.lineFeatureClips=function(e){if(e.properties&&e.properties.hasOwnProperty("mapbox_clip_start")&&e.properties.hasOwnProperty("mapbox_clip_end"))return{start:+e.properties.mapbox_clip_start,end:+e.properties.mapbox_clip_end}},Cn.prototype.addFeature=function(e,t,i,l,p){var m=this.layers[0].layout,x=m.get("line-join").evaluate(e,{}),S=m.get("line-cap"),I=m.get("line-miter-limit"),A=m.get("line-round-limit");this.lineClips=this.lineFeatureClips(e);for(var C=0,B=t;C<B.length;C+=1)this.addLine(B[C],e,x,S,I,A);this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,e,i,p,l)},Cn.prototype.addLine=function(e,t,i,l,p,m){if(this.distance=0,this.scaledDistance=0,this.totalDistance=0,this.lineClips){this.lineClipsArray.push(this.lineClips);for(var x=0;x<e.length-1;x++)this.totalDistance+=e[x].dist(e[x+1]);this.updateScaledDistance(),this.maxLineLength=Math.max(this.maxLineLength,this.totalDistance)}for(var S=Hy[t.type]==="Polygon",I=e.length;I>=2&&e[I-1].equals(e[I-2]);)I--;for(var A=0;A<I-1&&e[A].equals(e[A+1]);)A++;if(!(I<(S?3:2))){i==="bevel"&&(p=1.05);var C,B=this.overscaling<=16?122880/(512*this.overscaling):0,U=this.segments.prepareSegment(10*I,this.layoutVertexArray,this.indexArray),q=void 0,Q=void 0,ee=void 0,ce=void 0;this.e1=this.e2=-1,S&&(ce=e[A].sub(C=e[I-2])._unit()._perp());for(var ie=A;ie<I;ie++)if(!(Q=ie===I-1?S?e[A+1]:void 0:e[ie+1])||!e[ie].equals(Q)){ce&&(ee=ce),C&&(q=C),C=e[ie],ce=Q?Q.sub(C)._unit()._perp():ee;var de=(ee=ee||ce).add(ce);de.x===0&&de.y===0||de._unit();var be=ee.x*ce.x+ee.y*ce.y,ke=de.x*ce.x+de.y*ce.y,Ie=ke!==0?1/ke:1/0,Pe=2*Math.sqrt(2-2*ke),Ue=ke<Jy&&q&&Q,He=ee.x*ce.y-ee.y*ce.x>0;if(Ue&&ie>A){var ft=C.dist(q);if(ft>2*B){var tt=C.sub(C.sub(q)._mult(B/ft)._round());this.updateDistance(q,tt),this.addCurrentVertex(tt,ee,0,0,U),q=tt}}var bt=q&&Q,it=bt?i:S?"butt":l;if(bt&&it==="round"&&(Ie<m?it="miter":Ie<=2&&(it="fakeround")),it==="miter"&&Ie>p&&(it="bevel"),it==="bevel"&&(Ie>2&&(it="flipbevel"),Ie<p&&(it="miter")),q&&this.updateDistance(q,C),it==="miter")de._mult(Ie),this.addCurrentVertex(C,de,0,0,U);else if(it==="flipbevel"){if(Ie>100)de=ce.mult(-1);else{var Yt=Ie*ee.add(ce).mag()/ee.sub(ce).mag();de._perp()._mult(Yt*(He?-1:1))}this.addCurrentVertex(C,de,0,0,U),this.addCurrentVertex(C,de.mult(-1),0,0,U)}else if(it==="bevel"||it==="fakeround"){var Dt=-Math.sqrt(Ie*Ie-1),ct=He?Dt:0,rr=He?0:Dt;if(q&&this.addCurrentVertex(C,ee,ct,rr,U),it==="fakeround")for(var Kt=Math.round(180*Pe/Math.PI/20),yr=1;yr<Kt;yr++){var xt=yr/Kt;if(xt!==.5){var kr=xt-.5;xt+=xt*kr*(xt-1)*((1.0904+be*(be*(3.55645-1.43519*be)-3.2452))*kr*kr+(.848013+be*(.215638*be-1.06021)))}var Jr=ce.sub(ee)._mult(xt)._add(ee)._unit()._mult(He?-1:1);this.addHalfVertex(C,Jr.x,Jr.y,!1,He,0,U)}Q&&this.addCurrentVertex(C,ce,-ct,-rr,U)}else if(it==="butt")this.addCurrentVertex(C,de,0,0,U);else if(it==="square"){var li=q?1:-1;this.addCurrentVertex(C,de,li,li,U)}else it==="round"&&(q&&(this.addCurrentVertex(C,ee,0,0,U),this.addCurrentVertex(C,ee,1,1,U,!0)),Q&&(this.addCurrentVertex(C,ce,-1,-1,U,!0),this.addCurrentVertex(C,ce,0,0,U)));if(Ue&&ie<I-1){var ii=C.dist(Q);if(ii>2*B){var Yr=C.add(Q.sub(C)._mult(B/ii)._round());this.updateDistance(C,Yr),this.addCurrentVertex(Yr,ce,0,0,U),C=Yr}}}}},Cn.prototype.addCurrentVertex=function(e,t,i,l,p,m){m===void 0&&(m=!1);var x=t.y*l-t.x,S=-t.y-t.x*l;this.addHalfVertex(e,t.x+t.y*i,t.y-t.x*i,m,!1,i,p),this.addHalfVertex(e,x,S,m,!0,-l,p),this.distance>nf/2&&this.totalDistance===0&&(this.distance=0,this.addCurrentVertex(e,t,i,l,p,m))},Cn.prototype.addHalfVertex=function(e,t,i,l,p,m,x){var S=.5*(this.lineClips?this.scaledDistance*(nf-1):this.scaledDistance);this.layoutVertexArray.emplaceBack((e.x<<1)+(l?1:0),(e.y<<1)+(p?1:0),Math.round(63*t)+128,Math.round(63*i)+128,1+(m===0?0:m<0?-1:1)|(63&S)<<2,S>>6),this.lineClips&&this.layoutVertexArray2.emplaceBack((this.scaledDistance-this.lineClips.start)/(this.lineClips.end-this.lineClips.start),this.lineClipsArray.length);var I=x.vertexLength++;this.e1>=0&&this.e2>=0&&(this.indexArray.emplaceBack(this.e1,this.e2,I),x.primitiveLength++),p?this.e2=I:this.e1=I},Cn.prototype.updateScaledDistance=function(){this.scaledDistance=this.lineClips?this.lineClips.start+(this.lineClips.end-this.lineClips.start)*this.distance/this.totalDistance:this.distance},Cn.prototype.updateDistance=function(e,t){this.distance+=e.dist(t),this.updateScaledDistance()},st("LineBucket",Cn,{omit:["layers","patternFeatures"]});var Yy=new rn({"line-cap":new gt(j.layout_line["line-cap"]),"line-join":new ut(j.layout_line["line-join"]),"line-miter-limit":new gt(j.layout_line["line-miter-limit"]),"line-round-limit":new gt(j.layout_line["line-round-limit"]),"line-sort-key":new ut(j.layout_line["line-sort-key"])}),of={paint:new rn({"line-opacity":new ut(j.paint_line["line-opacity"]),"line-color":new ut(j.paint_line["line-color"]),"line-translate":new gt(j.paint_line["line-translate"]),"line-translate-anchor":new gt(j.paint_line["line-translate-anchor"]),"line-width":new ut(j.paint_line["line-width"]),"line-gap-width":new ut(j.paint_line["line-gap-width"]),"line-offset":new ut(j.paint_line["line-offset"]),"line-blur":new ut(j.paint_line["line-blur"]),"line-dasharray":new xn(j.paint_line["line-dasharray"]),"line-pattern":new Ys(j.paint_line["line-pattern"]),"line-gradient":new _o(j.paint_line["line-gradient"])}),layout:Yy},af=new(function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.possiblyEvaluate=function(i,l){return l=new ur(Math.floor(l.zoom),{now:l.now,fadeDuration:l.fadeDuration,zoomHistory:l.zoomHistory,transition:l.transition}),e.prototype.possiblyEvaluate.call(this,i,l)},t.prototype.evaluate=function(i,l,p,m){return l=xe({},l,{zoom:Math.floor(l.zoom)}),e.prototype.evaluate.call(this,i,l,p,m)},t}(ut))(of.paint.properties["line-width"].specification);af.useIntegerZoom=!0;var Qy=function(e){function t(i){e.call(this,i,of),this.gradientVersion=0}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._handleSpecialPaintPropertyUpdate=function(i){i==="line-gradient"&&(this.stepInterpolant=this._transitionablePaint._values["line-gradient"].value.expression._styleExpression.expression instanceof Nn,this.gradientVersion=(this.gradientVersion+1)%H)},t.prototype.gradientExpression=function(){return this._transitionablePaint._values["line-gradient"].value.expression},t.prototype.recalculate=function(i,l){e.prototype.recalculate.call(this,i,l),this.paint._values["line-floorwidth"]=af.possiblyEvaluate(this._transitioningPaint._values["line-width"].value,i)},t.prototype.createBucket=function(i){return new Cn(i)},t.prototype.queryRadius=function(i){var l=i,p=sf(Ao("line-width",this,l),Ao("line-gap-width",this,l)),m=Ao("line-offset",this,l);return p/2+Math.abs(m)+Li(this.paint.get("line-translate"))},t.prototype.queryIntersectsFeature=function(i,l,p,m,x,S,I){var A=Ro(i,this.paint.get("line-translate"),this.paint.get("line-translate-anchor"),S.angle,I),C=I/2*sf(this.paint.get("line-width").evaluate(l,p),this.paint.get("line-gap-width").evaluate(l,p)),B=this.paint.get("line-offset").evaluate(l,p);return B&&(m=function(U,q){for(var Q=[],ee=new F(0,0),ce=0;ce<U.length;ce++){for(var ie=U[ce],de=[],be=0;be<ie.length;be++){var ke=ie[be],Ie=ie[be+1],Pe=be===0?ee:ke.sub(ie[be-1])._unit()._perp(),Ue=be===ie.length-1?ee:Ie.sub(ke)._unit()._perp(),He=Pe._add(Ue)._unit();He._mult(1/(He.x*Ue.x+He.y*Ue.y)),de.push(He._mult(q)._add(ke))}Q.push(de)}return Q}(m,B*I)),function(U,q,Q){for(var ee=0;ee<q.length;ee++){var ce=q[ee];if(U.length>=3){for(var ie=0;ie<ce.length;ie++)if(zo(U,ce[ie]))return!0}if(ao(U,ce,Q))return!0}return!1}(A,m,C)},t.prototype.isTileClipped=function(){return!0},t}(To);function sf(e,t){return t>0?t+2*e:e}var $y=Zi([{name:"a_pos_offset",components:4,type:"Int16"},{name:"a_data",components:4,type:"Uint16"},{name:"a_pixeloffset",components:4,type:"Int16"}],4),e_=Zi([{name:"a_projected_pos",components:3,type:"Float32"}],4),t_=(Zi([{name:"a_fade_opacity",components:1,type:"Uint32"}],4),Zi([{name:"a_placed",components:2,type:"Uint8"},{name:"a_shift",components:2,type:"Float32"}])),lf=(Zi([{type:"Int16",name:"anchorPointX"},{type:"Int16",name:"anchorPointY"},{type:"Int16",name:"x1"},{type:"Int16",name:"y1"},{type:"Int16",name:"x2"},{type:"Int16",name:"y2"},{type:"Uint32",name:"featureIndex"},{type:"Uint16",name:"sourceLayerIndex"},{type:"Uint16",name:"bucketIndex"}]),Zi([{name:"a_pos",components:2,type:"Int16"},{name:"a_anchor_pos",components:2,type:"Int16"},{name:"a_extrude",components:2,type:"Int16"}],4)),r_=Zi([{name:"a_pos",components:2,type:"Float32"},{name:"a_radius",components:1,type:"Float32"},{name:"a_flags",components:2,type:"Int16"}],4);function i_(e,t,i){return e.sections.forEach(function(l){l.text=function(p,m,x){var S=m.layout.get("text-transform").evaluate(x,{});return S==="uppercase"?p=p.toLocaleUpperCase():S==="lowercase"&&(p=p.toLocaleLowerCase()),Qn.applyArabicShaping&&(p=Qn.applyArabicShaping(p)),p}(l.text,t,i)}),e}Zi([{name:"triangle",components:3,type:"Uint16"}]),Zi([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Uint16",name:"glyphStartIndex"},{type:"Uint16",name:"numGlyphs"},{type:"Uint32",name:"vertexStartIndex"},{type:"Uint32",name:"lineStartIndex"},{type:"Uint32",name:"lineLength"},{type:"Uint16",name:"segment"},{type:"Uint16",name:"lowerSize"},{type:"Uint16",name:"upperSize"},{type:"Float32",name:"lineOffsetX"},{type:"Float32",name:"lineOffsetY"},{type:"Uint8",name:"writingMode"},{type:"Uint8",name:"placedOrientation"},{type:"Uint8",name:"hidden"},{type:"Uint32",name:"crossTileID"},{type:"Int16",name:"associatedIconIndex"}]),Zi([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Int16",name:"rightJustifiedTextSymbolIndex"},{type:"Int16",name:"centerJustifiedTextSymbolIndex"},{type:"Int16",name:"leftJustifiedTextSymbolIndex"},{type:"Int16",name:"verticalPlacedTextSymbolIndex"},{type:"Int16",name:"placedIconSymbolIndex"},{type:"Int16",name:"verticalPlacedIconSymbolIndex"},{type:"Uint16",name:"key"},{type:"Uint16",name:"textBoxStartIndex"},{type:"Uint16",name:"textBoxEndIndex"},{type:"Uint16",name:"verticalTextBoxStartIndex"},{type:"Uint16",name:"verticalTextBoxEndIndex"},{type:"Uint16",name:"iconBoxStartIndex"},{type:"Uint16",name:"iconBoxEndIndex"},{type:"Uint16",name:"verticalIconBoxStartIndex"},{type:"Uint16",name:"verticalIconBoxEndIndex"},{type:"Uint16",name:"featureIndex"},{type:"Uint16",name:"numHorizontalGlyphVertices"},{type:"Uint16",name:"numVerticalGlyphVertices"},{type:"Uint16",name:"numIconVertices"},{type:"Uint16",name:"numVerticalIconVertices"},{type:"Uint16",name:"useRuntimeCollisionCircles"},{type:"Uint32",name:"crossTileID"},{type:"Float32",name:"textBoxScale"},{type:"Float32",components:2,name:"textOffset"},{type:"Float32",name:"collisionCircleDiameter"}]),Zi([{type:"Float32",name:"offsetX"}]),Zi([{type:"Int16",name:"x"},{type:"Int16",name:"y"},{type:"Int16",name:"tileUnitDistanceFromAnchor"}]);var hu={"!":"︕","#":"＃",$:"＄","%":"％","&":"＆","(":"︵",")":"︶","*":"＊","+":"＋",",":"︐","-":"︲",".":"・","/":"／",":":"︓",";":"︔","<":"︿","=":"＝",">":"﹀","?":"︖","@":"＠","[":"﹇","\\":"＼","]":"﹈","^":"＾",_:"︳","`":"｀","{":"︷","|":"―","}":"︸","~":"～","¢":"￠","£":"￡","¥":"￥","¦":"￤","¬":"￢","¯":"￣","–":"︲","—":"︱","‘":"﹃","’":"﹄","“":"﹁","”":"﹂","…":"︙","‧":"・","₩":"￦","、":"︑","。":"︒","〈":"︿","〉":"﹀","《":"︽","》":"︾","「":"﹁","」":"﹂","『":"﹃","』":"﹄","【":"︻","】":"︼","〔":"︹","〕":"︺","〖":"︗","〗":"︘","！":"︕","（":"︵","）":"︶","，":"︐","－":"︲","．":"・","：":"︓","；":"︔","＜":"︿","＞":"﹀","？":"︖","［":"﹇","］":"﹈","＿":"︳","｛":"︷","｜":"―","｝":"︸","｟":"︵","｠":"︶","｡":"︒","｢":"﹁","｣":"﹂"},uf=function(e,t,i,l,p){var m,x,S=8*p-l-1,I=(1<<S)-1,A=I>>1,C=-7,B=i?p-1:0,U=i?-1:1,q=e[t+B];for(B+=U,m=q&(1<<-C)-1,q>>=-C,C+=S;C>0;m=256*m+e[t+B],B+=U,C-=8);for(x=m&(1<<-C)-1,m>>=-C,C+=l;C>0;x=256*x+e[t+B],B+=U,C-=8);if(m===0)m=1-A;else{if(m===I)return x?NaN:1/0*(q?-1:1);x+=Math.pow(2,l),m-=A}return(q?-1:1)*x*Math.pow(2,m-l)},cf=function(e,t,i,l,p,m){var x,S,I,A=8*m-p-1,C=(1<<A)-1,B=C>>1,U=p===23?Math.pow(2,-24)-Math.pow(2,-77):0,q=l?0:m-1,Q=l?1:-1,ee=t<0||t===0&&1/t<0?1:0;for(t=Math.abs(t),isNaN(t)||t===1/0?(S=isNaN(t)?1:0,x=C):(x=Math.floor(Math.log(t)/Math.LN2),t*(I=Math.pow(2,-x))<1&&(x--,I*=2),(t+=x+B>=1?U/I:U*Math.pow(2,1-B))*I>=2&&(x++,I/=2),x+B>=C?(S=0,x=C):x+B>=1?(S=(t*I-1)*Math.pow(2,p),x+=B):(S=t*Math.pow(2,B-1)*Math.pow(2,p),x=0));p>=8;e[i+q]=255&S,q+=Q,S/=256,p-=8);for(x=x<<p|S,A+=p;A>0;e[i+q]=255&x,q+=Q,x/=256,A-=8);e[i+q-Q]|=128*ee},Cc=qr;function qr(e){this.buf=ArrayBuffer.isView&&ArrayBuffer.isView(e)?e:new Uint8Array(e||0),this.pos=0,this.type=0,this.length=this.buf.length}qr.Varint=0,qr.Fixed64=1,qr.Bytes=2,qr.Fixed32=5;var hf=typeof TextDecoder>"u"?null:new TextDecoder("utf8");function Pa(e){return e.type===qr.Bytes?e.readVarint()+e.pos:e.pos+1}function sl(e,t,i){return i?4294967296*t+(e>>>0):4294967296*(t>>>0)+(e>>>0)}function pf(e,t,i){var l=t<=16383?1:t<=2097151?2:t<=268435455?3:Math.floor(Math.log(t)/(7*Math.LN2));i.realloc(l);for(var p=i.pos-1;p>=e;p--)i.buf[p+l]=i.buf[p]}function n_(e,t){for(var i=0;i<e.length;i++)t.writeVarint(e[i])}function o_(e,t){for(var i=0;i<e.length;i++)t.writeSVarint(e[i])}function a_(e,t){for(var i=0;i<e.length;i++)t.writeFloat(e[i])}function s_(e,t){for(var i=0;i<e.length;i++)t.writeDouble(e[i])}function l_(e,t){for(var i=0;i<e.length;i++)t.writeBoolean(e[i])}function u_(e,t){for(var i=0;i<e.length;i++)t.writeFixed32(e[i])}function c_(e,t){for(var i=0;i<e.length;i++)t.writeSFixed32(e[i])}function h_(e,t){for(var i=0;i<e.length;i++)t.writeFixed64(e[i])}function p_(e,t){for(var i=0;i<e.length;i++)t.writeSFixed64(e[i])}function Mc(e,t){return(e[t]|e[t+1]<<8|e[t+2]<<16)+16777216*e[t+3]}function ll(e,t,i){e[i]=t,e[i+1]=t>>>8,e[i+2]=t>>>16,e[i+3]=t>>>24}function ff(e,t){return(e[t]|e[t+1]<<8|e[t+2]<<16)+(e[t+3]<<24)}function f_(e,t,i){e===1&&i.readMessage(d_,t)}function d_(e,t,i){if(e===3){var l=i.readMessage(m_,{}),p=l.width,m=l.height,x=l.left,S=l.top,I=l.advance;t.push({id:l.id,bitmap:new Ts({width:p+6,height:m+6},l.bitmap),metrics:{width:p,height:m,left:x,top:S,advance:I}})}}function m_(e,t,i){e===1?t.id=i.readVarint():e===2?t.bitmap=i.readBytes():e===3?t.width=i.readVarint():e===4?t.height=i.readVarint():e===5?t.left=i.readSVarint():e===6?t.top=i.readSVarint():e===7&&(t.advance=i.readVarint())}function df(e){for(var t=0,i=0,l=0,p=e;l<p.length;l+=1){var m=p[l];t+=m.w*m.h,i=Math.max(i,m.w)}e.sort(function(ee,ce){return ce.h-ee.h});for(var x=[{x:0,y:0,w:Math.max(Math.ceil(Math.sqrt(t/.95)),i),h:1/0}],S=0,I=0,A=0,C=e;A<C.length;A+=1)for(var B=C[A],U=x.length-1;U>=0;U--){var q=x[U];if(!(B.w>q.w||B.h>q.h)){if(B.x=q.x,B.y=q.y,I=Math.max(I,B.y+B.h),S=Math.max(S,B.x+B.w),B.w===q.w&&B.h===q.h){var Q=x.pop();U<x.length&&(x[U]=Q)}else B.h===q.h?(q.x+=B.w,q.w-=B.w):B.w===q.w?(q.y+=B.h,q.h-=B.h):(x.push({x:q.x+B.w,y:q.y,w:q.w-B.w,h:B.h}),q.y+=B.h,q.h-=B.h);break}}return{w:S,h:I,fill:t/(S*I)||0}}qr.prototype={destroy:function(){this.buf=null},readFields:function(e,t,i){for(i=i||this.length;this.pos<i;){var l=this.readVarint(),p=l>>3,m=this.pos;this.type=7&l,e(p,t,this),this.pos===m&&this.skip(l)}return t},readMessage:function(e,t){return this.readFields(e,t,this.readVarint()+this.pos)},readFixed32:function(){var e=Mc(this.buf,this.pos);return this.pos+=4,e},readSFixed32:function(){var e=ff(this.buf,this.pos);return this.pos+=4,e},readFixed64:function(){var e=Mc(this.buf,this.pos)+4294967296*Mc(this.buf,this.pos+4);return this.pos+=8,e},readSFixed64:function(){var e=Mc(this.buf,this.pos)+4294967296*ff(this.buf,this.pos+4);return this.pos+=8,e},readFloat:function(){var e=uf(this.buf,this.pos,!0,23,4);return this.pos+=4,e},readDouble:function(){var e=uf(this.buf,this.pos,!0,52,8);return this.pos+=8,e},readVarint:function(e){var t,i,l=this.buf;return t=127&(i=l[this.pos++]),i<128?t:(t|=(127&(i=l[this.pos++]))<<7,i<128?t:(t|=(127&(i=l[this.pos++]))<<14,i<128?t:(t|=(127&(i=l[this.pos++]))<<21,i<128?t:function(p,m,x){var S,I,A=x.buf;if(S=(112&(I=A[x.pos++]))>>4,I<128||(S|=(127&(I=A[x.pos++]))<<3,I<128)||(S|=(127&(I=A[x.pos++]))<<10,I<128)||(S|=(127&(I=A[x.pos++]))<<17,I<128)||(S|=(127&(I=A[x.pos++]))<<24,I<128)||(S|=(1&(I=A[x.pos++]))<<31,I<128))return sl(p,S,m);throw new Error("Expected varint not more than 10 bytes")}(t|=(15&(i=l[this.pos]))<<28,e,this))))},readVarint64:function(){return this.readVarint(!0)},readSVarint:function(){var e=this.readVarint();return e%2==1?(e+1)/-2:e/2},readBoolean:function(){return!!this.readVarint()},readString:function(){var e=this.readVarint()+this.pos,t=this.pos;return this.pos=e,e-t>=12&&hf?function(i,l,p){return hf.decode(i.subarray(l,p))}(this.buf,t,e):function(i,l,p){for(var m="",x=l;x<p;){var S,I,A,C=i[x],B=null,U=C>239?4:C>223?3:C>191?2:1;if(x+U>p)break;U===1?C<128&&(B=C):U===2?(192&(S=i[x+1]))==128&&(B=(31&C)<<6|63&S)<=127&&(B=null):U===3?(I=i[x+2],(192&(S=i[x+1]))==128&&(192&I)==128&&((B=(15&C)<<12|(63&S)<<6|63&I)<=2047||B>=55296&&B<=57343)&&(B=null)):U===4&&(I=i[x+2],A=i[x+3],(192&(S=i[x+1]))==128&&(192&I)==128&&(192&A)==128&&((B=(15&C)<<18|(63&S)<<12|(63&I)<<6|63&A)<=65535||B>=1114112)&&(B=null)),B===null?(B=65533,U=1):B>65535&&(B-=65536,m+=String.fromCharCode(B>>>10&1023|55296),B=56320|1023&B),m+=String.fromCharCode(B),x+=U}return m}(this.buf,t,e)},readBytes:function(){var e=this.readVarint()+this.pos,t=this.buf.subarray(this.pos,e);return this.pos=e,t},readPackedVarint:function(e,t){if(this.type!==qr.Bytes)return e.push(this.readVarint(t));var i=Pa(this);for(e=e||[];this.pos<i;)e.push(this.readVarint(t));return e},readPackedSVarint:function(e){if(this.type!==qr.Bytes)return e.push(this.readSVarint());var t=Pa(this);for(e=e||[];this.pos<t;)e.push(this.readSVarint());return e},readPackedBoolean:function(e){if(this.type!==qr.Bytes)return e.push(this.readBoolean());var t=Pa(this);for(e=e||[];this.pos<t;)e.push(this.readBoolean());return e},readPackedFloat:function(e){if(this.type!==qr.Bytes)return e.push(this.readFloat());var t=Pa(this);for(e=e||[];this.pos<t;)e.push(this.readFloat());return e},readPackedDouble:function(e){if(this.type!==qr.Bytes)return e.push(this.readDouble());var t=Pa(this);for(e=e||[];this.pos<t;)e.push(this.readDouble());return e},readPackedFixed32:function(e){if(this.type!==qr.Bytes)return e.push(this.readFixed32());var t=Pa(this);for(e=e||[];this.pos<t;)e.push(this.readFixed32());return e},readPackedSFixed32:function(e){if(this.type!==qr.Bytes)return e.push(this.readSFixed32());var t=Pa(this);for(e=e||[];this.pos<t;)e.push(this.readSFixed32());return e},readPackedFixed64:function(e){if(this.type!==qr.Bytes)return e.push(this.readFixed64());var t=Pa(this);for(e=e||[];this.pos<t;)e.push(this.readFixed64());return e},readPackedSFixed64:function(e){if(this.type!==qr.Bytes)return e.push(this.readSFixed64());var t=Pa(this);for(e=e||[];this.pos<t;)e.push(this.readSFixed64());return e},skip:function(e){var t=7&e;if(t===qr.Varint)for(;this.buf[this.pos++]>127;);else if(t===qr.Bytes)this.pos=this.readVarint()+this.pos;else if(t===qr.Fixed32)this.pos+=4;else{if(t!==qr.Fixed64)throw new Error("Unimplemented type: "+t);this.pos+=8}},writeTag:function(e,t){this.writeVarint(e<<3|t)},realloc:function(e){for(var t=this.length||16;t<this.pos+e;)t*=2;if(t!==this.length){var i=new Uint8Array(t);i.set(this.buf),this.buf=i,this.length=t}},finish:function(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)},writeFixed32:function(e){this.realloc(4),ll(this.buf,e,this.pos),this.pos+=4},writeSFixed32:function(e){this.realloc(4),ll(this.buf,e,this.pos),this.pos+=4},writeFixed64:function(e){this.realloc(8),ll(this.buf,-1&e,this.pos),ll(this.buf,Math.floor(e*(1/4294967296)),this.pos+4),this.pos+=8},writeSFixed64:function(e){this.realloc(8),ll(this.buf,-1&e,this.pos),ll(this.buf,Math.floor(e*(1/4294967296)),this.pos+4),this.pos+=8},writeVarint:function(e){(e=+e||0)>268435455||e<0?function(t,i){var l,p;if(t>=0?(l=t%4294967296|0,p=t/4294967296|0):(p=~(-t/4294967296),4294967295^(l=~(-t%4294967296))?l=l+1|0:(l=0,p=p+1|0)),t>=18446744073709552e3||t<-18446744073709552e3)throw new Error("Given varint doesn't fit into 10 bytes");i.realloc(10),function(m,x,S){S.buf[S.pos++]=127&m|128,m>>>=7,S.buf[S.pos++]=127&m|128,m>>>=7,S.buf[S.pos++]=127&m|128,m>>>=7,S.buf[S.pos++]=127&m|128,S.buf[S.pos]=127&(m>>>=7)}(l,0,i),function(m,x){var S=(7&m)<<4;x.buf[x.pos++]|=S|((m>>>=3)?128:0),m&&(x.buf[x.pos++]=127&m|((m>>>=7)?128:0),m&&(x.buf[x.pos++]=127&m|((m>>>=7)?128:0),m&&(x.buf[x.pos++]=127&m|((m>>>=7)?128:0),m&&(x.buf[x.pos++]=127&m|((m>>>=7)?128:0),m&&(x.buf[x.pos++]=127&m)))))}(p,i)}(e,this):(this.realloc(4),this.buf[this.pos++]=127&e|(e>127?128:0),e<=127||(this.buf[this.pos++]=127&(e>>>=7)|(e>127?128:0),e<=127||(this.buf[this.pos++]=127&(e>>>=7)|(e>127?128:0),e<=127||(this.buf[this.pos++]=e>>>7&127))))},writeSVarint:function(e){this.writeVarint(e<0?2*-e-1:2*e)},writeBoolean:function(e){this.writeVarint(!!e)},writeString:function(e){e=String(e),this.realloc(4*e.length),this.pos++;var t=this.pos;this.pos=function(l,p,m){for(var x,S,I=0;I<p.length;I++){if((x=p.charCodeAt(I))>55295&&x<57344){if(!S){x>56319||I+1===p.length?(l[m++]=239,l[m++]=191,l[m++]=189):S=x;continue}if(x<56320){l[m++]=239,l[m++]=191,l[m++]=189,S=x;continue}x=S-55296<<10|x-56320|65536,S=null}else S&&(l[m++]=239,l[m++]=191,l[m++]=189,S=null);x<128?l[m++]=x:(x<2048?l[m++]=x>>6|192:(x<65536?l[m++]=x>>12|224:(l[m++]=x>>18|240,l[m++]=x>>12&63|128),l[m++]=x>>6&63|128),l[m++]=63&x|128)}return m}(this.buf,e,this.pos);var i=this.pos-t;i>=128&&pf(t,i,this),this.pos=t-1,this.writeVarint(i),this.pos+=i},writeFloat:function(e){this.realloc(4),cf(this.buf,e,this.pos,!0,23,4),this.pos+=4},writeDouble:function(e){this.realloc(8),cf(this.buf,e,this.pos,!0,52,8),this.pos+=8},writeBytes:function(e){var t=e.length;this.writeVarint(t),this.realloc(t);for(var i=0;i<t;i++)this.buf[this.pos++]=e[i]},writeRawMessage:function(e,t){this.pos++;var i=this.pos;e(t,this);var l=this.pos-i;l>=128&&pf(i,l,this),this.pos=i-1,this.writeVarint(l),this.pos+=l},writeMessage:function(e,t,i){this.writeTag(e,qr.Bytes),this.writeRawMessage(t,i)},writePackedVarint:function(e,t){t.length&&this.writeMessage(e,n_,t)},writePackedSVarint:function(e,t){t.length&&this.writeMessage(e,o_,t)},writePackedBoolean:function(e,t){t.length&&this.writeMessage(e,l_,t)},writePackedFloat:function(e,t){t.length&&this.writeMessage(e,a_,t)},writePackedDouble:function(e,t){t.length&&this.writeMessage(e,s_,t)},writePackedFixed32:function(e,t){t.length&&this.writeMessage(e,u_,t)},writePackedSFixed32:function(e,t){t.length&&this.writeMessage(e,c_,t)},writePackedFixed64:function(e,t){t.length&&this.writeMessage(e,h_,t)},writePackedSFixed64:function(e,t){t.length&&this.writeMessage(e,p_,t)},writeBytesField:function(e,t){this.writeTag(e,qr.Bytes),this.writeBytes(t)},writeFixed32Field:function(e,t){this.writeTag(e,qr.Fixed32),this.writeFixed32(t)},writeSFixed32Field:function(e,t){this.writeTag(e,qr.Fixed32),this.writeSFixed32(t)},writeFixed64Field:function(e,t){this.writeTag(e,qr.Fixed64),this.writeFixed64(t)},writeSFixed64Field:function(e,t){this.writeTag(e,qr.Fixed64),this.writeSFixed64(t)},writeVarintField:function(e,t){this.writeTag(e,qr.Varint),this.writeVarint(t)},writeSVarintField:function(e,t){this.writeTag(e,qr.Varint),this.writeSVarint(t)},writeStringField:function(e,t){this.writeTag(e,qr.Bytes),this.writeString(t)},writeFloatField:function(e,t){this.writeTag(e,qr.Fixed32),this.writeFloat(t)},writeDoubleField:function(e,t){this.writeTag(e,qr.Fixed64),this.writeDouble(t)},writeBooleanField:function(e,t){this.writeVarintField(e,!!t)}};var Dc=function(e,t){var i=t.pixelRatio,l=t.version,p=t.stretchX,m=t.stretchY,x=t.content;this.paddedRect=e,this.pixelRatio=i,this.stretchX=p,this.stretchY=m,this.content=x,this.version=l},pu={tl:{configurable:!0},br:{configurable:!0},tlbr:{configurable:!0},displaySize:{configurable:!0}};pu.tl.get=function(){return[this.paddedRect.x+1,this.paddedRect.y+1]},pu.br.get=function(){return[this.paddedRect.x+this.paddedRect.w-1,this.paddedRect.y+this.paddedRect.h-1]},pu.tlbr.get=function(){return this.tl.concat(this.br)},pu.displaySize.get=function(){return[(this.paddedRect.w-2)/this.pixelRatio,(this.paddedRect.h-2)/this.pixelRatio]},Object.defineProperties(Dc.prototype,pu);var fu=function(e,t){var i={},l={};this.haveRenderCallbacks=[];var p=[];this.addImages(e,i,p),this.addImages(t,l,p);var m=df(p),x=new Kn({width:m.w||1,height:m.h||1});for(var S in e){var I=e[S],A=i[S].paddedRect;Kn.copy(I.data,x,{x:0,y:0},{x:A.x+1,y:A.y+1},I.data)}for(var C in t){var B=t[C],U=l[C].paddedRect,q=U.x+1,Q=U.y+1,ee=B.data.width,ce=B.data.height;Kn.copy(B.data,x,{x:0,y:0},{x:q,y:Q},B.data),Kn.copy(B.data,x,{x:0,y:ce-1},{x:q,y:Q-1},{width:ee,height:1}),Kn.copy(B.data,x,{x:0,y:0},{x:q,y:Q+ce},{width:ee,height:1}),Kn.copy(B.data,x,{x:ee-1,y:0},{x:q-1,y:Q},{width:1,height:ce}),Kn.copy(B.data,x,{x:0,y:0},{x:q+ee,y:Q},{width:1,height:ce})}this.image=x,this.iconPositions=i,this.patternPositions=l};fu.prototype.addImages=function(e,t,i){for(var l in e){var p=e[l],m={x:0,y:0,w:p.data.width+2,h:p.data.height+2};i.push(m),t[l]=new Dc(m,p),p.hasRenderCallback&&this.haveRenderCallbacks.push(l)}},fu.prototype.patchUpdatedImages=function(e,t){for(var i in e.dispatchRenderCallbacks(this.haveRenderCallbacks),e.updatedImages)this.patchUpdatedImage(this.iconPositions[i],e.getImage(i),t),this.patchUpdatedImage(this.patternPositions[i],e.getImage(i),t)},fu.prototype.patchUpdatedImage=function(e,t,i){if(e&&t&&e.version!==t.version){e.version=t.version;var l=e.tl;i.update(t.data,void 0,{x:l[0],y:l[1]})}},st("ImagePosition",Dc),st("ImageAtlas",fu);var so={horizontal:1,vertical:2,horizontalOnly:3},ul=function(){this.scale=1,this.fontStack="",this.imageName=null};ul.forText=function(e,t){var i=new ul;return i.scale=e||1,i.fontStack=t,i},ul.forImage=function(e){var t=new ul;return t.imageName=e,t};var kn=function(){this.text="",this.sectionIndex=[],this.sections=[],this.imageSectionID=null};function Lc(e,t,i,l,p,m,x,S,I,A,C,B,U,q,Q,ee){var ce,ie=kn.fromFeature(e,p);B===so.vertical&&ie.verticalizePunctuation();var de=Qn.processBidirectionalText,be=Qn.processStyledBidirectionalText;if(de&&ie.sections.length===1){ce=[];for(var ke=0,Ie=de(ie.toString(),ip(ie,A,m,t,l,q,Q));ke<Ie.length;ke+=1){var Pe=Ie[ke],Ue=new kn;Ue.text=Pe,Ue.sections=ie.sections;for(var He=0;He<Pe.length;He++)Ue.sectionIndex.push(0);ce.push(Ue)}}else if(be){ce=[];for(var ft=0,tt=be(ie.text,ie.sectionIndex,ip(ie,A,m,t,l,q,Q));ft<tt.length;ft+=1){var bt=tt[ft],it=new kn;it.text=bt[0],it.sectionIndex=bt[1],it.sections=ie.sections,ce.push(it)}}else ce=function(ct,rr){for(var Kt=[],yr=ct.text,xt=0,kr=0,Jr=rr;kr<Jr.length;kr+=1){var li=Jr[kr];Kt.push(ct.substring(xt,li)),xt=li}return xt<yr.length&&Kt.push(ct.substring(xt,yr.length)),Kt}(ie,ip(ie,A,m,t,l,q,Q));var Yt=[],Dt={positionedLines:Yt,text:ie.toString(),top:C[1],bottom:C[1],left:C[0],right:C[0],writingMode:B,iconsInText:!1,verticalizable:!1};return function(ct,rr,Kt,yr,xt,kr,Jr,li,ii,Yr,ui,Ri){for(var Bi=0,Sn=-17,Xi=0,En=0,di=li==="right"?1:li==="left"?0:.5,Wi=0,pr=0,Or=xt;pr<Or.length;pr+=1){var Mr=Or[pr];Mr.trim();var gr=Mr.getMaxScale(),Mn=24*(gr-1),hn={positionedGlyphs:[],lineOffset:0};ct.positionedLines[Wi]=hn;var Kr=hn.positionedGlyphs,xi=0;if(Mr.length()){for(var pn=0;pn<Mr.length();pn++){var Sr=Mr.getSection(pn),ia=Mr.getSectionIndex(pn),lo=Mr.getCharCode(pn),na=0,mi=null,oa=null,Po=null,_l=24,Ps=!(ii===so.horizontal||!ui&&!Ws(lo)||ui&&(Rc[lo]||(La=lo,Qe.Arabic(La)||Qe["Arabic Supplement"](La)||Qe["Arabic Extended-A"](La)||Qe["Arabic Presentation Forms-A"](La)||Qe["Arabic Presentation Forms-B"](La))));if(Sr.imageName){var gl=yr[Sr.imageName];if(!gl)continue;Po=Sr.imageName,ct.iconsInText=ct.iconsInText||!0,oa=gl.paddedRect;var Da=gl.displaySize;Sr.scale=24*Sr.scale/Ri,na=Mn+(24-Da[1]*Sr.scale),_l=(mi={width:Da[0],height:Da[1],left:1,top:-3,advance:Ps?Da[1]:Da[0]}).advance;var vl=Ps?Da[0]*Sr.scale-24*gr:Da[1]*Sr.scale-24*gr;vl>0&&vl>xi&&(xi=vl)}else{var Zc=Kt[Sr.fontStack],bl=Zc&&Zc[lo];if(bl&&bl.rect)oa=bl.rect,mi=bl.metrics;else{var yu=rr[Sr.fontStack],Gc=yu&&yu[lo];if(!Gc)continue;mi=Gc.metrics}na=24*(gr-Sr.scale)}Ps?(ct.verticalizable=!0,Kr.push({glyph:lo,imageName:Po,x:Bi,y:Sn+na,vertical:Ps,scale:Sr.scale,fontStack:Sr.fontStack,sectionIndex:ia,metrics:mi,rect:oa}),Bi+=_l*Sr.scale+Yr):(Kr.push({glyph:lo,imageName:Po,x:Bi,y:Sn+na,vertical:Ps,scale:Sr.scale,fontStack:Sr.fontStack,sectionIndex:ia,metrics:mi,rect:oa}),Bi+=mi.advance*Sr.scale+Yr)}Kr.length!==0&&(Xi=Math.max(Bi-Yr,Xi),__(Kr,0,Kr.length-1,di,xi)),Bi=0;var Kc=kr*gr+xi;hn.lineOffset=Math.max(xi,Mn),Sn+=Kc,En=Math.max(Kc,En),++Wi}else Sn+=kr,++Wi}var La,_u=Sn- -17,xl=np(Jr),$a=xl.horizontalAlign,wl=xl.verticalAlign;(function(Xc,Wc,gu,vu,Hc,bu,xu,wu,Jc){var kl,Yc=(Wc-gu)*Hc;kl=bu!==xu?-wu*vu- -17:(-vu*Jc+.5)*xu;for(var Sl=0,ku=Xc;Sl<ku.length;Sl+=1)for(var Cs=0,Su=ku[Sl].positionedGlyphs;Cs<Su.length;Cs+=1){var El=Su[Cs];El.x+=Yc,El.y+=kl}})(ct.positionedLines,di,$a,wl,Xi,En,kr,_u,xt.length),ct.top+=-wl*_u,ct.bottom=ct.top+_u,ct.left+=-$a*Xi,ct.right=ct.left+Xi}(Dt,t,i,l,ce,x,S,I,B,A,U,ee),!function(ct){for(var rr=0,Kt=ct;rr<Kt.length;rr+=1)if(Kt[rr].positionedGlyphs.length!==0)return!1;return!0}(Yt)&&Dt}kn.fromFeature=function(e,t){for(var i=new kn,l=0;l<e.sections.length;l++){var p=e.sections[l];p.image?i.addImageSection(p):i.addTextSection(p,t)}return i},kn.prototype.length=function(){return this.text.length},kn.prototype.getSection=function(e){return this.sections[this.sectionIndex[e]]},kn.prototype.getSectionIndex=function(e){return this.sectionIndex[e]},kn.prototype.getCharCode=function(e){return this.text.charCodeAt(e)},kn.prototype.verticalizePunctuation=function(){this.text=function(e){for(var t="",i=0;i<e.length;i++){var l=e.charCodeAt(i+1)||null,p=e.charCodeAt(i-1)||null;t+=l&&Jl(l)&&!hu[e[i+1]]||p&&Jl(p)&&!hu[e[i-1]]||!hu[e[i]]?e[i]:hu[e[i]]}return t}(this.text)},kn.prototype.trim=function(){for(var e=0,t=0;t<this.text.length&&Rc[this.text.charCodeAt(t)];t++)e++;for(var i=this.text.length,l=this.text.length-1;l>=0&&l>=e&&Rc[this.text.charCodeAt(l)];l--)i--;this.text=this.text.substring(e,i),this.sectionIndex=this.sectionIndex.slice(e,i)},kn.prototype.substring=function(e,t){var i=new kn;return i.text=this.text.substring(e,t),i.sectionIndex=this.sectionIndex.slice(e,t),i.sections=this.sections,i},kn.prototype.toString=function(){return this.text},kn.prototype.getMaxScale=function(){var e=this;return this.sectionIndex.reduce(function(t,i){return Math.max(t,e.sections[i].scale)},0)},kn.prototype.addTextSection=function(e,t){this.text+=e.text,this.sections.push(ul.forText(e.scale,e.fontStack||t));for(var i=this.sections.length-1,l=0;l<e.text.length;++l)this.sectionIndex.push(i)},kn.prototype.addImageSection=function(e){var t=e.image?e.image.name:"";if(t.length!==0){var i=this.getNextImageSectionCharCode();i?(this.text+=String.fromCharCode(i),this.sections.push(ul.forImage(t)),this.sectionIndex.push(this.sections.length-1)):yt("Reached maximum number of images 6401")}else yt("Can't add FormattedSection with an empty image.")},kn.prototype.getNextImageSectionCharCode=function(){return this.imageSectionID?this.imageSectionID>=63743?null:++this.imageSectionID:(this.imageSectionID=57344,this.imageSectionID)};var Rc={9:!0,10:!0,11:!0,12:!0,13:!0,32:!0},eo={};function mf(e,t,i,l,p,m){if(t.imageName){var x=l[t.imageName];return x?x.displaySize[0]*t.scale*24/m+p:0}var S=i[t.fontStack],I=S&&S[e];return I?I.metrics.advance*t.scale+p:0}function yf(e,t,i,l){var p=Math.pow(e-t,2);return l?e<t?p/2:2*p:p+Math.abs(i)*i}function y_(e,t,i){var l=0;return e===10&&(l-=1e4),i&&(l+=150),e!==40&&e!==65288||(l+=50),t!==41&&t!==65289||(l+=50),l}function _f(e,t,i,l,p,m){for(var x=null,S=yf(t,i,p,m),I=0,A=l;I<A.length;I+=1){var C=A[I],B=yf(t-C.x,i,p,m)+C.badness;B<=S&&(x=C,S=B)}return{index:e,x:t,priorBreak:x,badness:S}}function ip(e,t,i,l,p,m,x){if(m!=="point")return[];if(!e)return[];for(var S,I=[],A=function(ce,ie,de,be,ke,Ie){for(var Pe=0,Ue=0;Ue<ce.length();Ue++){var He=ce.getSection(Ue);Pe+=mf(ce.getCharCode(Ue),He,be,ke,ie,Ie)}return Pe/Math.max(1,Math.ceil(Pe/de))}(e,t,i,l,p,x),C=e.text.indexOf("​")>=0,B=0,U=0;U<e.length();U++){var q=e.getSection(U),Q=e.getCharCode(U);if(Rc[Q]||(B+=mf(Q,q,l,p,t,x)),U<e.length()-1){var ee=!((S=Q)<11904||!(Qe["Bopomofo Extended"](S)||Qe.Bopomofo(S)||Qe["CJK Compatibility Forms"](S)||Qe["CJK Compatibility Ideographs"](S)||Qe["CJK Compatibility"](S)||Qe["CJK Radicals Supplement"](S)||Qe["CJK Strokes"](S)||Qe["CJK Symbols and Punctuation"](S)||Qe["CJK Unified Ideographs Extension A"](S)||Qe["CJK Unified Ideographs"](S)||Qe["Enclosed CJK Letters and Months"](S)||Qe["Halfwidth and Fullwidth Forms"](S)||Qe.Hiragana(S)||Qe["Ideographic Description Characters"](S)||Qe["Kangxi Radicals"](S)||Qe["Katakana Phonetic Extensions"](S)||Qe.Katakana(S)||Qe["Vertical Forms"](S)||Qe["Yi Radicals"](S)||Qe["Yi Syllables"](S)));(eo[Q]||ee||q.imageName)&&I.push(_f(U+1,B,A,I,y_(Q,e.getCharCode(U+1),ee&&C),!1))}}return function ce(ie){return ie?ce(ie.priorBreak).concat(ie.index):[]}(_f(e.length(),B,A,I,0,!0))}function np(e){var t=.5,i=.5;switch(e){case"right":case"top-right":case"bottom-right":t=1;break;case"left":case"top-left":case"bottom-left":t=0}switch(e){case"bottom":case"bottom-right":case"bottom-left":i=1;break;case"top":case"top-right":case"top-left":i=0}return{horizontalAlign:t,verticalAlign:i}}function __(e,t,i,l,p){if(l||p)for(var m=e[i],x=(e[i].x+m.metrics.advance*m.scale)*l,S=t;S<=i;S++)e[S].x-=x,e[S].y+=p}function gf(e,t,i,l,p,m){var x,S=e.image;if(S.content){var I=S.content,A=S.pixelRatio||1;x=[I[0]/A,I[1]/A,S.displaySize[0]-I[2]/A,S.displaySize[1]-I[3]/A]}var C,B,U,q,Q=t.left*m,ee=t.right*m;i==="width"||i==="both"?(q=p[0]+Q-l[3],B=p[0]+ee+l[1]):B=(q=p[0]+(Q+ee-S.displaySize[0])/2)+S.displaySize[0];var ce=t.top*m,ie=t.bottom*m;return i==="height"||i==="both"?(C=p[1]+ce-l[0],U=p[1]+ie+l[2]):U=(C=p[1]+(ce+ie-S.displaySize[1])/2)+S.displaySize[1],{image:S,top:C,right:B,bottom:U,left:q,collisionPadding:x}}eo[10]=!0,eo[32]=!0,eo[38]=!0,eo[40]=!0,eo[41]=!0,eo[43]=!0,eo[45]=!0,eo[47]=!0,eo[173]=!0,eo[183]=!0,eo[8203]=!0,eo[8208]=!0,eo[8211]=!0,eo[8231]=!0;var cl=function(e){function t(i,l,p,m){e.call(this,i,l),this.angle=p,m!==void 0&&(this.segment=m)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.clone=function(){return new t(this.x,this.y,this.angle,this.segment)},t}(F);function op(e,t){var i=t.expression;if(i.kind==="constant")return{kind:"constant",layoutSize:i.evaluate(new ur(e+1))};if(i.kind==="source")return{kind:"source"};for(var l=i.zoomStops,p=i.interpolationType,m=0;m<l.length&&l[m]<=e;)m++;for(var x=m=Math.max(0,m-1);x<l.length&&l[x]<e+1;)x++;x=Math.min(l.length-1,x);var S=l[m],I=l[x];return i.kind==="composite"?{kind:"composite",minZoom:S,maxZoom:I,interpolationType:p}:{kind:"camera",minZoom:S,maxZoom:I,minSize:i.evaluate(new ur(S)),maxSize:i.evaluate(new ur(I)),interpolationType:p}}function vf(e,t,i){var l=t.uSize,p=i.lowerSize;return e.kind==="source"?p/128:e.kind==="composite"?vi(p/128,i.upperSize/128,t.uSizeT):l}function bf(e,t){var i=0,l=0;if(e.kind==="constant")l=e.layoutSize;else if(e.kind!=="source"){var p=e.interpolationType,m=p?ve(en.interpolationFactor(p,t,e.minZoom,e.maxZoom),0,1):0;e.kind==="camera"?l=vi(e.minSize,e.maxSize,m):i=m}return{uSizeT:i,uSize:l}}st("Anchor",cl);var g_=Object.freeze({__proto__:null,getSizeData:op,evaluateSizeForFeature:vf,evaluateSizeForZoom:bf,SIZE_PACK_FACTOR:128});function xf(e,t,i,l,p){if(t.segment===void 0)return!0;for(var m=t,x=t.segment+1,S=0;S>-i/2;){if(--x<0)return!1;S-=e[x].dist(m),m=e[x]}S+=e[x].dist(e[x+1]),x++;for(var I=[],A=0;S<i/2;){var C=e[x],B=e[x+1];if(!B)return!1;var U=e[x-1].angleTo(C)-C.angleTo(B);for(U=Math.abs((U+3*Math.PI)%(2*Math.PI)-Math.PI),I.push({distance:S,angleDelta:U}),A+=U;S-I[0].distance>l;)A-=I.shift().angleDelta;if(A>p)return!1;x++,S+=C.dist(B)}return!0}function wf(e){for(var t=0,i=0;i<e.length-1;i++)t+=e[i].dist(e[i+1]);return t}function kf(e,t,i){return e?.6*t*i:0}function Sf(e,t){return Math.max(e?e.right-e.left:0,t?t.right-t.left:0)}function v_(e,t,i,l,p,m){for(var x=kf(i,p,m),S=Sf(i,l)*m,I=0,A=wf(e)/2,C=0;C<e.length-1;C++){var B=e[C],U=e[C+1],q=B.dist(U);if(I+q>A){var Q=(A-I)/q,ee=vi(B.x,U.x,Q),ce=vi(B.y,U.y,Q),ie=new cl(ee,ce,U.angleTo(B),C);return ie._round(),!x||xf(e,ie,S,x,t)?ie:void 0}I+=q}}function b_(e,t,i,l,p,m,x,S,I){var A=kf(l,m,x),C=Sf(l,p),B=C*x,U=e[0].x===0||e[0].x===I||e[0].y===0||e[0].y===I;return t-B<t/4&&(t=B+t/4),function q(Q,ee,ce,ie,de,be,ke,Ie,Pe){for(var Ue=be/2,He=wf(Q),ft=0,tt=ee-ce,bt=[],it=0;it<Q.length-1;it++){for(var Yt=Q[it],Dt=Q[it+1],ct=Yt.dist(Dt),rr=Dt.angleTo(Yt);tt+ce<ft+ct;){var Kt=((tt+=ce)-ft)/ct,yr=vi(Yt.x,Dt.x,Kt),xt=vi(Yt.y,Dt.y,Kt);if(yr>=0&&yr<Pe&&xt>=0&&xt<Pe&&tt-Ue>=0&&tt+Ue<=He){var kr=new cl(yr,xt,rr,it);kr._round(),ie&&!xf(Q,kr,be,ie,de)||bt.push(kr)}}ft+=ct}return Ie||bt.length||ke||(bt=q(Q,ft/2,ce,ie,de,be,ke,!0,Pe)),bt}(e,U?t/2*S%t:(C/2+2*m)*x*S%t,t,A,i,B,U,!1,I)}function Ef(e,t,i,l,p){for(var m=[],x=0;x<e.length;x++)for(var S=e[x],I=void 0,A=0;A<S.length-1;A++){var C=S[A],B=S[A+1];C.x<t&&B.x<t||(C.x<t?C=new F(t,C.y+(t-C.x)/(B.x-C.x)*(B.y-C.y))._round():B.x<t&&(B=new F(t,C.y+(t-C.x)/(B.x-C.x)*(B.y-C.y))._round()),C.y<i&&B.y<i||(C.y<i?C=new F(C.x+(i-C.y)/(B.y-C.y)*(B.x-C.x),i)._round():B.y<i&&(B=new F(C.x+(i-C.y)/(B.y-C.y)*(B.x-C.x),i)._round()),C.x>=l&&B.x>=l||(C.x>=l?C=new F(l,C.y+(l-C.x)/(B.x-C.x)*(B.y-C.y))._round():B.x>=l&&(B=new F(l,C.y+(l-C.x)/(B.x-C.x)*(B.y-C.y))._round()),C.y>=p&&B.y>=p||(C.y>=p?C=new F(C.x+(p-C.y)/(B.y-C.y)*(B.x-C.x),p)._round():B.y>=p&&(B=new F(C.x+(p-C.y)/(B.y-C.y)*(B.x-C.x),p)._round()),I&&C.equals(I[I.length-1])||m.push(I=[C]),I.push(B)))))}return m}function Tf(e,t,i,l){var p=[],m=e.image,x=m.pixelRatio,S=m.paddedRect.w-2,I=m.paddedRect.h-2,A=e.right-e.left,C=e.bottom-e.top,B=m.stretchX||[[0,S]],U=m.stretchY||[[0,I]],q=function(yr,xt){return yr+xt[1]-xt[0]},Q=B.reduce(q,0),ee=U.reduce(q,0),ce=S-Q,ie=I-ee,de=0,be=Q,ke=0,Ie=ee,Pe=0,Ue=ce,He=0,ft=ie;if(m.content&&l){var tt=m.content;de=Bc(B,0,tt[0]),ke=Bc(U,0,tt[1]),be=Bc(B,tt[0],tt[2]),Ie=Bc(U,tt[1],tt[3]),Pe=tt[0]-de,He=tt[1]-ke,Ue=tt[2]-tt[0]-be,ft=tt[3]-tt[1]-Ie}var bt=function(yr,xt,kr,Jr){var li=Oc(yr.stretch-de,be,A,e.left),ii=Fc(yr.fixed-Pe,Ue,yr.stretch,Q),Yr=Oc(xt.stretch-ke,Ie,C,e.top),ui=Fc(xt.fixed-He,ft,xt.stretch,ee),Ri=Oc(kr.stretch-de,be,A,e.left),Bi=Fc(kr.fixed-Pe,Ue,kr.stretch,Q),Sn=Oc(Jr.stretch-ke,Ie,C,e.top),Xi=Fc(Jr.fixed-He,ft,Jr.stretch,ee),En=new F(li,Yr),di=new F(Ri,Yr),Wi=new F(Ri,Sn),pr=new F(li,Sn),Or=new F(ii/x,ui/x),Mr=new F(Bi/x,Xi/x),gr=t*Math.PI/180;if(gr){var Mn=Math.sin(gr),hn=Math.cos(gr),Kr=[hn,-Mn,Mn,hn];En._matMult(Kr),di._matMult(Kr),pr._matMult(Kr),Wi._matMult(Kr)}var xi=yr.stretch+yr.fixed,pn=xt.stretch+xt.fixed;return{tl:En,tr:di,bl:pr,br:Wi,tex:{x:m.paddedRect.x+1+xi,y:m.paddedRect.y+1+pn,w:kr.stretch+kr.fixed-xi,h:Jr.stretch+Jr.fixed-pn},writingMode:void 0,glyphOffset:[0,0],sectionIndex:0,pixelOffsetTL:Or,pixelOffsetBR:Mr,minFontScaleX:Ue/x/A,minFontScaleY:ft/x/C,isSDF:i}};if(l&&(m.stretchX||m.stretchY))for(var it=If(B,ce,Q),Yt=If(U,ie,ee),Dt=0;Dt<it.length-1;Dt++)for(var ct=it[Dt],rr=it[Dt+1],Kt=0;Kt<Yt.length-1;Kt++)p.push(bt(ct,Yt[Kt],rr,Yt[Kt+1]));else p.push(bt({fixed:0,stretch:-1},{fixed:0,stretch:-1},{fixed:0,stretch:S+1},{fixed:0,stretch:I+1}));return p}function Bc(e,t,i){for(var l=0,p=0,m=e;p<m.length;p+=1){var x=m[p];l+=Math.max(t,Math.min(i,x[1]))-Math.max(t,Math.min(i,x[0]))}return l}function If(e,t,i){for(var l=[{fixed:-1,stretch:0}],p=0,m=e;p<m.length;p+=1){var x=m[p],S=x[0],I=x[1],A=l[l.length-1];l.push({fixed:S-A.stretch,stretch:A.stretch}),l.push({fixed:S-A.stretch,stretch:A.stretch+(I-S)})}return l.push({fixed:t+1,stretch:i}),l}function Oc(e,t,i,l){return e/t*i+l}function Fc(e,t,i,l){return e-t*i/l}var Nc=function(e,t,i,l,p,m,x,S,I,A){if(this.boxStartIndex=e.length,I){var C=m.top,B=m.bottom,U=m.collisionPadding;U&&(C-=U[1],B+=U[3]);var q=B-C;q>0&&(q=Math.max(10,q),this.circleDiameter=q)}else{var Q=m.top*x-S,ee=m.bottom*x+S,ce=m.left*x-S,ie=m.right*x+S,de=m.collisionPadding;if(de&&(ce-=de[0]*x,Q-=de[1]*x,ie+=de[2]*x,ee+=de[3]*x),A){var be=new F(ce,Q),ke=new F(ie,Q),Ie=new F(ce,ee),Pe=new F(ie,ee),Ue=A*Math.PI/180;be._rotate(Ue),ke._rotate(Ue),Ie._rotate(Ue),Pe._rotate(Ue),ce=Math.min(be.x,ke.x,Ie.x,Pe.x),ie=Math.max(be.x,ke.x,Ie.x,Pe.x),Q=Math.min(be.y,ke.y,Ie.y,Pe.y),ee=Math.max(be.y,ke.y,Ie.y,Pe.y)}e.emplaceBack(t.x,t.y,ce,Q,ie,ee,i,l,p)}this.boxEndIndex=e.length},hl=function(e,t){if(e===void 0&&(e=[]),t===void 0&&(t=x_),this.data=e,this.length=this.data.length,this.compare=t,this.length>0)for(var i=(this.length>>1)-1;i>=0;i--)this._down(i)};function x_(e,t){return e<t?-1:e>t?1:0}function w_(e,t,i){t===void 0&&(t=1),i===void 0&&(i=!1);for(var l=1/0,p=1/0,m=-1/0,x=-1/0,S=e[0],I=0;I<S.length;I++){var A=S[I];(!I||A.x<l)&&(l=A.x),(!I||A.y<p)&&(p=A.y),(!I||A.x>m)&&(m=A.x),(!I||A.y>x)&&(x=A.y)}var C=Math.min(m-l,x-p),B=C/2,U=new hl([],k_);if(C===0)return new F(l,p);for(var q=l;q<m;q+=C)for(var Q=p;Q<x;Q+=C)U.push(new pl(q+B,Q+B,B,e));for(var ee=function(de){for(var be=0,ke=0,Ie=0,Pe=de[0],Ue=0,He=Pe.length,ft=He-1;Ue<He;ft=Ue++){var tt=Pe[Ue],bt=Pe[ft],it=tt.x*bt.y-bt.x*tt.y;ke+=(tt.x+bt.x)*it,Ie+=(tt.y+bt.y)*it,be+=3*it}return new pl(ke/be,Ie/be,0,de)}(e),ce=U.length;U.length;){var ie=U.pop();(ie.d>ee.d||!ee.d)&&(ee=ie,i&&console.log("found best %d after %d probes",Math.round(1e4*ie.d)/1e4,ce)),ie.max-ee.d<=t||(U.push(new pl(ie.p.x-(B=ie.h/2),ie.p.y-B,B,e)),U.push(new pl(ie.p.x+B,ie.p.y-B,B,e)),U.push(new pl(ie.p.x-B,ie.p.y+B,B,e)),U.push(new pl(ie.p.x+B,ie.p.y+B,B,e)),ce+=4)}return i&&(console.log("num probes: "+ce),console.log("best distance: "+ee.d)),ee.p}function k_(e,t){return t.max-e.max}function pl(e,t,i,l){this.p=new F(e,t),this.h=i,this.d=function(p,m){for(var x=!1,S=1/0,I=0;I<m.length;I++)for(var A=m[I],C=0,B=A.length,U=B-1;C<B;U=C++){var q=A[C],Q=A[U];q.y>p.y!=Q.y>p.y&&p.x<(Q.x-q.x)*(p.y-q.y)/(Q.y-q.y)+q.x&&(x=!x),S=Math.min(S,Ha(p,q,Q))}return(x?1:-1)*Math.sqrt(S)}(this.p,l),this.max=this.d+this.h*Math.SQRT2}hl.prototype.push=function(e){this.data.push(e),this.length++,this._up(this.length-1)},hl.prototype.pop=function(){if(this.length!==0){var e=this.data[0],t=this.data.pop();return this.length--,this.length>0&&(this.data[0]=t,this._down(0)),e}},hl.prototype.peek=function(){return this.data[0]},hl.prototype._up=function(e){for(var t=this.data,i=this.compare,l=t[e];e>0;){var p=e-1>>1,m=t[p];if(i(l,m)>=0)break;t[e]=m,e=p}t[e]=l},hl.prototype._down=function(e){for(var t=this.data,i=this.compare,l=this.length>>1,p=t[e];e<l;){var m=1+(e<<1),x=t[m],S=m+1;if(S<this.length&&i(t[S],x)<0&&(m=S,x=t[S]),i(x,p)>=0)break;t[e]=x,e=m}t[e]=p};var ap=Number.POSITIVE_INFINITY;function zf(e,t){return t[1]!==ap?function(i,l,p){var m=0,x=0;switch(l=Math.abs(l),p=Math.abs(p),i){case"top-right":case"top-left":case"top":x=p-7;break;case"bottom-right":case"bottom-left":case"bottom":x=7-p}switch(i){case"top-right":case"bottom-right":case"right":m=-l;break;case"top-left":case"bottom-left":case"left":m=l}return[m,x]}(e,t[0],t[1]):function(i,l){var p=0,m=0;l<0&&(l=0);var x=l/Math.sqrt(2);switch(i){case"top-right":case"top-left":m=x-7;break;case"bottom-right":case"bottom-left":m=7-x;break;case"bottom":m=7-l;break;case"top":m=l-7}switch(i){case"top-right":case"bottom-right":p=-x;break;case"top-left":case"bottom-left":p=x;break;case"left":p=l;break;case"right":p=-l}return[p,m]}(e,t[0])}function sp(e){switch(e){case"right":case"top-right":case"bottom-right":return"right";case"left":case"top-left":case"bottom-left":return"left"}return"center"}function Af(e,t,i,l,p,m,x,S,I,A,C,B,U,q,Q){var ee=function(ke,Ie,Pe,Ue,He,ft,tt,bt){for(var it=Ue.layout.get("text-rotate").evaluate(ft,{})*Math.PI/180,Yt=[],Dt=0,ct=Ie.positionedLines;Dt<ct.length;Dt+=1)for(var rr=ct[Dt],Kt=0,yr=rr.positionedGlyphs;Kt<yr.length;Kt+=1){var xt=yr[Kt];if(xt.rect){var kr=xt.rect||{},Jr=4,li=!0,ii=1,Yr=0,ui=(He||bt)&&xt.vertical,Ri=xt.metrics.advance*xt.scale/2;if(bt&&Ie.verticalizable&&(Yr=rr.lineOffset/2-(xt.imageName?-(24-xt.metrics.width*xt.scale)/2:24*(xt.scale-1))),xt.imageName){var Bi=tt[xt.imageName];li=Bi.sdf,Jr=1/(ii=Bi.pixelRatio)}var Sn=He?[xt.x+Ri,xt.y]:[0,0],Xi=He?[0,0]:[xt.x+Ri+Pe[0],xt.y+Pe[1]-Yr],En=[0,0];ui&&(En=Xi,Xi=[0,0]);var di=(xt.metrics.left-Jr)*xt.scale-Ri+Xi[0],Wi=(-xt.metrics.top-Jr)*xt.scale+Xi[1],pr=di+kr.w*xt.scale/ii,Or=Wi+kr.h*xt.scale/ii,Mr=new F(di,Wi),gr=new F(pr,Wi),Mn=new F(di,Or),hn=new F(pr,Or);if(ui){var Kr=new F(-Ri,Ri- -17),xi=-Math.PI/2,pn=12-Ri,Sr=new F(22-pn,-(xt.imageName?pn:0)),ia=new(Function.prototype.bind.apply(F,[null].concat(En)));Mr._rotateAround(xi,Kr)._add(Sr)._add(ia),gr._rotateAround(xi,Kr)._add(Sr)._add(ia),Mn._rotateAround(xi,Kr)._add(Sr)._add(ia),hn._rotateAround(xi,Kr)._add(Sr)._add(ia)}if(it){var lo=Math.sin(it),na=Math.cos(it),mi=[na,-lo,lo,na];Mr._matMult(mi),gr._matMult(mi),Mn._matMult(mi),hn._matMult(mi)}var oa=new F(0,0),Po=new F(0,0);Yt.push({tl:Mr,tr:gr,bl:Mn,br:hn,tex:kr,writingMode:Ie.writingMode,glyphOffset:Sn,sectionIndex:xt.sectionIndex,isSDF:li,pixelOffsetTL:oa,pixelOffsetBR:Po,minFontScaleX:0,minFontScaleY:0})}}return Yt}(0,i,S,p,m,x,l,e.allowVerticalPlacement),ce=e.textSizeData,ie=null;ce.kind==="source"?(ie=[128*p.layout.get("text-size").evaluate(x,{})])[0]>32640&&yt(e.layerIds[0]+': Value for "text-size" is >= 255. Reduce your "text-size".'):ce.kind==="composite"&&((ie=[128*q.compositeTextSizes[0].evaluate(x,{},Q),128*q.compositeTextSizes[1].evaluate(x,{},Q)])[0]>32640||ie[1]>32640)&&yt(e.layerIds[0]+': Value for "text-size" is >= 255. Reduce your "text-size".'),e.addSymbols(e.text,ee,ie,S,m,x,A,t,I.lineStartIndex,I.lineLength,U,Q);for(var de=0,be=C;de<be.length;de+=1)B[be[de]]=e.text.placedSymbolArray.length-1;return 4*ee.length}function Pf(e){for(var t in e)return e[t];return null}function S_(e,t,i,l){var p=e.compareText;if(t in p){for(var m=p[t],x=m.length-1;x>=0;x--)if(l.dist(m[x])<i)return!0}else p[t]=[];return p[t].push(l),!1}var E_=al.VectorTileFeature.types,T_=[{name:"a_fade_opacity",components:1,type:"Uint8",offset:0}];function Uc(e,t,i,l,p,m,x,S,I,A,C,B,U){var q=S?Math.min(32640,Math.round(S[0])):0,Q=S?Math.min(32640,Math.round(S[1])):0;e.emplaceBack(t,i,Math.round(32*l),Math.round(32*p),m,x,(q<<1)+(I?1:0),Q,16*A,16*C,256*B,256*U)}function lp(e,t,i){e.emplaceBack(t.x,t.y,i),e.emplaceBack(t.x,t.y,i),e.emplaceBack(t.x,t.y,i),e.emplaceBack(t.x,t.y,i)}function I_(e){for(var t=0,i=e.sections;t<i.length;t+=1)if(Hs(i[t].text))return!0;return!1}var fl=function(e){this.layoutVertexArray=new $s,this.indexArray=new Yo,this.programConfigurations=e,this.segments=new G,this.dynamicLayoutVertexArray=new Ka,this.opacityVertexArray=new bs,this.placedSymbolArray=new u};fl.prototype.isEmpty=function(){return this.layoutVertexArray.length===0&&this.indexArray.length===0&&this.dynamicLayoutVertexArray.length===0&&this.opacityVertexArray.length===0},fl.prototype.upload=function(e,t,i,l){this.isEmpty()||(i&&(this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,$y.members),this.indexBuffer=e.createIndexBuffer(this.indexArray,t),this.dynamicLayoutVertexBuffer=e.createVertexBuffer(this.dynamicLayoutVertexArray,e_.members,!0),this.opacityVertexBuffer=e.createVertexBuffer(this.opacityVertexArray,T_,!0),this.opacityVertexBuffer.itemSize=1),(i||l)&&this.programConfigurations.upload(e))},fl.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.dynamicLayoutVertexBuffer.destroy(),this.opacityVertexBuffer.destroy())},st("SymbolBuffers",fl);var du=function(e,t,i){this.layoutVertexArray=new e,this.layoutAttributes=t,this.indexArray=new i,this.segments=new G,this.collisionVertexArray=new ru};du.prototype.upload=function(e){this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,this.layoutAttributes),this.indexBuffer=e.createIndexBuffer(this.indexArray),this.collisionVertexBuffer=e.createVertexBuffer(this.collisionVertexArray,t_.members,!0)},du.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.collisionVertexBuffer.destroy())},st("CollisionBuffers",du);var Rr=function(e){this.collisionBoxArray=e.collisionBoxArray,this.zoom=e.zoom,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map(function(m){return m.id}),this.index=e.index,this.pixelRatio=e.pixelRatio,this.sourceLayerIndex=e.sourceLayerIndex,this.hasPattern=!1,this.hasRTLText=!1,this.sortKeyRanges=[],this.collisionCircleArray=[],this.placementInvProjMatrix=$n([]),this.placementViewportMatrix=$n([]);var t=this.layers[0]._unevaluatedLayout._values;this.textSizeData=op(this.zoom,t["text-size"]),this.iconSizeData=op(this.zoom,t["icon-size"]);var i=this.layers[0].layout,l=i.get("symbol-sort-key"),p=i.get("symbol-z-order");this.canOverlap=i.get("text-allow-overlap")||i.get("icon-allow-overlap")||i.get("text-ignore-placement")||i.get("icon-ignore-placement"),this.sortFeaturesByKey=p!=="viewport-y"&&l.constantOr(1)!==void 0,this.sortFeaturesByY=(p==="viewport-y"||p==="auto"&&!this.sortFeaturesByKey)&&this.canOverlap,i.get("symbol-placement")==="point"&&(this.writingModes=i.get("text-writing-mode").map(function(m){return so[m]})),this.stateDependentLayerIds=this.layers.filter(function(m){return m.isStateDependent()}).map(function(m){return m.id}),this.sourceID=e.sourceID};Rr.prototype.createArrays=function(){this.text=new fl(new Ct(this.layers,this.zoom,function(e){return/^text/.test(e)})),this.icon=new fl(new Ct(this.layers,this.zoom,function(e){return/^icon/.test(e)})),this.glyphOffsetArray=new k,this.lineVertexArray=new E,this.symbolInstances=new w},Rr.prototype.calculateGlyphDependencies=function(e,t,i,l,p){for(var m=0;m<e.length;m++)if(t[e.charCodeAt(m)]=!0,(i||l)&&p){var x=hu[e.charAt(m)];x&&(t[x.charCodeAt(0)]=!0)}},Rr.prototype.populate=function(e,t,i){var l=this.layers[0],p=l.layout,m=p.get("text-font"),x=p.get("text-field"),S=p.get("icon-image"),I=(x.value.kind!=="constant"||x.value.value instanceof wr&&!x.value.value.isEmpty()||x.value.value.toString().length>0)&&(m.value.kind!=="constant"||m.value.value.length>0),A=S.value.kind!=="constant"||!!S.value.value||Object.keys(S.parameters).length>0,C=p.get("symbol-sort-key");if(this.features=[],I||A){for(var B=t.iconDependencies,U=t.glyphDependencies,q=t.availableImages,Q=new ur(this.zoom),ee=0,ce=e;ee<ce.length;ee+=1){var ie=ce[ee],de=ie.feature,be=ie.id,ke=ie.index,Ie=ie.sourceLayerIndex,Pe=l._featureFilter.needGeometry,Ue=fi(de,Pe);if(l._featureFilter.filter(Q,Ue,i)){Pe||(Ue.geometry=ri(de));var He=void 0;if(I){var ft=l.getValueAndResolveTokens("text-field",Ue,i,q),tt=wr.factory(ft);I_(tt)&&(this.hasRTLText=!0),(!this.hasRTLText||Ql()==="unavailable"||this.hasRTLText&&Qn.isParsed())&&(He=i_(tt,l,Ue))}var bt=void 0;if(A){var it=l.getValueAndResolveTokens("icon-image",Ue,i,q);bt=it instanceof Mi?it:Mi.fromString(it)}if(He||bt){var Yt=this.sortFeaturesByKey?C.evaluate(Ue,{},i):void 0;if(this.features.push({id:be,text:He,icon:bt,index:ke,sourceLayerIndex:Ie,geometry:Ue.geometry,properties:de.properties,type:E_[de.type],sortKey:Yt}),bt&&(B[bt.name]=!0),He){var Dt=m.evaluate(Ue,{},i).join(","),ct=p.get("text-rotation-alignment")==="map"&&p.get("symbol-placement")!=="point";this.allowVerticalPlacement=this.writingModes&&this.writingModes.indexOf(so.vertical)>=0;for(var rr=0,Kt=He.sections;rr<Kt.length;rr+=1){var yr=Kt[rr];if(yr.image)B[yr.image.name]=!0;else{var xt=Hl(He.toString()),kr=yr.fontStack||Dt,Jr=U[kr]=U[kr]||{};this.calculateGlyphDependencies(yr.text,Jr,ct,this.allowVerticalPlacement,xt)}}}}}}p.get("symbol-placement")==="line"&&(this.features=function(li){var ii={},Yr={},ui=[],Ri=0;function Bi(Kr){ui.push(li[Kr]),Ri++}function Sn(Kr,xi,pn){var Sr=Yr[Kr];return delete Yr[Kr],Yr[xi]=Sr,ui[Sr].geometry[0].pop(),ui[Sr].geometry[0]=ui[Sr].geometry[0].concat(pn[0]),Sr}function Xi(Kr,xi,pn){var Sr=ii[xi];return delete ii[xi],ii[Kr]=Sr,ui[Sr].geometry[0].shift(),ui[Sr].geometry[0]=pn[0].concat(ui[Sr].geometry[0]),Sr}function En(Kr,xi,pn){var Sr=pn?xi[0][xi[0].length-1]:xi[0][0];return Kr+":"+Sr.x+":"+Sr.y}for(var di=0;di<li.length;di++){var Wi=li[di],pr=Wi.geometry,Or=Wi.text?Wi.text.toString():null;if(Or){var Mr=En(Or,pr),gr=En(Or,pr,!0);if(Mr in Yr&&gr in ii&&Yr[Mr]!==ii[gr]){var Mn=Xi(Mr,gr,pr),hn=Sn(Mr,gr,ui[Mn].geometry);delete ii[Mr],delete Yr[gr],Yr[En(Or,ui[hn].geometry,!0)]=hn,ui[Mn].geometry=null}else Mr in Yr?Sn(Mr,gr,pr):gr in ii?Xi(Mr,gr,pr):(Bi(di),ii[Mr]=Ri-1,Yr[gr]=Ri-1)}else Bi(di)}return ui.filter(function(Kr){return Kr.geometry})}(this.features)),this.sortFeaturesByKey&&this.features.sort(function(li,ii){return li.sortKey-ii.sortKey})}},Rr.prototype.update=function(e,t,i){this.stateDependentLayers.length&&(this.text.programConfigurations.updatePaintArrays(e,t,this.layers,i),this.icon.programConfigurations.updatePaintArrays(e,t,this.layers,i))},Rr.prototype.isEmpty=function(){return this.symbolInstances.length===0&&!this.hasRTLText},Rr.prototype.uploadPending=function(){return!this.uploaded||this.text.programConfigurations.needsUpload||this.icon.programConfigurations.needsUpload},Rr.prototype.upload=function(e){!this.uploaded&&this.hasDebugData()&&(this.textCollisionBox.upload(e),this.iconCollisionBox.upload(e)),this.text.upload(e,this.sortFeaturesByY,!this.uploaded,this.text.programConfigurations.needsUpload),this.icon.upload(e,this.sortFeaturesByY,!this.uploaded,this.icon.programConfigurations.needsUpload),this.uploaded=!0},Rr.prototype.destroyDebugData=function(){this.textCollisionBox.destroy(),this.iconCollisionBox.destroy()},Rr.prototype.destroy=function(){this.text.destroy(),this.icon.destroy(),this.hasDebugData()&&this.destroyDebugData()},Rr.prototype.addToLineVertexArray=function(e,t){var i=this.lineVertexArray.length;if(e.segment!==void 0){for(var l=e.dist(t[e.segment+1]),p=e.dist(t[e.segment]),m={},x=e.segment+1;x<t.length;x++)m[x]={x:t[x].x,y:t[x].y,tileUnitDistanceFromAnchor:l},x<t.length-1&&(l+=t[x+1].dist(t[x]));for(var S=e.segment||0;S>=0;S--)m[S]={x:t[S].x,y:t[S].y,tileUnitDistanceFromAnchor:p},S>0&&(p+=t[S-1].dist(t[S]));for(var I=0;I<t.length;I++){var A=m[I];this.lineVertexArray.emplaceBack(A.x,A.y,A.tileUnitDistanceFromAnchor)}}return{lineStartIndex:i,lineLength:this.lineVertexArray.length-i}},Rr.prototype.addSymbols=function(e,t,i,l,p,m,x,S,I,A,C,B){for(var U=e.indexArray,q=e.layoutVertexArray,Q=e.segments.prepareSegment(4*t.length,q,U,this.canOverlap?m.sortKey:void 0),ee=this.glyphOffsetArray.length,ce=Q.vertexLength,ie=this.allowVerticalPlacement&&x===so.vertical?Math.PI/2:0,de=m.text&&m.text.sections,be=0;be<t.length;be++){var ke=t[be],Ie=ke.tl,Pe=ke.tr,Ue=ke.bl,He=ke.br,ft=ke.tex,tt=ke.pixelOffsetTL,bt=ke.pixelOffsetBR,it=ke.minFontScaleX,Yt=ke.minFontScaleY,Dt=ke.glyphOffset,ct=ke.isSDF,rr=ke.sectionIndex,Kt=Q.vertexLength,yr=Dt[1];Uc(q,S.x,S.y,Ie.x,yr+Ie.y,ft.x,ft.y,i,ct,tt.x,tt.y,it,Yt),Uc(q,S.x,S.y,Pe.x,yr+Pe.y,ft.x+ft.w,ft.y,i,ct,bt.x,tt.y,it,Yt),Uc(q,S.x,S.y,Ue.x,yr+Ue.y,ft.x,ft.y+ft.h,i,ct,tt.x,bt.y,it,Yt),Uc(q,S.x,S.y,He.x,yr+He.y,ft.x+ft.w,ft.y+ft.h,i,ct,bt.x,bt.y,it,Yt),lp(e.dynamicLayoutVertexArray,S,ie),U.emplaceBack(Kt,Kt+1,Kt+2),U.emplaceBack(Kt+1,Kt+2,Kt+3),Q.vertexLength+=4,Q.primitiveLength+=2,this.glyphOffsetArray.emplaceBack(Dt[0]),be!==t.length-1&&rr===t[be+1].sectionIndex||e.programConfigurations.populatePaintArrays(q.length,m,m.index,{},B,de&&de[rr])}e.placedSymbolArray.emplaceBack(S.x,S.y,ee,this.glyphOffsetArray.length-ee,ce,I,A,S.segment,i?i[0]:0,i?i[1]:0,l[0],l[1],x,0,!1,0,C)},Rr.prototype._addCollisionDebugVertex=function(e,t,i,l,p,m){return t.emplaceBack(0,0),e.emplaceBack(i.x,i.y,l,p,Math.round(m.x),Math.round(m.y))},Rr.prototype.addCollisionDebugVertices=function(e,t,i,l,p,m,x){var S=p.segments.prepareSegment(4,p.layoutVertexArray,p.indexArray),I=S.vertexLength,A=p.layoutVertexArray,C=p.collisionVertexArray,B=x.anchorX,U=x.anchorY;this._addCollisionDebugVertex(A,C,m,B,U,new F(e,t)),this._addCollisionDebugVertex(A,C,m,B,U,new F(i,t)),this._addCollisionDebugVertex(A,C,m,B,U,new F(i,l)),this._addCollisionDebugVertex(A,C,m,B,U,new F(e,l)),S.vertexLength+=4;var q=p.indexArray;q.emplaceBack(I,I+1),q.emplaceBack(I+1,I+2),q.emplaceBack(I+2,I+3),q.emplaceBack(I+3,I),S.primitiveLength+=4},Rr.prototype.addDebugCollisionBoxes=function(e,t,i,l){for(var p=e;p<t;p++){var m=this.collisionBoxArray.get(p);this.addCollisionDebugVertices(m.x1,m.y1,m.x2,m.y2,l?this.textCollisionBox:this.iconCollisionBox,m.anchorPoint,i)}},Rr.prototype.generateCollisionDebugBuffers=function(){this.hasDebugData()&&this.destroyDebugData(),this.textCollisionBox=new du(Xa,lf.members,xs),this.iconCollisionBox=new du(Xa,lf.members,xs);for(var e=0;e<this.symbolInstances.length;e++){var t=this.symbolInstances.get(e);this.addDebugCollisionBoxes(t.textBoxStartIndex,t.textBoxEndIndex,t,!0),this.addDebugCollisionBoxes(t.verticalTextBoxStartIndex,t.verticalTextBoxEndIndex,t,!0),this.addDebugCollisionBoxes(t.iconBoxStartIndex,t.iconBoxEndIndex,t,!1),this.addDebugCollisionBoxes(t.verticalIconBoxStartIndex,t.verticalIconBoxEndIndex,t,!1)}},Rr.prototype._deserializeCollisionBoxesForSymbol=function(e,t,i,l,p,m,x,S,I){for(var A={},C=t;C<i;C++){var B=e.get(C);A.textBox={x1:B.x1,y1:B.y1,x2:B.x2,y2:B.y2,anchorPointX:B.anchorPointX,anchorPointY:B.anchorPointY},A.textFeatureIndex=B.featureIndex;break}for(var U=l;U<p;U++){var q=e.get(U);A.verticalTextBox={x1:q.x1,y1:q.y1,x2:q.x2,y2:q.y2,anchorPointX:q.anchorPointX,anchorPointY:q.anchorPointY},A.verticalTextFeatureIndex=q.featureIndex;break}for(var Q=m;Q<x;Q++){var ee=e.get(Q);A.iconBox={x1:ee.x1,y1:ee.y1,x2:ee.x2,y2:ee.y2,anchorPointX:ee.anchorPointX,anchorPointY:ee.anchorPointY},A.iconFeatureIndex=ee.featureIndex;break}for(var ce=S;ce<I;ce++){var ie=e.get(ce);A.verticalIconBox={x1:ie.x1,y1:ie.y1,x2:ie.x2,y2:ie.y2,anchorPointX:ie.anchorPointX,anchorPointY:ie.anchorPointY},A.verticalIconFeatureIndex=ie.featureIndex;break}return A},Rr.prototype.deserializeCollisionBoxes=function(e){this.collisionArrays=[];for(var t=0;t<this.symbolInstances.length;t++){var i=this.symbolInstances.get(t);this.collisionArrays.push(this._deserializeCollisionBoxesForSymbol(e,i.textBoxStartIndex,i.textBoxEndIndex,i.verticalTextBoxStartIndex,i.verticalTextBoxEndIndex,i.iconBoxStartIndex,i.iconBoxEndIndex,i.verticalIconBoxStartIndex,i.verticalIconBoxEndIndex))}},Rr.prototype.hasTextData=function(){return this.text.segments.get().length>0},Rr.prototype.hasIconData=function(){return this.icon.segments.get().length>0},Rr.prototype.hasDebugData=function(){return this.textCollisionBox&&this.iconCollisionBox},Rr.prototype.hasTextCollisionBoxData=function(){return this.hasDebugData()&&this.textCollisionBox.segments.get().length>0},Rr.prototype.hasIconCollisionBoxData=function(){return this.hasDebugData()&&this.iconCollisionBox.segments.get().length>0},Rr.prototype.addIndicesForPlacedSymbol=function(e,t){for(var i=e.placedSymbolArray.get(t),l=i.vertexStartIndex+4*i.numGlyphs,p=i.vertexStartIndex;p<l;p+=4)e.indexArray.emplaceBack(p,p+1,p+2),e.indexArray.emplaceBack(p+1,p+2,p+3)},Rr.prototype.getSortedSymbolIndexes=function(e){if(this.sortedAngle===e&&this.symbolInstanceIndexes!==void 0)return this.symbolInstanceIndexes;for(var t=Math.sin(e),i=Math.cos(e),l=[],p=[],m=[],x=0;x<this.symbolInstances.length;++x){m.push(x);var S=this.symbolInstances.get(x);l.push(0|Math.round(t*S.anchorX+i*S.anchorY)),p.push(S.featureIndex)}return m.sort(function(I,A){return l[I]-l[A]||p[A]-p[I]}),m},Rr.prototype.addToSortKeyRanges=function(e,t){var i=this.sortKeyRanges[this.sortKeyRanges.length-1];i&&i.sortKey===t?i.symbolInstanceEnd=e+1:this.sortKeyRanges.push({sortKey:t,symbolInstanceStart:e,symbolInstanceEnd:e+1})},Rr.prototype.sortFeatures=function(e){var t=this;if(this.sortFeaturesByY&&this.sortedAngle!==e&&!(this.text.segments.get().length>1||this.icon.segments.get().length>1)){this.symbolInstanceIndexes=this.getSortedSymbolIndexes(e),this.sortedAngle=e,this.text.indexArray.clear(),this.icon.indexArray.clear(),this.featureSortOrder=[];for(var i=0,l=this.symbolInstanceIndexes;i<l.length;i+=1){var p=this.symbolInstances.get(l[i]);this.featureSortOrder.push(p.featureIndex),[p.rightJustifiedTextSymbolIndex,p.centerJustifiedTextSymbolIndex,p.leftJustifiedTextSymbolIndex].forEach(function(m,x,S){m>=0&&S.indexOf(m)===x&&t.addIndicesForPlacedSymbol(t.text,m)}),p.verticalPlacedTextSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.text,p.verticalPlacedTextSymbolIndex),p.placedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,p.placedIconSymbolIndex),p.verticalPlacedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,p.verticalPlacedIconSymbolIndex)}this.text.indexBuffer&&this.text.indexBuffer.updateData(this.text.indexArray),this.icon.indexBuffer&&this.icon.indexBuffer.updateData(this.icon.indexArray)}},st("SymbolBucket",Rr,{omit:["layers","collisionBoxArray","features","compareText"]}),Rr.MAX_GLYPHS=65535,Rr.addDynamicAttributes=lp;var z_=new rn({"symbol-placement":new gt(j.layout_symbol["symbol-placement"]),"symbol-spacing":new gt(j.layout_symbol["symbol-spacing"]),"symbol-avoid-edges":new gt(j.layout_symbol["symbol-avoid-edges"]),"symbol-sort-key":new ut(j.layout_symbol["symbol-sort-key"]),"symbol-z-order":new gt(j.layout_symbol["symbol-z-order"]),"icon-allow-overlap":new gt(j.layout_symbol["icon-allow-overlap"]),"icon-ignore-placement":new gt(j.layout_symbol["icon-ignore-placement"]),"icon-optional":new gt(j.layout_symbol["icon-optional"]),"icon-rotation-alignment":new gt(j.layout_symbol["icon-rotation-alignment"]),"icon-size":new ut(j.layout_symbol["icon-size"]),"icon-text-fit":new gt(j.layout_symbol["icon-text-fit"]),"icon-text-fit-padding":new gt(j.layout_symbol["icon-text-fit-padding"]),"icon-image":new ut(j.layout_symbol["icon-image"]),"icon-rotate":new ut(j.layout_symbol["icon-rotate"]),"icon-padding":new gt(j.layout_symbol["icon-padding"]),"icon-keep-upright":new gt(j.layout_symbol["icon-keep-upright"]),"icon-offset":new ut(j.layout_symbol["icon-offset"]),"icon-anchor":new ut(j.layout_symbol["icon-anchor"]),"icon-pitch-alignment":new gt(j.layout_symbol["icon-pitch-alignment"]),"text-pitch-alignment":new gt(j.layout_symbol["text-pitch-alignment"]),"text-rotation-alignment":new gt(j.layout_symbol["text-rotation-alignment"]),"text-field":new ut(j.layout_symbol["text-field"]),"text-font":new ut(j.layout_symbol["text-font"]),"text-size":new ut(j.layout_symbol["text-size"]),"text-max-width":new ut(j.layout_symbol["text-max-width"]),"text-line-height":new gt(j.layout_symbol["text-line-height"]),"text-letter-spacing":new ut(j.layout_symbol["text-letter-spacing"]),"text-justify":new ut(j.layout_symbol["text-justify"]),"text-radial-offset":new ut(j.layout_symbol["text-radial-offset"]),"text-variable-anchor":new gt(j.layout_symbol["text-variable-anchor"]),"text-anchor":new ut(j.layout_symbol["text-anchor"]),"text-max-angle":new gt(j.layout_symbol["text-max-angle"]),"text-writing-mode":new gt(j.layout_symbol["text-writing-mode"]),"text-rotate":new ut(j.layout_symbol["text-rotate"]),"text-padding":new gt(j.layout_symbol["text-padding"]),"text-keep-upright":new gt(j.layout_symbol["text-keep-upright"]),"text-transform":new ut(j.layout_symbol["text-transform"]),"text-offset":new ut(j.layout_symbol["text-offset"]),"text-allow-overlap":new gt(j.layout_symbol["text-allow-overlap"]),"text-ignore-placement":new gt(j.layout_symbol["text-ignore-placement"]),"text-optional":new gt(j.layout_symbol["text-optional"])}),up={paint:new rn({"icon-opacity":new ut(j.paint_symbol["icon-opacity"]),"icon-color":new ut(j.paint_symbol["icon-color"]),"icon-halo-color":new ut(j.paint_symbol["icon-halo-color"]),"icon-halo-width":new ut(j.paint_symbol["icon-halo-width"]),"icon-halo-blur":new ut(j.paint_symbol["icon-halo-blur"]),"icon-translate":new gt(j.paint_symbol["icon-translate"]),"icon-translate-anchor":new gt(j.paint_symbol["icon-translate-anchor"]),"text-opacity":new ut(j.paint_symbol["text-opacity"]),"text-color":new ut(j.paint_symbol["text-color"],{runtimeType:je,getOverride:function(e){return e.textColor},hasOverride:function(e){return!!e.textColor}}),"text-halo-color":new ut(j.paint_symbol["text-halo-color"]),"text-halo-width":new ut(j.paint_symbol["text-halo-width"]),"text-halo-blur":new ut(j.paint_symbol["text-halo-blur"]),"text-translate":new gt(j.paint_symbol["text-translate"]),"text-translate-anchor":new gt(j.paint_symbol["text-translate-anchor"])}),layout:z_},dl=function(e){this.type=e.property.overrides?e.property.overrides.runtimeType:Xe,this.defaultValue=e};dl.prototype.evaluate=function(e){if(e.formattedSection){var t=this.defaultValue.property.overrides;if(t&&t.hasOverride(e.formattedSection))return t.getOverride(e.formattedSection)}return e.feature&&e.featureState?this.defaultValue.evaluate(e.feature,e.featureState):this.defaultValue.property.specification.default},dl.prototype.eachChild=function(e){this.defaultValue.isConstant()||e(this.defaultValue.value._styleExpression.expression)},dl.prototype.outputDefined=function(){return!1},dl.prototype.serialize=function(){return null},st("FormatSectionOverride",dl,{omit:["defaultValue"]});var A_=function(e){function t(i){e.call(this,i,up)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.recalculate=function(i,l){if(e.prototype.recalculate.call(this,i,l),this.layout.get("icon-rotation-alignment")==="auto"&&(this.layout._values["icon-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-rotation-alignment")==="auto"&&(this.layout._values["text-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-pitch-alignment")==="auto"&&(this.layout._values["text-pitch-alignment"]=this.layout.get("text-rotation-alignment")),this.layout.get("icon-pitch-alignment")==="auto"&&(this.layout._values["icon-pitch-alignment"]=this.layout.get("icon-rotation-alignment")),this.layout.get("symbol-placement")==="point"){var p=this.layout.get("text-writing-mode");if(p){for(var m=[],x=0,S=p;x<S.length;x+=1){var I=S[x];m.indexOf(I)<0&&m.push(I)}this.layout._values["text-writing-mode"]=m}else this.layout._values["text-writing-mode"]=["horizontal"]}this._setPaintOverrides()},t.prototype.getValueAndResolveTokens=function(i,l,p,m){var x=this.layout.get(i).evaluate(l,{},p,m),S=this._unevaluatedLayout._values[i];return S.isDataDriven()||us(S.value)||!x?x:function(I,A){return A.replace(/{([^{}]+)}/g,function(C,B){return B in I?String(I[B]):""})}(l.properties,x)},t.prototype.createBucket=function(i){return new Rr(i)},t.prototype.queryRadius=function(){return 0},t.prototype.queryIntersectsFeature=function(){return!1},t.prototype._setPaintOverrides=function(){for(var i=0,l=up.paint.overridableProperties;i<l.length;i+=1){var p=l[i];if(t.hasPaintOverride(this.layout,p)){var m,x=this.paint.get(p),S=new dl(x),I=new Ua(S,x.property.specification);m=x.value.kind==="constant"||x.value.kind==="source"?new cs("source",I):new Va("composite",I,x.value.zoomStops,x.value._interpolationType),this.paint._values[p]=new bn(x.property,m,x.parameters)}}},t.prototype._handleOverridablePaintPropertyUpdate=function(i,l,p){return!(!this.layout||l.isDataDriven()||p.isDataDriven())&&t.hasPaintOverride(this.layout,i)},t.hasPaintOverride=function(i,l){var p=i.get("text-field"),m=up.paint.properties[l],x=!1,S=function(C){for(var B=0,U=C;B<U.length;B+=1)if(m.overrides&&m.overrides.hasOverride(U[B]))return void(x=!0)};if(p.value.kind==="constant"&&p.value.value instanceof wr)S(p.value.value.sections);else if(p.value.kind==="source"){var I=function(C){x||(C instanceof ki&&Zr(C.value)===lr?S(C.value.sections):C instanceof On?S(C.sections):C.eachChild(I))},A=p.value;A._styleExpression&&I(A._styleExpression.expression)}return x},t}(To),P_={paint:new rn({"background-color":new gt(j.paint_background["background-color"]),"background-pattern":new xn(j.paint_background["background-pattern"]),"background-opacity":new gt(j.paint_background["background-opacity"])})},C_=function(e){function t(i){e.call(this,i,P_)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t}(To),M_={paint:new rn({"raster-opacity":new gt(j.paint_raster["raster-opacity"]),"raster-hue-rotate":new gt(j.paint_raster["raster-hue-rotate"]),"raster-brightness-min":new gt(j.paint_raster["raster-brightness-min"]),"raster-brightness-max":new gt(j.paint_raster["raster-brightness-max"]),"raster-saturation":new gt(j.paint_raster["raster-saturation"]),"raster-contrast":new gt(j.paint_raster["raster-contrast"]),"raster-resampling":new gt(j.paint_raster["raster-resampling"]),"raster-fade-duration":new gt(j.paint_raster["raster-fade-duration"])})},D_=function(e){function t(i){e.call(this,i,M_)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t}(To),L_=function(e){function t(i){e.call(this,i,{}),this.implementation=i}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.is3D=function(){return this.implementation.renderingMode==="3d"},t.prototype.hasOffscreenPass=function(){return this.implementation.prerender!==void 0},t.prototype.recalculate=function(){},t.prototype.updateTransitions=function(){},t.prototype.hasTransition=function(){},t.prototype.serialize=function(){},t.prototype.onAdd=function(i){this.implementation.onAdd&&this.implementation.onAdd(i,i.painter.context.gl)},t.prototype.onRemove=function(i){this.implementation.onRemove&&this.implementation.onRemove(i,i.painter.context.gl)},t}(To),R_={circle:Xh,heatmap:gy,hillshade:by,fill:Oy,"fill-extrusion":Ky,line:Qy,symbol:A_,background:C_,raster:D_},Cf=D.HTMLImageElement,Mf=D.HTMLCanvasElement,Df=D.HTMLVideoElement,Lf=D.ImageData,Vc=D.ImageBitmap,Is=function(e,t,i,l){this.context=e,this.format=i,this.texture=e.gl.createTexture(),this.update(t,l)};Is.prototype.update=function(e,t,i){var l=e.width,p=e.height,m=!(this.size&&this.size[0]===l&&this.size[1]===p||i),x=this.context,S=x.gl;if(this.useMipmap=!!(t&&t.useMipmap),S.bindTexture(S.TEXTURE_2D,this.texture),x.pixelStoreUnpackFlipY.set(!1),x.pixelStoreUnpack.set(1),x.pixelStoreUnpackPremultiplyAlpha.set(this.format===S.RGBA&&(!t||t.premultiply!==!1)),m)this.size=[l,p],e instanceof Cf||e instanceof Mf||e instanceof Df||e instanceof Lf||Vc&&e instanceof Vc?S.texImage2D(S.TEXTURE_2D,0,this.format,this.format,S.UNSIGNED_BYTE,e):S.texImage2D(S.TEXTURE_2D,0,this.format,l,p,0,this.format,S.UNSIGNED_BYTE,e.data);else{var I=i||{x:0,y:0},A=I.x,C=I.y;e instanceof Cf||e instanceof Mf||e instanceof Df||e instanceof Lf||Vc&&e instanceof Vc?S.texSubImage2D(S.TEXTURE_2D,0,A,C,S.RGBA,S.UNSIGNED_BYTE,e):S.texSubImage2D(S.TEXTURE_2D,0,A,C,l,p,S.RGBA,S.UNSIGNED_BYTE,e.data)}this.useMipmap&&this.isSizePowerOfTwo()&&S.generateMipmap(S.TEXTURE_2D)},Is.prototype.bind=function(e,t,i){var l=this.context.gl;l.bindTexture(l.TEXTURE_2D,this.texture),i!==l.LINEAR_MIPMAP_NEAREST||this.isSizePowerOfTwo()||(i=l.LINEAR),e!==this.filter&&(l.texParameteri(l.TEXTURE_2D,l.TEXTURE_MAG_FILTER,e),l.texParameteri(l.TEXTURE_2D,l.TEXTURE_MIN_FILTER,i||e),this.filter=e),t!==this.wrap&&(l.texParameteri(l.TEXTURE_2D,l.TEXTURE_WRAP_S,t),l.texParameteri(l.TEXTURE_2D,l.TEXTURE_WRAP_T,t),this.wrap=t)},Is.prototype.isSizePowerOfTwo=function(){return this.size[0]===this.size[1]&&Math.log(this.size[0])/Math.LN2%1==0},Is.prototype.destroy=function(){this.context.gl.deleteTexture(this.texture),this.texture=null};var cp=function(e){var t=this;this._callback=e,this._triggered=!1,typeof MessageChannel<"u"&&(this._channel=new MessageChannel,this._channel.port2.onmessage=function(){t._triggered=!1,t._callback()})};cp.prototype.trigger=function(){var e=this;this._triggered||(this._triggered=!0,this._channel?this._channel.port1.postMessage(!0):setTimeout(function(){e._triggered=!1,e._callback()},0))},cp.prototype.remove=function(){delete this._channel,this._callback=function(){}};var ml=function(e,t,i){this.target=e,this.parent=t,this.mapId=i,this.callbacks={},this.tasks={},this.taskQueue=[],this.cancelCallbacks={},It(["receive","process"],this),this.invoker=new cp(this.process),this.target.addEventListener("message",this.receive,!1),this.globalScope=qt()?e:D};function Rf(e,t,i){var l=2*Math.PI*6378137/256/Math.pow(2,i);return[e*l-2*Math.PI*6378137/2,t*l-2*Math.PI*6378137/2]}ml.prototype.send=function(e,t,i,l,p){var m=this;p===void 0&&(p=!1);var x=Math.round(1e18*Math.random()).toString(36).substring(0,10);i&&(this.callbacks[x]=i);var S=Ut(this.globalScope)?void 0:[];return this.target.postMessage({id:x,type:e,hasCallback:!!i,targetMapId:l,mustQueue:p,sourceMapId:this.mapId,data:fo(t,S)},S),{cancel:function(){i&&delete m.callbacks[x],m.target.postMessage({id:x,type:"<cancel>",targetMapId:l,sourceMapId:m.mapId})}}},ml.prototype.receive=function(e){var t=e.data,i=t.id;if(i&&(!t.targetMapId||this.mapId===t.targetMapId))if(t.type==="<cancel>"){delete this.tasks[i];var l=this.cancelCallbacks[i];delete this.cancelCallbacks[i],l&&l()}else qt()||t.mustQueue?(this.tasks[i]=t,this.taskQueue.push(i),this.invoker.trigger()):this.processTask(i,t)},ml.prototype.process=function(){if(this.taskQueue.length){var e=this.taskQueue.shift(),t=this.tasks[e];delete this.tasks[e],this.taskQueue.length&&this.invoker.trigger(),t&&this.processTask(e,t)}},ml.prototype.processTask=function(e,t){var i=this;if(t.type==="<response>"){var l=this.callbacks[e];delete this.callbacks[e],l&&(t.error?l(Vn(t.error)):l(null,Vn(t.data)))}else{var p=!1,m=Ut(this.globalScope)?void 0:[],x=t.hasCallback?function(C,B){p=!0,delete i.cancelCallbacks[e],i.target.postMessage({id:e,type:"<response>",sourceMapId:i.mapId,error:C?fo(C):null,data:fo(B,m)},m)}:function(C){p=!0},S=null,I=Vn(t.data);if(this.parent[t.type])S=this.parent[t.type](t.sourceMapId,I,x);else if(this.parent.getWorkerSource){var A=t.type.split(".");S=this.parent.getWorkerSource(t.sourceMapId,A[0],I.source)[A[1]](I,x)}else x(new Error("Could not find function "+t.type));!p&&S&&S.cancel&&(this.cancelCallbacks[e]=S.cancel)}},ml.prototype.remove=function(){this.invoker.remove(),this.target.removeEventListener("message",this.receive,!1)};var zi=function(e,t){e&&(t?this.setSouthWest(e).setNorthEast(t):e.length===4?this.setSouthWest([e[0],e[1]]).setNorthEast([e[2],e[3]]):this.setSouthWest(e[0]).setNorthEast(e[1]))};zi.prototype.setNorthEast=function(e){return this._ne=e instanceof Hr?new Hr(e.lng,e.lat):Hr.convert(e),this},zi.prototype.setSouthWest=function(e){return this._sw=e instanceof Hr?new Hr(e.lng,e.lat):Hr.convert(e),this},zi.prototype.extend=function(e){var t,i,l=this._sw,p=this._ne;if(e instanceof Hr)t=e,i=e;else{if(!(e instanceof zi))return Array.isArray(e)?e.length===4||e.every(Array.isArray)?this.extend(zi.convert(e)):this.extend(Hr.convert(e)):this;if(i=e._ne,!(t=e._sw)||!i)return this}return l||p?(l.lng=Math.min(t.lng,l.lng),l.lat=Math.min(t.lat,l.lat),p.lng=Math.max(i.lng,p.lng),p.lat=Math.max(i.lat,p.lat)):(this._sw=new Hr(t.lng,t.lat),this._ne=new Hr(i.lng,i.lat)),this},zi.prototype.getCenter=function(){return new Hr((this._sw.lng+this._ne.lng)/2,(this._sw.lat+this._ne.lat)/2)},zi.prototype.getSouthWest=function(){return this._sw},zi.prototype.getNorthEast=function(){return this._ne},zi.prototype.getNorthWest=function(){return new Hr(this.getWest(),this.getNorth())},zi.prototype.getSouthEast=function(){return new Hr(this.getEast(),this.getSouth())},zi.prototype.getWest=function(){return this._sw.lng},zi.prototype.getSouth=function(){return this._sw.lat},zi.prototype.getEast=function(){return this._ne.lng},zi.prototype.getNorth=function(){return this._ne.lat},zi.prototype.toArray=function(){return[this._sw.toArray(),this._ne.toArray()]},zi.prototype.toString=function(){return"LngLatBounds("+this._sw.toString()+", "+this._ne.toString()+")"},zi.prototype.isEmpty=function(){return!(this._sw&&this._ne)},zi.prototype.contains=function(e){var t=Hr.convert(e),i=t.lng,l=t.lat,p=this._sw.lng<=i&&i<=this._ne.lng;return this._sw.lng>this._ne.lng&&(p=this._sw.lng>=i&&i>=this._ne.lng),this._sw.lat<=l&&l<=this._ne.lat&&p},zi.convert=function(e){return!e||e instanceof zi?e:new zi(e)};var Hr=function(e,t){if(isNaN(e)||isNaN(t))throw new Error("Invalid LngLat object: ("+e+", "+t+")");if(this.lng=+e,this.lat=+t,this.lat>90||this.lat<-90)throw new Error("Invalid LngLat latitude value: must be between -90 and 90")};Hr.prototype.wrap=function(){return new Hr(me(this.lng,-180,180),this.lat)},Hr.prototype.toArray=function(){return[this.lng,this.lat]},Hr.prototype.toString=function(){return"LngLat("+this.lng+", "+this.lat+")"},Hr.prototype.distanceTo=function(e){var t=Math.PI/180,i=this.lat*t,l=e.lat*t,p=Math.sin(i)*Math.sin(l)+Math.cos(i)*Math.cos(l)*Math.cos((e.lng-this.lng)*t);return 63710088e-1*Math.acos(Math.min(p,1))},Hr.prototype.toBounds=function(e){e===void 0&&(e=0);var t=360*e/40075017,i=t/Math.cos(Math.PI/180*this.lat);return new zi(new Hr(this.lng-i,this.lat-t),new Hr(this.lng+i,this.lat+t))},Hr.convert=function(e){if(e instanceof Hr)return e;if(Array.isArray(e)&&(e.length===2||e.length===3))return new Hr(Number(e[0]),Number(e[1]));if(!Array.isArray(e)&&typeof e=="object"&&e!==null)return new Hr(Number("lng"in e?e.lng:e.lon),Number(e.lat));throw new Error("`LngLatLike` argument must be specified as a LngLat instance, an object {lng: <lng>, lat: <lat>}, an object {lon: <lng>, lat: <lat>}, or an array of [<lng>, <lat>]")};var Bf=2*Math.PI*63710088e-1;function Of(e){return Bf*Math.cos(e*Math.PI/180)}function Ff(e){return(180+e)/360}function Nf(e){return(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+e*Math.PI/360)))/360}function Uf(e,t){return e/Of(t)}function hp(e){return 360/Math.PI*Math.atan(Math.exp((180-360*e)*Math.PI/180))-90}var zs=function(e,t,i){i===void 0&&(i=0),this.x=+e,this.y=+t,this.z=+i};zs.fromLngLat=function(e,t){t===void 0&&(t=0);var i=Hr.convert(e);return new zs(Ff(i.lng),Nf(i.lat),Uf(t,i.lat))},zs.prototype.toLngLat=function(){return new Hr(360*this.x-180,hp(this.y))},zs.prototype.toAltitude=function(){return this.z*Of(hp(this.y))},zs.prototype.meterInMercatorCoordinateUnits=function(){return 1/Bf*(e=hp(this.y),1/Math.cos(e*Math.PI/180));var e};var As=function(e,t,i){this.z=e,this.x=t,this.y=i,this.key=mu(0,e,e,t,i)};As.prototype.equals=function(e){return this.z===e.z&&this.x===e.x&&this.y===e.y},As.prototype.url=function(e,t){var i,l,p,m,x,S=(l=this.y,p=this.z,m=Rf(256*(i=this.x),256*(l=Math.pow(2,p)-l-1),p),x=Rf(256*(i+1),256*(l+1),p),m[0]+","+m[1]+","+x[0]+","+x[1]),I=function(A,C,B){for(var U,q="",Q=A;Q>0;Q--)q+=(C&(U=1<<Q-1)?1:0)+(B&U?2:0);return q}(this.z,this.x,this.y);return e[(this.x+this.y)%e.length].replace("{prefix}",(this.x%16).toString(16)+(this.y%16).toString(16)).replace("{z}",String(this.z)).replace("{x}",String(this.x)).replace("{y}",String(t==="tms"?Math.pow(2,this.z)-this.y-1:this.y)).replace("{quadkey}",I).replace("{bbox-epsg-3857}",S)},As.prototype.getTilePoint=function(e){var t=Math.pow(2,this.z);return new F(8192*(e.x*t-this.x),8192*(e.y*t-this.y))},As.prototype.toString=function(){return this.z+"/"+this.x+"/"+this.y};var Vf=function(e,t){this.wrap=e,this.canonical=t,this.key=mu(e,t.z,t.z,t.x,t.y)},Ai=function(e,t,i,l,p){this.overscaledZ=e,this.wrap=t,this.canonical=new As(i,+l,+p),this.key=mu(t,e,i,l,p)};function mu(e,t,i,l,p){(e*=2)<0&&(e=-1*e-1);var m=1<<i;return(m*m*e+m*p+l).toString(36)+i.toString(36)+t.toString(36)}Ai.prototype.equals=function(e){return this.overscaledZ===e.overscaledZ&&this.wrap===e.wrap&&this.canonical.equals(e.canonical)},Ai.prototype.scaledTo=function(e){var t=this.canonical.z-e;return e>this.canonical.z?new Ai(e,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y):new Ai(e,this.wrap,e,this.canonical.x>>t,this.canonical.y>>t)},Ai.prototype.calculateScaledKey=function(e,t){var i=this.canonical.z-e;return e>this.canonical.z?mu(this.wrap*+t,e,this.canonical.z,this.canonical.x,this.canonical.y):mu(this.wrap*+t,e,e,this.canonical.x>>i,this.canonical.y>>i)},Ai.prototype.isChildOf=function(e){if(e.wrap!==this.wrap)return!1;var t=this.canonical.z-e.canonical.z;return e.overscaledZ===0||e.overscaledZ<this.overscaledZ&&e.canonical.x===this.canonical.x>>t&&e.canonical.y===this.canonical.y>>t},Ai.prototype.children=function(e){if(this.overscaledZ>=e)return[new Ai(this.overscaledZ+1,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)];var t=this.canonical.z+1,i=2*this.canonical.x,l=2*this.canonical.y;return[new Ai(t,this.wrap,t,i,l),new Ai(t,this.wrap,t,i+1,l),new Ai(t,this.wrap,t,i,l+1),new Ai(t,this.wrap,t,i+1,l+1)]},Ai.prototype.isLessThan=function(e){return this.wrap<e.wrap||!(this.wrap>e.wrap)&&(this.overscaledZ<e.overscaledZ||!(this.overscaledZ>e.overscaledZ)&&(this.canonical.x<e.canonical.x||!(this.canonical.x>e.canonical.x)&&this.canonical.y<e.canonical.y))},Ai.prototype.wrapped=function(){return new Ai(this.overscaledZ,0,this.canonical.z,this.canonical.x,this.canonical.y)},Ai.prototype.unwrapTo=function(e){return new Ai(this.overscaledZ,e,this.canonical.z,this.canonical.x,this.canonical.y)},Ai.prototype.overscaleFactor=function(){return Math.pow(2,this.overscaledZ-this.canonical.z)},Ai.prototype.toUnwrapped=function(){return new Vf(this.wrap,this.canonical)},Ai.prototype.toString=function(){return this.overscaledZ+"/"+this.canonical.x+"/"+this.canonical.y},Ai.prototype.getTilePoint=function(e){return this.canonical.getTilePoint(new zs(e.x-this.wrap,e.y))},st("CanonicalTileID",As),st("OverscaledTileID",Ai,{omit:["posMatrix"]});var Ca=function(e,t,i){if(this.uid=e,t.height!==t.width)throw new RangeError("DEM tiles must be square");if(i&&i!=="mapbox"&&i!=="terrarium")return yt('"'+i+'" is not a valid encoding type. Valid types include "mapbox" and "terrarium".');this.stride=t.height;var l=this.dim=t.height-2;this.data=new Uint32Array(t.data.buffer),this.encoding=i||"mapbox";for(var p=0;p<l;p++)this.data[this._idx(-1,p)]=this.data[this._idx(0,p)],this.data[this._idx(l,p)]=this.data[this._idx(l-1,p)],this.data[this._idx(p,-1)]=this.data[this._idx(p,0)],this.data[this._idx(p,l)]=this.data[this._idx(p,l-1)];this.data[this._idx(-1,-1)]=this.data[this._idx(0,0)],this.data[this._idx(l,-1)]=this.data[this._idx(l-1,0)],this.data[this._idx(-1,l)]=this.data[this._idx(0,l-1)],this.data[this._idx(l,l)]=this.data[this._idx(l-1,l-1)]};Ca.prototype.get=function(e,t){var i=new Uint8Array(this.data.buffer),l=4*this._idx(e,t);return(this.encoding==="terrarium"?this._unpackTerrarium:this._unpackMapbox)(i[l],i[l+1],i[l+2])},Ca.prototype.getUnpackVector=function(){return this.encoding==="terrarium"?[256,1,1/256,32768]:[6553.6,25.6,.1,1e4]},Ca.prototype._idx=function(e,t){if(e<-1||e>=this.dim+1||t<-1||t>=this.dim+1)throw new RangeError("out of range source coordinates for DEM data");return(t+1)*this.stride+(e+1)},Ca.prototype._unpackMapbox=function(e,t,i){return(256*e*256+256*t+i)/10-1e4},Ca.prototype._unpackTerrarium=function(e,t,i){return 256*e+t+i/256-32768},Ca.prototype.getPixels=function(){return new Kn({width:this.stride,height:this.stride},new Uint8Array(this.data.buffer))},Ca.prototype.backfillBorder=function(e,t,i){if(this.dim!==e.dim)throw new Error("dem dimension mismatch");var l=t*this.dim,p=t*this.dim+this.dim,m=i*this.dim,x=i*this.dim+this.dim;switch(t){case-1:l=p-1;break;case 1:p=l+1}switch(i){case-1:m=x-1;break;case 1:x=m+1}for(var S=-t*this.dim,I=-i*this.dim,A=m;A<x;A++)for(var C=l;C<p;C++)this.data[this._idx(C,A)]=e.data[this._idx(C+S,A+I)]},st("DEMData",Ca);var jc=function(e){this._stringToNumber={},this._numberToString=[];for(var t=0;t<e.length;t++){var i=e[t];this._stringToNumber[i]=t,this._numberToString[t]=i}};jc.prototype.encode=function(e){return this._stringToNumber[e]},jc.prototype.decode=function(e){return this._numberToString[e]};var qc=function(e,t,i,l,p){this.type="Feature",this._vectorTileFeature=e,e._z=t,e._x=i,e._y=l,this.properties=e.properties,this.id=p},pp={geometry:{configurable:!0}};pp.geometry.get=function(){return this._geometry===void 0&&(this._geometry=this._vectorTileFeature.toGeoJSON(this._vectorTileFeature._x,this._vectorTileFeature._y,this._vectorTileFeature._z).geometry),this._geometry},pp.geometry.set=function(e){this._geometry=e},qc.prototype.toJSON=function(){var e={geometry:this.geometry};for(var t in this)t!=="_geometry"&&t!=="_vectorTileFeature"&&(e[t]=this[t]);return e},Object.defineProperties(qc.prototype,pp);var yl=function(){this.state={},this.stateChanges={},this.deletedStates={}};yl.prototype.updateState=function(e,t,i){var l=String(t);if(this.stateChanges[e]=this.stateChanges[e]||{},this.stateChanges[e][l]=this.stateChanges[e][l]||{},xe(this.stateChanges[e][l],i),this.deletedStates[e]===null)for(var p in this.deletedStates[e]={},this.state[e])p!==l&&(this.deletedStates[e][p]=null);else if(this.deletedStates[e]&&this.deletedStates[e][l]===null)for(var m in this.deletedStates[e][l]={},this.state[e][l])i[m]||(this.deletedStates[e][l][m]=null);else for(var x in i)this.deletedStates[e]&&this.deletedStates[e][l]&&this.deletedStates[e][l][x]===null&&delete this.deletedStates[e][l][x]},yl.prototype.removeFeatureState=function(e,t,i){if(this.deletedStates[e]!==null){var l=String(t);if(this.deletedStates[e]=this.deletedStates[e]||{},i&&t!==void 0)this.deletedStates[e][l]!==null&&(this.deletedStates[e][l]=this.deletedStates[e][l]||{},this.deletedStates[e][l][i]=null);else if(t!==void 0)if(this.stateChanges[e]&&this.stateChanges[e][l])for(i in this.deletedStates[e][l]={},this.stateChanges[e][l])this.deletedStates[e][l][i]=null;else this.deletedStates[e][l]=null;else this.deletedStates[e]=null}},yl.prototype.getState=function(e,t){var i=String(t),l=xe({},(this.state[e]||{})[i],(this.stateChanges[e]||{})[i]);if(this.deletedStates[e]===null)return{};if(this.deletedStates[e]){var p=this.deletedStates[e][t];if(p===null)return{};for(var m in p)delete l[m]}return l},yl.prototype.initializeTileState=function(e,t){e.setFeatureState(this.state,t)},yl.prototype.coalesceChanges=function(e,t){var i={};for(var l in this.stateChanges){this.state[l]=this.state[l]||{};var p={};for(var m in this.stateChanges[l])this.state[l][m]||(this.state[l][m]={}),xe(this.state[l][m],this.stateChanges[l][m]),p[m]=this.state[l][m];i[l]=p}for(var x in this.deletedStates){this.state[x]=this.state[x]||{};var S={};if(this.deletedStates[x]===null)for(var I in this.state[x])S[I]={},this.state[x][I]={};else for(var A in this.deletedStates[x]){if(this.deletedStates[x][A]===null)this.state[x][A]={};else for(var C=0,B=Object.keys(this.deletedStates[x][A]);C<B.length;C+=1)delete this.state[x][A][B[C]];S[A]=this.state[x][A]}i[x]=i[x]||{},xe(i[x],S)}if(this.stateChanges={},this.deletedStates={},Object.keys(i).length!==0)for(var U in e)e[U].setFeatureState(i,t)};var Ma=function(e,t){this.tileID=e,this.x=e.canonical.x,this.y=e.canonical.y,this.z=e.canonical.z,this.grid=new Mo(8192,16,0),this.grid3D=new Mo(8192,16,0),this.featureIndexArray=new O,this.promoteId=t};function jf(e,t,i,l,p){return jt(e,function(m,x){var S=t instanceof vs?t.get(x):null;return S&&S.evaluate?S.evaluate(i,l,p):S})}function qf(e){for(var t=1/0,i=1/0,l=-1/0,p=-1/0,m=0,x=e;m<x.length;m+=1){var S=x[m];t=Math.min(t,S.x),i=Math.min(i,S.y),l=Math.max(l,S.x),p=Math.max(p,S.y)}return{minX:t,minY:i,maxX:l,maxY:p}}function B_(e,t){return t-e}Ma.prototype.insert=function(e,t,i,l,p,m){var x=this.featureIndexArray.length;this.featureIndexArray.emplaceBack(i,l,p);for(var S=m?this.grid3D:this.grid,I=0;I<t.length;I++){for(var A=t[I],C=[1/0,1/0,-1/0,-1/0],B=0;B<A.length;B++){var U=A[B];C[0]=Math.min(C[0],U.x),C[1]=Math.min(C[1],U.y),C[2]=Math.max(C[2],U.x),C[3]=Math.max(C[3],U.y)}C[0]<8192&&C[1]<8192&&C[2]>=0&&C[3]>=0&&S.insert(x,C[0],C[1],C[2],C[3])}},Ma.prototype.loadVTLayers=function(){return this.vtLayers||(this.vtLayers=new al.VectorTile(new Cc(this.rawTileData)).layers,this.sourceLayerCoder=new jc(this.vtLayers?Object.keys(this.vtLayers).sort():["_geojsonTileLayer"])),this.vtLayers},Ma.prototype.query=function(e,t,i,l){var p=this;this.loadVTLayers();for(var m=e.params||{},x=8192/e.tileSize/e.scale,S=qs(m.filter),I=e.queryGeometry,A=e.queryPadding*x,C=qf(I),B=this.grid.query(C.minX-A,C.minY-A,C.maxX+A,C.maxY+A),U=qf(e.cameraQueryGeometry),q=this.grid3D.query(U.minX-A,U.minY-A,U.maxX+A,U.maxY+A,function(ke,Ie,Pe,Ue){return function(He,ft,tt,bt,it){for(var Yt=0,Dt=He;Yt<Dt.length;Yt+=1){var ct=Dt[Yt];if(ft<=ct.x&&tt<=ct.y&&bt>=ct.x&&it>=ct.y)return!0}var rr=[new F(ft,tt),new F(ft,it),new F(bt,it),new F(bt,tt)];if(He.length>2){for(var Kt=0,yr=rr;Kt<yr.length;Kt+=1)if(zo(He,yr[Kt]))return!0}for(var xt=0;xt<He.length-1;xt++)if(Ss(He[xt],He[xt+1],rr))return!0;return!1}(e.cameraQueryGeometry,ke-A,Ie-A,Pe+A,Ue+A)}),Q=0,ee=q;Q<ee.length;Q+=1)B.push(ee[Q]);B.sort(B_);for(var ce,ie={},de=function(ke){var Ie=B[ke];if(Ie!==ce){ce=Ie;var Pe=p.featureIndexArray.get(Ie),Ue=null;p.loadMatchingFeature(ie,Pe.bucketIndex,Pe.sourceLayerIndex,Pe.featureIndex,S,m.layers,m.availableImages,t,i,l,function(He,ft,tt){return Ue||(Ue=ri(He)),ft.queryIntersectsFeature(I,He,tt,Ue,p.z,e.transform,x,e.pixelPosMatrix)})}},be=0;be<B.length;be++)de(be);return ie},Ma.prototype.loadMatchingFeature=function(e,t,i,l,p,m,x,S,I,A,C){var B=this.bucketLayerIDs[t];if(!m||function(He,ft){for(var tt=0;tt<He.length;tt++)if(ft.indexOf(He[tt])>=0)return!0;return!1}(m,B)){var U=this.sourceLayerCoder.decode(i),q=this.vtLayers[U].feature(l);if(p.needGeometry){var Q=fi(q,!0);if(!p.filter(new ur(this.tileID.overscaledZ),Q,this.tileID.canonical))return}else if(!p.filter(new ur(this.tileID.overscaledZ),q))return;for(var ee=this.getId(q,U),ce=0;ce<B.length;ce++){var ie=B[ce];if(!(m&&m.indexOf(ie)<0)){var de=S[ie];if(de){var be={};ee!==void 0&&A&&(be=A.getState(de.sourceLayer||"_geojsonTileLayer",ee));var ke=xe({},I[ie]);ke.paint=jf(ke.paint,de.paint,q,be,x),ke.layout=jf(ke.layout,de.layout,q,be,x);var Ie=!C||C(q,de,be);if(Ie){var Pe=new qc(q,this.z,this.x,this.y,ee);Pe.layer=ke;var Ue=e[ie];Ue===void 0&&(Ue=e[ie]=[]),Ue.push({featureIndex:l,feature:Pe,intersectionZ:Ie})}}}}}},Ma.prototype.lookupSymbolFeatures=function(e,t,i,l,p,m,x,S){var I={};this.loadVTLayers();for(var A=qs(p),C=0,B=e;C<B.length;C+=1)this.loadMatchingFeature(I,i,l,B[C],A,m,x,S,t);return I},Ma.prototype.hasLayer=function(e){for(var t=0,i=this.bucketLayerIDs;t<i.length;t+=1)for(var l=0,p=i[t];l<p.length;l+=1)if(e===p[l])return!0;return!1},Ma.prototype.getId=function(e,t){var i=e.id;return this.promoteId&&typeof(i=e.properties[typeof this.promoteId=="string"?this.promoteId:this.promoteId[t]])=="boolean"&&(i=Number(i)),i},st("FeatureIndex",Ma,{omit:["rawTileData","sourceLayerCoder"]});var Ki=function(e,t){this.tileID=e,this.uid=Je(),this.uses=0,this.tileSize=t,this.buckets={},this.expirationTime=null,this.queryPadding=0,this.hasSymbolBuckets=!1,this.hasRTLText=!1,this.dependencies={},this.expiredRequestCount=0,this.state="loading"};Ki.prototype.registerFadeDuration=function(e){var t=e+this.timeAdded;t<Qr.now()||this.fadeEndTime&&t<this.fadeEndTime||(this.fadeEndTime=t)},Ki.prototype.wasRequested=function(){return this.state==="errored"||this.state==="loaded"||this.state==="reloading"},Ki.prototype.loadVectorData=function(e,t,i){if(this.hasData()&&this.unloadVectorData(),this.state="loaded",e){for(var l in e.featureIndex&&(this.latestFeatureIndex=e.featureIndex,e.rawTileData?(this.latestRawTileData=e.rawTileData,this.latestFeatureIndex.rawTileData=e.rawTileData):this.latestRawTileData&&(this.latestFeatureIndex.rawTileData=this.latestRawTileData)),this.collisionBoxArray=e.collisionBoxArray,this.buckets=function(A,C){var B={};if(!C)return B;for(var U=function(){var ee=Q[q],ce=ee.layerIds.map(function(be){return C.getLayer(be)}).filter(Boolean);if(ce.length!==0){ee.layers=ce,ee.stateDependentLayerIds&&(ee.stateDependentLayers=ee.stateDependentLayerIds.map(function(be){return ce.filter(function(ke){return ke.id===be})[0]}));for(var ie=0,de=ce;ie<de.length;ie+=1)B[de[ie].id]=ee}},q=0,Q=A;q<Q.length;q+=1)U();return B}(e.buckets,t.style),this.hasSymbolBuckets=!1,this.buckets){var p=this.buckets[l];if(p instanceof Rr){if(this.hasSymbolBuckets=!0,!i)break;p.justReloaded=!0}}if(this.hasRTLText=!1,this.hasSymbolBuckets)for(var m in this.buckets){var x=this.buckets[m];if(x instanceof Rr&&x.hasRTLText){this.hasRTLText=!0,Qn.isLoading()||Qn.isLoaded()||Ql()!=="deferred"||mo();break}}for(var S in this.queryPadding=0,this.buckets){var I=this.buckets[S];this.queryPadding=Math.max(this.queryPadding,t.style.getLayer(S).queryRadius(I))}e.imageAtlas&&(this.imageAtlas=e.imageAtlas),e.glyphAtlasImage&&(this.glyphAtlasImage=e.glyphAtlasImage)}else this.collisionBoxArray=new s},Ki.prototype.unloadVectorData=function(){for(var e in this.buckets)this.buckets[e].destroy();this.buckets={},this.imageAtlasTexture&&this.imageAtlasTexture.destroy(),this.imageAtlas&&(this.imageAtlas=null),this.glyphAtlasTexture&&this.glyphAtlasTexture.destroy(),this.latestFeatureIndex=null,this.state="unloaded"},Ki.prototype.getBucket=function(e){return this.buckets[e.id]},Ki.prototype.upload=function(e){for(var t in this.buckets){var i=this.buckets[t];i.uploadPending()&&i.upload(e)}var l=e.gl;this.imageAtlas&&!this.imageAtlas.uploaded&&(this.imageAtlasTexture=new Is(e,this.imageAtlas.image,l.RGBA),this.imageAtlas.uploaded=!0),this.glyphAtlasImage&&(this.glyphAtlasTexture=new Is(e,this.glyphAtlasImage,l.ALPHA),this.glyphAtlasImage=null)},Ki.prototype.prepare=function(e){this.imageAtlas&&this.imageAtlas.patchUpdatedImages(e,this.imageAtlasTexture)},Ki.prototype.queryRenderedFeatures=function(e,t,i,l,p,m,x,S,I,A){return this.latestFeatureIndex&&this.latestFeatureIndex.rawTileData?this.latestFeatureIndex.query({queryGeometry:l,cameraQueryGeometry:p,scale:m,tileSize:this.tileSize,pixelPosMatrix:A,transform:S,params:x,queryPadding:this.queryPadding*I},e,t,i):{}},Ki.prototype.querySourceFeatures=function(e,t){var i=this.latestFeatureIndex;if(i&&i.rawTileData){var l=i.loadVTLayers(),p=t?t.sourceLayer:"",m=l._geojsonTileLayer||l[p];if(m)for(var x=qs(t&&t.filter),S=this.tileID.canonical,I=S.z,A=S.x,C=S.y,B={z:I,x:A,y:C},U=0;U<m.length;U++){var q=m.feature(U);if(x.needGeometry){var Q=fi(q,!0);if(!x.filter(new ur(this.tileID.overscaledZ),Q,this.tileID.canonical))continue}else if(!x.filter(new ur(this.tileID.overscaledZ),q))continue;var ee=i.getId(q,p),ce=new qc(q,I,A,C,ee);ce.tile=B,e.push(ce)}}},Ki.prototype.hasData=function(){return this.state==="loaded"||this.state==="reloading"||this.state==="expired"},Ki.prototype.patternsLoaded=function(){return this.imageAtlas&&!!Object.keys(this.imageAtlas.patternPositions).length},Ki.prototype.setExpiryData=function(e){var t=this.expirationTime;if(e.cacheControl){var i=pt(e.cacheControl);i["max-age"]&&(this.expirationTime=Date.now()+1e3*i["max-age"])}else e.expires&&(this.expirationTime=new Date(e.expires).getTime());if(this.expirationTime){var l=Date.now(),p=!1;if(this.expirationTime>l)p=!1;else if(t)if(this.expirationTime<t)p=!0;else{var m=this.expirationTime-t;m?this.expirationTime=l+Math.max(m,3e4):p=!0}else p=!0;p?(this.expiredRequestCount++,this.state="expired"):this.expiredRequestCount=0}},Ki.prototype.getExpiryTimeout=function(){if(this.expirationTime)return this.expiredRequestCount?1e3*(1<<Math.min(this.expiredRequestCount-1,31)):Math.min(this.expirationTime-new Date().getTime(),Math.pow(2,31)-1)},Ki.prototype.setFeatureState=function(e,t){if(this.latestFeatureIndex&&this.latestFeatureIndex.rawTileData&&Object.keys(e).length!==0){var i=this.latestFeatureIndex.loadVTLayers();for(var l in this.buckets)if(t.style.hasLayer(l)){var p=this.buckets[l],m=p.layers[0].sourceLayer||"_geojsonTileLayer",x=i[m],S=e[m];if(x&&S&&Object.keys(S).length!==0){p.update(S,x,this.imageAtlas&&this.imageAtlas.patternPositions||{});var I=t&&t.style&&t.style.getLayer(l);I&&(this.queryPadding=Math.max(this.queryPadding,I.queryRadius(p)))}}}},Ki.prototype.holdingForFade=function(){return this.symbolFadeHoldUntil!==void 0},Ki.prototype.symbolFadeFinished=function(){return!this.symbolFadeHoldUntil||this.symbolFadeHoldUntil<Qr.now()},Ki.prototype.clearFadeHold=function(){this.symbolFadeHoldUntil=void 0},Ki.prototype.setHoldDuration=function(e){this.symbolFadeHoldUntil=Qr.now()+e},Ki.prototype.setDependencies=function(e,t){for(var i={},l=0,p=t;l<p.length;l+=1)i[p[l]]=!0;this.dependencies[e]=i},Ki.prototype.hasDependency=function(e,t){for(var i=0,l=e;i<l.length;i+=1){var p=this.dependencies[l[i]];if(p){for(var m=0,x=t;m<x.length;m+=1)if(p[x[m]])return!0}}return!1};var Qa=D.performance,Zf=function(e){this._marks={start:[e.url,"start"].join("#"),end:[e.url,"end"].join("#"),measure:e.url.toString()},Qa.mark(this._marks.start)};Zf.prototype.finish=function(){Qa.mark(this._marks.end);var e=Qa.getEntriesByName(this._marks.measure);return e.length===0&&(Qa.measure(this._marks.measure,this._marks.start,this._marks.end),e=Qa.getEntriesByName(this._marks.measure),Qa.clearMarks(this._marks.start),Qa.clearMarks(this._marks.end),Qa.clearMeasures(this._marks.measure)),e},o.Actor=ml,o.AlphaImage=Ts,o.CanonicalTileID=As,o.CollisionBoxArray=s,o.Color=tr,o.DEMData=Ca,o.DataConstantProperty=gt,o.DictionaryCoder=jc,o.EXTENT=8192,o.ErrorEvent=se,o.EvaluationParameters=ur,o.Event=$,o.Evented=pe,o.FeatureIndex=Ma,o.FillBucket=Bo,o.FillExtrusionBucket=Oo,o.ImageAtlas=fu,o.ImagePosition=Dc,o.LineBucket=Cn,o.LngLat=Hr,o.LngLatBounds=zi,o.MercatorCoordinate=zs,o.ONE_EM=24,o.OverscaledTileID=Ai,o.Point=F,o.Point$1=F,o.Properties=rn,o.Protobuf=Cc,o.RGBAImage=Kn,o.RequestManager=Dr,o.RequestPerformance=Zf,o.ResourceType=$i,o.SegmentVector=G,o.SourceFeatureState=yl,o.StructArrayLayout1ui2=nu,o.StructArrayLayout2f1f2i16=Ia,o.StructArrayLayout2i4=Ta,o.StructArrayLayout3ui6=Yo,o.StructArrayLayout4i8=eu,o.SymbolBucket=Rr,o.Texture=Is,o.Tile=Ki,o.Transitionable=tn,o.Uniform1f=Ke,o.Uniform1i=De,o.Uniform2f=Ze,o.Uniform3f=nt,o.Uniform4f=vt,o.UniformColor=St,o.UniformMatrix4f=_r,o.UnwrappedTileID=Vf,o.ValidationError=J,o.WritingMode=so,o.ZoomHistory=Wl,o.add=function(e,t,i){return e[0]=t[0]+i[0],e[1]=t[1]+i[1],e[2]=t[2]+i[2],e},o.addDynamicAttributes=lp,o.asyncAll=function(e,t,i){if(!e.length)return i(null,[]);var l=e.length,p=new Array(e.length),m=null;e.forEach(function(x,S){t(x,function(I,A){I&&(m=I),p[S]=A,--l==0&&i(m,p)})})},o.bezier=ne,o.bindAll=It,o.browser=Qr,o.cacheEntryPossiblyAdded=function(e){++Ni>Qi&&(e.getActor().send("enforceCacheSizeLimit",In),Ni=0)},o.clamp=ve,o.clearTileCache=function(e){var t=D.caches.delete("mapbox-tiles");e&&t.catch(e).then(function(){return e()})},o.clipLine=Ef,o.clone=function(e){var t=new Er(16);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t},o.clone$1=ht,o.clone$2=function(e){var t=new Er(3);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t},o.collisionCircleLayout=r_,o.config=kt,o.create=function(){var e=new Er(16);return Er!=Float32Array&&(e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[11]=0,e[12]=0,e[13]=0,e[14]=0),e[0]=1,e[5]=1,e[10]=1,e[15]=1,e},o.create$1=function(){var e=new Er(9);return Er!=Float32Array&&(e[1]=0,e[2]=0,e[3]=0,e[5]=0,e[6]=0,e[7]=0),e[0]=1,e[4]=1,e[8]=1,e},o.create$2=function(){var e=new Er(4);return Er!=Float32Array&&(e[1]=0,e[2]=0),e[0]=1,e[3]=1,e},o.createCommonjsModule=z,o.createExpression=Vs,o.createLayout=Zi,o.createStyleLayer=function(e){return e.type==="custom"?new L_(e):new R_[e.type](e)},o.cross=function(e,t,i){var l=t[0],p=t[1],m=t[2],x=i[0],S=i[1],I=i[2];return e[0]=p*I-m*S,e[1]=m*x-l*I,e[2]=l*S-p*x,e},o.deepEqual=function e(t,i){if(Array.isArray(t)){if(!Array.isArray(i)||t.length!==i.length)return!1;for(var l=0;l<t.length;l++)if(!e(t[l],i[l]))return!1;return!0}if(typeof t=="object"&&t!==null&&i!==null){if(typeof i!="object"||Object.keys(t).length!==Object.keys(i).length)return!1;for(var p in t)if(!e(t[p],i[p]))return!1;return!0}return t===i},o.dot=function(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]},o.dot$1=function(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]+e[3]*t[3]},o.ease=he,o.emitValidationErrors=ys,o.endsWith=Lt,o.enforceCacheSizeLimit=function(e){zn(),ei&&ei.then(function(t){t.keys().then(function(i){for(var l=0;l<i.length-e;l++)t.delete(i[l])})})},o.evaluateSizeForFeature=vf,o.evaluateSizeForZoom=bf,o.evaluateVariableOffset=zf,o.evented=Yl,o.extend=xe,o.featureFilter=qs,o.filterObject=_t,o.fromRotation=function(e,t){var i=Math.sin(t),l=Math.cos(t);return e[0]=l,e[1]=i,e[2]=0,e[3]=-i,e[4]=l,e[5]=0,e[6]=0,e[7]=0,e[8]=1,e},o.getAnchorAlignment=np,o.getAnchorJustification=sp,o.getArrayBuffer=ni,o.getImage=N,o.getJSON=function(e,t){return gn(xe(e,{type:"json"}),t)},o.getRTLTextPluginStatus=Ql,o.getReferrer=_n,o.getVideo=function(e,t){var i,l,p=D.document.createElement("video");p.muted=!0,p.onloadstart=function(){t(null,p)};for(var m=0;m<e.length;m++){var x=D.document.createElement("source");i=e[m],l=void 0,(l=D.document.createElement("a")).href=i,(l.protocol!==D.document.location.protocol||l.host!==D.document.location.host)&&(p.crossOrigin="Anonymous"),x.src=e[m],p.appendChild(x)}return{cancel:function(){}}},o.identity=$n,o.invert=function(e,t){var i=t[0],l=t[1],p=t[2],m=t[3],x=t[4],S=t[5],I=t[6],A=t[7],C=t[8],B=t[9],U=t[10],q=t[11],Q=t[12],ee=t[13],ce=t[14],ie=t[15],de=i*S-l*x,be=i*I-p*x,ke=i*A-m*x,Ie=l*I-p*S,Pe=l*A-m*S,Ue=p*A-m*I,He=C*ee-B*Q,ft=C*ce-U*Q,tt=C*ie-q*Q,bt=B*ce-U*ee,it=B*ie-q*ee,Yt=U*ie-q*ce,Dt=de*Yt-be*it+ke*bt+Ie*tt-Pe*ft+Ue*He;return Dt?(e[0]=(S*Yt-I*it+A*bt)*(Dt=1/Dt),e[1]=(p*it-l*Yt-m*bt)*Dt,e[2]=(ee*Ue-ce*Pe+ie*Ie)*Dt,e[3]=(U*Pe-B*Ue-q*Ie)*Dt,e[4]=(I*tt-x*Yt-A*ft)*Dt,e[5]=(i*Yt-p*tt+m*ft)*Dt,e[6]=(ce*ke-Q*Ue-ie*be)*Dt,e[7]=(C*Ue-U*ke+q*be)*Dt,e[8]=(x*it-S*tt+A*He)*Dt,e[9]=(l*tt-i*it-m*He)*Dt,e[10]=(Q*Pe-ee*ke+ie*de)*Dt,e[11]=(B*ke-C*Pe-q*de)*Dt,e[12]=(S*ft-x*bt-I*He)*Dt,e[13]=(i*bt-l*ft+p*He)*Dt,e[14]=(ee*be-Q*Ie-ce*de)*Dt,e[15]=(C*Ie-B*be+U*de)*Dt,e):null},o.isChar=Qe,o.isMapboxURL=Pr,o.keysDifference=function(e,t){var i=[];for(var l in e)l in t||i.push(l);return i},o.makeRequest=gn,o.mapObject=jt,o.mercatorXfromLng=Ff,o.mercatorYfromLat=Nf,o.mercatorZfromAltitude=Uf,o.mul=Kh,o.multiply=Pn,o.mvt=al,o.nextPowerOfTwo=function(e){return e<=1?1:Math.pow(2,Math.ceil(Math.log(e)/Math.LN2))},o.normalize=function(e,t){var i=t[0],l=t[1],p=t[2],m=i*i+l*l+p*p;return m>0&&(m=1/Math.sqrt(m)),e[0]=t[0]*m,e[1]=t[1]*m,e[2]=t[2]*m,e},o.number=vi,o.offscreenCanvasSupported=Rn,o.ortho=function(e,t,i,l,p,m,x){var S=1/(t-i),I=1/(l-p),A=1/(m-x);return e[0]=-2*S,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=-2*I,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=2*A,e[11]=0,e[12]=(t+i)*S,e[13]=(p+l)*I,e[14]=(x+m)*A,e[15]=1,e},o.parseGlyphPBF=function(e){return new Cc(e).readFields(f_,[])},o.pbf=Cc,o.performSymbolLayout=function(e,t,i,l,p,m,x){e.createArrays(),e.tilePixelRatio=8192/(512*e.overscaling),e.compareText={},e.iconsNeedLinear=!1;var S=e.layers[0].layout,I=e.layers[0]._unevaluatedLayout._values,A={};if(e.textSizeData.kind==="composite"){var C=e.textSizeData,B=C.maxZoom;A.compositeTextSizes=[I["text-size"].possiblyEvaluate(new ur(C.minZoom),x),I["text-size"].possiblyEvaluate(new ur(B),x)]}if(e.iconSizeData.kind==="composite"){var U=e.iconSizeData,q=U.maxZoom;A.compositeIconSizes=[I["icon-size"].possiblyEvaluate(new ur(U.minZoom),x),I["icon-size"].possiblyEvaluate(new ur(q),x)]}A.layoutTextSize=I["text-size"].possiblyEvaluate(new ur(e.zoom+1),x),A.layoutIconSize=I["icon-size"].possiblyEvaluate(new ur(e.zoom+1),x),A.textMaxSize=I["text-size"].possiblyEvaluate(new ur(18));for(var Q=24*S.get("text-line-height"),ee=S.get("text-rotation-alignment")==="map"&&S.get("symbol-placement")!=="point",ce=S.get("text-keep-upright"),ie=S.get("text-size"),de=function(){var Ie=ke[be],Pe=S.get("text-font").evaluate(Ie,{},x).join(","),Ue=ie.evaluate(Ie,{},x),He=A.layoutTextSize.evaluate(Ie,{},x),ft=A.layoutIconSize.evaluate(Ie,{},x),tt={horizontal:{},vertical:void 0},bt=Ie.text,it=[0,0];if(bt){var Yt=bt.toString(),Dt=24*S.get("text-letter-spacing").evaluate(Ie,{},x),ct=function(pr){for(var Or=0,Mr=pr;Or<Mr.length;Or+=1)if(gr=Mr[Or].charCodeAt(0),Qe.Arabic(gr)||Qe["Arabic Supplement"](gr)||Qe["Arabic Extended-A"](gr)||Qe["Arabic Presentation Forms-A"](gr)||Qe["Arabic Presentation Forms-B"](gr))return!1;var gr;return!0}(Yt)?Dt:0,rr=S.get("text-anchor").evaluate(Ie,{},x),Kt=S.get("text-variable-anchor");if(!Kt){var yr=S.get("text-radial-offset").evaluate(Ie,{},x);it=yr?zf(rr,[24*yr,ap]):S.get("text-offset").evaluate(Ie,{},x).map(function(pr){return 24*pr})}var xt=ee?"center":S.get("text-justify").evaluate(Ie,{},x),kr=S.get("symbol-placement"),Jr=kr==="point"?24*S.get("text-max-width").evaluate(Ie,{},x):0,li=function(){e.allowVerticalPlacement&&Hl(Yt)&&(tt.vertical=Lc(bt,t,i,p,Pe,Jr,Q,rr,"left",ct,it,so.vertical,!0,kr,He,Ue))};if(!ee&&Kt){for(var ii=xt==="auto"?Kt.map(function(pr){return sp(pr)}):[xt],Yr=!1,ui=0;ui<ii.length;ui++){var Ri=ii[ui];if(!tt.horizontal[Ri])if(Yr)tt.horizontal[Ri]=tt.horizontal[0];else{var Bi=Lc(bt,t,i,p,Pe,Jr,Q,"center",Ri,ct,it,so.horizontal,!1,kr,He,Ue);Bi&&(tt.horizontal[Ri]=Bi,Yr=Bi.positionedLines.length===1)}}li()}else{xt==="auto"&&(xt=sp(rr));var Sn=Lc(bt,t,i,p,Pe,Jr,Q,rr,xt,ct,it,so.horizontal,!1,kr,He,Ue);Sn&&(tt.horizontal[xt]=Sn),li(),Hl(Yt)&&ee&&ce&&(tt.vertical=Lc(bt,t,i,p,Pe,Jr,Q,rr,xt,ct,it,so.vertical,!1,kr,He,Ue))}}var Xi=void 0,En=!1;if(Ie.icon&&Ie.icon.name){var di=l[Ie.icon.name];di&&(Xi=function(pr,Or,Mr){var gr=np(Mr),Mn=Or[0]-pr.displaySize[0]*gr.horizontalAlign,hn=Or[1]-pr.displaySize[1]*gr.verticalAlign;return{image:pr,top:hn,bottom:hn+pr.displaySize[1],left:Mn,right:Mn+pr.displaySize[0]}}(p[Ie.icon.name],S.get("icon-offset").evaluate(Ie,{},x),S.get("icon-anchor").evaluate(Ie,{},x)),En=di.sdf,e.sdfIcons===void 0?e.sdfIcons=di.sdf:e.sdfIcons!==di.sdf&&yt("Style sheet warning: Cannot mix SDF and non-SDF icons in one buffer"),(di.pixelRatio!==e.pixelRatio||S.get("icon-rotate").constantOr(1)!==0)&&(e.iconsNeedLinear=!0))}var Wi=Pf(tt.horizontal)||tt.vertical;e.iconsInText=!!Wi&&Wi.iconsInText,(Wi||Xi)&&function(pr,Or,Mr,gr,Mn,hn,Kr,xi,pn,Sr,ia){var lo=hn.textMaxSize.evaluate(Or,{});lo===void 0&&(lo=Kr);var na,mi=pr.layers[0].layout,oa=mi.get("icon-offset").evaluate(Or,{},ia),Po=Pf(Mr.horizontal),_l=Kr/24,Ps=pr.tilePixelRatio*_l,gl=pr.tilePixelRatio*lo/24,Da=pr.tilePixelRatio*xi,vl=pr.tilePixelRatio*mi.get("symbol-spacing"),Zc=mi.get("text-padding")*pr.tilePixelRatio,bl=mi.get("icon-padding")*pr.tilePixelRatio,yu=mi.get("text-max-angle")/180*Math.PI,Gc=mi.get("text-rotation-alignment")==="map"&&mi.get("symbol-placement")!=="point",Kc=mi.get("icon-rotation-alignment")==="map"&&mi.get("symbol-placement")!=="point",La=mi.get("symbol-placement"),_u=vl/2,xl=mi.get("icon-text-fit");gr&&xl!=="none"&&(pr.allowVerticalPlacement&&Mr.vertical&&(na=gf(gr,Mr.vertical,xl,mi.get("icon-text-fit-padding"),oa,_l)),Po&&(gr=gf(gr,Po,xl,mi.get("icon-text-fit-padding"),oa,_l)));var $a=function(O_,Eu){Eu.x<0||Eu.x>=8192||Eu.y<0||Eu.y>=8192||function(yi,Fo,F_,es,yp,Xf,Qc,aa,$c,Tu,eh,th,_p,Wf,Iu,Hf,Jf,Yf,Qf,$f,uo,rh,ed,sa,N_){var td,Ms,Tl,Il,zl,Al=yi.addToLineVertexArray(Fo,F_),rd=0,id=0,nd=0,od=0,gp=-1,vp=-1,Ra={},ad=Y(""),bp=0,xp=0;if(aa._unevaluatedLayout.getValue("text-radial-offset")===void 0?(bp=(td=aa.layout.get("text-offset").evaluate(uo,{},sa).map(function(Au){return 24*Au}))[0],xp=td[1]):(bp=24*aa.layout.get("text-radial-offset").evaluate(uo,{},sa),xp=ap),yi.allowVerticalPlacement&&es.vertical){var sd=aa.layout.get("text-rotate").evaluate(uo,{},sa)+90;Il=new Nc($c,Fo,Tu,eh,th,es.vertical,_p,Wf,Iu,sd),Qc&&(zl=new Nc($c,Fo,Tu,eh,th,Qc,Jf,Yf,Iu,sd))}if(yp){var wp=aa.layout.get("icon-rotate").evaluate(uo,{}),ld=aa.layout.get("icon-text-fit")!=="none",ud=Tf(yp,wp,ed,ld),kp=Qc?Tf(Qc,wp,ed,ld):void 0;Tl=new Nc($c,Fo,Tu,eh,th,yp,Jf,Yf,!1,wp),rd=4*ud.length;var cd=yi.iconSizeData,zu=null;cd.kind==="source"?(zu=[128*aa.layout.get("icon-size").evaluate(uo,{})])[0]>32640&&yt(yi.layerIds[0]+': Value for "icon-size" is >= 255. Reduce your "icon-size".'):cd.kind==="composite"&&((zu=[128*rh.compositeIconSizes[0].evaluate(uo,{},sa),128*rh.compositeIconSizes[1].evaluate(uo,{},sa)])[0]>32640||zu[1]>32640)&&yt(yi.layerIds[0]+': Value for "icon-size" is >= 255. Reduce your "icon-size".'),yi.addSymbols(yi.icon,ud,zu,$f,Qf,uo,!1,Fo,Al.lineStartIndex,Al.lineLength,-1,sa),gp=yi.icon.placedSymbolArray.length-1,kp&&(id=4*kp.length,yi.addSymbols(yi.icon,kp,zu,$f,Qf,uo,so.vertical,Fo,Al.lineStartIndex,Al.lineLength,-1,sa),vp=yi.icon.placedSymbolArray.length-1)}for(var hd in es.horizontal){var ih=es.horizontal[hd];if(!Ms){ad=Y(ih.text);var U_=aa.layout.get("text-rotate").evaluate(uo,{},sa);Ms=new Nc($c,Fo,Tu,eh,th,ih,_p,Wf,Iu,U_)}var pd=ih.positionedLines.length===1;if(nd+=Af(yi,Fo,ih,Xf,aa,Iu,uo,Hf,Al,es.vertical?so.horizontal:so.horizontalOnly,pd?Object.keys(es.horizontal):[hd],Ra,gp,rh,sa),pd)break}es.vertical&&(od+=Af(yi,Fo,es.vertical,Xf,aa,Iu,uo,Hf,Al,so.vertical,["vertical"],Ra,vp,rh,sa));var V_=Ms?Ms.boxStartIndex:yi.collisionBoxArray.length,j_=Ms?Ms.boxEndIndex:yi.collisionBoxArray.length,q_=Il?Il.boxStartIndex:yi.collisionBoxArray.length,Z_=Il?Il.boxEndIndex:yi.collisionBoxArray.length,G_=Tl?Tl.boxStartIndex:yi.collisionBoxArray.length,K_=Tl?Tl.boxEndIndex:yi.collisionBoxArray.length,X_=zl?zl.boxStartIndex:yi.collisionBoxArray.length,W_=zl?zl.boxEndIndex:yi.collisionBoxArray.length,la=-1,nh=function(Au,dd){return Au&&Au.circleDiameter?Math.max(Au.circleDiameter,dd):dd};la=nh(Ms,la),la=nh(Il,la),la=nh(Tl,la);var fd=(la=nh(zl,la))>-1?1:0;fd&&(la*=N_/24),yi.glyphOffsetArray.length>=Rr.MAX_GLYPHS&&yt("Too many glyphs being rendered in a tile. See https://github.com/mapbox/mapbox-gl-js/issues/2907"),uo.sortKey!==void 0&&yi.addToSortKeyRanges(yi.symbolInstances.length,uo.sortKey),yi.symbolInstances.emplaceBack(Fo.x,Fo.y,Ra.right>=0?Ra.right:-1,Ra.center>=0?Ra.center:-1,Ra.left>=0?Ra.left:-1,Ra.vertical||-1,gp,vp,ad,V_,j_,q_,Z_,G_,K_,X_,W_,Tu,nd,od,rd,id,fd,0,_p,bp,xp,la)}(pr,Eu,O_,Mr,gr,Mn,na,pr.layers[0],pr.collisionBoxArray,Or.index,Or.sourceLayerIndex,pr.index,Ps,Zc,Gc,pn,Da,bl,Kc,oa,Or,hn,Sr,ia,Kr)};if(La==="line")for(var wl=0,Xc=Ef(Or.geometry,0,0,8192,8192);wl<Xc.length;wl+=1)for(var Wc=Xc[wl],gu=0,vu=b_(Wc,vl,yu,Mr.vertical||Po,gr,24,gl,pr.overscaling,8192);gu<vu.length;gu+=1){var Hc=vu[gu];Po&&S_(pr,Po.text,_u,Hc)||$a(Wc,Hc)}else if(La==="line-center")for(var bu=0,xu=Or.geometry;bu<xu.length;bu+=1){var wu=xu[bu];if(wu.length>1){var Jc=v_(wu,yu,Mr.vertical||Po,gr,24,gl);Jc&&$a(wu,Jc)}}else if(Or.type==="Polygon")for(var kl=0,Yc=$h(Or.geometry,0);kl<Yc.length;kl+=1){var Sl=Yc[kl],ku=w_(Sl,16);$a(Sl[0],new cl(ku.x,ku.y,0))}else if(Or.type==="LineString")for(var Cs=0,Su=Or.geometry;Cs<Su.length;Cs+=1){var El=Su[Cs];$a(El,new cl(El[0].x,El[0].y,0))}else if(Or.type==="Point")for(var fp=0,Gf=Or.geometry;fp<Gf.length;fp+=1)for(var dp=0,Kf=Gf[fp];dp<Kf.length;dp+=1){var mp=Kf[dp];$a([mp],new cl(mp.x,mp.y,0))}}(e,Ie,tt,Xi,l,A,He,ft,it,En,x)},be=0,ke=e.features;be<ke.length;be+=1)de();m&&e.generateCollisionDebugBuffers()},o.perspective=function(e,t,i,l,p){var m,x=1/Math.tan(t/2);return e[0]=x/i,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=x,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[11]=-1,e[12]=0,e[13]=0,e[15]=0,p!=null&&p!==1/0?(e[10]=(p+l)*(m=1/(l-p)),e[14]=2*p*l*m):(e[10]=-1,e[14]=-2*l),e},o.pick=function(e,t){for(var i={},l=0;l<t.length;l++){var p=t[l];p in e&&(i[p]=e[p])}return i},o.plugin=Qn,o.polygonIntersectsPolygon=ea,o.postMapLoadEvent=Oi,o.postTurnstileEvent=Yi,o.potpack=df,o.refProperties=["type","source","source-layer","minzoom","maxzoom","filter","layout"],o.register=st,o.registerForPluginStateChange=function(e){return e({pluginStatus:qn,pluginURL:Do}),Yl.on("pluginStateChange",e),e},o.renderColorRamp=Wp,o.rotate=function(e,t,i){var l=t[0],p=t[1],m=t[2],x=t[3],S=Math.sin(i),I=Math.cos(i);return e[0]=l*I+m*S,e[1]=p*I+x*S,e[2]=l*-S+m*I,e[3]=p*-S+x*I,e},o.rotateX=function(e,t,i){var l=Math.sin(i),p=Math.cos(i),m=t[4],x=t[5],S=t[6],I=t[7],A=t[8],C=t[9],B=t[10],U=t[11];return t!==e&&(e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e[4]=m*p+A*l,e[5]=x*p+C*l,e[6]=S*p+B*l,e[7]=I*p+U*l,e[8]=A*p-m*l,e[9]=C*p-x*l,e[10]=B*p-S*l,e[11]=U*p-I*l,e},o.rotateZ=function(e,t,i){var l=Math.sin(i),p=Math.cos(i),m=t[0],x=t[1],S=t[2],I=t[3],A=t[4],C=t[5],B=t[6],U=t[7];return t!==e&&(e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e[0]=m*p+A*l,e[1]=x*p+C*l,e[2]=S*p+B*l,e[3]=I*p+U*l,e[4]=A*p-m*l,e[5]=C*p-x*l,e[6]=B*p-S*l,e[7]=U*p-I*l,e},o.scale=function(e,t,i){var l=i[0],p=i[1],m=i[2];return e[0]=t[0]*l,e[1]=t[1]*l,e[2]=t[2]*l,e[3]=t[3]*l,e[4]=t[4]*p,e[5]=t[5]*p,e[6]=t[6]*p,e[7]=t[7]*p,e[8]=t[8]*m,e[9]=t[9]*m,e[10]=t[10]*m,e[11]=t[11]*m,e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15],e},o.scale$1=function(e,t,i){return e[0]=t[0]*i,e[1]=t[1]*i,e[2]=t[2]*i,e[3]=t[3]*i,e},o.scale$2=function(e,t,i){return e[0]=t[0]*i,e[1]=t[1]*i,e[2]=t[2]*i,e},o.setCacheLimits=function(e,t){In=e,Qi=t},o.setRTLTextPlugin=function(e,t,i){if(i===void 0&&(i=!1),qn==="deferred"||qn==="loading"||qn==="loaded")throw new Error("setRTLTextPlugin cannot be called multiple times.");Do=Qr.resolveURL(e),qn="deferred",Js=t,gs(),i||mo()},o.sphericalToCartesian=function(e){var t=e[0],i=e[1],l=e[2];return i+=90,i*=Math.PI/180,l*=Math.PI/180,{x:t*Math.cos(i)*Math.sin(l),y:t*Math.sin(i)*Math.sin(l),z:t*Math.cos(l)}},o.sqrLen=function(e){var t=e[0],i=e[1];return t*t+i*i},o.styleSpec=j,o.sub=function(e,t,i){return e[0]=t[0]-i[0],e[1]=t[1]-i[1],e[2]=t[2]-i[2],e},o.symbolSize=g_,o.transformMat3=function(e,t,i){var l=t[0],p=t[1],m=t[2];return e[0]=l*i[0]+p*i[3]+m*i[6],e[1]=l*i[1]+p*i[4]+m*i[7],e[2]=l*i[2]+p*i[5]+m*i[8],e},o.transformMat4=rl,o.translate=function(e,t,i){var l,p,m,x,S,I,A,C,B,U,q,Q,ee=i[0],ce=i[1],ie=i[2];return t===e?(e[12]=t[0]*ee+t[4]*ce+t[8]*ie+t[12],e[13]=t[1]*ee+t[5]*ce+t[9]*ie+t[13],e[14]=t[2]*ee+t[6]*ce+t[10]*ie+t[14],e[15]=t[3]*ee+t[7]*ce+t[11]*ie+t[15]):(p=t[1],m=t[2],x=t[3],S=t[4],I=t[5],A=t[6],C=t[7],B=t[8],U=t[9],q=t[10],Q=t[11],e[0]=l=t[0],e[1]=p,e[2]=m,e[3]=x,e[4]=S,e[5]=I,e[6]=A,e[7]=C,e[8]=B,e[9]=U,e[10]=q,e[11]=Q,e[12]=l*ee+S*ce+B*ie+t[12],e[13]=p*ee+I*ce+U*ie+t[13],e[14]=m*ee+A*ce+q*ie+t[14],e[15]=x*ee+C*ce+Q*ie+t[15]),e},o.triggerPluginCompletionEvent=Sc,o.uniqueId=Je,o.validateCustomStyleLayer=function(e){var t=[],i=e.id;return i===void 0&&t.push({message:"layers."+i+': missing required property "id"'}),e.render===void 0&&t.push({message:"layers."+i+': missing required method "render"'}),e.renderingMode&&e.renderingMode!=="2d"&&e.renderingMode!=="3d"&&t.push({message:"layers."+i+': property "renderingMode" must be either "2d" or "3d"'}),t},o.validateLight=Zh,o.validateStyle=ds,o.values=function(e){var t=[];for(var i in e)t.push(e[i]);return t},o.vectorTile=al,o.version="1.13.2",o.warnOnce=yt,o.webpSupported=Ur,o.window=D,o.wrap=me}),v(["./shared"],function(o){function z(L){var N=typeof L;if(N==="number"||N==="boolean"||N==="string"||L==null)return JSON.stringify(L);if(Array.isArray(L)){for(var V="[",X=0,$=L;X<$.length;X+=1)V+=z($[X])+",";return V+"]"}for(var se=Object.keys(L).sort(),pe="{",j=0;j<se.length;j++)pe+=JSON.stringify(se[j])+":"+z(L[se[j]])+",";return pe+"}"}function T(L){for(var N="",V=0,X=o.refProperties;V<X.length;V+=1)N+="/"+z(L[X[V]]);return N}var M=function(L){this.keyCache={},L&&this.replace(L)};M.prototype.replace=function(L){this._layerConfigs={},this._layers={},this.update(L,[])},M.prototype.update=function(L,N){for(var V=this,X=0,$=L;X<$.length;X+=1){var se=$[X];this._layerConfigs[se.id]=se;var pe=this._layers[se.id]=o.createStyleLayer(se);pe._featureFilter=o.featureFilter(pe.filter),this.keyCache[se.id]&&delete this.keyCache[se.id]}for(var j=0,J=N;j<J.length;j+=1){var _e=J[j];delete this.keyCache[_e],delete this._layerConfigs[_e],delete this._layers[_e]}this.familiesBySource={};for(var Ce=0,Me=function(Oe,je){for(var Mt={},qe=0;qe<Oe.length;qe++){var Vt=je&&je[Oe[qe].id]||T(Oe[qe]);je&&(je[Oe[qe].id]=Vt);var lr=Mt[Vt];lr||(lr=Mt[Vt]=[]),lr.push(Oe[qe])}var Pt=[];for(var er in Mt)Pt.push(Mt[er]);return Pt}(o.values(this._layerConfigs),this.keyCache);Ce<Me.length;Ce+=1){var W=Me[Ce].map(function(Oe){return V._layers[Oe.id]}),we=W[0];if(we.visibility!=="none"){var $e=we.source||"",Xe=this.familiesBySource[$e];Xe||(Xe=this.familiesBySource[$e]={});var Se=we.sourceLayer||"_geojsonTileLayer",We=Xe[Se];We||(We=Xe[Se]=[]),We.push(W)}}};var F=function(L){var N={},V=[];for(var X in L){var $=L[X],se=N[X]={};for(var pe in $){var j=$[+pe];if(j&&j.bitmap.width!==0&&j.bitmap.height!==0){var J={x:0,y:0,w:j.bitmap.width+2,h:j.bitmap.height+2};V.push(J),se[pe]={rect:J,metrics:j.metrics}}}}var _e=o.potpack(V),Ce=new o.AlphaImage({width:_e.w||1,height:_e.h||1});for(var Me in L){var W=L[Me];for(var we in W){var $e=W[+we];if($e&&$e.bitmap.width!==0&&$e.bitmap.height!==0){var Xe=N[Me][we].rect;o.AlphaImage.copy($e.bitmap,Ce,{x:0,y:0},{x:Xe.x+1,y:Xe.y+1},$e.bitmap)}}}this.image=Ce,this.positions=N};o.register("GlyphAtlas",F);var R=function(L){this.tileID=new o.OverscaledTileID(L.tileID.overscaledZ,L.tileID.wrap,L.tileID.canonical.z,L.tileID.canonical.x,L.tileID.canonical.y),this.uid=L.uid,this.zoom=L.zoom,this.pixelRatio=L.pixelRatio,this.tileSize=L.tileSize,this.source=L.source,this.overscaling=this.tileID.overscaleFactor(),this.showCollisionBoxes=L.showCollisionBoxes,this.collectResourceTiming=!!L.collectResourceTiming,this.returnDependencies=!!L.returnDependencies,this.promoteId=L.promoteId};function D(L,N,V){for(var X=new o.EvaluationParameters(N),$=0,se=L;$<se.length;$+=1)se[$].recalculate(X,V)}function H(L,N){var V=o.getArrayBuffer(L.request,function(X,$,se,pe){X?N(X):$&&N(null,{vectorTile:new o.vectorTile.VectorTile(new o.pbf($)),rawData:$,cacheControl:se,expires:pe})});return function(){V.cancel(),N()}}R.prototype.parse=function(L,N,V,X,$){var se=this;this.status="parsing",this.data=L,this.collisionBoxArray=new o.CollisionBoxArray;var pe=new o.DictionaryCoder(Object.keys(L.layers).sort()),j=new o.FeatureIndex(this.tileID,this.promoteId);j.bucketLayerIDs=[];var J,_e,Ce,Me,W={},we={featureIndex:j,iconDependencies:{},patternDependencies:{},glyphDependencies:{},availableImages:V},$e=N.familiesBySource[this.source];for(var Xe in $e){var Se=L.layers[Xe];if(Se){Se.version===1&&o.warnOnce('Vector tile source "'+this.source+'" layer "'+Xe+'" does not use vector tile spec v2 and therefore may have some rendering errors.');for(var We=pe.encode(Xe),Oe=[],je=0;je<Se.length;je++){var Mt=Se.feature(je),qe=j.getId(Mt,Xe);Oe.push({feature:Mt,id:qe,index:je,sourceLayerIndex:We})}for(var Vt=0,lr=$e[Xe];Vt<lr.length;Vt+=1){var Pt=lr[Vt],er=Pt[0];er.minzoom&&this.zoom<Math.floor(er.minzoom)||er.maxzoom&&this.zoom>=er.maxzoom||er.visibility!=="none"&&(D(Pt,this.zoom,V),(W[er.id]=er.createBucket({index:j.bucketLayerIDs.length,layers:Pt,zoom:this.zoom,pixelRatio:this.pixelRatio,overscaling:this.overscaling,collisionBoxArray:this.collisionBoxArray,sourceLayerIndex:We,sourceID:this.source})).populate(Oe,we,this.tileID.canonical),j.bucketLayerIDs.push(Pt.map(function(dr){return dr.id})))}}}var Ht=o.mapObject(we.glyphDependencies,function(dr){return Object.keys(dr).map(Number)});Object.keys(Ht).length?X.send("getGlyphs",{uid:this.uid,stacks:Ht},function(dr,Gt){J||(J=dr,_e=Gt,vr.call(se))}):_e={};var ti=Object.keys(we.iconDependencies);ti.length?X.send("getImages",{icons:ti,source:this.source,tileID:this.tileID,type:"icons"},function(dr,Gt){J||(J=dr,Ce=Gt,vr.call(se))}):Ce={};var Qt=Object.keys(we.patternDependencies);function vr(){if(J)return $(J);if(_e&&Ce&&Me){var dr=new F(_e),Gt=new o.ImageAtlas(Ce,Me);for(var tr in W){var oi=W[tr];oi instanceof o.SymbolBucket?(D(oi.layers,this.zoom,V),o.performSymbolLayout(oi,_e,dr.positions,Ce,Gt.iconPositions,this.showCollisionBoxes,this.tileID.canonical)):oi.hasPattern&&(oi instanceof o.LineBucket||oi instanceof o.FillBucket||oi instanceof o.FillExtrusionBucket)&&(D(oi.layers,this.zoom,V),oi.addFeatures(we,this.tileID.canonical,Gt.patternPositions))}this.status="done",$(null,{buckets:o.values(W).filter(function(Bn){return!Bn.isEmpty()}),featureIndex:j,collisionBoxArray:this.collisionBoxArray,glyphAtlasImage:dr.image,imageAtlas:Gt,glyphMap:this.returnDependencies?_e:null,iconMap:this.returnDependencies?Ce:null,glyphPositions:this.returnDependencies?dr.positions:null})}}Qt.length?X.send("getImages",{icons:Qt,source:this.source,tileID:this.tileID,type:"patterns"},function(dr,Gt){J||(J=dr,Me=Gt,vr.call(se))}):Me={},vr.call(this)};var ne=function(L,N,V,X){this.actor=L,this.layerIndex=N,this.availableImages=V,this.loadVectorData=X||H,this.loading={},this.loaded={}};ne.prototype.loadTile=function(L,N){var V=this,X=L.uid;this.loading||(this.loading={});var $=!!(L&&L.request&&L.request.collectResourceTiming)&&new o.RequestPerformance(L.request),se=this.loading[X]=new R(L);se.abort=this.loadVectorData(L,function(pe,j){if(delete V.loading[X],pe||!j)return se.status="done",V.loaded[X]=se,N(pe);var J=j.rawData,_e={};j.expires&&(_e.expires=j.expires),j.cacheControl&&(_e.cacheControl=j.cacheControl);var Ce={};if($){var Me=$.finish();Me&&(Ce.resourceTiming=JSON.parse(JSON.stringify(Me)))}se.vectorTile=j.vectorTile,se.parse(j.vectorTile,V.layerIndex,V.availableImages,V.actor,function(W,we){if(W||!we)return N(W);N(null,o.extend({rawTileData:J.slice(0)},we,_e,Ce))}),V.loaded=V.loaded||{},V.loaded[X]=se})},ne.prototype.reloadTile=function(L,N){var V=this,X=this.loaded,$=L.uid,se=this;if(X&&X[$]){var pe=X[$];pe.showCollisionBoxes=L.showCollisionBoxes;var j=function(J,_e){var Ce=pe.reloadCallback;Ce&&(delete pe.reloadCallback,pe.parse(pe.vectorTile,se.layerIndex,V.availableImages,se.actor,Ce)),N(J,_e)};pe.status==="parsing"?pe.reloadCallback=j:pe.status==="done"&&(pe.vectorTile?pe.parse(pe.vectorTile,this.layerIndex,this.availableImages,this.actor,j):j())}},ne.prototype.abortTile=function(L,N){var V=this.loading,X=L.uid;V&&V[X]&&V[X].abort&&(V[X].abort(),delete V[X]),N()},ne.prototype.removeTile=function(L,N){var V=this.loaded,X=L.uid;V&&V[X]&&delete V[X],N()};var he=o.window.ImageBitmap,ve=function(){this.loaded={}};function me(L,N){if(L.length!==0){xe(L[0],N);for(var V=1;V<L.length;V++)xe(L[V],!N)}}function xe(L,N){for(var V=0,X=0,$=L.length,se=$-1;X<$;se=X++)V+=(L[X][0]-L[se][0])*(L[se][1]+L[X][1]);V>=0!=!!N&&L.reverse()}ve.prototype.loadTile=function(L,N){var V=L.uid,X=L.encoding,$=L.rawImageData,se=he&&$ instanceof he?this.getImageData($):$,pe=new o.DEMData(V,se,X);this.loaded=this.loaded||{},this.loaded[V]=pe,N(null,pe)},ve.prototype.getImageData=function(L){this.offscreenCanvas&&this.offscreenCanvasContext||(this.offscreenCanvas=new OffscreenCanvas(L.width,L.height),this.offscreenCanvasContext=this.offscreenCanvas.getContext("2d")),this.offscreenCanvas.width=L.width,this.offscreenCanvas.height=L.height,this.offscreenCanvasContext.drawImage(L,0,0,L.width,L.height);var N=this.offscreenCanvasContext.getImageData(-1,-1,L.width+2,L.height+2);return this.offscreenCanvasContext.clearRect(0,0,this.offscreenCanvas.width,this.offscreenCanvas.height),new o.RGBAImage({width:N.width,height:N.height},N.data)},ve.prototype.removeTile=function(L){var N=this.loaded,V=L.uid;N&&N[V]&&delete N[V]};var ot=o.vectorTile.VectorTileFeature.prototype.toGeoJSON,Je=function(L){this._feature=L,this.extent=o.EXTENT,this.type=L.type,this.properties=L.tags,"id"in L&&!isNaN(L.id)&&(this.id=parseInt(L.id,10))};Je.prototype.loadGeometry=function(){if(this._feature.type===1){for(var L=[],N=0,V=this._feature.geometry;N<V.length;N+=1){var X=V[N];L.push([new o.Point$1(X[0],X[1])])}return L}for(var $=[],se=0,pe=this._feature.geometry;se<pe.length;se+=1){for(var j=[],J=0,_e=pe[se];J<_e.length;J+=1){var Ce=_e[J];j.push(new o.Point$1(Ce[0],Ce[1]))}$.push(j)}return $},Je.prototype.toGeoJSON=function(L,N,V){return ot.call(this,L,N,V)};var Le=function(L){this.layers={_geojsonTileLayer:this},this.name="_geojsonTileLayer",this.extent=o.EXTENT,this.length=L.length,this._features=L};Le.prototype.feature=function(L){return new Je(this._features[L])};var Ye=o.vectorTile.VectorTileFeature,It=Lt;function Lt(L,N){this.options=N||{},this.features=L,this.length=L.length}function jt(L,N){this.id=typeof L.id=="number"?L.id:void 0,this.type=L.type,this.rawGeometry=L.type===1?[L.geometry]:L.geometry,this.properties=L.tags,this.extent=N||4096}Lt.prototype.feature=function(L){return new jt(this.features[L],this.options.extent)},jt.prototype.loadGeometry=function(){var L=this.rawGeometry;this.geometry=[];for(var N=0;N<L.length;N++){for(var V=L[N],X=[],$=0;$<V.length;$++)X.push(new o.Point$1(V[$][0],V[$][1]));this.geometry.push(X)}return this.geometry},jt.prototype.bbox=function(){this.geometry||this.loadGeometry();for(var L=this.geometry,N=1/0,V=-1/0,X=1/0,$=-1/0,se=0;se<L.length;se++)for(var pe=L[se],j=0;j<pe.length;j++){var J=pe[j];N=Math.min(N,J.x),V=Math.max(V,J.x),X=Math.min(X,J.y),$=Math.max($,J.y)}return[N,X,V,$]},jt.prototype.toGeoJSON=Ye.prototype.toGeoJSON;var _t=Ft,ht=It;function Ft(L){var N=new o.pbf;return function(V,X){for(var $ in V.layers)X.writeMessage(3,yt,V.layers[$])}(L,N),N.finish()}function yt(L,N){var V;N.writeVarintField(15,L.version||1),N.writeStringField(1,L.name||""),N.writeVarintField(5,L.extent||4096);var X={keys:[],values:[],keycache:{},valuecache:{}};for(V=0;V<L.length;V++)X.feature=L.feature(V),N.writeMessage(2,zt,X);var $=X.keys;for(V=0;V<$.length;V++)N.writeStringField(3,$[V]);var se=X.values;for(V=0;V<se.length;V++)N.writeMessage(4,Ut,se[V])}function zt(L,N){var V=L.feature;V.id!==void 0&&N.writeVarintField(1,V.id),N.writeMessage(2,et,L),N.writeVarintField(3,V.type),N.writeMessage(4,At,V)}function et(L,N){var V=L.feature,X=L.keys,$=L.values,se=L.keycache,pe=L.valuecache;for(var j in V.properties){var J=se[j];J===void 0&&(X.push(j),se[j]=J=X.length-1),N.writeVarint(J);var _e=V.properties[j],Ce=typeof _e;Ce!=="string"&&Ce!=="boolean"&&Ce!=="number"&&(_e=JSON.stringify(_e));var Me=Ce+":"+_e,W=pe[Me];W===void 0&&($.push(_e),pe[Me]=W=$.length-1),N.writeVarint(W)}}function qt(L,N){return(N<<3)+(7&L)}function pt(L){return L<<1^L>>31}function At(L,N){for(var V=L.loadGeometry(),X=L.type,$=0,se=0,pe=V.length,j=0;j<pe;j++){var J=V[j],_e=1;X===1&&(_e=J.length),N.writeVarint(qt(1,_e));for(var Ce=X===3?J.length-1:J.length,Me=0;Me<Ce;Me++){Me===1&&X!==1&&N.writeVarint(qt(2,Ce-1));var W=J[Me].x-$,we=J[Me].y-se;N.writeVarint(pt(W)),N.writeVarint(pt(we)),$+=W,se+=we}X===3&&N.writeVarint(qt(7,1))}}function Ut(L,N){var V=typeof L;V==="string"?N.writeStringField(1,L):V==="boolean"?N.writeBooleanField(7,L):V==="number"&&(L%1!=0?N.writeDoubleField(3,L):L<0?N.writeSVarintField(6,L):N.writeVarintField(5,L))}function cr(L,N,V,X){Ve(L,V,X),Ve(N,2*V,2*X),Ve(N,2*V+1,2*X+1)}function Ve(L,N,V){var X=L[N];L[N]=L[V],L[V]=X}function fr(L,N,V,X){var $=L-V,se=N-X;return $*$+se*se}_t.fromVectorTileJs=Ft,_t.fromGeojsonVt=function(L,N){N=N||{};var V={};for(var X in L)V[X]=new It(L[X].features,N),V[X].name=X,V[X].version=N.version,V[X].extent=N.extent;return Ft({layers:V})},_t.GeoJSONWrapper=ht;var hr=function(L){return L[0]},xr=function(L){return L[1]},Fr=function(L,N,V,X,$){N===void 0&&(N=hr),V===void 0&&(V=xr),X===void 0&&(X=64),$===void 0&&($=Float64Array),this.nodeSize=X,this.points=L;for(var se=L.length<65536?Uint16Array:Uint32Array,pe=this.ids=new se(L.length),j=this.coords=new $(2*L.length),J=0;J<L.length;J++)pe[J]=J,j[2*J]=N(L[J]),j[2*J+1]=V(L[J]);(function _e(Ce,Me,W,we,$e,Xe){if(!($e-we<=W)){var Se=we+$e>>1;(function We(Oe,je,Mt,qe,Vt,lr){for(;Vt>qe;){if(Vt-qe>600){var Pt=Vt-qe+1,er=Mt-qe+1,Ht=Math.log(Pt),ti=.5*Math.exp(2*Ht/3),Qt=.5*Math.sqrt(Ht*ti*(Pt-ti)/Pt)*(er-Pt/2<0?-1:1);We(Oe,je,Mt,Math.max(qe,Math.floor(Mt-er*ti/Pt+Qt)),Math.min(Vt,Math.floor(Mt+(Pt-er)*ti/Pt+Qt)),lr)}var vr=je[2*Mt+lr],dr=qe,Gt=Vt;for(cr(Oe,je,qe,Mt),je[2*Vt+lr]>vr&&cr(Oe,je,qe,Vt);dr<Gt;){for(cr(Oe,je,dr,Gt),dr++,Gt--;je[2*dr+lr]<vr;)dr++;for(;je[2*Gt+lr]>vr;)Gt--}je[2*qe+lr]===vr?cr(Oe,je,qe,Gt):cr(Oe,je,++Gt,Vt),Gt<=Mt&&(qe=Gt+1),Mt<=Gt&&(Vt=Gt-1)}})(Ce,Me,Se,we,$e,Xe%2),_e(Ce,Me,W,we,Se-1,Xe+1),_e(Ce,Me,W,Se+1,$e,Xe+1)}})(pe,j,X,0,pe.length-1,0)};Fr.prototype.range=function(L,N,V,X){return function($,se,pe,j,J,_e,Ce){for(var Me,W,we=[0,$.length-1,0],$e=[];we.length;){var Xe=we.pop(),Se=we.pop(),We=we.pop();if(Se-We<=Ce)for(var Oe=We;Oe<=Se;Oe++)W=se[2*Oe+1],(Me=se[2*Oe])>=pe&&Me<=J&&W>=j&&W<=_e&&$e.push($[Oe]);else{var je=Math.floor((We+Se)/2);W=se[2*je+1],(Me=se[2*je])>=pe&&Me<=J&&W>=j&&W<=_e&&$e.push($[je]);var Mt=(Xe+1)%2;(Xe===0?pe<=Me:j<=W)&&(we.push(We),we.push(je-1),we.push(Mt)),(Xe===0?J>=Me:_e>=W)&&(we.push(je+1),we.push(Se),we.push(Mt))}}return $e}(this.ids,this.coords,L,N,V,X,this.nodeSize)},Fr.prototype.within=function(L,N,V){return function(X,$,se,pe,j,J){for(var _e=[0,X.length-1,0],Ce=[],Me=j*j;_e.length;){var W=_e.pop(),we=_e.pop(),$e=_e.pop();if(we-$e<=J)for(var Xe=$e;Xe<=we;Xe++)fr($[2*Xe],$[2*Xe+1],se,pe)<=Me&&Ce.push(X[Xe]);else{var Se=Math.floor(($e+we)/2),We=$[2*Se],Oe=$[2*Se+1];fr(We,Oe,se,pe)<=Me&&Ce.push(X[Se]);var je=(W+1)%2;(W===0?se-j<=We:pe-j<=Oe)&&(_e.push($e),_e.push(Se-1),_e.push(je)),(W===0?se+j>=We:pe+j>=Oe)&&(_e.push(Se+1),_e.push(we),_e.push(je))}}return Ce}(this.ids,this.coords,L,N,V,this.nodeSize)};var wi={minZoom:0,maxZoom:16,minPoints:2,radius:40,extent:512,nodeSize:64,log:!1,generateId:!1,reduce:null,map:function(L){return L}},sr=function(L){this.options=$t(Object.create(wi),L),this.trees=new Array(this.options.maxZoom+1)};function Qr(L,N,V,X,$){return{x:L,y:N,zoom:1/0,id:V,parentId:-1,numPoints:X,properties:$}}function kt(L,N){var V=L.geometry.coordinates,X=V[1];return{x:$r(V[0]),y:Zt(X),zoom:1/0,index:N,parentId:-1}}function Ur(L){return{type:"Feature",id:L.id,properties:Tn(L),geometry:{type:"Point",coordinates:[(X=L.x,360*(X-.5)),(N=L.y,V=(180-360*N)*Math.PI/180,360*Math.atan(Math.exp(V))/Math.PI-90)]}};var N,V,X}function Tn(L){var N=L.numPoints,V=N>=1e4?Math.round(N/1e3)+"k":N>=1e3?Math.round(N/100)/10+"k":N;return $t($t({},L.properties),{cluster:!0,cluster_id:L.id,point_count:N,point_count_abbreviated:V})}function $r(L){return L/360+.5}function Zt(L){var N=Math.sin(L*Math.PI/180),V=.5-.25*Math.log((1+N)/(1-N))/Math.PI;return V<0?0:V>1?1:V}function $t(L,N){for(var V in N)L[V]=N[V];return L}function Dr(L){return L.x}function Pr(L){return L.y}function Dn(L,N,V,X,$,se){var pe=$-V,j=se-X;if(pe!==0||j!==0){var J=((L-V)*pe+(N-X)*j)/(pe*pe+j*j);J>1?(V=$,X=se):J>0&&(V+=pe*J,X+=j*J)}return(pe=L-V)*pe+(j=N-X)*j}function Xr(L,N,V,X){var $={id:L===void 0?null:L,type:N,geometry:V,tags:X,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0};return function(se){var pe=se.geometry,j=se.type;if(j==="Point"||j==="MultiPoint"||j==="LineString")gi(se,pe);else if(j==="Polygon"||j==="MultiLineString")for(var J=0;J<pe.length;J++)gi(se,pe[J]);else if(j==="MultiPolygon")for(J=0;J<pe.length;J++)for(var _e=0;_e<pe[J].length;_e++)gi(se,pe[J][_e])}($),$}function gi(L,N){for(var V=0;V<N.length;V+=3)L.minX=Math.min(L.minX,N[V]),L.minY=Math.min(L.minY,N[V+1]),L.maxX=Math.max(L.maxX,N[V]),L.maxY=Math.max(L.maxY,N[V+1])}function ci(L,N,V,X){if(N.geometry){var $=N.geometry.coordinates,se=N.geometry.type,pe=Math.pow(V.tolerance/((1<<V.maxZoom)*V.extent),2),j=[],J=N.id;if(V.promoteId?J=N.properties[V.promoteId]:V.generateId&&(J=X||0),se==="Point")Ji($,j);else if(se==="MultiPoint")for(var _e=0;_e<$.length;_e++)Ji($[_e],j);else if(se==="LineString")Ci($,j,pe,!1);else if(se==="MultiLineString"){if(V.lineMetrics){for(_e=0;_e<$.length;_e++)Ci($[_e],j=[],pe,!1),L.push(Xr(J,"LineString",j,N.properties));return}hi($,j,pe,!1)}else if(se==="Polygon")hi($,j,pe,!0);else{if(se!=="MultiPolygon"){if(se==="GeometryCollection"){for(_e=0;_e<N.geometry.geometries.length;_e++)ci(L,{id:J,geometry:N.geometry.geometries[_e],properties:N.properties},V,X);return}throw new Error("Input data is not a valid GeoJSON object.")}for(_e=0;_e<$.length;_e++){var Ce=[];hi($[_e],Ce,pe,!0),j.push(Ce)}}L.push(Xr(J,se,j,N.properties))}}function Ji(L,N){N.push(ei(L[0])),N.push(on(L[1])),N.push(0)}function Ci(L,N,V,X){for(var $,se,pe=0,j=0;j<L.length;j++){var J=ei(L[j][0]),_e=on(L[j][1]);N.push(J),N.push(_e),N.push(0),j>0&&(pe+=X?($*_e-J*se)/2:Math.sqrt(Math.pow(J-$,2)+Math.pow(_e-se,2))),$=J,se=_e}var Ce=N.length-3;N[2]=1,function Me(W,we,$e,Xe){for(var Se,We=Xe,Oe=$e-we>>1,je=$e-we,Mt=W[we],qe=W[we+1],Vt=W[$e],lr=W[$e+1],Pt=we+3;Pt<$e;Pt+=3){var er=Dn(W[Pt],W[Pt+1],Mt,qe,Vt,lr);if(er>We)Se=Pt,We=er;else if(er===We){var Ht=Math.abs(Pt-Oe);Ht<je&&(Se=Pt,je=Ht)}}We>Xe&&(Se-we>3&&Me(W,we,Se,Xe),W[Se+2]=We,$e-Se>3&&Me(W,Se,$e,Xe))}(N,0,Ce,V),N[Ce+2]=1,N.size=Math.abs(pe),N.start=0,N.end=N.size}function hi(L,N,V,X){for(var $=0;$<L.length;$++){var se=[];Ci(L[$],se,V,X),N.push(se)}}function ei(L){return L/360+.5}function on(L){var N=Math.sin(L*Math.PI/180),V=.5-.25*Math.log((1+N)/(1-N))/Math.PI;return V<0?0:V>1?1:V}function pi(L,N,V,X,$,se,pe,j){if(X/=N,se>=(V/=N)&&pe<X)return L;if(pe<V||se>=X)return null;for(var J=[],_e=0;_e<L.length;_e++){var Ce=L[_e],Me=Ce.geometry,W=Ce.type,we=$===0?Ce.minX:Ce.minY,$e=$===0?Ce.maxX:Ce.maxY;if(we>=V&&$e<X)J.push(Ce);else if(!($e<V||we>=X)){var Xe=[];if(W==="Point"||W==="MultiPoint")Nr(Me,Xe,V,X,$);else if(W==="LineString")Yi(Me,Xe,V,X,$,!1,j.lineMetrics);else if(W==="MultiLineString")Oi(Me,Xe,V,X,$,!1);else if(W==="Polygon")Oi(Me,Xe,V,X,$,!0);else if(W==="MultiPolygon")for(var Se=0;Se<Me.length;Se++){var We=[];Oi(Me[Se],We,V,X,$,!0),We.length&&Xe.push(We)}if(Xe.length){if(j.lineMetrics&&W==="LineString"){for(Se=0;Se<Xe.length;Se++)J.push(Xr(Ce.id,W,Xe[Se],Ce.tags));continue}W!=="LineString"&&W!=="MultiLineString"||(Xe.length===1?(W="LineString",Xe=Xe[0]):W="MultiLineString"),W!=="Point"&&W!=="MultiPoint"||(W=Xe.length===3?"Point":"MultiPoint"),J.push(Xr(Ce.id,W,Xe,Ce.tags))}}}return J.length?J:null}function Nr(L,N,V,X,$){for(var se=0;se<L.length;se+=3){var pe=L[se+$];pe>=V&&pe<=X&&(N.push(L[se]),N.push(L[se+1]),N.push(L[se+2]))}}function Yi(L,N,V,X,$,se,pe){for(var j,J,_e=Ln(L),Ce=$===0?Qi:zn,Me=L.start,W=0;W<L.length-3;W+=3){var we=L[W],$e=L[W+1],Xe=L[W+2],Se=L[W+3],We=L[W+4],Oe=$===0?we:$e,je=$===0?Se:We,Mt=!1;pe&&(j=Math.sqrt(Math.pow(we-Se,2)+Math.pow($e-We,2))),Oe<V?je>V&&(J=Ce(_e,we,$e,Se,We,V),pe&&(_e.start=Me+j*J)):Oe>X?je<X&&(J=Ce(_e,we,$e,Se,We,X),pe&&(_e.start=Me+j*J)):In(_e,we,$e,Xe),je<V&&Oe>=V&&(J=Ce(_e,we,$e,Se,We,V),Mt=!0),je>X&&Oe<=X&&(J=Ce(_e,we,$e,Se,We,X),Mt=!0),!se&&Mt&&(pe&&(_e.end=Me+j*J),N.push(_e),_e=Ln(L)),pe&&(Me+=j)}var qe=L.length-3;we=L[qe],$e=L[qe+1],Xe=L[qe+2],(Oe=$===0?we:$e)>=V&&Oe<=X&&In(_e,we,$e,Xe),qe=_e.length-3,se&&qe>=3&&(_e[qe]!==_e[0]||_e[qe+1]!==_e[1])&&In(_e,_e[0],_e[1],_e[2]),_e.length&&N.push(_e)}function Ln(L){var N=[];return N.size=L.size,N.start=L.start,N.end=L.end,N}function Oi(L,N,V,X,$,se){for(var pe=0;pe<L.length;pe++)Yi(L[pe],N,V,X,$,se,!1)}function In(L,N,V,X){L.push(N),L.push(V),L.push(X)}function Qi(L,N,V,X,$,se){var pe=(se-N)/(X-N);return L.push(se),L.push(V+($-V)*pe),L.push(1),pe}function zn(L,N,V,X,$,se){var pe=(se-V)/($-V);return L.push(N+(X-N)*pe),L.push(se),L.push(1),pe}function Fi(L,N){for(var V=[],X=0;X<L.length;X++){var $,se=L[X],pe=se.type;if(pe==="Point"||pe==="MultiPoint"||pe==="LineString")$=yn(se.geometry,N);else if(pe==="MultiLineString"||pe==="Polygon"){$=[];for(var j=0;j<se.geometry.length;j++)$.push(yn(se.geometry[j],N))}else if(pe==="MultiPolygon")for($=[],j=0;j<se.geometry.length;j++){for(var J=[],_e=0;_e<se.geometry[j].length;_e++)J.push(yn(se.geometry[j][_e],N));$.push(J)}V.push(Xr(se.id,pe,$,se.tags))}return V}function yn(L,N){var V=[];V.size=L.size,L.start!==void 0&&(V.start=L.start,V.end=L.end);for(var X=0;X<L.length;X+=3)V.push(L[X]+N,L[X+1],L[X+2]);return V}function Ni(L,N){if(L.transformed)return L;var V,X,$,se=1<<L.z,pe=L.x,j=L.y;for(V=0;V<L.features.length;V++){var J=L.features[V],_e=J.geometry,Ce=J.type;if(J.geometry=[],Ce===1)for(X=0;X<_e.length;X+=2)J.geometry.push(Rn(_e[X],_e[X+1],N,se,pe,j));else for(X=0;X<_e.length;X++){var Me=[];for($=0;$<_e[X].length;$+=2)Me.push(Rn(_e[X][$],_e[X][$+1],N,se,pe,j));J.geometry.push(Me)}}return L.transformed=!0,L}function Rn(L,N,V,X,$,se){return[Math.round(V*(L*X-$)),Math.round(V*(N*X-se))]}function $i(L,N,V,X,$){for(var se=N===$.maxZoom?0:$.tolerance/((1<<N)*$.extent),pe={features:[],numPoints:0,numSimplified:0,numFeatures:0,source:null,x:V,y:X,z:N,transformed:!1,minX:2,minY:1,maxX:-1,maxY:0},j=0;j<L.length;j++){pe.numFeatures++,Ui(pe,L[j],se,$);var J=L[j].minX,_e=L[j].minY,Ce=L[j].maxX,Me=L[j].maxY;J<pe.minX&&(pe.minX=J),_e<pe.minY&&(pe.minY=_e),Ce>pe.maxX&&(pe.maxX=Ce),Me>pe.maxY&&(pe.maxY=Me)}return pe}function Ui(L,N,V,X){var $=N.geometry,se=N.type,pe=[];if(se==="Point"||se==="MultiPoint")for(var j=0;j<$.length;j+=3)pe.push($[j]),pe.push($[j+1]),L.numPoints++,L.numSimplified++;else if(se==="LineString")_n(pe,$,L,V,!1,!1);else if(se==="MultiLineString"||se==="Polygon")for(j=0;j<$.length;j++)_n(pe,$[j],L,V,se==="Polygon",j===0);else if(se==="MultiPolygon")for(var J=0;J<$.length;J++){var _e=$[J];for(j=0;j<_e.length;j++)_n(pe,_e[j],L,V,!0,j===0)}if(pe.length){var Ce=N.tags||null;if(se==="LineString"&&X.lineMetrics){for(var Me in Ce={},N.tags)Ce[Me]=N.tags[Me];Ce.mapbox_clip_start=$.start/$.size,Ce.mapbox_clip_end=$.end/$.size}var W={geometry:pe,type:se==="Polygon"||se==="MultiPolygon"?3:se==="LineString"||se==="MultiLineString"?2:1,tags:Ce};N.id!==null&&(W.id=N.id),L.features.push(W)}}function _n(L,N,V,X,$,se){var pe=X*X;if(X>0&&N.size<($?pe:X))V.numPoints+=N.length/3;else{for(var j=[],J=0;J<N.length;J+=3)(X===0||N[J+2]>pe)&&(V.numSimplified++,j.push(N[J]),j.push(N[J+1])),V.numPoints++;$&&function(_e,Ce){for(var Me=0,W=0,we=_e.length,$e=we-2;W<we;$e=W,W+=2)Me+=(_e[W]-_e[$e])*(_e[W+1]+_e[$e+1]);if(Me>0===Ce)for(W=0,we=_e.length;W<we/2;W+=2){var Xe=_e[W],Se=_e[W+1];_e[W]=_e[we-2-W],_e[W+1]=_e[we-1-W],_e[we-2-W]=Xe,_e[we-1-W]=Se}}(j,se),L.push(j)}}function an(L,N){var V=(N=this.options=function($,se){for(var pe in se)$[pe]=se[pe];return $}(Object.create(this.options),N)).debug;if(V&&console.time("preprocess data"),N.maxZoom<0||N.maxZoom>24)throw new Error("maxZoom should be in the 0-24 range");if(N.promoteId&&N.generateId)throw new Error("promoteId and generateId cannot be used together.");var X=function($,se){var pe=[];if($.type==="FeatureCollection")for(var j=0;j<$.features.length;j++)ci(pe,$.features[j],se,j);else ci(pe,$.type==="Feature"?$:{geometry:$},se);return pe}(L,N);this.tiles={},this.tileCoords=[],V&&(console.timeEnd("preprocess data"),console.log("index: maxZoom: %d, maxPoints: %d",N.indexMaxZoom,N.indexMaxPoints),console.time("generate tiles"),this.stats={},this.total=0),(X=function($,se){var pe=se.buffer/se.extent,j=$,J=pi($,1,-1-pe,pe,0,-1,2,se),_e=pi($,1,1-pe,2+pe,0,-1,2,se);return(J||_e)&&(j=pi($,1,-pe,1+pe,0,-1,2,se)||[],J&&(j=Fi(J,1).concat(j)),_e&&(j=j.concat(Fi(_e,-1)))),j}(X,N)).length&&this.splitTile(X,0,0,0),V&&(X.length&&console.log("features: %d, points: %d",this.tiles[0].numFeatures,this.tiles[0].numPoints),console.timeEnd("generate tiles"),console.log("tiles generated:",this.total,JSON.stringify(this.stats)))}function sn(L,N,V){return 32*((1<<L)*V+N)+L}function gn(L,N){var V=L.tileID.canonical;if(!this._geoJSONIndex)return N(null,null);var X=this._geoJSONIndex.getTile(V.z,V.x,V.y);if(!X)return N(null,null);var $=new Le(X.features),se=_t($);se.byteOffset===0&&se.byteLength===se.buffer.byteLength||(se=new Uint8Array(se)),N(null,{vectorTile:$,rawData:se.buffer})}sr.prototype.load=function(L){var N=this.options,V=N.log,X=N.minZoom,$=N.maxZoom,se=N.nodeSize;V&&console.time("total time");var pe="prepare "+L.length+" points";V&&console.time(pe),this.points=L;for(var j=[],J=0;J<L.length;J++)L[J].geometry&&j.push(kt(L[J],J));this.trees[$+1]=new Fr(j,Dr,Pr,se,Float32Array),V&&console.timeEnd(pe);for(var _e=$;_e>=X;_e--){var Ce=+Date.now();j=this._cluster(j,_e),this.trees[_e]=new Fr(j,Dr,Pr,se,Float32Array),V&&console.log("z%d: %d clusters in %dms",_e,j.length,+Date.now()-Ce)}return V&&console.timeEnd("total time"),this},sr.prototype.getClusters=function(L,N){var V=((L[0]+180)%360+360)%360-180,X=Math.max(-90,Math.min(90,L[1])),$=L[2]===180?180:((L[2]+180)%360+360)%360-180,se=Math.max(-90,Math.min(90,L[3]));if(L[2]-L[0]>=360)V=-180,$=180;else if(V>$){var pe=this.getClusters([V,X,180,se],N),j=this.getClusters([-180,X,$,se],N);return pe.concat(j)}for(var J=this.trees[this._limitZoom(N)],_e=[],Ce=0,Me=J.range($r(V),Zt(se),$r($),Zt(X));Ce<Me.length;Ce+=1){var W=J.points[Me[Ce]];_e.push(W.numPoints?Ur(W):this.points[W.index])}return _e},sr.prototype.getChildren=function(L){var N=this._getOriginId(L),V=this._getOriginZoom(L),X="No cluster with the specified id.",$=this.trees[V];if(!$)throw new Error(X);var se=$.points[N];if(!se)throw new Error(X);for(var pe=this.options.radius/(this.options.extent*Math.pow(2,V-1)),j=[],J=0,_e=$.within(se.x,se.y,pe);J<_e.length;J+=1){var Ce=$.points[_e[J]];Ce.parentId===L&&j.push(Ce.numPoints?Ur(Ce):this.points[Ce.index])}if(j.length===0)throw new Error(X);return j},sr.prototype.getLeaves=function(L,N,V){var X=[];return this._appendLeaves(X,L,N=N||10,V=V||0,0),X},sr.prototype.getTile=function(L,N,V){var X=this.trees[this._limitZoom(L)],$=Math.pow(2,L),se=this.options,pe=se.radius/se.extent,j=(V-pe)/$,J=(V+1+pe)/$,_e={features:[]};return this._addTileFeatures(X.range((N-pe)/$,j,(N+1+pe)/$,J),X.points,N,V,$,_e),N===0&&this._addTileFeatures(X.range(1-pe/$,j,1,J),X.points,$,V,$,_e),N===$-1&&this._addTileFeatures(X.range(0,j,pe/$,J),X.points,-1,V,$,_e),_e.features.length?_e:null},sr.prototype.getClusterExpansionZoom=function(L){for(var N=this._getOriginZoom(L)-1;N<=this.options.maxZoom;){var V=this.getChildren(L);if(N++,V.length!==1)break;L=V[0].properties.cluster_id}return N},sr.prototype._appendLeaves=function(L,N,V,X,$){for(var se=0,pe=this.getChildren(N);se<pe.length;se+=1){var j=pe[se],J=j.properties;if(J&&J.cluster?$+J.point_count<=X?$+=J.point_count:$=this._appendLeaves(L,J.cluster_id,V,X,$):$<X?$++:L.push(j),L.length===V)break}return $},sr.prototype._addTileFeatures=function(L,N,V,X,$,se){for(var pe=0,j=L;pe<j.length;pe+=1){var J=N[j[pe]],_e=J.numPoints,Ce={type:1,geometry:[[Math.round(this.options.extent*(J.x*$-V)),Math.round(this.options.extent*(J.y*$-X))]],tags:_e?Tn(J):this.points[J.index].properties},Me=void 0;_e?Me=J.id:this.options.generateId?Me=J.index:this.points[J.index].id&&(Me=this.points[J.index].id),Me!==void 0&&(Ce.id=Me),se.features.push(Ce)}},sr.prototype._limitZoom=function(L){return Math.max(this.options.minZoom,Math.min(+L,this.options.maxZoom+1))},sr.prototype._cluster=function(L,N){for(var V=[],X=this.options,$=X.reduce,se=X.minPoints,pe=X.radius/(X.extent*Math.pow(2,N)),j=0;j<L.length;j++){var J=L[j];if(!(J.zoom<=N)){J.zoom=N;for(var _e=this.trees[N+1],Ce=_e.within(J.x,J.y,pe),Me=J.numPoints||1,W=Me,we=0,$e=Ce;we<$e.length;we+=1){var Xe=_e.points[$e[we]];Xe.zoom>N&&(W+=Xe.numPoints||1)}if(W>=se){for(var Se=J.x*Me,We=J.y*Me,Oe=$&&Me>1?this._map(J,!0):null,je=(j<<5)+(N+1)+this.points.length,Mt=0,qe=Ce;Mt<qe.length;Mt+=1){var Vt=_e.points[qe[Mt]];if(!(Vt.zoom<=N)){Vt.zoom=N;var lr=Vt.numPoints||1;Se+=Vt.x*lr,We+=Vt.y*lr,Vt.parentId=je,$&&(Oe||(Oe=this._map(J,!0)),$(Oe,this._map(Vt)))}}J.parentId=je,V.push(Qr(Se/W,We/W,je,W,Oe))}else if(V.push(J),W>1)for(var Pt=0,er=Ce;Pt<er.length;Pt+=1){var Ht=_e.points[er[Pt]];Ht.zoom<=N||(Ht.zoom=N,V.push(Ht))}}}return V},sr.prototype._getOriginId=function(L){return L-this.points.length>>5},sr.prototype._getOriginZoom=function(L){return(L-this.points.length)%32},sr.prototype._map=function(L,N){if(L.numPoints)return N?$t({},L.properties):L.properties;var V=this.points[L.index].properties,X=this.options.map(V);return N&&X===V?$t({},X):X},an.prototype.options={maxZoom:14,indexMaxZoom:5,indexMaxPoints:1e5,tolerance:3,extent:4096,buffer:64,lineMetrics:!1,promoteId:null,generateId:!1,debug:0},an.prototype.splitTile=function(L,N,V,X,$,se,pe){for(var j=[L,N,V,X],J=this.options,_e=J.debug;j.length;){X=j.pop(),V=j.pop(),N=j.pop(),L=j.pop();var Ce=1<<N,Me=sn(N,V,X),W=this.tiles[Me];if(!W&&(_e>1&&console.time("creation"),W=this.tiles[Me]=$i(L,N,V,X,J),this.tileCoords.push({z:N,x:V,y:X}),_e)){_e>1&&(console.log("tile z%d-%d-%d (features: %d, points: %d, simplified: %d)",N,V,X,W.numFeatures,W.numPoints,W.numSimplified),console.timeEnd("creation"));var we="z"+N;this.stats[we]=(this.stats[we]||0)+1,this.total++}if(W.source=L,$){if(N===J.maxZoom||N===$)continue;var $e=1<<$-N;if(V!==Math.floor(se/$e)||X!==Math.floor(pe/$e))continue}else if(N===J.indexMaxZoom||W.numPoints<=J.indexMaxPoints)continue;if(W.source=null,L.length!==0){_e>1&&console.time("clipping");var Xe,Se,We,Oe,je,Mt,qe=.5*J.buffer/J.extent,Vt=.5-qe,lr=.5+qe,Pt=1+qe;Xe=Se=We=Oe=null,je=pi(L,Ce,V-qe,V+lr,0,W.minX,W.maxX,J),Mt=pi(L,Ce,V+Vt,V+Pt,0,W.minX,W.maxX,J),L=null,je&&(Xe=pi(je,Ce,X-qe,X+lr,1,W.minY,W.maxY,J),Se=pi(je,Ce,X+Vt,X+Pt,1,W.minY,W.maxY,J),je=null),Mt&&(We=pi(Mt,Ce,X-qe,X+lr,1,W.minY,W.maxY,J),Oe=pi(Mt,Ce,X+Vt,X+Pt,1,W.minY,W.maxY,J),Mt=null),_e>1&&console.timeEnd("clipping"),j.push(Xe||[],N+1,2*V,2*X),j.push(Se||[],N+1,2*V,2*X+1),j.push(We||[],N+1,2*V+1,2*X),j.push(Oe||[],N+1,2*V+1,2*X+1)}}},an.prototype.getTile=function(L,N,V){var X=this.options,$=X.extent,se=X.debug;if(L<0||L>24)return null;var pe=1<<L,j=sn(L,N=(N%pe+pe)%pe,V);if(this.tiles[j])return Ni(this.tiles[j],$);se>1&&console.log("drilling down to z%d-%d-%d",L,N,V);for(var J,_e=L,Ce=N,Me=V;!J&&_e>0;)_e--,Ce=Math.floor(Ce/2),Me=Math.floor(Me/2),J=this.tiles[sn(_e,Ce,Me)];return J&&J.source?(se>1&&console.log("found parent tile z%d-%d-%d",_e,Ce,Me),se>1&&console.time("drilling down"),this.splitTile(J.source,_e,Ce,Me,L,N,V),se>1&&console.timeEnd("drilling down"),this.tiles[j]?Ni(this.tiles[j],$):null):null};var ni=function(L){function N(V,X,$,se){L.call(this,V,X,$,gn),se&&(this.loadGeoJSON=se)}return L&&(N.__proto__=L),(N.prototype=Object.create(L&&L.prototype)).constructor=N,N.prototype.loadData=function(V,X){this._pendingCallback&&this._pendingCallback(null,{abandoned:!0}),this._pendingCallback=X,this._pendingLoadDataParams=V,this._state&&this._state!=="Idle"?this._state="NeedsLoadData":(this._state="Coalescing",this._loadData())},N.prototype._loadData=function(){var V=this;if(this._pendingCallback&&this._pendingLoadDataParams){var X=this._pendingCallback,$=this._pendingLoadDataParams;delete this._pendingCallback,delete this._pendingLoadDataParams;var se=!!($&&$.request&&$.request.collectResourceTiming)&&new o.RequestPerformance($.request);this.loadGeoJSON($,function(pe,j){if(pe||!j)return X(pe);if(typeof j!="object")return X(new Error("Input data given to '"+$.source+"' is not a valid GeoJSON object."));(function W(we,$e){var Xe,Se=we&&we.type;if(Se==="FeatureCollection")for(Xe=0;Xe<we.features.length;Xe++)W(we.features[Xe],$e);else if(Se==="GeometryCollection")for(Xe=0;Xe<we.geometries.length;Xe++)W(we.geometries[Xe],$e);else if(Se==="Feature")W(we.geometry,$e);else if(Se==="Polygon")me(we.coordinates,$e);else if(Se==="MultiPolygon")for(Xe=0;Xe<we.coordinates.length;Xe++)me(we.coordinates[Xe],$e);return we})(j,!0);try{if($.filter){var J=o.createExpression($.filter,{type:"boolean","property-type":"data-driven",overridable:!1,transition:!1});if(J.result==="error")throw new Error(J.value.map(function(W){return W.key+": "+W.message}).join(", "));var _e=j.features.filter(function(W){return J.value.evaluate({zoom:0},W)});j={type:"FeatureCollection",features:_e}}V._geoJSONIndex=$.cluster?new sr(function(W){var we=W.superclusterOptions,$e=W.clusterProperties;if(!$e||!we)return we;for(var Xe={},Se={},We={accumulated:null,zoom:0},Oe={properties:null},je=Object.keys($e),Mt=0,qe=je;Mt<qe.length;Mt+=1){var Vt=qe[Mt],lr=$e[Vt],Pt=lr[0],er=o.createExpression(lr[1]),Ht=o.createExpression(typeof Pt=="string"?[Pt,["accumulated"],["get",Vt]]:Pt);Xe[Vt]=er.value,Se[Vt]=Ht.value}return we.map=function(ti){Oe.properties=ti;for(var Qt={},vr=0,dr=je;vr<dr.length;vr+=1){var Gt=dr[vr];Qt[Gt]=Xe[Gt].evaluate(We,Oe)}return Qt},we.reduce=function(ti,Qt){Oe.properties=Qt;for(var vr=0,dr=je;vr<dr.length;vr+=1){var Gt=dr[vr];We.accumulated=ti[Gt],ti[Gt]=Se[Gt].evaluate(We,Oe)}},we}($)).load(j.features):function(W,we){return new an(W,we)}(j,$.geojsonVtOptions)}catch(W){return X(W)}V.loaded={};var Ce={};if(se){var Me=se.finish();Me&&(Ce.resourceTiming={},Ce.resourceTiming[$.source]=JSON.parse(JSON.stringify(Me)))}X(null,Ce)})}},N.prototype.coalesce=function(){this._state==="Coalescing"?this._state="Idle":this._state==="NeedsLoadData"&&(this._state="Coalescing",this._loadData())},N.prototype.reloadTile=function(V,X){var $=this.loaded;return $&&$[V.uid]?L.prototype.reloadTile.call(this,V,X):this.loadTile(V,X)},N.prototype.loadGeoJSON=function(V,X){if(V.request)o.getJSON(V.request,X);else{if(typeof V.data!="string")return X(new Error("Input data given to '"+V.source+"' is not a valid GeoJSON object."));try{return X(null,JSON.parse(V.data))}catch{return X(new Error("Input data given to '"+V.source+"' is not a valid GeoJSON object."))}}},N.prototype.removeSource=function(V,X){this._pendingCallback&&this._pendingCallback(null,{abandoned:!0}),X()},N.prototype.getClusterExpansionZoom=function(V,X){try{X(null,this._geoJSONIndex.getClusterExpansionZoom(V.clusterId))}catch($){X($)}},N.prototype.getClusterChildren=function(V,X){try{X(null,this._geoJSONIndex.getChildren(V.clusterId))}catch($){X($)}},N.prototype.getClusterLeaves=function(V,X){try{X(null,this._geoJSONIndex.getLeaves(V.clusterId,V.limit,V.offset))}catch($){X($)}},N}(ne),Cr=function(L){var N=this;this.self=L,this.actor=new o.Actor(L,this),this.layerIndexes={},this.availableImages={},this.workerSourceTypes={vector:ne,geojson:ni},this.workerSources={},this.demWorkerSources={},this.self.registerWorkerSource=function(V,X){if(N.workerSourceTypes[V])throw new Error('Worker source with name "'+V+'" already registered.');N.workerSourceTypes[V]=X},this.self.registerRTLTextPlugin=function(V){if(o.plugin.isParsed())throw new Error("RTL text plugin already registered.");o.plugin.applyArabicShaping=V.applyArabicShaping,o.plugin.processBidirectionalText=V.processBidirectionalText,o.plugin.processStyledBidirectionalText=V.processStyledBidirectionalText}};return Cr.prototype.setReferrer=function(L,N){this.referrer=N},Cr.prototype.setImages=function(L,N,V){for(var X in this.availableImages[L]=N,this.workerSources[L]){var $=this.workerSources[L][X];for(var se in $)$[se].availableImages=N}V()},Cr.prototype.setLayers=function(L,N,V){this.getLayerIndex(L).replace(N),V()},Cr.prototype.updateLayers=function(L,N,V){this.getLayerIndex(L).update(N.layers,N.removedIds),V()},Cr.prototype.loadTile=function(L,N,V){this.getWorkerSource(L,N.type,N.source).loadTile(N,V)},Cr.prototype.loadDEMTile=function(L,N,V){this.getDEMWorkerSource(L,N.source).loadTile(N,V)},Cr.prototype.reloadTile=function(L,N,V){this.getWorkerSource(L,N.type,N.source).reloadTile(N,V)},Cr.prototype.abortTile=function(L,N,V){this.getWorkerSource(L,N.type,N.source).abortTile(N,V)},Cr.prototype.removeTile=function(L,N,V){this.getWorkerSource(L,N.type,N.source).removeTile(N,V)},Cr.prototype.removeDEMTile=function(L,N){this.getDEMWorkerSource(L,N.source).removeTile(N)},Cr.prototype.removeSource=function(L,N,V){if(this.workerSources[L]&&this.workerSources[L][N.type]&&this.workerSources[L][N.type][N.source]){var X=this.workerSources[L][N.type][N.source];delete this.workerSources[L][N.type][N.source],X.removeSource!==void 0?X.removeSource(N,V):V()}},Cr.prototype.loadWorkerSource=function(L,N,V){try{this.self.importScripts(N.url),V()}catch(X){V(X.toString())}},Cr.prototype.syncRTLPluginState=function(L,N,V){try{o.plugin.setState(N);var X=o.plugin.getPluginURL();if(o.plugin.isLoaded()&&!o.plugin.isParsed()&&X!=null){this.self.importScripts(X);var $=o.plugin.isParsed();V($?void 0:new Error("RTL Text Plugin failed to import scripts from "+X),$)}}catch(se){V(se.toString())}},Cr.prototype.getAvailableImages=function(L){var N=this.availableImages[L];return N||(N=[]),N},Cr.prototype.getLayerIndex=function(L){var N=this.layerIndexes[L];return N||(N=this.layerIndexes[L]=new M),N},Cr.prototype.getWorkerSource=function(L,N,V){var X=this;return this.workerSources[L]||(this.workerSources[L]={}),this.workerSources[L][N]||(this.workerSources[L][N]={}),this.workerSources[L][N][V]||(this.workerSources[L][N][V]=new this.workerSourceTypes[N]({send:function($,se,pe){X.actor.send($,se,pe,L)}},this.getLayerIndex(L),this.getAvailableImages(L))),this.workerSources[L][N][V]},Cr.prototype.getDEMWorkerSource=function(L,N){return this.demWorkerSources[L]||(this.demWorkerSources[L]={}),this.demWorkerSources[L][N]||(this.demWorkerSources[L][N]=new ve),this.demWorkerSources[L][N]},Cr.prototype.enforceCacheSizeLimit=function(L,N){o.enforceCacheSizeLimit(N)},typeof WorkerGlobalScope<"u"&&typeof self<"u"&&self instanceof WorkerGlobalScope&&(self.worker=new Cr(self)),Cr}),v(["./shared"],function(o){var z=o.createCommonjsModule(function(n){function s(y){return!a(y)}function a(y){return typeof window>"u"||typeof document>"u"?"not a browser":Array.prototype&&Array.prototype.every&&Array.prototype.filter&&Array.prototype.forEach&&Array.prototype.indexOf&&Array.prototype.lastIndexOf&&Array.prototype.map&&Array.prototype.some&&Array.prototype.reduce&&Array.prototype.reduceRight&&Array.isArray?Function.prototype&&Function.prototype.bind?Object.keys&&Object.create&&Object.getPrototypeOf&&Object.getOwnPropertyNames&&Object.isSealed&&Object.isFrozen&&Object.isExtensible&&Object.getOwnPropertyDescriptor&&Object.defineProperty&&Object.defineProperties&&Object.seal&&Object.freeze&&Object.preventExtensions?"JSON"in window&&"parse"in JSON&&"stringify"in JSON?function(){if(!("Worker"in window&&"Blob"in window&&"URL"in window))return!1;var k,E,P=new Blob([""],{type:"text/javascript"}),O=URL.createObjectURL(P);try{E=new Worker(O),k=!0}catch{k=!1}return E&&E.terminate(),URL.revokeObjectURL(O),k}()?"Uint8ClampedArray"in window?ArrayBuffer.isView?function(){var k=document.createElement("canvas");k.width=k.height=1;var E=k.getContext("2d");if(!E)return!1;var P=E.getImageData(0,0,1,1);return P&&P.width===k.width}()?(u[w=y&&y.failIfMajorPerformanceCaveat]===void 0&&(u[w]=function(k){var E=function(O){var Z=document.createElement("canvas"),G=Object.create(s.webGLContextAttributes);return G.failIfMajorPerformanceCaveat=O,Z.probablySupportsContext?Z.probablySupportsContext("webgl",G)||Z.probablySupportsContext("experimental-webgl",G):Z.supportsContext?Z.supportsContext("webgl",G)||Z.supportsContext("experimental-webgl",G):Z.getContext("webgl",G)||Z.getContext("experimental-webgl",G)}(k);if(!E)return!1;var P=E.createShader(E.VERTEX_SHADER);return!(!P||E.isContextLost())&&(E.shaderSource(P,"void main() {}"),E.compileShader(P),E.getShaderParameter(P,E.COMPILE_STATUS)===!0)}(w)),u[w]?void 0:"insufficient WebGL support"):"insufficient Canvas/getImageData support":"insufficient ArrayBuffer support":"insufficient Uint8ClampedArray support":"insufficient worker support":"insufficient JSON support":"insufficient Object support":"insufficient Function support":"insufficent Array support";var w}n.exports?n.exports=s:window&&(window.mapboxgl=window.mapboxgl||{},window.mapboxgl.supported=s,window.mapboxgl.notSupportedReason=a);var u={};s.webGLContextAttributes={antialias:!1,alpha:!0,stencil:!0,depth:!0}}),T={create:function(n,s,a){var u=o.window.document.createElement(n);return s!==void 0&&(u.className=s),a&&a.appendChild(u),u},createNS:function(n,s){return o.window.document.createElementNS(n,s)}},M=o.window.document&&o.window.document.documentElement.style;function F(n){if(!M)return n[0];for(var s=0;s<n.length;s++)if(n[s]in M)return n[s];return n[0]}var R,D=F(["userSelect","MozUserSelect","WebkitUserSelect","msUserSelect"]);T.disableDrag=function(){M&&D&&(R=M[D],M[D]="none")},T.enableDrag=function(){M&&D&&(M[D]=R)};var H=F(["transform","WebkitTransform"]);T.setTransform=function(n,s){n.style[H]=s};var ne=!1;try{var he=Object.defineProperty({},"passive",{get:function(){ne=!0}});o.window.addEventListener("test",he,he),o.window.removeEventListener("test",he,he)}catch{ne=!1}T.addEventListener=function(n,s,a,u){u===void 0&&(u={}),n.addEventListener(s,a,"passive"in u&&ne?u:u.capture)},T.removeEventListener=function(n,s,a,u){u===void 0&&(u={}),n.removeEventListener(s,a,"passive"in u&&ne?u:u.capture)};var ve=function(n){n.preventDefault(),n.stopPropagation(),o.window.removeEventListener("click",ve,!0)};function me(n){var s=n.userImage;return!!(s&&s.render&&s.render())&&(n.data.replace(new Uint8Array(s.data.buffer)),!0)}T.suppressClick=function(){o.window.addEventListener("click",ve,!0),o.window.setTimeout(function(){o.window.removeEventListener("click",ve,!0)},0)},T.mousePos=function(n,s){var a=n.getBoundingClientRect();return new o.Point(s.clientX-a.left-n.clientLeft,s.clientY-a.top-n.clientTop)},T.touchPos=function(n,s){for(var a=n.getBoundingClientRect(),u=[],y=0;y<s.length;y++)u.push(new o.Point(s[y].clientX-a.left-n.clientLeft,s[y].clientY-a.top-n.clientTop));return u},T.mouseButton=function(n){return o.window.InstallTrigger!==void 0&&n.button===2&&n.ctrlKey&&o.window.navigator.platform.toUpperCase().indexOf("MAC")>=0?0:n.button},T.remove=function(n){n.parentNode&&n.parentNode.removeChild(n)};var xe=function(n){function s(){n.call(this),this.images={},this.updatedImages={},this.callbackDispatchedThisFrame={},this.loaded=!1,this.requestors=[],this.patterns={},this.atlasImage=new o.RGBAImage({width:1,height:1}),this.dirty=!0}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype.isLoaded=function(){return this.loaded},s.prototype.setLoaded=function(a){if(this.loaded!==a&&(this.loaded=a,a)){for(var u=0,y=this.requestors;u<y.length;u+=1){var w=y[u];this._notify(w.ids,w.callback)}this.requestors=[]}},s.prototype.getImage=function(a){return this.images[a]},s.prototype.addImage=function(a,u){this._validate(a,u)&&(this.images[a]=u)},s.prototype._validate=function(a,u){var y=!0;return this._validateStretch(u.stretchX,u.data&&u.data.width)||(this.fire(new o.ErrorEvent(new Error('Image "'+a+'" has invalid "stretchX" value'))),y=!1),this._validateStretch(u.stretchY,u.data&&u.data.height)||(this.fire(new o.ErrorEvent(new Error('Image "'+a+'" has invalid "stretchY" value'))),y=!1),this._validateContent(u.content,u)||(this.fire(new o.ErrorEvent(new Error('Image "'+a+'" has invalid "content" value'))),y=!1),y},s.prototype._validateStretch=function(a,u){if(!a)return!0;for(var y=0,w=0,k=a;w<k.length;w+=1){var E=k[w];if(E[0]<y||E[1]<E[0]||u<E[1])return!1;y=E[1]}return!0},s.prototype._validateContent=function(a,u){return!(a&&(a.length!==4||a[0]<0||u.data.width<a[0]||a[1]<0||u.data.height<a[1]||a[2]<0||u.data.width<a[2]||a[3]<0||u.data.height<a[3]||a[2]<a[0]||a[3]<a[1]))},s.prototype.updateImage=function(a,u){u.version=this.images[a].version+1,this.images[a]=u,this.updatedImages[a]=!0},s.prototype.removeImage=function(a){var u=this.images[a];delete this.images[a],delete this.patterns[a],u.userImage&&u.userImage.onRemove&&u.userImage.onRemove()},s.prototype.listImages=function(){return Object.keys(this.images)},s.prototype.getImages=function(a,u){var y=!0;if(!this.isLoaded())for(var w=0,k=a;w<k.length;w+=1)this.images[k[w]]||(y=!1);this.isLoaded()||y?this._notify(a,u):this.requestors.push({ids:a,callback:u})},s.prototype._notify=function(a,u){for(var y={},w=0,k=a;w<k.length;w+=1){var E=k[w];this.images[E]||this.fire(new o.Event("styleimagemissing",{id:E}));var P=this.images[E];P?y[E]={data:P.data.clone(),pixelRatio:P.pixelRatio,sdf:P.sdf,version:P.version,stretchX:P.stretchX,stretchY:P.stretchY,content:P.content,hasRenderCallback:!!(P.userImage&&P.userImage.render)}:o.warnOnce('Image "'+E+'" could not be loaded. Please make sure you have added the image with map.addImage() or a "sprite" property in your style. You can provide missing images by listening for the "styleimagemissing" map event.')}u(null,y)},s.prototype.getPixelSize=function(){var a=this.atlasImage;return{width:a.width,height:a.height}},s.prototype.getPattern=function(a){var u=this.patterns[a],y=this.getImage(a);if(!y)return null;if(u&&u.position.version===y.version)return u.position;if(u)u.position.version=y.version;else{var w={w:y.data.width+2,h:y.data.height+2,x:0,y:0},k=new o.ImagePosition(w,y);this.patterns[a]={bin:w,position:k}}return this._updatePatternAtlas(),this.patterns[a].position},s.prototype.bind=function(a){var u=a.gl;this.atlasTexture?this.dirty&&(this.atlasTexture.update(this.atlasImage),this.dirty=!1):this.atlasTexture=new o.Texture(a,this.atlasImage,u.RGBA),this.atlasTexture.bind(u.LINEAR,u.CLAMP_TO_EDGE)},s.prototype._updatePatternAtlas=function(){var a=[];for(var u in this.patterns)a.push(this.patterns[u].bin);var y=o.potpack(a),w=y.w,k=y.h,E=this.atlasImage;for(var P in E.resize({width:w||1,height:k||1}),this.patterns){var O=this.patterns[P].bin,Z=O.x+1,G=O.y+1,K=this.images[P].data,re=K.width,te=K.height;o.RGBAImage.copy(K,E,{x:0,y:0},{x:Z,y:G},{width:re,height:te}),o.RGBAImage.copy(K,E,{x:0,y:te-1},{x:Z,y:G-1},{width:re,height:1}),o.RGBAImage.copy(K,E,{x:0,y:0},{x:Z,y:G+te},{width:re,height:1}),o.RGBAImage.copy(K,E,{x:re-1,y:0},{x:Z-1,y:G},{width:1,height:te}),o.RGBAImage.copy(K,E,{x:0,y:0},{x:Z+re,y:G},{width:1,height:te})}this.dirty=!0},s.prototype.beginFrame=function(){this.callbackDispatchedThisFrame={}},s.prototype.dispatchRenderCallbacks=function(a){for(var u=0,y=a;u<y.length;u+=1){var w=y[u];if(!this.callbackDispatchedThisFrame[w]){this.callbackDispatchedThisFrame[w]=!0;var k=this.images[w];me(k)&&this.updateImage(w,k)}}},s}(o.Evented),ot=Ye,Je=Ye,Le=1e20;function Ye(n,s,a,u,y,w){this.fontSize=n||24,this.buffer=s===void 0?3:s,this.cutoff=u||.25,this.fontFamily=y||"sans-serif",this.fontWeight=w||"normal",this.radius=a||8;var k=this.size=this.fontSize+2*this.buffer;this.canvas=document.createElement("canvas"),this.canvas.width=this.canvas.height=k,this.ctx=this.canvas.getContext("2d"),this.ctx.font=this.fontWeight+" "+this.fontSize+"px "+this.fontFamily,this.ctx.textBaseline="middle",this.ctx.fillStyle="black",this.gridOuter=new Float64Array(k*k),this.gridInner=new Float64Array(k*k),this.f=new Float64Array(k),this.d=new Float64Array(k),this.z=new Float64Array(k+1),this.v=new Int16Array(k),this.middle=Math.round(k/2*(navigator.userAgent.indexOf("Gecko/")>=0?1.2:1))}function It(n,s,a,u,y,w,k){for(var E=0;E<s;E++){for(var P=0;P<a;P++)u[P]=n[P*s+E];for(Lt(u,y,w,k,a),P=0;P<a;P++)n[P*s+E]=y[P]}for(P=0;P<a;P++){for(E=0;E<s;E++)u[E]=n[P*s+E];for(Lt(u,y,w,k,s),E=0;E<s;E++)n[P*s+E]=Math.sqrt(y[E])}}function Lt(n,s,a,u,y){a[0]=0,u[0]=-Le,u[1]=+Le;for(var w=1,k=0;w<y;w++){for(var E=(n[w]+w*w-(n[a[k]]+a[k]*a[k]))/(2*w-2*a[k]);E<=u[k];)k--,E=(n[w]+w*w-(n[a[k]]+a[k]*a[k]))/(2*w-2*a[k]);a[++k]=w,u[k]=E,u[k+1]=+Le}for(w=0,k=0;w<y;w++){for(;u[k+1]<w;)k++;s[w]=(w-a[k])*(w-a[k])+n[a[k]]}}Ye.prototype.draw=function(n){this.ctx.clearRect(0,0,this.size,this.size),this.ctx.fillText(n,this.buffer,this.middle);for(var s=this.ctx.getImageData(0,0,this.size,this.size),a=new Uint8ClampedArray(this.size*this.size),u=0;u<this.size*this.size;u++){var y=s.data[4*u+3]/255;this.gridOuter[u]=y===1?0:y===0?Le:Math.pow(Math.max(0,.5-y),2),this.gridInner[u]=y===1?Le:y===0?0:Math.pow(Math.max(0,y-.5),2)}for(It(this.gridOuter,this.size,this.size,this.f,this.d,this.v,this.z),It(this.gridInner,this.size,this.size,this.f,this.d,this.v,this.z),u=0;u<this.size*this.size;u++)a[u]=Math.max(0,Math.min(255,Math.round(255-255*((this.gridOuter[u]-this.gridInner[u])/this.radius+this.cutoff))));return a},ot.default=Je;var jt=function(n,s){this.requestManager=n,this.localIdeographFontFamily=s,this.entries={}};jt.prototype.setURL=function(n){this.url=n},jt.prototype.getGlyphs=function(n,s){var a=this,u=[];for(var y in n)for(var w=0,k=n[y];w<k.length;w+=1)u.push({stack:y,id:k[w]});o.asyncAll(u,function(E,P){var O=E.stack,Z=E.id,G=a.entries[O];G||(G=a.entries[O]={glyphs:{},requests:{},ranges:{}});var K=G.glyphs[Z];if(K===void 0){if(K=a._tinySDF(G,O,Z))return G.glyphs[Z]=K,void P(null,{stack:O,id:Z,glyph:K});var re=Math.floor(Z/256);if(256*re>65535)P(new Error("glyphs > 65535 not supported"));else if(G.ranges[re])P(null,{stack:O,id:Z,glyph:K});else{var te=G.requests[re];te||(te=G.requests[re]=[],jt.loadGlyphRange(O,re,a.url,a.requestManager,function(ue,Y){if(Y){for(var le in Y)a._doesCharSupportLocalGlyph(+le)||(G.glyphs[+le]=Y[+le]);G.ranges[re]=!0}for(var fe=0,ge=te;fe<ge.length;fe+=1)(0,ge[fe])(ue,Y);delete G.requests[re]})),te.push(function(ue,Y){ue?P(ue):Y&&P(null,{stack:O,id:Z,glyph:Y[Z]||null})})}}else P(null,{stack:O,id:Z,glyph:K})},function(E,P){if(E)s(E);else if(P){for(var O={},Z=0,G=P;Z<G.length;Z+=1){var K=G[Z],re=K.stack,te=K.id,ue=K.glyph;(O[re]||(O[re]={}))[te]=ue&&{id:ue.id,bitmap:ue.bitmap.clone(),metrics:ue.metrics}}s(null,O)}})},jt.prototype._doesCharSupportLocalGlyph=function(n){return!!this.localIdeographFontFamily&&(o.isChar["CJK Unified Ideographs"](n)||o.isChar["Hangul Syllables"](n)||o.isChar.Hiragana(n)||o.isChar.Katakana(n))},jt.prototype._tinySDF=function(n,s,a){var u=this.localIdeographFontFamily;if(u&&this._doesCharSupportLocalGlyph(a)){var y=n.tinySDF;if(!y){var w="400";/bold/i.test(s)?w="900":/medium/i.test(s)?w="500":/light/i.test(s)&&(w="200"),y=n.tinySDF=new jt.TinySDF(24,3,8,.25,u,w)}return{id:a,bitmap:new o.AlphaImage({width:30,height:30},y.draw(String.fromCharCode(a))),metrics:{width:24,height:24,left:0,top:-8,advance:24}}}},jt.loadGlyphRange=function(n,s,a,u,y){var w=256*s,k=w+255,E=u.transformRequest(u.normalizeGlyphsURL(a).replace("{fontstack}",n).replace("{range}",w+"-"+k),o.ResourceType.Glyphs);o.getArrayBuffer(E,function(P,O){if(P)y(P);else if(O){for(var Z={},G=0,K=o.parseGlyphPBF(O);G<K.length;G+=1){var re=K[G];Z[re.id]=re}y(null,Z)}})},jt.TinySDF=ot;var _t=function(){this.specification=o.styleSpec.light.position};_t.prototype.possiblyEvaluate=function(n,s){return o.sphericalToCartesian(n.expression.evaluate(s))},_t.prototype.interpolate=function(n,s,a){return{x:o.number(n.x,s.x,a),y:o.number(n.y,s.y,a),z:o.number(n.z,s.z,a)}};var ht=new o.Properties({anchor:new o.DataConstantProperty(o.styleSpec.light.anchor),position:new _t,color:new o.DataConstantProperty(o.styleSpec.light.color),intensity:new o.DataConstantProperty(o.styleSpec.light.intensity)}),Ft=function(n){function s(a){n.call(this),this._transitionable=new o.Transitionable(ht),this.setLight(a),this._transitioning=this._transitionable.untransitioned()}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype.getLight=function(){return this._transitionable.serialize()},s.prototype.setLight=function(a,u){if(u===void 0&&(u={}),!this._validate(o.validateLight,a,u))for(var y in a){var w=a[y];o.endsWith(y,"-transition")?this._transitionable.setTransition(y.slice(0,-11),w):this._transitionable.setValue(y,w)}},s.prototype.updateTransitions=function(a){this._transitioning=this._transitionable.transitioned(a,this._transitioning)},s.prototype.hasTransition=function(){return this._transitioning.hasTransition()},s.prototype.recalculate=function(a){this.properties=this._transitioning.possiblyEvaluate(a)},s.prototype._validate=function(a,u,y){return(!y||y.validate!==!1)&&o.emitValidationErrors(this,a.call(o.validateStyle,o.extend({value:u,style:{glyphs:!0,sprite:!0},styleSpec:o.styleSpec})))},s}(o.Evented),yt=function(n,s){this.width=n,this.height=s,this.nextRow=0,this.data=new Uint8Array(this.width*this.height),this.dashEntry={}};yt.prototype.getDash=function(n,s){var a=n.join(",")+String(s);return this.dashEntry[a]||(this.dashEntry[a]=this.addDash(n,s)),this.dashEntry[a]},yt.prototype.getDashRanges=function(n,s,a){var u=[],y=n.length%2==1?-n[n.length-1]*a:0,w=n[0]*a,k=!0;u.push({left:y,right:w,isDash:k,zeroLength:n[0]===0});for(var E=n[0],P=1;P<n.length;P++){var O=n[P];u.push({left:y=E*a,right:w=(E+=O)*a,isDash:k=!k,zeroLength:O===0})}return u},yt.prototype.addRoundDash=function(n,s,a){for(var u=s/2,y=-a;y<=a;y++)for(var w=this.width*(this.nextRow+a+y),k=0,E=n[k],P=0;P<this.width;P++){P/E.right>1&&(E=n[++k]);var O=Math.abs(P-E.left),Z=Math.abs(P-E.right),G=Math.min(O,Z),K=void 0,re=y/a*(u+1);if(E.isDash){var te=u-Math.abs(re);K=Math.sqrt(G*G+te*te)}else K=u-Math.sqrt(G*G+re*re);this.data[w+P]=Math.max(0,Math.min(255,K+128))}},yt.prototype.addRegularDash=function(n){for(var s=n.length-1;s>=0;--s){var a=n[s],u=n[s+1];a.zeroLength?n.splice(s,1):u&&u.isDash===a.isDash&&(u.left=a.left,n.splice(s,1))}var y=n[0],w=n[n.length-1];y.isDash===w.isDash&&(y.left=w.left-this.width,w.right=y.right+this.width);for(var k=this.width*this.nextRow,E=0,P=n[E],O=0;O<this.width;O++){O/P.right>1&&(P=n[++E]);var Z=Math.abs(O-P.left),G=Math.abs(O-P.right),K=Math.min(Z,G);this.data[k+O]=Math.max(0,Math.min(255,(P.isDash?K:-K)+128))}},yt.prototype.addDash=function(n,s){var a=s?7:0,u=2*a+1;if(this.nextRow+u>this.height)return o.warnOnce("LineAtlas out of space"),null;for(var y=0,w=0;w<n.length;w++)y+=n[w];if(y!==0){var k=this.width/y,E=this.getDashRanges(n,this.width,k);s?this.addRoundDash(E,k,a):this.addRegularDash(E)}var P={y:(this.nextRow+a+.5)/this.height,height:2*a/this.height,width:y};return this.nextRow+=u,this.dirty=!0,P},yt.prototype.bind=function(n){var s=n.gl;this.texture?(s.bindTexture(s.TEXTURE_2D,this.texture),this.dirty&&(this.dirty=!1,s.texSubImage2D(s.TEXTURE_2D,0,0,0,this.width,this.height,s.ALPHA,s.UNSIGNED_BYTE,this.data))):(this.texture=s.createTexture(),s.bindTexture(s.TEXTURE_2D,this.texture),s.texParameteri(s.TEXTURE_2D,s.TEXTURE_WRAP_S,s.REPEAT),s.texParameteri(s.TEXTURE_2D,s.TEXTURE_WRAP_T,s.REPEAT),s.texParameteri(s.TEXTURE_2D,s.TEXTURE_MIN_FILTER,s.LINEAR),s.texParameteri(s.TEXTURE_2D,s.TEXTURE_MAG_FILTER,s.LINEAR),s.texImage2D(s.TEXTURE_2D,0,s.ALPHA,this.width,this.height,0,s.ALPHA,s.UNSIGNED_BYTE,this.data))};var zt=function n(s,a){this.workerPool=s,this.actors=[],this.currentActor=0,this.id=o.uniqueId();for(var u=this.workerPool.acquire(this.id),y=0;y<u.length;y++){var w=new n.Actor(u[y],a,this.id);w.name="Worker "+y,this.actors.push(w)}};function et(n,s,a){var u=function(y,w){if(y)return a(y);if(w){var k=o.pick(o.extend(w,n),["tiles","minzoom","maxzoom","attribution","mapbox_logo","bounds","scheme","tileSize","encoding"]);w.vector_layers&&(k.vectorLayers=w.vector_layers,k.vectorLayerIds=k.vectorLayers.map(function(E){return E.id})),k.tiles=s.canonicalizeTileset(k,n.url),a(null,k)}};return n.url?o.getJSON(s.transformRequest(s.normalizeSourceURL(n.url),o.ResourceType.Source),u):o.browser.frame(function(){return u(null,n)})}zt.prototype.broadcast=function(n,s,a){o.asyncAll(this.actors,function(u,y){u.send(n,s,y)},a=a||function(){})},zt.prototype.getActor=function(){return this.currentActor=(this.currentActor+1)%this.actors.length,this.actors[this.currentActor]},zt.prototype.remove=function(){this.actors.forEach(function(n){n.remove()}),this.actors=[],this.workerPool.release(this.id)},zt.Actor=o.Actor;var qt=function(n,s,a){this.bounds=o.LngLatBounds.convert(this.validateBounds(n)),this.minzoom=s||0,this.maxzoom=a||24};qt.prototype.validateBounds=function(n){return Array.isArray(n)&&n.length===4?[Math.max(-180,n[0]),Math.max(-90,n[1]),Math.min(180,n[2]),Math.min(90,n[3])]:[-180,-90,180,90]},qt.prototype.contains=function(n){var s=Math.pow(2,n.z),a=Math.floor(o.mercatorXfromLng(this.bounds.getWest())*s),u=Math.floor(o.mercatorYfromLat(this.bounds.getNorth())*s),y=Math.ceil(o.mercatorXfromLng(this.bounds.getEast())*s),w=Math.ceil(o.mercatorYfromLat(this.bounds.getSouth())*s);return n.x>=a&&n.x<y&&n.y>=u&&n.y<w};var pt=function(n){function s(a,u,y,w){if(n.call(this),this.id=a,this.dispatcher=y,this.type="vector",this.minzoom=0,this.maxzoom=22,this.scheme="xyz",this.tileSize=512,this.reparseOverscaled=!0,this.isTileClipped=!0,this._loaded=!1,o.extend(this,o.pick(u,["url","scheme","tileSize","promoteId"])),this._options=o.extend({type:"vector"},u),this._collectResourceTiming=u.collectResourceTiming,this.tileSize!==512)throw new Error("vector tile sources must have a tileSize of 512");this.setEventedParent(w)}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype.load=function(){var a=this;this._loaded=!1,this.fire(new o.Event("dataloading",{dataType:"source"})),this._tileJSONRequest=et(this._options,this.map._requestManager,function(u,y){a._tileJSONRequest=null,a._loaded=!0,u?a.fire(new o.ErrorEvent(u)):y&&(o.extend(a,y),y.bounds&&(a.tileBounds=new qt(y.bounds,a.minzoom,a.maxzoom)),o.postTurnstileEvent(y.tiles,a.map._requestManager._customAccessToken),o.postMapLoadEvent(y.tiles,a.map._getMapId(),a.map._requestManager._skuToken,a.map._requestManager._customAccessToken),a.fire(new o.Event("data",{dataType:"source",sourceDataType:"metadata"})),a.fire(new o.Event("data",{dataType:"source",sourceDataType:"content"})))})},s.prototype.loaded=function(){return this._loaded},s.prototype.hasTile=function(a){return!this.tileBounds||this.tileBounds.contains(a.canonical)},s.prototype.onAdd=function(a){this.map=a,this.load()},s.prototype.setSourceProperty=function(a){this._tileJSONRequest&&this._tileJSONRequest.cancel(),a(),this.map.style.sourceCaches[this.id].clearTiles(),this.load()},s.prototype.setTiles=function(a){var u=this;return this.setSourceProperty(function(){u._options.tiles=a}),this},s.prototype.setUrl=function(a){var u=this;return this.setSourceProperty(function(){u.url=a,u._options.url=a}),this},s.prototype.onRemove=function(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)},s.prototype.serialize=function(){return o.extend({},this._options)},s.prototype.loadTile=function(a,u){var y=this.map._requestManager.normalizeTileURL(a.tileID.canonical.url(this.tiles,this.scheme)),w={request:this.map._requestManager.transformRequest(y,o.ResourceType.Tile),uid:a.uid,tileID:a.tileID,zoom:a.tileID.overscaledZ,tileSize:this.tileSize*a.tileID.overscaleFactor(),type:this.type,source:this.id,pixelRatio:o.browser.devicePixelRatio,showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId};function k(E,P){return delete a.request,a.aborted?u(null):E&&E.status!==404?u(E):(P&&P.resourceTiming&&(a.resourceTiming=P.resourceTiming),this.map._refreshExpiredTiles&&P&&a.setExpiryData(P),a.loadVectorData(P,this.map.painter),o.cacheEntryPossiblyAdded(this.dispatcher),u(null),void(a.reloadCallback&&(this.loadTile(a,a.reloadCallback),a.reloadCallback=null)))}w.request.collectResourceTiming=this._collectResourceTiming,a.actor&&a.state!=="expired"?a.state==="loading"?a.reloadCallback=u:a.request=a.actor.send("reloadTile",w,k.bind(this)):(a.actor=this.dispatcher.getActor(),a.request=a.actor.send("loadTile",w,k.bind(this)))},s.prototype.abortTile=function(a){a.request&&(a.request.cancel(),delete a.request),a.actor&&a.actor.send("abortTile",{uid:a.uid,type:this.type,source:this.id},void 0)},s.prototype.unloadTile=function(a){a.unloadVectorData(),a.actor&&a.actor.send("removeTile",{uid:a.uid,type:this.type,source:this.id},void 0)},s.prototype.hasTransition=function(){return!1},s}(o.Evented),At=function(n){function s(a,u,y,w){n.call(this),this.id=a,this.dispatcher=y,this.setEventedParent(w),this.type="raster",this.minzoom=0,this.maxzoom=22,this.roundZoom=!0,this.scheme="xyz",this.tileSize=512,this._loaded=!1,this._options=o.extend({type:"raster"},u),o.extend(this,o.pick(u,["url","scheme","tileSize"]))}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype.load=function(){var a=this;this._loaded=!1,this.fire(new o.Event("dataloading",{dataType:"source"})),this._tileJSONRequest=et(this._options,this.map._requestManager,function(u,y){a._tileJSONRequest=null,a._loaded=!0,u?a.fire(new o.ErrorEvent(u)):y&&(o.extend(a,y),y.bounds&&(a.tileBounds=new qt(y.bounds,a.minzoom,a.maxzoom)),o.postTurnstileEvent(y.tiles),o.postMapLoadEvent(y.tiles,a.map._getMapId(),a.map._requestManager._skuToken),a.fire(new o.Event("data",{dataType:"source",sourceDataType:"metadata"})),a.fire(new o.Event("data",{dataType:"source",sourceDataType:"content"})))})},s.prototype.loaded=function(){return this._loaded},s.prototype.onAdd=function(a){this.map=a,this.load()},s.prototype.onRemove=function(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)},s.prototype.serialize=function(){return o.extend({},this._options)},s.prototype.hasTile=function(a){return!this.tileBounds||this.tileBounds.contains(a.canonical)},s.prototype.loadTile=function(a,u){var y=this,w=this.map._requestManager.normalizeTileURL(a.tileID.canonical.url(this.tiles,this.scheme),this.tileSize);a.request=o.getImage(this.map._requestManager.transformRequest(w,o.ResourceType.Tile),function(k,E){if(delete a.request,a.aborted)a.state="unloaded",u(null);else if(k)a.state="errored",u(k);else if(E){y.map._refreshExpiredTiles&&a.setExpiryData(E),delete E.cacheControl,delete E.expires;var P=y.map.painter.context,O=P.gl;a.texture=y.map.painter.getTileTexture(E.width),a.texture?a.texture.update(E,{useMipmap:!0}):(a.texture=new o.Texture(P,E,O.RGBA,{useMipmap:!0}),a.texture.bind(O.LINEAR,O.CLAMP_TO_EDGE,O.LINEAR_MIPMAP_NEAREST),P.extTextureFilterAnisotropic&&O.texParameterf(O.TEXTURE_2D,P.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,P.extTextureFilterAnisotropicMax)),a.state="loaded",o.cacheEntryPossiblyAdded(y.dispatcher),u(null)}})},s.prototype.abortTile=function(a,u){a.request&&(a.request.cancel(),delete a.request),u()},s.prototype.unloadTile=function(a,u){a.texture&&this.map.painter.saveTileTexture(a.texture),u()},s.prototype.hasTransition=function(){return!1},s}(o.Evented),Ut=function(n){function s(a,u,y,w){n.call(this,a,u,y,w),this.type="raster-dem",this.maxzoom=22,this._options=o.extend({type:"raster-dem"},u),this.encoding=u.encoding||"mapbox"}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype.serialize=function(){return{type:"raster-dem",url:this.url,tileSize:this.tileSize,tiles:this.tiles,bounds:this.bounds,encoding:this.encoding}},s.prototype.loadTile=function(a,u){var y=this.map._requestManager.normalizeTileURL(a.tileID.canonical.url(this.tiles,this.scheme),this.tileSize);function w(k,E){k&&(a.state="errored",u(k)),E&&(a.dem=E,a.needsHillshadePrepare=!0,a.state="loaded",u(null))}a.request=o.getImage(this.map._requestManager.transformRequest(y,o.ResourceType.Tile),(function(k,E){if(delete a.request,a.aborted)a.state="unloaded",u(null);else if(k)a.state="errored",u(k);else if(E){this.map._refreshExpiredTiles&&a.setExpiryData(E),delete E.cacheControl,delete E.expires;var P=o.window.ImageBitmap&&E instanceof o.window.ImageBitmap&&o.offscreenCanvasSupported()?E:o.browser.getImageData(E,1),O={uid:a.uid,coord:a.tileID,source:this.id,rawImageData:P,encoding:this.encoding};a.actor&&a.state!=="expired"||(a.actor=this.dispatcher.getActor(),a.actor.send("loadDEMTile",O,w.bind(this)))}}).bind(this)),a.neighboringTiles=this._getNeighboringTiles(a.tileID)},s.prototype._getNeighboringTiles=function(a){var u=a.canonical,y=Math.pow(2,u.z),w=(u.x-1+y)%y,k=u.x===0?a.wrap-1:a.wrap,E=(u.x+1+y)%y,P=u.x+1===y?a.wrap+1:a.wrap,O={};return O[new o.OverscaledTileID(a.overscaledZ,k,u.z,w,u.y).key]={backfilled:!1},O[new o.OverscaledTileID(a.overscaledZ,P,u.z,E,u.y).key]={backfilled:!1},u.y>0&&(O[new o.OverscaledTileID(a.overscaledZ,k,u.z,w,u.y-1).key]={backfilled:!1},O[new o.OverscaledTileID(a.overscaledZ,a.wrap,u.z,u.x,u.y-1).key]={backfilled:!1},O[new o.OverscaledTileID(a.overscaledZ,P,u.z,E,u.y-1).key]={backfilled:!1}),u.y+1<y&&(O[new o.OverscaledTileID(a.overscaledZ,k,u.z,w,u.y+1).key]={backfilled:!1},O[new o.OverscaledTileID(a.overscaledZ,a.wrap,u.z,u.x,u.y+1).key]={backfilled:!1},O[new o.OverscaledTileID(a.overscaledZ,P,u.z,E,u.y+1).key]={backfilled:!1}),O},s.prototype.unloadTile=function(a){a.demTexture&&this.map.painter.saveTileTexture(a.demTexture),a.fbo&&(a.fbo.destroy(),delete a.fbo),a.dem&&delete a.dem,delete a.neighboringTiles,a.state="unloaded",a.actor&&a.actor.send("removeDEMTile",{uid:a.uid,source:this.id})},s}(At),cr=function(n){function s(a,u,y,w){n.call(this),this.id=a,this.type="geojson",this.minzoom=0,this.maxzoom=18,this.tileSize=512,this.isTileClipped=!0,this.reparseOverscaled=!0,this._removed=!1,this._loaded=!1,this.actor=y.getActor(),this.setEventedParent(w),this._data=u.data,this._options=o.extend({},u),this._collectResourceTiming=u.collectResourceTiming,this._resourceTiming=[],u.maxzoom!==void 0&&(this.maxzoom=u.maxzoom),u.type&&(this.type=u.type),u.attribution&&(this.attribution=u.attribution),this.promoteId=u.promoteId;var k=o.EXTENT/this.tileSize;this.workerOptions=o.extend({source:this.id,cluster:u.cluster||!1,geojsonVtOptions:{buffer:(u.buffer!==void 0?u.buffer:128)*k,tolerance:(u.tolerance!==void 0?u.tolerance:.375)*k,extent:o.EXTENT,maxZoom:this.maxzoom,lineMetrics:u.lineMetrics||!1,generateId:u.generateId||!1},superclusterOptions:{maxZoom:u.clusterMaxZoom!==void 0?Math.min(u.clusterMaxZoom,this.maxzoom-1):this.maxzoom-1,minPoints:Math.max(2,u.clusterMinPoints||2),extent:o.EXTENT,radius:(u.clusterRadius||50)*k,log:!1,generateId:u.generateId||!1},clusterProperties:u.clusterProperties,filter:u.filter},u.workerOptions)}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype.load=function(){var a=this;this.fire(new o.Event("dataloading",{dataType:"source"})),this._updateWorkerData(function(u){if(u)a.fire(new o.ErrorEvent(u));else{var y={dataType:"source",sourceDataType:"metadata"};a._collectResourceTiming&&a._resourceTiming&&a._resourceTiming.length>0&&(y.resourceTiming=a._resourceTiming,a._resourceTiming=[]),a.fire(new o.Event("data",y))}})},s.prototype.onAdd=function(a){this.map=a,this.load()},s.prototype.setData=function(a){var u=this;return this._data=a,this.fire(new o.Event("dataloading",{dataType:"source"})),this._updateWorkerData(function(y){if(y)u.fire(new o.ErrorEvent(y));else{var w={dataType:"source",sourceDataType:"content"};u._collectResourceTiming&&u._resourceTiming&&u._resourceTiming.length>0&&(w.resourceTiming=u._resourceTiming,u._resourceTiming=[]),u.fire(new o.Event("data",w))}}),this},s.prototype.getClusterExpansionZoom=function(a,u){return this.actor.send("geojson.getClusterExpansionZoom",{clusterId:a,source:this.id},u),this},s.prototype.getClusterChildren=function(a,u){return this.actor.send("geojson.getClusterChildren",{clusterId:a,source:this.id},u),this},s.prototype.getClusterLeaves=function(a,u,y,w){return this.actor.send("geojson.getClusterLeaves",{source:this.id,clusterId:a,limit:u,offset:y},w),this},s.prototype._updateWorkerData=function(a){var u=this;this._loaded=!1;var y=o.extend({},this.workerOptions),w=this._data;typeof w=="string"?(y.request=this.map._requestManager.transformRequest(o.browser.resolveURL(w),o.ResourceType.Source),y.request.collectResourceTiming=this._collectResourceTiming):y.data=JSON.stringify(w),this.actor.send(this.type+".loadData",y,function(k,E){u._removed||E&&E.abandoned||(u._loaded=!0,E&&E.resourceTiming&&E.resourceTiming[u.id]&&(u._resourceTiming=E.resourceTiming[u.id].slice(0)),u.actor.send(u.type+".coalesce",{source:y.source},null),a(k))})},s.prototype.loaded=function(){return this._loaded},s.prototype.loadTile=function(a,u){var y=this,w=a.actor?"reloadTile":"loadTile";a.actor=this.actor,a.request=this.actor.send(w,{type:this.type,uid:a.uid,tileID:a.tileID,zoom:a.tileID.overscaledZ,maxZoom:this.maxzoom,tileSize:this.tileSize,source:this.id,pixelRatio:o.browser.devicePixelRatio,showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId},function(k,E){return delete a.request,a.unloadVectorData(),a.aborted?u(null):k?u(k):(a.loadVectorData(E,y.map.painter,w==="reloadTile"),u(null))})},s.prototype.abortTile=function(a){a.request&&(a.request.cancel(),delete a.request),a.aborted=!0},s.prototype.unloadTile=function(a){a.unloadVectorData(),this.actor.send("removeTile",{uid:a.uid,type:this.type,source:this.id})},s.prototype.onRemove=function(){this._removed=!0,this.actor.send("removeSource",{type:this.type,source:this.id})},s.prototype.serialize=function(){return o.extend({},this._options,{type:this.type,data:this._data})},s.prototype.hasTransition=function(){return!1},s}(o.Evented),Ve=o.createLayout([{name:"a_pos",type:"Int16",components:2},{name:"a_texture_pos",type:"Int16",components:2}]),fr=function(n){function s(a,u,y,w){n.call(this),this.id=a,this.dispatcher=y,this.coordinates=u.coordinates,this.type="image",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this.tiles={},this._loaded=!1,this.setEventedParent(w),this.options=u}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype.load=function(a,u){var y=this;this._loaded=!1,this.fire(new o.Event("dataloading",{dataType:"source"})),this.url=this.options.url,o.getImage(this.map._requestManager.transformRequest(this.url,o.ResourceType.Image),function(w,k){y._loaded=!0,w?y.fire(new o.ErrorEvent(w)):k&&(y.image=k,a&&(y.coordinates=a),u&&u(),y._finishLoading())})},s.prototype.loaded=function(){return this._loaded},s.prototype.updateImage=function(a){var u=this;return this.image&&a.url?(this.options.url=a.url,this.load(a.coordinates,function(){u.texture=null}),this):this},s.prototype._finishLoading=function(){this.map&&(this.setCoordinates(this.coordinates),this.fire(new o.Event("data",{dataType:"source",sourceDataType:"metadata"})))},s.prototype.onAdd=function(a){this.map=a,this.load()},s.prototype.setCoordinates=function(a){var u=this;this.coordinates=a;var y=a.map(o.MercatorCoordinate.fromLngLat);this.tileID=function(k){for(var E=1/0,P=1/0,O=-1/0,Z=-1/0,G=0,K=k;G<K.length;G+=1){var re=K[G];E=Math.min(E,re.x),P=Math.min(P,re.y),O=Math.max(O,re.x),Z=Math.max(Z,re.y)}var te=Math.max(O-E,Z-P),ue=Math.max(0,Math.floor(-Math.log(te)/Math.LN2)),Y=Math.pow(2,ue);return new o.CanonicalTileID(ue,Math.floor((E+O)/2*Y),Math.floor((P+Z)/2*Y))}(y),this.minzoom=this.maxzoom=this.tileID.z;var w=y.map(function(k){return u.tileID.getTilePoint(k)._round()});return this._boundsArray=new o.StructArrayLayout4i8,this._boundsArray.emplaceBack(w[0].x,w[0].y,0,0),this._boundsArray.emplaceBack(w[1].x,w[1].y,o.EXTENT,0),this._boundsArray.emplaceBack(w[3].x,w[3].y,0,o.EXTENT),this._boundsArray.emplaceBack(w[2].x,w[2].y,o.EXTENT,o.EXTENT),this.boundsBuffer&&(this.boundsBuffer.destroy(),delete this.boundsBuffer),this.fire(new o.Event("data",{dataType:"source",sourceDataType:"content"})),this},s.prototype.prepare=function(){if(Object.keys(this.tiles).length!==0&&this.image){var a=this.map.painter.context,u=a.gl;for(var y in this.boundsBuffer||(this.boundsBuffer=a.createVertexBuffer(this._boundsArray,Ve.members)),this.boundsSegments||(this.boundsSegments=o.SegmentVector.simpleSegment(0,0,4,2)),this.texture||(this.texture=new o.Texture(a,this.image,u.RGBA),this.texture.bind(u.LINEAR,u.CLAMP_TO_EDGE)),this.tiles){var w=this.tiles[y];w.state!=="loaded"&&(w.state="loaded",w.texture=this.texture)}}},s.prototype.loadTile=function(a,u){this.tileID&&this.tileID.equals(a.tileID.canonical)?(this.tiles[String(a.tileID.wrap)]=a,a.buckets={},u(null)):(a.state="errored",u(null))},s.prototype.serialize=function(){return{type:"image",url:this.options.url,coordinates:this.coordinates}},s.prototype.hasTransition=function(){return!1},s}(o.Evented),hr=function(n){function s(a,u,y,w){n.call(this,a,u,y,w),this.roundZoom=!0,this.type="video",this.options=u}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype.load=function(){var a=this;this._loaded=!1;var u=this.options;this.urls=[];for(var y=0,w=u.urls;y<w.length;y+=1)this.urls.push(this.map._requestManager.transformRequest(w[y],o.ResourceType.Source).url);o.getVideo(this.urls,function(k,E){a._loaded=!0,k?a.fire(new o.ErrorEvent(k)):E&&(a.video=E,a.video.loop=!0,a.video.addEventListener("playing",function(){a.map.triggerRepaint()}),a.map&&a.video.play(),a._finishLoading())})},s.prototype.pause=function(){this.video&&this.video.pause()},s.prototype.play=function(){this.video&&this.video.play()},s.prototype.seek=function(a){if(this.video){var u=this.video.seekable;a<u.start(0)||a>u.end(0)?this.fire(new o.ErrorEvent(new o.ValidationError("sources."+this.id,null,"Playback for this video can be set only between the "+u.start(0)+" and "+u.end(0)+"-second mark."))):this.video.currentTime=a}},s.prototype.getVideo=function(){return this.video},s.prototype.onAdd=function(a){this.map||(this.map=a,this.load(),this.video&&(this.video.play(),this.setCoordinates(this.coordinates)))},s.prototype.prepare=function(){if(!(Object.keys(this.tiles).length===0||this.video.readyState<2)){var a=this.map.painter.context,u=a.gl;for(var y in this.boundsBuffer||(this.boundsBuffer=a.createVertexBuffer(this._boundsArray,Ve.members)),this.boundsSegments||(this.boundsSegments=o.SegmentVector.simpleSegment(0,0,4,2)),this.texture?this.video.paused||(this.texture.bind(u.LINEAR,u.CLAMP_TO_EDGE),u.texSubImage2D(u.TEXTURE_2D,0,0,0,u.RGBA,u.UNSIGNED_BYTE,this.video)):(this.texture=new o.Texture(a,this.video,u.RGBA),this.texture.bind(u.LINEAR,u.CLAMP_TO_EDGE)),this.tiles){var w=this.tiles[y];w.state!=="loaded"&&(w.state="loaded",w.texture=this.texture)}}},s.prototype.serialize=function(){return{type:"video",urls:this.urls,coordinates:this.coordinates}},s.prototype.hasTransition=function(){return this.video&&!this.video.paused},s}(fr),xr=function(n){function s(a,u,y,w){n.call(this,a,u,y,w),u.coordinates?Array.isArray(u.coordinates)&&u.coordinates.length===4&&!u.coordinates.some(function(k){return!Array.isArray(k)||k.length!==2||k.some(function(E){return typeof E!="number"})})||this.fire(new o.ErrorEvent(new o.ValidationError("sources."+a,null,'"coordinates" property must be an array of 4 longitude/latitude array pairs'))):this.fire(new o.ErrorEvent(new o.ValidationError("sources."+a,null,'missing required property "coordinates"'))),u.animate&&typeof u.animate!="boolean"&&this.fire(new o.ErrorEvent(new o.ValidationError("sources."+a,null,'optional "animate" property must be a boolean value'))),u.canvas?typeof u.canvas=="string"||u.canvas instanceof o.window.HTMLCanvasElement||this.fire(new o.ErrorEvent(new o.ValidationError("sources."+a,null,'"canvas" must be either a string representing the ID of the canvas element from which to read, or an HTMLCanvasElement instance'))):this.fire(new o.ErrorEvent(new o.ValidationError("sources."+a,null,'missing required property "canvas"'))),this.options=u,this.animate=u.animate===void 0||u.animate}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype.load=function(){this._loaded=!0,this.canvas||(this.canvas=this.options.canvas instanceof o.window.HTMLCanvasElement?this.options.canvas:o.window.document.getElementById(this.options.canvas)),this.width=this.canvas.width,this.height=this.canvas.height,this._hasInvalidDimensions()?this.fire(new o.ErrorEvent(new Error("Canvas dimensions cannot be less than or equal to zero."))):(this.play=function(){this._playing=!0,this.map.triggerRepaint()},this.pause=function(){this._playing&&(this.prepare(),this._playing=!1)},this._finishLoading())},s.prototype.getCanvas=function(){return this.canvas},s.prototype.onAdd=function(a){this.map=a,this.load(),this.canvas&&this.animate&&this.play()},s.prototype.onRemove=function(){this.pause()},s.prototype.prepare=function(){var a=!1;if(this.canvas.width!==this.width&&(this.width=this.canvas.width,a=!0),this.canvas.height!==this.height&&(this.height=this.canvas.height,a=!0),!this._hasInvalidDimensions()&&Object.keys(this.tiles).length!==0){var u=this.map.painter.context,y=u.gl;for(var w in this.boundsBuffer||(this.boundsBuffer=u.createVertexBuffer(this._boundsArray,Ve.members)),this.boundsSegments||(this.boundsSegments=o.SegmentVector.simpleSegment(0,0,4,2)),this.texture?(a||this._playing)&&this.texture.update(this.canvas,{premultiply:!0}):this.texture=new o.Texture(u,this.canvas,y.RGBA,{premultiply:!0}),this.tiles){var k=this.tiles[w];k.state!=="loaded"&&(k.state="loaded",k.texture=this.texture)}}},s.prototype.serialize=function(){return{type:"canvas",coordinates:this.coordinates}},s.prototype.hasTransition=function(){return this._playing},s.prototype._hasInvalidDimensions=function(){for(var a=0,u=[this.canvas.width,this.canvas.height];a<u.length;a+=1){var y=u[a];if(isNaN(y)||y<=0)return!0}return!1},s}(fr),Fr={vector:pt,raster:At,"raster-dem":Ut,geojson:cr,video:hr,image:fr,canvas:xr};function wi(n,s){var a=o.identity([]);return o.translate(a,a,[1,1,0]),o.scale(a,a,[.5*n.width,.5*n.height,1]),o.multiply(a,a,n.calculatePosMatrix(s.toUnwrapped()))}function sr(n,s,a,u,y,w){var k=function(ue,Y,le){if(ue)for(var fe=0,ge=ue;fe<ge.length;fe+=1){var ze=Y[ge[fe]];if(ze&&ze.source===le&&ze.type==="fill-extrusion")return!0}else for(var Ee in Y){var Ae=Y[Ee];if(Ae.source===le&&Ae.type==="fill-extrusion")return!0}return!1}(y&&y.layers,s,n.id),E=w.maxPitchScaleFactor(),P=n.tilesIn(u,E,k);P.sort(Qr);for(var O=[],Z=0,G=P;Z<G.length;Z+=1){var K=G[Z];O.push({wrappedTileID:K.tileID.wrapped().key,queryResults:K.tile.queryRenderedFeatures(s,a,n._state,K.queryGeometry,K.cameraQueryGeometry,K.scale,y,w,E,wi(n.transform,K.tileID))})}var re=function(ue){for(var Y={},le={},fe=0,ge=ue;fe<ge.length;fe+=1){var ze=ge[fe],Ee=ze.queryResults,Ae=ze.wrappedTileID,De=le[Ae]=le[Ae]||{};for(var Ke in Ee)for(var Ze=Ee[Ke],nt=De[Ke]=De[Ke]||{},vt=Y[Ke]=Y[Ke]||[],St=0,wt=Ze;St<wt.length;St+=1){var _r=wt[St];nt[_r.featureIndex]||(nt[_r.featureIndex]=!0,vt.push(_r))}}return Y}(O);for(var te in re)re[te].forEach(function(ue){var Y=ue.feature,le=n.getFeatureState(Y.layer["source-layer"],Y.id);Y.source=Y.layer.source,Y.layer["source-layer"]&&(Y.sourceLayer=Y.layer["source-layer"]),Y.state=le});return re}function Qr(n,s){var a=n.tileID,u=s.tileID;return a.overscaledZ-u.overscaledZ||a.canonical.y-u.canonical.y||a.wrap-u.wrap||a.canonical.x-u.canonical.x}var kt=function(n,s){this.max=n,this.onRemove=s,this.reset()};kt.prototype.reset=function(){for(var n in this.data)for(var s=0,a=this.data[n];s<a.length;s+=1){var u=a[s];u.timeout&&clearTimeout(u.timeout),this.onRemove(u.value)}return this.data={},this.order=[],this},kt.prototype.add=function(n,s,a){var u=this,y=n.wrapped().key;this.data[y]===void 0&&(this.data[y]=[]);var w={value:s,timeout:void 0};if(a!==void 0&&(w.timeout=setTimeout(function(){u.remove(n,w)},a)),this.data[y].push(w),this.order.push(y),this.order.length>this.max){var k=this._getAndRemoveByKey(this.order[0]);k&&this.onRemove(k)}return this},kt.prototype.has=function(n){return n.wrapped().key in this.data},kt.prototype.getAndRemove=function(n){return this.has(n)?this._getAndRemoveByKey(n.wrapped().key):null},kt.prototype._getAndRemoveByKey=function(n){var s=this.data[n].shift();return s.timeout&&clearTimeout(s.timeout),this.data[n].length===0&&delete this.data[n],this.order.splice(this.order.indexOf(n),1),s.value},kt.prototype.getByKey=function(n){var s=this.data[n];return s?s[0].value:null},kt.prototype.get=function(n){return this.has(n)?this.data[n.wrapped().key][0].value:null},kt.prototype.remove=function(n,s){if(!this.has(n))return this;var a=n.wrapped().key,u=s===void 0?0:this.data[a].indexOf(s),y=this.data[a][u];return this.data[a].splice(u,1),y.timeout&&clearTimeout(y.timeout),this.data[a].length===0&&delete this.data[a],this.onRemove(y.value),this.order.splice(this.order.indexOf(a),1),this},kt.prototype.setMaxSize=function(n){for(this.max=n;this.order.length>this.max;){var s=this._getAndRemoveByKey(this.order[0]);s&&this.onRemove(s)}return this},kt.prototype.filter=function(n){var s=[];for(var a in this.data)for(var u=0,y=this.data[a];u<y.length;u+=1){var w=y[u];n(w.value)||s.push(w)}for(var k=0,E=s;k<E.length;k+=1){var P=E[k];this.remove(P.value.tileID,P)}};var Ur=function(n,s,a){this.context=n;var u=n.gl;this.buffer=u.createBuffer(),this.dynamicDraw=!!a,this.context.unbindVAO(),n.bindElementBuffer.set(this.buffer),u.bufferData(u.ELEMENT_ARRAY_BUFFER,s.arrayBuffer,this.dynamicDraw?u.DYNAMIC_DRAW:u.STATIC_DRAW),this.dynamicDraw||delete s.arrayBuffer};Ur.prototype.bind=function(){this.context.bindElementBuffer.set(this.buffer)},Ur.prototype.updateData=function(n){var s=this.context.gl;this.context.unbindVAO(),this.bind(),s.bufferSubData(s.ELEMENT_ARRAY_BUFFER,0,n.arrayBuffer)},Ur.prototype.destroy=function(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)};var Tn={Int8:"BYTE",Uint8:"UNSIGNED_BYTE",Int16:"SHORT",Uint16:"UNSIGNED_SHORT",Int32:"INT",Uint32:"UNSIGNED_INT",Float32:"FLOAT"},$r=function(n,s,a,u){this.length=s.length,this.attributes=a,this.itemSize=s.bytesPerElement,this.dynamicDraw=u,this.context=n;var y=n.gl;this.buffer=y.createBuffer(),n.bindVertexBuffer.set(this.buffer),y.bufferData(y.ARRAY_BUFFER,s.arrayBuffer,this.dynamicDraw?y.DYNAMIC_DRAW:y.STATIC_DRAW),this.dynamicDraw||delete s.arrayBuffer};$r.prototype.bind=function(){this.context.bindVertexBuffer.set(this.buffer)},$r.prototype.updateData=function(n){var s=this.context.gl;this.bind(),s.bufferSubData(s.ARRAY_BUFFER,0,n.arrayBuffer)},$r.prototype.enableAttributes=function(n,s){for(var a=0;a<this.attributes.length;a++){var u=s.attributes[this.attributes[a].name];u!==void 0&&n.enableVertexAttribArray(u)}},$r.prototype.setVertexAttribPointers=function(n,s,a){for(var u=0;u<this.attributes.length;u++){var y=this.attributes[u],w=s.attributes[y.name];w!==void 0&&n.vertexAttribPointer(w,y.components,n[Tn[y.type]],!1,this.itemSize,y.offset+this.itemSize*(a||0))}},$r.prototype.destroy=function(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)};var Zt=function(n){this.gl=n.gl,this.default=this.getDefault(),this.current=this.default,this.dirty=!1};Zt.prototype.get=function(){return this.current},Zt.prototype.set=function(n){},Zt.prototype.getDefault=function(){return this.default},Zt.prototype.setDefault=function(){this.set(this.default)};var $t=function(n){function s(){n.apply(this,arguments)}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype.getDefault=function(){return o.Color.transparent},s.prototype.set=function(a){var u=this.current;(a.r!==u.r||a.g!==u.g||a.b!==u.b||a.a!==u.a||this.dirty)&&(this.gl.clearColor(a.r,a.g,a.b,a.a),this.current=a,this.dirty=!1)},s}(Zt),Dr=function(n){function s(){n.apply(this,arguments)}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype.getDefault=function(){return 1},s.prototype.set=function(a){(a!==this.current||this.dirty)&&(this.gl.clearDepth(a),this.current=a,this.dirty=!1)},s}(Zt),Pr=function(n){function s(){n.apply(this,arguments)}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype.getDefault=function(){return 0},s.prototype.set=function(a){(a!==this.current||this.dirty)&&(this.gl.clearStencil(a),this.current=a,this.dirty=!1)},s}(Zt),Dn=function(n){function s(){n.apply(this,arguments)}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype.getDefault=function(){return[!0,!0,!0,!0]},s.prototype.set=function(a){var u=this.current;(a[0]!==u[0]||a[1]!==u[1]||a[2]!==u[2]||a[3]!==u[3]||this.dirty)&&(this.gl.colorMask(a[0],a[1],a[2],a[3]),this.current=a,this.dirty=!1)},s}(Zt),Xr=function(n){function s(){n.apply(this,arguments)}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype.getDefault=function(){return!0},s.prototype.set=function(a){(a!==this.current||this.dirty)&&(this.gl.depthMask(a),this.current=a,this.dirty=!1)},s}(Zt),gi=function(n){function s(){n.apply(this,arguments)}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype.getDefault=function(){return 255},s.prototype.set=function(a){(a!==this.current||this.dirty)&&(this.gl.stencilMask(a),this.current=a,this.dirty=!1)},s}(Zt),ci=function(n){function s(){n.apply(this,arguments)}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype.getDefault=function(){return{func:this.gl.ALWAYS,ref:0,mask:255}},s.prototype.set=function(a){var u=this.current;(a.func!==u.func||a.ref!==u.ref||a.mask!==u.mask||this.dirty)&&(this.gl.stencilFunc(a.func,a.ref,a.mask),this.current=a,this.dirty=!1)},s}(Zt),Ji=function(n){function s(){n.apply(this,arguments)}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype.getDefault=function(){var a=this.gl;return[a.KEEP,a.KEEP,a.KEEP]},s.prototype.set=function(a){var u=this.current;(a[0]!==u[0]||a[1]!==u[1]||a[2]!==u[2]||this.dirty)&&(this.gl.stencilOp(a[0],a[1],a[2]),this.current=a,this.dirty=!1)},s}(Zt),Ci=function(n){function s(){n.apply(this,arguments)}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype.getDefault=function(){return!1},s.prototype.set=function(a){if(a!==this.current||this.dirty){var u=this.gl;a?u.enable(u.STENCIL_TEST):u.disable(u.STENCIL_TEST),this.current=a,this.dirty=!1}},s}(Zt),hi=function(n){function s(){n.apply(this,arguments)}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype.getDefault=function(){return[0,1]},s.prototype.set=function(a){var u=this.current;(a[0]!==u[0]||a[1]!==u[1]||this.dirty)&&(this.gl.depthRange(a[0],a[1]),this.current=a,this.dirty=!1)},s}(Zt),ei=function(n){function s(){n.apply(this,arguments)}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype.getDefault=function(){return!1},s.prototype.set=function(a){if(a!==this.current||this.dirty){var u=this.gl;a?u.enable(u.DEPTH_TEST):u.disable(u.DEPTH_TEST),this.current=a,this.dirty=!1}},s}(Zt),on=function(n){function s(){n.apply(this,arguments)}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype.getDefault=function(){return this.gl.LESS},s.prototype.set=function(a){(a!==this.current||this.dirty)&&(this.gl.depthFunc(a),this.current=a,this.dirty=!1)},s}(Zt),pi=function(n){function s(){n.apply(this,arguments)}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype.getDefault=function(){return!1},s.prototype.set=function(a){if(a!==this.current||this.dirty){var u=this.gl;a?u.enable(u.BLEND):u.disable(u.BLEND),this.current=a,this.dirty=!1}},s}(Zt),Nr=function(n){function s(){n.apply(this,arguments)}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype.getDefault=function(){var a=this.gl;return[a.ONE,a.ZERO]},s.prototype.set=function(a){var u=this.current;(a[0]!==u[0]||a[1]!==u[1]||this.dirty)&&(this.gl.blendFunc(a[0],a[1]),this.current=a,this.dirty=!1)},s}(Zt),Yi=function(n){function s(){n.apply(this,arguments)}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype.getDefault=function(){return o.Color.transparent},s.prototype.set=function(a){var u=this.current;(a.r!==u.r||a.g!==u.g||a.b!==u.b||a.a!==u.a||this.dirty)&&(this.gl.blendColor(a.r,a.g,a.b,a.a),this.current=a,this.dirty=!1)},s}(Zt),Ln=function(n){function s(){n.apply(this,arguments)}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype.getDefault=function(){return this.gl.FUNC_ADD},s.prototype.set=function(a){(a!==this.current||this.dirty)&&(this.gl.blendEquation(a),this.current=a,this.dirty=!1)},s}(Zt),Oi=function(n){function s(){n.apply(this,arguments)}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype.getDefault=function(){return!1},s.prototype.set=function(a){if(a!==this.current||this.dirty){var u=this.gl;a?u.enable(u.CULL_FACE):u.disable(u.CULL_FACE),this.current=a,this.dirty=!1}},s}(Zt),In=function(n){function s(){n.apply(this,arguments)}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype.getDefault=function(){return this.gl.BACK},s.prototype.set=function(a){(a!==this.current||this.dirty)&&(this.gl.cullFace(a),this.current=a,this.dirty=!1)},s}(Zt),Qi=function(n){function s(){n.apply(this,arguments)}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype.getDefault=function(){return this.gl.CCW},s.prototype.set=function(a){(a!==this.current||this.dirty)&&(this.gl.frontFace(a),this.current=a,this.dirty=!1)},s}(Zt),zn=function(n){function s(){n.apply(this,arguments)}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype.getDefault=function(){return null},s.prototype.set=function(a){(a!==this.current||this.dirty)&&(this.gl.useProgram(a),this.current=a,this.dirty=!1)},s}(Zt),Fi=function(n){function s(){n.apply(this,arguments)}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype.getDefault=function(){return this.gl.TEXTURE0},s.prototype.set=function(a){(a!==this.current||this.dirty)&&(this.gl.activeTexture(a),this.current=a,this.dirty=!1)},s}(Zt),yn=function(n){function s(){n.apply(this,arguments)}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype.getDefault=function(){var a=this.gl;return[0,0,a.drawingBufferWidth,a.drawingBufferHeight]},s.prototype.set=function(a){var u=this.current;(a[0]!==u[0]||a[1]!==u[1]||a[2]!==u[2]||a[3]!==u[3]||this.dirty)&&(this.gl.viewport(a[0],a[1],a[2],a[3]),this.current=a,this.dirty=!1)},s}(Zt),Ni=function(n){function s(){n.apply(this,arguments)}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype.getDefault=function(){return null},s.prototype.set=function(a){if(a!==this.current||this.dirty){var u=this.gl;u.bindFramebuffer(u.FRAMEBUFFER,a),this.current=a,this.dirty=!1}},s}(Zt),Rn=function(n){function s(){n.apply(this,arguments)}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype.getDefault=function(){return null},s.prototype.set=function(a){if(a!==this.current||this.dirty){var u=this.gl;u.bindRenderbuffer(u.RENDERBUFFER,a),this.current=a,this.dirty=!1}},s}(Zt),$i=function(n){function s(){n.apply(this,arguments)}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype.getDefault=function(){return null},s.prototype.set=function(a){if(a!==this.current||this.dirty){var u=this.gl;u.bindTexture(u.TEXTURE_2D,a),this.current=a,this.dirty=!1}},s}(Zt),Ui=function(n){function s(){n.apply(this,arguments)}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype.getDefault=function(){return null},s.prototype.set=function(a){if(a!==this.current||this.dirty){var u=this.gl;u.bindBuffer(u.ARRAY_BUFFER,a),this.current=a,this.dirty=!1}},s}(Zt),_n=function(n){function s(){n.apply(this,arguments)}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype.getDefault=function(){return null},s.prototype.set=function(a){var u=this.gl;u.bindBuffer(u.ELEMENT_ARRAY_BUFFER,a),this.current=a,this.dirty=!1},s}(Zt),an=function(n){function s(a){n.call(this,a),this.vao=a.extVertexArrayObject}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype.getDefault=function(){return null},s.prototype.set=function(a){this.vao&&(a!==this.current||this.dirty)&&(this.vao.bindVertexArrayOES(a),this.current=a,this.dirty=!1)},s}(Zt),sn=function(n){function s(){n.apply(this,arguments)}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype.getDefault=function(){return 4},s.prototype.set=function(a){if(a!==this.current||this.dirty){var u=this.gl;u.pixelStorei(u.UNPACK_ALIGNMENT,a),this.current=a,this.dirty=!1}},s}(Zt),gn=function(n){function s(){n.apply(this,arguments)}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype.getDefault=function(){return!1},s.prototype.set=function(a){if(a!==this.current||this.dirty){var u=this.gl;u.pixelStorei(u.UNPACK_PREMULTIPLY_ALPHA_WEBGL,a),this.current=a,this.dirty=!1}},s}(Zt),ni=function(n){function s(){n.apply(this,arguments)}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype.getDefault=function(){return!1},s.prototype.set=function(a){if(a!==this.current||this.dirty){var u=this.gl;u.pixelStorei(u.UNPACK_FLIP_Y_WEBGL,a),this.current=a,this.dirty=!1}},s}(Zt),Cr=function(n){function s(a,u){n.call(this,a),this.context=a,this.parent=u}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype.getDefault=function(){return null},s}(Zt),L=function(n){function s(){n.apply(this,arguments)}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype.setDirty=function(){this.dirty=!0},s.prototype.set=function(a){if(a!==this.current||this.dirty){this.context.bindFramebuffer.set(this.parent);var u=this.gl;u.framebufferTexture2D(u.FRAMEBUFFER,u.COLOR_ATTACHMENT0,u.TEXTURE_2D,a,0),this.current=a,this.dirty=!1}},s}(Cr),N=function(n){function s(){n.apply(this,arguments)}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype.set=function(a){if(a!==this.current||this.dirty){this.context.bindFramebuffer.set(this.parent);var u=this.gl;u.framebufferRenderbuffer(u.FRAMEBUFFER,u.DEPTH_ATTACHMENT,u.RENDERBUFFER,a),this.current=a,this.dirty=!1}},s}(Cr),V=function(n,s,a,u){this.context=n,this.width=s,this.height=a;var y=this.framebuffer=n.gl.createFramebuffer();this.colorAttachment=new L(n,y),u&&(this.depthAttachment=new N(n,y))};V.prototype.destroy=function(){var n=this.context.gl,s=this.colorAttachment.get();if(s&&n.deleteTexture(s),this.depthAttachment){var a=this.depthAttachment.get();a&&n.deleteRenderbuffer(a)}n.deleteFramebuffer(this.framebuffer)};var X=function(n,s,a){this.func=n,this.mask=s,this.range=a};X.ReadOnly=!1,X.ReadWrite=!0,X.disabled=new X(519,X.ReadOnly,[0,1]);var $=function(n,s,a,u,y,w){this.test=n,this.ref=s,this.mask=a,this.fail=u,this.depthFail=y,this.pass=w};$.disabled=new $({func:519,mask:0},0,0,7680,7680,7680);var se=function(n,s,a){this.blendFunction=n,this.blendColor=s,this.mask=a};se.disabled=new se(se.Replace=[1,0],o.Color.transparent,[!1,!1,!1,!1]),se.unblended=new se(se.Replace,o.Color.transparent,[!0,!0,!0,!0]),se.alphaBlended=new se([1,771],o.Color.transparent,[!0,!0,!0,!0]);var pe=function(n,s,a){this.enable=n,this.mode=s,this.frontFace=a};pe.disabled=new pe(!1,1029,2305),pe.backCCW=new pe(!0,1029,2305);var j=function(n){this.gl=n,this.extVertexArrayObject=this.gl.getExtension("OES_vertex_array_object"),this.clearColor=new $t(this),this.clearDepth=new Dr(this),this.clearStencil=new Pr(this),this.colorMask=new Dn(this),this.depthMask=new Xr(this),this.stencilMask=new gi(this),this.stencilFunc=new ci(this),this.stencilOp=new Ji(this),this.stencilTest=new Ci(this),this.depthRange=new hi(this),this.depthTest=new ei(this),this.depthFunc=new on(this),this.blend=new pi(this),this.blendFunc=new Nr(this),this.blendColor=new Yi(this),this.blendEquation=new Ln(this),this.cullFace=new Oi(this),this.cullFaceSide=new In(this),this.frontFace=new Qi(this),this.program=new zn(this),this.activeTexture=new Fi(this),this.viewport=new yn(this),this.bindFramebuffer=new Ni(this),this.bindRenderbuffer=new Rn(this),this.bindTexture=new $i(this),this.bindVertexBuffer=new Ui(this),this.bindElementBuffer=new _n(this),this.bindVertexArrayOES=this.extVertexArrayObject&&new an(this),this.pixelStoreUnpack=new sn(this),this.pixelStoreUnpackPremultiplyAlpha=new gn(this),this.pixelStoreUnpackFlipY=new ni(this),this.extTextureFilterAnisotropic=n.getExtension("EXT_texture_filter_anisotropic")||n.getExtension("MOZ_EXT_texture_filter_anisotropic")||n.getExtension("WEBKIT_EXT_texture_filter_anisotropic"),this.extTextureFilterAnisotropic&&(this.extTextureFilterAnisotropicMax=n.getParameter(this.extTextureFilterAnisotropic.MAX_TEXTURE_MAX_ANISOTROPY_EXT)),this.extTextureHalfFloat=n.getExtension("OES_texture_half_float"),this.extTextureHalfFloat&&(n.getExtension("OES_texture_half_float_linear"),this.extRenderToTextureHalfFloat=n.getExtension("EXT_color_buffer_half_float")),this.extTimerQuery=n.getExtension("EXT_disjoint_timer_query"),this.maxTextureSize=n.getParameter(n.MAX_TEXTURE_SIZE)};j.prototype.setDefault=function(){this.unbindVAO(),this.clearColor.setDefault(),this.clearDepth.setDefault(),this.clearStencil.setDefault(),this.colorMask.setDefault(),this.depthMask.setDefault(),this.stencilMask.setDefault(),this.stencilFunc.setDefault(),this.stencilOp.setDefault(),this.stencilTest.setDefault(),this.depthRange.setDefault(),this.depthTest.setDefault(),this.depthFunc.setDefault(),this.blend.setDefault(),this.blendFunc.setDefault(),this.blendColor.setDefault(),this.blendEquation.setDefault(),this.cullFace.setDefault(),this.cullFaceSide.setDefault(),this.frontFace.setDefault(),this.program.setDefault(),this.activeTexture.setDefault(),this.bindFramebuffer.setDefault(),this.pixelStoreUnpack.setDefault(),this.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.pixelStoreUnpackFlipY.setDefault()},j.prototype.setDirty=function(){this.clearColor.dirty=!0,this.clearDepth.dirty=!0,this.clearStencil.dirty=!0,this.colorMask.dirty=!0,this.depthMask.dirty=!0,this.stencilMask.dirty=!0,this.stencilFunc.dirty=!0,this.stencilOp.dirty=!0,this.stencilTest.dirty=!0,this.depthRange.dirty=!0,this.depthTest.dirty=!0,this.depthFunc.dirty=!0,this.blend.dirty=!0,this.blendFunc.dirty=!0,this.blendColor.dirty=!0,this.blendEquation.dirty=!0,this.cullFace.dirty=!0,this.cullFaceSide.dirty=!0,this.frontFace.dirty=!0,this.program.dirty=!0,this.activeTexture.dirty=!0,this.viewport.dirty=!0,this.bindFramebuffer.dirty=!0,this.bindRenderbuffer.dirty=!0,this.bindTexture.dirty=!0,this.bindVertexBuffer.dirty=!0,this.bindElementBuffer.dirty=!0,this.extVertexArrayObject&&(this.bindVertexArrayOES.dirty=!0),this.pixelStoreUnpack.dirty=!0,this.pixelStoreUnpackPremultiplyAlpha.dirty=!0,this.pixelStoreUnpackFlipY.dirty=!0},j.prototype.createIndexBuffer=function(n,s){return new Ur(this,n,s)},j.prototype.createVertexBuffer=function(n,s,a){return new $r(this,n,s,a)},j.prototype.createRenderbuffer=function(n,s,a){var u=this.gl,y=u.createRenderbuffer();return this.bindRenderbuffer.set(y),u.renderbufferStorage(u.RENDERBUFFER,n,s,a),this.bindRenderbuffer.set(null),y},j.prototype.createFramebuffer=function(n,s,a){return new V(this,n,s,a)},j.prototype.clear=function(n){var s=n.color,a=n.depth,u=this.gl,y=0;s&&(y|=u.COLOR_BUFFER_BIT,this.clearColor.set(s),this.colorMask.set([!0,!0,!0,!0])),a!==void 0&&(y|=u.DEPTH_BUFFER_BIT,this.depthRange.set([0,1]),this.clearDepth.set(a),this.depthMask.set(!0)),u.clear(y)},j.prototype.setCullFace=function(n){n.enable===!1?this.cullFace.set(!1):(this.cullFace.set(!0),this.cullFaceSide.set(n.mode),this.frontFace.set(n.frontFace))},j.prototype.setDepthMode=function(n){n.func!==this.gl.ALWAYS||n.mask?(this.depthTest.set(!0),this.depthFunc.set(n.func),this.depthMask.set(n.mask),this.depthRange.set(n.range)):this.depthTest.set(!1)},j.prototype.setStencilMode=function(n){n.test.func!==this.gl.ALWAYS||n.mask?(this.stencilTest.set(!0),this.stencilMask.set(n.mask),this.stencilOp.set([n.fail,n.depthFail,n.pass]),this.stencilFunc.set({func:n.test.func,ref:n.ref,mask:n.test.mask})):this.stencilTest.set(!1)},j.prototype.setColorMode=function(n){o.deepEqual(n.blendFunction,se.Replace)?this.blend.set(!1):(this.blend.set(!0),this.blendFunc.set(n.blendFunction),this.blendColor.set(n.blendColor)),this.colorMask.set(n.mask)},j.prototype.unbindVAO=function(){this.extVertexArrayObject&&this.bindVertexArrayOES.set(null)};var J=function(n){function s(a,u,y){var w=this;n.call(this),this.id=a,this.dispatcher=y,this.on("data",function(k){k.dataType==="source"&&k.sourceDataType==="metadata"&&(w._sourceLoaded=!0),w._sourceLoaded&&!w._paused&&k.dataType==="source"&&k.sourceDataType==="content"&&(w.reload(),w.transform&&w.update(w.transform))}),this.on("error",function(){w._sourceErrored=!0}),this._source=function(k,E,P,O){var Z=new Fr[E.type](k,E,P,O);if(Z.id!==k)throw new Error("Expected Source id to be "+k+" instead of "+Z.id);return o.bindAll(["load","abort","unload","serialize","prepare"],Z),Z}(a,u,y,this),this._tiles={},this._cache=new kt(0,this._unloadTile.bind(this)),this._timers={},this._cacheTimers={},this._maxTileCacheSize=null,this._loadedParentTiles={},this._coveredTiles={},this._state=new o.SourceFeatureState}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype.onAdd=function(a){this.map=a,this._maxTileCacheSize=a?a._maxTileCacheSize:null,this._source&&this._source.onAdd&&this._source.onAdd(a)},s.prototype.onRemove=function(a){this._source&&this._source.onRemove&&this._source.onRemove(a)},s.prototype.loaded=function(){if(this._sourceErrored)return!0;if(!this._sourceLoaded||!this._source.loaded())return!1;for(var a in this._tiles){var u=this._tiles[a];if(u.state!=="loaded"&&u.state!=="errored")return!1}return!0},s.prototype.getSource=function(){return this._source},s.prototype.pause=function(){this._paused=!0},s.prototype.resume=function(){if(this._paused){var a=this._shouldReloadOnResume;this._paused=!1,this._shouldReloadOnResume=!1,a&&this.reload(),this.transform&&this.update(this.transform)}},s.prototype._loadTile=function(a,u){return this._source.loadTile(a,u)},s.prototype._unloadTile=function(a){if(this._source.unloadTile)return this._source.unloadTile(a,function(){})},s.prototype._abortTile=function(a){if(this._source.abortTile)return this._source.abortTile(a,function(){})},s.prototype.serialize=function(){return this._source.serialize()},s.prototype.prepare=function(a){for(var u in this._source.prepare&&this._source.prepare(),this._state.coalesceChanges(this._tiles,this.map?this.map.painter:null),this._tiles){var y=this._tiles[u];y.upload(a),y.prepare(this.map.style.imageManager)}},s.prototype.getIds=function(){return o.values(this._tiles).map(function(a){return a.tileID}).sort(_e).map(function(a){return a.key})},s.prototype.getRenderableIds=function(a){var u=this,y=[];for(var w in this._tiles)this._isIdRenderable(w,a)&&y.push(this._tiles[w]);return a?y.sort(function(k,E){var P=k.tileID,O=E.tileID,Z=new o.Point(P.canonical.x,P.canonical.y)._rotate(u.transform.angle),G=new o.Point(O.canonical.x,O.canonical.y)._rotate(u.transform.angle);return P.overscaledZ-O.overscaledZ||G.y-Z.y||G.x-Z.x}).map(function(k){return k.tileID.key}):y.map(function(k){return k.tileID}).sort(_e).map(function(k){return k.key})},s.prototype.hasRenderableParent=function(a){var u=this.findLoadedParent(a,0);return!!u&&this._isIdRenderable(u.tileID.key)},s.prototype._isIdRenderable=function(a,u){return this._tiles[a]&&this._tiles[a].hasData()&&!this._coveredTiles[a]&&(u||!this._tiles[a].holdingForFade())},s.prototype.reload=function(){if(this._paused)this._shouldReloadOnResume=!0;else for(var a in this._cache.reset(),this._tiles)this._tiles[a].state!=="errored"&&this._reloadTile(a,"reloading")},s.prototype._reloadTile=function(a,u){var y=this._tiles[a];y&&(y.state!=="loading"&&(y.state=u),this._loadTile(y,this._tileLoaded.bind(this,y,a,u)))},s.prototype._tileLoaded=function(a,u,y,w){if(w)return a.state="errored",void(w.status!==404?this._source.fire(new o.ErrorEvent(w,{tile:a})):this.update(this.transform));a.timeAdded=o.browser.now(),y==="expired"&&(a.refreshedUponExpiration=!0),this._setTileReloadTimer(u,a),this.getSource().type==="raster-dem"&&a.dem&&this._backfillDEM(a),this._state.initializeTileState(a,this.map?this.map.painter:null),this._source.fire(new o.Event("data",{dataType:"source",tile:a,coord:a.tileID}))},s.prototype._backfillDEM=function(a){for(var u=this.getRenderableIds(),y=0;y<u.length;y++){var w=u[y];if(a.neighboringTiles&&a.neighboringTiles[w]){var k=this.getTileByID(w);E(a,k),E(k,a)}}function E(P,O){P.needsHillshadePrepare=!0;var Z=O.tileID.canonical.x-P.tileID.canonical.x,G=O.tileID.canonical.y-P.tileID.canonical.y,K=Math.pow(2,P.tileID.canonical.z),re=O.tileID.key;Z===0&&G===0||Math.abs(G)>1||(Math.abs(Z)>1&&(Math.abs(Z+K)===1?Z+=K:Math.abs(Z-K)===1&&(Z-=K)),O.dem&&P.dem&&(P.dem.backfillBorder(O.dem,Z,G),P.neighboringTiles&&P.neighboringTiles[re]&&(P.neighboringTiles[re].backfilled=!0)))}},s.prototype.getTile=function(a){return this.getTileByID(a.key)},s.prototype.getTileByID=function(a){return this._tiles[a]},s.prototype._retainLoadedChildren=function(a,u,y,w){for(var k in this._tiles){var E=this._tiles[k];if(!(w[k]||!E.hasData()||E.tileID.overscaledZ<=u||E.tileID.overscaledZ>y)){for(var P=E.tileID;E&&E.tileID.overscaledZ>u+1;){var O=E.tileID.scaledTo(E.tileID.overscaledZ-1);(E=this._tiles[O.key])&&E.hasData()&&(P=O)}for(var Z=P;Z.overscaledZ>u;)if(a[(Z=Z.scaledTo(Z.overscaledZ-1)).key]){w[P.key]=P;break}}}},s.prototype.findLoadedParent=function(a,u){if(a.key in this._loadedParentTiles){var y=this._loadedParentTiles[a.key];return y&&y.tileID.overscaledZ>=u?y:null}for(var w=a.overscaledZ-1;w>=u;w--){var k=a.scaledTo(w),E=this._getLoadedTile(k);if(E)return E}},s.prototype._getLoadedTile=function(a){var u=this._tiles[a.key];return u&&u.hasData()?u:this._cache.getByKey(a.wrapped().key)},s.prototype.updateCacheSize=function(a){var u=Math.ceil(a.width/this._source.tileSize)+1,y=Math.ceil(a.height/this._source.tileSize)+1,w=Math.floor(u*y*5),k=typeof this._maxTileCacheSize=="number"?Math.min(this._maxTileCacheSize,w):w;this._cache.setMaxSize(k)},s.prototype.handleWrapJump=function(a){var u=Math.round((a-(this._prevLng===void 0?a:this._prevLng))/360);if(this._prevLng=a,u){var y={};for(var w in this._tiles){var k=this._tiles[w];k.tileID=k.tileID.unwrapTo(k.tileID.wrap+u),y[k.tileID.key]=k}for(var E in this._tiles=y,this._timers)clearTimeout(this._timers[E]),delete this._timers[E];for(var P in this._tiles)this._setTileReloadTimer(P,this._tiles[P])}},s.prototype.update=function(a){var u=this;if(this.transform=a,this._sourceLoaded&&!this._paused){var y;this.updateCacheSize(a),this.handleWrapJump(this.transform.center.lng),this._coveredTiles={},this.used?this._source.tileID?y=a.getVisibleUnwrappedCoordinates(this._source.tileID).map(function(De){return new o.OverscaledTileID(De.canonical.z,De.wrap,De.canonical.z,De.canonical.x,De.canonical.y)}):(y=a.coveringTiles({tileSize:this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this._source.roundZoom,reparseOverscaled:this._source.reparseOverscaled}),this._source.hasTile&&(y=y.filter(function(De){return u._source.hasTile(De)}))):y=[];var w=a.coveringZoomLevel(this._source),k=Math.max(w-s.maxOverzooming,this._source.minzoom),E=Math.max(w+s.maxUnderzooming,this._source.minzoom),P=this._updateRetainedTiles(y,w);if(Ce(this._source.type)){for(var O={},Z={},G=0,K=Object.keys(P);G<K.length;G+=1){var re=K[G],te=P[re],ue=this._tiles[re];if(ue&&!(ue.fadeEndTime&&ue.fadeEndTime<=o.browser.now())){var Y=this.findLoadedParent(te,k);Y&&(this._addTile(Y.tileID),O[Y.tileID.key]=Y.tileID),Z[re]=te}}for(var le in this._retainLoadedChildren(Z,w,E,P),O)P[le]||(this._coveredTiles[le]=!0,P[le]=O[le])}for(var fe in P)this._tiles[fe].clearFadeHold();for(var ge=0,ze=o.keysDifference(this._tiles,P);ge<ze.length;ge+=1){var Ee=ze[ge],Ae=this._tiles[Ee];Ae.hasSymbolBuckets&&!Ae.holdingForFade()?Ae.setHoldDuration(this.map._fadeDuration):Ae.hasSymbolBuckets&&!Ae.symbolFadeFinished()||this._removeTile(Ee)}this._updateLoadedParentTileCache()}},s.prototype.releaseSymbolFadeTiles=function(){for(var a in this._tiles)this._tiles[a].holdingForFade()&&this._removeTile(a)},s.prototype._updateRetainedTiles=function(a,u){for(var y={},w={},k=Math.max(u-s.maxOverzooming,this._source.minzoom),E=Math.max(u+s.maxUnderzooming,this._source.minzoom),P={},O=0,Z=a;O<Z.length;O+=1){var G=Z[O],K=this._addTile(G);y[G.key]=G,K.hasData()||u<this._source.maxzoom&&(P[G.key]=G)}this._retainLoadedChildren(P,u,E,y);for(var re=0,te=a;re<te.length;re+=1){var ue=te[re],Y=this._tiles[ue.key];if(!Y.hasData()){if(u+1>this._source.maxzoom){var le=ue.children(this._source.maxzoom)[0],fe=this.getTile(le);if(fe&&fe.hasData()){y[le.key]=le;continue}}else{var ge=ue.children(this._source.maxzoom);if(y[ge[0].key]&&y[ge[1].key]&&y[ge[2].key]&&y[ge[3].key])continue}for(var ze=Y.wasRequested(),Ee=ue.overscaledZ-1;Ee>=k;--Ee){var Ae=ue.scaledTo(Ee);if(w[Ae.key]||(w[Ae.key]=!0,!(Y=this.getTile(Ae))&&ze&&(Y=this._addTile(Ae)),Y&&(y[Ae.key]=Ae,ze=Y.wasRequested(),Y.hasData())))break}}}return y},s.prototype._updateLoadedParentTileCache=function(){for(var a in this._loadedParentTiles={},this._tiles){for(var u=[],y=void 0,w=this._tiles[a].tileID;w.overscaledZ>0;){if(w.key in this._loadedParentTiles){y=this._loadedParentTiles[w.key];break}u.push(w.key);var k=w.scaledTo(w.overscaledZ-1);if(y=this._getLoadedTile(k))break;w=k}for(var E=0,P=u;E<P.length;E+=1)this._loadedParentTiles[P[E]]=y}},s.prototype._addTile=function(a){var u=this._tiles[a.key];if(u)return u;(u=this._cache.getAndRemove(a))&&(this._setTileReloadTimer(a.key,u),u.tileID=a,this._state.initializeTileState(u,this.map?this.map.painter:null),this._cacheTimers[a.key]&&(clearTimeout(this._cacheTimers[a.key]),delete this._cacheTimers[a.key],this._setTileReloadTimer(a.key,u)));var y=!!u;return y||(u=new o.Tile(a,this._source.tileSize*a.overscaleFactor()),this._loadTile(u,this._tileLoaded.bind(this,u,a.key,u.state))),u?(u.uses++,this._tiles[a.key]=u,y||this._source.fire(new o.Event("dataloading",{tile:u,coord:u.tileID,dataType:"source"})),u):null},s.prototype._setTileReloadTimer=function(a,u){var y=this;a in this._timers&&(clearTimeout(this._timers[a]),delete this._timers[a]);var w=u.getExpiryTimeout();w&&(this._timers[a]=setTimeout(function(){y._reloadTile(a,"expired"),delete y._timers[a]},w))},s.prototype._removeTile=function(a){var u=this._tiles[a];u&&(u.uses--,delete this._tiles[a],this._timers[a]&&(clearTimeout(this._timers[a]),delete this._timers[a]),u.uses>0||(u.hasData()&&u.state!=="reloading"?this._cache.add(u.tileID,u,u.getExpiryTimeout()):(u.aborted=!0,this._abortTile(u),this._unloadTile(u))))},s.prototype.clearTiles=function(){for(var a in this._shouldReloadOnResume=!1,this._paused=!1,this._tiles)this._removeTile(a);this._cache.reset()},s.prototype.tilesIn=function(a,u,y){var w=this,k=[],E=this.transform;if(!E)return k;for(var P=y?E.getCameraQueryGeometry(a):a,O=a.map(function(Ee){return E.pointCoordinate(Ee)}),Z=P.map(function(Ee){return E.pointCoordinate(Ee)}),G=this.getIds(),K=1/0,re=1/0,te=-1/0,ue=-1/0,Y=0,le=Z;Y<le.length;Y+=1){var fe=le[Y];K=Math.min(K,fe.x),re=Math.min(re,fe.y),te=Math.max(te,fe.x),ue=Math.max(ue,fe.y)}for(var ge=function(Ee){var Ae=w._tiles[G[Ee]];if(!Ae.holdingForFade()){var De=Ae.tileID,Ke=Math.pow(2,E.zoom-Ae.tileID.overscaledZ),Ze=u*Ae.queryPadding*o.EXTENT/Ae.tileSize/Ke,nt=[De.getTilePoint(new o.MercatorCoordinate(K,re)),De.getTilePoint(new o.MercatorCoordinate(te,ue))];if(nt[0].x-Ze<o.EXTENT&&nt[0].y-Ze<o.EXTENT&&nt[1].x+Ze>=0&&nt[1].y+Ze>=0){var vt=O.map(function(wt){return De.getTilePoint(wt)}),St=Z.map(function(wt){return De.getTilePoint(wt)});k.push({tile:Ae,tileID:De,queryGeometry:vt,cameraQueryGeometry:St,scale:Ke})}}},ze=0;ze<G.length;ze++)ge(ze);return k},s.prototype.getVisibleCoordinates=function(a){for(var u=this,y=this.getRenderableIds(a).map(function(P){return u._tiles[P].tileID}),w=0,k=y;w<k.length;w+=1){var E=k[w];E.posMatrix=this.transform.calculatePosMatrix(E.toUnwrapped())}return y},s.prototype.hasTransition=function(){if(this._source.hasTransition())return!0;if(Ce(this._source.type))for(var a in this._tiles){var u=this._tiles[a];if(u.fadeEndTime!==void 0&&u.fadeEndTime>=o.browser.now())return!0}return!1},s.prototype.setFeatureState=function(a,u,y){this._state.updateState(a=a||"_geojsonTileLayer",u,y)},s.prototype.removeFeatureState=function(a,u,y){this._state.removeFeatureState(a=a||"_geojsonTileLayer",u,y)},s.prototype.getFeatureState=function(a,u){return this._state.getState(a=a||"_geojsonTileLayer",u)},s.prototype.setDependencies=function(a,u,y){var w=this._tiles[a];w&&w.setDependencies(u,y)},s.prototype.reloadTilesForDependencies=function(a,u){for(var y in this._tiles)this._tiles[y].hasDependency(a,u)&&this._reloadTile(y,"reloading");this._cache.filter(function(w){return!w.hasDependency(a,u)})},s}(o.Evented);function _e(n,s){var a=Math.abs(2*n.wrap)-+(n.wrap<0),u=Math.abs(2*s.wrap)-+(s.wrap<0);return n.overscaledZ-s.overscaledZ||u-a||s.canonical.y-n.canonical.y||s.canonical.x-n.canonical.x}function Ce(n){return n==="raster"||n==="image"||n==="video"}function Me(){return new o.window.Worker(tl.workerUrl)}J.maxOverzooming=10,J.maxUnderzooming=3;var W="mapboxgl_preloaded_worker_pool",we=function(){this.active={}};we.prototype.acquire=function(n){if(!this.workers)for(this.workers=[];this.workers.length<we.workerCount;)this.workers.push(new Me);return this.active[n]=!0,this.workers.slice()},we.prototype.release=function(n){delete this.active[n],this.numActive()===0&&(this.workers.forEach(function(s){s.terminate()}),this.workers=null)},we.prototype.isPreloaded=function(){return!!this.active[W]},we.prototype.numActive=function(){return Object.keys(this.active).length};var $e,Xe=Math.floor(o.browser.hardwareConcurrency/2);function Se(){return $e||($e=new we),$e}function We(n,s){var a={};for(var u in n)u!=="ref"&&(a[u]=n[u]);return o.refProperties.forEach(function(y){y in s&&(a[y]=s[y])}),a}function Oe(n){n=n.slice();for(var s=Object.create(null),a=0;a<n.length;a++)s[n[a].id]=n[a];for(var u=0;u<n.length;u++)"ref"in n[u]&&(n[u]=We(n[u],s[n[u].ref]));return n}we.workerCount=Math.max(Math.min(Xe,6),1);var je={setStyle:"setStyle",addLayer:"addLayer",removeLayer:"removeLayer",setPaintProperty:"setPaintProperty",setLayoutProperty:"setLayoutProperty",setFilter:"setFilter",addSource:"addSource",removeSource:"removeSource",setGeoJSONSourceData:"setGeoJSONSourceData",setLayerZoomRange:"setLayerZoomRange",setLayerProperty:"setLayerProperty",setCenter:"setCenter",setZoom:"setZoom",setBearing:"setBearing",setPitch:"setPitch",setSprite:"setSprite",setGlyphs:"setGlyphs",setTransition:"setTransition",setLight:"setLight"};function Mt(n,s,a){a.push({command:je.addSource,args:[n,s[n]]})}function qe(n,s,a){s.push({command:je.removeSource,args:[n]}),a[n]=!0}function Vt(n,s,a,u){qe(n,a,u),Mt(n,s,a)}function lr(n,s,a){var u;for(u in n[a])if(n[a].hasOwnProperty(u)&&u!=="data"&&!o.deepEqual(n[a][u],s[a][u]))return!1;for(u in s[a])if(s[a].hasOwnProperty(u)&&u!=="data"&&!o.deepEqual(n[a][u],s[a][u]))return!1;return!0}function Pt(n,s,a,u,y,w){var k;for(k in s=s||{},n=n||{})n.hasOwnProperty(k)&&(o.deepEqual(n[k],s[k])||a.push({command:w,args:[u,k,s[k],y]}));for(k in s)s.hasOwnProperty(k)&&!n.hasOwnProperty(k)&&(o.deepEqual(n[k],s[k])||a.push({command:w,args:[u,k,s[k],y]}))}function er(n){return n.id}function Ht(n,s){return n[s.id]=s,n}var ti=function(n,s){this.reset(n,s)};ti.prototype.reset=function(n,s){this.points=n||[],this._distances=[0];for(var a=1;a<this.points.length;a++)this._distances[a]=this._distances[a-1]+this.points[a].dist(this.points[a-1]);this.length=this._distances[this._distances.length-1],this.padding=Math.min(s||0,.5*this.length),this.paddedLength=this.length-2*this.padding},ti.prototype.lerp=function(n){if(this.points.length===1)return this.points[0];n=o.clamp(n,0,1);for(var s=1,a=this._distances[s],u=n*this.paddedLength+this.padding;a<u&&s<this._distances.length;)a=this._distances[++s];var y=s-1,w=this._distances[y],k=a-w,E=k>0?(u-w)/k:0;return this.points[y].mult(1-E).add(this.points[s].mult(E))};var Qt=function(n,s,a){var u=this.boxCells=[],y=this.circleCells=[];this.xCellCount=Math.ceil(n/a),this.yCellCount=Math.ceil(s/a);for(var w=0;w<this.xCellCount*this.yCellCount;w++)u.push([]),y.push([]);this.circleKeys=[],this.boxKeys=[],this.bboxes=[],this.circles=[],this.width=n,this.height=s,this.xScale=this.xCellCount/n,this.yScale=this.yCellCount/s,this.boxUid=0,this.circleUid=0};function vr(n,s,a,u,y){var w=o.create();return s?(o.scale(w,w,[1/y,1/y,1]),a||o.rotateZ(w,w,u.angle)):o.multiply(w,u.labelPlaneMatrix,n),w}function dr(n,s,a,u,y){if(s){var w=o.clone(n);return o.scale(w,w,[y,y,1]),a||o.rotateZ(w,w,-u.angle),w}return u.glCoordMatrix}function Gt(n,s){var a=[n.x,n.y,0,1];ai(a,a,s);var u=a[3];return{point:new o.Point(a[0]/u,a[1]/u),signedDistanceFromCamera:u}}function tr(n,s){return .5+n/s*.5}function oi(n,s){var a=n[0]/n[3],u=n[1]/n[3];return a>=-s[0]&&a<=s[0]&&u>=-s[1]&&u<=s[1]}function Bn(n,s,a,u,y,w,k,E){var P=u?n.textSizeData:n.iconSizeData,O=o.evaluateSizeForZoom(P,a.transform.zoom),Z=[256/a.width*2+1,256/a.height*2+1],G=u?n.text.dynamicLayoutVertexArray:n.icon.dynamicLayoutVertexArray;G.clear();for(var K=n.lineVertexArray,re=u?n.text.placedSymbolArray:n.icon.placedSymbolArray,te=a.transform.width/a.transform.height,ue=!1,Y=0;Y<re.length;Y++){var le=re.get(Y);if(le.hidden||le.writingMode===o.WritingMode.vertical&&!ue)ki(le.numGlyphs,G);else{ue=!1;var fe=[le.anchorX,le.anchorY,0,1];if(o.transformMat4(fe,fe,s),oi(fe,Z)){var ge=tr(a.transform.cameraToCenterDistance,fe[3]),ze=o.evaluateSizeForFeature(P,O,le),Ee=k?ze/ge:ze*ge,Ae=new o.Point(le.anchorX,le.anchorY),De=Gt(Ae,y).point,Ke={},Ze=Vo(le,Ee,!1,E,s,y,w,n.glyphOffsetArray,K,G,De,Ae,Ke,te);ue=Ze.useVertical,(Ze.notEnoughRoom||ue||Ze.needsFlipping&&Vo(le,Ee,!0,E,s,y,w,n.glyphOffsetArray,K,G,De,Ae,Ke,te).notEnoughRoom)&&ki(le.numGlyphs,G)}else ki(le.numGlyphs,G)}}u?n.text.dynamicLayoutVertexBuffer.updateData(G):n.icon.dynamicLayoutVertexBuffer.updateData(G)}function wr(n,s,a,u,y,w,k,E,P,O,Z){var G=E.glyphStartIndex+E.numGlyphs,K=E.lineStartIndex,re=E.lineStartIndex+E.lineLength,te=s.getoffsetX(E.glyphStartIndex),ue=s.getoffsetX(G-1),Y=Zr(n*te,a,u,y,w,k,E.segment,K,re,P,O,Z);if(!Y)return null;var le=Zr(n*ue,a,u,y,w,k,E.segment,K,re,P,O,Z);return le?{first:Y,last:le}:null}function Mi(n,s,a,u){return n===o.WritingMode.horizontal&&Math.abs(a.y-s.y)>Math.abs(a.x-s.x)*u?{useVertical:!0}:(n===o.WritingMode.vertical?s.y<a.y:s.x>a.x)?{needsFlipping:!0}:null}function Vo(n,s,a,u,y,w,k,E,P,O,Z,G,K,re){var te,ue=s/24,Y=n.lineOffsetX*ue,le=n.lineOffsetY*ue;if(n.numGlyphs>1){var fe=n.glyphStartIndex+n.numGlyphs,ge=n.lineStartIndex,ze=n.lineStartIndex+n.lineLength,Ee=wr(ue,E,Y,le,a,Z,G,n,P,w,K);if(!Ee)return{notEnoughRoom:!0};var Ae=Gt(Ee.first.point,k).point,De=Gt(Ee.last.point,k).point;if(u&&!a){var Ke=Mi(n.writingMode,Ae,De,re);if(Ke)return Ke}te=[Ee.first];for(var Ze=n.glyphStartIndex+1;Ze<fe-1;Ze++)te.push(Zr(ue*E.getoffsetX(Ze),Y,le,a,Z,G,n.segment,ge,ze,P,w,K));te.push(Ee.last)}else{if(u&&!a){var nt=Gt(G,y).point,vt=n.lineStartIndex+n.segment+1,St=new o.Point(P.getx(vt),P.gety(vt)),wt=Gt(St,y),_r=wt.signedDistanceFromCamera>0?wt.point:vo(G,St,nt,1,y),at=Mi(n.writingMode,nt,_r,re);if(at)return at}var Nt=Zr(ue*E.getoffsetX(n.glyphStartIndex),Y,le,a,Z,G,n.segment,n.lineStartIndex,n.lineStartIndex+n.lineLength,P,w,K);if(!Nt)return{notEnoughRoom:!0};te=[Nt]}for(var Jt=0,Ot=te;Jt<Ot.length;Jt+=1){var Bt=Ot[Jt];o.addDynamicAttributes(O,Bt.point,Bt.angle)}return{}}function vo(n,s,a,u,y){var w=Gt(n.add(n.sub(s)._unit()),y).point,k=a.sub(w);return a.add(k._mult(u/k.mag()))}function Zr(n,s,a,u,y,w,k,E,P,O,Z,G){var K=u?n-s:n+s,re=K>0?1:-1,te=0;u&&(re*=-1,te=Math.PI),re<0&&(te+=Math.PI);for(var ue=re>0?E+k:E+k+1,Y=y,le=y,fe=0,ge=0,ze=Math.abs(K),Ee=[];fe+ge<=ze;){if((ue+=re)<E||ue>=P)return null;if(le=Y,Ee.push(Y),(Y=G[ue])===void 0){var Ae=new o.Point(O.getx(ue),O.gety(ue)),De=Gt(Ae,Z);if(De.signedDistanceFromCamera>0)Y=G[ue]=De.point;else{var Ke=ue-re;Y=vo(fe===0?w:new o.Point(O.getx(Ke),O.gety(Ke)),Ae,le,ze-fe+1,Z)}}fe+=ge,ge=le.dist(Y)}var Ze=(ze-fe)/ge,nt=Y.sub(le),vt=nt.mult(Ze)._add(le);vt._add(nt._unit()._perp()._mult(a*re));var St=te+Math.atan2(Y.y-le.y,Y.x-le.x);return Ee.push(vt),{point:vt,angle:St,path:Ee}}Qt.prototype.keysLength=function(){return this.boxKeys.length+this.circleKeys.length},Qt.prototype.insert=function(n,s,a,u,y){this._forEachCell(s,a,u,y,this._insertBoxCell,this.boxUid++),this.boxKeys.push(n),this.bboxes.push(s),this.bboxes.push(a),this.bboxes.push(u),this.bboxes.push(y)},Qt.prototype.insertCircle=function(n,s,a,u){this._forEachCell(s-u,a-u,s+u,a+u,this._insertCircleCell,this.circleUid++),this.circleKeys.push(n),this.circles.push(s),this.circles.push(a),this.circles.push(u)},Qt.prototype._insertBoxCell=function(n,s,a,u,y,w){this.boxCells[y].push(w)},Qt.prototype._insertCircleCell=function(n,s,a,u,y,w){this.circleCells[y].push(w)},Qt.prototype._query=function(n,s,a,u,y,w){if(a<0||n>this.width||u<0||s>this.height)return!y&&[];var k=[];if(n<=0&&s<=0&&this.width<=a&&this.height<=u){if(y)return!0;for(var E=0;E<this.boxKeys.length;E++)k.push({key:this.boxKeys[E],x1:this.bboxes[4*E],y1:this.bboxes[4*E+1],x2:this.bboxes[4*E+2],y2:this.bboxes[4*E+3]});for(var P=0;P<this.circleKeys.length;P++){var O=this.circles[3*P],Z=this.circles[3*P+1],G=this.circles[3*P+2];k.push({key:this.circleKeys[P],x1:O-G,y1:Z-G,x2:O+G,y2:Z+G})}return w?k.filter(w):k}return this._forEachCell(n,s,a,u,this._queryCell,k,{hitTest:y,seenUids:{box:{},circle:{}}},w),y?k.length>0:k},Qt.prototype._queryCircle=function(n,s,a,u,y){var w=n-a,k=n+a,E=s-a,P=s+a;if(k<0||w>this.width||P<0||E>this.height)return!u&&[];var O=[];return this._forEachCell(w,E,k,P,this._queryCellCircle,O,{hitTest:u,circle:{x:n,y:s,radius:a},seenUids:{box:{},circle:{}}},y),u?O.length>0:O},Qt.prototype.query=function(n,s,a,u,y){return this._query(n,s,a,u,!1,y)},Qt.prototype.hitTest=function(n,s,a,u,y){return this._query(n,s,a,u,!0,y)},Qt.prototype.hitTestCircle=function(n,s,a,u){return this._queryCircle(n,s,a,!0,u)},Qt.prototype._queryCell=function(n,s,a,u,y,w,k,E){var P=k.seenUids,O=this.boxCells[y];if(O!==null)for(var Z=this.bboxes,G=0,K=O;G<K.length;G+=1){var re=K[G];if(!P.box[re]){P.box[re]=!0;var te=4*re;if(n<=Z[te+2]&&s<=Z[te+3]&&a>=Z[te+0]&&u>=Z[te+1]&&(!E||E(this.boxKeys[re]))){if(k.hitTest)return w.push(!0),!0;w.push({key:this.boxKeys[re],x1:Z[te],y1:Z[te+1],x2:Z[te+2],y2:Z[te+3]})}}}var ue=this.circleCells[y];if(ue!==null)for(var Y=this.circles,le=0,fe=ue;le<fe.length;le+=1){var ge=fe[le];if(!P.circle[ge]){P.circle[ge]=!0;var ze=3*ge;if(this._circleAndRectCollide(Y[ze],Y[ze+1],Y[ze+2],n,s,a,u)&&(!E||E(this.circleKeys[ge]))){if(k.hitTest)return w.push(!0),!0;var Ee=Y[ze],Ae=Y[ze+1],De=Y[ze+2];w.push({key:this.circleKeys[ge],x1:Ee-De,y1:Ae-De,x2:Ee+De,y2:Ae+De})}}}},Qt.prototype._queryCellCircle=function(n,s,a,u,y,w,k,E){var P=k.circle,O=k.seenUids,Z=this.boxCells[y];if(Z!==null)for(var G=this.bboxes,K=0,re=Z;K<re.length;K+=1){var te=re[K];if(!O.box[te]){O.box[te]=!0;var ue=4*te;if(this._circleAndRectCollide(P.x,P.y,P.radius,G[ue+0],G[ue+1],G[ue+2],G[ue+3])&&(!E||E(this.boxKeys[te])))return w.push(!0),!0}}var Y=this.circleCells[y];if(Y!==null)for(var le=this.circles,fe=0,ge=Y;fe<ge.length;fe+=1){var ze=ge[fe];if(!O.circle[ze]){O.circle[ze]=!0;var Ee=3*ze;if(this._circlesCollide(le[Ee],le[Ee+1],le[Ee+2],P.x,P.y,P.radius)&&(!E||E(this.circleKeys[ze])))return w.push(!0),!0}}},Qt.prototype._forEachCell=function(n,s,a,u,y,w,k,E){for(var P=this._convertToXCellCoord(n),O=this._convertToYCellCoord(s),Z=this._convertToXCellCoord(a),G=this._convertToYCellCoord(u),K=P;K<=Z;K++)for(var re=O;re<=G;re++)if(y.call(this,n,s,a,u,this.xCellCount*re+K,w,k,E))return},Qt.prototype._convertToXCellCoord=function(n){return Math.max(0,Math.min(this.xCellCount-1,Math.floor(n*this.xScale)))},Qt.prototype._convertToYCellCoord=function(n){return Math.max(0,Math.min(this.yCellCount-1,Math.floor(n*this.yScale)))},Qt.prototype._circlesCollide=function(n,s,a,u,y,w){var k=u-n,E=y-s,P=a+w;return P*P>k*k+E*E},Qt.prototype._circleAndRectCollide=function(n,s,a,u,y,w,k){var E=(w-u)/2,P=Math.abs(n-(u+E));if(P>E+a)return!1;var O=(k-y)/2,Z=Math.abs(s-(y+O));if(Z>O+a)return!1;if(P<=E||Z<=O)return!0;var G=P-E,K=Z-O;return G*G+K*K<=a*a};var bo=new Float32Array([-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0]);function ki(n,s){for(var a=0;a<n;a++){var u=s.length;s.resize(u+4),s.float32.set(bo,3*u)}}function ai(n,s,a){var u=s[0],y=s[1];return n[0]=a[0]*u+a[4]*y+a[12],n[1]=a[1]*u+a[5]*y+a[13],n[3]=a[3]*u+a[7]*y+a[15],n}var ln=function(n,s,a){s===void 0&&(s=new Qt(n.width+200,n.height+200,25)),a===void 0&&(a=new Qt(n.width+200,n.height+200,25)),this.transform=n,this.grid=s,this.ignoredGrid=a,this.pitchfactor=Math.cos(n._pitch)*n.cameraToCenterDistance,this.screenRightBoundary=n.width+100,this.screenBottomBoundary=n.height+100,this.gridRightBoundary=n.width+200,this.gridBottomBoundary=n.height+200};function Lr(n,s,a){return s*(o.EXTENT/(n.tileSize*Math.pow(2,a-n.tileID.overscaledZ)))}ln.prototype.placeCollisionBox=function(n,s,a,u,y){var w=this.projectAndGetPerspectiveRatio(u,n.anchorPointX,n.anchorPointY),k=a*w.perspectiveRatio,E=n.x1*k+w.point.x,P=n.y1*k+w.point.y,O=n.x2*k+w.point.x,Z=n.y2*k+w.point.y;return!this.isInsideGrid(E,P,O,Z)||!s&&this.grid.hitTest(E,P,O,Z,y)?{box:[],offscreen:!1}:{box:[E,P,O,Z],offscreen:this.isOffscreen(E,P,O,Z)}},ln.prototype.placeCollisionCircles=function(n,s,a,u,y,w,k,E,P,O,Z,G,K){var re=[],te=new o.Point(s.anchorX,s.anchorY),ue=Gt(te,w),Y=tr(this.transform.cameraToCenterDistance,ue.signedDistanceFromCamera),le=(O?y/Y:y*Y)/o.ONE_EM,fe=Gt(te,k).point,ge=wr(le,u,s.lineOffsetX*le,s.lineOffsetY*le,!1,fe,te,s,a,k,{}),ze=!1,Ee=!1,Ae=!0;if(ge){for(var De=.5*G*Y+K,Ke=new o.Point(-100,-100),Ze=new o.Point(this.screenRightBoundary,this.screenBottomBoundary),nt=new ti,vt=ge.first,St=ge.last,wt=[],_r=vt.path.length-1;_r>=1;_r--)wt.push(vt.path[_r]);for(var at=1;at<St.path.length;at++)wt.push(St.path[at]);var Nt=2.5*De;if(E){var Jt=wt.map(function(ao){return Gt(ao,E)});wt=Jt.some(function(ao){return ao.signedDistanceFromCamera<=0})?[]:Jt.map(function(ao){return ao.point})}var Ot=[];if(wt.length>0){for(var Bt=wt[0].clone(),Wt=wt[0].clone(),Rt=1;Rt<wt.length;Rt++)Bt.x=Math.min(Bt.x,wt[Rt].x),Bt.y=Math.min(Bt.y,wt[Rt].y),Wt.x=Math.max(Wt.x,wt[Rt].x),Wt.y=Math.max(Wt.y,wt[Rt].y);Ot=Bt.x>=Ke.x&&Wt.x<=Ze.x&&Bt.y>=Ke.y&&Wt.y<=Ze.y?[wt]:Wt.x<Ke.x||Bt.x>Ze.x||Wt.y<Ke.y||Bt.y>Ze.y?[]:o.clipLine([wt],Ke.x,Ke.y,Ze.x,Ze.y)}for(var Ct=0,Di=Ot;Ct<Di.length;Ct+=1){var si;nt.reset(Di[Ct],.25*De),si=nt.length<=.5*De?1:Math.ceil(nt.paddedLength/Nt)+1;for(var cn=0;cn<si;cn++){var Gi=cn/Math.max(si-1,1),ri=nt.lerp(Gi),fi=ri.x+100,Gn=ri.y+100;re.push(fi,Gn,De,0);var wn=fi-De,ea=Gn-De,An=fi+De,go=Gn+De;if(Ae=Ae&&this.isOffscreen(wn,ea,An,go),Ee=Ee||this.isInsideGrid(wn,ea,An,go),!n&&this.grid.hitTestCircle(fi,Gn,De,Z)&&(ze=!0,!P))return{circles:[],offscreen:!1,collisionDetected:ze}}}}return{circles:!P&&ze||!Ee?[]:re,offscreen:Ae,collisionDetected:ze}},ln.prototype.queryRenderedSymbols=function(n){if(n.length===0||this.grid.keysLength()===0&&this.ignoredGrid.keysLength()===0)return{};for(var s=[],a=1/0,u=1/0,y=-1/0,w=-1/0,k=0,E=n;k<E.length;k+=1){var P=E[k],O=new o.Point(P.x+100,P.y+100);a=Math.min(a,O.x),u=Math.min(u,O.y),y=Math.max(y,O.x),w=Math.max(w,O.y),s.push(O)}for(var Z={},G={},K=0,re=this.grid.query(a,u,y,w).concat(this.ignoredGrid.query(a,u,y,w));K<re.length;K+=1){var te=re[K],ue=te.key;if(Z[ue.bucketInstanceId]===void 0&&(Z[ue.bucketInstanceId]={}),!Z[ue.bucketInstanceId][ue.featureIndex]){var Y=[new o.Point(te.x1,te.y1),new o.Point(te.x2,te.y1),new o.Point(te.x2,te.y2),new o.Point(te.x1,te.y2)];o.polygonIntersectsPolygon(s,Y)&&(Z[ue.bucketInstanceId][ue.featureIndex]=!0,G[ue.bucketInstanceId]===void 0&&(G[ue.bucketInstanceId]=[]),G[ue.bucketInstanceId].push(ue.featureIndex))}}return G},ln.prototype.insertCollisionBox=function(n,s,a,u,y){(s?this.ignoredGrid:this.grid).insert({bucketInstanceId:a,featureIndex:u,collisionGroupID:y},n[0],n[1],n[2],n[3])},ln.prototype.insertCollisionCircles=function(n,s,a,u,y){for(var w=s?this.ignoredGrid:this.grid,k={bucketInstanceId:a,featureIndex:u,collisionGroupID:y},E=0;E<n.length;E+=4)w.insertCircle(k,n[E],n[E+1],n[E+2])},ln.prototype.projectAndGetPerspectiveRatio=function(n,s,a){var u=[s,a,0,1];return ai(u,u,n),{point:new o.Point((u[0]/u[3]+1)/2*this.transform.width+100,(-u[1]/u[3]+1)/2*this.transform.height+100),perspectiveRatio:.5+this.transform.cameraToCenterDistance/u[3]*.5}},ln.prototype.isOffscreen=function(n,s,a,u){return a<100||n>=this.screenRightBoundary||u<100||s>this.screenBottomBoundary},ln.prototype.isInsideGrid=function(n,s,a,u){return a>=0&&n<this.gridRightBoundary&&u>=0&&s<this.gridBottomBoundary},ln.prototype.getViewportMatrix=function(){var n=o.identity([]);return o.translate(n,n,[-100,-100,0]),n};var On=function(n,s,a,u){this.opacity=n?Math.max(0,Math.min(1,n.opacity+(n.placed?s:-s))):u&&a?1:0,this.placed=a};On.prototype.isHidden=function(){return this.opacity===0&&!this.placed};var vn=function(n,s,a,u,y){this.text=new On(n?n.text:null,s,a,y),this.icon=new On(n?n.icon:null,s,u,y)};vn.prototype.isHidden=function(){return this.text.isHidden()&&this.icon.isHidden()};var is=function(n,s,a){this.text=n,this.icon=s,this.skipFade=a},Si=function(){this.invProjMatrix=o.create(),this.viewportMatrix=o.create(),this.circles=[]},xo=function(n,s,a,u,y){this.bucketInstanceId=n,this.featureIndex=s,this.sourceLayerIndex=a,this.bucketIndex=u,this.tileID=y},Vi=function(n){this.crossSourceCollisions=n,this.maxGroupID=0,this.collisionGroups={}};function Ei(n,s,a,u,y){var w=o.getAnchorAlignment(n),k=-(w.horizontalAlign-.5)*s,E=-(w.verticalAlign-.5)*a,P=o.evaluateVariableOffset(n,u);return new o.Point(k+P[0]*y,E+P[1]*y)}function Jn(n,s,a,u,y,w){var k=n.x1,E=n.x2,P=n.y1,O=n.y2,Z=n.anchorPointX,G=n.anchorPointY,K=new o.Point(s,a);return u&&K._rotate(y?w:-w),{x1:k+K.x,y1:P+K.y,x2:E+K.x,y2:O+K.y,anchorPointX:Z,anchorPointY:G}}Vi.prototype.get=function(n){if(this.crossSourceCollisions)return{ID:0,predicate:null};if(!this.collisionGroups[n]){var s=++this.maxGroupID;this.collisionGroups[n]={ID:s,predicate:function(a){return a.collisionGroupID===s}}}return this.collisionGroups[n]};var ji=function(n,s,a,u){this.transform=n.clone(),this.collisionIndex=new ln(this.transform),this.placements={},this.opacities={},this.variableOffsets={},this.stale=!1,this.commitTime=0,this.fadeDuration=s,this.retainedQueryData={},this.collisionGroups=new Vi(a),this.collisionCircleArrays={},this.prevPlacement=u,u&&(u.prevPlacement=void 0),this.placedOrientations={}};function wo(n,s,a,u,y){n.emplaceBack(s?1:0,a?1:0,u||0,y||0),n.emplaceBack(s?1:0,a?1:0,u||0,y||0),n.emplaceBack(s?1:0,a?1:0,u||0,y||0),n.emplaceBack(s?1:0,a?1:0,u||0,y||0)}ji.prototype.getBucketParts=function(n,s,a,u){var y=a.getBucket(s),w=a.latestFeatureIndex;if(y&&w&&s.id===y.layerIds[0]){var k=a.collisionBoxArray,E=y.layers[0].layout,P=Math.pow(2,this.transform.zoom-a.tileID.overscaledZ),O=a.tileSize/o.EXTENT,Z=this.transform.calculatePosMatrix(a.tileID.toUnwrapped()),G=E.get("text-pitch-alignment")==="map",K=E.get("text-rotation-alignment")==="map",re=Lr(a,1,this.transform.zoom),te=vr(Z,G,K,this.transform,re),ue=null;if(G){var Y=dr(Z,G,K,this.transform,re);ue=o.multiply([],this.transform.labelPlaneMatrix,Y)}this.retainedQueryData[y.bucketInstanceId]=new xo(y.bucketInstanceId,w,y.sourceLayerIndex,y.index,a.tileID);var le={bucket:y,layout:E,posMatrix:Z,textLabelPlaneMatrix:te,labelToScreenMatrix:ue,scale:P,textPixelRatio:O,holdingForFade:a.holdingForFade(),collisionBoxArray:k,partiallyEvaluatedTextSize:o.evaluateSizeForZoom(y.textSizeData,this.transform.zoom),collisionGroup:this.collisionGroups.get(y.sourceID)};if(u)for(var fe=0,ge=y.sortKeyRanges;fe<ge.length;fe+=1){var ze=ge[fe];n.push({sortKey:ze.sortKey,symbolInstanceStart:ze.symbolInstanceStart,symbolInstanceEnd:ze.symbolInstanceEnd,parameters:le})}else n.push({symbolInstanceStart:0,symbolInstanceEnd:y.symbolInstances.length,parameters:le})}},ji.prototype.attemptAnchorPlacement=function(n,s,a,u,y,w,k,E,P,O,Z,G,K,re,te){var ue,Y=[G.textOffset0,G.textOffset1],le=Ei(n,a,u,Y,y),fe=this.collisionIndex.placeCollisionBox(Jn(s,le.x,le.y,w,k,this.transform.angle),Z,E,P,O.predicate);if(!te||this.collisionIndex.placeCollisionBox(Jn(te,le.x,le.y,w,k,this.transform.angle),Z,E,P,O.predicate).box.length!==0)return fe.box.length>0?(this.prevPlacement&&this.prevPlacement.variableOffsets[G.crossTileID]&&this.prevPlacement.placements[G.crossTileID]&&this.prevPlacement.placements[G.crossTileID].text&&(ue=this.prevPlacement.variableOffsets[G.crossTileID].anchor),this.variableOffsets[G.crossTileID]={textOffset:Y,width:a,height:u,anchor:n,textBoxScale:y,prevAnchor:ue},this.markUsedJustification(K,n,G,re),K.allowVerticalPlacement&&(this.markUsedOrientation(K,re,G),this.placedOrientations[G.crossTileID]=re),{shift:le,placedGlyphBoxes:fe}):void 0},ji.prototype.placeLayerBucketPart=function(n,s,a){var u=this,y=n.parameters,w=y.bucket,k=y.layout,E=y.posMatrix,P=y.textLabelPlaneMatrix,O=y.labelToScreenMatrix,Z=y.textPixelRatio,G=y.holdingForFade,K=y.collisionBoxArray,re=y.partiallyEvaluatedTextSize,te=y.collisionGroup,ue=k.get("text-optional"),Y=k.get("icon-optional"),le=k.get("text-allow-overlap"),fe=k.get("icon-allow-overlap"),ge=k.get("text-rotation-alignment")==="map",ze=k.get("text-pitch-alignment")==="map",Ee=k.get("icon-text-fit")!=="none",Ae=k.get("symbol-z-order")==="viewport-y",De=le&&(fe||!w.hasIconData()||Y),Ke=fe&&(le||!w.hasTextData()||ue);!w.collisionArrays&&K&&w.deserializeCollisionBoxes(K);var Ze=function(at,Nt){if(!s[at.crossTileID])if(G)u.placements[at.crossTileID]=new is(!1,!1,!1);else{var Jt,Ot=!1,Bt=!1,Wt=!0,Rt=null,Ct={box:null,offscreen:null},Di={box:null,offscreen:null},si=null,cn=null,Gi=0,ri=0,fi=0;Nt.textFeatureIndex?Gi=Nt.textFeatureIndex:at.useRuntimeCollisionCircles&&(Gi=at.featureIndex),Nt.verticalTextFeatureIndex&&(ri=Nt.verticalTextFeatureIndex);var Gn=Nt.textBox;if(Gn){var wn=function(Er){var $n=o.WritingMode.horizontal;if(w.allowVerticalPlacement&&!Er&&u.prevPlacement){var Pn=u.prevPlacement.placedOrientations[at.crossTileID];Pn&&(u.placedOrientations[at.crossTileID]=Pn,u.markUsedOrientation(w,$n=Pn,at))}return $n},ea=function(Er,$n){if(w.allowVerticalPlacement&&at.numVerticalGlyphVertices>0&&Nt.verticalTextBox)for(var Pn=0,Aa=w.writingModes;Pn<Aa.length&&(Aa[Pn]===o.WritingMode.vertical?(Ct=$n(),Di=Ct):Ct=Er(),!(Ct&&Ct.box&&Ct.box.length));Pn+=1);else Ct=Er()};if(k.get("text-variable-anchor")){var An=k.get("text-variable-anchor");if(u.prevPlacement&&u.prevPlacement.variableOffsets[at.crossTileID]){var go=u.prevPlacement.variableOffsets[at.crossTileID];An.indexOf(go.anchor)>0&&(An=An.filter(function(Er){return Er!==go.anchor})).unshift(go.anchor)}var ao=function(Er,$n,Pn){for(var Aa=Er.x2-Er.x1,Kh=Er.y2-Er.y1,rl=at.textBoxScale,Xh=Ee&&!fe?$n:null,Es={box:[],offscreen:!1},Tc=le?2*An.length:An.length,Ja=0;Ja<Tc;++Ja){var il=u.attemptAnchorPlacement(An[Ja%An.length],Er,Aa,Kh,rl,ge,ze,Z,E,te,Ja>=An.length,at,w,Pn,Xh);if(il&&(Es=il.placedGlyphBoxes)&&Es.box&&Es.box.length){Ot=!0,Rt=il.shift;break}}return Es};ea(function(){return ao(Gn,Nt.iconBox,o.WritingMode.horizontal)},function(){var Er=Nt.verticalTextBox;return w.allowVerticalPlacement&&!(Ct&&Ct.box&&Ct.box.length)&&at.numVerticalGlyphVertices>0&&Er?ao(Er,Nt.verticalIconBox,o.WritingMode.vertical):{box:null,offscreen:null}}),Ct&&(Ot=Ct.box,Wt=Ct.offscreen);var ws=wn(Ct&&Ct.box);if(!Ot&&u.prevPlacement){var Wa=u.prevPlacement.variableOffsets[at.crossTileID];Wa&&(u.variableOffsets[at.crossTileID]=Wa,u.markUsedJustification(w,Wa.anchor,at,ws))}}else{var ta=function(Er,$n){var Pn=u.collisionIndex.placeCollisionBox(Er,le,Z,E,te.predicate);return Pn&&Pn.box&&Pn.box.length&&(u.markUsedOrientation(w,$n,at),u.placedOrientations[at.crossTileID]=$n),Pn};ea(function(){return ta(Gn,o.WritingMode.horizontal)},function(){var Er=Nt.verticalTextBox;return w.allowVerticalPlacement&&at.numVerticalGlyphVertices>0&&Er?ta(Er,o.WritingMode.vertical):{box:null,offscreen:null}}),wn(Ct&&Ct.box&&Ct.box.length)}}if(Ot=(Jt=Ct)&&Jt.box&&Jt.box.length>0,Wt=Jt&&Jt.offscreen,at.useRuntimeCollisionCircles){var Ha=w.text.placedSymbolArray.get(at.centerJustifiedTextSymbolIndex),ks=o.evaluateSizeForFeature(w.textSizeData,re,Ha),zo=k.get("text-padding");si=u.collisionIndex.placeCollisionCircles(le,Ha,w.lineVertexArray,w.glyphOffsetArray,ks,E,P,O,a,ze,te.predicate,at.collisionCircleDiameter,zo),Ot=le||si.circles.length>0&&!si.collisionDetected,Wt=Wt&&si.offscreen}if(Nt.iconFeatureIndex&&(fi=Nt.iconFeatureIndex),Nt.iconBox){var Ss=function(Er){var $n=Ee&&Rt?Jn(Er,Rt.x,Rt.y,ge,ze,u.transform.angle):Er;return u.collisionIndex.placeCollisionBox($n,fe,Z,E,te.predicate)};Bt=Di&&Di.box&&Di.box.length&&Nt.verticalIconBox?(cn=Ss(Nt.verticalIconBox)).box.length>0:(cn=Ss(Nt.iconBox)).box.length>0,Wt=Wt&&cn.offscreen}var Ao=ue||at.numHorizontalGlyphVertices===0&&at.numVerticalGlyphVertices===0,Li=Y||at.numIconVertices===0;if(Ao||Li?Li?Ao||(Bt=Bt&&Ot):Ot=Bt&&Ot:Bt=Ot=Bt&&Ot,Ot&&Jt&&Jt.box&&u.collisionIndex.insertCollisionBox(Jt.box,k.get("text-ignore-placement"),w.bucketInstanceId,Di&&Di.box&&ri?ri:Gi,te.ID),Bt&&cn&&u.collisionIndex.insertCollisionBox(cn.box,k.get("icon-ignore-placement"),w.bucketInstanceId,fi,te.ID),si&&(Ot&&u.collisionIndex.insertCollisionCircles(si.circles,k.get("text-ignore-placement"),w.bucketInstanceId,Gi,te.ID),a)){var Ro=w.bucketInstanceId,ra=u.collisionCircleArrays[Ro];ra===void 0&&(ra=u.collisionCircleArrays[Ro]=new Si);for(var za=0;za<si.circles.length;za+=4)ra.circles.push(si.circles[za+0]),ra.circles.push(si.circles[za+1]),ra.circles.push(si.circles[za+2]),ra.circles.push(si.collisionDetected?1:0)}u.placements[at.crossTileID]=new is(Ot||De,Bt||Ke,Wt||w.justReloaded),s[at.crossTileID]=!0}};if(Ae)for(var nt=w.getSortedSymbolIndexes(this.transform.angle),vt=nt.length-1;vt>=0;--vt){var St=nt[vt];Ze(w.symbolInstances.get(St),w.collisionArrays[St])}else for(var wt=n.symbolInstanceStart;wt<n.symbolInstanceEnd;wt++)Ze(w.symbolInstances.get(wt),w.collisionArrays[wt]);if(a&&w.bucketInstanceId in this.collisionCircleArrays){var _r=this.collisionCircleArrays[w.bucketInstanceId];o.invert(_r.invProjMatrix,E),_r.viewportMatrix=this.collisionIndex.getViewportMatrix()}w.justReloaded=!1},ji.prototype.markUsedJustification=function(n,s,a,u){var y;y=u===o.WritingMode.vertical?a.verticalPlacedTextSymbolIndex:{left:a.leftJustifiedTextSymbolIndex,center:a.centerJustifiedTextSymbolIndex,right:a.rightJustifiedTextSymbolIndex}[o.getAnchorJustification(s)];for(var w=0,k=[a.leftJustifiedTextSymbolIndex,a.centerJustifiedTextSymbolIndex,a.rightJustifiedTextSymbolIndex,a.verticalPlacedTextSymbolIndex];w<k.length;w+=1){var E=k[w];E>=0&&(n.text.placedSymbolArray.get(E).crossTileID=y>=0&&E!==y?0:a.crossTileID)}},ji.prototype.markUsedOrientation=function(n,s,a){for(var u=s===o.WritingMode.horizontal||s===o.WritingMode.horizontalOnly?s:0,y=s===o.WritingMode.vertical?s:0,w=0,k=[a.leftJustifiedTextSymbolIndex,a.centerJustifiedTextSymbolIndex,a.rightJustifiedTextSymbolIndex];w<k.length;w+=1)n.text.placedSymbolArray.get(k[w]).placedOrientation=u;a.verticalPlacedTextSymbolIndex&&(n.text.placedSymbolArray.get(a.verticalPlacedTextSymbolIndex).placedOrientation=y)},ji.prototype.commit=function(n){this.commitTime=n,this.zoomAtLastRecencyCheck=this.transform.zoom;var s=this.prevPlacement,a=!1;this.prevZoomAdjustment=s?s.zoomAdjustment(this.transform.zoom):0;var u=s?s.symbolFadeChange(n):1,y=s?s.opacities:{},w=s?s.variableOffsets:{},k=s?s.placedOrientations:{};for(var E in this.placements){var P=this.placements[E],O=y[E];O?(this.opacities[E]=new vn(O,u,P.text,P.icon),a=a||P.text!==O.text.placed||P.icon!==O.icon.placed):(this.opacities[E]=new vn(null,u,P.text,P.icon,P.skipFade),a=a||P.text||P.icon)}for(var Z in y){var G=y[Z];if(!this.opacities[Z]){var K=new vn(G,u,!1,!1);K.isHidden()||(this.opacities[Z]=K,a=a||G.text.placed||G.icon.placed)}}for(var re in w)this.variableOffsets[re]||!this.opacities[re]||this.opacities[re].isHidden()||(this.variableOffsets[re]=w[re]);for(var te in k)this.placedOrientations[te]||!this.opacities[te]||this.opacities[te].isHidden()||(this.placedOrientations[te]=k[te]);a?this.lastPlacementChangeTime=n:typeof this.lastPlacementChangeTime!="number"&&(this.lastPlacementChangeTime=s?s.lastPlacementChangeTime:n)},ji.prototype.updateLayerOpacities=function(n,s){for(var a={},u=0,y=s;u<y.length;u+=1){var w=y[u],k=w.getBucket(n);k&&w.latestFeatureIndex&&n.id===k.layerIds[0]&&this.updateBucketOpacities(k,a,w.collisionBoxArray)}},ji.prototype.updateBucketOpacities=function(n,s,a){var u=this;n.hasTextData()&&n.text.opacityVertexArray.clear(),n.hasIconData()&&n.icon.opacityVertexArray.clear(),n.hasIconCollisionBoxData()&&n.iconCollisionBox.collisionVertexArray.clear(),n.hasTextCollisionBoxData()&&n.textCollisionBox.collisionVertexArray.clear();var y=n.layers[0].layout,w=new vn(null,0,!1,!1,!0),k=y.get("text-allow-overlap"),E=y.get("icon-allow-overlap"),P=y.get("text-variable-anchor"),O=y.get("text-rotation-alignment")==="map",Z=y.get("text-pitch-alignment")==="map",G=y.get("icon-text-fit")!=="none",K=new vn(null,0,k&&(E||!n.hasIconData()||y.get("icon-optional")),E&&(k||!n.hasTextData()||y.get("text-optional")),!0);!n.collisionArrays&&a&&(n.hasIconCollisionBoxData()||n.hasTextCollisionBoxData())&&n.deserializeCollisionBoxes(a);for(var re=function(le,fe,ge){for(var ze=0;ze<fe/4;ze++)le.opacityVertexArray.emplaceBack(ge)},te=function(le){var fe=n.symbolInstances.get(le),ge=fe.numHorizontalGlyphVertices,ze=fe.numVerticalGlyphVertices,Ee=fe.crossTileID,Ae=u.opacities[Ee];s[Ee]?Ae=w:Ae||(u.opacities[Ee]=Ae=K),s[Ee]=!0;var De=fe.numIconVertices>0,Ke=u.placedOrientations[fe.crossTileID],Ze=Ke===o.WritingMode.vertical,nt=Ke===o.WritingMode.horizontal||Ke===o.WritingMode.horizontalOnly;if(ge>0||ze>0){var vt=Bs(Ae.text);re(n.text,ge,Ze?jo:vt),re(n.text,ze,nt?jo:vt);var St=Ae.text.isHidden();[fe.rightJustifiedTextSymbolIndex,fe.centerJustifiedTextSymbolIndex,fe.leftJustifiedTextSymbolIndex].forEach(function(Ct){Ct>=0&&(n.text.placedSymbolArray.get(Ct).hidden=St||Ze?1:0)}),fe.verticalPlacedTextSymbolIndex>=0&&(n.text.placedSymbolArray.get(fe.verticalPlacedTextSymbolIndex).hidden=St||nt?1:0);var wt=u.variableOffsets[fe.crossTileID];wt&&u.markUsedJustification(n,wt.anchor,fe,Ke);var _r=u.placedOrientations[fe.crossTileID];_r&&(u.markUsedJustification(n,"left",fe,_r),u.markUsedOrientation(n,_r,fe))}if(De){var at=Bs(Ae.icon),Nt=!(G&&fe.verticalPlacedIconSymbolIndex&&Ze);fe.placedIconSymbolIndex>=0&&(re(n.icon,fe.numIconVertices,Nt?at:jo),n.icon.placedSymbolArray.get(fe.placedIconSymbolIndex).hidden=Ae.icon.isHidden()),fe.verticalPlacedIconSymbolIndex>=0&&(re(n.icon,fe.numVerticalIconVertices,Nt?jo:at),n.icon.placedSymbolArray.get(fe.verticalPlacedIconSymbolIndex).hidden=Ae.icon.isHidden())}if(n.hasIconCollisionBoxData()||n.hasTextCollisionBoxData()){var Jt=n.collisionArrays[le];if(Jt){var Ot=new o.Point(0,0);if(Jt.textBox||Jt.verticalTextBox){var Bt=!0;if(P){var Wt=u.variableOffsets[Ee];Wt?(Ot=Ei(Wt.anchor,Wt.width,Wt.height,Wt.textOffset,Wt.textBoxScale),O&&Ot._rotate(Z?u.transform.angle:-u.transform.angle)):Bt=!1}Jt.textBox&&wo(n.textCollisionBox.collisionVertexArray,Ae.text.placed,!Bt||Ze,Ot.x,Ot.y),Jt.verticalTextBox&&wo(n.textCollisionBox.collisionVertexArray,Ae.text.placed,!Bt||nt,Ot.x,Ot.y)}var Rt=!!(!nt&&Jt.verticalIconBox);Jt.iconBox&&wo(n.iconCollisionBox.collisionVertexArray,Ae.icon.placed,Rt,G?Ot.x:0,G?Ot.y:0),Jt.verticalIconBox&&wo(n.iconCollisionBox.collisionVertexArray,Ae.icon.placed,!Rt,G?Ot.x:0,G?Ot.y:0)}}},ue=0;ue<n.symbolInstances.length;ue++)te(ue);if(n.sortFeatures(this.transform.angle),this.retainedQueryData[n.bucketInstanceId]&&(this.retainedQueryData[n.bucketInstanceId].featureSortOrder=n.featureSortOrder),n.hasTextData()&&n.text.opacityVertexBuffer&&n.text.opacityVertexBuffer.updateData(n.text.opacityVertexArray),n.hasIconData()&&n.icon.opacityVertexBuffer&&n.icon.opacityVertexBuffer.updateData(n.icon.opacityVertexArray),n.hasIconCollisionBoxData()&&n.iconCollisionBox.collisionVertexBuffer&&n.iconCollisionBox.collisionVertexBuffer.updateData(n.iconCollisionBox.collisionVertexArray),n.hasTextCollisionBoxData()&&n.textCollisionBox.collisionVertexBuffer&&n.textCollisionBox.collisionVertexBuffer.updateData(n.textCollisionBox.collisionVertexArray),n.bucketInstanceId in this.collisionCircleArrays){var Y=this.collisionCircleArrays[n.bucketInstanceId];n.placementInvProjMatrix=Y.invProjMatrix,n.placementViewportMatrix=Y.viewportMatrix,n.collisionCircleArray=Y.circles,delete this.collisionCircleArrays[n.bucketInstanceId]}},ji.prototype.symbolFadeChange=function(n){return this.fadeDuration===0?1:(n-this.commitTime)/this.fadeDuration+this.prevZoomAdjustment},ji.prototype.zoomAdjustment=function(n){return Math.max(0,(this.transform.zoom-n)/1.5)},ji.prototype.hasTransitions=function(n){return this.stale||n-this.lastPlacementChangeTime<this.fadeDuration},ji.prototype.stillRecent=function(n,s){var a=this.zoomAtLastRecencyCheck===s?1-this.zoomAdjustment(s):1;return this.zoomAtLastRecencyCheck=s,this.commitTime+this.fadeDuration*a>n},ji.prototype.setStale=function(){this.stale=!0};var ns=Math.pow(2,25),Ll=Math.pow(2,24),ha=Math.pow(2,17),Rl=Math.pow(2,16),Ba=Math.pow(2,9),Bl=Math.pow(2,8),Oa=Math.pow(2,1);function Bs(n){if(n.opacity===0&&!n.placed)return 0;if(n.opacity===1&&n.placed)return 4294967295;var s=n.placed?1:0,a=Math.floor(127*n.opacity);return a*ns+s*Ll+a*ha+s*Rl+a*Ba+s*Bl+a*Oa+s}var jo=0,os=function(n){this._sortAcrossTiles=n.layout.get("symbol-z-order")!=="viewport-y"&&n.layout.get("symbol-sort-key").constantOr(1)!==void 0,this._currentTileIndex=0,this._currentPartIndex=0,this._seenCrossTileIDs={},this._bucketParts=[]};os.prototype.continuePlacement=function(n,s,a,u,y){for(var w=this._bucketParts;this._currentTileIndex<n.length;)if(s.getBucketParts(w,u,n[this._currentTileIndex],this._sortAcrossTiles),this._currentTileIndex++,y())return!0;for(this._sortAcrossTiles&&(this._sortAcrossTiles=!1,w.sort(function(k,E){return k.sortKey-E.sortKey}));this._currentPartIndex<w.length;)if(s.placeLayerBucketPart(w[this._currentPartIndex],this._seenCrossTileIDs,a),this._currentPartIndex++,y())return!0;return!1};var pa=function(n,s,a,u,y,w,k){this.placement=new ji(n,y,w,k),this._currentPlacementIndex=s.length-1,this._forceFullPlacement=a,this._showCollisionBoxes=u,this._done=!1};pa.prototype.isDone=function(){return this._done},pa.prototype.continuePlacement=function(n,s,a){for(var u=this,y=o.browser.now(),w=function(){var P=o.browser.now()-y;return!u._forceFullPlacement&&P>2};this._currentPlacementIndex>=0;){var k=s[n[this._currentPlacementIndex]],E=this.placement.collisionIndex.transform.zoom;if(k.type==="symbol"&&(!k.minzoom||k.minzoom<=E)&&(!k.maxzoom||k.maxzoom>E)){if(this._inProgressLayer||(this._inProgressLayer=new os(k)),this._inProgressLayer.continuePlacement(a[k.source],this.placement,this._showCollisionBoxes,k,w))return;delete this._inProgressLayer}this._currentPlacementIndex--}this._done=!0},pa.prototype.commit=function(n){return this.placement.commit(n),this.placement};var Os=512/o.EXTENT/2,qo=function(n,s,a){this.tileID=n,this.indexedSymbolInstances={},this.bucketInstanceId=a;for(var u=0;u<s.length;u++){var y=s.get(u),w=y.key;this.indexedSymbolInstances[w]||(this.indexedSymbolInstances[w]=[]),this.indexedSymbolInstances[w].push({crossTileID:y.crossTileID,coord:this.getScaledCoordinates(y,n)})}};qo.prototype.getScaledCoordinates=function(n,s){var a=Os/Math.pow(2,s.canonical.z-this.tileID.canonical.z);return{x:Math.floor((s.canonical.x*o.EXTENT+n.anchorX)*a),y:Math.floor((s.canonical.y*o.EXTENT+n.anchorY)*a)}},qo.prototype.findMatches=function(n,s,a){for(var u=this.tileID.canonical.z<s.canonical.z?1:Math.pow(2,this.tileID.canonical.z-s.canonical.z),y=0;y<n.length;y++){var w=n.get(y);if(!w.crossTileID){var k=this.indexedSymbolInstances[w.key];if(k)for(var E=this.getScaledCoordinates(w,s),P=0,O=k;P<O.length;P+=1){var Z=O[P];if(Math.abs(Z.coord.x-E.x)<=u&&Math.abs(Z.coord.y-E.y)<=u&&!a[Z.crossTileID]){a[Z.crossTileID]=!0,w.crossTileID=Z.crossTileID;break}}}}};var Fn=function(){this.maxCrossTileID=0};Fn.prototype.generate=function(){return++this.maxCrossTileID};var ko=function(){this.indexes={},this.usedCrossTileIDs={},this.lng=0};ko.prototype.handleWrapJump=function(n){var s=Math.round((n-this.lng)/360);if(s!==0)for(var a in this.indexes){var u=this.indexes[a],y={};for(var w in u){var k=u[w];k.tileID=k.tileID.unwrapTo(k.tileID.wrap+s),y[k.tileID.key]=k}this.indexes[a]=y}this.lng=n},ko.prototype.addBucket=function(n,s,a){if(this.indexes[n.overscaledZ]&&this.indexes[n.overscaledZ][n.key]){if(this.indexes[n.overscaledZ][n.key].bucketInstanceId===s.bucketInstanceId)return!1;this.removeBucketCrossTileIDs(n.overscaledZ,this.indexes[n.overscaledZ][n.key])}for(var u=0;u<s.symbolInstances.length;u++)s.symbolInstances.get(u).crossTileID=0;this.usedCrossTileIDs[n.overscaledZ]||(this.usedCrossTileIDs[n.overscaledZ]={});var y=this.usedCrossTileIDs[n.overscaledZ];for(var w in this.indexes){var k=this.indexes[w];if(Number(w)>n.overscaledZ)for(var E in k){var P=k[E];P.tileID.isChildOf(n)&&P.findMatches(s.symbolInstances,n,y)}else{var O=k[n.scaledTo(Number(w)).key];O&&O.findMatches(s.symbolInstances,n,y)}}for(var Z=0;Z<s.symbolInstances.length;Z++){var G=s.symbolInstances.get(Z);G.crossTileID||(G.crossTileID=a.generate(),y[G.crossTileID]=!0)}return this.indexes[n.overscaledZ]===void 0&&(this.indexes[n.overscaledZ]={}),this.indexes[n.overscaledZ][n.key]=new qo(n,s.symbolInstances,s.bucketInstanceId),!0},ko.prototype.removeBucketCrossTileIDs=function(n,s){for(var a in s.indexedSymbolInstances)for(var u=0,y=s.indexedSymbolInstances[a];u<y.length;u+=1)delete this.usedCrossTileIDs[n][y[u].crossTileID]},ko.prototype.removeStaleBuckets=function(n){var s=!1;for(var a in this.indexes){var u=this.indexes[a];for(var y in u)n[u[y].bucketInstanceId]||(this.removeBucketCrossTileIDs(a,u[y]),delete u[y],s=!0)}return s};var ye=function(){this.layerIndexes={},this.crossTileIDs=new Fn,this.maxBucketInstanceId=0,this.bucketsInCurrentPlacement={}};ye.prototype.addLayer=function(n,s,a){var u=this.layerIndexes[n.id];u===void 0&&(u=this.layerIndexes[n.id]=new ko);var y=!1,w={};u.handleWrapJump(a);for(var k=0,E=s;k<E.length;k+=1){var P=E[k],O=P.getBucket(n);O&&n.id===O.layerIds[0]&&(O.bucketInstanceId||(O.bucketInstanceId=++this.maxBucketInstanceId),u.addBucket(P.tileID,O,this.crossTileIDs)&&(y=!0),w[O.bucketInstanceId]=!0)}return u.removeStaleBuckets(w)&&(y=!0),y},ye.prototype.pruneUnusedLayers=function(n){var s={};for(var a in n.forEach(function(u){s[u]=!0}),this.layerIndexes)s[a]||delete this.layerIndexes[a]};var un=function(n,s){return o.emitValidationErrors(n,s&&s.filter(function(a){return a.identifier!=="source.canvas"}))},qi=o.pick(je,["addLayer","removeLayer","setPaintProperty","setLayoutProperty","setFilter","addSource","removeSource","setLayerZoomRange","setLight","setTransition","setGeoJSONSourceData"]),Gr=o.pick(je,["setCenter","setZoom","setBearing","setPitch"]),So=function(){var n={},s=o.styleSpec.$version;for(var a in o.styleSpec.$root){var u,y=o.styleSpec.$root[a];y.required&&(u=a==="version"?s:y.type==="array"?[]:{})!=null&&(n[a]=u)}return n}(),Nn=function(n){function s(a,u){var y=this;u===void 0&&(u={}),n.call(this),this.map=a,this.dispatcher=new zt(Se(),this),this.imageManager=new xe,this.imageManager.setEventedParent(this),this.glyphManager=new jt(a._requestManager,u.localIdeographFontFamily),this.lineAtlas=new yt(256,512),this.crossTileSymbolIndex=new ye,this._layers={},this._serializedLayers={},this._order=[],this.sourceCaches={},this.zoomHistory=new o.ZoomHistory,this._loaded=!1,this._availableImages=[],this._resetUpdates(),this.dispatcher.broadcast("setReferrer",o.getReferrer());var w=this;this._rtlTextPluginCallback=s.registerForPluginStateChange(function(k){w.dispatcher.broadcast("syncRTLPluginState",{pluginStatus:k.pluginStatus,pluginURL:k.pluginURL},function(E,P){if(o.triggerPluginCompletionEvent(E),P&&P.every(function(Z){return Z}))for(var O in w.sourceCaches)w.sourceCaches[O].reload()})}),this.on("data",function(k){if(k.dataType==="source"&&k.sourceDataType==="metadata"){var E=y.sourceCaches[k.sourceId];if(E){var P=E.getSource();if(P&&P.vectorLayerIds)for(var O in y._layers){var Z=y._layers[O];Z.source===P.id&&y._validateLayer(Z)}}}})}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype.loadURL=function(a,u){var y=this;u===void 0&&(u={}),this.fire(new o.Event("dataloading",{dataType:"style"}));var w=typeof u.validate=="boolean"?u.validate:!o.isMapboxURL(a);a=this.map._requestManager.normalizeStyleURL(a,u.accessToken);var k=this.map._requestManager.transformRequest(a,o.ResourceType.Style);this._request=o.getJSON(k,function(E,P){y._request=null,E?y.fire(new o.ErrorEvent(E)):P&&y._load(P,w)})},s.prototype.loadJSON=function(a,u){var y=this;u===void 0&&(u={}),this.fire(new o.Event("dataloading",{dataType:"style"})),this._request=o.browser.frame(function(){y._request=null,y._load(a,u.validate!==!1)})},s.prototype.loadEmpty=function(){this.fire(new o.Event("dataloading",{dataType:"style"})),this._load(So,!1)},s.prototype._load=function(a,u){if(!u||!un(this,o.validateStyle(a))){for(var y in this._loaded=!0,this.stylesheet=a,a.sources)this.addSource(y,a.sources[y],{validate:!1});a.sprite?this._loadSprite(a.sprite):this.imageManager.setLoaded(!0),this.glyphManager.setURL(a.glyphs);var w=Oe(this.stylesheet.layers);this._order=w.map(function(O){return O.id}),this._layers={},this._serializedLayers={};for(var k=0,E=w;k<E.length;k+=1){var P=E[k];(P=o.createStyleLayer(P)).setEventedParent(this,{layer:{id:P.id}}),this._layers[P.id]=P,this._serializedLayers[P.id]=P.serialize()}this.dispatcher.broadcast("setLayers",this._serializeLayers(this._order)),this.light=new Ft(this.stylesheet.light),this.fire(new o.Event("data",{dataType:"style"})),this.fire(new o.Event("style.load"))}},s.prototype._loadSprite=function(a){var u=this;this._spriteRequest=function(y,w,k){var E,P,O,Z=o.browser.devicePixelRatio>1?"@2x":"",G=o.getJSON(w.transformRequest(w.normalizeSpriteURL(y,Z,".json"),o.ResourceType.SpriteJSON),function(te,ue){G=null,O||(O=te,E=ue,re())}),K=o.getImage(w.transformRequest(w.normalizeSpriteURL(y,Z,".png"),o.ResourceType.SpriteImage),function(te,ue){K=null,O||(O=te,P=ue,re())});function re(){if(O)k(O);else if(E&&P){var te=o.browser.getImageData(P),ue={};for(var Y in E){var le=E[Y],fe=le.width,ge=le.height,ze=le.x,Ee=le.y,Ae=le.sdf,De=le.pixelRatio,Ke=le.stretchX,Ze=le.stretchY,nt=le.content,vt=new o.RGBAImage({width:fe,height:ge});o.RGBAImage.copy(te,vt,{x:ze,y:Ee},{x:0,y:0},{width:fe,height:ge}),ue[Y]={data:vt,pixelRatio:De,sdf:Ae,stretchX:Ke,stretchY:Ze,content:nt}}k(null,ue)}}return{cancel:function(){G&&(G.cancel(),G=null),K&&(K.cancel(),K=null)}}}(a,this.map._requestManager,function(y,w){if(u._spriteRequest=null,y)u.fire(new o.ErrorEvent(y));else if(w)for(var k in w)u.imageManager.addImage(k,w[k]);u.imageManager.setLoaded(!0),u._availableImages=u.imageManager.listImages(),u.dispatcher.broadcast("setImages",u._availableImages),u.fire(new o.Event("data",{dataType:"style"}))})},s.prototype._validateLayer=function(a){var u=this.sourceCaches[a.source];if(u){var y=a.sourceLayer;if(y){var w=u.getSource();(w.type==="geojson"||w.vectorLayerIds&&w.vectorLayerIds.indexOf(y)===-1)&&this.fire(new o.ErrorEvent(new Error('Source layer "'+y+'" does not exist on source "'+w.id+'" as specified by style layer "'+a.id+'"')))}}},s.prototype.loaded=function(){if(!this._loaded||Object.keys(this._updatedSources).length)return!1;for(var a in this.sourceCaches)if(!this.sourceCaches[a].loaded())return!1;return!!this.imageManager.isLoaded()},s.prototype._serializeLayers=function(a){for(var u=[],y=0,w=a;y<w.length;y+=1){var k=this._layers[w[y]];k.type!=="custom"&&u.push(k.serialize())}return u},s.prototype.hasTransitions=function(){if(this.light&&this.light.hasTransition())return!0;for(var a in this.sourceCaches)if(this.sourceCaches[a].hasTransition())return!0;for(var u in this._layers)if(this._layers[u].hasTransition())return!0;return!1},s.prototype._checkLoaded=function(){if(!this._loaded)throw new Error("Style is not done loading")},s.prototype.update=function(a){if(this._loaded){var u=this._changed;if(this._changed){var y=Object.keys(this._updatedLayers),w=Object.keys(this._removedLayers);for(var k in(y.length||w.length)&&this._updateWorkerLayers(y,w),this._updatedSources){var E=this._updatedSources[k];E==="reload"?this._reloadSource(k):E==="clear"&&this._clearSource(k)}for(var P in this._updateTilesForChangedImages(),this._updatedPaintProps)this._layers[P].updateTransitions(a);this.light.updateTransitions(a),this._resetUpdates()}var O={};for(var Z in this.sourceCaches){var G=this.sourceCaches[Z];O[Z]=G.used,G.used=!1}for(var K=0,re=this._order;K<re.length;K+=1){var te=this._layers[re[K]];te.recalculate(a,this._availableImages),!te.isHidden(a.zoom)&&te.source&&(this.sourceCaches[te.source].used=!0)}for(var ue in O){var Y=this.sourceCaches[ue];O[ue]!==Y.used&&Y.fire(new o.Event("data",{sourceDataType:"visibility",dataType:"source",sourceId:ue}))}this.light.recalculate(a),this.z=a.zoom,u&&this.fire(new o.Event("data",{dataType:"style"}))}},s.prototype._updateTilesForChangedImages=function(){var a=Object.keys(this._changedImages);if(a.length){for(var u in this.sourceCaches)this.sourceCaches[u].reloadTilesForDependencies(["icons","patterns"],a);this._changedImages={}}},s.prototype._updateWorkerLayers=function(a,u){this.dispatcher.broadcast("updateLayers",{layers:this._serializeLayers(a),removedIds:u})},s.prototype._resetUpdates=function(){this._changed=!1,this._updatedLayers={},this._removedLayers={},this._updatedSources={},this._updatedPaintProps={},this._changedImages={}},s.prototype.setState=function(a){var u=this;if(this._checkLoaded(),un(this,o.validateStyle(a)))return!1;(a=o.clone$1(a)).layers=Oe(a.layers);var y=function(k,E){if(!k)return[{command:je.setStyle,args:[E]}];var P=[];try{if(!o.deepEqual(k.version,E.version))return[{command:je.setStyle,args:[E]}];o.deepEqual(k.center,E.center)||P.push({command:je.setCenter,args:[E.center]}),o.deepEqual(k.zoom,E.zoom)||P.push({command:je.setZoom,args:[E.zoom]}),o.deepEqual(k.bearing,E.bearing)||P.push({command:je.setBearing,args:[E.bearing]}),o.deepEqual(k.pitch,E.pitch)||P.push({command:je.setPitch,args:[E.pitch]}),o.deepEqual(k.sprite,E.sprite)||P.push({command:je.setSprite,args:[E.sprite]}),o.deepEqual(k.glyphs,E.glyphs)||P.push({command:je.setGlyphs,args:[E.glyphs]}),o.deepEqual(k.transition,E.transition)||P.push({command:je.setTransition,args:[E.transition]}),o.deepEqual(k.light,E.light)||P.push({command:je.setLight,args:[E.light]});var O={},Z=[];(function(K,re,te,ue){var Y;for(Y in re=re||{},K=K||{})K.hasOwnProperty(Y)&&(re.hasOwnProperty(Y)||qe(Y,te,ue));for(Y in re)re.hasOwnProperty(Y)&&(K.hasOwnProperty(Y)?o.deepEqual(K[Y],re[Y])||(K[Y].type==="geojson"&&re[Y].type==="geojson"&&lr(K,re,Y)?te.push({command:je.setGeoJSONSourceData,args:[Y,re[Y].data]}):Vt(Y,re,te,ue)):Mt(Y,re,te))})(k.sources,E.sources,Z,O);var G=[];k.layers&&k.layers.forEach(function(K){O[K.source]?P.push({command:je.removeLayer,args:[K.id]}):G.push(K)}),P=P.concat(Z),function(K,re,te){re=re||[];var ue,Y,le,fe,ge,ze,Ee,Ae=(K=K||[]).map(er),De=re.map(er),Ke=K.reduce(Ht,{}),Ze=re.reduce(Ht,{}),nt=Ae.slice(),vt=Object.create(null);for(ue=0,Y=0;ue<Ae.length;ue++)Ze.hasOwnProperty(le=Ae[ue])?Y++:(te.push({command:je.removeLayer,args:[le]}),nt.splice(nt.indexOf(le,Y),1));for(ue=0,Y=0;ue<De.length;ue++)nt[nt.length-1-ue]!==(le=De[De.length-1-ue])&&(Ke.hasOwnProperty(le)?(te.push({command:je.removeLayer,args:[le]}),nt.splice(nt.lastIndexOf(le,nt.length-Y),1)):Y++,te.push({command:je.addLayer,args:[Ze[le],ze=nt[nt.length-ue]]}),nt.splice(nt.length-ue,0,le),vt[le]=!0);for(ue=0;ue<De.length;ue++)if(fe=Ke[le=De[ue]],ge=Ze[le],!vt[le]&&!o.deepEqual(fe,ge))if(o.deepEqual(fe.source,ge.source)&&o.deepEqual(fe["source-layer"],ge["source-layer"])&&o.deepEqual(fe.type,ge.type)){for(Ee in Pt(fe.layout,ge.layout,te,le,null,je.setLayoutProperty),Pt(fe.paint,ge.paint,te,le,null,je.setPaintProperty),o.deepEqual(fe.filter,ge.filter)||te.push({command:je.setFilter,args:[le,ge.filter]}),o.deepEqual(fe.minzoom,ge.minzoom)&&o.deepEqual(fe.maxzoom,ge.maxzoom)||te.push({command:je.setLayerZoomRange,args:[le,ge.minzoom,ge.maxzoom]}),fe)fe.hasOwnProperty(Ee)&&Ee!=="layout"&&Ee!=="paint"&&Ee!=="filter"&&Ee!=="metadata"&&Ee!=="minzoom"&&Ee!=="maxzoom"&&(Ee.indexOf("paint.")===0?Pt(fe[Ee],ge[Ee],te,le,Ee.slice(6),je.setPaintProperty):o.deepEqual(fe[Ee],ge[Ee])||te.push({command:je.setLayerProperty,args:[le,Ee,ge[Ee]]}));for(Ee in ge)ge.hasOwnProperty(Ee)&&!fe.hasOwnProperty(Ee)&&Ee!=="layout"&&Ee!=="paint"&&Ee!=="filter"&&Ee!=="metadata"&&Ee!=="minzoom"&&Ee!=="maxzoom"&&(Ee.indexOf("paint.")===0?Pt(fe[Ee],ge[Ee],te,le,Ee.slice(6),je.setPaintProperty):o.deepEqual(fe[Ee],ge[Ee])||te.push({command:je.setLayerProperty,args:[le,Ee,ge[Ee]]}))}else te.push({command:je.removeLayer,args:[le]}),ze=nt[nt.lastIndexOf(le)+1],te.push({command:je.addLayer,args:[ge,ze]})}(G,E.layers,P)}catch(K){console.warn("Unable to compute style diff:",K),P=[{command:je.setStyle,args:[E]}]}return P}(this.serialize(),a).filter(function(k){return!(k.command in Gr)});if(y.length===0)return!1;var w=y.filter(function(k){return!(k.command in qi)});if(w.length>0)throw new Error("Unimplemented: "+w.map(function(k){return k.command}).join(", ")+".");return y.forEach(function(k){k.command!=="setTransition"&&u[k.command].apply(u,k.args)}),this.stylesheet=a,!0},s.prototype.addImage=function(a,u){if(this.getImage(a))return this.fire(new o.ErrorEvent(new Error("An image with this name already exists.")));this.imageManager.addImage(a,u),this._afterImageUpdated(a)},s.prototype.updateImage=function(a,u){this.imageManager.updateImage(a,u)},s.prototype.getImage=function(a){return this.imageManager.getImage(a)},s.prototype.removeImage=function(a){if(!this.getImage(a))return this.fire(new o.ErrorEvent(new Error("No image with this name exists.")));this.imageManager.removeImage(a),this._afterImageUpdated(a)},s.prototype._afterImageUpdated=function(a){this._availableImages=this.imageManager.listImages(),this._changedImages[a]=!0,this._changed=!0,this.dispatcher.broadcast("setImages",this._availableImages),this.fire(new o.Event("data",{dataType:"style"}))},s.prototype.listImages=function(){return this._checkLoaded(),this.imageManager.listImages()},s.prototype.addSource=function(a,u,y){var w=this;if(y===void 0&&(y={}),this._checkLoaded(),this.sourceCaches[a]!==void 0)throw new Error("There is already a source with this ID");if(!u.type)throw new Error("The type property must be defined, but only the following properties were given: "+Object.keys(u).join(", ")+".");if(!(["vector","raster","geojson","video","image"].indexOf(u.type)>=0&&this._validate(o.validateStyle.source,"sources."+a,u,null,y))){this.map&&this.map._collectResourceTiming&&(u.collectResourceTiming=!0);var k=this.sourceCaches[a]=new J(a,u,this.dispatcher);k.style=this,k.setEventedParent(this,function(){return{isSourceLoaded:w.loaded(),source:k.serialize(),sourceId:a}}),k.onAdd(this.map),this._changed=!0}},s.prototype.removeSource=function(a){if(this._checkLoaded(),this.sourceCaches[a]===void 0)throw new Error("There is no source with this ID");for(var u in this._layers)if(this._layers[u].source===a)return this.fire(new o.ErrorEvent(new Error('Source "'+a+'" cannot be removed while layer "'+u+'" is using it.')));var y=this.sourceCaches[a];delete this.sourceCaches[a],delete this._updatedSources[a],y.fire(new o.Event("data",{sourceDataType:"metadata",dataType:"source",sourceId:a})),y.setEventedParent(null),y.clearTiles(),y.onRemove&&y.onRemove(this.map),this._changed=!0},s.prototype.setGeoJSONSourceData=function(a,u){this._checkLoaded(),this.sourceCaches[a].getSource().setData(u),this._changed=!0},s.prototype.getSource=function(a){return this.sourceCaches[a]&&this.sourceCaches[a].getSource()},s.prototype.addLayer=function(a,u,y){y===void 0&&(y={}),this._checkLoaded();var w=a.id;if(this.getLayer(w))this.fire(new o.ErrorEvent(new Error('Layer with id "'+w+'" already exists on this map')));else{var k;if(a.type==="custom"){if(un(this,o.validateCustomStyleLayer(a)))return;k=o.createStyleLayer(a)}else{if(typeof a.source=="object"&&(this.addSource(w,a.source),a=o.clone$1(a),a=o.extend(a,{source:w})),this._validate(o.validateStyle.layer,"layers."+w,a,{arrayIndex:-1},y))return;k=o.createStyleLayer(a),this._validateLayer(k),k.setEventedParent(this,{layer:{id:w}}),this._serializedLayers[k.id]=k.serialize()}var E=u?this._order.indexOf(u):this._order.length;if(u&&E===-1)this.fire(new o.ErrorEvent(new Error('Layer with id "'+u+'" does not exist on this map.')));else{if(this._order.splice(E,0,w),this._layerOrderChanged=!0,this._layers[w]=k,this._removedLayers[w]&&k.source&&k.type!=="custom"){var P=this._removedLayers[w];delete this._removedLayers[w],P.type!==k.type?this._updatedSources[k.source]="clear":(this._updatedSources[k.source]="reload",this.sourceCaches[k.source].pause())}this._updateLayer(k),k.onAdd&&k.onAdd(this.map)}}},s.prototype.moveLayer=function(a,u){if(this._checkLoaded(),this._changed=!0,this._layers[a]){if(a!==u){var y=this._order.indexOf(a);this._order.splice(y,1);var w=u?this._order.indexOf(u):this._order.length;u&&w===-1?this.fire(new o.ErrorEvent(new Error('Layer with id "'+u+'" does not exist on this map.'))):(this._order.splice(w,0,a),this._layerOrderChanged=!0)}}else this.fire(new o.ErrorEvent(new Error("The layer '"+a+"' does not exist in the map's style and cannot be moved.")))},s.prototype.removeLayer=function(a){this._checkLoaded();var u=this._layers[a];if(u){u.setEventedParent(null);var y=this._order.indexOf(a);this._order.splice(y,1),this._layerOrderChanged=!0,this._changed=!0,this._removedLayers[a]=u,delete this._layers[a],delete this._serializedLayers[a],delete this._updatedLayers[a],delete this._updatedPaintProps[a],u.onRemove&&u.onRemove(this.map)}else this.fire(new o.ErrorEvent(new Error("The layer '"+a+"' does not exist in the map's style and cannot be removed.")))},s.prototype.getLayer=function(a){return this._layers[a]},s.prototype.hasLayer=function(a){return a in this._layers},s.prototype.setLayerZoomRange=function(a,u,y){this._checkLoaded();var w=this.getLayer(a);w?w.minzoom===u&&w.maxzoom===y||(u!=null&&(w.minzoom=u),y!=null&&(w.maxzoom=y),this._updateLayer(w)):this.fire(new o.ErrorEvent(new Error("The layer '"+a+"' does not exist in the map's style and cannot have zoom extent.")))},s.prototype.setFilter=function(a,u,y){y===void 0&&(y={}),this._checkLoaded();var w=this.getLayer(a);if(w){if(!o.deepEqual(w.filter,u))return u==null?(w.filter=void 0,void this._updateLayer(w)):void(this._validate(o.validateStyle.filter,"layers."+w.id+".filter",u,null,y)||(w.filter=o.clone$1(u),this._updateLayer(w)))}else this.fire(new o.ErrorEvent(new Error("The layer '"+a+"' does not exist in the map's style and cannot be filtered.")))},s.prototype.getFilter=function(a){return o.clone$1(this.getLayer(a).filter)},s.prototype.setLayoutProperty=function(a,u,y,w){w===void 0&&(w={}),this._checkLoaded();var k=this.getLayer(a);k?o.deepEqual(k.getLayoutProperty(u),y)||(k.setLayoutProperty(u,y,w),this._updateLayer(k)):this.fire(new o.ErrorEvent(new Error("The layer '"+a+"' does not exist in the map's style and cannot be styled.")))},s.prototype.getLayoutProperty=function(a,u){var y=this.getLayer(a);if(y)return y.getLayoutProperty(u);this.fire(new o.ErrorEvent(new Error("The layer '"+a+"' does not exist in the map's style.")))},s.prototype.setPaintProperty=function(a,u,y,w){w===void 0&&(w={}),this._checkLoaded();var k=this.getLayer(a);k?o.deepEqual(k.getPaintProperty(u),y)||(k.setPaintProperty(u,y,w)&&this._updateLayer(k),this._changed=!0,this._updatedPaintProps[a]=!0):this.fire(new o.ErrorEvent(new Error("The layer '"+a+"' does not exist in the map's style and cannot be styled.")))},s.prototype.getPaintProperty=function(a,u){return this.getLayer(a).getPaintProperty(u)},s.prototype.setFeatureState=function(a,u){this._checkLoaded();var y=a.source,w=a.sourceLayer,k=this.sourceCaches[y];if(k!==void 0){var E=k.getSource().type;E==="geojson"&&w?this.fire(new o.ErrorEvent(new Error("GeoJSON sources cannot have a sourceLayer parameter."))):E!=="vector"||w?(a.id===void 0&&this.fire(new o.ErrorEvent(new Error("The feature id parameter must be provided."))),k.setFeatureState(w,a.id,u)):this.fire(new o.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")))}else this.fire(new o.ErrorEvent(new Error("The source '"+y+"' does not exist in the map's style.")))},s.prototype.removeFeatureState=function(a,u){this._checkLoaded();var y=a.source,w=this.sourceCaches[y];if(w!==void 0){var k=w.getSource().type,E=k==="vector"?a.sourceLayer:void 0;k!=="vector"||E?u&&typeof a.id!="string"&&typeof a.id!="number"?this.fire(new o.ErrorEvent(new Error("A feature id is required to remove its specific state property."))):w.removeFeatureState(E,a.id,u):this.fire(new o.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")))}else this.fire(new o.ErrorEvent(new Error("The source '"+y+"' does not exist in the map's style.")))},s.prototype.getFeatureState=function(a){this._checkLoaded();var u=a.source,y=a.sourceLayer,w=this.sourceCaches[u];if(w!==void 0){if(w.getSource().type!=="vector"||y)return a.id===void 0&&this.fire(new o.ErrorEvent(new Error("The feature id parameter must be provided."))),w.getFeatureState(y,a.id);this.fire(new o.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")))}else this.fire(new o.ErrorEvent(new Error("The source '"+u+"' does not exist in the map's style.")))},s.prototype.getTransition=function(){return o.extend({duration:300,delay:0},this.stylesheet&&this.stylesheet.transition)},s.prototype.serialize=function(){return o.filterObject({version:this.stylesheet.version,name:this.stylesheet.name,metadata:this.stylesheet.metadata,light:this.stylesheet.light,center:this.stylesheet.center,zoom:this.stylesheet.zoom,bearing:this.stylesheet.bearing,pitch:this.stylesheet.pitch,sprite:this.stylesheet.sprite,glyphs:this.stylesheet.glyphs,transition:this.stylesheet.transition,sources:o.mapObject(this.sourceCaches,function(a){return a.serialize()}),layers:this._serializeLayers(this._order)},function(a){return a!==void 0})},s.prototype._updateLayer=function(a){this._updatedLayers[a.id]=!0,a.source&&!this._updatedSources[a.source]&&this.sourceCaches[a.source].getSource().type!=="raster"&&(this._updatedSources[a.source]="reload",this.sourceCaches[a.source].pause()),this._changed=!0},s.prototype._flattenAndSortRenderedFeatures=function(a){for(var u=this,y=function(Ke){return u._layers[Ke].type==="fill-extrusion"},w={},k=[],E=this._order.length-1;E>=0;E--){var P=this._order[E];if(y(P)){w[P]=E;for(var O=0,Z=a;O<Z.length;O+=1){var G=Z[O][P];if(G)for(var K=0,re=G;K<re.length;K+=1)k.push(re[K])}}}k.sort(function(Ke,Ze){return Ze.intersectionZ-Ke.intersectionZ});for(var te=[],ue=this._order.length-1;ue>=0;ue--){var Y=this._order[ue];if(y(Y))for(var le=k.length-1;le>=0;le--){var fe=k[le].feature;if(w[fe.layer.id]<ue)break;te.push(fe),k.pop()}else for(var ge=0,ze=a;ge<ze.length;ge+=1){var Ee=ze[ge][Y];if(Ee)for(var Ae=0,De=Ee;Ae<De.length;Ae+=1)te.push(De[Ae].feature)}}return te},s.prototype.queryRenderedFeatures=function(a,u,y){u&&u.filter&&this._validate(o.validateStyle.filter,"queryRenderedFeatures.filter",u.filter,null,u);var w={};if(u&&u.layers){if(!Array.isArray(u.layers))return this.fire(new o.ErrorEvent(new Error("parameters.layers must be an Array."))),[];for(var k=0,E=u.layers;k<E.length;k+=1){var P=E[k],O=this._layers[P];if(!O)return this.fire(new o.ErrorEvent(new Error("The layer '"+P+"' does not exist in the map's style and cannot be queried for features."))),[];w[O.source]=!0}}var Z=[];for(var G in u.availableImages=this._availableImages,this.sourceCaches)u.layers&&!w[G]||Z.push(sr(this.sourceCaches[G],this._layers,this._serializedLayers,a,u,y));return this.placement&&Z.push(function(K,re,te,ue,Y,le,fe){for(var ge={},ze=le.queryRenderedSymbols(ue),Ee=[],Ae=0,De=Object.keys(ze).map(Number);Ae<De.length;Ae+=1)Ee.push(fe[De[Ae]]);Ee.sort(Qr);for(var Ke=function(){var wt=nt[Ze],_r=wt.featureIndex.lookupSymbolFeatures(ze[wt.bucketInstanceId],re,wt.bucketIndex,wt.sourceLayerIndex,Y.filter,Y.layers,Y.availableImages,K);for(var at in _r){var Nt=ge[at]=ge[at]||[],Jt=_r[at];Jt.sort(function(Wt,Rt){var Ct=wt.featureSortOrder;if(Ct){var Di=Ct.indexOf(Wt.featureIndex);return Ct.indexOf(Rt.featureIndex)-Di}return Rt.featureIndex-Wt.featureIndex});for(var Ot=0,Bt=Jt;Ot<Bt.length;Ot+=1)Nt.push(Bt[Ot])}},Ze=0,nt=Ee;Ze<nt.length;Ze+=1)Ke();var vt=function(wt){ge[wt].forEach(function(_r){var at=_r.feature,Nt=te[K[wt].source].getFeatureState(at.layer["source-layer"],at.id);at.source=at.layer.source,at.layer["source-layer"]&&(at.sourceLayer=at.layer["source-layer"]),at.state=Nt})};for(var St in ge)vt(St);return ge}(this._layers,this._serializedLayers,this.sourceCaches,a,u,this.placement.collisionIndex,this.placement.retainedQueryData)),this._flattenAndSortRenderedFeatures(Z)},s.prototype.querySourceFeatures=function(a,u){u&&u.filter&&this._validate(o.validateStyle.filter,"querySourceFeatures.filter",u.filter,null,u);var y=this.sourceCaches[a];return y?function(w,k){for(var E=w.getRenderableIds().map(function(re){return w.getTileByID(re)}),P=[],O={},Z=0;Z<E.length;Z++){var G=E[Z],K=G.tileID.canonical.key;O[K]||(O[K]=!0,G.querySourceFeatures(P,k))}return P}(y,u):[]},s.prototype.addSourceType=function(a,u,y){return s.getSourceType(a)?y(new Error('A source type called "'+a+'" already exists.')):(s.setSourceType(a,u),u.workerSourceURL?void this.dispatcher.broadcast("loadWorkerSource",{name:a,url:u.workerSourceURL},y):y(null,null))},s.prototype.getLight=function(){return this.light.getLight()},s.prototype.setLight=function(a,u){u===void 0&&(u={}),this._checkLoaded();var y=this.light.getLight(),w=!1;for(var k in a)if(!o.deepEqual(a[k],y[k])){w=!0;break}if(w){var E={now:o.browser.now(),transition:o.extend({duration:300,delay:0},this.stylesheet.transition)};this.light.setLight(a,u),this.light.updateTransitions(E)}},s.prototype._validate=function(a,u,y,w,k){return k===void 0&&(k={}),(!k||k.validate!==!1)&&un(this,a.call(o.validateStyle,o.extend({key:u,style:this.serialize(),value:y,styleSpec:o.styleSpec},w)))},s.prototype._remove=function(){for(var a in this._request&&(this._request.cancel(),this._request=null),this._spriteRequest&&(this._spriteRequest.cancel(),this._spriteRequest=null),o.evented.off("pluginStateChange",this._rtlTextPluginCallback),this._layers)this._layers[a].setEventedParent(null);for(var u in this.sourceCaches)this.sourceCaches[u].clearTiles(),this.sourceCaches[u].setEventedParent(null);this.imageManager.setEventedParent(null),this.setEventedParent(null),this.dispatcher.remove()},s.prototype._clearSource=function(a){this.sourceCaches[a].clearTiles()},s.prototype._reloadSource=function(a){this.sourceCaches[a].resume(),this.sourceCaches[a].reload()},s.prototype._updateSources=function(a){for(var u in this.sourceCaches)this.sourceCaches[u].update(a)},s.prototype._generateCollisionBoxes=function(){for(var a in this.sourceCaches)this._reloadSource(a)},s.prototype._updatePlacement=function(a,u,y,w,k){k===void 0&&(k=!1);for(var E=!1,P=!1,O={},Z=0,G=this._order;Z<G.length;Z+=1){var K=this._layers[G[Z]];if(K.type==="symbol"){if(!O[K.source]){var re=this.sourceCaches[K.source];O[K.source]=re.getRenderableIds(!0).map(function(fe){return re.getTileByID(fe)}).sort(function(fe,ge){return ge.tileID.overscaledZ-fe.tileID.overscaledZ||(fe.tileID.isLessThan(ge.tileID)?-1:1)})}var te=this.crossTileSymbolIndex.addLayer(K,O[K.source],a.center.lng);E=E||te}}if(this.crossTileSymbolIndex.pruneUnusedLayers(this._order),((k=k||this._layerOrderChanged||y===0)||!this.pauseablePlacement||this.pauseablePlacement.isDone()&&!this.placement.stillRecent(o.browser.now(),a.zoom))&&(this.pauseablePlacement=new pa(a,this._order,k,u,y,w,this.placement),this._layerOrderChanged=!1),this.pauseablePlacement.isDone()?this.placement.setStale():(this.pauseablePlacement.continuePlacement(this._order,this._layers,O),this.pauseablePlacement.isDone()&&(this.placement=this.pauseablePlacement.commit(o.browser.now()),P=!0),E&&this.pauseablePlacement.placement.setStale()),P||E)for(var ue=0,Y=this._order;ue<Y.length;ue+=1){var le=this._layers[Y[ue]];le.type==="symbol"&&this.placement.updateLayerOpacities(le,O[le.source])}return!this.pauseablePlacement.isDone()||this.placement.hasTransitions(o.browser.now())},s.prototype._releaseSymbolFadeTiles=function(){for(var a in this.sourceCaches)this.sourceCaches[a].releaseSymbolFadeTiles()},s.prototype.getImages=function(a,u,y){this.imageManager.getImages(u.icons,y),this._updateTilesForChangedImages();var w=this.sourceCaches[u.source];w&&w.setDependencies(u.tileID.key,u.type,u.icons)},s.prototype.getGlyphs=function(a,u,y){this.glyphManager.getGlyphs(u.stacks,y)},s.prototype.getResource=function(a,u,y){return o.makeRequest(u,y)},s}(o.Evented);Nn.getSourceType=function(n){return Fr[n]},Nn.setSourceType=function(n,s){Fr[n]=s},Nn.registerForPluginStateChange=o.registerForPluginStateChange;var vi=o.createLayout([{name:"a_pos",type:"Int16",components:2}]),Fa=Br(`#ifdef GL_ES
precision mediump float;
#else
#if !defined(lowp)
#define lowp
#endif
#if !defined(mediump)
#define mediump
#endif
#if !defined(highp)
#define highp
#endif
#endif`,`#ifdef GL_ES
precision highp float;
#else
#if !defined(lowp)
#define lowp
#endif
#if !defined(mediump)
#define mediump
#endif
#if !defined(highp)
#define highp
#endif
#endif
vec2 unpack_float(const float packedValue) {int packedIntValue=int(packedValue);int v0=packedIntValue/256;return vec2(v0,packedIntValue-v0*256);}vec2 unpack_opacity(const float packedOpacity) {int intOpacity=int(packedOpacity)/2;return vec2(float(intOpacity)/127.0,mod(packedOpacity,2.0));}vec4 decode_color(const vec2 encodedColor) {return vec4(unpack_float(encodedColor[0])/255.0,unpack_float(encodedColor[1])/255.0
);}float unpack_mix_vec2(const vec2 packedValue,const float t) {return mix(packedValue[0],packedValue[1],t);}vec4 unpack_mix_color(const vec4 packedColors,const float t) {vec4 minColor=decode_color(vec2(packedColors[0],packedColors[1]));vec4 maxColor=decode_color(vec2(packedColors[2],packedColors[3]));return mix(minColor,maxColor,t);}vec2 get_pattern_pos(const vec2 pixel_coord_upper,const vec2 pixel_coord_lower,const vec2 pattern_size,const float tile_units_to_pixels,const vec2 pos) {vec2 offset=mod(mod(mod(pixel_coord_upper,pattern_size)*256.0,pattern_size)*256.0+pixel_coord_lower,pattern_size);return (tile_units_to_pixels*pos+offset)/pattern_size;}`),ec=Br(`uniform vec4 u_color;uniform float u_opacity;void main() {gl_FragColor=u_color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),Oh=Br(`uniform vec2 u_pattern_tl_a;uniform vec2 u_pattern_br_a;uniform vec2 u_pattern_tl_b;uniform vec2 u_pattern_br_b;uniform vec2 u_texsize;uniform float u_mix;uniform float u_opacity;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;void main() {vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(u_pattern_tl_a/u_texsize,u_pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(u_pattern_tl_b/u_texsize,u_pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);gl_FragColor=mix(color1,color2,u_mix)*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_pattern_size_a;uniform vec2 u_pattern_size_b;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_scale_a;uniform float u_scale_b;uniform float u_tile_units_to_pixels;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_a*u_pattern_size_a,u_tile_units_to_pixels,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_b*u_pattern_size_b,u_tile_units_to_pixels,a_pos);}"),Fh=Br(`varying vec3 v_data;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=v_data.xy;float extrude_length=length(extrude);lowp float antialiasblur=v_data.z;float antialiased_blur=-max(blur,antialiasblur);float opacity_t=smoothstep(0.0,antialiased_blur,extrude_length-1.0);float color_t=stroke_width < 0.01 ? 0.0 : smoothstep(antialiased_blur,0.0,extrude_length-radius/(radius+stroke_width));gl_FragColor=opacity_t*mix(color*opacity,stroke_color*stroke_opacity,color_t);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform bool u_scale_with_map;uniform bool u_pitch_with_map;uniform vec2 u_extrude_scale;uniform lowp float u_device_pixel_ratio;uniform highp float u_camera_to_center_distance;attribute vec2 a_pos;varying vec3 v_data;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
void main(void) {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=vec2(mod(a_pos,2.0)*2.0-1.0);vec2 circle_center=floor(a_pos*0.5);if (u_pitch_with_map) {vec2 corner_position=circle_center;if (u_scale_with_map) {corner_position+=extrude*(radius+stroke_width)*u_extrude_scale;} else {vec4 projected_center=u_matrix*vec4(circle_center,0,1);corner_position+=extrude*(radius+stroke_width)*u_extrude_scale*(projected_center.w/u_camera_to_center_distance);}gl_Position=u_matrix*vec4(corner_position,0,1);} else {gl_Position=u_matrix*vec4(circle_center,0,1);if (u_scale_with_map) {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*u_camera_to_center_distance;} else {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*gl_Position.w;}}lowp float antialiasblur=1.0/u_device_pixel_ratio/(radius+stroke_width);v_data=vec3(extrude.x,extrude.y,antialiasblur);}`),Ol=Br("void main() {gl_FragColor=vec4(1.0);}","attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),Fl=Br(`uniform highp float u_intensity;varying vec2 v_extrude;
#pragma mapbox: define highp float weight
#define GAUSS_COEF 0.3989422804014327
void main() {
#pragma mapbox: initialize highp float weight
float d=-0.5*3.0*3.0*dot(v_extrude,v_extrude);float val=weight*u_intensity*GAUSS_COEF*exp(d);gl_FragColor=vec4(val,1.0,1.0,1.0);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform float u_extrude_scale;uniform float u_opacity;uniform float u_intensity;attribute vec2 a_pos;varying vec2 v_extrude;
#pragma mapbox: define highp float weight
#pragma mapbox: define mediump float radius
const highp float ZERO=1.0/255.0/16.0;
#define GAUSS_COEF 0.3989422804014327
void main(void) {
#pragma mapbox: initialize highp float weight
#pragma mapbox: initialize mediump float radius
vec2 unscaled_extrude=vec2(mod(a_pos,2.0)*2.0-1.0);float S=sqrt(-2.0*log(ZERO/weight/u_intensity/GAUSS_COEF))/3.0;v_extrude=S*unscaled_extrude;vec2 extrude=v_extrude*radius*u_extrude_scale;vec4 pos=vec4(floor(a_pos*0.5)+extrude,0,1);gl_Position=u_matrix*pos;}`),Nl=Br(`uniform sampler2D u_image;uniform sampler2D u_color_ramp;uniform float u_opacity;varying vec2 v_pos;void main() {float t=texture2D(u_image,v_pos).r;vec4 color=texture2D(u_color_ramp,vec2(t,0.5));gl_FragColor=color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(0.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_world;attribute vec2 a_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos*u_world,0,1);v_pos.x=a_pos.x;v_pos.y=1.0-a_pos.y;}"),Ul=Br("varying float v_placed;varying float v_notUsed;void main() {float alpha=0.5;gl_FragColor=vec4(1.0,0.0,0.0,1.0)*alpha;if (v_placed > 0.5) {gl_FragColor=vec4(0.0,0.0,1.0,0.5)*alpha;}if (v_notUsed > 0.5) {gl_FragColor*=.1;}}","attribute vec2 a_pos;attribute vec2 a_anchor_pos;attribute vec2 a_extrude;attribute vec2 a_placed;attribute vec2 a_shift;uniform mat4 u_matrix;uniform vec2 u_extrude_scale;uniform float u_camera_to_center_distance;varying float v_placed;varying float v_notUsed;void main() {vec4 projectedPoint=u_matrix*vec4(a_anchor_pos,0,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float collision_perspective_ratio=clamp(0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,4.0);gl_Position=u_matrix*vec4(a_pos,0.0,1.0);gl_Position.xy+=(a_extrude+a_shift)*u_extrude_scale*gl_Position.w*collision_perspective_ratio;v_placed=a_placed.x;v_notUsed=a_placed.y;}"),tc=Br("varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;void main() {float alpha=0.5*min(v_perspective_ratio,1.0);float stroke_radius=0.9*max(v_perspective_ratio,1.0);float distance_to_center=length(v_extrude);float distance_to_edge=abs(distance_to_center-v_radius);float opacity_t=smoothstep(-stroke_radius,0.0,-distance_to_edge);vec4 color=mix(vec4(0.0,0.0,1.0,0.5),vec4(1.0,0.0,0.0,1.0),v_collision);gl_FragColor=color*alpha*opacity_t;}","attribute vec2 a_pos;attribute float a_radius;attribute vec2 a_flags;uniform mat4 u_matrix;uniform mat4 u_inv_matrix;uniform vec2 u_viewport_size;uniform float u_camera_to_center_distance;varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;vec3 toTilePosition(vec2 screenPos) {vec4 rayStart=u_inv_matrix*vec4(screenPos,-1.0,1.0);vec4 rayEnd  =u_inv_matrix*vec4(screenPos, 1.0,1.0);rayStart.xyz/=rayStart.w;rayEnd.xyz  /=rayEnd.w;highp float t=(0.0-rayStart.z)/(rayEnd.z-rayStart.z);return mix(rayStart.xyz,rayEnd.xyz,t);}void main() {vec2 quadCenterPos=a_pos;float radius=a_radius;float collision=a_flags.x;float vertexIdx=a_flags.y;vec2 quadVertexOffset=vec2(mix(-1.0,1.0,float(vertexIdx >=2.0)),mix(-1.0,1.0,float(vertexIdx >=1.0 && vertexIdx <=2.0)));vec2 quadVertexExtent=quadVertexOffset*radius;vec3 tilePos=toTilePosition(quadCenterPos);vec4 clipPos=u_matrix*vec4(tilePos,1.0);highp float camera_to_anchor_distance=clipPos.w;highp float collision_perspective_ratio=clamp(0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,4.0);float padding_factor=1.2;v_radius=radius;v_extrude=quadVertexExtent*padding_factor;v_perspective_ratio=collision_perspective_ratio;v_collision=collision;gl_Position=vec4(clipPos.xyz/clipPos.w,1.0)+vec4(quadVertexExtent*padding_factor/u_viewport_size*2.0,0.0,0.0);}"),rc=Br("uniform highp vec4 u_color;uniform sampler2D u_overlay;varying vec2 v_uv;void main() {vec4 overlay_color=texture2D(u_overlay,v_uv);gl_FragColor=mix(u_color,overlay_color,overlay_color.a);}","attribute vec2 a_pos;varying vec2 v_uv;uniform mat4 u_matrix;uniform float u_overlay_scale;void main() {v_uv=a_pos/8192.0;gl_Position=u_matrix*vec4(a_pos*u_overlay_scale,0,1);}"),Nh=Br(`#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
gl_FragColor=color*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec2 a_pos;uniform mat4 u_matrix;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
gl_Position=u_matrix*vec4(a_pos,0,1);}`),as=Br(`varying vec2 v_pos;
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);gl_FragColor=outline_color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec2 a_pos;uniform mat4 u_matrix;uniform vec2 u_world;varying vec2 v_pos;
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;}`),ss=Br(`uniform vec2 u_texsize;uniform sampler2D u_image;uniform float u_fade;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec2 v_pos;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);gl_FragColor=mix(color1,color2,u_fade)*alpha*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_world;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec2 v_pos;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;gl_Position=u_matrix*vec4(a_pos,0,1);vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,a_pos);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;}`),ic=Br(`uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);gl_FragColor=mix(color1,color2,u_fade)*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;gl_Position=u_matrix*vec4(a_pos,0,1);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileZoomRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileZoomRatio,a_pos);}`),en=Br(`varying vec4 v_color;void main() {gl_FragColor=v_color;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;uniform float u_vertical_gradient;uniform lowp float u_opacity;attribute vec2 a_pos;attribute vec4 a_normal_ed;varying vec4 v_color;
#pragma mapbox: define highp float base
#pragma mapbox: define highp float height
#pragma mapbox: define highp vec4 color
void main() {
#pragma mapbox: initialize highp float base
#pragma mapbox: initialize highp float height
#pragma mapbox: initialize highp vec4 color
vec3 normal=a_normal_ed.xyz;base=max(0.0,base);height=max(0.0,height);float t=mod(normal.x,2.0);gl_Position=u_matrix*vec4(a_pos,t > 0.0 ? height : base,1);float colorvalue=color.r*0.2126+color.g*0.7152+color.b*0.0722;v_color=vec4(0.0,0.0,0.0,1.0);vec4 ambientlight=vec4(0.03,0.03,0.03,1.0);color+=ambientlight;float directional=clamp(dot(normal/16384.0,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_color.r+=clamp(color.r*directional*u_lightcolor.r,mix(0.0,0.3,1.0-u_lightcolor.r),1.0);v_color.g+=clamp(color.g*directional*u_lightcolor.g,mix(0.0,0.3,1.0-u_lightcolor.g),1.0);v_color.b+=clamp(color.b*directional*u_lightcolor.b,mix(0.0,0.3,1.0-u_lightcolor.b),1.0);v_color*=u_opacity;}`),Vl=Br(`uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec4 v_lighting;
#pragma mapbox: define lowp float base
#pragma mapbox: define lowp float height
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float base
#pragma mapbox: initialize lowp float height
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);vec4 mixedColor=mix(color1,color2,u_fade);gl_FragColor=mixedColor*v_lighting;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_height_factor;uniform vec3 u_scale;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;attribute vec2 a_pos;attribute vec4 a_normal_ed;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec4 v_lighting;
#pragma mapbox: define lowp float base
#pragma mapbox: define lowp float height
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float base
#pragma mapbox: initialize lowp float height
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec3 normal=a_normal_ed.xyz;float edgedistance=a_normal_ed.w;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;base=max(0.0,base);height=max(0.0,height);float t=mod(normal.x,2.0);float z=t > 0.0 ? height : base;gl_Position=u_matrix*vec4(a_pos,z,1);vec2 pos=normal.x==1.0 && normal.y==0.0 && normal.z==16384.0
? a_pos
: vec2(edgedistance,z*u_height_factor);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,pos);v_lighting=vec4(0.0,0.0,0.0,1.0);float directional=clamp(dot(normal/16383.0,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((0.5+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_lighting.rgb+=clamp(directional*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_lighting*=u_opacity;}`),Zo=Br(`#ifdef GL_ES
precision highp float;
#endif
uniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_dimension;uniform float u_zoom;uniform vec4 u_unpack;float getElevation(vec2 coord,float bias) {vec4 data=texture2D(u_image,coord)*255.0;data.a=-1.0;return dot(data,u_unpack)/4.0;}void main() {vec2 epsilon=1.0/u_dimension;float a=getElevation(v_pos+vec2(-epsilon.x,-epsilon.y),0.0);float b=getElevation(v_pos+vec2(0,-epsilon.y),0.0);float c=getElevation(v_pos+vec2(epsilon.x,-epsilon.y),0.0);float d=getElevation(v_pos+vec2(-epsilon.x,0),0.0);float e=getElevation(v_pos,0.0);float f=getElevation(v_pos+vec2(epsilon.x,0),0.0);float g=getElevation(v_pos+vec2(-epsilon.x,epsilon.y),0.0);float h=getElevation(v_pos+vec2(0,epsilon.y),0.0);float i=getElevation(v_pos+vec2(epsilon.x,epsilon.y),0.0);float exaggerationFactor=u_zoom < 2.0 ? 0.4 : u_zoom < 4.5 ? 0.35 : 0.3;float exaggeration=u_zoom < 15.0 ? (u_zoom-15.0)*exaggerationFactor : 0.0;vec2 deriv=vec2((c+f+f+i)-(a+d+d+g),(g+h+h+i)-(a+b+b+c))/pow(2.0,exaggeration+(19.2562-u_zoom));gl_FragColor=clamp(vec4(deriv.x/2.0+0.5,deriv.y/2.0+0.5,1.0,1.0),0.0,1.0);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_dimension;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);highp vec2 epsilon=1.0/u_dimension;float scale=(u_dimension.x-2.0)/u_dimension.x;v_pos=(a_texture_pos/8192.0)*scale+epsilon;}"),Go=Br(`uniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_latrange;uniform vec2 u_light;uniform vec4 u_shadow;uniform vec4 u_highlight;uniform vec4 u_accent;
#define PI 3.141592653589793
void main() {vec4 pixel=texture2D(u_image,v_pos);vec2 deriv=((pixel.rg*2.0)-1.0);float scaleFactor=cos(radians((u_latrange[0]-u_latrange[1])*(1.0-v_pos.y)+u_latrange[1]));float slope=atan(1.25*length(deriv)/scaleFactor);float aspect=deriv.x !=0.0 ? atan(deriv.y,-deriv.x) : PI/2.0*(deriv.y > 0.0 ? 1.0 :-1.0);float intensity=u_light.x;float azimuth=u_light.y+PI;float base=1.875-intensity*1.75;float maxValue=0.5*PI;float scaledSlope=intensity !=0.5 ? ((pow(base,slope)-1.0)/(pow(base,maxValue)-1.0))*maxValue : slope;float accent=cos(scaledSlope);vec4 accent_color=(1.0-accent)*u_accent*clamp(intensity*2.0,0.0,1.0);float shade=abs(mod((aspect+azimuth)/PI+0.5,2.0)-1.0);vec4 shade_color=mix(u_shadow,u_highlight,shade)*sin(scaledSlope)*clamp(intensity*2.0,0.0,1.0);gl_FragColor=accent_color*(1.0-shade_color.a)+shade_color;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=a_texture_pos/8192.0;}"),fa=Br(`uniform lowp float u_device_pixel_ratio;varying vec2 v_width2;varying vec2 v_normal;varying float v_gamma_scale;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);gl_FragColor=color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
attribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform vec2 u_units_to_pixels;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_gamma_scale;varying highp float v_linesofar;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;v_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*2.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;v_width2=vec2(outset,inset);}`),da=Br(`uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;varying vec2 v_width2;varying vec2 v_normal;varying float v_gamma_scale;varying highp vec2 v_uv;
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);vec4 color=texture2D(u_image,v_uv);gl_FragColor=color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
attribute vec2 a_pos_normal;attribute vec4 a_data;attribute float a_uv_x;attribute float a_split_index;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_units_to_pixels;uniform float u_image_height;varying vec2 v_normal;varying vec2 v_width2;varying float v_gamma_scale;varying highp vec2 v_uv;
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;highp float texel_height=1.0/u_image_height;highp float half_texel_height=0.5*texel_height;v_uv=vec2(a_uv_x,a_split_index*texel_height-half_texel_height);vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;v_width2=vec2(outset,inset);}`),Ko=Br(`uniform lowp float u_device_pixel_ratio;uniform vec2 u_texsize;uniform float u_fade;uniform mediump vec3 u_scale;uniform sampler2D u_image;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;vec2 pattern_size_a=vec2(display_size_a.x*fromScale/tileZoomRatio,display_size_a.y);vec2 pattern_size_b=vec2(display_size_b.x*toScale/tileZoomRatio,display_size_b.y);float aspect_a=display_size_a.y/v_width;float aspect_b=display_size_b.y/v_width;float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float x_a=mod(v_linesofar/pattern_size_a.x*aspect_a,1.0);float x_b=mod(v_linesofar/pattern_size_b.x*aspect_b,1.0);float y=0.5*v_normal.y+0.5;vec2 texel_size=1.0/u_texsize;vec2 pos_a=mix(pattern_tl_a*texel_size-texel_size,pattern_br_a*texel_size+texel_size,vec2(x_a,y));vec2 pos_b=mix(pattern_tl_b*texel_size-texel_size,pattern_br_b*texel_size+texel_size,vec2(x_b,y));vec4 color=mix(texture2D(u_image,pos_a),texture2D(u_image,pos_b),u_fade);gl_FragColor=color*alpha*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
#define LINE_DISTANCE_SCALE 2.0
attribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform vec2 u_units_to_pixels;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;v_linesofar=a_linesofar;v_width2=vec2(outset,inset);v_width=floorwidth;}`),ma=Br(`uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;uniform float u_sdfgamma;uniform float u_mix;varying vec2 v_normal;varying vec2 v_width2;varying vec2 v_tex_a;varying vec2 v_tex_b;varying float v_gamma_scale;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float sdfdist_a=texture2D(u_image,v_tex_a).a;float sdfdist_b=texture2D(u_image,v_tex_b).a;float sdfdist=mix(sdfdist_a,sdfdist_b,u_mix);alpha*=smoothstep(0.5-u_sdfgamma/floorwidth,0.5+u_sdfgamma/floorwidth,sdfdist);gl_FragColor=color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
#define LINE_DISTANCE_SCALE 2.0
attribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_patternscale_a;uniform float u_tex_y_a;uniform vec2 u_patternscale_b;uniform float u_tex_y_b;uniform vec2 u_units_to_pixels;varying vec2 v_normal;varying vec2 v_width2;varying vec2 v_tex_a;varying vec2 v_tex_b;varying float v_gamma_scale;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;v_tex_a=vec2(a_linesofar*u_patternscale_a.x/floorwidth,normal.y*u_patternscale_a.y+u_tex_y_a);v_tex_b=vec2(a_linesofar*u_patternscale_b.x/floorwidth,normal.y*u_patternscale_b.y+u_tex_y_b);v_width2=vec2(outset,inset);}`),ya=Br(`uniform float u_fade_t;uniform float u_opacity;uniform sampler2D u_image0;uniform sampler2D u_image1;varying vec2 v_pos0;varying vec2 v_pos1;uniform float u_brightness_low;uniform float u_brightness_high;uniform float u_saturation_factor;uniform float u_contrast_factor;uniform vec3 u_spin_weights;void main() {vec4 color0=texture2D(u_image0,v_pos0);vec4 color1=texture2D(u_image1,v_pos1);if (color0.a > 0.0) {color0.rgb=color0.rgb/color0.a;}if (color1.a > 0.0) {color1.rgb=color1.rgb/color1.a;}vec4 color=mix(color0,color1,u_fade_t);color.a*=u_opacity;vec3 rgb=color.rgb;rgb=vec3(dot(rgb,u_spin_weights.xyz),dot(rgb,u_spin_weights.zxy),dot(rgb,u_spin_weights.yzx));float average=(color.r+color.g+color.b)/3.0;rgb+=(average-rgb)*u_saturation_factor;rgb=(rgb-0.5)*u_contrast_factor+0.5;vec3 u_high_vec=vec3(u_brightness_low,u_brightness_low,u_brightness_low);vec3 u_low_vec=vec3(u_brightness_high,u_brightness_high,u_brightness_high);gl_FragColor=vec4(mix(u_high_vec,u_low_vec,rgb)*color.a,color.a);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_tl_parent;uniform float u_scale_parent;uniform float u_buffer_scale;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos0;varying vec2 v_pos1;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos0=(((a_texture_pos/8192.0)-0.5)/u_buffer_scale )+0.5;v_pos1=(v_pos0*u_scale_parent)+u_tl_parent;}"),Xo=Br(`uniform sampler2D u_texture;varying vec2 v_tex;varying float v_fade_opacity;
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float opacity
lowp float alpha=opacity*v_fade_opacity;gl_FragColor=texture2D(u_texture,v_tex)*alpha;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`const float PI=3.141592653589793;attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec4 a_pixeloffset;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform highp float u_camera_to_center_distance;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform float u_fade_change;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform vec2 u_texsize;varying vec2 v_tex;varying float v_fade_opacity;
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float opacity
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;vec2 a_minFontScale=a_pixeloffset.zw/256.0;highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec4 projectedPoint=u_matrix*vec4(a_pos,0,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),0,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,0.0,1.0);gl_Position=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*max(a_minFontScale,fontScale)+a_pxoffset/16.0),0.0,1.0);v_tex=a_tex/u_texsize;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;v_fade_opacity=max(0.0,min(1.0,fade_opacity[0]+fade_change));}`),nc=Br(`#define SDF_PX 8.0
uniform bool u_is_halo;uniform sampler2D u_texture;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;uniform bool u_is_text;varying vec2 v_data0;varying vec3 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
float EDGE_GAMMA=0.105/u_device_pixel_ratio;vec2 tex=v_data0.xy;float gamma_scale=v_data1.x;float size=v_data1.y;float fade_opacity=v_data1[2];float fontScale=u_is_text ? size/24.0 : size;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);gl_FragColor=color*(alpha*opacity*fade_opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`const float PI=3.141592653589793;attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec4 a_pixeloffset;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;varying vec2 v_data0;varying vec3 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec4 projectedPoint=u_matrix*vec4(a_pos,0,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),0,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,0.0,1.0);gl_Position=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale+a_pxoffset),0.0,1.0);float gamma_scale=gl_Position.w;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(1.0,fade_opacity[0]+fade_change));v_data0=a_tex/u_texsize;v_data1=vec3(gamma_scale,size,interpolated_fade_opacity);}`),oc=Br(`#define SDF_PX 8.0
#define SDF 1.0
#define ICON 0.0
uniform bool u_is_halo;uniform sampler2D u_texture;uniform sampler2D u_texture_icon;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;varying vec4 v_data0;varying vec4 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
float fade_opacity=v_data1[2];if (v_data1.w==ICON) {vec2 tex_icon=v_data0.zw;lowp float alpha=opacity*fade_opacity;gl_FragColor=texture2D(u_texture_icon,tex_icon)*alpha;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
return;}vec2 tex=v_data0.xy;float EDGE_GAMMA=0.105/u_device_pixel_ratio;float gamma_scale=v_data1.x;float size=v_data1.y;float fontScale=size/24.0;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);gl_FragColor=color*(alpha*opacity*fade_opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`const float PI=3.141592653589793;attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec2 u_texsize_icon;varying vec4 v_data0;varying vec4 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);float is_sdf=a_size[0]-2.0*a_size_min;highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec4 projectedPoint=u_matrix*vec4(a_pos,0,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=size/24.0;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),0,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,0.0,1.0);gl_Position=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale),0.0,1.0);float gamma_scale=gl_Position.w;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(1.0,fade_opacity[0]+fade_change));v_data0.xy=a_tex/u_texsize;v_data0.zw=a_tex/u_texsize_icon;v_data1=vec4(gamma_scale,size,interpolated_fade_opacity,is_sdf);}`);function Br(n,s){var a=/#pragma mapbox: ([\w]+) ([\w]+) ([\w]+) ([\w]+)/g,u=s.match(/attribute ([\w]+) ([\w]+)/g),y=n.match(/uniform ([\w]+) ([\w]+)([\s]*)([\w]*)/g),w=s.match(/uniform ([\w]+) ([\w]+)([\s]*)([\w]*)/g),k=w?w.concat(y):y,E={};return{fragmentSource:n=n.replace(a,function(P,O,Z,G,K){return E[K]=!0,O==="define"?`
#ifndef HAS_UNIFORM_u_`+K+`
varying `+Z+" "+G+" "+K+`;
#else
uniform `+Z+" "+G+" u_"+K+`;
#endif
`:`
#ifdef HAS_UNIFORM_u_`+K+`
    `+Z+" "+G+" "+K+" = u_"+K+`;
#endif
`}),vertexSource:s=s.replace(a,function(P,O,Z,G,K){var re=G==="float"?"vec2":"vec4",te=K.match(/color/)?"color":re;return E[K]?O==="define"?`
#ifndef HAS_UNIFORM_u_`+K+`
uniform lowp float u_`+K+`_t;
attribute `+Z+" "+re+" a_"+K+`;
varying `+Z+" "+G+" "+K+`;
#else
uniform `+Z+" "+G+" u_"+K+`;
#endif
`:te==="vec4"?`
#ifndef HAS_UNIFORM_u_`+K+`
    `+K+" = a_"+K+`;
#else
    `+Z+" "+G+" "+K+" = u_"+K+`;
#endif
`:`
#ifndef HAS_UNIFORM_u_`+K+`
    `+K+" = unpack_mix_"+te+"(a_"+K+", u_"+K+`_t);
#else
    `+Z+" "+G+" "+K+" = u_"+K+`;
#endif
`:O==="define"?`
#ifndef HAS_UNIFORM_u_`+K+`
uniform lowp float u_`+K+`_t;
attribute `+Z+" "+re+" a_"+K+`;
#else
uniform `+Z+" "+G+" u_"+K+`;
#endif
`:te==="vec4"?`
#ifndef HAS_UNIFORM_u_`+K+`
    `+Z+" "+G+" "+K+" = a_"+K+`;
#else
    `+Z+" "+G+" "+K+" = u_"+K+`;
#endif
`:`
#ifndef HAS_UNIFORM_u_`+K+`
    `+Z+" "+G+" "+K+" = unpack_mix_"+te+"(a_"+K+", u_"+K+`_t);
#else
    `+Z+" "+G+" "+K+" = u_"+K+`;
#endif
`}),staticAttributes:u,staticUniforms:k}}var Uh=Object.freeze({__proto__:null,prelude:Fa,background:ec,backgroundPattern:Oh,circle:Fh,clippingMask:Ol,heatmap:Fl,heatmapTexture:Nl,collisionBox:Ul,collisionCircle:tc,debug:rc,fill:Nh,fillOutline:as,fillOutlinePattern:ss,fillPattern:ic,fillExtrusion:en,fillExtrusionPattern:Vl,hillshadePrepare:Zo,hillshade:Go,line:fa,lineGradient:da,linePattern:Ko,lineSDF:ma,raster:ya,symbolIcon:Xo,symbolSDF:nc,symbolTextAndIcon:oc}),Fs=function(){this.boundProgram=null,this.boundLayoutVertexBuffer=null,this.boundPaintVertexBuffers=[],this.boundIndexBuffer=null,this.boundVertexOffset=null,this.boundDynamicVertexBuffer=null,this.vao=null};function ac(n){for(var s=[],a=0;a<n.length;a++)if(n[a]!==null){var u=n[a].split(" ");s.push(u.pop())}return s}Fs.prototype.bind=function(n,s,a,u,y,w,k,E){this.context=n;for(var P=this.boundPaintVertexBuffers.length!==u.length,O=0;!P&&O<u.length;O++)this.boundPaintVertexBuffers[O]!==u[O]&&(P=!0);n.extVertexArrayObject&&this.vao&&this.boundProgram===s&&this.boundLayoutVertexBuffer===a&&!P&&this.boundIndexBuffer===y&&this.boundVertexOffset===w&&this.boundDynamicVertexBuffer===k&&this.boundDynamicVertexBuffer2===E?(n.bindVertexArrayOES.set(this.vao),k&&k.bind(),y&&y.dynamicDraw&&y.bind(),E&&E.bind()):this.freshBind(s,a,u,y,w,k,E)},Fs.prototype.freshBind=function(n,s,a,u,y,w,k){var E,P=n.numAttributes,O=this.context,Z=O.gl;if(O.extVertexArrayObject)this.vao&&this.destroy(),this.vao=O.extVertexArrayObject.createVertexArrayOES(),O.bindVertexArrayOES.set(this.vao),E=0,this.boundProgram=n,this.boundLayoutVertexBuffer=s,this.boundPaintVertexBuffers=a,this.boundIndexBuffer=u,this.boundVertexOffset=y,this.boundDynamicVertexBuffer=w,this.boundDynamicVertexBuffer2=k;else{E=O.currentNumAttributes||0;for(var G=P;G<E;G++)Z.disableVertexAttribArray(G)}s.enableAttributes(Z,n);for(var K=0,re=a;K<re.length;K+=1)re[K].enableAttributes(Z,n);w&&w.enableAttributes(Z,n),k&&k.enableAttributes(Z,n),s.bind(),s.setVertexAttribPointers(Z,n,y);for(var te=0,ue=a;te<ue.length;te+=1){var Y=ue[te];Y.bind(),Y.setVertexAttribPointers(Z,n,y)}w&&(w.bind(),w.setVertexAttribPointers(Z,n,y)),u&&u.bind(),k&&(k.bind(),k.setVertexAttribPointers(Z,n,y)),O.currentNumAttributes=P},Fs.prototype.destroy=function(){this.vao&&(this.context.extVertexArrayObject.deleteVertexArrayOES(this.vao),this.vao=null)};var sc=function(n,s,a,u,y,w){var k=n.gl;this.program=k.createProgram();for(var E=ac(a.staticAttributes),P=u?u.getBinderAttributes():[],O=E.concat(P),Z=a.staticUniforms?ac(a.staticUniforms):[],G=u?u.getBinderUniforms():[],K=[],re=0,te=Z.concat(G);re<te.length;re+=1){var ue=te[re];K.indexOf(ue)<0&&K.push(ue)}var Y=u?u.defines():[];w&&Y.push("#define OVERDRAW_INSPECTOR;");var le=Y.concat(Fa.fragmentSource,a.fragmentSource).join(`
`),fe=Y.concat(Fa.vertexSource,a.vertexSource).join(`
`),ge=k.createShader(k.FRAGMENT_SHADER);if(k.isContextLost())this.failedToCreate=!0;else{k.shaderSource(ge,le),k.compileShader(ge),k.attachShader(this.program,ge);var ze=k.createShader(k.VERTEX_SHADER);if(k.isContextLost())this.failedToCreate=!0;else{k.shaderSource(ze,fe),k.compileShader(ze),k.attachShader(this.program,ze),this.attributes={};var Ee={};this.numAttributes=O.length;for(var Ae=0;Ae<this.numAttributes;Ae++)O[Ae]&&(k.bindAttribLocation(this.program,Ae,O[Ae]),this.attributes[O[Ae]]=Ae);k.linkProgram(this.program),k.deleteShader(ze),k.deleteShader(ge);for(var De=0;De<K.length;De++){var Ke=K[De];if(Ke&&!Ee[Ke]){var Ze=k.getUniformLocation(this.program,Ke);Ze&&(Ee[Ke]=Ze)}}this.fixedUniforms=y(n,Ee),this.binderUniforms=u?u.getUniforms(n,Ee):[]}}};function lc(n,s,a){var u=1/Lr(a,1,s.transform.tileZoom),y=Math.pow(2,a.tileID.overscaledZ),w=a.tileSize*Math.pow(2,s.transform.tileZoom)/y,k=w*(a.tileID.canonical.x+a.tileID.wrap*y),E=w*a.tileID.canonical.y;return{u_image:0,u_texsize:a.imageAtlasTexture.size,u_scale:[u,n.fromScale,n.toScale],u_fade:n.t,u_pixel_coord_upper:[k>>16,E>>16],u_pixel_coord_lower:[65535&k,65535&E]}}sc.prototype.draw=function(n,s,a,u,y,w,k,E,P,O,Z,G,K,re,te,ue){var Y,le=n.gl;if(!this.failedToCreate){for(var fe in n.program.set(this.program),n.setDepthMode(a),n.setStencilMode(u),n.setColorMode(y),n.setCullFace(w),this.fixedUniforms)this.fixedUniforms[fe].set(k[fe]);re&&re.setUniforms(n,this.binderUniforms,G,{zoom:K});for(var ge=(Y={},Y[le.LINES]=2,Y[le.TRIANGLES]=3,Y[le.LINE_STRIP]=1,Y)[s],ze=0,Ee=Z.get();ze<Ee.length;ze+=1){var Ae=Ee[ze],De=Ae.vaos||(Ae.vaos={});(De[E]||(De[E]=new Fs)).bind(n,this,P,re?re.getPaintVertexBuffers():[],O,Ae.vertexOffset,te,ue),le.drawElements(s,Ae.primitiveLength*ge,le.UNSIGNED_SHORT,Ae.primitiveOffset*ge*2)}}};var uc=function(n,s,a,u){var y=s.style.light,w=y.properties.get("position"),k=[w.x,w.y,w.z],E=o.create$1();y.properties.get("anchor")==="viewport"&&o.fromRotation(E,-s.transform.angle),o.transformMat3(k,k,E);var P=y.properties.get("color");return{u_matrix:n,u_lightpos:k,u_lightintensity:y.properties.get("intensity"),u_lightcolor:[P.r,P.g,P.b],u_vertical_gradient:+a,u_opacity:u}},_a=function(n,s,a,u,y,w,k){return o.extend(uc(n,s,a,u),lc(w,s,k),{u_height_factor:-Math.pow(2,y.overscaledZ)/k.tileSize/8})},Wo=function(n){return{u_matrix:n}},ga=function(n,s,a,u){return o.extend(Wo(n),lc(a,s,u))},cc=function(n,s){return{u_matrix:n,u_world:s}},hc=function(n,s,a,u,y){return o.extend(ga(n,s,a,u),{u_world:y})},jl=function(n,s,a,u){var y,w,k=n.transform;if(u.paint.get("circle-pitch-alignment")==="map"){var E=Lr(a,1,k.zoom);y=!0,w=[E,E]}else y=!1,w=k.pixelsToGLUnits;return{u_camera_to_center_distance:k.cameraToCenterDistance,u_scale_with_map:+(u.paint.get("circle-pitch-scale")==="map"),u_matrix:n.translatePosMatrix(s.posMatrix,a,u.paint.get("circle-translate"),u.paint.get("circle-translate-anchor")),u_pitch_with_map:+y,u_device_pixel_ratio:o.browser.devicePixelRatio,u_extrude_scale:w}},va=function(n,s,a){var u=Lr(a,1,s.zoom),y=Math.pow(2,s.zoom-a.tileID.overscaledZ),w=a.tileID.overscaleFactor();return{u_matrix:n,u_camera_to_center_distance:s.cameraToCenterDistance,u_pixels_to_tile_units:u,u_extrude_scale:[s.pixelsToGLUnits[0]/(u*y),s.pixelsToGLUnits[1]/(u*y)],u_overscale_factor:w}},pc=function(n,s,a){return{u_matrix:n,u_inv_matrix:s,u_camera_to_center_distance:a.cameraToCenterDistance,u_viewport_size:[a.width,a.height]}},ba=function(n,s,a){return a===void 0&&(a=1),{u_matrix:n,u_color:s,u_overlay:0,u_overlay_scale:a}},xa=function(n){return{u_matrix:n}},fc=function(n,s,a,u){return{u_matrix:n,u_extrude_scale:Lr(s,1,a),u_intensity:u}},ls=function(n,s,a){var u=n.transform;return{u_matrix:dc(n,s,a),u_ratio:1/Lr(s,1,u.zoom),u_device_pixel_ratio:o.browser.devicePixelRatio,u_units_to_pixels:[1/u.pixelsToGLUnits[0],1/u.pixelsToGLUnits[1]]}},Vr=function(n,s,a,u){return o.extend(ls(n,s,a),{u_image:0,u_image_height:u})},Ns=function(n,s,a,u){var y=n.transform,w=Na(s,y);return{u_matrix:dc(n,s,a),u_texsize:s.imageAtlasTexture.size,u_ratio:1/Lr(s,1,y.zoom),u_device_pixel_ratio:o.browser.devicePixelRatio,u_image:0,u_scale:[w,u.fromScale,u.toScale],u_fade:u.t,u_units_to_pixels:[1/y.pixelsToGLUnits[0],1/y.pixelsToGLUnits[1]]}},Vh=function(n,s,a,u,y){var w=n.lineAtlas,k=Na(s,n.transform),E=a.layout.get("line-cap")==="round",P=w.getDash(u.from,E),O=w.getDash(u.to,E),Z=P.width*y.fromScale,G=O.width*y.toScale;return o.extend(ls(n,s,a),{u_patternscale_a:[k/Z,-P.height/2],u_patternscale_b:[k/G,-O.height/2],u_sdfgamma:w.width/(256*Math.min(Z,G)*o.browser.devicePixelRatio)/2,u_image:0,u_tex_y_a:P.y,u_tex_y_b:O.y,u_mix:y.t})};function Na(n,s){return 1/Lr(n,1,s.tileZoom)}function dc(n,s,a){return n.translatePosMatrix(s.tileID.posMatrix,s,a.paint.get("line-translate"),a.paint.get("line-translate-anchor"))}var jh=function(n,s,a,u,y){return{u_matrix:n,u_tl_parent:s,u_scale_parent:a,u_buffer_scale:1,u_fade_t:u.mix,u_opacity:u.opacity*y.paint.get("raster-opacity"),u_image0:0,u_image1:1,u_brightness_low:y.paint.get("raster-brightness-min"),u_brightness_high:y.paint.get("raster-brightness-max"),u_saturation_factor:(k=y.paint.get("raster-saturation"),k>0?1-1/(1.001-k):-k),u_contrast_factor:(w=y.paint.get("raster-contrast"),w>0?1/(1-w):1+w),u_spin_weights:mc(y.paint.get("raster-hue-rotate"))};var w,k};function mc(n){n*=Math.PI/180;var s=Math.sin(n),a=Math.cos(n);return[(2*a+1)/3,(-Math.sqrt(3)*s-a+1)/3,(Math.sqrt(3)*s-a+1)/3]}var Us,Ua=function(n,s,a,u,y,w,k,E,P,O){var Z=y.transform;return{u_is_size_zoom_constant:+(n==="constant"||n==="source"),u_is_size_feature_constant:+(n==="constant"||n==="camera"),u_size_t:s?s.uSizeT:0,u_size:s?s.uSize:0,u_camera_to_center_distance:Z.cameraToCenterDistance,u_pitch:Z.pitch/360*2*Math.PI,u_rotate_symbol:+a,u_aspect_ratio:Z.width/Z.height,u_fade_change:y.options.fadeDuration?y.symbolFadeChange:1,u_matrix:w,u_label_plane_matrix:k,u_coord_matrix:E,u_is_text:+P,u_pitch_with_map:+u,u_texsize:O,u_texture:0}},us=function(n,s,a,u,y,w,k,E,P,O,Z){var G=y.transform;return o.extend(Ua(n,s,a,u,y,w,k,E,P,O),{u_gamma_scale:u?Math.cos(G._pitch)*G.cameraToCenterDistance:1,u_device_pixel_ratio:o.browser.devicePixelRatio,u_is_halo:+Z})},Vs=function(n,s,a,u,y,w,k,E,P,O){return o.extend(us(n,s,a,u,y,w,k,E,!0,P,!0),{u_texsize_icon:O,u_texture_icon:1})},cs=function(n,s,a){return{u_matrix:n,u_opacity:s,u_color:a}},Va=function(n,s,a,u,y,w){return o.extend(function(k,E,P,O){var Z=P.imageManager.getPattern(k.from.toString()),G=P.imageManager.getPattern(k.to.toString()),K=P.imageManager.getPixelSize(),re=K.width,te=K.height,ue=Math.pow(2,O.tileID.overscaledZ),Y=O.tileSize*Math.pow(2,P.transform.tileZoom)/ue,le=Y*(O.tileID.canonical.x+O.tileID.wrap*ue),fe=Y*O.tileID.canonical.y;return{u_image:0,u_pattern_tl_a:Z.tl,u_pattern_br_a:Z.br,u_pattern_tl_b:G.tl,u_pattern_br_b:G.br,u_texsize:[re,te],u_mix:E.t,u_pattern_size_a:Z.displaySize,u_pattern_size_b:G.displaySize,u_scale_a:E.fromScale,u_scale_b:E.toScale,u_tile_units_to_pixels:1/Lr(O,1,P.transform.tileZoom),u_pixel_coord_upper:[le>>16,fe>>16],u_pixel_coord_lower:[65535&le,65535&fe]}}(u,w,a,y),{u_matrix:n,u_opacity:s})},yc={fillExtrusion:function(n,s){return{u_matrix:new o.UniformMatrix4f(n,s.u_matrix),u_lightpos:new o.Uniform3f(n,s.u_lightpos),u_lightintensity:new o.Uniform1f(n,s.u_lightintensity),u_lightcolor:new o.Uniform3f(n,s.u_lightcolor),u_vertical_gradient:new o.Uniform1f(n,s.u_vertical_gradient),u_opacity:new o.Uniform1f(n,s.u_opacity)}},fillExtrusionPattern:function(n,s){return{u_matrix:new o.UniformMatrix4f(n,s.u_matrix),u_lightpos:new o.Uniform3f(n,s.u_lightpos),u_lightintensity:new o.Uniform1f(n,s.u_lightintensity),u_lightcolor:new o.Uniform3f(n,s.u_lightcolor),u_vertical_gradient:new o.Uniform1f(n,s.u_vertical_gradient),u_height_factor:new o.Uniform1f(n,s.u_height_factor),u_image:new o.Uniform1i(n,s.u_image),u_texsize:new o.Uniform2f(n,s.u_texsize),u_pixel_coord_upper:new o.Uniform2f(n,s.u_pixel_coord_upper),u_pixel_coord_lower:new o.Uniform2f(n,s.u_pixel_coord_lower),u_scale:new o.Uniform3f(n,s.u_scale),u_fade:new o.Uniform1f(n,s.u_fade),u_opacity:new o.Uniform1f(n,s.u_opacity)}},fill:function(n,s){return{u_matrix:new o.UniformMatrix4f(n,s.u_matrix)}},fillPattern:function(n,s){return{u_matrix:new o.UniformMatrix4f(n,s.u_matrix),u_image:new o.Uniform1i(n,s.u_image),u_texsize:new o.Uniform2f(n,s.u_texsize),u_pixel_coord_upper:new o.Uniform2f(n,s.u_pixel_coord_upper),u_pixel_coord_lower:new o.Uniform2f(n,s.u_pixel_coord_lower),u_scale:new o.Uniform3f(n,s.u_scale),u_fade:new o.Uniform1f(n,s.u_fade)}},fillOutline:function(n,s){return{u_matrix:new o.UniformMatrix4f(n,s.u_matrix),u_world:new o.Uniform2f(n,s.u_world)}},fillOutlinePattern:function(n,s){return{u_matrix:new o.UniformMatrix4f(n,s.u_matrix),u_world:new o.Uniform2f(n,s.u_world),u_image:new o.Uniform1i(n,s.u_image),u_texsize:new o.Uniform2f(n,s.u_texsize),u_pixel_coord_upper:new o.Uniform2f(n,s.u_pixel_coord_upper),u_pixel_coord_lower:new o.Uniform2f(n,s.u_pixel_coord_lower),u_scale:new o.Uniform3f(n,s.u_scale),u_fade:new o.Uniform1f(n,s.u_fade)}},circle:function(n,s){return{u_camera_to_center_distance:new o.Uniform1f(n,s.u_camera_to_center_distance),u_scale_with_map:new o.Uniform1i(n,s.u_scale_with_map),u_pitch_with_map:new o.Uniform1i(n,s.u_pitch_with_map),u_extrude_scale:new o.Uniform2f(n,s.u_extrude_scale),u_device_pixel_ratio:new o.Uniform1f(n,s.u_device_pixel_ratio),u_matrix:new o.UniformMatrix4f(n,s.u_matrix)}},collisionBox:function(n,s){return{u_matrix:new o.UniformMatrix4f(n,s.u_matrix),u_camera_to_center_distance:new o.Uniform1f(n,s.u_camera_to_center_distance),u_pixels_to_tile_units:new o.Uniform1f(n,s.u_pixels_to_tile_units),u_extrude_scale:new o.Uniform2f(n,s.u_extrude_scale),u_overscale_factor:new o.Uniform1f(n,s.u_overscale_factor)}},collisionCircle:function(n,s){return{u_matrix:new o.UniformMatrix4f(n,s.u_matrix),u_inv_matrix:new o.UniformMatrix4f(n,s.u_inv_matrix),u_camera_to_center_distance:new o.Uniform1f(n,s.u_camera_to_center_distance),u_viewport_size:new o.Uniform2f(n,s.u_viewport_size)}},debug:function(n,s){return{u_color:new o.UniformColor(n,s.u_color),u_matrix:new o.UniformMatrix4f(n,s.u_matrix),u_overlay:new o.Uniform1i(n,s.u_overlay),u_overlay_scale:new o.Uniform1f(n,s.u_overlay_scale)}},clippingMask:function(n,s){return{u_matrix:new o.UniformMatrix4f(n,s.u_matrix)}},heatmap:function(n,s){return{u_extrude_scale:new o.Uniform1f(n,s.u_extrude_scale),u_intensity:new o.Uniform1f(n,s.u_intensity),u_matrix:new o.UniformMatrix4f(n,s.u_matrix)}},heatmapTexture:function(n,s){return{u_matrix:new o.UniformMatrix4f(n,s.u_matrix),u_world:new o.Uniform2f(n,s.u_world),u_image:new o.Uniform1i(n,s.u_image),u_color_ramp:new o.Uniform1i(n,s.u_color_ramp),u_opacity:new o.Uniform1f(n,s.u_opacity)}},hillshade:function(n,s){return{u_matrix:new o.UniformMatrix4f(n,s.u_matrix),u_image:new o.Uniform1i(n,s.u_image),u_latrange:new o.Uniform2f(n,s.u_latrange),u_light:new o.Uniform2f(n,s.u_light),u_shadow:new o.UniformColor(n,s.u_shadow),u_highlight:new o.UniformColor(n,s.u_highlight),u_accent:new o.UniformColor(n,s.u_accent)}},hillshadePrepare:function(n,s){return{u_matrix:new o.UniformMatrix4f(n,s.u_matrix),u_image:new o.Uniform1i(n,s.u_image),u_dimension:new o.Uniform2f(n,s.u_dimension),u_zoom:new o.Uniform1f(n,s.u_zoom),u_unpack:new o.Uniform4f(n,s.u_unpack)}},line:function(n,s){return{u_matrix:new o.UniformMatrix4f(n,s.u_matrix),u_ratio:new o.Uniform1f(n,s.u_ratio),u_device_pixel_ratio:new o.Uniform1f(n,s.u_device_pixel_ratio),u_units_to_pixels:new o.Uniform2f(n,s.u_units_to_pixels)}},lineGradient:function(n,s){return{u_matrix:new o.UniformMatrix4f(n,s.u_matrix),u_ratio:new o.Uniform1f(n,s.u_ratio),u_device_pixel_ratio:new o.Uniform1f(n,s.u_device_pixel_ratio),u_units_to_pixels:new o.Uniform2f(n,s.u_units_to_pixels),u_image:new o.Uniform1i(n,s.u_image),u_image_height:new o.Uniform1f(n,s.u_image_height)}},linePattern:function(n,s){return{u_matrix:new o.UniformMatrix4f(n,s.u_matrix),u_texsize:new o.Uniform2f(n,s.u_texsize),u_ratio:new o.Uniform1f(n,s.u_ratio),u_device_pixel_ratio:new o.Uniform1f(n,s.u_device_pixel_ratio),u_image:new o.Uniform1i(n,s.u_image),u_units_to_pixels:new o.Uniform2f(n,s.u_units_to_pixels),u_scale:new o.Uniform3f(n,s.u_scale),u_fade:new o.Uniform1f(n,s.u_fade)}},lineSDF:function(n,s){return{u_matrix:new o.UniformMatrix4f(n,s.u_matrix),u_ratio:new o.Uniform1f(n,s.u_ratio),u_device_pixel_ratio:new o.Uniform1f(n,s.u_device_pixel_ratio),u_units_to_pixels:new o.Uniform2f(n,s.u_units_to_pixels),u_patternscale_a:new o.Uniform2f(n,s.u_patternscale_a),u_patternscale_b:new o.Uniform2f(n,s.u_patternscale_b),u_sdfgamma:new o.Uniform1f(n,s.u_sdfgamma),u_image:new o.Uniform1i(n,s.u_image),u_tex_y_a:new o.Uniform1f(n,s.u_tex_y_a),u_tex_y_b:new o.Uniform1f(n,s.u_tex_y_b),u_mix:new o.Uniform1f(n,s.u_mix)}},raster:function(n,s){return{u_matrix:new o.UniformMatrix4f(n,s.u_matrix),u_tl_parent:new o.Uniform2f(n,s.u_tl_parent),u_scale_parent:new o.Uniform1f(n,s.u_scale_parent),u_buffer_scale:new o.Uniform1f(n,s.u_buffer_scale),u_fade_t:new o.Uniform1f(n,s.u_fade_t),u_opacity:new o.Uniform1f(n,s.u_opacity),u_image0:new o.Uniform1i(n,s.u_image0),u_image1:new o.Uniform1i(n,s.u_image1),u_brightness_low:new o.Uniform1f(n,s.u_brightness_low),u_brightness_high:new o.Uniform1f(n,s.u_brightness_high),u_saturation_factor:new o.Uniform1f(n,s.u_saturation_factor),u_contrast_factor:new o.Uniform1f(n,s.u_contrast_factor),u_spin_weights:new o.Uniform3f(n,s.u_spin_weights)}},symbolIcon:function(n,s){return{u_is_size_zoom_constant:new o.Uniform1i(n,s.u_is_size_zoom_constant),u_is_size_feature_constant:new o.Uniform1i(n,s.u_is_size_feature_constant),u_size_t:new o.Uniform1f(n,s.u_size_t),u_size:new o.Uniform1f(n,s.u_size),u_camera_to_center_distance:new o.Uniform1f(n,s.u_camera_to_center_distance),u_pitch:new o.Uniform1f(n,s.u_pitch),u_rotate_symbol:new o.Uniform1i(n,s.u_rotate_symbol),u_aspect_ratio:new o.Uniform1f(n,s.u_aspect_ratio),u_fade_change:new o.Uniform1f(n,s.u_fade_change),u_matrix:new o.UniformMatrix4f(n,s.u_matrix),u_label_plane_matrix:new o.UniformMatrix4f(n,s.u_label_plane_matrix),u_coord_matrix:new o.UniformMatrix4f(n,s.u_coord_matrix),u_is_text:new o.Uniform1i(n,s.u_is_text),u_pitch_with_map:new o.Uniform1i(n,s.u_pitch_with_map),u_texsize:new o.Uniform2f(n,s.u_texsize),u_texture:new o.Uniform1i(n,s.u_texture)}},symbolSDF:function(n,s){return{u_is_size_zoom_constant:new o.Uniform1i(n,s.u_is_size_zoom_constant),u_is_size_feature_constant:new o.Uniform1i(n,s.u_is_size_feature_constant),u_size_t:new o.Uniform1f(n,s.u_size_t),u_size:new o.Uniform1f(n,s.u_size),u_camera_to_center_distance:new o.Uniform1f(n,s.u_camera_to_center_distance),u_pitch:new o.Uniform1f(n,s.u_pitch),u_rotate_symbol:new o.Uniform1i(n,s.u_rotate_symbol),u_aspect_ratio:new o.Uniform1f(n,s.u_aspect_ratio),u_fade_change:new o.Uniform1f(n,s.u_fade_change),u_matrix:new o.UniformMatrix4f(n,s.u_matrix),u_label_plane_matrix:new o.UniformMatrix4f(n,s.u_label_plane_matrix),u_coord_matrix:new o.UniformMatrix4f(n,s.u_coord_matrix),u_is_text:new o.Uniform1i(n,s.u_is_text),u_pitch_with_map:new o.Uniform1i(n,s.u_pitch_with_map),u_texsize:new o.Uniform2f(n,s.u_texsize),u_texture:new o.Uniform1i(n,s.u_texture),u_gamma_scale:new o.Uniform1f(n,s.u_gamma_scale),u_device_pixel_ratio:new o.Uniform1f(n,s.u_device_pixel_ratio),u_is_halo:new o.Uniform1i(n,s.u_is_halo)}},symbolTextAndIcon:function(n,s){return{u_is_size_zoom_constant:new o.Uniform1i(n,s.u_is_size_zoom_constant),u_is_size_feature_constant:new o.Uniform1i(n,s.u_is_size_feature_constant),u_size_t:new o.Uniform1f(n,s.u_size_t),u_size:new o.Uniform1f(n,s.u_size),u_camera_to_center_distance:new o.Uniform1f(n,s.u_camera_to_center_distance),u_pitch:new o.Uniform1f(n,s.u_pitch),u_rotate_symbol:new o.Uniform1i(n,s.u_rotate_symbol),u_aspect_ratio:new o.Uniform1f(n,s.u_aspect_ratio),u_fade_change:new o.Uniform1f(n,s.u_fade_change),u_matrix:new o.UniformMatrix4f(n,s.u_matrix),u_label_plane_matrix:new o.UniformMatrix4f(n,s.u_label_plane_matrix),u_coord_matrix:new o.UniformMatrix4f(n,s.u_coord_matrix),u_is_text:new o.Uniform1i(n,s.u_is_text),u_pitch_with_map:new o.Uniform1i(n,s.u_pitch_with_map),u_texsize:new o.Uniform2f(n,s.u_texsize),u_texsize_icon:new o.Uniform2f(n,s.u_texsize_icon),u_texture:new o.Uniform1i(n,s.u_texture),u_texture_icon:new o.Uniform1i(n,s.u_texture_icon),u_gamma_scale:new o.Uniform1f(n,s.u_gamma_scale),u_device_pixel_ratio:new o.Uniform1f(n,s.u_device_pixel_ratio),u_is_halo:new o.Uniform1i(n,s.u_is_halo)}},background:function(n,s){return{u_matrix:new o.UniformMatrix4f(n,s.u_matrix),u_opacity:new o.Uniform1f(n,s.u_opacity),u_color:new o.UniformColor(n,s.u_color)}},backgroundPattern:function(n,s){return{u_matrix:new o.UniformMatrix4f(n,s.u_matrix),u_opacity:new o.Uniform1f(n,s.u_opacity),u_image:new o.Uniform1i(n,s.u_image),u_pattern_tl_a:new o.Uniform2f(n,s.u_pattern_tl_a),u_pattern_br_a:new o.Uniform2f(n,s.u_pattern_br_a),u_pattern_tl_b:new o.Uniform2f(n,s.u_pattern_tl_b),u_pattern_br_b:new o.Uniform2f(n,s.u_pattern_br_b),u_texsize:new o.Uniform2f(n,s.u_texsize),u_mix:new o.Uniform1f(n,s.u_mix),u_pattern_size_a:new o.Uniform2f(n,s.u_pattern_size_a),u_pattern_size_b:new o.Uniform2f(n,s.u_pattern_size_b),u_scale_a:new o.Uniform1f(n,s.u_scale_a),u_scale_b:new o.Uniform1f(n,s.u_scale_b),u_pixel_coord_upper:new o.Uniform2f(n,s.u_pixel_coord_upper),u_pixel_coord_lower:new o.Uniform2f(n,s.u_pixel_coord_lower),u_tile_units_to_pixels:new o.Uniform1f(n,s.u_tile_units_to_pixels)}}};function ja(n,s,a,u,y,w,k){for(var E=n.context,P=E.gl,O=n.useProgram("collisionBox"),Z=[],G=0,K=0,re=0;re<u.length;re++){var te=u[re],ue=s.getTile(te),Y=ue.getBucket(a);if(Y){var le=te.posMatrix;y[0]===0&&y[1]===0||(le=n.translatePosMatrix(te.posMatrix,ue,y,w));var fe=k?Y.textCollisionBox:Y.iconCollisionBox,ge=Y.collisionCircleArray;if(ge.length>0){var ze=o.create(),Ee=le;o.mul(ze,Y.placementInvProjMatrix,n.transform.glCoordMatrix),o.mul(ze,ze,Y.placementViewportMatrix),Z.push({circleArray:ge,circleOffset:K,transform:Ee,invTransform:ze}),K=G+=ge.length/4}fe&&O.draw(E,P.LINES,X.disabled,$.disabled,n.colorModeForRenderPass(),pe.disabled,va(le,n.transform,ue),a.id,fe.layoutVertexBuffer,fe.indexBuffer,fe.segments,null,n.transform.zoom,null,null,fe.collisionVertexBuffer)}}if(k&&Z.length){var Ae=n.useProgram("collisionCircle"),De=new o.StructArrayLayout2f1f2i16;De.resize(4*G),De._trim();for(var Ke=0,Ze=0,nt=Z;Ze<nt.length;Ze+=1)for(var vt=nt[Ze],St=0;St<vt.circleArray.length/4;St++){var wt=4*St,_r=vt.circleArray[wt+0],at=vt.circleArray[wt+1],Nt=vt.circleArray[wt+2],Jt=vt.circleArray[wt+3];De.emplace(Ke++,_r,at,Nt,Jt,0),De.emplace(Ke++,_r,at,Nt,Jt,1),De.emplace(Ke++,_r,at,Nt,Jt,2),De.emplace(Ke++,_r,at,Nt,Jt,3)}(!Us||Us.length<2*G)&&(Us=function(si){var cn=2*si,Gi=new o.StructArrayLayout3ui6;Gi.resize(cn),Gi._trim();for(var ri=0;ri<cn;ri++){var fi=6*ri;Gi.uint16[fi+0]=4*ri+0,Gi.uint16[fi+1]=4*ri+1,Gi.uint16[fi+2]=4*ri+2,Gi.uint16[fi+3]=4*ri+2,Gi.uint16[fi+4]=4*ri+3,Gi.uint16[fi+5]=4*ri+0}return Gi}(G));for(var Ot=E.createIndexBuffer(Us,!0),Bt=E.createVertexBuffer(De,o.collisionCircleLayout.members,!0),Wt=0,Rt=Z;Wt<Rt.length;Wt+=1){var Ct=Rt[Wt],Di=pc(Ct.transform,Ct.invTransform,n.transform);Ae.draw(E,P.TRIANGLES,X.disabled,$.disabled,n.colorModeForRenderPass(),pe.disabled,Di,a.id,Bt,Ot,o.SegmentVector.simpleSegment(0,2*Ct.circleOffset,Ct.circleArray.length,Ct.circleArray.length/2),null,n.transform.zoom,null,null,null)}Bt.destroy(),Ot.destroy()}}var po=o.identity(new Float32Array(16));function _c(n,s,a,u,y,w){var k=o.getAnchorAlignment(n),E=-(k.horizontalAlign-.5)*s,P=-(k.verticalAlign-.5)*a,O=o.evaluateVariableOffset(n,u);return new o.Point((E/y+O[0])*w,(P/y+O[1])*w)}function gc(n,s,a,u,y,w,k,E,P,O,Z){var G=n.text.placedSymbolArray,K=n.text.dynamicLayoutVertexArray,re=n.icon.dynamicLayoutVertexArray,te={};K.clear();for(var ue=0;ue<G.length;ue++){var Y=G.get(ue),le=Y.hidden||!Y.crossTileID||n.allowVerticalPlacement&&!Y.placedOrientation?null:u[Y.crossTileID];if(le){var fe=new o.Point(Y.anchorX,Y.anchorY),ge=Gt(fe,a?E:k),ze=tr(w.cameraToCenterDistance,ge.signedDistanceFromCamera),Ee=y.evaluateSizeForFeature(n.textSizeData,O,Y)*ze/o.ONE_EM;a&&(Ee*=n.tilePixelRatio/P);for(var Ae=_c(le.anchor,le.width,le.height,le.textOffset,le.textBoxScale,Ee),De=a?Gt(fe.add(Ae),k).point:ge.point.add(s?Ae.rotate(-w.angle):Ae),Ke=n.allowVerticalPlacement&&Y.placedOrientation===o.WritingMode.vertical?Math.PI/2:0,Ze=0;Ze<Y.numGlyphs;Ze++)o.addDynamicAttributes(K,De,Ke);Z&&Y.associatedIconIndex>=0&&(te[Y.associatedIconIndex]={shiftedAnchor:De,angle:Ke})}else ki(Y.numGlyphs,K)}if(Z){re.clear();for(var nt=n.icon.placedSymbolArray,vt=0;vt<nt.length;vt++){var St=nt.get(vt);if(St.hidden)ki(St.numGlyphs,re);else{var wt=te[vt];if(wt)for(var _r=0;_r<St.numGlyphs;_r++)o.addDynamicAttributes(re,wt.shiftedAnchor,wt.angle);else ki(St.numGlyphs,re)}}n.icon.dynamicLayoutVertexBuffer.updateData(re)}n.text.dynamicLayoutVertexBuffer.updateData(K)}function vc(n,s,a){return a.iconsInText&&s?"symbolTextAndIcon":n?"symbolSDF":"symbolIcon"}function wa(n,s,a,u,y,w,k,E,P,O,Z,G){for(var K=n.context,re=K.gl,te=n.transform,ue=E==="map",Y=P==="map",le=ue&&a.layout.get("symbol-placement")!=="point",fe=ue&&!Y&&!le,ge=a.layout.get("symbol-sort-key").constantOr(1)!==void 0,ze=!1,Ee=n.depthModeForSublayer(0,X.ReadOnly),Ae=a.layout.get("text-variable-anchor"),De=[],Ke=0,Ze=u;Ke<Ze.length;Ke+=1){var nt=Ze[Ke],vt=s.getTile(nt),St=vt.getBucket(a);if(St){var wt=y?St.text:St.icon;if(wt&&wt.segments.get().length){var _r=wt.programConfigurations.get(a.id),at=y||St.sdfIcons,Nt=y?St.textSizeData:St.iconSizeData,Jt=Y||te.pitch!==0,Ot=n.useProgram(vc(at,y,St),_r),Bt=o.evaluateSizeForZoom(Nt,te.zoom),Wt=void 0,Rt=[0,0],Ct=void 0,Di=void 0,si=null,cn=void 0;if(y)Ct=vt.glyphAtlasTexture,Di=re.LINEAR,Wt=vt.glyphAtlasTexture.size,St.iconsInText&&(Rt=vt.imageAtlasTexture.size,si=vt.imageAtlasTexture,cn=Jt||n.options.rotating||n.options.zooming||Nt.kind==="composite"||Nt.kind==="camera"?re.LINEAR:re.NEAREST);else{var Gi=a.layout.get("icon-size").constantOr(0)!==1||St.iconsNeedLinear;Ct=vt.imageAtlasTexture,Di=at||n.options.rotating||n.options.zooming||Gi||Jt?re.LINEAR:re.NEAREST,Wt=vt.imageAtlasTexture.size}var ri=Lr(vt,1,n.transform.zoom),fi=vr(nt.posMatrix,Y,ue,n.transform,ri),Gn=dr(nt.posMatrix,Y,ue,n.transform,ri),wn=Ae&&St.hasTextData(),ea=a.layout.get("icon-text-fit")!=="none"&&wn&&St.hasIconData();le&&Bn(St,nt.posMatrix,n,y,fi,Gn,Y,O);var An=n.translatePosMatrix(nt.posMatrix,vt,w,k),go=le||y&&Ae||ea?po:fi,ao=n.translatePosMatrix(Gn,vt,w,k,!0),ws=at&&a.paint.get(y?"text-halo-width":"icon-halo-width").constantOr(1)!==0,Wa={program:Ot,buffers:wt,uniformValues:at?St.iconsInText?Vs(Nt.kind,Bt,fe,Y,n,An,go,ao,Wt,Rt):us(Nt.kind,Bt,fe,Y,n,An,go,ao,y,Wt,!0):Ua(Nt.kind,Bt,fe,Y,n,An,go,ao,y,Wt),atlasTexture:Ct,atlasTextureIcon:si,atlasInterpolation:Di,atlasInterpolationIcon:cn,isSDF:at,hasHalo:ws};if(ge&&St.canOverlap){ze=!0;for(var ta=0,Ha=wt.segments.get();ta<Ha.length;ta+=1){var ks=Ha[ta];De.push({segments:new o.SegmentVector([ks]),sortKey:ks.sortKey,state:Wa})}}else De.push({segments:wt.segments,sortKey:0,state:Wa})}}}ze&&De.sort(function(ra,za){return ra.sortKey-za.sortKey});for(var zo=0,Ss=De;zo<Ss.length;zo+=1){var Ao=Ss[zo],Li=Ao.state;if(K.activeTexture.set(re.TEXTURE0),Li.atlasTexture.bind(Li.atlasInterpolation,re.CLAMP_TO_EDGE),Li.atlasTextureIcon&&(K.activeTexture.set(re.TEXTURE1),Li.atlasTextureIcon&&Li.atlasTextureIcon.bind(Li.atlasInterpolationIcon,re.CLAMP_TO_EDGE)),Li.isSDF){var Ro=Li.uniformValues;Li.hasHalo&&(Ro.u_is_halo=1,hs(Li.buffers,Ao.segments,a,n,Li.program,Ee,Z,G,Ro)),Ro.u_is_halo=0}hs(Li.buffers,Ao.segments,a,n,Li.program,Ee,Z,G,Li.uniformValues)}}function hs(n,s,a,u,y,w,k,E,P){var O=u.context;y.draw(O,O.gl.TRIANGLES,w,k,E,pe.disabled,P,a.id,n.layoutVertexBuffer,n.indexBuffer,s,a.paint,u.transform.zoom,n.programConfigurations.get(a.id),n.dynamicLayoutVertexBuffer,n.opacityVertexBuffer)}function js(n,s,a,u,y,w,k){var E,P,O,Z,G,K=n.context.gl,re=a.paint.get("fill-pattern"),te=re&&re.constantOr(1),ue=a.getCrossfadeParameters();k?(P=te&&!a.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline",E=K.LINES):(P=te?"fillPattern":"fill",E=K.TRIANGLES);for(var Y=0,le=u;Y<le.length;Y+=1){var fe=le[Y],ge=s.getTile(fe);if(!te||ge.patternsLoaded()){var ze=ge.getBucket(a);if(ze){var Ee=ze.programConfigurations.get(a.id),Ae=n.useProgram(P,Ee);te&&(n.context.activeTexture.set(K.TEXTURE0),ge.imageAtlasTexture.bind(K.LINEAR,K.CLAMP_TO_EDGE),Ee.updatePaintBuffers(ue));var De=re.constantOr(null);if(De&&ge.imageAtlas){var Ke=ge.imageAtlas,Ze=Ke.patternPositions[De.to.toString()],nt=Ke.patternPositions[De.from.toString()];Ze&&nt&&Ee.setConstantPatternPositions(Ze,nt)}var vt=n.translatePosMatrix(fe.posMatrix,ge,a.paint.get("fill-translate"),a.paint.get("fill-translate-anchor"));if(k){Z=ze.indexBuffer2,G=ze.segments2;var St=[K.drawingBufferWidth,K.drawingBufferHeight];O=P==="fillOutlinePattern"&&te?hc(vt,n,ue,ge,St):cc(vt,St)}else Z=ze.indexBuffer,G=ze.segments,O=te?ga(vt,n,ue,ge):Wo(vt);Ae.draw(n.context,E,y,n.stencilModeForClipping(fe),w,pe.disabled,O,a.id,ze.layoutVertexBuffer,Z,G,a.paint,n.transform.zoom,Ee)}}}}function ql(n,s,a,u,y,w,k){for(var E=n.context,P=E.gl,O=a.paint.get("fill-extrusion-pattern"),Z=O.constantOr(1),G=a.getCrossfadeParameters(),K=a.paint.get("fill-extrusion-opacity"),re=0,te=u;re<te.length;re+=1){var ue=te[re],Y=s.getTile(ue),le=Y.getBucket(a);if(le){var fe=le.programConfigurations.get(a.id),ge=n.useProgram(Z?"fillExtrusionPattern":"fillExtrusion",fe);Z&&(n.context.activeTexture.set(P.TEXTURE0),Y.imageAtlasTexture.bind(P.LINEAR,P.CLAMP_TO_EDGE),fe.updatePaintBuffers(G));var ze=O.constantOr(null);if(ze&&Y.imageAtlas){var Ee=Y.imageAtlas,Ae=Ee.patternPositions[ze.to.toString()],De=Ee.patternPositions[ze.from.toString()];Ae&&De&&fe.setConstantPatternPositions(Ae,De)}var Ke=n.translatePosMatrix(ue.posMatrix,Y,a.paint.get("fill-extrusion-translate"),a.paint.get("fill-extrusion-translate-anchor")),Ze=a.paint.get("fill-extrusion-vertical-gradient"),nt=Z?_a(Ke,n,Ze,K,ue,G,Y):uc(Ke,n,Ze,K);ge.draw(E,E.gl.TRIANGLES,y,w,k,pe.backCCW,nt,a.id,le.layoutVertexBuffer,le.indexBuffer,le.segments,a.paint,n.transform.zoom,fe)}}}function qs(n,s,a,u,y,w){var k=n.context,E=k.gl,P=s.fbo;if(P){var O=n.useProgram("hillshade");k.activeTexture.set(E.TEXTURE0),E.bindTexture(E.TEXTURE_2D,P.colorAttachment.get());var Z=function(G,K,re){var te=re.paint.get("hillshade-shadow-color"),ue=re.paint.get("hillshade-highlight-color"),Y=re.paint.get("hillshade-accent-color"),le=re.paint.get("hillshade-illumination-direction")*(Math.PI/180);re.paint.get("hillshade-illumination-anchor")==="viewport"&&(le-=G.transform.angle);var fe,ge,ze,Ee=!G.options.moving;return{u_matrix:G.transform.calculatePosMatrix(K.tileID.toUnwrapped(),Ee),u_image:0,u_latrange:(fe=K.tileID,ge=Math.pow(2,fe.canonical.z),ze=fe.canonical.y,[new o.MercatorCoordinate(0,ze/ge).toLngLat().lat,new o.MercatorCoordinate(0,(ze+1)/ge).toLngLat().lat]),u_light:[re.paint.get("hillshade-exaggeration"),le],u_shadow:te,u_highlight:ue,u_accent:Y}}(n,s,a);O.draw(k,E.TRIANGLES,u,y,w,pe.disabled,Z,a.id,n.rasterBoundsBuffer,n.quadTriangleIndexBuffer,n.rasterBoundsSegments)}}function qh(n,s,a,u,y,w){var k=n.context,E=k.gl,P=s.dem;if(P&&P.data){var O=P.dim,Z=P.stride,G=P.getPixels();if(k.activeTexture.set(E.TEXTURE1),k.pixelStoreUnpackPremultiplyAlpha.set(!1),s.demTexture=s.demTexture||n.getTileTexture(Z),s.demTexture){var K=s.demTexture;K.update(G,{premultiply:!1}),K.bind(E.NEAREST,E.CLAMP_TO_EDGE)}else s.demTexture=new o.Texture(k,G,E.RGBA,{premultiply:!1}),s.demTexture.bind(E.NEAREST,E.CLAMP_TO_EDGE);k.activeTexture.set(E.TEXTURE0);var re=s.fbo;if(!re){var te=new o.Texture(k,{width:O,height:O,data:null},E.RGBA);te.bind(E.LINEAR,E.CLAMP_TO_EDGE),(re=s.fbo=k.createFramebuffer(O,O,!0)).colorAttachment.set(te.texture)}k.bindFramebuffer.set(re.framebuffer),k.viewport.set([0,0,O,O]),n.useProgram("hillshadePrepare").draw(k,E.TRIANGLES,u,y,w,pe.disabled,function(ue,Y){var le=Y.stride,fe=o.create();return o.ortho(fe,0,o.EXTENT,-o.EXTENT,0,0,1),o.translate(fe,fe,[0,-o.EXTENT,0]),{u_matrix:fe,u_image:1,u_dimension:[le,le],u_zoom:ue.overscaledZ,u_unpack:Y.getUnpackVector()}}(s.tileID,P),a.id,n.rasterBoundsBuffer,n.quadTriangleIndexBuffer,n.rasterBoundsSegments),s.needsHillshadePrepare=!1}}function Zs(n,s,a,u,y){var w=u.paint.get("raster-fade-duration");if(w>0){var k=o.browser.now(),E=(k-n.timeAdded)/w,P=s?(k-s.timeAdded)/w:-1,O=a.getSource(),Z=y.coveringZoomLevel({tileSize:O.tileSize,roundZoom:O.roundZoom}),G=!s||Math.abs(s.tileID.overscaledZ-Z)>Math.abs(n.tileID.overscaledZ-Z),K=G&&n.refreshedUponExpiration?1:o.clamp(G?E:1-P,0,1);return n.refreshedUponExpiration&&E>=1&&(n.refreshedUponExpiration=!1),s?{opacity:1,mix:1-K}:{opacity:K,mix:0}}return{opacity:1,mix:0}}var Zl=new o.Color(1,0,0,1),bc=new o.Color(0,1,0,1),xc=new o.Color(0,0,1,1),Gs=new o.Color(1,0,1,1),Gl=new o.Color(0,1,1,1);function Kl(n,s,a,u){ps(n,0,s+a/2,n.transform.width,a,u)}function Xl(n,s,a,u){ps(n,s-a/2,0,a,n.transform.height,u)}function ps(n,s,a,u,y,w){var k=n.context,E=k.gl;E.enable(E.SCISSOR_TEST),E.scissor(s*o.browser.devicePixelRatio,a*o.browser.devicePixelRatio,u*o.browser.devicePixelRatio,y*o.browser.devicePixelRatio),k.clear({color:w}),E.disable(E.SCISSOR_TEST)}function wc(n,s,a){var u=n.context,y=u.gl,w=a.posMatrix,k=n.useProgram("debug"),E=X.disabled,P=$.disabled,O=n.colorModeForRenderPass();u.activeTexture.set(y.TEXTURE0),n.emptyTexture.bind(y.LINEAR,y.CLAMP_TO_EDGE),k.draw(u,y.LINE_STRIP,E,P,O,pe.disabled,ba(w,o.Color.red),"$debug",n.debugBuffer,n.tileBorderIndexBuffer,n.debugSegments);var Z=s.getTileByID(a.key).latestRawTileData,G=Math.floor((Z&&Z.byteLength||0)/1024),K=s.getTile(a).tileSize,re=512/Math.min(K,512)*(a.overscaledZ/n.transform.zoom)*.5,te=a.canonical.toString();a.overscaledZ!==a.canonical.z&&(te+=" => "+a.overscaledZ),function(ue,Y){ue.initDebugOverlayCanvas();var le=ue.debugOverlayCanvas,fe=ue.context.gl,ge=ue.debugOverlayCanvas.getContext("2d");ge.clearRect(0,0,le.width,le.height),ge.shadowColor="white",ge.shadowBlur=2,ge.lineWidth=1.5,ge.strokeStyle="white",ge.textBaseline="top",ge.font="bold 36px Open Sans, sans-serif",ge.fillText(Y,5,5),ge.strokeText(Y,5,5),ue.debugOverlayTexture.update(le),ue.debugOverlayTexture.bind(fe.LINEAR,fe.CLAMP_TO_EDGE)}(n,te+" "+G+"kb"),k.draw(u,y.TRIANGLES,E,P,se.alphaBlended,pe.disabled,ba(w,o.Color.transparent,re),"$debug",n.debugBuffer,n.quadTriangleIndexBuffer,n.debugSegments)}var ka={symbol:function(n,s,a,u,y){if(n.renderPass==="translucent"){var w=$.disabled,k=n.colorModeForRenderPass();a.layout.get("text-variable-anchor")&&function(E,P,O,Z,G,K,re){for(var te=P.transform,ue=G==="map",Y=K==="map",le=0,fe=E;le<fe.length;le+=1){var ge=fe[le],ze=Z.getTile(ge),Ee=ze.getBucket(O);if(Ee&&Ee.text&&Ee.text.segments.get().length){var Ae=o.evaluateSizeForZoom(Ee.textSizeData,te.zoom),De=Lr(ze,1,P.transform.zoom),Ke=vr(ge.posMatrix,Y,ue,P.transform,De),Ze=O.layout.get("icon-text-fit")!=="none"&&Ee.hasIconData();if(Ae){var nt=Math.pow(2,te.zoom-ze.tileID.overscaledZ);gc(Ee,ue,Y,re,o.symbolSize,te,Ke,ge.posMatrix,nt,Ae,Ze)}}}}(u,n,a,s,a.layout.get("text-rotation-alignment"),a.layout.get("text-pitch-alignment"),y),a.paint.get("icon-opacity").constantOr(1)!==0&&wa(n,s,a,u,!1,a.paint.get("icon-translate"),a.paint.get("icon-translate-anchor"),a.layout.get("icon-rotation-alignment"),a.layout.get("icon-pitch-alignment"),a.layout.get("icon-keep-upright"),w,k),a.paint.get("text-opacity").constantOr(1)!==0&&wa(n,s,a,u,!0,a.paint.get("text-translate"),a.paint.get("text-translate-anchor"),a.layout.get("text-rotation-alignment"),a.layout.get("text-pitch-alignment"),a.layout.get("text-keep-upright"),w,k),s.map.showCollisionBoxes&&(ja(n,s,a,u,a.paint.get("text-translate"),a.paint.get("text-translate-anchor"),!0),ja(n,s,a,u,a.paint.get("icon-translate"),a.paint.get("icon-translate-anchor"),!1))}},circle:function(n,s,a,u){if(n.renderPass==="translucent"){var y=a.paint.get("circle-opacity"),w=a.paint.get("circle-stroke-width"),k=a.paint.get("circle-stroke-opacity"),E=a.layout.get("circle-sort-key").constantOr(1)!==void 0;if(y.constantOr(1)!==0||w.constantOr(1)!==0&&k.constantOr(1)!==0){for(var P=n.context,O=P.gl,Z=n.depthModeForSublayer(0,X.ReadOnly),G=$.disabled,K=n.colorModeForRenderPass(),re=[],te=0;te<u.length;te++){var ue=u[te],Y=s.getTile(ue),le=Y.getBucket(a);if(le){var fe=le.programConfigurations.get(a.id),ge={programConfiguration:fe,program:n.useProgram("circle",fe),layoutVertexBuffer:le.layoutVertexBuffer,indexBuffer:le.indexBuffer,uniformValues:jl(n,ue,Y,a)};if(E)for(var ze=0,Ee=le.segments.get();ze<Ee.length;ze+=1){var Ae=Ee[ze];re.push({segments:new o.SegmentVector([Ae]),sortKey:Ae.sortKey,state:ge})}else re.push({segments:le.segments,sortKey:0,state:ge})}}E&&re.sort(function(vt,St){return vt.sortKey-St.sortKey});for(var De=0,Ke=re;De<Ke.length;De+=1){var Ze=Ke[De],nt=Ze.state;nt.program.draw(P,O.TRIANGLES,Z,G,K,pe.disabled,nt.uniformValues,a.id,nt.layoutVertexBuffer,nt.indexBuffer,Ze.segments,a.paint,n.transform.zoom,nt.programConfiguration)}}}},heatmap:function(n,s,a,u){if(a.paint.get("heatmap-opacity")!==0)if(n.renderPass==="offscreen"){var y=n.context,w=y.gl,k=$.disabled,E=new se([w.ONE,w.ONE],o.Color.transparent,[!0,!0,!0,!0]);(function(re,te,ue){var Y=re.gl;re.activeTexture.set(Y.TEXTURE1),re.viewport.set([0,0,te.width/4,te.height/4]);var le=ue.heatmapFbo;if(le)Y.bindTexture(Y.TEXTURE_2D,le.colorAttachment.get()),re.bindFramebuffer.set(le.framebuffer);else{var fe=Y.createTexture();Y.bindTexture(Y.TEXTURE_2D,fe),Y.texParameteri(Y.TEXTURE_2D,Y.TEXTURE_WRAP_S,Y.CLAMP_TO_EDGE),Y.texParameteri(Y.TEXTURE_2D,Y.TEXTURE_WRAP_T,Y.CLAMP_TO_EDGE),Y.texParameteri(Y.TEXTURE_2D,Y.TEXTURE_MIN_FILTER,Y.LINEAR),Y.texParameteri(Y.TEXTURE_2D,Y.TEXTURE_MAG_FILTER,Y.LINEAR),le=ue.heatmapFbo=re.createFramebuffer(te.width/4,te.height/4,!1),function(ge,ze,Ee,Ae){var De=ge.gl;De.texImage2D(De.TEXTURE_2D,0,De.RGBA,ze.width/4,ze.height/4,0,De.RGBA,ge.extRenderToTextureHalfFloat?ge.extTextureHalfFloat.HALF_FLOAT_OES:De.UNSIGNED_BYTE,null),Ae.colorAttachment.set(Ee)}(re,te,fe,le)}})(y,n,a),y.clear({color:o.Color.transparent});for(var P=0;P<u.length;P++){var O=u[P];if(!s.hasRenderableParent(O)){var Z=s.getTile(O),G=Z.getBucket(a);if(G){var K=G.programConfigurations.get(a.id);n.useProgram("heatmap",K).draw(y,w.TRIANGLES,X.disabled,k,E,pe.disabled,fc(O.posMatrix,Z,n.transform.zoom,a.paint.get("heatmap-intensity")),a.id,G.layoutVertexBuffer,G.indexBuffer,G.segments,a.paint,n.transform.zoom,K)}}}y.viewport.set([0,0,n.width,n.height])}else n.renderPass==="translucent"&&(n.context.setColorMode(n.colorModeForRenderPass()),function(re,te){var ue=re.context,Y=ue.gl,le=te.heatmapFbo;if(le){ue.activeTexture.set(Y.TEXTURE0),Y.bindTexture(Y.TEXTURE_2D,le.colorAttachment.get()),ue.activeTexture.set(Y.TEXTURE1);var fe=te.colorRampTexture;fe||(fe=te.colorRampTexture=new o.Texture(ue,te.colorRamp,Y.RGBA)),fe.bind(Y.LINEAR,Y.CLAMP_TO_EDGE),re.useProgram("heatmapTexture").draw(ue,Y.TRIANGLES,X.disabled,$.disabled,re.colorModeForRenderPass(),pe.disabled,function(ge,ze,Ee,Ae){var De=o.create();o.ortho(De,0,ge.width,ge.height,0,0,1);var Ke=ge.context.gl;return{u_matrix:De,u_world:[Ke.drawingBufferWidth,Ke.drawingBufferHeight],u_image:0,u_color_ramp:1,u_opacity:ze.paint.get("heatmap-opacity")}}(re,te),te.id,re.viewportBuffer,re.quadTriangleIndexBuffer,re.viewportSegments,te.paint,re.transform.zoom)}}(n,a))},line:function(n,s,a,u){if(n.renderPass==="translucent"){var y=a.paint.get("line-opacity"),w=a.paint.get("line-width");if(y.constantOr(1)!==0&&w.constantOr(1)!==0)for(var k=n.depthModeForSublayer(0,X.ReadOnly),E=n.colorModeForRenderPass(),P=a.paint.get("line-dasharray"),O=a.paint.get("line-pattern"),Z=O.constantOr(1),G=a.paint.get("line-gradient"),K=a.getCrossfadeParameters(),re=Z?"linePattern":P?"lineSDF":G?"lineGradient":"line",te=n.context,ue=te.gl,Y=!0,le=0,fe=u;le<fe.length;le+=1){var ge=fe[le],ze=s.getTile(ge);if(!Z||ze.patternsLoaded()){var Ee=ze.getBucket(a);if(Ee){var Ae=Ee.programConfigurations.get(a.id),De=n.context.program.get(),Ke=n.useProgram(re,Ae),Ze=Y||Ke.program!==De,nt=O.constantOr(null);if(nt&&ze.imageAtlas){var vt=ze.imageAtlas,St=vt.patternPositions[nt.to.toString()],wt=vt.patternPositions[nt.from.toString()];St&&wt&&Ae.setConstantPatternPositions(St,wt)}var _r=Z?Ns(n,ze,a,K):P?Vh(n,ze,a,P,K):G?Vr(n,ze,a,Ee.lineClipsArray.length):ls(n,ze,a);if(Z)te.activeTexture.set(ue.TEXTURE0),ze.imageAtlasTexture.bind(ue.LINEAR,ue.CLAMP_TO_EDGE),Ae.updatePaintBuffers(K);else if(P&&(Ze||n.lineAtlas.dirty))te.activeTexture.set(ue.TEXTURE0),n.lineAtlas.bind(te);else if(G){var at=Ee.gradients[a.id],Nt=at.texture;if(a.gradientVersion!==at.version){var Jt=256;if(a.stepInterpolant){var Ot=s.getSource().maxzoom,Bt=ge.canonical.z===Ot?Math.ceil(1<<n.transform.maxZoom-ge.canonical.z):1;Jt=o.clamp(o.nextPowerOfTwo(Ee.maxLineLength/o.EXTENT*1024*Bt),256,te.maxTextureSize)}at.gradient=o.renderColorRamp({expression:a.gradientExpression(),evaluationKey:"lineProgress",resolution:Jt,image:at.gradient||void 0,clips:Ee.lineClipsArray}),at.texture?at.texture.update(at.gradient):at.texture=new o.Texture(te,at.gradient,ue.RGBA),at.version=a.gradientVersion,Nt=at.texture}te.activeTexture.set(ue.TEXTURE0),Nt.bind(a.stepInterpolant?ue.NEAREST:ue.LINEAR,ue.CLAMP_TO_EDGE)}Ke.draw(te,ue.TRIANGLES,k,n.stencilModeForClipping(ge),E,pe.disabled,_r,a.id,Ee.layoutVertexBuffer,Ee.indexBuffer,Ee.segments,a.paint,n.transform.zoom,Ae,Ee.layoutVertexBuffer2),Y=!1}}}}},fill:function(n,s,a,u){var y=a.paint.get("fill-color"),w=a.paint.get("fill-opacity");if(w.constantOr(1)!==0){var k=n.colorModeForRenderPass(),E=a.paint.get("fill-pattern"),P=n.opaquePassEnabledForLayer()&&!E.constantOr(1)&&y.constantOr(o.Color.transparent).a===1&&w.constantOr(0)===1?"opaque":"translucent";if(n.renderPass===P){var O=n.depthModeForSublayer(1,n.renderPass==="opaque"?X.ReadWrite:X.ReadOnly);js(n,s,a,u,O,k,!1)}if(n.renderPass==="translucent"&&a.paint.get("fill-antialias")){var Z=n.depthModeForSublayer(a.getPaintProperty("fill-outline-color")?2:0,X.ReadOnly);js(n,s,a,u,Z,k,!0)}}},"fill-extrusion":function(n,s,a,u){var y=a.paint.get("fill-extrusion-opacity");if(y!==0&&n.renderPass==="translucent"){var w=new X(n.context.gl.LEQUAL,X.ReadWrite,n.depthRangeFor3D);if(y!==1||a.paint.get("fill-extrusion-pattern").constantOr(1))ql(n,s,a,u,w,$.disabled,se.disabled),ql(n,s,a,u,w,n.stencilModeFor3D(),n.colorModeForRenderPass());else{var k=n.colorModeForRenderPass();ql(n,s,a,u,w,$.disabled,k)}}},hillshade:function(n,s,a,u){if(n.renderPass==="offscreen"||n.renderPass==="translucent"){for(var y=n.context,w=n.depthModeForSublayer(0,X.ReadOnly),k=n.colorModeForRenderPass(),E=n.renderPass==="translucent"?n.stencilConfigForOverlap(u):[{},u],P=E[0],O=0,Z=E[1];O<Z.length;O+=1){var G=Z[O],K=s.getTile(G);K.needsHillshadePrepare&&n.renderPass==="offscreen"?qh(n,K,a,w,$.disabled,k):n.renderPass==="translucent"&&qs(n,K,a,w,P[G.overscaledZ],k)}y.viewport.set([0,0,n.width,n.height])}},raster:function(n,s,a,u){if(n.renderPass==="translucent"&&a.paint.get("raster-opacity")!==0&&u.length)for(var y=n.context,w=y.gl,k=s.getSource(),E=n.useProgram("raster"),P=n.colorModeForRenderPass(),O=k instanceof fr?[{},u]:n.stencilConfigForOverlap(u),Z=O[0],G=O[1],K=G[G.length-1].overscaledZ,re=!n.options.moving,te=0,ue=G;te<ue.length;te+=1){var Y=ue[te],le=n.depthModeForSublayer(Y.overscaledZ-K,a.paint.get("raster-opacity")===1?X.ReadWrite:X.ReadOnly,w.LESS),fe=s.getTile(Y),ge=n.transform.calculatePosMatrix(Y.toUnwrapped(),re);fe.registerFadeDuration(a.paint.get("raster-fade-duration"));var ze=s.findLoadedParent(Y,0),Ee=Zs(fe,ze,s,a,n.transform),Ae=void 0,De=void 0,Ke=a.paint.get("raster-resampling")==="nearest"?w.NEAREST:w.LINEAR;y.activeTexture.set(w.TEXTURE0),fe.texture.bind(Ke,w.CLAMP_TO_EDGE,w.LINEAR_MIPMAP_NEAREST),y.activeTexture.set(w.TEXTURE1),ze?(ze.texture.bind(Ke,w.CLAMP_TO_EDGE,w.LINEAR_MIPMAP_NEAREST),Ae=Math.pow(2,ze.tileID.overscaledZ-fe.tileID.overscaledZ),De=[fe.tileID.canonical.x*Ae%1,fe.tileID.canonical.y*Ae%1]):fe.texture.bind(Ke,w.CLAMP_TO_EDGE,w.LINEAR_MIPMAP_NEAREST);var Ze=jh(ge,De||[0,0],Ae||1,Ee,a);k instanceof fr?E.draw(y,w.TRIANGLES,le,$.disabled,P,pe.disabled,Ze,a.id,k.boundsBuffer,n.quadTriangleIndexBuffer,k.boundsSegments):E.draw(y,w.TRIANGLES,le,Z[Y.overscaledZ],P,pe.disabled,Ze,a.id,n.rasterBoundsBuffer,n.quadTriangleIndexBuffer,n.rasterBoundsSegments)}},background:function(n,s,a){var u=a.paint.get("background-color"),y=a.paint.get("background-opacity");if(y!==0){var w=n.context,k=w.gl,E=n.transform,P=E.tileSize,O=a.paint.get("background-pattern");if(!n.isPatternMissing(O)){var Z=!O&&u.a===1&&y===1&&n.opaquePassEnabledForLayer()?"opaque":"translucent";if(n.renderPass===Z){var G=$.disabled,K=n.depthModeForSublayer(0,Z==="opaque"?X.ReadWrite:X.ReadOnly),re=n.colorModeForRenderPass(),te=n.useProgram(O?"backgroundPattern":"background"),ue=E.coveringTiles({tileSize:P});O&&(w.activeTexture.set(k.TEXTURE0),n.imageManager.bind(n.context));for(var Y=a.getCrossfadeParameters(),le=0,fe=ue;le<fe.length;le+=1){var ge=fe[le],ze=n.transform.calculatePosMatrix(ge.toUnwrapped()),Ee=O?Va(ze,y,n,O,{tileID:ge,tileSize:P},Y):cs(ze,y,u);te.draw(w,k.TRIANGLES,K,G,re,pe.disabled,Ee,a.id,n.tileExtentBuffer,n.quadTriangleIndexBuffer,n.tileExtentSegments)}}}}},debug:function(n,s,a){for(var u=0;u<a.length;u++)wc(n,s,a[u])},custom:function(n,s,a){var u=n.context,y=a.implementation;if(n.renderPass==="offscreen"){var w=y.prerender;w&&(n.setCustomLayerDefaults(),u.setColorMode(n.colorModeForRenderPass()),w.call(y,u.gl,n.transform.customLayerMatrix()),u.setDirty(),n.setBaseState())}else if(n.renderPass==="translucent"){n.setCustomLayerDefaults(),u.setColorMode(n.colorModeForRenderPass()),u.setStencilMode($.disabled);var k=y.renderingMode==="3d"?new X(n.context.gl.LEQUAL,X.ReadWrite,n.depthRangeFor3D):n.depthModeForSublayer(0,X.ReadOnly);u.setDepthMode(k),y.render(u.gl,n.transform.customLayerMatrix()),u.setDirty(),n.setBaseState(),u.bindFramebuffer.set(null)}}},Wr=function(n,s){this.context=new j(n),this.transform=s,this._tileTextures={},this.setup(),this.numSublayers=J.maxUnderzooming+J.maxOverzooming+1,this.depthEpsilon=1/Math.pow(2,16),this.crossTileSymbolIndex=new ye,this.gpuTimers={}};Wr.prototype.resize=function(n,s){if(this.width=n*o.browser.devicePixelRatio,this.height=s*o.browser.devicePixelRatio,this.context.viewport.set([0,0,this.width,this.height]),this.style)for(var a=0,u=this.style._order;a<u.length;a+=1)this.style._layers[u[a]].resize()},Wr.prototype.setup=function(){var n=this.context,s=new o.StructArrayLayout2i4;s.emplaceBack(0,0),s.emplaceBack(o.EXTENT,0),s.emplaceBack(0,o.EXTENT),s.emplaceBack(o.EXTENT,o.EXTENT),this.tileExtentBuffer=n.createVertexBuffer(s,vi.members),this.tileExtentSegments=o.SegmentVector.simpleSegment(0,0,4,2);var a=new o.StructArrayLayout2i4;a.emplaceBack(0,0),a.emplaceBack(o.EXTENT,0),a.emplaceBack(0,o.EXTENT),a.emplaceBack(o.EXTENT,o.EXTENT),this.debugBuffer=n.createVertexBuffer(a,vi.members),this.debugSegments=o.SegmentVector.simpleSegment(0,0,4,5);var u=new o.StructArrayLayout4i8;u.emplaceBack(0,0,0,0),u.emplaceBack(o.EXTENT,0,o.EXTENT,0),u.emplaceBack(0,o.EXTENT,0,o.EXTENT),u.emplaceBack(o.EXTENT,o.EXTENT,o.EXTENT,o.EXTENT),this.rasterBoundsBuffer=n.createVertexBuffer(u,Ve.members),this.rasterBoundsSegments=o.SegmentVector.simpleSegment(0,0,4,2);var y=new o.StructArrayLayout2i4;y.emplaceBack(0,0),y.emplaceBack(1,0),y.emplaceBack(0,1),y.emplaceBack(1,1),this.viewportBuffer=n.createVertexBuffer(y,vi.members),this.viewportSegments=o.SegmentVector.simpleSegment(0,0,4,2);var w=new o.StructArrayLayout1ui2;w.emplaceBack(0),w.emplaceBack(1),w.emplaceBack(3),w.emplaceBack(2),w.emplaceBack(0),this.tileBorderIndexBuffer=n.createIndexBuffer(w);var k=new o.StructArrayLayout3ui6;k.emplaceBack(0,1,2),k.emplaceBack(2,1,3),this.quadTriangleIndexBuffer=n.createIndexBuffer(k),this.emptyTexture=new o.Texture(n,{width:1,height:1,data:new Uint8Array([0,0,0,0])},n.gl.RGBA);var E=this.context.gl;this.stencilClearMode=new $({func:E.ALWAYS,mask:0},0,255,E.ZERO,E.ZERO,E.ZERO)},Wr.prototype.clearStencil=function(){var n=this.context,s=n.gl;this.nextStencilID=1,this.currentStencilSource=void 0;var a=o.create();o.ortho(a,0,this.width,this.height,0,0,1),o.scale(a,a,[s.drawingBufferWidth,s.drawingBufferHeight,0]),this.useProgram("clippingMask").draw(n,s.TRIANGLES,X.disabled,this.stencilClearMode,se.disabled,pe.disabled,xa(a),"$clipping",this.viewportBuffer,this.quadTriangleIndexBuffer,this.viewportSegments)},Wr.prototype._renderTileClippingMasks=function(n,s){if(this.currentStencilSource!==n.source&&n.isTileClipped()&&s&&s.length){this.currentStencilSource=n.source;var a=this.context,u=a.gl;this.nextStencilID+s.length>256&&this.clearStencil(),a.setColorMode(se.disabled),a.setDepthMode(X.disabled);var y=this.useProgram("clippingMask");this._tileClippingMaskIDs={};for(var w=0,k=s;w<k.length;w+=1){var E=k[w],P=this._tileClippingMaskIDs[E.key]=this.nextStencilID++;y.draw(a,u.TRIANGLES,X.disabled,new $({func:u.ALWAYS,mask:0},P,255,u.KEEP,u.KEEP,u.REPLACE),se.disabled,pe.disabled,xa(E.posMatrix),"$clipping",this.tileExtentBuffer,this.quadTriangleIndexBuffer,this.tileExtentSegments)}}},Wr.prototype.stencilModeFor3D=function(){this.currentStencilSource=void 0,this.nextStencilID+1>256&&this.clearStencil();var n=this.nextStencilID++,s=this.context.gl;return new $({func:s.NOTEQUAL,mask:255},n,255,s.KEEP,s.KEEP,s.REPLACE)},Wr.prototype.stencilModeForClipping=function(n){var s=this.context.gl;return new $({func:s.EQUAL,mask:255},this._tileClippingMaskIDs[n.key],0,s.KEEP,s.KEEP,s.REPLACE)},Wr.prototype.stencilConfigForOverlap=function(n){var s,a=this.context.gl,u=n.sort(function(P,O){return O.overscaledZ-P.overscaledZ}),y=u[u.length-1].overscaledZ,w=u[0].overscaledZ-y+1;if(w>1){this.currentStencilSource=void 0,this.nextStencilID+w>256&&this.clearStencil();for(var k={},E=0;E<w;E++)k[E+y]=new $({func:a.GEQUAL,mask:255},E+this.nextStencilID,255,a.KEEP,a.KEEP,a.REPLACE);return this.nextStencilID+=w,[k,u]}return[(s={},s[y]=$.disabled,s),u]},Wr.prototype.colorModeForRenderPass=function(){var n=this.context.gl;return this._showOverdrawInspector?new se([n.CONSTANT_COLOR,n.ONE],new o.Color(1/8,1/8,1/8,0),[!0,!0,!0,!0]):this.renderPass==="opaque"?se.unblended:se.alphaBlended},Wr.prototype.depthModeForSublayer=function(n,s,a){if(!this.opaquePassEnabledForLayer())return X.disabled;var u=1-((1+this.currentLayer)*this.numSublayers+n)*this.depthEpsilon;return new X(a||this.context.gl.LEQUAL,s,[u,u])},Wr.prototype.opaquePassEnabledForLayer=function(){return this.currentLayer<this.opaquePassCutoff},Wr.prototype.render=function(n,s){var a=this;this.style=n,this.options=s,this.lineAtlas=n.lineAtlas,this.imageManager=n.imageManager,this.glyphManager=n.glyphManager,this.symbolFadeChange=n.placement.symbolFadeChange(o.browser.now()),this.imageManager.beginFrame();var u=this.style._order,y=this.style.sourceCaches;for(var w in y){var k=y[w];k.used&&k.prepare(this.context)}var E,P,O={},Z={},G={};for(var K in y){var re=y[K];O[K]=re.getVisibleCoordinates(),Z[K]=O[K].slice().reverse(),G[K]=re.getVisibleCoordinates(!0).reverse()}this.opaquePassCutoff=1/0;for(var te=0;te<u.length;te++)if(this.style._layers[u[te]].is3D()){this.opaquePassCutoff=te;break}this.renderPass="offscreen";for(var ue=0,Y=u;ue<Y.length;ue+=1){var le=this.style._layers[Y[ue]];if(le.hasOffscreenPass()&&!le.isHidden(this.transform.zoom)){var fe=Z[le.source];(le.type==="custom"||fe.length)&&this.renderLayer(this,y[le.source],le,fe)}}for(this.context.bindFramebuffer.set(null),this.context.clear({color:s.showOverdrawInspector?o.Color.black:o.Color.transparent,depth:1}),this.clearStencil(),this._showOverdrawInspector=s.showOverdrawInspector,this.depthRangeFor3D=[0,1-(n._order.length+2)*this.numSublayers*this.depthEpsilon],this.renderPass="opaque",this.currentLayer=u.length-1;this.currentLayer>=0;this.currentLayer--){var ge=this.style._layers[u[this.currentLayer]],ze=y[ge.source],Ee=O[ge.source];this._renderTileClippingMasks(ge,Ee),this.renderLayer(this,ze,ge,Ee)}for(this.renderPass="translucent",this.currentLayer=0;this.currentLayer<u.length;this.currentLayer++){var Ae=this.style._layers[u[this.currentLayer]],De=y[Ae.source],Ke=(Ae.type==="symbol"?G:Z)[Ae.source];this._renderTileClippingMasks(Ae,O[Ae.source]),this.renderLayer(this,De,Ae,Ke)}this.options.showTileBoundaries&&(o.values(this.style._layers).forEach(function(Ze){Ze.source&&!Ze.isHidden(a.transform.zoom)&&(Ze.source!==(P&&P.id)&&(P=a.style.sourceCaches[Ze.source]),(!E||E.getSource().maxzoom<P.getSource().maxzoom)&&(E=P))}),E&&ka.debug(this,E,E.getVisibleCoordinates())),this.options.showPadding&&function(Ze){var nt=Ze.transform.padding;Kl(Ze,Ze.transform.height-(nt.top||0),3,Zl),Kl(Ze,nt.bottom||0,3,bc),Xl(Ze,nt.left||0,3,xc),Xl(Ze,Ze.transform.width-(nt.right||0),3,Gs);var vt=Ze.transform.centerPoint;(function(St,wt,_r,at){ps(St,wt-1,_r-10,2,20,at),ps(St,wt-10,_r-1,20,2,at)})(Ze,vt.x,Ze.transform.height-vt.y,Gl)}(this),this.context.setDefault()},Wr.prototype.renderLayer=function(n,s,a,u){a.isHidden(this.transform.zoom)||(a.type==="background"||a.type==="custom"||u.length)&&(this.id=a.id,this.gpuTimingStart(a),ka[a.type](n,s,a,u,this.style.placement.variableOffsets),this.gpuTimingEnd())},Wr.prototype.gpuTimingStart=function(n){if(this.options.gpuTiming){var s=this.context.extTimerQuery,a=this.gpuTimers[n.id];a||(a=this.gpuTimers[n.id]={calls:0,cpuTime:0,query:s.createQueryEXT()}),a.calls++,s.beginQueryEXT(s.TIME_ELAPSED_EXT,a.query)}},Wr.prototype.gpuTimingEnd=function(){if(this.options.gpuTiming){var n=this.context.extTimerQuery;n.endQueryEXT(n.TIME_ELAPSED_EXT)}},Wr.prototype.collectGpuTimers=function(){var n=this.gpuTimers;return this.gpuTimers={},n},Wr.prototype.queryGpuTimers=function(n){var s={};for(var a in n){var u=n[a],y=this.context.extTimerQuery,w=y.getQueryObjectEXT(u.query,y.QUERY_RESULT_EXT)/1e6;y.deleteQueryEXT(u.query),s[a]=w}return s},Wr.prototype.translatePosMatrix=function(n,s,a,u,y){if(!a[0]&&!a[1])return n;var w=y?u==="map"?this.transform.angle:0:u==="viewport"?-this.transform.angle:0;if(w){var k=Math.sin(w),E=Math.cos(w);a=[a[0]*E-a[1]*k,a[0]*k+a[1]*E]}var P=[y?a[0]:Lr(s,a[0],this.transform.zoom),y?a[1]:Lr(s,a[1],this.transform.zoom),0],O=new Float32Array(16);return o.translate(O,n,P),O},Wr.prototype.saveTileTexture=function(n){var s=this._tileTextures[n.size[0]];s?s.push(n):this._tileTextures[n.size[0]]=[n]},Wr.prototype.getTileTexture=function(n){var s=this._tileTextures[n];return s&&s.length>0?s.pop():null},Wr.prototype.isPatternMissing=function(n){if(!n)return!1;if(!n.from||!n.to)return!0;var s=this.imageManager.getPattern(n.from.toString()),a=this.imageManager.getPattern(n.to.toString());return!s||!a},Wr.prototype.useProgram=function(n,s){this.cache=this.cache||{};var a=""+n+(s?s.cacheKey:"")+(this._showOverdrawInspector?"/overdraw":"");return this.cache[a]||(this.cache[a]=new sc(this.context,n,Uh[n],s,yc[n],this._showOverdrawInspector)),this.cache[a]},Wr.prototype.setCustomLayerDefaults=function(){this.context.unbindVAO(),this.context.cullFace.setDefault(),this.context.activeTexture.setDefault(),this.context.pixelStoreUnpack.setDefault(),this.context.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.context.pixelStoreUnpackFlipY.setDefault()},Wr.prototype.setBaseState=function(){var n=this.context.gl;this.context.cullFace.set(!1),this.context.viewport.set([0,0,this.width,this.height]),this.context.blendEquation.set(n.FUNC_ADD)},Wr.prototype.initDebugOverlayCanvas=function(){this.debugOverlayCanvas==null&&(this.debugOverlayCanvas=o.window.document.createElement("canvas"),this.debugOverlayCanvas.width=512,this.debugOverlayCanvas.height=512,this.debugOverlayTexture=new o.Texture(this.context,this.debugOverlayCanvas,this.context.gl.RGBA))},Wr.prototype.destroy=function(){this.emptyTexture.destroy(),this.debugOverlayTexture&&this.debugOverlayTexture.destroy()};var Ks=function(n,s){this.points=n,this.planes=s};Ks.fromInvProjectionMatrix=function(n,s,a){var u=Math.pow(2,a),y=[[-1,1,-1,1],[1,1,-1,1],[1,-1,-1,1],[-1,-1,-1,1],[-1,1,1,1],[1,1,1,1],[1,-1,1,1],[-1,-1,1,1]].map(function(k){return o.transformMat4([],k,n)}).map(function(k){return o.scale$1([],k,1/k[3]/s*u)}),w=[[0,1,2],[6,5,4],[0,3,7],[2,1,5],[3,2,6],[0,4,5]].map(function(k){var E=o.sub([],y[k[0]],y[k[1]]),P=o.sub([],y[k[2]],y[k[1]]),O=o.normalize([],o.cross([],E,P)),Z=-o.dot(O,y[k[1]]);return O.concat(Z)});return new Ks(y,w)};var Sa=function(n,s){this.min=n,this.max=s,this.center=o.scale$2([],o.add([],this.min,this.max),.5)};Sa.prototype.quadrant=function(n){for(var s=[n%2==0,n<2],a=o.clone$2(this.min),u=o.clone$2(this.max),y=0;y<s.length;y++)a[y]=s[y]?this.min[y]:this.center[y],u[y]=s[y]?this.center[y]:this.max[y];return u[2]=this.max[2],new Sa(a,u)},Sa.prototype.distanceX=function(n){return Math.max(Math.min(this.max[0],n[0]),this.min[0])-n[0]},Sa.prototype.distanceY=function(n){return Math.max(Math.min(this.max[1],n[1]),this.min[1])-n[1]},Sa.prototype.intersects=function(n){for(var s=[[this.min[0],this.min[1],0,1],[this.max[0],this.min[1],0,1],[this.max[0],this.max[1],0,1],[this.min[0],this.max[1],0,1]],a=!0,u=0;u<n.planes.length;u++){for(var y=n.planes[u],w=0,k=0;k<s.length;k++)w+=o.dot$1(y,s[k])>=0;if(w===0)return 0;w!==s.length&&(a=!1)}if(a)return 2;for(var E=0;E<3;E++){for(var P=Number.MAX_VALUE,O=-Number.MAX_VALUE,Z=0;Z<n.points.length;Z++){var G=n.points[Z][E]-this.min[E];P=Math.min(P,G),O=Math.max(O,G)}if(O<0||P>this.max[E]-this.min[E])return 0}return 1};var Ho=function(n,s,a,u){if(n===void 0&&(n=0),s===void 0&&(s=0),a===void 0&&(a=0),u===void 0&&(u=0),isNaN(n)||n<0||isNaN(s)||s<0||isNaN(a)||a<0||isNaN(u)||u<0)throw new Error("Invalid value for edge-insets, top, bottom, left and right must all be numbers");this.top=n,this.bottom=s,this.left=a,this.right=u};Ho.prototype.interpolate=function(n,s,a){return s.top!=null&&n.top!=null&&(this.top=o.number(n.top,s.top,a)),s.bottom!=null&&n.bottom!=null&&(this.bottom=o.number(n.bottom,s.bottom,a)),s.left!=null&&n.left!=null&&(this.left=o.number(n.left,s.left,a)),s.right!=null&&n.right!=null&&(this.right=o.number(n.right,s.right,a)),this},Ho.prototype.getCenter=function(n,s){var a=o.clamp((this.left+n-this.right)/2,0,n),u=o.clamp((this.top+s-this.bottom)/2,0,s);return new o.Point(a,u)},Ho.prototype.equals=function(n){return this.top===n.top&&this.bottom===n.bottom&&this.left===n.left&&this.right===n.right},Ho.prototype.clone=function(){return new Ho(this.top,this.bottom,this.left,this.right)},Ho.prototype.toJSON=function(){return{top:this.top,bottom:this.bottom,left:this.left,right:this.right}};var mr=function(n,s,a,u,y){this.tileSize=512,this.maxValidLatitude=85.051129,this._renderWorldCopies=y===void 0||y,this._minZoom=n||0,this._maxZoom=s||22,this._minPitch=a??0,this._maxPitch=u??60,this.setMaxBounds(),this.width=0,this.height=0,this._center=new o.LngLat(0,0),this.zoom=0,this.angle=0,this._fov=.6435011087932844,this._pitch=0,this._unmodified=!0,this._edgeInsets=new Ho,this._posMatrixCache={},this._alignedPosMatrixCache={}},jr={minZoom:{configurable:!0},maxZoom:{configurable:!0},minPitch:{configurable:!0},maxPitch:{configurable:!0},renderWorldCopies:{configurable:!0},worldSize:{configurable:!0},centerOffset:{configurable:!0},size:{configurable:!0},bearing:{configurable:!0},pitch:{configurable:!0},fov:{configurable:!0},zoom:{configurable:!0},center:{configurable:!0},padding:{configurable:!0},centerPoint:{configurable:!0},unmodified:{configurable:!0},point:{configurable:!0}};mr.prototype.clone=function(){var n=new mr(this._minZoom,this._maxZoom,this._minPitch,this.maxPitch,this._renderWorldCopies);return n.tileSize=this.tileSize,n.latRange=this.latRange,n.width=this.width,n.height=this.height,n._center=this._center,n.zoom=this.zoom,n.angle=this.angle,n._fov=this._fov,n._pitch=this._pitch,n._unmodified=this._unmodified,n._edgeInsets=this._edgeInsets.clone(),n._calcMatrices(),n},jr.minZoom.get=function(){return this._minZoom},jr.minZoom.set=function(n){this._minZoom!==n&&(this._minZoom=n,this.zoom=Math.max(this.zoom,n))},jr.maxZoom.get=function(){return this._maxZoom},jr.maxZoom.set=function(n){this._maxZoom!==n&&(this._maxZoom=n,this.zoom=Math.min(this.zoom,n))},jr.minPitch.get=function(){return this._minPitch},jr.minPitch.set=function(n){this._minPitch!==n&&(this._minPitch=n,this.pitch=Math.max(this.pitch,n))},jr.maxPitch.get=function(){return this._maxPitch},jr.maxPitch.set=function(n){this._maxPitch!==n&&(this._maxPitch=n,this.pitch=Math.min(this.pitch,n))},jr.renderWorldCopies.get=function(){return this._renderWorldCopies},jr.renderWorldCopies.set=function(n){n===void 0?n=!0:n===null&&(n=!1),this._renderWorldCopies=n},jr.worldSize.get=function(){return this.tileSize*this.scale},jr.centerOffset.get=function(){return this.centerPoint._sub(this.size._div(2))},jr.size.get=function(){return new o.Point(this.width,this.height)},jr.bearing.get=function(){return-this.angle/Math.PI*180},jr.bearing.set=function(n){var s=-o.wrap(n,-180,180)*Math.PI/180;this.angle!==s&&(this._unmodified=!1,this.angle=s,this._calcMatrices(),this.rotationMatrix=o.create$2(),o.rotate(this.rotationMatrix,this.rotationMatrix,this.angle))},jr.pitch.get=function(){return this._pitch/Math.PI*180},jr.pitch.set=function(n){var s=o.clamp(n,this.minPitch,this.maxPitch)/180*Math.PI;this._pitch!==s&&(this._unmodified=!1,this._pitch=s,this._calcMatrices())},jr.fov.get=function(){return this._fov/Math.PI*180},jr.fov.set=function(n){n=Math.max(.01,Math.min(60,n)),this._fov!==n&&(this._unmodified=!1,this._fov=n/180*Math.PI,this._calcMatrices())},jr.zoom.get=function(){return this._zoom},jr.zoom.set=function(n){var s=Math.min(Math.max(n,this.minZoom),this.maxZoom);this._zoom!==s&&(this._unmodified=!1,this._zoom=s,this.scale=this.zoomScale(s),this.tileZoom=Math.floor(s),this.zoomFraction=s-this.tileZoom,this._constrain(),this._calcMatrices())},jr.center.get=function(){return this._center},jr.center.set=function(n){n.lat===this._center.lat&&n.lng===this._center.lng||(this._unmodified=!1,this._center=n,this._constrain(),this._calcMatrices())},jr.padding.get=function(){return this._edgeInsets.toJSON()},jr.padding.set=function(n){this._edgeInsets.equals(n)||(this._unmodified=!1,this._edgeInsets.interpolate(this._edgeInsets,n,1),this._calcMatrices())},jr.centerPoint.get=function(){return this._edgeInsets.getCenter(this.width,this.height)},mr.prototype.isPaddingEqual=function(n){return this._edgeInsets.equals(n)},mr.prototype.interpolatePadding=function(n,s,a){this._unmodified=!1,this._edgeInsets.interpolate(n,s,a),this._constrain(),this._calcMatrices()},mr.prototype.coveringZoomLevel=function(n){var s=(n.roundZoom?Math.round:Math.floor)(this.zoom+this.scaleZoom(this.tileSize/n.tileSize));return Math.max(0,s)},mr.prototype.getVisibleUnwrappedCoordinates=function(n){var s=[new o.UnwrappedTileID(0,n)];if(this._renderWorldCopies)for(var a=this.pointCoordinate(new o.Point(0,0)),u=this.pointCoordinate(new o.Point(this.width,0)),y=this.pointCoordinate(new o.Point(this.width,this.height)),w=this.pointCoordinate(new o.Point(0,this.height)),k=Math.floor(Math.min(a.x,u.x,y.x,w.x)),E=Math.floor(Math.max(a.x,u.x,y.x,w.x)),P=k-1;P<=E+1;P++)P!==0&&s.push(new o.UnwrappedTileID(P,n));return s},mr.prototype.coveringTiles=function(n){var s=this.coveringZoomLevel(n),a=s;if(n.minzoom!==void 0&&s<n.minzoom)return[];n.maxzoom!==void 0&&s>n.maxzoom&&(s=n.maxzoom);var u=o.MercatorCoordinate.fromLngLat(this.center),y=Math.pow(2,s),w=[y*u.x,y*u.y,0],k=Ks.fromInvProjectionMatrix(this.invProjMatrix,this.worldSize,s),E=n.minzoom||0;this.pitch<=60&&this._edgeInsets.top<.1&&(E=s);var P=function(Ze){return{aabb:new Sa([Ze*y,0,0],[(Ze+1)*y,y,0]),zoom:0,x:0,y:0,wrap:Ze,fullyVisible:!1}},O=[],Z=[],G=s,K=n.reparseOverscaled?a:s;if(this._renderWorldCopies)for(var re=1;re<=3;re++)O.push(P(-re)),O.push(P(re));for(O.push(P(0));O.length>0;){var te=O.pop(),ue=te.x,Y=te.y,le=te.fullyVisible;if(!le){var fe=te.aabb.intersects(k);if(fe===0)continue;le=fe===2}var ge=te.aabb.distanceX(w),ze=te.aabb.distanceY(w),Ee=Math.max(Math.abs(ge),Math.abs(ze));if(te.zoom===G||Ee>3+(1<<G-te.zoom)-2&&te.zoom>=E)Z.push({tileID:new o.OverscaledTileID(te.zoom===G?K:te.zoom,te.wrap,te.zoom,ue,Y),distanceSq:o.sqrLen([w[0]-.5-ue,w[1]-.5-Y])});else for(var Ae=0;Ae<4;Ae++){var De=(ue<<1)+Ae%2,Ke=(Y<<1)+(Ae>>1);O.push({aabb:te.aabb.quadrant(Ae),zoom:te.zoom+1,x:De,y:Ke,wrap:te.wrap,fullyVisible:le})}}return Z.sort(function(Ze,nt){return Ze.distanceSq-nt.distanceSq}).map(function(Ze){return Ze.tileID})},mr.prototype.resize=function(n,s){this.width=n,this.height=s,this.pixelsToGLUnits=[2/n,-2/s],this._constrain(),this._calcMatrices()},jr.unmodified.get=function(){return this._unmodified},mr.prototype.zoomScale=function(n){return Math.pow(2,n)},mr.prototype.scaleZoom=function(n){return Math.log(n)/Math.LN2},mr.prototype.project=function(n){var s=o.clamp(n.lat,-this.maxValidLatitude,this.maxValidLatitude);return new o.Point(o.mercatorXfromLng(n.lng)*this.worldSize,o.mercatorYfromLat(s)*this.worldSize)},mr.prototype.unproject=function(n){return new o.MercatorCoordinate(n.x/this.worldSize,n.y/this.worldSize).toLngLat()},jr.point.get=function(){return this.project(this.center)},mr.prototype.setLocationAtPoint=function(n,s){var a=this.pointCoordinate(s),u=this.pointCoordinate(this.centerPoint),y=this.locationCoordinate(n),w=new o.MercatorCoordinate(y.x-(a.x-u.x),y.y-(a.y-u.y));this.center=this.coordinateLocation(w),this._renderWorldCopies&&(this.center=this.center.wrap())},mr.prototype.locationPoint=function(n){return this.coordinatePoint(this.locationCoordinate(n))},mr.prototype.pointLocation=function(n){return this.coordinateLocation(this.pointCoordinate(n))},mr.prototype.locationCoordinate=function(n){return o.MercatorCoordinate.fromLngLat(n)},mr.prototype.coordinateLocation=function(n){return n.toLngLat()},mr.prototype.pointCoordinate=function(n){var s=[n.x,n.y,0,1],a=[n.x,n.y,1,1];o.transformMat4(s,s,this.pixelMatrixInverse),o.transformMat4(a,a,this.pixelMatrixInverse);var u=s[3],y=a[3],w=s[1]/u,k=a[1]/y,E=s[2]/u,P=a[2]/y,O=E===P?0:(0-E)/(P-E);return new o.MercatorCoordinate(o.number(s[0]/u,a[0]/y,O)/this.worldSize,o.number(w,k,O)/this.worldSize)},mr.prototype.coordinatePoint=function(n){var s=[n.x*this.worldSize,n.y*this.worldSize,0,1];return o.transformMat4(s,s,this.pixelMatrix),new o.Point(s[0]/s[3],s[1]/s[3])},mr.prototype.getBounds=function(){return new o.LngLatBounds().extend(this.pointLocation(new o.Point(0,0))).extend(this.pointLocation(new o.Point(this.width,0))).extend(this.pointLocation(new o.Point(this.width,this.height))).extend(this.pointLocation(new o.Point(0,this.height)))},mr.prototype.getMaxBounds=function(){return this.latRange&&this.latRange.length===2&&this.lngRange&&this.lngRange.length===2?new o.LngLatBounds([this.lngRange[0],this.latRange[0]],[this.lngRange[1],this.latRange[1]]):null},mr.prototype.setMaxBounds=function(n){n?(this.lngRange=[n.getWest(),n.getEast()],this.latRange=[n.getSouth(),n.getNorth()],this._constrain()):(this.lngRange=null,this.latRange=[-this.maxValidLatitude,this.maxValidLatitude])},mr.prototype.calculatePosMatrix=function(n,s){s===void 0&&(s=!1);var a=n.key,u=s?this._alignedPosMatrixCache:this._posMatrixCache;if(u[a])return u[a];var y=n.canonical,w=this.worldSize/this.zoomScale(y.z),k=y.x+Math.pow(2,y.z)*n.wrap,E=o.identity(new Float64Array(16));return o.translate(E,E,[k*w,y.y*w,0]),o.scale(E,E,[w/o.EXTENT,w/o.EXTENT,1]),o.multiply(E,s?this.alignedProjMatrix:this.projMatrix,E),u[a]=new Float32Array(E),u[a]},mr.prototype.customLayerMatrix=function(){return this.mercatorMatrix.slice()},mr.prototype._constrain=function(){if(this.center&&this.width&&this.height&&!this._constraining){this._constraining=!0;var n,s,a,u,y=-90,w=90,k=-180,E=180,P=this.size,O=this._unmodified;if(this.latRange){var Z=this.latRange;y=o.mercatorYfromLat(Z[1])*this.worldSize,n=(w=o.mercatorYfromLat(Z[0])*this.worldSize)-y<P.y?P.y/(w-y):0}if(this.lngRange){var G=this.lngRange;k=o.mercatorXfromLng(G[0])*this.worldSize,s=(E=o.mercatorXfromLng(G[1])*this.worldSize)-k<P.x?P.x/(E-k):0}var K=this.point,re=Math.max(s||0,n||0);if(re)return this.center=this.unproject(new o.Point(s?(E+k)/2:K.x,n?(w+y)/2:K.y)),this.zoom+=this.scaleZoom(re),this._unmodified=O,void(this._constraining=!1);if(this.latRange){var te=K.y,ue=P.y/2;te-ue<y&&(u=y+ue),te+ue>w&&(u=w-ue)}if(this.lngRange){var Y=K.x,le=P.x/2;Y-le<k&&(a=k+le),Y+le>E&&(a=E-le)}a===void 0&&u===void 0||(this.center=this.unproject(new o.Point(a!==void 0?a:K.x,u!==void 0?u:K.y))),this._unmodified=O,this._constraining=!1}},mr.prototype._calcMatrices=function(){if(this.height){var n=this.centerOffset;this.cameraToCenterDistance=.5/Math.tan(this._fov/2)*this.height;var s=Math.PI/2+this._pitch,a=this._fov*(.5+n.y/this.height),u=Math.sin(a)*this.cameraToCenterDistance/Math.sin(o.clamp(Math.PI-s-a,.01,Math.PI-.01)),y=this.point,w=y.x,k=y.y,E=1.01*(Math.cos(Math.PI/2-this._pitch)*u+this.cameraToCenterDistance),P=this.height/50,O=new Float64Array(16);o.perspective(O,this._fov,this.width/this.height,P,E),O[8]=2*-n.x/this.width,O[9]=2*n.y/this.height,o.scale(O,O,[1,-1,1]),o.translate(O,O,[0,0,-this.cameraToCenterDistance]),o.rotateX(O,O,this._pitch),o.rotateZ(O,O,this.angle),o.translate(O,O,[-w,-k,0]),this.mercatorMatrix=o.scale([],O,[this.worldSize,this.worldSize,this.worldSize]),o.scale(O,O,[1,1,o.mercatorZfromAltitude(1,this.center.lat)*this.worldSize,1]),this.projMatrix=O,this.invProjMatrix=o.invert([],this.projMatrix);var Z=this.width%2/2,G=this.height%2/2,K=Math.cos(this.angle),re=Math.sin(this.angle),te=w-Math.round(w)+K*Z+re*G,ue=k-Math.round(k)+K*G+re*Z,Y=new Float64Array(O);if(o.translate(Y,Y,[te>.5?te-1:te,ue>.5?ue-1:ue,0]),this.alignedProjMatrix=Y,O=o.create(),o.scale(O,O,[this.width/2,-this.height/2,1]),o.translate(O,O,[1,-1,0]),this.labelPlaneMatrix=O,O=o.create(),o.scale(O,O,[1,-1,1]),o.translate(O,O,[-1,-1,0]),o.scale(O,O,[2/this.width,2/this.height,1]),this.glCoordMatrix=O,this.pixelMatrix=o.multiply(new Float64Array(16),this.labelPlaneMatrix,this.projMatrix),!(O=o.invert(new Float64Array(16),this.pixelMatrix)))throw new Error("failed to invert matrix");this.pixelMatrixInverse=O,this._posMatrixCache={},this._alignedPosMatrixCache={}}},mr.prototype.maxPitchScaleFactor=function(){if(!this.pixelMatrixInverse)return 1;var n=this.pointCoordinate(new o.Point(0,0)),s=[n.x*this.worldSize,n.y*this.worldSize,0,1];return o.transformMat4(s,s,this.pixelMatrix)[3]/this.cameraToCenterDistance},mr.prototype.getCameraPoint=function(){var n=Math.tan(this._pitch)*(this.cameraToCenterDistance||1);return this.centerPoint.add(new o.Point(0,n))},mr.prototype.getCameraQueryGeometry=function(n){var s=this.getCameraPoint();if(n.length===1)return[n[0],s];for(var a=s.x,u=s.y,y=s.x,w=s.y,k=0,E=n;k<E.length;k+=1){var P=E[k];a=Math.min(a,P.x),u=Math.min(u,P.y),y=Math.max(y,P.x),w=Math.max(w,P.y)}return[new o.Point(a,u),new o.Point(y,u),new o.Point(y,w),new o.Point(a,w),new o.Point(a,u)]},Object.defineProperties(mr.prototype,jr);var Yn=function(n){var s,a,u,y;this._hashName=n&&encodeURIComponent(n),o.bindAll(["_getCurrentHash","_onHashChange","_updateHash"],this),this._updateHash=(s=this._updateHashUnthrottled.bind(this),a=!1,u=null,y=function(){u=null,a&&(s(),u=setTimeout(y,300),a=!1)},function(){return a=!0,u||y(),u})};Yn.prototype.addTo=function(n){return this._map=n,o.window.addEventListener("hashchange",this._onHashChange,!1),this._map.on("moveend",this._updateHash),this},Yn.prototype.remove=function(){return o.window.removeEventListener("hashchange",this._onHashChange,!1),this._map.off("moveend",this._updateHash),clearTimeout(this._updateHash()),delete this._map,this},Yn.prototype.getHashString=function(n){var s=this._map.getCenter(),a=Math.round(100*this._map.getZoom())/100,u=Math.ceil((a*Math.LN2+Math.log(512/360/.5))/Math.LN10),y=Math.pow(10,u),w=Math.round(s.lng*y)/y,k=Math.round(s.lat*y)/y,E=this._map.getBearing(),P=this._map.getPitch(),O="";if(O+=n?"/"+w+"/"+k+"/"+a:a+"/"+k+"/"+w,(E||P)&&(O+="/"+Math.round(10*E)/10),P&&(O+="/"+Math.round(P)),this._hashName){var Z=this._hashName,G=!1,K=o.window.location.hash.slice(1).split("&").map(function(re){var te=re.split("=")[0];return te===Z?(G=!0,te+"="+O):re}).filter(function(re){return re});return G||K.push(Z+"="+O),"#"+K.join("&")}return"#"+O},Yn.prototype._getCurrentHash=function(){var n,s=this,a=o.window.location.hash.replace("#","");return this._hashName?(a.split("&").map(function(u){return u.split("=")}).forEach(function(u){u[0]===s._hashName&&(n=u)}),(n&&n[1]||"").split("/")):a.split("/")},Yn.prototype._onHashChange=function(){var n=this._getCurrentHash();if(n.length>=3&&!n.some(function(a){return isNaN(a)})){var s=this._map.dragRotate.isEnabled()&&this._map.touchZoomRotate.isEnabled()?+(n[3]||0):this._map.getBearing();return this._map.jumpTo({center:[+n[2],+n[1]],zoom:+n[0],bearing:s,pitch:+(n[4]||0)}),!0}return!1},Yn.prototype._updateHashUnthrottled=function(){var n=o.window.location.href.replace(/(#.+)?$/,this.getHashString());try{o.window.history.replaceState(o.window.history.state,null,n)}catch{}};var fs={linearity:.3,easing:o.bezier(0,0,.3,1)},qa=o.extend({deceleration:2500,maxSpeed:1400},fs),ds=o.extend({deceleration:20,maxSpeed:1400},fs),Zh=o.extend({deceleration:1e3,maxSpeed:360},fs),Gh=o.extend({deceleration:1e3,maxSpeed:90},fs),ms=function(n){this._map=n,this.clear()};function ys(n,s){(!n.duration||n.duration<s.duration)&&(n.duration=s.duration,n.easing=s.easing)}function Mo(n,s,a){var u=a.maxSpeed,y=a.linearity,w=a.deceleration,k=o.clamp(n*y/(s/1e3),-u,u),E=Math.abs(k)/(w*y);return{easing:a.easing,duration:1e3*E,amount:k*(E/2)}}ms.prototype.clear=function(){this._inertiaBuffer=[]},ms.prototype.record=function(n){this._drainInertiaBuffer(),this._inertiaBuffer.push({time:o.browser.now(),settings:n})},ms.prototype._drainInertiaBuffer=function(){for(var n=this._inertiaBuffer,s=o.browser.now();n.length>0&&s-n[0].time>160;)n.shift()},ms.prototype._onMoveEnd=function(n){if(this._drainInertiaBuffer(),!(this._inertiaBuffer.length<2)){for(var s={zoom:0,bearing:0,pitch:0,pan:new o.Point(0,0),pinchAround:void 0,around:void 0},a=0,u=this._inertiaBuffer;a<u.length;a+=1){var y=u[a].settings;s.zoom+=y.zoomDelta||0,s.bearing+=y.bearingDelta||0,s.pitch+=y.pitchDelta||0,y.panDelta&&s.pan._add(y.panDelta),y.around&&(s.around=y.around),y.pinchAround&&(s.pinchAround=y.pinchAround)}var w=this._inertiaBuffer[this._inertiaBuffer.length-1].time-this._inertiaBuffer[0].time,k={};if(s.pan.mag()){var E=Mo(s.pan.mag(),w,o.extend({},qa,n||{}));k.offset=s.pan.mult(E.amount/s.pan.mag()),k.center=this._map.transform.center,ys(k,E)}if(s.zoom){var P=Mo(s.zoom,w,ds);k.zoom=this._map.transform.zoom+P.amount,ys(k,P)}if(s.bearing){var O=Mo(s.bearing,w,Zh);k.bearing=this._map.transform.bearing+o.clamp(O.amount,-179,179),ys(k,O)}if(s.pitch){var Z=Mo(s.pitch,w,Gh);k.pitch=this._map.transform.pitch+Z.amount,ys(k,Z)}if(k.zoom||k.bearing){var G=s.pinchAround===void 0?s.around:s.pinchAround;k.around=G?this._map.unproject(G):this._map.getCenter()}return this.clear(),o.extend(k,{noMoveStart:!0})}};var Ti=function(n){function s(u,y,w,k){k===void 0&&(k={});var E=T.mousePos(y.getCanvasContainer(),w),P=y.unproject(E);n.call(this,u,o.extend({point:E,lngLat:P,originalEvent:w},k)),this._defaultPrevented=!1,this.target=y}n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s;var a={defaultPrevented:{configurable:!0}};return s.prototype.preventDefault=function(){this._defaultPrevented=!0},a.defaultPrevented.get=function(){return this._defaultPrevented},Object.defineProperties(s.prototype,a),s}(o.Event),_s=function(n){function s(u,y,w){var k=u==="touchend"?w.changedTouches:w.touches,E=T.touchPos(y.getCanvasContainer(),k),P=E.map(function(G){return y.unproject(G)}),O=E.reduce(function(G,K,re,te){return G.add(K.div(te.length))},new o.Point(0,0)),Z=y.unproject(O);n.call(this,u,{points:E,point:O,lngLats:P,lngLat:Z,originalEvent:w}),this._defaultPrevented=!1}n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s;var a={defaultPrevented:{configurable:!0}};return s.prototype.preventDefault=function(){this._defaultPrevented=!0},a.defaultPrevented.get=function(){return this._defaultPrevented},Object.defineProperties(s.prototype,a),s}(o.Event),kc=function(n){function s(u,y,w){n.call(this,u,{originalEvent:w}),this._defaultPrevented=!1}n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s;var a={defaultPrevented:{configurable:!0}};return s.prototype.preventDefault=function(){this._defaultPrevented=!0},a.defaultPrevented.get=function(){return this._defaultPrevented},Object.defineProperties(s.prototype,a),s}(o.Event),bi=function(n,s){this._map=n,this._clickTolerance=s.clickTolerance};bi.prototype.reset=function(){delete this._mousedownPos},bi.prototype.wheel=function(n){return this._firePreventable(new kc(n.type,this._map,n))},bi.prototype.mousedown=function(n,s){return this._mousedownPos=s,this._firePreventable(new Ti(n.type,this._map,n))},bi.prototype.mouseup=function(n){this._map.fire(new Ti(n.type,this._map,n))},bi.prototype.click=function(n,s){this._mousedownPos&&this._mousedownPos.dist(s)>=this._clickTolerance||this._map.fire(new Ti(n.type,this._map,n))},bi.prototype.dblclick=function(n){return this._firePreventable(new Ti(n.type,this._map,n))},bi.prototype.mouseover=function(n){this._map.fire(new Ti(n.type,this._map,n))},bi.prototype.mouseout=function(n){this._map.fire(new Ti(n.type,this._map,n))},bi.prototype.touchstart=function(n){return this._firePreventable(new _s(n.type,this._map,n))},bi.prototype.touchmove=function(n){this._map.fire(new _s(n.type,this._map,n))},bi.prototype.touchend=function(n){this._map.fire(new _s(n.type,this._map,n))},bi.prototype.touchcancel=function(n){this._map.fire(new _s(n.type,this._map,n))},bi.prototype._firePreventable=function(n){if(this._map.fire(n),n.defaultPrevented)return{}},bi.prototype.isEnabled=function(){return!0},bi.prototype.isActive=function(){return!1},bi.prototype.enable=function(){},bi.prototype.disable=function(){};var st=function(n){this._map=n};st.prototype.reset=function(){this._delayContextMenu=!1,delete this._contextMenuEvent},st.prototype.mousemove=function(n){this._map.fire(new Ti(n.type,this._map,n))},st.prototype.mousedown=function(){this._delayContextMenu=!0},st.prototype.mouseup=function(){this._delayContextMenu=!1,this._contextMenuEvent&&(this._map.fire(new Ti("contextmenu",this._map,this._contextMenuEvent)),delete this._contextMenuEvent)},st.prototype.contextmenu=function(n){this._delayContextMenu?this._contextMenuEvent=n:this._map.fire(new Ti(n.type,this._map,n)),this._map.listens("contextmenu")&&n.preventDefault()},st.prototype.isEnabled=function(){return!0},st.prototype.isActive=function(){return!1},st.prototype.enable=function(){},st.prototype.disable=function(){};var Un=function(n,s){this._map=n,this._el=n.getCanvasContainer(),this._container=n.getContainer(),this._clickTolerance=s.clickTolerance||1};function Xs(n,s){for(var a={},u=0;u<n.length;u++)a[n[u].identifier]=s[u];return a}Un.prototype.isEnabled=function(){return!!this._enabled},Un.prototype.isActive=function(){return!!this._active},Un.prototype.enable=function(){this.isEnabled()||(this._enabled=!0)},Un.prototype.disable=function(){this.isEnabled()&&(this._enabled=!1)},Un.prototype.mousedown=function(n,s){this.isEnabled()&&n.shiftKey&&n.button===0&&(T.disableDrag(),this._startPos=this._lastPos=s,this._active=!0)},Un.prototype.mousemoveWindow=function(n,s){if(this._active){var a=s;if(!(this._lastPos.equals(a)||!this._box&&a.dist(this._startPos)<this._clickTolerance)){var u=this._startPos;this._lastPos=a,this._box||(this._box=T.create("div","mapboxgl-boxzoom",this._container),this._container.classList.add("mapboxgl-crosshair"),this._fireEvent("boxzoomstart",n));var y=Math.min(u.x,a.x),w=Math.max(u.x,a.x),k=Math.min(u.y,a.y),E=Math.max(u.y,a.y);T.setTransform(this._box,"translate("+y+"px,"+k+"px)"),this._box.style.width=w-y+"px",this._box.style.height=E-k+"px"}}},Un.prototype.mouseupWindow=function(n,s){var a=this;if(this._active&&n.button===0){var u=this._startPos,y=s;if(this.reset(),T.suppressClick(),u.x!==y.x||u.y!==y.y)return this._map.fire(new o.Event("boxzoomend",{originalEvent:n})),{cameraAnimation:function(w){return w.fitScreenCoordinates(u,y,a._map.getBearing(),{linear:!0})}};this._fireEvent("boxzoomcancel",n)}},Un.prototype.keydown=function(n){this._active&&n.keyCode===27&&(this.reset(),this._fireEvent("boxzoomcancel",n))},Un.prototype.blur=function(){this.reset()},Un.prototype.reset=function(){this._active=!1,this._container.classList.remove("mapboxgl-crosshair"),this._box&&(T.remove(this._box),this._box=null),T.enableDrag(),delete this._startPos,delete this._lastPos},Un.prototype._fireEvent=function(n,s){return this._map.fire(new o.Event(n,{originalEvent:s}))};var Za=function(n){this.reset(),this.numTouches=n.numTouches};Za.prototype.reset=function(){delete this.centroid,delete this.startTime,delete this.touches,this.aborted=!1},Za.prototype.touchstart=function(n,s,a){(this.centroid||a.length>this.numTouches)&&(this.aborted=!0),this.aborted||(this.startTime===void 0&&(this.startTime=n.timeStamp),a.length===this.numTouches&&(this.centroid=function(u){for(var y=new o.Point(0,0),w=0,k=u;w<k.length;w+=1)y._add(k[w]);return y.div(u.length)}(s),this.touches=Xs(a,s)))},Za.prototype.touchmove=function(n,s,a){if(!this.aborted&&this.centroid){var u=Xs(a,s);for(var y in this.touches){var w=u[y];(!w||w.dist(this.touches[y])>30)&&(this.aborted=!0)}}},Za.prototype.touchend=function(n,s,a){if((!this.centroid||n.timeStamp-this.startTime>500)&&(this.aborted=!0),a.length===0){var u=!this.aborted&&this.centroid;if(this.reset(),u)return u}};var fo=function(n){this.singleTap=new Za(n),this.numTaps=n.numTaps,this.reset()};fo.prototype.reset=function(){this.lastTime=1/0,delete this.lastTap,this.count=0,this.singleTap.reset()},fo.prototype.touchstart=function(n,s,a){this.singleTap.touchstart(n,s,a)},fo.prototype.touchmove=function(n,s,a){this.singleTap.touchmove(n,s,a)},fo.prototype.touchend=function(n,s,a){var u=this.singleTap.touchend(n,s,a);if(u){var y=n.timeStamp-this.lastTime<500,w=!this.lastTap||this.lastTap.dist(u)<30;if(y&&w||this.reset(),this.count++,this.lastTime=n.timeStamp,this.lastTap=u,this.count===this.numTaps)return this.reset(),u}};var Vn=function(){this._zoomIn=new fo({numTouches:1,numTaps:2}),this._zoomOut=new fo({numTouches:2,numTaps:1}),this.reset()};Vn.prototype.reset=function(){this._active=!1,this._zoomIn.reset(),this._zoomOut.reset()},Vn.prototype.touchstart=function(n,s,a){this._zoomIn.touchstart(n,s,a),this._zoomOut.touchstart(n,s,a)},Vn.prototype.touchmove=function(n,s,a){this._zoomIn.touchmove(n,s,a),this._zoomOut.touchmove(n,s,a)},Vn.prototype.touchend=function(n,s,a){var u=this,y=this._zoomIn.touchend(n,s,a),w=this._zoomOut.touchend(n,s,a);return y?(this._active=!0,n.preventDefault(),setTimeout(function(){return u.reset()},0),{cameraAnimation:function(k){return k.easeTo({duration:300,zoom:k.getZoom()+1,around:k.unproject(y)},{originalEvent:n})}}):w?(this._active=!0,n.preventDefault(),setTimeout(function(){return u.reset()},0),{cameraAnimation:function(k){return k.easeTo({duration:300,zoom:k.getZoom()-1,around:k.unproject(w)},{originalEvent:n})}}):void 0},Vn.prototype.touchcancel=function(){this.reset()},Vn.prototype.enable=function(){this._enabled=!0},Vn.prototype.disable=function(){this._enabled=!1,this.reset()},Vn.prototype.isEnabled=function(){return this._enabled},Vn.prototype.isActive=function(){return this._active};var Wl={0:1,2:2},Qe=function(n){this.reset(),this._clickTolerance=n.clickTolerance||1};Qe.prototype.blur=function(){this.reset()},Qe.prototype.reset=function(){this._active=!1,this._moved=!1,delete this._lastPoint,delete this._eventButton},Qe.prototype._correctButton=function(n,s){return!1},Qe.prototype._move=function(n,s){return{}},Qe.prototype.mousedown=function(n,s){if(!this._lastPoint){var a=T.mouseButton(n);this._correctButton(n,a)&&(this._lastPoint=s,this._eventButton=a)}},Qe.prototype.mousemoveWindow=function(n,s){var a=this._lastPoint;if(a){if(n.preventDefault(),function(u,y){var w=Wl[y];return u.buttons===void 0||(u.buttons&w)!==w}(n,this._eventButton))this.reset();else if(this._moved||!(s.dist(a)<this._clickTolerance))return this._moved=!0,this._lastPoint=s,this._move(a,s)}},Qe.prototype.mouseupWindow=function(n){this._lastPoint&&T.mouseButton(n)===this._eventButton&&(this._moved&&T.suppressClick(),this.reset())},Qe.prototype.enable=function(){this._enabled=!0},Qe.prototype.disable=function(){this._enabled=!1,this.reset()},Qe.prototype.isEnabled=function(){return this._enabled},Qe.prototype.isActive=function(){return this._active};var Hl=function(n){function s(){n.apply(this,arguments)}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype.mousedown=function(a,u){n.prototype.mousedown.call(this,a,u),this._lastPoint&&(this._active=!0)},s.prototype._correctButton=function(a,u){return u===0&&!a.ctrlKey},s.prototype._move=function(a,u){return{around:u,panDelta:u.sub(a)}},s}(Qe),Ws=function(n){function s(){n.apply(this,arguments)}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype._correctButton=function(a,u){return u===0&&a.ctrlKey||u===2},s.prototype._move=function(a,u){var y=.8*(u.x-a.x);if(y)return this._active=!0,{bearingDelta:y}},s.prototype.contextmenu=function(a){a.preventDefault()},s}(Qe),Jl=function(n){function s(){n.apply(this,arguments)}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype._correctButton=function(a,u){return u===0&&a.ctrlKey||u===2},s.prototype._move=function(a,u){var y=-.5*(u.y-a.y);if(y)return this._active=!0,{pitchDelta:y}},s.prototype.contextmenu=function(a){a.preventDefault()},s}(Qe),io=function(n){this._minTouches=1,this._clickTolerance=n.clickTolerance||1,this.reset()};io.prototype.reset=function(){this._active=!1,this._touches={},this._sum=new o.Point(0,0)},io.prototype.touchstart=function(n,s,a){return this._calculateTransform(n,s,a)},io.prototype.touchmove=function(n,s,a){if(this._active&&!(a.length<this._minTouches))return n.preventDefault(),this._calculateTransform(n,s,a)},io.prototype.touchend=function(n,s,a){this._calculateTransform(n,s,a),this._active&&a.length<this._minTouches&&this.reset()},io.prototype.touchcancel=function(){this.reset()},io.prototype._calculateTransform=function(n,s,a){a.length>0&&(this._active=!0);var u=Xs(a,s),y=new o.Point(0,0),w=new o.Point(0,0),k=0;for(var E in u){var P=u[E],O=this._touches[E];O&&(y._add(P),w._add(P.sub(O)),k++,u[E]=P)}if(this._touches=u,!(k<this._minTouches)&&w.mag()){var Z=w.div(k);if(this._sum._add(Z),!(this._sum.mag()<this._clickTolerance))return{around:y.div(k),panDelta:Z}}},io.prototype.enable=function(){this._enabled=!0},io.prototype.disable=function(){this._enabled=!1,this.reset()},io.prototype.isEnabled=function(){return this._enabled},io.prototype.isActive=function(){return this._active};var jn=function(){this.reset()};function Hs(n,s,a){for(var u=0;u<n.length;u++)if(n[u].identifier===a)return s[u]}function Js(n,s){return Math.log(n/s)/Math.LN2}jn.prototype.reset=function(){this._active=!1,delete this._firstTwoTouches},jn.prototype._start=function(n){},jn.prototype._move=function(n,s,a){return{}},jn.prototype.touchstart=function(n,s,a){this._firstTwoTouches||a.length<2||(this._firstTwoTouches=[a[0].identifier,a[1].identifier],this._start([s[0],s[1]]))},jn.prototype.touchmove=function(n,s,a){if(this._firstTwoTouches){n.preventDefault();var u=this._firstTwoTouches,y=u[1],w=Hs(a,s,u[0]),k=Hs(a,s,y);if(w&&k){var E=this._aroundCenter?null:w.add(k).div(2);return this._move([w,k],E,n)}}},jn.prototype.touchend=function(n,s,a){if(this._firstTwoTouches){var u=this._firstTwoTouches,y=u[1],w=Hs(a,s,u[0]),k=Hs(a,s,y);w&&k||(this._active&&T.suppressClick(),this.reset())}},jn.prototype.touchcancel=function(){this.reset()},jn.prototype.enable=function(n){this._enabled=!0,this._aroundCenter=!!n&&n.around==="center"},jn.prototype.disable=function(){this._enabled=!1,this.reset()},jn.prototype.isEnabled=function(){return this._enabled},jn.prototype.isActive=function(){return this._active};var qn=function(n){function s(){n.apply(this,arguments)}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype.reset=function(){n.prototype.reset.call(this),delete this._distance,delete this._startDistance},s.prototype._start=function(a){this._startDistance=this._distance=a[0].dist(a[1])},s.prototype._move=function(a,u){var y=this._distance;if(this._distance=a[0].dist(a[1]),this._active||!(Math.abs(Js(this._distance,this._startDistance))<.1))return this._active=!0,{zoomDelta:Js(this._distance,y),pinchAround:u}},s}(jn);function Do(n,s){return 180*n.angleWith(s)/Math.PI}var Sc=function(n){function s(){n.apply(this,arguments)}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype.reset=function(){n.prototype.reset.call(this),delete this._minDiameter,delete this._startVector,delete this._vector},s.prototype._start=function(a){this._startVector=this._vector=a[0].sub(a[1]),this._minDiameter=a[0].dist(a[1])},s.prototype._move=function(a,u){var y=this._vector;if(this._vector=a[0].sub(a[1]),this._active||!this._isBelowThreshold(this._vector))return this._active=!0,{bearingDelta:Do(this._vector,y),pinchAround:u}},s.prototype._isBelowThreshold=function(a){this._minDiameter=Math.min(this._minDiameter,a.mag());var u=25/(Math.PI*this._minDiameter)*360,y=Do(a,this._startVector);return Math.abs(y)<u},s}(jn);function gs(n){return Math.abs(n.y)>Math.abs(n.x)}var Yl=function(n){function s(){n.apply(this,arguments)}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype.reset=function(){n.prototype.reset.call(this),this._valid=void 0,delete this._firstMove,delete this._lastPoints},s.prototype._start=function(a){this._lastPoints=a,gs(a[0].sub(a[1]))&&(this._valid=!1)},s.prototype._move=function(a,u,y){var w=a[0].sub(this._lastPoints[0]),k=a[1].sub(this._lastPoints[1]);if(this._valid=this.gestureBeginsVertically(w,k,y.timeStamp),this._valid)return this._lastPoints=a,this._active=!0,{pitchDelta:(w.y+k.y)/2*-.5}},s.prototype.gestureBeginsVertically=function(a,u,y){if(this._valid!==void 0)return this._valid;var w=a.mag()>=2,k=u.mag()>=2;if(w||k){if(!w||!k)return this._firstMove===void 0&&(this._firstMove=y),y-this._firstMove<100&&void 0;var E=a.y>0==u.y>0;return gs(a)&&gs(u)&&E}},s}(jn),Ql={panStep:100,bearingStep:15,pitchStep:10},mo=function(){var n=Ql;this._panStep=n.panStep,this._bearingStep=n.bearingStep,this._pitchStep=n.pitchStep,this._rotationDisabled=!1};function Qn(n){return n*(2-n)}mo.prototype.blur=function(){this.reset()},mo.prototype.reset=function(){this._active=!1},mo.prototype.keydown=function(n){var s=this;if(!(n.altKey||n.ctrlKey||n.metaKey)){var a=0,u=0,y=0,w=0,k=0;switch(n.keyCode){case 61:case 107:case 171:case 187:a=1;break;case 189:case 109:case 173:a=-1;break;case 37:n.shiftKey?u=-1:(n.preventDefault(),w=-1);break;case 39:n.shiftKey?u=1:(n.preventDefault(),w=1);break;case 38:n.shiftKey?y=1:(n.preventDefault(),k=-1);break;case 40:n.shiftKey?y=-1:(n.preventDefault(),k=1);break;default:return}return this._rotationDisabled&&(u=0,y=0),{cameraAnimation:function(E){var P=E.getZoom();E.easeTo({duration:300,easeId:"keyboardHandler",easing:Qn,zoom:a?Math.round(P)+a*(n.shiftKey?2:1):P,bearing:E.getBearing()+u*s._bearingStep,pitch:E.getPitch()+y*s._pitchStep,offset:[-w*s._panStep,-k*s._panStep],center:E.getCenter()},{originalEvent:n})}}}},mo.prototype.enable=function(){this._enabled=!0},mo.prototype.disable=function(){this._enabled=!1,this.reset()},mo.prototype.isEnabled=function(){return this._enabled},mo.prototype.isActive=function(){return this._active},mo.prototype.disableRotation=function(){this._rotationDisabled=!0},mo.prototype.enableRotation=function(){this._rotationDisabled=!1};var ur=function(n,s){this._map=n,this._el=n.getCanvasContainer(),this._handler=s,this._delta=0,this._defaultZoomRate=.01,this._wheelZoomRate=1/450,o.bindAll(["_onTimeout"],this)};ur.prototype.setZoomRate=function(n){this._defaultZoomRate=n},ur.prototype.setWheelZoomRate=function(n){this._wheelZoomRate=n},ur.prototype.isEnabled=function(){return!!this._enabled},ur.prototype.isActive=function(){return!!this._active||this._finishTimeout!==void 0},ur.prototype.isZooming=function(){return!!this._zooming},ur.prototype.enable=function(n){this.isEnabled()||(this._enabled=!0,this._aroundCenter=n&&n.around==="center")},ur.prototype.disable=function(){this.isEnabled()&&(this._enabled=!1)},ur.prototype.wheel=function(n){if(this.isEnabled()){var s=n.deltaMode===o.window.WheelEvent.DOM_DELTA_LINE?40*n.deltaY:n.deltaY,a=o.browser.now(),u=a-(this._lastWheelEventTime||0);this._lastWheelEventTime=a,s!==0&&s%4.000244140625==0?this._type="wheel":s!==0&&Math.abs(s)<4?this._type="trackpad":u>400?(this._type=null,this._lastValue=s,this._timeout=setTimeout(this._onTimeout,40,n)):this._type||(this._type=Math.abs(u*s)<200?"trackpad":"wheel",this._timeout&&(clearTimeout(this._timeout),this._timeout=null,s+=this._lastValue)),n.shiftKey&&s&&(s/=4),this._type&&(this._lastWheelEvent=n,this._delta-=s,this._active||this._start(n)),n.preventDefault()}},ur.prototype._onTimeout=function(n){this._type="wheel",this._delta-=this._lastValue,this._active||this._start(n)},ur.prototype._start=function(n){if(this._delta){this._frameId&&(this._frameId=null),this._active=!0,this.isZooming()||(this._zooming=!0),this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout);var s=T.mousePos(this._el,n);this._around=o.LngLat.convert(this._aroundCenter?this._map.getCenter():this._map.unproject(s)),this._aroundPoint=this._map.transform.locationPoint(this._around),this._frameId||(this._frameId=!0,this._handler._triggerRenderFrame())}},ur.prototype.renderFrame=function(){var n=this;if(this._frameId&&(this._frameId=null,this.isActive())){var s=this._map.transform;if(this._delta!==0){var a=this._type==="wheel"&&Math.abs(this._delta)>4.000244140625?this._wheelZoomRate:this._defaultZoomRate,u=2/(1+Math.exp(-Math.abs(this._delta*a)));this._delta<0&&u!==0&&(u=1/u);var y=typeof this._targetZoom=="number"?s.zoomScale(this._targetZoom):s.scale;this._targetZoom=Math.min(s.maxZoom,Math.max(s.minZoom,s.scaleZoom(y*u))),this._type==="wheel"&&(this._startZoom=s.zoom,this._easing=this._smoothOutEasing(200)),this._delta=0}var w,k=typeof this._targetZoom=="number"?this._targetZoom:s.zoom,E=this._startZoom,P=this._easing,O=!1;if(this._type==="wheel"&&E&&P){var Z=Math.min((o.browser.now()-this._lastWheelEventTime)/200,1),G=P(Z);w=o.number(E,k,G),Z<1?this._frameId||(this._frameId=!0):O=!0}else w=k,O=!0;return this._active=!0,O&&(this._active=!1,this._finishTimeout=setTimeout(function(){n._zooming=!1,n._handler._triggerRenderFrame(),delete n._targetZoom,delete n._finishTimeout},200)),{noInertia:!0,needsRenderFrame:!O,zoomDelta:w-s.zoom,around:this._aroundPoint,originalEvent:this._lastWheelEvent}}},ur.prototype._smoothOutEasing=function(n){var s=o.ease;if(this._prevEase){var a=this._prevEase,u=(o.browser.now()-a.start)/a.duration,y=a.easing(u+.01)-a.easing(u),w=.27/Math.sqrt(y*y+1e-4)*.01,k=Math.sqrt(.0729-w*w);s=o.bezier(w,k,.25,1)}return this._prevEase={start:o.browser.now(),duration:n,easing:s},s},ur.prototype.blur=function(){this.reset()},ur.prototype.reset=function(){this._active=!1};var Eo=function(n,s){this._clickZoom=n,this._tapZoom=s};Eo.prototype.enable=function(){this._clickZoom.enable(),this._tapZoom.enable()},Eo.prototype.disable=function(){this._clickZoom.disable(),this._tapZoom.disable()},Eo.prototype.isEnabled=function(){return this._clickZoom.isEnabled()&&this._tapZoom.isEnabled()},Eo.prototype.isActive=function(){return this._clickZoom.isActive()||this._tapZoom.isActive()};var no=function(){this.reset()};no.prototype.reset=function(){this._active=!1},no.prototype.blur=function(){this.reset()},no.prototype.dblclick=function(n,s){return n.preventDefault(),{cameraAnimation:function(a){a.easeTo({duration:300,zoom:a.getZoom()+(n.shiftKey?-1:1),around:a.unproject(s)},{originalEvent:n})}}},no.prototype.enable=function(){this._enabled=!0},no.prototype.disable=function(){this._enabled=!1,this.reset()},no.prototype.isEnabled=function(){return this._enabled},no.prototype.isActive=function(){return this._active};var tn=function(){this._tap=new fo({numTouches:1,numTaps:1}),this.reset()};tn.prototype.reset=function(){this._active=!1,delete this._swipePoint,delete this._swipeTouch,delete this._tapTime,this._tap.reset()},tn.prototype.touchstart=function(n,s,a){this._swipePoint||(this._tapTime&&n.timeStamp-this._tapTime>500&&this.reset(),this._tapTime?a.length>0&&(this._swipePoint=s[0],this._swipeTouch=a[0].identifier):this._tap.touchstart(n,s,a))},tn.prototype.touchmove=function(n,s,a){if(this._tapTime){if(this._swipePoint){if(a[0].identifier!==this._swipeTouch)return;var u=s[0],y=u.y-this._swipePoint.y;return this._swipePoint=u,n.preventDefault(),this._active=!0,{zoomDelta:y/128}}}else this._tap.touchmove(n,s,a)},tn.prototype.touchend=function(n,s,a){this._tapTime?this._swipePoint&&a.length===0&&this.reset():this._tap.touchend(n,s,a)&&(this._tapTime=n.timeStamp)},tn.prototype.touchcancel=function(){this.reset()},tn.prototype.enable=function(){this._enabled=!0},tn.prototype.disable=function(){this._enabled=!1,this.reset()},tn.prototype.isEnabled=function(){return this._enabled},tn.prototype.isActive=function(){return this._active};var Ea=function(n,s,a){this._el=n,this._mousePan=s,this._touchPan=a};Ea.prototype.enable=function(n){this._inertiaOptions=n||{},this._mousePan.enable(),this._touchPan.enable(),this._el.classList.add("mapboxgl-touch-drag-pan")},Ea.prototype.disable=function(){this._mousePan.disable(),this._touchPan.disable(),this._el.classList.remove("mapboxgl-touch-drag-pan")},Ea.prototype.isEnabled=function(){return this._mousePan.isEnabled()&&this._touchPan.isEnabled()},Ea.prototype.isActive=function(){return this._mousePan.isActive()||this._touchPan.isActive()};var Jo=function(n,s,a){this._pitchWithRotate=n.pitchWithRotate,this._mouseRotate=s,this._mousePitch=a};Jo.prototype.enable=function(){this._mouseRotate.enable(),this._pitchWithRotate&&this._mousePitch.enable()},Jo.prototype.disable=function(){this._mouseRotate.disable(),this._mousePitch.disable()},Jo.prototype.isEnabled=function(){return this._mouseRotate.isEnabled()&&(!this._pitchWithRotate||this._mousePitch.isEnabled())},Jo.prototype.isActive=function(){return this._mouseRotate.isActive()||this._mousePitch.isActive()};var yo=function(n,s,a,u){this._el=n,this._touchZoom=s,this._touchRotate=a,this._tapDragZoom=u,this._rotationDisabled=!1,this._enabled=!0};yo.prototype.enable=function(n){this._touchZoom.enable(n),this._rotationDisabled||this._touchRotate.enable(n),this._tapDragZoom.enable(),this._el.classList.add("mapboxgl-touch-zoom-rotate")},yo.prototype.disable=function(){this._touchZoom.disable(),this._touchRotate.disable(),this._tapDragZoom.disable(),this._el.classList.remove("mapboxgl-touch-zoom-rotate")},yo.prototype.isEnabled=function(){return this._touchZoom.isEnabled()&&(this._rotationDisabled||this._touchRotate.isEnabled())&&this._tapDragZoom.isEnabled()},yo.prototype.isActive=function(){return this._touchZoom.isActive()||this._touchRotate.isActive()||this._tapDragZoom.isActive()},yo.prototype.disableRotation=function(){this._rotationDisabled=!0,this._touchRotate.disable()},yo.prototype.enableRotation=function(){this._rotationDisabled=!1,this._touchZoom.isEnabled()&&this._touchRotate.enable()};var bn=function(n){return n.zoom||n.drag||n.pitch||n.rotate},vs=function(n){function s(){n.apply(this,arguments)}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s}(o.Event);function gt(n){return n.panDelta&&n.panDelta.mag()||n.zoomDelta||n.bearingDelta||n.pitchDelta}var ut=function(n,s){this._map=n,this._el=this._map.getCanvasContainer(),this._handlers=[],this._handlersById={},this._changes=[],this._inertia=new ms(n),this._bearingSnap=s.bearingSnap,this._previousActiveHandlers={},this._eventsInProgress={},this._addDefaultHandlers(s),o.bindAll(["handleEvent","handleWindowEvent"],this);var a=this._el;this._listeners=[[a,"touchstart",{passive:!0}],[a,"touchmove",{passive:!1}],[a,"touchend",void 0],[a,"touchcancel",void 0],[a,"mousedown",void 0],[a,"mousemove",void 0],[a,"mouseup",void 0],[o.window.document,"mousemove",{capture:!0}],[o.window.document,"mouseup",void 0],[a,"mouseover",void 0],[a,"mouseout",void 0],[a,"dblclick",void 0],[a,"click",void 0],[a,"keydown",{capture:!1}],[a,"keyup",void 0],[a,"wheel",{passive:!1}],[a,"contextmenu",void 0],[o.window,"blur",void 0]];for(var u=0,y=this._listeners;u<y.length;u+=1){var w=y[u],k=w[0];T.addEventListener(k,w[1],k===o.window.document?this.handleWindowEvent:this.handleEvent,w[2])}};ut.prototype.destroy=function(){for(var n=0,s=this._listeners;n<s.length;n+=1){var a=s[n],u=a[0];T.removeEventListener(u,a[1],u===o.window.document?this.handleWindowEvent:this.handleEvent,a[2])}},ut.prototype._addDefaultHandlers=function(n){var s=this._map,a=s.getCanvasContainer();this._add("mapEvent",new bi(s,n));var u=s.boxZoom=new Un(s,n);this._add("boxZoom",u);var y=new Vn,w=new no;s.doubleClickZoom=new Eo(w,y),this._add("tapZoom",y),this._add("clickZoom",w);var k=new tn;this._add("tapDragZoom",k);var E=s.touchPitch=new Yl;this._add("touchPitch",E);var P=new Ws(n),O=new Jl(n);s.dragRotate=new Jo(n,P,O),this._add("mouseRotate",P,["mousePitch"]),this._add("mousePitch",O,["mouseRotate"]);var Z=new Hl(n),G=new io(n);s.dragPan=new Ea(a,Z,G),this._add("mousePan",Z),this._add("touchPan",G,["touchZoom","touchRotate"]);var K=new Sc,re=new qn;s.touchZoomRotate=new yo(a,re,K,k),this._add("touchRotate",K,["touchPan","touchZoom"]),this._add("touchZoom",re,["touchPan","touchRotate"]);var te=s.scrollZoom=new ur(s,this);this._add("scrollZoom",te,["mousePan"]);var ue=s.keyboard=new mo;this._add("keyboard",ue),this._add("blockableMapEvent",new st(s));for(var Y=0,le=["boxZoom","doubleClickZoom","tapDragZoom","touchPitch","dragRotate","dragPan","touchZoomRotate","scrollZoom","keyboard"];Y<le.length;Y+=1){var fe=le[Y];n.interactive&&n[fe]&&s[fe].enable(n[fe])}},ut.prototype._add=function(n,s,a){this._handlers.push({handlerName:n,handler:s,allowed:a}),this._handlersById[n]=s},ut.prototype.stop=function(n){if(!this._updatingCamera){for(var s=0,a=this._handlers;s<a.length;s+=1)a[s].handler.reset();this._inertia.clear(),this._fireEvents({},{},n),this._changes=[]}},ut.prototype.isActive=function(){for(var n=0,s=this._handlers;n<s.length;n+=1)if(s[n].handler.isActive())return!0;return!1},ut.prototype.isZooming=function(){return!!this._eventsInProgress.zoom||this._map.scrollZoom.isZooming()},ut.prototype.isRotating=function(){return!!this._eventsInProgress.rotate},ut.prototype.isMoving=function(){return!!bn(this._eventsInProgress)||this.isZooming()},ut.prototype._blockedByActive=function(n,s,a){for(var u in n)if(u!==a&&(!s||s.indexOf(u)<0))return!0;return!1},ut.prototype.handleWindowEvent=function(n){this.handleEvent(n,n.type+"Window")},ut.prototype._getMapTouches=function(n){for(var s=[],a=0,u=n;a<u.length;a+=1){var y=u[a];this._el.contains(y.target)&&s.push(y)}return s},ut.prototype.handleEvent=function(n,s){this._updatingCamera=!0;for(var a=n.type==="renderFrame"?void 0:n,u={needsRenderFrame:!1},y={},w={},k=n.touches?this._getMapTouches(n.touches):void 0,E=k?T.touchPos(this._el,k):T.mousePos(this._el,n),P=0,O=this._handlers;P<O.length;P+=1){var Z=O[P],G=Z.handlerName,K=Z.handler,re=Z.allowed;if(K.isEnabled()){var te=void 0;this._blockedByActive(w,re,G)?K.reset():K[s||n.type]&&(te=K[s||n.type](n,E,k),this.mergeHandlerResult(u,y,te,G,a),te&&te.needsRenderFrame&&this._triggerRenderFrame()),(te||K.isActive())&&(w[G]=K)}}var ue={};for(var Y in this._previousActiveHandlers)w[Y]||(ue[Y]=a);this._previousActiveHandlers=w,(Object.keys(ue).length||gt(u))&&(this._changes.push([u,y,ue]),this._triggerRenderFrame()),(Object.keys(w).length||gt(u))&&this._map._stop(!0),this._updatingCamera=!1;var le=u.cameraAnimation;le&&(this._inertia.clear(),this._fireEvents({},{},!0),this._changes=[],le(this._map))},ut.prototype.mergeHandlerResult=function(n,s,a,u,y){if(a){o.extend(n,a);var w={handlerName:u,originalEvent:a.originalEvent||y};a.zoomDelta!==void 0&&(s.zoom=w),a.panDelta!==void 0&&(s.drag=w),a.pitchDelta!==void 0&&(s.pitch=w),a.bearingDelta!==void 0&&(s.rotate=w)}},ut.prototype._applyChanges=function(){for(var n={},s={},a={},u=0,y=this._changes;u<y.length;u+=1){var w=y[u],k=w[0],E=w[1],P=w[2];k.panDelta&&(n.panDelta=(n.panDelta||new o.Point(0,0))._add(k.panDelta)),k.zoomDelta&&(n.zoomDelta=(n.zoomDelta||0)+k.zoomDelta),k.bearingDelta&&(n.bearingDelta=(n.bearingDelta||0)+k.bearingDelta),k.pitchDelta&&(n.pitchDelta=(n.pitchDelta||0)+k.pitchDelta),k.around!==void 0&&(n.around=k.around),k.pinchAround!==void 0&&(n.pinchAround=k.pinchAround),k.noInertia&&(n.noInertia=k.noInertia),o.extend(s,E),o.extend(a,P)}this._updateMapTransform(n,s,a),this._changes=[]},ut.prototype._updateMapTransform=function(n,s,a){var u=this._map,y=u.transform;if(!gt(n))return this._fireEvents(s,a,!0);var w=n.panDelta,k=n.zoomDelta,E=n.bearingDelta,P=n.pitchDelta,O=n.around,Z=n.pinchAround;Z!==void 0&&(O=Z),u._stop(!0),O=O||u.transform.centerPoint;var G=y.pointLocation(w?O.sub(w):O);E&&(y.bearing+=E),P&&(y.pitch+=P),k&&(y.zoom+=k),y.setLocationAtPoint(G,O),this._map._update(),n.noInertia||this._inertia.record(n),this._fireEvents(s,a,!0)},ut.prototype._fireEvents=function(n,s,a){var u=this,y=bn(this._eventsInProgress),w=bn(n),k={};for(var E in n)this._eventsInProgress[E]||(k[E+"start"]=n[E].originalEvent),this._eventsInProgress[E]=n[E];for(var P in!y&&w&&this._fireEvent("movestart",w.originalEvent),k)this._fireEvent(P,k[P]);for(var O in w&&this._fireEvent("move",w.originalEvent),n)this._fireEvent(O,n[O].originalEvent);var Z,G={};for(var K in this._eventsInProgress){var re=this._eventsInProgress[K],te=re.handlerName,ue=re.originalEvent;this._handlersById[te].isActive()||(delete this._eventsInProgress[K],G[K+"end"]=Z=s[te]||ue)}for(var Y in G)this._fireEvent(Y,G[Y]);var le=bn(this._eventsInProgress);if(a&&(y||w)&&!le){this._updatingCamera=!0;var fe=this._inertia._onMoveEnd(this._map.dragPan._inertiaOptions),ge=function(ze){return ze!==0&&-u._bearingSnap<ze&&ze<u._bearingSnap};fe?(ge(fe.bearing||this._map.getBearing())&&(fe.bearing=0),this._map.easeTo(fe,{originalEvent:Z})):(this._map.fire(new o.Event("moveend",{originalEvent:Z})),ge(this._map.getBearing())&&this._map.resetNorth()),this._updatingCamera=!1}},ut.prototype._fireEvent=function(n,s){this._map.fire(new o.Event(n,s?{originalEvent:s}:{}))},ut.prototype._requestFrame=function(){var n=this;return this._map.triggerRepaint(),this._map._renderTaskQueue.add(function(s){delete n._frameId,n.handleEvent(new vs("renderFrame",{timeStamp:s})),n._applyChanges()})},ut.prototype._triggerRenderFrame=function(){this._frameId===void 0&&(this._frameId=this._requestFrame())};var Ys=function(n){function s(a,u){n.call(this),this._moving=!1,this._zooming=!1,this.transform=a,this._bearingSnap=u.bearingSnap,o.bindAll(["_renderFrameCallback"],this)}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype.getCenter=function(){return new o.LngLat(this.transform.center.lng,this.transform.center.lat)},s.prototype.setCenter=function(a,u){return this.jumpTo({center:a},u)},s.prototype.panBy=function(a,u,y){return a=o.Point.convert(a).mult(-1),this.panTo(this.transform.center,o.extend({offset:a},u),y)},s.prototype.panTo=function(a,u,y){return this.easeTo(o.extend({center:a},u),y)},s.prototype.getZoom=function(){return this.transform.zoom},s.prototype.setZoom=function(a,u){return this.jumpTo({zoom:a},u),this},s.prototype.zoomTo=function(a,u,y){return this.easeTo(o.extend({zoom:a},u),y)},s.prototype.zoomIn=function(a,u){return this.zoomTo(this.getZoom()+1,a,u),this},s.prototype.zoomOut=function(a,u){return this.zoomTo(this.getZoom()-1,a,u),this},s.prototype.getBearing=function(){return this.transform.bearing},s.prototype.setBearing=function(a,u){return this.jumpTo({bearing:a},u),this},s.prototype.getPadding=function(){return this.transform.padding},s.prototype.setPadding=function(a,u){return this.jumpTo({padding:a},u),this},s.prototype.rotateTo=function(a,u,y){return this.easeTo(o.extend({bearing:a},u),y)},s.prototype.resetNorth=function(a,u){return this.rotateTo(0,o.extend({duration:1e3},a),u),this},s.prototype.resetNorthPitch=function(a,u){return this.easeTo(o.extend({bearing:0,pitch:0,duration:1e3},a),u),this},s.prototype.snapToNorth=function(a,u){return Math.abs(this.getBearing())<this._bearingSnap?this.resetNorth(a,u):this},s.prototype.getPitch=function(){return this.transform.pitch},s.prototype.setPitch=function(a,u){return this.jumpTo({pitch:a},u),this},s.prototype.cameraForBounds=function(a,u){a=o.LngLatBounds.convert(a);var y=u&&u.bearing||0;return this._cameraForBoxAndBearing(a.getNorthWest(),a.getSouthEast(),y,u)},s.prototype._cameraForBoxAndBearing=function(a,u,y,w){var k={top:0,bottom:0,right:0,left:0};if(typeof(w=o.extend({padding:k,offset:[0,0],maxZoom:this.transform.maxZoom},w)).padding=="number"){var E=w.padding;w.padding={top:E,bottom:E,right:E,left:E}}w.padding=o.extend(k,w.padding);var P=this.transform,O=P.padding,Z=P.project(o.LngLat.convert(a)),G=P.project(o.LngLat.convert(u)),K=Z.rotate(-y*Math.PI/180),re=G.rotate(-y*Math.PI/180),te=new o.Point(Math.max(K.x,re.x),Math.max(K.y,re.y)),ue=new o.Point(Math.min(K.x,re.x),Math.min(K.y,re.y)),Y=te.sub(ue),le=(P.width-(O.left+O.right+w.padding.left+w.padding.right))/Y.x,fe=(P.height-(O.top+O.bottom+w.padding.top+w.padding.bottom))/Y.y;if(!(fe<0||le<0)){var ge=Math.min(P.scaleZoom(P.scale*Math.min(le,fe)),w.maxZoom),ze=typeof w.offset.x=="number"?new o.Point(w.offset.x,w.offset.y):o.Point.convert(w.offset),Ee=new o.Point((w.padding.left-w.padding.right)/2,(w.padding.top-w.padding.bottom)/2).rotate(y*Math.PI/180),Ae=ze.add(Ee).mult(P.scale/P.zoomScale(ge));return{center:P.unproject(Z.add(G).div(2).sub(Ae)),zoom:ge,bearing:y}}o.warnOnce("Map cannot fit within canvas with the given bounds, padding, and/or offset.")},s.prototype.fitBounds=function(a,u,y){return this._fitInternal(this.cameraForBounds(a,u),u,y)},s.prototype.fitScreenCoordinates=function(a,u,y,w,k){return this._fitInternal(this._cameraForBoxAndBearing(this.transform.pointLocation(o.Point.convert(a)),this.transform.pointLocation(o.Point.convert(u)),y,w),w,k)},s.prototype._fitInternal=function(a,u,y){return a?(delete(u=o.extend(a,u)).padding,u.linear?this.easeTo(u,y):this.flyTo(u,y)):this},s.prototype.jumpTo=function(a,u){this.stop();var y=this.transform,w=!1,k=!1,E=!1;return"zoom"in a&&y.zoom!==+a.zoom&&(w=!0,y.zoom=+a.zoom),a.center!==void 0&&(y.center=o.LngLat.convert(a.center)),"bearing"in a&&y.bearing!==+a.bearing&&(k=!0,y.bearing=+a.bearing),"pitch"in a&&y.pitch!==+a.pitch&&(E=!0,y.pitch=+a.pitch),a.padding==null||y.isPaddingEqual(a.padding)||(y.padding=a.padding),this.fire(new o.Event("movestart",u)).fire(new o.Event("move",u)),w&&this.fire(new o.Event("zoomstart",u)).fire(new o.Event("zoom",u)).fire(new o.Event("zoomend",u)),k&&this.fire(new o.Event("rotatestart",u)).fire(new o.Event("rotate",u)).fire(new o.Event("rotateend",u)),E&&this.fire(new o.Event("pitchstart",u)).fire(new o.Event("pitch",u)).fire(new o.Event("pitchend",u)),this.fire(new o.Event("moveend",u))},s.prototype.easeTo=function(a,u){var y=this;this._stop(!1,a.easeId),((a=o.extend({offset:[0,0],duration:500,easing:o.ease},a)).animate===!1||!a.essential&&o.browser.prefersReducedMotion)&&(a.duration=0);var w=this.transform,k=this.getZoom(),E=this.getBearing(),P=this.getPitch(),O=this.getPadding(),Z="zoom"in a?+a.zoom:k,G="bearing"in a?this._normalizeBearing(a.bearing,E):E,K="pitch"in a?+a.pitch:P,re="padding"in a?a.padding:w.padding,te=o.Point.convert(a.offset),ue=w.centerPoint.add(te),Y=w.pointLocation(ue),le=o.LngLat.convert(a.center||Y);this._normalizeCenter(le);var fe,ge,ze=w.project(Y),Ee=w.project(le).sub(ze),Ae=w.zoomScale(Z-k);a.around&&(fe=o.LngLat.convert(a.around),ge=w.locationPoint(fe));var De={moving:this._moving,zooming:this._zooming,rotating:this._rotating,pitching:this._pitching};return this._zooming=this._zooming||Z!==k,this._rotating=this._rotating||E!==G,this._pitching=this._pitching||K!==P,this._padding=!w.isPaddingEqual(re),this._easeId=a.easeId,this._prepareEase(u,a.noMoveStart,De),this._ease(function(Ke){if(y._zooming&&(w.zoom=o.number(k,Z,Ke)),y._rotating&&(w.bearing=o.number(E,G,Ke)),y._pitching&&(w.pitch=o.number(P,K,Ke)),y._padding&&(w.interpolatePadding(O,re,Ke),ue=w.centerPoint.add(te)),fe)w.setLocationAtPoint(fe,ge);else{var Ze=w.zoomScale(w.zoom-k),nt=Z>k?Math.min(2,Ae):Math.max(.5,Ae),vt=Math.pow(nt,1-Ke),St=w.unproject(ze.add(Ee.mult(Ke*vt)).mult(Ze));w.setLocationAtPoint(w.renderWorldCopies?St.wrap():St,ue)}y._fireMoveEvents(u)},function(Ke){y._afterEase(u,Ke)},a),this},s.prototype._prepareEase=function(a,u,y){y===void 0&&(y={}),this._moving=!0,u||y.moving||this.fire(new o.Event("movestart",a)),this._zooming&&!y.zooming&&this.fire(new o.Event("zoomstart",a)),this._rotating&&!y.rotating&&this.fire(new o.Event("rotatestart",a)),this._pitching&&!y.pitching&&this.fire(new o.Event("pitchstart",a))},s.prototype._fireMoveEvents=function(a){this.fire(new o.Event("move",a)),this._zooming&&this.fire(new o.Event("zoom",a)),this._rotating&&this.fire(new o.Event("rotate",a)),this._pitching&&this.fire(new o.Event("pitch",a))},s.prototype._afterEase=function(a,u){if(!this._easeId||!u||this._easeId!==u){delete this._easeId;var y=this._zooming,w=this._rotating,k=this._pitching;this._moving=!1,this._zooming=!1,this._rotating=!1,this._pitching=!1,this._padding=!1,y&&this.fire(new o.Event("zoomend",a)),w&&this.fire(new o.Event("rotateend",a)),k&&this.fire(new o.Event("pitchend",a)),this.fire(new o.Event("moveend",a))}},s.prototype.flyTo=function(a,u){var y=this;if(!a.essential&&o.browser.prefersReducedMotion){var w=o.pick(a,["center","zoom","bearing","pitch","around"]);return this.jumpTo(w,u)}this.stop(),a=o.extend({offset:[0,0],speed:1.2,curve:1.42,easing:o.ease},a);var k=this.transform,E=this.getZoom(),P=this.getBearing(),O=this.getPitch(),Z=this.getPadding(),G="zoom"in a?o.clamp(+a.zoom,k.minZoom,k.maxZoom):E,K="bearing"in a?this._normalizeBearing(a.bearing,P):P,re="pitch"in a?+a.pitch:O,te="padding"in a?a.padding:k.padding,ue=k.zoomScale(G-E),Y=o.Point.convert(a.offset),le=k.centerPoint.add(Y),fe=k.pointLocation(le),ge=o.LngLat.convert(a.center||fe);this._normalizeCenter(ge);var ze=k.project(fe),Ee=k.project(ge).sub(ze),Ae=a.curve,De=Math.max(k.width,k.height),Ke=De/ue,Ze=Ee.mag();if("minZoom"in a){var nt=o.clamp(Math.min(a.minZoom,E,G),k.minZoom,k.maxZoom),vt=De/k.zoomScale(nt-E);Ae=Math.sqrt(vt/Ze*2)}var St=Ae*Ae;function wt(Rt){var Ct=(Ke*Ke-De*De+(Rt?-1:1)*St*St*Ze*Ze)/(2*(Rt?Ke:De)*St*Ze);return Math.log(Math.sqrt(Ct*Ct+1)-Ct)}function _r(Rt){return(Math.exp(Rt)-Math.exp(-Rt))/2}function at(Rt){return(Math.exp(Rt)+Math.exp(-Rt))/2}var Nt=wt(0),Jt=function(Rt){return at(Nt)/at(Nt+Ae*Rt)},Ot=function(Rt){return De*((at(Nt)*(_r(Ct=Nt+Ae*Rt)/at(Ct))-_r(Nt))/St)/Ze;var Ct},Bt=(wt(1)-Nt)/Ae;if(Math.abs(Ze)<1e-6||!isFinite(Bt)){if(Math.abs(De-Ke)<1e-6)return this.easeTo(a,u);var Wt=Ke<De?-1:1;Bt=Math.abs(Math.log(Ke/De))/Ae,Ot=function(){return 0},Jt=function(Rt){return Math.exp(Wt*Ae*Rt)}}return a.duration="duration"in a?+a.duration:1e3*Bt/("screenSpeed"in a?+a.screenSpeed/Ae:+a.speed),a.maxDuration&&a.duration>a.maxDuration&&(a.duration=0),this._zooming=!0,this._rotating=P!==K,this._pitching=re!==O,this._padding=!k.isPaddingEqual(te),this._prepareEase(u,!1),this._ease(function(Rt){var Ct=Rt*Bt,Di=1/Jt(Ct);k.zoom=Rt===1?G:E+k.scaleZoom(Di),y._rotating&&(k.bearing=o.number(P,K,Rt)),y._pitching&&(k.pitch=o.number(O,re,Rt)),y._padding&&(k.interpolatePadding(Z,te,Rt),le=k.centerPoint.add(Y));var si=Rt===1?ge:k.unproject(ze.add(Ee.mult(Ot(Ct))).mult(Di));k.setLocationAtPoint(k.renderWorldCopies?si.wrap():si,le),y._fireMoveEvents(u)},function(){return y._afterEase(u)},a),this},s.prototype.isEasing=function(){return!!this._easeFrameId},s.prototype.stop=function(){return this._stop()},s.prototype._stop=function(a,u){if(this._easeFrameId&&(this._cancelRenderFrame(this._easeFrameId),delete this._easeFrameId,delete this._onEaseFrame),this._onEaseEnd){var y=this._onEaseEnd;delete this._onEaseEnd,y.call(this,u)}if(!a){var w=this.handlers;w&&w.stop(!1)}return this},s.prototype._ease=function(a,u,y){y.animate===!1||y.duration===0?(a(1),u()):(this._easeStart=o.browser.now(),this._easeOptions=y,this._onEaseFrame=a,this._onEaseEnd=u,this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback))},s.prototype._renderFrameCallback=function(){var a=Math.min((o.browser.now()-this._easeStart)/this._easeOptions.duration,1);this._onEaseFrame(this._easeOptions.easing(a)),a<1?this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback):this.stop()},s.prototype._normalizeBearing=function(a,u){a=o.wrap(a,-180,180);var y=Math.abs(a-u);return Math.abs(a-360-u)<y&&(a-=360),Math.abs(a+360-u)<y&&(a+=360),a},s.prototype._normalizeCenter=function(a){var u=this.transform;if(u.renderWorldCopies&&!u.lngRange){var y=a.lng-u.center.lng;a.lng+=y>180?-360:y<-180?360:0}},s}(o.Evented),xn=function(n){n===void 0&&(n={}),this.options=n,o.bindAll(["_toggleAttribution","_updateEditLink","_updateData","_updateCompact"],this)};xn.prototype.getDefaultPosition=function(){return"bottom-right"},xn.prototype.onAdd=function(n){var s=this.options&&this.options.compact;return this._map=n,this._container=T.create("div","mapboxgl-ctrl mapboxgl-ctrl-attrib"),this._compactButton=T.create("button","mapboxgl-ctrl-attrib-button",this._container),this._compactButton.addEventListener("click",this._toggleAttribution),this._setElementTitle(this._compactButton,"ToggleAttribution"),this._innerContainer=T.create("div","mapboxgl-ctrl-attrib-inner",this._container),this._innerContainer.setAttribute("role","list"),s&&this._container.classList.add("mapboxgl-compact"),this._updateAttributions(),this._updateEditLink(),this._map.on("styledata",this._updateData),this._map.on("sourcedata",this._updateData),this._map.on("moveend",this._updateEditLink),s===void 0&&(this._map.on("resize",this._updateCompact),this._updateCompact()),this._container},xn.prototype.onRemove=function(){T.remove(this._container),this._map.off("styledata",this._updateData),this._map.off("sourcedata",this._updateData),this._map.off("moveend",this._updateEditLink),this._map.off("resize",this._updateCompact),this._map=void 0,this._attribHTML=void 0},xn.prototype._setElementTitle=function(n,s){var a=this._map._getUIString("AttributionControl."+s);n.title=a,n.setAttribute("aria-label",a)},xn.prototype._toggleAttribution=function(){this._container.classList.contains("mapboxgl-compact-show")?(this._container.classList.remove("mapboxgl-compact-show"),this._compactButton.setAttribute("aria-pressed","false")):(this._container.classList.add("mapboxgl-compact-show"),this._compactButton.setAttribute("aria-pressed","true"))},xn.prototype._updateEditLink=function(){var n=this._editLink;n||(n=this._editLink=this._container.querySelector(".mapbox-improve-map"));var s=[{key:"owner",value:this.styleOwner},{key:"id",value:this.styleId},{key:"access_token",value:this._map._requestManager._customAccessToken||o.config.ACCESS_TOKEN}];if(n){var a=s.reduce(function(u,y,w){return y.value&&(u+=y.key+"="+y.value+(w<s.length-1?"&":"")),u},"?");n.href=o.config.FEEDBACK_URL+"/"+a+(this._map._hash?this._map._hash.getHashString(!0):""),n.rel="noopener nofollow",this._setElementTitle(n,"MapFeedback")}},xn.prototype._updateData=function(n){!n||n.sourceDataType!=="metadata"&&n.sourceDataType!=="visibility"&&n.dataType!=="style"||(this._updateAttributions(),this._updateEditLink())},xn.prototype._updateAttributions=function(){if(this._map.style){var n=[];if(this.options.customAttribution&&(Array.isArray(this.options.customAttribution)?n=n.concat(this.options.customAttribution.map(function(E){return typeof E!="string"?"":E})):typeof this.options.customAttribution=="string"&&n.push(this.options.customAttribution)),this._map.style.stylesheet){var s=this._map.style.stylesheet;this.styleOwner=s.owner,this.styleId=s.id}var a=this._map.style.sourceCaches;for(var u in a){var y=a[u];if(y.used){var w=y.getSource();w.attribution&&n.indexOf(w.attribution)<0&&n.push(w.attribution)}}n.sort(function(E,P){return E.length-P.length});var k=(n=n.filter(function(E,P){for(var O=P+1;O<n.length;O++)if(n[O].indexOf(E)>=0)return!1;return!0})).join(" | ");k!==this._attribHTML&&(this._attribHTML=k,n.length?(this._innerContainer.innerHTML=k,this._container.classList.remove("mapboxgl-attrib-empty")):this._container.classList.add("mapboxgl-attrib-empty"),this._editLink=null)}},xn.prototype._updateCompact=function(){this._map.getCanvasContainer().offsetWidth<=640?this._container.classList.add("mapboxgl-compact"):this._container.classList.remove("mapboxgl-compact","mapboxgl-compact-show")};var _o=function(){o.bindAll(["_updateLogo"],this),o.bindAll(["_updateCompact"],this)};_o.prototype.onAdd=function(n){this._map=n,this._container=T.create("div","mapboxgl-ctrl");var s=T.create("a","mapboxgl-ctrl-logo");return s.target="_blank",s.rel="noopener nofollow",s.href="https://www.mapbox.com/",s.setAttribute("aria-label",this._map._getUIString("LogoControl.Title")),s.setAttribute("rel","noopener nofollow"),this._container.appendChild(s),this._container.style.display="none",this._map.on("sourcedata",this._updateLogo),this._updateLogo(),this._map.on("resize",this._updateCompact),this._updateCompact(),this._container},_o.prototype.onRemove=function(){T.remove(this._container),this._map.off("sourcedata",this._updateLogo),this._map.off("resize",this._updateCompact)},_o.prototype.getDefaultPosition=function(){return"bottom-left"},_o.prototype._updateLogo=function(n){n&&n.sourceDataType!=="metadata"||(this._container.style.display=this._logoRequired()?"block":"none")},_o.prototype._logoRequired=function(){if(this._map.style){var n=this._map.style.sourceCaches;for(var s in n)if(n[s].getSource().mapbox_logo)return!0;return!1}},_o.prototype._updateCompact=function(){var n=this._container.children;if(n.length){var s=n[0];this._map.getCanvasContainer().offsetWidth<250?s.classList.add("mapboxgl-compact"):s.classList.remove("mapboxgl-compact")}};var rn=function(){this._queue=[],this._id=0,this._cleared=!1,this._currentlyRunning=!1};rn.prototype.add=function(n){var s=++this._id;return this._queue.push({callback:n,id:s,cancelled:!1}),s},rn.prototype.remove=function(n){for(var s=this._currentlyRunning,a=0,u=s?this._queue.concat(s):this._queue;a<u.length;a+=1){var y=u[a];if(y.id===n)return void(y.cancelled=!0)}},rn.prototype.run=function(n){n===void 0&&(n=0);var s=this._currentlyRunning=this._queue;this._queue=[];for(var a=0,u=s;a<u.length;a+=1){var y=u[a];if(!y.cancelled&&(y.callback(n),this._cleared))break}this._cleared=!1,this._currentlyRunning=!1},rn.prototype.clear=function(){this._currentlyRunning&&(this._cleared=!0),this._queue=[]};var To={"AttributionControl.ToggleAttribution":"Toggle attribution","AttributionControl.MapFeedback":"Map feedback","FullscreenControl.Enter":"Enter fullscreen","FullscreenControl.Exit":"Exit fullscreen","GeolocateControl.FindMyLocation":"Find my location","GeolocateControl.LocationNotAvailable":"Location not available","LogoControl.Title":"Mapbox logo","NavigationControl.ResetBearing":"Reset bearing to north","NavigationControl.ZoomIn":"Zoom in","NavigationControl.ZoomOut":"Zoom out","ScaleControl.Feet":"ft","ScaleControl.Meters":"m","ScaleControl.Kilometers":"km","ScaleControl.Miles":"mi","ScaleControl.NauticalMiles":"nm"},$l=o.window.HTMLImageElement,Qs=o.window.HTMLElement,Ar=o.window.ImageBitmap,Zi={center:[0,0],zoom:0,bearing:0,pitch:0,minZoom:-2,maxZoom:22,minPitch:0,maxPitch:60,interactive:!0,scrollZoom:!0,boxZoom:!0,dragRotate:!0,dragPan:!0,keyboard:!0,doubleClickZoom:!0,touchZoomRotate:!0,touchPitch:!0,bearingSnap:7,clickTolerance:3,pitchWithRotate:!0,hash:!1,attributionControl:!0,failIfMajorPerformanceCaveat:!1,preserveDrawingBuffer:!1,trackResize:!0,renderWorldCopies:!0,refreshExpiredTiles:!0,maxTileCacheSize:null,localIdeographFontFamily:"sans-serif",transformRequest:null,accessToken:null,fadeDuration:300,crossSourceCollisions:!0},Ec=function(n){function s(u){var y=this;if((u=o.extend({},Zi,u)).minZoom!=null&&u.maxZoom!=null&&u.minZoom>u.maxZoom)throw new Error("maxZoom must be greater than or equal to minZoom");if(u.minPitch!=null&&u.maxPitch!=null&&u.minPitch>u.maxPitch)throw new Error("maxPitch must be greater than or equal to minPitch");if(u.minPitch!=null&&u.minPitch<0)throw new Error("minPitch must be greater than or equal to 0");if(u.maxPitch!=null&&u.maxPitch>60)throw new Error("maxPitch must be less than or equal to 60");var w=new mr(u.minZoom,u.maxZoom,u.minPitch,u.maxPitch,u.renderWorldCopies);if(n.call(this,w,u),this._interactive=u.interactive,this._maxTileCacheSize=u.maxTileCacheSize,this._failIfMajorPerformanceCaveat=u.failIfMajorPerformanceCaveat,this._preserveDrawingBuffer=u.preserveDrawingBuffer,this._antialias=u.antialias,this._trackResize=u.trackResize,this._bearingSnap=u.bearingSnap,this._refreshExpiredTiles=u.refreshExpiredTiles,this._fadeDuration=u.fadeDuration,this._crossSourceCollisions=u.crossSourceCollisions,this._crossFadingFactor=1,this._collectResourceTiming=u.collectResourceTiming,this._renderTaskQueue=new rn,this._controls=[],this._mapId=o.uniqueId(),this._locale=o.extend({},To,u.locale),this._clickTolerance=u.clickTolerance,this._requestManager=new o.RequestManager(u.transformRequest,u.accessToken),typeof u.container=="string"){if(this._container=o.window.document.getElementById(u.container),!this._container)throw new Error("Container '"+u.container+"' not found.")}else{if(!(u.container instanceof Qs))throw new Error("Invalid type: 'container' must be a String or HTMLElement.");this._container=u.container}if(u.maxBounds&&this.setMaxBounds(u.maxBounds),o.bindAll(["_onWindowOnline","_onWindowResize","_onMapScroll","_contextLost","_contextRestored"],this),this._setupContainer(),this._setupPainter(),this.painter===void 0)throw new Error("Failed to initialize WebGL.");this.on("move",function(){return y._update(!1)}),this.on("moveend",function(){return y._update(!1)}),this.on("zoom",function(){return y._update(!0)}),o.window!==void 0&&(o.window.addEventListener("online",this._onWindowOnline,!1),o.window.addEventListener("resize",this._onWindowResize,!1),o.window.addEventListener("orientationchange",this._onWindowResize,!1)),this.handlers=new ut(this,u),this._hash=u.hash&&new Yn(typeof u.hash=="string"&&u.hash||void 0).addTo(this),this._hash&&this._hash._onHashChange()||(this.jumpTo({center:u.center,zoom:u.zoom,bearing:u.bearing,pitch:u.pitch}),u.bounds&&(this.resize(),this.fitBounds(u.bounds,o.extend({},u.fitBoundsOptions,{duration:0})))),this.resize(),this._localIdeographFontFamily=u.localIdeographFontFamily,u.style&&this.setStyle(u.style,{localIdeographFontFamily:u.localIdeographFontFamily}),u.attributionControl&&this.addControl(new xn({customAttribution:u.customAttribution})),this.addControl(new _o,u.logoPosition),this.on("style.load",function(){y.transform.unmodified&&y.jumpTo(y.style.stylesheet)}),this.on("data",function(k){y._update(k.dataType==="style"),y.fire(new o.Event(k.dataType+"data",k))}),this.on("dataloading",function(k){y.fire(new o.Event(k.dataType+"dataloading",k))})}n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s;var a={showTileBoundaries:{configurable:!0},showPadding:{configurable:!0},showCollisionBoxes:{configurable:!0},showOverdrawInspector:{configurable:!0},repaint:{configurable:!0},vertices:{configurable:!0},version:{configurable:!0}};return s.prototype._getMapId=function(){return this._mapId},s.prototype.addControl=function(u,y){if(y===void 0&&(y=u.getDefaultPosition?u.getDefaultPosition():"top-right"),!u||!u.onAdd)return this.fire(new o.ErrorEvent(new Error("Invalid argument to map.addControl(). Argument must be a control with onAdd and onRemove methods.")));var w=u.onAdd(this);this._controls.push(u);var k=this._controlPositions[y];return y.indexOf("bottom")!==-1?k.insertBefore(w,k.firstChild):k.appendChild(w),this},s.prototype.removeControl=function(u){if(!u||!u.onRemove)return this.fire(new o.ErrorEvent(new Error("Invalid argument to map.removeControl(). Argument must be a control with onAdd and onRemove methods.")));var y=this._controls.indexOf(u);return y>-1&&this._controls.splice(y,1),u.onRemove(this),this},s.prototype.hasControl=function(u){return this._controls.indexOf(u)>-1},s.prototype.resize=function(u){var y=this._containerDimensions(),w=y[0],k=y[1];if(w===this.transform.width&&k===this.transform.height)return this;this._resizeCanvas(w,k),this.transform.resize(w,k),this.painter.resize(w,k);var E=!this._moving;return E&&this.fire(new o.Event("movestart",u)).fire(new o.Event("move",u)),this.fire(new o.Event("resize",u)),E&&this.fire(new o.Event("moveend",u)),this},s.prototype.getBounds=function(){return this.transform.getBounds()},s.prototype.getMaxBounds=function(){return this.transform.getMaxBounds()},s.prototype.setMaxBounds=function(u){return this.transform.setMaxBounds(o.LngLatBounds.convert(u)),this._update()},s.prototype.setMinZoom=function(u){if((u=u??-2)>=-2&&u<=this.transform.maxZoom)return this.transform.minZoom=u,this._update(),this.getZoom()<u&&this.setZoom(u),this;throw new Error("minZoom must be between -2 and the current maxZoom, inclusive")},s.prototype.getMinZoom=function(){return this.transform.minZoom},s.prototype.setMaxZoom=function(u){if((u=u??22)>=this.transform.minZoom)return this.transform.maxZoom=u,this._update(),this.getZoom()>u&&this.setZoom(u),this;throw new Error("maxZoom must be greater than the current minZoom")},s.prototype.getMaxZoom=function(){return this.transform.maxZoom},s.prototype.setMinPitch=function(u){if((u=u??0)<0)throw new Error("minPitch must be greater than or equal to 0");if(u>=0&&u<=this.transform.maxPitch)return this.transform.minPitch=u,this._update(),this.getPitch()<u&&this.setPitch(u),this;throw new Error("minPitch must be between 0 and the current maxPitch, inclusive")},s.prototype.getMinPitch=function(){return this.transform.minPitch},s.prototype.setMaxPitch=function(u){if((u=u??60)>60)throw new Error("maxPitch must be less than or equal to 60");if(u>=this.transform.minPitch)return this.transform.maxPitch=u,this._update(),this.getPitch()>u&&this.setPitch(u),this;throw new Error("maxPitch must be greater than the current minPitch")},s.prototype.getMaxPitch=function(){return this.transform.maxPitch},s.prototype.getRenderWorldCopies=function(){return this.transform.renderWorldCopies},s.prototype.setRenderWorldCopies=function(u){return this.transform.renderWorldCopies=u,this._update()},s.prototype.project=function(u){return this.transform.locationPoint(o.LngLat.convert(u))},s.prototype.unproject=function(u){return this.transform.pointLocation(o.Point.convert(u))},s.prototype.isMoving=function(){return this._moving||this.handlers.isMoving()},s.prototype.isZooming=function(){return this._zooming||this.handlers.isZooming()},s.prototype.isRotating=function(){return this._rotating||this.handlers.isRotating()},s.prototype._createDelegatedListener=function(u,y,w){var k,E=this;if(u==="mouseenter"||u==="mouseover"){var P=!1;return{layer:y,listener:w,delegates:{mousemove:function(Z){var G=E.getLayer(y)?E.queryRenderedFeatures(Z.point,{layers:[y]}):[];G.length?P||(P=!0,w.call(E,new Ti(u,E,Z.originalEvent,{features:G}))):P=!1},mouseout:function(){P=!1}}}}if(u==="mouseleave"||u==="mouseout"){var O=!1;return{layer:y,listener:w,delegates:{mousemove:function(Z){(E.getLayer(y)?E.queryRenderedFeatures(Z.point,{layers:[y]}):[]).length?O=!0:O&&(O=!1,w.call(E,new Ti(u,E,Z.originalEvent)))},mouseout:function(Z){O&&(O=!1,w.call(E,new Ti(u,E,Z.originalEvent)))}}}}return{layer:y,listener:w,delegates:(k={},k[u]=function(Z){var G=E.getLayer(y)?E.queryRenderedFeatures(Z.point,{layers:[y]}):[];G.length&&(Z.features=G,w.call(E,Z),delete Z.features)},k)}},s.prototype.on=function(u,y,w){if(w===void 0)return n.prototype.on.call(this,u,y);var k=this._createDelegatedListener(u,y,w);for(var E in this._delegatedListeners=this._delegatedListeners||{},this._delegatedListeners[u]=this._delegatedListeners[u]||[],this._delegatedListeners[u].push(k),k.delegates)this.on(E,k.delegates[E]);return this},s.prototype.once=function(u,y,w){if(w===void 0)return n.prototype.once.call(this,u,y);var k=this._createDelegatedListener(u,y,w);for(var E in k.delegates)this.once(E,k.delegates[E]);return this},s.prototype.off=function(u,y,w){var k=this;return w===void 0?n.prototype.off.call(this,u,y):(this._delegatedListeners&&this._delegatedListeners[u]&&function(E){for(var P=E[u],O=0;O<P.length;O++){var Z=P[O];if(Z.layer===y&&Z.listener===w){for(var G in Z.delegates)k.off(G,Z.delegates[G]);return P.splice(O,1),k}}}(this._delegatedListeners),this)},s.prototype.queryRenderedFeatures=function(u,y){if(!this.style)return[];var w;if(y!==void 0||u===void 0||u instanceof o.Point||Array.isArray(u)||(y=u,u=void 0),y=y||{},(u=u||[[0,0],[this.transform.width,this.transform.height]])instanceof o.Point||typeof u[0]=="number")w=[o.Point.convert(u)];else{var k=o.Point.convert(u[0]),E=o.Point.convert(u[1]);w=[k,new o.Point(E.x,k.y),E,new o.Point(k.x,E.y),k]}return this.style.queryRenderedFeatures(w,y,this.transform)},s.prototype.querySourceFeatures=function(u,y){return this.style.querySourceFeatures(u,y)},s.prototype.setStyle=function(u,y){return(y=o.extend({},{localIdeographFontFamily:this._localIdeographFontFamily},y)).diff!==!1&&y.localIdeographFontFamily===this._localIdeographFontFamily&&this.style&&u?(this._diffStyle(u,y),this):(this._localIdeographFontFamily=y.localIdeographFontFamily,this._updateStyle(u,y))},s.prototype._getUIString=function(u){var y=this._locale[u];if(y==null)throw new Error("Missing UI string '"+u+"'");return y},s.prototype._updateStyle=function(u,y){return this.style&&(this.style.setEventedParent(null),this.style._remove()),u?(this.style=new Nn(this,y||{}),this.style.setEventedParent(this,{style:this.style}),typeof u=="string"?this.style.loadURL(u):this.style.loadJSON(u),this):(delete this.style,this)},s.prototype._lazyInitEmptyStyle=function(){this.style||(this.style=new Nn(this,{}),this.style.setEventedParent(this,{style:this.style}),this.style.loadEmpty())},s.prototype._diffStyle=function(u,y){var w=this;if(typeof u=="string"){var k=this._requestManager.normalizeStyleURL(u),E=this._requestManager.transformRequest(k,o.ResourceType.Style);o.getJSON(E,function(P,O){P?w.fire(new o.ErrorEvent(P)):O&&w._updateDiff(O,y)})}else typeof u=="object"&&this._updateDiff(u,y)},s.prototype._updateDiff=function(u,y){try{this.style.setState(u)&&this._update(!0)}catch(w){o.warnOnce("Unable to perform style diff: "+(w.message||w.error||w)+".  Rebuilding the style from scratch."),this._updateStyle(u,y)}},s.prototype.getStyle=function(){if(this.style)return this.style.serialize()},s.prototype.isStyleLoaded=function(){return this.style?this.style.loaded():o.warnOnce("There is no style added to the map.")},s.prototype.addSource=function(u,y){return this._lazyInitEmptyStyle(),this.style.addSource(u,y),this._update(!0)},s.prototype.isSourceLoaded=function(u){var y=this.style&&this.style.sourceCaches[u];if(y!==void 0)return y.loaded();this.fire(new o.ErrorEvent(new Error("There is no source with ID '"+u+"'")))},s.prototype.areTilesLoaded=function(){var u=this.style&&this.style.sourceCaches;for(var y in u){var w=u[y]._tiles;for(var k in w){var E=w[k];if(E.state!=="loaded"&&E.state!=="errored")return!1}}return!0},s.prototype.addSourceType=function(u,y,w){return this._lazyInitEmptyStyle(),this.style.addSourceType(u,y,w)},s.prototype.removeSource=function(u){return this.style.removeSource(u),this._update(!0)},s.prototype.getSource=function(u){return this.style.getSource(u)},s.prototype.addImage=function(u,y,w){w===void 0&&(w={});var k=w.pixelRatio;k===void 0&&(k=1);var E=w.sdf;E===void 0&&(E=!1);var P=w.stretchX,O=w.stretchY,Z=w.content;if(this._lazyInitEmptyStyle(),y instanceof $l||Ar&&y instanceof Ar){var G=o.browser.getImageData(y);this.style.addImage(u,{data:new o.RGBAImage({width:G.width,height:G.height},G.data),pixelRatio:k,stretchX:P,stretchY:O,content:Z,sdf:E,version:0})}else{if(y.width===void 0||y.height===void 0)return this.fire(new o.ErrorEvent(new Error("Invalid arguments to map.addImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));var K=y;this.style.addImage(u,{data:new o.RGBAImage({width:y.width,height:y.height},new Uint8Array(y.data)),pixelRatio:k,stretchX:P,stretchY:O,content:Z,sdf:E,version:0,userImage:K}),K.onAdd&&K.onAdd(this,u)}},s.prototype.updateImage=function(u,y){var w=this.style.getImage(u);if(!w)return this.fire(new o.ErrorEvent(new Error("The map has no image with that id. If you are adding a new image use `map.addImage(...)` instead.")));var k=y instanceof $l||Ar&&y instanceof Ar?o.browser.getImageData(y):y,E=k.width,P=k.height,O=k.data;return E===void 0||P===void 0?this.fire(new o.ErrorEvent(new Error("Invalid arguments to map.updateImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`"))):E!==w.data.width||P!==w.data.height?this.fire(new o.ErrorEvent(new Error("The width and height of the updated image must be that same as the previous version of the image"))):(w.data.replace(O,!(y instanceof $l||Ar&&y instanceof Ar)),void this.style.updateImage(u,w))},s.prototype.hasImage=function(u){return u?!!this.style.getImage(u):(this.fire(new o.ErrorEvent(new Error("Missing required image id"))),!1)},s.prototype.removeImage=function(u){this.style.removeImage(u)},s.prototype.loadImage=function(u,y){o.getImage(this._requestManager.transformRequest(u,o.ResourceType.Image),y)},s.prototype.listImages=function(){return this.style.listImages()},s.prototype.addLayer=function(u,y){return this._lazyInitEmptyStyle(),this.style.addLayer(u,y),this._update(!0)},s.prototype.moveLayer=function(u,y){return this.style.moveLayer(u,y),this._update(!0)},s.prototype.removeLayer=function(u){return this.style.removeLayer(u),this._update(!0)},s.prototype.getLayer=function(u){return this.style.getLayer(u)},s.prototype.setLayerZoomRange=function(u,y,w){return this.style.setLayerZoomRange(u,y,w),this._update(!0)},s.prototype.setFilter=function(u,y,w){return w===void 0&&(w={}),this.style.setFilter(u,y,w),this._update(!0)},s.prototype.getFilter=function(u){return this.style.getFilter(u)},s.prototype.setPaintProperty=function(u,y,w,k){return k===void 0&&(k={}),this.style.setPaintProperty(u,y,w,k),this._update(!0)},s.prototype.getPaintProperty=function(u,y){return this.style.getPaintProperty(u,y)},s.prototype.setLayoutProperty=function(u,y,w,k){return k===void 0&&(k={}),this.style.setLayoutProperty(u,y,w,k),this._update(!0)},s.prototype.getLayoutProperty=function(u,y){return this.style.getLayoutProperty(u,y)},s.prototype.setLight=function(u,y){return y===void 0&&(y={}),this._lazyInitEmptyStyle(),this.style.setLight(u,y),this._update(!0)},s.prototype.getLight=function(){return this.style.getLight()},s.prototype.setFeatureState=function(u,y){return this.style.setFeatureState(u,y),this._update()},s.prototype.removeFeatureState=function(u,y){return this.style.removeFeatureState(u,y),this._update()},s.prototype.getFeatureState=function(u){return this.style.getFeatureState(u)},s.prototype.getContainer=function(){return this._container},s.prototype.getCanvasContainer=function(){return this._canvasContainer},s.prototype.getCanvas=function(){return this._canvas},s.prototype._containerDimensions=function(){var u=0,y=0;return this._container&&(u=this._container.clientWidth||400,y=this._container.clientHeight||300),[u,y]},s.prototype._detectMissingCSS=function(){o.window.getComputedStyle(this._missingCSSCanary).getPropertyValue("background-color")!=="rgb(250, 128, 114)"&&o.warnOnce("This page appears to be missing CSS declarations for Mapbox GL JS, which may cause the map to display incorrectly. Please ensure your page includes mapbox-gl.css, as described in https://www.mapbox.com/mapbox-gl-js/api/.")},s.prototype._setupContainer=function(){var u=this._container;u.classList.add("mapboxgl-map"),(this._missingCSSCanary=T.create("div","mapboxgl-canary",u)).style.visibility="hidden",this._detectMissingCSS();var y=this._canvasContainer=T.create("div","mapboxgl-canvas-container",u);this._interactive&&y.classList.add("mapboxgl-interactive"),this._canvas=T.create("canvas","mapboxgl-canvas",y),this._canvas.addEventListener("webglcontextlost",this._contextLost,!1),this._canvas.addEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.setAttribute("tabindex","0"),this._canvas.setAttribute("aria-label","Map"),this._canvas.setAttribute("role","region");var w=this._containerDimensions();this._resizeCanvas(w[0],w[1]);var k=this._controlContainer=T.create("div","mapboxgl-control-container",u),E=this._controlPositions={};["top-left","top-right","bottom-left","bottom-right"].forEach(function(P){E[P]=T.create("div","mapboxgl-ctrl-"+P,k)}),this._container.addEventListener("scroll",this._onMapScroll,!1)},s.prototype._resizeCanvas=function(u,y){var w=o.browser.devicePixelRatio||1;this._canvas.width=w*u,this._canvas.height=w*y,this._canvas.style.width=u+"px",this._canvas.style.height=y+"px"},s.prototype._setupPainter=function(){var u=o.extend({},z.webGLContextAttributes,{failIfMajorPerformanceCaveat:this._failIfMajorPerformanceCaveat,preserveDrawingBuffer:this._preserveDrawingBuffer,antialias:this._antialias||!1}),y=this._canvas.getContext("webgl",u)||this._canvas.getContext("experimental-webgl",u);y?(this.painter=new Wr(y,this.transform),o.webpSupported.testSupport(y)):this.fire(new o.ErrorEvent(new Error("Failed to initialize WebGL")))},s.prototype._contextLost=function(u){u.preventDefault(),this._frame&&(this._frame.cancel(),this._frame=null),this.fire(new o.Event("webglcontextlost",{originalEvent:u}))},s.prototype._contextRestored=function(u){this._setupPainter(),this.resize(),this._update(),this.fire(new o.Event("webglcontextrestored",{originalEvent:u}))},s.prototype._onMapScroll=function(u){if(u.target===this._container)return this._container.scrollTop=0,this._container.scrollLeft=0,!1},s.prototype.loaded=function(){return!this._styleDirty&&!this._sourcesDirty&&!!this.style&&this.style.loaded()},s.prototype._update=function(u){return this.style?(this._styleDirty=this._styleDirty||u,this._sourcesDirty=!0,this.triggerRepaint(),this):this},s.prototype._requestRenderFrame=function(u){return this._update(),this._renderTaskQueue.add(u)},s.prototype._cancelRenderFrame=function(u){this._renderTaskQueue.remove(u)},s.prototype._render=function(u){var y,w=this,k=0,E=this.painter.context.extTimerQuery;if(this.listens("gpu-timing-frame")&&(y=E.createQueryEXT(),E.beginQueryEXT(E.TIME_ELAPSED_EXT,y),k=o.browser.now()),this.painter.context.setDirty(),this.painter.setBaseState(),this._renderTaskQueue.run(u),!this._removed){var P=!1;if(this.style&&this._styleDirty){this._styleDirty=!1;var O=this.transform.zoom,Z=o.browser.now();this.style.zoomHistory.update(O,Z);var G=new o.EvaluationParameters(O,{now:Z,fadeDuration:this._fadeDuration,zoomHistory:this.style.zoomHistory,transition:this.style.getTransition()}),K=G.crossFadingFactor();K===1&&K===this._crossFadingFactor||(P=!0,this._crossFadingFactor=K),this.style.update(G)}if(this.style&&this._sourcesDirty&&(this._sourcesDirty=!1,this.style._updateSources(this.transform)),this._placementDirty=this.style&&this.style._updatePlacement(this.painter.transform,this.showCollisionBoxes,this._fadeDuration,this._crossSourceCollisions),this.painter.render(this.style,{showTileBoundaries:this.showTileBoundaries,showOverdrawInspector:this._showOverdrawInspector,rotating:this.isRotating(),zooming:this.isZooming(),moving:this.isMoving(),fadeDuration:this._fadeDuration,showPadding:this.showPadding,gpuTiming:!!this.listens("gpu-timing-layer")}),this.fire(new o.Event("render")),this.loaded()&&!this._loaded&&(this._loaded=!0,this.fire(new o.Event("load"))),this.style&&(this.style.hasTransitions()||P)&&(this._styleDirty=!0),this.style&&!this._placementDirty&&this.style._releaseSymbolFadeTiles(),this.listens("gpu-timing-frame")){var re=o.browser.now()-k;E.endQueryEXT(E.TIME_ELAPSED_EXT,y),setTimeout(function(){var Y=E.getQueryObjectEXT(y,E.QUERY_RESULT_EXT)/1e6;E.deleteQueryEXT(y),w.fire(new o.Event("gpu-timing-frame",{cpuTime:re,gpuTime:Y}))},50)}if(this.listens("gpu-timing-layer")){var te=this.painter.collectGpuTimers();setTimeout(function(){var Y=w.painter.queryGpuTimers(te);w.fire(new o.Event("gpu-timing-layer",{layerTimes:Y}))},50)}var ue=this._sourcesDirty||this._styleDirty||this._placementDirty;return ue||this._repaint?this.triggerRepaint():!this.isMoving()&&this.loaded()&&this.fire(new o.Event("idle")),!this._loaded||this._fullyLoaded||ue||(this._fullyLoaded=!0),this}},s.prototype.remove=function(){this._hash&&this._hash.remove();for(var u=0,y=this._controls;u<y.length;u+=1)y[u].onRemove(this);this._controls=[],this._frame&&(this._frame.cancel(),this._frame=null),this._renderTaskQueue.clear(),this.painter.destroy(),this.handlers.destroy(),delete this.handlers,this.setStyle(null),o.window!==void 0&&(o.window.removeEventListener("resize",this._onWindowResize,!1),o.window.removeEventListener("orientationchange",this._onWindowResize,!1),o.window.removeEventListener("online",this._onWindowOnline,!1));var w=this.painter.context.gl.getExtension("WEBGL_lose_context");w&&w.loseContext(),Ta(this._canvasContainer),Ta(this._controlContainer),Ta(this._missingCSSCanary),this._container.classList.remove("mapboxgl-map"),this._removed=!0,this.fire(new o.Event("remove"))},s.prototype.triggerRepaint=function(){var u=this;this.style&&!this._frame&&(this._frame=o.browser.frame(function(y){u._frame=null,u._render(y)}))},s.prototype._onWindowOnline=function(){this._update()},s.prototype._onWindowResize=function(u){this._trackResize&&this.resize({originalEvent:u})._update()},a.showTileBoundaries.get=function(){return!!this._showTileBoundaries},a.showTileBoundaries.set=function(u){this._showTileBoundaries!==u&&(this._showTileBoundaries=u,this._update())},a.showPadding.get=function(){return!!this._showPadding},a.showPadding.set=function(u){this._showPadding!==u&&(this._showPadding=u,this._update())},a.showCollisionBoxes.get=function(){return!!this._showCollisionBoxes},a.showCollisionBoxes.set=function(u){this._showCollisionBoxes!==u&&(this._showCollisionBoxes=u,u?this.style._generateCollisionBoxes():this._update())},a.showOverdrawInspector.get=function(){return!!this._showOverdrawInspector},a.showOverdrawInspector.set=function(u){this._showOverdrawInspector!==u&&(this._showOverdrawInspector=u,this._update())},a.repaint.get=function(){return!!this._repaint},a.repaint.set=function(u){this._repaint!==u&&(this._repaint=u,this.triggerRepaint())},a.vertices.get=function(){return!!this._vertices},a.vertices.set=function(u){this._vertices=u,this._update()},s.prototype._setCacheLimits=function(u,y){o.setCacheLimits(u,y)},a.version.get=function(){return o.version},Object.defineProperties(s.prototype,a),s}(Ys);function Ta(n){n.parentNode&&n.parentNode.removeChild(n)}var eu={showCompass:!0,showZoom:!0,visualizePitch:!1},Lo=function(n){var s=this;this.options=o.extend({},eu,n),this._container=T.create("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._container.addEventListener("contextmenu",function(a){return a.preventDefault()}),this.options.showZoom&&(o.bindAll(["_setButtonTitle","_updateZoomButtons"],this),this._zoomInButton=this._createButton("mapboxgl-ctrl-zoom-in",function(a){return s._map.zoomIn({},{originalEvent:a})}),T.create("span","mapboxgl-ctrl-icon",this._zoomInButton).setAttribute("aria-hidden",!0),this._zoomOutButton=this._createButton("mapboxgl-ctrl-zoom-out",function(a){return s._map.zoomOut({},{originalEvent:a})}),T.create("span","mapboxgl-ctrl-icon",this._zoomOutButton).setAttribute("aria-hidden",!0)),this.options.showCompass&&(o.bindAll(["_rotateCompassArrow"],this),this._compass=this._createButton("mapboxgl-ctrl-compass",function(a){s.options.visualizePitch?s._map.resetNorthPitch({},{originalEvent:a}):s._map.resetNorth({},{originalEvent:a})}),this._compassIcon=T.create("span","mapboxgl-ctrl-icon",this._compass),this._compassIcon.setAttribute("aria-hidden",!0))};Lo.prototype._updateZoomButtons=function(){var n=this._map.getZoom(),s=n===this._map.getMaxZoom(),a=n===this._map.getMinZoom();this._zoomInButton.disabled=s,this._zoomOutButton.disabled=a,this._zoomInButton.setAttribute("aria-disabled",s.toString()),this._zoomOutButton.setAttribute("aria-disabled",a.toString())},Lo.prototype._rotateCompassArrow=function(){var n=this.options.visualizePitch?"scale("+1/Math.pow(Math.cos(this._map.transform.pitch*(Math.PI/180)),.5)+") rotateX("+this._map.transform.pitch+"deg) rotateZ("+this._map.transform.angle*(180/Math.PI)+"deg)":"rotate("+this._map.transform.angle*(180/Math.PI)+"deg)";this._compassIcon.style.transform=n},Lo.prototype.onAdd=function(n){return this._map=n,this.options.showZoom&&(this._setButtonTitle(this._zoomInButton,"ZoomIn"),this._setButtonTitle(this._zoomOutButton,"ZoomOut"),this._map.on("zoom",this._updateZoomButtons),this._updateZoomButtons()),this.options.showCompass&&(this._setButtonTitle(this._compass,"ResetBearing"),this.options.visualizePitch&&this._map.on("pitch",this._rotateCompassArrow),this._map.on("rotate",this._rotateCompassArrow),this._rotateCompassArrow(),this._handler=new Zn(this._map,this._compass,this.options.visualizePitch)),this._container},Lo.prototype.onRemove=function(){T.remove(this._container),this.options.showZoom&&this._map.off("zoom",this._updateZoomButtons),this.options.showCompass&&(this.options.visualizePitch&&this._map.off("pitch",this._rotateCompassArrow),this._map.off("rotate",this._rotateCompassArrow),this._handler.off(),delete this._handler),delete this._map},Lo.prototype._createButton=function(n,s){var a=T.create("button",n,this._container);return a.type="button",a.addEventListener("click",s),a},Lo.prototype._setButtonTitle=function(n,s){var a=this._map._getUIString("NavigationControl."+s);n.title=a,n.setAttribute("aria-label",a)};var Zn=function(n,s,a){a===void 0&&(a=!1),this._clickTolerance=10,this.element=s,this.mouseRotate=new Ws({clickTolerance:n.dragRotate._mouseRotate._clickTolerance}),this.map=n,a&&(this.mousePitch=new Jl({clickTolerance:n.dragRotate._mousePitch._clickTolerance})),o.bindAll(["mousedown","mousemove","mouseup","touchstart","touchmove","touchend","reset"],this),T.addEventListener(s,"mousedown",this.mousedown),T.addEventListener(s,"touchstart",this.touchstart,{passive:!1}),T.addEventListener(s,"touchmove",this.touchmove),T.addEventListener(s,"touchend",this.touchend),T.addEventListener(s,"touchcancel",this.reset)};function Ga(n,s,a){if(n=new o.LngLat(n.lng,n.lat),s){var u=new o.LngLat(n.lng-360,n.lat),y=new o.LngLat(n.lng+360,n.lat),w=a.locationPoint(n).distSqr(s);a.locationPoint(u).distSqr(s)<w?n=u:a.locationPoint(y).distSqr(s)<w&&(n=y)}for(;Math.abs(n.lng-a.center.lng)>180;){var k=a.locationPoint(n);if(k.x>=0&&k.y>=0&&k.x<=a.width&&k.y<=a.height)break;n.lng>a.center.lng?n.lng-=360:n.lng+=360}return n}Zn.prototype.down=function(n,s){this.mouseRotate.mousedown(n,s),this.mousePitch&&this.mousePitch.mousedown(n,s),T.disableDrag()},Zn.prototype.move=function(n,s){var a=this.map,u=this.mouseRotate.mousemoveWindow(n,s);if(u&&u.bearingDelta&&a.setBearing(a.getBearing()+u.bearingDelta),this.mousePitch){var y=this.mousePitch.mousemoveWindow(n,s);y&&y.pitchDelta&&a.setPitch(a.getPitch()+y.pitchDelta)}},Zn.prototype.off=function(){var n=this.element;T.removeEventListener(n,"mousedown",this.mousedown),T.removeEventListener(n,"touchstart",this.touchstart,{passive:!1}),T.removeEventListener(n,"touchmove",this.touchmove),T.removeEventListener(n,"touchend",this.touchend),T.removeEventListener(n,"touchcancel",this.reset),this.offTemp()},Zn.prototype.offTemp=function(){T.enableDrag(),T.removeEventListener(o.window,"mousemove",this.mousemove),T.removeEventListener(o.window,"mouseup",this.mouseup)},Zn.prototype.mousedown=function(n){this.down(o.extend({},n,{ctrlKey:!0,preventDefault:function(){return n.preventDefault()}}),T.mousePos(this.element,n)),T.addEventListener(o.window,"mousemove",this.mousemove),T.addEventListener(o.window,"mouseup",this.mouseup)},Zn.prototype.mousemove=function(n){this.move(n,T.mousePos(this.element,n))},Zn.prototype.mouseup=function(n){this.mouseRotate.mouseupWindow(n),this.mousePitch&&this.mousePitch.mouseupWindow(n),this.offTemp()},Zn.prototype.touchstart=function(n){n.targetTouches.length!==1?this.reset():(this._startPos=this._lastPos=T.touchPos(this.element,n.targetTouches)[0],this.down({type:"mousedown",button:0,ctrlKey:!0,preventDefault:function(){return n.preventDefault()}},this._startPos))},Zn.prototype.touchmove=function(n){n.targetTouches.length!==1?this.reset():(this._lastPos=T.touchPos(this.element,n.targetTouches)[0],this.move({preventDefault:function(){return n.preventDefault()}},this._lastPos))},Zn.prototype.touchend=function(n){n.targetTouches.length===0&&this._startPos&&this._lastPos&&this._startPos.dist(this._lastPos)<this._clickTolerance&&this.element.click(),this.reset()},Zn.prototype.reset=function(){this.mouseRotate.reset(),this.mousePitch&&this.mousePitch.reset(),delete this._startPos,delete this._lastPos,this.offTemp()};var Io={center:"translate(-50%,-50%)",top:"translate(-50%,0)","top-left":"translate(0,0)","top-right":"translate(-100%,0)",bottom:"translate(-50%,-100%)","bottom-left":"translate(0,-100%)","bottom-right":"translate(-100%,-100%)",left:"translate(0,-50%)",right:"translate(-100%,-50%)"};function $s(n,s,a){var u=n.classList;for(var y in Io)u.remove("mapboxgl-"+a+"-anchor-"+y);u.add("mapboxgl-"+a+"-anchor-"+s)}var Ka,bs=function(n){function s(a,u){if(n.call(this),(a instanceof o.window.HTMLElement||u)&&(a=o.extend({element:a},u)),o.bindAll(["_update","_onMove","_onUp","_addDragHandler","_onMapClick","_onKeyPress"],this),this._anchor=a&&a.anchor||"center",this._color=a&&a.color||"#3FB1CE",this._scale=a&&a.scale||1,this._draggable=a&&a.draggable||!1,this._clickTolerance=a&&a.clickTolerance||0,this._isDragging=!1,this._state="inactive",this._rotation=a&&a.rotation||0,this._rotationAlignment=a&&a.rotationAlignment||"auto",this._pitchAlignment=a&&a.pitchAlignment&&a.pitchAlignment!=="auto"?a.pitchAlignment:this._rotationAlignment,a&&a.element)this._element=a.element,this._offset=o.Point.convert(a&&a.offset||[0,0]);else{this._defaultMarker=!0,this._element=T.create("div"),this._element.setAttribute("aria-label","Map marker");var y=T.createNS("http://www.w3.org/2000/svg","svg");y.setAttributeNS(null,"display","block"),y.setAttributeNS(null,"height","41px"),y.setAttributeNS(null,"width","27px"),y.setAttributeNS(null,"viewBox","0 0 27 41");var w=T.createNS("http://www.w3.org/2000/svg","g");w.setAttributeNS(null,"stroke","none"),w.setAttributeNS(null,"stroke-width","1"),w.setAttributeNS(null,"fill","none"),w.setAttributeNS(null,"fill-rule","evenodd");var k=T.createNS("http://www.w3.org/2000/svg","g");k.setAttributeNS(null,"fill-rule","nonzero");var E=T.createNS("http://www.w3.org/2000/svg","g");E.setAttributeNS(null,"transform","translate(3.0, 29.0)"),E.setAttributeNS(null,"fill","#000000");for(var P=0,O=[{rx:"10.5",ry:"5.25002273"},{rx:"10.5",ry:"5.25002273"},{rx:"9.5",ry:"4.77275007"},{rx:"8.5",ry:"4.29549936"},{rx:"7.5",ry:"3.81822308"},{rx:"6.5",ry:"3.34094679"},{rx:"5.5",ry:"2.86367051"},{rx:"4.5",ry:"2.38636864"}];P<O.length;P+=1){var Z=O[P],G=T.createNS("http://www.w3.org/2000/svg","ellipse");G.setAttributeNS(null,"opacity","0.04"),G.setAttributeNS(null,"cx","10.5"),G.setAttributeNS(null,"cy","5.80029008"),G.setAttributeNS(null,"rx",Z.rx),G.setAttributeNS(null,"ry",Z.ry),E.appendChild(G)}var K=T.createNS("http://www.w3.org/2000/svg","g");K.setAttributeNS(null,"fill",this._color);var re=T.createNS("http://www.w3.org/2000/svg","path");re.setAttributeNS(null,"d","M27,13.5 C27,19.074644 20.250001,27.000002 14.75,34.500002 C14.016665,35.500004 12.983335,35.500004 12.25,34.500002 C6.7499993,27.000002 0,19.222562 0,13.5 C0,6.0441559 6.0441559,0 13.5,0 C20.955844,0 27,6.0441559 27,13.5 Z"),K.appendChild(re);var te=T.createNS("http://www.w3.org/2000/svg","g");te.setAttributeNS(null,"opacity","0.25"),te.setAttributeNS(null,"fill","#000000");var ue=T.createNS("http://www.w3.org/2000/svg","path");ue.setAttributeNS(null,"d","M13.5,0 C6.0441559,0 0,6.0441559 0,13.5 C0,19.222562 6.7499993,27 12.25,34.5 C13,35.522727 14.016664,35.500004 14.75,34.5 C20.250001,27 27,19.074644 27,13.5 C27,6.0441559 20.955844,0 13.5,0 Z M13.5,1 C20.415404,1 26,6.584596 26,13.5 C26,15.898657 24.495584,19.181431 22.220703,22.738281 C19.945823,26.295132 16.705119,30.142167 13.943359,33.908203 C13.743445,34.180814 13.612715,34.322738 13.5,34.441406 C13.387285,34.322738 13.256555,34.180814 13.056641,33.908203 C10.284481,30.127985 7.4148684,26.314159 5.015625,22.773438 C2.6163816,19.232715 1,15.953538 1,13.5 C1,6.584596 6.584596,1 13.5,1 Z"),te.appendChild(ue);var Y=T.createNS("http://www.w3.org/2000/svg","g");Y.setAttributeNS(null,"transform","translate(6.0, 7.0)"),Y.setAttributeNS(null,"fill","#FFFFFF");var le=T.createNS("http://www.w3.org/2000/svg","g");le.setAttributeNS(null,"transform","translate(8.0, 8.0)");var fe=T.createNS("http://www.w3.org/2000/svg","circle");fe.setAttributeNS(null,"fill","#000000"),fe.setAttributeNS(null,"opacity","0.25"),fe.setAttributeNS(null,"cx","5.5"),fe.setAttributeNS(null,"cy","5.5"),fe.setAttributeNS(null,"r","5.4999962");var ge=T.createNS("http://www.w3.org/2000/svg","circle");ge.setAttributeNS(null,"fill","#FFFFFF"),ge.setAttributeNS(null,"cx","5.5"),ge.setAttributeNS(null,"cy","5.5"),ge.setAttributeNS(null,"r","5.4999962"),le.appendChild(fe),le.appendChild(ge),k.appendChild(E),k.appendChild(K),k.appendChild(te),k.appendChild(Y),k.appendChild(le),y.appendChild(k),y.setAttributeNS(null,"height",41*this._scale+"px"),y.setAttributeNS(null,"width",27*this._scale+"px"),this._element.appendChild(y),this._offset=o.Point.convert(a&&a.offset||[0,-14])}this._element.classList.add("mapboxgl-marker"),this._element.addEventListener("dragstart",function(ze){ze.preventDefault()}),this._element.addEventListener("mousedown",function(ze){ze.preventDefault()}),$s(this._element,this._anchor,"marker"),this._popup=null}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype.addTo=function(a){return this.remove(),this._map=a,a.getCanvasContainer().appendChild(this._element),a.on("move",this._update),a.on("moveend",this._update),this.setDraggable(this._draggable),this._update(),this._map.on("click",this._onMapClick),this},s.prototype.remove=function(){return this._map&&(this._map.off("click",this._onMapClick),this._map.off("move",this._update),this._map.off("moveend",this._update),this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler),this._map.off("mouseup",this._onUp),this._map.off("touchend",this._onUp),this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),delete this._map),T.remove(this._element),this._popup&&this._popup.remove(),this},s.prototype.getLngLat=function(){return this._lngLat},s.prototype.setLngLat=function(a){return this._lngLat=o.LngLat.convert(a),this._pos=null,this._popup&&this._popup.setLngLat(this._lngLat),this._update(),this},s.prototype.getElement=function(){return this._element},s.prototype.setPopup=function(a){if(this._popup&&(this._popup.remove(),this._popup=null,this._element.removeEventListener("keypress",this._onKeyPress),this._originalTabIndex||this._element.removeAttribute("tabindex")),a){if(!("offset"in a.options)){var u=Math.sqrt(Math.pow(13.5,2)/2);a.options.offset=this._defaultMarker?{top:[0,0],"top-left":[0,0],"top-right":[0,0],bottom:[0,-38.1],"bottom-left":[u,-1*(24.6+u)],"bottom-right":[-u,-1*(24.6+u)],left:[13.5,-24.6],right:[-13.5,-24.6]}:this._offset}this._popup=a,this._lngLat&&this._popup.setLngLat(this._lngLat),this._originalTabIndex=this._element.getAttribute("tabindex"),this._originalTabIndex||this._element.setAttribute("tabindex","0"),this._element.addEventListener("keypress",this._onKeyPress)}return this},s.prototype._onKeyPress=function(a){var u=a.code,y=a.charCode||a.keyCode;u!=="Space"&&u!=="Enter"&&y!==32&&y!==13||this.togglePopup()},s.prototype._onMapClick=function(a){var u=a.originalEvent.target,y=this._element;this._popup&&(u===y||y.contains(u))&&this.togglePopup()},s.prototype.getPopup=function(){return this._popup},s.prototype.togglePopup=function(){var a=this._popup;return a?(a.isOpen()?a.remove():a.addTo(this._map),this):this},s.prototype._update=function(a){if(this._map){this._map.transform.renderWorldCopies&&(this._lngLat=Ga(this._lngLat,this._pos,this._map.transform)),this._pos=this._map.project(this._lngLat)._add(this._offset);var u="";this._rotationAlignment==="viewport"||this._rotationAlignment==="auto"?u="rotateZ("+this._rotation+"deg)":this._rotationAlignment==="map"&&(u="rotateZ("+(this._rotation-this._map.getBearing())+"deg)");var y="";this._pitchAlignment==="viewport"||this._pitchAlignment==="auto"?y="rotateX(0deg)":this._pitchAlignment==="map"&&(y="rotateX("+this._map.getPitch()+"deg)"),a&&a.type!=="moveend"||(this._pos=this._pos.round()),T.setTransform(this._element,Io[this._anchor]+" translate("+this._pos.x+"px, "+this._pos.y+"px) "+y+" "+u)}},s.prototype.getOffset=function(){return this._offset},s.prototype.setOffset=function(a){return this._offset=o.Point.convert(a),this._update(),this},s.prototype._onMove=function(a){if(!this._isDragging){var u=this._clickTolerance||this._map._clickTolerance;this._isDragging=a.point.dist(this._pointerdownPos)>=u}this._isDragging&&(this._pos=a.point.sub(this._positionDelta),this._lngLat=this._map.unproject(this._pos),this.setLngLat(this._lngLat),this._element.style.pointerEvents="none",this._state==="pending"&&(this._state="active",this.fire(new o.Event("dragstart"))),this.fire(new o.Event("drag")))},s.prototype._onUp=function(){this._element.style.pointerEvents="auto",this._positionDelta=null,this._pointerdownPos=null,this._isDragging=!1,this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),this._state==="active"&&this.fire(new o.Event("dragend")),this._state="inactive"},s.prototype._addDragHandler=function(a){this._element.contains(a.originalEvent.target)&&(a.preventDefault(),this._positionDelta=a.point.sub(this._pos).add(this._offset),this._pointerdownPos=a.point,this._state="pending",this._map.on("mousemove",this._onMove),this._map.on("touchmove",this._onMove),this._map.once("mouseup",this._onUp),this._map.once("touchend",this._onUp))},s.prototype.setDraggable=function(a){return this._draggable=!!a,this._map&&(a?(this._map.on("mousedown",this._addDragHandler),this._map.on("touchstart",this._addDragHandler)):(this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler))),this},s.prototype.isDraggable=function(){return this._draggable},s.prototype.setRotation=function(a){return this._rotation=a||0,this._update(),this},s.prototype.getRotation=function(){return this._rotation},s.prototype.setRotationAlignment=function(a){return this._rotationAlignment=a||"auto",this._update(),this},s.prototype.getRotationAlignment=function(){return this._rotationAlignment},s.prototype.setPitchAlignment=function(a){return this._pitchAlignment=a&&a!=="auto"?a:this._rotationAlignment,this._update(),this},s.prototype.getPitchAlignment=function(){return this._pitchAlignment},s}(o.Evented),tu={positionOptions:{enableHighAccuracy:!1,maximumAge:0,timeout:6e3},fitBoundsOptions:{maxZoom:15},trackUserLocation:!1,showAccuracyCircle:!0,showUserLocation:!0},Xa=0,Ia=!1,ru=function(n){function s(a){n.call(this),this.options=o.extend({},tu,a),o.bindAll(["_onSuccess","_onError","_onZoom","_finish","_setupUI","_updateCamera","_updateMarker"],this)}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype.onAdd=function(a){var u;return this._map=a,this._container=T.create("div","mapboxgl-ctrl mapboxgl-ctrl-group"),u=this._setupUI,Ka!==void 0?u(Ka):o.window.navigator.permissions!==void 0?o.window.navigator.permissions.query({name:"geolocation"}).then(function(y){u(Ka=y.state!=="denied")}):u(Ka=!!o.window.navigator.geolocation),this._container},s.prototype.onRemove=function(){this._geolocationWatchID!==void 0&&(o.window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0),this.options.showUserLocation&&this._userLocationDotMarker&&this._userLocationDotMarker.remove(),this.options.showAccuracyCircle&&this._accuracyCircleMarker&&this._accuracyCircleMarker.remove(),T.remove(this._container),this._map.off("zoom",this._onZoom),this._map=void 0,Xa=0,Ia=!1},s.prototype._isOutOfMapMaxBounds=function(a){var u=this._map.getMaxBounds(),y=a.coords;return u&&(y.longitude<u.getWest()||y.longitude>u.getEast()||y.latitude<u.getSouth()||y.latitude>u.getNorth())},s.prototype._setErrorState=function(){switch(this._watchState){case"WAITING_ACTIVE":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error");break;case"ACTIVE_LOCK":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting");break;case"BACKGROUND":this._watchState="BACKGROUND_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting")}},s.prototype._onSuccess=function(a){if(this._map){if(this._isOutOfMapMaxBounds(a))return this._setErrorState(),this.fire(new o.Event("outofmaxbounds",a)),this._updateMarker(),void this._finish();if(this.options.trackUserLocation)switch(this._lastKnownPosition=a,this._watchState){case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"BACKGROUND":case"BACKGROUND_ERROR":this._watchState="BACKGROUND",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background")}this.options.showUserLocation&&this._watchState!=="OFF"&&this._updateMarker(a),this.options.trackUserLocation&&this._watchState!=="ACTIVE_LOCK"||this._updateCamera(a),this.options.showUserLocation&&this._dotElement.classList.remove("mapboxgl-user-location-dot-stale"),this.fire(new o.Event("geolocate",a)),this._finish()}},s.prototype._updateCamera=function(a){var u=new o.LngLat(a.coords.longitude,a.coords.latitude),y=a.coords.accuracy,w=this._map.getBearing(),k=o.extend({bearing:w},this.options.fitBoundsOptions);this._map.fitBounds(u.toBounds(y),k,{geolocateSource:!0})},s.prototype._updateMarker=function(a){if(a){var u=new o.LngLat(a.coords.longitude,a.coords.latitude);this._accuracyCircleMarker.setLngLat(u).addTo(this._map),this._userLocationDotMarker.setLngLat(u).addTo(this._map),this._accuracy=a.coords.accuracy,this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}else this._userLocationDotMarker.remove(),this._accuracyCircleMarker.remove()},s.prototype._updateCircleRadius=function(){var a=this._map._container.clientHeight/2,u=this._map.unproject([0,a]),y=this._map.unproject([1,a]),w=u.distanceTo(y),k=Math.ceil(2*this._accuracy/w);this._circleElement.style.width=k+"px",this._circleElement.style.height=k+"px"},s.prototype._onZoom=function(){this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()},s.prototype._onError=function(a){if(this._map){if(this.options.trackUserLocation)if(a.code===1){this._watchState="OFF",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.disabled=!0;var u=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.title=u,this._geolocateButton.setAttribute("aria-label",u),this._geolocationWatchID!==void 0&&this._clearWatch()}else{if(a.code===3&&Ia)return;this._setErrorState()}this._watchState!=="OFF"&&this.options.showUserLocation&&this._dotElement.classList.add("mapboxgl-user-location-dot-stale"),this.fire(new o.Event("error",a)),this._finish()}},s.prototype._finish=function(){this._timeoutId&&clearTimeout(this._timeoutId),this._timeoutId=void 0},s.prototype._setupUI=function(a){var u=this;if(this._container.addEventListener("contextmenu",function(k){return k.preventDefault()}),this._geolocateButton=T.create("button","mapboxgl-ctrl-geolocate",this._container),T.create("span","mapboxgl-ctrl-icon",this._geolocateButton).setAttribute("aria-hidden",!0),this._geolocateButton.type="button",a===!1){o.warnOnce("Geolocation support is not available so the GeolocateControl will be disabled.");var y=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.disabled=!0,this._geolocateButton.title=y,this._geolocateButton.setAttribute("aria-label",y)}else{var w=this._map._getUIString("GeolocateControl.FindMyLocation");this._geolocateButton.title=w,this._geolocateButton.setAttribute("aria-label",w)}this.options.trackUserLocation&&(this._geolocateButton.setAttribute("aria-pressed","false"),this._watchState="OFF"),this.options.showUserLocation&&(this._dotElement=T.create("div","mapboxgl-user-location-dot"),this._userLocationDotMarker=new bs(this._dotElement),this._circleElement=T.create("div","mapboxgl-user-location-accuracy-circle"),this._accuracyCircleMarker=new bs({element:this._circleElement,pitchAlignment:"map"}),this.options.trackUserLocation&&(this._watchState="OFF"),this._map.on("zoom",this._onZoom)),this._geolocateButton.addEventListener("click",this.trigger.bind(this)),this._setup=!0,this.options.trackUserLocation&&this._map.on("movestart",function(k){k.geolocateSource||u._watchState!=="ACTIVE_LOCK"||k.originalEvent&&k.originalEvent.type==="resize"||(u._watchState="BACKGROUND",u._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background"),u._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),u.fire(new o.Event("trackuserlocationend")))})},s.prototype.trigger=function(){if(!this._setup)return o.warnOnce("Geolocate control triggered before added to a map"),!1;if(this.options.trackUserLocation){switch(this._watchState){case"OFF":this._watchState="WAITING_ACTIVE",this.fire(new o.Event("trackuserlocationstart"));break;case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":case"BACKGROUND_ERROR":Xa--,Ia=!1,this._watchState="OFF",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this.fire(new o.Event("trackuserlocationend"));break;case"BACKGROUND":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._lastKnownPosition&&this._updateCamera(this._lastKnownPosition),this.fire(new o.Event("trackuserlocationstart"))}switch(this._watchState){case"WAITING_ACTIVE":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"ACTIVE_LOCK":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"ACTIVE_ERROR":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error");break;case"BACKGROUND":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background");break;case"BACKGROUND_ERROR":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background-error")}if(this._watchState==="OFF"&&this._geolocationWatchID!==void 0)this._clearWatch();else if(this._geolocationWatchID===void 0){var a;this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","true"),++Xa>1?(a={maximumAge:6e5,timeout:0},Ia=!0):(a=this.options.positionOptions,Ia=!1),this._geolocationWatchID=o.window.navigator.geolocation.watchPosition(this._onSuccess,this._onError,a)}}else o.window.navigator.geolocation.getCurrentPosition(this._onSuccess,this._onError,this.options.positionOptions),this._timeoutId=setTimeout(this._finish,1e4);return!0},s.prototype._clearWatch=function(){o.window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0,this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","false"),this.options.showUserLocation&&this._updateMarker(null)},s}(o.Evented),Yo={maxWidth:100,unit:"metric"},Qo=function(n){this.options=o.extend({},Yo,n),o.bindAll(["_onMove","setUnit"],this)};function el(n,s,a){var u=a&&a.maxWidth||100,y=n._container.clientHeight/2,w=n.unproject([0,y]),k=n.unproject([u,y]),E=w.distanceTo(k);if(a&&a.unit==="imperial"){var P=3.2808*E;P>5280?$o(s,u,P/5280,n._getUIString("ScaleControl.Miles")):$o(s,u,P,n._getUIString("ScaleControl.Feet"))}else a&&a.unit==="nautical"?$o(s,u,E/1852,n._getUIString("ScaleControl.NauticalMiles")):E>=1e3?$o(s,u,E/1e3,n._getUIString("ScaleControl.Kilometers")):$o(s,u,E,n._getUIString("ScaleControl.Meters"))}function $o(n,s,a,u){var y,w,k,E=(y=a,(w=Math.pow(10,(""+Math.floor(y)).length-1))*(k=(k=y/w)>=10?10:k>=5?5:k>=3?3:k>=2?2:k>=1?1:function(P){var O=Math.pow(10,Math.ceil(-Math.log(P)/Math.LN10));return Math.round(P*O)/O}(k)));n.style.width=s*(E/a)+"px",n.innerHTML=E+"&nbsp;"+u}Qo.prototype.getDefaultPosition=function(){return"bottom-left"},Qo.prototype._onMove=function(){el(this._map,this._container,this.options)},Qo.prototype.onAdd=function(n){return this._map=n,this._container=T.create("div","mapboxgl-ctrl mapboxgl-ctrl-scale",n.getContainer()),this._map.on("move",this._onMove),this._onMove(),this._container},Qo.prototype.onRemove=function(){T.remove(this._container),this._map.off("move",this._onMove),this._map=void 0},Qo.prototype.setUnit=function(n){this.options.unit=n,el(this._map,this._container,this.options)};var oo=function(n){this._fullscreen=!1,n&&n.container&&(n.container instanceof o.window.HTMLElement?this._container=n.container:o.warnOnce("Full screen control 'container' must be a DOM element.")),o.bindAll(["_onClickFullscreen","_changeIcon"],this),"onfullscreenchange"in o.window.document?this._fullscreenchange="fullscreenchange":"onmozfullscreenchange"in o.window.document?this._fullscreenchange="mozfullscreenchange":"onwebkitfullscreenchange"in o.window.document?this._fullscreenchange="webkitfullscreenchange":"onmsfullscreenchange"in o.window.document&&(this._fullscreenchange="MSFullscreenChange")};oo.prototype.onAdd=function(n){return this._map=n,this._container||(this._container=this._map.getContainer()),this._controlContainer=T.create("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._checkFullscreenSupport()?this._setupUI():(this._controlContainer.style.display="none",o.warnOnce("This device does not support fullscreen mode.")),this._controlContainer},oo.prototype.onRemove=function(){T.remove(this._controlContainer),this._map=null,o.window.document.removeEventListener(this._fullscreenchange,this._changeIcon)},oo.prototype._checkFullscreenSupport=function(){return!!(o.window.document.fullscreenEnabled||o.window.document.mozFullScreenEnabled||o.window.document.msFullscreenEnabled||o.window.document.webkitFullscreenEnabled)},oo.prototype._setupUI=function(){var n=this._fullscreenButton=T.create("button","mapboxgl-ctrl-fullscreen",this._controlContainer);T.create("span","mapboxgl-ctrl-icon",n).setAttribute("aria-hidden",!0),n.type="button",this._updateTitle(),this._fullscreenButton.addEventListener("click",this._onClickFullscreen),o.window.document.addEventListener(this._fullscreenchange,this._changeIcon)},oo.prototype._updateTitle=function(){var n=this._getTitle();this._fullscreenButton.setAttribute("aria-label",n),this._fullscreenButton.title=n},oo.prototype._getTitle=function(){return this._map._getUIString(this._isFullscreen()?"FullscreenControl.Exit":"FullscreenControl.Enter")},oo.prototype._isFullscreen=function(){return this._fullscreen},oo.prototype._changeIcon=function(){(o.window.document.fullscreenElement||o.window.document.mozFullScreenElement||o.window.document.webkitFullscreenElement||o.window.document.msFullscreenElement)===this._container!==this._fullscreen&&(this._fullscreen=!this._fullscreen,this._fullscreenButton.classList.toggle("mapboxgl-ctrl-shrink"),this._fullscreenButton.classList.toggle("mapboxgl-ctrl-fullscreen"),this._updateTitle())},oo.prototype._onClickFullscreen=function(){this._isFullscreen()?o.window.document.exitFullscreen?o.window.document.exitFullscreen():o.window.document.mozCancelFullScreen?o.window.document.mozCancelFullScreen():o.window.document.msExitFullscreen?o.window.document.msExitFullscreen():o.window.document.webkitCancelFullScreen&&o.window.document.webkitCancelFullScreen():this._container.requestFullscreen?this._container.requestFullscreen():this._container.mozRequestFullScreen?this._container.mozRequestFullScreen():this._container.msRequestFullscreen?this._container.msRequestFullscreen():this._container.webkitRequestFullscreen&&this._container.webkitRequestFullscreen()};var iu={closeButton:!0,closeOnClick:!0,focusAfterOpen:!0,className:"",maxWidth:"240px"},xs=["a[href]","[tabindex]:not([tabindex='-1'])","[contenteditable]:not([contenteditable='false'])","button:not([disabled])","input:not([disabled])","select:not([disabled])","textarea:not([disabled])"].join(", "),nu=function(n){function s(a){n.call(this),this.options=o.extend(Object.create(iu),a),o.bindAll(["_update","_onClose","remove","_onMouseMove","_onMouseUp","_onDrag"],this)}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype.addTo=function(a){return this._map&&this.remove(),this._map=a,this.options.closeOnClick&&this._map.on("click",this._onClose),this.options.closeOnMove&&this._map.on("move",this._onClose),this._map.on("remove",this.remove),this._update(),this._focusFirstElement(),this._trackPointer?(this._map.on("mousemove",this._onMouseMove),this._map.on("mouseup",this._onMouseUp),this._container&&this._container.classList.add("mapboxgl-popup-track-pointer"),this._map._canvasContainer.classList.add("mapboxgl-track-pointer")):this._map.on("move",this._update),this.fire(new o.Event("open")),this},s.prototype.isOpen=function(){return!!this._map},s.prototype.remove=function(){return this._content&&T.remove(this._content),this._container&&(T.remove(this._container),delete this._container),this._map&&(this._map.off("move",this._update),this._map.off("move",this._onClose),this._map.off("click",this._onClose),this._map.off("remove",this.remove),this._map.off("mousemove",this._onMouseMove),this._map.off("mouseup",this._onMouseUp),this._map.off("drag",this._onDrag),delete this._map),this.fire(new o.Event("close")),this},s.prototype.getLngLat=function(){return this._lngLat},s.prototype.setLngLat=function(a){return this._lngLat=o.LngLat.convert(a),this._pos=null,this._trackPointer=!1,this._update(),this._map&&(this._map.on("move",this._update),this._map.off("mousemove",this._onMouseMove),this._container&&this._container.classList.remove("mapboxgl-popup-track-pointer"),this._map._canvasContainer.classList.remove("mapboxgl-track-pointer")),this},s.prototype.trackPointer=function(){return this._trackPointer=!0,this._pos=null,this._update(),this._map&&(this._map.off("move",this._update),this._map.on("mousemove",this._onMouseMove),this._map.on("drag",this._onDrag),this._container&&this._container.classList.add("mapboxgl-popup-track-pointer"),this._map._canvasContainer.classList.add("mapboxgl-track-pointer")),this},s.prototype.getElement=function(){return this._container},s.prototype.setText=function(a){return this.setDOMContent(o.window.document.createTextNode(a))},s.prototype.setHTML=function(a){var u,y=o.window.document.createDocumentFragment(),w=o.window.document.createElement("body");for(w.innerHTML=a;u=w.firstChild;)y.appendChild(u);return this.setDOMContent(y)},s.prototype.getMaxWidth=function(){return this._container&&this._container.style.maxWidth},s.prototype.setMaxWidth=function(a){return this.options.maxWidth=a,this._update(),this},s.prototype.setDOMContent=function(a){if(this._content)for(;this._content.hasChildNodes();)this._content.firstChild&&this._content.removeChild(this._content.firstChild);else this._content=T.create("div","mapboxgl-popup-content",this._container);return this._content.appendChild(a),this._createCloseButton(),this._update(),this._focusFirstElement(),this},s.prototype.addClassName=function(a){this._container&&this._container.classList.add(a)},s.prototype.removeClassName=function(a){this._container&&this._container.classList.remove(a)},s.prototype.setOffset=function(a){return this.options.offset=a,this._update(),this},s.prototype.toggleClassName=function(a){if(this._container)return this._container.classList.toggle(a)},s.prototype._createCloseButton=function(){this.options.closeButton&&(this._closeButton=T.create("button","mapboxgl-popup-close-button",this._content),this._closeButton.type="button",this._closeButton.setAttribute("aria-label","Close popup"),this._closeButton.innerHTML="&#215;",this._closeButton.addEventListener("click",this._onClose))},s.prototype._onMouseUp=function(a){this._update(a.point)},s.prototype._onMouseMove=function(a){this._update(a.point)},s.prototype._onDrag=function(a){this._update(a.point)},s.prototype._update=function(a){var u=this;if(this._map&&(this._lngLat||this._trackPointer)&&this._content&&(this._container||(this._container=T.create("div","mapboxgl-popup",this._map.getContainer()),this._tip=T.create("div","mapboxgl-popup-tip",this._container),this._container.appendChild(this._content),this.options.className&&this.options.className.split(" ").forEach(function(G){return u._container.classList.add(G)}),this._trackPointer&&this._container.classList.add("mapboxgl-popup-track-pointer")),this.options.maxWidth&&this._container.style.maxWidth!==this.options.maxWidth&&(this._container.style.maxWidth=this.options.maxWidth),this._map.transform.renderWorldCopies&&!this._trackPointer&&(this._lngLat=Ga(this._lngLat,this._pos,this._map.transform)),!this._trackPointer||a)){var y=this._pos=this._trackPointer&&a?a:this._map.project(this._lngLat),w=this.options.anchor,k=function G(K){if(K){if(typeof K=="number"){var re=Math.round(Math.sqrt(.5*Math.pow(K,2)));return{center:new o.Point(0,0),top:new o.Point(0,K),"top-left":new o.Point(re,re),"top-right":new o.Point(-re,re),bottom:new o.Point(0,-K),"bottom-left":new o.Point(re,-re),"bottom-right":new o.Point(-re,-re),left:new o.Point(K,0),right:new o.Point(-K,0)}}if(K instanceof o.Point||Array.isArray(K)){var te=o.Point.convert(K);return{center:te,top:te,"top-left":te,"top-right":te,bottom:te,"bottom-left":te,"bottom-right":te,left:te,right:te}}return{center:o.Point.convert(K.center||[0,0]),top:o.Point.convert(K.top||[0,0]),"top-left":o.Point.convert(K["top-left"]||[0,0]),"top-right":o.Point.convert(K["top-right"]||[0,0]),bottom:o.Point.convert(K.bottom||[0,0]),"bottom-left":o.Point.convert(K["bottom-left"]||[0,0]),"bottom-right":o.Point.convert(K["bottom-right"]||[0,0]),left:o.Point.convert(K.left||[0,0]),right:o.Point.convert(K.right||[0,0])}}return G(new o.Point(0,0))}(this.options.offset);if(!w){var E,P=this._container.offsetWidth,O=this._container.offsetHeight;E=y.y+k.bottom.y<O?["top"]:y.y>this._map.transform.height-O?["bottom"]:[],y.x<P/2?E.push("left"):y.x>this._map.transform.width-P/2&&E.push("right"),w=E.length===0?"bottom":E.join("-")}var Z=y.add(k[w]).round();T.setTransform(this._container,Io[w]+" translate("+Z.x+"px,"+Z.y+"px)"),$s(this._container,w,"popup")}},s.prototype._focusFirstElement=function(){if(this.options.focusAfterOpen&&this._container){var a=this._container.querySelector(xs);a&&a.focus()}},s.prototype._onClose=function(){this.remove()},s}(o.Evented),tl={version:o.version,supported:z,setRTLTextPlugin:o.setRTLTextPlugin,getRTLTextPluginStatus:o.getRTLTextPluginStatus,Map:Ec,NavigationControl:Lo,GeolocateControl:ru,AttributionControl:xn,ScaleControl:Qo,FullscreenControl:oo,Popup:nu,Marker:bs,Style:Nn,LngLat:o.LngLat,LngLatBounds:o.LngLatBounds,Point:o.Point,MercatorCoordinate:o.MercatorCoordinate,Evented:o.Evented,config:o.config,prewarm:function(){Se().acquire(W)},clearPrewarmedResources:function(){var n=$e;n&&(n.isPreloaded()&&n.numActive()===1?(n.release(W),$e=null):console.warn("Could not clear WebWorkers since there are active Map instances that still reference it. The pre-warmed WebWorker pool can only be cleared when all map instances have been removed with map.remove()"))},get accessToken(){return o.config.ACCESS_TOKEN},set accessToken(n){o.config.ACCESS_TOKEN=n},get baseApiUrl(){return o.config.API_URL},set baseApiUrl(n){o.config.API_URL=n},get workerCount(){return we.workerCount},set workerCount(n){we.workerCount=n},get maxParallelImageRequests(){return o.config.MAX_PARALLEL_IMAGE_REQUESTS},set maxParallelImageRequests(n){o.config.MAX_PARALLEL_IMAGE_REQUESTS=n},clearStorage:function(n){o.clearTileCache(n)},workerUrl:""};return tl}),_})})(ty);var _h=ty.exports;const Lg=og(_h);function wd(h){let c;const d=h[15].default,f=Mu(d,h,h[14],null);return{c(){f&&f.c()},l(_){f&&f.l(_)},m(_,v){f&&f.m(_,v),c=!0},p(_,v){f&&f.p&&(!c||v&16384)&&Du(f,d,_,_[14],c?Ru(d,_[14],v,null):Lu(_[14]),null)},i(_){c||(rt(f,_),c=!0)},o(_){lt(f,_),c=!1},d(_){f&&f.d(_)}}}function Rg(h){let c,d,f,_=h[0]&&wd(h);return{c(){c=Fe("div"),_&&_.c(),this.h()},l(v){c=Ne(v,"DIV",{class:!0,id:!0});var o=Be(c);_&&_.l(o),o.forEach(ae),this.h()},h(){oe(c,"class","absolute top-0 bg-grey4 w-full h-full svelte-a65d1y"),oe(c,"id",h[1]),Uu(()=>h[16].call(c))},m(v,o){Re(v,c,o),_&&_.m(c,null),d=Vu(c,h[16].bind(c)),h[17](c),f=!0},p(v,[o]){v[0]?_?(_.p(v,o),o&1&&rt(_,1)):(_=wd(v),_.c(),rt(_,1),_.m(c,null)):_&&(to(),lt(_,1,1,()=>{_=null}),ro()),(!f||o&2)&&oe(c,"id",v[1])},i(v){f||(rt(_),f=!0)},o(v){lt(_),f=!1},d(v){v&&ae(c),_&&_.d(),d(),h[17](null)}}}function Bg(h,c,d){let{$$slots:f={},$$scope:_}=c,{map:v}=c,{id:o="map"}=c,{location:z={bounds:[[-8.1775,54.02275],[-5.43279,55.31298]]}}=c,{style:T="https://raw.githubusercontent.com/nisra-explore/map_tiles/main/basemap_styles/style-omt.json"}=c,{interactive:M=!0}=c,{minzoom:F=0}=c,{maxzoom:R=14}=c,{zoom:D=null}=c,{scrollzoom:H=!0}=c,{geolocate:ne=!0}=c,{zoomcontrol:he=!0}=c,{options:ve={}}=c,me,xe;Hm("map",{getMap:()=>v}),z.bounds?ve={...ve,bounds:z.bounds}:z.lon&&z.lat&&(ve={...ve,center:[z.lon,z.lat]},z.zoom&&(ve.zoom=z.zoom)),Jm(()=>{const Ye=document.createElement("link");return Ye.rel="stylesheet",Ye.href="https://unpkg.com/mapbox-gl@1.13.0/dist/mapbox-gl.css",Ye.onload=()=>{d(0,v=new _h.Map({container:me,style:T,minZoom:F,maxZoom:R,maxBounds:[[-9.2,53.58],[-4.53,55.72]],interactive:M,...ve})),he&&v.addControl(new _h.NavigationControl({showCompass:!1})),H||v.scrollZoom.disable(),ne&&v.addControl(new _h.GeolocateControl),v.on("load",()=>{d(4,D=v.getZoom())}),v.on("zoom",()=>{d(4,D=v.getZoom())})},document.head.appendChild(Ye),()=>{v.remove(),Ye.parentNode.removeChild(Ye)}});function ot(){let Ye=document.getElementsByClassName("mapboxgl-canvas");Ye[0]&&(Ye[0].style.width="100%",v.resize())}function Je(){xe=this.clientWidth,d(2,xe)}function Le(Ye){Bu[Ye?"unshift":"push"](()=>{me=Ye,d(3,me)})}return h.$$set=Ye=>{"map"in Ye&&d(0,v=Ye.map),"id"in Ye&&d(1,o=Ye.id),"location"in Ye&&d(6,z=Ye.location),"style"in Ye&&d(7,T=Ye.style),"interactive"in Ye&&d(8,M=Ye.interactive),"minzoom"in Ye&&d(9,F=Ye.minzoom),"maxzoom"in Ye&&d(10,R=Ye.maxzoom),"zoom"in Ye&&d(4,D=Ye.zoom),"scrollzoom"in Ye&&d(11,H=Ye.scrollzoom),"geolocate"in Ye&&d(12,ne=Ye.geolocate),"zoomcontrol"in Ye&&d(13,he=Ye.zoomcontrol),"options"in Ye&&d(5,ve=Ye.options),"$$scope"in Ye&&d(14,_=Ye.$$scope)},h.$$.update=()=>{h.$$.dirty&4&&xe&&ot()},[v,o,xe,me,D,ve,z,T,M,F,R,H,ne,he,_,f,Je,Le]}class Og extends fn{constructor(c){super(),dn(this,c,Bg,Rg,mn,{map:0,id:1,location:6,style:7,interactive:8,minzoom:9,maxzoom:10,zoom:4,scrollzoom:11,geolocate:12,zoomcontrol:13,options:5})}}function kd(h){let c;const d=h[11].default,f=Mu(d,h,h[10],null);return{c(){f&&f.c()},l(_){f&&f.l(_)},m(_,v){f&&f.m(_,v),c=!0},p(_,v){f&&f.p&&(!c||v&1024)&&Du(f,d,_,_[10],c?Ru(d,_[10],v,null):Lu(_[10]),null)},i(_){c||(rt(f,_),c=!0)},o(_){lt(f,_),c=!1},d(_){f&&f.d(_)}}}function Fg(h){let c,d,f=h[0]&&kd(h);return{c(){f&&f.c(),c=br()},l(_){f&&f.l(_),c=br()},m(_,v){f&&f.m(_,v),Re(_,c,v),d=!0},p(_,[v]){_[0]?f?(f.p(_,v),v&1&&rt(f,1)):(f=kd(_),f.c(),rt(f,1),f.m(c.parentNode,c)):f&&(to(),lt(f,1,1,()=>{f=null}),ro())},i(_){d||(rt(f),d=!0)},o(_){lt(f),d=!1},d(_){f&&f.d(_),_&&ae(c)}}}function Ng(h,c,d){let{$$slots:f={},$$scope:_}=c,{id:v}=c,{type:o}=c,{url:z=null}=c,{props:T={}}=c,{data:M=null}=c,{layer:F=null}=c,{promoteId:R=null}=c,{minzoom:D=null}=c,{maxzoom:H=null}=c,ne=!1;const{getMap:he}=ju("map"),ve=he();ve.getSource(v)&&ve.removeSource(v);function me(){ve.isSourceLoaded(v)?(d(0,ne=!0),console.log(v+" loaded!")):setTimeout(()=>{console.log("..."),me()},500)}function xe(){ve.isStyleLoaded(v)?(ot(),document.querySelector("#map canvas")&&document.querySelector("#map canvas").tabIndex=="0"&&(document.querySelector("#map canvas").tabIndex="-1")):setTimeout(()=>{console.log("..."),xe()},500)}D&&(T.minzoom=D),H&&(T.maxzoom=H),F&&R?(T.promoteId={},T.promoteId[F]=R):R&&(T.promoteId=R);function ot(){console.log(v+" map source loading..."),o=="geojson"?M?(ve.addSource(v,{type:o,data:M,...T}),me()):z&&(ve.addSource(v,{type:o,data:z,...T}),me()):o=="vector"&&(ve.addSource(v,{type:o,tiles:[z],...T}),me())}xe();function Je(){ve.getSource(v).setData(M)}return h.$$set=Le=>{"id"in Le&&d(2,v=Le.id),"type"in Le&&d(3,o=Le.type),"url"in Le&&d(4,z=Le.url),"props"in Le&&d(1,T=Le.props),"data"in Le&&d(5,M=Le.data),"layer"in Le&&d(6,F=Le.layer),"promoteId"in Le&&d(7,R=Le.promoteId),"minzoom"in Le&&d(8,D=Le.minzoom),"maxzoom"in Le&&d(9,H=Le.maxzoom),"$$scope"in Le&&d(10,_=Le.$$scope)},h.$$.update=()=>{h.$$.dirty&33&&ne&&M&&Je()},[ne,T,v,o,z,M,F,R,D,H,_,f]}class Ug extends fn{constructor(c){super(),dn(this,c,Ng,Fg,mn,{id:2,type:3,url:4,props:1,data:5,layer:6,promoteId:7,minzoom:8,maxzoom:9})}}function Vg(h,c,d){const{Popup:f}=Lg,_=Q_(),v=new f({closeButton:!1,closeOnClick:!1});let{id:o}=c,{source:z}=c,{sourceLayer:T=null}=c,{type:M}=c,{filter:F=null}=c,{layout:R={}}=c,{paint:D={}}=c,{data:H=null}=c,{code:ne=null}=c,{name:he="name"}=c,{colorCode:ve=null}=c,{click:me=!1}=c,{ignoreClick:xe=!1}=c,{clickCenter:ot=!1}=c,{selected:Je=null}=c,{hover:Le=!1}=c,{hovered:Ye=null}=c,{highlight:It=!1}=c,{highlightKey:Lt="highlighted"}=c,{highlighted:jt=[]}=c,{order:_t=null}=c,{maxzoom:ht=null}=c,{minzoom:Ft=null}=c,{isChild:yt=!1}=c;const{getMap:zt}=ju("map"),et=zt();let qt=null,pt=null,At=[];et.getLayer(o)&&et.removeLayer(o);let Ut={id:o,type:M,source:z,paint:D,layout:R};F&&(Ut.filter=F),T&&(Ut["source-layer"]=T),ht&&(Ut.maxzoom=ht),Ft&&(Ut.minzoom=Ft),et.addLayer(Ut,_t);function cr(){console.log("updating colors..."),H.forEach(Ve=>{et.setFeatureState({source:z,sourceLayer:T,id:Ve[ne]},{color:Ve[ve]})})}return me&&et.on("click",o,Ve=>{if(Ve.features.length>0&&!xe){let fr=Ve.features[0].id;if(yt&&jt.includes(fr)||!yt&&Je!=fr){if(d(0,Je=fr),_("select",{code:Je}),qt&&et.setFeatureState({source:z,sourceLayer:T,id:qt},{selected:!1}),et.setFeatureState({source:z,sourceLayer:T,id:Je},{selected:!0}),ot){let hr=centroid(Ve.features[0].toJSON().geometry);et.flyTo({center:hr.geometry.coordinates})}d(24,qt=Je)}}}),Le&&(et.on("mousemove",o,Ve=>{if(Ve.features.length>0){let fr=Ve.features[0].id;Ye&&et.setFeatureState({source:z,sourceLayer:T,id:Ye},{hovered:!1}),yt&&jt.includes(fr)||!yt&&Je!=fr?(d(1,Ye=d(25,pt=fr)),et.setFeatureState({source:z,sourceLayer:T,id:Ye},{hovered:!0}),et.getCanvas().style.cursor="pointer",v.setLngLat(Ve.lngLat).setHTML(`<strong>${Ve.features[0].properties[he]?Ve.features[0].properties[he]:Ve.features[0].properties[ne]}</strong>`).addTo(et)):v.remove()}}),et.on("mouseleave",o,Ve=>{Ye&&et.setFeatureState({source:z,sourceLayer:T,id:Ye},{hovered:!1}),d(1,Ye=d(25,pt=null)),et.getCanvas().style.cursor="",v.remove()})),h.$$set=Ve=>{"id"in Ve&&d(2,o=Ve.id),"source"in Ve&&d(3,z=Ve.source),"sourceLayer"in Ve&&d(4,T=Ve.sourceLayer),"type"in Ve&&d(5,M=Ve.type),"filter"in Ve&&d(6,F=Ve.filter),"layout"in Ve&&d(7,R=Ve.layout),"paint"in Ve&&d(8,D=Ve.paint),"data"in Ve&&d(9,H=Ve.data),"code"in Ve&&d(10,ne=Ve.code),"name"in Ve&&d(11,he=Ve.name),"colorCode"in Ve&&d(12,ve=Ve.colorCode),"click"in Ve&&d(13,me=Ve.click),"ignoreClick"in Ve&&d(14,xe=Ve.ignoreClick),"clickCenter"in Ve&&d(15,ot=Ve.clickCenter),"selected"in Ve&&d(0,Je=Ve.selected),"hover"in Ve&&d(16,Le=Ve.hover),"hovered"in Ve&&d(1,Ye=Ve.hovered),"highlight"in Ve&&d(17,It=Ve.highlight),"highlightKey"in Ve&&d(18,Lt=Ve.highlightKey),"highlighted"in Ve&&d(19,jt=Ve.highlighted),"order"in Ve&&d(20,_t=Ve.order),"maxzoom"in Ve&&d(21,ht=Ve.maxzoom),"minzoom"in Ve&&d(22,Ft=Ve.minzoom),"isChild"in Ve&&d(23,yt=Ve.isChild)},h.$$.update=()=>{h.$$.dirty[0]&4096&&ve&&cr(),h.$$.dirty[0]&68026392&&It&&jt!=At&&(At[0]&&At.forEach(Ve=>{let fr={};fr[Lt]=!1,et.setFeatureState({source:z,sourceLayer:T,id:Ve},fr)}),d(26,At=jt),jt[0]&&jt.forEach(Ve=>{let fr={};fr[Lt]=!0,et.setFeatureState({source:z,sourceLayer:T,id:Ve},fr)})),h.$$.dirty[0]&16777241&&Je!=qt&&(qt&&et.setFeatureState({source:z,sourceLayer:T,id:qt},{selected:!1}),Je&&et.setFeatureState({source:z,sourceLayer:T,id:Je},{selected:!0}),d(24,qt=Je)),h.$$.dirty[0]&33619994&&Le&&Ye!=pt&&(pt&&et.setFeatureState({source:z,sourceLayer:T,id:pt},{hovered:!1}),Ye&&et.setFeatureState({source:z,sourceLayer:T,id:Ye},{hovered:!0}),d(25,pt=Ye))},[Je,Ye,o,z,T,M,F,R,D,H,ne,he,ve,me,xe,ot,Le,It,Lt,jt,_t,ht,Ft,yt,qt,pt,At]}class Ip extends fn{constructor(c){super(),dn(this,c,Vg,null,mn,{id:2,source:3,sourceLayer:4,type:5,filter:6,layout:7,paint:8,data:9,code:10,name:11,colorCode:12,click:13,ignoreClick:14,clickCenter:15,selected:0,hover:16,hovered:1,highlight:17,highlightKey:18,highlighted:19,order:20,maxzoom:21,minzoom:22,isChild:23},null,[-1,-1])}}function jg(h){return h===0?!0:h}function ts(h){return jg(h)?Array.isArray(h)?c=>h.map(d=>typeof d!="function"?c[d]:d(c)):typeof h!="function"?c=>c[h]:h:null}function qg(h){const c={};for(const d of h){if(Object(d)!==d)throw new TypeError("iterable for fromEntries should yield objects");const{"0":f,"1":_}=d;Object.defineProperty(c,f,{configurable:!0,enumerable:!0,writable:!0,value:_})}return c}function zp(h,c={}){return qg(Object.entries(h).filter(([d,f])=>f!==void 0&&c[d]===void 0))}function Zg(h,c){if(!Array.isArray(h))throw new TypeError(`The first argument of calcExtents() must be an array. You passed in a ${typeof h}. Consider passing a flat array to the \`flatData\` prop. More info: https://layercake.graphics/guide/#flatdata`);if(Array.isArray(c)||c===void 0||c===null)throw new TypeError("The second argument of calcExtents() must be an object with field names as keys as accessor functions as values.");const d={},f=Object.keys(c),_=f.length;let v,o,z,T,M,F,R,D;const H=h.length;for(v=0;v<_;v+=1){for(T=f[v],R=c[T],M=null,F=null,o=0;o<H;o+=1)if(D=R(h[o]),Array.isArray(D)){const ne=D.length;for(z=0;z<ne;z+=1)D[z]!==void 0&&D[z]!==null&&Number.isNaN(D[z])===!1&&((M===null||D[z]<M)&&(M=D[z]),(F===null||D[z]>F)&&(F=D[z]))}else D!=null&&Number.isNaN(D)===!1&&((M===null||D<M)&&(M=D),(F===null||D>F)&&(F=D));d[T]=[M,F]}return d}function ry(h=[],c){return Array.isArray(c)===!0?c.map((d,f)=>d===null?h[f]:d):h}function oh(h){return function([d,f]){return d?ry(d[h],f):f}}function gh(h,c){return h==null||c==null?NaN:h<c?-1:h>c?1:h>=c?0:NaN}function Gg(h,c){return h==null||c==null?NaN:c<h?-1:c>h?1:c>=h?0:NaN}function iy(h){let c,d,f;h.length!==2?(c=gh,d=(z,T)=>gh(h(z),T),f=(z,T)=>h(z)-T):(c=h===gh||h===Gg?h:Kg,d=h,f=h);function _(z,T,M=0,F=z.length){if(M<F){if(c(T,T)!==0)return F;do{const R=M+F>>>1;d(z[R],T)<0?M=R+1:F=R}while(M<F)}return M}function v(z,T,M=0,F=z.length){if(M<F){if(c(T,T)!==0)return F;do{const R=M+F>>>1;d(z[R],T)<=0?M=R+1:F=R}while(M<F)}return M}function o(z,T,M=0,F=z.length){const R=_(z,T,M,F-1);return R>M&&f(z[R-1],T)>-f(z[R],T)?R-1:R}return{left:_,center:o,right:v}}function Kg(){return 0}function Xg(h){return h===null?NaN:+h}const Wg=iy(gh),Hg=Wg.right;iy(Xg).center;const Jg=Hg;class Sd extends Map{constructor(c,d=$g){if(super(),Object.defineProperties(this,{_intern:{value:new Map},_key:{value:d}}),c!=null)for(const[f,_]of c)this.set(f,_)}get(c){return super.get(Ed(this,c))}has(c){return super.has(Ed(this,c))}set(c,d){return super.set(Yg(this,c),d)}delete(c){return super.delete(Qg(this,c))}}function Ed({_intern:h,_key:c},d){const f=c(d);return h.has(f)?h.get(f):d}function Yg({_intern:h,_key:c},d){const f=c(d);return h.has(f)?h.get(f):(h.set(f,d),d)}function Qg({_intern:h,_key:c},d){const f=c(d);return h.has(f)&&(d=h.get(f),h.delete(f)),d}function $g(h){return h!==null&&typeof h=="object"?h.valueOf():h}var Mp=Math.sqrt(50),Dp=Math.sqrt(10),Lp=Math.sqrt(2);function ev(h,c,d){var f,_=-1,v,o,z;if(c=+c,h=+h,d=+d,h===c&&d>0)return[h];if((f=c<h)&&(v=h,h=c,c=v),(z=ny(h,c,d))===0||!isFinite(z))return[];if(z>0){let T=Math.round(h/z),M=Math.round(c/z);for(T*z<h&&++T,M*z>c&&--M,o=new Array(v=M-T+1);++_<v;)o[_]=(T+_)*z}else{z=-z;let T=Math.round(h*z),M=Math.round(c*z);for(T/z<h&&++T,M/z>c&&--M,o=new Array(v=M-T+1);++_<v;)o[_]=(T+_)/z}return f&&o.reverse(),o}function ny(h,c,d){var f=(c-h)/Math.max(0,d),_=Math.floor(Math.log(f)/Math.LN10),v=f/Math.pow(10,_);return _>=0?(v>=Mp?10:v>=Dp?5:v>=Lp?2:1)*Math.pow(10,_):-Math.pow(10,-_)/(v>=Mp?10:v>=Dp?5:v>=Lp?2:1)}function tv(h,c,d){var f=Math.abs(c-h)/Math.max(0,d),_=Math.pow(10,Math.floor(Math.log(f)/Math.LN10)),v=f/_;return v>=Mp?_*=10:v>=Dp?_*=5:v>=Lp&&(_*=2),c<h?-_:_}function rv(h,c,d){h=+h,c=+c,d=(_=arguments.length)<2?(c=h,h=0,1):_<3?1:+d;for(var f=-1,_=Math.max(0,Math.ceil((c-h)/d))|0,v=new Array(_);++f<_;)v[f]=h+f*d;return v}function Ch(h,c){switch(arguments.length){case 0:break;case 1:this.range(h);break;default:this.range(c).domain(h);break}return this}const Td=Symbol("implicit");function oy(){var h=new Sd,c=[],d=[],f=Td;function _(v){let o=h.get(v);if(o===void 0){if(f!==Td)return f;h.set(v,o=c.push(v)-1)}return d[o%d.length]}return _.domain=function(v){if(!arguments.length)return c.slice();c=[],h=new Sd;for(const o of v)h.has(o)||h.set(o,c.push(o)-1);return _},_.range=function(v){return arguments.length?(d=Array.from(v),_):d.slice()},_.unknown=function(v){return arguments.length?(f=v,_):f},_.copy=function(){return oy(c,d).unknown(f)},Ch.apply(_,arguments),_}function ay(){var h=oy().unknown(void 0),c=h.domain,d=h.range,f=0,_=1,v,o,z=!1,T=0,M=0,F=.5;delete h.unknown;function R(){var D=c().length,H=_<f,ne=H?_:f,he=H?f:_;v=(he-ne)/Math.max(1,D-T+M*2),z&&(v=Math.floor(v)),ne+=(he-ne-v*(D-T))*F,o=v*(1-T),z&&(ne=Math.round(ne),o=Math.round(o));var ve=rv(D).map(function(me){return ne+v*me});return d(H?ve.reverse():ve)}return h.domain=function(D){return arguments.length?(c(D),R()):c()},h.range=function(D){return arguments.length?([f,_]=D,f=+f,_=+_,R()):[f,_]},h.rangeRound=function(D){return[f,_]=D,f=+f,_=+_,z=!0,R()},h.bandwidth=function(){return o},h.step=function(){return v},h.round=function(D){return arguments.length?(z=!!D,R()):z},h.padding=function(D){return arguments.length?(T=Math.min(1,M=+D),R()):T},h.paddingInner=function(D){return arguments.length?(T=Math.min(1,D),R()):T},h.paddingOuter=function(D){return arguments.length?(M=+D,R()):M},h.align=function(D){return arguments.length?(F=Math.max(0,Math.min(1,D)),R()):F},h.copy=function(){return ay(c(),[f,_]).round(z).paddingInner(T).paddingOuter(M).align(F)},Ch.apply(R(),arguments)}function qp(h,c,d){h.prototype=c.prototype=d,d.constructor=h}function sy(h,c){var d=Object.create(h.prototype);for(var f in c)d[f]=c[f];return d}function $u(){}var Ou=.7,wh=1/Ou,Ml="\\s*([+-]?\\d+)\\s*",Fu="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",ca="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",iv=/^#([0-9a-f]{3,8})$/,nv=new RegExp(`^rgb\\(${Ml},${Ml},${Ml}\\)$`),ov=new RegExp(`^rgb\\(${ca},${ca},${ca}\\)$`),av=new RegExp(`^rgba\\(${Ml},${Ml},${Ml},${Fu}\\)$`),sv=new RegExp(`^rgba\\(${ca},${ca},${ca},${Fu}\\)$`),lv=new RegExp(`^hsl\\(${Fu},${ca},${ca}\\)$`),uv=new RegExp(`^hsla\\(${Fu},${ca},${ca},${Fu}\\)$`),Id={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};qp($u,Nu,{copy(h){return Object.assign(new this.constructor,this,h)},displayable(){return this.rgb().displayable()},hex:zd,formatHex:zd,formatHex8:cv,formatHsl:hv,formatRgb:Ad,toString:Ad});function zd(){return this.rgb().formatHex()}function cv(){return this.rgb().formatHex8()}function hv(){return ly(this).formatHsl()}function Ad(){return this.rgb().formatRgb()}function Nu(h){var c,d;return h=(h+"").trim().toLowerCase(),(c=iv.exec(h))?(d=c[1].length,c=parseInt(c[1],16),d===6?Pd(c):d===3?new co(c>>8&15|c>>4&240,c>>4&15|c&240,(c&15)<<4|c&15,1):d===8?ah(c>>24&255,c>>16&255,c>>8&255,(c&255)/255):d===4?ah(c>>12&15|c>>8&240,c>>8&15|c>>4&240,c>>4&15|c&240,((c&15)<<4|c&15)/255):null):(c=nv.exec(h))?new co(c[1],c[2],c[3],1):(c=ov.exec(h))?new co(c[1]*255/100,c[2]*255/100,c[3]*255/100,1):(c=av.exec(h))?ah(c[1],c[2],c[3],c[4]):(c=sv.exec(h))?ah(c[1]*255/100,c[2]*255/100,c[3]*255/100,c[4]):(c=lv.exec(h))?Dd(c[1],c[2]/100,c[3]/100,1):(c=uv.exec(h))?Dd(c[1],c[2]/100,c[3]/100,c[4]):Id.hasOwnProperty(h)?Pd(Id[h]):h==="transparent"?new co(NaN,NaN,NaN,0):null}function Pd(h){return new co(h>>16&255,h>>8&255,h&255,1)}function ah(h,c,d,f){return f<=0&&(h=c=d=NaN),new co(h,c,d,f)}function pv(h){return h instanceof $u||(h=Nu(h)),h?(h=h.rgb(),new co(h.r,h.g,h.b,h.opacity)):new co}function Rp(h,c,d,f){return arguments.length===1?pv(h):new co(h,c,d,f??1)}function co(h,c,d,f){this.r=+h,this.g=+c,this.b=+d,this.opacity=+f}qp(co,Rp,sy($u,{brighter(h){return h=h==null?wh:Math.pow(wh,h),new co(this.r*h,this.g*h,this.b*h,this.opacity)},darker(h){return h=h==null?Ou:Math.pow(Ou,h),new co(this.r*h,this.g*h,this.b*h,this.opacity)},rgb(){return this},clamp(){return new co(Ls(this.r),Ls(this.g),Ls(this.b),kh(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:Cd,formatHex:Cd,formatHex8:fv,formatRgb:Md,toString:Md}));function Cd(){return`#${Ds(this.r)}${Ds(this.g)}${Ds(this.b)}`}function fv(){return`#${Ds(this.r)}${Ds(this.g)}${Ds(this.b)}${Ds((isNaN(this.opacity)?1:this.opacity)*255)}`}function Md(){const h=kh(this.opacity);return`${h===1?"rgb(":"rgba("}${Ls(this.r)}, ${Ls(this.g)}, ${Ls(this.b)}${h===1?")":`, ${h})`}`}function kh(h){return isNaN(h)?1:Math.max(0,Math.min(1,h))}function Ls(h){return Math.max(0,Math.min(255,Math.round(h)||0))}function Ds(h){return h=Ls(h),(h<16?"0":"")+h.toString(16)}function Dd(h,c,d,f){return f<=0?h=c=d=NaN:d<=0||d>=1?h=c=NaN:c<=0&&(h=NaN),new Uo(h,c,d,f)}function ly(h){if(h instanceof Uo)return new Uo(h.h,h.s,h.l,h.opacity);if(h instanceof $u||(h=Nu(h)),!h)return new Uo;if(h instanceof Uo)return h;h=h.rgb();var c=h.r/255,d=h.g/255,f=h.b/255,_=Math.min(c,d,f),v=Math.max(c,d,f),o=NaN,z=v-_,T=(v+_)/2;return z?(c===v?o=(d-f)/z+(d<f)*6:d===v?o=(f-c)/z+2:o=(c-d)/z+4,z/=T<.5?v+_:2-v-_,o*=60):z=T>0&&T<1?0:o,new Uo(o,z,T,h.opacity)}function dv(h,c,d,f){return arguments.length===1?ly(h):new Uo(h,c,d,f??1)}function Uo(h,c,d,f){this.h=+h,this.s=+c,this.l=+d,this.opacity=+f}qp(Uo,dv,sy($u,{brighter(h){return h=h==null?wh:Math.pow(wh,h),new Uo(this.h,this.s,this.l*h,this.opacity)},darker(h){return h=h==null?Ou:Math.pow(Ou,h),new Uo(this.h,this.s,this.l*h,this.opacity)},rgb(){var h=this.h%360+(this.h<0)*360,c=isNaN(h)||isNaN(this.s)?0:this.s,d=this.l,f=d+(d<.5?d:1-d)*c,_=2*d-f;return new co(Ap(h>=240?h-240:h+120,_,f),Ap(h,_,f),Ap(h<120?h+240:h-120,_,f),this.opacity)},clamp(){return new Uo(Ld(this.h),sh(this.s),sh(this.l),kh(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){const h=kh(this.opacity);return`${h===1?"hsl(":"hsla("}${Ld(this.h)}, ${sh(this.s)*100}%, ${sh(this.l)*100}%${h===1?")":`, ${h})`}`}}));function Ld(h){return h=(h||0)%360,h<0?h+360:h}function sh(h){return Math.max(0,Math.min(1,h||0))}function Ap(h,c,d){return(h<60?c+(d-c)*h/60:h<180?d:h<240?c+(d-c)*(240-h)/60:c)*255}const Zp=h=>()=>h;function mv(h,c){return function(d){return h+d*c}}function yv(h,c,d){return h=Math.pow(h,d),c=Math.pow(c,d)-h,d=1/d,function(f){return Math.pow(h+f*c,d)}}function _v(h){return(h=+h)==1?uy:function(c,d){return d-c?yv(c,d,h):Zp(isNaN(c)?d:c)}}function uy(h,c){var d=c-h;return d?mv(h,d):Zp(isNaN(h)?c:h)}const Rd=function h(c){var d=_v(c);function f(_,v){var o=d((_=Rp(_)).r,(v=Rp(v)).r),z=d(_.g,v.g),T=d(_.b,v.b),M=uy(_.opacity,v.opacity);return function(F){return _.r=o(F),_.g=z(F),_.b=T(F),_.opacity=M(F),_+""}}return f.gamma=h,f}(1);function gv(h,c){c||(c=[]);var d=h?Math.min(c.length,h.length):0,f=c.slice(),_;return function(v){for(_=0;_<d;++_)f[_]=h[_]*(1-v)+c[_]*v;return f}}function vv(h){return ArrayBuffer.isView(h)&&!(h instanceof DataView)}function bv(h,c){var d=c?c.length:0,f=h?Math.min(d,h.length):0,_=new Array(f),v=new Array(d),o;for(o=0;o<f;++o)_[o]=Gp(h[o],c[o]);for(;o<d;++o)v[o]=c[o];return function(z){for(o=0;o<f;++o)v[o]=_[o](z);return v}}function xv(h,c){var d=new Date;return h=+h,c=+c,function(f){return d.setTime(h*(1-f)+c*f),d}}function Sh(h,c){return h=+h,c=+c,function(d){return h*(1-d)+c*d}}function wv(h,c){var d={},f={},_;(h===null||typeof h!="object")&&(h={}),(c===null||typeof c!="object")&&(c={});for(_ in c)_ in h?d[_]=Gp(h[_],c[_]):f[_]=c[_];return function(v){for(_ in d)f[_]=d[_](v);return f}}var Bp=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,Pp=new RegExp(Bp.source,"g");function kv(h){return function(){return h}}function Sv(h){return function(c){return h(c)+""}}function Ev(h,c){var d=Bp.lastIndex=Pp.lastIndex=0,f,_,v,o=-1,z=[],T=[];for(h=h+"",c=c+"";(f=Bp.exec(h))&&(_=Pp.exec(c));)(v=_.index)>d&&(v=c.slice(d,v),z[o]?z[o]+=v:z[++o]=v),(f=f[0])===(_=_[0])?z[o]?z[o]+=_:z[++o]=_:(z[++o]=null,T.push({i:o,x:Sh(f,_)})),d=Pp.lastIndex;return d<c.length&&(v=c.slice(d),z[o]?z[o]+=v:z[++o]=v),z.length<2?T[0]?Sv(T[0].x):kv(c):(c=T.length,function(M){for(var F=0,R;F<c;++F)z[(R=T[F]).i]=R.x(M);return z.join("")})}function Gp(h,c){var d=typeof c,f;return c==null||d==="boolean"?Zp(c):(d==="number"?Sh:d==="string"?(f=Nu(c))?(c=f,Rd):Ev:c instanceof Nu?Rd:c instanceof Date?xv:vv(c)?gv:Array.isArray(c)?bv:typeof c.valueOf!="function"&&typeof c.toString!="function"||isNaN(c)?wv:Sh)(h,c)}function Tv(h,c){return h=+h,c=+c,function(d){return Math.round(h*(1-d)+c*d)}}function Iv(h){return function(){return h}}function zv(h){return+h}var Bd=[0,1];function ua(h){return h}function Op(h,c){return(c-=h=+h)?function(d){return(d-h)/c}:Iv(isNaN(c)?NaN:.5)}function Av(h,c){var d;return h>c&&(d=h,h=c,c=d),function(f){return Math.max(h,Math.min(c,f))}}function Pv(h,c,d){var f=h[0],_=h[1],v=c[0],o=c[1];return _<f?(f=Op(_,f),v=d(o,v)):(f=Op(f,_),v=d(v,o)),function(z){return v(f(z))}}function Cv(h,c,d){var f=Math.min(h.length,c.length)-1,_=new Array(f),v=new Array(f),o=-1;for(h[f]<h[0]&&(h=h.slice().reverse(),c=c.slice().reverse());++o<f;)_[o]=Op(h[o],h[o+1]),v[o]=d(c[o],c[o+1]);return function(z){var T=Jg(h,z,1,f)-1;return v[T](_[T](z))}}function cy(h,c){return c.domain(h.domain()).range(h.range()).interpolate(h.interpolate()).clamp(h.clamp()).unknown(h.unknown())}function hy(){var h=Bd,c=Bd,d=Gp,f,_,v,o=ua,z,T,M;function F(){var D=Math.min(h.length,c.length);return o!==ua&&(o=Av(h[0],h[D-1])),z=D>2?Cv:Pv,T=M=null,R}function R(D){return D==null||isNaN(D=+D)?v:(T||(T=z(h.map(f),c,d)))(f(o(D)))}return R.invert=function(D){return o(_((M||(M=z(c,h.map(f),Sh)))(D)))},R.domain=function(D){return arguments.length?(h=Array.from(D,zv),F()):h.slice()},R.range=function(D){return arguments.length?(c=Array.from(D),F()):c.slice()},R.rangeRound=function(D){return c=Array.from(D),d=Tv,F()},R.clamp=function(D){return arguments.length?(o=D?!0:ua,F()):o!==ua},R.interpolate=function(D){return arguments.length?(d=D,F()):d},R.unknown=function(D){return arguments.length?(v=D,R):v},function(D,H){return f=D,_=H,F()}}function Mv(){return hy()(ua,ua)}function Dv(h){return Math.abs(h=Math.round(h))>=1e21?h.toLocaleString("en").replace(/,/g,""):h.toString(10)}function Eh(h,c){if((d=(h=c?h.toExponential(c-1):h.toExponential()).indexOf("e"))<0)return null;var d,f=h.slice(0,d);return[f.length>1?f[0]+f.slice(2):f,+h.slice(d+1)]}function Dl(h){return h=Eh(Math.abs(h)),h?h[1]:NaN}function Lv(h,c){return function(d,f){for(var _=d.length,v=[],o=0,z=h[0],T=0;_>0&&z>0&&(T+z+1>f&&(z=Math.max(1,f-T)),v.push(d.substring(_-=z,_+z)),!((T+=z+1)>f));)z=h[o=(o+1)%h.length];return v.reverse().join(c)}}function Rv(h){return function(c){return c.replace(/[0-9]/g,function(d){return h[+d]})}}var Bv=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function Th(h){if(!(c=Bv.exec(h)))throw new Error("invalid format: "+h);var c;return new Kp({fill:c[1],align:c[2],sign:c[3],symbol:c[4],zero:c[5],width:c[6],comma:c[7],precision:c[8]&&c[8].slice(1),trim:c[9],type:c[10]})}Th.prototype=Kp.prototype;function Kp(h){this.fill=h.fill===void 0?" ":h.fill+"",this.align=h.align===void 0?">":h.align+"",this.sign=h.sign===void 0?"-":h.sign+"",this.symbol=h.symbol===void 0?"":h.symbol+"",this.zero=!!h.zero,this.width=h.width===void 0?void 0:+h.width,this.comma=!!h.comma,this.precision=h.precision===void 0?void 0:+h.precision,this.trim=!!h.trim,this.type=h.type===void 0?"":h.type+""}Kp.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(this.width===void 0?"":Math.max(1,this.width|0))+(this.comma?",":"")+(this.precision===void 0?"":"."+Math.max(0,this.precision|0))+(this.trim?"~":"")+this.type};function Ov(h){e:for(var c=h.length,d=1,f=-1,_;d<c;++d)switch(h[d]){case".":f=_=d;break;case"0":f===0&&(f=d),_=d;break;default:if(!+h[d])break e;f>0&&(f=0);break}return f>0?h.slice(0,f)+h.slice(_+1):h}var py;function Fv(h,c){var d=Eh(h,c);if(!d)return h+"";var f=d[0],_=d[1],v=_-(py=Math.max(-8,Math.min(8,Math.floor(_/3)))*3)+1,o=f.length;return v===o?f:v>o?f+new Array(v-o+1).join("0"):v>0?f.slice(0,v)+"."+f.slice(v):"0."+new Array(1-v).join("0")+Eh(h,Math.max(0,c+v-1))[0]}function Od(h,c){var d=Eh(h,c);if(!d)return h+"";var f=d[0],_=d[1];return _<0?"0."+new Array(-_).join("0")+f:f.length>_+1?f.slice(0,_+1)+"."+f.slice(_+1):f+new Array(_-f.length+2).join("0")}const Fd={"%":(h,c)=>(h*100).toFixed(c),b:h=>Math.round(h).toString(2),c:h=>h+"",d:Dv,e:(h,c)=>h.toExponential(c),f:(h,c)=>h.toFixed(c),g:(h,c)=>h.toPrecision(c),o:h=>Math.round(h).toString(8),p:(h,c)=>Od(h*100,c),r:Od,s:Fv,X:h=>Math.round(h).toString(16).toUpperCase(),x:h=>Math.round(h).toString(16)};function Nd(h){return h}var Ud=Array.prototype.map,Vd=["y","z","a","f","p","n","µ","m","","k","M","G","T","P","E","Z","Y"];function Nv(h){var c=h.grouping===void 0||h.thousands===void 0?Nd:Lv(Ud.call(h.grouping,Number),h.thousands+""),d=h.currency===void 0?"":h.currency[0]+"",f=h.currency===void 0?"":h.currency[1]+"",_=h.decimal===void 0?".":h.decimal+"",v=h.numerals===void 0?Nd:Rv(Ud.call(h.numerals,String)),o=h.percent===void 0?"%":h.percent+"",z=h.minus===void 0?"−":h.minus+"",T=h.nan===void 0?"NaN":h.nan+"";function M(R){R=Th(R);var D=R.fill,H=R.align,ne=R.sign,he=R.symbol,ve=R.zero,me=R.width,xe=R.comma,ot=R.precision,Je=R.trim,Le=R.type;Le==="n"?(xe=!0,Le="g"):Fd[Le]||(ot===void 0&&(ot=12),Je=!0,Le="g"),(ve||D==="0"&&H==="=")&&(ve=!0,D="0",H="=");var Ye=he==="$"?d:he==="#"&&/[boxX]/.test(Le)?"0"+Le.toLowerCase():"",It=he==="$"?f:/[%p]/.test(Le)?o:"",Lt=Fd[Le],jt=/[defgprs%]/.test(Le);ot=ot===void 0?6:/[gprs]/.test(Le)?Math.max(1,Math.min(21,ot)):Math.max(0,Math.min(20,ot));function _t(ht){var Ft=Ye,yt=It,zt,et,qt;if(Le==="c")yt=Lt(ht)+yt,ht="";else{ht=+ht;var pt=ht<0||1/ht<0;if(ht=isNaN(ht)?T:Lt(Math.abs(ht),ot),Je&&(ht=Ov(ht)),pt&&+ht==0&&ne!=="+"&&(pt=!1),Ft=(pt?ne==="("?ne:z:ne==="-"||ne==="("?"":ne)+Ft,yt=(Le==="s"?Vd[8+py/3]:"")+yt+(pt&&ne==="("?")":""),jt){for(zt=-1,et=ht.length;++zt<et;)if(qt=ht.charCodeAt(zt),48>qt||qt>57){yt=(qt===46?_+ht.slice(zt+1):ht.slice(zt))+yt,ht=ht.slice(0,zt);break}}}xe&&!ve&&(ht=c(ht,1/0));var At=Ft.length+ht.length+yt.length,Ut=At<me?new Array(me-At+1).join(D):"";switch(xe&&ve&&(ht=c(Ut+ht,Ut.length?me-yt.length:1/0),Ut=""),H){case"<":ht=Ft+ht+yt+Ut;break;case"=":ht=Ft+Ut+ht+yt;break;case"^":ht=Ut.slice(0,At=Ut.length>>1)+Ft+ht+yt+Ut.slice(At);break;default:ht=Ut+Ft+ht+yt;break}return v(ht)}return _t.toString=function(){return R+""},_t}function F(R,D){var H=M((R=Th(R),R.type="f",R)),ne=Math.max(-8,Math.min(8,Math.floor(Dl(D)/3)))*3,he=Math.pow(10,-ne),ve=Vd[8+ne/3];return function(me){return H(he*me)+ve}}return{format:M,formatPrefix:F}}var lh,fy,dy;Uv({thousands:",",grouping:[3],currency:["$",""]});function Uv(h){return lh=Nv(h),fy=lh.format,dy=lh.formatPrefix,lh}function Vv(h){return Math.max(0,-Dl(Math.abs(h)))}function jv(h,c){return Math.max(0,Math.max(-8,Math.min(8,Math.floor(Dl(c)/3)))*3-Dl(Math.abs(h)))}function qv(h,c){return h=Math.abs(h),c=Math.abs(c)-h,Math.max(0,Dl(c)-Dl(h))+1}function Zv(h,c,d,f){var _=tv(h,c,d),v;switch(f=Th(f??",f"),f.type){case"s":{var o=Math.max(Math.abs(h),Math.abs(c));return f.precision==null&&!isNaN(v=jv(_,o))&&(f.precision=v),dy(f,o)}case"":case"e":case"g":case"p":case"r":{f.precision==null&&!isNaN(v=qv(_,Math.max(Math.abs(h),Math.abs(c))))&&(f.precision=v-(f.type==="e"));break}case"f":case"%":{f.precision==null&&!isNaN(v=Vv(_))&&(f.precision=v-(f.type==="%")*2);break}}return fy(f)}function my(h){var c=h.domain;return h.ticks=function(d){var f=c();return ev(f[0],f[f.length-1],d??10)},h.tickFormat=function(d,f){var _=c();return Zv(_[0],_[_.length-1],d??10,f)},h.nice=function(d){d==null&&(d=10);var f=c(),_=0,v=f.length-1,o=f[_],z=f[v],T,M,F=10;for(z<o&&(M=o,o=z,z=M,M=_,_=v,v=M);F-- >0;){if(M=ny(o,z,d),M===T)return f[_]=o,f[v]=z,c(f);if(M>0)o=Math.floor(o/M)*M,z=Math.ceil(z/M)*M;else if(M<0)o=Math.ceil(o*M)/M,z=Math.floor(z*M)/M;else break;T=M}return h},h}function vh(){var h=Mv();return h.copy=function(){return cy(h,vh())},Ch.apply(h,arguments),my(h)}function jd(h){return function(c){return c<0?-Math.pow(-c,h):Math.pow(c,h)}}function Gv(h){return h<0?-Math.sqrt(-h):Math.sqrt(h)}function Kv(h){return h<0?-h*h:h*h}function Xv(h){var c=h(ua,ua),d=1;function f(){return d===1?h(ua,ua):d===.5?h(Gv,Kv):h(jd(d),jd(1/d))}return c.exponent=function(_){return arguments.length?(d=+_,f()):d},my(c)}function yy(){var h=Xv(hy());return h.copy=function(){return cy(h,yy()).exponent(h.exponent())},Ch.apply(h,arguments),h}function Wv(){return yy.apply(null,arguments).exponent(.5)}const Cu={x:vh,y:vh,z:vh,r:Wv};function Hv(h){return h.constant?"symlog":h.base?"log":h.exponent?h.exponent()===.5?"sqrt":"pow":"other"}function qd(h){return h}function Jv(h){return c=>Math.log(h*c)}function Yv(h){return c=>h*Math.exp(c)}function Qv(h){return c=>Math.sign(c)*Math.log1p(Math.abs(c/h))}function $v(h){return c=>Math.sign(c)*Math.expm1(Math.abs(c))*h}function uh(h){return function(d){return d<0?-Math.pow(-d,h):Math.pow(d,h)}}function e0(h){const c=Hv(h);if(c==="log"){const d=Math.sign(h.domain()[0]);return{lift:Jv(d),ground:Yv(d),scaleType:c}}return c==="pow"?{lift:uh(1),ground:uh(1/1),scaleType:c}:c==="sqrt"?{lift:uh(.5),ground:uh(1/.5),scaleType:c}:c==="symlog"?{lift:Qv(1),ground:$v(1),scaleType:c}:{lift:qd,ground:qd,scaleType:c}}function t0(h,c){if(typeof h.range!="function")throw new Error("Scale method `range` must be a function");if(typeof h.domain!="function")throw new Error("Scale method `domain` must be a function");if(!Array.isArray(c))return h.domain();h.domain().length!==2&&console.warn("[LayerCake] The scale is expected to have a domain of length 2 to use padding. Are you sure you want to use padding? Your scale's domain is:",h.domain()),h.range().length!==2&&console.warn("[LayerCake] The scale is expected to have a range of length 2 to use padding. Are you sure you want to use padding? Your scale's range is:",h.range());const{lift:d,ground:f}=e0(h),_=h.domain()[0],v=Object.prototype.toString.call(_)==="[object Date]",[o,z]=h.domain().map(H=>d(v?H.getTime():H)),[T,M]=h.range(),F=c[0]||0,R=c[1]||0,D=(z-o)/(Math.abs(M-T)-F-R);return[o-F*D,R*D+z].map(H=>f(v?new Date(H):H))}function r0(h,c,d,f,_){let v,o;return _===!0?(v=0,o=100):(v=h==="r"?1:0,o=h==="y"?d:h==="r"?25:c),f===!0?[o,v]:[v,o]}function i0(h,c,d,f,_,v){return _?typeof _=="function"?_({width:c,height:d}):_:r0(h,c,d,f,v)}function ch(h){return function([d,f,_,v,o,z,T,M,F,R]){if(f===null)return null;const D=i0(h,T,M,z,F,R),H=d===Cu[h]?d():d.copy();return H.domain(ry(f[h],_)).range(D),v&&H.domain(t0(H,v)),o===!0&&(typeof H.nice=="function"?H.nice():console.error(`[Layer Cake] You set \`${h}Nice: true\` but the ${h}Scale does not have a \`.nice\` method. Ignoring...`)),H}}function hh([h,c]){return d=>{const f=h(d);return Array.isArray(f)?f.map(_=>c(_)):c(f)}}function ph([h]){if(typeof h=="function"){if(typeof h.range=="function")return h.range();console.error("[LayerCake] Your scale doesn't have a `.range` method?")}return null}const fh={x:!1,y:!0,z:!1,r:!1};const n0=h=>({element:h[0]&4,width:h[0]&256,height:h[0]&512,aspectRatio:h[0]&1024,containerWidth:h[0]&128,containerHeight:h[0]&64}),Zd=h=>({element:h[2],width:h[8],height:h[9],aspectRatio:h[10],containerWidth:h[7],containerHeight:h[6]});function Gd(h){let c,d,f;const _=h[90].default,v=Mu(_,h,h[89],Zd);return{c(){c=Fe("div"),v&&v.c(),this.h()},l(o){c=Ne(o,"DIV",{class:!0});var z=Be(c);v&&v.l(z),z.forEach(ae),this.h()},h(){oe(c,"class","layercake-container svelte-vhzpsp"),Uu(()=>h[92].call(c)),Ge(c,"position",h[5]),Ge(c,"top",h[5]==="absolute"?"0":null),Ge(c,"right",h[5]==="absolute"?"0":null),Ge(c,"bottom",h[5]==="absolute"?"0":null),Ge(c,"left",h[5]==="absolute"?"0":null),Ge(c,"pointer-events",h[4]===!1?"none":null)},m(o,z){Re(o,c,z),v&&v.m(c,null),h[91](c),d=Vu(c,h[92].bind(c)),f=!0},p(o,z){v&&v.p&&(!f||z[0]&1988|z[2]&134217728)&&Du(v,_,o,o[89],f?Ru(_,o[89],z,n0):Lu(o[89]),Zd),z[0]&32&&Ge(c,"position",o[5]),z[0]&32&&Ge(c,"top",o[5]==="absolute"?"0":null),z[0]&32&&Ge(c,"right",o[5]==="absolute"?"0":null),z[0]&32&&Ge(c,"bottom",o[5]==="absolute"?"0":null),z[0]&32&&Ge(c,"left",o[5]==="absolute"?"0":null),z[0]&16&&Ge(c,"pointer-events",o[4]===!1?"none":null)},i(o){f||(rt(v,o),f=!0)},o(o){lt(v,o),f=!1},d(o){o&&ae(c),v&&v.d(o),h[91](null),d()}}}function o0(h){let c,d,f=(h[3]===!0||typeof window<"u")&&Gd(h);return{c(){f&&f.c(),c=br()},l(_){f&&f.l(_),c=br()},m(_,v){f&&f.m(_,v),Re(_,c,v),d=!0},p(_,v){_[3]===!0||typeof window<"u"?f?(f.p(_,v),v[0]&8&&rt(f,1)):(f=Gd(_),f.c(),rt(f,1),f.m(c.parentNode,c)):f&&(to(),lt(f,1,1,()=>{f=null}),ro())},i(_){d||(rt(f),d=!0)},o(_){lt(f),d=!1},d(_){f&&f.d(_),_&&ae(c)}}}function a0(h,c,d){let f,_,v,o,z,T,M,F,R,D,H,ne,he,ve,me,xe,ot,Je,Le,Ye,It,Lt,jt,_t,ht,Ft,yt,zt,et,qt,pt,At,Ut,cr,Ve,fr,hr,xr,Fr,wi,sr,{$$slots:Qr={},$$scope:kt}=c,{ssr:Ur=!1}=c,{pointerEvents:Tn=!0}=c,{position:$r="relative"}=c,{percentRange:Zt=!1}=c,{width:$t=void 0}=c,{height:Dr=void 0}=c,{containerWidth:Pr=$t||100}=c,{containerHeight:Dn=Dr||100}=c,{element:Xr=void 0}=c,{x:gi=void 0}=c,{y:ci=void 0}=c,{z:Ji=void 0}=c,{r:Ci=void 0}=c,{data:hi=[]}=c,{xDomain:ei=void 0}=c,{yDomain:on=void 0}=c,{zDomain:pi=void 0}=c,{rDomain:Nr=void 0}=c,{xNice:Yi=!1}=c,{yNice:Ln=!1}=c,{zNice:Oi=!1}=c,{rNice:In=!1}=c,{xReverse:Qi=fh.x}=c,{yReverse:zn=fh.y}=c,{zReverse:Fi=fh.z}=c,{rReverse:yn=fh.r}=c,{xPadding:Ni=void 0}=c,{yPadding:Rn=void 0}=c,{zPadding:$i=void 0}=c,{rPadding:Ui=void 0}=c,{xScale:_n=Cu.x}=c,{yScale:an=Cu.y}=c,{zScale:sn=Cu.z}=c,{rScale:gn=Cu.r}=c,{xRange:ni=void 0}=c,{yRange:Cr=void 0}=c,{zRange:L=void 0}=c,{rRange:N=void 0}=c,{padding:V={}}=c,{extents:X={}}=c,{flatData:$=void 0}=c,{custom:se={}}=c,pe=!1;Jm(()=>{pe=!0});const j={},J=zr(Zt);Xt(h,J,ye=>d(128,xr=ye));const _e=zr(Pr);Xt(h,_e,ye=>d(7,hr=ye));const Ce=zr(Dn);Xt(h,Ce,ye=>d(6,fr=ye));const Me=zr(zp(X));Xt(h,Me,ye=>d(127,Ve=ye));const W=zr(hi);Xt(h,W,ye=>d(126,cr=ye));const we=zr($||hi);Xt(h,we,ye=>d(125,Ut=ye));const $e=zr(V);Xt(h,$e,ye=>d(124,At=ye));const Xe=zr(ts(gi));Xt(h,Xe,ye=>d(123,pt=ye));const Se=zr(ts(ci));Xt(h,Se,ye=>d(122,qt=ye));const We=zr(ts(Ji));Xt(h,We,ye=>d(121,et=ye));const Oe=zr(ts(Ci));Xt(h,Oe,ye=>d(120,zt=ye));const je=zr(ei);Xt(h,je,ye=>d(119,yt=ye));const Mt=zr(on);Xt(h,Mt,ye=>d(118,Ft=ye));const qe=zr(pi);Xt(h,qe,ye=>d(117,ht=ye));const Vt=zr(Nr);Xt(h,Vt,ye=>d(116,_t=ye));const lr=zr(Yi);Xt(h,lr,ye=>d(115,jt=ye));const Pt=zr(Ln);Xt(h,Pt,ye=>d(114,Lt=ye));const er=zr(Oi);Xt(h,er,ye=>d(113,It=ye));const Ht=zr(In);Xt(h,Ht,ye=>d(112,Ye=ye));const ti=zr(Qi);Xt(h,ti,ye=>d(111,Le=ye));const Qt=zr(zn);Xt(h,Qt,ye=>d(110,Je=ye));const vr=zr(Fi);Xt(h,vr,ye=>d(109,ot=ye));const dr=zr(yn);Xt(h,dr,ye=>d(108,xe=ye));const Gt=zr(Ni);Xt(h,Gt,ye=>d(107,me=ye));const tr=zr(Rn);Xt(h,tr,ye=>d(106,ve=ye));const oi=zr($i);Xt(h,oi,ye=>d(105,he=ye));const Bn=zr(Ui);Xt(h,Bn,ye=>d(104,ne=ye));const wr=zr(ni);Xt(h,wr,ye=>d(103,H=ye));const Mi=zr(Cr);Xt(h,Mi,ye=>d(102,D=ye));const Vo=zr(L);Xt(h,Vo,ye=>d(101,R=ye));const vo=zr(N);Xt(h,vo,ye=>d(100,F=ye));const Zr=zr(_n);Xt(h,Zr,ye=>d(99,M=ye));const bo=zr(an);Xt(h,bo,ye=>d(98,T=ye));const ki=zr(sn);Xt(h,ki,ye=>d(97,z=ye));const ai=zr(gn);Xt(h,ai,ye=>d(96,o=ye));const ln=zr(j);Xt(h,ln,ye=>d(94,_=ye));const Lr=zr(se);Xt(h,Lr,ye=>d(95,v=ye));const On=Pi([Xe,Se,We,Oe],([ye,un,qi,Gr])=>{const So={};return ye&&(So.x=ye),un&&(So.y=un),qi&&(So.z=qi),Gr&&(So.r=Gr),So}),vn=Pi([$e,_e,Ce],([ye])=>Object.assign({top:0,right:0,bottom:0,left:0},ye)),is=Pi([_e,Ce,vn],([ye,un,qi])=>{const Gr={};return Gr.top=qi.top,Gr.right=ye-qi.right,Gr.bottom=un-qi.bottom,Gr.left=qi.left,Gr.width=Gr.right-Gr.left,Gr.height=Gr.bottom-Gr.top,Gr.width<=0&&pe===!0&&console.warn("[LayerCake] Target div has zero or negative width. Did you forget to set an explicit width in CSS on the container?"),Gr.height<=0&&pe===!0&&console.warn("[LayerCake] Target div has zero or negative height. Did you forget to set an explicit height in CSS on the container?"),Gr}),Si=Pi([is],([ye])=>ye.width);Xt(h,Si,ye=>d(8,Fr=ye));const xo=Pi([is],([ye])=>ye.height);Xt(h,xo,ye=>d(9,wi=ye));const Vi=Pi([we,On,Me],([ye,un,qi])=>{const Gr=zp(un,qi);return Object.keys(Gr).length>0?{...Zg(ye,Gr),...qi}:{}}),Ei=Pi([Vi,je],oh("x")),Jn=Pi([Vi,Mt],oh("y")),ji=Pi([Vi,qe],oh("z")),wo=Pi([Vi,Vt],oh("r")),ns=Pi([Zr,Vi,Ei,Gt,lr,ti,Si,xo,wr,J],ch("x")),Ll=Pi([Xe,ns],hh),ha=Pi([bo,Vi,Jn,tr,Pt,Qt,Si,xo,Mi,J],ch("y")),Rl=Pi([Se,ha],hh),Ba=Pi([ki,Vi,ji,oi,er,vr,Si,xo,Vo,J],ch("z")),Bl=Pi([We,Ba],hh),Oa=Pi([ai,Vi,wo,Bn,Ht,dr,Si,xo,vo,J],ch("r")),Bs=Pi([Oe,Oa],hh),jo=Pi([ns],ph),os=Pi([ha],ph),pa=Pi([Ba],ph),Os=Pi([Oa],ph),qo=Pi([Si,xo],([ye,un])=>ye/un);Xt(h,qo,ye=>d(10,sr=ye));function Fn(ye){Bu[ye?"unshift":"push"](()=>{Xr=ye,d(2,Xr)})}function ko(){Pr=this.clientWidth,Dn=this.clientHeight,d(0,Pr),d(1,Dn)}return h.$$set=ye=>{"ssr"in ye&&d(3,Ur=ye.ssr),"pointerEvents"in ye&&d(4,Tn=ye.pointerEvents),"position"in ye&&d(5,$r=ye.position),"percentRange"in ye&&d(51,Zt=ye.percentRange),"width"in ye&&d(52,$t=ye.width),"height"in ye&&d(53,Dr=ye.height),"containerWidth"in ye&&d(0,Pr=ye.containerWidth),"containerHeight"in ye&&d(1,Dn=ye.containerHeight),"element"in ye&&d(2,Xr=ye.element),"x"in ye&&d(54,gi=ye.x),"y"in ye&&d(55,ci=ye.y),"z"in ye&&d(56,Ji=ye.z),"r"in ye&&d(57,Ci=ye.r),"data"in ye&&d(58,hi=ye.data),"xDomain"in ye&&d(59,ei=ye.xDomain),"yDomain"in ye&&d(60,on=ye.yDomain),"zDomain"in ye&&d(61,pi=ye.zDomain),"rDomain"in ye&&d(62,Nr=ye.rDomain),"xNice"in ye&&d(63,Yi=ye.xNice),"yNice"in ye&&d(64,Ln=ye.yNice),"zNice"in ye&&d(65,Oi=ye.zNice),"rNice"in ye&&d(66,In=ye.rNice),"xReverse"in ye&&d(67,Qi=ye.xReverse),"yReverse"in ye&&d(68,zn=ye.yReverse),"zReverse"in ye&&d(69,Fi=ye.zReverse),"rReverse"in ye&&d(70,yn=ye.rReverse),"xPadding"in ye&&d(71,Ni=ye.xPadding),"yPadding"in ye&&d(72,Rn=ye.yPadding),"zPadding"in ye&&d(73,$i=ye.zPadding),"rPadding"in ye&&d(74,Ui=ye.rPadding),"xScale"in ye&&d(75,_n=ye.xScale),"yScale"in ye&&d(76,an=ye.yScale),"zScale"in ye&&d(77,sn=ye.zScale),"rScale"in ye&&d(78,gn=ye.rScale),"xRange"in ye&&d(79,ni=ye.xRange),"yRange"in ye&&d(80,Cr=ye.yRange),"zRange"in ye&&d(81,L=ye.zRange),"rRange"in ye&&d(82,N=ye.rRange),"padding"in ye&&d(83,V=ye.padding),"extents"in ye&&d(84,X=ye.extents),"flatData"in ye&&d(85,$=ye.flatData),"custom"in ye&&d(86,se=ye.custom),"$$scope"in ye&&d(89,kt=ye.$$scope)},h.$$.update=()=>{h.$$.dirty[1]&8388608&&gi&&d(87,j.x=gi,j),h.$$.dirty[1]&16777216&&ci&&d(87,j.y=ci,j),h.$$.dirty[1]&33554432&&Ji&&d(87,j.z=Ji,j),h.$$.dirty[1]&67108864&&Ci&&d(87,j.r=Ci,j),h.$$.dirty[1]&268435456&&ei&&d(87,j.xDomain=ei,j),h.$$.dirty[1]&536870912&&on&&d(87,j.yDomain=on,j),h.$$.dirty[1]&1073741824&&pi&&d(87,j.zDomain=pi,j),h.$$.dirty[2]&1&&Nr&&d(87,j.rDomain=Nr,j),h.$$.dirty[2]&131072&&ni&&d(87,j.xRange=ni,j),h.$$.dirty[2]&262144&&Cr&&d(87,j.yRange=Cr,j),h.$$.dirty[2]&524288&&L&&d(87,j.zRange=L,j),h.$$.dirty[2]&1048576&&N&&d(87,j.rRange=N,j),h.$$.dirty[1]&1048576&&Ir(J,xr=Zt,xr),h.$$.dirty[0]&1&&Ir(_e,hr=Pr,hr),h.$$.dirty[0]&2&&Ir(Ce,fr=Dn,fr),h.$$.dirty[2]&4194304&&Ir(Me,Ve=zp(X),Ve),h.$$.dirty[1]&134217728&&Ir(W,cr=hi,cr),h.$$.dirty[1]&134217728|h.$$.dirty[2]&8388608&&Ir(we,Ut=$||hi,Ut),h.$$.dirty[2]&2097152&&Ir($e,At=V,At),h.$$.dirty[1]&8388608&&Ir(Xe,pt=ts(gi),pt),h.$$.dirty[1]&16777216&&Ir(Se,qt=ts(ci),qt),h.$$.dirty[1]&33554432&&Ir(We,et=ts(Ji),et),h.$$.dirty[1]&67108864&&Ir(Oe,zt=ts(Ci),zt),h.$$.dirty[1]&268435456&&Ir(je,yt=ei,yt),h.$$.dirty[1]&536870912&&Ir(Mt,Ft=on,Ft),h.$$.dirty[1]&1073741824&&Ir(qe,ht=pi,ht),h.$$.dirty[2]&1&&Ir(Vt,_t=Nr,_t),h.$$.dirty[2]&2&&Ir(lr,jt=Yi,jt),h.$$.dirty[2]&4&&Ir(Pt,Lt=Ln,Lt),h.$$.dirty[2]&8&&Ir(er,It=Oi,It),h.$$.dirty[2]&16&&Ir(Ht,Ye=In,Ye),h.$$.dirty[2]&32&&Ir(ti,Le=Qi,Le),h.$$.dirty[2]&64&&Ir(Qt,Je=zn,Je),h.$$.dirty[2]&128&&Ir(vr,ot=Fi,ot),h.$$.dirty[2]&256&&Ir(dr,xe=yn,xe),h.$$.dirty[2]&512&&Ir(Gt,me=Ni,me),h.$$.dirty[2]&1024&&Ir(tr,ve=Rn,ve),h.$$.dirty[2]&2048&&Ir(oi,he=$i,he),h.$$.dirty[2]&4096&&Ir(Bn,ne=Ui,ne),h.$$.dirty[2]&131072&&Ir(wr,H=ni,H),h.$$.dirty[2]&262144&&Ir(Mi,D=Cr,D),h.$$.dirty[2]&524288&&Ir(Vo,R=L,R),h.$$.dirty[2]&1048576&&Ir(vo,F=N,F),h.$$.dirty[2]&8192&&Ir(Zr,M=_n,M),h.$$.dirty[2]&16384&&Ir(bo,T=an,T),h.$$.dirty[2]&32768&&Ir(ki,z=sn,z),h.$$.dirty[2]&65536&&Ir(ai,o=gn,o),h.$$.dirty[2]&16777216&&Ir(Lr,v=se,v),h.$$.dirty[2]&33554432&&Ir(ln,_=j,_),h.$$.dirty[2]&67108864&&Hm("LayerCake",f)},d(88,f={activeGetters:On,width:Si,height:xo,percentRange:J,aspectRatio:qo,containerWidth:_e,containerHeight:Ce,x:Xe,y:Se,z:We,r:Oe,custom:Lr,data:W,xNice:lr,yNice:Pt,zNice:er,rNice:Ht,xReverse:ti,yReverse:Qt,zReverse:vr,rReverse:dr,xPadding:Gt,yPadding:tr,zPadding:oi,rPadding:Bn,padding:vn,flatData:we,extents:Vi,xDomain:Ei,yDomain:Jn,zDomain:ji,rDomain:wo,xRange:jo,yRange:os,zRange:pa,rRange:Os,config:ln,xScale:ns,xGet:Ll,yScale:ha,yGet:Rl,zScale:Ba,zGet:Bl,rScale:Oa,rGet:Bs}),[Pr,Dn,Xr,Ur,Tn,$r,fr,hr,Fr,wi,sr,J,_e,Ce,Me,W,we,$e,Xe,Se,We,Oe,je,Mt,qe,Vt,lr,Pt,er,Ht,ti,Qt,vr,dr,Gt,tr,oi,Bn,wr,Mi,Vo,vo,Zr,bo,ki,ai,ln,Lr,Si,xo,qo,Zt,$t,Dr,gi,ci,Ji,Ci,hi,ei,on,pi,Nr,Yi,Ln,Oi,In,Qi,zn,Fi,yn,Ni,Rn,$i,Ui,_n,an,sn,gn,ni,Cr,L,N,V,X,$,se,j,f,kt,Qr,Fn,ko]}class s0 extends fn{constructor(c){super(),dn(this,c,a0,o0,mn,{ssr:3,pointerEvents:4,position:5,percentRange:51,width:52,height:53,containerWidth:0,containerHeight:1,element:2,x:54,y:55,z:56,r:57,data:58,xDomain:59,yDomain:60,zDomain:61,rDomain:62,xNice:63,yNice:64,zNice:65,rNice:66,xReverse:67,yReverse:68,zReverse:69,rReverse:70,xPadding:71,yPadding:72,zPadding:73,rPadding:74,xScale:75,yScale:76,zScale:77,rScale:78,xRange:79,yRange:80,zRange:81,rRange:82,padding:83,extents:84,flatData:85,custom:86},null,[-1,-1,-1,-1,-1])}}const l0=h=>({element:h&1}),Kd=h=>({element:h[0]}),u0=h=>({element:h&1}),Xd=h=>({element:h[0]});function c0(h){let c,d,f,_,v;const o=h[12].defs,z=Mu(o,h,h[11],Xd),T=h[12].default,M=Mu(T,h,h[11],Kd);return{c(){c=Wn("svg"),d=Wn("defs"),z&&z.c(),f=Wn("g"),M&&M.c(),this.h()},l(F){c=Hn(F,"svg",{class:!0,viewBox:!0,width:!0,height:!0});var R=Be(c);d=Hn(R,"defs",{});var D=Be(d);z&&z.l(D),D.forEach(ae),f=Hn(R,"g",{class:!0,transform:!0});var H=Be(f);M&&M.l(H),H.forEach(ae),R.forEach(ae),this.h()},h(){oe(f,"class","layercake-layout-svg_g"),oe(f,"transform",_="translate("+h[7].left+", "+h[7].top+")"),oe(c,"class","layercake-layout-svg svelte-u84d8d"),oe(c,"viewBox",h[4]),oe(c,"width",h[5]),oe(c,"height",h[6]),Ge(c,"z-index",h[2]),Ge(c,"pointer-events",h[3]===!1?"none":null)},m(F,R){Re(F,c,R),Te(c,d),z&&z.m(d,null),Te(c,f),M&&M.m(f,null),h[13](f),h[14](c),v=!0},p(F,[R]){z&&z.p&&(!v||R&2049)&&Du(z,o,F,F[11],v?Ru(o,F[11],R,u0):Lu(F[11]),Xd),M&&M.p&&(!v||R&2049)&&Du(M,T,F,F[11],v?Ru(T,F[11],R,l0):Lu(F[11]),Kd),(!v||R&128&&_!==(_="translate("+F[7].left+", "+F[7].top+")"))&&oe(f,"transform",_),(!v||R&16)&&oe(c,"viewBox",F[4]),(!v||R&32)&&oe(c,"width",F[5]),(!v||R&64)&&oe(c,"height",F[6]),R&4&&Ge(c,"z-index",F[2]),R&8&&Ge(c,"pointer-events",F[3]===!1?"none":null)},i(F){v||(rt(z,F),rt(M,F),v=!0)},o(F){lt(z,F),lt(M,F),v=!1},d(F){F&&ae(c),z&&z.d(F),M&&M.d(F),h[13](null),h[14](null)}}}function h0(h,c,d){let f,_,v,{$$slots:o={},$$scope:z}=c,{element:T=void 0}=c,{innerElement:M=void 0}=c,{zIndex:F=void 0}=c,{pointerEvents:R=void 0}=c,{viewBox:D=void 0}=c;const{containerWidth:H,containerHeight:ne,padding:he}=ju("LayerCake");Xt(h,H,xe=>d(5,f=xe)),Xt(h,ne,xe=>d(6,_=xe)),Xt(h,he,xe=>d(7,v=xe));function ve(xe){Bu[xe?"unshift":"push"](()=>{M=xe,d(1,M)})}function me(xe){Bu[xe?"unshift":"push"](()=>{T=xe,d(0,T)})}return h.$$set=xe=>{"element"in xe&&d(0,T=xe.element),"innerElement"in xe&&d(1,M=xe.innerElement),"zIndex"in xe&&d(2,F=xe.zIndex),"pointerEvents"in xe&&d(3,R=xe.pointerEvents),"viewBox"in xe&&d(4,D=xe.viewBox),"$$scope"in xe&&d(11,z=xe.$$scope)},[T,M,F,R,D,f,_,v,H,ne,he,z,o,ve,me]}class p0 extends fn{constructor(c){super(),dn(this,c,h0,c0,mn,{element:0,innerElement:1,zIndex:2,pointerEvents:3,viewBox:4})}}function Wd(h,c,d){const f=h.slice();return f[23]=c[d],f[25]=d,f}function Hd(h){let c,d,f,_;return{c(){c=Wn("rect"),this.h()},l(v){c=Hn(v,"rect",{class:!0,"data-id":!0,x:!0,y:!0,width:!0,height:!0,fill:!0,stroke:!0,"stroke-width":!0}),Be(c).forEach(ae),this.h()},h(){oe(c,"class","group-rect"),oe(c,"data-id",h[25]),oe(c,"x",d=h[11].bandwidth?h[7](h[23]):h[7](h[23])[0]),oe(c,"y",f=h[13](h[12](h[23]))-1),oe(c,"width",_=h[11].bandwidth?h[11].bandwidth():h[9](h[23])),oe(c,"height","3"),oe(c,"fill","#308182"),oe(c,"stroke",h[0]),oe(c,"stroke-width",h[1])},m(v,o){Re(v,c,o)},p(v,o){o&3200&&d!==(d=v[11].bandwidth?v[7](v[23]):v[7](v[23])[0])&&oe(c,"x",d),o&13312&&f!==(f=v[13](v[12](v[23]))-1)&&oe(c,"y",f),o&3584&&_!==(_=v[11].bandwidth?v[11].bandwidth():v[9](v[23]))&&oe(c,"width",_),o&1&&oe(c,"stroke",v[0]),o&2&&oe(c,"stroke-width",v[1])},d(v){v&&ae(c)}}}function Jd(h){let c,d,f,_,v,o,z,T,M=h[12]&&Hd(h);return{c(){c=Wn("rect"),M&&M.c(),o=Wn("text"),this.h()},l(F){c=Hn(F,"rect",{class:!0,"data-id":!0,x:!0,y:!0,width:!0,height:!0,fill:!0,stroke:!0,"stroke-width":!0}),Be(c).forEach(ae),M&&M.l(F),o=Hn(F,"text",{x:!0,y:!0,dx:!0,dy:!0,"text-anchor":!0}),Be(o).forEach(ae),this.h()},h(){oe(c,"class","group-rect"),oe(c,"data-id",h[25]),oe(c,"x",d=h[11].bandwidth?h[7](h[23]):h[7](h[23])[0]),oe(c,"y",f=h[6](h[23])),oe(c,"width",_=h[11].bandwidth?h[11].bandwidth():h[9](h[23])),oe(c,"height",v=h[8](h[23])),oe(c,"fill",h[4]),oe(c,"stroke",h[0]),oe(c,"stroke-width",h[1]),oe(o,"x",z=h[11].bandwidth?h[7](h[23])+h[11].bandwidth()/2:h[7](h[23])[0]),oe(o,"y",T=h[6](h[23])-4),oe(o,"dx",h[2]),oe(o,"dy",h[3]),oe(o,"text-anchor",h[5])},m(F,R){Re(F,c,R),M&&M.m(F,R),Re(F,o,R)},p(F,R){R&3200&&d!==(d=F[11].bandwidth?F[7](F[23]):F[7](F[23])[0])&&oe(c,"x",d),R&1088&&f!==(f=F[6](F[23]))&&oe(c,"y",f),R&3584&&_!==(_=F[11].bandwidth?F[11].bandwidth():F[9](F[23]))&&oe(c,"width",_),R&1280&&v!==(v=F[8](F[23]))&&oe(c,"height",v),R&16&&oe(c,"fill",F[4]),R&1&&oe(c,"stroke",F[0]),R&2&&oe(c,"stroke-width",F[1]),F[12]?M?M.p(F,R):(M=Hd(F),M.c(),M.m(o.parentNode,o)):M&&(M.d(1),M=null),R&3200&&z!==(z=F[11].bandwidth?F[7](F[23])+F[11].bandwidth()/2:F[7](F[23])[0])&&oe(o,"x",z),R&1088&&T!==(T=F[6](F[23])-4)&&oe(o,"y",T),R&4&&oe(o,"dx",F[2]),R&8&&oe(o,"dy",F[3]),R&32&&oe(o,"text-anchor",F[5])},d(F){F&&ae(c),M&&M.d(F),F&&ae(o)}}}function f0(h){let c,d=h[10],f=[];for(let _=0;_<d.length;_+=1)f[_]=Jd(Wd(h,d,_));return{c(){c=Wn("g");for(let _=0;_<f.length;_+=1)f[_].c();this.h()},l(_){c=Hn(_,"g",{class:!0});var v=Be(c);for(let o=0;o<f.length;o+=1)f[o].l(v);v.forEach(ae),this.h()},h(){oe(c,"class","column-group svelte-wgzwsk")},m(_,v){Re(_,c,v);for(let o=0;o<f.length;o+=1)f[o]&&f[o].m(c,null)},p(_,[v]){if(v&16383){d=_[10];let o;for(o=0;o<d.length;o+=1){const z=Wd(_,d,o);f[o]?f[o].p(z,v):(f[o]=Jd(z),f[o].c(),f[o].m(c,null))}for(;o<f.length;o+=1)f[o].d(1);f.length=d.length}},i:_i,o:_i,d(_){_&&ae(c),nn(f,_)}}}function d0(h,c,d){let f,_,v,o,z,T,M,F,R;const{data:D,xGet:H,yGet:ne,yRange:he,xScale:ve,yScale:me,y:xe,z:ot}=ju("LayerCake");Xt(h,D,_t=>d(10,T=_t)),Xt(h,H,_t=>d(7,z=_t)),Xt(h,ne,_t=>d(6,v=_t)),Xt(h,he,_t=>d(21,o=_t)),Xt(h,ve,_t=>d(11,M=_t)),Xt(h,me,_t=>d(13,R=_t)),Xt(h,ot,_t=>d(12,F=_t));let{stroke:Je=""}=c,{strokeWidth:Le=0}=c,{dxTick:Ye=0}=c,{dyTick:It=0}=c,{fill:Lt="#00205b"}=c,{textAnchor:jt="middle"}=c;return h.$$set=_t=>{"stroke"in _t&&d(0,Je=_t.stroke),"strokeWidth"in _t&&d(1,Le=_t.strokeWidth),"dxTick"in _t&&d(2,Ye=_t.dxTick),"dyTick"in _t&&d(3,It=_t.dyTick),"fill"in _t&&d(4,Lt=_t.fill),"textAnchor"in _t&&d(5,jt=_t.textAnchor)},h.$$.update=()=>{h.$$.dirty&128&&d(9,f=_t=>{const ht=z(_t);return Math.max(0,ht[1]-ht[0])}),h.$$.dirty&2097216&&d(8,_=_t=>o[0]-v(_t))},[Je,Le,Ye,It,Lt,jt,v,z,_,f,T,M,F,R,D,H,ne,he,ve,me,ot,o]}class m0 extends fn{constructor(c){super(),dn(this,c,d0,f0,mn,{stroke:0,strokeWidth:1,dxTick:2,dyTick:3,fill:4,textAnchor:5})}}function Yd(h,c,d){const f=h.slice();return f[28]=c[d],f[30]=d,f}function Qd(h){let c,d,f,_;return{c(){c=Wn("line"),this.h()},l(v){c=Hn(v,"line",{y1:!0,y2:!0,x1:!0,x2:!0,stroke:!0,"stroke-width":!0,class:!0}),Be(c).forEach(ae),this.h()},h(){oe(c,"y1",d=h[20]*-1),oe(c,"y2",f=h[14]&&h[30]%2==0?h[10]+h[8]+2:h[10]+h[8]-13),oe(c,"x1","0"),oe(c,"x2","0"),oe(c,"stroke",h[11]),oe(c,"stroke-width",_=h[15]&&Array.isArray(h[4])&&h[30]==Math.floor(h[4].length/2)?2:1),oe(c,"class","svelte-fwjh80"),Xn(c,"baseline",h[13])},m(v,o){Re(v,c,o)},p(v,o){o&1048576&&d!==(d=v[20]*-1)&&oe(c,"y1",d),o&17664&&f!==(f=v[14]&&v[30]%2==0?v[10]+v[8]+2:v[10]+v[8]-13)&&oe(c,"y2",f),o&2048&&oe(c,"stroke",v[11]),o&32784&&_!==(_=v[15]&&Array.isArray(v[4])&&v[30]==Math.floor(v[4].length/2)?2:1)&&oe(c,"stroke-width",_),o&8192&&Xn(c,"baseline",v[13])},d(v){v&&ae(c)}}}function y0(h){let c=h[1](h[28])+"",d;return{c(){d=Et(c)},l(f){d=Tt(f,c)},m(f,_){Re(f,d,_)},p(f,_){_&262146&&c!==(c=f[1](f[28])+"")&&Tr(d,c)},d(f){f&&ae(d)}}}function _0(h){let c,d=h[1](h[28])+"",f,_;return{c(){c=Et(h[5]),f=Et(d),_=Et(h[6])},l(v){c=Tt(v,h[5]),f=Tt(v,d),_=Tt(v,h[6])},m(v,o){Re(v,c,o),Re(v,f,o),Re(v,_,o)},p(v,o){o&32&&Tr(c,v[5]),o&262146&&d!==(d=v[1](v[28])+"")&&Tr(f,d),o&64&&Tr(_,v[6])},d(v){v&&ae(c),v&&ae(f),v&&ae(_)}}}function $d(h){let c,d,f,_,v,o,z,T=h[0]!==!1&&Qd(h);function M(D,H){return D[30]==D[18].length-1?_0:y0}let F=M(h),R=F(h);return{c(){c=Wn("g"),T&&T.c(),d=Wn("text"),R.c(),this.h()},l(D){c=Hn(D,"g",{class:!0,transform:!0});var H=Be(c);T&&T.l(H),d=Hn(H,"text",{x:!0,y:!0,dx:!0,dy:!0,"text-anchor":!0,fill:!0,class:!0});var ne=Be(d);R.l(ne),ne.forEach(ae),H.forEach(ae),this.h()},h(){oe(d,"x",f=h[7]||h[16]?h[17].bandwidth()/2:0),oe(d,"y",_=h[3]?h[20]*-1-6:h[14]&&h[30]%2==0?h[8]+15:h[8]),oe(d,"dx",v=h[24](h[30])=="start"?h[9]-2:h[24](h[30])=="end"?h[9]+2:h[9]),oe(d,"dy",h[10]),oe(d,"text-anchor",h[24](h[30])),oe(d,"fill",h[12]),oe(d,"class","svelte-fwjh80"),Xn(d,"bold",h[15]&&Array.isArray(h[4])&&h[30]==Math.floor(h[4].length/2)),oe(c,"class",o="tick tick-"+h[28]+" svelte-fwjh80"),oe(c,"transform",z="translate("+h[17](h[28])+","+h[19][0]+")")},m(D,H){Re(D,c,H),T&&T.m(c,null),Te(c,d),R.m(d,null)},p(D,H){D[0]!==!1?T?T.p(D,H):(T=Qd(D),T.c(),T.m(c,d)):T&&(T.d(1),T=null),F===(F=M(D))&&R?R.p(D,H):(R.d(1),R=F(D),R&&(R.c(),R.m(d,null))),H&196736&&f!==(f=D[7]||D[16]?D[17].bandwidth()/2:0)&&oe(d,"x",f),H&1065224&&_!==(_=D[3]?D[20]*-1-6:D[14]&&D[30]%2==0?D[8]+15:D[8])&&oe(d,"y",_),H&512&&v!==(v=D[24](D[30])=="start"?D[9]-2:D[24](D[30])=="end"?D[9]+2:D[9])&&oe(d,"dx",v),H&1024&&oe(d,"dy",D[10]),H&4096&&oe(d,"fill",D[12]),H&32784&&Xn(d,"bold",D[15]&&Array.isArray(D[4])&&D[30]==Math.floor(D[4].length/2)),H&262144&&o!==(o="tick tick-"+D[28]+" svelte-fwjh80")&&oe(c,"class",o),H&917504&&z!==(z="translate("+D[17](D[28])+","+D[19][0]+")")&&oe(c,"transform",z)},d(D){D&&ae(c),T&&T.d(),R.d()}}}function em(h){let c,d,f;return{c(){c=Wn("line"),this.h()},l(_){c=Hn(_,"line",{class:!0,y1:!0,y2:!0,x1:!0,x2:!0,stroke:!0}),Be(c).forEach(ae),this.h()},h(){oe(c,"class","baseline svelte-fwjh80"),oe(c,"y1",h[20]),oe(c,"y2","0"),oe(c,"x1",d=h[17](0)),oe(c,"x2",f=h[17](0)),oe(c,"stroke",h[11])},m(_,v){Re(_,c,v)},p(_,v){v&1048576&&oe(c,"y1",_[20]),v&131072&&d!==(d=_[17](0))&&oe(c,"x1",d),v&131072&&f!==(f=_[17](0))&&oe(c,"x2",f),v&2048&&oe(c,"stroke",_[11])},d(_){_&&ae(c)}}}function g0(h){let c,d,f=h[18],_=[];for(let o=0;o<f.length;o+=1)_[o]=$d(Yd(h,f,o));let v=h[2]===!0&&em(h);return{c(){c=Wn("g");for(let o=0;o<_.length;o+=1)_[o].c();d=br(),v&&v.c(),this.h()},l(o){c=Hn(o,"g",{class:!0});var z=Be(c);for(let T=0;T<_.length;T+=1)_[T].l(z);d=br(),v&&v.l(z),z.forEach(ae),this.h()},h(){oe(c,"class","axis x-axis")},m(o,z){Re(o,c,z);for(let T=0;T<_.length;T+=1)_[T]&&_[T].m(c,null);Te(c,d),v&&v.m(c,null)},p(o,[z]){if(z&18874363){f=o[18];let T;for(T=0;T<f.length;T+=1){const M=Yd(o,f,T);_[T]?_[T].p(M,z):(_[T]=$d(M),_[T].c(),_[T].m(c,d))}for(;T<_.length;T+=1)_[T].d(1);_.length=f.length}o[2]===!0?v?v.p(o,z):(v=em(o),v.c(),v.m(c,null)):v&&(v.d(1),v=null)},i:_i,o:_i,d(o){o&&ae(c),nn(_,o),v&&v.d()}}}function v0(h,c,d){let f,_,v,o,z;const{width:T,height:M,xScale:F,yScale:R,yRange:D}=ju("LayerCake");Xt(h,M,et=>d(20,z=et)),Xt(h,F,et=>d(17,v=et)),Xt(h,D,et=>d(19,o=et));let{gridlines:H=!0}=c,{formatTick:ne=et=>et}=c,{baseline:he=!1}=c,{flipped:ve=!1}=c,{snapTicks:me=!1}=c,{ticks:xe=void 0}=c,{prefix:ot=""}=c,{suffix:Je=""}=c,{xTick:Le=void 0}=c,{yTick:Ye=15}=c,{dxTick:It=0}=c,{dyTick:Lt=0}=c,{lineColor:jt="#999"}=c,{textColor:_t="#555"}=c,{solid:ht=!1}=c,{stagger:Ft=!1}=c,{median:yt=!0}=c;function zt(et){if(me===!0){if(et===0)return"start";if(et===_.length-1)return"end"}return"middle"}return h.$$set=et=>{"gridlines"in et&&d(0,H=et.gridlines),"formatTick"in et&&d(1,ne=et.formatTick),"baseline"in et&&d(2,he=et.baseline),"flipped"in et&&d(3,ve=et.flipped),"snapTicks"in et&&d(25,me=et.snapTicks),"ticks"in et&&d(4,xe=et.ticks),"prefix"in et&&d(5,ot=et.prefix),"suffix"in et&&d(6,Je=et.suffix),"xTick"in et&&d(7,Le=et.xTick),"yTick"in et&&d(8,Ye=et.yTick),"dxTick"in et&&d(9,It=et.dxTick),"dyTick"in et&&d(10,Lt=et.dyTick),"lineColor"in et&&d(11,jt=et.lineColor),"textColor"in et&&d(12,_t=et.textColor),"solid"in et&&d(13,ht=et.solid),"stagger"in et&&d(14,Ft=et.stagger),"median"in et&&d(15,yt=et.median)},h.$$.update=()=>{h.$$.dirty&131072&&d(16,f=typeof v.bandwidth=="function"),h.$$.dirty&196624&&d(18,_=Array.isArray(xe)?xe:f?v.domain():v.ticks(xe))},[H,ne,he,ve,xe,ot,Je,Le,Ye,It,Lt,jt,_t,ht,Ft,yt,f,v,_,o,z,M,F,D,zt,me]}class b0 extends fn{constructor(c){super(),dn(this,c,v0,g0,mn,{gridlines:0,formatTick:1,baseline:2,flipped:3,snapTicks:25,ticks:4,prefix:5,suffix:6,xTick:7,yTick:8,dxTick:9,dyTick:10,lineColor:11,textColor:12,solid:13,stagger:14,median:15})}}function x0(h){let c,d,f,_;return c=new m0({props:{fill:h[1],formatVal:h[5]}}),f=new b0({props:{gridlines:!1}}),{c(){ir(c.$$.fragment),d=dt(),ir(f.$$.fragment)},l(v){nr(c.$$.fragment,v),d=mt(v),nr(f.$$.fragment,v)},m(v,o){or(c,v,o),Re(v,d,o),or(f,v,o),_=!0},p(v,o){const z={};o&2&&(z.fill=v[1]),o&32&&(z.formatVal=v[5]),c.$set(z)},i(v){_||(rt(c.$$.fragment,v),rt(f.$$.fragment,v),_=!0)},o(v){lt(c.$$.fragment,v),lt(f.$$.fragment,v),_=!1},d(v){ar(c,v),v&&ae(d),ar(f,v)}}}function w0(h){let c,d;return c=new p0({props:{$$slots:{default:[x0]},$$scope:{ctx:h}}}),{c(){ir(c.$$.fragment)},l(f){nr(c.$$.fragment,f)},m(f,_){or(c,f,_),d=!0},p(f,_){const v={};_&1058&&(v.$$scope={dirty:_,ctx:f}),c.$set(v)},i(f){d||(rt(c.$$.fragment,f),d=!0)},o(f){lt(c.$$.fragment,f),d=!1},d(f){ar(c,f)}}}function k0(h){let c,d,f;return d=new s0({props:{padding:{top:15,right:0,bottom:20,left:0},x:h[2],y:h[3],z:h[4],xScale:ay().paddingInner([.02]).round(!0),xDomain:h[7],yDomain:h[6],zDomain:h[6],data:h[0],$$slots:{default:[w0]},$$scope:{ctx:h}}}),{c(){c=Fe("div"),ir(d.$$.fragment),this.h()},l(_){c=Ne(_,"DIV",{class:!0});var v=Be(c);nr(d.$$.fragment,v),v.forEach(ae),this.h()},h(){oe(c,"class","chart-container svelte-1i1qsul")},m(_,v){Re(_,c,v),or(d,c,null),f=!0},p(_,[v]){const o={};v&4&&(o.x=_[2]),v&8&&(o.y=_[3]),v&16&&(o.z=_[4]),v&128&&(o.xDomain=_[7]),v&64&&(o.yDomain=_[6]),v&64&&(o.zDomain=_[6]),v&1&&(o.data=_[0]),v&1058&&(o.$$scope={dirty:v,ctx:_}),d.$set(o)},i(_){f||(rt(d.$$.fragment,_),f=!0)},o(_){lt(d.$$.fragment,_),f=!1},d(_){_&&ae(c),ar(d)}}}function S0(h,c,d){let f,_,v,{data:o}=c,{suffix:z="%"}=c,{decimals:T=null}=c,{fill:M="#00205B"}=c,{xKey:F="x"}=c,{yKey:R="y"}=c,{zKey:D=null}=c;return h.$$set=H=>{"data"in H&&d(0,o=H.data),"suffix"in H&&d(8,z=H.suffix),"decimals"in H&&d(9,T=H.decimals),"fill"in H&&d(1,M=H.fill),"xKey"in H&&d(2,F=H.xKey),"yKey"in H&&d(3,R=H.yKey),"zKey"in H&&d(4,D=H.zKey)},h.$$.update=()=>{h.$$.dirty&5&&d(7,f=o.map(H=>H[F])),h.$$.dirty&9&&d(6,_=[0,Math.max(...o.map(H=>H[R]))]),h.$$.dirty&768&&d(5,v=H=>H.toFixed(T)+z)},[o,M,F,R,D,v,_,f,z,T]}class Mh extends fn{constructor(c){super(),dn(this,c,S0,k0,mn,{data:0,suffix:8,decimals:9,fill:1,xKey:2,yKey:3,zKey:4})}}function tm(h,c,d){const f=h.slice();return f[6]=c[d],f[8]=d,f}function rm(h){let c,d=h[0],f=[];for(let _=0;_<d.length;_+=1)f[_]=im(tm(h,d,_));return{c(){c=Wn("svg");for(let _=0;_<f.length;_+=1)f[_].c();this.h()},l(_){c=Hn(_,"svg",{class:!0});var v=Be(c);for(let o=0;o<f.length;o+=1)f[o].l(v);v.forEach(ae),this.h()},h(){oe(c,"class","stack svelte-pzvhwz")},m(_,v){Re(_,c,v);for(let o=0;o<f.length;o+=1)f[o]&&f[o].m(c,null)},p(_,v){if(v&31){d=_[0];let o;for(o=0;o<d.length;o+=1){const z=tm(_,d,o);f[o]?f[o].p(z,v):(f[o]=im(z),f[o].c(),f[o].m(c,null))}for(;o<f.length;o+=1)f[o].d(1);f.length=d.length}},d(_){_&&ae(c),nn(f,_)}}}function im(h){let c,d;return{c(){c=Wn("rect"),this.h()},l(f){c=Hn(f,"rect",{class:!0,x:!0,style:!0}),Be(c).forEach(ae),this.h()},h(){oe(c,"class","cell svelte-pzvhwz"),oe(c,"x",d=h[4][h[8]]/h[3]*100+"%"),Ge(c,"width",h[6][h[1]]/h[3]*100+"%"),Ge(c,"fill",h[2][h[8]])},m(f,_){Re(f,c,_)},p(f,_){_&24&&d!==(d=f[4][f[8]]/f[3]*100+"%")&&oe(c,"x",d),_&11&&Ge(c,"width",f[6][f[1]]/f[3]*100+"%"),_&4&&Ge(c,"fill",f[2][f[8]])},d(f){f&&ae(c)}}}function E0(h){let c,d=h[3]&&h[4]&&rm(h);return{c(){d&&d.c(),c=br()},l(f){d&&d.l(f),c=br()},m(f,_){d&&d.m(f,_),Re(f,c,_)},p(f,[_]){f[3]&&f[4]?d?d.p(f,_):(d=rm(f),d.c(),d.m(c.parentNode,c)):d&&(d.d(1),d=null)},i:_i,o:_i,d(f){d&&d.d(f),f&&ae(c)}}}function T0(h,c,d){let{data:f}=c,{yKey:_="y"}=c,{colors:v=["#00205B","#308182","#002417","#BD00BD","lightgrey"]}=c,o,z;function T(){d(3,o=f.map(F=>F[_]).reduce((F,R)=>F+R,0));let M=[0];f.forEach(F=>M.push(M[M.length-1]+F[_])),d(4,z=M)}return h.$$set=M=>{"data"in M&&d(0,f=M.data),"yKey"in M&&d(1,_=M.yKey),"colors"in M&&d(2,v=M.colors)},h.$$.update=()=>{h.$$.dirty&3&&(f||_)&&T()},[f,_,v,o,z]}class Xp extends fn{constructor(c){super(),dn(this,c,T0,E0,mn,{data:0,yKey:1,colors:2})}}function nm(h,c,d){const f=h.slice();return f[10]=c[d],f[12]=d,f}function I0(h){let c,d,f=h[6](h[10][h[3]])+"",_,v;return{c(){c=Fe("span"),d=Et("(NI "),_=Et(f),v=Et(")"),this.h()},l(o){c=Ne(o,"SPAN",{class:!0,style:!0});var z=Be(c);d=Tt(z,"(NI "),_=Tt(z,f),v=Tt(z,")"),z.forEach(ae),this.h()},h(){oe(c,"class",""),Ge(c,"color","#1460aa")},m(o,z){Re(o,c,z),Te(c,d),Te(c,_),Te(c,v)},p(o,z){z&9&&f!==(f=o[6](o[10][o[3]])+"")&&Tr(_,f)},d(o){o&&ae(c)}}}function z0(h){let c;return{c(){c=Fe("span"),this.h()},l(d){c=Ne(d,"SPAN",{class:!0,style:!0}),Be(c).forEach(ae),this.h()},h(){oe(c,"class",""),Ge(c,"color","#1460aa")},m(d,f){Re(d,c,f)},p:_i,d(d){d&&ae(c)}}}function A0(h){let c,d,f=md(Math.round(h[10][h[3]]),"%)")+"",_;return{c(){c=Fe("span"),d=Et("(2011 "),_=Et(f),this.h()},l(v){c=Ne(v,"SPAN",{class:!0,style:!0});var o=Be(c);d=Tt(o,"(2011 "),_=Tt(o,f),o.forEach(ae),this.h()},h(){oe(c,"class",""),Ge(c,"color","#1460aa")},m(v,o){Re(v,c,o),Te(c,d),Te(c,_)},p(v,o){o&9&&f!==(f=md(Math.round(v[10][v[3]]),"%)")+"")&&Tr(_,f)},d(v){v&&ae(c)}}}function om(h){let c,d,f,_,v,o=h[10][h[1]]+"",z,T,M,F=h[6](h[10][h[2]])+"",R,D,H;function ne(me,xe){if(me[3]=="prev"&&me[4])return A0;if(me[3]=="prev"&&!me[4])return z0;if(me[3])return I0}let he=ne(h),ve=he&&he(h);return{c(){c=Fe("tr"),d=Fe("td"),f=Wn("svg"),_=Wn("rect"),v=dt(),z=Et(o),T=dt(),M=Fe("td"),R=Et(F),D=dt(),ve&&ve.c(),H=dt(),this.h()},l(me){c=Ne(me,"TR",{});var xe=Be(c);d=Ne(xe,"TD",{class:!0});var ot=Be(d);f=Hn(ot,"svg",{width:!0,height:!0,class:!0});var Je=Be(f);_=Hn(Je,"rect",{width:!0,height:!0,style:!0}),Be(_).forEach(ae),Je.forEach(ae),v=mt(ot),z=Tt(ot,o),ot.forEach(ae),T=mt(xe),M=Ne(xe,"TD",{class:!0,style:!0});var Le=Be(M);R=Tt(Le,F),D=mt(Le),ve&&ve.l(Le),Le.forEach(ae),H=mt(xe),xe.forEach(ae),this.h()},h(){oe(_,"width","20"),oe(_,"height","30"),Ge(_,"fill",h[5][h[12]]),oe(f,"width","20"),oe(f,"height","30"),oe(f,"class","bullet svelte-1gvovsq"),oe(d,"class","svelte-1gvovsq"),oe(M,"class","cell-right svelte-1gvovsq"),Ge(M,"vertical-align","top")},m(me,xe){Re(me,c,xe),Te(c,d),Te(d,f),Te(f,_),Te(d,v),Te(d,z),Te(c,T),Te(c,M),Te(M,R),Te(M,D),ve&&ve.m(M,null),Te(c,H)},p(me,xe){xe&32&&Ge(_,"fill",me[5][me[12]]),xe&3&&o!==(o=me[10][me[1]]+"")&&Tr(z,o),xe&5&&F!==(F=me[6](me[10][me[2]])+"")&&Tr(R,F),he===(he=ne(me))&&ve?ve.p(me,xe):(ve&&ve.d(1),ve=he&&he(me),ve&&(ve.c(),ve.m(M,null)))},d(me){me&&ae(c),ve&&ve.d()}}}function P0(h){let c,d,f=h[0],_=[];for(let v=0;v<f.length;v+=1)_[v]=om(nm(h,f,v));return{c(){c=Fe("table"),d=Fe("tbody");for(let v=0;v<_.length;v+=1)_[v].c();this.h()},l(v){c=Ne(v,"TABLE",{class:!0});var o=Be(c);d=Ne(o,"TBODY",{});var z=Be(d);for(let T=0;T<_.length;T+=1)_[T].l(z);z.forEach(ae),o.forEach(ae),this.h()},h(){oe(c,"class","legend svelte-1gvovsq")},m(v,o){Re(v,c,o),Te(c,d);for(let z=0;z<_.length;z+=1)_[z]&&_[z].m(d,null)},p(v,[o]){if(o&127){f=v[0];let z;for(z=0;z<f.length;z+=1){const T=nm(v,f,z);_[z]?_[z].p(T,o):(_[z]=om(T),_[z].c(),_[z].m(d,null))}for(;z<_.length;z+=1)_[z].d(1);_.length=f.length}},i:_i,o:_i,d(v){v&&ae(c),nn(_,v)}}}function C0(h,c,d){let f,{data:_}=c,{xKey:v="x"}=c,{yKey:o="y"}=c,{zKey:z="ni"}=c,{topic_prev_available:T=!0}=c,{colors:M=["#3878c5","#00205B","#308182","#002417","#BD00BD","lightgrey"]}=c,{decimals:F=null}=c;function R(D){let H;return F?H=(D/f*100).toFixed(F)+"%":D/f*100<1?H="<1%":H=(D/f*100).toFixed(0)+"%",H}return h.$$set=D=>{"data"in D&&d(0,_=D.data),"xKey"in D&&d(1,v=D.xKey),"yKey"in D&&d(2,o=D.yKey),"zKey"in D&&d(3,z=D.zKey),"topic_prev_available"in D&&d(4,T=D.topic_prev_available),"colors"in D&&d(5,M=D.colors),"decimals"in D&&d(7,F=D.decimals)},h.$$.update=()=>{h.$$.dirty&5&&(f=_.map(D=>D[o]).reduce((D,H)=>D+H,0)),h.$$.dirty&9&&_.map(D=>D[z]).reduce((D,H)=>D+H,0)},[_,v,o,z,T,M,R,F]}class M0 extends fn{constructor(c){super(),dn(this,c,C0,P0,mn,{data:0,xKey:1,yKey:2,zKey:3,topic_prev_available:4,colors:5,decimals:7})}}function am(h){let c,d,f,_;d=new Xp({props:{data:h[0],yKey:h[4],colors:h[6]}});let v=h[8]&&sm(h);return{c(){c=Fe("div"),ir(d.$$.fragment),f=dt(),v&&v.c(),this.h()},l(o){c=Ne(o,"DIV",{class:!0,style:!0});var z=Be(c);nr(d.$$.fragment,z),f=mt(z),v&&v.l(z),z.forEach(ae),this.h()},h(){oe(c,"class","chart svelte-1tebgpk"),Ge(c,"height",h[1]*.28+"px")},m(o,z){Re(o,c,z),or(d,c,null),Te(c,f),v&&v.m(c,null),_=!0},p(o,z){const T={};z&1&&(T.data=o[0]),z&16&&(T.yKey=o[4]),z&64&&(T.colors=o[6]),d.$set(T),o[8]?v?v.p(o,z):(v=sm(o),v.c(),v.m(c,null)):v&&(v.d(1),v=null),(!_||z&2)&&Ge(c,"height",o[1]*.28+"px")},i(o){_||(rt(d.$$.fragment,o),_=!0)},o(o){lt(d.$$.fragment,o),_=!1},d(o){o&&ae(c),ar(d),v&&v.d()}}}function sm(h){let c,d;return{c(){c=Fe("div"),d=Et(h[8]),this.h()},l(f){c=Ne(f,"DIV",{class:!0});var _=Be(c);d=Tt(_,h[8]),_.forEach(ae),this.h()},h(){oe(c,"class","label svelte-1tebgpk")},m(f,_){Re(f,c,_),Te(c,d)},p(f,_){_&256&&Tr(d,f[8])},d(f){f&&ae(c)}}}function lm(h){let c,d,f,_,v,o;return d=new Xp({props:{data:h[0],yKey:h[4],colors:h[6]}}),{c(){c=Fe("div"),ir(d.$$.fragment),f=dt(),_=Fe("div"),v=Et("2011 comparison not available"),this.h()},l(z){c=Ne(z,"DIV",{class:!0,style:!0});var T=Be(c);nr(d.$$.fragment,T),f=mt(T),_=Ne(T,"DIV",{class:!0,style:!0});var M=Be(_);v=Tt(M,"2011 comparison not available"),M.forEach(ae),T.forEach(ae),this.h()},h(){oe(_,"class","label svelte-1tebgpk"),Ge(_,"background-color","#d8d8d8 "),Ge(_,"color","#000000"),oe(c,"class","chart svelte-1tebgpk"),Ge(c,"height",h[1]*.28+"px")},m(z,T){Re(z,c,T),or(d,c,null),Te(c,f),Te(c,_),Te(_,v),o=!0},p(z,T){const M={};T&1&&(M.data=z[0]),T&16&&(M.yKey=z[4]),T&64&&(M.colors=z[6]),d.$set(M),(!o||T&2)&&Ge(c,"height",z[1]*.28+"px")},i(z){o||(rt(d.$$.fragment,z),o=!0)},o(z){lt(d.$$.fragment,z),o=!1},d(z){z&&ae(c),ar(d)}}}function D0(h){let c,d,f,_,v,o,z,T;d=new Xp({props:{data:h[0],yKey:h[3],colors:h[6]}});let M=(h[4]&&h[5]||h[4]=="ni")&&am(h),F=h[4]=="prev"&&!h[5]&&lm(h);return z=new M0({props:{data:h[0],xKey:h[2],yKey:h[3],zKey:h[4],topic_prev_available:h[5],decimals:h[7],colors:h[6]}}),{c(){c=Fe("div"),ir(d.$$.fragment),f=dt(),M&&M.c(),_=dt(),F&&F.c(),v=dt(),o=Fe("div"),ir(z.$$.fragment),this.h()},l(R){c=Ne(R,"DIV",{class:!0,style:!0});var D=Be(c);nr(d.$$.fragment,D),D.forEach(ae),f=mt(R),M&&M.l(R),_=mt(R),F&&F.l(R),v=mt(R),o=Ne(R,"DIV",{class:!0});var H=Be(o);nr(z.$$.fragment,H),H.forEach(ae),this.h()},h(){oe(c,"class","chart svelte-1tebgpk"),Ge(c,"padding-top","3px"),Ge(c,"height",(h[4]?h[1]*.72:h[1])+"px"),oe(o,"class","legend svelte-1tebgpk")},m(R,D){Re(R,c,D),or(d,c,null),Re(R,f,D),M&&M.m(R,D),Re(R,_,D),F&&F.m(R,D),Re(R,v,D),Re(R,o,D),or(z,o,null),T=!0},p(R,[D]){const H={};D&1&&(H.data=R[0]),D&8&&(H.yKey=R[3]),D&64&&(H.colors=R[6]),d.$set(H),(!T||D&18)&&Ge(c,"height",(R[4]?R[1]*.72:R[1])+"px"),R[4]&&R[5]||R[4]=="ni"?M?(M.p(R,D),D&48&&rt(M,1)):(M=am(R),M.c(),rt(M,1),M.m(_.parentNode,_)):M&&(to(),lt(M,1,1,()=>{M=null}),ro()),R[4]=="prev"&&!R[5]?F?(F.p(R,D),D&48&&rt(F,1)):(F=lm(R),F.c(),rt(F,1),F.m(v.parentNode,v)):F&&(to(),lt(F,1,1,()=>{F=null}),ro());const ne={};D&1&&(ne.data=R[0]),D&4&&(ne.xKey=R[2]),D&8&&(ne.yKey=R[3]),D&16&&(ne.zKey=R[4]),D&32&&(ne.topic_prev_available=R[5]),D&128&&(ne.decimals=R[7]),D&64&&(ne.colors=R[6]),z.$set(ne)},i(R){T||(rt(d.$$.fragment,R),rt(M),rt(F),rt(z.$$.fragment,R),T=!0)},o(R){lt(d.$$.fragment,R),lt(M),lt(F),lt(z.$$.fragment,R),T=!1},d(R){R&&ae(c),ar(d),R&&ae(f),M&&M.d(R),R&&ae(_),F&&F.d(R),R&&ae(v),R&&ae(o),ar(z)}}}function L0(h,c,d){let{data:f}=c,{height:_=80}=c,{xKey:v="x"}=c,{yKey:o="y"}=c,{zKey:z="ni"}=c,{topic_prev_available:T=!0}=c,{colors:M=["#8268b6","#00205B","#308182","#3d007a","#3878c5","lightgrey"]}=c,{decimals:F=null}=c,{label:R=null}=c;return h.$$set=D=>{"data"in D&&d(0,f=D.data),"height"in D&&d(1,_=D.height),"xKey"in D&&d(2,v=D.xKey),"yKey"in D&&d(3,o=D.yKey),"zKey"in D&&d(4,z=D.zKey),"topic_prev_available"in D&&d(5,T=D.topic_prev_available),"colors"in D&&d(6,M=D.colors),"decimals"in D&&d(7,F=D.decimals),"label"in D&&d(8,R=D.label)},[f,_,v,o,z,T,M,F,R]}class Dh extends fn{constructor(c){super(),dn(this,c,L0,D0,mn,{data:0,height:1,xKey:2,yKey:3,zKey:4,topic_prev_available:5,colors:6,decimals:7,label:8})}}function um(h,c,d){const f=h.slice();return f[15]=c[d],f}function cm(h,c,d){const f=h.slice();return f[18]=c[d],f[19]=c,f[20]=d,f}function hm(h,c,d){const f=h.slice();return f[15]=c[d],f[20]=d,f}function pm(h){let c,d=h[5],f=[];for(let _=0;_<d.length;_+=1)f[_]=fm(hm(h,d,_));return{c(){c=Fe("ul");for(let _=0;_<f.length;_+=1)f[_].c();this.h()},l(_){c=Ne(_,"UL",{class:!0});var v=Be(c);for(let o=0;o<f.length;o+=1)f[o].l(v);v.forEach(ae),this.h()},h(){oe(c,"class","legend-block svelte-sk00pb")},m(_,v){Re(_,c,v);for(let o=0;o<f.length;o+=1)f[o]&&f[o].m(c,null)},p(_,v){if(v&32){d=_[5];let o;for(o=0;o<d.length;o+=1){const z=hm(_,d,o);f[o]?f[o].p(z,v):(f[o]=fm(z),f[o].c(),f[o].m(c,null))}for(;o<f.length;o+=1)f[o].d(1);f.length=d.length}},d(_){_&&ae(c),nn(f,_)}}}function fm(h){let c,d,f,_,v=h[15]+"",o,z;return{c(){c=Fe("li"),d=Fe("div"),f=dt(),_=Fe("span"),o=Et(v),z=dt(),this.h()},l(T){c=Ne(T,"LI",{class:!0});var M=Be(c);d=Ne(M,"DIV",{class:!0}),Be(d).forEach(ae),f=mt(M),_=Ne(M,"SPAN",{});var F=Be(_);o=Tt(F,v),F.forEach(ae),z=mt(M),M.forEach(ae),this.h()},h(){oe(d,"class","legend-vis "+(h[20]==0?"bar":"bar2")+" svelte-sk00pb"),oe(c,"class","svelte-sk00pb")},m(T,M){Re(T,c,M),Te(c,d),Te(c,f),Te(c,_),Te(_,o),Te(c,z)},p(T,M){M&32&&v!==(v=T[15]+"")&&Tr(o,v)},d(T){T&&ae(c)}}}function dm(h){let c,d=`${h[4](h[18][h[0]])}%`,f,_,v=ym(h[18][h[0]])+"",o,z,T=`calc(${h[4](h[18][h[0]])}% + 2px)`;function M(){h[12].call(_,h[19],h[20])}return{c(){c=Fe("div"),f=dt(),_=Fe("div"),o=Et(v),this.h()},l(F){c=Ne(F,"DIV",{class:!0}),Be(c).forEach(ae),f=mt(F),_=Ne(F,"DIV",{class:!0});var R=Be(_);o=Tt(R,v),R.forEach(ae),this.h()},h(){oe(c,"class",Ih(h[20]==0?"bar":"bar2")+" svelte-sk00pb"),Ge(c,"left","0"),Ge(c,"width",d),Ge(c,"top",h[20]==0?"0":"50%"),Ge(c,"height",h[5][1]?"50%":"100%"),oe(_,"class","label svelte-sk00pb"),Uu(()=>M.call(_)),Ge(_,"left",T),Ge(_,"top",h[20]==0?"0":"50%"),Ge(_,"height","50%")},m(F,R){Re(F,c,R),Re(F,f,R),Re(F,_,R),Te(_,o),z=Vu(_,M.bind(_))},p(F,R){h=F,R&25&&d!==(d=`${h[4](h[18][h[0]])}%`)&&Ge(c,"width",d),R&32&&Ge(c,"height",h[5][1]?"50%":"100%"),R&9&&v!==(v=ym(h[18][h[0]])+"")&&Tr(o,v),R&25&&T!==(T=`calc(${h[4](h[18][h[0]])}% + 2px)`)&&Ge(_,"left",T)},d(F){F&&ae(c),F&&ae(f),F&&ae(_),z()}}}function mm(h){let c,d=h[15].label+"",f,_,v,o,z=`${h[5][1]?h[1]*2:h[1]}px`,T=`calc(100% - ${h[2]}px)`,M=h[15].values,F=[];for(let R=0;R<M.length;R+=1)F[R]=dm(cm(h,M,R));return{c(){c=Fe("div"),f=Et(d),_=dt(),v=Fe("div");for(let R=0;R<F.length;R+=1)F[R].c();o=dt(),this.h()},l(R){c=Ne(R,"DIV",{class:!0});var D=Be(c);f=Tt(D,d),D.forEach(ae),_=mt(R),v=Ne(R,"DIV",{class:!0});var H=Be(v);for(let ne=0;ne<F.length;ne+=1)F[ne].l(H);o=mt(H),H.forEach(ae),this.h()},h(){oe(c,"class","label-group svelte-sk00pb"),oe(v,"class","bar-group svelte-sk00pb"),Ge(v,"height",z),Ge(v,"width",T)},m(R,D){Re(R,c,D),Te(c,f),Re(R,_,D),Re(R,v,D);for(let H=0;H<F.length;H+=1)F[H]&&F[H].m(v,null);Te(v,o)},p(R,D){if(D&8&&d!==(d=R[15].label+"")&&Tr(f,d),D&57){M=R[15].values;let H;for(H=0;H<M.length;H+=1){const ne=cm(R,M,H);F[H]?F[H].p(ne,D):(F[H]=dm(ne),F[H].c(),F[H].m(v,o))}for(;H<F.length;H+=1)F[H].d(1);F.length=M.length}D&34&&z!==(z=`${R[5][1]?R[1]*2:R[1]}px`)&&Ge(v,"height",z),D&4&&T!==(T=`calc(100% - ${R[2]}px)`)&&Ge(v,"width",T)},d(R){R&&ae(c),R&&ae(_),R&&ae(v),nn(F,R)}}}function R0(h){let c,d,f=h[5][1]&&pm(h),_=h[3],v=[];for(let o=0;o<_.length;o+=1)v[o]=mm(um(h,_,o));return{c(){f&&f.c(),c=dt();for(let o=0;o<v.length;o+=1)v[o].c();d=br()},l(o){f&&f.l(o),c=mt(o);for(let z=0;z<v.length;z+=1)v[z].l(o);d=br()},m(o,z){f&&f.m(o,z),Re(o,c,z);for(let T=0;T<v.length;T+=1)v[T]&&v[T].m(o,z);Re(o,d,z)},p(o,[z]){if(o[5][1]?f?f.p(o,z):(f=pm(o),f.c(),f.m(c.parentNode,c)):f&&(f.d(1),f=null),z&63){_=o[3];let T;for(T=0;T<_.length;T+=1){const M=um(o,_,T);v[T]?v[T].p(M,z):(v[T]=mm(M),v[T].c(),v[T].m(d.parentNode,d))}for(;T<v.length;T+=1)v[T].d(1);v.length=_.length}},i:_i,o:_i,d(o){f&&f.d(o),o&&ae(c),nn(v,o),o&&ae(d)}}}function ym(h){let c;return h<1?c="<1%":c=h.toFixed(0)+"%",c}function B0(h,c,d){let f,_,v,o,{data:z}=c,{xKey:T="perc"}=c,{yKey:M="category"}=c,{zKey:F="ni"}=c,{formatTick:R=me=>Math.round(me)}=c,{suffix:D="%"}=c,{barHeight:H=20}=c,{margin:ne=30}=c;function he(me,xe){let ot={};for(const Le of me)ot[Le[xe]]||(ot[Le[xe]]={label:Le[xe],values:[]}),ot[Le[xe]].values.push(Le);let Je=[];for(const Le in ot)Je.push(ot[Le]);return Je}function ve(me,xe){me[xe].width=this.clientWidth,d(3,o),d(6,z),d(7,M)}return h.$$set=me=>{"data"in me&&d(6,z=me.data),"xKey"in me&&d(0,T=me.xKey),"yKey"in me&&d(7,M=me.yKey),"zKey"in me&&d(8,F=me.zKey),"formatTick"in me&&d(9,R=me.formatTick),"suffix"in me&&d(10,D=me.suffix),"barHeight"in me&&d(1,H=me.barHeight),"margin"in me&&d(2,ne=me.margin)},h.$$.update=()=>{h.$$.dirty&65&&d(11,f=[0,Math.max(...z.map(me=>me[T]))]),h.$$.dirty&192&&z.map(me=>me[M]).filter((me,xe,ot)=>ot.indexOf(me)===xe),h.$$.dirty&320&&d(5,_=z.map(me=>me[F]).filter((me,xe,ot)=>ot.indexOf(me)===xe)),h.$$.dirty&2048&&d(4,v=me=>me/f[1]*100),h.$$.dirty&192&&d(3,o=he(z,M))},[T,H,ne,o,v,_,z,M,F,R,D,f,ve]}class Lh extends fn{constructor(c){super(),dn(this,c,B0,R0,mn,{data:6,xKey:0,yKey:7,zKey:8,formatTick:9,suffix:10,barHeight:1,margin:2})}}function _m(h,c,d){const f=h.slice();return f[14]=c[d],f}function gm(h,c,d){const f=h.slice();return f[17]=c[d],f[19]=d,f}function vm(h,c,d){const f=h.slice();return f[17]=c[d],f[19]=d,f}function bm(h,c,d){const f=h.slice();return f[14]=c[d],f[19]=d,f}function xm(h){let c,d=h[7],f=[];for(let _=0;_<d.length;_+=1)f[_]=wm(bm(h,d,_));return{c(){c=Fe("ul");for(let _=0;_<f.length;_+=1)f[_].c();this.h()},l(_){c=Ne(_,"UL",{class:!0});var v=Be(c);for(let o=0;o<f.length;o+=1)f[o].l(v);v.forEach(ae),this.h()},h(){oe(c,"class","legend svelte-1hk4284")},m(_,v){Re(_,c,v);for(let o=0;o<f.length;o+=1)f[o]&&f[o].m(c,null)},p(_,v){if(v&144){d=_[7];let o;for(o=0;o<d.length;o+=1){const z=bm(_,d,o);f[o]?f[o].p(z,v):(f[o]=wm(z),f[o].c(),f[o].m(c,null))}for(;o<f.length;o+=1)f[o].d(1);f.length=d.length}},d(_){_&&ae(c),nn(f,_)}}}function wm(h){let c,d,f,_,v=h[14]+"",o,z;return{c(){c=Fe("li"),d=Fe("div"),f=dt(),_=Fe("span"),o=Et(v),z=dt(),this.h()},l(T){c=Ne(T,"LI",{class:!0});var M=Be(c);d=Ne(M,"DIV",{class:!0}),Be(d).forEach(ae),f=mt(M),_=Ne(M,"SPAN",{class:!0});var F=Be(_);o=Tt(F,v),F.forEach(ae),z=mt(M),M.forEach(ae),this.h()},h(){oe(d,"class","legend-vis "+(h[19]==0?"bar":"marker")+" svelte-1hk4284"),Ge(d,"height","1rem"),Ge(d,"width",h[19]==0?"1rem":h[4]+"px"),oe(_,"class",Ih(h[19]==0?"bold":"brackets")+" svelte-1hk4284"),oe(c,"class","svelte-1hk4284")},m(T,M){Re(T,c,M),Te(c,d),Te(c,f),Te(c,_),Te(_,o),Te(c,z)},p(T,M){M&16&&Ge(d,"width",T[19]==0?"1rem":T[4]+"px"),M&128&&v!==(v=T[14]+"")&&Tr(o,v)},d(T){T&&ae(c)}}}function km(h){let c,d=h[1](h[17].perc/100)+"",f,_;return{c(){c=Fe("span"),f=Et(d),_=Et(h[2]),this.h()},l(v){c=Ne(v,"SPAN",{class:!0,style:!0});var o=Be(c);f=Tt(o,d),_=Tt(o,h[2]),o.forEach(ae),this.h()},h(){oe(c,"class",Ih(h[19]==0?"bold":"sml brackets")+" svelte-1hk4284"),Ge(c,"color",h[19]==0?"#000000":"#1460aa")},m(v,o){Re(v,c,o),Te(c,f),Te(c,_)},p(v,o){o&34&&d!==(d=v[1](v[17].perc/100)+"")&&Tr(f,d),o&4&&Tr(_,v[2])},d(v){v&&ae(c)}}}function O0(h){let c,d=`calc(${h[6](h[17][h[0]])}% - ${h[4]/2}px)`,f=`${h[4]}px`;return{c(){c=Fe("div"),this.h()},l(_){c=Ne(_,"DIV",{class:!0}),Be(c).forEach(ae),this.h()},h(){oe(c,"class","marker svelte-1hk4284"),Ge(c,"left",d),Ge(c,"border-left-width",f)},m(_,v){Re(_,c,v)},p(_,v){v&113&&d!==(d=`calc(${_[6](_[17][_[0]])}% - ${_[4]/2}px)`)&&Ge(c,"left",d),v&16&&f!==(f=`${_[4]}px`)&&Ge(c,"border-left-width",f)},d(_){_&&ae(c)}}}function F0(h){let c,d=`${h[6](h[17][h[0]])}%`;return{c(){c=Fe("div"),this.h()},l(f){c=Ne(f,"DIV",{class:!0}),Be(c).forEach(ae),this.h()},h(){oe(c,"class","bar svelte-1hk4284"),Ge(c,"left","0"),Ge(c,"width",d)},m(f,_){Re(f,c,_)},p(f,_){_&97&&d!==(d=`${f[6](f[17][f[0]])}%`)&&Ge(c,"width",d)},d(f){f&&ae(c)}}}function Sm(h){let c;function d(v,o){return v[19]==0?F0:O0}let _=d(h)(h);return{c(){_.c(),c=br()},l(v){_.l(v),c=br()},m(v,o){_.m(v,o),Re(v,c,o)},p(v,o){_.p(v,o)},d(v){_.d(v),v&&ae(c)}}}function Em(h){let c,d=h[14].label+"",f,_,v,o,z,T=`${h[3]}px`,M=h[14].values,F=[];for(let H=0;H<M.length;H+=1)F[H]=km(vm(h,M,H));let R=h[14].values,D=[];for(let H=0;H<R.length;H+=1)D[H]=Sm(gm(h,R,H));return{c(){c=Fe("div"),f=Et(d),_=dt();for(let H=0;H<F.length;H+=1)F[H].c();v=dt(),o=Fe("div");for(let H=0;H<D.length;H+=1)D[H].c();z=dt(),this.h()},l(H){c=Ne(H,"DIV",{class:!0});var ne=Be(c);f=Tt(ne,d),_=mt(ne);for(let ve=0;ve<F.length;ve+=1)F[ve].l(ne);ne.forEach(ae),v=mt(H),o=Ne(H,"DIV",{class:!0});var he=Be(o);for(let ve=0;ve<D.length;ve+=1)D[ve].l(he);z=mt(he),he.forEach(ae),this.h()},h(){oe(c,"class","label-group svelte-1hk4284"),oe(o,"class","bar-group svelte-1hk4284"),Ge(o,"height",T)},m(H,ne){Re(H,c,ne),Te(c,f),Te(c,_);for(let he=0;he<F.length;he+=1)F[he]&&F[he].m(c,null);Re(H,v,ne),Re(H,o,ne);for(let he=0;he<D.length;he+=1)D[he]&&D[he].m(o,null);Te(o,z)},p(H,ne){if(ne&32&&d!==(d=H[14].label+"")&&Tr(f,d),ne&38){M=H[14].values;let he;for(he=0;he<M.length;he+=1){const ve=vm(H,M,he);F[he]?F[he].p(ve,ne):(F[he]=km(ve),F[he].c(),F[he].m(c,null))}for(;he<F.length;he+=1)F[he].d(1);F.length=M.length}if(ne&113){R=H[14].values;let he;for(he=0;he<R.length;he+=1){const ve=gm(H,R,he);D[he]?D[he].p(ve,ne):(D[he]=Sm(ve),D[he].c(),D[he].m(o,z))}for(;he<D.length;he+=1)D[he].d(1);D.length=R.length}ne&8&&T!==(T=`${H[3]}px`)&&Ge(o,"height",T)},d(H){H&&ae(c),nn(F,H),H&&ae(v),H&&ae(o),nn(D,H)}}}function N0(h){let c,d,f=h[7][1]&&xm(h),_=h[5],v=[];for(let o=0;o<_.length;o+=1)v[o]=Em(_m(h,_,o));return{c(){f&&f.c(),c=dt();for(let o=0;o<v.length;o+=1)v[o].c();d=br()},l(o){f&&f.l(o),c=mt(o);for(let z=0;z<v.length;z+=1)v[z].l(o);d=br()},m(o,z){f&&f.m(o,z),Re(o,c,z);for(let T=0;T<v.length;T+=1)v[T]&&v[T].m(o,z);Re(o,d,z)},p(o,[z]){if(o[7][1]?f?f.p(o,z):(f=xm(o),f.c(),f.m(c.parentNode,c)):f&&(f.d(1),f=null),z&127){_=o[5];let T;for(T=0;T<_.length;T+=1){const M=_m(o,_,T);v[T]?v[T].p(M,z):(v[T]=Em(M),v[T].c(),v[T].m(d.parentNode,d))}for(;T<v.length;T+=1)v[T].d(1);v.length=_.length}},i:_i,o:_i,d(o){f&&f.d(o),o&&ae(c),nn(v,o),o&&ae(d)}}}function U0(h,c,d){let f,_,v,o,{data:z}=c,{xKey:T="perc"}=c,{yKey:M="category"}=c,{zKey:F="group"}=c,{formatTick:R=ve=>Math.round(100*ve)}=c,{suffix:D="%"}=c,{barHeight:H=25}=c,{markerWidth:ne=3}=c;function he(ve,me){let xe={};for(const Je of ve)xe[Je[me]]||(xe[Je[me]]={label:Je[me],values:[]}),xe[Je[me]].values.push(Je);let ot=[];for(const Je in xe)ot.push(xe[Je]);return ot}return h.$$set=ve=>{"data"in ve&&d(8,z=ve.data),"xKey"in ve&&d(0,T=ve.xKey),"yKey"in ve&&d(9,M=ve.yKey),"zKey"in ve&&d(10,F=ve.zKey),"formatTick"in ve&&d(1,R=ve.formatTick),"suffix"in ve&&d(2,D=ve.suffix),"barHeight"in ve&&d(3,H=ve.barHeight),"markerWidth"in ve&&d(4,ne=ve.markerWidth)},h.$$.update=()=>{h.$$.dirty&257&&d(11,f=[0,Math.max(...z.map(ve=>ve[T]))]),h.$$.dirty&768&&z.map(ve=>ve[M]).filter((ve,me,xe)=>xe.indexOf(ve)===me),h.$$.dirty&1280&&d(7,_=z.map(ve=>ve[F]).filter((ve,me,xe)=>xe.indexOf(ve)===me)),h.$$.dirty&2048&&d(6,v=ve=>ve/f[1]*100),h.$$.dirty&768&&d(5,o=he(z,M))},[T,R,D,H,ne,o,v,_,z,M,F,f]}class Rh extends fn{constructor(c){super(),dn(this,c,U0,N0,mn,{data:8,xKey:0,yKey:9,zKey:10,formatTick:1,suffix:2,barHeight:3,markerWidth:4})}}function Tm(h,c,d){const f=h.slice();return f[12]=c[d],f[14]=d,f}function Im(h,c,d){const f=h.slice();return f[15]=c[d],f[17]=d,f}function zm(h,c,d){const f=h.slice();return f[15]=c[d],f[17]=d,f}function Am(h,c,d){const f=h.slice();return f[19]=c[d],f[14]=d,f}function Pm(h){let c,d=h[5],f=[];for(let _=0;_<d.length;_+=1)f[_]=Cm(Am(h,d,_));return{c(){c=Fe("ul");for(let _=0;_<f.length;_+=1)f[_].c();this.h()},l(_){c=Ne(_,"UL",{class:!0});var v=Be(c);for(let o=0;o<f.length;o+=1)f[o].l(v);v.forEach(ae),this.h()},h(){oe(c,"class","legend svelte-pmaxst")},m(_,v){Re(_,c,v);for(let o=0;o<f.length;o+=1)f[o]&&f[o].m(c,null)},p(_,v){if(v&36){d=_[5];let o;for(o=0;o<d.length;o+=1){const z=Am(_,d,o);f[o]?f[o].p(z,v):(f[o]=Cm(z),f[o].c(),f[o].m(c,null))}for(;o<f.length;o+=1)f[o].d(1);f.length=d.length}},d(_){_&&ae(c),nn(f,_)}}}function Cm(h){let c,d,f,_,v=h[19]+"",o,z;return{c(){c=Fe("li"),d=Fe("div"),f=dt(),_=Fe("span"),o=Et(v),z=dt(),this.h()},l(T){c=Ne(T,"LI",{class:!0});var M=Be(c);d=Ne(M,"DIV",{class:!0}),Be(d).forEach(ae),f=mt(M),_=Ne(M,"SPAN",{class:!0});var F=Be(_);o=Tt(F,v),F.forEach(ae),z=mt(M),M.forEach(ae),this.h()},h(){oe(d,"class","legend-vis "+(h[14]==0?"bar":"markerSmall")+" svelte-pmaxst"),Ge(d,"height","1rem"),Ge(d,"width",h[14]==0?"1rem":h[2]+"px"),oe(_,"class",Ih(h[14]==0?"bold":"brackets")+" svelte-pmaxst"),oe(c,"class","svelte-pmaxst")},m(T,M){Re(T,c,M),Te(c,d),Te(c,f),Te(c,_),Te(_,o),Te(c,z)},p(T,M){M&4&&Ge(d,"width",T[14]==0?"1rem":T[2]+"px"),M&32&&v!==(v=T[19]+"")&&Tr(o,v)},d(T){T&&ae(c)}}}function V0(h){let c,d=h[12].values,f=[];for(let _=0;_<d.length;_+=1)f[_]=Mm(Im(h,d,_));return{c(){for(let _=0;_<f.length;_+=1)f[_].c();c=br()},l(_){for(let v=0;v<f.length;v+=1)f[v].l(_);c=br()},m(_,v){for(let o=0;o<f.length;o+=1)f[o]&&f[o].m(_,v);Re(_,c,v)},p(_,v){if(v&89){d=_[12].values;let o;for(o=0;o<d.length;o+=1){const z=Im(_,d,o);f[o]?f[o].p(z,v):(f[o]=Mm(z),f[o].c(),f[o].m(c.parentNode,c))}for(;o<f.length;o+=1)f[o].d(1);f.length=d.length}},d(_){nn(f,_),_&&ae(c)}}}function j0(h){let c,d=h[12].values,f=[];for(let _=0;_<d.length;_+=1)f[_]=Dm(zm(h,d,_));return{c(){for(let _=0;_<f.length;_+=1)f[_].c();c=br()},l(_){for(let v=0;v<f.length;v+=1)f[v].l(_);c=br()},m(_,v){for(let o=0;o<f.length;o+=1)f[o]&&f[o].m(_,v);Re(_,c,v)},p(_,v){if(v&89){d=_[12].values;let o;for(o=0;o<d.length;o+=1){const z=zm(_,d,o);f[o]?f[o].p(z,v):(f[o]=Dm(z),f[o].c(),f[o].m(c.parentNode,c))}for(;o<f.length;o+=1)f[o].d(1);f.length=d.length}},d(_){nn(f,_),_&&ae(c)}}}function Mm(h){let c,d,f=`calc(100% - ${h[15].offset<0?h[4](h[15][h[0]]-h[15].offset):h[4](h[15][h[0]])}%)`,_=`${h[4](h[15].offset)}%`,v=`${h[17]/h[6].length*100}%`,o=`${1/h[6].length*100}%`;return{c(){c=Fe("div"),this.h()},l(z){c=Ne(z,"DIV",{class:!0,style:!0}),Be(c).forEach(ae),this.h()},h(){oe(c,"class","marker svelte-pmaxst"),oe(c,"style",d="border-"+(h[15].offset<0?"top":"bottom")+": none"),Ge(c,"top",f),Ge(c,"height",_),Ge(c,"left",v),Ge(c,"width",o)},m(z,T){Re(z,c,T)},p(z,T){T&8&&d!==(d="border-"+(z[15].offset<0?"top":"bottom")+": none")&&oe(c,"style",d);const M=T&8;(M||T&25&&f!==(f=`calc(100% - ${z[15].offset<0?z[4](z[15][z[0]]-z[15].offset):z[4](z[15][z[0]])}%)`))&&Ge(c,"top",f),(M||T&24&&_!==(_=`${z[4](z[15].offset)}%`))&&Ge(c,"height",_),(M||T&72&&v!==(v=`${z[17]/z[6].length*100}%`))&&Ge(c,"left",v),(M||T&72&&o!==(o=`${1/z[6].length*100}%`))&&Ge(c,"width",o)},d(z){z&&ae(c)}}}function Dm(h){let c,d=`${100-h[4](h[15][h[0]])}%`,f=`${h[4](h[15][h[0]])}%`,_=`${h[17]/h[6].length*100}%`,v=`calc(${1/h[6].length*100}% - 2px)`;return{c(){c=Fe("div"),this.h()},l(o){c=Ne(o,"DIV",{class:!0}),Be(c).forEach(ae),this.h()},h(){oe(c,"class","bar svelte-pmaxst"),Ge(c,"top",d),Ge(c,"height",f),Ge(c,"left",_),Ge(c,"width",v)},m(o,z){Re(o,c,z)},p(o,z){z&25&&d!==(d=`${100-o[4](o[15][o[0]])}%`)&&Ge(c,"top",d),z&25&&f!==(f=`${o[4](o[15][o[0]])}%`)&&Ge(c,"height",f),z&64&&_!==(_=`${o[17]/o[6].length*100}%`)&&Ge(c,"left",_),z&64&&v!==(v=`calc(${1/o[6].length*100}% - 2px)`)&&Ge(c,"width",v)},d(o){o&&ae(c)}}}function Lm(h){let c;function d(v,o){return v[14]==0?j0:V0}let _=d(h)(h);return{c(){_.c(),c=br()},l(v){_.l(v),c=br()},m(v,o){_.m(v,o),Re(v,c,o)},p(v,o){_.p(v,o)},d(v){_.d(v),v&&ae(c)}}}function q0(h){let c,d,f=`${h[1]}px`,_,v,o,z,T,M,F,R,D,H,ne,he,ve,me,xe=h[5][1]&&Pm(h),ot=h[3],Je=[];for(let Le=0;Le<ot.length;Le+=1)Je[Le]=Lm(Tm(h,ot,Le));return{c(){xe&&xe.c(),c=dt(),d=Fe("div");for(let Le=0;Le<Je.length;Le+=1)Je[Le].c();_=dt(),v=Fe("div"),o=Fe("div"),z=Fe("div"),T=Et("0-14"),M=dt(),F=Fe("div"),R=Et("15-39"),D=dt(),H=Fe("div"),ne=Et("40-64"),he=dt(),ve=Fe("div"),me=Et("65+"),this.h()},l(Le){xe&&xe.l(Le),c=mt(Le),d=Ne(Le,"DIV",{class:!0});var Ye=Be(d);for(let yt=0;yt<Je.length;yt+=1)Je[yt].l(Ye);Ye.forEach(ae),_=mt(Le),v=Ne(Le,"DIV",{class:!0});var It=Be(v);o=Ne(It,"DIV",{class:!0});var Lt=Be(o);z=Ne(Lt,"DIV",{class:!0});var jt=Be(z);T=Tt(jt,"0-14"),jt.forEach(ae),M=mt(Lt),F=Ne(Lt,"DIV",{class:!0});var _t=Be(F);R=Tt(_t,"15-39"),_t.forEach(ae),D=mt(Lt),H=Ne(Lt,"DIV",{class:!0});var ht=Be(H);ne=Tt(ht,"40-64"),ht.forEach(ae),he=mt(Lt),ve=Ne(Lt,"DIV",{class:!0});var Ft=Be(ve);me=Tt(Ft,"65+"),Ft.forEach(ae),Lt.forEach(ae),It.forEach(ae),this.h()},h(){oe(d,"class","bar-group svelte-pmaxst"),Ge(d,"height",f),oe(z,"class","column svelte-pmaxst"),oe(F,"class","column svelte-pmaxst"),oe(H,"class","column svelte-pmaxst"),oe(ve,"class","column svelte-pmaxst"),oe(o,"class","row svelte-pmaxst"),Ge(o,"width","100%"),oe(v,"class","x-scale svelte-pmaxst")},m(Le,Ye){xe&&xe.m(Le,Ye),Re(Le,c,Ye),Re(Le,d,Ye);for(let It=0;It<Je.length;It+=1)Je[It]&&Je[It].m(d,null);Re(Le,_,Ye),Re(Le,v,Ye),Te(v,o),Te(o,z),Te(z,T),Te(o,M),Te(o,F),Te(F,R),Te(o,D),Te(o,H),Te(H,ne),Te(o,he),Te(o,ve),Te(ve,me)},p(Le,[Ye]){if(Le[5][1]?xe?xe.p(Le,Ye):(xe=Pm(Le),xe.c(),xe.m(c.parentNode,c)):xe&&(xe.d(1),xe=null),Ye&89){ot=Le[3];let It;for(It=0;It<ot.length;It+=1){const Lt=Tm(Le,ot,It);Je[It]?Je[It].p(Lt,Ye):(Je[It]=Lm(Lt),Je[It].c(),Je[It].m(d,null))}for(;It<Je.length;It+=1)Je[It].d(1);Je.length=ot.length}Ye&2&&f!==(f=`${Le[1]}px`)&&Ge(d,"height",f)},i:_i,o:_i,d(Le){xe&&xe.d(Le),Le&&ae(c),Le&&ae(d),nn(Je,Le),Le&&ae(_),Le&&ae(v)}}}function Z0(h,c,d){let f,_,v,o,z,{data:T}=c,{xKey:M="category"}=c,{yKey:F="perc"}=c,{zKey:R="group"}=c,{height:D=100}=c,{markerWidth:H=3}=c;function ne(he,ve){let me={};for(const ot of he){me[ot[ve]]||(me[ot[ve]]={label:ot[ve],values:[]});let Je=me[ot[ve]].values.length,Le=Je==0?0:ot[F]-me[ot[ve]].values[Je-1][F];me[ot[ve]].values.push({...ot,offset:Le})}let xe=[];for(const ot in me)xe.push(me[ot]);return console.log(xe),xe}return h.$$set=he=>{"data"in he&&d(7,T=he.data),"xKey"in he&&d(8,M=he.xKey),"yKey"in he&&d(0,F=he.yKey),"zKey"in he&&d(9,R=he.zKey),"height"in he&&d(1,D=he.height),"markerWidth"in he&&d(2,H=he.markerWidth)},h.$$.update=()=>{h.$$.dirty&384&&d(6,f=T.map(he=>he[M]).filter((he,ve,me)=>me.indexOf(he)===ve)),h.$$.dirty&129&&d(10,_=[0,Math.max(...T.map(he=>he[F]))]),h.$$.dirty&640&&d(5,v=T.map(he=>he[R]).filter((he,ve,me)=>me.indexOf(he)===ve)),h.$$.dirty&1024&&d(4,o=he=>Math.abs(he/_[1])*100),h.$$.dirty&640&&d(3,z=ne(T,R))},[F,D,H,z,o,v,f,T,M,R,_]}class Bh extends fn{constructor(c){super(),dn(this,c,Z0,q0,mn,{data:7,xKey:8,yKey:0,zKey:9,height:1,markerWidth:2})}}function G0(h){let c,d,f,_;return{c(){c=Fe("div"),d=Et("Back to top"),this.h()},l(v){c=Ne(v,"DIV",{class:!0});var o=Be(c);d=Tt(o,"Back to top"),o.forEach(ae),this.h()},h(){oe(c,"class","back_to_start svelte-11zibd5"),Xn(c,"hidden",h[0])},m(v,o){Re(v,c,o),Te(c,d),f||(_=[ho(window,"scroll",h[2]),ho(c,"click",h[1])],f=!0)},p(v,[o]){o&1&&Xn(c,"hidden",v[0])},i:_i,o:_i,d(v){v&&ae(c),f=!1,qu(_)}}}function K0(h,c,d){let{buttonVisibleOnPX:f=200}=c,_=!0;const v=()=>{document.body.scrollIntoView()},o=()=>document.documentElement||document.body,z=()=>{o().scrollTop>f?d(0,_=!1):d(0,_=!0)};return h.$$set=T=>{"buttonVisibleOnPX"in T&&d(3,f=T.buttonVisibleOnPX)},[_,v,z,f]}class X0 extends fn{constructor(c){super(),dn(this,c,K0,G0,mn,{buttonVisibleOnPX:3})}}function W0(h){let c,d,f=h[1][h[0]].title+"",_,v,o,z,T,M,F,R=h[1][h[0]].info+"",D;return{c(){c=Fe("div"),d=Fe("div"),_=Et(f),v=Fe("span"),T=dt(),M=Fe("div"),F=Fe("div"),this.h()},l(H){c=Ne(H,"DIV",{class:!0,style:!0,"data-bs-toggle":!0,"data-bs-target":!0,"aria-expanded":!0,"aria-controls":!0});var ne=Be(c);d=Ne(ne,"DIV",{class:!0,style:!0});var he=Be(d);_=Tt(he,f),v=Ne(he,"SPAN",{class:!0}),Be(v).forEach(ae),he.forEach(ae),ne.forEach(ae),T=mt(H),M=Ne(H,"DIV",{class:!0,id:!0});var ve=Be(M);F=Ne(ve,"DIV",{class:!0});var me=Be(F);me.forEach(ae),ve.forEach(ae),this.h()},h(){oe(v,"class","i-button"),oe(d,"class","blocktitle"),Ge(d,"margin","0"),Ge(d,"width","100%"),oe(c,"class","row"),Ge(c,"display","flex"),Ge(c,"cursor","pointer"),oe(c,"data-bs-toggle","collapse"),oe(c,"data-bs-target",o="#"+h[0]+"-info"),oe(c,"aria-expanded","false"),oe(c,"aria-controls",z=h[0]+"-info"),oe(F,"class","card card-body svelte-1qrf6oz"),oe(M,"class","collapse svelte-1qrf6oz"),oe(M,"id",D=h[0]+"-info")},m(H,ne){Re(H,c,ne),Te(c,d),Te(d,_),Te(d,v),Re(H,T,ne),Re(H,M,ne),Te(M,F),F.innerHTML=R},p(H,[ne]){ne&1&&f!==(f=H[1][H[0]].title+"")&&Tr(_,f),ne&1&&o!==(o="#"+H[0]+"-info")&&oe(c,"data-bs-target",o),ne&1&&z!==(z=H[0]+"-info")&&oe(c,"aria-controls",z),ne&1&&R!==(R=H[1][H[0]].info+"")&&(F.innerHTML=R),ne&1&&D!==(D=H[0]+"-info")&&oe(M,"id",D)},i:_i,o:_i,d(H){H&&ae(c),H&&ae(T),H&&ae(M)}}}function H0(h,c,d){let{id:f}=c,{place:_}=c,v={location:{title:"About the area",info:"Information about the area including its geographical hierarchy."},area:{title:"Area",info:"Area is measured in hectares (ha), it is rounded to the nearest whole number."},popden:{title:"Population density",info:"Population density is the number of usual residents per hectare. It is rounded to 1 d.p."},pop:{title:"Population",info:"Population is based on the number of usual residents. A usual resident is anyone who, on 21 March 2021 is in the UK, and staying in the UK for a period of 3 months or more; or has a permanent UK address and is outside the UK and is staying outside the UK for less than 12 months. <a href='https://www.nisra.gov.uk/publications/census-2021-statistical-bulletins'><strong>Statistical bulletins</strong></a>"},generalhealth:{title:"General Health",info:"General health is a self-assessment of a person’s general state of health. It is not based over any specified period of time. <a href='https://www.nisra.gov.uk/publications/census-2021-statistical-bulletins'><strong>Statistical bulletins</strong></a>"},wellbeing:{title:"Happiness",info:"Average Happiness score out of 10 for people aged 16+</p><p>source:</p><p>Last Updated:</p><p>Further Information:</p>"},lifeexpectancy:{title:"Life Expectancy at birth",info:"words to be added"},carers:{title:"Unpaid care",info:"'Unpaid care' covers looking after, giving help or support to anyone because they have long-term physical or mental health conditions or illnesses, or problems related to old age. It does not include any activities as part of paid employment. All unpaid care statistics are restricted to persons aged 5 and over. <a href='https://www.nisra.gov.uk/publications/census-2021-statistical-bulletins'><strong>Statistical bulletins</strong></a>"},hospitalactivity:{title:"Activity in hospitals / waiting lists",info:"words to be added"},primarycare:{title:"Primary care providers",info:"words to be added"},employmentrates:{title:"Employment rates",info:"words to be added"},employed:{title:"Number of people employed",info:"words to be added"},wages:{title:"Average wages",info:"words to be added"},benefits:{title:"Number of people on work-related benefits",info:"words to be added"},enrollments:{title:"Number of enrolled in schools and colleges",info:"words to be added"},fsme:{title:"Entitlement to Free School Meals",info:"words to be added"},teachers:{title:"Teachers",info:"words to be added"},qualifications:{title:"Highest level of Qualifications",info:"words to be added"},attainment:{title:"Attainment of Qualifications",info:"words to be added"},popchange:{title:"Population change",info:"words to be added"},age:{title:"Broad age bands",info:"A grouping of ages where a person’s age is their age at their last birthday on or prior to census day. <a href='https://www.nisra.gov.uk/publications/census-2021-statistical-bulletins'><strong>Statistical bulletins</strong></a>"},sex:{title:"Sex",info:"words to be added"},hhsize:{title:"Household size",info:"The number of usual residents in the household.      <a href='https://www.nisra.gov.uk/publications/census-2021-statistical-bulletins'><strong>Statistical bulletins</strong></a>"},religion:{title:"Religion, Religion brought up",info:"The religious group the person belongs to or for people with no current religion their religious group of upbringing.People with no current religion and no religion of upbringing are labelled 'None'.<a href='https://www.nisra.gov.uk/publications/census-2021-statistical-bulletins'><strong>Statistical bulletins</strong></a>"},language:{title:"Main language",info:"Person's main language as declared in the Census.Statistics for all language questions are restrictedto persons aged 3 and over. <ahref='https://www.nisra.gov.uk/publications/census-2021-statistical-bulletins'><strong>Statistical bulletins</strong></a>"},households:{title:"Households - box with numbers",info:"A household is either one person living alone or a group of people living at the same address who share cooking facilities and share a living room, sitting room or dining area. <a href='https://www.nisra.gov.uk/publications/census-2021-statistical-bulletins'><strong>Statistical bulletins</strong></a>"},dentalreg:{title:"Number of dental registrations",info:"<a href='mailto:"+_.meta_data.FPSGDSDR.email+"'>Email for more information</a> Last updated: "+_.meta_data.FPSGDSDR.last_updated+" Access data at: <a href='"+_.meta_data.FPSGDSDR.dataset_url+"'>"+_.meta_data.FPSGDSDR.title+"</a>"}};return h.$$set=o=>{"id"in o&&d(0,f=o.id),"place"in o&&d(2,_=o.place)},[f,v,_]}class J0 extends fn{constructor(c){super(),dn(this,c,H0,W0,mn,{id:0,place:2})}}function Y0(h){let c,d;return{c(){c=Fe("h3"),d=Et(h[9]),this.h()},l(f){c=Ne(f,"H3",{style:!0});var _=Be(c);d=Tt(_,h[9]),_.forEach(ae),this.h()},h(){Ge(c,"margin","0 0 10px 0"),Ge(c,"line-height","1.78")},m(f,_){Re(f,c,_),Te(c,d)},p(f,_){_&512&&Tr(d,f[9])},i:_i,o:_i,d(f){f&&ae(c)}}}function Q0(h){let c,d;return c=new J0({props:{id:h[1],place:h[3]}}),{c(){ir(c.$$.fragment)},l(f){nr(c.$$.fragment,f)},m(f,_){or(c,f,_),d=!0},p(f,_){const v={};_&2&&(v.id=f[1]),_&8&&(v.place=f[3]),c.$set(v)},i(f){d||(rt(c.$$.fragment,f),d=!0)},o(f){lt(c.$$.fragment,f),d=!1},d(f){ar(c,f)}}}function $0(h){let c,d;return{c(){c=new Zu(!1),d=br(),this.h()},l(f){c=Gu(f,!1),d=br(),this.h()},h(){c.a=d},m(f,_){c.m(h[4],f,_),Re(f,d,_)},p(f,_){_&16&&c.p(f[4])},i:_i,o:_i,d(f){f&&ae(d),f&&c.d()}}}function e1(h){let c,d=h[4][h[3].type]+"",f;return{c(){c=new Zu(!1),f=br(),this.h()},l(_){c=Gu(_,!1),f=br(),this.h()},h(){c.a=f},m(_,v){c.m(d,_,v),Re(_,f,v)},p(_,v){v&24&&d!==(d=_[4][_[3].type]+"")&&c.p(d)},i:_i,o:_i,d(_){_&&ae(f),_&&c.d()}}}function t1(h){let c,d,f,_,v,o,z;const T=[u1,l1,s1,a1],M=[];function F(R,D){return D&1056&&(c=null),D&1056&&(d=null),D&1056&&(f=null),c==null&&(c=!!(R[5].hasOwnProperty("none")&R[10]==null)),c?0:(d==null&&(d=!!(R[5].hasOwnProperty("prev")&R[10]=="prev")),d?1:(f==null&&(f=!!(R[5].hasOwnProperty("ni")&R[10]=="ni")),f?2:3))}return _=F(h,-1),v=M[_]=T[_](h),{c(){v.c(),o=br()},l(R){v.l(R),o=br()},m(R,D){M[_].m(R,D),Re(R,o,D),z=!0},p(R,D){let H=_;_=F(R,D),_===H?M[_].p(R,D):(to(),lt(M[H],1,1,()=>{M[H]=null}),ro(),v=M[_],v?v.p(R,D):(v=M[_]=T[_](R),v.c()),rt(v,1),v.m(o.parentNode,o))},i(R){z||(rt(v),z=!0)},o(R){lt(v),z=!1},d(R){M[_].d(R),R&&ae(o)}}}function r1(h){let c,d,f,_,v,o,z;const T=[f1,p1,h1,c1],M=[];function F(R,D){return D&1056&&(c=null),D&1056&&(d=null),D&1056&&(f=null),c==null&&(c=!!(R[5].hasOwnProperty("none")&R[10]==null)),c?0:(d==null&&(d=!!(R[5].hasOwnProperty("prev")&R[10]=="prev")),d?1:(f==null&&(f=!!(R[5].hasOwnProperty("ni")&R[10]=="ni")),f?2:3))}return _=F(h,-1),v=M[_]=T[_](h),{c(){v.c(),o=br()},l(R){v.l(R),o=br()},m(R,D){M[_].m(R,D),Re(R,o,D),z=!0},p(R,D){let H=_;_=F(R,D),_===H?M[_].p(R,D):(to(),lt(M[H],1,1,()=>{M[H]=null}),ro(),v=M[_],v?v.p(R,D):(v=M[_]=T[_](R),v.c()),rt(v,1),v.m(o.parentNode,o))},i(R){z||(rt(v),z=!0)},o(R){lt(v),z=!1},d(R){M[_].d(R),R&&ae(o)}}}function i1(h){let c,d,f,_,v,o,z;const T=[_1,y1,m1,d1],M=[];function F(R,D){return D&1056&&(c=null),D&1056&&(d=null),D&1056&&(f=null),c==null&&(c=!!(R[5].hasOwnProperty("none")&R[10]==null)),c?0:(d==null&&(d=!!(R[5].hasOwnProperty("prev")&R[10]=="prev")),d?1:(f==null&&(f=!!(R[5].hasOwnProperty("ni")&R[10]=="ni")),f?2:3))}return _=F(h,-1),v=M[_]=T[_](h),{c(){v.c(),o=br()},l(R){v.l(R),o=br()},m(R,D){M[_].m(R,D),Re(R,o,D),z=!0},p(R,D){let H=_;_=F(R,D),_===H?M[_].p(R,D):(to(),lt(M[H],1,1,()=>{M[H]=null}),ro(),v=M[_],v?v.p(R,D):(v=M[_]=T[_](R),v.c()),rt(v,1),v.m(o.parentNode,o))},i(R){z||(rt(v),z=!0)},o(R){lt(v),z=!1},d(R){M[_].d(R),R&&ae(o)}}}function n1(h){let c,d,f,_,v,o,z;const T=[x1,b1,v1,g1],M=[];function F(R,D){return D&1056&&(c=null),D&1056&&(d=null),D&1056&&(f=null),c==null&&(c=!!(R[5].hasOwnProperty("none")&R[10]==null)),c?0:(d==null&&(d=!!(R[5].hasOwnProperty("prev")&R[10]=="prev")),d?1:(f==null&&(f=!!(R[5].hasOwnProperty("ni")&R[10]=="ni")),f?2:3))}return _=F(h,-1),v=M[_]=T[_](h),{c(){v.c(),o=br()},l(R){v.l(R),o=br()},m(R,D){M[_].m(R,D),Re(R,o,D),z=!0},p(R,D){let H=_;_=F(R,D),_===H?M[_].p(R,D):(to(),lt(M[H],1,1,()=>{M[H]=null}),ro(),v=M[_],v?v.p(R,D):(v=M[_]=T[_](R),v.c()),rt(v,1),v.m(o.parentNode,o))},i(R){z||(rt(v),z=!0)},o(R){lt(v),z=!1},d(R){M[_].d(R),R&&ae(o)}}}function o1(h){let c,d,f,_,v,o,z;const T=[E1,S1,k1,w1],M=[];function F(R,D){return D&1056&&(c=null),D&1056&&(d=null),D&1056&&(f=null),c==null&&(c=!!(R[5].hasOwnProperty("none")&R[10]==null)),c?0:(d==null&&(d=!!(R[5].hasOwnProperty("prev")&R[10]=="prev")),d?1:(f==null&&(f=!!(R[5].hasOwnProperty("ni")&R[10]=="ni")),f?2:3))}return _=F(h,-1),v=M[_]=T[_](h),{c(){v.c(),o=br()},l(R){v.l(R),o=br()},m(R,D){M[_].m(R,D),Re(R,o,D),z=!0},p(R,D){let H=_;_=F(R,D),_===H?M[_].p(R,D):(to(),lt(M[H],1,1,()=>{M[H]=null}),ro(),v=M[_],v?v.p(R,D):(v=M[_]=T[_](R),v.c()),rt(v,1),v.m(o.parentNode,o))},i(R){z||(rt(v),z=!0)},o(R){lt(v),z=!1},d(R){M[_].d(R),R&&ae(o)}}}function a1(h){let c,d;return c=new Mh({props:{data:h[5],zKey:h[6]}}),{c(){ir(c.$$.fragment)},l(f){nr(c.$$.fragment,f)},m(f,_){or(c,f,_),d=!0},p(f,_){const v={};_&32&&(v.data=f[5]),_&64&&(v.zKey=f[6]),c.$set(v)},i(f){d||(rt(c.$$.fragment,f),d=!0)},o(f){lt(c.$$.fragment,f),d=!1},d(f){ar(c,f)}}}function s1(h){let c,d;return c=new Mh({props:{data:h[5].ni,zKey:h[6]}}),{c(){ir(c.$$.fragment)},l(f){nr(c.$$.fragment,f)},m(f,_){or(c,f,_),d=!0},p(f,_){const v={};_&32&&(v.data=f[5].ni),_&64&&(v.zKey=f[6]),c.$set(v)},i(f){d||(rt(c.$$.fragment,f),d=!0)},o(f){lt(c.$$.fragment,f),d=!1},d(f){ar(c,f)}}}function l1(h){let c,d;return c=new Mh({props:{data:h[5].prev,zKey:h[6]}}),{c(){ir(c.$$.fragment)},l(f){nr(c.$$.fragment,f)},m(f,_){or(c,f,_),d=!0},p(f,_){const v={};_&32&&(v.data=f[5].prev),_&64&&(v.zKey=f[6]),c.$set(v)},i(f){d||(rt(c.$$.fragment,f),d=!0)},o(f){lt(c.$$.fragment,f),d=!1},d(f){ar(c,f)}}}function u1(h){let c,d;return c=new Mh({props:{data:h[5].none,zKey:h[6]}}),{c(){ir(c.$$.fragment)},l(f){nr(c.$$.fragment,f)},m(f,_){or(c,f,_),d=!0},p(f,_){const v={};_&32&&(v.data=f[5].none),_&64&&(v.zKey=f[6]),c.$set(v)},i(f){d||(rt(c.$$.fragment,f),d=!0)},o(f){lt(c.$$.fragment,f),d=!1},d(f){ar(c,f)}}}function c1(h){let c,d;return c=new Rh({props:{data:h[5],zKey:h[6],label:h[7]}}),{c(){ir(c.$$.fragment)},l(f){nr(c.$$.fragment,f)},m(f,_){or(c,f,_),d=!0},p(f,_){const v={};_&32&&(v.data=f[5]),_&64&&(v.zKey=f[6]),_&128&&(v.label=f[7]),c.$set(v)},i(f){d||(rt(c.$$.fragment,f),d=!0)},o(f){lt(c.$$.fragment,f),d=!1},d(f){ar(c,f)}}}function h1(h){let c,d;return c=new Rh({props:{data:h[5].ni,zKey:h[6],label:h[7]}}),{c(){ir(c.$$.fragment)},l(f){nr(c.$$.fragment,f)},m(f,_){or(c,f,_),d=!0},p(f,_){const v={};_&32&&(v.data=f[5].ni),_&64&&(v.zKey=f[6]),_&128&&(v.label=f[7]),c.$set(v)},i(f){d||(rt(c.$$.fragment,f),d=!0)},o(f){lt(c.$$.fragment,f),d=!1},d(f){ar(c,f)}}}function p1(h){let c,d;return c=new Rh({props:{data:h[5].prev,zKey:h[6],label:h[7]}}),{c(){ir(c.$$.fragment)},l(f){nr(c.$$.fragment,f)},m(f,_){or(c,f,_),d=!0},p(f,_){const v={};_&32&&(v.data=f[5].prev),_&64&&(v.zKey=f[6]),_&128&&(v.label=f[7]),c.$set(v)},i(f){d||(rt(c.$$.fragment,f),d=!0)},o(f){lt(c.$$.fragment,f),d=!1},d(f){ar(c,f)}}}function f1(h){let c,d;return c=new Rh({props:{data:h[5].none,zKey:h[6],label:h[7]}}),{c(){ir(c.$$.fragment)},l(f){nr(c.$$.fragment,f)},m(f,_){or(c,f,_),d=!0},p(f,_){const v={};_&32&&(v.data=f[5].none),_&64&&(v.zKey=f[6]),_&128&&(v.label=f[7]),c.$set(v)},i(f){d||(rt(c.$$.fragment,f),d=!0)},o(f){lt(c.$$.fragment,f),d=!1},d(f){ar(c,f)}}}function d1(h){let c,d;return c=new Bh({props:{data:h[5],zKey:h[6],label:h[7]}}),{c(){ir(c.$$.fragment)},l(f){nr(c.$$.fragment,f)},m(f,_){or(c,f,_),d=!0},p(f,_){const v={};_&32&&(v.data=f[5]),_&64&&(v.zKey=f[6]),_&128&&(v.label=f[7]),c.$set(v)},i(f){d||(rt(c.$$.fragment,f),d=!0)},o(f){lt(c.$$.fragment,f),d=!1},d(f){ar(c,f)}}}function m1(h){let c,d;return c=new Bh({props:{data:h[5].ni,zKey:h[6],label:h[7]}}),{c(){ir(c.$$.fragment)},l(f){nr(c.$$.fragment,f)},m(f,_){or(c,f,_),d=!0},p(f,_){const v={};_&32&&(v.data=f[5].ni),_&64&&(v.zKey=f[6]),_&128&&(v.label=f[7]),c.$set(v)},i(f){d||(rt(c.$$.fragment,f),d=!0)},o(f){lt(c.$$.fragment,f),d=!1},d(f){ar(c,f)}}}function y1(h){let c,d;return c=new Bh({props:{data:h[5].prev,zKey:h[6],label:h[7]}}),{c(){ir(c.$$.fragment)},l(f){nr(c.$$.fragment,f)},m(f,_){or(c,f,_),d=!0},p(f,_){const v={};_&32&&(v.data=f[5].prev),_&64&&(v.zKey=f[6]),_&128&&(v.label=f[7]),c.$set(v)},i(f){d||(rt(c.$$.fragment,f),d=!0)},o(f){lt(c.$$.fragment,f),d=!1},d(f){ar(c,f)}}}function _1(h){let c,d;return c=new Bh({props:{data:h[5].none,zKey:h[6],label:h[7]}}),{c(){ir(c.$$.fragment)},l(f){nr(c.$$.fragment,f)},m(f,_){or(c,f,_),d=!0},p(f,_){const v={};_&32&&(v.data=f[5].none),_&64&&(v.zKey=f[6]),_&128&&(v.label=f[7]),c.$set(v)},i(f){d||(rt(c.$$.fragment,f),d=!0)},o(f){lt(c.$$.fragment,f),d=!1},d(f){ar(c,f)}}}function g1(h){let c,d;return c=new Lh({props:{data:h[5],zKey:h[6],label:h[7]}}),{c(){ir(c.$$.fragment)},l(f){nr(c.$$.fragment,f)},m(f,_){or(c,f,_),d=!0},p(f,_){const v={};_&32&&(v.data=f[5]),_&64&&(v.zKey=f[6]),_&128&&(v.label=f[7]),c.$set(v)},i(f){d||(rt(c.$$.fragment,f),d=!0)},o(f){lt(c.$$.fragment,f),d=!1},d(f){ar(c,f)}}}function v1(h){let c,d;return c=new Lh({props:{data:h[5].ni,zKey:h[6],label:h[7]}}),{c(){ir(c.$$.fragment)},l(f){nr(c.$$.fragment,f)},m(f,_){or(c,f,_),d=!0},p(f,_){const v={};_&32&&(v.data=f[5].ni),_&64&&(v.zKey=f[6]),_&128&&(v.label=f[7]),c.$set(v)},i(f){d||(rt(c.$$.fragment,f),d=!0)},o(f){lt(c.$$.fragment,f),d=!1},d(f){ar(c,f)}}}function b1(h){let c,d;return c=new Lh({props:{data:h[5].prev,zKey:h[6],label:h[7]}}),{c(){ir(c.$$.fragment)},l(f){nr(c.$$.fragment,f)},m(f,_){or(c,f,_),d=!0},p(f,_){const v={};_&32&&(v.data=f[5].prev),_&64&&(v.zKey=f[6]),_&128&&(v.label=f[7]),c.$set(v)},i(f){d||(rt(c.$$.fragment,f),d=!0)},o(f){lt(c.$$.fragment,f),d=!1},d(f){ar(c,f)}}}function x1(h){let c,d;return c=new Lh({props:{data:h[5].none,zKey:h[6],label:h[7]}}),{c(){ir(c.$$.fragment)},l(f){nr(c.$$.fragment,f)},m(f,_){or(c,f,_),d=!0},p(f,_){const v={};_&32&&(v.data=f[5].none),_&64&&(v.zKey=f[6]),_&128&&(v.label=f[7]),c.$set(v)},i(f){d||(rt(c.$$.fragment,f),d=!0)},o(f){lt(c.$$.fragment,f),d=!1},d(f){ar(c,f)}}}function w1(h){let c,d;return c=new Dh({props:{data:h[5],zKey:h[6],label:h[7],topic_prev_available:h[0]}}),{c(){ir(c.$$.fragment)},l(f){nr(c.$$.fragment,f)},m(f,_){or(c,f,_),d=!0},p(f,_){const v={};_&32&&(v.data=f[5]),_&64&&(v.zKey=f[6]),_&128&&(v.label=f[7]),_&1&&(v.topic_prev_available=f[0]),c.$set(v)},i(f){d||(rt(c.$$.fragment,f),d=!0)},o(f){lt(c.$$.fragment,f),d=!1},d(f){ar(c,f)}}}function k1(h){let c,d;return c=new Dh({props:{data:h[5].ni,zKey:h[6],label:h[7],topic_prev_available:h[0]}}),{c(){ir(c.$$.fragment)},l(f){nr(c.$$.fragment,f)},m(f,_){or(c,f,_),d=!0},p(f,_){const v={};_&32&&(v.data=f[5].ni),_&64&&(v.zKey=f[6]),_&128&&(v.label=f[7]),_&1&&(v.topic_prev_available=f[0]),c.$set(v)},i(f){d||(rt(c.$$.fragment,f),d=!0)},o(f){lt(c.$$.fragment,f),d=!1},d(f){ar(c,f)}}}function S1(h){let c,d;return c=new Dh({props:{data:h[5].prev,zKey:h[6],label:h[7],topic_prev_available:h[0]}}),{c(){ir(c.$$.fragment)},l(f){nr(c.$$.fragment,f)},m(f,_){or(c,f,_),d=!0},p(f,_){const v={};_&32&&(v.data=f[5].prev),_&64&&(v.zKey=f[6]),_&128&&(v.label=f[7]),_&1&&(v.topic_prev_available=f[0]),c.$set(v)},i(f){d||(rt(c.$$.fragment,f),d=!0)},o(f){lt(c.$$.fragment,f),d=!1},d(f){ar(c,f)}}}function E1(h){let c,d;return c=new Dh({props:{data:h[5].none,zKey:h[6],label:h[7],topic_prev_available:h[0]}}),{c(){ir(c.$$.fragment)},l(f){nr(c.$$.fragment,f)},m(f,_){or(c,f,_),d=!0},p(f,_){const v={};_&32&&(v.data=f[5].none),_&64&&(v.zKey=f[6]),_&128&&(v.label=f[7]),_&1&&(v.topic_prev_available=f[0]),c.$set(v)},i(f){d||(rt(c.$$.fragment,f),d=!0)},o(f){lt(c.$$.fragment,f),d=!1},d(f){ar(c,f)}}}function T1(h){let c,d,f,_,v,o,z,T,M,F;const R=[Q0,Y0],D=[];function H(me,xe){return me[8]?0:1}d=H(h),f=D[d]=R[d](h);const ne=[o1,n1,i1,r1,t1,e1,$0],he=[];function ve(me,xe){return xe&24&&(z=null),me[4]=="StackedBarChart"?0:me[4]=="GroupChart"?1:me[4]=="ProfileChart"?2:me[4]=="BarChart"?3:me[4]=="ColChart"?4:(z==null&&(z=!!me[4].hasOwnProperty(me[3].type)),z?5:6)}return T=ve(h,-1),M=he[T]=ne[T](h),{c(){c=Fe("div"),f.c(),_=dt(),v=Fe("br"),o=dt(),M.c(),this.h()},l(me){c=Ne(me,"DIV",{class:!0,style:!0});var xe=Be(c);f.l(xe),_=mt(xe),v=Ne(xe,"BR",{}),o=mt(xe),M.l(xe),xe.forEach(ae),this.h()},h(){oe(c,"class","div-grey-box svelte-o2lhz2"),oe(c,"style",h[2])},m(me,xe){Re(me,c,xe),D[d].m(c,null),Te(c,_),Te(c,v),Te(c,o),he[T].m(c,null),F=!0},p(me,[xe]){let ot=d;d=H(me),d===ot?D[d].p(me,xe):(to(),lt(D[ot],1,1,()=>{D[ot]=null}),ro(),f=D[d],f?f.p(me,xe):(f=D[d]=R[d](me),f.c()),rt(f,1),f.m(c,_));let Je=T;T=ve(me,xe),T===Je?he[T].p(me,xe):(to(),lt(he[Je],1,1,()=>{he[Je]=null}),ro(),M=he[T],M?M.p(me,xe):(M=he[T]=ne[T](me),M.c()),rt(M,1),M.m(c,null)),(!F||xe&4)&&oe(c,"style",me[2])},i(me){F||(rt(f),rt(M),F=!0)},o(me){lt(f),lt(M),F=!1},d(me){me&&ae(c),D[d].d(),he[T].d()}}}function I1(h,c,d){let{id:f}=c,{style:_=null}=c,{place:v}=c,{content:o}=c,{chart_data:z=null}=c,{zKey:T="ni"}=c,{label:M=null}=c,{topic_prev_available:F=null}=c,{topic_boolean:R=null}=c,{i_button:D=!0}=c,{heading:H=null}=c,{chart_compare_type:ne}=c;return F=="false"?R=!1:R=!0,h.$$set=he=>{"id"in he&&d(1,f=he.id),"style"in he&&d(2,_=he.style),"place"in he&&d(3,v=he.place),"content"in he&&d(4,o=he.content),"chart_data"in he&&d(5,z=he.chart_data),"zKey"in he&&d(6,T=he.zKey),"label"in he&&d(7,M=he.label),"topic_prev_available"in he&&d(11,F=he.topic_prev_available),"topic_boolean"in he&&d(0,R=he.topic_boolean),"i_button"in he&&d(8,D=he.i_button),"heading"in he&&d(9,H=he.heading),"chart_compare_type"in he&&d(10,ne=he.chart_compare_type)},[R,f,_,v,o,z,T,M,D,H,ne,F]}class bh extends fn{constructor(c){super(),dn(this,c,I1,T1,mn,{id:1,style:2,place:3,content:4,chart_data:5,zKey:6,label:7,topic_prev_available:11,topic_boolean:0,i_button:8,heading:9,chart_compare_type:10})}}function Rm(h,c,d){const f=h.slice();return f[13]=c[d],f[15]=d,f}function Bm(h){let c,d;return c=new bh({props:{id:h[6][h[10][h[15]]].id,style:h[6][h[10][h[15]]].style,place:h[3],content:h[6][h[10][h[15]]].content,chart_data:h[6][h[10][h[15]]].chart_data,zKey:h[6][h[10][h[15]]].zKey,label:h[6][h[10][h[15]]].label,topic_prev_available:h[6][h[10][h[15]]].topic_prev_available,chart_compare_type:h[8]}}),{c(){ir(c.$$.fragment)},l(f){nr(c.$$.fragment,f)},m(f,_){or(c,f,_),d=!0},p(f,_){const v={};_&64&&(v.id=f[6][f[10][f[15]]].id),_&64&&(v.style=f[6][f[10][f[15]]].style),_&8&&(v.place=f[3]),_&64&&(v.content=f[6][f[10][f[15]]].content),_&64&&(v.chart_data=f[6][f[10][f[15]]].chart_data),_&64&&(v.zKey=f[6][f[10][f[15]]].zKey),_&64&&(v.label=f[6][f[10][f[15]]].label),_&64&&(v.topic_prev_available=f[6][f[10][f[15]]].topic_prev_available),_&256&&(v.chart_compare_type=f[8]),c.$set(v)},i(f){d||(rt(c.$$.fragment,f),d=!0)},o(f){lt(c.$$.fragment,f),d=!1},d(f){ar(c,f)}}}function Om(h){let c,d,f,_;return{c(){c=Fe("h3"),d=Et("More Statistics"),f=dt(),_=Fe("div"),this.h()},l(v){c=Ne(v,"H3",{});var o=Be(c);d=Tt(o,"More Statistics"),o.forEach(ae),f=mt(v),_=Ne(v,"DIV",{class:!0});var z=Be(_);z.forEach(ae),this.h()},h(){oe(_,"class","accordion-more svelte-1jaw0n6")},m(v,o){Re(v,c,o),Te(c,d),Re(v,f,o),Re(v,_,o),_.innerHTML=h[7]},p(v,o){o&128&&(_.innerHTML=v[7])},d(v){v&&ae(c),v&&ae(f),v&&ae(_)}}}function z1(h){let c,d,f,_,v,o,z,T,M,F,R,D,H,ne,he,ve,me=h[3].name+"",xe,ot,Je,Le,Ye,It,Lt,jt,_t,ht,Ft,yt={length:h[10].length},zt=[];for(let pt=0;pt<yt.length;pt+=1)zt[pt]=Bm(Rm(h,yt,pt));const et=pt=>lt(zt[pt],1,1,()=>{zt[pt]=null});let qt=h[7]!=""&&Om(h);return{c(){c=Fe("div"),d=Fe("h2"),f=Fe("button"),_=Fe("span"),v=Fe("img"),z=dt(),T=Et(h[2]),D=dt(),H=Fe("div"),ne=Fe("div"),he=Et(h[4]),ve=Et(" - "),xe=Et(me),ot=Et(` -\r
            `),Je=Fe("span"),Le=Et(h[5]),Ye=dt(),It=Fe("div");for(let pt=0;pt<zt.length;pt+=1)zt[pt].c();jt=dt(),qt&&qt.c(),this.h()},l(pt){c=Ne(pt,"DIV",{class:!0});var At=Be(c);d=Ne(At,"H2",{class:!0,id:!0});var Ut=Be(d);f=Ne(Ut,"BUTTON",{class:!0,type:!0,"data-bs-toggle":!0,"data-bs-target":!0,"aria-expanded":!0,"aria-controls":!0});var cr=Be(f);_=Ne(cr,"SPAN",{class:!0});var Ve=Be(_);v=Ne(Ve,"IMG",{src:!0,alt:!0,height:!0,class:!0}),z=mt(Ve),T=Tt(Ve,h[2]),Ve.forEach(ae),cr.forEach(ae),Ut.forEach(ae),D=mt(At),H=Ne(At,"DIV",{id:!0,class:!0,"aria-labelledby":!0});var fr=Be(H);ne=Ne(fr,"DIV",{class:!0});var hr=Be(ne);he=Tt(hr,h[4]),ve=Tt(hr," - "),xe=Tt(hr,me),ot=Tt(hr,` -\r
            `),Je=Ne(hr,"SPAN",{class:!0});var xr=Be(Je);Le=Tt(xr,h[5]),xr.forEach(ae),Ye=mt(hr),It=Ne(hr,"DIV",{class:!0});var Fr=Be(It);for(let wi=0;wi<zt.length;wi+=1)zt[wi].l(Fr);Fr.forEach(ae),jt=mt(hr),qt&&qt.l(hr),hr.forEach(ae),fr.forEach(ae),At.forEach(ae),this.h()},h(){gd(v.src,o=Co+"/img/"+h[1])||oe(v,"src",o),oe(v,"alt","logo"),oe(v,"height","40"),oe(v,"class","accordion-dept-logo"),oe(_,"class","accordion-button-title"),oe(f,"class","accordion-button collapsed"),oe(f,"type","button"),oe(f,"data-bs-toggle","collapse"),oe(f,"data-bs-target",M="#panelsStayOpen-collapse"+h[0]),oe(f,"aria-expanded","false"),oe(f,"aria-controls",F="panelsStayOpen-collapse"+h[0]),oe(d,"class","accordion-header"),oe(d,"id",R="panelsStayOpen-heading"+h[0]),oe(Je,"class","accordion-button-title-sub"),oe(It,"class","grid mt svelte-1jaw0n6"),Uu(()=>h[11].call(It)),oe(ne,"class","accordion-body"),oe(H,"id",_t="panelsStayOpen-collapse"+h[0]),oe(H,"class","accordion-collapse collapse"),oe(H,"aria-labelledby",ht="panelsStayOpen-heading"+h[0]),oe(c,"class","accordion-item")},m(pt,At){Re(pt,c,At),Te(c,d),Te(d,f),Te(f,_),Te(_,v),Te(_,z),Te(_,T),Te(c,D),Te(c,H),Te(H,ne),Te(ne,he),Te(ne,ve),Te(ne,xe),Te(ne,ot),Te(ne,Je),Te(Je,Le),Te(ne,Ye),Te(ne,It);for(let Ut=0;Ut<zt.length;Ut+=1)zt[Ut]&&zt[Ut].m(It,null);Lt=Vu(It,h[11].bind(It)),Te(ne,jt),qt&&qt.m(ne,null),Ft=!0},p(pt,[At]){if((!Ft||At&2&&!gd(v.src,o=Co+"/img/"+pt[1]))&&oe(v,"src",o),(!Ft||At&4)&&Tr(T,pt[2]),(!Ft||At&1&&M!==(M="#panelsStayOpen-collapse"+pt[0]))&&oe(f,"data-bs-target",M),(!Ft||At&1&&F!==(F="panelsStayOpen-collapse"+pt[0]))&&oe(f,"aria-controls",F),(!Ft||At&1&&R!==(R="panelsStayOpen-heading"+pt[0]))&&oe(d,"id",R),(!Ft||At&16)&&Tr(he,pt[4]),(!Ft||At&8)&&me!==(me=pt[3].name+"")&&Tr(xe,me),(!Ft||At&32)&&Tr(Le,pt[5]),At&1352){yt={length:pt[10].length};let Ut;for(Ut=0;Ut<yt.length;Ut+=1){const cr=Rm(pt,yt,Ut);zt[Ut]?(zt[Ut].p(cr,At),rt(zt[Ut],1)):(zt[Ut]=Bm(cr),zt[Ut].c(),rt(zt[Ut],1),zt[Ut].m(It,null))}for(to(),Ut=yt.length;Ut<zt.length;Ut+=1)et(Ut);ro()}pt[7]!=""?qt?qt.p(pt,At):(qt=Om(pt),qt.c(),qt.m(ne,null)):qt&&(qt.d(1),qt=null),(!Ft||At&1&&_t!==(_t="panelsStayOpen-collapse"+pt[0]))&&oe(H,"id",_t),(!Ft||At&1&&ht!==(ht="panelsStayOpen-heading"+pt[0]))&&oe(H,"aria-labelledby",ht)},i(pt){if(!Ft){for(let At=0;At<yt.length;At+=1)rt(zt[At]);Ft=!0}},o(pt){zt=zt.filter(Boolean);for(let At=0;At<zt.length;At+=1)lt(zt[At]);Ft=!1},d(pt){pt&&ae(c),nn(zt,pt),Lt(),qt&&qt.d()}}}function A1(h,c,d){let{id:f}=c,{img:_}=c,{heading:v}=c,{place:o}=c,{sub_heading:z}=c,{description:T}=c,{boxes:M}=c,{more:F}=c,{chart_compare_type:R}=c,D=Object.keys(M),H;function ne(){H=this.clientWidth,d(9,H)}return h.$$set=he=>{"id"in he&&d(0,f=he.id),"img"in he&&d(1,_=he.img),"heading"in he&&d(2,v=he.heading),"place"in he&&d(3,o=he.place),"sub_heading"in he&&d(4,z=he.sub_heading),"description"in he&&d(5,T=he.description),"boxes"in he&&d(6,M=he.boxes),"more"in he&&d(7,F=he.more),"chart_compare_type"in he&&d(8,R=he.chart_compare_type)},[f,_,v,o,z,T,M,F,R,H,D,ne]}class Pl extends fn{constructor(c){super(),dn(this,c,A1,z1,mn,{id:0,img:1,heading:2,place:3,sub_heading:4,description:5,boxes:6,more:7,chart_compare_type:8})}}function Fm(h,c,d){const f=h.slice();return f[33]=c[d],f[35]=d,f}function Nm(h,c,d){const f=h.slice();return f[36]=c[d],f[35]=d,f}function Um(h,c,d){const f=h.slice();return f[38]=c[d],f}function Vm(h,c,d){const f=h.slice();return f[36]=c[d],f[35]=d,f}function jm(h){let c,d,f,_,v,o,z=" &gt; ",T,M,F,R,D,H=h[0].place.name+"",ne,he,ve,me,xe,ot,Je,Le,Ye,It,Lt,jt,_t,ht,Ft,yt,zt,et,qt,pt,At,Ut,cr,Ve,fr,hr,xr,Fr,wi,sr,Qr,kt,Ur,Tn,$r,Zt,$t,Dr,Pr,Dn,Xr,gi,ci,Ji,Ci,hi,ei,on,pi,Nr,Yi,Ln,Oi,In,Qi,zn,Fi,yn,Ni,Rn,$i,Ui,_n,an;function sn(W,we){return W[0].place.type!="ni"?C1:P1}let gn=sn(h),ni=gn(h);function Cr(W,we){return W[0].place.type=="ni"?D1:M1}let L=Cr(h),N=L(h),V=h[0].place.type!="ni"&&Zm(h);Ft=new J_({props:{search_data:h[0].search_data,group:"typestr",search:!0}}),Ft.$on("select",h[14]),Qr=new bh({props:{id:"overview",i_button:!1,heading:"Overview - box with words",place:h[0].place,style:"line-height: 1.3;",content:{ni:"The population of "+h[0].place.name+" was "+h[0].place.data.population.value[2021].all.toLocaleString()+" at the time of the 2021 Census.",lgd:"The population of "+h[0].place.name+" was "+h[0].place.data.population.value[2021].all.toLocaleString()+" at the time of the 2021 Census.",dea:"The population of "+h[0].place.name+" was "+h[0].place.data.population.value[2021].all.toLocaleString()+" at the time of the 2021 Census."},chart_compare_type:h[9]}}),Ur=new bh({props:{id:"pop",place:h[0].place,content:'<span class="text-big" style="font-size: 2.8em;">'+h[0].place.data.population.value[2021].all.toLocaleString()+"</span>",chart_compare_type:h[9]}}),$r=new bh({props:{id:"popden",place:h[0].place,content:'<span class="text-big" style="font-size: 2.8em;">'+h[0].place.data.households.value[2021].all_households.toLocaleString()+"</span>",chart_compare_type:h[9]}});function X(W,we){return W[0].place.type!="ni"?R1:L1}let $=X(h),se=$(h);function pe(W){h[27](W)}let j={location:{bounds:h[0].place.bounds},options:{fitBoundsOptions:{padding:20}},style:Y_,$$slots:{default:[O1]},$$scope:{ctx:h}};h[5]!==void 0&&(j.map=h[5]),gi=new Og({props:j}),Bu.push(()=>eg(gi,"map",pe));let J=h[0].place.parents[0]&&Km(h);function _e(W,we){return W[0].place.children[0]?N1:F1}let Ce=_e(h),Me=Ce(h);return Yi=new Pl({props:{id:"people",img:"nisra-taxonomy-icon-census.png",heading:"People and Households",place:h[0].place,sub_heading:"",description:"",chart_compare_type:h[9],boxes:{box_1:{id:"popchange",content:"<span > population growth/shrink to be added</span>"},box_2:{id:"age",content:"GroupChart",chart_data:{none:h[12](h[0].place.grouped_data_nocompare.age,"age"),prev:h[12](h[0].place.grouped_data_timecompare.age,"age"),ni:h[12](h[0].place.grouped_data_areacompare.age,"age")},zKey:"group",label:h[10],topic_prev_available:"true"},box_3:{id:"sex",content:"<span > sex split to be added</span>"},box_4:{id:"hhsize",content:"GroupChart",chart_data:{none:h[12](h[0].place.grouped_data_nocompare.hh_size,"hh_size"),prev:h[12](h[0].place.grouped_data_timecompare.hh_size,"hh_size"),ni:h[12](h[0].place.grouped_data_areacompare.hh_size,"hh_size")},zKey:"group",label:h[10],topic_prev_available:"true"},box_5:{id:"religion",content:"GroupChart",chart_data:{none:h[12](h[0].place.grouped_data_nocompare.religion_or_religion_brought_up_in,"religion_or_religion_brought_up_in"),prev:h[12](h[0].place.grouped_data_timecompare.religion_or_religion_brought_up_in,"religion_or_religion_brought_up_in"),ni:h[12](h[0].place.grouped_data_areacompare.religion_or_religion_brought_up_in,"religion_or_religion_brought_up_in")},zKey:"group",label:h[10],topic_prev_available:"true"},box_6:{id:"language",content:"GroupChart",chart_data:{none:h[12](h[0].place.grouped_data_nocompare.mainlang,"mainlang"),prev:h[12](h[0].place.grouped_data_timecompare.mainlang,"mainlang"),ni:h[12](h[0].place.grouped_data_areacompare.mainlang,"mainlang")},zKey:"group",label:h[10],topic_prev_available:"true"}},more:`More information on the size of the population is available in the latest <a href='https://www.nisra.gov.uk/publications/2022-mid-year-population-estimates-northern-ireland'>mid-year estimates release</a>, \r
					which includes an <a href='https://www.nisra.gov.uk/system/files/statistics/MYE22-summary.pdf'>infographic</a>, \r
					<a href='https://www.nisra.gov.uk/system/files/statistics/MYE22-Factsheets.pdf'>Fact Sheets</a>, \r
					a <a href='https://www.nisra.gov.uk/system/files/statistics/Statistical%20Bulletin%20-%202022%20Mid-year%20Population%20Estimates%20for%20Northern%20Ireland.pdf'>publication</a> \r
					and statistical tables. Population characteristics are from the census data which can be explored further in the <a href='https://explore.nisra.gov.uk/area-explorer-2021/N92000002/'>Census Area Explorer</a>, \r
					bespoke tables can be created using the <a href='https://build.nisra.gov.uk/en/'>Flexible Table Builder</a> and the NISRA website has \r
					<a href='https://www.nisra.gov.uk/publications/census-2021-statistical-bulletins'>statistical bulletins</a> providing commentary on a range of census population characteristics.\r
					`}}),Oi=new Pl({props:{id:"health",img:"nisra-taxonomy-icon-health.png",heading:"Health and Social Care",place:h[0].place,sub_heading:"Health",description:"xxxx",chart_compare_type:h[9],boxes:{box_1:{id:"generalhealth",content:"StackedBarChart",chart_data:h[0].place&&h[11](["general_health"],["2011"],["2021"]),zKey:h[9],label:h[10],topic_prev_available:"true"},box_2:{id:"wellbeing",content:"<p><span class='text-big' style='font-size: 2.8em'>7.5</span> / 10 </p>"},box_3:{id:"lifeexpectancy",content:"<p>Males <span class='text-big' style='font-size: 1.8em'>78.6 years</span></p><p>Female <span class='text-big' style='font-size: 1.8em'>82.7 years</span></p>"},box_4:{id:"carers",content:"GroupChart",chart_data:{none:h[12](h[0].place.grouped_data_nocompare.provision_care,"provision_care"),prev:h[12](h[0].place.grouped_data_timecompare.provision_care,"provision_care"),ni:h[12](h[0].place.grouped_data_areacompare.provision_care,"provision_care")},zKey:"group",label:h[10],topic_prev_available:"true"},box_5:{id:"hospitalactivity",content:"<span > hospital activity to be added</span>"},box_6:{id:"primarycare",content:"<span > primary care to be added</span>"}},more:`<p>Significant volumes of information are prepared by the <a href='https://www.health-ni.gov.uk/topics/doh-statistics-and-research'>Department of Health</a> \r
			and the <a href='https://bso.hscni.net/directorates/operations/family-practitioner-services/directorates-operations-family-practitioner-services-information-unit/general-ophthalmic-services-statistics/'>\r
				Business Services Organisation</a>, including statistics on <a href='https://www.health-ni.gov.uk/topics/dhssps-statistics-and-research/health-inequalities-statistics'>Health inequalities</a>, \r
				Primary care (including <a href='https://bso.hscni.net/directorates/operations/family-practitioner-services/directorates-operations-family-practitioner-services-information-unit/1776-2/'>Medical</a>, \r
				<a href='https://bso.hscni.net/directorates/operations/family-practitioner-services/directorates-operations-family-practitioner-services-information-unit/general-dental-services-statistics/'>Dental</a>, \r
				<a href='https://bso.hscni.net/directorates/operations/family-practitioner-services/directorates-operations-family-practitioner-services-information-unit/general-pharmaceutical-services-and-prescribing-statistics/'>\r
				Pharmaceutical</a> and <a href='https://bso.hscni.net/directorates/operations/family-practitioner-services/directorates-operations-family-practitioner-services-information-unit/general-ophthalmic-services-statistics/'>\r
				Ophthalmic</a>), <a href='https://www.health-ni.gov.uk/topics/dhssps-statistics-and-research/family-health-services-statistics'>\r
				Family health services</a>, <a href='https://www.health-ni.gov.uk/topics/doh-statistics-and-research-mental-health-and-learning-disabilities/mental-health-learning-disability-and-autism-statistics'>\r
				Mental health, learning disability and autism</a>, <a href='https://www.health-ni.gov.uk/topics/dhssps-statistics-and-research-social-services/social-care-statistics'>\r
				Social care</a>, <a href='https://www.health-ni.gov.uk/topics/dhssps-statistics-and-research/workforce-statistics'>Workforce</a>, and <u>COVID-19</u>.\r
				A number of <a href='https://visual.nisra.gov.uk/?body=entity/health'>interactive dashboards</a> are available and a compendium dashboard for <a href='https://visual.nisra.gov.uk/?body=entity/las'>\r
				Making Life Better</a>.\r
				The <a href='https://www.nisra.gov.uk/statistics/census'>2021 census</a> collected data on general health, long-term conditions and carers which can \r
				be explored in the <a href='https://explore.nisra.gov.uk/area-explorer-2021/N92000002/'>Census Area Explorer</a> and the <a href='https://build.nisra.gov.uk/en/'>Flexible Table Builder</a>.</p><p></p>`}}),Qi=new Pl({props:{id:"work",img:"nisra-taxonomy-icon-labour-market.png",heading:"Work and Welfare",place:h[0].place,sub_heading:"Work and welfare",description:"xxxx",chart_compare_type:h[9],boxes:{box_1:{id:"employmentrates",content:"<span > employment to be added</span>"},box_2:{id:"employed",content:"<span > numbers employed to be added</span>"},box_3:{id:"wages",content:"<p><span class='text-big' style='font-size: 1.8em'>£26,531</span> annual median salary</p>"},box_4:{id:"benefits",content:"<span > benefits claimants to be added</span>"}},more:`<p>The monthly <a href='https://www.nisra.gov.uk/statistics/labour-market-and-social-welfare/labour-market-overview'>Labour Market Report</a>\r
			 contains the most up to date labour market statistics. The <a href='https://www.nisra.gov.uk/statistics/labour-market-and-social-welfare/annual-survey-hours-and-earnings'>\r
				Annual Survey of Hours and Earnings</a> providesdata on hourly, weekly and annual earnings. The <a href='https://www.nisra.gov.uk/statistics/labour-market-and-social-welfare/quarterly-employment-survey'>\r
					Quarterly Employment Survey</a> provides short-term employee jobs estimates for NI. Further information is available for the \r
					unemployed <a href='https://www.nisra.gov.uk/statistics/labour-market-and-social-welfare/claimant-count'>Claimant Count</a>, \r
					claimant numbers for <a href='https://www.nisra.gov.uk/statistics/labour-market-and-social-welfare/disability-benefits'>Disability Benefits</a>, \r
					and <a href='https://www.nisra.gov.uk/statistics/labour-market-and-social-welfare/work-related-benefits'>Work Related Benefits</a>. \r
					Statistics on <a href='https://www.nisra.gov.uk/statistics/labour-market-and-social-welfare/redundancies'>Redundancies</a> \r
					and <a href='https://www.nisra.gov.uk/statistics/labour-market-and-social-welfare/job-vacancies'>Job Vacancies</a> are also available. \r
					A number of <a href='https://visual.nisra.gov.uk/?body=entity/lm'>interactive dashboards</a> are available. \r
					The <a href='https://www.nisra.gov.uk/statistics/census'>2021 census</a> collected data on occupations, industry and number of hours worked which can be \r
					explored in the <a href='https://explore.nisra.gov.uk/area-explorer-2021/N92000002/'>Census Area Explorer</a> and the <a href='https://build.nisra.gov.uk/en/'>Flexible Table Builder</a>.</p>`}}),Fi=new Pl({props:{id:"education",img:"nisra-taxonomy-icon-child-education-skills.png",heading:"Education",place:h[0].place,sub_heading:"Schools, colleges and universities",description:"",chart_compare_type:h[9],boxes:{box_1:{id:"enrollments",content:"<p>Primary school <span class='text-big' style='font-size: 1.2em'>500 </span></p><p>Secondary school <span class='text-big' style='font-size: 1.2em'>320 </span></p><p>Further education colleges <span class='text-big' style='font-size: 1.2em'>45 </span></p><p>University <span class='text-big' style='font-size: 1.2em'>200 </span></p>"},box_2:{id:"fsme",content:"<p>Primary school <span class='text-big' style='font-size: 1.8em'>33.2%</span></p><p>Secondary school <span class='text-big' style='font-size: 1.8em'>25.2%</span></p>"},box_3:{id:"teachers",content:"<span > teachers to be added</span>"},box_4:{id:"qualifications",content:"GroupChart",chart_data:{none:h[12](h[0].place.grouped_data_nocompare.highest_level_of_qualifications,"highest_level_of_qualifications"),prev:h[12](h[0].place.grouped_data_timecompare.highest_level_of_qualifications,"highest_level_of_qualifications"),ni:h[12](h[0].place.grouped_data_areacompare.highest_level_of_qualifications,"highest_level_of_qualifications")},zKey:"group",label:h[10],topic_prev_available:"true"},box_5:{id:"attainment",content:"<span > attainment to be added</span>"}},more:"<p>The <a href='https://www.nisra.gov.uk/statistics/children-education-and-skills/school-education-statistics'>Department of Education</a> publishes statistics on <a href='https://www.education-ni.gov.uk/articles/school-enrolments-overview'>school enrolments</a>, <a href='https://www.education-ni.gov.uk/articles/school-performance'>school performance</a>, <a href='https://www.education-ni.gov.uk/articles/school-leavers'>school leavers</a>, qualifications and destinations, <a href='https://www.education-ni.gov.uk/articles/pupil-attendance'>pupil attendance</a>, suspensions and expulsions, school meals and <a href='https://www.education-ni.gov.uk/articles/education-workforce'>education workforce</a>. The <a href='https://www.nisra.gov.uk/statistics/children-education-and-skills/higher-and-further-education-and-training-statistics'>Department for the Economy</a> publishes <a href='https://www.economy-ni.gov.uk/topics/statistics-and-economic-research/higher-education-statistics-and-research'>Higher</a> and <a href='https://www.economy-ni.gov.uk/topics/statistics-and-economic-research/further-education-statistics-and-research'>Further</a> education and <a href='https://www.economy-ni.gov.uk/articles/training-success-statistics'>training</a> statistics. The <a href='https://www.nisra.gov.uk/statistics/census'>2021 census</a> collected data on qualifications which can be explored in the <a href='https://explore.nisra.gov.uk/area-explorer-2021/N92000002/'>Census Area Explorer</a> and the <a href='https://build.nisra.gov.uk/en/'>Flexible Table Builder</a>.</p>"}}),Ni=new Pl({props:{id:"crime",img:"nisra-taxonomy-icon-crime-justice.png",heading:"Crime and Justice",place:h[0].place,sub_heading:"Crime and court activity",description:"xxxx",chart_compare_type:h[9],boxes:{},more:""}}),$i=new Pl({props:{id:"travel",img:"nisra-taxonomy-icon-travel-transport.png",heading:"Travel and Transport",place:h[0].place,sub_heading:"Travel and transport .... ",description:"xxxx",chart_compare_type:h[9],boxes:{},more:""}}),{c(){c=Fe("div"),d=Fe("div"),f=Fe("span"),_=Fe("a"),v=Et("Home"),o=new Zu(!1),T=dt(),ni.c(),M=dt(),F=Fe("br"),R=dt(),D=Fe("span"),ne=Et(H),he=dt(),ve=Fe("div"),me=Et(`Click for:\r
\r
					`),N.c(),xe=dt(),V&&V.c(),ot=dt(),Je=Fe("button"),Le=Et("Same area - previous"),Ye=dt(),It=Fe("div"),Lt=Fe("div"),jt=Fe("b"),_t=Et("Search for your area:"),ht=dt(),ir(Ft.$$.fragment),yt=dt(),zt=Fe("script"),et=Et(`// Share button\r
						// Possible tooltip: https://stackoverflow.com/questions/37798967/tooltip-on-click-of-a-button\r
\r
						function copyToClipboard(text) {\r
							var inputc = document.body.appendChild(\r
								document.createElement("input"),\r
							);\r
							inputc.value = window.location.href;\r
							inputc.select();\r
							document.execCommand("copy");\r
							inputc.parentNode.removeChild(inputc);\r
							alert("URL Copied.");\r
						}\r
\r
						(function (win, doc) {\r
							const testButton = doc.createElement("button");\r
							testButton.setAttribute("type", "share");\r
							if (testButton.type != "share") {\r
								win.addEventListener("click", function (ev) {\r
									ev = ev || win.event;\r
									let target = ev.target;\r
									let button = target.closest(\r
										'button[type="share"]',\r
									);\r
									if (button) {\r
										const title = "Share URL";\r
										const url = win.location.href;\r
										if (navigator.share) {\r
											navigator.share({\r
												title: title,\r
												url: url,\r
											});\r
										} else {\r
											copyToClipboard();\r
										}\r
									}\r
								});\r
							}\r
						})(this, this.document);`),qt=dt(),pt=Fe("div"),At=Fe("button"),Ut=Et("Print / PDF"),cr=dt(),Ve=Fe("button"),fr=Et("Menu"),hr=dt(),xr=Fe("button"),Fr=Et("Share"),wi=dt(),sr=Fe("div"),ir(Qr.$$.fragment),kt=dt(),ir(Ur.$$.fragment),Tn=dt(),ir($r.$$.fragment),Zt=dt(),$t=Fe("div"),Dr=Fe("div"),Pr=Fe("h3"),se.c(),Dn=dt(),Xr=Fe("div"),ir(gi.$$.fragment),Ji=dt(),Ci=Fe("div"),J&&J.c(),hi=dt(),ei=Fe("div"),Me.c(),pi=dt(),Nr=Fe("div"),ir(Yi.$$.fragment),Ln=dt(),ir(Oi.$$.fragment),In=dt(),ir(Qi.$$.fragment),zn=dt(),ir(Fi.$$.fragment),yn=dt(),ir(Ni.$$.fragment),Rn=dt(),ir($i.$$.fragment),this.h()},l(W){c=Ne(W,"DIV",{class:!0});var we=Be(c);d=Ne(we,"DIV",{});var $e=Be(d);f=Ne($e,"SPAN",{class:!0});var Xe=Be(f);_=Ne(Xe,"A",{href:!0,"sveltekit:noscroll":!0,class:!0});var Se=Be(_);v=Tt(Se,"Home"),Se.forEach(ae),o=Gu(Xe,!1),T=mt(Xe),ni.l(Xe),M=mt(Xe),Xe.forEach(ae),F=Ne($e,"BR",{}),R=mt($e),D=Ne($e,"SPAN",{class:!0});var We=Be(D);ne=Tt(We,H),We.forEach(ae),he=mt($e),ve=Ne($e,"DIV",{class:!0,style:!0});var Oe=Be(ve);me=Tt(Oe,`Click for:\r
\r
					`),N.l(Oe),xe=mt(Oe),V&&V.l(Oe),ot=mt(Oe),Je=Ne(Oe,"BUTTON",{class:!0});var je=Be(Je);Le=Tt(je,"Same area - previous"),je.forEach(ae),Oe.forEach(ae),$e.forEach(ae),Ye=mt(we),It=Ne(we,"DIV",{});var Mt=Be(It);Lt=Ne(Mt,"DIV",{style:!0,class:!0});var qe=Be(Lt);jt=Ne(qe,"B",{});var Vt=Be(jt);_t=Tt(Vt,"Search for your area:"),Vt.forEach(ae),ht=mt(qe),nr(Ft.$$.fragment,qe),yt=mt(qe),zt=Ne(qe,"SCRIPT",{});var lr=Be(zt);et=Tt(lr,`// Share button\r
						// Possible tooltip: https://stackoverflow.com/questions/37798967/tooltip-on-click-of-a-button\r
\r
						function copyToClipboard(text) {\r
							var inputc = document.body.appendChild(\r
								document.createElement("input"),\r
							);\r
							inputc.value = window.location.href;\r
							inputc.select();\r
							document.execCommand("copy");\r
							inputc.parentNode.removeChild(inputc);\r
							alert("URL Copied.");\r
						}\r
\r
						(function (win, doc) {\r
							const testButton = doc.createElement("button");\r
							testButton.setAttribute("type", "share");\r
							if (testButton.type != "share") {\r
								win.addEventListener("click", function (ev) {\r
									ev = ev || win.event;\r
									let target = ev.target;\r
									let button = target.closest(\r
										'button[type="share"]',\r
									);\r
									if (button) {\r
										const title = "Share URL";\r
										const url = win.location.href;\r
										if (navigator.share) {\r
											navigator.share({\r
												title: title,\r
												url: url,\r
											});\r
										} else {\r
											copyToClipboard();\r
										}\r
									}\r
								});\r
							}\r
						})(this, this.document);`),lr.forEach(ae),qt=mt(qe),pt=Ne(qe,"DIV",{width:!0});var Pt=Be(pt);At=Ne(Pt,"BUTTON",{class:!0,style:!0,title:!0,onclick:!0});var er=Be(At);Ut=Tt(er,"Print / PDF"),er.forEach(ae),cr=mt(Pt),Ve=Ne(Pt,"BUTTON",{class:!0,style:!0,alt:!0,onclick:!0});var Ht=Be(Ve);fr=Tt(Ht,"Menu"),Ht.forEach(ae),hr=mt(Pt),xr=Ne(Pt,"BUTTON",{class:!0,style:!0,type:!0,alt:!0});var ti=Be(xr);Fr=Tt(ti,"Share"),ti.forEach(ae),Pt.forEach(ae),qe.forEach(ae),Mt.forEach(ae),we.forEach(ae),wi=mt(W),sr=Ne(W,"DIV",{id:!0,class:!0});var Qt=Be(sr);nr(Qr.$$.fragment,Qt),kt=mt(Qt),nr(Ur.$$.fragment,Qt),Tn=mt(Qt),nr($r.$$.fragment,Qt),Qt.forEach(ae),Zt=mt(W),$t=Ne(W,"DIV",{class:!0});var vr=Be($t);Dr=Ne(vr,"DIV",{style:!0});var dr=Be(Dr);Pr=Ne(dr,"H3",{class:!0});var Gt=Be(Pr);se.l(Gt),Gt.forEach(ae),dr.forEach(ae),Dn=mt(vr),Xr=Ne(vr,"DIV",{id:!0,style:!0,class:!0});var tr=Be(Xr);nr(gi.$$.fragment,tr),tr.forEach(ae),Ji=mt(vr),Ci=Ne(vr,"DIV",{});var oi=Be(Ci);J&&J.l(oi),oi.forEach(ae),hi=mt(vr),ei=Ne(vr,"DIV",{});var Bn=Be(ei);Me.l(Bn),Bn.forEach(ae),vr.forEach(ae),pi=mt(W),Nr=Ne(W,"DIV",{class:!0,id:!0});var wr=Be(Nr);nr(Yi.$$.fragment,wr),Ln=mt(wr),nr(Oi.$$.fragment,wr),In=mt(wr),nr(Qi.$$.fragment,wr),zn=mt(wr),nr(Fi.$$.fragment,wr),yn=mt(wr),nr(Ni.$$.fragment,wr),Rn=mt(wr),nr($i.$$.fragment,wr),wr.forEach(ae),this.h()},h(){oe(_,"href",Co+"/"),oe(_,"sveltekit:noscroll",""),oe(_,"class","svelte-142gsi4"),o.a=T,oe(f,"class","text-small"),oe(D,"class","text-big title svelte-142gsi4"),oe(Je,"class","btn svelte-142gsi4"),Xn(Je,"btn-active",h[2]&!h[3]&!h[8]),oe(ve,"class","text-bold"),Ge(ve,"font-size","0.85em"),oe(At,"class","btn svelte-142gsi4"),Ge(At,"width","33%"),oe(At,"title","Click to print this page to pdf or printer"),oe(At,"onclick","window.print();return false;"),oe(Ve,"class","btn svelte-142gsi4"),Ge(Ve,"width","33%"),oe(Ve,"alt","Return to the landing page"),oe(Ve,"onclick","window.location.href='"+Co+"';"),oe(xr,"class","btn svelte-142gsi4"),Ge(xr,"width","30%"),oe(xr,"type","share"),oe(xr,"alt","Share this page"),oe(pt,"width","100%"),Ge(Lt,"width","350px"),Ge(Lt,"padding-top","5px"),oe(Lt,"class","svelte-142gsi4"),Xn(Lt,"float-right",h[4]>1),oe(c,"class","grid mtl svelte-142gsi4"),oe(sr,"id","grid"),oe(sr,"class","grid mt svelte-142gsi4"),oe(Pr,"class","svelte-142gsi4"),Ge(Dr,"grid-column","span "+h[4]),oe(Xr,"id","map"),Ge(Xr,"padding-right","45px"),Ge(Xr,"grid-column","span "+(h[4]==2?2:h[4]&&h[4]>2?h[4]-1:1)),oe(Xr,"class","svelte-142gsi4"),oe($t,"class","grid mt svelte-142gsi4"),Uu(()=>h[28].call($t)),oe(Nr,"class","accordion"),oe(Nr,"id","accordionPanelsStayOpenExample")},m(W,we){Re(W,c,we),Te(c,d),Te(d,f),Te(f,_),Te(_,v),o.m(z,f),Te(f,T),ni.m(f,null),Te(f,M),Te(d,F),Te(d,R),Te(d,D),Te(D,ne),Te(d,he),Te(d,ve),Te(ve,me),N.m(ve,null),Te(ve,xe),V&&V.m(ve,null),Te(ve,ot),Te(ve,Je),Te(Je,Le),Te(c,Ye),Te(c,It),Te(It,Lt),Te(Lt,jt),Te(jt,_t),Te(Lt,ht),or(Ft,Lt,null),Te(Lt,yt),Te(Lt,zt),Te(zt,et),Te(Lt,qt),Te(Lt,pt),Te(pt,At),Te(At,Ut),Te(pt,cr),Te(pt,Ve),Te(Ve,fr),Te(pt,hr),Te(pt,xr),Te(xr,Fr),Re(W,wi,we),Re(W,sr,we),or(Qr,sr,null),Te(sr,kt),or(Ur,sr,null),Te(sr,Tn),or($r,sr,null),Re(W,Zt,we),Re(W,$t,we),Te($t,Dr),Te(Dr,Pr),se.m(Pr,null),Te($t,Dn),Te($t,Xr),or(gi,Xr,null),Te($t,Ji),Te($t,Ci),J&&J.m(Ci,null),Te($t,hi),Te($t,ei),Me.m(ei,null),on=Vu($t,h[28].bind($t)),Re(W,pi,we),Re(W,Nr,we),or(Yi,Nr,null),Te(Nr,Ln),or(Oi,Nr,null),Te(Nr,In),or(Qi,Nr,null),Te(Nr,zn),or(Fi,Nr,null),Te(Nr,yn),or(Ni,Nr,null),Te(Nr,Rn),or($i,Nr,null),Ui=!0,_n||(an=[ho(Je,"click",h[24]),ho(Je,"click",h[25]),ho(Je,"click",h[26])],_n=!0)},p(W,we){gn===(gn=sn(W))&&ni?ni.p(W,we):(ni.d(1),ni=gn(W),ni&&(ni.c(),ni.m(f,M))),(!Ui||we[0]&1)&&H!==(H=W[0].place.name+"")&&Tr(ne,H),L===(L=Cr(W))&&N?N.p(W,we):(N.d(1),N=L(W),N&&(N.c(),N.m(ve,xe))),W[0].place.type!="ni"?V?V.p(W,we):(V=Zm(W),V.c(),V.m(ve,ot)):V&&(V.d(1),V=null),(!Ui||we[0]&268)&&Xn(Je,"btn-active",W[2]&!W[3]&!W[8]);const $e={};we[0]&1&&($e.search_data=W[0].search_data),Ft.$set($e),(!Ui||we[0]&16)&&Xn(Lt,"float-right",W[4]>1);const Xe={};we[0]&1&&(Xe.place=W[0].place),we[0]&1&&(Xe.content={ni:"The population of "+W[0].place.name+" was "+W[0].place.data.population.value[2021].all.toLocaleString()+" at the time of the 2021 Census.",lgd:"The population of "+W[0].place.name+" was "+W[0].place.data.population.value[2021].all.toLocaleString()+" at the time of the 2021 Census.",dea:"The population of "+W[0].place.name+" was "+W[0].place.data.population.value[2021].all.toLocaleString()+" at the time of the 2021 Census."}),we[0]&512&&(Xe.chart_compare_type=W[9]),Qr.$set(Xe);const Se={};we[0]&1&&(Se.place=W[0].place),we[0]&1&&(Se.content='<span class="text-big" style="font-size: 2.8em;">'+W[0].place.data.population.value[2021].all.toLocaleString()+"</span>"),we[0]&512&&(Se.chart_compare_type=W[9]),Ur.$set(Se);const We={};we[0]&1&&(We.place=W[0].place),we[0]&1&&(We.content='<span class="text-big" style="font-size: 2.8em;">'+W[0].place.data.households.value[2021].all_households.toLocaleString()+"</span>"),we[0]&512&&(We.chart_compare_type=W[9]),$r.$set(We),$===($=X(W))&&se?se.p(W,we):(se.d(1),se=$(W),se&&(se.c(),se.m(Pr,null))),(!Ui||we[0]&16)&&Ge(Dr,"grid-column","span "+W[4]);const Oe={};we[0]&1&&(Oe.location={bounds:W[0].place.bounds}),we[0]&192|we[1]&2048&&(Oe.$$scope={dirty:we,ctx:W}),!ci&&we[0]&32&&(ci=!0,Oe.map=W[5],tg(()=>ci=!1)),gi.$set(Oe),(!Ui||we[0]&16)&&Ge(Xr,"grid-column","span "+(W[4]==2?2:W[4]&&W[4]>2?W[4]-1:1)),W[0].place.parents[0]?J?J.p(W,we):(J=Km(W),J.c(),J.m(Ci,null)):J&&(J.d(1),J=null),Ce===(Ce=_e(W))&&Me?Me.p(W,we):(Me.d(1),Me=Ce(W),Me&&(Me.c(),Me.m(ei,null)));const je={};we[0]&1&&(je.place=W[0].place),we[0]&512&&(je.chart_compare_type=W[9]),we[0]&1025&&(je.boxes={box_1:{id:"popchange",content:"<span > population growth/shrink to be added</span>"},box_2:{id:"age",content:"GroupChart",chart_data:{none:W[12](W[0].place.grouped_data_nocompare.age,"age"),prev:W[12](W[0].place.grouped_data_timecompare.age,"age"),ni:W[12](W[0].place.grouped_data_areacompare.age,"age")},zKey:"group",label:W[10],topic_prev_available:"true"},box_3:{id:"sex",content:"<span > sex split to be added</span>"},box_4:{id:"hhsize",content:"GroupChart",chart_data:{none:W[12](W[0].place.grouped_data_nocompare.hh_size,"hh_size"),prev:W[12](W[0].place.grouped_data_timecompare.hh_size,"hh_size"),ni:W[12](W[0].place.grouped_data_areacompare.hh_size,"hh_size")},zKey:"group",label:W[10],topic_prev_available:"true"},box_5:{id:"religion",content:"GroupChart",chart_data:{none:W[12](W[0].place.grouped_data_nocompare.religion_or_religion_brought_up_in,"religion_or_religion_brought_up_in"),prev:W[12](W[0].place.grouped_data_timecompare.religion_or_religion_brought_up_in,"religion_or_religion_brought_up_in"),ni:W[12](W[0].place.grouped_data_areacompare.religion_or_religion_brought_up_in,"religion_or_religion_brought_up_in")},zKey:"group",label:W[10],topic_prev_available:"true"},box_6:{id:"language",content:"GroupChart",chart_data:{none:W[12](W[0].place.grouped_data_nocompare.mainlang,"mainlang"),prev:W[12](W[0].place.grouped_data_timecompare.mainlang,"mainlang"),ni:W[12](W[0].place.grouped_data_areacompare.mainlang,"mainlang")},zKey:"group",label:W[10],topic_prev_available:"true"}}),Yi.$set(je);const Mt={};we[0]&1&&(Mt.place=W[0].place),we[0]&512&&(Mt.chart_compare_type=W[9]),we[0]&1537&&(Mt.boxes={box_1:{id:"generalhealth",content:"StackedBarChart",chart_data:W[0].place&&W[11](["general_health"],["2011"],["2021"]),zKey:W[9],label:W[10],topic_prev_available:"true"},box_2:{id:"wellbeing",content:"<p><span class='text-big' style='font-size: 2.8em'>7.5</span> / 10 </p>"},box_3:{id:"lifeexpectancy",content:"<p>Males <span class='text-big' style='font-size: 1.8em'>78.6 years</span></p><p>Female <span class='text-big' style='font-size: 1.8em'>82.7 years</span></p>"},box_4:{id:"carers",content:"GroupChart",chart_data:{none:W[12](W[0].place.grouped_data_nocompare.provision_care,"provision_care"),prev:W[12](W[0].place.grouped_data_timecompare.provision_care,"provision_care"),ni:W[12](W[0].place.grouped_data_areacompare.provision_care,"provision_care")},zKey:"group",label:W[10],topic_prev_available:"true"},box_5:{id:"hospitalactivity",content:"<span > hospital activity to be added</span>"},box_6:{id:"primarycare",content:"<span > primary care to be added</span>"}}),Oi.$set(Mt);const qe={};we[0]&1&&(qe.place=W[0].place),we[0]&512&&(qe.chart_compare_type=W[9]),Qi.$set(qe);const Vt={};we[0]&1&&(Vt.place=W[0].place),we[0]&512&&(Vt.chart_compare_type=W[9]),we[0]&1025&&(Vt.boxes={box_1:{id:"enrollments",content:"<p>Primary school <span class='text-big' style='font-size: 1.2em'>500 </span></p><p>Secondary school <span class='text-big' style='font-size: 1.2em'>320 </span></p><p>Further education colleges <span class='text-big' style='font-size: 1.2em'>45 </span></p><p>University <span class='text-big' style='font-size: 1.2em'>200 </span></p>"},box_2:{id:"fsme",content:"<p>Primary school <span class='text-big' style='font-size: 1.8em'>33.2%</span></p><p>Secondary school <span class='text-big' style='font-size: 1.8em'>25.2%</span></p>"},box_3:{id:"teachers",content:"<span > teachers to be added</span>"},box_4:{id:"qualifications",content:"GroupChart",chart_data:{none:W[12](W[0].place.grouped_data_nocompare.highest_level_of_qualifications,"highest_level_of_qualifications"),prev:W[12](W[0].place.grouped_data_timecompare.highest_level_of_qualifications,"highest_level_of_qualifications"),ni:W[12](W[0].place.grouped_data_areacompare.highest_level_of_qualifications,"highest_level_of_qualifications")},zKey:"group",label:W[10],topic_prev_available:"true"},box_5:{id:"attainment",content:"<span > attainment to be added</span>"}}),Fi.$set(Vt);const lr={};we[0]&1&&(lr.place=W[0].place),we[0]&512&&(lr.chart_compare_type=W[9]),Ni.$set(lr);const Pt={};we[0]&1&&(Pt.place=W[0].place),we[0]&512&&(Pt.chart_compare_type=W[9]),$i.$set(Pt)},i(W){Ui||(rt(Ft.$$.fragment,W),rt(Qr.$$.fragment,W),rt(Ur.$$.fragment,W),rt($r.$$.fragment,W),rt(gi.$$.fragment,W),rt(Yi.$$.fragment,W),rt(Oi.$$.fragment,W),rt(Qi.$$.fragment,W),rt(Fi.$$.fragment,W),rt(Ni.$$.fragment,W),rt($i.$$.fragment,W),Ui=!0)},o(W){lt(Ft.$$.fragment,W),lt(Qr.$$.fragment,W),lt(Ur.$$.fragment,W),lt($r.$$.fragment,W),lt(gi.$$.fragment,W),lt(Yi.$$.fragment,W),lt(Oi.$$.fragment,W),lt(Qi.$$.fragment,W),lt(Fi.$$.fragment,W),lt(Ni.$$.fragment,W),lt($i.$$.fragment,W),Ui=!1},d(W){W&&ae(c),ni.d(),N.d(),V&&V.d(),ar(Ft),W&&ae(wi),W&&ae(sr),ar(Qr),ar(Ur),ar($r),W&&ae(Zt),W&&ae($t),se.d(),ar(gi),J&&J.d(),Me.d(),on(),W&&ae(pi),W&&ae(Nr),ar(Yi),ar(Oi),ar(Qi),ar(Fi),ar(Ni),ar($i),_n=!1,qu(an)}}}function P1(h){let c=h[0].place.name+"",d;return{c(){d=Et(c)},l(f){d=Tt(f,c)},m(f,_){Re(f,d,_)},p(f,_){_[0]&1&&c!==(c=f[0].place.name+"")&&Tr(d,c)},d(f){f&&ae(d)}}}function C1(h){let c,d=h[0].place.name+"",f,_=[...h[0].place.parents].reverse(),v=[];for(let o=0;o<_.length;o+=1)v[o]=qm(Vm(h,_,o));return{c(){for(let o=0;o<v.length;o+=1)v[o].c();c=dt(),f=Et(d)},l(o){for(let z=0;z<v.length;z+=1)v[z].l(o);c=mt(o),f=Tt(o,d)},m(o,z){for(let T=0;T<v.length;T+=1)v[T]&&v[T].m(o,z);Re(o,c,z),Re(o,f,z)},p(o,z){if(z[0]&1){_=[...o[0].place.parents].reverse();let T;for(T=0;T<_.length;T+=1){const M=Vm(o,_,T);v[T]?v[T].p(M,z):(v[T]=qm(M),v[T].c(),v[T].m(c.parentNode,c))}for(;T<v.length;T+=1)v[T].d(1);v.length=_.length}z[0]&1&&d!==(d=o[0].place.name+"")&&Tr(f,d)},d(o){nn(v,o),o&&ae(c),o&&ae(f)}}}function qm(h){let c,d=h[36].name+"",f,_,v,o=" &gt; ",z;return{c(){c=Fe("a"),f=Et(d),v=new Zu(!1),z=br(),this.h()},l(T){c=Ne(T,"A",{href:!0,"sveltekit:noscroll":!0,class:!0});var M=Be(c);f=Tt(M,d),M.forEach(ae),v=Gu(T,!1),z=br(),this.h()},h(){oe(c,"href",_=Co+"/"+h[36].code+"/"),oe(c,"sveltekit:noscroll",""),oe(c,"class","svelte-142gsi4"),v.a=z},m(T,M){Re(T,c,M),Te(c,f),v.m(o,T,M),Re(T,z,M)},p(T,M){M[0]&1&&d!==(d=T[36].name+"")&&Tr(f,d),M[0]&1&&_!==(_=Co+"/"+T[36].code+"/")&&oe(c,"href",_)},d(T){T&&ae(c),T&&ae(z),T&&v.d()}}}function M1(h){let c,d,f,_;return{c(){c=Fe("button"),d=Et("No comparison"),this.h()},l(v){c=Ne(v,"BUTTON",{class:!0});var o=Be(c);d=Tt(o,"No comparison"),o.forEach(ae),this.h()},h(){oe(c,"class","btn svelte-142gsi4"),Xn(c,"btn-active",h[3])},m(v,o){Re(v,c,o),Te(c,d),f||(_=[ho(c,"click",h[18]),ho(c,"click",h[19]),ho(c,"click",h[20])],f=!0)},p(v,o){o[0]&8&&Xn(c,"btn-active",v[3])},d(v){v&&ae(c),f=!1,qu(_)}}}function D1(h){let c,d,f,_;return{c(){c=Fe("button"),d=Et("No comparison"),this.h()},l(v){c=Ne(v,"BUTTON",{class:!0});var o=Be(c);d=Tt(o,"No comparison"),o.forEach(ae),this.h()},h(){oe(c,"class","btn svelte-142gsi4"),Xn(c,"btn-active",!h[2])},m(v,o){Re(v,c,o),Te(c,d),f||(_=[ho(c,"click",h[15]),ho(c,"click",h[16]),ho(c,"click",h[17])],f=!0)},p(v,o){o[0]&4&&Xn(c,"btn-active",!v[2])},d(v){v&&ae(c),f=!1,qu(_)}}}function Zm(h){let c,d,f,_;return{c(){c=Fe("button"),d=Et("NI compare"),this.h()},l(v){c=Ne(v,"BUTTON",{class:!0});var o=Be(c);d=Tt(o,"NI compare"),o.forEach(ae),this.h()},h(){oe(c,"class","btn svelte-142gsi4"),Xn(c,"btn-active",h[8]&!h[3]&!h[2])},m(v,o){Re(v,c,o),Te(c,d),f||(_=[ho(c,"click",h[21]),ho(c,"click",h[22]),ho(c,"click",h[23])],f=!0)},p(v,o){o[0]&268&&Xn(c,"btn-active",v[8]&!v[3]&!v[2])},d(v){v&&ae(c),f=!1,qu(_)}}}function L1(h){let c,d,f=h[0].place.name+"",_;return{c(){c=Et("Explore "),d=Fe("span"),_=Et(f),this.h()},l(v){c=Tt(v,"Explore "),d=Ne(v,"SPAN",{style:!0});var o=Be(d);_=Tt(o,f),o.forEach(ae),this.h()},h(){Ge(d,"color","#3878c5")},m(v,o){Re(v,c,o),Re(v,d,o),Te(d,_)},p(v,o){o[0]&1&&f!==(f=v[0].place.name+"")&&Tr(_,f)},d(v){v&&ae(c),v&&ae(d)}}}function R1(h){let c,d,f=h[0].place.name+"",_,v,o,z=No[h[0].place.type].name+"",T;return{c(){c=Et(`Explore \r
					`),d=Fe("span"),_=Et(f),v=dt(),o=Fe("span"),T=Et(z),this.h()},l(M){c=Tt(M,`Explore \r
					`),d=Ne(M,"SPAN",{style:!0});var F=Be(d);_=Tt(F,f),F.forEach(ae),v=mt(M),o=Ne(M,"SPAN",{style:!0});var R=Be(o);T=Tt(R,z),R.forEach(ae),this.h()},h(){Ge(d,"color","#3878c5"),Ge(o,"color","#00205b")},m(M,F){Re(M,c,F),Re(M,d,F),Te(d,_),Re(M,v,F),Re(M,o,F),Te(o,T)},p(M,F){F[0]&1&&f!==(f=M[0].place.name+"")&&Tr(_,f),F[0]&1&&z!==(z=No[M[0].place.type].name+"")&&Tr(T,z)},d(M){M&&ae(c),M&&ae(d),M&&ae(v),M&&ae(o)}}}function B1(h){let c,d,f,_,v,o,z;const T=[rs[h[38]],{id:h[38]+"-fill"},{type:"fill"},{isChild:h[7][h[38]]},{click:!0},{selected:h[6].selected},{highlight:!0},{highlighted:h[6].highlighted},{hover:!0},{hovered:h[6].hovered},{layout:{visibility:h[6].type==h[38]||h[6].childType==h[38]?"visible":"none"}},{paint:h[6].type==h[38]?Hi["fill-self"]:h[6].childType==h[38]?Hi["fill-child"]:Hi.fill}];let M={};for(let ne=0;ne<T.length;ne+=1)M=dh(M,T[ne]);c=new Ip({props:M}),c.$on("select",h[13]);const F=[rs[h[38]],{id:h[38]+"-bounds"},{type:"line"},{selected:h[6].selected},{highlight:!0},{highlighted:h[6].highlighted},{layout:{visibility:h[6].type==h[38]||h[6].childType==h[38]?"visible":"none"}},{paint:h[6].type==h[38]?Hi["line-active"]:h[6].childType==h[38]?Hi["line-child"]:Hi.line}];let R={};for(let ne=0;ne<F.length;ne+=1)R=dh(R,F[ne]);f=new Ip({props:R});const D=[rs[h[38]],{id:h[38]+"-self"},{type:"line"},{selected:h[6].selected},{layout:{visibility:h[6].type==h[38]?"visible":"none"}},{paint:h[6].type==h[38]?Hi["line-self"]:Hi.line}];let H={};for(let ne=0;ne<D.length;ne+=1)H=dh(H,D[ne]);return v=new Ip({props:H}),{c(){ir(c.$$.fragment),d=dt(),ir(f.$$.fragment),_=dt(),ir(v.$$.fragment),o=dt()},l(ne){nr(c.$$.fragment,ne),d=mt(ne),nr(f.$$.fragment,ne),_=mt(ne),nr(v.$$.fragment,ne),o=mt(ne)},m(ne,he){or(c,ne,he),Re(ne,d,he),or(f,ne,he),Re(ne,_,he),or(v,ne,he),Re(ne,o,he),z=!0},p(ne,he){const ve=he[0]&192?mh(T,[he&0&&yh(rs[ne[38]]),T[1],T[2],he[0]&128&&{isChild:ne[7][ne[38]]},T[4],he[0]&64&&{selected:ne[6].selected},T[6],he[0]&64&&{highlighted:ne[6].highlighted},T[8],he[0]&64&&{hovered:ne[6].hovered},he[0]&64&&{layout:{visibility:ne[6].type==ne[38]||ne[6].childType==ne[38]?"visible":"none"}},he[0]&64&&{paint:ne[6].type==ne[38]?Hi["fill-self"]:ne[6].childType==ne[38]?Hi["fill-child"]:Hi.fill}]):{};c.$set(ve);const me=he[0]&64?mh(F,[he&0&&yh(rs[ne[38]]),F[1],F[2],he[0]&64&&{selected:ne[6].selected},F[4],he[0]&64&&{highlighted:ne[6].highlighted},he[0]&64&&{layout:{visibility:ne[6].type==ne[38]||ne[6].childType==ne[38]?"visible":"none"}},he[0]&64&&{paint:ne[6].type==ne[38]?Hi["line-active"]:ne[6].childType==ne[38]?Hi["line-child"]:Hi.line}]):{};f.$set(me);const xe=he[0]&64?mh(D,[he&0&&yh(rs[ne[38]]),D[1],D[2],he[0]&64&&{selected:ne[6].selected},he[0]&64&&{layout:{visibility:ne[6].type==ne[38]?"visible":"none"}},he[0]&64&&{paint:ne[6].type==ne[38]?Hi["line-self"]:Hi.line}]):{};v.$set(xe)},i(ne){z||(rt(c.$$.fragment,ne),rt(f.$$.fragment,ne),rt(v.$$.fragment,ne),z=!0)},o(ne){lt(c.$$.fragment,ne),lt(f.$$.fragment,ne),lt(v.$$.fragment,ne),z=!1},d(ne){ar(c,ne),ne&&ae(d),ar(f,ne),ne&&ae(_),ar(v,ne),ne&&ae(o)}}}function Gm(h){let c,d;const f=[_d[h[38]]];let _={$$slots:{default:[B1]},$$scope:{ctx:h}};for(let v=0;v<f.length;v+=1)_=dh(_,f[v]);return c=new Ug({props:_}),{c(){ir(c.$$.fragment)},l(v){nr(c.$$.fragment,v)},m(v,o){or(c,v,o),d=!0},p(v,o){const z=o&0?mh(f,[yh(_d[v[38]])]):{};o[0]&192|o[1]&2048&&(z.$$scope={dirty:o,ctx:v}),c.$set(z)},i(v){d||(rt(c.$$.fragment,v),d=!0)},o(v){lt(c.$$.fragment,v),d=!1},d(v){ar(c,v)}}}function O1(h){let c,d,f=["dz","sdz","ward","dea","lgd"],_=[];for(let o=0;o<5;o+=1)_[o]=Gm(Um(h,f,o));const v=o=>lt(_[o],1,1,()=>{_[o]=null});return{c(){for(let o=0;o<5;o+=1)_[o].c();c=br()},l(o){for(let z=0;z<5;z+=1)_[z].l(o);c=br()},m(o,z){for(let T=0;T<5;T+=1)_[T]&&_[T].m(o,z);Re(o,c,z),d=!0},p(o,z){if(z[0]&8384){f=["dz","sdz","ward","dea","lgd"];let T;for(T=0;T<5;T+=1){const M=Um(o,f,T);_[T]?(_[T].p(M,z),rt(_[T],1)):(_[T]=Gm(M),_[T].c(),rt(_[T],1),_[T].m(c.parentNode,c))}for(to(),T=5;T<5;T+=1)v(T);ro()}},i(o){if(!d){for(let z=0;z<5;z+=1)rt(_[z]);d=!0}},o(o){_=_.filter(Boolean);for(let z=0;z<5;z+=1)lt(_[z]);d=!1},d(o){nn(_,o),o&&ae(c)}}}function Km(h){let c,d,f=h[0].place.name+"",_,v,o,z=[...h[0].place.parents].reverse(),T=[];for(let M=0;M<z.length;M+=1)T[M]=Xm(Nm(h,z,M));return{c(){c=Fe("span"),d=Et("Parents of "),_=Et(f),v=dt(),o=Fe("span");for(let M=0;M<T.length;M+=1)T[M].c();this.h()},l(M){c=Ne(M,"SPAN",{class:!0});var F=Be(c);d=Tt(F,"Parents of "),_=Tt(F,f),F.forEach(ae),v=mt(M),o=Ne(M,"SPAN",{class:!0});var R=Be(o);for(let D=0;D<T.length;D+=1)T[D].l(R);R.forEach(ae),this.h()},h(){oe(c,"class","text-bold"),oe(o,"class","text-small")},m(M,F){Re(M,c,F),Te(c,d),Te(c,_),Re(M,v,F),Re(M,o,F);for(let R=0;R<T.length;R+=1)T[R]&&T[R].m(o,null)},p(M,F){if(F[0]&1&&f!==(f=M[0].place.name+"")&&Tr(_,f),F[0]&1){z=[...M[0].place.parents].reverse();let R;for(R=0;R<z.length;R+=1){const D=Nm(M,z,R);T[R]?T[R].p(D,F):(T[R]=Xm(D),T[R].c(),T[R].m(o,null))}for(;R<T.length;R+=1)T[R].d(1);T.length=z.length}},d(M){M&&ae(c),M&&ae(v),M&&ae(o),nn(T,M)}}}function Xm(h){let c,d,f=h[35]>0?"↳ ":"",_,v=h[36].name+"",o,z;return{c(){c=Fe("span"),d=new Zu(!1),_=Fe("a"),o=Et(v),this.h()},l(T){c=Ne(T,"SPAN",{style:!0});var M=Be(c);d=Gu(M,!1),_=Ne(M,"A",{href:!0,"sveltekit:noscroll":!0,class:!0});var F=Be(_);o=Tt(F,v),F.forEach(ae),M.forEach(ae),this.h()},h(){d.a=_,oe(_,"href",z=Co+"/"+h[36].code),oe(_,"sveltekit:noscroll",""),oe(_,"class","svelte-142gsi4"),Ge(c,"display","block"),Ge(c,"margin-left",(h[35]>0?(h[35]-1)*15:0)+"px")},m(T,M){Re(T,c,M),d.m(f,c),Te(c,_),Te(_,o)},p(T,M){M[0]&1&&v!==(v=T[36].name+"")&&Tr(o,v),M[0]&1&&z!==(z=Co+"/"+T[36].code)&&oe(_,"href",z)},d(T){T&&ae(c)}}}function F1(h){let c,d,f=h[0].place.name+"",_,v,o=No[h[0].place.type].name+"",z;return{c(){c=Fe("span"),d=Et("No areas below "),_=Et(f),v=dt(),z=Et(o),this.h()},l(T){c=Ne(T,"SPAN",{class:!0});var M=Be(c);d=Tt(M,"No areas below "),_=Tt(M,f),v=mt(M),z=Tt(M,o),M.forEach(ae),this.h()},h(){oe(c,"class","muted")},m(T,M){Re(T,c,M),Te(c,d),Te(c,_),Te(c,v),Te(c,z)},p(T,M){M[0]&1&&f!==(f=T[0].place.name+"")&&Tr(_,f),M[0]&1&&o!==(o=No[T[0].place.type].name+"")&&Tr(z,o)},d(T){T&&ae(c)}}}function N1(h){let c,d=(h[0].place.children[0]?No[h[0].place.children[0].type].pl:"Areas")+"",f,_,v=h[0].place.name+"",o,z,T,M,F=h[0].place.children,R=[];for(let D=0;D<F.length;D+=1)R[D]=Wm(Fm(h,F,D));return{c(){c=Fe("span"),f=Et(d),_=Et(" within "),o=Et(v),z=Fe("br"),T=dt(),M=Fe("span");for(let D=0;D<R.length;D+=1)R[D].c();this.h()},l(D){c=Ne(D,"SPAN",{class:!0});var H=Be(c);f=Tt(H,d),_=Tt(H," within "),o=Tt(H,v),H.forEach(ae),z=Ne(D,"BR",{}),T=mt(D),M=Ne(D,"SPAN",{class:!0});var ne=Be(M);for(let he=0;he<R.length;he+=1)R[he].l(ne);ne.forEach(ae),this.h()},h(){oe(c,"class","text-bold"),oe(M,"class","text-small")},m(D,H){Re(D,c,H),Te(c,f),Te(c,_),Te(c,o),Re(D,z,H),Re(D,T,H),Re(D,M,H);for(let ne=0;ne<R.length;ne+=1)R[ne]&&R[ne].m(M,null)},p(D,H){if(H[0]&1&&d!==(d=(D[0].place.children[0]?No[D[0].place.children[0].type].pl:"Areas")+"")&&Tr(f,d),H[0]&1&&v!==(v=D[0].place.name+"")&&Tr(o,v),H[0]&1){F=D[0].place.children;let ne;for(ne=0;ne<F.length;ne+=1){const he=Fm(D,F,ne);R[ne]?R[ne].p(he,H):(R[ne]=Wm(he),R[ne].c(),R[ne].m(M,null))}for(;ne<R.length;ne+=1)R[ne].d(1);R.length=F.length}},d(D){D&&ae(c),D&&ae(z),D&&ae(T),D&&ae(M),nn(R,D)}}}function Wm(h){let c,d=h[33].name+"",f,_,v=h[35]<h[0].place.children.length-1?", ":"",o;return{c(){c=Fe("a"),f=Et(d),o=Et(v),this.h()},l(z){c=Ne(z,"A",{href:!0,"sveltekit:noscroll":!0,class:!0});var T=Be(c);f=Tt(T,d),T.forEach(ae),o=Tt(z,v),this.h()},h(){oe(c,"href",_=Co+"/"+h[33].code),oe(c,"sveltekit:noscroll",""),oe(c,"class","svelte-142gsi4")},m(z,T){Re(z,c,T),Te(c,f),Re(z,o,T)},p(z,T){T[0]&1&&d!==(d=z[33].name+"")&&Tr(f,d),T[0]&1&&_!==(_=Co+"/"+z[33].code)&&oe(c,"href",_),T[0]&1&&v!==(v=z[35]<z[0].place.children.length-1?", ":"")&&Tr(o,v)},d(z){z&&ae(c),z&&ae(o)}}}function U1(h){let c,d,f=h[0].place&&h[0].ni&&jm(h);return{c(){f&&f.c(),c=br()},l(_){f&&f.l(_),c=br()},m(_,v){f&&f.m(_,v),Re(_,c,v),d=!0},p(_,v){_[0].place&&_[0].ni?f?(f.p(_,v),v[0]&1&&rt(f,1)):(f=jm(_),f.c(),rt(f,1),f.m(c.parentNode,c)):f&&(to(),lt(f,1,1,()=>{f=null}),ro())},i(_){d||(rt(f),d=!0)},o(_){lt(f),d=!1},d(_){f&&f.d(_),_&&ae(c)}}}function V1(h){let c,d,f,_,v,o,z,T,M,F,R,D,H,ne,he,ve;return document.title=c=h[0].place.name+" NISRA Key Statistics",H=new X0({}),he=new rg({props:{column:"wide",$$slots:{default:[U1]},$$scope:{ctx:h}}}),{c(){d=Fe("meta"),f=Fe("meta"),v=Fe("meta"),o=Fe("meta"),T=Fe("meta"),F=Fe("meta"),D=dt(),ir(H.$$.fragment),ne=dt(),ir(he.$$.fragment),this.h()},l(me){const xe=$_("svelte-12i6502",document.head);d=Ne(xe,"META",{name:!0,content:!0}),f=Ne(xe,"META",{property:!0,content:!0}),v=Ne(xe,"META",{property:!0,content:!0}),o=Ne(xe,"META",{property:!0,content:!0}),T=Ne(xe,"META",{property:!0,content:!0}),F=Ne(xe,"META",{name:!0,content:!0}),xe.forEach(ae),D=mt(me),nr(H.$$.fragment,me),ne=mt(me),nr(he.$$.fragment,me),this.h()},h(){oe(d,"name","description"),oe(d,"content",""),oe(f,"property","og:title"),oe(f,"content",_=h[0].place.name+" Census Data"),oe(v,"property","og:type"),oe(v,"content","website"),oe(o,"property","og:url"),oe(o,"content",z=xh.base+"/"+h[0].place.code+"/"),oe(T,"property","og:description"),oe(T,"content",M="Explore NISRA Statistics for "+h[0].place.name+"."),oe(F,"name","description"),oe(F,"content",R="Explore NISRA Statistics for "+h[0].place.name+".")},m(me,xe){Te(document.head,d),Te(document.head,f),Te(document.head,v),Te(document.head,o),Te(document.head,T),Te(document.head,F),Re(me,D,xe),or(H,me,xe),Re(me,ne,xe),or(he,me,xe),ve=!0},p(me,xe){(!ve||xe[0]&1)&&c!==(c=me[0].place.name+" NISRA Key Statistics")&&(document.title=c),(!ve||xe[0]&1&&_!==(_=me[0].place.name+" Census Data"))&&oe(f,"content",_),(!ve||xe[0]&1&&z!==(z=xh.base+"/"+me[0].place.code+"/"))&&oe(o,"content",z),(!ve||xe[0]&1&&M!==(M="Explore NISRA Statistics for "+me[0].place.name+"."))&&oe(T,"content",M),(!ve||xe[0]&1&&R!==(R="Explore NISRA Statistics for "+me[0].place.name+"."))&&oe(F,"content",R);const ot={};xe[0]&2047|xe[1]&2048&&(ot.$$scope={dirty:xe,ctx:me}),he.$set(ot)},i(me){ve||(rt(H.$$.fragment,me),rt(he.$$.fragment,me),ve=!0)},o(me){lt(H.$$.fragment,me),lt(he.$$.fragment,me),ve=!1},d(me){ae(d),ae(f),ae(v),ae(o),ae(T),ae(F),me&&ae(D),ar(H,me),me&&ae(ne),ar(he,me)}}}function j1(h,c,d){let f,_,v,o,{data:z}=c,T,M,F=null,R=!1,D={selected:null,type:null,childType:null,highlighted:[],hovered:null},H={};Object.keys(rs).forEach(cr=>d(7,H[cr]=!1,H));function ne(cr,Ve,fr){const hr=($t,Dr)=>$t+Dr;let xr=cr[0],Fr=fr[0],wi=Ve[0],sr="perc",Qr=z.place.data[xr][sr][Fr],kt=z.place.data[xr][sr][wi],Ur=z.ni.data[xr][sr][Fr],Tn=Sp[xr].map($t=>$t.category),$r=Sp[xr].map($t=>$t.label?$t.label:$t.category);return Tn.map(($t,Dr)=>Array.isArray($t)?{x:$r[Dr],y:$t.map(Pr=>Qr[Pr]).reduce(hr,0),ni:$t.map(Pr=>Ur[Pr]).reduce(hr,0),prev:$t.map(Pr=>kt[Pr]).reduce(hr,0)}:{x:$r[Dr],y:Qr[$t],ni:Ur[$t],prev:kt[$t]})}function he(cr,Ve){const fr=Sp[Ve];let hr=[];return fr.forEach(xr=>{let wi=cr.filter(sr=>sr.category===xr.category).map(sr=>({group:sr.group,category:xr.label,perc:sr.perc}));hr=[...hr,...wi]}),hr}function ve(cr){F&&F.fitBounds(cr,{padding:20})}function me(cr){let Ve=JSON.parse(JSON.stringify(D)),fr=z.place.code,hr=z.place.type,xr=z.place.children[0]?z.place.children.map(kt=>kt.code):[],Fr=z.place.type=="rgn"?"cty":xr[0]?z.place.children[0].type:null;d(6,D.selected=fr,D),d(6,D.type=hr,D),d(6,D.childType=Fr,D),d(6,D.highlighted=xr,D);let wi=Object.keys(rs),sr=["fill-color","fill-opacity"],Qr=["line-color","line-width","line-opacity"];F&&(D.type!=Ve.type||D.childType!=Ve.childType)&&(wi.forEach(kt=>{let Ur=kt==hr||Fr&&kt==Fr?"visible":"none";F.setLayoutProperty(kt+"-fill","visibility",Ur),F.setLayoutProperty(kt+"-bounds","visibility",Ur),z.place.parents[0]&&F.setLayoutProperty(kt+"-self","visibility",Ur),d(7,H[kt]=kt==Fr,H)}),z.place.parents[0]&&(sr.forEach(kt=>F.setPaintProperty(hr+"-fill",kt,Hi[xr[0]?"fill-active":"fill-self"][kt])),Qr.forEach(kt=>{F.setPaintProperty(hr+"-bounds",kt,Hi["line-active"][kt]),F.setPaintProperty(hr+"-self",kt,Hi["line-self"][kt])})),Fr&&(sr.forEach(kt=>F.setPaintProperty(Fr+"-fill",kt,Hi["fill-child"][kt])),Qr.forEach(kt=>F.setPaintProperty(Fr+"-bounds",kt,Hi["line-child"][kt]))))}function xe(cr){me(),ve(z.place.bounds)}function ot(cr){yd(`${Co}/${cr.detail.code}/`,{noscroll:!0})}function Je(cr){yd(`${Co}/${cr.detail.value}/`,{noscroll:!0})}function Le(){d(4,M=T<575?1:window.getComputedStyle(grid).getPropertyValue("grid-template-columns").split(" ").length)}const Ye=()=>d(3,o=!0),It=()=>d(2,R=!1),Lt=()=>d(8,v=!1),jt=()=>d(3,o=!0),_t=()=>d(2,R=!1),ht=()=>d(8,v=!1),Ft=()=>d(8,v=!0),yt=()=>d(3,o=!1),zt=()=>d(2,R=!1),et=()=>d(2,R=!0),qt=()=>d(3,o=!1),pt=()=>d(8,v=!1);function At(cr){F=cr,d(5,F)}function Ut(){T=this.clientWidth,d(1,T)}return h.$$set=cr=>{"data"in cr&&d(0,z=cr.data)},h.$$.update=()=>{h.$$.dirty[0]&2&&T&&Le(),h.$$.dirty[0]&5&&d(10,f=R?"Same area 2011":z.place&&z.place.parents[0]?"NI 2021":null),h.$$.dirty[0]&13&&d(9,_=o?null:R?"prev":!R&&z.place.type!="ni"?"ni":null),h.$$.dirty[0]&1&&z.place&&xe(z.place)},d(3,o=!0),d(8,v=!1),[z,T,R,o,M,F,D,H,v,_,f,ne,he,ot,Je,Ye,It,Lt,jt,_t,ht,Ft,yt,zt,et,qt,pt,At,Ut]}class Y1 extends fn{constructor(c){super(),dn(this,c,j1,V1,mn,{data:0},null,[-1,-1])}}export{Y1 as component,J1 as universal};
