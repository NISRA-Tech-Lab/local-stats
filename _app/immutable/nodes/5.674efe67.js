import{g as a_,c as _d,a as vd,s as o_,b as s_,d as l_,S as u_}from"../chunks/navigation.97db6cbf.js";import{g as Hn,a as wh,m as ts,b as Cl,c as c_,d as Ji,e as bd}from"../chunks/config.25b459c1.js";import{S as on,i as sn,s as ln,k as Ue,l as qe,m as Oe,h as ne,n as ie,R as Gu,b as Re,T as Zu,g as tt,v as kn,d as ct,f as En,P as oy,o as Vp,K as Ou,M as Fu,N as Nu,O as Vu,w as Rs,e as or,E as Ku,U as h_,Q as Ht,V as Tr,p as Ye,W as Xn,X as Wn,C as we,D as ei,Y as an,Z as rs,q as zt,r as Pt,u as Er,y as er,z as tr,A as rr,B as ir,a as bt,c as xt,_ as zh,G as Mp,I as p_,F as Sh,$ as Bl,a0 as Ol,L as f_,a1 as d_,a2 as m_,a3 as yh,a4 as gh,a5 as _h}from"../chunks/index.baf6a862.js";import{b as Sn}from"../chunks/paths.6869da7c.js";import{S as y_}from"../chunks/Section.6106804d.js";/* empty css                                                              */import{w as Ir,h as Li}from"../chunks/singletons.d5db671b.js";async function xd(l,c){return await(await c(wh.app_json_data+l+".json")).json()}async function g_({params:l,fetch:c}){let d=l.code,p=await a_(wh.search_data,c),y={};p.forEach(T=>y[T.code]=T.name),p.forEach(T=>{T.typepl=Hn[T.type].pl,T.typenm=Hn[T.type].name,T.typestr=y[T.parent]&&T.parent==T.code?`View:  ${y[T.parent]}
        ${Hn[T.parent_type].name}  `:y[T.parent]&&T.parent!=T.code?`${Hn[T.type].name} `:""});let v=p.sort((T,L)=>T.name.localeCompare(L.name)),a=await xd("N92000002",c),E=await xd(d,c);return{search_data:v,place:E,ni:a}}const ub=Object.freeze(Object.defineProperty({__proto__:null,load:g_},Symbol.toStringTag,{value:"Module"}));var __=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function v_(l){return l&&l.__esModule&&Object.prototype.hasOwnProperty.call(l,"default")?l.default:l}var b_={rgb2hsl:Hu,rgb2hsv:Ph,rgb2hwb:Xu,rgb2cmyk:Wu,rgb2keyword:Yu,rgb2xyz:Up,rgb2lab:qp,rgb2lch:x_,hsl2rgb:Ch,hsl2hsv:w_,hsl2hwb:S_,hsl2cmyk:k_,hsl2keyword:E_,hsv2rgb:Mh,hsv2hsl:T_,hsv2hwb:I_,hsv2cmyk:A_,hsv2keyword:z_,hwb2rgb:Ju,hwb2hsl:P_,hwb2hsv:C_,hwb2cmyk:M_,hwb2keyword:D_,cmyk2rgb:Qu,cmyk2hsl:L_,cmyk2hsv:R_,cmyk2hwb:B_,cmyk2keyword:O_,keyword2rgb:Bs,keyword2hsl:U_,keyword2hsv:q_,keyword2hwb:j_,keyword2cmyk:G_,keyword2lab:Z_,keyword2xyz:K_,xyz2rgb:sy,xyz2lab:ly,xyz2lch:F_,lab2xyz:jp,lab2rgb:uy,lab2lch:Gp,lch2lab:Zp,lch2xyz:N_,lch2rgb:V_};function Hu(l){var c=l[0]/255,d=l[1]/255,p=l[2]/255,y=Math.min(c,d,p),v=Math.max(c,d,p),a=v-y,E,T,L;return v==y?E=0:c==v?E=(d-p)/a:d==v?E=2+(p-c)/a:p==v&&(E=4+(c-d)/a),E=Math.min(E*60,360),E<0&&(E+=360),L=(y+v)/2,v==y?T=0:L<=.5?T=a/(v+y):T=a/(2-v-y),[E,T*100,L*100]}function Ph(l){var c=l[0],d=l[1],p=l[2],y=Math.min(c,d,p),v=Math.max(c,d,p),a=v-y,E,T,L;return v==0?T=0:T=a/v*1e3/10,v==y?E=0:c==v?E=(d-p)/a:d==v?E=2+(p-c)/a:p==v&&(E=4+(c-d)/a),E=Math.min(E*60,360),E<0&&(E+=360),L=v/255*1e3/10,[E,T,L]}function Xu(l){var c=l[0],d=l[1],v=l[2],p=Hu(l)[0],y=1/255*Math.min(c,Math.min(d,v)),v=1-1/255*Math.max(c,Math.max(d,v));return[p,y*100,v*100]}function Wu(l){var c=l[0]/255,d=l[1]/255,p=l[2]/255,y,v,a,E;return E=Math.min(1-c,1-d,1-p),y=(1-c-E)/(1-E)||0,v=(1-d-E)/(1-E)||0,a=(1-p-E)/(1-E)||0,[y*100,v*100,a*100,E*100]}function Yu(l){return cy[JSON.stringify(l)]}function Up(l){var c=l[0]/255,d=l[1]/255,p=l[2]/255;c=c>.04045?Math.pow((c+.055)/1.055,2.4):c/12.92,d=d>.04045?Math.pow((d+.055)/1.055,2.4):d/12.92,p=p>.04045?Math.pow((p+.055)/1.055,2.4):p/12.92;var y=c*.4124+d*.3576+p*.1805,v=c*.2126+d*.7152+p*.0722,a=c*.0193+d*.1192+p*.9505;return[y*100,v*100,a*100]}function qp(l){var c=Up(l),d=c[0],p=c[1],y=c[2],v,a,E;return d/=95.047,p/=100,y/=108.883,d=d>.008856?Math.pow(d,1/3):7.787*d+16/116,p=p>.008856?Math.pow(p,1/3):7.787*p+16/116,y=y>.008856?Math.pow(y,1/3):7.787*y+16/116,v=116*p-16,a=500*(d-p),E=200*(p-y),[v,a,E]}function x_(l){return Gp(qp(l))}function Ch(l){var c=l[0]/360,d=l[1]/100,p=l[2]/100,y,v,a,E,T;if(d==0)return T=p*255,[T,T,T];p<.5?v=p*(1+d):v=p+d-p*d,y=2*p-v,E=[0,0,0];for(var L=0;L<3;L++)a=c+1/3*-(L-1),a<0&&a++,a>1&&a--,6*a<1?T=y+(v-y)*6*a:2*a<1?T=v:3*a<2?T=y+(v-y)*(2/3-a)*6:T=y,E[L]=T*255;return E}function w_(l){var c=l[0],d=l[1]/100,p=l[2]/100,y,v;return p===0?[0,0,0]:(p*=2,d*=p<=1?p:2-p,v=(p+d)/2,y=2*d/(p+d),[c,y*100,v*100])}function S_(l){return Xu(Ch(l))}function k_(l){return Wu(Ch(l))}function E_(l){return Yu(Ch(l))}function Mh(l){var c=l[0]/60,d=l[1]/100,T=l[2]/100,p=Math.floor(c)%6,y=c-Math.floor(c),v=255*T*(1-d),a=255*T*(1-d*y),E=255*T*(1-d*(1-y)),T=255*T;switch(p){case 0:return[T,E,v];case 1:return[a,T,v];case 2:return[v,T,E];case 3:return[v,a,T];case 4:return[E,v,T];case 5:return[T,v,a]}}function T_(l){var c=l[0],d=l[1]/100,p=l[2]/100,y,v;return v=(2-d)*p,y=d*p,y/=v<=1?v:2-v,y=y||0,v/=2,[c,y*100,v*100]}function I_(l){return Xu(Mh(l))}function A_(l){return Wu(Mh(l))}function z_(l){return Yu(Mh(l))}function Ju(l){var c=l[0]/360,d=l[1]/100,p=l[2]/100,y=d+p,v,a,E,T;switch(y>1&&(d/=y,p/=y),v=Math.floor(6*c),a=1-p,E=6*c-v,v&1&&(E=1-E),T=d+E*(a-d),v){default:case 6:case 0:r=a,g=T,b=d;break;case 1:r=T,g=a,b=d;break;case 2:r=d,g=a,b=T;break;case 3:r=d,g=T,b=a;break;case 4:r=T,g=d,b=a;break;case 5:r=a,g=d,b=T;break}return[r*255,g*255,b*255]}function P_(l){return Hu(Ju(l))}function C_(l){return Ph(Ju(l))}function M_(l){return Wu(Ju(l))}function D_(l){return Yu(Ju(l))}function Qu(l){var c=l[0]/100,d=l[1]/100,p=l[2]/100,y=l[3]/100,v,a,E;return v=1-Math.min(1,c*(1-y)+y),a=1-Math.min(1,d*(1-y)+y),E=1-Math.min(1,p*(1-y)+y),[v*255,a*255,E*255]}function L_(l){return Hu(Qu(l))}function R_(l){return Ph(Qu(l))}function B_(l){return Xu(Qu(l))}function O_(l){return Yu(Qu(l))}function sy(l){var c=l[0]/100,d=l[1]/100,p=l[2]/100,y,v,a;return y=c*3.2406+d*-1.5372+p*-.4986,v=c*-.9689+d*1.8758+p*.0415,a=c*.0557+d*-.204+p*1.057,y=y>.0031308?1.055*Math.pow(y,1/2.4)-.055:y=y*12.92,v=v>.0031308?1.055*Math.pow(v,1/2.4)-.055:v=v*12.92,a=a>.0031308?1.055*Math.pow(a,1/2.4)-.055:a=a*12.92,y=Math.min(Math.max(0,y),1),v=Math.min(Math.max(0,v),1),a=Math.min(Math.max(0,a),1),[y*255,v*255,a*255]}function ly(l){var c=l[0],d=l[1],p=l[2],y,v,a;return c/=95.047,d/=100,p/=108.883,c=c>.008856?Math.pow(c,1/3):7.787*c+16/116,d=d>.008856?Math.pow(d,1/3):7.787*d+16/116,p=p>.008856?Math.pow(p,1/3):7.787*p+16/116,y=116*d-16,v=500*(c-d),a=200*(d-p),[y,v,a]}function F_(l){return Gp(ly(l))}function jp(l){var c=l[0],d=l[1],p=l[2],y,v,a,E;return c<=8?(v=c*100/903.3,E=7.787*(v/100)+16/116):(v=100*Math.pow((c+16)/116,3),E=Math.pow(v/100,1/3)),y=y/95.047<=.008856?y=95.047*(d/500+E-16/116)/7.787:95.047*Math.pow(d/500+E,3),a=a/108.883<=.008859?a=108.883*(E-p/200-16/116)/7.787:108.883*Math.pow(E-p/200,3),[y,v,a]}function Gp(l){var c=l[0],d=l[1],p=l[2],y,v,a;return y=Math.atan2(p,d),v=y*360/2/Math.PI,v<0&&(v+=360),a=Math.sqrt(d*d+p*p),[c,a,v]}function uy(l){return sy(jp(l))}function Zp(l){var c=l[0],d=l[1],p=l[2],y,v,a;return a=p/360*2*Math.PI,y=d*Math.cos(a),v=d*Math.sin(a),[c,y,v]}function N_(l){return jp(Zp(l))}function V_(l){return uy(Zp(l))}function Bs(l){return Dp[l]}function U_(l){return Hu(Bs(l))}function q_(l){return Ph(Bs(l))}function j_(l){return Xu(Bs(l))}function G_(l){return Wu(Bs(l))}function Z_(l){return qp(Bs(l))}function K_(l){return Up(Bs(l))}var Dp={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,134,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,250,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,221],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[112,128,144],slategrey:[112,128,144],snow:[255,250,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,50]},cy={};for(var wd in Dp)cy[JSON.stringify(Dp[wd])]=wd;var Tp=b_,Dl=function(){return new $u};for(var Lu in Tp){Dl[Lu+"Raw"]=function(l){return function(c){return typeof c=="number"&&(c=Array.prototype.slice.call(arguments)),Tp[l](c)}}(Lu);var Sd=/(\w+)2(\w+)/.exec(Lu),Ip=Sd[1],H_=Sd[2];Dl[Ip]=Dl[Ip]||{},Dl[Ip][H_]=Dl[Lu]=function(l){return function(c){typeof c=="number"&&(c=Array.prototype.slice.call(arguments));var d=Tp[l](c);if(typeof d=="string"||d===void 0)return d;for(var p=0;p<d.length;p++)d[p]=Math.round(d[p]);return d}}(Lu)}var $u=function(){this.convs={}};$u.prototype.routeSpace=function(l,c){var d=c[0];return d===void 0?this.getValues(l):(typeof d=="number"&&(d=Array.prototype.slice.call(c)),this.setValues(l,d))};$u.prototype.setValues=function(l,c){return this.space=l,this.convs={},this.convs[l]=c,this};$u.prototype.getValues=function(l){var c=this.convs[l];if(!c){var d=this.space,p=this.convs[d];c=Dl[d][l](p),this.convs[l]=c}return c};["rgb","hsl","hsv","cmyk","keyword"].forEach(function(l){$u.prototype[l]=function(c){return this.routeSpace(l,arguments)}});var hy={exports:{}};(function(l,c){(function(d,p){l.exports=p()})(__,function(){var d,p,y;function v(a,E){if(!d)d=E;else if(!p)p=E;else{var T="var sharedChunk = {}; ("+d+")(sharedChunk); ("+p+")(sharedChunk);",L={};d(L),y=E(L),typeof window<"u"&&(y.workerUrl=window.URL.createObjectURL(new Blob([T],{type:"text/javascript"})))}}return v(["exports"],function(a){function E(e,t){return e(t={exports:{}},t.exports),t.exports}var T=L;function L(e,t,i,u){this.cx=3*e,this.bx=3*(i-e)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*t,this.by=3*(u-t)-this.cy,this.ay=1-this.cy-this.by,this.p1x=e,this.p1y=u,this.p2x=i,this.p2y=u}L.prototype.sampleCurveX=function(e){return((this.ax*e+this.bx)*e+this.cx)*e},L.prototype.sampleCurveY=function(e){return((this.ay*e+this.by)*e+this.cy)*e},L.prototype.sampleCurveDerivativeX=function(e){return(3*this.ax*e+2*this.bx)*e+this.cx},L.prototype.solveCurveX=function(e,t){var i,u,f,m,x;for(t===void 0&&(t=1e-6),f=e,x=0;x<8;x++){if(m=this.sampleCurveX(f)-e,Math.abs(m)<t)return f;var k=this.sampleCurveDerivativeX(f);if(Math.abs(k)<1e-6)break;f-=m/k}if((f=e)<(i=0))return i;if(f>(u=1))return u;for(;i<u;){if(m=this.sampleCurveX(f),Math.abs(m-e)<t)return f;e>m?i=f:u=f,f=.5*(u-i)+i}return f},L.prototype.solve=function(e,t){return this.sampleCurveY(this.solveCurveX(e,t))};var F=C;function C(e,t){this.x=e,this.y=t}C.prototype={clone:function(){return new C(this.x,this.y)},add:function(e){return this.clone()._add(e)},sub:function(e){return this.clone()._sub(e)},multByPoint:function(e){return this.clone()._multByPoint(e)},divByPoint:function(e){return this.clone()._divByPoint(e)},mult:function(e){return this.clone()._mult(e)},div:function(e){return this.clone()._div(e)},rotate:function(e){return this.clone()._rotate(e)},rotateAround:function(e,t){return this.clone()._rotateAround(e,t)},matMult:function(e){return this.clone()._matMult(e)},unit:function(){return this.clone()._unit()},perp:function(){return this.clone()._perp()},round:function(){return this.clone()._round()},mag:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals:function(e){return this.x===e.x&&this.y===e.y},dist:function(e){return Math.sqrt(this.distSqr(e))},distSqr:function(e){var t=e.x-this.x,i=e.y-this.y;return t*t+i*i},angle:function(){return Math.atan2(this.y,this.x)},angleTo:function(e){return Math.atan2(this.y-e.y,this.x-e.x)},angleWith:function(e){return this.angleWithSep(e.x,e.y)},angleWithSep:function(e,t){return Math.atan2(this.x*t-this.y*e,this.x*e+this.y*t)},_matMult:function(e){var t=e[2]*this.x+e[3]*this.y;return this.x=e[0]*this.x+e[1]*this.y,this.y=t,this},_add:function(e){return this.x+=e.x,this.y+=e.y,this},_sub:function(e){return this.x-=e.x,this.y-=e.y,this},_mult:function(e){return this.x*=e,this.y*=e,this},_div:function(e){return this.x/=e,this.y/=e,this},_multByPoint:function(e){return this.x*=e.x,this.y*=e.y,this},_divByPoint:function(e){return this.x/=e.x,this.y/=e.y,this},_unit:function(){return this._div(this.mag()),this},_perp:function(){var e=this.y;return this.y=this.x,this.x=-e,this},_rotate:function(e){var t=Math.cos(e),i=Math.sin(e),u=i*this.x+t*this.y;return this.x=t*this.x-i*this.y,this.y=u,this},_rotateAround:function(e,t){var i=Math.cos(e),u=Math.sin(e),f=t.y+u*(this.x-t.x)+i*(this.y-t.y);return this.x=t.x+i*(this.x-t.x)-u*(this.y-t.y),this.y=f,this},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}},C.convert=function(e){return e instanceof C?e:Array.isArray(e)?new C(e[0],e[1]):e};var M=typeof self<"u"?self:{},X=Math.pow(2,53)-1;function ae(e,t,i,u){var f=new T(e,t,i,u);return function(m){return f.solve(m)}}var se=ae(.25,.1,.25,1);function he(e,t,i){return Math.min(i,Math.max(t,e))}function me(e,t,i){var u=i-t,f=((e-t)%u+u)%u+t;return f===t?i:f}function _e(e){for(var t=[],i=arguments.length-1;i-- >0;)t[i]=arguments[i+1];for(var u=0,f=t;u<f.length;u+=1){var m=f[u];for(var x in m)e[x]=m[x]}return e}var it=1;function Fe(){return it++}function Pe(){return function e(t){return t?(t^16*Math.random()>>t/4).toString(16):([1e7]+-[1e3]+-4e3+-8e3+-1e11).replace(/[018]/g,e)}()}function Ze(e){return!!e&&/^[0-9a-f]{8}-[0-9a-f]{4}-[4][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i.test(e)}function Ct(e,t){e.forEach(function(i){t[i]&&(t[i]=t[i].bind(t))})}function kt(e,t){return e.indexOf(t,e.length-t.length)!==-1}function Ge(e,t,i){var u={};for(var f in e)u[f]=t.call(i||this,e[f],f,e);return u}function Ke(e,t,i){var u={};for(var f in e)t.call(i||this,e[f],f,e)&&(u[f]=e[f]);return u}function gt(e){return Array.isArray(e)?e.map(gt):typeof e=="object"&&e?Ge(e,gt):e}var ur={};function je(e){ur[e]||(typeof console<"u"&&console.warn(e),ur[e]=!0)}function Ft(e,t,i){return(i.y-e.y)*(t.x-e.x)>(t.y-e.y)*(i.x-e.x)}function Be(e){for(var t=0,i=0,u=e.length,f=u-1,m=void 0,x=void 0;i<u;f=i++)t+=((x=e[f]).x-(m=e[i]).x)*(m.y+x.y);return t}function $e(){return typeof WorkerGlobalScope<"u"&&typeof self<"u"&&self instanceof WorkerGlobalScope}function yt(e){var t={};if(e.replace(/(?:^|(?:\s*\,\s*))([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)(?:\=(?:([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)|(?:\"((?:[^"\\]|\\.)*)\")))?/g,function(u,f,m,x){var k=m||x;return t[f]=!k||k.toLowerCase(),""}),t["max-age"]){var i=parseInt(t["max-age"],10);isNaN(i)?delete t["max-age"]:t["max-age"]=i}return t}var jt=null;function Lt(e){if(jt==null){var t=e.navigator?e.navigator.userAgent:null;jt=!!e.safari||!(!t||!(/\b(iPad|iPhone|iPod)\b/.test(t)||t.match("Safari")&&!t.match("Chrome")))}return jt}function St(e){try{var t=M[e];return t.setItem("_mapbox_test_",1),t.removeItem("_mapbox_test_"),!0}catch{return!1}}var Ce,ot,Dr,Kr,ki=M.performance&&M.performance.now?M.performance.now.bind(M.performance):Date.now.bind(Date),Br=M.requestAnimationFrame||M.mozRequestAnimationFrame||M.webkitRequestAnimationFrame||M.msRequestAnimationFrame,cr=M.cancelAnimationFrame||M.mozCancelAnimationFrame||M.webkitCancelAnimationFrame||M.msCancelAnimationFrame,Sr={now:ki,frame:function(e){var t=Br(e);return{cancel:function(){return cr(t)}}},getImageData:function(e,t){t===void 0&&(t=0);var i=M.document.createElement("canvas"),u=i.getContext("2d");if(!u)throw new Error("failed to create canvas 2d context");return i.width=e.width,i.height=e.height,u.drawImage(e,0,0,e.width,e.height),u.getImageData(-t,-t,e.width+2*t,e.height+2*t)},resolveURL:function(e){return Ce||(Ce=M.document.createElement("a")),Ce.href=e,Ce.href},hardwareConcurrency:M.navigator&&M.navigator.hardwareConcurrency||4,get devicePixelRatio(){return M.devicePixelRatio},get prefersReducedMotion(){return!!M.matchMedia&&(ot==null&&(ot=M.matchMedia("(prefers-reduced-motion: reduce)")),ot.matches)}},Gt={API_URL:"https://api.mapbox.com",get EVENTS_URL(){return this.API_URL?this.API_URL.indexOf("https://api.mapbox.cn")===0?"https://events.mapbox.cn/events/v2":this.API_URL.indexOf("https://api.mapbox.com")===0?"https://events.mapbox.com/events/v2":null:null},FEEDBACK_URL:"https://apps.mapbox.com/feedback",REQUIRE_ACCESS_TOKEN:!0,ACCESS_TOKEN:null,MAX_PARALLEL_IMAGE_REQUESTS:16},Ei={supported:!1,testSupport:function(e){!Yn&&Kr&&(ti?Ut(e):Dr=e)}},Yn=!1,ti=!1;function Ut(e){var t=e.createTexture();e.bindTexture(e.TEXTURE_2D,t);try{if(e.texImage2D(e.TEXTURE_2D,0,e.RGBA,e.RGBA,e.UNSIGNED_BYTE,Kr),e.isContextLost())return;Ei.supported=!0}catch{}e.deleteTexture(t),Yn=!0}M.document&&((Kr=M.document.createElement("img")).onload=function(){Dr&&Ut(Dr),Dr=null,ti=!0},Kr.onerror=function(){Yn=!0,Dr=null},Kr.src="data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAQAAAAfQ//73v/+BiOh/AAA=");var mn="01",ci=function(e,t){this._transformRequestFn=e,this._customAccessToken=t,this._createSkuToken()};function $r(e){return e.indexOf("mapbox:")===0}ci.prototype._createSkuToken=function(){var e=function(){for(var t="",i=0;i<10;i++)t+="0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ"[Math.floor(62*Math.random())];return{token:["1",mn,t].join(""),tokenExpiresAt:Date.now()+432e5}}();this._skuToken=e.token,this._skuTokenExpiresAt=e.tokenExpiresAt},ci.prototype._isSkuTokenExpired=function(){return Date.now()>this._skuTokenExpiresAt},ci.prototype.transformRequest=function(e,t){return this._transformRequestFn&&this._transformRequestFn(e,t)||{url:e}},ci.prototype.normalizeStyleURL=function(e,t){if(!$r(e))return e;var i=ni(e);return i.path="/styles/v1"+i.path,this._makeAPIURL(i,this._customAccessToken||t)},ci.prototype.normalizeGlyphsURL=function(e,t){if(!$r(e))return e;var i=ni(e);return i.path="/fonts/v1"+i.path,this._makeAPIURL(i,this._customAccessToken||t)},ci.prototype.normalizeSourceURL=function(e,t){if(!$r(e))return e;var i=ni(e);return i.path="/v4/"+i.authority+".json",i.params.push("secure"),this._makeAPIURL(i,this._customAccessToken||t)},ci.prototype.normalizeSpriteURL=function(e,t,i,u){var f=ni(e);return $r(e)?(f.path="/styles/v1"+f.path+"/sprite"+t+i,this._makeAPIURL(f,this._customAccessToken||u)):(f.path+=""+t+i,zr(f))},ci.prototype.normalizeTileURL=function(e,t){if(this._isSkuTokenExpired()&&this._createSkuToken(),e&&!$r(e))return e;var i=ni(e);i.path=i.path.replace(/(\.(png|jpg)\d*)(?=$)/,(Sr.devicePixelRatio>=2||t===512?"@2x":"")+(Ei.supported?".webp":"$1")),i.path=i.path.replace(/^.+\/v4\//,"/"),i.path="/v4"+i.path;var u=this._customAccessToken||function(f){for(var m=0,x=f;m<x.length;m+=1){var k=x[m].match(/^access_token=(.*)$/);if(k)return k[1]}return null}(i.params)||Gt.ACCESS_TOKEN;return Gt.REQUIRE_ACCESS_TOKEN&&u&&this._skuToken&&i.params.push("sku="+this._skuToken),this._makeAPIURL(i,u)},ci.prototype.canonicalizeTileURL=function(e,t){var i=ni(e);if(!i.path.match(/(^\/v4\/)/)||!i.path.match(/\.[\w]+$/))return e;var u="mapbox://tiles/";u+=i.path.replace("/v4/","");var f=i.params;return t&&(f=f.filter(function(m){return!m.match(/^access_token=/)})),f.length&&(u+="?"+f.join("&")),u},ci.prototype.canonicalizeTileset=function(e,t){for(var i=!!t&&$r(t),u=[],f=0,m=e.tiles||[];f<m.length;f+=1){var x=m[f];hi(x)?u.push(this.canonicalizeTileURL(x,i)):u.push(x)}return u},ci.prototype._makeAPIURL=function(e,t){var i="See https://www.mapbox.com/api-documentation/#access-tokens-and-token-scopes",u=ni(Gt.API_URL);if(e.protocol=u.protocol,e.authority=u.authority,e.protocol==="http"){var f=e.params.indexOf("secure");f>=0&&e.params.splice(f,1)}if(u.path!=="/"&&(e.path=""+u.path+e.path),!Gt.REQUIRE_ACCESS_TOKEN)return zr(e);if(!(t=t||Gt.ACCESS_TOKEN))throw new Error("An API access token is required to use Mapbox GL. "+i);if(t[0]==="s")throw new Error("Use a public access token (pk.*) with Mapbox GL, not a secret access token (sk.*). "+i);return e.params=e.params.filter(function(m){return m.indexOf("access_token")===-1}),e.params.push("access_token="+t),zr(e)};var Rn=/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/|\?|$)/i;function hi(e){return Rn.test(e)}var Tn=/^(\w+):\/\/([^/?]*)(\/[^?]+)?\??(.+)?/;function ni(e){var t=e.match(Tn);if(!t)throw new Error("Unable to parse URL object");return{protocol:t[1],authority:t[2],path:t[3]||"/",params:t[4]?t[4].split("&"):[]}}function zr(e){var t=e.params.length?"?"+e.params.join("&"):"";return e.protocol+"://"+e.authority+e.path+t}function _i(e){if(!e)return null;var t=e.split(".");if(!t||t.length!==3)return null;try{return JSON.parse(decodeURIComponent(M.atob(t[1]).split("").map(function(i){return"%"+("00"+i.charCodeAt(0).toString(16)).slice(-2)}).join("")))}catch{return null}}var pi=function(e){this.type=e,this.anonId=null,this.eventData={},this.queue=[],this.pendingRequest=null};pi.prototype.getStorageKey=function(e){var t,i=_i(Gt.ACCESS_TOKEN);return t=i&&i.u?M.btoa(encodeURIComponent(i.u).replace(/%([0-9A-F]{2})/g,function(u,f){return String.fromCharCode(+("0x"+f))})):Gt.ACCESS_TOKEN||"",e?"mapbox.eventData."+e+":"+t:"mapbox.eventData:"+t},pi.prototype.fetchEventData=function(){var e=St("localStorage"),t=this.getStorageKey(),i=this.getStorageKey("uuid");if(e)try{var u=M.localStorage.getItem(t);u&&(this.eventData=JSON.parse(u));var f=M.localStorage.getItem(i);f&&(this.anonId=f)}catch{je("Unable to read from LocalStorage")}},pi.prototype.saveEventData=function(){var e=St("localStorage"),t=this.getStorageKey(),i=this.getStorageKey("uuid");if(e)try{M.localStorage.setItem(i,this.anonId),Object.keys(this.eventData).length>=1&&M.localStorage.setItem(t,JSON.stringify(this.eventData))}catch{je("Unable to write to LocalStorage")}},pi.prototype.processRequests=function(e){},pi.prototype.postEvent=function(e,t,i,u){var f=this;if(Gt.EVENTS_URL){var m=ni(Gt.EVENTS_URL);m.params.push("access_token="+(u||Gt.ACCESS_TOKEN||""));var x={event:this.type,created:new Date(e).toISOString(),sdkIdentifier:"mapbox-gl-js",sdkVersion:"1.13.2",skuId:mn,userId:this.anonId},k=t?_e(x,t):x,A={url:zr(m),headers:{"Content-Type":"text/plain"},body:JSON.stringify([k])};this.pendingRequest=et(A,function(z){f.pendingRequest=null,i(z),f.saveEventData(),f.processRequests(u)})}},pi.prototype.queueRequest=function(e,t){this.queue.push(e),this.processRequests(t)};var qr,Qi,Hr=function(e){function t(){e.call(this,"map.load"),this.success={},this.skuToken=""}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.postMapLoadEvent=function(i,u,f,m){this.skuToken=f,(Gt.EVENTS_URL&&m||Gt.ACCESS_TOKEN&&Array.isArray(i)&&i.some(function(x){return $r(x)||hi(x)}))&&this.queueRequest({id:u,timestamp:Date.now()},m)},t.prototype.processRequests=function(i){var u=this;if(!this.pendingRequest&&this.queue.length!==0){var f=this.queue.shift(),m=f.id,x=f.timestamp;m&&this.success[m]||(this.anonId||this.fetchEventData(),Ze(this.anonId)||(this.anonId=Pe()),this.postEvent(x,{skuToken:this.skuToken},function(k){k||m&&(u.success[m]=!0)},i))}},t}(pi),In=new(function(e){function t(i){e.call(this,"appUserTurnstile"),this._customAccessToken=i}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.postTurnstileEvent=function(i,u){Gt.EVENTS_URL&&Gt.ACCESS_TOKEN&&Array.isArray(i)&&i.some(function(f){return $r(f)||hi(f)})&&this.queueRequest(Date.now(),u)},t.prototype.processRequests=function(i){var u=this;if(!this.pendingRequest&&this.queue.length!==0){this.anonId&&this.eventData.lastSuccess&&this.eventData.tokenU||this.fetchEventData();var f=_i(Gt.ACCESS_TOKEN),m=f?f.u:Gt.ACCESS_TOKEN,x=m!==this.eventData.tokenU;Ze(this.anonId)||(this.anonId=Pe(),x=!0);var k=this.queue.shift();if(this.eventData.lastSuccess){var A=new Date(this.eventData.lastSuccess),z=new Date(k),D=(k-this.eventData.lastSuccess)/864e5;x=x||D>=1||D<-1||A.getDate()!==z.getDate()}else x=!0;if(!x)return this.processRequests();this.postEvent(k,{"enabled.telemetry":!1},function(B){B||(u.eventData.lastSuccess=k,u.eventData.tokenU=m)},i)}},t}(pi)),$i=In.postTurnstileEvent.bind(In),Bn=new Hr,Ui=Bn.postMapLoadEvent.bind(Bn),An=500,en=50;function Ri(){M.caches&&!qr&&(qr=M.caches.open("mapbox-tiles"))}function Xr(e){var t=e.indexOf("?");return t<0?e:e.slice(0,t)}var zn,Pn=1/0;function vi(){return zn==null&&(zn=M.OffscreenCanvas&&new M.OffscreenCanvas(1,1).getContext("2d")&&typeof M.createImageBitmap=="function"),zn}var ha={Unknown:"Unknown",Style:"Style",Source:"Source",Tile:"Tile",Glyphs:"Glyphs",SpriteImage:"SpriteImage",SpriteJSON:"SpriteJSON",Image:"Image"};typeof Object.freeze=="function"&&Object.freeze(ha);var ra=function(e){function t(i,u,f){u===401&&hi(f)&&(i+=": you may have provided an invalid Mapbox access token. See https://www.mapbox.com/api-documentation/#access-tokens-and-token-scopes"),e.call(this,i),this.status=u,this.url=f,this.name=this.constructor.name,this.message=i}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.toString=function(){return this.name+": "+this.message+" ("+this.status+"): "+this.url},t}(Error),Or=$e()?function(){return self.worker&&self.worker.referrer}:function(){return(M.location.protocol==="blob:"?M.parent:M).location.href},un,qi,fi=function(e,t){if(!(/^file:/.test(i=e.url)||/^file:/.test(Or())&&!/^\w+:/.test(i))){if(M.fetch&&M.Request&&M.AbortController&&M.Request.prototype.hasOwnProperty("signal"))return function(u,f){var m,x=new M.AbortController,k=new M.Request(u.url,{method:u.method||"GET",body:u.body,credentials:u.credentials,headers:u.headers,referrer:Or(),signal:x.signal}),A=!1,z=!1,D=(m=k.url).indexOf("sku=")>0&&hi(m);u.type==="json"&&k.headers.set("Accept","application/json");var B=function(j,Q,$){if(!z){if(j&&j.message!=="SecurityError"&&je(j),Q&&$)return V(Q);var pe=Date.now();M.fetch(k).then(function(oe){if(oe.ok){var ye=D?oe.clone():null;return V(oe,ye,pe)}return f(new ra(oe.statusText,oe.status,u.url))}).catch(function(oe){oe.code!==20&&f(new Error(oe.message))})}},V=function(j,Q,$){(u.type==="arrayBuffer"?j.arrayBuffer():u.type==="json"?j.json():j.text()).then(function(pe){z||(Q&&$&&function(oe,ye,xe){if(Ri(),qr){var Se={status:ye.status,statusText:ye.statusText,headers:new M.Headers};ye.headers.forEach(function(Me,Xe){return Se.headers.set(Xe,Me)});var Te=yt(ye.headers.get("Cache-Control")||"");Te["no-store"]||(Te["max-age"]&&Se.headers.set("Expires",new Date(xe+1e3*Te["max-age"]).toUTCString()),new Date(Se.headers.get("Expires")).getTime()-xe<42e4||function(Me,Xe){if(Qi===void 0)try{new Response(new ReadableStream),Qi=!0}catch{Qi=!1}Qi?Xe(Me.body):Me.blob().then(Xe)}(ye,function(Me){var Xe=new M.Response(Me,Se);Ri(),qr&&qr.then(function(rt){return rt.put(Xr(oe.url),Xe)}).catch(function(rt){return je(rt.message)})}))}}(k,Q,$),A=!0,f(null,pe,j.headers.get("Cache-Control"),j.headers.get("Expires")))}).catch(function(pe){z||f(new Error(pe.message))})};return D?function(j,Q){if(Ri(),!qr)return Q(null);var $=Xr(j.url);qr.then(function(pe){pe.match($).then(function(oe){var ye=function(xe){if(!xe)return!1;var Se=new Date(xe.headers.get("Expires")||0),Te=yt(xe.headers.get("Cache-Control")||"");return Se>Date.now()&&!Te["no-cache"]}(oe);pe.delete($),ye&&pe.put($,oe.clone()),Q(null,oe,ye)}).catch(Q)}).catch(Q)}(k,B):B(null,null),{cancel:function(){z=!0,A||x.abort()}}}(e,t);if($e()&&self.worker&&self.worker.actor)return self.worker.actor.send("getResource",e,t,void 0,!0)}var i;return function(u,f){var m=new M.XMLHttpRequest;for(var x in m.open(u.method||"GET",u.url,!0),u.type==="arrayBuffer"&&(m.responseType="arraybuffer"),u.headers)m.setRequestHeader(x,u.headers[x]);return u.type==="json"&&(m.responseType="text",m.setRequestHeader("Accept","application/json")),m.withCredentials=u.credentials==="include",m.onerror=function(){f(new Error(m.statusText))},m.onload=function(){if((m.status>=200&&m.status<300||m.status===0)&&m.response!==null){var k=m.response;if(u.type==="json")try{k=JSON.parse(m.response)}catch(A){return f(A)}f(null,k,m.getResponseHeader("Cache-Control"),m.getResponseHeader("Expires"))}else f(new ra(m.statusText,m.status,u.url))},m.send(u.body),{cancel:function(){return m.abort()}}}(e,t)},re=function(e,t){return fi(_e(e,{type:"arrayBuffer"}),t)},et=function(e,t){return fi(_e(e,{method:"POST"}),t)},R="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAC0lEQVQYV2NgAAIAAAUAAarVyFEAAAAASUVORK5CYII=";un=[],qi=0;var N=function(e,t){if(Ei.supported&&(e.headers||(e.headers={}),e.headers.accept="image/webp,*/*"),qi>=Gt.MAX_PARALLEL_IMAGE_REQUESTS){var i={requestParameters:e,callback:t,cancelled:!1,cancel:function(){this.cancelled=!0}};return un.push(i),i}qi++;var u=!1,f=function(){if(!u)for(u=!0,qi--;un.length&&qi<Gt.MAX_PARALLEL_IMAGE_REQUESTS;){var x=un.shift();x.cancelled||(x.cancel=N(x.requestParameters,x.callback).cancel)}},m=re(e,function(x,k,A,z){f(),x?t(x):k&&(vi()?function(D,B){var V=new M.Blob([new Uint8Array(D)],{type:"image/png"});M.createImageBitmap(V).then(function(j){B(null,j)}).catch(function(j){B(new Error("Could not load image because of "+j.message+". Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."))})}(k,t):function(D,B,V,j){var Q=new M.Image,$=M.URL;Q.onload=function(){B(null,Q),$.revokeObjectURL(Q.src),Q.onload=null,M.requestAnimationFrame(function(){Q.src=R})},Q.onerror=function(){return B(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."))};var pe=new M.Blob([new Uint8Array(D)],{type:"image/png"});Q.cacheControl=V,Q.expires=j,Q.src=D.byteLength?$.createObjectURL(pe):R}(k,t,A,z))});return{cancel:function(){m.cancel(),f()}}};function q(e,t,i){i[e]&&i[e].indexOf(t)!==-1||(i[e]=i[e]||[],i[e].push(t))}function K(e,t,i){if(i&&i[e]){var u=i[e].indexOf(t);u!==-1&&i[e].splice(u,1)}}var W=function(e,t){t===void 0&&(t={}),_e(this,t),this.type=e},le=function(e){function t(i,u){u===void 0&&(u={}),e.call(this,"error",_e({error:i},u))}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t}(W),fe=function(){};fe.prototype.on=function(e,t){return this._listeners=this._listeners||{},q(e,t,this._listeners),this},fe.prototype.off=function(e,t){return K(e,t,this._listeners),K(e,t,this._oneTimeListeners),this},fe.prototype.once=function(e,t){return this._oneTimeListeners=this._oneTimeListeners||{},q(e,t,this._oneTimeListeners),this},fe.prototype.fire=function(e,t){typeof e=="string"&&(e=new W(e,t||{}));var i=e.type;if(this.listens(i)){e.target=this;for(var u=0,f=this._listeners&&this._listeners[i]?this._listeners[i].slice():[];u<f.length;u+=1)f[u].call(this,e);for(var m=0,x=this._oneTimeListeners&&this._oneTimeListeners[i]?this._oneTimeListeners[i].slice():[];m<x.length;m+=1){var k=x[m];K(i,k,this._oneTimeListeners),k.call(this,e)}var A=this._eventedParent;A&&(_e(e,typeof this._eventedParentData=="function"?this._eventedParentData():this._eventedParentData),A.fire(e))}else e instanceof le&&console.error(e.error);return this},fe.prototype.listens=function(e){return this._listeners&&this._listeners[e]&&this._listeners[e].length>0||this._oneTimeListeners&&this._oneTimeListeners[e]&&this._oneTimeListeners[e].length>0||this._eventedParent&&this._eventedParent.listens(e)},fe.prototype.setEventedParent=function(e,t){return this._eventedParent=e,this._eventedParentData=t,this};var U={$version:8,$root:{version:{required:!0,type:"enum",values:[8]},name:{type:"string"},metadata:{type:"*"},center:{type:"array",value:"number"},zoom:{type:"number"},bearing:{type:"number",default:0,period:360,units:"degrees"},pitch:{type:"number",default:0,units:"degrees"},light:{type:"light"},sources:{required:!0,type:"sources"},sprite:{type:"string"},glyphs:{type:"string"},transition:{type:"transition"},layers:{required:!0,type:"array",value:"layer"}},sources:{"*":{type:"source"}},source:["source_vector","source_raster","source_raster_dem","source_geojson","source_video","source_image"],source_vector:{type:{required:!0,type:"enum",values:{vector:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},attribution:{type:"string"},promoteId:{type:"promoteId"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_raster:{type:{required:!0,type:"enum",values:{raster:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},attribution:{type:"string"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_raster_dem:{type:{required:!0,type:"enum",values:{"raster-dem":{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},attribution:{type:"string"},encoding:{type:"enum",values:{terrarium:{},mapbox:{}},default:"mapbox"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_geojson:{type:{required:!0,type:"enum",values:{geojson:{}}},data:{type:"*"},maxzoom:{type:"number",default:18},attribution:{type:"string"},buffer:{type:"number",default:128,maximum:512,minimum:0},filter:{type:"*"},tolerance:{type:"number",default:.375},cluster:{type:"boolean",default:!1},clusterRadius:{type:"number",default:50,minimum:0},clusterMaxZoom:{type:"number"},clusterMinPoints:{type:"number"},clusterProperties:{type:"*"},lineMetrics:{type:"boolean",default:!1},generateId:{type:"boolean",default:!1},promoteId:{type:"promoteId"}},source_video:{type:{required:!0,type:"enum",values:{video:{}}},urls:{required:!0,type:"array",value:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},source_image:{type:{required:!0,type:"enum",values:{image:{}}},url:{required:!0,type:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},layer:{id:{type:"string",required:!0},type:{type:"enum",values:{fill:{},line:{},symbol:{},circle:{},heatmap:{},"fill-extrusion":{},raster:{},hillshade:{},background:{}},required:!0},metadata:{type:"*"},source:{type:"string"},"source-layer":{type:"string"},minzoom:{type:"number",minimum:0,maximum:24},maxzoom:{type:"number",minimum:0,maximum:24},filter:{type:"filter"},layout:{type:"layout"},paint:{type:"paint"}},layout:["layout_fill","layout_line","layout_circle","layout_heatmap","layout_fill-extrusion","layout_symbol","layout_raster","layout_hillshade","layout_background"],layout_background:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_fill:{"fill-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_circle:{"circle-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_heatmap:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},"layout_fill-extrusion":{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_line:{"line-cap":{type:"enum",values:{butt:{},round:{},square:{}},default:"butt",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-join":{type:"enum",values:{bevel:{},round:{},miter:{}},default:"miter",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"line-miter-limit":{type:"number",default:2,requires:[{"line-join":"miter"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-round-limit":{type:"number",default:1.05,requires:[{"line-join":"round"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_symbol:{"symbol-placement":{type:"enum",values:{point:{},line:{},"line-center":{}},default:"point",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-spacing":{type:"number",default:250,minimum:1,units:"pixels",requires:[{"symbol-placement":"line"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"symbol-avoid-edges":{type:"boolean",default:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"symbol-z-order":{type:"enum",values:{auto:{},"viewport-y":{},source:{}},default:"auto",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-allow-overlap":{type:"boolean",default:!1,requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-ignore-placement":{type:"boolean",default:!1,requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-optional":{type:"boolean",default:!1,requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-rotation-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-size":{type:"number",default:1,minimum:0,units:"factor of the original icon size",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-text-fit":{type:"enum",values:{none:{},width:{},height:{},both:{}},default:"none",requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-text-fit-padding":{type:"array",value:"number",length:4,default:[0,0,0,0],units:"pixels",requires:["icon-image","text-field",{"icon-text-fit":["both","width","height"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-image":{type:"resolvedImage",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-padding":{type:"number",default:2,minimum:0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-keep-upright":{type:"boolean",default:!1,requires:["icon-image",{"icon-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-offset":{type:"array",value:"number",length:2,default:[0,0],requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotation-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-field":{type:"formatted",default:"",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-font":{type:"array",value:"string",default:["Open Sans Regular","Arial Unicode MS Regular"],requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-size":{type:"number",default:16,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-width":{type:"number",default:10,minimum:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-line-height":{type:"number",default:1.2,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-letter-spacing":{type:"number",default:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-justify":{type:"enum",values:{auto:{},left:{},center:{},right:{}},default:"center",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-radial-offset":{type:"number",units:"ems",default:0,requires:["text-field"],"property-type":"data-driven",expression:{interpolated:!0,parameters:["zoom","feature"]}},"text-variable-anchor":{type:"array",value:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["text-field",{"!":"text-variable-anchor"}],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-angle":{type:"number",default:45,units:"degrees",requires:["text-field",{"symbol-placement":["line","line-center"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-writing-mode":{type:"array",value:"enum",values:{horizontal:{},vertical:{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-padding":{type:"number",default:2,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-keep-upright":{type:"boolean",default:!0,requires:["text-field",{"text-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-transform":{type:"enum",values:{none:{},uppercase:{},lowercase:{}},default:"none",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-offset":{type:"array",value:"number",units:"ems",length:2,default:[0,0],requires:["text-field",{"!":"text-radial-offset"}],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-allow-overlap":{type:"boolean",default:!1,requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-ignore-placement":{type:"boolean",default:!1,requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-optional":{type:"boolean",default:!1,requires:["text-field","icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_raster:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_hillshade:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},filter:{type:"array",value:"*"},filter_operator:{type:"enum",values:{"==":{},"!=":{},">":{},">=":{},"<":{},"<=":{},in:{},"!in":{},all:{},any:{},none:{},has:{},"!has":{},within:{}}},geometry_type:{type:"enum",values:{Point:{},LineString:{},Polygon:{}}},function:{expression:{type:"expression"},stops:{type:"array",value:"function_stop"},base:{type:"number",default:1,minimum:0},property:{type:"string",default:"$zoom"},type:{type:"enum",values:{identity:{},exponential:{},interval:{},categorical:{}},default:"exponential"},colorSpace:{type:"enum",values:{rgb:{},lab:{},hcl:{}},default:"rgb"},default:{type:"*",required:!1}},function_stop:{type:"array",minimum:0,maximum:24,value:["number","color"],length:2},expression:{type:"array",value:"*",minimum:1},light:{anchor:{type:"enum",default:"viewport",values:{map:{},viewport:{}},"property-type":"data-constant",transition:!1,expression:{interpolated:!1,parameters:["zoom"]}},position:{type:"array",default:[1.15,210,30],length:3,value:"number","property-type":"data-constant",transition:!0,expression:{interpolated:!0,parameters:["zoom"]}},color:{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},intensity:{type:"number","property-type":"data-constant",default:.5,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0}},paint:["paint_fill","paint_line","paint_circle","paint_heatmap","paint_fill-extrusion","paint_symbol","paint_raster","paint_hillshade","paint_background"],paint_fill:{"fill-antialias":{type:"boolean",default:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-outline-color":{type:"color",transition:!0,requires:[{"!":"fill-pattern"},{"fill-antialias":!0}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"}},"paint_fill-extrusion":{"fill-extrusion-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-extrusion-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-extrusion-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"fill-extrusion-height":{type:"number",default:0,minimum:0,units:"meters",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-base":{type:"number",default:0,minimum:0,units:"meters",transition:!0,requires:["fill-extrusion-height"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-vertical-gradient":{type:"boolean",default:!0,transition:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_line:{"line-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"line-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["line-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-width":{type:"number",default:1,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-gap-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-offset":{type:"number",default:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-dasharray":{type:"array",value:"number",minimum:0,transition:!0,units:"line widths",requires:[{"!":"line-pattern"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"line-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"line-gradient":{type:"color",transition:!1,requires:[{"!":"line-dasharray"},{"!":"line-pattern"},{source:"geojson",has:{lineMetrics:!0}}],expression:{interpolated:!0,parameters:["line-progress"]},"property-type":"color-ramp"}},paint_circle:{"circle-radius":{type:"number",default:5,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-blur":{type:"number",default:0,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"circle-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["circle-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-scale":{type:"enum",values:{map:{},viewport:{}},default:"map",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-alignment":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-stroke-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"}},paint_heatmap:{"heatmap-radius":{type:"number",default:30,minimum:1,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-weight":{type:"number",default:1,minimum:0,transition:!1,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-intensity":{type:"number",default:1,minimum:0,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"heatmap-color":{type:"color",default:["interpolate",["linear"],["heatmap-density"],0,"rgba(0, 0, 255, 0)",.1,"royalblue",.3,"cyan",.5,"lime",.7,"yellow",1,"red"],transition:!1,expression:{interpolated:!0,parameters:["heatmap-density"]},"property-type":"color-ramp"},"heatmap-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_symbol:{"icon-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-color":{type:"color",default:"#000000",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["icon-image","icon-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-color":{type:"color",default:"#000000",transition:!0,overridable:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["text-field","text-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_raster:{"raster-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-hue-rotate":{type:"number",default:0,period:360,transition:!0,units:"degrees",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-min":{type:"number",default:0,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-max":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-saturation":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-contrast":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-resampling":{type:"enum",values:{linear:{},nearest:{}},default:"linear",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"raster-fade-duration":{type:"number",default:300,minimum:0,transition:!1,units:"milliseconds",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_hillshade:{"hillshade-illumination-direction":{type:"number",default:335,minimum:0,maximum:359,transition:!1,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-illumination-anchor":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-exaggeration":{type:"number",default:.5,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-shadow-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-highlight-color":{type:"color",default:"#FFFFFF",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-accent-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_background:{"background-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"background-pattern"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"background-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"background-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},transition:{duration:{type:"number",default:300,minimum:0,units:"milliseconds"},delay:{type:"number",default:0,minimum:0,units:"milliseconds"}},"property-type":{"data-driven":{type:"property-type"},"cross-faded":{type:"property-type"},"cross-faded-data-driven":{type:"property-type"},"color-ramp":{type:"property-type"},"data-constant":{type:"property-type"},constant:{type:"property-type"}},promoteId:{"*":{type:"string"}}},J=function(e,t,i,u){this.message=(e?e+": ":"")+i,u&&(this.identifier=u),t!=null&&t.__line__&&(this.line=t.__line__)};function ge(e){var t=e.value;return t?[new J(e.key,t,"constants have been deprecated as of v8")]:[]}function De(e){for(var t=[],i=arguments.length-1;i-- >0;)t[i]=arguments[i+1];for(var u=0,f=t;u<f.length;u+=1){var m=f[u];for(var x in m)e[x]=m[x]}return e}function Ne(e){return e instanceof Number||e instanceof String||e instanceof Boolean?e.valueOf():e}function ke(e){if(Array.isArray(e))return e.map(ke);if(e instanceof Object&&!(e instanceof Number||e instanceof String||e instanceof Boolean)){var t={};for(var i in e)t[i]=ke(e[i]);return t}return Ne(e)}var Le=function(e){function t(i,u){e.call(this,u),this.message=u,this.key=i}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t}(Error),pt=function(e,t){t===void 0&&(t=[]),this.parent=e,this.bindings={};for(var i=0,u=t;i<u.length;i+=1){var f=u[i];this.bindings[f[0]]=f[1]}};pt.prototype.concat=function(e){return new pt(this,e)},pt.prototype.get=function(e){if(this.bindings[e])return this.bindings[e];if(this.parent)return this.parent.get(e);throw new Error(e+" not found in scope.")},pt.prototype.has=function(e){return!!this.bindings[e]||!!this.parent&&this.parent.has(e)};var lt={kind:"null"},Ie={kind:"number"},nt={kind:"string"},Je={kind:"boolean"},He={kind:"color"},Zt={kind:"object"},st={kind:"value"},nr={kind:"collator"},br={kind:"formatted"},Xt={kind:"resolvedImage"};function pr(e,t){return{kind:"array",itemType:e,N:t}}function ar(e){if(e.kind==="array"){var t=ar(e.itemType);return typeof e.N=="number"?"array<"+t+", "+e.N+">":e.itemType.kind==="value"?"array":"array<"+t+">"}return e.kind}var bi=[lt,Ie,nt,Je,He,br,Zt,pr(st),Xt];function mr(e,t){if(t.kind==="error")return null;if(e.kind==="array"){if(t.kind==="array"&&(t.N===0&&t.itemType.kind==="value"||!mr(e.itemType,t.itemType))&&(typeof e.N!="number"||e.N===t.N))return null}else{if(e.kind===t.kind)return null;if(e.kind==="value"){for(var i=0,u=bi;i<u.length;i+=1)if(!mr(u[i],t))return null}}return"Expected "+ar(e)+" but found "+ar(t)+" instead."}function Fr(e,t){return t.some(function(i){return i.kind===e.kind})}function vr(e,t){return t.some(function(i){return i==="null"?e===null:i==="array"?Array.isArray(e):i==="object"?e&&!Array.isArray(e)&&typeof e=="object":i===typeof e})}var Qt=E(function(e,t){var i={transparent:[0,0,0,0],aliceblue:[240,248,255,1],antiquewhite:[250,235,215,1],aqua:[0,255,255,1],aquamarine:[127,255,212,1],azure:[240,255,255,1],beige:[245,245,220,1],bisque:[255,228,196,1],black:[0,0,0,1],blanchedalmond:[255,235,205,1],blue:[0,0,255,1],blueviolet:[138,43,226,1],brown:[165,42,42,1],burlywood:[222,184,135,1],cadetblue:[95,158,160,1],chartreuse:[127,255,0,1],chocolate:[210,105,30,1],coral:[255,127,80,1],cornflowerblue:[100,149,237,1],cornsilk:[255,248,220,1],crimson:[220,20,60,1],cyan:[0,255,255,1],darkblue:[0,0,139,1],darkcyan:[0,139,139,1],darkgoldenrod:[184,134,11,1],darkgray:[169,169,169,1],darkgreen:[0,100,0,1],darkgrey:[169,169,169,1],darkkhaki:[189,183,107,1],darkmagenta:[139,0,139,1],darkolivegreen:[85,107,47,1],darkorange:[255,140,0,1],darkorchid:[153,50,204,1],darkred:[139,0,0,1],darksalmon:[233,150,122,1],darkseagreen:[143,188,143,1],darkslateblue:[72,61,139,1],darkslategray:[47,79,79,1],darkslategrey:[47,79,79,1],darkturquoise:[0,206,209,1],darkviolet:[148,0,211,1],deeppink:[255,20,147,1],deepskyblue:[0,191,255,1],dimgray:[105,105,105,1],dimgrey:[105,105,105,1],dodgerblue:[30,144,255,1],firebrick:[178,34,34,1],floralwhite:[255,250,240,1],forestgreen:[34,139,34,1],fuchsia:[255,0,255,1],gainsboro:[220,220,220,1],ghostwhite:[248,248,255,1],gold:[255,215,0,1],goldenrod:[218,165,32,1],gray:[128,128,128,1],green:[0,128,0,1],greenyellow:[173,255,47,1],grey:[128,128,128,1],honeydew:[240,255,240,1],hotpink:[255,105,180,1],indianred:[205,92,92,1],indigo:[75,0,130,1],ivory:[255,255,240,1],khaki:[240,230,140,1],lavender:[230,230,250,1],lavenderblush:[255,240,245,1],lawngreen:[124,252,0,1],lemonchiffon:[255,250,205,1],lightblue:[173,216,230,1],lightcoral:[240,128,128,1],lightcyan:[224,255,255,1],lightgoldenrodyellow:[250,250,210,1],lightgray:[211,211,211,1],lightgreen:[144,238,144,1],lightgrey:[211,211,211,1],lightpink:[255,182,193,1],lightsalmon:[255,160,122,1],lightseagreen:[32,178,170,1],lightskyblue:[135,206,250,1],lightslategray:[119,136,153,1],lightslategrey:[119,136,153,1],lightsteelblue:[176,196,222,1],lightyellow:[255,255,224,1],lime:[0,255,0,1],limegreen:[50,205,50,1],linen:[250,240,230,1],magenta:[255,0,255,1],maroon:[128,0,0,1],mediumaquamarine:[102,205,170,1],mediumblue:[0,0,205,1],mediumorchid:[186,85,211,1],mediumpurple:[147,112,219,1],mediumseagreen:[60,179,113,1],mediumslateblue:[123,104,238,1],mediumspringgreen:[0,250,154,1],mediumturquoise:[72,209,204,1],mediumvioletred:[199,21,133,1],midnightblue:[25,25,112,1],mintcream:[245,255,250,1],mistyrose:[255,228,225,1],moccasin:[255,228,181,1],navajowhite:[255,222,173,1],navy:[0,0,128,1],oldlace:[253,245,230,1],olive:[128,128,0,1],olivedrab:[107,142,35,1],orange:[255,165,0,1],orangered:[255,69,0,1],orchid:[218,112,214,1],palegoldenrod:[238,232,170,1],palegreen:[152,251,152,1],paleturquoise:[175,238,238,1],palevioletred:[219,112,147,1],papayawhip:[255,239,213,1],peachpuff:[255,218,185,1],peru:[205,133,63,1],pink:[255,192,203,1],plum:[221,160,221,1],powderblue:[176,224,230,1],purple:[128,0,128,1],rebeccapurple:[102,51,153,1],red:[255,0,0,1],rosybrown:[188,143,143,1],royalblue:[65,105,225,1],saddlebrown:[139,69,19,1],salmon:[250,128,114,1],sandybrown:[244,164,96,1],seagreen:[46,139,87,1],seashell:[255,245,238,1],sienna:[160,82,45,1],silver:[192,192,192,1],skyblue:[135,206,235,1],slateblue:[106,90,205,1],slategray:[112,128,144,1],slategrey:[112,128,144,1],snow:[255,250,250,1],springgreen:[0,255,127,1],steelblue:[70,130,180,1],tan:[210,180,140,1],teal:[0,128,128,1],thistle:[216,191,216,1],tomato:[255,99,71,1],turquoise:[64,224,208,1],violet:[238,130,238,1],wheat:[245,222,179,1],white:[255,255,255,1],whitesmoke:[245,245,245,1],yellow:[255,255,0,1],yellowgreen:[154,205,50,1]};function u(k){return(k=Math.round(k))<0?0:k>255?255:k}function f(k){return u(k[k.length-1]==="%"?parseFloat(k)/100*255:parseInt(k))}function m(k){return(A=k[k.length-1]==="%"?parseFloat(k)/100:parseFloat(k))<0?0:A>1?1:A;var A}function x(k,A,z){return z<0?z+=1:z>1&&(z-=1),6*z<1?k+(A-k)*z*6:2*z<1?A:3*z<2?k+(A-k)*(2/3-z)*6:k}try{t.parseCSSColor=function(k){var A,z=k.replace(/ /g,"").toLowerCase();if(z in i)return i[z].slice();if(z[0]==="#")return z.length===4?(A=parseInt(z.substr(1),16))>=0&&A<=4095?[(3840&A)>>4|(3840&A)>>8,240&A|(240&A)>>4,15&A|(15&A)<<4,1]:null:z.length===7&&(A=parseInt(z.substr(1),16))>=0&&A<=16777215?[(16711680&A)>>16,(65280&A)>>8,255&A,1]:null;var D=z.indexOf("("),B=z.indexOf(")");if(D!==-1&&B+1===z.length){var V=z.substr(0,D),j=z.substr(D+1,B-(D+1)).split(","),Q=1;switch(V){case"rgba":if(j.length!==4)return null;Q=m(j.pop());case"rgb":return j.length!==3?null:[f(j[0]),f(j[1]),f(j[2]),Q];case"hsla":if(j.length!==4)return null;Q=m(j.pop());case"hsl":if(j.length!==3)return null;var $=(parseFloat(j[0])%360+360)%360/360,pe=m(j[1]),oe=m(j[2]),ye=oe<=.5?oe*(pe+1):oe+pe-oe*pe,xe=2*oe-ye;return[u(255*x(xe,ye,$+1/3)),u(255*x(xe,ye,$)),u(255*x(xe,ye,$-1/3)),Q];default:return null}}return null}}catch{}}).parseCSSColor,fr=function(e,t,i,u){u===void 0&&(u=1),this.r=e,this.g=t,this.b=i,this.a=u};fr.parse=function(e){if(e){if(e instanceof fr)return e;if(typeof e=="string"){var t=Qt(e);if(t)return new fr(t[0]/255*t[3],t[1]/255*t[3],t[2]/255*t[3],t[3])}}},fr.prototype.toString=function(){var e=this.toArray(),t=e[1],i=e[2],u=e[3];return"rgba("+Math.round(e[0])+","+Math.round(t)+","+Math.round(i)+","+u+")"},fr.prototype.toArray=function(){var e=this.a;return e===0?[0,0,0,0]:[255*this.r/e,255*this.g/e,255*this.b/e,e]},fr.black=new fr(0,0,0,1),fr.white=new fr(1,1,1,1),fr.transparent=new fr(0,0,0,0),fr.red=new fr(1,0,0,1);var Ti=function(e,t,i){this.sensitivity=e?t?"variant":"case":t?"accent":"base",this.locale=i,this.collator=new Intl.Collator(this.locale?this.locale:[],{sensitivity:this.sensitivity,usage:"search"})};Ti.prototype.compare=function(e,t){return this.collator.compare(e,t)},Ti.prototype.resolvedLocale=function(){return new Intl.Collator(this.locale?this.locale:[]).resolvedOptions().locale};var pa=function(e,t,i,u,f){this.text=e,this.image=t,this.scale=i,this.fontStack=u,this.textColor=f},ai=function(e){this.sections=e};ai.fromString=function(e){return new ai([new pa(e,null,null,null,null)])},ai.prototype.isEmpty=function(){return this.sections.length===0||!this.sections.some(function(e){return e.text.length!==0||e.image&&e.image.name.length!==0})},ai.factory=function(e){return e instanceof ai?e:ai.fromString(e)},ai.prototype.toString=function(){return this.sections.length===0?"":this.sections.map(function(e){return e.text}).join("")},ai.prototype.serialize=function(){for(var e=["format"],t=0,i=this.sections;t<i.length;t+=1){var u=i[t];if(u.image)e.push(["image",u.image.name]);else{e.push(u.text);var f={};u.fontStack&&(f["text-font"]=["literal",u.fontStack.split(",")]),u.scale&&(f["font-scale"]=u.scale),u.textColor&&(f["text-color"]=["rgba"].concat(u.textColor.toArray())),e.push(f)}}return e};var Bi=function(e){this.name=e.name,this.available=e.available};function Na(e,t,i,u){return typeof e=="number"&&e>=0&&e<=255&&typeof t=="number"&&t>=0&&t<=255&&typeof i=="number"&&i>=0&&i<=255?u===void 0||typeof u=="number"&&u>=0&&u<=1?null:"Invalid rgba value ["+[e,t,i,u].join(", ")+"]: 'a' must be between 0 and 1.":"Invalid rgba value ["+(typeof u=="number"?[e,t,i,u]:[e,t,i]).join(", ")+"]: 'r', 'g', and 'b' must be between 0 and 255."}function va(e){if(e===null||typeof e=="string"||typeof e=="boolean"||typeof e=="number"||e instanceof fr||e instanceof Ti||e instanceof ai||e instanceof Bi)return!0;if(Array.isArray(e)){for(var t=0,i=e;t<i.length;t+=1)if(!va(i[t]))return!1;return!0}if(typeof e=="object"){for(var u in e)if(!va(e[u]))return!1;return!0}return!1}function jr(e){if(e===null)return lt;if(typeof e=="string")return nt;if(typeof e=="boolean")return Je;if(typeof e=="number")return Ie;if(e instanceof fr)return He;if(e instanceof Ti)return nr;if(e instanceof ai)return br;if(e instanceof Bi)return Xt;if(Array.isArray(e)){for(var t,i=e.length,u=0,f=e;u<f.length;u+=1){var m=jr(f[u]);if(t){if(t===m)continue;t=st;break}t=m}return pr(t||st,i)}return Zt}function ba(e){var t=typeof e;return e===null?"":t==="string"||t==="number"||t==="boolean"?String(e):e instanceof fr||e instanceof ai||e instanceof Bi?e.toString():JSON.stringify(e)}Bi.prototype.toString=function(){return this.name},Bi.fromString=function(e){return e?new Bi({name:e,available:!1}):null},Bi.prototype.serialize=function(){return["image",this.name]};var Ii=function(e,t){this.type=e,this.value=t};Ii.parse=function(e,t){if(e.length!==2)return t.error("'literal' expression requires exactly one argument, but found "+(e.length-1)+" instead.");if(!va(e[1]))return t.error("invalid value");var i=e[1],u=jr(i),f=t.expectedType;return u.kind!=="array"||u.N!==0||!f||f.kind!=="array"||typeof f.N=="number"&&f.N!==0||(u=f),new Ii(u,i)},Ii.prototype.evaluate=function(){return this.value},Ii.prototype.eachChild=function(){},Ii.prototype.outputDefined=function(){return!0},Ii.prototype.serialize=function(){return this.type.kind==="array"||this.type.kind==="object"?["literal",this.value]:this.value instanceof fr?["rgba"].concat(this.value.toArray()):this.value instanceof ai?this.value.serialize():this.value};var oi=function(e){this.name="ExpressionEvaluationError",this.message=e};oi.prototype.toJSON=function(){return this.message};var cn={string:nt,number:Ie,boolean:Je,object:Zt},Cr=function(e,t){this.type=e,this.args=t};Cr.parse=function(e,t){if(e.length<2)return t.error("Expected at least one argument.");var i,u=1,f=e[0];if(f==="array"){var m,x;if(e.length>2){var k=e[1];if(typeof k!="string"||!(k in cn)||k==="object")return t.error('The item type argument of "array" must be one of string, number, boolean',1);m=cn[k],u++}else m=st;if(e.length>3){if(e[2]!==null&&(typeof e[2]!="number"||e[2]<0||e[2]!==Math.floor(e[2])))return t.error('The length argument to "array" must be a positive integer literal',2);x=e[2],u++}i=pr(m,x)}else i=cn[f];for(var A=[];u<e.length;u++){var z=t.parse(e[u],u,st);if(!z)return null;A.push(z)}return new Cr(i,A)},Cr.prototype.evaluate=function(e){for(var t=0;t<this.args.length;t++){var i=this.args[t].evaluate(e);if(!mr(this.type,jr(i)))return i;if(t===this.args.length-1)throw new oi("Expected value to be of type "+ar(this.type)+", but found "+ar(jr(i))+" instead.")}return null},Cr.prototype.eachChild=function(e){this.args.forEach(e)},Cr.prototype.outputDefined=function(){return this.args.every(function(e){return e.outputDefined()})},Cr.prototype.serialize=function(){var e=this.type,t=[e.kind];if(e.kind==="array"){var i=e.itemType;if(i.kind==="string"||i.kind==="number"||i.kind==="boolean"){t.push(i.kind);var u=e.N;(typeof u=="number"||this.args.length>1)&&t.push(u)}}return t.concat(this.args.map(function(f){return f.serialize()}))};var On=function(e){this.type=br,this.sections=e};On.parse=function(e,t){if(e.length<2)return t.error("Expected at least one argument.");var i=e[1];if(!Array.isArray(i)&&typeof i=="object")return t.error("First argument must be an image or text section.");for(var u=[],f=!1,m=1;m<=e.length-1;++m){var x=e[m];if(f&&typeof x=="object"&&!Array.isArray(x)){f=!1;var k=null;if(x["font-scale"]&&!(k=t.parse(x["font-scale"],1,Ie)))return null;var A=null;if(x["text-font"]&&!(A=t.parse(x["text-font"],1,pr(nt))))return null;var z=null;if(x["text-color"]&&!(z=t.parse(x["text-color"],1,He)))return null;var D=u[u.length-1];D.scale=k,D.font=A,D.textColor=z}else{var B=t.parse(e[m],1,st);if(!B)return null;var V=B.type.kind;if(V!=="string"&&V!=="value"&&V!=="null"&&V!=="resolvedImage")return t.error("Formatted text type must be 'string', 'value', 'image' or 'null'.");f=!0,u.push({content:B,scale:null,font:null,textColor:null})}}return new On(u)},On.prototype.evaluate=function(e){return new ai(this.sections.map(function(t){var i=t.content.evaluate(e);return jr(i)===Xt?new pa("",i,null,null,null):new pa(ba(i),null,t.scale?t.scale.evaluate(e):null,t.font?t.font.evaluate(e).join(","):null,t.textColor?t.textColor.evaluate(e):null)}))},On.prototype.eachChild=function(e){for(var t=0,i=this.sections;t<i.length;t+=1){var u=i[t];e(u.content),u.scale&&e(u.scale),u.font&&e(u.font),u.textColor&&e(u.textColor)}},On.prototype.outputDefined=function(){return!1},On.prototype.serialize=function(){for(var e=["format"],t=0,i=this.sections;t<i.length;t+=1){var u=i[t];e.push(u.content.serialize());var f={};u.scale&&(f["font-scale"]=u.scale.serialize()),u.font&&(f["text-font"]=u.font.serialize()),u.textColor&&(f["text-color"]=u.textColor.serialize()),e.push(f)}return e};var yn=function(e){this.type=Xt,this.input=e};yn.parse=function(e,t){if(e.length!==2)return t.error("Expected two arguments.");var i=t.parse(e[1],1,nt);return i?new yn(i):t.error("No image name provided.")},yn.prototype.evaluate=function(e){var t=this.input.evaluate(e),i=Bi.fromString(t);return i&&e.availableImages&&(i.available=e.availableImages.indexOf(t)>-1),i},yn.prototype.eachChild=function(e){e(this.input)},yn.prototype.outputDefined=function(){return!1},yn.prototype.serialize=function(){return["image",this.input.serialize()]};var is={"to-boolean":Je,"to-color":He,"to-number":Ie,"to-string":nt},Ai=function(e,t){this.type=e,this.args=t};Ai.parse=function(e,t){if(e.length<2)return t.error("Expected at least one argument.");var i=e[0];if((i==="to-boolean"||i==="to-string")&&e.length!==2)return t.error("Expected one argument.");for(var u=is[i],f=[],m=1;m<e.length;m++){var x=t.parse(e[m],m,st);if(!x)return null;f.push(x)}return new Ai(u,f)},Ai.prototype.evaluate=function(e){if(this.type.kind==="boolean")return!!this.args[0].evaluate(e);if(this.type.kind==="color"){for(var t,i,u=0,f=this.args;u<f.length;u+=1){if(i=null,(t=f[u].evaluate(e))instanceof fr)return t;if(typeof t=="string"){var m=e.parseColor(t);if(m)return m}else if(Array.isArray(t)&&!(i=t.length<3||t.length>4?"Invalid rbga value "+JSON.stringify(t)+": expected an array containing either three or four numeric values.":Na(t[0],t[1],t[2],t[3])))return new fr(t[0]/255,t[1]/255,t[2]/255,t[3])}throw new oi(i||"Could not parse color from value '"+(typeof t=="string"?t:String(JSON.stringify(t)))+"'")}if(this.type.kind==="number"){for(var x=null,k=0,A=this.args;k<A.length;k+=1){if((x=A[k].evaluate(e))===null)return 0;var z=Number(x);if(!isNaN(z))return z}throw new oi("Could not convert "+JSON.stringify(x)+" to number.")}return this.type.kind==="formatted"?ai.fromString(ba(this.args[0].evaluate(e))):this.type.kind==="resolvedImage"?Bi.fromString(ba(this.args[0].evaluate(e))):ba(this.args[0].evaluate(e))},Ai.prototype.eachChild=function(e){this.args.forEach(e)},Ai.prototype.outputDefined=function(){return this.args.every(function(e){return e.outputDefined()})},Ai.prototype.serialize=function(){if(this.type.kind==="formatted")return new On([{content:this.args[0],scale:null,font:null,textColor:null}]).serialize();if(this.type.kind==="resolvedImage")return new yn(this.args[0]).serialize();var e=["to-"+this.type.kind];return this.eachChild(function(t){e.push(t.serialize())}),e};var xa=["Unknown","Point","LineString","Polygon"],ji=function(){this.globals=null,this.feature=null,this.featureState=null,this.formattedSection=null,this._parseColorCache={},this.availableImages=null,this.canonical=null};ji.prototype.id=function(){return this.feature&&"id"in this.feature?this.feature.id:null},ji.prototype.geometryType=function(){return this.feature?typeof this.feature.type=="number"?xa[this.feature.type]:this.feature.type:null},ji.prototype.geometry=function(){return this.feature&&"geometry"in this.feature?this.feature.geometry:null},ji.prototype.canonicalID=function(){return this.canonical},ji.prototype.properties=function(){return this.feature&&this.feature.properties||{}},ji.prototype.parseColor=function(e){var t=this._parseColorCache[e];return t||(t=this._parseColorCache[e]=fr.parse(e)),t};var zi=function(e,t,i,u){this.name=e,this.type=t,this._evaluate=i,this.args=u};zi.prototype.evaluate=function(e){return this._evaluate(e,this.args)},zi.prototype.eachChild=function(e){this.args.forEach(e)},zi.prototype.outputDefined=function(){return!1},zi.prototype.serialize=function(){return[this.name].concat(this.args.map(function(e){return e.serialize()}))},zi.parse=function(e,t){var i,u=e[0],f=zi.definitions[u];if(!f)return t.error('Unknown expression "'+u+'". If you wanted a literal array, use ["literal", [...]].',0);for(var m=Array.isArray(f)?f[0]:f.type,x=Array.isArray(f)?[[f[1],f[2]]]:f.overloads,k=x.filter(function(It){var ht=It[0];return!Array.isArray(ht)||ht.length===e.length-1}),A=null,z=0,D=k;z<D.length;z+=1){var B=D[z],V=B[0],j=B[1];A=new Gr(t.registry,t.path,null,t.scope);for(var Q=[],$=!1,pe=1;pe<e.length;pe++){var oe=e[pe],ye=Array.isArray(V)?V[pe-1]:V.type,xe=A.parse(oe,1+Q.length,ye);if(!xe){$=!0;break}Q.push(xe)}if(!$)if(Array.isArray(V)&&V.length!==Q.length)A.error("Expected "+V.length+" arguments, but found "+Q.length+" instead.");else{for(var Se=0;Se<Q.length;Se++){var Te=Array.isArray(V)?V[Se]:V.type,Me=Q[Se];A.concat(Se+1).checkSubtype(Te,Me.type)}if(A.errors.length===0)return new zi(u,m,j,Q)}}if(k.length===1)(i=t.errors).push.apply(i,A.errors);else{for(var Xe=(k.length?k:x).map(function(It){var ht;return ht=It[0],Array.isArray(ht)?"("+ht.map(ar).join(", ")+")":"("+ar(ht.type)+"...)"}).join(" | "),rt=[],wt=1;wt<e.length;wt++){var ut=t.parse(e[wt],1+rt.length);if(!ut)return null;rt.push(ar(ut.type))}t.error("Expected arguments of type "+Xe+", but found ("+rt.join(", ")+") instead.")}return null},zi.register=function(e,t){for(var i in zi.definitions=t,t)e[i]=zi};var Jn=function(e,t,i){this.type=nr,this.locale=i,this.caseSensitive=e,this.diacriticSensitive=t};function Gi(e,t){e[0]=Math.min(e[0],t[0]),e[1]=Math.min(e[1],t[1]),e[2]=Math.max(e[2],t[0]),e[3]=Math.max(e[3],t[1])}function wa(e,t){return!(e[0]<=t[0]||e[2]>=t[2]||e[1]<=t[1]||e[3]>=t[3])}function ns(e,t){var i=(180+e[0])/360,u=(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+e[1]*Math.PI/360)))/360,f=Math.pow(2,t.z);return[Math.round(i*f*8192),Math.round(u*f*8192)]}function Fl(e,t,i){return t[1]>e[1]!=i[1]>e[1]&&e[0]<(i[0]-t[0])*(e[1]-t[1])/(i[1]-t[1])+t[0]}function uo(e,t){for(var i,u,f,m,x,k,A,z=!1,D=0,B=t.length;D<B;D++)for(var V=t[D],j=0,Q=V.length;j<Q-1;j++){if((m=(i=e)[0]-(u=V[j])[0])*(A=i[1]-(f=V[j+1])[1])-(k=i[0]-f[0])*(x=i[1]-u[1])==0&&m*k<=0&&x*A<=0)return!1;Fl(e,V[j],V[j+1])&&(z=!z)}return z}function Nl(e,t){for(var i=0;i<t.length;i++)if(uo(e,t[i]))return!0;return!1}function Ro(e,t,i,u){var f=u[0]-i[0],m=u[1]-i[1],x=(e[0]-i[0])*m-f*(e[1]-i[1]),k=(t[0]-i[0])*m-f*(t[1]-i[1]);return x>0&&k<0||x<0&&k>0}function Vl(e,t,i){for(var u=0,f=i;u<f.length;u+=1)for(var m=f[u],x=0;x<m.length-1;++x)if((B=[(D=m[x+1])[0]-(z=m[x])[0],D[1]-z[1]])[0]*(V=[(A=t)[0]-(k=e)[0],A[1]-k[1]])[1]-B[1]*V[0]!=0&&Ro(k,A,z,D)&&Ro(z,D,k,A))return!0;var k,A,z,D,B,V;return!1}function Bo(e,t){for(var i=0;i<e.length;++i)if(!uo(e[i],t))return!1;for(var u=0;u<e.length-1;++u)if(Vl(e[u],e[u+1],t))return!1;return!0}function Os(e,t){for(var i=0;i<t.length;i++)if(Bo(e,t[i]))return!0;return!1}function Va(e,t,i){for(var u=[],f=0;f<e.length;f++){for(var m=[],x=0;x<e[f].length;x++){var k=ns(e[f][x],i);Gi(t,k),m.push(k)}u.push(m)}return u}function as(e,t,i){for(var u=[],f=0;f<e.length;f++){var m=Va(e[f],t,i);u.push(m)}return u}function co(e,t,i,u){if(e[0]<i[0]||e[0]>i[2]){var f=.5*u,m=e[0]-i[0]>f?-u:i[0]-e[0]>f?u:0;m===0&&(m=e[0]-i[2]>f?-u:i[2]-e[0]>f?u:0),e[0]+=m}Gi(t,e)}function Fs(e,t,i,u){for(var f=8192*Math.pow(2,u.z),m=[8192*u.x,8192*u.y],x=[],k=0,A=e;k<A.length;k+=1)for(var z=0,D=A[k];z<D.length;z+=1){var B=D[z],V=[B.x+m[0],B.y+m[1]];co(V,t,i,f),x.push(V)}return x}function Ua(e,t,i,u){for(var f,m=8192*Math.pow(2,u.z),x=[8192*u.x,8192*u.y],k=[],A=0,z=e;A<z.length;A+=1){for(var D=[],B=0,V=z[A];B<V.length;B+=1){var j=V[B],Q=[j.x+x[0],j.y+x[1]];Gi(t,Q),D.push(Q)}k.push(D)}if(t[2]-t[0]<=m/2){(f=t)[0]=f[1]=1/0,f[2]=f[3]=-1/0;for(var $=0,pe=k;$<pe.length;$+=1)for(var oe=0,ye=pe[$];oe<ye.length;oe+=1)co(ye[oe],t,i,m)}return k}Jn.parse=function(e,t){if(e.length!==2)return t.error("Expected one argument.");var i=e[1];if(typeof i!="object"||Array.isArray(i))return t.error("Collator options argument must be an object.");var u=t.parse(i["case-sensitive"]!==void 0&&i["case-sensitive"],1,Je);if(!u)return null;var f=t.parse(i["diacritic-sensitive"]!==void 0&&i["diacritic-sensitive"],1,Je);if(!f)return null;var m=null;return i.locale&&!(m=t.parse(i.locale,1,nt))?null:new Jn(u,f,m)},Jn.prototype.evaluate=function(e){return new Ti(this.caseSensitive.evaluate(e),this.diacriticSensitive.evaluate(e),this.locale?this.locale.evaluate(e):null)},Jn.prototype.eachChild=function(e){e(this.caseSensitive),e(this.diacriticSensitive),this.locale&&e(this.locale)},Jn.prototype.outputDefined=function(){return!1},Jn.prototype.serialize=function(){var e={};return e["case-sensitive"]=this.caseSensitive.serialize(),e["diacritic-sensitive"]=this.diacriticSensitive.serialize(),this.locale&&(e.locale=this.locale.serialize()),["collator",e]};var Fn=function(e,t){this.type=Je,this.geojson=e,this.geometries=t};function Sa(e){if(e instanceof zi&&(e.name==="get"&&e.args.length===1||e.name==="feature-state"||e.name==="has"&&e.args.length===1||e.name==="properties"||e.name==="geometry-type"||e.name==="id"||/^filter-/.test(e.name))||e instanceof Fn)return!1;var t=!0;return e.eachChild(function(i){t&&!Sa(i)&&(t=!1)}),t}function ve(e){if(e instanceof zi&&e.name==="feature-state")return!1;var t=!0;return e.eachChild(function(i){t&&!ve(i)&&(t=!1)}),t}function hn(e,t){if(e instanceof zi&&t.indexOf(e.name)>=0)return!1;var i=!0;return e.eachChild(function(u){i&&!hn(u,t)&&(i=!1)}),i}Fn.parse=function(e,t){if(e.length!==2)return t.error("'within' expression requires exactly one argument, but found "+(e.length-1)+" instead.");if(va(e[1])){var i=e[1];if(i.type==="FeatureCollection")for(var u=0;u<i.features.length;++u){var f=i.features[u].geometry.type;if(f==="Polygon"||f==="MultiPolygon")return new Fn(i,i.features[u].geometry)}else if(i.type==="Feature"){var m=i.geometry.type;if(m==="Polygon"||m==="MultiPolygon")return new Fn(i,i.geometry)}else if(i.type==="Polygon"||i.type==="MultiPolygon")return new Fn(i,i)}return t.error("'within' expression requires valid geojson object that contains polygon geometry type.")},Fn.prototype.evaluate=function(e){if(e.geometry()!=null&&e.canonicalID()!=null){if(e.geometryType()==="Point")return function(t,i){var u=[1/0,1/0,-1/0,-1/0],f=[1/0,1/0,-1/0,-1/0],m=t.canonicalID();if(i.type==="Polygon"){var x=Va(i.coordinates,f,m),k=Fs(t.geometry(),u,f,m);if(!wa(u,f))return!1;for(var A=0,z=k;A<z.length;A+=1)if(!uo(z[A],x))return!1}if(i.type==="MultiPolygon"){var D=as(i.coordinates,f,m),B=Fs(t.geometry(),u,f,m);if(!wa(u,f))return!1;for(var V=0,j=B;V<j.length;V+=1)if(!Nl(j[V],D))return!1}return!0}(e,this.geometries);if(e.geometryType()==="LineString")return function(t,i){var u=[1/0,1/0,-1/0,-1/0],f=[1/0,1/0,-1/0,-1/0],m=t.canonicalID();if(i.type==="Polygon"){var x=Va(i.coordinates,f,m),k=Ua(t.geometry(),u,f,m);if(!wa(u,f))return!1;for(var A=0,z=k;A<z.length;A+=1)if(!Bo(z[A],x))return!1}if(i.type==="MultiPolygon"){var D=as(i.coordinates,f,m),B=Ua(t.geometry(),u,f,m);if(!wa(u,f))return!1;for(var V=0,j=B;V<j.length;V+=1)if(!Os(j[V],D))return!1}return!0}(e,this.geometries)}return!1},Fn.prototype.eachChild=function(){},Fn.prototype.outputDefined=function(){return!0},Fn.prototype.serialize=function(){return["within",this.geojson]};var Zi=function(e,t){this.type=t.type,this.name=e,this.boundExpression=t};Zi.parse=function(e,t){if(e.length!==2||typeof e[1]!="string")return t.error("'var' expression requires exactly one string literal argument.");var i=e[1];return t.scope.has(i)?new Zi(i,t.scope.get(i)):t.error('Unknown variable "'+i+'". Make sure "'+i+'" has been bound in an enclosing "let" expression before using it.',1)},Zi.prototype.evaluate=function(e){return this.boundExpression.evaluate(e)},Zi.prototype.eachChild=function(){},Zi.prototype.outputDefined=function(){return!1},Zi.prototype.serialize=function(){return["var",this.name]};var Gr=function(e,t,i,u,f){t===void 0&&(t=[]),u===void 0&&(u=new pt),f===void 0&&(f=[]),this.registry=e,this.path=t,this.key=t.map(function(m){return"["+m+"]"}).join(""),this.scope=u,this.errors=f,this.expectedType=i};function ka(e,t){for(var i,u=e.length-1,f=0,m=u,x=0;f<=m;)if((i=e[x=Math.floor((f+m)/2)])<=t){if(x===u||t<e[x+1])return x;f=x+1}else{if(!(i>t))throw new oi("Input is not a number.");m=x-1}return 0}Gr.prototype.parse=function(e,t,i,u,f){return f===void 0&&(f={}),t?this.concat(t,i,u)._parse(e,f):this._parse(e,f)},Gr.prototype._parse=function(e,t){function i(z,D,B){return B==="assert"?new Cr(D,[z]):B==="coerce"?new Ai(D,[z]):z}if(e!==null&&typeof e!="string"&&typeof e!="boolean"&&typeof e!="number"||(e=["literal",e]),Array.isArray(e)){if(e.length===0)return this.error('Expected an array with at least one element. If you wanted a literal array, use ["literal", []].');var u=e[0];if(typeof u!="string")return this.error("Expression name must be a string, but found "+typeof u+' instead. If you wanted a literal array, use ["literal", [...]].',0),null;var f=this.registry[u];if(f){var m=f.parse(e,this);if(!m)return null;if(this.expectedType){var x=this.expectedType,k=m.type;if(x.kind!=="string"&&x.kind!=="number"&&x.kind!=="boolean"&&x.kind!=="object"&&x.kind!=="array"||k.kind!=="value")if(x.kind!=="color"&&x.kind!=="formatted"&&x.kind!=="resolvedImage"||k.kind!=="value"&&k.kind!=="string"){if(this.checkSubtype(x,k))return null}else m=i(m,x,t.typeAnnotation||"coerce");else m=i(m,x,t.typeAnnotation||"assert")}if(!(m instanceof Ii)&&m.type.kind!=="resolvedImage"&&function z(D){if(D instanceof Zi)return z(D.boundExpression);if(D instanceof zi&&D.name==="error"||D instanceof Jn||D instanceof Fn)return!1;var B=D instanceof Ai||D instanceof Cr,V=!0;return D.eachChild(function(j){V=B?V&&z(j):V&&j instanceof Ii}),!!V&&Sa(D)&&hn(D,["zoom","heatmap-density","line-progress","accumulated","is-supported-script"])}(m)){var A=new ji;try{m=new Ii(m.type,m.evaluate(A))}catch(z){return this.error(z.message),null}}return m}return this.error('Unknown expression "'+u+'". If you wanted a literal array, use ["literal", [...]].',0)}return this.error(e===void 0?"'undefined' value invalid. Use null instead.":typeof e=="object"?'Bare objects invalid. Use ["literal", {...}] instead.':"Expected an array, but found "+typeof e+" instead.")},Gr.prototype.concat=function(e,t,i){var u=typeof e=="number"?this.path.concat(e):this.path,f=i?this.scope.concat(i):this.scope;return new Gr(this.registry,u,t||null,f,this.errors)},Gr.prototype.error=function(e){for(var t=[],i=arguments.length-1;i-- >0;)t[i]=arguments[i+1];var u=""+this.key+t.map(function(f){return"["+f+"]"}).join("");this.errors.push(new Le(u,e))},Gr.prototype.checkSubtype=function(e,t){var i=mr(e,t);return i&&this.error(i),i};var Nn=function(e,t,i){this.type=e,this.input=t,this.labels=[],this.outputs=[];for(var u=0,f=i;u<f.length;u+=1){var m=f[u],x=m[1];this.labels.push(m[0]),this.outputs.push(x)}};function xi(e,t,i){return e*(1-i)+t*i}Nn.parse=function(e,t){if(e.length-1<4)return t.error("Expected at least 4 arguments, but found only "+(e.length-1)+".");if((e.length-1)%2!=0)return t.error("Expected an even number of arguments.");var i=t.parse(e[1],1,Ie);if(!i)return null;var u=[],f=null;t.expectedType&&t.expectedType.kind!=="value"&&(f=t.expectedType);for(var m=1;m<e.length;m+=2){var x=m===1?-1/0:e[m],k=e[m+1],A=m,z=m+1;if(typeof x!="number")return t.error('Input/output pairs for "step" expressions must be defined using literal numeric values (not computed expressions) for the input values.',A);if(u.length&&u[u.length-1][0]>=x)return t.error('Input/output pairs for "step" expressions must be arranged with input values in strictly ascending order.',A);var D=t.parse(k,z,f);if(!D)return null;f=f||D.type,u.push([x,D])}return new Nn(f,i,u)},Nn.prototype.evaluate=function(e){var t=this.labels,i=this.outputs;if(t.length===1)return i[0].evaluate(e);var u=this.input.evaluate(e);if(u<=t[0])return i[0].evaluate(e);var f=t.length;return u>=t[f-1]?i[f-1].evaluate(e):i[ka(t,u)].evaluate(e)},Nn.prototype.eachChild=function(e){e(this.input);for(var t=0,i=this.outputs;t<i.length;t+=1)e(i[t])},Nn.prototype.outputDefined=function(){return this.outputs.every(function(e){return e.outputDefined()})},Nn.prototype.serialize=function(){for(var e=["step",this.input.serialize()],t=0;t<this.labels.length;t++)t>0&&e.push(this.labels[t]),e.push(this.outputs[t].serialize());return e};var Oo=Object.freeze({__proto__:null,number:xi,color:function(e,t,i){return new fr(xi(e.r,t.r,i),xi(e.g,t.g,i),xi(e.b,t.b,i),xi(e.a,t.a,i))},array:function(e,t,i){return e.map(function(u,f){return xi(u,t[f],i)})}}),tc=6/29*3*(6/29),Nh=Math.PI/180,Vh=180/Math.PI;function Ul(e){return e>.008856451679035631?Math.pow(e,1/3):e/tc+4/29}function ql(e){return e>6/29?e*e*e:tc*(e-4/29)}function jl(e){return 255*(e<=.0031308?12.92*e:1.055*Math.pow(e,1/2.4)-.055)}function Gl(e){return(e/=255)<=.04045?e/12.92:Math.pow((e+.055)/1.055,2.4)}function rc(e){var t=Gl(e.r),i=Gl(e.g),u=Gl(e.b),f=Ul((.4124564*t+.3575761*i+.1804375*u)/.95047),m=Ul((.2126729*t+.7151522*i+.072175*u)/1);return{l:116*m-16,a:500*(f-m),b:200*(m-Ul((.0193339*t+.119192*i+.9503041*u)/1.08883)),alpha:e.a}}function ic(e){var t=(e.l+16)/116,i=isNaN(e.a)?t:t+e.a/500,u=isNaN(e.b)?t:t-e.b/200;return t=1*ql(t),i=.95047*ql(i),u=1.08883*ql(u),new fr(jl(3.2404542*i-1.5371385*t-.4985314*u),jl(-.969266*i+1.8760108*t+.041556*u),jl(.0556434*i-.2040259*t+1.0572252*u),e.alpha)}function Uh(e,t,i){var u=t-e;return e+i*(u>180||u<-180?u-360*Math.round(u/360):u)}var os={forward:rc,reverse:ic,interpolate:function(e,t,i){return{l:xi(e.l,t.l,i),a:xi(e.a,t.a,i),b:xi(e.b,t.b,i),alpha:xi(e.alpha,t.alpha,i)}}},ss={forward:function(e){var t=rc(e),i=t.l,u=t.a,f=t.b,m=Math.atan2(f,u)*Vh;return{h:m<0?m+360:m,c:Math.sqrt(u*u+f*f),l:i,alpha:e.a}},reverse:function(e){var t=e.h*Nh,i=e.c;return ic({l:e.l,a:Math.cos(t)*i,b:Math.sin(t)*i,alpha:e.alpha})},interpolate:function(e,t,i){return{h:Uh(e.h,t.h,i),c:xi(e.c,t.c,i),l:xi(e.l,t.l,i),alpha:xi(e.alpha,t.alpha,i)}}},nc=Object.freeze({__proto__:null,lab:os,hcl:ss}),tn=function(e,t,i,u,f){this.type=e,this.operator=t,this.interpolation=i,this.input=u,this.labels=[],this.outputs=[];for(var m=0,x=f;m<x.length;m+=1){var k=x[m],A=k[1];this.labels.push(k[0]),this.outputs.push(A)}};function Zl(e,t,i,u){var f=u-i,m=e-i;return f===0?0:t===1?m/f:(Math.pow(t,m)-1)/(Math.pow(t,f)-1)}tn.interpolationFactor=function(e,t,i,u){var f=0;if(e.name==="exponential")f=Zl(t,e.base,i,u);else if(e.name==="linear")f=Zl(t,1,i,u);else if(e.name==="cubic-bezier"){var m=e.controlPoints;f=new T(m[0],m[1],m[2],m[3]).solve(Zl(t,1,i,u))}return f},tn.parse=function(e,t){var i=e[0],u=e[1],f=e[2],m=e.slice(3);if(!Array.isArray(u)||u.length===0)return t.error("Expected an interpolation type expression.",1);if(u[0]==="linear")u={name:"linear"};else if(u[0]==="exponential"){var x=u[1];if(typeof x!="number")return t.error("Exponential interpolation requires a numeric base.",1,1);u={name:"exponential",base:x}}else{if(u[0]!=="cubic-bezier")return t.error("Unknown interpolation type "+String(u[0]),1,0);var k=u.slice(1);if(k.length!==4||k.some(function(pe){return typeof pe!="number"||pe<0||pe>1}))return t.error("Cubic bezier interpolation requires four numeric arguments with values between 0 and 1.",1);u={name:"cubic-bezier",controlPoints:k}}if(e.length-1<4)return t.error("Expected at least 4 arguments, but found only "+(e.length-1)+".");if((e.length-1)%2!=0)return t.error("Expected an even number of arguments.");if(!(f=t.parse(f,2,Ie)))return null;var A=[],z=null;i==="interpolate-hcl"||i==="interpolate-lab"?z=He:t.expectedType&&t.expectedType.kind!=="value"&&(z=t.expectedType);for(var D=0;D<m.length;D+=2){var B=m[D],V=m[D+1],j=D+3,Q=D+4;if(typeof B!="number")return t.error('Input/output pairs for "interpolate" expressions must be defined using literal numeric values (not computed expressions) for the input values.',j);if(A.length&&A[A.length-1][0]>=B)return t.error('Input/output pairs for "interpolate" expressions must be arranged with input values in strictly ascending order.',j);var $=t.parse(V,Q,z);if(!$)return null;z=z||$.type,A.push([B,$])}return z.kind==="number"||z.kind==="color"||z.kind==="array"&&z.itemType.kind==="number"&&typeof z.N=="number"?new tn(z,i,u,f,A):t.error("Type "+ar(z)+" is not interpolatable.")},tn.prototype.evaluate=function(e){var t=this.labels,i=this.outputs;if(t.length===1)return i[0].evaluate(e);var u=this.input.evaluate(e);if(u<=t[0])return i[0].evaluate(e);var f=t.length;if(u>=t[f-1])return i[f-1].evaluate(e);var m=ka(t,u),x=tn.interpolationFactor(this.interpolation,u,t[m],t[m+1]),k=i[m].evaluate(e),A=i[m+1].evaluate(e);return this.operator==="interpolate"?Oo[this.type.kind.toLowerCase()](k,A,x):this.operator==="interpolate-hcl"?ss.reverse(ss.interpolate(ss.forward(k),ss.forward(A),x)):os.reverse(os.interpolate(os.forward(k),os.forward(A),x))},tn.prototype.eachChild=function(e){e(this.input);for(var t=0,i=this.outputs;t<i.length;t+=1)e(i[t])},tn.prototype.outputDefined=function(){return this.outputs.every(function(e){return e.outputDefined()})},tn.prototype.serialize=function(){var e;e=this.interpolation.name==="linear"?["linear"]:this.interpolation.name==="exponential"?this.interpolation.base===1?["linear"]:["exponential",this.interpolation.base]:["cubic-bezier"].concat(this.interpolation.controlPoints);for(var t=[this.operator,e,this.input.serialize()],i=0;i<this.labels.length;i++)t.push(this.labels[i],this.outputs[i].serialize());return t};var qa=function(e,t){this.type=e,this.args=t};qa.parse=function(e,t){if(e.length<2)return t.error("Expectected at least one argument.");var i=null,u=t.expectedType;u&&u.kind!=="value"&&(i=u);for(var f=[],m=0,x=e.slice(1);m<x.length;m+=1){var k=t.parse(x[m],1+f.length,i,void 0,{typeAnnotation:"omit"});if(!k)return null;i=i||k.type,f.push(k)}var A=u&&f.some(function(z){return mr(u,z.type)});return new qa(A?st:i,f)},qa.prototype.evaluate=function(e){for(var t,i=null,u=0,f=0,m=this.args;f<m.length&&(u++,(i=m[f].evaluate(e))&&i instanceof Bi&&!i.available&&(t||(t=i.name),i=null,u===this.args.length&&(i=t)),i===null);f+=1);return i},qa.prototype.eachChild=function(e){this.args.forEach(e)},qa.prototype.outputDefined=function(){return this.args.every(function(e){return e.outputDefined()})},qa.prototype.serialize=function(){var e=["coalesce"];return this.eachChild(function(t){e.push(t.serialize())}),e};var ja=function(e,t){this.type=t.type,this.bindings=[].concat(e),this.result=t};ja.prototype.evaluate=function(e){return this.result.evaluate(e)},ja.prototype.eachChild=function(e){for(var t=0,i=this.bindings;t<i.length;t+=1)e(i[t][1]);e(this.result)},ja.parse=function(e,t){if(e.length<4)return t.error("Expected at least 3 arguments, but found "+(e.length-1)+" instead.");for(var i=[],u=1;u<e.length-1;u+=2){var f=e[u];if(typeof f!="string")return t.error("Expected string, but found "+typeof f+" instead.",u);if(/[^a-zA-Z0-9_]/.test(f))return t.error("Variable names must contain only alphanumeric characters or '_'.",u);var m=t.parse(e[u+1],u+1);if(!m)return null;i.push([f,m])}var x=t.parse(e[e.length-1],e.length-1,t.expectedType,i);return x?new ja(i,x):null},ja.prototype.outputDefined=function(){return this.result.outputDefined()},ja.prototype.serialize=function(){for(var e=["let"],t=0,i=this.bindings;t<i.length;t+=1){var u=i[t];e.push(u[0],u[1].serialize())}return e.push(this.result.serialize()),e};var ho=function(e,t,i){this.type=e,this.index=t,this.input=i};ho.parse=function(e,t){if(e.length!==3)return t.error("Expected 2 arguments, but found "+(e.length-1)+" instead.");var i=t.parse(e[1],1,Ie),u=t.parse(e[2],2,pr(t.expectedType||st));return i&&u?new ho(u.type.itemType,i,u):null},ho.prototype.evaluate=function(e){var t=this.index.evaluate(e),i=this.input.evaluate(e);if(t<0)throw new oi("Array index out of bounds: "+t+" < 0.");if(t>=i.length)throw new oi("Array index out of bounds: "+t+" > "+(i.length-1)+".");if(t!==Math.floor(t))throw new oi("Array index must be an integer, but found "+t+" instead.");return i[t]},ho.prototype.eachChild=function(e){e(this.index),e(this.input)},ho.prototype.outputDefined=function(){return!1},ho.prototype.serialize=function(){return["at",this.index.serialize(),this.input.serialize()]};var po=function(e,t){this.type=Je,this.needle=e,this.haystack=t};po.parse=function(e,t){if(e.length!==3)return t.error("Expected 2 arguments, but found "+(e.length-1)+" instead.");var i=t.parse(e[1],1,st),u=t.parse(e[2],2,st);return i&&u?Fr(i.type,[Je,nt,Ie,lt,st])?new po(i,u):t.error("Expected first argument to be of type boolean, string, number or null, but found "+ar(i.type)+" instead"):null},po.prototype.evaluate=function(e){var t=this.needle.evaluate(e),i=this.haystack.evaluate(e);if(!i)return!1;if(!vr(t,["boolean","string","number","null"]))throw new oi("Expected first argument to be of type boolean, string, number or null, but found "+ar(jr(t))+" instead.");if(!vr(i,["string","array"]))throw new oi("Expected second argument to be of type array or string, but found "+ar(jr(i))+" instead.");return i.indexOf(t)>=0},po.prototype.eachChild=function(e){e(this.needle),e(this.haystack)},po.prototype.outputDefined=function(){return!0},po.prototype.serialize=function(){return["in",this.needle.serialize(),this.haystack.serialize()]};var Ga=function(e,t,i){this.type=Ie,this.needle=e,this.haystack=t,this.fromIndex=i};Ga.parse=function(e,t){if(e.length<=2||e.length>=5)return t.error("Expected 3 or 4 arguments, but found "+(e.length-1)+" instead.");var i=t.parse(e[1],1,st),u=t.parse(e[2],2,st);if(!i||!u)return null;if(!Fr(i.type,[Je,nt,Ie,lt,st]))return t.error("Expected first argument to be of type boolean, string, number or null, but found "+ar(i.type)+" instead");if(e.length===4){var f=t.parse(e[3],3,Ie);return f?new Ga(i,u,f):null}return new Ga(i,u)},Ga.prototype.evaluate=function(e){var t=this.needle.evaluate(e),i=this.haystack.evaluate(e);if(!vr(t,["boolean","string","number","null"]))throw new oi("Expected first argument to be of type boolean, string, number or null, but found "+ar(jr(t))+" instead.");if(!vr(i,["string","array"]))throw new oi("Expected second argument to be of type array or string, but found "+ar(jr(i))+" instead.");if(this.fromIndex){var u=this.fromIndex.evaluate(e);return i.indexOf(t,u)}return i.indexOf(t)},Ga.prototype.eachChild=function(e){e(this.needle),e(this.haystack),this.fromIndex&&e(this.fromIndex)},Ga.prototype.outputDefined=function(){return!1},Ga.prototype.serialize=function(){if(this.fromIndex!=null&&this.fromIndex!==void 0){var e=this.fromIndex.serialize();return["index-of",this.needle.serialize(),this.haystack.serialize(),e]}return["index-of",this.needle.serialize(),this.haystack.serialize()]};var fo=function(e,t,i,u,f,m){this.inputType=e,this.type=t,this.input=i,this.cases=u,this.outputs=f,this.otherwise=m};fo.parse=function(e,t){if(e.length<5)return t.error("Expected at least 4 arguments, but found only "+(e.length-1)+".");if(e.length%2!=1)return t.error("Expected an even number of arguments.");var i,u;t.expectedType&&t.expectedType.kind!=="value"&&(u=t.expectedType);for(var f={},m=[],x=2;x<e.length-1;x+=2){var k=e[x],A=e[x+1];Array.isArray(k)||(k=[k]);var z=t.concat(x);if(k.length===0)return z.error("Expected at least one branch label.");for(var D=0,B=k;D<B.length;D+=1){var V=B[D];if(typeof V!="number"&&typeof V!="string")return z.error("Branch labels must be numbers or strings.");if(typeof V=="number"&&Math.abs(V)>Number.MAX_SAFE_INTEGER)return z.error("Branch labels must be integers no larger than "+Number.MAX_SAFE_INTEGER+".");if(typeof V=="number"&&Math.floor(V)!==V)return z.error("Numeric branch labels must be integer values.");if(i){if(z.checkSubtype(i,jr(V)))return null}else i=jr(V);if(f[String(V)]!==void 0)return z.error("Branch labels must be unique.");f[String(V)]=m.length}var j=t.parse(A,x,u);if(!j)return null;u=u||j.type,m.push(j)}var Q=t.parse(e[1],1,st);if(!Q)return null;var $=t.parse(e[e.length-1],e.length-1,u);return $?Q.type.kind!=="value"&&t.concat(1).checkSubtype(i,Q.type)?null:new fo(i,u,Q,f,m,$):null},fo.prototype.evaluate=function(e){var t=this.input.evaluate(e);return(jr(t)===this.inputType&&this.outputs[this.cases[t]]||this.otherwise).evaluate(e)},fo.prototype.eachChild=function(e){e(this.input),this.outputs.forEach(e),e(this.otherwise)},fo.prototype.outputDefined=function(){return this.outputs.every(function(e){return e.outputDefined()})&&this.otherwise.outputDefined()},fo.prototype.serialize=function(){for(var e=this,t=["match",this.input.serialize()],i=[],u={},f=0,m=Object.keys(this.cases).sort();f<m.length;f+=1){var x=m[f];(B=u[this.cases[x]])===void 0?(u[this.cases[x]]=i.length,i.push([this.cases[x],[x]])):i[B][1].push(x)}for(var k=function(j){return e.inputType.kind==="number"?Number(j):j},A=0,z=i;A<z.length;A+=1){var D=z[A],B=D[0],V=D[1];t.push(V.length===1?k(V[0]):V.map(k)),t.push(this.outputs[outputIndex$1].serialize())}return t.push(this.otherwise.serialize()),t};var mo=function(e,t,i){this.type=e,this.branches=t,this.otherwise=i};mo.parse=function(e,t){if(e.length<4)return t.error("Expected at least 3 arguments, but found only "+(e.length-1)+".");if(e.length%2!=0)return t.error("Expected an odd number of arguments.");var i;t.expectedType&&t.expectedType.kind!=="value"&&(i=t.expectedType);for(var u=[],f=1;f<e.length-1;f+=2){var m=t.parse(e[f],f,Je);if(!m)return null;var x=t.parse(e[f+1],f+1,i);if(!x)return null;u.push([m,x]),i=i||x.type}var k=t.parse(e[e.length-1],e.length-1,i);return k?new mo(i,u,k):null},mo.prototype.evaluate=function(e){for(var t=0,i=this.branches;t<i.length;t+=1){var u=i[t],f=u[1];if(u[0].evaluate(e))return f.evaluate(e)}return this.otherwise.evaluate(e)},mo.prototype.eachChild=function(e){for(var t=0,i=this.branches;t<i.length;t+=1){var u=i[t],f=u[1];e(u[0]),e(f)}e(this.otherwise)},mo.prototype.outputDefined=function(){return this.branches.every(function(e){return e[1].outputDefined()})&&this.otherwise.outputDefined()},mo.prototype.serialize=function(){var e=["case"];return this.eachChild(function(t){e.push(t.serialize())}),e};var Za=function(e,t,i,u){this.type=e,this.input=t,this.beginIndex=i,this.endIndex=u};function ac(e,t){return e==="=="||e==="!="?t.kind==="boolean"||t.kind==="string"||t.kind==="number"||t.kind==="null"||t.kind==="value":t.kind==="string"||t.kind==="number"||t.kind==="value"}function oc(e,t,i,u){return u.compare(t,i)===0}function Lr(e,t,i){var u=e!=="=="&&e!=="!=";return function(){function f(m,x,k){this.type=Je,this.lhs=m,this.rhs=x,this.collator=k,this.hasUntypedArgument=m.type.kind==="value"||x.type.kind==="value"}return f.parse=function(m,x){if(m.length!==3&&m.length!==4)return x.error("Expected two or three arguments.");var k=m[0],A=x.parse(m[1],1,st);if(!A)return null;if(!ac(k,A.type))return x.concat(1).error('"'+k+`" comparisons are not supported for type '`+ar(A.type)+"'.");var z=x.parse(m[2],2,st);if(!z)return null;if(!ac(k,z.type))return x.concat(2).error('"'+k+`" comparisons are not supported for type '`+ar(z.type)+"'.");if(A.type.kind!==z.type.kind&&A.type.kind!=="value"&&z.type.kind!=="value")return x.error("Cannot compare types '"+ar(A.type)+"' and '"+ar(z.type)+"'.");u&&(A.type.kind==="value"&&z.type.kind!=="value"?A=new Cr(z.type,[A]):A.type.kind!=="value"&&z.type.kind==="value"&&(z=new Cr(A.type,[z])));var D=null;if(m.length===4){if(A.type.kind!=="string"&&z.type.kind!=="string"&&A.type.kind!=="value"&&z.type.kind!=="value")return x.error("Cannot use collator to compare non-string types.");if(!(D=x.parse(m[3],3,nr)))return null}return new f(A,z,D)},f.prototype.evaluate=function(m){var x=this.lhs.evaluate(m),k=this.rhs.evaluate(m);if(u&&this.hasUntypedArgument){var A=jr(x),z=jr(k);if(A.kind!==z.kind||A.kind!=="string"&&A.kind!=="number")throw new oi('Expected arguments for "'+e+'" to be (string, string) or (number, number), but found ('+A.kind+", "+z.kind+") instead.")}if(this.collator&&!u&&this.hasUntypedArgument){var D=jr(x),B=jr(k);if(D.kind!=="string"||B.kind!=="string")return t(m,x,k)}return this.collator?i(m,x,k,this.collator.evaluate(m)):t(m,x,k)},f.prototype.eachChild=function(m){m(this.lhs),m(this.rhs),this.collator&&m(this.collator)},f.prototype.outputDefined=function(){return!0},f.prototype.serialize=function(){var m=[e];return this.eachChild(function(x){m.push(x.serialize())}),m},f}()}Za.parse=function(e,t){if(e.length<=2||e.length>=5)return t.error("Expected 3 or 4 arguments, but found "+(e.length-1)+" instead.");var i=t.parse(e[1],1,st),u=t.parse(e[2],2,Ie);if(!i||!u)return null;if(!Fr(i.type,[pr(st),nt,st]))return t.error("Expected first argument to be of type array or string, but found "+ar(i.type)+" instead");if(e.length===4){var f=t.parse(e[3],3,Ie);return f?new Za(i.type,i,u,f):null}return new Za(i.type,i,u)},Za.prototype.evaluate=function(e){var t=this.input.evaluate(e),i=this.beginIndex.evaluate(e);if(!vr(t,["string","array"]))throw new oi("Expected first argument to be of type array or string, but found "+ar(jr(t))+" instead.");if(this.endIndex){var u=this.endIndex.evaluate(e);return t.slice(i,u)}return t.slice(i)},Za.prototype.eachChild=function(e){e(this.input),e(this.beginIndex),this.endIndex&&e(this.endIndex)},Za.prototype.outputDefined=function(){return!1},Za.prototype.serialize=function(){if(this.endIndex!=null&&this.endIndex!==void 0){var e=this.endIndex.serialize();return["slice",this.input.serialize(),this.beginIndex.serialize(),e]}return["slice",this.input.serialize(),this.beginIndex.serialize()]};var qh=Lr("==",function(e,t,i){return t===i},oc),Ns=Lr("!=",function(e,t,i){return t!==i},function(e,t,i,u){return!oc(0,t,i,u)}),sc=Lr("<",function(e,t,i){return t<i},function(e,t,i,u){return u.compare(t,i)<0}),lc=Lr(">",function(e,t,i){return t>i},function(e,t,i,u){return u.compare(t,i)>0}),uc=Lr("<=",function(e,t,i){return t<=i},function(e,t,i,u){return u.compare(t,i)<=0}),cc=Lr(">=",function(e,t,i){return t>=i},function(e,t,i,u){return u.compare(t,i)>=0}),yo=function(e,t,i,u,f){this.type=nt,this.number=e,this.locale=t,this.currency=i,this.minFractionDigits=u,this.maxFractionDigits=f};yo.parse=function(e,t){if(e.length!==3)return t.error("Expected two arguments.");var i=t.parse(e[1],1,Ie);if(!i)return null;var u=e[2];if(typeof u!="object"||Array.isArray(u))return t.error("NumberFormat options argument must be an object.");var f=null;if(u.locale&&!(f=t.parse(u.locale,1,nt)))return null;var m=null;if(u.currency&&!(m=t.parse(u.currency,1,nt)))return null;var x=null;if(u["min-fraction-digits"]&&!(x=t.parse(u["min-fraction-digits"],1,Ie)))return null;var k=null;return u["max-fraction-digits"]&&!(k=t.parse(u["max-fraction-digits"],1,Ie))?null:new yo(i,f,m,x,k)},yo.prototype.evaluate=function(e){return new Intl.NumberFormat(this.locale?this.locale.evaluate(e):[],{style:this.currency?"currency":"decimal",currency:this.currency?this.currency.evaluate(e):void 0,minimumFractionDigits:this.minFractionDigits?this.minFractionDigits.evaluate(e):void 0,maximumFractionDigits:this.maxFractionDigits?this.maxFractionDigits.evaluate(e):void 0}).format(this.number.evaluate(e))},yo.prototype.eachChild=function(e){e(this.number),this.locale&&e(this.locale),this.currency&&e(this.currency),this.minFractionDigits&&e(this.minFractionDigits),this.maxFractionDigits&&e(this.maxFractionDigits)},yo.prototype.outputDefined=function(){return!1},yo.prototype.serialize=function(){var e={};return this.locale&&(e.locale=this.locale.serialize()),this.currency&&(e.currency=this.currency.serialize()),this.minFractionDigits&&(e["min-fraction-digits"]=this.minFractionDigits.serialize()),this.maxFractionDigits&&(e["max-fraction-digits"]=this.maxFractionDigits.serialize()),["number-format",this.number.serialize(),e]};var Ka=function(e){this.type=Ie,this.input=e};Ka.parse=function(e,t){if(e.length!==2)return t.error("Expected 1 argument, but found "+(e.length-1)+" instead.");var i=t.parse(e[1],1);return i?i.type.kind!=="array"&&i.type.kind!=="string"&&i.type.kind!=="value"?t.error("Expected argument of type string or array, but found "+ar(i.type)+" instead."):new Ka(i):null},Ka.prototype.evaluate=function(e){var t=this.input.evaluate(e);if(typeof t=="string"||Array.isArray(t))return t.length;throw new oi("Expected value to be of type string or array, but found "+ar(jr(t))+" instead.")},Ka.prototype.eachChild=function(e){e(this.input)},Ka.prototype.outputDefined=function(){return!1},Ka.prototype.serialize=function(){var e=["length"];return this.eachChild(function(t){e.push(t.serialize())}),e};var go={"==":qh,"!=":Ns,">":lc,"<":sc,">=":cc,"<=":uc,array:Cr,at:ho,boolean:Cr,case:mo,coalesce:qa,collator:Jn,format:On,image:yn,in:po,"index-of":Ga,interpolate:tn,"interpolate-hcl":tn,"interpolate-lab":tn,length:Ka,let:ja,literal:Ii,match:fo,number:Cr,"number-format":yo,object:Cr,slice:Za,step:Nn,string:Cr,"to-boolean":Ai,"to-color":Ai,"to-number":Ai,"to-string":Ai,var:Zi,within:Fn};function hc(e,t){var i=t[0],u=t[1],f=t[2],m=t[3];i=i.evaluate(e),u=u.evaluate(e),f=f.evaluate(e);var x=m?m.evaluate(e):1,k=Na(i,u,f,x);if(k)throw new oi(k);return new fr(i/255*x,u/255*x,f/255*x,x)}function pc(e,t){return e in t}function Kl(e,t){var i=t[e];return i===void 0?null:i}function _o(e){return{type:e}}function fc(e){return{result:"success",value:e}}function vo(e){return{result:"error",value:e}}function bo(e){return e["property-type"]==="data-driven"||e["property-type"]==="cross-faded-data-driven"}function dc(e){return!!e.expression&&e.expression.parameters.indexOf("zoom")>-1}function ls(e){return!!e.expression&&e.expression.interpolated}function Nr(e){return e instanceof Number?"number":e instanceof String?"string":e instanceof Boolean?"boolean":Array.isArray(e)?"array":e===null?"null":typeof e}function Vs(e){return typeof e=="object"&&e!==null&&!Array.isArray(e)}function jh(e){return e}function Fo(e,t,i){return e!==void 0?e:t!==void 0?t:i!==void 0?i:void 0}function mc(e,t,i,u,f){return Fo(typeof i===f?u[i]:void 0,e.default,t.default)}function Gh(e,t,i){if(Nr(i)!=="number")return Fo(e.default,t.default);var u=e.stops.length;if(u===1||i<=e.stops[0][0])return e.stops[0][1];if(i>=e.stops[u-1][0])return e.stops[u-1][1];var f=ka(e.stops.map(function(m){return m[0]}),i);return e.stops[f][1]}function yc(e,t,i){var u=e.base!==void 0?e.base:1;if(Nr(i)!=="number")return Fo(e.default,t.default);var f=e.stops.length;if(f===1||i<=e.stops[0][0])return e.stops[0][1];if(i>=e.stops[f-1][0])return e.stops[f-1][1];var m=ka(e.stops.map(function(B){return B[0]}),i),x=function(B,V,j,Q){var $=Q-j,pe=B-j;return $===0?0:V===1?pe/$:(Math.pow(V,pe)-1)/(Math.pow(V,$)-1)}(i,u,e.stops[m][0],e.stops[m+1][0]),k=e.stops[m][1],A=e.stops[m+1][1],z=Oo[t.type]||jh;if(e.colorSpace&&e.colorSpace!=="rgb"){var D=nc[e.colorSpace];z=function(B,V){return D.reverse(D.interpolate(D.forward(B),D.forward(V),x))}}return typeof k.evaluate=="function"?{evaluate:function(){for(var B=[],V=arguments.length;V--;)B[V]=arguments[V];var j=k.evaluate.apply(void 0,B),Q=A.evaluate.apply(void 0,B);if(j!==void 0&&Q!==void 0)return z(j,Q,x)}}:z(k,A,x)}function Us(e,t,i){return t.type==="color"?i=fr.parse(i):t.type==="formatted"?i=ai.fromString(i.toString()):t.type==="resolvedImage"?i=Bi.fromString(i.toString()):Nr(i)===t.type||t.type==="enum"&&t.values[i]||(i=void 0),Fo(i,e.default,t.default)}zi.register(go,{error:[{kind:"error"},[nt],function(e,t){throw new oi(t[0].evaluate(e))}],typeof:[nt,[st],function(e,t){return ar(jr(t[0].evaluate(e)))}],"to-rgba":[pr(Ie,4),[He],function(e,t){return t[0].evaluate(e).toArray()}],rgb:[He,[Ie,Ie,Ie],hc],rgba:[He,[Ie,Ie,Ie,Ie],hc],has:{type:Je,overloads:[[[nt],function(e,t){return pc(t[0].evaluate(e),e.properties())}],[[nt,Zt],function(e,t){var i=t[1];return pc(t[0].evaluate(e),i.evaluate(e))}]]},get:{type:st,overloads:[[[nt],function(e,t){return Kl(t[0].evaluate(e),e.properties())}],[[nt,Zt],function(e,t){var i=t[1];return Kl(t[0].evaluate(e),i.evaluate(e))}]]},"feature-state":[st,[nt],function(e,t){return Kl(t[0].evaluate(e),e.featureState||{})}],properties:[Zt,[],function(e){return e.properties()}],"geometry-type":[nt,[],function(e){return e.geometryType()}],id:[st,[],function(e){return e.id()}],zoom:[Ie,[],function(e){return e.globals.zoom}],"heatmap-density":[Ie,[],function(e){return e.globals.heatmapDensity||0}],"line-progress":[Ie,[],function(e){return e.globals.lineProgress||0}],accumulated:[st,[],function(e){return e.globals.accumulated===void 0?null:e.globals.accumulated}],"+":[Ie,_o(Ie),function(e,t){for(var i=0,u=0,f=t;u<f.length;u+=1)i+=f[u].evaluate(e);return i}],"*":[Ie,_o(Ie),function(e,t){for(var i=1,u=0,f=t;u<f.length;u+=1)i*=f[u].evaluate(e);return i}],"-":{type:Ie,overloads:[[[Ie,Ie],function(e,t){var i=t[1];return t[0].evaluate(e)-i.evaluate(e)}],[[Ie],function(e,t){return-t[0].evaluate(e)}]]},"/":[Ie,[Ie,Ie],function(e,t){var i=t[1];return t[0].evaluate(e)/i.evaluate(e)}],"%":[Ie,[Ie,Ie],function(e,t){var i=t[1];return t[0].evaluate(e)%i.evaluate(e)}],ln2:[Ie,[],function(){return Math.LN2}],pi:[Ie,[],function(){return Math.PI}],e:[Ie,[],function(){return Math.E}],"^":[Ie,[Ie,Ie],function(e,t){var i=t[1];return Math.pow(t[0].evaluate(e),i.evaluate(e))}],sqrt:[Ie,[Ie],function(e,t){return Math.sqrt(t[0].evaluate(e))}],log10:[Ie,[Ie],function(e,t){return Math.log(t[0].evaluate(e))/Math.LN10}],ln:[Ie,[Ie],function(e,t){return Math.log(t[0].evaluate(e))}],log2:[Ie,[Ie],function(e,t){return Math.log(t[0].evaluate(e))/Math.LN2}],sin:[Ie,[Ie],function(e,t){return Math.sin(t[0].evaluate(e))}],cos:[Ie,[Ie],function(e,t){return Math.cos(t[0].evaluate(e))}],tan:[Ie,[Ie],function(e,t){return Math.tan(t[0].evaluate(e))}],asin:[Ie,[Ie],function(e,t){return Math.asin(t[0].evaluate(e))}],acos:[Ie,[Ie],function(e,t){return Math.acos(t[0].evaluate(e))}],atan:[Ie,[Ie],function(e,t){return Math.atan(t[0].evaluate(e))}],min:[Ie,_o(Ie),function(e,t){return Math.min.apply(Math,t.map(function(i){return i.evaluate(e)}))}],max:[Ie,_o(Ie),function(e,t){return Math.max.apply(Math,t.map(function(i){return i.evaluate(e)}))}],abs:[Ie,[Ie],function(e,t){return Math.abs(t[0].evaluate(e))}],round:[Ie,[Ie],function(e,t){var i=t[0].evaluate(e);return i<0?-Math.round(-i):Math.round(i)}],floor:[Ie,[Ie],function(e,t){return Math.floor(t[0].evaluate(e))}],ceil:[Ie,[Ie],function(e,t){return Math.ceil(t[0].evaluate(e))}],"filter-==":[Je,[nt,st],function(e,t){var i=t[0],u=t[1];return e.properties()[i.value]===u.value}],"filter-id-==":[Je,[st],function(e,t){var i=t[0];return e.id()===i.value}],"filter-type-==":[Je,[nt],function(e,t){var i=t[0];return e.geometryType()===i.value}],"filter-<":[Je,[nt,st],function(e,t){var i=t[0],u=t[1],f=e.properties()[i.value],m=u.value;return typeof f==typeof m&&f<m}],"filter-id-<":[Je,[st],function(e,t){var i=t[0],u=e.id(),f=i.value;return typeof u==typeof f&&u<f}],"filter->":[Je,[nt,st],function(e,t){var i=t[0],u=t[1],f=e.properties()[i.value],m=u.value;return typeof f==typeof m&&f>m}],"filter-id->":[Je,[st],function(e,t){var i=t[0],u=e.id(),f=i.value;return typeof u==typeof f&&u>f}],"filter-<=":[Je,[nt,st],function(e,t){var i=t[0],u=t[1],f=e.properties()[i.value],m=u.value;return typeof f==typeof m&&f<=m}],"filter-id-<=":[Je,[st],function(e,t){var i=t[0],u=e.id(),f=i.value;return typeof u==typeof f&&u<=f}],"filter->=":[Je,[nt,st],function(e,t){var i=t[0],u=t[1],f=e.properties()[i.value],m=u.value;return typeof f==typeof m&&f>=m}],"filter-id->=":[Je,[st],function(e,t){var i=t[0],u=e.id(),f=i.value;return typeof u==typeof f&&u>=f}],"filter-has":[Je,[st],function(e,t){return t[0].value in e.properties()}],"filter-has-id":[Je,[],function(e){return e.id()!==null&&e.id()!==void 0}],"filter-type-in":[Je,[pr(nt)],function(e,t){return t[0].value.indexOf(e.geometryType())>=0}],"filter-id-in":[Je,[pr(st)],function(e,t){return t[0].value.indexOf(e.id())>=0}],"filter-in-small":[Je,[nt,pr(st)],function(e,t){var i=t[0];return t[1].value.indexOf(e.properties()[i.value])>=0}],"filter-in-large":[Je,[nt,pr(st)],function(e,t){var i=t[0],u=t[1];return function(f,m,x,k){for(;x<=k;){var A=x+k>>1;if(m[A]===f)return!0;m[A]>f?k=A-1:x=A+1}return!1}(e.properties()[i.value],u.value,0,u.value.length-1)}],all:{type:Je,overloads:[[[Je,Je],function(e,t){var i=t[1];return t[0].evaluate(e)&&i.evaluate(e)}],[_o(Je),function(e,t){for(var i=0,u=t;i<u.length;i+=1)if(!u[i].evaluate(e))return!1;return!0}]]},any:{type:Je,overloads:[[[Je,Je],function(e,t){var i=t[1];return t[0].evaluate(e)||i.evaluate(e)}],[_o(Je),function(e,t){for(var i=0,u=t;i<u.length;i+=1)if(u[i].evaluate(e))return!0;return!1}]]},"!":[Je,[Je],function(e,t){return!t[0].evaluate(e)}],"is-supported-script":[Je,[nt],function(e,t){var i=e.globals&&e.globals.isSupportedScript;return!i||i(t[0].evaluate(e))}],upcase:[nt,[nt],function(e,t){return t[0].evaluate(e).toUpperCase()}],downcase:[nt,[nt],function(e,t){return t[0].evaluate(e).toLowerCase()}],concat:[nt,_o(st),function(e,t){return t.map(function(i){return ba(i.evaluate(e))}).join("")}],"resolved-locale":[nt,[nr],function(e,t){return t[0].evaluate(e).resolvedLocale()}]});var No=function(e,t){this.expression=e,this._warningHistory={},this._evaluator=new ji,this._defaultValue=t?function(i){return i.type==="color"&&Vs(i.default)?new fr(0,0,0,0):i.type==="color"?fr.parse(i.default)||null:i.default===void 0?null:i.default}(t):null,this._enumValues=t&&t.type==="enum"?t.values:null};function us(e){return Array.isArray(e)&&e.length>0&&typeof e[0]=="string"&&e[0]in go}function qs(e,t){var i=new Gr(go,[],t?function(f){var m={color:He,string:nt,number:Ie,enum:nt,boolean:Je,formatted:br,resolvedImage:Xt};return f.type==="array"?pr(m[f.value]||st,f.length):m[f.type]}(t):void 0),u=i.parse(e,void 0,void 0,void 0,t&&t.type==="string"?{typeAnnotation:"coerce"}:void 0);return u?fc(new No(u,t)):vo(i.errors)}No.prototype.evaluateWithoutErrorHandling=function(e,t,i,u,f,m){return this._evaluator.globals=e,this._evaluator.feature=t,this._evaluator.featureState=i,this._evaluator.canonical=u,this._evaluator.availableImages=f||null,this._evaluator.formattedSection=m,this.expression.evaluate(this._evaluator)},No.prototype.evaluate=function(e,t,i,u,f,m){this._evaluator.globals=e,this._evaluator.feature=t||null,this._evaluator.featureState=i||null,this._evaluator.canonical=u,this._evaluator.availableImages=f||null,this._evaluator.formattedSection=m||null;try{var x=this.expression.evaluate(this._evaluator);if(x==null||typeof x=="number"&&x!=x)return this._defaultValue;if(this._enumValues&&!(x in this._enumValues))throw new oi("Expected value to be one of "+Object.keys(this._enumValues).map(function(k){return JSON.stringify(k)}).join(", ")+", but found "+JSON.stringify(x)+" instead.");return x}catch(k){return this._warningHistory[k.message]||(this._warningHistory[k.message]=!0,typeof console<"u"&&console.warn(k.message)),this._defaultValue}};var cs=function(e,t){this.kind=e,this._styleExpression=t,this.isStateDependent=e!=="constant"&&!ve(t.expression)};cs.prototype.evaluateWithoutErrorHandling=function(e,t,i,u,f,m){return this._styleExpression.evaluateWithoutErrorHandling(e,t,i,u,f,m)},cs.prototype.evaluate=function(e,t,i,u,f,m){return this._styleExpression.evaluate(e,t,i,u,f,m)};var Vo=function(e,t,i,u){this.kind=e,this.zoomStops=i,this._styleExpression=t,this.isStateDependent=e!=="camera"&&!ve(t.expression),this.interpolationType=u};function gc(e,t){if((e=qs(e,t)).result==="error")return e;var i=e.value.expression,u=Sa(i);if(!u&&!bo(t))return vo([new Le("","data expressions not supported")]);var f=hn(i,["zoom"]);if(!f&&!dc(t))return vo([new Le("","zoom expressions not supported")]);var m=function x(k){var A=null;if(k instanceof ja)A=x(k.result);else if(k instanceof qa)for(var z=0,D=k.args;z<D.length&&!(A=x(D[z]));z+=1);else(k instanceof Nn||k instanceof tn)&&k.input instanceof zi&&k.input.name==="zoom"&&(A=k);return A instanceof Le||k.eachChild(function(B){var V=x(B);V instanceof Le?A=V:!A&&V?A=new Le("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.'):A&&V&&A!==V&&(A=new Le("",'Only one zoom-based "step" or "interpolate" subexpression may be used in an expression.'))}),A}(i);return m||f?m instanceof Le?vo([m]):m instanceof tn&&!ls(t)?vo([new Le("",'"interpolate" expressions cannot be used with this property')]):fc(m?new Vo(u?"camera":"composite",e.value,m.labels,m instanceof tn?m.interpolation:void 0):new cs(u?"constant":"source",e.value)):vo([new Le("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.')])}Vo.prototype.evaluateWithoutErrorHandling=function(e,t,i,u,f,m){return this._styleExpression.evaluateWithoutErrorHandling(e,t,i,u,f,m)},Vo.prototype.evaluate=function(e,t,i,u,f,m){return this._styleExpression.evaluate(e,t,i,u,f,m)},Vo.prototype.interpolationFactor=function(e,t,i){return this.interpolationType?tn.interpolationFactor(this.interpolationType,e,t,i):0};var Uo=function(e,t){this._parameters=e,this._specification=t,De(this,function i(u,f){var m,x,k,A=f.type==="color",z=u.stops&&typeof u.stops[0][0]=="object",D=z||!(z||u.property!==void 0),B=u.type||(ls(f)?"exponential":"interval");if(A&&((u=De({},u)).stops&&(u.stops=u.stops.map(function(ut){return[ut[0],fr.parse(ut[1])]})),u.default=fr.parse(u.default?u.default:f.default)),u.colorSpace&&u.colorSpace!=="rgb"&&!nc[u.colorSpace])throw new Error("Unknown color space: "+u.colorSpace);if(B==="exponential")m=yc;else if(B==="interval")m=Gh;else if(B==="categorical"){m=mc,x=Object.create(null);for(var V=0,j=u.stops;V<j.length;V+=1){var Q=j[V];x[Q[0]]=Q[1]}k=typeof u.stops[0][0]}else{if(B!=="identity")throw new Error('Unknown function type "'+B+'"');m=Us}if(z){for(var $={},pe=[],oe=0;oe<u.stops.length;oe++){var ye=u.stops[oe],xe=ye[0].zoom;$[xe]===void 0&&($[xe]={zoom:xe,type:u.type,property:u.property,default:u.default,stops:[]},pe.push(xe)),$[xe].stops.push([ye[0].value,ye[1]])}for(var Se=[],Te=0,Me=pe;Te<Me.length;Te+=1){var Xe=Me[Te];Se.push([$[Xe].zoom,i($[Xe],f)])}var rt={name:"linear"};return{kind:"composite",interpolationType:rt,interpolationFactor:tn.interpolationFactor.bind(void 0,rt),zoomStops:Se.map(function(ut){return ut[0]}),evaluate:function(ut,It){var ht=ut.zoom;return yc({stops:Se,base:u.base},f,ht).evaluate(ht,It)}}}if(D){var wt=B==="exponential"?{name:"exponential",base:u.base!==void 0?u.base:1}:null;return{kind:"camera",interpolationType:wt,interpolationFactor:tn.interpolationFactor.bind(void 0,wt),zoomStops:u.stops.map(function(ut){return ut[0]}),evaluate:function(ut){return m(u,f,ut.zoom,x,k)}}}return{kind:"source",evaluate:function(ut,It){var ht=It&&It.properties?It.properties[u.property]:void 0;return ht===void 0?Fo(u.default,f.default):m(u,f,ht,x,k)}}}(this._parameters,this._specification))};function fa(e){var t=e.key,i=e.value,u=e.valueSpec||{},f=e.objectElementValidators||{},m=e.style,x=e.styleSpec,k=[],A=Nr(i);if(A!=="object")return[new J(t,i,"object expected, "+A+" found")];for(var z in i){var D=z.split(".")[0],B=u[D]||u["*"],V=void 0;if(f[D])V=f[D];else if(u[D])V=dr;else if(f["*"])V=f["*"];else{if(!u["*"]){k.push(new J(t,i[z],'unknown property "'+z+'"'));continue}V=dr}k=k.concat(V({key:(t&&t+".")+z,value:i[z],valueSpec:B,style:m,styleSpec:x,object:i,objectKey:z},i))}for(var j in u)f[j]||u[j].required&&u[j].default===void 0&&i[j]===void 0&&k.push(new J(t,i,'missing required property "'+j+'"'));return k}function _c(e){var t=e.value,i=e.valueSpec,u=e.style,f=e.styleSpec,m=e.key,x=e.arrayElementValidator||dr;if(Nr(t)!=="array")return[new J(m,t,"array expected, "+Nr(t)+" found")];if(i.length&&t.length!==i.length)return[new J(m,t,"array length "+i.length+" expected, length "+t.length+" found")];if(i["min-length"]&&t.length<i["min-length"])return[new J(m,t,"array length at least "+i["min-length"]+" expected, length "+t.length+" found")];var k={type:i.value,values:i.values};f.$version<7&&(k.function=i.function),Nr(i.value)==="object"&&(k=i.value);for(var A=[],z=0;z<t.length;z++)A=A.concat(x({array:t,arrayIndex:z,value:t[z],valueSpec:k,style:u,styleSpec:f,key:m+"["+z+"]"}));return A}function vc(e){var t=e.key,i=e.value,u=e.valueSpec,f=Nr(i);return f==="number"&&i!=i&&(f="NaN"),f!=="number"?[new J(t,i,"number expected, "+f+" found")]:"minimum"in u&&i<u.minimum?[new J(t,i,i+" is less than the minimum value "+u.minimum)]:"maximum"in u&&i>u.maximum?[new J(t,i,i+" is greater than the maximum value "+u.maximum)]:[]}function bc(e){var t,i,u,f=e.valueSpec,m=Ne(e.value.type),x={},k=m!=="categorical"&&e.value.property===void 0,A=!k,z=Nr(e.value.stops)==="array"&&Nr(e.value.stops[0])==="array"&&Nr(e.value.stops[0][0])==="object",D=fa({key:e.key,value:e.value,valueSpec:e.styleSpec.function,style:e.style,styleSpec:e.styleSpec,objectElementValidators:{stops:function(j){if(m==="identity")return[new J(j.key,j.value,'identity function may not have a "stops" property')];var Q=[],$=j.value;return Q=Q.concat(_c({key:j.key,value:$,valueSpec:j.valueSpec,style:j.style,styleSpec:j.styleSpec,arrayElementValidator:B})),Nr($)==="array"&&$.length===0&&Q.push(new J(j.key,$,"array must have at least one stop")),Q},default:function(j){return dr({key:j.key,value:j.value,valueSpec:f,style:j.style,styleSpec:j.styleSpec})}}});return m==="identity"&&k&&D.push(new J(e.key,e.value,'missing required property "property"')),m==="identity"||e.value.stops||D.push(new J(e.key,e.value,'missing required property "stops"')),m==="exponential"&&e.valueSpec.expression&&!ls(e.valueSpec)&&D.push(new J(e.key,e.value,"exponential functions not supported")),e.styleSpec.$version>=8&&(A&&!bo(e.valueSpec)?D.push(new J(e.key,e.value,"property functions not supported")):k&&!dc(e.valueSpec)&&D.push(new J(e.key,e.value,"zoom functions not supported"))),m!=="categorical"&&!z||e.value.property!==void 0||D.push(new J(e.key,e.value,'"property" property is required')),D;function B(j){var Q=[],$=j.value,pe=j.key;if(Nr($)!=="array")return[new J(pe,$,"array expected, "+Nr($)+" found")];if($.length!==2)return[new J(pe,$,"array length 2 expected, length "+$.length+" found")];if(z){if(Nr($[0])!=="object")return[new J(pe,$,"object expected, "+Nr($[0])+" found")];if($[0].zoom===void 0)return[new J(pe,$,"object stop key must have zoom")];if($[0].value===void 0)return[new J(pe,$,"object stop key must have value")];if(u&&u>Ne($[0].zoom))return[new J(pe,$[0].zoom,"stop zoom values must appear in ascending order")];Ne($[0].zoom)!==u&&(u=Ne($[0].zoom),i=void 0,x={}),Q=Q.concat(fa({key:pe+"[0]",value:$[0],valueSpec:{zoom:{}},style:j.style,styleSpec:j.styleSpec,objectElementValidators:{zoom:vc,value:V}}))}else Q=Q.concat(V({key:pe+"[0]",value:$[0],valueSpec:{},style:j.style,styleSpec:j.styleSpec},$));return us(ke($[1]))?Q.concat([new J(pe+"[1]",$[1],"expressions are not allowed in function stops.")]):Q.concat(dr({key:pe+"[1]",value:$[1],valueSpec:f,style:j.style,styleSpec:j.styleSpec}))}function V(j,Q){var $=Nr(j.value),pe=Ne(j.value),oe=j.value!==null?j.value:Q;if(t){if($!==t)return[new J(j.key,oe,$+" stop domain type must match previous stop domain type "+t)]}else t=$;if($!=="number"&&$!=="string"&&$!=="boolean")return[new J(j.key,oe,"stop domain value must be a number, string, or boolean")];if($!=="number"&&m!=="categorical"){var ye="number expected, "+$+" found";return bo(f)&&m===void 0&&(ye+='\nIf you intended to use a categorical function, specify `"type": "categorical"`.'),[new J(j.key,oe,ye)]}return m!=="categorical"||$!=="number"||isFinite(pe)&&Math.floor(pe)===pe?m!=="categorical"&&$==="number"&&i!==void 0&&pe<i?[new J(j.key,oe,"stop domain values must appear in ascending order")]:(i=pe,m==="categorical"&&pe in x?[new J(j.key,oe,"stop domain values must be unique")]:(x[pe]=!0,[])):[new J(j.key,oe,"integer expected, found "+pe)]}}function xo(e){var t=(e.expressionContext==="property"?gc:qs)(ke(e.value),e.valueSpec);if(t.result==="error")return t.value.map(function(u){return new J(""+e.key+u.key,e.value,u.message)});var i=t.value.expression||t.value._styleExpression.expression;if(e.expressionContext==="property"&&e.propertyKey==="text-font"&&!i.outputDefined())return[new J(e.key,e.value,'Invalid data expression for "'+e.propertyKey+'". Output values must be contained as literals within the expression.')];if(e.expressionContext==="property"&&e.propertyType==="layout"&&!ve(i))return[new J(e.key,e.value,'"feature-state" data expressions are not supported with layout properties.')];if(e.expressionContext==="filter"&&!ve(i))return[new J(e.key,e.value,'"feature-state" data expressions are not supported with filters.')];if(e.expressionContext&&e.expressionContext.indexOf("cluster")===0){if(!hn(i,["zoom","feature-state"]))return[new J(e.key,e.value,'"zoom" and "feature-state" expressions are not supported with cluster properties.')];if(e.expressionContext==="cluster-initial"&&!Sa(i))return[new J(e.key,e.value,"Feature data expressions are not supported with initial expression part of cluster properties.")]}return[]}function hs(e){var t=e.key,i=e.value,u=e.valueSpec,f=[];return Array.isArray(u.values)?u.values.indexOf(Ne(i))===-1&&f.push(new J(t,i,"expected one of ["+u.values.join(", ")+"], "+JSON.stringify(i)+" found")):Object.keys(u.values).indexOf(Ne(i))===-1&&f.push(new J(t,i,"expected one of ["+Object.keys(u.values).join(", ")+"], "+JSON.stringify(i)+" found")),f}function js(e){if(e===!0||e===!1)return!0;if(!Array.isArray(e)||e.length===0)return!1;switch(e[0]){case"has":return e.length>=2&&e[1]!=="$id"&&e[1]!=="$type";case"in":return e.length>=3&&(typeof e[1]!="string"||Array.isArray(e[2]));case"!in":case"!has":case"none":return!1;case"==":case"!=":case">":case">=":case"<":case"<=":return e.length!==3||Array.isArray(e[1])||Array.isArray(e[2]);case"any":case"all":for(var t=0,i=e.slice(1);t<i.length;t+=1){var u=i[t];if(!js(u)&&typeof u!="boolean")return!1}return!0;default:return!0}}Uo.deserialize=function(e){return new Uo(e._parameters,e._specification)},Uo.serialize=function(e){return{_parameters:e._parameters,_specification:e._specification}};var Hl={type:"boolean",default:!1,transition:!1,"property-type":"data-driven",expression:{interpolated:!1,parameters:["zoom","feature"]}};function Gs(e){if(e==null)return{filter:function(){return!0},needGeometry:!1};js(e)||(e=Zs(e));var t=qs(e,Hl);if(t.result==="error")throw new Error(t.value.map(function(i){return i.key+": "+i.message}).join(", "));return{filter:function(i,u,f){return t.value.evaluate(i,u,{},f)},needGeometry:function i(u){if(!Array.isArray(u))return!1;if(u[0]==="within")return!0;for(var f=1;f<u.length;f++)if(i(u[f]))return!0;return!1}(e)}}function Zh(e,t){return e<t?-1:e>t?1:0}function Zs(e){if(!e)return!0;var t,i=e[0];return e.length<=1?i!=="any":i==="=="?Xl(e[1],e[2],"=="):i==="!="?Ks(Xl(e[1],e[2],"==")):i==="<"||i===">"||i==="<="||i===">="?Xl(e[1],e[2],i):i==="any"?(t=e.slice(1),["any"].concat(t.map(Zs))):i==="all"?["all"].concat(e.slice(1).map(Zs)):i==="none"?["all"].concat(e.slice(1).map(Zs).map(Ks)):i==="in"?xc(e[1],e.slice(2)):i==="!in"?Ks(xc(e[1],e.slice(2))):i==="has"?wc(e[1]):i==="!has"?Ks(wc(e[1])):i!=="within"||e}function Xl(e,t,i){switch(e){case"$type":return["filter-type-"+i,t];case"$id":return["filter-id-"+i,t];default:return["filter-"+i,e,t]}}function xc(e,t){if(t.length===0)return!1;switch(e){case"$type":return["filter-type-in",["literal",t]];case"$id":return["filter-id-in",["literal",t]];default:return t.length>200&&!t.some(function(i){return typeof i!=typeof t[0]})?["filter-in-large",e,["literal",t.sort(Zh)]]:["filter-in-small",e,["literal",t]]}}function wc(e){switch(e){case"$type":return!0;case"$id":return["filter-has-id"];default:return["filter-has",e]}}function Ks(e){return["!",e]}function Wl(e){return js(ke(e.value))?xo(De({},e,{expressionContext:"filter",valueSpec:{value:"boolean"}})):function t(i){var u=i.value,f=i.key;if(Nr(u)!=="array")return[new J(f,u,"array expected, "+Nr(u)+" found")];var m,x=i.styleSpec,k=[];if(u.length<1)return[new J(f,u,"filter array must have at least 1 element")];switch(k=k.concat(hs({key:f+"[0]",value:u[0],valueSpec:x.filter_operator,style:i.style,styleSpec:i.styleSpec})),Ne(u[0])){case"<":case"<=":case">":case">=":u.length>=2&&Ne(u[1])==="$type"&&k.push(new J(f,u,'"$type" cannot be use with operator "'+u[0]+'"'));case"==":case"!=":u.length!==3&&k.push(new J(f,u,'filter array for operator "'+u[0]+'" must have 3 elements'));case"in":case"!in":u.length>=2&&(m=Nr(u[1]))!=="string"&&k.push(new J(f+"[1]",u[1],"string expected, "+m+" found"));for(var A=2;A<u.length;A++)m=Nr(u[A]),Ne(u[1])==="$type"?k=k.concat(hs({key:f+"["+A+"]",value:u[A],valueSpec:x.geometry_type,style:i.style,styleSpec:i.styleSpec})):m!=="string"&&m!=="number"&&m!=="boolean"&&k.push(new J(f+"["+A+"]",u[A],"string, number, or boolean expected, "+m+" found"));break;case"any":case"all":case"none":for(var z=1;z<u.length;z++)k=k.concat(t({key:f+"["+z+"]",value:u[z],style:i.style,styleSpec:i.styleSpec}));break;case"has":case"!has":m=Nr(u[1]),u.length!==2?k.push(new J(f,u,'filter array for "'+u[0]+'" operator must have 2 elements')):m!=="string"&&k.push(new J(f+"[1]",u[1],"string expected, "+m+" found"));break;case"within":m=Nr(u[1]),u.length!==2?k.push(new J(f,u,'filter array for "'+u[0]+'" operator must have 2 elements')):m!=="object"&&k.push(new J(f+"[1]",u[1],"object expected, "+m+" found"))}return k}(e)}function Yl(e,t){var i=e.key,u=e.style,f=e.styleSpec,m=e.value,x=e.objectKey,k=f[t+"_"+e.layerType];if(!k)return[];var A=x.match(/^(.*)-transition$/);if(t==="paint"&&A&&k[A[1]]&&k[A[1]].transition)return dr({key:i,value:m,valueSpec:f.transition,style:u,styleSpec:f});var z,D=e.valueSpec||k[x];if(!D)return[new J(i,m,'unknown property "'+x+'"')];if(Nr(m)==="string"&&bo(D)&&!D.tokens&&(z=/^{([^}]+)}$/.exec(m)))return[new J(i,m,'"'+x+'" does not support interpolation syntax\nUse an identity property function instead: `{ "type": "identity", "property": '+JSON.stringify(z[1])+" }`.")];var B=[];return e.layerType==="symbol"&&(x==="text-field"&&u&&!u.glyphs&&B.push(new J(i,m,'use of "text-field" requires a style "glyphs" property')),x==="text-font"&&Vs(ke(m))&&Ne(m.type)==="identity"&&B.push(new J(i,m,'"text-font" does not support identity functions'))),B.concat(dr({key:e.key,value:m,valueSpec:D,style:u,styleSpec:f,expressionContext:"property",propertyType:t,propertyKey:x}))}function Jl(e){return Yl(e,"paint")}function ps(e){return Yl(e,"layout")}function Sc(e){var t=[],i=e.value,u=e.key,f=e.style,m=e.styleSpec;i.type||i.ref||t.push(new J(u,i,'either "type" or "ref" is required'));var x,k=Ne(i.type),A=Ne(i.ref);if(i.id)for(var z=Ne(i.id),D=0;D<e.arrayIndex;D++){var B=f.layers[D];Ne(B.id)===z&&t.push(new J(u,i.id,'duplicate layer id "'+i.id+'", previously used at line '+B.id.__line__))}if("ref"in i)["type","source","source-layer","filter","layout"].forEach(function(Q){Q in i&&t.push(new J(u,i[Q],'"'+Q+'" is prohibited for ref layers'))}),f.layers.forEach(function(Q){Ne(Q.id)===A&&(x=Q)}),x?x.ref?t.push(new J(u,i.ref,"ref cannot reference another ref layer")):k=Ne(x.type):t.push(new J(u,i.ref,'ref layer "'+A+'" not found'));else if(k!=="background")if(i.source){var V=f.sources&&f.sources[i.source],j=V&&Ne(V.type);V?j==="vector"&&k==="raster"?t.push(new J(u,i.source,'layer "'+i.id+'" requires a raster source')):j==="raster"&&k!=="raster"?t.push(new J(u,i.source,'layer "'+i.id+'" requires a vector source')):j!=="vector"||i["source-layer"]?j==="raster-dem"&&k!=="hillshade"?t.push(new J(u,i.source,"raster-dem source can only be used with layer type 'hillshade'.")):k!=="line"||!i.paint||!i.paint["line-gradient"]||j==="geojson"&&V.lineMetrics||t.push(new J(u,i,'layer "'+i.id+'" specifies a line-gradient, which requires a GeoJSON source with `lineMetrics` enabled.')):t.push(new J(u,i,'layer "'+i.id+'" must specify a "source-layer"')):t.push(new J(u,i.source,'source "'+i.source+'" not found'))}else t.push(new J(u,i,'missing required property "source"'));return t=t.concat(fa({key:u,value:i,valueSpec:m.layer,style:e.style,styleSpec:e.styleSpec,objectElementValidators:{"*":function(){return[]},type:function(){return dr({key:u+".type",value:i.type,valueSpec:m.layer.type,style:e.style,styleSpec:e.styleSpec,object:i,objectKey:"type"})},filter:Wl,layout:function(Q){return fa({layer:i,key:Q.key,value:Q.value,style:Q.style,styleSpec:Q.styleSpec,objectElementValidators:{"*":function($){return ps(De({layerType:k},$))}}})},paint:function(Q){return fa({layer:i,key:Q.key,value:Q.value,style:Q.style,styleSpec:Q.styleSpec,objectElementValidators:{"*":function($){return Jl(De({layerType:k},$))}}})}}}))}function wo(e){var t=e.value,i=e.key,u=Nr(t);return u!=="string"?[new J(i,t,"string expected, "+u+" found")]:[]}var Wr={promoteId:function(e){var t=e.key,i=e.value;if(Nr(i)==="string")return wo({key:t,value:i});var u=[];for(var f in i)u.push.apply(u,wo({key:t+"."+f,value:i[f]}));return u}};function Hs(e){var t=e.value,i=e.key,u=e.styleSpec,f=e.style;if(!t.type)return[new J(i,t,'"type" is required')];var m,x=Ne(t.type);switch(x){case"vector":case"raster":case"raster-dem":return fa({key:i,value:t,valueSpec:u["source_"+x.replace("-","_")],style:e.style,styleSpec:u,objectElementValidators:Wr});case"geojson":if(m=fa({key:i,value:t,valueSpec:u.source_geojson,style:f,styleSpec:u,objectElementValidators:Wr}),t.cluster)for(var k in t.clusterProperties){var A=t.clusterProperties[k],z=A[0],D=typeof z=="string"?[z,["accumulated"],["get",k]]:z;m.push.apply(m,xo({key:i+"."+k+".map",value:A[1],expressionContext:"cluster-map"})),m.push.apply(m,xo({key:i+"."+k+".reduce",value:D,expressionContext:"cluster-reduce"}))}return m;case"video":return fa({key:i,value:t,valueSpec:u.source_video,style:f,styleSpec:u});case"image":return fa({key:i,value:t,valueSpec:u.source_image,style:f,styleSpec:u});case"canvas":return[new J(i,null,"Please use runtime APIs to add canvas sources, rather than including them in stylesheets.","source.canvas")];default:return hs({key:i+".type",value:t.type,valueSpec:{values:["vector","raster","raster-dem","geojson","video","image"]},style:f,styleSpec:u})}}function So(e){var t=e.value,i=e.styleSpec,u=i.light,f=e.style,m=[],x=Nr(t);if(t===void 0)return m;if(x!=="object")return m.concat([new J("light",t,"object expected, "+x+" found")]);for(var k in t){var A=k.match(/^(.*)-transition$/);m=m.concat(A&&u[A[1]]&&u[A[1]].transition?dr({key:k,value:t[k],valueSpec:i.transition,style:f,styleSpec:i}):u[k]?dr({key:k,value:t[k],valueSpec:u[k],style:f,styleSpec:i}):[new J(k,t[k],'unknown property "'+k+'"')])}return m}var Ha={"*":function(){return[]},array:_c,boolean:function(e){var t=e.value,i=e.key,u=Nr(t);return u!=="boolean"?[new J(i,t,"boolean expected, "+u+" found")]:[]},number:vc,color:function(e){var t=e.key,i=e.value,u=Nr(i);return u!=="string"?[new J(t,i,"color expected, "+u+" found")]:Qt(i)===null?[new J(t,i,'color expected, "'+i+'" found')]:[]},constants:ge,enum:hs,filter:Wl,function:bc,layer:Sc,object:fa,source:Hs,light:So,string:wo,formatted:function(e){return wo(e).length===0?[]:xo(e)},resolvedImage:function(e){return wo(e).length===0?[]:xo(e)}};function dr(e){var t=e.value,i=e.valueSpec,u=e.styleSpec;return i.expression&&Vs(Ne(t))?bc(e):i.expression&&us(ke(t))?xo(e):i.type&&Ha[i.type]?Ha[i.type](e):fa(De({},e,{valueSpec:i.type?u[i.type]:i}))}function Vr(e){var t=e.value,i=e.key,u=wo(e);return u.length||(t.indexOf("{fontstack}")===-1&&u.push(new J(i,t,'"glyphs" url must include a "{fontstack}" token')),t.indexOf("{range}")===-1&&u.push(new J(i,t,'"glyphs" url must include a "{range}" token'))),u}function Qn(e,t){t===void 0&&(t=U);var i=[];return i=i.concat(dr({key:"",value:e,valueSpec:t.$root,styleSpec:t,style:e,objectElementValidators:{glyphs:Vr,"*":function(){return[]}}})),e.constants&&(i=i.concat(ge({key:"constants",value:e.constants,style:e,styleSpec:t}))),fs(i)}function fs(e){return[].concat(e).sort(function(t,i){return t.line-i.line})}function qo(e){return function(){for(var t=[],i=arguments.length;i--;)t[i]=arguments[i];return fs(e.apply(this,t))}}Qn.source=qo(Hs),Qn.light=qo(So),Qn.layer=qo(Sc),Qn.filter=qo(Wl),Qn.paintProperty=qo(Jl),Qn.layoutProperty=qo(ps);var ds=Qn,Kh=ds.light,Hh=ds.paintProperty,ms=ds.layoutProperty;function ys(e,t){var i=!1;if(t&&t.length)for(var u=0,f=t;u<f.length;u+=1)e.fire(new le(new Error(f[u].message))),i=!0;return i}var Ca=Pi;function Pi(e,t,i){var u=this.cells=[];if(e instanceof ArrayBuffer){this.arrayBuffer=e;var f=new Int32Array(this.arrayBuffer);e=f[0],this.d=(t=f[1])+2*(i=f[2]);for(var m=0;m<this.d*this.d;m++){var x=f[3+m],k=f[3+m+1];u.push(x===k?null:f.subarray(x,k))}var A=f[3+u.length+1];this.keys=f.subarray(f[3+u.length],A),this.bboxes=f.subarray(A),this.insert=this._insertReadonly}else{this.d=t+2*i;for(var z=0;z<this.d*this.d;z++)u.push([]);this.keys=[],this.bboxes=[]}this.n=t,this.extent=e,this.padding=i,this.scale=t/e,this.uid=0;var D=i/t*e;this.min=-D,this.max=e+D}Pi.prototype.insert=function(e,t,i,u,f){this._forEachCell(t,i,u,f,this._insertCell,this.uid++),this.keys.push(e),this.bboxes.push(t),this.bboxes.push(i),this.bboxes.push(u),this.bboxes.push(f)},Pi.prototype._insertReadonly=function(){throw"Cannot insert into a GridIndex created from an ArrayBuffer."},Pi.prototype._insertCell=function(e,t,i,u,f,m){this.cells[f].push(m)},Pi.prototype.query=function(e,t,i,u,f){var m=this.min,x=this.max;if(e<=m&&t<=m&&x<=i&&x<=u&&!f)return Array.prototype.slice.call(this.keys);var k=[];return this._forEachCell(e,t,i,u,this._queryCell,k,{},f),k},Pi.prototype._queryCell=function(e,t,i,u,f,m,x,k){var A=this.cells[f];if(A!==null)for(var z=this.keys,D=this.bboxes,B=0;B<A.length;B++){var V=A[B];if(x[V]===void 0){var j=4*V;(k?k(D[j+0],D[j+1],D[j+2],D[j+3]):e<=D[j+2]&&t<=D[j+3]&&i>=D[j+0]&&u>=D[j+1])?(x[V]=!0,m.push(z[V])):x[V]=!1}}},Pi.prototype._forEachCell=function(e,t,i,u,f,m,x,k){for(var A=this._convertToCellCoord(e),z=this._convertToCellCoord(t),D=this._convertToCellCoord(i),B=this._convertToCellCoord(u),V=A;V<=D;V++)for(var j=z;j<=B;j++){var Q=this.d*j+V;if((!k||k(this._convertFromCellCoord(V),this._convertFromCellCoord(j),this._convertFromCellCoord(V+1),this._convertFromCellCoord(j+1)))&&f.call(this,e,t,i,u,Q,m,x,k))return}},Pi.prototype._convertFromCellCoord=function(e){return(e-this.padding)/this.scale},Pi.prototype._convertToCellCoord=function(e){return Math.max(0,Math.min(this.d-1,Math.floor(e*this.scale)+this.padding))},Pi.prototype.toArrayBuffer=function(){if(this.arrayBuffer)return this.arrayBuffer;for(var e=this.cells,t=3+this.cells.length+1+1,i=0,u=0;u<this.cells.length;u++)i+=this.cells[u].length;var f=new Int32Array(t+i+this.keys.length+this.bboxes.length);f[0]=this.extent,f[1]=this.n,f[2]=this.padding;for(var m=t,x=0;x<e.length;x++){var k=e[x];f[3+x]=m,f.set(k,m),m+=k.length}return f[3+e.length]=m,f.set(this.keys,m),f[3+e.length+1]=m+=this.keys.length,f.set(this.bboxes,m),m+=this.bboxes.length,f.buffer};var gs=M.ImageData,kc=M.ImageBitmap,wi={};function mt(e,t,i){i===void 0&&(i={}),Object.defineProperty(t,"_classRegistryKey",{value:e,writeable:!1}),wi[e]={klass:t,omit:i.omit||[],shallow:i.shallow||[]}}for(var Vn in mt("Object",Object),Ca.serialize=function(e,t){var i=e.toArrayBuffer();return t&&t.push(i),{buffer:i}},Ca.deserialize=function(e){return new Ca(e.buffer)},mt("Grid",Ca),mt("Color",fr),mt("Error",Error),mt("ResolvedImage",Bi),mt("StylePropertyFunction",Uo),mt("StyleExpression",No,{omit:["_evaluator"]}),mt("ZoomDependentExpression",Vo),mt("ZoomConstantExpression",cs),mt("CompoundExpression",zi,{omit:["_evaluate"]}),go)go[Vn]._classRegistryKey||mt("Expression_"+Vn,go[Vn]);function Xs(e){return e&&typeof ArrayBuffer<"u"&&(e instanceof ArrayBuffer||e.constructor&&e.constructor.name==="ArrayBuffer")}function jo(e){return kc&&e instanceof kc}function da(e,t){if(e==null||typeof e=="boolean"||typeof e=="number"||typeof e=="string"||e instanceof Boolean||e instanceof Number||e instanceof String||e instanceof Date||e instanceof RegExp)return e;if(Xs(e)||jo(e))return t&&t.push(e),e;if(ArrayBuffer.isView(e)){var i=e;return t&&t.push(i.buffer),i}if(e instanceof gs)return t&&t.push(e.data.buffer),e;if(Array.isArray(e)){for(var u=[],f=0,m=e;f<m.length;f+=1)u.push(da(m[f],t));return u}if(typeof e=="object"){var x=e.constructor,k=x._classRegistryKey;if(!k)throw new Error("can't serialize object of unregistered class");var A=x.serialize?x.serialize(e,t):{};if(!x.serialize){for(var z in e)if(e.hasOwnProperty(z)&&!(wi[k].omit.indexOf(z)>=0)){var D=e[z];A[z]=wi[k].shallow.indexOf(z)>=0?D:da(D,t)}e instanceof Error&&(A.message=e.message)}if(A.$name)throw new Error("$name property is reserved for worker serialization logic.");return k!=="Object"&&(A.$name=k),A}throw new Error("can't serialize object of type "+typeof e)}function Un(e){if(e==null||typeof e=="boolean"||typeof e=="number"||typeof e=="string"||e instanceof Boolean||e instanceof Number||e instanceof String||e instanceof Date||e instanceof RegExp||Xs(e)||jo(e)||ArrayBuffer.isView(e)||e instanceof gs)return e;if(Array.isArray(e))return e.map(Un);if(typeof e=="object"){var t=e.$name||"Object",i=wi[t].klass;if(!i)throw new Error("can't deserialize unregistered class "+t);if(i.deserialize)return i.deserialize(e);for(var u=Object.create(i.prototype),f=0,m=Object.keys(e);f<m.length;f+=1){var x=m[f];if(x!=="$name"){var k=e[x];u[x]=wi[t].shallow.indexOf(x)>=0?k:Un(k)}}return u}throw new Error("can't deserialize object of type "+typeof e)}var Ql=function(){this.first=!0};Ql.prototype.update=function(e,t){var i=Math.floor(e);return this.first?(this.first=!1,this.lastIntegerZoom=i,this.lastIntegerZoomTime=0,this.lastZoom=e,this.lastFloorZoom=i,!0):(this.lastFloorZoom>i?(this.lastIntegerZoom=i+1,this.lastIntegerZoomTime=t):this.lastFloorZoom<i&&(this.lastIntegerZoom=i,this.lastIntegerZoomTime=t),e!==this.lastZoom&&(this.lastZoom=e,this.lastFloorZoom=i,!0))};var at={"Latin-1 Supplement":function(e){return e>=128&&e<=255},Arabic:function(e){return e>=1536&&e<=1791},"Arabic Supplement":function(e){return e>=1872&&e<=1919},"Arabic Extended-A":function(e){return e>=2208&&e<=2303},"Hangul Jamo":function(e){return e>=4352&&e<=4607},"Unified Canadian Aboriginal Syllabics":function(e){return e>=5120&&e<=5759},Khmer:function(e){return e>=6016&&e<=6143},"Unified Canadian Aboriginal Syllabics Extended":function(e){return e>=6320&&e<=6399},"General Punctuation":function(e){return e>=8192&&e<=8303},"Letterlike Symbols":function(e){return e>=8448&&e<=8527},"Number Forms":function(e){return e>=8528&&e<=8591},"Miscellaneous Technical":function(e){return e>=8960&&e<=9215},"Control Pictures":function(e){return e>=9216&&e<=9279},"Optical Character Recognition":function(e){return e>=9280&&e<=9311},"Enclosed Alphanumerics":function(e){return e>=9312&&e<=9471},"Geometric Shapes":function(e){return e>=9632&&e<=9727},"Miscellaneous Symbols":function(e){return e>=9728&&e<=9983},"Miscellaneous Symbols and Arrows":function(e){return e>=11008&&e<=11263},"CJK Radicals Supplement":function(e){return e>=11904&&e<=12031},"Kangxi Radicals":function(e){return e>=12032&&e<=12255},"Ideographic Description Characters":function(e){return e>=12272&&e<=12287},"CJK Symbols and Punctuation":function(e){return e>=12288&&e<=12351},Hiragana:function(e){return e>=12352&&e<=12447},Katakana:function(e){return e>=12448&&e<=12543},Bopomofo:function(e){return e>=12544&&e<=12591},"Hangul Compatibility Jamo":function(e){return e>=12592&&e<=12687},Kanbun:function(e){return e>=12688&&e<=12703},"Bopomofo Extended":function(e){return e>=12704&&e<=12735},"CJK Strokes":function(e){return e>=12736&&e<=12783},"Katakana Phonetic Extensions":function(e){return e>=12784&&e<=12799},"Enclosed CJK Letters and Months":function(e){return e>=12800&&e<=13055},"CJK Compatibility":function(e){return e>=13056&&e<=13311},"CJK Unified Ideographs Extension A":function(e){return e>=13312&&e<=19903},"Yijing Hexagram Symbols":function(e){return e>=19904&&e<=19967},"CJK Unified Ideographs":function(e){return e>=19968&&e<=40959},"Yi Syllables":function(e){return e>=40960&&e<=42127},"Yi Radicals":function(e){return e>=42128&&e<=42191},"Hangul Jamo Extended-A":function(e){return e>=43360&&e<=43391},"Hangul Syllables":function(e){return e>=44032&&e<=55215},"Hangul Jamo Extended-B":function(e){return e>=55216&&e<=55295},"Private Use Area":function(e){return e>=57344&&e<=63743},"CJK Compatibility Ideographs":function(e){return e>=63744&&e<=64255},"Arabic Presentation Forms-A":function(e){return e>=64336&&e<=65023},"Vertical Forms":function(e){return e>=65040&&e<=65055},"CJK Compatibility Forms":function(e){return e>=65072&&e<=65103},"Small Form Variants":function(e){return e>=65104&&e<=65135},"Arabic Presentation Forms-B":function(e){return e>=65136&&e<=65279},"Halfwidth and Fullwidth Forms":function(e){return e>=65280&&e<=65519}};function $l(e){for(var t=0,i=e;t<i.length;t+=1)if(Ws(i[t].charCodeAt(0)))return!0;return!1}function Ws(e){return!(e!==746&&e!==747&&(e<4352||!(at["Bopomofo Extended"](e)||at.Bopomofo(e)||at["CJK Compatibility Forms"](e)&&!(e>=65097&&e<=65103)||at["CJK Compatibility Ideographs"](e)||at["CJK Compatibility"](e)||at["CJK Radicals Supplement"](e)||at["CJK Strokes"](e)||!(!at["CJK Symbols and Punctuation"](e)||e>=12296&&e<=12305||e>=12308&&e<=12319||e===12336)||at["CJK Unified Ideographs Extension A"](e)||at["CJK Unified Ideographs"](e)||at["Enclosed CJK Letters and Months"](e)||at["Hangul Compatibility Jamo"](e)||at["Hangul Jamo Extended-A"](e)||at["Hangul Jamo Extended-B"](e)||at["Hangul Jamo"](e)||at["Hangul Syllables"](e)||at.Hiragana(e)||at["Ideographic Description Characters"](e)||at.Kanbun(e)||at["Kangxi Radicals"](e)||at["Katakana Phonetic Extensions"](e)||at.Katakana(e)&&e!==12540||!(!at["Halfwidth and Fullwidth Forms"](e)||e===65288||e===65289||e===65293||e>=65306&&e<=65310||e===65339||e===65341||e===65343||e>=65371&&e<=65503||e===65507||e>=65512&&e<=65519)||!(!at["Small Form Variants"](e)||e>=65112&&e<=65118||e>=65123&&e<=65126)||at["Unified Canadian Aboriginal Syllabics"](e)||at["Unified Canadian Aboriginal Syllabics Extended"](e)||at["Vertical Forms"](e)||at["Yijing Hexagram Symbols"](e)||at["Yi Syllables"](e)||at["Yi Radicals"](e))))}function eu(e){return!(Ws(e)||function(t){return!!(at["Latin-1 Supplement"](t)&&(t===167||t===169||t===174||t===177||t===188||t===189||t===190||t===215||t===247)||at["General Punctuation"](t)&&(t===8214||t===8224||t===8225||t===8240||t===8241||t===8251||t===8252||t===8258||t===8263||t===8264||t===8265||t===8273)||at["Letterlike Symbols"](t)||at["Number Forms"](t)||at["Miscellaneous Technical"](t)&&(t>=8960&&t<=8967||t>=8972&&t<=8991||t>=8996&&t<=9e3||t===9003||t>=9085&&t<=9114||t>=9150&&t<=9165||t===9167||t>=9169&&t<=9179||t>=9186&&t<=9215)||at["Control Pictures"](t)&&t!==9251||at["Optical Character Recognition"](t)||at["Enclosed Alphanumerics"](t)||at["Geometric Shapes"](t)||at["Miscellaneous Symbols"](t)&&!(t>=9754&&t<=9759)||at["Miscellaneous Symbols and Arrows"](t)&&(t>=11026&&t<=11055||t>=11088&&t<=11097||t>=11192&&t<=11243)||at["CJK Symbols and Punctuation"](t)||at.Katakana(t)||at["Private Use Area"](t)||at["CJK Compatibility Forms"](t)||at["Small Form Variants"](t)||at["Halfwidth and Fullwidth Forms"](t)||t===8734||t===8756||t===8757||t>=9984&&t<=10087||t>=10102&&t<=10131||t===65532||t===65533)}(e))}function ia(e){return e>=1424&&e<=2303||at["Arabic Presentation Forms-A"](e)||at["Arabic Presentation Forms-B"](e)}function qn(e,t){return!(!t&&ia(e)||e>=2304&&e<=3583||e>=3840&&e<=4255||at.Khmer(e))}function Ys(e){for(var t=0,i=e;t<i.length;t+=1)if(ia(i[t].charCodeAt(0)))return!0;return!1}var Js=null,jn="unavailable",Ma=null,Ec=function(e){e&&typeof e=="string"&&e.indexOf("NetworkError")>-1&&(jn="error"),Js&&Js(e)};function _s(){tu.fire(new W("pluginStateChange",{pluginStatus:jn,pluginURL:Ma}))}var tu=new fe,ru=function(){return jn},ma=function(){if(jn!=="deferred"||!Ma)throw new Error("rtl-text-plugin cannot be downloaded unless a pluginURL is specified");jn="loading",_s(),Ma&&re({url:Ma},function(e){e?Ec(e):(jn="loaded",_s())})},$n={applyArabicShaping:null,processBidirectionalText:null,processStyledBidirectionalText:null,isLoaded:function(){return jn==="loaded"||$n.applyArabicShaping!=null},isLoading:function(){return jn==="loading"},setState:function(e){jn=e.pluginStatus,Ma=e.pluginURL},isParsed:function(){return $n.applyArabicShaping!=null&&$n.processBidirectionalText!=null&&$n.processStyledBidirectionalText!=null},getPluginURL:function(){return Ma}},lr=function(e,t){this.zoom=e,t?(this.now=t.now,this.fadeDuration=t.fadeDuration,this.zoomHistory=t.zoomHistory,this.transition=t.transition):(this.now=0,this.fadeDuration=0,this.zoomHistory=new Ql,this.transition={})};lr.prototype.isSupportedScript=function(e){return function(t,i){for(var u=0,f=t;u<f.length;u+=1)if(!qn(f[u].charCodeAt(0),i))return!1;return!0}(e,$n.isLoaded())},lr.prototype.crossFadingFactor=function(){return this.fadeDuration===0?1:Math.min((this.now-this.zoomHistory.lastIntegerZoomTime)/this.fadeDuration,1)},lr.prototype.getCrossfadeParameters=function(){var e=this.zoom,t=e-Math.floor(e),i=this.crossFadingFactor();return e>this.zoomHistory.lastIntegerZoom?{fromScale:2,toScale:1,t:t+(1-t)*i}:{fromScale:.5,toScale:1,t:1-(1-i)*t}};var Ea=function(e,t){this.property=e,this.value=t,this.expression=function(i,u){if(Vs(i))return new Uo(i,u);if(us(i)){var f=gc(i,u);if(f.result==="error")throw new Error(f.value.map(function(x){return x.key+": "+x.message}).join(", "));return f.value}var m=i;return typeof i=="string"&&u.type==="color"&&(m=fr.parse(i)),{kind:"constant",evaluate:function(){return m}}}(t===void 0?e.specification.default:t,e.specification)};Ea.prototype.isDataDriven=function(){return this.expression.kind==="source"||this.expression.kind==="composite"},Ea.prototype.possiblyEvaluate=function(e,t,i){return this.property.possiblyEvaluate(this,e,t,i)};var na=function(e){this.property=e,this.value=new Ea(e,void 0)};na.prototype.transitioned=function(e,t){return new ko(this.property,this.value,t,_e({},e.transition,this.transition),e.now)},na.prototype.untransitioned=function(){return new ko(this.property,this.value,null,{},0)};var rn=function(e){this._properties=e,this._values=Object.create(e.defaultTransitionablePropertyValues)};rn.prototype.getValue=function(e){return gt(this._values[e].value.value)},rn.prototype.setValue=function(e,t){this._values.hasOwnProperty(e)||(this._values[e]=new na(this._values[e].property)),this._values[e].value=new Ea(this._values[e].property,t===null?void 0:gt(t))},rn.prototype.getTransition=function(e){return gt(this._values[e].transition)},rn.prototype.setTransition=function(e,t){this._values.hasOwnProperty(e)||(this._values[e]=new na(this._values[e].property)),this._values[e].transition=gt(t)||void 0},rn.prototype.serialize=function(){for(var e={},t=0,i=Object.keys(this._values);t<i.length;t+=1){var u=i[t],f=this.getValue(u);f!==void 0&&(e[u]=f);var m=this.getTransition(u);m!==void 0&&(e[u+"-transition"]=m)}return e},rn.prototype.transitioned=function(e,t){for(var i=new Xa(this._properties),u=0,f=Object.keys(this._values);u<f.length;u+=1){var m=f[u];i._values[m]=this._values[m].transitioned(e,t._values[m])}return i},rn.prototype.untransitioned=function(){for(var e=new Xa(this._properties),t=0,i=Object.keys(this._values);t<i.length;t+=1){var u=i[t];e._values[u]=this._values[u].untransitioned()}return e};var ko=function(e,t,i,u,f){this.property=e,this.value=t,this.begin=f+u.delay||0,this.end=this.begin+u.duration||0,e.specification.transition&&(u.delay||u.duration)&&(this.prior=i)};ko.prototype.possiblyEvaluate=function(e,t,i){var u=e.now||0,f=this.value.possiblyEvaluate(e,t,i),m=this.prior;if(m){if(u>this.end)return this.prior=null,f;if(this.value.isDataDriven())return this.prior=null,f;if(u<this.begin)return m.possiblyEvaluate(e,t,i);var x=(u-this.begin)/(this.end-this.begin);return this.property.interpolate(m.possiblyEvaluate(e,t,i),f,function(k){if(k<=0)return 0;if(k>=1)return 1;var A=k*k,z=A*k;return 4*(k<.5?z:3*(k-A)+z-.75)}(x))}return f};var Xa=function(e){this._properties=e,this._values=Object.create(e.defaultTransitioningPropertyValues)};Xa.prototype.possiblyEvaluate=function(e,t,i){for(var u=new vs(this._properties),f=0,m=Object.keys(this._values);f<m.length;f+=1){var x=m[f];u._values[x]=this._values[x].possiblyEvaluate(e,t,i)}return u},Xa.prototype.hasTransition=function(){for(var e=0,t=Object.keys(this._values);e<t.length;e+=1)if(this._values[t[e]].prior)return!0;return!1};var ya=function(e){this._properties=e,this._values=Object.create(e.defaultPropertyValues)};ya.prototype.getValue=function(e){return gt(this._values[e].value)},ya.prototype.setValue=function(e,t){this._values[e]=new Ea(this._values[e].property,t===null?void 0:gt(t))},ya.prototype.serialize=function(){for(var e={},t=0,i=Object.keys(this._values);t<i.length;t+=1){var u=i[t],f=this.getValue(u);f!==void 0&&(e[u]=f)}return e},ya.prototype.possiblyEvaluate=function(e,t,i){for(var u=new vs(this._properties),f=0,m=Object.keys(this._values);f<m.length;f+=1){var x=m[f];u._values[x]=this._values[x].possiblyEvaluate(e,t,i)}return u};var gn=function(e,t,i){this.property=e,this.value=t,this.parameters=i};gn.prototype.isConstant=function(){return this.value.kind==="constant"},gn.prototype.constantOr=function(e){return this.value.kind==="constant"?this.value.value:e},gn.prototype.evaluate=function(e,t,i,u){return this.property.evaluate(this.value,this.parameters,e,t,i,u)};var vs=function(e){this._properties=e,this._values=Object.create(e.defaultPossiblyEvaluatedValues)};vs.prototype.get=function(e){return this._values[e]};var Et=function(e){this.specification=e};Et.prototype.possiblyEvaluate=function(e,t){return e.expression.evaluate(t)},Et.prototype.interpolate=function(e,t,i){var u=Oo[this.specification.type];return u?u(e,t,i):e};var _t=function(e,t){this.specification=e,this.overrides=t};_t.prototype.possiblyEvaluate=function(e,t,i,u){return new gn(this,e.expression.kind==="constant"||e.expression.kind==="camera"?{kind:"constant",value:e.expression.evaluate(t,null,{},i,u)}:e.expression,t)},_t.prototype.interpolate=function(e,t,i){if(e.value.kind!=="constant"||t.value.kind!=="constant")return e;if(e.value.value===void 0||t.value.value===void 0)return new gn(this,{kind:"constant",value:void 0},e.parameters);var u=Oo[this.specification.type];return u?new gn(this,{kind:"constant",value:u(e.value.value,t.value.value,i)},e.parameters):e},_t.prototype.evaluate=function(e,t,i,u,f,m){return e.kind==="constant"?e.value:e.evaluate(t,i,u,f,m)};var Qs=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.possiblyEvaluate=function(i,u,f,m){if(i.value===void 0)return new gn(this,{kind:"constant",value:void 0},u);if(i.expression.kind==="constant"){var x=i.expression.evaluate(u,null,{},f,m),k=i.property.specification.type==="resolvedImage"&&typeof x!="string"?x.name:x,A=this._calculate(k,k,k,u);return new gn(this,{kind:"constant",value:A},u)}if(i.expression.kind==="camera"){var z=this._calculate(i.expression.evaluate({zoom:u.zoom-1}),i.expression.evaluate({zoom:u.zoom}),i.expression.evaluate({zoom:u.zoom+1}),u);return new gn(this,{kind:"constant",value:z},u)}return new gn(this,i.expression,u)},t.prototype.evaluate=function(i,u,f,m,x,k){if(i.kind==="source"){var A=i.evaluate(u,f,m,x,k);return this._calculate(A,A,A,u)}return i.kind==="composite"?this._calculate(i.evaluate({zoom:Math.floor(u.zoom)-1},f,m),i.evaluate({zoom:Math.floor(u.zoom)},f,m),i.evaluate({zoom:Math.floor(u.zoom)+1},f,m),u):i.value},t.prototype._calculate=function(i,u,f,m){return m.zoom>m.zoomHistory.lastIntegerZoom?{from:i,to:u}:{from:f,to:u}},t.prototype.interpolate=function(i){return i},t}(_t),_n=function(e){this.specification=e};_n.prototype.possiblyEvaluate=function(e,t,i,u){if(e.value!==void 0){if(e.expression.kind==="constant"){var f=e.expression.evaluate(t,null,{},i,u);return this._calculate(f,f,f,t)}return this._calculate(e.expression.evaluate(new lr(Math.floor(t.zoom-1),t)),e.expression.evaluate(new lr(Math.floor(t.zoom),t)),e.expression.evaluate(new lr(Math.floor(t.zoom+1),t)),t)}},_n.prototype._calculate=function(e,t,i,u){return u.zoom>u.zoomHistory.lastIntegerZoom?{from:e,to:t}:{from:i,to:t}},_n.prototype.interpolate=function(e){return e};var ga=function(e){this.specification=e};ga.prototype.possiblyEvaluate=function(e,t,i,u){return!!e.expression.evaluate(t,null,{},i,u)},ga.prototype.interpolate=function(){return!1};var nn=function(e){for(var t in this.properties=e,this.defaultPropertyValues={},this.defaultTransitionablePropertyValues={},this.defaultTransitioningPropertyValues={},this.defaultPossiblyEvaluatedValues={},this.overridableProperties=[],e){var i=e[t];i.specification.overridable&&this.overridableProperties.push(t);var u=this.defaultPropertyValues[t]=new Ea(i,void 0),f=this.defaultTransitionablePropertyValues[t]=new na(i);this.defaultTransitioningPropertyValues[t]=f.untransitioned(),this.defaultPossiblyEvaluatedValues[t]=u.possiblyEvaluate({})}};mt("DataDrivenProperty",_t),mt("DataConstantProperty",Et),mt("CrossFadedDataDrivenProperty",Qs),mt("CrossFadedProperty",_n),mt("ColorRampProperty",ga);var Ta=function(e){function t(i,u){if(e.call(this),this.id=i.id,this.type=i.type,this._featureFilter={filter:function(){return!0},needGeometry:!1},i.type!=="custom"&&(this.metadata=(i=i).metadata,this.minzoom=i.minzoom,this.maxzoom=i.maxzoom,i.type!=="background"&&(this.source=i.source,this.sourceLayer=i["source-layer"],this.filter=i.filter),u.layout&&(this._unevaluatedLayout=new ya(u.layout)),u.paint)){for(var f in this._transitionablePaint=new rn(u.paint),i.paint)this.setPaintProperty(f,i.paint[f],{validate:!1});for(var m in i.layout)this.setLayoutProperty(m,i.layout[m],{validate:!1});this._transitioningPaint=this._transitionablePaint.untransitioned(),this.paint=new vs(u.paint)}}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.getCrossfadeParameters=function(){return this._crossfadeParameters},t.prototype.getLayoutProperty=function(i){return i==="visibility"?this.visibility:this._unevaluatedLayout.getValue(i)},t.prototype.setLayoutProperty=function(i,u,f){f===void 0&&(f={}),u!=null&&this._validate(ms,"layers."+this.id+".layout."+i,i,u,f)||(i!=="visibility"?this._unevaluatedLayout.setValue(i,u):this.visibility=u)},t.prototype.getPaintProperty=function(i){return kt(i,"-transition")?this._transitionablePaint.getTransition(i.slice(0,-11)):this._transitionablePaint.getValue(i)},t.prototype.setPaintProperty=function(i,u,f){if(f===void 0&&(f={}),u!=null&&this._validate(Hh,"layers."+this.id+".paint."+i,i,u,f))return!1;if(kt(i,"-transition"))return this._transitionablePaint.setTransition(i.slice(0,-11),u||void 0),!1;var m=this._transitionablePaint._values[i],x=m.property.specification["property-type"]==="cross-faded-data-driven",k=m.value.isDataDriven(),A=m.value;this._transitionablePaint.setValue(i,u),this._handleSpecialPaintPropertyUpdate(i);var z=this._transitionablePaint._values[i].value;return z.isDataDriven()||k||x||this._handleOverridablePaintPropertyUpdate(i,A,z)},t.prototype._handleSpecialPaintPropertyUpdate=function(i){},t.prototype._handleOverridablePaintPropertyUpdate=function(i,u,f){return!1},t.prototype.isHidden=function(i){return!!(this.minzoom&&i<this.minzoom)||!!(this.maxzoom&&i>=this.maxzoom)||this.visibility==="none"},t.prototype.updateTransitions=function(i){this._transitioningPaint=this._transitionablePaint.transitioned(i,this._transitioningPaint)},t.prototype.hasTransition=function(){return this._transitioningPaint.hasTransition()},t.prototype.recalculate=function(i,u){i.getCrossfadeParameters&&(this._crossfadeParameters=i.getCrossfadeParameters()),this._unevaluatedLayout&&(this.layout=this._unevaluatedLayout.possiblyEvaluate(i,void 0,u)),this.paint=this._transitioningPaint.possiblyEvaluate(i,void 0,u)},t.prototype.serialize=function(){var i={id:this.id,type:this.type,source:this.source,"source-layer":this.sourceLayer,metadata:this.metadata,minzoom:this.minzoom,maxzoom:this.maxzoom,filter:this.filter,layout:this._unevaluatedLayout&&this._unevaluatedLayout.serialize(),paint:this._transitionablePaint&&this._transitionablePaint.serialize()};return this.visibility&&(i.layout=i.layout||{},i.layout.visibility=this.visibility),Ke(i,function(u,f){return!(u===void 0||f==="layout"&&!Object.keys(u).length||f==="paint"&&!Object.keys(u).length)})},t.prototype._validate=function(i,u,f,m,x){return x===void 0&&(x={}),(!x||x.validate!==!1)&&ys(this,i.call(ds,{key:u,layerType:this.type,objectKey:f,value:m,styleSpec:U,style:{glyphs:!0,sprite:!0}}))},t.prototype.is3D=function(){return!1},t.prototype.isTileClipped=function(){return!1},t.prototype.hasOffscreenPass=function(){return!1},t.prototype.resize=function(){},t.prototype.isStateDependent=function(){for(var i in this.paint._values){var u=this.paint.get(i);if(u instanceof gn&&bo(u.property.specification)&&(u.value.kind==="source"||u.value.kind==="composite")&&u.value.isStateDependent)return!0}return!1},t}(fe),iu={Int8:Int8Array,Uint8:Uint8Array,Int16:Int16Array,Uint16:Uint16Array,Int32:Int32Array,Uint32:Uint32Array,Float32:Float32Array},$s=function(e,t){this._structArray=e,this._pos1=t*this.size,this._pos2=this._pos1/2,this._pos4=this._pos1/4,this._pos8=this._pos1/8},Ar=function(){this.isTransferred=!1,this.capacity=-1,this.resize(0)};function Ki(e,t){t===void 0&&(t=1);var i=0,u=0;return{members:e.map(function(f){var m=iu[f.type].BYTES_PER_ELEMENT,x=i=Tc(i,Math.max(t,m)),k=f.components||1;return u=Math.max(u,m),i+=m*k,{name:f.name,type:f.type,components:k,offset:x}}),size:Tc(i,Math.max(u,t)),alignment:t}}function Tc(e,t){return Math.ceil(e/t)*t}Ar.serialize=function(e,t){return e._trim(),t&&(e.isTransferred=!0,t.push(e.arrayBuffer)),{length:e.length,arrayBuffer:e.arrayBuffer}},Ar.deserialize=function(e){var t=Object.create(this.prototype);return t.arrayBuffer=e.arrayBuffer,t.length=e.length,t.capacity=e.arrayBuffer.byteLength/t.bytesPerElement,t._refreshViews(),t},Ar.prototype._trim=function(){this.length!==this.capacity&&(this.capacity=this.length,this.arrayBuffer=this.arrayBuffer.slice(0,this.length*this.bytesPerElement),this._refreshViews())},Ar.prototype.clear=function(){this.length=0},Ar.prototype.resize=function(e){this.reserve(e),this.length=e},Ar.prototype.reserve=function(e){if(e>this.capacity){this.capacity=Math.max(e,Math.floor(5*this.capacity),128),this.arrayBuffer=new ArrayBuffer(this.capacity*this.bytesPerElement);var t=this.uint8;this._refreshViews(),t&&this.uint8.set(t)}},Ar.prototype._refreshViews=function(){throw new Error("_refreshViews() must be implemented by each concrete StructArray layout")};var Eo=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},t.prototype.emplaceBack=function(i,u){var f=this.length;return this.resize(f+1),this.emplace(f,i,u)},t.prototype.emplace=function(i,u,f){var m=2*i;return this.int16[m+0]=u,this.int16[m+1]=f,i},t}(Ar);Eo.prototype.bytesPerElement=4,mt("StructArrayLayout2i4",Eo);var nu=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},t.prototype.emplaceBack=function(i,u,f,m){var x=this.length;return this.resize(x+1),this.emplace(x,i,u,f,m)},t.prototype.emplace=function(i,u,f,m,x){var k=4*i;return this.int16[k+0]=u,this.int16[k+1]=f,this.int16[k+2]=m,this.int16[k+3]=x,i},t}(Ar);nu.prototype.bytesPerElement=8,mt("StructArrayLayout4i8",nu);var Da=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},t.prototype.emplaceBack=function(i,u,f,m,x,k){var A=this.length;return this.resize(A+1),this.emplace(A,i,u,f,m,x,k)},t.prototype.emplace=function(i,u,f,m,x,k,A){var z=6*i;return this.int16[z+0]=u,this.int16[z+1]=f,this.int16[z+2]=m,this.int16[z+3]=x,this.int16[z+4]=k,this.int16[z+5]=A,i},t}(Ar);Da.prototype.bytesPerElement=12,mt("StructArrayLayout2i4i12",Da);var Gn=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},t.prototype.emplaceBack=function(i,u,f,m,x,k){var A=this.length;return this.resize(A+1),this.emplace(A,i,u,f,m,x,k)},t.prototype.emplace=function(i,u,f,m,x,k,A){var z=4*i,D=8*i;return this.int16[z+0]=u,this.int16[z+1]=f,this.uint8[D+4]=m,this.uint8[D+5]=x,this.uint8[D+6]=k,this.uint8[D+7]=A,i},t}(Ar);Gn.prototype.bytesPerElement=8,mt("StructArrayLayout2i4ub8",Gn);var Go=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},t.prototype.emplaceBack=function(i,u){var f=this.length;return this.resize(f+1),this.emplace(f,i,u)},t.prototype.emplace=function(i,u,f){var m=2*i;return this.float32[m+0]=u,this.float32[m+1]=f,i},t}(Ar);Go.prototype.bytesPerElement=8,mt("StructArrayLayout2f8",Go);var Ia=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},t.prototype.emplaceBack=function(i,u,f,m,x,k,A,z,D,B){var V=this.length;return this.resize(V+1),this.emplace(V,i,u,f,m,x,k,A,z,D,B)},t.prototype.emplace=function(i,u,f,m,x,k,A,z,D,B,V){var j=10*i;return this.uint16[j+0]=u,this.uint16[j+1]=f,this.uint16[j+2]=m,this.uint16[j+3]=x,this.uint16[j+4]=k,this.uint16[j+5]=A,this.uint16[j+6]=z,this.uint16[j+7]=D,this.uint16[j+8]=B,this.uint16[j+9]=V,i},t}(Ar);Ia.prototype.bytesPerElement=20,mt("StructArrayLayout10ui20",Ia);var el=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},t.prototype.emplaceBack=function(i,u,f,m,x,k,A,z,D,B,V,j){var Q=this.length;return this.resize(Q+1),this.emplace(Q,i,u,f,m,x,k,A,z,D,B,V,j)},t.prototype.emplace=function(i,u,f,m,x,k,A,z,D,B,V,j,Q){var $=12*i;return this.int16[$+0]=u,this.int16[$+1]=f,this.int16[$+2]=m,this.int16[$+3]=x,this.uint16[$+4]=k,this.uint16[$+5]=A,this.uint16[$+6]=z,this.uint16[$+7]=D,this.int16[$+8]=B,this.int16[$+9]=V,this.int16[$+10]=j,this.int16[$+11]=Q,i},t}(Ar);el.prototype.bytesPerElement=24,mt("StructArrayLayout4i4ui4i24",el);var Zo=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},t.prototype.emplaceBack=function(i,u,f){var m=this.length;return this.resize(m+1),this.emplace(m,i,u,f)},t.prototype.emplace=function(i,u,f,m){var x=3*i;return this.float32[x+0]=u,this.float32[x+1]=f,this.float32[x+2]=m,i},t}(Ar);Zo.prototype.bytesPerElement=12,mt("StructArrayLayout3f12",Zo);var bs=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)},t.prototype.emplaceBack=function(i){var u=this.length;return this.resize(u+1),this.emplace(u,i)},t.prototype.emplace=function(i,u){return this.uint32[1*i+0]=u,i},t}(Ar);bs.prototype.bytesPerElement=4,mt("StructArrayLayout1ul4",bs);var au=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},t.prototype.emplaceBack=function(i,u,f,m,x,k,A,z,D){var B=this.length;return this.resize(B+1),this.emplace(B,i,u,f,m,x,k,A,z,D)},t.prototype.emplace=function(i,u,f,m,x,k,A,z,D,B){var V=10*i,j=5*i;return this.int16[V+0]=u,this.int16[V+1]=f,this.int16[V+2]=m,this.int16[V+3]=x,this.int16[V+4]=k,this.int16[V+5]=A,this.uint32[j+3]=z,this.uint16[V+8]=D,this.uint16[V+9]=B,i},t}(Ar);au.prototype.bytesPerElement=20,mt("StructArrayLayout6i1ul2ui20",au);var Ko=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},t.prototype.emplaceBack=function(i,u,f,m,x,k){var A=this.length;return this.resize(A+1),this.emplace(A,i,u,f,m,x,k)},t.prototype.emplace=function(i,u,f,m,x,k,A){var z=6*i;return this.int16[z+0]=u,this.int16[z+1]=f,this.int16[z+2]=m,this.int16[z+3]=x,this.int16[z+4]=k,this.int16[z+5]=A,i},t}(Ar);Ko.prototype.bytesPerElement=12,mt("StructArrayLayout2i2i2i12",Ko);var To=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},t.prototype.emplaceBack=function(i,u,f,m,x){var k=this.length;return this.resize(k+1),this.emplace(k,i,u,f,m,x)},t.prototype.emplace=function(i,u,f,m,x,k){var A=4*i,z=8*i;return this.float32[A+0]=u,this.float32[A+1]=f,this.float32[A+2]=m,this.int16[z+6]=x,this.int16[z+7]=k,i},t}(Ar);To.prototype.bytesPerElement=16,mt("StructArrayLayout2f1f2i16",To);var ou=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},t.prototype.emplaceBack=function(i,u,f,m){var x=this.length;return this.resize(x+1),this.emplace(x,i,u,f,m)},t.prototype.emplace=function(i,u,f,m,x){var k=12*i,A=3*i;return this.uint8[k+0]=u,this.uint8[k+1]=f,this.float32[A+1]=m,this.float32[A+2]=x,i},t}(Ar);ou.prototype.bytesPerElement=12,mt("StructArrayLayout2ub2f12",ou);var Wa=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},t.prototype.emplaceBack=function(i,u,f){var m=this.length;return this.resize(m+1),this.emplace(m,i,u,f)},t.prototype.emplace=function(i,u,f,m){var x=3*i;return this.uint16[x+0]=u,this.uint16[x+1]=f,this.uint16[x+2]=m,i},t}(Ar);Wa.prototype.bytesPerElement=6,mt("StructArrayLayout3ui6",Wa);var Ya=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},t.prototype.emplaceBack=function(i,u,f,m,x,k,A,z,D,B,V,j,Q,$,pe,oe,ye){var xe=this.length;return this.resize(xe+1),this.emplace(xe,i,u,f,m,x,k,A,z,D,B,V,j,Q,$,pe,oe,ye)},t.prototype.emplace=function(i,u,f,m,x,k,A,z,D,B,V,j,Q,$,pe,oe,ye,xe){var Se=24*i,Te=12*i,Me=48*i;return this.int16[Se+0]=u,this.int16[Se+1]=f,this.uint16[Se+2]=m,this.uint16[Se+3]=x,this.uint32[Te+2]=k,this.uint32[Te+3]=A,this.uint32[Te+4]=z,this.uint16[Se+10]=D,this.uint16[Se+11]=B,this.uint16[Se+12]=V,this.float32[Te+7]=j,this.float32[Te+8]=Q,this.uint8[Me+36]=$,this.uint8[Me+37]=pe,this.uint8[Me+38]=oe,this.uint32[Te+10]=ye,this.int16[Se+22]=xe,i},t}(Ar);Ya.prototype.bytesPerElement=48,mt("StructArrayLayout2i2ui3ul3ui2f3ub1ul1i48",Ya);var tl=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},t.prototype.emplaceBack=function(i,u,f,m,x,k,A,z,D,B,V,j,Q,$,pe,oe,ye,xe,Se,Te,Me,Xe,rt,wt,ut,It,ht,$t){var Bt=this.length;return this.resize(Bt+1),this.emplace(Bt,i,u,f,m,x,k,A,z,D,B,V,j,Q,$,pe,oe,ye,xe,Se,Te,Me,Xe,rt,wt,ut,It,ht,$t)},t.prototype.emplace=function(i,u,f,m,x,k,A,z,D,B,V,j,Q,$,pe,oe,ye,xe,Se,Te,Me,Xe,rt,wt,ut,It,ht,$t,Bt){var vt=34*i,sr=17*i;return this.int16[vt+0]=u,this.int16[vt+1]=f,this.int16[vt+2]=m,this.int16[vt+3]=x,this.int16[vt+4]=k,this.int16[vt+5]=A,this.int16[vt+6]=z,this.int16[vt+7]=D,this.uint16[vt+8]=B,this.uint16[vt+9]=V,this.uint16[vt+10]=j,this.uint16[vt+11]=Q,this.uint16[vt+12]=$,this.uint16[vt+13]=pe,this.uint16[vt+14]=oe,this.uint16[vt+15]=ye,this.uint16[vt+16]=xe,this.uint16[vt+17]=Se,this.uint16[vt+18]=Te,this.uint16[vt+19]=Me,this.uint16[vt+20]=Xe,this.uint16[vt+21]=rt,this.uint16[vt+22]=wt,this.uint32[sr+12]=ut,this.float32[sr+13]=It,this.float32[sr+14]=ht,this.float32[sr+15]=$t,this.float32[sr+16]=Bt,i},t}(Ar);tl.prototype.bytesPerElement=68,mt("StructArrayLayout8i15ui1ul4f68",tl);var Ja=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},t.prototype.emplaceBack=function(i){var u=this.length;return this.resize(u+1),this.emplace(u,i)},t.prototype.emplace=function(i,u){return this.float32[1*i+0]=u,i},t}(Ar);Ja.prototype.bytesPerElement=4,mt("StructArrayLayout1f4",Ja);var aa=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},t.prototype.emplaceBack=function(i,u,f){var m=this.length;return this.resize(m+1),this.emplace(m,i,u,f)},t.prototype.emplace=function(i,u,f,m){var x=3*i;return this.int16[x+0]=u,this.int16[x+1]=f,this.int16[x+2]=m,i},t}(Ar);aa.prototype.bytesPerElement=6,mt("StructArrayLayout3i6",aa);var su=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},t.prototype.emplaceBack=function(i,u,f){var m=this.length;return this.resize(m+1),this.emplace(m,i,u,f)},t.prototype.emplace=function(i,u,f,m){var x=4*i;return this.uint32[2*i+0]=u,this.uint16[x+2]=f,this.uint16[x+3]=m,i},t}(Ar);su.prototype.bytesPerElement=8,mt("StructArrayLayout1ul2ui8",su);var xs=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},t.prototype.emplaceBack=function(i,u){var f=this.length;return this.resize(f+1),this.emplace(f,i,u)},t.prototype.emplace=function(i,u,f){var m=2*i;return this.uint16[m+0]=u,this.uint16[m+1]=f,i},t}(Ar);xs.prototype.bytesPerElement=4,mt("StructArrayLayout2ui4",xs);var lu=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},t.prototype.emplaceBack=function(i){var u=this.length;return this.resize(u+1),this.emplace(u,i)},t.prototype.emplace=function(i,u){return this.uint16[1*i+0]=u,i},t}(Ar);lu.prototype.bytesPerElement=2,mt("StructArrayLayout1ui2",lu);var rl=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},t.prototype.emplaceBack=function(i,u,f,m){var x=this.length;return this.resize(x+1),this.emplace(x,i,u,f,m)},t.prototype.emplace=function(i,u,f,m,x){var k=4*i;return this.float32[k+0]=u,this.float32[k+1]=f,this.float32[k+2]=m,this.float32[k+3]=x,i},t}(Ar);rl.prototype.bytesPerElement=16,mt("StructArrayLayout4f16",rl);var n=function(e){function t(){e.apply(this,arguments)}e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t;var i={anchorPointX:{configurable:!0},anchorPointY:{configurable:!0},x1:{configurable:!0},y1:{configurable:!0},x2:{configurable:!0},y2:{configurable:!0},featureIndex:{configurable:!0},sourceLayerIndex:{configurable:!0},bucketIndex:{configurable:!0},anchorPoint:{configurable:!0}};return i.anchorPointX.get=function(){return this._structArray.int16[this._pos2+0]},i.anchorPointY.get=function(){return this._structArray.int16[this._pos2+1]},i.x1.get=function(){return this._structArray.int16[this._pos2+2]},i.y1.get=function(){return this._structArray.int16[this._pos2+3]},i.x2.get=function(){return this._structArray.int16[this._pos2+4]},i.y2.get=function(){return this._structArray.int16[this._pos2+5]},i.featureIndex.get=function(){return this._structArray.uint32[this._pos4+3]},i.sourceLayerIndex.get=function(){return this._structArray.uint16[this._pos2+8]},i.bucketIndex.get=function(){return this._structArray.uint16[this._pos2+9]},i.anchorPoint.get=function(){return new F(this.anchorPointX,this.anchorPointY)},Object.defineProperties(t.prototype,i),t}($s);n.prototype.size=20;var s=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.get=function(i){return new n(this,i)},t}(au);mt("CollisionBoxArray",s);var o=function(e){function t(){e.apply(this,arguments)}e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t;var i={anchorX:{configurable:!0},anchorY:{configurable:!0},glyphStartIndex:{configurable:!0},numGlyphs:{configurable:!0},vertexStartIndex:{configurable:!0},lineStartIndex:{configurable:!0},lineLength:{configurable:!0},segment:{configurable:!0},lowerSize:{configurable:!0},upperSize:{configurable:!0},lineOffsetX:{configurable:!0},lineOffsetY:{configurable:!0},writingMode:{configurable:!0},placedOrientation:{configurable:!0},hidden:{configurable:!0},crossTileID:{configurable:!0},associatedIconIndex:{configurable:!0}};return i.anchorX.get=function(){return this._structArray.int16[this._pos2+0]},i.anchorY.get=function(){return this._structArray.int16[this._pos2+1]},i.glyphStartIndex.get=function(){return this._structArray.uint16[this._pos2+2]},i.numGlyphs.get=function(){return this._structArray.uint16[this._pos2+3]},i.vertexStartIndex.get=function(){return this._structArray.uint32[this._pos4+2]},i.lineStartIndex.get=function(){return this._structArray.uint32[this._pos4+3]},i.lineLength.get=function(){return this._structArray.uint32[this._pos4+4]},i.segment.get=function(){return this._structArray.uint16[this._pos2+10]},i.lowerSize.get=function(){return this._structArray.uint16[this._pos2+11]},i.upperSize.get=function(){return this._structArray.uint16[this._pos2+12]},i.lineOffsetX.get=function(){return this._structArray.float32[this._pos4+7]},i.lineOffsetY.get=function(){return this._structArray.float32[this._pos4+8]},i.writingMode.get=function(){return this._structArray.uint8[this._pos1+36]},i.placedOrientation.get=function(){return this._structArray.uint8[this._pos1+37]},i.placedOrientation.set=function(u){this._structArray.uint8[this._pos1+37]=u},i.hidden.get=function(){return this._structArray.uint8[this._pos1+38]},i.hidden.set=function(u){this._structArray.uint8[this._pos1+38]=u},i.crossTileID.get=function(){return this._structArray.uint32[this._pos4+10]},i.crossTileID.set=function(u){this._structArray.uint32[this._pos4+10]=u},i.associatedIconIndex.get=function(){return this._structArray.int16[this._pos2+22]},Object.defineProperties(t.prototype,i),t}($s);o.prototype.size=48;var h=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.get=function(i){return new o(this,i)},t}(Ya);mt("PlacedSymbolArray",h);var _=function(e){function t(){e.apply(this,arguments)}e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t;var i={anchorX:{configurable:!0},anchorY:{configurable:!0},rightJustifiedTextSymbolIndex:{configurable:!0},centerJustifiedTextSymbolIndex:{configurable:!0},leftJustifiedTextSymbolIndex:{configurable:!0},verticalPlacedTextSymbolIndex:{configurable:!0},placedIconSymbolIndex:{configurable:!0},verticalPlacedIconSymbolIndex:{configurable:!0},key:{configurable:!0},textBoxStartIndex:{configurable:!0},textBoxEndIndex:{configurable:!0},verticalTextBoxStartIndex:{configurable:!0},verticalTextBoxEndIndex:{configurable:!0},iconBoxStartIndex:{configurable:!0},iconBoxEndIndex:{configurable:!0},verticalIconBoxStartIndex:{configurable:!0},verticalIconBoxEndIndex:{configurable:!0},featureIndex:{configurable:!0},numHorizontalGlyphVertices:{configurable:!0},numVerticalGlyphVertices:{configurable:!0},numIconVertices:{configurable:!0},numVerticalIconVertices:{configurable:!0},useRuntimeCollisionCircles:{configurable:!0},crossTileID:{configurable:!0},textBoxScale:{configurable:!0},textOffset0:{configurable:!0},textOffset1:{configurable:!0},collisionCircleDiameter:{configurable:!0}};return i.anchorX.get=function(){return this._structArray.int16[this._pos2+0]},i.anchorY.get=function(){return this._structArray.int16[this._pos2+1]},i.rightJustifiedTextSymbolIndex.get=function(){return this._structArray.int16[this._pos2+2]},i.centerJustifiedTextSymbolIndex.get=function(){return this._structArray.int16[this._pos2+3]},i.leftJustifiedTextSymbolIndex.get=function(){return this._structArray.int16[this._pos2+4]},i.verticalPlacedTextSymbolIndex.get=function(){return this._structArray.int16[this._pos2+5]},i.placedIconSymbolIndex.get=function(){return this._structArray.int16[this._pos2+6]},i.verticalPlacedIconSymbolIndex.get=function(){return this._structArray.int16[this._pos2+7]},i.key.get=function(){return this._structArray.uint16[this._pos2+8]},i.textBoxStartIndex.get=function(){return this._structArray.uint16[this._pos2+9]},i.textBoxEndIndex.get=function(){return this._structArray.uint16[this._pos2+10]},i.verticalTextBoxStartIndex.get=function(){return this._structArray.uint16[this._pos2+11]},i.verticalTextBoxEndIndex.get=function(){return this._structArray.uint16[this._pos2+12]},i.iconBoxStartIndex.get=function(){return this._structArray.uint16[this._pos2+13]},i.iconBoxEndIndex.get=function(){return this._structArray.uint16[this._pos2+14]},i.verticalIconBoxStartIndex.get=function(){return this._structArray.uint16[this._pos2+15]},i.verticalIconBoxEndIndex.get=function(){return this._structArray.uint16[this._pos2+16]},i.featureIndex.get=function(){return this._structArray.uint16[this._pos2+17]},i.numHorizontalGlyphVertices.get=function(){return this._structArray.uint16[this._pos2+18]},i.numVerticalGlyphVertices.get=function(){return this._structArray.uint16[this._pos2+19]},i.numIconVertices.get=function(){return this._structArray.uint16[this._pos2+20]},i.numVerticalIconVertices.get=function(){return this._structArray.uint16[this._pos2+21]},i.useRuntimeCollisionCircles.get=function(){return this._structArray.uint16[this._pos2+22]},i.crossTileID.get=function(){return this._structArray.uint32[this._pos4+12]},i.crossTileID.set=function(u){this._structArray.uint32[this._pos4+12]=u},i.textBoxScale.get=function(){return this._structArray.float32[this._pos4+13]},i.textOffset0.get=function(){return this._structArray.float32[this._pos4+14]},i.textOffset1.get=function(){return this._structArray.float32[this._pos4+15]},i.collisionCircleDiameter.get=function(){return this._structArray.float32[this._pos4+16]},Object.defineProperties(t.prototype,i),t}($s);_.prototype.size=68;var w=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.get=function(i){return new _(this,i)},t}(tl);mt("SymbolInstanceArray",w);var S=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.getoffsetX=function(i){return this.float32[1*i+0]},t}(Ja);mt("GlyphOffsetArray",S);var I=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.getx=function(i){return this.int16[3*i+0]},t.prototype.gety=function(i){return this.int16[3*i+1]},t.prototype.gettileUnitDistanceFromAnchor=function(i){return this.int16[3*i+2]},t}(aa);mt("SymbolLineVertexArray",I);var P=function(e){function t(){e.apply(this,arguments)}e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t;var i={featureIndex:{configurable:!0},sourceLayerIndex:{configurable:!0},bucketIndex:{configurable:!0}};return i.featureIndex.get=function(){return this._structArray.uint32[this._pos4+0]},i.sourceLayerIndex.get=function(){return this._structArray.uint16[this._pos2+2]},i.bucketIndex.get=function(){return this._structArray.uint16[this._pos2+3]},Object.defineProperties(t.prototype,i),t}($s);P.prototype.size=8;var O=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.get=function(i){return new P(this,i)},t}(su);mt("FeatureIndexArray",O);var G=Ki([{name:"a_pos",components:2,type:"Int16"}],4).members,Z=function(e){e===void 0&&(e=[]),this.segments=e};function H(e,t){return 256*(e=he(Math.floor(e),0,255))+he(Math.floor(t),0,255)}Z.prototype.prepareSegment=function(e,t,i,u){var f=this.segments[this.segments.length-1];return e>Z.MAX_VERTEX_ARRAY_LENGTH&&je("Max vertices per segment is "+Z.MAX_VERTEX_ARRAY_LENGTH+": bucket requested "+e),(!f||f.vertexLength+e>Z.MAX_VERTEX_ARRAY_LENGTH||f.sortKey!==u)&&(f={vertexOffset:t.length,primitiveOffset:i.length,vertexLength:0,primitiveLength:0},u!==void 0&&(f.sortKey=u),this.segments.push(f)),f},Z.prototype.get=function(){return this.segments},Z.prototype.destroy=function(){for(var e=0,t=this.segments;e<t.length;e+=1){var i=t[e];for(var u in i.vaos)i.vaos[u].destroy()}},Z.simpleSegment=function(e,t,i,u){return new Z([{vertexOffset:e,primitiveOffset:t,vertexLength:i,primitiveLength:u,vaos:{},sortKey:0}])},Z.MAX_VERTEX_ARRAY_LENGTH=Math.pow(2,16)-1,mt("SegmentVector",Z);var te=Ki([{name:"a_pattern_from",components:4,type:"Uint16"},{name:"a_pattern_to",components:4,type:"Uint16"},{name:"a_pixel_ratio_from",components:1,type:"Uint16"},{name:"a_pixel_ratio_to",components:1,type:"Uint16"}]),ee=E(function(e){e.exports=function(t,i){var u,f,m,x,k,A,z,D;for(f=t.length-(u=3&t.length),m=i,k=3432918353,A=461845907,D=0;D<f;)z=255&t.charCodeAt(D)|(255&t.charCodeAt(++D))<<8|(255&t.charCodeAt(++D))<<16|(255&t.charCodeAt(++D))<<24,++D,m=27492+(65535&(x=5*(65535&(m=(m^=z=(65535&(z=(z=(65535&z)*k+(((z>>>16)*k&65535)<<16)&4294967295)<<15|z>>>17))*A+(((z>>>16)*A&65535)<<16)&4294967295)<<13|m>>>19))+((5*(m>>>16)&65535)<<16)&4294967295))+((58964+(x>>>16)&65535)<<16);switch(z=0,u){case 3:z^=(255&t.charCodeAt(D+2))<<16;case 2:z^=(255&t.charCodeAt(D+1))<<8;case 1:m^=z=(65535&(z=(z=(65535&(z^=255&t.charCodeAt(D)))*k+(((z>>>16)*k&65535)<<16)&4294967295)<<15|z>>>17))*A+(((z>>>16)*A&65535)<<16)&4294967295}return m^=t.length,m=2246822507*(65535&(m^=m>>>16))+((2246822507*(m>>>16)&65535)<<16)&4294967295,m=3266489909*(65535&(m^=m>>>13))+((3266489909*(m>>>16)&65535)<<16)&4294967295,(m^=m>>>16)>>>0}}),ce=E(function(e){e.exports=function(t,i){for(var u,f=t.length,m=i^f,x=0;f>=4;)u=1540483477*(65535&(u=255&t.charCodeAt(x)|(255&t.charCodeAt(++x))<<8|(255&t.charCodeAt(++x))<<16|(255&t.charCodeAt(++x))<<24))+((1540483477*(u>>>16)&65535)<<16),m=1540483477*(65535&m)+((1540483477*(m>>>16)&65535)<<16)^(u=1540483477*(65535&(u^=u>>>24))+((1540483477*(u>>>16)&65535)<<16)),f-=4,++x;switch(f){case 3:m^=(255&t.charCodeAt(x+2))<<16;case 2:m^=(255&t.charCodeAt(x+1))<<8;case 1:m=1540483477*(65535&(m^=255&t.charCodeAt(x)))+((1540483477*(m>>>16)&65535)<<16)}return m=1540483477*(65535&(m^=m>>>13))+((1540483477*(m>>>16)&65535)<<16),(m^=m>>>15)>>>0}}),Y=ee,ue=ce;Y.murmur3=ee,Y.murmur2=ue;var de=function(){this.ids=[],this.positions=[],this.indexed=!1};de.prototype.add=function(e,t,i,u){this.ids.push(Ae(e)),this.positions.push(t,i,u)},de.prototype.getPositions=function(e){for(var t=Ae(e),i=0,u=this.ids.length-1;i<u;){var f=i+u>>1;this.ids[f]>=t?u=f:i=f+1}for(var m=[];this.ids[i]===t;)m.push({index:this.positions[3*i],start:this.positions[3*i+1],end:this.positions[3*i+2]}),i++;return m},de.serialize=function(e,t){var i=new Float64Array(e.ids),u=new Uint32Array(e.positions);return function f(m,x,k,A){for(;k<A;){for(var z=m[k+A>>1],D=k-1,B=A+1;;){do D++;while(m[D]<z);do B--;while(m[B]>z);if(D>=B)break;Ee(m,D,B),Ee(x,3*D,3*B),Ee(x,3*D+1,3*B+1),Ee(x,3*D+2,3*B+2)}B-k<A-B?(f(m,x,k,B),k=B+1):(f(m,x,B+1,A),A=B)}}(i,u,0,i.length-1),t&&t.push(i.buffer,u.buffer),{ids:i,positions:u}},de.deserialize=function(e){var t=new de;return t.ids=e.ids,t.positions=e.positions,t.indexed=!0,t};var be=Math.pow(2,53)-1;function Ae(e){var t=+e;return!isNaN(t)&&t<=be?t:Y(String(e))}function Ee(e,t,i){var u=e[t];e[t]=e[i],e[i]=u}mt("FeaturePositionMap",de);var ze=function(e,t){this.gl=e.gl,this.location=t},Ve=function(e){function t(i,u){e.call(this,i,u),this.current=0}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.set=function(i){this.current!==i&&(this.current=i,this.gl.uniform1i(this.location,i))},t}(ze),Qe=function(e){function t(i,u){e.call(this,i,u),this.current=0}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.set=function(i){this.current!==i&&(this.current=i,this.gl.uniform1f(this.location,i))},t}(ze),We=function(e){function t(i,u){e.call(this,i,u),this.current=[0,0]}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.set=function(i){i[0]===this.current[0]&&i[1]===this.current[1]||(this.current=i,this.gl.uniform2f(this.location,i[0],i[1]))},t}(ze),ft=function(e){function t(i,u){e.call(this,i,u),this.current=[0,0,0]}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.set=function(i){i[0]===this.current[0]&&i[1]===this.current[1]&&i[2]===this.current[2]||(this.current=i,this.gl.uniform3f(this.location,i[0],i[1],i[2]))},t}(ze),Tt=function(e){function t(i,u){e.call(this,i,u),this.current=[0,0,0,0]}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.set=function(i){i[0]===this.current[0]&&i[1]===this.current[1]&&i[2]===this.current[2]&&i[3]===this.current[3]||(this.current=i,this.gl.uniform4f(this.location,i[0],i[1],i[2],i[3]))},t}(ze),Dt=function(e){function t(i,u){e.call(this,i,u),this.current=fr.transparent}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.set=function(i){i.r===this.current.r&&i.g===this.current.g&&i.b===this.current.b&&i.a===this.current.a||(this.current=i,this.gl.uniform4f(this.location,i.r,i.g,i.b,i.a))},t}(ze),Mt=new Float32Array(16),gr=function(e){function t(i,u){e.call(this,i,u),this.current=Mt}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.set=function(i){if(i[12]!==this.current[12]||i[0]!==this.current[0])return this.current=i,void this.gl.uniformMatrix4fv(this.location,!1,i);for(var u=1;u<16;u++)if(i[u]!==this.current[u]){this.current=i,this.gl.uniformMatrix4fv(this.location,!1,i);break}},t}(ze);function dt(e){return[H(255*e.r,255*e.g),H(255*e.b,255*e.a)]}var qt=function(e,t,i){this.value=e,this.uniformNames=t.map(function(u){return"u_"+u}),this.type=i};qt.prototype.setUniform=function(e,t,i){e.set(i.constantOr(this.value))},qt.prototype.getBinding=function(e,t,i){return this.type==="color"?new Dt(e,t):new Qe(e,t)};var Jt=function(e,t){this.uniformNames=t.map(function(i){return"u_"+i}),this.patternFrom=null,this.patternTo=null,this.pixelRatioFrom=1,this.pixelRatioTo=1};Jt.prototype.setConstantPatternPositions=function(e,t){this.pixelRatioFrom=t.pixelRatio,this.pixelRatioTo=e.pixelRatio,this.patternFrom=t.tlbr,this.patternTo=e.tlbr},Jt.prototype.setUniform=function(e,t,i,u){var f=u==="u_pattern_to"?this.patternTo:u==="u_pattern_from"?this.patternFrom:u==="u_pixel_ratio_to"?this.pixelRatioTo:u==="u_pixel_ratio_from"?this.pixelRatioFrom:null;f&&e.set(f)},Jt.prototype.getBinding=function(e,t,i){return i.substr(0,9)==="u_pattern"?new Tt(e,t):new Qe(e,t)};var Vt=function(e,t,i,u){this.expression=e,this.type=i,this.maxValue=0,this.paintVertexAttributes=t.map(function(f){return{name:"a_"+f,type:"Float32",components:i==="color"?2:1,offset:0}}),this.paintVertexArray=new u};Vt.prototype.populatePaintArray=function(e,t,i,u,f){var m=this.paintVertexArray.length,x=this.expression.evaluate(new lr(0),t,{},u,[],f);this.paintVertexArray.resize(e),this._setPaintValue(m,e,x)},Vt.prototype.updatePaintArray=function(e,t,i,u){var f=this.expression.evaluate({zoom:0},i,u);this._setPaintValue(e,t,f)},Vt.prototype._setPaintValue=function(e,t,i){if(this.type==="color")for(var u=dt(i),f=e;f<t;f++)this.paintVertexArray.emplace(f,u[0],u[1]);else{for(var m=e;m<t;m++)this.paintVertexArray.emplace(m,i);this.maxValue=Math.max(this.maxValue,Math.abs(i))}},Vt.prototype.upload=function(e){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=e.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))},Vt.prototype.destroy=function(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()};var Nt=function(e,t,i,u,f,m){this.expression=e,this.uniformNames=t.map(function(x){return"u_"+x+"_t"}),this.type=i,this.useIntegerZoom=u,this.zoom=f,this.maxValue=0,this.paintVertexAttributes=t.map(function(x){return{name:"a_"+x,type:"Float32",components:i==="color"?4:2,offset:0}}),this.paintVertexArray=new m};Nt.prototype.populatePaintArray=function(e,t,i,u,f){var m=this.expression.evaluate(new lr(this.zoom),t,{},u,[],f),x=this.expression.evaluate(new lr(this.zoom+1),t,{},u,[],f),k=this.paintVertexArray.length;this.paintVertexArray.resize(e),this._setPaintValue(k,e,m,x)},Nt.prototype.updatePaintArray=function(e,t,i,u){var f=this.expression.evaluate({zoom:this.zoom},i,u),m=this.expression.evaluate({zoom:this.zoom+1},i,u);this._setPaintValue(e,t,f,m)},Nt.prototype._setPaintValue=function(e,t,i,u){if(this.type==="color")for(var f=dt(i),m=dt(u),x=e;x<t;x++)this.paintVertexArray.emplace(x,f[0],f[1],m[0],m[1]);else{for(var k=e;k<t;k++)this.paintVertexArray.emplace(k,i,u);this.maxValue=Math.max(this.maxValue,Math.abs(i),Math.abs(u))}},Nt.prototype.upload=function(e){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=e.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))},Nt.prototype.destroy=function(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()},Nt.prototype.setUniform=function(e,t){var i=this.useIntegerZoom?Math.floor(t.zoom):t.zoom,u=he(this.expression.interpolationFactor(i,this.zoom,this.zoom+1),0,1);e.set(u)},Nt.prototype.getBinding=function(e,t,i){return new Qe(e,t)};var Wt=function(e,t,i,u,f,m){this.expression=e,this.type=t,this.useIntegerZoom=i,this.zoom=u,this.layerId=m,this.zoomInPaintVertexArray=new f,this.zoomOutPaintVertexArray=new f};Wt.prototype.populatePaintArray=function(e,t,i){var u=this.zoomInPaintVertexArray.length;this.zoomInPaintVertexArray.resize(e),this.zoomOutPaintVertexArray.resize(e),this._setPaintValues(u,e,t.patterns&&t.patterns[this.layerId],i)},Wt.prototype.updatePaintArray=function(e,t,i,u,f){this._setPaintValues(e,t,i.patterns&&i.patterns[this.layerId],f)},Wt.prototype._setPaintValues=function(e,t,i,u){if(u&&i){var f=u[i.min],m=u[i.mid],x=u[i.max];if(f&&m&&x)for(var k=e;k<t;k++)this.zoomInPaintVertexArray.emplace(k,m.tl[0],m.tl[1],m.br[0],m.br[1],f.tl[0],f.tl[1],f.br[0],f.br[1],m.pixelRatio,f.pixelRatio),this.zoomOutPaintVertexArray.emplace(k,m.tl[0],m.tl[1],m.br[0],m.br[1],x.tl[0],x.tl[1],x.br[0],x.br[1],m.pixelRatio,x.pixelRatio)}},Wt.prototype.upload=function(e){this.zoomInPaintVertexArray&&this.zoomInPaintVertexArray.arrayBuffer&&this.zoomOutPaintVertexArray&&this.zoomOutPaintVertexArray.arrayBuffer&&(this.zoomInPaintVertexBuffer=e.createVertexBuffer(this.zoomInPaintVertexArray,te.members,this.expression.isStateDependent),this.zoomOutPaintVertexBuffer=e.createVertexBuffer(this.zoomOutPaintVertexArray,te.members,this.expression.isStateDependent))},Wt.prototype.destroy=function(){this.zoomOutPaintVertexBuffer&&this.zoomOutPaintVertexBuffer.destroy(),this.zoomInPaintVertexBuffer&&this.zoomInPaintVertexBuffer.destroy()};var Ot=function(e,t,i){this.binders={},this._buffers=[];var u=[];for(var f in e.paint._values)if(i(f)){var m=e.paint.get(f);if(m instanceof gn&&bo(m.property.specification)){var x=Oi(f,e.type),k=m.value,A=m.property.specification.type,z=m.property.useIntegerZoom,D=m.property.specification["property-type"],B=D==="cross-faded"||D==="cross-faded-data-driven";if(k.kind==="constant")this.binders[f]=B?new Jt(k.value,x):new qt(k.value,x,A),u.push("/u_"+f);else if(k.kind==="source"||B){var V=si(f,A,"source");this.binders[f]=B?new Wt(k,A,z,t,V,e.id):new Vt(k,x,A,V),u.push("/a_"+f)}else{var j=si(f,A,"composite");this.binders[f]=new Nt(k,x,A,z,t,j),u.push("/z_"+f)}}}this.cacheKey=u.sort().join("")};Ot.prototype.getMaxValue=function(e){var t=this.binders[e];return t instanceof Vt||t instanceof Nt?t.maxValue:0},Ot.prototype.populatePaintArrays=function(e,t,i,u,f){for(var m in this.binders){var x=this.binders[m];(x instanceof Vt||x instanceof Nt||x instanceof Wt)&&x.populatePaintArray(e,t,i,u,f)}},Ot.prototype.setConstantPatternPositions=function(e,t){for(var i in this.binders){var u=this.binders[i];u instanceof Jt&&u.setConstantPatternPositions(e,t)}},Ot.prototype.updatePaintArrays=function(e,t,i,u,f){var m=!1;for(var x in e)for(var k=0,A=t.getPositions(x);k<A.length;k+=1){var z=A[k],D=i.feature(z.index);for(var B in this.binders){var V=this.binders[B];if((V instanceof Vt||V instanceof Nt||V instanceof Wt)&&V.expression.isStateDependent===!0){var j=u.paint.get(B);V.expression=j.value,V.updatePaintArray(z.start,z.end,D,e[x],f),m=!0}}}return m},Ot.prototype.defines=function(){var e=[];for(var t in this.binders){var i=this.binders[t];(i instanceof qt||i instanceof Jt)&&e.push.apply(e,i.uniformNames.map(function(u){return"#define HAS_UNIFORM_"+u}))}return e},Ot.prototype.getBinderAttributes=function(){var e=[];for(var t in this.binders){var i=this.binders[t];if(i instanceof Vt||i instanceof Nt)for(var u=0;u<i.paintVertexAttributes.length;u++)e.push(i.paintVertexAttributes[u].name);else if(i instanceof Wt)for(var f=0;f<te.members.length;f++)e.push(te.members[f].name)}return e},Ot.prototype.getBinderUniforms=function(){var e=[];for(var t in this.binders){var i=this.binders[t];if(i instanceof qt||i instanceof Jt||i instanceof Nt)for(var u=0,f=i.uniformNames;u<f.length;u+=1)e.push(f[u])}return e},Ot.prototype.getPaintVertexBuffers=function(){return this._buffers},Ot.prototype.getUniforms=function(e,t){var i=[];for(var u in this.binders){var f=this.binders[u];if(f instanceof qt||f instanceof Jt||f instanceof Nt)for(var m=0,x=f.uniformNames;m<x.length;m+=1){var k=x[m];if(t[k]){var A=f.getBinding(e,t[k],k);i.push({name:k,property:u,binding:A})}}}return i},Ot.prototype.setUniforms=function(e,t,i,u){for(var f=0,m=t;f<m.length;f+=1){var x=m[f],k=x.name,A=x.property;this.binders[A].setUniform(x.binding,u,i.get(A),k)}},Ot.prototype.updatePaintBuffers=function(e){for(var t in this._buffers=[],this.binders){var i=this.binders[t];if(e&&i instanceof Wt){var u=e.fromScale===2?i.zoomInPaintVertexBuffer:i.zoomOutPaintVertexBuffer;u&&this._buffers.push(u)}else(i instanceof Vt||i instanceof Nt)&&i.paintVertexBuffer&&this._buffers.push(i.paintVertexBuffer)}},Ot.prototype.upload=function(e){for(var t in this.binders){var i=this.binders[t];(i instanceof Vt||i instanceof Nt||i instanceof Wt)&&i.upload(e)}this.updatePaintBuffers()},Ot.prototype.destroy=function(){for(var e in this.binders){var t=this.binders[e];(t instanceof Vt||t instanceof Nt||t instanceof Wt)&&t.destroy()}};var Rt=function(e,t,i){i===void 0&&(i=function(){return!0}),this.programConfigurations={};for(var u=0,f=e;u<f.length;u+=1){var m=f[u];this.programConfigurations[m.id]=new Ot(m,t,i)}this.needsUpload=!1,this._featureMap=new de,this._bufferOffset=0};function Oi(e,t){return{"text-opacity":["opacity"],"icon-opacity":["opacity"],"text-color":["fill_color"],"icon-color":["fill_color"],"text-halo-color":["halo_color"],"icon-halo-color":["halo_color"],"text-halo-blur":["halo_blur"],"icon-halo-blur":["halo_blur"],"text-halo-width":["halo_width"],"icon-halo-width":["halo_width"],"line-gap-width":["gapwidth"],"line-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-extrusion-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"]}[e]||[e.replace(t+"-","").replace(/-/g,"_")]}function si(e,t,i){var u={color:{source:Go,composite:rl},number:{source:Ja,composite:Go}},f=function(m){return{"line-pattern":{source:Ia,composite:Ia},"fill-pattern":{source:Ia,composite:Ia},"fill-extrusion-pattern":{source:Ia,composite:Ia}}[m]}(e);return f&&f[i]||u[t][i]}Rt.prototype.populatePaintArrays=function(e,t,i,u,f,m){for(var x in this.programConfigurations)this.programConfigurations[x].populatePaintArrays(e,t,u,f,m);t.id!==void 0&&this._featureMap.add(t.id,i,this._bufferOffset,e),this._bufferOffset=e,this.needsUpload=!0},Rt.prototype.updatePaintArrays=function(e,t,i,u){for(var f=0,m=i;f<m.length;f+=1){var x=m[f];this.needsUpload=this.programConfigurations[x.id].updatePaintArrays(e,this._featureMap,t,x,u)||this.needsUpload}},Rt.prototype.get=function(e){return this.programConfigurations[e]},Rt.prototype.upload=function(e){if(this.needsUpload){for(var t in this.programConfigurations)this.programConfigurations[t].upload(e);this.needsUpload=!1}},Rt.prototype.destroy=function(){for(var e in this.programConfigurations)this.programConfigurations[e].destroy()},mt("ConstantBinder",qt),mt("CrossFadedConstantBinder",Jt),mt("SourceExpressionBinder",Vt),mt("CrossFadedCompositeBinder",Wt),mt("CompositeExpressionBinder",Nt),mt("ProgramConfiguration",Ot,{omit:["_buffers"]}),mt("ProgramConfigurationSet",Rt);var pn=Math.pow(2,14)-1,Hi=-pn-1;function ri(e){for(var t=8192/e.extent,i=e.loadGeometry(),u=0;u<i.length;u++)for(var f=i[u],m=0;m<f.length;m++){var x=f[m],k=Math.round(x.x*t),A=Math.round(x.y*t);x.x=he(k,Hi,pn),x.y=he(A,Hi,pn),(k<x.x||k>x.x+1||A<x.y||A>x.y+1)&&je("Geometry exceeds allowed extent, reduce your vector tile buffer size")}return i}function di(e,t){return{type:e.type,id:e.id,properties:e.properties,geometry:t?ri(e):[]}}function Zn(e,t,i,u,f){e.emplaceBack(2*t+(u+1)/2,2*i+(f+1)/2)}var vn=function(e){this.zoom=e.zoom,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map(function(t){return t.id}),this.index=e.index,this.hasPattern=!1,this.layoutVertexArray=new Eo,this.indexArray=new Wa,this.segments=new Z,this.programConfigurations=new Rt(e.layers,e.zoom),this.stateDependentLayerIds=this.layers.filter(function(t){return t.isStateDependent()}).map(function(t){return t.id})};function Qa(e,t){for(var i=0;i<e.length;i++)if(Aa(t,e[i]))return!0;for(var u=0;u<t.length;u++)if(Aa(e,t[u]))return!0;return!!ws(e,t)}function Cn(e,t,i){return!!Aa(e,t)||!!$a(t,e,i)}function _a(e,t){if(e.length===1)return Ss(t,e[0]);for(var i=0;i<t.length;i++)for(var u=t[i],f=0;f<u.length;f++)if(Aa(e,u[f]))return!0;for(var m=0;m<e.length;m++)if(Ss(t,e[m]))return!0;for(var x=0;x<t.length;x++)if(ws(e,t[x]))return!0;return!1}function oa(e,t,i){if(e.length>1){if(ws(e,t))return!0;for(var u=0;u<t.length;u++)if($a(t[u],e,i))return!0}for(var f=0;f<e.length;f++)if($a(e[f],t,i))return!0;return!1}function ws(e,t){if(e.length===0||t.length===0)return!1;for(var i=0;i<e.length-1;i++)for(var u=e[i],f=e[i+1],m=0;m<t.length-1;m++)if(Ho(u,f,t[m],t[m+1]))return!0;return!1}function Ho(e,t,i,u){return Ft(e,i,u)!==Ft(t,i,u)&&Ft(e,t,i)!==Ft(e,t,u)}function $a(e,t,i){var u=i*i;if(t.length===1)return e.distSqr(t[0])<u;for(var f=1;f<t.length;f++)if(Xo(e,t[f-1],t[f])<u)return!0;return!1}function Xo(e,t,i){var u=t.distSqr(i);if(u===0)return e.distSqr(t);var f=((e.x-t.x)*(i.x-t.x)+(e.y-t.y)*(i.y-t.y))/u;return e.distSqr(f<0?t:f>1?i:i.sub(t)._mult(f)._add(t))}function Ss(e,t){for(var i,u,f,m=!1,x=0;x<e.length;x++)for(var k=0,A=(i=e[x]).length-1;k<i.length;A=k++)(u=i[k]).y>t.y!=(f=i[A]).y>t.y&&t.x<(f.x-u.x)*(t.y-u.y)/(f.y-u.y)+u.x&&(m=!m);return m}function Aa(e,t){for(var i=!1,u=0,f=e.length-1;u<e.length;f=u++){var m=e[u],x=e[f];m.y>t.y!=x.y>t.y&&t.x<(x.x-m.x)*(t.y-m.y)/(x.y-m.y)+m.x&&(i=!i)}return i}function ks(e,t,i){var u=i[0],f=i[2];if(e.x<u.x&&t.x<u.x||e.x>f.x&&t.x>f.x||e.y<u.y&&t.y<u.y||e.y>f.y&&t.y>f.y)return!1;var m=Ft(e,t,i[0]);return m!==Ft(e,t,i[1])||m!==Ft(e,t,i[2])||m!==Ft(e,t,i[3])}function za(e,t,i){var u=t.paint.get(e).value;return u.kind==="constant"?u.value:i.programConfigurations.get(t.id).getMaxValue(e)}function Fi(e){return Math.sqrt(e[0]*e[0]+e[1]*e[1])}function La(e,t,i,u,f){if(!t[0]&&!t[1])return e;var m=F.convert(t)._mult(f);i==="viewport"&&m._rotate(-u);for(var x=[],k=0;k<e.length;k++)x.push(e[k].sub(m));return x}vn.prototype.populate=function(e,t,i){var u=this.layers[0],f=[],m=null;u.type==="circle"&&(m=u.layout.get("circle-sort-key"));for(var x=0,k=e;x<k.length;x+=1){var A=k[x],z=A.feature,D=A.id,B=A.index,V=A.sourceLayerIndex,j=this.layers[0]._featureFilter.needGeometry,Q=di(z,j);if(this.layers[0]._featureFilter.filter(new lr(this.zoom),Q,i)){var $=m?m.evaluate(Q,{},i):void 0,pe={id:D,properties:z.properties,type:z.type,sourceLayerIndex:V,index:B,geometry:j?Q.geometry:ri(z),patterns:{},sortKey:$};f.push(pe)}}m&&f.sort(function(rt,wt){return rt.sortKey-wt.sortKey});for(var oe=0,ye=f;oe<ye.length;oe+=1){var xe=ye[oe],Se=xe.geometry,Te=xe.index,Me=xe.sourceLayerIndex,Xe=e[Te].feature;this.addFeature(xe,Se,Te,i),t.featureIndex.insert(Xe,Se,Te,Me,this.index)}},vn.prototype.update=function(e,t,i){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(e,t,this.stateDependentLayers,i)},vn.prototype.isEmpty=function(){return this.layoutVertexArray.length===0},vn.prototype.uploadPending=function(){return!this.uploaded||this.programConfigurations.needsUpload},vn.prototype.upload=function(e){this.uploaded||(this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,G),this.indexBuffer=e.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(e),this.uploaded=!0},vn.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())},vn.prototype.addFeature=function(e,t,i,u){for(var f=0,m=t;f<m.length;f+=1)for(var x=0,k=m[f];x<k.length;x+=1){var A=k[x],z=A.x,D=A.y;if(!(z<0||z>=8192||D<0||D>=8192)){var B=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray,e.sortKey),V=B.vertexLength;Zn(this.layoutVertexArray,z,D,-1,-1),Zn(this.layoutVertexArray,z,D,1,-1),Zn(this.layoutVertexArray,z,D,1,1),Zn(this.layoutVertexArray,z,D,-1,1),this.indexArray.emplaceBack(V,V+1,V+2),this.indexArray.emplaceBack(V,V+3,V+2),B.vertexLength+=4,B.primitiveLength+=2}}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,e,i,{},u)},mt("CircleBucket",vn,{omit:["layers"]});var eo=new nn({"circle-sort-key":new _t(U.layout_circle["circle-sort-key"])}),Io={paint:new nn({"circle-radius":new _t(U.paint_circle["circle-radius"]),"circle-color":new _t(U.paint_circle["circle-color"]),"circle-blur":new _t(U.paint_circle["circle-blur"]),"circle-opacity":new _t(U.paint_circle["circle-opacity"]),"circle-translate":new Et(U.paint_circle["circle-translate"]),"circle-translate-anchor":new Et(U.paint_circle["circle-translate-anchor"]),"circle-pitch-scale":new Et(U.paint_circle["circle-pitch-scale"]),"circle-pitch-alignment":new Et(U.paint_circle["circle-pitch-alignment"]),"circle-stroke-width":new _t(U.paint_circle["circle-stroke-width"]),"circle-stroke-color":new _t(U.paint_circle["circle-stroke-color"]),"circle-stroke-opacity":new _t(U.paint_circle["circle-stroke-opacity"])}),layout:eo},kr=typeof Float32Array<"u"?Float32Array:Array;function ea(e){return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}function Mn(e,t,i){var u=t[0],f=t[1],m=t[2],x=t[3],k=t[4],A=t[5],z=t[6],D=t[7],B=t[8],V=t[9],j=t[10],Q=t[11],$=t[12],pe=t[13],oe=t[14],ye=t[15],xe=i[0],Se=i[1],Te=i[2],Me=i[3];return e[0]=xe*u+Se*k+Te*B+Me*$,e[1]=xe*f+Se*A+Te*V+Me*pe,e[2]=xe*m+Se*z+Te*j+Me*oe,e[3]=xe*x+Se*D+Te*Q+Me*ye,e[4]=(xe=i[4])*u+(Se=i[5])*k+(Te=i[6])*B+(Me=i[7])*$,e[5]=xe*f+Se*A+Te*V+Me*pe,e[6]=xe*m+Se*z+Te*j+Me*oe,e[7]=xe*x+Se*D+Te*Q+Me*ye,e[8]=(xe=i[8])*u+(Se=i[9])*k+(Te=i[10])*B+(Me=i[11])*$,e[9]=xe*f+Se*A+Te*V+Me*pe,e[10]=xe*m+Se*z+Te*j+Me*oe,e[11]=xe*x+Se*D+Te*Q+Me*ye,e[12]=(xe=i[12])*u+(Se=i[13])*k+(Te=i[14])*B+(Me=i[15])*$,e[13]=xe*f+Se*A+Te*V+Me*pe,e[14]=xe*m+Se*z+Te*j+Me*oe,e[15]=xe*x+Se*D+Te*Q+Me*ye,e}Math.hypot||(Math.hypot=function(){for(var e=arguments,t=0,i=arguments.length;i--;)t+=e[i]*e[i];return Math.sqrt(t)});var Ao,Xh=Mn;function il(e,t,i){var u=t[0],f=t[1],m=t[2],x=t[3];return e[0]=i[0]*u+i[4]*f+i[8]*m+i[12]*x,e[1]=i[1]*u+i[5]*f+i[9]*m+i[13]*x,e[2]=i[2]*u+i[6]*f+i[10]*m+i[14]*x,e[3]=i[3]*u+i[7]*f+i[11]*m+i[15]*x,e}Ao=new kr(3),kr!=Float32Array&&(Ao[0]=0,Ao[1]=0,Ao[2]=0),function(){var e=new kr(4);kr!=Float32Array&&(e[0]=0,e[1]=0,e[2]=0,e[3]=0)}();var Wh=(function(){var e=new kr(2);kr!=Float32Array&&(e[0]=0,e[1]=0)}(),function(e){function t(i){e.call(this,i,Io)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.createBucket=function(i){return new vn(i)},t.prototype.queryRadius=function(i){var u=i;return za("circle-radius",this,u)+za("circle-stroke-width",this,u)+Fi(this.paint.get("circle-translate"))},t.prototype.queryIntersectsFeature=function(i,u,f,m,x,k,A,z){for(var D=La(i,this.paint.get("circle-translate"),this.paint.get("circle-translate-anchor"),k.angle,A),B=this.paint.get("circle-radius").evaluate(u,f)+this.paint.get("circle-stroke-width").evaluate(u,f),V=this.paint.get("circle-pitch-alignment")==="map",j=V?D:function(Xe,rt){return Xe.map(function(wt){return Es(wt,rt)})}(D,z),Q=V?B*A:B,$=0,pe=m;$<pe.length;$+=1)for(var oe=0,ye=pe[$];oe<ye.length;oe+=1){var xe=ye[oe],Se=V?xe:Es(xe,z),Te=Q,Me=il([],[xe.x,xe.y,0,1],z);if(this.paint.get("circle-pitch-scale")==="viewport"&&this.paint.get("circle-pitch-alignment")==="map"?Te*=Me[3]/k.cameraToCenterDistance:this.paint.get("circle-pitch-scale")==="map"&&this.paint.get("circle-pitch-alignment")==="viewport"&&(Te*=k.cameraToCenterDistance/Me[3]),Cn(j,Se,Te))return!0}return!1},t}(Ta));function Es(e,t){var i=il([],[e.x,e.y,0,1],t);return new F(i[0]/i[3],i[1]/i[3])}var Ic=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t}(vn);function Wo(e,t,i,u){var f=t.width,m=t.height;if(u){if(u instanceof Uint8ClampedArray)u=new Uint8Array(u.buffer);else if(u.length!==f*m*i)throw new RangeError("mismatched image size")}else u=new Uint8Array(f*m*i);return e.width=f,e.height=m,e.data=u,e}function nl(e,t,i){var u=t.width,f=t.height;if(u!==e.width||f!==e.height){var m=Wo({},{width:u,height:f},i);Yh(e,m,{x:0,y:0},{x:0,y:0},{width:Math.min(e.width,u),height:Math.min(e.height,f)},i),e.width=u,e.height=f,e.data=m.data}}function Yh(e,t,i,u,f,m){if(f.width===0||f.height===0)return t;if(f.width>e.width||f.height>e.height||i.x>e.width-f.width||i.y>e.height-f.height)throw new RangeError("out of range source coordinates for image copy");if(f.width>t.width||f.height>t.height||u.x>t.width-f.width||u.y>t.height-f.height)throw new RangeError("out of range destination coordinates for image copy");for(var x=e.data,k=t.data,A=0;A<f.height;A++)for(var z=((i.y+A)*e.width+i.x)*m,D=((u.y+A)*t.width+u.x)*m,B=0;B<f.width*m;B++)k[D+B]=x[z+B];return t}mt("HeatmapBucket",Ic,{omit:["layers"]});var Ts=function(e,t){Wo(this,e,1,t)};Ts.prototype.resize=function(e){nl(this,e,1)},Ts.prototype.clone=function(){return new Ts({width:this.width,height:this.height},new Uint8Array(this.data))},Ts.copy=function(e,t,i,u,f){Yh(e,t,i,u,f,1)};var Kn=function(e,t){Wo(this,e,4,t)};Kn.prototype.resize=function(e){nl(this,e,4)},Kn.prototype.replace=function(e,t){t?this.data.set(e):this.data=e instanceof Uint8ClampedArray?new Uint8Array(e.buffer):e},Kn.prototype.clone=function(){return new Kn({width:this.width,height:this.height},new Uint8Array(this.data))},Kn.copy=function(e,t,i,u,f){Yh(e,t,i,u,f,4)},mt("AlphaImage",Ts),mt("RGBAImage",Kn);var Iy={paint:new nn({"heatmap-radius":new _t(U.paint_heatmap["heatmap-radius"]),"heatmap-weight":new _t(U.paint_heatmap["heatmap-weight"]),"heatmap-intensity":new Et(U.paint_heatmap["heatmap-intensity"]),"heatmap-color":new ga(U.paint_heatmap["heatmap-color"]),"heatmap-opacity":new Et(U.paint_heatmap["heatmap-opacity"])})};function Jp(e){var t={},i=e.resolution||256,u=e.clips?e.clips.length:1,f=e.image||new Kn({width:i,height:u}),m=function(Q,$,pe){t[e.evaluationKey]=pe;var oe=e.expression.evaluate(t);f.data[Q+$+0]=Math.floor(255*oe.r/oe.a),f.data[Q+$+1]=Math.floor(255*oe.g/oe.a),f.data[Q+$+2]=Math.floor(255*oe.b/oe.a),f.data[Q+$+3]=Math.floor(255*oe.a)};if(e.clips)for(var x=0,k=0;x<u;++x,k+=4*i)for(var A=0,z=0;A<i;A++,z+=4){var D=A/(i-1),B=e.clips[x];m(k,z,B.start*(1-D)+B.end*D)}else for(var V=0,j=0;V<i;V++,j+=4)m(0,j,V/(i-1));return f}var Ay=function(e){function t(i){e.call(this,i,Iy),this._updateColorRamp()}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.createBucket=function(i){return new Ic(i)},t.prototype._handleSpecialPaintPropertyUpdate=function(i){i==="heatmap-color"&&this._updateColorRamp()},t.prototype._updateColorRamp=function(){this.colorRamp=Jp({expression:this._transitionablePaint._values["heatmap-color"].value.expression,evaluationKey:"heatmapDensity",image:this.colorRamp}),this.colorRampTexture=null},t.prototype.resize=function(){this.heatmapFbo&&(this.heatmapFbo.destroy(),this.heatmapFbo=null)},t.prototype.queryRadius=function(){return 0},t.prototype.queryIntersectsFeature=function(){return!1},t.prototype.hasOffscreenPass=function(){return this.paint.get("heatmap-opacity")!==0&&this.visibility!=="none"},t}(Ta),zy={paint:new nn({"hillshade-illumination-direction":new Et(U.paint_hillshade["hillshade-illumination-direction"]),"hillshade-illumination-anchor":new Et(U.paint_hillshade["hillshade-illumination-anchor"]),"hillshade-exaggeration":new Et(U.paint_hillshade["hillshade-exaggeration"]),"hillshade-shadow-color":new Et(U.paint_hillshade["hillshade-shadow-color"]),"hillshade-highlight-color":new Et(U.paint_hillshade["hillshade-highlight-color"]),"hillshade-accent-color":new Et(U.paint_hillshade["hillshade-accent-color"])})},Py=function(e){function t(i){e.call(this,i,zy)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.hasOffscreenPass=function(){return this.paint.get("hillshade-exaggeration")!==0&&this.visibility!=="none"},t}(Ta),Cy=Ki([{name:"a_pos",components:2,type:"Int16"}],4).members,Jh=Ac,My=Ac;function Ac(e,t,i){i=i||2;var u,f,m,x,k,A,z,D=t&&t.length,B=D?t[0]*i:e.length,V=Qp(e,0,B,i,!0),j=[];if(!V||V.next===V.prev)return j;if(D&&(V=function($,pe,oe,ye){var xe,Se,Te,Me=[];for(xe=0,Se=pe.length;xe<Se;xe++)(Te=Qp($,pe[xe]*ye,xe<Se-1?pe[xe+1]*ye:$.length,ye,!1))===Te.next&&(Te.steiner=!0),Me.push(Vy(Te));for(Me.sort(Oy),xe=0;xe<Me.length;xe++)Fy(Me[xe],oe),oe=Yo(oe,oe.next);return oe}(e,t,V,i)),e.length>80*i){u=m=e[0],f=x=e[1];for(var Q=i;Q<B;Q+=i)(k=e[Q])<u&&(u=k),(A=e[Q+1])<f&&(f=A),k>m&&(m=k),A>x&&(x=A);z=(z=Math.max(m-u,x-f))!==0?1/z:0}return uu(V,j,i,u,f,z),j}function Qp(e,t,i,u,f){var m,x;if(f===ep(e,t,i,u)>0)for(m=t;m<i;m+=u)x=tf(m,e[m],e[m+1],x);else for(m=i-u;m>=t;m-=u)x=tf(m,e[m],e[m+1],x);return x&&zc(x,x.next)&&(hu(x),x=x.next),x}function Yo(e,t){if(!e)return e;t||(t=e);var i,u=e;do if(i=!1,u.steiner||!zc(u,u.next)&&Ci(u.prev,u,u.next)!==0)u=u.next;else{if(hu(u),(u=t=u.prev)===u.next)break;i=!0}while(i||u!==t);return t}function uu(e,t,i,u,f,m,x){if(e){!x&&m&&function(D,B,V,j){var Q=D;do Q.z===null&&(Q.z=Qh(Q.x,Q.y,B,V,j)),Q.prevZ=Q.prev,Q.nextZ=Q.next,Q=Q.next;while(Q!==D);Q.prevZ.nextZ=null,Q.prevZ=null,function($){var pe,oe,ye,xe,Se,Te,Me,Xe,rt=1;do{for(oe=$,$=null,Se=null,Te=0;oe;){for(Te++,ye=oe,Me=0,pe=0;pe<rt&&(Me++,ye=ye.nextZ);pe++);for(Xe=rt;Me>0||Xe>0&&ye;)Me!==0&&(Xe===0||!ye||oe.z<=ye.z)?(xe=oe,oe=oe.nextZ,Me--):(xe=ye,ye=ye.nextZ,Xe--),Se?Se.nextZ=xe:$=xe,xe.prevZ=Se,Se=xe;oe=ye}Se.nextZ=null,rt*=2}while(Te>1)}(Q)}(e,u,f,m);for(var k,A,z=e;e.prev!==e.next;)if(k=e.prev,A=e.next,m?Ly(e,u,f,m):Dy(e))t.push(k.i/i),t.push(e.i/i),t.push(A.i/i),hu(e),e=A.next,z=A.next;else if((e=A)===z){x?x===1?uu(e=Ry(Yo(e),t,i),t,i,u,f,m,2):x===2&&By(e,t,i,u,f,m):uu(Yo(e),t,i,u,f,m,1);break}}}function Dy(e){var t=e.prev,i=e,u=e.next;if(Ci(t,i,u)>=0)return!1;for(var f=e.next.next;f!==e.prev;){if(al(t.x,t.y,i.x,i.y,u.x,u.y,f.x,f.y)&&Ci(f.prev,f,f.next)>=0)return!1;f=f.next}return!0}function Ly(e,t,i,u){var f=e.prev,m=e,x=e.next;if(Ci(f,m,x)>=0)return!1;for(var k=f.x>m.x?f.x>x.x?f.x:x.x:m.x>x.x?m.x:x.x,A=f.y>m.y?f.y>x.y?f.y:x.y:m.y>x.y?m.y:x.y,z=Qh(f.x<m.x?f.x<x.x?f.x:x.x:m.x<x.x?m.x:x.x,f.y<m.y?f.y<x.y?f.y:x.y:m.y<x.y?m.y:x.y,t,i,u),D=Qh(k,A,t,i,u),B=e.prevZ,V=e.nextZ;B&&B.z>=z&&V&&V.z<=D;){if(B!==e.prev&&B!==e.next&&al(f.x,f.y,m.x,m.y,x.x,x.y,B.x,B.y)&&Ci(B.prev,B,B.next)>=0||(B=B.prevZ,V!==e.prev&&V!==e.next&&al(f.x,f.y,m.x,m.y,x.x,x.y,V.x,V.y)&&Ci(V.prev,V,V.next)>=0))return!1;V=V.nextZ}for(;B&&B.z>=z;){if(B!==e.prev&&B!==e.next&&al(f.x,f.y,m.x,m.y,x.x,x.y,B.x,B.y)&&Ci(B.prev,B,B.next)>=0)return!1;B=B.prevZ}for(;V&&V.z<=D;){if(V!==e.prev&&V!==e.next&&al(f.x,f.y,m.x,m.y,x.x,x.y,V.x,V.y)&&Ci(V.prev,V,V.next)>=0)return!1;V=V.nextZ}return!0}function Ry(e,t,i){var u=e;do{var f=u.prev,m=u.next.next;!zc(f,m)&&$p(f,u,u.next,m)&&cu(f,m)&&cu(m,f)&&(t.push(f.i/i),t.push(u.i/i),t.push(m.i/i),hu(u),hu(u.next),u=e=m),u=u.next}while(u!==e);return Yo(u)}function By(e,t,i,u,f,m){var x=e;do{for(var k=x.next.next;k!==x.prev;){if(x.i!==k.i&&Uy(x,k)){var A=ef(x,k);return x=Yo(x,x.next),A=Yo(A,A.next),uu(x,t,i,u,f,m),void uu(A,t,i,u,f,m)}k=k.next}x=x.next}while(x!==e)}function Oy(e,t){return e.x-t.x}function Fy(e,t){if(t=function(u,f){var m,x=f,k=u.x,A=u.y,z=-1/0;do{if(A<=x.y&&A>=x.next.y&&x.next.y!==x.y){var D=x.x+(A-x.y)*(x.next.x-x.x)/(x.next.y-x.y);if(D<=k&&D>z){if(z=D,D===k){if(A===x.y)return x;if(A===x.next.y)return x.next}m=x.x<x.next.x?x:x.next}}x=x.next}while(x!==f);if(!m)return null;if(k===z)return m;var B,V=m,j=m.x,Q=m.y,$=1/0;x=m;do k>=x.x&&x.x>=j&&k!==x.x&&al(A<Q?k:z,A,j,Q,A<Q?z:k,A,x.x,x.y)&&(B=Math.abs(A-x.y)/(k-x.x),cu(x,u)&&(B<$||B===$&&(x.x>m.x||x.x===m.x&&Ny(m,x)))&&(m=x,$=B)),x=x.next;while(x!==V);return m}(e,t)){var i=ef(t,e);Yo(t,t.next),Yo(i,i.next)}}function Ny(e,t){return Ci(e.prev,e,t.prev)<0&&Ci(t.next,e,e.next)<0}function Qh(e,t,i,u,f){return(e=1431655765&((e=858993459&((e=252645135&((e=16711935&((e=32767*(e-i)*f)|e<<8))|e<<4))|e<<2))|e<<1))|(t=1431655765&((t=858993459&((t=252645135&((t=16711935&((t=32767*(t-u)*f)|t<<8))|t<<4))|t<<2))|t<<1))<<1}function Vy(e){var t=e,i=e;do(t.x<i.x||t.x===i.x&&t.y<i.y)&&(i=t),t=t.next;while(t!==e);return i}function al(e,t,i,u,f,m,x,k){return(f-x)*(t-k)-(e-x)*(m-k)>=0&&(e-x)*(u-k)-(i-x)*(t-k)>=0&&(i-x)*(m-k)-(f-x)*(u-k)>=0}function Uy(e,t){return e.next.i!==t.i&&e.prev.i!==t.i&&!function(i,u){var f=i;do{if(f.i!==i.i&&f.next.i!==i.i&&f.i!==u.i&&f.next.i!==u.i&&$p(f,f.next,i,u))return!0;f=f.next}while(f!==i);return!1}(e,t)&&(cu(e,t)&&cu(t,e)&&function(i,u){var f=i,m=!1,x=(i.x+u.x)/2,k=(i.y+u.y)/2;do f.y>k!=f.next.y>k&&f.next.y!==f.y&&x<(f.next.x-f.x)*(k-f.y)/(f.next.y-f.y)+f.x&&(m=!m),f=f.next;while(f!==i);return m}(e,t)&&(Ci(e.prev,e,t.prev)||Ci(e,t.prev,t))||zc(e,t)&&Ci(e.prev,e,e.next)>0&&Ci(t.prev,t,t.next)>0)}function Ci(e,t,i){return(t.y-e.y)*(i.x-t.x)-(t.x-e.x)*(i.y-t.y)}function zc(e,t){return e.x===t.x&&e.y===t.y}function $p(e,t,i,u){var f=Cc(Ci(e,t,i)),m=Cc(Ci(e,t,u)),x=Cc(Ci(i,u,e)),k=Cc(Ci(i,u,t));return f!==m&&x!==k||!(f!==0||!Pc(e,i,t))||!(m!==0||!Pc(e,u,t))||!(x!==0||!Pc(i,e,u))||!(k!==0||!Pc(i,t,u))}function Pc(e,t,i){return t.x<=Math.max(e.x,i.x)&&t.x>=Math.min(e.x,i.x)&&t.y<=Math.max(e.y,i.y)&&t.y>=Math.min(e.y,i.y)}function Cc(e){return e>0?1:e<0?-1:0}function cu(e,t){return Ci(e.prev,e,e.next)<0?Ci(e,t,e.next)>=0&&Ci(e,e.prev,t)>=0:Ci(e,t,e.prev)<0||Ci(e,e.next,t)<0}function ef(e,t){var i=new $h(e.i,e.x,e.y),u=new $h(t.i,t.x,t.y),f=e.next,m=t.prev;return e.next=t,t.prev=e,i.next=f,f.prev=i,u.next=i,i.prev=u,m.next=u,u.prev=m,u}function tf(e,t,i,u){var f=new $h(e,t,i);return u?(f.next=u.next,f.prev=u,u.next.prev=f,u.next=f):(f.prev=f,f.next=f),f}function hu(e){e.next.prev=e.prev,e.prev.next=e.next,e.prevZ&&(e.prevZ.nextZ=e.nextZ),e.nextZ&&(e.nextZ.prevZ=e.prevZ)}function $h(e,t,i){this.i=e,this.x=t,this.y=i,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}function ep(e,t,i,u){for(var f=0,m=t,x=i-u;m<i;m+=u)f+=(e[x]-e[m])*(e[m+1]+e[x+1]),x=m;return f}function qy(e,t,i,u,f){(function m(x,k,A,z,D){for(;z>A;){if(z-A>600){var B=z-A+1,V=k-A+1,j=Math.log(B),Q=.5*Math.exp(2*j/3),$=.5*Math.sqrt(j*Q*(B-Q)/B)*(V-B/2<0?-1:1);m(x,k,Math.max(A,Math.floor(k-V*Q/B+$)),Math.min(z,Math.floor(k+(B-V)*Q/B+$)),D)}var pe=x[k],oe=A,ye=z;for(pu(x,A,k),D(x[z],pe)>0&&pu(x,A,z);oe<ye;){for(pu(x,oe,ye),oe++,ye--;D(x[oe],pe)<0;)oe++;for(;D(x[ye],pe)>0;)ye--}D(x[A],pe)===0?pu(x,A,ye):pu(x,++ye,z),ye<=k&&(A=ye+1),k<=ye&&(z=ye-1)}})(e,t,i||0,u||e.length-1,f||jy)}function pu(e,t,i){var u=e[t];e[t]=e[i],e[i]=u}function jy(e,t){return e<t?-1:e>t?1:0}function tp(e,t){var i=e.length;if(i<=1)return[e];for(var u,f,m=[],x=0;x<i;x++){var k=Be(e[x]);k!==0&&(e[x].area=Math.abs(k),f===void 0&&(f=k<0),f===k<0?(u&&m.push(u),u=[e[x]]):u.push(e[x]))}if(u&&m.push(u),t>1)for(var A=0;A<m.length;A++)m[A].length<=t||(qy(m[A],t,1,m[A].length-1,Gy),m[A]=m[A].slice(0,t));return m}function Gy(e,t){return t.area-e.area}function rp(e,t,i){for(var u=i.patternDependencies,f=!1,m=0,x=t;m<x.length;m+=1){var k=x[m].paint.get(e+"-pattern");k.isConstant()||(f=!0);var A=k.constantOr(null);A&&(f=!0,u[A.to]=!0,u[A.from]=!0)}return f}function ip(e,t,i,u,f){for(var m=f.patternDependencies,x=0,k=t;x<k.length;x+=1){var A=k[x],z=A.paint.get(e+"-pattern").value;if(z.kind!=="constant"){var D=z.evaluate({zoom:u-1},i,{},f.availableImages),B=z.evaluate({zoom:u},i,{},f.availableImages),V=z.evaluate({zoom:u+1},i,{},f.availableImages);B=B&&B.name?B.name:B,V=V&&V.name?V.name:V,m[D=D&&D.name?D.name:D]=!0,m[B]=!0,m[V]=!0,i.patterns[A.id]={min:D,mid:B,max:V}}}return i}Ac.deviation=function(e,t,i,u){var f=t&&t.length,m=Math.abs(ep(e,0,f?t[0]*i:e.length,i));if(f)for(var x=0,k=t.length;x<k;x++)m-=Math.abs(ep(e,t[x]*i,x<k-1?t[x+1]*i:e.length,i));var A=0;for(x=0;x<u.length;x+=3){var z=u[x]*i,D=u[x+1]*i,B=u[x+2]*i;A+=Math.abs((e[z]-e[B])*(e[D+1]-e[z+1])-(e[z]-e[D])*(e[B+1]-e[z+1]))}return m===0&&A===0?0:Math.abs((A-m)/m)},Ac.flatten=function(e){for(var t=e[0][0].length,i={vertices:[],holes:[],dimensions:t},u=0,f=0;f<e.length;f++){for(var m=0;m<e[f].length;m++)for(var x=0;x<t;x++)i.vertices.push(e[f][m][x]);f>0&&i.holes.push(u+=e[f-1].length)}return i},Jh.default=My;var Ra=function(e){this.zoom=e.zoom,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map(function(t){return t.id}),this.index=e.index,this.hasPattern=!1,this.patternFeatures=[],this.layoutVertexArray=new Eo,this.indexArray=new Wa,this.indexArray2=new xs,this.programConfigurations=new Rt(e.layers,e.zoom),this.segments=new Z,this.segments2=new Z,this.stateDependentLayerIds=this.layers.filter(function(t){return t.isStateDependent()}).map(function(t){return t.id})};Ra.prototype.populate=function(e,t,i){this.hasPattern=rp("fill",this.layers,t);for(var u=this.layers[0].layout.get("fill-sort-key"),f=[],m=0,x=e;m<x.length;m+=1){var k=x[m],A=k.feature,z=k.id,D=k.index,B=k.sourceLayerIndex,V=this.layers[0]._featureFilter.needGeometry,j=di(A,V);if(this.layers[0]._featureFilter.filter(new lr(this.zoom),j,i)){var Q=u?u.evaluate(j,{},i,t.availableImages):void 0,$={id:z,properties:A.properties,type:A.type,sourceLayerIndex:B,index:D,geometry:V?j.geometry:ri(A),patterns:{},sortKey:Q};f.push($)}}u&&f.sort(function(Xe,rt){return Xe.sortKey-rt.sortKey});for(var pe=0,oe=f;pe<oe.length;pe+=1){var ye=oe[pe],xe=ye.geometry,Se=ye.index,Te=ye.sourceLayerIndex;if(this.hasPattern){var Me=ip("fill",this.layers,ye,this.zoom,t);this.patternFeatures.push(Me)}else this.addFeature(ye,xe,Se,i,{});t.featureIndex.insert(e[Se].feature,xe,Se,Te,this.index)}},Ra.prototype.update=function(e,t,i){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(e,t,this.stateDependentLayers,i)},Ra.prototype.addFeatures=function(e,t,i){for(var u=0,f=this.patternFeatures;u<f.length;u+=1){var m=f[u];this.addFeature(m,m.geometry,m.index,t,i)}},Ra.prototype.isEmpty=function(){return this.layoutVertexArray.length===0},Ra.prototype.uploadPending=function(){return!this.uploaded||this.programConfigurations.needsUpload},Ra.prototype.upload=function(e){this.uploaded||(this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,Cy),this.indexBuffer=e.createIndexBuffer(this.indexArray),this.indexBuffer2=e.createIndexBuffer(this.indexArray2)),this.programConfigurations.upload(e),this.uploaded=!0},Ra.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.indexBuffer2.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.segments2.destroy())},Ra.prototype.addFeature=function(e,t,i,u,f){for(var m=0,x=tp(t,500);m<x.length;m+=1){for(var k=x[m],A=0,z=0,D=k;z<D.length;z+=1)A+=D[z].length;for(var B=this.segments.prepareSegment(A,this.layoutVertexArray,this.indexArray),V=B.vertexLength,j=[],Q=[],$=0,pe=k;$<pe.length;$+=1){var oe=pe[$];if(oe.length!==0){oe!==k[0]&&Q.push(j.length/2);var ye=this.segments2.prepareSegment(oe.length,this.layoutVertexArray,this.indexArray2),xe=ye.vertexLength;this.layoutVertexArray.emplaceBack(oe[0].x,oe[0].y),this.indexArray2.emplaceBack(xe+oe.length-1,xe),j.push(oe[0].x),j.push(oe[0].y);for(var Se=1;Se<oe.length;Se++)this.layoutVertexArray.emplaceBack(oe[Se].x,oe[Se].y),this.indexArray2.emplaceBack(xe+Se-1,xe+Se),j.push(oe[Se].x),j.push(oe[Se].y);ye.vertexLength+=oe.length,ye.primitiveLength+=oe.length}}for(var Te=Jh(j,Q),Me=0;Me<Te.length;Me+=3)this.indexArray.emplaceBack(V+Te[Me],V+Te[Me+1],V+Te[Me+2]);B.vertexLength+=A,B.primitiveLength+=Te.length/3}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,e,i,f,u)},mt("FillBucket",Ra,{omit:["layers","patternFeatures"]});var Zy=new nn({"fill-sort-key":new _t(U.layout_fill["fill-sort-key"])}),Ky={paint:new nn({"fill-antialias":new Et(U.paint_fill["fill-antialias"]),"fill-opacity":new _t(U.paint_fill["fill-opacity"]),"fill-color":new _t(U.paint_fill["fill-color"]),"fill-outline-color":new _t(U.paint_fill["fill-outline-color"]),"fill-translate":new Et(U.paint_fill["fill-translate"]),"fill-translate-anchor":new Et(U.paint_fill["fill-translate-anchor"]),"fill-pattern":new Qs(U.paint_fill["fill-pattern"])}),layout:Zy},Hy=function(e){function t(i){e.call(this,i,Ky)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.recalculate=function(i,u){e.prototype.recalculate.call(this,i,u);var f=this.paint._values["fill-outline-color"];f.value.kind==="constant"&&f.value.value===void 0&&(this.paint._values["fill-outline-color"]=this.paint._values["fill-color"])},t.prototype.createBucket=function(i){return new Ra(i)},t.prototype.queryRadius=function(){return Fi(this.paint.get("fill-translate"))},t.prototype.queryIntersectsFeature=function(i,u,f,m,x,k,A){return _a(La(i,this.paint.get("fill-translate"),this.paint.get("fill-translate-anchor"),k.angle,A),m)},t.prototype.isTileClipped=function(){return!0},t}(Ta),Xy=Ki([{name:"a_pos",components:2,type:"Int16"},{name:"a_normal_ed",components:4,type:"Int16"}],4).members,rf=ol;function ol(e,t,i,u,f){this.properties={},this.extent=i,this.type=0,this._pbf=e,this._geometry=-1,this._keys=u,this._values=f,e.readFields(Wy,this,t)}function Wy(e,t,i){e==1?t.id=i.readVarint():e==2?function(u,f){for(var m=u.readVarint()+u.pos;u.pos<m;){var x=f._keys[u.readVarint()],k=f._values[u.readVarint()];f.properties[x]=k}}(i,t):e==3?t.type=i.readVarint():e==4&&(t._geometry=i.pos)}function Yy(e){for(var t,i,u=0,f=0,m=e.length,x=m-1;f<m;x=f++)u+=((i=e[x]).x-(t=e[f]).x)*(t.y+i.y);return u}ol.types=["Unknown","Point","LineString","Polygon"],ol.prototype.loadGeometry=function(){var e=this._pbf;e.pos=this._geometry;for(var t,i=e.readVarint()+e.pos,u=1,f=0,m=0,x=0,k=[];e.pos<i;){if(f<=0){var A=e.readVarint();u=7&A,f=A>>3}if(f--,u===1||u===2)m+=e.readSVarint(),x+=e.readSVarint(),u===1&&(t&&k.push(t),t=[]),t.push(new F(m,x));else{if(u!==7)throw new Error("unknown command "+u);t&&t.push(t[0].clone())}}return t&&k.push(t),k},ol.prototype.bbox=function(){var e=this._pbf;e.pos=this._geometry;for(var t=e.readVarint()+e.pos,i=1,u=0,f=0,m=0,x=1/0,k=-1/0,A=1/0,z=-1/0;e.pos<t;){if(u<=0){var D=e.readVarint();i=7&D,u=D>>3}if(u--,i===1||i===2)(f+=e.readSVarint())<x&&(x=f),f>k&&(k=f),(m+=e.readSVarint())<A&&(A=m),m>z&&(z=m);else if(i!==7)throw new Error("unknown command "+i)}return[x,A,k,z]},ol.prototype.toGeoJSON=function(e,t,i){var u,f,m=this.extent*Math.pow(2,i),x=this.extent*e,k=this.extent*t,A=this.loadGeometry(),z=ol.types[this.type];function D(j){for(var Q=0;Q<j.length;Q++){var $=j[Q];j[Q]=[360*($.x+x)/m-180,360/Math.PI*Math.atan(Math.exp((180-360*($.y+k)/m)*Math.PI/180))-90]}}switch(this.type){case 1:var B=[];for(u=0;u<A.length;u++)B[u]=A[u][0];D(A=B);break;case 2:for(u=0;u<A.length;u++)D(A[u]);break;case 3:for(A=function(j){var Q=j.length;if(Q<=1)return[j];for(var $,pe,oe=[],ye=0;ye<Q;ye++){var xe=Yy(j[ye]);xe!==0&&(pe===void 0&&(pe=xe<0),pe===xe<0?($&&oe.push($),$=[j[ye]]):$.push(j[ye]))}return $&&oe.push($),oe}(A),u=0;u<A.length;u++)for(f=0;f<A[u].length;f++)D(A[u][f])}A.length===1?A=A[0]:z="Multi"+z;var V={type:"Feature",geometry:{type:z,coordinates:A},properties:this.properties};return"id"in this&&(V.id=this.id),V};var nf=af;function af(e,t){this.version=1,this.name=null,this.extent=4096,this.length=0,this._pbf=e,this._keys=[],this._values=[],this._features=[],e.readFields(Jy,this,t),this.length=this._features.length}function Jy(e,t,i){e===15?t.version=i.readVarint():e===1?t.name=i.readString():e===5?t.extent=i.readVarint():e===2?t._features.push(i.pos):e===3?t._keys.push(i.readString()):e===4&&t._values.push(function(u){for(var f=null,m=u.readVarint()+u.pos;u.pos<m;){var x=u.readVarint()>>3;f=x===1?u.readString():x===2?u.readFloat():x===3?u.readDouble():x===4?u.readVarint64():x===5?u.readVarint():x===6?u.readSVarint():x===7?u.readBoolean():null}return f}(i))}function Qy(e,t,i){if(e===3){var u=new nf(i,i.readVarint()+i.pos);u.length&&(t[u.name]=u)}}af.prototype.feature=function(e){if(e<0||e>=this._features.length)throw new Error("feature index out of bounds");this._pbf.pos=this._features[e];var t=this._pbf.readVarint()+this._pbf.pos;return new rf(this._pbf,t,this.extent,this._keys,this._values)};var sl={VectorTile:function(e,t){this.layers=e.readFields(Qy,{},t)},VectorTileFeature:rf,VectorTileLayer:nf},$y=sl.VectorTileFeature.types,np=Math.pow(2,13);function fu(e,t,i,u,f,m,x,k){e.emplaceBack(t,i,2*Math.floor(u*np)+x,f*np*2,m*np*2,Math.round(k))}var Ba=function(e){this.zoom=e.zoom,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map(function(t){return t.id}),this.index=e.index,this.hasPattern=!1,this.layoutVertexArray=new Da,this.indexArray=new Wa,this.programConfigurations=new Rt(e.layers,e.zoom),this.segments=new Z,this.stateDependentLayerIds=this.layers.filter(function(t){return t.isStateDependent()}).map(function(t){return t.id})};function eg(e,t){return e.x===t.x&&(e.x<0||e.x>8192)||e.y===t.y&&(e.y<0||e.y>8192)}Ba.prototype.populate=function(e,t,i){this.features=[],this.hasPattern=rp("fill-extrusion",this.layers,t);for(var u=0,f=e;u<f.length;u+=1){var m=f[u],x=m.feature,k=m.id,A=m.index,z=m.sourceLayerIndex,D=this.layers[0]._featureFilter.needGeometry,B=di(x,D);if(this.layers[0]._featureFilter.filter(new lr(this.zoom),B,i)){var V={id:k,sourceLayerIndex:z,index:A,geometry:D?B.geometry:ri(x),properties:x.properties,type:x.type,patterns:{}};this.hasPattern?this.features.push(ip("fill-extrusion",this.layers,V,this.zoom,t)):this.addFeature(V,V.geometry,A,i,{}),t.featureIndex.insert(x,V.geometry,A,z,this.index,!0)}}},Ba.prototype.addFeatures=function(e,t,i){for(var u=0,f=this.features;u<f.length;u+=1){var m=f[u];this.addFeature(m,m.geometry,m.index,t,i)}},Ba.prototype.update=function(e,t,i){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(e,t,this.stateDependentLayers,i)},Ba.prototype.isEmpty=function(){return this.layoutVertexArray.length===0},Ba.prototype.uploadPending=function(){return!this.uploaded||this.programConfigurations.needsUpload},Ba.prototype.upload=function(e){this.uploaded||(this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,Xy),this.indexBuffer=e.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(e),this.uploaded=!0},Ba.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())},Ba.prototype.addFeature=function(e,t,i,u,f){for(var m=0,x=tp(t,500);m<x.length;m+=1){for(var k=x[m],A=0,z=0,D=k;z<D.length;z+=1)A+=D[z].length;for(var B=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray),V=0,j=k;V<j.length;V+=1){var Q=j[V];if(Q.length!==0&&!((sr=Q).every(function(Kt){return Kt.x<0})||sr.every(function(Kt){return Kt.x>8192})||sr.every(function(Kt){return Kt.y<0})||sr.every(function(Kt){return Kt.y>8192})))for(var $=0,pe=0;pe<Q.length;pe++){var oe=Q[pe];if(pe>=1){var ye=Q[pe-1];if(!eg(oe,ye)){B.vertexLength+4>Z.MAX_VERTEX_ARRAY_LENGTH&&(B=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray));var xe=oe.sub(ye)._perp()._unit(),Se=ye.dist(oe);$+Se>32768&&($=0),fu(this.layoutVertexArray,oe.x,oe.y,xe.x,xe.y,0,0,$),fu(this.layoutVertexArray,oe.x,oe.y,xe.x,xe.y,0,1,$),fu(this.layoutVertexArray,ye.x,ye.y,xe.x,xe.y,0,0,$+=Se),fu(this.layoutVertexArray,ye.x,ye.y,xe.x,xe.y,0,1,$);var Te=B.vertexLength;this.indexArray.emplaceBack(Te,Te+2,Te+1),this.indexArray.emplaceBack(Te+1,Te+2,Te+3),B.vertexLength+=4,B.primitiveLength+=2}}}}if(B.vertexLength+A>Z.MAX_VERTEX_ARRAY_LENGTH&&(B=this.segments.prepareSegment(A,this.layoutVertexArray,this.indexArray)),$y[e.type]==="Polygon"){for(var Me=[],Xe=[],rt=B.vertexLength,wt=0,ut=k;wt<ut.length;wt+=1){var It=ut[wt];if(It.length!==0){It!==k[0]&&Xe.push(Me.length/2);for(var ht=0;ht<It.length;ht++){var $t=It[ht];fu(this.layoutVertexArray,$t.x,$t.y,0,0,1,1,0),Me.push($t.x),Me.push($t.y)}}}for(var Bt=Jh(Me,Xe),vt=0;vt<Bt.length;vt+=3)this.indexArray.emplaceBack(rt+Bt[vt],rt+Bt[vt+2],rt+Bt[vt+1]);B.primitiveLength+=Bt.length/3,B.vertexLength+=A}}var sr;this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,e,i,f,u)},mt("FillExtrusionBucket",Ba,{omit:["layers","features"]});var tg={paint:new nn({"fill-extrusion-opacity":new Et(U["paint_fill-extrusion"]["fill-extrusion-opacity"]),"fill-extrusion-color":new _t(U["paint_fill-extrusion"]["fill-extrusion-color"]),"fill-extrusion-translate":new Et(U["paint_fill-extrusion"]["fill-extrusion-translate"]),"fill-extrusion-translate-anchor":new Et(U["paint_fill-extrusion"]["fill-extrusion-translate-anchor"]),"fill-extrusion-pattern":new Qs(U["paint_fill-extrusion"]["fill-extrusion-pattern"]),"fill-extrusion-height":new _t(U["paint_fill-extrusion"]["fill-extrusion-height"]),"fill-extrusion-base":new _t(U["paint_fill-extrusion"]["fill-extrusion-base"]),"fill-extrusion-vertical-gradient":new Et(U["paint_fill-extrusion"]["fill-extrusion-vertical-gradient"])})},rg=function(e){function t(i){e.call(this,i,tg)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.createBucket=function(i){return new Ba(i)},t.prototype.queryRadius=function(){return Fi(this.paint.get("fill-extrusion-translate"))},t.prototype.is3D=function(){return!0},t.prototype.queryIntersectsFeature=function(i,u,f,m,x,k,A,z){var D=La(i,this.paint.get("fill-extrusion-translate"),this.paint.get("fill-extrusion-translate-anchor"),k.angle,A),B=this.paint.get("fill-extrusion-height").evaluate(u,f),V=this.paint.get("fill-extrusion-base").evaluate(u,f),j=function($,pe,oe,ye){for(var xe=[],Se=0,Te=$;Se<Te.length;Se+=1){var Me=Te[Se],Xe=[Me.x,Me.y,0,1];il(Xe,Xe,pe),xe.push(new F(Xe[0]/Xe[3],Xe[1]/Xe[3]))}return xe}(D,z),Q=function($,pe,oe,ye){for(var xe=[],Se=[],Te=ye[8]*pe,Me=ye[9]*pe,Xe=ye[10]*pe,rt=ye[11]*pe,wt=ye[8]*oe,ut=ye[9]*oe,It=ye[10]*oe,ht=ye[11]*oe,$t=0,Bt=$;$t<Bt.length;$t+=1){for(var vt=[],sr=[],Kt=0,yr=Bt[$t];Kt<yr.length;Kt+=1){var At=yr[Kt],xr=At.x,Jr=At.y,li=ye[0]*xr+ye[4]*Jr+ye[12],ii=ye[1]*xr+ye[5]*Jr+ye[13],Qr=ye[2]*xr+ye[6]*Jr+ye[14],ui=ye[3]*xr+ye[7]*Jr+ye[15],Ni=Qr+Xe,Vi=ui+rt,xn=li+wt,Wi=ii+ut,wn=Qr+It,mi=ui+ht,Yi=new F((li+Te)/Vi,(ii+Me)/Vi);Yi.z=Ni/Vi,vt.push(Yi);var hr=new F(xn/mi,Wi/mi);hr.z=wn/mi,sr.push(hr)}xe.push(vt),Se.push(sr)}return[xe,Se]}(m,V,B,z);return function($,pe,oe){var ye=1/0;_a(oe,pe)&&(ye=of(oe,pe[0]));for(var xe=0;xe<pe.length;xe++)for(var Se=pe[xe],Te=$[xe],Me=0;Me<Se.length-1;Me++){var Xe=Se[Me],rt=[Xe,Se[Me+1],Te[Me+1],Te[Me],Xe];Qa(oe,rt)&&(ye=Math.min(ye,of(oe,rt)))}return ye!==1/0&&ye}(Q[0],Q[1],j)},t}(Ta);function du(e,t){return e.x*t.x+e.y*t.y}function of(e,t){if(e.length===1){for(var i,u=0,f=t[u++];!i||f.equals(i);)if(!(i=t[u++]))return 1/0;for(;u<t.length;u++){var m=t[u],x=e[0],k=i.sub(f),A=m.sub(f),z=x.sub(f),D=du(k,k),B=du(k,A),V=du(A,A),j=du(z,k),Q=du(z,A),$=D*V-B*B,pe=(V*j-B*Q)/$,oe=(D*Q-B*j)/$,ye=f.z*(1-pe-oe)+i.z*pe+m.z*oe;if(isFinite(ye))return ye}return 1/0}for(var xe=1/0,Se=0,Te=t;Se<Te.length;Se+=1)xe=Math.min(xe,Te[Se].z);return xe}var ig=Ki([{name:"a_pos_normal",components:2,type:"Int16"},{name:"a_data",components:4,type:"Uint8"}],4).members,ng=Ki([{name:"a_uv_x",components:1,type:"Float32"},{name:"a_split_index",components:1,type:"Float32"}]).members,ag=sl.VectorTileFeature.types,og=Math.cos(Math.PI/180*37.5),sf=Math.pow(2,14)/.5,Dn=function(e){var t=this;this.zoom=e.zoom,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map(function(i){return i.id}),this.index=e.index,this.hasPattern=!1,this.patternFeatures=[],this.lineClipsArray=[],this.gradients={},this.layers.forEach(function(i){t.gradients[i.id]={}}),this.layoutVertexArray=new Gn,this.layoutVertexArray2=new Go,this.indexArray=new Wa,this.programConfigurations=new Rt(e.layers,e.zoom),this.segments=new Z,this.maxLineLength=0,this.stateDependentLayerIds=this.layers.filter(function(i){return i.isStateDependent()}).map(function(i){return i.id})};Dn.prototype.populate=function(e,t,i){this.hasPattern=rp("line",this.layers,t);for(var u=this.layers[0].layout.get("line-sort-key"),f=[],m=0,x=e;m<x.length;m+=1){var k=x[m],A=k.feature,z=k.id,D=k.index,B=k.sourceLayerIndex,V=this.layers[0]._featureFilter.needGeometry,j=di(A,V);if(this.layers[0]._featureFilter.filter(new lr(this.zoom),j,i)){var Q=u?u.evaluate(j,{},i):void 0,$={id:z,properties:A.properties,type:A.type,sourceLayerIndex:B,index:D,geometry:V?j.geometry:ri(A),patterns:{},sortKey:Q};f.push($)}}u&&f.sort(function(Xe,rt){return Xe.sortKey-rt.sortKey});for(var pe=0,oe=f;pe<oe.length;pe+=1){var ye=oe[pe],xe=ye.geometry,Se=ye.index,Te=ye.sourceLayerIndex;if(this.hasPattern){var Me=ip("line",this.layers,ye,this.zoom,t);this.patternFeatures.push(Me)}else this.addFeature(ye,xe,Se,i,{});t.featureIndex.insert(e[Se].feature,xe,Se,Te,this.index)}},Dn.prototype.update=function(e,t,i){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(e,t,this.stateDependentLayers,i)},Dn.prototype.addFeatures=function(e,t,i){for(var u=0,f=this.patternFeatures;u<f.length;u+=1){var m=f[u];this.addFeature(m,m.geometry,m.index,t,i)}},Dn.prototype.isEmpty=function(){return this.layoutVertexArray.length===0},Dn.prototype.uploadPending=function(){return!this.uploaded||this.programConfigurations.needsUpload},Dn.prototype.upload=function(e){this.uploaded||(this.layoutVertexArray2.length!==0&&(this.layoutVertexBuffer2=e.createVertexBuffer(this.layoutVertexArray2,ng)),this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,ig),this.indexBuffer=e.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(e),this.uploaded=!0},Dn.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())},Dn.prototype.lineFeatureClips=function(e){if(e.properties&&e.properties.hasOwnProperty("mapbox_clip_start")&&e.properties.hasOwnProperty("mapbox_clip_end"))return{start:+e.properties.mapbox_clip_start,end:+e.properties.mapbox_clip_end}},Dn.prototype.addFeature=function(e,t,i,u,f){var m=this.layers[0].layout,x=m.get("line-join").evaluate(e,{}),k=m.get("line-cap"),A=m.get("line-miter-limit"),z=m.get("line-round-limit");this.lineClips=this.lineFeatureClips(e);for(var D=0,B=t;D<B.length;D+=1)this.addLine(B[D],e,x,k,A,z);this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,e,i,f,u)},Dn.prototype.addLine=function(e,t,i,u,f,m){if(this.distance=0,this.scaledDistance=0,this.totalDistance=0,this.lineClips){this.lineClipsArray.push(this.lineClips);for(var x=0;x<e.length-1;x++)this.totalDistance+=e[x].dist(e[x+1]);this.updateScaledDistance(),this.maxLineLength=Math.max(this.maxLineLength,this.totalDistance)}for(var k=ag[t.type]==="Polygon",A=e.length;A>=2&&e[A-1].equals(e[A-2]);)A--;for(var z=0;z<A-1&&e[z].equals(e[z+1]);)z++;if(!(A<(k?3:2))){i==="bevel"&&(f=1.05);var D,B=this.overscaling<=16?122880/(512*this.overscaling):0,V=this.segments.prepareSegment(10*A,this.layoutVertexArray,this.indexArray),j=void 0,Q=void 0,$=void 0,pe=void 0;this.e1=this.e2=-1,k&&(pe=e[z].sub(D=e[A-2])._unit()._perp());for(var oe=z;oe<A;oe++)if(!(Q=oe===A-1?k?e[z+1]:void 0:e[oe+1])||!e[oe].equals(Q)){pe&&($=pe),D&&(j=D),D=e[oe],pe=Q?Q.sub(D)._unit()._perp():$;var ye=($=$||pe).add(pe);ye.x===0&&ye.y===0||ye._unit();var xe=$.x*pe.x+$.y*pe.y,Se=ye.x*pe.x+ye.y*pe.y,Te=Se!==0?1/Se:1/0,Me=2*Math.sqrt(2-2*Se),Xe=Se<og&&j&&Q,rt=$.x*pe.y-$.y*pe.x>0;if(Xe&&oe>z){var wt=D.dist(j);if(wt>2*B){var ut=D.sub(D.sub(j)._mult(B/wt)._round());this.updateDistance(j,ut),this.addCurrentVertex(ut,$,0,0,V),j=ut}}var It=j&&Q,ht=It?i:k?"butt":u;if(It&&ht==="round"&&(Te<m?ht="miter":Te<=2&&(ht="fakeround")),ht==="miter"&&Te>f&&(ht="bevel"),ht==="bevel"&&(Te>2&&(ht="flipbevel"),Te<f&&(ht="miter")),j&&this.updateDistance(j,D),ht==="miter")ye._mult(Te),this.addCurrentVertex(D,ye,0,0,V);else if(ht==="flipbevel"){if(Te>100)ye=pe.mult(-1);else{var $t=Te*$.add(pe).mag()/$.sub(pe).mag();ye._perp()._mult($t*(rt?-1:1))}this.addCurrentVertex(D,ye,0,0,V),this.addCurrentVertex(D,ye.mult(-1),0,0,V)}else if(ht==="bevel"||ht==="fakeround"){var Bt=-Math.sqrt(Te*Te-1),vt=rt?Bt:0,sr=rt?0:Bt;if(j&&this.addCurrentVertex(D,$,vt,sr,V),ht==="fakeround")for(var Kt=Math.round(180*Me/Math.PI/20),yr=1;yr<Kt;yr++){var At=yr/Kt;if(At!==.5){var xr=At-.5;At+=At*xr*(At-1)*((1.0904+xe*(xe*(3.55645-1.43519*xe)-3.2452))*xr*xr+(.848013+xe*(.215638*xe-1.06021)))}var Jr=pe.sub($)._mult(At)._add($)._unit()._mult(rt?-1:1);this.addHalfVertex(D,Jr.x,Jr.y,!1,rt,0,V)}Q&&this.addCurrentVertex(D,pe,-vt,-sr,V)}else if(ht==="butt")this.addCurrentVertex(D,ye,0,0,V);else if(ht==="square"){var li=j?1:-1;this.addCurrentVertex(D,ye,li,li,V)}else ht==="round"&&(j&&(this.addCurrentVertex(D,$,0,0,V),this.addCurrentVertex(D,$,1,1,V,!0)),Q&&(this.addCurrentVertex(D,pe,-1,-1,V,!0),this.addCurrentVertex(D,pe,0,0,V)));if(Xe&&oe<A-1){var ii=D.dist(Q);if(ii>2*B){var Qr=D.add(Q.sub(D)._mult(B/ii)._round());this.updateDistance(D,Qr),this.addCurrentVertex(Qr,pe,0,0,V),D=Qr}}}}},Dn.prototype.addCurrentVertex=function(e,t,i,u,f,m){m===void 0&&(m=!1);var x=t.y*u-t.x,k=-t.y-t.x*u;this.addHalfVertex(e,t.x+t.y*i,t.y-t.x*i,m,!1,i,f),this.addHalfVertex(e,x,k,m,!0,-u,f),this.distance>sf/2&&this.totalDistance===0&&(this.distance=0,this.addCurrentVertex(e,t,i,u,f,m))},Dn.prototype.addHalfVertex=function(e,t,i,u,f,m,x){var k=.5*(this.lineClips?this.scaledDistance*(sf-1):this.scaledDistance);this.layoutVertexArray.emplaceBack((e.x<<1)+(u?1:0),(e.y<<1)+(f?1:0),Math.round(63*t)+128,Math.round(63*i)+128,1+(m===0?0:m<0?-1:1)|(63&k)<<2,k>>6),this.lineClips&&this.layoutVertexArray2.emplaceBack((this.scaledDistance-this.lineClips.start)/(this.lineClips.end-this.lineClips.start),this.lineClipsArray.length);var A=x.vertexLength++;this.e1>=0&&this.e2>=0&&(this.indexArray.emplaceBack(this.e1,this.e2,A),x.primitiveLength++),f?this.e2=A:this.e1=A},Dn.prototype.updateScaledDistance=function(){this.scaledDistance=this.lineClips?this.lineClips.start+(this.lineClips.end-this.lineClips.start)*this.distance/this.totalDistance:this.distance},Dn.prototype.updateDistance=function(e,t){this.distance+=e.dist(t),this.updateScaledDistance()},mt("LineBucket",Dn,{omit:["layers","patternFeatures"]});var sg=new nn({"line-cap":new Et(U.layout_line["line-cap"]),"line-join":new _t(U.layout_line["line-join"]),"line-miter-limit":new Et(U.layout_line["line-miter-limit"]),"line-round-limit":new Et(U.layout_line["line-round-limit"]),"line-sort-key":new _t(U.layout_line["line-sort-key"])}),lf={paint:new nn({"line-opacity":new _t(U.paint_line["line-opacity"]),"line-color":new _t(U.paint_line["line-color"]),"line-translate":new Et(U.paint_line["line-translate"]),"line-translate-anchor":new Et(U.paint_line["line-translate-anchor"]),"line-width":new _t(U.paint_line["line-width"]),"line-gap-width":new _t(U.paint_line["line-gap-width"]),"line-offset":new _t(U.paint_line["line-offset"]),"line-blur":new _t(U.paint_line["line-blur"]),"line-dasharray":new _n(U.paint_line["line-dasharray"]),"line-pattern":new Qs(U.paint_line["line-pattern"]),"line-gradient":new ga(U.paint_line["line-gradient"])}),layout:sg},uf=new(function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.possiblyEvaluate=function(i,u){return u=new lr(Math.floor(u.zoom),{now:u.now,fadeDuration:u.fadeDuration,zoomHistory:u.zoomHistory,transition:u.transition}),e.prototype.possiblyEvaluate.call(this,i,u)},t.prototype.evaluate=function(i,u,f,m){return u=_e({},u,{zoom:Math.floor(u.zoom)}),e.prototype.evaluate.call(this,i,u,f,m)},t}(_t))(lf.paint.properties["line-width"].specification);uf.useIntegerZoom=!0;var lg=function(e){function t(i){e.call(this,i,lf),this.gradientVersion=0}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._handleSpecialPaintPropertyUpdate=function(i){i==="line-gradient"&&(this.stepInterpolant=this._transitionablePaint._values["line-gradient"].value.expression._styleExpression.expression instanceof Nn,this.gradientVersion=(this.gradientVersion+1)%X)},t.prototype.gradientExpression=function(){return this._transitionablePaint._values["line-gradient"].value.expression},t.prototype.recalculate=function(i,u){e.prototype.recalculate.call(this,i,u),this.paint._values["line-floorwidth"]=uf.possiblyEvaluate(this._transitioningPaint._values["line-width"].value,i)},t.prototype.createBucket=function(i){return new Dn(i)},t.prototype.queryRadius=function(i){var u=i,f=cf(za("line-width",this,u),za("line-gap-width",this,u)),m=za("line-offset",this,u);return f/2+Math.abs(m)+Fi(this.paint.get("line-translate"))},t.prototype.queryIntersectsFeature=function(i,u,f,m,x,k,A){var z=La(i,this.paint.get("line-translate"),this.paint.get("line-translate-anchor"),k.angle,A),D=A/2*cf(this.paint.get("line-width").evaluate(u,f),this.paint.get("line-gap-width").evaluate(u,f)),B=this.paint.get("line-offset").evaluate(u,f);return B&&(m=function(V,j){for(var Q=[],$=new F(0,0),pe=0;pe<V.length;pe++){for(var oe=V[pe],ye=[],xe=0;xe<oe.length;xe++){var Se=oe[xe],Te=oe[xe+1],Me=xe===0?$:Se.sub(oe[xe-1])._unit()._perp(),Xe=xe===oe.length-1?$:Te.sub(Se)._unit()._perp(),rt=Me._add(Xe)._unit();rt._mult(1/(rt.x*Xe.x+rt.y*Xe.y)),ye.push(rt._mult(j)._add(Se))}Q.push(ye)}return Q}(m,B*A)),function(V,j,Q){for(var $=0;$<j.length;$++){var pe=j[$];if(V.length>=3){for(var oe=0;oe<pe.length;oe++)if(Aa(V,pe[oe]))return!0}if(oa(V,pe,Q))return!0}return!1}(z,m,D)},t.prototype.isTileClipped=function(){return!0},t}(Ta);function cf(e,t){return t>0?t+2*e:e}var ug=Ki([{name:"a_pos_offset",components:4,type:"Int16"},{name:"a_data",components:4,type:"Uint16"},{name:"a_pixeloffset",components:4,type:"Int16"}],4),cg=Ki([{name:"a_projected_pos",components:3,type:"Float32"}],4),hg=(Ki([{name:"a_fade_opacity",components:1,type:"Uint32"}],4),Ki([{name:"a_placed",components:2,type:"Uint8"},{name:"a_shift",components:2,type:"Float32"}])),hf=(Ki([{type:"Int16",name:"anchorPointX"},{type:"Int16",name:"anchorPointY"},{type:"Int16",name:"x1"},{type:"Int16",name:"y1"},{type:"Int16",name:"x2"},{type:"Int16",name:"y2"},{type:"Uint32",name:"featureIndex"},{type:"Uint16",name:"sourceLayerIndex"},{type:"Uint16",name:"bucketIndex"}]),Ki([{name:"a_pos",components:2,type:"Int16"},{name:"a_anchor_pos",components:2,type:"Int16"},{name:"a_extrude",components:2,type:"Int16"}],4)),pg=Ki([{name:"a_pos",components:2,type:"Float32"},{name:"a_radius",components:1,type:"Float32"},{name:"a_flags",components:2,type:"Int16"}],4);function fg(e,t,i){return e.sections.forEach(function(u){u.text=function(f,m,x){var k=m.layout.get("text-transform").evaluate(x,{});return k==="uppercase"?f=f.toLocaleUpperCase():k==="lowercase"&&(f=f.toLocaleLowerCase()),$n.applyArabicShaping&&(f=$n.applyArabicShaping(f)),f}(u.text,t,i)}),e}Ki([{name:"triangle",components:3,type:"Uint16"}]),Ki([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Uint16",name:"glyphStartIndex"},{type:"Uint16",name:"numGlyphs"},{type:"Uint32",name:"vertexStartIndex"},{type:"Uint32",name:"lineStartIndex"},{type:"Uint32",name:"lineLength"},{type:"Uint16",name:"segment"},{type:"Uint16",name:"lowerSize"},{type:"Uint16",name:"upperSize"},{type:"Float32",name:"lineOffsetX"},{type:"Float32",name:"lineOffsetY"},{type:"Uint8",name:"writingMode"},{type:"Uint8",name:"placedOrientation"},{type:"Uint8",name:"hidden"},{type:"Uint32",name:"crossTileID"},{type:"Int16",name:"associatedIconIndex"}]),Ki([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Int16",name:"rightJustifiedTextSymbolIndex"},{type:"Int16",name:"centerJustifiedTextSymbolIndex"},{type:"Int16",name:"leftJustifiedTextSymbolIndex"},{type:"Int16",name:"verticalPlacedTextSymbolIndex"},{type:"Int16",name:"placedIconSymbolIndex"},{type:"Int16",name:"verticalPlacedIconSymbolIndex"},{type:"Uint16",name:"key"},{type:"Uint16",name:"textBoxStartIndex"},{type:"Uint16",name:"textBoxEndIndex"},{type:"Uint16",name:"verticalTextBoxStartIndex"},{type:"Uint16",name:"verticalTextBoxEndIndex"},{type:"Uint16",name:"iconBoxStartIndex"},{type:"Uint16",name:"iconBoxEndIndex"},{type:"Uint16",name:"verticalIconBoxStartIndex"},{type:"Uint16",name:"verticalIconBoxEndIndex"},{type:"Uint16",name:"featureIndex"},{type:"Uint16",name:"numHorizontalGlyphVertices"},{type:"Uint16",name:"numVerticalGlyphVertices"},{type:"Uint16",name:"numIconVertices"},{type:"Uint16",name:"numVerticalIconVertices"},{type:"Uint16",name:"useRuntimeCollisionCircles"},{type:"Uint32",name:"crossTileID"},{type:"Float32",name:"textBoxScale"},{type:"Float32",components:2,name:"textOffset"},{type:"Float32",name:"collisionCircleDiameter"}]),Ki([{type:"Float32",name:"offsetX"}]),Ki([{type:"Int16",name:"x"},{type:"Int16",name:"y"},{type:"Int16",name:"tileUnitDistanceFromAnchor"}]);var mu={"!":"","#":"",$:"","%":"","&":"","(":"",")":"","*":"","+":"",",":"","-":"",".":"","/":"",":":"",";":"","<":"","=":"",">":"","?":"","@":"","[":"","\\":"","]":"","^":"",_:"","`":"","{":"","|":"","}":"","~":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":""},pf=function(e,t,i,u,f){var m,x,k=8*f-u-1,A=(1<<k)-1,z=A>>1,D=-7,B=i?f-1:0,V=i?-1:1,j=e[t+B];for(B+=V,m=j&(1<<-D)-1,j>>=-D,D+=k;D>0;m=256*m+e[t+B],B+=V,D-=8);for(x=m&(1<<-D)-1,m>>=-D,D+=u;D>0;x=256*x+e[t+B],B+=V,D-=8);if(m===0)m=1-z;else{if(m===A)return x?NaN:1/0*(j?-1:1);x+=Math.pow(2,u),m-=z}return(j?-1:1)*x*Math.pow(2,m-u)},ff=function(e,t,i,u,f,m){var x,k,A,z=8*m-f-1,D=(1<<z)-1,B=D>>1,V=f===23?Math.pow(2,-24)-Math.pow(2,-77):0,j=u?0:m-1,Q=u?1:-1,$=t<0||t===0&&1/t<0?1:0;for(t=Math.abs(t),isNaN(t)||t===1/0?(k=isNaN(t)?1:0,x=D):(x=Math.floor(Math.log(t)/Math.LN2),t*(A=Math.pow(2,-x))<1&&(x--,A*=2),(t+=x+B>=1?V/A:V*Math.pow(2,1-B))*A>=2&&(x++,A/=2),x+B>=D?(k=0,x=D):x+B>=1?(k=(t*A-1)*Math.pow(2,f),x+=B):(k=t*Math.pow(2,B-1)*Math.pow(2,f),x=0));f>=8;e[i+j]=255&k,j+=Q,k/=256,f-=8);for(x=x<<f|k,z+=f;z>0;e[i+j]=255&x,j+=Q,x/=256,z-=8);e[i+j-Q]|=128*$},Mc=Ur;function Ur(e){this.buf=ArrayBuffer.isView&&ArrayBuffer.isView(e)?e:new Uint8Array(e||0),this.pos=0,this.type=0,this.length=this.buf.length}Ur.Varint=0,Ur.Fixed64=1,Ur.Bytes=2,Ur.Fixed32=5;var df=typeof TextDecoder>"u"?null:new TextDecoder("utf8");function zo(e){return e.type===Ur.Bytes?e.readVarint()+e.pos:e.pos+1}function ll(e,t,i){return i?4294967296*t+(e>>>0):4294967296*(t>>>0)+(e>>>0)}function mf(e,t,i){var u=t<=16383?1:t<=2097151?2:t<=268435455?3:Math.floor(Math.log(t)/(7*Math.LN2));i.realloc(u);for(var f=i.pos-1;f>=e;f--)i.buf[f+u]=i.buf[f]}function dg(e,t){for(var i=0;i<e.length;i++)t.writeVarint(e[i])}function mg(e,t){for(var i=0;i<e.length;i++)t.writeSVarint(e[i])}function yg(e,t){for(var i=0;i<e.length;i++)t.writeFloat(e[i])}function gg(e,t){for(var i=0;i<e.length;i++)t.writeDouble(e[i])}function _g(e,t){for(var i=0;i<e.length;i++)t.writeBoolean(e[i])}function vg(e,t){for(var i=0;i<e.length;i++)t.writeFixed32(e[i])}function bg(e,t){for(var i=0;i<e.length;i++)t.writeSFixed32(e[i])}function xg(e,t){for(var i=0;i<e.length;i++)t.writeFixed64(e[i])}function wg(e,t){for(var i=0;i<e.length;i++)t.writeSFixed64(e[i])}function Dc(e,t){return(e[t]|e[t+1]<<8|e[t+2]<<16)+16777216*e[t+3]}function ul(e,t,i){e[i]=t,e[i+1]=t>>>8,e[i+2]=t>>>16,e[i+3]=t>>>24}function yf(e,t){return(e[t]|e[t+1]<<8|e[t+2]<<16)+(e[t+3]<<24)}function Sg(e,t,i){e===1&&i.readMessage(kg,t)}function kg(e,t,i){if(e===3){var u=i.readMessage(Eg,{}),f=u.width,m=u.height,x=u.left,k=u.top,A=u.advance;t.push({id:u.id,bitmap:new Ts({width:f+6,height:m+6},u.bitmap),metrics:{width:f,height:m,left:x,top:k,advance:A}})}}function Eg(e,t,i){e===1?t.id=i.readVarint():e===2?t.bitmap=i.readBytes():e===3?t.width=i.readVarint():e===4?t.height=i.readVarint():e===5?t.left=i.readSVarint():e===6?t.top=i.readSVarint():e===7&&(t.advance=i.readVarint())}function gf(e){for(var t=0,i=0,u=0,f=e;u<f.length;u+=1){var m=f[u];t+=m.w*m.h,i=Math.max(i,m.w)}e.sort(function($,pe){return pe.h-$.h});for(var x=[{x:0,y:0,w:Math.max(Math.ceil(Math.sqrt(t/.95)),i),h:1/0}],k=0,A=0,z=0,D=e;z<D.length;z+=1)for(var B=D[z],V=x.length-1;V>=0;V--){var j=x[V];if(!(B.w>j.w||B.h>j.h)){if(B.x=j.x,B.y=j.y,A=Math.max(A,B.y+B.h),k=Math.max(k,B.x+B.w),B.w===j.w&&B.h===j.h){var Q=x.pop();V<x.length&&(x[V]=Q)}else B.h===j.h?(j.x+=B.w,j.w-=B.w):B.w===j.w?(j.y+=B.h,j.h-=B.h):(x.push({x:j.x+B.w,y:j.y,w:j.w-B.w,h:B.h}),j.y+=B.h,j.h-=B.h);break}}return{w:k,h:A,fill:t/(k*A)||0}}Ur.prototype={destroy:function(){this.buf=null},readFields:function(e,t,i){for(i=i||this.length;this.pos<i;){var u=this.readVarint(),f=u>>3,m=this.pos;this.type=7&u,e(f,t,this),this.pos===m&&this.skip(u)}return t},readMessage:function(e,t){return this.readFields(e,t,this.readVarint()+this.pos)},readFixed32:function(){var e=Dc(this.buf,this.pos);return this.pos+=4,e},readSFixed32:function(){var e=yf(this.buf,this.pos);return this.pos+=4,e},readFixed64:function(){var e=Dc(this.buf,this.pos)+4294967296*Dc(this.buf,this.pos+4);return this.pos+=8,e},readSFixed64:function(){var e=Dc(this.buf,this.pos)+4294967296*yf(this.buf,this.pos+4);return this.pos+=8,e},readFloat:function(){var e=pf(this.buf,this.pos,!0,23,4);return this.pos+=4,e},readDouble:function(){var e=pf(this.buf,this.pos,!0,52,8);return this.pos+=8,e},readVarint:function(e){var t,i,u=this.buf;return t=127&(i=u[this.pos++]),i<128?t:(t|=(127&(i=u[this.pos++]))<<7,i<128?t:(t|=(127&(i=u[this.pos++]))<<14,i<128?t:(t|=(127&(i=u[this.pos++]))<<21,i<128?t:function(f,m,x){var k,A,z=x.buf;if(k=(112&(A=z[x.pos++]))>>4,A<128||(k|=(127&(A=z[x.pos++]))<<3,A<128)||(k|=(127&(A=z[x.pos++]))<<10,A<128)||(k|=(127&(A=z[x.pos++]))<<17,A<128)||(k|=(127&(A=z[x.pos++]))<<24,A<128)||(k|=(1&(A=z[x.pos++]))<<31,A<128))return ll(f,k,m);throw new Error("Expected varint not more than 10 bytes")}(t|=(15&(i=u[this.pos]))<<28,e,this))))},readVarint64:function(){return this.readVarint(!0)},readSVarint:function(){var e=this.readVarint();return e%2==1?(e+1)/-2:e/2},readBoolean:function(){return!!this.readVarint()},readString:function(){var e=this.readVarint()+this.pos,t=this.pos;return this.pos=e,e-t>=12&&df?function(i,u,f){return df.decode(i.subarray(u,f))}(this.buf,t,e):function(i,u,f){for(var m="",x=u;x<f;){var k,A,z,D=i[x],B=null,V=D>239?4:D>223?3:D>191?2:1;if(x+V>f)break;V===1?D<128&&(B=D):V===2?(192&(k=i[x+1]))==128&&(B=(31&D)<<6|63&k)<=127&&(B=null):V===3?(A=i[x+2],(192&(k=i[x+1]))==128&&(192&A)==128&&((B=(15&D)<<12|(63&k)<<6|63&A)<=2047||B>=55296&&B<=57343)&&(B=null)):V===4&&(A=i[x+2],z=i[x+3],(192&(k=i[x+1]))==128&&(192&A)==128&&(192&z)==128&&((B=(15&D)<<18|(63&k)<<12|(63&A)<<6|63&z)<=65535||B>=1114112)&&(B=null)),B===null?(B=65533,V=1):B>65535&&(B-=65536,m+=String.fromCharCode(B>>>10&1023|55296),B=56320|1023&B),m+=String.fromCharCode(B),x+=V}return m}(this.buf,t,e)},readBytes:function(){var e=this.readVarint()+this.pos,t=this.buf.subarray(this.pos,e);return this.pos=e,t},readPackedVarint:function(e,t){if(this.type!==Ur.Bytes)return e.push(this.readVarint(t));var i=zo(this);for(e=e||[];this.pos<i;)e.push(this.readVarint(t));return e},readPackedSVarint:function(e){if(this.type!==Ur.Bytes)return e.push(this.readSVarint());var t=zo(this);for(e=e||[];this.pos<t;)e.push(this.readSVarint());return e},readPackedBoolean:function(e){if(this.type!==Ur.Bytes)return e.push(this.readBoolean());var t=zo(this);for(e=e||[];this.pos<t;)e.push(this.readBoolean());return e},readPackedFloat:function(e){if(this.type!==Ur.Bytes)return e.push(this.readFloat());var t=zo(this);for(e=e||[];this.pos<t;)e.push(this.readFloat());return e},readPackedDouble:function(e){if(this.type!==Ur.Bytes)return e.push(this.readDouble());var t=zo(this);for(e=e||[];this.pos<t;)e.push(this.readDouble());return e},readPackedFixed32:function(e){if(this.type!==Ur.Bytes)return e.push(this.readFixed32());var t=zo(this);for(e=e||[];this.pos<t;)e.push(this.readFixed32());return e},readPackedSFixed32:function(e){if(this.type!==Ur.Bytes)return e.push(this.readSFixed32());var t=zo(this);for(e=e||[];this.pos<t;)e.push(this.readSFixed32());return e},readPackedFixed64:function(e){if(this.type!==Ur.Bytes)return e.push(this.readFixed64());var t=zo(this);for(e=e||[];this.pos<t;)e.push(this.readFixed64());return e},readPackedSFixed64:function(e){if(this.type!==Ur.Bytes)return e.push(this.readSFixed64());var t=zo(this);for(e=e||[];this.pos<t;)e.push(this.readSFixed64());return e},skip:function(e){var t=7&e;if(t===Ur.Varint)for(;this.buf[this.pos++]>127;);else if(t===Ur.Bytes)this.pos=this.readVarint()+this.pos;else if(t===Ur.Fixed32)this.pos+=4;else{if(t!==Ur.Fixed64)throw new Error("Unimplemented type: "+t);this.pos+=8}},writeTag:function(e,t){this.writeVarint(e<<3|t)},realloc:function(e){for(var t=this.length||16;t<this.pos+e;)t*=2;if(t!==this.length){var i=new Uint8Array(t);i.set(this.buf),this.buf=i,this.length=t}},finish:function(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)},writeFixed32:function(e){this.realloc(4),ul(this.buf,e,this.pos),this.pos+=4},writeSFixed32:function(e){this.realloc(4),ul(this.buf,e,this.pos),this.pos+=4},writeFixed64:function(e){this.realloc(8),ul(this.buf,-1&e,this.pos),ul(this.buf,Math.floor(e*(1/4294967296)),this.pos+4),this.pos+=8},writeSFixed64:function(e){this.realloc(8),ul(this.buf,-1&e,this.pos),ul(this.buf,Math.floor(e*(1/4294967296)),this.pos+4),this.pos+=8},writeVarint:function(e){(e=+e||0)>268435455||e<0?function(t,i){var u,f;if(t>=0?(u=t%4294967296|0,f=t/4294967296|0):(f=~(-t/4294967296),4294967295^(u=~(-t%4294967296))?u=u+1|0:(u=0,f=f+1|0)),t>=18446744073709552e3||t<-18446744073709552e3)throw new Error("Given varint doesn't fit into 10 bytes");i.realloc(10),function(m,x,k){k.buf[k.pos++]=127&m|128,m>>>=7,k.buf[k.pos++]=127&m|128,m>>>=7,k.buf[k.pos++]=127&m|128,m>>>=7,k.buf[k.pos++]=127&m|128,k.buf[k.pos]=127&(m>>>=7)}(u,0,i),function(m,x){var k=(7&m)<<4;x.buf[x.pos++]|=k|((m>>>=3)?128:0),m&&(x.buf[x.pos++]=127&m|((m>>>=7)?128:0),m&&(x.buf[x.pos++]=127&m|((m>>>=7)?128:0),m&&(x.buf[x.pos++]=127&m|((m>>>=7)?128:0),m&&(x.buf[x.pos++]=127&m|((m>>>=7)?128:0),m&&(x.buf[x.pos++]=127&m)))))}(f,i)}(e,this):(this.realloc(4),this.buf[this.pos++]=127&e|(e>127?128:0),e<=127||(this.buf[this.pos++]=127&(e>>>=7)|(e>127?128:0),e<=127||(this.buf[this.pos++]=127&(e>>>=7)|(e>127?128:0),e<=127||(this.buf[this.pos++]=e>>>7&127))))},writeSVarint:function(e){this.writeVarint(e<0?2*-e-1:2*e)},writeBoolean:function(e){this.writeVarint(!!e)},writeString:function(e){e=String(e),this.realloc(4*e.length),this.pos++;var t=this.pos;this.pos=function(u,f,m){for(var x,k,A=0;A<f.length;A++){if((x=f.charCodeAt(A))>55295&&x<57344){if(!k){x>56319||A+1===f.length?(u[m++]=239,u[m++]=191,u[m++]=189):k=x;continue}if(x<56320){u[m++]=239,u[m++]=191,u[m++]=189,k=x;continue}x=k-55296<<10|x-56320|65536,k=null}else k&&(u[m++]=239,u[m++]=191,u[m++]=189,k=null);x<128?u[m++]=x:(x<2048?u[m++]=x>>6|192:(x<65536?u[m++]=x>>12|224:(u[m++]=x>>18|240,u[m++]=x>>12&63|128),u[m++]=x>>6&63|128),u[m++]=63&x|128)}return m}(this.buf,e,this.pos);var i=this.pos-t;i>=128&&mf(t,i,this),this.pos=t-1,this.writeVarint(i),this.pos+=i},writeFloat:function(e){this.realloc(4),ff(this.buf,e,this.pos,!0,23,4),this.pos+=4},writeDouble:function(e){this.realloc(8),ff(this.buf,e,this.pos,!0,52,8),this.pos+=8},writeBytes:function(e){var t=e.length;this.writeVarint(t),this.realloc(t);for(var i=0;i<t;i++)this.buf[this.pos++]=e[i]},writeRawMessage:function(e,t){this.pos++;var i=this.pos;e(t,this);var u=this.pos-i;u>=128&&mf(i,u,this),this.pos=i-1,this.writeVarint(u),this.pos+=u},writeMessage:function(e,t,i){this.writeTag(e,Ur.Bytes),this.writeRawMessage(t,i)},writePackedVarint:function(e,t){t.length&&this.writeMessage(e,dg,t)},writePackedSVarint:function(e,t){t.length&&this.writeMessage(e,mg,t)},writePackedBoolean:function(e,t){t.length&&this.writeMessage(e,_g,t)},writePackedFloat:function(e,t){t.length&&this.writeMessage(e,yg,t)},writePackedDouble:function(e,t){t.length&&this.writeMessage(e,gg,t)},writePackedFixed32:function(e,t){t.length&&this.writeMessage(e,vg,t)},writePackedSFixed32:function(e,t){t.length&&this.writeMessage(e,bg,t)},writePackedFixed64:function(e,t){t.length&&this.writeMessage(e,xg,t)},writePackedSFixed64:function(e,t){t.length&&this.writeMessage(e,wg,t)},writeBytesField:function(e,t){this.writeTag(e,Ur.Bytes),this.writeBytes(t)},writeFixed32Field:function(e,t){this.writeTag(e,Ur.Fixed32),this.writeFixed32(t)},writeSFixed32Field:function(e,t){this.writeTag(e,Ur.Fixed32),this.writeSFixed32(t)},writeFixed64Field:function(e,t){this.writeTag(e,Ur.Fixed64),this.writeFixed64(t)},writeSFixed64Field:function(e,t){this.writeTag(e,Ur.Fixed64),this.writeSFixed64(t)},writeVarintField:function(e,t){this.writeTag(e,Ur.Varint),this.writeVarint(t)},writeSVarintField:function(e,t){this.writeTag(e,Ur.Varint),this.writeSVarint(t)},writeStringField:function(e,t){this.writeTag(e,Ur.Bytes),this.writeString(t)},writeFloatField:function(e,t){this.writeTag(e,Ur.Fixed32),this.writeFloat(t)},writeDoubleField:function(e,t){this.writeTag(e,Ur.Fixed64),this.writeDouble(t)},writeBooleanField:function(e,t){this.writeVarintField(e,!!t)}};var Lc=function(e,t){var i=t.pixelRatio,u=t.version,f=t.stretchX,m=t.stretchY,x=t.content;this.paddedRect=e,this.pixelRatio=i,this.stretchX=f,this.stretchY=m,this.content=x,this.version=u},yu={tl:{configurable:!0},br:{configurable:!0},tlbr:{configurable:!0},displaySize:{configurable:!0}};yu.tl.get=function(){return[this.paddedRect.x+1,this.paddedRect.y+1]},yu.br.get=function(){return[this.paddedRect.x+this.paddedRect.w-1,this.paddedRect.y+this.paddedRect.h-1]},yu.tlbr.get=function(){return this.tl.concat(this.br)},yu.displaySize.get=function(){return[(this.paddedRect.w-2)/this.pixelRatio,(this.paddedRect.h-2)/this.pixelRatio]},Object.defineProperties(Lc.prototype,yu);var gu=function(e,t){var i={},u={};this.haveRenderCallbacks=[];var f=[];this.addImages(e,i,f),this.addImages(t,u,f);var m=gf(f),x=new Kn({width:m.w||1,height:m.h||1});for(var k in e){var A=e[k],z=i[k].paddedRect;Kn.copy(A.data,x,{x:0,y:0},{x:z.x+1,y:z.y+1},A.data)}for(var D in t){var B=t[D],V=u[D].paddedRect,j=V.x+1,Q=V.y+1,$=B.data.width,pe=B.data.height;Kn.copy(B.data,x,{x:0,y:0},{x:j,y:Q},B.data),Kn.copy(B.data,x,{x:0,y:pe-1},{x:j,y:Q-1},{width:$,height:1}),Kn.copy(B.data,x,{x:0,y:0},{x:j,y:Q+pe},{width:$,height:1}),Kn.copy(B.data,x,{x:$-1,y:0},{x:j-1,y:Q},{width:1,height:pe}),Kn.copy(B.data,x,{x:0,y:0},{x:j+$,y:Q},{width:1,height:pe})}this.image=x,this.iconPositions=i,this.patternPositions=u};gu.prototype.addImages=function(e,t,i){for(var u in e){var f=e[u],m={x:0,y:0,w:f.data.width+2,h:f.data.height+2};i.push(m),t[u]=new Lc(m,f),f.hasRenderCallback&&this.haveRenderCallbacks.push(u)}},gu.prototype.patchUpdatedImages=function(e,t){for(var i in e.dispatchRenderCallbacks(this.haveRenderCallbacks),e.updatedImages)this.patchUpdatedImage(this.iconPositions[i],e.getImage(i),t),this.patchUpdatedImage(this.patternPositions[i],e.getImage(i),t)},gu.prototype.patchUpdatedImage=function(e,t,i){if(e&&t&&e.version!==t.version){e.version=t.version;var u=e.tl;i.update(t.data,void 0,{x:u[0],y:u[1]})}},mt("ImagePosition",Lc),mt("ImageAtlas",gu);var sa={horizontal:1,vertical:2,horizontalOnly:3},cl=function(){this.scale=1,this.fontStack="",this.imageName=null};cl.forText=function(e,t){var i=new cl;return i.scale=e||1,i.fontStack=t,i},cl.forImage=function(e){var t=new cl;return t.imageName=e,t};var bn=function(){this.text="",this.sectionIndex=[],this.sections=[],this.imageSectionID=null};function Rc(e,t,i,u,f,m,x,k,A,z,D,B,V,j,Q,$){var pe,oe=bn.fromFeature(e,f);B===sa.vertical&&oe.verticalizePunctuation();var ye=$n.processBidirectionalText,xe=$n.processStyledBidirectionalText;if(ye&&oe.sections.length===1){pe=[];for(var Se=0,Te=ye(oe.toString(),ap(oe,z,m,t,u,j,Q));Se<Te.length;Se+=1){var Me=Te[Se],Xe=new bn;Xe.text=Me,Xe.sections=oe.sections;for(var rt=0;rt<Me.length;rt++)Xe.sectionIndex.push(0);pe.push(Xe)}}else if(xe){pe=[];for(var wt=0,ut=xe(oe.text,oe.sectionIndex,ap(oe,z,m,t,u,j,Q));wt<ut.length;wt+=1){var It=ut[wt],ht=new bn;ht.text=It[0],ht.sectionIndex=It[1],ht.sections=oe.sections,pe.push(ht)}}else pe=function(vt,sr){for(var Kt=[],yr=vt.text,At=0,xr=0,Jr=sr;xr<Jr.length;xr+=1){var li=Jr[xr];Kt.push(vt.substring(At,li)),At=li}return At<yr.length&&Kt.push(vt.substring(At,yr.length)),Kt}(oe,ap(oe,z,m,t,u,j,Q));var $t=[],Bt={positionedLines:$t,text:oe.toString(),top:D[1],bottom:D[1],left:D[0],right:D[0],writingMode:B,iconsInText:!1,verticalizable:!1};return function(vt,sr,Kt,yr,At,xr,Jr,li,ii,Qr,ui,Ni){for(var Vi=0,xn=-17,Wi=0,wn=0,mi=li==="right"?1:li==="left"?0:.5,Yi=0,hr=0,Rr=At;hr<Rr.length;hr+=1){var Pr=Rr[hr];Pr.trim();var _r=Pr.getMaxScale(),Ln=24*(_r-1),fn={positionedGlyphs:[],lineOffset:0};vt.positionedLines[Yi]=fn;var Zr=fn.positionedGlyphs,Si=0;if(Pr.length()){for(var dn=0;dn<Pr.length();dn++){var wr=Pr.getSection(dn),to=Pr.getSectionIndex(dn),la=Pr.getCharCode(dn),ro=0,yi=null,io=null,Pa=null,_l=24,Ps=!(ii===sa.horizontal||!ui&&!Ws(la)||ui&&(Bc[la]||(Do=la,at.Arabic(Do)||at["Arabic Supplement"](Do)||at["Arabic Extended-A"](Do)||at["Arabic Presentation Forms-A"](Do)||at["Arabic Presentation Forms-B"](Do))));if(wr.imageName){var vl=yr[wr.imageName];if(!vl)continue;Pa=wr.imageName,vt.iconsInText=vt.iconsInText||!0,io=vl.paddedRect;var Mo=vl.displaySize;wr.scale=24*wr.scale/Ni,ro=Ln+(24-Mo[1]*wr.scale),_l=(yi={width:Mo[0],height:Mo[1],left:1,top:-3,advance:Ps?Mo[1]:Mo[0]}).advance;var bl=Ps?Mo[0]*wr.scale-24*_r:Mo[1]*wr.scale-24*_r;bl>0&&bl>Si&&(Si=bl)}else{var Zc=Kt[wr.fontStack],xl=Zc&&Zc[la];if(xl&&xl.rect)io=xl.rect,yi=xl.metrics;else{var bu=sr[wr.fontStack],Kc=bu&&bu[la];if(!Kc)continue;yi=Kc.metrics}ro=24*(_r-wr.scale)}Ps?(vt.verticalizable=!0,Zr.push({glyph:la,imageName:Pa,x:Vi,y:xn+ro,vertical:Ps,scale:wr.scale,fontStack:wr.fontStack,sectionIndex:to,metrics:yi,rect:io}),Vi+=_l*wr.scale+Qr):(Zr.push({glyph:la,imageName:Pa,x:Vi,y:xn+ro,vertical:Ps,scale:wr.scale,fontStack:wr.fontStack,sectionIndex:to,metrics:yi,rect:io}),Vi+=yi.advance*wr.scale+Qr)}Zr.length!==0&&(Wi=Math.max(Vi-Qr,Wi),Ig(Zr,0,Zr.length-1,mi,Si)),Vi=0;var Hc=xr*_r+Si;fn.lineOffset=Math.max(Si,Ln),xn+=Hc,wn=Math.max(Hc,wn),++Yi}else xn+=xr,++Yi}var Do,xu=xn- -17,wl=op(Jr),Qo=wl.horizontalAlign,Sl=wl.verticalAlign;(function(Xc,Wc,wu,Su,Yc,ku,Eu,Tu,Jc){var kl,Qc=(Wc-wu)*Yc;kl=ku!==Eu?-Tu*Su- -17:(-Su*Jc+.5)*Eu;for(var El=0,Iu=Xc;El<Iu.length;El+=1)for(var Cs=0,Au=Iu[El].positionedGlyphs;Cs<Au.length;Cs+=1){var Tl=Au[Cs];Tl.x+=Qc,Tl.y+=kl}})(vt.positionedLines,mi,Qo,Sl,Wi,wn,xr,xu,At.length),vt.top+=-Sl*xu,vt.bottom=vt.top+xu,vt.left+=-Qo*Wi,vt.right=vt.left+Wi}(Bt,t,i,u,pe,x,k,A,B,z,V,$),!function(vt){for(var sr=0,Kt=vt;sr<Kt.length;sr+=1)if(Kt[sr].positionedGlyphs.length!==0)return!1;return!0}($t)&&Bt}bn.fromFeature=function(e,t){for(var i=new bn,u=0;u<e.sections.length;u++){var f=e.sections[u];f.image?i.addImageSection(f):i.addTextSection(f,t)}return i},bn.prototype.length=function(){return this.text.length},bn.prototype.getSection=function(e){return this.sections[this.sectionIndex[e]]},bn.prototype.getSectionIndex=function(e){return this.sectionIndex[e]},bn.prototype.getCharCode=function(e){return this.text.charCodeAt(e)},bn.prototype.verticalizePunctuation=function(){this.text=function(e){for(var t="",i=0;i<e.length;i++){var u=e.charCodeAt(i+1)||null,f=e.charCodeAt(i-1)||null;t+=u&&eu(u)&&!mu[e[i+1]]||f&&eu(f)&&!mu[e[i-1]]||!mu[e[i]]?e[i]:mu[e[i]]}return t}(this.text)},bn.prototype.trim=function(){for(var e=0,t=0;t<this.text.length&&Bc[this.text.charCodeAt(t)];t++)e++;for(var i=this.text.length,u=this.text.length-1;u>=0&&u>=e&&Bc[this.text.charCodeAt(u)];u--)i--;this.text=this.text.substring(e,i),this.sectionIndex=this.sectionIndex.slice(e,i)},bn.prototype.substring=function(e,t){var i=new bn;return i.text=this.text.substring(e,t),i.sectionIndex=this.sectionIndex.slice(e,t),i.sections=this.sections,i},bn.prototype.toString=function(){return this.text},bn.prototype.getMaxScale=function(){var e=this;return this.sectionIndex.reduce(function(t,i){return Math.max(t,e.sections[i].scale)},0)},bn.prototype.addTextSection=function(e,t){this.text+=e.text,this.sections.push(cl.forText(e.scale,e.fontStack||t));for(var i=this.sections.length-1,u=0;u<e.text.length;++u)this.sectionIndex.push(i)},bn.prototype.addImageSection=function(e){var t=e.image?e.image.name:"";if(t.length!==0){var i=this.getNextImageSectionCharCode();i?(this.text+=String.fromCharCode(i),this.sections.push(cl.forImage(t)),this.sectionIndex.push(this.sections.length-1)):je("Reached maximum number of images 6401")}else je("Can't add FormattedSection with an empty image.")},bn.prototype.getNextImageSectionCharCode=function(){return this.imageSectionID?this.imageSectionID>=63743?null:++this.imageSectionID:(this.imageSectionID=57344,this.imageSectionID)};var Bc={9:!0,10:!0,11:!0,12:!0,13:!0,32:!0},ta={};function _f(e,t,i,u,f,m){if(t.imageName){var x=u[t.imageName];return x?x.displaySize[0]*t.scale*24/m+f:0}var k=i[t.fontStack],A=k&&k[e];return A?A.metrics.advance*t.scale+f:0}function vf(e,t,i,u){var f=Math.pow(e-t,2);return u?e<t?f/2:2*f:f+Math.abs(i)*i}function Tg(e,t,i){var u=0;return e===10&&(u-=1e4),i&&(u+=150),e!==40&&e!==65288||(u+=50),t!==41&&t!==65289||(u+=50),u}function bf(e,t,i,u,f,m){for(var x=null,k=vf(t,i,f,m),A=0,z=u;A<z.length;A+=1){var D=z[A],B=vf(t-D.x,i,f,m)+D.badness;B<=k&&(x=D,k=B)}return{index:e,x:t,priorBreak:x,badness:k}}function ap(e,t,i,u,f,m,x){if(m!=="point")return[];if(!e)return[];for(var k,A=[],z=function(pe,oe,ye,xe,Se,Te){for(var Me=0,Xe=0;Xe<pe.length();Xe++){var rt=pe.getSection(Xe);Me+=_f(pe.getCharCode(Xe),rt,xe,Se,oe,Te)}return Me/Math.max(1,Math.ceil(Me/ye))}(e,t,i,u,f,x),D=e.text.indexOf("")>=0,B=0,V=0;V<e.length();V++){var j=e.getSection(V),Q=e.getCharCode(V);if(Bc[Q]||(B+=_f(Q,j,u,f,t,x)),V<e.length()-1){var $=!((k=Q)<11904||!(at["Bopomofo Extended"](k)||at.Bopomofo(k)||at["CJK Compatibility Forms"](k)||at["CJK Compatibility Ideographs"](k)||at["CJK Compatibility"](k)||at["CJK Radicals Supplement"](k)||at["CJK Strokes"](k)||at["CJK Symbols and Punctuation"](k)||at["CJK Unified Ideographs Extension A"](k)||at["CJK Unified Ideographs"](k)||at["Enclosed CJK Letters and Months"](k)||at["Halfwidth and Fullwidth Forms"](k)||at.Hiragana(k)||at["Ideographic Description Characters"](k)||at["Kangxi Radicals"](k)||at["Katakana Phonetic Extensions"](k)||at.Katakana(k)||at["Vertical Forms"](k)||at["Yi Radicals"](k)||at["Yi Syllables"](k)));(ta[Q]||$||j.imageName)&&A.push(bf(V+1,B,z,A,Tg(Q,e.getCharCode(V+1),$&&D),!1))}}return function pe(oe){return oe?pe(oe.priorBreak).concat(oe.index):[]}(bf(e.length(),B,z,A,0,!0))}function op(e){var t=.5,i=.5;switch(e){case"right":case"top-right":case"bottom-right":t=1;break;case"left":case"top-left":case"bottom-left":t=0}switch(e){case"bottom":case"bottom-right":case"bottom-left":i=1;break;case"top":case"top-right":case"top-left":i=0}return{horizontalAlign:t,verticalAlign:i}}function Ig(e,t,i,u,f){if(u||f)for(var m=e[i],x=(e[i].x+m.metrics.advance*m.scale)*u,k=t;k<=i;k++)e[k].x-=x,e[k].y+=f}function xf(e,t,i,u,f,m){var x,k=e.image;if(k.content){var A=k.content,z=k.pixelRatio||1;x=[A[0]/z,A[1]/z,k.displaySize[0]-A[2]/z,k.displaySize[1]-A[3]/z]}var D,B,V,j,Q=t.left*m,$=t.right*m;i==="width"||i==="both"?(j=f[0]+Q-u[3],B=f[0]+$+u[1]):B=(j=f[0]+(Q+$-k.displaySize[0])/2)+k.displaySize[0];var pe=t.top*m,oe=t.bottom*m;return i==="height"||i==="both"?(D=f[1]+pe-u[0],V=f[1]+oe+u[2]):V=(D=f[1]+(pe+oe-k.displaySize[1])/2)+k.displaySize[1],{image:k,top:D,right:B,bottom:V,left:j,collisionPadding:x}}ta[10]=!0,ta[32]=!0,ta[38]=!0,ta[40]=!0,ta[41]=!0,ta[43]=!0,ta[45]=!0,ta[47]=!0,ta[173]=!0,ta[183]=!0,ta[8203]=!0,ta[8208]=!0,ta[8211]=!0,ta[8231]=!0;var hl=function(e){function t(i,u,f,m){e.call(this,i,u),this.angle=f,m!==void 0&&(this.segment=m)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.clone=function(){return new t(this.x,this.y,this.angle,this.segment)},t}(F);function sp(e,t){var i=t.expression;if(i.kind==="constant")return{kind:"constant",layoutSize:i.evaluate(new lr(e+1))};if(i.kind==="source")return{kind:"source"};for(var u=i.zoomStops,f=i.interpolationType,m=0;m<u.length&&u[m]<=e;)m++;for(var x=m=Math.max(0,m-1);x<u.length&&u[x]<e+1;)x++;x=Math.min(u.length-1,x);var k=u[m],A=u[x];return i.kind==="composite"?{kind:"composite",minZoom:k,maxZoom:A,interpolationType:f}:{kind:"camera",minZoom:k,maxZoom:A,minSize:i.evaluate(new lr(k)),maxSize:i.evaluate(new lr(A)),interpolationType:f}}function wf(e,t,i){var u=t.uSize,f=i.lowerSize;return e.kind==="source"?f/128:e.kind==="composite"?xi(f/128,i.upperSize/128,t.uSizeT):u}function Sf(e,t){var i=0,u=0;if(e.kind==="constant")u=e.layoutSize;else if(e.kind!=="source"){var f=e.interpolationType,m=f?he(tn.interpolationFactor(f,t,e.minZoom,e.maxZoom),0,1):0;e.kind==="camera"?u=xi(e.minSize,e.maxSize,m):i=m}return{uSizeT:i,uSize:u}}mt("Anchor",hl);var Ag=Object.freeze({__proto__:null,getSizeData:sp,evaluateSizeForFeature:wf,evaluateSizeForZoom:Sf,SIZE_PACK_FACTOR:128});function kf(e,t,i,u,f){if(t.segment===void 0)return!0;for(var m=t,x=t.segment+1,k=0;k>-i/2;){if(--x<0)return!1;k-=e[x].dist(m),m=e[x]}k+=e[x].dist(e[x+1]),x++;for(var A=[],z=0;k<i/2;){var D=e[x],B=e[x+1];if(!B)return!1;var V=e[x-1].angleTo(D)-D.angleTo(B);for(V=Math.abs((V+3*Math.PI)%(2*Math.PI)-Math.PI),A.push({distance:k,angleDelta:V}),z+=V;k-A[0].distance>u;)z-=A.shift().angleDelta;if(z>f)return!1;x++,k+=D.dist(B)}return!0}function Ef(e){for(var t=0,i=0;i<e.length-1;i++)t+=e[i].dist(e[i+1]);return t}function Tf(e,t,i){return e?.6*t*i:0}function If(e,t){return Math.max(e?e.right-e.left:0,t?t.right-t.left:0)}function zg(e,t,i,u,f,m){for(var x=Tf(i,f,m),k=If(i,u)*m,A=0,z=Ef(e)/2,D=0;D<e.length-1;D++){var B=e[D],V=e[D+1],j=B.dist(V);if(A+j>z){var Q=(z-A)/j,$=xi(B.x,V.x,Q),pe=xi(B.y,V.y,Q),oe=new hl($,pe,V.angleTo(B),D);return oe._round(),!x||kf(e,oe,k,x,t)?oe:void 0}A+=j}}function Pg(e,t,i,u,f,m,x,k,A){var z=Tf(u,m,x),D=If(u,f),B=D*x,V=e[0].x===0||e[0].x===A||e[0].y===0||e[0].y===A;return t-B<t/4&&(t=B+t/4),function j(Q,$,pe,oe,ye,xe,Se,Te,Me){for(var Xe=xe/2,rt=Ef(Q),wt=0,ut=$-pe,It=[],ht=0;ht<Q.length-1;ht++){for(var $t=Q[ht],Bt=Q[ht+1],vt=$t.dist(Bt),sr=Bt.angleTo($t);ut+pe<wt+vt;){var Kt=((ut+=pe)-wt)/vt,yr=xi($t.x,Bt.x,Kt),At=xi($t.y,Bt.y,Kt);if(yr>=0&&yr<Me&&At>=0&&At<Me&&ut-Xe>=0&&ut+Xe<=rt){var xr=new hl(yr,At,sr,ht);xr._round(),oe&&!kf(Q,xr,xe,oe,ye)||It.push(xr)}}wt+=vt}return Te||It.length||Se||(It=j(Q,wt/2,pe,oe,ye,xe,Se,!0,Me)),It}(e,V?t/2*k%t:(D/2+2*m)*x*k%t,t,z,i,B,V,!1,A)}function Af(e,t,i,u,f){for(var m=[],x=0;x<e.length;x++)for(var k=e[x],A=void 0,z=0;z<k.length-1;z++){var D=k[z],B=k[z+1];D.x<t&&B.x<t||(D.x<t?D=new F(t,D.y+(t-D.x)/(B.x-D.x)*(B.y-D.y))._round():B.x<t&&(B=new F(t,D.y+(t-D.x)/(B.x-D.x)*(B.y-D.y))._round()),D.y<i&&B.y<i||(D.y<i?D=new F(D.x+(i-D.y)/(B.y-D.y)*(B.x-D.x),i)._round():B.y<i&&(B=new F(D.x+(i-D.y)/(B.y-D.y)*(B.x-D.x),i)._round()),D.x>=u&&B.x>=u||(D.x>=u?D=new F(u,D.y+(u-D.x)/(B.x-D.x)*(B.y-D.y))._round():B.x>=u&&(B=new F(u,D.y+(u-D.x)/(B.x-D.x)*(B.y-D.y))._round()),D.y>=f&&B.y>=f||(D.y>=f?D=new F(D.x+(f-D.y)/(B.y-D.y)*(B.x-D.x),f)._round():B.y>=f&&(B=new F(D.x+(f-D.y)/(B.y-D.y)*(B.x-D.x),f)._round()),A&&D.equals(A[A.length-1])||m.push(A=[D]),A.push(B)))))}return m}function zf(e,t,i,u){var f=[],m=e.image,x=m.pixelRatio,k=m.paddedRect.w-2,A=m.paddedRect.h-2,z=e.right-e.left,D=e.bottom-e.top,B=m.stretchX||[[0,k]],V=m.stretchY||[[0,A]],j=function(yr,At){return yr+At[1]-At[0]},Q=B.reduce(j,0),$=V.reduce(j,0),pe=k-Q,oe=A-$,ye=0,xe=Q,Se=0,Te=$,Me=0,Xe=pe,rt=0,wt=oe;if(m.content&&u){var ut=m.content;ye=Oc(B,0,ut[0]),Se=Oc(V,0,ut[1]),xe=Oc(B,ut[0],ut[2]),Te=Oc(V,ut[1],ut[3]),Me=ut[0]-ye,rt=ut[1]-Se,Xe=ut[2]-ut[0]-xe,wt=ut[3]-ut[1]-Te}var It=function(yr,At,xr,Jr){var li=Fc(yr.stretch-ye,xe,z,e.left),ii=Nc(yr.fixed-Me,Xe,yr.stretch,Q),Qr=Fc(At.stretch-Se,Te,D,e.top),ui=Nc(At.fixed-rt,wt,At.stretch,$),Ni=Fc(xr.stretch-ye,xe,z,e.left),Vi=Nc(xr.fixed-Me,Xe,xr.stretch,Q),xn=Fc(Jr.stretch-Se,Te,D,e.top),Wi=Nc(Jr.fixed-rt,wt,Jr.stretch,$),wn=new F(li,Qr),mi=new F(Ni,Qr),Yi=new F(Ni,xn),hr=new F(li,xn),Rr=new F(ii/x,ui/x),Pr=new F(Vi/x,Wi/x),_r=t*Math.PI/180;if(_r){var Ln=Math.sin(_r),fn=Math.cos(_r),Zr=[fn,-Ln,Ln,fn];wn._matMult(Zr),mi._matMult(Zr),hr._matMult(Zr),Yi._matMult(Zr)}var Si=yr.stretch+yr.fixed,dn=At.stretch+At.fixed;return{tl:wn,tr:mi,bl:hr,br:Yi,tex:{x:m.paddedRect.x+1+Si,y:m.paddedRect.y+1+dn,w:xr.stretch+xr.fixed-Si,h:Jr.stretch+Jr.fixed-dn},writingMode:void 0,glyphOffset:[0,0],sectionIndex:0,pixelOffsetTL:Rr,pixelOffsetBR:Pr,minFontScaleX:Xe/x/z,minFontScaleY:wt/x/D,isSDF:i}};if(u&&(m.stretchX||m.stretchY))for(var ht=Pf(B,pe,Q),$t=Pf(V,oe,$),Bt=0;Bt<ht.length-1;Bt++)for(var vt=ht[Bt],sr=ht[Bt+1],Kt=0;Kt<$t.length-1;Kt++)f.push(It(vt,$t[Kt],sr,$t[Kt+1]));else f.push(It({fixed:0,stretch:-1},{fixed:0,stretch:-1},{fixed:0,stretch:k+1},{fixed:0,stretch:A+1}));return f}function Oc(e,t,i){for(var u=0,f=0,m=e;f<m.length;f+=1){var x=m[f];u+=Math.max(t,Math.min(i,x[1]))-Math.max(t,Math.min(i,x[0]))}return u}function Pf(e,t,i){for(var u=[{fixed:-1,stretch:0}],f=0,m=e;f<m.length;f+=1){var x=m[f],k=x[0],A=x[1],z=u[u.length-1];u.push({fixed:k-z.stretch,stretch:z.stretch}),u.push({fixed:k-z.stretch,stretch:z.stretch+(A-k)})}return u.push({fixed:t+1,stretch:i}),u}function Fc(e,t,i,u){return e/t*i+u}function Nc(e,t,i,u){return e-t*i/u}var Vc=function(e,t,i,u,f,m,x,k,A,z){if(this.boxStartIndex=e.length,A){var D=m.top,B=m.bottom,V=m.collisionPadding;V&&(D-=V[1],B+=V[3]);var j=B-D;j>0&&(j=Math.max(10,j),this.circleDiameter=j)}else{var Q=m.top*x-k,$=m.bottom*x+k,pe=m.left*x-k,oe=m.right*x+k,ye=m.collisionPadding;if(ye&&(pe-=ye[0]*x,Q-=ye[1]*x,oe+=ye[2]*x,$+=ye[3]*x),z){var xe=new F(pe,Q),Se=new F(oe,Q),Te=new F(pe,$),Me=new F(oe,$),Xe=z*Math.PI/180;xe._rotate(Xe),Se._rotate(Xe),Te._rotate(Xe),Me._rotate(Xe),pe=Math.min(xe.x,Se.x,Te.x,Me.x),oe=Math.max(xe.x,Se.x,Te.x,Me.x),Q=Math.min(xe.y,Se.y,Te.y,Me.y),$=Math.max(xe.y,Se.y,Te.y,Me.y)}e.emplaceBack(t.x,t.y,pe,Q,oe,$,i,u,f)}this.boxEndIndex=e.length},pl=function(e,t){if(e===void 0&&(e=[]),t===void 0&&(t=Cg),this.data=e,this.length=this.data.length,this.compare=t,this.length>0)for(var i=(this.length>>1)-1;i>=0;i--)this._down(i)};function Cg(e,t){return e<t?-1:e>t?1:0}function Mg(e,t,i){t===void 0&&(t=1),i===void 0&&(i=!1);for(var u=1/0,f=1/0,m=-1/0,x=-1/0,k=e[0],A=0;A<k.length;A++){var z=k[A];(!A||z.x<u)&&(u=z.x),(!A||z.y<f)&&(f=z.y),(!A||z.x>m)&&(m=z.x),(!A||z.y>x)&&(x=z.y)}var D=Math.min(m-u,x-f),B=D/2,V=new pl([],Dg);if(D===0)return new F(u,f);for(var j=u;j<m;j+=D)for(var Q=f;Q<x;Q+=D)V.push(new fl(j+B,Q+B,B,e));for(var $=function(ye){for(var xe=0,Se=0,Te=0,Me=ye[0],Xe=0,rt=Me.length,wt=rt-1;Xe<rt;wt=Xe++){var ut=Me[Xe],It=Me[wt],ht=ut.x*It.y-It.x*ut.y;Se+=(ut.x+It.x)*ht,Te+=(ut.y+It.y)*ht,xe+=3*ht}return new fl(Se/xe,Te/xe,0,ye)}(e),pe=V.length;V.length;){var oe=V.pop();(oe.d>$.d||!$.d)&&($=oe,i&&console.log("found best %d after %d probes",Math.round(1e4*oe.d)/1e4,pe)),oe.max-$.d<=t||(V.push(new fl(oe.p.x-(B=oe.h/2),oe.p.y-B,B,e)),V.push(new fl(oe.p.x+B,oe.p.y-B,B,e)),V.push(new fl(oe.p.x-B,oe.p.y+B,B,e)),V.push(new fl(oe.p.x+B,oe.p.y+B,B,e)),pe+=4)}return i&&(console.log("num probes: "+pe),console.log("best distance: "+$.d)),$.p}function Dg(e,t){return t.max-e.max}function fl(e,t,i,u){this.p=new F(e,t),this.h=i,this.d=function(f,m){for(var x=!1,k=1/0,A=0;A<m.length;A++)for(var z=m[A],D=0,B=z.length,V=B-1;D<B;V=D++){var j=z[D],Q=z[V];j.y>f.y!=Q.y>f.y&&f.x<(Q.x-j.x)*(f.y-j.y)/(Q.y-j.y)+j.x&&(x=!x),k=Math.min(k,Xo(f,j,Q))}return(x?1:-1)*Math.sqrt(k)}(this.p,u),this.max=this.d+this.h*Math.SQRT2}pl.prototype.push=function(e){this.data.push(e),this.length++,this._up(this.length-1)},pl.prototype.pop=function(){if(this.length!==0){var e=this.data[0],t=this.data.pop();return this.length--,this.length>0&&(this.data[0]=t,this._down(0)),e}},pl.prototype.peek=function(){return this.data[0]},pl.prototype._up=function(e){for(var t=this.data,i=this.compare,u=t[e];e>0;){var f=e-1>>1,m=t[f];if(i(u,m)>=0)break;t[e]=m,e=f}t[e]=u},pl.prototype._down=function(e){for(var t=this.data,i=this.compare,u=this.length>>1,f=t[e];e<u;){var m=1+(e<<1),x=t[m],k=m+1;if(k<this.length&&i(t[k],x)<0&&(m=k,x=t[k]),i(x,f)>=0)break;t[e]=x,e=m}t[e]=f};var lp=Number.POSITIVE_INFINITY;function Cf(e,t){return t[1]!==lp?function(i,u,f){var m=0,x=0;switch(u=Math.abs(u),f=Math.abs(f),i){case"top-right":case"top-left":case"top":x=f-7;break;case"bottom-right":case"bottom-left":case"bottom":x=7-f}switch(i){case"top-right":case"bottom-right":case"right":m=-u;break;case"top-left":case"bottom-left":case"left":m=u}return[m,x]}(e,t[0],t[1]):function(i,u){var f=0,m=0;u<0&&(u=0);var x=u/Math.sqrt(2);switch(i){case"top-right":case"top-left":m=x-7;break;case"bottom-right":case"bottom-left":m=7-x;break;case"bottom":m=7-u;break;case"top":m=u-7}switch(i){case"top-right":case"bottom-right":f=-x;break;case"top-left":case"bottom-left":f=x;break;case"left":f=u;break;case"right":f=-u}return[f,m]}(e,t[0])}function up(e){switch(e){case"right":case"top-right":case"bottom-right":return"right";case"left":case"top-left":case"bottom-left":return"left"}return"center"}function Mf(e,t,i,u,f,m,x,k,A,z,D,B,V,j,Q){var $=function(Se,Te,Me,Xe,rt,wt,ut,It){for(var ht=Xe.layout.get("text-rotate").evaluate(wt,{})*Math.PI/180,$t=[],Bt=0,vt=Te.positionedLines;Bt<vt.length;Bt+=1)for(var sr=vt[Bt],Kt=0,yr=sr.positionedGlyphs;Kt<yr.length;Kt+=1){var At=yr[Kt];if(At.rect){var xr=At.rect||{},Jr=4,li=!0,ii=1,Qr=0,ui=(rt||It)&&At.vertical,Ni=At.metrics.advance*At.scale/2;if(It&&Te.verticalizable&&(Qr=sr.lineOffset/2-(At.imageName?-(24-At.metrics.width*At.scale)/2:24*(At.scale-1))),At.imageName){var Vi=ut[At.imageName];li=Vi.sdf,Jr=1/(ii=Vi.pixelRatio)}var xn=rt?[At.x+Ni,At.y]:[0,0],Wi=rt?[0,0]:[At.x+Ni+Me[0],At.y+Me[1]-Qr],wn=[0,0];ui&&(wn=Wi,Wi=[0,0]);var mi=(At.metrics.left-Jr)*At.scale-Ni+Wi[0],Yi=(-At.metrics.top-Jr)*At.scale+Wi[1],hr=mi+xr.w*At.scale/ii,Rr=Yi+xr.h*At.scale/ii,Pr=new F(mi,Yi),_r=new F(hr,Yi),Ln=new F(mi,Rr),fn=new F(hr,Rr);if(ui){var Zr=new F(-Ni,Ni- -17),Si=-Math.PI/2,dn=12-Ni,wr=new F(22-dn,-(At.imageName?dn:0)),to=new(Function.prototype.bind.apply(F,[null].concat(wn)));Pr._rotateAround(Si,Zr)._add(wr)._add(to),_r._rotateAround(Si,Zr)._add(wr)._add(to),Ln._rotateAround(Si,Zr)._add(wr)._add(to),fn._rotateAround(Si,Zr)._add(wr)._add(to)}if(ht){var la=Math.sin(ht),ro=Math.cos(ht),yi=[ro,-la,la,ro];Pr._matMult(yi),_r._matMult(yi),Ln._matMult(yi),fn._matMult(yi)}var io=new F(0,0),Pa=new F(0,0);$t.push({tl:Pr,tr:_r,bl:Ln,br:fn,tex:xr,writingMode:Te.writingMode,glyphOffset:xn,sectionIndex:At.sectionIndex,isSDF:li,pixelOffsetTL:io,pixelOffsetBR:Pa,minFontScaleX:0,minFontScaleY:0})}}return $t}(0,i,k,f,m,x,u,e.allowVerticalPlacement),pe=e.textSizeData,oe=null;pe.kind==="source"?(oe=[128*f.layout.get("text-size").evaluate(x,{})])[0]>32640&&je(e.layerIds[0]+': Value for "text-size" is >= 255. Reduce your "text-size".'):pe.kind==="composite"&&((oe=[128*j.compositeTextSizes[0].evaluate(x,{},Q),128*j.compositeTextSizes[1].evaluate(x,{},Q)])[0]>32640||oe[1]>32640)&&je(e.layerIds[0]+': Value for "text-size" is >= 255. Reduce your "text-size".'),e.addSymbols(e.text,$,oe,k,m,x,z,t,A.lineStartIndex,A.lineLength,V,Q);for(var ye=0,xe=D;ye<xe.length;ye+=1)B[xe[ye]]=e.text.placedSymbolArray.length-1;return 4*$.length}function Df(e){for(var t in e)return e[t];return null}function Lg(e,t,i,u){var f=e.compareText;if(t in f){for(var m=f[t],x=m.length-1;x>=0;x--)if(u.dist(m[x])<i)return!0}else f[t]=[];return f[t].push(u),!1}var Rg=sl.VectorTileFeature.types,Bg=[{name:"a_fade_opacity",components:1,type:"Uint8",offset:0}];function Uc(e,t,i,u,f,m,x,k,A,z,D,B,V){var j=k?Math.min(32640,Math.round(k[0])):0,Q=k?Math.min(32640,Math.round(k[1])):0;e.emplaceBack(t,i,Math.round(32*u),Math.round(32*f),m,x,(j<<1)+(A?1:0),Q,16*z,16*D,256*B,256*V)}function cp(e,t,i){e.emplaceBack(t.x,t.y,i),e.emplaceBack(t.x,t.y,i),e.emplaceBack(t.x,t.y,i),e.emplaceBack(t.x,t.y,i)}function Og(e){for(var t=0,i=e.sections;t<i.length;t+=1)if(Ys(i[t].text))return!0;return!1}var dl=function(e){this.layoutVertexArray=new el,this.indexArray=new Wa,this.programConfigurations=e,this.segments=new Z,this.dynamicLayoutVertexArray=new Zo,this.opacityVertexArray=new bs,this.placedSymbolArray=new h};dl.prototype.isEmpty=function(){return this.layoutVertexArray.length===0&&this.indexArray.length===0&&this.dynamicLayoutVertexArray.length===0&&this.opacityVertexArray.length===0},dl.prototype.upload=function(e,t,i,u){this.isEmpty()||(i&&(this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,ug.members),this.indexBuffer=e.createIndexBuffer(this.indexArray,t),this.dynamicLayoutVertexBuffer=e.createVertexBuffer(this.dynamicLayoutVertexArray,cg.members,!0),this.opacityVertexBuffer=e.createVertexBuffer(this.opacityVertexArray,Bg,!0),this.opacityVertexBuffer.itemSize=1),(i||u)&&this.programConfigurations.upload(e))},dl.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.dynamicLayoutVertexBuffer.destroy(),this.opacityVertexBuffer.destroy())},mt("SymbolBuffers",dl);var _u=function(e,t,i){this.layoutVertexArray=new e,this.layoutAttributes=t,this.indexArray=new i,this.segments=new Z,this.collisionVertexArray=new ou};_u.prototype.upload=function(e){this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,this.layoutAttributes),this.indexBuffer=e.createIndexBuffer(this.indexArray),this.collisionVertexBuffer=e.createVertexBuffer(this.collisionVertexArray,hg.members,!0)},_u.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.collisionVertexBuffer.destroy())},mt("CollisionBuffers",_u);var Mr=function(e){this.collisionBoxArray=e.collisionBoxArray,this.zoom=e.zoom,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map(function(m){return m.id}),this.index=e.index,this.pixelRatio=e.pixelRatio,this.sourceLayerIndex=e.sourceLayerIndex,this.hasPattern=!1,this.hasRTLText=!1,this.sortKeyRanges=[],this.collisionCircleArray=[],this.placementInvProjMatrix=ea([]),this.placementViewportMatrix=ea([]);var t=this.layers[0]._unevaluatedLayout._values;this.textSizeData=sp(this.zoom,t["text-size"]),this.iconSizeData=sp(this.zoom,t["icon-size"]);var i=this.layers[0].layout,u=i.get("symbol-sort-key"),f=i.get("symbol-z-order");this.canOverlap=i.get("text-allow-overlap")||i.get("icon-allow-overlap")||i.get("text-ignore-placement")||i.get("icon-ignore-placement"),this.sortFeaturesByKey=f!=="viewport-y"&&u.constantOr(1)!==void 0,this.sortFeaturesByY=(f==="viewport-y"||f==="auto"&&!this.sortFeaturesByKey)&&this.canOverlap,i.get("symbol-placement")==="point"&&(this.writingModes=i.get("text-writing-mode").map(function(m){return sa[m]})),this.stateDependentLayerIds=this.layers.filter(function(m){return m.isStateDependent()}).map(function(m){return m.id}),this.sourceID=e.sourceID};Mr.prototype.createArrays=function(){this.text=new dl(new Rt(this.layers,this.zoom,function(e){return/^text/.test(e)})),this.icon=new dl(new Rt(this.layers,this.zoom,function(e){return/^icon/.test(e)})),this.glyphOffsetArray=new S,this.lineVertexArray=new I,this.symbolInstances=new w},Mr.prototype.calculateGlyphDependencies=function(e,t,i,u,f){for(var m=0;m<e.length;m++)if(t[e.charCodeAt(m)]=!0,(i||u)&&f){var x=mu[e.charAt(m)];x&&(t[x.charCodeAt(0)]=!0)}},Mr.prototype.populate=function(e,t,i){var u=this.layers[0],f=u.layout,m=f.get("text-font"),x=f.get("text-field"),k=f.get("icon-image"),A=(x.value.kind!=="constant"||x.value.value instanceof ai&&!x.value.value.isEmpty()||x.value.value.toString().length>0)&&(m.value.kind!=="constant"||m.value.value.length>0),z=k.value.kind!=="constant"||!!k.value.value||Object.keys(k.parameters).length>0,D=f.get("symbol-sort-key");if(this.features=[],A||z){for(var B=t.iconDependencies,V=t.glyphDependencies,j=t.availableImages,Q=new lr(this.zoom),$=0,pe=e;$<pe.length;$+=1){var oe=pe[$],ye=oe.feature,xe=oe.id,Se=oe.index,Te=oe.sourceLayerIndex,Me=u._featureFilter.needGeometry,Xe=di(ye,Me);if(u._featureFilter.filter(Q,Xe,i)){Me||(Xe.geometry=ri(ye));var rt=void 0;if(A){var wt=u.getValueAndResolveTokens("text-field",Xe,i,j),ut=ai.factory(wt);Og(ut)&&(this.hasRTLText=!0),(!this.hasRTLText||ru()==="unavailable"||this.hasRTLText&&$n.isParsed())&&(rt=fg(ut,u,Xe))}var It=void 0;if(z){var ht=u.getValueAndResolveTokens("icon-image",Xe,i,j);It=ht instanceof Bi?ht:Bi.fromString(ht)}if(rt||It){var $t=this.sortFeaturesByKey?D.evaluate(Xe,{},i):void 0;if(this.features.push({id:xe,text:rt,icon:It,index:Se,sourceLayerIndex:Te,geometry:Xe.geometry,properties:ye.properties,type:Rg[ye.type],sortKey:$t}),It&&(B[It.name]=!0),rt){var Bt=m.evaluate(Xe,{},i).join(","),vt=f.get("text-rotation-alignment")==="map"&&f.get("symbol-placement")!=="point";this.allowVerticalPlacement=this.writingModes&&this.writingModes.indexOf(sa.vertical)>=0;for(var sr=0,Kt=rt.sections;sr<Kt.length;sr+=1){var yr=Kt[sr];if(yr.image)B[yr.image.name]=!0;else{var At=$l(rt.toString()),xr=yr.fontStack||Bt,Jr=V[xr]=V[xr]||{};this.calculateGlyphDependencies(yr.text,Jr,vt,this.allowVerticalPlacement,At)}}}}}}f.get("symbol-placement")==="line"&&(this.features=function(li){var ii={},Qr={},ui=[],Ni=0;function Vi(Zr){ui.push(li[Zr]),Ni++}function xn(Zr,Si,dn){var wr=Qr[Zr];return delete Qr[Zr],Qr[Si]=wr,ui[wr].geometry[0].pop(),ui[wr].geometry[0]=ui[wr].geometry[0].concat(dn[0]),wr}function Wi(Zr,Si,dn){var wr=ii[Si];return delete ii[Si],ii[Zr]=wr,ui[wr].geometry[0].shift(),ui[wr].geometry[0]=dn[0].concat(ui[wr].geometry[0]),wr}function wn(Zr,Si,dn){var wr=dn?Si[0][Si[0].length-1]:Si[0][0];return Zr+":"+wr.x+":"+wr.y}for(var mi=0;mi<li.length;mi++){var Yi=li[mi],hr=Yi.geometry,Rr=Yi.text?Yi.text.toString():null;if(Rr){var Pr=wn(Rr,hr),_r=wn(Rr,hr,!0);if(Pr in Qr&&_r in ii&&Qr[Pr]!==ii[_r]){var Ln=Wi(Pr,_r,hr),fn=xn(Pr,_r,ui[Ln].geometry);delete ii[Pr],delete Qr[_r],Qr[wn(Rr,ui[fn].geometry,!0)]=fn,ui[Ln].geometry=null}else Pr in Qr?xn(Pr,_r,hr):_r in ii?Wi(Pr,_r,hr):(Vi(mi),ii[Pr]=Ni-1,Qr[_r]=Ni-1)}else Vi(mi)}return ui.filter(function(Zr){return Zr.geometry})}(this.features)),this.sortFeaturesByKey&&this.features.sort(function(li,ii){return li.sortKey-ii.sortKey})}},Mr.prototype.update=function(e,t,i){this.stateDependentLayers.length&&(this.text.programConfigurations.updatePaintArrays(e,t,this.layers,i),this.icon.programConfigurations.updatePaintArrays(e,t,this.layers,i))},Mr.prototype.isEmpty=function(){return this.symbolInstances.length===0&&!this.hasRTLText},Mr.prototype.uploadPending=function(){return!this.uploaded||this.text.programConfigurations.needsUpload||this.icon.programConfigurations.needsUpload},Mr.prototype.upload=function(e){!this.uploaded&&this.hasDebugData()&&(this.textCollisionBox.upload(e),this.iconCollisionBox.upload(e)),this.text.upload(e,this.sortFeaturesByY,!this.uploaded,this.text.programConfigurations.needsUpload),this.icon.upload(e,this.sortFeaturesByY,!this.uploaded,this.icon.programConfigurations.needsUpload),this.uploaded=!0},Mr.prototype.destroyDebugData=function(){this.textCollisionBox.destroy(),this.iconCollisionBox.destroy()},Mr.prototype.destroy=function(){this.text.destroy(),this.icon.destroy(),this.hasDebugData()&&this.destroyDebugData()},Mr.prototype.addToLineVertexArray=function(e,t){var i=this.lineVertexArray.length;if(e.segment!==void 0){for(var u=e.dist(t[e.segment+1]),f=e.dist(t[e.segment]),m={},x=e.segment+1;x<t.length;x++)m[x]={x:t[x].x,y:t[x].y,tileUnitDistanceFromAnchor:u},x<t.length-1&&(u+=t[x+1].dist(t[x]));for(var k=e.segment||0;k>=0;k--)m[k]={x:t[k].x,y:t[k].y,tileUnitDistanceFromAnchor:f},k>0&&(f+=t[k-1].dist(t[k]));for(var A=0;A<t.length;A++){var z=m[A];this.lineVertexArray.emplaceBack(z.x,z.y,z.tileUnitDistanceFromAnchor)}}return{lineStartIndex:i,lineLength:this.lineVertexArray.length-i}},Mr.prototype.addSymbols=function(e,t,i,u,f,m,x,k,A,z,D,B){for(var V=e.indexArray,j=e.layoutVertexArray,Q=e.segments.prepareSegment(4*t.length,j,V,this.canOverlap?m.sortKey:void 0),$=this.glyphOffsetArray.length,pe=Q.vertexLength,oe=this.allowVerticalPlacement&&x===sa.vertical?Math.PI/2:0,ye=m.text&&m.text.sections,xe=0;xe<t.length;xe++){var Se=t[xe],Te=Se.tl,Me=Se.tr,Xe=Se.bl,rt=Se.br,wt=Se.tex,ut=Se.pixelOffsetTL,It=Se.pixelOffsetBR,ht=Se.minFontScaleX,$t=Se.minFontScaleY,Bt=Se.glyphOffset,vt=Se.isSDF,sr=Se.sectionIndex,Kt=Q.vertexLength,yr=Bt[1];Uc(j,k.x,k.y,Te.x,yr+Te.y,wt.x,wt.y,i,vt,ut.x,ut.y,ht,$t),Uc(j,k.x,k.y,Me.x,yr+Me.y,wt.x+wt.w,wt.y,i,vt,It.x,ut.y,ht,$t),Uc(j,k.x,k.y,Xe.x,yr+Xe.y,wt.x,wt.y+wt.h,i,vt,ut.x,It.y,ht,$t),Uc(j,k.x,k.y,rt.x,yr+rt.y,wt.x+wt.w,wt.y+wt.h,i,vt,It.x,It.y,ht,$t),cp(e.dynamicLayoutVertexArray,k,oe),V.emplaceBack(Kt,Kt+1,Kt+2),V.emplaceBack(Kt+1,Kt+2,Kt+3),Q.vertexLength+=4,Q.primitiveLength+=2,this.glyphOffsetArray.emplaceBack(Bt[0]),xe!==t.length-1&&sr===t[xe+1].sectionIndex||e.programConfigurations.populatePaintArrays(j.length,m,m.index,{},B,ye&&ye[sr])}e.placedSymbolArray.emplaceBack(k.x,k.y,$,this.glyphOffsetArray.length-$,pe,A,z,k.segment,i?i[0]:0,i?i[1]:0,u[0],u[1],x,0,!1,0,D)},Mr.prototype._addCollisionDebugVertex=function(e,t,i,u,f,m){return t.emplaceBack(0,0),e.emplaceBack(i.x,i.y,u,f,Math.round(m.x),Math.round(m.y))},Mr.prototype.addCollisionDebugVertices=function(e,t,i,u,f,m,x){var k=f.segments.prepareSegment(4,f.layoutVertexArray,f.indexArray),A=k.vertexLength,z=f.layoutVertexArray,D=f.collisionVertexArray,B=x.anchorX,V=x.anchorY;this._addCollisionDebugVertex(z,D,m,B,V,new F(e,t)),this._addCollisionDebugVertex(z,D,m,B,V,new F(i,t)),this._addCollisionDebugVertex(z,D,m,B,V,new F(i,u)),this._addCollisionDebugVertex(z,D,m,B,V,new F(e,u)),k.vertexLength+=4;var j=f.indexArray;j.emplaceBack(A,A+1),j.emplaceBack(A+1,A+2),j.emplaceBack(A+2,A+3),j.emplaceBack(A+3,A),k.primitiveLength+=4},Mr.prototype.addDebugCollisionBoxes=function(e,t,i,u){for(var f=e;f<t;f++){var m=this.collisionBoxArray.get(f);this.addCollisionDebugVertices(m.x1,m.y1,m.x2,m.y2,u?this.textCollisionBox:this.iconCollisionBox,m.anchorPoint,i)}},Mr.prototype.generateCollisionDebugBuffers=function(){this.hasDebugData()&&this.destroyDebugData(),this.textCollisionBox=new _u(Ko,hf.members,xs),this.iconCollisionBox=new _u(Ko,hf.members,xs);for(var e=0;e<this.symbolInstances.length;e++){var t=this.symbolInstances.get(e);this.addDebugCollisionBoxes(t.textBoxStartIndex,t.textBoxEndIndex,t,!0),this.addDebugCollisionBoxes(t.verticalTextBoxStartIndex,t.verticalTextBoxEndIndex,t,!0),this.addDebugCollisionBoxes(t.iconBoxStartIndex,t.iconBoxEndIndex,t,!1),this.addDebugCollisionBoxes(t.verticalIconBoxStartIndex,t.verticalIconBoxEndIndex,t,!1)}},Mr.prototype._deserializeCollisionBoxesForSymbol=function(e,t,i,u,f,m,x,k,A){for(var z={},D=t;D<i;D++){var B=e.get(D);z.textBox={x1:B.x1,y1:B.y1,x2:B.x2,y2:B.y2,anchorPointX:B.anchorPointX,anchorPointY:B.anchorPointY},z.textFeatureIndex=B.featureIndex;break}for(var V=u;V<f;V++){var j=e.get(V);z.verticalTextBox={x1:j.x1,y1:j.y1,x2:j.x2,y2:j.y2,anchorPointX:j.anchorPointX,anchorPointY:j.anchorPointY},z.verticalTextFeatureIndex=j.featureIndex;break}for(var Q=m;Q<x;Q++){var $=e.get(Q);z.iconBox={x1:$.x1,y1:$.y1,x2:$.x2,y2:$.y2,anchorPointX:$.anchorPointX,anchorPointY:$.anchorPointY},z.iconFeatureIndex=$.featureIndex;break}for(var pe=k;pe<A;pe++){var oe=e.get(pe);z.verticalIconBox={x1:oe.x1,y1:oe.y1,x2:oe.x2,y2:oe.y2,anchorPointX:oe.anchorPointX,anchorPointY:oe.anchorPointY},z.verticalIconFeatureIndex=oe.featureIndex;break}return z},Mr.prototype.deserializeCollisionBoxes=function(e){this.collisionArrays=[];for(var t=0;t<this.symbolInstances.length;t++){var i=this.symbolInstances.get(t);this.collisionArrays.push(this._deserializeCollisionBoxesForSymbol(e,i.textBoxStartIndex,i.textBoxEndIndex,i.verticalTextBoxStartIndex,i.verticalTextBoxEndIndex,i.iconBoxStartIndex,i.iconBoxEndIndex,i.verticalIconBoxStartIndex,i.verticalIconBoxEndIndex))}},Mr.prototype.hasTextData=function(){return this.text.segments.get().length>0},Mr.prototype.hasIconData=function(){return this.icon.segments.get().length>0},Mr.prototype.hasDebugData=function(){return this.textCollisionBox&&this.iconCollisionBox},Mr.prototype.hasTextCollisionBoxData=function(){return this.hasDebugData()&&this.textCollisionBox.segments.get().length>0},Mr.prototype.hasIconCollisionBoxData=function(){return this.hasDebugData()&&this.iconCollisionBox.segments.get().length>0},Mr.prototype.addIndicesForPlacedSymbol=function(e,t){for(var i=e.placedSymbolArray.get(t),u=i.vertexStartIndex+4*i.numGlyphs,f=i.vertexStartIndex;f<u;f+=4)e.indexArray.emplaceBack(f,f+1,f+2),e.indexArray.emplaceBack(f+1,f+2,f+3)},Mr.prototype.getSortedSymbolIndexes=function(e){if(this.sortedAngle===e&&this.symbolInstanceIndexes!==void 0)return this.symbolInstanceIndexes;for(var t=Math.sin(e),i=Math.cos(e),u=[],f=[],m=[],x=0;x<this.symbolInstances.length;++x){m.push(x);var k=this.symbolInstances.get(x);u.push(0|Math.round(t*k.anchorX+i*k.anchorY)),f.push(k.featureIndex)}return m.sort(function(A,z){return u[A]-u[z]||f[z]-f[A]}),m},Mr.prototype.addToSortKeyRanges=function(e,t){var i=this.sortKeyRanges[this.sortKeyRanges.length-1];i&&i.sortKey===t?i.symbolInstanceEnd=e+1:this.sortKeyRanges.push({sortKey:t,symbolInstanceStart:e,symbolInstanceEnd:e+1})},Mr.prototype.sortFeatures=function(e){var t=this;if(this.sortFeaturesByY&&this.sortedAngle!==e&&!(this.text.segments.get().length>1||this.icon.segments.get().length>1)){this.symbolInstanceIndexes=this.getSortedSymbolIndexes(e),this.sortedAngle=e,this.text.indexArray.clear(),this.icon.indexArray.clear(),this.featureSortOrder=[];for(var i=0,u=this.symbolInstanceIndexes;i<u.length;i+=1){var f=this.symbolInstances.get(u[i]);this.featureSortOrder.push(f.featureIndex),[f.rightJustifiedTextSymbolIndex,f.centerJustifiedTextSymbolIndex,f.leftJustifiedTextSymbolIndex].forEach(function(m,x,k){m>=0&&k.indexOf(m)===x&&t.addIndicesForPlacedSymbol(t.text,m)}),f.verticalPlacedTextSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.text,f.verticalPlacedTextSymbolIndex),f.placedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,f.placedIconSymbolIndex),f.verticalPlacedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,f.verticalPlacedIconSymbolIndex)}this.text.indexBuffer&&this.text.indexBuffer.updateData(this.text.indexArray),this.icon.indexBuffer&&this.icon.indexBuffer.updateData(this.icon.indexArray)}},mt("SymbolBucket",Mr,{omit:["layers","collisionBoxArray","features","compareText"]}),Mr.MAX_GLYPHS=65535,Mr.addDynamicAttributes=cp;var Fg=new nn({"symbol-placement":new Et(U.layout_symbol["symbol-placement"]),"symbol-spacing":new Et(U.layout_symbol["symbol-spacing"]),"symbol-avoid-edges":new Et(U.layout_symbol["symbol-avoid-edges"]),"symbol-sort-key":new _t(U.layout_symbol["symbol-sort-key"]),"symbol-z-order":new Et(U.layout_symbol["symbol-z-order"]),"icon-allow-overlap":new Et(U.layout_symbol["icon-allow-overlap"]),"icon-ignore-placement":new Et(U.layout_symbol["icon-ignore-placement"]),"icon-optional":new Et(U.layout_symbol["icon-optional"]),"icon-rotation-alignment":new Et(U.layout_symbol["icon-rotation-alignment"]),"icon-size":new _t(U.layout_symbol["icon-size"]),"icon-text-fit":new Et(U.layout_symbol["icon-text-fit"]),"icon-text-fit-padding":new Et(U.layout_symbol["icon-text-fit-padding"]),"icon-image":new _t(U.layout_symbol["icon-image"]),"icon-rotate":new _t(U.layout_symbol["icon-rotate"]),"icon-padding":new Et(U.layout_symbol["icon-padding"]),"icon-keep-upright":new Et(U.layout_symbol["icon-keep-upright"]),"icon-offset":new _t(U.layout_symbol["icon-offset"]),"icon-anchor":new _t(U.layout_symbol["icon-anchor"]),"icon-pitch-alignment":new Et(U.layout_symbol["icon-pitch-alignment"]),"text-pitch-alignment":new Et(U.layout_symbol["text-pitch-alignment"]),"text-rotation-alignment":new Et(U.layout_symbol["text-rotation-alignment"]),"text-field":new _t(U.layout_symbol["text-field"]),"text-font":new _t(U.layout_symbol["text-font"]),"text-size":new _t(U.layout_symbol["text-size"]),"text-max-width":new _t(U.layout_symbol["text-max-width"]),"text-line-height":new Et(U.layout_symbol["text-line-height"]),"text-letter-spacing":new _t(U.layout_symbol["text-letter-spacing"]),"text-justify":new _t(U.layout_symbol["text-justify"]),"text-radial-offset":new _t(U.layout_symbol["text-radial-offset"]),"text-variable-anchor":new Et(U.layout_symbol["text-variable-anchor"]),"text-anchor":new _t(U.layout_symbol["text-anchor"]),"text-max-angle":new Et(U.layout_symbol["text-max-angle"]),"text-writing-mode":new Et(U.layout_symbol["text-writing-mode"]),"text-rotate":new _t(U.layout_symbol["text-rotate"]),"text-padding":new Et(U.layout_symbol["text-padding"]),"text-keep-upright":new Et(U.layout_symbol["text-keep-upright"]),"text-transform":new _t(U.layout_symbol["text-transform"]),"text-offset":new _t(U.layout_symbol["text-offset"]),"text-allow-overlap":new Et(U.layout_symbol["text-allow-overlap"]),"text-ignore-placement":new Et(U.layout_symbol["text-ignore-placement"]),"text-optional":new Et(U.layout_symbol["text-optional"])}),hp={paint:new nn({"icon-opacity":new _t(U.paint_symbol["icon-opacity"]),"icon-color":new _t(U.paint_symbol["icon-color"]),"icon-halo-color":new _t(U.paint_symbol["icon-halo-color"]),"icon-halo-width":new _t(U.paint_symbol["icon-halo-width"]),"icon-halo-blur":new _t(U.paint_symbol["icon-halo-blur"]),"icon-translate":new Et(U.paint_symbol["icon-translate"]),"icon-translate-anchor":new Et(U.paint_symbol["icon-translate-anchor"]),"text-opacity":new _t(U.paint_symbol["text-opacity"]),"text-color":new _t(U.paint_symbol["text-color"],{runtimeType:He,getOverride:function(e){return e.textColor},hasOverride:function(e){return!!e.textColor}}),"text-halo-color":new _t(U.paint_symbol["text-halo-color"]),"text-halo-width":new _t(U.paint_symbol["text-halo-width"]),"text-halo-blur":new _t(U.paint_symbol["text-halo-blur"]),"text-translate":new Et(U.paint_symbol["text-translate"]),"text-translate-anchor":new Et(U.paint_symbol["text-translate-anchor"])}),layout:Fg},ml=function(e){this.type=e.property.overrides?e.property.overrides.runtimeType:lt,this.defaultValue=e};ml.prototype.evaluate=function(e){if(e.formattedSection){var t=this.defaultValue.property.overrides;if(t&&t.hasOverride(e.formattedSection))return t.getOverride(e.formattedSection)}return e.feature&&e.featureState?this.defaultValue.evaluate(e.feature,e.featureState):this.defaultValue.property.specification.default},ml.prototype.eachChild=function(e){this.defaultValue.isConstant()||e(this.defaultValue.value._styleExpression.expression)},ml.prototype.outputDefined=function(){return!1},ml.prototype.serialize=function(){return null},mt("FormatSectionOverride",ml,{omit:["defaultValue"]});var Ng=function(e){function t(i){e.call(this,i,hp)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.recalculate=function(i,u){if(e.prototype.recalculate.call(this,i,u),this.layout.get("icon-rotation-alignment")==="auto"&&(this.layout._values["icon-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-rotation-alignment")==="auto"&&(this.layout._values["text-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-pitch-alignment")==="auto"&&(this.layout._values["text-pitch-alignment"]=this.layout.get("text-rotation-alignment")),this.layout.get("icon-pitch-alignment")==="auto"&&(this.layout._values["icon-pitch-alignment"]=this.layout.get("icon-rotation-alignment")),this.layout.get("symbol-placement")==="point"){var f=this.layout.get("text-writing-mode");if(f){for(var m=[],x=0,k=f;x<k.length;x+=1){var A=k[x];m.indexOf(A)<0&&m.push(A)}this.layout._values["text-writing-mode"]=m}else this.layout._values["text-writing-mode"]=["horizontal"]}this._setPaintOverrides()},t.prototype.getValueAndResolveTokens=function(i,u,f,m){var x=this.layout.get(i).evaluate(u,{},f,m),k=this._unevaluatedLayout._values[i];return k.isDataDriven()||us(k.value)||!x?x:function(A,z){return z.replace(/{([^{}]+)}/g,function(D,B){return B in A?String(A[B]):""})}(u.properties,x)},t.prototype.createBucket=function(i){return new Mr(i)},t.prototype.queryRadius=function(){return 0},t.prototype.queryIntersectsFeature=function(){return!1},t.prototype._setPaintOverrides=function(){for(var i=0,u=hp.paint.overridableProperties;i<u.length;i+=1){var f=u[i];if(t.hasPaintOverride(this.layout,f)){var m,x=this.paint.get(f),k=new ml(x),A=new No(k,x.property.specification);m=x.value.kind==="constant"||x.value.kind==="source"?new cs("source",A):new Vo("composite",A,x.value.zoomStops,x.value._interpolationType),this.paint._values[f]=new gn(x.property,m,x.parameters)}}},t.prototype._handleOverridablePaintPropertyUpdate=function(i,u,f){return!(!this.layout||u.isDataDriven()||f.isDataDriven())&&t.hasPaintOverride(this.layout,i)},t.hasPaintOverride=function(i,u){var f=i.get("text-field"),m=hp.paint.properties[u],x=!1,k=function(D){for(var B=0,V=D;B<V.length;B+=1)if(m.overrides&&m.overrides.hasOverride(V[B]))return void(x=!0)};if(f.value.kind==="constant"&&f.value.value instanceof ai)k(f.value.value.sections);else if(f.value.kind==="source"){var A=function(D){x||(D instanceof Ii&&jr(D.value)===br?k(D.value.sections):D instanceof On?k(D.sections):D.eachChild(A))},z=f.value;z._styleExpression&&A(z._styleExpression.expression)}return x},t}(Ta),Vg={paint:new nn({"background-color":new Et(U.paint_background["background-color"]),"background-pattern":new _n(U.paint_background["background-pattern"]),"background-opacity":new Et(U.paint_background["background-opacity"])})},Ug=function(e){function t(i){e.call(this,i,Vg)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t}(Ta),qg={paint:new nn({"raster-opacity":new Et(U.paint_raster["raster-opacity"]),"raster-hue-rotate":new Et(U.paint_raster["raster-hue-rotate"]),"raster-brightness-min":new Et(U.paint_raster["raster-brightness-min"]),"raster-brightness-max":new Et(U.paint_raster["raster-brightness-max"]),"raster-saturation":new Et(U.paint_raster["raster-saturation"]),"raster-contrast":new Et(U.paint_raster["raster-contrast"]),"raster-resampling":new Et(U.paint_raster["raster-resampling"]),"raster-fade-duration":new Et(U.paint_raster["raster-fade-duration"])})},jg=function(e){function t(i){e.call(this,i,qg)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t}(Ta),Gg=function(e){function t(i){e.call(this,i,{}),this.implementation=i}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.is3D=function(){return this.implementation.renderingMode==="3d"},t.prototype.hasOffscreenPass=function(){return this.implementation.prerender!==void 0},t.prototype.recalculate=function(){},t.prototype.updateTransitions=function(){},t.prototype.hasTransition=function(){},t.prototype.serialize=function(){},t.prototype.onAdd=function(i){this.implementation.onAdd&&this.implementation.onAdd(i,i.painter.context.gl)},t.prototype.onRemove=function(i){this.implementation.onRemove&&this.implementation.onRemove(i,i.painter.context.gl)},t}(Ta),Zg={circle:Wh,heatmap:Ay,hillshade:Py,fill:Hy,"fill-extrusion":rg,line:lg,symbol:Ng,background:Ug,raster:jg},Lf=M.HTMLImageElement,Rf=M.HTMLCanvasElement,Bf=M.HTMLVideoElement,Of=M.ImageData,qc=M.ImageBitmap,Is=function(e,t,i,u){this.context=e,this.format=i,this.texture=e.gl.createTexture(),this.update(t,u)};Is.prototype.update=function(e,t,i){var u=e.width,f=e.height,m=!(this.size&&this.size[0]===u&&this.size[1]===f||i),x=this.context,k=x.gl;if(this.useMipmap=!!(t&&t.useMipmap),k.bindTexture(k.TEXTURE_2D,this.texture),x.pixelStoreUnpackFlipY.set(!1),x.pixelStoreUnpack.set(1),x.pixelStoreUnpackPremultiplyAlpha.set(this.format===k.RGBA&&(!t||t.premultiply!==!1)),m)this.size=[u,f],e instanceof Lf||e instanceof Rf||e instanceof Bf||e instanceof Of||qc&&e instanceof qc?k.texImage2D(k.TEXTURE_2D,0,this.format,this.format,k.UNSIGNED_BYTE,e):k.texImage2D(k.TEXTURE_2D,0,this.format,u,f,0,this.format,k.UNSIGNED_BYTE,e.data);else{var A=i||{x:0,y:0},z=A.x,D=A.y;e instanceof Lf||e instanceof Rf||e instanceof Bf||e instanceof Of||qc&&e instanceof qc?k.texSubImage2D(k.TEXTURE_2D,0,z,D,k.RGBA,k.UNSIGNED_BYTE,e):k.texSubImage2D(k.TEXTURE_2D,0,z,D,u,f,k.RGBA,k.UNSIGNED_BYTE,e.data)}this.useMipmap&&this.isSizePowerOfTwo()&&k.generateMipmap(k.TEXTURE_2D)},Is.prototype.bind=function(e,t,i){var u=this.context.gl;u.bindTexture(u.TEXTURE_2D,this.texture),i!==u.LINEAR_MIPMAP_NEAREST||this.isSizePowerOfTwo()||(i=u.LINEAR),e!==this.filter&&(u.texParameteri(u.TEXTURE_2D,u.TEXTURE_MAG_FILTER,e),u.texParameteri(u.TEXTURE_2D,u.TEXTURE_MIN_FILTER,i||e),this.filter=e),t!==this.wrap&&(u.texParameteri(u.TEXTURE_2D,u.TEXTURE_WRAP_S,t),u.texParameteri(u.TEXTURE_2D,u.TEXTURE_WRAP_T,t),this.wrap=t)},Is.prototype.isSizePowerOfTwo=function(){return this.size[0]===this.size[1]&&Math.log(this.size[0])/Math.LN2%1==0},Is.prototype.destroy=function(){this.context.gl.deleteTexture(this.texture),this.texture=null};var pp=function(e){var t=this;this._callback=e,this._triggered=!1,typeof MessageChannel<"u"&&(this._channel=new MessageChannel,this._channel.port2.onmessage=function(){t._triggered=!1,t._callback()})};pp.prototype.trigger=function(){var e=this;this._triggered||(this._triggered=!0,this._channel?this._channel.port1.postMessage(!0):setTimeout(function(){e._triggered=!1,e._callback()},0))},pp.prototype.remove=function(){delete this._channel,this._callback=function(){}};var yl=function(e,t,i){this.target=e,this.parent=t,this.mapId=i,this.callbacks={},this.tasks={},this.taskQueue=[],this.cancelCallbacks={},Ct(["receive","process"],this),this.invoker=new pp(this.process),this.target.addEventListener("message",this.receive,!1),this.globalScope=$e()?e:M};function Ff(e,t,i){var u=2*Math.PI*6378137/256/Math.pow(2,i);return[e*u-2*Math.PI*6378137/2,t*u-2*Math.PI*6378137/2]}yl.prototype.send=function(e,t,i,u,f){var m=this;f===void 0&&(f=!1);var x=Math.round(1e18*Math.random()).toString(36).substring(0,10);i&&(this.callbacks[x]=i);var k=Lt(this.globalScope)?void 0:[];return this.target.postMessage({id:x,type:e,hasCallback:!!i,targetMapId:u,mustQueue:f,sourceMapId:this.mapId,data:da(t,k)},k),{cancel:function(){i&&delete m.callbacks[x],m.target.postMessage({id:x,type:"<cancel>",targetMapId:u,sourceMapId:m.mapId})}}},yl.prototype.receive=function(e){var t=e.data,i=t.id;if(i&&(!t.targetMapId||this.mapId===t.targetMapId))if(t.type==="<cancel>"){delete this.tasks[i];var u=this.cancelCallbacks[i];delete this.cancelCallbacks[i],u&&u()}else $e()||t.mustQueue?(this.tasks[i]=t,this.taskQueue.push(i),this.invoker.trigger()):this.processTask(i,t)},yl.prototype.process=function(){if(this.taskQueue.length){var e=this.taskQueue.shift(),t=this.tasks[e];delete this.tasks[e],this.taskQueue.length&&this.invoker.trigger(),t&&this.processTask(e,t)}},yl.prototype.processTask=function(e,t){var i=this;if(t.type==="<response>"){var u=this.callbacks[e];delete this.callbacks[e],u&&(t.error?u(Un(t.error)):u(null,Un(t.data)))}else{var f=!1,m=Lt(this.globalScope)?void 0:[],x=t.hasCallback?function(D,B){f=!0,delete i.cancelCallbacks[e],i.target.postMessage({id:e,type:"<response>",sourceMapId:i.mapId,error:D?da(D):null,data:da(B,m)},m)}:function(D){f=!0},k=null,A=Un(t.data);if(this.parent[t.type])k=this.parent[t.type](t.sourceMapId,A,x);else if(this.parent.getWorkerSource){var z=t.type.split(".");k=this.parent.getWorkerSource(t.sourceMapId,z[0],A.source)[z[1]](A,x)}else x(new Error("Could not find function "+t.type));!f&&k&&k.cancel&&(this.cancelCallbacks[e]=k.cancel)}},yl.prototype.remove=function(){this.invoker.remove(),this.target.removeEventListener("message",this.receive,!1)};var Mi=function(e,t){e&&(t?this.setSouthWest(e).setNorthEast(t):e.length===4?this.setSouthWest([e[0],e[1]]).setNorthEast([e[2],e[3]]):this.setSouthWest(e[0]).setNorthEast(e[1]))};Mi.prototype.setNorthEast=function(e){return this._ne=e instanceof Yr?new Yr(e.lng,e.lat):Yr.convert(e),this},Mi.prototype.setSouthWest=function(e){return this._sw=e instanceof Yr?new Yr(e.lng,e.lat):Yr.convert(e),this},Mi.prototype.extend=function(e){var t,i,u=this._sw,f=this._ne;if(e instanceof Yr)t=e,i=e;else{if(!(e instanceof Mi))return Array.isArray(e)?e.length===4||e.every(Array.isArray)?this.extend(Mi.convert(e)):this.extend(Yr.convert(e)):this;if(i=e._ne,!(t=e._sw)||!i)return this}return u||f?(u.lng=Math.min(t.lng,u.lng),u.lat=Math.min(t.lat,u.lat),f.lng=Math.max(i.lng,f.lng),f.lat=Math.max(i.lat,f.lat)):(this._sw=new Yr(t.lng,t.lat),this._ne=new Yr(i.lng,i.lat)),this},Mi.prototype.getCenter=function(){return new Yr((this._sw.lng+this._ne.lng)/2,(this._sw.lat+this._ne.lat)/2)},Mi.prototype.getSouthWest=function(){return this._sw},Mi.prototype.getNorthEast=function(){return this._ne},Mi.prototype.getNorthWest=function(){return new Yr(this.getWest(),this.getNorth())},Mi.prototype.getSouthEast=function(){return new Yr(this.getEast(),this.getSouth())},Mi.prototype.getWest=function(){return this._sw.lng},Mi.prototype.getSouth=function(){return this._sw.lat},Mi.prototype.getEast=function(){return this._ne.lng},Mi.prototype.getNorth=function(){return this._ne.lat},Mi.prototype.toArray=function(){return[this._sw.toArray(),this._ne.toArray()]},Mi.prototype.toString=function(){return"LngLatBounds("+this._sw.toString()+", "+this._ne.toString()+")"},Mi.prototype.isEmpty=function(){return!(this._sw&&this._ne)},Mi.prototype.contains=function(e){var t=Yr.convert(e),i=t.lng,u=t.lat,f=this._sw.lng<=i&&i<=this._ne.lng;return this._sw.lng>this._ne.lng&&(f=this._sw.lng>=i&&i>=this._ne.lng),this._sw.lat<=u&&u<=this._ne.lat&&f},Mi.convert=function(e){return!e||e instanceof Mi?e:new Mi(e)};var Yr=function(e,t){if(isNaN(e)||isNaN(t))throw new Error("Invalid LngLat object: ("+e+", "+t+")");if(this.lng=+e,this.lat=+t,this.lat>90||this.lat<-90)throw new Error("Invalid LngLat latitude value: must be between -90 and 90")};Yr.prototype.wrap=function(){return new Yr(me(this.lng,-180,180),this.lat)},Yr.prototype.toArray=function(){return[this.lng,this.lat]},Yr.prototype.toString=function(){return"LngLat("+this.lng+", "+this.lat+")"},Yr.prototype.distanceTo=function(e){var t=Math.PI/180,i=this.lat*t,u=e.lat*t,f=Math.sin(i)*Math.sin(u)+Math.cos(i)*Math.cos(u)*Math.cos((e.lng-this.lng)*t);return 63710088e-1*Math.acos(Math.min(f,1))},Yr.prototype.toBounds=function(e){e===void 0&&(e=0);var t=360*e/40075017,i=t/Math.cos(Math.PI/180*this.lat);return new Mi(new Yr(this.lng-i,this.lat-t),new Yr(this.lng+i,this.lat+t))},Yr.convert=function(e){if(e instanceof Yr)return e;if(Array.isArray(e)&&(e.length===2||e.length===3))return new Yr(Number(e[0]),Number(e[1]));if(!Array.isArray(e)&&typeof e=="object"&&e!==null)return new Yr(Number("lng"in e?e.lng:e.lon),Number(e.lat));throw new Error("`LngLatLike` argument must be specified as a LngLat instance, an object {lng: <lng>, lat: <lat>}, an object {lon: <lng>, lat: <lat>}, or an array of [<lng>, <lat>]")};var Nf=2*Math.PI*63710088e-1;function Vf(e){return Nf*Math.cos(e*Math.PI/180)}function Uf(e){return(180+e)/360}function qf(e){return(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+e*Math.PI/360)))/360}function jf(e,t){return e/Vf(t)}function fp(e){return 360/Math.PI*Math.atan(Math.exp((180-360*e)*Math.PI/180))-90}var As=function(e,t,i){i===void 0&&(i=0),this.x=+e,this.y=+t,this.z=+i};As.fromLngLat=function(e,t){t===void 0&&(t=0);var i=Yr.convert(e);return new As(Uf(i.lng),qf(i.lat),jf(t,i.lat))},As.prototype.toLngLat=function(){return new Yr(360*this.x-180,fp(this.y))},As.prototype.toAltitude=function(){return this.z*Vf(fp(this.y))},As.prototype.meterInMercatorCoordinateUnits=function(){return 1/Nf*(e=fp(this.y),1/Math.cos(e*Math.PI/180));var e};var zs=function(e,t,i){this.z=e,this.x=t,this.y=i,this.key=vu(0,e,e,t,i)};zs.prototype.equals=function(e){return this.z===e.z&&this.x===e.x&&this.y===e.y},zs.prototype.url=function(e,t){var i,u,f,m,x,k=(u=this.y,f=this.z,m=Ff(256*(i=this.x),256*(u=Math.pow(2,f)-u-1),f),x=Ff(256*(i+1),256*(u+1),f),m[0]+","+m[1]+","+x[0]+","+x[1]),A=function(z,D,B){for(var V,j="",Q=z;Q>0;Q--)j+=(D&(V=1<<Q-1)?1:0)+(B&V?2:0);return j}(this.z,this.x,this.y);return e[(this.x+this.y)%e.length].replace("{prefix}",(this.x%16).toString(16)+(this.y%16).toString(16)).replace("{z}",String(this.z)).replace("{x}",String(this.x)).replace("{y}",String(t==="tms"?Math.pow(2,this.z)-this.y-1:this.y)).replace("{quadkey}",A).replace("{bbox-epsg-3857}",k)},zs.prototype.getTilePoint=function(e){var t=Math.pow(2,this.z);return new F(8192*(e.x*t-this.x),8192*(e.y*t-this.y))},zs.prototype.toString=function(){return this.z+"/"+this.x+"/"+this.y};var Gf=function(e,t){this.wrap=e,this.canonical=t,this.key=vu(e,t.z,t.z,t.x,t.y)},Di=function(e,t,i,u,f){this.overscaledZ=e,this.wrap=t,this.canonical=new zs(i,+u,+f),this.key=vu(t,e,i,u,f)};function vu(e,t,i,u,f){(e*=2)<0&&(e=-1*e-1);var m=1<<i;return(m*m*e+m*f+u).toString(36)+i.toString(36)+t.toString(36)}Di.prototype.equals=function(e){return this.overscaledZ===e.overscaledZ&&this.wrap===e.wrap&&this.canonical.equals(e.canonical)},Di.prototype.scaledTo=function(e){var t=this.canonical.z-e;return e>this.canonical.z?new Di(e,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y):new Di(e,this.wrap,e,this.canonical.x>>t,this.canonical.y>>t)},Di.prototype.calculateScaledKey=function(e,t){var i=this.canonical.z-e;return e>this.canonical.z?vu(this.wrap*+t,e,this.canonical.z,this.canonical.x,this.canonical.y):vu(this.wrap*+t,e,e,this.canonical.x>>i,this.canonical.y>>i)},Di.prototype.isChildOf=function(e){if(e.wrap!==this.wrap)return!1;var t=this.canonical.z-e.canonical.z;return e.overscaledZ===0||e.overscaledZ<this.overscaledZ&&e.canonical.x===this.canonical.x>>t&&e.canonical.y===this.canonical.y>>t},Di.prototype.children=function(e){if(this.overscaledZ>=e)return[new Di(this.overscaledZ+1,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)];var t=this.canonical.z+1,i=2*this.canonical.x,u=2*this.canonical.y;return[new Di(t,this.wrap,t,i,u),new Di(t,this.wrap,t,i+1,u),new Di(t,this.wrap,t,i,u+1),new Di(t,this.wrap,t,i+1,u+1)]},Di.prototype.isLessThan=function(e){return this.wrap<e.wrap||!(this.wrap>e.wrap)&&(this.overscaledZ<e.overscaledZ||!(this.overscaledZ>e.overscaledZ)&&(this.canonical.x<e.canonical.x||!(this.canonical.x>e.canonical.x)&&this.canonical.y<e.canonical.y))},Di.prototype.wrapped=function(){return new Di(this.overscaledZ,0,this.canonical.z,this.canonical.x,this.canonical.y)},Di.prototype.unwrapTo=function(e){return new Di(this.overscaledZ,e,this.canonical.z,this.canonical.x,this.canonical.y)},Di.prototype.overscaleFactor=function(){return Math.pow(2,this.overscaledZ-this.canonical.z)},Di.prototype.toUnwrapped=function(){return new Gf(this.wrap,this.canonical)},Di.prototype.toString=function(){return this.overscaledZ+"/"+this.canonical.x+"/"+this.canonical.y},Di.prototype.getTilePoint=function(e){return this.canonical.getTilePoint(new As(e.x-this.wrap,e.y))},mt("CanonicalTileID",zs),mt("OverscaledTileID",Di,{omit:["posMatrix"]});var Po=function(e,t,i){if(this.uid=e,t.height!==t.width)throw new RangeError("DEM tiles must be square");if(i&&i!=="mapbox"&&i!=="terrarium")return je('"'+i+'" is not a valid encoding type. Valid types include "mapbox" and "terrarium".');this.stride=t.height;var u=this.dim=t.height-2;this.data=new Uint32Array(t.data.buffer),this.encoding=i||"mapbox";for(var f=0;f<u;f++)this.data[this._idx(-1,f)]=this.data[this._idx(0,f)],this.data[this._idx(u,f)]=this.data[this._idx(u-1,f)],this.data[this._idx(f,-1)]=this.data[this._idx(f,0)],this.data[this._idx(f,u)]=this.data[this._idx(f,u-1)];this.data[this._idx(-1,-1)]=this.data[this._idx(0,0)],this.data[this._idx(u,-1)]=this.data[this._idx(u-1,0)],this.data[this._idx(-1,u)]=this.data[this._idx(0,u-1)],this.data[this._idx(u,u)]=this.data[this._idx(u-1,u-1)]};Po.prototype.get=function(e,t){var i=new Uint8Array(this.data.buffer),u=4*this._idx(e,t);return(this.encoding==="terrarium"?this._unpackTerrarium:this._unpackMapbox)(i[u],i[u+1],i[u+2])},Po.prototype.getUnpackVector=function(){return this.encoding==="terrarium"?[256,1,1/256,32768]:[6553.6,25.6,.1,1e4]},Po.prototype._idx=function(e,t){if(e<-1||e>=this.dim+1||t<-1||t>=this.dim+1)throw new RangeError("out of range source coordinates for DEM data");return(t+1)*this.stride+(e+1)},Po.prototype._unpackMapbox=function(e,t,i){return(256*e*256+256*t+i)/10-1e4},Po.prototype._unpackTerrarium=function(e,t,i){return 256*e+t+i/256-32768},Po.prototype.getPixels=function(){return new Kn({width:this.stride,height:this.stride},new Uint8Array(this.data.buffer))},Po.prototype.backfillBorder=function(e,t,i){if(this.dim!==e.dim)throw new Error("dem dimension mismatch");var u=t*this.dim,f=t*this.dim+this.dim,m=i*this.dim,x=i*this.dim+this.dim;switch(t){case-1:u=f-1;break;case 1:f=u+1}switch(i){case-1:m=x-1;break;case 1:x=m+1}for(var k=-t*this.dim,A=-i*this.dim,z=m;z<x;z++)for(var D=u;D<f;D++)this.data[this._idx(D,z)]=e.data[this._idx(D+k,z+A)]},mt("DEMData",Po);var jc=function(e){this._stringToNumber={},this._numberToString=[];for(var t=0;t<e.length;t++){var i=e[t];this._stringToNumber[i]=t,this._numberToString[t]=i}};jc.prototype.encode=function(e){return this._stringToNumber[e]},jc.prototype.decode=function(e){return this._numberToString[e]};var Gc=function(e,t,i,u,f){this.type="Feature",this._vectorTileFeature=e,e._z=t,e._x=i,e._y=u,this.properties=e.properties,this.id=f},dp={geometry:{configurable:!0}};dp.geometry.get=function(){return this._geometry===void 0&&(this._geometry=this._vectorTileFeature.toGeoJSON(this._vectorTileFeature._x,this._vectorTileFeature._y,this._vectorTileFeature._z).geometry),this._geometry},dp.geometry.set=function(e){this._geometry=e},Gc.prototype.toJSON=function(){var e={geometry:this.geometry};for(var t in this)t!=="_geometry"&&t!=="_vectorTileFeature"&&(e[t]=this[t]);return e},Object.defineProperties(Gc.prototype,dp);var gl=function(){this.state={},this.stateChanges={},this.deletedStates={}};gl.prototype.updateState=function(e,t,i){var u=String(t);if(this.stateChanges[e]=this.stateChanges[e]||{},this.stateChanges[e][u]=this.stateChanges[e][u]||{},_e(this.stateChanges[e][u],i),this.deletedStates[e]===null)for(var f in this.deletedStates[e]={},this.state[e])f!==u&&(this.deletedStates[e][f]=null);else if(this.deletedStates[e]&&this.deletedStates[e][u]===null)for(var m in this.deletedStates[e][u]={},this.state[e][u])i[m]||(this.deletedStates[e][u][m]=null);else for(var x in i)this.deletedStates[e]&&this.deletedStates[e][u]&&this.deletedStates[e][u][x]===null&&delete this.deletedStates[e][u][x]},gl.prototype.removeFeatureState=function(e,t,i){if(this.deletedStates[e]!==null){var u=String(t);if(this.deletedStates[e]=this.deletedStates[e]||{},i&&t!==void 0)this.deletedStates[e][u]!==null&&(this.deletedStates[e][u]=this.deletedStates[e][u]||{},this.deletedStates[e][u][i]=null);else if(t!==void 0)if(this.stateChanges[e]&&this.stateChanges[e][u])for(i in this.deletedStates[e][u]={},this.stateChanges[e][u])this.deletedStates[e][u][i]=null;else this.deletedStates[e][u]=null;else this.deletedStates[e]=null}},gl.prototype.getState=function(e,t){var i=String(t),u=_e({},(this.state[e]||{})[i],(this.stateChanges[e]||{})[i]);if(this.deletedStates[e]===null)return{};if(this.deletedStates[e]){var f=this.deletedStates[e][t];if(f===null)return{};for(var m in f)delete u[m]}return u},gl.prototype.initializeTileState=function(e,t){e.setFeatureState(this.state,t)},gl.prototype.coalesceChanges=function(e,t){var i={};for(var u in this.stateChanges){this.state[u]=this.state[u]||{};var f={};for(var m in this.stateChanges[u])this.state[u][m]||(this.state[u][m]={}),_e(this.state[u][m],this.stateChanges[u][m]),f[m]=this.state[u][m];i[u]=f}for(var x in this.deletedStates){this.state[x]=this.state[x]||{};var k={};if(this.deletedStates[x]===null)for(var A in this.state[x])k[A]={},this.state[x][A]={};else for(var z in this.deletedStates[x]){if(this.deletedStates[x][z]===null)this.state[x][z]={};else for(var D=0,B=Object.keys(this.deletedStates[x][z]);D<B.length;D+=1)delete this.state[x][z][B[D]];k[z]=this.state[x][z]}i[x]=i[x]||{},_e(i[x],k)}if(this.stateChanges={},this.deletedStates={},Object.keys(i).length!==0)for(var V in e)e[V].setFeatureState(i,t)};var Co=function(e,t){this.tileID=e,this.x=e.canonical.x,this.y=e.canonical.y,this.z=e.canonical.z,this.grid=new Ca(8192,16,0),this.grid3D=new Ca(8192,16,0),this.featureIndexArray=new O,this.promoteId=t};function Zf(e,t,i,u,f){return Ge(e,function(m,x){var k=t instanceof vs?t.get(x):null;return k&&k.evaluate?k.evaluate(i,u,f):k})}function Kf(e){for(var t=1/0,i=1/0,u=-1/0,f=-1/0,m=0,x=e;m<x.length;m+=1){var k=x[m];t=Math.min(t,k.x),i=Math.min(i,k.y),u=Math.max(u,k.x),f=Math.max(f,k.y)}return{minX:t,minY:i,maxX:u,maxY:f}}function Kg(e,t){return t-e}Co.prototype.insert=function(e,t,i,u,f,m){var x=this.featureIndexArray.length;this.featureIndexArray.emplaceBack(i,u,f);for(var k=m?this.grid3D:this.grid,A=0;A<t.length;A++){for(var z=t[A],D=[1/0,1/0,-1/0,-1/0],B=0;B<z.length;B++){var V=z[B];D[0]=Math.min(D[0],V.x),D[1]=Math.min(D[1],V.y),D[2]=Math.max(D[2],V.x),D[3]=Math.max(D[3],V.y)}D[0]<8192&&D[1]<8192&&D[2]>=0&&D[3]>=0&&k.insert(x,D[0],D[1],D[2],D[3])}},Co.prototype.loadVTLayers=function(){return this.vtLayers||(this.vtLayers=new sl.VectorTile(new Mc(this.rawTileData)).layers,this.sourceLayerCoder=new jc(this.vtLayers?Object.keys(this.vtLayers).sort():["_geojsonTileLayer"])),this.vtLayers},Co.prototype.query=function(e,t,i,u){var f=this;this.loadVTLayers();for(var m=e.params||{},x=8192/e.tileSize/e.scale,k=Gs(m.filter),A=e.queryGeometry,z=e.queryPadding*x,D=Kf(A),B=this.grid.query(D.minX-z,D.minY-z,D.maxX+z,D.maxY+z),V=Kf(e.cameraQueryGeometry),j=this.grid3D.query(V.minX-z,V.minY-z,V.maxX+z,V.maxY+z,function(Se,Te,Me,Xe){return function(rt,wt,ut,It,ht){for(var $t=0,Bt=rt;$t<Bt.length;$t+=1){var vt=Bt[$t];if(wt<=vt.x&&ut<=vt.y&&It>=vt.x&&ht>=vt.y)return!0}var sr=[new F(wt,ut),new F(wt,ht),new F(It,ht),new F(It,ut)];if(rt.length>2){for(var Kt=0,yr=sr;Kt<yr.length;Kt+=1)if(Aa(rt,yr[Kt]))return!0}for(var At=0;At<rt.length-1;At++)if(ks(rt[At],rt[At+1],sr))return!0;return!1}(e.cameraQueryGeometry,Se-z,Te-z,Me+z,Xe+z)}),Q=0,$=j;Q<$.length;Q+=1)B.push($[Q]);B.sort(Kg);for(var pe,oe={},ye=function(Se){var Te=B[Se];if(Te!==pe){pe=Te;var Me=f.featureIndexArray.get(Te),Xe=null;f.loadMatchingFeature(oe,Me.bucketIndex,Me.sourceLayerIndex,Me.featureIndex,k,m.layers,m.availableImages,t,i,u,function(rt,wt,ut){return Xe||(Xe=ri(rt)),wt.queryIntersectsFeature(A,rt,ut,Xe,f.z,e.transform,x,e.pixelPosMatrix)})}},xe=0;xe<B.length;xe++)ye(xe);return oe},Co.prototype.loadMatchingFeature=function(e,t,i,u,f,m,x,k,A,z,D){var B=this.bucketLayerIDs[t];if(!m||function(rt,wt){for(var ut=0;ut<rt.length;ut++)if(wt.indexOf(rt[ut])>=0)return!0;return!1}(m,B)){var V=this.sourceLayerCoder.decode(i),j=this.vtLayers[V].feature(u);if(f.needGeometry){var Q=di(j,!0);if(!f.filter(new lr(this.tileID.overscaledZ),Q,this.tileID.canonical))return}else if(!f.filter(new lr(this.tileID.overscaledZ),j))return;for(var $=this.getId(j,V),pe=0;pe<B.length;pe++){var oe=B[pe];if(!(m&&m.indexOf(oe)<0)){var ye=k[oe];if(ye){var xe={};$!==void 0&&z&&(xe=z.getState(ye.sourceLayer||"_geojsonTileLayer",$));var Se=_e({},A[oe]);Se.paint=Zf(Se.paint,ye.paint,j,xe,x),Se.layout=Zf(Se.layout,ye.layout,j,xe,x);var Te=!D||D(j,ye,xe);if(Te){var Me=new Gc(j,this.z,this.x,this.y,$);Me.layer=Se;var Xe=e[oe];Xe===void 0&&(Xe=e[oe]=[]),Xe.push({featureIndex:u,feature:Me,intersectionZ:Te})}}}}}},Co.prototype.lookupSymbolFeatures=function(e,t,i,u,f,m,x,k){var A={};this.loadVTLayers();for(var z=Gs(f),D=0,B=e;D<B.length;D+=1)this.loadMatchingFeature(A,i,u,B[D],z,m,x,k,t);return A},Co.prototype.hasLayer=function(e){for(var t=0,i=this.bucketLayerIDs;t<i.length;t+=1)for(var u=0,f=i[t];u<f.length;u+=1)if(e===f[u])return!0;return!1},Co.prototype.getId=function(e,t){var i=e.id;return this.promoteId&&typeof(i=e.properties[typeof this.promoteId=="string"?this.promoteId:this.promoteId[t]])=="boolean"&&(i=Number(i)),i},mt("FeatureIndex",Co,{omit:["rawTileData","sourceLayerCoder"]});var Xi=function(e,t){this.tileID=e,this.uid=Fe(),this.uses=0,this.tileSize=t,this.buckets={},this.expirationTime=null,this.queryPadding=0,this.hasSymbolBuckets=!1,this.hasRTLText=!1,this.dependencies={},this.expiredRequestCount=0,this.state="loading"};Xi.prototype.registerFadeDuration=function(e){var t=e+this.timeAdded;t<Sr.now()||this.fadeEndTime&&t<this.fadeEndTime||(this.fadeEndTime=t)},Xi.prototype.wasRequested=function(){return this.state==="errored"||this.state==="loaded"||this.state==="reloading"},Xi.prototype.loadVectorData=function(e,t,i){if(this.hasData()&&this.unloadVectorData(),this.state="loaded",e){for(var u in e.featureIndex&&(this.latestFeatureIndex=e.featureIndex,e.rawTileData?(this.latestRawTileData=e.rawTileData,this.latestFeatureIndex.rawTileData=e.rawTileData):this.latestRawTileData&&(this.latestFeatureIndex.rawTileData=this.latestRawTileData)),this.collisionBoxArray=e.collisionBoxArray,this.buckets=function(z,D){var B={};if(!D)return B;for(var V=function(){var $=Q[j],pe=$.layerIds.map(function(xe){return D.getLayer(xe)}).filter(Boolean);if(pe.length!==0){$.layers=pe,$.stateDependentLayerIds&&($.stateDependentLayers=$.stateDependentLayerIds.map(function(xe){return pe.filter(function(Se){return Se.id===xe})[0]}));for(var oe=0,ye=pe;oe<ye.length;oe+=1)B[ye[oe].id]=$}},j=0,Q=z;j<Q.length;j+=1)V();return B}(e.buckets,t.style),this.hasSymbolBuckets=!1,this.buckets){var f=this.buckets[u];if(f instanceof Mr){if(this.hasSymbolBuckets=!0,!i)break;f.justReloaded=!0}}if(this.hasRTLText=!1,this.hasSymbolBuckets)for(var m in this.buckets){var x=this.buckets[m];if(x instanceof Mr&&x.hasRTLText){this.hasRTLText=!0,$n.isLoading()||$n.isLoaded()||ru()!=="deferred"||ma();break}}for(var k in this.queryPadding=0,this.buckets){var A=this.buckets[k];this.queryPadding=Math.max(this.queryPadding,t.style.getLayer(k).queryRadius(A))}e.imageAtlas&&(this.imageAtlas=e.imageAtlas),e.glyphAtlasImage&&(this.glyphAtlasImage=e.glyphAtlasImage)}else this.collisionBoxArray=new s},Xi.prototype.unloadVectorData=function(){for(var e in this.buckets)this.buckets[e].destroy();this.buckets={},this.imageAtlasTexture&&this.imageAtlasTexture.destroy(),this.imageAtlas&&(this.imageAtlas=null),this.glyphAtlasTexture&&this.glyphAtlasTexture.destroy(),this.latestFeatureIndex=null,this.state="unloaded"},Xi.prototype.getBucket=function(e){return this.buckets[e.id]},Xi.prototype.upload=function(e){for(var t in this.buckets){var i=this.buckets[t];i.uploadPending()&&i.upload(e)}var u=e.gl;this.imageAtlas&&!this.imageAtlas.uploaded&&(this.imageAtlasTexture=new Is(e,this.imageAtlas.image,u.RGBA),this.imageAtlas.uploaded=!0),this.glyphAtlasImage&&(this.glyphAtlasTexture=new Is(e,this.glyphAtlasImage,u.ALPHA),this.glyphAtlasImage=null)},Xi.prototype.prepare=function(e){this.imageAtlas&&this.imageAtlas.patchUpdatedImages(e,this.imageAtlasTexture)},Xi.prototype.queryRenderedFeatures=function(e,t,i,u,f,m,x,k,A,z){return this.latestFeatureIndex&&this.latestFeatureIndex.rawTileData?this.latestFeatureIndex.query({queryGeometry:u,cameraQueryGeometry:f,scale:m,tileSize:this.tileSize,pixelPosMatrix:z,transform:k,params:x,queryPadding:this.queryPadding*A},e,t,i):{}},Xi.prototype.querySourceFeatures=function(e,t){var i=this.latestFeatureIndex;if(i&&i.rawTileData){var u=i.loadVTLayers(),f=t?t.sourceLayer:"",m=u._geojsonTileLayer||u[f];if(m)for(var x=Gs(t&&t.filter),k=this.tileID.canonical,A=k.z,z=k.x,D=k.y,B={z:A,x:z,y:D},V=0;V<m.length;V++){var j=m.feature(V);if(x.needGeometry){var Q=di(j,!0);if(!x.filter(new lr(this.tileID.overscaledZ),Q,this.tileID.canonical))continue}else if(!x.filter(new lr(this.tileID.overscaledZ),j))continue;var $=i.getId(j,f),pe=new Gc(j,A,z,D,$);pe.tile=B,e.push(pe)}}},Xi.prototype.hasData=function(){return this.state==="loaded"||this.state==="reloading"||this.state==="expired"},Xi.prototype.patternsLoaded=function(){return this.imageAtlas&&!!Object.keys(this.imageAtlas.patternPositions).length},Xi.prototype.setExpiryData=function(e){var t=this.expirationTime;if(e.cacheControl){var i=yt(e.cacheControl);i["max-age"]&&(this.expirationTime=Date.now()+1e3*i["max-age"])}else e.expires&&(this.expirationTime=new Date(e.expires).getTime());if(this.expirationTime){var u=Date.now(),f=!1;if(this.expirationTime>u)f=!1;else if(t)if(this.expirationTime<t)f=!0;else{var m=this.expirationTime-t;m?this.expirationTime=u+Math.max(m,3e4):f=!0}else f=!0;f?(this.expiredRequestCount++,this.state="expired"):this.expiredRequestCount=0}},Xi.prototype.getExpiryTimeout=function(){if(this.expirationTime)return this.expiredRequestCount?1e3*(1<<Math.min(this.expiredRequestCount-1,31)):Math.min(this.expirationTime-new Date().getTime(),Math.pow(2,31)-1)},Xi.prototype.setFeatureState=function(e,t){if(this.latestFeatureIndex&&this.latestFeatureIndex.rawTileData&&Object.keys(e).length!==0){var i=this.latestFeatureIndex.loadVTLayers();for(var u in this.buckets)if(t.style.hasLayer(u)){var f=this.buckets[u],m=f.layers[0].sourceLayer||"_geojsonTileLayer",x=i[m],k=e[m];if(x&&k&&Object.keys(k).length!==0){f.update(k,x,this.imageAtlas&&this.imageAtlas.patternPositions||{});var A=t&&t.style&&t.style.getLayer(u);A&&(this.queryPadding=Math.max(this.queryPadding,A.queryRadius(f)))}}}},Xi.prototype.holdingForFade=function(){return this.symbolFadeHoldUntil!==void 0},Xi.prototype.symbolFadeFinished=function(){return!this.symbolFadeHoldUntil||this.symbolFadeHoldUntil<Sr.now()},Xi.prototype.clearFadeHold=function(){this.symbolFadeHoldUntil=void 0},Xi.prototype.setHoldDuration=function(e){this.symbolFadeHoldUntil=Sr.now()+e},Xi.prototype.setDependencies=function(e,t){for(var i={},u=0,f=t;u<f.length;u+=1)i[f[u]]=!0;this.dependencies[e]=i},Xi.prototype.hasDependency=function(e,t){for(var i=0,u=e;i<u.length;i+=1){var f=this.dependencies[u[i]];if(f){for(var m=0,x=t;m<x.length;m+=1)if(f[x[m]])return!0}}return!1};var Jo=M.performance,Hf=function(e){this._marks={start:[e.url,"start"].join("#"),end:[e.url,"end"].join("#"),measure:e.url.toString()},Jo.mark(this._marks.start)};Hf.prototype.finish=function(){Jo.mark(this._marks.end);var e=Jo.getEntriesByName(this._marks.measure);return e.length===0&&(Jo.measure(this._marks.measure,this._marks.start,this._marks.end),e=Jo.getEntriesByName(this._marks.measure),Jo.clearMarks(this._marks.start),Jo.clearMarks(this._marks.end),Jo.clearMeasures(this._marks.measure)),e},a.Actor=yl,a.AlphaImage=Ts,a.CanonicalTileID=zs,a.CollisionBoxArray=s,a.Color=fr,a.DEMData=Po,a.DataConstantProperty=Et,a.DictionaryCoder=jc,a.EXTENT=8192,a.ErrorEvent=le,a.EvaluationParameters=lr,a.Event=W,a.Evented=fe,a.FeatureIndex=Co,a.FillBucket=Ra,a.FillExtrusionBucket=Ba,a.ImageAtlas=gu,a.ImagePosition=Lc,a.LineBucket=Dn,a.LngLat=Yr,a.LngLatBounds=Mi,a.MercatorCoordinate=As,a.ONE_EM=24,a.OverscaledTileID=Di,a.Point=F,a.Point$1=F,a.Properties=nn,a.Protobuf=Mc,a.RGBAImage=Kn,a.RequestManager=ci,a.RequestPerformance=Hf,a.ResourceType=ha,a.SegmentVector=Z,a.SourceFeatureState=gl,a.StructArrayLayout1ui2=lu,a.StructArrayLayout2f1f2i16=To,a.StructArrayLayout2i4=Eo,a.StructArrayLayout3ui6=Wa,a.StructArrayLayout4i8=nu,a.SymbolBucket=Mr,a.Texture=Is,a.Tile=Xi,a.Transitionable=rn,a.Uniform1f=Qe,a.Uniform1i=Ve,a.Uniform2f=We,a.Uniform3f=ft,a.Uniform4f=Tt,a.UniformColor=Dt,a.UniformMatrix4f=gr,a.UnwrappedTileID=Gf,a.ValidationError=J,a.WritingMode=sa,a.ZoomHistory=Ql,a.add=function(e,t,i){return e[0]=t[0]+i[0],e[1]=t[1]+i[1],e[2]=t[2]+i[2],e},a.addDynamicAttributes=cp,a.asyncAll=function(e,t,i){if(!e.length)return i(null,[]);var u=e.length,f=new Array(e.length),m=null;e.forEach(function(x,k){t(x,function(A,z){A&&(m=A),f[k]=z,--u==0&&i(m,f)})})},a.bezier=ae,a.bindAll=Ct,a.browser=Sr,a.cacheEntryPossiblyAdded=function(e){++Pn>en&&(e.getActor().send("enforceCacheSizeLimit",An),Pn=0)},a.clamp=he,a.clearTileCache=function(e){var t=M.caches.delete("mapbox-tiles");e&&t.catch(e).then(function(){return e()})},a.clipLine=Af,a.clone=function(e){var t=new kr(16);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t},a.clone$1=gt,a.clone$2=function(e){var t=new kr(3);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t},a.collisionCircleLayout=pg,a.config=Gt,a.create=function(){var e=new kr(16);return kr!=Float32Array&&(e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[11]=0,e[12]=0,e[13]=0,e[14]=0),e[0]=1,e[5]=1,e[10]=1,e[15]=1,e},a.create$1=function(){var e=new kr(9);return kr!=Float32Array&&(e[1]=0,e[2]=0,e[3]=0,e[5]=0,e[6]=0,e[7]=0),e[0]=1,e[4]=1,e[8]=1,e},a.create$2=function(){var e=new kr(4);return kr!=Float32Array&&(e[1]=0,e[2]=0),e[0]=1,e[3]=1,e},a.createCommonjsModule=E,a.createExpression=qs,a.createLayout=Ki,a.createStyleLayer=function(e){return e.type==="custom"?new Gg(e):new Zg[e.type](e)},a.cross=function(e,t,i){var u=t[0],f=t[1],m=t[2],x=i[0],k=i[1],A=i[2];return e[0]=f*A-m*k,e[1]=m*x-u*A,e[2]=u*k-f*x,e},a.deepEqual=function e(t,i){if(Array.isArray(t)){if(!Array.isArray(i)||t.length!==i.length)return!1;for(var u=0;u<t.length;u++)if(!e(t[u],i[u]))return!1;return!0}if(typeof t=="object"&&t!==null&&i!==null){if(typeof i!="object"||Object.keys(t).length!==Object.keys(i).length)return!1;for(var f in t)if(!e(t[f],i[f]))return!1;return!0}return t===i},a.dot=function(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]},a.dot$1=function(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]+e[3]*t[3]},a.ease=se,a.emitValidationErrors=ys,a.endsWith=kt,a.enforceCacheSizeLimit=function(e){Ri(),qr&&qr.then(function(t){t.keys().then(function(i){for(var u=0;u<i.length-e;u++)t.delete(i[u])})})},a.evaluateSizeForFeature=wf,a.evaluateSizeForZoom=Sf,a.evaluateVariableOffset=Cf,a.evented=tu,a.extend=_e,a.featureFilter=Gs,a.filterObject=Ke,a.fromRotation=function(e,t){var i=Math.sin(t),u=Math.cos(t);return e[0]=u,e[1]=i,e[2]=0,e[3]=-i,e[4]=u,e[5]=0,e[6]=0,e[7]=0,e[8]=1,e},a.getAnchorAlignment=op,a.getAnchorJustification=up,a.getArrayBuffer=re,a.getImage=N,a.getJSON=function(e,t){return fi(_e(e,{type:"json"}),t)},a.getRTLTextPluginStatus=ru,a.getReferrer=Or,a.getVideo=function(e,t){var i,u,f=M.document.createElement("video");f.muted=!0,f.onloadstart=function(){t(null,f)};for(var m=0;m<e.length;m++){var x=M.document.createElement("source");i=e[m],u=void 0,(u=M.document.createElement("a")).href=i,(u.protocol!==M.document.location.protocol||u.host!==M.document.location.host)&&(f.crossOrigin="Anonymous"),x.src=e[m],f.appendChild(x)}return{cancel:function(){}}},a.identity=ea,a.invert=function(e,t){var i=t[0],u=t[1],f=t[2],m=t[3],x=t[4],k=t[5],A=t[6],z=t[7],D=t[8],B=t[9],V=t[10],j=t[11],Q=t[12],$=t[13],pe=t[14],oe=t[15],ye=i*k-u*x,xe=i*A-f*x,Se=i*z-m*x,Te=u*A-f*k,Me=u*z-m*k,Xe=f*z-m*A,rt=D*$-B*Q,wt=D*pe-V*Q,ut=D*oe-j*Q,It=B*pe-V*$,ht=B*oe-j*$,$t=V*oe-j*pe,Bt=ye*$t-xe*ht+Se*It+Te*ut-Me*wt+Xe*rt;return Bt?(e[0]=(k*$t-A*ht+z*It)*(Bt=1/Bt),e[1]=(f*ht-u*$t-m*It)*Bt,e[2]=($*Xe-pe*Me+oe*Te)*Bt,e[3]=(V*Me-B*Xe-j*Te)*Bt,e[4]=(A*ut-x*$t-z*wt)*Bt,e[5]=(i*$t-f*ut+m*wt)*Bt,e[6]=(pe*Se-Q*Xe-oe*xe)*Bt,e[7]=(D*Xe-V*Se+j*xe)*Bt,e[8]=(x*ht-k*ut+z*rt)*Bt,e[9]=(u*ut-i*ht-m*rt)*Bt,e[10]=(Q*Me-$*Se+oe*ye)*Bt,e[11]=(B*Se-D*Me-j*ye)*Bt,e[12]=(k*wt-x*It-A*rt)*Bt,e[13]=(i*It-u*wt+f*rt)*Bt,e[14]=($*xe-Q*Te-pe*ye)*Bt,e[15]=(D*Te-B*xe+V*ye)*Bt,e):null},a.isChar=at,a.isMapboxURL=$r,a.keysDifference=function(e,t){var i=[];for(var u in e)u in t||i.push(u);return i},a.makeRequest=fi,a.mapObject=Ge,a.mercatorXfromLng=Uf,a.mercatorYfromLat=qf,a.mercatorZfromAltitude=jf,a.mul=Xh,a.multiply=Mn,a.mvt=sl,a.nextPowerOfTwo=function(e){return e<=1?1:Math.pow(2,Math.ceil(Math.log(e)/Math.LN2))},a.normalize=function(e,t){var i=t[0],u=t[1],f=t[2],m=i*i+u*u+f*f;return m>0&&(m=1/Math.sqrt(m)),e[0]=t[0]*m,e[1]=t[1]*m,e[2]=t[2]*m,e},a.number=xi,a.offscreenCanvasSupported=vi,a.ortho=function(e,t,i,u,f,m,x){var k=1/(t-i),A=1/(u-f),z=1/(m-x);return e[0]=-2*k,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=-2*A,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=2*z,e[11]=0,e[12]=(t+i)*k,e[13]=(f+u)*A,e[14]=(x+m)*z,e[15]=1,e},a.parseGlyphPBF=function(e){return new Mc(e).readFields(Sg,[])},a.pbf=Mc,a.performSymbolLayout=function(e,t,i,u,f,m,x){e.createArrays(),e.tilePixelRatio=8192/(512*e.overscaling),e.compareText={},e.iconsNeedLinear=!1;var k=e.layers[0].layout,A=e.layers[0]._unevaluatedLayout._values,z={};if(e.textSizeData.kind==="composite"){var D=e.textSizeData,B=D.maxZoom;z.compositeTextSizes=[A["text-size"].possiblyEvaluate(new lr(D.minZoom),x),A["text-size"].possiblyEvaluate(new lr(B),x)]}if(e.iconSizeData.kind==="composite"){var V=e.iconSizeData,j=V.maxZoom;z.compositeIconSizes=[A["icon-size"].possiblyEvaluate(new lr(V.minZoom),x),A["icon-size"].possiblyEvaluate(new lr(j),x)]}z.layoutTextSize=A["text-size"].possiblyEvaluate(new lr(e.zoom+1),x),z.layoutIconSize=A["icon-size"].possiblyEvaluate(new lr(e.zoom+1),x),z.textMaxSize=A["text-size"].possiblyEvaluate(new lr(18));for(var Q=24*k.get("text-line-height"),$=k.get("text-rotation-alignment")==="map"&&k.get("symbol-placement")!=="point",pe=k.get("text-keep-upright"),oe=k.get("text-size"),ye=function(){var Te=Se[xe],Me=k.get("text-font").evaluate(Te,{},x).join(","),Xe=oe.evaluate(Te,{},x),rt=z.layoutTextSize.evaluate(Te,{},x),wt=z.layoutIconSize.evaluate(Te,{},x),ut={horizontal:{},vertical:void 0},It=Te.text,ht=[0,0];if(It){var $t=It.toString(),Bt=24*k.get("text-letter-spacing").evaluate(Te,{},x),vt=function(hr){for(var Rr=0,Pr=hr;Rr<Pr.length;Rr+=1)if(_r=Pr[Rr].charCodeAt(0),at.Arabic(_r)||at["Arabic Supplement"](_r)||at["Arabic Extended-A"](_r)||at["Arabic Presentation Forms-A"](_r)||at["Arabic Presentation Forms-B"](_r))return!1;var _r;return!0}($t)?Bt:0,sr=k.get("text-anchor").evaluate(Te,{},x),Kt=k.get("text-variable-anchor");if(!Kt){var yr=k.get("text-radial-offset").evaluate(Te,{},x);ht=yr?Cf(sr,[24*yr,lp]):k.get("text-offset").evaluate(Te,{},x).map(function(hr){return 24*hr})}var At=$?"center":k.get("text-justify").evaluate(Te,{},x),xr=k.get("symbol-placement"),Jr=xr==="point"?24*k.get("text-max-width").evaluate(Te,{},x):0,li=function(){e.allowVerticalPlacement&&$l($t)&&(ut.vertical=Rc(It,t,i,f,Me,Jr,Q,sr,"left",vt,ht,sa.vertical,!0,xr,rt,Xe))};if(!$&&Kt){for(var ii=At==="auto"?Kt.map(function(hr){return up(hr)}):[At],Qr=!1,ui=0;ui<ii.length;ui++){var Ni=ii[ui];if(!ut.horizontal[Ni])if(Qr)ut.horizontal[Ni]=ut.horizontal[0];else{var Vi=Rc(It,t,i,f,Me,Jr,Q,"center",Ni,vt,ht,sa.horizontal,!1,xr,rt,Xe);Vi&&(ut.horizontal[Ni]=Vi,Qr=Vi.positionedLines.length===1)}}li()}else{At==="auto"&&(At=up(sr));var xn=Rc(It,t,i,f,Me,Jr,Q,sr,At,vt,ht,sa.horizontal,!1,xr,rt,Xe);xn&&(ut.horizontal[At]=xn),li(),$l($t)&&$&&pe&&(ut.vertical=Rc(It,t,i,f,Me,Jr,Q,sr,At,vt,ht,sa.vertical,!1,xr,rt,Xe))}}var Wi=void 0,wn=!1;if(Te.icon&&Te.icon.name){var mi=u[Te.icon.name];mi&&(Wi=function(hr,Rr,Pr){var _r=op(Pr),Ln=Rr[0]-hr.displaySize[0]*_r.horizontalAlign,fn=Rr[1]-hr.displaySize[1]*_r.verticalAlign;return{image:hr,top:fn,bottom:fn+hr.displaySize[1],left:Ln,right:Ln+hr.displaySize[0]}}(f[Te.icon.name],k.get("icon-offset").evaluate(Te,{},x),k.get("icon-anchor").evaluate(Te,{},x)),wn=mi.sdf,e.sdfIcons===void 0?e.sdfIcons=mi.sdf:e.sdfIcons!==mi.sdf&&je("Style sheet warning: Cannot mix SDF and non-SDF icons in one buffer"),(mi.pixelRatio!==e.pixelRatio||k.get("icon-rotate").constantOr(1)!==0)&&(e.iconsNeedLinear=!0))}var Yi=Df(ut.horizontal)||ut.vertical;e.iconsInText=!!Yi&&Yi.iconsInText,(Yi||Wi)&&function(hr,Rr,Pr,_r,Ln,fn,Zr,Si,dn,wr,to){var la=fn.textMaxSize.evaluate(Rr,{});la===void 0&&(la=Zr);var ro,yi=hr.layers[0].layout,io=yi.get("icon-offset").evaluate(Rr,{},to),Pa=Df(Pr.horizontal),_l=Zr/24,Ps=hr.tilePixelRatio*_l,vl=hr.tilePixelRatio*la/24,Mo=hr.tilePixelRatio*Si,bl=hr.tilePixelRatio*yi.get("symbol-spacing"),Zc=yi.get("text-padding")*hr.tilePixelRatio,xl=yi.get("icon-padding")*hr.tilePixelRatio,bu=yi.get("text-max-angle")/180*Math.PI,Kc=yi.get("text-rotation-alignment")==="map"&&yi.get("symbol-placement")!=="point",Hc=yi.get("icon-rotation-alignment")==="map"&&yi.get("symbol-placement")!=="point",Do=yi.get("symbol-placement"),xu=bl/2,wl=yi.get("icon-text-fit");_r&&wl!=="none"&&(hr.allowVerticalPlacement&&Pr.vertical&&(ro=xf(_r,Pr.vertical,wl,yi.get("icon-text-fit-padding"),io,_l)),Pa&&(_r=xf(_r,Pa,wl,yi.get("icon-text-fit-padding"),io,_l)));var Qo=function(Hg,zu){zu.x<0||zu.x>=8192||zu.y<0||zu.y>=8192||function(gi,Oa,Xg,$o,_p,Yf,$c,no,eh,Pu,th,rh,vp,Jf,Cu,Qf,$f,ed,td,rd,ua,ih,id,ao,Wg){var nd,Ms,Il,Al,zl,Pl=gi.addToLineVertexArray(Oa,Xg),ad=0,od=0,sd=0,ld=0,bp=-1,xp=-1,Lo={},ud=Y(""),wp=0,Sp=0;if(no._unevaluatedLayout.getValue("text-radial-offset")===void 0?(wp=(nd=no.layout.get("text-offset").evaluate(ua,{},ao).map(function(Du){return 24*Du}))[0],Sp=nd[1]):(wp=24*no.layout.get("text-radial-offset").evaluate(ua,{},ao),Sp=lp),gi.allowVerticalPlacement&&$o.vertical){var cd=no.layout.get("text-rotate").evaluate(ua,{},ao)+90;Al=new Vc(eh,Oa,Pu,th,rh,$o.vertical,vp,Jf,Cu,cd),$c&&(zl=new Vc(eh,Oa,Pu,th,rh,$c,$f,ed,Cu,cd))}if(_p){var kp=no.layout.get("icon-rotate").evaluate(ua,{}),hd=no.layout.get("icon-text-fit")!=="none",pd=zf(_p,kp,id,hd),Ep=$c?zf($c,kp,id,hd):void 0;Il=new Vc(eh,Oa,Pu,th,rh,_p,$f,ed,!1,kp),ad=4*pd.length;var fd=gi.iconSizeData,Mu=null;fd.kind==="source"?(Mu=[128*no.layout.get("icon-size").evaluate(ua,{})])[0]>32640&&je(gi.layerIds[0]+': Value for "icon-size" is >= 255. Reduce your "icon-size".'):fd.kind==="composite"&&((Mu=[128*ih.compositeIconSizes[0].evaluate(ua,{},ao),128*ih.compositeIconSizes[1].evaluate(ua,{},ao)])[0]>32640||Mu[1]>32640)&&je(gi.layerIds[0]+': Value for "icon-size" is >= 255. Reduce your "icon-size".'),gi.addSymbols(gi.icon,pd,Mu,rd,td,ua,!1,Oa,Pl.lineStartIndex,Pl.lineLength,-1,ao),bp=gi.icon.placedSymbolArray.length-1,Ep&&(od=4*Ep.length,gi.addSymbols(gi.icon,Ep,Mu,rd,td,ua,sa.vertical,Oa,Pl.lineStartIndex,Pl.lineLength,-1,ao),xp=gi.icon.placedSymbolArray.length-1)}for(var dd in $o.horizontal){var nh=$o.horizontal[dd];if(!Ms){ud=Y(nh.text);var Yg=no.layout.get("text-rotate").evaluate(ua,{},ao);Ms=new Vc(eh,Oa,Pu,th,rh,nh,vp,Jf,Cu,Yg)}var md=nh.positionedLines.length===1;if(sd+=Mf(gi,Oa,nh,Yf,no,Cu,ua,Qf,Pl,$o.vertical?sa.horizontal:sa.horizontalOnly,md?Object.keys($o.horizontal):[dd],Lo,bp,ih,ao),md)break}$o.vertical&&(ld+=Mf(gi,Oa,$o.vertical,Yf,no,Cu,ua,Qf,Pl,sa.vertical,["vertical"],Lo,xp,ih,ao));var Jg=Ms?Ms.boxStartIndex:gi.collisionBoxArray.length,Qg=Ms?Ms.boxEndIndex:gi.collisionBoxArray.length,$g=Al?Al.boxStartIndex:gi.collisionBoxArray.length,e_=Al?Al.boxEndIndex:gi.collisionBoxArray.length,t_=Il?Il.boxStartIndex:gi.collisionBoxArray.length,r_=Il?Il.boxEndIndex:gi.collisionBoxArray.length,i_=zl?zl.boxStartIndex:gi.collisionBoxArray.length,n_=zl?zl.boxEndIndex:gi.collisionBoxArray.length,oo=-1,ah=function(Du,gd){return Du&&Du.circleDiameter?Math.max(Du.circleDiameter,gd):gd};oo=ah(Ms,oo),oo=ah(Al,oo),oo=ah(Il,oo);var yd=(oo=ah(zl,oo))>-1?1:0;yd&&(oo*=Wg/24),gi.glyphOffsetArray.length>=Mr.MAX_GLYPHS&&je("Too many glyphs being rendered in a tile. See https://github.com/mapbox/mapbox-gl-js/issues/2907"),ua.sortKey!==void 0&&gi.addToSortKeyRanges(gi.symbolInstances.length,ua.sortKey),gi.symbolInstances.emplaceBack(Oa.x,Oa.y,Lo.right>=0?Lo.right:-1,Lo.center>=0?Lo.center:-1,Lo.left>=0?Lo.left:-1,Lo.vertical||-1,bp,xp,ud,Jg,Qg,$g,e_,t_,r_,i_,n_,Pu,sd,ld,ad,od,yd,0,vp,wp,Sp,oo)}(hr,zu,Hg,Pr,_r,Ln,ro,hr.layers[0],hr.collisionBoxArray,Rr.index,Rr.sourceLayerIndex,hr.index,Ps,Zc,Kc,dn,Mo,xl,Hc,io,Rr,fn,wr,to,Zr)};if(Do==="line")for(var Sl=0,Xc=Af(Rr.geometry,0,0,8192,8192);Sl<Xc.length;Sl+=1)for(var Wc=Xc[Sl],wu=0,Su=Pg(Wc,bl,bu,Pr.vertical||Pa,_r,24,vl,hr.overscaling,8192);wu<Su.length;wu+=1){var Yc=Su[wu];Pa&&Lg(hr,Pa.text,xu,Yc)||Qo(Wc,Yc)}else if(Do==="line-center")for(var ku=0,Eu=Rr.geometry;ku<Eu.length;ku+=1){var Tu=Eu[ku];if(Tu.length>1){var Jc=zg(Tu,bu,Pr.vertical||Pa,_r,24,vl);Jc&&Qo(Tu,Jc)}}else if(Rr.type==="Polygon")for(var kl=0,Qc=tp(Rr.geometry,0);kl<Qc.length;kl+=1){var El=Qc[kl],Iu=Mg(El,16);Qo(El[0],new hl(Iu.x,Iu.y,0))}else if(Rr.type==="LineString")for(var Cs=0,Au=Rr.geometry;Cs<Au.length;Cs+=1){var Tl=Au[Cs];Qo(Tl,new hl(Tl[0].x,Tl[0].y,0))}else if(Rr.type==="Point")for(var mp=0,Xf=Rr.geometry;mp<Xf.length;mp+=1)for(var yp=0,Wf=Xf[mp];yp<Wf.length;yp+=1){var gp=Wf[yp];Qo([gp],new hl(gp.x,gp.y,0))}}(e,Te,ut,Wi,u,z,rt,wt,ht,wn,x)},xe=0,Se=e.features;xe<Se.length;xe+=1)ye();m&&e.generateCollisionDebugBuffers()},a.perspective=function(e,t,i,u,f){var m,x=1/Math.tan(t/2);return e[0]=x/i,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=x,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[11]=-1,e[12]=0,e[13]=0,e[15]=0,f!=null&&f!==1/0?(e[10]=(f+u)*(m=1/(u-f)),e[14]=2*f*u*m):(e[10]=-1,e[14]=-2*u),e},a.pick=function(e,t){for(var i={},u=0;u<t.length;u++){var f=t[u];f in e&&(i[f]=e[f])}return i},a.plugin=$n,a.polygonIntersectsPolygon=Qa,a.postMapLoadEvent=Ui,a.postTurnstileEvent=$i,a.potpack=gf,a.refProperties=["type","source","source-layer","minzoom","maxzoom","filter","layout"],a.register=mt,a.registerForPluginStateChange=function(e){return e({pluginStatus:jn,pluginURL:Ma}),tu.on("pluginStateChange",e),e},a.renderColorRamp=Jp,a.rotate=function(e,t,i){var u=t[0],f=t[1],m=t[2],x=t[3],k=Math.sin(i),A=Math.cos(i);return e[0]=u*A+m*k,e[1]=f*A+x*k,e[2]=u*-k+m*A,e[3]=f*-k+x*A,e},a.rotateX=function(e,t,i){var u=Math.sin(i),f=Math.cos(i),m=t[4],x=t[5],k=t[6],A=t[7],z=t[8],D=t[9],B=t[10],V=t[11];return t!==e&&(e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e[4]=m*f+z*u,e[5]=x*f+D*u,e[6]=k*f+B*u,e[7]=A*f+V*u,e[8]=z*f-m*u,e[9]=D*f-x*u,e[10]=B*f-k*u,e[11]=V*f-A*u,e},a.rotateZ=function(e,t,i){var u=Math.sin(i),f=Math.cos(i),m=t[0],x=t[1],k=t[2],A=t[3],z=t[4],D=t[5],B=t[6],V=t[7];return t!==e&&(e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e[0]=m*f+z*u,e[1]=x*f+D*u,e[2]=k*f+B*u,e[3]=A*f+V*u,e[4]=z*f-m*u,e[5]=D*f-x*u,e[6]=B*f-k*u,e[7]=V*f-A*u,e},a.scale=function(e,t,i){var u=i[0],f=i[1],m=i[2];return e[0]=t[0]*u,e[1]=t[1]*u,e[2]=t[2]*u,e[3]=t[3]*u,e[4]=t[4]*f,e[5]=t[5]*f,e[6]=t[6]*f,e[7]=t[7]*f,e[8]=t[8]*m,e[9]=t[9]*m,e[10]=t[10]*m,e[11]=t[11]*m,e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15],e},a.scale$1=function(e,t,i){return e[0]=t[0]*i,e[1]=t[1]*i,e[2]=t[2]*i,e[3]=t[3]*i,e},a.scale$2=function(e,t,i){return e[0]=t[0]*i,e[1]=t[1]*i,e[2]=t[2]*i,e},a.setCacheLimits=function(e,t){An=e,en=t},a.setRTLTextPlugin=function(e,t,i){if(i===void 0&&(i=!1),jn==="deferred"||jn==="loading"||jn==="loaded")throw new Error("setRTLTextPlugin cannot be called multiple times.");Ma=Sr.resolveURL(e),jn="deferred",Js=t,_s(),i||ma()},a.sphericalToCartesian=function(e){var t=e[0],i=e[1],u=e[2];return i+=90,i*=Math.PI/180,u*=Math.PI/180,{x:t*Math.cos(i)*Math.sin(u),y:t*Math.sin(i)*Math.sin(u),z:t*Math.cos(u)}},a.sqrLen=function(e){var t=e[0],i=e[1];return t*t+i*i},a.styleSpec=U,a.sub=function(e,t,i){return e[0]=t[0]-i[0],e[1]=t[1]-i[1],e[2]=t[2]-i[2],e},a.symbolSize=Ag,a.transformMat3=function(e,t,i){var u=t[0],f=t[1],m=t[2];return e[0]=u*i[0]+f*i[3]+m*i[6],e[1]=u*i[1]+f*i[4]+m*i[7],e[2]=u*i[2]+f*i[5]+m*i[8],e},a.transformMat4=il,a.translate=function(e,t,i){var u,f,m,x,k,A,z,D,B,V,j,Q,$=i[0],pe=i[1],oe=i[2];return t===e?(e[12]=t[0]*$+t[4]*pe+t[8]*oe+t[12],e[13]=t[1]*$+t[5]*pe+t[9]*oe+t[13],e[14]=t[2]*$+t[6]*pe+t[10]*oe+t[14],e[15]=t[3]*$+t[7]*pe+t[11]*oe+t[15]):(f=t[1],m=t[2],x=t[3],k=t[4],A=t[5],z=t[6],D=t[7],B=t[8],V=t[9],j=t[10],Q=t[11],e[0]=u=t[0],e[1]=f,e[2]=m,e[3]=x,e[4]=k,e[5]=A,e[6]=z,e[7]=D,e[8]=B,e[9]=V,e[10]=j,e[11]=Q,e[12]=u*$+k*pe+B*oe+t[12],e[13]=f*$+A*pe+V*oe+t[13],e[14]=m*$+z*pe+j*oe+t[14],e[15]=x*$+D*pe+Q*oe+t[15]),e},a.triggerPluginCompletionEvent=Ec,a.uniqueId=Fe,a.validateCustomStyleLayer=function(e){var t=[],i=e.id;return i===void 0&&t.push({message:"layers."+i+': missing required property "id"'}),e.render===void 0&&t.push({message:"layers."+i+': missing required method "render"'}),e.renderingMode&&e.renderingMode!=="2d"&&e.renderingMode!=="3d"&&t.push({message:"layers."+i+': property "renderingMode" must be either "2d" or "3d"'}),t},a.validateLight=Kh,a.validateStyle=ds,a.values=function(e){var t=[];for(var i in e)t.push(e[i]);return t},a.vectorTile=sl,a.version="1.13.2",a.warnOnce=je,a.webpSupported=Ei,a.window=M,a.wrap=me}),v(["./shared"],function(a){function E(R){var N=typeof R;if(N==="number"||N==="boolean"||N==="string"||R==null)return JSON.stringify(R);if(Array.isArray(R)){for(var q="[",K=0,W=R;K<W.length;K+=1)q+=E(W[K])+",";return q+"]"}for(var le=Object.keys(R).sort(),fe="{",U=0;U<le.length;U++)fe+=JSON.stringify(le[U])+":"+E(R[le[U]])+",";return fe+"}"}function T(R){for(var N="",q=0,K=a.refProperties;q<K.length;q+=1)N+="/"+E(R[K[q]]);return N}var L=function(R){this.keyCache={},R&&this.replace(R)};L.prototype.replace=function(R){this._layerConfigs={},this._layers={},this.update(R,[])},L.prototype.update=function(R,N){for(var q=this,K=0,W=R;K<W.length;K+=1){var le=W[K];this._layerConfigs[le.id]=le;var fe=this._layers[le.id]=a.createStyleLayer(le);fe._featureFilter=a.featureFilter(fe.filter),this.keyCache[le.id]&&delete this.keyCache[le.id]}for(var U=0,J=N;U<J.length;U+=1){var ge=J[U];delete this.keyCache[ge],delete this._layerConfigs[ge],delete this._layers[ge]}this.familiesBySource={};for(var De=0,Ne=function(Je,He){for(var Zt={},st=0;st<Je.length;st++){var nr=He&&He[Je[st].id]||T(Je[st]);He&&(He[Je[st].id]=nr);var br=Zt[nr];br||(br=Zt[nr]=[]),br.push(Je[st])}var Xt=[];for(var pr in Zt)Xt.push(Zt[pr]);return Xt}(a.values(this._layerConfigs),this.keyCache);De<Ne.length;De+=1){var ke=Ne[De].map(function(Je){return q._layers[Je.id]}),Le=ke[0];if(Le.visibility!=="none"){var pt=Le.source||"",lt=this.familiesBySource[pt];lt||(lt=this.familiesBySource[pt]={});var Ie=Le.sourceLayer||"_geojsonTileLayer",nt=lt[Ie];nt||(nt=lt[Ie]=[]),nt.push(ke)}}};var F=function(R){var N={},q=[];for(var K in R){var W=R[K],le=N[K]={};for(var fe in W){var U=W[+fe];if(U&&U.bitmap.width!==0&&U.bitmap.height!==0){var J={x:0,y:0,w:U.bitmap.width+2,h:U.bitmap.height+2};q.push(J),le[fe]={rect:J,metrics:U.metrics}}}}var ge=a.potpack(q),De=new a.AlphaImage({width:ge.w||1,height:ge.h||1});for(var Ne in R){var ke=R[Ne];for(var Le in ke){var pt=ke[+Le];if(pt&&pt.bitmap.width!==0&&pt.bitmap.height!==0){var lt=N[Ne][Le].rect;a.AlphaImage.copy(pt.bitmap,De,{x:0,y:0},{x:lt.x+1,y:lt.y+1},pt.bitmap)}}}this.image=De,this.positions=N};a.register("GlyphAtlas",F);var C=function(R){this.tileID=new a.OverscaledTileID(R.tileID.overscaledZ,R.tileID.wrap,R.tileID.canonical.z,R.tileID.canonical.x,R.tileID.canonical.y),this.uid=R.uid,this.zoom=R.zoom,this.pixelRatio=R.pixelRatio,this.tileSize=R.tileSize,this.source=R.source,this.overscaling=this.tileID.overscaleFactor(),this.showCollisionBoxes=R.showCollisionBoxes,this.collectResourceTiming=!!R.collectResourceTiming,this.returnDependencies=!!R.returnDependencies,this.promoteId=R.promoteId};function M(R,N,q){for(var K=new a.EvaluationParameters(N),W=0,le=R;W<le.length;W+=1)le[W].recalculate(K,q)}function X(R,N){var q=a.getArrayBuffer(R.request,function(K,W,le,fe){K?N(K):W&&N(null,{vectorTile:new a.vectorTile.VectorTile(new a.pbf(W)),rawData:W,cacheControl:le,expires:fe})});return function(){q.cancel(),N()}}C.prototype.parse=function(R,N,q,K,W){var le=this;this.status="parsing",this.data=R,this.collisionBoxArray=new a.CollisionBoxArray;var fe=new a.DictionaryCoder(Object.keys(R.layers).sort()),U=new a.FeatureIndex(this.tileID,this.promoteId);U.bucketLayerIDs=[];var J,ge,De,Ne,ke={},Le={featureIndex:U,iconDependencies:{},patternDependencies:{},glyphDependencies:{},availableImages:q},pt=N.familiesBySource[this.source];for(var lt in pt){var Ie=R.layers[lt];if(Ie){Ie.version===1&&a.warnOnce('Vector tile source "'+this.source+'" layer "'+lt+'" does not use vector tile spec v2 and therefore may have some rendering errors.');for(var nt=fe.encode(lt),Je=[],He=0;He<Ie.length;He++){var Zt=Ie.feature(He),st=U.getId(Zt,lt);Je.push({feature:Zt,id:st,index:He,sourceLayerIndex:nt})}for(var nr=0,br=pt[lt];nr<br.length;nr+=1){var Xt=br[nr],pr=Xt[0];pr.minzoom&&this.zoom<Math.floor(pr.minzoom)||pr.maxzoom&&this.zoom>=pr.maxzoom||pr.visibility!=="none"&&(M(Xt,this.zoom,q),(ke[pr.id]=pr.createBucket({index:U.bucketLayerIDs.length,layers:Xt,zoom:this.zoom,pixelRatio:this.pixelRatio,overscaling:this.overscaling,collisionBoxArray:this.collisionBoxArray,sourceLayerIndex:nt,sourceID:this.source})).populate(Je,Le,this.tileID.canonical),U.bucketLayerIDs.push(Xt.map(function(vr){return vr.id})))}}}var ar=a.mapObject(Le.glyphDependencies,function(vr){return Object.keys(vr).map(Number)});Object.keys(ar).length?K.send("getGlyphs",{uid:this.uid,stacks:ar},function(vr,Qt){J||(J=vr,ge=Qt,Fr.call(le))}):ge={};var bi=Object.keys(Le.iconDependencies);bi.length?K.send("getImages",{icons:bi,source:this.source,tileID:this.tileID,type:"icons"},function(vr,Qt){J||(J=vr,De=Qt,Fr.call(le))}):De={};var mr=Object.keys(Le.patternDependencies);function Fr(){if(J)return W(J);if(ge&&De&&Ne){var vr=new F(ge),Qt=new a.ImageAtlas(De,Ne);for(var fr in ke){var Ti=ke[fr];Ti instanceof a.SymbolBucket?(M(Ti.layers,this.zoom,q),a.performSymbolLayout(Ti,ge,vr.positions,De,Qt.iconPositions,this.showCollisionBoxes,this.tileID.canonical)):Ti.hasPattern&&(Ti instanceof a.LineBucket||Ti instanceof a.FillBucket||Ti instanceof a.FillExtrusionBucket)&&(M(Ti.layers,this.zoom,q),Ti.addFeatures(Le,this.tileID.canonical,Qt.patternPositions))}this.status="done",W(null,{buckets:a.values(ke).filter(function(pa){return!pa.isEmpty()}),featureIndex:U,collisionBoxArray:this.collisionBoxArray,glyphAtlasImage:vr.image,imageAtlas:Qt,glyphMap:this.returnDependencies?ge:null,iconMap:this.returnDependencies?De:null,glyphPositions:this.returnDependencies?vr.positions:null})}}mr.length?K.send("getImages",{icons:mr,source:this.source,tileID:this.tileID,type:"patterns"},function(vr,Qt){J||(J=vr,Ne=Qt,Fr.call(le))}):Ne={},Fr.call(this)};var ae=function(R,N,q,K){this.actor=R,this.layerIndex=N,this.availableImages=q,this.loadVectorData=K||X,this.loading={},this.loaded={}};ae.prototype.loadTile=function(R,N){var q=this,K=R.uid;this.loading||(this.loading={});var W=!!(R&&R.request&&R.request.collectResourceTiming)&&new a.RequestPerformance(R.request),le=this.loading[K]=new C(R);le.abort=this.loadVectorData(R,function(fe,U){if(delete q.loading[K],fe||!U)return le.status="done",q.loaded[K]=le,N(fe);var J=U.rawData,ge={};U.expires&&(ge.expires=U.expires),U.cacheControl&&(ge.cacheControl=U.cacheControl);var De={};if(W){var Ne=W.finish();Ne&&(De.resourceTiming=JSON.parse(JSON.stringify(Ne)))}le.vectorTile=U.vectorTile,le.parse(U.vectorTile,q.layerIndex,q.availableImages,q.actor,function(ke,Le){if(ke||!Le)return N(ke);N(null,a.extend({rawTileData:J.slice(0)},Le,ge,De))}),q.loaded=q.loaded||{},q.loaded[K]=le})},ae.prototype.reloadTile=function(R,N){var q=this,K=this.loaded,W=R.uid,le=this;if(K&&K[W]){var fe=K[W];fe.showCollisionBoxes=R.showCollisionBoxes;var U=function(J,ge){var De=fe.reloadCallback;De&&(delete fe.reloadCallback,fe.parse(fe.vectorTile,le.layerIndex,q.availableImages,le.actor,De)),N(J,ge)};fe.status==="parsing"?fe.reloadCallback=U:fe.status==="done"&&(fe.vectorTile?fe.parse(fe.vectorTile,this.layerIndex,this.availableImages,this.actor,U):U())}},ae.prototype.abortTile=function(R,N){var q=this.loading,K=R.uid;q&&q[K]&&q[K].abort&&(q[K].abort(),delete q[K]),N()},ae.prototype.removeTile=function(R,N){var q=this.loaded,K=R.uid;q&&q[K]&&delete q[K],N()};var se=a.window.ImageBitmap,he=function(){this.loaded={}};function me(R,N){if(R.length!==0){_e(R[0],N);for(var q=1;q<R.length;q++)_e(R[q],!N)}}function _e(R,N){for(var q=0,K=0,W=R.length,le=W-1;K<W;le=K++)q+=(R[K][0]-R[le][0])*(R[le][1]+R[K][1]);q>=0!=!!N&&R.reverse()}he.prototype.loadTile=function(R,N){var q=R.uid,K=R.encoding,W=R.rawImageData,le=se&&W instanceof se?this.getImageData(W):W,fe=new a.DEMData(q,le,K);this.loaded=this.loaded||{},this.loaded[q]=fe,N(null,fe)},he.prototype.getImageData=function(R){this.offscreenCanvas&&this.offscreenCanvasContext||(this.offscreenCanvas=new OffscreenCanvas(R.width,R.height),this.offscreenCanvasContext=this.offscreenCanvas.getContext("2d")),this.offscreenCanvas.width=R.width,this.offscreenCanvas.height=R.height,this.offscreenCanvasContext.drawImage(R,0,0,R.width,R.height);var N=this.offscreenCanvasContext.getImageData(-1,-1,R.width+2,R.height+2);return this.offscreenCanvasContext.clearRect(0,0,this.offscreenCanvas.width,this.offscreenCanvas.height),new a.RGBAImage({width:N.width,height:N.height},N.data)},he.prototype.removeTile=function(R){var N=this.loaded,q=R.uid;N&&N[q]&&delete N[q]};var it=a.vectorTile.VectorTileFeature.prototype.toGeoJSON,Fe=function(R){this._feature=R,this.extent=a.EXTENT,this.type=R.type,this.properties=R.tags,"id"in R&&!isNaN(R.id)&&(this.id=parseInt(R.id,10))};Fe.prototype.loadGeometry=function(){if(this._feature.type===1){for(var R=[],N=0,q=this._feature.geometry;N<q.length;N+=1){var K=q[N];R.push([new a.Point$1(K[0],K[1])])}return R}for(var W=[],le=0,fe=this._feature.geometry;le<fe.length;le+=1){for(var U=[],J=0,ge=fe[le];J<ge.length;J+=1){var De=ge[J];U.push(new a.Point$1(De[0],De[1]))}W.push(U)}return W},Fe.prototype.toGeoJSON=function(R,N,q){return it.call(this,R,N,q)};var Pe=function(R){this.layers={_geojsonTileLayer:this},this.name="_geojsonTileLayer",this.extent=a.EXTENT,this.length=R.length,this._features=R};Pe.prototype.feature=function(R){return new Fe(this._features[R])};var Ze=a.vectorTile.VectorTileFeature,Ct=kt;function kt(R,N){this.options=N||{},this.features=R,this.length=R.length}function Ge(R,N){this.id=typeof R.id=="number"?R.id:void 0,this.type=R.type,this.rawGeometry=R.type===1?[R.geometry]:R.geometry,this.properties=R.tags,this.extent=N||4096}kt.prototype.feature=function(R){return new Ge(this.features[R],this.options.extent)},Ge.prototype.loadGeometry=function(){var R=this.rawGeometry;this.geometry=[];for(var N=0;N<R.length;N++){for(var q=R[N],K=[],W=0;W<q.length;W++)K.push(new a.Point$1(q[W][0],q[W][1]));this.geometry.push(K)}return this.geometry},Ge.prototype.bbox=function(){this.geometry||this.loadGeometry();for(var R=this.geometry,N=1/0,q=-1/0,K=1/0,W=-1/0,le=0;le<R.length;le++)for(var fe=R[le],U=0;U<fe.length;U++){var J=fe[U];N=Math.min(N,J.x),q=Math.max(q,J.x),K=Math.min(K,J.y),W=Math.max(W,J.y)}return[N,K,q,W]},Ge.prototype.toGeoJSON=Ze.prototype.toGeoJSON;var Ke=ur,gt=Ct;function ur(R){var N=new a.pbf;return function(q,K){for(var W in q.layers)K.writeMessage(3,je,q.layers[W])}(R,N),N.finish()}function je(R,N){var q;N.writeVarintField(15,R.version||1),N.writeStringField(1,R.name||""),N.writeVarintField(5,R.extent||4096);var K={keys:[],values:[],keycache:{},valuecache:{}};for(q=0;q<R.length;q++)K.feature=R.feature(q),N.writeMessage(2,Ft,K);var W=K.keys;for(q=0;q<W.length;q++)N.writeStringField(3,W[q]);var le=K.values;for(q=0;q<le.length;q++)N.writeMessage(4,Lt,le[q])}function Ft(R,N){var q=R.feature;q.id!==void 0&&N.writeVarintField(1,q.id),N.writeMessage(2,Be,R),N.writeVarintField(3,q.type),N.writeMessage(4,jt,q)}function Be(R,N){var q=R.feature,K=R.keys,W=R.values,le=R.keycache,fe=R.valuecache;for(var U in q.properties){var J=le[U];J===void 0&&(K.push(U),le[U]=J=K.length-1),N.writeVarint(J);var ge=q.properties[U],De=typeof ge;De!=="string"&&De!=="boolean"&&De!=="number"&&(ge=JSON.stringify(ge));var Ne=De+":"+ge,ke=fe[Ne];ke===void 0&&(W.push(ge),fe[Ne]=ke=W.length-1),N.writeVarint(ke)}}function $e(R,N){return(N<<3)+(7&R)}function yt(R){return R<<1^R>>31}function jt(R,N){for(var q=R.loadGeometry(),K=R.type,W=0,le=0,fe=q.length,U=0;U<fe;U++){var J=q[U],ge=1;K===1&&(ge=J.length),N.writeVarint($e(1,ge));for(var De=K===3?J.length-1:J.length,Ne=0;Ne<De;Ne++){Ne===1&&K!==1&&N.writeVarint($e(2,De-1));var ke=J[Ne].x-W,Le=J[Ne].y-le;N.writeVarint(yt(ke)),N.writeVarint(yt(Le)),W+=ke,le+=Le}K===3&&N.writeVarint($e(7,1))}}function Lt(R,N){var q=typeof R;q==="string"?N.writeStringField(1,R):q==="boolean"?N.writeBooleanField(7,R):q==="number"&&(R%1!=0?N.writeDoubleField(3,R):R<0?N.writeSVarintField(6,R):N.writeVarintField(5,R))}function St(R,N,q,K){Ce(R,q,K),Ce(N,2*q,2*K),Ce(N,2*q+1,2*K+1)}function Ce(R,N,q){var K=R[N];R[N]=R[q],R[q]=K}function ot(R,N,q,K){var W=R-q,le=N-K;return W*W+le*le}Ke.fromVectorTileJs=ur,Ke.fromGeojsonVt=function(R,N){N=N||{};var q={};for(var K in R)q[K]=new Ct(R[K].features,N),q[K].name=K,q[K].version=N.version,q[K].extent=N.extent;return ur({layers:q})},Ke.GeoJSONWrapper=gt;var Dr=function(R){return R[0]},Kr=function(R){return R[1]},ki=function(R,N,q,K,W){N===void 0&&(N=Dr),q===void 0&&(q=Kr),K===void 0&&(K=64),W===void 0&&(W=Float64Array),this.nodeSize=K,this.points=R;for(var le=R.length<65536?Uint16Array:Uint32Array,fe=this.ids=new le(R.length),U=this.coords=new W(2*R.length),J=0;J<R.length;J++)fe[J]=J,U[2*J]=N(R[J]),U[2*J+1]=q(R[J]);(function ge(De,Ne,ke,Le,pt,lt){if(!(pt-Le<=ke)){var Ie=Le+pt>>1;(function nt(Je,He,Zt,st,nr,br){for(;nr>st;){if(nr-st>600){var Xt=nr-st+1,pr=Zt-st+1,ar=Math.log(Xt),bi=.5*Math.exp(2*ar/3),mr=.5*Math.sqrt(ar*bi*(Xt-bi)/Xt)*(pr-Xt/2<0?-1:1);nt(Je,He,Zt,Math.max(st,Math.floor(Zt-pr*bi/Xt+mr)),Math.min(nr,Math.floor(Zt+(Xt-pr)*bi/Xt+mr)),br)}var Fr=He[2*Zt+br],vr=st,Qt=nr;for(St(Je,He,st,Zt),He[2*nr+br]>Fr&&St(Je,He,st,nr);vr<Qt;){for(St(Je,He,vr,Qt),vr++,Qt--;He[2*vr+br]<Fr;)vr++;for(;He[2*Qt+br]>Fr;)Qt--}He[2*st+br]===Fr?St(Je,He,st,Qt):St(Je,He,++Qt,nr),Qt<=Zt&&(st=Qt+1),Zt<=Qt&&(nr=Qt-1)}})(De,Ne,Ie,Le,pt,lt%2),ge(De,Ne,ke,Le,Ie-1,lt+1),ge(De,Ne,ke,Ie+1,pt,lt+1)}})(fe,U,K,0,fe.length-1,0)};ki.prototype.range=function(R,N,q,K){return function(W,le,fe,U,J,ge,De){for(var Ne,ke,Le=[0,W.length-1,0],pt=[];Le.length;){var lt=Le.pop(),Ie=Le.pop(),nt=Le.pop();if(Ie-nt<=De)for(var Je=nt;Je<=Ie;Je++)ke=le[2*Je+1],(Ne=le[2*Je])>=fe&&Ne<=J&&ke>=U&&ke<=ge&&pt.push(W[Je]);else{var He=Math.floor((nt+Ie)/2);ke=le[2*He+1],(Ne=le[2*He])>=fe&&Ne<=J&&ke>=U&&ke<=ge&&pt.push(W[He]);var Zt=(lt+1)%2;(lt===0?fe<=Ne:U<=ke)&&(Le.push(nt),Le.push(He-1),Le.push(Zt)),(lt===0?J>=Ne:ge>=ke)&&(Le.push(He+1),Le.push(Ie),Le.push(Zt))}}return pt}(this.ids,this.coords,R,N,q,K,this.nodeSize)},ki.prototype.within=function(R,N,q){return function(K,W,le,fe,U,J){for(var ge=[0,K.length-1,0],De=[],Ne=U*U;ge.length;){var ke=ge.pop(),Le=ge.pop(),pt=ge.pop();if(Le-pt<=J)for(var lt=pt;lt<=Le;lt++)ot(W[2*lt],W[2*lt+1],le,fe)<=Ne&&De.push(K[lt]);else{var Ie=Math.floor((pt+Le)/2),nt=W[2*Ie],Je=W[2*Ie+1];ot(nt,Je,le,fe)<=Ne&&De.push(K[Ie]);var He=(ke+1)%2;(ke===0?le-U<=nt:fe-U<=Je)&&(ge.push(pt),ge.push(Ie-1),ge.push(He)),(ke===0?le+U>=nt:fe+U>=Je)&&(ge.push(Ie+1),ge.push(Le),ge.push(He))}}return De}(this.ids,this.coords,R,N,q,this.nodeSize)};var Br={minZoom:0,maxZoom:16,minPoints:2,radius:40,extent:512,nodeSize:64,log:!1,generateId:!1,reduce:null,map:function(R){return R}},cr=function(R){this.options=mn(Object.create(Br),R),this.trees=new Array(this.options.maxZoom+1)};function Sr(R,N,q,K,W){return{x:R,y:N,zoom:1/0,id:q,parentId:-1,numPoints:K,properties:W}}function Gt(R,N){var q=R.geometry.coordinates,K=q[1];return{x:ti(q[0]),y:Ut(K),zoom:1/0,index:N,parentId:-1}}function Ei(R){return{type:"Feature",id:R.id,properties:Yn(R),geometry:{type:"Point",coordinates:[(K=R.x,360*(K-.5)),(N=R.y,q=(180-360*N)*Math.PI/180,360*Math.atan(Math.exp(q))/Math.PI-90)]}};var N,q,K}function Yn(R){var N=R.numPoints,q=N>=1e4?Math.round(N/1e3)+"k":N>=1e3?Math.round(N/100)/10+"k":N;return mn(mn({},R.properties),{cluster:!0,cluster_id:R.id,point_count:N,point_count_abbreviated:q})}function ti(R){return R/360+.5}function Ut(R){var N=Math.sin(R*Math.PI/180),q=.5-.25*Math.log((1+N)/(1-N))/Math.PI;return q<0?0:q>1?1:q}function mn(R,N){for(var q in N)R[q]=N[q];return R}function ci(R){return R.x}function $r(R){return R.y}function Rn(R,N,q,K,W,le){var fe=W-q,U=le-K;if(fe!==0||U!==0){var J=((R-q)*fe+(N-K)*U)/(fe*fe+U*U);J>1?(q=W,K=le):J>0&&(q+=fe*J,K+=U*J)}return(fe=R-q)*fe+(U=N-K)*U}function hi(R,N,q,K){var W={id:R===void 0?null:R,type:N,geometry:q,tags:K,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0};return function(le){var fe=le.geometry,U=le.type;if(U==="Point"||U==="MultiPoint"||U==="LineString")Tn(le,fe);else if(U==="Polygon"||U==="MultiLineString")for(var J=0;J<fe.length;J++)Tn(le,fe[J]);else if(U==="MultiPolygon")for(J=0;J<fe.length;J++)for(var ge=0;ge<fe[J].length;ge++)Tn(le,fe[J][ge])}(W),W}function Tn(R,N){for(var q=0;q<N.length;q+=3)R.minX=Math.min(R.minX,N[q]),R.minY=Math.min(R.minY,N[q+1]),R.maxX=Math.max(R.maxX,N[q]),R.maxY=Math.max(R.maxY,N[q+1])}function ni(R,N,q,K){if(N.geometry){var W=N.geometry.coordinates,le=N.geometry.type,fe=Math.pow(q.tolerance/((1<<q.maxZoom)*q.extent),2),U=[],J=N.id;if(q.promoteId?J=N.properties[q.promoteId]:q.generateId&&(J=K||0),le==="Point")zr(W,U);else if(le==="MultiPoint")for(var ge=0;ge<W.length;ge++)zr(W[ge],U);else if(le==="LineString")_i(W,U,fe,!1);else if(le==="MultiLineString"){if(q.lineMetrics){for(ge=0;ge<W.length;ge++)_i(W[ge],U=[],fe,!1),R.push(hi(J,"LineString",U,N.properties));return}pi(W,U,fe,!1)}else if(le==="Polygon")pi(W,U,fe,!0);else{if(le!=="MultiPolygon"){if(le==="GeometryCollection"){for(ge=0;ge<N.geometry.geometries.length;ge++)ni(R,{id:J,geometry:N.geometry.geometries[ge],properties:N.properties},q,K);return}throw new Error("Input data is not a valid GeoJSON object.")}for(ge=0;ge<W.length;ge++){var De=[];pi(W[ge],De,fe,!0),U.push(De)}}R.push(hi(J,le,U,N.properties))}}function zr(R,N){N.push(qr(R[0])),N.push(Qi(R[1])),N.push(0)}function _i(R,N,q,K){for(var W,le,fe=0,U=0;U<R.length;U++){var J=qr(R[U][0]),ge=Qi(R[U][1]);N.push(J),N.push(ge),N.push(0),U>0&&(fe+=K?(W*ge-J*le)/2:Math.sqrt(Math.pow(J-W,2)+Math.pow(ge-le,2))),W=J,le=ge}var De=N.length-3;N[2]=1,function Ne(ke,Le,pt,lt){for(var Ie,nt=lt,Je=pt-Le>>1,He=pt-Le,Zt=ke[Le],st=ke[Le+1],nr=ke[pt],br=ke[pt+1],Xt=Le+3;Xt<pt;Xt+=3){var pr=Rn(ke[Xt],ke[Xt+1],Zt,st,nr,br);if(pr>nt)Ie=Xt,nt=pr;else if(pr===nt){var ar=Math.abs(Xt-Je);ar<He&&(Ie=Xt,He=ar)}}nt>lt&&(Ie-Le>3&&Ne(ke,Le,Ie,lt),ke[Ie+2]=nt,pt-Ie>3&&Ne(ke,Ie,pt,lt))}(N,0,De,q),N[De+2]=1,N.size=Math.abs(fe),N.start=0,N.end=N.size}function pi(R,N,q,K){for(var W=0;W<R.length;W++){var le=[];_i(R[W],le,q,K),N.push(le)}}function qr(R){return R/360+.5}function Qi(R){var N=Math.sin(R*Math.PI/180),q=.5-.25*Math.log((1+N)/(1-N))/Math.PI;return q<0?0:q>1?1:q}function Hr(R,N,q,K,W,le,fe,U){if(K/=N,le>=(q/=N)&&fe<K)return R;if(fe<q||le>=K)return null;for(var J=[],ge=0;ge<R.length;ge++){var De=R[ge],Ne=De.geometry,ke=De.type,Le=W===0?De.minX:De.minY,pt=W===0?De.maxX:De.maxY;if(Le>=q&&pt<K)J.push(De);else if(!(pt<q||Le>=K)){var lt=[];if(ke==="Point"||ke==="MultiPoint")In(Ne,lt,q,K,W);else if(ke==="LineString")$i(Ne,lt,q,K,W,!1,U.lineMetrics);else if(ke==="MultiLineString")Ui(Ne,lt,q,K,W,!1);else if(ke==="Polygon")Ui(Ne,lt,q,K,W,!0);else if(ke==="MultiPolygon")for(var Ie=0;Ie<Ne.length;Ie++){var nt=[];Ui(Ne[Ie],nt,q,K,W,!0),nt.length&&lt.push(nt)}if(lt.length){if(U.lineMetrics&&ke==="LineString"){for(Ie=0;Ie<lt.length;Ie++)J.push(hi(De.id,ke,lt[Ie],De.tags));continue}ke!=="LineString"&&ke!=="MultiLineString"||(lt.length===1?(ke="LineString",lt=lt[0]):ke="MultiLineString"),ke!=="Point"&&ke!=="MultiPoint"||(ke=lt.length===3?"Point":"MultiPoint"),J.push(hi(De.id,ke,lt,De.tags))}}}return J.length?J:null}function In(R,N,q,K,W){for(var le=0;le<R.length;le+=3){var fe=R[le+W];fe>=q&&fe<=K&&(N.push(R[le]),N.push(R[le+1]),N.push(R[le+2]))}}function $i(R,N,q,K,W,le,fe){for(var U,J,ge=Bn(R),De=W===0?en:Ri,Ne=R.start,ke=0;ke<R.length-3;ke+=3){var Le=R[ke],pt=R[ke+1],lt=R[ke+2],Ie=R[ke+3],nt=R[ke+4],Je=W===0?Le:pt,He=W===0?Ie:nt,Zt=!1;fe&&(U=Math.sqrt(Math.pow(Le-Ie,2)+Math.pow(pt-nt,2))),Je<q?He>q&&(J=De(ge,Le,pt,Ie,nt,q),fe&&(ge.start=Ne+U*J)):Je>K?He<K&&(J=De(ge,Le,pt,Ie,nt,K),fe&&(ge.start=Ne+U*J)):An(ge,Le,pt,lt),He<q&&Je>=q&&(J=De(ge,Le,pt,Ie,nt,q),Zt=!0),He>K&&Je<=K&&(J=De(ge,Le,pt,Ie,nt,K),Zt=!0),!le&&Zt&&(fe&&(ge.end=Ne+U*J),N.push(ge),ge=Bn(R)),fe&&(Ne+=U)}var st=R.length-3;Le=R[st],pt=R[st+1],lt=R[st+2],(Je=W===0?Le:pt)>=q&&Je<=K&&An(ge,Le,pt,lt),st=ge.length-3,le&&st>=3&&(ge[st]!==ge[0]||ge[st+1]!==ge[1])&&An(ge,ge[0],ge[1],ge[2]),ge.length&&N.push(ge)}function Bn(R){var N=[];return N.size=R.size,N.start=R.start,N.end=R.end,N}function Ui(R,N,q,K,W,le){for(var fe=0;fe<R.length;fe++)$i(R[fe],N,q,K,W,le,!1)}function An(R,N,q,K){R.push(N),R.push(q),R.push(K)}function en(R,N,q,K,W,le){var fe=(le-N)/(K-N);return R.push(le),R.push(q+(W-q)*fe),R.push(1),fe}function Ri(R,N,q,K,W,le){var fe=(le-q)/(W-q);return R.push(N+(K-N)*fe),R.push(le),R.push(1),fe}function Xr(R,N){for(var q=[],K=0;K<R.length;K++){var W,le=R[K],fe=le.type;if(fe==="Point"||fe==="MultiPoint"||fe==="LineString")W=zn(le.geometry,N);else if(fe==="MultiLineString"||fe==="Polygon"){W=[];for(var U=0;U<le.geometry.length;U++)W.push(zn(le.geometry[U],N))}else if(fe==="MultiPolygon")for(W=[],U=0;U<le.geometry.length;U++){for(var J=[],ge=0;ge<le.geometry[U].length;ge++)J.push(zn(le.geometry[U][ge],N));W.push(J)}q.push(hi(le.id,fe,W,le.tags))}return q}function zn(R,N){var q=[];q.size=R.size,R.start!==void 0&&(q.start=R.start,q.end=R.end);for(var K=0;K<R.length;K+=3)q.push(R[K]+N,R[K+1],R[K+2]);return q}function Pn(R,N){if(R.transformed)return R;var q,K,W,le=1<<R.z,fe=R.x,U=R.y;for(q=0;q<R.features.length;q++){var J=R.features[q],ge=J.geometry,De=J.type;if(J.geometry=[],De===1)for(K=0;K<ge.length;K+=2)J.geometry.push(vi(ge[K],ge[K+1],N,le,fe,U));else for(K=0;K<ge.length;K++){var Ne=[];for(W=0;W<ge[K].length;W+=2)Ne.push(vi(ge[K][W],ge[K][W+1],N,le,fe,U));J.geometry.push(Ne)}}return R.transformed=!0,R}function vi(R,N,q,K,W,le){return[Math.round(q*(R*K-W)),Math.round(q*(N*K-le))]}function ha(R,N,q,K,W){for(var le=N===W.maxZoom?0:W.tolerance/((1<<N)*W.extent),fe={features:[],numPoints:0,numSimplified:0,numFeatures:0,source:null,x:q,y:K,z:N,transformed:!1,minX:2,minY:1,maxX:-1,maxY:0},U=0;U<R.length;U++){fe.numFeatures++,ra(fe,R[U],le,W);var J=R[U].minX,ge=R[U].minY,De=R[U].maxX,Ne=R[U].maxY;J<fe.minX&&(fe.minX=J),ge<fe.minY&&(fe.minY=ge),De>fe.maxX&&(fe.maxX=De),Ne>fe.maxY&&(fe.maxY=Ne)}return fe}function ra(R,N,q,K){var W=N.geometry,le=N.type,fe=[];if(le==="Point"||le==="MultiPoint")for(var U=0;U<W.length;U+=3)fe.push(W[U]),fe.push(W[U+1]),R.numPoints++,R.numSimplified++;else if(le==="LineString")Or(fe,W,R,q,!1,!1);else if(le==="MultiLineString"||le==="Polygon")for(U=0;U<W.length;U++)Or(fe,W[U],R,q,le==="Polygon",U===0);else if(le==="MultiPolygon")for(var J=0;J<W.length;J++){var ge=W[J];for(U=0;U<ge.length;U++)Or(fe,ge[U],R,q,!0,U===0)}if(fe.length){var De=N.tags||null;if(le==="LineString"&&K.lineMetrics){for(var Ne in De={},N.tags)De[Ne]=N.tags[Ne];De.mapbox_clip_start=W.start/W.size,De.mapbox_clip_end=W.end/W.size}var ke={geometry:fe,type:le==="Polygon"||le==="MultiPolygon"?3:le==="LineString"||le==="MultiLineString"?2:1,tags:De};N.id!==null&&(ke.id=N.id),R.features.push(ke)}}function Or(R,N,q,K,W,le){var fe=K*K;if(K>0&&N.size<(W?fe:K))q.numPoints+=N.length/3;else{for(var U=[],J=0;J<N.length;J+=3)(K===0||N[J+2]>fe)&&(q.numSimplified++,U.push(N[J]),U.push(N[J+1])),q.numPoints++;W&&function(ge,De){for(var Ne=0,ke=0,Le=ge.length,pt=Le-2;ke<Le;pt=ke,ke+=2)Ne+=(ge[ke]-ge[pt])*(ge[ke+1]+ge[pt+1]);if(Ne>0===De)for(ke=0,Le=ge.length;ke<Le/2;ke+=2){var lt=ge[ke],Ie=ge[ke+1];ge[ke]=ge[Le-2-ke],ge[ke+1]=ge[Le-1-ke],ge[Le-2-ke]=lt,ge[Le-1-ke]=Ie}}(U,le),R.push(U)}}function un(R,N){var q=(N=this.options=function(W,le){for(var fe in le)W[fe]=le[fe];return W}(Object.create(this.options),N)).debug;if(q&&console.time("preprocess data"),N.maxZoom<0||N.maxZoom>24)throw new Error("maxZoom should be in the 0-24 range");if(N.promoteId&&N.generateId)throw new Error("promoteId and generateId cannot be used together.");var K=function(W,le){var fe=[];if(W.type==="FeatureCollection")for(var U=0;U<W.features.length;U++)ni(fe,W.features[U],le,U);else ni(fe,W.type==="Feature"?W:{geometry:W},le);return fe}(R,N);this.tiles={},this.tileCoords=[],q&&(console.timeEnd("preprocess data"),console.log("index: maxZoom: %d, maxPoints: %d",N.indexMaxZoom,N.indexMaxPoints),console.time("generate tiles"),this.stats={},this.total=0),(K=function(W,le){var fe=le.buffer/le.extent,U=W,J=Hr(W,1,-1-fe,fe,0,-1,2,le),ge=Hr(W,1,1-fe,2+fe,0,-1,2,le);return(J||ge)&&(U=Hr(W,1,-fe,1+fe,0,-1,2,le)||[],J&&(U=Xr(J,1).concat(U)),ge&&(U=U.concat(Xr(ge,-1)))),U}(K,N)).length&&this.splitTile(K,0,0,0),q&&(K.length&&console.log("features: %d, points: %d",this.tiles[0].numFeatures,this.tiles[0].numPoints),console.timeEnd("generate tiles"),console.log("tiles generated:",this.total,JSON.stringify(this.stats)))}function qi(R,N,q){return 32*((1<<R)*q+N)+R}function fi(R,N){var q=R.tileID.canonical;if(!this._geoJSONIndex)return N(null,null);var K=this._geoJSONIndex.getTile(q.z,q.x,q.y);if(!K)return N(null,null);var W=new Pe(K.features),le=Ke(W);le.byteOffset===0&&le.byteLength===le.buffer.byteLength||(le=new Uint8Array(le)),N(null,{vectorTile:W,rawData:le.buffer})}cr.prototype.load=function(R){var N=this.options,q=N.log,K=N.minZoom,W=N.maxZoom,le=N.nodeSize;q&&console.time("total time");var fe="prepare "+R.length+" points";q&&console.time(fe),this.points=R;for(var U=[],J=0;J<R.length;J++)R[J].geometry&&U.push(Gt(R[J],J));this.trees[W+1]=new ki(U,ci,$r,le,Float32Array),q&&console.timeEnd(fe);for(var ge=W;ge>=K;ge--){var De=+Date.now();U=this._cluster(U,ge),this.trees[ge]=new ki(U,ci,$r,le,Float32Array),q&&console.log("z%d: %d clusters in %dms",ge,U.length,+Date.now()-De)}return q&&console.timeEnd("total time"),this},cr.prototype.getClusters=function(R,N){var q=((R[0]+180)%360+360)%360-180,K=Math.max(-90,Math.min(90,R[1])),W=R[2]===180?180:((R[2]+180)%360+360)%360-180,le=Math.max(-90,Math.min(90,R[3]));if(R[2]-R[0]>=360)q=-180,W=180;else if(q>W){var fe=this.getClusters([q,K,180,le],N),U=this.getClusters([-180,K,W,le],N);return fe.concat(U)}for(var J=this.trees[this._limitZoom(N)],ge=[],De=0,Ne=J.range(ti(q),Ut(le),ti(W),Ut(K));De<Ne.length;De+=1){var ke=J.points[Ne[De]];ge.push(ke.numPoints?Ei(ke):this.points[ke.index])}return ge},cr.prototype.getChildren=function(R){var N=this._getOriginId(R),q=this._getOriginZoom(R),K="No cluster with the specified id.",W=this.trees[q];if(!W)throw new Error(K);var le=W.points[N];if(!le)throw new Error(K);for(var fe=this.options.radius/(this.options.extent*Math.pow(2,q-1)),U=[],J=0,ge=W.within(le.x,le.y,fe);J<ge.length;J+=1){var De=W.points[ge[J]];De.parentId===R&&U.push(De.numPoints?Ei(De):this.points[De.index])}if(U.length===0)throw new Error(K);return U},cr.prototype.getLeaves=function(R,N,q){var K=[];return this._appendLeaves(K,R,N=N||10,q=q||0,0),K},cr.prototype.getTile=function(R,N,q){var K=this.trees[this._limitZoom(R)],W=Math.pow(2,R),le=this.options,fe=le.radius/le.extent,U=(q-fe)/W,J=(q+1+fe)/W,ge={features:[]};return this._addTileFeatures(K.range((N-fe)/W,U,(N+1+fe)/W,J),K.points,N,q,W,ge),N===0&&this._addTileFeatures(K.range(1-fe/W,U,1,J),K.points,W,q,W,ge),N===W-1&&this._addTileFeatures(K.range(0,U,fe/W,J),K.points,-1,q,W,ge),ge.features.length?ge:null},cr.prototype.getClusterExpansionZoom=function(R){for(var N=this._getOriginZoom(R)-1;N<=this.options.maxZoom;){var q=this.getChildren(R);if(N++,q.length!==1)break;R=q[0].properties.cluster_id}return N},cr.prototype._appendLeaves=function(R,N,q,K,W){for(var le=0,fe=this.getChildren(N);le<fe.length;le+=1){var U=fe[le],J=U.properties;if(J&&J.cluster?W+J.point_count<=K?W+=J.point_count:W=this._appendLeaves(R,J.cluster_id,q,K,W):W<K?W++:R.push(U),R.length===q)break}return W},cr.prototype._addTileFeatures=function(R,N,q,K,W,le){for(var fe=0,U=R;fe<U.length;fe+=1){var J=N[U[fe]],ge=J.numPoints,De={type:1,geometry:[[Math.round(this.options.extent*(J.x*W-q)),Math.round(this.options.extent*(J.y*W-K))]],tags:ge?Yn(J):this.points[J.index].properties},Ne=void 0;ge?Ne=J.id:this.options.generateId?Ne=J.index:this.points[J.index].id&&(Ne=this.points[J.index].id),Ne!==void 0&&(De.id=Ne),le.features.push(De)}},cr.prototype._limitZoom=function(R){return Math.max(this.options.minZoom,Math.min(+R,this.options.maxZoom+1))},cr.prototype._cluster=function(R,N){for(var q=[],K=this.options,W=K.reduce,le=K.minPoints,fe=K.radius/(K.extent*Math.pow(2,N)),U=0;U<R.length;U++){var J=R[U];if(!(J.zoom<=N)){J.zoom=N;for(var ge=this.trees[N+1],De=ge.within(J.x,J.y,fe),Ne=J.numPoints||1,ke=Ne,Le=0,pt=De;Le<pt.length;Le+=1){var lt=ge.points[pt[Le]];lt.zoom>N&&(ke+=lt.numPoints||1)}if(ke>=le){for(var Ie=J.x*Ne,nt=J.y*Ne,Je=W&&Ne>1?this._map(J,!0):null,He=(U<<5)+(N+1)+this.points.length,Zt=0,st=De;Zt<st.length;Zt+=1){var nr=ge.points[st[Zt]];if(!(nr.zoom<=N)){nr.zoom=N;var br=nr.numPoints||1;Ie+=nr.x*br,nt+=nr.y*br,nr.parentId=He,W&&(Je||(Je=this._map(J,!0)),W(Je,this._map(nr)))}}J.parentId=He,q.push(Sr(Ie/ke,nt/ke,He,ke,Je))}else if(q.push(J),ke>1)for(var Xt=0,pr=De;Xt<pr.length;Xt+=1){var ar=ge.points[pr[Xt]];ar.zoom<=N||(ar.zoom=N,q.push(ar))}}}return q},cr.prototype._getOriginId=function(R){return R-this.points.length>>5},cr.prototype._getOriginZoom=function(R){return(R-this.points.length)%32},cr.prototype._map=function(R,N){if(R.numPoints)return N?mn({},R.properties):R.properties;var q=this.points[R.index].properties,K=this.options.map(q);return N&&K===q?mn({},K):K},un.prototype.options={maxZoom:14,indexMaxZoom:5,indexMaxPoints:1e5,tolerance:3,extent:4096,buffer:64,lineMetrics:!1,promoteId:null,generateId:!1,debug:0},un.prototype.splitTile=function(R,N,q,K,W,le,fe){for(var U=[R,N,q,K],J=this.options,ge=J.debug;U.length;){K=U.pop(),q=U.pop(),N=U.pop(),R=U.pop();var De=1<<N,Ne=qi(N,q,K),ke=this.tiles[Ne];if(!ke&&(ge>1&&console.time("creation"),ke=this.tiles[Ne]=ha(R,N,q,K,J),this.tileCoords.push({z:N,x:q,y:K}),ge)){ge>1&&(console.log("tile z%d-%d-%d (features: %d, points: %d, simplified: %d)",N,q,K,ke.numFeatures,ke.numPoints,ke.numSimplified),console.timeEnd("creation"));var Le="z"+N;this.stats[Le]=(this.stats[Le]||0)+1,this.total++}if(ke.source=R,W){if(N===J.maxZoom||N===W)continue;var pt=1<<W-N;if(q!==Math.floor(le/pt)||K!==Math.floor(fe/pt))continue}else if(N===J.indexMaxZoom||ke.numPoints<=J.indexMaxPoints)continue;if(ke.source=null,R.length!==0){ge>1&&console.time("clipping");var lt,Ie,nt,Je,He,Zt,st=.5*J.buffer/J.extent,nr=.5-st,br=.5+st,Xt=1+st;lt=Ie=nt=Je=null,He=Hr(R,De,q-st,q+br,0,ke.minX,ke.maxX,J),Zt=Hr(R,De,q+nr,q+Xt,0,ke.minX,ke.maxX,J),R=null,He&&(lt=Hr(He,De,K-st,K+br,1,ke.minY,ke.maxY,J),Ie=Hr(He,De,K+nr,K+Xt,1,ke.minY,ke.maxY,J),He=null),Zt&&(nt=Hr(Zt,De,K-st,K+br,1,ke.minY,ke.maxY,J),Je=Hr(Zt,De,K+nr,K+Xt,1,ke.minY,ke.maxY,J),Zt=null),ge>1&&console.timeEnd("clipping"),U.push(lt||[],N+1,2*q,2*K),U.push(Ie||[],N+1,2*q,2*K+1),U.push(nt||[],N+1,2*q+1,2*K),U.push(Je||[],N+1,2*q+1,2*K+1)}}},un.prototype.getTile=function(R,N,q){var K=this.options,W=K.extent,le=K.debug;if(R<0||R>24)return null;var fe=1<<R,U=qi(R,N=(N%fe+fe)%fe,q);if(this.tiles[U])return Pn(this.tiles[U],W);le>1&&console.log("drilling down to z%d-%d-%d",R,N,q);for(var J,ge=R,De=N,Ne=q;!J&&ge>0;)ge--,De=Math.floor(De/2),Ne=Math.floor(Ne/2),J=this.tiles[qi(ge,De,Ne)];return J&&J.source?(le>1&&console.log("found parent tile z%d-%d-%d",ge,De,Ne),le>1&&console.time("drilling down"),this.splitTile(J.source,ge,De,Ne,R,N,q),le>1&&console.timeEnd("drilling down"),this.tiles[U]?Pn(this.tiles[U],W):null):null};var re=function(R){function N(q,K,W,le){R.call(this,q,K,W,fi),le&&(this.loadGeoJSON=le)}return R&&(N.__proto__=R),(N.prototype=Object.create(R&&R.prototype)).constructor=N,N.prototype.loadData=function(q,K){this._pendingCallback&&this._pendingCallback(null,{abandoned:!0}),this._pendingCallback=K,this._pendingLoadDataParams=q,this._state&&this._state!=="Idle"?this._state="NeedsLoadData":(this._state="Coalescing",this._loadData())},N.prototype._loadData=function(){var q=this;if(this._pendingCallback&&this._pendingLoadDataParams){var K=this._pendingCallback,W=this._pendingLoadDataParams;delete this._pendingCallback,delete this._pendingLoadDataParams;var le=!!(W&&W.request&&W.request.collectResourceTiming)&&new a.RequestPerformance(W.request);this.loadGeoJSON(W,function(fe,U){if(fe||!U)return K(fe);if(typeof U!="object")return K(new Error("Input data given to '"+W.source+"' is not a valid GeoJSON object."));(function ke(Le,pt){var lt,Ie=Le&&Le.type;if(Ie==="FeatureCollection")for(lt=0;lt<Le.features.length;lt++)ke(Le.features[lt],pt);else if(Ie==="GeometryCollection")for(lt=0;lt<Le.geometries.length;lt++)ke(Le.geometries[lt],pt);else if(Ie==="Feature")ke(Le.geometry,pt);else if(Ie==="Polygon")me(Le.coordinates,pt);else if(Ie==="MultiPolygon")for(lt=0;lt<Le.coordinates.length;lt++)me(Le.coordinates[lt],pt);return Le})(U,!0);try{if(W.filter){var J=a.createExpression(W.filter,{type:"boolean","property-type":"data-driven",overridable:!1,transition:!1});if(J.result==="error")throw new Error(J.value.map(function(ke){return ke.key+": "+ke.message}).join(", "));var ge=U.features.filter(function(ke){return J.value.evaluate({zoom:0},ke)});U={type:"FeatureCollection",features:ge}}q._geoJSONIndex=W.cluster?new cr(function(ke){var Le=ke.superclusterOptions,pt=ke.clusterProperties;if(!pt||!Le)return Le;for(var lt={},Ie={},nt={accumulated:null,zoom:0},Je={properties:null},He=Object.keys(pt),Zt=0,st=He;Zt<st.length;Zt+=1){var nr=st[Zt],br=pt[nr],Xt=br[0],pr=a.createExpression(br[1]),ar=a.createExpression(typeof Xt=="string"?[Xt,["accumulated"],["get",nr]]:Xt);lt[nr]=pr.value,Ie[nr]=ar.value}return Le.map=function(bi){Je.properties=bi;for(var mr={},Fr=0,vr=He;Fr<vr.length;Fr+=1){var Qt=vr[Fr];mr[Qt]=lt[Qt].evaluate(nt,Je)}return mr},Le.reduce=function(bi,mr){Je.properties=mr;for(var Fr=0,vr=He;Fr<vr.length;Fr+=1){var Qt=vr[Fr];nt.accumulated=bi[Qt],bi[Qt]=Ie[Qt].evaluate(nt,Je)}},Le}(W)).load(U.features):function(ke,Le){return new un(ke,Le)}(U,W.geojsonVtOptions)}catch(ke){return K(ke)}q.loaded={};var De={};if(le){var Ne=le.finish();Ne&&(De.resourceTiming={},De.resourceTiming[W.source]=JSON.parse(JSON.stringify(Ne)))}K(null,De)})}},N.prototype.coalesce=function(){this._state==="Coalescing"?this._state="Idle":this._state==="NeedsLoadData"&&(this._state="Coalescing",this._loadData())},N.prototype.reloadTile=function(q,K){var W=this.loaded;return W&&W[q.uid]?R.prototype.reloadTile.call(this,q,K):this.loadTile(q,K)},N.prototype.loadGeoJSON=function(q,K){if(q.request)a.getJSON(q.request,K);else{if(typeof q.data!="string")return K(new Error("Input data given to '"+q.source+"' is not a valid GeoJSON object."));try{return K(null,JSON.parse(q.data))}catch{return K(new Error("Input data given to '"+q.source+"' is not a valid GeoJSON object."))}}},N.prototype.removeSource=function(q,K){this._pendingCallback&&this._pendingCallback(null,{abandoned:!0}),K()},N.prototype.getClusterExpansionZoom=function(q,K){try{K(null,this._geoJSONIndex.getClusterExpansionZoom(q.clusterId))}catch(W){K(W)}},N.prototype.getClusterChildren=function(q,K){try{K(null,this._geoJSONIndex.getChildren(q.clusterId))}catch(W){K(W)}},N.prototype.getClusterLeaves=function(q,K){try{K(null,this._geoJSONIndex.getLeaves(q.clusterId,q.limit,q.offset))}catch(W){K(W)}},N}(ae),et=function(R){var N=this;this.self=R,this.actor=new a.Actor(R,this),this.layerIndexes={},this.availableImages={},this.workerSourceTypes={vector:ae,geojson:re},this.workerSources={},this.demWorkerSources={},this.self.registerWorkerSource=function(q,K){if(N.workerSourceTypes[q])throw new Error('Worker source with name "'+q+'" already registered.');N.workerSourceTypes[q]=K},this.self.registerRTLTextPlugin=function(q){if(a.plugin.isParsed())throw new Error("RTL text plugin already registered.");a.plugin.applyArabicShaping=q.applyArabicShaping,a.plugin.processBidirectionalText=q.processBidirectionalText,a.plugin.processStyledBidirectionalText=q.processStyledBidirectionalText}};return et.prototype.setReferrer=function(R,N){this.referrer=N},et.prototype.setImages=function(R,N,q){for(var K in this.availableImages[R]=N,this.workerSources[R]){var W=this.workerSources[R][K];for(var le in W)W[le].availableImages=N}q()},et.prototype.setLayers=function(R,N,q){this.getLayerIndex(R).replace(N),q()},et.prototype.updateLayers=function(R,N,q){this.getLayerIndex(R).update(N.layers,N.removedIds),q()},et.prototype.loadTile=function(R,N,q){this.getWorkerSource(R,N.type,N.source).loadTile(N,q)},et.prototype.loadDEMTile=function(R,N,q){this.getDEMWorkerSource(R,N.source).loadTile(N,q)},et.prototype.reloadTile=function(R,N,q){this.getWorkerSource(R,N.type,N.source).reloadTile(N,q)},et.prototype.abortTile=function(R,N,q){this.getWorkerSource(R,N.type,N.source).abortTile(N,q)},et.prototype.removeTile=function(R,N,q){this.getWorkerSource(R,N.type,N.source).removeTile(N,q)},et.prototype.removeDEMTile=function(R,N){this.getDEMWorkerSource(R,N.source).removeTile(N)},et.prototype.removeSource=function(R,N,q){if(this.workerSources[R]&&this.workerSources[R][N.type]&&this.workerSources[R][N.type][N.source]){var K=this.workerSources[R][N.type][N.source];delete this.workerSources[R][N.type][N.source],K.removeSource!==void 0?K.removeSource(N,q):q()}},et.prototype.loadWorkerSource=function(R,N,q){try{this.self.importScripts(N.url),q()}catch(K){q(K.toString())}},et.prototype.syncRTLPluginState=function(R,N,q){try{a.plugin.setState(N);var K=a.plugin.getPluginURL();if(a.plugin.isLoaded()&&!a.plugin.isParsed()&&K!=null){this.self.importScripts(K);var W=a.plugin.isParsed();q(W?void 0:new Error("RTL Text Plugin failed to import scripts from "+K),W)}}catch(le){q(le.toString())}},et.prototype.getAvailableImages=function(R){var N=this.availableImages[R];return N||(N=[]),N},et.prototype.getLayerIndex=function(R){var N=this.layerIndexes[R];return N||(N=this.layerIndexes[R]=new L),N},et.prototype.getWorkerSource=function(R,N,q){var K=this;return this.workerSources[R]||(this.workerSources[R]={}),this.workerSources[R][N]||(this.workerSources[R][N]={}),this.workerSources[R][N][q]||(this.workerSources[R][N][q]=new this.workerSourceTypes[N]({send:function(W,le,fe){K.actor.send(W,le,fe,R)}},this.getLayerIndex(R),this.getAvailableImages(R))),this.workerSources[R][N][q]},et.prototype.getDEMWorkerSource=function(R,N){return this.demWorkerSources[R]||(this.demWorkerSources[R]={}),this.demWorkerSources[R][N]||(this.demWorkerSources[R][N]=new he),this.demWorkerSources[R][N]},et.prototype.enforceCacheSizeLimit=function(R,N){a.enforceCacheSizeLimit(N)},typeof WorkerGlobalScope<"u"&&typeof self<"u"&&self instanceof WorkerGlobalScope&&(self.worker=new et(self)),et}),v(["./shared"],function(a){var E=a.createCommonjsModule(function(n){function s(_){return!o(_)}function o(_){return typeof window>"u"||typeof document>"u"?"not a browser":Array.prototype&&Array.prototype.every&&Array.prototype.filter&&Array.prototype.forEach&&Array.prototype.indexOf&&Array.prototype.lastIndexOf&&Array.prototype.map&&Array.prototype.some&&Array.prototype.reduce&&Array.prototype.reduceRight&&Array.isArray?Function.prototype&&Function.prototype.bind?Object.keys&&Object.create&&Object.getPrototypeOf&&Object.getOwnPropertyNames&&Object.isSealed&&Object.isFrozen&&Object.isExtensible&&Object.getOwnPropertyDescriptor&&Object.defineProperty&&Object.defineProperties&&Object.seal&&Object.freeze&&Object.preventExtensions?"JSON"in window&&"parse"in JSON&&"stringify"in JSON?function(){if(!("Worker"in window&&"Blob"in window&&"URL"in window))return!1;var S,I,P=new Blob([""],{type:"text/javascript"}),O=URL.createObjectURL(P);try{I=new Worker(O),S=!0}catch{S=!1}return I&&I.terminate(),URL.revokeObjectURL(O),S}()?"Uint8ClampedArray"in window?ArrayBuffer.isView?function(){var S=document.createElement("canvas");S.width=S.height=1;var I=S.getContext("2d");if(!I)return!1;var P=I.getImageData(0,0,1,1);return P&&P.width===S.width}()?(h[w=_&&_.failIfMajorPerformanceCaveat]===void 0&&(h[w]=function(S){var I=function(O){var G=document.createElement("canvas"),Z=Object.create(s.webGLContextAttributes);return Z.failIfMajorPerformanceCaveat=O,G.probablySupportsContext?G.probablySupportsContext("webgl",Z)||G.probablySupportsContext("experimental-webgl",Z):G.supportsContext?G.supportsContext("webgl",Z)||G.supportsContext("experimental-webgl",Z):G.getContext("webgl",Z)||G.getContext("experimental-webgl",Z)}(S);if(!I)return!1;var P=I.createShader(I.VERTEX_SHADER);return!(!P||I.isContextLost())&&(I.shaderSource(P,"void main() {}"),I.compileShader(P),I.getShaderParameter(P,I.COMPILE_STATUS)===!0)}(w)),h[w]?void 0:"insufficient WebGL support"):"insufficient Canvas/getImageData support":"insufficient ArrayBuffer support":"insufficient Uint8ClampedArray support":"insufficient worker support":"insufficient JSON support":"insufficient Object support":"insufficient Function support":"insufficent Array support";var w}n.exports?n.exports=s:window&&(window.mapboxgl=window.mapboxgl||{},window.mapboxgl.supported=s,window.mapboxgl.notSupportedReason=o);var h={};s.webGLContextAttributes={antialias:!1,alpha:!0,stencil:!0,depth:!0}}),T={create:function(n,s,o){var h=a.window.document.createElement(n);return s!==void 0&&(h.className=s),o&&o.appendChild(h),h},createNS:function(n,s){return a.window.document.createElementNS(n,s)}},L=a.window.document&&a.window.document.documentElement.style;function F(n){if(!L)return n[0];for(var s=0;s<n.length;s++)if(n[s]in L)return n[s];return n[0]}var C,M=F(["userSelect","MozUserSelect","WebkitUserSelect","msUserSelect"]);T.disableDrag=function(){L&&M&&(C=L[M],L[M]="none")},T.enableDrag=function(){L&&M&&(L[M]=C)};var X=F(["transform","WebkitTransform"]);T.setTransform=function(n,s){n.style[X]=s};var ae=!1;try{var se=Object.defineProperty({},"passive",{get:function(){ae=!0}});a.window.addEventListener("test",se,se),a.window.removeEventListener("test",se,se)}catch{ae=!1}T.addEventListener=function(n,s,o,h){h===void 0&&(h={}),n.addEventListener(s,o,"passive"in h&&ae?h:h.capture)},T.removeEventListener=function(n,s,o,h){h===void 0&&(h={}),n.removeEventListener(s,o,"passive"in h&&ae?h:h.capture)};var he=function(n){n.preventDefault(),n.stopPropagation(),a.window.removeEventListener("click",he,!0)};function me(n){var s=n.userImage;return!!(s&&s.render&&s.render())&&(n.data.replace(new Uint8Array(s.data.buffer)),!0)}T.suppressClick=function(){a.window.addEventListener("click",he,!0),a.window.setTimeout(function(){a.window.removeEventListener("click",he,!0)},0)},T.mousePos=function(n,s){var o=n.getBoundingClientRect();return new a.Point(s.clientX-o.left-n.clientLeft,s.clientY-o.top-n.clientTop)},T.touchPos=function(n,s){for(var o=n.getBoundingClientRect(),h=[],_=0;_<s.length;_++)h.push(new a.Point(s[_].clientX-o.left-n.clientLeft,s[_].clientY-o.top-n.clientTop));return h},T.mouseButton=function(n){return a.window.InstallTrigger!==void 0&&n.button===2&&n.ctrlKey&&a.window.navigator.platform.toUpperCase().indexOf("MAC")>=0?0:n.button},T.remove=function(n){n.parentNode&&n.parentNode.removeChild(n)};var _e=function(n){function s(){n.call(this),this.images={},this.updatedImages={},this.callbackDispatchedThisFrame={},this.loaded=!1,this.requestors=[],this.patterns={},this.atlasImage=new a.RGBAImage({width:1,height:1}),this.dirty=!0}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype.isLoaded=function(){return this.loaded},s.prototype.setLoaded=function(o){if(this.loaded!==o&&(this.loaded=o,o)){for(var h=0,_=this.requestors;h<_.length;h+=1){var w=_[h];this._notify(w.ids,w.callback)}this.requestors=[]}},s.prototype.getImage=function(o){return this.images[o]},s.prototype.addImage=function(o,h){this._validate(o,h)&&(this.images[o]=h)},s.prototype._validate=function(o,h){var _=!0;return this._validateStretch(h.stretchX,h.data&&h.data.width)||(this.fire(new a.ErrorEvent(new Error('Image "'+o+'" has invalid "stretchX" value'))),_=!1),this._validateStretch(h.stretchY,h.data&&h.data.height)||(this.fire(new a.ErrorEvent(new Error('Image "'+o+'" has invalid "stretchY" value'))),_=!1),this._validateContent(h.content,h)||(this.fire(new a.ErrorEvent(new Error('Image "'+o+'" has invalid "content" value'))),_=!1),_},s.prototype._validateStretch=function(o,h){if(!o)return!0;for(var _=0,w=0,S=o;w<S.length;w+=1){var I=S[w];if(I[0]<_||I[1]<I[0]||h<I[1])return!1;_=I[1]}return!0},s.prototype._validateContent=function(o,h){return!(o&&(o.length!==4||o[0]<0||h.data.width<o[0]||o[1]<0||h.data.height<o[1]||o[2]<0||h.data.width<o[2]||o[3]<0||h.data.height<o[3]||o[2]<o[0]||o[3]<o[1]))},s.prototype.updateImage=function(o,h){h.version=this.images[o].version+1,this.images[o]=h,this.updatedImages[o]=!0},s.prototype.removeImage=function(o){var h=this.images[o];delete this.images[o],delete this.patterns[o],h.userImage&&h.userImage.onRemove&&h.userImage.onRemove()},s.prototype.listImages=function(){return Object.keys(this.images)},s.prototype.getImages=function(o,h){var _=!0;if(!this.isLoaded())for(var w=0,S=o;w<S.length;w+=1)this.images[S[w]]||(_=!1);this.isLoaded()||_?this._notify(o,h):this.requestors.push({ids:o,callback:h})},s.prototype._notify=function(o,h){for(var _={},w=0,S=o;w<S.length;w+=1){var I=S[w];this.images[I]||this.fire(new a.Event("styleimagemissing",{id:I}));var P=this.images[I];P?_[I]={data:P.data.clone(),pixelRatio:P.pixelRatio,sdf:P.sdf,version:P.version,stretchX:P.stretchX,stretchY:P.stretchY,content:P.content,hasRenderCallback:!!(P.userImage&&P.userImage.render)}:a.warnOnce('Image "'+I+'" could not be loaded. Please make sure you have added the image with map.addImage() or a "sprite" property in your style. You can provide missing images by listening for the "styleimagemissing" map event.')}h(null,_)},s.prototype.getPixelSize=function(){var o=this.atlasImage;return{width:o.width,height:o.height}},s.prototype.getPattern=function(o){var h=this.patterns[o],_=this.getImage(o);if(!_)return null;if(h&&h.position.version===_.version)return h.position;if(h)h.position.version=_.version;else{var w={w:_.data.width+2,h:_.data.height+2,x:0,y:0},S=new a.ImagePosition(w,_);this.patterns[o]={bin:w,position:S}}return this._updatePatternAtlas(),this.patterns[o].position},s.prototype.bind=function(o){var h=o.gl;this.atlasTexture?this.dirty&&(this.atlasTexture.update(this.atlasImage),this.dirty=!1):this.atlasTexture=new a.Texture(o,this.atlasImage,h.RGBA),this.atlasTexture.bind(h.LINEAR,h.CLAMP_TO_EDGE)},s.prototype._updatePatternAtlas=function(){var o=[];for(var h in this.patterns)o.push(this.patterns[h].bin);var _=a.potpack(o),w=_.w,S=_.h,I=this.atlasImage;for(var P in I.resize({width:w||1,height:S||1}),this.patterns){var O=this.patterns[P].bin,G=O.x+1,Z=O.y+1,H=this.images[P].data,te=H.width,ee=H.height;a.RGBAImage.copy(H,I,{x:0,y:0},{x:G,y:Z},{width:te,height:ee}),a.RGBAImage.copy(H,I,{x:0,y:ee-1},{x:G,y:Z-1},{width:te,height:1}),a.RGBAImage.copy(H,I,{x:0,y:0},{x:G,y:Z+ee},{width:te,height:1}),a.RGBAImage.copy(H,I,{x:te-1,y:0},{x:G-1,y:Z},{width:1,height:ee}),a.RGBAImage.copy(H,I,{x:0,y:0},{x:G+te,y:Z},{width:1,height:ee})}this.dirty=!0},s.prototype.beginFrame=function(){this.callbackDispatchedThisFrame={}},s.prototype.dispatchRenderCallbacks=function(o){for(var h=0,_=o;h<_.length;h+=1){var w=_[h];if(!this.callbackDispatchedThisFrame[w]){this.callbackDispatchedThisFrame[w]=!0;var S=this.images[w];me(S)&&this.updateImage(w,S)}}},s}(a.Evented),it=Ze,Fe=Ze,Pe=1e20;function Ze(n,s,o,h,_,w){this.fontSize=n||24,this.buffer=s===void 0?3:s,this.cutoff=h||.25,this.fontFamily=_||"sans-serif",this.fontWeight=w||"normal",this.radius=o||8;var S=this.size=this.fontSize+2*this.buffer;this.canvas=document.createElement("canvas"),this.canvas.width=this.canvas.height=S,this.ctx=this.canvas.getContext("2d"),this.ctx.font=this.fontWeight+" "+this.fontSize+"px "+this.fontFamily,this.ctx.textBaseline="middle",this.ctx.fillStyle="black",this.gridOuter=new Float64Array(S*S),this.gridInner=new Float64Array(S*S),this.f=new Float64Array(S),this.d=new Float64Array(S),this.z=new Float64Array(S+1),this.v=new Int16Array(S),this.middle=Math.round(S/2*(navigator.userAgent.indexOf("Gecko/")>=0?1.2:1))}function Ct(n,s,o,h,_,w,S){for(var I=0;I<s;I++){for(var P=0;P<o;P++)h[P]=n[P*s+I];for(kt(h,_,w,S,o),P=0;P<o;P++)n[P*s+I]=_[P]}for(P=0;P<o;P++){for(I=0;I<s;I++)h[I]=n[P*s+I];for(kt(h,_,w,S,s),I=0;I<s;I++)n[P*s+I]=Math.sqrt(_[I])}}function kt(n,s,o,h,_){o[0]=0,h[0]=-Pe,h[1]=+Pe;for(var w=1,S=0;w<_;w++){for(var I=(n[w]+w*w-(n[o[S]]+o[S]*o[S]))/(2*w-2*o[S]);I<=h[S];)S--,I=(n[w]+w*w-(n[o[S]]+o[S]*o[S]))/(2*w-2*o[S]);o[++S]=w,h[S]=I,h[S+1]=+Pe}for(w=0,S=0;w<_;w++){for(;h[S+1]<w;)S++;s[w]=(w-o[S])*(w-o[S])+n[o[S]]}}Ze.prototype.draw=function(n){this.ctx.clearRect(0,0,this.size,this.size),this.ctx.fillText(n,this.buffer,this.middle);for(var s=this.ctx.getImageData(0,0,this.size,this.size),o=new Uint8ClampedArray(this.size*this.size),h=0;h<this.size*this.size;h++){var _=s.data[4*h+3]/255;this.gridOuter[h]=_===1?0:_===0?Pe:Math.pow(Math.max(0,.5-_),2),this.gridInner[h]=_===1?Pe:_===0?0:Math.pow(Math.max(0,_-.5),2)}for(Ct(this.gridOuter,this.size,this.size,this.f,this.d,this.v,this.z),Ct(this.gridInner,this.size,this.size,this.f,this.d,this.v,this.z),h=0;h<this.size*this.size;h++)o[h]=Math.max(0,Math.min(255,Math.round(255-255*((this.gridOuter[h]-this.gridInner[h])/this.radius+this.cutoff))));return o},it.default=Fe;var Ge=function(n,s){this.requestManager=n,this.localIdeographFontFamily=s,this.entries={}};Ge.prototype.setURL=function(n){this.url=n},Ge.prototype.getGlyphs=function(n,s){var o=this,h=[];for(var _ in n)for(var w=0,S=n[_];w<S.length;w+=1)h.push({stack:_,id:S[w]});a.asyncAll(h,function(I,P){var O=I.stack,G=I.id,Z=o.entries[O];Z||(Z=o.entries[O]={glyphs:{},requests:{},ranges:{}});var H=Z.glyphs[G];if(H===void 0){if(H=o._tinySDF(Z,O,G))return Z.glyphs[G]=H,void P(null,{stack:O,id:G,glyph:H});var te=Math.floor(G/256);if(256*te>65535)P(new Error("glyphs > 65535 not supported"));else if(Z.ranges[te])P(null,{stack:O,id:G,glyph:H});else{var ee=Z.requests[te];ee||(ee=Z.requests[te]=[],Ge.loadGlyphRange(O,te,o.url,o.requestManager,function(ce,Y){if(Y){for(var ue in Y)o._doesCharSupportLocalGlyph(+ue)||(Z.glyphs[+ue]=Y[+ue]);Z.ranges[te]=!0}for(var de=0,be=ee;de<be.length;de+=1)(0,be[de])(ce,Y);delete Z.requests[te]})),ee.push(function(ce,Y){ce?P(ce):Y&&P(null,{stack:O,id:G,glyph:Y[G]||null})})}}else P(null,{stack:O,id:G,glyph:H})},function(I,P){if(I)s(I);else if(P){for(var O={},G=0,Z=P;G<Z.length;G+=1){var H=Z[G],te=H.stack,ee=H.id,ce=H.glyph;(O[te]||(O[te]={}))[ee]=ce&&{id:ce.id,bitmap:ce.bitmap.clone(),metrics:ce.metrics}}s(null,O)}})},Ge.prototype._doesCharSupportLocalGlyph=function(n){return!!this.localIdeographFontFamily&&(a.isChar["CJK Unified Ideographs"](n)||a.isChar["Hangul Syllables"](n)||a.isChar.Hiragana(n)||a.isChar.Katakana(n))},Ge.prototype._tinySDF=function(n,s,o){var h=this.localIdeographFontFamily;if(h&&this._doesCharSupportLocalGlyph(o)){var _=n.tinySDF;if(!_){var w="400";/bold/i.test(s)?w="900":/medium/i.test(s)?w="500":/light/i.test(s)&&(w="200"),_=n.tinySDF=new Ge.TinySDF(24,3,8,.25,h,w)}return{id:o,bitmap:new a.AlphaImage({width:30,height:30},_.draw(String.fromCharCode(o))),metrics:{width:24,height:24,left:0,top:-8,advance:24}}}},Ge.loadGlyphRange=function(n,s,o,h,_){var w=256*s,S=w+255,I=h.transformRequest(h.normalizeGlyphsURL(o).replace("{fontstack}",n).replace("{range}",w+"-"+S),a.ResourceType.Glyphs);a.getArrayBuffer(I,function(P,O){if(P)_(P);else if(O){for(var G={},Z=0,H=a.parseGlyphPBF(O);Z<H.length;Z+=1){var te=H[Z];G[te.id]=te}_(null,G)}})},Ge.TinySDF=it;var Ke=function(){this.specification=a.styleSpec.light.position};Ke.prototype.possiblyEvaluate=function(n,s){return a.sphericalToCartesian(n.expression.evaluate(s))},Ke.prototype.interpolate=function(n,s,o){return{x:a.number(n.x,s.x,o),y:a.number(n.y,s.y,o),z:a.number(n.z,s.z,o)}};var gt=new a.Properties({anchor:new a.DataConstantProperty(a.styleSpec.light.anchor),position:new Ke,color:new a.DataConstantProperty(a.styleSpec.light.color),intensity:new a.DataConstantProperty(a.styleSpec.light.intensity)}),ur=function(n){function s(o){n.call(this),this._transitionable=new a.Transitionable(gt),this.setLight(o),this._transitioning=this._transitionable.untransitioned()}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype.getLight=function(){return this._transitionable.serialize()},s.prototype.setLight=function(o,h){if(h===void 0&&(h={}),!this._validate(a.validateLight,o,h))for(var _ in o){var w=o[_];a.endsWith(_,"-transition")?this._transitionable.setTransition(_.slice(0,-11),w):this._transitionable.setValue(_,w)}},s.prototype.updateTransitions=function(o){this._transitioning=this._transitionable.transitioned(o,this._transitioning)},s.prototype.hasTransition=function(){return this._transitioning.hasTransition()},s.prototype.recalculate=function(o){this.properties=this._transitioning.possiblyEvaluate(o)},s.prototype._validate=function(o,h,_){return(!_||_.validate!==!1)&&a.emitValidationErrors(this,o.call(a.validateStyle,a.extend({value:h,style:{glyphs:!0,sprite:!0},styleSpec:a.styleSpec})))},s}(a.Evented),je=function(n,s){this.width=n,this.height=s,this.nextRow=0,this.data=new Uint8Array(this.width*this.height),this.dashEntry={}};je.prototype.getDash=function(n,s){var o=n.join(",")+String(s);return this.dashEntry[o]||(this.dashEntry[o]=this.addDash(n,s)),this.dashEntry[o]},je.prototype.getDashRanges=function(n,s,o){var h=[],_=n.length%2==1?-n[n.length-1]*o:0,w=n[0]*o,S=!0;h.push({left:_,right:w,isDash:S,zeroLength:n[0]===0});for(var I=n[0],P=1;P<n.length;P++){var O=n[P];h.push({left:_=I*o,right:w=(I+=O)*o,isDash:S=!S,zeroLength:O===0})}return h},je.prototype.addRoundDash=function(n,s,o){for(var h=s/2,_=-o;_<=o;_++)for(var w=this.width*(this.nextRow+o+_),S=0,I=n[S],P=0;P<this.width;P++){P/I.right>1&&(I=n[++S]);var O=Math.abs(P-I.left),G=Math.abs(P-I.right),Z=Math.min(O,G),H=void 0,te=_/o*(h+1);if(I.isDash){var ee=h-Math.abs(te);H=Math.sqrt(Z*Z+ee*ee)}else H=h-Math.sqrt(Z*Z+te*te);this.data[w+P]=Math.max(0,Math.min(255,H+128))}},je.prototype.addRegularDash=function(n){for(var s=n.length-1;s>=0;--s){var o=n[s],h=n[s+1];o.zeroLength?n.splice(s,1):h&&h.isDash===o.isDash&&(h.left=o.left,n.splice(s,1))}var _=n[0],w=n[n.length-1];_.isDash===w.isDash&&(_.left=w.left-this.width,w.right=_.right+this.width);for(var S=this.width*this.nextRow,I=0,P=n[I],O=0;O<this.width;O++){O/P.right>1&&(P=n[++I]);var G=Math.abs(O-P.left),Z=Math.abs(O-P.right),H=Math.min(G,Z);this.data[S+O]=Math.max(0,Math.min(255,(P.isDash?H:-H)+128))}},je.prototype.addDash=function(n,s){var o=s?7:0,h=2*o+1;if(this.nextRow+h>this.height)return a.warnOnce("LineAtlas out of space"),null;for(var _=0,w=0;w<n.length;w++)_+=n[w];if(_!==0){var S=this.width/_,I=this.getDashRanges(n,this.width,S);s?this.addRoundDash(I,S,o):this.addRegularDash(I)}var P={y:(this.nextRow+o+.5)/this.height,height:2*o/this.height,width:_};return this.nextRow+=h,this.dirty=!0,P},je.prototype.bind=function(n){var s=n.gl;this.texture?(s.bindTexture(s.TEXTURE_2D,this.texture),this.dirty&&(this.dirty=!1,s.texSubImage2D(s.TEXTURE_2D,0,0,0,this.width,this.height,s.ALPHA,s.UNSIGNED_BYTE,this.data))):(this.texture=s.createTexture(),s.bindTexture(s.TEXTURE_2D,this.texture),s.texParameteri(s.TEXTURE_2D,s.TEXTURE_WRAP_S,s.REPEAT),s.texParameteri(s.TEXTURE_2D,s.TEXTURE_WRAP_T,s.REPEAT),s.texParameteri(s.TEXTURE_2D,s.TEXTURE_MIN_FILTER,s.LINEAR),s.texParameteri(s.TEXTURE_2D,s.TEXTURE_MAG_FILTER,s.LINEAR),s.texImage2D(s.TEXTURE_2D,0,s.ALPHA,this.width,this.height,0,s.ALPHA,s.UNSIGNED_BYTE,this.data))};var Ft=function n(s,o){this.workerPool=s,this.actors=[],this.currentActor=0,this.id=a.uniqueId();for(var h=this.workerPool.acquire(this.id),_=0;_<h.length;_++){var w=new n.Actor(h[_],o,this.id);w.name="Worker "+_,this.actors.push(w)}};function Be(n,s,o){var h=function(_,w){if(_)return o(_);if(w){var S=a.pick(a.extend(w,n),["tiles","minzoom","maxzoom","attribution","mapbox_logo","bounds","scheme","tileSize","encoding"]);w.vector_layers&&(S.vectorLayers=w.vector_layers,S.vectorLayerIds=S.vectorLayers.map(function(I){return I.id})),S.tiles=s.canonicalizeTileset(S,n.url),o(null,S)}};return n.url?a.getJSON(s.transformRequest(s.normalizeSourceURL(n.url),a.ResourceType.Source),h):a.browser.frame(function(){return h(null,n)})}Ft.prototype.broadcast=function(n,s,o){a.asyncAll(this.actors,function(h,_){h.send(n,s,_)},o=o||function(){})},Ft.prototype.getActor=function(){return this.currentActor=(this.currentActor+1)%this.actors.length,this.actors[this.currentActor]},Ft.prototype.remove=function(){this.actors.forEach(function(n){n.remove()}),this.actors=[],this.workerPool.release(this.id)},Ft.Actor=a.Actor;var $e=function(n,s,o){this.bounds=a.LngLatBounds.convert(this.validateBounds(n)),this.minzoom=s||0,this.maxzoom=o||24};$e.prototype.validateBounds=function(n){return Array.isArray(n)&&n.length===4?[Math.max(-180,n[0]),Math.max(-90,n[1]),Math.min(180,n[2]),Math.min(90,n[3])]:[-180,-90,180,90]},$e.prototype.contains=function(n){var s=Math.pow(2,n.z),o=Math.floor(a.mercatorXfromLng(this.bounds.getWest())*s),h=Math.floor(a.mercatorYfromLat(this.bounds.getNorth())*s),_=Math.ceil(a.mercatorXfromLng(this.bounds.getEast())*s),w=Math.ceil(a.mercatorYfromLat(this.bounds.getSouth())*s);return n.x>=o&&n.x<_&&n.y>=h&&n.y<w};var yt=function(n){function s(o,h,_,w){if(n.call(this),this.id=o,this.dispatcher=_,this.type="vector",this.minzoom=0,this.maxzoom=22,this.scheme="xyz",this.tileSize=512,this.reparseOverscaled=!0,this.isTileClipped=!0,this._loaded=!1,a.extend(this,a.pick(h,["url","scheme","tileSize","promoteId"])),this._options=a.extend({type:"vector"},h),this._collectResourceTiming=h.collectResourceTiming,this.tileSize!==512)throw new Error("vector tile sources must have a tileSize of 512");this.setEventedParent(w)}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype.load=function(){var o=this;this._loaded=!1,this.fire(new a.Event("dataloading",{dataType:"source"})),this._tileJSONRequest=Be(this._options,this.map._requestManager,function(h,_){o._tileJSONRequest=null,o._loaded=!0,h?o.fire(new a.ErrorEvent(h)):_&&(a.extend(o,_),_.bounds&&(o.tileBounds=new $e(_.bounds,o.minzoom,o.maxzoom)),a.postTurnstileEvent(_.tiles,o.map._requestManager._customAccessToken),a.postMapLoadEvent(_.tiles,o.map._getMapId(),o.map._requestManager._skuToken,o.map._requestManager._customAccessToken),o.fire(new a.Event("data",{dataType:"source",sourceDataType:"metadata"})),o.fire(new a.Event("data",{dataType:"source",sourceDataType:"content"})))})},s.prototype.loaded=function(){return this._loaded},s.prototype.hasTile=function(o){return!this.tileBounds||this.tileBounds.contains(o.canonical)},s.prototype.onAdd=function(o){this.map=o,this.load()},s.prototype.setSourceProperty=function(o){this._tileJSONRequest&&this._tileJSONRequest.cancel(),o(),this.map.style.sourceCaches[this.id].clearTiles(),this.load()},s.prototype.setTiles=function(o){var h=this;return this.setSourceProperty(function(){h._options.tiles=o}),this},s.prototype.setUrl=function(o){var h=this;return this.setSourceProperty(function(){h.url=o,h._options.url=o}),this},s.prototype.onRemove=function(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)},s.prototype.serialize=function(){return a.extend({},this._options)},s.prototype.loadTile=function(o,h){var _=this.map._requestManager.normalizeTileURL(o.tileID.canonical.url(this.tiles,this.scheme)),w={request:this.map._requestManager.transformRequest(_,a.ResourceType.Tile),uid:o.uid,tileID:o.tileID,zoom:o.tileID.overscaledZ,tileSize:this.tileSize*o.tileID.overscaleFactor(),type:this.type,source:this.id,pixelRatio:a.browser.devicePixelRatio,showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId};function S(I,P){return delete o.request,o.aborted?h(null):I&&I.status!==404?h(I):(P&&P.resourceTiming&&(o.resourceTiming=P.resourceTiming),this.map._refreshExpiredTiles&&P&&o.setExpiryData(P),o.loadVectorData(P,this.map.painter),a.cacheEntryPossiblyAdded(this.dispatcher),h(null),void(o.reloadCallback&&(this.loadTile(o,o.reloadCallback),o.reloadCallback=null)))}w.request.collectResourceTiming=this._collectResourceTiming,o.actor&&o.state!=="expired"?o.state==="loading"?o.reloadCallback=h:o.request=o.actor.send("reloadTile",w,S.bind(this)):(o.actor=this.dispatcher.getActor(),o.request=o.actor.send("loadTile",w,S.bind(this)))},s.prototype.abortTile=function(o){o.request&&(o.request.cancel(),delete o.request),o.actor&&o.actor.send("abortTile",{uid:o.uid,type:this.type,source:this.id},void 0)},s.prototype.unloadTile=function(o){o.unloadVectorData(),o.actor&&o.actor.send("removeTile",{uid:o.uid,type:this.type,source:this.id},void 0)},s.prototype.hasTransition=function(){return!1},s}(a.Evented),jt=function(n){function s(o,h,_,w){n.call(this),this.id=o,this.dispatcher=_,this.setEventedParent(w),this.type="raster",this.minzoom=0,this.maxzoom=22,this.roundZoom=!0,this.scheme="xyz",this.tileSize=512,this._loaded=!1,this._options=a.extend({type:"raster"},h),a.extend(this,a.pick(h,["url","scheme","tileSize"]))}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype.load=function(){var o=this;this._loaded=!1,this.fire(new a.Event("dataloading",{dataType:"source"})),this._tileJSONRequest=Be(this._options,this.map._requestManager,function(h,_){o._tileJSONRequest=null,o._loaded=!0,h?o.fire(new a.ErrorEvent(h)):_&&(a.extend(o,_),_.bounds&&(o.tileBounds=new $e(_.bounds,o.minzoom,o.maxzoom)),a.postTurnstileEvent(_.tiles),a.postMapLoadEvent(_.tiles,o.map._getMapId(),o.map._requestManager._skuToken),o.fire(new a.Event("data",{dataType:"source",sourceDataType:"metadata"})),o.fire(new a.Event("data",{dataType:"source",sourceDataType:"content"})))})},s.prototype.loaded=function(){return this._loaded},s.prototype.onAdd=function(o){this.map=o,this.load()},s.prototype.onRemove=function(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)},s.prototype.serialize=function(){return a.extend({},this._options)},s.prototype.hasTile=function(o){return!this.tileBounds||this.tileBounds.contains(o.canonical)},s.prototype.loadTile=function(o,h){var _=this,w=this.map._requestManager.normalizeTileURL(o.tileID.canonical.url(this.tiles,this.scheme),this.tileSize);o.request=a.getImage(this.map._requestManager.transformRequest(w,a.ResourceType.Tile),function(S,I){if(delete o.request,o.aborted)o.state="unloaded",h(null);else if(S)o.state="errored",h(S);else if(I){_.map._refreshExpiredTiles&&o.setExpiryData(I),delete I.cacheControl,delete I.expires;var P=_.map.painter.context,O=P.gl;o.texture=_.map.painter.getTileTexture(I.width),o.texture?o.texture.update(I,{useMipmap:!0}):(o.texture=new a.Texture(P,I,O.RGBA,{useMipmap:!0}),o.texture.bind(O.LINEAR,O.CLAMP_TO_EDGE,O.LINEAR_MIPMAP_NEAREST),P.extTextureFilterAnisotropic&&O.texParameterf(O.TEXTURE_2D,P.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,P.extTextureFilterAnisotropicMax)),o.state="loaded",a.cacheEntryPossiblyAdded(_.dispatcher),h(null)}})},s.prototype.abortTile=function(o,h){o.request&&(o.request.cancel(),delete o.request),h()},s.prototype.unloadTile=function(o,h){o.texture&&this.map.painter.saveTileTexture(o.texture),h()},s.prototype.hasTransition=function(){return!1},s}(a.Evented),Lt=function(n){function s(o,h,_,w){n.call(this,o,h,_,w),this.type="raster-dem",this.maxzoom=22,this._options=a.extend({type:"raster-dem"},h),this.encoding=h.encoding||"mapbox"}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype.serialize=function(){return{type:"raster-dem",url:this.url,tileSize:this.tileSize,tiles:this.tiles,bounds:this.bounds,encoding:this.encoding}},s.prototype.loadTile=function(o,h){var _=this.map._requestManager.normalizeTileURL(o.tileID.canonical.url(this.tiles,this.scheme),this.tileSize);function w(S,I){S&&(o.state="errored",h(S)),I&&(o.dem=I,o.needsHillshadePrepare=!0,o.state="loaded",h(null))}o.request=a.getImage(this.map._requestManager.transformRequest(_,a.ResourceType.Tile),(function(S,I){if(delete o.request,o.aborted)o.state="unloaded",h(null);else if(S)o.state="errored",h(S);else if(I){this.map._refreshExpiredTiles&&o.setExpiryData(I),delete I.cacheControl,delete I.expires;var P=a.window.ImageBitmap&&I instanceof a.window.ImageBitmap&&a.offscreenCanvasSupported()?I:a.browser.getImageData(I,1),O={uid:o.uid,coord:o.tileID,source:this.id,rawImageData:P,encoding:this.encoding};o.actor&&o.state!=="expired"||(o.actor=this.dispatcher.getActor(),o.actor.send("loadDEMTile",O,w.bind(this)))}}).bind(this)),o.neighboringTiles=this._getNeighboringTiles(o.tileID)},s.prototype._getNeighboringTiles=function(o){var h=o.canonical,_=Math.pow(2,h.z),w=(h.x-1+_)%_,S=h.x===0?o.wrap-1:o.wrap,I=(h.x+1+_)%_,P=h.x+1===_?o.wrap+1:o.wrap,O={};return O[new a.OverscaledTileID(o.overscaledZ,S,h.z,w,h.y).key]={backfilled:!1},O[new a.OverscaledTileID(o.overscaledZ,P,h.z,I,h.y).key]={backfilled:!1},h.y>0&&(O[new a.OverscaledTileID(o.overscaledZ,S,h.z,w,h.y-1).key]={backfilled:!1},O[new a.OverscaledTileID(o.overscaledZ,o.wrap,h.z,h.x,h.y-1).key]={backfilled:!1},O[new a.OverscaledTileID(o.overscaledZ,P,h.z,I,h.y-1).key]={backfilled:!1}),h.y+1<_&&(O[new a.OverscaledTileID(o.overscaledZ,S,h.z,w,h.y+1).key]={backfilled:!1},O[new a.OverscaledTileID(o.overscaledZ,o.wrap,h.z,h.x,h.y+1).key]={backfilled:!1},O[new a.OverscaledTileID(o.overscaledZ,P,h.z,I,h.y+1).key]={backfilled:!1}),O},s.prototype.unloadTile=function(o){o.demTexture&&this.map.painter.saveTileTexture(o.demTexture),o.fbo&&(o.fbo.destroy(),delete o.fbo),o.dem&&delete o.dem,delete o.neighboringTiles,o.state="unloaded",o.actor&&o.actor.send("removeDEMTile",{uid:o.uid,source:this.id})},s}(jt),St=function(n){function s(o,h,_,w){n.call(this),this.id=o,this.type="geojson",this.minzoom=0,this.maxzoom=18,this.tileSize=512,this.isTileClipped=!0,this.reparseOverscaled=!0,this._removed=!1,this._loaded=!1,this.actor=_.getActor(),this.setEventedParent(w),this._data=h.data,this._options=a.extend({},h),this._collectResourceTiming=h.collectResourceTiming,this._resourceTiming=[],h.maxzoom!==void 0&&(this.maxzoom=h.maxzoom),h.type&&(this.type=h.type),h.attribution&&(this.attribution=h.attribution),this.promoteId=h.promoteId;var S=a.EXTENT/this.tileSize;this.workerOptions=a.extend({source:this.id,cluster:h.cluster||!1,geojsonVtOptions:{buffer:(h.buffer!==void 0?h.buffer:128)*S,tolerance:(h.tolerance!==void 0?h.tolerance:.375)*S,extent:a.EXTENT,maxZoom:this.maxzoom,lineMetrics:h.lineMetrics||!1,generateId:h.generateId||!1},superclusterOptions:{maxZoom:h.clusterMaxZoom!==void 0?Math.min(h.clusterMaxZoom,this.maxzoom-1):this.maxzoom-1,minPoints:Math.max(2,h.clusterMinPoints||2),extent:a.EXTENT,radius:(h.clusterRadius||50)*S,log:!1,generateId:h.generateId||!1},clusterProperties:h.clusterProperties,filter:h.filter},h.workerOptions)}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype.load=function(){var o=this;this.fire(new a.Event("dataloading",{dataType:"source"})),this._updateWorkerData(function(h){if(h)o.fire(new a.ErrorEvent(h));else{var _={dataType:"source",sourceDataType:"metadata"};o._collectResourceTiming&&o._resourceTiming&&o._resourceTiming.length>0&&(_.resourceTiming=o._resourceTiming,o._resourceTiming=[]),o.fire(new a.Event("data",_))}})},s.prototype.onAdd=function(o){this.map=o,this.load()},s.prototype.setData=function(o){var h=this;return this._data=o,this.fire(new a.Event("dataloading",{dataType:"source"})),this._updateWorkerData(function(_){if(_)h.fire(new a.ErrorEvent(_));else{var w={dataType:"source",sourceDataType:"content"};h._collectResourceTiming&&h._resourceTiming&&h._resourceTiming.length>0&&(w.resourceTiming=h._resourceTiming,h._resourceTiming=[]),h.fire(new a.Event("data",w))}}),this},s.prototype.getClusterExpansionZoom=function(o,h){return this.actor.send("geojson.getClusterExpansionZoom",{clusterId:o,source:this.id},h),this},s.prototype.getClusterChildren=function(o,h){return this.actor.send("geojson.getClusterChildren",{clusterId:o,source:this.id},h),this},s.prototype.getClusterLeaves=function(o,h,_,w){return this.actor.send("geojson.getClusterLeaves",{source:this.id,clusterId:o,limit:h,offset:_},w),this},s.prototype._updateWorkerData=function(o){var h=this;this._loaded=!1;var _=a.extend({},this.workerOptions),w=this._data;typeof w=="string"?(_.request=this.map._requestManager.transformRequest(a.browser.resolveURL(w),a.ResourceType.Source),_.request.collectResourceTiming=this._collectResourceTiming):_.data=JSON.stringify(w),this.actor.send(this.type+".loadData",_,function(S,I){h._removed||I&&I.abandoned||(h._loaded=!0,I&&I.resourceTiming&&I.resourceTiming[h.id]&&(h._resourceTiming=I.resourceTiming[h.id].slice(0)),h.actor.send(h.type+".coalesce",{source:_.source},null),o(S))})},s.prototype.loaded=function(){return this._loaded},s.prototype.loadTile=function(o,h){var _=this,w=o.actor?"reloadTile":"loadTile";o.actor=this.actor,o.request=this.actor.send(w,{type:this.type,uid:o.uid,tileID:o.tileID,zoom:o.tileID.overscaledZ,maxZoom:this.maxzoom,tileSize:this.tileSize,source:this.id,pixelRatio:a.browser.devicePixelRatio,showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId},function(S,I){return delete o.request,o.unloadVectorData(),o.aborted?h(null):S?h(S):(o.loadVectorData(I,_.map.painter,w==="reloadTile"),h(null))})},s.prototype.abortTile=function(o){o.request&&(o.request.cancel(),delete o.request),o.aborted=!0},s.prototype.unloadTile=function(o){o.unloadVectorData(),this.actor.send("removeTile",{uid:o.uid,type:this.type,source:this.id})},s.prototype.onRemove=function(){this._removed=!0,this.actor.send("removeSource",{type:this.type,source:this.id})},s.prototype.serialize=function(){return a.extend({},this._options,{type:this.type,data:this._data})},s.prototype.hasTransition=function(){return!1},s}(a.Evented),Ce=a.createLayout([{name:"a_pos",type:"Int16",components:2},{name:"a_texture_pos",type:"Int16",components:2}]),ot=function(n){function s(o,h,_,w){n.call(this),this.id=o,this.dispatcher=_,this.coordinates=h.coordinates,this.type="image",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this.tiles={},this._loaded=!1,this.setEventedParent(w),this.options=h}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype.load=function(o,h){var _=this;this._loaded=!1,this.fire(new a.Event("dataloading",{dataType:"source"})),this.url=this.options.url,a.getImage(this.map._requestManager.transformRequest(this.url,a.ResourceType.Image),function(w,S){_._loaded=!0,w?_.fire(new a.ErrorEvent(w)):S&&(_.image=S,o&&(_.coordinates=o),h&&h(),_._finishLoading())})},s.prototype.loaded=function(){return this._loaded},s.prototype.updateImage=function(o){var h=this;return this.image&&o.url?(this.options.url=o.url,this.load(o.coordinates,function(){h.texture=null}),this):this},s.prototype._finishLoading=function(){this.map&&(this.setCoordinates(this.coordinates),this.fire(new a.Event("data",{dataType:"source",sourceDataType:"metadata"})))},s.prototype.onAdd=function(o){this.map=o,this.load()},s.prototype.setCoordinates=function(o){var h=this;this.coordinates=o;var _=o.map(a.MercatorCoordinate.fromLngLat);this.tileID=function(S){for(var I=1/0,P=1/0,O=-1/0,G=-1/0,Z=0,H=S;Z<H.length;Z+=1){var te=H[Z];I=Math.min(I,te.x),P=Math.min(P,te.y),O=Math.max(O,te.x),G=Math.max(G,te.y)}var ee=Math.max(O-I,G-P),ce=Math.max(0,Math.floor(-Math.log(ee)/Math.LN2)),Y=Math.pow(2,ce);return new a.CanonicalTileID(ce,Math.floor((I+O)/2*Y),Math.floor((P+G)/2*Y))}(_),this.minzoom=this.maxzoom=this.tileID.z;var w=_.map(function(S){return h.tileID.getTilePoint(S)._round()});return this._boundsArray=new a.StructArrayLayout4i8,this._boundsArray.emplaceBack(w[0].x,w[0].y,0,0),this._boundsArray.emplaceBack(w[1].x,w[1].y,a.EXTENT,0),this._boundsArray.emplaceBack(w[3].x,w[3].y,0,a.EXTENT),this._boundsArray.emplaceBack(w[2].x,w[2].y,a.EXTENT,a.EXTENT),this.boundsBuffer&&(this.boundsBuffer.destroy(),delete this.boundsBuffer),this.fire(new a.Event("data",{dataType:"source",sourceDataType:"content"})),this},s.prototype.prepare=function(){if(Object.keys(this.tiles).length!==0&&this.image){var o=this.map.painter.context,h=o.gl;for(var _ in this.boundsBuffer||(this.boundsBuffer=o.createVertexBuffer(this._boundsArray,Ce.members)),this.boundsSegments||(this.boundsSegments=a.SegmentVector.simpleSegment(0,0,4,2)),this.texture||(this.texture=new a.Texture(o,this.image,h.RGBA),this.texture.bind(h.LINEAR,h.CLAMP_TO_EDGE)),this.tiles){var w=this.tiles[_];w.state!=="loaded"&&(w.state="loaded",w.texture=this.texture)}}},s.prototype.loadTile=function(o,h){this.tileID&&this.tileID.equals(o.tileID.canonical)?(this.tiles[String(o.tileID.wrap)]=o,o.buckets={},h(null)):(o.state="errored",h(null))},s.prototype.serialize=function(){return{type:"image",url:this.options.url,coordinates:this.coordinates}},s.prototype.hasTransition=function(){return!1},s}(a.Evented),Dr=function(n){function s(o,h,_,w){n.call(this,o,h,_,w),this.roundZoom=!0,this.type="video",this.options=h}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype.load=function(){var o=this;this._loaded=!1;var h=this.options;this.urls=[];for(var _=0,w=h.urls;_<w.length;_+=1)this.urls.push(this.map._requestManager.transformRequest(w[_],a.ResourceType.Source).url);a.getVideo(this.urls,function(S,I){o._loaded=!0,S?o.fire(new a.ErrorEvent(S)):I&&(o.video=I,o.video.loop=!0,o.video.addEventListener("playing",function(){o.map.triggerRepaint()}),o.map&&o.video.play(),o._finishLoading())})},s.prototype.pause=function(){this.video&&this.video.pause()},s.prototype.play=function(){this.video&&this.video.play()},s.prototype.seek=function(o){if(this.video){var h=this.video.seekable;o<h.start(0)||o>h.end(0)?this.fire(new a.ErrorEvent(new a.ValidationError("sources."+this.id,null,"Playback for this video can be set only between the "+h.start(0)+" and "+h.end(0)+"-second mark."))):this.video.currentTime=o}},s.prototype.getVideo=function(){return this.video},s.prototype.onAdd=function(o){this.map||(this.map=o,this.load(),this.video&&(this.video.play(),this.setCoordinates(this.coordinates)))},s.prototype.prepare=function(){if(!(Object.keys(this.tiles).length===0||this.video.readyState<2)){var o=this.map.painter.context,h=o.gl;for(var _ in this.boundsBuffer||(this.boundsBuffer=o.createVertexBuffer(this._boundsArray,Ce.members)),this.boundsSegments||(this.boundsSegments=a.SegmentVector.simpleSegment(0,0,4,2)),this.texture?this.video.paused||(this.texture.bind(h.LINEAR,h.CLAMP_TO_EDGE),h.texSubImage2D(h.TEXTURE_2D,0,0,0,h.RGBA,h.UNSIGNED_BYTE,this.video)):(this.texture=new a.Texture(o,this.video,h.RGBA),this.texture.bind(h.LINEAR,h.CLAMP_TO_EDGE)),this.tiles){var w=this.tiles[_];w.state!=="loaded"&&(w.state="loaded",w.texture=this.texture)}}},s.prototype.serialize=function(){return{type:"video",urls:this.urls,coordinates:this.coordinates}},s.prototype.hasTransition=function(){return this.video&&!this.video.paused},s}(ot),Kr=function(n){function s(o,h,_,w){n.call(this,o,h,_,w),h.coordinates?Array.isArray(h.coordinates)&&h.coordinates.length===4&&!h.coordinates.some(function(S){return!Array.isArray(S)||S.length!==2||S.some(function(I){return typeof I!="number"})})||this.fire(new a.ErrorEvent(new a.ValidationError("sources."+o,null,'"coordinates" property must be an array of 4 longitude/latitude array pairs'))):this.fire(new a.ErrorEvent(new a.ValidationError("sources."+o,null,'missing required property "coordinates"'))),h.animate&&typeof h.animate!="boolean"&&this.fire(new a.ErrorEvent(new a.ValidationError("sources."+o,null,'optional "animate" property must be a boolean value'))),h.canvas?typeof h.canvas=="string"||h.canvas instanceof a.window.HTMLCanvasElement||this.fire(new a.ErrorEvent(new a.ValidationError("sources."+o,null,'"canvas" must be either a string representing the ID of the canvas element from which to read, or an HTMLCanvasElement instance'))):this.fire(new a.ErrorEvent(new a.ValidationError("sources."+o,null,'missing required property "canvas"'))),this.options=h,this.animate=h.animate===void 0||h.animate}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype.load=function(){this._loaded=!0,this.canvas||(this.canvas=this.options.canvas instanceof a.window.HTMLCanvasElement?this.options.canvas:a.window.document.getElementById(this.options.canvas)),this.width=this.canvas.width,this.height=this.canvas.height,this._hasInvalidDimensions()?this.fire(new a.ErrorEvent(new Error("Canvas dimensions cannot be less than or equal to zero."))):(this.play=function(){this._playing=!0,this.map.triggerRepaint()},this.pause=function(){this._playing&&(this.prepare(),this._playing=!1)},this._finishLoading())},s.prototype.getCanvas=function(){return this.canvas},s.prototype.onAdd=function(o){this.map=o,this.load(),this.canvas&&this.animate&&this.play()},s.prototype.onRemove=function(){this.pause()},s.prototype.prepare=function(){var o=!1;if(this.canvas.width!==this.width&&(this.width=this.canvas.width,o=!0),this.canvas.height!==this.height&&(this.height=this.canvas.height,o=!0),!this._hasInvalidDimensions()&&Object.keys(this.tiles).length!==0){var h=this.map.painter.context,_=h.gl;for(var w in this.boundsBuffer||(this.boundsBuffer=h.createVertexBuffer(this._boundsArray,Ce.members)),this.boundsSegments||(this.boundsSegments=a.SegmentVector.simpleSegment(0,0,4,2)),this.texture?(o||this._playing)&&this.texture.update(this.canvas,{premultiply:!0}):this.texture=new a.Texture(h,this.canvas,_.RGBA,{premultiply:!0}),this.tiles){var S=this.tiles[w];S.state!=="loaded"&&(S.state="loaded",S.texture=this.texture)}}},s.prototype.serialize=function(){return{type:"canvas",coordinates:this.coordinates}},s.prototype.hasTransition=function(){return this._playing},s.prototype._hasInvalidDimensions=function(){for(var o=0,h=[this.canvas.width,this.canvas.height];o<h.length;o+=1){var _=h[o];if(isNaN(_)||_<=0)return!0}return!1},s}(ot),ki={vector:yt,raster:jt,"raster-dem":Lt,geojson:St,video:Dr,image:ot,canvas:Kr};function Br(n,s){var o=a.identity([]);return a.translate(o,o,[1,1,0]),a.scale(o,o,[.5*n.width,.5*n.height,1]),a.multiply(o,o,n.calculatePosMatrix(s.toUnwrapped()))}function cr(n,s,o,h,_,w){var S=function(ce,Y,ue){if(ce)for(var de=0,be=ce;de<be.length;de+=1){var Ae=Y[be[de]];if(Ae&&Ae.source===ue&&Ae.type==="fill-extrusion")return!0}else for(var Ee in Y){var ze=Y[Ee];if(ze.source===ue&&ze.type==="fill-extrusion")return!0}return!1}(_&&_.layers,s,n.id),I=w.maxPitchScaleFactor(),P=n.tilesIn(h,I,S);P.sort(Sr);for(var O=[],G=0,Z=P;G<Z.length;G+=1){var H=Z[G];O.push({wrappedTileID:H.tileID.wrapped().key,queryResults:H.tile.queryRenderedFeatures(s,o,n._state,H.queryGeometry,H.cameraQueryGeometry,H.scale,_,w,I,Br(n.transform,H.tileID))})}var te=function(ce){for(var Y={},ue={},de=0,be=ce;de<be.length;de+=1){var Ae=be[de],Ee=Ae.queryResults,ze=Ae.wrappedTileID,Ve=ue[ze]=ue[ze]||{};for(var Qe in Ee)for(var We=Ee[Qe],ft=Ve[Qe]=Ve[Qe]||{},Tt=Y[Qe]=Y[Qe]||[],Dt=0,Mt=We;Dt<Mt.length;Dt+=1){var gr=Mt[Dt];ft[gr.featureIndex]||(ft[gr.featureIndex]=!0,Tt.push(gr))}}return Y}(O);for(var ee in te)te[ee].forEach(function(ce){var Y=ce.feature,ue=n.getFeatureState(Y.layer["source-layer"],Y.id);Y.source=Y.layer.source,Y.layer["source-layer"]&&(Y.sourceLayer=Y.layer["source-layer"]),Y.state=ue});return te}function Sr(n,s){var o=n.tileID,h=s.tileID;return o.overscaledZ-h.overscaledZ||o.canonical.y-h.canonical.y||o.wrap-h.wrap||o.canonical.x-h.canonical.x}var Gt=function(n,s){this.max=n,this.onRemove=s,this.reset()};Gt.prototype.reset=function(){for(var n in this.data)for(var s=0,o=this.data[n];s<o.length;s+=1){var h=o[s];h.timeout&&clearTimeout(h.timeout),this.onRemove(h.value)}return this.data={},this.order=[],this},Gt.prototype.add=function(n,s,o){var h=this,_=n.wrapped().key;this.data[_]===void 0&&(this.data[_]=[]);var w={value:s,timeout:void 0};if(o!==void 0&&(w.timeout=setTimeout(function(){h.remove(n,w)},o)),this.data[_].push(w),this.order.push(_),this.order.length>this.max){var S=this._getAndRemoveByKey(this.order[0]);S&&this.onRemove(S)}return this},Gt.prototype.has=function(n){return n.wrapped().key in this.data},Gt.prototype.getAndRemove=function(n){return this.has(n)?this._getAndRemoveByKey(n.wrapped().key):null},Gt.prototype._getAndRemoveByKey=function(n){var s=this.data[n].shift();return s.timeout&&clearTimeout(s.timeout),this.data[n].length===0&&delete this.data[n],this.order.splice(this.order.indexOf(n),1),s.value},Gt.prototype.getByKey=function(n){var s=this.data[n];return s?s[0].value:null},Gt.prototype.get=function(n){return this.has(n)?this.data[n.wrapped().key][0].value:null},Gt.prototype.remove=function(n,s){if(!this.has(n))return this;var o=n.wrapped().key,h=s===void 0?0:this.data[o].indexOf(s),_=this.data[o][h];return this.data[o].splice(h,1),_.timeout&&clearTimeout(_.timeout),this.data[o].length===0&&delete this.data[o],this.onRemove(_.value),this.order.splice(this.order.indexOf(o),1),this},Gt.prototype.setMaxSize=function(n){for(this.max=n;this.order.length>this.max;){var s=this._getAndRemoveByKey(this.order[0]);s&&this.onRemove(s)}return this},Gt.prototype.filter=function(n){var s=[];for(var o in this.data)for(var h=0,_=this.data[o];h<_.length;h+=1){var w=_[h];n(w.value)||s.push(w)}for(var S=0,I=s;S<I.length;S+=1){var P=I[S];this.remove(P.value.tileID,P)}};var Ei=function(n,s,o){this.context=n;var h=n.gl;this.buffer=h.createBuffer(),this.dynamicDraw=!!o,this.context.unbindVAO(),n.bindElementBuffer.set(this.buffer),h.bufferData(h.ELEMENT_ARRAY_BUFFER,s.arrayBuffer,this.dynamicDraw?h.DYNAMIC_DRAW:h.STATIC_DRAW),this.dynamicDraw||delete s.arrayBuffer};Ei.prototype.bind=function(){this.context.bindElementBuffer.set(this.buffer)},Ei.prototype.updateData=function(n){var s=this.context.gl;this.context.unbindVAO(),this.bind(),s.bufferSubData(s.ELEMENT_ARRAY_BUFFER,0,n.arrayBuffer)},Ei.prototype.destroy=function(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)};var Yn={Int8:"BYTE",Uint8:"UNSIGNED_BYTE",Int16:"SHORT",Uint16:"UNSIGNED_SHORT",Int32:"INT",Uint32:"UNSIGNED_INT",Float32:"FLOAT"},ti=function(n,s,o,h){this.length=s.length,this.attributes=o,this.itemSize=s.bytesPerElement,this.dynamicDraw=h,this.context=n;var _=n.gl;this.buffer=_.createBuffer(),n.bindVertexBuffer.set(this.buffer),_.bufferData(_.ARRAY_BUFFER,s.arrayBuffer,this.dynamicDraw?_.DYNAMIC_DRAW:_.STATIC_DRAW),this.dynamicDraw||delete s.arrayBuffer};ti.prototype.bind=function(){this.context.bindVertexBuffer.set(this.buffer)},ti.prototype.updateData=function(n){var s=this.context.gl;this.bind(),s.bufferSubData(s.ARRAY_BUFFER,0,n.arrayBuffer)},ti.prototype.enableAttributes=function(n,s){for(var o=0;o<this.attributes.length;o++){var h=s.attributes[this.attributes[o].name];h!==void 0&&n.enableVertexAttribArray(h)}},ti.prototype.setVertexAttribPointers=function(n,s,o){for(var h=0;h<this.attributes.length;h++){var _=this.attributes[h],w=s.attributes[_.name];w!==void 0&&n.vertexAttribPointer(w,_.components,n[Yn[_.type]],!1,this.itemSize,_.offset+this.itemSize*(o||0))}},ti.prototype.destroy=function(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)};var Ut=function(n){this.gl=n.gl,this.default=this.getDefault(),this.current=this.default,this.dirty=!1};Ut.prototype.get=function(){return this.current},Ut.prototype.set=function(n){},Ut.prototype.getDefault=function(){return this.default},Ut.prototype.setDefault=function(){this.set(this.default)};var mn=function(n){function s(){n.apply(this,arguments)}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype.getDefault=function(){return a.Color.transparent},s.prototype.set=function(o){var h=this.current;(o.r!==h.r||o.g!==h.g||o.b!==h.b||o.a!==h.a||this.dirty)&&(this.gl.clearColor(o.r,o.g,o.b,o.a),this.current=o,this.dirty=!1)},s}(Ut),ci=function(n){function s(){n.apply(this,arguments)}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype.getDefault=function(){return 1},s.prototype.set=function(o){(o!==this.current||this.dirty)&&(this.gl.clearDepth(o),this.current=o,this.dirty=!1)},s}(Ut),$r=function(n){function s(){n.apply(this,arguments)}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype.getDefault=function(){return 0},s.prototype.set=function(o){(o!==this.current||this.dirty)&&(this.gl.clearStencil(o),this.current=o,this.dirty=!1)},s}(Ut),Rn=function(n){function s(){n.apply(this,arguments)}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype.getDefault=function(){return[!0,!0,!0,!0]},s.prototype.set=function(o){var h=this.current;(o[0]!==h[0]||o[1]!==h[1]||o[2]!==h[2]||o[3]!==h[3]||this.dirty)&&(this.gl.colorMask(o[0],o[1],o[2],o[3]),this.current=o,this.dirty=!1)},s}(Ut),hi=function(n){function s(){n.apply(this,arguments)}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype.getDefault=function(){return!0},s.prototype.set=function(o){(o!==this.current||this.dirty)&&(this.gl.depthMask(o),this.current=o,this.dirty=!1)},s}(Ut),Tn=function(n){function s(){n.apply(this,arguments)}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype.getDefault=function(){return 255},s.prototype.set=function(o){(o!==this.current||this.dirty)&&(this.gl.stencilMask(o),this.current=o,this.dirty=!1)},s}(Ut),ni=function(n){function s(){n.apply(this,arguments)}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype.getDefault=function(){return{func:this.gl.ALWAYS,ref:0,mask:255}},s.prototype.set=function(o){var h=this.current;(o.func!==h.func||o.ref!==h.ref||o.mask!==h.mask||this.dirty)&&(this.gl.stencilFunc(o.func,o.ref,o.mask),this.current=o,this.dirty=!1)},s}(Ut),zr=function(n){function s(){n.apply(this,arguments)}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype.getDefault=function(){var o=this.gl;return[o.KEEP,o.KEEP,o.KEEP]},s.prototype.set=function(o){var h=this.current;(o[0]!==h[0]||o[1]!==h[1]||o[2]!==h[2]||this.dirty)&&(this.gl.stencilOp(o[0],o[1],o[2]),this.current=o,this.dirty=!1)},s}(Ut),_i=function(n){function s(){n.apply(this,arguments)}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype.getDefault=function(){return!1},s.prototype.set=function(o){if(o!==this.current||this.dirty){var h=this.gl;o?h.enable(h.STENCIL_TEST):h.disable(h.STENCIL_TEST),this.current=o,this.dirty=!1}},s}(Ut),pi=function(n){function s(){n.apply(this,arguments)}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype.getDefault=function(){return[0,1]},s.prototype.set=function(o){var h=this.current;(o[0]!==h[0]||o[1]!==h[1]||this.dirty)&&(this.gl.depthRange(o[0],o[1]),this.current=o,this.dirty=!1)},s}(Ut),qr=function(n){function s(){n.apply(this,arguments)}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype.getDefault=function(){return!1},s.prototype.set=function(o){if(o!==this.current||this.dirty){var h=this.gl;o?h.enable(h.DEPTH_TEST):h.disable(h.DEPTH_TEST),this.current=o,this.dirty=!1}},s}(Ut),Qi=function(n){function s(){n.apply(this,arguments)}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype.getDefault=function(){return this.gl.LESS},s.prototype.set=function(o){(o!==this.current||this.dirty)&&(this.gl.depthFunc(o),this.current=o,this.dirty=!1)},s}(Ut),Hr=function(n){function s(){n.apply(this,arguments)}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype.getDefault=function(){return!1},s.prototype.set=function(o){if(o!==this.current||this.dirty){var h=this.gl;o?h.enable(h.BLEND):h.disable(h.BLEND),this.current=o,this.dirty=!1}},s}(Ut),In=function(n){function s(){n.apply(this,arguments)}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype.getDefault=function(){var o=this.gl;return[o.ONE,o.ZERO]},s.prototype.set=function(o){var h=this.current;(o[0]!==h[0]||o[1]!==h[1]||this.dirty)&&(this.gl.blendFunc(o[0],o[1]),this.current=o,this.dirty=!1)},s}(Ut),$i=function(n){function s(){n.apply(this,arguments)}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype.getDefault=function(){return a.Color.transparent},s.prototype.set=function(o){var h=this.current;(o.r!==h.r||o.g!==h.g||o.b!==h.b||o.a!==h.a||this.dirty)&&(this.gl.blendColor(o.r,o.g,o.b,o.a),this.current=o,this.dirty=!1)},s}(Ut),Bn=function(n){function s(){n.apply(this,arguments)}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype.getDefault=function(){return this.gl.FUNC_ADD},s.prototype.set=function(o){(o!==this.current||this.dirty)&&(this.gl.blendEquation(o),this.current=o,this.dirty=!1)},s}(Ut),Ui=function(n){function s(){n.apply(this,arguments)}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype.getDefault=function(){return!1},s.prototype.set=function(o){if(o!==this.current||this.dirty){var h=this.gl;o?h.enable(h.CULL_FACE):h.disable(h.CULL_FACE),this.current=o,this.dirty=!1}},s}(Ut),An=function(n){function s(){n.apply(this,arguments)}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype.getDefault=function(){return this.gl.BACK},s.prototype.set=function(o){(o!==this.current||this.dirty)&&(this.gl.cullFace(o),this.current=o,this.dirty=!1)},s}(Ut),en=function(n){function s(){n.apply(this,arguments)}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype.getDefault=function(){return this.gl.CCW},s.prototype.set=function(o){(o!==this.current||this.dirty)&&(this.gl.frontFace(o),this.current=o,this.dirty=!1)},s}(Ut),Ri=function(n){function s(){n.apply(this,arguments)}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype.getDefault=function(){return null},s.prototype.set=function(o){(o!==this.current||this.dirty)&&(this.gl.useProgram(o),this.current=o,this.dirty=!1)},s}(Ut),Xr=function(n){function s(){n.apply(this,arguments)}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype.getDefault=function(){return this.gl.TEXTURE0},s.prototype.set=function(o){(o!==this.current||this.dirty)&&(this.gl.activeTexture(o),this.current=o,this.dirty=!1)},s}(Ut),zn=function(n){function s(){n.apply(this,arguments)}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype.getDefault=function(){var o=this.gl;return[0,0,o.drawingBufferWidth,o.drawingBufferHeight]},s.prototype.set=function(o){var h=this.current;(o[0]!==h[0]||o[1]!==h[1]||o[2]!==h[2]||o[3]!==h[3]||this.dirty)&&(this.gl.viewport(o[0],o[1],o[2],o[3]),this.current=o,this.dirty=!1)},s}(Ut),Pn=function(n){function s(){n.apply(this,arguments)}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype.getDefault=function(){return null},s.prototype.set=function(o){if(o!==this.current||this.dirty){var h=this.gl;h.bindFramebuffer(h.FRAMEBUFFER,o),this.current=o,this.dirty=!1}},s}(Ut),vi=function(n){function s(){n.apply(this,arguments)}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype.getDefault=function(){return null},s.prototype.set=function(o){if(o!==this.current||this.dirty){var h=this.gl;h.bindRenderbuffer(h.RENDERBUFFER,o),this.current=o,this.dirty=!1}},s}(Ut),ha=function(n){function s(){n.apply(this,arguments)}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype.getDefault=function(){return null},s.prototype.set=function(o){if(o!==this.current||this.dirty){var h=this.gl;h.bindTexture(h.TEXTURE_2D,o),this.current=o,this.dirty=!1}},s}(Ut),ra=function(n){function s(){n.apply(this,arguments)}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype.getDefault=function(){return null},s.prototype.set=function(o){if(o!==this.current||this.dirty){var h=this.gl;h.bindBuffer(h.ARRAY_BUFFER,o),this.current=o,this.dirty=!1}},s}(Ut),Or=function(n){function s(){n.apply(this,arguments)}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype.getDefault=function(){return null},s.prototype.set=function(o){var h=this.gl;h.bindBuffer(h.ELEMENT_ARRAY_BUFFER,o),this.current=o,this.dirty=!1},s}(Ut),un=function(n){function s(o){n.call(this,o),this.vao=o.extVertexArrayObject}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype.getDefault=function(){return null},s.prototype.set=function(o){this.vao&&(o!==this.current||this.dirty)&&(this.vao.bindVertexArrayOES(o),this.current=o,this.dirty=!1)},s}(Ut),qi=function(n){function s(){n.apply(this,arguments)}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype.getDefault=function(){return 4},s.prototype.set=function(o){if(o!==this.current||this.dirty){var h=this.gl;h.pixelStorei(h.UNPACK_ALIGNMENT,o),this.current=o,this.dirty=!1}},s}(Ut),fi=function(n){function s(){n.apply(this,arguments)}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype.getDefault=function(){return!1},s.prototype.set=function(o){if(o!==this.current||this.dirty){var h=this.gl;h.pixelStorei(h.UNPACK_PREMULTIPLY_ALPHA_WEBGL,o),this.current=o,this.dirty=!1}},s}(Ut),re=function(n){function s(){n.apply(this,arguments)}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype.getDefault=function(){return!1},s.prototype.set=function(o){if(o!==this.current||this.dirty){var h=this.gl;h.pixelStorei(h.UNPACK_FLIP_Y_WEBGL,o),this.current=o,this.dirty=!1}},s}(Ut),et=function(n){function s(o,h){n.call(this,o),this.context=o,this.parent=h}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype.getDefault=function(){return null},s}(Ut),R=function(n){function s(){n.apply(this,arguments)}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype.setDirty=function(){this.dirty=!0},s.prototype.set=function(o){if(o!==this.current||this.dirty){this.context.bindFramebuffer.set(this.parent);var h=this.gl;h.framebufferTexture2D(h.FRAMEBUFFER,h.COLOR_ATTACHMENT0,h.TEXTURE_2D,o,0),this.current=o,this.dirty=!1}},s}(et),N=function(n){function s(){n.apply(this,arguments)}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype.set=function(o){if(o!==this.current||this.dirty){this.context.bindFramebuffer.set(this.parent);var h=this.gl;h.framebufferRenderbuffer(h.FRAMEBUFFER,h.DEPTH_ATTACHMENT,h.RENDERBUFFER,o),this.current=o,this.dirty=!1}},s}(et),q=function(n,s,o,h){this.context=n,this.width=s,this.height=o;var _=this.framebuffer=n.gl.createFramebuffer();this.colorAttachment=new R(n,_),h&&(this.depthAttachment=new N(n,_))};q.prototype.destroy=function(){var n=this.context.gl,s=this.colorAttachment.get();if(s&&n.deleteTexture(s),this.depthAttachment){var o=this.depthAttachment.get();o&&n.deleteRenderbuffer(o)}n.deleteFramebuffer(this.framebuffer)};var K=function(n,s,o){this.func=n,this.mask=s,this.range=o};K.ReadOnly=!1,K.ReadWrite=!0,K.disabled=new K(519,K.ReadOnly,[0,1]);var W=function(n,s,o,h,_,w){this.test=n,this.ref=s,this.mask=o,this.fail=h,this.depthFail=_,this.pass=w};W.disabled=new W({func:519,mask:0},0,0,7680,7680,7680);var le=function(n,s,o){this.blendFunction=n,this.blendColor=s,this.mask=o};le.disabled=new le(le.Replace=[1,0],a.Color.transparent,[!1,!1,!1,!1]),le.unblended=new le(le.Replace,a.Color.transparent,[!0,!0,!0,!0]),le.alphaBlended=new le([1,771],a.Color.transparent,[!0,!0,!0,!0]);var fe=function(n,s,o){this.enable=n,this.mode=s,this.frontFace=o};fe.disabled=new fe(!1,1029,2305),fe.backCCW=new fe(!0,1029,2305);var U=function(n){this.gl=n,this.extVertexArrayObject=this.gl.getExtension("OES_vertex_array_object"),this.clearColor=new mn(this),this.clearDepth=new ci(this),this.clearStencil=new $r(this),this.colorMask=new Rn(this),this.depthMask=new hi(this),this.stencilMask=new Tn(this),this.stencilFunc=new ni(this),this.stencilOp=new zr(this),this.stencilTest=new _i(this),this.depthRange=new pi(this),this.depthTest=new qr(this),this.depthFunc=new Qi(this),this.blend=new Hr(this),this.blendFunc=new In(this),this.blendColor=new $i(this),this.blendEquation=new Bn(this),this.cullFace=new Ui(this),this.cullFaceSide=new An(this),this.frontFace=new en(this),this.program=new Ri(this),this.activeTexture=new Xr(this),this.viewport=new zn(this),this.bindFramebuffer=new Pn(this),this.bindRenderbuffer=new vi(this),this.bindTexture=new ha(this),this.bindVertexBuffer=new ra(this),this.bindElementBuffer=new Or(this),this.bindVertexArrayOES=this.extVertexArrayObject&&new un(this),this.pixelStoreUnpack=new qi(this),this.pixelStoreUnpackPremultiplyAlpha=new fi(this),this.pixelStoreUnpackFlipY=new re(this),this.extTextureFilterAnisotropic=n.getExtension("EXT_texture_filter_anisotropic")||n.getExtension("MOZ_EXT_texture_filter_anisotropic")||n.getExtension("WEBKIT_EXT_texture_filter_anisotropic"),this.extTextureFilterAnisotropic&&(this.extTextureFilterAnisotropicMax=n.getParameter(this.extTextureFilterAnisotropic.MAX_TEXTURE_MAX_ANISOTROPY_EXT)),this.extTextureHalfFloat=n.getExtension("OES_texture_half_float"),this.extTextureHalfFloat&&(n.getExtension("OES_texture_half_float_linear"),this.extRenderToTextureHalfFloat=n.getExtension("EXT_color_buffer_half_float")),this.extTimerQuery=n.getExtension("EXT_disjoint_timer_query"),this.maxTextureSize=n.getParameter(n.MAX_TEXTURE_SIZE)};U.prototype.setDefault=function(){this.unbindVAO(),this.clearColor.setDefault(),this.clearDepth.setDefault(),this.clearStencil.setDefault(),this.colorMask.setDefault(),this.depthMask.setDefault(),this.stencilMask.setDefault(),this.stencilFunc.setDefault(),this.stencilOp.setDefault(),this.stencilTest.setDefault(),this.depthRange.setDefault(),this.depthTest.setDefault(),this.depthFunc.setDefault(),this.blend.setDefault(),this.blendFunc.setDefault(),this.blendColor.setDefault(),this.blendEquation.setDefault(),this.cullFace.setDefault(),this.cullFaceSide.setDefault(),this.frontFace.setDefault(),this.program.setDefault(),this.activeTexture.setDefault(),this.bindFramebuffer.setDefault(),this.pixelStoreUnpack.setDefault(),this.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.pixelStoreUnpackFlipY.setDefault()},U.prototype.setDirty=function(){this.clearColor.dirty=!0,this.clearDepth.dirty=!0,this.clearStencil.dirty=!0,this.colorMask.dirty=!0,this.depthMask.dirty=!0,this.stencilMask.dirty=!0,this.stencilFunc.dirty=!0,this.stencilOp.dirty=!0,this.stencilTest.dirty=!0,this.depthRange.dirty=!0,this.depthTest.dirty=!0,this.depthFunc.dirty=!0,this.blend.dirty=!0,this.blendFunc.dirty=!0,this.blendColor.dirty=!0,this.blendEquation.dirty=!0,this.cullFace.dirty=!0,this.cullFaceSide.dirty=!0,this.frontFace.dirty=!0,this.program.dirty=!0,this.activeTexture.dirty=!0,this.viewport.dirty=!0,this.bindFramebuffer.dirty=!0,this.bindRenderbuffer.dirty=!0,this.bindTexture.dirty=!0,this.bindVertexBuffer.dirty=!0,this.bindElementBuffer.dirty=!0,this.extVertexArrayObject&&(this.bindVertexArrayOES.dirty=!0),this.pixelStoreUnpack.dirty=!0,this.pixelStoreUnpackPremultiplyAlpha.dirty=!0,this.pixelStoreUnpackFlipY.dirty=!0},U.prototype.createIndexBuffer=function(n,s){return new Ei(this,n,s)},U.prototype.createVertexBuffer=function(n,s,o){return new ti(this,n,s,o)},U.prototype.createRenderbuffer=function(n,s,o){var h=this.gl,_=h.createRenderbuffer();return this.bindRenderbuffer.set(_),h.renderbufferStorage(h.RENDERBUFFER,n,s,o),this.bindRenderbuffer.set(null),_},U.prototype.createFramebuffer=function(n,s,o){return new q(this,n,s,o)},U.prototype.clear=function(n){var s=n.color,o=n.depth,h=this.gl,_=0;s&&(_|=h.COLOR_BUFFER_BIT,this.clearColor.set(s),this.colorMask.set([!0,!0,!0,!0])),o!==void 0&&(_|=h.DEPTH_BUFFER_BIT,this.depthRange.set([0,1]),this.clearDepth.set(o),this.depthMask.set(!0)),h.clear(_)},U.prototype.setCullFace=function(n){n.enable===!1?this.cullFace.set(!1):(this.cullFace.set(!0),this.cullFaceSide.set(n.mode),this.frontFace.set(n.frontFace))},U.prototype.setDepthMode=function(n){n.func!==this.gl.ALWAYS||n.mask?(this.depthTest.set(!0),this.depthFunc.set(n.func),this.depthMask.set(n.mask),this.depthRange.set(n.range)):this.depthTest.set(!1)},U.prototype.setStencilMode=function(n){n.test.func!==this.gl.ALWAYS||n.mask?(this.stencilTest.set(!0),this.stencilMask.set(n.mask),this.stencilOp.set([n.fail,n.depthFail,n.pass]),this.stencilFunc.set({func:n.test.func,ref:n.ref,mask:n.test.mask})):this.stencilTest.set(!1)},U.prototype.setColorMode=function(n){a.deepEqual(n.blendFunction,le.Replace)?this.blend.set(!1):(this.blend.set(!0),this.blendFunc.set(n.blendFunction),this.blendColor.set(n.blendColor)),this.colorMask.set(n.mask)},U.prototype.unbindVAO=function(){this.extVertexArrayObject&&this.bindVertexArrayOES.set(null)};var J=function(n){function s(o,h,_){var w=this;n.call(this),this.id=o,this.dispatcher=_,this.on("data",function(S){S.dataType==="source"&&S.sourceDataType==="metadata"&&(w._sourceLoaded=!0),w._sourceLoaded&&!w._paused&&S.dataType==="source"&&S.sourceDataType==="content"&&(w.reload(),w.transform&&w.update(w.transform))}),this.on("error",function(){w._sourceErrored=!0}),this._source=function(S,I,P,O){var G=new ki[I.type](S,I,P,O);if(G.id!==S)throw new Error("Expected Source id to be "+S+" instead of "+G.id);return a.bindAll(["load","abort","unload","serialize","prepare"],G),G}(o,h,_,this),this._tiles={},this._cache=new Gt(0,this._unloadTile.bind(this)),this._timers={},this._cacheTimers={},this._maxTileCacheSize=null,this._loadedParentTiles={},this._coveredTiles={},this._state=new a.SourceFeatureState}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype.onAdd=function(o){this.map=o,this._maxTileCacheSize=o?o._maxTileCacheSize:null,this._source&&this._source.onAdd&&this._source.onAdd(o)},s.prototype.onRemove=function(o){this._source&&this._source.onRemove&&this._source.onRemove(o)},s.prototype.loaded=function(){if(this._sourceErrored)return!0;if(!this._sourceLoaded||!this._source.loaded())return!1;for(var o in this._tiles){var h=this._tiles[o];if(h.state!=="loaded"&&h.state!=="errored")return!1}return!0},s.prototype.getSource=function(){return this._source},s.prototype.pause=function(){this._paused=!0},s.prototype.resume=function(){if(this._paused){var o=this._shouldReloadOnResume;this._paused=!1,this._shouldReloadOnResume=!1,o&&this.reload(),this.transform&&this.update(this.transform)}},s.prototype._loadTile=function(o,h){return this._source.loadTile(o,h)},s.prototype._unloadTile=function(o){if(this._source.unloadTile)return this._source.unloadTile(o,function(){})},s.prototype._abortTile=function(o){if(this._source.abortTile)return this._source.abortTile(o,function(){})},s.prototype.serialize=function(){return this._source.serialize()},s.prototype.prepare=function(o){for(var h in this._source.prepare&&this._source.prepare(),this._state.coalesceChanges(this._tiles,this.map?this.map.painter:null),this._tiles){var _=this._tiles[h];_.upload(o),_.prepare(this.map.style.imageManager)}},s.prototype.getIds=function(){return a.values(this._tiles).map(function(o){return o.tileID}).sort(ge).map(function(o){return o.key})},s.prototype.getRenderableIds=function(o){var h=this,_=[];for(var w in this._tiles)this._isIdRenderable(w,o)&&_.push(this._tiles[w]);return o?_.sort(function(S,I){var P=S.tileID,O=I.tileID,G=new a.Point(P.canonical.x,P.canonical.y)._rotate(h.transform.angle),Z=new a.Point(O.canonical.x,O.canonical.y)._rotate(h.transform.angle);return P.overscaledZ-O.overscaledZ||Z.y-G.y||Z.x-G.x}).map(function(S){return S.tileID.key}):_.map(function(S){return S.tileID}).sort(ge).map(function(S){return S.key})},s.prototype.hasRenderableParent=function(o){var h=this.findLoadedParent(o,0);return!!h&&this._isIdRenderable(h.tileID.key)},s.prototype._isIdRenderable=function(o,h){return this._tiles[o]&&this._tiles[o].hasData()&&!this._coveredTiles[o]&&(h||!this._tiles[o].holdingForFade())},s.prototype.reload=function(){if(this._paused)this._shouldReloadOnResume=!0;else for(var o in this._cache.reset(),this._tiles)this._tiles[o].state!=="errored"&&this._reloadTile(o,"reloading")},s.prototype._reloadTile=function(o,h){var _=this._tiles[o];_&&(_.state!=="loading"&&(_.state=h),this._loadTile(_,this._tileLoaded.bind(this,_,o,h)))},s.prototype._tileLoaded=function(o,h,_,w){if(w)return o.state="errored",void(w.status!==404?this._source.fire(new a.ErrorEvent(w,{tile:o})):this.update(this.transform));o.timeAdded=a.browser.now(),_==="expired"&&(o.refreshedUponExpiration=!0),this._setTileReloadTimer(h,o),this.getSource().type==="raster-dem"&&o.dem&&this._backfillDEM(o),this._state.initializeTileState(o,this.map?this.map.painter:null),this._source.fire(new a.Event("data",{dataType:"source",tile:o,coord:o.tileID}))},s.prototype._backfillDEM=function(o){for(var h=this.getRenderableIds(),_=0;_<h.length;_++){var w=h[_];if(o.neighboringTiles&&o.neighboringTiles[w]){var S=this.getTileByID(w);I(o,S),I(S,o)}}function I(P,O){P.needsHillshadePrepare=!0;var G=O.tileID.canonical.x-P.tileID.canonical.x,Z=O.tileID.canonical.y-P.tileID.canonical.y,H=Math.pow(2,P.tileID.canonical.z),te=O.tileID.key;G===0&&Z===0||Math.abs(Z)>1||(Math.abs(G)>1&&(Math.abs(G+H)===1?G+=H:Math.abs(G-H)===1&&(G-=H)),O.dem&&P.dem&&(P.dem.backfillBorder(O.dem,G,Z),P.neighboringTiles&&P.neighboringTiles[te]&&(P.neighboringTiles[te].backfilled=!0)))}},s.prototype.getTile=function(o){return this.getTileByID(o.key)},s.prototype.getTileByID=function(o){return this._tiles[o]},s.prototype._retainLoadedChildren=function(o,h,_,w){for(var S in this._tiles){var I=this._tiles[S];if(!(w[S]||!I.hasData()||I.tileID.overscaledZ<=h||I.tileID.overscaledZ>_)){for(var P=I.tileID;I&&I.tileID.overscaledZ>h+1;){var O=I.tileID.scaledTo(I.tileID.overscaledZ-1);(I=this._tiles[O.key])&&I.hasData()&&(P=O)}for(var G=P;G.overscaledZ>h;)if(o[(G=G.scaledTo(G.overscaledZ-1)).key]){w[P.key]=P;break}}}},s.prototype.findLoadedParent=function(o,h){if(o.key in this._loadedParentTiles){var _=this._loadedParentTiles[o.key];return _&&_.tileID.overscaledZ>=h?_:null}for(var w=o.overscaledZ-1;w>=h;w--){var S=o.scaledTo(w),I=this._getLoadedTile(S);if(I)return I}},s.prototype._getLoadedTile=function(o){var h=this._tiles[o.key];return h&&h.hasData()?h:this._cache.getByKey(o.wrapped().key)},s.prototype.updateCacheSize=function(o){var h=Math.ceil(o.width/this._source.tileSize)+1,_=Math.ceil(o.height/this._source.tileSize)+1,w=Math.floor(h*_*5),S=typeof this._maxTileCacheSize=="number"?Math.min(this._maxTileCacheSize,w):w;this._cache.setMaxSize(S)},s.prototype.handleWrapJump=function(o){var h=Math.round((o-(this._prevLng===void 0?o:this._prevLng))/360);if(this._prevLng=o,h){var _={};for(var w in this._tiles){var S=this._tiles[w];S.tileID=S.tileID.unwrapTo(S.tileID.wrap+h),_[S.tileID.key]=S}for(var I in this._tiles=_,this._timers)clearTimeout(this._timers[I]),delete this._timers[I];for(var P in this._tiles)this._setTileReloadTimer(P,this._tiles[P])}},s.prototype.update=function(o){var h=this;if(this.transform=o,this._sourceLoaded&&!this._paused){var _;this.updateCacheSize(o),this.handleWrapJump(this.transform.center.lng),this._coveredTiles={},this.used?this._source.tileID?_=o.getVisibleUnwrappedCoordinates(this._source.tileID).map(function(Ve){return new a.OverscaledTileID(Ve.canonical.z,Ve.wrap,Ve.canonical.z,Ve.canonical.x,Ve.canonical.y)}):(_=o.coveringTiles({tileSize:this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this._source.roundZoom,reparseOverscaled:this._source.reparseOverscaled}),this._source.hasTile&&(_=_.filter(function(Ve){return h._source.hasTile(Ve)}))):_=[];var w=o.coveringZoomLevel(this._source),S=Math.max(w-s.maxOverzooming,this._source.minzoom),I=Math.max(w+s.maxUnderzooming,this._source.minzoom),P=this._updateRetainedTiles(_,w);if(De(this._source.type)){for(var O={},G={},Z=0,H=Object.keys(P);Z<H.length;Z+=1){var te=H[Z],ee=P[te],ce=this._tiles[te];if(ce&&!(ce.fadeEndTime&&ce.fadeEndTime<=a.browser.now())){var Y=this.findLoadedParent(ee,S);Y&&(this._addTile(Y.tileID),O[Y.tileID.key]=Y.tileID),G[te]=ee}}for(var ue in this._retainLoadedChildren(G,w,I,P),O)P[ue]||(this._coveredTiles[ue]=!0,P[ue]=O[ue])}for(var de in P)this._tiles[de].clearFadeHold();for(var be=0,Ae=a.keysDifference(this._tiles,P);be<Ae.length;be+=1){var Ee=Ae[be],ze=this._tiles[Ee];ze.hasSymbolBuckets&&!ze.holdingForFade()?ze.setHoldDuration(this.map._fadeDuration):ze.hasSymbolBuckets&&!ze.symbolFadeFinished()||this._removeTile(Ee)}this._updateLoadedParentTileCache()}},s.prototype.releaseSymbolFadeTiles=function(){for(var o in this._tiles)this._tiles[o].holdingForFade()&&this._removeTile(o)},s.prototype._updateRetainedTiles=function(o,h){for(var _={},w={},S=Math.max(h-s.maxOverzooming,this._source.minzoom),I=Math.max(h+s.maxUnderzooming,this._source.minzoom),P={},O=0,G=o;O<G.length;O+=1){var Z=G[O],H=this._addTile(Z);_[Z.key]=Z,H.hasData()||h<this._source.maxzoom&&(P[Z.key]=Z)}this._retainLoadedChildren(P,h,I,_);for(var te=0,ee=o;te<ee.length;te+=1){var ce=ee[te],Y=this._tiles[ce.key];if(!Y.hasData()){if(h+1>this._source.maxzoom){var ue=ce.children(this._source.maxzoom)[0],de=this.getTile(ue);if(de&&de.hasData()){_[ue.key]=ue;continue}}else{var be=ce.children(this._source.maxzoom);if(_[be[0].key]&&_[be[1].key]&&_[be[2].key]&&_[be[3].key])continue}for(var Ae=Y.wasRequested(),Ee=ce.overscaledZ-1;Ee>=S;--Ee){var ze=ce.scaledTo(Ee);if(w[ze.key]||(w[ze.key]=!0,!(Y=this.getTile(ze))&&Ae&&(Y=this._addTile(ze)),Y&&(_[ze.key]=ze,Ae=Y.wasRequested(),Y.hasData())))break}}}return _},s.prototype._updateLoadedParentTileCache=function(){for(var o in this._loadedParentTiles={},this._tiles){for(var h=[],_=void 0,w=this._tiles[o].tileID;w.overscaledZ>0;){if(w.key in this._loadedParentTiles){_=this._loadedParentTiles[w.key];break}h.push(w.key);var S=w.scaledTo(w.overscaledZ-1);if(_=this._getLoadedTile(S))break;w=S}for(var I=0,P=h;I<P.length;I+=1)this._loadedParentTiles[P[I]]=_}},s.prototype._addTile=function(o){var h=this._tiles[o.key];if(h)return h;(h=this._cache.getAndRemove(o))&&(this._setTileReloadTimer(o.key,h),h.tileID=o,this._state.initializeTileState(h,this.map?this.map.painter:null),this._cacheTimers[o.key]&&(clearTimeout(this._cacheTimers[o.key]),delete this._cacheTimers[o.key],this._setTileReloadTimer(o.key,h)));var _=!!h;return _||(h=new a.Tile(o,this._source.tileSize*o.overscaleFactor()),this._loadTile(h,this._tileLoaded.bind(this,h,o.key,h.state))),h?(h.uses++,this._tiles[o.key]=h,_||this._source.fire(new a.Event("dataloading",{tile:h,coord:h.tileID,dataType:"source"})),h):null},s.prototype._setTileReloadTimer=function(o,h){var _=this;o in this._timers&&(clearTimeout(this._timers[o]),delete this._timers[o]);var w=h.getExpiryTimeout();w&&(this._timers[o]=setTimeout(function(){_._reloadTile(o,"expired"),delete _._timers[o]},w))},s.prototype._removeTile=function(o){var h=this._tiles[o];h&&(h.uses--,delete this._tiles[o],this._timers[o]&&(clearTimeout(this._timers[o]),delete this._timers[o]),h.uses>0||(h.hasData()&&h.state!=="reloading"?this._cache.add(h.tileID,h,h.getExpiryTimeout()):(h.aborted=!0,this._abortTile(h),this._unloadTile(h))))},s.prototype.clearTiles=function(){for(var o in this._shouldReloadOnResume=!1,this._paused=!1,this._tiles)this._removeTile(o);this._cache.reset()},s.prototype.tilesIn=function(o,h,_){var w=this,S=[],I=this.transform;if(!I)return S;for(var P=_?I.getCameraQueryGeometry(o):o,O=o.map(function(Ee){return I.pointCoordinate(Ee)}),G=P.map(function(Ee){return I.pointCoordinate(Ee)}),Z=this.getIds(),H=1/0,te=1/0,ee=-1/0,ce=-1/0,Y=0,ue=G;Y<ue.length;Y+=1){var de=ue[Y];H=Math.min(H,de.x),te=Math.min(te,de.y),ee=Math.max(ee,de.x),ce=Math.max(ce,de.y)}for(var be=function(Ee){var ze=w._tiles[Z[Ee]];if(!ze.holdingForFade()){var Ve=ze.tileID,Qe=Math.pow(2,I.zoom-ze.tileID.overscaledZ),We=h*ze.queryPadding*a.EXTENT/ze.tileSize/Qe,ft=[Ve.getTilePoint(new a.MercatorCoordinate(H,te)),Ve.getTilePoint(new a.MercatorCoordinate(ee,ce))];if(ft[0].x-We<a.EXTENT&&ft[0].y-We<a.EXTENT&&ft[1].x+We>=0&&ft[1].y+We>=0){var Tt=O.map(function(Mt){return Ve.getTilePoint(Mt)}),Dt=G.map(function(Mt){return Ve.getTilePoint(Mt)});S.push({tile:ze,tileID:Ve,queryGeometry:Tt,cameraQueryGeometry:Dt,scale:Qe})}}},Ae=0;Ae<Z.length;Ae++)be(Ae);return S},s.prototype.getVisibleCoordinates=function(o){for(var h=this,_=this.getRenderableIds(o).map(function(P){return h._tiles[P].tileID}),w=0,S=_;w<S.length;w+=1){var I=S[w];I.posMatrix=this.transform.calculatePosMatrix(I.toUnwrapped())}return _},s.prototype.hasTransition=function(){if(this._source.hasTransition())return!0;if(De(this._source.type))for(var o in this._tiles){var h=this._tiles[o];if(h.fadeEndTime!==void 0&&h.fadeEndTime>=a.browser.now())return!0}return!1},s.prototype.setFeatureState=function(o,h,_){this._state.updateState(o=o||"_geojsonTileLayer",h,_)},s.prototype.removeFeatureState=function(o,h,_){this._state.removeFeatureState(o=o||"_geojsonTileLayer",h,_)},s.prototype.getFeatureState=function(o,h){return this._state.getState(o=o||"_geojsonTileLayer",h)},s.prototype.setDependencies=function(o,h,_){var w=this._tiles[o];w&&w.setDependencies(h,_)},s.prototype.reloadTilesForDependencies=function(o,h){for(var _ in this._tiles)this._tiles[_].hasDependency(o,h)&&this._reloadTile(_,"reloading");this._cache.filter(function(w){return!w.hasDependency(o,h)})},s}(a.Evented);function ge(n,s){var o=Math.abs(2*n.wrap)-+(n.wrap<0),h=Math.abs(2*s.wrap)-+(s.wrap<0);return n.overscaledZ-s.overscaledZ||h-o||s.canonical.y-n.canonical.y||s.canonical.x-n.canonical.x}function De(n){return n==="raster"||n==="image"||n==="video"}function Ne(){return new a.window.Worker(rl.workerUrl)}J.maxOverzooming=10,J.maxUnderzooming=3;var ke="mapboxgl_preloaded_worker_pool",Le=function(){this.active={}};Le.prototype.acquire=function(n){if(!this.workers)for(this.workers=[];this.workers.length<Le.workerCount;)this.workers.push(new Ne);return this.active[n]=!0,this.workers.slice()},Le.prototype.release=function(n){delete this.active[n],this.numActive()===0&&(this.workers.forEach(function(s){s.terminate()}),this.workers=null)},Le.prototype.isPreloaded=function(){return!!this.active[ke]},Le.prototype.numActive=function(){return Object.keys(this.active).length};var pt,lt=Math.floor(a.browser.hardwareConcurrency/2);function Ie(){return pt||(pt=new Le),pt}function nt(n,s){var o={};for(var h in n)h!=="ref"&&(o[h]=n[h]);return a.refProperties.forEach(function(_){_ in s&&(o[_]=s[_])}),o}function Je(n){n=n.slice();for(var s=Object.create(null),o=0;o<n.length;o++)s[n[o].id]=n[o];for(var h=0;h<n.length;h++)"ref"in n[h]&&(n[h]=nt(n[h],s[n[h].ref]));return n}Le.workerCount=Math.max(Math.min(lt,6),1);var He={setStyle:"setStyle",addLayer:"addLayer",removeLayer:"removeLayer",setPaintProperty:"setPaintProperty",setLayoutProperty:"setLayoutProperty",setFilter:"setFilter",addSource:"addSource",removeSource:"removeSource",setGeoJSONSourceData:"setGeoJSONSourceData",setLayerZoomRange:"setLayerZoomRange",setLayerProperty:"setLayerProperty",setCenter:"setCenter",setZoom:"setZoom",setBearing:"setBearing",setPitch:"setPitch",setSprite:"setSprite",setGlyphs:"setGlyphs",setTransition:"setTransition",setLight:"setLight"};function Zt(n,s,o){o.push({command:He.addSource,args:[n,s[n]]})}function st(n,s,o){s.push({command:He.removeSource,args:[n]}),o[n]=!0}function nr(n,s,o,h){st(n,o,h),Zt(n,s,o)}function br(n,s,o){var h;for(h in n[o])if(n[o].hasOwnProperty(h)&&h!=="data"&&!a.deepEqual(n[o][h],s[o][h]))return!1;for(h in s[o])if(s[o].hasOwnProperty(h)&&h!=="data"&&!a.deepEqual(n[o][h],s[o][h]))return!1;return!0}function Xt(n,s,o,h,_,w){var S;for(S in s=s||{},n=n||{})n.hasOwnProperty(S)&&(a.deepEqual(n[S],s[S])||o.push({command:w,args:[h,S,s[S],_]}));for(S in s)s.hasOwnProperty(S)&&!n.hasOwnProperty(S)&&(a.deepEqual(n[S],s[S])||o.push({command:w,args:[h,S,s[S],_]}))}function pr(n){return n.id}function ar(n,s){return n[s.id]=s,n}var bi=function(n,s){this.reset(n,s)};bi.prototype.reset=function(n,s){this.points=n||[],this._distances=[0];for(var o=1;o<this.points.length;o++)this._distances[o]=this._distances[o-1]+this.points[o].dist(this.points[o-1]);this.length=this._distances[this._distances.length-1],this.padding=Math.min(s||0,.5*this.length),this.paddedLength=this.length-2*this.padding},bi.prototype.lerp=function(n){if(this.points.length===1)return this.points[0];n=a.clamp(n,0,1);for(var s=1,o=this._distances[s],h=n*this.paddedLength+this.padding;o<h&&s<this._distances.length;)o=this._distances[++s];var _=s-1,w=this._distances[_],S=o-w,I=S>0?(h-w)/S:0;return this.points[_].mult(1-I).add(this.points[s].mult(I))};var mr=function(n,s,o){var h=this.boxCells=[],_=this.circleCells=[];this.xCellCount=Math.ceil(n/o),this.yCellCount=Math.ceil(s/o);for(var w=0;w<this.xCellCount*this.yCellCount;w++)h.push([]),_.push([]);this.circleKeys=[],this.boxKeys=[],this.bboxes=[],this.circles=[],this.width=n,this.height=s,this.xScale=this.xCellCount/n,this.yScale=this.yCellCount/s,this.boxUid=0,this.circleUid=0};function Fr(n,s,o,h,_){var w=a.create();return s?(a.scale(w,w,[1/_,1/_,1]),o||a.rotateZ(w,w,h.angle)):a.multiply(w,h.labelPlaneMatrix,n),w}function vr(n,s,o,h,_){if(s){var w=a.clone(n);return a.scale(w,w,[_,_,1]),o||a.rotateZ(w,w,-h.angle),w}return h.glCoordMatrix}function Qt(n,s){var o=[n.x,n.y,0,1];oi(o,o,s);var h=o[3];return{point:new a.Point(o[0]/h,o[1]/h),signedDistanceFromCamera:h}}function fr(n,s){return .5+n/s*.5}function Ti(n,s){var o=n[0]/n[3],h=n[1]/n[3];return o>=-s[0]&&o<=s[0]&&h>=-s[1]&&h<=s[1]}function pa(n,s,o,h,_,w,S,I){var P=h?n.textSizeData:n.iconSizeData,O=a.evaluateSizeForZoom(P,o.transform.zoom),G=[256/o.width*2+1,256/o.height*2+1],Z=h?n.text.dynamicLayoutVertexArray:n.icon.dynamicLayoutVertexArray;Z.clear();for(var H=n.lineVertexArray,te=h?n.text.placedSymbolArray:n.icon.placedSymbolArray,ee=o.transform.width/o.transform.height,ce=!1,Y=0;Y<te.length;Y++){var ue=te.get(Y);if(ue.hidden||ue.writingMode===a.WritingMode.vertical&&!ce)Ii(ue.numGlyphs,Z);else{ce=!1;var de=[ue.anchorX,ue.anchorY,0,1];if(a.transformMat4(de,de,s),Ti(de,G)){var be=fr(o.transform.cameraToCenterDistance,de[3]),Ae=a.evaluateSizeForFeature(P,O,ue),Ee=S?Ae/be:Ae*be,ze=new a.Point(ue.anchorX,ue.anchorY),Ve=Qt(ze,_).point,Qe={},We=Na(ue,Ee,!1,I,s,_,w,n.glyphOffsetArray,H,Z,Ve,ze,Qe,ee);ce=We.useVertical,(We.notEnoughRoom||ce||We.needsFlipping&&Na(ue,Ee,!0,I,s,_,w,n.glyphOffsetArray,H,Z,Ve,ze,Qe,ee).notEnoughRoom)&&Ii(ue.numGlyphs,Z)}else Ii(ue.numGlyphs,Z)}}h?n.text.dynamicLayoutVertexBuffer.updateData(Z):n.icon.dynamicLayoutVertexBuffer.updateData(Z)}function ai(n,s,o,h,_,w,S,I,P,O,G){var Z=I.glyphStartIndex+I.numGlyphs,H=I.lineStartIndex,te=I.lineStartIndex+I.lineLength,ee=s.getoffsetX(I.glyphStartIndex),ce=s.getoffsetX(Z-1),Y=jr(n*ee,o,h,_,w,S,I.segment,H,te,P,O,G);if(!Y)return null;var ue=jr(n*ce,o,h,_,w,S,I.segment,H,te,P,O,G);return ue?{first:Y,last:ue}:null}function Bi(n,s,o,h){return n===a.WritingMode.horizontal&&Math.abs(o.y-s.y)>Math.abs(o.x-s.x)*h?{useVertical:!0}:(n===a.WritingMode.vertical?s.y<o.y:s.x>o.x)?{needsFlipping:!0}:null}function Na(n,s,o,h,_,w,S,I,P,O,G,Z,H,te){var ee,ce=s/24,Y=n.lineOffsetX*ce,ue=n.lineOffsetY*ce;if(n.numGlyphs>1){var de=n.glyphStartIndex+n.numGlyphs,be=n.lineStartIndex,Ae=n.lineStartIndex+n.lineLength,Ee=ai(ce,I,Y,ue,o,G,Z,n,P,w,H);if(!Ee)return{notEnoughRoom:!0};var ze=Qt(Ee.first.point,S).point,Ve=Qt(Ee.last.point,S).point;if(h&&!o){var Qe=Bi(n.writingMode,ze,Ve,te);if(Qe)return Qe}ee=[Ee.first];for(var We=n.glyphStartIndex+1;We<de-1;We++)ee.push(jr(ce*I.getoffsetX(We),Y,ue,o,G,Z,n.segment,be,Ae,P,w,H));ee.push(Ee.last)}else{if(h&&!o){var ft=Qt(Z,_).point,Tt=n.lineStartIndex+n.segment+1,Dt=new a.Point(P.getx(Tt),P.gety(Tt)),Mt=Qt(Dt,_),gr=Mt.signedDistanceFromCamera>0?Mt.point:va(Z,Dt,ft,1,_),dt=Bi(n.writingMode,ft,gr,te);if(dt)return dt}var qt=jr(ce*I.getoffsetX(n.glyphStartIndex),Y,ue,o,G,Z,n.segment,n.lineStartIndex,n.lineStartIndex+n.lineLength,P,w,H);if(!qt)return{notEnoughRoom:!0};ee=[qt]}for(var Jt=0,Vt=ee;Jt<Vt.length;Jt+=1){var Nt=Vt[Jt];a.addDynamicAttributes(O,Nt.point,Nt.angle)}return{}}function va(n,s,o,h,_){var w=Qt(n.add(n.sub(s)._unit()),_).point,S=o.sub(w);return o.add(S._mult(h/S.mag()))}function jr(n,s,o,h,_,w,S,I,P,O,G,Z){var H=h?n-s:n+s,te=H>0?1:-1,ee=0;h&&(te*=-1,ee=Math.PI),te<0&&(ee+=Math.PI);for(var ce=te>0?I+S:I+S+1,Y=_,ue=_,de=0,be=0,Ae=Math.abs(H),Ee=[];de+be<=Ae;){if((ce+=te)<I||ce>=P)return null;if(ue=Y,Ee.push(Y),(Y=Z[ce])===void 0){var ze=new a.Point(O.getx(ce),O.gety(ce)),Ve=Qt(ze,G);if(Ve.signedDistanceFromCamera>0)Y=Z[ce]=Ve.point;else{var Qe=ce-te;Y=va(de===0?w:new a.Point(O.getx(Qe),O.gety(Qe)),ze,ue,Ae-de+1,G)}}de+=be,be=ue.dist(Y)}var We=(Ae-de)/be,ft=Y.sub(ue),Tt=ft.mult(We)._add(ue);Tt._add(ft._unit()._perp()._mult(o*te));var Dt=ee+Math.atan2(Y.y-ue.y,Y.x-ue.x);return Ee.push(Tt),{point:Tt,angle:Dt,path:Ee}}mr.prototype.keysLength=function(){return this.boxKeys.length+this.circleKeys.length},mr.prototype.insert=function(n,s,o,h,_){this._forEachCell(s,o,h,_,this._insertBoxCell,this.boxUid++),this.boxKeys.push(n),this.bboxes.push(s),this.bboxes.push(o),this.bboxes.push(h),this.bboxes.push(_)},mr.prototype.insertCircle=function(n,s,o,h){this._forEachCell(s-h,o-h,s+h,o+h,this._insertCircleCell,this.circleUid++),this.circleKeys.push(n),this.circles.push(s),this.circles.push(o),this.circles.push(h)},mr.prototype._insertBoxCell=function(n,s,o,h,_,w){this.boxCells[_].push(w)},mr.prototype._insertCircleCell=function(n,s,o,h,_,w){this.circleCells[_].push(w)},mr.prototype._query=function(n,s,o,h,_,w){if(o<0||n>this.width||h<0||s>this.height)return!_&&[];var S=[];if(n<=0&&s<=0&&this.width<=o&&this.height<=h){if(_)return!0;for(var I=0;I<this.boxKeys.length;I++)S.push({key:this.boxKeys[I],x1:this.bboxes[4*I],y1:this.bboxes[4*I+1],x2:this.bboxes[4*I+2],y2:this.bboxes[4*I+3]});for(var P=0;P<this.circleKeys.length;P++){var O=this.circles[3*P],G=this.circles[3*P+1],Z=this.circles[3*P+2];S.push({key:this.circleKeys[P],x1:O-Z,y1:G-Z,x2:O+Z,y2:G+Z})}return w?S.filter(w):S}return this._forEachCell(n,s,o,h,this._queryCell,S,{hitTest:_,seenUids:{box:{},circle:{}}},w),_?S.length>0:S},mr.prototype._queryCircle=function(n,s,o,h,_){var w=n-o,S=n+o,I=s-o,P=s+o;if(S<0||w>this.width||P<0||I>this.height)return!h&&[];var O=[];return this._forEachCell(w,I,S,P,this._queryCellCircle,O,{hitTest:h,circle:{x:n,y:s,radius:o},seenUids:{box:{},circle:{}}},_),h?O.length>0:O},mr.prototype.query=function(n,s,o,h,_){return this._query(n,s,o,h,!1,_)},mr.prototype.hitTest=function(n,s,o,h,_){return this._query(n,s,o,h,!0,_)},mr.prototype.hitTestCircle=function(n,s,o,h){return this._queryCircle(n,s,o,!0,h)},mr.prototype._queryCell=function(n,s,o,h,_,w,S,I){var P=S.seenUids,O=this.boxCells[_];if(O!==null)for(var G=this.bboxes,Z=0,H=O;Z<H.length;Z+=1){var te=H[Z];if(!P.box[te]){P.box[te]=!0;var ee=4*te;if(n<=G[ee+2]&&s<=G[ee+3]&&o>=G[ee+0]&&h>=G[ee+1]&&(!I||I(this.boxKeys[te]))){if(S.hitTest)return w.push(!0),!0;w.push({key:this.boxKeys[te],x1:G[ee],y1:G[ee+1],x2:G[ee+2],y2:G[ee+3]})}}}var ce=this.circleCells[_];if(ce!==null)for(var Y=this.circles,ue=0,de=ce;ue<de.length;ue+=1){var be=de[ue];if(!P.circle[be]){P.circle[be]=!0;var Ae=3*be;if(this._circleAndRectCollide(Y[Ae],Y[Ae+1],Y[Ae+2],n,s,o,h)&&(!I||I(this.circleKeys[be]))){if(S.hitTest)return w.push(!0),!0;var Ee=Y[Ae],ze=Y[Ae+1],Ve=Y[Ae+2];w.push({key:this.circleKeys[be],x1:Ee-Ve,y1:ze-Ve,x2:Ee+Ve,y2:ze+Ve})}}}},mr.prototype._queryCellCircle=function(n,s,o,h,_,w,S,I){var P=S.circle,O=S.seenUids,G=this.boxCells[_];if(G!==null)for(var Z=this.bboxes,H=0,te=G;H<te.length;H+=1){var ee=te[H];if(!O.box[ee]){O.box[ee]=!0;var ce=4*ee;if(this._circleAndRectCollide(P.x,P.y,P.radius,Z[ce+0],Z[ce+1],Z[ce+2],Z[ce+3])&&(!I||I(this.boxKeys[ee])))return w.push(!0),!0}}var Y=this.circleCells[_];if(Y!==null)for(var ue=this.circles,de=0,be=Y;de<be.length;de+=1){var Ae=be[de];if(!O.circle[Ae]){O.circle[Ae]=!0;var Ee=3*Ae;if(this._circlesCollide(ue[Ee],ue[Ee+1],ue[Ee+2],P.x,P.y,P.radius)&&(!I||I(this.circleKeys[Ae])))return w.push(!0),!0}}},mr.prototype._forEachCell=function(n,s,o,h,_,w,S,I){for(var P=this._convertToXCellCoord(n),O=this._convertToYCellCoord(s),G=this._convertToXCellCoord(o),Z=this._convertToYCellCoord(h),H=P;H<=G;H++)for(var te=O;te<=Z;te++)if(_.call(this,n,s,o,h,this.xCellCount*te+H,w,S,I))return},mr.prototype._convertToXCellCoord=function(n){return Math.max(0,Math.min(this.xCellCount-1,Math.floor(n*this.xScale)))},mr.prototype._convertToYCellCoord=function(n){return Math.max(0,Math.min(this.yCellCount-1,Math.floor(n*this.yScale)))},mr.prototype._circlesCollide=function(n,s,o,h,_,w){var S=h-n,I=_-s,P=o+w;return P*P>S*S+I*I},mr.prototype._circleAndRectCollide=function(n,s,o,h,_,w,S){var I=(w-h)/2,P=Math.abs(n-(h+I));if(P>I+o)return!1;var O=(S-_)/2,G=Math.abs(s-(_+O));if(G>O+o)return!1;if(P<=I||G<=O)return!0;var Z=P-I,H=G-O;return Z*Z+H*H<=o*o};var ba=new Float32Array([-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0]);function Ii(n,s){for(var o=0;o<n;o++){var h=s.length;s.resize(h+4),s.float32.set(ba,3*h)}}function oi(n,s,o){var h=s[0],_=s[1];return n[0]=o[0]*h+o[4]*_+o[12],n[1]=o[1]*h+o[5]*_+o[13],n[3]=o[3]*h+o[7]*_+o[15],n}var cn=function(n,s,o){s===void 0&&(s=new mr(n.width+200,n.height+200,25)),o===void 0&&(o=new mr(n.width+200,n.height+200,25)),this.transform=n,this.grid=s,this.ignoredGrid=o,this.pitchfactor=Math.cos(n._pitch)*n.cameraToCenterDistance,this.screenRightBoundary=n.width+100,this.screenBottomBoundary=n.height+100,this.gridRightBoundary=n.width+200,this.gridBottomBoundary=n.height+200};function Cr(n,s,o){return s*(a.EXTENT/(n.tileSize*Math.pow(2,o-n.tileID.overscaledZ)))}cn.prototype.placeCollisionBox=function(n,s,o,h,_){var w=this.projectAndGetPerspectiveRatio(h,n.anchorPointX,n.anchorPointY),S=o*w.perspectiveRatio,I=n.x1*S+w.point.x,P=n.y1*S+w.point.y,O=n.x2*S+w.point.x,G=n.y2*S+w.point.y;return!this.isInsideGrid(I,P,O,G)||!s&&this.grid.hitTest(I,P,O,G,_)?{box:[],offscreen:!1}:{box:[I,P,O,G],offscreen:this.isOffscreen(I,P,O,G)}},cn.prototype.placeCollisionCircles=function(n,s,o,h,_,w,S,I,P,O,G,Z,H){var te=[],ee=new a.Point(s.anchorX,s.anchorY),ce=Qt(ee,w),Y=fr(this.transform.cameraToCenterDistance,ce.signedDistanceFromCamera),ue=(O?_/Y:_*Y)/a.ONE_EM,de=Qt(ee,S).point,be=ai(ue,h,s.lineOffsetX*ue,s.lineOffsetY*ue,!1,de,ee,s,o,S,{}),Ae=!1,Ee=!1,ze=!0;if(be){for(var Ve=.5*Z*Y+H,Qe=new a.Point(-100,-100),We=new a.Point(this.screenRightBoundary,this.screenBottomBoundary),ft=new bi,Tt=be.first,Dt=be.last,Mt=[],gr=Tt.path.length-1;gr>=1;gr--)Mt.push(Tt.path[gr]);for(var dt=1;dt<Dt.path.length;dt++)Mt.push(Dt.path[dt]);var qt=2.5*Ve;if(I){var Jt=Mt.map(function(oa){return Qt(oa,I)});Mt=Jt.some(function(oa){return oa.signedDistanceFromCamera<=0})?[]:Jt.map(function(oa){return oa.point})}var Vt=[];if(Mt.length>0){for(var Nt=Mt[0].clone(),Wt=Mt[0].clone(),Ot=1;Ot<Mt.length;Ot++)Nt.x=Math.min(Nt.x,Mt[Ot].x),Nt.y=Math.min(Nt.y,Mt[Ot].y),Wt.x=Math.max(Wt.x,Mt[Ot].x),Wt.y=Math.max(Wt.y,Mt[Ot].y);Vt=Nt.x>=Qe.x&&Wt.x<=We.x&&Nt.y>=Qe.y&&Wt.y<=We.y?[Mt]:Wt.x<Qe.x||Nt.x>We.x||Wt.y<Qe.y||Nt.y>We.y?[]:a.clipLine([Mt],Qe.x,Qe.y,We.x,We.y)}for(var Rt=0,Oi=Vt;Rt<Oi.length;Rt+=1){var si;ft.reset(Oi[Rt],.25*Ve),si=ft.length<=.5*Ve?1:Math.ceil(ft.paddedLength/qt)+1;for(var pn=0;pn<si;pn++){var Hi=pn/Math.max(si-1,1),ri=ft.lerp(Hi),di=ri.x+100,Zn=ri.y+100;te.push(di,Zn,Ve,0);var vn=di-Ve,Qa=Zn-Ve,Cn=di+Ve,_a=Zn+Ve;if(ze=ze&&this.isOffscreen(vn,Qa,Cn,_a),Ee=Ee||this.isInsideGrid(vn,Qa,Cn,_a),!n&&this.grid.hitTestCircle(di,Zn,Ve,G)&&(Ae=!0,!P))return{circles:[],offscreen:!1,collisionDetected:Ae}}}}return{circles:!P&&Ae||!Ee?[]:te,offscreen:ze,collisionDetected:Ae}},cn.prototype.queryRenderedSymbols=function(n){if(n.length===0||this.grid.keysLength()===0&&this.ignoredGrid.keysLength()===0)return{};for(var s=[],o=1/0,h=1/0,_=-1/0,w=-1/0,S=0,I=n;S<I.length;S+=1){var P=I[S],O=new a.Point(P.x+100,P.y+100);o=Math.min(o,O.x),h=Math.min(h,O.y),_=Math.max(_,O.x),w=Math.max(w,O.y),s.push(O)}for(var G={},Z={},H=0,te=this.grid.query(o,h,_,w).concat(this.ignoredGrid.query(o,h,_,w));H<te.length;H+=1){var ee=te[H],ce=ee.key;if(G[ce.bucketInstanceId]===void 0&&(G[ce.bucketInstanceId]={}),!G[ce.bucketInstanceId][ce.featureIndex]){var Y=[new a.Point(ee.x1,ee.y1),new a.Point(ee.x2,ee.y1),new a.Point(ee.x2,ee.y2),new a.Point(ee.x1,ee.y2)];a.polygonIntersectsPolygon(s,Y)&&(G[ce.bucketInstanceId][ce.featureIndex]=!0,Z[ce.bucketInstanceId]===void 0&&(Z[ce.bucketInstanceId]=[]),Z[ce.bucketInstanceId].push(ce.featureIndex))}}return Z},cn.prototype.insertCollisionBox=function(n,s,o,h,_){(s?this.ignoredGrid:this.grid).insert({bucketInstanceId:o,featureIndex:h,collisionGroupID:_},n[0],n[1],n[2],n[3])},cn.prototype.insertCollisionCircles=function(n,s,o,h,_){for(var w=s?this.ignoredGrid:this.grid,S={bucketInstanceId:o,featureIndex:h,collisionGroupID:_},I=0;I<n.length;I+=4)w.insertCircle(S,n[I],n[I+1],n[I+2])},cn.prototype.projectAndGetPerspectiveRatio=function(n,s,o){var h=[s,o,0,1];return oi(h,h,n),{point:new a.Point((h[0]/h[3]+1)/2*this.transform.width+100,(-h[1]/h[3]+1)/2*this.transform.height+100),perspectiveRatio:.5+this.transform.cameraToCenterDistance/h[3]*.5}},cn.prototype.isOffscreen=function(n,s,o,h){return o<100||n>=this.screenRightBoundary||h<100||s>this.screenBottomBoundary},cn.prototype.isInsideGrid=function(n,s,o,h){return o>=0&&n<this.gridRightBoundary&&h>=0&&s<this.gridBottomBoundary},cn.prototype.getViewportMatrix=function(){var n=a.identity([]);return a.translate(n,n,[-100,-100,0]),n};var On=function(n,s,o,h){this.opacity=n?Math.max(0,Math.min(1,n.opacity+(n.placed?s:-s))):h&&o?1:0,this.placed=o};On.prototype.isHidden=function(){return this.opacity===0&&!this.placed};var yn=function(n,s,o,h,_){this.text=new On(n?n.text:null,s,o,_),this.icon=new On(n?n.icon:null,s,h,_)};yn.prototype.isHidden=function(){return this.text.isHidden()&&this.icon.isHidden()};var is=function(n,s,o){this.text=n,this.icon=s,this.skipFade=o},Ai=function(){this.invProjMatrix=a.create(),this.viewportMatrix=a.create(),this.circles=[]},xa=function(n,s,o,h,_){this.bucketInstanceId=n,this.featureIndex=s,this.sourceLayerIndex=o,this.bucketIndex=h,this.tileID=_},ji=function(n){this.crossSourceCollisions=n,this.maxGroupID=0,this.collisionGroups={}};function zi(n,s,o,h,_){var w=a.getAnchorAlignment(n),S=-(w.horizontalAlign-.5)*s,I=-(w.verticalAlign-.5)*o,P=a.evaluateVariableOffset(n,h);return new a.Point(S+P[0]*_,I+P[1]*_)}function Jn(n,s,o,h,_,w){var S=n.x1,I=n.x2,P=n.y1,O=n.y2,G=n.anchorPointX,Z=n.anchorPointY,H=new a.Point(s,o);return h&&H._rotate(_?w:-w),{x1:S+H.x,y1:P+H.y,x2:I+H.x,y2:O+H.y,anchorPointX:G,anchorPointY:Z}}ji.prototype.get=function(n){if(this.crossSourceCollisions)return{ID:0,predicate:null};if(!this.collisionGroups[n]){var s=++this.maxGroupID;this.collisionGroups[n]={ID:s,predicate:function(o){return o.collisionGroupID===s}}}return this.collisionGroups[n]};var Gi=function(n,s,o,h){this.transform=n.clone(),this.collisionIndex=new cn(this.transform),this.placements={},this.opacities={},this.variableOffsets={},this.stale=!1,this.commitTime=0,this.fadeDuration=s,this.retainedQueryData={},this.collisionGroups=new ji(o),this.collisionCircleArrays={},this.prevPlacement=h,h&&(h.prevPlacement=void 0),this.placedOrientations={}};function wa(n,s,o,h,_){n.emplaceBack(s?1:0,o?1:0,h||0,_||0),n.emplaceBack(s?1:0,o?1:0,h||0,_||0),n.emplaceBack(s?1:0,o?1:0,h||0,_||0),n.emplaceBack(s?1:0,o?1:0,h||0,_||0)}Gi.prototype.getBucketParts=function(n,s,o,h){var _=o.getBucket(s),w=o.latestFeatureIndex;if(_&&w&&s.id===_.layerIds[0]){var S=o.collisionBoxArray,I=_.layers[0].layout,P=Math.pow(2,this.transform.zoom-o.tileID.overscaledZ),O=o.tileSize/a.EXTENT,G=this.transform.calculatePosMatrix(o.tileID.toUnwrapped()),Z=I.get("text-pitch-alignment")==="map",H=I.get("text-rotation-alignment")==="map",te=Cr(o,1,this.transform.zoom),ee=Fr(G,Z,H,this.transform,te),ce=null;if(Z){var Y=vr(G,Z,H,this.transform,te);ce=a.multiply([],this.transform.labelPlaneMatrix,Y)}this.retainedQueryData[_.bucketInstanceId]=new xa(_.bucketInstanceId,w,_.sourceLayerIndex,_.index,o.tileID);var ue={bucket:_,layout:I,posMatrix:G,textLabelPlaneMatrix:ee,labelToScreenMatrix:ce,scale:P,textPixelRatio:O,holdingForFade:o.holdingForFade(),collisionBoxArray:S,partiallyEvaluatedTextSize:a.evaluateSizeForZoom(_.textSizeData,this.transform.zoom),collisionGroup:this.collisionGroups.get(_.sourceID)};if(h)for(var de=0,be=_.sortKeyRanges;de<be.length;de+=1){var Ae=be[de];n.push({sortKey:Ae.sortKey,symbolInstanceStart:Ae.symbolInstanceStart,symbolInstanceEnd:Ae.symbolInstanceEnd,parameters:ue})}else n.push({symbolInstanceStart:0,symbolInstanceEnd:_.symbolInstances.length,parameters:ue})}},Gi.prototype.attemptAnchorPlacement=function(n,s,o,h,_,w,S,I,P,O,G,Z,H,te,ee){var ce,Y=[Z.textOffset0,Z.textOffset1],ue=zi(n,o,h,Y,_),de=this.collisionIndex.placeCollisionBox(Jn(s,ue.x,ue.y,w,S,this.transform.angle),G,I,P,O.predicate);if(!ee||this.collisionIndex.placeCollisionBox(Jn(ee,ue.x,ue.y,w,S,this.transform.angle),G,I,P,O.predicate).box.length!==0)return de.box.length>0?(this.prevPlacement&&this.prevPlacement.variableOffsets[Z.crossTileID]&&this.prevPlacement.placements[Z.crossTileID]&&this.prevPlacement.placements[Z.crossTileID].text&&(ce=this.prevPlacement.variableOffsets[Z.crossTileID].anchor),this.variableOffsets[Z.crossTileID]={textOffset:Y,width:o,height:h,anchor:n,textBoxScale:_,prevAnchor:ce},this.markUsedJustification(H,n,Z,te),H.allowVerticalPlacement&&(this.markUsedOrientation(H,te,Z),this.placedOrientations[Z.crossTileID]=te),{shift:ue,placedGlyphBoxes:de}):void 0},Gi.prototype.placeLayerBucketPart=function(n,s,o){var h=this,_=n.parameters,w=_.bucket,S=_.layout,I=_.posMatrix,P=_.textLabelPlaneMatrix,O=_.labelToScreenMatrix,G=_.textPixelRatio,Z=_.holdingForFade,H=_.collisionBoxArray,te=_.partiallyEvaluatedTextSize,ee=_.collisionGroup,ce=S.get("text-optional"),Y=S.get("icon-optional"),ue=S.get("text-allow-overlap"),de=S.get("icon-allow-overlap"),be=S.get("text-rotation-alignment")==="map",Ae=S.get("text-pitch-alignment")==="map",Ee=S.get("icon-text-fit")!=="none",ze=S.get("symbol-z-order")==="viewport-y",Ve=ue&&(de||!w.hasIconData()||Y),Qe=de&&(ue||!w.hasTextData()||ce);!w.collisionArrays&&H&&w.deserializeCollisionBoxes(H);var We=function(dt,qt){if(!s[dt.crossTileID])if(Z)h.placements[dt.crossTileID]=new is(!1,!1,!1);else{var Jt,Vt=!1,Nt=!1,Wt=!0,Ot=null,Rt={box:null,offscreen:null},Oi={box:null,offscreen:null},si=null,pn=null,Hi=0,ri=0,di=0;qt.textFeatureIndex?Hi=qt.textFeatureIndex:dt.useRuntimeCollisionCircles&&(Hi=dt.featureIndex),qt.verticalTextFeatureIndex&&(ri=qt.verticalTextFeatureIndex);var Zn=qt.textBox;if(Zn){var vn=function(kr){var ea=a.WritingMode.horizontal;if(w.allowVerticalPlacement&&!kr&&h.prevPlacement){var Mn=h.prevPlacement.placedOrientations[dt.crossTileID];Mn&&(h.placedOrientations[dt.crossTileID]=Mn,h.markUsedOrientation(w,ea=Mn,dt))}return ea},Qa=function(kr,ea){if(w.allowVerticalPlacement&&dt.numVerticalGlyphVertices>0&&qt.verticalTextBox)for(var Mn=0,Ao=w.writingModes;Mn<Ao.length&&(Ao[Mn]===a.WritingMode.vertical?(Rt=ea(),Oi=Rt):Rt=kr(),!(Rt&&Rt.box&&Rt.box.length));Mn+=1);else Rt=kr()};if(S.get("text-variable-anchor")){var Cn=S.get("text-variable-anchor");if(h.prevPlacement&&h.prevPlacement.variableOffsets[dt.crossTileID]){var _a=h.prevPlacement.variableOffsets[dt.crossTileID];Cn.indexOf(_a.anchor)>0&&(Cn=Cn.filter(function(kr){return kr!==_a.anchor})).unshift(_a.anchor)}var oa=function(kr,ea,Mn){for(var Ao=kr.x2-kr.x1,Xh=kr.y2-kr.y1,il=dt.textBoxScale,Wh=Ee&&!de?ea:null,Es={box:[],offscreen:!1},Ic=ue?2*Cn.length:Cn.length,Wo=0;Wo<Ic;++Wo){var nl=h.attemptAnchorPlacement(Cn[Wo%Cn.length],kr,Ao,Xh,il,be,Ae,G,I,ee,Wo>=Cn.length,dt,w,Mn,Wh);if(nl&&(Es=nl.placedGlyphBoxes)&&Es.box&&Es.box.length){Vt=!0,Ot=nl.shift;break}}return Es};Qa(function(){return oa(Zn,qt.iconBox,a.WritingMode.horizontal)},function(){var kr=qt.verticalTextBox;return w.allowVerticalPlacement&&!(Rt&&Rt.box&&Rt.box.length)&&dt.numVerticalGlyphVertices>0&&kr?oa(kr,qt.verticalIconBox,a.WritingMode.vertical):{box:null,offscreen:null}}),Rt&&(Vt=Rt.box,Wt=Rt.offscreen);var ws=vn(Rt&&Rt.box);if(!Vt&&h.prevPlacement){var Ho=h.prevPlacement.variableOffsets[dt.crossTileID];Ho&&(h.variableOffsets[dt.crossTileID]=Ho,h.markUsedJustification(w,Ho.anchor,dt,ws))}}else{var $a=function(kr,ea){var Mn=h.collisionIndex.placeCollisionBox(kr,ue,G,I,ee.predicate);return Mn&&Mn.box&&Mn.box.length&&(h.markUsedOrientation(w,ea,dt),h.placedOrientations[dt.crossTileID]=ea),Mn};Qa(function(){return $a(Zn,a.WritingMode.horizontal)},function(){var kr=qt.verticalTextBox;return w.allowVerticalPlacement&&dt.numVerticalGlyphVertices>0&&kr?$a(kr,a.WritingMode.vertical):{box:null,offscreen:null}}),vn(Rt&&Rt.box&&Rt.box.length)}}if(Vt=(Jt=Rt)&&Jt.box&&Jt.box.length>0,Wt=Jt&&Jt.offscreen,dt.useRuntimeCollisionCircles){var Xo=w.text.placedSymbolArray.get(dt.centerJustifiedTextSymbolIndex),Ss=a.evaluateSizeForFeature(w.textSizeData,te,Xo),Aa=S.get("text-padding");si=h.collisionIndex.placeCollisionCircles(ue,Xo,w.lineVertexArray,w.glyphOffsetArray,Ss,I,P,O,o,Ae,ee.predicate,dt.collisionCircleDiameter,Aa),Vt=ue||si.circles.length>0&&!si.collisionDetected,Wt=Wt&&si.offscreen}if(qt.iconFeatureIndex&&(di=qt.iconFeatureIndex),qt.iconBox){var ks=function(kr){var ea=Ee&&Ot?Jn(kr,Ot.x,Ot.y,be,Ae,h.transform.angle):kr;return h.collisionIndex.placeCollisionBox(ea,de,G,I,ee.predicate)};Nt=Oi&&Oi.box&&Oi.box.length&&qt.verticalIconBox?(pn=ks(qt.verticalIconBox)).box.length>0:(pn=ks(qt.iconBox)).box.length>0,Wt=Wt&&pn.offscreen}var za=ce||dt.numHorizontalGlyphVertices===0&&dt.numVerticalGlyphVertices===0,Fi=Y||dt.numIconVertices===0;if(za||Fi?Fi?za||(Nt=Nt&&Vt):Vt=Nt&&Vt:Nt=Vt=Nt&&Vt,Vt&&Jt&&Jt.box&&h.collisionIndex.insertCollisionBox(Jt.box,S.get("text-ignore-placement"),w.bucketInstanceId,Oi&&Oi.box&&ri?ri:Hi,ee.ID),Nt&&pn&&h.collisionIndex.insertCollisionBox(pn.box,S.get("icon-ignore-placement"),w.bucketInstanceId,di,ee.ID),si&&(Vt&&h.collisionIndex.insertCollisionCircles(si.circles,S.get("text-ignore-placement"),w.bucketInstanceId,Hi,ee.ID),o)){var La=w.bucketInstanceId,eo=h.collisionCircleArrays[La];eo===void 0&&(eo=h.collisionCircleArrays[La]=new Ai);for(var Io=0;Io<si.circles.length;Io+=4)eo.circles.push(si.circles[Io+0]),eo.circles.push(si.circles[Io+1]),eo.circles.push(si.circles[Io+2]),eo.circles.push(si.collisionDetected?1:0)}h.placements[dt.crossTileID]=new is(Vt||Ve,Nt||Qe,Wt||w.justReloaded),s[dt.crossTileID]=!0}};if(ze)for(var ft=w.getSortedSymbolIndexes(this.transform.angle),Tt=ft.length-1;Tt>=0;--Tt){var Dt=ft[Tt];We(w.symbolInstances.get(Dt),w.collisionArrays[Dt])}else for(var Mt=n.symbolInstanceStart;Mt<n.symbolInstanceEnd;Mt++)We(w.symbolInstances.get(Mt),w.collisionArrays[Mt]);if(o&&w.bucketInstanceId in this.collisionCircleArrays){var gr=this.collisionCircleArrays[w.bucketInstanceId];a.invert(gr.invProjMatrix,I),gr.viewportMatrix=this.collisionIndex.getViewportMatrix()}w.justReloaded=!1},Gi.prototype.markUsedJustification=function(n,s,o,h){var _;_=h===a.WritingMode.vertical?o.verticalPlacedTextSymbolIndex:{left:o.leftJustifiedTextSymbolIndex,center:o.centerJustifiedTextSymbolIndex,right:o.rightJustifiedTextSymbolIndex}[a.getAnchorJustification(s)];for(var w=0,S=[o.leftJustifiedTextSymbolIndex,o.centerJustifiedTextSymbolIndex,o.rightJustifiedTextSymbolIndex,o.verticalPlacedTextSymbolIndex];w<S.length;w+=1){var I=S[w];I>=0&&(n.text.placedSymbolArray.get(I).crossTileID=_>=0&&I!==_?0:o.crossTileID)}},Gi.prototype.markUsedOrientation=function(n,s,o){for(var h=s===a.WritingMode.horizontal||s===a.WritingMode.horizontalOnly?s:0,_=s===a.WritingMode.vertical?s:0,w=0,S=[o.leftJustifiedTextSymbolIndex,o.centerJustifiedTextSymbolIndex,o.rightJustifiedTextSymbolIndex];w<S.length;w+=1)n.text.placedSymbolArray.get(S[w]).placedOrientation=h;o.verticalPlacedTextSymbolIndex&&(n.text.placedSymbolArray.get(o.verticalPlacedTextSymbolIndex).placedOrientation=_)},Gi.prototype.commit=function(n){this.commitTime=n,this.zoomAtLastRecencyCheck=this.transform.zoom;var s=this.prevPlacement,o=!1;this.prevZoomAdjustment=s?s.zoomAdjustment(this.transform.zoom):0;var h=s?s.symbolFadeChange(n):1,_=s?s.opacities:{},w=s?s.variableOffsets:{},S=s?s.placedOrientations:{};for(var I in this.placements){var P=this.placements[I],O=_[I];O?(this.opacities[I]=new yn(O,h,P.text,P.icon),o=o||P.text!==O.text.placed||P.icon!==O.icon.placed):(this.opacities[I]=new yn(null,h,P.text,P.icon,P.skipFade),o=o||P.text||P.icon)}for(var G in _){var Z=_[G];if(!this.opacities[G]){var H=new yn(Z,h,!1,!1);H.isHidden()||(this.opacities[G]=H,o=o||Z.text.placed||Z.icon.placed)}}for(var te in w)this.variableOffsets[te]||!this.opacities[te]||this.opacities[te].isHidden()||(this.variableOffsets[te]=w[te]);for(var ee in S)this.placedOrientations[ee]||!this.opacities[ee]||this.opacities[ee].isHidden()||(this.placedOrientations[ee]=S[ee]);o?this.lastPlacementChangeTime=n:typeof this.lastPlacementChangeTime!="number"&&(this.lastPlacementChangeTime=s?s.lastPlacementChangeTime:n)},Gi.prototype.updateLayerOpacities=function(n,s){for(var o={},h=0,_=s;h<_.length;h+=1){var w=_[h],S=w.getBucket(n);S&&w.latestFeatureIndex&&n.id===S.layerIds[0]&&this.updateBucketOpacities(S,o,w.collisionBoxArray)}},Gi.prototype.updateBucketOpacities=function(n,s,o){var h=this;n.hasTextData()&&n.text.opacityVertexArray.clear(),n.hasIconData()&&n.icon.opacityVertexArray.clear(),n.hasIconCollisionBoxData()&&n.iconCollisionBox.collisionVertexArray.clear(),n.hasTextCollisionBoxData()&&n.textCollisionBox.collisionVertexArray.clear();var _=n.layers[0].layout,w=new yn(null,0,!1,!1,!0),S=_.get("text-allow-overlap"),I=_.get("icon-allow-overlap"),P=_.get("text-variable-anchor"),O=_.get("text-rotation-alignment")==="map",G=_.get("text-pitch-alignment")==="map",Z=_.get("icon-text-fit")!=="none",H=new yn(null,0,S&&(I||!n.hasIconData()||_.get("icon-optional")),I&&(S||!n.hasTextData()||_.get("text-optional")),!0);!n.collisionArrays&&o&&(n.hasIconCollisionBoxData()||n.hasTextCollisionBoxData())&&n.deserializeCollisionBoxes(o);for(var te=function(ue,de,be){for(var Ae=0;Ae<de/4;Ae++)ue.opacityVertexArray.emplaceBack(be)},ee=function(ue){var de=n.symbolInstances.get(ue),be=de.numHorizontalGlyphVertices,Ae=de.numVerticalGlyphVertices,Ee=de.crossTileID,ze=h.opacities[Ee];s[Ee]?ze=w:ze||(h.opacities[Ee]=ze=H),s[Ee]=!0;var Ve=de.numIconVertices>0,Qe=h.placedOrientations[de.crossTileID],We=Qe===a.WritingMode.vertical,ft=Qe===a.WritingMode.horizontal||Qe===a.WritingMode.horizontalOnly;if(be>0||Ae>0){var Tt=Os(ze.text);te(n.text,be,We?Va:Tt),te(n.text,Ae,ft?Va:Tt);var Dt=ze.text.isHidden();[de.rightJustifiedTextSymbolIndex,de.centerJustifiedTextSymbolIndex,de.leftJustifiedTextSymbolIndex].forEach(function(Rt){Rt>=0&&(n.text.placedSymbolArray.get(Rt).hidden=Dt||We?1:0)}),de.verticalPlacedTextSymbolIndex>=0&&(n.text.placedSymbolArray.get(de.verticalPlacedTextSymbolIndex).hidden=Dt||ft?1:0);var Mt=h.variableOffsets[de.crossTileID];Mt&&h.markUsedJustification(n,Mt.anchor,de,Qe);var gr=h.placedOrientations[de.crossTileID];gr&&(h.markUsedJustification(n,"left",de,gr),h.markUsedOrientation(n,gr,de))}if(Ve){var dt=Os(ze.icon),qt=!(Z&&de.verticalPlacedIconSymbolIndex&&We);de.placedIconSymbolIndex>=0&&(te(n.icon,de.numIconVertices,qt?dt:Va),n.icon.placedSymbolArray.get(de.placedIconSymbolIndex).hidden=ze.icon.isHidden()),de.verticalPlacedIconSymbolIndex>=0&&(te(n.icon,de.numVerticalIconVertices,qt?Va:dt),n.icon.placedSymbolArray.get(de.verticalPlacedIconSymbolIndex).hidden=ze.icon.isHidden())}if(n.hasIconCollisionBoxData()||n.hasTextCollisionBoxData()){var Jt=n.collisionArrays[ue];if(Jt){var Vt=new a.Point(0,0);if(Jt.textBox||Jt.verticalTextBox){var Nt=!0;if(P){var Wt=h.variableOffsets[Ee];Wt?(Vt=zi(Wt.anchor,Wt.width,Wt.height,Wt.textOffset,Wt.textBoxScale),O&&Vt._rotate(G?h.transform.angle:-h.transform.angle)):Nt=!1}Jt.textBox&&wa(n.textCollisionBox.collisionVertexArray,ze.text.placed,!Nt||We,Vt.x,Vt.y),Jt.verticalTextBox&&wa(n.textCollisionBox.collisionVertexArray,ze.text.placed,!Nt||ft,Vt.x,Vt.y)}var Ot=!!(!ft&&Jt.verticalIconBox);Jt.iconBox&&wa(n.iconCollisionBox.collisionVertexArray,ze.icon.placed,Ot,Z?Vt.x:0,Z?Vt.y:0),Jt.verticalIconBox&&wa(n.iconCollisionBox.collisionVertexArray,ze.icon.placed,!Ot,Z?Vt.x:0,Z?Vt.y:0)}}},ce=0;ce<n.symbolInstances.length;ce++)ee(ce);if(n.sortFeatures(this.transform.angle),this.retainedQueryData[n.bucketInstanceId]&&(this.retainedQueryData[n.bucketInstanceId].featureSortOrder=n.featureSortOrder),n.hasTextData()&&n.text.opacityVertexBuffer&&n.text.opacityVertexBuffer.updateData(n.text.opacityVertexArray),n.hasIconData()&&n.icon.opacityVertexBuffer&&n.icon.opacityVertexBuffer.updateData(n.icon.opacityVertexArray),n.hasIconCollisionBoxData()&&n.iconCollisionBox.collisionVertexBuffer&&n.iconCollisionBox.collisionVertexBuffer.updateData(n.iconCollisionBox.collisionVertexArray),n.hasTextCollisionBoxData()&&n.textCollisionBox.collisionVertexBuffer&&n.textCollisionBox.collisionVertexBuffer.updateData(n.textCollisionBox.collisionVertexArray),n.bucketInstanceId in this.collisionCircleArrays){var Y=this.collisionCircleArrays[n.bucketInstanceId];n.placementInvProjMatrix=Y.invProjMatrix,n.placementViewportMatrix=Y.viewportMatrix,n.collisionCircleArray=Y.circles,delete this.collisionCircleArrays[n.bucketInstanceId]}},Gi.prototype.symbolFadeChange=function(n){return this.fadeDuration===0?1:(n-this.commitTime)/this.fadeDuration+this.prevZoomAdjustment},Gi.prototype.zoomAdjustment=function(n){return Math.max(0,(this.transform.zoom-n)/1.5)},Gi.prototype.hasTransitions=function(n){return this.stale||n-this.lastPlacementChangeTime<this.fadeDuration},Gi.prototype.stillRecent=function(n,s){var o=this.zoomAtLastRecencyCheck===s?1-this.zoomAdjustment(s):1;return this.zoomAtLastRecencyCheck=s,this.commitTime+this.fadeDuration*o>n},Gi.prototype.setStale=function(){this.stale=!0};var ns=Math.pow(2,25),Fl=Math.pow(2,24),uo=Math.pow(2,17),Nl=Math.pow(2,16),Ro=Math.pow(2,9),Vl=Math.pow(2,8),Bo=Math.pow(2,1);function Os(n){if(n.opacity===0&&!n.placed)return 0;if(n.opacity===1&&n.placed)return 4294967295;var s=n.placed?1:0,o=Math.floor(127*n.opacity);return o*ns+s*Fl+o*uo+s*Nl+o*Ro+s*Vl+o*Bo+s}var Va=0,as=function(n){this._sortAcrossTiles=n.layout.get("symbol-z-order")!=="viewport-y"&&n.layout.get("symbol-sort-key").constantOr(1)!==void 0,this._currentTileIndex=0,this._currentPartIndex=0,this._seenCrossTileIDs={},this._bucketParts=[]};as.prototype.continuePlacement=function(n,s,o,h,_){for(var w=this._bucketParts;this._currentTileIndex<n.length;)if(s.getBucketParts(w,h,n[this._currentTileIndex],this._sortAcrossTiles),this._currentTileIndex++,_())return!0;for(this._sortAcrossTiles&&(this._sortAcrossTiles=!1,w.sort(function(S,I){return S.sortKey-I.sortKey}));this._currentPartIndex<w.length;)if(s.placeLayerBucketPart(w[this._currentPartIndex],this._seenCrossTileIDs,o),this._currentPartIndex++,_())return!0;return!1};var co=function(n,s,o,h,_,w,S){this.placement=new Gi(n,_,w,S),this._currentPlacementIndex=s.length-1,this._forceFullPlacement=o,this._showCollisionBoxes=h,this._done=!1};co.prototype.isDone=function(){return this._done},co.prototype.continuePlacement=function(n,s,o){for(var h=this,_=a.browser.now(),w=function(){var P=a.browser.now()-_;return!h._forceFullPlacement&&P>2};this._currentPlacementIndex>=0;){var S=s[n[this._currentPlacementIndex]],I=this.placement.collisionIndex.transform.zoom;if(S.type==="symbol"&&(!S.minzoom||S.minzoom<=I)&&(!S.maxzoom||S.maxzoom>I)){if(this._inProgressLayer||(this._inProgressLayer=new as(S)),this._inProgressLayer.continuePlacement(o[S.source],this.placement,this._showCollisionBoxes,S,w))return;delete this._inProgressLayer}this._currentPlacementIndex--}this._done=!0},co.prototype.commit=function(n){return this.placement.commit(n),this.placement};var Fs=512/a.EXTENT/2,Ua=function(n,s,o){this.tileID=n,this.indexedSymbolInstances={},this.bucketInstanceId=o;for(var h=0;h<s.length;h++){var _=s.get(h),w=_.key;this.indexedSymbolInstances[w]||(this.indexedSymbolInstances[w]=[]),this.indexedSymbolInstances[w].push({crossTileID:_.crossTileID,coord:this.getScaledCoordinates(_,n)})}};Ua.prototype.getScaledCoordinates=function(n,s){var o=Fs/Math.pow(2,s.canonical.z-this.tileID.canonical.z);return{x:Math.floor((s.canonical.x*a.EXTENT+n.anchorX)*o),y:Math.floor((s.canonical.y*a.EXTENT+n.anchorY)*o)}},Ua.prototype.findMatches=function(n,s,o){for(var h=this.tileID.canonical.z<s.canonical.z?1:Math.pow(2,this.tileID.canonical.z-s.canonical.z),_=0;_<n.length;_++){var w=n.get(_);if(!w.crossTileID){var S=this.indexedSymbolInstances[w.key];if(S)for(var I=this.getScaledCoordinates(w,s),P=0,O=S;P<O.length;P+=1){var G=O[P];if(Math.abs(G.coord.x-I.x)<=h&&Math.abs(G.coord.y-I.y)<=h&&!o[G.crossTileID]){o[G.crossTileID]=!0,w.crossTileID=G.crossTileID;break}}}}};var Fn=function(){this.maxCrossTileID=0};Fn.prototype.generate=function(){return++this.maxCrossTileID};var Sa=function(){this.indexes={},this.usedCrossTileIDs={},this.lng=0};Sa.prototype.handleWrapJump=function(n){var s=Math.round((n-this.lng)/360);if(s!==0)for(var o in this.indexes){var h=this.indexes[o],_={};for(var w in h){var S=h[w];S.tileID=S.tileID.unwrapTo(S.tileID.wrap+s),_[S.tileID.key]=S}this.indexes[o]=_}this.lng=n},Sa.prototype.addBucket=function(n,s,o){if(this.indexes[n.overscaledZ]&&this.indexes[n.overscaledZ][n.key]){if(this.indexes[n.overscaledZ][n.key].bucketInstanceId===s.bucketInstanceId)return!1;this.removeBucketCrossTileIDs(n.overscaledZ,this.indexes[n.overscaledZ][n.key])}for(var h=0;h<s.symbolInstances.length;h++)s.symbolInstances.get(h).crossTileID=0;this.usedCrossTileIDs[n.overscaledZ]||(this.usedCrossTileIDs[n.overscaledZ]={});var _=this.usedCrossTileIDs[n.overscaledZ];for(var w in this.indexes){var S=this.indexes[w];if(Number(w)>n.overscaledZ)for(var I in S){var P=S[I];P.tileID.isChildOf(n)&&P.findMatches(s.symbolInstances,n,_)}else{var O=S[n.scaledTo(Number(w)).key];O&&O.findMatches(s.symbolInstances,n,_)}}for(var G=0;G<s.symbolInstances.length;G++){var Z=s.symbolInstances.get(G);Z.crossTileID||(Z.crossTileID=o.generate(),_[Z.crossTileID]=!0)}return this.indexes[n.overscaledZ]===void 0&&(this.indexes[n.overscaledZ]={}),this.indexes[n.overscaledZ][n.key]=new Ua(n,s.symbolInstances,s.bucketInstanceId),!0},Sa.prototype.removeBucketCrossTileIDs=function(n,s){for(var o in s.indexedSymbolInstances)for(var h=0,_=s.indexedSymbolInstances[o];h<_.length;h+=1)delete this.usedCrossTileIDs[n][_[h].crossTileID]},Sa.prototype.removeStaleBuckets=function(n){var s=!1;for(var o in this.indexes){var h=this.indexes[o];for(var _ in h)n[h[_].bucketInstanceId]||(this.removeBucketCrossTileIDs(o,h[_]),delete h[_],s=!0)}return s};var ve=function(){this.layerIndexes={},this.crossTileIDs=new Fn,this.maxBucketInstanceId=0,this.bucketsInCurrentPlacement={}};ve.prototype.addLayer=function(n,s,o){var h=this.layerIndexes[n.id];h===void 0&&(h=this.layerIndexes[n.id]=new Sa);var _=!1,w={};h.handleWrapJump(o);for(var S=0,I=s;S<I.length;S+=1){var P=I[S],O=P.getBucket(n);O&&n.id===O.layerIds[0]&&(O.bucketInstanceId||(O.bucketInstanceId=++this.maxBucketInstanceId),h.addBucket(P.tileID,O,this.crossTileIDs)&&(_=!0),w[O.bucketInstanceId]=!0)}return h.removeStaleBuckets(w)&&(_=!0),_},ve.prototype.pruneUnusedLayers=function(n){var s={};for(var o in n.forEach(function(h){s[h]=!0}),this.layerIndexes)s[o]||delete this.layerIndexes[o]};var hn=function(n,s){return a.emitValidationErrors(n,s&&s.filter(function(o){return o.identifier!=="source.canvas"}))},Zi=a.pick(He,["addLayer","removeLayer","setPaintProperty","setLayoutProperty","setFilter","addSource","removeSource","setLayerZoomRange","setLight","setTransition","setGeoJSONSourceData"]),Gr=a.pick(He,["setCenter","setZoom","setBearing","setPitch"]),ka=function(){var n={},s=a.styleSpec.$version;for(var o in a.styleSpec.$root){var h,_=a.styleSpec.$root[o];_.required&&(h=o==="version"?s:_.type==="array"?[]:{})!=null&&(n[o]=h)}return n}(),Nn=function(n){function s(o,h){var _=this;h===void 0&&(h={}),n.call(this),this.map=o,this.dispatcher=new Ft(Ie(),this),this.imageManager=new _e,this.imageManager.setEventedParent(this),this.glyphManager=new Ge(o._requestManager,h.localIdeographFontFamily),this.lineAtlas=new je(256,512),this.crossTileSymbolIndex=new ve,this._layers={},this._serializedLayers={},this._order=[],this.sourceCaches={},this.zoomHistory=new a.ZoomHistory,this._loaded=!1,this._availableImages=[],this._resetUpdates(),this.dispatcher.broadcast("setReferrer",a.getReferrer());var w=this;this._rtlTextPluginCallback=s.registerForPluginStateChange(function(S){w.dispatcher.broadcast("syncRTLPluginState",{pluginStatus:S.pluginStatus,pluginURL:S.pluginURL},function(I,P){if(a.triggerPluginCompletionEvent(I),P&&P.every(function(G){return G}))for(var O in w.sourceCaches)w.sourceCaches[O].reload()})}),this.on("data",function(S){if(S.dataType==="source"&&S.sourceDataType==="metadata"){var I=_.sourceCaches[S.sourceId];if(I){var P=I.getSource();if(P&&P.vectorLayerIds)for(var O in _._layers){var G=_._layers[O];G.source===P.id&&_._validateLayer(G)}}}})}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype.loadURL=function(o,h){var _=this;h===void 0&&(h={}),this.fire(new a.Event("dataloading",{dataType:"style"}));var w=typeof h.validate=="boolean"?h.validate:!a.isMapboxURL(o);o=this.map._requestManager.normalizeStyleURL(o,h.accessToken);var S=this.map._requestManager.transformRequest(o,a.ResourceType.Style);this._request=a.getJSON(S,function(I,P){_._request=null,I?_.fire(new a.ErrorEvent(I)):P&&_._load(P,w)})},s.prototype.loadJSON=function(o,h){var _=this;h===void 0&&(h={}),this.fire(new a.Event("dataloading",{dataType:"style"})),this._request=a.browser.frame(function(){_._request=null,_._load(o,h.validate!==!1)})},s.prototype.loadEmpty=function(){this.fire(new a.Event("dataloading",{dataType:"style"})),this._load(ka,!1)},s.prototype._load=function(o,h){if(!h||!hn(this,a.validateStyle(o))){for(var _ in this._loaded=!0,this.stylesheet=o,o.sources)this.addSource(_,o.sources[_],{validate:!1});o.sprite?this._loadSprite(o.sprite):this.imageManager.setLoaded(!0),this.glyphManager.setURL(o.glyphs);var w=Je(this.stylesheet.layers);this._order=w.map(function(O){return O.id}),this._layers={},this._serializedLayers={};for(var S=0,I=w;S<I.length;S+=1){var P=I[S];(P=a.createStyleLayer(P)).setEventedParent(this,{layer:{id:P.id}}),this._layers[P.id]=P,this._serializedLayers[P.id]=P.serialize()}this.dispatcher.broadcast("setLayers",this._serializeLayers(this._order)),this.light=new ur(this.stylesheet.light),this.fire(new a.Event("data",{dataType:"style"})),this.fire(new a.Event("style.load"))}},s.prototype._loadSprite=function(o){var h=this;this._spriteRequest=function(_,w,S){var I,P,O,G=a.browser.devicePixelRatio>1?"@2x":"",Z=a.getJSON(w.transformRequest(w.normalizeSpriteURL(_,G,".json"),a.ResourceType.SpriteJSON),function(ee,ce){Z=null,O||(O=ee,I=ce,te())}),H=a.getImage(w.transformRequest(w.normalizeSpriteURL(_,G,".png"),a.ResourceType.SpriteImage),function(ee,ce){H=null,O||(O=ee,P=ce,te())});function te(){if(O)S(O);else if(I&&P){var ee=a.browser.getImageData(P),ce={};for(var Y in I){var ue=I[Y],de=ue.width,be=ue.height,Ae=ue.x,Ee=ue.y,ze=ue.sdf,Ve=ue.pixelRatio,Qe=ue.stretchX,We=ue.stretchY,ft=ue.content,Tt=new a.RGBAImage({width:de,height:be});a.RGBAImage.copy(ee,Tt,{x:Ae,y:Ee},{x:0,y:0},{width:de,height:be}),ce[Y]={data:Tt,pixelRatio:Ve,sdf:ze,stretchX:Qe,stretchY:We,content:ft}}S(null,ce)}}return{cancel:function(){Z&&(Z.cancel(),Z=null),H&&(H.cancel(),H=null)}}}(o,this.map._requestManager,function(_,w){if(h._spriteRequest=null,_)h.fire(new a.ErrorEvent(_));else if(w)for(var S in w)h.imageManager.addImage(S,w[S]);h.imageManager.setLoaded(!0),h._availableImages=h.imageManager.listImages(),h.dispatcher.broadcast("setImages",h._availableImages),h.fire(new a.Event("data",{dataType:"style"}))})},s.prototype._validateLayer=function(o){var h=this.sourceCaches[o.source];if(h){var _=o.sourceLayer;if(_){var w=h.getSource();(w.type==="geojson"||w.vectorLayerIds&&w.vectorLayerIds.indexOf(_)===-1)&&this.fire(new a.ErrorEvent(new Error('Source layer "'+_+'" does not exist on source "'+w.id+'" as specified by style layer "'+o.id+'"')))}}},s.prototype.loaded=function(){if(!this._loaded||Object.keys(this._updatedSources).length)return!1;for(var o in this.sourceCaches)if(!this.sourceCaches[o].loaded())return!1;return!!this.imageManager.isLoaded()},s.prototype._serializeLayers=function(o){for(var h=[],_=0,w=o;_<w.length;_+=1){var S=this._layers[w[_]];S.type!=="custom"&&h.push(S.serialize())}return h},s.prototype.hasTransitions=function(){if(this.light&&this.light.hasTransition())return!0;for(var o in this.sourceCaches)if(this.sourceCaches[o].hasTransition())return!0;for(var h in this._layers)if(this._layers[h].hasTransition())return!0;return!1},s.prototype._checkLoaded=function(){if(!this._loaded)throw new Error("Style is not done loading")},s.prototype.update=function(o){if(this._loaded){var h=this._changed;if(this._changed){var _=Object.keys(this._updatedLayers),w=Object.keys(this._removedLayers);for(var S in(_.length||w.length)&&this._updateWorkerLayers(_,w),this._updatedSources){var I=this._updatedSources[S];I==="reload"?this._reloadSource(S):I==="clear"&&this._clearSource(S)}for(var P in this._updateTilesForChangedImages(),this._updatedPaintProps)this._layers[P].updateTransitions(o);this.light.updateTransitions(o),this._resetUpdates()}var O={};for(var G in this.sourceCaches){var Z=this.sourceCaches[G];O[G]=Z.used,Z.used=!1}for(var H=0,te=this._order;H<te.length;H+=1){var ee=this._layers[te[H]];ee.recalculate(o,this._availableImages),!ee.isHidden(o.zoom)&&ee.source&&(this.sourceCaches[ee.source].used=!0)}for(var ce in O){var Y=this.sourceCaches[ce];O[ce]!==Y.used&&Y.fire(new a.Event("data",{sourceDataType:"visibility",dataType:"source",sourceId:ce}))}this.light.recalculate(o),this.z=o.zoom,h&&this.fire(new a.Event("data",{dataType:"style"}))}},s.prototype._updateTilesForChangedImages=function(){var o=Object.keys(this._changedImages);if(o.length){for(var h in this.sourceCaches)this.sourceCaches[h].reloadTilesForDependencies(["icons","patterns"],o);this._changedImages={}}},s.prototype._updateWorkerLayers=function(o,h){this.dispatcher.broadcast("updateLayers",{layers:this._serializeLayers(o),removedIds:h})},s.prototype._resetUpdates=function(){this._changed=!1,this._updatedLayers={},this._removedLayers={},this._updatedSources={},this._updatedPaintProps={},this._changedImages={}},s.prototype.setState=function(o){var h=this;if(this._checkLoaded(),hn(this,a.validateStyle(o)))return!1;(o=a.clone$1(o)).layers=Je(o.layers);var _=function(S,I){if(!S)return[{command:He.setStyle,args:[I]}];var P=[];try{if(!a.deepEqual(S.version,I.version))return[{command:He.setStyle,args:[I]}];a.deepEqual(S.center,I.center)||P.push({command:He.setCenter,args:[I.center]}),a.deepEqual(S.zoom,I.zoom)||P.push({command:He.setZoom,args:[I.zoom]}),a.deepEqual(S.bearing,I.bearing)||P.push({command:He.setBearing,args:[I.bearing]}),a.deepEqual(S.pitch,I.pitch)||P.push({command:He.setPitch,args:[I.pitch]}),a.deepEqual(S.sprite,I.sprite)||P.push({command:He.setSprite,args:[I.sprite]}),a.deepEqual(S.glyphs,I.glyphs)||P.push({command:He.setGlyphs,args:[I.glyphs]}),a.deepEqual(S.transition,I.transition)||P.push({command:He.setTransition,args:[I.transition]}),a.deepEqual(S.light,I.light)||P.push({command:He.setLight,args:[I.light]});var O={},G=[];(function(H,te,ee,ce){var Y;for(Y in te=te||{},H=H||{})H.hasOwnProperty(Y)&&(te.hasOwnProperty(Y)||st(Y,ee,ce));for(Y in te)te.hasOwnProperty(Y)&&(H.hasOwnProperty(Y)?a.deepEqual(H[Y],te[Y])||(H[Y].type==="geojson"&&te[Y].type==="geojson"&&br(H,te,Y)?ee.push({command:He.setGeoJSONSourceData,args:[Y,te[Y].data]}):nr(Y,te,ee,ce)):Zt(Y,te,ee))})(S.sources,I.sources,G,O);var Z=[];S.layers&&S.layers.forEach(function(H){O[H.source]?P.push({command:He.removeLayer,args:[H.id]}):Z.push(H)}),P=P.concat(G),function(H,te,ee){te=te||[];var ce,Y,ue,de,be,Ae,Ee,ze=(H=H||[]).map(pr),Ve=te.map(pr),Qe=H.reduce(ar,{}),We=te.reduce(ar,{}),ft=ze.slice(),Tt=Object.create(null);for(ce=0,Y=0;ce<ze.length;ce++)We.hasOwnProperty(ue=ze[ce])?Y++:(ee.push({command:He.removeLayer,args:[ue]}),ft.splice(ft.indexOf(ue,Y),1));for(ce=0,Y=0;ce<Ve.length;ce++)ft[ft.length-1-ce]!==(ue=Ve[Ve.length-1-ce])&&(Qe.hasOwnProperty(ue)?(ee.push({command:He.removeLayer,args:[ue]}),ft.splice(ft.lastIndexOf(ue,ft.length-Y),1)):Y++,ee.push({command:He.addLayer,args:[We[ue],Ae=ft[ft.length-ce]]}),ft.splice(ft.length-ce,0,ue),Tt[ue]=!0);for(ce=0;ce<Ve.length;ce++)if(de=Qe[ue=Ve[ce]],be=We[ue],!Tt[ue]&&!a.deepEqual(de,be))if(a.deepEqual(de.source,be.source)&&a.deepEqual(de["source-layer"],be["source-layer"])&&a.deepEqual(de.type,be.type)){for(Ee in Xt(de.layout,be.layout,ee,ue,null,He.setLayoutProperty),Xt(de.paint,be.paint,ee,ue,null,He.setPaintProperty),a.deepEqual(de.filter,be.filter)||ee.push({command:He.setFilter,args:[ue,be.filter]}),a.deepEqual(de.minzoom,be.minzoom)&&a.deepEqual(de.maxzoom,be.maxzoom)||ee.push({command:He.setLayerZoomRange,args:[ue,be.minzoom,be.maxzoom]}),de)de.hasOwnProperty(Ee)&&Ee!=="layout"&&Ee!=="paint"&&Ee!=="filter"&&Ee!=="metadata"&&Ee!=="minzoom"&&Ee!=="maxzoom"&&(Ee.indexOf("paint.")===0?Xt(de[Ee],be[Ee],ee,ue,Ee.slice(6),He.setPaintProperty):a.deepEqual(de[Ee],be[Ee])||ee.push({command:He.setLayerProperty,args:[ue,Ee,be[Ee]]}));for(Ee in be)be.hasOwnProperty(Ee)&&!de.hasOwnProperty(Ee)&&Ee!=="layout"&&Ee!=="paint"&&Ee!=="filter"&&Ee!=="metadata"&&Ee!=="minzoom"&&Ee!=="maxzoom"&&(Ee.indexOf("paint.")===0?Xt(de[Ee],be[Ee],ee,ue,Ee.slice(6),He.setPaintProperty):a.deepEqual(de[Ee],be[Ee])||ee.push({command:He.setLayerProperty,args:[ue,Ee,be[Ee]]}))}else ee.push({command:He.removeLayer,args:[ue]}),Ae=ft[ft.lastIndexOf(ue)+1],ee.push({command:He.addLayer,args:[be,Ae]})}(Z,I.layers,P)}catch(H){console.warn("Unable to compute style diff:",H),P=[{command:He.setStyle,args:[I]}]}return P}(this.serialize(),o).filter(function(S){return!(S.command in Gr)});if(_.length===0)return!1;var w=_.filter(function(S){return!(S.command in Zi)});if(w.length>0)throw new Error("Unimplemented: "+w.map(function(S){return S.command}).join(", ")+".");return _.forEach(function(S){S.command!=="setTransition"&&h[S.command].apply(h,S.args)}),this.stylesheet=o,!0},s.prototype.addImage=function(o,h){if(this.getImage(o))return this.fire(new a.ErrorEvent(new Error("An image with this name already exists.")));this.imageManager.addImage(o,h),this._afterImageUpdated(o)},s.prototype.updateImage=function(o,h){this.imageManager.updateImage(o,h)},s.prototype.getImage=function(o){return this.imageManager.getImage(o)},s.prototype.removeImage=function(o){if(!this.getImage(o))return this.fire(new a.ErrorEvent(new Error("No image with this name exists.")));this.imageManager.removeImage(o),this._afterImageUpdated(o)},s.prototype._afterImageUpdated=function(o){this._availableImages=this.imageManager.listImages(),this._changedImages[o]=!0,this._changed=!0,this.dispatcher.broadcast("setImages",this._availableImages),this.fire(new a.Event("data",{dataType:"style"}))},s.prototype.listImages=function(){return this._checkLoaded(),this.imageManager.listImages()},s.prototype.addSource=function(o,h,_){var w=this;if(_===void 0&&(_={}),this._checkLoaded(),this.sourceCaches[o]!==void 0)throw new Error("There is already a source with this ID");if(!h.type)throw new Error("The type property must be defined, but only the following properties were given: "+Object.keys(h).join(", ")+".");if(!(["vector","raster","geojson","video","image"].indexOf(h.type)>=0&&this._validate(a.validateStyle.source,"sources."+o,h,null,_))){this.map&&this.map._collectResourceTiming&&(h.collectResourceTiming=!0);var S=this.sourceCaches[o]=new J(o,h,this.dispatcher);S.style=this,S.setEventedParent(this,function(){return{isSourceLoaded:w.loaded(),source:S.serialize(),sourceId:o}}),S.onAdd(this.map),this._changed=!0}},s.prototype.removeSource=function(o){if(this._checkLoaded(),this.sourceCaches[o]===void 0)throw new Error("There is no source with this ID");for(var h in this._layers)if(this._layers[h].source===o)return this.fire(new a.ErrorEvent(new Error('Source "'+o+'" cannot be removed while layer "'+h+'" is using it.')));var _=this.sourceCaches[o];delete this.sourceCaches[o],delete this._updatedSources[o],_.fire(new a.Event("data",{sourceDataType:"metadata",dataType:"source",sourceId:o})),_.setEventedParent(null),_.clearTiles(),_.onRemove&&_.onRemove(this.map),this._changed=!0},s.prototype.setGeoJSONSourceData=function(o,h){this._checkLoaded(),this.sourceCaches[o].getSource().setData(h),this._changed=!0},s.prototype.getSource=function(o){return this.sourceCaches[o]&&this.sourceCaches[o].getSource()},s.prototype.addLayer=function(o,h,_){_===void 0&&(_={}),this._checkLoaded();var w=o.id;if(this.getLayer(w))this.fire(new a.ErrorEvent(new Error('Layer with id "'+w+'" already exists on this map')));else{var S;if(o.type==="custom"){if(hn(this,a.validateCustomStyleLayer(o)))return;S=a.createStyleLayer(o)}else{if(typeof o.source=="object"&&(this.addSource(w,o.source),o=a.clone$1(o),o=a.extend(o,{source:w})),this._validate(a.validateStyle.layer,"layers."+w,o,{arrayIndex:-1},_))return;S=a.createStyleLayer(o),this._validateLayer(S),S.setEventedParent(this,{layer:{id:w}}),this._serializedLayers[S.id]=S.serialize()}var I=h?this._order.indexOf(h):this._order.length;if(h&&I===-1)this.fire(new a.ErrorEvent(new Error('Layer with id "'+h+'" does not exist on this map.')));else{if(this._order.splice(I,0,w),this._layerOrderChanged=!0,this._layers[w]=S,this._removedLayers[w]&&S.source&&S.type!=="custom"){var P=this._removedLayers[w];delete this._removedLayers[w],P.type!==S.type?this._updatedSources[S.source]="clear":(this._updatedSources[S.source]="reload",this.sourceCaches[S.source].pause())}this._updateLayer(S),S.onAdd&&S.onAdd(this.map)}}},s.prototype.moveLayer=function(o,h){if(this._checkLoaded(),this._changed=!0,this._layers[o]){if(o!==h){var _=this._order.indexOf(o);this._order.splice(_,1);var w=h?this._order.indexOf(h):this._order.length;h&&w===-1?this.fire(new a.ErrorEvent(new Error('Layer with id "'+h+'" does not exist on this map.'))):(this._order.splice(w,0,o),this._layerOrderChanged=!0)}}else this.fire(new a.ErrorEvent(new Error("The layer '"+o+"' does not exist in the map's style and cannot be moved.")))},s.prototype.removeLayer=function(o){this._checkLoaded();var h=this._layers[o];if(h){h.setEventedParent(null);var _=this._order.indexOf(o);this._order.splice(_,1),this._layerOrderChanged=!0,this._changed=!0,this._removedLayers[o]=h,delete this._layers[o],delete this._serializedLayers[o],delete this._updatedLayers[o],delete this._updatedPaintProps[o],h.onRemove&&h.onRemove(this.map)}else this.fire(new a.ErrorEvent(new Error("The layer '"+o+"' does not exist in the map's style and cannot be removed.")))},s.prototype.getLayer=function(o){return this._layers[o]},s.prototype.hasLayer=function(o){return o in this._layers},s.prototype.setLayerZoomRange=function(o,h,_){this._checkLoaded();var w=this.getLayer(o);w?w.minzoom===h&&w.maxzoom===_||(h!=null&&(w.minzoom=h),_!=null&&(w.maxzoom=_),this._updateLayer(w)):this.fire(new a.ErrorEvent(new Error("The layer '"+o+"' does not exist in the map's style and cannot have zoom extent.")))},s.prototype.setFilter=function(o,h,_){_===void 0&&(_={}),this._checkLoaded();var w=this.getLayer(o);if(w){if(!a.deepEqual(w.filter,h))return h==null?(w.filter=void 0,void this._updateLayer(w)):void(this._validate(a.validateStyle.filter,"layers."+w.id+".filter",h,null,_)||(w.filter=a.clone$1(h),this._updateLayer(w)))}else this.fire(new a.ErrorEvent(new Error("The layer '"+o+"' does not exist in the map's style and cannot be filtered.")))},s.prototype.getFilter=function(o){return a.clone$1(this.getLayer(o).filter)},s.prototype.setLayoutProperty=function(o,h,_,w){w===void 0&&(w={}),this._checkLoaded();var S=this.getLayer(o);S?a.deepEqual(S.getLayoutProperty(h),_)||(S.setLayoutProperty(h,_,w),this._updateLayer(S)):this.fire(new a.ErrorEvent(new Error("The layer '"+o+"' does not exist in the map's style and cannot be styled.")))},s.prototype.getLayoutProperty=function(o,h){var _=this.getLayer(o);if(_)return _.getLayoutProperty(h);this.fire(new a.ErrorEvent(new Error("The layer '"+o+"' does not exist in the map's style.")))},s.prototype.setPaintProperty=function(o,h,_,w){w===void 0&&(w={}),this._checkLoaded();var S=this.getLayer(o);S?a.deepEqual(S.getPaintProperty(h),_)||(S.setPaintProperty(h,_,w)&&this._updateLayer(S),this._changed=!0,this._updatedPaintProps[o]=!0):this.fire(new a.ErrorEvent(new Error("The layer '"+o+"' does not exist in the map's style and cannot be styled.")))},s.prototype.getPaintProperty=function(o,h){return this.getLayer(o).getPaintProperty(h)},s.prototype.setFeatureState=function(o,h){this._checkLoaded();var _=o.source,w=o.sourceLayer,S=this.sourceCaches[_];if(S!==void 0){var I=S.getSource().type;I==="geojson"&&w?this.fire(new a.ErrorEvent(new Error("GeoJSON sources cannot have a sourceLayer parameter."))):I!=="vector"||w?(o.id===void 0&&this.fire(new a.ErrorEvent(new Error("The feature id parameter must be provided."))),S.setFeatureState(w,o.id,h)):this.fire(new a.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")))}else this.fire(new a.ErrorEvent(new Error("The source '"+_+"' does not exist in the map's style.")))},s.prototype.removeFeatureState=function(o,h){this._checkLoaded();var _=o.source,w=this.sourceCaches[_];if(w!==void 0){var S=w.getSource().type,I=S==="vector"?o.sourceLayer:void 0;S!=="vector"||I?h&&typeof o.id!="string"&&typeof o.id!="number"?this.fire(new a.ErrorEvent(new Error("A feature id is required to remove its specific state property."))):w.removeFeatureState(I,o.id,h):this.fire(new a.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")))}else this.fire(new a.ErrorEvent(new Error("The source '"+_+"' does not exist in the map's style.")))},s.prototype.getFeatureState=function(o){this._checkLoaded();var h=o.source,_=o.sourceLayer,w=this.sourceCaches[h];if(w!==void 0){if(w.getSource().type!=="vector"||_)return o.id===void 0&&this.fire(new a.ErrorEvent(new Error("The feature id parameter must be provided."))),w.getFeatureState(_,o.id);this.fire(new a.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")))}else this.fire(new a.ErrorEvent(new Error("The source '"+h+"' does not exist in the map's style.")))},s.prototype.getTransition=function(){return a.extend({duration:300,delay:0},this.stylesheet&&this.stylesheet.transition)},s.prototype.serialize=function(){return a.filterObject({version:this.stylesheet.version,name:this.stylesheet.name,metadata:this.stylesheet.metadata,light:this.stylesheet.light,center:this.stylesheet.center,zoom:this.stylesheet.zoom,bearing:this.stylesheet.bearing,pitch:this.stylesheet.pitch,sprite:this.stylesheet.sprite,glyphs:this.stylesheet.glyphs,transition:this.stylesheet.transition,sources:a.mapObject(this.sourceCaches,function(o){return o.serialize()}),layers:this._serializeLayers(this._order)},function(o){return o!==void 0})},s.prototype._updateLayer=function(o){this._updatedLayers[o.id]=!0,o.source&&!this._updatedSources[o.source]&&this.sourceCaches[o.source].getSource().type!=="raster"&&(this._updatedSources[o.source]="reload",this.sourceCaches[o.source].pause()),this._changed=!0},s.prototype._flattenAndSortRenderedFeatures=function(o){for(var h=this,_=function(Qe){return h._layers[Qe].type==="fill-extrusion"},w={},S=[],I=this._order.length-1;I>=0;I--){var P=this._order[I];if(_(P)){w[P]=I;for(var O=0,G=o;O<G.length;O+=1){var Z=G[O][P];if(Z)for(var H=0,te=Z;H<te.length;H+=1)S.push(te[H])}}}S.sort(function(Qe,We){return We.intersectionZ-Qe.intersectionZ});for(var ee=[],ce=this._order.length-1;ce>=0;ce--){var Y=this._order[ce];if(_(Y))for(var ue=S.length-1;ue>=0;ue--){var de=S[ue].feature;if(w[de.layer.id]<ce)break;ee.push(de),S.pop()}else for(var be=0,Ae=o;be<Ae.length;be+=1){var Ee=Ae[be][Y];if(Ee)for(var ze=0,Ve=Ee;ze<Ve.length;ze+=1)ee.push(Ve[ze].feature)}}return ee},s.prototype.queryRenderedFeatures=function(o,h,_){h&&h.filter&&this._validate(a.validateStyle.filter,"queryRenderedFeatures.filter",h.filter,null,h);var w={};if(h&&h.layers){if(!Array.isArray(h.layers))return this.fire(new a.ErrorEvent(new Error("parameters.layers must be an Array."))),[];for(var S=0,I=h.layers;S<I.length;S+=1){var P=I[S],O=this._layers[P];if(!O)return this.fire(new a.ErrorEvent(new Error("The layer '"+P+"' does not exist in the map's style and cannot be queried for features."))),[];w[O.source]=!0}}var G=[];for(var Z in h.availableImages=this._availableImages,this.sourceCaches)h.layers&&!w[Z]||G.push(cr(this.sourceCaches[Z],this._layers,this._serializedLayers,o,h,_));return this.placement&&G.push(function(H,te,ee,ce,Y,ue,de){for(var be={},Ae=ue.queryRenderedSymbols(ce),Ee=[],ze=0,Ve=Object.keys(Ae).map(Number);ze<Ve.length;ze+=1)Ee.push(de[Ve[ze]]);Ee.sort(Sr);for(var Qe=function(){var Mt=ft[We],gr=Mt.featureIndex.lookupSymbolFeatures(Ae[Mt.bucketInstanceId],te,Mt.bucketIndex,Mt.sourceLayerIndex,Y.filter,Y.layers,Y.availableImages,H);for(var dt in gr){var qt=be[dt]=be[dt]||[],Jt=gr[dt];Jt.sort(function(Wt,Ot){var Rt=Mt.featureSortOrder;if(Rt){var Oi=Rt.indexOf(Wt.featureIndex);return Rt.indexOf(Ot.featureIndex)-Oi}return Ot.featureIndex-Wt.featureIndex});for(var Vt=0,Nt=Jt;Vt<Nt.length;Vt+=1)qt.push(Nt[Vt])}},We=0,ft=Ee;We<ft.length;We+=1)Qe();var Tt=function(Mt){be[Mt].forEach(function(gr){var dt=gr.feature,qt=ee[H[Mt].source].getFeatureState(dt.layer["source-layer"],dt.id);dt.source=dt.layer.source,dt.layer["source-layer"]&&(dt.sourceLayer=dt.layer["source-layer"]),dt.state=qt})};for(var Dt in be)Tt(Dt);return be}(this._layers,this._serializedLayers,this.sourceCaches,o,h,this.placement.collisionIndex,this.placement.retainedQueryData)),this._flattenAndSortRenderedFeatures(G)},s.prototype.querySourceFeatures=function(o,h){h&&h.filter&&this._validate(a.validateStyle.filter,"querySourceFeatures.filter",h.filter,null,h);var _=this.sourceCaches[o];return _?function(w,S){for(var I=w.getRenderableIds().map(function(te){return w.getTileByID(te)}),P=[],O={},G=0;G<I.length;G++){var Z=I[G],H=Z.tileID.canonical.key;O[H]||(O[H]=!0,Z.querySourceFeatures(P,S))}return P}(_,h):[]},s.prototype.addSourceType=function(o,h,_){return s.getSourceType(o)?_(new Error('A source type called "'+o+'" already exists.')):(s.setSourceType(o,h),h.workerSourceURL?void this.dispatcher.broadcast("loadWorkerSource",{name:o,url:h.workerSourceURL},_):_(null,null))},s.prototype.getLight=function(){return this.light.getLight()},s.prototype.setLight=function(o,h){h===void 0&&(h={}),this._checkLoaded();var _=this.light.getLight(),w=!1;for(var S in o)if(!a.deepEqual(o[S],_[S])){w=!0;break}if(w){var I={now:a.browser.now(),transition:a.extend({duration:300,delay:0},this.stylesheet.transition)};this.light.setLight(o,h),this.light.updateTransitions(I)}},s.prototype._validate=function(o,h,_,w,S){return S===void 0&&(S={}),(!S||S.validate!==!1)&&hn(this,o.call(a.validateStyle,a.extend({key:h,style:this.serialize(),value:_,styleSpec:a.styleSpec},w)))},s.prototype._remove=function(){for(var o in this._request&&(this._request.cancel(),this._request=null),this._spriteRequest&&(this._spriteRequest.cancel(),this._spriteRequest=null),a.evented.off("pluginStateChange",this._rtlTextPluginCallback),this._layers)this._layers[o].setEventedParent(null);for(var h in this.sourceCaches)this.sourceCaches[h].clearTiles(),this.sourceCaches[h].setEventedParent(null);this.imageManager.setEventedParent(null),this.setEventedParent(null),this.dispatcher.remove()},s.prototype._clearSource=function(o){this.sourceCaches[o].clearTiles()},s.prototype._reloadSource=function(o){this.sourceCaches[o].resume(),this.sourceCaches[o].reload()},s.prototype._updateSources=function(o){for(var h in this.sourceCaches)this.sourceCaches[h].update(o)},s.prototype._generateCollisionBoxes=function(){for(var o in this.sourceCaches)this._reloadSource(o)},s.prototype._updatePlacement=function(o,h,_,w,S){S===void 0&&(S=!1);for(var I=!1,P=!1,O={},G=0,Z=this._order;G<Z.length;G+=1){var H=this._layers[Z[G]];if(H.type==="symbol"){if(!O[H.source]){var te=this.sourceCaches[H.source];O[H.source]=te.getRenderableIds(!0).map(function(de){return te.getTileByID(de)}).sort(function(de,be){return be.tileID.overscaledZ-de.tileID.overscaledZ||(de.tileID.isLessThan(be.tileID)?-1:1)})}var ee=this.crossTileSymbolIndex.addLayer(H,O[H.source],o.center.lng);I=I||ee}}if(this.crossTileSymbolIndex.pruneUnusedLayers(this._order),((S=S||this._layerOrderChanged||_===0)||!this.pauseablePlacement||this.pauseablePlacement.isDone()&&!this.placement.stillRecent(a.browser.now(),o.zoom))&&(this.pauseablePlacement=new co(o,this._order,S,h,_,w,this.placement),this._layerOrderChanged=!1),this.pauseablePlacement.isDone()?this.placement.setStale():(this.pauseablePlacement.continuePlacement(this._order,this._layers,O),this.pauseablePlacement.isDone()&&(this.placement=this.pauseablePlacement.commit(a.browser.now()),P=!0),I&&this.pauseablePlacement.placement.setStale()),P||I)for(var ce=0,Y=this._order;ce<Y.length;ce+=1){var ue=this._layers[Y[ce]];ue.type==="symbol"&&this.placement.updateLayerOpacities(ue,O[ue.source])}return!this.pauseablePlacement.isDone()||this.placement.hasTransitions(a.browser.now())},s.prototype._releaseSymbolFadeTiles=function(){for(var o in this.sourceCaches)this.sourceCaches[o].releaseSymbolFadeTiles()},s.prototype.getImages=function(o,h,_){this.imageManager.getImages(h.icons,_),this._updateTilesForChangedImages();var w=this.sourceCaches[h.source];w&&w.setDependencies(h.tileID.key,h.type,h.icons)},s.prototype.getGlyphs=function(o,h,_){this.glyphManager.getGlyphs(h.stacks,_)},s.prototype.getResource=function(o,h,_){return a.makeRequest(h,_)},s}(a.Evented);Nn.getSourceType=function(n){return ki[n]},Nn.setSourceType=function(n,s){ki[n]=s},Nn.registerForPluginStateChange=a.registerForPluginStateChange;var xi=a.createLayout([{name:"a_pos",type:"Int16",components:2}]),Oo=Lr(`#ifdef GL_ES
precision mediump float;
#else
#if !defined(lowp)
#define lowp
#endif
#if !defined(mediump)
#define mediump
#endif
#if !defined(highp)
#define highp
#endif
#endif`,`#ifdef GL_ES
precision highp float;
#else
#if !defined(lowp)
#define lowp
#endif
#if !defined(mediump)
#define mediump
#endif
#if !defined(highp)
#define highp
#endif
#endif
vec2 unpack_float(const float packedValue) {int packedIntValue=int(packedValue);int v0=packedIntValue/256;return vec2(v0,packedIntValue-v0*256);}vec2 unpack_opacity(const float packedOpacity) {int intOpacity=int(packedOpacity)/2;return vec2(float(intOpacity)/127.0,mod(packedOpacity,2.0));}vec4 decode_color(const vec2 encodedColor) {return vec4(unpack_float(encodedColor[0])/255.0,unpack_float(encodedColor[1])/255.0
);}float unpack_mix_vec2(const vec2 packedValue,const float t) {return mix(packedValue[0],packedValue[1],t);}vec4 unpack_mix_color(const vec4 packedColors,const float t) {vec4 minColor=decode_color(vec2(packedColors[0],packedColors[1]));vec4 maxColor=decode_color(vec2(packedColors[2],packedColors[3]));return mix(minColor,maxColor,t);}vec2 get_pattern_pos(const vec2 pixel_coord_upper,const vec2 pixel_coord_lower,const vec2 pattern_size,const float tile_units_to_pixels,const vec2 pos) {vec2 offset=mod(mod(mod(pixel_coord_upper,pattern_size)*256.0,pattern_size)*256.0+pixel_coord_lower,pattern_size);return (tile_units_to_pixels*pos+offset)/pattern_size;}`),tc=Lr(`uniform vec4 u_color;uniform float u_opacity;void main() {gl_FragColor=u_color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),Nh=Lr(`uniform vec2 u_pattern_tl_a;uniform vec2 u_pattern_br_a;uniform vec2 u_pattern_tl_b;uniform vec2 u_pattern_br_b;uniform vec2 u_texsize;uniform float u_mix;uniform float u_opacity;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;void main() {vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(u_pattern_tl_a/u_texsize,u_pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(u_pattern_tl_b/u_texsize,u_pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);gl_FragColor=mix(color1,color2,u_mix)*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_pattern_size_a;uniform vec2 u_pattern_size_b;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_scale_a;uniform float u_scale_b;uniform float u_tile_units_to_pixels;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_a*u_pattern_size_a,u_tile_units_to_pixels,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_b*u_pattern_size_b,u_tile_units_to_pixels,a_pos);}"),Vh=Lr(`varying vec3 v_data;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=v_data.xy;float extrude_length=length(extrude);lowp float antialiasblur=v_data.z;float antialiased_blur=-max(blur,antialiasblur);float opacity_t=smoothstep(0.0,antialiased_blur,extrude_length-1.0);float color_t=stroke_width < 0.01 ? 0.0 : smoothstep(antialiased_blur,0.0,extrude_length-radius/(radius+stroke_width));gl_FragColor=opacity_t*mix(color*opacity,stroke_color*stroke_opacity,color_t);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform bool u_scale_with_map;uniform bool u_pitch_with_map;uniform vec2 u_extrude_scale;uniform lowp float u_device_pixel_ratio;uniform highp float u_camera_to_center_distance;attribute vec2 a_pos;varying vec3 v_data;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
void main(void) {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=vec2(mod(a_pos,2.0)*2.0-1.0);vec2 circle_center=floor(a_pos*0.5);if (u_pitch_with_map) {vec2 corner_position=circle_center;if (u_scale_with_map) {corner_position+=extrude*(radius+stroke_width)*u_extrude_scale;} else {vec4 projected_center=u_matrix*vec4(circle_center,0,1);corner_position+=extrude*(radius+stroke_width)*u_extrude_scale*(projected_center.w/u_camera_to_center_distance);}gl_Position=u_matrix*vec4(corner_position,0,1);} else {gl_Position=u_matrix*vec4(circle_center,0,1);if (u_scale_with_map) {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*u_camera_to_center_distance;} else {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*gl_Position.w;}}lowp float antialiasblur=1.0/u_device_pixel_ratio/(radius+stroke_width);v_data=vec3(extrude.x,extrude.y,antialiasblur);}`),Ul=Lr("void main() {gl_FragColor=vec4(1.0);}","attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),ql=Lr(`uniform highp float u_intensity;varying vec2 v_extrude;
#pragma mapbox: define highp float weight
#define GAUSS_COEF 0.3989422804014327
void main() {
#pragma mapbox: initialize highp float weight
float d=-0.5*3.0*3.0*dot(v_extrude,v_extrude);float val=weight*u_intensity*GAUSS_COEF*exp(d);gl_FragColor=vec4(val,1.0,1.0,1.0);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform float u_extrude_scale;uniform float u_opacity;uniform float u_intensity;attribute vec2 a_pos;varying vec2 v_extrude;
#pragma mapbox: define highp float weight
#pragma mapbox: define mediump float radius
const highp float ZERO=1.0/255.0/16.0;
#define GAUSS_COEF 0.3989422804014327
void main(void) {
#pragma mapbox: initialize highp float weight
#pragma mapbox: initialize mediump float radius
vec2 unscaled_extrude=vec2(mod(a_pos,2.0)*2.0-1.0);float S=sqrt(-2.0*log(ZERO/weight/u_intensity/GAUSS_COEF))/3.0;v_extrude=S*unscaled_extrude;vec2 extrude=v_extrude*radius*u_extrude_scale;vec4 pos=vec4(floor(a_pos*0.5)+extrude,0,1);gl_Position=u_matrix*pos;}`),jl=Lr(`uniform sampler2D u_image;uniform sampler2D u_color_ramp;uniform float u_opacity;varying vec2 v_pos;void main() {float t=texture2D(u_image,v_pos).r;vec4 color=texture2D(u_color_ramp,vec2(t,0.5));gl_FragColor=color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(0.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_world;attribute vec2 a_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos*u_world,0,1);v_pos.x=a_pos.x;v_pos.y=1.0-a_pos.y;}"),Gl=Lr("varying float v_placed;varying float v_notUsed;void main() {float alpha=0.5;gl_FragColor=vec4(1.0,0.0,0.0,1.0)*alpha;if (v_placed > 0.5) {gl_FragColor=vec4(0.0,0.0,1.0,0.5)*alpha;}if (v_notUsed > 0.5) {gl_FragColor*=.1;}}","attribute vec2 a_pos;attribute vec2 a_anchor_pos;attribute vec2 a_extrude;attribute vec2 a_placed;attribute vec2 a_shift;uniform mat4 u_matrix;uniform vec2 u_extrude_scale;uniform float u_camera_to_center_distance;varying float v_placed;varying float v_notUsed;void main() {vec4 projectedPoint=u_matrix*vec4(a_anchor_pos,0,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float collision_perspective_ratio=clamp(0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,4.0);gl_Position=u_matrix*vec4(a_pos,0.0,1.0);gl_Position.xy+=(a_extrude+a_shift)*u_extrude_scale*gl_Position.w*collision_perspective_ratio;v_placed=a_placed.x;v_notUsed=a_placed.y;}"),rc=Lr("varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;void main() {float alpha=0.5*min(v_perspective_ratio,1.0);float stroke_radius=0.9*max(v_perspective_ratio,1.0);float distance_to_center=length(v_extrude);float distance_to_edge=abs(distance_to_center-v_radius);float opacity_t=smoothstep(-stroke_radius,0.0,-distance_to_edge);vec4 color=mix(vec4(0.0,0.0,1.0,0.5),vec4(1.0,0.0,0.0,1.0),v_collision);gl_FragColor=color*alpha*opacity_t;}","attribute vec2 a_pos;attribute float a_radius;attribute vec2 a_flags;uniform mat4 u_matrix;uniform mat4 u_inv_matrix;uniform vec2 u_viewport_size;uniform float u_camera_to_center_distance;varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;vec3 toTilePosition(vec2 screenPos) {vec4 rayStart=u_inv_matrix*vec4(screenPos,-1.0,1.0);vec4 rayEnd  =u_inv_matrix*vec4(screenPos, 1.0,1.0);rayStart.xyz/=rayStart.w;rayEnd.xyz  /=rayEnd.w;highp float t=(0.0-rayStart.z)/(rayEnd.z-rayStart.z);return mix(rayStart.xyz,rayEnd.xyz,t);}void main() {vec2 quadCenterPos=a_pos;float radius=a_radius;float collision=a_flags.x;float vertexIdx=a_flags.y;vec2 quadVertexOffset=vec2(mix(-1.0,1.0,float(vertexIdx >=2.0)),mix(-1.0,1.0,float(vertexIdx >=1.0 && vertexIdx <=2.0)));vec2 quadVertexExtent=quadVertexOffset*radius;vec3 tilePos=toTilePosition(quadCenterPos);vec4 clipPos=u_matrix*vec4(tilePos,1.0);highp float camera_to_anchor_distance=clipPos.w;highp float collision_perspective_ratio=clamp(0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,4.0);float padding_factor=1.2;v_radius=radius;v_extrude=quadVertexExtent*padding_factor;v_perspective_ratio=collision_perspective_ratio;v_collision=collision;gl_Position=vec4(clipPos.xyz/clipPos.w,1.0)+vec4(quadVertexExtent*padding_factor/u_viewport_size*2.0,0.0,0.0);}"),ic=Lr("uniform highp vec4 u_color;uniform sampler2D u_overlay;varying vec2 v_uv;void main() {vec4 overlay_color=texture2D(u_overlay,v_uv);gl_FragColor=mix(u_color,overlay_color,overlay_color.a);}","attribute vec2 a_pos;varying vec2 v_uv;uniform mat4 u_matrix;uniform float u_overlay_scale;void main() {v_uv=a_pos/8192.0;gl_Position=u_matrix*vec4(a_pos*u_overlay_scale,0,1);}"),Uh=Lr(`#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
gl_FragColor=color*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec2 a_pos;uniform mat4 u_matrix;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
gl_Position=u_matrix*vec4(a_pos,0,1);}`),os=Lr(`varying vec2 v_pos;
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);gl_FragColor=outline_color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec2 a_pos;uniform mat4 u_matrix;uniform vec2 u_world;varying vec2 v_pos;
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;}`),ss=Lr(`uniform vec2 u_texsize;uniform sampler2D u_image;uniform float u_fade;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec2 v_pos;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);gl_FragColor=mix(color1,color2,u_fade)*alpha*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_world;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec2 v_pos;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;gl_Position=u_matrix*vec4(a_pos,0,1);vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,a_pos);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;}`),nc=Lr(`uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);gl_FragColor=mix(color1,color2,u_fade)*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;gl_Position=u_matrix*vec4(a_pos,0,1);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileZoomRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileZoomRatio,a_pos);}`),tn=Lr(`varying vec4 v_color;void main() {gl_FragColor=v_color;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;uniform float u_vertical_gradient;uniform lowp float u_opacity;attribute vec2 a_pos;attribute vec4 a_normal_ed;varying vec4 v_color;
#pragma mapbox: define highp float base
#pragma mapbox: define highp float height
#pragma mapbox: define highp vec4 color
void main() {
#pragma mapbox: initialize highp float base
#pragma mapbox: initialize highp float height
#pragma mapbox: initialize highp vec4 color
vec3 normal=a_normal_ed.xyz;base=max(0.0,base);height=max(0.0,height);float t=mod(normal.x,2.0);gl_Position=u_matrix*vec4(a_pos,t > 0.0 ? height : base,1);float colorvalue=color.r*0.2126+color.g*0.7152+color.b*0.0722;v_color=vec4(0.0,0.0,0.0,1.0);vec4 ambientlight=vec4(0.03,0.03,0.03,1.0);color+=ambientlight;float directional=clamp(dot(normal/16384.0,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_color.r+=clamp(color.r*directional*u_lightcolor.r,mix(0.0,0.3,1.0-u_lightcolor.r),1.0);v_color.g+=clamp(color.g*directional*u_lightcolor.g,mix(0.0,0.3,1.0-u_lightcolor.g),1.0);v_color.b+=clamp(color.b*directional*u_lightcolor.b,mix(0.0,0.3,1.0-u_lightcolor.b),1.0);v_color*=u_opacity;}`),Zl=Lr(`uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec4 v_lighting;
#pragma mapbox: define lowp float base
#pragma mapbox: define lowp float height
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float base
#pragma mapbox: initialize lowp float height
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);vec4 mixedColor=mix(color1,color2,u_fade);gl_FragColor=mixedColor*v_lighting;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_height_factor;uniform vec3 u_scale;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;attribute vec2 a_pos;attribute vec4 a_normal_ed;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec4 v_lighting;
#pragma mapbox: define lowp float base
#pragma mapbox: define lowp float height
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float base
#pragma mapbox: initialize lowp float height
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec3 normal=a_normal_ed.xyz;float edgedistance=a_normal_ed.w;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;base=max(0.0,base);height=max(0.0,height);float t=mod(normal.x,2.0);float z=t > 0.0 ? height : base;gl_Position=u_matrix*vec4(a_pos,z,1);vec2 pos=normal.x==1.0 && normal.y==0.0 && normal.z==16384.0
? a_pos
: vec2(edgedistance,z*u_height_factor);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,pos);v_lighting=vec4(0.0,0.0,0.0,1.0);float directional=clamp(dot(normal/16383.0,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((0.5+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_lighting.rgb+=clamp(directional*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_lighting*=u_opacity;}`),qa=Lr(`#ifdef GL_ES
precision highp float;
#endif
uniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_dimension;uniform float u_zoom;uniform vec4 u_unpack;float getElevation(vec2 coord,float bias) {vec4 data=texture2D(u_image,coord)*255.0;data.a=-1.0;return dot(data,u_unpack)/4.0;}void main() {vec2 epsilon=1.0/u_dimension;float a=getElevation(v_pos+vec2(-epsilon.x,-epsilon.y),0.0);float b=getElevation(v_pos+vec2(0,-epsilon.y),0.0);float c=getElevation(v_pos+vec2(epsilon.x,-epsilon.y),0.0);float d=getElevation(v_pos+vec2(-epsilon.x,0),0.0);float e=getElevation(v_pos,0.0);float f=getElevation(v_pos+vec2(epsilon.x,0),0.0);float g=getElevation(v_pos+vec2(-epsilon.x,epsilon.y),0.0);float h=getElevation(v_pos+vec2(0,epsilon.y),0.0);float i=getElevation(v_pos+vec2(epsilon.x,epsilon.y),0.0);float exaggerationFactor=u_zoom < 2.0 ? 0.4 : u_zoom < 4.5 ? 0.35 : 0.3;float exaggeration=u_zoom < 15.0 ? (u_zoom-15.0)*exaggerationFactor : 0.0;vec2 deriv=vec2((c+f+f+i)-(a+d+d+g),(g+h+h+i)-(a+b+b+c))/pow(2.0,exaggeration+(19.2562-u_zoom));gl_FragColor=clamp(vec4(deriv.x/2.0+0.5,deriv.y/2.0+0.5,1.0,1.0),0.0,1.0);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_dimension;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);highp vec2 epsilon=1.0/u_dimension;float scale=(u_dimension.x-2.0)/u_dimension.x;v_pos=(a_texture_pos/8192.0)*scale+epsilon;}"),ja=Lr(`uniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_latrange;uniform vec2 u_light;uniform vec4 u_shadow;uniform vec4 u_highlight;uniform vec4 u_accent;
#define PI 3.141592653589793
void main() {vec4 pixel=texture2D(u_image,v_pos);vec2 deriv=((pixel.rg*2.0)-1.0);float scaleFactor=cos(radians((u_latrange[0]-u_latrange[1])*(1.0-v_pos.y)+u_latrange[1]));float slope=atan(1.25*length(deriv)/scaleFactor);float aspect=deriv.x !=0.0 ? atan(deriv.y,-deriv.x) : PI/2.0*(deriv.y > 0.0 ? 1.0 :-1.0);float intensity=u_light.x;float azimuth=u_light.y+PI;float base=1.875-intensity*1.75;float maxValue=0.5*PI;float scaledSlope=intensity !=0.5 ? ((pow(base,slope)-1.0)/(pow(base,maxValue)-1.0))*maxValue : slope;float accent=cos(scaledSlope);vec4 accent_color=(1.0-accent)*u_accent*clamp(intensity*2.0,0.0,1.0);float shade=abs(mod((aspect+azimuth)/PI+0.5,2.0)-1.0);vec4 shade_color=mix(u_shadow,u_highlight,shade)*sin(scaledSlope)*clamp(intensity*2.0,0.0,1.0);gl_FragColor=accent_color*(1.0-shade_color.a)+shade_color;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=a_texture_pos/8192.0;}"),ho=Lr(`uniform lowp float u_device_pixel_ratio;varying vec2 v_width2;varying vec2 v_normal;varying float v_gamma_scale;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);gl_FragColor=color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
attribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform vec2 u_units_to_pixels;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_gamma_scale;varying highp float v_linesofar;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;v_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*2.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;v_width2=vec2(outset,inset);}`),po=Lr(`uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;varying vec2 v_width2;varying vec2 v_normal;varying float v_gamma_scale;varying highp vec2 v_uv;
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);vec4 color=texture2D(u_image,v_uv);gl_FragColor=color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
attribute vec2 a_pos_normal;attribute vec4 a_data;attribute float a_uv_x;attribute float a_split_index;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_units_to_pixels;uniform float u_image_height;varying vec2 v_normal;varying vec2 v_width2;varying float v_gamma_scale;varying highp vec2 v_uv;
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;highp float texel_height=1.0/u_image_height;highp float half_texel_height=0.5*texel_height;v_uv=vec2(a_uv_x,a_split_index*texel_height-half_texel_height);vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;v_width2=vec2(outset,inset);}`),Ga=Lr(`uniform lowp float u_device_pixel_ratio;uniform vec2 u_texsize;uniform float u_fade;uniform mediump vec3 u_scale;uniform sampler2D u_image;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;vec2 pattern_size_a=vec2(display_size_a.x*fromScale/tileZoomRatio,display_size_a.y);vec2 pattern_size_b=vec2(display_size_b.x*toScale/tileZoomRatio,display_size_b.y);float aspect_a=display_size_a.y/v_width;float aspect_b=display_size_b.y/v_width;float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float x_a=mod(v_linesofar/pattern_size_a.x*aspect_a,1.0);float x_b=mod(v_linesofar/pattern_size_b.x*aspect_b,1.0);float y=0.5*v_normal.y+0.5;vec2 texel_size=1.0/u_texsize;vec2 pos_a=mix(pattern_tl_a*texel_size-texel_size,pattern_br_a*texel_size+texel_size,vec2(x_a,y));vec2 pos_b=mix(pattern_tl_b*texel_size-texel_size,pattern_br_b*texel_size+texel_size,vec2(x_b,y));vec4 color=mix(texture2D(u_image,pos_a),texture2D(u_image,pos_b),u_fade);gl_FragColor=color*alpha*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
#define LINE_DISTANCE_SCALE 2.0
attribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform vec2 u_units_to_pixels;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;v_linesofar=a_linesofar;v_width2=vec2(outset,inset);v_width=floorwidth;}`),fo=Lr(`uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;uniform float u_sdfgamma;uniform float u_mix;varying vec2 v_normal;varying vec2 v_width2;varying vec2 v_tex_a;varying vec2 v_tex_b;varying float v_gamma_scale;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float sdfdist_a=texture2D(u_image,v_tex_a).a;float sdfdist_b=texture2D(u_image,v_tex_b).a;float sdfdist=mix(sdfdist_a,sdfdist_b,u_mix);alpha*=smoothstep(0.5-u_sdfgamma/floorwidth,0.5+u_sdfgamma/floorwidth,sdfdist);gl_FragColor=color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
#define LINE_DISTANCE_SCALE 2.0
attribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_patternscale_a;uniform float u_tex_y_a;uniform vec2 u_patternscale_b;uniform float u_tex_y_b;uniform vec2 u_units_to_pixels;varying vec2 v_normal;varying vec2 v_width2;varying vec2 v_tex_a;varying vec2 v_tex_b;varying float v_gamma_scale;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;v_tex_a=vec2(a_linesofar*u_patternscale_a.x/floorwidth,normal.y*u_patternscale_a.y+u_tex_y_a);v_tex_b=vec2(a_linesofar*u_patternscale_b.x/floorwidth,normal.y*u_patternscale_b.y+u_tex_y_b);v_width2=vec2(outset,inset);}`),mo=Lr(`uniform float u_fade_t;uniform float u_opacity;uniform sampler2D u_image0;uniform sampler2D u_image1;varying vec2 v_pos0;varying vec2 v_pos1;uniform float u_brightness_low;uniform float u_brightness_high;uniform float u_saturation_factor;uniform float u_contrast_factor;uniform vec3 u_spin_weights;void main() {vec4 color0=texture2D(u_image0,v_pos0);vec4 color1=texture2D(u_image1,v_pos1);if (color0.a > 0.0) {color0.rgb=color0.rgb/color0.a;}if (color1.a > 0.0) {color1.rgb=color1.rgb/color1.a;}vec4 color=mix(color0,color1,u_fade_t);color.a*=u_opacity;vec3 rgb=color.rgb;rgb=vec3(dot(rgb,u_spin_weights.xyz),dot(rgb,u_spin_weights.zxy),dot(rgb,u_spin_weights.yzx));float average=(color.r+color.g+color.b)/3.0;rgb+=(average-rgb)*u_saturation_factor;rgb=(rgb-0.5)*u_contrast_factor+0.5;vec3 u_high_vec=vec3(u_brightness_low,u_brightness_low,u_brightness_low);vec3 u_low_vec=vec3(u_brightness_high,u_brightness_high,u_brightness_high);gl_FragColor=vec4(mix(u_high_vec,u_low_vec,rgb)*color.a,color.a);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_tl_parent;uniform float u_scale_parent;uniform float u_buffer_scale;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos0;varying vec2 v_pos1;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos0=(((a_texture_pos/8192.0)-0.5)/u_buffer_scale )+0.5;v_pos1=(v_pos0*u_scale_parent)+u_tl_parent;}"),Za=Lr(`uniform sampler2D u_texture;varying vec2 v_tex;varying float v_fade_opacity;
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float opacity
lowp float alpha=opacity*v_fade_opacity;gl_FragColor=texture2D(u_texture,v_tex)*alpha;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`const float PI=3.141592653589793;attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec4 a_pixeloffset;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform highp float u_camera_to_center_distance;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform float u_fade_change;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform vec2 u_texsize;varying vec2 v_tex;varying float v_fade_opacity;
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float opacity
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;vec2 a_minFontScale=a_pixeloffset.zw/256.0;highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec4 projectedPoint=u_matrix*vec4(a_pos,0,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),0,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,0.0,1.0);gl_Position=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*max(a_minFontScale,fontScale)+a_pxoffset/16.0),0.0,1.0);v_tex=a_tex/u_texsize;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;v_fade_opacity=max(0.0,min(1.0,fade_opacity[0]+fade_change));}`),ac=Lr(`#define SDF_PX 8.0
uniform bool u_is_halo;uniform sampler2D u_texture;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;uniform bool u_is_text;varying vec2 v_data0;varying vec3 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
float EDGE_GAMMA=0.105/u_device_pixel_ratio;vec2 tex=v_data0.xy;float gamma_scale=v_data1.x;float size=v_data1.y;float fade_opacity=v_data1[2];float fontScale=u_is_text ? size/24.0 : size;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);gl_FragColor=color*(alpha*opacity*fade_opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`const float PI=3.141592653589793;attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec4 a_pixeloffset;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;varying vec2 v_data0;varying vec3 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec4 projectedPoint=u_matrix*vec4(a_pos,0,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),0,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,0.0,1.0);gl_Position=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale+a_pxoffset),0.0,1.0);float gamma_scale=gl_Position.w;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(1.0,fade_opacity[0]+fade_change));v_data0=a_tex/u_texsize;v_data1=vec3(gamma_scale,size,interpolated_fade_opacity);}`),oc=Lr(`#define SDF_PX 8.0
#define SDF 1.0
#define ICON 0.0
uniform bool u_is_halo;uniform sampler2D u_texture;uniform sampler2D u_texture_icon;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;varying vec4 v_data0;varying vec4 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
float fade_opacity=v_data1[2];if (v_data1.w==ICON) {vec2 tex_icon=v_data0.zw;lowp float alpha=opacity*fade_opacity;gl_FragColor=texture2D(u_texture_icon,tex_icon)*alpha;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
return;}vec2 tex=v_data0.xy;float EDGE_GAMMA=0.105/u_device_pixel_ratio;float gamma_scale=v_data1.x;float size=v_data1.y;float fontScale=size/24.0;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);gl_FragColor=color*(alpha*opacity*fade_opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`const float PI=3.141592653589793;attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec2 u_texsize_icon;varying vec4 v_data0;varying vec4 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);float is_sdf=a_size[0]-2.0*a_size_min;highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec4 projectedPoint=u_matrix*vec4(a_pos,0,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=size/24.0;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),0,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,0.0,1.0);gl_Position=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale),0.0,1.0);float gamma_scale=gl_Position.w;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(1.0,fade_opacity[0]+fade_change));v_data0.xy=a_tex/u_texsize;v_data0.zw=a_tex/u_texsize_icon;v_data1=vec4(gamma_scale,size,interpolated_fade_opacity,is_sdf);}`);function Lr(n,s){var o=/#pragma mapbox: ([\w]+) ([\w]+) ([\w]+) ([\w]+)/g,h=s.match(/attribute ([\w]+) ([\w]+)/g),_=n.match(/uniform ([\w]+) ([\w]+)([\s]*)([\w]*)/g),w=s.match(/uniform ([\w]+) ([\w]+)([\s]*)([\w]*)/g),S=w?w.concat(_):_,I={};return{fragmentSource:n=n.replace(o,function(P,O,G,Z,H){return I[H]=!0,O==="define"?`
#ifndef HAS_UNIFORM_u_`+H+`
varying `+G+" "+Z+" "+H+`;
#else
uniform `+G+" "+Z+" u_"+H+`;
#endif
`:`
#ifdef HAS_UNIFORM_u_`+H+`
    `+G+" "+Z+" "+H+" = u_"+H+`;
#endif
`}),vertexSource:s=s.replace(o,function(P,O,G,Z,H){var te=Z==="float"?"vec2":"vec4",ee=H.match(/color/)?"color":te;return I[H]?O==="define"?`
#ifndef HAS_UNIFORM_u_`+H+`
uniform lowp float u_`+H+`_t;
attribute `+G+" "+te+" a_"+H+`;
varying `+G+" "+Z+" "+H+`;
#else
uniform `+G+" "+Z+" u_"+H+`;
#endif
`:ee==="vec4"?`
#ifndef HAS_UNIFORM_u_`+H+`
    `+H+" = a_"+H+`;
#else
    `+G+" "+Z+" "+H+" = u_"+H+`;
#endif
`:`
#ifndef HAS_UNIFORM_u_`+H+`
    `+H+" = unpack_mix_"+ee+"(a_"+H+", u_"+H+`_t);
#else
    `+G+" "+Z+" "+H+" = u_"+H+`;
#endif
`:O==="define"?`
#ifndef HAS_UNIFORM_u_`+H+`
uniform lowp float u_`+H+`_t;
attribute `+G+" "+te+" a_"+H+`;
#else
uniform `+G+" "+Z+" u_"+H+`;
#endif
`:ee==="vec4"?`
#ifndef HAS_UNIFORM_u_`+H+`
    `+G+" "+Z+" "+H+" = a_"+H+`;
#else
    `+G+" "+Z+" "+H+" = u_"+H+`;
#endif
`:`
#ifndef HAS_UNIFORM_u_`+H+`
    `+G+" "+Z+" "+H+" = unpack_mix_"+ee+"(a_"+H+", u_"+H+`_t);
#else
    `+G+" "+Z+" "+H+" = u_"+H+`;
#endif
`}),staticAttributes:h,staticUniforms:S}}var qh=Object.freeze({__proto__:null,prelude:Oo,background:tc,backgroundPattern:Nh,circle:Vh,clippingMask:Ul,heatmap:ql,heatmapTexture:jl,collisionBox:Gl,collisionCircle:rc,debug:ic,fill:Uh,fillOutline:os,fillOutlinePattern:ss,fillPattern:nc,fillExtrusion:tn,fillExtrusionPattern:Zl,hillshadePrepare:qa,hillshade:ja,line:ho,lineGradient:po,linePattern:Ga,lineSDF:fo,raster:mo,symbolIcon:Za,symbolSDF:ac,symbolTextAndIcon:oc}),Ns=function(){this.boundProgram=null,this.boundLayoutVertexBuffer=null,this.boundPaintVertexBuffers=[],this.boundIndexBuffer=null,this.boundVertexOffset=null,this.boundDynamicVertexBuffer=null,this.vao=null};function sc(n){for(var s=[],o=0;o<n.length;o++)if(n[o]!==null){var h=n[o].split(" ");s.push(h.pop())}return s}Ns.prototype.bind=function(n,s,o,h,_,w,S,I){this.context=n;for(var P=this.boundPaintVertexBuffers.length!==h.length,O=0;!P&&O<h.length;O++)this.boundPaintVertexBuffers[O]!==h[O]&&(P=!0);n.extVertexArrayObject&&this.vao&&this.boundProgram===s&&this.boundLayoutVertexBuffer===o&&!P&&this.boundIndexBuffer===_&&this.boundVertexOffset===w&&this.boundDynamicVertexBuffer===S&&this.boundDynamicVertexBuffer2===I?(n.bindVertexArrayOES.set(this.vao),S&&S.bind(),_&&_.dynamicDraw&&_.bind(),I&&I.bind()):this.freshBind(s,o,h,_,w,S,I)},Ns.prototype.freshBind=function(n,s,o,h,_,w,S){var I,P=n.numAttributes,O=this.context,G=O.gl;if(O.extVertexArrayObject)this.vao&&this.destroy(),this.vao=O.extVertexArrayObject.createVertexArrayOES(),O.bindVertexArrayOES.set(this.vao),I=0,this.boundProgram=n,this.boundLayoutVertexBuffer=s,this.boundPaintVertexBuffers=o,this.boundIndexBuffer=h,this.boundVertexOffset=_,this.boundDynamicVertexBuffer=w,this.boundDynamicVertexBuffer2=S;else{I=O.currentNumAttributes||0;for(var Z=P;Z<I;Z++)G.disableVertexAttribArray(Z)}s.enableAttributes(G,n);for(var H=0,te=o;H<te.length;H+=1)te[H].enableAttributes(G,n);w&&w.enableAttributes(G,n),S&&S.enableAttributes(G,n),s.bind(),s.setVertexAttribPointers(G,n,_);for(var ee=0,ce=o;ee<ce.length;ee+=1){var Y=ce[ee];Y.bind(),Y.setVertexAttribPointers(G,n,_)}w&&(w.bind(),w.setVertexAttribPointers(G,n,_)),h&&h.bind(),S&&(S.bind(),S.setVertexAttribPointers(G,n,_)),O.currentNumAttributes=P},Ns.prototype.destroy=function(){this.vao&&(this.context.extVertexArrayObject.deleteVertexArrayOES(this.vao),this.vao=null)};var lc=function(n,s,o,h,_,w){var S=n.gl;this.program=S.createProgram();for(var I=sc(o.staticAttributes),P=h?h.getBinderAttributes():[],O=I.concat(P),G=o.staticUniforms?sc(o.staticUniforms):[],Z=h?h.getBinderUniforms():[],H=[],te=0,ee=G.concat(Z);te<ee.length;te+=1){var ce=ee[te];H.indexOf(ce)<0&&H.push(ce)}var Y=h?h.defines():[];w&&Y.push("#define OVERDRAW_INSPECTOR;");var ue=Y.concat(Oo.fragmentSource,o.fragmentSource).join(`
`),de=Y.concat(Oo.vertexSource,o.vertexSource).join(`
`),be=S.createShader(S.FRAGMENT_SHADER);if(S.isContextLost())this.failedToCreate=!0;else{S.shaderSource(be,ue),S.compileShader(be),S.attachShader(this.program,be);var Ae=S.createShader(S.VERTEX_SHADER);if(S.isContextLost())this.failedToCreate=!0;else{S.shaderSource(Ae,de),S.compileShader(Ae),S.attachShader(this.program,Ae),this.attributes={};var Ee={};this.numAttributes=O.length;for(var ze=0;ze<this.numAttributes;ze++)O[ze]&&(S.bindAttribLocation(this.program,ze,O[ze]),this.attributes[O[ze]]=ze);S.linkProgram(this.program),S.deleteShader(Ae),S.deleteShader(be);for(var Ve=0;Ve<H.length;Ve++){var Qe=H[Ve];if(Qe&&!Ee[Qe]){var We=S.getUniformLocation(this.program,Qe);We&&(Ee[Qe]=We)}}this.fixedUniforms=_(n,Ee),this.binderUniforms=h?h.getUniforms(n,Ee):[]}}};function uc(n,s,o){var h=1/Cr(o,1,s.transform.tileZoom),_=Math.pow(2,o.tileID.overscaledZ),w=o.tileSize*Math.pow(2,s.transform.tileZoom)/_,S=w*(o.tileID.canonical.x+o.tileID.wrap*_),I=w*o.tileID.canonical.y;return{u_image:0,u_texsize:o.imageAtlasTexture.size,u_scale:[h,n.fromScale,n.toScale],u_fade:n.t,u_pixel_coord_upper:[S>>16,I>>16],u_pixel_coord_lower:[65535&S,65535&I]}}lc.prototype.draw=function(n,s,o,h,_,w,S,I,P,O,G,Z,H,te,ee,ce){var Y,ue=n.gl;if(!this.failedToCreate){for(var de in n.program.set(this.program),n.setDepthMode(o),n.setStencilMode(h),n.setColorMode(_),n.setCullFace(w),this.fixedUniforms)this.fixedUniforms[de].set(S[de]);te&&te.setUniforms(n,this.binderUniforms,Z,{zoom:H});for(var be=(Y={},Y[ue.LINES]=2,Y[ue.TRIANGLES]=3,Y[ue.LINE_STRIP]=1,Y)[s],Ae=0,Ee=G.get();Ae<Ee.length;Ae+=1){var ze=Ee[Ae],Ve=ze.vaos||(ze.vaos={});(Ve[I]||(Ve[I]=new Ns)).bind(n,this,P,te?te.getPaintVertexBuffers():[],O,ze.vertexOffset,ee,ce),ue.drawElements(s,ze.primitiveLength*be,ue.UNSIGNED_SHORT,ze.primitiveOffset*be*2)}}};var cc=function(n,s,o,h){var _=s.style.light,w=_.properties.get("position"),S=[w.x,w.y,w.z],I=a.create$1();_.properties.get("anchor")==="viewport"&&a.fromRotation(I,-s.transform.angle),a.transformMat3(S,S,I);var P=_.properties.get("color");return{u_matrix:n,u_lightpos:S,u_lightintensity:_.properties.get("intensity"),u_lightcolor:[P.r,P.g,P.b],u_vertical_gradient:+o,u_opacity:h}},yo=function(n,s,o,h,_,w,S){return a.extend(cc(n,s,o,h),uc(w,s,S),{u_height_factor:-Math.pow(2,_.overscaledZ)/S.tileSize/8})},Ka=function(n){return{u_matrix:n}},go=function(n,s,o,h){return a.extend(Ka(n),uc(o,s,h))},hc=function(n,s){return{u_matrix:n,u_world:s}},pc=function(n,s,o,h,_){return a.extend(go(n,s,o,h),{u_world:_})},Kl=function(n,s,o,h){var _,w,S=n.transform;if(h.paint.get("circle-pitch-alignment")==="map"){var I=Cr(o,1,S.zoom);_=!0,w=[I,I]}else _=!1,w=S.pixelsToGLUnits;return{u_camera_to_center_distance:S.cameraToCenterDistance,u_scale_with_map:+(h.paint.get("circle-pitch-scale")==="map"),u_matrix:n.translatePosMatrix(s.posMatrix,o,h.paint.get("circle-translate"),h.paint.get("circle-translate-anchor")),u_pitch_with_map:+_,u_device_pixel_ratio:a.browser.devicePixelRatio,u_extrude_scale:w}},_o=function(n,s,o){var h=Cr(o,1,s.zoom),_=Math.pow(2,s.zoom-o.tileID.overscaledZ),w=o.tileID.overscaleFactor();return{u_matrix:n,u_camera_to_center_distance:s.cameraToCenterDistance,u_pixels_to_tile_units:h,u_extrude_scale:[s.pixelsToGLUnits[0]/(h*_),s.pixelsToGLUnits[1]/(h*_)],u_overscale_factor:w}},fc=function(n,s,o){return{u_matrix:n,u_inv_matrix:s,u_camera_to_center_distance:o.cameraToCenterDistance,u_viewport_size:[o.width,o.height]}},vo=function(n,s,o){return o===void 0&&(o=1),{u_matrix:n,u_color:s,u_overlay:0,u_overlay_scale:o}},bo=function(n){return{u_matrix:n}},dc=function(n,s,o,h){return{u_matrix:n,u_extrude_scale:Cr(s,1,o),u_intensity:h}},ls=function(n,s,o){var h=n.transform;return{u_matrix:mc(n,s,o),u_ratio:1/Cr(s,1,h.zoom),u_device_pixel_ratio:a.browser.devicePixelRatio,u_units_to_pixels:[1/h.pixelsToGLUnits[0],1/h.pixelsToGLUnits[1]]}},Nr=function(n,s,o,h){return a.extend(ls(n,s,o),{u_image:0,u_image_height:h})},Vs=function(n,s,o,h){var _=n.transform,w=Fo(s,_);return{u_matrix:mc(n,s,o),u_texsize:s.imageAtlasTexture.size,u_ratio:1/Cr(s,1,_.zoom),u_device_pixel_ratio:a.browser.devicePixelRatio,u_image:0,u_scale:[w,h.fromScale,h.toScale],u_fade:h.t,u_units_to_pixels:[1/_.pixelsToGLUnits[0],1/_.pixelsToGLUnits[1]]}},jh=function(n,s,o,h,_){var w=n.lineAtlas,S=Fo(s,n.transform),I=o.layout.get("line-cap")==="round",P=w.getDash(h.from,I),O=w.getDash(h.to,I),G=P.width*_.fromScale,Z=O.width*_.toScale;return a.extend(ls(n,s,o),{u_patternscale_a:[S/G,-P.height/2],u_patternscale_b:[S/Z,-O.height/2],u_sdfgamma:w.width/(256*Math.min(G,Z)*a.browser.devicePixelRatio)/2,u_image:0,u_tex_y_a:P.y,u_tex_y_b:O.y,u_mix:_.t})};function Fo(n,s){return 1/Cr(n,1,s.tileZoom)}function mc(n,s,o){return n.translatePosMatrix(s.tileID.posMatrix,s,o.paint.get("line-translate"),o.paint.get("line-translate-anchor"))}var Gh=function(n,s,o,h,_){return{u_matrix:n,u_tl_parent:s,u_scale_parent:o,u_buffer_scale:1,u_fade_t:h.mix,u_opacity:h.opacity*_.paint.get("raster-opacity"),u_image0:0,u_image1:1,u_brightness_low:_.paint.get("raster-brightness-min"),u_brightness_high:_.paint.get("raster-brightness-max"),u_saturation_factor:(S=_.paint.get("raster-saturation"),S>0?1-1/(1.001-S):-S),u_contrast_factor:(w=_.paint.get("raster-contrast"),w>0?1/(1-w):1+w),u_spin_weights:yc(_.paint.get("raster-hue-rotate"))};var w,S};function yc(n){n*=Math.PI/180;var s=Math.sin(n),o=Math.cos(n);return[(2*o+1)/3,(-Math.sqrt(3)*s-o+1)/3,(Math.sqrt(3)*s-o+1)/3]}var Us,No=function(n,s,o,h,_,w,S,I,P,O){var G=_.transform;return{u_is_size_zoom_constant:+(n==="constant"||n==="source"),u_is_size_feature_constant:+(n==="constant"||n==="camera"),u_size_t:s?s.uSizeT:0,u_size:s?s.uSize:0,u_camera_to_center_distance:G.cameraToCenterDistance,u_pitch:G.pitch/360*2*Math.PI,u_rotate_symbol:+o,u_aspect_ratio:G.width/G.height,u_fade_change:_.options.fadeDuration?_.symbolFadeChange:1,u_matrix:w,u_label_plane_matrix:S,u_coord_matrix:I,u_is_text:+P,u_pitch_with_map:+h,u_texsize:O,u_texture:0}},us=function(n,s,o,h,_,w,S,I,P,O,G){var Z=_.transform;return a.extend(No(n,s,o,h,_,w,S,I,P,O),{u_gamma_scale:h?Math.cos(Z._pitch)*Z.cameraToCenterDistance:1,u_device_pixel_ratio:a.browser.devicePixelRatio,u_is_halo:+G})},qs=function(n,s,o,h,_,w,S,I,P,O){return a.extend(us(n,s,o,h,_,w,S,I,!0,P,!0),{u_texsize_icon:O,u_texture_icon:1})},cs=function(n,s,o){return{u_matrix:n,u_opacity:s,u_color:o}},Vo=function(n,s,o,h,_,w){return a.extend(function(S,I,P,O){var G=P.imageManager.getPattern(S.from.toString()),Z=P.imageManager.getPattern(S.to.toString()),H=P.imageManager.getPixelSize(),te=H.width,ee=H.height,ce=Math.pow(2,O.tileID.overscaledZ),Y=O.tileSize*Math.pow(2,P.transform.tileZoom)/ce,ue=Y*(O.tileID.canonical.x+O.tileID.wrap*ce),de=Y*O.tileID.canonical.y;return{u_image:0,u_pattern_tl_a:G.tl,u_pattern_br_a:G.br,u_pattern_tl_b:Z.tl,u_pattern_br_b:Z.br,u_texsize:[te,ee],u_mix:I.t,u_pattern_size_a:G.displaySize,u_pattern_size_b:Z.displaySize,u_scale_a:I.fromScale,u_scale_b:I.toScale,u_tile_units_to_pixels:1/Cr(O,1,P.transform.tileZoom),u_pixel_coord_upper:[ue>>16,de>>16],u_pixel_coord_lower:[65535&ue,65535&de]}}(h,w,o,_),{u_matrix:n,u_opacity:s})},gc={fillExtrusion:function(n,s){return{u_matrix:new a.UniformMatrix4f(n,s.u_matrix),u_lightpos:new a.Uniform3f(n,s.u_lightpos),u_lightintensity:new a.Uniform1f(n,s.u_lightintensity),u_lightcolor:new a.Uniform3f(n,s.u_lightcolor),u_vertical_gradient:new a.Uniform1f(n,s.u_vertical_gradient),u_opacity:new a.Uniform1f(n,s.u_opacity)}},fillExtrusionPattern:function(n,s){return{u_matrix:new a.UniformMatrix4f(n,s.u_matrix),u_lightpos:new a.Uniform3f(n,s.u_lightpos),u_lightintensity:new a.Uniform1f(n,s.u_lightintensity),u_lightcolor:new a.Uniform3f(n,s.u_lightcolor),u_vertical_gradient:new a.Uniform1f(n,s.u_vertical_gradient),u_height_factor:new a.Uniform1f(n,s.u_height_factor),u_image:new a.Uniform1i(n,s.u_image),u_texsize:new a.Uniform2f(n,s.u_texsize),u_pixel_coord_upper:new a.Uniform2f(n,s.u_pixel_coord_upper),u_pixel_coord_lower:new a.Uniform2f(n,s.u_pixel_coord_lower),u_scale:new a.Uniform3f(n,s.u_scale),u_fade:new a.Uniform1f(n,s.u_fade),u_opacity:new a.Uniform1f(n,s.u_opacity)}},fill:function(n,s){return{u_matrix:new a.UniformMatrix4f(n,s.u_matrix)}},fillPattern:function(n,s){return{u_matrix:new a.UniformMatrix4f(n,s.u_matrix),u_image:new a.Uniform1i(n,s.u_image),u_texsize:new a.Uniform2f(n,s.u_texsize),u_pixel_coord_upper:new a.Uniform2f(n,s.u_pixel_coord_upper),u_pixel_coord_lower:new a.Uniform2f(n,s.u_pixel_coord_lower),u_scale:new a.Uniform3f(n,s.u_scale),u_fade:new a.Uniform1f(n,s.u_fade)}},fillOutline:function(n,s){return{u_matrix:new a.UniformMatrix4f(n,s.u_matrix),u_world:new a.Uniform2f(n,s.u_world)}},fillOutlinePattern:function(n,s){return{u_matrix:new a.UniformMatrix4f(n,s.u_matrix),u_world:new a.Uniform2f(n,s.u_world),u_image:new a.Uniform1i(n,s.u_image),u_texsize:new a.Uniform2f(n,s.u_texsize),u_pixel_coord_upper:new a.Uniform2f(n,s.u_pixel_coord_upper),u_pixel_coord_lower:new a.Uniform2f(n,s.u_pixel_coord_lower),u_scale:new a.Uniform3f(n,s.u_scale),u_fade:new a.Uniform1f(n,s.u_fade)}},circle:function(n,s){return{u_camera_to_center_distance:new a.Uniform1f(n,s.u_camera_to_center_distance),u_scale_with_map:new a.Uniform1i(n,s.u_scale_with_map),u_pitch_with_map:new a.Uniform1i(n,s.u_pitch_with_map),u_extrude_scale:new a.Uniform2f(n,s.u_extrude_scale),u_device_pixel_ratio:new a.Uniform1f(n,s.u_device_pixel_ratio),u_matrix:new a.UniformMatrix4f(n,s.u_matrix)}},collisionBox:function(n,s){return{u_matrix:new a.UniformMatrix4f(n,s.u_matrix),u_camera_to_center_distance:new a.Uniform1f(n,s.u_camera_to_center_distance),u_pixels_to_tile_units:new a.Uniform1f(n,s.u_pixels_to_tile_units),u_extrude_scale:new a.Uniform2f(n,s.u_extrude_scale),u_overscale_factor:new a.Uniform1f(n,s.u_overscale_factor)}},collisionCircle:function(n,s){return{u_matrix:new a.UniformMatrix4f(n,s.u_matrix),u_inv_matrix:new a.UniformMatrix4f(n,s.u_inv_matrix),u_camera_to_center_distance:new a.Uniform1f(n,s.u_camera_to_center_distance),u_viewport_size:new a.Uniform2f(n,s.u_viewport_size)}},debug:function(n,s){return{u_color:new a.UniformColor(n,s.u_color),u_matrix:new a.UniformMatrix4f(n,s.u_matrix),u_overlay:new a.Uniform1i(n,s.u_overlay),u_overlay_scale:new a.Uniform1f(n,s.u_overlay_scale)}},clippingMask:function(n,s){return{u_matrix:new a.UniformMatrix4f(n,s.u_matrix)}},heatmap:function(n,s){return{u_extrude_scale:new a.Uniform1f(n,s.u_extrude_scale),u_intensity:new a.Uniform1f(n,s.u_intensity),u_matrix:new a.UniformMatrix4f(n,s.u_matrix)}},heatmapTexture:function(n,s){return{u_matrix:new a.UniformMatrix4f(n,s.u_matrix),u_world:new a.Uniform2f(n,s.u_world),u_image:new a.Uniform1i(n,s.u_image),u_color_ramp:new a.Uniform1i(n,s.u_color_ramp),u_opacity:new a.Uniform1f(n,s.u_opacity)}},hillshade:function(n,s){return{u_matrix:new a.UniformMatrix4f(n,s.u_matrix),u_image:new a.Uniform1i(n,s.u_image),u_latrange:new a.Uniform2f(n,s.u_latrange),u_light:new a.Uniform2f(n,s.u_light),u_shadow:new a.UniformColor(n,s.u_shadow),u_highlight:new a.UniformColor(n,s.u_highlight),u_accent:new a.UniformColor(n,s.u_accent)}},hillshadePrepare:function(n,s){return{u_matrix:new a.UniformMatrix4f(n,s.u_matrix),u_image:new a.Uniform1i(n,s.u_image),u_dimension:new a.Uniform2f(n,s.u_dimension),u_zoom:new a.Uniform1f(n,s.u_zoom),u_unpack:new a.Uniform4f(n,s.u_unpack)}},line:function(n,s){return{u_matrix:new a.UniformMatrix4f(n,s.u_matrix),u_ratio:new a.Uniform1f(n,s.u_ratio),u_device_pixel_ratio:new a.Uniform1f(n,s.u_device_pixel_ratio),u_units_to_pixels:new a.Uniform2f(n,s.u_units_to_pixels)}},lineGradient:function(n,s){return{u_matrix:new a.UniformMatrix4f(n,s.u_matrix),u_ratio:new a.Uniform1f(n,s.u_ratio),u_device_pixel_ratio:new a.Uniform1f(n,s.u_device_pixel_ratio),u_units_to_pixels:new a.Uniform2f(n,s.u_units_to_pixels),u_image:new a.Uniform1i(n,s.u_image),u_image_height:new a.Uniform1f(n,s.u_image_height)}},linePattern:function(n,s){return{u_matrix:new a.UniformMatrix4f(n,s.u_matrix),u_texsize:new a.Uniform2f(n,s.u_texsize),u_ratio:new a.Uniform1f(n,s.u_ratio),u_device_pixel_ratio:new a.Uniform1f(n,s.u_device_pixel_ratio),u_image:new a.Uniform1i(n,s.u_image),u_units_to_pixels:new a.Uniform2f(n,s.u_units_to_pixels),u_scale:new a.Uniform3f(n,s.u_scale),u_fade:new a.Uniform1f(n,s.u_fade)}},lineSDF:function(n,s){return{u_matrix:new a.UniformMatrix4f(n,s.u_matrix),u_ratio:new a.Uniform1f(n,s.u_ratio),u_device_pixel_ratio:new a.Uniform1f(n,s.u_device_pixel_ratio),u_units_to_pixels:new a.Uniform2f(n,s.u_units_to_pixels),u_patternscale_a:new a.Uniform2f(n,s.u_patternscale_a),u_patternscale_b:new a.Uniform2f(n,s.u_patternscale_b),u_sdfgamma:new a.Uniform1f(n,s.u_sdfgamma),u_image:new a.Uniform1i(n,s.u_image),u_tex_y_a:new a.Uniform1f(n,s.u_tex_y_a),u_tex_y_b:new a.Uniform1f(n,s.u_tex_y_b),u_mix:new a.Uniform1f(n,s.u_mix)}},raster:function(n,s){return{u_matrix:new a.UniformMatrix4f(n,s.u_matrix),u_tl_parent:new a.Uniform2f(n,s.u_tl_parent),u_scale_parent:new a.Uniform1f(n,s.u_scale_parent),u_buffer_scale:new a.Uniform1f(n,s.u_buffer_scale),u_fade_t:new a.Uniform1f(n,s.u_fade_t),u_opacity:new a.Uniform1f(n,s.u_opacity),u_image0:new a.Uniform1i(n,s.u_image0),u_image1:new a.Uniform1i(n,s.u_image1),u_brightness_low:new a.Uniform1f(n,s.u_brightness_low),u_brightness_high:new a.Uniform1f(n,s.u_brightness_high),u_saturation_factor:new a.Uniform1f(n,s.u_saturation_factor),u_contrast_factor:new a.Uniform1f(n,s.u_contrast_factor),u_spin_weights:new a.Uniform3f(n,s.u_spin_weights)}},symbolIcon:function(n,s){return{u_is_size_zoom_constant:new a.Uniform1i(n,s.u_is_size_zoom_constant),u_is_size_feature_constant:new a.Uniform1i(n,s.u_is_size_feature_constant),u_size_t:new a.Uniform1f(n,s.u_size_t),u_size:new a.Uniform1f(n,s.u_size),u_camera_to_center_distance:new a.Uniform1f(n,s.u_camera_to_center_distance),u_pitch:new a.Uniform1f(n,s.u_pitch),u_rotate_symbol:new a.Uniform1i(n,s.u_rotate_symbol),u_aspect_ratio:new a.Uniform1f(n,s.u_aspect_ratio),u_fade_change:new a.Uniform1f(n,s.u_fade_change),u_matrix:new a.UniformMatrix4f(n,s.u_matrix),u_label_plane_matrix:new a.UniformMatrix4f(n,s.u_label_plane_matrix),u_coord_matrix:new a.UniformMatrix4f(n,s.u_coord_matrix),u_is_text:new a.Uniform1i(n,s.u_is_text),u_pitch_with_map:new a.Uniform1i(n,s.u_pitch_with_map),u_texsize:new a.Uniform2f(n,s.u_texsize),u_texture:new a.Uniform1i(n,s.u_texture)}},symbolSDF:function(n,s){return{u_is_size_zoom_constant:new a.Uniform1i(n,s.u_is_size_zoom_constant),u_is_size_feature_constant:new a.Uniform1i(n,s.u_is_size_feature_constant),u_size_t:new a.Uniform1f(n,s.u_size_t),u_size:new a.Uniform1f(n,s.u_size),u_camera_to_center_distance:new a.Uniform1f(n,s.u_camera_to_center_distance),u_pitch:new a.Uniform1f(n,s.u_pitch),u_rotate_symbol:new a.Uniform1i(n,s.u_rotate_symbol),u_aspect_ratio:new a.Uniform1f(n,s.u_aspect_ratio),u_fade_change:new a.Uniform1f(n,s.u_fade_change),u_matrix:new a.UniformMatrix4f(n,s.u_matrix),u_label_plane_matrix:new a.UniformMatrix4f(n,s.u_label_plane_matrix),u_coord_matrix:new a.UniformMatrix4f(n,s.u_coord_matrix),u_is_text:new a.Uniform1i(n,s.u_is_text),u_pitch_with_map:new a.Uniform1i(n,s.u_pitch_with_map),u_texsize:new a.Uniform2f(n,s.u_texsize),u_texture:new a.Uniform1i(n,s.u_texture),u_gamma_scale:new a.Uniform1f(n,s.u_gamma_scale),u_device_pixel_ratio:new a.Uniform1f(n,s.u_device_pixel_ratio),u_is_halo:new a.Uniform1i(n,s.u_is_halo)}},symbolTextAndIcon:function(n,s){return{u_is_size_zoom_constant:new a.Uniform1i(n,s.u_is_size_zoom_constant),u_is_size_feature_constant:new a.Uniform1i(n,s.u_is_size_feature_constant),u_size_t:new a.Uniform1f(n,s.u_size_t),u_size:new a.Uniform1f(n,s.u_size),u_camera_to_center_distance:new a.Uniform1f(n,s.u_camera_to_center_distance),u_pitch:new a.Uniform1f(n,s.u_pitch),u_rotate_symbol:new a.Uniform1i(n,s.u_rotate_symbol),u_aspect_ratio:new a.Uniform1f(n,s.u_aspect_ratio),u_fade_change:new a.Uniform1f(n,s.u_fade_change),u_matrix:new a.UniformMatrix4f(n,s.u_matrix),u_label_plane_matrix:new a.UniformMatrix4f(n,s.u_label_plane_matrix),u_coord_matrix:new a.UniformMatrix4f(n,s.u_coord_matrix),u_is_text:new a.Uniform1i(n,s.u_is_text),u_pitch_with_map:new a.Uniform1i(n,s.u_pitch_with_map),u_texsize:new a.Uniform2f(n,s.u_texsize),u_texsize_icon:new a.Uniform2f(n,s.u_texsize_icon),u_texture:new a.Uniform1i(n,s.u_texture),u_texture_icon:new a.Uniform1i(n,s.u_texture_icon),u_gamma_scale:new a.Uniform1f(n,s.u_gamma_scale),u_device_pixel_ratio:new a.Uniform1f(n,s.u_device_pixel_ratio),u_is_halo:new a.Uniform1i(n,s.u_is_halo)}},background:function(n,s){return{u_matrix:new a.UniformMatrix4f(n,s.u_matrix),u_opacity:new a.Uniform1f(n,s.u_opacity),u_color:new a.UniformColor(n,s.u_color)}},backgroundPattern:function(n,s){return{u_matrix:new a.UniformMatrix4f(n,s.u_matrix),u_opacity:new a.Uniform1f(n,s.u_opacity),u_image:new a.Uniform1i(n,s.u_image),u_pattern_tl_a:new a.Uniform2f(n,s.u_pattern_tl_a),u_pattern_br_a:new a.Uniform2f(n,s.u_pattern_br_a),u_pattern_tl_b:new a.Uniform2f(n,s.u_pattern_tl_b),u_pattern_br_b:new a.Uniform2f(n,s.u_pattern_br_b),u_texsize:new a.Uniform2f(n,s.u_texsize),u_mix:new a.Uniform1f(n,s.u_mix),u_pattern_size_a:new a.Uniform2f(n,s.u_pattern_size_a),u_pattern_size_b:new a.Uniform2f(n,s.u_pattern_size_b),u_scale_a:new a.Uniform1f(n,s.u_scale_a),u_scale_b:new a.Uniform1f(n,s.u_scale_b),u_pixel_coord_upper:new a.Uniform2f(n,s.u_pixel_coord_upper),u_pixel_coord_lower:new a.Uniform2f(n,s.u_pixel_coord_lower),u_tile_units_to_pixels:new a.Uniform1f(n,s.u_tile_units_to_pixels)}}};function Uo(n,s,o,h,_,w,S){for(var I=n.context,P=I.gl,O=n.useProgram("collisionBox"),G=[],Z=0,H=0,te=0;te<h.length;te++){var ee=h[te],ce=s.getTile(ee),Y=ce.getBucket(o);if(Y){var ue=ee.posMatrix;_[0]===0&&_[1]===0||(ue=n.translatePosMatrix(ee.posMatrix,ce,_,w));var de=S?Y.textCollisionBox:Y.iconCollisionBox,be=Y.collisionCircleArray;if(be.length>0){var Ae=a.create(),Ee=ue;a.mul(Ae,Y.placementInvProjMatrix,n.transform.glCoordMatrix),a.mul(Ae,Ae,Y.placementViewportMatrix),G.push({circleArray:be,circleOffset:H,transform:Ee,invTransform:Ae}),H=Z+=be.length/4}de&&O.draw(I,P.LINES,K.disabled,W.disabled,n.colorModeForRenderPass(),fe.disabled,_o(ue,n.transform,ce),o.id,de.layoutVertexBuffer,de.indexBuffer,de.segments,null,n.transform.zoom,null,null,de.collisionVertexBuffer)}}if(S&&G.length){var ze=n.useProgram("collisionCircle"),Ve=new a.StructArrayLayout2f1f2i16;Ve.resize(4*Z),Ve._trim();for(var Qe=0,We=0,ft=G;We<ft.length;We+=1)for(var Tt=ft[We],Dt=0;Dt<Tt.circleArray.length/4;Dt++){var Mt=4*Dt,gr=Tt.circleArray[Mt+0],dt=Tt.circleArray[Mt+1],qt=Tt.circleArray[Mt+2],Jt=Tt.circleArray[Mt+3];Ve.emplace(Qe++,gr,dt,qt,Jt,0),Ve.emplace(Qe++,gr,dt,qt,Jt,1),Ve.emplace(Qe++,gr,dt,qt,Jt,2),Ve.emplace(Qe++,gr,dt,qt,Jt,3)}(!Us||Us.length<2*Z)&&(Us=function(si){var pn=2*si,Hi=new a.StructArrayLayout3ui6;Hi.resize(pn),Hi._trim();for(var ri=0;ri<pn;ri++){var di=6*ri;Hi.uint16[di+0]=4*ri+0,Hi.uint16[di+1]=4*ri+1,Hi.uint16[di+2]=4*ri+2,Hi.uint16[di+3]=4*ri+2,Hi.uint16[di+4]=4*ri+3,Hi.uint16[di+5]=4*ri+0}return Hi}(Z));for(var Vt=I.createIndexBuffer(Us,!0),Nt=I.createVertexBuffer(Ve,a.collisionCircleLayout.members,!0),Wt=0,Ot=G;Wt<Ot.length;Wt+=1){var Rt=Ot[Wt],Oi=fc(Rt.transform,Rt.invTransform,n.transform);ze.draw(I,P.TRIANGLES,K.disabled,W.disabled,n.colorModeForRenderPass(),fe.disabled,Oi,o.id,Nt,Vt,a.SegmentVector.simpleSegment(0,2*Rt.circleOffset,Rt.circleArray.length,Rt.circleArray.length/2),null,n.transform.zoom,null,null,null)}Nt.destroy(),Vt.destroy()}}var fa=a.identity(new Float32Array(16));function _c(n,s,o,h,_,w){var S=a.getAnchorAlignment(n),I=-(S.horizontalAlign-.5)*s,P=-(S.verticalAlign-.5)*o,O=a.evaluateVariableOffset(n,h);return new a.Point((I/_+O[0])*w,(P/_+O[1])*w)}function vc(n,s,o,h,_,w,S,I,P,O,G){var Z=n.text.placedSymbolArray,H=n.text.dynamicLayoutVertexArray,te=n.icon.dynamicLayoutVertexArray,ee={};H.clear();for(var ce=0;ce<Z.length;ce++){var Y=Z.get(ce),ue=Y.hidden||!Y.crossTileID||n.allowVerticalPlacement&&!Y.placedOrientation?null:h[Y.crossTileID];if(ue){var de=new a.Point(Y.anchorX,Y.anchorY),be=Qt(de,o?I:S),Ae=fr(w.cameraToCenterDistance,be.signedDistanceFromCamera),Ee=_.evaluateSizeForFeature(n.textSizeData,O,Y)*Ae/a.ONE_EM;o&&(Ee*=n.tilePixelRatio/P);for(var ze=_c(ue.anchor,ue.width,ue.height,ue.textOffset,ue.textBoxScale,Ee),Ve=o?Qt(de.add(ze),S).point:be.point.add(s?ze.rotate(-w.angle):ze),Qe=n.allowVerticalPlacement&&Y.placedOrientation===a.WritingMode.vertical?Math.PI/2:0,We=0;We<Y.numGlyphs;We++)a.addDynamicAttributes(H,Ve,Qe);G&&Y.associatedIconIndex>=0&&(ee[Y.associatedIconIndex]={shiftedAnchor:Ve,angle:Qe})}else Ii(Y.numGlyphs,H)}if(G){te.clear();for(var ft=n.icon.placedSymbolArray,Tt=0;Tt<ft.length;Tt++){var Dt=ft.get(Tt);if(Dt.hidden)Ii(Dt.numGlyphs,te);else{var Mt=ee[Tt];if(Mt)for(var gr=0;gr<Dt.numGlyphs;gr++)a.addDynamicAttributes(te,Mt.shiftedAnchor,Mt.angle);else Ii(Dt.numGlyphs,te)}}n.icon.dynamicLayoutVertexBuffer.updateData(te)}n.text.dynamicLayoutVertexBuffer.updateData(H)}function bc(n,s,o){return o.iconsInText&&s?"symbolTextAndIcon":n?"symbolSDF":"symbolIcon"}function xo(n,s,o,h,_,w,S,I,P,O,G,Z){for(var H=n.context,te=H.gl,ee=n.transform,ce=I==="map",Y=P==="map",ue=ce&&o.layout.get("symbol-placement")!=="point",de=ce&&!Y&&!ue,be=o.layout.get("symbol-sort-key").constantOr(1)!==void 0,Ae=!1,Ee=n.depthModeForSublayer(0,K.ReadOnly),ze=o.layout.get("text-variable-anchor"),Ve=[],Qe=0,We=h;Qe<We.length;Qe+=1){var ft=We[Qe],Tt=s.getTile(ft),Dt=Tt.getBucket(o);if(Dt){var Mt=_?Dt.text:Dt.icon;if(Mt&&Mt.segments.get().length){var gr=Mt.programConfigurations.get(o.id),dt=_||Dt.sdfIcons,qt=_?Dt.textSizeData:Dt.iconSizeData,Jt=Y||ee.pitch!==0,Vt=n.useProgram(bc(dt,_,Dt),gr),Nt=a.evaluateSizeForZoom(qt,ee.zoom),Wt=void 0,Ot=[0,0],Rt=void 0,Oi=void 0,si=null,pn=void 0;if(_)Rt=Tt.glyphAtlasTexture,Oi=te.LINEAR,Wt=Tt.glyphAtlasTexture.size,Dt.iconsInText&&(Ot=Tt.imageAtlasTexture.size,si=Tt.imageAtlasTexture,pn=Jt||n.options.rotating||n.options.zooming||qt.kind==="composite"||qt.kind==="camera"?te.LINEAR:te.NEAREST);else{var Hi=o.layout.get("icon-size").constantOr(0)!==1||Dt.iconsNeedLinear;Rt=Tt.imageAtlasTexture,Oi=dt||n.options.rotating||n.options.zooming||Hi||Jt?te.LINEAR:te.NEAREST,Wt=Tt.imageAtlasTexture.size}var ri=Cr(Tt,1,n.transform.zoom),di=Fr(ft.posMatrix,Y,ce,n.transform,ri),Zn=vr(ft.posMatrix,Y,ce,n.transform,ri),vn=ze&&Dt.hasTextData(),Qa=o.layout.get("icon-text-fit")!=="none"&&vn&&Dt.hasIconData();ue&&pa(Dt,ft.posMatrix,n,_,di,Zn,Y,O);var Cn=n.translatePosMatrix(ft.posMatrix,Tt,w,S),_a=ue||_&&ze||Qa?fa:di,oa=n.translatePosMatrix(Zn,Tt,w,S,!0),ws=dt&&o.paint.get(_?"text-halo-width":"icon-halo-width").constantOr(1)!==0,Ho={program:Vt,buffers:Mt,uniformValues:dt?Dt.iconsInText?qs(qt.kind,Nt,de,Y,n,Cn,_a,oa,Wt,Ot):us(qt.kind,Nt,de,Y,n,Cn,_a,oa,_,Wt,!0):No(qt.kind,Nt,de,Y,n,Cn,_a,oa,_,Wt),atlasTexture:Rt,atlasTextureIcon:si,atlasInterpolation:Oi,atlasInterpolationIcon:pn,isSDF:dt,hasHalo:ws};if(be&&Dt.canOverlap){Ae=!0;for(var $a=0,Xo=Mt.segments.get();$a<Xo.length;$a+=1){var Ss=Xo[$a];Ve.push({segments:new a.SegmentVector([Ss]),sortKey:Ss.sortKey,state:Ho})}}else Ve.push({segments:Mt.segments,sortKey:0,state:Ho})}}}Ae&&Ve.sort(function(eo,Io){return eo.sortKey-Io.sortKey});for(var Aa=0,ks=Ve;Aa<ks.length;Aa+=1){var za=ks[Aa],Fi=za.state;if(H.activeTexture.set(te.TEXTURE0),Fi.atlasTexture.bind(Fi.atlasInterpolation,te.CLAMP_TO_EDGE),Fi.atlasTextureIcon&&(H.activeTexture.set(te.TEXTURE1),Fi.atlasTextureIcon&&Fi.atlasTextureIcon.bind(Fi.atlasInterpolationIcon,te.CLAMP_TO_EDGE)),Fi.isSDF){var La=Fi.uniformValues;Fi.hasHalo&&(La.u_is_halo=1,hs(Fi.buffers,za.segments,o,n,Fi.program,Ee,G,Z,La)),La.u_is_halo=0}hs(Fi.buffers,za.segments,o,n,Fi.program,Ee,G,Z,Fi.uniformValues)}}function hs(n,s,o,h,_,w,S,I,P){var O=h.context;_.draw(O,O.gl.TRIANGLES,w,S,I,fe.disabled,P,o.id,n.layoutVertexBuffer,n.indexBuffer,s,o.paint,h.transform.zoom,n.programConfigurations.get(o.id),n.dynamicLayoutVertexBuffer,n.opacityVertexBuffer)}function js(n,s,o,h,_,w,S){var I,P,O,G,Z,H=n.context.gl,te=o.paint.get("fill-pattern"),ee=te&&te.constantOr(1),ce=o.getCrossfadeParameters();S?(P=ee&&!o.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline",I=H.LINES):(P=ee?"fillPattern":"fill",I=H.TRIANGLES);for(var Y=0,ue=h;Y<ue.length;Y+=1){var de=ue[Y],be=s.getTile(de);if(!ee||be.patternsLoaded()){var Ae=be.getBucket(o);if(Ae){var Ee=Ae.programConfigurations.get(o.id),ze=n.useProgram(P,Ee);ee&&(n.context.activeTexture.set(H.TEXTURE0),be.imageAtlasTexture.bind(H.LINEAR,H.CLAMP_TO_EDGE),Ee.updatePaintBuffers(ce));var Ve=te.constantOr(null);if(Ve&&be.imageAtlas){var Qe=be.imageAtlas,We=Qe.patternPositions[Ve.to.toString()],ft=Qe.patternPositions[Ve.from.toString()];We&&ft&&Ee.setConstantPatternPositions(We,ft)}var Tt=n.translatePosMatrix(de.posMatrix,be,o.paint.get("fill-translate"),o.paint.get("fill-translate-anchor"));if(S){G=Ae.indexBuffer2,Z=Ae.segments2;var Dt=[H.drawingBufferWidth,H.drawingBufferHeight];O=P==="fillOutlinePattern"&&ee?pc(Tt,n,ce,be,Dt):hc(Tt,Dt)}else G=Ae.indexBuffer,Z=Ae.segments,O=ee?go(Tt,n,ce,be):Ka(Tt);ze.draw(n.context,I,_,n.stencilModeForClipping(de),w,fe.disabled,O,o.id,Ae.layoutVertexBuffer,G,Z,o.paint,n.transform.zoom,Ee)}}}}function Hl(n,s,o,h,_,w,S){for(var I=n.context,P=I.gl,O=o.paint.get("fill-extrusion-pattern"),G=O.constantOr(1),Z=o.getCrossfadeParameters(),H=o.paint.get("fill-extrusion-opacity"),te=0,ee=h;te<ee.length;te+=1){var ce=ee[te],Y=s.getTile(ce),ue=Y.getBucket(o);if(ue){var de=ue.programConfigurations.get(o.id),be=n.useProgram(G?"fillExtrusionPattern":"fillExtrusion",de);G&&(n.context.activeTexture.set(P.TEXTURE0),Y.imageAtlasTexture.bind(P.LINEAR,P.CLAMP_TO_EDGE),de.updatePaintBuffers(Z));var Ae=O.constantOr(null);if(Ae&&Y.imageAtlas){var Ee=Y.imageAtlas,ze=Ee.patternPositions[Ae.to.toString()],Ve=Ee.patternPositions[Ae.from.toString()];ze&&Ve&&de.setConstantPatternPositions(ze,Ve)}var Qe=n.translatePosMatrix(ce.posMatrix,Y,o.paint.get("fill-extrusion-translate"),o.paint.get("fill-extrusion-translate-anchor")),We=o.paint.get("fill-extrusion-vertical-gradient"),ft=G?yo(Qe,n,We,H,ce,Z,Y):cc(Qe,n,We,H);be.draw(I,I.gl.TRIANGLES,_,w,S,fe.backCCW,ft,o.id,ue.layoutVertexBuffer,ue.indexBuffer,ue.segments,o.paint,n.transform.zoom,de)}}}function Gs(n,s,o,h,_,w){var S=n.context,I=S.gl,P=s.fbo;if(P){var O=n.useProgram("hillshade");S.activeTexture.set(I.TEXTURE0),I.bindTexture(I.TEXTURE_2D,P.colorAttachment.get());var G=function(Z,H,te){var ee=te.paint.get("hillshade-shadow-color"),ce=te.paint.get("hillshade-highlight-color"),Y=te.paint.get("hillshade-accent-color"),ue=te.paint.get("hillshade-illumination-direction")*(Math.PI/180);te.paint.get("hillshade-illumination-anchor")==="viewport"&&(ue-=Z.transform.angle);var de,be,Ae,Ee=!Z.options.moving;return{u_matrix:Z.transform.calculatePosMatrix(H.tileID.toUnwrapped(),Ee),u_image:0,u_latrange:(de=H.tileID,be=Math.pow(2,de.canonical.z),Ae=de.canonical.y,[new a.MercatorCoordinate(0,Ae/be).toLngLat().lat,new a.MercatorCoordinate(0,(Ae+1)/be).toLngLat().lat]),u_light:[te.paint.get("hillshade-exaggeration"),ue],u_shadow:ee,u_highlight:ce,u_accent:Y}}(n,s,o);O.draw(S,I.TRIANGLES,h,_,w,fe.disabled,G,o.id,n.rasterBoundsBuffer,n.quadTriangleIndexBuffer,n.rasterBoundsSegments)}}function Zh(n,s,o,h,_,w){var S=n.context,I=S.gl,P=s.dem;if(P&&P.data){var O=P.dim,G=P.stride,Z=P.getPixels();if(S.activeTexture.set(I.TEXTURE1),S.pixelStoreUnpackPremultiplyAlpha.set(!1),s.demTexture=s.demTexture||n.getTileTexture(G),s.demTexture){var H=s.demTexture;H.update(Z,{premultiply:!1}),H.bind(I.NEAREST,I.CLAMP_TO_EDGE)}else s.demTexture=new a.Texture(S,Z,I.RGBA,{premultiply:!1}),s.demTexture.bind(I.NEAREST,I.CLAMP_TO_EDGE);S.activeTexture.set(I.TEXTURE0);var te=s.fbo;if(!te){var ee=new a.Texture(S,{width:O,height:O,data:null},I.RGBA);ee.bind(I.LINEAR,I.CLAMP_TO_EDGE),(te=s.fbo=S.createFramebuffer(O,O,!0)).colorAttachment.set(ee.texture)}S.bindFramebuffer.set(te.framebuffer),S.viewport.set([0,0,O,O]),n.useProgram("hillshadePrepare").draw(S,I.TRIANGLES,h,_,w,fe.disabled,function(ce,Y){var ue=Y.stride,de=a.create();return a.ortho(de,0,a.EXTENT,-a.EXTENT,0,0,1),a.translate(de,de,[0,-a.EXTENT,0]),{u_matrix:de,u_image:1,u_dimension:[ue,ue],u_zoom:ce.overscaledZ,u_unpack:Y.getUnpackVector()}}(s.tileID,P),o.id,n.rasterBoundsBuffer,n.quadTriangleIndexBuffer,n.rasterBoundsSegments),s.needsHillshadePrepare=!1}}function Zs(n,s,o,h,_){var w=h.paint.get("raster-fade-duration");if(w>0){var S=a.browser.now(),I=(S-n.timeAdded)/w,P=s?(S-s.timeAdded)/w:-1,O=o.getSource(),G=_.coveringZoomLevel({tileSize:O.tileSize,roundZoom:O.roundZoom}),Z=!s||Math.abs(s.tileID.overscaledZ-G)>Math.abs(n.tileID.overscaledZ-G),H=Z&&n.refreshedUponExpiration?1:a.clamp(Z?I:1-P,0,1);return n.refreshedUponExpiration&&I>=1&&(n.refreshedUponExpiration=!1),s?{opacity:1,mix:1-H}:{opacity:H,mix:0}}return{opacity:1,mix:0}}var Xl=new a.Color(1,0,0,1),xc=new a.Color(0,1,0,1),wc=new a.Color(0,0,1,1),Ks=new a.Color(1,0,1,1),Wl=new a.Color(0,1,1,1);function Yl(n,s,o,h){ps(n,0,s+o/2,n.transform.width,o,h)}function Jl(n,s,o,h){ps(n,s-o/2,0,o,n.transform.height,h)}function ps(n,s,o,h,_,w){var S=n.context,I=S.gl;I.enable(I.SCISSOR_TEST),I.scissor(s*a.browser.devicePixelRatio,o*a.browser.devicePixelRatio,h*a.browser.devicePixelRatio,_*a.browser.devicePixelRatio),S.clear({color:w}),I.disable(I.SCISSOR_TEST)}function Sc(n,s,o){var h=n.context,_=h.gl,w=o.posMatrix,S=n.useProgram("debug"),I=K.disabled,P=W.disabled,O=n.colorModeForRenderPass();h.activeTexture.set(_.TEXTURE0),n.emptyTexture.bind(_.LINEAR,_.CLAMP_TO_EDGE),S.draw(h,_.LINE_STRIP,I,P,O,fe.disabled,vo(w,a.Color.red),"$debug",n.debugBuffer,n.tileBorderIndexBuffer,n.debugSegments);var G=s.getTileByID(o.key).latestRawTileData,Z=Math.floor((G&&G.byteLength||0)/1024),H=s.getTile(o).tileSize,te=512/Math.min(H,512)*(o.overscaledZ/n.transform.zoom)*.5,ee=o.canonical.toString();o.overscaledZ!==o.canonical.z&&(ee+=" => "+o.overscaledZ),function(ce,Y){ce.initDebugOverlayCanvas();var ue=ce.debugOverlayCanvas,de=ce.context.gl,be=ce.debugOverlayCanvas.getContext("2d");be.clearRect(0,0,ue.width,ue.height),be.shadowColor="white",be.shadowBlur=2,be.lineWidth=1.5,be.strokeStyle="white",be.textBaseline="top",be.font="bold 36px Open Sans, sans-serif",be.fillText(Y,5,5),be.strokeText(Y,5,5),ce.debugOverlayTexture.update(ue),ce.debugOverlayTexture.bind(de.LINEAR,de.CLAMP_TO_EDGE)}(n,ee+" "+Z+"kb"),S.draw(h,_.TRIANGLES,I,P,le.alphaBlended,fe.disabled,vo(w,a.Color.transparent,te),"$debug",n.debugBuffer,n.quadTriangleIndexBuffer,n.debugSegments)}var wo={symbol:function(n,s,o,h,_){if(n.renderPass==="translucent"){var w=W.disabled,S=n.colorModeForRenderPass();o.layout.get("text-variable-anchor")&&function(I,P,O,G,Z,H,te){for(var ee=P.transform,ce=Z==="map",Y=H==="map",ue=0,de=I;ue<de.length;ue+=1){var be=de[ue],Ae=G.getTile(be),Ee=Ae.getBucket(O);if(Ee&&Ee.text&&Ee.text.segments.get().length){var ze=a.evaluateSizeForZoom(Ee.textSizeData,ee.zoom),Ve=Cr(Ae,1,P.transform.zoom),Qe=Fr(be.posMatrix,Y,ce,P.transform,Ve),We=O.layout.get("icon-text-fit")!=="none"&&Ee.hasIconData();if(ze){var ft=Math.pow(2,ee.zoom-Ae.tileID.overscaledZ);vc(Ee,ce,Y,te,a.symbolSize,ee,Qe,be.posMatrix,ft,ze,We)}}}}(h,n,o,s,o.layout.get("text-rotation-alignment"),o.layout.get("text-pitch-alignment"),_),o.paint.get("icon-opacity").constantOr(1)!==0&&xo(n,s,o,h,!1,o.paint.get("icon-translate"),o.paint.get("icon-translate-anchor"),o.layout.get("icon-rotation-alignment"),o.layout.get("icon-pitch-alignment"),o.layout.get("icon-keep-upright"),w,S),o.paint.get("text-opacity").constantOr(1)!==0&&xo(n,s,o,h,!0,o.paint.get("text-translate"),o.paint.get("text-translate-anchor"),o.layout.get("text-rotation-alignment"),o.layout.get("text-pitch-alignment"),o.layout.get("text-keep-upright"),w,S),s.map.showCollisionBoxes&&(Uo(n,s,o,h,o.paint.get("text-translate"),o.paint.get("text-translate-anchor"),!0),Uo(n,s,o,h,o.paint.get("icon-translate"),o.paint.get("icon-translate-anchor"),!1))}},circle:function(n,s,o,h){if(n.renderPass==="translucent"){var _=o.paint.get("circle-opacity"),w=o.paint.get("circle-stroke-width"),S=o.paint.get("circle-stroke-opacity"),I=o.layout.get("circle-sort-key").constantOr(1)!==void 0;if(_.constantOr(1)!==0||w.constantOr(1)!==0&&S.constantOr(1)!==0){for(var P=n.context,O=P.gl,G=n.depthModeForSublayer(0,K.ReadOnly),Z=W.disabled,H=n.colorModeForRenderPass(),te=[],ee=0;ee<h.length;ee++){var ce=h[ee],Y=s.getTile(ce),ue=Y.getBucket(o);if(ue){var de=ue.programConfigurations.get(o.id),be={programConfiguration:de,program:n.useProgram("circle",de),layoutVertexBuffer:ue.layoutVertexBuffer,indexBuffer:ue.indexBuffer,uniformValues:Kl(n,ce,Y,o)};if(I)for(var Ae=0,Ee=ue.segments.get();Ae<Ee.length;Ae+=1){var ze=Ee[Ae];te.push({segments:new a.SegmentVector([ze]),sortKey:ze.sortKey,state:be})}else te.push({segments:ue.segments,sortKey:0,state:be})}}I&&te.sort(function(Tt,Dt){return Tt.sortKey-Dt.sortKey});for(var Ve=0,Qe=te;Ve<Qe.length;Ve+=1){var We=Qe[Ve],ft=We.state;ft.program.draw(P,O.TRIANGLES,G,Z,H,fe.disabled,ft.uniformValues,o.id,ft.layoutVertexBuffer,ft.indexBuffer,We.segments,o.paint,n.transform.zoom,ft.programConfiguration)}}}},heatmap:function(n,s,o,h){if(o.paint.get("heatmap-opacity")!==0)if(n.renderPass==="offscreen"){var _=n.context,w=_.gl,S=W.disabled,I=new le([w.ONE,w.ONE],a.Color.transparent,[!0,!0,!0,!0]);(function(te,ee,ce){var Y=te.gl;te.activeTexture.set(Y.TEXTURE1),te.viewport.set([0,0,ee.width/4,ee.height/4]);var ue=ce.heatmapFbo;if(ue)Y.bindTexture(Y.TEXTURE_2D,ue.colorAttachment.get()),te.bindFramebuffer.set(ue.framebuffer);else{var de=Y.createTexture();Y.bindTexture(Y.TEXTURE_2D,de),Y.texParameteri(Y.TEXTURE_2D,Y.TEXTURE_WRAP_S,Y.CLAMP_TO_EDGE),Y.texParameteri(Y.TEXTURE_2D,Y.TEXTURE_WRAP_T,Y.CLAMP_TO_EDGE),Y.texParameteri(Y.TEXTURE_2D,Y.TEXTURE_MIN_FILTER,Y.LINEAR),Y.texParameteri(Y.TEXTURE_2D,Y.TEXTURE_MAG_FILTER,Y.LINEAR),ue=ce.heatmapFbo=te.createFramebuffer(ee.width/4,ee.height/4,!1),function(be,Ae,Ee,ze){var Ve=be.gl;Ve.texImage2D(Ve.TEXTURE_2D,0,Ve.RGBA,Ae.width/4,Ae.height/4,0,Ve.RGBA,be.extRenderToTextureHalfFloat?be.extTextureHalfFloat.HALF_FLOAT_OES:Ve.UNSIGNED_BYTE,null),ze.colorAttachment.set(Ee)}(te,ee,de,ue)}})(_,n,o),_.clear({color:a.Color.transparent});for(var P=0;P<h.length;P++){var O=h[P];if(!s.hasRenderableParent(O)){var G=s.getTile(O),Z=G.getBucket(o);if(Z){var H=Z.programConfigurations.get(o.id);n.useProgram("heatmap",H).draw(_,w.TRIANGLES,K.disabled,S,I,fe.disabled,dc(O.posMatrix,G,n.transform.zoom,o.paint.get("heatmap-intensity")),o.id,Z.layoutVertexBuffer,Z.indexBuffer,Z.segments,o.paint,n.transform.zoom,H)}}}_.viewport.set([0,0,n.width,n.height])}else n.renderPass==="translucent"&&(n.context.setColorMode(n.colorModeForRenderPass()),function(te,ee){var ce=te.context,Y=ce.gl,ue=ee.heatmapFbo;if(ue){ce.activeTexture.set(Y.TEXTURE0),Y.bindTexture(Y.TEXTURE_2D,ue.colorAttachment.get()),ce.activeTexture.set(Y.TEXTURE1);var de=ee.colorRampTexture;de||(de=ee.colorRampTexture=new a.Texture(ce,ee.colorRamp,Y.RGBA)),de.bind(Y.LINEAR,Y.CLAMP_TO_EDGE),te.useProgram("heatmapTexture").draw(ce,Y.TRIANGLES,K.disabled,W.disabled,te.colorModeForRenderPass(),fe.disabled,function(be,Ae,Ee,ze){var Ve=a.create();a.ortho(Ve,0,be.width,be.height,0,0,1);var Qe=be.context.gl;return{u_matrix:Ve,u_world:[Qe.drawingBufferWidth,Qe.drawingBufferHeight],u_image:0,u_color_ramp:1,u_opacity:Ae.paint.get("heatmap-opacity")}}(te,ee),ee.id,te.viewportBuffer,te.quadTriangleIndexBuffer,te.viewportSegments,ee.paint,te.transform.zoom)}}(n,o))},line:function(n,s,o,h){if(n.renderPass==="translucent"){var _=o.paint.get("line-opacity"),w=o.paint.get("line-width");if(_.constantOr(1)!==0&&w.constantOr(1)!==0)for(var S=n.depthModeForSublayer(0,K.ReadOnly),I=n.colorModeForRenderPass(),P=o.paint.get("line-dasharray"),O=o.paint.get("line-pattern"),G=O.constantOr(1),Z=o.paint.get("line-gradient"),H=o.getCrossfadeParameters(),te=G?"linePattern":P?"lineSDF":Z?"lineGradient":"line",ee=n.context,ce=ee.gl,Y=!0,ue=0,de=h;ue<de.length;ue+=1){var be=de[ue],Ae=s.getTile(be);if(!G||Ae.patternsLoaded()){var Ee=Ae.getBucket(o);if(Ee){var ze=Ee.programConfigurations.get(o.id),Ve=n.context.program.get(),Qe=n.useProgram(te,ze),We=Y||Qe.program!==Ve,ft=O.constantOr(null);if(ft&&Ae.imageAtlas){var Tt=Ae.imageAtlas,Dt=Tt.patternPositions[ft.to.toString()],Mt=Tt.patternPositions[ft.from.toString()];Dt&&Mt&&ze.setConstantPatternPositions(Dt,Mt)}var gr=G?Vs(n,Ae,o,H):P?jh(n,Ae,o,P,H):Z?Nr(n,Ae,o,Ee.lineClipsArray.length):ls(n,Ae,o);if(G)ee.activeTexture.set(ce.TEXTURE0),Ae.imageAtlasTexture.bind(ce.LINEAR,ce.CLAMP_TO_EDGE),ze.updatePaintBuffers(H);else if(P&&(We||n.lineAtlas.dirty))ee.activeTexture.set(ce.TEXTURE0),n.lineAtlas.bind(ee);else if(Z){var dt=Ee.gradients[o.id],qt=dt.texture;if(o.gradientVersion!==dt.version){var Jt=256;if(o.stepInterpolant){var Vt=s.getSource().maxzoom,Nt=be.canonical.z===Vt?Math.ceil(1<<n.transform.maxZoom-be.canonical.z):1;Jt=a.clamp(a.nextPowerOfTwo(Ee.maxLineLength/a.EXTENT*1024*Nt),256,ee.maxTextureSize)}dt.gradient=a.renderColorRamp({expression:o.gradientExpression(),evaluationKey:"lineProgress",resolution:Jt,image:dt.gradient||void 0,clips:Ee.lineClipsArray}),dt.texture?dt.texture.update(dt.gradient):dt.texture=new a.Texture(ee,dt.gradient,ce.RGBA),dt.version=o.gradientVersion,qt=dt.texture}ee.activeTexture.set(ce.TEXTURE0),qt.bind(o.stepInterpolant?ce.NEAREST:ce.LINEAR,ce.CLAMP_TO_EDGE)}Qe.draw(ee,ce.TRIANGLES,S,n.stencilModeForClipping(be),I,fe.disabled,gr,o.id,Ee.layoutVertexBuffer,Ee.indexBuffer,Ee.segments,o.paint,n.transform.zoom,ze,Ee.layoutVertexBuffer2),Y=!1}}}}},fill:function(n,s,o,h){var _=o.paint.get("fill-color"),w=o.paint.get("fill-opacity");if(w.constantOr(1)!==0){var S=n.colorModeForRenderPass(),I=o.paint.get("fill-pattern"),P=n.opaquePassEnabledForLayer()&&!I.constantOr(1)&&_.constantOr(a.Color.transparent).a===1&&w.constantOr(0)===1?"opaque":"translucent";if(n.renderPass===P){var O=n.depthModeForSublayer(1,n.renderPass==="opaque"?K.ReadWrite:K.ReadOnly);js(n,s,o,h,O,S,!1)}if(n.renderPass==="translucent"&&o.paint.get("fill-antialias")){var G=n.depthModeForSublayer(o.getPaintProperty("fill-outline-color")?2:0,K.ReadOnly);js(n,s,o,h,G,S,!0)}}},"fill-extrusion":function(n,s,o,h){var _=o.paint.get("fill-extrusion-opacity");if(_!==0&&n.renderPass==="translucent"){var w=new K(n.context.gl.LEQUAL,K.ReadWrite,n.depthRangeFor3D);if(_!==1||o.paint.get("fill-extrusion-pattern").constantOr(1))Hl(n,s,o,h,w,W.disabled,le.disabled),Hl(n,s,o,h,w,n.stencilModeFor3D(),n.colorModeForRenderPass());else{var S=n.colorModeForRenderPass();Hl(n,s,o,h,w,W.disabled,S)}}},hillshade:function(n,s,o,h){if(n.renderPass==="offscreen"||n.renderPass==="translucent"){for(var _=n.context,w=n.depthModeForSublayer(0,K.ReadOnly),S=n.colorModeForRenderPass(),I=n.renderPass==="translucent"?n.stencilConfigForOverlap(h):[{},h],P=I[0],O=0,G=I[1];O<G.length;O+=1){var Z=G[O],H=s.getTile(Z);H.needsHillshadePrepare&&n.renderPass==="offscreen"?Zh(n,H,o,w,W.disabled,S):n.renderPass==="translucent"&&Gs(n,H,o,w,P[Z.overscaledZ],S)}_.viewport.set([0,0,n.width,n.height])}},raster:function(n,s,o,h){if(n.renderPass==="translucent"&&o.paint.get("raster-opacity")!==0&&h.length)for(var _=n.context,w=_.gl,S=s.getSource(),I=n.useProgram("raster"),P=n.colorModeForRenderPass(),O=S instanceof ot?[{},h]:n.stencilConfigForOverlap(h),G=O[0],Z=O[1],H=Z[Z.length-1].overscaledZ,te=!n.options.moving,ee=0,ce=Z;ee<ce.length;ee+=1){var Y=ce[ee],ue=n.depthModeForSublayer(Y.overscaledZ-H,o.paint.get("raster-opacity")===1?K.ReadWrite:K.ReadOnly,w.LESS),de=s.getTile(Y),be=n.transform.calculatePosMatrix(Y.toUnwrapped(),te);de.registerFadeDuration(o.paint.get("raster-fade-duration"));var Ae=s.findLoadedParent(Y,0),Ee=Zs(de,Ae,s,o,n.transform),ze=void 0,Ve=void 0,Qe=o.paint.get("raster-resampling")==="nearest"?w.NEAREST:w.LINEAR;_.activeTexture.set(w.TEXTURE0),de.texture.bind(Qe,w.CLAMP_TO_EDGE,w.LINEAR_MIPMAP_NEAREST),_.activeTexture.set(w.TEXTURE1),Ae?(Ae.texture.bind(Qe,w.CLAMP_TO_EDGE,w.LINEAR_MIPMAP_NEAREST),ze=Math.pow(2,Ae.tileID.overscaledZ-de.tileID.overscaledZ),Ve=[de.tileID.canonical.x*ze%1,de.tileID.canonical.y*ze%1]):de.texture.bind(Qe,w.CLAMP_TO_EDGE,w.LINEAR_MIPMAP_NEAREST);var We=Gh(be,Ve||[0,0],ze||1,Ee,o);S instanceof ot?I.draw(_,w.TRIANGLES,ue,W.disabled,P,fe.disabled,We,o.id,S.boundsBuffer,n.quadTriangleIndexBuffer,S.boundsSegments):I.draw(_,w.TRIANGLES,ue,G[Y.overscaledZ],P,fe.disabled,We,o.id,n.rasterBoundsBuffer,n.quadTriangleIndexBuffer,n.rasterBoundsSegments)}},background:function(n,s,o){var h=o.paint.get("background-color"),_=o.paint.get("background-opacity");if(_!==0){var w=n.context,S=w.gl,I=n.transform,P=I.tileSize,O=o.paint.get("background-pattern");if(!n.isPatternMissing(O)){var G=!O&&h.a===1&&_===1&&n.opaquePassEnabledForLayer()?"opaque":"translucent";if(n.renderPass===G){var Z=W.disabled,H=n.depthModeForSublayer(0,G==="opaque"?K.ReadWrite:K.ReadOnly),te=n.colorModeForRenderPass(),ee=n.useProgram(O?"backgroundPattern":"background"),ce=I.coveringTiles({tileSize:P});O&&(w.activeTexture.set(S.TEXTURE0),n.imageManager.bind(n.context));for(var Y=o.getCrossfadeParameters(),ue=0,de=ce;ue<de.length;ue+=1){var be=de[ue],Ae=n.transform.calculatePosMatrix(be.toUnwrapped()),Ee=O?Vo(Ae,_,n,O,{tileID:be,tileSize:P},Y):cs(Ae,_,h);ee.draw(w,S.TRIANGLES,H,Z,te,fe.disabled,Ee,o.id,n.tileExtentBuffer,n.quadTriangleIndexBuffer,n.tileExtentSegments)}}}}},debug:function(n,s,o){for(var h=0;h<o.length;h++)Sc(n,s,o[h])},custom:function(n,s,o){var h=n.context,_=o.implementation;if(n.renderPass==="offscreen"){var w=_.prerender;w&&(n.setCustomLayerDefaults(),h.setColorMode(n.colorModeForRenderPass()),w.call(_,h.gl,n.transform.customLayerMatrix()),h.setDirty(),n.setBaseState())}else if(n.renderPass==="translucent"){n.setCustomLayerDefaults(),h.setColorMode(n.colorModeForRenderPass()),h.setStencilMode(W.disabled);var S=_.renderingMode==="3d"?new K(n.context.gl.LEQUAL,K.ReadWrite,n.depthRangeFor3D):n.depthModeForSublayer(0,K.ReadOnly);h.setDepthMode(S),_.render(h.gl,n.transform.customLayerMatrix()),h.setDirty(),n.setBaseState(),h.bindFramebuffer.set(null)}}},Wr=function(n,s){this.context=new U(n),this.transform=s,this._tileTextures={},this.setup(),this.numSublayers=J.maxUnderzooming+J.maxOverzooming+1,this.depthEpsilon=1/Math.pow(2,16),this.crossTileSymbolIndex=new ve,this.gpuTimers={}};Wr.prototype.resize=function(n,s){if(this.width=n*a.browser.devicePixelRatio,this.height=s*a.browser.devicePixelRatio,this.context.viewport.set([0,0,this.width,this.height]),this.style)for(var o=0,h=this.style._order;o<h.length;o+=1)this.style._layers[h[o]].resize()},Wr.prototype.setup=function(){var n=this.context,s=new a.StructArrayLayout2i4;s.emplaceBack(0,0),s.emplaceBack(a.EXTENT,0),s.emplaceBack(0,a.EXTENT),s.emplaceBack(a.EXTENT,a.EXTENT),this.tileExtentBuffer=n.createVertexBuffer(s,xi.members),this.tileExtentSegments=a.SegmentVector.simpleSegment(0,0,4,2);var o=new a.StructArrayLayout2i4;o.emplaceBack(0,0),o.emplaceBack(a.EXTENT,0),o.emplaceBack(0,a.EXTENT),o.emplaceBack(a.EXTENT,a.EXTENT),this.debugBuffer=n.createVertexBuffer(o,xi.members),this.debugSegments=a.SegmentVector.simpleSegment(0,0,4,5);var h=new a.StructArrayLayout4i8;h.emplaceBack(0,0,0,0),h.emplaceBack(a.EXTENT,0,a.EXTENT,0),h.emplaceBack(0,a.EXTENT,0,a.EXTENT),h.emplaceBack(a.EXTENT,a.EXTENT,a.EXTENT,a.EXTENT),this.rasterBoundsBuffer=n.createVertexBuffer(h,Ce.members),this.rasterBoundsSegments=a.SegmentVector.simpleSegment(0,0,4,2);var _=new a.StructArrayLayout2i4;_.emplaceBack(0,0),_.emplaceBack(1,0),_.emplaceBack(0,1),_.emplaceBack(1,1),this.viewportBuffer=n.createVertexBuffer(_,xi.members),this.viewportSegments=a.SegmentVector.simpleSegment(0,0,4,2);var w=new a.StructArrayLayout1ui2;w.emplaceBack(0),w.emplaceBack(1),w.emplaceBack(3),w.emplaceBack(2),w.emplaceBack(0),this.tileBorderIndexBuffer=n.createIndexBuffer(w);var S=new a.StructArrayLayout3ui6;S.emplaceBack(0,1,2),S.emplaceBack(2,1,3),this.quadTriangleIndexBuffer=n.createIndexBuffer(S),this.emptyTexture=new a.Texture(n,{width:1,height:1,data:new Uint8Array([0,0,0,0])},n.gl.RGBA);var I=this.context.gl;this.stencilClearMode=new W({func:I.ALWAYS,mask:0},0,255,I.ZERO,I.ZERO,I.ZERO)},Wr.prototype.clearStencil=function(){var n=this.context,s=n.gl;this.nextStencilID=1,this.currentStencilSource=void 0;var o=a.create();a.ortho(o,0,this.width,this.height,0,0,1),a.scale(o,o,[s.drawingBufferWidth,s.drawingBufferHeight,0]),this.useProgram("clippingMask").draw(n,s.TRIANGLES,K.disabled,this.stencilClearMode,le.disabled,fe.disabled,bo(o),"$clipping",this.viewportBuffer,this.quadTriangleIndexBuffer,this.viewportSegments)},Wr.prototype._renderTileClippingMasks=function(n,s){if(this.currentStencilSource!==n.source&&n.isTileClipped()&&s&&s.length){this.currentStencilSource=n.source;var o=this.context,h=o.gl;this.nextStencilID+s.length>256&&this.clearStencil(),o.setColorMode(le.disabled),o.setDepthMode(K.disabled);var _=this.useProgram("clippingMask");this._tileClippingMaskIDs={};for(var w=0,S=s;w<S.length;w+=1){var I=S[w],P=this._tileClippingMaskIDs[I.key]=this.nextStencilID++;_.draw(o,h.TRIANGLES,K.disabled,new W({func:h.ALWAYS,mask:0},P,255,h.KEEP,h.KEEP,h.REPLACE),le.disabled,fe.disabled,bo(I.posMatrix),"$clipping",this.tileExtentBuffer,this.quadTriangleIndexBuffer,this.tileExtentSegments)}}},Wr.prototype.stencilModeFor3D=function(){this.currentStencilSource=void 0,this.nextStencilID+1>256&&this.clearStencil();var n=this.nextStencilID++,s=this.context.gl;return new W({func:s.NOTEQUAL,mask:255},n,255,s.KEEP,s.KEEP,s.REPLACE)},Wr.prototype.stencilModeForClipping=function(n){var s=this.context.gl;return new W({func:s.EQUAL,mask:255},this._tileClippingMaskIDs[n.key],0,s.KEEP,s.KEEP,s.REPLACE)},Wr.prototype.stencilConfigForOverlap=function(n){var s,o=this.context.gl,h=n.sort(function(P,O){return O.overscaledZ-P.overscaledZ}),_=h[h.length-1].overscaledZ,w=h[0].overscaledZ-_+1;if(w>1){this.currentStencilSource=void 0,this.nextStencilID+w>256&&this.clearStencil();for(var S={},I=0;I<w;I++)S[I+_]=new W({func:o.GEQUAL,mask:255},I+this.nextStencilID,255,o.KEEP,o.KEEP,o.REPLACE);return this.nextStencilID+=w,[S,h]}return[(s={},s[_]=W.disabled,s),h]},Wr.prototype.colorModeForRenderPass=function(){var n=this.context.gl;return this._showOverdrawInspector?new le([n.CONSTANT_COLOR,n.ONE],new a.Color(1/8,1/8,1/8,0),[!0,!0,!0,!0]):this.renderPass==="opaque"?le.unblended:le.alphaBlended},Wr.prototype.depthModeForSublayer=function(n,s,o){if(!this.opaquePassEnabledForLayer())return K.disabled;var h=1-((1+this.currentLayer)*this.numSublayers+n)*this.depthEpsilon;return new K(o||this.context.gl.LEQUAL,s,[h,h])},Wr.prototype.opaquePassEnabledForLayer=function(){return this.currentLayer<this.opaquePassCutoff},Wr.prototype.render=function(n,s){var o=this;this.style=n,this.options=s,this.lineAtlas=n.lineAtlas,this.imageManager=n.imageManager,this.glyphManager=n.glyphManager,this.symbolFadeChange=n.placement.symbolFadeChange(a.browser.now()),this.imageManager.beginFrame();var h=this.style._order,_=this.style.sourceCaches;for(var w in _){var S=_[w];S.used&&S.prepare(this.context)}var I,P,O={},G={},Z={};for(var H in _){var te=_[H];O[H]=te.getVisibleCoordinates(),G[H]=O[H].slice().reverse(),Z[H]=te.getVisibleCoordinates(!0).reverse()}this.opaquePassCutoff=1/0;for(var ee=0;ee<h.length;ee++)if(this.style._layers[h[ee]].is3D()){this.opaquePassCutoff=ee;break}this.renderPass="offscreen";for(var ce=0,Y=h;ce<Y.length;ce+=1){var ue=this.style._layers[Y[ce]];if(ue.hasOffscreenPass()&&!ue.isHidden(this.transform.zoom)){var de=G[ue.source];(ue.type==="custom"||de.length)&&this.renderLayer(this,_[ue.source],ue,de)}}for(this.context.bindFramebuffer.set(null),this.context.clear({color:s.showOverdrawInspector?a.Color.black:a.Color.transparent,depth:1}),this.clearStencil(),this._showOverdrawInspector=s.showOverdrawInspector,this.depthRangeFor3D=[0,1-(n._order.length+2)*this.numSublayers*this.depthEpsilon],this.renderPass="opaque",this.currentLayer=h.length-1;this.currentLayer>=0;this.currentLayer--){var be=this.style._layers[h[this.currentLayer]],Ae=_[be.source],Ee=O[be.source];this._renderTileClippingMasks(be,Ee),this.renderLayer(this,Ae,be,Ee)}for(this.renderPass="translucent",this.currentLayer=0;this.currentLayer<h.length;this.currentLayer++){var ze=this.style._layers[h[this.currentLayer]],Ve=_[ze.source],Qe=(ze.type==="symbol"?Z:G)[ze.source];this._renderTileClippingMasks(ze,O[ze.source]),this.renderLayer(this,Ve,ze,Qe)}this.options.showTileBoundaries&&(a.values(this.style._layers).forEach(function(We){We.source&&!We.isHidden(o.transform.zoom)&&(We.source!==(P&&P.id)&&(P=o.style.sourceCaches[We.source]),(!I||I.getSource().maxzoom<P.getSource().maxzoom)&&(I=P))}),I&&wo.debug(this,I,I.getVisibleCoordinates())),this.options.showPadding&&function(We){var ft=We.transform.padding;Yl(We,We.transform.height-(ft.top||0),3,Xl),Yl(We,ft.bottom||0,3,xc),Jl(We,ft.left||0,3,wc),Jl(We,We.transform.width-(ft.right||0),3,Ks);var Tt=We.transform.centerPoint;(function(Dt,Mt,gr,dt){ps(Dt,Mt-1,gr-10,2,20,dt),ps(Dt,Mt-10,gr-1,20,2,dt)})(We,Tt.x,We.transform.height-Tt.y,Wl)}(this),this.context.setDefault()},Wr.prototype.renderLayer=function(n,s,o,h){o.isHidden(this.transform.zoom)||(o.type==="background"||o.type==="custom"||h.length)&&(this.id=o.id,this.gpuTimingStart(o),wo[o.type](n,s,o,h,this.style.placement.variableOffsets),this.gpuTimingEnd())},Wr.prototype.gpuTimingStart=function(n){if(this.options.gpuTiming){var s=this.context.extTimerQuery,o=this.gpuTimers[n.id];o||(o=this.gpuTimers[n.id]={calls:0,cpuTime:0,query:s.createQueryEXT()}),o.calls++,s.beginQueryEXT(s.TIME_ELAPSED_EXT,o.query)}},Wr.prototype.gpuTimingEnd=function(){if(this.options.gpuTiming){var n=this.context.extTimerQuery;n.endQueryEXT(n.TIME_ELAPSED_EXT)}},Wr.prototype.collectGpuTimers=function(){var n=this.gpuTimers;return this.gpuTimers={},n},Wr.prototype.queryGpuTimers=function(n){var s={};for(var o in n){var h=n[o],_=this.context.extTimerQuery,w=_.getQueryObjectEXT(h.query,_.QUERY_RESULT_EXT)/1e6;_.deleteQueryEXT(h.query),s[o]=w}return s},Wr.prototype.translatePosMatrix=function(n,s,o,h,_){if(!o[0]&&!o[1])return n;var w=_?h==="map"?this.transform.angle:0:h==="viewport"?-this.transform.angle:0;if(w){var S=Math.sin(w),I=Math.cos(w);o=[o[0]*I-o[1]*S,o[0]*S+o[1]*I]}var P=[_?o[0]:Cr(s,o[0],this.transform.zoom),_?o[1]:Cr(s,o[1],this.transform.zoom),0],O=new Float32Array(16);return a.translate(O,n,P),O},Wr.prototype.saveTileTexture=function(n){var s=this._tileTextures[n.size[0]];s?s.push(n):this._tileTextures[n.size[0]]=[n]},Wr.prototype.getTileTexture=function(n){var s=this._tileTextures[n];return s&&s.length>0?s.pop():null},Wr.prototype.isPatternMissing=function(n){if(!n)return!1;if(!n.from||!n.to)return!0;var s=this.imageManager.getPattern(n.from.toString()),o=this.imageManager.getPattern(n.to.toString());return!s||!o},Wr.prototype.useProgram=function(n,s){this.cache=this.cache||{};var o=""+n+(s?s.cacheKey:"")+(this._showOverdrawInspector?"/overdraw":"");return this.cache[o]||(this.cache[o]=new lc(this.context,n,qh[n],s,gc[n],this._showOverdrawInspector)),this.cache[o]},Wr.prototype.setCustomLayerDefaults=function(){this.context.unbindVAO(),this.context.cullFace.setDefault(),this.context.activeTexture.setDefault(),this.context.pixelStoreUnpack.setDefault(),this.context.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.context.pixelStoreUnpackFlipY.setDefault()},Wr.prototype.setBaseState=function(){var n=this.context.gl;this.context.cullFace.set(!1),this.context.viewport.set([0,0,this.width,this.height]),this.context.blendEquation.set(n.FUNC_ADD)},Wr.prototype.initDebugOverlayCanvas=function(){this.debugOverlayCanvas==null&&(this.debugOverlayCanvas=a.window.document.createElement("canvas"),this.debugOverlayCanvas.width=512,this.debugOverlayCanvas.height=512,this.debugOverlayTexture=new a.Texture(this.context,this.debugOverlayCanvas,this.context.gl.RGBA))},Wr.prototype.destroy=function(){this.emptyTexture.destroy(),this.debugOverlayTexture&&this.debugOverlayTexture.destroy()};var Hs=function(n,s){this.points=n,this.planes=s};Hs.fromInvProjectionMatrix=function(n,s,o){var h=Math.pow(2,o),_=[[-1,1,-1,1],[1,1,-1,1],[1,-1,-1,1],[-1,-1,-1,1],[-1,1,1,1],[1,1,1,1],[1,-1,1,1],[-1,-1,1,1]].map(function(S){return a.transformMat4([],S,n)}).map(function(S){return a.scale$1([],S,1/S[3]/s*h)}),w=[[0,1,2],[6,5,4],[0,3,7],[2,1,5],[3,2,6],[0,4,5]].map(function(S){var I=a.sub([],_[S[0]],_[S[1]]),P=a.sub([],_[S[2]],_[S[1]]),O=a.normalize([],a.cross([],I,P)),G=-a.dot(O,_[S[1]]);return O.concat(G)});return new Hs(_,w)};var So=function(n,s){this.min=n,this.max=s,this.center=a.scale$2([],a.add([],this.min,this.max),.5)};So.prototype.quadrant=function(n){for(var s=[n%2==0,n<2],o=a.clone$2(this.min),h=a.clone$2(this.max),_=0;_<s.length;_++)o[_]=s[_]?this.min[_]:this.center[_],h[_]=s[_]?this.center[_]:this.max[_];return h[2]=this.max[2],new So(o,h)},So.prototype.distanceX=function(n){return Math.max(Math.min(this.max[0],n[0]),this.min[0])-n[0]},So.prototype.distanceY=function(n){return Math.max(Math.min(this.max[1],n[1]),this.min[1])-n[1]},So.prototype.intersects=function(n){for(var s=[[this.min[0],this.min[1],0,1],[this.max[0],this.min[1],0,1],[this.max[0],this.max[1],0,1],[this.min[0],this.max[1],0,1]],o=!0,h=0;h<n.planes.length;h++){for(var _=n.planes[h],w=0,S=0;S<s.length;S++)w+=a.dot$1(_,s[S])>=0;if(w===0)return 0;w!==s.length&&(o=!1)}if(o)return 2;for(var I=0;I<3;I++){for(var P=Number.MAX_VALUE,O=-Number.MAX_VALUE,G=0;G<n.points.length;G++){var Z=n.points[G][I]-this.min[I];P=Math.min(P,Z),O=Math.max(O,Z)}if(O<0||P>this.max[I]-this.min[I])return 0}return 1};var Ha=function(n,s,o,h){if(n===void 0&&(n=0),s===void 0&&(s=0),o===void 0&&(o=0),h===void 0&&(h=0),isNaN(n)||n<0||isNaN(s)||s<0||isNaN(o)||o<0||isNaN(h)||h<0)throw new Error("Invalid value for edge-insets, top, bottom, left and right must all be numbers");this.top=n,this.bottom=s,this.left=o,this.right=h};Ha.prototype.interpolate=function(n,s,o){return s.top!=null&&n.top!=null&&(this.top=a.number(n.top,s.top,o)),s.bottom!=null&&n.bottom!=null&&(this.bottom=a.number(n.bottom,s.bottom,o)),s.left!=null&&n.left!=null&&(this.left=a.number(n.left,s.left,o)),s.right!=null&&n.right!=null&&(this.right=a.number(n.right,s.right,o)),this},Ha.prototype.getCenter=function(n,s){var o=a.clamp((this.left+n-this.right)/2,0,n),h=a.clamp((this.top+s-this.bottom)/2,0,s);return new a.Point(o,h)},Ha.prototype.equals=function(n){return this.top===n.top&&this.bottom===n.bottom&&this.left===n.left&&this.right===n.right},Ha.prototype.clone=function(){return new Ha(this.top,this.bottom,this.left,this.right)},Ha.prototype.toJSON=function(){return{top:this.top,bottom:this.bottom,left:this.left,right:this.right}};var dr=function(n,s,o,h,_){this.tileSize=512,this.maxValidLatitude=85.051129,this._renderWorldCopies=_===void 0||_,this._minZoom=n||0,this._maxZoom=s||22,this._minPitch=o??0,this._maxPitch=h??60,this.setMaxBounds(),this.width=0,this.height=0,this._center=new a.LngLat(0,0),this.zoom=0,this.angle=0,this._fov=.6435011087932844,this._pitch=0,this._unmodified=!0,this._edgeInsets=new Ha,this._posMatrixCache={},this._alignedPosMatrixCache={}},Vr={minZoom:{configurable:!0},maxZoom:{configurable:!0},minPitch:{configurable:!0},maxPitch:{configurable:!0},renderWorldCopies:{configurable:!0},worldSize:{configurable:!0},centerOffset:{configurable:!0},size:{configurable:!0},bearing:{configurable:!0},pitch:{configurable:!0},fov:{configurable:!0},zoom:{configurable:!0},center:{configurable:!0},padding:{configurable:!0},centerPoint:{configurable:!0},unmodified:{configurable:!0},point:{configurable:!0}};dr.prototype.clone=function(){var n=new dr(this._minZoom,this._maxZoom,this._minPitch,this.maxPitch,this._renderWorldCopies);return n.tileSize=this.tileSize,n.latRange=this.latRange,n.width=this.width,n.height=this.height,n._center=this._center,n.zoom=this.zoom,n.angle=this.angle,n._fov=this._fov,n._pitch=this._pitch,n._unmodified=this._unmodified,n._edgeInsets=this._edgeInsets.clone(),n._calcMatrices(),n},Vr.minZoom.get=function(){return this._minZoom},Vr.minZoom.set=function(n){this._minZoom!==n&&(this._minZoom=n,this.zoom=Math.max(this.zoom,n))},Vr.maxZoom.get=function(){return this._maxZoom},Vr.maxZoom.set=function(n){this._maxZoom!==n&&(this._maxZoom=n,this.zoom=Math.min(this.zoom,n))},Vr.minPitch.get=function(){return this._minPitch},Vr.minPitch.set=function(n){this._minPitch!==n&&(this._minPitch=n,this.pitch=Math.max(this.pitch,n))},Vr.maxPitch.get=function(){return this._maxPitch},Vr.maxPitch.set=function(n){this._maxPitch!==n&&(this._maxPitch=n,this.pitch=Math.min(this.pitch,n))},Vr.renderWorldCopies.get=function(){return this._renderWorldCopies},Vr.renderWorldCopies.set=function(n){n===void 0?n=!0:n===null&&(n=!1),this._renderWorldCopies=n},Vr.worldSize.get=function(){return this.tileSize*this.scale},Vr.centerOffset.get=function(){return this.centerPoint._sub(this.size._div(2))},Vr.size.get=function(){return new a.Point(this.width,this.height)},Vr.bearing.get=function(){return-this.angle/Math.PI*180},Vr.bearing.set=function(n){var s=-a.wrap(n,-180,180)*Math.PI/180;this.angle!==s&&(this._unmodified=!1,this.angle=s,this._calcMatrices(),this.rotationMatrix=a.create$2(),a.rotate(this.rotationMatrix,this.rotationMatrix,this.angle))},Vr.pitch.get=function(){return this._pitch/Math.PI*180},Vr.pitch.set=function(n){var s=a.clamp(n,this.minPitch,this.maxPitch)/180*Math.PI;this._pitch!==s&&(this._unmodified=!1,this._pitch=s,this._calcMatrices())},Vr.fov.get=function(){return this._fov/Math.PI*180},Vr.fov.set=function(n){n=Math.max(.01,Math.min(60,n)),this._fov!==n&&(this._unmodified=!1,this._fov=n/180*Math.PI,this._calcMatrices())},Vr.zoom.get=function(){return this._zoom},Vr.zoom.set=function(n){var s=Math.min(Math.max(n,this.minZoom),this.maxZoom);this._zoom!==s&&(this._unmodified=!1,this._zoom=s,this.scale=this.zoomScale(s),this.tileZoom=Math.floor(s),this.zoomFraction=s-this.tileZoom,this._constrain(),this._calcMatrices())},Vr.center.get=function(){return this._center},Vr.center.set=function(n){n.lat===this._center.lat&&n.lng===this._center.lng||(this._unmodified=!1,this._center=n,this._constrain(),this._calcMatrices())},Vr.padding.get=function(){return this._edgeInsets.toJSON()},Vr.padding.set=function(n){this._edgeInsets.equals(n)||(this._unmodified=!1,this._edgeInsets.interpolate(this._edgeInsets,n,1),this._calcMatrices())},Vr.centerPoint.get=function(){return this._edgeInsets.getCenter(this.width,this.height)},dr.prototype.isPaddingEqual=function(n){return this._edgeInsets.equals(n)},dr.prototype.interpolatePadding=function(n,s,o){this._unmodified=!1,this._edgeInsets.interpolate(n,s,o),this._constrain(),this._calcMatrices()},dr.prototype.coveringZoomLevel=function(n){var s=(n.roundZoom?Math.round:Math.floor)(this.zoom+this.scaleZoom(this.tileSize/n.tileSize));return Math.max(0,s)},dr.prototype.getVisibleUnwrappedCoordinates=function(n){var s=[new a.UnwrappedTileID(0,n)];if(this._renderWorldCopies)for(var o=this.pointCoordinate(new a.Point(0,0)),h=this.pointCoordinate(new a.Point(this.width,0)),_=this.pointCoordinate(new a.Point(this.width,this.height)),w=this.pointCoordinate(new a.Point(0,this.height)),S=Math.floor(Math.min(o.x,h.x,_.x,w.x)),I=Math.floor(Math.max(o.x,h.x,_.x,w.x)),P=S-1;P<=I+1;P++)P!==0&&s.push(new a.UnwrappedTileID(P,n));return s},dr.prototype.coveringTiles=function(n){var s=this.coveringZoomLevel(n),o=s;if(n.minzoom!==void 0&&s<n.minzoom)return[];n.maxzoom!==void 0&&s>n.maxzoom&&(s=n.maxzoom);var h=a.MercatorCoordinate.fromLngLat(this.center),_=Math.pow(2,s),w=[_*h.x,_*h.y,0],S=Hs.fromInvProjectionMatrix(this.invProjMatrix,this.worldSize,s),I=n.minzoom||0;this.pitch<=60&&this._edgeInsets.top<.1&&(I=s);var P=function(We){return{aabb:new So([We*_,0,0],[(We+1)*_,_,0]),zoom:0,x:0,y:0,wrap:We,fullyVisible:!1}},O=[],G=[],Z=s,H=n.reparseOverscaled?o:s;if(this._renderWorldCopies)for(var te=1;te<=3;te++)O.push(P(-te)),O.push(P(te));for(O.push(P(0));O.length>0;){var ee=O.pop(),ce=ee.x,Y=ee.y,ue=ee.fullyVisible;if(!ue){var de=ee.aabb.intersects(S);if(de===0)continue;ue=de===2}var be=ee.aabb.distanceX(w),Ae=ee.aabb.distanceY(w),Ee=Math.max(Math.abs(be),Math.abs(Ae));if(ee.zoom===Z||Ee>3+(1<<Z-ee.zoom)-2&&ee.zoom>=I)G.push({tileID:new a.OverscaledTileID(ee.zoom===Z?H:ee.zoom,ee.wrap,ee.zoom,ce,Y),distanceSq:a.sqrLen([w[0]-.5-ce,w[1]-.5-Y])});else for(var ze=0;ze<4;ze++){var Ve=(ce<<1)+ze%2,Qe=(Y<<1)+(ze>>1);O.push({aabb:ee.aabb.quadrant(ze),zoom:ee.zoom+1,x:Ve,y:Qe,wrap:ee.wrap,fullyVisible:ue})}}return G.sort(function(We,ft){return We.distanceSq-ft.distanceSq}).map(function(We){return We.tileID})},dr.prototype.resize=function(n,s){this.width=n,this.height=s,this.pixelsToGLUnits=[2/n,-2/s],this._constrain(),this._calcMatrices()},Vr.unmodified.get=function(){return this._unmodified},dr.prototype.zoomScale=function(n){return Math.pow(2,n)},dr.prototype.scaleZoom=function(n){return Math.log(n)/Math.LN2},dr.prototype.project=function(n){var s=a.clamp(n.lat,-this.maxValidLatitude,this.maxValidLatitude);return new a.Point(a.mercatorXfromLng(n.lng)*this.worldSize,a.mercatorYfromLat(s)*this.worldSize)},dr.prototype.unproject=function(n){return new a.MercatorCoordinate(n.x/this.worldSize,n.y/this.worldSize).toLngLat()},Vr.point.get=function(){return this.project(this.center)},dr.prototype.setLocationAtPoint=function(n,s){var o=this.pointCoordinate(s),h=this.pointCoordinate(this.centerPoint),_=this.locationCoordinate(n),w=new a.MercatorCoordinate(_.x-(o.x-h.x),_.y-(o.y-h.y));this.center=this.coordinateLocation(w),this._renderWorldCopies&&(this.center=this.center.wrap())},dr.prototype.locationPoint=function(n){return this.coordinatePoint(this.locationCoordinate(n))},dr.prototype.pointLocation=function(n){return this.coordinateLocation(this.pointCoordinate(n))},dr.prototype.locationCoordinate=function(n){return a.MercatorCoordinate.fromLngLat(n)},dr.prototype.coordinateLocation=function(n){return n.toLngLat()},dr.prototype.pointCoordinate=function(n){var s=[n.x,n.y,0,1],o=[n.x,n.y,1,1];a.transformMat4(s,s,this.pixelMatrixInverse),a.transformMat4(o,o,this.pixelMatrixInverse);var h=s[3],_=o[3],w=s[1]/h,S=o[1]/_,I=s[2]/h,P=o[2]/_,O=I===P?0:(0-I)/(P-I);return new a.MercatorCoordinate(a.number(s[0]/h,o[0]/_,O)/this.worldSize,a.number(w,S,O)/this.worldSize)},dr.prototype.coordinatePoint=function(n){var s=[n.x*this.worldSize,n.y*this.worldSize,0,1];return a.transformMat4(s,s,this.pixelMatrix),new a.Point(s[0]/s[3],s[1]/s[3])},dr.prototype.getBounds=function(){return new a.LngLatBounds().extend(this.pointLocation(new a.Point(0,0))).extend(this.pointLocation(new a.Point(this.width,0))).extend(this.pointLocation(new a.Point(this.width,this.height))).extend(this.pointLocation(new a.Point(0,this.height)))},dr.prototype.getMaxBounds=function(){return this.latRange&&this.latRange.length===2&&this.lngRange&&this.lngRange.length===2?new a.LngLatBounds([this.lngRange[0],this.latRange[0]],[this.lngRange[1],this.latRange[1]]):null},dr.prototype.setMaxBounds=function(n){n?(this.lngRange=[n.getWest(),n.getEast()],this.latRange=[n.getSouth(),n.getNorth()],this._constrain()):(this.lngRange=null,this.latRange=[-this.maxValidLatitude,this.maxValidLatitude])},dr.prototype.calculatePosMatrix=function(n,s){s===void 0&&(s=!1);var o=n.key,h=s?this._alignedPosMatrixCache:this._posMatrixCache;if(h[o])return h[o];var _=n.canonical,w=this.worldSize/this.zoomScale(_.z),S=_.x+Math.pow(2,_.z)*n.wrap,I=a.identity(new Float64Array(16));return a.translate(I,I,[S*w,_.y*w,0]),a.scale(I,I,[w/a.EXTENT,w/a.EXTENT,1]),a.multiply(I,s?this.alignedProjMatrix:this.projMatrix,I),h[o]=new Float32Array(I),h[o]},dr.prototype.customLayerMatrix=function(){return this.mercatorMatrix.slice()},dr.prototype._constrain=function(){if(this.center&&this.width&&this.height&&!this._constraining){this._constraining=!0;var n,s,o,h,_=-90,w=90,S=-180,I=180,P=this.size,O=this._unmodified;if(this.latRange){var G=this.latRange;_=a.mercatorYfromLat(G[1])*this.worldSize,n=(w=a.mercatorYfromLat(G[0])*this.worldSize)-_<P.y?P.y/(w-_):0}if(this.lngRange){var Z=this.lngRange;S=a.mercatorXfromLng(Z[0])*this.worldSize,s=(I=a.mercatorXfromLng(Z[1])*this.worldSize)-S<P.x?P.x/(I-S):0}var H=this.point,te=Math.max(s||0,n||0);if(te)return this.center=this.unproject(new a.Point(s?(I+S)/2:H.x,n?(w+_)/2:H.y)),this.zoom+=this.scaleZoom(te),this._unmodified=O,void(this._constraining=!1);if(this.latRange){var ee=H.y,ce=P.y/2;ee-ce<_&&(h=_+ce),ee+ce>w&&(h=w-ce)}if(this.lngRange){var Y=H.x,ue=P.x/2;Y-ue<S&&(o=S+ue),Y+ue>I&&(o=I-ue)}o===void 0&&h===void 0||(this.center=this.unproject(new a.Point(o!==void 0?o:H.x,h!==void 0?h:H.y))),this._unmodified=O,this._constraining=!1}},dr.prototype._calcMatrices=function(){if(this.height){var n=this.centerOffset;this.cameraToCenterDistance=.5/Math.tan(this._fov/2)*this.height;var s=Math.PI/2+this._pitch,o=this._fov*(.5+n.y/this.height),h=Math.sin(o)*this.cameraToCenterDistance/Math.sin(a.clamp(Math.PI-s-o,.01,Math.PI-.01)),_=this.point,w=_.x,S=_.y,I=1.01*(Math.cos(Math.PI/2-this._pitch)*h+this.cameraToCenterDistance),P=this.height/50,O=new Float64Array(16);a.perspective(O,this._fov,this.width/this.height,P,I),O[8]=2*-n.x/this.width,O[9]=2*n.y/this.height,a.scale(O,O,[1,-1,1]),a.translate(O,O,[0,0,-this.cameraToCenterDistance]),a.rotateX(O,O,this._pitch),a.rotateZ(O,O,this.angle),a.translate(O,O,[-w,-S,0]),this.mercatorMatrix=a.scale([],O,[this.worldSize,this.worldSize,this.worldSize]),a.scale(O,O,[1,1,a.mercatorZfromAltitude(1,this.center.lat)*this.worldSize,1]),this.projMatrix=O,this.invProjMatrix=a.invert([],this.projMatrix);var G=this.width%2/2,Z=this.height%2/2,H=Math.cos(this.angle),te=Math.sin(this.angle),ee=w-Math.round(w)+H*G+te*Z,ce=S-Math.round(S)+H*Z+te*G,Y=new Float64Array(O);if(a.translate(Y,Y,[ee>.5?ee-1:ee,ce>.5?ce-1:ce,0]),this.alignedProjMatrix=Y,O=a.create(),a.scale(O,O,[this.width/2,-this.height/2,1]),a.translate(O,O,[1,-1,0]),this.labelPlaneMatrix=O,O=a.create(),a.scale(O,O,[1,-1,1]),a.translate(O,O,[-1,-1,0]),a.scale(O,O,[2/this.width,2/this.height,1]),this.glCoordMatrix=O,this.pixelMatrix=a.multiply(new Float64Array(16),this.labelPlaneMatrix,this.projMatrix),!(O=a.invert(new Float64Array(16),this.pixelMatrix)))throw new Error("failed to invert matrix");this.pixelMatrixInverse=O,this._posMatrixCache={},this._alignedPosMatrixCache={}}},dr.prototype.maxPitchScaleFactor=function(){if(!this.pixelMatrixInverse)return 1;var n=this.pointCoordinate(new a.Point(0,0)),s=[n.x*this.worldSize,n.y*this.worldSize,0,1];return a.transformMat4(s,s,this.pixelMatrix)[3]/this.cameraToCenterDistance},dr.prototype.getCameraPoint=function(){var n=Math.tan(this._pitch)*(this.cameraToCenterDistance||1);return this.centerPoint.add(new a.Point(0,n))},dr.prototype.getCameraQueryGeometry=function(n){var s=this.getCameraPoint();if(n.length===1)return[n[0],s];for(var o=s.x,h=s.y,_=s.x,w=s.y,S=0,I=n;S<I.length;S+=1){var P=I[S];o=Math.min(o,P.x),h=Math.min(h,P.y),_=Math.max(_,P.x),w=Math.max(w,P.y)}return[new a.Point(o,h),new a.Point(_,h),new a.Point(_,w),new a.Point(o,w),new a.Point(o,h)]},Object.defineProperties(dr.prototype,Vr);var Qn=function(n){var s,o,h,_;this._hashName=n&&encodeURIComponent(n),a.bindAll(["_getCurrentHash","_onHashChange","_updateHash"],this),this._updateHash=(s=this._updateHashUnthrottled.bind(this),o=!1,h=null,_=function(){h=null,o&&(s(),h=setTimeout(_,300),o=!1)},function(){return o=!0,h||_(),h})};Qn.prototype.addTo=function(n){return this._map=n,a.window.addEventListener("hashchange",this._onHashChange,!1),this._map.on("moveend",this._updateHash),this},Qn.prototype.remove=function(){return a.window.removeEventListener("hashchange",this._onHashChange,!1),this._map.off("moveend",this._updateHash),clearTimeout(this._updateHash()),delete this._map,this},Qn.prototype.getHashString=function(n){var s=this._map.getCenter(),o=Math.round(100*this._map.getZoom())/100,h=Math.ceil((o*Math.LN2+Math.log(512/360/.5))/Math.LN10),_=Math.pow(10,h),w=Math.round(s.lng*_)/_,S=Math.round(s.lat*_)/_,I=this._map.getBearing(),P=this._map.getPitch(),O="";if(O+=n?"/"+w+"/"+S+"/"+o:o+"/"+S+"/"+w,(I||P)&&(O+="/"+Math.round(10*I)/10),P&&(O+="/"+Math.round(P)),this._hashName){var G=this._hashName,Z=!1,H=a.window.location.hash.slice(1).split("&").map(function(te){var ee=te.split("=")[0];return ee===G?(Z=!0,ee+"="+O):te}).filter(function(te){return te});return Z||H.push(G+"="+O),"#"+H.join("&")}return"#"+O},Qn.prototype._getCurrentHash=function(){var n,s=this,o=a.window.location.hash.replace("#","");return this._hashName?(o.split("&").map(function(h){return h.split("=")}).forEach(function(h){h[0]===s._hashName&&(n=h)}),(n&&n[1]||"").split("/")):o.split("/")},Qn.prototype._onHashChange=function(){var n=this._getCurrentHash();if(n.length>=3&&!n.some(function(o){return isNaN(o)})){var s=this._map.dragRotate.isEnabled()&&this._map.touchZoomRotate.isEnabled()?+(n[3]||0):this._map.getBearing();return this._map.jumpTo({center:[+n[2],+n[1]],zoom:+n[0],bearing:s,pitch:+(n[4]||0)}),!0}return!1},Qn.prototype._updateHashUnthrottled=function(){var n=a.window.location.href.replace(/(#.+)?$/,this.getHashString());try{a.window.history.replaceState(a.window.history.state,null,n)}catch{}};var fs={linearity:.3,easing:a.bezier(0,0,.3,1)},qo=a.extend({deceleration:2500,maxSpeed:1400},fs),ds=a.extend({deceleration:20,maxSpeed:1400},fs),Kh=a.extend({deceleration:1e3,maxSpeed:360},fs),Hh=a.extend({deceleration:1e3,maxSpeed:90},fs),ms=function(n){this._map=n,this.clear()};function ys(n,s){(!n.duration||n.duration<s.duration)&&(n.duration=s.duration,n.easing=s.easing)}function Ca(n,s,o){var h=o.maxSpeed,_=o.linearity,w=o.deceleration,S=a.clamp(n*_/(s/1e3),-h,h),I=Math.abs(S)/(w*_);return{easing:o.easing,duration:1e3*I,amount:S*(I/2)}}ms.prototype.clear=function(){this._inertiaBuffer=[]},ms.prototype.record=function(n){this._drainInertiaBuffer(),this._inertiaBuffer.push({time:a.browser.now(),settings:n})},ms.prototype._drainInertiaBuffer=function(){for(var n=this._inertiaBuffer,s=a.browser.now();n.length>0&&s-n[0].time>160;)n.shift()},ms.prototype._onMoveEnd=function(n){if(this._drainInertiaBuffer(),!(this._inertiaBuffer.length<2)){for(var s={zoom:0,bearing:0,pitch:0,pan:new a.Point(0,0),pinchAround:void 0,around:void 0},o=0,h=this._inertiaBuffer;o<h.length;o+=1){var _=h[o].settings;s.zoom+=_.zoomDelta||0,s.bearing+=_.bearingDelta||0,s.pitch+=_.pitchDelta||0,_.panDelta&&s.pan._add(_.panDelta),_.around&&(s.around=_.around),_.pinchAround&&(s.pinchAround=_.pinchAround)}var w=this._inertiaBuffer[this._inertiaBuffer.length-1].time-this._inertiaBuffer[0].time,S={};if(s.pan.mag()){var I=Ca(s.pan.mag(),w,a.extend({},qo,n||{}));S.offset=s.pan.mult(I.amount/s.pan.mag()),S.center=this._map.transform.center,ys(S,I)}if(s.zoom){var P=Ca(s.zoom,w,ds);S.zoom=this._map.transform.zoom+P.amount,ys(S,P)}if(s.bearing){var O=Ca(s.bearing,w,Kh);S.bearing=this._map.transform.bearing+a.clamp(O.amount,-179,179),ys(S,O)}if(s.pitch){var G=Ca(s.pitch,w,Hh);S.pitch=this._map.transform.pitch+G.amount,ys(S,G)}if(S.zoom||S.bearing){var Z=s.pinchAround===void 0?s.around:s.pinchAround;S.around=Z?this._map.unproject(Z):this._map.getCenter()}return this.clear(),a.extend(S,{noMoveStart:!0})}};var Pi=function(n){function s(h,_,w,S){S===void 0&&(S={});var I=T.mousePos(_.getCanvasContainer(),w),P=_.unproject(I);n.call(this,h,a.extend({point:I,lngLat:P,originalEvent:w},S)),this._defaultPrevented=!1,this.target=_}n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s;var o={defaultPrevented:{configurable:!0}};return s.prototype.preventDefault=function(){this._defaultPrevented=!0},o.defaultPrevented.get=function(){return this._defaultPrevented},Object.defineProperties(s.prototype,o),s}(a.Event),gs=function(n){function s(h,_,w){var S=h==="touchend"?w.changedTouches:w.touches,I=T.touchPos(_.getCanvasContainer(),S),P=I.map(function(Z){return _.unproject(Z)}),O=I.reduce(function(Z,H,te,ee){return Z.add(H.div(ee.length))},new a.Point(0,0)),G=_.unproject(O);n.call(this,h,{points:I,point:O,lngLats:P,lngLat:G,originalEvent:w}),this._defaultPrevented=!1}n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s;var o={defaultPrevented:{configurable:!0}};return s.prototype.preventDefault=function(){this._defaultPrevented=!0},o.defaultPrevented.get=function(){return this._defaultPrevented},Object.defineProperties(s.prototype,o),s}(a.Event),kc=function(n){function s(h,_,w){n.call(this,h,{originalEvent:w}),this._defaultPrevented=!1}n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s;var o={defaultPrevented:{configurable:!0}};return s.prototype.preventDefault=function(){this._defaultPrevented=!0},o.defaultPrevented.get=function(){return this._defaultPrevented},Object.defineProperties(s.prototype,o),s}(a.Event),wi=function(n,s){this._map=n,this._clickTolerance=s.clickTolerance};wi.prototype.reset=function(){delete this._mousedownPos},wi.prototype.wheel=function(n){return this._firePreventable(new kc(n.type,this._map,n))},wi.prototype.mousedown=function(n,s){return this._mousedownPos=s,this._firePreventable(new Pi(n.type,this._map,n))},wi.prototype.mouseup=function(n){this._map.fire(new Pi(n.type,this._map,n))},wi.prototype.click=function(n,s){this._mousedownPos&&this._mousedownPos.dist(s)>=this._clickTolerance||this._map.fire(new Pi(n.type,this._map,n))},wi.prototype.dblclick=function(n){return this._firePreventable(new Pi(n.type,this._map,n))},wi.prototype.mouseover=function(n){this._map.fire(new Pi(n.type,this._map,n))},wi.prototype.mouseout=function(n){this._map.fire(new Pi(n.type,this._map,n))},wi.prototype.touchstart=function(n){return this._firePreventable(new gs(n.type,this._map,n))},wi.prototype.touchmove=function(n){this._map.fire(new gs(n.type,this._map,n))},wi.prototype.touchend=function(n){this._map.fire(new gs(n.type,this._map,n))},wi.prototype.touchcancel=function(n){this._map.fire(new gs(n.type,this._map,n))},wi.prototype._firePreventable=function(n){if(this._map.fire(n),n.defaultPrevented)return{}},wi.prototype.isEnabled=function(){return!0},wi.prototype.isActive=function(){return!1},wi.prototype.enable=function(){},wi.prototype.disable=function(){};var mt=function(n){this._map=n};mt.prototype.reset=function(){this._delayContextMenu=!1,delete this._contextMenuEvent},mt.prototype.mousemove=function(n){this._map.fire(new Pi(n.type,this._map,n))},mt.prototype.mousedown=function(){this._delayContextMenu=!0},mt.prototype.mouseup=function(){this._delayContextMenu=!1,this._contextMenuEvent&&(this._map.fire(new Pi("contextmenu",this._map,this._contextMenuEvent)),delete this._contextMenuEvent)},mt.prototype.contextmenu=function(n){this._delayContextMenu?this._contextMenuEvent=n:this._map.fire(new Pi(n.type,this._map,n)),this._map.listens("contextmenu")&&n.preventDefault()},mt.prototype.isEnabled=function(){return!0},mt.prototype.isActive=function(){return!1},mt.prototype.enable=function(){},mt.prototype.disable=function(){};var Vn=function(n,s){this._map=n,this._el=n.getCanvasContainer(),this._container=n.getContainer(),this._clickTolerance=s.clickTolerance||1};function Xs(n,s){for(var o={},h=0;h<n.length;h++)o[n[h].identifier]=s[h];return o}Vn.prototype.isEnabled=function(){return!!this._enabled},Vn.prototype.isActive=function(){return!!this._active},Vn.prototype.enable=function(){this.isEnabled()||(this._enabled=!0)},Vn.prototype.disable=function(){this.isEnabled()&&(this._enabled=!1)},Vn.prototype.mousedown=function(n,s){this.isEnabled()&&n.shiftKey&&n.button===0&&(T.disableDrag(),this._startPos=this._lastPos=s,this._active=!0)},Vn.prototype.mousemoveWindow=function(n,s){if(this._active){var o=s;if(!(this._lastPos.equals(o)||!this._box&&o.dist(this._startPos)<this._clickTolerance)){var h=this._startPos;this._lastPos=o,this._box||(this._box=T.create("div","mapboxgl-boxzoom",this._container),this._container.classList.add("mapboxgl-crosshair"),this._fireEvent("boxzoomstart",n));var _=Math.min(h.x,o.x),w=Math.max(h.x,o.x),S=Math.min(h.y,o.y),I=Math.max(h.y,o.y);T.setTransform(this._box,"translate("+_+"px,"+S+"px)"),this._box.style.width=w-_+"px",this._box.style.height=I-S+"px"}}},Vn.prototype.mouseupWindow=function(n,s){var o=this;if(this._active&&n.button===0){var h=this._startPos,_=s;if(this.reset(),T.suppressClick(),h.x!==_.x||h.y!==_.y)return this._map.fire(new a.Event("boxzoomend",{originalEvent:n})),{cameraAnimation:function(w){return w.fitScreenCoordinates(h,_,o._map.getBearing(),{linear:!0})}};this._fireEvent("boxzoomcancel",n)}},Vn.prototype.keydown=function(n){this._active&&n.keyCode===27&&(this.reset(),this._fireEvent("boxzoomcancel",n))},Vn.prototype.blur=function(){this.reset()},Vn.prototype.reset=function(){this._active=!1,this._container.classList.remove("mapboxgl-crosshair"),this._box&&(T.remove(this._box),this._box=null),T.enableDrag(),delete this._startPos,delete this._lastPos},Vn.prototype._fireEvent=function(n,s){return this._map.fire(new a.Event(n,{originalEvent:s}))};var jo=function(n){this.reset(),this.numTouches=n.numTouches};jo.prototype.reset=function(){delete this.centroid,delete this.startTime,delete this.touches,this.aborted=!1},jo.prototype.touchstart=function(n,s,o){(this.centroid||o.length>this.numTouches)&&(this.aborted=!0),this.aborted||(this.startTime===void 0&&(this.startTime=n.timeStamp),o.length===this.numTouches&&(this.centroid=function(h){for(var _=new a.Point(0,0),w=0,S=h;w<S.length;w+=1)_._add(S[w]);return _.div(h.length)}(s),this.touches=Xs(o,s)))},jo.prototype.touchmove=function(n,s,o){if(!this.aborted&&this.centroid){var h=Xs(o,s);for(var _ in this.touches){var w=h[_];(!w||w.dist(this.touches[_])>30)&&(this.aborted=!0)}}},jo.prototype.touchend=function(n,s,o){if((!this.centroid||n.timeStamp-this.startTime>500)&&(this.aborted=!0),o.length===0){var h=!this.aborted&&this.centroid;if(this.reset(),h)return h}};var da=function(n){this.singleTap=new jo(n),this.numTaps=n.numTaps,this.reset()};da.prototype.reset=function(){this.lastTime=1/0,delete this.lastTap,this.count=0,this.singleTap.reset()},da.prototype.touchstart=function(n,s,o){this.singleTap.touchstart(n,s,o)},da.prototype.touchmove=function(n,s,o){this.singleTap.touchmove(n,s,o)},da.prototype.touchend=function(n,s,o){var h=this.singleTap.touchend(n,s,o);if(h){var _=n.timeStamp-this.lastTime<500,w=!this.lastTap||this.lastTap.dist(h)<30;if(_&&w||this.reset(),this.count++,this.lastTime=n.timeStamp,this.lastTap=h,this.count===this.numTaps)return this.reset(),h}};var Un=function(){this._zoomIn=new da({numTouches:1,numTaps:2}),this._zoomOut=new da({numTouches:2,numTaps:1}),this.reset()};Un.prototype.reset=function(){this._active=!1,this._zoomIn.reset(),this._zoomOut.reset()},Un.prototype.touchstart=function(n,s,o){this._zoomIn.touchstart(n,s,o),this._zoomOut.touchstart(n,s,o)},Un.prototype.touchmove=function(n,s,o){this._zoomIn.touchmove(n,s,o),this._zoomOut.touchmove(n,s,o)},Un.prototype.touchend=function(n,s,o){var h=this,_=this._zoomIn.touchend(n,s,o),w=this._zoomOut.touchend(n,s,o);return _?(this._active=!0,n.preventDefault(),setTimeout(function(){return h.reset()},0),{cameraAnimation:function(S){return S.easeTo({duration:300,zoom:S.getZoom()+1,around:S.unproject(_)},{originalEvent:n})}}):w?(this._active=!0,n.preventDefault(),setTimeout(function(){return h.reset()},0),{cameraAnimation:function(S){return S.easeTo({duration:300,zoom:S.getZoom()-1,around:S.unproject(w)},{originalEvent:n})}}):void 0},Un.prototype.touchcancel=function(){this.reset()},Un.prototype.enable=function(){this._enabled=!0},Un.prototype.disable=function(){this._enabled=!1,this.reset()},Un.prototype.isEnabled=function(){return this._enabled},Un.prototype.isActive=function(){return this._active};var Ql={0:1,2:2},at=function(n){this.reset(),this._clickTolerance=n.clickTolerance||1};at.prototype.blur=function(){this.reset()},at.prototype.reset=function(){this._active=!1,this._moved=!1,delete this._lastPoint,delete this._eventButton},at.prototype._correctButton=function(n,s){return!1},at.prototype._move=function(n,s){return{}},at.prototype.mousedown=function(n,s){if(!this._lastPoint){var o=T.mouseButton(n);this._correctButton(n,o)&&(this._lastPoint=s,this._eventButton=o)}},at.prototype.mousemoveWindow=function(n,s){var o=this._lastPoint;if(o){if(n.preventDefault(),function(h,_){var w=Ql[_];return h.buttons===void 0||(h.buttons&w)!==w}(n,this._eventButton))this.reset();else if(this._moved||!(s.dist(o)<this._clickTolerance))return this._moved=!0,this._lastPoint=s,this._move(o,s)}},at.prototype.mouseupWindow=function(n){this._lastPoint&&T.mouseButton(n)===this._eventButton&&(this._moved&&T.suppressClick(),this.reset())},at.prototype.enable=function(){this._enabled=!0},at.prototype.disable=function(){this._enabled=!1,this.reset()},at.prototype.isEnabled=function(){return this._enabled},at.prototype.isActive=function(){return this._active};var $l=function(n){function s(){n.apply(this,arguments)}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype.mousedown=function(o,h){n.prototype.mousedown.call(this,o,h),this._lastPoint&&(this._active=!0)},s.prototype._correctButton=function(o,h){return h===0&&!o.ctrlKey},s.prototype._move=function(o,h){return{around:h,panDelta:h.sub(o)}},s}(at),Ws=function(n){function s(){n.apply(this,arguments)}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype._correctButton=function(o,h){return h===0&&o.ctrlKey||h===2},s.prototype._move=function(o,h){var _=.8*(h.x-o.x);if(_)return this._active=!0,{bearingDelta:_}},s.prototype.contextmenu=function(o){o.preventDefault()},s}(at),eu=function(n){function s(){n.apply(this,arguments)}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype._correctButton=function(o,h){return h===0&&o.ctrlKey||h===2},s.prototype._move=function(o,h){var _=-.5*(h.y-o.y);if(_)return this._active=!0,{pitchDelta:_}},s.prototype.contextmenu=function(o){o.preventDefault()},s}(at),ia=function(n){this._minTouches=1,this._clickTolerance=n.clickTolerance||1,this.reset()};ia.prototype.reset=function(){this._active=!1,this._touches={},this._sum=new a.Point(0,0)},ia.prototype.touchstart=function(n,s,o){return this._calculateTransform(n,s,o)},ia.prototype.touchmove=function(n,s,o){if(this._active&&!(o.length<this._minTouches))return n.preventDefault(),this._calculateTransform(n,s,o)},ia.prototype.touchend=function(n,s,o){this._calculateTransform(n,s,o),this._active&&o.length<this._minTouches&&this.reset()},ia.prototype.touchcancel=function(){this.reset()},ia.prototype._calculateTransform=function(n,s,o){o.length>0&&(this._active=!0);var h=Xs(o,s),_=new a.Point(0,0),w=new a.Point(0,0),S=0;for(var I in h){var P=h[I],O=this._touches[I];O&&(_._add(P),w._add(P.sub(O)),S++,h[I]=P)}if(this._touches=h,!(S<this._minTouches)&&w.mag()){var G=w.div(S);if(this._sum._add(G),!(this._sum.mag()<this._clickTolerance))return{around:_.div(S),panDelta:G}}},ia.prototype.enable=function(){this._enabled=!0},ia.prototype.disable=function(){this._enabled=!1,this.reset()},ia.prototype.isEnabled=function(){return this._enabled},ia.prototype.isActive=function(){return this._active};var qn=function(){this.reset()};function Ys(n,s,o){for(var h=0;h<n.length;h++)if(n[h].identifier===o)return s[h]}function Js(n,s){return Math.log(n/s)/Math.LN2}qn.prototype.reset=function(){this._active=!1,delete this._firstTwoTouches},qn.prototype._start=function(n){},qn.prototype._move=function(n,s,o){return{}},qn.prototype.touchstart=function(n,s,o){this._firstTwoTouches||o.length<2||(this._firstTwoTouches=[o[0].identifier,o[1].identifier],this._start([s[0],s[1]]))},qn.prototype.touchmove=function(n,s,o){if(this._firstTwoTouches){n.preventDefault();var h=this._firstTwoTouches,_=h[1],w=Ys(o,s,h[0]),S=Ys(o,s,_);if(w&&S){var I=this._aroundCenter?null:w.add(S).div(2);return this._move([w,S],I,n)}}},qn.prototype.touchend=function(n,s,o){if(this._firstTwoTouches){var h=this._firstTwoTouches,_=h[1],w=Ys(o,s,h[0]),S=Ys(o,s,_);w&&S||(this._active&&T.suppressClick(),this.reset())}},qn.prototype.touchcancel=function(){this.reset()},qn.prototype.enable=function(n){this._enabled=!0,this._aroundCenter=!!n&&n.around==="center"},qn.prototype.disable=function(){this._enabled=!1,this.reset()},qn.prototype.isEnabled=function(){return this._enabled},qn.prototype.isActive=function(){return this._active};var jn=function(n){function s(){n.apply(this,arguments)}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype.reset=function(){n.prototype.reset.call(this),delete this._distance,delete this._startDistance},s.prototype._start=function(o){this._startDistance=this._distance=o[0].dist(o[1])},s.prototype._move=function(o,h){var _=this._distance;if(this._distance=o[0].dist(o[1]),this._active||!(Math.abs(Js(this._distance,this._startDistance))<.1))return this._active=!0,{zoomDelta:Js(this._distance,_),pinchAround:h}},s}(qn);function Ma(n,s){return 180*n.angleWith(s)/Math.PI}var Ec=function(n){function s(){n.apply(this,arguments)}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype.reset=function(){n.prototype.reset.call(this),delete this._minDiameter,delete this._startVector,delete this._vector},s.prototype._start=function(o){this._startVector=this._vector=o[0].sub(o[1]),this._minDiameter=o[0].dist(o[1])},s.prototype._move=function(o,h){var _=this._vector;if(this._vector=o[0].sub(o[1]),this._active||!this._isBelowThreshold(this._vector))return this._active=!0,{bearingDelta:Ma(this._vector,_),pinchAround:h}},s.prototype._isBelowThreshold=function(o){this._minDiameter=Math.min(this._minDiameter,o.mag());var h=25/(Math.PI*this._minDiameter)*360,_=Ma(o,this._startVector);return Math.abs(_)<h},s}(qn);function _s(n){return Math.abs(n.y)>Math.abs(n.x)}var tu=function(n){function s(){n.apply(this,arguments)}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype.reset=function(){n.prototype.reset.call(this),this._valid=void 0,delete this._firstMove,delete this._lastPoints},s.prototype._start=function(o){this._lastPoints=o,_s(o[0].sub(o[1]))&&(this._valid=!1)},s.prototype._move=function(o,h,_){var w=o[0].sub(this._lastPoints[0]),S=o[1].sub(this._lastPoints[1]);if(this._valid=this.gestureBeginsVertically(w,S,_.timeStamp),this._valid)return this._lastPoints=o,this._active=!0,{pitchDelta:(w.y+S.y)/2*-.5}},s.prototype.gestureBeginsVertically=function(o,h,_){if(this._valid!==void 0)return this._valid;var w=o.mag()>=2,S=h.mag()>=2;if(w||S){if(!w||!S)return this._firstMove===void 0&&(this._firstMove=_),_-this._firstMove<100&&void 0;var I=o.y>0==h.y>0;return _s(o)&&_s(h)&&I}},s}(qn),ru={panStep:100,bearingStep:15,pitchStep:10},ma=function(){var n=ru;this._panStep=n.panStep,this._bearingStep=n.bearingStep,this._pitchStep=n.pitchStep,this._rotationDisabled=!1};function $n(n){return n*(2-n)}ma.prototype.blur=function(){this.reset()},ma.prototype.reset=function(){this._active=!1},ma.prototype.keydown=function(n){var s=this;if(!(n.altKey||n.ctrlKey||n.metaKey)){var o=0,h=0,_=0,w=0,S=0;switch(n.keyCode){case 61:case 107:case 171:case 187:o=1;break;case 189:case 109:case 173:o=-1;break;case 37:n.shiftKey?h=-1:(n.preventDefault(),w=-1);break;case 39:n.shiftKey?h=1:(n.preventDefault(),w=1);break;case 38:n.shiftKey?_=1:(n.preventDefault(),S=-1);break;case 40:n.shiftKey?_=-1:(n.preventDefault(),S=1);break;default:return}return this._rotationDisabled&&(h=0,_=0),{cameraAnimation:function(I){var P=I.getZoom();I.easeTo({duration:300,easeId:"keyboardHandler",easing:$n,zoom:o?Math.round(P)+o*(n.shiftKey?2:1):P,bearing:I.getBearing()+h*s._bearingStep,pitch:I.getPitch()+_*s._pitchStep,offset:[-w*s._panStep,-S*s._panStep],center:I.getCenter()},{originalEvent:n})}}}},ma.prototype.enable=function(){this._enabled=!0},ma.prototype.disable=function(){this._enabled=!1,this.reset()},ma.prototype.isEnabled=function(){return this._enabled},ma.prototype.isActive=function(){return this._active},ma.prototype.disableRotation=function(){this._rotationDisabled=!0},ma.prototype.enableRotation=function(){this._rotationDisabled=!1};var lr=function(n,s){this._map=n,this._el=n.getCanvasContainer(),this._handler=s,this._delta=0,this._defaultZoomRate=.01,this._wheelZoomRate=1/450,a.bindAll(["_onTimeout"],this)};lr.prototype.setZoomRate=function(n){this._defaultZoomRate=n},lr.prototype.setWheelZoomRate=function(n){this._wheelZoomRate=n},lr.prototype.isEnabled=function(){return!!this._enabled},lr.prototype.isActive=function(){return!!this._active||this._finishTimeout!==void 0},lr.prototype.isZooming=function(){return!!this._zooming},lr.prototype.enable=function(n){this.isEnabled()||(this._enabled=!0,this._aroundCenter=n&&n.around==="center")},lr.prototype.disable=function(){this.isEnabled()&&(this._enabled=!1)},lr.prototype.wheel=function(n){if(this.isEnabled()){var s=n.deltaMode===a.window.WheelEvent.DOM_DELTA_LINE?40*n.deltaY:n.deltaY,o=a.browser.now(),h=o-(this._lastWheelEventTime||0);this._lastWheelEventTime=o,s!==0&&s%4.000244140625==0?this._type="wheel":s!==0&&Math.abs(s)<4?this._type="trackpad":h>400?(this._type=null,this._lastValue=s,this._timeout=setTimeout(this._onTimeout,40,n)):this._type||(this._type=Math.abs(h*s)<200?"trackpad":"wheel",this._timeout&&(clearTimeout(this._timeout),this._timeout=null,s+=this._lastValue)),n.shiftKey&&s&&(s/=4),this._type&&(this._lastWheelEvent=n,this._delta-=s,this._active||this._start(n)),n.preventDefault()}},lr.prototype._onTimeout=function(n){this._type="wheel",this._delta-=this._lastValue,this._active||this._start(n)},lr.prototype._start=function(n){if(this._delta){this._frameId&&(this._frameId=null),this._active=!0,this.isZooming()||(this._zooming=!0),this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout);var s=T.mousePos(this._el,n);this._around=a.LngLat.convert(this._aroundCenter?this._map.getCenter():this._map.unproject(s)),this._aroundPoint=this._map.transform.locationPoint(this._around),this._frameId||(this._frameId=!0,this._handler._triggerRenderFrame())}},lr.prototype.renderFrame=function(){var n=this;if(this._frameId&&(this._frameId=null,this.isActive())){var s=this._map.transform;if(this._delta!==0){var o=this._type==="wheel"&&Math.abs(this._delta)>4.000244140625?this._wheelZoomRate:this._defaultZoomRate,h=2/(1+Math.exp(-Math.abs(this._delta*o)));this._delta<0&&h!==0&&(h=1/h);var _=typeof this._targetZoom=="number"?s.zoomScale(this._targetZoom):s.scale;this._targetZoom=Math.min(s.maxZoom,Math.max(s.minZoom,s.scaleZoom(_*h))),this._type==="wheel"&&(this._startZoom=s.zoom,this._easing=this._smoothOutEasing(200)),this._delta=0}var w,S=typeof this._targetZoom=="number"?this._targetZoom:s.zoom,I=this._startZoom,P=this._easing,O=!1;if(this._type==="wheel"&&I&&P){var G=Math.min((a.browser.now()-this._lastWheelEventTime)/200,1),Z=P(G);w=a.number(I,S,Z),G<1?this._frameId||(this._frameId=!0):O=!0}else w=S,O=!0;return this._active=!0,O&&(this._active=!1,this._finishTimeout=setTimeout(function(){n._zooming=!1,n._handler._triggerRenderFrame(),delete n._targetZoom,delete n._finishTimeout},200)),{noInertia:!0,needsRenderFrame:!O,zoomDelta:w-s.zoom,around:this._aroundPoint,originalEvent:this._lastWheelEvent}}},lr.prototype._smoothOutEasing=function(n){var s=a.ease;if(this._prevEase){var o=this._prevEase,h=(a.browser.now()-o.start)/o.duration,_=o.easing(h+.01)-o.easing(h),w=.27/Math.sqrt(_*_+1e-4)*.01,S=Math.sqrt(.0729-w*w);s=a.bezier(w,S,.25,1)}return this._prevEase={start:a.browser.now(),duration:n,easing:s},s},lr.prototype.blur=function(){this.reset()},lr.prototype.reset=function(){this._active=!1};var Ea=function(n,s){this._clickZoom=n,this._tapZoom=s};Ea.prototype.enable=function(){this._clickZoom.enable(),this._tapZoom.enable()},Ea.prototype.disable=function(){this._clickZoom.disable(),this._tapZoom.disable()},Ea.prototype.isEnabled=function(){return this._clickZoom.isEnabled()&&this._tapZoom.isEnabled()},Ea.prototype.isActive=function(){return this._clickZoom.isActive()||this._tapZoom.isActive()};var na=function(){this.reset()};na.prototype.reset=function(){this._active=!1},na.prototype.blur=function(){this.reset()},na.prototype.dblclick=function(n,s){return n.preventDefault(),{cameraAnimation:function(o){o.easeTo({duration:300,zoom:o.getZoom()+(n.shiftKey?-1:1),around:o.unproject(s)},{originalEvent:n})}}},na.prototype.enable=function(){this._enabled=!0},na.prototype.disable=function(){this._enabled=!1,this.reset()},na.prototype.isEnabled=function(){return this._enabled},na.prototype.isActive=function(){return this._active};var rn=function(){this._tap=new da({numTouches:1,numTaps:1}),this.reset()};rn.prototype.reset=function(){this._active=!1,delete this._swipePoint,delete this._swipeTouch,delete this._tapTime,this._tap.reset()},rn.prototype.touchstart=function(n,s,o){this._swipePoint||(this._tapTime&&n.timeStamp-this._tapTime>500&&this.reset(),this._tapTime?o.length>0&&(this._swipePoint=s[0],this._swipeTouch=o[0].identifier):this._tap.touchstart(n,s,o))},rn.prototype.touchmove=function(n,s,o){if(this._tapTime){if(this._swipePoint){if(o[0].identifier!==this._swipeTouch)return;var h=s[0],_=h.y-this._swipePoint.y;return this._swipePoint=h,n.preventDefault(),this._active=!0,{zoomDelta:_/128}}}else this._tap.touchmove(n,s,o)},rn.prototype.touchend=function(n,s,o){this._tapTime?this._swipePoint&&o.length===0&&this.reset():this._tap.touchend(n,s,o)&&(this._tapTime=n.timeStamp)},rn.prototype.touchcancel=function(){this.reset()},rn.prototype.enable=function(){this._enabled=!0},rn.prototype.disable=function(){this._enabled=!1,this.reset()},rn.prototype.isEnabled=function(){return this._enabled},rn.prototype.isActive=function(){return this._active};var ko=function(n,s,o){this._el=n,this._mousePan=s,this._touchPan=o};ko.prototype.enable=function(n){this._inertiaOptions=n||{},this._mousePan.enable(),this._touchPan.enable(),this._el.classList.add("mapboxgl-touch-drag-pan")},ko.prototype.disable=function(){this._mousePan.disable(),this._touchPan.disable(),this._el.classList.remove("mapboxgl-touch-drag-pan")},ko.prototype.isEnabled=function(){return this._mousePan.isEnabled()&&this._touchPan.isEnabled()},ko.prototype.isActive=function(){return this._mousePan.isActive()||this._touchPan.isActive()};var Xa=function(n,s,o){this._pitchWithRotate=n.pitchWithRotate,this._mouseRotate=s,this._mousePitch=o};Xa.prototype.enable=function(){this._mouseRotate.enable(),this._pitchWithRotate&&this._mousePitch.enable()},Xa.prototype.disable=function(){this._mouseRotate.disable(),this._mousePitch.disable()},Xa.prototype.isEnabled=function(){return this._mouseRotate.isEnabled()&&(!this._pitchWithRotate||this._mousePitch.isEnabled())},Xa.prototype.isActive=function(){return this._mouseRotate.isActive()||this._mousePitch.isActive()};var ya=function(n,s,o,h){this._el=n,this._touchZoom=s,this._touchRotate=o,this._tapDragZoom=h,this._rotationDisabled=!1,this._enabled=!0};ya.prototype.enable=function(n){this._touchZoom.enable(n),this._rotationDisabled||this._touchRotate.enable(n),this._tapDragZoom.enable(),this._el.classList.add("mapboxgl-touch-zoom-rotate")},ya.prototype.disable=function(){this._touchZoom.disable(),this._touchRotate.disable(),this._tapDragZoom.disable(),this._el.classList.remove("mapboxgl-touch-zoom-rotate")},ya.prototype.isEnabled=function(){return this._touchZoom.isEnabled()&&(this._rotationDisabled||this._touchRotate.isEnabled())&&this._tapDragZoom.isEnabled()},ya.prototype.isActive=function(){return this._touchZoom.isActive()||this._touchRotate.isActive()||this._tapDragZoom.isActive()},ya.prototype.disableRotation=function(){this._rotationDisabled=!0,this._touchRotate.disable()},ya.prototype.enableRotation=function(){this._rotationDisabled=!1,this._touchZoom.isEnabled()&&this._touchRotate.enable()};var gn=function(n){return n.zoom||n.drag||n.pitch||n.rotate},vs=function(n){function s(){n.apply(this,arguments)}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s}(a.Event);function Et(n){return n.panDelta&&n.panDelta.mag()||n.zoomDelta||n.bearingDelta||n.pitchDelta}var _t=function(n,s){this._map=n,this._el=this._map.getCanvasContainer(),this._handlers=[],this._handlersById={},this._changes=[],this._inertia=new ms(n),this._bearingSnap=s.bearingSnap,this._previousActiveHandlers={},this._eventsInProgress={},this._addDefaultHandlers(s),a.bindAll(["handleEvent","handleWindowEvent"],this);var o=this._el;this._listeners=[[o,"touchstart",{passive:!0}],[o,"touchmove",{passive:!1}],[o,"touchend",void 0],[o,"touchcancel",void 0],[o,"mousedown",void 0],[o,"mousemove",void 0],[o,"mouseup",void 0],[a.window.document,"mousemove",{capture:!0}],[a.window.document,"mouseup",void 0],[o,"mouseover",void 0],[o,"mouseout",void 0],[o,"dblclick",void 0],[o,"click",void 0],[o,"keydown",{capture:!1}],[o,"keyup",void 0],[o,"wheel",{passive:!1}],[o,"contextmenu",void 0],[a.window,"blur",void 0]];for(var h=0,_=this._listeners;h<_.length;h+=1){var w=_[h],S=w[0];T.addEventListener(S,w[1],S===a.window.document?this.handleWindowEvent:this.handleEvent,w[2])}};_t.prototype.destroy=function(){for(var n=0,s=this._listeners;n<s.length;n+=1){var o=s[n],h=o[0];T.removeEventListener(h,o[1],h===a.window.document?this.handleWindowEvent:this.handleEvent,o[2])}},_t.prototype._addDefaultHandlers=function(n){var s=this._map,o=s.getCanvasContainer();this._add("mapEvent",new wi(s,n));var h=s.boxZoom=new Vn(s,n);this._add("boxZoom",h);var _=new Un,w=new na;s.doubleClickZoom=new Ea(w,_),this._add("tapZoom",_),this._add("clickZoom",w);var S=new rn;this._add("tapDragZoom",S);var I=s.touchPitch=new tu;this._add("touchPitch",I);var P=new Ws(n),O=new eu(n);s.dragRotate=new Xa(n,P,O),this._add("mouseRotate",P,["mousePitch"]),this._add("mousePitch",O,["mouseRotate"]);var G=new $l(n),Z=new ia(n);s.dragPan=new ko(o,G,Z),this._add("mousePan",G),this._add("touchPan",Z,["touchZoom","touchRotate"]);var H=new Ec,te=new jn;s.touchZoomRotate=new ya(o,te,H,S),this._add("touchRotate",H,["touchPan","touchZoom"]),this._add("touchZoom",te,["touchPan","touchRotate"]);var ee=s.scrollZoom=new lr(s,this);this._add("scrollZoom",ee,["mousePan"]);var ce=s.keyboard=new ma;this._add("keyboard",ce),this._add("blockableMapEvent",new mt(s));for(var Y=0,ue=["boxZoom","doubleClickZoom","tapDragZoom","touchPitch","dragRotate","dragPan","touchZoomRotate","scrollZoom","keyboard"];Y<ue.length;Y+=1){var de=ue[Y];n.interactive&&n[de]&&s[de].enable(n[de])}},_t.prototype._add=function(n,s,o){this._handlers.push({handlerName:n,handler:s,allowed:o}),this._handlersById[n]=s},_t.prototype.stop=function(n){if(!this._updatingCamera){for(var s=0,o=this._handlers;s<o.length;s+=1)o[s].handler.reset();this._inertia.clear(),this._fireEvents({},{},n),this._changes=[]}},_t.prototype.isActive=function(){for(var n=0,s=this._handlers;n<s.length;n+=1)if(s[n].handler.isActive())return!0;return!1},_t.prototype.isZooming=function(){return!!this._eventsInProgress.zoom||this._map.scrollZoom.isZooming()},_t.prototype.isRotating=function(){return!!this._eventsInProgress.rotate},_t.prototype.isMoving=function(){return!!gn(this._eventsInProgress)||this.isZooming()},_t.prototype._blockedByActive=function(n,s,o){for(var h in n)if(h!==o&&(!s||s.indexOf(h)<0))return!0;return!1},_t.prototype.handleWindowEvent=function(n){this.handleEvent(n,n.type+"Window")},_t.prototype._getMapTouches=function(n){for(var s=[],o=0,h=n;o<h.length;o+=1){var _=h[o];this._el.contains(_.target)&&s.push(_)}return s},_t.prototype.handleEvent=function(n,s){this._updatingCamera=!0;for(var o=n.type==="renderFrame"?void 0:n,h={needsRenderFrame:!1},_={},w={},S=n.touches?this._getMapTouches(n.touches):void 0,I=S?T.touchPos(this._el,S):T.mousePos(this._el,n),P=0,O=this._handlers;P<O.length;P+=1){var G=O[P],Z=G.handlerName,H=G.handler,te=G.allowed;if(H.isEnabled()){var ee=void 0;this._blockedByActive(w,te,Z)?H.reset():H[s||n.type]&&(ee=H[s||n.type](n,I,S),this.mergeHandlerResult(h,_,ee,Z,o),ee&&ee.needsRenderFrame&&this._triggerRenderFrame()),(ee||H.isActive())&&(w[Z]=H)}}var ce={};for(var Y in this._previousActiveHandlers)w[Y]||(ce[Y]=o);this._previousActiveHandlers=w,(Object.keys(ce).length||Et(h))&&(this._changes.push([h,_,ce]),this._triggerRenderFrame()),(Object.keys(w).length||Et(h))&&this._map._stop(!0),this._updatingCamera=!1;var ue=h.cameraAnimation;ue&&(this._inertia.clear(),this._fireEvents({},{},!0),this._changes=[],ue(this._map))},_t.prototype.mergeHandlerResult=function(n,s,o,h,_){if(o){a.extend(n,o);var w={handlerName:h,originalEvent:o.originalEvent||_};o.zoomDelta!==void 0&&(s.zoom=w),o.panDelta!==void 0&&(s.drag=w),o.pitchDelta!==void 0&&(s.pitch=w),o.bearingDelta!==void 0&&(s.rotate=w)}},_t.prototype._applyChanges=function(){for(var n={},s={},o={},h=0,_=this._changes;h<_.length;h+=1){var w=_[h],S=w[0],I=w[1],P=w[2];S.panDelta&&(n.panDelta=(n.panDelta||new a.Point(0,0))._add(S.panDelta)),S.zoomDelta&&(n.zoomDelta=(n.zoomDelta||0)+S.zoomDelta),S.bearingDelta&&(n.bearingDelta=(n.bearingDelta||0)+S.bearingDelta),S.pitchDelta&&(n.pitchDelta=(n.pitchDelta||0)+S.pitchDelta),S.around!==void 0&&(n.around=S.around),S.pinchAround!==void 0&&(n.pinchAround=S.pinchAround),S.noInertia&&(n.noInertia=S.noInertia),a.extend(s,I),a.extend(o,P)}this._updateMapTransform(n,s,o),this._changes=[]},_t.prototype._updateMapTransform=function(n,s,o){var h=this._map,_=h.transform;if(!Et(n))return this._fireEvents(s,o,!0);var w=n.panDelta,S=n.zoomDelta,I=n.bearingDelta,P=n.pitchDelta,O=n.around,G=n.pinchAround;G!==void 0&&(O=G),h._stop(!0),O=O||h.transform.centerPoint;var Z=_.pointLocation(w?O.sub(w):O);I&&(_.bearing+=I),P&&(_.pitch+=P),S&&(_.zoom+=S),_.setLocationAtPoint(Z,O),this._map._update(),n.noInertia||this._inertia.record(n),this._fireEvents(s,o,!0)},_t.prototype._fireEvents=function(n,s,o){var h=this,_=gn(this._eventsInProgress),w=gn(n),S={};for(var I in n)this._eventsInProgress[I]||(S[I+"start"]=n[I].originalEvent),this._eventsInProgress[I]=n[I];for(var P in!_&&w&&this._fireEvent("movestart",w.originalEvent),S)this._fireEvent(P,S[P]);for(var O in w&&this._fireEvent("move",w.originalEvent),n)this._fireEvent(O,n[O].originalEvent);var G,Z={};for(var H in this._eventsInProgress){var te=this._eventsInProgress[H],ee=te.handlerName,ce=te.originalEvent;this._handlersById[ee].isActive()||(delete this._eventsInProgress[H],Z[H+"end"]=G=s[ee]||ce)}for(var Y in Z)this._fireEvent(Y,Z[Y]);var ue=gn(this._eventsInProgress);if(o&&(_||w)&&!ue){this._updatingCamera=!0;var de=this._inertia._onMoveEnd(this._map.dragPan._inertiaOptions),be=function(Ae){return Ae!==0&&-h._bearingSnap<Ae&&Ae<h._bearingSnap};de?(be(de.bearing||this._map.getBearing())&&(de.bearing=0),this._map.easeTo(de,{originalEvent:G})):(this._map.fire(new a.Event("moveend",{originalEvent:G})),be(this._map.getBearing())&&this._map.resetNorth()),this._updatingCamera=!1}},_t.prototype._fireEvent=function(n,s){this._map.fire(new a.Event(n,s?{originalEvent:s}:{}))},_t.prototype._requestFrame=function(){var n=this;return this._map.triggerRepaint(),this._map._renderTaskQueue.add(function(s){delete n._frameId,n.handleEvent(new vs("renderFrame",{timeStamp:s})),n._applyChanges()})},_t.prototype._triggerRenderFrame=function(){this._frameId===void 0&&(this._frameId=this._requestFrame())};var Qs=function(n){function s(o,h){n.call(this),this._moving=!1,this._zooming=!1,this.transform=o,this._bearingSnap=h.bearingSnap,a.bindAll(["_renderFrameCallback"],this)}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype.getCenter=function(){return new a.LngLat(this.transform.center.lng,this.transform.center.lat)},s.prototype.setCenter=function(o,h){return this.jumpTo({center:o},h)},s.prototype.panBy=function(o,h,_){return o=a.Point.convert(o).mult(-1),this.panTo(this.transform.center,a.extend({offset:o},h),_)},s.prototype.panTo=function(o,h,_){return this.easeTo(a.extend({center:o},h),_)},s.prototype.getZoom=function(){return this.transform.zoom},s.prototype.setZoom=function(o,h){return this.jumpTo({zoom:o},h),this},s.prototype.zoomTo=function(o,h,_){return this.easeTo(a.extend({zoom:o},h),_)},s.prototype.zoomIn=function(o,h){return this.zoomTo(this.getZoom()+1,o,h),this},s.prototype.zoomOut=function(o,h){return this.zoomTo(this.getZoom()-1,o,h),this},s.prototype.getBearing=function(){return this.transform.bearing},s.prototype.setBearing=function(o,h){return this.jumpTo({bearing:o},h),this},s.prototype.getPadding=function(){return this.transform.padding},s.prototype.setPadding=function(o,h){return this.jumpTo({padding:o},h),this},s.prototype.rotateTo=function(o,h,_){return this.easeTo(a.extend({bearing:o},h),_)},s.prototype.resetNorth=function(o,h){return this.rotateTo(0,a.extend({duration:1e3},o),h),this},s.prototype.resetNorthPitch=function(o,h){return this.easeTo(a.extend({bearing:0,pitch:0,duration:1e3},o),h),this},s.prototype.snapToNorth=function(o,h){return Math.abs(this.getBearing())<this._bearingSnap?this.resetNorth(o,h):this},s.prototype.getPitch=function(){return this.transform.pitch},s.prototype.setPitch=function(o,h){return this.jumpTo({pitch:o},h),this},s.prototype.cameraForBounds=function(o,h){o=a.LngLatBounds.convert(o);var _=h&&h.bearing||0;return this._cameraForBoxAndBearing(o.getNorthWest(),o.getSouthEast(),_,h)},s.prototype._cameraForBoxAndBearing=function(o,h,_,w){var S={top:0,bottom:0,right:0,left:0};if(typeof(w=a.extend({padding:S,offset:[0,0],maxZoom:this.transform.maxZoom},w)).padding=="number"){var I=w.padding;w.padding={top:I,bottom:I,right:I,left:I}}w.padding=a.extend(S,w.padding);var P=this.transform,O=P.padding,G=P.project(a.LngLat.convert(o)),Z=P.project(a.LngLat.convert(h)),H=G.rotate(-_*Math.PI/180),te=Z.rotate(-_*Math.PI/180),ee=new a.Point(Math.max(H.x,te.x),Math.max(H.y,te.y)),ce=new a.Point(Math.min(H.x,te.x),Math.min(H.y,te.y)),Y=ee.sub(ce),ue=(P.width-(O.left+O.right+w.padding.left+w.padding.right))/Y.x,de=(P.height-(O.top+O.bottom+w.padding.top+w.padding.bottom))/Y.y;if(!(de<0||ue<0)){var be=Math.min(P.scaleZoom(P.scale*Math.min(ue,de)),w.maxZoom),Ae=typeof w.offset.x=="number"?new a.Point(w.offset.x,w.offset.y):a.Point.convert(w.offset),Ee=new a.Point((w.padding.left-w.padding.right)/2,(w.padding.top-w.padding.bottom)/2).rotate(_*Math.PI/180),ze=Ae.add(Ee).mult(P.scale/P.zoomScale(be));return{center:P.unproject(G.add(Z).div(2).sub(ze)),zoom:be,bearing:_}}a.warnOnce("Map cannot fit within canvas with the given bounds, padding, and/or offset.")},s.prototype.fitBounds=function(o,h,_){return this._fitInternal(this.cameraForBounds(o,h),h,_)},s.prototype.fitScreenCoordinates=function(o,h,_,w,S){return this._fitInternal(this._cameraForBoxAndBearing(this.transform.pointLocation(a.Point.convert(o)),this.transform.pointLocation(a.Point.convert(h)),_,w),w,S)},s.prototype._fitInternal=function(o,h,_){return o?(delete(h=a.extend(o,h)).padding,h.linear?this.easeTo(h,_):this.flyTo(h,_)):this},s.prototype.jumpTo=function(o,h){this.stop();var _=this.transform,w=!1,S=!1,I=!1;return"zoom"in o&&_.zoom!==+o.zoom&&(w=!0,_.zoom=+o.zoom),o.center!==void 0&&(_.center=a.LngLat.convert(o.center)),"bearing"in o&&_.bearing!==+o.bearing&&(S=!0,_.bearing=+o.bearing),"pitch"in o&&_.pitch!==+o.pitch&&(I=!0,_.pitch=+o.pitch),o.padding==null||_.isPaddingEqual(o.padding)||(_.padding=o.padding),this.fire(new a.Event("movestart",h)).fire(new a.Event("move",h)),w&&this.fire(new a.Event("zoomstart",h)).fire(new a.Event("zoom",h)).fire(new a.Event("zoomend",h)),S&&this.fire(new a.Event("rotatestart",h)).fire(new a.Event("rotate",h)).fire(new a.Event("rotateend",h)),I&&this.fire(new a.Event("pitchstart",h)).fire(new a.Event("pitch",h)).fire(new a.Event("pitchend",h)),this.fire(new a.Event("moveend",h))},s.prototype.easeTo=function(o,h){var _=this;this._stop(!1,o.easeId),((o=a.extend({offset:[0,0],duration:500,easing:a.ease},o)).animate===!1||!o.essential&&a.browser.prefersReducedMotion)&&(o.duration=0);var w=this.transform,S=this.getZoom(),I=this.getBearing(),P=this.getPitch(),O=this.getPadding(),G="zoom"in o?+o.zoom:S,Z="bearing"in o?this._normalizeBearing(o.bearing,I):I,H="pitch"in o?+o.pitch:P,te="padding"in o?o.padding:w.padding,ee=a.Point.convert(o.offset),ce=w.centerPoint.add(ee),Y=w.pointLocation(ce),ue=a.LngLat.convert(o.center||Y);this._normalizeCenter(ue);var de,be,Ae=w.project(Y),Ee=w.project(ue).sub(Ae),ze=w.zoomScale(G-S);o.around&&(de=a.LngLat.convert(o.around),be=w.locationPoint(de));var Ve={moving:this._moving,zooming:this._zooming,rotating:this._rotating,pitching:this._pitching};return this._zooming=this._zooming||G!==S,this._rotating=this._rotating||I!==Z,this._pitching=this._pitching||H!==P,this._padding=!w.isPaddingEqual(te),this._easeId=o.easeId,this._prepareEase(h,o.noMoveStart,Ve),this._ease(function(Qe){if(_._zooming&&(w.zoom=a.number(S,G,Qe)),_._rotating&&(w.bearing=a.number(I,Z,Qe)),_._pitching&&(w.pitch=a.number(P,H,Qe)),_._padding&&(w.interpolatePadding(O,te,Qe),ce=w.centerPoint.add(ee)),de)w.setLocationAtPoint(de,be);else{var We=w.zoomScale(w.zoom-S),ft=G>S?Math.min(2,ze):Math.max(.5,ze),Tt=Math.pow(ft,1-Qe),Dt=w.unproject(Ae.add(Ee.mult(Qe*Tt)).mult(We));w.setLocationAtPoint(w.renderWorldCopies?Dt.wrap():Dt,ce)}_._fireMoveEvents(h)},function(Qe){_._afterEase(h,Qe)},o),this},s.prototype._prepareEase=function(o,h,_){_===void 0&&(_={}),this._moving=!0,h||_.moving||this.fire(new a.Event("movestart",o)),this._zooming&&!_.zooming&&this.fire(new a.Event("zoomstart",o)),this._rotating&&!_.rotating&&this.fire(new a.Event("rotatestart",o)),this._pitching&&!_.pitching&&this.fire(new a.Event("pitchstart",o))},s.prototype._fireMoveEvents=function(o){this.fire(new a.Event("move",o)),this._zooming&&this.fire(new a.Event("zoom",o)),this._rotating&&this.fire(new a.Event("rotate",o)),this._pitching&&this.fire(new a.Event("pitch",o))},s.prototype._afterEase=function(o,h){if(!this._easeId||!h||this._easeId!==h){delete this._easeId;var _=this._zooming,w=this._rotating,S=this._pitching;this._moving=!1,this._zooming=!1,this._rotating=!1,this._pitching=!1,this._padding=!1,_&&this.fire(new a.Event("zoomend",o)),w&&this.fire(new a.Event("rotateend",o)),S&&this.fire(new a.Event("pitchend",o)),this.fire(new a.Event("moveend",o))}},s.prototype.flyTo=function(o,h){var _=this;if(!o.essential&&a.browser.prefersReducedMotion){var w=a.pick(o,["center","zoom","bearing","pitch","around"]);return this.jumpTo(w,h)}this.stop(),o=a.extend({offset:[0,0],speed:1.2,curve:1.42,easing:a.ease},o);var S=this.transform,I=this.getZoom(),P=this.getBearing(),O=this.getPitch(),G=this.getPadding(),Z="zoom"in o?a.clamp(+o.zoom,S.minZoom,S.maxZoom):I,H="bearing"in o?this._normalizeBearing(o.bearing,P):P,te="pitch"in o?+o.pitch:O,ee="padding"in o?o.padding:S.padding,ce=S.zoomScale(Z-I),Y=a.Point.convert(o.offset),ue=S.centerPoint.add(Y),de=S.pointLocation(ue),be=a.LngLat.convert(o.center||de);this._normalizeCenter(be);var Ae=S.project(de),Ee=S.project(be).sub(Ae),ze=o.curve,Ve=Math.max(S.width,S.height),Qe=Ve/ce,We=Ee.mag();if("minZoom"in o){var ft=a.clamp(Math.min(o.minZoom,I,Z),S.minZoom,S.maxZoom),Tt=Ve/S.zoomScale(ft-I);ze=Math.sqrt(Tt/We*2)}var Dt=ze*ze;function Mt(Ot){var Rt=(Qe*Qe-Ve*Ve+(Ot?-1:1)*Dt*Dt*We*We)/(2*(Ot?Qe:Ve)*Dt*We);return Math.log(Math.sqrt(Rt*Rt+1)-Rt)}function gr(Ot){return(Math.exp(Ot)-Math.exp(-Ot))/2}function dt(Ot){return(Math.exp(Ot)+Math.exp(-Ot))/2}var qt=Mt(0),Jt=function(Ot){return dt(qt)/dt(qt+ze*Ot)},Vt=function(Ot){return Ve*((dt(qt)*(gr(Rt=qt+ze*Ot)/dt(Rt))-gr(qt))/Dt)/We;var Rt},Nt=(Mt(1)-qt)/ze;if(Math.abs(We)<1e-6||!isFinite(Nt)){if(Math.abs(Ve-Qe)<1e-6)return this.easeTo(o,h);var Wt=Qe<Ve?-1:1;Nt=Math.abs(Math.log(Qe/Ve))/ze,Vt=function(){return 0},Jt=function(Ot){return Math.exp(Wt*ze*Ot)}}return o.duration="duration"in o?+o.duration:1e3*Nt/("screenSpeed"in o?+o.screenSpeed/ze:+o.speed),o.maxDuration&&o.duration>o.maxDuration&&(o.duration=0),this._zooming=!0,this._rotating=P!==H,this._pitching=te!==O,this._padding=!S.isPaddingEqual(ee),this._prepareEase(h,!1),this._ease(function(Ot){var Rt=Ot*Nt,Oi=1/Jt(Rt);S.zoom=Ot===1?Z:I+S.scaleZoom(Oi),_._rotating&&(S.bearing=a.number(P,H,Ot)),_._pitching&&(S.pitch=a.number(O,te,Ot)),_._padding&&(S.interpolatePadding(G,ee,Ot),ue=S.centerPoint.add(Y));var si=Ot===1?be:S.unproject(Ae.add(Ee.mult(Vt(Rt))).mult(Oi));S.setLocationAtPoint(S.renderWorldCopies?si.wrap():si,ue),_._fireMoveEvents(h)},function(){return _._afterEase(h)},o),this},s.prototype.isEasing=function(){return!!this._easeFrameId},s.prototype.stop=function(){return this._stop()},s.prototype._stop=function(o,h){if(this._easeFrameId&&(this._cancelRenderFrame(this._easeFrameId),delete this._easeFrameId,delete this._onEaseFrame),this._onEaseEnd){var _=this._onEaseEnd;delete this._onEaseEnd,_.call(this,h)}if(!o){var w=this.handlers;w&&w.stop(!1)}return this},s.prototype._ease=function(o,h,_){_.animate===!1||_.duration===0?(o(1),h()):(this._easeStart=a.browser.now(),this._easeOptions=_,this._onEaseFrame=o,this._onEaseEnd=h,this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback))},s.prototype._renderFrameCallback=function(){var o=Math.min((a.browser.now()-this._easeStart)/this._easeOptions.duration,1);this._onEaseFrame(this._easeOptions.easing(o)),o<1?this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback):this.stop()},s.prototype._normalizeBearing=function(o,h){o=a.wrap(o,-180,180);var _=Math.abs(o-h);return Math.abs(o-360-h)<_&&(o-=360),Math.abs(o+360-h)<_&&(o+=360),o},s.prototype._normalizeCenter=function(o){var h=this.transform;if(h.renderWorldCopies&&!h.lngRange){var _=o.lng-h.center.lng;o.lng+=_>180?-360:_<-180?360:0}},s}(a.Evented),_n=function(n){n===void 0&&(n={}),this.options=n,a.bindAll(["_toggleAttribution","_updateEditLink","_updateData","_updateCompact"],this)};_n.prototype.getDefaultPosition=function(){return"bottom-right"},_n.prototype.onAdd=function(n){var s=this.options&&this.options.compact;return this._map=n,this._container=T.create("div","mapboxgl-ctrl mapboxgl-ctrl-attrib"),this._compactButton=T.create("button","mapboxgl-ctrl-attrib-button",this._container),this._compactButton.addEventListener("click",this._toggleAttribution),this._setElementTitle(this._compactButton,"ToggleAttribution"),this._innerContainer=T.create("div","mapboxgl-ctrl-attrib-inner",this._container),this._innerContainer.setAttribute("role","list"),s&&this._container.classList.add("mapboxgl-compact"),this._updateAttributions(),this._updateEditLink(),this._map.on("styledata",this._updateData),this._map.on("sourcedata",this._updateData),this._map.on("moveend",this._updateEditLink),s===void 0&&(this._map.on("resize",this._updateCompact),this._updateCompact()),this._container},_n.prototype.onRemove=function(){T.remove(this._container),this._map.off("styledata",this._updateData),this._map.off("sourcedata",this._updateData),this._map.off("moveend",this._updateEditLink),this._map.off("resize",this._updateCompact),this._map=void 0,this._attribHTML=void 0},_n.prototype._setElementTitle=function(n,s){var o=this._map._getUIString("AttributionControl."+s);n.title=o,n.setAttribute("aria-label",o)},_n.prototype._toggleAttribution=function(){this._container.classList.contains("mapboxgl-compact-show")?(this._container.classList.remove("mapboxgl-compact-show"),this._compactButton.setAttribute("aria-pressed","false")):(this._container.classList.add("mapboxgl-compact-show"),this._compactButton.setAttribute("aria-pressed","true"))},_n.prototype._updateEditLink=function(){var n=this._editLink;n||(n=this._editLink=this._container.querySelector(".mapbox-improve-map"));var s=[{key:"owner",value:this.styleOwner},{key:"id",value:this.styleId},{key:"access_token",value:this._map._requestManager._customAccessToken||a.config.ACCESS_TOKEN}];if(n){var o=s.reduce(function(h,_,w){return _.value&&(h+=_.key+"="+_.value+(w<s.length-1?"&":"")),h},"?");n.href=a.config.FEEDBACK_URL+"/"+o+(this._map._hash?this._map._hash.getHashString(!0):""),n.rel="noopener nofollow",this._setElementTitle(n,"MapFeedback")}},_n.prototype._updateData=function(n){!n||n.sourceDataType!=="metadata"&&n.sourceDataType!=="visibility"&&n.dataType!=="style"||(this._updateAttributions(),this._updateEditLink())},_n.prototype._updateAttributions=function(){if(this._map.style){var n=[];if(this.options.customAttribution&&(Array.isArray(this.options.customAttribution)?n=n.concat(this.options.customAttribution.map(function(I){return typeof I!="string"?"":I})):typeof this.options.customAttribution=="string"&&n.push(this.options.customAttribution)),this._map.style.stylesheet){var s=this._map.style.stylesheet;this.styleOwner=s.owner,this.styleId=s.id}var o=this._map.style.sourceCaches;for(var h in o){var _=o[h];if(_.used){var w=_.getSource();w.attribution&&n.indexOf(w.attribution)<0&&n.push(w.attribution)}}n.sort(function(I,P){return I.length-P.length});var S=(n=n.filter(function(I,P){for(var O=P+1;O<n.length;O++)if(n[O].indexOf(I)>=0)return!1;return!0})).join(" | ");S!==this._attribHTML&&(this._attribHTML=S,n.length?(this._innerContainer.innerHTML=S,this._container.classList.remove("mapboxgl-attrib-empty")):this._container.classList.add("mapboxgl-attrib-empty"),this._editLink=null)}},_n.prototype._updateCompact=function(){this._map.getCanvasContainer().offsetWidth<=640?this._container.classList.add("mapboxgl-compact"):this._container.classList.remove("mapboxgl-compact","mapboxgl-compact-show")};var ga=function(){a.bindAll(["_updateLogo"],this),a.bindAll(["_updateCompact"],this)};ga.prototype.onAdd=function(n){this._map=n,this._container=T.create("div","mapboxgl-ctrl");var s=T.create("a","mapboxgl-ctrl-logo");return s.target="_blank",s.rel="noopener nofollow",s.href="https://www.mapbox.com/",s.setAttribute("aria-label",this._map._getUIString("LogoControl.Title")),s.setAttribute("rel","noopener nofollow"),this._container.appendChild(s),this._container.style.display="none",this._map.on("sourcedata",this._updateLogo),this._updateLogo(),this._map.on("resize",this._updateCompact),this._updateCompact(),this._container},ga.prototype.onRemove=function(){T.remove(this._container),this._map.off("sourcedata",this._updateLogo),this._map.off("resize",this._updateCompact)},ga.prototype.getDefaultPosition=function(){return"bottom-left"},ga.prototype._updateLogo=function(n){n&&n.sourceDataType!=="metadata"||(this._container.style.display=this._logoRequired()?"block":"none")},ga.prototype._logoRequired=function(){if(this._map.style){var n=this._map.style.sourceCaches;for(var s in n)if(n[s].getSource().mapbox_logo)return!0;return!1}},ga.prototype._updateCompact=function(){var n=this._container.children;if(n.length){var s=n[0];this._map.getCanvasContainer().offsetWidth<250?s.classList.add("mapboxgl-compact"):s.classList.remove("mapboxgl-compact")}};var nn=function(){this._queue=[],this._id=0,this._cleared=!1,this._currentlyRunning=!1};nn.prototype.add=function(n){var s=++this._id;return this._queue.push({callback:n,id:s,cancelled:!1}),s},nn.prototype.remove=function(n){for(var s=this._currentlyRunning,o=0,h=s?this._queue.concat(s):this._queue;o<h.length;o+=1){var _=h[o];if(_.id===n)return void(_.cancelled=!0)}},nn.prototype.run=function(n){n===void 0&&(n=0);var s=this._currentlyRunning=this._queue;this._queue=[];for(var o=0,h=s;o<h.length;o+=1){var _=h[o];if(!_.cancelled&&(_.callback(n),this._cleared))break}this._cleared=!1,this._currentlyRunning=!1},nn.prototype.clear=function(){this._currentlyRunning&&(this._cleared=!0),this._queue=[]};var Ta={"AttributionControl.ToggleAttribution":"Toggle attribution","AttributionControl.MapFeedback":"Map feedback","FullscreenControl.Enter":"Enter fullscreen","FullscreenControl.Exit":"Exit fullscreen","GeolocateControl.FindMyLocation":"Find my location","GeolocateControl.LocationNotAvailable":"Location not available","LogoControl.Title":"Mapbox logo","NavigationControl.ResetBearing":"Reset bearing to north","NavigationControl.ZoomIn":"Zoom in","NavigationControl.ZoomOut":"Zoom out","ScaleControl.Feet":"ft","ScaleControl.Meters":"m","ScaleControl.Kilometers":"km","ScaleControl.Miles":"mi","ScaleControl.NauticalMiles":"nm"},iu=a.window.HTMLImageElement,$s=a.window.HTMLElement,Ar=a.window.ImageBitmap,Ki={center:[0,0],zoom:0,bearing:0,pitch:0,minZoom:-2,maxZoom:22,minPitch:0,maxPitch:60,interactive:!0,scrollZoom:!0,boxZoom:!0,dragRotate:!0,dragPan:!0,keyboard:!0,doubleClickZoom:!0,touchZoomRotate:!0,touchPitch:!0,bearingSnap:7,clickTolerance:3,pitchWithRotate:!0,hash:!1,attributionControl:!0,failIfMajorPerformanceCaveat:!1,preserveDrawingBuffer:!1,trackResize:!0,renderWorldCopies:!0,refreshExpiredTiles:!0,maxTileCacheSize:null,localIdeographFontFamily:"sans-serif",transformRequest:null,accessToken:null,fadeDuration:300,crossSourceCollisions:!0},Tc=function(n){function s(h){var _=this;if((h=a.extend({},Ki,h)).minZoom!=null&&h.maxZoom!=null&&h.minZoom>h.maxZoom)throw new Error("maxZoom must be greater than or equal to minZoom");if(h.minPitch!=null&&h.maxPitch!=null&&h.minPitch>h.maxPitch)throw new Error("maxPitch must be greater than or equal to minPitch");if(h.minPitch!=null&&h.minPitch<0)throw new Error("minPitch must be greater than or equal to 0");if(h.maxPitch!=null&&h.maxPitch>60)throw new Error("maxPitch must be less than or equal to 60");var w=new dr(h.minZoom,h.maxZoom,h.minPitch,h.maxPitch,h.renderWorldCopies);if(n.call(this,w,h),this._interactive=h.interactive,this._maxTileCacheSize=h.maxTileCacheSize,this._failIfMajorPerformanceCaveat=h.failIfMajorPerformanceCaveat,this._preserveDrawingBuffer=h.preserveDrawingBuffer,this._antialias=h.antialias,this._trackResize=h.trackResize,this._bearingSnap=h.bearingSnap,this._refreshExpiredTiles=h.refreshExpiredTiles,this._fadeDuration=h.fadeDuration,this._crossSourceCollisions=h.crossSourceCollisions,this._crossFadingFactor=1,this._collectResourceTiming=h.collectResourceTiming,this._renderTaskQueue=new nn,this._controls=[],this._mapId=a.uniqueId(),this._locale=a.extend({},Ta,h.locale),this._clickTolerance=h.clickTolerance,this._requestManager=new a.RequestManager(h.transformRequest,h.accessToken),typeof h.container=="string"){if(this._container=a.window.document.getElementById(h.container),!this._container)throw new Error("Container '"+h.container+"' not found.")}else{if(!(h.container instanceof $s))throw new Error("Invalid type: 'container' must be a String or HTMLElement.");this._container=h.container}if(h.maxBounds&&this.setMaxBounds(h.maxBounds),a.bindAll(["_onWindowOnline","_onWindowResize","_onMapScroll","_contextLost","_contextRestored"],this),this._setupContainer(),this._setupPainter(),this.painter===void 0)throw new Error("Failed to initialize WebGL.");this.on("move",function(){return _._update(!1)}),this.on("moveend",function(){return _._update(!1)}),this.on("zoom",function(){return _._update(!0)}),a.window!==void 0&&(a.window.addEventListener("online",this._onWindowOnline,!1),a.window.addEventListener("resize",this._onWindowResize,!1),a.window.addEventListener("orientationchange",this._onWindowResize,!1)),this.handlers=new _t(this,h),this._hash=h.hash&&new Qn(typeof h.hash=="string"&&h.hash||void 0).addTo(this),this._hash&&this._hash._onHashChange()||(this.jumpTo({center:h.center,zoom:h.zoom,bearing:h.bearing,pitch:h.pitch}),h.bounds&&(this.resize(),this.fitBounds(h.bounds,a.extend({},h.fitBoundsOptions,{duration:0})))),this.resize(),this._localIdeographFontFamily=h.localIdeographFontFamily,h.style&&this.setStyle(h.style,{localIdeographFontFamily:h.localIdeographFontFamily}),h.attributionControl&&this.addControl(new _n({customAttribution:h.customAttribution})),this.addControl(new ga,h.logoPosition),this.on("style.load",function(){_.transform.unmodified&&_.jumpTo(_.style.stylesheet)}),this.on("data",function(S){_._update(S.dataType==="style"),_.fire(new a.Event(S.dataType+"data",S))}),this.on("dataloading",function(S){_.fire(new a.Event(S.dataType+"dataloading",S))})}n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s;var o={showTileBoundaries:{configurable:!0},showPadding:{configurable:!0},showCollisionBoxes:{configurable:!0},showOverdrawInspector:{configurable:!0},repaint:{configurable:!0},vertices:{configurable:!0},version:{configurable:!0}};return s.prototype._getMapId=function(){return this._mapId},s.prototype.addControl=function(h,_){if(_===void 0&&(_=h.getDefaultPosition?h.getDefaultPosition():"top-right"),!h||!h.onAdd)return this.fire(new a.ErrorEvent(new Error("Invalid argument to map.addControl(). Argument must be a control with onAdd and onRemove methods.")));var w=h.onAdd(this);this._controls.push(h);var S=this._controlPositions[_];return _.indexOf("bottom")!==-1?S.insertBefore(w,S.firstChild):S.appendChild(w),this},s.prototype.removeControl=function(h){if(!h||!h.onRemove)return this.fire(new a.ErrorEvent(new Error("Invalid argument to map.removeControl(). Argument must be a control with onAdd and onRemove methods.")));var _=this._controls.indexOf(h);return _>-1&&this._controls.splice(_,1),h.onRemove(this),this},s.prototype.hasControl=function(h){return this._controls.indexOf(h)>-1},s.prototype.resize=function(h){var _=this._containerDimensions(),w=_[0],S=_[1];if(w===this.transform.width&&S===this.transform.height)return this;this._resizeCanvas(w,S),this.transform.resize(w,S),this.painter.resize(w,S);var I=!this._moving;return I&&this.fire(new a.Event("movestart",h)).fire(new a.Event("move",h)),this.fire(new a.Event("resize",h)),I&&this.fire(new a.Event("moveend",h)),this},s.prototype.getBounds=function(){return this.transform.getBounds()},s.prototype.getMaxBounds=function(){return this.transform.getMaxBounds()},s.prototype.setMaxBounds=function(h){return this.transform.setMaxBounds(a.LngLatBounds.convert(h)),this._update()},s.prototype.setMinZoom=function(h){if((h=h??-2)>=-2&&h<=this.transform.maxZoom)return this.transform.minZoom=h,this._update(),this.getZoom()<h&&this.setZoom(h),this;throw new Error("minZoom must be between -2 and the current maxZoom, inclusive")},s.prototype.getMinZoom=function(){return this.transform.minZoom},s.prototype.setMaxZoom=function(h){if((h=h??22)>=this.transform.minZoom)return this.transform.maxZoom=h,this._update(),this.getZoom()>h&&this.setZoom(h),this;throw new Error("maxZoom must be greater than the current minZoom")},s.prototype.getMaxZoom=function(){return this.transform.maxZoom},s.prototype.setMinPitch=function(h){if((h=h??0)<0)throw new Error("minPitch must be greater than or equal to 0");if(h>=0&&h<=this.transform.maxPitch)return this.transform.minPitch=h,this._update(),this.getPitch()<h&&this.setPitch(h),this;throw new Error("minPitch must be between 0 and the current maxPitch, inclusive")},s.prototype.getMinPitch=function(){return this.transform.minPitch},s.prototype.setMaxPitch=function(h){if((h=h??60)>60)throw new Error("maxPitch must be less than or equal to 60");if(h>=this.transform.minPitch)return this.transform.maxPitch=h,this._update(),this.getPitch()>h&&this.setPitch(h),this;throw new Error("maxPitch must be greater than the current minPitch")},s.prototype.getMaxPitch=function(){return this.transform.maxPitch},s.prototype.getRenderWorldCopies=function(){return this.transform.renderWorldCopies},s.prototype.setRenderWorldCopies=function(h){return this.transform.renderWorldCopies=h,this._update()},s.prototype.project=function(h){return this.transform.locationPoint(a.LngLat.convert(h))},s.prototype.unproject=function(h){return this.transform.pointLocation(a.Point.convert(h))},s.prototype.isMoving=function(){return this._moving||this.handlers.isMoving()},s.prototype.isZooming=function(){return this._zooming||this.handlers.isZooming()},s.prototype.isRotating=function(){return this._rotating||this.handlers.isRotating()},s.prototype._createDelegatedListener=function(h,_,w){var S,I=this;if(h==="mouseenter"||h==="mouseover"){var P=!1;return{layer:_,listener:w,delegates:{mousemove:function(G){var Z=I.getLayer(_)?I.queryRenderedFeatures(G.point,{layers:[_]}):[];Z.length?P||(P=!0,w.call(I,new Pi(h,I,G.originalEvent,{features:Z}))):P=!1},mouseout:function(){P=!1}}}}if(h==="mouseleave"||h==="mouseout"){var O=!1;return{layer:_,listener:w,delegates:{mousemove:function(G){(I.getLayer(_)?I.queryRenderedFeatures(G.point,{layers:[_]}):[]).length?O=!0:O&&(O=!1,w.call(I,new Pi(h,I,G.originalEvent)))},mouseout:function(G){O&&(O=!1,w.call(I,new Pi(h,I,G.originalEvent)))}}}}return{layer:_,listener:w,delegates:(S={},S[h]=function(G){var Z=I.getLayer(_)?I.queryRenderedFeatures(G.point,{layers:[_]}):[];Z.length&&(G.features=Z,w.call(I,G),delete G.features)},S)}},s.prototype.on=function(h,_,w){if(w===void 0)return n.prototype.on.call(this,h,_);var S=this._createDelegatedListener(h,_,w);for(var I in this._delegatedListeners=this._delegatedListeners||{},this._delegatedListeners[h]=this._delegatedListeners[h]||[],this._delegatedListeners[h].push(S),S.delegates)this.on(I,S.delegates[I]);return this},s.prototype.once=function(h,_,w){if(w===void 0)return n.prototype.once.call(this,h,_);var S=this._createDelegatedListener(h,_,w);for(var I in S.delegates)this.once(I,S.delegates[I]);return this},s.prototype.off=function(h,_,w){var S=this;return w===void 0?n.prototype.off.call(this,h,_):(this._delegatedListeners&&this._delegatedListeners[h]&&function(I){for(var P=I[h],O=0;O<P.length;O++){var G=P[O];if(G.layer===_&&G.listener===w){for(var Z in G.delegates)S.off(Z,G.delegates[Z]);return P.splice(O,1),S}}}(this._delegatedListeners),this)},s.prototype.queryRenderedFeatures=function(h,_){if(!this.style)return[];var w;if(_!==void 0||h===void 0||h instanceof a.Point||Array.isArray(h)||(_=h,h=void 0),_=_||{},(h=h||[[0,0],[this.transform.width,this.transform.height]])instanceof a.Point||typeof h[0]=="number")w=[a.Point.convert(h)];else{var S=a.Point.convert(h[0]),I=a.Point.convert(h[1]);w=[S,new a.Point(I.x,S.y),I,new a.Point(S.x,I.y),S]}return this.style.queryRenderedFeatures(w,_,this.transform)},s.prototype.querySourceFeatures=function(h,_){return this.style.querySourceFeatures(h,_)},s.prototype.setStyle=function(h,_){return(_=a.extend({},{localIdeographFontFamily:this._localIdeographFontFamily},_)).diff!==!1&&_.localIdeographFontFamily===this._localIdeographFontFamily&&this.style&&h?(this._diffStyle(h,_),this):(this._localIdeographFontFamily=_.localIdeographFontFamily,this._updateStyle(h,_))},s.prototype._getUIString=function(h){var _=this._locale[h];if(_==null)throw new Error("Missing UI string '"+h+"'");return _},s.prototype._updateStyle=function(h,_){return this.style&&(this.style.setEventedParent(null),this.style._remove()),h?(this.style=new Nn(this,_||{}),this.style.setEventedParent(this,{style:this.style}),typeof h=="string"?this.style.loadURL(h):this.style.loadJSON(h),this):(delete this.style,this)},s.prototype._lazyInitEmptyStyle=function(){this.style||(this.style=new Nn(this,{}),this.style.setEventedParent(this,{style:this.style}),this.style.loadEmpty())},s.prototype._diffStyle=function(h,_){var w=this;if(typeof h=="string"){var S=this._requestManager.normalizeStyleURL(h),I=this._requestManager.transformRequest(S,a.ResourceType.Style);a.getJSON(I,function(P,O){P?w.fire(new a.ErrorEvent(P)):O&&w._updateDiff(O,_)})}else typeof h=="object"&&this._updateDiff(h,_)},s.prototype._updateDiff=function(h,_){try{this.style.setState(h)&&this._update(!0)}catch(w){a.warnOnce("Unable to perform style diff: "+(w.message||w.error||w)+".  Rebuilding the style from scratch."),this._updateStyle(h,_)}},s.prototype.getStyle=function(){if(this.style)return this.style.serialize()},s.prototype.isStyleLoaded=function(){return this.style?this.style.loaded():a.warnOnce("There is no style added to the map.")},s.prototype.addSource=function(h,_){return this._lazyInitEmptyStyle(),this.style.addSource(h,_),this._update(!0)},s.prototype.isSourceLoaded=function(h){var _=this.style&&this.style.sourceCaches[h];if(_!==void 0)return _.loaded();this.fire(new a.ErrorEvent(new Error("There is no source with ID '"+h+"'")))},s.prototype.areTilesLoaded=function(){var h=this.style&&this.style.sourceCaches;for(var _ in h){var w=h[_]._tiles;for(var S in w){var I=w[S];if(I.state!=="loaded"&&I.state!=="errored")return!1}}return!0},s.prototype.addSourceType=function(h,_,w){return this._lazyInitEmptyStyle(),this.style.addSourceType(h,_,w)},s.prototype.removeSource=function(h){return this.style.removeSource(h),this._update(!0)},s.prototype.getSource=function(h){return this.style.getSource(h)},s.prototype.addImage=function(h,_,w){w===void 0&&(w={});var S=w.pixelRatio;S===void 0&&(S=1);var I=w.sdf;I===void 0&&(I=!1);var P=w.stretchX,O=w.stretchY,G=w.content;if(this._lazyInitEmptyStyle(),_ instanceof iu||Ar&&_ instanceof Ar){var Z=a.browser.getImageData(_);this.style.addImage(h,{data:new a.RGBAImage({width:Z.width,height:Z.height},Z.data),pixelRatio:S,stretchX:P,stretchY:O,content:G,sdf:I,version:0})}else{if(_.width===void 0||_.height===void 0)return this.fire(new a.ErrorEvent(new Error("Invalid arguments to map.addImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));var H=_;this.style.addImage(h,{data:new a.RGBAImage({width:_.width,height:_.height},new Uint8Array(_.data)),pixelRatio:S,stretchX:P,stretchY:O,content:G,sdf:I,version:0,userImage:H}),H.onAdd&&H.onAdd(this,h)}},s.prototype.updateImage=function(h,_){var w=this.style.getImage(h);if(!w)return this.fire(new a.ErrorEvent(new Error("The map has no image with that id. If you are adding a new image use `map.addImage(...)` instead.")));var S=_ instanceof iu||Ar&&_ instanceof Ar?a.browser.getImageData(_):_,I=S.width,P=S.height,O=S.data;return I===void 0||P===void 0?this.fire(new a.ErrorEvent(new Error("Invalid arguments to map.updateImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`"))):I!==w.data.width||P!==w.data.height?this.fire(new a.ErrorEvent(new Error("The width and height of the updated image must be that same as the previous version of the image"))):(w.data.replace(O,!(_ instanceof iu||Ar&&_ instanceof Ar)),void this.style.updateImage(h,w))},s.prototype.hasImage=function(h){return h?!!this.style.getImage(h):(this.fire(new a.ErrorEvent(new Error("Missing required image id"))),!1)},s.prototype.removeImage=function(h){this.style.removeImage(h)},s.prototype.loadImage=function(h,_){a.getImage(this._requestManager.transformRequest(h,a.ResourceType.Image),_)},s.prototype.listImages=function(){return this.style.listImages()},s.prototype.addLayer=function(h,_){return this._lazyInitEmptyStyle(),this.style.addLayer(h,_),this._update(!0)},s.prototype.moveLayer=function(h,_){return this.style.moveLayer(h,_),this._update(!0)},s.prototype.removeLayer=function(h){return this.style.removeLayer(h),this._update(!0)},s.prototype.getLayer=function(h){return this.style.getLayer(h)},s.prototype.setLayerZoomRange=function(h,_,w){return this.style.setLayerZoomRange(h,_,w),this._update(!0)},s.prototype.setFilter=function(h,_,w){return w===void 0&&(w={}),this.style.setFilter(h,_,w),this._update(!0)},s.prototype.getFilter=function(h){return this.style.getFilter(h)},s.prototype.setPaintProperty=function(h,_,w,S){return S===void 0&&(S={}),this.style.setPaintProperty(h,_,w,S),this._update(!0)},s.prototype.getPaintProperty=function(h,_){return this.style.getPaintProperty(h,_)},s.prototype.setLayoutProperty=function(h,_,w,S){return S===void 0&&(S={}),this.style.setLayoutProperty(h,_,w,S),this._update(!0)},s.prototype.getLayoutProperty=function(h,_){return this.style.getLayoutProperty(h,_)},s.prototype.setLight=function(h,_){return _===void 0&&(_={}),this._lazyInitEmptyStyle(),this.style.setLight(h,_),this._update(!0)},s.prototype.getLight=function(){return this.style.getLight()},s.prototype.setFeatureState=function(h,_){return this.style.setFeatureState(h,_),this._update()},s.prototype.removeFeatureState=function(h,_){return this.style.removeFeatureState(h,_),this._update()},s.prototype.getFeatureState=function(h){return this.style.getFeatureState(h)},s.prototype.getContainer=function(){return this._container},s.prototype.getCanvasContainer=function(){return this._canvasContainer},s.prototype.getCanvas=function(){return this._canvas},s.prototype._containerDimensions=function(){var h=0,_=0;return this._container&&(h=this._container.clientWidth||400,_=this._container.clientHeight||300),[h,_]},s.prototype._detectMissingCSS=function(){a.window.getComputedStyle(this._missingCSSCanary).getPropertyValue("background-color")!=="rgb(250, 128, 114)"&&a.warnOnce("This page appears to be missing CSS declarations for Mapbox GL JS, which may cause the map to display incorrectly. Please ensure your page includes mapbox-gl.css, as described in https://www.mapbox.com/mapbox-gl-js/api/.")},s.prototype._setupContainer=function(){var h=this._container;h.classList.add("mapboxgl-map"),(this._missingCSSCanary=T.create("div","mapboxgl-canary",h)).style.visibility="hidden",this._detectMissingCSS();var _=this._canvasContainer=T.create("div","mapboxgl-canvas-container",h);this._interactive&&_.classList.add("mapboxgl-interactive"),this._canvas=T.create("canvas","mapboxgl-canvas",_),this._canvas.addEventListener("webglcontextlost",this._contextLost,!1),this._canvas.addEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.setAttribute("tabindex","0"),this._canvas.setAttribute("aria-label","Map"),this._canvas.setAttribute("role","region");var w=this._containerDimensions();this._resizeCanvas(w[0],w[1]);var S=this._controlContainer=T.create("div","mapboxgl-control-container",h),I=this._controlPositions={};["top-left","top-right","bottom-left","bottom-right"].forEach(function(P){I[P]=T.create("div","mapboxgl-ctrl-"+P,S)}),this._container.addEventListener("scroll",this._onMapScroll,!1)},s.prototype._resizeCanvas=function(h,_){var w=a.browser.devicePixelRatio||1;this._canvas.width=w*h,this._canvas.height=w*_,this._canvas.style.width=h+"px",this._canvas.style.height=_+"px"},s.prototype._setupPainter=function(){var h=a.extend({},E.webGLContextAttributes,{failIfMajorPerformanceCaveat:this._failIfMajorPerformanceCaveat,preserveDrawingBuffer:this._preserveDrawingBuffer,antialias:this._antialias||!1}),_=this._canvas.getContext("webgl",h)||this._canvas.getContext("experimental-webgl",h);_?(this.painter=new Wr(_,this.transform),a.webpSupported.testSupport(_)):this.fire(new a.ErrorEvent(new Error("Failed to initialize WebGL")))},s.prototype._contextLost=function(h){h.preventDefault(),this._frame&&(this._frame.cancel(),this._frame=null),this.fire(new a.Event("webglcontextlost",{originalEvent:h}))},s.prototype._contextRestored=function(h){this._setupPainter(),this.resize(),this._update(),this.fire(new a.Event("webglcontextrestored",{originalEvent:h}))},s.prototype._onMapScroll=function(h){if(h.target===this._container)return this._container.scrollTop=0,this._container.scrollLeft=0,!1},s.prototype.loaded=function(){return!this._styleDirty&&!this._sourcesDirty&&!!this.style&&this.style.loaded()},s.prototype._update=function(h){return this.style?(this._styleDirty=this._styleDirty||h,this._sourcesDirty=!0,this.triggerRepaint(),this):this},s.prototype._requestRenderFrame=function(h){return this._update(),this._renderTaskQueue.add(h)},s.prototype._cancelRenderFrame=function(h){this._renderTaskQueue.remove(h)},s.prototype._render=function(h){var _,w=this,S=0,I=this.painter.context.extTimerQuery;if(this.listens("gpu-timing-frame")&&(_=I.createQueryEXT(),I.beginQueryEXT(I.TIME_ELAPSED_EXT,_),S=a.browser.now()),this.painter.context.setDirty(),this.painter.setBaseState(),this._renderTaskQueue.run(h),!this._removed){var P=!1;if(this.style&&this._styleDirty){this._styleDirty=!1;var O=this.transform.zoom,G=a.browser.now();this.style.zoomHistory.update(O,G);var Z=new a.EvaluationParameters(O,{now:G,fadeDuration:this._fadeDuration,zoomHistory:this.style.zoomHistory,transition:this.style.getTransition()}),H=Z.crossFadingFactor();H===1&&H===this._crossFadingFactor||(P=!0,this._crossFadingFactor=H),this.style.update(Z)}if(this.style&&this._sourcesDirty&&(this._sourcesDirty=!1,this.style._updateSources(this.transform)),this._placementDirty=this.style&&this.style._updatePlacement(this.painter.transform,this.showCollisionBoxes,this._fadeDuration,this._crossSourceCollisions),this.painter.render(this.style,{showTileBoundaries:this.showTileBoundaries,showOverdrawInspector:this._showOverdrawInspector,rotating:this.isRotating(),zooming:this.isZooming(),moving:this.isMoving(),fadeDuration:this._fadeDuration,showPadding:this.showPadding,gpuTiming:!!this.listens("gpu-timing-layer")}),this.fire(new a.Event("render")),this.loaded()&&!this._loaded&&(this._loaded=!0,this.fire(new a.Event("load"))),this.style&&(this.style.hasTransitions()||P)&&(this._styleDirty=!0),this.style&&!this._placementDirty&&this.style._releaseSymbolFadeTiles(),this.listens("gpu-timing-frame")){var te=a.browser.now()-S;I.endQueryEXT(I.TIME_ELAPSED_EXT,_),setTimeout(function(){var Y=I.getQueryObjectEXT(_,I.QUERY_RESULT_EXT)/1e6;I.deleteQueryEXT(_),w.fire(new a.Event("gpu-timing-frame",{cpuTime:te,gpuTime:Y}))},50)}if(this.listens("gpu-timing-layer")){var ee=this.painter.collectGpuTimers();setTimeout(function(){var Y=w.painter.queryGpuTimers(ee);w.fire(new a.Event("gpu-timing-layer",{layerTimes:Y}))},50)}var ce=this._sourcesDirty||this._styleDirty||this._placementDirty;return ce||this._repaint?this.triggerRepaint():!this.isMoving()&&this.loaded()&&this.fire(new a.Event("idle")),!this._loaded||this._fullyLoaded||ce||(this._fullyLoaded=!0),this}},s.prototype.remove=function(){this._hash&&this._hash.remove();for(var h=0,_=this._controls;h<_.length;h+=1)_[h].onRemove(this);this._controls=[],this._frame&&(this._frame.cancel(),this._frame=null),this._renderTaskQueue.clear(),this.painter.destroy(),this.handlers.destroy(),delete this.handlers,this.setStyle(null),a.window!==void 0&&(a.window.removeEventListener("resize",this._onWindowResize,!1),a.window.removeEventListener("orientationchange",this._onWindowResize,!1),a.window.removeEventListener("online",this._onWindowOnline,!1));var w=this.painter.context.gl.getExtension("WEBGL_lose_context");w&&w.loseContext(),Eo(this._canvasContainer),Eo(this._controlContainer),Eo(this._missingCSSCanary),this._container.classList.remove("mapboxgl-map"),this._removed=!0,this.fire(new a.Event("remove"))},s.prototype.triggerRepaint=function(){var h=this;this.style&&!this._frame&&(this._frame=a.browser.frame(function(_){h._frame=null,h._render(_)}))},s.prototype._onWindowOnline=function(){this._update()},s.prototype._onWindowResize=function(h){this._trackResize&&this.resize({originalEvent:h})._update()},o.showTileBoundaries.get=function(){return!!this._showTileBoundaries},o.showTileBoundaries.set=function(h){this._showTileBoundaries!==h&&(this._showTileBoundaries=h,this._update())},o.showPadding.get=function(){return!!this._showPadding},o.showPadding.set=function(h){this._showPadding!==h&&(this._showPadding=h,this._update())},o.showCollisionBoxes.get=function(){return!!this._showCollisionBoxes},o.showCollisionBoxes.set=function(h){this._showCollisionBoxes!==h&&(this._showCollisionBoxes=h,h?this.style._generateCollisionBoxes():this._update())},o.showOverdrawInspector.get=function(){return!!this._showOverdrawInspector},o.showOverdrawInspector.set=function(h){this._showOverdrawInspector!==h&&(this._showOverdrawInspector=h,this._update())},o.repaint.get=function(){return!!this._repaint},o.repaint.set=function(h){this._repaint!==h&&(this._repaint=h,this.triggerRepaint())},o.vertices.get=function(){return!!this._vertices},o.vertices.set=function(h){this._vertices=h,this._update()},s.prototype._setCacheLimits=function(h,_){a.setCacheLimits(h,_)},o.version.get=function(){return a.version},Object.defineProperties(s.prototype,o),s}(Qs);function Eo(n){n.parentNode&&n.parentNode.removeChild(n)}var nu={showCompass:!0,showZoom:!0,visualizePitch:!1},Da=function(n){var s=this;this.options=a.extend({},nu,n),this._container=T.create("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._container.addEventListener("contextmenu",function(o){return o.preventDefault()}),this.options.showZoom&&(a.bindAll(["_setButtonTitle","_updateZoomButtons"],this),this._zoomInButton=this._createButton("mapboxgl-ctrl-zoom-in",function(o){return s._map.zoomIn({},{originalEvent:o})}),T.create("span","mapboxgl-ctrl-icon",this._zoomInButton).setAttribute("aria-hidden",!0),this._zoomOutButton=this._createButton("mapboxgl-ctrl-zoom-out",function(o){return s._map.zoomOut({},{originalEvent:o})}),T.create("span","mapboxgl-ctrl-icon",this._zoomOutButton).setAttribute("aria-hidden",!0)),this.options.showCompass&&(a.bindAll(["_rotateCompassArrow"],this),this._compass=this._createButton("mapboxgl-ctrl-compass",function(o){s.options.visualizePitch?s._map.resetNorthPitch({},{originalEvent:o}):s._map.resetNorth({},{originalEvent:o})}),this._compassIcon=T.create("span","mapboxgl-ctrl-icon",this._compass),this._compassIcon.setAttribute("aria-hidden",!0))};Da.prototype._updateZoomButtons=function(){var n=this._map.getZoom(),s=n===this._map.getMaxZoom(),o=n===this._map.getMinZoom();this._zoomInButton.disabled=s,this._zoomOutButton.disabled=o,this._zoomInButton.setAttribute("aria-disabled",s.toString()),this._zoomOutButton.setAttribute("aria-disabled",o.toString())},Da.prototype._rotateCompassArrow=function(){var n=this.options.visualizePitch?"scale("+1/Math.pow(Math.cos(this._map.transform.pitch*(Math.PI/180)),.5)+") rotateX("+this._map.transform.pitch+"deg) rotateZ("+this._map.transform.angle*(180/Math.PI)+"deg)":"rotate("+this._map.transform.angle*(180/Math.PI)+"deg)";this._compassIcon.style.transform=n},Da.prototype.onAdd=function(n){return this._map=n,this.options.showZoom&&(this._setButtonTitle(this._zoomInButton,"ZoomIn"),this._setButtonTitle(this._zoomOutButton,"ZoomOut"),this._map.on("zoom",this._updateZoomButtons),this._updateZoomButtons()),this.options.showCompass&&(this._setButtonTitle(this._compass,"ResetBearing"),this.options.visualizePitch&&this._map.on("pitch",this._rotateCompassArrow),this._map.on("rotate",this._rotateCompassArrow),this._rotateCompassArrow(),this._handler=new Gn(this._map,this._compass,this.options.visualizePitch)),this._container},Da.prototype.onRemove=function(){T.remove(this._container),this.options.showZoom&&this._map.off("zoom",this._updateZoomButtons),this.options.showCompass&&(this.options.visualizePitch&&this._map.off("pitch",this._rotateCompassArrow),this._map.off("rotate",this._rotateCompassArrow),this._handler.off(),delete this._handler),delete this._map},Da.prototype._createButton=function(n,s){var o=T.create("button",n,this._container);return o.type="button",o.addEventListener("click",s),o},Da.prototype._setButtonTitle=function(n,s){var o=this._map._getUIString("NavigationControl."+s);n.title=o,n.setAttribute("aria-label",o)};var Gn=function(n,s,o){o===void 0&&(o=!1),this._clickTolerance=10,this.element=s,this.mouseRotate=new Ws({clickTolerance:n.dragRotate._mouseRotate._clickTolerance}),this.map=n,o&&(this.mousePitch=new eu({clickTolerance:n.dragRotate._mousePitch._clickTolerance})),a.bindAll(["mousedown","mousemove","mouseup","touchstart","touchmove","touchend","reset"],this),T.addEventListener(s,"mousedown",this.mousedown),T.addEventListener(s,"touchstart",this.touchstart,{passive:!1}),T.addEventListener(s,"touchmove",this.touchmove),T.addEventListener(s,"touchend",this.touchend),T.addEventListener(s,"touchcancel",this.reset)};function Go(n,s,o){if(n=new a.LngLat(n.lng,n.lat),s){var h=new a.LngLat(n.lng-360,n.lat),_=new a.LngLat(n.lng+360,n.lat),w=o.locationPoint(n).distSqr(s);o.locationPoint(h).distSqr(s)<w?n=h:o.locationPoint(_).distSqr(s)<w&&(n=_)}for(;Math.abs(n.lng-o.center.lng)>180;){var S=o.locationPoint(n);if(S.x>=0&&S.y>=0&&S.x<=o.width&&S.y<=o.height)break;n.lng>o.center.lng?n.lng-=360:n.lng+=360}return n}Gn.prototype.down=function(n,s){this.mouseRotate.mousedown(n,s),this.mousePitch&&this.mousePitch.mousedown(n,s),T.disableDrag()},Gn.prototype.move=function(n,s){var o=this.map,h=this.mouseRotate.mousemoveWindow(n,s);if(h&&h.bearingDelta&&o.setBearing(o.getBearing()+h.bearingDelta),this.mousePitch){var _=this.mousePitch.mousemoveWindow(n,s);_&&_.pitchDelta&&o.setPitch(o.getPitch()+_.pitchDelta)}},Gn.prototype.off=function(){var n=this.element;T.removeEventListener(n,"mousedown",this.mousedown),T.removeEventListener(n,"touchstart",this.touchstart,{passive:!1}),T.removeEventListener(n,"touchmove",this.touchmove),T.removeEventListener(n,"touchend",this.touchend),T.removeEventListener(n,"touchcancel",this.reset),this.offTemp()},Gn.prototype.offTemp=function(){T.enableDrag(),T.removeEventListener(a.window,"mousemove",this.mousemove),T.removeEventListener(a.window,"mouseup",this.mouseup)},Gn.prototype.mousedown=function(n){this.down(a.extend({},n,{ctrlKey:!0,preventDefault:function(){return n.preventDefault()}}),T.mousePos(this.element,n)),T.addEventListener(a.window,"mousemove",this.mousemove),T.addEventListener(a.window,"mouseup",this.mouseup)},Gn.prototype.mousemove=function(n){this.move(n,T.mousePos(this.element,n))},Gn.prototype.mouseup=function(n){this.mouseRotate.mouseupWindow(n),this.mousePitch&&this.mousePitch.mouseupWindow(n),this.offTemp()},Gn.prototype.touchstart=function(n){n.targetTouches.length!==1?this.reset():(this._startPos=this._lastPos=T.touchPos(this.element,n.targetTouches)[0],this.down({type:"mousedown",button:0,ctrlKey:!0,preventDefault:function(){return n.preventDefault()}},this._startPos))},Gn.prototype.touchmove=function(n){n.targetTouches.length!==1?this.reset():(this._lastPos=T.touchPos(this.element,n.targetTouches)[0],this.move({preventDefault:function(){return n.preventDefault()}},this._lastPos))},Gn.prototype.touchend=function(n){n.targetTouches.length===0&&this._startPos&&this._lastPos&&this._startPos.dist(this._lastPos)<this._clickTolerance&&this.element.click(),this.reset()},Gn.prototype.reset=function(){this.mouseRotate.reset(),this.mousePitch&&this.mousePitch.reset(),delete this._startPos,delete this._lastPos,this.offTemp()};var Ia={center:"translate(-50%,-50%)",top:"translate(-50%,0)","top-left":"translate(0,0)","top-right":"translate(-100%,0)",bottom:"translate(-50%,-100%)","bottom-left":"translate(0,-100%)","bottom-right":"translate(-100%,-100%)",left:"translate(0,-50%)",right:"translate(-100%,-50%)"};function el(n,s,o){var h=n.classList;for(var _ in Ia)h.remove("mapboxgl-"+o+"-anchor-"+_);h.add("mapboxgl-"+o+"-anchor-"+s)}var Zo,bs=function(n){function s(o,h){if(n.call(this),(o instanceof a.window.HTMLElement||h)&&(o=a.extend({element:o},h)),a.bindAll(["_update","_onMove","_onUp","_addDragHandler","_onMapClick","_onKeyPress"],this),this._anchor=o&&o.anchor||"center",this._color=o&&o.color||"#3FB1CE",this._scale=o&&o.scale||1,this._draggable=o&&o.draggable||!1,this._clickTolerance=o&&o.clickTolerance||0,this._isDragging=!1,this._state="inactive",this._rotation=o&&o.rotation||0,this._rotationAlignment=o&&o.rotationAlignment||"auto",this._pitchAlignment=o&&o.pitchAlignment&&o.pitchAlignment!=="auto"?o.pitchAlignment:this._rotationAlignment,o&&o.element)this._element=o.element,this._offset=a.Point.convert(o&&o.offset||[0,0]);else{this._defaultMarker=!0,this._element=T.create("div"),this._element.setAttribute("aria-label","Map marker");var _=T.createNS("http://www.w3.org/2000/svg","svg");_.setAttributeNS(null,"display","block"),_.setAttributeNS(null,"height","41px"),_.setAttributeNS(null,"width","27px"),_.setAttributeNS(null,"viewBox","0 0 27 41");var w=T.createNS("http://www.w3.org/2000/svg","g");w.setAttributeNS(null,"stroke","none"),w.setAttributeNS(null,"stroke-width","1"),w.setAttributeNS(null,"fill","none"),w.setAttributeNS(null,"fill-rule","evenodd");var S=T.createNS("http://www.w3.org/2000/svg","g");S.setAttributeNS(null,"fill-rule","nonzero");var I=T.createNS("http://www.w3.org/2000/svg","g");I.setAttributeNS(null,"transform","translate(3.0, 29.0)"),I.setAttributeNS(null,"fill","#000000");for(var P=0,O=[{rx:"10.5",ry:"5.25002273"},{rx:"10.5",ry:"5.25002273"},{rx:"9.5",ry:"4.77275007"},{rx:"8.5",ry:"4.29549936"},{rx:"7.5",ry:"3.81822308"},{rx:"6.5",ry:"3.34094679"},{rx:"5.5",ry:"2.86367051"},{rx:"4.5",ry:"2.38636864"}];P<O.length;P+=1){var G=O[P],Z=T.createNS("http://www.w3.org/2000/svg","ellipse");Z.setAttributeNS(null,"opacity","0.04"),Z.setAttributeNS(null,"cx","10.5"),Z.setAttributeNS(null,"cy","5.80029008"),Z.setAttributeNS(null,"rx",G.rx),Z.setAttributeNS(null,"ry",G.ry),I.appendChild(Z)}var H=T.createNS("http://www.w3.org/2000/svg","g");H.setAttributeNS(null,"fill",this._color);var te=T.createNS("http://www.w3.org/2000/svg","path");te.setAttributeNS(null,"d","M27,13.5 C27,19.074644 20.250001,27.000002 14.75,34.500002 C14.016665,35.500004 12.983335,35.500004 12.25,34.500002 C6.7499993,27.000002 0,19.222562 0,13.5 C0,6.0441559 6.0441559,0 13.5,0 C20.955844,0 27,6.0441559 27,13.5 Z"),H.appendChild(te);var ee=T.createNS("http://www.w3.org/2000/svg","g");ee.setAttributeNS(null,"opacity","0.25"),ee.setAttributeNS(null,"fill","#000000");var ce=T.createNS("http://www.w3.org/2000/svg","path");ce.setAttributeNS(null,"d","M13.5,0 C6.0441559,0 0,6.0441559 0,13.5 C0,19.222562 6.7499993,27 12.25,34.5 C13,35.522727 14.016664,35.500004 14.75,34.5 C20.250001,27 27,19.074644 27,13.5 C27,6.0441559 20.955844,0 13.5,0 Z M13.5,1 C20.415404,1 26,6.584596 26,13.5 C26,15.898657 24.495584,19.181431 22.220703,22.738281 C19.945823,26.295132 16.705119,30.142167 13.943359,33.908203 C13.743445,34.180814 13.612715,34.322738 13.5,34.441406 C13.387285,34.322738 13.256555,34.180814 13.056641,33.908203 C10.284481,30.127985 7.4148684,26.314159 5.015625,22.773438 C2.6163816,19.232715 1,15.953538 1,13.5 C1,6.584596 6.584596,1 13.5,1 Z"),ee.appendChild(ce);var Y=T.createNS("http://www.w3.org/2000/svg","g");Y.setAttributeNS(null,"transform","translate(6.0, 7.0)"),Y.setAttributeNS(null,"fill","#FFFFFF");var ue=T.createNS("http://www.w3.org/2000/svg","g");ue.setAttributeNS(null,"transform","translate(8.0, 8.0)");var de=T.createNS("http://www.w3.org/2000/svg","circle");de.setAttributeNS(null,"fill","#000000"),de.setAttributeNS(null,"opacity","0.25"),de.setAttributeNS(null,"cx","5.5"),de.setAttributeNS(null,"cy","5.5"),de.setAttributeNS(null,"r","5.4999962");var be=T.createNS("http://www.w3.org/2000/svg","circle");be.setAttributeNS(null,"fill","#FFFFFF"),be.setAttributeNS(null,"cx","5.5"),be.setAttributeNS(null,"cy","5.5"),be.setAttributeNS(null,"r","5.4999962"),ue.appendChild(de),ue.appendChild(be),S.appendChild(I),S.appendChild(H),S.appendChild(ee),S.appendChild(Y),S.appendChild(ue),_.appendChild(S),_.setAttributeNS(null,"height",41*this._scale+"px"),_.setAttributeNS(null,"width",27*this._scale+"px"),this._element.appendChild(_),this._offset=a.Point.convert(o&&o.offset||[0,-14])}this._element.classList.add("mapboxgl-marker"),this._element.addEventListener("dragstart",function(Ae){Ae.preventDefault()}),this._element.addEventListener("mousedown",function(Ae){Ae.preventDefault()}),el(this._element,this._anchor,"marker"),this._popup=null}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype.addTo=function(o){return this.remove(),this._map=o,o.getCanvasContainer().appendChild(this._element),o.on("move",this._update),o.on("moveend",this._update),this.setDraggable(this._draggable),this._update(),this._map.on("click",this._onMapClick),this},s.prototype.remove=function(){return this._map&&(this._map.off("click",this._onMapClick),this._map.off("move",this._update),this._map.off("moveend",this._update),this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler),this._map.off("mouseup",this._onUp),this._map.off("touchend",this._onUp),this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),delete this._map),T.remove(this._element),this._popup&&this._popup.remove(),this},s.prototype.getLngLat=function(){return this._lngLat},s.prototype.setLngLat=function(o){return this._lngLat=a.LngLat.convert(o),this._pos=null,this._popup&&this._popup.setLngLat(this._lngLat),this._update(),this},s.prototype.getElement=function(){return this._element},s.prototype.setPopup=function(o){if(this._popup&&(this._popup.remove(),this._popup=null,this._element.removeEventListener("keypress",this._onKeyPress),this._originalTabIndex||this._element.removeAttribute("tabindex")),o){if(!("offset"in o.options)){var h=Math.sqrt(Math.pow(13.5,2)/2);o.options.offset=this._defaultMarker?{top:[0,0],"top-left":[0,0],"top-right":[0,0],bottom:[0,-38.1],"bottom-left":[h,-1*(24.6+h)],"bottom-right":[-h,-1*(24.6+h)],left:[13.5,-24.6],right:[-13.5,-24.6]}:this._offset}this._popup=o,this._lngLat&&this._popup.setLngLat(this._lngLat),this._originalTabIndex=this._element.getAttribute("tabindex"),this._originalTabIndex||this._element.setAttribute("tabindex","0"),this._element.addEventListener("keypress",this._onKeyPress)}return this},s.prototype._onKeyPress=function(o){var h=o.code,_=o.charCode||o.keyCode;h!=="Space"&&h!=="Enter"&&_!==32&&_!==13||this.togglePopup()},s.prototype._onMapClick=function(o){var h=o.originalEvent.target,_=this._element;this._popup&&(h===_||_.contains(h))&&this.togglePopup()},s.prototype.getPopup=function(){return this._popup},s.prototype.togglePopup=function(){var o=this._popup;return o?(o.isOpen()?o.remove():o.addTo(this._map),this):this},s.prototype._update=function(o){if(this._map){this._map.transform.renderWorldCopies&&(this._lngLat=Go(this._lngLat,this._pos,this._map.transform)),this._pos=this._map.project(this._lngLat)._add(this._offset);var h="";this._rotationAlignment==="viewport"||this._rotationAlignment==="auto"?h="rotateZ("+this._rotation+"deg)":this._rotationAlignment==="map"&&(h="rotateZ("+(this._rotation-this._map.getBearing())+"deg)");var _="";this._pitchAlignment==="viewport"||this._pitchAlignment==="auto"?_="rotateX(0deg)":this._pitchAlignment==="map"&&(_="rotateX("+this._map.getPitch()+"deg)"),o&&o.type!=="moveend"||(this._pos=this._pos.round()),T.setTransform(this._element,Ia[this._anchor]+" translate("+this._pos.x+"px, "+this._pos.y+"px) "+_+" "+h)}},s.prototype.getOffset=function(){return this._offset},s.prototype.setOffset=function(o){return this._offset=a.Point.convert(o),this._update(),this},s.prototype._onMove=function(o){if(!this._isDragging){var h=this._clickTolerance||this._map._clickTolerance;this._isDragging=o.point.dist(this._pointerdownPos)>=h}this._isDragging&&(this._pos=o.point.sub(this._positionDelta),this._lngLat=this._map.unproject(this._pos),this.setLngLat(this._lngLat),this._element.style.pointerEvents="none",this._state==="pending"&&(this._state="active",this.fire(new a.Event("dragstart"))),this.fire(new a.Event("drag")))},s.prototype._onUp=function(){this._element.style.pointerEvents="auto",this._positionDelta=null,this._pointerdownPos=null,this._isDragging=!1,this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),this._state==="active"&&this.fire(new a.Event("dragend")),this._state="inactive"},s.prototype._addDragHandler=function(o){this._element.contains(o.originalEvent.target)&&(o.preventDefault(),this._positionDelta=o.point.sub(this._pos).add(this._offset),this._pointerdownPos=o.point,this._state="pending",this._map.on("mousemove",this._onMove),this._map.on("touchmove",this._onMove),this._map.once("mouseup",this._onUp),this._map.once("touchend",this._onUp))},s.prototype.setDraggable=function(o){return this._draggable=!!o,this._map&&(o?(this._map.on("mousedown",this._addDragHandler),this._map.on("touchstart",this._addDragHandler)):(this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler))),this},s.prototype.isDraggable=function(){return this._draggable},s.prototype.setRotation=function(o){return this._rotation=o||0,this._update(),this},s.prototype.getRotation=function(){return this._rotation},s.prototype.setRotationAlignment=function(o){return this._rotationAlignment=o||"auto",this._update(),this},s.prototype.getRotationAlignment=function(){return this._rotationAlignment},s.prototype.setPitchAlignment=function(o){return this._pitchAlignment=o&&o!=="auto"?o:this._rotationAlignment,this._update(),this},s.prototype.getPitchAlignment=function(){return this._pitchAlignment},s}(a.Evented),au={positionOptions:{enableHighAccuracy:!1,maximumAge:0,timeout:6e3},fitBoundsOptions:{maxZoom:15},trackUserLocation:!1,showAccuracyCircle:!0,showUserLocation:!0},Ko=0,To=!1,ou=function(n){function s(o){n.call(this),this.options=a.extend({},au,o),a.bindAll(["_onSuccess","_onError","_onZoom","_finish","_setupUI","_updateCamera","_updateMarker"],this)}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype.onAdd=function(o){var h;return this._map=o,this._container=T.create("div","mapboxgl-ctrl mapboxgl-ctrl-group"),h=this._setupUI,Zo!==void 0?h(Zo):a.window.navigator.permissions!==void 0?a.window.navigator.permissions.query({name:"geolocation"}).then(function(_){h(Zo=_.state!=="denied")}):h(Zo=!!a.window.navigator.geolocation),this._container},s.prototype.onRemove=function(){this._geolocationWatchID!==void 0&&(a.window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0),this.options.showUserLocation&&this._userLocationDotMarker&&this._userLocationDotMarker.remove(),this.options.showAccuracyCircle&&this._accuracyCircleMarker&&this._accuracyCircleMarker.remove(),T.remove(this._container),this._map.off("zoom",this._onZoom),this._map=void 0,Ko=0,To=!1},s.prototype._isOutOfMapMaxBounds=function(o){var h=this._map.getMaxBounds(),_=o.coords;return h&&(_.longitude<h.getWest()||_.longitude>h.getEast()||_.latitude<h.getSouth()||_.latitude>h.getNorth())},s.prototype._setErrorState=function(){switch(this._watchState){case"WAITING_ACTIVE":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error");break;case"ACTIVE_LOCK":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting");break;case"BACKGROUND":this._watchState="BACKGROUND_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting")}},s.prototype._onSuccess=function(o){if(this._map){if(this._isOutOfMapMaxBounds(o))return this._setErrorState(),this.fire(new a.Event("outofmaxbounds",o)),this._updateMarker(),void this._finish();if(this.options.trackUserLocation)switch(this._lastKnownPosition=o,this._watchState){case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"BACKGROUND":case"BACKGROUND_ERROR":this._watchState="BACKGROUND",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background")}this.options.showUserLocation&&this._watchState!=="OFF"&&this._updateMarker(o),this.options.trackUserLocation&&this._watchState!=="ACTIVE_LOCK"||this._updateCamera(o),this.options.showUserLocation&&this._dotElement.classList.remove("mapboxgl-user-location-dot-stale"),this.fire(new a.Event("geolocate",o)),this._finish()}},s.prototype._updateCamera=function(o){var h=new a.LngLat(o.coords.longitude,o.coords.latitude),_=o.coords.accuracy,w=this._map.getBearing(),S=a.extend({bearing:w},this.options.fitBoundsOptions);this._map.fitBounds(h.toBounds(_),S,{geolocateSource:!0})},s.prototype._updateMarker=function(o){if(o){var h=new a.LngLat(o.coords.longitude,o.coords.latitude);this._accuracyCircleMarker.setLngLat(h).addTo(this._map),this._userLocationDotMarker.setLngLat(h).addTo(this._map),this._accuracy=o.coords.accuracy,this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}else this._userLocationDotMarker.remove(),this._accuracyCircleMarker.remove()},s.prototype._updateCircleRadius=function(){var o=this._map._container.clientHeight/2,h=this._map.unproject([0,o]),_=this._map.unproject([1,o]),w=h.distanceTo(_),S=Math.ceil(2*this._accuracy/w);this._circleElement.style.width=S+"px",this._circleElement.style.height=S+"px"},s.prototype._onZoom=function(){this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()},s.prototype._onError=function(o){if(this._map){if(this.options.trackUserLocation)if(o.code===1){this._watchState="OFF",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.disabled=!0;var h=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.title=h,this._geolocateButton.setAttribute("aria-label",h),this._geolocationWatchID!==void 0&&this._clearWatch()}else{if(o.code===3&&To)return;this._setErrorState()}this._watchState!=="OFF"&&this.options.showUserLocation&&this._dotElement.classList.add("mapboxgl-user-location-dot-stale"),this.fire(new a.Event("error",o)),this._finish()}},s.prototype._finish=function(){this._timeoutId&&clearTimeout(this._timeoutId),this._timeoutId=void 0},s.prototype._setupUI=function(o){var h=this;if(this._container.addEventListener("contextmenu",function(S){return S.preventDefault()}),this._geolocateButton=T.create("button","mapboxgl-ctrl-geolocate",this._container),T.create("span","mapboxgl-ctrl-icon",this._geolocateButton).setAttribute("aria-hidden",!0),this._geolocateButton.type="button",o===!1){a.warnOnce("Geolocation support is not available so the GeolocateControl will be disabled.");var _=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.disabled=!0,this._geolocateButton.title=_,this._geolocateButton.setAttribute("aria-label",_)}else{var w=this._map._getUIString("GeolocateControl.FindMyLocation");this._geolocateButton.title=w,this._geolocateButton.setAttribute("aria-label",w)}this.options.trackUserLocation&&(this._geolocateButton.setAttribute("aria-pressed","false"),this._watchState="OFF"),this.options.showUserLocation&&(this._dotElement=T.create("div","mapboxgl-user-location-dot"),this._userLocationDotMarker=new bs(this._dotElement),this._circleElement=T.create("div","mapboxgl-user-location-accuracy-circle"),this._accuracyCircleMarker=new bs({element:this._circleElement,pitchAlignment:"map"}),this.options.trackUserLocation&&(this._watchState="OFF"),this._map.on("zoom",this._onZoom)),this._geolocateButton.addEventListener("click",this.trigger.bind(this)),this._setup=!0,this.options.trackUserLocation&&this._map.on("movestart",function(S){S.geolocateSource||h._watchState!=="ACTIVE_LOCK"||S.originalEvent&&S.originalEvent.type==="resize"||(h._watchState="BACKGROUND",h._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background"),h._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),h.fire(new a.Event("trackuserlocationend")))})},s.prototype.trigger=function(){if(!this._setup)return a.warnOnce("Geolocate control triggered before added to a map"),!1;if(this.options.trackUserLocation){switch(this._watchState){case"OFF":this._watchState="WAITING_ACTIVE",this.fire(new a.Event("trackuserlocationstart"));break;case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":case"BACKGROUND_ERROR":Ko--,To=!1,this._watchState="OFF",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this.fire(new a.Event("trackuserlocationend"));break;case"BACKGROUND":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._lastKnownPosition&&this._updateCamera(this._lastKnownPosition),this.fire(new a.Event("trackuserlocationstart"))}switch(this._watchState){case"WAITING_ACTIVE":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"ACTIVE_LOCK":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"ACTIVE_ERROR":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error");break;case"BACKGROUND":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background");break;case"BACKGROUND_ERROR":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background-error")}if(this._watchState==="OFF"&&this._geolocationWatchID!==void 0)this._clearWatch();else if(this._geolocationWatchID===void 0){var o;this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","true"),++Ko>1?(o={maximumAge:6e5,timeout:0},To=!0):(o=this.options.positionOptions,To=!1),this._geolocationWatchID=a.window.navigator.geolocation.watchPosition(this._onSuccess,this._onError,o)}}else a.window.navigator.geolocation.getCurrentPosition(this._onSuccess,this._onError,this.options.positionOptions),this._timeoutId=setTimeout(this._finish,1e4);return!0},s.prototype._clearWatch=function(){a.window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0,this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","false"),this.options.showUserLocation&&this._updateMarker(null)},s}(a.Evented),Wa={maxWidth:100,unit:"metric"},Ya=function(n){this.options=a.extend({},Wa,n),a.bindAll(["_onMove","setUnit"],this)};function tl(n,s,o){var h=o&&o.maxWidth||100,_=n._container.clientHeight/2,w=n.unproject([0,_]),S=n.unproject([h,_]),I=w.distanceTo(S);if(o&&o.unit==="imperial"){var P=3.2808*I;P>5280?Ja(s,h,P/5280,n._getUIString("ScaleControl.Miles")):Ja(s,h,P,n._getUIString("ScaleControl.Feet"))}else o&&o.unit==="nautical"?Ja(s,h,I/1852,n._getUIString("ScaleControl.NauticalMiles")):I>=1e3?Ja(s,h,I/1e3,n._getUIString("ScaleControl.Kilometers")):Ja(s,h,I,n._getUIString("ScaleControl.Meters"))}function Ja(n,s,o,h){var _,w,S,I=(_=o,(w=Math.pow(10,(""+Math.floor(_)).length-1))*(S=(S=_/w)>=10?10:S>=5?5:S>=3?3:S>=2?2:S>=1?1:function(P){var O=Math.pow(10,Math.ceil(-Math.log(P)/Math.LN10));return Math.round(P*O)/O}(S)));n.style.width=s*(I/o)+"px",n.innerHTML=I+"&nbsp;"+h}Ya.prototype.getDefaultPosition=function(){return"bottom-left"},Ya.prototype._onMove=function(){tl(this._map,this._container,this.options)},Ya.prototype.onAdd=function(n){return this._map=n,this._container=T.create("div","mapboxgl-ctrl mapboxgl-ctrl-scale",n.getContainer()),this._map.on("move",this._onMove),this._onMove(),this._container},Ya.prototype.onRemove=function(){T.remove(this._container),this._map.off("move",this._onMove),this._map=void 0},Ya.prototype.setUnit=function(n){this.options.unit=n,tl(this._map,this._container,this.options)};var aa=function(n){this._fullscreen=!1,n&&n.container&&(n.container instanceof a.window.HTMLElement?this._container=n.container:a.warnOnce("Full screen control 'container' must be a DOM element.")),a.bindAll(["_onClickFullscreen","_changeIcon"],this),"onfullscreenchange"in a.window.document?this._fullscreenchange="fullscreenchange":"onmozfullscreenchange"in a.window.document?this._fullscreenchange="mozfullscreenchange":"onwebkitfullscreenchange"in a.window.document?this._fullscreenchange="webkitfullscreenchange":"onmsfullscreenchange"in a.window.document&&(this._fullscreenchange="MSFullscreenChange")};aa.prototype.onAdd=function(n){return this._map=n,this._container||(this._container=this._map.getContainer()),this._controlContainer=T.create("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._checkFullscreenSupport()?this._setupUI():(this._controlContainer.style.display="none",a.warnOnce("This device does not support fullscreen mode.")),this._controlContainer},aa.prototype.onRemove=function(){T.remove(this._controlContainer),this._map=null,a.window.document.removeEventListener(this._fullscreenchange,this._changeIcon)},aa.prototype._checkFullscreenSupport=function(){return!!(a.window.document.fullscreenEnabled||a.window.document.mozFullScreenEnabled||a.window.document.msFullscreenEnabled||a.window.document.webkitFullscreenEnabled)},aa.prototype._setupUI=function(){var n=this._fullscreenButton=T.create("button","mapboxgl-ctrl-fullscreen",this._controlContainer);T.create("span","mapboxgl-ctrl-icon",n).setAttribute("aria-hidden",!0),n.type="button",this._updateTitle(),this._fullscreenButton.addEventListener("click",this._onClickFullscreen),a.window.document.addEventListener(this._fullscreenchange,this._changeIcon)},aa.prototype._updateTitle=function(){var n=this._getTitle();this._fullscreenButton.setAttribute("aria-label",n),this._fullscreenButton.title=n},aa.prototype._getTitle=function(){return this._map._getUIString(this._isFullscreen()?"FullscreenControl.Exit":"FullscreenControl.Enter")},aa.prototype._isFullscreen=function(){return this._fullscreen},aa.prototype._changeIcon=function(){(a.window.document.fullscreenElement||a.window.document.mozFullScreenElement||a.window.document.webkitFullscreenElement||a.window.document.msFullscreenElement)===this._container!==this._fullscreen&&(this._fullscreen=!this._fullscreen,this._fullscreenButton.classList.toggle("mapboxgl-ctrl-shrink"),this._fullscreenButton.classList.toggle("mapboxgl-ctrl-fullscreen"),this._updateTitle())},aa.prototype._onClickFullscreen=function(){this._isFullscreen()?a.window.document.exitFullscreen?a.window.document.exitFullscreen():a.window.document.mozCancelFullScreen?a.window.document.mozCancelFullScreen():a.window.document.msExitFullscreen?a.window.document.msExitFullscreen():a.window.document.webkitCancelFullScreen&&a.window.document.webkitCancelFullScreen():this._container.requestFullscreen?this._container.requestFullscreen():this._container.mozRequestFullScreen?this._container.mozRequestFullScreen():this._container.msRequestFullscreen?this._container.msRequestFullscreen():this._container.webkitRequestFullscreen&&this._container.webkitRequestFullscreen()};var su={closeButton:!0,closeOnClick:!0,focusAfterOpen:!0,className:"",maxWidth:"240px"},xs=["a[href]","[tabindex]:not([tabindex='-1'])","[contenteditable]:not([contenteditable='false'])","button:not([disabled])","input:not([disabled])","select:not([disabled])","textarea:not([disabled])"].join(", "),lu=function(n){function s(o){n.call(this),this.options=a.extend(Object.create(su),o),a.bindAll(["_update","_onClose","remove","_onMouseMove","_onMouseUp","_onDrag"],this)}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype.addTo=function(o){return this._map&&this.remove(),this._map=o,this.options.closeOnClick&&this._map.on("click",this._onClose),this.options.closeOnMove&&this._map.on("move",this._onClose),this._map.on("remove",this.remove),this._update(),this._focusFirstElement(),this._trackPointer?(this._map.on("mousemove",this._onMouseMove),this._map.on("mouseup",this._onMouseUp),this._container&&this._container.classList.add("mapboxgl-popup-track-pointer"),this._map._canvasContainer.classList.add("mapboxgl-track-pointer")):this._map.on("move",this._update),this.fire(new a.Event("open")),this},s.prototype.isOpen=function(){return!!this._map},s.prototype.remove=function(){return this._content&&T.remove(this._content),this._container&&(T.remove(this._container),delete this._container),this._map&&(this._map.off("move",this._update),this._map.off("move",this._onClose),this._map.off("click",this._onClose),this._map.off("remove",this.remove),this._map.off("mousemove",this._onMouseMove),this._map.off("mouseup",this._onMouseUp),this._map.off("drag",this._onDrag),delete this._map),this.fire(new a.Event("close")),this},s.prototype.getLngLat=function(){return this._lngLat},s.prototype.setLngLat=function(o){return this._lngLat=a.LngLat.convert(o),this._pos=null,this._trackPointer=!1,this._update(),this._map&&(this._map.on("move",this._update),this._map.off("mousemove",this._onMouseMove),this._container&&this._container.classList.remove("mapboxgl-popup-track-pointer"),this._map._canvasContainer.classList.remove("mapboxgl-track-pointer")),this},s.prototype.trackPointer=function(){return this._trackPointer=!0,this._pos=null,this._update(),this._map&&(this._map.off("move",this._update),this._map.on("mousemove",this._onMouseMove),this._map.on("drag",this._onDrag),this._container&&this._container.classList.add("mapboxgl-popup-track-pointer"),this._map._canvasContainer.classList.add("mapboxgl-track-pointer")),this},s.prototype.getElement=function(){return this._container},s.prototype.setText=function(o){return this.setDOMContent(a.window.document.createTextNode(o))},s.prototype.setHTML=function(o){var h,_=a.window.document.createDocumentFragment(),w=a.window.document.createElement("body");for(w.innerHTML=o;h=w.firstChild;)_.appendChild(h);return this.setDOMContent(_)},s.prototype.getMaxWidth=function(){return this._container&&this._container.style.maxWidth},s.prototype.setMaxWidth=function(o){return this.options.maxWidth=o,this._update(),this},s.prototype.setDOMContent=function(o){if(this._content)for(;this._content.hasChildNodes();)this._content.firstChild&&this._content.removeChild(this._content.firstChild);else this._content=T.create("div","mapboxgl-popup-content",this._container);return this._content.appendChild(o),this._createCloseButton(),this._update(),this._focusFirstElement(),this},s.prototype.addClassName=function(o){this._container&&this._container.classList.add(o)},s.prototype.removeClassName=function(o){this._container&&this._container.classList.remove(o)},s.prototype.setOffset=function(o){return this.options.offset=o,this._update(),this},s.prototype.toggleClassName=function(o){if(this._container)return this._container.classList.toggle(o)},s.prototype._createCloseButton=function(){this.options.closeButton&&(this._closeButton=T.create("button","mapboxgl-popup-close-button",this._content),this._closeButton.type="button",this._closeButton.setAttribute("aria-label","Close popup"),this._closeButton.innerHTML="&#215;",this._closeButton.addEventListener("click",this._onClose))},s.prototype._onMouseUp=function(o){this._update(o.point)},s.prototype._onMouseMove=function(o){this._update(o.point)},s.prototype._onDrag=function(o){this._update(o.point)},s.prototype._update=function(o){var h=this;if(this._map&&(this._lngLat||this._trackPointer)&&this._content&&(this._container||(this._container=T.create("div","mapboxgl-popup",this._map.getContainer()),this._tip=T.create("div","mapboxgl-popup-tip",this._container),this._container.appendChild(this._content),this.options.className&&this.options.className.split(" ").forEach(function(Z){return h._container.classList.add(Z)}),this._trackPointer&&this._container.classList.add("mapboxgl-popup-track-pointer")),this.options.maxWidth&&this._container.style.maxWidth!==this.options.maxWidth&&(this._container.style.maxWidth=this.options.maxWidth),this._map.transform.renderWorldCopies&&!this._trackPointer&&(this._lngLat=Go(this._lngLat,this._pos,this._map.transform)),!this._trackPointer||o)){var _=this._pos=this._trackPointer&&o?o:this._map.project(this._lngLat),w=this.options.anchor,S=function Z(H){if(H){if(typeof H=="number"){var te=Math.round(Math.sqrt(.5*Math.pow(H,2)));return{center:new a.Point(0,0),top:new a.Point(0,H),"top-left":new a.Point(te,te),"top-right":new a.Point(-te,te),bottom:new a.Point(0,-H),"bottom-left":new a.Point(te,-te),"bottom-right":new a.Point(-te,-te),left:new a.Point(H,0),right:new a.Point(-H,0)}}if(H instanceof a.Point||Array.isArray(H)){var ee=a.Point.convert(H);return{center:ee,top:ee,"top-left":ee,"top-right":ee,bottom:ee,"bottom-left":ee,"bottom-right":ee,left:ee,right:ee}}return{center:a.Point.convert(H.center||[0,0]),top:a.Point.convert(H.top||[0,0]),"top-left":a.Point.convert(H["top-left"]||[0,0]),"top-right":a.Point.convert(H["top-right"]||[0,0]),bottom:a.Point.convert(H.bottom||[0,0]),"bottom-left":a.Point.convert(H["bottom-left"]||[0,0]),"bottom-right":a.Point.convert(H["bottom-right"]||[0,0]),left:a.Point.convert(H.left||[0,0]),right:a.Point.convert(H.right||[0,0])}}return Z(new a.Point(0,0))}(this.options.offset);if(!w){var I,P=this._container.offsetWidth,O=this._container.offsetHeight;I=_.y+S.bottom.y<O?["top"]:_.y>this._map.transform.height-O?["bottom"]:[],_.x<P/2?I.push("left"):_.x>this._map.transform.width-P/2&&I.push("right"),w=I.length===0?"bottom":I.join("-")}var G=_.add(S[w]).round();T.setTransform(this._container,Ia[w]+" translate("+G.x+"px,"+G.y+"px)"),el(this._container,w,"popup")}},s.prototype._focusFirstElement=function(){if(this.options.focusAfterOpen&&this._container){var o=this._container.querySelector(xs);o&&o.focus()}},s.prototype._onClose=function(){this.remove()},s}(a.Evented),rl={version:a.version,supported:E,setRTLTextPlugin:a.setRTLTextPlugin,getRTLTextPluginStatus:a.getRTLTextPluginStatus,Map:Tc,NavigationControl:Da,GeolocateControl:ou,AttributionControl:_n,ScaleControl:Ya,FullscreenControl:aa,Popup:lu,Marker:bs,Style:Nn,LngLat:a.LngLat,LngLatBounds:a.LngLatBounds,Point:a.Point,MercatorCoordinate:a.MercatorCoordinate,Evented:a.Evented,config:a.config,prewarm:function(){Ie().acquire(ke)},clearPrewarmedResources:function(){var n=pt;n&&(n.isPreloaded()&&n.numActive()===1?(n.release(ke),pt=null):console.warn("Could not clear WebWorkers since there are active Map instances that still reference it. The pre-warmed WebWorker pool can only be cleared when all map instances have been removed with map.remove()"))},get accessToken(){return a.config.ACCESS_TOKEN},set accessToken(n){a.config.ACCESS_TOKEN=n},get baseApiUrl(){return a.config.API_URL},set baseApiUrl(n){a.config.API_URL=n},get workerCount(){return Le.workerCount},set workerCount(n){Le.workerCount=n},get maxParallelImageRequests(){return a.config.MAX_PARALLEL_IMAGE_REQUESTS},set maxParallelImageRequests(n){a.config.MAX_PARALLEL_IMAGE_REQUESTS=n},clearStorage:function(n){a.clearTileCache(n)},workerUrl:""};return rl}),y})})(hy);var vh=hy.exports;const X_=v_(vh);function kd(l){let c;const d=l[15].default,p=Ou(d,l,l[14],null);return{c(){p&&p.c()},l(y){p&&p.l(y)},m(y,v){p&&p.m(y,v),c=!0},p(y,v){p&&p.p&&(!c||v&16384)&&Fu(p,d,y,y[14],c?Vu(d,y[14],v,null):Nu(y[14]),null)},i(y){c||(tt(p,y),c=!0)},o(y){ct(p,y),c=!1},d(y){p&&p.d(y)}}}function W_(l){let c,d,p,y=l[0]&&kd(l);return{c(){c=Ue("div"),y&&y.c(),this.h()},l(v){c=qe(v,"DIV",{class:!0,id:!0});var a=Oe(c);y&&y.l(a),a.forEach(ne),this.h()},h(){ie(c,"class","absolute top-0 bg-grey4 w-full h-full svelte-a65d1y"),ie(c,"id",l[1]),Gu(()=>l[16].call(c))},m(v,a){Re(v,c,a),y&&y.m(c,null),d=Zu(c,l[16].bind(c)),l[17](c),p=!0},p(v,[a]){v[0]?y?(y.p(v,a),a&1&&tt(y,1)):(y=kd(v),y.c(),tt(y,1),y.m(c,null)):y&&(kn(),ct(y,1,1,()=>{y=null}),En()),(!p||a&2)&&ie(c,"id",v[1])},i(v){p||(tt(y),p=!0)},o(v){ct(y),p=!1},d(v){v&&ne(c),y&&y.d(),d(),l[17](null)}}}function Y_(l,c,d){let{$$slots:p={},$$scope:y}=c,{map:v}=c,{id:a="map"}=c,{location:E={bounds:[[-8.1775,54.02275],[-5.43279,55.31298]]}}=c,{style:T="https://raw.githubusercontent.com/NISRA-Tech-Lab/map_tiles/main/basemap_styles/style-omt.json"}=c,{interactive:L=!0}=c,{minzoom:F=0}=c,{maxzoom:C=14}=c,{zoom:M=null}=c,{scrollzoom:X=!0}=c,{geolocate:ae=!0}=c,{zoomcontrol:se=!0}=c,{options:he={}}=c,me,_e;oy("map",{getMap:()=>v}),E.bounds?he={...he,bounds:E.bounds}:E.lon&&E.lat&&(he={...he,center:[E.lon,E.lat]},E.zoom&&(he.zoom=E.zoom)),Vp(()=>{const Ze=document.createElement("link");return Ze.rel="stylesheet",Ze.href="https://unpkg.com/mapbox-gl@1.13.0/dist/mapbox-gl.css",Ze.onload=()=>{d(0,v=new vh.Map({container:me,style:T,minZoom:F,maxZoom:C,maxBounds:[[-9.2,53.58],[-4.53,55.72]],interactive:L,...he})),se&&v.addControl(new vh.NavigationControl({showCompass:!1})),X||v.scrollZoom.disable(),ae&&v.addControl(new vh.GeolocateControl),v.on("load",()=>{d(4,M=v.getZoom())}),v.on("zoom",()=>{d(4,M=v.getZoom())})},document.head.appendChild(Ze),()=>{v.remove(),Ze.parentNode.removeChild(Ze)}});function it(){let Ze=document.getElementsByClassName("mapboxgl-canvas");Ze[0]&&(Ze[0].style.width="100%",v.resize())}function Fe(){_e=this.clientWidth,d(2,_e)}function Pe(Ze){Rs[Ze?"unshift":"push"](()=>{me=Ze,d(3,me)})}return l.$$set=Ze=>{"map"in Ze&&d(0,v=Ze.map),"id"in Ze&&d(1,a=Ze.id),"location"in Ze&&d(6,E=Ze.location),"style"in Ze&&d(7,T=Ze.style),"interactive"in Ze&&d(8,L=Ze.interactive),"minzoom"in Ze&&d(9,F=Ze.minzoom),"maxzoom"in Ze&&d(10,C=Ze.maxzoom),"zoom"in Ze&&d(4,M=Ze.zoom),"scrollzoom"in Ze&&d(11,X=Ze.scrollzoom),"geolocate"in Ze&&d(12,ae=Ze.geolocate),"zoomcontrol"in Ze&&d(13,se=Ze.zoomcontrol),"options"in Ze&&d(5,he=Ze.options),"$$scope"in Ze&&d(14,y=Ze.$$scope)},l.$$.update=()=>{l.$$.dirty&4&&_e&&it()},[v,a,_e,me,M,he,E,T,L,F,C,X,ae,se,y,p,Fe,Pe]}class J_ extends on{constructor(c){super(),sn(this,c,Y_,W_,ln,{map:0,id:1,location:6,style:7,interactive:8,minzoom:9,maxzoom:10,zoom:4,scrollzoom:11,geolocate:12,zoomcontrol:13,options:5})}}function Ed(l){let c;const d=l[11].default,p=Ou(d,l,l[10],null);return{c(){p&&p.c()},l(y){p&&p.l(y)},m(y,v){p&&p.m(y,v),c=!0},p(y,v){p&&p.p&&(!c||v&1024)&&Fu(p,d,y,y[10],c?Vu(d,y[10],v,null):Nu(y[10]),null)},i(y){c||(tt(p,y),c=!0)},o(y){ct(p,y),c=!1},d(y){p&&p.d(y)}}}function Q_(l){let c,d,p=l[0]&&Ed(l);return{c(){p&&p.c(),c=or()},l(y){p&&p.l(y),c=or()},m(y,v){p&&p.m(y,v),Re(y,c,v),d=!0},p(y,[v]){y[0]?p?(p.p(y,v),v&1&&tt(p,1)):(p=Ed(y),p.c(),tt(p,1),p.m(c.parentNode,c)):p&&(kn(),ct(p,1,1,()=>{p=null}),En())},i(y){d||(tt(p),d=!0)},o(y){ct(p),d=!1},d(y){p&&p.d(y),y&&ne(c)}}}function $_(l,c,d){let{$$slots:p={},$$scope:y}=c,{id:v}=c,{type:a}=c,{url:E=null}=c,{props:T={}}=c,{data:L=null}=c,{layer:F=null}=c,{promoteId:C=null}=c,{minzoom:M=null}=c,{maxzoom:X=null}=c,ae=!1;const{getMap:se}=Ku("map"),he=se();he.getSource(v)&&he.removeSource(v);function me(){he.isSourceLoaded(v)?(d(0,ae=!0),console.log(v+" loaded!")):setTimeout(()=>{console.log("..."),me()},500)}function _e(){he.isStyleLoaded(v)?(it(),document.querySelector("#map canvas")&&document.querySelector("#map canvas").tabIndex=="0"&&(document.querySelector("#map canvas").tabIndex="-1")):setTimeout(()=>{console.log("..."),_e()},500)}M&&(T.minzoom=M),X&&(T.maxzoom=X),F&&C?(T.promoteId={},T.promoteId[F]=C):C&&(T.promoteId=C);function it(){console.log(v+" map source loading..."),a=="geojson"?L?(he.addSource(v,{type:a,data:L,...T}),me()):E&&(he.addSource(v,{type:a,data:E,...T}),me()):a=="vector"&&(he.addSource(v,{type:a,tiles:[E],...T}),me())}_e();function Fe(){he.getSource(v).setData(L)}return l.$$set=Pe=>{"id"in Pe&&d(2,v=Pe.id),"type"in Pe&&d(3,a=Pe.type),"url"in Pe&&d(4,E=Pe.url),"props"in Pe&&d(1,T=Pe.props),"data"in Pe&&d(5,L=Pe.data),"layer"in Pe&&d(6,F=Pe.layer),"promoteId"in Pe&&d(7,C=Pe.promoteId),"minzoom"in Pe&&d(8,M=Pe.minzoom),"maxzoom"in Pe&&d(9,X=Pe.maxzoom),"$$scope"in Pe&&d(10,y=Pe.$$scope)},l.$$.update=()=>{l.$$.dirty&33&&ae&&L&&Fe()},[ae,T,v,a,E,L,F,C,M,X,y,p]}class ev extends on{constructor(c){super(),sn(this,c,$_,Q_,ln,{id:2,type:3,url:4,props:1,data:5,layer:6,promoteId:7,minzoom:8,maxzoom:9})}}function tv(l,c,d){const{Popup:p}=X_,y=h_(),v=new p({closeButton:!1,closeOnClick:!1});let{id:a}=c,{source:E}=c,{sourceLayer:T=null}=c,{type:L}=c,{filter:F=null}=c,{layout:C={}}=c,{paint:M={}}=c,{data:X=null}=c,{code:ae=null}=c,{name:se="name"}=c,{colorCode:he=null}=c,{click:me=!1}=c,{ignoreClick:_e=!1}=c,{clickCenter:it=!1}=c,{selected:Fe=null}=c,{hover:Pe=!1}=c,{hovered:Ze=null}=c,{highlight:Ct=!1}=c,{highlightKey:kt="highlighted"}=c,{highlighted:Ge=[]}=c,{order:Ke=null}=c,{maxzoom:gt=null}=c,{minzoom:ur=null}=c,{isChild:je=!1}=c;const{getMap:Ft}=Ku("map"),Be=Ft();let $e=null,yt=null,jt=[];Be.getLayer(a)&&Be.removeLayer(a);let Lt={id:a,type:L,source:E,paint:M,layout:C};F&&(Lt.filter=F),T&&(Lt["source-layer"]=T),gt&&(Lt.maxzoom=gt),ur&&(Lt.minzoom=ur),Be.addLayer(Lt,Ke);function St(){console.log("updating colors..."),X.forEach(Ce=>{Be.setFeatureState({source:E,sourceLayer:T,id:Ce[ae]},{color:Ce[he]})})}return me&&Be.on("click",a,Ce=>{if(Ce.features.length>0&&!_e){let ot=Ce.features[0].id;if(je&&Ge.includes(ot)||!je&&Fe!=ot){if(d(0,Fe=ot),y("select",{code:Fe}),$e&&Be.setFeatureState({source:E,sourceLayer:T,id:$e},{selected:!1}),Be.setFeatureState({source:E,sourceLayer:T,id:Fe},{selected:!0}),it){let Dr=centroid(Ce.features[0].toJSON().geometry);Be.flyTo({center:Dr.geometry.coordinates})}d(24,$e=Fe)}}}),Pe&&(Be.on("mousemove",a,Ce=>{if(Ce.features.length>0){let ot=Ce.features[0].id;Ze&&Be.setFeatureState({source:E,sourceLayer:T,id:Ze},{hovered:!1}),je&&Ge.includes(ot)||!je&&Fe!=ot?(d(1,Ze=d(25,yt=ot)),Be.setFeatureState({source:E,sourceLayer:T,id:Ze},{hovered:!0}),Be.getCanvas().style.cursor="pointer",v.setLngLat(Ce.lngLat).setHTML(`<strong>${Ce.features[0].properties[se]?Ce.features[0].properties[se]:Ce.features[0].properties[ae]}</strong>`).addTo(Be)):v.remove()}}),Be.on("mouseleave",a,Ce=>{Ze&&Be.setFeatureState({source:E,sourceLayer:T,id:Ze},{hovered:!1}),d(1,Ze=d(25,yt=null)),Be.getCanvas().style.cursor="",v.remove()})),l.$$set=Ce=>{"id"in Ce&&d(2,a=Ce.id),"source"in Ce&&d(3,E=Ce.source),"sourceLayer"in Ce&&d(4,T=Ce.sourceLayer),"type"in Ce&&d(5,L=Ce.type),"filter"in Ce&&d(6,F=Ce.filter),"layout"in Ce&&d(7,C=Ce.layout),"paint"in Ce&&d(8,M=Ce.paint),"data"in Ce&&d(9,X=Ce.data),"code"in Ce&&d(10,ae=Ce.code),"name"in Ce&&d(11,se=Ce.name),"colorCode"in Ce&&d(12,he=Ce.colorCode),"click"in Ce&&d(13,me=Ce.click),"ignoreClick"in Ce&&d(14,_e=Ce.ignoreClick),"clickCenter"in Ce&&d(15,it=Ce.clickCenter),"selected"in Ce&&d(0,Fe=Ce.selected),"hover"in Ce&&d(16,Pe=Ce.hover),"hovered"in Ce&&d(1,Ze=Ce.hovered),"highlight"in Ce&&d(17,Ct=Ce.highlight),"highlightKey"in Ce&&d(18,kt=Ce.highlightKey),"highlighted"in Ce&&d(19,Ge=Ce.highlighted),"order"in Ce&&d(20,Ke=Ce.order),"maxzoom"in Ce&&d(21,gt=Ce.maxzoom),"minzoom"in Ce&&d(22,ur=Ce.minzoom),"isChild"in Ce&&d(23,je=Ce.isChild)},l.$$.update=()=>{l.$$.dirty[0]&4096&&he&&St(),l.$$.dirty[0]&68026392&&Ct&&Ge!=jt&&(jt[0]&&jt.forEach(Ce=>{let ot={};ot[kt]=!1,Be.setFeatureState({source:E,sourceLayer:T,id:Ce},ot)}),d(26,jt=Ge),Ge[0]&&Ge.forEach(Ce=>{let ot={};ot[kt]=!0,Be.setFeatureState({source:E,sourceLayer:T,id:Ce},ot)})),l.$$.dirty[0]&16777241&&Fe!=$e&&($e&&Be.setFeatureState({source:E,sourceLayer:T,id:$e},{selected:!1}),Fe&&Be.setFeatureState({source:E,sourceLayer:T,id:Fe},{selected:!0}),d(24,$e=Fe)),l.$$.dirty[0]&33619994&&Pe&&Ze!=yt&&(yt&&Be.setFeatureState({source:E,sourceLayer:T,id:yt},{hovered:!1}),Ze&&Be.setFeatureState({source:E,sourceLayer:T,id:Ze},{hovered:!0}),d(25,yt=Ze))},[Fe,Ze,a,E,T,L,F,C,M,X,ae,se,he,me,_e,it,Pe,Ct,kt,Ge,Ke,gt,ur,je,$e,yt,jt]}class Ap extends on{constructor(c){super(),sn(this,c,tv,null,ln,{id:2,source:3,sourceLayer:4,type:5,filter:6,layout:7,paint:8,data:9,code:10,name:11,colorCode:12,click:13,ignoreClick:14,clickCenter:15,selected:0,hover:16,hovered:1,highlight:17,highlightKey:18,highlighted:19,order:20,maxzoom:21,minzoom:22,isChild:23},null,[-1,-1])}}function rv(l){return l===0?!0:l}function es(l){return rv(l)?Array.isArray(l)?c=>l.map(d=>typeof d!="function"?c[d]:d(c)):typeof l!="function"?c=>c[l]:l:null}function iv(l){const c={};for(const d of l){if(Object(d)!==d)throw new TypeError("iterable for fromEntries should yield objects");const{"0":p,"1":y}=d;Object.defineProperty(c,p,{configurable:!0,enumerable:!0,writable:!0,value:y})}return c}function zp(l,c={}){return iv(Object.entries(l).filter(([d,p])=>p!==void 0&&c[d]===void 0))}function nv(l,c){if(!Array.isArray(l))throw new TypeError(`The first argument of calcExtents() must be an array. You passed in a ${typeof l}. Consider passing a flat array to the \`flatData\` prop. More info: https://layercake.graphics/guide/#flatdata`);if(Array.isArray(c)||c===void 0||c===null)throw new TypeError("The second argument of calcExtents() must be an object with field names as keys as accessor functions as values.");const d={},p=Object.keys(c),y=p.length;let v,a,E,T,L,F,C,M;const X=l.length;for(v=0;v<y;v+=1){for(T=p[v],C=c[T],L=null,F=null,a=0;a<X;a+=1)if(M=C(l[a]),Array.isArray(M)){const ae=M.length;for(E=0;E<ae;E+=1)M[E]!==void 0&&M[E]!==null&&Number.isNaN(M[E])===!1&&((L===null||M[E]<L)&&(L=M[E]),(F===null||M[E]>F)&&(F=M[E]))}else M!=null&&Number.isNaN(M)===!1&&((L===null||M<L)&&(L=M),(F===null||M>F)&&(F=M));d[T]=[L,F]}return d}function py(l=[],c){return Array.isArray(c)===!0?c.map((d,p)=>d===null?l[p]:d):l}function oh(l){return function([d,p]){return d?py(d[l],p):p}}function bh(l,c){return l==null||c==null?NaN:l<c?-1:l>c?1:l>=c?0:NaN}function av(l,c){return l==null||c==null?NaN:c<l?-1:c>l?1:c>=l?0:NaN}function fy(l){let c,d,p;l.length!==2?(c=bh,d=(E,T)=>bh(l(E),T),p=(E,T)=>l(E)-T):(c=l===bh||l===av?l:ov,d=l,p=l);function y(E,T,L=0,F=E.length){if(L<F){if(c(T,T)!==0)return F;do{const C=L+F>>>1;d(E[C],T)<0?L=C+1:F=C}while(L<F)}return L}function v(E,T,L=0,F=E.length){if(L<F){if(c(T,T)!==0)return F;do{const C=L+F>>>1;d(E[C],T)<=0?L=C+1:F=C}while(L<F)}return L}function a(E,T,L=0,F=E.length){const C=y(E,T,L,F-1);return C>L&&p(E[C-1],T)>-p(E[C],T)?C-1:C}return{left:y,center:a,right:v}}function ov(){return 0}function sv(l){return l===null?NaN:+l}const lv=fy(bh),uv=lv.right;fy(sv).center;const cv=uv;class Td extends Map{constructor(c,d=fv){if(super(),Object.defineProperties(this,{_intern:{value:new Map},_key:{value:d}}),c!=null)for(const[p,y]of c)this.set(p,y)}get(c){return super.get(Id(this,c))}has(c){return super.has(Id(this,c))}set(c,d){return super.set(hv(this,c),d)}delete(c){return super.delete(pv(this,c))}}function Id({_intern:l,_key:c},d){const p=c(d);return l.has(p)?l.get(p):d}function hv({_intern:l,_key:c},d){const p=c(d);return l.has(p)?l.get(p):(l.set(p,d),d)}function pv({_intern:l,_key:c},d){const p=c(d);return l.has(p)&&(d=l.get(p),l.delete(p)),d}function fv(l){return l!==null&&typeof l=="object"?l.valueOf():l}var Lp=Math.sqrt(50),Rp=Math.sqrt(10),Bp=Math.sqrt(2);function dv(l,c,d){var p,y=-1,v,a,E;if(c=+c,l=+l,d=+d,l===c&&d>0)return[l];if((p=c<l)&&(v=l,l=c,c=v),(E=dy(l,c,d))===0||!isFinite(E))return[];if(E>0){let T=Math.round(l/E),L=Math.round(c/E);for(T*E<l&&++T,L*E>c&&--L,a=new Array(v=L-T+1);++y<v;)a[y]=(T+y)*E}else{E=-E;let T=Math.round(l*E),L=Math.round(c*E);for(T/E<l&&++T,L/E>c&&--L,a=new Array(v=L-T+1);++y<v;)a[y]=(T+y)/E}return p&&a.reverse(),a}function dy(l,c,d){var p=(c-l)/Math.max(0,d),y=Math.floor(Math.log(p)/Math.LN10),v=p/Math.pow(10,y);return y>=0?(v>=Lp?10:v>=Rp?5:v>=Bp?2:1)*Math.pow(10,y):-Math.pow(10,-y)/(v>=Lp?10:v>=Rp?5:v>=Bp?2:1)}function mv(l,c,d){var p=Math.abs(c-l)/Math.max(0,d),y=Math.pow(10,Math.floor(Math.log(p)/Math.LN10)),v=p/y;return v>=Lp?y*=10:v>=Rp?y*=5:v>=Bp&&(y*=2),c<l?-y:y}function yv(l,c,d){l=+l,c=+c,d=(y=arguments.length)<2?(c=l,l=0,1):y<3?1:+d;for(var p=-1,y=Math.max(0,Math.ceil((c-l)/d))|0,v=new Array(y);++p<y;)v[p]=l+p*d;return v}function Dh(l,c){switch(arguments.length){case 0:break;case 1:this.range(l);break;default:this.range(c).domain(l);break}return this}const Ad=Symbol("implicit");function my(){var l=new Td,c=[],d=[],p=Ad;function y(v){let a=l.get(v);if(a===void 0){if(p!==Ad)return p;l.set(v,a=c.push(v)-1)}return d[a%d.length]}return y.domain=function(v){if(!arguments.length)return c.slice();c=[],l=new Td;for(const a of v)l.has(a)||l.set(a,c.push(a)-1);return y},y.range=function(v){return arguments.length?(d=Array.from(v),y):d.slice()},y.unknown=function(v){return arguments.length?(p=v,y):p},y.copy=function(){return my(c,d).unknown(p)},Dh.apply(y,arguments),y}function yy(){var l=my().unknown(void 0),c=l.domain,d=l.range,p=0,y=1,v,a,E=!1,T=0,L=0,F=.5;delete l.unknown;function C(){var M=c().length,X=y<p,ae=X?y:p,se=X?p:y;v=(se-ae)/Math.max(1,M-T+L*2),E&&(v=Math.floor(v)),ae+=(se-ae-v*(M-T))*F,a=v*(1-T),E&&(ae=Math.round(ae),a=Math.round(a));var he=yv(M).map(function(me){return ae+v*me});return d(X?he.reverse():he)}return l.domain=function(M){return arguments.length?(c(M),C()):c()},l.range=function(M){return arguments.length?([p,y]=M,p=+p,y=+y,C()):[p,y]},l.rangeRound=function(M){return[p,y]=M,p=+p,y=+y,E=!0,C()},l.bandwidth=function(){return a},l.step=function(){return v},l.round=function(M){return arguments.length?(E=!!M,C()):E},l.padding=function(M){return arguments.length?(T=Math.min(1,L=+M),C()):T},l.paddingInner=function(M){return arguments.length?(T=Math.min(1,M),C()):T},l.paddingOuter=function(M){return arguments.length?(L=+M,C()):L},l.align=function(M){return arguments.length?(F=Math.max(0,Math.min(1,M)),C()):F},l.copy=function(){return yy(c(),[p,y]).round(E).paddingInner(T).paddingOuter(L).align(F)},Dh.apply(C(),arguments)}function Kp(l,c,d){l.prototype=c.prototype=d,d.constructor=l}function gy(l,c){var d=Object.create(l.prototype);for(var p in c)d[p]=c[p];return d}function ec(){}var Uu=.7,kh=1/Uu,Ll="\\s*([+-]?\\d+)\\s*",qu="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",lo="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",gv=/^#([0-9a-f]{3,8})$/,_v=new RegExp(`^rgb\\(${Ll},${Ll},${Ll}\\)$`),vv=new RegExp(`^rgb\\(${lo},${lo},${lo}\\)$`),bv=new RegExp(`^rgba\\(${Ll},${Ll},${Ll},${qu}\\)$`),xv=new RegExp(`^rgba\\(${lo},${lo},${lo},${qu}\\)$`),wv=new RegExp(`^hsl\\(${qu},${lo},${lo}\\)$`),Sv=new RegExp(`^hsla\\(${qu},${lo},${lo},${qu}\\)$`),zd={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};Kp(ec,ju,{copy(l){return Object.assign(new this.constructor,this,l)},displayable(){return this.rgb().displayable()},hex:Pd,formatHex:Pd,formatHex8:kv,formatHsl:Ev,formatRgb:Cd,toString:Cd});function Pd(){return this.rgb().formatHex()}function kv(){return this.rgb().formatHex8()}function Ev(){return _y(this).formatHsl()}function Cd(){return this.rgb().formatRgb()}function ju(l){var c,d;return l=(l+"").trim().toLowerCase(),(c=gv.exec(l))?(d=c[1].length,c=parseInt(c[1],16),d===6?Md(c):d===3?new ca(c>>8&15|c>>4&240,c>>4&15|c&240,(c&15)<<4|c&15,1):d===8?sh(c>>24&255,c>>16&255,c>>8&255,(c&255)/255):d===4?sh(c>>12&15|c>>8&240,c>>8&15|c>>4&240,c>>4&15|c&240,((c&15)<<4|c&15)/255):null):(c=_v.exec(l))?new ca(c[1],c[2],c[3],1):(c=vv.exec(l))?new ca(c[1]*255/100,c[2]*255/100,c[3]*255/100,1):(c=bv.exec(l))?sh(c[1],c[2],c[3],c[4]):(c=xv.exec(l))?sh(c[1]*255/100,c[2]*255/100,c[3]*255/100,c[4]):(c=wv.exec(l))?Rd(c[1],c[2]/100,c[3]/100,1):(c=Sv.exec(l))?Rd(c[1],c[2]/100,c[3]/100,c[4]):zd.hasOwnProperty(l)?Md(zd[l]):l==="transparent"?new ca(NaN,NaN,NaN,0):null}function Md(l){return new ca(l>>16&255,l>>8&255,l&255,1)}function sh(l,c,d,p){return p<=0&&(l=c=d=NaN),new ca(l,c,d,p)}function Tv(l){return l instanceof ec||(l=ju(l)),l?(l=l.rgb(),new ca(l.r,l.g,l.b,l.opacity)):new ca}function Op(l,c,d,p){return arguments.length===1?Tv(l):new ca(l,c,d,p??1)}function ca(l,c,d,p){this.r=+l,this.g=+c,this.b=+d,this.opacity=+p}Kp(ca,Op,gy(ec,{brighter(l){return l=l==null?kh:Math.pow(kh,l),new ca(this.r*l,this.g*l,this.b*l,this.opacity)},darker(l){return l=l==null?Uu:Math.pow(Uu,l),new ca(this.r*l,this.g*l,this.b*l,this.opacity)},rgb(){return this},clamp(){return new ca(Ls(this.r),Ls(this.g),Ls(this.b),Eh(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:Dd,formatHex:Dd,formatHex8:Iv,formatRgb:Ld,toString:Ld}));function Dd(){return`#${Ds(this.r)}${Ds(this.g)}${Ds(this.b)}`}function Iv(){return`#${Ds(this.r)}${Ds(this.g)}${Ds(this.b)}${Ds((isNaN(this.opacity)?1:this.opacity)*255)}`}function Ld(){const l=Eh(this.opacity);return`${l===1?"rgb(":"rgba("}${Ls(this.r)}, ${Ls(this.g)}, ${Ls(this.b)}${l===1?")":`, ${l})`}`}function Eh(l){return isNaN(l)?1:Math.max(0,Math.min(1,l))}function Ls(l){return Math.max(0,Math.min(255,Math.round(l)||0))}function Ds(l){return l=Ls(l),(l<16?"0":"")+l.toString(16)}function Rd(l,c,d,p){return p<=0?l=c=d=NaN:d<=0||d>=1?l=c=NaN:c<=0&&(l=NaN),new Fa(l,c,d,p)}function _y(l){if(l instanceof Fa)return new Fa(l.h,l.s,l.l,l.opacity);if(l instanceof ec||(l=ju(l)),!l)return new Fa;if(l instanceof Fa)return l;l=l.rgb();var c=l.r/255,d=l.g/255,p=l.b/255,y=Math.min(c,d,p),v=Math.max(c,d,p),a=NaN,E=v-y,T=(v+y)/2;return E?(c===v?a=(d-p)/E+(d<p)*6:d===v?a=(p-c)/E+2:a=(c-d)/E+4,E/=T<.5?v+y:2-v-y,a*=60):E=T>0&&T<1?0:a,new Fa(a,E,T,l.opacity)}function Av(l,c,d,p){return arguments.length===1?_y(l):new Fa(l,c,d,p??1)}function Fa(l,c,d,p){this.h=+l,this.s=+c,this.l=+d,this.opacity=+p}Kp(Fa,Av,gy(ec,{brighter(l){return l=l==null?kh:Math.pow(kh,l),new Fa(this.h,this.s,this.l*l,this.opacity)},darker(l){return l=l==null?Uu:Math.pow(Uu,l),new Fa(this.h,this.s,this.l*l,this.opacity)},rgb(){var l=this.h%360+(this.h<0)*360,c=isNaN(l)||isNaN(this.s)?0:this.s,d=this.l,p=d+(d<.5?d:1-d)*c,y=2*d-p;return new ca(Pp(l>=240?l-240:l+120,y,p),Pp(l,y,p),Pp(l<120?l+240:l-120,y,p),this.opacity)},clamp(){return new Fa(Bd(this.h),lh(this.s),lh(this.l),Eh(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){const l=Eh(this.opacity);return`${l===1?"hsl(":"hsla("}${Bd(this.h)}, ${lh(this.s)*100}%, ${lh(this.l)*100}%${l===1?")":`, ${l})`}`}}));function Bd(l){return l=(l||0)%360,l<0?l+360:l}function lh(l){return Math.max(0,Math.min(1,l||0))}function Pp(l,c,d){return(l<60?c+(d-c)*l/60:l<180?d:l<240?c+(d-c)*(240-l)/60:c)*255}const Hp=l=>()=>l;function zv(l,c){return function(d){return l+d*c}}function Pv(l,c,d){return l=Math.pow(l,d),c=Math.pow(c,d)-l,d=1/d,function(p){return Math.pow(l+p*c,d)}}function Cv(l){return(l=+l)==1?vy:function(c,d){return d-c?Pv(c,d,l):Hp(isNaN(c)?d:c)}}function vy(l,c){var d=c-l;return d?zv(l,d):Hp(isNaN(l)?c:l)}const Od=function l(c){var d=Cv(c);function p(y,v){var a=d((y=Op(y)).r,(v=Op(v)).r),E=d(y.g,v.g),T=d(y.b,v.b),L=vy(y.opacity,v.opacity);return function(F){return y.r=a(F),y.g=E(F),y.b=T(F),y.opacity=L(F),y+""}}return p.gamma=l,p}(1);function Mv(l,c){c||(c=[]);var d=l?Math.min(c.length,l.length):0,p=c.slice(),y;return function(v){for(y=0;y<d;++y)p[y]=l[y]*(1-v)+c[y]*v;return p}}function Dv(l){return ArrayBuffer.isView(l)&&!(l instanceof DataView)}function Lv(l,c){var d=c?c.length:0,p=l?Math.min(d,l.length):0,y=new Array(p),v=new Array(d),a;for(a=0;a<p;++a)y[a]=Xp(l[a],c[a]);for(;a<d;++a)v[a]=c[a];return function(E){for(a=0;a<p;++a)v[a]=y[a](E);return v}}function Rv(l,c){var d=new Date;return l=+l,c=+c,function(p){return d.setTime(l*(1-p)+c*p),d}}function Th(l,c){return l=+l,c=+c,function(d){return l*(1-d)+c*d}}function Bv(l,c){var d={},p={},y;(l===null||typeof l!="object")&&(l={}),(c===null||typeof c!="object")&&(c={});for(y in c)y in l?d[y]=Xp(l[y],c[y]):p[y]=c[y];return function(v){for(y in d)p[y]=d[y](v);return p}}var Fp=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,Cp=new RegExp(Fp.source,"g");function Ov(l){return function(){return l}}function Fv(l){return function(c){return l(c)+""}}function Nv(l,c){var d=Fp.lastIndex=Cp.lastIndex=0,p,y,v,a=-1,E=[],T=[];for(l=l+"",c=c+"";(p=Fp.exec(l))&&(y=Cp.exec(c));)(v=y.index)>d&&(v=c.slice(d,v),E[a]?E[a]+=v:E[++a]=v),(p=p[0])===(y=y[0])?E[a]?E[a]+=y:E[++a]=y:(E[++a]=null,T.push({i:a,x:Th(p,y)})),d=Cp.lastIndex;return d<c.length&&(v=c.slice(d),E[a]?E[a]+=v:E[++a]=v),E.length<2?T[0]?Fv(T[0].x):Ov(c):(c=T.length,function(L){for(var F=0,C;F<c;++F)E[(C=T[F]).i]=C.x(L);return E.join("")})}function Xp(l,c){var d=typeof c,p;return c==null||d==="boolean"?Hp(c):(d==="number"?Th:d==="string"?(p=ju(c))?(c=p,Od):Nv:c instanceof ju?Od:c instanceof Date?Rv:Dv(c)?Mv:Array.isArray(c)?Lv:typeof c.valueOf!="function"&&typeof c.toString!="function"||isNaN(c)?Bv:Th)(l,c)}function Vv(l,c){return l=+l,c=+c,function(d){return Math.round(l*(1-d)+c*d)}}function Uv(l){return function(){return l}}function qv(l){return+l}var Fd=[0,1];function so(l){return l}function Np(l,c){return(c-=l=+l)?function(d){return(d-l)/c}:Uv(isNaN(c)?NaN:.5)}function jv(l,c){var d;return l>c&&(d=l,l=c,c=d),function(p){return Math.max(l,Math.min(c,p))}}function Gv(l,c,d){var p=l[0],y=l[1],v=c[0],a=c[1];return y<p?(p=Np(y,p),v=d(a,v)):(p=Np(p,y),v=d(v,a)),function(E){return v(p(E))}}function Zv(l,c,d){var p=Math.min(l.length,c.length)-1,y=new Array(p),v=new Array(p),a=-1;for(l[p]<l[0]&&(l=l.slice().reverse(),c=c.slice().reverse());++a<p;)y[a]=Np(l[a],l[a+1]),v[a]=d(c[a],c[a+1]);return function(E){var T=cv(l,E,1,p)-1;return v[T](y[T](E))}}function by(l,c){return c.domain(l.domain()).range(l.range()).interpolate(l.interpolate()).clamp(l.clamp()).unknown(l.unknown())}function xy(){var l=Fd,c=Fd,d=Xp,p,y,v,a=so,E,T,L;function F(){var M=Math.min(l.length,c.length);return a!==so&&(a=jv(l[0],l[M-1])),E=M>2?Zv:Gv,T=L=null,C}function C(M){return M==null||isNaN(M=+M)?v:(T||(T=E(l.map(p),c,d)))(p(a(M)))}return C.invert=function(M){return a(y((L||(L=E(c,l.map(p),Th)))(M)))},C.domain=function(M){return arguments.length?(l=Array.from(M,qv),F()):l.slice()},C.range=function(M){return arguments.length?(c=Array.from(M),F()):c.slice()},C.rangeRound=function(M){return c=Array.from(M),d=Vv,F()},C.clamp=function(M){return arguments.length?(a=M?!0:so,F()):a!==so},C.interpolate=function(M){return arguments.length?(d=M,F()):d},C.unknown=function(M){return arguments.length?(v=M,C):v},function(M,X){return p=M,y=X,F()}}function Kv(){return xy()(so,so)}function Hv(l){return Math.abs(l=Math.round(l))>=1e21?l.toLocaleString("en").replace(/,/g,""):l.toString(10)}function Ih(l,c){if((d=(l=c?l.toExponential(c-1):l.toExponential()).indexOf("e"))<0)return null;var d,p=l.slice(0,d);return[p.length>1?p[0]+p.slice(2):p,+l.slice(d+1)]}function Rl(l){return l=Ih(Math.abs(l)),l?l[1]:NaN}function Xv(l,c){return function(d,p){for(var y=d.length,v=[],a=0,E=l[0],T=0;y>0&&E>0&&(T+E+1>p&&(E=Math.max(1,p-T)),v.push(d.substring(y-=E,y+E)),!((T+=E+1)>p));)E=l[a=(a+1)%l.length];return v.reverse().join(c)}}function Wv(l){return function(c){return c.replace(/[0-9]/g,function(d){return l[+d]})}}var Yv=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function Ah(l){if(!(c=Yv.exec(l)))throw new Error("invalid format: "+l);var c;return new Wp({fill:c[1],align:c[2],sign:c[3],symbol:c[4],zero:c[5],width:c[6],comma:c[7],precision:c[8]&&c[8].slice(1),trim:c[9],type:c[10]})}Ah.prototype=Wp.prototype;function Wp(l){this.fill=l.fill===void 0?" ":l.fill+"",this.align=l.align===void 0?">":l.align+"",this.sign=l.sign===void 0?"-":l.sign+"",this.symbol=l.symbol===void 0?"":l.symbol+"",this.zero=!!l.zero,this.width=l.width===void 0?void 0:+l.width,this.comma=!!l.comma,this.precision=l.precision===void 0?void 0:+l.precision,this.trim=!!l.trim,this.type=l.type===void 0?"":l.type+""}Wp.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(this.width===void 0?"":Math.max(1,this.width|0))+(this.comma?",":"")+(this.precision===void 0?"":"."+Math.max(0,this.precision|0))+(this.trim?"~":"")+this.type};function Jv(l){e:for(var c=l.length,d=1,p=-1,y;d<c;++d)switch(l[d]){case".":p=y=d;break;case"0":p===0&&(p=d),y=d;break;default:if(!+l[d])break e;p>0&&(p=0);break}return p>0?l.slice(0,p)+l.slice(y+1):l}var wy;function Qv(l,c){var d=Ih(l,c);if(!d)return l+"";var p=d[0],y=d[1],v=y-(wy=Math.max(-8,Math.min(8,Math.floor(y/3)))*3)+1,a=p.length;return v===a?p:v>a?p+new Array(v-a+1).join("0"):v>0?p.slice(0,v)+"."+p.slice(v):"0."+new Array(1-v).join("0")+Ih(l,Math.max(0,c+v-1))[0]}function Nd(l,c){var d=Ih(l,c);if(!d)return l+"";var p=d[0],y=d[1];return y<0?"0."+new Array(-y).join("0")+p:p.length>y+1?p.slice(0,y+1)+"."+p.slice(y+1):p+new Array(y-p.length+2).join("0")}const Vd={"%":(l,c)=>(l*100).toFixed(c),b:l=>Math.round(l).toString(2),c:l=>l+"",d:Hv,e:(l,c)=>l.toExponential(c),f:(l,c)=>l.toFixed(c),g:(l,c)=>l.toPrecision(c),o:l=>Math.round(l).toString(8),p:(l,c)=>Nd(l*100,c),r:Nd,s:Qv,X:l=>Math.round(l).toString(16).toUpperCase(),x:l=>Math.round(l).toString(16)};function Ud(l){return l}var qd=Array.prototype.map,jd=["y","z","a","f","p","n","","m","","k","M","G","T","P","E","Z","Y"];function $v(l){var c=l.grouping===void 0||l.thousands===void 0?Ud:Xv(qd.call(l.grouping,Number),l.thousands+""),d=l.currency===void 0?"":l.currency[0]+"",p=l.currency===void 0?"":l.currency[1]+"",y=l.decimal===void 0?".":l.decimal+"",v=l.numerals===void 0?Ud:Wv(qd.call(l.numerals,String)),a=l.percent===void 0?"%":l.percent+"",E=l.minus===void 0?"":l.minus+"",T=l.nan===void 0?"NaN":l.nan+"";function L(C){C=Ah(C);var M=C.fill,X=C.align,ae=C.sign,se=C.symbol,he=C.zero,me=C.width,_e=C.comma,it=C.precision,Fe=C.trim,Pe=C.type;Pe==="n"?(_e=!0,Pe="g"):Vd[Pe]||(it===void 0&&(it=12),Fe=!0,Pe="g"),(he||M==="0"&&X==="=")&&(he=!0,M="0",X="=");var Ze=se==="$"?d:se==="#"&&/[boxX]/.test(Pe)?"0"+Pe.toLowerCase():"",Ct=se==="$"?p:/[%p]/.test(Pe)?a:"",kt=Vd[Pe],Ge=/[defgprs%]/.test(Pe);it=it===void 0?6:/[gprs]/.test(Pe)?Math.max(1,Math.min(21,it)):Math.max(0,Math.min(20,it));function Ke(gt){var ur=Ze,je=Ct,Ft,Be,$e;if(Pe==="c")je=kt(gt)+je,gt="";else{gt=+gt;var yt=gt<0||1/gt<0;if(gt=isNaN(gt)?T:kt(Math.abs(gt),it),Fe&&(gt=Jv(gt)),yt&&+gt==0&&ae!=="+"&&(yt=!1),ur=(yt?ae==="("?ae:E:ae==="-"||ae==="("?"":ae)+ur,je=(Pe==="s"?jd[8+wy/3]:"")+je+(yt&&ae==="("?")":""),Ge){for(Ft=-1,Be=gt.length;++Ft<Be;)if($e=gt.charCodeAt(Ft),48>$e||$e>57){je=($e===46?y+gt.slice(Ft+1):gt.slice(Ft))+je,gt=gt.slice(0,Ft);break}}}_e&&!he&&(gt=c(gt,1/0));var jt=ur.length+gt.length+je.length,Lt=jt<me?new Array(me-jt+1).join(M):"";switch(_e&&he&&(gt=c(Lt+gt,Lt.length?me-je.length:1/0),Lt=""),X){case"<":gt=ur+gt+je+Lt;break;case"=":gt=ur+Lt+gt+je;break;case"^":gt=Lt.slice(0,jt=Lt.length>>1)+ur+gt+je+Lt.slice(jt);break;default:gt=Lt+ur+gt+je;break}return v(gt)}return Ke.toString=function(){return C+""},Ke}function F(C,M){var X=L((C=Ah(C),C.type="f",C)),ae=Math.max(-8,Math.min(8,Math.floor(Rl(M)/3)))*3,se=Math.pow(10,-ae),he=jd[8+ae/3];return function(me){return X(se*me)+he}}return{format:L,formatPrefix:F}}var uh,Sy,ky;e0({thousands:",",grouping:[3],currency:["$",""]});function e0(l){return uh=$v(l),Sy=uh.format,ky=uh.formatPrefix,uh}function t0(l){return Math.max(0,-Rl(Math.abs(l)))}function r0(l,c){return Math.max(0,Math.max(-8,Math.min(8,Math.floor(Rl(c)/3)))*3-Rl(Math.abs(l)))}function i0(l,c){return l=Math.abs(l),c=Math.abs(c)-l,Math.max(0,Rl(c)-Rl(l))+1}function n0(l,c,d,p){var y=mv(l,c,d),v;switch(p=Ah(p??",f"),p.type){case"s":{var a=Math.max(Math.abs(l),Math.abs(c));return p.precision==null&&!isNaN(v=r0(y,a))&&(p.precision=v),ky(p,a)}case"":case"e":case"g":case"p":case"r":{p.precision==null&&!isNaN(v=i0(y,Math.max(Math.abs(l),Math.abs(c))))&&(p.precision=v-(p.type==="e"));break}case"f":case"%":{p.precision==null&&!isNaN(v=t0(y))&&(p.precision=v-(p.type==="%")*2);break}}return Sy(p)}function Ey(l){var c=l.domain;return l.ticks=function(d){var p=c();return dv(p[0],p[p.length-1],d??10)},l.tickFormat=function(d,p){var y=c();return n0(y[0],y[y.length-1],d??10,p)},l.nice=function(d){d==null&&(d=10);var p=c(),y=0,v=p.length-1,a=p[y],E=p[v],T,L,F=10;for(E<a&&(L=a,a=E,E=L,L=y,y=v,v=L);F-- >0;){if(L=dy(a,E,d),L===T)return p[y]=a,p[v]=E,c(p);if(L>0)a=Math.floor(a/L)*L,E=Math.ceil(E/L)*L;else if(L<0)a=Math.ceil(a*L)/L,E=Math.floor(E*L)/L;else break;T=L}return l},l}function xh(){var l=Kv();return l.copy=function(){return by(l,xh())},Dh.apply(l,arguments),Ey(l)}function Gd(l){return function(c){return c<0?-Math.pow(-c,l):Math.pow(c,l)}}function a0(l){return l<0?-Math.sqrt(-l):Math.sqrt(l)}function o0(l){return l<0?-l*l:l*l}function s0(l){var c=l(so,so),d=1;function p(){return d===1?l(so,so):d===.5?l(a0,o0):l(Gd(d),Gd(1/d))}return c.exponent=function(y){return arguments.length?(d=+y,p()):d},Ey(c)}function Ty(){var l=s0(xy());return l.copy=function(){return by(l,Ty()).exponent(l.exponent())},Dh.apply(l,arguments),l}function l0(){return Ty.apply(null,arguments).exponent(.5)}const Ru={x:xh,y:xh,z:xh,r:l0};function u0(l){return l.constant?"symlog":l.base?"log":l.exponent?l.exponent()===.5?"sqrt":"pow":"other"}function Zd(l){return l}function c0(l){return c=>Math.log(l*c)}function h0(l){return c=>l*Math.exp(c)}function p0(l){return c=>Math.sign(c)*Math.log1p(Math.abs(c/l))}function f0(l){return c=>Math.sign(c)*Math.expm1(Math.abs(c))*l}function ch(l){return function(d){return d<0?-Math.pow(-d,l):Math.pow(d,l)}}function d0(l){const c=u0(l);if(c==="log"){const d=Math.sign(l.domain()[0]);return{lift:c0(d),ground:h0(d),scaleType:c}}return c==="pow"?{lift:ch(1),ground:ch(1/1),scaleType:c}:c==="sqrt"?{lift:ch(.5),ground:ch(1/.5),scaleType:c}:c==="symlog"?{lift:p0(1),ground:f0(1),scaleType:c}:{lift:Zd,ground:Zd,scaleType:c}}function m0(l,c){if(typeof l.range!="function")throw new Error("Scale method `range` must be a function");if(typeof l.domain!="function")throw new Error("Scale method `domain` must be a function");if(!Array.isArray(c))return l.domain();l.domain().length!==2&&console.warn("[LayerCake] The scale is expected to have a domain of length 2 to use padding. Are you sure you want to use padding? Your scale's domain is:",l.domain()),l.range().length!==2&&console.warn("[LayerCake] The scale is expected to have a range of length 2 to use padding. Are you sure you want to use padding? Your scale's range is:",l.range());const{lift:d,ground:p}=d0(l),y=l.domain()[0],v=Object.prototype.toString.call(y)==="[object Date]",[a,E]=l.domain().map(X=>d(v?X.getTime():X)),[T,L]=l.range(),F=c[0]||0,C=c[1]||0,M=(E-a)/(Math.abs(L-T)-F-C);return[a-F*M,C*M+E].map(X=>p(v?new Date(X):X))}function y0(l,c,d,p,y){let v,a;return y===!0?(v=0,a=100):(v=l==="r"?1:0,a=l==="y"?d:l==="r"?25:c),p===!0?[a,v]:[v,a]}function g0(l,c,d,p,y,v){return y?typeof y=="function"?y({width:c,height:d}):y:y0(l,c,d,p,v)}function hh(l){return function([d,p,y,v,a,E,T,L,F,C]){if(p===null)return null;const M=g0(l,T,L,E,F,C),X=d===Ru[l]?d():d.copy();return X.domain(py(p[l],y)).range(M),v&&X.domain(m0(X,v)),a===!0&&(typeof X.nice=="function"?X.nice():console.error(`[Layer Cake] You set \`${l}Nice: true\` but the ${l}Scale does not have a \`.nice\` method. Ignoring...`)),X}}function ph([l,c]){return d=>{const p=l(d);return Array.isArray(p)?p.map(y=>c(y)):c(p)}}function fh([l]){if(typeof l=="function"){if(typeof l.range=="function")return l.range();console.error("[LayerCake] Your scale doesn't have a `.range` method?")}return null}const dh={x:!1,y:!0,z:!1,r:!1};const _0=l=>({element:l[0]&4,width:l[0]&256,height:l[0]&512,aspectRatio:l[0]&1024,containerWidth:l[0]&128,containerHeight:l[0]&64}),Kd=l=>({element:l[2],width:l[8],height:l[9],aspectRatio:l[10],containerWidth:l[7],containerHeight:l[6]});function Hd(l){let c,d,p;const y=l[90].default,v=Ou(y,l,l[89],Kd);return{c(){c=Ue("div"),v&&v.c(),this.h()},l(a){c=qe(a,"DIV",{class:!0});var E=Oe(c);v&&v.l(E),E.forEach(ne),this.h()},h(){ie(c,"class","layercake-container svelte-vhzpsp"),Gu(()=>l[92].call(c)),Ye(c,"position",l[5]),Ye(c,"top",l[5]==="absolute"?"0":null),Ye(c,"right",l[5]==="absolute"?"0":null),Ye(c,"bottom",l[5]==="absolute"?"0":null),Ye(c,"left",l[5]==="absolute"?"0":null),Ye(c,"pointer-events",l[4]===!1?"none":null)},m(a,E){Re(a,c,E),v&&v.m(c,null),l[91](c),d=Zu(c,l[92].bind(c)),p=!0},p(a,E){v&&v.p&&(!p||E[0]&1988|E[2]&134217728)&&Fu(v,y,a,a[89],p?Vu(y,a[89],E,_0):Nu(a[89]),Kd),E[0]&32&&Ye(c,"position",a[5]),E[0]&32&&Ye(c,"top",a[5]==="absolute"?"0":null),E[0]&32&&Ye(c,"right",a[5]==="absolute"?"0":null),E[0]&32&&Ye(c,"bottom",a[5]==="absolute"?"0":null),E[0]&32&&Ye(c,"left",a[5]==="absolute"?"0":null),E[0]&16&&Ye(c,"pointer-events",a[4]===!1?"none":null)},i(a){p||(tt(v,a),p=!0)},o(a){ct(v,a),p=!1},d(a){a&&ne(c),v&&v.d(a),l[91](null),d()}}}function v0(l){let c,d,p=(l[3]===!0||typeof window<"u")&&Hd(l);return{c(){p&&p.c(),c=or()},l(y){p&&p.l(y),c=or()},m(y,v){p&&p.m(y,v),Re(y,c,v),d=!0},p(y,v){y[3]===!0||typeof window<"u"?p?(p.p(y,v),v[0]&8&&tt(p,1)):(p=Hd(y),p.c(),tt(p,1),p.m(c.parentNode,c)):p&&(kn(),ct(p,1,1,()=>{p=null}),En())},i(y){d||(tt(p),d=!0)},o(y){ct(p),d=!1},d(y){p&&p.d(y),y&&ne(c)}}}function b0(l,c,d){let p,y,v,a,E,T,L,F,C,M,X,ae,se,he,me,_e,it,Fe,Pe,Ze,Ct,kt,Ge,Ke,gt,ur,je,Ft,Be,$e,yt,jt,Lt,St,Ce,ot,Dr,Kr,ki,Br,cr,{$$slots:Sr={},$$scope:Gt}=c,{ssr:Ei=!1}=c,{pointerEvents:Yn=!0}=c,{position:ti="relative"}=c,{percentRange:Ut=!1}=c,{width:mn=void 0}=c,{height:ci=void 0}=c,{containerWidth:$r=mn||100}=c,{containerHeight:Rn=ci||100}=c,{element:hi=void 0}=c,{x:Tn=void 0}=c,{y:ni=void 0}=c,{z:zr=void 0}=c,{r:_i=void 0}=c,{data:pi=[]}=c,{xDomain:qr=void 0}=c,{yDomain:Qi=void 0}=c,{zDomain:Hr=void 0}=c,{rDomain:In=void 0}=c,{xNice:$i=!1}=c,{yNice:Bn=!1}=c,{zNice:Ui=!1}=c,{rNice:An=!1}=c,{xReverse:en=dh.x}=c,{yReverse:Ri=dh.y}=c,{zReverse:Xr=dh.z}=c,{rReverse:zn=dh.r}=c,{xPadding:Pn=void 0}=c,{yPadding:vi=void 0}=c,{zPadding:ha=void 0}=c,{rPadding:ra=void 0}=c,{xScale:Or=Ru.x}=c,{yScale:un=Ru.y}=c,{zScale:qi=Ru.z}=c,{rScale:fi=Ru.r}=c,{xRange:re=void 0}=c,{yRange:et=void 0}=c,{zRange:R=void 0}=c,{rRange:N=void 0}=c,{padding:q={}}=c,{extents:K={}}=c,{flatData:W=void 0}=c,{custom:le={}}=c,fe=!1;Vp(()=>{fe=!0});const U={},J=Ir(Ut);Ht(l,J,ve=>d(128,Kr=ve));const ge=Ir($r);Ht(l,ge,ve=>d(7,Dr=ve));const De=Ir(Rn);Ht(l,De,ve=>d(6,ot=ve));const Ne=Ir(zp(K));Ht(l,Ne,ve=>d(127,Ce=ve));const ke=Ir(pi);Ht(l,ke,ve=>d(126,St=ve));const Le=Ir(W||pi);Ht(l,Le,ve=>d(125,Lt=ve));const pt=Ir(q);Ht(l,pt,ve=>d(124,jt=ve));const lt=Ir(es(Tn));Ht(l,lt,ve=>d(123,yt=ve));const Ie=Ir(es(ni));Ht(l,Ie,ve=>d(122,$e=ve));const nt=Ir(es(zr));Ht(l,nt,ve=>d(121,Be=ve));const Je=Ir(es(_i));Ht(l,Je,ve=>d(120,Ft=ve));const He=Ir(qr);Ht(l,He,ve=>d(119,je=ve));const Zt=Ir(Qi);Ht(l,Zt,ve=>d(118,ur=ve));const st=Ir(Hr);Ht(l,st,ve=>d(117,gt=ve));const nr=Ir(In);Ht(l,nr,ve=>d(116,Ke=ve));const br=Ir($i);Ht(l,br,ve=>d(115,Ge=ve));const Xt=Ir(Bn);Ht(l,Xt,ve=>d(114,kt=ve));const pr=Ir(Ui);Ht(l,pr,ve=>d(113,Ct=ve));const ar=Ir(An);Ht(l,ar,ve=>d(112,Ze=ve));const bi=Ir(en);Ht(l,bi,ve=>d(111,Pe=ve));const mr=Ir(Ri);Ht(l,mr,ve=>d(110,Fe=ve));const Fr=Ir(Xr);Ht(l,Fr,ve=>d(109,it=ve));const vr=Ir(zn);Ht(l,vr,ve=>d(108,_e=ve));const Qt=Ir(Pn);Ht(l,Qt,ve=>d(107,me=ve));const fr=Ir(vi);Ht(l,fr,ve=>d(106,he=ve));const Ti=Ir(ha);Ht(l,Ti,ve=>d(105,se=ve));const pa=Ir(ra);Ht(l,pa,ve=>d(104,ae=ve));const ai=Ir(re);Ht(l,ai,ve=>d(103,X=ve));const Bi=Ir(et);Ht(l,Bi,ve=>d(102,M=ve));const Na=Ir(R);Ht(l,Na,ve=>d(101,C=ve));const va=Ir(N);Ht(l,va,ve=>d(100,F=ve));const jr=Ir(Or);Ht(l,jr,ve=>d(99,L=ve));const ba=Ir(un);Ht(l,ba,ve=>d(98,T=ve));const Ii=Ir(qi);Ht(l,Ii,ve=>d(97,E=ve));const oi=Ir(fi);Ht(l,oi,ve=>d(96,a=ve));const cn=Ir(U);Ht(l,cn,ve=>d(94,y=ve));const Cr=Ir(le);Ht(l,Cr,ve=>d(95,v=ve));const On=Li([lt,Ie,nt,Je],([ve,hn,Zi,Gr])=>{const ka={};return ve&&(ka.x=ve),hn&&(ka.y=hn),Zi&&(ka.z=Zi),Gr&&(ka.r=Gr),ka}),yn=Li([pt,ge,De],([ve])=>Object.assign({top:0,right:0,bottom:0,left:0},ve)),is=Li([ge,De,yn],([ve,hn,Zi])=>{const Gr={};return Gr.top=Zi.top,Gr.right=ve-Zi.right,Gr.bottom=hn-Zi.bottom,Gr.left=Zi.left,Gr.width=Gr.right-Gr.left,Gr.height=Gr.bottom-Gr.top,Gr.width<=0&&fe===!0&&console.warn("[LayerCake] Target div has zero or negative width. Did you forget to set an explicit width in CSS on the container?"),Gr.height<=0&&fe===!0&&console.warn("[LayerCake] Target div has zero or negative height. Did you forget to set an explicit height in CSS on the container?"),Gr}),Ai=Li([is],([ve])=>ve.width);Ht(l,Ai,ve=>d(8,ki=ve));const xa=Li([is],([ve])=>ve.height);Ht(l,xa,ve=>d(9,Br=ve));const ji=Li([Le,On,Ne],([ve,hn,Zi])=>{const Gr=zp(hn,Zi);return Object.keys(Gr).length>0?{...nv(ve,Gr),...Zi}:{}}),zi=Li([ji,He],oh("x")),Jn=Li([ji,Zt],oh("y")),Gi=Li([ji,st],oh("z")),wa=Li([ji,nr],oh("r")),ns=Li([jr,ji,zi,Qt,br,bi,Ai,xa,ai,J],hh("x")),Fl=Li([lt,ns],ph),uo=Li([ba,ji,Jn,fr,Xt,mr,Ai,xa,Bi,J],hh("y")),Nl=Li([Ie,uo],ph),Ro=Li([Ii,ji,Gi,Ti,pr,Fr,Ai,xa,Na,J],hh("z")),Vl=Li([nt,Ro],ph),Bo=Li([oi,ji,wa,pa,ar,vr,Ai,xa,va,J],hh("r")),Os=Li([Je,Bo],ph),Va=Li([ns],fh),as=Li([uo],fh),co=Li([Ro],fh),Fs=Li([Bo],fh),Ua=Li([Ai,xa],([ve,hn])=>ve/hn);Ht(l,Ua,ve=>d(10,cr=ve));function Fn(ve){Rs[ve?"unshift":"push"](()=>{hi=ve,d(2,hi)})}function Sa(){$r=this.clientWidth,Rn=this.clientHeight,d(0,$r),d(1,Rn)}return l.$$set=ve=>{"ssr"in ve&&d(3,Ei=ve.ssr),"pointerEvents"in ve&&d(4,Yn=ve.pointerEvents),"position"in ve&&d(5,ti=ve.position),"percentRange"in ve&&d(51,Ut=ve.percentRange),"width"in ve&&d(52,mn=ve.width),"height"in ve&&d(53,ci=ve.height),"containerWidth"in ve&&d(0,$r=ve.containerWidth),"containerHeight"in ve&&d(1,Rn=ve.containerHeight),"element"in ve&&d(2,hi=ve.element),"x"in ve&&d(54,Tn=ve.x),"y"in ve&&d(55,ni=ve.y),"z"in ve&&d(56,zr=ve.z),"r"in ve&&d(57,_i=ve.r),"data"in ve&&d(58,pi=ve.data),"xDomain"in ve&&d(59,qr=ve.xDomain),"yDomain"in ve&&d(60,Qi=ve.yDomain),"zDomain"in ve&&d(61,Hr=ve.zDomain),"rDomain"in ve&&d(62,In=ve.rDomain),"xNice"in ve&&d(63,$i=ve.xNice),"yNice"in ve&&d(64,Bn=ve.yNice),"zNice"in ve&&d(65,Ui=ve.zNice),"rNice"in ve&&d(66,An=ve.rNice),"xReverse"in ve&&d(67,en=ve.xReverse),"yReverse"in ve&&d(68,Ri=ve.yReverse),"zReverse"in ve&&d(69,Xr=ve.zReverse),"rReverse"in ve&&d(70,zn=ve.rReverse),"xPadding"in ve&&d(71,Pn=ve.xPadding),"yPadding"in ve&&d(72,vi=ve.yPadding),"zPadding"in ve&&d(73,ha=ve.zPadding),"rPadding"in ve&&d(74,ra=ve.rPadding),"xScale"in ve&&d(75,Or=ve.xScale),"yScale"in ve&&d(76,un=ve.yScale),"zScale"in ve&&d(77,qi=ve.zScale),"rScale"in ve&&d(78,fi=ve.rScale),"xRange"in ve&&d(79,re=ve.xRange),"yRange"in ve&&d(80,et=ve.yRange),"zRange"in ve&&d(81,R=ve.zRange),"rRange"in ve&&d(82,N=ve.rRange),"padding"in ve&&d(83,q=ve.padding),"extents"in ve&&d(84,K=ve.extents),"flatData"in ve&&d(85,W=ve.flatData),"custom"in ve&&d(86,le=ve.custom),"$$scope"in ve&&d(89,Gt=ve.$$scope)},l.$$.update=()=>{l.$$.dirty[1]&8388608&&Tn&&d(87,U.x=Tn,U),l.$$.dirty[1]&16777216&&ni&&d(87,U.y=ni,U),l.$$.dirty[1]&33554432&&zr&&d(87,U.z=zr,U),l.$$.dirty[1]&67108864&&_i&&d(87,U.r=_i,U),l.$$.dirty[1]&268435456&&qr&&d(87,U.xDomain=qr,U),l.$$.dirty[1]&536870912&&Qi&&d(87,U.yDomain=Qi,U),l.$$.dirty[1]&1073741824&&Hr&&d(87,U.zDomain=Hr,U),l.$$.dirty[2]&1&&In&&d(87,U.rDomain=In,U),l.$$.dirty[2]&131072&&re&&d(87,U.xRange=re,U),l.$$.dirty[2]&262144&&et&&d(87,U.yRange=et,U),l.$$.dirty[2]&524288&&R&&d(87,U.zRange=R,U),l.$$.dirty[2]&1048576&&N&&d(87,U.rRange=N,U),l.$$.dirty[1]&1048576&&Tr(J,Kr=Ut,Kr),l.$$.dirty[0]&1&&Tr(ge,Dr=$r,Dr),l.$$.dirty[0]&2&&Tr(De,ot=Rn,ot),l.$$.dirty[2]&4194304&&Tr(Ne,Ce=zp(K),Ce),l.$$.dirty[1]&134217728&&Tr(ke,St=pi,St),l.$$.dirty[1]&134217728|l.$$.dirty[2]&8388608&&Tr(Le,Lt=W||pi,Lt),l.$$.dirty[2]&2097152&&Tr(pt,jt=q,jt),l.$$.dirty[1]&8388608&&Tr(lt,yt=es(Tn),yt),l.$$.dirty[1]&16777216&&Tr(Ie,$e=es(ni),$e),l.$$.dirty[1]&33554432&&Tr(nt,Be=es(zr),Be),l.$$.dirty[1]&67108864&&Tr(Je,Ft=es(_i),Ft),l.$$.dirty[1]&268435456&&Tr(He,je=qr,je),l.$$.dirty[1]&536870912&&Tr(Zt,ur=Qi,ur),l.$$.dirty[1]&1073741824&&Tr(st,gt=Hr,gt),l.$$.dirty[2]&1&&Tr(nr,Ke=In,Ke),l.$$.dirty[2]&2&&Tr(br,Ge=$i,Ge),l.$$.dirty[2]&4&&Tr(Xt,kt=Bn,kt),l.$$.dirty[2]&8&&Tr(pr,Ct=Ui,Ct),l.$$.dirty[2]&16&&Tr(ar,Ze=An,Ze),l.$$.dirty[2]&32&&Tr(bi,Pe=en,Pe),l.$$.dirty[2]&64&&Tr(mr,Fe=Ri,Fe),l.$$.dirty[2]&128&&Tr(Fr,it=Xr,it),l.$$.dirty[2]&256&&Tr(vr,_e=zn,_e),l.$$.dirty[2]&512&&Tr(Qt,me=Pn,me),l.$$.dirty[2]&1024&&Tr(fr,he=vi,he),l.$$.dirty[2]&2048&&Tr(Ti,se=ha,se),l.$$.dirty[2]&4096&&Tr(pa,ae=ra,ae),l.$$.dirty[2]&131072&&Tr(ai,X=re,X),l.$$.dirty[2]&262144&&Tr(Bi,M=et,M),l.$$.dirty[2]&524288&&Tr(Na,C=R,C),l.$$.dirty[2]&1048576&&Tr(va,F=N,F),l.$$.dirty[2]&8192&&Tr(jr,L=Or,L),l.$$.dirty[2]&16384&&Tr(ba,T=un,T),l.$$.dirty[2]&32768&&Tr(Ii,E=qi,E),l.$$.dirty[2]&65536&&Tr(oi,a=fi,a),l.$$.dirty[2]&16777216&&Tr(Cr,v=le,v),l.$$.dirty[2]&33554432&&Tr(cn,y=U,y),l.$$.dirty[2]&67108864&&oy("LayerCake",p)},d(88,p={activeGetters:On,width:Ai,height:xa,percentRange:J,aspectRatio:Ua,containerWidth:ge,containerHeight:De,x:lt,y:Ie,z:nt,r:Je,custom:Cr,data:ke,xNice:br,yNice:Xt,zNice:pr,rNice:ar,xReverse:bi,yReverse:mr,zReverse:Fr,rReverse:vr,xPadding:Qt,yPadding:fr,zPadding:Ti,rPadding:pa,padding:yn,flatData:Le,extents:ji,xDomain:zi,yDomain:Jn,zDomain:Gi,rDomain:wa,xRange:Va,yRange:as,zRange:co,rRange:Fs,config:cn,xScale:ns,xGet:Fl,yScale:uo,yGet:Nl,zScale:Ro,zGet:Vl,rScale:Bo,rGet:Os}),[$r,Rn,hi,Ei,Yn,ti,ot,Dr,ki,Br,cr,J,ge,De,Ne,ke,Le,pt,lt,Ie,nt,Je,He,Zt,st,nr,br,Xt,pr,ar,bi,mr,Fr,vr,Qt,fr,Ti,pa,ai,Bi,Na,va,jr,ba,Ii,oi,cn,Cr,Ai,xa,Ua,Ut,mn,ci,Tn,ni,zr,_i,pi,qr,Qi,Hr,In,$i,Bn,Ui,An,en,Ri,Xr,zn,Pn,vi,ha,ra,Or,un,qi,fi,re,et,R,N,q,K,W,le,U,p,Gt,Sr,Fn,Sa]}class x0 extends on{constructor(c){super(),sn(this,c,b0,v0,ln,{ssr:3,pointerEvents:4,position:5,percentRange:51,width:52,height:53,containerWidth:0,containerHeight:1,element:2,x:54,y:55,z:56,r:57,data:58,xDomain:59,yDomain:60,zDomain:61,rDomain:62,xNice:63,yNice:64,zNice:65,rNice:66,xReverse:67,yReverse:68,zReverse:69,rReverse:70,xPadding:71,yPadding:72,zPadding:73,rPadding:74,xScale:75,yScale:76,zScale:77,rScale:78,xRange:79,yRange:80,zRange:81,rRange:82,padding:83,extents:84,flatData:85,custom:86},null,[-1,-1,-1,-1,-1])}}const w0=l=>({element:l&1}),Xd=l=>({element:l[0]}),S0=l=>({element:l&1}),Wd=l=>({element:l[0]});function k0(l){let c,d,p,y,v;const a=l[12].defs,E=Ou(a,l,l[11],Wd),T=l[12].default,L=Ou(T,l,l[11],Xd);return{c(){c=Xn("svg"),d=Xn("defs"),E&&E.c(),p=Xn("g"),L&&L.c(),this.h()},l(F){c=Wn(F,"svg",{class:!0,viewBox:!0,width:!0,height:!0});var C=Oe(c);d=Wn(C,"defs",{});var M=Oe(d);E&&E.l(M),M.forEach(ne),p=Wn(C,"g",{class:!0,transform:!0});var X=Oe(p);L&&L.l(X),X.forEach(ne),C.forEach(ne),this.h()},h(){ie(p,"class","layercake-layout-svg_g"),ie(p,"transform",y="translate("+l[7].left+", "+l[7].top+")"),ie(c,"class","layercake-layout-svg svelte-u84d8d"),ie(c,"viewBox",l[4]),ie(c,"width",l[5]),ie(c,"height",l[6]),Ye(c,"z-index",l[2]),Ye(c,"pointer-events",l[3]===!1?"none":null)},m(F,C){Re(F,c,C),we(c,d),E&&E.m(d,null),we(c,p),L&&L.m(p,null),l[13](p),l[14](c),v=!0},p(F,[C]){E&&E.p&&(!v||C&2049)&&Fu(E,a,F,F[11],v?Vu(a,F[11],C,S0):Nu(F[11]),Wd),L&&L.p&&(!v||C&2049)&&Fu(L,T,F,F[11],v?Vu(T,F[11],C,w0):Nu(F[11]),Xd),(!v||C&128&&y!==(y="translate("+F[7].left+", "+F[7].top+")"))&&ie(p,"transform",y),(!v||C&16)&&ie(c,"viewBox",F[4]),(!v||C&32)&&ie(c,"width",F[5]),(!v||C&64)&&ie(c,"height",F[6]),C&4&&Ye(c,"z-index",F[2]),C&8&&Ye(c,"pointer-events",F[3]===!1?"none":null)},i(F){v||(tt(E,F),tt(L,F),v=!0)},o(F){ct(E,F),ct(L,F),v=!1},d(F){F&&ne(c),E&&E.d(F),L&&L.d(F),l[13](null),l[14](null)}}}function E0(l,c,d){let p,y,v,{$$slots:a={},$$scope:E}=c,{element:T=void 0}=c,{innerElement:L=void 0}=c,{zIndex:F=void 0}=c,{pointerEvents:C=void 0}=c,{viewBox:M=void 0}=c;const{containerWidth:X,containerHeight:ae,padding:se}=Ku("LayerCake");Ht(l,X,_e=>d(5,p=_e)),Ht(l,ae,_e=>d(6,y=_e)),Ht(l,se,_e=>d(7,v=_e));function he(_e){Rs[_e?"unshift":"push"](()=>{L=_e,d(1,L)})}function me(_e){Rs[_e?"unshift":"push"](()=>{T=_e,d(0,T)})}return l.$$set=_e=>{"element"in _e&&d(0,T=_e.element),"innerElement"in _e&&d(1,L=_e.innerElement),"zIndex"in _e&&d(2,F=_e.zIndex),"pointerEvents"in _e&&d(3,C=_e.pointerEvents),"viewBox"in _e&&d(4,M=_e.viewBox),"$$scope"in _e&&d(11,E=_e.$$scope)},[T,L,F,C,M,p,y,v,X,ae,se,E,a,he,me]}class T0 extends on{constructor(c){super(),sn(this,c,E0,k0,ln,{element:0,innerElement:1,zIndex:2,pointerEvents:3,viewBox:4})}}function Yd(l,c,d){const p=l.slice();return p[23]=c[d],p[25]=d,p}function Jd(l){let c,d,p,y;return{c(){c=Xn("rect"),this.h()},l(v){c=Wn(v,"rect",{class:!0,"data-id":!0,x:!0,y:!0,width:!0,height:!0,fill:!0,stroke:!0,"stroke-width":!0}),Oe(c).forEach(ne),this.h()},h(){ie(c,"class","group-rect"),ie(c,"data-id",l[25]),ie(c,"x",d=l[11].bandwidth?l[7](l[23]):l[7](l[23])[0]),ie(c,"y",p=l[13](l[12](l[23]))-1),ie(c,"width",y=l[11].bandwidth?l[11].bandwidth():l[9](l[23])),ie(c,"height","3"),ie(c,"fill","#308182"),ie(c,"stroke",l[0]),ie(c,"stroke-width",l[1])},m(v,a){Re(v,c,a)},p(v,a){a&3200&&d!==(d=v[11].bandwidth?v[7](v[23]):v[7](v[23])[0])&&ie(c,"x",d),a&13312&&p!==(p=v[13](v[12](v[23]))-1)&&ie(c,"y",p),a&3584&&y!==(y=v[11].bandwidth?v[11].bandwidth():v[9](v[23]))&&ie(c,"width",y),a&1&&ie(c,"stroke",v[0]),a&2&&ie(c,"stroke-width",v[1])},d(v){v&&ne(c)}}}function Qd(l){let c,d,p,y,v,a,E,T,L=l[12]&&Jd(l);return{c(){c=Xn("rect"),L&&L.c(),a=Xn("text"),this.h()},l(F){c=Wn(F,"rect",{class:!0,"data-id":!0,x:!0,y:!0,width:!0,height:!0,fill:!0,stroke:!0,"stroke-width":!0}),Oe(c).forEach(ne),L&&L.l(F),a=Wn(F,"text",{x:!0,y:!0,dx:!0,dy:!0,"text-anchor":!0}),Oe(a).forEach(ne),this.h()},h(){ie(c,"class","group-rect"),ie(c,"data-id",l[25]),ie(c,"x",d=l[11].bandwidth?l[7](l[23]):l[7](l[23])[0]),ie(c,"y",p=l[6](l[23])),ie(c,"width",y=l[11].bandwidth?l[11].bandwidth():l[9](l[23])),ie(c,"height",v=l[8](l[23])),ie(c,"fill",l[4]),ie(c,"stroke",l[0]),ie(c,"stroke-width",l[1]),ie(a,"x",E=l[11].bandwidth?l[7](l[23])+l[11].bandwidth()/2:l[7](l[23])[0]),ie(a,"y",T=l[6](l[23])-4),ie(a,"dx",l[2]),ie(a,"dy",l[3]),ie(a,"text-anchor",l[5])},m(F,C){Re(F,c,C),L&&L.m(F,C),Re(F,a,C)},p(F,C){C&3200&&d!==(d=F[11].bandwidth?F[7](F[23]):F[7](F[23])[0])&&ie(c,"x",d),C&1088&&p!==(p=F[6](F[23]))&&ie(c,"y",p),C&3584&&y!==(y=F[11].bandwidth?F[11].bandwidth():F[9](F[23]))&&ie(c,"width",y),C&1280&&v!==(v=F[8](F[23]))&&ie(c,"height",v),C&16&&ie(c,"fill",F[4]),C&1&&ie(c,"stroke",F[0]),C&2&&ie(c,"stroke-width",F[1]),F[12]?L?L.p(F,C):(L=Jd(F),L.c(),L.m(a.parentNode,a)):L&&(L.d(1),L=null),C&3200&&E!==(E=F[11].bandwidth?F[7](F[23])+F[11].bandwidth()/2:F[7](F[23])[0])&&ie(a,"x",E),C&1088&&T!==(T=F[6](F[23])-4)&&ie(a,"y",T),C&4&&ie(a,"dx",F[2]),C&8&&ie(a,"dy",F[3]),C&32&&ie(a,"text-anchor",F[5])},d(F){F&&ne(c),L&&L.d(F),F&&ne(a)}}}function I0(l){let c,d=l[10],p=[];for(let y=0;y<d.length;y+=1)p[y]=Qd(Yd(l,d,y));return{c(){c=Xn("g");for(let y=0;y<p.length;y+=1)p[y].c();this.h()},l(y){c=Wn(y,"g",{class:!0});var v=Oe(c);for(let a=0;a<p.length;a+=1)p[a].l(v);v.forEach(ne),this.h()},h(){ie(c,"class","column-group svelte-wgzwsk")},m(y,v){Re(y,c,v);for(let a=0;a<p.length;a+=1)p[a]&&p[a].m(c,null)},p(y,[v]){if(v&16383){d=y[10];let a;for(a=0;a<d.length;a+=1){const E=Yd(y,d,a);p[a]?p[a].p(E,v):(p[a]=Qd(E),p[a].c(),p[a].m(c,null))}for(;a<p.length;a+=1)p[a].d(1);p.length=d.length}},i:ei,o:ei,d(y){y&&ne(c),an(p,y)}}}function A0(l,c,d){let p,y,v,a,E,T,L,F,C;const{data:M,xGet:X,yGet:ae,yRange:se,xScale:he,yScale:me,y:_e,z:it}=Ku("LayerCake");Ht(l,M,Ke=>d(10,T=Ke)),Ht(l,X,Ke=>d(7,E=Ke)),Ht(l,ae,Ke=>d(6,v=Ke)),Ht(l,se,Ke=>d(21,a=Ke)),Ht(l,he,Ke=>d(11,L=Ke)),Ht(l,me,Ke=>d(13,C=Ke)),Ht(l,it,Ke=>d(12,F=Ke));let{stroke:Fe=""}=c,{strokeWidth:Pe=0}=c,{dxTick:Ze=0}=c,{dyTick:Ct=0}=c,{fill:kt="#00205b"}=c,{textAnchor:Ge="middle"}=c;return l.$$set=Ke=>{"stroke"in Ke&&d(0,Fe=Ke.stroke),"strokeWidth"in Ke&&d(1,Pe=Ke.strokeWidth),"dxTick"in Ke&&d(2,Ze=Ke.dxTick),"dyTick"in Ke&&d(3,Ct=Ke.dyTick),"fill"in Ke&&d(4,kt=Ke.fill),"textAnchor"in Ke&&d(5,Ge=Ke.textAnchor)},l.$$.update=()=>{l.$$.dirty&128&&d(9,p=Ke=>{const gt=E(Ke);return Math.max(0,gt[1]-gt[0])}),l.$$.dirty&2097216&&d(8,y=Ke=>a[0]-v(Ke))},[Fe,Pe,Ze,Ct,kt,Ge,v,E,y,p,T,L,F,C,M,X,ae,se,he,me,it,a]}class z0 extends on{constructor(c){super(),sn(this,c,A0,I0,ln,{stroke:0,strokeWidth:1,dxTick:2,dyTick:3,fill:4,textAnchor:5})}}function $d(l,c,d){const p=l.slice();return p[28]=c[d],p[30]=d,p}function em(l){let c,d,p,y;return{c(){c=Xn("line"),this.h()},l(v){c=Wn(v,"line",{y1:!0,y2:!0,x1:!0,x2:!0,stroke:!0,"stroke-width":!0,class:!0}),Oe(c).forEach(ne),this.h()},h(){ie(c,"y1",d=l[20]*-1),ie(c,"y2",p=l[14]&&l[30]%2==0?l[10]+l[8]+2:l[10]+l[8]-13),ie(c,"x1","0"),ie(c,"x2","0"),ie(c,"stroke",l[11]),ie(c,"stroke-width",y=l[15]&&Array.isArray(l[4])&&l[30]==Math.floor(l[4].length/2)?2:1),ie(c,"class","svelte-fwjh80"),rs(c,"baseline",l[13])},m(v,a){Re(v,c,a)},p(v,a){a&1048576&&d!==(d=v[20]*-1)&&ie(c,"y1",d),a&17664&&p!==(p=v[14]&&v[30]%2==0?v[10]+v[8]+2:v[10]+v[8]-13)&&ie(c,"y2",p),a&2048&&ie(c,"stroke",v[11]),a&32784&&y!==(y=v[15]&&Array.isArray(v[4])&&v[30]==Math.floor(v[4].length/2)?2:1)&&ie(c,"stroke-width",y),a&8192&&rs(c,"baseline",v[13])},d(v){v&&ne(c)}}}function P0(l){let c=l[1](l[28])+"",d;return{c(){d=zt(c)},l(p){d=Pt(p,c)},m(p,y){Re(p,d,y)},p(p,y){y&262146&&c!==(c=p[1](p[28])+"")&&Er(d,c)},d(p){p&&ne(d)}}}function C0(l){let c,d=l[1](l[28])+"",p,y;return{c(){c=zt(l[5]),p=zt(d),y=zt(l[6])},l(v){c=Pt(v,l[5]),p=Pt(v,d),y=Pt(v,l[6])},m(v,a){Re(v,c,a),Re(v,p,a),Re(v,y,a)},p(v,a){a&32&&Er(c,v[5]),a&262146&&d!==(d=v[1](v[28])+"")&&Er(p,d),a&64&&Er(y,v[6])},d(v){v&&ne(c),v&&ne(p),v&&ne(y)}}}function tm(l){let c,d,p,y,v,a,E,T=l[0]!==!1&&em(l);function L(M,X){return M[30]==M[18].length-1?C0:P0}let F=L(l),C=F(l);return{c(){c=Xn("g"),T&&T.c(),d=Xn("text"),C.c(),this.h()},l(M){c=Wn(M,"g",{class:!0,transform:!0});var X=Oe(c);T&&T.l(X),d=Wn(X,"text",{x:!0,y:!0,dx:!0,dy:!0,"text-anchor":!0,fill:!0,class:!0});var ae=Oe(d);C.l(ae),ae.forEach(ne),X.forEach(ne),this.h()},h(){ie(d,"x",p=l[7]||l[16]?l[17].bandwidth()/2:0),ie(d,"y",y=l[3]?l[20]*-1-6:l[14]&&l[30]%2==0?l[8]+15:l[8]),ie(d,"dx",v=l[24](l[30])=="start"?l[9]-2:l[24](l[30])=="end"?l[9]+2:l[9]),ie(d,"dy",l[10]),ie(d,"text-anchor",l[24](l[30])),ie(d,"fill",l[12]),ie(d,"class","svelte-fwjh80"),rs(d,"bold",l[15]&&Array.isArray(l[4])&&l[30]==Math.floor(l[4].length/2)),ie(c,"class",a="tick tick-"+l[28]+" svelte-fwjh80"),ie(c,"transform",E="translate("+l[17](l[28])+","+l[19][0]+")")},m(M,X){Re(M,c,X),T&&T.m(c,null),we(c,d),C.m(d,null)},p(M,X){M[0]!==!1?T?T.p(M,X):(T=em(M),T.c(),T.m(c,d)):T&&(T.d(1),T=null),F===(F=L(M))&&C?C.p(M,X):(C.d(1),C=F(M),C&&(C.c(),C.m(d,null))),X&196736&&p!==(p=M[7]||M[16]?M[17].bandwidth()/2:0)&&ie(d,"x",p),X&1065224&&y!==(y=M[3]?M[20]*-1-6:M[14]&&M[30]%2==0?M[8]+15:M[8])&&ie(d,"y",y),X&512&&v!==(v=M[24](M[30])=="start"?M[9]-2:M[24](M[30])=="end"?M[9]+2:M[9])&&ie(d,"dx",v),X&1024&&ie(d,"dy",M[10]),X&4096&&ie(d,"fill",M[12]),X&32784&&rs(d,"bold",M[15]&&Array.isArray(M[4])&&M[30]==Math.floor(M[4].length/2)),X&262144&&a!==(a="tick tick-"+M[28]+" svelte-fwjh80")&&ie(c,"class",a),X&917504&&E!==(E="translate("+M[17](M[28])+","+M[19][0]+")")&&ie(c,"transform",E)},d(M){M&&ne(c),T&&T.d(),C.d()}}}function rm(l){let c,d,p;return{c(){c=Xn("line"),this.h()},l(y){c=Wn(y,"line",{class:!0,y1:!0,y2:!0,x1:!0,x2:!0,stroke:!0}),Oe(c).forEach(ne),this.h()},h(){ie(c,"class","baseline svelte-fwjh80"),ie(c,"y1",l[20]),ie(c,"y2","0"),ie(c,"x1",d=l[17](0)),ie(c,"x2",p=l[17](0)),ie(c,"stroke",l[11])},m(y,v){Re(y,c,v)},p(y,v){v&1048576&&ie(c,"y1",y[20]),v&131072&&d!==(d=y[17](0))&&ie(c,"x1",d),v&131072&&p!==(p=y[17](0))&&ie(c,"x2",p),v&2048&&ie(c,"stroke",y[11])},d(y){y&&ne(c)}}}function M0(l){let c,d,p=l[18],y=[];for(let a=0;a<p.length;a+=1)y[a]=tm($d(l,p,a));let v=l[2]===!0&&rm(l);return{c(){c=Xn("g");for(let a=0;a<y.length;a+=1)y[a].c();d=or(),v&&v.c(),this.h()},l(a){c=Wn(a,"g",{class:!0});var E=Oe(c);for(let T=0;T<y.length;T+=1)y[T].l(E);d=or(),v&&v.l(E),E.forEach(ne),this.h()},h(){ie(c,"class","axis x-axis")},m(a,E){Re(a,c,E);for(let T=0;T<y.length;T+=1)y[T]&&y[T].m(c,null);we(c,d),v&&v.m(c,null)},p(a,[E]){if(E&18874363){p=a[18];let T;for(T=0;T<p.length;T+=1){const L=$d(a,p,T);y[T]?y[T].p(L,E):(y[T]=tm(L),y[T].c(),y[T].m(c,d))}for(;T<y.length;T+=1)y[T].d(1);y.length=p.length}a[2]===!0?v?v.p(a,E):(v=rm(a),v.c(),v.m(c,null)):v&&(v.d(1),v=null)},i:ei,o:ei,d(a){a&&ne(c),an(y,a),v&&v.d()}}}function D0(l,c,d){let p,y,v,a,E;const{width:T,height:L,xScale:F,yScale:C,yRange:M}=Ku("LayerCake");Ht(l,L,Be=>d(20,E=Be)),Ht(l,F,Be=>d(17,v=Be)),Ht(l,M,Be=>d(19,a=Be));let{gridlines:X=!0}=c,{formatTick:ae=Be=>Be}=c,{baseline:se=!1}=c,{flipped:he=!1}=c,{snapTicks:me=!1}=c,{ticks:_e=void 0}=c,{prefix:it=""}=c,{suffix:Fe=""}=c,{xTick:Pe=void 0}=c,{yTick:Ze=15}=c,{dxTick:Ct=0}=c,{dyTick:kt=0}=c,{lineColor:Ge="#999"}=c,{textColor:Ke="#555"}=c,{solid:gt=!1}=c,{stagger:ur=!1}=c,{median:je=!0}=c;function Ft(Be){if(me===!0){if(Be===0)return"start";if(Be===y.length-1)return"end"}return"middle"}return l.$$set=Be=>{"gridlines"in Be&&d(0,X=Be.gridlines),"formatTick"in Be&&d(1,ae=Be.formatTick),"baseline"in Be&&d(2,se=Be.baseline),"flipped"in Be&&d(3,he=Be.flipped),"snapTicks"in Be&&d(25,me=Be.snapTicks),"ticks"in Be&&d(4,_e=Be.ticks),"prefix"in Be&&d(5,it=Be.prefix),"suffix"in Be&&d(6,Fe=Be.suffix),"xTick"in Be&&d(7,Pe=Be.xTick),"yTick"in Be&&d(8,Ze=Be.yTick),"dxTick"in Be&&d(9,Ct=Be.dxTick),"dyTick"in Be&&d(10,kt=Be.dyTick),"lineColor"in Be&&d(11,Ge=Be.lineColor),"textColor"in Be&&d(12,Ke=Be.textColor),"solid"in Be&&d(13,gt=Be.solid),"stagger"in Be&&d(14,ur=Be.stagger),"median"in Be&&d(15,je=Be.median)},l.$$.update=()=>{l.$$.dirty&131072&&d(16,p=typeof v.bandwidth=="function"),l.$$.dirty&196624&&d(18,y=Array.isArray(_e)?_e:p?v.domain():v.ticks(_e))},[X,ae,se,he,_e,it,Fe,Pe,Ze,Ct,kt,Ge,Ke,gt,ur,je,p,v,y,a,E,L,F,M,Ft,me]}class L0 extends on{constructor(c){super(),sn(this,c,D0,M0,ln,{gridlines:0,formatTick:1,baseline:2,flipped:3,snapTicks:25,ticks:4,prefix:5,suffix:6,xTick:7,yTick:8,dxTick:9,dyTick:10,lineColor:11,textColor:12,solid:13,stagger:14,median:15})}}function R0(l){let c,d,p,y;return c=new z0({props:{fill:l[1],formatVal:l[5]}}),p=new L0({props:{gridlines:!1}}),{c(){er(c.$$.fragment),d=bt(),er(p.$$.fragment)},l(v){tr(c.$$.fragment,v),d=xt(v),tr(p.$$.fragment,v)},m(v,a){rr(c,v,a),Re(v,d,a),rr(p,v,a),y=!0},p(v,a){const E={};a&2&&(E.fill=v[1]),a&32&&(E.formatVal=v[5]),c.$set(E)},i(v){y||(tt(c.$$.fragment,v),tt(p.$$.fragment,v),y=!0)},o(v){ct(c.$$.fragment,v),ct(p.$$.fragment,v),y=!1},d(v){ir(c,v),v&&ne(d),ir(p,v)}}}function B0(l){let c,d;return c=new T0({props:{$$slots:{default:[R0]},$$scope:{ctx:l}}}),{c(){er(c.$$.fragment)},l(p){tr(c.$$.fragment,p)},m(p,y){rr(c,p,y),d=!0},p(p,y){const v={};y&1058&&(v.$$scope={dirty:y,ctx:p}),c.$set(v)},i(p){d||(tt(c.$$.fragment,p),d=!0)},o(p){ct(c.$$.fragment,p),d=!1},d(p){ir(c,p)}}}function O0(l){let c,d,p;return d=new x0({props:{padding:{top:15,right:0,bottom:20,left:0},x:l[2],y:l[3],z:l[4],xScale:yy().paddingInner([.02]).round(!0),xDomain:l[7],yDomain:l[6],zDomain:l[6],data:l[0],$$slots:{default:[B0]},$$scope:{ctx:l}}}),{c(){c=Ue("div"),er(d.$$.fragment),this.h()},l(y){c=qe(y,"DIV",{class:!0});var v=Oe(c);tr(d.$$.fragment,v),v.forEach(ne),this.h()},h(){ie(c,"class","chart-container svelte-1i1qsul")},m(y,v){Re(y,c,v),rr(d,c,null),p=!0},p(y,[v]){const a={};v&4&&(a.x=y[2]),v&8&&(a.y=y[3]),v&16&&(a.z=y[4]),v&128&&(a.xDomain=y[7]),v&64&&(a.yDomain=y[6]),v&64&&(a.zDomain=y[6]),v&1&&(a.data=y[0]),v&1058&&(a.$$scope={dirty:v,ctx:y}),d.$set(a)},i(y){p||(tt(d.$$.fragment,y),p=!0)},o(y){ct(d.$$.fragment,y),p=!1},d(y){y&&ne(c),ir(d)}}}function F0(l,c,d){let p,y,v,{data:a}=c,{suffix:E="%"}=c,{decimals:T=null}=c,{fill:L="#00205B"}=c,{xKey:F="x"}=c,{yKey:C="y"}=c,{zKey:M=null}=c;return l.$$set=X=>{"data"in X&&d(0,a=X.data),"suffix"in X&&d(8,E=X.suffix),"decimals"in X&&d(9,T=X.decimals),"fill"in X&&d(1,L=X.fill),"xKey"in X&&d(2,F=X.xKey),"yKey"in X&&d(3,C=X.yKey),"zKey"in X&&d(4,M=X.zKey)},l.$$.update=()=>{l.$$.dirty&5&&d(7,p=a.map(X=>X[F])),l.$$.dirty&9&&d(6,y=[0,Math.max(...a.map(X=>X[C]))]),l.$$.dirty&768&&d(5,v=X=>X.toFixed(T)+E)},[a,L,F,C,M,v,y,p,E,T]}class Lh extends on{constructor(c){super(),sn(this,c,F0,O0,ln,{data:0,suffix:8,decimals:9,fill:1,xKey:2,yKey:3,zKey:4})}}function im(l,c,d){const p=l.slice();return p[6]=c[d],p[8]=d,p}function nm(l){let c,d=l[0],p=[];for(let y=0;y<d.length;y+=1)p[y]=am(im(l,d,y));return{c(){c=Xn("svg");for(let y=0;y<p.length;y+=1)p[y].c();this.h()},l(y){c=Wn(y,"svg",{class:!0});var v=Oe(c);for(let a=0;a<p.length;a+=1)p[a].l(v);v.forEach(ne),this.h()},h(){ie(c,"class","stack svelte-pzvhwz")},m(y,v){Re(y,c,v);for(let a=0;a<p.length;a+=1)p[a]&&p[a].m(c,null)},p(y,v){if(v&31){d=y[0];let a;for(a=0;a<d.length;a+=1){const E=im(y,d,a);p[a]?p[a].p(E,v):(p[a]=am(E),p[a].c(),p[a].m(c,null))}for(;a<p.length;a+=1)p[a].d(1);p.length=d.length}},d(y){y&&ne(c),an(p,y)}}}function am(l){let c,d;return{c(){c=Xn("rect"),this.h()},l(p){c=Wn(p,"rect",{class:!0,x:!0,style:!0}),Oe(c).forEach(ne),this.h()},h(){ie(c,"class","cell svelte-pzvhwz"),ie(c,"x",d=l[4][l[8]]/l[3]*100+"%"),Ye(c,"width",l[6][l[1]]/l[3]*100+"%"),Ye(c,"fill",l[2][l[8]])},m(p,y){Re(p,c,y)},p(p,y){y&24&&d!==(d=p[4][p[8]]/p[3]*100+"%")&&ie(c,"x",d),y&11&&Ye(c,"width",p[6][p[1]]/p[3]*100+"%"),y&4&&Ye(c,"fill",p[2][p[8]])},d(p){p&&ne(c)}}}function N0(l){let c,d=l[3]&&l[4]&&nm(l);return{c(){d&&d.c(),c=or()},l(p){d&&d.l(p),c=or()},m(p,y){d&&d.m(p,y),Re(p,c,y)},p(p,[y]){p[3]&&p[4]?d?d.p(p,y):(d=nm(p),d.c(),d.m(c.parentNode,c)):d&&(d.d(1),d=null)},i:ei,o:ei,d(p){d&&d.d(p),p&&ne(c)}}}function V0(l,c,d){let{data:p}=c,{yKey:y="y"}=c,{colors:v=["#00205B","#308182","#002417","#BD00BD","lightgrey"]}=c,a,E;function T(){d(3,a=p.map(F=>F[y]).reduce((F,C)=>F+C,0));let L=[0];p.forEach(F=>L.push(L[L.length-1]+F[y])),d(4,E=L)}return l.$$set=L=>{"data"in L&&d(0,p=L.data),"yKey"in L&&d(1,y=L.yKey),"colors"in L&&d(2,v=L.colors)},l.$$.update=()=>{l.$$.dirty&3&&(p||y)&&T()},[p,y,v,a,E]}class Yp extends on{constructor(c){super(),sn(this,c,V0,N0,ln,{data:0,yKey:1,colors:2})}}function om(l,c,d){const p=l.slice();return p[10]=c[d],p[12]=d,p}function U0(l){let c,d,p=l[6](l[10][l[3]])+"",y,v;return{c(){c=Ue("span"),d=zt("(NI "),y=zt(p),v=zt(")"),this.h()},l(a){c=qe(a,"SPAN",{class:!0,style:!0});var E=Oe(c);d=Pt(E,"(NI "),y=Pt(E,p),v=Pt(E,")"),E.forEach(ne),this.h()},h(){ie(c,"class",""),Ye(c,"color","#1460aa")},m(a,E){Re(a,c,E),we(c,d),we(c,y),we(c,v)},p(a,E){E&9&&p!==(p=a[6](a[10][a[3]])+"")&&Er(y,p)},d(a){a&&ne(c)}}}function q0(l){let c;return{c(){c=Ue("span"),this.h()},l(d){c=qe(d,"SPAN",{class:!0,style:!0}),Oe(c).forEach(ne),this.h()},h(){ie(c,"class",""),Ye(c,"color","#1460aa")},m(d,p){Re(d,c,p)},p:ei,d(d){d&&ne(c)}}}function j0(l){let c,d,p=_d(Math.round(l[10][l[3]]),"%)")+"",y;return{c(){c=Ue("span"),d=zt("(2011 "),y=zt(p),this.h()},l(v){c=qe(v,"SPAN",{class:!0,style:!0});var a=Oe(c);d=Pt(a,"(2011 "),y=Pt(a,p),a.forEach(ne),this.h()},h(){ie(c,"class",""),Ye(c,"color","#1460aa")},m(v,a){Re(v,c,a),we(c,d),we(c,y)},p(v,a){a&9&&p!==(p=_d(Math.round(v[10][v[3]]),"%)")+"")&&Er(y,p)},d(v){v&&ne(c)}}}function sm(l){let c,d,p,y,v,a=l[10][l[1]]+"",E,T,L,F=l[6](l[10][l[2]])+"",C,M,X;function ae(me,_e){if(me[3]=="prev"&&me[4])return j0;if(me[3]=="prev"&&!me[4])return q0;if(me[3])return U0}let se=ae(l),he=se&&se(l);return{c(){c=Ue("tr"),d=Ue("td"),p=Xn("svg"),y=Xn("rect"),v=bt(),E=zt(a),T=bt(),L=Ue("td"),C=zt(F),M=bt(),he&&he.c(),X=bt(),this.h()},l(me){c=qe(me,"TR",{});var _e=Oe(c);d=qe(_e,"TD",{class:!0});var it=Oe(d);p=Wn(it,"svg",{width:!0,height:!0,class:!0});var Fe=Oe(p);y=Wn(Fe,"rect",{width:!0,height:!0,style:!0}),Oe(y).forEach(ne),Fe.forEach(ne),v=xt(it),E=Pt(it,a),it.forEach(ne),T=xt(_e),L=qe(_e,"TD",{class:!0,style:!0});var Pe=Oe(L);C=Pt(Pe,F),M=xt(Pe),he&&he.l(Pe),Pe.forEach(ne),X=xt(_e),_e.forEach(ne),this.h()},h(){ie(y,"width","20"),ie(y,"height","30"),Ye(y,"fill",l[5][l[12]]),ie(p,"width","20"),ie(p,"height","30"),ie(p,"class","bullet svelte-1gvovsq"),ie(d,"class","svelte-1gvovsq"),ie(L,"class","cell-right svelte-1gvovsq"),Ye(L,"vertical-align","top")},m(me,_e){Re(me,c,_e),we(c,d),we(d,p),we(p,y),we(d,v),we(d,E),we(c,T),we(c,L),we(L,C),we(L,M),he&&he.m(L,null),we(c,X)},p(me,_e){_e&32&&Ye(y,"fill",me[5][me[12]]),_e&3&&a!==(a=me[10][me[1]]+"")&&Er(E,a),_e&5&&F!==(F=me[6](me[10][me[2]])+"")&&Er(C,F),se===(se=ae(me))&&he?he.p(me,_e):(he&&he.d(1),he=se&&se(me),he&&(he.c(),he.m(L,null)))},d(me){me&&ne(c),he&&he.d()}}}function G0(l){let c,d,p=l[0],y=[];for(let v=0;v<p.length;v+=1)y[v]=sm(om(l,p,v));return{c(){c=Ue("table"),d=Ue("tbody");for(let v=0;v<y.length;v+=1)y[v].c();this.h()},l(v){c=qe(v,"TABLE",{class:!0});var a=Oe(c);d=qe(a,"TBODY",{});var E=Oe(d);for(let T=0;T<y.length;T+=1)y[T].l(E);E.forEach(ne),a.forEach(ne),this.h()},h(){ie(c,"class","legend svelte-1gvovsq")},m(v,a){Re(v,c,a),we(c,d);for(let E=0;E<y.length;E+=1)y[E]&&y[E].m(d,null)},p(v,[a]){if(a&127){p=v[0];let E;for(E=0;E<p.length;E+=1){const T=om(v,p,E);y[E]?y[E].p(T,a):(y[E]=sm(T),y[E].c(),y[E].m(d,null))}for(;E<y.length;E+=1)y[E].d(1);y.length=p.length}},i:ei,o:ei,d(v){v&&ne(c),an(y,v)}}}function Z0(l,c,d){let p,{data:y}=c,{xKey:v="x"}=c,{yKey:a="y"}=c,{zKey:E="ni"}=c,{topic_prev_available:T=!0}=c,{colors:L=["#3878c5","#00205B","#308182","#002417","#BD00BD","lightgrey"]}=c,{decimals:F=null}=c;function C(M){let X;return F?X=(M/p*100).toFixed(F)+"%":M/p*100<1?X="<1%":X=(M/p*100).toFixed(0)+"%",X}return l.$$set=M=>{"data"in M&&d(0,y=M.data),"xKey"in M&&d(1,v=M.xKey),"yKey"in M&&d(2,a=M.yKey),"zKey"in M&&d(3,E=M.zKey),"topic_prev_available"in M&&d(4,T=M.topic_prev_available),"colors"in M&&d(5,L=M.colors),"decimals"in M&&d(7,F=M.decimals)},l.$$.update=()=>{l.$$.dirty&5&&(p=y.map(M=>M[a]).reduce((M,X)=>M+X,0)),l.$$.dirty&9&&y.map(M=>M[E]).reduce((M,X)=>M+X,0)},[y,v,a,E,T,L,C,F]}class K0 extends on{constructor(c){super(),sn(this,c,Z0,G0,ln,{data:0,xKey:1,yKey:2,zKey:3,topic_prev_available:4,colors:5,decimals:7})}}function lm(l){let c,d,p,y;d=new Yp({props:{data:l[0],yKey:l[4],colors:l[6]}});let v=l[8]&&um(l);return{c(){c=Ue("div"),er(d.$$.fragment),p=bt(),v&&v.c(),this.h()},l(a){c=qe(a,"DIV",{class:!0,style:!0});var E=Oe(c);tr(d.$$.fragment,E),p=xt(E),v&&v.l(E),E.forEach(ne),this.h()},h(){ie(c,"class","chart svelte-1tebgpk"),Ye(c,"height",l[1]*.28+"px")},m(a,E){Re(a,c,E),rr(d,c,null),we(c,p),v&&v.m(c,null),y=!0},p(a,E){const T={};E&1&&(T.data=a[0]),E&16&&(T.yKey=a[4]),E&64&&(T.colors=a[6]),d.$set(T),a[8]?v?v.p(a,E):(v=um(a),v.c(),v.m(c,null)):v&&(v.d(1),v=null),(!y||E&2)&&Ye(c,"height",a[1]*.28+"px")},i(a){y||(tt(d.$$.fragment,a),y=!0)},o(a){ct(d.$$.fragment,a),y=!1},d(a){a&&ne(c),ir(d),v&&v.d()}}}function um(l){let c,d;return{c(){c=Ue("div"),d=zt(l[8]),this.h()},l(p){c=qe(p,"DIV",{class:!0});var y=Oe(c);d=Pt(y,l[8]),y.forEach(ne),this.h()},h(){ie(c,"class","label svelte-1tebgpk")},m(p,y){Re(p,c,y),we(c,d)},p(p,y){y&256&&Er(d,p[8])},d(p){p&&ne(c)}}}function cm(l){let c,d,p,y,v,a;return d=new Yp({props:{data:l[0],yKey:l[4],colors:l[6]}}),{c(){c=Ue("div"),er(d.$$.fragment),p=bt(),y=Ue("div"),v=zt("2011 comparison not available"),this.h()},l(E){c=qe(E,"DIV",{class:!0,style:!0});var T=Oe(c);tr(d.$$.fragment,T),p=xt(T),y=qe(T,"DIV",{class:!0,style:!0});var L=Oe(y);v=Pt(L,"2011 comparison not available"),L.forEach(ne),T.forEach(ne),this.h()},h(){ie(y,"class","label svelte-1tebgpk"),Ye(y,"background-color","#d8d8d8 "),Ye(y,"color","#000000"),ie(c,"class","chart svelte-1tebgpk"),Ye(c,"height",l[1]*.28+"px")},m(E,T){Re(E,c,T),rr(d,c,null),we(c,p),we(c,y),we(y,v),a=!0},p(E,T){const L={};T&1&&(L.data=E[0]),T&16&&(L.yKey=E[4]),T&64&&(L.colors=E[6]),d.$set(L),(!a||T&2)&&Ye(c,"height",E[1]*.28+"px")},i(E){a||(tt(d.$$.fragment,E),a=!0)},o(E){ct(d.$$.fragment,E),a=!1},d(E){E&&ne(c),ir(d)}}}function H0(l){let c,d,p,y,v,a,E,T;d=new Yp({props:{data:l[0],yKey:l[3],colors:l[6]}});let L=(l[4]&&l[5]||l[4]=="ni")&&lm(l),F=l[4]=="prev"&&!l[5]&&cm(l);return E=new K0({props:{data:l[0],xKey:l[2],yKey:l[3],zKey:l[4],topic_prev_available:l[5],decimals:l[7],colors:l[6]}}),{c(){c=Ue("div"),er(d.$$.fragment),p=bt(),L&&L.c(),y=bt(),F&&F.c(),v=bt(),a=Ue("div"),er(E.$$.fragment),this.h()},l(C){c=qe(C,"DIV",{class:!0,style:!0});var M=Oe(c);tr(d.$$.fragment,M),M.forEach(ne),p=xt(C),L&&L.l(C),y=xt(C),F&&F.l(C),v=xt(C),a=qe(C,"DIV",{class:!0});var X=Oe(a);tr(E.$$.fragment,X),X.forEach(ne),this.h()},h(){ie(c,"class","chart svelte-1tebgpk"),Ye(c,"padding-top","3px"),Ye(c,"height",(l[4]?l[1]*.72:l[1])+"px"),ie(a,"class","legend svelte-1tebgpk")},m(C,M){Re(C,c,M),rr(d,c,null),Re(C,p,M),L&&L.m(C,M),Re(C,y,M),F&&F.m(C,M),Re(C,v,M),Re(C,a,M),rr(E,a,null),T=!0},p(C,[M]){const X={};M&1&&(X.data=C[0]),M&8&&(X.yKey=C[3]),M&64&&(X.colors=C[6]),d.$set(X),(!T||M&18)&&Ye(c,"height",(C[4]?C[1]*.72:C[1])+"px"),C[4]&&C[5]||C[4]=="ni"?L?(L.p(C,M),M&48&&tt(L,1)):(L=lm(C),L.c(),tt(L,1),L.m(y.parentNode,y)):L&&(kn(),ct(L,1,1,()=>{L=null}),En()),C[4]=="prev"&&!C[5]?F?(F.p(C,M),M&48&&tt(F,1)):(F=cm(C),F.c(),tt(F,1),F.m(v.parentNode,v)):F&&(kn(),ct(F,1,1,()=>{F=null}),En());const ae={};M&1&&(ae.data=C[0]),M&4&&(ae.xKey=C[2]),M&8&&(ae.yKey=C[3]),M&16&&(ae.zKey=C[4]),M&32&&(ae.topic_prev_available=C[5]),M&128&&(ae.decimals=C[7]),M&64&&(ae.colors=C[6]),E.$set(ae)},i(C){T||(tt(d.$$.fragment,C),tt(L),tt(F),tt(E.$$.fragment,C),T=!0)},o(C){ct(d.$$.fragment,C),ct(L),ct(F),ct(E.$$.fragment,C),T=!1},d(C){C&&ne(c),ir(d),C&&ne(p),L&&L.d(C),C&&ne(y),F&&F.d(C),C&&ne(v),C&&ne(a),ir(E)}}}function X0(l,c,d){let{data:p}=c,{height:y=80}=c,{xKey:v="x"}=c,{yKey:a="y"}=c,{zKey:E="ni"}=c,{topic_prev_available:T=!0}=c,{colors:L=["#8268b6","#00205B","#308182","#3d007a","#3878c5","lightgrey"]}=c,{decimals:F=null}=c,{label:C=null}=c;return l.$$set=M=>{"data"in M&&d(0,p=M.data),"height"in M&&d(1,y=M.height),"xKey"in M&&d(2,v=M.xKey),"yKey"in M&&d(3,a=M.yKey),"zKey"in M&&d(4,E=M.zKey),"topic_prev_available"in M&&d(5,T=M.topic_prev_available),"colors"in M&&d(6,L=M.colors),"decimals"in M&&d(7,F=M.decimals),"label"in M&&d(8,C=M.label)},[p,y,v,a,E,T,L,F,C]}class Rh extends on{constructor(c){super(),sn(this,c,X0,H0,ln,{data:0,height:1,xKey:2,yKey:3,zKey:4,topic_prev_available:5,colors:6,decimals:7,label:8})}}function hm(l,c,d){const p=l.slice();return p[15]=c[d],p}function pm(l,c,d){const p=l.slice();return p[18]=c[d],p[19]=c,p[20]=d,p}function fm(l,c,d){const p=l.slice();return p[15]=c[d],p[20]=d,p}function dm(l){let c,d=l[5],p=[];for(let y=0;y<d.length;y+=1)p[y]=mm(fm(l,d,y));return{c(){c=Ue("ul");for(let y=0;y<p.length;y+=1)p[y].c();this.h()},l(y){c=qe(y,"UL",{class:!0});var v=Oe(c);for(let a=0;a<p.length;a+=1)p[a].l(v);v.forEach(ne),this.h()},h(){ie(c,"class","legend-block svelte-sk00pb")},m(y,v){Re(y,c,v);for(let a=0;a<p.length;a+=1)p[a]&&p[a].m(c,null)},p(y,v){if(v&32){d=y[5];let a;for(a=0;a<d.length;a+=1){const E=fm(y,d,a);p[a]?p[a].p(E,v):(p[a]=mm(E),p[a].c(),p[a].m(c,null))}for(;a<p.length;a+=1)p[a].d(1);p.length=d.length}},d(y){y&&ne(c),an(p,y)}}}function mm(l){let c,d,p,y,v=l[15]+"",a,E;return{c(){c=Ue("li"),d=Ue("div"),p=bt(),y=Ue("span"),a=zt(v),E=bt(),this.h()},l(T){c=qe(T,"LI",{class:!0});var L=Oe(c);d=qe(L,"DIV",{class:!0}),Oe(d).forEach(ne),p=xt(L),y=qe(L,"SPAN",{});var F=Oe(y);a=Pt(F,v),F.forEach(ne),E=xt(L),L.forEach(ne),this.h()},h(){ie(d,"class","legend-vis "+(l[20]==0?"bar":"bar2")+" svelte-sk00pb"),ie(c,"class","svelte-sk00pb")},m(T,L){Re(T,c,L),we(c,d),we(c,p),we(c,y),we(y,a),we(c,E)},p(T,L){L&32&&v!==(v=T[15]+"")&&Er(a,v)},d(T){T&&ne(c)}}}function ym(l){let c,d=`${l[4](l[18][l[0]])}%`,p,y,v=_m(l[18][l[0]])+"",a,E,T=`calc(${l[4](l[18][l[0]])}% + 2px)`;function L(){l[12].call(y,l[19],l[20])}return{c(){c=Ue("div"),p=bt(),y=Ue("div"),a=zt(v),this.h()},l(F){c=qe(F,"DIV",{class:!0}),Oe(c).forEach(ne),p=xt(F),y=qe(F,"DIV",{class:!0});var C=Oe(y);a=Pt(C,v),C.forEach(ne),this.h()},h(){ie(c,"class",zh(l[20]==0?"bar":"bar2")+" svelte-sk00pb"),Ye(c,"left","0"),Ye(c,"width",d),Ye(c,"top",l[20]==0?"0":"50%"),Ye(c,"height",l[5][1]?"50%":"100%"),ie(y,"class","label svelte-sk00pb"),Gu(()=>L.call(y)),Ye(y,"left",T),Ye(y,"top",l[20]==0?"0":"50%"),Ye(y,"height","50%")},m(F,C){Re(F,c,C),Re(F,p,C),Re(F,y,C),we(y,a),E=Zu(y,L.bind(y))},p(F,C){l=F,C&25&&d!==(d=`${l[4](l[18][l[0]])}%`)&&Ye(c,"width",d),C&32&&Ye(c,"height",l[5][1]?"50%":"100%"),C&9&&v!==(v=_m(l[18][l[0]])+"")&&Er(a,v),C&25&&T!==(T=`calc(${l[4](l[18][l[0]])}% + 2px)`)&&Ye(y,"left",T)},d(F){F&&ne(c),F&&ne(p),F&&ne(y),E()}}}function gm(l){let c,d=l[15].label+"",p,y,v,a,E=`${l[5][1]?l[1]*2:l[1]}px`,T=`calc(100% - ${l[2]}px)`,L=l[15].values,F=[];for(let C=0;C<L.length;C+=1)F[C]=ym(pm(l,L,C));return{c(){c=Ue("div"),p=zt(d),y=bt(),v=Ue("div");for(let C=0;C<F.length;C+=1)F[C].c();a=bt(),this.h()},l(C){c=qe(C,"DIV",{class:!0});var M=Oe(c);p=Pt(M,d),M.forEach(ne),y=xt(C),v=qe(C,"DIV",{class:!0});var X=Oe(v);for(let ae=0;ae<F.length;ae+=1)F[ae].l(X);a=xt(X),X.forEach(ne),this.h()},h(){ie(c,"class","label-group svelte-sk00pb"),ie(v,"class","bar-group svelte-sk00pb"),Ye(v,"height",E),Ye(v,"width",T)},m(C,M){Re(C,c,M),we(c,p),Re(C,y,M),Re(C,v,M);for(let X=0;X<F.length;X+=1)F[X]&&F[X].m(v,null);we(v,a)},p(C,M){if(M&8&&d!==(d=C[15].label+"")&&Er(p,d),M&57){L=C[15].values;let X;for(X=0;X<L.length;X+=1){const ae=pm(C,L,X);F[X]?F[X].p(ae,M):(F[X]=ym(ae),F[X].c(),F[X].m(v,a))}for(;X<F.length;X+=1)F[X].d(1);F.length=L.length}M&34&&E!==(E=`${C[5][1]?C[1]*2:C[1]}px`)&&Ye(v,"height",E),M&4&&T!==(T=`calc(100% - ${C[2]}px)`)&&Ye(v,"width",T)},d(C){C&&ne(c),C&&ne(y),C&&ne(v),an(F,C)}}}function W0(l){let c,d,p=l[5][1]&&dm(l),y=l[3],v=[];for(let a=0;a<y.length;a+=1)v[a]=gm(hm(l,y,a));return{c(){p&&p.c(),c=bt();for(let a=0;a<v.length;a+=1)v[a].c();d=or()},l(a){p&&p.l(a),c=xt(a);for(let E=0;E<v.length;E+=1)v[E].l(a);d=or()},m(a,E){p&&p.m(a,E),Re(a,c,E);for(let T=0;T<v.length;T+=1)v[T]&&v[T].m(a,E);Re(a,d,E)},p(a,[E]){if(a[5][1]?p?p.p(a,E):(p=dm(a),p.c(),p.m(c.parentNode,c)):p&&(p.d(1),p=null),E&63){y=a[3];let T;for(T=0;T<y.length;T+=1){const L=hm(a,y,T);v[T]?v[T].p(L,E):(v[T]=gm(L),v[T].c(),v[T].m(d.parentNode,d))}for(;T<v.length;T+=1)v[T].d(1);v.length=y.length}},i:ei,o:ei,d(a){p&&p.d(a),a&&ne(c),an(v,a),a&&ne(d)}}}function _m(l){let c;return l==null?c="Not available":l<1?c="<1%":c=l.toFixed(0)+"%",c}function Y0(l,c,d){let p,y,v,a,{data:E}=c,{xKey:T="perc"}=c,{yKey:L="category"}=c,{zKey:F="ni"}=c,{formatTick:C=me=>Math.round(me)}=c,{suffix:M="%"}=c,{barHeight:X=20}=c,{margin:ae=30}=c;function se(me,_e){let it={};for(const Pe of me)it[Pe[_e]]||(it[Pe[_e]]={label:Pe[_e],values:[]}),it[Pe[_e]].values.push(Pe);let Fe=[];for(const Pe in it)Fe.push(it[Pe]);return Fe}function he(me,_e){me[_e].width=this.clientWidth,d(3,a),d(6,E),d(7,L)}return l.$$set=me=>{"data"in me&&d(6,E=me.data),"xKey"in me&&d(0,T=me.xKey),"yKey"in me&&d(7,L=me.yKey),"zKey"in me&&d(8,F=me.zKey),"formatTick"in me&&d(9,C=me.formatTick),"suffix"in me&&d(10,M=me.suffix),"barHeight"in me&&d(1,X=me.barHeight),"margin"in me&&d(2,ae=me.margin)},l.$$.update=()=>{l.$$.dirty&65&&d(11,p=[0,Math.max(...E.map(me=>me[T]))]),l.$$.dirty&192&&E.map(me=>me[L]).filter((me,_e,it)=>it.indexOf(me)===_e),l.$$.dirty&320&&d(5,y=E.map(me=>me[F]).filter((me,_e,it)=>it.indexOf(me)===_e)),l.$$.dirty&2048&&d(4,v=me=>me/p[1]*100),l.$$.dirty&192&&d(3,a=se(E,L))},[T,X,ae,a,v,y,E,L,F,C,M,p,he]}class Bh extends on{constructor(c){super(),sn(this,c,Y0,W0,ln,{data:6,xKey:0,yKey:7,zKey:8,formatTick:9,suffix:10,barHeight:1,margin:2})}}function vm(l,c,d){const p=l.slice();return p[14]=c[d],p}function bm(l,c,d){const p=l.slice();return p[17]=c[d],p[19]=d,p}function xm(l,c,d){const p=l.slice();return p[17]=c[d],p[19]=d,p}function wm(l,c,d){const p=l.slice();return p[14]=c[d],p[19]=d,p}function Sm(l){let c,d=l[7],p=[];for(let y=0;y<d.length;y+=1)p[y]=km(wm(l,d,y));return{c(){c=Ue("ul");for(let y=0;y<p.length;y+=1)p[y].c();this.h()},l(y){c=qe(y,"UL",{class:!0});var v=Oe(c);for(let a=0;a<p.length;a+=1)p[a].l(v);v.forEach(ne),this.h()},h(){ie(c,"class","legend svelte-1hk4284")},m(y,v){Re(y,c,v);for(let a=0;a<p.length;a+=1)p[a]&&p[a].m(c,null)},p(y,v){if(v&144){d=y[7];let a;for(a=0;a<d.length;a+=1){const E=wm(y,d,a);p[a]?p[a].p(E,v):(p[a]=km(E),p[a].c(),p[a].m(c,null))}for(;a<p.length;a+=1)p[a].d(1);p.length=d.length}},d(y){y&&ne(c),an(p,y)}}}function km(l){let c,d,p,y,v=l[14]+"",a,E;return{c(){c=Ue("li"),d=Ue("div"),p=bt(),y=Ue("span"),a=zt(v),E=bt(),this.h()},l(T){c=qe(T,"LI",{class:!0});var L=Oe(c);d=qe(L,"DIV",{class:!0}),Oe(d).forEach(ne),p=xt(L),y=qe(L,"SPAN",{class:!0});var F=Oe(y);a=Pt(F,v),F.forEach(ne),E=xt(L),L.forEach(ne),this.h()},h(){ie(d,"class","legend-vis "+(l[19]==0?"bar":"marker")+" svelte-1hk4284"),Ye(d,"height","1rem"),Ye(d,"width",l[19]==0?"1rem":l[4]+"px"),ie(y,"class",zh(l[19]==0?"bold":"brackets")+" svelte-1hk4284"),ie(c,"class","svelte-1hk4284")},m(T,L){Re(T,c,L),we(c,d),we(c,p),we(c,y),we(y,a),we(c,E)},p(T,L){L&16&&Ye(d,"width",T[19]==0?"1rem":T[4]+"px"),L&128&&v!==(v=T[14]+"")&&Er(a,v)},d(T){T&&ne(c)}}}function Em(l){let c,d=l[1](l[17].perc/100)+"",p,y;return{c(){c=Ue("span"),p=zt(d),y=zt(l[2]),this.h()},l(v){c=qe(v,"SPAN",{class:!0,style:!0});var a=Oe(c);p=Pt(a,d),y=Pt(a,l[2]),a.forEach(ne),this.h()},h(){ie(c,"class",zh(l[19]==0?"bold":"sml brackets")+" svelte-1hk4284"),Ye(c,"color",l[19]==0?"#000000":"#1460aa")},m(v,a){Re(v,c,a),we(c,p),we(c,y)},p(v,a){a&34&&d!==(d=v[1](v[17].perc/100)+"")&&Er(p,d),a&4&&Er(y,v[2])},d(v){v&&ne(c)}}}function J0(l){let c,d=`calc(${l[6](l[17][l[0]])}% - ${l[4]/2}px)`,p=`${l[4]}px`;return{c(){c=Ue("div"),this.h()},l(y){c=qe(y,"DIV",{class:!0}),Oe(c).forEach(ne),this.h()},h(){ie(c,"class","marker svelte-1hk4284"),Ye(c,"left",d),Ye(c,"border-left-width",p)},m(y,v){Re(y,c,v)},p(y,v){v&113&&d!==(d=`calc(${y[6](y[17][y[0]])}% - ${y[4]/2}px)`)&&Ye(c,"left",d),v&16&&p!==(p=`${y[4]}px`)&&Ye(c,"border-left-width",p)},d(y){y&&ne(c)}}}function Q0(l){let c,d=`${l[6](l[17][l[0]])}%`;return{c(){c=Ue("div"),this.h()},l(p){c=qe(p,"DIV",{class:!0}),Oe(c).forEach(ne),this.h()},h(){ie(c,"class","bar svelte-1hk4284"),Ye(c,"left","0"),Ye(c,"width",d)},m(p,y){Re(p,c,y)},p(p,y){y&97&&d!==(d=`${p[6](p[17][p[0]])}%`)&&Ye(c,"width",d)},d(p){p&&ne(c)}}}function Tm(l){let c;function d(v,a){return v[19]==0?Q0:J0}let y=d(l)(l);return{c(){y.c(),c=or()},l(v){y.l(v),c=or()},m(v,a){y.m(v,a),Re(v,c,a)},p(v,a){y.p(v,a)},d(v){y.d(v),v&&ne(c)}}}function Im(l){let c,d=l[14].label+"",p,y,v,a,E,T=`${l[3]}px`,L=l[14].values,F=[];for(let X=0;X<L.length;X+=1)F[X]=Em(xm(l,L,X));let C=l[14].values,M=[];for(let X=0;X<C.length;X+=1)M[X]=Tm(bm(l,C,X));return{c(){c=Ue("div"),p=zt(d),y=bt();for(let X=0;X<F.length;X+=1)F[X].c();v=bt(),a=Ue("div");for(let X=0;X<M.length;X+=1)M[X].c();E=bt(),this.h()},l(X){c=qe(X,"DIV",{class:!0});var ae=Oe(c);p=Pt(ae,d),y=xt(ae);for(let he=0;he<F.length;he+=1)F[he].l(ae);ae.forEach(ne),v=xt(X),a=qe(X,"DIV",{class:!0});var se=Oe(a);for(let he=0;he<M.length;he+=1)M[he].l(se);E=xt(se),se.forEach(ne),this.h()},h(){ie(c,"class","label-group svelte-1hk4284"),ie(a,"class","bar-group svelte-1hk4284"),Ye(a,"height",T)},m(X,ae){Re(X,c,ae),we(c,p),we(c,y);for(let se=0;se<F.length;se+=1)F[se]&&F[se].m(c,null);Re(X,v,ae),Re(X,a,ae);for(let se=0;se<M.length;se+=1)M[se]&&M[se].m(a,null);we(a,E)},p(X,ae){if(ae&32&&d!==(d=X[14].label+"")&&Er(p,d),ae&38){L=X[14].values;let se;for(se=0;se<L.length;se+=1){const he=xm(X,L,se);F[se]?F[se].p(he,ae):(F[se]=Em(he),F[se].c(),F[se].m(c,null))}for(;se<F.length;se+=1)F[se].d(1);F.length=L.length}if(ae&113){C=X[14].values;let se;for(se=0;se<C.length;se+=1){const he=bm(X,C,se);M[se]?M[se].p(he,ae):(M[se]=Tm(he),M[se].c(),M[se].m(a,E))}for(;se<M.length;se+=1)M[se].d(1);M.length=C.length}ae&8&&T!==(T=`${X[3]}px`)&&Ye(a,"height",T)},d(X){X&&ne(c),an(F,X),X&&ne(v),X&&ne(a),an(M,X)}}}function $0(l){let c,d,p=l[7][1]&&Sm(l),y=l[5],v=[];for(let a=0;a<y.length;a+=1)v[a]=Im(vm(l,y,a));return{c(){p&&p.c(),c=bt();for(let a=0;a<v.length;a+=1)v[a].c();d=or()},l(a){p&&p.l(a),c=xt(a);for(let E=0;E<v.length;E+=1)v[E].l(a);d=or()},m(a,E){p&&p.m(a,E),Re(a,c,E);for(let T=0;T<v.length;T+=1)v[T]&&v[T].m(a,E);Re(a,d,E)},p(a,[E]){if(a[7][1]?p?p.p(a,E):(p=Sm(a),p.c(),p.m(c.parentNode,c)):p&&(p.d(1),p=null),E&127){y=a[5];let T;for(T=0;T<y.length;T+=1){const L=vm(a,y,T);v[T]?v[T].p(L,E):(v[T]=Im(L),v[T].c(),v[T].m(d.parentNode,d))}for(;T<v.length;T+=1)v[T].d(1);v.length=y.length}},i:ei,o:ei,d(a){p&&p.d(a),a&&ne(c),an(v,a),a&&ne(d)}}}function e1(l,c,d){let p,y,v,a,{data:E}=c,{xKey:T="perc"}=c,{yKey:L="category"}=c,{zKey:F="group"}=c,{formatTick:C=he=>Math.round(100*he)}=c,{suffix:M="%"}=c,{barHeight:X=25}=c,{markerWidth:ae=3}=c;function se(he,me){let _e={};for(const Fe of he)_e[Fe[me]]||(_e[Fe[me]]={label:Fe[me],values:[]}),_e[Fe[me]].values.push(Fe);let it=[];for(const Fe in _e)it.push(_e[Fe]);return it}return l.$$set=he=>{"data"in he&&d(8,E=he.data),"xKey"in he&&d(0,T=he.xKey),"yKey"in he&&d(9,L=he.yKey),"zKey"in he&&d(10,F=he.zKey),"formatTick"in he&&d(1,C=he.formatTick),"suffix"in he&&d(2,M=he.suffix),"barHeight"in he&&d(3,X=he.barHeight),"markerWidth"in he&&d(4,ae=he.markerWidth)},l.$$.update=()=>{l.$$.dirty&257&&d(11,p=[0,Math.max(...E.map(he=>he[T]))]),l.$$.dirty&768&&E.map(he=>he[L]).filter((he,me,_e)=>_e.indexOf(he)===me),l.$$.dirty&1280&&d(7,y=E.map(he=>he[F]).filter((he,me,_e)=>_e.indexOf(he)===me)),l.$$.dirty&2048&&d(6,v=he=>he/p[1]*100),l.$$.dirty&768&&d(5,a=se(E,L))},[T,C,M,X,ae,a,v,y,E,L,F,p]}class Oh extends on{constructor(c){super(),sn(this,c,e1,$0,ln,{data:8,xKey:0,yKey:9,zKey:10,formatTick:1,suffix:2,barHeight:3,markerWidth:4})}}function Am(l,c,d){const p=l.slice();return p[12]=c[d],p[14]=d,p}function zm(l,c,d){const p=l.slice();return p[15]=c[d],p[17]=d,p}function Pm(l,c,d){const p=l.slice();return p[15]=c[d],p[17]=d,p}function Cm(l,c,d){const p=l.slice();return p[19]=c[d],p[14]=d,p}function Mm(l){let c,d=l[5],p=[];for(let y=0;y<d.length;y+=1)p[y]=Dm(Cm(l,d,y));return{c(){c=Ue("ul");for(let y=0;y<p.length;y+=1)p[y].c();this.h()},l(y){c=qe(y,"UL",{class:!0});var v=Oe(c);for(let a=0;a<p.length;a+=1)p[a].l(v);v.forEach(ne),this.h()},h(){ie(c,"class","legend svelte-pmaxst")},m(y,v){Re(y,c,v);for(let a=0;a<p.length;a+=1)p[a]&&p[a].m(c,null)},p(y,v){if(v&36){d=y[5];let a;for(a=0;a<d.length;a+=1){const E=Cm(y,d,a);p[a]?p[a].p(E,v):(p[a]=Dm(E),p[a].c(),p[a].m(c,null))}for(;a<p.length;a+=1)p[a].d(1);p.length=d.length}},d(y){y&&ne(c),an(p,y)}}}function Dm(l){let c,d,p,y,v=l[19]+"",a,E;return{c(){c=Ue("li"),d=Ue("div"),p=bt(),y=Ue("span"),a=zt(v),E=bt(),this.h()},l(T){c=qe(T,"LI",{class:!0});var L=Oe(c);d=qe(L,"DIV",{class:!0}),Oe(d).forEach(ne),p=xt(L),y=qe(L,"SPAN",{class:!0});var F=Oe(y);a=Pt(F,v),F.forEach(ne),E=xt(L),L.forEach(ne),this.h()},h(){ie(d,"class","legend-vis "+(l[14]==0?"bar":"markerSmall")+" svelte-pmaxst"),Ye(d,"height","1rem"),Ye(d,"width",l[14]==0?"1rem":l[2]+"px"),ie(y,"class",zh(l[14]==0?"bold":"brackets")+" svelte-pmaxst"),ie(c,"class","svelte-pmaxst")},m(T,L){Re(T,c,L),we(c,d),we(c,p),we(c,y),we(y,a),we(c,E)},p(T,L){L&4&&Ye(d,"width",T[14]==0?"1rem":T[2]+"px"),L&32&&v!==(v=T[19]+"")&&Er(a,v)},d(T){T&&ne(c)}}}function t1(l){let c,d=l[12].values,p=[];for(let y=0;y<d.length;y+=1)p[y]=Lm(zm(l,d,y));return{c(){for(let y=0;y<p.length;y+=1)p[y].c();c=or()},l(y){for(let v=0;v<p.length;v+=1)p[v].l(y);c=or()},m(y,v){for(let a=0;a<p.length;a+=1)p[a]&&p[a].m(y,v);Re(y,c,v)},p(y,v){if(v&89){d=y[12].values;let a;for(a=0;a<d.length;a+=1){const E=zm(y,d,a);p[a]?p[a].p(E,v):(p[a]=Lm(E),p[a].c(),p[a].m(c.parentNode,c))}for(;a<p.length;a+=1)p[a].d(1);p.length=d.length}},d(y){an(p,y),y&&ne(c)}}}function r1(l){let c,d=l[12].values,p=[];for(let y=0;y<d.length;y+=1)p[y]=Rm(Pm(l,d,y));return{c(){for(let y=0;y<p.length;y+=1)p[y].c();c=or()},l(y){for(let v=0;v<p.length;v+=1)p[v].l(y);c=or()},m(y,v){for(let a=0;a<p.length;a+=1)p[a]&&p[a].m(y,v);Re(y,c,v)},p(y,v){if(v&89){d=y[12].values;let a;for(a=0;a<d.length;a+=1){const E=Pm(y,d,a);p[a]?p[a].p(E,v):(p[a]=Rm(E),p[a].c(),p[a].m(c.parentNode,c))}for(;a<p.length;a+=1)p[a].d(1);p.length=d.length}},d(y){an(p,y),y&&ne(c)}}}function Lm(l){let c,d,p=`calc(100% - ${l[15].offset<0?l[4](l[15][l[0]]-l[15].offset):l[4](l[15][l[0]])}%)`,y=`${l[4](l[15].offset)}%`,v=`${l[17]/l[6].length*100}%`,a=`${1/l[6].length*100}%`;return{c(){c=Ue("div"),this.h()},l(E){c=qe(E,"DIV",{class:!0,style:!0}),Oe(c).forEach(ne),this.h()},h(){ie(c,"class","marker svelte-pmaxst"),ie(c,"style",d="border-"+(l[15].offset<0?"top":"bottom")+": none"),Ye(c,"top",p),Ye(c,"height",y),Ye(c,"left",v),Ye(c,"width",a)},m(E,T){Re(E,c,T)},p(E,T){T&8&&d!==(d="border-"+(E[15].offset<0?"top":"bottom")+": none")&&ie(c,"style",d);const L=T&8;(L||T&25&&p!==(p=`calc(100% - ${E[15].offset<0?E[4](E[15][E[0]]-E[15].offset):E[4](E[15][E[0]])}%)`))&&Ye(c,"top",p),(L||T&24&&y!==(y=`${E[4](E[15].offset)}%`))&&Ye(c,"height",y),(L||T&72&&v!==(v=`${E[17]/E[6].length*100}%`))&&Ye(c,"left",v),(L||T&72&&a!==(a=`${1/E[6].length*100}%`))&&Ye(c,"width",a)},d(E){E&&ne(c)}}}function Rm(l){let c,d=`${100-l[4](l[15][l[0]])}%`,p=`${l[4](l[15][l[0]])}%`,y=`${l[17]/l[6].length*100}%`,v=`calc(${1/l[6].length*100}% - 2px)`;return{c(){c=Ue("div"),this.h()},l(a){c=qe(a,"DIV",{class:!0}),Oe(c).forEach(ne),this.h()},h(){ie(c,"class","bar svelte-pmaxst"),Ye(c,"top",d),Ye(c,"height",p),Ye(c,"left",y),Ye(c,"width",v)},m(a,E){Re(a,c,E)},p(a,E){E&25&&d!==(d=`${100-a[4](a[15][a[0]])}%`)&&Ye(c,"top",d),E&25&&p!==(p=`${a[4](a[15][a[0]])}%`)&&Ye(c,"height",p),E&64&&y!==(y=`${a[17]/a[6].length*100}%`)&&Ye(c,"left",y),E&64&&v!==(v=`calc(${1/a[6].length*100}% - 2px)`)&&Ye(c,"width",v)},d(a){a&&ne(c)}}}function Bm(l){let c;function d(v,a){return v[14]==0?r1:t1}let y=d(l)(l);return{c(){y.c(),c=or()},l(v){y.l(v),c=or()},m(v,a){y.m(v,a),Re(v,c,a)},p(v,a){y.p(v,a)},d(v){y.d(v),v&&ne(c)}}}function i1(l){let c,d,p=`${l[1]}px`,y,v,a,E,T,L,F,C,M,X,ae,se,he,me,_e=l[5][1]&&Mm(l),it=l[3],Fe=[];for(let Pe=0;Pe<it.length;Pe+=1)Fe[Pe]=Bm(Am(l,it,Pe));return{c(){_e&&_e.c(),c=bt(),d=Ue("div");for(let Pe=0;Pe<Fe.length;Pe+=1)Fe[Pe].c();y=bt(),v=Ue("div"),a=Ue("div"),E=Ue("div"),T=zt("0-14"),L=bt(),F=Ue("div"),C=zt("15-39"),M=bt(),X=Ue("div"),ae=zt("40-64"),se=bt(),he=Ue("div"),me=zt("65+"),this.h()},l(Pe){_e&&_e.l(Pe),c=xt(Pe),d=qe(Pe,"DIV",{class:!0});var Ze=Oe(d);for(let je=0;je<Fe.length;je+=1)Fe[je].l(Ze);Ze.forEach(ne),y=xt(Pe),v=qe(Pe,"DIV",{class:!0});var Ct=Oe(v);a=qe(Ct,"DIV",{class:!0});var kt=Oe(a);E=qe(kt,"DIV",{class:!0});var Ge=Oe(E);T=Pt(Ge,"0-14"),Ge.forEach(ne),L=xt(kt),F=qe(kt,"DIV",{class:!0});var Ke=Oe(F);C=Pt(Ke,"15-39"),Ke.forEach(ne),M=xt(kt),X=qe(kt,"DIV",{class:!0});var gt=Oe(X);ae=Pt(gt,"40-64"),gt.forEach(ne),se=xt(kt),he=qe(kt,"DIV",{class:!0});var ur=Oe(he);me=Pt(ur,"65+"),ur.forEach(ne),kt.forEach(ne),Ct.forEach(ne),this.h()},h(){ie(d,"class","bar-group svelte-pmaxst"),Ye(d,"height",p),ie(E,"class","column svelte-pmaxst"),ie(F,"class","column svelte-pmaxst"),ie(X,"class","column svelte-pmaxst"),ie(he,"class","column svelte-pmaxst"),ie(a,"class","row svelte-pmaxst"),Ye(a,"width","100%"),ie(v,"class","x-scale svelte-pmaxst")},m(Pe,Ze){_e&&_e.m(Pe,Ze),Re(Pe,c,Ze),Re(Pe,d,Ze);for(let Ct=0;Ct<Fe.length;Ct+=1)Fe[Ct]&&Fe[Ct].m(d,null);Re(Pe,y,Ze),Re(Pe,v,Ze),we(v,a),we(a,E),we(E,T),we(a,L),we(a,F),we(F,C),we(a,M),we(a,X),we(X,ae),we(a,se),we(a,he),we(he,me)},p(Pe,[Ze]){if(Pe[5][1]?_e?_e.p(Pe,Ze):(_e=Mm(Pe),_e.c(),_e.m(c.parentNode,c)):_e&&(_e.d(1),_e=null),Ze&89){it=Pe[3];let Ct;for(Ct=0;Ct<it.length;Ct+=1){const kt=Am(Pe,it,Ct);Fe[Ct]?Fe[Ct].p(kt,Ze):(Fe[Ct]=Bm(kt),Fe[Ct].c(),Fe[Ct].m(d,null))}for(;Ct<Fe.length;Ct+=1)Fe[Ct].d(1);Fe.length=it.length}Ze&2&&p!==(p=`${Pe[1]}px`)&&Ye(d,"height",p)},i:ei,o:ei,d(Pe){_e&&_e.d(Pe),Pe&&ne(c),Pe&&ne(d),an(Fe,Pe),Pe&&ne(y),Pe&&ne(v)}}}function n1(l,c,d){let p,y,v,a,E,{data:T}=c,{xKey:L="category"}=c,{yKey:F="perc"}=c,{zKey:C="group"}=c,{height:M=100}=c,{markerWidth:X=3}=c;function ae(se,he){let me={};for(const it of se){me[it[he]]||(me[it[he]]={label:it[he],values:[]});let Fe=me[it[he]].values.length,Pe=Fe==0?0:it[F]-me[it[he]].values[Fe-1][F];me[it[he]].values.push({...it,offset:Pe})}let _e=[];for(const it in me)_e.push(me[it]);return console.log(_e),_e}return l.$$set=se=>{"data"in se&&d(7,T=se.data),"xKey"in se&&d(8,L=se.xKey),"yKey"in se&&d(0,F=se.yKey),"zKey"in se&&d(9,C=se.zKey),"height"in se&&d(1,M=se.height),"markerWidth"in se&&d(2,X=se.markerWidth)},l.$$.update=()=>{l.$$.dirty&384&&d(6,p=T.map(se=>se[L]).filter((se,he,me)=>me.indexOf(se)===he)),l.$$.dirty&129&&d(10,y=[0,Math.max(...T.map(se=>se[F]))]),l.$$.dirty&640&&d(5,v=T.map(se=>se[C]).filter((se,he,me)=>me.indexOf(se)===he)),l.$$.dirty&1024&&d(4,a=se=>Math.abs(se/y[1])*100),l.$$.dirty&640&&d(3,E=ae(T,C))},[F,M,X,E,a,v,p,T,L,C,y]}class Fh extends on{constructor(c){super(),sn(this,c,n1,i1,ln,{data:7,xKey:8,yKey:0,zKey:9,height:1,markerWidth:2})}}function a1(l){let c,d,p,y,v;return{c(){c=Ue("div"),d=Ue("a"),p=zt("Back to top"),this.h()},l(a){c=qe(a,"DIV",{role:!0,class:!0});var E=Oe(c);d=qe(E,"A",{href:!0,tabindex:!0,class:!0});var T=Oe(d);p=Pt(T,"Back to top"),T.forEach(ne),E.forEach(ne),this.h()},h(){ie(d,"href","#"),ie(d,"tabindex","0"),ie(d,"class","svelte-pkmw6o"),ie(c,"role","region"),ie(c,"class","back_to_start svelte-pkmw6o"),rs(c,"hidden",l[0])},m(a,E){Re(a,c,E),we(c,d),we(d,p),y||(v=[Mp(window,"scroll",l[2]),Mp(c,"click",l[1])],y=!0)},p(a,[E]){E&1&&rs(c,"hidden",a[0])},i:ei,o:ei,d(a){a&&ne(c),y=!1,p_(v)}}}function o1(l,c,d){let{buttonVisibleOnPX:p=200}=c,y=!0;const v=()=>{document.body.scrollIntoView()},a=()=>document.documentElement||document.body,E=()=>{a().scrollTop>p?d(0,y=!1):d(0,y=!0)};return l.$$set=T=>{"buttonVisibleOnPX"in T&&d(3,p=T.buttonVisibleOnPX)},[y,v,E,p]}class s1 extends on{constructor(c){super(),sn(this,c,o1,a1,ln,{buttonVisibleOnPX:3})}}function l1(l){let c,d,p=l[4][l[0]].title+"",y,v,a,E,T,L,F,C,M,X=l[4][l[0]].info+"",ae,se,he;return{c(){c=Ue("div"),d=Ue("div"),y=zt(p),v=bt(),a=Ue("img"),F=bt(),C=Ue("div"),M=Ue("div"),this.h()},l(me){c=qe(me,"DIV",{class:!0,style:!0,"data-bs-toggle":!0,"data-bs-target":!0,"aria-expanded":!0,"aria-controls":!0});var _e=Oe(c);d=qe(_e,"DIV",{class:!0,style:!0});var it=Oe(d);y=Pt(it,p),v=xt(it),a=qe(it,"IMG",{class:!0,src:!0,alt:!0}),it.forEach(ne),_e.forEach(ne),F=xt(me),C=qe(me,"DIV",{class:!0,id:!0});var Fe=Oe(C);M=qe(Fe,"DIV",{class:!0,"aria-hidden":!0});var Pe=Oe(M);Pe.forEach(ne),Fe.forEach(ne),this.h()},h(){ie(a,"class","i-button"),Sh(a.src,E=Sn+"\\img\\i-button.svg")||ie(a,"src",E),ie(a,"alt","Information button"),ie(d,"class","blocktitle"),Ye(d,"margin","0"),Ye(d,"width","100%"),ie(c,"class","row"),Ye(c,"display","flex"),Ye(c,"cursor","pointer"),ie(c,"data-bs-toggle","collapse"),ie(c,"data-bs-target",T="#"+l[0]+"-info"),ie(c,"aria-expanded","false"),ie(c,"aria-controls",L=l[0]+"-info"),ie(M,"class","card card-body svelte-1qrf6oz"),ie(M,"aria-hidden","true"),ie(C,"class","collapse svelte-1qrf6oz"),ie(C,"id",ae=l[0]+"-info")},m(me,_e){Re(me,c,_e),we(c,d),we(d,y),we(d,v),we(d,a),l[6](c),Re(me,F,_e),Re(me,C,_e),we(C,M),M.innerHTML=X,l[7](M),se||(he=Mp(d,"click",l[3]),se=!0)},p(me,[_e]){_e&1&&p!==(p=me[4][me[0]].title+"")&&Er(y,p),_e&1&&T!==(T="#"+me[0]+"-info")&&ie(c,"data-bs-target",T),_e&1&&L!==(L=me[0]+"-info")&&ie(c,"aria-controls",L),_e&1&&X!==(X=me[4][me[0]].info+"")&&(M.innerHTML=X),_e&1&&ae!==(ae=me[0]+"-info")&&ie(C,"id",ae)},i:ei,o:ei,d(me){me&&ne(c),l[6](null),me&&ne(F),me&&ne(C),l[7](null),se=!1,he()}}}function u1(l,c,d){let{id:p}=c,{place:y}=c,v,a;function E(M){let ae=M.replaceAll("[",".").replaceAll("]","").split("."),se=y.meta_data;for(let he=0;he<ae.length;he++)if(se.hasOwnProperty(ae[he])&&(se=se[ae[he]],ae[he]=="last_updated")){let me=se.split("-");se=me[2]+"/"+me[1]+"/"+me[0]}return se}function T(){d(1,v.ariaHidden=!a.ariaExpanded,v)}let L={popden:{title:"Population density",info:"Population density is the number of usual residents per square kilometer. A square kilometer is approximately equivalent to the floor space of 8 Titanics. It is rounded to 1 decimal place. <p class = 'pibutton'>Access data at: <a href='"+E("MYETotal[0].dataset_url")+"'>"+E("MYETotal[0].title")+"</a></p><p class = 'pibutton'>Last updated: "+E("MYETotal[0].last_updated")+"</p> <p class = 'pibutton'><a href='mailto:"+E("MYETotal[0].email")+"'>Email for more information</a> </p>"},pop:{title:"Population",info:"Population is based on the number of usual residents.  <p class = 'pibutton'>Access data at: <a href='"+E("MYETotal[0].dataset_url")+"'>"+E("MYETotal[0].title")+"</a></p><p class = 'pibutton'>Last updated: "+E("MYETotal[0].last_updated")+"</p> <p class = 'pibutton'><a href='mailto:"+E("MYETotal[0].email")+"'>Email for more information</a> </p>"},generalhealth:{title:"General Health",info:"<p>From Census 2021 data - <a href='https://explore.nisra.gov.uk/area-explorer-2021/'><strong>Census Area Explorer</strong></a></p>General health is a self-assessment of a person's general state of health. It is not based over any specified period of time. <a href='https://www.nisra.gov.uk/publications/census-2021-statistical-bulletins'><strong>Statistical bulletins</strong></a>"},wellbeing:{title:"Personal Wellbeing",info:"Average Happiness score out of 10 for people aged 16+</p>Average Life satisfaction score out of 10 for people aged 16+</p><p class = 'pibutton'>Access data at: <a href='"+E("Happy[0].dataset_url")+"'>"+E("Happy[0].title")+"</a></p><p class = 'pibutton'>Last updated: "+E("Happy[0].last_updated")+"</p> <p class = 'pibutton'><a href='mailto:"+E("Happy[0].email")+"'>Email for more information</a> </p>"},lifeexpectancy:{title:"Life Expectancy at birth",info:"<p class = 'pibutton'>Access data at: <a href='"+E("LE[0].dataset_url")+"'>"+E("LE[0].title")+"</a></p><p class = 'pibutton'>Last updated: "+E("LE[0].last_updated")+"</p> <p class = 'pibutton'><a href='mailto:"+E("LE[0].email")+"'>Email for more information</a> </p>"},carers:{title:"Unpaid care giving",info:"<p>From Census 2021 data - <a href='https://explore.nisra.gov.uk/area-explorer-2021/'><strong>Census Area Explorer</strong></a></p>Unpaid care covers looking after giving help or support to anyone because they have long-term physical or mental health conditions or illnesses, or problems related to old age. It does not include any activities as part of paid employment. All unpaid care statistics are restricted to persons aged 5 and over. <a href='https://www.nisra.gov.uk/publications/census-2021-statistical-bulletins'><strong>Statistical bulletins</strong></a>"},hospitalactivity:{title:"Annual admissions to hospital",info:"<p class = 'pibutton'>Access data at: <a href='"+E("Admiss[0].dataset_url")+"'>"+E("Admiss[0].title")+"</a></p><p class = 'pibutton'>Last updated: "+E("Admiss[0].last_updated")+"</p> <p class = 'pibutton'><a href='mailto:"+E("Admiss[0].email")+"'>Email for more information</a> </p>"},primarycare:{title:"Primary care providers",info:"<p class = 'pibutton'>Access data at: <a href='"+E("GP[0].dataset_url")+"'>"+E("GP[0].title")+"</a>, <a href='"+E("DEN[0].dataset_url")+"'>"+E("DEN[0].title")+"</a> and <a href='"+E("DEN_REG[0].dataset_url")+"'>"+E("DEN_REG[0].title")+"</a></p>"},employmentrates:{title:"Work status of adults",info:"<p class = 'pibutton'>Access data at: <a href='"+E("LMS[0].dataset_url")+"'>"+E("LMS[0].title")+"</a></p><p class = 'pibutton'>Last updated: "+E("LMS[0].last_updated")+"</p> <p class = 'pibutton'><a href='mailto:"+E("LMS[0].email")+"'>Email for more information</a> </p><p>Inactive includes students, early retirees, or people looking after a home, who are long-term sick or disabled. </p>"},employed:{title:"Work and wages",info:"<p class = 'pibutton'>Access data on number employed at: <a href='"+E("LMS[0].dataset_url")+"'>"+E("LMS[0].title")+"</a></p><p class = 'pibutton'>Last updated: "+E("LMS[0].last_updated")+"</p><p class = 'pibutton'><a href='mailto:"+E("LMS[0].email")+"'>Email for more information</a> </p><p >Access wages data at: <a href='"+E("ASHE[0].dataset_url")+"'>"+E("ASHE[0].title")+"</a></p><p class = 'pibutton'>Last updated: "+E("ASHE[0].last_updated")+"</p> <p class = 'pibutton'><a href='mailto:"+E("ASHE[0].email")+"'>Email for more information</a> </p><p>Median is the ..... </p>"},wages:{title:"Average annual wage",info:"<p class = 'pibutton'>Access data at: <a href='"+E("ASHE[0].dataset_url")+"'>"+E("ASHE[0].title")+"</a></p><p class = 'pibutton'>Last updated: "+E("ASHE[0].last_updated")+"</p> <p class = 'pibutton'><a href='mailto:"+E("ASHE[0].email")+"'>Email for more information</a> </p><p>Median is the ..... </p>"},bres:{title:"Type of work",info:"<p class = 'pibutton'>Access data at: <a href='"+E("BRES[0].dataset_url")+"'>"+E("BRES[0].title")+"</a></p><p class = 'pibutton'>Last updated: "+E("BRES[0].last_updated")+"</p><p class = 'pibutton'><a href='mailto:"+E("BRES[0].email")+"'>Email for more information</a> </p>"},pensionagebenefits:{title:"Pension Age benefits",info:"Benefits included are: Retirement Pension and Pension Credit<p class = 'pibutton'>Access data at: <a href='"+E("BS[0].dataset_url")+"'>"+E("BS[0].title")+"</a></p><p class = 'pibutton'>Last updated: "+E("BS[0].last_updated")+"</p> <p class = 'pibutton'><a href='mailto:"+E("BS[0].email")+"'>Email for more information</a> </p>"},workingagebenefits:{title:"Working Age benefits",info:"Benefits included are: Universal Credit, Jobseekers Allowance, Income Support and Employment & Support Allowance<p class = 'pibutton'>Access data at: <a href='"+E("BS[0].dataset_url")+"'>"+E("BS[0].title")+"</a></p><p class = 'pibutton'>Last updated: "+E("BS[0].last_updated")+"</p> <p class = 'pibutton'><a href='mailto:"+E("BS[0].email")+"'>Email for more information</a> </p>"},disabilitybenefits:{title:"Disability and Carers benefits",info:"Benefits included are: Personal Independence Payment, Carer's Allowance, Attendance Allowance and Disability Living Allowance<p class = 'pibutton'>Access data at:  <a href='"+E("BS[0].dataset_url")+"'>"+E("BS[0].title")+"</a></p><p class = 'pibutton'>Last updated: "+E("BS[0].last_updated")+"</p> <p class = 'pibutton'><a href='mailto:"+E("BS[0].email")+"'>Email for more information</a> </p>"},enrollments:{title:"People in education",info:"<p class = 'pibutton'>Access data at: <a href='"+E("Primary[0].dataset_url")+"'>"+E("Primary[0].title")+"</a>, <a href='"+E("PostPrimary[0].dataset_url")+"'>"+E("PostPrimary[0].title")+"</a>,  <a href='"+E("FE[0].dataset_url")+"'>"+E("FE[0].title")+"</a> and <a href='"+E("HE[0].dataset_url")+"'>"+E("HE[0].title")+"</a></p>"},fsme:{title:"Pupils entitled to Free School Meals",info:"<p class = 'pibutton'>Access data at: <a href='"+E("Primary[0].dataset_url")+"'>"+E("Primary[0].title")+"</a> and <a href='"+E("PostPrimary[0].dataset_url")+"'>"+E("PostPrimary[0].title")+"</a></p><p class = 'pibutton'>Last updated: "+E("Primary[0].last_updated")+"</p> <p class = 'pibutton'><a href='mailto:"+E("Primary[0].email")+"'>Email for more information</a> </p>"},teachers:{title:"School class size",info:"<p class = 'pibutton'>Access data at: <a href='"+E("ClassSize[0].dataset_url")+"'>"+E("ClassSize[0].title")+"</a></p><p class = 'pibutton'>Last updated: "+E("ClassSize[0].last_updated")+"</p> <p class = 'pibutton'><a href='mailto:"+E("ClassSize[0].email")+"'>Email for more information</a> </p>"},qualifications:{title:"Highest level of qualifications in the population",info:"<p>From Census 2021 data - <a href='https://explore.nisra.gov.uk/area-explorer-2021/'><strong>Census Area Explorer</strong></a></p>Needs tidied up with proper CSS.   The highest level of qualification categories are as follows:No qualifications;Level 1: 1 to 4 GCSEs, O levels, CSEs (any grades); 1 AS Level; NVQ level 1; or equivalent;Level 2: 5 or more GCSEs (A*-C or 9-4), O levels (passes) CSEs (grade 1); 1 A level, 2-3 AS Levels; NVQ level 2, BTEC General, City and Guilds Craft; or equivalent;Apprenticeship; Level 3: 2 or more A Levels, 4 or more AS Levels; NVQ Level 3, BTEC National, OND, ONC, City and Guilds Advanced Craft; or equivalent; Level 4 and above: Degree (BA, BSc), foundation degree, NVQ Level 4 and above, HND, HNC, professional qualifications (teaching or nursing, for example), or equivalent; and Other: Other qualifications, equivalent unknown.Highest level of qualification is derived from the question asking people aged 16 years and over to indicate all qualifications held. For qualifications gained outside Northern Ireland, respondents were directed to select the nearest equivalent."},attainment:{title:"GCSEs for school leavers",info:" <p class = 'pibutton'>Access data at: <a href='"+E("Attainment[0].dataset_url")+"'>"+E("Attainment[0].title")+"</a></p><p class = 'pibutton'>Last updated: "+E("Attainment[0].last_updated")+"</p><p class = 'pibutton'><a href='mailto:"+E("Attainment[0].email")+"'>Email for more information</a> </p>"},empty:{title:"",info:""},destination:{title:"Next steps for school leavers",info:" <p class = 'pibutton'>Access data at: <a href='"+E("Destination[0].dataset_url")+"'>"+E("Destination[0].title")+"</a></p><p class = 'pibutton'>Last updated: "+E("Destination[0].last_updated")+"</p> <p class = 'pibutton'><a href='mailto:"+E("Destination[0].email")+"'>Email for more information</a> </p>"},popchange:{title:"Population change",info:" <p class = 'pibutton'>Access data at: <a href='"+E("PopChange[0].dataset_url")+"'>"+E("PopChange[0].title")+"</a></p><p class = 'pibutton'>Last updated: "+E("PopChange[0].last_updated")+"</p> <p class = 'pibutton'><a href='mailto:"+E("PopChange[0].email")+"'>Email for more information</a> </p>"},broadage:{title:"Age",info:" <p class = 'pibutton'>Access data at: <a href='"+E("BroadAge[0].dataset_url")+"'>"+E("BroadAge[0].title")+"</a></p><p class = 'pibutton'>Last updated: "+E("BroadAge[0].last_updated")+"</p> <p class = 'pibutton'><a href='mailto:"+E("BroadAge[0].email")+"'>Email for more information</a> </p>"},hhsize:{title:"Household size",info:"<p>From Census 2021 data - <a href='https://explore.nisra.gov.uk/area-explorer-2021/'><strong>Census Area Explorer</strong></a></p>The number of usual residents in the household.      <a href='https://www.nisra.gov.uk/publications/census-2021-statistical-bulletins'><strong>Statistical bulletins</strong></a>"},religion:{title:"Religion, Religion brought up in",info:"<p>From Census 2021 data - <a href='https://explore.nisra.gov.uk/area-explorer-2021/'><strong>Census Area Explorer</strong></a></p>The religious group the person belongs to or for people with no current religion their religious group of upbringing.People with no current religion and no religion of upbringing are labelled 'None'.<a href='https://www.nisra.gov.uk/publications/census-2021-statistical-bulletins'><strong>Statistical bulletins</strong></a>"},language:{title:"Main language",info:"<p>From Census 2021 data - <a href='https://explore.nisra.gov.uk/area-explorer-2021/'><strong>Census Area Explorer</strong></a></p>Person's main language as declared in the Census.Statistics for all language questions are restrictedto persons aged 3 and over. <ahref='https://www.nisra.gov.uk/publications/census-2021-statistical-bulletins'><strong>Statistical bulletins</strong></a>"},households:{title:"Households - box with numbers",info:"<p>From Census 2021 data - <a href='https://explore.nisra.gov.uk/area-explorer-2021/'><strong>Census Area Explorer</strong></a></p>A household is either one person living alone or a group of people living at the same address who share cooking facilities and share a living room, sitting room or dining area. <a href='https://www.nisra.gov.uk/publications/census-2021-statistical-bulletins'><strong>Statistical bulletins</strong></a>"}};function F(M){Rs[M?"unshift":"push"](()=>{a=M,d(2,a)})}function C(M){Rs[M?"unshift":"push"](()=>{v=M,d(1,v)})}return l.$$set=M=>{"id"in M&&d(0,p=M.id),"place"in M&&d(5,y=M.place)},[p,v,a,T,L,y,F,C]}class c1 extends on{constructor(c){super(),sn(this,c,u1,l1,ln,{id:0,place:5})}}function h1(l){let c;return{c(){c=Ue("h3"),this.h()},l(d){c=qe(d,"H3",{style:!0});var p=Oe(c);p.forEach(ne),this.h()},h(){Ye(c,"margin","0 0 10px 0")},m(d,p){Re(d,c,p),c.innerHTML=l[9]},p(d,p){p&512&&(c.innerHTML=d[9])},i:ei,o:ei,d(d){d&&ne(c)}}}function p1(l){let c,d;return c=new c1({props:{id:l[0],place:l[2]}}),{c(){er(c.$$.fragment)},l(p){tr(c.$$.fragment,p)},m(p,y){rr(c,p,y),d=!0},p(p,y){const v={};y&1&&(v.id=p[0]),y&4&&(v.place=p[2]),c.$set(v)},i(p){d||(tt(c.$$.fragment,p),d=!0)},o(p){ct(c.$$.fragment,p),d=!1},d(p){ir(c,p)}}}function Om(l){let c,d;return{c(){c=Ue("div"),d=zt(l[12]),this.h()},l(p){c=qe(p,"DIV",{class:!0});var y=Oe(c);d=Pt(y,l[12]),y.forEach(ne),this.h()},h(){ie(c,"class","text-small")},m(p,y){Re(p,c,y),we(c,d)},p(p,y){y&4096&&Er(d,p[12])},d(p){p&&ne(c)}}}function f1(l){let c,d;return{c(){c=new Bl(!1),d=or(),this.h()},l(p){c=Ol(p,!1),d=or(),this.h()},h(){c.a=d},m(p,y){c.m(l[3],p,y),Re(p,d,y)},p(p,y){y&8&&c.p(p[3])},i:ei,o:ei,d(p){p&&ne(d),p&&c.d()}}}function d1(l){let c,d=l[3][l[2].type]+"",p;return{c(){c=new Bl(!1),p=or(),this.h()},l(y){c=Ol(y,!1),p=or(),this.h()},h(){c.a=p},m(y,v){c.m(d,y,v),Re(y,p,v)},p(y,v){v&12&&d!==(d=y[3][y[2].type]+"")&&c.p(d)},i:ei,o:ei,d(y){y&&ne(p),y&&c.d()}}}function m1(l){let c,d,p,y,v,a,E;const T=[S1,w1,x1,b1],L=[];function F(C,M){return M&1040&&(c=null),M&1040&&(d=null),M&1040&&(p=null),c==null&&(c=!!(C[4].hasOwnProperty("none")&C[10]==null)),c?0:(d==null&&(d=!!(C[4].hasOwnProperty("prev")&C[10]=="prev")),d?1:(p==null&&(p=!!(C[4].hasOwnProperty("ni")&C[10]=="ni")),p?2:3))}return y=F(l,-1),v=L[y]=T[y](l),{c(){v.c(),a=or()},l(C){v.l(C),a=or()},m(C,M){L[y].m(C,M),Re(C,a,M),E=!0},p(C,M){let X=y;y=F(C,M),y===X?L[y].p(C,M):(kn(),ct(L[X],1,1,()=>{L[X]=null}),En(),v=L[y],v?v.p(C,M):(v=L[y]=T[y](C),v.c()),tt(v,1),v.m(a.parentNode,a))},i(C){E||(tt(v),E=!0)},o(C){ct(v),E=!1},d(C){L[y].d(C),C&&ne(a)}}}function y1(l){let c,d,p,y,v,a,E;const T=[I1,T1,E1,k1],L=[];function F(C,M){return M&1040&&(c=null),M&1040&&(d=null),M&1040&&(p=null),c==null&&(c=!!(C[4].hasOwnProperty("none")&C[10]==null)),c?0:(d==null&&(d=!!(C[4].hasOwnProperty("prev")&C[10]=="prev")),d?1:(p==null&&(p=!!(C[4].hasOwnProperty("ni")&C[10]=="ni")),p?2:3))}return y=F(l,-1),v=L[y]=T[y](l),{c(){v.c(),a=or()},l(C){v.l(C),a=or()},m(C,M){L[y].m(C,M),Re(C,a,M),E=!0},p(C,M){let X=y;y=F(C,M),y===X?L[y].p(C,M):(kn(),ct(L[X],1,1,()=>{L[X]=null}),En(),v=L[y],v?v.p(C,M):(v=L[y]=T[y](C),v.c()),tt(v,1),v.m(a.parentNode,a))},i(C){E||(tt(v),E=!0)},o(C){ct(v),E=!1},d(C){L[y].d(C),C&&ne(a)}}}function g1(l){let c,d,p,y,v,a,E;const T=[C1,P1,z1,A1],L=[];function F(C,M){return M&1040&&(c=null),M&1040&&(d=null),M&1040&&(p=null),c==null&&(c=!!(C[4].hasOwnProperty("none")&C[10]==null)),c?0:(d==null&&(d=!!(C[4].hasOwnProperty("prev")&C[10]=="prev")),d?1:(p==null&&(p=!!(C[4].hasOwnProperty("ni")&C[10]=="ni")),p?2:3))}return y=F(l,-1),v=L[y]=T[y](l),{c(){v.c(),a=or()},l(C){v.l(C),a=or()},m(C,M){L[y].m(C,M),Re(C,a,M),E=!0},p(C,M){let X=y;y=F(C,M),y===X?L[y].p(C,M):(kn(),ct(L[X],1,1,()=>{L[X]=null}),En(),v=L[y],v?v.p(C,M):(v=L[y]=T[y](C),v.c()),tt(v,1),v.m(a.parentNode,a))},i(C){E||(tt(v),E=!0)},o(C){ct(v),E=!1},d(C){L[y].d(C),C&&ne(a)}}}function _1(l){let c,d,p,y,v,a,E;const T=[R1,L1,D1,M1],L=[];function F(C,M){return M&1040&&(c=null),M&1040&&(d=null),M&1040&&(p=null),c==null&&(c=!!(C[4].hasOwnProperty("none")&C[10]==null)),c?0:(d==null&&(d=!!(C[4].hasOwnProperty("prev")&C[10]=="prev")),d?1:(p==null&&(p=!!(C[4].hasOwnProperty("ni")&C[10]=="ni")),p?2:3))}return y=F(l,-1),v=L[y]=T[y](l),{c(){v.c(),a=or()},l(C){v.l(C),a=or()},m(C,M){L[y].m(C,M),Re(C,a,M),E=!0},p(C,M){let X=y;y=F(C,M),y===X?L[y].p(C,M):(kn(),ct(L[X],1,1,()=>{L[X]=null}),En(),v=L[y],v?v.p(C,M):(v=L[y]=T[y](C),v.c()),tt(v,1),v.m(a.parentNode,a))},i(C){E||(tt(v),E=!0)},o(C){ct(v),E=!1},d(C){L[y].d(C),C&&ne(a)}}}function v1(l){let c,d,p,y,v,a,E;const T=[N1,F1,O1,B1],L=[];function F(C,M){return M&1040&&(c=null),M&1040&&(d=null),M&1040&&(p=null),c==null&&(c=!!(C[4].hasOwnProperty("none")&C[10]==null)),c?0:(d==null&&(d=!!(C[4].hasOwnProperty("prev")&C[10]=="prev")),d?1:(p==null&&(p=!!(C[4].hasOwnProperty("ni")&C[10]=="ni")),p?2:3))}return y=F(l,-1),v=L[y]=T[y](l),{c(){v.c(),a=or()},l(C){v.l(C),a=or()},m(C,M){L[y].m(C,M),Re(C,a,M),E=!0},p(C,M){let X=y;y=F(C,M),y===X?L[y].p(C,M):(kn(),ct(L[X],1,1,()=>{L[X]=null}),En(),v=L[y],v?v.p(C,M):(v=L[y]=T[y](C),v.c()),tt(v,1),v.m(a.parentNode,a))},i(C){E||(tt(v),E=!0)},o(C){ct(v),E=!1},d(C){L[y].d(C),C&&ne(a)}}}function b1(l){let c,d;return c=new Lh({props:{data:l[4],zKey:l[5]}}),{c(){er(c.$$.fragment)},l(p){tr(c.$$.fragment,p)},m(p,y){rr(c,p,y),d=!0},p(p,y){const v={};y&16&&(v.data=p[4]),y&32&&(v.zKey=p[5]),c.$set(v)},i(p){d||(tt(c.$$.fragment,p),d=!0)},o(p){ct(c.$$.fragment,p),d=!1},d(p){ir(c,p)}}}function x1(l){let c,d;return c=new Lh({props:{data:l[4].ni,zKey:l[5]}}),{c(){er(c.$$.fragment)},l(p){tr(c.$$.fragment,p)},m(p,y){rr(c,p,y),d=!0},p(p,y){const v={};y&16&&(v.data=p[4].ni),y&32&&(v.zKey=p[5]),c.$set(v)},i(p){d||(tt(c.$$.fragment,p),d=!0)},o(p){ct(c.$$.fragment,p),d=!1},d(p){ir(c,p)}}}function w1(l){let c,d;return c=new Lh({props:{data:l[4].prev,zKey:l[5]}}),{c(){er(c.$$.fragment)},l(p){tr(c.$$.fragment,p)},m(p,y){rr(c,p,y),d=!0},p(p,y){const v={};y&16&&(v.data=p[4].prev),y&32&&(v.zKey=p[5]),c.$set(v)},i(p){d||(tt(c.$$.fragment,p),d=!0)},o(p){ct(c.$$.fragment,p),d=!1},d(p){ir(c,p)}}}function S1(l){let c,d;return c=new Lh({props:{data:l[4].none,zKey:l[5]}}),{c(){er(c.$$.fragment)},l(p){tr(c.$$.fragment,p)},m(p,y){rr(c,p,y),d=!0},p(p,y){const v={};y&16&&(v.data=p[4].none),y&32&&(v.zKey=p[5]),c.$set(v)},i(p){d||(tt(c.$$.fragment,p),d=!0)},o(p){ct(c.$$.fragment,p),d=!1},d(p){ir(c,p)}}}function k1(l){let c,d;return c=new Oh({props:{data:l[4],zKey:l[5],label:l[6]}}),{c(){er(c.$$.fragment)},l(p){tr(c.$$.fragment,p)},m(p,y){rr(c,p,y),d=!0},p(p,y){const v={};y&16&&(v.data=p[4]),y&32&&(v.zKey=p[5]),y&64&&(v.label=p[6]),c.$set(v)},i(p){d||(tt(c.$$.fragment,p),d=!0)},o(p){ct(c.$$.fragment,p),d=!1},d(p){ir(c,p)}}}function E1(l){let c,d;return c=new Oh({props:{data:l[4].ni,zKey:l[5],label:l[6]}}),{c(){er(c.$$.fragment)},l(p){tr(c.$$.fragment,p)},m(p,y){rr(c,p,y),d=!0},p(p,y){const v={};y&16&&(v.data=p[4].ni),y&32&&(v.zKey=p[5]),y&64&&(v.label=p[6]),c.$set(v)},i(p){d||(tt(c.$$.fragment,p),d=!0)},o(p){ct(c.$$.fragment,p),d=!1},d(p){ir(c,p)}}}function T1(l){let c,d;return c=new Oh({props:{data:l[4].prev,zKey:l[5],label:l[6]}}),{c(){er(c.$$.fragment)},l(p){tr(c.$$.fragment,p)},m(p,y){rr(c,p,y),d=!0},p(p,y){const v={};y&16&&(v.data=p[4].prev),y&32&&(v.zKey=p[5]),y&64&&(v.label=p[6]),c.$set(v)},i(p){d||(tt(c.$$.fragment,p),d=!0)},o(p){ct(c.$$.fragment,p),d=!1},d(p){ir(c,p)}}}function I1(l){let c,d;return c=new Oh({props:{data:l[4].none,zKey:l[5],label:l[6]}}),{c(){er(c.$$.fragment)},l(p){tr(c.$$.fragment,p)},m(p,y){rr(c,p,y),d=!0},p(p,y){const v={};y&16&&(v.data=p[4].none),y&32&&(v.zKey=p[5]),y&64&&(v.label=p[6]),c.$set(v)},i(p){d||(tt(c.$$.fragment,p),d=!0)},o(p){ct(c.$$.fragment,p),d=!1},d(p){ir(c,p)}}}function A1(l){let c,d;return c=new Fh({props:{data:l[4],zKey:l[5],label:l[6]}}),{c(){er(c.$$.fragment)},l(p){tr(c.$$.fragment,p)},m(p,y){rr(c,p,y),d=!0},p(p,y){const v={};y&16&&(v.data=p[4]),y&32&&(v.zKey=p[5]),y&64&&(v.label=p[6]),c.$set(v)},i(p){d||(tt(c.$$.fragment,p),d=!0)},o(p){ct(c.$$.fragment,p),d=!1},d(p){ir(c,p)}}}function z1(l){let c,d;return c=new Fh({props:{data:l[4].ni,zKey:l[5],label:l[6]}}),{c(){er(c.$$.fragment)},l(p){tr(c.$$.fragment,p)},m(p,y){rr(c,p,y),d=!0},p(p,y){const v={};y&16&&(v.data=p[4].ni),y&32&&(v.zKey=p[5]),y&64&&(v.label=p[6]),c.$set(v)},i(p){d||(tt(c.$$.fragment,p),d=!0)},o(p){ct(c.$$.fragment,p),d=!1},d(p){ir(c,p)}}}function P1(l){let c,d;return c=new Fh({props:{data:l[4].prev,zKey:l[5],label:l[6]}}),{c(){er(c.$$.fragment)},l(p){tr(c.$$.fragment,p)},m(p,y){rr(c,p,y),d=!0},p(p,y){const v={};y&16&&(v.data=p[4].prev),y&32&&(v.zKey=p[5]),y&64&&(v.label=p[6]),c.$set(v)},i(p){d||(tt(c.$$.fragment,p),d=!0)},o(p){ct(c.$$.fragment,p),d=!1},d(p){ir(c,p)}}}function C1(l){let c,d;return c=new Fh({props:{data:l[4].none,zKey:l[5],label:l[6]}}),{c(){er(c.$$.fragment)},l(p){tr(c.$$.fragment,p)},m(p,y){rr(c,p,y),d=!0},p(p,y){const v={};y&16&&(v.data=p[4].none),y&32&&(v.zKey=p[5]),y&64&&(v.label=p[6]),c.$set(v)},i(p){d||(tt(c.$$.fragment,p),d=!0)},o(p){ct(c.$$.fragment,p),d=!1},d(p){ir(c,p)}}}function M1(l){let c,d;return c=new Bh({props:{data:l[4],zKey:"group"}}),{c(){er(c.$$.fragment)},l(p){tr(c.$$.fragment,p)},m(p,y){rr(c,p,y),d=!0},p(p,y){const v={};y&16&&(v.data=p[4]),c.$set(v)},i(p){d||(tt(c.$$.fragment,p),d=!0)},o(p){ct(c.$$.fragment,p),d=!1},d(p){ir(c,p)}}}function D1(l){let c,d;return c=new Bh({props:{data:l[4].ni,zKey:"group"}}),{c(){er(c.$$.fragment)},l(p){tr(c.$$.fragment,p)},m(p,y){rr(c,p,y),d=!0},p(p,y){const v={};y&16&&(v.data=p[4].ni),c.$set(v)},i(p){d||(tt(c.$$.fragment,p),d=!0)},o(p){ct(c.$$.fragment,p),d=!1},d(p){ir(c,p)}}}function L1(l){let c,d;return c=new Bh({props:{data:l[4].prev,zKey:"group"}}),{c(){er(c.$$.fragment)},l(p){tr(c.$$.fragment,p)},m(p,y){rr(c,p,y),d=!0},p(p,y){const v={};y&16&&(v.data=p[4].prev),c.$set(v)},i(p){d||(tt(c.$$.fragment,p),d=!0)},o(p){ct(c.$$.fragment,p),d=!1},d(p){ir(c,p)}}}function R1(l){let c,d;return c=new Bh({props:{data:l[4].none,zKey:"group"}}),{c(){er(c.$$.fragment)},l(p){tr(c.$$.fragment,p)},m(p,y){rr(c,p,y),d=!0},p(p,y){const v={};y&16&&(v.data=p[4].none),c.$set(v)},i(p){d||(tt(c.$$.fragment,p),d=!0)},o(p){ct(c.$$.fragment,p),d=!1},d(p){ir(c,p)}}}function B1(l){let c,d;return c=new Rh({props:{data:l[4],zKey:l[5],label:l[6],topic_prev_available:l[7]}}),{c(){er(c.$$.fragment)},l(p){tr(c.$$.fragment,p)},m(p,y){rr(c,p,y),d=!0},p(p,y){const v={};y&16&&(v.data=p[4]),y&32&&(v.zKey=p[5]),y&64&&(v.label=p[6]),y&128&&(v.topic_prev_available=p[7]),c.$set(v)},i(p){d||(tt(c.$$.fragment,p),d=!0)},o(p){ct(c.$$.fragment,p),d=!1},d(p){ir(c,p)}}}function O1(l){let c,d;return c=new Rh({props:{data:l[4].ni,zKey:l[5],label:l[6],topic_prev_available:l[7]}}),{c(){er(c.$$.fragment)},l(p){tr(c.$$.fragment,p)},m(p,y){rr(c,p,y),d=!0},p(p,y){const v={};y&16&&(v.data=p[4].ni),y&32&&(v.zKey=p[5]),y&64&&(v.label=p[6]),y&128&&(v.topic_prev_available=p[7]),c.$set(v)},i(p){d||(tt(c.$$.fragment,p),d=!0)},o(p){ct(c.$$.fragment,p),d=!1},d(p){ir(c,p)}}}function F1(l){let c,d;return c=new Rh({props:{data:l[4].prev,zKey:l[5],label:l[6],topic_prev_available:l[7]}}),{c(){er(c.$$.fragment)},l(p){tr(c.$$.fragment,p)},m(p,y){rr(c,p,y),d=!0},p(p,y){const v={};y&16&&(v.data=p[4].prev),y&32&&(v.zKey=p[5]),y&64&&(v.label=p[6]),y&128&&(v.topic_prev_available=p[7]),c.$set(v)},i(p){d||(tt(c.$$.fragment,p),d=!0)},o(p){ct(c.$$.fragment,p),d=!1},d(p){ir(c,p)}}}function N1(l){let c,d;return c=new Rh({props:{data:l[4].none,zKey:l[5],label:l[6],topic_prev_available:l[7]}}),{c(){er(c.$$.fragment)},l(p){tr(c.$$.fragment,p)},m(p,y){rr(c,p,y),d=!0},p(p,y){const v={};y&16&&(v.data=p[4].none),y&32&&(v.zKey=p[5]),y&64&&(v.label=p[6]),y&128&&(v.topic_prev_available=p[7]),c.$set(v)},i(p){d||(tt(c.$$.fragment,p),d=!0)},o(p){ct(c.$$.fragment,p),d=!1},d(p){ir(c,p)}}}function Fm(l){let c,d,p,y=l[11][l[2].type]+"";return{c(){c=Ue("br"),d=bt(),p=Ue("span"),this.h()},l(v){c=qe(v,"BR",{}),d=xt(v),p=qe(v,"SPAN",{class:!0});var a=Oe(p);a.forEach(ne),this.h()},h(){ie(p,"class","text-small")},m(v,a){Re(v,c,a),Re(v,d,a),Re(v,p,a),p.innerHTML=y},p(v,a){a&2052&&y!==(y=v[11][v[2].type]+"")&&(p.innerHTML=y)},d(v){v&&ne(c),v&&ne(d),v&&ne(p)}}}function V1(l){let c,d,p,y,v,a,E,T,L,F,C,M,X,ae,se,he;const me=[p1,h1],_e=[];function it(Ge,Ke){return Ge[8]==!0|Ge[8]==null?0:1}d=it(l),p=_e[d]=me[d](l);let Fe=l[12]!=null&&Om(l);const Pe=[v1,_1,g1,y1,m1,d1,f1],Ze=[];function Ct(Ge,Ke){return Ke&12&&(a=null),Ke&12&&(E=null),Ke&12&&(T=null),Ke&12&&(L=null),Ke&12&&(F=null),Ke&12&&(C=null),a==null&&(a=!!(Ge[3]=="StackedBarChart"|Ge[3].hasOwnProperty(Ge[2].type)&Ge[3][Ge[2].type]=="StackedBarChart")),a?0:(E==null&&(E=!!(Ge[3]=="GroupChart"|Ge[3].hasOwnProperty(Ge[2].type)&Ge[3][Ge[2].type]=="GroupChart")),E?1:(T==null&&(T=!!(Ge[3]=="ProfileChart"|Ge[3].hasOwnProperty(Ge[2].type)&Ge[3][Ge[2].type]=="ProfileChart")),T?2:(L==null&&(L=!!(Ge[3]=="BarChart"|Ge[3].hasOwnProperty(Ge[2].type)&Ge[3][Ge[2].type]=="BarChart")),L?3:(F==null&&(F=!!(Ge[3]=="ColChart"|Ge[3].hasOwnProperty(Ge[2].type)&Ge[3][Ge[2].type]=="ColChart")),F?4:(C==null&&(C=!!Ge[3].hasOwnProperty(Ge[2].type)),C?5:6)))))}M=Ct(l,-1),X=Ze[M]=Pe[M](l);let kt=l[11]!=null&l[10]!=null&&Fm(l);return{c(){c=Ue("div"),p.c(),y=bt(),Fe&&Fe.c(),v=bt(),X.c(),ae=bt(),kt&&kt.c(),this.h()},l(Ge){c=qe(Ge,"DIV",{class:!0,style:!0});var Ke=Oe(c);p.l(Ke),y=xt(Ke),Fe&&Fe.l(Ke),v=xt(Ke),X.l(Ke),ae=xt(Ke),kt&&kt.l(Ke),Ke.forEach(ne),this.h()},h(){ie(c,"class",se=Nm(l[0])),ie(c,"style",l[1])},m(Ge,Ke){Re(Ge,c,Ke),_e[d].m(c,null),we(c,y),Fe&&Fe.m(c,null),we(c,v),Ze[M].m(c,null),we(c,ae),kt&&kt.m(c,null),he=!0},p(Ge,[Ke]){let gt=d;d=it(Ge),d===gt?_e[d].p(Ge,Ke):(kn(),ct(_e[gt],1,1,()=>{_e[gt]=null}),En(),p=_e[d],p?p.p(Ge,Ke):(p=_e[d]=me[d](Ge),p.c()),tt(p,1),p.m(c,y)),Ge[12]!=null?Fe?Fe.p(Ge,Ke):(Fe=Om(Ge),Fe.c(),Fe.m(c,v)):Fe&&(Fe.d(1),Fe=null);let ur=M;M=Ct(Ge,Ke),M===ur?Ze[M].p(Ge,Ke):(kn(),ct(Ze[ur],1,1,()=>{Ze[ur]=null}),En(),X=Ze[M],X?X.p(Ge,Ke):(X=Ze[M]=Pe[M](Ge),X.c()),tt(X,1),X.m(c,ae)),Ge[11]!=null&Ge[10]!=null?kt?kt.p(Ge,Ke):(kt=Fm(Ge),kt.c(),kt.m(c,null)):kt&&(kt.d(1),kt=null),(!he||Ke&1&&se!==(se=Nm(Ge[0])))&&ie(c,"class",se),(!he||Ke&2)&&ie(c,"style",Ge[1])},i(Ge){he||(tt(p),tt(X),he=!0)},o(Ge){ct(p),ct(X),he=!1},d(Ge){Ge&&ne(c),_e[d].d(),Fe&&Fe.d(),Ze[M].d(),kt&&kt.d()}}}function Nm(l){return l=="empty"?"":"div-grey-box"}function U1(l,c,d){let{id:p}=c,{style:y=""}=c,{place:v}=c,{content:a}=c,{chart_data:E=null}=c,{zKey:T="ni"}=c,{label:L=null}=c,{topic_prev_available:F=!0}=c,{i_button:C=!0}=c,{heading:M=null}=c,{chart_compare_type:X}=c,{compare_content:ae=null}=c,{year:se=null}=c;return l.$$set=he=>{"id"in he&&d(0,p=he.id),"style"in he&&d(1,y=he.style),"place"in he&&d(2,v=he.place),"content"in he&&d(3,a=he.content),"chart_data"in he&&d(4,E=he.chart_data),"zKey"in he&&d(5,T=he.zKey),"label"in he&&d(6,L=he.label),"topic_prev_available"in he&&d(7,F=he.topic_prev_available),"i_button"in he&&d(8,C=he.i_button),"heading"in he&&d(9,M=he.heading),"chart_compare_type"in he&&d(10,X=he.chart_compare_type),"compare_content"in he&&d(11,ae=he.compare_content),"year"in he&&d(12,se=he.year)},[p,y,v,a,E,T,L,F,C,M,X,ae,se]}class Bu extends on{constructor(c){super(),sn(this,c,U1,V1,ln,{id:0,style:1,place:2,content:3,chart_data:4,zKey:5,label:6,topic_prev_available:7,i_button:8,heading:9,chart_compare_type:10,compare_content:11,year:12})}}function Vm(l,c,d){const p=l.slice();return p[13]=c[d],p[15]=d,p}function Um(l){let c=l[6][l[10][l[15]]].show.includes(l[3].type),d,p,y=c&&qm(l);return{c(){y&&y.c(),d=or()},l(v){y&&y.l(v),d=or()},m(v,a){y&&y.m(v,a),Re(v,d,a),p=!0},p(v,a){a&72&&(c=v[6][v[10][v[15]]].show.includes(v[3].type)),c?y?(y.p(v,a),a&72&&tt(y,1)):(y=qm(v),y.c(),tt(y,1),y.m(d.parentNode,d)):y&&(kn(),ct(y,1,1,()=>{y=null}),En())},i(v){p||(tt(y),p=!0)},o(v){ct(y),p=!1},d(v){y&&y.d(v),v&&ne(d)}}}function qm(l){let c,d;return c=new Bu({props:{id:l[6][l[10][l[15]]].id,style:l[6][l[10][l[15]]].style,place:l[3],year:l[6][l[10][l[15]]].year,content:l[6][l[10][l[15]]].content,chart_data:l[6][l[10][l[15]]].chart_data,zKey:l[6][l[10][l[15]]].zKey,label:l[6][l[10][l[15]]].label,topic_prev_available:l[6][l[10][l[15]]].topic_prev_available,chart_compare_type:l[8],i_button:l[6][l[10][l[15]]].i_button}}),{c(){er(c.$$.fragment)},l(p){tr(c.$$.fragment,p)},m(p,y){rr(c,p,y),d=!0},p(p,y){const v={};y&64&&(v.id=p[6][p[10][p[15]]].id),y&64&&(v.style=p[6][p[10][p[15]]].style),y&8&&(v.place=p[3]),y&64&&(v.year=p[6][p[10][p[15]]].year),y&64&&(v.content=p[6][p[10][p[15]]].content),y&64&&(v.chart_data=p[6][p[10][p[15]]].chart_data),y&64&&(v.zKey=p[6][p[10][p[15]]].zKey),y&64&&(v.label=p[6][p[10][p[15]]].label),y&64&&(v.topic_prev_available=p[6][p[10][p[15]]].topic_prev_available),y&256&&(v.chart_compare_type=p[8]),y&64&&(v.i_button=p[6][p[10][p[15]]].i_button),c.$set(v)},i(p){d||(tt(c.$$.fragment,p),d=!0)},o(p){ct(c.$$.fragment,p),d=!1},d(p){ir(c,p)}}}function jm(l){let c,d;return c=new Bu({props:{id:l[6][l[10][l[15]]].id,style:l[6][l[10][l[15]]].style,place:l[3],year:l[6][l[10][l[15]]].year,content:l[6][l[10][l[15]]].content,chart_data:l[6][l[10][l[15]]].chart_data,zKey:l[6][l[10][l[15]]].zKey,label:l[6][l[10][l[15]]].label,topic_prev_available:l[6][l[10][l[15]]].topic_prev_available,chart_compare_type:l[8],i_button:l[6][l[10][l[15]]].i_button}}),{c(){er(c.$$.fragment)},l(p){tr(c.$$.fragment,p)},m(p,y){rr(c,p,y),d=!0},p(p,y){const v={};y&64&&(v.id=p[6][p[10][p[15]]].id),y&64&&(v.style=p[6][p[10][p[15]]].style),y&8&&(v.place=p[3]),y&64&&(v.year=p[6][p[10][p[15]]].year),y&64&&(v.content=p[6][p[10][p[15]]].content),y&64&&(v.chart_data=p[6][p[10][p[15]]].chart_data),y&64&&(v.zKey=p[6][p[10][p[15]]].zKey),y&64&&(v.label=p[6][p[10][p[15]]].label),y&64&&(v.topic_prev_available=p[6][p[10][p[15]]].topic_prev_available),y&256&&(v.chart_compare_type=p[8]),y&64&&(v.i_button=p[6][p[10][p[15]]].i_button),c.$set(v)},i(p){d||(tt(c.$$.fragment,p),d=!0)},o(p){ct(c.$$.fragment,p),d=!1},d(p){ir(c,p)}}}function Gm(l){let c=l[6][l[10][l[15]]].hasOwnProperty("show"),d,p=!l[6][l[10][l[15]]].hasOwnProperty("show"),y,v,a=c&&Um(l),E=p&&jm(l);return{c(){a&&a.c(),d=bt(),E&&E.c(),y=or()},l(T){a&&a.l(T),d=xt(T),E&&E.l(T),y=or()},m(T,L){a&&a.m(T,L),Re(T,d,L),E&&E.m(T,L),Re(T,y,L),v=!0},p(T,L){L&64&&(c=T[6][T[10][T[15]]].hasOwnProperty("show")),c?a?(a.p(T,L),L&64&&tt(a,1)):(a=Um(T),a.c(),tt(a,1),a.m(d.parentNode,d)):a&&(kn(),ct(a,1,1,()=>{a=null}),En()),L&64&&(p=!T[6][T[10][T[15]]].hasOwnProperty("show")),p?E?(E.p(T,L),L&64&&tt(E,1)):(E=jm(T),E.c(),tt(E,1),E.m(y.parentNode,y)):E&&(kn(),ct(E,1,1,()=>{E=null}),En())},i(T){v||(tt(a),tt(E),v=!0)},o(T){ct(a),ct(E),v=!1},d(T){a&&a.d(T),T&&ne(d),E&&E.d(T),T&&ne(y)}}}function Zm(l){let c,d,p,y;return{c(){c=Ue("h3"),d=zt("More Statistics"),p=bt(),y=Ue("div"),this.h()},l(v){c=qe(v,"H3",{});var a=Oe(c);d=Pt(a,"More Statistics"),a.forEach(ne),p=xt(v),y=qe(v,"DIV",{class:!0});var E=Oe(y);E.forEach(ne),this.h()},h(){ie(y,"class","accordion-more svelte-9ol09s")},m(v,a){Re(v,c,a),we(c,d),Re(v,p,a),Re(v,y,a),y.innerHTML=l[7]},p(v,a){a&128&&(y.innerHTML=v[7])},d(v){v&&ne(c),v&&ne(p),v&&ne(y)}}}function q1(l){let c,d,p,y,v,a,E,T,L,F,C,M,X,ae,se=l[3].name+"",he,me,_e=l[3].type.toLocaleUpperCase()+"",it,Fe,Pe,Ze,Ct,kt,Ge,Ke,gt,ur,je,Ft,Be,$e={length:l[10].length},yt=[];for(let St=0;St<$e.length;St+=1)yt[St]=Gm(Vm(l,$e,St));const jt=St=>ct(yt[St],1,1,()=>{yt[St]=null});let Lt=l[7]!=""&&Zm(l);return{c(){c=Ue("div"),d=Ue("h2"),p=Ue("button"),y=Ue("span"),v=Ue("img"),E=bt(),T=zt(l[2]),M=bt(),X=Ue("div"),ae=Ue("div"),he=zt(se),me=bt(),it=zt(_e),Fe=zt(" - "),Pe=new Bl(!1),Ze=bt(),Ct=Ue("span"),kt=zt(l[5]),Ge=bt(),Ke=Ue("div");for(let St=0;St<yt.length;St+=1)yt[St].c();ur=bt(),Lt&&Lt.c(),this.h()},l(St){c=qe(St,"DIV",{class:!0});var Ce=Oe(c);d=qe(Ce,"H2",{class:!0,id:!0});var ot=Oe(d);p=qe(ot,"BUTTON",{class:!0,type:!0,"data-bs-toggle":!0,"data-bs-target":!0,"aria-expanded":!0,"aria-controls":!0});var Dr=Oe(p);y=qe(Dr,"SPAN",{class:!0});var Kr=Oe(y);v=qe(Kr,"IMG",{src:!0,alt:!0,height:!0,class:!0}),E=xt(Kr),T=Pt(Kr,l[2]),Kr.forEach(ne),Dr.forEach(ne),ot.forEach(ne),M=xt(Ce),X=qe(Ce,"DIV",{id:!0,class:!0,"aria-labelledby":!0});var ki=Oe(X);ae=qe(ki,"DIV",{class:!0});var Br=Oe(ae);he=Pt(Br,se),me=xt(Br),it=Pt(Br,_e),Fe=Pt(Br," - "),Pe=Ol(Br,!1),Ze=xt(Br),Ct=qe(Br,"SPAN",{class:!0});var cr=Oe(Ct);kt=Pt(cr,l[5]),cr.forEach(ne),Ge=xt(Br),Ke=qe(Br,"DIV",{class:!0});var Sr=Oe(Ke);for(let Gt=0;Gt<yt.length;Gt+=1)yt[Gt].l(Sr);Sr.forEach(ne),ur=xt(Br),Lt&&Lt.l(Br),Br.forEach(ne),ki.forEach(ne),Ce.forEach(ne),this.h()},h(){Sh(v.src,a=Sn+"/img/"+l[1])||ie(v,"src",a),ie(v,"alt","logo"),ie(v,"height","40"),ie(v,"class","accordion-dept-logo"),ie(y,"class","accordion-button-title svelte-9ol09s"),ie(p,"class","accordion-button collapsed svelte-9ol09s"),ie(p,"type","button"),ie(p,"data-bs-toggle","collapse"),ie(p,"data-bs-target",L="#panelsStayOpen-collapse"+l[0]),ie(p,"aria-expanded","false"),ie(p,"aria-controls",F="panelsStayOpen-collapse"+l[0]),ie(d,"class","accordion-header svelte-9ol09s"),ie(d,"id",C="panelsStayOpen-heading"+l[0]),Pe.a=Ze,ie(Ct,"class","accordion-button-title-sub svelte-9ol09s"),ie(Ke,"class","grid mt svelte-9ol09s"),Gu(()=>l[11].call(Ke)),ie(ae,"class","accordion-body svelte-9ol09s"),ie(X,"id",je="panelsStayOpen-collapse"+l[0]),ie(X,"class","accordion-collapse collapse svelte-9ol09s"),ie(X,"aria-labelledby",Ft="panelsStayOpen-heading"+l[0]),ie(c,"class","accordion-item svelte-9ol09s")},m(St,Ce){Re(St,c,Ce),we(c,d),we(d,p),we(p,y),we(y,v),we(y,E),we(y,T),we(c,M),we(c,X),we(X,ae),we(ae,he),we(ae,me),we(ae,it),we(ae,Fe),Pe.m(l[4],ae),we(ae,Ze),we(ae,Ct),we(Ct,kt),we(ae,Ge),we(ae,Ke);for(let ot=0;ot<yt.length;ot+=1)yt[ot]&&yt[ot].m(Ke,null);gt=Zu(Ke,l[11].bind(Ke)),we(ae,ur),Lt&&Lt.m(ae,null),Be=!0},p(St,[Ce]){if((!Be||Ce&2&&!Sh(v.src,a=Sn+"/img/"+St[1]))&&ie(v,"src",a),(!Be||Ce&4)&&Er(T,St[2]),(!Be||Ce&1&&L!==(L="#panelsStayOpen-collapse"+St[0]))&&ie(p,"data-bs-target",L),(!Be||Ce&1&&F!==(F="panelsStayOpen-collapse"+St[0]))&&ie(p,"aria-controls",F),(!Be||Ce&1&&C!==(C="panelsStayOpen-heading"+St[0]))&&ie(d,"id",C),(!Be||Ce&8)&&se!==(se=St[3].name+"")&&Er(he,se),(!Be||Ce&8)&&_e!==(_e=St[3].type.toLocaleUpperCase()+"")&&Er(it,_e),(!Be||Ce&16)&&Pe.p(St[4]),(!Be||Ce&32)&&Er(kt,St[5]),Ce&1352){$e={length:St[10].length};let ot;for(ot=0;ot<$e.length;ot+=1){const Dr=Vm(St,$e,ot);yt[ot]?(yt[ot].p(Dr,Ce),tt(yt[ot],1)):(yt[ot]=Gm(Dr),yt[ot].c(),tt(yt[ot],1),yt[ot].m(Ke,null))}for(kn(),ot=$e.length;ot<yt.length;ot+=1)jt(ot);En()}St[7]!=""?Lt?Lt.p(St,Ce):(Lt=Zm(St),Lt.c(),Lt.m(ae,null)):Lt&&(Lt.d(1),Lt=null),(!Be||Ce&1&&je!==(je="panelsStayOpen-collapse"+St[0]))&&ie(X,"id",je),(!Be||Ce&1&&Ft!==(Ft="panelsStayOpen-heading"+St[0]))&&ie(X,"aria-labelledby",Ft)},i(St){if(!Be){for(let Ce=0;Ce<$e.length;Ce+=1)tt(yt[Ce]);Be=!0}},o(St){yt=yt.filter(Boolean);for(let Ce=0;Ce<yt.length;Ce+=1)ct(yt[Ce]);Be=!1},d(St){St&&ne(c),an(yt,St),gt(),Lt&&Lt.d()}}}function j1(l,c,d){let{id:p}=c,{img:y}=c,{heading:v}=c,{place:a}=c,{sub_heading:E}=c,{description:T}=c,{boxes:L}=c,{more:F}=c,{chart_compare_type:C}=c,M=Object.keys(L),X;function ae(){X=this.clientWidth,d(9,X)}return l.$$set=se=>{"id"in se&&d(0,p=se.id),"img"in se&&d(1,y=se.img),"heading"in se&&d(2,v=se.heading),"place"in se&&d(3,a=se.place),"sub_heading"in se&&d(4,E=se.sub_heading),"description"in se&&d(5,T=se.description),"boxes"in se&&d(6,L=se.boxes),"more"in se&&d(7,F=se.more),"chart_compare_type"in se&&d(8,C=se.chart_compare_type)},[p,y,v,a,E,T,L,F,C,X,M,ae]}class Ml extends on{constructor(c){super(),sn(this,c,j1,q1,ln,{id:0,img:1,heading:2,place:3,sub_heading:4,description:5,boxes:6,more:7,chart_compare_type:8})}}function Km(l){let c,d,p,y,v,a,E,T,L,F=l[2].substr(0,2).toUpperCase()=="BT"&l[9](l[2]),C=F&&Hm(l);return{c(){c=Ue("div"),d=Ue("div"),p=Ue("img"),v=zt("You searched for "),a=Ue("strong"),E=zt(l[2]),T=zt("."),L=bt(),C&&C.c(),this.h()},l(M){c=qe(M,"DIV",{id:!0,class:!0});var X=Oe(c);d=qe(X,"DIV",{});var ae=Oe(d);p=qe(ae,"IMG",{src:!0,alt:!0,class:!0}),v=Pt(ae,"You searched for "),a=qe(ae,"STRONG",{});var se=Oe(a);E=Pt(se,l[2]),se.forEach(ne),T=Pt(ae,"."),ae.forEach(ne),L=xt(X),C&&C.l(X),X.forEach(ne),this.h()},h(){Sh(p.src,y="/img/search.svg")||ie(p,"src",y),ie(p,"alt","search-symbol"),ie(p,"class","svelte-19iexfz"),ie(c,"id","search-result"),ie(c,"class","svelte-19iexfz")},m(M,X){Re(M,c,X),we(c,d),we(d,p),we(d,v),we(d,a),we(a,E),we(d,T),we(c,L),C&&C.m(c,null)},p(M,X){X&4&&Er(E,M[2]),X&4&&(F=M[2].substr(0,2).toUpperCase()=="BT"&M[9](M[2])),F?C?C.p(M,X):(C=Hm(M),C.c(),C.m(c,null)):C&&(C.d(1),C=null)},d(M){M&&ne(c),C&&C.d()}}}function Hm(l){let c,d,p,y=l[0].name+"",v,a,E,T,L,F,C,M,X,ae,se,he,me,_e,it;return{c(){c=Ue("div"),d=zt("This postcode is located within the "),p=Ue("strong"),v=zt(y),a=zt(" District Electoral Area."),E=bt(),T=Ue("div"),L=zt("You can view more localised information for this postcode at Super Data Zone level by selecting "),F=Ue("strong"),C=Ue("a"),M=zt(l[3]),ae=zt(" or at Data Zone level by selecting "),se=Ue("strong"),he=Ue("a"),me=zt(l[5]),it=zt(". Note that many of the statistics produced are not broken down to these smaller geography levels."),this.h()},l(Fe){c=qe(Fe,"DIV",{style:!0});var Pe=Oe(c);d=Pt(Pe,"This postcode is located within the "),p=qe(Pe,"STRONG",{});var Ze=Oe(p);v=Pt(Ze,y),Ze.forEach(ne),a=Pt(Pe," District Electoral Area."),Pe.forEach(ne),E=xt(Fe),T=qe(Fe,"DIV",{style:!0});var Ct=Oe(T);L=Pt(Ct,"You can view more localised information for this postcode at Super Data Zone level by selecting "),F=qe(Ct,"STRONG",{});var kt=Oe(F);C=qe(kt,"A",{href:!0});var Ge=Oe(C);M=Pt(Ge,l[3]),Ge.forEach(ne),kt.forEach(ne),ae=Pt(Ct," or at Data Zone level by selecting "),se=qe(Ct,"STRONG",{});var Ke=Oe(se);he=qe(Ke,"A",{href:!0});var gt=Oe(he);me=Pt(gt,l[5]),gt.forEach(ne),Ke.forEach(ne),it=Pt(Ct,". Note that many of the statistics produced are not broken down to these smaller geography levels."),Ct.forEach(ne),this.h()},h(){Ye(c,"margin-left","1em"),ie(C,"href",X=Sn+"/"+l[4]),ie(he,"href",_e=Sn+"/"+l[6]),Ye(T,"margin-left","1em")},m(Fe,Pe){Re(Fe,c,Pe),we(c,d),we(c,p),we(p,v),we(c,a),Re(Fe,E,Pe),Re(Fe,T,Pe),we(T,L),we(T,F),we(F,C),we(C,M),we(T,ae),we(T,se),we(se,he),we(he,me),we(T,it)},p(Fe,Pe){Pe&1&&y!==(y=Fe[0].name+"")&&Er(v,y),Pe&8&&Er(M,Fe[3]),Pe&16&&X!==(X=Sn+"/"+Fe[4])&&ie(C,"href",X),Pe&32&&Er(me,Fe[5]),Pe&64&&_e!==(_e=Sn+"/"+Fe[6])&&ie(he,"href",_e)},d(Fe){Fe&&ne(c),Fe&&ne(E),Fe&&ne(T)}}}function G1(l){let c=l[7]()&l[1].search_code==l[0].code&l[8](),d,p=c&&Km(l);return{c(){p&&p.c(),d=or()},l(y){p&&p.l(y),d=or()},m(y,v){p&&p.m(y,v),Re(y,d,v)},p(y,[v]){v&3&&(c=y[7]()&y[1].search_code==y[0].code&y[8]()),c?p?p.p(y,v):(p=Km(y),p.c(),p.m(d.parentNode,d)):p&&(p.d(1),p=null)},i:ei,o:ei,d(y){p&&p.d(y),y&&ne(d)}}}function Z1(l,c,d){let{place:p}=c,{storage:y=localStorage}=c,v;function a(){return y.hasOwnProperty("search_name")}function E(){return d(2,v=y.search_name),y.removeItem("search_name"),!0}let T,L,F,C;Vp(()=>{setInterval(function(){a()&&(d(2,v=y.search_name),E())},200)});function M(X){let ae=X.replaceAll(" ","");return fetch("https://raw.githubusercontent.com/NISRA-Tech-Lab/nisra-geog-explorer/main/search_data/cpd_light_with_lat_long_2.csv").then(se=>se.text()).then(se=>{const he=se.split(`
`);let me;for(let _e=0;_e<he.length;_e++){let it=he[_e].split(",");if(it[0]==ae){me=it;break}}d(3,T=me[21]),d(4,L=me[20]),d(5,F=me[19]),d(6,C=me[18])}),!0}return l.$$set=X=>{"place"in X&&d(0,p=X.place),"storage"in X&&d(1,y=X.storage)},[p,y,v,T,L,F,C,a,E,M]}class K1 extends on{constructor(c){super(),sn(this,c,Z1,G1,ln,{place:0,storage:1})}}function Xm(l,c,d){const p=l.slice();return p[29]=c[d],p[31]=d,p}function Wm(l,c,d){const p=l.slice();return p[32]=c[d],p[31]=d,p}function Ym(l,c,d){const p=l.slice();return p[34]=c[d],p}function Jm(l,c,d){const p=l.slice();return p[32]=c[d],p[31]=d,p}function Qm(l){let c,d,p,y,v,a,E=" &gt; ",T,L,F,C,M=l[0].place.name+"",X,ae,se,he,me,_e,it,Fe,Pe,Ze,Ct,kt,Ge,Ke,gt,ur,je,Ft,Be,$e,yt,jt,Lt,St,Ce,ot,Dr,Kr,ki,Br,cr,Sr,Gt,Ei,Yn,ti,Ut,mn,ci,$r,Rn,hi,Tn,ni,zr,_i,pi,qr,Qi,Hr,In,$i,Bn,Ui,An,en,Ri,Xr=l[0].place.type!="ni"&&$m(l);Fe=new u_({props:{search_data:l[0].search_data,group:"typestr",search:!0}}),Fe.$on("select",l[11]),Lt=new K1({props:{place:l[0].place}}),ot=new Bu({props:{id:"overview",i_button:!1,heading:"About "+l[0].place.name,place:l[0].place,style:"line-height: 1.3;",content:{ni:"Northern Ireland has 11 Local Government Districts (LGDs),  which can be subdivided into District Electoral Areas (DEAs), then further into Super Data Zones and Data Zones. Statistics can be viewed for these smaller areas.",lgd:l[0].place.name+" is one of "+l[0].place.count.toLocaleString()+" "+Hn[l[0].place.type].pl+".  It includes the larger settlements of "+l[0].place.lgd_location_description,dea:l[0].place.name+" is one of "+l[0].place.count.toLocaleString()+" "+Hn[l[0].place.type].pl+" in Northern Ireland.  It is within <a href = '/"+l[0].place.parents[0].code+"/' data-sveltekit-noscroll>"+l[0].place.parents[0].name+" </a> and covers "+l[0].place.dea_location_description+".",sdz:l[0].place.name+" is one of "+l[0].place.count.toLocaleString()+" "+Hn[l[0].place.type].pl+". Super Data Zones are new statistical areas developed for census. They are broadly similar in population size and housing type.",dz:l[0].place.name+" is one of "+l[0].place.count.toLocaleString()+" "+Hn[l[0].place.type].pl+".  Data Zones are smaller divisions of Super Data Zones. There are on average 4 in each Super Data Zone."},chart_compare_type:l[6]}}),Kr=new Bu({props:{id:"pop",place:l[0].place,year:Yt("MYETotal",l[0].place),content:'<span class="text-big" style="font-size: 2.8em;">'+l[0].place.data.MYETotal.value.toLocaleString()+"</span>",chart_compare_type:l[6],compare_content:{ni:"",lgd:'<span class = "em" style = "background-color: lightgrey">'+mh(l[0].place.data.population.value[2021].all/l[0].ni.data.population.value[2021].all)+"</span> of Northern Ireland population<br>The "+l[12](l[0].place.data.population.value_rank[2021].all)+" population of 11 Local Government Districts",dea:'<span class = "em" style = "background-color: lightgrey">'+mh(l[0].place.data.population.value[2021].all/l[0].ni.data.population.value[2021].all)+"</span> of Northern Ireland population",sdz:"Data not available for area comparison",dz:" Data not available for area comparison"}}}),Br=new Bu({props:{id:"popden",place:l[0].place,year:Yt("MYETotal",l[0].place),content:'<div class = "row" style = "display: flex; align-items: center"><div class="text-big" style="font-size: 2.8em;">'+ay(l[0].place)+'</div><div style = "margin-left: 10px; line-height: 1.25em"> people per square kilometer</div></div>',chart_compare_type:l[6],compare_content:{ni:"",lgd:l[18](l[0].place),dea:l[18](l[0].place),sdz:l[18](l[0].place),dz:l[18](l[0].place)}}});function zn(re,et){return re[0].place.type!="ni"?X1:H1}let Pn=zn(l),vi=Pn(l);function ha(re){l[20](re)}let ra={location:{bounds:l[0].place.bounds},options:{fitBoundsOptions:{padding:20}},style:c_,$$slots:{default:[Y1]},$$scope:{ctx:l}};l[3]!==void 0&&(ra.map=l[3]),Ut=new J_({props:ra}),Rs.push(()=>d_(Ut,"map",ha));let Or=l[0].place.type!="ni"&&ry(l);function un(re,et){return re[0].place.children[0]?Q1:J1}let qi=un(l),fi=qi(l);return _i=new Ml({props:{id:"people",img:"nisra-taxonomy-icon-census.png",heading:"People and Households",place:l[0].place,sub_heading:l[17]("People and Households",l[0].place),description:"",chart_compare_type:l[6],boxes:{box_1:{id:"popchange",content:l[13](l[0].place),show:["ni","lgd"]},box_2:{id:"broadage",year:Yt("BroadAge",l[0].place),content:"GroupChart",chart_data:l[9]("BroadAge"),show:["ni","lgd","dea","sdz"]},box_4:{id:"hhsize",year:l[16]("hh_size"),content:"GroupChart",chart_data:l[9]("hh_size")},box_5:{id:"religion",year:l[16]("religion_or_religion_brought_up_in"),content:"GroupChart",chart_data:l[9]("religion_or_religion_brought_up_in")},box_7:{id:"language",year:l[16]("mainlang"),content:"StackedBarChart",chart_data:l[0].place&&l[8](["mainlang"],["2011"],["2021"]),zKey:l[6],label:l[7],topic_prev_available:!0}},more:`More information on the size of the population is available in the latest <a href='https://www.nisra.gov.uk/publications/2022-mid-year-population-estimates-northern-ireland'>mid-year estimates release</a>, \r
					which includes an <a href='https://www.nisra.gov.uk/system/files/statistics/MYE22-summary.pdf'>infographic</a>, \r
					<a href='https://www.nisra.gov.uk/system/files/statistics/MYE22-Factsheets.pdf'>Fact Sheets</a>, \r
					a <a href='https://www.nisra.gov.uk/system/files/statistics/Statistical%20Bulletin%20-%202022%20Mid-year%20Population%20Estimates%20for%20Northern%20Ireland.pdf'>publication</a> \r
					and statistical tables. Population characteristics are from the census data which can be explored further in the <a href='https://explore.nisra.gov.uk/area-explorer-2021/N92000002/'>Census Area Explorer</a>, \r
					bespoke tables can be created using the <a href='https://build.nisra.gov.uk/en/'>Flexible Table Builder</a> and the NISRA website has \r
					<a href='https://www.nisra.gov.uk/publications/census-2021-statistical-bulletins'>statistical bulletins</a> providing commentary on a range of census population characteristics.`}}),qr=new Ml({props:{id:"health",img:"nisra-taxonomy-icon-health.png",heading:"Health and Social Care",place:l[0].place,sub_heading:l[17]("Health and Social Care",l[0].place),description:" ",chart_compare_type:l[6],boxes:{box_0:{id:"generalhealth",year:l[16]("general_health"),content:"GroupChart",chart_data:l[9]("general_health")},box_2a:{id:"wellbeing",year:Yt("Happy",l[0].place),content:"<p>Happiness</p><span class='text-big'>"+l[14]("Happy.value").toLocaleString()+"</span>/ 10 <p>Life Satisfaction</p><span class='text-big'>"+l[14]("Satisfy.value").toLocaleString()+"</span>/ 10 ",show:["ni"]},box_2b:{id:"wellbeing",year:Yt("Happy",l[0].place),content:"<p>Happiness</p><span class='text-big'>"+l[14]("Happy.value").toLocaleString()+"</span>/ 10 <span style='color: #1460aa'> (NI "+l[0].ni.data.Happy.value+"/10) </span></p><p>Life Satisfaction</p><span class='text-big'>"+l[14]("Satisfy.value").toLocaleString()+"</span>/ 10 <span style='color: #1460aa'> (NI "+l[0].ni.data.Satisfy.value+"/10) </span></p>",show:["lgd"]},box_3a:{id:"lifeexpectancy",year:Yt("LE",l[0].place),content:"<p>Male</p> <span class='text-big'>"+l[14]("LE.value.Males").toLocaleString()+"</span> years<p>Female</p> <span class='text-big'>"+l[14]("LE.value.Females").toLocaleString()+"</span> years",show:["ni"]},box_3b:{id:"lifeexpectancy",year:Yt("LE",l[0].place),content:"<p>Male</p> <span class='text-big'>"+l[14]("LE.value.Males").toLocaleString()+"</span> years<span style='color: #1460aa'> (NI "+l[0].ni.data.LE.value.Males+") </span></p><p>Female</p> <span class='text-big'>"+l[14]("LE.value.Females").toLocaleString()+"</span> years<span style='color: #1460aa'> (NI "+l[0].ni.data.LE.value.Females+") </span></p>",show:["lgd"]},box_4:{id:"carers",content:"GroupChart",year:l[16]("provision_care"),chart_data:l[9]("provision_care")},box_5:{id:"hospitalactivity",year:Yt("Admiss",l[0].place),content:"<p><span class='text-big'>"+l[14]("Admiss.value").toLocaleString()+"</span> hospital patients</p><p>The most frequent reason was for </p><span class='text-bold' >"+l[14]("Admiss.text")+"</span>",show:["ni","dea"]},box_6:{id:"primarycare",year:Yt("GP",l[0].place),content:"<p><span class='text-big'>"+l[14]("GP.value.PRACS").toLocaleString()+"</span> GP practices with an average of <span class='text-big'>"+l[14]("GP.value.PRACLIST").toLocaleString()+"</span> patients per practice</p><p><span class='text-big'>"+l[14]("DEN.value.GDSDSSurgeries").toLocaleString()+"</span> dental surgeries</span> with an average of <span class='text-big'>"+(l[14]("DEN_REG.value.Dental_Registrations")/l[14]("DEN.value.GDSDSSurgeries")).toLocaleString(void 0,{minimumFractionDigits:0,maximumFractionDigits:0})+"</span> patients per surgery</p>",show:["ni"]},box_6a:{id:"primarycare",year:Yt("GP",l[0].place),content:"<p><span class='text-big'>"+l[14]("GP.value.PRACS").toLocaleString()+"</span> GP practices with an average of <span class='text-big'>"+l[14]("GP.value.PRACLIST").toLocaleString()+"</span> patients per practice</p><p>"+l[15]("GP.value.PRACLIST").toLocaleString()+"<span style='color: #1460aa'> (NI "+l[0].ni.data.GP.value.PRACLIST.toLocaleString()+" patients per practice) </span></p><p><span class='text-big'>"+l[14]("DEN.value.GDSDSSurgeries").toLocaleString()+"</span> dental surgeries</span> with an average of <span class='text-big'>"+(l[14]("DEN_REG.value.Dental_Registrations")/l[14]("DEN.value.GDSDSSurgeries")).toLocaleString(void 0,{minimumFractionDigits:0,maximumFractionDigits:0})+"</span> patients per surgery</p>",show:["lgd"]},box_6b:{id:"primarycare",year:Yt("DEN",l[0].place),content:"<p><span class='text-big'>"+l[14]("DEN.value.GDSDSSurgeries").toLocaleString()+"</span> dental surgeries</span> with an average of <span class='text-big'>"+(l[14]("DEN_REG.value.Dental_Registrations")/l[14]("DEN.value.GDSDSSurgeries")).toLocaleString(void 0,{minimumFractionDigits:0,maximumFractionDigits:0})+"</span> patients per surgery</p>",show:["dea"]},box_6c:{id:"empty",i_button:!1,content:"",show:["sdz","dz"]}},more:`<p>Significant volumes of information are prepared by the <a href='https://www.health-ni.gov.uk/topics/doh-statistics-and-research'>Department of Health</a> \r
				and the <a href='https://bso.hscni.net/directorates/operations/family-practitioner-services/directorates-operations-family-practitioner-services-information-unit/general-ophthalmic-services-statistics/'>\r
				Business Services Organisation</a>, including statistics on <a href='https://www.health-ni.gov.uk/topics/dhssps-statistics-and-research/health-inequalities-statistics'>Health inequalities</a>, \r
				Primary care (including <a href='https://bso.hscni.net/directorates/operations/family-practitioner-services/directorates-operations-family-practitioner-services-information-unit/1776-2/'>Medical</a>, \r
				<a href='https://bso.hscni.net/directorates/operations/family-practitioner-services/directorates-operations-family-practitioner-services-information-unit/general-dental-services-statistics/'>Dental</a>, \r
				<a href='https://bso.hscni.net/directorates/operations/family-practitioner-services/directorates-operations-family-practitioner-services-information-unit/general-pharmaceutical-services-and-prescribing-statistics/'>\r
				Pharmaceutical</a> and <a href='https://bso.hscni.net/directorates/operations/family-practitioner-services/directorates-operations-family-practitioner-services-information-unit/general-ophthalmic-services-statistics/'>\r
				Ophthalmic</a>), <a href='https://www.health-ni.gov.uk/topics/dhssps-statistics-and-research/family-health-services-statistics'>\r
				Family health services</a>, <a href='https://www.health-ni.gov.uk/topics/doh-statistics-and-research-mental-health-and-learning-disabilities/mental-health-learning-disability-and-autism-statistics'>\r
				Mental health, learning disability and autism</a>, <a href='https://www.health-ni.gov.uk/topics/dhssps-statistics-and-research-social-services/social-care-statistics'>\r
				Social care</a>, <a href='https://www.health-ni.gov.uk/topics/dhssps-statistics-and-research/workforce-statistics'>Workforce</a>, and <u>COVID-19</u>.\r
				A number of <a href='https://visual.nisra.gov.uk/?body=entity/health'>interactive dashboards</a> are available and a compendium dashboard for <a href='https://visual.nisra.gov.uk/?body=entity/las'>\r
				Making Life Better</a>.\r
				The <a href='https://www.nisra.gov.uk/statistics/census'>2021 census</a> collected data on general health, long-term conditions and carers which can \r
				be explored in the <a href='https://explore.nisra.gov.uk/area-explorer-2021/N92000002/'>Census Area Explorer</a> and the <a href='https://build.nisra.gov.uk/en/'>Flexible Table Builder</a>.</p><p></p>`}}),Hr=new Ml({props:{id:"work",img:"nisra-taxonomy-icon-labour-market.png",heading:"Work and Welfare",place:l[0].place,sub_heading:l[17]("Work and Welfare",l[0].place),description:" ",chart_compare_type:l[6],boxes:{box_1:{id:"employmentrates",year:Yt("LMS",l[0].place),content:"GroupChart",chart_data:l[9]("LMS"),show:["ni","lgd"]},box_2a:{id:"employed",year:Yt("LMS",l[0].place),content:"<p>People employed</p> <span class='text-big'>"+l[14]("LMS.value.EMPN").toLocaleString()+'</span> </p><p>Median salary</p> <span class="text-big">'+l[14]("ASHE.value").toLocaleString()+"</span> ",show:["ni"]},box_2b:{id:"employed",year:Yt("LMS",l[0].place),content:"<p>People employed</p> <span class='text-big'>"+l[14]("LMS.value.EMPN").toLocaleString()+'</span> </p><p>Median salary</p> <span class="text-big">'+l[14]("ASHE.value").toLocaleString()+"</span> <span style='color: #1460aa'> (NI "+l[0].ni.data.ASHE.value.toLocaleString()+") </span></p>",show:["lgd"]},box_3b:{id:"bres",year:Yt("BRES",l[0].place),content:"GroupChart",chart_data:l[9]("BRES"),show:["ni","lgd"]},box_4:{id:"disabilitybenefits",year:Yt("BS",l[0].place),content:'<span class="text-big">'+(l[0].place.data.BS.value.PIP+l[0].place.data.BS.value.DLA+l[0].place.data.BS.value.CA+l[0].place.data.BS.value.AA).toLocaleString()+"</span> claimants"},box_5:{id:"workingagebenefits",year:Yt("BS",l[0].place),content:'<span class="text-big">'+(l[0].place.data.BS.value.UC+l[0].place.data.BS.value.JSA+l[0].place.data.BS.value.IS+l[0].place.data.BS.value.ESA).toLocaleString()+"</span> claimants"},box_6:{id:"pensionagebenefits",year:Yt("BS",l[0].place),content:'<span class="text-big">'+(l[0].place.data.BS.value.RP+l[0].place.data.BS.value.PC).toLocaleString()+"</span> claimants"}},more:`<p>The monthly <a href='https://www.nisra.gov.uk/statistics/labour-market-and-social-welfare/labour-market-overview'>Labour Market Report</a>\r
				contains the most up to date labour market statistics. The <a href='https://www.nisra.gov.uk/statistics/labour-market-and-social-welfare/annual-survey-hours-and-earnings'>\r
				Annual Survey of Hours and Earnings</a> provides data on hourly, weekly and annual earnings. The <a href='https://www.nisra.gov.uk/statistics/labour-market-and-social-welfare/quarterly-employment-survey'>\r
				Quarterly Employment Survey</a> provides short-term employee jobs estimates for NI. Further information is available for the \r
				unemployed <a href='https://www.nisra.gov.uk/statistics/labour-market-and-social-welfare/claimant-count'>Claimant Count</a>, \r
				claimant numbers for <a href='https://www.nisra.gov.uk/statistics/labour-market-and-social-welfare/disability-benefits'>Disability Benefits</a>, \r
				and <a href='https://www.nisra.gov.uk/statistics/labour-market-and-social-welfare/work-related-benefits'>Work Related Benefits</a>. \r
				Statistics on <a href='https://www.nisra.gov.uk/statistics/labour-market-and-social-welfare/redundancies'>Redundancies</a> \r
				and <a href='https://www.nisra.gov.uk/statistics/labour-market-and-social-welfare/job-vacancies'>Job Vacancies</a> are also available. \r
				A number of <a href='https://visual.nisra.gov.uk/?body=entity/lm'>interactive dashboards</a> are available. \r
				The <a href='https://www.nisra.gov.uk/statistics/census'>2021 census</a> collected data on occupations, industry and number of hours worked which can be \r
				explored in the <a href='https://explore.nisra.gov.uk/area-explorer-2021/N92000002/'>Census Area Explorer</a> and the <a href='https://build.nisra.gov.uk/en/'>Flexible Table Builder</a>.</p>`}}),$i=new Ml({props:{id:"education",img:"nisra-taxonomy-icon-child-education-skills.png",heading:"Education",place:l[0].place,sub_heading:l[17]("Schools, colleges and universities",l[0].place),description:"",chart_compare_type:l[6],boxes:{box_1:{id:"enrollments",content:"<p style='margin:0'>Primary school <span class='text-big'>"+l[14]("Primary.value").toLocaleString()+"</span> <p style='margin:0'>Post primary school <span class='text-big'>"+l[14]("PostPrimary.value").toLocaleString()+" </span><p style='margin:0'>Further education <span class='text-big'>"+l[14]("FE.value").toLocaleString()+"</span><p style='margin:0'>Higher education <span class='text-big'>"+l[14]("HE.value").toLocaleString()+" </span>",year:Yt("Primary",l[0].place),show:["ni","lgd","dea"]},box_2a:{id:"fsme",content:"<p style='margin:0'>Primary school <span class='text-big'> "+l[14]("Primary.perc.FSME")+" </span><p style='margin:0'>Post primary school <span class='text-big'>"+l[14]("PostPrimary.perc.FSME")+" </span>",year:Yt("Primary",l[0].place),show:["ni"]},box_2b:{id:"fsme",content:"<p style='margin:0'>Primary school <span class='text-big'> "+l[14]("Primary.perc.FSME")+" </span><span style='color: #1460aa'> (NI "+l[0].ni.data.Primary.perc.FSME.toFixed(0)+"%) </span></p><p style='margin:0'>Post primary school <span class='text-big'>"+l[14]("PostPrimary.perc.FSME")+" </span><span style='color: #1460aa'> (NI "+l[0].ni.data.PostPrimary.perc.FSME.toFixed(0)+"%) </span></p>",year:Yt("Primary",l[0].place),show:["lgd","dea"]},box_3a:{id:"teachers",year:Yt("ClassSize",l[0].place),content:"<p><span class='text-big'>"+l[14]("ClassSize.value").toLocaleString()+"</span> pupils per teacher",show:["ni"]},box_3n:{id:"teachers",year:Yt("ClassSize",l[0].place),content:"<p><span class='text-big'>"+l[14]("ClassSize.value").toLocaleString()+"</span> pupils per teacher<span style='color: #1460aa'> (NI "+l[0].ni.data.ClassSize.value.toLocaleString(void 0,{minimumFractionDigits:1})+") </span></p>",show:["lgd"]},box_4:{id:"qualifications",content:"GroupChart",year:l[16]("highest_level_of_qualifications"),chart_data:l[9]("highest_level_of_qualifications")},box_5a:{id:"attainment",year:Yt("Attainment",l[0].place),content:"<p>Percentage of pupils who left school with 5 or more GCSEs grades A*-C (including Maths and English)</p><p> <span class='text-big'>"+l[14]("Attainment.value").toLocaleString()+"%</span> ",show:["ni"]},box_5b:{id:"attainment",year:Yt("Attainment",l[0].place),content:"<p>Percentage of pupils who left school with 5 or more GCSEs grades A*-C (including Maths and English)</p><p> <span class='text-big'>"+l[14]("Attainment.value").toLocaleString()+"%</span> <span style='color: #1460aa'>(NI "+l[0].ni.data.Attainment.value.toLocaleString(void 0,{minimumFractionDigits:1})+"%) </span></p>"+l[15]("Attainment.value").toLocaleString(),show:["lgd"]},box_6:{id:"destination",year:Yt("Destination",l[0].place),content:"GroupChart",chart_data:l[9]("Destination"),show:["ni","lgd","dea"]},box_6a:{id:"empty",i_button:!1,content:"",show:["sdz","dz"]},box_6b:{id:"empty",i_button:!1,content:"",show:["sdz","dz"]}},more:"<p>The <a href='https://www.nisra.gov.uk/statistics/children-education-and-skills/school-education-statistics'>Department of Education</a> publishes statistics on <a href='https://www.education-ni.gov.uk/articles/school-enrolments-overview'>school enrolments</a>, <a href='https://www.education-ni.gov.uk/articles/school-performance'>school performance</a>, <a href='https://www.education-ni.gov.uk/articles/school-leavers'>school leavers</a>, qualifications and destinations, <a href='https://www.education-ni.gov.uk/articles/pupil-attendance'>pupil attendance</a>, suspensions and expulsions, school meals and <a href='https://www.education-ni.gov.uk/articles/education-workforce'>education workforce</a>. The <a href='https://www.nisra.gov.uk/statistics/children-education-and-skills/higher-and-further-education-and-training-statistics'>Department for the Economy</a> publishes <a href='https://www.economy-ni.gov.uk/topics/statistics-and-economic-research/higher-education-statistics-and-research'>Higher</a> and <a href='https://www.economy-ni.gov.uk/topics/statistics-and-economic-research/further-education-statistics-and-research'>Further</a> education and <a href='https://www.economy-ni.gov.uk/articles/training-success-statistics'>training</a> statistics. The <a href='https://www.nisra.gov.uk/statistics/census'>2021 census</a> collected data on qualifications which can be explored in the <a href='https://explore.nisra.gov.uk/area-explorer-2021/N92000002/'>Census Area Explorer</a> and the <a href='https://build.nisra.gov.uk/en/'>Flexible Table Builder</a>.</p>"}}),Ui=new Ml({props:{id:"crime",img:"nisra-taxonomy-icon-crime-justice.png",heading:"Crime and Justice",place:l[0].place,sub_heading:l[17]("Crime and Court Activity",l[0].place),description:" ",chart_compare_type:l[6],boxes:{},more:""}}),en=new Ml({props:{id:"travel",img:"nisra-taxonomy-icon-travel-transport.png",heading:"Travel and Transport",place:l[0].place,sub_heading:l[17]("Travel and transport",l[0].place),description:" ",chart_compare_type:l[6],boxes:{},more:""}}),{c(){c=Ue("div"),d=Ue("div"),p=Ue("span"),y=Ue("a"),v=zt("Home"),a=new Bl(!1),T=bt(),Xr&&Xr.c(),L=bt(),F=Ue("br"),C=Ue("span"),X=zt(M),ae=bt(),se=Ue("div"),he=Ue("div"),me=Ue("b"),_e=zt("Search for your area:"),it=bt(),er(Fe.$$.fragment),Pe=bt(),Ze=Ue("script"),Ct=zt(`// Share button\r
						// Possible tooltip: https://stackoverflow.com/questions/37798967/tooltip-on-click-of-a-button\r
\r
						function copyToClipboard(text) {\r
							var inputc = document.body.appendChild(\r
								document.createElement("input"),\r
							);\r
							inputc.value = window.location.href;\r
							inputc.select();\r
							document.execCommand("copy");\r
							inputc.parentNode.removeChild(inputc);\r
							alert("URL Copied.");\r
						}\r
\r
						(function (win, doc) {\r
							const testButton = doc.createElement("button");\r
							testButton.setAttribute("type", "share");\r
							if (testButton.type != "share") {\r
								win.addEventListener("click", function (ev) {\r
									ev = ev || win.event;\r
									let target = ev.target;\r
									let button = target.closest(\r
										'button[type="share"]',\r
									);\r
									if (button) {\r
										const title = "Share URL";\r
										const url = win.location.href;\r
										if (navigator.share) {\r
											navigator.share({\r
												title: title,\r
												url: url,\r
											});\r
										} else {\r
											copyToClipboard();\r
										}\r
									}\r
								});\r
							}\r
						})(this, this.document);`),kt=bt(),Ge=Ue("div"),Ke=Ue("button"),gt=zt("About"),ur=bt(),je=Ue("button"),Ft=zt("Print / PDF"),Be=bt(),$e=Ue("button"),yt=zt("Share"),jt=bt(),er(Lt.$$.fragment),St=bt(),Ce=Ue("div"),er(ot.$$.fragment),Dr=bt(),er(Kr.$$.fragment),ki=bt(),er(Br.$$.fragment),cr=bt(),Sr=Ue("div"),Gt=Ue("div"),Ei=Ue("h3"),vi.c(),Yn=bt(),ti=Ue("div"),er(Ut.$$.fragment),ci=bt(),$r=Ue("div"),Or&&Or.c(),Rn=bt(),hi=Ue("div"),fi.c(),ni=bt(),zr=Ue("div"),er(_i.$$.fragment),pi=bt(),er(qr.$$.fragment),Qi=bt(),er(Hr.$$.fragment),In=bt(),er($i.$$.fragment),Bn=bt(),er(Ui.$$.fragment),An=bt(),er(en.$$.fragment),this.h()},l(re){c=qe(re,"DIV",{class:!0});var et=Oe(c);d=qe(et,"DIV",{});var R=Oe(d);p=qe(R,"SPAN",{class:!0});var N=Oe(p);y=qe(N,"A",{href:!0,"data-sveltekit-noscroll":!0,class:!0});var q=Oe(y);v=Pt(q,"Home"),q.forEach(ne),a=Ol(N,!1),T=xt(N),Xr&&Xr.l(N),N.forEach(ne),L=xt(R),F=qe(R,"BR",{}),C=qe(R,"SPAN",{class:!0,style:!0});var K=Oe(C);X=Pt(K,M),K.forEach(ne),R.forEach(ne),ae=xt(et),se=qe(et,"DIV",{});var W=Oe(se);he=qe(W,"DIV",{style:!0,class:!0});var le=Oe(he);me=qe(le,"B",{});var fe=Oe(me);_e=Pt(fe,"Search for your area:"),fe.forEach(ne),it=xt(le),tr(Fe.$$.fragment,le),Pe=xt(le),Ze=qe(le,"SCRIPT",{});var U=Oe(Ze);Ct=Pt(U,`// Share button\r
						// Possible tooltip: https://stackoverflow.com/questions/37798967/tooltip-on-click-of-a-button\r
\r
						function copyToClipboard(text) {\r
							var inputc = document.body.appendChild(\r
								document.createElement("input"),\r
							);\r
							inputc.value = window.location.href;\r
							inputc.select();\r
							document.execCommand("copy");\r
							inputc.parentNode.removeChild(inputc);\r
							alert("URL Copied.");\r
						}\r
\r
						(function (win, doc) {\r
							const testButton = doc.createElement("button");\r
							testButton.setAttribute("type", "share");\r
							if (testButton.type != "share") {\r
								win.addEventListener("click", function (ev) {\r
									ev = ev || win.event;\r
									let target = ev.target;\r
									let button = target.closest(\r
										'button[type="share"]',\r
									);\r
									if (button) {\r
										const title = "Share URL";\r
										const url = win.location.href;\r
										if (navigator.share) {\r
											navigator.share({\r
												title: title,\r
												url: url,\r
											});\r
										} else {\r
											copyToClipboard();\r
										}\r
									}\r
								});\r
							}\r
						})(this, this.document);`),U.forEach(ne),kt=xt(le),Ge=qe(le,"DIV",{width:!0});var J=Oe(Ge);Ke=qe(J,"BUTTON",{class:!0,style:!0,alt:!0,onclick:!0});var ge=Oe(Ke);gt=Pt(ge,"About"),ge.forEach(ne),ur=xt(J),je=qe(J,"BUTTON",{class:!0,style:!0,title:!0,onclick:!0});var De=Oe(je);Ft=Pt(De,"Print / PDF"),De.forEach(ne),Be=xt(J),$e=qe(J,"BUTTON",{class:!0,style:!0,type:!0,alt:!0});var Ne=Oe($e);yt=Pt(Ne,"Share"),Ne.forEach(ne),J.forEach(ne),le.forEach(ne),W.forEach(ne),et.forEach(ne),jt=xt(re),tr(Lt.$$.fragment,re),St=xt(re),Ce=qe(re,"DIV",{id:!0,class:!0});var ke=Oe(Ce);tr(ot.$$.fragment,ke),Dr=xt(ke),tr(Kr.$$.fragment,ke),ki=xt(ke),tr(Br.$$.fragment,ke),ke.forEach(ne),cr=xt(re),Sr=qe(re,"DIV",{class:!0});var Le=Oe(Sr);Gt=qe(Le,"DIV",{style:!0});var pt=Oe(Gt);Ei=qe(pt,"H3",{class:!0});var lt=Oe(Ei);vi.l(lt),lt.forEach(ne),pt.forEach(ne),Yn=xt(Le),ti=qe(Le,"DIV",{id:!0,style:!0,class:!0});var Ie=Oe(ti);tr(Ut.$$.fragment,Ie),Ie.forEach(ne),ci=xt(Le),$r=qe(Le,"DIV",{});var nt=Oe($r);Or&&Or.l(nt),nt.forEach(ne),Rn=xt(Le),hi=qe(Le,"DIV",{});var Je=Oe(hi);fi.l(Je),Je.forEach(ne),Le.forEach(ne),ni=xt(re),zr=qe(re,"DIV",{class:!0,id:!0});var He=Oe(zr);tr(_i.$$.fragment,He),pi=xt(He),tr(qr.$$.fragment,He),Qi=xt(He),tr(Hr.$$.fragment,He),In=xt(He),tr($i.$$.fragment,He),Bn=xt(He),tr(Ui.$$.fragment,He),An=xt(He),tr(en.$$.fragment,He),He.forEach(ne),this.h()},h(){ie(y,"href",Sn+"/"),ie(y,"data-sveltekit-noscroll",""),ie(y,"class","svelte-hmrro5"),a.a=T,ie(p,"class","text-small"),ie(C,"class","text-big title svelte-hmrro5"),Ye(C,"font-size","2.5em"),Ye(C,"line-height","1em"),ie(Ke,"class","btn svelte-hmrro5"),Ye(Ke,"width","33%"),ie(Ke,"alt","Opens the About page"),ie(Ke,"onclick","window.location.href='"+Sn+"/about';"),ie(je,"class","btn svelte-hmrro5"),Ye(je,"width","33%"),ie(je,"title","Click to print this page to pdf or printer"),ie(je,"onclick","window.print();return false;"),ie($e,"class","btn svelte-hmrro5"),Ye($e,"width","30%"),ie($e,"type","share"),ie($e,"alt","Share this page"),ie(Ge,"width","100%"),Ye(he,"width","350px"),Ye(he,"padding-top","5px"),ie(he,"class","svelte-hmrro5"),rs(he,"float-right",l[2]>1),ie(c,"class","grid mtl svelte-hmrro5"),ie(Ce,"id","grid"),ie(Ce,"class","grid mt svelte-hmrro5"),ie(Ei,"class","svelte-hmrro5"),Ye(Gt,"grid-column","span "+l[2]),ie(ti,"id","map"),Ye(ti,"padding-right","45px"),Ye(ti,"grid-column","span "+(l[2]==2?2:l[2]&&l[2]>2?l[2]-1:1)),ie(ti,"class","svelte-hmrro5"),ie(Sr,"class","grid mt svelte-hmrro5"),Gu(()=>l[21].call(Sr)),ie(zr,"class","accordion"),ie(zr,"id","accordionPanelsStayOpenExample")},m(re,et){Re(re,c,et),we(c,d),we(d,p),we(p,y),we(y,v),a.m(E,p),we(p,T),Xr&&Xr.m(p,null),we(d,L),we(d,F),we(d,C),we(C,X),we(c,ae),we(c,se),we(se,he),we(he,me),we(me,_e),we(he,it),rr(Fe,he,null),we(he,Pe),we(he,Ze),we(Ze,Ct),we(he,kt),we(he,Ge),we(Ge,Ke),we(Ke,gt),we(Ge,ur),we(Ge,je),we(je,Ft),we(Ge,Be),we(Ge,$e),we($e,yt),Re(re,jt,et),rr(Lt,re,et),Re(re,St,et),Re(re,Ce,et),rr(ot,Ce,null),we(Ce,Dr),rr(Kr,Ce,null),we(Ce,ki),rr(Br,Ce,null),Re(re,cr,et),Re(re,Sr,et),we(Sr,Gt),we(Gt,Ei),vi.m(Ei,null),we(Sr,Yn),we(Sr,ti),rr(Ut,ti,null),we(Sr,ci),we(Sr,$r),Or&&Or.m($r,null),we(Sr,Rn),we(Sr,hi),fi.m(hi,null),Tn=Zu(Sr,l[21].bind(Sr)),Re(re,ni,et),Re(re,zr,et),rr(_i,zr,null),we(zr,pi),rr(qr,zr,null),we(zr,Qi),rr(Hr,zr,null),we(zr,In),rr($i,zr,null),we(zr,Bn),rr(Ui,zr,null),we(zr,An),rr(en,zr,null),Ri=!0},p(re,et){re[0].place.type!="ni"?Xr?Xr.p(re,et):(Xr=$m(re),Xr.c(),Xr.m(p,null)):Xr&&(Xr.d(1),Xr=null),(!Ri||et[0]&1)&&M!==(M=re[0].place.name+"")&&Er(X,M);const R={};et[0]&1&&(R.search_data=re[0].search_data),Fe.$set(R),(!Ri||et[0]&4)&&rs(he,"float-right",re[2]>1);const N={};et[0]&1&&(N.place=re[0].place),Lt.$set(N);const q={};et[0]&1&&(q.heading="About "+re[0].place.name),et[0]&1&&(q.place=re[0].place),et[0]&1&&(q.content={ni:"Northern Ireland has 11 Local Government Districts (LGDs),  which can be subdivided into District Electoral Areas (DEAs), then further into Super Data Zones and Data Zones. Statistics can be viewed for these smaller areas.",lgd:re[0].place.name+" is one of "+re[0].place.count.toLocaleString()+" "+Hn[re[0].place.type].pl+".  It includes the larger settlements of "+re[0].place.lgd_location_description,dea:re[0].place.name+" is one of "+re[0].place.count.toLocaleString()+" "+Hn[re[0].place.type].pl+" in Northern Ireland.  It is within <a href = '/"+re[0].place.parents[0].code+"/' data-sveltekit-noscroll>"+re[0].place.parents[0].name+" </a> and covers "+re[0].place.dea_location_description+".",sdz:re[0].place.name+" is one of "+re[0].place.count.toLocaleString()+" "+Hn[re[0].place.type].pl+". Super Data Zones are new statistical areas developed for census. They are broadly similar in population size and housing type.",dz:re[0].place.name+" is one of "+re[0].place.count.toLocaleString()+" "+Hn[re[0].place.type].pl+".  Data Zones are smaller divisions of Super Data Zones. There are on average 4 in each Super Data Zone."}),et[0]&64&&(q.chart_compare_type=re[6]),ot.$set(q);const K={};et[0]&1&&(K.place=re[0].place),et[0]&1&&(K.year=Yt("MYETotal",re[0].place)),et[0]&1&&(K.content='<span class="text-big" style="font-size: 2.8em;">'+re[0].place.data.MYETotal.value.toLocaleString()+"</span>"),et[0]&64&&(K.chart_compare_type=re[6]),et[0]&1&&(K.compare_content={ni:"",lgd:'<span class = "em" style = "background-color: lightgrey">'+mh(re[0].place.data.population.value[2021].all/re[0].ni.data.population.value[2021].all)+"</span> of Northern Ireland population<br>The "+re[12](re[0].place.data.population.value_rank[2021].all)+" population of 11 Local Government Districts",dea:'<span class = "em" style = "background-color: lightgrey">'+mh(re[0].place.data.population.value[2021].all/re[0].ni.data.population.value[2021].all)+"</span> of Northern Ireland population",sdz:"Data not available for area comparison",dz:" Data not available for area comparison"}),Kr.$set(K);const W={};et[0]&1&&(W.place=re[0].place),et[0]&1&&(W.year=Yt("MYETotal",re[0].place)),et[0]&1&&(W.content='<div class = "row" style = "display: flex; align-items: center"><div class="text-big" style="font-size: 2.8em;">'+ay(re[0].place)+'</div><div style = "margin-left: 10px; line-height: 1.25em"> people per square kilometer</div></div>'),et[0]&64&&(W.chart_compare_type=re[6]),et[0]&1&&(W.compare_content={ni:"",lgd:re[18](re[0].place),dea:re[18](re[0].place),sdz:re[18](re[0].place),dz:re[18](re[0].place)}),Br.$set(W),Pn===(Pn=zn(re))&&vi?vi.p(re,et):(vi.d(1),vi=Pn(re),vi&&(vi.c(),vi.m(Ei,null))),(!Ri||et[0]&4)&&Ye(Gt,"grid-column","span "+re[2]);const le={};et[0]&1&&(le.location={bounds:re[0].place.bounds}),et[0]&48|et[1]&128&&(le.$$scope={dirty:et,ctx:re}),!mn&&et[0]&8&&(mn=!0,le.map=re[3],m_(()=>mn=!1)),Ut.$set(le),(!Ri||et[0]&4)&&Ye(ti,"grid-column","span "+(re[2]==2?2:re[2]&&re[2]>2?re[2]-1:1)),re[0].place.type!="ni"?Or?Or.p(re,et):(Or=ry(re),Or.c(),Or.m($r,null)):Or&&(Or.d(1),Or=null),qi===(qi=un(re))&&fi?fi.p(re,et):(fi.d(1),fi=qi(re),fi&&(fi.c(),fi.m(hi,null)));const fe={};et[0]&1&&(fe.place=re[0].place),et[0]&1&&(fe.sub_heading=re[17]("People and Households",re[0].place)),et[0]&64&&(fe.chart_compare_type=re[6]),et[0]&193&&(fe.boxes={box_1:{id:"popchange",content:re[13](re[0].place),show:["ni","lgd"]},box_2:{id:"broadage",year:Yt("BroadAge",re[0].place),content:"GroupChart",chart_data:re[9]("BroadAge"),show:["ni","lgd","dea","sdz"]},box_4:{id:"hhsize",year:re[16]("hh_size"),content:"GroupChart",chart_data:re[9]("hh_size")},box_5:{id:"religion",year:re[16]("religion_or_religion_brought_up_in"),content:"GroupChart",chart_data:re[9]("religion_or_religion_brought_up_in")},box_7:{id:"language",year:re[16]("mainlang"),content:"StackedBarChart",chart_data:re[0].place&&re[8](["mainlang"],["2011"],["2021"]),zKey:re[6],label:re[7],topic_prev_available:!0}}),_i.$set(fe);const U={};et[0]&1&&(U.place=re[0].place),et[0]&1&&(U.sub_heading=re[17]("Health and Social Care",re[0].place)),et[0]&64&&(U.chart_compare_type=re[6]),et[0]&1&&(U.boxes={box_0:{id:"generalhealth",year:re[16]("general_health"),content:"GroupChart",chart_data:re[9]("general_health")},box_2a:{id:"wellbeing",year:Yt("Happy",re[0].place),content:"<p>Happiness</p><span class='text-big'>"+re[14]("Happy.value").toLocaleString()+"</span>/ 10 <p>Life Satisfaction</p><span class='text-big'>"+re[14]("Satisfy.value").toLocaleString()+"</span>/ 10 ",show:["ni"]},box_2b:{id:"wellbeing",year:Yt("Happy",re[0].place),content:"<p>Happiness</p><span class='text-big'>"+re[14]("Happy.value").toLocaleString()+"</span>/ 10 <span style='color: #1460aa'> (NI "+re[0].ni.data.Happy.value+"/10) </span></p><p>Life Satisfaction</p><span class='text-big'>"+re[14]("Satisfy.value").toLocaleString()+"</span>/ 10 <span style='color: #1460aa'> (NI "+re[0].ni.data.Satisfy.value+"/10) </span></p>",show:["lgd"]},box_3a:{id:"lifeexpectancy",year:Yt("LE",re[0].place),content:"<p>Male</p> <span class='text-big'>"+re[14]("LE.value.Males").toLocaleString()+"</span> years<p>Female</p> <span class='text-big'>"+re[14]("LE.value.Females").toLocaleString()+"</span> years",show:["ni"]},box_3b:{id:"lifeexpectancy",year:Yt("LE",re[0].place),content:"<p>Male</p> <span class='text-big'>"+re[14]("LE.value.Males").toLocaleString()+"</span> years<span style='color: #1460aa'> (NI "+re[0].ni.data.LE.value.Males+") </span></p><p>Female</p> <span class='text-big'>"+re[14]("LE.value.Females").toLocaleString()+"</span> years<span style='color: #1460aa'> (NI "+re[0].ni.data.LE.value.Females+") </span></p>",show:["lgd"]},box_4:{id:"carers",content:"GroupChart",year:re[16]("provision_care"),chart_data:re[9]("provision_care")},box_5:{id:"hospitalactivity",year:Yt("Admiss",re[0].place),content:"<p><span class='text-big'>"+re[14]("Admiss.value").toLocaleString()+"</span> hospital patients</p><p>The most frequent reason was for </p><span class='text-bold' >"+re[14]("Admiss.text")+"</span>",show:["ni","dea"]},box_6:{id:"primarycare",year:Yt("GP",re[0].place),content:"<p><span class='text-big'>"+re[14]("GP.value.PRACS").toLocaleString()+"</span> GP practices with an average of <span class='text-big'>"+re[14]("GP.value.PRACLIST").toLocaleString()+"</span> patients per practice</p><p><span class='text-big'>"+re[14]("DEN.value.GDSDSSurgeries").toLocaleString()+"</span> dental surgeries</span> with an average of <span class='text-big'>"+(re[14]("DEN_REG.value.Dental_Registrations")/re[14]("DEN.value.GDSDSSurgeries")).toLocaleString(void 0,{minimumFractionDigits:0,maximumFractionDigits:0})+"</span> patients per surgery</p>",show:["ni"]},box_6a:{id:"primarycare",year:Yt("GP",re[0].place),content:"<p><span class='text-big'>"+re[14]("GP.value.PRACS").toLocaleString()+"</span> GP practices with an average of <span class='text-big'>"+re[14]("GP.value.PRACLIST").toLocaleString()+"</span> patients per practice</p><p>"+re[15]("GP.value.PRACLIST").toLocaleString()+"<span style='color: #1460aa'> (NI "+re[0].ni.data.GP.value.PRACLIST.toLocaleString()+" patients per practice) </span></p><p><span class='text-big'>"+re[14]("DEN.value.GDSDSSurgeries").toLocaleString()+"</span> dental surgeries</span> with an average of <span class='text-big'>"+(re[14]("DEN_REG.value.Dental_Registrations")/re[14]("DEN.value.GDSDSSurgeries")).toLocaleString(void 0,{minimumFractionDigits:0,maximumFractionDigits:0})+"</span> patients per surgery</p>",show:["lgd"]},box_6b:{id:"primarycare",year:Yt("DEN",re[0].place),content:"<p><span class='text-big'>"+re[14]("DEN.value.GDSDSSurgeries").toLocaleString()+"</span> dental surgeries</span> with an average of <span class='text-big'>"+(re[14]("DEN_REG.value.Dental_Registrations")/re[14]("DEN.value.GDSDSSurgeries")).toLocaleString(void 0,{minimumFractionDigits:0,maximumFractionDigits:0})+"</span> patients per surgery</p>",show:["dea"]},box_6c:{id:"empty",i_button:!1,content:"",show:["sdz","dz"]}}),qr.$set(U);const J={};et[0]&1&&(J.place=re[0].place),et[0]&1&&(J.sub_heading=re[17]("Work and Welfare",re[0].place)),et[0]&64&&(J.chart_compare_type=re[6]),et[0]&1&&(J.boxes={box_1:{id:"employmentrates",year:Yt("LMS",re[0].place),content:"GroupChart",chart_data:re[9]("LMS"),show:["ni","lgd"]},box_2a:{id:"employed",year:Yt("LMS",re[0].place),content:"<p>People employed</p> <span class='text-big'>"+re[14]("LMS.value.EMPN").toLocaleString()+'</span> </p><p>Median salary</p> <span class="text-big">'+re[14]("ASHE.value").toLocaleString()+"</span> ",show:["ni"]},box_2b:{id:"employed",year:Yt("LMS",re[0].place),content:"<p>People employed</p> <span class='text-big'>"+re[14]("LMS.value.EMPN").toLocaleString()+'</span> </p><p>Median salary</p> <span class="text-big">'+re[14]("ASHE.value").toLocaleString()+"</span> <span style='color: #1460aa'> (NI "+re[0].ni.data.ASHE.value.toLocaleString()+") </span></p>",show:["lgd"]},box_3b:{id:"bres",year:Yt("BRES",re[0].place),content:"GroupChart",chart_data:re[9]("BRES"),show:["ni","lgd"]},box_4:{id:"disabilitybenefits",year:Yt("BS",re[0].place),content:'<span class="text-big">'+(re[0].place.data.BS.value.PIP+re[0].place.data.BS.value.DLA+re[0].place.data.BS.value.CA+re[0].place.data.BS.value.AA).toLocaleString()+"</span> claimants"},box_5:{id:"workingagebenefits",year:Yt("BS",re[0].place),content:'<span class="text-big">'+(re[0].place.data.BS.value.UC+re[0].place.data.BS.value.JSA+re[0].place.data.BS.value.IS+re[0].place.data.BS.value.ESA).toLocaleString()+"</span> claimants"},box_6:{id:"pensionagebenefits",year:Yt("BS",re[0].place),content:'<span class="text-big">'+(re[0].place.data.BS.value.RP+re[0].place.data.BS.value.PC).toLocaleString()+"</span> claimants"}}),Hr.$set(J);const ge={};et[0]&1&&(ge.place=re[0].place),et[0]&1&&(ge.sub_heading=re[17]("Schools, colleges and universities",re[0].place)),et[0]&64&&(ge.chart_compare_type=re[6]),et[0]&1&&(ge.boxes={box_1:{id:"enrollments",content:"<p style='margin:0'>Primary school <span class='text-big'>"+re[14]("Primary.value").toLocaleString()+"</span> <p style='margin:0'>Post primary school <span class='text-big'>"+re[14]("PostPrimary.value").toLocaleString()+" </span><p style='margin:0'>Further education <span class='text-big'>"+re[14]("FE.value").toLocaleString()+"</span><p style='margin:0'>Higher education <span class='text-big'>"+re[14]("HE.value").toLocaleString()+" </span>",year:Yt("Primary",re[0].place),show:["ni","lgd","dea"]},box_2a:{id:"fsme",content:"<p style='margin:0'>Primary school <span class='text-big'> "+re[14]("Primary.perc.FSME")+" </span><p style='margin:0'>Post primary school <span class='text-big'>"+re[14]("PostPrimary.perc.FSME")+" </span>",year:Yt("Primary",re[0].place),show:["ni"]},box_2b:{id:"fsme",content:"<p style='margin:0'>Primary school <span class='text-big'> "+re[14]("Primary.perc.FSME")+" </span><span style='color: #1460aa'> (NI "+re[0].ni.data.Primary.perc.FSME.toFixed(0)+"%) </span></p><p style='margin:0'>Post primary school <span class='text-big'>"+re[14]("PostPrimary.perc.FSME")+" </span><span style='color: #1460aa'> (NI "+re[0].ni.data.PostPrimary.perc.FSME.toFixed(0)+"%) </span></p>",year:Yt("Primary",re[0].place),show:["lgd","dea"]},box_3a:{id:"teachers",year:Yt("ClassSize",re[0].place),content:"<p><span class='text-big'>"+re[14]("ClassSize.value").toLocaleString()+"</span> pupils per teacher",show:["ni"]},box_3n:{id:"teachers",year:Yt("ClassSize",re[0].place),content:"<p><span class='text-big'>"+re[14]("ClassSize.value").toLocaleString()+"</span> pupils per teacher<span style='color: #1460aa'> (NI "+re[0].ni.data.ClassSize.value.toLocaleString(void 0,{minimumFractionDigits:1})+") </span></p>",show:["lgd"]},box_4:{id:"qualifications",content:"GroupChart",year:re[16]("highest_level_of_qualifications"),chart_data:re[9]("highest_level_of_qualifications")},box_5a:{id:"attainment",year:Yt("Attainment",re[0].place),content:"<p>Percentage of pupils who left school with 5 or more GCSEs grades A*-C (including Maths and English)</p><p> <span class='text-big'>"+re[14]("Attainment.value").toLocaleString()+"%</span> ",show:["ni"]},box_5b:{id:"attainment",year:Yt("Attainment",re[0].place),content:"<p>Percentage of pupils who left school with 5 or more GCSEs grades A*-C (including Maths and English)</p><p> <span class='text-big'>"+re[14]("Attainment.value").toLocaleString()+"%</span> <span style='color: #1460aa'>(NI "+re[0].ni.data.Attainment.value.toLocaleString(void 0,{minimumFractionDigits:1})+"%) </span></p>"+re[15]("Attainment.value").toLocaleString(),show:["lgd"]},box_6:{id:"destination",year:Yt("Destination",re[0].place),content:"GroupChart",chart_data:re[9]("Destination"),show:["ni","lgd","dea"]},box_6a:{id:"empty",i_button:!1,content:"",show:["sdz","dz"]},box_6b:{id:"empty",i_button:!1,content:"",show:["sdz","dz"]}}),$i.$set(ge);const De={};et[0]&1&&(De.place=re[0].place),et[0]&1&&(De.sub_heading=re[17]("Crime and Court Activity",re[0].place)),et[0]&64&&(De.chart_compare_type=re[6]),Ui.$set(De);const Ne={};et[0]&1&&(Ne.place=re[0].place),et[0]&1&&(Ne.sub_heading=re[17]("Travel and transport",re[0].place)),et[0]&64&&(Ne.chart_compare_type=re[6]),en.$set(Ne)},i(re){Ri||(tt(Fe.$$.fragment,re),tt(Lt.$$.fragment,re),tt(ot.$$.fragment,re),tt(Kr.$$.fragment,re),tt(Br.$$.fragment,re),tt(Ut.$$.fragment,re),tt(_i.$$.fragment,re),tt(qr.$$.fragment,re),tt(Hr.$$.fragment,re),tt($i.$$.fragment,re),tt(Ui.$$.fragment,re),tt(en.$$.fragment,re),Ri=!0)},o(re){ct(Fe.$$.fragment,re),ct(Lt.$$.fragment,re),ct(ot.$$.fragment,re),ct(Kr.$$.fragment,re),ct(Br.$$.fragment,re),ct(Ut.$$.fragment,re),ct(_i.$$.fragment,re),ct(qr.$$.fragment,re),ct(Hr.$$.fragment,re),ct($i.$$.fragment,re),ct(Ui.$$.fragment,re),ct(en.$$.fragment,re),Ri=!1},d(re){re&&ne(c),Xr&&Xr.d(),ir(Fe),re&&ne(jt),ir(Lt,re),re&&ne(St),re&&ne(Ce),ir(ot),ir(Kr),ir(Br),re&&ne(cr),re&&ne(Sr),vi.d(),ir(Ut),Or&&Or.d(),fi.d(),Tn(),re&&ne(ni),re&&ne(zr),ir(_i),ir(qr),ir(Hr),ir($i),ir(Ui),ir(en)}}}function $m(l){let c,d=[...l[0].place.parents].reverse(),p=[];for(let y=0;y<d.length;y+=1)p[y]=ey(Jm(l,d,y));return{c(){for(let y=0;y<p.length;y+=1)p[y].c();c=or()},l(y){for(let v=0;v<p.length;v+=1)p[v].l(y);c=or()},m(y,v){for(let a=0;a<p.length;a+=1)p[a]&&p[a].m(y,v);Re(y,c,v)},p(y,v){if(v[0]&1){d=[...y[0].place.parents].reverse();let a;for(a=0;a<d.length;a+=1){const E=Jm(y,d,a);p[a]?p[a].p(E,v):(p[a]=ey(E),p[a].c(),p[a].m(c.parentNode,c))}for(;a<p.length;a+=1)p[a].d(1);p.length=d.length}},d(y){an(p,y),y&&ne(c)}}}function ey(l){let c,d=l[32].name+"",p,y,v,a=" &gt; ",E;return{c(){c=Ue("a"),p=zt(d),v=new Bl(!1),E=or(),this.h()},l(T){c=qe(T,"A",{href:!0,"data-sveltekit-noscroll":!0,class:!0});var L=Oe(c);p=Pt(L,d),L.forEach(ne),v=Ol(T,!1),E=or(),this.h()},h(){ie(c,"href",y=Sn+"/"+l[32].code+"/"),ie(c,"data-sveltekit-noscroll",""),ie(c,"class","svelte-hmrro5"),v.a=E},m(T,L){Re(T,c,L),we(c,p),v.m(a,T,L),Re(T,E,L)},p(T,L){L[0]&1&&d!==(d=T[32].name+"")&&Er(p,d),L[0]&1&&y!==(y=Sn+"/"+T[32].code+"/")&&ie(c,"href",y)},d(T){T&&ne(c),T&&ne(E),T&&v.d()}}}function H1(l){let c,d;return{c(){c=Ue("p"),d=zt("Zoom and click on map to explore other areas"),this.h()},l(p){c=qe(p,"P",{class:!0});var y=Oe(c);d=Pt(y,"Zoom and click on map to explore other areas"),y.forEach(ne),this.h()},h(){ie(c,"class","text-bold")},m(p,y){Re(p,c,y),we(c,d)},p:ei,d(p){p&&ne(c)}}}function X1(l){let c,d,p=l[0].place.name+"",y,v,a,E,T,L,F;return{c(){c=zt("You are currently viewing "),d=Ue("span"),y=zt(p),v=bt(),a=Ue("span"),E=bt(),T=Ue("p"),L=Ue("span"),F=zt("Zoom and click on map to explore other areas"),this.h()},l(C){c=Pt(C,"You are currently viewing "),d=qe(C,"SPAN",{style:!0});var M=Oe(d);y=Pt(M,p),M.forEach(ne),v=xt(C),a=qe(C,"SPAN",{style:!0});var X=Oe(a);X.forEach(ne),E=xt(C),T=qe(C,"P",{});var ae=Oe(T);L=qe(ae,"SPAN",{class:!0});var se=Oe(L);F=Pt(se,"Zoom and click on map to explore other areas"),se.forEach(ne),ae.forEach(ne),this.h()},h(){Ye(d,"color","#3878c5"),Ye(a,"color","#00205b"),ie(L,"class","text-bold")},m(C,M){Re(C,c,M),Re(C,d,M),we(d,y),Re(C,v,M),Re(C,a,M),Re(C,E,M),Re(C,T,M),we(T,L),we(L,F)},p(C,M){M[0]&1&&p!==(p=C[0].place.name+"")&&Er(y,p)},d(C){C&&ne(c),C&&ne(d),C&&ne(v),C&&ne(a),C&&ne(E),C&&ne(T)}}}function W1(l){let c,d,p,y,v,a,E;const T=[ts[l[34]],{id:l[34]+"-fill"},{type:"fill"},{isChild:l[5][l[34]]},{click:!0},{selected:l[4].selected},{highlight:!0},{highlighted:l[4].highlighted},{hover:!0},{hovered:l[4].hovered},{layout:{visibility:l[4].type==l[34]||l[4].childType==l[34]?"visible":"none"}},{paint:l[4].type==l[34]?Ji["fill-self"]:l[4].childType==l[34]?Ji["fill-child"]:Ji.fill}];let L={};for(let ae=0;ae<T.length;ae+=1)L=yh(L,T[ae]);c=new Ap({props:L}),c.$on("select",l[10]);const F=[ts[l[34]],{id:l[34]+"-bounds"},{type:"line"},{selected:l[4].selected},{highlight:!0},{highlighted:l[4].highlighted},{layout:{visibility:l[4].type==l[34]||l[4].childType==l[34]?"visible":"none"}},{paint:l[4].type==l[34]?Ji["line-active"]:l[4].childType==l[34]?Ji["line-child"]:Ji.line}];let C={};for(let ae=0;ae<F.length;ae+=1)C=yh(C,F[ae]);p=new Ap({props:C});const M=[ts[l[34]],{id:l[34]+"-self"},{type:"line"},{selected:l[4].selected},{layout:{visibility:l[4].type==l[34]?"visible":"none"}},{paint:l[4].type==l[34]?Ji["line-self"]:Ji.line}];let X={};for(let ae=0;ae<M.length;ae+=1)X=yh(X,M[ae]);return v=new Ap({props:X}),{c(){er(c.$$.fragment),d=bt(),er(p.$$.fragment),y=bt(),er(v.$$.fragment),a=bt()},l(ae){tr(c.$$.fragment,ae),d=xt(ae),tr(p.$$.fragment,ae),y=xt(ae),tr(v.$$.fragment,ae),a=xt(ae)},m(ae,se){rr(c,ae,se),Re(ae,d,se),rr(p,ae,se),Re(ae,y,se),rr(v,ae,se),Re(ae,a,se),E=!0},p(ae,se){const he=se[0]&48?gh(T,[se&0&&_h(ts[ae[34]]),T[1],T[2],se[0]&32&&{isChild:ae[5][ae[34]]},T[4],se[0]&16&&{selected:ae[4].selected},T[6],se[0]&16&&{highlighted:ae[4].highlighted},T[8],se[0]&16&&{hovered:ae[4].hovered},se[0]&16&&{layout:{visibility:ae[4].type==ae[34]||ae[4].childType==ae[34]?"visible":"none"}},se[0]&16&&{paint:ae[4].type==ae[34]?Ji["fill-self"]:ae[4].childType==ae[34]?Ji["fill-child"]:Ji.fill}]):{};c.$set(he);const me=se[0]&16?gh(F,[se&0&&_h(ts[ae[34]]),F[1],F[2],se[0]&16&&{selected:ae[4].selected},F[4],se[0]&16&&{highlighted:ae[4].highlighted},se[0]&16&&{layout:{visibility:ae[4].type==ae[34]||ae[4].childType==ae[34]?"visible":"none"}},se[0]&16&&{paint:ae[4].type==ae[34]?Ji["line-active"]:ae[4].childType==ae[34]?Ji["line-child"]:Ji.line}]):{};p.$set(me);const _e=se[0]&16?gh(M,[se&0&&_h(ts[ae[34]]),M[1],M[2],se[0]&16&&{selected:ae[4].selected},se[0]&16&&{layout:{visibility:ae[4].type==ae[34]?"visible":"none"}},se[0]&16&&{paint:ae[4].type==ae[34]?Ji["line-self"]:Ji.line}]):{};v.$set(_e)},i(ae){E||(tt(c.$$.fragment,ae),tt(p.$$.fragment,ae),tt(v.$$.fragment,ae),E=!0)},o(ae){ct(c.$$.fragment,ae),ct(p.$$.fragment,ae),ct(v.$$.fragment,ae),E=!1},d(ae){ir(c,ae),ae&&ne(d),ir(p,ae),ae&&ne(y),ir(v,ae),ae&&ne(a)}}}function ty(l){let c,d;const p=[bd[l[34]]];let y={$$slots:{default:[W1]},$$scope:{ctx:l}};for(let v=0;v<p.length;v+=1)y=yh(y,p[v]);return c=new ev({props:y}),{c(){er(c.$$.fragment)},l(v){tr(c.$$.fragment,v)},m(v,a){rr(c,v,a),d=!0},p(v,a){const E=a&0?gh(p,[_h(bd[v[34]])]):{};a[0]&48|a[1]&128&&(E.$$scope={dirty:a,ctx:v}),c.$set(E)},i(v){d||(tt(c.$$.fragment,v),d=!0)},o(v){ct(c.$$.fragment,v),d=!1},d(v){ir(c,v)}}}function Y1(l){let c,d,p=["dz","sdz","dea","lgd"],y=[];for(let a=0;a<4;a+=1)y[a]=ty(Ym(l,p,a));const v=a=>ct(y[a],1,1,()=>{y[a]=null});return{c(){for(let a=0;a<4;a+=1)y[a].c();c=or()},l(a){for(let E=0;E<4;E+=1)y[E].l(a);c=or()},m(a,E){for(let T=0;T<4;T+=1)y[T]&&y[T].m(a,E);Re(a,c,E),d=!0},p(a,E){if(E[0]&1072){p=["dz","sdz","dea","lgd"];let T;for(T=0;T<4;T+=1){const L=Ym(a,p,T);y[T]?(y[T].p(L,E),tt(y[T],1)):(y[T]=ty(L),y[T].c(),tt(y[T],1),y[T].m(c.parentNode,c))}for(kn(),T=4;T<4;T+=1)v(T);En()}},i(a){if(!d){for(let E=0;E<4;E+=1)tt(y[E]);d=!0}},o(a){y=y.filter(Boolean);for(let E=0;E<4;E+=1)ct(y[E]);d=!1},d(a){an(y,a),a&&ne(c)}}}function ry(l){let c,d,p=l[0].place.name+"",y,v,a,E=[...l[0].place.parents].reverse(),T=[];for(let L=0;L<E.length;L+=1)T[L]=iy(Wm(l,E,L));return{c(){c=Ue("span"),d=zt("Select a larger area containing "),y=zt(p),v=bt(),a=Ue("span");for(let L=0;L<T.length;L+=1)T[L].c();this.h()},l(L){c=qe(L,"SPAN",{class:!0});var F=Oe(c);d=Pt(F,"Select a larger area containing "),y=Pt(F,p),F.forEach(ne),v=xt(L),a=qe(L,"SPAN",{class:!0});var C=Oe(a);for(let M=0;M<T.length;M+=1)T[M].l(C);C.forEach(ne),this.h()},h(){ie(c,"class","text-bold"),ie(a,"class","text-small")},m(L,F){Re(L,c,F),we(c,d),we(c,y),Re(L,v,F),Re(L,a,F);for(let C=0;C<T.length;C+=1)T[C]&&T[C].m(a,null)},p(L,F){if(F[0]&1&&p!==(p=L[0].place.name+"")&&Er(y,p),F[0]&1){E=[...L[0].place.parents].reverse();let C;for(C=0;C<E.length;C+=1){const M=Wm(L,E,C);T[C]?T[C].p(M,F):(T[C]=iy(M),T[C].c(),T[C].m(a,null))}for(;C<T.length;C+=1)T[C].d(1);T.length=E.length}},d(L){L&&ne(c),L&&ne(v),L&&ne(a),an(T,L)}}}function iy(l){let c,d,p=l[31]>0?" ":"",y,v=l[32].name+"",a,E;return{c(){c=Ue("span"),d=new Bl(!1),y=Ue("a"),a=zt(v),this.h()},l(T){c=qe(T,"SPAN",{style:!0});var L=Oe(c);d=Ol(L,!1),y=qe(L,"A",{href:!0,"data-sveltekit-noscroll":!0,class:!0});var F=Oe(y);a=Pt(F,v),F.forEach(ne),L.forEach(ne),this.h()},h(){d.a=y,ie(y,"href",E=Sn+"/"+l[32].code),ie(y,"data-sveltekit-noscroll",""),ie(y,"class","svelte-hmrro5"),Ye(c,"display","block"),Ye(c,"margin-left",(l[31]>0?(l[31]-1)*15:0)+"px")},m(T,L){Re(T,c,L),d.m(p,c),we(c,y),we(y,a)},p(T,L){L[0]&1&&v!==(v=T[32].name+"")&&Er(a,v),L[0]&1&&E!==(E=Sn+"/"+T[32].code)&&ie(y,"href",E)},d(T){T&&ne(c)}}}function J1(l){let c,d,p=l[0].place.name+"",y,v,a=Hn[l[0].place.type].name+"",E;return{c(){c=Ue("span"),d=zt("No areas below "),y=zt(p),v=bt(),E=zt(a),this.h()},l(T){c=qe(T,"SPAN",{class:!0});var L=Oe(c);d=Pt(L,"No areas below "),y=Pt(L,p),v=xt(L),E=Pt(L,a),L.forEach(ne),this.h()},h(){ie(c,"class","muted")},m(T,L){Re(T,c,L),we(c,d),we(c,y),we(c,v),we(c,E)},p(T,L){L[0]&1&&p!==(p=T[0].place.name+"")&&Er(y,p),L[0]&1&&a!==(a=Hn[T[0].place.type].name+"")&&Er(E,a)},d(T){T&&ne(c)}}}function Q1(l){let c,d,p=(l[0].place.children[0]?Hn[l[0].place.children[0].type].name:"Areas")+"",y,v,a=l[0].place.name+"",E,T,L,F,C=l[0].place.children,M=[];for(let X=0;X<C.length;X+=1)M[X]=ny(Xm(l,C,X));return{c(){c=Ue("span"),d=zt("Select a "),y=zt(p),v=zt(" within "),E=zt(a),T=Ue("br"),L=bt(),F=Ue("span");for(let X=0;X<M.length;X+=1)M[X].c();this.h()},l(X){c=qe(X,"SPAN",{class:!0});var ae=Oe(c);d=Pt(ae,"Select a "),y=Pt(ae,p),v=Pt(ae," within "),E=Pt(ae,a),ae.forEach(ne),T=qe(X,"BR",{}),L=xt(X),F=qe(X,"SPAN",{class:!0});var se=Oe(F);for(let he=0;he<M.length;he+=1)M[he].l(se);se.forEach(ne),this.h()},h(){ie(c,"class","text-bold"),ie(F,"class","text-small")},m(X,ae){Re(X,c,ae),we(c,d),we(c,y),we(c,v),we(c,E),Re(X,T,ae),Re(X,L,ae),Re(X,F,ae);for(let se=0;se<M.length;se+=1)M[se]&&M[se].m(F,null)},p(X,ae){if(ae[0]&1&&p!==(p=(X[0].place.children[0]?Hn[X[0].place.children[0].type].name:"Areas")+"")&&Er(y,p),ae[0]&1&&a!==(a=X[0].place.name+"")&&Er(E,a),ae[0]&1){C=X[0].place.children;let se;for(se=0;se<C.length;se+=1){const he=Xm(X,C,se);M[se]?M[se].p(he,ae):(M[se]=ny(he),M[se].c(),M[se].m(F,null))}for(;se<M.length;se+=1)M[se].d(1);M.length=C.length}},d(X){X&&ne(c),X&&ne(T),X&&ne(L),X&&ne(F),an(M,X)}}}function ny(l){let c,d=l[29].name+"",p,y,v=l[31]<l[0].place.children.length-1?", ":"",a;return{c(){c=Ue("a"),p=zt(d),a=zt(v),this.h()},l(E){c=qe(E,"A",{href:!0,"data-sveltekit-noscroll":!0,class:!0});var T=Oe(c);p=Pt(T,d),T.forEach(ne),a=Pt(E,v),this.h()},h(){ie(c,"href",y=Sn+"/"+l[29].code),ie(c,"data-sveltekit-noscroll",""),ie(c,"class","svelte-hmrro5")},m(E,T){Re(E,c,T),we(c,p),Re(E,a,T)},p(E,T){T[0]&1&&d!==(d=E[29].name+"")&&Er(p,d),T[0]&1&&y!==(y=Sn+"/"+E[29].code)&&ie(c,"href",y),T[0]&1&&v!==(v=E[31]<E[0].place.children.length-1?", ":"")&&Er(a,v)},d(E){E&&ne(c),E&&ne(a)}}}function $1(l){let c,d,p=l[0].place&&l[0].ni&&Qm(l);return{c(){p&&p.c(),c=or()},l(y){p&&p.l(y),c=or()},m(y,v){p&&p.m(y,v),Re(y,c,v),d=!0},p(y,v){y[0].place&&y[0].ni?p?(p.p(y,v),v[0]&1&&tt(p,1)):(p=Qm(y),p.c(),tt(p,1),p.m(c.parentNode,c)):p&&(kn(),ct(p,1,1,()=>{p=null}),En())},i(y){d||(tt(p),d=!0)},o(y){ct(p),d=!1},d(y){p&&p.d(y),y&&ne(c)}}}function eb(l){let c,d,p,y,v,a,E,T,L,F,C,M,X,ae,se,he;return document.title=c=l[0].place.name+" Local Statistics Explorer",X=new s1({}),se=new y_({props:{column:"wide",$$slots:{default:[$1]},$$scope:{ctx:l}}}),{c(){d=Ue("meta"),p=Ue("meta"),v=Ue("meta"),a=Ue("meta"),T=Ue("meta"),F=Ue("meta"),M=bt(),er(X.$$.fragment),ae=bt(),er(se.$$.fragment),this.h()},l(me){const _e=f_("svelte-ovl3z1",document.head);d=qe(_e,"META",{name:!0,content:!0}),p=qe(_e,"META",{property:!0,content:!0}),v=qe(_e,"META",{property:!0,content:!0}),a=qe(_e,"META",{property:!0,content:!0}),T=qe(_e,"META",{property:!0,content:!0}),F=qe(_e,"META",{name:!0,content:!0}),_e.forEach(ne),M=xt(me),tr(X.$$.fragment,me),ae=xt(me),tr(se.$$.fragment,me),this.h()},h(){ie(d,"name","description"),ie(d,"content",""),ie(p,"property","og:title"),ie(p,"content",y=l[0].place.name+" Local Statistics"),ie(v,"property","og:type"),ie(v,"content","website"),ie(a,"property","og:url"),ie(a,"content",E=wh.base+"/"+l[0].place.code+"/"),ie(T,"property","og:description"),ie(T,"content",L="Explore NISRA Statistics for "+l[0].place.name+"."),ie(F,"name","description"),ie(F,"content",C="Explore NISRA Statistics for "+l[0].place.name+".")},m(me,_e){we(document.head,d),we(document.head,p),we(document.head,v),we(document.head,a),we(document.head,T),we(document.head,F),Re(me,M,_e),rr(X,me,_e),Re(me,ae,_e),rr(se,me,_e),he=!0},p(me,_e){(!he||_e[0]&1)&&c!==(c=me[0].place.name+" Local Statistics Explorer")&&(document.title=c),(!he||_e[0]&1&&y!==(y=me[0].place.name+" Local Statistics"))&&ie(p,"content",y),(!he||_e[0]&1&&E!==(E=wh.base+"/"+me[0].place.code+"/"))&&ie(a,"content",E),(!he||_e[0]&1&&L!==(L="Explore NISRA Statistics for "+me[0].place.name+"."))&&ie(T,"content",L),(!he||_e[0]&1&&C!==(C="Explore NISRA Statistics for "+me[0].place.name+"."))&&ie(F,"content",C);const it={};_e[0]&255|_e[1]&128&&(it.$$scope={dirty:_e,ctx:me}),se.$set(it)},i(me){he||(tt(X.$$.fragment,me),tt(se.$$.fragment,me),he=!0)},o(me){ct(X.$$.fragment,me),ct(se.$$.fragment,me),he=!1},d(me){ne(d),ne(p),ne(v),ne(a),ne(T),ne(F),me&&ne(M),ir(X,me),me&&ne(ae),ir(se,me)}}}function mh(l){let c=(l*100).toFixed(1);return c<.1?"<0.1%":c+"%"}function Yt(l,c){return c.meta_data.hasOwnProperty(l)?c.meta_data[l][0].year:null}function ay(l){let c=l.data.MYETotal.value/(l.hectares/100);return c<10?c="< 10":c=(Math.round(c*10)/10).toLocaleString(void 0,{minimumFractionDigits:1}),c}function tb(l,c,d){let p,y,v,{data:a}=c,E,T,L=null,F={selected:null,type:null,childType:null,highlighted:[],hovered:null},C={};Object.keys(ts).forEach(je=>d(5,C[je]=!1,C));function M(je,Ft,Be){const $e=(cr,Sr)=>cr+Sr;let yt=je[0],jt=Be[0],Lt=Ft[0],St="perc",Ce=a.place.data[yt][St][jt],ot=a.place.data[yt][St][Lt],Dr=a.ni.data[yt][St][jt],Kr=Cl[yt].map(cr=>cr.category),ki=Cl[yt].map(cr=>cr.label?cr.label:cr.category);return Kr.map((cr,Sr)=>Array.isArray(cr)?{x:ki[Sr],y:cr.map(Gt=>Ce[Gt]).reduce($e,0),ni:cr.map(Gt=>Dr[Gt]).reduce($e,0),prev:cr.map(Gt=>ot[Gt]).reduce($e,0)}:{x:ki[Sr],y:Ce[cr],ni:Dr[cr],prev:ot[cr]})}function X(je){let Ft=[];if(a.place.data.hasOwnProperty(je)){let Be=a.place.data[je].perc,$e,yt;Be.hasOwnProperty("2021")?($e=Be[2021],yt=a.ni.data[je].perc[2021]):($e=Be,yt=a.ni.data[je].perc);let jt,Lt,St=Object.keys(Cl[je]);for(let Ce=0;Ce<St.length;Ce++){for(let ot=0;ot<Object.keys($e).length;ot++)if(Cl[je][St[Ce]].category==Object.keys($e)[ot]){jt=Cl[je][St[Ce]].category,Lt=Cl[je][St[Ce]].label;break}$e[jt]<=100&&(Ft.push({group:"Northern Ireland",category:Lt,perc:yt[jt],width:0}),a.place.name!="Northern Ireland"&&Ft.push({group:a.place.name,category:Lt,perc:$e[jt],width:0}))}}return Ft}function ae(je){L&&L.fitBounds(je,{padding:20})}function se(je){let Ft=JSON.parse(JSON.stringify(F)),Be=a.place.code,$e=a.place.type,yt=a.place.children[0]?a.place.children.map(ot=>ot.code):[],jt=a.place.type=="rgn"?"cty":yt[0]?a.place.children[0].type:null;d(4,F.selected=Be,F),d(4,F.type=$e,F),d(4,F.childType=jt,F),d(4,F.highlighted=yt,F);let Lt=Object.keys(ts),St=["fill-color","fill-opacity"],Ce=["line-color","line-width","line-opacity"];L&&(F.type!=Ft.type||F.childType!=Ft.childType)&&(Lt.forEach(ot=>{let Dr=ot==$e||jt&&ot==jt?"visible":"none";L.setLayoutProperty(ot+"-fill","visibility",Dr),L.setLayoutProperty(ot+"-bounds","visibility",Dr),a.place.type!="ni"&&L.setLayoutProperty(ot+"-self","visibility",Dr),d(5,C[ot]=ot==jt,C)}),a.place.type!="ni"&&(St.forEach(ot=>L.setPaintProperty($e+"-fill",ot,Ji[yt[0]?"fill-active":"fill-self"][ot])),Ce.forEach(ot=>{L.setPaintProperty($e+"-bounds",ot,Ji["line-active"][ot]),L.setPaintProperty($e+"-self",ot,Ji["line-self"][ot])})),jt&&(St.forEach(ot=>L.setPaintProperty(jt+"-fill",ot,Ji["fill-child"][ot])),Ce.forEach(ot=>L.setPaintProperty(jt+"-bounds",ot,Ji["line-child"][ot]))))}function he(je){se(),ae(a.place.bounds)}function me(je){vd(`${Sn}/${je.detail.code}/`,{noScroll:!0})}function _e(je){vd(`${Sn}/${je.detail.value}/`,{noScroll:!0})}function it(){d(2,T=E<575?1:window.getComputedStyle(grid).getPropertyValue("grid-template-columns").split(" ").length)}function Fe(je){return je==1?"largest":je==a.place.count?"smallest":je+o_(je)+" largest"}function Pe(je){let Ft="";if(je.data.hasOwnProperty("PopChange")){let Be=je.data.PopChange.value,$e=Object.keys(Be).slice(-1),yt=$e-10,jt=(Be[$e]-Be[yt])/Be[yt]*100,Lt;jt<0?Lt="Down":jt>0&&(Lt="Up"),Ft="<p>The population of "+je.name+" in "+yt+' was <span class="text-big">'+Be[yt].toLocaleString()+"</span> and in "+$e+' was <span class="text-big">'+Be[$e].toLocaleString()+'</span><p><span class="em '+s_(jt)+'">'+Lt+" "+l_(jt,"%",1)+"</span> since "+yt+" Mid-Year Population Estimate</p>"}return Ft}function Ze(je){let Be=je.replaceAll("[",".").replaceAll("]","").split("."),$e=a.place.data;for(let yt=0;yt<Be.length;yt++)$e.hasOwnProperty(Be[yt])?$e=$e[Be[yt]]:$e=[];return $e.length!=0&Be.includes("perc")&&($e=$e.toFixed(0)+"%"),$e}function Ct(je){let Be=je.replaceAll("[",".").replaceAll("]","").split("."),$e=a.ni.data,yt=Ze(je);Be[0]=="grouped_data_nocompare"|Be[0]=="grouped_data_areacompare"&&($e=a.ni);for(let jt=0;jt<Be.length;jt++)$e.hasOwnProperty(Be[jt])?$e=$e[Be[jt]]:$e=[];return yt>$e+2?$e="<p>This is higher than the NI value</p>":yt<$e-2?$e="<p>This is lower than the NI value</p>":$e="<p>This is similar to the NI value</p>",$e}function kt(je){return a.place.data.hasOwnProperty(je)?"Census "+Object.keys(a.place.data[je].perc).slice(-1):null}function Ge(je,Ft){return Ft.type!="ni"?"You can also explore "+je+" data for <a href = '"+Sn+"/"+Ft.parents[0].code+"/' data-sveltekit-noscroll>"+Ft.parents[0].name+" </a>":""}function Ke(je){let Ft=je.data.MYETotal.value/(je.hectares/100),Be=a.ni.data.MYETotal.value/(a.ni.hectares/100),$e=Ft/Be;return Math.round($e)==1?$e='Approximately <span class = "em" style = "background-color: lightgrey">the same density level</span> as the Northern Ireland average':$e>1?$e='Approximately <span class = "em" style = "background-color: lightgrey">'+$e.toFixed(0)+" times more dense</span> than the Northern Ireland average":$e='Approximately <span class = "em" style = "background-color: lightgrey">1/'+(1/$e).toFixed(0)+" as dense</span> as the Northern Ireland average",$e}function gt(je){L=je,d(3,L)}function ur(){E=this.clientWidth,d(1,E)}return l.$$set=je=>{"data"in je&&d(0,a=je.data)},l.$$.update=()=>{l.$$.dirty[0]&2&&E&&it(),l.$$.dirty[0]&1&&d(7,p=a.place&&a.place.type!="ni"?"NI 2021":null),l.$$.dirty[0]&524289&&d(6,y=v?null:a.place.type!="ni"?"ni":null),l.$$.dirty[0]&1&&a.place&&he(a.place)},d(19,v=!1),[a,E,T,L,F,C,y,p,M,X,me,_e,Fe,Pe,Ze,Ct,kt,Ge,Ke,v,gt,ur]}class cb extends on{constructor(c){super(),sn(this,c,tb,eb,ln,{data:0},null,[-1,-1])}}export{cb as component,ub as universal};
